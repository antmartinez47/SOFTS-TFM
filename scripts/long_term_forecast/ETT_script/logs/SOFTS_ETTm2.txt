model_name=SOFTS

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTm2.csv \
  --model_id ETTm2_96_96 \
  --model $model_name \
  --data ETTm2 \
  --features M \
  --seq_len 96 \
  --pred_len 96 \
  --e_layers 2 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 128 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTm2.csv \
  --model_id ETTm2_96_192 \
  --model $model_name \
  --data ETTm2 \
  --features M \
  --seq_len 96 \
  --pred_len 192 \
  --e_layers 2 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 128 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTm2.csv \
  --model_id ETTm2_96_336 \
  --model $model_name \
  --data ETTm2 \
  --features M \
  --seq_len 96 \
  --pred_len 336 \
  --e_layers 2 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 128 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTm2.csv \
  --model_id ETTm2_96_720 \
  --model $model_name \
  --data ETTm2 \
  --features M \
  --seq_len 96 \
  --pred_len 720 \
  --e_layers 2 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 128 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTm2_96_96', model='SOFTS', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_SOFTS_ETTm2_ftM_sl96_ll48_pl96_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1977266
	speed: 0.0095s/iter; left time: 203.4892s
	iters: 200, epoch: 1 | loss: 0.2357243
	speed: 0.0030s/iter; left time: 64.6552s
	iters: 300, epoch: 1 | loss: 0.2466324
	speed: 0.0030s/iter; left time: 63.8029s
	iters: 400, epoch: 1 | loss: 0.5789420
	speed: 0.0030s/iter; left time: 62.9194s
	iters: 500, epoch: 1 | loss: 0.1980239
	speed: 0.0030s/iter; left time: 63.0060s
	iters: 600, epoch: 1 | loss: 0.4717277
	speed: 0.0030s/iter; left time: 62.6382s
	iters: 700, epoch: 1 | loss: 0.2315677
	speed: 0.0030s/iter; left time: 62.4237s
	iters: 800, epoch: 1 | loss: 0.3245152
	speed: 0.0030s/iter; left time: 62.1443s
	iters: 900, epoch: 1 | loss: 0.1806333
	speed: 0.0030s/iter; left time: 61.7912s
	iters: 1000, epoch: 1 | loss: 0.3279115
	speed: 0.0030s/iter; left time: 60.9090s
Epoch: 1 cost time: 3.586012125015259
Epoch: 1, Steps: 1075 | Train Loss: 0.2993405 Vali Loss: 0.1347534 Test Loss: 0.1847877
Validation loss decreased (inf --> 0.134753).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.1236316
	speed: 0.0184s/iter; left time: 374.9177s
	iters: 200, epoch: 2 | loss: 0.1920854
	speed: 0.0033s/iter; left time: 66.1601s
	iters: 300, epoch: 2 | loss: 0.4241155
	speed: 0.0033s/iter; left time: 67.2080s
	iters: 400, epoch: 2 | loss: 0.2341322
	speed: 0.0033s/iter; left time: 66.7172s
	iters: 500, epoch: 2 | loss: 0.1125007
	speed: 0.0033s/iter; left time: 66.3451s
	iters: 600, epoch: 2 | loss: 0.1609303
	speed: 0.0033s/iter; left time: 65.6107s
	iters: 700, epoch: 2 | loss: 0.1049447
	speed: 0.0033s/iter; left time: 64.4674s
	iters: 800, epoch: 2 | loss: 0.1379943
	speed: 0.0033s/iter; left time: 63.8828s
	iters: 900, epoch: 2 | loss: 0.1171239
	speed: 0.0033s/iter; left time: 64.4602s
	iters: 1000, epoch: 2 | loss: 0.2428706
	speed: 0.0032s/iter; left time: 63.0761s
Epoch: 2 cost time: 3.60880446434021
Epoch: 2, Steps: 1075 | Train Loss: 0.1850329 Vali Loss: 0.1305367 Test Loss: 0.1825899
Validation loss decreased (0.134753 --> 0.130537).  Saving model ...
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.3276146
	speed: 0.0183s/iter; left time: 353.0652s
	iters: 200, epoch: 3 | loss: 0.1721953
	speed: 0.0033s/iter; left time: 63.3970s
	iters: 300, epoch: 3 | loss: 0.1795722
	speed: 0.0033s/iter; left time: 63.1574s
	iters: 400, epoch: 3 | loss: 0.1286543
	speed: 0.0032s/iter; left time: 59.8454s
	iters: 500, epoch: 3 | loss: 0.1501614
	speed: 0.0031s/iter; left time: 58.0950s
	iters: 600, epoch: 3 | loss: 0.1557014
	speed: 0.0033s/iter; left time: 61.8148s
	iters: 700, epoch: 3 | loss: 0.1121238
	speed: 0.0033s/iter; left time: 62.0715s
	iters: 800, epoch: 3 | loss: 0.0981700
	speed: 0.0033s/iter; left time: 61.8533s
	iters: 900, epoch: 3 | loss: 0.1508573
	speed: 0.0034s/iter; left time: 61.9907s
	iters: 1000, epoch: 3 | loss: 0.0997834
	speed: 0.0034s/iter; left time: 62.2746s
Epoch: 3 cost time: 3.606671094894409
Epoch: 3, Steps: 1075 | Train Loss: 0.1574834 Vali Loss: 0.1350385 Test Loss: 0.1826127
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.2525868
	speed: 0.0186s/iter; left time: 338.8262s
	iters: 200, epoch: 4 | loss: 0.1308764
	speed: 0.0033s/iter; left time: 59.5581s
	iters: 300, epoch: 4 | loss: 0.1218191
	speed: 0.0033s/iter; left time: 59.2026s
	iters: 400, epoch: 4 | loss: 0.1575269
	speed: 0.0031s/iter; left time: 55.0594s
	iters: 500, epoch: 4 | loss: 0.2036004
	speed: 0.0031s/iter; left time: 54.9547s
	iters: 600, epoch: 4 | loss: 0.1175507
	speed: 0.0032s/iter; left time: 55.7735s
	iters: 700, epoch: 4 | loss: 0.2578477
	speed: 0.0033s/iter; left time: 57.4931s
	iters: 800, epoch: 4 | loss: 0.1345802
	speed: 0.0031s/iter; left time: 54.8635s
	iters: 900, epoch: 4 | loss: 0.1238269
	speed: 0.0031s/iter; left time: 53.9455s
	iters: 1000, epoch: 4 | loss: 0.1492264
	speed: 0.0031s/iter; left time: 53.5209s
Epoch: 4 cost time: 3.4929516315460205
Epoch: 4, Steps: 1075 | Train Loss: 0.1649441 Vali Loss: 0.1368288 Test Loss: 0.1866485
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002713525491562421
	iters: 100, epoch: 5 | loss: 0.1229944
	speed: 0.0183s/iter; left time: 313.7306s
	iters: 200, epoch: 5 | loss: 0.1999706
	speed: 0.0033s/iter; left time: 56.3381s
	iters: 300, epoch: 5 | loss: 0.4902751
	speed: 0.0033s/iter; left time: 55.6936s
	iters: 400, epoch: 5 | loss: 0.1139625
	speed: 0.0033s/iter; left time: 55.0917s
	iters: 500, epoch: 5 | loss: 0.2088779
	speed: 0.0033s/iter; left time: 54.8593s
	iters: 600, epoch: 5 | loss: 0.1593189
	speed: 0.0031s/iter; left time: 52.1958s
	iters: 700, epoch: 5 | loss: 0.1946144
	speed: 0.0031s/iter; left time: 51.3686s
	iters: 800, epoch: 5 | loss: 0.1128627
	speed: 0.0031s/iter; left time: 50.8362s
	iters: 900, epoch: 5 | loss: 0.1885585
	speed: 0.0031s/iter; left time: 50.5034s
	iters: 1000, epoch: 5 | loss: 0.3345241
	speed: 0.0031s/iter; left time: 50.4269s
Epoch: 5 cost time: 3.5052082538604736
Epoch: 5, Steps: 1075 | Train Loss: 0.2125959 Vali Loss: 0.1359482 Test Loss: 0.1831059
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_SOFTS_ETTm2_ftM_sl96_ll48_pl96_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1825898748799278, mae:0.26216269512275636
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTm2_96_192', model='SOFTS', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_SOFTS_ETTm2_ftM_sl96_ll48_pl192_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.1880524
	speed: 0.0096s/iter; left time: 204.0780s
	iters: 200, epoch: 1 | loss: 0.2576449
	speed: 0.0033s/iter; left time: 69.5130s
	iters: 300, epoch: 1 | loss: 0.3229439
	speed: 0.0032s/iter; left time: 66.6572s
	iters: 400, epoch: 1 | loss: 0.2262418
	speed: 0.0031s/iter; left time: 65.2779s
	iters: 500, epoch: 1 | loss: 0.2862993
	speed: 0.0030s/iter; left time: 63.8289s
	iters: 600, epoch: 1 | loss: 0.2221178
	speed: 0.0031s/iter; left time: 65.4122s
	iters: 700, epoch: 1 | loss: 0.3132127
	speed: 0.0031s/iter; left time: 64.5563s
	iters: 800, epoch: 1 | loss: 0.5822014
	speed: 0.0031s/iter; left time: 64.4974s
	iters: 900, epoch: 1 | loss: 0.2183303
	speed: 0.0031s/iter; left time: 64.1940s
	iters: 1000, epoch: 1 | loss: 0.1564852
	speed: 0.0031s/iter; left time: 64.2509s
Epoch: 1 cost time: 3.7223033905029297
Epoch: 1, Steps: 1072 | Train Loss: 0.2773530 Vali Loss: 0.1782196 Test Loss: 0.2460750
Validation loss decreased (inf --> 0.178220).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.4322840
	speed: 0.0190s/iter; left time: 384.7795s
	iters: 200, epoch: 2 | loss: 0.3360462
	speed: 0.0030s/iter; left time: 61.0746s
	iters: 300, epoch: 2 | loss: 0.3313664
	speed: 0.0030s/iter; left time: 60.4177s
	iters: 400, epoch: 2 | loss: 0.2914014
	speed: 0.0030s/iter; left time: 59.8876s
	iters: 500, epoch: 2 | loss: 0.2540071
	speed: 0.0030s/iter; left time: 59.7899s
	iters: 600, epoch: 2 | loss: 0.1500752
	speed: 0.0032s/iter; left time: 63.9271s
	iters: 700, epoch: 2 | loss: 0.1706920
	speed: 0.0031s/iter; left time: 60.6846s
	iters: 800, epoch: 2 | loss: 0.9360226
	speed: 0.0031s/iter; left time: 60.9534s
	iters: 900, epoch: 2 | loss: 0.6484884
	speed: 0.0030s/iter; left time: 59.3294s
	iters: 1000, epoch: 2 | loss: 0.6233144
	speed: 0.0030s/iter; left time: 57.9514s
Epoch: 2 cost time: 3.351832151412964
Epoch: 2, Steps: 1072 | Train Loss: 0.4173698 Vali Loss: 0.1859905 Test Loss: 0.2559530
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.2673643
	speed: 0.0183s/iter; left time: 351.4923s
	iters: 200, epoch: 3 | loss: 0.4616473
	speed: 0.0031s/iter; left time: 58.4553s
	iters: 300, epoch: 3 | loss: 0.2344649
	speed: 0.0030s/iter; left time: 57.3593s
	iters: 400, epoch: 3 | loss: 0.1940473
	speed: 0.0030s/iter; left time: 56.9218s
	iters: 500, epoch: 3 | loss: 0.3060131
	speed: 0.0030s/iter; left time: 56.5707s
	iters: 600, epoch: 3 | loss: 0.2342743
	speed: 0.0030s/iter; left time: 56.2673s
	iters: 700, epoch: 3 | loss: 0.1719689
	speed: 0.0030s/iter; left time: 55.7951s
	iters: 800, epoch: 3 | loss: 0.2094620
	speed: 0.0030s/iter; left time: 55.7393s
	iters: 900, epoch: 3 | loss: 0.2942070
	speed: 0.0030s/iter; left time: 55.3812s
	iters: 1000, epoch: 3 | loss: 0.3558033
	speed: 0.0031s/iter; left time: 55.8441s
Epoch: 3 cost time: 3.3228676319122314
Epoch: 3, Steps: 1072 | Train Loss: 0.2729252 Vali Loss: 0.1820527 Test Loss: 0.2578980
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.3287502
	speed: 0.0187s/iter; left time: 338.4485s
	iters: 200, epoch: 4 | loss: 0.3555198
	speed: 0.0032s/iter; left time: 57.5613s
	iters: 300, epoch: 4 | loss: 0.2539953
	speed: 0.0031s/iter; left time: 55.1963s
	iters: 400, epoch: 4 | loss: 0.3890159
	speed: 0.0031s/iter; left time: 54.3747s
	iters: 500, epoch: 4 | loss: 0.8021023
	speed: 0.0030s/iter; left time: 53.3159s
	iters: 600, epoch: 4 | loss: 0.1649425
	speed: 0.0030s/iter; left time: 53.0349s
	iters: 700, epoch: 4 | loss: 0.1645282
	speed: 0.0030s/iter; left time: 52.4901s
	iters: 800, epoch: 4 | loss: 0.1561702
	speed: 0.0030s/iter; left time: 52.1160s
	iters: 900, epoch: 4 | loss: 0.3125909
	speed: 0.0030s/iter; left time: 52.0603s
	iters: 1000, epoch: 4 | loss: 0.1631793
	speed: 0.0030s/iter; left time: 51.7841s
Epoch: 4 cost time: 3.3385720252990723
Epoch: 4, Steps: 1072 | Train Loss: 0.3090795 Vali Loss: 0.1850937 Test Loss: 0.2580087
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_SOFTS_ETTm2_ftM_sl96_ll48_pl192_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.24607495783507344, mae:0.3053960551734909
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTm2_96_336', model='SOFTS', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_SOFTS_ETTm2_ftM_sl96_ll48_pl336_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4844212
	speed: 0.0097s/iter; left time: 205.4828s
	iters: 200, epoch: 1 | loss: 0.2600962
	speed: 0.0034s/iter; left time: 72.5952s
	iters: 300, epoch: 1 | loss: 0.2806766
	speed: 0.0035s/iter; left time: 72.7003s
	iters: 400, epoch: 1 | loss: 0.8536222
	speed: 0.0034s/iter; left time: 71.4970s
	iters: 500, epoch: 1 | loss: 0.3616396
	speed: 0.0034s/iter; left time: 71.5261s
	iters: 600, epoch: 1 | loss: 0.2090271
	speed: 0.0034s/iter; left time: 70.6033s
	iters: 700, epoch: 1 | loss: 0.3599246
	speed: 0.0035s/iter; left time: 71.5730s
	iters: 800, epoch: 1 | loss: 0.2394306
	speed: 0.0034s/iter; left time: 69.6756s
	iters: 900, epoch: 1 | loss: 0.6669261
	speed: 0.0034s/iter; left time: 69.0301s
	iters: 1000, epoch: 1 | loss: 0.3545206
	speed: 0.0034s/iter; left time: 69.2571s
Epoch: 1 cost time: 3.9779348373413086
Epoch: 1, Steps: 1067 | Train Loss: 0.4070285 Vali Loss: 0.2337266 Test Loss: 0.3244598
Validation loss decreased (inf --> 0.233727).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.6529716
	speed: 0.0199s/iter; left time: 400.9694s
	iters: 200, epoch: 2 | loss: 0.3622365
	speed: 0.0034s/iter; left time: 68.5513s
	iters: 300, epoch: 2 | loss: 0.2888606
	speed: 0.0034s/iter; left time: 68.1601s
	iters: 400, epoch: 2 | loss: 0.2954814
	speed: 0.0035s/iter; left time: 68.7259s
	iters: 500, epoch: 2 | loss: 0.2687351
	speed: 0.0035s/iter; left time: 68.3221s
	iters: 600, epoch: 2 | loss: 0.2921618
	speed: 0.0034s/iter; left time: 67.7680s
	iters: 700, epoch: 2 | loss: 0.2966535
	speed: 0.0034s/iter; left time: 67.2334s
	iters: 800, epoch: 2 | loss: 0.3695536
	speed: 0.0034s/iter; left time: 66.7572s
	iters: 900, epoch: 2 | loss: 0.3398273
	speed: 0.0034s/iter; left time: 66.1389s
	iters: 1000, epoch: 2 | loss: 0.9079319
	speed: 0.0035s/iter; left time: 66.6983s
Epoch: 2 cost time: 3.7294085025787354
Epoch: 2, Steps: 1067 | Train Loss: 0.4074413 Vali Loss: 0.2331977 Test Loss: 0.3068962
Validation loss decreased (0.233727 --> 0.233198).  Saving model ...
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.4583940
	speed: 0.0200s/iter; left time: 382.0255s
	iters: 200, epoch: 3 | loss: 0.3929763
	speed: 0.0033s/iter; left time: 61.9870s
	iters: 300, epoch: 3 | loss: 0.2923467
	speed: 0.0033s/iter; left time: 61.6591s
	iters: 400, epoch: 3 | loss: 0.1800442
	speed: 0.0033s/iter; left time: 61.5429s
	iters: 500, epoch: 3 | loss: 0.1982731
	speed: 0.0033s/iter; left time: 61.0392s
	iters: 600, epoch: 3 | loss: 0.2721406
	speed: 0.0034s/iter; left time: 62.4370s
	iters: 700, epoch: 3 | loss: 0.3146610
	speed: 0.0032s/iter; left time: 58.4935s
	iters: 800, epoch: 3 | loss: 0.2175709
	speed: 0.0030s/iter; left time: 55.6119s
	iters: 900, epoch: 3 | loss: 0.4057070
	speed: 0.0031s/iter; left time: 56.9448s
	iters: 1000, epoch: 3 | loss: 0.3618231
	speed: 0.0031s/iter; left time: 57.2054s
Epoch: 3 cost time: 3.5087106227874756
Epoch: 3, Steps: 1067 | Train Loss: 0.3093937 Vali Loss: 0.2387626 Test Loss: 0.3163966
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.1662647
	speed: 0.0193s/iter; left time: 348.5403s
	iters: 200, epoch: 4 | loss: 0.3536671
	speed: 0.0031s/iter; left time: 56.2195s
	iters: 300, epoch: 4 | loss: 0.3404540
	speed: 0.0031s/iter; left time: 55.7543s
	iters: 400, epoch: 4 | loss: 0.2694238
	speed: 0.0031s/iter; left time: 55.8677s
	iters: 500, epoch: 4 | loss: 0.2658425
	speed: 0.0031s/iter; left time: 54.3716s
	iters: 600, epoch: 4 | loss: 0.2942302
	speed: 0.0030s/iter; left time: 52.7625s
	iters: 700, epoch: 4 | loss: 0.4709357
	speed: 0.0030s/iter; left time: 52.9943s
	iters: 800, epoch: 4 | loss: 0.2898545
	speed: 0.0030s/iter; left time: 52.2117s
	iters: 900, epoch: 4 | loss: 0.2362535
	speed: 0.0030s/iter; left time: 52.0542s
	iters: 1000, epoch: 4 | loss: 0.2473490
	speed: 0.0030s/iter; left time: 51.6194s
Epoch: 4 cost time: 3.3604440689086914
Epoch: 4, Steps: 1067 | Train Loss: 0.2934275 Vali Loss: 0.2282407 Test Loss: 0.3140611
Validation loss decreased (0.233198 --> 0.228241).  Saving model ...
Updating learning rate to 0.0002713525491562421
	iters: 100, epoch: 5 | loss: 0.1982718
	speed: 0.0196s/iter; left time: 333.0333s
	iters: 200, epoch: 5 | loss: 0.1912253
	speed: 0.0032s/iter; left time: 54.4118s
	iters: 300, epoch: 5 | loss: 0.3411022
	speed: 0.0032s/iter; left time: 53.8052s
	iters: 400, epoch: 5 | loss: 0.2815127
	speed: 0.0030s/iter; left time: 50.3325s
	iters: 500, epoch: 5 | loss: 0.4206812
	speed: 0.0031s/iter; left time: 50.6118s
	iters: 600, epoch: 5 | loss: 0.2015879
	speed: 0.0031s/iter; left time: 51.5430s
	iters: 700, epoch: 5 | loss: 0.3880417
	speed: 0.0031s/iter; left time: 50.4490s
	iters: 800, epoch: 5 | loss: 0.3402122
	speed: 0.0031s/iter; left time: 49.9641s
	iters: 900, epoch: 5 | loss: 0.2634350
	speed: 0.0031s/iter; left time: 49.4997s
	iters: 1000, epoch: 5 | loss: 0.4563852
	speed: 0.0031s/iter; left time: 50.0737s
Epoch: 5 cost time: 3.3994390964508057
Epoch: 5, Steps: 1067 | Train Loss: 0.3082455 Vali Loss: 0.2457980 Test Loss: 0.3312039
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025606601717798207
	iters: 100, epoch: 6 | loss: 0.1832271
	speed: 0.0190s/iter; left time: 302.5684s
	iters: 200, epoch: 6 | loss: 0.2749303
	speed: 0.0031s/iter; left time: 49.5994s
	iters: 300, epoch: 6 | loss: 0.2517725
	speed: 0.0031s/iter; left time: 47.9475s
	iters: 400, epoch: 6 | loss: 0.2244805
	speed: 0.0032s/iter; left time: 49.1955s
	iters: 500, epoch: 6 | loss: 0.2399979
	speed: 0.0032s/iter; left time: 49.9381s
	iters: 600, epoch: 6 | loss: 0.2352135
	speed: 0.0033s/iter; left time: 50.4077s
	iters: 700, epoch: 6 | loss: 0.2312902
	speed: 0.0032s/iter; left time: 48.9089s
	iters: 800, epoch: 6 | loss: 0.2241050
	speed: 0.0031s/iter; left time: 47.7747s
	iters: 900, epoch: 6 | loss: 0.1907967
	speed: 0.0031s/iter; left time: 47.4216s
	iters: 1000, epoch: 6 | loss: 0.3993597
	speed: 0.0032s/iter; left time: 47.7135s
Epoch: 6 cost time: 3.446422815322876
Epoch: 6, Steps: 1067 | Train Loss: 0.2455173 Vali Loss: 0.2423151 Test Loss: 0.3377438
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00023816778784387094
	iters: 100, epoch: 7 | loss: 0.3177473
	speed: 0.0194s/iter; left time: 287.3969s
	iters: 200, epoch: 7 | loss: 0.2545313
	speed: 0.0034s/iter; left time: 50.3291s
	iters: 300, epoch: 7 | loss: 0.3290330
	speed: 0.0034s/iter; left time: 50.1393s
	iters: 400, epoch: 7 | loss: 0.2445514
	speed: 0.0034s/iter; left time: 50.1565s
	iters: 500, epoch: 7 | loss: 0.1975524
	speed: 0.0034s/iter; left time: 49.6822s
	iters: 600, epoch: 7 | loss: 0.2430544
	speed: 0.0035s/iter; left time: 49.7179s
	iters: 700, epoch: 7 | loss: 0.2331876
	speed: 0.0034s/iter; left time: 48.6871s
	iters: 800, epoch: 7 | loss: 0.2530883
	speed: 0.0034s/iter; left time: 48.7068s
	iters: 900, epoch: 7 | loss: 0.2793587
	speed: 0.0035s/iter; left time: 48.4841s
	iters: 1000, epoch: 7 | loss: 0.2332562
	speed: 0.0034s/iter; left time: 47.6991s
Epoch: 7 cost time: 3.7361106872558594
Epoch: 7, Steps: 1067 | Train Loss: 0.2585360 Vali Loss: 0.2340008 Test Loss: 0.3243318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_SOFTS_ETTm2_ftM_sl96_ll48_pl336_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.31406105375471105, mae:0.34885585441166234
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTm2_96_720', model='SOFTS', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_SOFTS_ETTm2_ftM_sl96_ll48_pl720_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7796726
	speed: 0.0100s/iter; left time: 209.3008s
	iters: 200, epoch: 1 | loss: 0.3725439
	speed: 0.0038s/iter; left time: 80.2684s
	iters: 300, epoch: 1 | loss: 1.0663332
	speed: 0.0038s/iter; left time: 79.1784s
	iters: 400, epoch: 1 | loss: 0.4869829
	speed: 0.0039s/iter; left time: 79.7216s
	iters: 500, epoch: 1 | loss: 0.3563046
	speed: 0.0039s/iter; left time: 80.4986s
	iters: 600, epoch: 1 | loss: 0.5599146
	speed: 0.0038s/iter; left time: 78.7848s
	iters: 700, epoch: 1 | loss: 0.4551631
	speed: 0.0039s/iter; left time: 79.3785s
	iters: 800, epoch: 1 | loss: 0.5076951
	speed: 0.0039s/iter; left time: 79.3733s
	iters: 900, epoch: 1 | loss: 0.6755277
	speed: 0.0038s/iter; left time: 76.3001s
	iters: 1000, epoch: 1 | loss: 0.6875558
	speed: 0.0035s/iter; left time: 71.0024s
Epoch: 1 cost time: 4.350013256072998
Epoch: 1, Steps: 1055 | Train Loss: 0.5947693 Vali Loss: 0.2993401 Test Loss: 0.4099846
Validation loss decreased (inf --> 0.299340).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.8783959
	speed: 0.0220s/iter; left time: 439.4974s
	iters: 200, epoch: 2 | loss: 0.6847299
	speed: 0.0035s/iter; left time: 68.8566s
	iters: 300, epoch: 2 | loss: 0.5684343
	speed: 0.0035s/iter; left time: 69.0342s
	iters: 400, epoch: 2 | loss: 0.3067742
	speed: 0.0034s/iter; left time: 67.5293s
	iters: 500, epoch: 2 | loss: 0.6827209
	speed: 0.0034s/iter; left time: 66.4805s
	iters: 600, epoch: 2 | loss: 0.3964404
	speed: 0.0034s/iter; left time: 66.9117s
	iters: 700, epoch: 2 | loss: 0.4884630
	speed: 0.0034s/iter; left time: 66.2888s
	iters: 800, epoch: 2 | loss: 0.4241749
	speed: 0.0034s/iter; left time: 66.2051s
	iters: 900, epoch: 2 | loss: 0.7866630
	speed: 0.0034s/iter; left time: 65.7581s
	iters: 1000, epoch: 2 | loss: 0.4759531
	speed: 0.0034s/iter; left time: 65.6152s
Epoch: 2 cost time: 3.7189786434173584
Epoch: 2, Steps: 1055 | Train Loss: 0.5692750 Vali Loss: 0.3052446 Test Loss: 0.4076931
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.3009235
	speed: 0.0213s/iter; left time: 402.5274s
	iters: 200, epoch: 3 | loss: 0.8646864
	speed: 0.0034s/iter; left time: 64.1321s
	iters: 300, epoch: 3 | loss: 0.3078963
	speed: 0.0034s/iter; left time: 64.0681s
	iters: 400, epoch: 3 | loss: 0.5381995
	speed: 0.0035s/iter; left time: 64.7131s
	iters: 500, epoch: 3 | loss: 0.3066475
	speed: 0.0034s/iter; left time: 63.6699s
	iters: 600, epoch: 3 | loss: 0.6028748
	speed: 0.0036s/iter; left time: 65.4685s
	iters: 700, epoch: 3 | loss: 0.3488450
	speed: 0.0035s/iter; left time: 63.8177s
	iters: 800, epoch: 3 | loss: 0.3915969
	speed: 0.0035s/iter; left time: 63.1604s
	iters: 900, epoch: 3 | loss: 0.6881974
	speed: 0.0035s/iter; left time: 62.7867s
	iters: 1000, epoch: 3 | loss: 0.4261920
	speed: 0.0035s/iter; left time: 62.2959s
Epoch: 3 cost time: 3.7369625568389893
Epoch: 3, Steps: 1055 | Train Loss: 0.4776059 Vali Loss: 0.3104968 Test Loss: 0.4111707
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.4410360
	speed: 0.0213s/iter; left time: 380.7858s
	iters: 200, epoch: 4 | loss: 0.4078238
	speed: 0.0036s/iter; left time: 64.5745s
	iters: 300, epoch: 4 | loss: 0.3946830
	speed: 0.0035s/iter; left time: 61.9957s
	iters: 400, epoch: 4 | loss: 0.4196970
	speed: 0.0035s/iter; left time: 62.0213s
	iters: 500, epoch: 4 | loss: 0.3234136
	speed: 0.0034s/iter; left time: 59.6303s
	iters: 600, epoch: 4 | loss: 0.3276281
	speed: 0.0034s/iter; left time: 59.6931s
	iters: 700, epoch: 4 | loss: 0.2234292
	speed: 0.0034s/iter; left time: 59.1406s
	iters: 800, epoch: 4 | loss: 0.4897588
	speed: 0.0034s/iter; left time: 58.5343s
	iters: 900, epoch: 4 | loss: 0.6021795
	speed: 0.0034s/iter; left time: 58.5721s
	iters: 1000, epoch: 4 | loss: 0.4607077
	speed: 0.0034s/iter; left time: 57.7397s
Epoch: 4 cost time: 3.7368526458740234
Epoch: 4, Steps: 1055 | Train Loss: 0.4090357 Vali Loss: 0.3191656 Test Loss: 0.4307953
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_SOFTS_ETTm2_ftM_sl96_ll48_pl720_dm256_el2_dl1_df128_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.40998456149440754, mae:0.4045035070417634
