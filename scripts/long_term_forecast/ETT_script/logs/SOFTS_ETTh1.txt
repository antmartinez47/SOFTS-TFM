model_name=SOFTS

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTh1.csv \
  --model_id ETTh1_96_96 \
  --model $model_name \
  --data ETTh1 \
  --features M \
  --seq_len 96 \
  --pred_len 96 \
  --e_layers 1 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 256 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTh1.csv \
  --model_id ETTh1_96_192 \
  --model $model_name \
  --data ETTh1 \
  --features M \
  --seq_len 96 \
  --pred_len 192 \
  --e_layers 1 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 256 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTh1.csv \
  --model_id ETTh1_96_336 \
  --model $model_name \
  --data ETTh1 \
  --features M \
  --seq_len 96 \
  --pred_len 336 \
  --e_layers 1 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 512 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

python -u run.py \
  --is_training 1 \
  --root_path ./dataset/ETT-small/ \
  --data_path ETTh1.csv \
  --model_id ETTh1_96_720 \
  --model $model_name \
  --data ETTh1 \
  --features M \
  --seq_len 96 \
  --pred_len 720 \
  --e_layers 1 \
  --enc_in 7 \
  --dec_in 7 \
  --c_out 7 \
  --d_model 256 \
  --d_core 256 \
  --d_ff 512 \
  --learning_rate 0.0003 \
  --lradj cosine \
  --train_epochs 20 \
  --patience 3 \
  --des 'Exp' \
  --itr 1

Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTh1_96_96', model='SOFTS', data='ETTh1', root_path='./dataset/ETT-small/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=1, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_SOFTS_ETTh1_ftM_sl96_ll48_pl96_dm256_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3252135
	speed: 0.0088s/iter; left time: 45.6342s
	iters: 200, epoch: 1 | loss: 0.3121188
	speed: 0.0024s/iter; left time: 11.9912s
Epoch: 1 cost time: 0.9571685791015625
Epoch: 1, Steps: 265 | Train Loss: 0.3186662 Vali Loss: 0.7173146 Test Loss: 0.3874457
Validation loss decreased (inf --> 0.717315).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.2939446
	speed: 0.0081s/iter; left time: 40.0877s
	iters: 200, epoch: 2 | loss: 0.3138899
	speed: 0.0024s/iter; left time: 11.7065s
Epoch: 2 cost time: 0.6984236240386963
Epoch: 2, Steps: 265 | Train Loss: 0.3039173 Vali Loss: 0.6968849 Test Loss: 0.3829259
Validation loss decreased (0.717315 --> 0.696885).  Saving model ...
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.3437504
	speed: 0.0083s/iter; left time: 38.6767s
	iters: 200, epoch: 3 | loss: 0.3218291
	speed: 0.0023s/iter; left time: 10.3899s
Epoch: 3 cost time: 0.6793551445007324
Epoch: 3, Steps: 265 | Train Loss: 0.3327898 Vali Loss: 0.6861305 Test Loss: 0.3842463
Validation loss decreased (0.696885 --> 0.686131).  Saving model ...
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.3686881
	speed: 0.0079s/iter; left time: 34.7768s
	iters: 200, epoch: 4 | loss: 0.3169488
	speed: 0.0023s/iter; left time: 9.9111s
Epoch: 4 cost time: 0.6642415523529053
Epoch: 4, Steps: 265 | Train Loss: 0.3428185 Vali Loss: 0.6827022 Test Loss: 0.3817697
Validation loss decreased (0.686131 --> 0.682702).  Saving model ...
Updating learning rate to 0.0002713525491562421
	iters: 100, epoch: 5 | loss: 0.2951711
	speed: 0.0081s/iter; left time: 33.6603s
	iters: 200, epoch: 5 | loss: 0.3719594
	speed: 0.0024s/iter; left time: 9.8180s
Epoch: 5 cost time: 0.7110331058502197
Epoch: 5, Steps: 265 | Train Loss: 0.3335653 Vali Loss: 0.6921835 Test Loss: 0.3865087
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025606601717798207
	iters: 100, epoch: 6 | loss: 0.3891836
	speed: 0.0081s/iter; left time: 31.5145s
	iters: 200, epoch: 6 | loss: 0.3162140
	speed: 0.0024s/iter; left time: 9.2410s
Epoch: 6 cost time: 0.7077817916870117
Epoch: 6, Steps: 265 | Train Loss: 0.3526988 Vali Loss: 0.6950548 Test Loss: 0.3853053
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00023816778784387094
	iters: 100, epoch: 7 | loss: 0.4176768
	speed: 0.0080s/iter; left time: 28.8517s
	iters: 200, epoch: 7 | loss: 0.3346636
	speed: 0.0023s/iter; left time: 8.0233s
Epoch: 7 cost time: 0.6615822315216064
Epoch: 7, Steps: 265 | Train Loss: 0.3761702 Vali Loss: 0.6980206 Test Loss: 0.3863887
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_SOFTS_ETTh1_ftM_sl96_ll48_pl96_dm256_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38176965506971416, mae:0.400815273294329
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTh1_96_192', model='SOFTS', data='ETTh1', root_path='./dataset/ETT-small/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=1, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_SOFTS_ETTh1_ftM_sl96_ll48_pl192_dm256_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3584896
	speed: 0.0089s/iter; left time: 45.7768s
	iters: 200, epoch: 1 | loss: 0.3984671
	speed: 0.0025s/iter; left time: 12.5450s
Epoch: 1 cost time: 0.9839167594909668
Epoch: 1, Steps: 262 | Train Loss: 0.3784784 Vali Loss: 1.0083874 Test Loss: 0.4416266
Validation loss decreased (inf --> 1.008387).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.4467918
	speed: 0.0083s/iter; left time: 40.5658s
	iters: 200, epoch: 2 | loss: 0.4647919
	speed: 0.0024s/iter; left time: 11.3595s
Epoch: 2 cost time: 0.6883158683776855
Epoch: 2, Steps: 262 | Train Loss: 0.4557918 Vali Loss: 0.9938323 Test Loss: 0.4356255
Validation loss decreased (1.008387 --> 0.993832).  Saving model ...
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.5062852
	speed: 0.0081s/iter; left time: 37.4441s
	iters: 200, epoch: 3 | loss: 0.4099806
	speed: 0.0023s/iter; left time: 10.4606s
Epoch: 3 cost time: 0.6883771419525146
Epoch: 3, Steps: 262 | Train Loss: 0.4581329 Vali Loss: 0.9909888 Test Loss: 0.4365895
Validation loss decreased (0.993832 --> 0.990989).  Saving model ...
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.3903821
	speed: 0.0084s/iter; left time: 36.3707s
	iters: 200, epoch: 4 | loss: 0.3774732
	speed: 0.0023s/iter; left time: 9.9419s
Epoch: 4 cost time: 0.6732895374298096
Epoch: 4, Steps: 262 | Train Loss: 0.3839277 Vali Loss: 0.9938608 Test Loss: 0.4399043
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002713525491562421
	iters: 100, epoch: 5 | loss: 0.4240893
	speed: 0.0081s/iter; left time: 33.1617s
	iters: 200, epoch: 5 | loss: 0.4278731
	speed: 0.0024s/iter; left time: 9.4411s
Epoch: 5 cost time: 0.6774952411651611
Epoch: 5, Steps: 262 | Train Loss: 0.4259812 Vali Loss: 0.9987722 Test Loss: 0.4467883
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025606601717798207
	iters: 100, epoch: 6 | loss: 0.3840761
	speed: 0.0079s/iter; left time: 30.4141s
	iters: 200, epoch: 6 | loss: 0.4432012
	speed: 0.0024s/iter; left time: 8.8625s
Epoch: 6 cost time: 0.682187557220459
Epoch: 6, Steps: 262 | Train Loss: 0.4136387 Vali Loss: 1.0059955 Test Loss: 0.4456905
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_SOFTS_ETTh1_ftM_sl96_ll48_pl192_dm256_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.4365894775512095, mae:0.4327285910193563
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTh1_96_336', model='SOFTS', data='ETTh1', root_path='./dataset/ETT-small/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=1, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_SOFTS_ETTh1_ftM_sl96_ll48_pl336_dm256_el1_dl1_df512_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.4825617
	speed: 0.0088s/iter; left time: 44.5723s
	iters: 200, epoch: 1 | loss: 0.4418894
	speed: 0.0025s/iter; left time: 12.1329s
Epoch: 1 cost time: 0.964597225189209
Epoch: 1, Steps: 257 | Train Loss: 0.4622256 Vali Loss: 1.2899505 Test Loss: 0.4791289
Validation loss decreased (inf --> 1.289950).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.4587005
	speed: 0.0085s/iter; left time: 40.7903s
	iters: 200, epoch: 2 | loss: 0.4151414
	speed: 0.0026s/iter; left time: 12.1200s
Epoch: 2 cost time: 0.753847599029541
Epoch: 2, Steps: 257 | Train Loss: 0.4369209 Vali Loss: 1.2971492 Test Loss: 0.4913918
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.4818308
	speed: 0.0091s/iter; left time: 40.9741s
	iters: 200, epoch: 3 | loss: 0.4575655
	speed: 0.0028s/iter; left time: 12.2379s
Epoch: 3 cost time: 0.7828543186187744
Epoch: 3, Steps: 257 | Train Loss: 0.4696981 Vali Loss: 1.2944027 Test Loss: 0.4924417
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.4502961
	speed: 0.0090s/iter; left time: 38.2761s
	iters: 200, epoch: 4 | loss: 0.4768096
	speed: 0.0026s/iter; left time: 11.0089s
Epoch: 4 cost time: 0.7592923641204834
Epoch: 4, Steps: 257 | Train Loss: 0.4635528 Vali Loss: 1.2989906 Test Loss: 0.4870418
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_SOFTS_ETTh1_ftM_sl96_ll48_pl336_dm256_el1_dl1_df512_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.47912886620504685, mae:0.4518972551892923
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ETTh1_96_720', model='SOFTS', data='ETTh1', root_path='./dataset/ETT-small/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, seasonal_patterns='Monthly', enc_in=7, dec_in=7, c_out=7, d_model=256, d_core=256, e_layers=1, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.0, embed='timeF', activation='gelu', output_attention=False, attention_type='full', use_norm=True, num_workers=4, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0003, des='Exp', loss='MSE', lradj='cosine', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_model=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_720_SOFTS_ETTh1_ftM_sl96_ll48_pl720_dm256_el1_dl1_df512_fc1_ebtimeF_dtTrue_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6879762
	speed: 0.0092s/iter; left time: 44.2362s
	iters: 200, epoch: 1 | loss: 0.5977634
	speed: 0.0029s/iter; left time: 13.7773s
Epoch: 1 cost time: 1.0428662300109863
Epoch: 1, Steps: 245 | Train Loss: 0.6428698 Vali Loss: 1.5647272 Test Loss: 0.4986124
Validation loss decreased (inf --> 1.564727).  Saving model ...
Updating learning rate to 0.00029815325108927063
	iters: 100, epoch: 2 | loss: 0.7023479
	speed: 0.0087s/iter; left time: 39.5501s
	iters: 200, epoch: 2 | loss: 0.5796603
	speed: 0.0027s/iter; left time: 12.0111s
Epoch: 2 cost time: 0.7332198619842529
Epoch: 2, Steps: 245 | Train Loss: 0.6410041 Vali Loss: 1.5685535 Test Loss: 0.4913039
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029265847744427303
	iters: 100, epoch: 3 | loss: 0.5518371
	speed: 0.0086s/iter; left time: 36.8628s
	iters: 200, epoch: 3 | loss: 0.5819700
	speed: 0.0027s/iter; left time: 11.3180s
Epoch: 3 cost time: 0.7214617729187012
Epoch: 3, Steps: 245 | Train Loss: 0.5669036 Vali Loss: 1.5929933 Test Loss: 0.5150934
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00028365097862825513
	iters: 100, epoch: 4 | loss: 0.5049741
	speed: 0.0085s/iter; left time: 34.3615s
	iters: 200, epoch: 4 | loss: 0.4771929
	speed: 0.0027s/iter; left time: 10.8141s
Epoch: 4 cost time: 0.7392275333404541
Epoch: 4, Steps: 245 | Train Loss: 0.4910835 Vali Loss: 1.6248990 Test Loss: 0.5128118
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_720_SOFTS_ETTh1_ftM_sl96_ll48_pl720_dm256_el1_dl1_df512_fc1_ebtimeF_dtTrue_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.49861238045253337, mae:0.4879847408058135
