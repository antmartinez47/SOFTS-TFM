horizon=192
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123 \
    --restore_experiment;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023508577801, 'e_layers': 1, 'learning_rate': 0.0004821026935, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5834060
	speed: 0.0110s/iter; left time: 21.8912s
	iters: 200, epoch: 1 | loss: 0.4136868
	speed: 0.0026s/iter; left time: 4.9615s
Updating learning rate to 0.00046375375229660605
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 1.109208106994629
Epoch: 1, Steps: 262 | Train Loss: 0.4985464 Vali Loss: 0.2883522 Best vali loss: 0.2883522
	iters: 100, epoch: 2 | loss: 0.7534162
	speed: 0.0066s/iter; left time: 11.4436s
	iters: 200, epoch: 2 | loss: 0.4541170
	speed: 0.0026s/iter; left time: 4.3139s
Updating learning rate to 0.00041150038865107484
Validation loss decreased (0.2884 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.7309658527374268
Epoch: 2, Steps: 262 | Train Loss: 0.6037666 Vali Loss: 0.2826518 Best vali loss: 0.2826518
	iters: 100, epoch: 3 | loss: 0.3558559
	speed: 0.0061s/iter; left time: 8.9315s
	iters: 200, epoch: 3 | loss: 0.2422653
	speed: 0.0024s/iter; left time: 3.2897s
Updating learning rate to 0.0003332977035005174
Validation loss decreased (0.2827 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 0.6671090126037598
Epoch: 3, Steps: 262 | Train Loss: 0.2990606 Vali Loss: 0.2823314 Best vali loss: 0.2823314

best validation loss 0.28233136732079983

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9386364
	speed: 0.0104s/iter; left time: 42.5022s
	iters: 200, epoch: 1 | loss: 0.6114913
	speed: 0.0049s/iter; left time: 19.6555s
	iters: 300, epoch: 1 | loss: 0.7728357
	speed: 0.0046s/iter; left time: 18.0078s
	iters: 400, epoch: 1 | loss: 0.2932993
	speed: 0.0046s/iter; left time: 17.2718s
	iters: 500, epoch: 1 | loss: 0.6511849
	speed: 0.0046s/iter; left time: 16.8112s
Updating learning rate to 0.0015120382784
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 2.7766802310943604
Epoch: 1, Steps: 523 | Train Loss: 0.6534895 Vali Loss: 0.2840199 Best vali loss: 0.2840199
	iters: 100, epoch: 2 | loss: 0.4304247
	speed: 0.0106s/iter; left time: 37.7952s
	iters: 200, epoch: 2 | loss: 0.2752168
	speed: 0.0051s/iter; left time: 17.5462s
	iters: 300, epoch: 2 | loss: 0.3249710
	speed: 0.0048s/iter; left time: 16.1396s
	iters: 400, epoch: 2 | loss: 0.4503768
	speed: 0.0047s/iter; left time: 15.4643s
	iters: 500, epoch: 2 | loss: 1.3678914
	speed: 0.0047s/iter; left time: 14.7578s
Updating learning rate to 0.0007560191392
Epoch: 2 cost time: 2.589891195297241
Epoch: 2, Steps: 523 | Train Loss: 0.5697761 Vali Loss: 0.2955073 Best vali loss: 0.2840199
	iters: 100, epoch: 3 | loss: 0.4413143
	speed: 0.0105s/iter; left time: 32.0044s
	iters: 200, epoch: 3 | loss: 0.4337928
	speed: 0.0049s/iter; left time: 14.3852s
	iters: 300, epoch: 3 | loss: 0.3884105
	speed: 0.0048s/iter; left time: 13.7536s
	iters: 400, epoch: 3 | loss: 0.3835309
	speed: 0.0050s/iter; left time: 13.6639s
	iters: 500, epoch: 3 | loss: 0.2474844
	speed: 0.0048s/iter; left time: 12.6817s
Updating learning rate to 0.0003780095696
Epoch: 3 cost time: 2.6411921977996826
Epoch: 3, Steps: 523 | Train Loss: 0.3789066 Vali Loss: 0.2912091 Best vali loss: 0.2840199

best validation loss 0.28401992631561473

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8074170
	speed: 0.0085s/iter; left time: 8.1121s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.2951).  Saving model state dict ...
Epoch: 1 cost time: 0.6912119388580322
Epoch: 1, Steps: 131 | Train Loss: 0.8074170 Vali Loss: 0.2951197 Best vali loss: 0.2951197
	iters: 100, epoch: 2 | loss: 0.6121553
	speed: 0.0058s/iter; left time: 4.7722s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.2951 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 0.41416311264038086
Epoch: 2, Steps: 131 | Train Loss: 0.6121553 Vali Loss: 0.2836582 Best vali loss: 0.2836582
	iters: 100, epoch: 3 | loss: 0.6417097
	speed: 0.0056s/iter; left time: 3.8589s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.2837 --> 0.2811).  Saving model state dict ...
Epoch: 3 cost time: 0.4128086566925049
Epoch: 3, Steps: 131 | Train Loss: 0.6417097 Vali Loss: 0.2810964 Best vali loss: 0.2810964

best validation loss 0.2810963552463183

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7595145
	speed: 0.0085s/iter; left time: 4.7039s
Updating learning rate to 0.0001298368129
Epoch: 4 cost time: 0.6666538715362549
Epoch: 4, Steps: 131 | Train Loss: 0.7595145 Vali Loss: 0.2820223 Best vali loss: 0.2810964
	iters: 100, epoch: 5 | loss: 0.5689502
	speed: 0.0059s/iter; left time: 2.5007s
Updating learning rate to 8.015041569208405e-05
Epoch: 5 cost time: 0.4367337226867676
Epoch: 5, Steps: 131 | Train Loss: 0.5689502 Vali Loss: 0.2811684 Best vali loss: 0.2810964
	iters: 100, epoch: 6 | loss: 0.6173996
	speed: 0.0057s/iter; left time: 1.6807s
Updating learning rate to 3.8028322050761e-05
Epoch: 6 cost time: 0.43091797828674316
Epoch: 6, Steps: 131 | Train Loss: 0.6173996 Vali Loss: 0.2812747 Best vali loss: 0.2810964
	iters: 100, epoch: 7 | loss: 0.4363810
	speed: 0.0056s/iter; left time: 0.9177s
Updating learning rate to 9.883238895192597e-06
Epoch: 7 cost time: 0.4171738624572754
Epoch: 7, Steps: 131 | Train Loss: 0.4363810 Vali Loss: 0.2811638 Best vali loss: 0.2810964
	iters: 100, epoch: 8 | loss: 0.3696127
	speed: 0.0057s/iter; left time: 0.1830s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.42835354804992676
Epoch: 8, Steps: 131 | Train Loss: 0.3696127 Vali Loss: 0.2812959 Best vali loss: 0.2810964

best validation loss 0.2810963552463183

[INFO][abstract_intensifier.py:516] Added config e98a6b as new incumbent because there are no incumbents yet.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012865813859, 'e_layers': 2, 'learning_rate': 0.0003414993649, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3352718
	speed: 0.0090s/iter; left time: 18.0305s
	iters: 200, epoch: 1 | loss: 0.5555092
	speed: 0.0033s/iter; left time: 6.3309s
Updating learning rate to 0.0003414993649
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.2010447978973389
Epoch: 1, Steps: 262 | Train Loss: 0.4453905 Vali Loss: 0.2856293 Best vali loss: 0.2856293
	iters: 100, epoch: 2 | loss: 0.6429988
	speed: 0.0086s/iter; left time: 14.9019s
	iters: 200, epoch: 2 | loss: 0.6578826
	speed: 0.0036s/iter; left time: 5.9166s
Updating learning rate to 0.00017074968245
Validation loss decreased (0.2856 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 1.0060243606567383
Epoch: 2, Steps: 262 | Train Loss: 0.6504407 Vali Loss: 0.2823917 Best vali loss: 0.2823917
	iters: 100, epoch: 3 | loss: 0.2930568
	speed: 0.0086s/iter; left time: 12.6845s
	iters: 200, epoch: 3 | loss: 0.8542147
	speed: 0.0036s/iter; left time: 4.9244s
Updating learning rate to 8.5374841225e-05
Epoch: 3 cost time: 1.004624605178833
Epoch: 3, Steps: 262 | Train Loss: 0.5736358 Vali Loss: 0.2981294 Best vali loss: 0.2823917
	iters: 100, epoch: 4 | loss: 0.3411630
	speed: 0.0086s/iter; left time: 10.4611s
	iters: 200, epoch: 4 | loss: 0.4738437
	speed: 0.0038s/iter; left time: 4.2051s
Updating learning rate to 4.26874206125e-05
Epoch: 4 cost time: 1.0512664318084717
Epoch: 4, Steps: 262 | Train Loss: 0.4075034 Vali Loss: 0.2960947 Best vali loss: 0.2823917
	iters: 100, epoch: 5 | loss: 0.2839885
	speed: 0.0087s/iter; left time: 8.2175s
	iters: 200, epoch: 5 | loss: 0.3576979
	speed: 0.0036s/iter; left time: 3.0472s
Updating learning rate to 2.134371030625e-05
Epoch: 5 cost time: 1.0011966228485107
Epoch: 5, Steps: 262 | Train Loss: 0.3208432 Vali Loss: 0.3004309 Best vali loss: 0.2823917
	iters: 100, epoch: 6 | loss: 0.3215562
	speed: 0.0083s/iter; left time: 5.6801s
	iters: 200, epoch: 6 | loss: 0.4806418
	speed: 0.0035s/iter; left time: 2.0531s
Updating learning rate to 1.0671855153125e-05
Epoch: 6 cost time: 0.9690911769866943
Epoch: 6, Steps: 262 | Train Loss: 0.4010990 Vali Loss: 0.3056654 Best vali loss: 0.2823917
	iters: 100, epoch: 7 | loss: 0.6570817
	speed: 0.0082s/iter; left time: 3.4686s
	iters: 200, epoch: 7 | loss: 0.3752165
	speed: 0.0035s/iter; left time: 1.1436s
Updating learning rate to 5.3359275765625e-06
Epoch: 7 cost time: 0.9767873287200928
Epoch: 7, Steps: 262 | Train Loss: 0.5161491 Vali Loss: 0.2974821 Best vali loss: 0.2823917
	iters: 100, epoch: 8 | loss: 0.3465102
	speed: 0.0084s/iter; left time: 1.3691s
	iters: 200, epoch: 8 | loss: 0.4489002
	speed: 0.0035s/iter; left time: 0.2225s
Updating learning rate to 2.66796378828125e-06
Epoch: 8 cost time: 0.9841945171356201
Epoch: 8, Steps: 262 | Train Loss: 0.3977052 Vali Loss: 0.3024431 Best vali loss: 0.2823917

best validation loss 0.28239172242108046

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0033747601445, 'e_layers': 1, 'learning_rate': 0.0010195596024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5029868
	speed: 0.0086s/iter; left time: 8.1163s
Updating learning rate to 0.0009807549256163528
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 0.678523063659668
Epoch: 1, Steps: 131 | Train Loss: 0.5029868 Vali Loss: 0.2858818 Best vali loss: 0.2858818
	iters: 100, epoch: 2 | loss: 0.6639416
	speed: 0.0059s/iter; left time: 4.8015s
Updating learning rate to 0.0008702485555404501
Validation loss decreased (0.2859 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 0.43117356300354004
Epoch: 2, Steps: 131 | Train Loss: 0.6639416 Vali Loss: 0.2843009 Best vali loss: 0.2843009
	iters: 100, epoch: 3 | loss: 0.5425340
	speed: 0.0058s/iter; left time: 4.0158s
Updating learning rate to 0.0007048640852736092
Epoch: 3 cost time: 0.4208958148956299
Epoch: 3, Steps: 131 | Train Loss: 0.5425340 Vali Loss: 0.3034245 Best vali loss: 0.2843009
	iters: 100, epoch: 4 | loss: 0.4238728
	speed: 0.0057s/iter; left time: 3.1791s
Updating learning rate to 0.0005097798012
Epoch: 4 cost time: 0.41445088386535645
Epoch: 4, Steps: 131 | Train Loss: 0.4238728 Vali Loss: 0.3184402 Best vali loss: 0.2843009
	iters: 100, epoch: 5 | loss: 0.3398249
	speed: 0.0059s/iter; left time: 2.4889s
Updating learning rate to 0.00031469551712639095
Epoch: 5 cost time: 0.43441128730773926
Epoch: 5, Steps: 131 | Train Loss: 0.3398249 Vali Loss: 0.3162117 Best vali loss: 0.2843009
	iters: 100, epoch: 6 | loss: 0.2701750
	speed: 0.0058s/iter; left time: 1.7156s
Updating learning rate to 0.00014931104685954994
Epoch: 6 cost time: 0.4422128200531006
Epoch: 6, Steps: 131 | Train Loss: 0.2701750 Vali Loss: 0.3244301 Best vali loss: 0.2843009
	iters: 100, epoch: 7 | loss: 0.3188292
	speed: 0.0057s/iter; left time: 0.9246s
Updating learning rate to 3.880467678364731e-05
Epoch: 7 cost time: 0.43041396141052246
Epoch: 7, Steps: 131 | Train Loss: 0.3188292 Vali Loss: 0.3337255 Best vali loss: 0.2843009
	iters: 100, epoch: 8 | loss: 0.2580643
	speed: 0.0059s/iter; left time: 0.1897s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4320855140686035
Epoch: 8, Steps: 131 | Train Loss: 0.2580643 Vali Loss: 0.3369409 Best vali loss: 0.2843009

best validation loss 0.28430089233155675

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8625314
	speed: 0.0084s/iter; left time: 8.0101s
Updating learning rate to 0.0008036931396
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 0.6661281585693359
Epoch: 1, Steps: 131 | Train Loss: 0.8625314 Vali Loss: 0.2856309 Best vali loss: 0.2856309
	iters: 100, epoch: 2 | loss: 0.4061940
	speed: 0.0054s/iter; left time: 4.3772s
Updating learning rate to 0.0004018465698
Validation loss decreased (0.2856 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.39844703674316406
Epoch: 2, Steps: 131 | Train Loss: 0.4061940 Vali Loss: 0.2792235 Best vali loss: 0.2792235
	iters: 100, epoch: 3 | loss: 0.3649252
	speed: 0.0054s/iter; left time: 3.6974s
Updating learning rate to 0.0002009232849
Epoch: 3 cost time: 0.41401147842407227
Epoch: 3, Steps: 131 | Train Loss: 0.3649252 Vali Loss: 0.2911799 Best vali loss: 0.2792235

best validation loss 0.2792234520385282

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5729324
	speed: 0.0089s/iter; left time: 17.8705s
	iters: 200, epoch: 1 | loss: 0.7571976
	speed: 0.0034s/iter; left time: 6.5325s
Updating learning rate to 0.0006153270642
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 1.1836862564086914
Epoch: 1, Steps: 262 | Train Loss: 0.6650650 Vali Loss: 0.2847307 Best vali loss: 0.2847307
	iters: 100, epoch: 2 | loss: 0.5898519
	speed: 0.0076s/iter; left time: 13.2491s
	iters: 200, epoch: 2 | loss: 0.8020768
	speed: 0.0032s/iter; left time: 5.2068s
Updating learning rate to 0.0003076635321
Epoch: 2 cost time: 0.8776266574859619
Epoch: 2, Steps: 262 | Train Loss: 0.6959644 Vali Loss: 0.2867685 Best vali loss: 0.2847307
	iters: 100, epoch: 3 | loss: 0.4256902
	speed: 0.0072s/iter; left time: 10.5569s
	iters: 200, epoch: 3 | loss: 0.4387180
	speed: 0.0032s/iter; left time: 4.4378s
Updating learning rate to 0.00015383176605
Validation loss decreased (0.2847 --> 0.2843).  Saving model state dict ...
Epoch: 3 cost time: 0.8645048141479492
Epoch: 3, Steps: 262 | Train Loss: 0.4322041 Vali Loss: 0.2842613 Best vali loss: 0.2842613

best validation loss 0.2842612912183625

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0030607900961, 'e_layers': 1, 'learning_rate': 0.0002423804971, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7219207
	speed: 0.0076s/iter; left time: 15.0817s
	iters: 200, epoch: 1 | loss: 0.3849798
	speed: 0.0024s/iter; left time: 4.6463s
Updating learning rate to 0.0002423804971
Validation loss decreased (inf --> 0.2998).  Saving model state dict ...
Epoch: 1 cost time: 0.9176971912384033
Epoch: 1, Steps: 262 | Train Loss: 0.5534502 Vali Loss: 0.2998107 Best vali loss: 0.2998107
	iters: 100, epoch: 2 | loss: 0.4423367
	speed: 0.0061s/iter; left time: 10.6305s
	iters: 200, epoch: 2 | loss: 0.4563342
	speed: 0.0024s/iter; left time: 3.8962s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.2998 --> 0.2858).  Saving model state dict ...
Epoch: 2 cost time: 0.6589925289154053
Epoch: 2, Steps: 262 | Train Loss: 0.4493354 Vali Loss: 0.2857640 Best vali loss: 0.2857640
	iters: 100, epoch: 3 | loss: 0.3683655
	speed: 0.0061s/iter; left time: 8.9783s
	iters: 200, epoch: 3 | loss: 0.5228429
	speed: 0.0024s/iter; left time: 3.3237s
Updating learning rate to 6.0595124275e-05
Validation loss decreased (0.2858 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 0.6821064949035645
Epoch: 3, Steps: 262 | Train Loss: 0.4456042 Vali Loss: 0.2835065 Best vali loss: 0.2835065

best validation loss 0.2835064501861473

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6086414
	speed: 0.0079s/iter; left time: 4.3779s
Updating learning rate to 0.00010046164245
Epoch: 4 cost time: 0.615060567855835
Epoch: 4, Steps: 131 | Train Loss: 0.6086414 Vali Loss: 0.2986503 Best vali loss: 0.2792235
	iters: 100, epoch: 5 | loss: 0.3467017
	speed: 0.0051s/iter; left time: 2.1843s
Updating learning rate to 5.0230821225e-05
Epoch: 5 cost time: 0.3776261806488037
Epoch: 5, Steps: 131 | Train Loss: 0.3467017 Vali Loss: 0.3021963 Best vali loss: 0.2792235
	iters: 100, epoch: 6 | loss: 0.3396227
	speed: 0.0051s/iter; left time: 1.5035s
Updating learning rate to 2.51154106125e-05
Epoch: 6 cost time: 0.38993406295776367
Epoch: 6, Steps: 131 | Train Loss: 0.3396227 Vali Loss: 0.3034355 Best vali loss: 0.2792235
	iters: 100, epoch: 7 | loss: 0.4381928
	speed: 0.0052s/iter; left time: 0.8522s
Updating learning rate to 1.255770530625e-05
Epoch: 7 cost time: 0.3964846134185791
Epoch: 7, Steps: 131 | Train Loss: 0.4381928 Vali Loss: 0.3062444 Best vali loss: 0.2792235
	iters: 100, epoch: 8 | loss: 0.6806064
	speed: 0.0051s/iter; left time: 0.1628s
Updating learning rate to 6.278852653125e-06
Epoch: 8 cost time: 0.3838939666748047
Epoch: 8, Steps: 131 | Train Loss: 0.6806064 Vali Loss: 0.3049975 Best vali loss: 0.2792235

best validation loss 0.2792234520385282

[INFO][abstract_intensifier.py:595] Added config 8f48b8 and rejected config e98a6b as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015028868658, 'e_layers': 3, 'learning_rate': 0.000202867082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8945907
	speed: 0.0096s/iter; left time: 19.2069s
	iters: 200, epoch: 1 | loss: 0.5266863
	speed: 0.0044s/iter; left time: 8.4341s
Updating learning rate to 0.000202867082
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 1.4392366409301758
Epoch: 1, Steps: 262 | Train Loss: 0.7106385 Vali Loss: 0.2829164 Best vali loss: 0.2829164
	iters: 100, epoch: 2 | loss: 0.6454085
	speed: 0.0102s/iter; left time: 17.7181s
	iters: 200, epoch: 2 | loss: 0.4705918
	speed: 0.0044s/iter; left time: 7.2663s
Updating learning rate to 0.000101433541
Validation loss decreased (0.2829 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 1.2101943492889404
Epoch: 2, Steps: 262 | Train Loss: 0.5580001 Vali Loss: 0.2808908 Best vali loss: 0.2808908
	iters: 100, epoch: 3 | loss: 0.3446802
	speed: 0.0103s/iter; left time: 15.1553s
	iters: 200, epoch: 3 | loss: 0.4555958
	speed: 0.0044s/iter; left time: 6.0245s
Updating learning rate to 5.07167705e-05
Epoch: 3 cost time: 1.1953480243682861
Epoch: 3, Steps: 262 | Train Loss: 0.4001380 Vali Loss: 0.2827058 Best vali loss: 0.2808908
	iters: 100, epoch: 4 | loss: 0.2932662
	speed: 0.0101s/iter; left time: 12.2839s
	iters: 200, epoch: 4 | loss: 0.3201322
	speed: 0.0047s/iter; left time: 5.2103s
Updating learning rate to 2.535838525e-05
Epoch: 4 cost time: 1.2716858386993408
Epoch: 4, Steps: 262 | Train Loss: 0.3066992 Vali Loss: 0.2828600 Best vali loss: 0.2808908
	iters: 100, epoch: 5 | loss: 0.3899897
	speed: 0.0104s/iter; left time: 9.8298s
	iters: 200, epoch: 5 | loss: 0.3333420
	speed: 0.0048s/iter; left time: 4.1089s
Updating learning rate to 1.2679192625e-05
Epoch: 5 cost time: 1.2964293956756592
Epoch: 5, Steps: 262 | Train Loss: 0.3616659 Vali Loss: 0.2889868 Best vali loss: 0.2808908
	iters: 100, epoch: 6 | loss: 0.3238872
	speed: 0.0107s/iter; left time: 7.3441s
	iters: 200, epoch: 6 | loss: 0.4130227
	speed: 0.0047s/iter; left time: 2.7573s
Updating learning rate to 6.3395963125e-06
Epoch: 6 cost time: 1.2716386318206787
Epoch: 6, Steps: 262 | Train Loss: 0.3684550 Vali Loss: 0.2885264 Best vali loss: 0.2808908
	iters: 100, epoch: 7 | loss: 0.3356348
	speed: 0.0104s/iter; left time: 4.3998s
	iters: 200, epoch: 7 | loss: 0.3907698
	speed: 0.0048s/iter; left time: 1.5594s
Updating learning rate to 3.16979815625e-06
Epoch: 7 cost time: 1.2963817119598389
Epoch: 7, Steps: 262 | Train Loss: 0.3632023 Vali Loss: 0.2913963 Best vali loss: 0.2808908
	iters: 100, epoch: 8 | loss: 0.4081728
	speed: 0.0104s/iter; left time: 1.6967s
	iters: 200, epoch: 8 | loss: 0.2850698
	speed: 0.0048s/iter; left time: 0.3046s
Updating learning rate to 1.584899078125e-06
Epoch: 8 cost time: 1.298074722290039
Epoch: 8, Steps: 262 | Train Loss: 0.3466213 Vali Loss: 0.2921788 Best vali loss: 0.2808908

best validation loss 0.280890752088629

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0026114276247, 'e_layers': 2, 'learning_rate': 0.0003412042455, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8260152
	speed: 0.0091s/iter; left time: 18.1867s
	iters: 200, epoch: 1 | loss: 0.7941133
	speed: 0.0038s/iter; left time: 7.1429s
Updating learning rate to 0.0003412042455
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 1.2709321975708008
Epoch: 1, Steps: 262 | Train Loss: 0.8100643 Vali Loss: 0.2868229 Best vali loss: 0.2868229
	iters: 100, epoch: 2 | loss: 0.7916073
	speed: 0.0086s/iter; left time: 14.8387s
	iters: 200, epoch: 2 | loss: 0.7811539
	speed: 0.0037s/iter; left time: 6.1160s
Updating learning rate to 0.00017060212275
Validation loss decreased (0.2868 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 1.0162065029144287
Epoch: 2, Steps: 262 | Train Loss: 0.7863806 Vali Loss: 0.2838655 Best vali loss: 0.2838655
	iters: 100, epoch: 3 | loss: 0.5367882
	speed: 0.0080s/iter; left time: 11.8491s
	iters: 200, epoch: 3 | loss: 0.4645723
	speed: 0.0032s/iter; left time: 4.4598s
Updating learning rate to 8.5301061375e-05
Validation loss decreased (0.2839 --> 0.2777).  Saving model state dict ...
Epoch: 3 cost time: 0.901331901550293
Epoch: 3, Steps: 262 | Train Loss: 0.5006803 Vali Loss: 0.2777477 Best vali loss: 0.2777477
	iters: 100, epoch: 4 | loss: 0.4019479
	speed: 0.0078s/iter; left time: 9.3999s
	iters: 200, epoch: 4 | loss: 0.3703892
	speed: 0.0032s/iter; left time: 3.5954s
Updating learning rate to 4.26505306875e-05
Epoch: 4 cost time: 0.8904149532318115
Epoch: 4, Steps: 262 | Train Loss: 0.3861685 Vali Loss: 0.2800284 Best vali loss: 0.2777477
	iters: 100, epoch: 5 | loss: 0.2429137
	speed: 0.0074s/iter; left time: 7.0402s
	iters: 200, epoch: 5 | loss: 0.3555116
	speed: 0.0034s/iter; left time: 2.8822s
Updating learning rate to 2.132526534375e-05
Epoch: 5 cost time: 0.917926549911499
Epoch: 5, Steps: 262 | Train Loss: 0.2992126 Vali Loss: 0.2813424 Best vali loss: 0.2777477
	iters: 100, epoch: 6 | loss: 0.2699639
	speed: 0.0076s/iter; left time: 5.1888s
	iters: 200, epoch: 6 | loss: 0.3800106
	speed: 0.0033s/iter; left time: 1.9550s
Updating learning rate to 1.0662632671875e-05
Epoch: 6 cost time: 0.8936765193939209
Epoch: 6, Steps: 262 | Train Loss: 0.3249873 Vali Loss: 0.2801721 Best vali loss: 0.2777477
	iters: 100, epoch: 7 | loss: 0.4103454
	speed: 0.0074s/iter; left time: 3.1346s
	iters: 200, epoch: 7 | loss: 0.3863005
	speed: 0.0034s/iter; left time: 1.1142s
Updating learning rate to 5.3313163359375e-06
Epoch: 7 cost time: 0.9125733375549316
Epoch: 7, Steps: 262 | Train Loss: 0.3983230 Vali Loss: 0.2813097 Best vali loss: 0.2777477
	iters: 100, epoch: 8 | loss: 0.2577383
	speed: 0.0079s/iter; left time: 1.2835s
	iters: 200, epoch: 8 | loss: 0.3203030
	speed: 0.0034s/iter; left time: 0.2142s
Updating learning rate to 2.66565816796875e-06
Epoch: 8 cost time: 0.9129974842071533
Epoch: 8, Steps: 262 | Train Loss: 0.2890206 Vali Loss: 0.2809242 Best vali loss: 0.2777477

best validation loss 0.277747705905754

[INFO][abstract_intensifier.py:595] Added config eb8e22 and rejected config 8f48b8 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4453068
	speed: 0.0090s/iter; left time: 8.5297s
Updating learning rate to 0.0002884157887385461
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 0.7729122638702393
Epoch: 1, Steps: 131 | Train Loss: 0.4453068 Vali Loss: 0.2814750 Best vali loss: 0.2814750
	iters: 100, epoch: 2 | loss: 0.2950404
	speed: 0.0073s/iter; left time: 5.9593s
Updating learning rate to 0.00025591859596019184
Validation loss decreased (0.2815 --> 0.2785).  Saving model state dict ...
Epoch: 2 cost time: 0.5638828277587891
Epoch: 2, Steps: 131 | Train Loss: 0.2950404 Vali Loss: 0.2784586 Best vali loss: 0.2784586
	iters: 100, epoch: 3 | loss: 0.4354944
	speed: 0.0070s/iter; left time: 4.8007s
Updating learning rate to 0.00020728310997765554
Epoch: 3 cost time: 0.5484433174133301
Epoch: 3, Steps: 131 | Train Loss: 0.4354944 Vali Loss: 0.2889354 Best vali loss: 0.2784586

best validation loss 0.2784585914300604

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 1, 'learning_rate': 0.0035418893013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4768091
	speed: 0.0085s/iter; left time: 8.1052s
Updating learning rate to 0.0035418893013
Validation loss decreased (inf --> 0.3499).  Saving model state dict ...
Epoch: 1 cost time: 0.6915948390960693
Epoch: 1, Steps: 131 | Train Loss: 0.4768091 Vali Loss: 0.3499358 Best vali loss: 0.3499358
	iters: 100, epoch: 2 | loss: 0.5337266
	speed: 0.0062s/iter; left time: 5.0364s
Updating learning rate to 0.00177094465065
Validation loss decreased (0.3499 --> 0.3000).  Saving model state dict ...
Epoch: 2 cost time: 0.4394190311431885
Epoch: 2, Steps: 131 | Train Loss: 0.5337266 Vali Loss: 0.2999837 Best vali loss: 0.2999837
	iters: 100, epoch: 3 | loss: 0.5343127
	speed: 0.0060s/iter; left time: 4.1404s
Updating learning rate to 0.000885472325325
Epoch: 3 cost time: 0.44255781173706055
Epoch: 3, Steps: 131 | Train Loss: 0.5343127 Vali Loss: 0.3067616 Best vali loss: 0.2999837

best validation loss 0.2999837201139926

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017113089176, 'e_layers': 4, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5229468
	speed: 0.0102s/iter; left time: 84.5007s
	iters: 200, epoch: 1 | loss: 0.4625005
	speed: 0.0049s/iter; left time: 40.1151s
	iters: 300, epoch: 1 | loss: 0.4765468
	speed: 0.0049s/iter; left time: 39.2801s
	iters: 400, epoch: 1 | loss: 0.3093673
	speed: 0.0050s/iter; left time: 39.5667s
	iters: 500, epoch: 1 | loss: 0.7368546
	speed: 0.0050s/iter; left time: 39.2360s
	iters: 600, epoch: 1 | loss: 0.5432246
	speed: 0.0050s/iter; left time: 38.7413s
	iters: 700, epoch: 1 | loss: 0.3249820
	speed: 0.0050s/iter; left time: 38.2223s
	iters: 800, epoch: 1 | loss: 1.6716818
	speed: 0.0050s/iter; left time: 37.5959s
	iters: 900, epoch: 1 | loss: 0.6115894
	speed: 0.0050s/iter; left time: 37.0073s
	iters: 1000, epoch: 1 | loss: 2.0175793
	speed: 0.0050s/iter; left time: 36.5814s
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.3265).  Saving model state dict ...
Epoch: 1 cost time: 5.452838659286499
Epoch: 1, Steps: 1045 | Train Loss: 0.8677273 Vali Loss: 0.3264508 Best vali loss: 0.3264508
	iters: 100, epoch: 2 | loss: 0.4188672
	speed: 0.0139s/iter; left time: 100.3396s
	iters: 200, epoch: 2 | loss: 1.1474540
	speed: 0.0048s/iter; left time: 34.0624s
	iters: 300, epoch: 2 | loss: 0.4312343
	speed: 0.0050s/iter; left time: 34.9787s
	iters: 400, epoch: 2 | loss: 0.7071439
	speed: 0.0050s/iter; left time: 34.4581s
	iters: 500, epoch: 2 | loss: 0.3419435
	speed: 0.0050s/iter; left time: 33.8630s
	iters: 600, epoch: 2 | loss: 0.2313778
	speed: 0.0050s/iter; left time: 33.5764s
	iters: 700, epoch: 2 | loss: 0.5530255
	speed: 0.0050s/iter; left time: 32.8255s
	iters: 800, epoch: 2 | loss: 0.2765701
	speed: 0.0050s/iter; left time: 32.5116s
	iters: 900, epoch: 2 | loss: 0.2506283
	speed: 0.0050s/iter; left time: 32.0850s
	iters: 1000, epoch: 2 | loss: 0.2555360
	speed: 0.0050s/iter; left time: 31.5013s
Updating learning rate to 0.002058451742387382
Validation loss decreased (0.3265 --> 0.3208).  Saving model state dict ...
Epoch: 2 cost time: 5.204680919647217
Epoch: 2, Steps: 1045 | Train Loss: 0.4613781 Vali Loss: 0.3207772 Best vali loss: 0.3207772
	iters: 100, epoch: 3 | loss: 0.4038706
	speed: 0.0141s/iter; left time: 87.1571s
	iters: 200, epoch: 3 | loss: 1.1409243
	speed: 0.0047s/iter; left time: 28.3983s
	iters: 300, epoch: 3 | loss: 0.2118315
	speed: 0.0047s/iter; left time: 28.2195s
	iters: 400, epoch: 3 | loss: 0.3521934
	speed: 0.0047s/iter; left time: 27.5892s
	iters: 500, epoch: 3 | loss: 1.0016714
	speed: 0.0047s/iter; left time: 27.3868s
	iters: 600, epoch: 3 | loss: 0.4279652
	speed: 0.0045s/iter; left time: 25.6856s
	iters: 700, epoch: 3 | loss: 0.6160836
	speed: 0.0045s/iter; left time: 25.1441s
	iters: 800, epoch: 3 | loss: 0.4177378
	speed: 0.0048s/iter; left time: 26.2748s
	iters: 900, epoch: 3 | loss: 1.2434841
	speed: 0.0048s/iter; left time: 25.9655s
	iters: 1000, epoch: 3 | loss: 0.4410214
	speed: 0.0048s/iter; left time: 25.3557s
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 4.961052417755127
Epoch: 3, Steps: 1045 | Train Loss: 0.6256783 Vali Loss: 0.3221064 Best vali loss: 0.3207772

best validation loss 0.32077719731683757

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4233357
	speed: 0.0095s/iter; left time: 5.2848s
Updating learning rate to 0.00014991364265
Epoch: 4 cost time: 0.8007898330688477
Epoch: 4, Steps: 131 | Train Loss: 0.4233357 Vali Loss: 0.2812501 Best vali loss: 0.2784586
	iters: 100, epoch: 5 | loss: 0.2823588
	speed: 0.0069s/iter; left time: 2.9470s
Updating learning rate to 9.254417532234449e-05
Epoch: 5 cost time: 0.5578060150146484
Epoch: 5, Steps: 131 | Train Loss: 0.2823588 Vali Loss: 0.2864777 Best vali loss: 0.2784586
	iters: 100, epoch: 6 | loss: 0.3802577
	speed: 0.0066s/iter; left time: 1.9516s
Updating learning rate to 4.3908689339808184e-05
Epoch: 6 cost time: 0.52732253074646
Epoch: 6, Steps: 131 | Train Loss: 0.3802577 Vali Loss: 0.2792585 Best vali loss: 0.2784586
	iters: 100, epoch: 7 | loss: 0.4331086
	speed: 0.0068s/iter; left time: 1.1163s
Updating learning rate to 1.1411496561453903e-05
Epoch: 7 cost time: 0.5611743927001953
Epoch: 7, Steps: 131 | Train Loss: 0.4331086 Vali Loss: 0.2808992 Best vali loss: 0.2784586
	iters: 100, epoch: 8 | loss: 0.3248261
	speed: 0.0068s/iter; left time: 0.2181s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5424928665161133
Epoch: 8, Steps: 131 | Train Loss: 0.3248261 Vali Loss: 0.2796132 Best vali loss: 0.2784586

best validation loss 0.2784585914300604

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002592776834, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3535490
	speed: 0.0087s/iter; left time: 35.6684s
	iters: 200, epoch: 1 | loss: 0.4517961
	speed: 0.0034s/iter; left time: 13.4164s
	iters: 300, epoch: 1 | loss: 0.3421349
	speed: 0.0034s/iter; left time: 13.0668s
	iters: 400, epoch: 1 | loss: 0.5637498
	speed: 0.0034s/iter; left time: 12.8798s
	iters: 500, epoch: 1 | loss: 0.4007716
	speed: 0.0034s/iter; left time: 12.4119s
Updating learning rate to 0.0002592776834
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 2.0443506240844727
Epoch: 1, Steps: 523 | Train Loss: 0.4224003 Vali Loss: 0.2821783 Best vali loss: 0.2821783
	iters: 100, epoch: 2 | loss: 0.4060872
	speed: 0.0075s/iter; left time: 26.5843s
	iters: 200, epoch: 2 | loss: 0.5348186
	speed: 0.0034s/iter; left time: 11.7072s
	iters: 300, epoch: 2 | loss: 0.3153625
	speed: 0.0034s/iter; left time: 11.4114s
	iters: 400, epoch: 2 | loss: 1.5160303
	speed: 0.0034s/iter; left time: 11.0387s
	iters: 500, epoch: 2 | loss: 0.4278208
	speed: 0.0034s/iter; left time: 10.6555s
Updating learning rate to 0.0001296388417
Validation loss decreased (0.2822 --> 0.2805).  Saving model state dict ...
Epoch: 2 cost time: 1.8106822967529297
Epoch: 2, Steps: 523 | Train Loss: 0.6400239 Vali Loss: 0.2805146 Best vali loss: 0.2805146
	iters: 100, epoch: 3 | loss: 0.3182249
	speed: 0.0072s/iter; left time: 21.9073s
	iters: 200, epoch: 3 | loss: 0.5225807
	speed: 0.0034s/iter; left time: 9.9346s
	iters: 300, epoch: 3 | loss: 1.0040449
	speed: 0.0034s/iter; left time: 9.5420s
	iters: 400, epoch: 3 | loss: 0.3292257
	speed: 0.0034s/iter; left time: 9.2498s
	iters: 500, epoch: 3 | loss: 0.6581213
	speed: 0.0034s/iter; left time: 8.8671s
Updating learning rate to 6.481942085e-05
Epoch: 3 cost time: 1.7982876300811768
Epoch: 3, Steps: 523 | Train Loss: 0.5664395 Vali Loss: 0.2843143 Best vali loss: 0.2805146
	iters: 100, epoch: 4 | loss: 0.2296575
	speed: 0.0073s/iter; left time: 18.3480s
	iters: 200, epoch: 4 | loss: 0.5180039
	speed: 0.0036s/iter; left time: 8.5819s
	iters: 300, epoch: 4 | loss: 0.3409140
	speed: 0.0035s/iter; left time: 8.1579s
	iters: 400, epoch: 4 | loss: 0.4859135
	speed: 0.0032s/iter; left time: 7.1298s
	iters: 500, epoch: 4 | loss: 0.2807156
	speed: 0.0031s/iter; left time: 6.5838s
Updating learning rate to 3.2409710425e-05
Epoch: 4 cost time: 1.7949612140655518
Epoch: 4, Steps: 523 | Train Loss: 0.3710409 Vali Loss: 0.2843465 Best vali loss: 0.2805146
	iters: 100, epoch: 5 | loss: 0.3384129
	speed: 0.0069s/iter; left time: 13.8089s
	iters: 200, epoch: 5 | loss: 0.3855173
	speed: 0.0031s/iter; left time: 5.8779s
	iters: 300, epoch: 5 | loss: 0.5181404
	speed: 0.0031s/iter; left time: 5.5321s
	iters: 400, epoch: 5 | loss: 0.4678047
	speed: 0.0031s/iter; left time: 5.2947s
	iters: 500, epoch: 5 | loss: 0.3003742
	speed: 0.0032s/iter; left time: 5.0799s
Updating learning rate to 1.62048552125e-05
Epoch: 5 cost time: 1.6787357330322266
Epoch: 5, Steps: 523 | Train Loss: 0.4020499 Vali Loss: 0.2845384 Best vali loss: 0.2805146
	iters: 100, epoch: 6 | loss: 0.8430176
	speed: 0.0070s/iter; left time: 10.2942s
	iters: 200, epoch: 6 | loss: 0.8220631
	speed: 0.0032s/iter; left time: 4.3968s
	iters: 300, epoch: 6 | loss: 0.6561623
	speed: 0.0032s/iter; left time: 4.1021s
	iters: 400, epoch: 6 | loss: 0.3564709
	speed: 0.0032s/iter; left time: 3.7579s
	iters: 500, epoch: 6 | loss: 0.7036929
	speed: 0.0032s/iter; left time: 3.4248s
Updating learning rate to 8.10242760625e-06
Epoch: 6 cost time: 1.7182955741882324
Epoch: 6, Steps: 523 | Train Loss: 0.6762813 Vali Loss: 0.2849724 Best vali loss: 0.2805146
	iters: 100, epoch: 7 | loss: 0.6276001
	speed: 0.0068s/iter; left time: 6.4304s
	iters: 200, epoch: 7 | loss: 0.6408867
	speed: 0.0029s/iter; left time: 2.4876s
	iters: 300, epoch: 7 | loss: 0.2605832
	speed: 0.0029s/iter; left time: 2.1785s
	iters: 400, epoch: 7 | loss: 0.3738853
	speed: 0.0029s/iter; left time: 1.8871s
	iters: 500, epoch: 7 | loss: 0.5551084
	speed: 0.0029s/iter; left time: 1.5976s
Updating learning rate to 4.051213803125e-06
Epoch: 7 cost time: 1.5697298049926758
Epoch: 7, Steps: 523 | Train Loss: 0.4916127 Vali Loss: 0.2852024 Best vali loss: 0.2805146
	iters: 100, epoch: 8 | loss: 0.4010086
	speed: 0.0073s/iter; left time: 3.1063s
	iters: 200, epoch: 8 | loss: 0.3139576
	speed: 0.0034s/iter; left time: 1.0882s
	iters: 300, epoch: 8 | loss: 0.3932734
	speed: 0.0033s/iter; left time: 0.7481s
	iters: 400, epoch: 8 | loss: 0.4297185
	speed: 0.0034s/iter; left time: 0.4164s
	iters: 500, epoch: 8 | loss: 0.2682858
	speed: 0.0034s/iter; left time: 0.0809s
Updating learning rate to 2.0256069015625e-06
Epoch: 8 cost time: 1.7906455993652344
Epoch: 8, Steps: 523 | Train Loss: 0.3612488 Vali Loss: 0.2854166 Best vali loss: 0.2805146

best validation loss 0.2805145546023666

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010733605571, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7258959
	speed: 0.0092s/iter; left time: 8.7084s
Updating learning rate to 6.11157199e-05
Validation loss decreased (inf --> 0.3457).  Saving model state dict ...
Epoch: 1 cost time: 0.7696871757507324
Epoch: 1, Steps: 131 | Train Loss: 0.7258959 Vali Loss: 0.3456850 Best vali loss: 0.3456850
	iters: 100, epoch: 2 | loss: 0.5853534
	speed: 0.0066s/iter; left time: 5.3939s
Updating learning rate to 3.055785995e-05
Validation loss decreased (0.3457 --> 0.3288).  Saving model state dict ...
Epoch: 2 cost time: 0.5089998245239258
Epoch: 2, Steps: 131 | Train Loss: 0.5853534 Vali Loss: 0.3287507 Best vali loss: 0.3287507
	iters: 100, epoch: 3 | loss: 0.7210594
	speed: 0.0066s/iter; left time: 4.5604s
Updating learning rate to 1.5278929975e-05
Validation loss decreased (0.3288 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 0.540996789932251
Epoch: 3, Steps: 131 | Train Loss: 0.7210594 Vali Loss: 0.3226410 Best vali loss: 0.3226410
	iters: 100, epoch: 4 | loss: 0.4366894
	speed: 0.0064s/iter; left time: 3.5360s
Updating learning rate to 7.6394649875e-06
Validation loss decreased (0.3226 --> 0.3200).  Saving model state dict ...
Epoch: 4 cost time: 0.491666316986084
Epoch: 4, Steps: 131 | Train Loss: 0.4366894 Vali Loss: 0.3200071 Best vali loss: 0.3200071
	iters: 100, epoch: 5 | loss: 0.7852739
	speed: 0.0067s/iter; left time: 2.8628s
Updating learning rate to 3.81973249375e-06
Validation loss decreased (0.3200 --> 0.3188).  Saving model state dict ...
Epoch: 5 cost time: 0.5464117527008057
Epoch: 5, Steps: 131 | Train Loss: 0.7852739 Vali Loss: 0.3187795 Best vali loss: 0.3187795
	iters: 100, epoch: 6 | loss: 0.6104639
	speed: 0.0066s/iter; left time: 1.9356s
Updating learning rate to 1.909866246875e-06
Validation loss decreased (0.3188 --> 0.3182).  Saving model state dict ...
Epoch: 6 cost time: 0.5364971160888672
Epoch: 6, Steps: 131 | Train Loss: 0.6104639 Vali Loss: 0.3181745 Best vali loss: 0.3181745
	iters: 100, epoch: 7 | loss: 0.5332958
	speed: 0.0066s/iter; left time: 1.0827s
Updating learning rate to 9.549331234375e-07
Validation loss decreased (0.3182 --> 0.3179).  Saving model state dict ...
Epoch: 7 cost time: 0.5165526866912842
Epoch: 7, Steps: 131 | Train Loss: 0.5332958 Vali Loss: 0.3178789 Best vali loss: 0.3178789
	iters: 100, epoch: 8 | loss: 0.4147156
	speed: 0.0068s/iter; left time: 0.2163s
Updating learning rate to 4.7746656171875e-07
Validation loss decreased (0.3179 --> 0.3177).  Saving model state dict ...
Epoch: 8 cost time: 0.5537736415863037
Epoch: 8, Steps: 131 | Train Loss: 0.4147156 Vali Loss: 0.3177332 Best vali loss: 0.3177332

best validation loss 0.3177331801172791

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002189490937942002
Validation loss decreased (inf --> 0.2913).  Saving model state dict ...
Epoch: 1 cost time: 0.5747737884521484
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2912818 Best vali loss: 0.2912818
Updating learning rate to 0.001942790473283107
Validation loss decreased (0.2913 --> 0.2864).  Saving model state dict ...
Epoch: 2 cost time: 0.3048059940338135
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2863808 Best vali loss: 0.2863808
Updating learning rate to 0.0015735771362223516
Epoch: 3 cost time: 0.29398036003112793
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2913609 Best vali loss: 0.2863808

best validation loss 0.2863807831251874

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017721446715, 'e_layers': 4, 'learning_rate': 0.0002378546774, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002378546774
Validation loss decreased (inf --> 0.3267).  Saving model state dict ...
Epoch: 1 cost time: 0.634598970413208
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3266645 Best vali loss: 0.3266645
Updating learning rate to 0.0001189273387
Validation loss decreased (0.3267 --> 0.3075).  Saving model state dict ...
Epoch: 2 cost time: 0.42126917839050293
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3074526 Best vali loss: 0.3074526
Updating learning rate to 5.946366935e-05
Validation loss decreased (0.3075 --> 0.3017).  Saving model state dict ...
Epoch: 3 cost time: 0.4177072048187256
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3017051 Best vali loss: 0.3017051

best validation loss 0.3017051102681513

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 0.5728254318237305
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857509 Best vali loss: 0.2857509
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.2858 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 0.31137943267822266
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2807626 Best vali loss: 0.2807626
Updating learning rate to 0.00043994959105690174
Epoch: 3 cost time: 0.306887149810791
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2834835 Best vali loss: 0.2807626

best validation loss 0.2807626071340668

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00031818533495
Epoch: 4 cost time: 0.5458359718322754
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2835607 Best vali loss: 0.2807626
Updating learning rate to 0.00019642107884309824
Epoch: 5 cost time: 0.33614277839660645
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2815055 Best vali loss: 0.2807626
Updating learning rate to 9.319432693274203e-05
Epoch: 6 cost time: 0.33876919746398926
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845322 Best vali loss: 0.2807626
Updating learning rate to 2.4220416444446813e-05
Epoch: 7 cost time: 0.3258683681488037
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2853698 Best vali loss: 0.2807626
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3275477886199951
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2861945 Best vali loss: 0.2807626

best validation loss 0.2807626071340668

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0036399733072, 'e_layers': 3, 'learning_rate': 0.0007179148563, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3008503
	speed: 0.0093s/iter; left time: 76.6498s
	iters: 200, epoch: 1 | loss: 0.4673465
	speed: 0.0040s/iter; left time: 32.3806s
	iters: 300, epoch: 1 | loss: 0.2284898
	speed: 0.0040s/iter; left time: 32.2477s
	iters: 400, epoch: 1 | loss: 0.1888378
	speed: 0.0040s/iter; left time: 31.8460s
	iters: 500, epoch: 1 | loss: 0.4075544
	speed: 0.0040s/iter; left time: 31.3310s
	iters: 600, epoch: 1 | loss: 1.5839485
	speed: 0.0040s/iter; left time: 30.8532s
	iters: 700, epoch: 1 | loss: 0.3673723
	speed: 0.0039s/iter; left time: 30.2583s
	iters: 800, epoch: 1 | loss: 1.4146210
	speed: 0.0039s/iter; left time: 29.8431s
	iters: 900, epoch: 1 | loss: 1.1229969
	speed: 0.0040s/iter; left time: 29.6400s
	iters: 1000, epoch: 1 | loss: 0.3379419
	speed: 0.0039s/iter; left time: 29.0748s
Updating learning rate to 0.0006905908490606759
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 4.4211859703063965
Epoch: 1, Steps: 1045 | Train Loss: 0.6419960 Vali Loss: 0.2851680 Best vali loss: 0.2851680
	iters: 100, epoch: 2 | loss: 1.3315578
	speed: 0.0113s/iter; left time: 81.5001s
	iters: 200, epoch: 2 | loss: 0.3328304
	speed: 0.0037s/iter; left time: 26.4401s
	iters: 300, epoch: 2 | loss: 0.7494724
	speed: 0.0038s/iter; left time: 26.4502s
	iters: 400, epoch: 2 | loss: 0.4747518
	speed: 0.0038s/iter; left time: 26.1373s
	iters: 500, epoch: 2 | loss: 0.2955503
	speed: 0.0039s/iter; left time: 26.6681s
	iters: 600, epoch: 2 | loss: 0.7618443
	speed: 0.0039s/iter; left time: 26.2138s
	iters: 700, epoch: 2 | loss: 0.7169189
	speed: 0.0039s/iter; left time: 25.9754s
	iters: 800, epoch: 2 | loss: 0.5802765
	speed: 0.0039s/iter; left time: 25.4727s
	iters: 900, epoch: 2 | loss: 1.2892456
	speed: 0.0040s/iter; left time: 25.6881s
	iters: 1000, epoch: 2 | loss: 1.1405072
	speed: 0.0040s/iter; left time: 25.0833s
Updating learning rate to 0.0006127786597521479
Epoch: 2 cost time: 4.080068588256836
Epoch: 2, Steps: 1045 | Train Loss: 0.7672955 Vali Loss: 0.2925485 Best vali loss: 0.2851680
	iters: 100, epoch: 3 | loss: 0.1988411
	speed: 0.0114s/iter; left time: 70.6167s
	iters: 200, epoch: 3 | loss: 0.3199540
	speed: 0.0040s/iter; left time: 24.2049s
	iters: 300, epoch: 3 | loss: 1.2464620
	speed: 0.0040s/iter; left time: 23.8840s
	iters: 400, epoch: 3 | loss: 0.2649912
	speed: 0.0036s/iter; left time: 21.4103s
	iters: 500, epoch: 3 | loss: 0.2409276
	speed: 0.0036s/iter; left time: 20.6802s
	iters: 600, epoch: 3 | loss: 0.3603155
	speed: 0.0035s/iter; left time: 20.0564s
	iters: 700, epoch: 3 | loss: 0.3119589
	speed: 0.0035s/iter; left time: 19.6981s
	iters: 800, epoch: 3 | loss: 0.5936280
	speed: 0.0036s/iter; left time: 19.4304s
	iters: 900, epoch: 3 | loss: 0.3251144
	speed: 0.0035s/iter; left time: 19.0560s
	iters: 1000, epoch: 3 | loss: 1.0459814
	speed: 0.0036s/iter; left time: 18.7160s
Updating learning rate to 0.0004963244888273871
Epoch: 3 cost time: 3.879281520843506
Epoch: 3, Steps: 1045 | Train Loss: 0.4908174 Vali Loss: 0.2923558 Best vali loss: 0.2851680
	iters: 100, epoch: 4 | loss: 0.3279531
	speed: 0.0110s/iter; left time: 56.5301s
	iters: 200, epoch: 4 | loss: 0.4293212
	speed: 0.0036s/iter; left time: 18.0824s
	iters: 300, epoch: 4 | loss: 0.2951524
	speed: 0.0037s/iter; left time: 18.2905s
	iters: 400, epoch: 4 | loss: 0.1702439
	speed: 0.0037s/iter; left time: 17.9078s
	iters: 500, epoch: 4 | loss: 0.5487247
	speed: 0.0040s/iter; left time: 18.7116s
	iters: 600, epoch: 4 | loss: 1.0717922
	speed: 0.0040s/iter; left time: 18.4593s
	iters: 700, epoch: 4 | loss: 0.3603456
	speed: 0.0038s/iter; left time: 17.3851s
	iters: 800, epoch: 4 | loss: 0.2346842
	speed: 0.0040s/iter; left time: 17.7988s
	iters: 900, epoch: 4 | loss: 0.3456912
	speed: 0.0040s/iter; left time: 17.4433s
	iters: 1000, epoch: 4 | loss: 0.8531612
	speed: 0.0040s/iter; left time: 16.9514s
Updating learning rate to 0.00035895742815
Epoch: 4 cost time: 4.083285808563232
Epoch: 4, Steps: 1045 | Train Loss: 0.4637070 Vali Loss: 0.2950551 Best vali loss: 0.2851680
	iters: 100, epoch: 5 | loss: 1.0084525
	speed: 0.0119s/iter; left time: 48.6467s
	iters: 200, epoch: 5 | loss: 0.3964332
	speed: 0.0042s/iter; left time: 16.6095s
	iters: 300, epoch: 5 | loss: 0.2677053
	speed: 0.0042s/iter; left time: 16.1879s
	iters: 400, epoch: 5 | loss: 0.3135517
	speed: 0.0041s/iter; left time: 15.5556s
	iters: 500, epoch: 5 | loss: 0.4450551
	speed: 0.0040s/iter; left time: 14.7556s
	iters: 600, epoch: 5 | loss: 0.1869841
	speed: 0.0040s/iter; left time: 14.2835s
	iters: 700, epoch: 5 | loss: 0.6369977
	speed: 0.0040s/iter; left time: 13.9611s
	iters: 800, epoch: 5 | loss: 0.2849568
	speed: 0.0040s/iter; left time: 13.5299s
	iters: 900, epoch: 5 | loss: 0.2948820
	speed: 0.0040s/iter; left time: 13.1238s
	iters: 1000, epoch: 5 | loss: 0.2425780
	speed: 0.0040s/iter; left time: 12.7252s
Updating learning rate to 0.00022159036747261294
Epoch: 5 cost time: 4.272119045257568
Epoch: 5, Steps: 1045 | Train Loss: 0.4077596 Vali Loss: 0.2958232 Best vali loss: 0.2851680
	iters: 100, epoch: 6 | loss: 0.3992824
	speed: 0.0121s/iter; left time: 36.6219s
	iters: 200, epoch: 6 | loss: 0.2114471
	speed: 0.0042s/iter; left time: 12.3056s
	iters: 300, epoch: 6 | loss: 0.7915499
	speed: 0.0042s/iter; left time: 11.7961s
	iters: 400, epoch: 6 | loss: 0.2700279
	speed: 0.0041s/iter; left time: 11.1137s
	iters: 500, epoch: 6 | loss: 0.2335888
	speed: 0.0042s/iter; left time: 10.9412s
	iters: 600, epoch: 6 | loss: 1.3563583
	speed: 0.0042s/iter; left time: 10.5762s
	iters: 700, epoch: 6 | loss: 0.2451262
	speed: 0.0042s/iter; left time: 10.2561s
	iters: 800, epoch: 6 | loss: 0.3994727
	speed: 0.0041s/iter; left time: 9.4841s
	iters: 900, epoch: 6 | loss: 0.2454119
	speed: 0.0040s/iter; left time: 8.8635s
	iters: 1000, epoch: 6 | loss: 0.3403476
	speed: 0.0040s/iter; left time: 8.5382s
Updating learning rate to 0.00010513619654785212
Epoch: 6 cost time: 4.329725027084351
Epoch: 6, Steps: 1045 | Train Loss: 0.4492613 Vali Loss: 0.2909694 Best vali loss: 0.2851680
	iters: 100, epoch: 7 | loss: 0.4342895
	speed: 0.0118s/iter; left time: 23.4953s
	iters: 200, epoch: 7 | loss: 0.1758996
	speed: 0.0039s/iter; left time: 7.4401s
	iters: 300, epoch: 7 | loss: 0.1739186
	speed: 0.0038s/iter; left time: 6.8210s
	iters: 400, epoch: 7 | loss: 0.2518333
	speed: 0.0036s/iter; left time: 6.1430s
	iters: 500, epoch: 7 | loss: 0.4393644
	speed: 0.0039s/iter; left time: 6.2327s
	iters: 600, epoch: 7 | loss: 0.9651787
	speed: 0.0039s/iter; left time: 5.8304s
	iters: 700, epoch: 7 | loss: 0.3804995
	speed: 0.0039s/iter; left time: 5.4174s
	iters: 800, epoch: 7 | loss: 0.2353282
	speed: 0.0039s/iter; left time: 5.0432s
	iters: 900, epoch: 7 | loss: 0.3553410
	speed: 0.0038s/iter; left time: 4.5302s
	iters: 1000, epoch: 7 | loss: 0.4330371
	speed: 0.0039s/iter; left time: 4.2400s
Updating learning rate to 2.7324007239324203e-05
Epoch: 7 cost time: 4.080124855041504
Epoch: 7, Steps: 1045 | Train Loss: 0.3844690 Vali Loss: 0.2913252 Best vali loss: 0.2851680
	iters: 100, epoch: 8 | loss: 0.6963199
	speed: 0.0115s/iter; left time: 10.9222s
	iters: 200, epoch: 8 | loss: 0.6473146
	speed: 0.0039s/iter; left time: 3.3127s
	iters: 300, epoch: 8 | loss: 0.6102779
	speed: 0.0039s/iter; left time: 2.9425s
	iters: 400, epoch: 8 | loss: 0.2775857
	speed: 0.0039s/iter; left time: 2.5357s
	iters: 500, epoch: 8 | loss: 0.7950642
	speed: 0.0040s/iter; left time: 2.1754s
	iters: 600, epoch: 8 | loss: 0.2084547
	speed: 0.0039s/iter; left time: 1.7387s
	iters: 700, epoch: 8 | loss: 0.2800789
	speed: 0.0040s/iter; left time: 1.3740s
	iters: 800, epoch: 8 | loss: 0.4878839
	speed: 0.0039s/iter; left time: 0.9636s
	iters: 900, epoch: 8 | loss: 0.3327765
	speed: 0.0040s/iter; left time: 0.5769s
	iters: 1000, epoch: 8 | loss: 0.1715976
	speed: 0.0040s/iter; left time: 0.1822s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.140110969543457
Epoch: 8, Steps: 1045 | Train Loss: 0.4507354 Vali Loss: 0.2927485 Best vali loss: 0.2851680

best validation loss 0.2851680490597334

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050164002415, 'e_layers': 1, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5955390
	speed: 0.0072s/iter; left time: 59.8734s
	iters: 200, epoch: 1 | loss: 1.2493234
	speed: 0.0023s/iter; left time: 18.5959s
	iters: 300, epoch: 1 | loss: 0.4619548
	speed: 0.0022s/iter; left time: 18.0048s
	iters: 400, epoch: 1 | loss: 0.3804772
	speed: 0.0022s/iter; left time: 17.4739s
	iters: 500, epoch: 1 | loss: 0.2020169
	speed: 0.0022s/iter; left time: 17.2560s
	iters: 600, epoch: 1 | loss: 0.6048420
	speed: 0.0022s/iter; left time: 16.8668s
	iters: 700, epoch: 1 | loss: 0.3395358
	speed: 0.0022s/iter; left time: 16.7221s
	iters: 800, epoch: 1 | loss: 0.3296717
	speed: 0.0023s/iter; left time: 17.4125s
	iters: 900, epoch: 1 | loss: 0.4508386
	speed: 0.0022s/iter; left time: 16.7766s
	iters: 1000, epoch: 1 | loss: 0.3663106
	speed: 0.0022s/iter; left time: 16.0588s
Updating learning rate to 0.0005311094169208142
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 2.573355197906494
Epoch: 1, Steps: 1045 | Train Loss: 0.4980510 Vali Loss: 0.2805102 Best vali loss: 0.2805102
	iters: 100, epoch: 2 | loss: 0.4489152
	speed: 0.0079s/iter; left time: 57.3558s
	iters: 200, epoch: 2 | loss: 0.4930659
	speed: 0.0023s/iter; left time: 16.5225s
	iters: 300, epoch: 2 | loss: 0.2621375
	speed: 0.0024s/iter; left time: 17.0664s
	iters: 400, epoch: 2 | loss: 0.3920352
	speed: 0.0024s/iter; left time: 16.8717s
	iters: 500, epoch: 2 | loss: 0.2441924
	speed: 0.0023s/iter; left time: 15.7188s
	iters: 600, epoch: 2 | loss: 0.2695686
	speed: 0.0023s/iter; left time: 15.3449s
	iters: 700, epoch: 2 | loss: 0.5025924
	speed: 0.0021s/iter; left time: 14.0992s
	iters: 800, epoch: 2 | loss: 0.8067505
	speed: 0.0021s/iter; left time: 13.4515s
	iters: 900, epoch: 2 | loss: 1.3248421
	speed: 0.0021s/iter; left time: 13.5192s
	iters: 1000, epoch: 2 | loss: 0.2929025
	speed: 0.0021s/iter; left time: 13.2761s
Updating learning rate to 0.0004712667668926594
Epoch: 2 cost time: 2.3651275634765625
Epoch: 2, Steps: 1045 | Train Loss: 0.5037002 Vali Loss: 0.2928943 Best vali loss: 0.2805102
	iters: 100, epoch: 3 | loss: 0.2307766
	speed: 0.0077s/iter; left time: 47.6306s
	iters: 200, epoch: 3 | loss: 0.3489325
	speed: 0.0022s/iter; left time: 13.4368s
	iters: 300, epoch: 3 | loss: 0.2752008
	speed: 0.0022s/iter; left time: 13.2358s
	iters: 400, epoch: 3 | loss: 0.2483393
	speed: 0.0022s/iter; left time: 13.0651s
	iters: 500, epoch: 3 | loss: 0.4349809
	speed: 0.0022s/iter; left time: 12.7776s
	iters: 600, epoch: 3 | loss: 0.3355306
	speed: 0.0022s/iter; left time: 12.5686s
	iters: 700, epoch: 3 | loss: 0.4301041
	speed: 0.0022s/iter; left time: 12.3071s
	iters: 800, epoch: 3 | loss: 0.1872726
	speed: 0.0022s/iter; left time: 12.0817s
	iters: 900, epoch: 3 | loss: 0.5647487
	speed: 0.0022s/iter; left time: 11.8754s
	iters: 1000, epoch: 3 | loss: 0.5798656
	speed: 0.0022s/iter; left time: 11.6922s
Updating learning rate to 0.00038170591200734896
Epoch: 3 cost time: 2.359192132949829
Epoch: 3, Steps: 1045 | Train Loss: 0.3635752 Vali Loss: 0.2939058 Best vali loss: 0.2805102
	iters: 100, epoch: 4 | loss: 0.5556515
	speed: 0.0080s/iter; left time: 40.7876s
	iters: 200, epoch: 4 | loss: 1.0434092
	speed: 0.0024s/iter; left time: 11.9899s
	iters: 300, epoch: 4 | loss: 0.5901257
	speed: 0.0023s/iter; left time: 11.5291s
	iters: 400, epoch: 4 | loss: 1.0309209
	speed: 0.0023s/iter; left time: 11.2798s
	iters: 500, epoch: 4 | loss: 0.1916978
	speed: 0.0024s/iter; left time: 11.2790s
	iters: 600, epoch: 4 | loss: 0.1954380
	speed: 0.0024s/iter; left time: 11.0084s
	iters: 700, epoch: 4 | loss: 0.4240822
	speed: 0.0024s/iter; left time: 10.7194s
	iters: 800, epoch: 4 | loss: 0.8768047
	speed: 0.0023s/iter; left time: 10.3218s
	iters: 900, epoch: 4 | loss: 0.2955914
	speed: 0.0024s/iter; left time: 10.2109s
	iters: 1000, epoch: 4 | loss: 0.4299369
	speed: 0.0024s/iter; left time: 9.9985s
Updating learning rate to 0.00027606168055
Epoch: 4 cost time: 2.5032525062561035
Epoch: 4, Steps: 1045 | Train Loss: 0.5633658 Vali Loss: 0.3089851 Best vali loss: 0.2805102
	iters: 100, epoch: 5 | loss: 0.4836327
	speed: 0.0077s/iter; left time: 31.2583s
	iters: 200, epoch: 5 | loss: 0.4165735
	speed: 0.0023s/iter; left time: 9.2352s
	iters: 300, epoch: 5 | loss: 0.3271364
	speed: 0.0024s/iter; left time: 9.1708s
	iters: 400, epoch: 5 | loss: 0.2924741
	speed: 0.0023s/iter; left time: 8.6898s
	iters: 500, epoch: 5 | loss: 0.7897148
	speed: 0.0023s/iter; left time: 8.5631s
	iters: 600, epoch: 5 | loss: 0.3433342
	speed: 0.0023s/iter; left time: 8.2041s
	iters: 700, epoch: 5 | loss: 0.1626860
	speed: 0.0024s/iter; left time: 8.2078s
	iters: 800, epoch: 5 | loss: 0.2470088
	speed: 0.0023s/iter; left time: 7.8481s
	iters: 900, epoch: 5 | loss: 0.6497730
	speed: 0.0023s/iter; left time: 7.5170s
	iters: 1000, epoch: 5 | loss: 0.2207157
	speed: 0.0024s/iter; left time: 7.5709s
Updating learning rate to 0.00017041744909265108
Epoch: 5 cost time: 2.460686445236206
Epoch: 5, Steps: 1045 | Train Loss: 0.3933049 Vali Loss: 0.3063825 Best vali loss: 0.2805102
	iters: 100, epoch: 6 | loss: 0.6059448
	speed: 0.0079s/iter; left time: 23.8978s
	iters: 200, epoch: 6 | loss: 0.5530023
	speed: 0.0022s/iter; left time: 6.4387s
	iters: 300, epoch: 6 | loss: 0.1853701
	speed: 0.0024s/iter; left time: 6.8682s
	iters: 400, epoch: 6 | loss: 0.2773457
	speed: 0.0024s/iter; left time: 6.5734s
	iters: 500, epoch: 6 | loss: 0.2654372
	speed: 0.0024s/iter; left time: 6.2193s
	iters: 600, epoch: 6 | loss: 0.2739977
	speed: 0.0024s/iter; left time: 5.9910s
	iters: 700, epoch: 6 | loss: 0.3300695
	speed: 0.0024s/iter; left time: 5.9204s
	iters: 800, epoch: 6 | loss: 0.4745009
	speed: 0.0024s/iter; left time: 5.7070s
	iters: 900, epoch: 6 | loss: 0.1723371
	speed: 0.0024s/iter; left time: 5.4022s
	iters: 1000, epoch: 6 | loss: 0.7162731
	speed: 0.0024s/iter; left time: 5.0415s
Updating learning rate to 8.085659420734059e-05
Epoch: 6 cost time: 2.4959616661071777
Epoch: 6, Steps: 1045 | Train Loss: 0.3854278 Vali Loss: 0.3067712 Best vali loss: 0.2805102
	iters: 100, epoch: 7 | loss: 0.1704721
	speed: 0.0079s/iter; left time: 15.7362s
	iters: 200, epoch: 7 | loss: 0.1994488
	speed: 0.0023s/iter; left time: 4.3024s
	iters: 300, epoch: 7 | loss: 0.2674559
	speed: 0.0023s/iter; left time: 4.0713s
	iters: 400, epoch: 7 | loss: 0.2432276
	speed: 0.0023s/iter; left time: 3.8058s
	iters: 500, epoch: 7 | loss: 0.5445310
	speed: 0.0022s/iter; left time: 3.5722s
	iters: 600, epoch: 7 | loss: 0.1455295
	speed: 0.0023s/iter; left time: 3.3631s
	iters: 700, epoch: 7 | loss: 0.4886289
	speed: 0.0023s/iter; left time: 3.1330s
	iters: 800, epoch: 7 | loss: 0.2109354
	speed: 0.0023s/iter; left time: 2.9079s
	iters: 900, epoch: 7 | loss: 0.1938667
	speed: 0.0022s/iter; left time: 2.6716s
	iters: 1000, epoch: 7 | loss: 0.1491729
	speed: 0.0023s/iter; left time: 2.4809s
Updating learning rate to 2.101394417918582e-05
Epoch: 7 cost time: 2.3981118202209473
Epoch: 7, Steps: 1045 | Train Loss: 0.2613269 Vali Loss: 0.3070945 Best vali loss: 0.2805102
	iters: 100, epoch: 8 | loss: 0.2775937
	speed: 0.0076s/iter; left time: 7.2206s
	iters: 200, epoch: 8 | loss: 0.6787279
	speed: 0.0021s/iter; left time: 1.8030s
	iters: 300, epoch: 8 | loss: 0.7753209
	speed: 0.0021s/iter; left time: 1.5457s
	iters: 400, epoch: 8 | loss: 0.5153562
	speed: 0.0021s/iter; left time: 1.3276s
	iters: 500, epoch: 8 | loss: 0.4733028
	speed: 0.0021s/iter; left time: 1.1274s
	iters: 600, epoch: 8 | loss: 0.2592551
	speed: 0.0021s/iter; left time: 0.9158s
	iters: 700, epoch: 8 | loss: 0.5004066
	speed: 0.0021s/iter; left time: 0.7102s
	iters: 800, epoch: 8 | loss: 0.3685642
	speed: 0.0021s/iter; left time: 0.5257s
	iters: 900, epoch: 8 | loss: 1.5742015
	speed: 0.0021s/iter; left time: 0.3111s
	iters: 1000, epoch: 8 | loss: 0.1884604
	speed: 0.0021s/iter; left time: 0.0982s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.225947618484497
Epoch: 8, Steps: 1045 | Train Loss: 0.5611189 Vali Loss: 0.3077409 Best vali loss: 0.2805102

best validation loss 0.280510171776857

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3778698
	speed: 0.0077s/iter; left time: 31.3014s
	iters: 200, epoch: 1 | loss: 0.3073450
	speed: 0.0025s/iter; left time: 10.0855s
	iters: 300, epoch: 1 | loss: 0.2819552
	speed: 0.0024s/iter; left time: 9.3274s
	iters: 400, epoch: 1 | loss: 0.2808537
	speed: 0.0024s/iter; left time: 9.1206s
	iters: 500, epoch: 1 | loss: 0.6682370
	speed: 0.0024s/iter; left time: 8.8509s
Updating learning rate to 0.0001961966354
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.552849292755127
Epoch: 1, Steps: 523 | Train Loss: 0.3832521 Vali Loss: 0.2812696 Best vali loss: 0.2812696
	iters: 100, epoch: 2 | loss: 0.9002009
	speed: 0.0057s/iter; left time: 20.2288s
	iters: 200, epoch: 2 | loss: 0.3249771
	speed: 0.0023s/iter; left time: 7.8920s
	iters: 300, epoch: 2 | loss: 0.5733814
	speed: 0.0024s/iter; left time: 8.1125s
	iters: 400, epoch: 2 | loss: 0.4212035
	speed: 0.0024s/iter; left time: 7.7479s
	iters: 500, epoch: 2 | loss: 0.5907559
	speed: 0.0021s/iter; left time: 6.7135s
Updating learning rate to 9.80983177e-05
Epoch: 2 cost time: 1.2321407794952393
Epoch: 2, Steps: 523 | Train Loss: 0.5621038 Vali Loss: 0.2866304 Best vali loss: 0.2812696
	iters: 100, epoch: 3 | loss: 0.4160767
	speed: 0.0056s/iter; left time: 16.9433s
	iters: 200, epoch: 3 | loss: 0.3177883
	speed: 0.0026s/iter; left time: 7.5663s
	iters: 300, epoch: 3 | loss: 0.8091630
	speed: 0.0026s/iter; left time: 7.3250s
	iters: 400, epoch: 3 | loss: 0.6964697
	speed: 0.0026s/iter; left time: 7.0911s
	iters: 500, epoch: 3 | loss: 0.3950045
	speed: 0.0026s/iter; left time: 6.8529s
Updating learning rate to 4.904915885e-05
Epoch: 3 cost time: 1.370368480682373
Epoch: 3, Steps: 523 | Train Loss: 0.5269005 Vali Loss: 0.2870128 Best vali loss: 0.2812696

best validation loss 0.28126958235350186

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0074951894677, 'e_layers': 4, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8352456
	speed: 0.0103s/iter; left time: 42.0986s
	iters: 200, epoch: 1 | loss: 0.3758417
	speed: 0.0053s/iter; left time: 21.1614s
	iters: 300, epoch: 1 | loss: 0.8943291
	speed: 0.0053s/iter; left time: 20.4485s
	iters: 400, epoch: 1 | loss: 0.3071202
	speed: 0.0052s/iter; left time: 19.7823s
	iters: 500, epoch: 1 | loss: 0.3885500
	speed: 0.0050s/iter; left time: 18.5006s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 2.9860501289367676
Epoch: 1, Steps: 523 | Train Loss: 0.5602173 Vali Loss: 0.3201021 Best vali loss: 0.3201021
	iters: 100, epoch: 2 | loss: 0.2470212
	speed: 0.0103s/iter; left time: 36.6130s
	iters: 200, epoch: 2 | loss: 0.7638344
	speed: 0.0053s/iter; left time: 18.2599s
	iters: 300, epoch: 2 | loss: 0.4222300
	speed: 0.0052s/iter; left time: 17.6266s
	iters: 400, epoch: 2 | loss: 0.9825193
	speed: 0.0053s/iter; left time: 17.2331s
	iters: 500, epoch: 2 | loss: 0.4725761
	speed: 0.0052s/iter; left time: 16.4674s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.3201 --> 0.3161).  Saving model state dict ...
Epoch: 2 cost time: 2.779573678970337
Epoch: 2, Steps: 523 | Train Loss: 0.5776362 Vali Loss: 0.3160777 Best vali loss: 0.3160777
	iters: 100, epoch: 3 | loss: 0.2880449
	speed: 0.0103s/iter; left time: 31.2059s
	iters: 200, epoch: 3 | loss: 0.2347060
	speed: 0.0052s/iter; left time: 15.2551s
	iters: 300, epoch: 3 | loss: 0.3398433
	speed: 0.0052s/iter; left time: 14.7342s
	iters: 400, epoch: 3 | loss: 0.3352374
	speed: 0.0052s/iter; left time: 14.2295s
	iters: 500, epoch: 3 | loss: 0.2925774
	speed: 0.0051s/iter; left time: 13.4648s
Updating learning rate to 0.0008955266062
Validation loss decreased (0.3161 --> 0.3153).  Saving model state dict ...
Epoch: 3 cost time: 2.729888916015625
Epoch: 3, Steps: 523 | Train Loss: 0.2980818 Vali Loss: 0.3153367 Best vali loss: 0.3153367

best validation loss 0.3153367403848945

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3430311
	speed: 0.0118s/iter; left time: 11.1780s
Updating learning rate to 0.0006870327933
Validation loss decreased (inf --> 0.2929).  Saving model state dict ...
Epoch: 1 cost time: 1.1207430362701416
Epoch: 1, Steps: 131 | Train Loss: 0.3430311 Vali Loss: 0.2928652 Best vali loss: 0.2928652
	iters: 100, epoch: 2 | loss: 0.5595227
	speed: 0.0103s/iter; left time: 8.4480s
Updating learning rate to 0.00034351639665
Epoch: 2 cost time: 0.8551352024078369
Epoch: 2, Steps: 131 | Train Loss: 0.5595227 Vali Loss: 0.2929215 Best vali loss: 0.2928652
	iters: 100, epoch: 3 | loss: 0.4529664
	speed: 0.0100s/iter; left time: 6.8571s
Updating learning rate to 0.000171758198325
Validation loss decreased (0.2929 --> 0.2866).  Saving model state dict ...
Epoch: 3 cost time: 0.8464617729187012
Epoch: 3, Steps: 131 | Train Loss: 0.4529664 Vali Loss: 0.2866388 Best vali loss: 0.2866388

best validation loss 0.28663879284942045

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3526498
	speed: 0.0072s/iter; left time: 17.9983s
	iters: 200, epoch: 4 | loss: 0.3046225
	speed: 0.0021s/iter; left time: 5.1292s
	iters: 300, epoch: 4 | loss: 0.2642010
	speed: 0.0024s/iter; left time: 5.4747s
	iters: 400, epoch: 4 | loss: 0.2843877
	speed: 0.0024s/iter; left time: 5.3296s
	iters: 500, epoch: 4 | loss: 0.6453503
	speed: 0.0024s/iter; left time: 5.1134s
Updating learning rate to 2.4524579425e-05
Epoch: 4 cost time: 1.4564673900604248
Epoch: 4, Steps: 523 | Train Loss: 0.3702423 Vali Loss: 0.2871732 Best vali loss: 0.2812696
	iters: 100, epoch: 5 | loss: 0.8520816
	speed: 0.0060s/iter; left time: 11.8646s
	iters: 200, epoch: 5 | loss: 0.2962413
	speed: 0.0025s/iter; left time: 4.7009s
	iters: 300, epoch: 5 | loss: 0.5655048
	speed: 0.0024s/iter; left time: 4.3740s
	iters: 400, epoch: 5 | loss: 0.3561343
	speed: 0.0024s/iter; left time: 4.0930s
	iters: 500, epoch: 5 | loss: 0.5371283
	speed: 0.0024s/iter; left time: 3.8233s
Updating learning rate to 1.22622897125e-05
Epoch: 5 cost time: 1.3174822330474854
Epoch: 5, Steps: 523 | Train Loss: 0.5214181 Vali Loss: 0.2886304 Best vali loss: 0.2812696
	iters: 100, epoch: 6 | loss: 0.3718851
	speed: 0.0058s/iter; left time: 8.5345s
	iters: 200, epoch: 6 | loss: 0.3128315
	speed: 0.0026s/iter; left time: 3.4991s
	iters: 300, epoch: 6 | loss: 0.7825379
	speed: 0.0026s/iter; left time: 3.2479s
	iters: 400, epoch: 6 | loss: 0.6322731
	speed: 0.0025s/iter; left time: 2.9733s
	iters: 500, epoch: 6 | loss: 0.3952342
	speed: 0.0026s/iter; left time: 2.7333s
Updating learning rate to 6.13114485625e-06
Epoch: 6 cost time: 1.3710813522338867
Epoch: 6, Steps: 523 | Train Loss: 0.4989523 Vali Loss: 0.2884935 Best vali loss: 0.2812696
	iters: 100, epoch: 7 | loss: 0.5785829
	speed: 0.0058s/iter; left time: 5.5114s
	iters: 200, epoch: 7 | loss: 0.2390202
	speed: 0.0025s/iter; left time: 2.0923s
	iters: 300, epoch: 7 | loss: 0.3497377
	speed: 0.0024s/iter; left time: 1.8278s
	iters: 400, epoch: 7 | loss: 0.6334496
	speed: 0.0024s/iter; left time: 1.5587s
	iters: 500, epoch: 7 | loss: 0.5260811
	speed: 0.0024s/iter; left time: 1.3250s
Updating learning rate to 3.065572428125e-06
Epoch: 7 cost time: 1.309340476989746
Epoch: 7, Steps: 523 | Train Loss: 0.4653743 Vali Loss: 0.2877203 Best vali loss: 0.2812696
	iters: 100, epoch: 8 | loss: 0.5703655
	speed: 0.0058s/iter; left time: 2.4773s
	iters: 200, epoch: 8 | loss: 0.6097188
	speed: 0.0025s/iter; left time: 0.8131s
	iters: 300, epoch: 8 | loss: 0.4140276
	speed: 0.0025s/iter; left time: 0.5555s
	iters: 400, epoch: 8 | loss: 0.2785055
	speed: 0.0025s/iter; left time: 0.3081s
	iters: 500, epoch: 8 | loss: 0.3635759
	speed: 0.0025s/iter; left time: 0.0602s
Updating learning rate to 1.5327862140625e-06
Epoch: 8 cost time: 1.339472770690918
Epoch: 8, Steps: 523 | Train Loss: 0.4472387 Vali Loss: 0.2877869 Best vali loss: 0.2812696

best validation loss 0.28126958235350186

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008116820516, 'e_layers': 1, 'learning_rate': 0.0004109547451, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4667971
	speed: 0.0084s/iter; left time: 7.9739s
Updating learning rate to 0.0003953137114431415
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 0.6681444644927979
Epoch: 1, Steps: 131 | Train Loss: 0.4667971 Vali Loss: 0.2861842 Best vali loss: 0.2861842
	iters: 100, epoch: 2 | loss: 0.3544263
	speed: 0.0054s/iter; left time: 4.4047s
Updating learning rate to 0.00035077181606049955
Validation loss decreased (0.2862 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 0.4048182964324951
Epoch: 2, Steps: 131 | Train Loss: 0.3544263 Vali Loss: 0.2811790 Best vali loss: 0.2811790
	iters: 100, epoch: 3 | loss: 0.5671530
	speed: 0.0052s/iter; left time: 3.5899s
Updating learning rate to 0.00028411015875079426
Epoch: 3 cost time: 0.39667773246765137
Epoch: 3, Steps: 131 | Train Loss: 0.5671530 Vali Loss: 0.2823267 Best vali loss: 0.2811790
	iters: 100, epoch: 4 | loss: 0.4970831
	speed: 0.0050s/iter; left time: 2.7877s
Updating learning rate to 0.00020547737255
Epoch: 4 cost time: 0.37320876121520996
Epoch: 4, Steps: 131 | Train Loss: 0.4970831 Vali Loss: 0.2865934 Best vali loss: 0.2811790
	iters: 100, epoch: 5 | loss: 0.7141713
	speed: 0.0051s/iter; left time: 2.1831s
Updating learning rate to 0.00012684458634920571
Epoch: 5 cost time: 0.38716673851013184
Epoch: 5, Steps: 131 | Train Loss: 0.7141713 Vali Loss: 0.2844862 Best vali loss: 0.2811790
	iters: 100, epoch: 6 | loss: 0.3301540
	speed: 0.0051s/iter; left time: 1.5035s
Updating learning rate to 6.0182929039500455e-05
Epoch: 6 cost time: 0.3869612216949463
Epoch: 6, Steps: 131 | Train Loss: 0.3301540 Vali Loss: 0.2869860 Best vali loss: 0.2811790
	iters: 100, epoch: 7 | loss: 0.4222171
	speed: 0.0051s/iter; left time: 0.8366s
Updating learning rate to 1.5641033656858497e-05
Epoch: 7 cost time: 0.39893221855163574
Epoch: 7, Steps: 131 | Train Loss: 0.4222171 Vali Loss: 0.2859294 Best vali loss: 0.2811790
	iters: 100, epoch: 8 | loss: 0.5527756
	speed: 0.0053s/iter; left time: 0.1703s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4100658893585205
Epoch: 8, Steps: 131 | Train Loss: 0.5527756 Vali Loss: 0.2861226 Best vali loss: 0.2811790

best validation loss 0.28117895443318014

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.008835229483, 'e_layers': 1, 'learning_rate': 0.0016070226056, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4088912
	speed: 0.0078s/iter; left time: 15.5076s
	iters: 200, epoch: 1 | loss: 0.4991369
	speed: 0.0026s/iter; left time: 4.9271s
Updating learning rate to 0.001545858949598399
Validation loss decreased (inf --> 0.2880).  Saving model state dict ...
Epoch: 1 cost time: 0.9457993507385254
Epoch: 1, Steps: 262 | Train Loss: 0.4540140 Vali Loss: 0.2880115 Best vali loss: 0.2880115
	iters: 100, epoch: 2 | loss: 0.9246597
	speed: 0.0064s/iter; left time: 11.0781s
	iters: 200, epoch: 2 | loss: 0.5249713
	speed: 0.0026s/iter; left time: 4.2861s
Updating learning rate to 0.0013716795937699173
Epoch: 2 cost time: 0.7153477668762207
Epoch: 2, Steps: 262 | Train Loss: 0.7248155 Vali Loss: 0.2880451 Best vali loss: 0.2880115
	iters: 100, epoch: 3 | loss: 0.2653010
	speed: 0.0062s/iter; left time: 9.0626s
	iters: 200, epoch: 3 | loss: 0.7778582
	speed: 0.0027s/iter; left time: 3.6407s
Updating learning rate to 0.0011110017660996491
Epoch: 3 cost time: 0.7330105304718018
Epoch: 3, Steps: 262 | Train Loss: 0.5215796 Vali Loss: 0.2942945 Best vali loss: 0.2880115
	iters: 100, epoch: 4 | loss: 0.4815375
	speed: 0.0063s/iter; left time: 7.6619s
	iters: 200, epoch: 4 | loss: 0.6210433
	speed: 0.0027s/iter; left time: 2.9566s
Updating learning rate to 0.0008035113028
Epoch: 4 cost time: 0.7338893413543701
Epoch: 4, Steps: 262 | Train Loss: 0.5512904 Vali Loss: 0.2897222 Best vali loss: 0.2880115
	iters: 100, epoch: 5 | loss: 0.3625810
	speed: 0.0062s/iter; left time: 5.8571s
	iters: 200, epoch: 5 | loss: 0.3643510
	speed: 0.0027s/iter; left time: 2.2634s
Updating learning rate to 0.0004960208395003511
Epoch: 5 cost time: 0.7235655784606934
Epoch: 5, Steps: 262 | Train Loss: 0.3634660 Vali Loss: 0.3148377 Best vali loss: 0.2880115
	iters: 100, epoch: 6 | loss: 0.4441792
	speed: 0.0062s/iter; left time: 4.2288s
	iters: 200, epoch: 6 | loss: 0.2345151
	speed: 0.0025s/iter; left time: 1.4844s
Updating learning rate to 0.00023534301183008273
Epoch: 6 cost time: 0.6990671157836914
Epoch: 6, Steps: 262 | Train Loss: 0.3393472 Vali Loss: 0.3388541 Best vali loss: 0.2880115
	iters: 100, epoch: 7 | loss: 0.3255197
	speed: 0.0063s/iter; left time: 2.6951s
	iters: 200, epoch: 7 | loss: 0.4214921
	speed: 0.0025s/iter; left time: 0.8226s
Updating learning rate to 6.116365600160105e-05
Epoch: 7 cost time: 0.7149229049682617
Epoch: 7, Steps: 262 | Train Loss: 0.3735059 Vali Loss: 0.3345555 Best vali loss: 0.2880115
	iters: 100, epoch: 8 | loss: 0.2480320
	speed: 0.0064s/iter; left time: 1.0383s
	iters: 200, epoch: 8 | loss: 0.4025384
	speed: 0.0026s/iter; left time: 0.1633s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7150681018829346
Epoch: 8, Steps: 262 | Train Loss: 0.3252852 Vali Loss: 0.3466099 Best vali loss: 0.2880115

best validation loss 0.2880115481270162

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.003701149266, 'e_layers': 1, 'learning_rate': 0.0002377962535, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4816803
	speed: 0.0080s/iter; left time: 7.6233s
Updating learning rate to 0.0002377962535
Validation loss decreased (inf --> 0.2969).  Saving model state dict ...
Epoch: 1 cost time: 0.6393601894378662
Epoch: 1, Steps: 131 | Train Loss: 0.4816803 Vali Loss: 0.2968736 Best vali loss: 0.2968736
	iters: 100, epoch: 2 | loss: 0.3603177
	speed: 0.0053s/iter; left time: 4.3072s
Updating learning rate to 0.00011889812675
Validation loss decreased (0.2969 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 0.3929610252380371
Epoch: 2, Steps: 131 | Train Loss: 0.3603177 Vali Loss: 0.2838065 Best vali loss: 0.2838065
	iters: 100, epoch: 3 | loss: 0.5739966
	speed: 0.0054s/iter; left time: 3.7138s
Updating learning rate to 5.9449063375e-05
Validation loss decreased (0.2838 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 0.4267113208770752
Epoch: 3, Steps: 131 | Train Loss: 0.5739966 Vali Loss: 0.2813295 Best vali loss: 0.2813295

best validation loss 0.2813294867116663

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4354533
	speed: 0.0086s/iter; left time: 17.1564s
	iters: 200, epoch: 1 | loss: 0.5251642
	speed: 0.0036s/iter; left time: 6.8666s
Updating learning rate to 0.000380413518
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 1.2016222476959229
Epoch: 1, Steps: 262 | Train Loss: 0.4803087 Vali Loss: 0.2808519 Best vali loss: 0.2808519
	iters: 100, epoch: 2 | loss: 0.4155241
	speed: 0.0082s/iter; left time: 14.1825s
	iters: 200, epoch: 2 | loss: 0.5928316
	speed: 0.0032s/iter; left time: 5.2357s
Updating learning rate to 0.000190206759
Epoch: 2 cost time: 0.9263405799865723
Epoch: 2, Steps: 262 | Train Loss: 0.5041778 Vali Loss: 0.2892207 Best vali loss: 0.2808519
	iters: 100, epoch: 3 | loss: 0.4930892
	speed: 0.0080s/iter; left time: 11.7216s
	iters: 200, epoch: 3 | loss: 0.6422635
	speed: 0.0036s/iter; left time: 4.9055s
Updating learning rate to 9.51033795e-05
Validation loss decreased (0.2809 --> 0.2791).  Saving model state dict ...
Epoch: 3 cost time: 0.9777703285217285
Epoch: 3, Steps: 262 | Train Loss: 0.5676764 Vali Loss: 0.2791143 Best vali loss: 0.2791143

best validation loss 0.27911430827832745

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038758267905, 'e_layers': 1, 'learning_rate': 0.0011658864209, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5269793
	speed: 0.0077s/iter; left time: 31.3446s
	iters: 200, epoch: 1 | loss: 0.6852611
	speed: 0.0026s/iter; left time: 10.2752s
	iters: 300, epoch: 1 | loss: 1.0789378
	speed: 0.0025s/iter; left time: 9.7773s
	iters: 400, epoch: 1 | loss: 0.3921595
	speed: 0.0025s/iter; left time: 9.4592s
	iters: 500, epoch: 1 | loss: 0.3690827
	speed: 0.0025s/iter; left time: 9.2573s
Updating learning rate to 0.0011215125112011748
Validation loss decreased (inf --> 0.3065).  Saving model state dict ...
Epoch: 1 cost time: 1.587510347366333
Epoch: 1, Steps: 523 | Train Loss: 0.6104841 Vali Loss: 0.3065450 Best vali loss: 0.3065450
	iters: 100, epoch: 2 | loss: 0.3620297
	speed: 0.0059s/iter; left time: 21.1460s
	iters: 200, epoch: 2 | loss: 0.6777723
	speed: 0.0025s/iter; left time: 8.7891s
	iters: 300, epoch: 2 | loss: 0.5394306
	speed: 0.0026s/iter; left time: 8.8618s
	iters: 400, epoch: 2 | loss: 0.4642608
	speed: 0.0026s/iter; left time: 8.4446s
	iters: 500, epoch: 2 | loss: 0.9129540
	speed: 0.0025s/iter; left time: 7.9148s
Updating learning rate to 0.0009951463076058517
Validation loss decreased (0.3065 --> 0.2935).  Saving model state dict ...
Epoch: 2 cost time: 1.3723185062408447
Epoch: 2, Steps: 523 | Train Loss: 0.5912895 Vali Loss: 0.2934921 Best vali loss: 0.2934921
	iters: 100, epoch: 3 | loss: 0.5994786
	speed: 0.0060s/iter; left time: 18.2936s
	iters: 200, epoch: 3 | loss: 0.5180547
	speed: 0.0026s/iter; left time: 7.5180s
	iters: 300, epoch: 3 | loss: 0.7113864
	speed: 0.0026s/iter; left time: 7.3246s
	iters: 400, epoch: 3 | loss: 0.3089714
	speed: 0.0025s/iter; left time: 6.9225s
	iters: 500, epoch: 3 | loss: 0.3091421
	speed: 0.0025s/iter; left time: 6.5598s
Updating learning rate to 0.0008060259190989309
Epoch: 3 cost time: 1.3580803871154785
Epoch: 3, Steps: 523 | Train Loss: 0.4894066 Vali Loss: 0.2940477 Best vali loss: 0.2934921

best validation loss 0.2934920791690347

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3703993
	speed: 0.0090s/iter; left time: 10.8693s
	iters: 200, epoch: 4 | loss: 0.4086363
	speed: 0.0035s/iter; left time: 3.8678s
Updating learning rate to 4.755168975e-05
Epoch: 4 cost time: 1.1979749202728271
Epoch: 4, Steps: 262 | Train Loss: 0.3895178 Vali Loss: 0.2807249 Best vali loss: 0.2791143
	iters: 100, epoch: 5 | loss: 0.3577318
	speed: 0.0084s/iter; left time: 7.9745s
	iters: 200, epoch: 5 | loss: 0.3946989
	speed: 0.0037s/iter; left time: 3.1273s
Updating learning rate to 2.3775844875e-05
Epoch: 5 cost time: 1.0211431980133057
Epoch: 5, Steps: 262 | Train Loss: 0.3762154 Vali Loss: 0.2860737 Best vali loss: 0.2791143
	iters: 100, epoch: 6 | loss: 0.4490730
	speed: 0.0084s/iter; left time: 5.7846s
	iters: 200, epoch: 6 | loss: 0.5432210
	speed: 0.0035s/iter; left time: 2.0406s
Updating learning rate to 1.18879224375e-05
Epoch: 6 cost time: 0.9817769527435303
Epoch: 6, Steps: 262 | Train Loss: 0.4961470 Vali Loss: 0.2833085 Best vali loss: 0.2791143
	iters: 100, epoch: 7 | loss: 0.6019731
	speed: 0.0083s/iter; left time: 3.5234s
	iters: 200, epoch: 7 | loss: 0.2836428
	speed: 0.0036s/iter; left time: 1.1544s
Updating learning rate to 5.94396121875e-06
Epoch: 7 cost time: 0.9891769886016846
Epoch: 7, Steps: 262 | Train Loss: 0.4428080 Vali Loss: 0.2842516 Best vali loss: 0.2791143
	iters: 100, epoch: 8 | loss: 0.3571777
	speed: 0.0083s/iter; left time: 1.3533s
	iters: 200, epoch: 8 | loss: 0.6187190
	speed: 0.0035s/iter; left time: 0.2203s
Updating learning rate to 2.971980609375e-06
Epoch: 8 cost time: 0.9623770713806152
Epoch: 8, Steps: 262 | Train Loss: 0.4879484 Vali Loss: 0.2830184 Best vali loss: 0.2791143

best validation loss 0.27911430827832745

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072680941331, 'e_layers': 3, 'learning_rate': 0.0001290367597, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0349234
	speed: 0.0093s/iter; left time: 38.0835s
	iters: 200, epoch: 1 | loss: 0.6462579
	speed: 0.0043s/iter; left time: 17.1505s
	iters: 300, epoch: 1 | loss: 0.4565448
	speed: 0.0043s/iter; left time: 16.6071s
	iters: 400, epoch: 1 | loss: 0.3922929
	speed: 0.0042s/iter; left time: 15.9554s
	iters: 500, epoch: 1 | loss: 0.4872105
	speed: 0.0043s/iter; left time: 15.7314s
Updating learning rate to 0.0001290367597
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 2.486295700073242
Epoch: 1, Steps: 523 | Train Loss: 0.6034459 Vali Loss: 0.2787407 Best vali loss: 0.2787407
	iters: 100, epoch: 2 | loss: 0.3735714
	speed: 0.0090s/iter; left time: 31.9012s
	iters: 200, epoch: 2 | loss: 0.5631621
	speed: 0.0042s/iter; left time: 14.6559s
	iters: 300, epoch: 2 | loss: 0.4241213
	speed: 0.0044s/iter; left time: 14.6478s
	iters: 400, epoch: 2 | loss: 0.9138509
	speed: 0.0044s/iter; left time: 14.2459s
	iters: 500, epoch: 2 | loss: 0.7731306
	speed: 0.0043s/iter; left time: 13.6299s
Updating learning rate to 6.451837985e-05
Epoch: 2 cost time: 2.293410539627075
Epoch: 2, Steps: 523 | Train Loss: 0.6095673 Vali Loss: 0.2807484 Best vali loss: 0.2787407
	iters: 100, epoch: 3 | loss: 0.4421602
	speed: 0.0090s/iter; left time: 27.2063s
	iters: 200, epoch: 3 | loss: 1.3320260
	speed: 0.0044s/iter; left time: 12.9858s
	iters: 300, epoch: 3 | loss: 0.6338424
	speed: 0.0042s/iter; left time: 12.0491s
	iters: 400, epoch: 3 | loss: 0.4093571
	speed: 0.0043s/iter; left time: 11.8805s
	iters: 500, epoch: 3 | loss: 0.3723136
	speed: 0.0043s/iter; left time: 11.2159s
Updating learning rate to 3.2259189925e-05
Epoch: 3 cost time: 2.3027873039245605
Epoch: 3, Steps: 523 | Train Loss: 0.6379399 Vali Loss: 0.3098010 Best vali loss: 0.2787407
	iters: 100, epoch: 4 | loss: 0.9549112
	speed: 0.0085s/iter; left time: 21.4553s
	iters: 200, epoch: 4 | loss: 0.3047431
	speed: 0.0037s/iter; left time: 8.8836s
	iters: 300, epoch: 4 | loss: 0.5864300
	speed: 0.0037s/iter; left time: 8.5289s
	iters: 400, epoch: 4 | loss: 0.4005164
	speed: 0.0037s/iter; left time: 8.2029s
	iters: 500, epoch: 4 | loss: 0.4414140
	speed: 0.0037s/iter; left time: 7.8300s
Updating learning rate to 1.61295949625e-05
Epoch: 4 cost time: 1.9873497486114502
Epoch: 4, Steps: 523 | Train Loss: 0.5376029 Vali Loss: 0.3080652 Best vali loss: 0.2787407
	iters: 100, epoch: 5 | loss: 0.5752997
	speed: 0.0085s/iter; left time: 16.8583s
	iters: 200, epoch: 5 | loss: 0.6028872
	speed: 0.0039s/iter; left time: 7.4759s
	iters: 300, epoch: 5 | loss: 0.6813126
	speed: 0.0040s/iter; left time: 7.1608s
	iters: 400, epoch: 5 | loss: 0.4055645
	speed: 0.0039s/iter; left time: 6.6483s
	iters: 500, epoch: 5 | loss: 0.3704222
	speed: 0.0039s/iter; left time: 6.2531s
Updating learning rate to 8.06479748125e-06
Epoch: 5 cost time: 2.0978705883026123
Epoch: 5, Steps: 523 | Train Loss: 0.5270972 Vali Loss: 0.3086346 Best vali loss: 0.2787407
	iters: 100, epoch: 6 | loss: 0.3758132
	speed: 0.0090s/iter; left time: 13.2659s
	iters: 200, epoch: 6 | loss: 0.5324041
	speed: 0.0044s/iter; left time: 6.0239s
	iters: 300, epoch: 6 | loss: 0.3176889
	speed: 0.0044s/iter; left time: 5.5354s
	iters: 400, epoch: 6 | loss: 0.2107245
	speed: 0.0044s/iter; left time: 5.1085s
	iters: 500, epoch: 6 | loss: 0.3359157
	speed: 0.0044s/iter; left time: 4.6573s
Updating learning rate to 4.032398740625e-06
Epoch: 6 cost time: 2.333076238632202
Epoch: 6, Steps: 523 | Train Loss: 0.3545093 Vali Loss: 0.3136228 Best vali loss: 0.2787407
	iters: 100, epoch: 7 | loss: 0.4290406
	speed: 0.0087s/iter; left time: 8.2330s
	iters: 200, epoch: 7 | loss: 0.2183354
	speed: 0.0040s/iter; left time: 3.3936s
	iters: 300, epoch: 7 | loss: 1.0477083
	speed: 0.0040s/iter; left time: 2.9887s
	iters: 400, epoch: 7 | loss: 0.9073951
	speed: 0.0040s/iter; left time: 2.5880s
	iters: 500, epoch: 7 | loss: 0.2071941
	speed: 0.0040s/iter; left time: 2.1881s
Updating learning rate to 2.0161993703125e-06
Epoch: 7 cost time: 2.1502556800842285
Epoch: 7, Steps: 523 | Train Loss: 0.5619347 Vali Loss: 0.3084125 Best vali loss: 0.2787407
	iters: 100, epoch: 8 | loss: 0.3035513
	speed: 0.0084s/iter; left time: 3.5620s
	iters: 200, epoch: 8 | loss: 0.2695390
	speed: 0.0037s/iter; left time: 1.2075s
	iters: 300, epoch: 8 | loss: 0.6821803
	speed: 0.0039s/iter; left time: 0.8650s
	iters: 400, epoch: 8 | loss: 0.4700100
	speed: 0.0037s/iter; left time: 0.4625s
	iters: 500, epoch: 8 | loss: 0.4734686
	speed: 0.0037s/iter; left time: 0.0889s
Updating learning rate to 1.00809968515625e-06
Epoch: 8 cost time: 2.020561456680298
Epoch: 8, Steps: 523 | Train Loss: 0.4397499 Vali Loss: 0.3130433 Best vali loss: 0.2787407

best validation loss 0.27874072296728475

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0008547466509, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4470682
	speed: 0.0103s/iter; left time: 42.2326s
	iters: 200, epoch: 1 | loss: 0.4499159
	speed: 0.0051s/iter; left time: 20.2305s
	iters: 300, epoch: 1 | loss: 0.7851136
	speed: 0.0050s/iter; left time: 19.4716s
	iters: 400, epoch: 1 | loss: 0.6047429
	speed: 0.0051s/iter; left time: 19.2810s
	iters: 500, epoch: 1 | loss: 0.8874090
	speed: 0.0050s/iter; left time: 18.4797s
Updating learning rate to 0.00082221479357454
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 2.9164137840270996
Epoch: 1, Steps: 523 | Train Loss: 0.6348499 Vali Loss: 0.2849515 Best vali loss: 0.2849515
	iters: 100, epoch: 2 | loss: 0.5224066
	speed: 0.0104s/iter; left time: 36.9009s
	iters: 200, epoch: 2 | loss: 0.3469894
	speed: 0.0048s/iter; left time: 16.7506s
	iters: 300, epoch: 2 | loss: 0.2526866
	speed: 0.0049s/iter; left time: 16.5219s
	iters: 400, epoch: 2 | loss: 0.8049821
	speed: 0.0048s/iter; left time: 15.7086s
	iters: 500, epoch: 2 | loss: 0.2472787
	speed: 0.0049s/iter; left time: 15.3711s
Updating learning rate to 0.0007295719019739402
Epoch: 2 cost time: 2.598116159439087
Epoch: 2, Steps: 523 | Train Loss: 0.4348687 Vali Loss: 0.2923004 Best vali loss: 0.2849515
	iters: 100, epoch: 3 | loss: 0.6459085
	speed: 0.0102s/iter; left time: 31.1369s
	iters: 200, epoch: 3 | loss: 0.6462405
	speed: 0.0049s/iter; left time: 14.4764s
	iters: 300, epoch: 3 | loss: 0.2981714
	speed: 0.0051s/iter; left time: 14.5672s
	iters: 400, epoch: 3 | loss: 0.4377634
	speed: 0.0052s/iter; left time: 14.3328s
	iters: 500, epoch: 3 | loss: 0.2456725
	speed: 0.0052s/iter; left time: 13.7708s
Updating learning rate to 0.0005909220165344886
Epoch: 3 cost time: 2.727379560470581
Epoch: 3, Steps: 523 | Train Loss: 0.4547513 Vali Loss: 0.2942063 Best vali loss: 0.2849515
	iters: 100, epoch: 4 | loss: 0.2245543
	speed: 0.0104s/iter; left time: 26.1143s
	iters: 200, epoch: 4 | loss: 0.3647731
	speed: 0.0051s/iter; left time: 12.4283s
	iters: 300, epoch: 4 | loss: 0.7228275
	speed: 0.0051s/iter; left time: 11.8456s
	iters: 400, epoch: 4 | loss: 0.6999946
	speed: 0.0052s/iter; left time: 11.4221s
	iters: 500, epoch: 4 | loss: 0.2915953
	speed: 0.0051s/iter; left time: 10.8500s
Updating learning rate to 0.00042737332545
Epoch: 4 cost time: 2.7440929412841797
Epoch: 4, Steps: 523 | Train Loss: 0.4607490 Vali Loss: 0.2946615 Best vali loss: 0.2849515
	iters: 100, epoch: 5 | loss: 0.2947358
	speed: 0.0106s/iter; left time: 21.1787s
	iters: 200, epoch: 5 | loss: 0.4989917
	speed: 0.0052s/iter; left time: 9.8328s
	iters: 300, epoch: 5 | loss: 0.3133202
	speed: 0.0052s/iter; left time: 9.2342s
	iters: 400, epoch: 5 | loss: 0.2084506
	speed: 0.0052s/iter; left time: 8.7765s
	iters: 500, epoch: 5 | loss: 0.7987618
	speed: 0.0051s/iter; left time: 8.1804s
Updating learning rate to 0.00026382463436551147
Epoch: 5 cost time: 2.7594645023345947
Epoch: 5, Steps: 523 | Train Loss: 0.4228520 Vali Loss: 0.2849759 Best vali loss: 0.2849515
	iters: 100, epoch: 6 | loss: 0.3806985
	speed: 0.0100s/iter; left time: 14.7642s
	iters: 200, epoch: 6 | loss: 0.8060178
	speed: 0.0049s/iter; left time: 6.6665s
	iters: 300, epoch: 6 | loss: 0.2969834
	speed: 0.0048s/iter; left time: 6.1507s
	iters: 400, epoch: 6 | loss: 0.2604197
	speed: 0.0049s/iter; left time: 5.7133s
	iters: 500, epoch: 6 | loss: 0.6632910
	speed: 0.0049s/iter; left time: 5.2209s
Updating learning rate to 0.0001251747489260597
Epoch: 6 cost time: 2.589142084121704
Epoch: 6, Steps: 523 | Train Loss: 0.4814821 Vali Loss: 0.3041320 Best vali loss: 0.2849515
	iters: 100, epoch: 7 | loss: 0.5680794
	speed: 0.0101s/iter; left time: 9.5597s
	iters: 200, epoch: 7 | loss: 0.1708176
	speed: 0.0048s/iter; left time: 4.0850s
	iters: 300, epoch: 7 | loss: 0.5169626
	speed: 0.0049s/iter; left time: 3.6395s
	iters: 400, epoch: 7 | loss: 0.6891849
	speed: 0.0048s/iter; left time: 3.1266s
	iters: 500, epoch: 7 | loss: 0.6159785
	speed: 0.0048s/iter; left time: 2.6512s
Updating learning rate to 3.253185732546e-05
Epoch: 7 cost time: 2.585893154144287
Epoch: 7, Steps: 523 | Train Loss: 0.5122046 Vali Loss: 0.3053478 Best vali loss: 0.2849515
	iters: 100, epoch: 8 | loss: 0.1789351
	speed: 0.0101s/iter; left time: 4.2834s
	iters: 200, epoch: 8 | loss: 0.6227589
	speed: 0.0049s/iter; left time: 1.5870s
	iters: 300, epoch: 8 | loss: 0.2134324
	speed: 0.0049s/iter; left time: 1.0890s
	iters: 400, epoch: 8 | loss: 0.4851128
	speed: 0.0049s/iter; left time: 0.6058s
	iters: 500, epoch: 8 | loss: 0.2359943
	speed: 0.0048s/iter; left time: 0.1151s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.596034049987793
Epoch: 8, Steps: 523 | Train Loss: 0.3472467 Vali Loss: 0.3005994 Best vali loss: 0.2849515

best validation loss 0.2849515175877029

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0076310052387, 'e_layers': 2, 'learning_rate': 6.80015623e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.80015623e-05
Validation loss decreased (inf --> 0.3533).  Saving model state dict ...
Epoch: 1 cost time: 0.5843431949615479
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3532815 Best vali loss: 0.3532815
Updating learning rate to 3.400078115e-05
Validation loss decreased (0.3533 --> 0.3416).  Saving model state dict ...
Epoch: 2 cost time: 0.3221762180328369
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3416483 Best vali loss: 0.3416483
Updating learning rate to 1.7000390575e-05
Validation loss decreased (0.3416 --> 0.3367).  Saving model state dict ...
Epoch: 3 cost time: 0.35257983207702637
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3367252 Best vali loss: 0.3367252

best validation loss 0.33672516463014796

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3496729
	speed: 0.0095s/iter; left time: 78.3286s
	iters: 200, epoch: 1 | loss: 0.3008279
	speed: 0.0042s/iter; left time: 34.0201s
	iters: 300, epoch: 1 | loss: 0.7654058
	speed: 0.0041s/iter; left time: 33.3858s
	iters: 400, epoch: 1 | loss: 0.3778205
	speed: 0.0041s/iter; left time: 32.9253s
	iters: 500, epoch: 1 | loss: 0.3348997
	speed: 0.0042s/iter; left time: 32.6830s
	iters: 600, epoch: 1 | loss: 0.2333366
	speed: 0.0042s/iter; left time: 32.7449s
	iters: 700, epoch: 1 | loss: 0.4004723
	speed: 0.0042s/iter; left time: 32.3261s
	iters: 800, epoch: 1 | loss: 0.2273054
	speed: 0.0042s/iter; left time: 31.6162s
	iters: 900, epoch: 1 | loss: 0.1293919
	speed: 0.0042s/iter; left time: 31.1472s
	iters: 1000, epoch: 1 | loss: 0.6002476
	speed: 0.0042s/iter; left time: 30.5960s
Updating learning rate to 0.0010132106523
Validation loss decreased (inf --> 0.2902).  Saving model state dict ...
Epoch: 1 cost time: 4.6447532176971436
Epoch: 1, Steps: 1045 | Train Loss: 0.3719381 Vali Loss: 0.2901509 Best vali loss: 0.2901509
	iters: 100, epoch: 2 | loss: 0.3018188
	speed: 0.0124s/iter; left time: 89.1600s
	iters: 200, epoch: 2 | loss: 0.3002397
	speed: 0.0042s/iter; left time: 30.1084s
	iters: 300, epoch: 2 | loss: 0.7892106
	speed: 0.0043s/iter; left time: 30.0222s
	iters: 400, epoch: 2 | loss: 0.3021793
	speed: 0.0043s/iter; left time: 29.8334s
	iters: 500, epoch: 2 | loss: 0.3064143
	speed: 0.0043s/iter; left time: 29.0861s
	iters: 600, epoch: 2 | loss: 0.6474323
	speed: 0.0043s/iter; left time: 29.0229s
	iters: 700, epoch: 2 | loss: 1.2679627
	speed: 0.0040s/iter; left time: 26.5039s
	iters: 800, epoch: 2 | loss: 0.3744925
	speed: 0.0040s/iter; left time: 25.9187s
	iters: 900, epoch: 2 | loss: 0.3123803
	speed: 0.0040s/iter; left time: 25.5523s
	iters: 1000, epoch: 2 | loss: 0.3192036
	speed: 0.0040s/iter; left time: 25.2675s
Updating learning rate to 0.00050660532615
Validation loss decreased (0.2902 --> 0.2892).  Saving model state dict ...
Epoch: 2 cost time: 4.3961522579193115
Epoch: 2, Steps: 1045 | Train Loss: 0.4921334 Vali Loss: 0.2891908 Best vali loss: 0.2891908
	iters: 100, epoch: 3 | loss: 0.4831770
	speed: 0.0123s/iter; left time: 76.1770s
	iters: 200, epoch: 3 | loss: 0.2898245
	speed: 0.0042s/iter; left time: 25.6157s
	iters: 300, epoch: 3 | loss: 0.5092884
	speed: 0.0042s/iter; left time: 24.9545s
	iters: 400, epoch: 3 | loss: 0.4353442
	speed: 0.0042s/iter; left time: 24.6840s
	iters: 500, epoch: 3 | loss: 0.2557533
	speed: 0.0042s/iter; left time: 24.4714s
	iters: 600, epoch: 3 | loss: 0.5119935
	speed: 0.0042s/iter; left time: 23.7459s
	iters: 700, epoch: 3 | loss: 0.2100851
	speed: 0.0041s/iter; left time: 23.0477s
	iters: 800, epoch: 3 | loss: 1.1940376
	speed: 0.0041s/iter; left time: 22.3237s
	iters: 900, epoch: 3 | loss: 0.1625890
	speed: 0.0042s/iter; left time: 22.4587s
	iters: 1000, epoch: 3 | loss: 0.1679535
	speed: 0.0042s/iter; left time: 21.9718s
Updating learning rate to 0.000253302663075
Validation loss decreased (0.2892 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 4.428673267364502
Epoch: 3, Steps: 1045 | Train Loss: 0.4220046 Vali Loss: 0.2839203 Best vali loss: 0.2839203

best validation loss 0.2839203102298721

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0028298480595, 'e_layers': 3, 'learning_rate': 0.0049106915834, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4292256
	speed: 0.0094s/iter; left time: 77.6166s
	iters: 200, epoch: 1 | loss: 0.2385767
	speed: 0.0040s/iter; left time: 32.6376s
	iters: 300, epoch: 1 | loss: 0.3947983
	speed: 0.0040s/iter; left time: 32.5461s
	iters: 400, epoch: 1 | loss: 0.4385753
	speed: 0.0040s/iter; left time: 31.9342s
	iters: 500, epoch: 1 | loss: 0.4438712
	speed: 0.0040s/iter; left time: 31.4533s
	iters: 600, epoch: 1 | loss: 1.2801937
	speed: 0.0041s/iter; left time: 31.6629s
	iters: 700, epoch: 1 | loss: 0.2825243
	speed: 0.0040s/iter; left time: 30.6644s
	iters: 800, epoch: 1 | loss: 0.2343782
	speed: 0.0040s/iter; left time: 30.3246s
	iters: 900, epoch: 1 | loss: 0.3184907
	speed: 0.0040s/iter; left time: 29.8182s
	iters: 1000, epoch: 1 | loss: 0.2500707
	speed: 0.0040s/iter; left time: 29.4518s
Updating learning rate to 0.004723789513889351
Validation loss decreased (inf --> 0.3177).  Saving model state dict ...
Epoch: 1 cost time: 4.475391626358032
Epoch: 1, Steps: 1045 | Train Loss: 0.4310705 Vali Loss: 0.3176572 Best vali loss: 0.3176572
	iters: 100, epoch: 2 | loss: 0.5273100
	speed: 0.0117s/iter; left time: 84.7087s
	iters: 200, epoch: 2 | loss: 0.5333949
	speed: 0.0041s/iter; left time: 29.3783s
	iters: 300, epoch: 2 | loss: 0.4263383
	speed: 0.0040s/iter; left time: 28.3902s
	iters: 400, epoch: 2 | loss: 0.3324087
	speed: 0.0041s/iter; left time: 28.0518s
	iters: 500, epoch: 2 | loss: 0.4340295
	speed: 0.0040s/iter; left time: 27.2756s
	iters: 600, epoch: 2 | loss: 0.5015984
	speed: 0.0040s/iter; left time: 26.9946s
	iters: 700, epoch: 2 | loss: 1.4566824
	speed: 0.0040s/iter; left time: 26.4702s
	iters: 800, epoch: 2 | loss: 0.4279943
	speed: 0.0040s/iter; left time: 26.0649s
	iters: 900, epoch: 2 | loss: 0.2837510
	speed: 0.0040s/iter; left time: 25.6559s
	iters: 1000, epoch: 2 | loss: 0.3582272
	speed: 0.0040s/iter; left time: 25.2703s
Updating learning rate to 0.004191537451168922
Epoch: 2 cost time: 4.246702194213867
Epoch: 2, Steps: 1045 | Train Loss: 0.5281735 Vali Loss: 0.3330222 Best vali loss: 0.3176572
	iters: 100, epoch: 3 | loss: 0.3823230
	speed: 0.0117s/iter; left time: 71.9793s
	iters: 200, epoch: 3 | loss: 0.9691440
	speed: 0.0041s/iter; left time: 25.0109s
	iters: 300, epoch: 3 | loss: 0.5635122
	speed: 0.0042s/iter; left time: 24.8423s
	iters: 400, epoch: 3 | loss: 0.4752921
	speed: 0.0043s/iter; left time: 25.4394s
	iters: 500, epoch: 3 | loss: 1.2467421
	speed: 0.0043s/iter; left time: 25.0336s
	iters: 600, epoch: 3 | loss: 0.1740913
	speed: 0.0042s/iter; left time: 23.6496s
	iters: 700, epoch: 3 | loss: 0.3803167
	speed: 0.0042s/iter; left time: 23.2738s
	iters: 800, epoch: 3 | loss: 0.4434508
	speed: 0.0041s/iter; left time: 22.6728s
	iters: 900, epoch: 3 | loss: 0.3825041
	speed: 0.0041s/iter; left time: 22.0825s
	iters: 1000, epoch: 3 | loss: 0.2272516
	speed: 0.0042s/iter; left time: 21.9297s
Updating learning rate to 0.003394965946910935
Epoch: 3 cost time: 4.409718751907349
Epoch: 3, Steps: 1045 | Train Loss: 0.5244628 Vali Loss: 0.3225883 Best vali loss: 0.3176572

best validation loss 0.3176571577731984

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3149893
	speed: 0.0094s/iter; left time: 48.0164s
	iters: 200, epoch: 4 | loss: 0.2779964
	speed: 0.0039s/iter; left time: 19.7596s
	iters: 300, epoch: 4 | loss: 0.8129970
	speed: 0.0039s/iter; left time: 19.2203s
	iters: 400, epoch: 4 | loss: 0.3435355
	speed: 0.0039s/iter; left time: 18.7000s
	iters: 500, epoch: 4 | loss: 0.3480652
	speed: 0.0039s/iter; left time: 18.4664s
	iters: 600, epoch: 4 | loss: 0.2129592
	speed: 0.0039s/iter; left time: 18.1277s
	iters: 700, epoch: 4 | loss: 0.4149344
	speed: 0.0038s/iter; left time: 17.0338s
	iters: 800, epoch: 4 | loss: 0.2001591
	speed: 0.0038s/iter; left time: 16.7908s
	iters: 900, epoch: 4 | loss: 0.1292224
	speed: 0.0038s/iter; left time: 16.2508s
	iters: 1000, epoch: 4 | loss: 0.5947059
	speed: 0.0038s/iter; left time: 16.1648s
Updating learning rate to 0.0001266513315375
Epoch: 4 cost time: 4.307708978652954
Epoch: 4, Steps: 1045 | Train Loss: 0.3649564 Vali Loss: 0.2939143 Best vali loss: 0.2839203
	iters: 100, epoch: 5 | loss: 0.3026923
	speed: 0.0119s/iter; left time: 48.4869s
	iters: 200, epoch: 5 | loss: 0.2102222
	speed: 0.0041s/iter; left time: 16.2929s
	iters: 300, epoch: 5 | loss: 0.5959710
	speed: 0.0040s/iter; left time: 15.5223s
	iters: 400, epoch: 5 | loss: 0.2826649
	speed: 0.0040s/iter; left time: 15.1297s
	iters: 500, epoch: 5 | loss: 0.2994943
	speed: 0.0040s/iter; left time: 14.7308s
	iters: 600, epoch: 5 | loss: 0.6277949
	speed: 0.0040s/iter; left time: 14.3461s
	iters: 700, epoch: 5 | loss: 1.0040804
	speed: 0.0040s/iter; left time: 13.9242s
	iters: 800, epoch: 5 | loss: 0.3257760
	speed: 0.0040s/iter; left time: 13.5249s
	iters: 900, epoch: 5 | loss: 0.2667784
	speed: 0.0040s/iter; left time: 13.1244s
	iters: 1000, epoch: 5 | loss: 0.3349707
	speed: 0.0040s/iter; left time: 12.7237s
Updating learning rate to 6.332566576875e-05
Epoch: 5 cost time: 4.249286651611328
Epoch: 5, Steps: 1045 | Train Loss: 0.4250445 Vali Loss: 0.2923435 Best vali loss: 0.2839203
	iters: 100, epoch: 6 | loss: 0.4336190
	speed: 0.0113s/iter; left time: 34.3315s
	iters: 200, epoch: 6 | loss: 0.2710468
	speed: 0.0039s/iter; left time: 11.5156s
	iters: 300, epoch: 6 | loss: 0.4897282
	speed: 0.0039s/iter; left time: 11.1305s
	iters: 400, epoch: 6 | loss: 0.4022634
	speed: 0.0037s/iter; left time: 10.0324s
	iters: 500, epoch: 6 | loss: 0.2414955
	speed: 0.0036s/iter; left time: 9.5992s
	iters: 600, epoch: 6 | loss: 0.5447912
	speed: 0.0036s/iter; left time: 9.1812s
	iters: 700, epoch: 6 | loss: 0.2064465
	speed: 0.0037s/iter; left time: 8.9270s
	iters: 800, epoch: 6 | loss: 0.9737997
	speed: 0.0037s/iter; left time: 8.5688s
	iters: 900, epoch: 6 | loss: 0.1612560
	speed: 0.0037s/iter; left time: 8.2415s
	iters: 1000, epoch: 6 | loss: 0.1610927
	speed: 0.0037s/iter; left time: 7.8688s
Updating learning rate to 3.1662832884375e-05
Epoch: 6 cost time: 3.9137063026428223
Epoch: 6, Steps: 1045 | Train Loss: 0.3885539 Vali Loss: 0.2928506 Best vali loss: 0.2839203
	iters: 100, epoch: 7 | loss: 0.1803298
	speed: 0.0113s/iter; left time: 22.5366s
	iters: 200, epoch: 7 | loss: 0.2716477
	speed: 0.0036s/iter; left time: 6.8423s
	iters: 300, epoch: 7 | loss: 0.3605171
	speed: 0.0036s/iter; left time: 6.4861s
	iters: 400, epoch: 7 | loss: 0.2589962
	speed: 0.0037s/iter; left time: 6.2024s
	iters: 500, epoch: 7 | loss: 0.1695271
	speed: 0.0037s/iter; left time: 5.8245s
	iters: 600, epoch: 7 | loss: 0.1785220
	speed: 0.0037s/iter; left time: 5.4686s
	iters: 700, epoch: 7 | loss: 0.3869812
	speed: 0.0037s/iter; left time: 5.1880s
	iters: 800, epoch: 7 | loss: 0.5706489
	speed: 0.0038s/iter; left time: 4.9654s
	iters: 900, epoch: 7 | loss: 0.4093447
	speed: 0.0039s/iter; left time: 4.6169s
	iters: 1000, epoch: 7 | loss: 0.3942595
	speed: 0.0039s/iter; left time: 4.2223s
Updating learning rate to 1.58314164421875e-05
Epoch: 7 cost time: 3.9421558380126953
Epoch: 7, Steps: 1045 | Train Loss: 0.3180774 Vali Loss: 0.2950833 Best vali loss: 0.2839203
	iters: 100, epoch: 8 | loss: 0.3921303
	speed: 0.0112s/iter; left time: 10.6365s
	iters: 200, epoch: 8 | loss: 0.2410117
	speed: 0.0036s/iter; left time: 3.0671s
	iters: 300, epoch: 8 | loss: 0.4033498
	speed: 0.0037s/iter; left time: 2.7450s
	iters: 400, epoch: 8 | loss: 0.8106582
	speed: 0.0036s/iter; left time: 2.3454s
	iters: 500, epoch: 8 | loss: 0.8938749
	speed: 0.0036s/iter; left time: 1.9776s
	iters: 600, epoch: 8 | loss: 0.3388308
	speed: 0.0037s/iter; left time: 1.6420s
	iters: 700, epoch: 8 | loss: 0.3107015
	speed: 0.0037s/iter; left time: 1.2819s
	iters: 800, epoch: 8 | loss: 0.5370466
	speed: 0.0037s/iter; left time: 0.9110s
	iters: 900, epoch: 8 | loss: 1.0714129
	speed: 0.0037s/iter; left time: 0.5414s
	iters: 1000, epoch: 8 | loss: 0.6682244
	speed: 0.0038s/iter; left time: 0.1729s
Updating learning rate to 7.91570822109375e-06
Epoch: 8 cost time: 3.882500410079956
Epoch: 8, Steps: 1045 | Train Loss: 0.5667241 Vali Loss: 0.2955863 Best vali loss: 0.2839203

best validation loss 0.2839203102298721

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0049587887577, 'e_layers': 2, 'learning_rate': 0.0017288793159, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6079074
	speed: 0.0086s/iter; left time: 71.1861s
	iters: 200, epoch: 1 | loss: 0.3293220
	speed: 0.0034s/iter; left time: 27.8662s
	iters: 300, epoch: 1 | loss: 0.6024722
	speed: 0.0034s/iter; left time: 27.7131s
	iters: 400, epoch: 1 | loss: 1.4657062
	speed: 0.0035s/iter; left time: 27.4926s
	iters: 500, epoch: 1 | loss: 0.3640582
	speed: 0.0035s/iter; left time: 27.2907s
	iters: 600, epoch: 1 | loss: 1.2075881
	speed: 0.0034s/iter; left time: 26.3408s
	iters: 700, epoch: 1 | loss: 0.5769668
	speed: 0.0034s/iter; left time: 25.9941s
	iters: 800, epoch: 1 | loss: 0.4324003
	speed: 0.0034s/iter; left time: 25.4083s
	iters: 900, epoch: 1 | loss: 0.7090906
	speed: 0.0034s/iter; left time: 25.0929s
	iters: 1000, epoch: 1 | loss: 0.6427887
	speed: 0.0034s/iter; left time: 24.8560s
Updating learning rate to 0.0016630777650210626
Validation loss decreased (inf --> 0.3072).  Saving model state dict ...
Epoch: 1 cost time: 3.833709716796875
Epoch: 1, Steps: 1045 | Train Loss: 0.6938300 Vali Loss: 0.3072204 Best vali loss: 0.3072204
	iters: 100, epoch: 2 | loss: 1.4791651
	speed: 0.0099s/iter; left time: 71.0803s
	iters: 200, epoch: 2 | loss: 0.8031355
	speed: 0.0030s/iter; left time: 21.4737s
	iters: 300, epoch: 2 | loss: 0.9775357
	speed: 0.0030s/iter; left time: 20.8066s
	iters: 400, epoch: 2 | loss: 1.2129748
	speed: 0.0028s/iter; left time: 19.3960s
	iters: 500, epoch: 2 | loss: 0.3718783
	speed: 0.0028s/iter; left time: 19.0716s
	iters: 600, epoch: 2 | loss: 0.1625013
	speed: 0.0028s/iter; left time: 18.6821s
	iters: 700, epoch: 2 | loss: 0.4477427
	speed: 0.0028s/iter; left time: 18.4069s
	iters: 800, epoch: 2 | loss: 0.3450166
	speed: 0.0028s/iter; left time: 18.3412s
	iters: 900, epoch: 2 | loss: 0.3342447
	speed: 0.0028s/iter; left time: 17.8910s
	iters: 1000, epoch: 2 | loss: 0.9518092
	speed: 0.0028s/iter; left time: 17.7248s
Updating learning rate to 0.0014756908020130246
Epoch: 2 cost time: 3.018418550491333
Epoch: 2, Steps: 1045 | Train Loss: 0.7086004 Vali Loss: 0.3256929 Best vali loss: 0.3072204
	iters: 100, epoch: 3 | loss: 0.5713821
	speed: 0.0094s/iter; left time: 57.9019s
	iters: 200, epoch: 3 | loss: 0.3083760
	speed: 0.0030s/iter; left time: 18.0088s
	iters: 300, epoch: 3 | loss: 0.2933484
	speed: 0.0031s/iter; left time: 18.5736s
	iters: 400, epoch: 3 | loss: 0.9406370
	speed: 0.0031s/iter; left time: 18.0977s
	iters: 500, epoch: 3 | loss: 0.6519893
	speed: 0.0031s/iter; left time: 17.8616s
	iters: 600, epoch: 3 | loss: 0.2867128
	speed: 0.0031s/iter; left time: 17.5307s
	iters: 700, epoch: 3 | loss: 0.7698179
	speed: 0.0031s/iter; left time: 17.1351s
	iters: 800, epoch: 3 | loss: 1.4791228
	speed: 0.0031s/iter; left time: 16.8695s
	iters: 900, epoch: 3 | loss: 0.3365119
	speed: 0.0031s/iter; left time: 16.6286s
	iters: 1000, epoch: 3 | loss: 0.6153308
	speed: 0.0031s/iter; left time: 16.3241s
Updating learning rate to 0.0011952463933268102
Validation loss decreased (0.3072 --> 0.3015).  Saving model state dict ...
Epoch: 3 cost time: 3.231938362121582
Epoch: 3, Steps: 1045 | Train Loss: 0.6253229 Vali Loss: 0.3014837 Best vali loss: 0.3014837
	iters: 100, epoch: 4 | loss: 1.0925796
	speed: 0.0101s/iter; left time: 51.7943s
	iters: 200, epoch: 4 | loss: 1.1185579
	speed: 0.0035s/iter; left time: 17.4241s
	iters: 300, epoch: 4 | loss: 0.4185420
	speed: 0.0034s/iter; left time: 16.5954s
	iters: 400, epoch: 4 | loss: 0.6193766
	speed: 0.0033s/iter; left time: 16.0883s
	iters: 500, epoch: 4 | loss: 0.4706529
	speed: 0.0033s/iter; left time: 15.7704s
	iters: 600, epoch: 4 | loss: 0.9221177
	speed: 0.0033s/iter; left time: 15.4483s
	iters: 700, epoch: 4 | loss: 1.1779208
	speed: 0.0033s/iter; left time: 15.1465s
	iters: 800, epoch: 4 | loss: 0.5118980
	speed: 0.0033s/iter; left time: 14.7812s
	iters: 900, epoch: 4 | loss: 0.5499339
	speed: 0.0033s/iter; left time: 14.4148s
	iters: 1000, epoch: 4 | loss: 0.2839176
	speed: 0.0033s/iter; left time: 14.1222s
Updating learning rate to 0.00086443965795
Validation loss decreased (0.3015 --> 0.2995).  Saving model state dict ...
Epoch: 4 cost time: 3.552608013153076
Epoch: 4, Steps: 1045 | Train Loss: 0.7165497 Vali Loss: 0.2994826 Best vali loss: 0.2994826
	iters: 100, epoch: 5 | loss: 0.5979147
	speed: 0.0105s/iter; left time: 42.8619s
	iters: 200, epoch: 5 | loss: 0.6525524
	speed: 0.0033s/iter; left time: 13.2604s
	iters: 300, epoch: 5 | loss: 0.6676863
	speed: 0.0034s/iter; left time: 13.0492s
	iters: 400, epoch: 5 | loss: 1.2841823
	speed: 0.0035s/iter; left time: 13.1530s
	iters: 500, epoch: 5 | loss: 0.5784954
	speed: 0.0033s/iter; left time: 12.2462s
	iters: 600, epoch: 5 | loss: 0.1435322
	speed: 0.0033s/iter; left time: 11.9366s
	iters: 700, epoch: 5 | loss: 1.6688787
	speed: 0.0033s/iter; left time: 11.4223s
	iters: 800, epoch: 5 | loss: 0.3019644
	speed: 0.0031s/iter; left time: 10.3892s
	iters: 900, epoch: 5 | loss: 0.8248845
	speed: 0.0030s/iter; left time: 9.9646s
	iters: 1000, epoch: 5 | loss: 1.0400794
	speed: 0.0030s/iter; left time: 9.6947s
Updating learning rate to 0.0005336329225731899
Validation loss decreased (0.2995 --> 0.2974).  Saving model state dict ...
Epoch: 5 cost time: 3.4373347759246826
Epoch: 5, Steps: 1045 | Train Loss: 0.7760170 Vali Loss: 0.2974489 Best vali loss: 0.2974489
	iters: 100, epoch: 6 | loss: 0.6783971
	speed: 0.0100s/iter; left time: 30.2822s
	iters: 200, epoch: 6 | loss: 0.2595629
	speed: 0.0033s/iter; left time: 9.6302s
	iters: 300, epoch: 6 | loss: 0.2857355
	speed: 0.0033s/iter; left time: 9.3259s
	iters: 400, epoch: 6 | loss: 0.1544235
	speed: 0.0033s/iter; left time: 8.9605s
	iters: 500, epoch: 6 | loss: 0.1719528
	speed: 0.0032s/iter; left time: 8.5345s
	iters: 600, epoch: 6 | loss: 0.7560902
	speed: 0.0033s/iter; left time: 8.3254s
	iters: 700, epoch: 6 | loss: 1.5871766
	speed: 0.0033s/iter; left time: 7.9563s
	iters: 800, epoch: 6 | loss: 2.2047033
	speed: 0.0031s/iter; left time: 7.2571s
	iters: 900, epoch: 6 | loss: 0.5027061
	speed: 0.0031s/iter; left time: 6.8487s
	iters: 1000, epoch: 6 | loss: 0.3824351
	speed: 0.0031s/iter; left time: 6.5591s
Updating learning rate to 0.0002531885138869754
Epoch: 6 cost time: 3.3924922943115234
Epoch: 6, Steps: 1045 | Train Loss: 0.6983183 Vali Loss: 0.3040815 Best vali loss: 0.2974489
	iters: 100, epoch: 7 | loss: 1.0852038
	speed: 0.0097s/iter; left time: 19.2638s
	iters: 200, epoch: 7 | loss: 0.5095109
	speed: 0.0033s/iter; left time: 6.2769s
	iters: 300, epoch: 7 | loss: 0.2628897
	speed: 0.0033s/iter; left time: 5.8761s
	iters: 400, epoch: 7 | loss: 0.3216186
	speed: 0.0033s/iter; left time: 5.5872s
	iters: 500, epoch: 7 | loss: 0.3147020
	speed: 0.0033s/iter; left time: 5.2675s
	iters: 600, epoch: 7 | loss: 0.4281641
	speed: 0.0033s/iter; left time: 4.9065s
	iters: 700, epoch: 7 | loss: 0.3275068
	speed: 0.0033s/iter; left time: 4.6289s
	iters: 800, epoch: 7 | loss: 0.5584203
	speed: 0.0033s/iter; left time: 4.2694s
	iters: 900, epoch: 7 | loss: 0.3827933
	speed: 0.0033s/iter; left time: 3.8828s
	iters: 1000, epoch: 7 | loss: 1.3181912
	speed: 0.0033s/iter; left time: 3.6068s
Updating learning rate to 6.580155087893739e-05
Epoch: 7 cost time: 3.482039451599121
Epoch: 7, Steps: 1045 | Train Loss: 0.5509001 Vali Loss: 0.3085334 Best vali loss: 0.2974489
	iters: 100, epoch: 8 | loss: 0.2474270
	speed: 0.0102s/iter; left time: 9.6498s
	iters: 200, epoch: 8 | loss: 0.2926703
	speed: 0.0033s/iter; left time: 2.8172s
	iters: 300, epoch: 8 | loss: 0.4304427
	speed: 0.0033s/iter; left time: 2.4675s
	iters: 400, epoch: 8 | loss: 0.2922165
	speed: 0.0033s/iter; left time: 2.1472s
	iters: 500, epoch: 8 | loss: 0.1998339
	speed: 0.0033s/iter; left time: 1.8207s
	iters: 600, epoch: 8 | loss: 0.5411819
	speed: 0.0033s/iter; left time: 1.4859s
	iters: 700, epoch: 8 | loss: 0.3289289
	speed: 0.0032s/iter; left time: 1.1167s
	iters: 800, epoch: 8 | loss: 0.3796452
	speed: 0.0031s/iter; left time: 0.7641s
	iters: 900, epoch: 8 | loss: 1.4183284
	speed: 0.0031s/iter; left time: 0.4548s
	iters: 1000, epoch: 8 | loss: 1.1212630
	speed: 0.0031s/iter; left time: 0.1446s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4275543689727783
Epoch: 8, Steps: 1045 | Train Loss: 0.5251938 Vali Loss: 0.3077738 Best vali loss: 0.2974489

best validation loss 0.29744890455797995

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 2, 'learning_rate': 0.0007022928253, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3361188
	speed: 0.0084s/iter; left time: 34.5098s
	iters: 200, epoch: 1 | loss: 0.3991022
	speed: 0.0034s/iter; left time: 13.6421s
	iters: 300, epoch: 1 | loss: 0.5179483
	speed: 0.0034s/iter; left time: 13.2159s
	iters: 400, epoch: 1 | loss: 0.6040606
	speed: 0.0034s/iter; left time: 12.8504s
	iters: 500, epoch: 1 | loss: 0.6037714
	speed: 0.0034s/iter; left time: 12.5975s
Updating learning rate to 0.0007022928253
Validation loss decreased (inf --> 0.2983).  Saving model state dict ...
Epoch: 1 cost time: 2.0377449989318848
Epoch: 1, Steps: 523 | Train Loss: 0.4922002 Vali Loss: 0.2982538 Best vali loss: 0.2982538
	iters: 100, epoch: 2 | loss: 0.9575424
	speed: 0.0072s/iter; left time: 25.7190s
	iters: 200, epoch: 2 | loss: 0.2700460
	speed: 0.0034s/iter; left time: 11.8202s
	iters: 300, epoch: 2 | loss: 0.5342509
	speed: 0.0034s/iter; left time: 11.4639s
	iters: 400, epoch: 2 | loss: 0.5855677
	speed: 0.0034s/iter; left time: 11.1396s
	iters: 500, epoch: 2 | loss: 0.2862953
	speed: 0.0034s/iter; left time: 10.8642s
Updating learning rate to 0.00035114641265
Validation loss decreased (0.2983 --> 0.2909).  Saving model state dict ...
Epoch: 2 cost time: 1.8231959342956543
Epoch: 2, Steps: 523 | Train Loss: 0.5267404 Vali Loss: 0.2908509 Best vali loss: 0.2908509
	iters: 100, epoch: 3 | loss: 0.3829025
	speed: 0.0073s/iter; left time: 22.2302s
	iters: 200, epoch: 3 | loss: 0.2598741
	speed: 0.0034s/iter; left time: 9.9439s
	iters: 300, epoch: 3 | loss: 0.5029809
	speed: 0.0034s/iter; left time: 9.7562s
	iters: 400, epoch: 3 | loss: 0.2465314
	speed: 0.0034s/iter; left time: 9.4098s
	iters: 500, epoch: 3 | loss: 0.2386732
	speed: 0.0035s/iter; left time: 9.1304s
Updating learning rate to 0.000175573206325
Validation loss decreased (0.2909 --> 0.2809).  Saving model state dict ...
Epoch: 3 cost time: 1.828160047531128
Epoch: 3, Steps: 523 | Train Loss: 0.3261924 Vali Loss: 0.2809367 Best vali loss: 0.2809367
	iters: 100, epoch: 4 | loss: 0.2732006
	speed: 0.0074s/iter; left time: 18.5657s
	iters: 200, epoch: 4 | loss: 0.5621431
	speed: 0.0031s/iter; left time: 7.4996s
	iters: 300, epoch: 4 | loss: 0.4250441
	speed: 0.0032s/iter; left time: 7.3457s
	iters: 400, epoch: 4 | loss: 0.2703320
	speed: 0.0032s/iter; left time: 7.0266s
	iters: 500, epoch: 4 | loss: 0.3798529
	speed: 0.0032s/iter; left time: 6.7748s
Updating learning rate to 8.77866031625e-05
Epoch: 4 cost time: 1.6958808898925781
Epoch: 4, Steps: 523 | Train Loss: 0.3821146 Vali Loss: 0.2955096 Best vali loss: 0.2809367
	iters: 100, epoch: 5 | loss: 0.6225938
	speed: 0.0072s/iter; left time: 14.4100s
	iters: 200, epoch: 5 | loss: 0.5344309
	speed: 0.0034s/iter; left time: 6.4014s
	iters: 300, epoch: 5 | loss: 0.3119896
	speed: 0.0033s/iter; left time: 5.8404s
	iters: 400, epoch: 5 | loss: 0.4185066
	speed: 0.0033s/iter; left time: 5.5244s
	iters: 500, epoch: 5 | loss: 0.2315234
	speed: 0.0033s/iter; left time: 5.1838s
Updating learning rate to 4.389330158125e-05
Epoch: 5 cost time: 1.766221284866333
Epoch: 5, Steps: 523 | Train Loss: 0.4238089 Vali Loss: 0.2946221 Best vali loss: 0.2809367
	iters: 100, epoch: 6 | loss: 0.4297820
	speed: 0.0073s/iter; left time: 10.6918s
	iters: 200, epoch: 6 | loss: 0.2063199
	speed: 0.0034s/iter; left time: 4.6910s
	iters: 300, epoch: 6 | loss: 0.2167112
	speed: 0.0034s/iter; left time: 4.3445s
	iters: 400, epoch: 6 | loss: 0.3091431
	speed: 0.0034s/iter; left time: 4.0222s
	iters: 500, epoch: 6 | loss: 0.5901308
	speed: 0.0034s/iter; left time: 3.6859s
Updating learning rate to 2.1946650790625e-05
Epoch: 6 cost time: 1.8417048454284668
Epoch: 6, Steps: 523 | Train Loss: 0.3504174 Vali Loss: 0.2919637 Best vali loss: 0.2809367
	iters: 100, epoch: 7 | loss: 0.3291878
	speed: 0.0073s/iter; left time: 6.9564s
	iters: 200, epoch: 7 | loss: 0.3215959
	speed: 0.0034s/iter; left time: 2.8779s
	iters: 300, epoch: 7 | loss: 0.2703379
	speed: 0.0035s/iter; left time: 2.5948s
	iters: 400, epoch: 7 | loss: 0.2229967
	speed: 0.0035s/iter; left time: 2.2390s
	iters: 500, epoch: 7 | loss: 0.3748711
	speed: 0.0035s/iter; left time: 1.8932s
Updating learning rate to 1.09733253953125e-05
Epoch: 7 cost time: 1.8388574123382568
Epoch: 7, Steps: 523 | Train Loss: 0.3037979 Vali Loss: 0.2945637 Best vali loss: 0.2809367
	iters: 100, epoch: 8 | loss: 0.2664957
	speed: 0.0073s/iter; left time: 3.0979s
	iters: 200, epoch: 8 | loss: 0.2434856
	speed: 0.0034s/iter; left time: 1.1155s
	iters: 300, epoch: 8 | loss: 0.5062822
	speed: 0.0035s/iter; left time: 0.7846s
	iters: 400, epoch: 8 | loss: 0.4640286
	speed: 0.0034s/iter; left time: 0.4253s
	iters: 500, epoch: 8 | loss: 0.3351146
	speed: 0.0036s/iter; left time: 0.0852s
Updating learning rate to 5.48666269765625e-06
Epoch: 8 cost time: 1.860901117324829
Epoch: 8, Steps: 523 | Train Loss: 0.3630813 Vali Loss: 0.2951433 Best vali loss: 0.2809367

best validation loss 0.2809366586040768

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096207564637, 'e_layers': 2, 'learning_rate': 0.0003903011818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3608462
	speed: 0.0088s/iter; left time: 35.9186s
	iters: 200, epoch: 1 | loss: 0.3387230
	speed: 0.0035s/iter; left time: 13.9525s
	iters: 300, epoch: 1 | loss: 0.6354194
	speed: 0.0035s/iter; left time: 13.5764s
	iters: 400, epoch: 1 | loss: 0.3497261
	speed: 0.0034s/iter; left time: 12.8923s
	iters: 500, epoch: 1 | loss: 0.5323489
	speed: 0.0033s/iter; left time: 12.2224s
Updating learning rate to 0.0003903011818
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 2.0698115825653076
Epoch: 1, Steps: 523 | Train Loss: 0.4434127 Vali Loss: 0.2811711 Best vali loss: 0.2811711
	iters: 100, epoch: 2 | loss: 0.2930171
	speed: 0.0075s/iter; left time: 26.7210s
	iters: 200, epoch: 2 | loss: 0.5561981
	speed: 0.0035s/iter; left time: 12.0173s
	iters: 300, epoch: 2 | loss: 0.4270189
	speed: 0.0035s/iter; left time: 11.7150s
	iters: 400, epoch: 2 | loss: 0.3056159
	speed: 0.0035s/iter; left time: 11.3167s
	iters: 500, epoch: 2 | loss: 0.4051103
	speed: 0.0035s/iter; left time: 10.9767s
Updating learning rate to 0.0001951505909
Epoch: 2 cost time: 1.8589625358581543
Epoch: 2, Steps: 523 | Train Loss: 0.3973920 Vali Loss: 0.2908450 Best vali loss: 0.2811711
	iters: 100, epoch: 3 | loss: 0.3838393
	speed: 0.0073s/iter; left time: 22.0417s
	iters: 200, epoch: 3 | loss: 0.1970884
	speed: 0.0032s/iter; left time: 9.3918s
	iters: 300, epoch: 3 | loss: 0.3569506
	speed: 0.0032s/iter; left time: 9.1225s
	iters: 400, epoch: 3 | loss: 0.5873567
	speed: 0.0032s/iter; left time: 8.8806s
	iters: 500, epoch: 3 | loss: 0.5767660
	speed: 0.0032s/iter; left time: 8.4691s
Updating learning rate to 9.757529545e-05
Epoch: 3 cost time: 1.7178804874420166
Epoch: 3, Steps: 523 | Train Loss: 0.4204002 Vali Loss: 0.2820690 Best vali loss: 0.2811711

best validation loss 0.28117111800726835

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 6.03723773e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4320134
	speed: 0.0098s/iter; left time: 9.3037s
Updating learning rate to 5.8074590508259505e-05
Validation loss decreased (inf --> 0.3451).  Saving model state dict ...
Epoch: 1 cost time: 0.8586487770080566
Epoch: 1, Steps: 131 | Train Loss: 0.4320134 Vali Loss: 0.3451400 Best vali loss: 0.3451400
	iters: 100, epoch: 2 | loss: 0.6943498
	speed: 0.0078s/iter; left time: 6.3476s
Updating learning rate to 5.153104734259139e-05
Validation loss decreased (0.3451 --> 0.3299).  Saving model state dict ...
Epoch: 2 cost time: 0.6357011795043945
Epoch: 2, Steps: 131 | Train Loss: 0.6943498 Vali Loss: 0.3298644 Best vali loss: 0.3298644
	iters: 100, epoch: 3 | loss: 0.9485378
	speed: 0.0076s/iter; left time: 5.2438s
Updating learning rate to 4.1737942932602113e-05
Validation loss decreased (0.3299 --> 0.3202).  Saving model state dict ...
Epoch: 3 cost time: 0.611030101776123
Epoch: 3, Steps: 131 | Train Loss: 0.9485378 Vali Loss: 0.3202057 Best vali loss: 0.3202057

best validation loss 0.32020570574395496

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7276980
	speed: 0.0087s/iter; left time: 35.6512s
	iters: 200, epoch: 1 | loss: 0.7011939
	speed: 0.0035s/iter; left time: 13.7879s
	iters: 300, epoch: 1 | loss: 0.3864060
	speed: 0.0035s/iter; left time: 13.5628s
	iters: 400, epoch: 1 | loss: 0.2710159
	speed: 0.0035s/iter; left time: 13.1334s
	iters: 500, epoch: 1 | loss: 0.5340909
	speed: 0.0033s/iter; left time: 12.2074s
Updating learning rate to 0.00019193372885267988
Validation loss decreased (inf --> 0.2754).  Saving model state dict ...
Epoch: 1 cost time: 2.0628175735473633
Epoch: 1, Steps: 523 | Train Loss: 0.5240810 Vali Loss: 0.2753594 Best vali loss: 0.2753594
	iters: 100, epoch: 2 | loss: 0.3212515
	speed: 0.0069s/iter; left time: 24.7192s
	iters: 200, epoch: 2 | loss: 0.5093736
	speed: 0.0030s/iter; left time: 10.3826s
	iters: 300, epoch: 2 | loss: 0.8628918
	speed: 0.0032s/iter; left time: 10.6974s
	iters: 400, epoch: 2 | loss: 0.6030171
	speed: 0.0031s/iter; left time: 10.2402s
	iters: 500, epoch: 2 | loss: 0.6119345
	speed: 0.0030s/iter; left time: 9.3311s
Updating learning rate to 0.00017030763336576413
Epoch: 2 cost time: 1.6308603286743164
Epoch: 2, Steps: 523 | Train Loss: 0.5816937 Vali Loss: 0.2778565 Best vali loss: 0.2753594
	iters: 100, epoch: 3 | loss: 0.3089369
	speed: 0.0072s/iter; left time: 22.0268s
	iters: 200, epoch: 3 | loss: 0.2752380
	speed: 0.0035s/iter; left time: 10.3445s
	iters: 300, epoch: 3 | loss: 0.7028895
	speed: 0.0035s/iter; left time: 9.9771s
	iters: 400, epoch: 3 | loss: 0.8602192
	speed: 0.0035s/iter; left time: 9.6446s
	iters: 500, epoch: 3 | loss: 0.2608246
	speed: 0.0035s/iter; left time: 9.2901s
Updating learning rate to 0.00013794189423609193
Epoch: 3 cost time: 1.8800303936004639
Epoch: 3, Steps: 523 | Train Loss: 0.4816216 Vali Loss: 0.2806266 Best vali loss: 0.2753594

best validation loss 0.2753593903346636

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4286644
	speed: 0.0089s/iter; left time: 22.3908s
	iters: 200, epoch: 4 | loss: 0.3389888
	speed: 0.0034s/iter; left time: 8.1954s
	iters: 300, epoch: 4 | loss: 0.2878295
	speed: 0.0034s/iter; left time: 7.7736s
	iters: 400, epoch: 4 | loss: 0.2615167
	speed: 0.0034s/iter; left time: 7.4889s
	iters: 500, epoch: 4 | loss: 0.3202443
	speed: 0.0034s/iter; left time: 7.2578s
Updating learning rate to 9.976390185e-05
Epoch: 4 cost time: 2.0429821014404297
Epoch: 4, Steps: 523 | Train Loss: 0.3274487 Vali Loss: 0.2807024 Best vali loss: 0.2753594
	iters: 100, epoch: 5 | loss: 0.2559368
	speed: 0.0074s/iter; left time: 14.7160s
	iters: 200, epoch: 5 | loss: 0.4280900
	speed: 0.0035s/iter; left time: 6.6106s
	iters: 300, epoch: 5 | loss: 0.4897342
	speed: 0.0035s/iter; left time: 6.2568s
	iters: 400, epoch: 5 | loss: 0.4676594
	speed: 0.0035s/iter; left time: 5.8681s
	iters: 500, epoch: 5 | loss: 0.4950738
	speed: 0.0035s/iter; left time: 5.5020s
Updating learning rate to 6.158590946390807e-05
Epoch: 5 cost time: 1.8541960716247559
Epoch: 5, Steps: 523 | Train Loss: 0.4272988 Vali Loss: 0.3058534 Best vali loss: 0.2753594
	iters: 100, epoch: 6 | loss: 0.1773152
	speed: 0.0074s/iter; left time: 10.8232s
	iters: 200, epoch: 6 | loss: 0.2278584
	speed: 0.0034s/iter; left time: 4.6481s
	iters: 300, epoch: 6 | loss: 0.3531408
	speed: 0.0034s/iter; left time: 4.2971s
	iters: 400, epoch: 6 | loss: 0.5378733
	speed: 0.0033s/iter; left time: 3.8959s
	iters: 500, epoch: 6 | loss: 0.1920164
	speed: 0.0032s/iter; left time: 3.4270s
Updating learning rate to 2.922017033423585e-05
Epoch: 6 cost time: 1.7863192558288574
Epoch: 6, Steps: 523 | Train Loss: 0.2976408 Vali Loss: 0.3144204 Best vali loss: 0.2753594
	iters: 100, epoch: 7 | loss: 0.4489094
	speed: 0.0068s/iter; left time: 6.4242s
	iters: 200, epoch: 7 | loss: 0.2503020
	speed: 0.0030s/iter; left time: 2.5081s
	iters: 300, epoch: 7 | loss: 0.1239594
	speed: 0.0029s/iter; left time: 2.1883s
	iters: 400, epoch: 7 | loss: 0.1633350
	speed: 0.0030s/iter; left time: 1.9340s
	iters: 500, epoch: 7 | loss: 0.1639938
	speed: 0.0033s/iter; left time: 1.7800s
Updating learning rate to 7.594074847320105e-06
Epoch: 7 cost time: 1.6173665523529053
Epoch: 7, Steps: 523 | Train Loss: 0.2300999 Vali Loss: 0.3237055 Best vali loss: 0.2753594
	iters: 100, epoch: 8 | loss: 0.3627416
	speed: 0.0068s/iter; left time: 2.8959s
	iters: 200, epoch: 8 | loss: 0.3240383
	speed: 0.0031s/iter; left time: 1.0165s
	iters: 300, epoch: 8 | loss: 0.3041580
	speed: 0.0032s/iter; left time: 0.7080s
	iters: 400, epoch: 8 | loss: 0.1948284
	speed: 0.0032s/iter; left time: 0.3915s
	iters: 500, epoch: 8 | loss: 0.1591659
	speed: 0.0031s/iter; left time: 0.0748s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6750192642211914
Epoch: 8, Steps: 523 | Train Loss: 0.2689864 Vali Loss: 0.3260837 Best vali loss: 0.2753594

best validation loss 0.2753593903346636

[INFO][abstract_intensifier.py:595] Added config 47e958 and rejected config eb8e22 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0031170389496, 'e_layers': 1, 'learning_rate': 0.0003294206574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3620527
	speed: 0.0077s/iter; left time: 31.3139s
	iters: 200, epoch: 1 | loss: 0.3042333
	speed: 0.0025s/iter; left time: 9.9210s
	iters: 300, epoch: 1 | loss: 0.2821470
	speed: 0.0025s/iter; left time: 9.7081s
	iters: 400, epoch: 1 | loss: 0.2802006
	speed: 0.0025s/iter; left time: 9.3723s
	iters: 500, epoch: 1 | loss: 0.7582731
	speed: 0.0025s/iter; left time: 9.2167s
Updating learning rate to 0.0003168828301791364
Validation loss decreased (inf --> 0.2816).  Saving model state dict ...
Epoch: 1 cost time: 1.5640475749969482
Epoch: 1, Steps: 523 | Train Loss: 0.3973813 Vali Loss: 0.2816187 Best vali loss: 0.2816187
	iters: 100, epoch: 2 | loss: 0.8944126
	speed: 0.0058s/iter; left time: 20.7787s
	iters: 200, epoch: 2 | loss: 0.3261782
	speed: 0.0023s/iter; left time: 8.1085s
	iters: 300, epoch: 2 | loss: 0.5692490
	speed: 0.0024s/iter; left time: 8.0348s
	iters: 400, epoch: 2 | loss: 0.3532584
	speed: 0.0024s/iter; left time: 7.8056s
	iters: 500, epoch: 2 | loss: 0.5755911
	speed: 0.0024s/iter; left time: 7.5896s
Updating learning rate to 0.0002811781190552352
Epoch: 2 cost time: 1.2803950309753418
Epoch: 2, Steps: 523 | Train Loss: 0.5437379 Vali Loss: 0.2866306 Best vali loss: 0.2816187
	iters: 100, epoch: 3 | loss: 0.3692434
	speed: 0.0057s/iter; left time: 17.2162s
	iters: 200, epoch: 3 | loss: 0.3163434
	speed: 0.0022s/iter; left time: 6.5949s
	iters: 300, epoch: 3 | loss: 0.7758266
	speed: 0.0023s/iter; left time: 6.4596s
	iters: 400, epoch: 3 | loss: 0.7275352
	speed: 0.0023s/iter; left time: 6.3355s
	iters: 500, epoch: 3 | loss: 0.3981979
	speed: 0.0024s/iter; left time: 6.2552s
Updating learning rate to 0.0002277422426328982
Epoch: 3 cost time: 1.236849069595337
Epoch: 3, Steps: 523 | Train Loss: 0.5174293 Vali Loss: 0.2865673 Best vali loss: 0.2816187
	iters: 100, epoch: 4 | loss: 0.6023610
	speed: 0.0058s/iter; left time: 14.7024s
	iters: 200, epoch: 4 | loss: 0.2279692
	speed: 0.0024s/iter; left time: 5.7467s
	iters: 300, epoch: 4 | loss: 0.3474660
	speed: 0.0024s/iter; left time: 5.5509s
	iters: 400, epoch: 4 | loss: 0.6415023
	speed: 0.0024s/iter; left time: 5.2939s
	iters: 500, epoch: 4 | loss: 0.4933259
	speed: 0.0024s/iter; left time: 5.0532s
Updating learning rate to 0.0001647103287
Epoch: 4 cost time: 1.2944846153259277
Epoch: 4, Steps: 523 | Train Loss: 0.4625249 Vali Loss: 0.2890683 Best vali loss: 0.2816187
	iters: 100, epoch: 5 | loss: 0.4772754
	speed: 0.0054s/iter; left time: 10.7003s
	iters: 200, epoch: 5 | loss: 0.5995069
	speed: 0.0022s/iter; left time: 4.1460s
	iters: 300, epoch: 5 | loss: 0.4242395
	speed: 0.0023s/iter; left time: 4.0751s
	iters: 400, epoch: 5 | loss: 0.2707427
	speed: 0.0023s/iter; left time: 3.8653s
	iters: 500, epoch: 5 | loss: 0.3377467
	speed: 0.0023s/iter; left time: 3.5930s
Updating learning rate to 0.00010167841476710186
Epoch: 5 cost time: 1.1938250064849854
Epoch: 5, Steps: 523 | Train Loss: 0.4219022 Vali Loss: 0.2940479 Best vali loss: 0.2816187
	iters: 100, epoch: 6 | loss: 0.3965563
	speed: 0.0053s/iter; left time: 7.7618s
	iters: 200, epoch: 6 | loss: 0.3827370
	speed: 0.0023s/iter; left time: 3.1251s
	iters: 300, epoch: 6 | loss: 0.4153548
	speed: 0.0022s/iter; left time: 2.8093s
	iters: 400, epoch: 6 | loss: 0.6085548
	speed: 0.0023s/iter; left time: 2.6898s
	iters: 500, epoch: 6 | loss: 0.6921847
	speed: 0.0023s/iter; left time: 2.4906s
Updating learning rate to 4.824253834476479e-05
Epoch: 6 cost time: 1.2211153507232666
Epoch: 6, Steps: 523 | Train Loss: 0.4990775 Vali Loss: 0.2987163 Best vali loss: 0.2816187
	iters: 100, epoch: 7 | loss: 0.3063294
	speed: 0.0054s/iter; left time: 5.1069s
	iters: 200, epoch: 7 | loss: 0.3267055
	speed: 0.0021s/iter; left time: 1.7425s
	iters: 300, epoch: 7 | loss: 0.4612758
	speed: 0.0021s/iter; left time: 1.5528s
	iters: 400, epoch: 7 | loss: 0.2766118
	speed: 0.0021s/iter; left time: 1.3495s
	iters: 500, epoch: 7 | loss: 0.5291141
	speed: 0.0021s/iter; left time: 1.1386s
Updating learning rate to 1.2537827220863625e-05
Epoch: 7 cost time: 1.120666265487671
Epoch: 7, Steps: 523 | Train Loss: 0.3800073 Vali Loss: 0.3035035 Best vali loss: 0.2816187
	iters: 100, epoch: 8 | loss: 0.2856875
	speed: 0.0053s/iter; left time: 2.2623s
	iters: 200, epoch: 8 | loss: 0.2685328
	speed: 0.0023s/iter; left time: 0.7522s
	iters: 300, epoch: 8 | loss: 0.2036402
	speed: 0.0023s/iter; left time: 0.5201s
	iters: 400, epoch: 8 | loss: 0.1749700
	speed: 0.0023s/iter; left time: 0.2892s
	iters: 500, epoch: 8 | loss: 0.2968033
	speed: 0.0023s/iter; left time: 0.0548s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2372446060180664
Epoch: 8, Steps: 523 | Train Loss: 0.2459268 Vali Loss: 0.2996728 Best vali loss: 0.2816187

best validation loss 0.28161874468351394

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018706532697, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0229294
	speed: 0.0085s/iter; left time: 16.9802s
	iters: 200, epoch: 1 | loss: 0.8034914
	speed: 0.0033s/iter; left time: 6.2617s
Updating learning rate to 0.0002779769506
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 1.1282026767730713
Epoch: 1, Steps: 262 | Train Loss: 0.9132104 Vali Loss: 0.2837252 Best vali loss: 0.2837252
	iters: 100, epoch: 2 | loss: 0.8713190
	speed: 0.0076s/iter; left time: 13.1072s
	iters: 200, epoch: 2 | loss: 0.4293065
	speed: 0.0031s/iter; left time: 5.0859s
Updating learning rate to 0.0001389884753
Validation loss decreased (0.2837 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 0.8728101253509521
Epoch: 2, Steps: 262 | Train Loss: 0.6503128 Vali Loss: 0.2787934 Best vali loss: 0.2787934
	iters: 100, epoch: 3 | loss: 0.6425304
	speed: 0.0075s/iter; left time: 11.0248s
	iters: 200, epoch: 3 | loss: 0.5949354
	speed: 0.0034s/iter; left time: 4.6555s
Updating learning rate to 6.949423765e-05
Epoch: 3 cost time: 0.9192807674407959
Epoch: 3, Steps: 262 | Train Loss: 0.6187329 Vali Loss: 0.2834612 Best vali loss: 0.2787934
	iters: 100, epoch: 4 | loss: 0.3221453
	speed: 0.0082s/iter; left time: 9.8885s
	iters: 200, epoch: 4 | loss: 1.1415524
	speed: 0.0037s/iter; left time: 4.1324s
Updating learning rate to 3.4747118825e-05
Epoch: 4 cost time: 1.0328481197357178
Epoch: 4, Steps: 262 | Train Loss: 0.7318489 Vali Loss: 0.2856922 Best vali loss: 0.2787934
	iters: 100, epoch: 5 | loss: 0.3757751
	speed: 0.0077s/iter; left time: 7.3215s
	iters: 200, epoch: 5 | loss: 0.4374102
	speed: 0.0032s/iter; left time: 2.7281s
Updating learning rate to 1.73735594125e-05
Epoch: 5 cost time: 0.871741533279419
Epoch: 5, Steps: 262 | Train Loss: 0.4065927 Vali Loss: 0.2848747 Best vali loss: 0.2787934
	iters: 100, epoch: 6 | loss: 0.3634604
	speed: 0.0079s/iter; left time: 5.4071s
	iters: 200, epoch: 6 | loss: 0.5360553
	speed: 0.0035s/iter; left time: 2.0393s
Updating learning rate to 8.68677970625e-06
Epoch: 6 cost time: 0.956526517868042
Epoch: 6, Steps: 262 | Train Loss: 0.4497578 Vali Loss: 0.2851393 Best vali loss: 0.2787934
	iters: 100, epoch: 7 | loss: 0.2829718
	speed: 0.0076s/iter; left time: 3.2425s
	iters: 200, epoch: 7 | loss: 0.6651269
	speed: 0.0032s/iter; left time: 1.0349s
Updating learning rate to 4.343389853125e-06
Epoch: 7 cost time: 0.8912677764892578
Epoch: 7, Steps: 262 | Train Loss: 0.4740494 Vali Loss: 0.2846930 Best vali loss: 0.2787934
	iters: 100, epoch: 8 | loss: 0.3963688
	speed: 0.0073s/iter; left time: 1.1973s
	iters: 200, epoch: 8 | loss: 0.6452500
	speed: 0.0033s/iter; left time: 0.2070s
Updating learning rate to 2.1716949265625e-06
Epoch: 8 cost time: 0.9117166996002197
Epoch: 8, Steps: 262 | Train Loss: 0.5208094 Vali Loss: 0.2848420 Best vali loss: 0.2787934

best validation loss 0.2787933721889036

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.003868950085, 'e_layers': 4, 'learning_rate': 0.0048421309082, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8367279
	speed: 0.0101s/iter; left time: 41.3199s
	iters: 200, epoch: 1 | loss: 0.3811951
	speed: 0.0049s/iter; left time: 19.5011s
	iters: 300, epoch: 1 | loss: 0.8543878
	speed: 0.0049s/iter; left time: 18.9211s
	iters: 400, epoch: 1 | loss: 0.3041623
	speed: 0.0048s/iter; left time: 18.2960s
	iters: 500, epoch: 1 | loss: 0.4063407
	speed: 0.0048s/iter; left time: 17.7458s
Updating learning rate to 0.0048421309082
Validation loss decreased (inf --> 0.3238).  Saving model state dict ...
Epoch: 1 cost time: 2.810884475708008
Epoch: 1, Steps: 523 | Train Loss: 0.5565627 Vali Loss: 0.3237816 Best vali loss: 0.3237816
	iters: 100, epoch: 2 | loss: 0.2648646
	speed: 0.0098s/iter; left time: 34.7684s
	iters: 200, epoch: 2 | loss: 0.7836335
	speed: 0.0047s/iter; left time: 16.2666s
	iters: 300, epoch: 2 | loss: 0.4007237
	speed: 0.0047s/iter; left time: 15.8442s
	iters: 400, epoch: 2 | loss: 0.9730234
	speed: 0.0047s/iter; left time: 15.3310s
	iters: 500, epoch: 2 | loss: 0.4946378
	speed: 0.0047s/iter; left time: 14.8844s
Updating learning rate to 0.0024210654541
Epoch: 2 cost time: 2.49985408782959
Epoch: 2, Steps: 523 | Train Loss: 0.5833766 Vali Loss: 0.3242944 Best vali loss: 0.3237816
	iters: 100, epoch: 3 | loss: 0.3013956
	speed: 0.0100s/iter; left time: 30.3210s
	iters: 200, epoch: 3 | loss: 0.2461423
	speed: 0.0052s/iter; left time: 15.2651s
	iters: 300, epoch: 3 | loss: 0.3363269
	speed: 0.0052s/iter; left time: 14.8533s
	iters: 400, epoch: 3 | loss: 0.3440225
	speed: 0.0051s/iter; left time: 13.9157s
	iters: 500, epoch: 3 | loss: 0.3060488
	speed: 0.0050s/iter; left time: 13.0815s
Updating learning rate to 0.00121053272705
Validation loss decreased (0.3238 --> 0.3225).  Saving model state dict ...
Epoch: 3 cost time: 2.7209672927856445
Epoch: 3, Steps: 523 | Train Loss: 0.3067872 Vali Loss: 0.3225280 Best vali loss: 0.3225280

best validation loss 0.3225279681248796

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 1, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.3244).  Saving model state dict ...
Epoch: 1 cost time: 0.5014591217041016
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3243869 Best vali loss: 0.3243869
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.3244 --> 0.3044).  Saving model state dict ...
Epoch: 2 cost time: 0.26782727241516113
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3043548 Best vali loss: 0.3043548
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.3044 --> 0.2985).  Saving model state dict ...
Epoch: 3 cost time: 0.25810670852661133
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2984961 Best vali loss: 0.2984961

best validation loss 0.2984961466901849

[INFO][smbo.py:320] Finished 50 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6593277
	speed: 0.0109s/iter; left time: 10.3426s
Updating learning rate to 0.000280255645
Validation loss decreased (inf --> 0.3069).  Saving model state dict ...
Epoch: 1 cost time: 1.0038790702819824
Epoch: 1, Steps: 131 | Train Loss: 0.6593277 Vali Loss: 0.3068873 Best vali loss: 0.3068873
	iters: 100, epoch: 2 | loss: 0.4478238
	speed: 0.0093s/iter; left time: 7.6000s
Updating learning rate to 0.0001401278225
Validation loss decreased (0.3069 --> 0.2916).  Saving model state dict ...
Epoch: 2 cost time: 0.7765181064605713
Epoch: 2, Steps: 131 | Train Loss: 0.4478238 Vali Loss: 0.2916223 Best vali loss: 0.2916223
	iters: 100, epoch: 3 | loss: 0.6688806
	speed: 0.0088s/iter; left time: 6.0297s
Updating learning rate to 7.006391125e-05
Validation loss decreased (0.2916 --> 0.2885).  Saving model state dict ...
Epoch: 3 cost time: 0.7107594013214111
Epoch: 3, Steps: 131 | Train Loss: 0.6688806 Vali Loss: 0.2884890 Best vali loss: 0.2884890

best validation loss 0.2884890007547128

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6140819
	speed: 0.0106s/iter; left time: 5.8822s
Updating learning rate to 3.5031955625e-05
Validation loss decreased (0.2885 --> 0.2863).  Saving model state dict ...
Epoch: 4 cost time: 0.9454443454742432
Epoch: 4, Steps: 131 | Train Loss: 0.6140819 Vali Loss: 0.2862769 Best vali loss: 0.2862769
	iters: 100, epoch: 5 | loss: 0.4319545
	speed: 0.0090s/iter; left time: 3.8175s
Updating learning rate to 1.75159778125e-05
Validation loss decreased (0.2863 --> 0.2858).  Saving model state dict ...
Epoch: 5 cost time: 0.7513601779937744
Epoch: 5, Steps: 131 | Train Loss: 0.4319545 Vali Loss: 0.2857986 Best vali loss: 0.2857986
	iters: 100, epoch: 6 | loss: 0.6632000
	speed: 0.0089s/iter; left time: 2.6167s
Updating learning rate to 8.75798890625e-06
Validation loss decreased (0.2858 --> 0.2855).  Saving model state dict ...
Epoch: 6 cost time: 0.7321724891662598
Epoch: 6, Steps: 131 | Train Loss: 0.6632000 Vali Loss: 0.2855310 Best vali loss: 0.2855310
	iters: 100, epoch: 7 | loss: 0.4742650
	speed: 0.0089s/iter; left time: 1.4503s
Updating learning rate to 4.378994453125e-06
Validation loss decreased (0.2855 --> 0.2854).  Saving model state dict ...
Epoch: 7 cost time: 0.7242310047149658
Epoch: 7, Steps: 131 | Train Loss: 0.4742650 Vali Loss: 0.2854296 Best vali loss: 0.2854296
	iters: 100, epoch: 8 | loss: 0.4899097
	speed: 0.0086s/iter; left time: 0.2739s
Updating learning rate to 2.1894972265625e-06
Validation loss decreased (0.2854 --> 0.2854).  Saving model state dict ...
Epoch: 8 cost time: 0.7080659866333008
Epoch: 8, Steps: 131 | Train Loss: 0.4899097 Vali Loss: 0.2853875 Best vali loss: 0.2853875

best validation loss 0.28538747370110074

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001339657668, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4125853
	speed: 0.0097s/iter; left time: 19.2819s
	iters: 200, epoch: 1 | loss: 0.3562566
	speed: 0.0044s/iter; left time: 8.3819s
Updating learning rate to 0.0001339657668
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 1.4273552894592285
Epoch: 1, Steps: 262 | Train Loss: 0.3844209 Vali Loss: 0.2778911 Best vali loss: 0.2778911
	iters: 100, epoch: 2 | loss: 0.6765474
	speed: 0.0095s/iter; left time: 16.4991s
	iters: 200, epoch: 2 | loss: 1.0276878
	speed: 0.0045s/iter; left time: 7.3428s
Updating learning rate to 6.69828834e-05
Epoch: 2 cost time: 1.1940879821777344
Epoch: 2, Steps: 262 | Train Loss: 0.8521176 Vali Loss: 0.2786386 Best vali loss: 0.2778911
	iters: 100, epoch: 3 | loss: 0.3372014
	speed: 0.0094s/iter; left time: 13.7949s
	iters: 200, epoch: 3 | loss: 0.4609301
	speed: 0.0041s/iter; left time: 5.5928s
Updating learning rate to 3.34914417e-05
Epoch: 3 cost time: 1.1145167350769043
Epoch: 3, Steps: 262 | Train Loss: 0.3990658 Vali Loss: 0.2820377 Best vali loss: 0.2778911
	iters: 100, epoch: 4 | loss: 0.5451021
	speed: 0.0091s/iter; left time: 11.0422s
	iters: 200, epoch: 4 | loss: 0.3841116
	speed: 0.0042s/iter; left time: 4.6891s
Updating learning rate to 1.674572085e-05
Epoch: 4 cost time: 1.1262435913085938
Epoch: 4, Steps: 262 | Train Loss: 0.4646069 Vali Loss: 0.2833338 Best vali loss: 0.2778911
	iters: 100, epoch: 5 | loss: 0.3046725
	speed: 0.0091s/iter; left time: 8.6044s
	iters: 200, epoch: 5 | loss: 0.3507918
	speed: 0.0043s/iter; left time: 3.6475s
Updating learning rate to 8.372860425e-06
Epoch: 5 cost time: 1.1450414657592773
Epoch: 5, Steps: 262 | Train Loss: 0.3277321 Vali Loss: 0.2845647 Best vali loss: 0.2778911
	iters: 100, epoch: 6 | loss: 0.3829932
	speed: 0.0098s/iter; left time: 6.7034s
	iters: 200, epoch: 6 | loss: 0.4525208
	speed: 0.0045s/iter; left time: 2.6139s
Updating learning rate to 4.1864302125e-06
Epoch: 6 cost time: 1.2147791385650635
Epoch: 6, Steps: 262 | Train Loss: 0.4177570 Vali Loss: 0.2859204 Best vali loss: 0.2778911
	iters: 100, epoch: 7 | loss: 0.3559512
	speed: 0.0095s/iter; left time: 4.0475s
	iters: 200, epoch: 7 | loss: 0.2630753
	speed: 0.0044s/iter; left time: 1.4310s
Updating learning rate to 2.09321510625e-06
Epoch: 7 cost time: 1.1960804462432861
Epoch: 7, Steps: 262 | Train Loss: 0.3095133 Vali Loss: 0.2858425 Best vali loss: 0.2778911
	iters: 100, epoch: 8 | loss: 0.4015946
	speed: 0.0094s/iter; left time: 1.5268s
	iters: 200, epoch: 8 | loss: 0.6211826
	speed: 0.0042s/iter; left time: 0.2655s
Updating learning rate to 1.046607553125e-06
Epoch: 8 cost time: 1.1623640060424805
Epoch: 8, Steps: 262 | Train Loss: 0.5113886 Vali Loss: 0.2862811 Best vali loss: 0.2778911

best validation loss 0.27789110518290944

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7767021
	speed: 0.0077s/iter; left time: 15.4026s
	iters: 200, epoch: 1 | loss: 0.5225636
	speed: 0.0025s/iter; left time: 4.7593s
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.3121).  Saving model state dict ...
Epoch: 1 cost time: 0.9290115833282471
Epoch: 1, Steps: 262 | Train Loss: 0.6496329 Vali Loss: 0.3121413 Best vali loss: 0.3121413
	iters: 100, epoch: 2 | loss: 0.5196841
	speed: 0.0061s/iter; left time: 10.5280s
	iters: 200, epoch: 2 | loss: 0.3668863
	speed: 0.0024s/iter; left time: 3.9540s
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.3121 --> 0.2951).  Saving model state dict ...
Epoch: 2 cost time: 0.6740846633911133
Epoch: 2, Steps: 262 | Train Loss: 0.4432852 Vali Loss: 0.2951241 Best vali loss: 0.2951241
	iters: 100, epoch: 3 | loss: 0.6012088
	speed: 0.0059s/iter; left time: 8.6737s
	iters: 200, epoch: 3 | loss: 0.9024422
	speed: 0.0024s/iter; left time: 3.2759s
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.2951 --> 0.2900).  Saving model state dict ...
Epoch: 3 cost time: 0.6697113513946533
Epoch: 3, Steps: 262 | Train Loss: 0.7518255 Vali Loss: 0.2900007 Best vali loss: 0.2900007
	iters: 100, epoch: 4 | loss: 0.4751893
	speed: 0.0062s/iter; left time: 7.4809s
	iters: 200, epoch: 4 | loss: 0.5125585
	speed: 0.0025s/iter; left time: 2.8236s
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.2900 --> 0.2880).  Saving model state dict ...
Epoch: 4 cost time: 0.7090919017791748
Epoch: 4, Steps: 262 | Train Loss: 0.4938739 Vali Loss: 0.2880005 Best vali loss: 0.2880005
	iters: 100, epoch: 5 | loss: 0.4601680
	speed: 0.0061s/iter; left time: 5.7860s
	iters: 200, epoch: 5 | loss: 0.4985771
	speed: 0.0025s/iter; left time: 2.1384s
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.2880 --> 0.2872).  Saving model state dict ...
Epoch: 5 cost time: 0.6936919689178467
Epoch: 5, Steps: 262 | Train Loss: 0.4793726 Vali Loss: 0.2871748 Best vali loss: 0.2871748
	iters: 100, epoch: 6 | loss: 0.5880463
	speed: 0.0061s/iter; left time: 4.2213s
	iters: 200, epoch: 6 | loss: 0.5951053
	speed: 0.0024s/iter; left time: 1.3931s
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.2872 --> 0.2868).  Saving model state dict ...
Epoch: 6 cost time: 0.68961501121521
Epoch: 6, Steps: 262 | Train Loss: 0.5915758 Vali Loss: 0.2868098 Best vali loss: 0.2868098
	iters: 100, epoch: 7 | loss: 0.5862942
	speed: 0.0060s/iter; left time: 2.5633s
	iters: 200, epoch: 7 | loss: 0.3297405
	speed: 0.0024s/iter; left time: 0.7862s
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.2868 --> 0.2866).  Saving model state dict ...
Epoch: 7 cost time: 0.6631436347961426
Epoch: 7, Steps: 262 | Train Loss: 0.4580173 Vali Loss: 0.2866223 Best vali loss: 0.2866223
	iters: 100, epoch: 8 | loss: 0.2720267
	speed: 0.0062s/iter; left time: 1.0152s
	iters: 200, epoch: 8 | loss: 0.6749858
	speed: 0.0026s/iter; left time: 0.1623s
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.2866 --> 0.2865).  Saving model state dict ...
Epoch: 8 cost time: 0.7205476760864258
Epoch: 8, Steps: 262 | Train Loss: 0.4735062 Vali Loss: 0.2865294 Best vali loss: 0.2865294

best validation loss 0.28652935956946624

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 4, 'learning_rate': 0.0044405212972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0932232
	speed: 0.0102s/iter; left time: 41.6390s
	iters: 200, epoch: 1 | loss: 0.7799341
	speed: 0.0052s/iter; left time: 20.7094s
	iters: 300, epoch: 1 | loss: 0.3466038
	speed: 0.0053s/iter; left time: 20.5589s
	iters: 400, epoch: 1 | loss: 0.3635007
	speed: 0.0053s/iter; left time: 19.9933s
	iters: 500, epoch: 1 | loss: 0.7079662
	speed: 0.0052s/iter; left time: 19.2350s
Updating learning rate to 0.0044405212972
Validation loss decreased (inf --> 0.3304).  Saving model state dict ...
Epoch: 1 cost time: 2.9841272830963135
Epoch: 1, Steps: 523 | Train Loss: 0.6582456 Vali Loss: 0.3304429 Best vali loss: 0.3304429
	iters: 100, epoch: 2 | loss: 0.5703712
	speed: 0.0105s/iter; left time: 37.5688s
	iters: 200, epoch: 2 | loss: 0.2512618
	speed: 0.0046s/iter; left time: 15.8288s
	iters: 300, epoch: 2 | loss: 0.7939686
	speed: 0.0050s/iter; left time: 16.6898s
	iters: 400, epoch: 2 | loss: 0.8855597
	speed: 0.0050s/iter; left time: 16.2235s
	iters: 500, epoch: 2 | loss: 0.6143405
	speed: 0.0049s/iter; left time: 15.5656s
Updating learning rate to 0.0022202606486
Validation loss decreased (0.3304 --> 0.3233).  Saving model state dict ...
Epoch: 2 cost time: 2.6231181621551514
Epoch: 2, Steps: 523 | Train Loss: 0.6231004 Vali Loss: 0.3232841 Best vali loss: 0.3232841
	iters: 100, epoch: 3 | loss: 0.6883470
	speed: 0.0100s/iter; left time: 30.4557s
	iters: 200, epoch: 3 | loss: 0.6461840
	speed: 0.0046s/iter; left time: 13.4918s
	iters: 300, epoch: 3 | loss: 0.4288624
	speed: 0.0046s/iter; left time: 13.0582s
	iters: 400, epoch: 3 | loss: 0.7509242
	speed: 0.0046s/iter; left time: 12.4869s
	iters: 500, epoch: 3 | loss: 0.7619556
	speed: 0.0046s/iter; left time: 12.0539s
Updating learning rate to 0.0011101303243
Validation loss decreased (0.3233 --> 0.3219).  Saving model state dict ...
Epoch: 3 cost time: 2.436349868774414
Epoch: 3, Steps: 523 | Train Loss: 0.6552546 Vali Loss: 0.3218780 Best vali loss: 0.3218780

best validation loss 0.32187803862661446

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6505783
	speed: 0.0081s/iter; left time: 7.6582s
Updating learning rate to 0.0011205641286
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 0.6362195014953613
Epoch: 1, Steps: 131 | Train Loss: 0.6505783 Vali Loss: 0.2848924 Best vali loss: 0.2848924
	iters: 100, epoch: 2 | loss: 0.6562496
	speed: 0.0055s/iter; left time: 4.4787s
Updating learning rate to 0.0005602820643
Epoch: 2 cost time: 0.4227275848388672
Epoch: 2, Steps: 131 | Train Loss: 0.6562496 Vali Loss: 0.2890718 Best vali loss: 0.2848924
	iters: 100, epoch: 3 | loss: 0.5539501
	speed: 0.0053s/iter; left time: 3.6369s
Updating learning rate to 0.00028014103215
Validation loss decreased (0.2849 --> 0.2849).  Saving model state dict ...
Epoch: 3 cost time: 0.3983008861541748
Epoch: 3, Steps: 131 | Train Loss: 0.5539501 Vali Loss: 0.2848908 Best vali loss: 0.2848908

best validation loss 0.2848908392280928

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5152154
	speed: 0.0075s/iter; left time: 30.6071s
	iters: 200, epoch: 1 | loss: 0.3359861
	speed: 0.0025s/iter; left time: 10.0025s
	iters: 300, epoch: 1 | loss: 0.7705992
	speed: 0.0025s/iter; left time: 9.6779s
	iters: 400, epoch: 1 | loss: 1.0381320
	speed: 0.0024s/iter; left time: 9.2104s
	iters: 500, epoch: 1 | loss: 0.4800021
	speed: 0.0025s/iter; left time: 9.2006s
Updating learning rate to 0.0012523603238
Validation loss decreased (inf --> 0.2910).  Saving model state dict ...
Epoch: 1 cost time: 1.539433479309082
Epoch: 1, Steps: 523 | Train Loss: 0.6279870 Vali Loss: 0.2910148 Best vali loss: 0.2910148
	iters: 100, epoch: 2 | loss: 0.3853722
	speed: 0.0058s/iter; left time: 20.7951s
	iters: 200, epoch: 2 | loss: 0.4843412
	speed: 0.0024s/iter; left time: 8.3263s
	iters: 300, epoch: 2 | loss: 0.2564674
	speed: 0.0024s/iter; left time: 8.0661s
	iters: 400, epoch: 2 | loss: 0.4275474
	speed: 0.0024s/iter; left time: 7.8001s
	iters: 500, epoch: 2 | loss: 0.3864377
	speed: 0.0024s/iter; left time: 7.5664s
Updating learning rate to 0.0006261801619
Validation loss decreased (0.2910 --> 0.2872).  Saving model state dict ...
Epoch: 2 cost time: 1.2962532043457031
Epoch: 2, Steps: 523 | Train Loss: 0.3880332 Vali Loss: 0.2871634 Best vali loss: 0.2871634
	iters: 100, epoch: 3 | loss: 0.2151814
	speed: 0.0058s/iter; left time: 17.5619s
	iters: 200, epoch: 3 | loss: 0.7205762
	speed: 0.0024s/iter; left time: 7.0136s
	iters: 300, epoch: 3 | loss: 0.2316953
	speed: 0.0024s/iter; left time: 6.8149s
	iters: 400, epoch: 3 | loss: 0.4165618
	speed: 0.0024s/iter; left time: 6.4791s
	iters: 500, epoch: 3 | loss: 0.3045144
	speed: 0.0024s/iter; left time: 6.2916s
Updating learning rate to 0.00031309008095
Epoch: 3 cost time: 1.2806425094604492
Epoch: 3, Steps: 523 | Train Loss: 0.3777058 Vali Loss: 0.2911850 Best vali loss: 0.2871634

best validation loss 0.28716338270434927

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5879520
	speed: 0.0084s/iter; left time: 4.6482s
Updating learning rate to 0.000140070516075
Epoch: 4 cost time: 0.6592919826507568
Epoch: 4, Steps: 131 | Train Loss: 0.5879520 Vali Loss: 0.2868054 Best vali loss: 0.2848908
	iters: 100, epoch: 5 | loss: 0.5655777
	speed: 0.0055s/iter; left time: 2.3457s
Updating learning rate to 7.00352580375e-05
Epoch: 5 cost time: 0.4308452606201172
Epoch: 5, Steps: 131 | Train Loss: 0.5655777 Vali Loss: 0.2869661 Best vali loss: 0.2848908
	iters: 100, epoch: 6 | loss: 0.5496529
	speed: 0.0055s/iter; left time: 1.6201s
Updating learning rate to 3.501762901875e-05
Epoch: 6 cost time: 0.42032861709594727
Epoch: 6, Steps: 131 | Train Loss: 0.5496529 Vali Loss: 0.2866755 Best vali loss: 0.2848908
	iters: 100, epoch: 7 | loss: 0.4365533
	speed: 0.0054s/iter; left time: 0.8772s
Updating learning rate to 1.7508814509375e-05
Epoch: 7 cost time: 0.42003297805786133
Epoch: 7, Steps: 131 | Train Loss: 0.4365533 Vali Loss: 0.2873289 Best vali loss: 0.2848908
	iters: 100, epoch: 8 | loss: 0.4425633
	speed: 0.0055s/iter; left time: 0.1762s
Updating learning rate to 8.7544072546875e-06
Epoch: 8 cost time: 0.41665029525756836
Epoch: 8, Steps: 131 | Train Loss: 0.4425633 Vali Loss: 0.2868880 Best vali loss: 0.2848908

best validation loss 0.2848908392280928

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0054864235978, 'e_layers': 2, 'learning_rate': 0.0004151106276, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.1164917
	speed: 0.0081s/iter; left time: 67.0331s
	iters: 200, epoch: 1 | loss: 0.4378722
	speed: 0.0030s/iter; left time: 24.3141s
	iters: 300, epoch: 1 | loss: 0.3806042
	speed: 0.0030s/iter; left time: 24.1024s
	iters: 400, epoch: 1 | loss: 1.5030754
	speed: 0.0030s/iter; left time: 23.7128s
	iters: 500, epoch: 1 | loss: 0.3214244
	speed: 0.0030s/iter; left time: 23.1914s
	iters: 600, epoch: 1 | loss: 0.3152193
	speed: 0.0030s/iter; left time: 23.2342s
	iters: 700, epoch: 1 | loss: 0.1606923
	speed: 0.0030s/iter; left time: 22.8049s
	iters: 800, epoch: 1 | loss: 0.4094861
	speed: 0.0030s/iter; left time: 22.4967s
	iters: 900, epoch: 1 | loss: 0.3197676
	speed: 0.0029s/iter; left time: 21.4886s
	iters: 1000, epoch: 1 | loss: 0.5782301
	speed: 0.0029s/iter; left time: 21.2743s
Updating learning rate to 0.0004151106276
Validation loss decreased (inf --> 0.3071).  Saving model state dict ...
Epoch: 1 cost time: 3.346412181854248
Epoch: 1, Steps: 1045 | Train Loss: 0.4542863 Vali Loss: 0.3070690 Best vali loss: 0.3070690
	iters: 100, epoch: 2 | loss: 0.5159362
	speed: 0.0103s/iter; left time: 74.1452s
	iters: 200, epoch: 2 | loss: 0.3689380
	speed: 0.0033s/iter; left time: 23.7977s
	iters: 300, epoch: 2 | loss: 0.1977277
	speed: 0.0034s/iter; left time: 23.5737s
	iters: 400, epoch: 2 | loss: 0.4019873
	speed: 0.0034s/iter; left time: 23.2752s
	iters: 500, epoch: 2 | loss: 0.2710948
	speed: 0.0033s/iter; left time: 22.8017s
	iters: 600, epoch: 2 | loss: 1.1107684
	speed: 0.0034s/iter; left time: 22.5315s
	iters: 700, epoch: 2 | loss: 0.7365414
	speed: 0.0033s/iter; left time: 22.0038s
	iters: 800, epoch: 2 | loss: 0.3580300
	speed: 0.0033s/iter; left time: 21.7729s
	iters: 900, epoch: 2 | loss: 0.4004391
	speed: 0.0033s/iter; left time: 21.3432s
	iters: 1000, epoch: 2 | loss: 0.2234835
	speed: 0.0033s/iter; left time: 21.0703s
Updating learning rate to 0.0002075553138
Validation loss decreased (0.3071 --> 0.2883).  Saving model state dict ...
Epoch: 2 cost time: 3.5405659675598145
Epoch: 2, Steps: 1045 | Train Loss: 0.4584946 Vali Loss: 0.2883302 Best vali loss: 0.2883302
	iters: 100, epoch: 3 | loss: 0.4255584
	speed: 0.0106s/iter; left time: 65.5409s
	iters: 200, epoch: 3 | loss: 0.1975017
	speed: 0.0034s/iter; left time: 20.7571s
	iters: 300, epoch: 3 | loss: 0.2436077
	speed: 0.0034s/iter; left time: 20.3557s
	iters: 400, epoch: 3 | loss: 0.9135308
	speed: 0.0034s/iter; left time: 19.9060s
	iters: 500, epoch: 3 | loss: 1.0060821
	speed: 0.0034s/iter; left time: 19.4274s
	iters: 600, epoch: 3 | loss: 0.2290005
	speed: 0.0034s/iter; left time: 19.1404s
	iters: 700, epoch: 3 | loss: 0.3522190
	speed: 0.0033s/iter; left time: 18.6454s
	iters: 800, epoch: 3 | loss: 0.1888125
	speed: 0.0030s/iter; left time: 16.5755s
	iters: 900, epoch: 3 | loss: 0.3526000
	speed: 0.0031s/iter; left time: 16.4436s
	iters: 1000, epoch: 3 | loss: 0.3258595
	speed: 0.0031s/iter; left time: 16.1287s
Updating learning rate to 0.0001037776569
Epoch: 3 cost time: 3.4589741230010986
Epoch: 3, Steps: 1045 | Train Loss: 0.4234772 Vali Loss: 0.2927595 Best vali loss: 0.2883302
	iters: 100, epoch: 4 | loss: 0.9190323
	speed: 0.0093s/iter; left time: 47.5773s
	iters: 200, epoch: 4 | loss: 0.1453480
	speed: 0.0029s/iter; left time: 14.4016s
	iters: 300, epoch: 4 | loss: 0.4999866
	speed: 0.0029s/iter; left time: 14.0486s
	iters: 400, epoch: 4 | loss: 0.2728360
	speed: 0.0029s/iter; left time: 13.8037s
	iters: 500, epoch: 4 | loss: 0.5563688
	speed: 0.0029s/iter; left time: 13.5395s
	iters: 600, epoch: 4 | loss: 0.2877133
	speed: 0.0028s/iter; left time: 13.1715s
	iters: 700, epoch: 4 | loss: 0.4004032
	speed: 0.0029s/iter; left time: 12.9336s
	iters: 800, epoch: 4 | loss: 0.3969453
	speed: 0.0029s/iter; left time: 12.6147s
	iters: 900, epoch: 4 | loss: 0.2578673
	speed: 0.0029s/iter; left time: 12.3590s
	iters: 1000, epoch: 4 | loss: 0.3428364
	speed: 0.0029s/iter; left time: 12.0676s
Updating learning rate to 5.188882845e-05
Epoch: 4 cost time: 3.0146684646606445
Epoch: 4, Steps: 1045 | Train Loss: 0.4079337 Vali Loss: 0.2997981 Best vali loss: 0.2883302
	iters: 100, epoch: 5 | loss: 0.2384496
	speed: 0.0091s/iter; left time: 37.1427s
	iters: 200, epoch: 5 | loss: 0.3403952
	speed: 0.0028s/iter; left time: 11.0696s
	iters: 300, epoch: 5 | loss: 0.3750699
	speed: 0.0028s/iter; left time: 10.8395s
	iters: 400, epoch: 5 | loss: 0.2698890
	speed: 0.0028s/iter; left time: 10.5883s
	iters: 500, epoch: 5 | loss: 0.2248288
	speed: 0.0028s/iter; left time: 10.2088s
	iters: 600, epoch: 5 | loss: 0.1541166
	speed: 0.0029s/iter; left time: 10.3732s
	iters: 700, epoch: 5 | loss: 0.4825428
	speed: 0.0029s/iter; left time: 10.2111s
	iters: 800, epoch: 5 | loss: 0.2128527
	speed: 0.0031s/iter; left time: 10.5604s
	iters: 900, epoch: 5 | loss: 0.2037361
	speed: 0.0032s/iter; left time: 10.3393s
	iters: 1000, epoch: 5 | loss: 0.2907946
	speed: 0.0032s/iter; left time: 10.0648s
Updating learning rate to 2.5944414225e-05
Epoch: 5 cost time: 3.0984585285186768
Epoch: 5, Steps: 1045 | Train Loss: 0.2792675 Vali Loss: 0.3095905 Best vali loss: 0.2883302
	iters: 100, epoch: 6 | loss: 0.3183430
	speed: 0.0099s/iter; left time: 30.0947s
	iters: 200, epoch: 6 | loss: 0.1335594
	speed: 0.0030s/iter; left time: 8.9517s
	iters: 300, epoch: 6 | loss: 0.2605435
	speed: 0.0031s/iter; left time: 8.8508s
	iters: 400, epoch: 6 | loss: 0.1805258
	speed: 0.0031s/iter; left time: 8.5267s
	iters: 500, epoch: 6 | loss: 0.1943340
	speed: 0.0031s/iter; left time: 8.1946s
	iters: 600, epoch: 6 | loss: 0.4598443
	speed: 0.0031s/iter; left time: 7.9029s
	iters: 700, epoch: 6 | loss: 0.2130012
	speed: 0.0032s/iter; left time: 7.6835s
	iters: 800, epoch: 6 | loss: 0.5382491
	speed: 0.0031s/iter; left time: 7.2163s
	iters: 900, epoch: 6 | loss: 0.1351024
	speed: 0.0031s/iter; left time: 7.0108s
	iters: 1000, epoch: 6 | loss: 0.3581587
	speed: 0.0031s/iter; left time: 6.6415s
Updating learning rate to 1.29722071125e-05
Epoch: 6 cost time: 3.283442497253418
Epoch: 6, Steps: 1045 | Train Loss: 0.2791661 Vali Loss: 0.3068701 Best vali loss: 0.2883302
	iters: 100, epoch: 7 | loss: 0.5391535
	speed: 0.0095s/iter; left time: 18.8414s
	iters: 200, epoch: 7 | loss: 0.1817361
	speed: 0.0029s/iter; left time: 5.5130s
	iters: 300, epoch: 7 | loss: 0.3653724
	speed: 0.0029s/iter; left time: 5.1319s
	iters: 400, epoch: 7 | loss: 0.1781102
	speed: 0.0029s/iter; left time: 4.8377s
	iters: 500, epoch: 7 | loss: 0.2340091
	speed: 0.0029s/iter; left time: 4.5829s
	iters: 600, epoch: 7 | loss: 0.1980322
	speed: 0.0029s/iter; left time: 4.3376s
	iters: 700, epoch: 7 | loss: 0.1680070
	speed: 0.0030s/iter; left time: 4.1104s
	iters: 800, epoch: 7 | loss: 0.1662575
	speed: 0.0031s/iter; left time: 4.0116s
	iters: 900, epoch: 7 | loss: 0.4953121
	speed: 0.0031s/iter; left time: 3.7195s
	iters: 1000, epoch: 7 | loss: 0.3443415
	speed: 0.0031s/iter; left time: 3.3934s
Updating learning rate to 6.48610355625e-06
Epoch: 7 cost time: 3.137356996536255
Epoch: 7, Steps: 1045 | Train Loss: 0.2870332 Vali Loss: 0.3103699 Best vali loss: 0.2883302
	iters: 100, epoch: 8 | loss: 0.4640198
	speed: 0.0095s/iter; left time: 8.9705s
	iters: 200, epoch: 8 | loss: 0.5102969
	speed: 0.0030s/iter; left time: 2.5464s
	iters: 300, epoch: 8 | loss: 0.1841785
	speed: 0.0031s/iter; left time: 2.2962s
	iters: 400, epoch: 8 | loss: 0.1265084
	speed: 0.0031s/iter; left time: 1.9756s
	iters: 500, epoch: 8 | loss: 0.3737256
	speed: 0.0031s/iter; left time: 1.6851s
	iters: 600, epoch: 8 | loss: 0.2916307
	speed: 0.0031s/iter; left time: 1.3804s
	iters: 700, epoch: 8 | loss: 0.3558784
	speed: 0.0031s/iter; left time: 1.0716s
	iters: 800, epoch: 8 | loss: 0.3820367
	speed: 0.0030s/iter; left time: 0.7428s
	iters: 900, epoch: 8 | loss: 0.1487345
	speed: 0.0029s/iter; left time: 0.4186s
	iters: 1000, epoch: 8 | loss: 0.8545209
	speed: 0.0029s/iter; left time: 0.1329s
Updating learning rate to 3.243051778125e-06
Epoch: 8 cost time: 3.1865031719207764
Epoch: 8, Steps: 1045 | Train Loss: 0.3691530 Vali Loss: 0.3114160 Best vali loss: 0.2883302

best validation loss 0.28833016625187485

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0110950398132, 'e_layers': 2, 'learning_rate': 6.89350093e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4000573
	speed: 0.0084s/iter; left time: 69.4850s
	iters: 200, epoch: 1 | loss: 0.4597061
	speed: 0.0034s/iter; left time: 27.8151s
	iters: 300, epoch: 1 | loss: 0.9791290
	speed: 0.0034s/iter; left time: 27.1839s
	iters: 400, epoch: 1 | loss: 0.7365360
	speed: 0.0033s/iter; left time: 26.4968s
	iters: 500, epoch: 1 | loss: 0.4512241
	speed: 0.0034s/iter; left time: 26.5230s
	iters: 600, epoch: 1 | loss: 0.5997143
	speed: 0.0034s/iter; left time: 26.3536s
	iters: 700, epoch: 1 | loss: 0.2452656
	speed: 0.0034s/iter; left time: 26.1493s
	iters: 800, epoch: 1 | loss: 1.1996512
	speed: 0.0032s/iter; left time: 24.5560s
	iters: 900, epoch: 1 | loss: 0.3412297
	speed: 0.0032s/iter; left time: 24.2403s
	iters: 1000, epoch: 1 | loss: 0.9584038
	speed: 0.0032s/iter; left time: 23.8233s
Updating learning rate to 6.89350093e-05
Validation loss decreased (inf --> 0.3087).  Saving model state dict ...
Epoch: 1 cost time: 3.7422637939453125
Epoch: 1, Steps: 1045 | Train Loss: 0.6370917 Vali Loss: 0.3086601 Best vali loss: 0.3086601
	iters: 100, epoch: 2 | loss: 0.4292940
	speed: 0.0098s/iter; left time: 70.9307s
	iters: 200, epoch: 2 | loss: 0.1908421
	speed: 0.0029s/iter; left time: 20.9479s
	iters: 300, epoch: 2 | loss: 0.3238473
	speed: 0.0029s/iter; left time: 20.4898s
	iters: 400, epoch: 2 | loss: 0.2760883
	speed: 0.0028s/iter; left time: 19.4106s
	iters: 500, epoch: 2 | loss: 0.2650540
	speed: 0.0028s/iter; left time: 19.2810s
	iters: 600, epoch: 2 | loss: 1.2604079
	speed: 0.0028s/iter; left time: 18.9146s
	iters: 700, epoch: 2 | loss: 0.2011404
	speed: 0.0028s/iter; left time: 18.5248s
	iters: 800, epoch: 2 | loss: 0.3311498
	speed: 0.0028s/iter; left time: 18.3019s
	iters: 900, epoch: 2 | loss: 0.5369173
	speed: 0.0028s/iter; left time: 18.0170s
	iters: 1000, epoch: 2 | loss: 0.7097751
	speed: 0.0028s/iter; left time: 17.8864s
Updating learning rate to 3.446750465e-05
Validation loss decreased (0.3087 --> 0.2937).  Saving model state dict ...
Epoch: 2 cost time: 3.026653528213501
Epoch: 2, Steps: 1045 | Train Loss: 0.4524516 Vali Loss: 0.2936804 Best vali loss: 0.2936804
	iters: 100, epoch: 3 | loss: 0.2506080
	speed: 0.0096s/iter; left time: 59.1741s
	iters: 200, epoch: 3 | loss: 0.5217054
	speed: 0.0030s/iter; left time: 18.1550s
	iters: 300, epoch: 3 | loss: 0.2779129
	speed: 0.0031s/iter; left time: 18.2863s
	iters: 400, epoch: 3 | loss: 1.5993274
	speed: 0.0031s/iter; left time: 18.0113s
	iters: 500, epoch: 3 | loss: 0.2650789
	speed: 0.0030s/iter; left time: 17.4328s
	iters: 600, epoch: 3 | loss: 0.7201763
	speed: 0.0030s/iter; left time: 17.0140s
	iters: 700, epoch: 3 | loss: 0.7311936
	speed: 0.0030s/iter; left time: 16.7652s
	iters: 800, epoch: 3 | loss: 1.9745934
	speed: 0.0030s/iter; left time: 16.3616s
	iters: 900, epoch: 3 | loss: 1.3054966
	speed: 0.0030s/iter; left time: 16.2144s
	iters: 1000, epoch: 3 | loss: 1.4525946
	speed: 0.0030s/iter; left time: 15.9239s
Updating learning rate to 1.7233752325e-05
Validation loss decreased (0.2937 --> 0.2889).  Saving model state dict ...
Epoch: 3 cost time: 3.190718173980713
Epoch: 3, Steps: 1045 | Train Loss: 0.9098687 Vali Loss: 0.2889015 Best vali loss: 0.2889015
	iters: 100, epoch: 4 | loss: 0.2288366
	speed: 0.0095s/iter; left time: 48.8928s
	iters: 200, epoch: 4 | loss: 1.5993965
	speed: 0.0030s/iter; left time: 15.2384s
	iters: 300, epoch: 4 | loss: 0.3845463
	speed: 0.0030s/iter; left time: 14.7702s
	iters: 400, epoch: 4 | loss: 0.3051461
	speed: 0.0030s/iter; left time: 14.5273s
	iters: 500, epoch: 4 | loss: 0.1653042
	speed: 0.0030s/iter; left time: 14.2269s
	iters: 600, epoch: 4 | loss: 0.6959655
	speed: 0.0030s/iter; left time: 13.9253s
	iters: 700, epoch: 4 | loss: 0.4052864
	speed: 0.0030s/iter; left time: 13.6590s
	iters: 800, epoch: 4 | loss: 0.6077611
	speed: 0.0030s/iter; left time: 13.3383s
	iters: 900, epoch: 4 | loss: 1.0622376
	speed: 0.0030s/iter; left time: 12.9344s
	iters: 1000, epoch: 4 | loss: 0.2868679
	speed: 0.0030s/iter; left time: 12.6708s
Updating learning rate to 8.6168761625e-06
Validation loss decreased (0.2889 --> 0.2872).  Saving model state dict ...
Epoch: 4 cost time: 3.18331241607666
Epoch: 4, Steps: 1045 | Train Loss: 0.5741348 Vali Loss: 0.2871927 Best vali loss: 0.2871927
	iters: 100, epoch: 5 | loss: 0.3475535
	speed: 0.0095s/iter; left time: 38.7036s
	iters: 200, epoch: 5 | loss: 1.2884070
	speed: 0.0029s/iter; left time: 11.5760s
	iters: 300, epoch: 5 | loss: 0.3450675
	speed: 0.0030s/iter; left time: 11.4799s
	iters: 400, epoch: 5 | loss: 0.4017353
	speed: 0.0030s/iter; left time: 11.2610s
	iters: 500, epoch: 5 | loss: 0.3177705
	speed: 0.0029s/iter; left time: 10.8204s
	iters: 600, epoch: 5 | loss: 1.3389176
	speed: 0.0030s/iter; left time: 10.7423s
	iters: 700, epoch: 5 | loss: 0.3431409
	speed: 0.0029s/iter; left time: 10.1330s
	iters: 800, epoch: 5 | loss: 0.5026443
	speed: 0.0030s/iter; left time: 10.1032s
	iters: 900, epoch: 5 | loss: 0.8869382
	speed: 0.0030s/iter; left time: 9.7520s
	iters: 1000, epoch: 5 | loss: 0.2765039
	speed: 0.0029s/iter; left time: 9.2080s
Updating learning rate to 4.30843808125e-06
Validation loss decreased (0.2872 --> 0.2866).  Saving model state dict ...
Epoch: 5 cost time: 3.112852096557617
Epoch: 5, Steps: 1045 | Train Loss: 0.6048679 Vali Loss: 0.2866091 Best vali loss: 0.2866091
	iters: 100, epoch: 6 | loss: 0.3711479
	speed: 0.0092s/iter; left time: 28.0817s
	iters: 200, epoch: 6 | loss: 1.1401740
	speed: 0.0028s/iter; left time: 8.2866s
	iters: 300, epoch: 6 | loss: 0.2995615
	speed: 0.0028s/iter; left time: 7.9595s
	iters: 400, epoch: 6 | loss: 0.2547211
	speed: 0.0028s/iter; left time: 7.6794s
	iters: 500, epoch: 6 | loss: 1.1126478
	speed: 0.0028s/iter; left time: 7.3753s
	iters: 600, epoch: 6 | loss: 0.5783859
	speed: 0.0028s/iter; left time: 7.1380s
	iters: 700, epoch: 6 | loss: 2.0783594
	speed: 0.0028s/iter; left time: 6.7653s
	iters: 800, epoch: 6 | loss: 0.5943475
	speed: 0.0028s/iter; left time: 6.5483s
	iters: 900, epoch: 6 | loss: 0.2616599
	speed: 0.0028s/iter; left time: 6.3123s
	iters: 1000, epoch: 6 | loss: 1.0424521
	speed: 0.0028s/iter; left time: 6.0410s
Updating learning rate to 2.154219040625e-06
Validation loss decreased (0.2866 --> 0.2863).  Saving model state dict ...
Epoch: 6 cost time: 2.9718356132507324
Epoch: 6, Steps: 1045 | Train Loss: 0.7733457 Vali Loss: 0.2863165 Best vali loss: 0.2863165
	iters: 100, epoch: 7 | loss: 1.7542998
	speed: 0.0094s/iter; left time: 18.8002s
	iters: 200, epoch: 7 | loss: 0.8290806
	speed: 0.0030s/iter; left time: 5.6671s
	iters: 300, epoch: 7 | loss: 1.2176566
	speed: 0.0030s/iter; left time: 5.4292s
	iters: 400, epoch: 7 | loss: 0.3033091
	speed: 0.0030s/iter; left time: 5.0989s
	iters: 500, epoch: 7 | loss: 0.2633410
	speed: 0.0030s/iter; left time: 4.7661s
	iters: 600, epoch: 7 | loss: 0.3410523
	speed: 0.0030s/iter; left time: 4.5000s
	iters: 700, epoch: 7 | loss: 0.4151676
	speed: 0.0030s/iter; left time: 4.2029s
	iters: 800, epoch: 7 | loss: 0.3414343
	speed: 0.0030s/iter; left time: 3.9228s
	iters: 900, epoch: 7 | loss: 0.4109801
	speed: 0.0030s/iter; left time: 3.5744s
	iters: 1000, epoch: 7 | loss: 0.1688303
	speed: 0.0030s/iter; left time: 3.2729s
Updating learning rate to 1.0771095203125e-06
Validation loss decreased (0.2863 --> 0.2862).  Saving model state dict ...
Epoch: 7 cost time: 3.183047294616699
Epoch: 7, Steps: 1045 | Train Loss: 0.6045152 Vali Loss: 0.2861622 Best vali loss: 0.2861622
	iters: 100, epoch: 8 | loss: 1.4059513
	speed: 0.0095s/iter; left time: 8.9490s
	iters: 200, epoch: 8 | loss: 1.0542643
	speed: 0.0029s/iter; left time: 2.4664s
	iters: 300, epoch: 8 | loss: 0.2864297
	speed: 0.0031s/iter; left time: 2.3000s
	iters: 400, epoch: 8 | loss: 0.3576843
	speed: 0.0031s/iter; left time: 2.0297s
	iters: 500, epoch: 8 | loss: 0.9850366
	speed: 0.0031s/iter; left time: 1.6714s
	iters: 600, epoch: 8 | loss: 0.4024495
	speed: 0.0030s/iter; left time: 1.3467s
	iters: 700, epoch: 8 | loss: 1.2224965
	speed: 0.0030s/iter; left time: 1.0407s
	iters: 800, epoch: 8 | loss: 0.3512469
	speed: 0.0030s/iter; left time: 0.7411s
	iters: 900, epoch: 8 | loss: 0.8472118
	speed: 0.0029s/iter; left time: 0.4210s
	iters: 1000, epoch: 8 | loss: 0.4206036
	speed: 0.0029s/iter; left time: 0.1315s
Updating learning rate to 5.3855476015625e-07
Validation loss decreased (0.2862 --> 0.2861).  Saving model state dict ...
Epoch: 8 cost time: 3.1496989727020264
Epoch: 8, Steps: 1045 | Train Loss: 0.7333375 Vali Loss: 0.2860930 Best vali loss: 0.2860930

best validation loss 0.2860929893711412

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.010989339883, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7009477
	speed: 0.0109s/iter; left time: 10.3248s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.3305).  Saving model state dict ...
Epoch: 1 cost time: 1.0177667140960693
Epoch: 1, Steps: 131 | Train Loss: 0.7009477 Vali Loss: 0.3305046 Best vali loss: 0.3305046
	iters: 100, epoch: 2 | loss: 0.5261424
	speed: 0.0088s/iter; left time: 7.1903s
Updating learning rate to 0.0019699025932
Validation loss decreased (0.3305 --> 0.3220).  Saving model state dict ...
Epoch: 2 cost time: 0.7031097412109375
Epoch: 2, Steps: 131 | Train Loss: 0.5261424 Vali Loss: 0.3219596 Best vali loss: 0.3219596
	iters: 100, epoch: 3 | loss: 0.4622701
	speed: 0.0090s/iter; left time: 6.1741s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 0.7696022987365723
Epoch: 3, Steps: 131 | Train Loss: 0.4622701 Vali Loss: 0.3254917 Best vali loss: 0.3219596

best validation loss 0.32195964787818987

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2862135
	speed: 0.0093s/iter; left time: 37.9495s
	iters: 200, epoch: 1 | loss: 0.4139252
	speed: 0.0040s/iter; left time: 15.9428s
	iters: 300, epoch: 1 | loss: 0.8694890
	speed: 0.0040s/iter; left time: 15.6198s
	iters: 400, epoch: 1 | loss: 0.2230014
	speed: 0.0040s/iter; left time: 15.3094s
	iters: 500, epoch: 1 | loss: 0.2949321
	speed: 0.0044s/iter; left time: 16.2752s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.2887).  Saving model state dict ...
Epoch: 1 cost time: 2.4152324199676514
Epoch: 1, Steps: 523 | Train Loss: 0.4175122 Vali Loss: 0.2886727 Best vali loss: 0.2886727
	iters: 100, epoch: 2 | loss: 0.5136673
	speed: 0.0088s/iter; left time: 31.2996s
	iters: 200, epoch: 2 | loss: 0.2142774
	speed: 0.0042s/iter; left time: 14.5612s
	iters: 300, epoch: 2 | loss: 0.4590653
	speed: 0.0041s/iter; left time: 13.9275s
	iters: 400, epoch: 2 | loss: 0.7363945
	speed: 0.0043s/iter; left time: 13.8866s
	iters: 500, epoch: 2 | loss: 0.3147019
	speed: 0.0043s/iter; left time: 13.5508s
Updating learning rate to 0.000552421030539641
Epoch: 2 cost time: 2.2361574172973633
Epoch: 2, Steps: 523 | Train Loss: 0.4476213 Vali Loss: 0.2940342 Best vali loss: 0.2886727
	iters: 100, epoch: 3 | loss: 0.5572708
	speed: 0.0086s/iter; left time: 26.0546s
	iters: 200, epoch: 3 | loss: 0.6806183
	speed: 0.0040s/iter; left time: 11.6171s
	iters: 300, epoch: 3 | loss: 0.1883643
	speed: 0.0040s/iter; left time: 11.4413s
	iters: 400, epoch: 3 | loss: 0.4686127
	speed: 0.0040s/iter; left time: 10.9713s
	iters: 500, epoch: 3 | loss: 0.4772726
	speed: 0.0040s/iter; left time: 10.5911s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.2887 --> 0.2855).  Saving model state dict ...
Epoch: 3 cost time: 2.156017780303955
Epoch: 3, Steps: 523 | Train Loss: 0.4744277 Vali Loss: 0.2855204 Best vali loss: 0.2855204

best validation loss 0.2855203826660647

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2272484
	speed: 0.0076s/iter; left time: 31.2377s
	iters: 200, epoch: 1 | loss: 0.3259809
	speed: 0.0025s/iter; left time: 9.7743s
	iters: 300, epoch: 1 | loss: 0.2671383
	speed: 0.0024s/iter; left time: 9.4223s
	iters: 400, epoch: 1 | loss: 0.6833624
	speed: 0.0025s/iter; left time: 9.3236s
	iters: 500, epoch: 1 | loss: 0.2622509
	speed: 0.0025s/iter; left time: 9.0339s
Updating learning rate to 0.0005012943918
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 1.5374739170074463
Epoch: 1, Steps: 523 | Train Loss: 0.3531962 Vali Loss: 0.2839279 Best vali loss: 0.2839279
	iters: 100, epoch: 2 | loss: 0.2452160
	speed: 0.0058s/iter; left time: 20.6383s
	iters: 200, epoch: 2 | loss: 0.7240261
	speed: 0.0022s/iter; left time: 7.7180s
	iters: 300, epoch: 2 | loss: 1.0426387
	speed: 0.0022s/iter; left time: 7.4863s
	iters: 400, epoch: 2 | loss: 0.6421782
	speed: 0.0022s/iter; left time: 7.2779s
	iters: 500, epoch: 2 | loss: 0.3745243
	speed: 0.0022s/iter; left time: 7.0468s
Updating learning rate to 0.0002506471959
Validation loss decreased (0.2839 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 1.2283086776733398
Epoch: 2, Steps: 523 | Train Loss: 0.6057167 Vali Loss: 0.2833517 Best vali loss: 0.2833517
	iters: 100, epoch: 3 | loss: 0.2120369
	speed: 0.0057s/iter; left time: 17.3886s
	iters: 200, epoch: 3 | loss: 0.3103790
	speed: 0.0025s/iter; left time: 7.2314s
	iters: 300, epoch: 3 | loss: 0.9708488
	speed: 0.0024s/iter; left time: 6.9375s
	iters: 400, epoch: 3 | loss: 0.4352008
	speed: 0.0025s/iter; left time: 6.7533s
	iters: 500, epoch: 3 | loss: 0.3759343
	speed: 0.0025s/iter; left time: 6.5026s
Updating learning rate to 0.00012532359795
Epoch: 3 cost time: 1.322173833847046
Epoch: 3, Steps: 523 | Train Loss: 0.4608800 Vali Loss: 0.2886030 Best vali loss: 0.2833517

best validation loss 0.28335171486862354

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2116518
	speed: 0.0075s/iter; left time: 18.7692s
	iters: 200, epoch: 4 | loss: 0.2935528
	speed: 0.0024s/iter; left time: 5.8990s
	iters: 300, epoch: 4 | loss: 0.2306017
	speed: 0.0024s/iter; left time: 5.6091s
	iters: 400, epoch: 4 | loss: 0.6293561
	speed: 0.0024s/iter; left time: 5.2909s
	iters: 500, epoch: 4 | loss: 0.2500339
	speed: 0.0024s/iter; left time: 5.0936s
Updating learning rate to 6.2661798975e-05
Epoch: 4 cost time: 1.517146348953247
Epoch: 4, Steps: 523 | Train Loss: 0.3230393 Vali Loss: 0.2885573 Best vali loss: 0.2833517
	iters: 100, epoch: 5 | loss: 0.2469180
	speed: 0.0058s/iter; left time: 11.5649s
	iters: 200, epoch: 5 | loss: 0.6929566
	speed: 0.0025s/iter; left time: 4.6487s
	iters: 300, epoch: 5 | loss: 0.9691259
	speed: 0.0025s/iter; left time: 4.4824s
	iters: 400, epoch: 5 | loss: 0.6293953
	speed: 0.0025s/iter; left time: 4.2320s
	iters: 500, epoch: 5 | loss: 0.3644807
	speed: 0.0025s/iter; left time: 3.9648s
Updating learning rate to 3.13308994875e-05
Epoch: 5 cost time: 1.336043357849121
Epoch: 5, Steps: 523 | Train Loss: 0.5805753 Vali Loss: 0.2886230 Best vali loss: 0.2833517
	iters: 100, epoch: 6 | loss: 0.1905584
	speed: 0.0056s/iter; left time: 8.2941s
	iters: 200, epoch: 6 | loss: 0.2988874
	speed: 0.0024s/iter; left time: 3.2946s
	iters: 300, epoch: 6 | loss: 0.9584802
	speed: 0.0024s/iter; left time: 3.0541s
	iters: 400, epoch: 6 | loss: 0.4249175
	speed: 0.0025s/iter; left time: 2.8962s
	iters: 500, epoch: 6 | loss: 0.3806442
	speed: 0.0023s/iter; left time: 2.4686s
Updating learning rate to 1.566544974375e-05
Epoch: 6 cost time: 1.2846307754516602
Epoch: 6, Steps: 523 | Train Loss: 0.4506976 Vali Loss: 0.2897718 Best vali loss: 0.2833517
	iters: 100, epoch: 7 | loss: 0.2873043
	speed: 0.0057s/iter; left time: 5.4405s
	iters: 200, epoch: 7 | loss: 0.2889289
	speed: 0.0023s/iter; left time: 1.9503s
	iters: 300, epoch: 7 | loss: 0.1885675
	speed: 0.0023s/iter; left time: 1.7279s
	iters: 400, epoch: 7 | loss: 0.3924125
	speed: 0.0024s/iter; left time: 1.5430s
	iters: 500, epoch: 7 | loss: 1.0562952
	speed: 0.0023s/iter; left time: 1.2529s
Updating learning rate to 7.832724871875e-06
Epoch: 7 cost time: 1.2477750778198242
Epoch: 7, Steps: 523 | Train Loss: 0.4427017 Vali Loss: 0.2901091 Best vali loss: 0.2833517
	iters: 100, epoch: 8 | loss: 0.2556635
	speed: 0.0055s/iter; left time: 2.3531s
	iters: 200, epoch: 8 | loss: 0.4392462
	speed: 0.0023s/iter; left time: 0.7353s
	iters: 300, epoch: 8 | loss: 0.7065818
	speed: 0.0022s/iter; left time: 0.4976s
	iters: 400, epoch: 8 | loss: 1.4210014
	speed: 0.0022s/iter; left time: 0.2725s
	iters: 500, epoch: 8 | loss: 0.4206780
	speed: 0.0022s/iter; left time: 0.0531s
Updating learning rate to 3.9163624359375e-06
Epoch: 8 cost time: 1.201906681060791
Epoch: 8, Steps: 523 | Train Loss: 0.6486342 Vali Loss: 0.2899736 Best vali loss: 0.2833517

best validation loss 0.28335171486862354

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 3, 'learning_rate': 5.08199726e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3264087
	speed: 0.0093s/iter; left time: 76.6053s
	iters: 200, epoch: 1 | loss: 0.4821692
	speed: 0.0040s/iter; left time: 32.6532s
	iters: 300, epoch: 1 | loss: 0.3277068
	speed: 0.0040s/iter; left time: 32.0139s
	iters: 400, epoch: 1 | loss: 1.2024816
	speed: 0.0040s/iter; left time: 31.4796s
	iters: 500, epoch: 1 | loss: 0.7334218
	speed: 0.0040s/iter; left time: 31.0522s
	iters: 600, epoch: 1 | loss: 0.3456076
	speed: 0.0040s/iter; left time: 31.2066s
	iters: 700, epoch: 1 | loss: 0.3982716
	speed: 0.0040s/iter; left time: 30.7425s
	iters: 800, epoch: 1 | loss: 0.4132997
	speed: 0.0042s/iter; left time: 31.8641s
	iters: 900, epoch: 1 | loss: 0.6786286
	speed: 0.0041s/iter; left time: 30.4014s
	iters: 1000, epoch: 1 | loss: 0.3404441
	speed: 0.0041s/iter; left time: 30.0601s
Updating learning rate to 4.88857525639622e-05
Validation loss decreased (inf --> 0.2966).  Saving model state dict ...
Epoch: 1 cost time: 4.482230186462402
Epoch: 1, Steps: 1045 | Train Loss: 0.5248440 Vali Loss: 0.2966451 Best vali loss: 0.2966451
	iters: 100, epoch: 2 | loss: 2.4092498
	speed: 0.0118s/iter; left time: 85.0651s
	iters: 200, epoch: 2 | loss: 0.2233122
	speed: 0.0040s/iter; left time: 28.8046s
	iters: 300, epoch: 2 | loss: 0.2789060
	speed: 0.0041s/iter; left time: 28.4152s
	iters: 400, epoch: 2 | loss: 0.5216203
	speed: 0.0040s/iter; left time: 27.9424s
	iters: 500, epoch: 2 | loss: 0.2773442
	speed: 0.0040s/iter; left time: 27.3910s
	iters: 600, epoch: 2 | loss: 0.2984762
	speed: 0.0040s/iter; left time: 26.8633s
	iters: 700, epoch: 2 | loss: 0.3772688
	speed: 0.0040s/iter; left time: 26.7519s
	iters: 800, epoch: 2 | loss: 0.2224875
	speed: 0.0041s/iter; left time: 26.6970s
	iters: 900, epoch: 2 | loss: 0.2900699
	speed: 0.0040s/iter; left time: 25.9492s
	iters: 1000, epoch: 2 | loss: 0.3541331
	speed: 0.0040s/iter; left time: 25.4444s
Updating learning rate to 4.337755992258727e-05
Validation loss decreased (0.2966 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 4.256906747817993
Epoch: 2, Steps: 1045 | Train Loss: 0.5252868 Vali Loss: 0.2849532 Best vali loss: 0.2849532
	iters: 100, epoch: 3 | loss: 0.4704476
	speed: 0.0117s/iter; left time: 72.1005s
	iters: 200, epoch: 3 | loss: 0.2047123
	speed: 0.0040s/iter; left time: 24.0211s
	iters: 300, epoch: 3 | loss: 0.1800563
	speed: 0.0040s/iter; left time: 23.6045s
	iters: 400, epoch: 3 | loss: 0.3452442
	speed: 0.0039s/iter; left time: 22.9108s
	iters: 500, epoch: 3 | loss: 0.2044309
	speed: 0.0038s/iter; left time: 22.1592s
	iters: 600, epoch: 3 | loss: 0.2018742
	speed: 0.0037s/iter; left time: 21.1340s
	iters: 700, epoch: 3 | loss: 0.4969272
	speed: 0.0035s/iter; left time: 19.7468s
	iters: 800, epoch: 3 | loss: 0.8701007
	speed: 0.0036s/iter; left time: 19.4818s
	iters: 900, epoch: 3 | loss: 0.3110625
	speed: 0.0036s/iter; left time: 19.0847s
	iters: 1000, epoch: 3 | loss: 0.2595445
	speed: 0.0036s/iter; left time: 18.8518s
Updating learning rate to 3.5133967073633905e-05
Validation loss decreased (0.2850 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 3.9737229347229004
Epoch: 3, Steps: 1045 | Train Loss: 0.3544400 Vali Loss: 0.2839190 Best vali loss: 0.2839190
	iters: 100, epoch: 4 | loss: 0.5281814
	speed: 0.0116s/iter; left time: 59.5129s
	iters: 200, epoch: 4 | loss: 0.2173545
	speed: 0.0039s/iter; left time: 19.7464s
	iters: 300, epoch: 4 | loss: 1.4135082
	speed: 0.0039s/iter; left time: 19.4044s
	iters: 400, epoch: 4 | loss: 0.1847994
	speed: 0.0039s/iter; left time: 18.9736s
	iters: 500, epoch: 4 | loss: 0.5988472
	speed: 0.0042s/iter; left time: 19.6133s
	iters: 600, epoch: 4 | loss: 1.3581016
	speed: 0.0041s/iter; left time: 19.0012s
	iters: 700, epoch: 4 | loss: 1.3012272
	speed: 0.0042s/iter; left time: 18.8772s
	iters: 800, epoch: 4 | loss: 0.9816980
	speed: 0.0041s/iter; left time: 18.2219s
	iters: 900, epoch: 4 | loss: 1.1674020
	speed: 0.0041s/iter; left time: 17.8978s
	iters: 1000, epoch: 4 | loss: 0.2733285
	speed: 0.0042s/iter; left time: 17.7148s
Updating learning rate to 2.54099863e-05
Validation loss decreased (0.2839 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 4.297046422958374
Epoch: 4, Steps: 1045 | Train Loss: 0.8024448 Vali Loss: 0.2818480 Best vali loss: 0.2818480
	iters: 100, epoch: 5 | loss: 0.1746610
	speed: 0.0121s/iter; left time: 49.4656s
	iters: 200, epoch: 5 | loss: 0.3455318
	speed: 0.0040s/iter; left time: 16.1058s
	iters: 300, epoch: 5 | loss: 0.2130435
	speed: 0.0040s/iter; left time: 15.5238s
	iters: 400, epoch: 5 | loss: 0.4450676
	speed: 0.0040s/iter; left time: 15.1247s
	iters: 500, epoch: 5 | loss: 0.3000178
	speed: 0.0040s/iter; left time: 14.7246s
	iters: 600, epoch: 5 | loss: 0.4740970
	speed: 0.0040s/iter; left time: 14.3223s
	iters: 700, epoch: 5 | loss: 0.4056110
	speed: 0.0040s/iter; left time: 13.8887s
	iters: 800, epoch: 5 | loss: 0.1900842
	speed: 0.0040s/iter; left time: 13.5521s
	iters: 900, epoch: 5 | loss: 0.2373085
	speed: 0.0040s/iter; left time: 13.0640s
	iters: 1000, epoch: 5 | loss: 0.3624775
	speed: 0.0040s/iter; left time: 12.7176s
Updating learning rate to 1.5686005526366093e-05
Validation loss decreased (0.2818 --> 0.2814).  Saving model state dict ...
Epoch: 5 cost time: 4.235028028488159
Epoch: 5, Steps: 1045 | Train Loss: 0.3147900 Vali Loss: 0.2813626 Best vali loss: 0.2813626
	iters: 100, epoch: 6 | loss: 1.0448486
	speed: 0.0118s/iter; left time: 35.8343s
	iters: 200, epoch: 6 | loss: 0.5570789
	speed: 0.0040s/iter; left time: 11.7431s
	iters: 300, epoch: 6 | loss: 0.2240174
	speed: 0.0040s/iter; left time: 11.3412s
	iters: 400, epoch: 6 | loss: 0.3198529
	speed: 0.0040s/iter; left time: 10.8738s
	iters: 500, epoch: 6 | loss: 0.5156035
	speed: 0.0040s/iter; left time: 10.5695s
	iters: 600, epoch: 6 | loss: 0.7727221
	speed: 0.0040s/iter; left time: 10.1238s
	iters: 700, epoch: 6 | loss: 0.4574001
	speed: 0.0040s/iter; left time: 9.7434s
	iters: 800, epoch: 6 | loss: 0.4317290
	speed: 0.0040s/iter; left time: 9.3406s
	iters: 900, epoch: 6 | loss: 0.2592729
	speed: 0.0040s/iter; left time: 8.9414s
	iters: 1000, epoch: 6 | loss: 0.9346507
	speed: 0.0040s/iter; left time: 8.5404s
Updating learning rate to 7.442412677412731e-06
Epoch: 6 cost time: 4.210702180862427
Epoch: 6, Steps: 1045 | Train Loss: 0.5517176 Vali Loss: 0.2818221 Best vali loss: 0.2813626
	iters: 100, epoch: 7 | loss: 0.2771932
	speed: 0.0116s/iter; left time: 23.1484s
	iters: 200, epoch: 7 | loss: 0.1775034
	speed: 0.0042s/iter; left time: 8.0223s
	iters: 300, epoch: 7 | loss: 0.2346907
	speed: 0.0037s/iter; left time: 6.6768s
	iters: 400, epoch: 7 | loss: 0.9901435
	speed: 0.0038s/iter; left time: 6.4820s
	iters: 500, epoch: 7 | loss: 0.5572292
	speed: 0.0040s/iter; left time: 6.3637s
	iters: 600, epoch: 7 | loss: 0.2152328
	speed: 0.0038s/iter; left time: 5.7205s
	iters: 700, epoch: 7 | loss: 1.1377922
	speed: 0.0035s/iter; left time: 4.9222s
	iters: 800, epoch: 7 | loss: 0.3206489
	speed: 0.0039s/iter; left time: 5.0275s
	iters: 900, epoch: 7 | loss: 0.4082321
	speed: 0.0039s/iter; left time: 4.6580s
	iters: 1000, epoch: 7 | loss: 0.5696617
	speed: 0.0037s/iter; left time: 3.9836s
Updating learning rate to 1.934220036037799e-06
Epoch: 7 cost time: 4.049457788467407
Epoch: 7, Steps: 1045 | Train Loss: 0.4888328 Vali Loss: 0.2817849 Best vali loss: 0.2813626
	iters: 100, epoch: 8 | loss: 0.5829974
	speed: 0.0109s/iter; left time: 10.2944s
	iters: 200, epoch: 8 | loss: 0.4175608
	speed: 0.0035s/iter; left time: 2.9684s
	iters: 300, epoch: 8 | loss: 0.4897901
	speed: 0.0035s/iter; left time: 2.6093s
	iters: 400, epoch: 8 | loss: 0.4635330
	speed: 0.0035s/iter; left time: 2.2584s
	iters: 500, epoch: 8 | loss: 0.6840012
	speed: 0.0035s/iter; left time: 1.9131s
	iters: 600, epoch: 8 | loss: 1.2544291
	speed: 0.0036s/iter; left time: 1.5953s
	iters: 700, epoch: 8 | loss: 0.3170882
	speed: 0.0038s/iter; left time: 1.2992s
	iters: 800, epoch: 8 | loss: 0.4530690
	speed: 0.0040s/iter; left time: 0.9820s
	iters: 900, epoch: 8 | loss: 0.2217785
	speed: 0.0040s/iter; left time: 0.5781s
	iters: 1000, epoch: 8 | loss: 0.3404788
	speed: 0.0039s/iter; left time: 0.1776s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8824920654296875
Epoch: 8, Steps: 1045 | Train Loss: 0.5224726 Vali Loss: 0.2818029 Best vali loss: 0.2813626

best validation loss 0.2813625810435821

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0089588480994, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2868930
	speed: 0.0094s/iter; left time: 77.8009s
	iters: 200, epoch: 1 | loss: 0.1756700
	speed: 0.0043s/iter; left time: 35.4214s
	iters: 300, epoch: 1 | loss: 0.5092317
	speed: 0.0044s/iter; left time: 35.1214s
	iters: 400, epoch: 1 | loss: 0.3948140
	speed: 0.0044s/iter; left time: 35.1255s
	iters: 500, epoch: 1 | loss: 0.9435556
	speed: 0.0044s/iter; left time: 34.6744s
	iters: 600, epoch: 1 | loss: 0.3285001
	speed: 0.0043s/iter; left time: 33.5760s
	iters: 700, epoch: 1 | loss: 0.3850573
	speed: 0.0042s/iter; left time: 32.5557s
	iters: 800, epoch: 1 | loss: 0.5369502
	speed: 0.0043s/iter; left time: 32.6539s
	iters: 900, epoch: 1 | loss: 0.3907438
	speed: 0.0043s/iter; left time: 31.8910s
	iters: 1000, epoch: 1 | loss: 0.2680616
	speed: 0.0042s/iter; left time: 30.8585s
Updating learning rate to 0.00044044934731141274
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 4.759961128234863
Epoch: 1, Steps: 1045 | Train Loss: 0.4219477 Vali Loss: 0.2816675 Best vali loss: 0.2816675
	iters: 100, epoch: 2 | loss: 0.3280650
	speed: 0.0120s/iter; left time: 86.8008s
	iters: 200, epoch: 2 | loss: 0.3124925
	speed: 0.0042s/iter; left time: 29.7561s
	iters: 300, epoch: 2 | loss: 0.1573712
	speed: 0.0042s/iter; left time: 29.7817s
	iters: 400, epoch: 2 | loss: 1.1335055
	speed: 0.0041s/iter; left time: 28.2120s
	iters: 500, epoch: 2 | loss: 0.2069273
	speed: 0.0042s/iter; left time: 28.6298s
	iters: 600, epoch: 2 | loss: 0.3463549
	speed: 0.0042s/iter; left time: 28.5183s
	iters: 700, epoch: 2 | loss: 0.3292434
	speed: 0.0042s/iter; left time: 27.8867s
	iters: 800, epoch: 2 | loss: 0.1774400
	speed: 0.0041s/iter; left time: 26.8635s
	iters: 900, epoch: 2 | loss: 0.1648528
	speed: 0.0041s/iter; left time: 26.4751s
	iters: 1000, epoch: 2 | loss: 0.3272136
	speed: 0.0041s/iter; left time: 26.0889s
Updating learning rate to 0.0003908218029551133
Epoch: 2 cost time: 4.4073874950408936
Epoch: 2, Steps: 1045 | Train Loss: 0.3483466 Vali Loss: 0.2880119 Best vali loss: 0.2816675
	iters: 100, epoch: 3 | loss: 0.4034555
	speed: 0.0120s/iter; left time: 74.0687s
	iters: 200, epoch: 3 | loss: 0.2054446
	speed: 0.0042s/iter; left time: 25.7901s
	iters: 300, epoch: 3 | loss: 0.3566394
	speed: 0.0042s/iter; left time: 25.1608s
	iters: 400, epoch: 3 | loss: 0.2945747
	speed: 0.0042s/iter; left time: 24.6316s
	iters: 500, epoch: 3 | loss: 0.2802877
	speed: 0.0042s/iter; left time: 24.2993s
	iters: 600, epoch: 3 | loss: 0.1515927
	speed: 0.0042s/iter; left time: 23.9348s
	iters: 700, epoch: 3 | loss: 1.0316397
	speed: 0.0042s/iter; left time: 23.5073s
	iters: 800, epoch: 3 | loss: 0.3745587
	speed: 0.0038s/iter; left time: 21.0252s
	iters: 900, epoch: 3 | loss: 0.2764741
	speed: 0.0036s/iter; left time: 19.4649s
	iters: 1000, epoch: 3 | loss: 0.3025043
	speed: 0.0037s/iter; left time: 19.5598s
Updating learning rate to 0.00031654893408453833
Validation loss decreased (0.2817 --> 0.2809).  Saving model state dict ...
Epoch: 3 cost time: 4.281839609146118
Epoch: 3, Steps: 1045 | Train Loss: 0.3677171 Vali Loss: 0.2809327 Best vali loss: 0.2809327
	iters: 100, epoch: 4 | loss: 0.5698649
	speed: 0.0114s/iter; left time: 58.4429s
	iters: 200, epoch: 4 | loss: 0.9002399
	speed: 0.0036s/iter; left time: 18.1323s
	iters: 300, epoch: 4 | loss: 0.7663080
	speed: 0.0036s/iter; left time: 17.7591s
	iters: 400, epoch: 4 | loss: 0.5594404
	speed: 0.0037s/iter; left time: 17.6605s
	iters: 500, epoch: 4 | loss: 0.4557014
	speed: 0.0036s/iter; left time: 17.0529s
	iters: 600, epoch: 4 | loss: 0.1407587
	speed: 0.0036s/iter; left time: 16.6302s
	iters: 700, epoch: 4 | loss: 0.3969277
	speed: 0.0037s/iter; left time: 16.7255s
	iters: 800, epoch: 4 | loss: 0.2051536
	speed: 0.0036s/iter; left time: 16.0657s
	iters: 900, epoch: 4 | loss: 0.2531027
	speed: 0.0036s/iter; left time: 15.7596s
	iters: 1000, epoch: 4 | loss: 0.5547119
	speed: 0.0039s/iter; left time: 16.4100s
Updating learning rate to 0.0002289381117
Epoch: 4 cost time: 3.8696975708007812
Epoch: 4, Steps: 1045 | Train Loss: 0.4802209 Vali Loss: 0.2936291 Best vali loss: 0.2809327
	iters: 100, epoch: 5 | loss: 0.1638934
	speed: 0.0114s/iter; left time: 46.6448s
	iters: 200, epoch: 5 | loss: 0.8387800
	speed: 0.0037s/iter; left time: 14.5364s
	iters: 300, epoch: 5 | loss: 0.2922580
	speed: 0.0037s/iter; left time: 14.2074s
	iters: 400, epoch: 5 | loss: 0.2970721
	speed: 0.0037s/iter; left time: 13.9586s
	iters: 500, epoch: 5 | loss: 0.4229407
	speed: 0.0036s/iter; left time: 13.4302s
	iters: 600, epoch: 5 | loss: 0.5523142
	speed: 0.0037s/iter; left time: 13.0861s
	iters: 700, epoch: 5 | loss: 0.2404854
	speed: 0.0037s/iter; left time: 12.8071s
	iters: 800, epoch: 5 | loss: 0.2663198
	speed: 0.0037s/iter; left time: 12.4600s
	iters: 900, epoch: 5 | loss: 0.1730881
	speed: 0.0037s/iter; left time: 12.0262s
	iters: 1000, epoch: 5 | loss: 0.2049704
	speed: 0.0037s/iter; left time: 11.7034s
Updating learning rate to 0.0001413272893154617
Epoch: 5 cost time: 3.8718981742858887
Epoch: 5, Steps: 1045 | Train Loss: 0.3452122 Vali Loss: 0.2885718 Best vali loss: 0.2809327
	iters: 100, epoch: 6 | loss: 0.5159728
	speed: 0.0119s/iter; left time: 36.0456s
	iters: 200, epoch: 6 | loss: 0.2951486
	speed: 0.0041s/iter; left time: 11.9259s
	iters: 300, epoch: 6 | loss: 0.4230640
	speed: 0.0041s/iter; left time: 11.5401s
	iters: 400, epoch: 6 | loss: 0.2176724
	speed: 0.0041s/iter; left time: 11.2372s
	iters: 500, epoch: 6 | loss: 0.2786897
	speed: 0.0041s/iter; left time: 10.7027s
	iters: 600, epoch: 6 | loss: 0.2377070
	speed: 0.0041s/iter; left time: 10.4584s
	iters: 700, epoch: 6 | loss: 0.3558413
	speed: 0.0042s/iter; left time: 10.1818s
	iters: 800, epoch: 6 | loss: 0.2750531
	speed: 0.0041s/iter; left time: 9.6738s
	iters: 900, epoch: 6 | loss: 0.5975583
	speed: 0.0042s/iter; left time: 9.4551s
	iters: 1000, epoch: 6 | loss: 1.0829977
	speed: 0.0042s/iter; left time: 9.0028s
Updating learning rate to 6.705442044488674e-05
Epoch: 6 cost time: 4.353469610214233
Epoch: 6, Steps: 1045 | Train Loss: 0.4279705 Vali Loss: 0.2986837 Best vali loss: 0.2809327
	iters: 100, epoch: 7 | loss: 0.2614470
	speed: 0.0118s/iter; left time: 23.5108s
	iters: 200, epoch: 7 | loss: 0.3149679
	speed: 0.0037s/iter; left time: 7.0195s
	iters: 300, epoch: 7 | loss: 0.2433814
	speed: 0.0037s/iter; left time: 6.6835s
	iters: 400, epoch: 7 | loss: 0.2083411
	speed: 0.0038s/iter; left time: 6.3578s
	iters: 500, epoch: 7 | loss: 0.2817648
	speed: 0.0040s/iter; left time: 6.3489s
	iters: 600, epoch: 7 | loss: 0.7691256
	speed: 0.0040s/iter; left time: 5.9224s
	iters: 700, epoch: 7 | loss: 0.1974550
	speed: 0.0040s/iter; left time: 5.4954s
	iters: 800, epoch: 7 | loss: 0.7621924
	speed: 0.0040s/iter; left time: 5.1285s
	iters: 900, epoch: 7 | loss: 0.3324108
	speed: 0.0040s/iter; left time: 4.7377s
	iters: 1000, epoch: 7 | loss: 0.2214897
	speed: 0.0040s/iter; left time: 4.3418s
Updating learning rate to 1.7426876088587254e-05
Epoch: 7 cost time: 4.10112452507019
Epoch: 7, Steps: 1045 | Train Loss: 0.3592576 Vali Loss: 0.2961491 Best vali loss: 0.2809327
	iters: 100, epoch: 8 | loss: 0.4675497
	speed: 0.0116s/iter; left time: 10.9276s
	iters: 200, epoch: 8 | loss: 0.3675598
	speed: 0.0037s/iter; left time: 3.1557s
	iters: 300, epoch: 8 | loss: 0.4473399
	speed: 0.0038s/iter; left time: 2.8135s
	iters: 400, epoch: 8 | loss: 0.3621719
	speed: 0.0037s/iter; left time: 2.4176s
	iters: 500, epoch: 8 | loss: 0.4167945
	speed: 0.0039s/iter; left time: 2.1086s
	iters: 600, epoch: 8 | loss: 0.2999522
	speed: 0.0040s/iter; left time: 1.7690s
	iters: 700, epoch: 8 | loss: 0.7866166
	speed: 0.0039s/iter; left time: 1.3645s
	iters: 800, epoch: 8 | loss: 0.9076492
	speed: 0.0039s/iter; left time: 0.9653s
	iters: 900, epoch: 8 | loss: 0.8346767
	speed: 0.0040s/iter; left time: 0.5796s
	iters: 1000, epoch: 8 | loss: 0.3015911
	speed: 0.0040s/iter; left time: 0.1835s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.0833740234375
Epoch: 8, Steps: 1045 | Train Loss: 0.5191902 Vali Loss: 0.3007564 Best vali loss: 0.2809327

best validation loss 0.2809327007248837

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022985164426, 'e_layers': 4, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.3131).  Saving model state dict ...
Epoch: 1 cost time: 0.6924648284912109
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3130886 Best vali loss: 0.3130886
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.3131 --> 0.2972).  Saving model state dict ...
Epoch: 2 cost time: 0.43033504486083984
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2972162 Best vali loss: 0.2972162
Updating learning rate to 8.93085473266162e-05
Validation loss decreased (0.2972 --> 0.2905).  Saving model state dict ...
Epoch: 3 cost time: 0.46008801460266113
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905199 Best vali loss: 0.2905199

best validation loss 0.29051993650412994

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4896113
	speed: 0.0139s/iter; left time: 13.1601s
Updating learning rate to 0.00022635856963078432
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 1.4038989543914795
Epoch: 1, Steps: 131 | Train Loss: 0.4896113 Vali Loss: 0.2799706 Best vali loss: 0.2799706
	iters: 100, epoch: 2 | loss: 0.4957182
	speed: 0.0143s/iter; left time: 11.6683s
Updating learning rate to 0.0002008536619192565
Validation loss decreased (0.2800 --> 0.2758).  Saving model state dict ...
Epoch: 2 cost time: 1.171252727508545
Epoch: 2, Steps: 131 | Train Loss: 0.4957182 Vali Loss: 0.2758062 Best vali loss: 0.2758062
	iters: 100, epoch: 3 | loss: 0.4318376
	speed: 0.0145s/iter; left time: 9.9715s
Updating learning rate to 0.00016268287006193248
Validation loss decreased (0.2758 --> 0.2750).  Saving model state dict ...
Epoch: 3 cost time: 1.1763951778411865
Epoch: 3, Steps: 131 | Train Loss: 0.4318376 Vali Loss: 0.2749960 Best vali loss: 0.2749960

best validation loss 0.2749960359674974

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010602146623, 'e_layers': 4, 'learning_rate': 0.000225512069, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8058677
	speed: 0.0103s/iter; left time: 20.5717s
	iters: 200, epoch: 1 | loss: 0.4476928
	speed: 0.0051s/iter; left time: 9.6787s
Updating learning rate to 0.000225512069
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 1.5977764129638672
Epoch: 1, Steps: 262 | Train Loss: 0.6267803 Vali Loss: 0.2835326 Best vali loss: 0.2835326
	iters: 100, epoch: 2 | loss: 0.3381070
	speed: 0.0110s/iter; left time: 19.1131s
	iters: 200, epoch: 2 | loss: 0.6086090
	speed: 0.0052s/iter; left time: 8.5434s
Updating learning rate to 0.0001127560345
Validation loss decreased (0.2835 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 1.4076647758483887
Epoch: 2, Steps: 262 | Train Loss: 0.4733580 Vali Loss: 0.2794386 Best vali loss: 0.2794386
	iters: 100, epoch: 3 | loss: 0.6099918
	speed: 0.0111s/iter; left time: 16.3979s
	iters: 200, epoch: 3 | loss: 0.6397390
	speed: 0.0052s/iter; left time: 7.0814s
Updating learning rate to 5.637801725e-05
Epoch: 3 cost time: 1.3872995376586914
Epoch: 3, Steps: 262 | Train Loss: 0.6248654 Vali Loss: 0.2817139 Best vali loss: 0.2794386

best validation loss 0.27943861639690293

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4021078
	speed: 0.0144s/iter; left time: 8.0183s
Updating learning rate to 0.0001176573511
Epoch: 4 cost time: 1.4134080410003662
Epoch: 4, Steps: 131 | Train Loss: 0.4021078 Vali Loss: 0.2913485 Best vali loss: 0.2749960
	iters: 100, epoch: 5 | loss: 0.3229543
	speed: 0.0139s/iter; left time: 5.9194s
Updating learning rate to 7.263183213806753e-05
Epoch: 5 cost time: 1.1725170612335205
Epoch: 5, Steps: 131 | Train Loss: 0.3229543 Vali Loss: 0.2952643 Best vali loss: 0.2749960
	iters: 100, epoch: 6 | loss: 0.3606459
	speed: 0.0140s/iter; left time: 4.1057s
Updating learning rate to 3.446104028074351e-05
Epoch: 6 cost time: 1.1742613315582275
Epoch: 6, Steps: 131 | Train Loss: 0.3606459 Vali Loss: 0.3045064 Best vali loss: 0.2749960
	iters: 100, epoch: 7 | loss: 0.3277754
	speed: 0.0139s/iter; left time: 2.2734s
Updating learning rate to 8.956132569215671e-06
Epoch: 7 cost time: 1.1722698211669922
Epoch: 7, Steps: 131 | Train Loss: 0.3277754 Vali Loss: 0.3091476 Best vali loss: 0.2749960
	iters: 100, epoch: 8 | loss: 0.4145193
	speed: 0.0140s/iter; left time: 0.4490s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1763293743133545
Epoch: 8, Steps: 131 | Train Loss: 0.4145193 Vali Loss: 0.3098405 Best vali loss: 0.2749960

best validation loss 0.2749960359674974

[INFO][abstract_intensifier.py:595] Added config 4678dd and rejected config 47e958 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028252887435, 'e_layers': 1, 'learning_rate': 0.0029075166254, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027968558630216732
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 0.48850345611572266
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2876676 Best vali loss: 0.2876676
Updating learning rate to 0.0024817206738164837
Epoch: 2 cost time: 0.27740478515625
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2972807 Best vali loss: 0.2876676
Updating learning rate to 0.002010087533633318
Epoch: 3 cost time: 0.283095121383667
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3018529 Best vali loss: 0.2876676
Updating learning rate to 0.0014537583127
Epoch: 4 cost time: 0.271350622177124
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2995709 Best vali loss: 0.2876676
Updating learning rate to 0.0008974290917666826
Epoch: 5 cost time: 0.2621314525604248
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2982234 Best vali loss: 0.2876676
Updating learning rate to 0.0004257959515835167
Epoch: 6 cost time: 0.25988030433654785
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3253710 Best vali loss: 0.2876676
Updating learning rate to 0.000110660762378327
Epoch: 7 cost time: 0.2585587501525879
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3145081 Best vali loss: 0.2876676
Updating learning rate to 0.0
Epoch: 8 cost time: 0.25832200050354004
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3227456 Best vali loss: 0.2876676

best validation loss 0.28766755575737396

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.004626800892, 'e_layers': 2, 'learning_rate': 0.0022058584169, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8312569
	speed: 0.0095s/iter; left time: 8.9933s
Updating learning rate to 0.0022058584169
Validation loss decreased (inf --> 0.2964).  Saving model state dict ...
Epoch: 1 cost time: 0.7993912696838379
Epoch: 1, Steps: 131 | Train Loss: 0.8312569 Vali Loss: 0.2964011 Best vali loss: 0.2964011
	iters: 100, epoch: 2 | loss: 0.5828384
	speed: 0.0066s/iter; left time: 5.3940s
Updating learning rate to 0.00110292920845
Epoch: 2 cost time: 0.5151886940002441
Epoch: 2, Steps: 131 | Train Loss: 0.5828384 Vali Loss: 0.2992290 Best vali loss: 0.2964011
	iters: 100, epoch: 3 | loss: 0.5932889
	speed: 0.0064s/iter; left time: 4.3670s
Updating learning rate to 0.000551464604225
Validation loss decreased (0.2964 --> 0.2935).  Saving model state dict ...
Epoch: 3 cost time: 0.5127875804901123
Epoch: 3, Steps: 131 | Train Loss: 0.5932889 Vali Loss: 0.2935302 Best vali loss: 0.2935302
	iters: 100, epoch: 4 | loss: 0.4060763
	speed: 0.0065s/iter; left time: 3.5943s
Updating learning rate to 0.0002757323021125
Validation loss decreased (0.2935 --> 0.2924).  Saving model state dict ...
Epoch: 4 cost time: 0.486797571182251
Epoch: 4, Steps: 131 | Train Loss: 0.4060763 Vali Loss: 0.2923642 Best vali loss: 0.2923642
	iters: 100, epoch: 5 | loss: 0.4790852
	speed: 0.0064s/iter; left time: 2.7030s
Updating learning rate to 0.00013786615105625
Epoch: 5 cost time: 0.5033798217773438
Epoch: 5, Steps: 131 | Train Loss: 0.4790852 Vali Loss: 0.2965525 Best vali loss: 0.2923642
	iters: 100, epoch: 6 | loss: 0.6271821
	speed: 0.0061s/iter; left time: 1.7962s
Updating learning rate to 6.8933075528125e-05
Epoch: 6 cost time: 0.48871397972106934
Epoch: 6, Steps: 131 | Train Loss: 0.6271821 Vali Loss: 0.3005619 Best vali loss: 0.2923642
	iters: 100, epoch: 7 | loss: 0.4093759
	speed: 0.0066s/iter; left time: 1.0762s
Updating learning rate to 3.44665377640625e-05
Epoch: 7 cost time: 0.5343356132507324
Epoch: 7, Steps: 131 | Train Loss: 0.4093759 Vali Loss: 0.2980501 Best vali loss: 0.2923642
	iters: 100, epoch: 8 | loss: 0.5201871
	speed: 0.0064s/iter; left time: 0.2035s
Updating learning rate to 1.723326888203125e-05
Epoch: 8 cost time: 0.49338674545288086
Epoch: 8, Steps: 131 | Train Loss: 0.5201871 Vali Loss: 0.2980778 Best vali loss: 0.2923642

best validation loss 0.29236419854132206

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3298896
	speed: 0.0079s/iter; left time: 15.7664s
	iters: 200, epoch: 1 | loss: 0.4349111
	speed: 0.0025s/iter; left time: 4.7910s
Updating learning rate to 0.0017284464069435928
Validation loss decreased (inf --> 0.2985).  Saving model state dict ...
Epoch: 1 cost time: 0.9349017143249512
Epoch: 1, Steps: 262 | Train Loss: 0.3824004 Vali Loss: 0.2984536 Best vali loss: 0.2984536
	iters: 100, epoch: 2 | loss: 0.5657018
	speed: 0.0061s/iter; left time: 10.5679s
	iters: 200, epoch: 2 | loss: 0.8084507
	speed: 0.0025s/iter; left time: 4.1111s
Updating learning rate to 0.001533694044948534
Validation loss decreased (0.2985 --> 0.2873).  Saving model state dict ...
Epoch: 2 cost time: 0.6855521202087402
Epoch: 2, Steps: 262 | Train Loss: 0.6870763 Vali Loss: 0.2873173 Best vali loss: 0.2873173
	iters: 100, epoch: 3 | loss: 0.4283633
	speed: 0.0061s/iter; left time: 9.0391s
	iters: 200, epoch: 3 | loss: 0.5530860
	speed: 0.0028s/iter; left time: 3.7843s
Updating learning rate to 0.0012422265376940138
Epoch: 3 cost time: 0.7302629947662354
Epoch: 3, Steps: 262 | Train Loss: 0.4907247 Vali Loss: 0.2966699 Best vali loss: 0.2873173

best validation loss 0.2873173406151601

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039181470431, 'e_layers': 3, 'learning_rate': 0.00012582665, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012103765828973066
Validation loss decreased (inf --> 0.3221).  Saving model state dict ...
Epoch: 1 cost time: 0.6272108554840088
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3220537 Best vali loss: 0.3220537
Updating learning rate to 0.00010739976373449315
Validation loss decreased (0.3221 --> 0.3038).  Saving model state dict ...
Epoch: 2 cost time: 0.3784964084625244
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3038350 Best vali loss: 0.3038350
Updating learning rate to 8.698921215250042e-05
Validation loss decreased (0.3038 --> 0.2937).  Saving model state dict ...
Epoch: 3 cost time: 0.39993882179260254
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2936717 Best vali loss: 0.2936717

best validation loss 0.29367169973607754

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6906875
	speed: 0.0095s/iter; left time: 19.0635s
	iters: 200, epoch: 1 | loss: 0.4218192
	speed: 0.0044s/iter; left time: 8.3926s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.3228).  Saving model state dict ...
Epoch: 1 cost time: 1.4332168102264404
Epoch: 1, Steps: 262 | Train Loss: 0.5562534 Vali Loss: 0.3227806 Best vali loss: 0.3227806
	iters: 100, epoch: 2 | loss: 0.4368342
	speed: 0.0096s/iter; left time: 16.7299s
	iters: 200, epoch: 2 | loss: 0.6082223
	speed: 0.0043s/iter; left time: 7.0968s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 1.1801483631134033
Epoch: 2, Steps: 262 | Train Loss: 0.5225283 Vali Loss: 0.3276022 Best vali loss: 0.3227806
	iters: 100, epoch: 3 | loss: 0.4718234
	speed: 0.0094s/iter; left time: 13.8356s
	iters: 200, epoch: 3 | loss: 0.5947189
	speed: 0.0042s/iter; left time: 5.7221s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 1.1239418983459473
Epoch: 3, Steps: 262 | Train Loss: 0.5332712 Vali Loss: 0.3249309 Best vali loss: 0.3227806

best validation loss 0.32278062744005853

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3035231
	speed: 0.0079s/iter; left time: 9.5885s
	iters: 200, epoch: 4 | loss: 0.4101751
	speed: 0.0028s/iter; left time: 3.1579s
Updating learning rate to 0.000898417171
Epoch: 4 cost time: 0.9923317432403564
Epoch: 4, Steps: 262 | Train Loss: 0.3568491 Vali Loss: 0.2967326 Best vali loss: 0.2873173
	iters: 100, epoch: 5 | loss: 0.4310120
	speed: 0.0063s/iter; left time: 5.9611s
	iters: 200, epoch: 5 | loss: 0.6641536
	speed: 0.0026s/iter; left time: 2.2157s
Updating learning rate to 0.0005546078043059862
Epoch: 5 cost time: 0.708214521408081
Epoch: 5, Steps: 262 | Train Loss: 0.5475828 Vali Loss: 0.3308066 Best vali loss: 0.2873173
	iters: 100, epoch: 6 | loss: 0.3965822
	speed: 0.0061s/iter; left time: 4.1778s
	iters: 200, epoch: 6 | loss: 0.4093231
	speed: 0.0025s/iter; left time: 1.4814s
Updating learning rate to 0.000263140297051466
Epoch: 6 cost time: 0.6966378688812256
Epoch: 6, Steps: 262 | Train Loss: 0.4029527 Vali Loss: 0.3458055 Best vali loss: 0.2873173
	iters: 100, epoch: 7 | loss: 0.3528026
	speed: 0.0062s/iter; left time: 2.6293s
	iters: 200, epoch: 7 | loss: 0.4301212
	speed: 0.0026s/iter; left time: 0.8531s
Updating learning rate to 6.838793505640724e-05
Epoch: 7 cost time: 0.7327525615692139
Epoch: 7, Steps: 262 | Train Loss: 0.3914619 Vali Loss: 0.3648313 Best vali loss: 0.2873173
	iters: 100, epoch: 8 | loss: 0.3852673
	speed: 0.0062s/iter; left time: 1.0039s
	iters: 200, epoch: 8 | loss: 0.2578292
	speed: 0.0025s/iter; left time: 0.1564s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6926059722900391
Epoch: 8, Steps: 262 | Train Loss: 0.3215483 Vali Loss: 0.3662551 Best vali loss: 0.2873173

best validation loss 0.2873173406151601

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010053990878, 'e_layers': 2, 'learning_rate': 0.0004254413654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0673288
	speed: 0.0084s/iter; left time: 16.7107s
	iters: 200, epoch: 1 | loss: 0.4951391
	speed: 0.0032s/iter; left time: 6.1445s
Updating learning rate to 0.0004254413654
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 1.1144099235534668
Epoch: 1, Steps: 262 | Train Loss: 0.7812340 Vali Loss: 0.2802400 Best vali loss: 0.2802400
	iters: 100, epoch: 2 | loss: 0.7355131
	speed: 0.0075s/iter; left time: 13.0468s
	iters: 200, epoch: 2 | loss: 0.4088578
	speed: 0.0032s/iter; left time: 5.2420s
Updating learning rate to 0.0002127206827
Epoch: 2 cost time: 0.8852155208587646
Epoch: 2, Steps: 262 | Train Loss: 0.5721854 Vali Loss: 0.2845010 Best vali loss: 0.2802400
	iters: 100, epoch: 3 | loss: 0.4450033
	speed: 0.0073s/iter; left time: 10.8010s
	iters: 200, epoch: 3 | loss: 0.3665324
	speed: 0.0032s/iter; left time: 4.3879s
Updating learning rate to 0.00010636034135
Epoch: 3 cost time: 0.8936114311218262
Epoch: 3, Steps: 262 | Train Loss: 0.4057679 Vali Loss: 0.2867454 Best vali loss: 0.2802400
	iters: 100, epoch: 4 | loss: 0.6891266
	speed: 0.0075s/iter; left time: 9.1202s
	iters: 200, epoch: 4 | loss: 0.6589614
	speed: 0.0032s/iter; left time: 3.5774s
Updating learning rate to 5.3180170675e-05
Epoch: 4 cost time: 0.8785085678100586
Epoch: 4, Steps: 262 | Train Loss: 0.6740440 Vali Loss: 0.2882012 Best vali loss: 0.2802400
	iters: 100, epoch: 5 | loss: 0.3773437
	speed: 0.0075s/iter; left time: 7.1250s
	iters: 200, epoch: 5 | loss: 0.3152882
	speed: 0.0034s/iter; left time: 2.8612s
Updating learning rate to 2.65900853375e-05
Epoch: 5 cost time: 0.9193344116210938
Epoch: 5, Steps: 262 | Train Loss: 0.3463160 Vali Loss: 0.2882389 Best vali loss: 0.2802400
	iters: 100, epoch: 6 | loss: 0.7348616
	speed: 0.0075s/iter; left time: 5.1395s
	iters: 200, epoch: 6 | loss: 0.3543857
	speed: 0.0032s/iter; left time: 1.8624s
Updating learning rate to 1.329504266875e-05
Epoch: 6 cost time: 0.877143383026123
Epoch: 6, Steps: 262 | Train Loss: 0.5446236 Vali Loss: 0.2884761 Best vali loss: 0.2802400
	iters: 100, epoch: 7 | loss: 0.7919623
	speed: 0.0074s/iter; left time: 3.1453s
	iters: 200, epoch: 7 | loss: 0.4993375
	speed: 0.0031s/iter; left time: 1.0214s
Updating learning rate to 6.647521334375e-06
Epoch: 7 cost time: 0.8732364177703857
Epoch: 7, Steps: 262 | Train Loss: 0.6456499 Vali Loss: 0.2888288 Best vali loss: 0.2802400
	iters: 100, epoch: 8 | loss: 0.4868769
	speed: 0.0072s/iter; left time: 1.1816s
	iters: 200, epoch: 8 | loss: 0.5787588
	speed: 0.0032s/iter; left time: 0.2018s
Updating learning rate to 3.3237606671875e-06
Epoch: 8 cost time: 0.8790595531463623
Epoch: 8, Steps: 262 | Train Loss: 0.5328178 Vali Loss: 0.2890192 Best vali loss: 0.2802400

best validation loss 0.28023995348249237

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0113842174153, 'e_layers': 1, 'learning_rate': 0.0018134405744, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2821549
	speed: 0.0077s/iter; left time: 63.7188s
	iters: 200, epoch: 1 | loss: 0.3987502
	speed: 0.0024s/iter; left time: 19.2573s
	iters: 300, epoch: 1 | loss: 0.5324462
	speed: 0.0022s/iter; left time: 18.0532s
	iters: 400, epoch: 1 | loss: 0.5779596
	speed: 0.0022s/iter; left time: 17.5431s
	iters: 500, epoch: 1 | loss: 1.2335888
	speed: 0.0022s/iter; left time: 17.4385s
	iters: 600, epoch: 1 | loss: 0.2063750
	speed: 0.0022s/iter; left time: 17.1968s
	iters: 700, epoch: 1 | loss: 0.3018051
	speed: 0.0022s/iter; left time: 16.9421s
	iters: 800, epoch: 1 | loss: 1.4700868
	speed: 0.0022s/iter; left time: 16.7808s
	iters: 900, epoch: 1 | loss: 0.7508001
	speed: 0.0022s/iter; left time: 16.5475s
	iters: 1000, epoch: 1 | loss: 0.2226608
	speed: 0.0023s/iter; left time: 17.0330s
Updating learning rate to 0.0018134405744
Validation loss decreased (inf --> 0.2906).  Saving model state dict ...
Epoch: 1 cost time: 2.646044969558716
Epoch: 1, Steps: 1045 | Train Loss: 0.5976627 Vali Loss: 0.2906177 Best vali loss: 0.2906177
	iters: 100, epoch: 2 | loss: 0.3665322
	speed: 0.0078s/iter; left time: 56.3538s
	iters: 200, epoch: 2 | loss: 0.2599014
	speed: 0.0021s/iter; left time: 14.8739s
	iters: 300, epoch: 2 | loss: 0.2486255
	speed: 0.0021s/iter; left time: 15.0213s
	iters: 400, epoch: 2 | loss: 0.3289205
	speed: 0.0022s/iter; left time: 14.8729s
	iters: 500, epoch: 2 | loss: 0.6107349
	speed: 0.0024s/iter; left time: 16.1535s
	iters: 600, epoch: 2 | loss: 0.4555877
	speed: 0.0024s/iter; left time: 16.0617s
	iters: 700, epoch: 2 | loss: 0.2472999
	speed: 0.0023s/iter; left time: 15.2090s
	iters: 800, epoch: 2 | loss: 0.3258070
	speed: 0.0022s/iter; left time: 14.4899s
	iters: 900, epoch: 2 | loss: 0.7983393
	speed: 0.0024s/iter; left time: 15.5003s
	iters: 1000, epoch: 2 | loss: 0.3878005
	speed: 0.0025s/iter; left time: 15.7402s
Updating learning rate to 0.0009067202872
Validation loss decreased (0.2906 --> 0.2859).  Saving model state dict ...
Epoch: 2 cost time: 2.421862840652466
Epoch: 2, Steps: 1045 | Train Loss: 0.4029549 Vali Loss: 0.2859000 Best vali loss: 0.2859000
	iters: 100, epoch: 3 | loss: 0.5125707
	speed: 0.0083s/iter; left time: 51.4349s
	iters: 200, epoch: 3 | loss: 2.0228314
	speed: 0.0025s/iter; left time: 15.2010s
	iters: 300, epoch: 3 | loss: 0.3930711
	speed: 0.0025s/iter; left time: 14.7354s
	iters: 400, epoch: 3 | loss: 1.1451533
	speed: 0.0025s/iter; left time: 14.6084s
	iters: 500, epoch: 3 | loss: 0.1840632
	speed: 0.0025s/iter; left time: 14.3008s
	iters: 600, epoch: 3 | loss: 0.4481916
	speed: 0.0025s/iter; left time: 14.0717s
	iters: 700, epoch: 3 | loss: 0.6004989
	speed: 0.0025s/iter; left time: 13.8419s
	iters: 800, epoch: 3 | loss: 0.4149562
	speed: 0.0025s/iter; left time: 13.4584s
	iters: 900, epoch: 3 | loss: 0.1691192
	speed: 0.0024s/iter; left time: 13.0617s
	iters: 1000, epoch: 3 | loss: 0.3861336
	speed: 0.0024s/iter; left time: 12.5382s
Updating learning rate to 0.0004533601436
Epoch: 3 cost time: 2.6051180362701416
Epoch: 3, Steps: 1045 | Train Loss: 0.6276589 Vali Loss: 0.2895176 Best vali loss: 0.2859000
	iters: 100, epoch: 4 | loss: 0.5961522
	speed: 0.0083s/iter; left time: 42.3368s
	iters: 200, epoch: 4 | loss: 0.9737016
	speed: 0.0025s/iter; left time: 12.4231s
	iters: 300, epoch: 4 | loss: 1.2920990
	speed: 0.0024s/iter; left time: 12.0268s
	iters: 400, epoch: 4 | loss: 0.2623804
	speed: 0.0025s/iter; left time: 11.8579s
	iters: 500, epoch: 4 | loss: 0.6399102
	speed: 0.0024s/iter; left time: 11.1086s
	iters: 600, epoch: 4 | loss: 0.1795755
	speed: 0.0023s/iter; left time: 10.6055s
	iters: 700, epoch: 4 | loss: 0.3967550
	speed: 0.0023s/iter; left time: 10.3501s
	iters: 800, epoch: 4 | loss: 0.8369756
	speed: 0.0023s/iter; left time: 10.2308s
	iters: 900, epoch: 4 | loss: 0.3025718
	speed: 0.0023s/iter; left time: 9.9785s
	iters: 1000, epoch: 4 | loss: 0.2927606
	speed: 0.0023s/iter; left time: 9.7169s
Updating learning rate to 0.0002266800718
Epoch: 4 cost time: 2.505398988723755
Epoch: 4, Steps: 1045 | Train Loss: 0.5772882 Vali Loss: 0.2943782 Best vali loss: 0.2859000
	iters: 100, epoch: 5 | loss: 0.2369124
	speed: 0.0076s/iter; left time: 30.9880s
	iters: 200, epoch: 5 | loss: 0.7460964
	speed: 0.0022s/iter; left time: 8.6547s
	iters: 300, epoch: 5 | loss: 0.5430900
	speed: 0.0022s/iter; left time: 8.3713s
	iters: 400, epoch: 5 | loss: 0.6728268
	speed: 0.0022s/iter; left time: 8.2939s
	iters: 500, epoch: 5 | loss: 0.2541601
	speed: 0.0022s/iter; left time: 8.0475s
	iters: 600, epoch: 5 | loss: 1.0044008
	speed: 0.0022s/iter; left time: 7.8376s
	iters: 700, epoch: 5 | loss: 0.8743781
	speed: 0.0021s/iter; left time: 7.2755s
	iters: 800, epoch: 5 | loss: 0.1643062
	speed: 0.0021s/iter; left time: 6.9902s
	iters: 900, epoch: 5 | loss: 1.6819364
	speed: 0.0021s/iter; left time: 6.7365s
	iters: 1000, epoch: 5 | loss: 0.4437176
	speed: 0.0021s/iter; left time: 6.6166s
Updating learning rate to 0.0001133400359
Epoch: 5 cost time: 2.264801025390625
Epoch: 5, Steps: 1045 | Train Loss: 0.6621825 Vali Loss: 0.3005827 Best vali loss: 0.2859000
	iters: 100, epoch: 6 | loss: 0.8530199
	speed: 0.0074s/iter; left time: 22.5903s
	iters: 200, epoch: 6 | loss: 0.2435154
	speed: 0.0020s/iter; left time: 5.9309s
	iters: 300, epoch: 6 | loss: 0.2824014
	speed: 0.0021s/iter; left time: 6.0954s
	iters: 400, epoch: 6 | loss: 0.4394563
	speed: 0.0025s/iter; left time: 6.7784s
	iters: 500, epoch: 6 | loss: 0.3633952
	speed: 0.0025s/iter; left time: 6.5495s
	iters: 600, epoch: 6 | loss: 0.3101010
	speed: 0.0025s/iter; left time: 6.2805s
	iters: 700, epoch: 6 | loss: 0.2850866
	speed: 0.0025s/iter; left time: 6.0364s
	iters: 800, epoch: 6 | loss: 0.2476582
	speed: 0.0025s/iter; left time: 5.7285s
	iters: 900, epoch: 6 | loss: 0.7389633
	speed: 0.0025s/iter; left time: 5.4818s
	iters: 1000, epoch: 6 | loss: 0.4755078
	speed: 0.0025s/iter; left time: 5.2418s
Updating learning rate to 5.667001795e-05
Epoch: 6 cost time: 2.4935638904571533
Epoch: 6, Steps: 1045 | Train Loss: 0.4239105 Vali Loss: 0.3111826 Best vali loss: 0.2859000
	iters: 100, epoch: 7 | loss: 0.5455347
	speed: 0.0076s/iter; left time: 15.1591s
	iters: 200, epoch: 7 | loss: 0.4699073
	speed: 0.0020s/iter; left time: 3.7806s
	iters: 300, epoch: 7 | loss: 0.4139078
	speed: 0.0022s/iter; left time: 3.8535s
	iters: 400, epoch: 7 | loss: 0.2000512
	speed: 0.0023s/iter; left time: 3.8757s
	iters: 500, epoch: 7 | loss: 0.4702198
	speed: 0.0023s/iter; left time: 3.6496s
	iters: 600, epoch: 7 | loss: 0.4000513
	speed: 0.0023s/iter; left time: 3.4134s
	iters: 700, epoch: 7 | loss: 0.2371430
	speed: 0.0023s/iter; left time: 3.1778s
	iters: 800, epoch: 7 | loss: 0.4830130
	speed: 0.0023s/iter; left time: 2.9370s
	iters: 900, epoch: 7 | loss: 0.5154041
	speed: 0.0023s/iter; left time: 2.7276s
	iters: 1000, epoch: 7 | loss: 0.2051919
	speed: 0.0023s/iter; left time: 2.4775s
Updating learning rate to 2.8335008975e-05
Epoch: 7 cost time: 2.3555757999420166
Epoch: 7, Steps: 1045 | Train Loss: 0.3940424 Vali Loss: 0.3137779 Best vali loss: 0.2859000
	iters: 100, epoch: 8 | loss: 0.3172380
	speed: 0.0077s/iter; left time: 7.3182s
	iters: 200, epoch: 8 | loss: 0.7877724
	speed: 0.0022s/iter; left time: 1.8994s
	iters: 300, epoch: 8 | loss: 1.0207702
	speed: 0.0022s/iter; left time: 1.6677s
	iters: 400, epoch: 8 | loss: 0.3226385
	speed: 0.0022s/iter; left time: 1.4026s
	iters: 500, epoch: 8 | loss: 0.2790428
	speed: 0.0021s/iter; left time: 1.1318s
	iters: 600, epoch: 8 | loss: 0.2892518
	speed: 0.0021s/iter; left time: 0.9243s
	iters: 700, epoch: 8 | loss: 0.2512546
	speed: 0.0021s/iter; left time: 0.7125s
	iters: 800, epoch: 8 | loss: 0.2881238
	speed: 0.0020s/iter; left time: 0.5033s
	iters: 900, epoch: 8 | loss: 0.3490377
	speed: 0.0021s/iter; left time: 0.3056s
	iters: 1000, epoch: 8 | loss: 0.2458529
	speed: 0.0021s/iter; left time: 0.0944s
Updating learning rate to 1.41675044875e-05
Epoch: 8 cost time: 2.254088878631592
Epoch: 8, Steps: 1045 | Train Loss: 0.4150983 Vali Loss: 0.3158287 Best vali loss: 0.2859000

best validation loss 0.28590000858312203

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014152615275, 'e_layers': 1, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.3100).  Saving model state dict ...
Epoch: 1 cost time: 0.4880855083465576
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3100417 Best vali loss: 0.3100417
Updating learning rate to 0.0002257411363
Validation loss decreased (0.3100 --> 0.2927).  Saving model state dict ...
Epoch: 2 cost time: 0.27540111541748047
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2926912 Best vali loss: 0.2926912
Updating learning rate to 0.00011287056815
Validation loss decreased (0.2927 --> 0.2881).  Saving model state dict ...
Epoch: 3 cost time: 0.28811073303222656
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2880645 Best vali loss: 0.2880645

best validation loss 0.2880645405740798

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5429620
	speed: 0.0085s/iter; left time: 8.0742s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.6787419319152832
Epoch: 1, Steps: 131 | Train Loss: 0.5429620 Vali Loss: 0.2829378 Best vali loss: 0.2829378
	iters: 100, epoch: 2 | loss: 0.3978160
	speed: 0.0055s/iter; left time: 4.4835s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.2829 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 0.4078824520111084
Epoch: 2, Steps: 131 | Train Loss: 0.3978160 Vali Loss: 0.2812244 Best vali loss: 0.2812244
	iters: 100, epoch: 3 | loss: 0.7905126
	speed: 0.0053s/iter; left time: 3.6199s
Updating learning rate to 1.70765195e-05
Validation loss decreased (0.2812 --> 0.2795).  Saving model state dict ...
Epoch: 3 cost time: 0.38458728790283203
Epoch: 3, Steps: 131 | Train Loss: 0.7905126 Vali Loss: 0.2794930 Best vali loss: 0.2794930

best validation loss 0.2794930044050419

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014438416367, 'e_layers': 1, 'learning_rate': 0.000558760672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4660459
	speed: 0.0080s/iter; left time: 15.8803s
	iters: 200, epoch: 1 | loss: 0.4870508
	speed: 0.0025s/iter; left time: 4.7807s
Updating learning rate to 0.0005374941102165261
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 0.958369255065918
Epoch: 1, Steps: 262 | Train Loss: 0.4765483 Vali Loss: 0.2837563 Best vali loss: 0.2837563
	iters: 100, epoch: 2 | loss: 0.4836692
	speed: 0.0064s/iter; left time: 11.0332s
	iters: 200, epoch: 2 | loss: 0.7244568
	speed: 0.0023s/iter; left time: 3.8408s
Updating learning rate to 0.00047693206611577606
Epoch: 2 cost time: 0.660768985748291
Epoch: 2, Steps: 262 | Train Loss: 0.6040630 Vali Loss: 0.2949986 Best vali loss: 0.2837563
	iters: 100, epoch: 3 | loss: 0.3975043
	speed: 0.0059s/iter; left time: 8.7258s
	iters: 200, epoch: 3 | loss: 0.3935789
	speed: 0.0024s/iter; left time: 3.2684s
Updating learning rate to 0.000386294561915792
Epoch: 3 cost time: 0.6617140769958496
Epoch: 3, Steps: 262 | Train Loss: 0.3955416 Vali Loss: 0.2881508 Best vali loss: 0.2837563

best validation loss 0.2837562965344833

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4870154
	speed: 0.0086s/iter; left time: 4.7628s
Updating learning rate to 8.53825975e-06
Validation loss decreased (0.2795 --> 0.2779).  Saving model state dict ...
Epoch: 4 cost time: 0.6741390228271484
Epoch: 4, Steps: 131 | Train Loss: 0.4870154 Vali Loss: 0.2778507 Best vali loss: 0.2778507
	iters: 100, epoch: 5 | loss: 0.3749695
	speed: 0.0054s/iter; left time: 2.3140s
Updating learning rate to 4.269129875e-06
Validation loss decreased (0.2779 --> 0.2775).  Saving model state dict ...
Epoch: 5 cost time: 0.40468931198120117
Epoch: 5, Steps: 131 | Train Loss: 0.3749695 Vali Loss: 0.2774547 Best vali loss: 0.2774547
	iters: 100, epoch: 6 | loss: 0.7490925
	speed: 0.0056s/iter; left time: 1.6391s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 0.4147810935974121
Epoch: 6, Steps: 131 | Train Loss: 0.7490925 Vali Loss: 0.2775264 Best vali loss: 0.2774547
	iters: 100, epoch: 7 | loss: 0.5067104
	speed: 0.0055s/iter; left time: 0.8949s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 0.4118826389312744
Epoch: 7, Steps: 131 | Train Loss: 0.5067104 Vali Loss: 0.2775234 Best vali loss: 0.2774547
	iters: 100, epoch: 8 | loss: 0.3697366
	speed: 0.0053s/iter; left time: 0.1702s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 0.403212308883667
Epoch: 8, Steps: 131 | Train Loss: 0.3697366 Vali Loss: 0.2774910 Best vali loss: 0.2774547

best validation loss 0.2774547010593673

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0079026385404, 'e_layers': 2, 'learning_rate': 0.0022201950658, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6355318
	speed: 0.0087s/iter; left time: 17.2873s
	iters: 200, epoch: 1 | loss: 0.5631440
	speed: 0.0033s/iter; left time: 6.3068s
Updating learning rate to 0.0022201950658
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 1.1645212173461914
Epoch: 1, Steps: 262 | Train Loss: 0.5993379 Vali Loss: 0.2901050 Best vali loss: 0.2901050
	iters: 100, epoch: 2 | loss: 0.4985761
	speed: 0.0079s/iter; left time: 13.7795s
	iters: 200, epoch: 2 | loss: 0.3962153
	speed: 0.0035s/iter; left time: 5.6420s
Updating learning rate to 0.0011100975329
Validation loss decreased (0.2901 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 0.9461922645568848
Epoch: 2, Steps: 262 | Train Loss: 0.4473957 Vali Loss: 0.2867929 Best vali loss: 0.2867929
	iters: 100, epoch: 3 | loss: 0.5953435
	speed: 0.0080s/iter; left time: 11.7328s
	iters: 200, epoch: 3 | loss: 0.7750326
	speed: 0.0036s/iter; left time: 4.9534s
Updating learning rate to 0.00055504876645
Epoch: 3 cost time: 0.9888901710510254
Epoch: 3, Steps: 262 | Train Loss: 0.6851880 Vali Loss: 0.2953836 Best vali loss: 0.2867929
	iters: 100, epoch: 4 | loss: 0.4459012
	speed: 0.0078s/iter; left time: 9.4872s
	iters: 200, epoch: 4 | loss: 0.4734406
	speed: 0.0036s/iter; left time: 3.9450s
Updating learning rate to 0.000277524383225
Epoch: 4 cost time: 0.9717121124267578
Epoch: 4, Steps: 262 | Train Loss: 0.4596709 Vali Loss: 0.2955467 Best vali loss: 0.2867929
	iters: 100, epoch: 5 | loss: 0.3067713
	speed: 0.0079s/iter; left time: 7.4997s
	iters: 200, epoch: 5 | loss: 0.4384037
	speed: 0.0033s/iter; left time: 2.8304s
Updating learning rate to 0.0001387621916125
Epoch: 5 cost time: 0.9341137409210205
Epoch: 5, Steps: 262 | Train Loss: 0.3725875 Vali Loss: 0.3104807 Best vali loss: 0.2867929
	iters: 100, epoch: 6 | loss: 0.4339473
	speed: 0.0077s/iter; left time: 5.2597s
	iters: 200, epoch: 6 | loss: 0.2600999
	speed: 0.0035s/iter; left time: 2.0759s
Updating learning rate to 6.938109580625e-05
Epoch: 6 cost time: 0.9614179134368896
Epoch: 6, Steps: 262 | Train Loss: 0.3470236 Vali Loss: 0.3038199 Best vali loss: 0.2867929
	iters: 100, epoch: 7 | loss: 0.4545154
	speed: 0.0079s/iter; left time: 3.3543s
	iters: 200, epoch: 7 | loss: 0.2778278
	speed: 0.0035s/iter; left time: 1.1500s
Updating learning rate to 3.4690547903125e-05
Epoch: 7 cost time: 0.9791927337646484
Epoch: 7, Steps: 262 | Train Loss: 0.3661716 Vali Loss: 0.3086475 Best vali loss: 0.2867929
	iters: 100, epoch: 8 | loss: 0.3121894
	speed: 0.0078s/iter; left time: 1.2655s
	iters: 200, epoch: 8 | loss: 0.2214279
	speed: 0.0036s/iter; left time: 0.2253s
Updating learning rate to 1.73452739515625e-05
Epoch: 8 cost time: 0.9364748001098633
Epoch: 8, Steps: 262 | Train Loss: 0.2668087 Vali Loss: 0.3118885 Best vali loss: 0.2867929

best validation loss 0.2867929254401878

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027523638828, 'e_layers': 2, 'learning_rate': 0.0003512624633, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003378933318411835
Validation loss decreased (inf --> 0.3149).  Saving model state dict ...
Epoch: 1 cost time: 0.5548880100250244
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3149453 Best vali loss: 0.3149453
Updating learning rate to 0.0002998212665378604
Validation loss decreased (0.3149 --> 0.2991).  Saving model state dict ...
Epoch: 2 cost time: 0.3216359615325928
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2991469 Best vali loss: 0.2991469
Updating learning rate to 0.0002428423942083302
Validation loss decreased (0.2991 --> 0.2911).  Saving model state dict ...
Epoch: 3 cost time: 0.2975161075592041
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2911379 Best vali loss: 0.2911379
Updating learning rate to 0.00017563123165
Validation loss decreased (0.2911 --> 0.2876).  Saving model state dict ...
Epoch: 4 cost time: 0.3040754795074463
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2876489 Best vali loss: 0.2876489
Updating learning rate to 0.00010842006909166983
Validation loss decreased (0.2876 --> 0.2855).  Saving model state dict ...
Epoch: 5 cost time: 0.31182050704956055
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2854771 Best vali loss: 0.2854771
Updating learning rate to 5.144119676213962e-05
Validation loss decreased (0.2855 --> 0.2845).  Saving model state dict ...
Epoch: 6 cost time: 0.31699109077453613
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845020 Best vali loss: 0.2845020
Updating learning rate to 1.3369131458816492e-05
Validation loss decreased (0.2845 --> 0.2842).  Saving model state dict ...
Epoch: 7 cost time: 0.2975285053253174
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2842018 Best vali loss: 0.2842018
Updating learning rate to 0.0
Validation loss decreased (0.2842 --> 0.2842).  Saving model state dict ...
Epoch: 8 cost time: 0.29916906356811523
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2841666 Best vali loss: 0.2841666

best validation loss 0.28416655216796904

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8340313
	speed: 0.0084s/iter; left time: 34.1431s
	iters: 200, epoch: 1 | loss: 0.3961600
	speed: 0.0029s/iter; left time: 11.6096s
	iters: 300, epoch: 1 | loss: 0.3412137
	speed: 0.0031s/iter; left time: 12.2198s
	iters: 400, epoch: 1 | loss: 0.3631559
	speed: 0.0032s/iter; left time: 12.0349s
	iters: 500, epoch: 1 | loss: 0.1976330
	speed: 0.0032s/iter; left time: 11.7586s
Updating learning rate to 9.34698808e-05
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 1.8874688148498535
Epoch: 1, Steps: 523 | Train Loss: 0.4264388 Vali Loss: 0.2805963 Best vali loss: 0.2805963
	iters: 100, epoch: 2 | loss: 0.4813979
	speed: 0.0074s/iter; left time: 26.2396s
	iters: 200, epoch: 2 | loss: 1.2156699
	speed: 0.0034s/iter; left time: 11.9430s
	iters: 300, epoch: 2 | loss: 0.8839002
	speed: 0.0034s/iter; left time: 11.5862s
	iters: 400, epoch: 2 | loss: 0.3731978
	speed: 0.0034s/iter; left time: 11.2499s
	iters: 500, epoch: 2 | loss: 0.5137824
	speed: 0.0034s/iter; left time: 10.8762s
Updating learning rate to 4.67349404e-05
Validation loss decreased (0.2806 --> 0.2762).  Saving model state dict ...
Epoch: 2 cost time: 1.836759328842163
Epoch: 2, Steps: 523 | Train Loss: 0.6935897 Vali Loss: 0.2761563 Best vali loss: 0.2761563
	iters: 100, epoch: 3 | loss: 0.3240150
	speed: 0.0076s/iter; left time: 23.0583s
	iters: 200, epoch: 3 | loss: 0.4868388
	speed: 0.0035s/iter; left time: 10.1991s
	iters: 300, epoch: 3 | loss: 0.4181248
	speed: 0.0035s/iter; left time: 9.9422s
	iters: 400, epoch: 3 | loss: 0.5650256
	speed: 0.0035s/iter; left time: 9.4834s
	iters: 500, epoch: 3 | loss: 0.2368787
	speed: 0.0035s/iter; left time: 9.1556s
Updating learning rate to 2.33674702e-05
Validation loss decreased (0.2762 --> 0.2758).  Saving model state dict ...
Epoch: 3 cost time: 1.8607656955718994
Epoch: 3, Steps: 523 | Train Loss: 0.4061766 Vali Loss: 0.2758127 Best vali loss: 0.2758127

best validation loss 0.2758127155690532

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7193140
	speed: 0.0104s/iter; left time: 42.5941s
	iters: 200, epoch: 1 | loss: 0.6999950
	speed: 0.0053s/iter; left time: 20.9393s
	iters: 300, epoch: 1 | loss: 0.5718579
	speed: 0.0053s/iter; left time: 20.4589s
	iters: 400, epoch: 1 | loss: 0.5889742
	speed: 0.0052s/iter; left time: 19.6888s
	iters: 500, epoch: 1 | loss: 0.3541995
	speed: 0.0052s/iter; left time: 19.2163s
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 2.9932236671447754
Epoch: 1, Steps: 523 | Train Loss: 0.5868681 Vali Loss: 0.2800077 Best vali loss: 0.2800077
	iters: 100, epoch: 2 | loss: 0.2801476
	speed: 0.0098s/iter; left time: 34.9523s
	iters: 200, epoch: 2 | loss: 0.3833831
	speed: 0.0049s/iter; left time: 17.0453s
	iters: 300, epoch: 2 | loss: 0.4314804
	speed: 0.0050s/iter; left time: 16.6602s
	iters: 400, epoch: 2 | loss: 0.3165190
	speed: 0.0050s/iter; left time: 16.2671s
	iters: 500, epoch: 2 | loss: 0.3534072
	speed: 0.0050s/iter; left time: 15.7264s
Updating learning rate to 0.00034048964815
Epoch: 2 cost time: 2.606790542602539
Epoch: 2, Steps: 523 | Train Loss: 0.3529875 Vali Loss: 0.2905247 Best vali loss: 0.2800077
	iters: 100, epoch: 3 | loss: 0.4029632
	speed: 0.0099s/iter; left time: 29.9357s
	iters: 200, epoch: 3 | loss: 0.8134559
	speed: 0.0049s/iter; left time: 14.5380s
	iters: 300, epoch: 3 | loss: 0.4942324
	speed: 0.0049s/iter; left time: 14.0419s
	iters: 400, epoch: 3 | loss: 0.6672369
	speed: 0.0050s/iter; left time: 13.7006s
	iters: 500, epoch: 3 | loss: 0.4926667
	speed: 0.0049s/iter; left time: 13.0274s
Updating learning rate to 0.000170244824075
Epoch: 3 cost time: 2.633017063140869
Epoch: 3, Steps: 523 | Train Loss: 0.5741110 Vali Loss: 0.2870036 Best vali loss: 0.2800077

best validation loss 0.2800076809202973

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0047262361197, 'e_layers': 2, 'learning_rate': 5.5626136e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.5626136e-05
Validation loss decreased (inf --> 0.3064).  Saving model state dict ...
Epoch: 1 cost time: 0.5618526935577393
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3063832 Best vali loss: 0.3063832
Updating learning rate to 2.7813068e-05
Validation loss decreased (0.3064 --> 0.2898).  Saving model state dict ...
Epoch: 2 cost time: 0.334728479385376
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2897515 Best vali loss: 0.2897515
Updating learning rate to 1.3906534e-05
Validation loss decreased (0.2898 --> 0.2857).  Saving model state dict ...
Epoch: 3 cost time: 0.3327820301055908
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2857484 Best vali loss: 0.2857484

best validation loss 0.28574838934001445

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7912202
	speed: 0.0087s/iter; left time: 21.8677s
	iters: 200, epoch: 4 | loss: 0.4178843
	speed: 0.0034s/iter; left time: 8.1813s
	iters: 300, epoch: 4 | loss: 0.3144421
	speed: 0.0034s/iter; left time: 7.7920s
	iters: 400, epoch: 4 | loss: 0.3232890
	speed: 0.0034s/iter; left time: 7.5155s
	iters: 500, epoch: 4 | loss: 0.1947254
	speed: 0.0034s/iter; left time: 7.2809s
Updating learning rate to 1.16837351e-05
Epoch: 4 cost time: 2.035956621170044
Epoch: 4, Steps: 523 | Train Loss: 0.4083122 Vali Loss: 0.2776025 Best vali loss: 0.2758127
	iters: 100, epoch: 5 | loss: 0.4801016
	speed: 0.0073s/iter; left time: 14.5313s
	iters: 200, epoch: 5 | loss: 1.0820357
	speed: 0.0035s/iter; left time: 6.5330s
	iters: 300, epoch: 5 | loss: 0.8131886
	speed: 0.0033s/iter; left time: 5.9428s
	iters: 400, epoch: 5 | loss: 0.3681617
	speed: 0.0033s/iter; left time: 5.5085s
	iters: 500, epoch: 5 | loss: 0.5184804
	speed: 0.0033s/iter; left time: 5.1924s
Updating learning rate to 5.84186755e-06
Epoch: 5 cost time: 1.7767868041992188
Epoch: 5, Steps: 523 | Train Loss: 0.6523936 Vali Loss: 0.2783567 Best vali loss: 0.2758127
	iters: 100, epoch: 6 | loss: 0.3328106
	speed: 0.0067s/iter; left time: 9.8784s
	iters: 200, epoch: 6 | loss: 0.4752529
	speed: 0.0029s/iter; left time: 4.0006s
	iters: 300, epoch: 6 | loss: 0.3815225
	speed: 0.0029s/iter; left time: 3.7199s
	iters: 400, epoch: 6 | loss: 0.5433298
	speed: 0.0029s/iter; left time: 3.4287s
	iters: 500, epoch: 6 | loss: 0.2332494
	speed: 0.0029s/iter; left time: 3.1347s
Updating learning rate to 2.920933775e-06
Epoch: 6 cost time: 1.568150281906128
Epoch: 6, Steps: 523 | Train Loss: 0.3932330 Vali Loss: 0.2781771 Best vali loss: 0.2758127
	iters: 100, epoch: 7 | loss: 0.7188184
	speed: 0.0067s/iter; left time: 6.3830s
	iters: 200, epoch: 7 | loss: 0.5400223
	speed: 0.0029s/iter; left time: 2.4659s
	iters: 300, epoch: 7 | loss: 1.1294146
	speed: 0.0029s/iter; left time: 2.1958s
	iters: 400, epoch: 7 | loss: 0.3361524
	speed: 0.0029s/iter; left time: 1.8939s
	iters: 500, epoch: 7 | loss: 0.8034984
	speed: 0.0030s/iter; left time: 1.6586s
Updating learning rate to 1.4604668875e-06
Epoch: 7 cost time: 1.5826959609985352
Epoch: 7, Steps: 523 | Train Loss: 0.7055812 Vali Loss: 0.2788074 Best vali loss: 0.2758127
	iters: 100, epoch: 8 | loss: 0.8432630
	speed: 0.0069s/iter; left time: 2.9421s
	iters: 200, epoch: 8 | loss: 0.3725201
	speed: 0.0032s/iter; left time: 1.0228s
	iters: 300, epoch: 8 | loss: 0.3645019
	speed: 0.0031s/iter; left time: 0.6959s
	iters: 400, epoch: 8 | loss: 0.3062265
	speed: 0.0032s/iter; left time: 0.3927s
	iters: 500, epoch: 8 | loss: 0.3267033
	speed: 0.0032s/iter; left time: 0.0757s
Updating learning rate to 7.3023344375e-07
Epoch: 8 cost time: 1.6841096878051758
Epoch: 8, Steps: 523 | Train Loss: 0.4426429 Vali Loss: 0.2789648 Best vali loss: 0.2758127

best validation loss 0.2758127155690532

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002399800657, 'e_layers': 3, 'learning_rate': 5.41855407e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.41855407e-05
Validation loss decreased (inf --> 0.3533).  Saving model state dict ...
Epoch: 1 cost time: 0.6307859420776367
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3533242 Best vali loss: 0.3533242
Updating learning rate to 2.709277035e-05
Validation loss decreased (0.3533 --> 0.3418).  Saving model state dict ...
Epoch: 2 cost time: 0.39618444442749023
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3418423 Best vali loss: 0.3418423
Updating learning rate to 1.3546385175e-05
Validation loss decreased (0.3418 --> 0.3370).  Saving model state dict ...
Epoch: 3 cost time: 0.3728327751159668
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3370456 Best vali loss: 0.3370456
Updating learning rate to 6.7731925875e-06
Validation loss decreased (0.3370 --> 0.3348).  Saving model state dict ...
Epoch: 4 cost time: 0.38277769088745117
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3348358 Best vali loss: 0.3348358
Updating learning rate to 3.38659629375e-06
Validation loss decreased (0.3348 --> 0.3337).  Saving model state dict ...
Epoch: 5 cost time: 0.3977220058441162
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3337330 Best vali loss: 0.3337330
Updating learning rate to 1.693298146875e-06
Validation loss decreased (0.3337 --> 0.3332).  Saving model state dict ...
Epoch: 6 cost time: 0.3560922145843506
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3332061 Best vali loss: 0.3332061
Updating learning rate to 8.466490734375e-07
Validation loss decreased (0.3332 --> 0.3329).  Saving model state dict ...
Epoch: 7 cost time: 0.3432157039642334
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3329456 Best vali loss: 0.3329456
Updating learning rate to 4.2332453671875e-07
Validation loss decreased (0.3329 --> 0.3328).  Saving model state dict ...
Epoch: 8 cost time: 0.35215306282043457
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3328127 Best vali loss: 0.3328127

best validation loss 0.33281273580741244

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016060344052, 'e_layers': 3, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2401924
	speed: 0.0098s/iter; left time: 19.5916s
	iters: 200, epoch: 1 | loss: 0.7111621
	speed: 0.0046s/iter; left time: 8.6334s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.454789400100708
Epoch: 1, Steps: 262 | Train Loss: 0.4756773 Vali Loss: 0.2873960 Best vali loss: 0.2873960
	iters: 100, epoch: 2 | loss: 0.3048992
	speed: 0.0097s/iter; left time: 16.7665s
	iters: 200, epoch: 2 | loss: 0.8970234
	speed: 0.0047s/iter; left time: 7.6078s
Updating learning rate to 0.00037646055854993277
Epoch: 2 cost time: 1.2173385620117188
Epoch: 2, Steps: 262 | Train Loss: 0.6009613 Vali Loss: 0.2901256 Best vali loss: 0.2873960
	iters: 100, epoch: 3 | loss: 0.4122463
	speed: 0.0096s/iter; left time: 14.1573s
	iters: 200, epoch: 3 | loss: 0.5020506
	speed: 0.0041s/iter; left time: 5.5997s
Updating learning rate to 0.00030491694074585157
Validation loss decreased (0.2874 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 1.130354404449463
Epoch: 3, Steps: 262 | Train Loss: 0.4571484 Vali Loss: 0.2819146 Best vali loss: 0.2819146
	iters: 100, epoch: 4 | loss: 0.3980431
	speed: 0.0093s/iter; left time: 11.3161s
	iters: 200, epoch: 4 | loss: 0.3538039
	speed: 0.0042s/iter; left time: 4.7055s
Updating learning rate to 0.0002205254895
Epoch: 4 cost time: 1.1564974784851074
Epoch: 4, Steps: 262 | Train Loss: 0.3759235 Vali Loss: 0.2842108 Best vali loss: 0.2819146
	iters: 100, epoch: 5 | loss: 0.4508059
	speed: 0.0093s/iter; left time: 8.8158s
	iters: 200, epoch: 5 | loss: 0.3012054
	speed: 0.0046s/iter; left time: 3.8745s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.2413430213928223
Epoch: 5, Steps: 262 | Train Loss: 0.3760057 Vali Loss: 0.2853221 Best vali loss: 0.2819146
	iters: 100, epoch: 6 | loss: 0.2562079
	speed: 0.0093s/iter; left time: 6.3695s
	iters: 200, epoch: 6 | loss: 0.3228912
	speed: 0.0040s/iter; left time: 2.3328s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 1.0765798091888428
Epoch: 6, Steps: 262 | Train Loss: 0.2895495 Vali Loss: 0.3049965 Best vali loss: 0.2819146
	iters: 100, epoch: 7 | loss: 0.3967261
	speed: 0.0089s/iter; left time: 3.7937s
	iters: 200, epoch: 7 | loss: 0.2379227
	speed: 0.0046s/iter; left time: 1.5014s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 1.1904542446136475
Epoch: 7, Steps: 262 | Train Loss: 0.3173244 Vali Loss: 0.2985742 Best vali loss: 0.2819146
	iters: 100, epoch: 8 | loss: 0.2478009
	speed: 0.0093s/iter; left time: 1.5176s
	iters: 200, epoch: 8 | loss: 0.3059199
	speed: 0.0039s/iter; left time: 0.2470s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.077326774597168
Epoch: 8, Steps: 262 | Train Loss: 0.2768604 Vali Loss: 0.3027226 Best vali loss: 0.2819146

best validation loss 0.2819146122485566

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047364814747, 'e_layers': 3, 'learning_rate': 0.0010075758554, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6271176
	speed: 0.0111s/iter; left time: 22.1399s
	iters: 200, epoch: 1 | loss: 0.9558530
	speed: 0.0057s/iter; left time: 10.8426s
Updating learning rate to 0.000969227282828306
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 1.784588098526001
Epoch: 1, Steps: 262 | Train Loss: 0.7914853 Vali Loss: 0.3201394 Best vali loss: 0.3201394
	iters: 100, epoch: 2 | loss: 0.8076766
	speed: 0.0126s/iter; left time: 21.7835s
	iters: 200, epoch: 2 | loss: 0.6873996
	speed: 0.0055s/iter; left time: 9.0569s
Updating learning rate to 0.0008600197876565881
Validation loss decreased (0.3201 --> 0.3199).  Saving model state dict ...
Epoch: 2 cost time: 1.4927942752838135
Epoch: 2, Steps: 262 | Train Loss: 0.7475381 Vali Loss: 0.3198762 Best vali loss: 0.3198762
	iters: 100, epoch: 3 | loss: 0.4289829
	speed: 0.0125s/iter; left time: 18.4691s
	iters: 200, epoch: 3 | loss: 0.4237156
	speed: 0.0057s/iter; left time: 7.8306s
Updating learning rate to 0.0006965792210563318
Validation loss decreased (0.3199 --> 0.3177).  Saving model state dict ...
Epoch: 3 cost time: 1.538259744644165
Epoch: 3, Steps: 262 | Train Loss: 0.4263492 Vali Loss: 0.3176858 Best vali loss: 0.3176858

best validation loss 0.3176857709674066

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 0.0001461940837, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8124551
	speed: 0.0097s/iter; left time: 9.1937s
Updating learning rate to 0.0001461940837
Validation loss decreased (inf --> 0.3001).  Saving model state dict ...
Epoch: 1 cost time: 0.842785120010376
Epoch: 1, Steps: 131 | Train Loss: 0.8124551 Vali Loss: 0.3000662 Best vali loss: 0.3000662
	iters: 100, epoch: 2 | loss: 0.5348289
	speed: 0.0080s/iter; left time: 6.5715s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.3001 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 0.6723597049713135
Epoch: 2, Steps: 131 | Train Loss: 0.5348289 Vali Loss: 0.2871121 Best vali loss: 0.2871121
	iters: 100, epoch: 3 | loss: 0.4518457
	speed: 0.0075s/iter; left time: 5.1366s
Updating learning rate to 3.6548520925e-05
Validation loss decreased (0.2871 --> 0.2840).  Saving model state dict ...
Epoch: 3 cost time: 0.5922729969024658
Epoch: 3, Steps: 131 | Train Loss: 0.4518457 Vali Loss: 0.2840002 Best vali loss: 0.2840002

best validation loss 0.2840002467305122

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6196154
	speed: 0.0080s/iter; left time: 7.5664s
Updating learning rate to 0.0017032495860327328
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.6247272491455078
Epoch: 1, Steps: 131 | Train Loss: 0.6196154 Vali Loss: 0.2816620 Best vali loss: 0.2816620
	iters: 100, epoch: 2 | loss: 0.8622814
	speed: 0.0051s/iter; left time: 4.1779s
Updating learning rate to 0.001511336270922462
Validation loss decreased (0.2817 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 0.38404059410095215
Epoch: 2, Steps: 131 | Train Loss: 0.8622814 Vali Loss: 0.2815246 Best vali loss: 0.2815246
	iters: 100, epoch: 3 | loss: 0.5372039
	speed: 0.0052s/iter; left time: 3.5589s
Updating learning rate to 0.0012241176975961933
Epoch: 3 cost time: 0.3934624195098877
Epoch: 3, Steps: 131 | Train Loss: 0.5372039 Vali Loss: 0.2866283 Best vali loss: 0.2815246

best validation loss 0.281524602183847

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6175051
	speed: 0.0080s/iter; left time: 4.4514s
Updating learning rate to 0.0008853202902
Epoch: 4 cost time: 0.6369600296020508
Epoch: 4, Steps: 131 | Train Loss: 0.6175051 Vali Loss: 0.2895513 Best vali loss: 0.2815246
	iters: 100, epoch: 5 | loss: 0.6208001
	speed: 0.0053s/iter; left time: 2.2354s
Updating learning rate to 0.0005465228828038066
Epoch: 5 cost time: 0.40129995346069336
Epoch: 5, Steps: 131 | Train Loss: 0.6208001 Vali Loss: 0.2916957 Best vali loss: 0.2815246
	iters: 100, epoch: 6 | loss: 0.4833185
	speed: 0.0055s/iter; left time: 1.6245s
Updating learning rate to 0.0002593043094775379
Epoch: 6 cost time: 0.43062329292297363
Epoch: 6, Steps: 131 | Train Loss: 0.4833185 Vali Loss: 0.2927927 Best vali loss: 0.2815246
	iters: 100, epoch: 7 | loss: 0.4833735
	speed: 0.0054s/iter; left time: 0.8731s
Updating learning rate to 6.739099436726728e-05
Epoch: 7 cost time: 0.3944284915924072
Epoch: 7, Steps: 131 | Train Loss: 0.4833735 Vali Loss: 0.2943760 Best vali loss: 0.2815246
	iters: 100, epoch: 8 | loss: 0.3231950
	speed: 0.0054s/iter; left time: 0.1732s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4304676055908203
Epoch: 8, Steps: 131 | Train Loss: 0.3231950 Vali Loss: 0.2906765 Best vali loss: 0.2815246

best validation loss 0.281524602183847

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023321783568, 'e_layers': 4, 'learning_rate': 9.29387868e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8979464
	speed: 0.0102s/iter; left time: 83.9073s
	iters: 200, epoch: 1 | loss: 1.8940372
	speed: 0.0050s/iter; left time: 41.0959s
	iters: 300, epoch: 1 | loss: 0.5398338
	speed: 0.0050s/iter; left time: 40.5902s
	iters: 400, epoch: 1 | loss: 1.1776630
	speed: 0.0051s/iter; left time: 40.2707s
	iters: 500, epoch: 1 | loss: 0.3337301
	speed: 0.0050s/iter; left time: 39.5713s
	iters: 600, epoch: 1 | loss: 0.4686851
	speed: 0.0050s/iter; left time: 39.1265s
	iters: 700, epoch: 1 | loss: 0.2983260
	speed: 0.0051s/iter; left time: 38.8825s
	iters: 800, epoch: 1 | loss: 0.4770249
	speed: 0.0051s/iter; left time: 38.3847s
	iters: 900, epoch: 1 | loss: 0.5538925
	speed: 0.0050s/iter; left time: 37.5540s
	iters: 1000, epoch: 1 | loss: 0.3539320
	speed: 0.0051s/iter; left time: 37.2033s
Updating learning rate to 8.940151485047507e-05
Validation loss decreased (inf --> 0.2995).  Saving model state dict ...
Epoch: 1 cost time: 5.537824869155884
Epoch: 1, Steps: 1045 | Train Loss: 0.6995071 Vali Loss: 0.2995277 Best vali loss: 0.2995277
	iters: 100, epoch: 2 | loss: 0.7194347
	speed: 0.0142s/iter; left time: 102.2809s
	iters: 200, epoch: 2 | loss: 0.5186115
	speed: 0.0050s/iter; left time: 35.8330s
	iters: 300, epoch: 2 | loss: 0.2722789
	speed: 0.0051s/iter; left time: 35.6418s
	iters: 400, epoch: 2 | loss: 0.1371274
	speed: 0.0050s/iter; left time: 34.7680s
	iters: 500, epoch: 2 | loss: 0.4892288
	speed: 0.0051s/iter; left time: 34.5759s
	iters: 600, epoch: 2 | loss: 0.2899892
	speed: 0.0051s/iter; left time: 33.9573s
	iters: 700, epoch: 2 | loss: 0.2235754
	speed: 0.0047s/iter; left time: 31.2123s
	iters: 800, epoch: 2 | loss: 0.5295174
	speed: 0.0046s/iter; left time: 30.2302s
	iters: 900, epoch: 2 | loss: 0.2227096
	speed: 0.0047s/iter; left time: 29.9395s
	iters: 1000, epoch: 2 | loss: 0.4860080
	speed: 0.0047s/iter; left time: 29.4497s
Updating learning rate to 7.93282165907654e-05
Validation loss decreased (0.2995 --> 0.2880).  Saving model state dict ...
Epoch: 2 cost time: 5.154043436050415
Epoch: 2, Steps: 1045 | Train Loss: 0.3888481 Vali Loss: 0.2880345 Best vali loss: 0.2880345
	iters: 100, epoch: 3 | loss: 0.2802228
	speed: 0.0138s/iter; left time: 85.4422s
	iters: 200, epoch: 3 | loss: 0.6223162
	speed: 0.0050s/iter; left time: 30.5566s
	iters: 300, epoch: 3 | loss: 0.3477182
	speed: 0.0051s/iter; left time: 30.4864s
	iters: 400, epoch: 3 | loss: 0.2793298
	speed: 0.0051s/iter; left time: 30.0159s
	iters: 500, epoch: 3 | loss: 0.1702289
	speed: 0.0050s/iter; left time: 29.1052s
	iters: 600, epoch: 3 | loss: 0.5040546
	speed: 0.0051s/iter; left time: 28.8544s
	iters: 700, epoch: 3 | loss: 0.2217704
	speed: 0.0051s/iter; left time: 28.2493s
	iters: 800, epoch: 3 | loss: 0.3357880
	speed: 0.0051s/iter; left time: 27.7915s
	iters: 900, epoch: 3 | loss: 0.2156231
	speed: 0.0051s/iter; left time: 27.2683s
	iters: 1000, epoch: 3 | loss: 0.2407504
	speed: 0.0050s/iter; left time: 26.4825s
Updating learning rate to 6.425246036623565e-05
Validation loss decreased (0.2880 --> 0.2847).  Saving model state dict ...
Epoch: 3 cost time: 5.342157363891602
Epoch: 3, Steps: 1045 | Train Loss: 0.3217802 Vali Loss: 0.2847222 Best vali loss: 0.2847222
	iters: 100, epoch: 4 | loss: 0.4889745
	speed: 0.0138s/iter; left time: 70.9838s
	iters: 200, epoch: 4 | loss: 1.0714405
	speed: 0.0050s/iter; left time: 25.2892s
	iters: 300, epoch: 4 | loss: 0.2179647
	speed: 0.0050s/iter; left time: 24.6809s
	iters: 400, epoch: 4 | loss: 0.4634647
	speed: 0.0050s/iter; left time: 24.2802s
	iters: 500, epoch: 4 | loss: 0.3736471
	speed: 0.0050s/iter; left time: 23.6245s
	iters: 600, epoch: 4 | loss: 0.2529553
	speed: 0.0050s/iter; left time: 23.1940s
	iters: 700, epoch: 4 | loss: 0.2214192
	speed: 0.0050s/iter; left time: 22.7059s
	iters: 800, epoch: 4 | loss: 0.2154242
	speed: 0.0050s/iter; left time: 22.1000s
	iters: 900, epoch: 4 | loss: 0.4881549
	speed: 0.0050s/iter; left time: 21.7418s
	iters: 1000, epoch: 4 | loss: 0.3721004
	speed: 0.0050s/iter; left time: 21.0546s
Updating learning rate to 4.64693934e-05
Validation loss decreased (0.2847 --> 0.2816).  Saving model state dict ...
Epoch: 4 cost time: 5.2690582275390625
Epoch: 4, Steps: 1045 | Train Loss: 0.4165545 Vali Loss: 0.2816495 Best vali loss: 0.2816495
	iters: 100, epoch: 5 | loss: 1.2554265
	speed: 0.0138s/iter; left time: 56.2637s
	iters: 200, epoch: 5 | loss: 0.3717354
	speed: 0.0050s/iter; left time: 20.0771s
	iters: 300, epoch: 5 | loss: 0.2721963
	speed: 0.0050s/iter; left time: 19.3610s
	iters: 400, epoch: 5 | loss: 0.1808657
	speed: 0.0050s/iter; left time: 19.0607s
	iters: 500, epoch: 5 | loss: 0.3199790
	speed: 0.0048s/iter; left time: 17.6188s
	iters: 600, epoch: 5 | loss: 0.2493406
	speed: 0.0049s/iter; left time: 17.5261s
	iters: 700, epoch: 5 | loss: 0.4137097
	speed: 0.0050s/iter; left time: 17.4403s
	iters: 800, epoch: 5 | loss: 0.2758626
	speed: 0.0050s/iter; left time: 17.0697s
	iters: 900, epoch: 5 | loss: 0.4973119
	speed: 0.0050s/iter; left time: 16.4427s
	iters: 1000, epoch: 5 | loss: 0.3709986
	speed: 0.0050s/iter; left time: 15.9355s
Updating learning rate to 2.8686326433764354e-05
Epoch: 5 cost time: 5.244540691375732
Epoch: 5, Steps: 1045 | Train Loss: 0.4207426 Vali Loss: 0.2826056 Best vali loss: 0.2816495
	iters: 100, epoch: 6 | loss: 0.3050373
	speed: 0.0138s/iter; left time: 41.9850s
	iters: 200, epoch: 6 | loss: 0.4980401
	speed: 0.0048s/iter; left time: 14.1335s
	iters: 300, epoch: 6 | loss: 0.3336873
	speed: 0.0048s/iter; left time: 13.4973s
	iters: 400, epoch: 6 | loss: 0.8691087
	speed: 0.0048s/iter; left time: 13.0506s
	iters: 500, epoch: 6 | loss: 0.2183108
	speed: 0.0047s/iter; left time: 12.4824s
	iters: 600, epoch: 6 | loss: 0.5298879
	speed: 0.0047s/iter; left time: 11.8911s
	iters: 700, epoch: 6 | loss: 1.1443065
	speed: 0.0047s/iter; left time: 11.5375s
	iters: 800, epoch: 6 | loss: 0.2569020
	speed: 0.0047s/iter; left time: 11.0019s
	iters: 900, epoch: 6 | loss: 0.3974850
	speed: 0.0047s/iter; left time: 10.5091s
	iters: 1000, epoch: 6 | loss: 0.2917107
	speed: 0.0047s/iter; left time: 10.0772s
Updating learning rate to 1.3610570209234607e-05
Epoch: 6 cost time: 5.009066581726074
Epoch: 6, Steps: 1045 | Train Loss: 0.4844476 Vali Loss: 0.2820337 Best vali loss: 0.2816495
	iters: 100, epoch: 7 | loss: 0.5734155
	speed: 0.0133s/iter; left time: 26.5171s
	iters: 200, epoch: 7 | loss: 0.2780638
	speed: 0.0046s/iter; left time: 8.7565s
	iters: 300, epoch: 7 | loss: 0.4086720
	speed: 0.0046s/iter; left time: 8.2870s
	iters: 400, epoch: 7 | loss: 0.2931367
	speed: 0.0047s/iter; left time: 7.9122s
	iters: 500, epoch: 7 | loss: 0.7550738
	speed: 0.0050s/iter; left time: 7.9936s
	iters: 600, epoch: 7 | loss: 0.2943918
	speed: 0.0049s/iter; left time: 7.3592s
	iters: 700, epoch: 7 | loss: 0.3018817
	speed: 0.0046s/iter; left time: 6.4218s
	iters: 800, epoch: 7 | loss: 0.1927111
	speed: 0.0045s/iter; left time: 5.8369s
	iters: 900, epoch: 7 | loss: 0.2265831
	speed: 0.0044s/iter; left time: 5.2495s
	iters: 1000, epoch: 7 | loss: 0.3831541
	speed: 0.0044s/iter; left time: 4.7672s
Updating learning rate to 3.5372719495249264e-06
Epoch: 7 cost time: 4.878546953201294
Epoch: 7, Steps: 1045 | Train Loss: 0.3707084 Vali Loss: 0.2820088 Best vali loss: 0.2816495
	iters: 100, epoch: 8 | loss: 0.7178795
	speed: 0.0136s/iter; left time: 12.8300s
	iters: 200, epoch: 8 | loss: 0.3226568
	speed: 0.0047s/iter; left time: 3.9735s
	iters: 300, epoch: 8 | loss: 0.2567658
	speed: 0.0047s/iter; left time: 3.5382s
	iters: 400, epoch: 8 | loss: 0.2152745
	speed: 0.0047s/iter; left time: 3.0281s
	iters: 500, epoch: 8 | loss: 1.6202468
	speed: 0.0047s/iter; left time: 2.5771s
	iters: 600, epoch: 8 | loss: 0.2240399
	speed: 0.0047s/iter; left time: 2.0948s
	iters: 700, epoch: 8 | loss: 0.2985165
	speed: 0.0047s/iter; left time: 1.6189s
	iters: 800, epoch: 8 | loss: 0.3339321
	speed: 0.0046s/iter; left time: 1.1334s
	iters: 900, epoch: 8 | loss: 0.7890656
	speed: 0.0047s/iter; left time: 0.6798s
	iters: 1000, epoch: 8 | loss: 0.5722386
	speed: 0.0046s/iter; left time: 0.2127s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.929637908935547
Epoch: 8, Steps: 1045 | Train Loss: 0.5350616 Vali Loss: 0.2820322 Best vali loss: 0.2816495

best validation loss 0.28164949948879014

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0028520410111, 'e_layers': 4, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3599511
	speed: 0.0128s/iter; left time: 25.5414s
	iters: 200, epoch: 1 | loss: 0.4241374
	speed: 0.0076s/iter; left time: 14.4215s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 2.2687556743621826
Epoch: 1, Steps: 262 | Train Loss: 0.3920442 Vali Loss: 0.2786011 Best vali loss: 0.2786011
	iters: 100, epoch: 2 | loss: 0.2599248
	speed: 0.0160s/iter; left time: 27.8338s
	iters: 200, epoch: 2 | loss: 0.5675285
	speed: 0.0075s/iter; left time: 12.3308s
Updating learning rate to 5.35870624e-05
Epoch: 2 cost time: 2.007150650024414
Epoch: 2, Steps: 262 | Train Loss: 0.4137267 Vali Loss: 0.2808917 Best vali loss: 0.2786011
	iters: 100, epoch: 3 | loss: 0.5536920
	speed: 0.0158s/iter; left time: 23.2346s
	iters: 200, epoch: 3 | loss: 0.4564309
	speed: 0.0076s/iter; left time: 10.4484s
Updating learning rate to 2.67935312e-05
Validation loss decreased (0.2786 --> 0.2747).  Saving model state dict ...
Epoch: 3 cost time: 2.0353825092315674
Epoch: 3, Steps: 262 | Train Loss: 0.5050614 Vali Loss: 0.2746760 Best vali loss: 0.2746760
	iters: 100, epoch: 4 | loss: 0.5383781
	speed: 0.0165s/iter; left time: 20.0178s
	iters: 200, epoch: 4 | loss: 0.5375238
	speed: 0.0075s/iter; left time: 8.3867s
Updating learning rate to 1.33967656e-05
Epoch: 4 cost time: 2.0211706161499023
Epoch: 4, Steps: 262 | Train Loss: 0.5379510 Vali Loss: 0.2785351 Best vali loss: 0.2746760
	iters: 100, epoch: 5 | loss: 0.2596246
	speed: 0.0159s/iter; left time: 15.1056s
	iters: 200, epoch: 5 | loss: 0.3873719
	speed: 0.0076s/iter; left time: 6.4483s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 2.0345613956451416
Epoch: 5, Steps: 262 | Train Loss: 0.3234983 Vali Loss: 0.2777128 Best vali loss: 0.2746760
	iters: 100, epoch: 6 | loss: 0.2060655
	speed: 0.0157s/iter; left time: 10.7636s
	iters: 200, epoch: 6 | loss: 0.3444842
	speed: 0.0076s/iter; left time: 4.4485s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 2.01324725151062
Epoch: 6, Steps: 262 | Train Loss: 0.2752748 Vali Loss: 0.2814265 Best vali loss: 0.2746760
	iters: 100, epoch: 7 | loss: 0.2653508
	speed: 0.0156s/iter; left time: 6.6296s
	iters: 200, epoch: 7 | loss: 0.4453120
	speed: 0.0075s/iter; left time: 2.4348s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 2.0048279762268066
Epoch: 7, Steps: 262 | Train Loss: 0.3553314 Vali Loss: 0.2813696 Best vali loss: 0.2746760
	iters: 100, epoch: 8 | loss: 0.3974079
	speed: 0.0157s/iter; left time: 2.5625s
	iters: 200, epoch: 8 | loss: 0.3776247
	speed: 0.0075s/iter; left time: 0.4742s
Updating learning rate to 8.3729785e-07
Epoch: 8 cost time: 2.0102338790893555
Epoch: 8, Steps: 262 | Train Loss: 0.3875163 Vali Loss: 0.2808320 Best vali loss: 0.2746760

best validation loss 0.27467595328403344

[INFO][abstract_intensifier.py:595] Added config 409f87 and rejected config 4678dd as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3163846
	speed: 0.0084s/iter; left time: 34.3146s
	iters: 200, epoch: 1 | loss: 0.2935283
	speed: 0.0032s/iter; left time: 12.6350s
	iters: 300, epoch: 1 | loss: 1.0396720
	speed: 0.0032s/iter; left time: 12.2771s
	iters: 400, epoch: 1 | loss: 0.6473989
	speed: 0.0032s/iter; left time: 12.1286s
	iters: 500, epoch: 1 | loss: 0.6302875
	speed: 0.0032s/iter; left time: 11.8002s
Updating learning rate to 0.0002999627711
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 1.9337005615234375
Epoch: 1, Steps: 523 | Train Loss: 0.5854543 Vali Loss: 0.2824809 Best vali loss: 0.2824809
	iters: 100, epoch: 2 | loss: 0.3311754
	speed: 0.0068s/iter; left time: 24.1390s
	iters: 200, epoch: 2 | loss: 0.2907819
	speed: 0.0029s/iter; left time: 9.8768s
	iters: 300, epoch: 2 | loss: 0.3621268
	speed: 0.0028s/iter; left time: 9.5019s
	iters: 400, epoch: 2 | loss: 1.0315093
	speed: 0.0029s/iter; left time: 9.3373s
	iters: 500, epoch: 2 | loss: 0.7103134
	speed: 0.0030s/iter; left time: 9.3995s
Updating learning rate to 0.00014998138555
Epoch: 2 cost time: 1.5390198230743408
Epoch: 2, Steps: 523 | Train Loss: 0.5451813 Vali Loss: 0.2843706 Best vali loss: 0.2824809
	iters: 100, epoch: 3 | loss: 0.2972250
	speed: 0.0067s/iter; left time: 20.3629s
	iters: 200, epoch: 3 | loss: 0.7125362
	speed: 0.0031s/iter; left time: 9.1775s
	iters: 300, epoch: 3 | loss: 0.3464516
	speed: 0.0029s/iter; left time: 8.2705s
	iters: 400, epoch: 3 | loss: 0.3651107
	speed: 0.0028s/iter; left time: 7.7918s
	iters: 500, epoch: 3 | loss: 0.2365883
	speed: 0.0028s/iter; left time: 7.4965s
Updating learning rate to 7.4990692775e-05
Epoch: 3 cost time: 1.574345350265503
Epoch: 3, Steps: 523 | Train Loss: 0.3915823 Vali Loss: 0.2865032 Best vali loss: 0.2824809

best validation loss 0.28248093524090906

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5510309
	speed: 0.0088s/iter; left time: 17.5086s
	iters: 200, epoch: 1 | loss: 0.4285284
	speed: 0.0033s/iter; left time: 6.2178s
Updating learning rate to 0.0006619683104416462
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 1.14616060256958
Epoch: 1, Steps: 262 | Train Loss: 0.4897797 Vali Loss: 0.2851795 Best vali loss: 0.2851795
	iters: 100, epoch: 2 | loss: 0.2619300
	speed: 0.0083s/iter; left time: 14.3832s
	iters: 200, epoch: 2 | loss: 0.3157342
	speed: 0.0033s/iter; left time: 5.4326s
Updating learning rate to 0.0005873811600929365
Validation loss decreased (0.2852 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 0.9514460563659668
Epoch: 2, Steps: 262 | Train Loss: 0.2888321 Vali Loss: 0.2828813 Best vali loss: 0.2828813
	iters: 100, epoch: 3 | loss: 0.7749415
	speed: 0.0079s/iter; left time: 11.6423s
	iters: 200, epoch: 3 | loss: 0.4215963
	speed: 0.0034s/iter; left time: 4.6576s
Updating learning rate to 0.0004757536010602603
Epoch: 3 cost time: 0.9313795566558838
Epoch: 3, Steps: 262 | Train Loss: 0.5982689 Vali Loss: 0.2847902 Best vali loss: 0.2828813

best validation loss 0.28288128579159394

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006724544284
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 1.0170817375183105
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2837355 Best vali loss: 0.2837355
Updating learning rate to 0.0003362272142
Epoch: 2 cost time: 0.7890722751617432
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2932293 Best vali loss: 0.2837355
Updating learning rate to 0.0001681136071
Epoch: 3 cost time: 0.770028829574585
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2935511 Best vali loss: 0.2837355

best validation loss 0.283735543561496

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2865676
	speed: 0.0089s/iter; left time: 22.2788s
	iters: 200, epoch: 4 | loss: 0.2756878
	speed: 0.0034s/iter; left time: 8.1061s
	iters: 300, epoch: 4 | loss: 1.0651835
	speed: 0.0034s/iter; left time: 7.8084s
	iters: 400, epoch: 4 | loss: 0.6088039
	speed: 0.0034s/iter; left time: 7.4987s
	iters: 500, epoch: 4 | loss: 0.6815933
	speed: 0.0034s/iter; left time: 7.1803s
Updating learning rate to 3.74953463875e-05
Epoch: 4 cost time: 2.0452475547790527
Epoch: 4, Steps: 523 | Train Loss: 0.5835672 Vali Loss: 0.2874200 Best vali loss: 0.2824809
	iters: 100, epoch: 5 | loss: 0.3310013
	speed: 0.0074s/iter; left time: 14.8326s
	iters: 200, epoch: 5 | loss: 0.2581441
	speed: 0.0029s/iter; left time: 5.5209s
	iters: 300, epoch: 5 | loss: 0.3483367
	speed: 0.0029s/iter; left time: 5.2177s
	iters: 400, epoch: 5 | loss: 0.8984541
	speed: 0.0029s/iter; left time: 4.9493s
	iters: 500, epoch: 5 | loss: 0.6416560
	speed: 0.0029s/iter; left time: 4.6478s
Updating learning rate to 1.874767319375e-05
Epoch: 5 cost time: 1.598870038986206
Epoch: 5, Steps: 523 | Train Loss: 0.4955184 Vali Loss: 0.2873973 Best vali loss: 0.2824809
	iters: 100, epoch: 6 | loss: 0.2837422
	speed: 0.0074s/iter; left time: 10.8621s
	iters: 200, epoch: 6 | loss: 0.6801714
	speed: 0.0030s/iter; left time: 4.1101s
	iters: 300, epoch: 6 | loss: 0.3122413
	speed: 0.0030s/iter; left time: 3.8103s
	iters: 400, epoch: 6 | loss: 0.3555228
	speed: 0.0032s/iter; left time: 3.6899s
	iters: 500, epoch: 6 | loss: 0.2425385
	speed: 0.0032s/iter; left time: 3.3819s
Updating learning rate to 9.373836596875e-06
Epoch: 6 cost time: 1.6829867362976074
Epoch: 6, Steps: 523 | Train Loss: 0.3748432 Vali Loss: 0.2872495 Best vali loss: 0.2824809
	iters: 100, epoch: 7 | loss: 0.2307643
	speed: 0.0074s/iter; left time: 6.9806s
	iters: 200, epoch: 7 | loss: 0.7725298
	speed: 0.0031s/iter; left time: 2.6312s
	iters: 300, epoch: 7 | loss: 0.2695965
	speed: 0.0031s/iter; left time: 2.3233s
	iters: 400, epoch: 7 | loss: 0.2474242
	speed: 0.0031s/iter; left time: 2.0009s
	iters: 500, epoch: 7 | loss: 0.9325876
	speed: 0.0032s/iter; left time: 1.7278s
Updating learning rate to 4.6869182984375e-06
Epoch: 7 cost time: 1.6934540271759033
Epoch: 7, Steps: 523 | Train Loss: 0.4905805 Vali Loss: 0.2871033 Best vali loss: 0.2824809
	iters: 100, epoch: 8 | loss: 0.5820437
	speed: 0.0071s/iter; left time: 3.0224s
	iters: 200, epoch: 8 | loss: 0.2907177
	speed: 0.0031s/iter; left time: 1.0058s
	iters: 300, epoch: 8 | loss: 0.4855153
	speed: 0.0031s/iter; left time: 0.6939s
	iters: 400, epoch: 8 | loss: 1.2922921
	speed: 0.0031s/iter; left time: 0.3885s
	iters: 500, epoch: 8 | loss: 0.2417621
	speed: 0.0031s/iter; left time: 0.0739s
Updating learning rate to 2.34345914921875e-06
Epoch: 8 cost time: 1.669478416442871
Epoch: 8, Steps: 523 | Train Loss: 0.5784662 Vali Loss: 0.2872052 Best vali loss: 0.2824809

best validation loss 0.28248093524090906

[INFO][smbo.py:320] Finished 100 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014600474372, 'e_layers': 3, 'learning_rate': 0.0001170962273, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6850824
	speed: 0.0095s/iter; left time: 78.3671s
	iters: 200, epoch: 1 | loss: 0.7761726
	speed: 0.0042s/iter; left time: 34.2400s
	iters: 300, epoch: 1 | loss: 0.4737371
	speed: 0.0042s/iter; left time: 34.1375s
	iters: 400, epoch: 1 | loss: 0.4836669
	speed: 0.0042s/iter; left time: 33.2003s
	iters: 500, epoch: 1 | loss: 0.2347744
	speed: 0.0040s/iter; left time: 31.6910s
	iters: 600, epoch: 1 | loss: 0.4705000
	speed: 0.0038s/iter; left time: 29.6945s
	iters: 700, epoch: 1 | loss: 0.7418409
	speed: 0.0038s/iter; left time: 29.4093s
	iters: 800, epoch: 1 | loss: 0.7980165
	speed: 0.0038s/iter; left time: 28.9661s
	iters: 900, epoch: 1 | loss: 0.4668112
	speed: 0.0039s/iter; left time: 28.9274s
	iters: 1000, epoch: 1 | loss: 0.3877143
	speed: 0.0038s/iter; left time: 28.2105s
Updating learning rate to 0.0001170962273
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 4.459173679351807
Epoch: 1, Steps: 1045 | Train Loss: 0.5518316 Vali Loss: 0.2841881 Best vali loss: 0.2841881
	iters: 100, epoch: 2 | loss: 1.3370112
	speed: 0.0120s/iter; left time: 86.5598s
	iters: 200, epoch: 2 | loss: 1.3955115
	speed: 0.0039s/iter; left time: 27.4286s
	iters: 300, epoch: 2 | loss: 0.3246973
	speed: 0.0038s/iter; left time: 26.6401s
	iters: 400, epoch: 2 | loss: 0.1993698
	speed: 0.0037s/iter; left time: 25.5304s
	iters: 500, epoch: 2 | loss: 0.6408018
	speed: 0.0037s/iter; left time: 25.0431s
	iters: 600, epoch: 2 | loss: 0.3186817
	speed: 0.0036s/iter; left time: 24.5057s
	iters: 700, epoch: 2 | loss: 1.8411410
	speed: 0.0037s/iter; left time: 24.3848s
	iters: 800, epoch: 2 | loss: 0.3659292
	speed: 0.0036s/iter; left time: 23.6737s
	iters: 900, epoch: 2 | loss: 0.9737894
	speed: 0.0037s/iter; left time: 23.5992s
	iters: 1000, epoch: 2 | loss: 0.1983330
	speed: 0.0038s/iter; left time: 23.6968s
Updating learning rate to 5.854811365e-05
Epoch: 2 cost time: 3.9419426918029785
Epoch: 2, Steps: 1045 | Train Loss: 0.7595266 Vali Loss: 0.2869188 Best vali loss: 0.2841881
	iters: 100, epoch: 3 | loss: 0.3235826
	speed: 0.0121s/iter; left time: 74.5535s
	iters: 200, epoch: 3 | loss: 0.5160155
	speed: 0.0038s/iter; left time: 23.3033s
	iters: 300, epoch: 3 | loss: 0.5263149
	speed: 0.0040s/iter; left time: 23.7722s
	iters: 400, epoch: 3 | loss: 0.2244508
	speed: 0.0039s/iter; left time: 23.1867s
	iters: 500, epoch: 3 | loss: 0.2531897
	speed: 0.0037s/iter; left time: 21.5224s
	iters: 600, epoch: 3 | loss: 0.7896460
	speed: 0.0038s/iter; left time: 21.4002s
	iters: 700, epoch: 3 | loss: 0.3825488
	speed: 0.0040s/iter; left time: 22.2665s
	iters: 800, epoch: 3 | loss: 0.2547382
	speed: 0.0039s/iter; left time: 21.6041s
	iters: 900, epoch: 3 | loss: 0.2719633
	speed: 0.0039s/iter; left time: 21.0828s
	iters: 1000, epoch: 3 | loss: 0.8495956
	speed: 0.0039s/iter; left time: 20.4295s
Updating learning rate to 2.9274056825e-05
Validation loss decreased (0.2842 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 4.1118152141571045
Epoch: 3, Steps: 1045 | Train Loss: 0.4392045 Vali Loss: 0.2835653 Best vali loss: 0.2835653
	iters: 100, epoch: 4 | loss: 0.7023038
	speed: 0.0123s/iter; left time: 63.1064s
	iters: 200, epoch: 4 | loss: 0.3071016
	speed: 0.0040s/iter; left time: 19.8927s
	iters: 300, epoch: 4 | loss: 0.2114416
	speed: 0.0041s/iter; left time: 20.0661s
	iters: 400, epoch: 4 | loss: 0.3105839
	speed: 0.0042s/iter; left time: 20.1693s
	iters: 500, epoch: 4 | loss: 0.6962944
	speed: 0.0042s/iter; left time: 19.7906s
	iters: 600, epoch: 4 | loss: 0.5141756
	speed: 0.0042s/iter; left time: 19.4595s
	iters: 700, epoch: 4 | loss: 0.2519333
	speed: 0.0041s/iter; left time: 18.7725s
	iters: 800, epoch: 4 | loss: 0.3132321
	speed: 0.0040s/iter; left time: 17.8612s
	iters: 900, epoch: 4 | loss: 0.2724682
	speed: 0.0040s/iter; left time: 17.3087s
	iters: 1000, epoch: 4 | loss: 1.3901476
	speed: 0.0040s/iter; left time: 16.8780s
Updating learning rate to 1.46370284125e-05
Epoch: 4 cost time: 4.331779718399048
Epoch: 4, Steps: 1045 | Train Loss: 0.4969682 Vali Loss: 0.2838522 Best vali loss: 0.2835653
	iters: 100, epoch: 5 | loss: 0.2857412
	speed: 0.0124s/iter; left time: 50.6824s
	iters: 200, epoch: 5 | loss: 0.2974873
	speed: 0.0043s/iter; left time: 17.2614s
	iters: 300, epoch: 5 | loss: 0.6191412
	speed: 0.0042s/iter; left time: 16.3628s
	iters: 400, epoch: 5 | loss: 0.2688417
	speed: 0.0043s/iter; left time: 16.3756s
	iters: 500, epoch: 5 | loss: 0.4684824
	speed: 0.0043s/iter; left time: 15.8737s
	iters: 600, epoch: 5 | loss: 0.3899903
	speed: 0.0042s/iter; left time: 15.0736s
	iters: 700, epoch: 5 | loss: 0.5070590
	speed: 0.0042s/iter; left time: 14.7565s
	iters: 800, epoch: 5 | loss: 0.3189823
	speed: 0.0042s/iter; left time: 14.1489s
	iters: 900, epoch: 5 | loss: 0.6176109
	speed: 0.0043s/iter; left time: 14.0386s
	iters: 1000, epoch: 5 | loss: 0.3571402
	speed: 0.0043s/iter; left time: 13.5585s
Updating learning rate to 7.31851420625e-06
Epoch: 5 cost time: 4.517397403717041
Epoch: 5, Steps: 1045 | Train Loss: 0.4130477 Vali Loss: 0.2847245 Best vali loss: 0.2835653
	iters: 100, epoch: 6 | loss: 0.4001302
	speed: 0.0122s/iter; left time: 37.0045s
	iters: 200, epoch: 6 | loss: 0.1891042
	speed: 0.0039s/iter; left time: 11.4401s
	iters: 300, epoch: 6 | loss: 0.3346541
	speed: 0.0037s/iter; left time: 10.5493s
	iters: 400, epoch: 6 | loss: 1.4774134
	speed: 0.0037s/iter; left time: 10.1492s
	iters: 500, epoch: 6 | loss: 0.2561960
	speed: 0.0037s/iter; left time: 9.6352s
	iters: 600, epoch: 6 | loss: 0.7862934
	speed: 0.0037s/iter; left time: 9.3591s
	iters: 700, epoch: 6 | loss: 0.3582781
	speed: 0.0037s/iter; left time: 9.0120s
	iters: 800, epoch: 6 | loss: 0.3530473
	speed: 0.0037s/iter; left time: 8.6086s
	iters: 900, epoch: 6 | loss: 1.9066442
	speed: 0.0037s/iter; left time: 8.2731s
	iters: 1000, epoch: 6 | loss: 0.5530984
	speed: 0.0037s/iter; left time: 7.9415s
Updating learning rate to 3.659257103125e-06
Epoch: 6 cost time: 3.9704675674438477
Epoch: 6, Steps: 1045 | Train Loss: 0.6614859 Vali Loss: 0.2846662 Best vali loss: 0.2835653
	iters: 100, epoch: 7 | loss: 0.5339587
	speed: 0.0120s/iter; left time: 23.9664s
	iters: 200, epoch: 7 | loss: 0.3291105
	speed: 0.0040s/iter; left time: 7.5633s
	iters: 300, epoch: 7 | loss: 0.4330438
	speed: 0.0040s/iter; left time: 7.1655s
	iters: 400, epoch: 7 | loss: 0.3988270
	speed: 0.0040s/iter; left time: 6.7769s
	iters: 500, epoch: 7 | loss: 0.1566200
	speed: 0.0040s/iter; left time: 6.3500s
	iters: 600, epoch: 7 | loss: 0.5311959
	speed: 0.0040s/iter; left time: 5.9464s
	iters: 700, epoch: 7 | loss: 0.9620758
	speed: 0.0040s/iter; left time: 5.5213s
	iters: 800, epoch: 7 | loss: 0.5924703
	speed: 0.0040s/iter; left time: 5.1126s
	iters: 900, epoch: 7 | loss: 0.4202825
	speed: 0.0040s/iter; left time: 4.7517s
	iters: 1000, epoch: 7 | loss: 0.3532420
	speed: 0.0040s/iter; left time: 4.3306s
Updating learning rate to 1.8296285515625e-06
Epoch: 7 cost time: 4.220752716064453
Epoch: 7, Steps: 1045 | Train Loss: 0.4710826 Vali Loss: 0.2845753 Best vali loss: 0.2835653
	iters: 100, epoch: 8 | loss: 1.3950292
	speed: 0.0125s/iter; left time: 11.8224s
	iters: 200, epoch: 8 | loss: 0.2489853
	speed: 0.0040s/iter; left time: 3.3781s
	iters: 300, epoch: 8 | loss: 0.2884174
	speed: 0.0040s/iter; left time: 2.9815s
	iters: 400, epoch: 8 | loss: 0.8392805
	speed: 0.0040s/iter; left time: 2.5794s
	iters: 500, epoch: 8 | loss: 0.2290003
	speed: 0.0040s/iter; left time: 2.1690s
	iters: 600, epoch: 8 | loss: 0.9396026
	speed: 0.0041s/iter; left time: 1.8203s
	iters: 700, epoch: 8 | loss: 0.6127099
	speed: 0.0043s/iter; left time: 1.4729s
	iters: 800, epoch: 8 | loss: 0.6357057
	speed: 0.0042s/iter; left time: 1.0265s
	iters: 900, epoch: 8 | loss: 0.5200734
	speed: 0.0042s/iter; left time: 0.6076s
	iters: 1000, epoch: 8 | loss: 0.2009127
	speed: 0.0042s/iter; left time: 0.1916s
Updating learning rate to 9.1481427578125e-07
Epoch: 8 cost time: 4.350178480148315
Epoch: 8, Steps: 1045 | Train Loss: 0.5909717 Vali Loss: 0.2846686 Best vali loss: 0.2835653

best validation loss 0.28356529000624264

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008001774243, 'e_layers': 4, 'learning_rate': 8.14780285e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7518919
	speed: 0.0126s/iter; left time: 25.1615s
	iters: 200, epoch: 1 | loss: 0.4120902
	speed: 0.0069s/iter; left time: 13.1570s
Updating learning rate to 8.14780285e-05
Validation loss decreased (inf --> 0.2778).  Saving model state dict ...
Epoch: 1 cost time: 2.126213550567627
Epoch: 1, Steps: 262 | Train Loss: 0.5819910 Vali Loss: 0.2778358 Best vali loss: 0.2778358
	iters: 100, epoch: 2 | loss: 0.5006580
	speed: 0.0153s/iter; left time: 26.5700s
	iters: 200, epoch: 2 | loss: 0.5219786
	speed: 0.0069s/iter; left time: 11.3395s
Updating learning rate to 4.073901425e-05
Epoch: 2 cost time: 1.8711106777191162
Epoch: 2, Steps: 262 | Train Loss: 0.5113183 Vali Loss: 0.2889480 Best vali loss: 0.2778358
	iters: 100, epoch: 3 | loss: 0.7946247
	speed: 0.0150s/iter; left time: 22.1501s
	iters: 200, epoch: 3 | loss: 0.4666939
	speed: 0.0070s/iter; left time: 9.6643s
Updating learning rate to 2.0369507125e-05
Epoch: 3 cost time: 1.8940885066986084
Epoch: 3, Steps: 262 | Train Loss: 0.6306593 Vali Loss: 0.2862970 Best vali loss: 0.2778358
	iters: 100, epoch: 4 | loss: 0.2977830
	speed: 0.0150s/iter; left time: 18.2200s
	iters: 200, epoch: 4 | loss: 0.4122534
	speed: 0.0071s/iter; left time: 7.8414s
Updating learning rate to 1.01847535625e-05
Epoch: 4 cost time: 1.9171664714813232
Epoch: 4, Steps: 262 | Train Loss: 0.3550182 Vali Loss: 0.2943957 Best vali loss: 0.2778358
	iters: 100, epoch: 5 | loss: 0.4396711
	speed: 0.0155s/iter; left time: 14.6721s
	iters: 200, epoch: 5 | loss: 0.4697715
	speed: 0.0071s/iter; left time: 6.0228s
Updating learning rate to 5.09237678125e-06
Epoch: 5 cost time: 1.908109426498413
Epoch: 5, Steps: 262 | Train Loss: 0.4547213 Vali Loss: 0.3048797 Best vali loss: 0.2778358
	iters: 100, epoch: 6 | loss: 0.5232760
	speed: 0.0153s/iter; left time: 10.4884s
	iters: 200, epoch: 6 | loss: 0.3680574
	speed: 0.0071s/iter; left time: 4.1844s
Updating learning rate to 2.546188390625e-06
Epoch: 6 cost time: 1.9193923473358154
Epoch: 6, Steps: 262 | Train Loss: 0.4456667 Vali Loss: 0.2977229 Best vali loss: 0.2778358
	iters: 100, epoch: 7 | loss: 0.4447731
	speed: 0.0153s/iter; left time: 6.5201s
	iters: 200, epoch: 7 | loss: 0.4395992
	speed: 0.0071s/iter; left time: 2.3013s
Updating learning rate to 1.2730941953125e-06
Epoch: 7 cost time: 1.908522129058838
Epoch: 7, Steps: 262 | Train Loss: 0.4421861 Vali Loss: 0.2983321 Best vali loss: 0.2778358
	iters: 100, epoch: 8 | loss: 0.2752408
	speed: 0.0153s/iter; left time: 2.4872s
	iters: 200, epoch: 8 | loss: 0.3186066
	speed: 0.0072s/iter; left time: 0.4544s
Updating learning rate to 6.3654709765625e-07
Epoch: 8 cost time: 1.9415979385375977
Epoch: 8, Steps: 262 | Train Loss: 0.2969237 Vali Loss: 0.2997369 Best vali loss: 0.2778358

best validation loss 0.27783576704980095

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0042555642414, 'e_layers': 4, 'learning_rate': 0.0033451766027, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7449472
	speed: 0.0104s/iter; left time: 85.5388s
	iters: 200, epoch: 1 | loss: 1.5295891
	speed: 0.0048s/iter; left time: 39.4014s
	iters: 300, epoch: 1 | loss: 0.5028560
	speed: 0.0049s/iter; left time: 39.6877s
	iters: 400, epoch: 1 | loss: 0.9047253
	speed: 0.0049s/iter; left time: 39.0320s
	iters: 500, epoch: 1 | loss: 0.2789063
	speed: 0.0049s/iter; left time: 38.2575s
	iters: 600, epoch: 1 | loss: 0.4890511
	speed: 0.0048s/iter; left time: 37.1781s
	iters: 700, epoch: 1 | loss: 0.3064982
	speed: 0.0043s/iter; left time: 32.8728s
	iters: 800, epoch: 1 | loss: 0.4714992
	speed: 0.0043s/iter; left time: 32.3445s
	iters: 900, epoch: 1 | loss: 0.5444573
	speed: 0.0043s/iter; left time: 32.1212s
	iters: 1000, epoch: 1 | loss: 0.3358924
	speed: 0.0043s/iter; left time: 31.9642s
Updating learning rate to 0.0032178583992850856
Validation loss decreased (inf --> 0.2984).  Saving model state dict ...
Epoch: 1 cost time: 5.137155055999756
Epoch: 1, Steps: 1045 | Train Loss: 0.6108422 Vali Loss: 0.2983605 Best vali loss: 0.2983605
	iters: 100, epoch: 2 | loss: 0.6962050
	speed: 0.0137s/iter; left time: 98.7353s
	iters: 200, epoch: 2 | loss: 0.5485065
	speed: 0.0051s/iter; left time: 35.9528s
	iters: 300, epoch: 2 | loss: 0.2664203
	speed: 0.0050s/iter; left time: 35.0077s
	iters: 400, epoch: 2 | loss: 0.1195807
	speed: 0.0050s/iter; left time: 34.4935s
	iters: 500, epoch: 2 | loss: 0.4168538
	speed: 0.0050s/iter; left time: 33.9648s
	iters: 600, epoch: 2 | loss: 0.2695056
	speed: 0.0050s/iter; left time: 33.5551s
	iters: 700, epoch: 2 | loss: 0.2051124
	speed: 0.0050s/iter; left time: 33.3525s
	iters: 800, epoch: 2 | loss: 0.5354947
	speed: 0.0050s/iter; left time: 32.8477s
	iters: 900, epoch: 2 | loss: 0.2317867
	speed: 0.0050s/iter; left time: 32.0973s
	iters: 1000, epoch: 2 | loss: 0.5149128
	speed: 0.0051s/iter; left time: 31.9939s
Updating learning rate to 0.0028552868313678737
Validation loss decreased (0.2984 --> 0.2979).  Saving model state dict ...
Epoch: 2 cost time: 5.270623445510864
Epoch: 2, Steps: 1045 | Train Loss: 0.3804379 Vali Loss: 0.2978635 Best vali loss: 0.2978635
	iters: 100, epoch: 3 | loss: 0.2855724
	speed: 0.0139s/iter; left time: 86.0419s
	iters: 200, epoch: 3 | loss: 0.6632040
	speed: 0.0051s/iter; left time: 30.7879s
	iters: 300, epoch: 3 | loss: 0.3389643
	speed: 0.0050s/iter; left time: 30.1401s
	iters: 400, epoch: 3 | loss: 0.2865186
	speed: 0.0051s/iter; left time: 29.8781s
	iters: 500, epoch: 3 | loss: 0.1727473
	speed: 0.0051s/iter; left time: 29.2672s
	iters: 600, epoch: 3 | loss: 0.5018863
	speed: 0.0051s/iter; left time: 28.8107s
	iters: 700, epoch: 3 | loss: 0.2444187
	speed: 0.0051s/iter; left time: 28.4079s
	iters: 800, epoch: 3 | loss: 0.3755827
	speed: 0.0051s/iter; left time: 27.8601s
	iters: 900, epoch: 3 | loss: 0.2036212
	speed: 0.0051s/iter; left time: 27.4377s
	iters: 1000, epoch: 3 | loss: 0.2392573
	speed: 0.0051s/iter; left time: 26.7901s
Updating learning rate to 0.0023126601334443136
Validation loss decreased (0.2979 --> 0.2909).  Saving model state dict ...
Epoch: 3 cost time: 5.34825873374939
Epoch: 3, Steps: 1045 | Train Loss: 0.3311773 Vali Loss: 0.2909072 Best vali loss: 0.2909072

best validation loss 0.290907240126735

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023938699804, 'e_layers': 1, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5238287
	speed: 0.0080s/iter; left time: 15.9036s
	iters: 200, epoch: 1 | loss: 0.5016221
	speed: 0.0027s/iter; left time: 5.0839s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.2927).  Saving model state dict ...
Epoch: 1 cost time: 0.987786054611206
Epoch: 1, Steps: 262 | Train Loss: 0.5127254 Vali Loss: 0.2926698 Best vali loss: 0.2926698
	iters: 100, epoch: 2 | loss: 0.4060927
	speed: 0.0065s/iter; left time: 11.2678s
	iters: 200, epoch: 2 | loss: 0.3461089
	speed: 0.0028s/iter; left time: 4.5536s
Updating learning rate to 0.0014281993853242025
Epoch: 2 cost time: 0.7517118453979492
Epoch: 2, Steps: 262 | Train Loss: 0.3761008 Vali Loss: 0.2989910 Best vali loss: 0.2926698
	iters: 100, epoch: 3 | loss: 0.5643033
	speed: 0.0062s/iter; left time: 9.1902s
	iters: 200, epoch: 3 | loss: 0.5975348
	speed: 0.0025s/iter; left time: 3.3866s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 0.6969754695892334
Epoch: 3, Steps: 262 | Train Loss: 0.5809191 Vali Loss: 0.3164598 Best vali loss: 0.2926698

best validation loss 0.2926697759723167

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5526433
	speed: 0.0076s/iter; left time: 62.9709s
	iters: 200, epoch: 1 | loss: 0.3242701
	speed: 0.0024s/iter; left time: 19.4223s
	iters: 300, epoch: 1 | loss: 0.7173219
	speed: 0.0024s/iter; left time: 19.4527s
	iters: 400, epoch: 1 | loss: 0.2743785
	speed: 0.0025s/iter; left time: 19.9345s
	iters: 500, epoch: 1 | loss: 0.2144217
	speed: 0.0025s/iter; left time: 19.5033s
	iters: 600, epoch: 1 | loss: 0.2736471
	speed: 0.0024s/iter; left time: 18.6807s
	iters: 700, epoch: 1 | loss: 0.2596611
	speed: 0.0024s/iter; left time: 18.2656s
	iters: 800, epoch: 1 | loss: 0.3481595
	speed: 0.0024s/iter; left time: 17.8368s
	iters: 900, epoch: 1 | loss: 0.3696861
	speed: 0.0024s/iter; left time: 17.6081s
	iters: 1000, epoch: 1 | loss: 0.3218402
	speed: 0.0024s/iter; left time: 17.5133s
Updating learning rate to 0.0002485111429
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 2.7851502895355225
Epoch: 1, Steps: 1045 | Train Loss: 0.3656030 Vali Loss: 0.2812486 Best vali loss: 0.2812486
	iters: 100, epoch: 2 | loss: 0.4733663
	speed: 0.0083s/iter; left time: 59.9635s
	iters: 200, epoch: 2 | loss: 0.2025662
	speed: 0.0024s/iter; left time: 17.0141s
	iters: 300, epoch: 2 | loss: 0.5354497
	speed: 0.0024s/iter; left time: 16.7006s
	iters: 400, epoch: 2 | loss: 0.4007703
	speed: 0.0024s/iter; left time: 16.4039s
	iters: 500, epoch: 2 | loss: 0.2589484
	speed: 0.0024s/iter; left time: 16.2162s
	iters: 600, epoch: 2 | loss: 0.3440189
	speed: 0.0024s/iter; left time: 15.9620s
	iters: 700, epoch: 2 | loss: 0.1582497
	speed: 0.0024s/iter; left time: 15.5807s
	iters: 800, epoch: 2 | loss: 0.3785646
	speed: 0.0024s/iter; left time: 15.6348s
	iters: 900, epoch: 2 | loss: 0.5147941
	speed: 0.0024s/iter; left time: 15.1295s
	iters: 1000, epoch: 2 | loss: 0.3901884
	speed: 0.0024s/iter; left time: 15.0020s
Updating learning rate to 0.00012425557145
Epoch: 2 cost time: 2.5131072998046875
Epoch: 2, Steps: 1045 | Train Loss: 0.3656917 Vali Loss: 0.2913642 Best vali loss: 0.2812486
	iters: 100, epoch: 3 | loss: 0.4461822
	speed: 0.0078s/iter; left time: 48.2845s
	iters: 200, epoch: 3 | loss: 0.2522370
	speed: 0.0024s/iter; left time: 14.5467s
	iters: 300, epoch: 3 | loss: 0.2586259
	speed: 0.0024s/iter; left time: 14.2704s
	iters: 400, epoch: 3 | loss: 0.2902486
	speed: 0.0024s/iter; left time: 14.2258s
	iters: 500, epoch: 3 | loss: 0.9942562
	speed: 0.0025s/iter; left time: 14.2641s
	iters: 600, epoch: 3 | loss: 0.1366129
	speed: 0.0025s/iter; left time: 13.9107s
	iters: 700, epoch: 3 | loss: 0.3385690
	speed: 0.0026s/iter; left time: 14.3502s
	iters: 800, epoch: 3 | loss: 0.3904034
	speed: 0.0024s/iter; left time: 13.2906s
	iters: 900, epoch: 3 | loss: 0.4752820
	speed: 0.0025s/iter; left time: 13.4266s
	iters: 1000, epoch: 3 | loss: 0.5279776
	speed: 0.0023s/iter; left time: 12.1823s
Updating learning rate to 6.2127785725e-05
Epoch: 3 cost time: 2.5716702938079834
Epoch: 3, Steps: 1045 | Train Loss: 0.4110395 Vali Loss: 0.2983128 Best vali loss: 0.2812486

best validation loss 0.2812485851655001

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3779100
	speed: 0.0076s/iter; left time: 38.9964s
	iters: 200, epoch: 4 | loss: 0.2604761
	speed: 0.0023s/iter; left time: 11.5228s
	iters: 300, epoch: 4 | loss: 0.6308694
	speed: 0.0023s/iter; left time: 11.2152s
	iters: 400, epoch: 4 | loss: 0.2105141
	speed: 0.0023s/iter; left time: 10.9509s
	iters: 500, epoch: 4 | loss: 0.1920858
	speed: 0.0023s/iter; left time: 10.7069s
	iters: 600, epoch: 4 | loss: 0.2886353
	speed: 0.0023s/iter; left time: 10.5841s
	iters: 700, epoch: 4 | loss: 0.2510408
	speed: 0.0023s/iter; left time: 10.3703s
	iters: 800, epoch: 4 | loss: 0.3432791
	speed: 0.0023s/iter; left time: 10.2328s
	iters: 900, epoch: 4 | loss: 0.3182456
	speed: 0.0023s/iter; left time: 9.9612s
	iters: 1000, epoch: 4 | loss: 0.2738572
	speed: 0.0023s/iter; left time: 9.6786s
Updating learning rate to 3.10638928625e-05
Epoch: 4 cost time: 2.64814829826355
Epoch: 4, Steps: 1045 | Train Loss: 0.3146913 Vali Loss: 0.3040135 Best vali loss: 0.2812486
	iters: 100, epoch: 5 | loss: 0.3725190
	speed: 0.0080s/iter; left time: 32.6867s
	iters: 200, epoch: 5 | loss: 0.1840946
	speed: 0.0024s/iter; left time: 9.7315s
	iters: 300, epoch: 5 | loss: 0.3167195
	speed: 0.0024s/iter; left time: 9.4152s
	iters: 400, epoch: 5 | loss: 0.2865196
	speed: 0.0024s/iter; left time: 8.9800s
	iters: 500, epoch: 5 | loss: 0.1915390
	speed: 0.0024s/iter; left time: 8.7148s
	iters: 600, epoch: 5 | loss: 0.3157845
	speed: 0.0023s/iter; left time: 8.3824s
	iters: 700, epoch: 5 | loss: 0.1422502
	speed: 0.0023s/iter; left time: 7.8568s
	iters: 800, epoch: 5 | loss: 0.3867940
	speed: 0.0023s/iter; left time: 7.7908s
	iters: 900, epoch: 5 | loss: 0.2855714
	speed: 0.0024s/iter; left time: 7.7111s
	iters: 1000, epoch: 5 | loss: 0.2775692
	speed: 0.0023s/iter; left time: 7.4431s
Updating learning rate to 1.553194643125e-05
Epoch: 5 cost time: 2.5060925483703613
Epoch: 5, Steps: 1045 | Train Loss: 0.2759361 Vali Loss: 0.3001733 Best vali loss: 0.2812486
	iters: 100, epoch: 6 | loss: 0.4069255
	speed: 0.0079s/iter; left time: 24.0219s
	iters: 200, epoch: 6 | loss: 0.2544116
	speed: 0.0024s/iter; left time: 7.0841s
	iters: 300, epoch: 6 | loss: 0.1834377
	speed: 0.0024s/iter; left time: 6.7394s
	iters: 400, epoch: 6 | loss: 0.2726646
	speed: 0.0024s/iter; left time: 6.5112s
	iters: 500, epoch: 6 | loss: 0.6330619
	speed: 0.0024s/iter; left time: 6.2898s
	iters: 600, epoch: 6 | loss: 0.1271902
	speed: 0.0024s/iter; left time: 6.1311s
	iters: 700, epoch: 6 | loss: 0.3180595
	speed: 0.0024s/iter; left time: 5.9024s
	iters: 800, epoch: 6 | loss: 0.2962448
	speed: 0.0024s/iter; left time: 5.5908s
	iters: 900, epoch: 6 | loss: 0.4395719
	speed: 0.0024s/iter; left time: 5.3013s
	iters: 1000, epoch: 6 | loss: 0.4059103
	speed: 0.0024s/iter; left time: 5.0583s
Updating learning rate to 7.765973215625e-06
Epoch: 6 cost time: 2.5279481410980225
Epoch: 6, Steps: 1045 | Train Loss: 0.3337478 Vali Loss: 0.3040984 Best vali loss: 0.2812486
	iters: 100, epoch: 7 | loss: 0.4768782
	speed: 0.0078s/iter; left time: 15.6209s
	iters: 200, epoch: 7 | loss: 0.3925562
	speed: 0.0022s/iter; left time: 4.1085s
	iters: 300, epoch: 7 | loss: 0.4315043
	speed: 0.0022s/iter; left time: 4.0081s
	iters: 400, epoch: 7 | loss: 0.3089429
	speed: 0.0022s/iter; left time: 3.7146s
	iters: 500, epoch: 7 | loss: 0.4078166
	speed: 0.0023s/iter; left time: 3.6051s
	iters: 600, epoch: 7 | loss: 0.2697749
	speed: 0.0023s/iter; left time: 3.4326s
	iters: 700, epoch: 7 | loss: 0.2743538
	speed: 0.0023s/iter; left time: 3.1414s
	iters: 800, epoch: 7 | loss: 0.8286360
	speed: 0.0023s/iter; left time: 3.0277s
	iters: 900, epoch: 7 | loss: 0.2932391
	speed: 0.0023s/iter; left time: 2.7005s
	iters: 1000, epoch: 7 | loss: 0.5251082
	speed: 0.0023s/iter; left time: 2.5383s
Updating learning rate to 3.8829866078125e-06
Epoch: 7 cost time: 2.397144317626953
Epoch: 7, Steps: 1045 | Train Loss: 0.4208810 Vali Loss: 0.3071298 Best vali loss: 0.2812486
	iters: 100, epoch: 8 | loss: 0.3538539
	speed: 0.0078s/iter; left time: 7.3528s
	iters: 200, epoch: 8 | loss: 0.2866681
	speed: 0.0021s/iter; left time: 1.8015s
	iters: 300, epoch: 8 | loss: 0.5575994
	speed: 0.0021s/iter; left time: 1.5879s
	iters: 400, epoch: 8 | loss: 0.3484362
	speed: 0.0021s/iter; left time: 1.3638s
	iters: 500, epoch: 8 | loss: 0.1972264
	speed: 0.0021s/iter; left time: 1.1535s
	iters: 600, epoch: 8 | loss: 0.4180933
	speed: 0.0022s/iter; left time: 0.9795s
	iters: 700, epoch: 8 | loss: 0.1767617
	speed: 0.0022s/iter; left time: 0.7512s
	iters: 800, epoch: 8 | loss: 0.2810000
	speed: 0.0023s/iter; left time: 0.5650s
	iters: 900, epoch: 8 | loss: 0.2449319
	speed: 0.0023s/iter; left time: 0.3429s
	iters: 1000, epoch: 8 | loss: 0.5501878
	speed: 0.0024s/iter; left time: 0.1106s
Updating learning rate to 1.94149330390625e-06
Epoch: 8 cost time: 2.355774402618408
Epoch: 8, Steps: 1045 | Train Loss: 0.3414759 Vali Loss: 0.3069844 Best vali loss: 0.2812486

best validation loss 0.2812485851655001

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010455579744, 'e_layers': 2, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6895390
	speed: 0.0100s/iter; left time: 9.4861s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.3178).  Saving model state dict ...
Epoch: 1 cost time: 0.898099422454834
Epoch: 1, Steps: 131 | Train Loss: 0.6895390 Vali Loss: 0.3177605 Best vali loss: 0.3177605
	iters: 100, epoch: 2 | loss: 0.4182611
	speed: 0.0086s/iter; left time: 7.0162s
Updating learning rate to 0.0026738530511141692
Validation loss decreased (0.3178 --> 0.3092).  Saving model state dict ...
Epoch: 2 cost time: 0.6698036193847656
Epoch: 2, Steps: 131 | Train Loss: 0.4182611 Vali Loss: 0.3092369 Best vali loss: 0.3092369
	iters: 100, epoch: 3 | loss: 0.5982056
	speed: 0.0087s/iter; left time: 5.9756s
Updating learning rate to 0.002165706536403478
Validation loss decreased (0.3092 --> 0.3066).  Saving model state dict ...
Epoch: 3 cost time: 0.6731061935424805
Epoch: 3, Steps: 131 | Train Loss: 0.5982056 Vali Loss: 0.3065596 Best vali loss: 0.3065596
	iters: 100, epoch: 4 | loss: 0.4690255
	speed: 0.0086s/iter; left time: 4.7744s
Updating learning rate to 0.00156630685355
Validation loss decreased (0.3066 --> 0.3049).  Saving model state dict ...
Epoch: 4 cost time: 0.6761617660522461
Epoch: 4, Steps: 131 | Train Loss: 0.4690255 Vali Loss: 0.3048506 Best vali loss: 0.3048506
	iters: 100, epoch: 5 | loss: 0.4509936
	speed: 0.0086s/iter; left time: 3.6713s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 0.6724286079406738
Epoch: 5, Steps: 131 | Train Loss: 0.4509936 Vali Loss: 0.3232615 Best vali loss: 0.3048506
	iters: 100, epoch: 6 | loss: 0.3777263
	speed: 0.0084s/iter; left time: 2.4571s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 0.6709568500518799
Epoch: 6, Steps: 131 | Train Loss: 0.3777263 Vali Loss: 0.3345021 Best vali loss: 0.3048506
	iters: 100, epoch: 7 | loss: 0.3916743
	speed: 0.0083s/iter; left time: 1.3491s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 0.6686594486236572
Epoch: 7, Steps: 131 | Train Loss: 0.3916743 Vali Loss: 0.3446973 Best vali loss: 0.3048506
	iters: 100, epoch: 8 | loss: 0.5421095
	speed: 0.0083s/iter; left time: 0.2658s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6659836769104004
Epoch: 8, Steps: 131 | Train Loss: 0.5421095 Vali Loss: 0.3500532 Best vali loss: 0.3048506

best validation loss 0.3048505516533694

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014539170207, 'e_layers': 1, 'learning_rate': 0.0026890067218, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5842882
	speed: 0.0084s/iter; left time: 7.9952s
Updating learning rate to 0.0025866624974281455
Validation loss decreased (inf --> 0.2971).  Saving model state dict ...
Epoch: 1 cost time: 0.674527645111084
Epoch: 1, Steps: 131 | Train Loss: 0.5842882 Vali Loss: 0.2971261 Best vali loss: 0.2971261
	iters: 100, epoch: 2 | loss: 0.4214816
	speed: 0.0055s/iter; left time: 4.5065s
Updating learning rate to 0.002295210804720494
Validation loss decreased (0.2971 --> 0.2924).  Saving model state dict ...
Epoch: 2 cost time: 0.41460180282592773
Epoch: 2, Steps: 131 | Train Loss: 0.4214816 Vali Loss: 0.2924492 Best vali loss: 0.2924492
	iters: 100, epoch: 3 | loss: 0.6499908
	speed: 0.0055s/iter; left time: 3.7694s
Updating learning rate to 0.001859022521875611
Epoch: 3 cost time: 0.4201090335845947
Epoch: 3, Steps: 131 | Train Loss: 0.6499908 Vali Loss: 0.3001836 Best vali loss: 0.2924492
	iters: 100, epoch: 4 | loss: 0.6018677
	speed: 0.0055s/iter; left time: 3.0328s
Updating learning rate to 0.0013445033609
Epoch: 4 cost time: 0.425767183303833
Epoch: 4, Steps: 131 | Train Loss: 0.6018677 Vali Loss: 0.2971770 Best vali loss: 0.2924492
	iters: 100, epoch: 5 | loss: 0.3372373
	speed: 0.0054s/iter; left time: 2.2768s
Updating learning rate to 0.000829984199924389
Epoch: 5 cost time: 0.41413450241088867
Epoch: 5, Steps: 131 | Train Loss: 0.3372373 Vali Loss: 0.3166022 Best vali loss: 0.2924492
	iters: 100, epoch: 6 | loss: 0.3233844
	speed: 0.0055s/iter; left time: 1.6034s
Updating learning rate to 0.00039379591707950604
Epoch: 6 cost time: 0.41307759284973145
Epoch: 6, Steps: 131 | Train Loss: 0.3233844 Vali Loss: 0.3226285 Best vali loss: 0.2924492
	iters: 100, epoch: 7 | loss: 0.4052654
	speed: 0.0054s/iter; left time: 0.8777s
Updating learning rate to 0.00010234422437185415
Epoch: 7 cost time: 0.4152224063873291
Epoch: 7, Steps: 131 | Train Loss: 0.4052654 Vali Loss: 0.3326438 Best vali loss: 0.2924492
	iters: 100, epoch: 8 | loss: 0.3012086
	speed: 0.0055s/iter; left time: 0.1770s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4125549793243408
Epoch: 8, Steps: 131 | Train Loss: 0.3012086 Vali Loss: 0.3473337 Best vali loss: 0.2924492

best validation loss 0.2924492427211306

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0051563633661, 'e_layers': 4, 'learning_rate': 0.0001081267842, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4358929
	speed: 0.0102s/iter; left time: 41.6978s
	iters: 200, epoch: 1 | loss: 0.3226757
	speed: 0.0051s/iter; left time: 20.5097s
	iters: 300, epoch: 1 | loss: 1.4019547
	speed: 0.0051s/iter; left time: 19.9279s
	iters: 400, epoch: 1 | loss: 0.8311498
	speed: 0.0051s/iter; left time: 19.3173s
	iters: 500, epoch: 1 | loss: 0.3849358
	speed: 0.0051s/iter; left time: 18.7799s
Updating learning rate to 0.00010401145351932239
Validation loss decreased (inf --> 0.3048).  Saving model state dict ...
Epoch: 1 cost time: 2.9335851669311523
Epoch: 1, Steps: 523 | Train Loss: 0.6753218 Vali Loss: 0.3048445 Best vali loss: 0.3048445
	iters: 100, epoch: 2 | loss: 0.7715452
	speed: 0.0092s/iter; left time: 32.7496s
	iters: 200, epoch: 2 | loss: 0.2582426
	speed: 0.0044s/iter; left time: 15.2325s
	iters: 300, epoch: 2 | loss: 1.1777514
	speed: 0.0044s/iter; left time: 14.7725s
	iters: 400, epoch: 2 | loss: 0.3298565
	speed: 0.0044s/iter; left time: 14.2954s
	iters: 500, epoch: 2 | loss: 0.4147242
	speed: 0.0045s/iter; left time: 14.2989s
Updating learning rate to 9.229198326785722e-05
Validation loss decreased (0.3048 --> 0.2942).  Saving model state dict ...
Epoch: 2 cost time: 2.3558826446533203
Epoch: 2, Steps: 523 | Train Loss: 0.5904240 Vali Loss: 0.2942275 Best vali loss: 0.2942275
	iters: 100, epoch: 3 | loss: 0.4143919
	speed: 0.0091s/iter; left time: 27.7291s
	iters: 200, epoch: 3 | loss: 0.4464267
	speed: 0.0043s/iter; left time: 12.7130s
	iters: 300, epoch: 3 | loss: 0.5595812
	speed: 0.0043s/iter; left time: 12.3135s
	iters: 400, epoch: 3 | loss: 0.7459742
	speed: 0.0043s/iter; left time: 11.8007s
	iters: 500, epoch: 3 | loss: 1.4275142
	speed: 0.0043s/iter; left time: 11.3998s
Updating learning rate to 7.475255655412767e-05
Validation loss decreased (0.2942 --> 0.2888).  Saving model state dict ...
Epoch: 3 cost time: 2.29323410987854
Epoch: 3, Steps: 523 | Train Loss: 0.7187777 Vali Loss: 0.2887922 Best vali loss: 0.2887922

best validation loss 0.2887921775914604

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3678895
	speed: 0.0080s/iter; left time: 65.9797s
	iters: 200, epoch: 1 | loss: 1.5629160
	speed: 0.0030s/iter; left time: 24.7261s
	iters: 300, epoch: 1 | loss: 0.2213631
	speed: 0.0030s/iter; left time: 24.1925s
	iters: 400, epoch: 1 | loss: 0.1894414
	speed: 0.0030s/iter; left time: 23.9470s
	iters: 500, epoch: 1 | loss: 0.9318686
	speed: 0.0030s/iter; left time: 23.6559s
	iters: 600, epoch: 1 | loss: 0.5270708
	speed: 0.0030s/iter; left time: 23.2895s
	iters: 700, epoch: 1 | loss: 0.3532255
	speed: 0.0030s/iter; left time: 23.2089s
	iters: 800, epoch: 1 | loss: 0.8956394
	speed: 0.0030s/iter; left time: 22.7748s
	iters: 900, epoch: 1 | loss: 0.2563230
	speed: 0.0030s/iter; left time: 22.5347s
	iters: 1000, epoch: 1 | loss: 0.4939550
	speed: 0.0030s/iter; left time: 22.3563s
Updating learning rate to 0.0005849557155
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 3.4067673683166504
Epoch: 1, Steps: 1045 | Train Loss: 0.5799692 Vali Loss: 0.2852655 Best vali loss: 0.2852655
	iters: 100, epoch: 2 | loss: 0.2634806
	speed: 0.0096s/iter; left time: 69.0123s
	iters: 200, epoch: 2 | loss: 0.1831378
	speed: 0.0031s/iter; left time: 21.8088s
	iters: 300, epoch: 2 | loss: 0.3103816
	speed: 0.0031s/iter; left time: 21.7615s
	iters: 400, epoch: 2 | loss: 1.2050509
	speed: 0.0031s/iter; left time: 21.6721s
	iters: 500, epoch: 2 | loss: 0.8359732
	speed: 0.0032s/iter; left time: 21.5762s
	iters: 600, epoch: 2 | loss: 1.0482446
	speed: 0.0032s/iter; left time: 21.1772s
	iters: 700, epoch: 2 | loss: 0.5779238
	speed: 0.0032s/iter; left time: 21.0480s
	iters: 800, epoch: 2 | loss: 0.4072427
	speed: 0.0031s/iter; left time: 20.3664s
	iters: 900, epoch: 2 | loss: 0.3632905
	speed: 0.0030s/iter; left time: 19.4526s
	iters: 1000, epoch: 2 | loss: 0.2966986
	speed: 0.0031s/iter; left time: 19.8292s
Updating learning rate to 0.00029247785775
Validation loss decreased (0.2853 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 3.2866837978363037
Epoch: 2, Steps: 1045 | Train Loss: 0.5491424 Vali Loss: 0.2818517 Best vali loss: 0.2818517
	iters: 100, epoch: 3 | loss: 1.3444511
	speed: 0.0097s/iter; left time: 60.0421s
	iters: 200, epoch: 3 | loss: 0.2877151
	speed: 0.0031s/iter; left time: 18.5668s
	iters: 300, epoch: 3 | loss: 0.8316966
	speed: 0.0031s/iter; left time: 18.3882s
	iters: 400, epoch: 3 | loss: 0.3880877
	speed: 0.0031s/iter; left time: 17.9943s
	iters: 500, epoch: 3 | loss: 0.5955710
	speed: 0.0031s/iter; left time: 17.7730s
	iters: 600, epoch: 3 | loss: 0.4839004
	speed: 0.0031s/iter; left time: 17.4365s
	iters: 700, epoch: 3 | loss: 0.2213751
	speed: 0.0031s/iter; left time: 17.0155s
	iters: 800, epoch: 3 | loss: 0.2494425
	speed: 0.0031s/iter; left time: 16.8625s
	iters: 900, epoch: 3 | loss: 0.3614761
	speed: 0.0031s/iter; left time: 16.5768s
	iters: 1000, epoch: 3 | loss: 0.3954605
	speed: 0.0031s/iter; left time: 16.2054s
Updating learning rate to 0.000146238928875
Epoch: 3 cost time: 3.2434475421905518
Epoch: 3, Steps: 1045 | Train Loss: 0.5159176 Vali Loss: 0.2926868 Best vali loss: 0.2818517

best validation loss 0.2818517185811351

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3069940
	speed: 0.0103s/iter; left time: 85.1995s
	iters: 200, epoch: 1 | loss: 0.7160141
	speed: 0.0051s/iter; left time: 41.4772s
	iters: 300, epoch: 1 | loss: 0.3359448
	speed: 0.0051s/iter; left time: 41.0506s
	iters: 400, epoch: 1 | loss: 0.6916814
	speed: 0.0051s/iter; left time: 40.4614s
	iters: 500, epoch: 1 | loss: 0.4834152
	speed: 0.0051s/iter; left time: 39.7325s
	iters: 600, epoch: 1 | loss: 0.2117225
	speed: 0.0050s/iter; left time: 39.1601s
	iters: 700, epoch: 1 | loss: 1.2944843
	speed: 0.0051s/iter; left time: 38.7978s
	iters: 800, epoch: 1 | loss: 0.3726177
	speed: 0.0050s/iter; left time: 38.1788s
	iters: 900, epoch: 1 | loss: 0.4726994
	speed: 0.0051s/iter; left time: 37.8318s
	iters: 1000, epoch: 1 | loss: 0.8029683
	speed: 0.0050s/iter; left time: 37.1674s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.2893).  Saving model state dict ...
Epoch: 1 cost time: 5.553211688995361
Epoch: 1, Steps: 1045 | Train Loss: 0.5688542 Vali Loss: 0.2893076 Best vali loss: 0.2893076
	iters: 100, epoch: 2 | loss: 0.3171771
	speed: 0.0142s/iter; left time: 102.1183s
	iters: 200, epoch: 2 | loss: 0.8270590
	speed: 0.0050s/iter; left time: 35.4039s
	iters: 300, epoch: 2 | loss: 0.8260513
	speed: 0.0048s/iter; left time: 33.7527s
	iters: 400, epoch: 2 | loss: 0.5182074
	speed: 0.0048s/iter; left time: 33.4223s
	iters: 500, epoch: 2 | loss: 0.2265671
	speed: 0.0048s/iter; left time: 32.5499s
	iters: 600, epoch: 2 | loss: 0.4194104
	speed: 0.0046s/iter; left time: 31.1849s
	iters: 700, epoch: 2 | loss: 0.2538637
	speed: 0.0045s/iter; left time: 29.9046s
	iters: 800, epoch: 2 | loss: 1.5482407
	speed: 0.0046s/iter; left time: 29.8399s
	iters: 900, epoch: 2 | loss: 0.3702432
	speed: 0.0046s/iter; left time: 29.3138s
	iters: 1000, epoch: 2 | loss: 0.2178724
	speed: 0.0045s/iter; left time: 28.5719s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.2893 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 4.969723701477051
Epoch: 2, Steps: 1045 | Train Loss: 0.5524692 Vali Loss: 0.2829204 Best vali loss: 0.2829204
	iters: 100, epoch: 3 | loss: 0.9505225
	speed: 0.0130s/iter; left time: 80.3356s
	iters: 200, epoch: 3 | loss: 0.3140688
	speed: 0.0045s/iter; left time: 27.1566s
	iters: 300, epoch: 3 | loss: 0.3219434
	speed: 0.0044s/iter; left time: 26.3179s
	iters: 400, epoch: 3 | loss: 0.5950058
	speed: 0.0045s/iter; left time: 26.4027s
	iters: 500, epoch: 3 | loss: 0.3572009
	speed: 0.0045s/iter; left time: 25.7181s
	iters: 600, epoch: 3 | loss: 0.3118716
	speed: 0.0044s/iter; left time: 25.0938s
	iters: 700, epoch: 3 | loss: 0.3398941
	speed: 0.0044s/iter; left time: 24.6995s
	iters: 800, epoch: 3 | loss: 0.1339739
	speed: 0.0044s/iter; left time: 24.3239s
	iters: 900, epoch: 3 | loss: 0.2822660
	speed: 0.0044s/iter; left time: 23.6193s
	iters: 1000, epoch: 3 | loss: 0.5210187
	speed: 0.0045s/iter; left time: 23.6160s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 4.677869558334351
Epoch: 3, Steps: 1045 | Train Loss: 0.4127766 Vali Loss: 0.2841075 Best vali loss: 0.2829204

best validation loss 0.28292036942054277

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3244047
	speed: 0.0084s/iter; left time: 43.0879s
	iters: 200, epoch: 4 | loss: 1.5307930
	speed: 0.0030s/iter; left time: 15.0815s
	iters: 300, epoch: 4 | loss: 0.1896928
	speed: 0.0029s/iter; left time: 14.1161s
	iters: 400, epoch: 4 | loss: 0.1730139
	speed: 0.0028s/iter; left time: 13.6375s
	iters: 500, epoch: 4 | loss: 0.9195782
	speed: 0.0028s/iter; left time: 13.3718s
	iters: 600, epoch: 4 | loss: 0.4066714
	speed: 0.0028s/iter; left time: 13.1452s
	iters: 700, epoch: 4 | loss: 0.3517250
	speed: 0.0029s/iter; left time: 12.9226s
	iters: 800, epoch: 4 | loss: 0.7036605
	speed: 0.0029s/iter; left time: 12.6225s
	iters: 900, epoch: 4 | loss: 0.2369842
	speed: 0.0028s/iter; left time: 12.1998s
	iters: 1000, epoch: 4 | loss: 0.5200151
	speed: 0.0028s/iter; left time: 12.0324s
Updating learning rate to 7.31194644375e-05
Epoch: 4 cost time: 3.275224208831787
Epoch: 4, Steps: 1045 | Train Loss: 0.5356539 Vali Loss: 0.2933235 Best vali loss: 0.2818517
	iters: 100, epoch: 5 | loss: 0.2585767
	speed: 0.0098s/iter; left time: 39.8443s
	iters: 200, epoch: 5 | loss: 0.1861510
	speed: 0.0032s/iter; left time: 12.9369s
	iters: 300, epoch: 5 | loss: 0.2938263
	speed: 0.0033s/iter; left time: 12.7350s
	iters: 400, epoch: 5 | loss: 0.9798924
	speed: 0.0033s/iter; left time: 12.3191s
	iters: 500, epoch: 5 | loss: 0.7245126
	speed: 0.0032s/iter; left time: 11.9131s
	iters: 600, epoch: 5 | loss: 0.8986454
	speed: 0.0030s/iter; left time: 10.8147s
	iters: 700, epoch: 5 | loss: 0.5620949
	speed: 0.0030s/iter; left time: 10.3013s
	iters: 800, epoch: 5 | loss: 0.4050986
	speed: 0.0032s/iter; left time: 10.9103s
	iters: 900, epoch: 5 | loss: 0.3588828
	speed: 0.0033s/iter; left time: 10.7895s
	iters: 1000, epoch: 5 | loss: 0.2711468
	speed: 0.0032s/iter; left time: 10.3317s
Updating learning rate to 3.655973221875e-05
Epoch: 5 cost time: 3.3829691410064697
Epoch: 5, Steps: 1045 | Train Loss: 0.4938828 Vali Loss: 0.2940937 Best vali loss: 0.2818517
	iters: 100, epoch: 6 | loss: 1.2203807
	speed: 0.0099s/iter; left time: 30.0951s
	iters: 200, epoch: 6 | loss: 0.2792512
	speed: 0.0033s/iter; left time: 9.5738s
	iters: 300, epoch: 6 | loss: 0.8949463
	speed: 0.0032s/iter; left time: 9.1503s
	iters: 400, epoch: 6 | loss: 0.3747893
	speed: 0.0032s/iter; left time: 8.8228s
	iters: 500, epoch: 6 | loss: 0.5852917
	speed: 0.0032s/iter; left time: 8.5396s
	iters: 600, epoch: 6 | loss: 0.5047910
	speed: 0.0032s/iter; left time: 8.1656s
	iters: 700, epoch: 6 | loss: 0.2124850
	speed: 0.0032s/iter; left time: 7.8641s
	iters: 800, epoch: 6 | loss: 0.2062447
	speed: 0.0031s/iter; left time: 7.2680s
	iters: 900, epoch: 6 | loss: 0.3612870
	speed: 0.0031s/iter; left time: 6.8486s
	iters: 1000, epoch: 6 | loss: 0.3517829
	speed: 0.0031s/iter; left time: 6.5409s
Updating learning rate to 1.8279866109375e-05
Epoch: 6 cost time: 3.3670098781585693
Epoch: 6, Steps: 1045 | Train Loss: 0.4991250 Vali Loss: 0.2953640 Best vali loss: 0.2818517
	iters: 100, epoch: 7 | loss: 0.3446192
	speed: 0.0099s/iter; left time: 19.6989s
	iters: 200, epoch: 7 | loss: 0.1854776
	speed: 0.0033s/iter; left time: 6.2431s
	iters: 300, epoch: 7 | loss: 1.1671848
	speed: 0.0033s/iter; left time: 5.9363s
	iters: 400, epoch: 7 | loss: 0.7886814
	speed: 0.0033s/iter; left time: 5.6541s
	iters: 500, epoch: 7 | loss: 0.2296194
	speed: 0.0033s/iter; left time: 5.2855s
	iters: 600, epoch: 7 | loss: 0.4308701
	speed: 0.0033s/iter; left time: 4.9734s
	iters: 700, epoch: 7 | loss: 1.1821131
	speed: 0.0033s/iter; left time: 4.6127s
	iters: 800, epoch: 7 | loss: 0.7370149
	speed: 0.0031s/iter; left time: 4.0614s
	iters: 900, epoch: 7 | loss: 0.2470572
	speed: 0.0032s/iter; left time: 3.7747s
	iters: 1000, epoch: 7 | loss: 0.2272374
	speed: 0.0031s/iter; left time: 3.4164s
Updating learning rate to 9.1399330546875e-06
Epoch: 7 cost time: 3.4398062229156494
Epoch: 7, Steps: 1045 | Train Loss: 0.5539875 Vali Loss: 0.2952575 Best vali loss: 0.2818517
	iters: 100, epoch: 8 | loss: 0.4678749
	speed: 0.0098s/iter; left time: 9.2327s
	iters: 200, epoch: 8 | loss: 0.2949201
	speed: 0.0030s/iter; left time: 2.5462s
	iters: 300, epoch: 8 | loss: 0.3147559
	speed: 0.0030s/iter; left time: 2.2544s
	iters: 400, epoch: 8 | loss: 0.7131637
	speed: 0.0031s/iter; left time: 1.9757s
	iters: 500, epoch: 8 | loss: 0.3845416
	speed: 0.0030s/iter; left time: 1.6650s
	iters: 600, epoch: 8 | loss: 0.3914648
	speed: 0.0030s/iter; left time: 1.3566s
	iters: 700, epoch: 8 | loss: 1.0691088
	speed: 0.0031s/iter; left time: 1.0553s
	iters: 800, epoch: 8 | loss: 1.2215476
	speed: 0.0030s/iter; left time: 0.7502s
	iters: 900, epoch: 8 | loss: 0.6667264
	speed: 0.0030s/iter; left time: 0.4395s
	iters: 1000, epoch: 8 | loss: 0.1994583
	speed: 0.0030s/iter; left time: 0.1379s
Updating learning rate to 4.56996652734375e-06
Epoch: 8 cost time: 3.214154005050659
Epoch: 8, Steps: 1045 | Train Loss: 0.5723562 Vali Loss: 0.2950091 Best vali loss: 0.2818517

best validation loss 0.2818517185811351

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018403809852, 'e_layers': 2, 'learning_rate': 0.0001571149601, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7767588
	speed: 0.0091s/iter; left time: 8.6446s
Updating learning rate to 0.00015113512799385873
Validation loss decreased (inf --> 0.3059).  Saving model state dict ...
Epoch: 1 cost time: 0.7827036380767822
Epoch: 1, Steps: 131 | Train Loss: 0.7767588 Vali Loss: 0.3059375 Best vali loss: 0.3059375
	iters: 100, epoch: 2 | loss: 0.3233068
	speed: 0.0068s/iter; left time: 5.5559s
Updating learning rate to 0.0001341060069062819
Validation loss decreased (0.3059 --> 0.2892).  Saving model state dict ...
Epoch: 2 cost time: 0.5349507331848145
Epoch: 2, Steps: 131 | Train Loss: 0.3233068 Vali Loss: 0.2891615 Best vali loss: 0.2891615
	iters: 100, epoch: 3 | loss: 0.4580484
	speed: 0.0065s/iter; left time: 4.4364s
Updating learning rate to 0.00010862012615348607
Validation loss decreased (0.2892 --> 0.2844).  Saving model state dict ...
Epoch: 3 cost time: 0.522144079208374
Epoch: 3, Steps: 131 | Train Loss: 0.4580484 Vali Loss: 0.2843594 Best vali loss: 0.2843594
	iters: 100, epoch: 4 | loss: 0.5592247
	speed: 0.0066s/iter; left time: 3.6653s
Updating learning rate to 7.855748005e-05
Validation loss decreased (0.2844 --> 0.2820).  Saving model state dict ...
Epoch: 4 cost time: 0.5279529094696045
Epoch: 4, Steps: 131 | Train Loss: 0.5592247 Vali Loss: 0.2819846 Best vali loss: 0.2819846
	iters: 100, epoch: 5 | loss: 0.6377678
	speed: 0.0065s/iter; left time: 2.7719s
Updating learning rate to 4.849483394651394e-05
Validation loss decreased (0.2820 --> 0.2817).  Saving model state dict ...
Epoch: 5 cost time: 0.5167038440704346
Epoch: 5, Steps: 131 | Train Loss: 0.6377678 Vali Loss: 0.2816628 Best vali loss: 0.2816628
	iters: 100, epoch: 6 | loss: 0.7304971
	speed: 0.0063s/iter; left time: 1.8427s
Updating learning rate to 2.3008953193718083e-05
Validation loss decreased (0.2817 --> 0.2816).  Saving model state dict ...
Epoch: 6 cost time: 0.48760366439819336
Epoch: 6, Steps: 131 | Train Loss: 0.7304971 Vali Loss: 0.2816206 Best vali loss: 0.2816206
	iters: 100, epoch: 7 | loss: 0.6871402
	speed: 0.0063s/iter; left time: 1.0317s
Updating learning rate to 5.979832106141266e-06
Validation loss decreased (0.2816 --> 0.2816).  Saving model state dict ...
Epoch: 7 cost time: 0.49975013732910156
Epoch: 7, Steps: 131 | Train Loss: 0.6871402 Vali Loss: 0.2816001 Best vali loss: 0.2816001
	iters: 100, epoch: 8 | loss: 0.4701161
	speed: 0.0062s/iter; left time: 0.1986s
Updating learning rate to 0.0
Validation loss decreased (0.2816 --> 0.2816).  Saving model state dict ...
Epoch: 8 cost time: 0.4893355369567871
Epoch: 8, Steps: 131 | Train Loss: 0.4701161 Vali Loss: 0.2815723 Best vali loss: 0.2815723

best validation loss 0.28157232159263096

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0080579476276, 'e_layers': 1, 'learning_rate': 0.000985904912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4530058
	speed: 0.0078s/iter; left time: 15.6531s
	iters: 200, epoch: 1 | loss: 0.2863426
	speed: 0.0024s/iter; left time: 4.5540s
Updating learning rate to 0.000985904912
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 0.9085934162139893
Epoch: 1, Steps: 262 | Train Loss: 0.3696742 Vali Loss: 0.2827511 Best vali loss: 0.2827511
	iters: 100, epoch: 2 | loss: 0.4530943
	speed: 0.0058s/iter; left time: 10.1245s
	iters: 200, epoch: 2 | loss: 0.6210925
	speed: 0.0024s/iter; left time: 3.9325s
Updating learning rate to 0.000492952456
Epoch: 2 cost time: 0.664522647857666
Epoch: 2, Steps: 262 | Train Loss: 0.5370934 Vali Loss: 0.2912496 Best vali loss: 0.2827511
	iters: 100, epoch: 3 | loss: 0.3213900
	speed: 0.0058s/iter; left time: 8.6082s
	iters: 200, epoch: 3 | loss: 0.9803395
	speed: 0.0023s/iter; left time: 3.1176s
Updating learning rate to 0.000246476228
Epoch: 3 cost time: 0.6417322158813477
Epoch: 3, Steps: 262 | Train Loss: 0.6508648 Vali Loss: 0.2961689 Best vali loss: 0.2827511
	iters: 100, epoch: 4 | loss: 0.3248072
	speed: 0.0058s/iter; left time: 7.0405s
	iters: 200, epoch: 4 | loss: 0.8195405
	speed: 0.0025s/iter; left time: 2.7749s
Updating learning rate to 0.000123238114
Epoch: 4 cost time: 0.698082447052002
Epoch: 4, Steps: 262 | Train Loss: 0.5721738 Vali Loss: 0.2960160 Best vali loss: 0.2827511
	iters: 100, epoch: 5 | loss: 0.6957957
	speed: 0.0060s/iter; left time: 5.6696s
	iters: 200, epoch: 5 | loss: 0.3980846
	speed: 0.0024s/iter; left time: 2.0229s
Updating learning rate to 6.1619057e-05
Epoch: 5 cost time: 0.6484954357147217
Epoch: 5, Steps: 262 | Train Loss: 0.5469401 Vali Loss: 0.2988372 Best vali loss: 0.2827511
	iters: 100, epoch: 6 | loss: 0.2425754
	speed: 0.0058s/iter; left time: 3.9555s
	iters: 200, epoch: 6 | loss: 0.4446411
	speed: 0.0025s/iter; left time: 1.4436s
Updating learning rate to 3.08095285e-05
Epoch: 6 cost time: 0.6695306301116943
Epoch: 6, Steps: 262 | Train Loss: 0.3436082 Vali Loss: 0.2996590 Best vali loss: 0.2827511
	iters: 100, epoch: 7 | loss: 0.3372402
	speed: 0.0061s/iter; left time: 2.6102s
	iters: 200, epoch: 7 | loss: 0.3353003
	speed: 0.0025s/iter; left time: 0.8041s
Updating learning rate to 1.540476425e-05
Epoch: 7 cost time: 0.6925711631774902
Epoch: 7, Steps: 262 | Train Loss: 0.3362703 Vali Loss: 0.3010734 Best vali loss: 0.2827511
	iters: 100, epoch: 8 | loss: 0.3199435
	speed: 0.0058s/iter; left time: 0.9432s
	iters: 200, epoch: 8 | loss: 0.2895221
	speed: 0.0024s/iter; left time: 0.1481s
Updating learning rate to 7.702382125e-06
Epoch: 8 cost time: 0.648094892501831
Epoch: 8, Steps: 262 | Train Loss: 0.3047328 Vali Loss: 0.3007916 Best vali loss: 0.2827511

best validation loss 0.28275108392817594

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6476913
	speed: 0.0084s/iter; left time: 34.4673s
	iters: 200, epoch: 1 | loss: 1.0018134
	speed: 0.0032s/iter; left time: 12.6840s
	iters: 300, epoch: 1 | loss: 1.1051071
	speed: 0.0031s/iter; left time: 12.2318s
	iters: 400, epoch: 1 | loss: 0.5436990
	speed: 0.0031s/iter; left time: 11.8723s
	iters: 500, epoch: 1 | loss: 0.5829185
	speed: 0.0032s/iter; left time: 11.6661s
Updating learning rate to 0.0013504261128
Validation loss decreased (inf --> 0.3163).  Saving model state dict ...
Epoch: 1 cost time: 1.9219400882720947
Epoch: 1, Steps: 523 | Train Loss: 0.7762459 Vali Loss: 0.3162654 Best vali loss: 0.3162654
	iters: 100, epoch: 2 | loss: 0.3314176
	speed: 0.0068s/iter; left time: 24.3176s
	iters: 200, epoch: 2 | loss: 0.2363244
	speed: 0.0035s/iter; left time: 12.0274s
	iters: 300, epoch: 2 | loss: 0.7087943
	speed: 0.0035s/iter; left time: 11.8177s
	iters: 400, epoch: 2 | loss: 0.3531640
	speed: 0.0035s/iter; left time: 11.4681s
	iters: 500, epoch: 2 | loss: 1.1796858
	speed: 0.0035s/iter; left time: 11.0765s
Updating learning rate to 0.0006752130564
Validation loss decreased (0.3163 --> 0.2982).  Saving model state dict ...
Epoch: 2 cost time: 1.8101434707641602
Epoch: 2, Steps: 523 | Train Loss: 0.5618772 Vali Loss: 0.2982240 Best vali loss: 0.2982240
	iters: 100, epoch: 3 | loss: 0.2443831
	speed: 0.0077s/iter; left time: 23.4362s
	iters: 200, epoch: 3 | loss: 0.4208975
	speed: 0.0034s/iter; left time: 10.0762s
	iters: 300, epoch: 3 | loss: 0.7987425
	speed: 0.0035s/iter; left time: 9.8377s
	iters: 400, epoch: 3 | loss: 0.3686646
	speed: 0.0034s/iter; left time: 9.2620s
	iters: 500, epoch: 3 | loss: 0.4516321
	speed: 0.0031s/iter; left time: 8.2248s
Updating learning rate to 0.0003376065282
Validation loss decreased (0.2982 --> 0.2918).  Saving model state dict ...
Epoch: 3 cost time: 1.794555902481079
Epoch: 3, Steps: 523 | Train Loss: 0.4568640 Vali Loss: 0.2918390 Best vali loss: 0.2918390

best validation loss 0.29183897824924027

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4152627
	speed: 0.0085s/iter; left time: 34.5456s
	iters: 200, epoch: 1 | loss: 0.3628593
	speed: 0.0034s/iter; left time: 13.6639s
	iters: 300, epoch: 1 | loss: 0.2360252
	speed: 0.0034s/iter; left time: 13.2636s
	iters: 400, epoch: 1 | loss: 1.1788960
	speed: 0.0034s/iter; left time: 12.8523s
	iters: 500, epoch: 1 | loss: 0.2745637
	speed: 0.0034s/iter; left time: 12.5570s
Updating learning rate to 6.03650536e-05
Validation loss decreased (inf --> 0.2914).  Saving model state dict ...
Epoch: 1 cost time: 2.045902967453003
Epoch: 1, Steps: 523 | Train Loss: 0.4935214 Vali Loss: 0.2913869 Best vali loss: 0.2913869
	iters: 100, epoch: 2 | loss: 0.7309293
	speed: 0.0074s/iter; left time: 26.1918s
	iters: 200, epoch: 2 | loss: 0.3178225
	speed: 0.0033s/iter; left time: 11.4330s
	iters: 300, epoch: 2 | loss: 0.5117838
	speed: 0.0032s/iter; left time: 10.7198s
	iters: 400, epoch: 2 | loss: 1.0606099
	speed: 0.0033s/iter; left time: 10.6556s
	iters: 500, epoch: 2 | loss: 0.2431622
	speed: 0.0032s/iter; left time: 10.2312s
Updating learning rate to 3.01825268e-05
Validation loss decreased (0.2914 --> 0.2820).  Saving model state dict ...
Epoch: 2 cost time: 1.7415761947631836
Epoch: 2, Steps: 523 | Train Loss: 0.5728615 Vali Loss: 0.2819934 Best vali loss: 0.2819934
	iters: 100, epoch: 3 | loss: 0.5567221
	speed: 0.0074s/iter; left time: 22.4175s
	iters: 200, epoch: 3 | loss: 0.5248693
	speed: 0.0035s/iter; left time: 10.1884s
	iters: 300, epoch: 3 | loss: 0.5153313
	speed: 0.0035s/iter; left time: 9.8590s
	iters: 400, epoch: 3 | loss: 0.6770969
	speed: 0.0035s/iter; left time: 9.5358s
	iters: 500, epoch: 3 | loss: 0.3461235
	speed: 0.0035s/iter; left time: 9.1545s
Updating learning rate to 1.50912634e-05
Validation loss decreased (0.2820 --> 0.2798).  Saving model state dict ...
Epoch: 3 cost time: 1.853926181793213
Epoch: 3, Steps: 523 | Train Loss: 0.5240286 Vali Loss: 0.2798235 Best vali loss: 0.2798235

best validation loss 0.2798234822471685

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043939909637, 'e_layers': 2, 'learning_rate': 0.0005385073997, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4599387
	speed: 0.0092s/iter; left time: 8.7082s
Updating learning rate to 0.0005180116821943523
Validation loss decreased (inf --> 0.2943).  Saving model state dict ...
Epoch: 1 cost time: 0.7875607013702393
Epoch: 1, Steps: 131 | Train Loss: 0.4599387 Vali Loss: 0.2943333 Best vali loss: 0.2943333
	iters: 100, epoch: 2 | loss: 0.3075444
	speed: 0.0066s/iter; left time: 5.4041s
Updating learning rate to 0.00045964481687350226
Validation loss decreased (0.2943 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 0.5193531513214111
Epoch: 2, Steps: 131 | Train Loss: 0.3075444 Vali Loss: 0.2835376 Best vali loss: 0.2835376
	iters: 100, epoch: 3 | loss: 0.6116894
	speed: 0.0069s/iter; left time: 4.7657s
Updating learning rate to 0.0003722926298855977
Validation loss decreased (0.2835 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 0.5568022727966309
Epoch: 3, Steps: 131 | Train Loss: 0.6116894 Vali Loss: 0.2834512 Best vali loss: 0.2834512

best validation loss 0.2834512033247292

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3756551
	speed: 0.0085s/iter; left time: 21.2901s
	iters: 200, epoch: 4 | loss: 0.2913786
	speed: 0.0032s/iter; left time: 7.6129s
	iters: 300, epoch: 4 | loss: 0.2128215
	speed: 0.0034s/iter; left time: 7.7665s
	iters: 400, epoch: 4 | loss: 1.0646304
	speed: 0.0034s/iter; left time: 7.6344s
	iters: 500, epoch: 4 | loss: 0.2478335
	speed: 0.0033s/iter; left time: 6.8819s
Updating learning rate to 7.5456317e-06
Epoch: 4 cost time: 1.9961938858032227
Epoch: 4, Steps: 523 | Train Loss: 0.4384638 Vali Loss: 0.2807670 Best vali loss: 0.2798235
	iters: 100, epoch: 5 | loss: 0.7116468
	speed: 0.0072s/iter; left time: 14.3702s
	iters: 200, epoch: 5 | loss: 0.3108311
	speed: 0.0033s/iter; left time: 6.2274s
	iters: 300, epoch: 5 | loss: 0.4874862
	speed: 0.0033s/iter; left time: 5.8612s
	iters: 400, epoch: 5 | loss: 0.9335197
	speed: 0.0032s/iter; left time: 5.4596s
	iters: 500, epoch: 5 | loss: 0.2374259
	speed: 0.0033s/iter; left time: 5.1879s
Updating learning rate to 3.77281585e-06
Epoch: 5 cost time: 1.7366440296173096
Epoch: 5, Steps: 523 | Train Loss: 0.5361819 Vali Loss: 0.2801175 Best vali loss: 0.2798235
	iters: 100, epoch: 6 | loss: 0.4668577
	speed: 0.0073s/iter; left time: 10.7203s
	iters: 200, epoch: 6 | loss: 0.5373825
	speed: 0.0035s/iter; left time: 4.7661s
	iters: 300, epoch: 6 | loss: 0.5153546
	speed: 0.0035s/iter; left time: 4.4539s
	iters: 400, epoch: 6 | loss: 0.6670730
	speed: 0.0034s/iter; left time: 3.9605s
	iters: 500, epoch: 6 | loss: 0.3454838
	speed: 0.0032s/iter; left time: 3.4296s
Updating learning rate to 1.886407925e-06
Validation loss decreased (0.2798 --> 0.2797).  Saving model state dict ...
Epoch: 6 cost time: 1.8187642097473145
Epoch: 6, Steps: 523 | Train Loss: 0.5064303 Vali Loss: 0.2797228 Best vali loss: 0.2797228
	iters: 100, epoch: 7 | loss: 0.3984395
	speed: 0.0077s/iter; left time: 7.2526s
	iters: 200, epoch: 7 | loss: 0.3524072
	speed: 0.0034s/iter; left time: 2.9137s
	iters: 300, epoch: 7 | loss: 0.3233492
	speed: 0.0035s/iter; left time: 2.6154s
	iters: 400, epoch: 7 | loss: 0.6588251
	speed: 0.0035s/iter; left time: 2.2541s
	iters: 500, epoch: 7 | loss: 0.9078133
	speed: 0.0034s/iter; left time: 1.8640s
Updating learning rate to 9.432039625e-07
Validation loss decreased (0.2797 --> 0.2797).  Saving model state dict ...
Epoch: 7 cost time: 1.8451075553894043
Epoch: 7, Steps: 523 | Train Loss: 0.5281669 Vali Loss: 0.2796639 Best vali loss: 0.2796639
	iters: 100, epoch: 8 | loss: 0.2747935
	speed: 0.0071s/iter; left time: 2.9896s
	iters: 200, epoch: 8 | loss: 0.6528106
	speed: 0.0030s/iter; left time: 0.9686s
	iters: 300, epoch: 8 | loss: 0.6176918
	speed: 0.0031s/iter; left time: 0.7053s
	iters: 400, epoch: 8 | loss: 0.3616982
	speed: 0.0030s/iter; left time: 0.3706s
	iters: 500, epoch: 8 | loss: 0.3242999
	speed: 0.0030s/iter; left time: 0.0716s
Updating learning rate to 4.7160198125e-07
Validation loss decreased (0.2797 --> 0.2797).  Saving model state dict ...
Epoch: 8 cost time: 1.6200683116912842
Epoch: 8, Steps: 523 | Train Loss: 0.4462588 Vali Loss: 0.2796505 Best vali loss: 0.2796505

best validation loss 0.2796504802866113

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014453407321, 'e_layers': 1, 'learning_rate': 0.0019242997604, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2041682
	speed: 0.0075s/iter; left time: 62.3370s
	iters: 200, epoch: 1 | loss: 0.3018984
	speed: 0.0024s/iter; left time: 19.4086s
	iters: 300, epoch: 1 | loss: 0.2902188
	speed: 0.0024s/iter; left time: 19.3086s
	iters: 400, epoch: 1 | loss: 0.8372511
	speed: 0.0024s/iter; left time: 18.7947s
	iters: 500, epoch: 1 | loss: 0.3792474
	speed: 0.0024s/iter; left time: 18.4814s
	iters: 600, epoch: 1 | loss: 0.4801300
	speed: 0.0024s/iter; left time: 18.3644s
	iters: 700, epoch: 1 | loss: 0.7096649
	speed: 0.0024s/iter; left time: 18.0204s
	iters: 800, epoch: 1 | loss: 0.2964563
	speed: 0.0023s/iter; left time: 17.5764s
	iters: 900, epoch: 1 | loss: 0.2899633
	speed: 0.0024s/iter; left time: 17.9360s
	iters: 1000, epoch: 1 | loss: 0.4427981
	speed: 0.0024s/iter; left time: 17.4540s
Updating learning rate to 0.0018510604617249667
Validation loss decreased (inf --> 0.2919).  Saving model state dict ...
Epoch: 1 cost time: 2.732497453689575
Epoch: 1, Steps: 1045 | Train Loss: 0.4231796 Vali Loss: 0.2918794 Best vali loss: 0.2918794
	iters: 100, epoch: 2 | loss: 0.2427554
	speed: 0.0078s/iter; left time: 55.9792s
	iters: 200, epoch: 2 | loss: 0.2690833
	speed: 0.0023s/iter; left time: 16.2533s
	iters: 300, epoch: 2 | loss: 0.9075695
	speed: 0.0023s/iter; left time: 16.0237s
	iters: 400, epoch: 2 | loss: 0.3911276
	speed: 0.0023s/iter; left time: 15.7665s
	iters: 500, epoch: 2 | loss: 0.4054437
	speed: 0.0022s/iter; left time: 15.3011s
	iters: 600, epoch: 2 | loss: 0.6621495
	speed: 0.0023s/iter; left time: 15.4588s
	iters: 700, epoch: 2 | loss: 0.3254247
	speed: 0.0023s/iter; left time: 15.2616s
	iters: 800, epoch: 2 | loss: 0.2477472
	speed: 0.0022s/iter; left time: 14.6029s
	iters: 900, epoch: 2 | loss: 0.3666048
	speed: 0.0023s/iter; left time: 14.7066s
	iters: 1000, epoch: 2 | loss: 1.5811973
	speed: 0.0023s/iter; left time: 14.4526s
Updating learning rate to 0.0016424925850072444
Validation loss decreased (0.2919 --> 0.2878).  Saving model state dict ...
Epoch: 2 cost time: 2.4166250228881836
Epoch: 2, Steps: 1045 | Train Loss: 0.5399103 Vali Loss: 0.2878429 Best vali loss: 0.2878429
	iters: 100, epoch: 3 | loss: 0.3018001
	speed: 0.0080s/iter; left time: 49.4880s
	iters: 200, epoch: 3 | loss: 0.4222986
	speed: 0.0023s/iter; left time: 14.2133s
	iters: 300, epoch: 3 | loss: 0.2986836
	speed: 0.0023s/iter; left time: 13.9632s
	iters: 400, epoch: 3 | loss: 0.4830411
	speed: 0.0023s/iter; left time: 13.7559s
	iters: 500, epoch: 3 | loss: 0.2545235
	speed: 0.0023s/iter; left time: 13.3616s
	iters: 600, epoch: 3 | loss: 0.5770487
	speed: 0.0023s/iter; left time: 12.9753s
	iters: 700, epoch: 3 | loss: 0.4305030
	speed: 0.0024s/iter; left time: 13.1019s
	iters: 800, epoch: 3 | loss: 0.4702380
	speed: 0.0024s/iter; left time: 12.9090s
	iters: 900, epoch: 3 | loss: 0.2399778
	speed: 0.0023s/iter; left time: 12.4299s
	iters: 1000, epoch: 3 | loss: 1.1549203
	speed: 0.0023s/iter; left time: 12.0650s
Updating learning rate to 0.001330348698804596
Epoch: 3 cost time: 2.4648334980010986
Epoch: 3, Steps: 1045 | Train Loss: 0.4633035 Vali Loss: 0.2883516 Best vali loss: 0.2878429
	iters: 100, epoch: 4 | loss: 0.3504339
	speed: 0.0077s/iter; left time: 39.6597s
	iters: 200, epoch: 4 | loss: 0.3756984
	speed: 0.0024s/iter; left time: 11.8289s
	iters: 300, epoch: 4 | loss: 0.5024887
	speed: 0.0024s/iter; left time: 11.6845s
	iters: 400, epoch: 4 | loss: 0.5647088
	speed: 0.0023s/iter; left time: 11.2366s
	iters: 500, epoch: 4 | loss: 0.6274755
	speed: 0.0023s/iter; left time: 11.0343s
	iters: 600, epoch: 4 | loss: 0.3062673
	speed: 0.0023s/iter; left time: 10.7603s
	iters: 700, epoch: 4 | loss: 0.3180147
	speed: 0.0023s/iter; left time: 10.4604s
	iters: 800, epoch: 4 | loss: 0.1291716
	speed: 0.0023s/iter; left time: 10.1718s
	iters: 900, epoch: 4 | loss: 0.4203750
	speed: 0.0023s/iter; left time: 9.9974s
	iters: 1000, epoch: 4 | loss: 0.4004446
	speed: 0.0023s/iter; left time: 9.6922s
Updating learning rate to 0.0009621498802
Validation loss decreased (0.2878 --> 0.2862).  Saving model state dict ...
Epoch: 4 cost time: 2.464151382446289
Epoch: 4, Steps: 1045 | Train Loss: 0.3995079 Vali Loss: 0.2861838 Best vali loss: 0.2861838
	iters: 100, epoch: 5 | loss: 0.7365704
	speed: 0.0077s/iter; left time: 31.4118s
	iters: 200, epoch: 5 | loss: 1.0012618
	speed: 0.0020s/iter; left time: 8.1122s
	iters: 300, epoch: 5 | loss: 1.3956574
	speed: 0.0020s/iter; left time: 7.9092s
	iters: 400, epoch: 5 | loss: 1.0849445
	speed: 0.0020s/iter; left time: 7.7141s
	iters: 500, epoch: 5 | loss: 0.7528661
	speed: 0.0020s/iter; left time: 7.4813s
	iters: 600, epoch: 5 | loss: 0.1734083
	speed: 0.0020s/iter; left time: 7.2492s
	iters: 700, epoch: 5 | loss: 0.3016486
	speed: 0.0020s/iter; left time: 7.0441s
	iters: 800, epoch: 5 | loss: 0.5844678
	speed: 0.0020s/iter; left time: 6.8807s
	iters: 900, epoch: 5 | loss: 0.5476419
	speed: 0.0020s/iter; left time: 6.6716s
	iters: 1000, epoch: 5 | loss: 0.2056338
	speed: 0.0020s/iter; left time: 6.5013s
Updating learning rate to 0.0005939510615954041
Validation loss decreased (0.2862 --> 0.2832).  Saving model state dict ...
Epoch: 5 cost time: 2.16334867477417
Epoch: 5, Steps: 1045 | Train Loss: 0.6784101 Vali Loss: 0.2832049 Best vali loss: 0.2832049
	iters: 100, epoch: 6 | loss: 0.4822040
	speed: 0.0079s/iter; left time: 24.0799s
	iters: 200, epoch: 6 | loss: 0.5941361
	speed: 0.0024s/iter; left time: 7.0237s
	iters: 300, epoch: 6 | loss: 0.2216107
	speed: 0.0023s/iter; left time: 6.5841s
	iters: 400, epoch: 6 | loss: 0.8540969
	speed: 0.0024s/iter; left time: 6.6130s
	iters: 500, epoch: 6 | loss: 0.2146873
	speed: 0.0022s/iter; left time: 5.8206s
	iters: 600, epoch: 6 | loss: 0.7607507
	speed: 0.0022s/iter; left time: 5.5651s
	iters: 700, epoch: 6 | loss: 0.6004573
	speed: 0.0022s/iter; left time: 5.2994s
	iters: 800, epoch: 6 | loss: 0.2711955
	speed: 0.0021s/iter; left time: 4.9809s
	iters: 900, epoch: 6 | loss: 0.3333835
	speed: 0.0021s/iter; left time: 4.7969s
	iters: 1000, epoch: 6 | loss: 0.2638773
	speed: 0.0021s/iter; left time: 4.5183s
Updating learning rate to 0.0002818071753927558
Epoch: 6 cost time: 2.3852193355560303
Epoch: 6, Steps: 1045 | Train Loss: 0.4596399 Vali Loss: 0.2861922 Best vali loss: 0.2832049
	iters: 100, epoch: 7 | loss: 0.5936512
	speed: 0.0077s/iter; left time: 15.2395s
	iters: 200, epoch: 7 | loss: 0.7913257
	speed: 0.0022s/iter; left time: 4.0886s
	iters: 300, epoch: 7 | loss: 0.3550188
	speed: 0.0023s/iter; left time: 4.0624s
	iters: 400, epoch: 7 | loss: 0.1812241
	speed: 0.0022s/iter; left time: 3.6454s
	iters: 500, epoch: 7 | loss: 0.4551007
	speed: 0.0021s/iter; left time: 3.3523s
	iters: 600, epoch: 7 | loss: 0.3943557
	speed: 0.0021s/iter; left time: 3.1988s
	iters: 700, epoch: 7 | loss: 0.2343855
	speed: 0.0021s/iter; left time: 2.9681s
	iters: 800, epoch: 7 | loss: 0.9541851
	speed: 0.0021s/iter; left time: 2.6850s
	iters: 900, epoch: 7 | loss: 0.1769208
	speed: 0.0021s/iter; left time: 2.4792s
	iters: 1000, epoch: 7 | loss: 0.2141084
	speed: 0.0021s/iter; left time: 2.2515s
Updating learning rate to 7.323929867503346e-05
Epoch: 7 cost time: 2.270153522491455
Epoch: 7, Steps: 1045 | Train Loss: 0.4350276 Vali Loss: 0.2887165 Best vali loss: 0.2832049
	iters: 100, epoch: 8 | loss: 0.2043294
	speed: 0.0076s/iter; left time: 7.1673s
	iters: 200, epoch: 8 | loss: 0.2161387
	speed: 0.0021s/iter; left time: 1.7885s
	iters: 300, epoch: 8 | loss: 0.2705985
	speed: 0.0021s/iter; left time: 1.5725s
	iters: 400, epoch: 8 | loss: 0.1233915
	speed: 0.0021s/iter; left time: 1.3660s
	iters: 500, epoch: 8 | loss: 0.3187718
	speed: 0.0021s/iter; left time: 1.1535s
	iters: 600, epoch: 8 | loss: 0.3309042
	speed: 0.0021s/iter; left time: 0.9500s
	iters: 700, epoch: 8 | loss: 0.4672652
	speed: 0.0021s/iter; left time: 0.7398s
	iters: 800, epoch: 8 | loss: 0.3371083
	speed: 0.0021s/iter; left time: 0.5195s
	iters: 900, epoch: 8 | loss: 1.0097922
	speed: 0.0021s/iter; left time: 0.3123s
	iters: 1000, epoch: 8 | loss: 0.3627683
	speed: 0.0021s/iter; left time: 0.0977s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2562928199768066
Epoch: 8, Steps: 1045 | Train Loss: 0.3641068 Vali Loss: 0.2953471 Best vali loss: 0.2832049

best validation loss 0.2832049296974205

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0071113834238, 'e_layers': 4, 'learning_rate': 0.0001530715139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0347353
	speed: 0.0103s/iter; left time: 85.4513s
	iters: 200, epoch: 1 | loss: 1.3778374
	speed: 0.0052s/iter; left time: 42.4496s
	iters: 300, epoch: 1 | loss: 0.4484871
	speed: 0.0052s/iter; left time: 41.9006s
	iters: 400, epoch: 1 | loss: 0.3634848
	speed: 0.0052s/iter; left time: 41.7066s
	iters: 500, epoch: 1 | loss: 0.4991905
	speed: 0.0052s/iter; left time: 40.8813s
	iters: 600, epoch: 1 | loss: 0.6669850
	speed: 0.0051s/iter; left time: 39.8875s
	iters: 700, epoch: 1 | loss: 0.6935655
	speed: 0.0052s/iter; left time: 39.6274s
	iters: 800, epoch: 1 | loss: 0.2154196
	speed: 0.0051s/iter; left time: 38.7802s
	iters: 900, epoch: 1 | loss: 0.4252733
	speed: 0.0052s/iter; left time: 38.4941s
	iters: 1000, epoch: 1 | loss: 0.2043072
	speed: 0.0052s/iter; left time: 38.1466s
Updating learning rate to 0.0001472455763013635
Validation loss decreased (inf --> 0.2957).  Saving model state dict ...
Epoch: 1 cost time: 5.682470798492432
Epoch: 1, Steps: 1045 | Train Loss: 0.5929286 Vali Loss: 0.2956922 Best vali loss: 0.2956922
	iters: 100, epoch: 2 | loss: 0.3188627
	speed: 0.0147s/iter; left time: 106.0693s
	iters: 200, epoch: 2 | loss: 0.2461234
	speed: 0.0052s/iter; left time: 37.3244s
	iters: 300, epoch: 2 | loss: 0.3703886
	speed: 0.0052s/iter; left time: 36.4379s
	iters: 400, epoch: 2 | loss: 0.2261022
	speed: 0.0052s/iter; left time: 35.8953s
	iters: 500, epoch: 2 | loss: 0.2283921
	speed: 0.0053s/iter; left time: 35.7897s
	iters: 600, epoch: 2 | loss: 0.2969496
	speed: 0.0052s/iter; left time: 35.0377s
	iters: 700, epoch: 2 | loss: 0.4288467
	speed: 0.0052s/iter; left time: 34.4957s
	iters: 800, epoch: 2 | loss: 0.2883511
	speed: 0.0053s/iter; left time: 34.2690s
	iters: 900, epoch: 2 | loss: 0.2744459
	speed: 0.0053s/iter; left time: 33.6858s
	iters: 1000, epoch: 2 | loss: 0.4291531
	speed: 0.0052s/iter; left time: 33.1561s
Updating learning rate to 0.00013065470969259043
Validation loss decreased (0.2957 --> 0.2811).  Saving model state dict ...
Epoch: 2 cost time: 5.49053692817688
Epoch: 2, Steps: 1045 | Train Loss: 0.3107615 Vali Loss: 0.2811431 Best vali loss: 0.2811431
	iters: 100, epoch: 3 | loss: 0.3689490
	speed: 0.0148s/iter; left time: 91.0293s
	iters: 200, epoch: 3 | loss: 0.2391075
	speed: 0.0052s/iter; left time: 31.7988s
	iters: 300, epoch: 3 | loss: 0.3018256
	speed: 0.0052s/iter; left time: 31.2460s
	iters: 400, epoch: 3 | loss: 1.0316677
	speed: 0.0052s/iter; left time: 30.8100s
	iters: 500, epoch: 3 | loss: 0.4470127
	speed: 0.0052s/iter; left time: 30.1895s
	iters: 600, epoch: 3 | loss: 1.0246832
	speed: 0.0052s/iter; left time: 29.5379s
	iters: 700, epoch: 3 | loss: 0.3139029
	speed: 0.0050s/iter; left time: 27.8576s
	iters: 800, epoch: 3 | loss: 0.9000440
	speed: 0.0050s/iter; left time: 27.3167s
	iters: 900, epoch: 3 | loss: 0.4055191
	speed: 0.0050s/iter; left time: 26.7630s
	iters: 1000, epoch: 3 | loss: 0.2235647
	speed: 0.0052s/iter; left time: 27.3444s
Updating learning rate to 0.00010582472311828629
Validation loss decreased (0.2811 --> 0.2765).  Saving model state dict ...
Epoch: 3 cost time: 5.426625490188599
Epoch: 3, Steps: 1045 | Train Loss: 0.5256276 Vali Loss: 0.2765180 Best vali loss: 0.2765180
	iters: 100, epoch: 4 | loss: 0.1831831
	speed: 0.0151s/iter; left time: 77.2532s
	iters: 200, epoch: 4 | loss: 0.4658056
	speed: 0.0052s/iter; left time: 25.9770s
	iters: 300, epoch: 4 | loss: 0.5293064
	speed: 0.0052s/iter; left time: 25.4086s
	iters: 400, epoch: 4 | loss: 0.6437727
	speed: 0.0051s/iter; left time: 24.7196s
	iters: 500, epoch: 4 | loss: 0.4856394
	speed: 0.0052s/iter; left time: 24.4792s
	iters: 600, epoch: 4 | loss: 0.2828060
	speed: 0.0051s/iter; left time: 23.7811s
	iters: 700, epoch: 4 | loss: 0.2263026
	speed: 0.0052s/iter; left time: 23.3407s
	iters: 800, epoch: 4 | loss: 0.6758375
	speed: 0.0051s/iter; left time: 22.7333s
	iters: 900, epoch: 4 | loss: 0.4344373
	speed: 0.0052s/iter; left time: 22.5179s
	iters: 1000, epoch: 4 | loss: 0.5477504
	speed: 0.0052s/iter; left time: 22.0561s
Updating learning rate to 7.653575695e-05
Epoch: 4 cost time: 5.436959266662598
Epoch: 4, Steps: 1045 | Train Loss: 0.4474841 Vali Loss: 0.2939563 Best vali loss: 0.2765180
	iters: 100, epoch: 5 | loss: 0.2226240
	speed: 0.0140s/iter; left time: 57.2709s
	iters: 200, epoch: 5 | loss: 0.1802325
	speed: 0.0048s/iter; left time: 18.9723s
	iters: 300, epoch: 5 | loss: 0.4406786
	speed: 0.0047s/iter; left time: 18.3269s
	iters: 400, epoch: 5 | loss: 0.3137782
	speed: 0.0047s/iter; left time: 17.8756s
	iters: 500, epoch: 5 | loss: 0.1495615
	speed: 0.0049s/iter; left time: 17.8638s
	iters: 600, epoch: 5 | loss: 0.4317068
	speed: 0.0050s/iter; left time: 17.9757s
	iters: 700, epoch: 5 | loss: 0.1931317
	speed: 0.0050s/iter; left time: 17.4443s
	iters: 800, epoch: 5 | loss: 0.6588176
	speed: 0.0050s/iter; left time: 17.0182s
	iters: 900, epoch: 5 | loss: 0.2863601
	speed: 0.0050s/iter; left time: 16.4657s
	iters: 1000, epoch: 5 | loss: 0.6296928
	speed: 0.0050s/iter; left time: 16.0296s
Updating learning rate to 4.724679078171373e-05
Epoch: 5 cost time: 5.156205177307129
Epoch: 5, Steps: 1045 | Train Loss: 0.3506584 Vali Loss: 0.3052592 Best vali loss: 0.2765180
	iters: 100, epoch: 6 | loss: 0.2082292
	speed: 0.0142s/iter; left time: 43.1684s
	iters: 200, epoch: 6 | loss: 0.1431679
	speed: 0.0053s/iter; left time: 15.5935s
	iters: 300, epoch: 6 | loss: 0.2139082
	speed: 0.0053s/iter; left time: 15.1043s
	iters: 400, epoch: 6 | loss: 0.1628632
	speed: 0.0053s/iter; left time: 14.4007s
	iters: 500, epoch: 6 | loss: 0.3587361
	speed: 0.0053s/iter; left time: 13.9150s
	iters: 600, epoch: 6 | loss: 0.6502023
	speed: 0.0052s/iter; left time: 13.2309s
	iters: 700, epoch: 6 | loss: 0.4088570
	speed: 0.0052s/iter; left time: 12.7345s
	iters: 800, epoch: 6 | loss: 0.1571002
	speed: 0.0052s/iter; left time: 12.2582s
	iters: 900, epoch: 6 | loss: 0.2240321
	speed: 0.0052s/iter; left time: 11.7061s
	iters: 1000, epoch: 6 | loss: 0.2040600
	speed: 0.0052s/iter; left time: 11.1996s
Updating learning rate to 2.2416804207409573e-05
Epoch: 6 cost time: 5.540672063827515
Epoch: 6, Steps: 1045 | Train Loss: 0.2731156 Vali Loss: 0.3188553 Best vali loss: 0.2765180
	iters: 100, epoch: 7 | loss: 0.2855499
	speed: 0.0141s/iter; left time: 28.0165s
	iters: 200, epoch: 7 | loss: 0.1963649
	speed: 0.0052s/iter; left time: 9.7906s
	iters: 300, epoch: 7 | loss: 0.2757835
	speed: 0.0051s/iter; left time: 9.2147s
	iters: 400, epoch: 7 | loss: 0.4404425
	speed: 0.0052s/iter; left time: 8.8251s
	iters: 500, epoch: 7 | loss: 0.3753559
	speed: 0.0053s/iter; left time: 8.3705s
	iters: 600, epoch: 7 | loss: 0.1748189
	speed: 0.0052s/iter; left time: 7.7454s
	iters: 700, epoch: 7 | loss: 0.3540754
	speed: 0.0051s/iter; left time: 7.0920s
	iters: 800, epoch: 7 | loss: 0.3493892
	speed: 0.0051s/iter; left time: 6.6169s
	iters: 900, epoch: 7 | loss: 0.2789852
	speed: 0.0051s/iter; left time: 6.0852s
	iters: 1000, epoch: 7 | loss: 0.1852422
	speed: 0.0050s/iter; left time: 5.5077s
Updating learning rate to 5.825937598636536e-06
Epoch: 7 cost time: 5.418730020523071
Epoch: 7, Steps: 1045 | Train Loss: 0.2916008 Vali Loss: 0.3207476 Best vali loss: 0.2765180
	iters: 100, epoch: 8 | loss: 0.2353424
	speed: 0.0141s/iter; left time: 13.3809s
	iters: 200, epoch: 8 | loss: 0.6631747
	speed: 0.0053s/iter; left time: 4.4574s
	iters: 300, epoch: 8 | loss: 0.3852640
	speed: 0.0053s/iter; left time: 3.9201s
	iters: 400, epoch: 8 | loss: 0.2246985
	speed: 0.0053s/iter; left time: 3.4014s
	iters: 500, epoch: 8 | loss: 0.2027008
	speed: 0.0052s/iter; left time: 2.8664s
	iters: 600, epoch: 8 | loss: 0.5728770
	speed: 0.0053s/iter; left time: 2.3465s
	iters: 700, epoch: 8 | loss: 0.2492217
	speed: 0.0052s/iter; left time: 1.7948s
	iters: 800, epoch: 8 | loss: 0.1375572
	speed: 0.0052s/iter; left time: 1.2844s
	iters: 900, epoch: 8 | loss: 0.3484148
	speed: 0.0050s/iter; left time: 0.7353s
	iters: 1000, epoch: 8 | loss: 0.1565866
	speed: 0.0050s/iter; left time: 0.2287s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.4584574699401855
Epoch: 8, Steps: 1045 | Train Loss: 0.3175838 Vali Loss: 0.3262625 Best vali loss: 0.2765180

best validation loss 0.2765179920280764

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3739571
	speed: 0.0079s/iter; left time: 15.6870s
	iters: 200, epoch: 1 | loss: 0.5345845
	speed: 0.0028s/iter; left time: 5.2378s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.3036).  Saving model state dict ...
Epoch: 1 cost time: 0.9942259788513184
Epoch: 1, Steps: 262 | Train Loss: 0.4542708 Vali Loss: 0.3035677 Best vali loss: 0.3035677
	iters: 100, epoch: 2 | loss: 0.5760306
	speed: 0.0064s/iter; left time: 11.1632s
	iters: 200, epoch: 2 | loss: 0.5790679
	speed: 0.0025s/iter; left time: 4.1027s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.3036 --> 0.2888).  Saving model state dict ...
Epoch: 2 cost time: 0.6833574771881104
Epoch: 2, Steps: 262 | Train Loss: 0.5775492 Vali Loss: 0.2887876 Best vali loss: 0.2887876
	iters: 100, epoch: 3 | loss: 0.4256815
	speed: 0.0062s/iter; left time: 9.1494s
	iters: 200, epoch: 3 | loss: 0.5596389
	speed: 0.0024s/iter; left time: 3.2983s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.2888 --> 0.2837).  Saving model state dict ...
Epoch: 3 cost time: 0.6871240139007568
Epoch: 3, Steps: 262 | Train Loss: 0.4926602 Vali Loss: 0.2837497 Best vali loss: 0.2837497

best validation loss 0.28374966902553744

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020735604228, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.3122).  Saving model state dict ...
Epoch: 1 cost time: 0.5255208015441895
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3122029 Best vali loss: 0.3122029
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.3122 --> 0.2934).  Saving model state dict ...
Epoch: 2 cost time: 0.26152920722961426
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2933761 Best vali loss: 0.2933761
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.2934 --> 0.2882).  Saving model state dict ...
Epoch: 3 cost time: 0.26679396629333496
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2881821 Best vali loss: 0.2881821

best validation loss 0.2881821264738308

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062923252341, 'e_layers': 4, 'learning_rate': 0.0001977554099, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9038277
	speed: 0.0104s/iter; left time: 9.8770s
Updating learning rate to 0.00019022879277499492
Validation loss decreased (inf --> 0.3110).  Saving model state dict ...
Epoch: 1 cost time: 0.9442133903503418
Epoch: 1, Steps: 131 | Train Loss: 0.9038277 Vali Loss: 0.3109846 Best vali loss: 0.3109846
	iters: 100, epoch: 2 | loss: 0.4492104
	speed: 0.0090s/iter; left time: 7.3969s
Updating learning rate to 0.00016879480062830765
Validation loss decreased (0.3110 --> 0.2955).  Saving model state dict ...
Epoch: 2 cost time: 0.7745535373687744
Epoch: 2, Steps: 131 | Train Loss: 0.4492104 Vali Loss: 0.2955318 Best vali loss: 0.2955318
	iters: 100, epoch: 3 | loss: 0.5763675
	speed: 0.0093s/iter; left time: 6.3690s
Updating learning rate to 0.00013671656446464863
Validation loss decreased (0.2955 --> 0.2899).  Saving model state dict ...
Epoch: 3 cost time: 0.7850916385650635
Epoch: 3, Steps: 131 | Train Loss: 0.5763675 Vali Loss: 0.2898656 Best vali loss: 0.2898656

best validation loss 0.28986555298561056

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3249018
	speed: 0.0078s/iter; left time: 9.4201s
	iters: 200, epoch: 4 | loss: 0.4504870
	speed: 0.0025s/iter; left time: 2.7493s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.2837 --> 0.2815).  Saving model state dict ...
Epoch: 4 cost time: 0.9317646026611328
Epoch: 4, Steps: 262 | Train Loss: 0.3876944 Vali Loss: 0.2815410 Best vali loss: 0.2815410
	iters: 100, epoch: 5 | loss: 0.5324901
	speed: 0.0064s/iter; left time: 6.0586s
	iters: 200, epoch: 5 | loss: 0.5317346
	speed: 0.0028s/iter; left time: 2.4031s
Updating learning rate to 1.7856066821212585e-05
Epoch: 5 cost time: 0.7772417068481445
Epoch: 5, Steps: 262 | Train Loss: 0.5321123 Vali Loss: 0.2815493 Best vali loss: 0.2815410
	iters: 100, epoch: 6 | loss: 0.4179164
	speed: 0.0064s/iter; left time: 4.3736s
	iters: 200, epoch: 6 | loss: 0.5491838
	speed: 0.0024s/iter; left time: 1.4148s
Updating learning rate to 8.472024178210777e-06
Validation loss decreased (0.2815 --> 0.2810).  Saving model state dict ...
Epoch: 6 cost time: 0.678626537322998
Epoch: 6, Steps: 262 | Train Loss: 0.4835501 Vali Loss: 0.2809998 Best vali loss: 0.2809998
	iters: 100, epoch: 7 | loss: 0.2519532
	speed: 0.0060s/iter; left time: 2.5532s
	iters: 200, epoch: 7 | loss: 0.4580629
	speed: 0.0025s/iter; left time: 0.8126s
Updating learning rate to 2.2018073468332077e-06
Validation loss decreased (0.2810 --> 0.2808).  Saving model state dict ...
Epoch: 7 cost time: 0.6942040920257568
Epoch: 7, Steps: 262 | Train Loss: 0.3550081 Vali Loss: 0.2807666 Best vali loss: 0.2807666
	iters: 100, epoch: 8 | loss: 0.5558286
	speed: 0.0062s/iter; left time: 1.0034s
	iters: 200, epoch: 8 | loss: 0.6325952
	speed: 0.0026s/iter; left time: 0.1622s
Updating learning rate to 0.0
Validation loss decreased (0.2808 --> 0.2807).  Saving model state dict ...
Epoch: 8 cost time: 0.7086150646209717
Epoch: 8, Steps: 262 | Train Loss: 0.5942119 Vali Loss: 0.2807381 Best vali loss: 0.2807381

best validation loss 0.2807381335478283

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047327455259, 'e_layers': 4, 'learning_rate': 0.0038245816163, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6223182
	speed: 0.0108s/iter; left time: 10.2209s
Updating learning rate to 0.0038245816163
Validation loss decreased (inf --> 0.2930).  Saving model state dict ...
Epoch: 1 cost time: 1.000929832458496
Epoch: 1, Steps: 131 | Train Loss: 0.6223182 Vali Loss: 0.2930172 Best vali loss: 0.2930172
	iters: 100, epoch: 2 | loss: 0.3170852
	speed: 0.0090s/iter; left time: 7.3986s
Updating learning rate to 0.00191229080815
Validation loss decreased (0.2930 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 0.7288153171539307
Epoch: 2, Steps: 131 | Train Loss: 0.3170852 Vali Loss: 0.2871253 Best vali loss: 0.2871253
	iters: 100, epoch: 3 | loss: 0.2951165
	speed: 0.0091s/iter; left time: 6.2315s
Updating learning rate to 0.000956145404075
Epoch: 3 cost time: 0.7818124294281006
Epoch: 3, Steps: 131 | Train Loss: 0.2951165 Vali Loss: 0.3128140 Best vali loss: 0.2871253
	iters: 100, epoch: 4 | loss: 0.4828746
	speed: 0.0092s/iter; left time: 5.1263s
Updating learning rate to 0.0004780727020375
Epoch: 4 cost time: 0.7780630588531494
Epoch: 4, Steps: 131 | Train Loss: 0.4828746 Vali Loss: 0.3071511 Best vali loss: 0.2871253
	iters: 100, epoch: 5 | loss: 0.5867450
	speed: 0.0093s/iter; left time: 3.9550s
Updating learning rate to 0.00023903635101875
Epoch: 5 cost time: 0.7748653888702393
Epoch: 5, Steps: 131 | Train Loss: 0.5867450 Vali Loss: 0.3044873 Best vali loss: 0.2871253
	iters: 100, epoch: 6 | loss: 0.3507658
	speed: 0.0092s/iter; left time: 2.7030s
Updating learning rate to 0.000119518175509375
Epoch: 6 cost time: 0.7843973636627197
Epoch: 6, Steps: 131 | Train Loss: 0.3507658 Vali Loss: 0.3101267 Best vali loss: 0.2871253
	iters: 100, epoch: 7 | loss: 0.3706210
	speed: 0.0093s/iter; left time: 1.5137s
Updating learning rate to 5.97590877546875e-05
Epoch: 7 cost time: 0.7782392501831055
Epoch: 7, Steps: 131 | Train Loss: 0.3706210 Vali Loss: 0.3112837 Best vali loss: 0.2871253
	iters: 100, epoch: 8 | loss: 0.4209192
	speed: 0.0086s/iter; left time: 0.2761s
Updating learning rate to 2.987954387734375e-05
Epoch: 8 cost time: 0.7019908428192139
Epoch: 8, Steps: 131 | Train Loss: 0.4209192 Vali Loss: 0.3069898 Best vali loss: 0.2871253

best validation loss 0.2871253385934833

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0036637688578, 'e_layers': 3, 'learning_rate': 0.0032858943573, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3348263
	speed: 0.0096s/iter; left time: 39.1654s
	iters: 200, epoch: 1 | loss: 0.4935978
	speed: 0.0044s/iter; left time: 17.3630s
	iters: 300, epoch: 1 | loss: 1.2899482
	speed: 0.0044s/iter; left time: 17.0456s
	iters: 400, epoch: 1 | loss: 0.2570348
	speed: 0.0043s/iter; left time: 16.4343s
	iters: 500, epoch: 1 | loss: 0.3179163
	speed: 0.0044s/iter; left time: 16.0948s
Updating learning rate to 0.0032858943573
Validation loss decreased (inf --> 0.3210).  Saving model state dict ...
Epoch: 1 cost time: 2.5507607460021973
Epoch: 1, Steps: 523 | Train Loss: 0.5386647 Vali Loss: 0.3209995 Best vali loss: 0.3209995
	iters: 100, epoch: 2 | loss: 0.7436612
	speed: 0.0090s/iter; left time: 32.2077s
	iters: 200, epoch: 2 | loss: 0.2645369
	speed: 0.0044s/iter; left time: 15.3471s
	iters: 300, epoch: 2 | loss: 0.4890696
	speed: 0.0044s/iter; left time: 14.8521s
	iters: 400, epoch: 2 | loss: 0.9157817
	speed: 0.0044s/iter; left time: 14.4251s
	iters: 500, epoch: 2 | loss: 0.3871571
	speed: 0.0044s/iter; left time: 13.9018s
Updating learning rate to 0.00164294717865
Epoch: 2 cost time: 2.3479931354522705
Epoch: 2, Steps: 523 | Train Loss: 0.5600413 Vali Loss: 0.3385580 Best vali loss: 0.3209995
	iters: 100, epoch: 3 | loss: 0.6209019
	speed: 0.0089s/iter; left time: 26.8985s
	iters: 200, epoch: 3 | loss: 0.8058877
	speed: 0.0044s/iter; left time: 13.0193s
	iters: 300, epoch: 3 | loss: 0.2174796
	speed: 0.0044s/iter; left time: 12.5852s
	iters: 400, epoch: 3 | loss: 0.7942587
	speed: 0.0044s/iter; left time: 12.0635s
	iters: 500, epoch: 3 | loss: 0.5269365
	speed: 0.0044s/iter; left time: 11.6277s
Updating learning rate to 0.000821473589325
Validation loss decreased (0.3210 --> 0.3201).  Saving model state dict ...
Epoch: 3 cost time: 2.3416378498077393
Epoch: 3, Steps: 523 | Train Loss: 0.5930929 Vali Loss: 0.3201070 Best vali loss: 0.3201070
	iters: 100, epoch: 4 | loss: 0.6584274
	speed: 0.0091s/iter; left time: 22.7975s
	iters: 200, epoch: 4 | loss: 0.3756375
	speed: 0.0044s/iter; left time: 10.6519s
	iters: 300, epoch: 4 | loss: 0.5752336
	speed: 0.0044s/iter; left time: 10.2708s
	iters: 400, epoch: 4 | loss: 0.5022349
	speed: 0.0044s/iter; left time: 9.7385s
	iters: 500, epoch: 4 | loss: 0.4305148
	speed: 0.0044s/iter; left time: 9.3827s
Updating learning rate to 0.0004107367946625
Epoch: 4 cost time: 2.35022234916687
Epoch: 4, Steps: 523 | Train Loss: 0.5084096 Vali Loss: 0.3211351 Best vali loss: 0.3201070
	iters: 100, epoch: 5 | loss: 0.3792964
	speed: 0.0085s/iter; left time: 16.8880s
	iters: 200, epoch: 5 | loss: 0.4459175
	speed: 0.0040s/iter; left time: 7.5305s
	iters: 300, epoch: 5 | loss: 0.3475015
	speed: 0.0039s/iter; left time: 7.0780s
	iters: 400, epoch: 5 | loss: 0.6163107
	speed: 0.0042s/iter; left time: 7.1575s
	iters: 500, epoch: 5 | loss: 0.8548920
	speed: 0.0042s/iter; left time: 6.6879s
Updating learning rate to 0.00020536839733125
Epoch: 5 cost time: 2.171323299407959
Epoch: 5, Steps: 523 | Train Loss: 0.5287836 Vali Loss: 0.3229186 Best vali loss: 0.3201070
	iters: 100, epoch: 6 | loss: 0.9066527
	speed: 0.0086s/iter; left time: 12.6866s
	iters: 200, epoch: 6 | loss: 0.3892691
	speed: 0.0040s/iter; left time: 5.5426s
	iters: 300, epoch: 6 | loss: 1.8235619
	speed: 0.0043s/iter; left time: 5.4175s
	iters: 400, epoch: 6 | loss: 1.2455000
	speed: 0.0044s/iter; left time: 5.1451s
	iters: 500, epoch: 6 | loss: 0.4546807
	speed: 0.0044s/iter; left time: 4.7259s
Updating learning rate to 0.000102684198665625
Validation loss decreased (0.3201 --> 0.3160).  Saving model state dict ...
Epoch: 6 cost time: 2.2711732387542725
Epoch: 6, Steps: 523 | Train Loss: 0.9639329 Vali Loss: 0.3160013 Best vali loss: 0.3160013
	iters: 100, epoch: 7 | loss: 0.9898558
	speed: 0.0090s/iter; left time: 8.5448s
	iters: 200, epoch: 7 | loss: 0.3543104
	speed: 0.0044s/iter; left time: 3.7180s
	iters: 300, epoch: 7 | loss: 0.2265487
	speed: 0.0044s/iter; left time: 3.2780s
	iters: 400, epoch: 7 | loss: 0.4029973
	speed: 0.0044s/iter; left time: 2.8506s
	iters: 500, epoch: 7 | loss: 0.3976063
	speed: 0.0044s/iter; left time: 2.4080s
Updating learning rate to 5.13420993328125e-05
Epoch: 7 cost time: 2.326063871383667
Epoch: 7, Steps: 523 | Train Loss: 0.4742637 Vali Loss: 0.3168897 Best vali loss: 0.3160013
	iters: 100, epoch: 8 | loss: 0.6454947
	speed: 0.0089s/iter; left time: 3.7773s
	iters: 200, epoch: 8 | loss: 0.8445251
	speed: 0.0044s/iter; left time: 1.4310s
	iters: 300, epoch: 8 | loss: 0.6037309
	speed: 0.0043s/iter; left time: 0.9744s
	iters: 400, epoch: 8 | loss: 0.5635529
	speed: 0.0044s/iter; left time: 0.5426s
	iters: 500, epoch: 8 | loss: 0.7618927
	speed: 0.0044s/iter; left time: 0.1053s
Updating learning rate to 2.567104966640625e-05
Validation loss decreased (0.3160 --> 0.3138).  Saving model state dict ...
Epoch: 8 cost time: 2.336088180541992
Epoch: 8, Steps: 523 | Train Loss: 0.6838392 Vali Loss: 0.3137813 Best vali loss: 0.3137813

best validation loss 0.3137813256149533

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029231680578149597
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 0.6213970184326172
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2844891 Best vali loss: 0.2844891
Updating learning rate to 0.0025938006666821026
Epoch: 2 cost time: 0.37583422660827637
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2979211 Best vali loss: 0.2844891
Updating learning rate to 0.0021008675310785706
Epoch: 3 cost time: 0.3787562847137451
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2966625 Best vali loss: 0.2844891

best validation loss 0.284489135919073

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0118662500741, 'e_layers': 3, 'learning_rate': 0.0003750615196, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036078659049551044
Validation loss decreased (inf --> 0.3099).  Saving model state dict ...
Epoch: 1 cost time: 0.6110050678253174
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3098542 Best vali loss: 0.3098542
Updating learning rate to 0.0003201350317356456
Validation loss decreased (0.3099 --> 0.2950).  Saving model state dict ...
Epoch: 2 cost time: 0.3755652904510498
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2949947 Best vali loss: 0.2949947
Updating learning rate to 0.0002592956746342972
Validation loss decreased (0.2950 --> 0.2884).  Saving model state dict ...
Epoch: 3 cost time: 0.37324047088623047
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2883537 Best vali loss: 0.2883537

best validation loss 0.288353663288381

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047627831688, 'e_layers': 3, 'learning_rate': 0.0015982189843, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3456298
	speed: 0.0091s/iter; left time: 75.4742s
	iters: 200, epoch: 1 | loss: 0.6207887
	speed: 0.0041s/iter; left time: 33.3847s
	iters: 300, epoch: 1 | loss: 1.4418938
	speed: 0.0040s/iter; left time: 32.5734s
	iters: 400, epoch: 1 | loss: 0.5204382
	speed: 0.0040s/iter; left time: 31.8430s
	iters: 500, epoch: 1 | loss: 0.3721840
	speed: 0.0040s/iter; left time: 31.8312s
	iters: 600, epoch: 1 | loss: 0.4233451
	speed: 0.0040s/iter; left time: 31.2276s
	iters: 700, epoch: 1 | loss: 0.2989387
	speed: 0.0040s/iter; left time: 30.7177s
	iters: 800, epoch: 1 | loss: 0.2774506
	speed: 0.0040s/iter; left time: 30.1685s
	iters: 900, epoch: 1 | loss: 0.3489625
	speed: 0.0040s/iter; left time: 29.8514s
	iters: 1000, epoch: 1 | loss: 1.4756680
	speed: 0.0039s/iter; left time: 28.5520s
Updating learning rate to 0.0015373903961828739
Validation loss decreased (inf --> 0.3111).  Saving model state dict ...
Epoch: 1 cost time: 4.442089080810547
Epoch: 1, Steps: 1045 | Train Loss: 0.6125299 Vali Loss: 0.3110584 Best vali loss: 0.3110584
	iters: 100, epoch: 2 | loss: 0.3562438
	speed: 0.0111s/iter; left time: 79.9903s
	iters: 200, epoch: 2 | loss: 0.3827204
	speed: 0.0035s/iter; left time: 24.8499s
	iters: 300, epoch: 2 | loss: 0.4621831
	speed: 0.0035s/iter; left time: 24.6672s
	iters: 400, epoch: 2 | loss: 0.2600561
	speed: 0.0035s/iter; left time: 24.3336s
	iters: 500, epoch: 2 | loss: 0.3059216
	speed: 0.0035s/iter; left time: 23.6810s
	iters: 600, epoch: 2 | loss: 0.3909353
	speed: 0.0035s/iter; left time: 23.5139s
	iters: 700, epoch: 2 | loss: 0.2826139
	speed: 0.0035s/iter; left time: 23.3030s
	iters: 800, epoch: 2 | loss: 0.1868465
	speed: 0.0035s/iter; left time: 22.8923s
	iters: 900, epoch: 2 | loss: 1.0140308
	speed: 0.0035s/iter; left time: 22.6668s
	iters: 1000, epoch: 2 | loss: 0.2136168
	speed: 0.0035s/iter; left time: 21.8139s
Updating learning rate to 0.0013641652329598032
Epoch: 2 cost time: 3.69785475730896
Epoch: 2, Steps: 1045 | Train Loss: 0.3855168 Vali Loss: 0.3247771 Best vali loss: 0.3110584
	iters: 100, epoch: 3 | loss: 0.4657565
	speed: 0.0110s/iter; left time: 67.9488s
	iters: 200, epoch: 3 | loss: 0.3462403
	speed: 0.0036s/iter; left time: 22.0189s
	iters: 300, epoch: 3 | loss: 0.7139332
	speed: 0.0035s/iter; left time: 21.1841s
	iters: 400, epoch: 3 | loss: 1.2751977
	speed: 0.0036s/iter; left time: 21.3027s
	iters: 500, epoch: 3 | loss: 0.5095896
	speed: 0.0037s/iter; left time: 21.3568s
	iters: 600, epoch: 3 | loss: 1.6670507
	speed: 0.0037s/iter; left time: 21.2517s
	iters: 700, epoch: 3 | loss: 1.2906184
	speed: 0.0036s/iter; left time: 20.1147s
	iters: 800, epoch: 3 | loss: 0.3160153
	speed: 0.0035s/iter; left time: 19.2114s
	iters: 900, epoch: 3 | loss: 0.3539768
	speed: 0.0035s/iter; left time: 19.0292s
	iters: 1000, epoch: 3 | loss: 0.4042688
	speed: 0.0035s/iter; left time: 18.5235s
Updating learning rate to 0.0011049154554414859
Epoch: 3 cost time: 3.794367551803589
Epoch: 3, Steps: 1045 | Train Loss: 0.7342647 Vali Loss: 0.3253417 Best vali loss: 0.3110584

best validation loss 0.3110583741488001

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00151941325245
Epoch: 4 cost time: 0.6143574714660645
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2916532 Best vali loss: 0.2844891
Updating learning rate to 0.0009379589738214294
Epoch: 5 cost time: 0.3854963779449463
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2945779 Best vali loss: 0.2844891
Updating learning rate to 0.0004450258382178974
Epoch: 6 cost time: 0.3731551170349121
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3040063 Best vali loss: 0.2844891
Updating learning rate to 0.0001156584470850403
Epoch: 7 cost time: 0.34733128547668457
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3011893 Best vali loss: 0.2844891
Updating learning rate to 0.0
Epoch: 8 cost time: 0.35078954696655273
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2997112 Best vali loss: 0.2844891

best validation loss 0.284489135919073

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0013602383229, 'e_layers': 1, 'learning_rate': 0.0004227075832, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2927373
	speed: 0.0076s/iter; left time: 63.0964s
	iters: 200, epoch: 1 | loss: 0.2847356
	speed: 0.0024s/iter; left time: 19.2689s
	iters: 300, epoch: 1 | loss: 1.2182968
	speed: 0.0024s/iter; left time: 18.9787s
	iters: 400, epoch: 1 | loss: 0.2678319
	speed: 0.0024s/iter; left time: 18.9684s
	iters: 500, epoch: 1 | loss: 1.5518409
	speed: 0.0023s/iter; left time: 18.1691s
	iters: 600, epoch: 1 | loss: 0.2766273
	speed: 0.0023s/iter; left time: 17.7486s
	iters: 700, epoch: 1 | loss: 0.2707927
	speed: 0.0023s/iter; left time: 17.9478s
	iters: 800, epoch: 1 | loss: 0.2746958
	speed: 0.0024s/iter; left time: 17.8512s
	iters: 900, epoch: 1 | loss: 0.1975908
	speed: 0.0024s/iter; left time: 17.7617s
	iters: 1000, epoch: 1 | loss: 0.5066796
	speed: 0.0024s/iter; left time: 17.7458s
Updating learning rate to 0.0004227075832
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 2.727442502975464
Epoch: 1, Steps: 1045 | Train Loss: 0.5141829 Vali Loss: 0.2813525 Best vali loss: 0.2813525
	iters: 100, epoch: 2 | loss: 1.0725453
	speed: 0.0078s/iter; left time: 56.2915s
	iters: 200, epoch: 2 | loss: 0.4743695
	speed: 0.0021s/iter; left time: 14.8937s
	iters: 300, epoch: 2 | loss: 0.3736897
	speed: 0.0021s/iter; left time: 14.7721s
	iters: 400, epoch: 2 | loss: 0.3027532
	speed: 0.0021s/iter; left time: 14.3804s
	iters: 500, epoch: 2 | loss: 0.2969264
	speed: 0.0021s/iter; left time: 14.1301s
	iters: 600, epoch: 2 | loss: 0.5306447
	speed: 0.0021s/iter; left time: 13.8870s
	iters: 700, epoch: 2 | loss: 0.3464064
	speed: 0.0021s/iter; left time: 13.7895s
	iters: 800, epoch: 2 | loss: 0.2555178
	speed: 0.0021s/iter; left time: 13.5757s
	iters: 900, epoch: 2 | loss: 0.6718009
	speed: 0.0021s/iter; left time: 13.3946s
	iters: 1000, epoch: 2 | loss: 0.2026015
	speed: 0.0021s/iter; left time: 13.1217s
Updating learning rate to 0.0002113537916
Epoch: 2 cost time: 2.218083381652832
Epoch: 2, Steps: 1045 | Train Loss: 0.4527255 Vali Loss: 0.2858851 Best vali loss: 0.2813525
	iters: 100, epoch: 3 | loss: 0.3010548
	speed: 0.0080s/iter; left time: 49.3249s
	iters: 200, epoch: 3 | loss: 0.4308450
	speed: 0.0024s/iter; left time: 14.3266s
	iters: 300, epoch: 3 | loss: 0.4792958
	speed: 0.0024s/iter; left time: 14.1286s
	iters: 400, epoch: 3 | loss: 0.3683090
	speed: 0.0024s/iter; left time: 13.9123s
	iters: 500, epoch: 3 | loss: 0.3309884
	speed: 0.0024s/iter; left time: 13.6511s
	iters: 600, epoch: 3 | loss: 0.6303920
	speed: 0.0024s/iter; left time: 13.5097s
	iters: 700, epoch: 3 | loss: 0.4478395
	speed: 0.0024s/iter; left time: 13.2757s
	iters: 800, epoch: 3 | loss: 1.1700550
	speed: 0.0024s/iter; left time: 12.9027s
	iters: 900, epoch: 3 | loss: 0.3850287
	speed: 0.0024s/iter; left time: 12.7143s
	iters: 1000, epoch: 3 | loss: 0.3027028
	speed: 0.0024s/iter; left time: 12.7779s
Updating learning rate to 0.0001056768958
Epoch: 3 cost time: 2.5236623287200928
Epoch: 3, Steps: 1045 | Train Loss: 0.4846511 Vali Loss: 0.2882886 Best vali loss: 0.2813525
	iters: 100, epoch: 4 | loss: 0.4462199
	speed: 0.0078s/iter; left time: 39.9549s
	iters: 200, epoch: 4 | loss: 0.2520882
	speed: 0.0021s/iter; left time: 10.3043s
	iters: 300, epoch: 4 | loss: 0.1532318
	speed: 0.0021s/iter; left time: 10.1843s
	iters: 400, epoch: 4 | loss: 0.1762446
	speed: 0.0022s/iter; left time: 10.8160s
	iters: 500, epoch: 4 | loss: 0.2656897
	speed: 0.0020s/iter; left time: 9.5184s
	iters: 600, epoch: 4 | loss: 0.2886161
	speed: 0.0020s/iter; left time: 9.2523s
	iters: 700, epoch: 4 | loss: 0.3667814
	speed: 0.0020s/iter; left time: 9.0549s
	iters: 800, epoch: 4 | loss: 0.2229310
	speed: 0.0020s/iter; left time: 8.8528s
	iters: 900, epoch: 4 | loss: 0.3994882
	speed: 0.0020s/iter; left time: 8.6512s
	iters: 1000, epoch: 4 | loss: 0.5951764
	speed: 0.0020s/iter; left time: 8.4940s
Updating learning rate to 5.28384479e-05
Epoch: 4 cost time: 2.170413017272949
Epoch: 4, Steps: 1045 | Train Loss: 0.3166467 Vali Loss: 0.2923917 Best vali loss: 0.2813525
	iters: 100, epoch: 5 | loss: 0.2283742
	speed: 0.0074s/iter; left time: 30.2883s
	iters: 200, epoch: 5 | loss: 0.5324989
	speed: 0.0021s/iter; left time: 8.4725s
	iters: 300, epoch: 5 | loss: 0.3947540
	speed: 0.0021s/iter; left time: 8.1568s
	iters: 400, epoch: 5 | loss: 0.6477770
	speed: 0.0021s/iter; left time: 7.8623s
	iters: 500, epoch: 5 | loss: 0.7087433
	speed: 0.0021s/iter; left time: 7.6895s
	iters: 600, epoch: 5 | loss: 0.2546003
	speed: 0.0021s/iter; left time: 7.3438s
	iters: 700, epoch: 5 | loss: 0.1797115
	speed: 0.0020s/iter; left time: 7.1292s
	iters: 800, epoch: 5 | loss: 0.2463692
	speed: 0.0021s/iter; left time: 7.1100s
	iters: 900, epoch: 5 | loss: 0.2885793
	speed: 0.0021s/iter; left time: 6.9645s
	iters: 1000, epoch: 5 | loss: 0.4454895
	speed: 0.0020s/iter; left time: 6.3826s
Updating learning rate to 2.641922395e-05
Epoch: 5 cost time: 2.2131288051605225
Epoch: 5, Steps: 1045 | Train Loss: 0.3926897 Vali Loss: 0.2980961 Best vali loss: 0.2813525
	iters: 100, epoch: 6 | loss: 0.1469164
	speed: 0.0080s/iter; left time: 24.1436s
	iters: 200, epoch: 6 | loss: 0.1654114
	speed: 0.0022s/iter; left time: 6.3638s
	iters: 300, epoch: 6 | loss: 0.6616565
	speed: 0.0021s/iter; left time: 5.8463s
	iters: 400, epoch: 6 | loss: 0.4262793
	speed: 0.0021s/iter; left time: 5.7724s
	iters: 500, epoch: 6 | loss: 0.3474383
	speed: 0.0021s/iter; left time: 5.6661s
	iters: 600, epoch: 6 | loss: 0.4548902
	speed: 0.0021s/iter; left time: 5.2762s
	iters: 700, epoch: 6 | loss: 0.3917390
	speed: 0.0022s/iter; left time: 5.4383s
	iters: 800, epoch: 6 | loss: 0.1741660
	speed: 0.0022s/iter; left time: 5.0324s
	iters: 900, epoch: 6 | loss: 0.8160695
	speed: 0.0022s/iter; left time: 4.8150s
	iters: 1000, epoch: 6 | loss: 0.3045810
	speed: 0.0021s/iter; left time: 4.5748s
Updating learning rate to 1.3209611975e-05
Epoch: 6 cost time: 2.282743453979492
Epoch: 6, Steps: 1045 | Train Loss: 0.3889148 Vali Loss: 0.2968076 Best vali loss: 0.2813525
	iters: 100, epoch: 7 | loss: 0.2797472
	speed: 0.0077s/iter; left time: 15.2377s
	iters: 200, epoch: 7 | loss: 0.4080052
	speed: 0.0022s/iter; left time: 4.1453s
	iters: 300, epoch: 7 | loss: 0.2189255
	speed: 0.0022s/iter; left time: 3.9269s
	iters: 400, epoch: 7 | loss: 0.4081308
	speed: 0.0022s/iter; left time: 3.7207s
	iters: 500, epoch: 7 | loss: 0.2779137
	speed: 0.0022s/iter; left time: 3.4724s
	iters: 600, epoch: 7 | loss: 0.2914640
	speed: 0.0022s/iter; left time: 3.2764s
	iters: 700, epoch: 7 | loss: 0.2627251
	speed: 0.0022s/iter; left time: 3.1040s
	iters: 800, epoch: 7 | loss: 0.3133622
	speed: 0.0022s/iter; left time: 2.8479s
	iters: 900, epoch: 7 | loss: 0.8123163
	speed: 0.0022s/iter; left time: 2.6277s
	iters: 1000, epoch: 7 | loss: 0.8017671
	speed: 0.0022s/iter; left time: 2.3523s
Updating learning rate to 6.6048059875e-06
Epoch: 7 cost time: 2.33552885055542
Epoch: 7, Steps: 1045 | Train Loss: 0.4074357 Vali Loss: 0.2997522 Best vali loss: 0.2813525
	iters: 100, epoch: 8 | loss: 0.3460066
	speed: 0.0081s/iter; left time: 7.6675s
	iters: 200, epoch: 8 | loss: 0.2765963
	speed: 0.0024s/iter; left time: 2.0096s
	iters: 300, epoch: 8 | loss: 0.4725455
	speed: 0.0023s/iter; left time: 1.7389s
	iters: 400, epoch: 8 | loss: 0.3384655
	speed: 0.0022s/iter; left time: 1.4533s
	iters: 500, epoch: 8 | loss: 0.3712249
	speed: 0.0023s/iter; left time: 1.2332s
	iters: 600, epoch: 8 | loss: 0.1660957
	speed: 0.0023s/iter; left time: 1.0074s
	iters: 700, epoch: 8 | loss: 0.3885205
	speed: 0.0022s/iter; left time: 0.7760s
	iters: 800, epoch: 8 | loss: 0.1637577
	speed: 0.0023s/iter; left time: 0.5558s
	iters: 900, epoch: 8 | loss: 0.3451452
	speed: 0.0023s/iter; left time: 0.3331s
	iters: 1000, epoch: 8 | loss: 0.2207006
	speed: 0.0023s/iter; left time: 0.1081s
Updating learning rate to 3.30240299375e-06
Epoch: 8 cost time: 2.4375369548797607
Epoch: 8, Steps: 1045 | Train Loss: 0.3089059 Vali Loss: 0.2980310 Best vali loss: 0.2813525

best validation loss 0.2813524536015421

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010436703114, 'e_layers': 3, 'learning_rate': 0.0001549877333, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4843147
	speed: 0.0094s/iter; left time: 18.8153s
	iters: 200, epoch: 1 | loss: 0.4015215
	speed: 0.0043s/iter; left time: 8.1720s
Updating learning rate to 0.0001549877333
Validation loss decreased (inf --> 0.2909).  Saving model state dict ...
Epoch: 1 cost time: 1.3951091766357422
Epoch: 1, Steps: 262 | Train Loss: 0.4429181 Vali Loss: 0.2908886 Best vali loss: 0.2908886
	iters: 100, epoch: 2 | loss: 0.6826084
	speed: 0.0094s/iter; left time: 16.2945s
	iters: 200, epoch: 2 | loss: 0.3412239
	speed: 0.0038s/iter; left time: 6.2591s
Updating learning rate to 7.749386665e-05
Validation loss decreased (0.2909 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 1.0792088508605957
Epoch: 2, Steps: 262 | Train Loss: 0.5119161 Vali Loss: 0.2828251 Best vali loss: 0.2828251
	iters: 100, epoch: 3 | loss: 0.4750421
	speed: 0.0092s/iter; left time: 13.5719s
	iters: 200, epoch: 3 | loss: 0.3359601
	speed: 0.0044s/iter; left time: 6.0718s
Updating learning rate to 3.8746933325e-05
Validation loss decreased (0.2828 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 1.1953480243682861
Epoch: 3, Steps: 262 | Train Loss: 0.4055011 Vali Loss: 0.2818931 Best vali loss: 0.2818931
	iters: 100, epoch: 4 | loss: 0.5651632
	speed: 0.0098s/iter; left time: 11.9174s
	iters: 200, epoch: 4 | loss: 0.3802795
	speed: 0.0041s/iter; left time: 4.5386s
Updating learning rate to 1.93734666625e-05
Validation loss decreased (0.2819 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 1.1792678833007812
Epoch: 4, Steps: 262 | Train Loss: 0.4727214 Vali Loss: 0.2818333 Best vali loss: 0.2818333
	iters: 100, epoch: 5 | loss: 0.3651850
	speed: 0.0091s/iter; left time: 8.6045s
	iters: 200, epoch: 5 | loss: 0.6090442
	speed: 0.0039s/iter; left time: 3.3060s
Updating learning rate to 9.68673333125e-06
Validation loss decreased (0.2818 --> 0.2817).  Saving model state dict ...
Epoch: 5 cost time: 1.0793049335479736
Epoch: 5, Steps: 262 | Train Loss: 0.4871146 Vali Loss: 0.2817148 Best vali loss: 0.2817148
	iters: 100, epoch: 6 | loss: 0.2620395
	speed: 0.0090s/iter; left time: 6.1823s
	iters: 200, epoch: 6 | loss: 0.3520226
	speed: 0.0039s/iter; left time: 2.2681s
Updating learning rate to 4.843366665625e-06
Epoch: 6 cost time: 1.078324317932129
Epoch: 6, Steps: 262 | Train Loss: 0.3070310 Vali Loss: 0.2817563 Best vali loss: 0.2817148
	iters: 100, epoch: 7 | loss: 0.5779186
	speed: 0.0094s/iter; left time: 3.9934s
	iters: 200, epoch: 7 | loss: 0.7658541
	speed: 0.0042s/iter; left time: 1.3721s
Updating learning rate to 2.4216833328125e-06
Epoch: 7 cost time: 1.176825761795044
Epoch: 7, Steps: 262 | Train Loss: 0.6718864 Vali Loss: 0.2818362 Best vali loss: 0.2817148
	iters: 100, epoch: 8 | loss: 0.6727694
	speed: 0.0095s/iter; left time: 1.5457s
	iters: 200, epoch: 8 | loss: 0.2921755
	speed: 0.0045s/iter; left time: 0.2825s
Updating learning rate to 1.21084166640625e-06
Epoch: 8 cost time: 1.1971890926361084
Epoch: 8, Steps: 262 | Train Loss: 0.4824724 Vali Loss: 0.2818015 Best vali loss: 0.2817148

best validation loss 0.28171476311690746

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.010984893356, 'e_layers': 2, 'learning_rate': 0.001815341793, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4972275
	speed: 0.0090s/iter; left time: 8.5667s
Updating learning rate to 0.001815341793
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 0.7497053146362305
Epoch: 1, Steps: 131 | Train Loss: 0.4972275 Vali Loss: 0.2849166 Best vali loss: 0.2849166
	iters: 100, epoch: 2 | loss: 0.4814841
	speed: 0.0064s/iter; left time: 5.1970s
Updating learning rate to 0.0009076708965
Epoch: 2 cost time: 0.509122371673584
Epoch: 2, Steps: 131 | Train Loss: 0.4814841 Vali Loss: 0.2951248 Best vali loss: 0.2849166
	iters: 100, epoch: 3 | loss: 0.4139850
	speed: 0.0066s/iter; left time: 4.5128s
Updating learning rate to 0.00045383544825
Epoch: 3 cost time: 0.5155067443847656
Epoch: 3, Steps: 131 | Train Loss: 0.4139850 Vali Loss: 0.2923268 Best vali loss: 0.2849166

best validation loss 0.28491664805590505

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0018477877600639972
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 0.6568193435668945
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2875191 Best vali loss: 0.2875191
Updating learning rate to 0.0016395886343680123
Validation loss decreased (0.2875 --> 0.2866).  Saving model state dict ...
Epoch: 2 cost time: 0.4360971450805664
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2866241 Best vali loss: 0.2866241
Updating learning rate to 0.0013279966230694852
Epoch: 3 cost time: 0.44723987579345703
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3188713 Best vali loss: 0.2866241

best validation loss 0.2866240587762937

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5856238
	speed: 0.0076s/iter; left time: 15.2645s
	iters: 200, epoch: 1 | loss: 0.9246839
	speed: 0.0026s/iter; left time: 5.0071s
Updating learning rate to 0.0006618030633303181
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 0.9442460536956787
Epoch: 1, Steps: 262 | Train Loss: 0.7551539 Vali Loss: 0.2821055 Best vali loss: 0.2821055
	iters: 100, epoch: 2 | loss: 0.4246677
	speed: 0.0063s/iter; left time: 10.8554s
	iters: 200, epoch: 2 | loss: 0.4430466
	speed: 0.0025s/iter; left time: 4.1541s
Updating learning rate to 0.0005872345321676674
Validation loss decreased (0.2821 --> 0.2804).  Saving model state dict ...
Epoch: 2 cost time: 0.6907052993774414
Epoch: 2, Steps: 262 | Train Loss: 0.4338571 Vali Loss: 0.2804005 Best vali loss: 0.2804005
	iters: 100, epoch: 3 | loss: 0.4099523
	speed: 0.0062s/iter; left time: 9.0692s
	iters: 200, epoch: 3 | loss: 0.3627608
	speed: 0.0027s/iter; left time: 3.6868s
Updating learning rate to 0.0004756348387161433
Epoch: 3 cost time: 0.7485401630401611
Epoch: 3, Steps: 262 | Train Loss: 0.3863566 Vali Loss: 0.2850630 Best vali loss: 0.2804005

best validation loss 0.2804005413460616

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4962224
	speed: 0.0080s/iter; left time: 9.6402s
	iters: 200, epoch: 4 | loss: 0.7136126
	speed: 0.0025s/iter; left time: 2.8142s
Updating learning rate to 0.00034399402465
Epoch: 4 cost time: 0.9492034912109375
Epoch: 4, Steps: 262 | Train Loss: 0.6049175 Vali Loss: 0.2937737 Best vali loss: 0.2804005
	iters: 100, epoch: 5 | loss: 0.4015040
	speed: 0.0064s/iter; left time: 6.0600s
	iters: 200, epoch: 5 | loss: 0.3431883
	speed: 0.0028s/iter; left time: 2.3956s
Updating learning rate to 0.00021235321058385673
Epoch: 5 cost time: 0.7584681510925293
Epoch: 5, Steps: 262 | Train Loss: 0.3723461 Vali Loss: 0.2953155 Best vali loss: 0.2804005
	iters: 100, epoch: 6 | loss: 0.3406821
	speed: 0.0062s/iter; left time: 4.2561s
	iters: 200, epoch: 6 | loss: 0.3465636
	speed: 0.0025s/iter; left time: 1.4469s
Updating learning rate to 0.00010075351713233263
Epoch: 6 cost time: 0.6855466365814209
Epoch: 6, Steps: 262 | Train Loss: 0.3436228 Vali Loss: 0.2983912 Best vali loss: 0.2804005
	iters: 100, epoch: 7 | loss: 0.3566679
	speed: 0.0060s/iter; left time: 2.5430s
	iters: 200, epoch: 7 | loss: 0.4286885
	speed: 0.0025s/iter; left time: 0.7988s
Updating learning rate to 2.6184985969681952e-05
Epoch: 7 cost time: 0.677731990814209
Epoch: 7, Steps: 262 | Train Loss: 0.3926782 Vali Loss: 0.3002194 Best vali loss: 0.2804005
	iters: 100, epoch: 8 | loss: 0.6750600
	speed: 0.0058s/iter; left time: 0.9454s
	iters: 200, epoch: 8 | loss: 0.3757658
	speed: 0.0023s/iter; left time: 0.1469s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6475753784179688
Epoch: 8, Steps: 262 | Train Loss: 0.5254129 Vali Loss: 0.3016380 Best vali loss: 0.2804005

best validation loss 0.2804005413460616

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032599720922, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.3274).  Saving model state dict ...
Epoch: 1 cost time: 0.49165892601013184
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3273864 Best vali loss: 0.3273864
Updating learning rate to 0.0002152265254906771
Validation loss decreased (0.3274 --> 0.3090).  Saving model state dict ...
Epoch: 2 cost time: 0.25977373123168945
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3089525 Best vali loss: 0.3089525
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.3090 --> 0.2996).  Saving model state dict ...
Epoch: 3 cost time: 0.2660841941833496
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2995876 Best vali loss: 0.2995876
Updating learning rate to 0.00012607677965
Validation loss decreased (0.2996 --> 0.2941).  Saving model state dict ...
Epoch: 4 cost time: 0.26216959953308105
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2940694 Best vali loss: 0.2940694
Updating learning rate to 7.782928487200091e-05
Validation loss decreased (0.2941 --> 0.2916).  Saving model state dict ...
Epoch: 5 cost time: 0.26491355895996094
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2915830 Best vali loss: 0.2915830
Updating learning rate to 3.692703380932289e-05
Validation loss decreased (0.2916 --> 0.2905).  Saving model state dict ...
Epoch: 6 cost time: 0.2677590847015381
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2904890 Best vali loss: 0.2904890
Updating learning rate to 9.59702340642949e-06
Validation loss decreased (0.2905 --> 0.2899).  Saving model state dict ...
Epoch: 7 cost time: 0.26431751251220703
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2899164 Best vali loss: 0.2899164
Updating learning rate to 0.0
Validation loss decreased (0.2899 --> 0.2897).  Saving model state dict ...
Epoch: 8 cost time: 0.26060032844543457
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2897247 Best vali loss: 0.2897247

best validation loss 0.2897246522990333

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 3, 'learning_rate': 0.0006514874423, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5771227
	speed: 0.0103s/iter; left time: 9.7754s
Updating learning rate to 0.0006514874423
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.9226970672607422
Epoch: 1, Steps: 131 | Train Loss: 0.5771227 Vali Loss: 0.2818560 Best vali loss: 0.2818560
	iters: 100, epoch: 2 | loss: 0.8383065
	speed: 0.0084s/iter; left time: 6.8731s
Updating learning rate to 0.00032574372115
Epoch: 2 cost time: 0.6910593509674072
Epoch: 2, Steps: 131 | Train Loss: 0.8383065 Vali Loss: 0.2820807 Best vali loss: 0.2818560
	iters: 100, epoch: 3 | loss: 0.4536718
	speed: 0.0077s/iter; left time: 5.3058s
Updating learning rate to 0.000162871860575
Epoch: 3 cost time: 0.6215848922729492
Epoch: 3, Steps: 131 | Train Loss: 0.4536718 Vali Loss: 0.2923682 Best vali loss: 0.2818560
	iters: 100, epoch: 4 | loss: 0.4008602
	speed: 0.0076s/iter; left time: 4.2433s
Updating learning rate to 8.14359302875e-05
Epoch: 4 cost time: 0.6122512817382812
Epoch: 4, Steps: 131 | Train Loss: 0.4008602 Vali Loss: 0.2912299 Best vali loss: 0.2818560
	iters: 100, epoch: 5 | loss: 0.3450939
	speed: 0.0075s/iter; left time: 3.2070s
Updating learning rate to 4.071796514375e-05
Epoch: 5 cost time: 0.6163723468780518
Epoch: 5, Steps: 131 | Train Loss: 0.3450939 Vali Loss: 0.2875015 Best vali loss: 0.2818560
	iters: 100, epoch: 6 | loss: 0.3709295
	speed: 0.0075s/iter; left time: 2.2095s
Updating learning rate to 2.0358982571875e-05
Epoch: 6 cost time: 0.6080524921417236
Epoch: 6, Steps: 131 | Train Loss: 0.3709295 Vali Loss: 0.2892985 Best vali loss: 0.2818560
	iters: 100, epoch: 7 | loss: 0.3492318
	speed: 0.0076s/iter; left time: 1.2373s
Updating learning rate to 1.01794912859375e-05
Epoch: 7 cost time: 0.6243782043457031
Epoch: 7, Steps: 131 | Train Loss: 0.3492318 Vali Loss: 0.2914742 Best vali loss: 0.2818560
	iters: 100, epoch: 8 | loss: 0.3868380
	speed: 0.0077s/iter; left time: 0.2449s
Updating learning rate to 5.08974564296875e-06
Epoch: 8 cost time: 0.636350154876709
Epoch: 8, Steps: 131 | Train Loss: 0.3868380 Vali Loss: 0.2909685 Best vali loss: 0.2818560

best validation loss 0.2818559779165269

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0065094553439, 'e_layers': 1, 'learning_rate': 0.0006735335754, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3146007
	speed: 0.0078s/iter; left time: 7.4069s
Updating learning rate to 0.0006478987300856038
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 0.6064848899841309
Epoch: 1, Steps: 131 | Train Loss: 0.3146007 Vali Loss: 0.2873846 Best vali loss: 0.2873846
	iters: 100, epoch: 2 | loss: 0.4803473
	speed: 0.0050s/iter; left time: 4.0650s
Updating learning rate to 0.0005748968669610804
Validation loss decreased (0.2874 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 0.38158369064331055
Epoch: 2, Steps: 131 | Train Loss: 0.4803473 Vali Loss: 0.2818658 Best vali loss: 0.2818658
	iters: 100, epoch: 3 | loss: 0.4518289
	speed: 0.0051s/iter; left time: 3.4838s
Updating learning rate to 0.00046564185792360155
Epoch: 3 cost time: 0.39099740982055664
Epoch: 3, Steps: 131 | Train Loss: 0.4518289 Vali Loss: 0.2827294 Best vali loss: 0.2818658

best validation loss 0.28186575432788397

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029036262858, 'e_layers': 2, 'learning_rate': 0.0030636692136, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5368747
	speed: 0.0082s/iter; left time: 67.6562s
	iters: 200, epoch: 1 | loss: 0.4281480
	speed: 0.0031s/iter; left time: 25.4646s
	iters: 300, epoch: 1 | loss: 0.2479777
	speed: 0.0031s/iter; left time: 25.3904s
	iters: 400, epoch: 1 | loss: 0.2358195
	speed: 0.0032s/iter; left time: 25.2381s
	iters: 500, epoch: 1 | loss: 0.6513875
	speed: 0.0032s/iter; left time: 25.3042s
	iters: 600, epoch: 1 | loss: 1.3514119
	speed: 0.0032s/iter; left time: 24.4579s
	iters: 700, epoch: 1 | loss: 0.2526913
	speed: 0.0031s/iter; left time: 23.7490s
	iters: 800, epoch: 1 | loss: 0.4556429
	speed: 0.0031s/iter; left time: 23.1298s
	iters: 900, epoch: 1 | loss: 1.0130233
	speed: 0.0030s/iter; left time: 22.6803s
	iters: 1000, epoch: 1 | loss: 0.4087719
	speed: 0.0030s/iter; left time: 22.2326s
Updating learning rate to 0.0030636692136
Validation loss decreased (inf --> 0.3225).  Saving model state dict ...
Epoch: 1 cost time: 3.5122621059417725
Epoch: 1, Steps: 1045 | Train Loss: 0.5581749 Vali Loss: 0.3224758 Best vali loss: 0.3224758
	iters: 100, epoch: 2 | loss: 0.2472567
	speed: 0.0098s/iter; left time: 70.9591s
	iters: 200, epoch: 2 | loss: 0.2944811
	speed: 0.0029s/iter; left time: 20.9818s
	iters: 300, epoch: 2 | loss: 0.7412739
	speed: 0.0029s/iter; left time: 20.4446s
	iters: 400, epoch: 2 | loss: 0.7252117
	speed: 0.0030s/iter; left time: 20.8538s
	iters: 500, epoch: 2 | loss: 0.2399079
	speed: 0.0031s/iter; left time: 21.3955s
	iters: 600, epoch: 2 | loss: 0.3908111
	speed: 0.0032s/iter; left time: 21.2944s
	iters: 700, epoch: 2 | loss: 1.0162221
	speed: 0.0032s/iter; left time: 20.9724s
	iters: 800, epoch: 2 | loss: 0.5715377
	speed: 0.0031s/iter; left time: 20.0835s
	iters: 900, epoch: 2 | loss: 0.8911954
	speed: 0.0031s/iter; left time: 19.9410s
	iters: 1000, epoch: 2 | loss: 0.6289154
	speed: 0.0031s/iter; left time: 19.7727s
Updating learning rate to 0.0015318346068
Epoch: 2 cost time: 3.245978832244873
Epoch: 2, Steps: 1045 | Train Loss: 0.5746813 Vali Loss: 0.3252261 Best vali loss: 0.3224758
	iters: 100, epoch: 3 | loss: 0.3804334
	speed: 0.0094s/iter; left time: 57.7640s
	iters: 200, epoch: 3 | loss: 1.2989817
	speed: 0.0031s/iter; left time: 19.0591s
	iters: 300, epoch: 3 | loss: 0.3363088
	speed: 0.0032s/iter; left time: 18.9811s
	iters: 400, epoch: 3 | loss: 0.4606727
	speed: 0.0032s/iter; left time: 18.8050s
	iters: 500, epoch: 3 | loss: 1.1514143
	speed: 0.0032s/iter; left time: 18.6281s
	iters: 600, epoch: 3 | loss: 0.3316070
	speed: 0.0032s/iter; left time: 18.1278s
	iters: 700, epoch: 3 | loss: 0.2002531
	speed: 0.0030s/iter; left time: 16.7229s
	iters: 800, epoch: 3 | loss: 0.7395659
	speed: 0.0028s/iter; left time: 15.4469s
	iters: 900, epoch: 3 | loss: 0.5406471
	speed: 0.0028s/iter; left time: 15.0240s
	iters: 1000, epoch: 3 | loss: 0.2973544
	speed: 0.0031s/iter; left time: 16.2031s
Updating learning rate to 0.0007659173034
Epoch: 3 cost time: 3.2185356616973877
Epoch: 3, Steps: 1045 | Train Loss: 0.5737238 Vali Loss: 0.3245423 Best vali loss: 0.3224758

best validation loss 0.32247583615199127

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001591137315
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 0.7404303550720215
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2805110 Best vali loss: 0.2805110
Updating learning rate to 7.955686575e-05
Validation loss decreased (0.2805 --> 0.2747).  Saving model state dict ...
Epoch: 2 cost time: 0.5119287967681885
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2746703 Best vali loss: 0.2746703
Updating learning rate to 3.9778432875e-05
Validation loss decreased (0.2747 --> 0.2729).  Saving model state dict ...
Epoch: 3 cost time: 0.5146093368530273
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2728557 Best vali loss: 0.2728557

best validation loss 0.2728557020159803

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.98892164375e-05
Epoch: 4 cost time: 0.7319931983947754
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2732735 Best vali loss: 0.2728557
Updating learning rate to 9.94460821875e-06
Epoch: 5 cost time: 0.5138554573059082
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2740697 Best vali loss: 0.2728557
Updating learning rate to 4.972304109375e-06
Epoch: 6 cost time: 0.5053818225860596
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2744181 Best vali loss: 0.2728557
Updating learning rate to 2.4861520546875e-06
Epoch: 7 cost time: 0.5128970146179199
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2747114 Best vali loss: 0.2728557
Updating learning rate to 1.24307602734375e-06
Epoch: 8 cost time: 0.5043408870697021
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2751077 Best vali loss: 0.2728557

best validation loss 0.2728557020159803

[INFO][abstract_intensifier.py:595] Added config bd4166 and rejected config 409f87 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.01186370118, 'e_layers': 4, 'learning_rate': 0.0002221655976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002221655976
Validation loss decreased (inf --> 0.2808).  Saving model state dict ...
Epoch: 1 cost time: 0.826509952545166
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2808245 Best vali loss: 0.2808245
Updating learning rate to 0.0001110827988
Epoch: 2 cost time: 0.5880115032196045
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2813825 Best vali loss: 0.2808245
Updating learning rate to 5.55413994e-05
Validation loss decreased (0.2808 --> 0.2772).  Saving model state dict ...
Epoch: 3 cost time: 0.5904064178466797
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2772039 Best vali loss: 0.2772039
Updating learning rate to 2.77706997e-05
Epoch: 4 cost time: 0.5941872596740723
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2794624 Best vali loss: 0.2772039
Updating learning rate to 1.388534985e-05
Epoch: 5 cost time: 0.5939860343933105
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2790977 Best vali loss: 0.2772039
Updating learning rate to 6.942674925e-06
Epoch: 6 cost time: 0.60066819190979
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2801056 Best vali loss: 0.2772039
Updating learning rate to 3.4713374625e-06
Epoch: 7 cost time: 0.5972108840942383
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2808041 Best vali loss: 0.2772039
Updating learning rate to 1.73566873125e-06
Epoch: 8 cost time: 0.6011984348297119
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2811199 Best vali loss: 0.2772039

best validation loss 0.2772039484029013

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014508988157, 'e_layers': 3, 'learning_rate': 0.0010889710455, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010889710455
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 0.6966385841369629
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2883825 Best vali loss: 0.2883825
Updating learning rate to 0.00054448552275
Validation loss decreased (0.2884 --> 0.2795).  Saving model state dict ...
Epoch: 2 cost time: 0.47410058975219727
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2795075 Best vali loss: 0.2795075
Updating learning rate to 0.000272242761375
Epoch: 3 cost time: 0.46819424629211426
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2805352 Best vali loss: 0.2795075
Updating learning rate to 0.0001361213806875
Validation loss decreased (0.2795 --> 0.2785).  Saving model state dict ...
Epoch: 4 cost time: 0.4705779552459717
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2784727 Best vali loss: 0.2784727
Updating learning rate to 6.806069034375e-05
Epoch: 5 cost time: 0.47658872604370117
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2805171 Best vali loss: 0.2784727
Updating learning rate to 3.4030345171875e-05
Epoch: 6 cost time: 0.46947193145751953
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2824380 Best vali loss: 0.2784727
Updating learning rate to 1.70151725859375e-05
Epoch: 7 cost time: 0.4707159996032715
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2867794 Best vali loss: 0.2784727
Updating learning rate to 8.50758629296875e-06
Epoch: 8 cost time: 0.47022318840026855
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2868101 Best vali loss: 0.2784727

best validation loss 0.2784727231975868

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005760452490497884
Validation loss decreased (inf --> 0.3034).  Saving model state dict ...
Epoch: 1 cost time: 0.48427414894104004
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3034317 Best vali loss: 0.3034317
Updating learning rate to 0.0005111394628953558
Validation loss decreased (0.3034 --> 0.2882).  Saving model state dict ...
Epoch: 2 cost time: 0.2719540596008301
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2881703 Best vali loss: 0.2881703
Updating learning rate to 0.00041400108930629814
Validation loss decreased (0.2882 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 0.26740217208862305
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2839317 Best vali loss: 0.2839317

best validation loss 0.28393165772734363

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 2, 'learning_rate': 0.0015995261445, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3393067
	speed: 0.0083s/iter; left time: 68.4430s
	iters: 200, epoch: 1 | loss: 0.9446703
	speed: 0.0033s/iter; left time: 26.7841s
	iters: 300, epoch: 1 | loss: 0.5503436
	speed: 0.0033s/iter; left time: 26.6715s
	iters: 400, epoch: 1 | loss: 0.6320789
	speed: 0.0033s/iter; left time: 26.1431s
	iters: 500, epoch: 1 | loss: 0.5763656
	speed: 0.0033s/iter; left time: 25.9696s
	iters: 600, epoch: 1 | loss: 1.2186087
	speed: 0.0033s/iter; left time: 25.6703s
	iters: 700, epoch: 1 | loss: 0.4783750
	speed: 0.0033s/iter; left time: 25.4717s
	iters: 800, epoch: 1 | loss: 0.5330713
	speed: 0.0033s/iter; left time: 25.1088s
	iters: 900, epoch: 1 | loss: 1.1889617
	speed: 0.0033s/iter; left time: 24.4973s
	iters: 1000, epoch: 1 | loss: 0.2518961
	speed: 0.0033s/iter; left time: 24.0600s
Updating learning rate to 0.0015386478055601205
Validation loss decreased (inf --> 0.3421).  Saving model state dict ...
Epoch: 1 cost time: 3.699763774871826
Epoch: 1, Steps: 1045 | Train Loss: 0.6713678 Vali Loss: 0.3420713 Best vali loss: 0.3420713
	iters: 100, epoch: 2 | loss: 0.3415400
	speed: 0.0101s/iter; left time: 72.8899s
	iters: 200, epoch: 2 | loss: 0.2091243
	speed: 0.0034s/iter; left time: 24.0811s
	iters: 300, epoch: 2 | loss: 0.9003318
	speed: 0.0034s/iter; left time: 23.6909s
	iters: 400, epoch: 2 | loss: 1.2062389
	speed: 0.0033s/iter; left time: 22.8335s
	iters: 500, epoch: 2 | loss: 0.3738175
	speed: 0.0034s/iter; left time: 23.0464s
	iters: 600, epoch: 2 | loss: 0.2845034
	speed: 0.0033s/iter; left time: 22.3148s
	iters: 700, epoch: 2 | loss: 0.5755222
	speed: 0.0033s/iter; left time: 22.0476s
	iters: 800, epoch: 2 | loss: 1.4012572
	speed: 0.0033s/iter; left time: 21.5162s
	iters: 900, epoch: 2 | loss: 0.8873377
	speed: 0.0033s/iter; left time: 21.3322s
	iters: 1000, epoch: 2 | loss: 1.6018652
	speed: 0.0033s/iter; left time: 20.8773s
Updating learning rate to 0.0013652809639805618
Validation loss decreased (0.3421 --> 0.3288).  Saving model state dict ...
Epoch: 2 cost time: 3.5205891132354736
Epoch: 2, Steps: 1045 | Train Loss: 0.7781538 Vali Loss: 0.3287561 Best vali loss: 0.3287561
	iters: 100, epoch: 3 | loss: 0.4493367
	speed: 0.0099s/iter; left time: 61.1282s
	iters: 200, epoch: 3 | loss: 1.3292843
	speed: 0.0030s/iter; left time: 18.0957s
	iters: 300, epoch: 3 | loss: 1.0568991
	speed: 0.0030s/iter; left time: 17.7011s
	iters: 400, epoch: 3 | loss: 0.4282964
	speed: 0.0030s/iter; left time: 17.6331s
	iters: 500, epoch: 3 | loss: 0.3693358
	speed: 0.0030s/iter; left time: 17.2809s
	iters: 600, epoch: 3 | loss: 0.2303149
	speed: 0.0030s/iter; left time: 17.1568s
	iters: 700, epoch: 3 | loss: 0.5829258
	speed: 0.0030s/iter; left time: 16.5993s
	iters: 800, epoch: 3 | loss: 1.6851522
	speed: 0.0030s/iter; left time: 16.2770s
	iters: 900, epoch: 3 | loss: 0.9381122
	speed: 0.0030s/iter; left time: 15.8994s
	iters: 1000, epoch: 3 | loss: 0.5048494
	speed: 0.0031s/iter; left time: 16.1124s
Updating learning rate to 0.0011058191498174795
Validation loss decreased (0.3288 --> 0.3203).  Saving model state dict ...
Epoch: 3 cost time: 3.1673007011413574
Epoch: 3, Steps: 1045 | Train Loss: 0.7574507 Vali Loss: 0.3203328 Best vali loss: 0.3203328

best validation loss 0.32033281682724846

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001776105869, 'e_layers': 3, 'learning_rate': 0.0035322605912, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5431009
	speed: 0.0097s/iter; left time: 19.3696s
	iters: 200, epoch: 1 | loss: 0.2946829
	speed: 0.0044s/iter; left time: 8.4234s
Updating learning rate to 0.0033978219274529487
Validation loss decreased (inf --> 0.3200).  Saving model state dict ...
Epoch: 1 cost time: 1.4445199966430664
Epoch: 1, Steps: 262 | Train Loss: 0.4188919 Vali Loss: 0.3199944 Best vali loss: 0.3199944
	iters: 100, epoch: 2 | loss: 0.3076048
	speed: 0.0099s/iter; left time: 17.1823s
	iters: 200, epoch: 2 | loss: 0.7100942
	speed: 0.0046s/iter; left time: 7.5626s
Updating learning rate to 0.003014973004077762
Epoch: 2 cost time: 1.2414474487304688
Epoch: 2, Steps: 262 | Train Loss: 0.5088495 Vali Loss: 0.3241744 Best vali loss: 0.3199944
	iters: 100, epoch: 3 | loss: 0.5266178
	speed: 0.0098s/iter; left time: 14.4687s
	iters: 200, epoch: 3 | loss: 0.7828782
	speed: 0.0044s/iter; left time: 6.0392s
Updating learning rate to 0.0024419990991241787
Epoch: 3 cost time: 1.2021799087524414
Epoch: 3, Steps: 262 | Train Loss: 0.6547480 Vali Loss: 0.3221260 Best vali loss: 0.3199944

best validation loss 0.3199943798809257

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002994185651
Validation loss decreased (0.2839 --> 0.2825).  Saving model state dict ...
Epoch: 4 cost time: 0.49155497550964355
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2824787 Best vali loss: 0.2824787
Updating learning rate to 0.00018483604089370196
Validation loss decreased (0.2825 --> 0.2821).  Saving model state dict ...
Epoch: 5 cost time: 0.2573709487915039
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2821349 Best vali loss: 0.2821349
Updating learning rate to 8.769766730464429e-05
Epoch: 6 cost time: 0.2502021789550781
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2828900 Best vali loss: 0.2821349
Updating learning rate to 2.2791881150211728e-05
Epoch: 7 cost time: 0.2668912410736084
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2826378 Best vali loss: 0.2821349
Updating learning rate to 0.0
Epoch: 8 cost time: 0.25806236267089844
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2826733 Best vali loss: 0.2821349

best validation loss 0.2821348801548927

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0111045942676, 'e_layers': 2, 'learning_rate': 0.0002179765149, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002179765149
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 0.5640439987182617
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2785968 Best vali loss: 0.2785968
Updating learning rate to 0.00010898825745
Validation loss decreased (0.2786 --> 0.2774).  Saving model state dict ...
Epoch: 2 cost time: 0.3348870277404785
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2773568 Best vali loss: 0.2773568
Updating learning rate to 5.4494128725e-05
Validation loss decreased (0.2774 --> 0.2755).  Saving model state dict ...
Epoch: 3 cost time: 0.32909727096557617
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2754561 Best vali loss: 0.2754561
Updating learning rate to 2.72470643625e-05
Validation loss decreased (0.2755 --> 0.2749).  Saving model state dict ...
Epoch: 4 cost time: 0.32501792907714844
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2749297 Best vali loss: 0.2749297
Updating learning rate to 1.362353218125e-05
Epoch: 5 cost time: 0.3387901782989502
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2753881 Best vali loss: 0.2749297
Updating learning rate to 6.811766090625e-06
Validation loss decreased (0.2749 --> 0.2747).  Saving model state dict ...
Epoch: 6 cost time: 0.3208959102630615
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2746510 Best vali loss: 0.2746510
Updating learning rate to 3.4058830453125e-06
Epoch: 7 cost time: 0.3400843143463135
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2746513 Best vali loss: 0.2746510
Updating learning rate to 1.70294152265625e-06
Validation loss decreased (0.2747 --> 0.2746).  Saving model state dict ...
Epoch: 8 cost time: 0.33702588081359863
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2745980 Best vali loss: 0.2745980

best validation loss 0.2745980226021577

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017015780889, 'e_layers': 1, 'learning_rate': 0.0028702571024, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0028702571024
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 0.5227534770965576
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2878415 Best vali loss: 0.2878415
Updating learning rate to 0.0014351285512
Epoch: 2 cost time: 0.3057584762573242
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2950076 Best vali loss: 0.2878415
Updating learning rate to 0.0007175642756
Epoch: 3 cost time: 0.3053584098815918
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2898290 Best vali loss: 0.2878415
Updating learning rate to 0.0003587821378
Epoch: 4 cost time: 0.3024466037750244
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3051404 Best vali loss: 0.2878415
Updating learning rate to 0.0001793910689
Epoch: 5 cost time: 0.30045390129089355
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3041385 Best vali loss: 0.2878415
Updating learning rate to 8.969553445e-05
Epoch: 6 cost time: 0.30187129974365234
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3093971 Best vali loss: 0.2878415
Updating learning rate to 4.4847767225e-05
Epoch: 7 cost time: 0.3111579418182373
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3077076 Best vali loss: 0.2878415
Updating learning rate to 2.24238836125e-05
Epoch: 8 cost time: 0.3045535087585449
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3127564 Best vali loss: 0.2878415

best validation loss 0.28784149774901263

[INFO][smbo.py:320] Finished 150 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.001707636708, 'e_layers': 2, 'learning_rate': 0.0007419627822, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2910743
	speed: 0.0085s/iter; left time: 70.2877s
	iters: 200, epoch: 1 | loss: 0.1484557
	speed: 0.0033s/iter; left time: 26.9296s
	iters: 300, epoch: 1 | loss: 0.2519150
	speed: 0.0033s/iter; left time: 26.9005s
	iters: 400, epoch: 1 | loss: 0.8528557
	speed: 0.0034s/iter; left time: 26.7064s
	iters: 500, epoch: 1 | loss: 0.3412840
	speed: 0.0033s/iter; left time: 26.3025s
	iters: 600, epoch: 1 | loss: 0.5483041
	speed: 0.0034s/iter; left time: 26.0991s
	iters: 700, epoch: 1 | loss: 0.2986288
	speed: 0.0034s/iter; left time: 25.7470s
	iters: 800, epoch: 1 | loss: 0.3117884
	speed: 0.0033s/iter; left time: 25.2487s
	iters: 900, epoch: 1 | loss: 0.3762615
	speed: 0.0033s/iter; left time: 24.8962s
	iters: 1000, epoch: 1 | loss: 0.4461572
	speed: 0.0033s/iter; left time: 24.6131s
Updating learning rate to 0.0007137235052798548
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 3.750784397125244
Epoch: 1, Steps: 1045 | Train Loss: 0.3866725 Vali Loss: 0.2802011 Best vali loss: 0.2802011
	iters: 100, epoch: 2 | loss: 0.8446575
	speed: 0.0103s/iter; left time: 74.6635s
	iters: 200, epoch: 2 | loss: 0.9645938
	speed: 0.0033s/iter; left time: 23.5106s
	iters: 300, epoch: 2 | loss: 0.1949263
	speed: 0.0031s/iter; left time: 21.6589s
	iters: 400, epoch: 2 | loss: 0.4680966
	speed: 0.0031s/iter; left time: 21.3716s
	iters: 500, epoch: 2 | loss: 0.6788245
	speed: 0.0031s/iter; left time: 21.1550s
	iters: 600, epoch: 2 | loss: 0.2658620
	speed: 0.0031s/iter; left time: 20.8659s
	iters: 700, epoch: 2 | loss: 1.6586372
	speed: 0.0031s/iter; left time: 20.5627s
	iters: 800, epoch: 2 | loss: 0.2275930
	speed: 0.0031s/iter; left time: 20.3302s
	iters: 900, epoch: 2 | loss: 0.6635433
	speed: 0.0031s/iter; left time: 20.0840s
	iters: 1000, epoch: 2 | loss: 0.1962224
	speed: 0.0031s/iter; left time: 19.5691s
Updating learning rate to 0.0006333048484408287
Epoch: 2 cost time: 3.3351833820343018
Epoch: 2, Steps: 1045 | Train Loss: 0.6162957 Vali Loss: 0.2824153 Best vali loss: 0.2802011
	iters: 100, epoch: 3 | loss: 0.2488037
	speed: 0.0100s/iter; left time: 61.8662s
	iters: 200, epoch: 3 | loss: 0.2387154
	speed: 0.0034s/iter; left time: 20.4018s
	iters: 300, epoch: 3 | loss: 0.6076110
	speed: 0.0033s/iter; left time: 19.9553s
	iters: 400, epoch: 3 | loss: 0.2854479
	speed: 0.0034s/iter; left time: 19.7207s
	iters: 500, epoch: 3 | loss: 0.4519735
	speed: 0.0034s/iter; left time: 19.3370s
	iters: 600, epoch: 3 | loss: 0.7556679
	speed: 0.0034s/iter; left time: 19.0034s
	iters: 700, epoch: 3 | loss: 1.0310082
	speed: 0.0033s/iter; left time: 18.5685s
	iters: 800, epoch: 3 | loss: 0.1270545
	speed: 0.0033s/iter; left time: 18.2320s
	iters: 900, epoch: 3 | loss: 0.4428890
	speed: 0.0033s/iter; left time: 17.9065s
	iters: 1000, epoch: 3 | loss: 0.1792452
	speed: 0.0033s/iter; left time: 17.3945s
Updating learning rate to 0.0005129498231897238
Epoch: 3 cost time: 3.523711681365967
Epoch: 3, Steps: 1045 | Train Loss: 0.4368416 Vali Loss: 0.2987567 Best vali loss: 0.2802011

best validation loss 0.28020107231316577

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6427208
	speed: 0.0104s/iter; left time: 9.8586s
Updating learning rate to 7.21066019e-05
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 0.9437928199768066
Epoch: 1, Steps: 131 | Train Loss: 0.6427208 Vali Loss: 0.2786440 Best vali loss: 0.2786440
	iters: 100, epoch: 2 | loss: 0.3989008
	speed: 0.0089s/iter; left time: 7.2730s
Updating learning rate to 3.605330095e-05
Validation loss decreased (0.2786 --> 0.2763).  Saving model state dict ...
Epoch: 2 cost time: 0.704345703125
Epoch: 2, Steps: 131 | Train Loss: 0.3989008 Vali Loss: 0.2763457 Best vali loss: 0.2763457
	iters: 100, epoch: 3 | loss: 0.8935989
	speed: 0.0091s/iter; left time: 6.2318s
Updating learning rate to 1.8026650475e-05
Validation loss decreased (0.2763 --> 0.2748).  Saving model state dict ...
Epoch: 3 cost time: 0.7045192718505859
Epoch: 3, Steps: 131 | Train Loss: 0.8935989 Vali Loss: 0.2748160 Best vali loss: 0.2748160

best validation loss 0.27481602203806077

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019248824173, 'e_layers': 4, 'learning_rate': 0.0047849704029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004602853310905798
Validation loss decreased (inf --> 0.3251).  Saving model state dict ...
Epoch: 1 cost time: 1.2798287868499756
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3250591 Best vali loss: 0.3250591
Updating learning rate to 0.004084227711283759
Epoch: 2 cost time: 1.0417983531951904
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3484327 Best vali loss: 0.3250591
Updating learning rate to 0.0033080496502235694
Validation loss decreased (0.3251 --> 0.3211).  Saving model state dict ...
Epoch: 3 cost time: 1.0400397777557373
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3210958 Best vali loss: 0.3210958

best validation loss 0.32109578842121944

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5816060
	speed: 0.0107s/iter; left time: 5.9534s
Updating learning rate to 9.0133252375e-06
Validation loss decreased (0.2748 --> 0.2726).  Saving model state dict ...
Epoch: 4 cost time: 0.9389395713806152
Epoch: 4, Steps: 131 | Train Loss: 0.5816060 Vali Loss: 0.2726180 Best vali loss: 0.2726180
	iters: 100, epoch: 5 | loss: 0.3810364
	speed: 0.0089s/iter; left time: 3.7980s
Updating learning rate to 4.50666261875e-06
Epoch: 5 cost time: 0.6988255977630615
Epoch: 5, Steps: 131 | Train Loss: 0.3810364 Vali Loss: 0.2728840 Best vali loss: 0.2726180
	iters: 100, epoch: 6 | loss: 0.8460804
	speed: 0.0086s/iter; left time: 2.5221s
Updating learning rate to 2.253331309375e-06
Epoch: 6 cost time: 0.6927177906036377
Epoch: 6, Steps: 131 | Train Loss: 0.8460804 Vali Loss: 0.2736417 Best vali loss: 0.2726180
	iters: 100, epoch: 7 | loss: 0.5365073
	speed: 0.0086s/iter; left time: 1.4075s
Updating learning rate to 1.1266656546875e-06
Epoch: 7 cost time: 0.6984081268310547
Epoch: 7, Steps: 131 | Train Loss: 0.5365073 Vali Loss: 0.2739769 Best vali loss: 0.2726180
	iters: 100, epoch: 8 | loss: 0.4580628
	speed: 0.0087s/iter; left time: 0.2781s
Updating learning rate to 5.6333282734375e-07
Epoch: 8 cost time: 0.7090156078338623
Epoch: 8, Steps: 131 | Train Loss: 0.4580628 Vali Loss: 0.2741823 Best vali loss: 0.2726180

best validation loss 0.2726179585664323

[INFO][abstract_intensifier.py:595] Added config 639238 and rejected config bd4166 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0061705426639, 'e_layers': 4, 'learning_rate': 0.001116068428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9658590
	speed: 0.0100s/iter; left time: 40.9699s
	iters: 200, epoch: 1 | loss: 0.3254659
	speed: 0.0049s/iter; left time: 19.6852s
	iters: 300, epoch: 1 | loss: 0.2671602
	speed: 0.0049s/iter; left time: 19.1917s
	iters: 400, epoch: 1 | loss: 0.4295471
	speed: 0.0050s/iter; left time: 18.8113s
	iters: 500, epoch: 1 | loss: 0.3953224
	speed: 0.0050s/iter; left time: 18.2707s
Updating learning rate to 0.001116068428
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 2.8543143272399902
Epoch: 1, Steps: 523 | Train Loss: 0.4766709 Vali Loss: 0.2883601 Best vali loss: 0.2883601
	iters: 100, epoch: 2 | loss: 0.4519618
	speed: 0.0095s/iter; left time: 33.6724s
	iters: 200, epoch: 2 | loss: 0.4054348
	speed: 0.0044s/iter; left time: 15.3009s
	iters: 300, epoch: 2 | loss: 0.2835101
	speed: 0.0044s/iter; left time: 14.8378s
	iters: 400, epoch: 2 | loss: 0.3845582
	speed: 0.0045s/iter; left time: 14.6894s
	iters: 500, epoch: 2 | loss: 0.4305468
	speed: 0.0049s/iter; left time: 15.6204s
Updating learning rate to 0.000558034214
Epoch: 2 cost time: 2.4221255779266357
Epoch: 2, Steps: 523 | Train Loss: 0.3912023 Vali Loss: 0.2918057 Best vali loss: 0.2883601
	iters: 100, epoch: 3 | loss: 0.3302642
	speed: 0.0093s/iter; left time: 28.2764s
	iters: 200, epoch: 3 | loss: 0.5237817
	speed: 0.0045s/iter; left time: 13.0998s
	iters: 300, epoch: 3 | loss: 0.3220060
	speed: 0.0045s/iter; left time: 12.7931s
	iters: 400, epoch: 3 | loss: 0.3240962
	speed: 0.0045s/iter; left time: 12.2081s
	iters: 500, epoch: 3 | loss: 0.3508953
	speed: 0.0045s/iter; left time: 11.8709s
Updating learning rate to 0.000279017107
Epoch: 3 cost time: 2.3910441398620605
Epoch: 3, Steps: 523 | Train Loss: 0.3702087 Vali Loss: 0.3058867 Best vali loss: 0.2883601
	iters: 100, epoch: 4 | loss: 0.7654136
	speed: 0.0101s/iter; left time: 25.2936s
	iters: 200, epoch: 4 | loss: 0.9494616
	speed: 0.0052s/iter; left time: 12.5872s
	iters: 300, epoch: 4 | loss: 0.3767277
	speed: 0.0052s/iter; left time: 12.0448s
	iters: 400, epoch: 4 | loss: 0.2840123
	speed: 0.0052s/iter; left time: 11.5234s
	iters: 500, epoch: 4 | loss: 0.6273544
	speed: 0.0051s/iter; left time: 10.8919s
Updating learning rate to 0.0001395085535
Epoch: 4 cost time: 2.7525179386138916
Epoch: 4, Steps: 523 | Train Loss: 0.6005939 Vali Loss: 0.3039961 Best vali loss: 0.2883601
	iters: 100, epoch: 5 | loss: 0.1843332
	speed: 0.0101s/iter; left time: 20.1884s
	iters: 200, epoch: 5 | loss: 0.3799205
	speed: 0.0051s/iter; left time: 9.5984s
	iters: 300, epoch: 5 | loss: 0.7718568
	speed: 0.0050s/iter; left time: 9.0172s
	iters: 400, epoch: 5 | loss: 0.3852225
	speed: 0.0051s/iter; left time: 8.5737s
	iters: 500, epoch: 5 | loss: 0.1515191
	speed: 0.0051s/iter; left time: 8.0862s
Updating learning rate to 6.975427675e-05
Epoch: 5 cost time: 2.6919665336608887
Epoch: 5, Steps: 523 | Train Loss: 0.3745704 Vali Loss: 0.3103689 Best vali loss: 0.2883601
	iters: 100, epoch: 6 | loss: 0.4422000
	speed: 0.0099s/iter; left time: 14.5862s
	iters: 200, epoch: 6 | loss: 0.2493413
	speed: 0.0048s/iter; left time: 6.6006s
	iters: 300, epoch: 6 | loss: 0.6903219
	speed: 0.0048s/iter; left time: 6.0968s
	iters: 400, epoch: 6 | loss: 0.8064421
	speed: 0.0049s/iter; left time: 5.7572s
	iters: 500, epoch: 6 | loss: 0.3446958
	speed: 0.0051s/iter; left time: 5.4036s
Updating learning rate to 3.4877138375e-05
Epoch: 6 cost time: 2.595501661300659
Epoch: 6, Steps: 523 | Train Loss: 0.5066002 Vali Loss: 0.3181640 Best vali loss: 0.2883601
	iters: 100, epoch: 7 | loss: 0.6100821
	speed: 0.0097s/iter; left time: 9.2006s
	iters: 200, epoch: 7 | loss: 0.3182512
	speed: 0.0048s/iter; left time: 4.0431s
	iters: 300, epoch: 7 | loss: 0.2348455
	speed: 0.0048s/iter; left time: 3.5648s
	iters: 400, epoch: 7 | loss: 0.8379197
	speed: 0.0047s/iter; left time: 3.0506s
	iters: 500, epoch: 7 | loss: 0.6748977
	speed: 0.0047s/iter; left time: 2.5977s
Updating learning rate to 1.74385691875e-05
Epoch: 7 cost time: 2.5248377323150635
Epoch: 7, Steps: 523 | Train Loss: 0.5351993 Vali Loss: 0.3149376 Best vali loss: 0.2883601
	iters: 100, epoch: 8 | loss: 0.2474758
	speed: 0.0095s/iter; left time: 4.0108s
	iters: 200, epoch: 8 | loss: 0.3306624
	speed: 0.0045s/iter; left time: 1.4708s
	iters: 300, epoch: 8 | loss: 0.7267785
	speed: 0.0046s/iter; left time: 1.0325s
	iters: 400, epoch: 8 | loss: 0.6691326
	speed: 0.0046s/iter; left time: 0.5679s
	iters: 500, epoch: 8 | loss: 0.2336544
	speed: 0.0046s/iter; left time: 0.1115s
Updating learning rate to 8.71928459375e-06
Epoch: 8 cost time: 2.436652898788452
Epoch: 8, Steps: 523 | Train Loss: 0.4415408 Vali Loss: 0.3108689 Best vali loss: 0.2883601

best validation loss 0.288360090304946

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 1, 'learning_rate': 0.0009739953589, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3636533
	speed: 0.0076s/iter; left time: 30.8924s
	iters: 200, epoch: 1 | loss: 0.3578200
	speed: 0.0025s/iter; left time: 9.8893s
	iters: 300, epoch: 1 | loss: 0.2387171
	speed: 0.0025s/iter; left time: 9.7355s
	iters: 400, epoch: 1 | loss: 0.5789505
	speed: 0.0025s/iter; left time: 9.3059s
	iters: 500, epoch: 1 | loss: 0.3785156
	speed: 0.0024s/iter; left time: 8.9658s
Updating learning rate to 0.0009369248678743475
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 1.552182912826538
Epoch: 1, Steps: 523 | Train Loss: 0.3835313 Vali Loss: 0.2848577 Best vali loss: 0.2848577
	iters: 100, epoch: 2 | loss: 0.4025113
	speed: 0.0058s/iter; left time: 20.5412s
	iters: 200, epoch: 2 | loss: 0.4644915
	speed: 0.0025s/iter; left time: 8.5365s
	iters: 300, epoch: 2 | loss: 0.6438734
	speed: 0.0025s/iter; left time: 8.4355s
	iters: 400, epoch: 2 | loss: 0.3229727
	speed: 0.0025s/iter; left time: 8.2019s
	iters: 500, epoch: 2 | loss: 1.1927822
	speed: 0.0025s/iter; left time: 7.9171s
Updating learning rate to 0.0008313570410112075
Epoch: 2 cost time: 1.3368618488311768
Epoch: 2, Steps: 523 | Train Loss: 0.6053262 Vali Loss: 0.2928340 Best vali loss: 0.2848577
	iters: 100, epoch: 3 | loss: 0.4749742
	speed: 0.0054s/iter; left time: 16.3975s
	iters: 200, epoch: 3 | loss: 0.5998265
	speed: 0.0021s/iter; left time: 6.1994s
	iters: 300, epoch: 3 | loss: 0.2502310
	speed: 0.0023s/iter; left time: 6.5552s
	iters: 400, epoch: 3 | loss: 0.5727003
	speed: 0.0022s/iter; left time: 6.0685s
	iters: 500, epoch: 3 | loss: 0.3875963
	speed: 0.0022s/iter; left time: 5.9011s
Updating learning rate to 0.0006733636229757597
Epoch: 3 cost time: 1.1875226497650146
Epoch: 3, Steps: 523 | Train Loss: 0.4570656 Vali Loss: 0.2877247 Best vali loss: 0.2848577
	iters: 100, epoch: 4 | loss: 0.2248577
	speed: 0.0055s/iter; left time: 13.9576s
	iters: 200, epoch: 4 | loss: 0.3921389
	speed: 0.0023s/iter; left time: 5.4596s
	iters: 300, epoch: 4 | loss: 0.2697579
	speed: 0.0024s/iter; left time: 5.5046s
	iters: 400, epoch: 4 | loss: 0.3692919
	speed: 0.0024s/iter; left time: 5.4283s
	iters: 500, epoch: 4 | loss: 0.4640865
	speed: 0.0025s/iter; left time: 5.1936s
Updating learning rate to 0.00048699767945
Epoch: 4 cost time: 1.2737362384796143
Epoch: 4, Steps: 523 | Train Loss: 0.3440266 Vali Loss: 0.2882961 Best vali loss: 0.2848577
	iters: 100, epoch: 5 | loss: 0.3773833
	speed: 0.0056s/iter; left time: 11.2208s
	iters: 200, epoch: 5 | loss: 0.3619715
	speed: 0.0021s/iter; left time: 4.0524s
	iters: 300, epoch: 5 | loss: 0.3115727
	speed: 0.0022s/iter; left time: 3.9516s
	iters: 400, epoch: 5 | loss: 0.4663841
	speed: 0.0022s/iter; left time: 3.7560s
	iters: 500, epoch: 5 | loss: 0.1892063
	speed: 0.0022s/iter; left time: 3.4574s
Updating learning rate to 0.00030063173592424026
Epoch: 5 cost time: 1.1862096786499023
Epoch: 5, Steps: 523 | Train Loss: 0.3413036 Vali Loss: 0.2932462 Best vali loss: 0.2848577
	iters: 100, epoch: 6 | loss: 0.2435016
	speed: 0.0055s/iter; left time: 8.0766s
	iters: 200, epoch: 6 | loss: 0.9678877
	speed: 0.0022s/iter; left time: 3.0510s
	iters: 300, epoch: 6 | loss: 0.3167164
	speed: 0.0022s/iter; left time: 2.8007s
	iters: 400, epoch: 6 | loss: 0.3155283
	speed: 0.0022s/iter; left time: 2.5762s
	iters: 500, epoch: 6 | loss: 0.2428034
	speed: 0.0022s/iter; left time: 2.3400s
Updating learning rate to 0.00014263831788879246
Epoch: 6 cost time: 1.1844613552093506
Epoch: 6, Steps: 523 | Train Loss: 0.4172875 Vali Loss: 0.2920068 Best vali loss: 0.2848577
	iters: 100, epoch: 7 | loss: 0.3353228
	speed: 0.0057s/iter; left time: 5.3554s
	iters: 200, epoch: 7 | loss: 0.3680242
	speed: 0.0023s/iter; left time: 1.9747s
	iters: 300, epoch: 7 | loss: 0.3625005
	speed: 0.0023s/iter; left time: 1.7133s
	iters: 400, epoch: 7 | loss: 0.3985942
	speed: 0.0023s/iter; left time: 1.4725s
	iters: 500, epoch: 7 | loss: 0.8050196
	speed: 0.0023s/iter; left time: 1.2505s
Updating learning rate to 3.707049102565253e-05
Epoch: 7 cost time: 1.2347335815429688
Epoch: 7, Steps: 523 | Train Loss: 0.4538922 Vali Loss: 0.2918147 Best vali loss: 0.2848577
	iters: 100, epoch: 8 | loss: 0.3440419
	speed: 0.0056s/iter; left time: 2.3780s
	iters: 200, epoch: 8 | loss: 0.3290723
	speed: 0.0024s/iter; left time: 0.7633s
	iters: 300, epoch: 8 | loss: 0.2474859
	speed: 0.0023s/iter; left time: 0.5061s
	iters: 400, epoch: 8 | loss: 0.4449703
	speed: 0.0023s/iter; left time: 0.2862s
	iters: 500, epoch: 8 | loss: 0.6256136
	speed: 0.0023s/iter; left time: 0.0560s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2555203437805176
Epoch: 8, Steps: 523 | Train Loss: 0.3982368 Vali Loss: 0.2921740 Best vali loss: 0.2848577

best validation loss 0.28485772438145074

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 2, 'learning_rate': 0.0011324263099, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5272060
	speed: 0.0091s/iter; left time: 8.6124s
Updating learning rate to 0.0011324263099
Validation loss decreased (inf --> 0.3016).  Saving model state dict ...
Epoch: 1 cost time: 0.7816257476806641
Epoch: 1, Steps: 131 | Train Loss: 0.5272060 Vali Loss: 0.3016279 Best vali loss: 0.3016279
	iters: 100, epoch: 2 | loss: 0.5263044
	speed: 0.0069s/iter; left time: 5.6617s
Updating learning rate to 0.00056621315495
Validation loss decreased (0.3016 --> 0.2900).  Saving model state dict ...
Epoch: 2 cost time: 0.5433065891265869
Epoch: 2, Steps: 131 | Train Loss: 0.5263044 Vali Loss: 0.2900160 Best vali loss: 0.2900160
	iters: 100, epoch: 3 | loss: 0.5035362
	speed: 0.0069s/iter; left time: 4.7160s
Updating learning rate to 0.000283106577475
Validation loss decreased (0.2900 --> 0.2852).  Saving model state dict ...
Epoch: 3 cost time: 0.5604462623596191
Epoch: 3, Steps: 131 | Train Loss: 0.5035362 Vali Loss: 0.2852088 Best vali loss: 0.2852088

best validation loss 0.28520881998889197

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0104119650236, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3021145
	speed: 0.0083s/iter; left time: 34.0140s
	iters: 200, epoch: 1 | loss: 0.2888950
	speed: 0.0031s/iter; left time: 12.5029s
	iters: 300, epoch: 1 | loss: 1.0613563
	speed: 0.0031s/iter; left time: 12.0911s
	iters: 400, epoch: 1 | loss: 0.6338803
	speed: 0.0033s/iter; left time: 12.3935s
	iters: 500, epoch: 1 | loss: 0.6573213
	speed: 0.0033s/iter; left time: 12.3276s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 1.9371941089630127
Epoch: 1, Steps: 523 | Train Loss: 0.5887135 Vali Loss: 0.2859156 Best vali loss: 0.2859156
	iters: 100, epoch: 2 | loss: 0.3304245
	speed: 0.0069s/iter; left time: 24.6629s
	iters: 200, epoch: 2 | loss: 0.2811194
	speed: 0.0029s/iter; left time: 10.1836s
	iters: 300, epoch: 2 | loss: 0.3576775
	speed: 0.0029s/iter; left time: 9.7409s
	iters: 400, epoch: 2 | loss: 1.0550510
	speed: 0.0030s/iter; left time: 9.6794s
	iters: 500, epoch: 2 | loss: 0.6991327
	speed: 0.0029s/iter; left time: 9.2331s
Updating learning rate to 0.0006629438250964442
Epoch: 2 cost time: 1.5761432647705078
Epoch: 2, Steps: 523 | Train Loss: 0.5446810 Vali Loss: 0.2896388 Best vali loss: 0.2859156
	iters: 100, epoch: 3 | loss: 0.3026146
	speed: 0.0072s/iter; left time: 21.7725s
	iters: 200, epoch: 3 | loss: 0.7299869
	speed: 0.0033s/iter; left time: 9.8139s
	iters: 300, epoch: 3 | loss: 0.3381527
	speed: 0.0033s/iter; left time: 9.4730s
	iters: 400, epoch: 3 | loss: 0.3782670
	speed: 0.0033s/iter; left time: 9.0106s
	iters: 500, epoch: 3 | loss: 0.2551947
	speed: 0.0032s/iter; left time: 8.4818s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 1.7657012939453125
Epoch: 3, Steps: 523 | Train Loss: 0.4008432 Vali Loss: 0.2881761 Best vali loss: 0.2859156

best validation loss 0.2859156408709813

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4490179
	speed: 0.0094s/iter; left time: 38.2970s
	iters: 200, epoch: 1 | loss: 0.2287445
	speed: 0.0043s/iter; left time: 17.0706s
	iters: 300, epoch: 1 | loss: 0.3933301
	speed: 0.0043s/iter; left time: 16.7912s
	iters: 400, epoch: 1 | loss: 0.2893254
	speed: 0.0043s/iter; left time: 16.3010s
	iters: 500, epoch: 1 | loss: 0.2972137
	speed: 0.0043s/iter; left time: 15.9642s
Updating learning rate to 0.00024547190550098694
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 2.5123207569122314
Epoch: 1, Steps: 523 | Train Loss: 0.3315263 Vali Loss: 0.2815192 Best vali loss: 0.2815192
	iters: 100, epoch: 2 | loss: 0.6809198
	speed: 0.0089s/iter; left time: 31.5373s
	iters: 200, epoch: 2 | loss: 0.2630097
	speed: 0.0042s/iter; left time: 14.6977s
	iters: 300, epoch: 2 | loss: 0.3781468
	speed: 0.0043s/iter; left time: 14.4989s
	iters: 400, epoch: 2 | loss: 0.3621638
	speed: 0.0043s/iter; left time: 14.1810s
	iters: 500, epoch: 2 | loss: 0.7301048
	speed: 0.0043s/iter; left time: 13.6612s
Updating learning rate to 0.00021781340639583926
Epoch: 2 cost time: 2.285498857498169
Epoch: 2, Steps: 523 | Train Loss: 0.4828690 Vali Loss: 0.2828785 Best vali loss: 0.2815192
	iters: 100, epoch: 3 | loss: 0.2464294
	speed: 0.0089s/iter; left time: 26.9139s
	iters: 200, epoch: 3 | loss: 0.2721457
	speed: 0.0043s/iter; left time: 12.7476s
	iters: 300, epoch: 3 | loss: 0.7900245
	speed: 0.0045s/iter; left time: 12.8698s
	iters: 400, epoch: 3 | loss: 0.5177693
	speed: 0.0043s/iter; left time: 11.7957s
	iters: 500, epoch: 3 | loss: 0.3562245
	speed: 0.0044s/iter; left time: 11.6157s
Updating learning rate to 0.000176419537248397
Epoch: 3 cost time: 2.3221983909606934
Epoch: 3, Steps: 523 | Train Loss: 0.4365187 Vali Loss: 0.2879959 Best vali loss: 0.2815192

best validation loss 0.28151918808327325

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3051588
	speed: 0.0093s/iter; left time: 23.3558s
	iters: 200, epoch: 4 | loss: 0.2218831
	speed: 0.0043s/iter; left time: 10.3303s
	iters: 300, epoch: 4 | loss: 0.4016658
	speed: 0.0043s/iter; left time: 9.8928s
	iters: 400, epoch: 4 | loss: 0.2469002
	speed: 0.0043s/iter; left time: 9.4237s
	iters: 500, epoch: 4 | loss: 0.3121797
	speed: 0.0043s/iter; left time: 9.0489s
Updating learning rate to 0.0001275921394
Epoch: 4 cost time: 2.47445011138916
Epoch: 4, Steps: 523 | Train Loss: 0.2975575 Vali Loss: 0.2896613 Best vali loss: 0.2815192
	iters: 100, epoch: 5 | loss: 0.6503955
	speed: 0.0089s/iter; left time: 17.8311s
	iters: 200, epoch: 5 | loss: 0.2942227
	speed: 0.0043s/iter; left time: 8.0852s
	iters: 300, epoch: 5 | loss: 0.3704202
	speed: 0.0043s/iter; left time: 7.6270s
	iters: 400, epoch: 5 | loss: 0.3250077
	speed: 0.0042s/iter; left time: 7.0809s
	iters: 500, epoch: 5 | loss: 0.6630563
	speed: 0.0043s/iter; left time: 6.7732s
Updating learning rate to 7.8764741551603e-05
Epoch: 5 cost time: 2.2737936973571777
Epoch: 5, Steps: 523 | Train Loss: 0.4606205 Vali Loss: 0.2886994 Best vali loss: 0.2815192
	iters: 100, epoch: 6 | loss: 0.2224621
	speed: 0.0085s/iter; left time: 12.5245s
	iters: 200, epoch: 6 | loss: 0.2824995
	speed: 0.0037s/iter; left time: 5.0550s
	iters: 300, epoch: 6 | loss: 0.6551967
	speed: 0.0037s/iter; left time: 4.6658s
	iters: 400, epoch: 6 | loss: 0.4587887
	speed: 0.0037s/iter; left time: 4.2816s
	iters: 500, epoch: 6 | loss: 0.3563856
	speed: 0.0037s/iter; left time: 3.9740s
Updating learning rate to 3.7370872404160736e-05
Epoch: 6 cost time: 1.9847955703735352
Epoch: 6, Steps: 523 | Train Loss: 0.3950665 Vali Loss: 0.3004967 Best vali loss: 0.2815192
	iters: 100, epoch: 7 | loss: 0.3854531
	speed: 0.0084s/iter; left time: 7.9258s
	iters: 200, epoch: 7 | loss: 0.3214618
	speed: 0.0041s/iter; left time: 3.4367s
	iters: 300, epoch: 7 | loss: 0.3702722
	speed: 0.0040s/iter; left time: 2.9887s
	iters: 400, epoch: 7 | loss: 0.5555147
	speed: 0.0040s/iter; left time: 2.6021s
	iters: 500, epoch: 7 | loss: 0.3246212
	speed: 0.0040s/iter; left time: 2.1916s
Updating learning rate to 9.71237329901307e-06
Epoch: 7 cost time: 2.139662981033325
Epoch: 7, Steps: 523 | Train Loss: 0.3914646 Vali Loss: 0.2880514 Best vali loss: 0.2815192
	iters: 100, epoch: 8 | loss: 0.5541704
	speed: 0.0088s/iter; left time: 3.7281s
	iters: 200, epoch: 8 | loss: 0.2018998
	speed: 0.0043s/iter; left time: 1.3931s
	iters: 300, epoch: 8 | loss: 0.2975245
	speed: 0.0043s/iter; left time: 0.9627s
	iters: 400, epoch: 8 | loss: 0.6691319
	speed: 0.0043s/iter; left time: 0.5328s
	iters: 500, epoch: 8 | loss: 0.4479876
	speed: 0.0043s/iter; left time: 0.1036s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2889647483825684
Epoch: 8, Steps: 523 | Train Loss: 0.4341428 Vali Loss: 0.2930956 Best vali loss: 0.2815192

best validation loss 0.28151918808327325

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003922949282, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3854233
	speed: 0.0089s/iter; left time: 17.7640s
	iters: 200, epoch: 1 | loss: 1.0131472
	speed: 0.0037s/iter; left time: 6.9446s
Updating learning rate to 0.0003922949282
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 1.2155816555023193
Epoch: 1, Steps: 262 | Train Loss: 0.6992853 Vali Loss: 0.2931876 Best vali loss: 0.2931876
	iters: 100, epoch: 2 | loss: 0.3302132
	speed: 0.0080s/iter; left time: 13.9311s
	iters: 200, epoch: 2 | loss: 0.4385679
	speed: 0.0035s/iter; left time: 5.7271s
Updating learning rate to 0.0001961474641
Validation loss decreased (0.2932 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 0.9764788150787354
Epoch: 2, Steps: 262 | Train Loss: 0.3843905 Vali Loss: 0.2824766 Best vali loss: 0.2824766
	iters: 100, epoch: 3 | loss: 0.4513506
	speed: 0.0079s/iter; left time: 11.5947s
	iters: 200, epoch: 3 | loss: 0.4565056
	speed: 0.0034s/iter; left time: 4.7183s
Updating learning rate to 9.807373205e-05
Epoch: 3 cost time: 0.9355905055999756
Epoch: 3, Steps: 262 | Train Loss: 0.4539281 Vali Loss: 0.2836453 Best vali loss: 0.2824766
	iters: 100, epoch: 4 | loss: 0.5273002
	speed: 0.0077s/iter; left time: 9.3039s
	iters: 200, epoch: 4 | loss: 0.3134957
	speed: 0.0034s/iter; left time: 3.7572s
Updating learning rate to 4.9036866025e-05
Epoch: 4 cost time: 0.9389381408691406
Epoch: 4, Steps: 262 | Train Loss: 0.4203979 Vali Loss: 0.2868841 Best vali loss: 0.2824766
	iters: 100, epoch: 5 | loss: 0.4119805
	speed: 0.0076s/iter; left time: 7.2392s
	iters: 200, epoch: 5 | loss: 0.6100244
	speed: 0.0034s/iter; left time: 2.8969s
Updating learning rate to 2.45184330125e-05
Epoch: 5 cost time: 0.937990665435791
Epoch: 5, Steps: 262 | Train Loss: 0.5110025 Vali Loss: 0.2903312 Best vali loss: 0.2824766
	iters: 100, epoch: 6 | loss: 0.4192125
	speed: 0.0079s/iter; left time: 5.4273s
	iters: 200, epoch: 6 | loss: 0.4791647
	speed: 0.0036s/iter; left time: 2.1166s
Updating learning rate to 1.225921650625e-05
Epoch: 6 cost time: 0.9844770431518555
Epoch: 6, Steps: 262 | Train Loss: 0.4491886 Vali Loss: 0.2879720 Best vali loss: 0.2824766
	iters: 100, epoch: 7 | loss: 0.2850830
	speed: 0.0080s/iter; left time: 3.4159s
	iters: 200, epoch: 7 | loss: 0.5029287
	speed: 0.0036s/iter; left time: 1.1703s
Updating learning rate to 6.129608253125e-06
Epoch: 7 cost time: 0.9877841472625732
Epoch: 7, Steps: 262 | Train Loss: 0.3940058 Vali Loss: 0.2870049 Best vali loss: 0.2824766
	iters: 100, epoch: 8 | loss: 0.3949432
	speed: 0.0079s/iter; left time: 1.2863s
	iters: 200, epoch: 8 | loss: 0.3245258
	speed: 0.0033s/iter; left time: 0.2080s
Updating learning rate to 3.0648041265625e-06
Epoch: 8 cost time: 0.9166886806488037
Epoch: 8, Steps: 262 | Train Loss: 0.3597345 Vali Loss: 0.2879853 Best vali loss: 0.2824766

best validation loss 0.2824766136326281

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024943532487, 'e_layers': 3, 'learning_rate': 0.0040105616226, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040105616226
Validation loss decreased (inf --> 0.3124).  Saving model state dict ...
Epoch: 1 cost time: 0.7045633792877197
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3124450 Best vali loss: 0.3124450
Updating learning rate to 0.0020052808113
Epoch: 2 cost time: 0.47771453857421875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3162660 Best vali loss: 0.3124450
Updating learning rate to 0.00100264040565
Epoch: 3 cost time: 0.4843637943267822
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3283541 Best vali loss: 0.3124450
Updating learning rate to 0.000501320202825
Epoch: 4 cost time: 0.49196839332580566
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3227541 Best vali loss: 0.3124450
Updating learning rate to 0.0002506601014125
Epoch: 5 cost time: 0.48975658416748047
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3223104 Best vali loss: 0.3124450
Updating learning rate to 0.00012533005070625
Epoch: 6 cost time: 0.4835524559020996
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3201636 Best vali loss: 0.3124450
Updating learning rate to 6.2665025353125e-05
Epoch: 7 cost time: 0.480731725692749
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3191121 Best vali loss: 0.3124450
Updating learning rate to 3.13325126765625e-05
Epoch: 8 cost time: 0.4806530475616455
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3186393 Best vali loss: 0.3124450

best validation loss 0.312445009495078

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025792385667, 'e_layers': 3, 'learning_rate': 0.0026285535245, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3373491
	speed: 0.0094s/iter; left time: 18.8492s
	iters: 200, epoch: 1 | loss: 0.4412858
	speed: 0.0043s/iter; left time: 8.1271s
Updating learning rate to 0.0026285535245
Validation loss decreased (inf --> 0.2888).  Saving model state dict ...
Epoch: 1 cost time: 1.396583080291748
Epoch: 1, Steps: 262 | Train Loss: 0.3893175 Vali Loss: 0.2888423 Best vali loss: 0.2888423
	iters: 100, epoch: 2 | loss: 0.2823509
	speed: 0.0091s/iter; left time: 15.8013s
	iters: 200, epoch: 2 | loss: 0.3011267
	speed: 0.0038s/iter; left time: 6.1829s
Updating learning rate to 0.00131427676225
Validation loss decreased (0.2888 --> 0.2845).  Saving model state dict ...
Epoch: 2 cost time: 1.0469653606414795
Epoch: 2, Steps: 262 | Train Loss: 0.2917388 Vali Loss: 0.2844888 Best vali loss: 0.2844888
	iters: 100, epoch: 3 | loss: 0.6985266
	speed: 0.0086s/iter; left time: 12.6024s
	iters: 200, epoch: 3 | loss: 0.2732630
	speed: 0.0038s/iter; left time: 5.2749s
Updating learning rate to 0.000657138381125
Epoch: 3 cost time: 1.0445528030395508
Epoch: 3, Steps: 262 | Train Loss: 0.4858948 Vali Loss: 0.2987618 Best vali loss: 0.2844888

best validation loss 0.28448883071403247

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037879290128, 'e_layers': 3, 'learning_rate': 0.0044980854811, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3789203
	speed: 0.0095s/iter; left time: 38.7229s
	iters: 200, epoch: 1 | loss: 0.3634589
	speed: 0.0043s/iter; left time: 17.0163s
	iters: 300, epoch: 1 | loss: 0.2934112
	speed: 0.0042s/iter; left time: 16.2398s
	iters: 400, epoch: 1 | loss: 0.9464574
	speed: 0.0042s/iter; left time: 15.8521s
	iters: 500, epoch: 1 | loss: 1.1356184
	speed: 0.0041s/iter; left time: 15.2659s
Updating learning rate to 0.0044980854811
Validation loss decreased (inf --> 0.3216).  Saving model state dict ...
Epoch: 1 cost time: 2.469834089279175
Epoch: 1, Steps: 523 | Train Loss: 0.6235733 Vali Loss: 0.3216251 Best vali loss: 0.3216251
	iters: 100, epoch: 2 | loss: 0.3725041
	speed: 0.0084s/iter; left time: 29.9316s
	iters: 200, epoch: 2 | loss: 0.4954911
	speed: 0.0040s/iter; left time: 13.9226s
	iters: 300, epoch: 2 | loss: 0.3454778
	speed: 0.0042s/iter; left time: 14.2256s
	iters: 400, epoch: 2 | loss: 0.5830785
	speed: 0.0045s/iter; left time: 14.5924s
	iters: 500, epoch: 2 | loss: 0.7824008
	speed: 0.0045s/iter; left time: 14.3175s
Updating learning rate to 0.00224904274055
Epoch: 2 cost time: 2.267995834350586
Epoch: 2, Steps: 523 | Train Loss: 0.5157905 Vali Loss: 0.3218797 Best vali loss: 0.3216251
	iters: 100, epoch: 3 | loss: 0.4131723
	speed: 0.0090s/iter; left time: 27.2668s
	iters: 200, epoch: 3 | loss: 0.4990520
	speed: 0.0044s/iter; left time: 12.9739s
	iters: 300, epoch: 3 | loss: 0.4702969
	speed: 0.0045s/iter; left time: 12.6510s
	iters: 400, epoch: 3 | loss: 0.2736774
	speed: 0.0045s/iter; left time: 12.3434s
	iters: 500, epoch: 3 | loss: 0.8353714
	speed: 0.0043s/iter; left time: 11.4200s
Updating learning rate to 0.001124521370275
Epoch: 3 cost time: 2.3567752838134766
Epoch: 3, Steps: 523 | Train Loss: 0.4983140 Vali Loss: 0.3241115 Best vali loss: 0.3216251

best validation loss 0.3216250584543571

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3635587
	speed: 0.0085s/iter; left time: 34.7427s
	iters: 200, epoch: 1 | loss: 0.3306994
	speed: 0.0034s/iter; left time: 13.6755s
	iters: 300, epoch: 1 | loss: 0.2190373
	speed: 0.0034s/iter; left time: 13.3435s
	iters: 400, epoch: 1 | loss: 0.6177989
	speed: 0.0034s/iter; left time: 12.8449s
	iters: 500, epoch: 1 | loss: 0.2510086
	speed: 0.0034s/iter; left time: 12.7060s
Updating learning rate to 0.00016522745149179477
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 2.051041603088379
Epoch: 1, Steps: 523 | Train Loss: 0.3564206 Vali Loss: 0.2799282 Best vali loss: 0.2799282
	iters: 100, epoch: 2 | loss: 0.3994833
	speed: 0.0073s/iter; left time: 25.9143s
	iters: 200, epoch: 2 | loss: 0.3972281
	speed: 0.0034s/iter; left time: 11.8360s
	iters: 300, epoch: 2 | loss: 0.6166841
	speed: 0.0035s/iter; left time: 11.6217s
	iters: 400, epoch: 2 | loss: 0.6795893
	speed: 0.0035s/iter; left time: 11.3273s
	iters: 500, epoch: 2 | loss: 0.3271731
	speed: 0.0034s/iter; left time: 10.7868s
Updating learning rate to 0.00014661048060095176
Validation loss decreased (0.2799 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 1.8279125690460205
Epoch: 2, Steps: 523 | Train Loss: 0.4840316 Vali Loss: 0.2765559 Best vali loss: 0.2765559
	iters: 100, epoch: 3 | loss: 0.4605504
	speed: 0.0072s/iter; left time: 21.9647s
	iters: 200, epoch: 3 | loss: 0.2784579
	speed: 0.0034s/iter; left time: 10.0907s
	iters: 300, epoch: 3 | loss: 0.5593733
	speed: 0.0033s/iter; left time: 9.4819s
	iters: 400, epoch: 3 | loss: 0.3985837
	speed: 0.0034s/iter; left time: 9.2449s
	iters: 500, epoch: 3 | loss: 0.4667594
	speed: 0.0033s/iter; left time: 8.7000s
Updating learning rate to 0.0001187482146823405
Epoch: 3 cost time: 1.7871334552764893
Epoch: 3, Steps: 523 | Train Loss: 0.4327449 Vali Loss: 0.2839651 Best vali loss: 0.2765559

best validation loss 0.2765558929071412

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3260203
	speed: 0.0086s/iter; left time: 21.6747s
	iters: 200, epoch: 4 | loss: 0.3097528
	speed: 0.0034s/iter; left time: 8.2704s
	iters: 300, epoch: 4 | loss: 0.2101338
	speed: 0.0034s/iter; left time: 7.8964s
	iters: 400, epoch: 4 | loss: 0.5125546
	speed: 0.0034s/iter; left time: 7.6286s
	iters: 500, epoch: 4 | loss: 0.2499328
	speed: 0.0033s/iter; left time: 6.9725s
Updating learning rate to 8.588243115e-05
Epoch: 4 cost time: 2.0354416370391846
Epoch: 4, Steps: 523 | Train Loss: 0.3216789 Vali Loss: 0.2781674 Best vali loss: 0.2765559
	iters: 100, epoch: 5 | loss: 0.3636679
	speed: 0.0074s/iter; left time: 14.7444s
	iters: 200, epoch: 5 | loss: 0.3883089
	speed: 0.0035s/iter; left time: 6.6050s
	iters: 300, epoch: 5 | loss: 0.5309802
	speed: 0.0034s/iter; left time: 6.1857s
	iters: 400, epoch: 5 | loss: 0.6002225
	speed: 0.0034s/iter; left time: 5.7040s
	iters: 500, epoch: 5 | loss: 0.3114960
	speed: 0.0034s/iter; left time: 5.3545s
Updating learning rate to 5.30166476176595e-05
Epoch: 5 cost time: 1.8251454830169678
Epoch: 5, Steps: 523 | Train Loss: 0.4389351 Vali Loss: 0.2827198 Best vali loss: 0.2765559
	iters: 100, epoch: 6 | loss: 0.4517758
	speed: 0.0073s/iter; left time: 10.7649s
	iters: 200, epoch: 6 | loss: 0.2576323
	speed: 0.0034s/iter; left time: 4.7044s
	iters: 300, epoch: 6 | loss: 0.5037534
	speed: 0.0034s/iter; left time: 4.2733s
	iters: 400, epoch: 6 | loss: 0.3819954
	speed: 0.0034s/iter; left time: 3.9282s
	iters: 500, epoch: 6 | loss: 0.4224348
	speed: 0.0034s/iter; left time: 3.5869s
Updating learning rate to 2.515438169904822e-05
Epoch: 6 cost time: 1.8206748962402344
Epoch: 6, Steps: 523 | Train Loss: 0.4035183 Vali Loss: 0.2874173 Best vali loss: 0.2765559
	iters: 100, epoch: 7 | loss: 0.4514321
	speed: 0.0072s/iter; left time: 6.8269s
	iters: 200, epoch: 7 | loss: 0.7271316
	speed: 0.0034s/iter; left time: 2.8455s
	iters: 300, epoch: 7 | loss: 0.6489282
	speed: 0.0034s/iter; left time: 2.5414s
	iters: 400, epoch: 7 | loss: 0.6788515
	speed: 0.0033s/iter; left time: 2.1565s
	iters: 500, epoch: 7 | loss: 0.3529397
	speed: 0.0034s/iter; left time: 1.8621s
Updating learning rate to 6.53741080820523e-06
Epoch: 7 cost time: 1.811540126800537
Epoch: 7, Steps: 523 | Train Loss: 0.5718566 Vali Loss: 0.2869789 Best vali loss: 0.2765559
	iters: 100, epoch: 8 | loss: 0.3941749
	speed: 0.0073s/iter; left time: 3.0995s
	iters: 200, epoch: 8 | loss: 0.2665392
	speed: 0.0033s/iter; left time: 1.0793s
	iters: 300, epoch: 8 | loss: 0.1676047
	speed: 0.0033s/iter; left time: 0.7464s
	iters: 400, epoch: 8 | loss: 0.5785202
	speed: 0.0033s/iter; left time: 0.4141s
	iters: 500, epoch: 8 | loss: 0.3803796
	speed: 0.0033s/iter; left time: 0.0801s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.778649091720581
Epoch: 8, Steps: 523 | Train Loss: 0.3574437 Vali Loss: 0.2851662 Best vali loss: 0.2765559

best validation loss 0.2765558929071412

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011023654446, 'e_layers': 1, 'learning_rate': 0.0011214708245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5026022
	speed: 0.0082s/iter; left time: 7.7801s
Updating learning rate to 0.0010787873827820538
Validation loss decreased (inf --> 0.2866).  Saving model state dict ...
Epoch: 1 cost time: 0.6470246315002441
Epoch: 1, Steps: 131 | Train Loss: 0.5026022 Vali Loss: 0.2865963 Best vali loss: 0.2865963
	iters: 100, epoch: 2 | loss: 0.6650184
	speed: 0.0053s/iter; left time: 4.3481s
Updating learning rate to 0.0009572352247034093
Epoch: 2 cost time: 0.39141416549682617
Epoch: 2, Steps: 131 | Train Loss: 0.6650184 Vali Loss: 0.2878625 Best vali loss: 0.2865963
	iters: 100, epoch: 3 | loss: 0.5450752
	speed: 0.0052s/iter; left time: 3.5997s
Updating learning rate to 0.0007753195644584837
Epoch: 3 cost time: 0.41139793395996094
Epoch: 3, Steps: 131 | Train Loss: 0.5450752 Vali Loss: 0.2916703 Best vali loss: 0.2865963
	iters: 100, epoch: 4 | loss: 0.4715605
	speed: 0.0053s/iter; left time: 2.9414s
Updating learning rate to 0.00056073541225
Epoch: 4 cost time: 0.41034388542175293
Epoch: 4, Steps: 131 | Train Loss: 0.4715605 Vali Loss: 0.2983496 Best vali loss: 0.2865963
	iters: 100, epoch: 5 | loss: 0.3371381
	speed: 0.0052s/iter; left time: 2.1972s
Updating learning rate to 0.0003461512600415164
Epoch: 5 cost time: 0.38709020614624023
Epoch: 5, Steps: 131 | Train Loss: 0.3371381 Vali Loss: 0.3001704 Best vali loss: 0.2865963
	iters: 100, epoch: 6 | loss: 0.2788594
	speed: 0.0052s/iter; left time: 1.5236s
Updating learning rate to 0.00016423559979659077
Epoch: 6 cost time: 0.39206552505493164
Epoch: 6, Steps: 131 | Train Loss: 0.2788594 Vali Loss: 0.3138288 Best vali loss: 0.2865963
	iters: 100, epoch: 7 | loss: 0.3406380
	speed: 0.0054s/iter; left time: 0.8746s
Updating learning rate to 4.268344171794636e-05
Epoch: 7 cost time: 0.42604565620422363
Epoch: 7, Steps: 131 | Train Loss: 0.3406380 Vali Loss: 0.3132280 Best vali loss: 0.2865963
	iters: 100, epoch: 8 | loss: 0.2635237
	speed: 0.0056s/iter; left time: 0.1788s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43832874298095703
Epoch: 8, Steps: 131 | Train Loss: 0.2635237 Vali Loss: 0.3183649 Best vali loss: 0.2865963

best validation loss 0.28659631184438383

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0064522030262, 'e_layers': 1, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2574273
	speed: 0.0074s/iter; left time: 60.9492s
	iters: 200, epoch: 1 | loss: 1.2072203
	speed: 0.0023s/iter; left time: 18.8476s
	iters: 300, epoch: 1 | loss: 0.4369274
	speed: 0.0023s/iter; left time: 18.4398s
	iters: 400, epoch: 1 | loss: 0.5986564
	speed: 0.0023s/iter; left time: 18.1711s
	iters: 500, epoch: 1 | loss: 0.2895896
	speed: 0.0023s/iter; left time: 17.8517s
	iters: 600, epoch: 1 | loss: 1.2747291
	speed: 0.0023s/iter; left time: 18.0741s
	iters: 700, epoch: 1 | loss: 0.5266356
	speed: 0.0023s/iter; left time: 17.9938s
	iters: 800, epoch: 1 | loss: 0.2018517
	speed: 0.0023s/iter; left time: 17.5651s
	iters: 900, epoch: 1 | loss: 0.4118254
	speed: 0.0023s/iter; left time: 17.3363s
	iters: 1000, epoch: 1 | loss: 1.7113016
	speed: 0.0023s/iter; left time: 17.2262s
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.3108).  Saving model state dict ...
Epoch: 1 cost time: 2.6780779361724854
Epoch: 1, Steps: 1045 | Train Loss: 0.6916164 Vali Loss: 0.3108082 Best vali loss: 0.3108082
	iters: 100, epoch: 2 | loss: 0.6154149
	speed: 0.0079s/iter; left time: 56.6890s
	iters: 200, epoch: 2 | loss: 0.4790758
	speed: 0.0022s/iter; left time: 15.7313s
	iters: 300, epoch: 2 | loss: 0.2779253
	speed: 0.0022s/iter; left time: 15.3289s
	iters: 400, epoch: 2 | loss: 0.3463203
	speed: 0.0022s/iter; left time: 14.9683s
	iters: 500, epoch: 2 | loss: 1.5517259
	speed: 0.0022s/iter; left time: 14.7879s
	iters: 600, epoch: 2 | loss: 1.2405906
	speed: 0.0021s/iter; left time: 14.3952s
	iters: 700, epoch: 2 | loss: 0.3931968
	speed: 0.0021s/iter; left time: 13.7901s
	iters: 800, epoch: 2 | loss: 0.3136251
	speed: 0.0021s/iter; left time: 13.6733s
	iters: 900, epoch: 2 | loss: 0.3939937
	speed: 0.0021s/iter; left time: 13.3991s
	iters: 1000, epoch: 2 | loss: 0.5110040
	speed: 0.0021s/iter; left time: 13.1482s
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.3108 --> 0.2950).  Saving model state dict ...
Epoch: 2 cost time: 2.2726337909698486
Epoch: 2, Steps: 1045 | Train Loss: 0.6122872 Vali Loss: 0.2949849 Best vali loss: 0.2949849
	iters: 100, epoch: 3 | loss: 1.2968434
	speed: 0.0081s/iter; left time: 50.2065s
	iters: 200, epoch: 3 | loss: 0.3839830
	speed: 0.0023s/iter; left time: 14.1543s
	iters: 300, epoch: 3 | loss: 0.2310542
	speed: 0.0024s/iter; left time: 14.0608s
	iters: 400, epoch: 3 | loss: 0.4594544
	speed: 0.0024s/iter; left time: 13.9314s
	iters: 500, epoch: 3 | loss: 0.3254491
	speed: 0.0023s/iter; left time: 13.4855s
	iters: 600, epoch: 3 | loss: 0.6181324
	speed: 0.0023s/iter; left time: 13.1422s
	iters: 700, epoch: 3 | loss: 0.2076610
	speed: 0.0024s/iter; left time: 13.1215s
	iters: 800, epoch: 3 | loss: 1.4056751
	speed: 0.0024s/iter; left time: 12.8905s
	iters: 900, epoch: 3 | loss: 0.4353624
	speed: 0.0024s/iter; left time: 12.7269s
	iters: 1000, epoch: 3 | loss: 1.4921107
	speed: 0.0023s/iter; left time: 12.1774s
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.2950 --> 0.2880).  Saving model state dict ...
Epoch: 3 cost time: 2.4807353019714355
Epoch: 3, Steps: 1045 | Train Loss: 0.6855726 Vali Loss: 0.2880293 Best vali loss: 0.2880293
	iters: 100, epoch: 4 | loss: 1.3002410
	speed: 0.0078s/iter; left time: 39.8010s
	iters: 200, epoch: 4 | loss: 0.7825229
	speed: 0.0022s/iter; left time: 11.3084s
	iters: 300, epoch: 4 | loss: 0.2390456
	speed: 0.0023s/iter; left time: 11.2089s
	iters: 400, epoch: 4 | loss: 0.4235728
	speed: 0.0023s/iter; left time: 11.2676s
	iters: 500, epoch: 4 | loss: 0.2835509
	speed: 0.0023s/iter; left time: 11.0146s
	iters: 600, epoch: 4 | loss: 0.2359954
	speed: 0.0023s/iter; left time: 10.5834s
	iters: 700, epoch: 4 | loss: 0.5531091
	speed: 0.0024s/iter; left time: 10.7288s
	iters: 800, epoch: 4 | loss: 0.7719905
	speed: 0.0025s/iter; left time: 11.0586s
	iters: 900, epoch: 4 | loss: 0.6498601
	speed: 0.0023s/iter; left time: 9.8082s
	iters: 1000, epoch: 4 | loss: 0.4184025
	speed: 0.0023s/iter; left time: 9.7040s
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.2880 --> 0.2846).  Saving model state dict ...
Epoch: 4 cost time: 2.4551920890808105
Epoch: 4, Steps: 1045 | Train Loss: 0.5658291 Vali Loss: 0.2846455 Best vali loss: 0.2846455
	iters: 100, epoch: 5 | loss: 0.2891217
	speed: 0.0076s/iter; left time: 31.0541s
	iters: 200, epoch: 5 | loss: 0.6555381
	speed: 0.0023s/iter; left time: 9.0738s
	iters: 300, epoch: 5 | loss: 0.2683520
	speed: 0.0022s/iter; left time: 8.6192s
	iters: 400, epoch: 5 | loss: 0.4532433
	speed: 0.0023s/iter; left time: 8.6628s
	iters: 500, epoch: 5 | loss: 0.9222870
	speed: 0.0023s/iter; left time: 8.3844s
	iters: 600, epoch: 5 | loss: 0.2940259
	speed: 0.0023s/iter; left time: 8.1866s
	iters: 700, epoch: 5 | loss: 0.3028597
	speed: 0.0023s/iter; left time: 7.9207s
	iters: 800, epoch: 5 | loss: 0.7738351
	speed: 0.0022s/iter; left time: 7.4830s
	iters: 900, epoch: 5 | loss: 0.2294365
	speed: 0.0022s/iter; left time: 7.2489s
	iters: 1000, epoch: 5 | loss: 1.5773780
	speed: 0.0022s/iter; left time: 7.0241s
Updating learning rate to 2.2430860606471416e-05
Validation loss decreased (0.2846 --> 0.2829).  Saving model state dict ...
Epoch: 5 cost time: 2.3863613605499268
Epoch: 5, Steps: 1045 | Train Loss: 0.5766077 Vali Loss: 0.2829109 Best vali loss: 0.2829109
	iters: 100, epoch: 6 | loss: 0.3698475
	speed: 0.0078s/iter; left time: 23.5803s
	iters: 200, epoch: 6 | loss: 0.2384103
	speed: 0.0022s/iter; left time: 6.5658s
	iters: 300, epoch: 6 | loss: 0.2937337
	speed: 0.0021s/iter; left time: 6.0595s
	iters: 400, epoch: 6 | loss: 0.2269532
	speed: 0.0021s/iter; left time: 5.8646s
	iters: 500, epoch: 6 | loss: 0.7061832
	speed: 0.0022s/iter; left time: 5.8864s
	iters: 600, epoch: 6 | loss: 0.5898536
	speed: 0.0022s/iter; left time: 5.6337s
	iters: 700, epoch: 6 | loss: 0.3456791
	speed: 0.0022s/iter; left time: 5.4628s
	iters: 800, epoch: 6 | loss: 0.2860546
	speed: 0.0022s/iter; left time: 5.1897s
	iters: 900, epoch: 6 | loss: 0.3916343
	speed: 0.0022s/iter; left time: 4.9903s
	iters: 1000, epoch: 6 | loss: 0.4156617
	speed: 0.0022s/iter; left time: 4.7839s
Updating learning rate to 1.0642589731482448e-05
Validation loss decreased (0.2829 --> 0.2822).  Saving model state dict ...
Epoch: 6 cost time: 2.3476853370666504
Epoch: 6, Steps: 1045 | Train Loss: 0.3864011 Vali Loss: 0.2821992 Best vali loss: 0.2821992
	iters: 100, epoch: 7 | loss: 0.4439602
	speed: 0.0078s/iter; left time: 15.5061s
	iters: 200, epoch: 7 | loss: 0.3912283
	speed: 0.0023s/iter; left time: 4.3673s
	iters: 300, epoch: 7 | loss: 0.1396813
	speed: 0.0023s/iter; left time: 4.1708s
	iters: 400, epoch: 7 | loss: 0.1750623
	speed: 0.0023s/iter; left time: 3.9236s
	iters: 500, epoch: 7 | loss: 0.3531923
	speed: 0.0023s/iter; left time: 3.6620s
	iters: 600, epoch: 7 | loss: 0.2624975
	speed: 0.0023s/iter; left time: 3.4865s
	iters: 700, epoch: 7 | loss: 0.3029902
	speed: 0.0023s/iter; left time: 3.1845s
	iters: 800, epoch: 7 | loss: 0.2271350
	speed: 0.0023s/iter; left time: 2.9725s
	iters: 900, epoch: 7 | loss: 0.2348271
	speed: 0.0023s/iter; left time: 2.7673s
	iters: 1000, epoch: 7 | loss: 1.2479016
	speed: 0.0022s/iter; left time: 2.4497s
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.2822 --> 0.2820).  Saving model state dict ...
Epoch: 7 cost time: 2.44284725189209
Epoch: 7, Steps: 1045 | Train Loss: 0.3778476 Vali Loss: 0.2819669 Best vali loss: 0.2819669
	iters: 100, epoch: 8 | loss: 0.4628459
	speed: 0.0077s/iter; left time: 7.3239s
	iters: 200, epoch: 8 | loss: 0.6237691
	speed: 0.0024s/iter; left time: 2.0075s
	iters: 300, epoch: 8 | loss: 0.2911073
	speed: 0.0024s/iter; left time: 1.7619s
	iters: 400, epoch: 8 | loss: 1.1472392
	speed: 0.0023s/iter; left time: 1.4916s
	iters: 500, epoch: 8 | loss: 0.6674773
	speed: 0.0023s/iter; left time: 1.2800s
	iters: 600, epoch: 8 | loss: 1.0323073
	speed: 0.0024s/iter; left time: 1.0560s
	iters: 700, epoch: 8 | loss: 0.2907352
	speed: 0.0023s/iter; left time: 0.8054s
	iters: 800, epoch: 8 | loss: 0.9756833
	speed: 0.0023s/iter; left time: 0.5675s
	iters: 900, epoch: 8 | loss: 0.8002651
	speed: 0.0023s/iter; left time: 0.3386s
	iters: 1000, epoch: 8 | loss: 0.3139566
	speed: 0.0023s/iter; left time: 0.1059s
Updating learning rate to 0.0
Validation loss decreased (0.2820 --> 0.2819).  Saving model state dict ...
Epoch: 8 cost time: 2.466311454772949
Epoch: 8, Steps: 1045 | Train Loss: 0.6605386 Vali Loss: 0.2819133 Best vali loss: 0.2819133

best validation loss 0.28191330676497295

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3637384
	speed: 0.0076s/iter; left time: 30.9965s
	iters: 200, epoch: 1 | loss: 0.3047040
	speed: 0.0025s/iter; left time: 9.9161s
	iters: 300, epoch: 1 | loss: 0.2813015
	speed: 0.0025s/iter; left time: 9.5208s
	iters: 400, epoch: 1 | loss: 0.2805530
	speed: 0.0024s/iter; left time: 9.1276s
	iters: 500, epoch: 1 | loss: 0.7388866
	speed: 0.0024s/iter; left time: 8.9869s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.5549290180206299
Epoch: 1, Steps: 523 | Train Loss: 0.3938367 Vali Loss: 0.2812825 Best vali loss: 0.2812825
	iters: 100, epoch: 2 | loss: 0.8950110
	speed: 0.0060s/iter; left time: 21.2506s
	iters: 200, epoch: 2 | loss: 0.3262127
	speed: 0.0025s/iter; left time: 8.4826s
	iters: 300, epoch: 2 | loss: 0.5716227
	speed: 0.0023s/iter; left time: 7.8948s
	iters: 400, epoch: 2 | loss: 0.3602797
	speed: 0.0023s/iter; left time: 7.6266s
	iters: 500, epoch: 2 | loss: 0.5751253
	speed: 0.0025s/iter; left time: 7.8656s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 1.3087215423583984
Epoch: 2, Steps: 523 | Train Loss: 0.5456503 Vali Loss: 0.2870563 Best vali loss: 0.2812825
	iters: 100, epoch: 3 | loss: 0.3761292
	speed: 0.0058s/iter; left time: 17.7776s
	iters: 200, epoch: 3 | loss: 0.3140514
	speed: 0.0025s/iter; left time: 7.3456s
	iters: 300, epoch: 3 | loss: 0.7795538
	speed: 0.0025s/iter; left time: 7.0997s
	iters: 400, epoch: 3 | loss: 0.7289696
	speed: 0.0025s/iter; left time: 6.8712s
	iters: 500, epoch: 3 | loss: 0.4006539
	speed: 0.0025s/iter; left time: 6.5854s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.3442444801330566
Epoch: 3, Steps: 523 | Train Loss: 0.5198716 Vali Loss: 0.2869582 Best vali loss: 0.2812825

best validation loss 0.2812824520857727

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002026610841687957
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 0.5066258907318115
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2847874 Best vali loss: 0.2847874
Updating learning rate to 0.001798262860126036
Epoch: 2 cost time: 0.2713358402252197
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2895182 Best vali loss: 0.2847874
Updating learning rate to 0.0014565159550274328
Epoch: 3 cost time: 0.266803503036499
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2980132 Best vali loss: 0.2847874

best validation loss 0.2847874210132636

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0103950152165, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5113344
	speed: 0.0082s/iter; left time: 7.7463s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.3003).  Saving model state dict ...
Epoch: 1 cost time: 0.6402959823608398
Epoch: 1, Steps: 131 | Train Loss: 0.5113344 Vali Loss: 0.3003059 Best vali loss: 0.3003059
	iters: 100, epoch: 2 | loss: 0.5838083
	speed: 0.0052s/iter; left time: 4.2396s
Updating learning rate to 0.00093122262415
Validation loss decreased (0.3003 --> 0.2857).  Saving model state dict ...
Epoch: 2 cost time: 0.39028072357177734
Epoch: 2, Steps: 131 | Train Loss: 0.5838083 Vali Loss: 0.2857102 Best vali loss: 0.2857102
	iters: 100, epoch: 3 | loss: 0.4315803
	speed: 0.0055s/iter; left time: 3.7684s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.4426417350769043
Epoch: 3, Steps: 131 | Train Loss: 0.4315803 Vali Loss: 0.2925256 Best vali loss: 0.2857102

best validation loss 0.28571022971882704

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3383949
	speed: 0.0074s/iter; left time: 18.5524s
	iters: 200, epoch: 4 | loss: 0.3101723
	speed: 0.0023s/iter; left time: 5.6063s
	iters: 300, epoch: 4 | loss: 0.2596475
	speed: 0.0023s/iter; left time: 5.3646s
	iters: 400, epoch: 4 | loss: 0.2885992
	speed: 0.0023s/iter; left time: 5.1212s
	iters: 500, epoch: 4 | loss: 0.5491480
	speed: 0.0023s/iter; left time: 4.8583s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 1.4685630798339844
Epoch: 4, Steps: 523 | Train Loss: 0.3491924 Vali Loss: 0.2934824 Best vali loss: 0.2812825
	iters: 100, epoch: 5 | loss: 0.7377104
	speed: 0.0059s/iter; left time: 11.6973s
	iters: 200, epoch: 5 | loss: 0.2860269
	speed: 0.0025s/iter; left time: 4.6775s
	iters: 300, epoch: 5 | loss: 0.5711975
	speed: 0.0025s/iter; left time: 4.5337s
	iters: 400, epoch: 5 | loss: 0.2735265
	speed: 0.0025s/iter; left time: 4.2521s
	iters: 500, epoch: 5 | loss: 0.5381053
	speed: 0.0023s/iter; left time: 3.7140s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 1.3151652812957764
Epoch: 5, Steps: 523 | Train Loss: 0.4813133 Vali Loss: 0.2946537 Best vali loss: 0.2812825
	iters: 100, epoch: 6 | loss: 0.3043368
	speed: 0.0056s/iter; left time: 8.2590s
	iters: 200, epoch: 6 | loss: 0.3116195
	speed: 0.0026s/iter; left time: 3.5070s
	iters: 300, epoch: 6 | loss: 0.6939540
	speed: 0.0022s/iter; left time: 2.8004s
	iters: 400, epoch: 6 | loss: 0.4854722
	speed: 0.0022s/iter; left time: 2.5713s
	iters: 500, epoch: 6 | loss: 0.4162645
	speed: 0.0023s/iter; left time: 2.4534s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 1.2465004920959473
Epoch: 6, Steps: 523 | Train Loss: 0.4423294 Vali Loss: 0.3015472 Best vali loss: 0.2812825
	iters: 100, epoch: 7 | loss: 0.4920908
	speed: 0.0057s/iter; left time: 5.3586s
	iters: 200, epoch: 7 | loss: 0.2045031
	speed: 0.0024s/iter; left time: 2.0656s
	iters: 300, epoch: 7 | loss: 0.3545263
	speed: 0.0025s/iter; left time: 1.8491s
	iters: 400, epoch: 7 | loss: 0.5396432
	speed: 0.0025s/iter; left time: 1.5966s
	iters: 500, epoch: 7 | loss: 0.4435726
	speed: 0.0025s/iter; left time: 1.3736s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 1.323718786239624
Epoch: 7, Steps: 523 | Train Loss: 0.4068672 Vali Loss: 0.2974046 Best vali loss: 0.2812825
	iters: 100, epoch: 8 | loss: 0.4158977
	speed: 0.0059s/iter; left time: 2.4886s
	iters: 200, epoch: 8 | loss: 0.4780506
	speed: 0.0025s/iter; left time: 0.8116s
	iters: 300, epoch: 8 | loss: 0.3756102
	speed: 0.0025s/iter; left time: 0.5594s
	iters: 400, epoch: 8 | loss: 0.2694542
	speed: 0.0025s/iter; left time: 0.3103s
	iters: 500, epoch: 8 | loss: 0.3183858
	speed: 0.0025s/iter; left time: 0.0604s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3411610126495361
Epoch: 8, Steps: 523 | Train Loss: 0.3714797 Vali Loss: 0.2986399 Best vali loss: 0.2812825

best validation loss 0.2812824520857727

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015627682118, 'e_layers': 4, 'learning_rate': 7.53636528e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6969698
	speed: 0.0107s/iter; left time: 10.1084s
Updating learning rate to 7.53636528e-05
Validation loss decreased (inf --> 0.3354).  Saving model state dict ...
Epoch: 1 cost time: 0.9829404354095459
Epoch: 1, Steps: 131 | Train Loss: 0.6969698 Vali Loss: 0.3354007 Best vali loss: 0.3354007
	iters: 100, epoch: 2 | loss: 0.6950095
	speed: 0.0093s/iter; left time: 7.6179s
Updating learning rate to 3.76818264e-05
Validation loss decreased (0.3354 --> 0.3193).  Saving model state dict ...
Epoch: 2 cost time: 0.7831406593322754
Epoch: 2, Steps: 131 | Train Loss: 0.6950095 Vali Loss: 0.3193046 Best vali loss: 0.3193046
	iters: 100, epoch: 3 | loss: 0.4995722
	speed: 0.0087s/iter; left time: 5.9987s
Updating learning rate to 1.88409132e-05
Validation loss decreased (0.3193 --> 0.3133).  Saving model state dict ...
Epoch: 3 cost time: 0.7019591331481934
Epoch: 3, Steps: 131 | Train Loss: 0.4995722 Vali Loss: 0.3132720 Best vali loss: 0.3132720
	iters: 100, epoch: 4 | loss: 0.5470237
	speed: 0.0083s/iter; left time: 4.6387s
Updating learning rate to 9.4204566e-06
Validation loss decreased (0.3133 --> 0.3108).  Saving model state dict ...
Epoch: 4 cost time: 0.6973021030426025
Epoch: 4, Steps: 131 | Train Loss: 0.5470237 Vali Loss: 0.3108467 Best vali loss: 0.3108467
	iters: 100, epoch: 5 | loss: 0.6394992
	speed: 0.0085s/iter; left time: 3.6217s
Updating learning rate to 4.7102283e-06
Validation loss decreased (0.3108 --> 0.3097).  Saving model state dict ...
Epoch: 5 cost time: 0.7072539329528809
Epoch: 5, Steps: 131 | Train Loss: 0.6394992 Vali Loss: 0.3096697 Best vali loss: 0.3096697
	iters: 100, epoch: 6 | loss: 0.3788335
	speed: 0.0083s/iter; left time: 2.4381s
Updating learning rate to 2.35511415e-06
Validation loss decreased (0.3097 --> 0.3091).  Saving model state dict ...
Epoch: 6 cost time: 0.6901209354400635
Epoch: 6, Steps: 131 | Train Loss: 0.3788335 Vali Loss: 0.3091236 Best vali loss: 0.3091236
	iters: 100, epoch: 7 | loss: 0.3626446
	speed: 0.0085s/iter; left time: 1.3812s
Updating learning rate to 1.177557075e-06
Validation loss decreased (0.3091 --> 0.3089).  Saving model state dict ...
Epoch: 7 cost time: 0.695746898651123
Epoch: 7, Steps: 131 | Train Loss: 0.3626446 Vali Loss: 0.3088500 Best vali loss: 0.3088500
	iters: 100, epoch: 8 | loss: 0.4084716
	speed: 0.0085s/iter; left time: 0.2723s
Updating learning rate to 5.887785375e-07
Validation loss decreased (0.3089 --> 0.3087).  Saving model state dict ...
Epoch: 8 cost time: 0.7019960880279541
Epoch: 8, Steps: 131 | Train Loss: 0.4084716 Vali Loss: 0.3087110 Best vali loss: 0.3087110

best validation loss 0.3087110299355215

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 4, 'learning_rate': 0.0040085882975, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9433817
	speed: 0.0101s/iter; left time: 83.6728s
	iters: 200, epoch: 1 | loss: 0.5935915
	speed: 0.0050s/iter; left time: 40.9045s
	iters: 300, epoch: 1 | loss: 0.7724891
	speed: 0.0050s/iter; left time: 40.4465s
	iters: 400, epoch: 1 | loss: 0.4160764
	speed: 0.0050s/iter; left time: 39.5187s
	iters: 500, epoch: 1 | loss: 0.2720425
	speed: 0.0049s/iter; left time: 38.7074s
	iters: 600, epoch: 1 | loss: 1.2014257
	speed: 0.0045s/iter; left time: 34.6550s
	iters: 700, epoch: 1 | loss: 0.3955585
	speed: 0.0045s/iter; left time: 34.3588s
	iters: 800, epoch: 1 | loss: 0.4085651
	speed: 0.0047s/iter; left time: 35.4278s
	iters: 900, epoch: 1 | loss: 0.3303247
	speed: 0.0047s/iter; left time: 34.8132s
	iters: 1000, epoch: 1 | loss: 0.8710249
	speed: 0.0047s/iter; left time: 34.7901s
Updating learning rate to 0.0038560204899122574
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 5.271824359893799
Epoch: 1, Steps: 1045 | Train Loss: 0.6204480 Vali Loss: 0.2939769 Best vali loss: 0.2939769
	iters: 100, epoch: 2 | loss: 0.4385764
	speed: 0.0133s/iter; left time: 95.7765s
	iters: 200, epoch: 2 | loss: 0.3661505
	speed: 0.0044s/iter; left time: 31.1544s
	iters: 300, epoch: 2 | loss: 0.3525063
	speed: 0.0045s/iter; left time: 31.5999s
	iters: 400, epoch: 2 | loss: 1.1240155
	speed: 0.0045s/iter; left time: 31.4338s
	iters: 500, epoch: 2 | loss: 0.9188031
	speed: 0.0045s/iter; left time: 30.6386s
	iters: 600, epoch: 2 | loss: 0.1950439
	speed: 0.0045s/iter; left time: 29.9643s
	iters: 700, epoch: 2 | loss: 0.3355860
	speed: 0.0045s/iter; left time: 29.5204s
	iters: 800, epoch: 2 | loss: 0.3701719
	speed: 0.0044s/iter; left time: 28.9793s
	iters: 900, epoch: 2 | loss: 0.3810033
	speed: 0.0045s/iter; left time: 28.5639s
	iters: 1000, epoch: 2 | loss: 0.3460379
	speed: 0.0044s/iter; left time: 27.9438s
Updating learning rate to 0.0034215441328236435
Validation loss decreased (0.2940 --> 0.2856).  Saving model state dict ...
Epoch: 2 cost time: 4.694298505783081
Epoch: 2, Steps: 1045 | Train Loss: 0.4827895 Vali Loss: 0.2855510 Best vali loss: 0.2855510
	iters: 100, epoch: 3 | loss: 0.3700943
	speed: 0.0136s/iter; left time: 83.9310s
	iters: 200, epoch: 3 | loss: 0.1417271
	speed: 0.0050s/iter; left time: 30.3152s
	iters: 300, epoch: 3 | loss: 1.1351030
	speed: 0.0050s/iter; left time: 29.8175s
	iters: 400, epoch: 3 | loss: 0.2638942
	speed: 0.0050s/iter; left time: 29.2205s
	iters: 500, epoch: 3 | loss: 0.2409591
	speed: 0.0050s/iter; left time: 28.6107s
	iters: 600, epoch: 3 | loss: 0.5791138
	speed: 0.0049s/iter; left time: 28.0322s
	iters: 700, epoch: 3 | loss: 0.2739435
	speed: 0.0050s/iter; left time: 27.8512s
	iters: 800, epoch: 3 | loss: 1.0809767
	speed: 0.0050s/iter; left time: 27.2854s
	iters: 900, epoch: 3 | loss: 0.5301421
	speed: 0.0050s/iter; left time: 26.6167s
	iters: 1000, epoch: 3 | loss: 0.3062083
	speed: 0.0050s/iter; left time: 26.3400s
Updating learning rate to 0.002771304313062916
Validation loss decreased (0.2856 --> 0.2848).  Saving model state dict ...
Epoch: 3 cost time: 5.2397143840789795
Epoch: 3, Steps: 1045 | Train Loss: 0.4922162 Vali Loss: 0.2847540 Best vali loss: 0.2847540
	iters: 100, epoch: 4 | loss: 1.2704142
	speed: 0.0136s/iter; left time: 69.5669s
	iters: 200, epoch: 4 | loss: 0.3204032
	speed: 0.0050s/iter; left time: 25.1786s
	iters: 300, epoch: 4 | loss: 0.2925697
	speed: 0.0050s/iter; left time: 24.8483s
	iters: 400, epoch: 4 | loss: 0.3241333
	speed: 0.0050s/iter; left time: 24.3168s
	iters: 500, epoch: 4 | loss: 1.0272796
	speed: 0.0050s/iter; left time: 23.6009s
	iters: 600, epoch: 4 | loss: 0.2530172
	speed: 0.0050s/iter; left time: 23.2615s
	iters: 700, epoch: 4 | loss: 0.7724935
	speed: 0.0050s/iter; left time: 22.5352s
	iters: 800, epoch: 4 | loss: 0.2941602
	speed: 0.0050s/iter; left time: 22.1761s
	iters: 900, epoch: 4 | loss: 0.3510138
	speed: 0.0050s/iter; left time: 21.7104s
	iters: 1000, epoch: 4 | loss: 0.3979709
	speed: 0.0050s/iter; left time: 21.2105s
Updating learning rate to 0.00200429414875
Epoch: 4 cost time: 5.269548177719116
Epoch: 4, Steps: 1045 | Train Loss: 0.5303456 Vali Loss: 0.2869800 Best vali loss: 0.2847540
	iters: 100, epoch: 5 | loss: 1.2674564
	speed: 0.0137s/iter; left time: 55.9536s
	iters: 200, epoch: 5 | loss: 0.7226645
	speed: 0.0050s/iter; left time: 20.0334s
	iters: 300, epoch: 5 | loss: 0.2667441
	speed: 0.0050s/iter; left time: 19.5572s
	iters: 400, epoch: 5 | loss: 0.4582301
	speed: 0.0050s/iter; left time: 18.9471s
	iters: 500, epoch: 5 | loss: 0.4063487
	speed: 0.0050s/iter; left time: 18.4920s
	iters: 600, epoch: 5 | loss: 0.4657378
	speed: 0.0050s/iter; left time: 17.9965s
	iters: 700, epoch: 5 | loss: 0.5349247
	speed: 0.0050s/iter; left time: 17.4349s
	iters: 800, epoch: 5 | loss: 0.4297818
	speed: 0.0050s/iter; left time: 16.9064s
	iters: 900, epoch: 5 | loss: 0.3068953
	speed: 0.0050s/iter; left time: 16.4749s
	iters: 1000, epoch: 5 | loss: 0.3111647
	speed: 0.0050s/iter; left time: 16.0055s
Updating learning rate to 0.0012372839844370842
Epoch: 5 cost time: 5.283095359802246
Epoch: 5, Steps: 1045 | Train Loss: 0.5169948 Vali Loss: 0.2916789 Best vali loss: 0.2847540
	iters: 100, epoch: 6 | loss: 0.1915994
	speed: 0.0135s/iter; left time: 41.1295s
	iters: 200, epoch: 6 | loss: 0.3827949
	speed: 0.0047s/iter; left time: 13.6540s
	iters: 300, epoch: 6 | loss: 0.3899971
	speed: 0.0047s/iter; left time: 13.4090s
	iters: 400, epoch: 6 | loss: 0.2372272
	speed: 0.0048s/iter; left time: 13.1029s
	iters: 500, epoch: 6 | loss: 0.2534129
	speed: 0.0046s/iter; left time: 12.2554s
	iters: 600, epoch: 6 | loss: 0.3337823
	speed: 0.0047s/iter; left time: 11.8100s
	iters: 700, epoch: 6 | loss: 0.4954263
	speed: 0.0046s/iter; left time: 11.3128s
	iters: 800, epoch: 6 | loss: 0.2093746
	speed: 0.0047s/iter; left time: 10.8965s
	iters: 900, epoch: 6 | loss: 0.3066687
	speed: 0.0047s/iter; left time: 10.4332s
	iters: 1000, epoch: 6 | loss: 0.4389338
	speed: 0.0047s/iter; left time: 9.9445s
Updating learning rate to 0.0005870441646763563
Epoch: 6 cost time: 4.921124219894409
Epoch: 6, Steps: 1045 | Train Loss: 0.3239217 Vali Loss: 0.2991705 Best vali loss: 0.2847540
	iters: 100, epoch: 7 | loss: 0.5071208
	speed: 0.0135s/iter; left time: 26.8209s
	iters: 200, epoch: 7 | loss: 0.3781359
	speed: 0.0051s/iter; left time: 9.5503s
	iters: 300, epoch: 7 | loss: 0.6090031
	speed: 0.0051s/iter; left time: 9.0617s
	iters: 400, epoch: 7 | loss: 0.5147130
	speed: 0.0050s/iter; left time: 8.4556s
	iters: 500, epoch: 7 | loss: 0.5062059
	speed: 0.0050s/iter; left time: 7.8907s
	iters: 600, epoch: 7 | loss: 0.2425456
	speed: 0.0050s/iter; left time: 7.4949s
	iters: 700, epoch: 7 | loss: 0.2804282
	speed: 0.0050s/iter; left time: 6.9557s
	iters: 800, epoch: 7 | loss: 0.3022161
	speed: 0.0050s/iter; left time: 6.4731s
	iters: 900, epoch: 7 | loss: 0.2701319
	speed: 0.0050s/iter; left time: 5.9882s
	iters: 1000, epoch: 7 | loss: 0.5391500
	speed: 0.0050s/iter; left time: 5.5000s
Updating learning rate to 0.0001525678075877426
Epoch: 7 cost time: 5.281235933303833
Epoch: 7, Steps: 1045 | Train Loss: 0.4149650 Vali Loss: 0.2969623 Best vali loss: 0.2847540
	iters: 100, epoch: 8 | loss: 0.2465176
	speed: 0.0136s/iter; left time: 12.8474s
	iters: 200, epoch: 8 | loss: 0.2675720
	speed: 0.0050s/iter; left time: 4.2295s
	iters: 300, epoch: 8 | loss: 0.6430027
	speed: 0.0050s/iter; left time: 3.7007s
	iters: 400, epoch: 8 | loss: 0.9025064
	speed: 0.0050s/iter; left time: 3.2257s
	iters: 500, epoch: 8 | loss: 0.1667968
	speed: 0.0050s/iter; left time: 2.7045s
	iters: 600, epoch: 8 | loss: 0.6759377
	speed: 0.0050s/iter; left time: 2.2440s
	iters: 700, epoch: 8 | loss: 0.1925682
	speed: 0.0050s/iter; left time: 1.7326s
	iters: 800, epoch: 8 | loss: 0.2998144
	speed: 0.0050s/iter; left time: 1.2310s
	iters: 900, epoch: 8 | loss: 1.5361770
	speed: 0.0050s/iter; left time: 0.7302s
	iters: 1000, epoch: 8 | loss: 0.3600080
	speed: 0.0050s/iter; left time: 0.2290s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.248826742172241
Epoch: 8, Steps: 1045 | Train Loss: 0.5290901 Vali Loss: 0.3006117 Best vali loss: 0.2847540

best validation loss 0.2847539530938866

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0042863874146, 'e_layers': 4, 'learning_rate': 5.37539066e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37539066e-05
Validation loss decreased (inf --> 0.3486).  Saving model state dict ...
Epoch: 1 cost time: 0.6780860424041748
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3486027 Best vali loss: 0.3486027
Updating learning rate to 2.68769533e-05
Validation loss decreased (0.3486 --> 0.3366).  Saving model state dict ...
Epoch: 2 cost time: 0.4499678611755371
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3366468 Best vali loss: 0.3366468
Updating learning rate to 1.343847665e-05
Validation loss decreased (0.3366 --> 0.3322).  Saving model state dict ...
Epoch: 3 cost time: 0.4573862552642822
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3322154 Best vali loss: 0.3322154

best validation loss 0.332215409433589

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019514269464, 'e_layers': 3, 'learning_rate': 0.0028203081441, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5894333
	speed: 0.0125s/iter; left time: 11.8574s
Updating learning rate to 0.002712966556904441
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 1.2175800800323486
Epoch: 1, Steps: 131 | Train Loss: 0.5894333 Vali Loss: 0.3200833 Best vali loss: 0.3200833
	iters: 100, epoch: 2 | loss: 0.5438456
	speed: 0.0122s/iter; left time: 9.9428s
Updating learning rate to 0.002407283578914378
Epoch: 2 cost time: 0.9939827919006348
Epoch: 2, Steps: 131 | Train Loss: 0.5438456 Vali Loss: 0.3293410 Best vali loss: 0.3200833
	iters: 100, epoch: 3 | loss: 0.4639833
	speed: 0.0120s/iter; left time: 8.2119s
Updating learning rate to 0.0019497966725057021
Epoch: 3 cost time: 0.9893879890441895
Epoch: 3, Steps: 131 | Train Loss: 0.4639833 Vali Loss: 0.3256455 Best vali loss: 0.3200833

best validation loss 0.3200832983626447

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4627684
	speed: 0.0103s/iter; left time: 20.6440s
	iters: 200, epoch: 1 | loss: 0.4208206
	speed: 0.0052s/iter; left time: 9.7803s
Updating learning rate to 0.00031785342192023166
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 1.6196465492248535
Epoch: 1, Steps: 262 | Train Loss: 0.4417945 Vali Loss: 0.2841347 Best vali loss: 0.2841347
	iters: 100, epoch: 2 | loss: 0.4478254
	speed: 0.0113s/iter; left time: 19.5684s
	iters: 200, epoch: 2 | loss: 0.4573703
	speed: 0.0053s/iter; left time: 8.6282s
Updating learning rate to 0.0002820393495610895
Validation loss decreased (0.2841 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 1.4402446746826172
Epoch: 2, Steps: 262 | Train Loss: 0.4525978 Vali Loss: 0.2826234 Best vali loss: 0.2826234
	iters: 100, epoch: 3 | loss: 0.4413480
	speed: 0.0107s/iter; left time: 15.7664s
	iters: 200, epoch: 3 | loss: 0.4024515
	speed: 0.0049s/iter; left time: 6.7747s
Updating learning rate to 0.00022843980248387857
Epoch: 3 cost time: 1.3078339099884033
Epoch: 3, Steps: 262 | Train Loss: 0.4218998 Vali Loss: 0.2848096 Best vali loss: 0.2826234

best validation loss 0.2826234357048473

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3870925
	speed: 0.0107s/iter; left time: 12.9985s
	iters: 200, epoch: 4 | loss: 0.4004986
	speed: 0.0053s/iter; left time: 5.9323s
Updating learning rate to 0.00016521482585
Epoch: 4 cost time: 1.663299560546875
Epoch: 4, Steps: 262 | Train Loss: 0.3937955 Vali Loss: 0.2869956 Best vali loss: 0.2826234
	iters: 100, epoch: 5 | loss: 0.4178544
	speed: 0.0108s/iter; left time: 10.2043s
	iters: 200, epoch: 5 | loss: 0.4650396
	speed: 0.0048s/iter; left time: 4.1168s
Updating learning rate to 0.00010198984921612144
Epoch: 5 cost time: 1.3121302127838135
Epoch: 5, Steps: 262 | Train Loss: 0.4414470 Vali Loss: 0.2957769 Best vali loss: 0.2826234
	iters: 100, epoch: 6 | loss: 0.4450401
	speed: 0.0102s/iter; left time: 7.0362s
	iters: 200, epoch: 6 | loss: 0.2871782
	speed: 0.0047s/iter; left time: 2.7508s
Updating learning rate to 4.8390302138910505e-05
Epoch: 6 cost time: 1.2749555110931396
Epoch: 6, Steps: 262 | Train Loss: 0.3661092 Vali Loss: 0.2957315 Best vali loss: 0.2826234
	iters: 100, epoch: 7 | loss: 0.6128438
	speed: 0.0107s/iter; left time: 4.5427s
	iters: 200, epoch: 7 | loss: 0.3591413
	speed: 0.0049s/iter; left time: 1.5911s
Updating learning rate to 1.2576229779768348e-05
Epoch: 7 cost time: 1.3241510391235352
Epoch: 7, Steps: 262 | Train Loss: 0.4859925 Vali Loss: 0.2965944 Best vali loss: 0.2826234
	iters: 100, epoch: 8 | loss: 0.3473563
	speed: 0.0104s/iter; left time: 1.6976s
	iters: 200, epoch: 8 | loss: 0.3297523
	speed: 0.0049s/iter; left time: 0.3066s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3206148147583008
Epoch: 8, Steps: 262 | Train Loss: 0.3385543 Vali Loss: 0.2988131 Best vali loss: 0.2826234

best validation loss 0.2826234357048473

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0061161357241, 'e_layers': 2, 'learning_rate': 0.0026491544935, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3993894
	speed: 0.0086s/iter; left time: 17.1878s
	iters: 200, epoch: 1 | loss: 0.3150782
	speed: 0.0032s/iter; left time: 5.9987s
Updating learning rate to 0.0026491544935
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.1152653694152832
Epoch: 1, Steps: 262 | Train Loss: 0.3572338 Vali Loss: 0.2813078 Best vali loss: 0.2813078
	iters: 100, epoch: 2 | loss: 0.4453451
	speed: 0.0074s/iter; left time: 12.9076s
	iters: 200, epoch: 2 | loss: 0.3697793
	speed: 0.0033s/iter; left time: 5.3403s
Updating learning rate to 0.00132457724675
Epoch: 2 cost time: 0.8868038654327393
Epoch: 2, Steps: 262 | Train Loss: 0.4075622 Vali Loss: 0.2852282 Best vali loss: 0.2813078
	iters: 100, epoch: 3 | loss: 0.3988144
	speed: 0.0078s/iter; left time: 11.4627s
	iters: 200, epoch: 3 | loss: 0.2168953
	speed: 0.0034s/iter; left time: 4.7355s
Updating learning rate to 0.000662288623375
Epoch: 3 cost time: 0.943640947341919
Epoch: 3, Steps: 262 | Train Loss: 0.3078549 Vali Loss: 0.2846854 Best vali loss: 0.2813078
	iters: 100, epoch: 4 | loss: 0.4175521
	speed: 0.0081s/iter; left time: 9.7907s
	iters: 200, epoch: 4 | loss: 0.2712150
	speed: 0.0035s/iter; left time: 3.8403s
Updating learning rate to 0.0003311443116875
Epoch: 4 cost time: 0.964385986328125
Epoch: 4, Steps: 262 | Train Loss: 0.3443836 Vali Loss: 0.2961046 Best vali loss: 0.2813078
	iters: 100, epoch: 5 | loss: 0.3629660
	speed: 0.0079s/iter; left time: 7.4774s
	iters: 200, epoch: 5 | loss: 0.2552904
	speed: 0.0036s/iter; left time: 3.0632s
Updating learning rate to 0.00016557215584375
Epoch: 5 cost time: 0.9795331954956055
Epoch: 5, Steps: 262 | Train Loss: 0.3091282 Vali Loss: 0.2950087 Best vali loss: 0.2813078
	iters: 100, epoch: 6 | loss: 0.3414206
	speed: 0.0078s/iter; left time: 5.3685s
	iters: 200, epoch: 6 | loss: 0.4395116
	speed: 0.0032s/iter; left time: 1.8752s
Updating learning rate to 8.2786077921875e-05
Epoch: 6 cost time: 0.8895955085754395
Epoch: 6, Steps: 262 | Train Loss: 0.3904661 Vali Loss: 0.2910741 Best vali loss: 0.2813078
	iters: 100, epoch: 7 | loss: 0.6043049
	speed: 0.0075s/iter; left time: 3.1775s
	iters: 200, epoch: 7 | loss: 0.4081481
	speed: 0.0031s/iter; left time: 1.0061s
Updating learning rate to 4.13930389609375e-05
Epoch: 7 cost time: 0.8650631904602051
Epoch: 7, Steps: 262 | Train Loss: 0.5062265 Vali Loss: 0.2962478 Best vali loss: 0.2813078
	iters: 100, epoch: 8 | loss: 0.4435588
	speed: 0.0074s/iter; left time: 1.2062s
	iters: 200, epoch: 8 | loss: 0.3856049
	speed: 0.0031s/iter; left time: 0.1951s
Updating learning rate to 2.069651948046875e-05
Epoch: 8 cost time: 0.857280969619751
Epoch: 8, Steps: 262 | Train Loss: 0.4145819 Vali Loss: 0.2954244 Best vali loss: 0.2813078

best validation loss 0.28130779588541693

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062416843763, 'e_layers': 2, 'learning_rate': 9.67455128e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7228573
	speed: 0.0087s/iter; left time: 17.3436s
	iters: 200, epoch: 1 | loss: 0.6687163
	speed: 0.0034s/iter; left time: 6.4215s
Updating learning rate to 9.306335596911435e-05
Validation loss decreased (inf --> 0.3051).  Saving model state dict ...
Epoch: 1 cost time: 1.1543359756469727
Epoch: 1, Steps: 262 | Train Loss: 0.6957868 Vali Loss: 0.3050674 Best vali loss: 0.3050674
	iters: 100, epoch: 2 | loss: 0.6898043
	speed: 0.0077s/iter; left time: 13.3125s
	iters: 200, epoch: 2 | loss: 0.4270598
	speed: 0.0034s/iter; left time: 5.4903s
Updating learning rate to 8.257746047512496e-05
Validation loss decreased (0.3051 --> 0.2885).  Saving model state dict ...
Epoch: 2 cost time: 0.9271018505096436
Epoch: 2, Steps: 262 | Train Loss: 0.5584320 Vali Loss: 0.2884928 Best vali loss: 0.2884928
	iters: 100, epoch: 3 | loss: 0.6958114
	speed: 0.0078s/iter; left time: 11.5306s
	iters: 200, epoch: 3 | loss: 0.8654882
	speed: 0.0036s/iter; left time: 4.9121s
Updating learning rate to 6.688420885211237e-05
Validation loss decreased (0.2885 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 0.9634854793548584
Epoch: 3, Steps: 262 | Train Loss: 0.7806498 Vali Loss: 0.2838817 Best vali loss: 0.2838817
	iters: 100, epoch: 4 | loss: 0.6545815
	speed: 0.0079s/iter; left time: 9.5254s
	iters: 200, epoch: 4 | loss: 0.5055830
	speed: 0.0035s/iter; left time: 3.9270s
Updating learning rate to 4.83727564e-05
Validation loss decreased (0.2839 --> 0.2819).  Saving model state dict ...
Epoch: 4 cost time: 0.9746530055999756
Epoch: 4, Steps: 262 | Train Loss: 0.5800823 Vali Loss: 0.2818819 Best vali loss: 0.2818819
	iters: 100, epoch: 5 | loss: 0.3311557
	speed: 0.0077s/iter; left time: 7.2981s
	iters: 200, epoch: 5 | loss: 0.4884556
	speed: 0.0031s/iter; left time: 2.6484s
Updating learning rate to 2.986130394788764e-05
Epoch: 5 cost time: 0.875035285949707
Epoch: 5, Steps: 262 | Train Loss: 0.4098056 Vali Loss: 0.2820011 Best vali loss: 0.2818819
	iters: 100, epoch: 6 | loss: 0.6537849
	speed: 0.0071s/iter; left time: 4.9061s
	iters: 200, epoch: 6 | loss: 0.2843307
	speed: 0.0033s/iter; left time: 1.9545s
Updating learning rate to 1.4168052324875036e-05
Validation loss decreased (0.2819 --> 0.2814).  Saving model state dict ...
Epoch: 6 cost time: 0.8842356204986572
Epoch: 6, Steps: 262 | Train Loss: 0.4690578 Vali Loss: 0.2813809 Best vali loss: 0.2813809
	iters: 100, epoch: 7 | loss: 0.5087303
	speed: 0.0075s/iter; left time: 3.1672s
	iters: 200, epoch: 7 | loss: 0.3118905
	speed: 0.0032s/iter; left time: 1.0394s
Updating learning rate to 3.682156830885646e-06
Validation loss decreased (0.2814 --> 0.2814).  Saving model state dict ...
Epoch: 7 cost time: 0.8806841373443604
Epoch: 7, Steps: 262 | Train Loss: 0.4103104 Vali Loss: 0.2813752 Best vali loss: 0.2813752
	iters: 100, epoch: 8 | loss: 0.4070908
	speed: 0.0074s/iter; left time: 1.2065s
	iters: 200, epoch: 8 | loss: 0.3747903
	speed: 0.0031s/iter; left time: 0.1961s
Updating learning rate to 0.0
Validation loss decreased (0.2814 --> 0.2814).  Saving model state dict ...
Epoch: 8 cost time: 0.8664472103118896
Epoch: 8, Steps: 262 | Train Loss: 0.3909405 Vali Loss: 0.2813718 Best vali loss: 0.2813718

best validation loss 0.2813718357064902

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6153992
	speed: 0.0084s/iter; left time: 16.7242s
	iters: 200, epoch: 1 | loss: 0.7840914
	speed: 0.0033s/iter; left time: 6.1899s
Updating learning rate to 0.000288581929876693
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 1.1032278537750244
Epoch: 1, Steps: 262 | Train Loss: 0.6997453 Vali Loss: 0.2806478 Best vali loss: 0.2806478
	iters: 100, epoch: 2 | loss: 0.3516540
	speed: 0.0079s/iter; left time: 13.6521s
	iters: 200, epoch: 2 | loss: 0.6151470
	speed: 0.0037s/iter; left time: 6.0757s
Updating learning rate to 0.00025606601717798207
Epoch: 2 cost time: 1.0096347332000732
Epoch: 2, Steps: 262 | Train Loss: 0.4834005 Vali Loss: 0.2833470 Best vali loss: 0.2806478
	iters: 100, epoch: 3 | loss: 0.6335730
	speed: 0.0083s/iter; left time: 12.1844s
	iters: 200, epoch: 3 | loss: 0.3991112
	speed: 0.0037s/iter; left time: 5.0207s
Updating learning rate to 0.00020740251485476345
Validation loss decreased (0.2806 --> 0.2795).  Saving model state dict ...
Epoch: 3 cost time: 0.9811735153198242
Epoch: 3, Steps: 262 | Train Loss: 0.5163421 Vali Loss: 0.2794538 Best vali loss: 0.2794538

best validation loss 0.279453784953311

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0065557150435, 'e_layers': 2, 'learning_rate': 5.77901171e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.77901171e-05
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 0.7401494979858398
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2840769 Best vali loss: 0.2840769
Updating learning rate to 2.889505855e-05
Validation loss decreased (0.2841 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 0.5088984966278076
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2781201 Best vali loss: 0.2781201
Updating learning rate to 1.4447529275e-05
Validation loss decreased (0.2781 --> 0.2761).  Saving model state dict ...
Epoch: 3 cost time: 0.5156948566436768
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2760786 Best vali loss: 0.2760786

best validation loss 0.2760785995761273

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0058660652846, 'e_layers': 2, 'learning_rate': 6.38617901e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.38617901e-05
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 0.7272460460662842
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2834010 Best vali loss: 0.2834010
Updating learning rate to 3.193089505e-05
Validation loss decreased (0.2834 --> 0.2776).  Saving model state dict ...
Epoch: 2 cost time: 0.5091359615325928
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2776441 Best vali loss: 0.2776441
Updating learning rate to 1.5965447525e-05
Validation loss decreased (0.2776 --> 0.2757).  Saving model state dict ...
Epoch: 3 cost time: 0.5165479183197021
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2757417 Best vali loss: 0.2757417

best validation loss 0.27574168134019383

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0058660652846, 'e_layers': 2, 'learning_rate': 6.38617901e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 7.9827237625e-06
Epoch: 4 cost time: 0.7321486473083496
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2769399 Best vali loss: 0.2757417
Updating learning rate to 3.99136188125e-06
Epoch: 5 cost time: 0.5094845294952393
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2767162 Best vali loss: 0.2757417
Updating learning rate to 1.995680940625e-06
Epoch: 6 cost time: 0.5086338520050049
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2765937 Best vali loss: 0.2757417
Updating learning rate to 9.978404703125e-07
Epoch: 7 cost time: 0.5095880031585693
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2764695 Best vali loss: 0.2757417
Updating learning rate to 4.9892023515625e-07
Epoch: 8 cost time: 0.5123870372772217
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2764531 Best vali loss: 0.2757417

best validation loss 0.27574168134019383

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0060142275186, 'e_layers': 2, 'learning_rate': 5.95291606e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.95291606e-05
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 0.7434854507446289
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2839715 Best vali loss: 0.2839715
Updating learning rate to 2.97645803e-05
Validation loss decreased (0.2840 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 0.5152411460876465
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2781213 Best vali loss: 0.2781213
Updating learning rate to 1.488229015e-05
Validation loss decreased (0.2781 --> 0.2774).  Saving model state dict ...
Epoch: 3 cost time: 0.5175549983978271
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2774048 Best vali loss: 0.2774048
Updating learning rate to 7.441145075e-06
Validation loss decreased (0.2774 --> 0.2766).  Saving model state dict ...
Epoch: 4 cost time: 0.5157146453857422
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2766312 Best vali loss: 0.2766312
Updating learning rate to 3.7205725375e-06
Epoch: 5 cost time: 0.5200357437133789
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2768644 Best vali loss: 0.2766312
Updating learning rate to 1.86028626875e-06
Validation loss decreased (0.2766 --> 0.2765).  Saving model state dict ...
Epoch: 6 cost time: 0.5222909450531006
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2764754 Best vali loss: 0.2764754
Updating learning rate to 9.30143134375e-07
Epoch: 7 cost time: 0.5161480903625488
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2764923 Best vali loss: 0.2764754
Updating learning rate to 4.650715671875e-07
Epoch: 8 cost time: 0.5142769813537598
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2764983 Best vali loss: 0.2764754

best validation loss 0.27647537758034285

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0085809826236, 'e_layers': 2, 'learning_rate': 6.05898386e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.828377518035116e-05
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 0.7325680255889893
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2837752 Best vali loss: 0.2837752
Updating learning rate to 5.1716662172529215e-05
Validation loss decreased (0.2838 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 0.5238263607025146
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2781195 Best vali loss: 0.2781195
Updating learning rate to 4.1888283000947407e-05
Validation loss decreased (0.2781 --> 0.2773).  Saving model state dict ...
Epoch: 3 cost time: 0.5262267589569092
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2773134 Best vali loss: 0.2773134
Updating learning rate to 3.02949193e-05
Validation loss decreased (0.2773 --> 0.2758).  Saving model state dict ...
Epoch: 4 cost time: 0.5250027179718018
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2757781 Best vali loss: 0.2757781
Updating learning rate to 1.8701555599052598e-05
Validation loss decreased (0.2758 --> 0.2743).  Saving model state dict ...
Epoch: 5 cost time: 0.5226638317108154
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2742629 Best vali loss: 0.2742629
Updating learning rate to 8.873176427470787e-06
Validation loss decreased (0.2743 --> 0.2738).  Saving model state dict ...
Epoch: 6 cost time: 0.5210294723510742
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2737916 Best vali loss: 0.2737916
Updating learning rate to 2.306063419648842e-06
Epoch: 7 cost time: 0.5264906883239746
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2739315 Best vali loss: 0.2737916
Updating learning rate to 0.0
Epoch: 8 cost time: 0.524484395980835
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2738295 Best vali loss: 0.2737916

best validation loss 0.2737915936806203

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0083903911414, 'e_layers': 2, 'learning_rate': 6.21271152e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.21271152e-05
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 0.7428534030914307
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2834880 Best vali loss: 0.2834880
Updating learning rate to 3.10635576e-05
Validation loss decreased (0.2835 --> 0.2780).  Saving model state dict ...
Epoch: 2 cost time: 0.5179717540740967
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2779556 Best vali loss: 0.2779556
Updating learning rate to 1.55317788e-05
Validation loss decreased (0.2780 --> 0.2773).  Saving model state dict ...
Epoch: 3 cost time: 0.5179059505462646
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2773343 Best vali loss: 0.2773343

best validation loss 0.27733432346114706

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0063462472688, 'e_layers': 2, 'learning_rate': 6.08811406e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.08811406e-05
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 0.7297377586364746
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2836938 Best vali loss: 0.2836938
Updating learning rate to 3.04405703e-05
Validation loss decreased (0.2837 --> 0.2779).  Saving model state dict ...
Epoch: 2 cost time: 0.5185554027557373
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2778788 Best vali loss: 0.2778788
Updating learning rate to 1.522028515e-05
Validation loss decreased (0.2779 --> 0.2759).  Saving model state dict ...
Epoch: 3 cost time: 0.513763427734375
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2758989 Best vali loss: 0.2758989

best validation loss 0.27589894149018823

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0070892132357, 'e_layers': 2, 'learning_rate': 6.01124109e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.782451849020919e-05
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 0.7835288047790527
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2822332 Best vali loss: 0.2822332
Updating learning rate to 5.1309152140431065e-05
Validation loss decreased (0.2822 --> 0.2776).  Saving model state dict ...
Epoch: 2 cost time: 0.5539093017578125
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2775729 Best vali loss: 0.2775729
Updating learning rate to 4.155821731547632e-05
Epoch: 3 cost time: 0.558100700378418
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2779850 Best vali loss: 0.2775729

best validation loss 0.277572928567986

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0063462472688, 'e_layers': 2, 'learning_rate': 6.08811406e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 7.610142575e-06
Epoch: 4 cost time: 0.738173246383667
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2769392 Best vali loss: 0.2758989
Updating learning rate to 3.8050712875e-06
Epoch: 5 cost time: 0.5146133899688721
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2767870 Best vali loss: 0.2758989
Updating learning rate to 1.90253564375e-06
Epoch: 6 cost time: 0.513216495513916
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2766648 Best vali loss: 0.2758989
Updating learning rate to 9.51267821875e-07
Epoch: 7 cost time: 0.5134692192077637
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2765388 Best vali loss: 0.2758989
Updating learning rate to 4.756339109375e-07
Epoch: 8 cost time: 0.5121762752532959
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2765218 Best vali loss: 0.2758989

best validation loss 0.27589894149018823

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.005763457316, 'e_layers': 2, 'learning_rate': 5.95457326e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.95457326e-05
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 0.7232387065887451
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2838533 Best vali loss: 0.2838533
Updating learning rate to 2.97728663e-05
Validation loss decreased (0.2839 --> 0.2780).  Saving model state dict ...
Epoch: 2 cost time: 0.5104341506958008
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2779809 Best vali loss: 0.2779809
Updating learning rate to 1.488643315e-05
Validation loss decreased (0.2780 --> 0.2760).  Saving model state dict ...
Epoch: 3 cost time: 0.5094330310821533
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2759718 Best vali loss: 0.2759718
Updating learning rate to 7.443216575e-06
Validation loss decreased (0.2760 --> 0.2758).  Saving model state dict ...
Epoch: 4 cost time: 0.5098249912261963
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2758231 Best vali loss: 0.2758231
Updating learning rate to 3.7216082875e-06
Epoch: 5 cost time: 0.517930269241333
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2763946 Best vali loss: 0.2758231
Updating learning rate to 1.86080414375e-06
Epoch: 6 cost time: 0.5092864036560059
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2763436 Best vali loss: 0.2758231
Updating learning rate to 9.30402071875e-07
Epoch: 7 cost time: 0.5126867294311523
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2764253 Best vali loss: 0.2758231
Updating learning rate to 4.652010359375e-07
Epoch: 8 cost time: 0.512183427810669
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2763658 Best vali loss: 0.2758231

best validation loss 0.2758231149060259

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0103397358898, 'e_layers': 2, 'learning_rate': 0.0001103205308, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3511043
	speed: 0.0093s/iter; left time: 8.7885s
Updating learning rate to 0.0001103205308
Validation loss decreased (inf --> 0.2770).  Saving model state dict ...
Epoch: 1 cost time: 0.7789759635925293
Epoch: 1, Steps: 131 | Train Loss: 0.3511043 Vali Loss: 0.2769917 Best vali loss: 0.2769917
	iters: 100, epoch: 2 | loss: 0.3962722
	speed: 0.0068s/iter; left time: 5.5685s
Updating learning rate to 5.51602654e-05
Epoch: 2 cost time: 0.5315797328948975
Epoch: 2, Steps: 131 | Train Loss: 0.3962722 Vali Loss: 0.2809573 Best vali loss: 0.2769917
	iters: 100, epoch: 3 | loss: 0.4458003
	speed: 0.0065s/iter; left time: 4.4497s
Updating learning rate to 2.75801327e-05
Validation loss decreased (0.2770 --> 0.2765).  Saving model state dict ...
Epoch: 3 cost time: 0.5144252777099609
Epoch: 3, Steps: 131 | Train Loss: 0.4458003 Vali Loss: 0.2765439 Best vali loss: 0.2765439
	iters: 100, epoch: 4 | loss: 0.3813618
	speed: 0.0068s/iter; left time: 3.7699s
Updating learning rate to 1.379006635e-05
Epoch: 4 cost time: 0.5225675106048584
Epoch: 4, Steps: 131 | Train Loss: 0.3813618 Vali Loss: 0.2805687 Best vali loss: 0.2765439
	iters: 100, epoch: 5 | loss: 0.3665929
	speed: 0.0066s/iter; left time: 2.7884s
Updating learning rate to 6.895033175e-06
Epoch: 5 cost time: 0.5245721340179443
Epoch: 5, Steps: 131 | Train Loss: 0.3665929 Vali Loss: 0.2817596 Best vali loss: 0.2765439
	iters: 100, epoch: 6 | loss: 0.4485556
	speed: 0.0068s/iter; left time: 1.9990s
Updating learning rate to 3.4475165875e-06
Epoch: 6 cost time: 0.5357215404510498
Epoch: 6, Steps: 131 | Train Loss: 0.4485556 Vali Loss: 0.2831572 Best vali loss: 0.2765439
	iters: 100, epoch: 7 | loss: 0.4893767
	speed: 0.0067s/iter; left time: 1.0981s
Updating learning rate to 1.72375829375e-06
Epoch: 7 cost time: 0.5403504371643066
Epoch: 7, Steps: 131 | Train Loss: 0.4893767 Vali Loss: 0.2836609 Best vali loss: 0.2765439
	iters: 100, epoch: 8 | loss: 0.5607376
	speed: 0.0068s/iter; left time: 0.2170s
Updating learning rate to 8.61879146875e-07
Epoch: 8 cost time: 0.545372724533081
Epoch: 8, Steps: 131 | Train Loss: 0.5607376 Vali Loss: 0.2841158 Best vali loss: 0.2765439

best validation loss 0.2765439190206008

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0084350878802, 'e_layers': 2, 'learning_rate': 0.0001030045736, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3516606
	speed: 0.0094s/iter; left time: 8.9592s
Updating learning rate to 0.0001030045736
Validation loss decreased (inf --> 0.2772).  Saving model state dict ...
Epoch: 1 cost time: 0.7986063957214355
Epoch: 1, Steps: 131 | Train Loss: 0.3516606 Vali Loss: 0.2771549 Best vali loss: 0.2771549
	iters: 100, epoch: 2 | loss: 0.3958456
	speed: 0.0072s/iter; left time: 5.8898s
Updating learning rate to 5.15022868e-05
Epoch: 2 cost time: 0.5729467868804932
Epoch: 2, Steps: 131 | Train Loss: 0.3958456 Vali Loss: 0.2809621 Best vali loss: 0.2771549
	iters: 100, epoch: 3 | loss: 0.4498805
	speed: 0.0067s/iter; left time: 4.6109s
Updating learning rate to 2.57511434e-05
Validation loss decreased (0.2772 --> 0.2761).  Saving model state dict ...
Epoch: 3 cost time: 0.5187051296234131
Epoch: 3, Steps: 131 | Train Loss: 0.4498805 Vali Loss: 0.2761069 Best vali loss: 0.2761069

best validation loss 0.27610687795415517

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101070167488, 'e_layers': 2, 'learning_rate': 0.000129014733, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6371059
	speed: 0.0105s/iter; left time: 9.9296s
Updating learning rate to 0.00012410440210555422
Validation loss decreased (inf --> 0.2778).  Saving model state dict ...
Epoch: 1 cost time: 0.938971996307373
Epoch: 1, Steps: 131 | Train Loss: 0.6371059 Vali Loss: 0.2777532 Best vali loss: 0.2777532
	iters: 100, epoch: 2 | loss: 0.3822760
	speed: 0.0089s/iter; left time: 7.2854s
Updating learning rate to 0.00011012096278863592
Validation loss decreased (0.2778 --> 0.2741).  Saving model state dict ...
Epoch: 2 cost time: 0.704169511795044
Epoch: 2, Steps: 131 | Train Loss: 0.3822760 Vali Loss: 0.2740927 Best vali loss: 0.2740927
	iters: 100, epoch: 3 | loss: 0.8104355
	speed: 0.0089s/iter; left time: 6.1334s
Updating learning rate to 8.91932669250528e-05
Epoch: 3 cost time: 0.7097301483154297
Epoch: 3, Steps: 131 | Train Loss: 0.8104355 Vali Loss: 0.2772322 Best vali loss: 0.2740927

best validation loss 0.274092681656078

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0084224120356, 'e_layers': 2, 'learning_rate': 0.0001391545268, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3492486
	speed: 0.0092s/iter; left time: 8.7329s
Updating learning rate to 0.0001391545268
Validation loss decreased (inf --> 0.2766).  Saving model state dict ...
Epoch: 1 cost time: 0.7699480056762695
Epoch: 1, Steps: 131 | Train Loss: 0.3492486 Vali Loss: 0.2766280 Best vali loss: 0.2766280
	iters: 100, epoch: 2 | loss: 0.3938490
	speed: 0.0067s/iter; left time: 5.4862s
Updating learning rate to 6.95772634e-05
Epoch: 2 cost time: 0.5267541408538818
Epoch: 2, Steps: 131 | Train Loss: 0.3938490 Vali Loss: 0.2791880 Best vali loss: 0.2766280
	iters: 100, epoch: 3 | loss: 0.4291294
	speed: 0.0066s/iter; left time: 4.5482s
Updating learning rate to 3.47886317e-05
Epoch: 3 cost time: 0.5220744609832764
Epoch: 3, Steps: 131 | Train Loss: 0.4291294 Vali Loss: 0.2813008 Best vali loss: 0.2766280

best validation loss 0.2766279509438596

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101070167488, 'e_layers': 2, 'learning_rate': 0.000129014733, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5196049
	speed: 0.0107s/iter; left time: 5.9630s
Updating learning rate to 6.45073665e-05
Epoch: 4 cost time: 0.9353768825531006
Epoch: 4, Steps: 131 | Train Loss: 0.5196049 Vali Loss: 0.3022859 Best vali loss: 0.2740927
	iters: 100, epoch: 5 | loss: 0.3384225
	speed: 0.0087s/iter; left time: 3.6829s
Updating learning rate to 3.9821466074947195e-05
Epoch: 5 cost time: 0.7018768787384033
Epoch: 5, Steps: 131 | Train Loss: 0.3384225 Vali Loss: 0.2808463 Best vali loss: 0.2740927
	iters: 100, epoch: 6 | loss: 0.6710070
	speed: 0.0087s/iter; left time: 2.5568s
Updating learning rate to 1.889377021136408e-05
Epoch: 6 cost time: 0.7044093608856201
Epoch: 6, Steps: 131 | Train Loss: 0.6710070 Vali Loss: 0.2853493 Best vali loss: 0.2740927
	iters: 100, epoch: 7 | loss: 0.4467014
	speed: 0.0086s/iter; left time: 1.4082s
Updating learning rate to 4.910330894445761e-06
Epoch: 7 cost time: 0.6981756687164307
Epoch: 7, Steps: 131 | Train Loss: 0.4467014 Vali Loss: 0.2964288 Best vali loss: 0.2740927
	iters: 100, epoch: 8 | loss: 0.3809831
	speed: 0.0088s/iter; left time: 0.2801s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7102353572845459
Epoch: 8, Steps: 131 | Train Loss: 0.3809831 Vali Loss: 0.2915868 Best vali loss: 0.2740927

best validation loss 0.274092681656078

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0087970754395, 'e_layers': 2, 'learning_rate': 9.15392642e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3528179
	speed: 0.0090s/iter; left time: 8.5641s
Updating learning rate to 9.15392642e-05
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 0.7567729949951172
Epoch: 1, Steps: 131 | Train Loss: 0.3528179 Vali Loss: 0.2776008 Best vali loss: 0.2776008
	iters: 100, epoch: 2 | loss: 0.3956132
	speed: 0.0067s/iter; left time: 5.4891s
Updating learning rate to 4.57696321e-05
Epoch: 2 cost time: 0.5207204818725586
Epoch: 2, Steps: 131 | Train Loss: 0.3956132 Vali Loss: 0.2815258 Best vali loss: 0.2776008
	iters: 100, epoch: 3 | loss: 0.4620668
	speed: 0.0069s/iter; left time: 4.7383s
Updating learning rate to 2.288481605e-05
Validation loss decreased (0.2776 --> 0.2754).  Saving model state dict ...
Epoch: 3 cost time: 0.5676608085632324
Epoch: 3, Steps: 131 | Train Loss: 0.4620668 Vali Loss: 0.2754355 Best vali loss: 0.2754355
	iters: 100, epoch: 4 | loss: 0.3879560
	speed: 0.0069s/iter; left time: 3.8296s
Updating learning rate to 1.1442408025e-05
Validation loss decreased (0.2754 --> 0.2749).  Saving model state dict ...
Epoch: 4 cost time: 0.5299501419067383
Epoch: 4, Steps: 131 | Train Loss: 0.3879560 Vali Loss: 0.2748968 Best vali loss: 0.2748968
	iters: 100, epoch: 5 | loss: 0.3726295
	speed: 0.0068s/iter; left time: 2.8725s
Updating learning rate to 5.7212040125e-06
Epoch: 5 cost time: 0.5245931148529053
Epoch: 5, Steps: 131 | Train Loss: 0.3726295 Vali Loss: 0.2755405 Best vali loss: 0.2748968
	iters: 100, epoch: 6 | loss: 0.4651010
	speed: 0.0070s/iter; left time: 2.0560s
Updating learning rate to 2.86060200625e-06
Epoch: 6 cost time: 0.5670266151428223
Epoch: 6, Steps: 131 | Train Loss: 0.4651010 Vali Loss: 0.2763941 Best vali loss: 0.2748968
	iters: 100, epoch: 7 | loss: 0.4954175
	speed: 0.0069s/iter; left time: 1.1272s
Updating learning rate to 1.430301003125e-06
Epoch: 7 cost time: 0.5548791885375977
Epoch: 7, Steps: 131 | Train Loss: 0.4954175 Vali Loss: 0.2768443 Best vali loss: 0.2748968
	iters: 100, epoch: 8 | loss: 0.5751178
	speed: 0.0070s/iter; left time: 0.2243s
Updating learning rate to 7.151505015625e-07
Epoch: 8 cost time: 0.5543618202209473
Epoch: 8, Steps: 131 | Train Loss: 0.5751178 Vali Loss: 0.2771557 Best vali loss: 0.2748968

best validation loss 0.27489677671718526

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.007940080013, 'e_layers': 4, 'learning_rate': 0.0005392900295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4462961
	speed: 0.0105s/iter; left time: 21.0191s
	iters: 200, epoch: 1 | loss: 0.3301474
	speed: 0.0053s/iter; left time: 10.0391s
Updating learning rate to 0.000518764524921229
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 1.6624915599822998
Epoch: 1, Steps: 262 | Train Loss: 0.3882217 Vali Loss: 0.2866729 Best vali loss: 0.2866729
	iters: 100, epoch: 2 | loss: 0.9202887
	speed: 0.0110s/iter; left time: 19.0361s
	iters: 200, epoch: 2 | loss: 0.3126097
	speed: 0.0049s/iter; left time: 7.9752s
Updating learning rate to 0.0004603128331928716
Epoch: 2 cost time: 1.3727636337280273
Epoch: 2, Steps: 262 | Train Loss: 0.6164492 Vali Loss: 0.2870448 Best vali loss: 0.2866729
	iters: 100, epoch: 3 | loss: 0.8534275
	speed: 0.0112s/iter; left time: 16.5128s
	iters: 200, epoch: 3 | loss: 0.3956472
	speed: 0.0055s/iter; left time: 7.5439s
Updating learning rate to 0.0003728336945146653
Epoch: 3 cost time: 1.460038185119629
Epoch: 3, Steps: 262 | Train Loss: 0.6245374 Vali Loss: 0.2927421 Best vali loss: 0.2866729
	iters: 100, epoch: 4 | loss: 0.2891280
	speed: 0.0113s/iter; left time: 13.7117s
	iters: 200, epoch: 4 | loss: 0.4711838
	speed: 0.0053s/iter; left time: 5.9020s
Updating learning rate to 0.00026964501475
Epoch: 4 cost time: 1.430643081665039
Epoch: 4, Steps: 262 | Train Loss: 0.3801559 Vali Loss: 0.2907577 Best vali loss: 0.2866729
	iters: 100, epoch: 5 | loss: 0.4628078
	speed: 0.0112s/iter; left time: 10.6308s
	iters: 200, epoch: 5 | loss: 0.3930600
	speed: 0.0053s/iter; left time: 4.5227s
Updating learning rate to 0.00016645633498533474
Epoch: 5 cost time: 1.4233403205871582
Epoch: 5, Steps: 262 | Train Loss: 0.4279339 Vali Loss: 0.2916791 Best vali loss: 0.2866729
	iters: 100, epoch: 6 | loss: 0.4234761
	speed: 0.0105s/iter; left time: 7.2317s
	iters: 200, epoch: 6 | loss: 0.2669298
	speed: 0.0050s/iter; left time: 2.9067s
Updating learning rate to 7.897719630712839e-05
Epoch: 6 cost time: 1.3071198463439941
Epoch: 6, Steps: 262 | Train Loss: 0.3452030 Vali Loss: 0.2989517 Best vali loss: 0.2866729
	iters: 100, epoch: 7 | loss: 0.4459693
	speed: 0.0110s/iter; left time: 4.6622s
	iters: 200, epoch: 7 | loss: 0.6416417
	speed: 0.0054s/iter; left time: 1.7454s
Updating learning rate to 2.0525504578770982e-05
Epoch: 7 cost time: 1.455233097076416
Epoch: 7, Steps: 262 | Train Loss: 0.5438055 Vali Loss: 0.2976469 Best vali loss: 0.2866729
	iters: 100, epoch: 8 | loss: 0.3642613
	speed: 0.0108s/iter; left time: 1.7538s
	iters: 200, epoch: 8 | loss: 0.5407600
	speed: 0.0047s/iter; left time: 0.2947s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.27860426902771
Epoch: 8, Steps: 262 | Train Loss: 0.4525106 Vali Loss: 0.2976318 Best vali loss: 0.2866729

best validation loss 0.2866729056804142

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0083177866888, 'e_layers': 2, 'learning_rate': 0.0001367015633, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6367564
	speed: 0.0106s/iter; left time: 10.0325s
Updating learning rate to 0.0001367015633
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.9524035453796387
Epoch: 1, Steps: 131 | Train Loss: 0.6367564 Vali Loss: 0.2780504 Best vali loss: 0.2780504
	iters: 100, epoch: 2 | loss: 0.3820473
	speed: 0.0088s/iter; left time: 7.2357s
Updating learning rate to 6.835078165e-05
Validation loss decreased (0.2781 --> 0.2747).  Saving model state dict ...
Epoch: 2 cost time: 0.6991174221038818
Epoch: 2, Steps: 131 | Train Loss: 0.3820473 Vali Loss: 0.2747020 Best vali loss: 0.2747020
	iters: 100, epoch: 3 | loss: 0.8200363
	speed: 0.0091s/iter; left time: 6.2543s
Updating learning rate to 3.4175390825e-05
Epoch: 3 cost time: 0.7124249935150146
Epoch: 3, Steps: 131 | Train Loss: 0.8200363 Vali Loss: 0.2794207 Best vali loss: 0.2747020

best validation loss 0.27470198336277984

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101147062872, 'e_layers': 2, 'learning_rate': 8.36326913e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3539240
	speed: 0.0093s/iter; left time: 8.7809s
Updating learning rate to 8.36326913e-05
Validation loss decreased (inf --> 0.2780).  Saving model state dict ...
Epoch: 1 cost time: 0.7967801094055176
Epoch: 1, Steps: 131 | Train Loss: 0.3539240 Vali Loss: 0.2780494 Best vali loss: 0.2780494
	iters: 100, epoch: 2 | loss: 0.3961467
	speed: 0.0071s/iter; left time: 5.8030s
Updating learning rate to 4.181634565e-05
Epoch: 2 cost time: 0.5548505783081055
Epoch: 2, Steps: 131 | Train Loss: 0.3961467 Vali Loss: 0.2817451 Best vali loss: 0.2780494
	iters: 100, epoch: 3 | loss: 0.4696999
	speed: 0.0068s/iter; left time: 4.6994s
Updating learning rate to 2.0908172825e-05
Validation loss decreased (0.2780 --> 0.2758).  Saving model state dict ...
Epoch: 3 cost time: 0.5411992073059082
Epoch: 3, Steps: 131 | Train Loss: 0.4696999 Vali Loss: 0.2757600 Best vali loss: 0.2757600

best validation loss 0.2757600123563545

[INFO][smbo.py:320] Finished 200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004792616286, 'e_layers': 2, 'learning_rate': 0.0015570047911, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4845809
	speed: 0.0092s/iter; left time: 8.7603s
Updating learning rate to 0.0014977448248096508
Validation loss decreased (inf --> 0.3006).  Saving model state dict ...
Epoch: 1 cost time: 0.7929837703704834
Epoch: 1, Steps: 131 | Train Loss: 0.4845809 Vali Loss: 0.3005859 Best vali loss: 0.3005859
	iters: 100, epoch: 2 | loss: 0.6498735
	speed: 0.0070s/iter; left time: 5.7621s
Updating learning rate to 0.0013289867186133768
Validation loss decreased (0.3006 --> 0.2878).  Saving model state dict ...
Epoch: 2 cost time: 0.5565395355224609
Epoch: 2, Steps: 131 | Train Loss: 0.6498735 Vali Loss: 0.2878189 Best vali loss: 0.2878189
	iters: 100, epoch: 3 | loss: 0.8074731
	speed: 0.0068s/iter; left time: 4.6849s
Updating learning rate to 0.0010764223643835189
Epoch: 3 cost time: 0.5197491645812988
Epoch: 3, Steps: 131 | Train Loss: 0.8074731 Vali Loss: 0.2974186 Best vali loss: 0.2878189

best validation loss 0.2878188798117478

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0083177866888, 'e_layers': 2, 'learning_rate': 0.0001367015633, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5320092
	speed: 0.0107s/iter; left time: 5.9480s
Updating learning rate to 1.70876954125e-05
Epoch: 4 cost time: 0.9435484409332275
Epoch: 4, Steps: 131 | Train Loss: 0.5320092 Vali Loss: 0.2928424 Best vali loss: 0.2747020
	iters: 100, epoch: 5 | loss: 0.3563589
	speed: 0.0088s/iter; left time: 3.7237s
Updating learning rate to 8.54384770625e-06
Epoch: 5 cost time: 0.709402322769165
Epoch: 5, Steps: 131 | Train Loss: 0.3563589 Vali Loss: 0.2904374 Best vali loss: 0.2747020
	iters: 100, epoch: 6 | loss: 0.7431579
	speed: 0.0088s/iter; left time: 2.5823s
Updating learning rate to 4.271923853125e-06
Epoch: 6 cost time: 0.7051382064819336
Epoch: 6, Steps: 131 | Train Loss: 0.7431579 Vali Loss: 0.2891469 Best vali loss: 0.2747020
	iters: 100, epoch: 7 | loss: 0.4960682
	speed: 0.0087s/iter; left time: 1.4137s
Updating learning rate to 2.1359619265625e-06
Epoch: 7 cost time: 0.7013344764709473
Epoch: 7, Steps: 131 | Train Loss: 0.4960682 Vali Loss: 0.2913017 Best vali loss: 0.2747020
	iters: 100, epoch: 8 | loss: 0.4251296
	speed: 0.0087s/iter; left time: 0.2779s
Updating learning rate to 1.06798096328125e-06
Epoch: 8 cost time: 0.7029039859771729
Epoch: 8, Steps: 131 | Train Loss: 0.4251296 Vali Loss: 0.2894859 Best vali loss: 0.2747020

best validation loss 0.27470198336277984

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094422831379, 'e_layers': 4, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 0.6753537654876709
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2842836 Best vali loss: 0.2842836
Updating learning rate to 0.0009137180420535848
Validation loss decreased (0.2843 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 0.4483523368835449
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2835057 Best vali loss: 0.2835057
Updating learning rate to 0.0007400725089513316
Epoch: 3 cost time: 0.44016599655151367
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2869979 Best vali loss: 0.2835057
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 0.4366490840911865
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2902600 Best vali loss: 0.2835057
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 0.4363059997558594
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2840039 Best vali loss: 0.2835057
Updating learning rate to 0.00015676923164641517
Epoch: 6 cost time: 0.42086362838745117
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2950086 Best vali loss: 0.2835057
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 0.44216418266296387
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2917739 Best vali loss: 0.2835057
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4251108169555664
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2923610 Best vali loss: 0.2835057

best validation loss 0.28350568473250415

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020531774403, 'e_layers': 2, 'learning_rate': 7.06531279e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6429959
	speed: 0.0104s/iter; left time: 9.9170s
Updating learning rate to 6.796405333735607e-05
Validation loss decreased (inf --> 0.2788).  Saving model state dict ...
Epoch: 1 cost time: 0.9364762306213379
Epoch: 1, Steps: 131 | Train Loss: 0.6429959 Vali Loss: 0.2787532 Best vali loss: 0.2787532
	iters: 100, epoch: 2 | loss: 0.4012029
	speed: 0.0090s/iter; left time: 7.3570s
Updating learning rate to 6.0306216875065224e-05
Validation loss decreased (0.2788 --> 0.2764).  Saving model state dict ...
Epoch: 2 cost time: 0.7100882530212402
Epoch: 2, Steps: 131 | Train Loss: 0.4012029 Vali Loss: 0.2764182 Best vali loss: 0.2764182
	iters: 100, epoch: 3 | loss: 0.8923331
	speed: 0.0090s/iter; left time: 6.1793s
Updating learning rate to 4.884545469605085e-05
Validation loss decreased (0.2764 --> 0.2735).  Saving model state dict ...
Epoch: 3 cost time: 0.7046177387237549
Epoch: 3, Steps: 131 | Train Loss: 0.8923331 Vali Loss: 0.2735279 Best vali loss: 0.2735279
	iters: 100, epoch: 4 | loss: 0.5346175
	speed: 0.0089s/iter; left time: 4.9671s
Updating learning rate to 3.532656395e-05
Epoch: 4 cost time: 0.709782600402832
Epoch: 4, Steps: 131 | Train Loss: 0.5346175 Vali Loss: 0.2750620 Best vali loss: 0.2735279
	iters: 100, epoch: 5 | loss: 0.4435988
	speed: 0.0086s/iter; left time: 3.6717s
Updating learning rate to 2.180767320394916e-05
Epoch: 5 cost time: 0.7045938968658447
Epoch: 5, Steps: 131 | Train Loss: 0.4435988 Vali Loss: 0.2902585 Best vali loss: 0.2735279
	iters: 100, epoch: 6 | loss: 0.4235932
	speed: 0.0087s/iter; left time: 2.5578s
Updating learning rate to 1.0346911024934774e-05
Epoch: 6 cost time: 0.7033376693725586
Epoch: 6, Steps: 131 | Train Loss: 0.4235932 Vali Loss: 0.2882108 Best vali loss: 0.2735279
	iters: 100, epoch: 7 | loss: 0.3707735
	speed: 0.0087s/iter; left time: 1.4149s
Updating learning rate to 2.689074562643925e-06
Epoch: 7 cost time: 0.7002968788146973
Epoch: 7, Steps: 131 | Train Loss: 0.3707735 Vali Loss: 0.2889046 Best vali loss: 0.2735279
	iters: 100, epoch: 8 | loss: 0.3626698
	speed: 0.0088s/iter; left time: 0.2821s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7069289684295654
Epoch: 8, Steps: 131 | Train Loss: 0.3626698 Vali Loss: 0.2880280 Best vali loss: 0.2735279

best validation loss 0.2735278992936176

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020721299505, 'e_layers': 2, 'learning_rate': 7.18598648e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6427214
	speed: 0.0104s/iter; left time: 9.9006s
Updating learning rate to 6.912486154887412e-05
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 0.9335932731628418
Epoch: 1, Steps: 131 | Train Loss: 0.6427214 Vali Loss: 0.2786494 Best vali loss: 0.2786494
	iters: 100, epoch: 2 | loss: 0.4000928
	speed: 0.0090s/iter; left time: 7.3361s
Updating learning rate to 6.133623124761423e-05
Validation loss decreased (0.2786 --> 0.2764).  Saving model state dict ...
Epoch: 2 cost time: 0.7083826065063477
Epoch: 2, Steps: 131 | Train Loss: 0.4000928 Vali Loss: 0.2763637 Best vali loss: 0.2763637
	iters: 100, epoch: 3 | loss: 0.8917714
	speed: 0.0091s/iter; left time: 6.2854s
Updating learning rate to 4.9679722255477644e-05
Validation loss decreased (0.2764 --> 0.2733).  Saving model state dict ...
Epoch: 3 cost time: 0.7118971347808838
Epoch: 3, Steps: 131 | Train Loss: 0.8917714 Vali Loss: 0.2732784 Best vali loss: 0.2732784

best validation loss 0.2732783675515195

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0021303114137, 'e_layers': 2, 'learning_rate': 7.00103162e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6431383
	speed: 0.0105s/iter; left time: 9.9175s
Updating learning rate to 6.734570720091168e-05
Validation loss decreased (inf --> 0.2788).  Saving model state dict ...
Epoch: 1 cost time: 0.9427566528320312
Epoch: 1, Steps: 131 | Train Loss: 0.6431383 Vali Loss: 0.2788127 Best vali loss: 0.2788127
	iters: 100, epoch: 2 | loss: 0.4015929
	speed: 0.0090s/iter; left time: 7.3879s
Updating learning rate to 5.9757542769017194e-05
Validation loss decreased (0.2788 --> 0.2765).  Saving model state dict ...
Epoch: 2 cost time: 0.7074494361877441
Epoch: 2, Steps: 131 | Train Loss: 0.4015929 Vali Loss: 0.2764952 Best vali loss: 0.2764952
	iters: 100, epoch: 3 | loss: 0.8933921
	speed: 0.0091s/iter; left time: 6.2227s
Updating learning rate to 4.8401052152190626e-05
Validation loss decreased (0.2765 --> 0.2736).  Saving model state dict ...
Epoch: 3 cost time: 0.7167811393737793
Epoch: 3, Steps: 131 | Train Loss: 0.8933921 Vali Loss: 0.2736155 Best vali loss: 0.2736155

best validation loss 0.2736155266720108

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.00197275665, 'e_layers': 2, 'learning_rate': 7.06968801e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6429796
	speed: 0.0105s/iter; left time: 9.9421s
Updating learning rate to 6.800614031839724e-05
Validation loss decreased (inf --> 0.2788).  Saving model state dict ...
Epoch: 1 cost time: 0.9432272911071777
Epoch: 1, Steps: 131 | Train Loss: 0.6429796 Vali Loss: 0.2787518 Best vali loss: 0.2787518
	iters: 100, epoch: 2 | loss: 0.4011434
	speed: 0.0090s/iter; left time: 7.3312s
Updating learning rate to 6.0343561713721145e-05
Validation loss decreased (0.2788 --> 0.2764).  Saving model state dict ...
Epoch: 2 cost time: 0.7053196430206299
Epoch: 2, Steps: 131 | Train Loss: 0.4011434 Vali Loss: 0.2764121 Best vali loss: 0.2764121
	iters: 100, epoch: 3 | loss: 0.8920670
	speed: 0.0090s/iter; left time: 6.1621s
Updating learning rate to 4.8875702417085605e-05
Validation loss decreased (0.2764 --> 0.2734).  Saving model state dict ...
Epoch: 3 cost time: 0.7042498588562012
Epoch: 3, Steps: 131 | Train Loss: 0.8920670 Vali Loss: 0.2734390 Best vali loss: 0.2734390

best validation loss 0.27343896301251974

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020721299505, 'e_layers': 2, 'learning_rate': 7.18598648e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5625997
	speed: 0.0109s/iter; left time: 6.0706s
Updating learning rate to 3.59299324e-05
Epoch: 4 cost time: 0.9434013366699219
Epoch: 4, Steps: 131 | Train Loss: 0.5625997 Vali Loss: 0.2816918 Best vali loss: 0.2732784
	iters: 100, epoch: 5 | loss: 0.3730294
	speed: 0.0087s/iter; left time: 3.7070s
Updating learning rate to 2.2180142544522353e-05
Epoch: 5 cost time: 0.6998820304870605
Epoch: 5, Steps: 131 | Train Loss: 0.3730294 Vali Loss: 0.2865884 Best vali loss: 0.2732784
	iters: 100, epoch: 6 | loss: 0.7660791
	speed: 0.0087s/iter; left time: 2.5540s
Updating learning rate to 1.0523633552385758e-05
Epoch: 6 cost time: 0.7093594074249268
Epoch: 6, Steps: 131 | Train Loss: 0.7660791 Vali Loss: 0.2870002 Best vali loss: 0.2732784
	iters: 100, epoch: 7 | loss: 0.5022472
	speed: 0.0086s/iter; left time: 1.4052s
Updating learning rate to 2.735003251125865e-06
Epoch: 7 cost time: 0.7002542018890381
Epoch: 7, Steps: 131 | Train Loss: 0.5022472 Vali Loss: 0.2879813 Best vali loss: 0.2732784
	iters: 100, epoch: 8 | loss: 0.4296805
	speed: 0.0086s/iter; left time: 0.2764s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7010045051574707
Epoch: 8, Steps: 131 | Train Loss: 0.4296805 Vali Loss: 0.2875159 Best vali loss: 0.2732784

best validation loss 0.2732783675515195

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019420411772, 'e_layers': 2, 'learning_rate': 7.35421452e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6423383
	speed: 0.0105s/iter; left time: 10.0099s
Updating learning rate to 7.074311396362658e-05
Validation loss decreased (inf --> 0.2785).  Saving model state dict ...
Epoch: 1 cost time: 0.9317619800567627
Epoch: 1, Steps: 131 | Train Loss: 0.6423383 Vali Loss: 0.2785138 Best vali loss: 0.2785138
	iters: 100, epoch: 2 | loss: 0.3989363
	speed: 0.0089s/iter; left time: 7.2930s
Updating learning rate to 6.277214738696285e-05
Validation loss decreased (0.2785 --> 0.2763).  Saving model state dict ...
Epoch: 2 cost time: 0.7067227363586426
Epoch: 2, Steps: 131 | Train Loss: 0.3989363 Vali Loss: 0.2763341 Best vali loss: 0.2763341
	iters: 100, epoch: 3 | loss: 0.8904207
	speed: 0.0090s/iter; left time: 6.1679s
Updating learning rate to 5.08427528743139e-05
Validation loss decreased (0.2763 --> 0.2733).  Saving model state dict ...
Epoch: 3 cost time: 0.7024590969085693
Epoch: 3, Steps: 131 | Train Loss: 0.8904207 Vali Loss: 0.2732884 Best vali loss: 0.2732884
	iters: 100, epoch: 4 | loss: 0.5314143
	speed: 0.0091s/iter; left time: 5.0397s
Updating learning rate to 3.67710726e-05
Epoch: 4 cost time: 0.7080330848693848
Epoch: 4, Steps: 131 | Train Loss: 0.5314143 Vali Loss: 0.2759395 Best vali loss: 0.2732884
	iters: 100, epoch: 5 | loss: 0.4399865
	speed: 0.0086s/iter; left time: 3.6743s
Updating learning rate to 2.2699392325686096e-05
Epoch: 5 cost time: 0.7028071880340576
Epoch: 5, Steps: 131 | Train Loss: 0.4399865 Vali Loss: 0.2912507 Best vali loss: 0.2732884
	iters: 100, epoch: 6 | loss: 0.4202573
	speed: 0.0087s/iter; left time: 2.5560s
Updating learning rate to 1.0769997813037148e-05
Epoch: 6 cost time: 0.7019000053405762
Epoch: 6, Steps: 131 | Train Loss: 0.4202573 Vali Loss: 0.2890746 Best vali loss: 0.2732884
	iters: 100, epoch: 7 | loss: 0.3706468
	speed: 0.0087s/iter; left time: 1.4167s
Updating learning rate to 2.799031236373415e-06
Epoch: 7 cost time: 0.7016358375549316
Epoch: 7, Steps: 131 | Train Loss: 0.3706468 Vali Loss: 0.2888405 Best vali loss: 0.2732884
	iters: 100, epoch: 8 | loss: 0.3605480
	speed: 0.0087s/iter; left time: 0.2795s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.703254222869873
Epoch: 8, Steps: 131 | Train Loss: 0.3605480 Vali Loss: 0.2883292 Best vali loss: 0.2732884

best validation loss 0.2732883824839739

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019477427776, 'e_layers': 2, 'learning_rate': 7.12593298e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3727552
	speed: 0.0097s/iter; left time: 9.2391s
Updating learning rate to 6.85471830513458e-05
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 0.8427660465240479
Epoch: 1, Steps: 131 | Train Loss: 0.3727552 Vali Loss: 0.2820910 Best vali loss: 0.2820910
	iters: 100, epoch: 2 | loss: 0.3256526
	speed: 0.0074s/iter; left time: 6.0285s
Updating learning rate to 6.0823642562194313e-05
Validation loss decreased (0.2821 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 0.5593447685241699
Epoch: 2, Steps: 131 | Train Loss: 0.3256526 Vali Loss: 0.2781177 Best vali loss: 0.2781177
	iters: 100, epoch: 3 | loss: 0.4010257
	speed: 0.0074s/iter; left time: 5.0851s
Updating learning rate to 4.926454735794997e-05
Validation loss decreased (0.2781 --> 0.2734).  Saving model state dict ...
Epoch: 3 cost time: 0.5592083930969238
Epoch: 3, Steps: 131 | Train Loss: 0.4010257 Vali Loss: 0.2734192 Best vali loss: 0.2734192
	iters: 100, epoch: 4 | loss: 0.4906586
	speed: 0.0072s/iter; left time: 4.0225s
Updating learning rate to 3.56296649e-05
Epoch: 4 cost time: 0.543748140335083
Epoch: 4, Steps: 131 | Train Loss: 0.4906586 Vali Loss: 0.2767756 Best vali loss: 0.2734192
	iters: 100, epoch: 5 | loss: 0.3959106
	speed: 0.0069s/iter; left time: 2.9322s
Updating learning rate to 2.1994782442050038e-05
Epoch: 5 cost time: 0.5416638851165771
Epoch: 5, Steps: 131 | Train Loss: 0.3959106 Vali Loss: 0.2813439 Best vali loss: 0.2734192
	iters: 100, epoch: 6 | loss: 0.3739580
	speed: 0.0068s/iter; left time: 2.0108s
Updating learning rate to 1.043568723780569e-05
Epoch: 6 cost time: 0.5354552268981934
Epoch: 6, Steps: 131 | Train Loss: 0.3739580 Vali Loss: 0.2853658 Best vali loss: 0.2734192
	iters: 100, epoch: 7 | loss: 0.6067815
	speed: 0.0069s/iter; left time: 1.1171s
Updating learning rate to 2.7121467486541983e-06
Epoch: 7 cost time: 0.5372984409332275
Epoch: 7, Steps: 131 | Train Loss: 0.6067815 Vali Loss: 0.2859713 Best vali loss: 0.2734192
	iters: 100, epoch: 8 | loss: 0.4384546
	speed: 0.0072s/iter; left time: 0.2291s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5688619613647461
Epoch: 8, Steps: 131 | Train Loss: 0.4384546 Vali Loss: 0.2869718 Best vali loss: 0.2734192

best validation loss 0.2734192259950503

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019449419118, 'e_layers': 2, 'learning_rate': 8.08414752e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3710828
	speed: 0.0098s/iter; left time: 9.2775s
Updating learning rate to 8.08414752e-05
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.8399136066436768
Epoch: 1, Steps: 131 | Train Loss: 0.3710828 Vali Loss: 0.2818591 Best vali loss: 0.2818591
	iters: 100, epoch: 2 | loss: 0.3250217
	speed: 0.0078s/iter; left time: 6.3608s
Updating learning rate to 4.04207376e-05
Validation loss decreased (0.2819 --> 0.2776).  Saving model state dict ...
Epoch: 2 cost time: 0.6039977073669434
Epoch: 2, Steps: 131 | Train Loss: 0.3250217 Vali Loss: 0.2775846 Best vali loss: 0.2775846
	iters: 100, epoch: 3 | loss: 0.4001050
	speed: 0.0075s/iter; left time: 5.1389s
Updating learning rate to 2.02103688e-05
Validation loss decreased (0.2776 --> 0.2736).  Saving model state dict ...
Epoch: 3 cost time: 0.5686435699462891
Epoch: 3, Steps: 131 | Train Loss: 0.4001050 Vali Loss: 0.2735952 Best vali loss: 0.2735952

best validation loss 0.2735951752157715

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019032743404, 'e_layers': 2, 'learning_rate': 7.75311238e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6415256
	speed: 0.0105s/iter; left time: 9.9355s
Updating learning rate to 7.75311238e-05
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.9349460601806641
Epoch: 1, Steps: 131 | Train Loss: 0.6415256 Vali Loss: 0.2782144 Best vali loss: 0.2782144
	iters: 100, epoch: 2 | loss: 0.3946745
	speed: 0.0090s/iter; left time: 7.3466s
Updating learning rate to 3.87655619e-05
Validation loss decreased (0.2782 --> 0.2760).  Saving model state dict ...
Epoch: 2 cost time: 0.7052137851715088
Epoch: 2, Steps: 131 | Train Loss: 0.3946745 Vali Loss: 0.2760352 Best vali loss: 0.2760352
	iters: 100, epoch: 3 | loss: 0.8872814
	speed: 0.0090s/iter; left time: 6.1503s
Updating learning rate to 1.938278095e-05
Validation loss decreased (0.2760 --> 0.2743).  Saving model state dict ...
Epoch: 3 cost time: 0.7059571743011475
Epoch: 3, Steps: 131 | Train Loss: 0.8872814 Vali Loss: 0.2742646 Best vali loss: 0.2742646

best validation loss 0.2742646458746111

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019132059312, 'e_layers': 2, 'learning_rate': 7.6124409e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6417650
	speed: 0.0103s/iter; left time: 9.7746s
Updating learning rate to 7.6124409e-05
Validation loss decreased (inf --> 0.2783).  Saving model state dict ...
Epoch: 1 cost time: 0.9314608573913574
Epoch: 1, Steps: 131 | Train Loss: 0.6417650 Vali Loss: 0.2783145 Best vali loss: 0.2783145
	iters: 100, epoch: 2 | loss: 0.3956144
	speed: 0.0089s/iter; left time: 7.2431s
Updating learning rate to 3.80622045e-05
Validation loss decreased (0.2783 --> 0.2761).  Saving model state dict ...
Epoch: 2 cost time: 0.7009677886962891
Epoch: 2, Steps: 131 | Train Loss: 0.3956144 Vali Loss: 0.2760532 Best vali loss: 0.2760532
	iters: 100, epoch: 3 | loss: 0.8878484
	speed: 0.0089s/iter; left time: 6.1382s
Updating learning rate to 1.903110225e-05
Validation loss decreased (0.2761 --> 0.2742).  Saving model state dict ...
Epoch: 3 cost time: 0.7055034637451172
Epoch: 3, Steps: 131 | Train Loss: 0.8878484 Vali Loss: 0.2742455 Best vali loss: 0.2742455

best validation loss 0.2742454832916412

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019449419118, 'e_layers': 2, 'learning_rate': 8.08414752e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3512299
	speed: 0.0098s/iter; left time: 5.4706s
Updating learning rate to 1.01051844e-05
Epoch: 4 cost time: 0.8400046825408936
Epoch: 4, Steps: 131 | Train Loss: 0.3512299 Vali Loss: 0.2749001 Best vali loss: 0.2735952
	iters: 100, epoch: 5 | loss: 0.3099161
	speed: 0.0074s/iter; left time: 3.1389s
Updating learning rate to 5.0525922e-06
Epoch: 5 cost time: 0.5866212844848633
Epoch: 5, Steps: 131 | Train Loss: 0.3099161 Vali Loss: 0.2739365 Best vali loss: 0.2735952
	iters: 100, epoch: 6 | loss: 0.3964254
	speed: 0.0074s/iter; left time: 2.1893s
Updating learning rate to 2.5262961e-06
Epoch: 6 cost time: 0.5891313552856445
Epoch: 6, Steps: 131 | Train Loss: 0.3964254 Vali Loss: 0.2739522 Best vali loss: 0.2735952
	iters: 100, epoch: 7 | loss: 0.4847713
	speed: 0.0074s/iter; left time: 1.2003s
Updating learning rate to 1.26314805e-06
Epoch: 7 cost time: 0.5835452079772949
Epoch: 7, Steps: 131 | Train Loss: 0.4847713 Vali Loss: 0.2741695 Best vali loss: 0.2735952
	iters: 100, epoch: 8 | loss: 0.4044886
	speed: 0.0072s/iter; left time: 0.2300s
Updating learning rate to 6.31574025e-07
Epoch: 8 cost time: 0.5662031173706055
Epoch: 8, Steps: 131 | Train Loss: 0.4044886 Vali Loss: 0.2743063 Best vali loss: 0.2735952

best validation loss 0.2735951752157715

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019260921498, 'e_layers': 2, 'learning_rate': 7.75904607e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3716240
	speed: 0.0095s/iter; left time: 9.0365s
Updating learning rate to 7.75904607e-05
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.826347827911377
Epoch: 1, Steps: 131 | Train Loss: 0.3716240 Vali Loss: 0.2819250 Best vali loss: 0.2819250
	iters: 100, epoch: 2 | loss: 0.3251525
	speed: 0.0074s/iter; left time: 6.0830s
Updating learning rate to 3.879523035e-05
Validation loss decreased (0.2819 --> 0.2778).  Saving model state dict ...
Epoch: 2 cost time: 0.5820400714874268
Epoch: 2, Steps: 131 | Train Loss: 0.3251525 Vali Loss: 0.2777696 Best vali loss: 0.2777696
	iters: 100, epoch: 3 | loss: 0.4012494
	speed: 0.0075s/iter; left time: 5.1670s
Updating learning rate to 1.9397615175e-05
Validation loss decreased (0.2778 --> 0.2741).  Saving model state dict ...
Epoch: 3 cost time: 0.5815322399139404
Epoch: 3, Steps: 131 | Train Loss: 0.4012494 Vali Loss: 0.2740794 Best vali loss: 0.2740794
	iters: 100, epoch: 4 | loss: 0.4969666
	speed: 0.0074s/iter; left time: 4.1131s
Updating learning rate to 9.6988075875e-06
Validation loss decreased (0.2741 --> 0.2740).  Saving model state dict ...
Epoch: 4 cost time: 0.5683906078338623
Epoch: 4, Steps: 131 | Train Loss: 0.4969666 Vali Loss: 0.2739510 Best vali loss: 0.2739510
	iters: 100, epoch: 5 | loss: 0.4148147
	speed: 0.0075s/iter; left time: 3.1796s
Updating learning rate to 4.84940379375e-06
Validation loss decreased (0.2740 --> 0.2733).  Saving model state dict ...
Epoch: 5 cost time: 0.5747776031494141
Epoch: 5, Steps: 131 | Train Loss: 0.4148147 Vali Loss: 0.2733192 Best vali loss: 0.2733192
	iters: 100, epoch: 6 | loss: 0.4039881
	speed: 0.0072s/iter; left time: 2.1250s
Updating learning rate to 2.424701896875e-06
Epoch: 6 cost time: 0.5612738132476807
Epoch: 6, Steps: 131 | Train Loss: 0.4039881 Vali Loss: 0.2736691 Best vali loss: 0.2733192
	iters: 100, epoch: 7 | loss: 0.6800898
	speed: 0.0072s/iter; left time: 1.1698s
Updating learning rate to 1.2123509484375e-06
Epoch: 7 cost time: 0.5500273704528809
Epoch: 7, Steps: 131 | Train Loss: 0.6800898 Vali Loss: 0.2733648 Best vali loss: 0.2733192
	iters: 100, epoch: 8 | loss: 0.4817450
	speed: 0.0071s/iter; left time: 0.2276s
Updating learning rate to 6.0617547421875e-07
Epoch: 8 cost time: 0.5733969211578369
Epoch: 8, Steps: 131 | Train Loss: 0.4817450 Vali Loss: 0.2734748 Best vali loss: 0.2733192

best validation loss 0.2733191588679491

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019007215368, 'e_layers': 2, 'learning_rate': 7.39694476e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3722624
	speed: 0.0095s/iter; left time: 9.0541s
Updating learning rate to 7.39694476e-05
Validation loss decreased (inf --> 0.2820).  Saving model state dict ...
Epoch: 1 cost time: 0.8129260540008545
Epoch: 1, Steps: 131 | Train Loss: 0.3722624 Vali Loss: 0.2820150 Best vali loss: 0.2820150
	iters: 100, epoch: 2 | loss: 0.3254755
	speed: 0.0071s/iter; left time: 5.8235s
Updating learning rate to 3.69847238e-05
Validation loss decreased (0.2820 --> 0.2780).  Saving model state dict ...
Epoch: 2 cost time: 0.5416975021362305
Epoch: 2, Steps: 131 | Train Loss: 0.3254755 Vali Loss: 0.2779741 Best vali loss: 0.2779741
	iters: 100, epoch: 3 | loss: 0.4019847
	speed: 0.0070s/iter; left time: 4.7948s
Updating learning rate to 1.84923619e-05
Validation loss decreased (0.2780 --> 0.2748).  Saving model state dict ...
Epoch: 3 cost time: 0.5347292423248291
Epoch: 3, Steps: 131 | Train Loss: 0.4019847 Vali Loss: 0.2747942 Best vali loss: 0.2747942
	iters: 100, epoch: 4 | loss: 0.5001460
	speed: 0.0074s/iter; left time: 4.0919s
Updating learning rate to 9.24618095e-06
Validation loss decreased (0.2748 --> 0.2744).  Saving model state dict ...
Epoch: 4 cost time: 0.5824720859527588
Epoch: 4, Steps: 131 | Train Loss: 0.5001460 Vali Loss: 0.2743762 Best vali loss: 0.2743762
	iters: 100, epoch: 5 | loss: 0.4151336
	speed: 0.0071s/iter; left time: 3.0199s
Updating learning rate to 4.623090475e-06
Validation loss decreased (0.2744 --> 0.2736).  Saving model state dict ...
Epoch: 5 cost time: 0.5427517890930176
Epoch: 5, Steps: 131 | Train Loss: 0.4151336 Vali Loss: 0.2736266 Best vali loss: 0.2736266
	iters: 100, epoch: 6 | loss: 0.4077832
	speed: 0.0071s/iter; left time: 2.0811s
Updating learning rate to 2.3115452375e-06
Epoch: 6 cost time: 0.5431387424468994
Epoch: 6, Steps: 131 | Train Loss: 0.4077832 Vali Loss: 0.2737922 Best vali loss: 0.2736266
	iters: 100, epoch: 7 | loss: 0.6877239
	speed: 0.0068s/iter; left time: 1.1051s
Updating learning rate to 1.15577261875e-06
Validation loss decreased (0.2736 --> 0.2735).  Saving model state dict ...
Epoch: 7 cost time: 0.5271642208099365
Epoch: 7, Steps: 131 | Train Loss: 0.6877239 Vali Loss: 0.2734503 Best vali loss: 0.2734503
	iters: 100, epoch: 8 | loss: 0.4867538
	speed: 0.0072s/iter; left time: 0.2294s
Updating learning rate to 5.77886309375e-07
Epoch: 8 cost time: 0.5645337104797363
Epoch: 8, Steps: 131 | Train Loss: 0.4867538 Vali Loss: 0.2734606 Best vali loss: 0.2734503

best validation loss 0.273450312637937

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019165138618, 'e_layers': 2, 'learning_rate': 8.06863465e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3711098
	speed: 0.0099s/iter; left time: 9.3735s
Updating learning rate to 8.06863465e-05
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.8453752994537354
Epoch: 1, Steps: 131 | Train Loss: 0.3711098 Vali Loss: 0.2818658 Best vali loss: 0.2818658
	iters: 100, epoch: 2 | loss: 0.3250366
	speed: 0.0072s/iter; left time: 5.8643s
Updating learning rate to 4.034317325e-05
Validation loss decreased (0.2819 --> 0.2776).  Saving model state dict ...
Epoch: 2 cost time: 0.531256914138794
Epoch: 2, Steps: 131 | Train Loss: 0.3250366 Vali Loss: 0.2776458 Best vali loss: 0.2776458
	iters: 100, epoch: 3 | loss: 0.4003864
	speed: 0.0069s/iter; left time: 4.7243s
Updating learning rate to 2.0171586625e-05
Validation loss decreased (0.2776 --> 0.2737).  Saving model state dict ...
Epoch: 3 cost time: 0.540560245513916
Epoch: 3, Steps: 131 | Train Loss: 0.4003864 Vali Loss: 0.2737375 Best vali loss: 0.2737375

best validation loss 0.27373751025964177

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4115252
	speed: 0.0092s/iter; left time: 75.9983s
	iters: 200, epoch: 1 | loss: 0.2935918
	speed: 0.0038s/iter; left time: 30.8655s
	iters: 300, epoch: 1 | loss: 0.7039090
	speed: 0.0038s/iter; left time: 30.8987s
	iters: 400, epoch: 1 | loss: 0.3624870
	speed: 0.0038s/iter; left time: 30.4689s
	iters: 500, epoch: 1 | loss: 0.3321506
	speed: 0.0038s/iter; left time: 29.6474s
	iters: 600, epoch: 1 | loss: 0.2713432
	speed: 0.0038s/iter; left time: 29.3444s
	iters: 700, epoch: 1 | loss: 0.2268407
	speed: 0.0039s/iter; left time: 30.1586s
	iters: 800, epoch: 1 | loss: 0.1915079
	speed: 0.0039s/iter; left time: 29.5615s
	iters: 900, epoch: 1 | loss: 1.3950286
	speed: 0.0039s/iter; left time: 28.8988s
	iters: 1000, epoch: 1 | loss: 0.6714419
	speed: 0.0039s/iter; left time: 28.7145s
Updating learning rate to 0.0001606491471
Validation loss decreased (inf --> 0.2907).  Saving model state dict ...
Epoch: 1 cost time: 4.294850826263428
Epoch: 1, Steps: 1045 | Train Loss: 0.4859826 Vali Loss: 0.2906780 Best vali loss: 0.2906780
	iters: 100, epoch: 2 | loss: 0.5050956
	speed: 0.0119s/iter; left time: 85.8158s
	iters: 200, epoch: 2 | loss: 0.4448963
	speed: 0.0041s/iter; left time: 29.2964s
	iters: 300, epoch: 2 | loss: 1.3684880
	speed: 0.0041s/iter; left time: 29.0697s
	iters: 400, epoch: 2 | loss: 0.2206654
	speed: 0.0041s/iter; left time: 28.6914s
	iters: 500, epoch: 2 | loss: 0.3475917
	speed: 0.0041s/iter; left time: 27.9498s
	iters: 600, epoch: 2 | loss: 0.2891924
	speed: 0.0040s/iter; left time: 27.0732s
	iters: 700, epoch: 2 | loss: 0.2985906
	speed: 0.0041s/iter; left time: 27.1260s
	iters: 800, epoch: 2 | loss: 0.3550837
	speed: 0.0041s/iter; left time: 26.6983s
	iters: 900, epoch: 2 | loss: 0.3671905
	speed: 0.0042s/iter; left time: 27.1566s
	iters: 1000, epoch: 2 | loss: 0.3331625
	speed: 0.0041s/iter; left time: 26.0796s
Updating learning rate to 8.032457355e-05
Validation loss decreased (0.2907 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 4.336566686630249
Epoch: 2, Steps: 1045 | Train Loss: 0.4529956 Vali Loss: 0.2814796 Best vali loss: 0.2814796
	iters: 100, epoch: 3 | loss: 0.3669394
	speed: 0.0119s/iter; left time: 73.3288s
	iters: 200, epoch: 3 | loss: 0.3952629
	speed: 0.0041s/iter; left time: 25.0088s
	iters: 300, epoch: 3 | loss: 0.5455806
	speed: 0.0041s/iter; left time: 24.6612s
	iters: 400, epoch: 3 | loss: 1.6010939
	speed: 0.0041s/iter; left time: 24.2065s
	iters: 500, epoch: 3 | loss: 0.4020435
	speed: 0.0041s/iter; left time: 23.7058s
	iters: 600, epoch: 3 | loss: 0.1950179
	speed: 0.0040s/iter; left time: 22.9050s
	iters: 700, epoch: 3 | loss: 0.3373289
	speed: 0.0041s/iter; left time: 22.6243s
	iters: 800, epoch: 3 | loss: 0.1734656
	speed: 0.0041s/iter; left time: 22.5382s
	iters: 900, epoch: 3 | loss: 0.9079828
	speed: 0.0041s/iter; left time: 21.9148s
	iters: 1000, epoch: 3 | loss: 0.2108055
	speed: 0.0041s/iter; left time: 21.8237s
Updating learning rate to 4.0162286775e-05
Epoch: 3 cost time: 4.3227620124816895
Epoch: 3, Steps: 1045 | Train Loss: 0.5135521 Vali Loss: 0.2827906 Best vali loss: 0.2814796

best validation loss 0.281479586341116

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0018943066675, 'e_layers': 2, 'learning_rate': 7.48217667e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3721124
	speed: 0.0096s/iter; left time: 9.1028s
Updating learning rate to 7.48217667e-05
Validation loss decreased (inf --> 0.2820).  Saving model state dict ...
Epoch: 1 cost time: 0.8215179443359375
Epoch: 1, Steps: 131 | Train Loss: 0.3721124 Vali Loss: 0.2819917 Best vali loss: 0.2819917
	iters: 100, epoch: 2 | loss: 0.3253597
	speed: 0.0074s/iter; left time: 6.0326s
Updating learning rate to 3.741088335e-05
Validation loss decreased (0.2820 --> 0.2779).  Saving model state dict ...
Epoch: 2 cost time: 0.5629756450653076
Epoch: 2, Steps: 131 | Train Loss: 0.3253597 Vali Loss: 0.2779344 Best vali loss: 0.2779344
	iters: 100, epoch: 3 | loss: 0.4018588
	speed: 0.0076s/iter; left time: 5.2179s
Updating learning rate to 1.8705441675e-05
Validation loss decreased (0.2779 --> 0.2747).  Saving model state dict ...
Epoch: 3 cost time: 0.5773048400878906
Epoch: 3, Steps: 131 | Train Loss: 0.4018588 Vali Loss: 0.2746803 Best vali loss: 0.2746803

best validation loss 0.2746802847340631

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019165138618, 'e_layers': 2, 'learning_rate': 8.06863465e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3512338
	speed: 0.0100s/iter; left time: 5.5352s
Updating learning rate to 1.00857933125e-05
Epoch: 4 cost time: 0.8378019332885742
Epoch: 4, Steps: 131 | Train Loss: 0.3512338 Vali Loss: 0.2749687 Best vali loss: 0.2737375
	iters: 100, epoch: 5 | loss: 0.3105606
	speed: 0.0072s/iter; left time: 3.0781s
Updating learning rate to 5.04289665625e-06
Epoch: 5 cost time: 0.5667824745178223
Epoch: 5, Steps: 131 | Train Loss: 0.3105606 Vali Loss: 0.2739592 Best vali loss: 0.2737375
	iters: 100, epoch: 6 | loss: 0.3966812
	speed: 0.0072s/iter; left time: 2.1073s
Updating learning rate to 2.521448328125e-06
Epoch: 6 cost time: 0.5746443271636963
Epoch: 6, Steps: 131 | Train Loss: 0.3966812 Vali Loss: 0.2739037 Best vali loss: 0.2737375
	iters: 100, epoch: 7 | loss: 0.4847694
	speed: 0.0072s/iter; left time: 1.1788s
Updating learning rate to 1.2607241640625e-06
Epoch: 7 cost time: 0.5840542316436768
Epoch: 7, Steps: 131 | Train Loss: 0.4847694 Vali Loss: 0.2741378 Best vali loss: 0.2737375
	iters: 100, epoch: 8 | loss: 0.4050815
	speed: 0.0070s/iter; left time: 0.2248s
Updating learning rate to 6.3036208203125e-07
Epoch: 8 cost time: 0.54695725440979
Epoch: 8, Steps: 131 | Train Loss: 0.4050815 Vali Loss: 0.2742685 Best vali loss: 0.2737375

best validation loss 0.27373751025964177

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0046289251849, 'e_layers': 2, 'learning_rate': 7.31859557e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3482715
	speed: 0.0085s/iter; left time: 34.8765s
	iters: 200, epoch: 1 | loss: 0.3741985
	speed: 0.0035s/iter; left time: 13.9246s
	iters: 300, epoch: 1 | loss: 0.5885814
	speed: 0.0035s/iter; left time: 13.6170s
	iters: 400, epoch: 1 | loss: 0.7602268
	speed: 0.0035s/iter; left time: 13.2835s
	iters: 500, epoch: 1 | loss: 0.3400882
	speed: 0.0035s/iter; left time: 12.8250s
Updating learning rate to 7.040048111925387e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 2.0917088985443115
Epoch: 1, Steps: 523 | Train Loss: 0.4822733 Vali Loss: 0.2798339 Best vali loss: 0.2798339
	iters: 100, epoch: 2 | loss: 0.8225352
	speed: 0.0079s/iter; left time: 28.1030s
	iters: 200, epoch: 2 | loss: 0.3921395
	speed: 0.0037s/iter; left time: 12.7854s
	iters: 300, epoch: 2 | loss: 0.7236037
	speed: 0.0036s/iter; left time: 12.2604s
	iters: 400, epoch: 2 | loss: 0.4205201
	speed: 0.0035s/iter; left time: 11.3529s
	iters: 500, epoch: 2 | loss: 0.7144833
	speed: 0.0035s/iter; left time: 10.9919s
Updating learning rate to 6.246812063154413e-05
Validation loss decreased (0.2798 --> 0.2745).  Saving model state dict ...
Epoch: 2 cost time: 1.8999202251434326
Epoch: 2, Steps: 523 | Train Loss: 0.6146564 Vali Loss: 0.2744500 Best vali loss: 0.2744500
	iters: 100, epoch: 3 | loss: 0.4386066
	speed: 0.0080s/iter; left time: 24.1614s
	iters: 200, epoch: 3 | loss: 0.3040780
	speed: 0.0035s/iter; left time: 10.2379s
	iters: 300, epoch: 3 | loss: 0.5914518
	speed: 0.0035s/iter; left time: 9.8523s
	iters: 400, epoch: 3 | loss: 0.7323207
	speed: 0.0035s/iter; left time: 9.5229s
	iters: 500, epoch: 3 | loss: 0.5601095
	speed: 0.0035s/iter; left time: 9.1950s
Updating learning rate to 5.05965042140977e-05
Epoch: 3 cost time: 1.8566415309906006
Epoch: 3, Steps: 523 | Train Loss: 0.5253133 Vali Loss: 0.2823605 Best vali loss: 0.2744500
	iters: 100, epoch: 4 | loss: 0.3539499
	speed: 0.0075s/iter; left time: 18.9681s
	iters: 200, epoch: 4 | loss: 0.9089772
	speed: 0.0035s/iter; left time: 8.4094s
	iters: 300, epoch: 4 | loss: 0.3099674
	speed: 0.0035s/iter; left time: 8.0068s
	iters: 400, epoch: 4 | loss: 0.6681710
	speed: 0.0035s/iter; left time: 7.7338s
	iters: 500, epoch: 4 | loss: 0.4113888
	speed: 0.0035s/iter; left time: 7.3663s
Updating learning rate to 3.659297785e-05
Epoch: 4 cost time: 1.8438992500305176
Epoch: 4, Steps: 523 | Train Loss: 0.5304908 Vali Loss: 0.2824116 Best vali loss: 0.2744500
	iters: 100, epoch: 5 | loss: 0.6364774
	speed: 0.0073s/iter; left time: 14.4839s
	iters: 200, epoch: 5 | loss: 0.3791223
	speed: 0.0030s/iter; left time: 5.7355s
	iters: 300, epoch: 5 | loss: 0.3172280
	speed: 0.0030s/iter; left time: 5.3824s
	iters: 400, epoch: 5 | loss: 0.1985610
	speed: 0.0030s/iter; left time: 5.1275s
	iters: 500, epoch: 5 | loss: 0.2765418
	speed: 0.0030s/iter; left time: 4.8165s
Updating learning rate to 2.2589451485902297e-05
Epoch: 5 cost time: 1.6254844665527344
Epoch: 5, Steps: 523 | Train Loss: 0.3615861 Vali Loss: 0.2911067 Best vali loss: 0.2744500
	iters: 100, epoch: 6 | loss: 0.3447069
	speed: 0.0076s/iter; left time: 11.1332s
	iters: 200, epoch: 6 | loss: 0.4588032
	speed: 0.0035s/iter; left time: 4.7374s
	iters: 300, epoch: 6 | loss: 0.3291112
	speed: 0.0035s/iter; left time: 4.4203s
	iters: 400, epoch: 6 | loss: 0.7991840
	speed: 0.0035s/iter; left time: 4.0938s
	iters: 500, epoch: 6 | loss: 0.3729680
	speed: 0.0035s/iter; left time: 3.6976s
Updating learning rate to 1.0717835068455871e-05
Epoch: 6 cost time: 1.8566980361938477
Epoch: 6, Steps: 523 | Train Loss: 0.4609547 Vali Loss: 0.2997608 Best vali loss: 0.2744500
	iters: 100, epoch: 7 | loss: 0.2354269
	speed: 0.0075s/iter; left time: 7.1438s
	iters: 200, epoch: 7 | loss: 0.5764813
	speed: 0.0035s/iter; left time: 2.9840s
	iters: 300, epoch: 7 | loss: 0.3154559
	speed: 0.0035s/iter; left time: 2.6371s
	iters: 400, epoch: 7 | loss: 0.2685924
	speed: 0.0036s/iter; left time: 2.2975s
	iters: 500, epoch: 7 | loss: 0.3174593
	speed: 0.0035s/iter; left time: 1.9351s
Updating learning rate to 2.7854745807461293e-06
Epoch: 7 cost time: 1.8814215660095215
Epoch: 7, Steps: 523 | Train Loss: 0.3426832 Vali Loss: 0.3006991 Best vali loss: 0.2744500
	iters: 100, epoch: 8 | loss: 0.6104972
	speed: 0.0074s/iter; left time: 3.1504s
	iters: 200, epoch: 8 | loss: 0.5705480
	speed: 0.0033s/iter; left time: 1.0558s
	iters: 300, epoch: 8 | loss: 0.4232952
	speed: 0.0033s/iter; left time: 0.7299s
	iters: 400, epoch: 8 | loss: 0.3665974
	speed: 0.0032s/iter; left time: 0.4019s
	iters: 500, epoch: 8 | loss: 0.5152851
	speed: 0.0032s/iter; left time: 0.0770s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7375495433807373
Epoch: 8, Steps: 523 | Train Loss: 0.4972446 Vali Loss: 0.2920844 Best vali loss: 0.2744500

best validation loss 0.27445001905183447

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0044665746593, 'e_layers': 2, 'learning_rate': 7.33290149e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3481940
	speed: 0.0085s/iter; left time: 34.8423s
	iters: 200, epoch: 1 | loss: 0.3741783
	speed: 0.0035s/iter; left time: 13.8922s
	iters: 300, epoch: 1 | loss: 0.5886828
	speed: 0.0035s/iter; left time: 13.5159s
	iters: 400, epoch: 1 | loss: 0.7600669
	speed: 0.0035s/iter; left time: 13.1326s
	iters: 500, epoch: 1 | loss: 0.3400693
	speed: 0.0035s/iter; left time: 12.7590s
Updating learning rate to 7.05380954526626e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 2.0773346424102783
Epoch: 1, Steps: 523 | Train Loss: 0.4822383 Vali Loss: 0.2798479 Best vali loss: 0.2798479
	iters: 100, epoch: 2 | loss: 0.8225633
	speed: 0.0078s/iter; left time: 27.9115s
	iters: 200, epoch: 2 | loss: 0.3921402
	speed: 0.0036s/iter; left time: 12.4348s
	iters: 300, epoch: 2 | loss: 0.7249439
	speed: 0.0036s/iter; left time: 11.9818s
	iters: 400, epoch: 2 | loss: 0.4215723
	speed: 0.0035s/iter; left time: 11.4092s
	iters: 500, epoch: 2 | loss: 0.7132612
	speed: 0.0036s/iter; left time: 11.2532s
Updating learning rate to 6.259022929675969e-05
Validation loss decreased (0.2798 --> 0.2747).  Saving model state dict ...
Epoch: 2 cost time: 1.8923776149749756
Epoch: 2, Steps: 523 | Train Loss: 0.6148962 Vali Loss: 0.2746659 Best vali loss: 0.2746659
	iters: 100, epoch: 3 | loss: 0.4386894
	speed: 0.0079s/iter; left time: 23.9346s
	iters: 200, epoch: 3 | loss: 0.3052198
	speed: 0.0034s/iter; left time: 10.0940s
	iters: 300, epoch: 3 | loss: 0.5886906
	speed: 0.0034s/iter; left time: 9.5946s
	iters: 400, epoch: 3 | loss: 0.7289053
	speed: 0.0035s/iter; left time: 9.5665s
	iters: 500, epoch: 3 | loss: 0.6086727
	speed: 0.0036s/iter; left time: 9.4545s
Updating learning rate to 5.069540700694141e-05
Epoch: 3 cost time: 1.8517160415649414
Epoch: 3, Steps: 523 | Train Loss: 0.5340356 Vali Loss: 0.2823833 Best vali loss: 0.2746659
	iters: 100, epoch: 4 | loss: 0.3589781
	speed: 0.0075s/iter; left time: 18.9243s
	iters: 200, epoch: 4 | loss: 0.9074398
	speed: 0.0035s/iter; left time: 8.3734s
	iters: 300, epoch: 4 | loss: 0.3028370
	speed: 0.0035s/iter; left time: 8.0597s
	iters: 400, epoch: 4 | loss: 0.6533271
	speed: 0.0035s/iter; left time: 7.7101s
	iters: 500, epoch: 4 | loss: 0.4133947
	speed: 0.0035s/iter; left time: 7.3438s
Updating learning rate to 3.666450745e-05
Epoch: 4 cost time: 1.8503291606903076
Epoch: 4, Steps: 523 | Train Loss: 0.5271953 Vali Loss: 0.2819641 Best vali loss: 0.2746659
	iters: 100, epoch: 5 | loss: 0.6301178
	speed: 0.0073s/iter; left time: 14.5827s
	iters: 200, epoch: 5 | loss: 0.3844948
	speed: 0.0033s/iter; left time: 6.2491s
	iters: 300, epoch: 5 | loss: 0.3239335
	speed: 0.0033s/iter; left time: 5.8999s
	iters: 400, epoch: 5 | loss: 0.1990534
	speed: 0.0032s/iter; left time: 5.4065s
	iters: 500, epoch: 5 | loss: 0.2820285
	speed: 0.0033s/iter; left time: 5.2995s
Updating learning rate to 2.26336078930586e-05
Epoch: 5 cost time: 1.7474958896636963
Epoch: 5, Steps: 523 | Train Loss: 0.3639256 Vali Loss: 0.2916279 Best vali loss: 0.2746659
	iters: 100, epoch: 6 | loss: 0.3434404
	speed: 0.0072s/iter; left time: 10.6232s
	iters: 200, epoch: 6 | loss: 0.4506057
	speed: 0.0034s/iter; left time: 4.7011s
	iters: 300, epoch: 6 | loss: 0.3263787
	speed: 0.0035s/iter; left time: 4.4235s
	iters: 400, epoch: 6 | loss: 0.7690423
	speed: 0.0035s/iter; left time: 4.0852s
	iters: 500, epoch: 6 | loss: 0.3739294
	speed: 0.0035s/iter; left time: 3.7135s
Updating learning rate to 1.073878560324031e-05
Epoch: 6 cost time: 1.813248872756958
Epoch: 6, Steps: 523 | Train Loss: 0.4526793 Vali Loss: 0.3005510 Best vali loss: 0.2746659
	iters: 100, epoch: 7 | loss: 0.2382727
	speed: 0.0075s/iter; left time: 7.1460s
	iters: 200, epoch: 7 | loss: 0.5801715
	speed: 0.0035s/iter; left time: 2.9445s
	iters: 300, epoch: 7 | loss: 0.3209962
	speed: 0.0035s/iter; left time: 2.5904s
	iters: 400, epoch: 7 | loss: 0.2710313
	speed: 0.0035s/iter; left time: 2.2371s
	iters: 500, epoch: 7 | loss: 0.3185670
	speed: 0.0035s/iter; left time: 1.9035s
Updating learning rate to 2.7909194473374102e-06
Epoch: 7 cost time: 1.852891206741333
Epoch: 7, Steps: 523 | Train Loss: 0.3458077 Vali Loss: 0.3017609 Best vali loss: 0.2746659
	iters: 100, epoch: 8 | loss: 0.6119012
	speed: 0.0077s/iter; left time: 3.2602s
	iters: 200, epoch: 8 | loss: 0.5644651
	speed: 0.0035s/iter; left time: 1.1350s
	iters: 300, epoch: 8 | loss: 0.4192953
	speed: 0.0035s/iter; left time: 0.7856s
	iters: 400, epoch: 8 | loss: 0.3637114
	speed: 0.0035s/iter; left time: 0.4333s
	iters: 500, epoch: 8 | loss: 0.5164735
	speed: 0.0035s/iter; left time: 0.0840s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8683676719665527
Epoch: 8, Steps: 523 | Train Loss: 0.4951693 Vali Loss: 0.2928557 Best vali loss: 0.2746659

best validation loss 0.27466586740620297

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048164135913, 'e_layers': 2, 'learning_rate': 7.33521259e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3483766
	speed: 0.0087s/iter; left time: 35.5255s
	iters: 200, epoch: 1 | loss: 0.3742669
	speed: 0.0035s/iter; left time: 13.8966s
	iters: 300, epoch: 1 | loss: 0.5886444
	speed: 0.0032s/iter; left time: 12.3977s
	iters: 400, epoch: 1 | loss: 0.7601024
	speed: 0.0032s/iter; left time: 12.1321s
	iters: 500, epoch: 1 | loss: 0.3402321
	speed: 0.0032s/iter; left time: 11.7667s
Updating learning rate to 7.056032684260053e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 1.993499517440796
Epoch: 1, Steps: 523 | Train Loss: 0.4823245 Vali Loss: 0.2798441 Best vali loss: 0.2798441
	iters: 100, epoch: 2 | loss: 0.8221104
	speed: 0.0078s/iter; left time: 27.9178s
	iters: 200, epoch: 2 | loss: 0.3915163
	speed: 0.0032s/iter; left time: 11.0422s
	iters: 300, epoch: 2 | loss: 0.7254685
	speed: 0.0034s/iter; left time: 11.3245s
	iters: 400, epoch: 2 | loss: 0.4207641
	speed: 0.0031s/iter; left time: 10.0630s
	iters: 500, epoch: 2 | loss: 0.7140689
	speed: 0.0030s/iter; left time: 9.5263s
Updating learning rate to 6.26099557691697e-05
Validation loss decreased (0.2798 --> 0.2748).  Saving model state dict ...
Epoch: 2 cost time: 1.7083120346069336
Epoch: 2, Steps: 523 | Train Loss: 0.6147856 Vali Loss: 0.2747517 Best vali loss: 0.2747517
	iters: 100, epoch: 3 | loss: 0.4386590
	speed: 0.0079s/iter; left time: 24.1392s
	iters: 200, epoch: 3 | loss: 0.3049974
	speed: 0.0033s/iter; left time: 9.6898s
	iters: 300, epoch: 3 | loss: 0.5640156
	speed: 0.0032s/iter; left time: 9.2138s
	iters: 400, epoch: 3 | loss: 0.7321842
	speed: 0.0033s/iter; left time: 9.1073s
	iters: 500, epoch: 3 | loss: 0.5530035
	speed: 0.0033s/iter; left time: 8.7182s
Updating learning rate to 5.07113846053441e-05
Epoch: 3 cost time: 1.761514663696289
Epoch: 3, Steps: 523 | Train Loss: 0.5185719 Vali Loss: 0.2815869 Best vali loss: 0.2747517

best validation loss 0.274751704799925

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047660400613, 'e_layers': 2, 'learning_rate': 7.2457001e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3486143
	speed: 0.0085s/iter; left time: 34.7157s
	iters: 200, epoch: 1 | loss: 0.3740137
	speed: 0.0035s/iter; left time: 13.8705s
	iters: 300, epoch: 1 | loss: 0.5886493
	speed: 0.0035s/iter; left time: 13.4318s
	iters: 400, epoch: 1 | loss: 0.7601150
	speed: 0.0035s/iter; left time: 13.1424s
	iters: 500, epoch: 1 | loss: 0.3401587
	speed: 0.0034s/iter; left time: 12.6846s
Updating learning rate to 6.969927060552491e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 2.068094253540039
Epoch: 1, Steps: 523 | Train Loss: 0.4823102 Vali Loss: 0.2797989 Best vali loss: 0.2797989
	iters: 100, epoch: 2 | loss: 0.8224639
	speed: 0.0078s/iter; left time: 27.6679s
	iters: 200, epoch: 2 | loss: 0.3901514
	speed: 0.0035s/iter; left time: 12.0143s
	iters: 300, epoch: 2 | loss: 0.7231540
	speed: 0.0035s/iter; left time: 11.6055s
	iters: 400, epoch: 2 | loss: 0.4207780
	speed: 0.0033s/iter; left time: 10.8596s
	iters: 500, epoch: 2 | loss: 0.7133484
	speed: 0.0033s/iter; left time: 10.5315s
Updating learning rate to 6.184591887577022e-05
Validation loss decreased (0.2798 --> 0.2743).  Saving model state dict ...
Epoch: 2 cost time: 1.817885160446167
Epoch: 2, Steps: 523 | Train Loss: 0.6139791 Vali Loss: 0.2743307 Best vali loss: 0.2743307
	iters: 100, epoch: 3 | loss: 0.4369417
	speed: 0.0080s/iter; left time: 24.4258s
	iters: 200, epoch: 3 | loss: 0.3043462
	speed: 0.0035s/iter; left time: 10.2613s
	iters: 300, epoch: 3 | loss: 0.5886059
	speed: 0.0035s/iter; left time: 9.8872s
	iters: 400, epoch: 3 | loss: 0.7295516
	speed: 0.0035s/iter; left time: 9.5070s
	iters: 500, epoch: 3 | loss: 0.5771186
	speed: 0.0035s/iter; left time: 9.1611s
Updating learning rate to 5.009254742078037e-05
Epoch: 3 cost time: 1.856015920639038
Epoch: 3, Steps: 523 | Train Loss: 0.5273128 Vali Loss: 0.2826382 Best vali loss: 0.2743307

best validation loss 0.2743306820245869

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0046401137092, 'e_layers': 2, 'learning_rate': 7.18383155e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3486669
	speed: 0.0094s/iter; left time: 38.2118s
	iters: 200, epoch: 1 | loss: 0.3739754
	speed: 0.0034s/iter; left time: 13.7458s
	iters: 300, epoch: 1 | loss: 0.5885821
	speed: 0.0033s/iter; left time: 13.0084s
	iters: 400, epoch: 1 | loss: 0.7601886
	speed: 0.0033s/iter; left time: 12.6161s
	iters: 500, epoch: 1 | loss: 0.3400674
	speed: 0.0033s/iter; left time: 12.1624s
Updating learning rate to 6.910413242026916e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 2.041015386581421
Epoch: 1, Steps: 523 | Train Loss: 0.4822961 Vali Loss: 0.2797727 Best vali loss: 0.2797727
	iters: 100, epoch: 2 | loss: 0.8212097
	speed: 0.0077s/iter; left time: 27.4492s
	iters: 200, epoch: 2 | loss: 0.3912543
	speed: 0.0033s/iter; left time: 11.3526s
	iters: 300, epoch: 2 | loss: 0.7222003
	speed: 0.0033s/iter; left time: 11.0452s
	iters: 400, epoch: 2 | loss: 0.4203808
	speed: 0.0033s/iter; left time: 10.7270s
	iters: 500, epoch: 2 | loss: 0.7169639
	speed: 0.0033s/iter; left time: 10.4107s
Updating learning rate to 6.131783776953432e-05
Validation loss decreased (0.2798 --> 0.2745).  Saving model state dict ...
Epoch: 2 cost time: 1.7622973918914795
Epoch: 2, Steps: 523 | Train Loss: 0.6144018 Vali Loss: 0.2745069 Best vali loss: 0.2745069
	iters: 100, epoch: 3 | loss: 0.4398879
	speed: 0.0075s/iter; left time: 22.7991s
	iters: 200, epoch: 3 | loss: 0.3042540
	speed: 0.0030s/iter; left time: 8.8536s
	iters: 300, epoch: 3 | loss: 0.5810068
	speed: 0.0030s/iter; left time: 8.5149s
	iters: 400, epoch: 3 | loss: 0.7365497
	speed: 0.0030s/iter; left time: 8.2520s
	iters: 500, epoch: 3 | loss: 0.6581634
	speed: 0.0030s/iter; left time: 7.9613s
Updating learning rate to 4.966482432543312e-05
Epoch: 3 cost time: 1.616248369216919
Epoch: 3, Steps: 523 | Train Loss: 0.5439724 Vali Loss: 0.2811380 Best vali loss: 0.2745069

best validation loss 0.27450688400535433

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047660400613, 'e_layers': 2, 'learning_rate': 7.2457001e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2581378
	speed: 0.0097s/iter; left time: 24.5151s
	iters: 200, epoch: 4 | loss: 0.3195800
	speed: 0.0035s/iter; left time: 8.5212s
	iters: 300, epoch: 4 | loss: 0.5712205
	speed: 0.0035s/iter; left time: 8.1491s
	iters: 400, epoch: 4 | loss: 0.5670255
	speed: 0.0036s/iter; left time: 7.8709s
	iters: 500, epoch: 4 | loss: 0.2576929
	speed: 0.0035s/iter; left time: 7.4792s
Updating learning rate to 3.62285005e-05
Epoch: 4 cost time: 2.1261374950408936
Epoch: 4, Steps: 523 | Train Loss: 0.3947314 Vali Loss: 0.2942853 Best vali loss: 0.2743307
	iters: 100, epoch: 5 | loss: 0.5663781
	speed: 0.0079s/iter; left time: 15.7548s
	iters: 200, epoch: 5 | loss: 0.3645153
	speed: 0.0034s/iter; left time: 6.5119s
	iters: 300, epoch: 5 | loss: 0.5032936
	speed: 0.0032s/iter; left time: 5.7973s
	iters: 400, epoch: 5 | loss: 0.3842732
	speed: 0.0032s/iter; left time: 5.3776s
	iters: 500, epoch: 5 | loss: 0.6046996
	speed: 0.0031s/iter; left time: 4.9685s
Updating learning rate to 2.236445357921963e-05
Epoch: 5 cost time: 1.763524055480957
Epoch: 5, Steps: 523 | Train Loss: 0.4846320 Vali Loss: 0.2862838 Best vali loss: 0.2743307
	iters: 100, epoch: 6 | loss: 0.4268349
	speed: 0.0079s/iter; left time: 11.6335s
	iters: 200, epoch: 6 | loss: 0.2969322
	speed: 0.0033s/iter; left time: 4.5718s
	iters: 300, epoch: 6 | loss: 0.4443661
	speed: 0.0033s/iter; left time: 4.2249s
	iters: 400, epoch: 6 | loss: 0.5626920
	speed: 0.0033s/iter; left time: 3.8178s
	iters: 500, epoch: 6 | loss: 0.4532394
	speed: 0.0031s/iter; left time: 3.3369s
Updating learning rate to 1.0611082124229774e-05
Epoch: 6 cost time: 1.7787468433380127
Epoch: 6, Steps: 523 | Train Loss: 0.4368129 Vali Loss: 0.2924309 Best vali loss: 0.2743307
	iters: 100, epoch: 7 | loss: 0.3263044
	speed: 0.0075s/iter; left time: 7.1330s
	iters: 200, epoch: 7 | loss: 0.7322148
	speed: 0.0030s/iter; left time: 2.5641s
	iters: 300, epoch: 7 | loss: 0.2895503
	speed: 0.0030s/iter; left time: 2.2406s
	iters: 400, epoch: 7 | loss: 0.4978137
	speed: 0.0030s/iter; left time: 1.9441s
	iters: 500, epoch: 7 | loss: 0.3921915
	speed: 0.0030s/iter; left time: 1.6454s
Updating learning rate to 2.757730394475082e-06
Epoch: 7 cost time: 1.6334469318389893
Epoch: 7, Steps: 523 | Train Loss: 0.4476149 Vali Loss: 0.2891941 Best vali loss: 0.2743307
	iters: 100, epoch: 8 | loss: 0.5736417
	speed: 0.0077s/iter; left time: 3.2468s
	iters: 200, epoch: 8 | loss: 0.3106285
	speed: 0.0033s/iter; left time: 1.0535s
	iters: 300, epoch: 8 | loss: 0.2659854
	speed: 0.0033s/iter; left time: 0.7376s
	iters: 400, epoch: 8 | loss: 0.1842036
	speed: 0.0031s/iter; left time: 0.3853s
	iters: 500, epoch: 8 | loss: 0.2631634
	speed: 0.0033s/iter; left time: 0.0796s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7305262088775635
Epoch: 8, Steps: 523 | Train Loss: 0.3195245 Vali Loss: 0.2949997 Best vali loss: 0.2743307

best validation loss 0.2743306820245869

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047810317549, 'e_layers': 2, 'learning_rate': 7.20164409e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3487380
	speed: 0.0094s/iter; left time: 38.2655s
	iters: 200, epoch: 1 | loss: 0.3739688
	speed: 0.0032s/iter; left time: 12.7110s
	iters: 300, epoch: 1 | loss: 0.5886996
	speed: 0.0031s/iter; left time: 12.0835s
	iters: 400, epoch: 1 | loss: 0.7601969
	speed: 0.0032s/iter; left time: 12.0163s
	iters: 500, epoch: 1 | loss: 0.3400561
	speed: 0.0034s/iter; left time: 12.5349s
Updating learning rate to 6.927547832590936e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 1.9793570041656494
Epoch: 1, Steps: 523 | Train Loss: 0.4823318 Vali Loss: 0.2797752 Best vali loss: 0.2797752
	iters: 100, epoch: 2 | loss: 0.8219078
	speed: 0.0077s/iter; left time: 27.3747s
	iters: 200, epoch: 2 | loss: 0.3901094
	speed: 0.0030s/iter; left time: 10.4569s
	iters: 300, epoch: 2 | loss: 0.7232345
	speed: 0.0030s/iter; left time: 10.1229s
	iters: 400, epoch: 2 | loss: 0.4197152
	speed: 0.0030s/iter; left time: 9.8660s
	iters: 500, epoch: 2 | loss: 0.7145635
	speed: 0.0030s/iter; left time: 9.5568s
Updating learning rate to 6.146987730865512e-05
Validation loss decreased (0.2798 --> 0.2744).  Saving model state dict ...
Epoch: 2 cost time: 1.6376471519470215
Epoch: 2, Steps: 523 | Train Loss: 0.6139061 Vali Loss: 0.2743596 Best vali loss: 0.2743596
	iters: 100, epoch: 3 | loss: 0.4391024
	speed: 0.0077s/iter; left time: 23.2712s
	iters: 200, epoch: 3 | loss: 0.3048627
	speed: 0.0030s/iter; left time: 8.8065s
	iters: 300, epoch: 3 | loss: 0.5698389
	speed: 0.0030s/iter; left time: 8.4623s
	iters: 400, epoch: 3 | loss: 0.7198689
	speed: 0.0030s/iter; left time: 8.2248s
	iters: 500, epoch: 3 | loss: 0.5812269
	speed: 0.0030s/iter; left time: 7.9623s
Updating learning rate to 4.978796984516482e-05
Epoch: 3 cost time: 1.6207237243652344
Epoch: 3, Steps: 523 | Train Loss: 0.5229800 Vali Loss: 0.2829001 Best vali loss: 0.2743596
	iters: 100, epoch: 4 | loss: 0.3464342
	speed: 0.0074s/iter; left time: 18.6588s
	iters: 200, epoch: 4 | loss: 0.9057926
	speed: 0.0030s/iter; left time: 7.2031s
	iters: 300, epoch: 4 | loss: 0.3018829
	speed: 0.0030s/iter; left time: 6.8680s
	iters: 400, epoch: 4 | loss: 0.6552657
	speed: 0.0031s/iter; left time: 6.8310s
	iters: 500, epoch: 4 | loss: 0.4135904
	speed: 0.0030s/iter; left time: 6.3650s
Updating learning rate to 3.600822045e-05
Epoch: 4 cost time: 1.626854658126831
Epoch: 4, Steps: 523 | Train Loss: 0.5245932 Vali Loss: 0.2800930 Best vali loss: 0.2743596
	iters: 100, epoch: 5 | loss: 0.6344773
	speed: 0.0076s/iter; left time: 15.0752s
	iters: 200, epoch: 5 | loss: 0.3768079
	speed: 0.0033s/iter; left time: 6.2292s
	iters: 300, epoch: 5 | loss: 0.3107007
	speed: 0.0033s/iter; left time: 5.9140s
	iters: 400, epoch: 5 | loss: 0.2007348
	speed: 0.0033s/iter; left time: 5.5995s
	iters: 500, epoch: 5 | loss: 0.2780090
	speed: 0.0033s/iter; left time: 5.2661s
Updating learning rate to 2.2228471054835185e-05
Epoch: 5 cost time: 1.777987003326416
Epoch: 5, Steps: 523 | Train Loss: 0.3601459 Vali Loss: 0.2914534 Best vali loss: 0.2743596
	iters: 100, epoch: 6 | loss: 0.3456289
	speed: 0.0075s/iter; left time: 11.0520s
	iters: 200, epoch: 6 | loss: 0.4548274
	speed: 0.0030s/iter; left time: 4.0768s
	iters: 300, epoch: 6 | loss: 0.3311880
	speed: 0.0030s/iter; left time: 3.8557s
	iters: 400, epoch: 6 | loss: 0.7651174
	speed: 0.0030s/iter; left time: 3.5009s
	iters: 500, epoch: 6 | loss: 0.3704559
	speed: 0.0030s/iter; left time: 3.2091s
Updating learning rate to 1.0546563591344887e-05
Epoch: 6 cost time: 1.6165671348571777
Epoch: 6, Steps: 523 | Train Loss: 0.4534435 Vali Loss: 0.2970919 Best vali loss: 0.2743596
	iters: 100, epoch: 7 | loss: 0.2384698
	speed: 0.0076s/iter; left time: 7.1843s
	iters: 200, epoch: 7 | loss: 0.5806988
	speed: 0.0033s/iter; left time: 2.7804s
	iters: 300, epoch: 7 | loss: 0.3172510
	speed: 0.0035s/iter; left time: 2.5969s
	iters: 400, epoch: 7 | loss: 0.2737570
	speed: 0.0036s/iter; left time: 2.3065s
	iters: 500, epoch: 7 | loss: 0.3181046
	speed: 0.0036s/iter; left time: 1.9507s
Updating learning rate to 2.7409625740906453e-06
Epoch: 7 cost time: 1.8567209243774414
Epoch: 7, Steps: 523 | Train Loss: 0.3456562 Vali Loss: 0.2997710 Best vali loss: 0.2743596
	iters: 100, epoch: 8 | loss: 0.6068624
	speed: 0.0081s/iter; left time: 3.4391s
	iters: 200, epoch: 8 | loss: 0.5622784
	speed: 0.0035s/iter; left time: 1.1218s
	iters: 300, epoch: 8 | loss: 0.4164257
	speed: 0.0035s/iter; left time: 0.7784s
	iters: 400, epoch: 8 | loss: 0.3687138
	speed: 0.0034s/iter; left time: 0.4269s
	iters: 500, epoch: 8 | loss: 0.5180370
	speed: 0.0032s/iter; left time: 0.0770s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.83486008644104
Epoch: 8, Steps: 523 | Train Loss: 0.4944635 Vali Loss: 0.2918209 Best vali loss: 0.2743596

best validation loss 0.2743596489897622

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047376179453, 'e_layers': 2, 'learning_rate': 7.20482984e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3487254
	speed: 0.0094s/iter; left time: 38.4973s
	iters: 200, epoch: 1 | loss: 0.3739909
	speed: 0.0035s/iter; left time: 14.0518s
	iters: 300, epoch: 1 | loss: 0.5886820
	speed: 0.0035s/iter; left time: 13.6872s
	iters: 400, epoch: 1 | loss: 0.7602426
	speed: 0.0035s/iter; left time: 13.3524s
	iters: 500, epoch: 1 | loss: 0.3400967
	speed: 0.0035s/iter; left time: 12.8955s
Updating learning rate to 6.930612332201284e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 2.113492012023926
Epoch: 1, Steps: 523 | Train Loss: 0.4823475 Vali Loss: 0.2797815 Best vali loss: 0.2797815
	iters: 100, epoch: 2 | loss: 0.8218666
	speed: 0.0081s/iter; left time: 28.8651s
	iters: 200, epoch: 2 | loss: 0.3903913
	speed: 0.0034s/iter; left time: 11.7327s
	iters: 300, epoch: 2 | loss: 0.7207037
	speed: 0.0034s/iter; left time: 11.5373s
	iters: 400, epoch: 2 | loss: 0.4193915
	speed: 0.0034s/iter; left time: 11.0201s
	iters: 500, epoch: 2 | loss: 0.7149245
	speed: 0.0034s/iter; left time: 10.8342s
Updating learning rate to 6.149706938579593e-05
Validation loss decreased (0.2798 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 1.8374814987182617
Epoch: 2, Steps: 523 | Train Loss: 0.6134555 Vali Loss: 0.2741714 Best vali loss: 0.2741714
	iters: 100, epoch: 3 | loss: 0.4401191
	speed: 0.0081s/iter; left time: 24.4971s
	iters: 200, epoch: 3 | loss: 0.3033426
	speed: 0.0031s/iter; left time: 9.0799s
	iters: 300, epoch: 3 | loss: 0.5799075
	speed: 0.0031s/iter; left time: 8.7477s
	iters: 400, epoch: 3 | loss: 0.7244661
	speed: 0.0031s/iter; left time: 8.4414s
	iters: 500, epoch: 3 | loss: 0.6236851
	speed: 0.0031s/iter; left time: 8.3127s
Updating learning rate to 4.98099942638881e-05
Epoch: 3 cost time: 1.6825523376464844
Epoch: 3, Steps: 523 | Train Loss: 0.5343041 Vali Loss: 0.2827938 Best vali loss: 0.2741714
	iters: 100, epoch: 4 | loss: 0.3501754
	speed: 0.0079s/iter; left time: 19.7648s
	iters: 200, epoch: 4 | loss: 0.9134260
	speed: 0.0033s/iter; left time: 7.9246s
	iters: 300, epoch: 4 | loss: 0.3014965
	speed: 0.0033s/iter; left time: 7.6070s
	iters: 400, epoch: 4 | loss: 0.6576114
	speed: 0.0033s/iter; left time: 7.2678s
	iters: 500, epoch: 4 | loss: 0.4129822
	speed: 0.0033s/iter; left time: 7.0004s
Updating learning rate to 3.60241492e-05
Epoch: 4 cost time: 1.7873485088348389
Epoch: 4, Steps: 523 | Train Loss: 0.5271383 Vali Loss: 0.2824374 Best vali loss: 0.2741714
	iters: 100, epoch: 5 | loss: 0.6375759
	speed: 0.0078s/iter; left time: 15.5965s
	iters: 200, epoch: 5 | loss: 0.3843959
	speed: 0.0034s/iter; left time: 6.5255s
	iters: 300, epoch: 5 | loss: 0.3080058
	speed: 0.0035s/iter; left time: 6.2508s
	iters: 400, epoch: 5 | loss: 0.1946911
	speed: 0.0035s/iter; left time: 5.8853s
	iters: 500, epoch: 5 | loss: 0.2821865
	speed: 0.0035s/iter; left time: 5.5100s
Updating learning rate to 2.2238304136111897e-05
Epoch: 5 cost time: 1.8611984252929688
Epoch: 5, Steps: 523 | Train Loss: 0.3613710 Vali Loss: 0.2920835 Best vali loss: 0.2741714
	iters: 100, epoch: 6 | loss: 0.3467632
	speed: 0.0077s/iter; left time: 11.3054s
	iters: 200, epoch: 6 | loss: 0.4570224
	speed: 0.0031s/iter; left time: 4.1887s
	iters: 300, epoch: 6 | loss: 0.3302363
	speed: 0.0031s/iter; left time: 3.8994s
	iters: 400, epoch: 6 | loss: 0.7736477
	speed: 0.0031s/iter; left time: 3.5936s
	iters: 500, epoch: 6 | loss: 0.3714293
	speed: 0.0031s/iter; left time: 3.2743s
Updating learning rate to 1.055122901420406e-05
Epoch: 6 cost time: 1.6669068336486816
Epoch: 6, Steps: 523 | Train Loss: 0.4558198 Vali Loss: 0.2974948 Best vali loss: 0.2741714
	iters: 100, epoch: 7 | loss: 0.2354216
	speed: 0.0079s/iter; left time: 7.4379s
	iters: 200, epoch: 7 | loss: 0.5868037
	speed: 0.0035s/iter; left time: 2.9603s
	iters: 300, epoch: 7 | loss: 0.3186797
	speed: 0.0035s/iter; left time: 2.6141s
	iters: 400, epoch: 7 | loss: 0.2725706
	speed: 0.0035s/iter; left time: 2.2681s
	iters: 500, epoch: 7 | loss: 0.3187270
	speed: 0.0035s/iter; left time: 1.9126s
Updating learning rate to 2.742175077987156e-06
Epoch: 7 cost time: 1.8765900135040283
Epoch: 7, Steps: 523 | Train Loss: 0.3464405 Vali Loss: 0.2996707 Best vali loss: 0.2741714
	iters: 100, epoch: 8 | loss: 0.6116071
	speed: 0.0079s/iter; left time: 3.3553s
	iters: 200, epoch: 8 | loss: 0.5695911
	speed: 0.0035s/iter; left time: 1.1379s
	iters: 300, epoch: 8 | loss: 0.4176552
	speed: 0.0035s/iter; left time: 0.7873s
	iters: 400, epoch: 8 | loss: 0.3650285
	speed: 0.0035s/iter; left time: 0.4321s
	iters: 500, epoch: 8 | loss: 0.5193340
	speed: 0.0033s/iter; left time: 0.0799s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8608105182647705
Epoch: 8, Steps: 523 | Train Loss: 0.4966432 Vali Loss: 0.2916139 Best vali loss: 0.2741714

best validation loss 0.27417137089793947

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0046850627822, 'e_layers': 2, 'learning_rate': 7.18332557e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3487068
	speed: 0.0088s/iter; left time: 36.0710s
	iters: 200, epoch: 1 | loss: 0.3739658
	speed: 0.0032s/iter; left time: 12.8490s
	iters: 300, epoch: 1 | loss: 0.5885954
	speed: 0.0033s/iter; left time: 12.6870s
	iters: 400, epoch: 1 | loss: 0.7601567
	speed: 0.0033s/iter; left time: 12.4590s
	iters: 500, epoch: 1 | loss: 0.3400357
	speed: 0.0033s/iter; left time: 12.0124s
Updating learning rate to 6.909926519743985e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 1.9941699504852295
Epoch: 1, Steps: 523 | Train Loss: 0.4822921 Vali Loss: 0.2797642 Best vali loss: 0.2797642
	iters: 100, epoch: 2 | loss: 0.8209541
	speed: 0.0082s/iter; left time: 29.2148s
	iters: 200, epoch: 2 | loss: 0.3923031
	speed: 0.0032s/iter; left time: 11.2115s
	iters: 300, epoch: 2 | loss: 0.7213635
	speed: 0.0032s/iter; left time: 10.9108s
	iters: 400, epoch: 2 | loss: 0.4209127
	speed: 0.0032s/iter; left time: 10.5831s
	iters: 500, epoch: 2 | loss: 0.7183584
	speed: 0.0033s/iter; left time: 10.2990s
Updating learning rate to 6.131351896008861e-05
Validation loss decreased (0.2798 --> 0.2744).  Saving model state dict ...
Epoch: 2 cost time: 1.7652082443237305
Epoch: 2, Steps: 523 | Train Loss: 0.6147784 Vali Loss: 0.2744202 Best vali loss: 0.2744202
	iters: 100, epoch: 3 | loss: 0.4400437
	speed: 0.0084s/iter; left time: 25.6724s
	iters: 200, epoch: 3 | loss: 0.3034110
	speed: 0.0035s/iter; left time: 10.3543s
	iters: 300, epoch: 3 | loss: 0.5761965
	speed: 0.0035s/iter; left time: 9.8745s
	iters: 400, epoch: 3 | loss: 0.7332867
	speed: 0.0035s/iter; left time: 9.5542s
	iters: 500, epoch: 3 | loss: 0.5827979
	speed: 0.0035s/iter; left time: 9.1928s
Updating learning rate to 4.966132627461757e-05
Epoch: 3 cost time: 1.8910975456237793
Epoch: 3, Steps: 523 | Train Loss: 0.5271472 Vali Loss: 0.2798697 Best vali loss: 0.2744202

best validation loss 0.274420154043714

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084863638263, 'e_layers': 2, 'learning_rate': 7.15905159e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.15905159e-05
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 0.6857585906982422
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2802232 Best vali loss: 0.2802232
Updating learning rate to 3.579525795e-05
Validation loss decreased (0.2802 --> 0.2774).  Saving model state dict ...
Epoch: 2 cost time: 0.44974398612976074
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2773617 Best vali loss: 0.2773617
Updating learning rate to 1.7897628975e-05
Validation loss decreased (0.2774 --> 0.2772).  Saving model state dict ...
Epoch: 3 cost time: 0.447782039642334
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2772172 Best vali loss: 0.2772172

best validation loss 0.2772172405434701

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022668094658243945
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 0.6133427619934082
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2839541 Best vali loss: 0.2839541
Updating learning rate to 0.0020113971511072134
Epoch: 2 cost time: 0.3814675807952881
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2857713 Best vali loss: 0.2839541
Updating learning rate to 0.0016291456090457483
Epoch: 3 cost time: 0.34993839263916016
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2945118 Best vali loss: 0.2839541

best validation loss 0.28395405915999067

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0046850627822, 'e_layers': 2, 'learning_rate': 7.18332557e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2585965
	speed: 0.0091s/iter; left time: 22.9178s
	iters: 200, epoch: 4 | loss: 0.3250494
	speed: 0.0035s/iter; left time: 8.3932s
	iters: 300, epoch: 4 | loss: 0.5651910
	speed: 0.0035s/iter; left time: 8.0593s
	iters: 400, epoch: 4 | loss: 0.5774490
	speed: 0.0034s/iter; left time: 7.5643s
	iters: 500, epoch: 4 | loss: 0.2566952
	speed: 0.0034s/iter; left time: 7.1115s
Updating learning rate to 3.591662785e-05
Epoch: 4 cost time: 2.0692312717437744
Epoch: 4, Steps: 523 | Train Loss: 0.3965962 Vali Loss: 0.2901060 Best vali loss: 0.2744202
	iters: 100, epoch: 5 | loss: 0.5711666
	speed: 0.0073s/iter; left time: 14.5031s
	iters: 200, epoch: 5 | loss: 0.3663688
	speed: 0.0031s/iter; left time: 5.8494s
	iters: 300, epoch: 5 | loss: 0.5039061
	speed: 0.0030s/iter; left time: 5.4627s
	iters: 400, epoch: 5 | loss: 0.3906370
	speed: 0.0030s/iter; left time: 5.1558s
	iters: 500, epoch: 5 | loss: 0.6049756
	speed: 0.0031s/iter; left time: 4.9159s
Updating learning rate to 2.2171929425382426e-05
Epoch: 5 cost time: 1.6377849578857422
Epoch: 5, Steps: 523 | Train Loss: 0.4874108 Vali Loss: 0.2868394 Best vali loss: 0.2744202
	iters: 100, epoch: 6 | loss: 0.4260829
	speed: 0.0072s/iter; left time: 10.5423s
	iters: 200, epoch: 6 | loss: 0.2969760
	speed: 0.0030s/iter; left time: 4.1425s
	iters: 300, epoch: 6 | loss: 0.4468502
	speed: 0.0031s/iter; left time: 3.9174s
	iters: 400, epoch: 6 | loss: 0.5727144
	speed: 0.0031s/iter; left time: 3.6571s
	iters: 500, epoch: 6 | loss: 0.4556369
	speed: 0.0034s/iter; left time: 3.6572s
Updating learning rate to 1.0519736739911393e-05
Epoch: 6 cost time: 1.6932473182678223
Epoch: 6, Steps: 523 | Train Loss: 0.4396520 Vali Loss: 0.2903611 Best vali loss: 0.2744202
	iters: 100, epoch: 7 | loss: 0.3290493
	speed: 0.0077s/iter; left time: 7.2761s
	iters: 200, epoch: 7 | loss: 0.7478248
	speed: 0.0035s/iter; left time: 2.9694s
	iters: 300, epoch: 7 | loss: 0.2922635
	speed: 0.0035s/iter; left time: 2.6236s
	iters: 400, epoch: 7 | loss: 0.5074125
	speed: 0.0035s/iter; left time: 2.2665s
	iters: 500, epoch: 7 | loss: 0.3916559
	speed: 0.0035s/iter; left time: 1.9081s
Updating learning rate to 2.733990502560138e-06
Epoch: 7 cost time: 1.8697195053100586
Epoch: 7, Steps: 523 | Train Loss: 0.4536412 Vali Loss: 0.2873905 Best vali loss: 0.2744202
	iters: 100, epoch: 8 | loss: 0.5774838
	speed: 0.0075s/iter; left time: 3.1992s
	iters: 200, epoch: 8 | loss: 0.3155249
	speed: 0.0033s/iter; left time: 1.0703s
	iters: 300, epoch: 8 | loss: 0.2743523
	speed: 0.0033s/iter; left time: 0.7487s
	iters: 400, epoch: 8 | loss: 0.1853887
	speed: 0.0033s/iter; left time: 0.4102s
	iters: 500, epoch: 8 | loss: 0.2587785
	speed: 0.0033s/iter; left time: 0.0782s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7641665935516357
Epoch: 8, Steps: 523 | Train Loss: 0.3223056 Vali Loss: 0.2916933 Best vali loss: 0.2744202

best validation loss 0.274420154043714

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084654704805, 'e_layers': 2, 'learning_rate': 6.60912639e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.60912639e-05
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 0.6706893444061279
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2811708 Best vali loss: 0.2811708
Updating learning rate to 3.304563195e-05
Validation loss decreased (0.2812 --> 0.2777).  Saving model state dict ...
Epoch: 2 cost time: 0.43407559394836426
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2777161 Best vali loss: 0.2777161
Updating learning rate to 1.6522815975e-05
Validation loss decreased (0.2777 --> 0.2775).  Saving model state dict ...
Epoch: 3 cost time: 0.4347853660583496
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2774571 Best vali loss: 0.2774571
Updating learning rate to 8.2614079875e-06
Epoch: 4 cost time: 0.43688297271728516
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2775042 Best vali loss: 0.2774571
Updating learning rate to 4.13070399375e-06
Validation loss decreased (0.2775 --> 0.2773).  Saving model state dict ...
Epoch: 5 cost time: 0.43040013313293457
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2772663 Best vali loss: 0.2772663
Updating learning rate to 2.065351996875e-06
Epoch: 6 cost time: 0.4409191608428955
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2772989 Best vali loss: 0.2772663
Updating learning rate to 1.0326759984375e-06
Epoch: 7 cost time: 0.43053150177001953
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2774316 Best vali loss: 0.2772663
Updating learning rate to 5.1633799921875e-07
Epoch: 8 cost time: 0.4369654655456543
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2774014 Best vali loss: 0.2772663

best validation loss 0.2772663437763791

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084216205378, 'e_layers': 2, 'learning_rate': 0.0002291130475, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002291130475
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 0.7405037879943848
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791631 Best vali loss: 0.2791631
Updating learning rate to 0.00011455652375
Validation loss decreased (0.2792 --> 0.2745).  Saving model state dict ...
Epoch: 2 cost time: 0.5183229446411133
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2745299 Best vali loss: 0.2745299
Updating learning rate to 5.7278261875e-05
Validation loss decreased (0.2745 --> 0.2714).  Saving model state dict ...
Epoch: 3 cost time: 0.5244824886322021
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2714058 Best vali loss: 0.2714058
Updating learning rate to 2.86391309375e-05
Epoch: 4 cost time: 0.5172719955444336
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2827889 Best vali loss: 0.2714058
Updating learning rate to 1.431956546875e-05
Epoch: 5 cost time: 0.5186529159545898
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2817176 Best vali loss: 0.2714058
Updating learning rate to 7.159782734375e-06
Epoch: 6 cost time: 0.5184996128082275
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2857727 Best vali loss: 0.2714058
Updating learning rate to 3.5798913671875e-06
Epoch: 7 cost time: 0.5226960182189941
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2906572 Best vali loss: 0.2714058
Updating learning rate to 1.78994568359375e-06
Epoch: 8 cost time: 0.5223944187164307
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2867422 Best vali loss: 0.2714058

best validation loss 0.2714058387263994

[INFO][abstract_intensifier.py:595] Added config 4c441f and rejected config 639238 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084881196677, 'e_layers': 2, 'learning_rate': 0.0002292416941, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002292416941
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 0.744739294052124
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791674 Best vali loss: 0.2791674
Updating learning rate to 0.00011462084705
Validation loss decreased (0.2792 --> 0.2743).  Saving model state dict ...
Epoch: 2 cost time: 0.5271158218383789
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2743406 Best vali loss: 0.2743406
Updating learning rate to 5.7310423525e-05
Validation loss decreased (0.2743 --> 0.2718).  Saving model state dict ...
Epoch: 3 cost time: 0.5238010883331299
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2717797 Best vali loss: 0.2717797

best validation loss 0.2717796550691682

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0047213068989, 'e_layers': 2, 'learning_rate': 7.20887714e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5941392
	speed: 0.0105s/iter; left time: 9.9537s
Updating learning rate to 6.934505591017251e-05
Validation loss decreased (inf --> 0.2769).  Saving model state dict ...
Epoch: 1 cost time: 0.9503121376037598
Epoch: 1, Steps: 131 | Train Loss: 0.5941392 Vali Loss: 0.2768744 Best vali loss: 0.2768744
	iters: 100, epoch: 2 | loss: 0.4942514
	speed: 0.0091s/iter; left time: 7.4694s
Updating learning rate to 6.153161525217342e-05
Validation loss decreased (0.2769 --> 0.2762).  Saving model state dict ...
Epoch: 2 cost time: 0.7265341281890869
Epoch: 2, Steps: 131 | Train Loss: 0.4942514 Vali Loss: 0.2762023 Best vali loss: 0.2762023
	iters: 100, epoch: 3 | loss: 0.5559850
	speed: 0.0091s/iter; left time: 6.2342s
Updating learning rate to 4.9837974937167155e-05
Validation loss decreased (0.2762 --> 0.2751).  Saving model state dict ...
Epoch: 3 cost time: 0.7113399505615234
Epoch: 3, Steps: 131 | Train Loss: 0.5559850 Vali Loss: 0.2750838 Best vali loss: 0.2750838

best validation loss 0.2750837806211878

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0083487011909, 'e_layers': 1, 'learning_rate': 0.0001054476246, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001054476246
Validation loss decreased (inf --> 0.2807).  Saving model state dict ...
Epoch: 1 cost time: 0.539536714553833
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2807291 Best vali loss: 0.2807291
Updating learning rate to 5.27238123e-05
Validation loss decreased (0.2807 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 0.32427144050598145
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2771875 Best vali loss: 0.2771875
Updating learning rate to 2.636190615e-05
Validation loss decreased (0.2772 --> 0.2761).  Saving model state dict ...
Epoch: 3 cost time: 0.33054327964782715
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2760640 Best vali loss: 0.2760640

best validation loss 0.2760640234752586

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084881196677, 'e_layers': 2, 'learning_rate': 0.0002292416941, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.86552117625e-05
Epoch: 4 cost time: 0.7357380390167236
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2834928 Best vali loss: 0.2717797
Updating learning rate to 1.432760588125e-05
Epoch: 5 cost time: 0.5207014083862305
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2826490 Best vali loss: 0.2717797
Updating learning rate to 7.163802940625e-06
Epoch: 6 cost time: 0.5258164405822754
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2830895 Best vali loss: 0.2717797
Updating learning rate to 3.5819014703125e-06
Epoch: 7 cost time: 0.5158672332763672
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2859726 Best vali loss: 0.2717797
Updating learning rate to 1.79095073515625e-06
Epoch: 8 cost time: 0.5199906826019287
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2885513 Best vali loss: 0.2717797

best validation loss 0.2717796550691682

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010229320995, 'e_layers': 2, 'learning_rate': 0.0002364220382, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5599580
	speed: 0.0103s/iter; left time: 9.7540s
Updating learning rate to 0.00022742376016379078
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9242243766784668
Epoch: 1, Steps: 131 | Train Loss: 0.5599580 Vali Loss: 0.2756698 Best vali loss: 0.2756698
	iters: 100, epoch: 2 | loss: 0.3258401
	speed: 0.0088s/iter; left time: 7.2382s
Updating learning rate to 0.00020179883231658248
Validation loss decreased (0.2757 --> 0.2710).  Saving model state dict ...
Epoch: 2 cost time: 0.7046124935150146
Epoch: 2, Steps: 131 | Train Loss: 0.3258401 Vali Loss: 0.2710440 Best vali loss: 0.2710440
	iters: 100, epoch: 3 | loss: 0.4661455
	speed: 0.0092s/iter; left time: 6.3036s
Updating learning rate to 0.00016344841763256317
Epoch: 3 cost time: 0.7064523696899414
Epoch: 3, Steps: 131 | Train Loss: 0.4661455 Vali Loss: 0.2784461 Best vali loss: 0.2710440
	iters: 100, epoch: 4 | loss: 0.4875439
	speed: 0.0087s/iter; left time: 4.8507s
Updating learning rate to 0.0001182110191
Epoch: 4 cost time: 0.7050251960754395
Epoch: 4, Steps: 131 | Train Loss: 0.4875439 Vali Loss: 0.2799331 Best vali loss: 0.2710440
	iters: 100, epoch: 5 | loss: 0.3373562
	speed: 0.0087s/iter; left time: 3.6926s
Updating learning rate to 7.297362056743681e-05
Epoch: 5 cost time: 0.7043814659118652
Epoch: 5, Steps: 131 | Train Loss: 0.3373562 Vali Loss: 0.2878436 Best vali loss: 0.2710440
	iters: 100, epoch: 6 | loss: 0.3092697
	speed: 0.0087s/iter; left time: 2.5667s
Updating learning rate to 3.4623205883417516e-05
Epoch: 6 cost time: 0.7046999931335449
Epoch: 6, Steps: 131 | Train Loss: 0.3092697 Vali Loss: 0.2951256 Best vali loss: 0.2710440
	iters: 100, epoch: 7 | loss: 0.2830035
	speed: 0.0087s/iter; left time: 1.4168s
Updating learning rate to 8.998278036209211e-06
Epoch: 7 cost time: 0.7083337306976318
Epoch: 7, Steps: 131 | Train Loss: 0.2830035 Vali Loss: 0.2992118 Best vali loss: 0.2710440
	iters: 100, epoch: 8 | loss: 0.3442721
	speed: 0.0087s/iter; left time: 0.2791s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7027299404144287
Epoch: 8, Steps: 131 | Train Loss: 0.3442721 Vali Loss: 0.2990946 Best vali loss: 0.2710440

best validation loss 0.27104400358221353

[INFO][abstract_intensifier.py:595] Added config a5362b and rejected config 4c441f as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0045190766167, 'e_layers': 2, 'learning_rate': 0.0002272844996, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4550043
	speed: 0.0087s/iter; left time: 71.7304s
	iters: 200, epoch: 1 | loss: 0.1921383
	speed: 0.0034s/iter; left time: 27.6423s
	iters: 300, epoch: 1 | loss: 0.2661858
	speed: 0.0033s/iter; left time: 26.9990s
	iters: 400, epoch: 1 | loss: 0.2883540
	speed: 0.0034s/iter; left time: 26.6933s
	iters: 500, epoch: 1 | loss: 0.6669042
	speed: 0.0033s/iter; left time: 26.1814s
	iters: 600, epoch: 1 | loss: 0.2895773
	speed: 0.0033s/iter; left time: 25.9345s
	iters: 700, epoch: 1 | loss: 0.4194139
	speed: 0.0034s/iter; left time: 25.9555s
	iters: 800, epoch: 1 | loss: 0.2709460
	speed: 0.0033s/iter; left time: 25.1991s
	iters: 900, epoch: 1 | loss: 0.3056956
	speed: 0.0034s/iter; left time: 25.6976s
	iters: 1000, epoch: 1 | loss: 0.3834159
	speed: 0.0034s/iter; left time: 25.2791s
Updating learning rate to 0.00021863399841875488
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 3.7939600944519043
Epoch: 1, Steps: 1045 | Train Loss: 0.3537635 Vali Loss: 0.2854745 Best vali loss: 0.2854745
	iters: 100, epoch: 2 | loss: 0.2996235
	speed: 0.0108s/iter; left time: 77.8048s
	iters: 200, epoch: 2 | loss: 1.1090928
	speed: 0.0034s/iter; left time: 24.2579s
	iters: 300, epoch: 2 | loss: 0.4512988
	speed: 0.0031s/iter; left time: 21.9635s
	iters: 400, epoch: 2 | loss: 1.4687227
	speed: 0.0030s/iter; left time: 20.6213s
	iters: 500, epoch: 2 | loss: 1.0057975
	speed: 0.0030s/iter; left time: 20.3795s
	iters: 600, epoch: 2 | loss: 0.3141080
	speed: 0.0030s/iter; left time: 20.0043s
	iters: 700, epoch: 2 | loss: 0.7049788
	speed: 0.0030s/iter; left time: 19.7844s
	iters: 800, epoch: 2 | loss: 0.2675909
	speed: 0.0030s/iter; left time: 19.5941s
	iters: 900, epoch: 2 | loss: 0.3495494
	speed: 0.0031s/iter; left time: 20.1960s
	iters: 1000, epoch: 2 | loss: 0.2532814
	speed: 0.0031s/iter; left time: 19.6549s
Updating learning rate to 0.00019399945526287556
Epoch: 2 cost time: 3.286832571029663
Epoch: 2, Steps: 1045 | Train Loss: 0.6224044 Vali Loss: 0.2895026 Best vali loss: 0.2854745
	iters: 100, epoch: 3 | loss: 0.2039671
	speed: 0.0097s/iter; left time: 60.0992s
	iters: 200, epoch: 3 | loss: 0.4919900
	speed: 0.0031s/iter; left time: 18.9120s
	iters: 300, epoch: 3 | loss: 0.8803365
	speed: 0.0031s/iter; left time: 18.5948s
	iters: 400, epoch: 3 | loss: 0.4479489
	speed: 0.0031s/iter; left time: 18.4057s
	iters: 500, epoch: 3 | loss: 0.3170188
	speed: 0.0032s/iter; left time: 18.2042s
	iters: 600, epoch: 3 | loss: 0.1606134
	speed: 0.0034s/iter; left time: 19.4287s
	iters: 700, epoch: 3 | loss: 0.4732656
	speed: 0.0034s/iter; left time: 18.9762s
	iters: 800, epoch: 3 | loss: 0.5855482
	speed: 0.0034s/iter; left time: 18.6209s
	iters: 900, epoch: 3 | loss: 0.1687976
	speed: 0.0034s/iter; left time: 18.4170s
	iters: 1000, epoch: 3 | loss: 0.3902780
	speed: 0.0034s/iter; left time: 17.9459s
Updating learning rate to 0.00015713125601515495
Epoch: 3 cost time: 3.4594240188598633
Epoch: 3, Steps: 1045 | Train Loss: 0.4119764 Vali Loss: 0.2868861 Best vali loss: 0.2854745
	iters: 100, epoch: 4 | loss: 0.5473423
	speed: 0.0102s/iter; left time: 52.4268s
	iters: 200, epoch: 4 | loss: 0.9790936
	speed: 0.0034s/iter; left time: 16.8436s
	iters: 300, epoch: 4 | loss: 0.3596350
	speed: 0.0034s/iter; left time: 16.6600s
	iters: 400, epoch: 4 | loss: 0.2993199
	speed: 0.0034s/iter; left time: 16.3697s
	iters: 500, epoch: 4 | loss: 0.7686138
	speed: 0.0034s/iter; left time: 16.2754s
	iters: 600, epoch: 4 | loss: 0.9000797
	speed: 0.0034s/iter; left time: 15.6177s
	iters: 700, epoch: 4 | loss: 0.5981955
	speed: 0.0034s/iter; left time: 15.2118s
	iters: 800, epoch: 4 | loss: 0.3440405
	speed: 0.0033s/iter; left time: 14.7892s
	iters: 900, epoch: 4 | loss: 0.2217827
	speed: 0.0033s/iter; left time: 14.4081s
	iters: 1000, epoch: 4 | loss: 0.2971318
	speed: 0.0034s/iter; left time: 14.3041s
Updating learning rate to 0.0001136422498
Epoch: 4 cost time: 3.557490587234497
Epoch: 4, Steps: 1045 | Train Loss: 0.5315235 Vali Loss: 0.2867012 Best vali loss: 0.2854745
	iters: 100, epoch: 5 | loss: 0.1505273
	speed: 0.0098s/iter; left time: 40.0058s
	iters: 200, epoch: 5 | loss: 0.1899950
	speed: 0.0031s/iter; left time: 12.3784s
	iters: 300, epoch: 5 | loss: 0.2146288
	speed: 0.0029s/iter; left time: 11.1646s
	iters: 400, epoch: 5 | loss: 0.3853722
	speed: 0.0028s/iter; left time: 10.6824s
	iters: 500, epoch: 5 | loss: 0.2379413
	speed: 0.0028s/iter; left time: 10.4277s
	iters: 600, epoch: 5 | loss: 0.4309553
	speed: 0.0028s/iter; left time: 10.1301s
	iters: 700, epoch: 5 | loss: 0.2354458
	speed: 0.0028s/iter; left time: 9.8193s
	iters: 800, epoch: 5 | loss: 0.3816376
	speed: 0.0028s/iter; left time: 9.5987s
	iters: 900, epoch: 5 | loss: 0.1078844
	speed: 0.0028s/iter; left time: 9.3218s
	iters: 1000, epoch: 5 | loss: 0.7342822
	speed: 0.0028s/iter; left time: 8.9851s
Updating learning rate to 7.015324358484507e-05
Epoch: 5 cost time: 3.0513768196105957
Epoch: 5, Steps: 1045 | Train Loss: 0.3068670 Vali Loss: 0.2918747 Best vali loss: 0.2854745
	iters: 100, epoch: 6 | loss: 0.7991329
	speed: 0.0101s/iter; left time: 30.6654s
	iters: 200, epoch: 6 | loss: 0.4747247
	speed: 0.0034s/iter; left time: 9.8732s
	iters: 300, epoch: 6 | loss: 0.8111425
	speed: 0.0034s/iter; left time: 9.5127s
	iters: 400, epoch: 6 | loss: 0.3217291
	speed: 0.0034s/iter; left time: 9.1676s
	iters: 500, epoch: 6 | loss: 0.2391051
	speed: 0.0033s/iter; left time: 8.7897s
	iters: 600, epoch: 6 | loss: 0.5493729
	speed: 0.0034s/iter; left time: 8.5228s
	iters: 700, epoch: 6 | loss: 0.7489985
	speed: 0.0034s/iter; left time: 8.1678s
	iters: 800, epoch: 6 | loss: 0.3016835
	speed: 0.0033s/iter; left time: 7.8177s
	iters: 900, epoch: 6 | loss: 0.2827210
	speed: 0.0034s/iter; left time: 7.4923s
	iters: 1000, epoch: 6 | loss: 0.1866890
	speed: 0.0033s/iter; left time: 7.1011s
Updating learning rate to 3.328504433712443e-05
Epoch: 6 cost time: 3.5389726161956787
Epoch: 6, Steps: 1045 | Train Loss: 0.4715299 Vali Loss: 0.3025477 Best vali loss: 0.2854745
	iters: 100, epoch: 7 | loss: 0.1871881
	speed: 0.0098s/iter; left time: 19.4945s
	iters: 200, epoch: 7 | loss: 0.2775826
	speed: 0.0029s/iter; left time: 5.4112s
	iters: 300, epoch: 7 | loss: 0.1103524
	speed: 0.0029s/iter; left time: 5.1770s
	iters: 400, epoch: 7 | loss: 0.1838107
	speed: 0.0029s/iter; left time: 4.8494s
	iters: 500, epoch: 7 | loss: 0.3006159
	speed: 0.0029s/iter; left time: 4.5522s
	iters: 600, epoch: 7 | loss: 1.0386405
	speed: 0.0029s/iter; left time: 4.2836s
	iters: 700, epoch: 7 | loss: 0.2322852
	speed: 0.0029s/iter; left time: 3.9670s
	iters: 800, epoch: 7 | loss: 0.3615296
	speed: 0.0028s/iter; left time: 3.6315s
	iters: 900, epoch: 7 | loss: 0.1650549
	speed: 0.0030s/iter; left time: 3.6251s
	iters: 1000, epoch: 7 | loss: 0.3294863
	speed: 0.0031s/iter; left time: 3.4197s
Updating learning rate to 8.650501181245131e-06
Epoch: 7 cost time: 3.086362361907959
Epoch: 7, Steps: 1045 | Train Loss: 0.3186546 Vali Loss: 0.3063501 Best vali loss: 0.2854745
	iters: 100, epoch: 8 | loss: 0.1385483
	speed: 0.0100s/iter; left time: 9.4406s
	iters: 200, epoch: 8 | loss: 0.2060681
	speed: 0.0029s/iter; left time: 2.4579s
	iters: 300, epoch: 8 | loss: 0.1478485
	speed: 0.0029s/iter; left time: 2.1750s
	iters: 400, epoch: 8 | loss: 0.1938737
	speed: 0.0029s/iter; left time: 1.8843s
	iters: 500, epoch: 8 | loss: 0.1589592
	speed: 0.0029s/iter; left time: 1.5933s
	iters: 600, epoch: 8 | loss: 0.5635565
	speed: 0.0029s/iter; left time: 1.2950s
	iters: 700, epoch: 8 | loss: 0.8072891
	speed: 0.0029s/iter; left time: 1.0169s
	iters: 800, epoch: 8 | loss: 0.4349024
	speed: 0.0029s/iter; left time: 0.7229s
	iters: 900, epoch: 8 | loss: 0.3379690
	speed: 0.0029s/iter; left time: 0.4193s
	iters: 1000, epoch: 8 | loss: 0.1456026
	speed: 0.0030s/iter; left time: 0.1396s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.106534719467163
Epoch: 8, Steps: 1045 | Train Loss: 0.3134617 Vali Loss: 0.3143945 Best vali loss: 0.2854745

best validation loss 0.28547449243715944

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047766558062, 'e_layers': 2, 'learning_rate': 0.0002291130475, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7871152
	speed: 0.0085s/iter; left time: 70.0392s
	iters: 200, epoch: 1 | loss: 0.7776209
	speed: 0.0034s/iter; left time: 27.5407s
	iters: 300, epoch: 1 | loss: 1.1730651
	speed: 0.0033s/iter; left time: 26.8740s
	iters: 400, epoch: 1 | loss: 0.2835490
	speed: 0.0033s/iter; left time: 26.5383s
	iters: 500, epoch: 1 | loss: 0.2963075
	speed: 0.0033s/iter; left time: 26.2354s
	iters: 600, epoch: 1 | loss: 0.1847547
	speed: 0.0033s/iter; left time: 25.9109s
	iters: 700, epoch: 1 | loss: 0.4545575
	speed: 0.0033s/iter; left time: 25.5600s
	iters: 800, epoch: 1 | loss: 0.2357378
	speed: 0.0034s/iter; left time: 25.5007s
	iters: 900, epoch: 1 | loss: 0.4528543
	speed: 0.0034s/iter; left time: 25.3948s
	iters: 1000, epoch: 1 | loss: 0.2819176
	speed: 0.0034s/iter; left time: 25.1768s
Updating learning rate to 0.00022039295135826812
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 3.771286725997925
Epoch: 1, Steps: 1045 | Train Loss: 0.4927480 Vali Loss: 0.2877282 Best vali loss: 0.2877282
	iters: 100, epoch: 2 | loss: 1.2171293
	speed: 0.0104s/iter; left time: 75.1693s
	iters: 200, epoch: 2 | loss: 1.0442015
	speed: 0.0033s/iter; left time: 23.6981s
	iters: 300, epoch: 2 | loss: 0.1494783
	speed: 0.0033s/iter; left time: 23.4002s
	iters: 400, epoch: 2 | loss: 0.2823246
	speed: 0.0033s/iter; left time: 22.9240s
	iters: 500, epoch: 2 | loss: 0.6952743
	speed: 0.0033s/iter; left time: 22.7411s
	iters: 600, epoch: 2 | loss: 0.3678102
	speed: 0.0033s/iter; left time: 22.4153s
	iters: 700, epoch: 2 | loss: 0.3507156
	speed: 0.0033s/iter; left time: 21.9770s
	iters: 800, epoch: 2 | loss: 0.5114392
	speed: 0.0030s/iter; left time: 19.5846s
	iters: 900, epoch: 2 | loss: 0.1249354
	speed: 0.0030s/iter; left time: 19.0926s
	iters: 1000, epoch: 2 | loss: 1.6885238
	speed: 0.0029s/iter; left time: 18.2387s
Updating learning rate to 0.00019556021852278277
Epoch: 2 cost time: 3.404083490371704
Epoch: 2, Steps: 1045 | Train Loss: 0.6431832 Vali Loss: 0.2986625 Best vali loss: 0.2877282
	iters: 100, epoch: 3 | loss: 0.4785148
	speed: 0.0096s/iter; left time: 59.4707s
	iters: 200, epoch: 3 | loss: 1.1947631
	speed: 0.0029s/iter; left time: 17.8903s
	iters: 300, epoch: 3 | loss: 0.3693464
	speed: 0.0030s/iter; left time: 17.7303s
	iters: 400, epoch: 3 | loss: 1.3824077
	speed: 0.0031s/iter; left time: 18.4360s
	iters: 500, epoch: 3 | loss: 0.4832717
	speed: 0.0032s/iter; left time: 18.1828s
	iters: 600, epoch: 3 | loss: 0.3043636
	speed: 0.0032s/iter; left time: 17.8905s
	iters: 700, epoch: 3 | loss: 0.3024505
	speed: 0.0031s/iter; left time: 17.5246s
	iters: 800, epoch: 3 | loss: 0.2808689
	speed: 0.0032s/iter; left time: 17.2558s
	iters: 900, epoch: 3 | loss: 0.7216212
	speed: 0.0032s/iter; left time: 17.0010s
	iters: 1000, epoch: 3 | loss: 0.5761271
	speed: 0.0031s/iter; left time: 16.5211s
Updating learning rate to 0.00015839540745846294
Validation loss decreased (0.2877 --> 0.2833).  Saving model state dict ...
Epoch: 3 cost time: 3.2702369689941406
Epoch: 3, Steps: 1045 | Train Loss: 0.6093735 Vali Loss: 0.2832840 Best vali loss: 0.2832840

best validation loss 0.2832840047070155

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008267342166, 'e_layers': 4, 'learning_rate': 5.54518777e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7044293
	speed: 0.0107s/iter; left time: 10.1581s
Updating learning rate to 5.3341366273174527e-05
Validation loss decreased (inf --> 0.3399).  Saving model state dict ...
Epoch: 1 cost time: 0.9868545532226562
Epoch: 1, Steps: 131 | Train Loss: 0.7044293 Vali Loss: 0.3398683 Best vali loss: 0.3398683
	iters: 100, epoch: 2 | loss: 0.7061315
	speed: 0.0089s/iter; left time: 7.2711s
Updating learning rate to 4.733113822559855e-05
Validation loss decreased (0.3399 --> 0.3260).  Saving model state dict ...
Epoch: 2 cost time: 0.7025690078735352
Epoch: 2, Steps: 131 | Train Loss: 0.7061315 Vali Loss: 0.3259867 Best vali loss: 0.3259867
	iters: 100, epoch: 3 | loss: 0.5053038
	speed: 0.0088s/iter; left time: 6.0200s
Updating learning rate to 3.833619629466259e-05
Validation loss decreased (0.3260 --> 0.3170).  Saving model state dict ...
Epoch: 3 cost time: 0.729877233505249
Epoch: 3, Steps: 131 | Train Loss: 0.5053038 Vali Loss: 0.3169948 Best vali loss: 0.3169948

best validation loss 0.3169947526254544

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0045095109113, 'e_layers': 2, 'learning_rate': 0.0002290527556, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7872720
	speed: 0.0083s/iter; left time: 68.4534s
	iters: 200, epoch: 1 | loss: 0.7772841
	speed: 0.0031s/iter; left time: 25.4595s
	iters: 300, epoch: 1 | loss: 1.1649617
	speed: 0.0031s/iter; left time: 25.0891s
	iters: 400, epoch: 1 | loss: 0.2841789
	speed: 0.0031s/iter; left time: 24.8324s
	iters: 500, epoch: 1 | loss: 0.2965818
	speed: 0.0032s/iter; left time: 24.9674s
	iters: 600, epoch: 1 | loss: 0.1721342
	speed: 0.0029s/iter; left time: 22.8949s
	iters: 700, epoch: 1 | loss: 0.4566148
	speed: 0.0031s/iter; left time: 23.5281s
	iters: 800, epoch: 1 | loss: 0.2311366
	speed: 0.0029s/iter; left time: 22.0490s
	iters: 900, epoch: 1 | loss: 0.5071416
	speed: 0.0030s/iter; left time: 22.0705s
	iters: 1000, epoch: 1 | loss: 0.2981496
	speed: 0.0030s/iter; left time: 21.8572s
Updating learning rate to 0.00022033495418207502
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 3.4543747901916504
Epoch: 1, Steps: 1045 | Train Loss: 0.4975455 Vali Loss: 0.2877809 Best vali loss: 0.2877809
	iters: 100, epoch: 2 | loss: 1.2235606
	speed: 0.0104s/iter; left time: 75.2492s
	iters: 200, epoch: 2 | loss: 1.0739419
	speed: 0.0035s/iter; left time: 24.8822s
	iters: 300, epoch: 2 | loss: 0.1552947
	speed: 0.0035s/iter; left time: 24.4398s
	iters: 400, epoch: 2 | loss: 0.2892013
	speed: 0.0034s/iter; left time: 23.8473s
	iters: 500, epoch: 2 | loss: 0.6772894
	speed: 0.0034s/iter; left time: 23.2061s
	iters: 600, epoch: 2 | loss: 0.3825817
	speed: 0.0033s/iter; left time: 22.4688s
	iters: 700, epoch: 2 | loss: 0.3312978
	speed: 0.0034s/iter; left time: 22.3722s
	iters: 800, epoch: 2 | loss: 0.5051260
	speed: 0.0034s/iter; left time: 21.9092s
	iters: 900, epoch: 2 | loss: 0.1294455
	speed: 0.0033s/iter; left time: 21.4891s
	iters: 1000, epoch: 2 | loss: 1.3824780
	speed: 0.0033s/iter; left time: 20.9852s
Updating learning rate to 0.00019550875616711249
Validation loss decreased (0.2878 --> 0.2866).  Saving model state dict ...
Epoch: 2 cost time: 3.5931594371795654
Epoch: 2, Steps: 1045 | Train Loss: 0.6150217 Vali Loss: 0.2866203 Best vali loss: 0.2866203
	iters: 100, epoch: 3 | loss: 0.4519973
	speed: 0.0101s/iter; left time: 62.2976s
	iters: 200, epoch: 3 | loss: 1.2034398
	speed: 0.0030s/iter; left time: 18.2367s
	iters: 300, epoch: 3 | loss: 0.3426464
	speed: 0.0030s/iter; left time: 17.6536s
	iters: 400, epoch: 3 | loss: 1.0623426
	speed: 0.0030s/iter; left time: 17.6665s
	iters: 500, epoch: 3 | loss: 0.4890851
	speed: 0.0031s/iter; left time: 17.9091s
	iters: 600, epoch: 3 | loss: 0.2959619
	speed: 0.0031s/iter; left time: 17.4648s
	iters: 700, epoch: 3 | loss: 0.2343847
	speed: 0.0031s/iter; left time: 17.0549s
	iters: 800, epoch: 3 | loss: 0.2936656
	speed: 0.0031s/iter; left time: 16.9019s
	iters: 900, epoch: 3 | loss: 0.6472946
	speed: 0.0029s/iter; left time: 15.6115s
	iters: 1000, epoch: 3 | loss: 0.6040566
	speed: 0.0031s/iter; left time: 16.1873s
Updating learning rate to 0.00015835372515284505
Validation loss decreased (0.2866 --> 0.2824).  Saving model state dict ...
Epoch: 3 cost time: 3.208221197128296
Epoch: 3, Steps: 1045 | Train Loss: 0.5624875 Vali Loss: 0.2823981 Best vali loss: 0.2823981

best validation loss 0.2823980674507805

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0045095109113, 'e_layers': 2, 'learning_rate': 0.0002290527556, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6852649
	speed: 0.0088s/iter; left time: 44.9074s
	iters: 200, epoch: 4 | loss: 0.5000582
	speed: 0.0033s/iter; left time: 16.4979s
	iters: 300, epoch: 4 | loss: 0.8185419
	speed: 0.0033s/iter; left time: 16.1900s
	iters: 400, epoch: 4 | loss: 0.2391005
	speed: 0.0033s/iter; left time: 15.7909s
	iters: 500, epoch: 4 | loss: 0.2790149
	speed: 0.0032s/iter; left time: 15.3471s
	iters: 600, epoch: 4 | loss: 0.1753403
	speed: 0.0032s/iter; left time: 14.5770s
	iters: 700, epoch: 4 | loss: 0.4222284
	speed: 0.0032s/iter; left time: 14.3387s
	iters: 800, epoch: 4 | loss: 0.1860572
	speed: 0.0032s/iter; left time: 14.0405s
	iters: 900, epoch: 4 | loss: 0.2843828
	speed: 0.0033s/iter; left time: 14.0773s
	iters: 1000, epoch: 4 | loss: 0.2155959
	speed: 0.0034s/iter; left time: 14.3938s
Updating learning rate to 0.0001145263778
Epoch: 4 cost time: 3.6881930828094482
Epoch: 4, Steps: 1045 | Train Loss: 0.3805585 Vali Loss: 0.2934961 Best vali loss: 0.2823981
	iters: 100, epoch: 5 | loss: 0.8168363
	speed: 0.0104s/iter; left time: 42.5002s
	iters: 200, epoch: 5 | loss: 0.6226009
	speed: 0.0035s/iter; left time: 13.8604s
	iters: 300, epoch: 5 | loss: 0.1568068
	speed: 0.0034s/iter; left time: 13.3802s
	iters: 400, epoch: 5 | loss: 0.2278190
	speed: 0.0034s/iter; left time: 12.9980s
	iters: 500, epoch: 5 | loss: 0.4591286
	speed: 0.0034s/iter; left time: 12.4710s
	iters: 600, epoch: 5 | loss: 0.3148546
	speed: 0.0034s/iter; left time: 12.1118s
	iters: 700, epoch: 5 | loss: 0.2984708
	speed: 0.0034s/iter; left time: 11.8114s
	iters: 800, epoch: 5 | loss: 0.3840190
	speed: 0.0034s/iter; left time: 11.5999s
	iters: 900, epoch: 5 | loss: 0.1270101
	speed: 0.0035s/iter; left time: 11.3357s
	iters: 1000, epoch: 5 | loss: 0.8714608
	speed: 0.0034s/iter; left time: 10.8656s
Updating learning rate to 7.069903044715499e-05
Epoch: 5 cost time: 3.6207549571990967
Epoch: 5, Steps: 1045 | Train Loss: 0.4279007 Vali Loss: 0.3076948 Best vali loss: 0.2823981
	iters: 100, epoch: 6 | loss: 0.3454847
	speed: 0.0102s/iter; left time: 30.8814s
	iters: 200, epoch: 6 | loss: 0.3756174
	speed: 0.0032s/iter; left time: 9.3604s
	iters: 300, epoch: 6 | loss: 0.2915645
	speed: 0.0032s/iter; left time: 9.0361s
	iters: 400, epoch: 6 | loss: 0.6279392
	speed: 0.0032s/iter; left time: 8.6962s
	iters: 500, epoch: 6 | loss: 0.3593413
	speed: 0.0032s/iter; left time: 8.3788s
	iters: 600, epoch: 6 | loss: 0.2600886
	speed: 0.0032s/iter; left time: 8.0688s
	iters: 700, epoch: 6 | loss: 0.1258196
	speed: 0.0032s/iter; left time: 7.7463s
	iters: 800, epoch: 6 | loss: 0.2300903
	speed: 0.0030s/iter; left time: 6.9305s
	iters: 900, epoch: 6 | loss: 0.4716356
	speed: 0.0030s/iter; left time: 6.6386s
	iters: 1000, epoch: 6 | loss: 0.4295743
	speed: 0.0030s/iter; left time: 6.3900s
Updating learning rate to 3.354399943288754e-05
Epoch: 6 cost time: 3.28873872756958
Epoch: 6, Steps: 1045 | Train Loss: 0.3517156 Vali Loss: 0.3159658 Best vali loss: 0.2823981
	iters: 100, epoch: 7 | loss: 0.2678381
	speed: 0.0097s/iter; left time: 19.3262s
	iters: 200, epoch: 7 | loss: 0.2264135
	speed: 0.0029s/iter; left time: 5.5286s
	iters: 300, epoch: 7 | loss: 0.1959452
	speed: 0.0029s/iter; left time: 5.2010s
	iters: 400, epoch: 7 | loss: 0.3553611
	speed: 0.0029s/iter; left time: 4.9759s
	iters: 500, epoch: 7 | loss: 0.3595032
	speed: 0.0029s/iter; left time: 4.6749s
	iters: 600, epoch: 7 | loss: 0.5746528
	speed: 0.0029s/iter; left time: 4.3965s
	iters: 700, epoch: 7 | loss: 0.1121413
	speed: 0.0030s/iter; left time: 4.1091s
	iters: 800, epoch: 7 | loss: 0.1506529
	speed: 0.0031s/iter; left time: 3.9509s
	iters: 900, epoch: 7 | loss: 0.1751999
	speed: 0.0031s/iter; left time: 3.6768s
	iters: 1000, epoch: 7 | loss: 0.1472190
	speed: 0.0030s/iter; left time: 3.3002s
Updating learning rate to 8.717801417924993e-06
Epoch: 7 cost time: 3.1453139781951904
Epoch: 7, Steps: 1045 | Train Loss: 0.2564927 Vali Loss: 0.3183908 Best vali loss: 0.2823981
	iters: 100, epoch: 8 | loss: 0.3330919
	speed: 0.0095s/iter; left time: 9.0049s
	iters: 200, epoch: 8 | loss: 0.2201945
	speed: 0.0029s/iter; left time: 2.4636s
	iters: 300, epoch: 8 | loss: 0.1378079
	speed: 0.0029s/iter; left time: 2.1477s
	iters: 400, epoch: 8 | loss: 0.1657577
	speed: 0.0031s/iter; left time: 1.9924s
	iters: 500, epoch: 8 | loss: 0.7894544
	speed: 0.0030s/iter; left time: 1.6364s
	iters: 600, epoch: 8 | loss: 0.1323559
	speed: 0.0031s/iter; left time: 1.3970s
	iters: 700, epoch: 8 | loss: 0.2166915
	speed: 0.0032s/iter; left time: 1.0941s
	iters: 800, epoch: 8 | loss: 0.3110472
	speed: 0.0031s/iter; left time: 0.7522s
	iters: 900, epoch: 8 | loss: 0.1493456
	speed: 0.0030s/iter; left time: 0.4445s
	iters: 1000, epoch: 8 | loss: 0.1519803
	speed: 0.0029s/iter; left time: 0.1346s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1787002086639404
Epoch: 8, Steps: 1045 | Train Loss: 0.2607727 Vali Loss: 0.3219214 Best vali loss: 0.2823981

best validation loss 0.2823980674507805

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0097198716372, 'e_layers': 2, 'learning_rate': 0.0002286534079, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4550128
	speed: 0.0086s/iter; left time: 71.1385s
	iters: 200, epoch: 1 | loss: 0.1924202
	speed: 0.0034s/iter; left time: 28.1520s
	iters: 300, epoch: 1 | loss: 0.2661879
	speed: 0.0035s/iter; left time: 27.8886s
	iters: 400, epoch: 1 | loss: 0.2876980
	speed: 0.0035s/iter; left time: 27.5401s
	iters: 500, epoch: 1 | loss: 0.6689361
	speed: 0.0034s/iter; left time: 26.8919s
	iters: 600, epoch: 1 | loss: 0.3063535
	speed: 0.0034s/iter; left time: 26.3747s
	iters: 700, epoch: 1 | loss: 0.4281465
	speed: 0.0034s/iter; left time: 25.8990s
	iters: 800, epoch: 1 | loss: 0.2624753
	speed: 0.0032s/iter; left time: 24.0898s
	iters: 900, epoch: 1 | loss: 0.3045883
	speed: 0.0032s/iter; left time: 23.6413s
	iters: 1000, epoch: 1 | loss: 0.3912253
	speed: 0.0032s/iter; left time: 23.2731s
Updating learning rate to 0.00021995080574888228
Validation loss decreased (inf --> 0.2923).  Saving model state dict ...
Epoch: 1 cost time: 3.7635140419006348
Epoch: 1, Steps: 1045 | Train Loss: 0.3563044 Vali Loss: 0.2923138 Best vali loss: 0.2923138
	iters: 100, epoch: 2 | loss: 0.3006031
	speed: 0.0102s/iter; left time: 73.5029s
	iters: 200, epoch: 2 | loss: 1.3079234
	speed: 0.0034s/iter; left time: 24.4902s
	iters: 300, epoch: 2 | loss: 0.3657633
	speed: 0.0036s/iter; left time: 24.9842s
	iters: 400, epoch: 2 | loss: 1.1942186
	speed: 0.0035s/iter; left time: 24.4305s
	iters: 500, epoch: 2 | loss: 0.9605106
	speed: 0.0034s/iter; left time: 23.4244s
	iters: 600, epoch: 2 | loss: 0.3306833
	speed: 0.0034s/iter; left time: 22.9489s
	iters: 700, epoch: 2 | loss: 0.7262633
	speed: 0.0034s/iter; left time: 22.8249s
	iters: 800, epoch: 2 | loss: 0.2756008
	speed: 0.0035s/iter; left time: 22.6072s
	iters: 900, epoch: 2 | loss: 0.3943734
	speed: 0.0035s/iter; left time: 22.1764s
	iters: 1000, epoch: 2 | loss: 0.2472954
	speed: 0.0035s/iter; left time: 21.9904s
Updating learning rate to 0.00019516789158375187
Epoch: 2 cost time: 3.650023937225342
Epoch: 2, Steps: 1045 | Train Loss: 0.6103235 Vali Loss: 0.2924440 Best vali loss: 0.2923138
	iters: 100, epoch: 3 | loss: 0.2041416
	speed: 0.0102s/iter; left time: 63.0304s
	iters: 200, epoch: 3 | loss: 0.5255327
	speed: 0.0034s/iter; left time: 20.6327s
	iters: 300, epoch: 3 | loss: 0.8527732
	speed: 0.0034s/iter; left time: 20.1897s
	iters: 400, epoch: 3 | loss: 0.4547618
	speed: 0.0034s/iter; left time: 19.9553s
	iters: 500, epoch: 3 | loss: 0.3115902
	speed: 0.0034s/iter; left time: 19.4404s
	iters: 600, epoch: 3 | loss: 0.1874915
	speed: 0.0033s/iter; left time: 18.9873s
	iters: 700, epoch: 3 | loss: 0.4737097
	speed: 0.0034s/iter; left time: 18.7309s
	iters: 800, epoch: 3 | loss: 0.4864239
	speed: 0.0033s/iter; left time: 18.3221s
	iters: 900, epoch: 3 | loss: 0.1768457
	speed: 0.0034s/iter; left time: 18.0931s
	iters: 1000, epoch: 3 | loss: 0.3962904
	speed: 0.0034s/iter; left time: 17.6789s
Updating learning rate to 0.00015807763942857347
Validation loss decreased (0.2923 --> 0.2911).  Saving model state dict ...
Epoch: 3 cost time: 3.55779767036438
Epoch: 3, Steps: 1045 | Train Loss: 0.4069561 Vali Loss: 0.2910990 Best vali loss: 0.2910990
	iters: 100, epoch: 4 | loss: 0.5811189
	speed: 0.0102s/iter; left time: 52.5353s
	iters: 200, epoch: 4 | loss: 0.9322115
	speed: 0.0030s/iter; left time: 15.0830s
	iters: 300, epoch: 4 | loss: 0.3438226
	speed: 0.0029s/iter; left time: 14.2048s
	iters: 400, epoch: 4 | loss: 0.3248429
	speed: 0.0029s/iter; left time: 13.8646s
	iters: 500, epoch: 4 | loss: 0.7340419
	speed: 0.0029s/iter; left time: 13.4900s
	iters: 600, epoch: 4 | loss: 0.9229975
	speed: 0.0029s/iter; left time: 13.4525s
	iters: 700, epoch: 4 | loss: 0.5902733
	speed: 0.0029s/iter; left time: 13.2966s
	iters: 800, epoch: 4 | loss: 0.3102719
	speed: 0.0029s/iter; left time: 12.8252s
	iters: 900, epoch: 4 | loss: 0.2271613
	speed: 0.0028s/iter; left time: 11.9778s
	iters: 1000, epoch: 4 | loss: 0.2790972
	speed: 0.0028s/iter; left time: 11.7438s
Updating learning rate to 0.00011432670395
Validation loss decreased (0.2911 --> 0.2852).  Saving model state dict ...
Epoch: 4 cost time: 3.0553767681121826
Epoch: 4, Steps: 1045 | Train Loss: 0.5245839 Vali Loss: 0.2851798 Best vali loss: 0.2851798
	iters: 100, epoch: 5 | loss: 0.1399090
	speed: 0.0099s/iter; left time: 40.4090s
	iters: 200, epoch: 5 | loss: 0.1816962
	speed: 0.0030s/iter; left time: 12.0453s
	iters: 300, epoch: 5 | loss: 0.1936952
	speed: 0.0030s/iter; left time: 11.6900s
	iters: 400, epoch: 5 | loss: 0.3572842
	speed: 0.0030s/iter; left time: 11.2640s
	iters: 500, epoch: 5 | loss: 0.2298265
	speed: 0.0029s/iter; left time: 10.7787s
	iters: 600, epoch: 5 | loss: 0.4193979
	speed: 0.0031s/iter; left time: 10.9858s
	iters: 700, epoch: 5 | loss: 0.2225088
	speed: 0.0030s/iter; left time: 10.3777s
	iters: 800, epoch: 5 | loss: 0.3783244
	speed: 0.0029s/iter; left time: 9.9456s
	iters: 900, epoch: 5 | loss: 0.1097509
	speed: 0.0029s/iter; left time: 9.6320s
	iters: 1000, epoch: 5 | loss: 0.6435950
	speed: 0.0030s/iter; left time: 9.3842s
Updating learning rate to 7.057576847142654e-05
Epoch: 5 cost time: 3.1572153568267822
Epoch: 5, Steps: 1045 | Train Loss: 0.2875988 Vali Loss: 0.2879670 Best vali loss: 0.2851798
	iters: 100, epoch: 6 | loss: 0.7449647
	speed: 0.0099s/iter; left time: 29.9479s
	iters: 200, epoch: 6 | loss: 0.4937513
	speed: 0.0031s/iter; left time: 9.1895s
	iters: 300, epoch: 6 | loss: 0.7663195
	speed: 0.0031s/iter; left time: 8.7877s
	iters: 400, epoch: 6 | loss: 0.3271564
	speed: 0.0031s/iter; left time: 8.5448s
	iters: 500, epoch: 6 | loss: 0.2252653
	speed: 0.0031s/iter; left time: 8.2587s
	iters: 600, epoch: 6 | loss: 0.5514880
	speed: 0.0031s/iter; left time: 7.9502s
	iters: 700, epoch: 6 | loss: 0.7180350
	speed: 0.0031s/iter; left time: 7.6522s
	iters: 800, epoch: 6 | loss: 0.2925127
	speed: 0.0033s/iter; left time: 7.7299s
	iters: 900, epoch: 6 | loss: 0.3076255
	speed: 0.0034s/iter; left time: 7.5049s
	iters: 1000, epoch: 6 | loss: 0.1846973
	speed: 0.0033s/iter; left time: 7.1419s
Updating learning rate to 3.348551631624816e-05
Epoch: 6 cost time: 3.379793167114258
Epoch: 6, Steps: 1045 | Train Loss: 0.4611816 Vali Loss: 0.2999716 Best vali loss: 0.2851798
	iters: 100, epoch: 7 | loss: 0.1942300
	speed: 0.0102s/iter; left time: 20.3918s
	iters: 200, epoch: 7 | loss: 0.2650523
	speed: 0.0035s/iter; left time: 6.5434s
	iters: 300, epoch: 7 | loss: 0.1088142
	speed: 0.0034s/iter; left time: 6.1418s
	iters: 400, epoch: 7 | loss: 0.1743544
	speed: 0.0033s/iter; left time: 5.5571s
	iters: 500, epoch: 7 | loss: 0.2904607
	speed: 0.0032s/iter; left time: 5.0226s
	iters: 600, epoch: 7 | loss: 1.0099070
	speed: 0.0031s/iter; left time: 4.6895s
	iters: 700, epoch: 7 | loss: 0.2260599
	speed: 0.0032s/iter; left time: 4.3933s
	iters: 800, epoch: 7 | loss: 0.3479495
	speed: 0.0030s/iter; left time: 3.9014s
	iters: 900, epoch: 7 | loss: 0.1523171
	speed: 0.0029s/iter; left time: 3.4374s
	iters: 1000, epoch: 7 | loss: 0.3315775
	speed: 0.0029s/iter; left time: 3.1816s
Updating learning rate to 8.70260215111772e-06
Epoch: 7 cost time: 3.360706329345703
Epoch: 7, Steps: 1045 | Train Loss: 0.3100723 Vali Loss: 0.3062518 Best vali loss: 0.2851798
	iters: 100, epoch: 8 | loss: 0.1333843
	speed: 0.0102s/iter; left time: 9.6195s
	iters: 200, epoch: 8 | loss: 0.2058125
	speed: 0.0034s/iter; left time: 2.9024s
	iters: 300, epoch: 8 | loss: 0.1368832
	speed: 0.0034s/iter; left time: 2.5602s
	iters: 400, epoch: 8 | loss: 0.1853535
	speed: 0.0034s/iter; left time: 2.1753s
	iters: 500, epoch: 8 | loss: 0.1507881
	speed: 0.0034s/iter; left time: 1.8401s
	iters: 600, epoch: 8 | loss: 0.5248603
	speed: 0.0034s/iter; left time: 1.5166s
	iters: 700, epoch: 8 | loss: 0.7689212
	speed: 0.0034s/iter; left time: 1.1616s
	iters: 800, epoch: 8 | loss: 0.3787405
	speed: 0.0033s/iter; left time: 0.8202s
	iters: 900, epoch: 8 | loss: 0.3152791
	speed: 0.0034s/iter; left time: 0.4919s
	iters: 1000, epoch: 8 | loss: 0.1484676
	speed: 0.0034s/iter; left time: 0.1550s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5676207542419434
Epoch: 8, Steps: 1045 | Train Loss: 0.2948490 Vali Loss: 0.3129477 Best vali loss: 0.2851798

best validation loss 0.2851797721839474

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0098173055147, 'e_layers': 2, 'learning_rate': 0.0002280841039, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2921414
	speed: 0.0085s/iter; left time: 70.3585s
	iters: 200, epoch: 1 | loss: 0.2101484
	speed: 0.0034s/iter; left time: 27.5674s
	iters: 300, epoch: 1 | loss: 0.3315859
	speed: 0.0034s/iter; left time: 27.5889s
	iters: 400, epoch: 1 | loss: 1.7605991
	speed: 0.0034s/iter; left time: 26.9879s
	iters: 500, epoch: 1 | loss: 0.9110013
	speed: 0.0034s/iter; left time: 26.6656s
	iters: 600, epoch: 1 | loss: 0.3543587
	speed: 0.0034s/iter; left time: 26.5356s
	iters: 700, epoch: 1 | loss: 0.2265837
	speed: 0.0034s/iter; left time: 26.0238s
	iters: 800, epoch: 1 | loss: 0.2650965
	speed: 0.0034s/iter; left time: 25.4834s
	iters: 900, epoch: 1 | loss: 0.8714117
	speed: 0.0033s/iter; left time: 24.9563s
	iters: 1000, epoch: 1 | loss: 0.4325131
	speed: 0.0034s/iter; left time: 24.9122s
Updating learning rate to 0.00021940316959219387
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 3.8046364784240723
Epoch: 1, Steps: 1045 | Train Loss: 0.5655440 Vali Loss: 0.2822327 Best vali loss: 0.2822327
	iters: 100, epoch: 2 | loss: 0.3152773
	speed: 0.0102s/iter; left time: 73.9054s
	iters: 200, epoch: 2 | loss: 0.3694825
	speed: 0.0031s/iter; left time: 21.9866s
	iters: 300, epoch: 2 | loss: 0.2769563
	speed: 0.0031s/iter; left time: 21.6199s
	iters: 400, epoch: 2 | loss: 0.3865069
	speed: 0.0031s/iter; left time: 21.5116s
	iters: 500, epoch: 2 | loss: 0.9658599
	speed: 0.0031s/iter; left time: 20.9922s
	iters: 600, epoch: 2 | loss: 0.9410761
	speed: 0.0031s/iter; left time: 20.8700s
	iters: 700, epoch: 2 | loss: 0.3150269
	speed: 0.0031s/iter; left time: 20.4483s
	iters: 800, epoch: 2 | loss: 0.3413983
	speed: 0.0031s/iter; left time: 20.0631s
	iters: 900, epoch: 2 | loss: 0.4135220
	speed: 0.0031s/iter; left time: 19.7691s
	iters: 1000, epoch: 2 | loss: 0.9031129
	speed: 0.0031s/iter; left time: 19.3372s
Updating learning rate to 0.0001946819602242735
Epoch: 2 cost time: 3.2821130752563477
Epoch: 2, Steps: 1045 | Train Loss: 0.5228219 Vali Loss: 0.2869380 Best vali loss: 0.2822327
	iters: 100, epoch: 3 | loss: 0.3841070
	speed: 0.0099s/iter; left time: 60.8447s
	iters: 200, epoch: 3 | loss: 0.3636039
	speed: 0.0031s/iter; left time: 18.5736s
	iters: 300, epoch: 3 | loss: 0.4466657
	speed: 0.0030s/iter; left time: 18.0234s
	iters: 400, epoch: 3 | loss: 0.3692930
	speed: 0.0030s/iter; left time: 17.8908s
	iters: 500, epoch: 3 | loss: 0.9239486
	speed: 0.0030s/iter; left time: 17.4485s
	iters: 600, epoch: 3 | loss: 0.2363923
	speed: 0.0031s/iter; left time: 17.4108s
	iters: 700, epoch: 3 | loss: 0.7019512
	speed: 0.0030s/iter; left time: 16.8807s
	iters: 800, epoch: 3 | loss: 0.3004190
	speed: 0.0031s/iter; left time: 16.7959s
	iters: 900, epoch: 3 | loss: 0.9049119
	speed: 0.0031s/iter; left time: 16.3862s
	iters: 1000, epoch: 3 | loss: 0.2860455
	speed: 0.0031s/iter; left time: 16.2768s
Updating learning rate to 0.00015768405582418387
Epoch: 3 cost time: 3.2261431217193604
Epoch: 3, Steps: 1045 | Train Loss: 0.4917338 Vali Loss: 0.2878929 Best vali loss: 0.2822327
	iters: 100, epoch: 4 | loss: 0.2450676
	speed: 0.0094s/iter; left time: 48.4301s
	iters: 200, epoch: 4 | loss: 0.7391463
	speed: 0.0028s/iter; left time: 14.2433s
	iters: 300, epoch: 4 | loss: 0.4594955
	speed: 0.0028s/iter; left time: 13.8987s
	iters: 400, epoch: 4 | loss: 0.5193200
	speed: 0.0028s/iter; left time: 13.6387s
	iters: 500, epoch: 4 | loss: 1.0986946
	speed: 0.0028s/iter; left time: 13.3645s
	iters: 600, epoch: 4 | loss: 0.4923877
	speed: 0.0028s/iter; left time: 13.0811s
	iters: 700, epoch: 4 | loss: 0.6482111
	speed: 0.0028s/iter; left time: 12.7367s
	iters: 800, epoch: 4 | loss: 0.5007705
	speed: 0.0028s/iter; left time: 12.5218s
	iters: 900, epoch: 4 | loss: 0.5812585
	speed: 0.0028s/iter; left time: 12.1627s
	iters: 1000, epoch: 4 | loss: 0.4139394
	speed: 0.0028s/iter; left time: 11.8819s
Updating learning rate to 0.00011404205195
Epoch: 4 cost time: 2.98939847946167
Epoch: 4, Steps: 1045 | Train Loss: 0.5698291 Vali Loss: 0.2868609 Best vali loss: 0.2822327
	iters: 100, epoch: 5 | loss: 0.2154710
	speed: 0.0096s/iter; left time: 39.1502s
	iters: 200, epoch: 5 | loss: 0.2432695
	speed: 0.0031s/iter; left time: 12.4119s
	iters: 300, epoch: 5 | loss: 0.2555958
	speed: 0.0031s/iter; left time: 11.9599s
	iters: 400, epoch: 5 | loss: 0.2996011
	speed: 0.0031s/iter; left time: 11.7921s
	iters: 500, epoch: 5 | loss: 0.1942192
	speed: 0.0031s/iter; left time: 11.4443s
	iters: 600, epoch: 5 | loss: 0.2336343
	speed: 0.0031s/iter; left time: 11.0941s
	iters: 700, epoch: 5 | loss: 0.5941006
	speed: 0.0031s/iter; left time: 10.8685s
	iters: 800, epoch: 5 | loss: 0.3200845
	speed: 0.0031s/iter; left time: 10.3126s
	iters: 900, epoch: 5 | loss: 0.2979657
	speed: 0.0031s/iter; left time: 10.2371s
	iters: 1000, epoch: 5 | loss: 0.5038154
	speed: 0.0031s/iter; left time: 9.8031s
Updating learning rate to 7.040004807581612e-05
Epoch: 5 cost time: 3.2733631134033203
Epoch: 5, Steps: 1045 | Train Loss: 0.3157757 Vali Loss: 0.2955195 Best vali loss: 0.2822327
	iters: 100, epoch: 6 | loss: 0.3872749
	speed: 0.0101s/iter; left time: 30.7701s
	iters: 200, epoch: 6 | loss: 0.6969666
	speed: 0.0033s/iter; left time: 9.7924s
	iters: 300, epoch: 6 | loss: 0.4546526
	speed: 0.0031s/iter; left time: 8.9291s
	iters: 400, epoch: 6 | loss: 0.1837888
	speed: 0.0031s/iter; left time: 8.4291s
	iters: 500, epoch: 6 | loss: 0.1788683
	speed: 0.0031s/iter; left time: 8.0648s
	iters: 600, epoch: 6 | loss: 0.1578860
	speed: 0.0031s/iter; left time: 7.7562s
	iters: 700, epoch: 6 | loss: 0.4541149
	speed: 0.0031s/iter; left time: 7.4575s
	iters: 800, epoch: 6 | loss: 0.3468154
	speed: 0.0031s/iter; left time: 7.1487s
	iters: 900, epoch: 6 | loss: 0.4883309
	speed: 0.0031s/iter; left time: 6.9031s
	iters: 1000, epoch: 6 | loss: 0.1460814
	speed: 0.0031s/iter; left time: 6.6290s
Updating learning rate to 3.340214367572647e-05
Epoch: 6 cost time: 3.3159549236297607
Epoch: 6, Steps: 1045 | Train Loss: 0.3494780 Vali Loss: 0.3129265 Best vali loss: 0.2822327
	iters: 100, epoch: 7 | loss: 0.2350357
	speed: 0.0101s/iter; left time: 20.0626s
	iters: 200, epoch: 7 | loss: 0.6044348
	speed: 0.0030s/iter; left time: 5.6970s
	iters: 300, epoch: 7 | loss: 0.4476440
	speed: 0.0030s/iter; left time: 5.4056s
	iters: 400, epoch: 7 | loss: 0.3392537
	speed: 0.0031s/iter; left time: 5.2076s
	iters: 500, epoch: 7 | loss: 0.1532780
	speed: 0.0032s/iter; left time: 5.0117s
	iters: 600, epoch: 7 | loss: 0.2556415
	speed: 0.0031s/iter; left time: 4.6687s
	iters: 700, epoch: 7 | loss: 0.1157953
	speed: 0.0031s/iter; left time: 4.3407s
	iters: 800, epoch: 7 | loss: 0.2869346
	speed: 0.0031s/iter; left time: 3.9498s
	iters: 900, epoch: 7 | loss: 0.2094405
	speed: 0.0030s/iter; left time: 3.6207s
	iters: 1000, epoch: 7 | loss: 0.2042708
	speed: 0.0032s/iter; left time: 3.4752s
Updating learning rate to 8.680934307806123e-06
Epoch: 7 cost time: 3.271148920059204
Epoch: 7, Steps: 1045 | Train Loss: 0.2851729 Vali Loss: 0.3190129 Best vali loss: 0.2822327
	iters: 100, epoch: 8 | loss: 0.2870945
	speed: 0.0102s/iter; left time: 9.6714s
	iters: 200, epoch: 8 | loss: 0.1827629
	speed: 0.0033s/iter; left time: 2.7842s
	iters: 300, epoch: 8 | loss: 0.2071129
	speed: 0.0031s/iter; left time: 2.3287s
	iters: 400, epoch: 8 | loss: 0.5297801
	speed: 0.0031s/iter; left time: 2.0155s
	iters: 500, epoch: 8 | loss: 0.2199790
	speed: 0.0032s/iter; left time: 1.7203s
	iters: 600, epoch: 8 | loss: 0.1250020
	speed: 0.0031s/iter; left time: 1.4000s
	iters: 700, epoch: 8 | loss: 0.1659245
	speed: 0.0031s/iter; left time: 1.0830s
	iters: 800, epoch: 8 | loss: 0.1412269
	speed: 0.0031s/iter; left time: 0.7677s
	iters: 900, epoch: 8 | loss: 0.1533885
	speed: 0.0031s/iter; left time: 0.4580s
	iters: 1000, epoch: 8 | loss: 0.1565361
	speed: 0.0031s/iter; left time: 0.1437s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.3586082458496094
Epoch: 8, Steps: 1045 | Train Loss: 0.2168807 Vali Loss: 0.3171762 Best vali loss: 0.2822327

best validation loss 0.2822327291480047

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0035733756613, 'e_layers': 2, 'learning_rate': 0.0002278150042, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2466246
	speed: 0.0089s/iter; left time: 73.3800s
	iters: 200, epoch: 1 | loss: 0.1832584
	speed: 0.0034s/iter; left time: 27.8037s
	iters: 300, epoch: 1 | loss: 0.2203445
	speed: 0.0034s/iter; left time: 27.7032s
	iters: 400, epoch: 1 | loss: 0.3081073
	speed: 0.0035s/iter; left time: 27.7326s
	iters: 500, epoch: 1 | loss: 0.3639767
	speed: 0.0035s/iter; left time: 27.4245s
	iters: 600, epoch: 1 | loss: 0.4880171
	speed: 0.0035s/iter; left time: 27.0251s
	iters: 700, epoch: 1 | loss: 1.0062381
	speed: 0.0035s/iter; left time: 26.4399s
	iters: 800, epoch: 1 | loss: 0.4273222
	speed: 0.0035s/iter; left time: 26.2728s
	iters: 900, epoch: 1 | loss: 0.3207868
	speed: 0.0035s/iter; left time: 26.3384s
	iters: 1000, epoch: 1 | loss: 0.5774575
	speed: 0.0035s/iter; left time: 25.7511s
Updating learning rate to 0.0002191443118896764
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 3.895052194595337
Epoch: 1, Steps: 1045 | Train Loss: 0.4142133 Vali Loss: 0.2821390 Best vali loss: 0.2821390
	iters: 100, epoch: 2 | loss: 0.1798025
	speed: 0.0100s/iter; left time: 71.8683s
	iters: 200, epoch: 2 | loss: 0.3557938
	speed: 0.0029s/iter; left time: 20.4905s
	iters: 300, epoch: 2 | loss: 0.4071713
	speed: 0.0030s/iter; left time: 20.7769s
	iters: 400, epoch: 2 | loss: 0.5570043
	speed: 0.0029s/iter; left time: 20.3836s
	iters: 500, epoch: 2 | loss: 0.5999061
	speed: 0.0030s/iter; left time: 20.5354s
	iters: 600, epoch: 2 | loss: 0.8090238
	speed: 0.0031s/iter; left time: 20.8306s
	iters: 700, epoch: 2 | loss: 1.0867832
	speed: 0.0030s/iter; left time: 19.7639s
	iters: 800, epoch: 2 | loss: 0.3521793
	speed: 0.0030s/iter; left time: 19.4503s
	iters: 900, epoch: 2 | loss: 0.3654172
	speed: 0.0030s/iter; left time: 19.2876s
	iters: 1000, epoch: 2 | loss: 0.4343448
	speed: 0.0032s/iter; left time: 20.5195s
Updating learning rate to 0.0001944522692629309
Validation loss decreased (0.2821 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 3.1934709548950195
Epoch: 2, Steps: 1045 | Train Loss: 0.5147426 Vali Loss: 0.2780559 Best vali loss: 0.2780559
	iters: 100, epoch: 3 | loss: 0.1791515
	speed: 0.0101s/iter; left time: 62.4436s
	iters: 200, epoch: 3 | loss: 0.4402238
	speed: 0.0031s/iter; left time: 18.6182s
	iters: 300, epoch: 3 | loss: 0.6056987
	speed: 0.0031s/iter; left time: 18.4427s
	iters: 400, epoch: 3 | loss: 0.5198320
	speed: 0.0030s/iter; left time: 17.8604s
	iters: 500, epoch: 3 | loss: 0.2787079
	speed: 0.0031s/iter; left time: 17.6912s
	iters: 600, epoch: 3 | loss: 0.2425481
	speed: 0.0031s/iter; left time: 17.3646s
	iters: 700, epoch: 3 | loss: 0.4261715
	speed: 0.0030s/iter; left time: 16.8850s
	iters: 800, epoch: 3 | loss: 0.3076361
	speed: 0.0030s/iter; left time: 16.6583s
	iters: 900, epoch: 3 | loss: 0.6476153
	speed: 0.0031s/iter; left time: 16.4513s
	iters: 1000, epoch: 3 | loss: 0.6517774
	speed: 0.0031s/iter; left time: 16.0777s
Updating learning rate to 0.00015749801597576168
Epoch: 3 cost time: 3.2273919582366943
Epoch: 3, Steps: 1045 | Train Loss: 0.4299362 Vali Loss: 0.2871747 Best vali loss: 0.2780559

best validation loss 0.2780559019456791

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0035307599705, 'e_layers': 2, 'learning_rate': 0.0002379872341, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2463722
	speed: 0.0088s/iter; left time: 72.4817s
	iters: 200, epoch: 1 | loss: 0.1841331
	speed: 0.0035s/iter; left time: 28.4861s
	iters: 300, epoch: 1 | loss: 0.2209729
	speed: 0.0035s/iter; left time: 27.8194s
	iters: 400, epoch: 1 | loss: 0.3043517
	speed: 0.0035s/iter; left time: 27.5293s
	iters: 500, epoch: 1 | loss: 0.3635442
	speed: 0.0035s/iter; left time: 27.2903s
	iters: 600, epoch: 1 | loss: 0.4714210
	speed: 0.0034s/iter; left time: 26.7310s
	iters: 700, epoch: 1 | loss: 1.0218532
	speed: 0.0035s/iter; left time: 26.8521s
	iters: 800, epoch: 1 | loss: 0.4312014
	speed: 0.0035s/iter; left time: 26.1618s
	iters: 900, epoch: 1 | loss: 0.3182628
	speed: 0.0035s/iter; left time: 26.0143s
	iters: 1000, epoch: 1 | loss: 0.5844230
	speed: 0.0035s/iter; left time: 25.4867s
Updating learning rate to 0.00022892938434198107
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 3.897608995437622
Epoch: 1, Steps: 1045 | Train Loss: 0.4146536 Vali Loss: 0.2835010 Best vali loss: 0.2835010
	iters: 100, epoch: 2 | loss: 0.1827602
	speed: 0.0103s/iter; left time: 74.3196s
	iters: 200, epoch: 2 | loss: 0.3582656
	speed: 0.0032s/iter; left time: 22.9005s
	iters: 300, epoch: 2 | loss: 0.4167500
	speed: 0.0032s/iter; left time: 22.3284s
	iters: 400, epoch: 2 | loss: 0.7488251
	speed: 0.0032s/iter; left time: 21.9197s
	iters: 500, epoch: 2 | loss: 0.5931733
	speed: 0.0032s/iter; left time: 21.6665s
	iters: 600, epoch: 2 | loss: 0.7836624
	speed: 0.0032s/iter; left time: 21.3427s
	iters: 700, epoch: 2 | loss: 1.1598954
	speed: 0.0032s/iter; left time: 21.0351s
	iters: 800, epoch: 2 | loss: 0.3890276
	speed: 0.0032s/iter; left time: 20.5820s
	iters: 900, epoch: 2 | loss: 0.4184444
	speed: 0.0032s/iter; left time: 20.3120s
	iters: 1000, epoch: 2 | loss: 1.0438108
	speed: 0.0031s/iter; left time: 19.7030s
Updating learning rate to 0.00020313481058397017
Epoch: 2 cost time: 3.3531196117401123
Epoch: 2, Steps: 1045 | Train Loss: 0.6094615 Vali Loss: 0.2838933 Best vali loss: 0.2835010
	iters: 100, epoch: 3 | loss: 0.1678753
	speed: 0.0102s/iter; left time: 63.2011s
	iters: 200, epoch: 3 | loss: 0.4662229
	speed: 0.0034s/iter; left time: 20.7740s
	iters: 300, epoch: 3 | loss: 0.9595310
	speed: 0.0034s/iter; left time: 20.5066s
	iters: 400, epoch: 3 | loss: 0.5012040
	speed: 0.0034s/iter; left time: 20.1408s
	iters: 500, epoch: 3 | loss: 0.2793195
	speed: 0.0034s/iter; left time: 19.6987s
	iters: 600, epoch: 3 | loss: 0.2283824
	speed: 0.0034s/iter; left time: 19.2930s
	iters: 700, epoch: 3 | loss: 0.5931120
	speed: 0.0034s/iter; left time: 19.0207s
	iters: 800, epoch: 3 | loss: 0.3641440
	speed: 0.0035s/iter; left time: 19.1026s
	iters: 900, epoch: 3 | loss: 0.7737206
	speed: 0.0034s/iter; left time: 18.3819s
	iters: 1000, epoch: 3 | loss: 0.4860670
	speed: 0.0033s/iter; left time: 17.6572s
Updating learning rate to 0.00016453050285223107
Epoch: 3 cost time: 3.6087138652801514
Epoch: 3, Steps: 1045 | Train Loss: 0.4819579 Vali Loss: 0.2860485 Best vali loss: 0.2835010

best validation loss 0.28350103349768124

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0076496171219, 'e_layers': 2, 'learning_rate': 0.000225195148, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4584486
	speed: 0.0092s/iter; left time: 8.7638s
Updating learning rate to 0.000225195148
Validation loss decreased (inf --> 0.2816).  Saving model state dict ...
Epoch: 1 cost time: 0.785642147064209
Epoch: 1, Steps: 131 | Train Loss: 0.4584486 Vali Loss: 0.2815895 Best vali loss: 0.2815895
	iters: 100, epoch: 2 | loss: 0.5988930
	speed: 0.0068s/iter; left time: 5.5861s
Updating learning rate to 0.000112597574
Validation loss decreased (0.2816 --> 0.2768).  Saving model state dict ...
Epoch: 2 cost time: 0.5225002765655518
Epoch: 2, Steps: 131 | Train Loss: 0.5988930 Vali Loss: 0.2768074 Best vali loss: 0.2768074
	iters: 100, epoch: 3 | loss: 0.5885442
	speed: 0.0068s/iter; left time: 4.6915s
Updating learning rate to 5.6298787e-05
Epoch: 3 cost time: 0.5284600257873535
Epoch: 3, Steps: 131 | Train Loss: 0.5885442 Vali Loss: 0.2858421 Best vali loss: 0.2768074

best validation loss 0.27680742177612144

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0076496171219, 'e_layers': 2, 'learning_rate': 0.000225195148, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3750778
	speed: 0.0094s/iter; left time: 5.2296s
Updating learning rate to 2.81493935e-05
Epoch: 4 cost time: 0.7733361721038818
Epoch: 4, Steps: 131 | Train Loss: 0.3750778 Vali Loss: 0.2855838 Best vali loss: 0.2768074
	iters: 100, epoch: 5 | loss: 0.4825950
	speed: 0.0068s/iter; left time: 2.8714s
Updating learning rate to 1.407469675e-05
Epoch: 5 cost time: 0.530034065246582
Epoch: 5, Steps: 131 | Train Loss: 0.4825950 Vali Loss: 0.2802547 Best vali loss: 0.2768074
	iters: 100, epoch: 6 | loss: 0.5233354
	speed: 0.0066s/iter; left time: 1.9349s
Updating learning rate to 7.037348375e-06
Epoch: 6 cost time: 0.5178802013397217
Epoch: 6, Steps: 131 | Train Loss: 0.5233354 Vali Loss: 0.2847510 Best vali loss: 0.2768074
	iters: 100, epoch: 7 | loss: 0.5192449
	speed: 0.0066s/iter; left time: 1.0836s
Updating learning rate to 3.5186741875e-06
Epoch: 7 cost time: 0.5286905765533447
Epoch: 7, Steps: 131 | Train Loss: 0.5192449 Vali Loss: 0.2846593 Best vali loss: 0.2768074
	iters: 100, epoch: 8 | loss: 0.3803995
	speed: 0.0069s/iter; left time: 0.2209s
Updating learning rate to 1.75933709375e-06
Epoch: 8 cost time: 0.5569534301757812
Epoch: 8, Steps: 131 | Train Loss: 0.3803995 Vali Loss: 0.2855550 Best vali loss: 0.2768074

best validation loss 0.27680742177612144

[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.007405055215, 'e_layers': 2, 'learning_rate': 0.0002252968113, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4583277
	speed: 0.0093s/iter; left time: 8.8414s
Updating learning rate to 0.0002167219620000638
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 0.7791585922241211
Epoch: 1, Steps: 131 | Train Loss: 0.4583277 Vali Loss: 0.2815256 Best vali loss: 0.2815256
	iters: 100, epoch: 2 | loss: 0.6001567
	speed: 0.0069s/iter; left time: 5.6104s
Updating learning rate to 0.00019230285717496798
Validation loss decreased (0.2815 --> 0.2761).  Saving model state dict ...
Epoch: 2 cost time: 0.5356936454772949
Epoch: 2, Steps: 131 | Train Loss: 0.6001567 Vali Loss: 0.2760685 Best vali loss: 0.2760685
	iters: 100, epoch: 3 | loss: 0.5750776
	speed: 0.0071s/iter; left time: 4.8842s
Updating learning rate to 0.00015575708417459697
Epoch: 3 cost time: 0.5561201572418213
Epoch: 3, Steps: 131 | Train Loss: 0.5750776 Vali Loss: 0.2787571 Best vali loss: 0.2760685
	iters: 100, epoch: 4 | loss: 0.5462038
	speed: 0.0068s/iter; left time: 3.7678s
Updating learning rate to 0.00011264840565
Epoch: 4 cost time: 0.5314655303955078
Epoch: 4, Steps: 131 | Train Loss: 0.5462038 Vali Loss: 0.2943478 Best vali loss: 0.2760685
	iters: 100, epoch: 5 | loss: 0.3678058
	speed: 0.0067s/iter; left time: 2.8391s
Updating learning rate to 6.953972712540303e-05
Epoch: 5 cost time: 0.5187969207763672
Epoch: 5, Steps: 131 | Train Loss: 0.3678058 Vali Loss: 0.2885838 Best vali loss: 0.2760685
	iters: 100, epoch: 6 | loss: 0.3223270
	speed: 0.0065s/iter; left time: 1.9150s
Updating learning rate to 3.2993954125032014e-05
Epoch: 6 cost time: 0.5172603130340576
Epoch: 6, Steps: 131 | Train Loss: 0.3223270 Vali Loss: 0.2834039 Best vali loss: 0.2760685
	iters: 100, epoch: 7 | loss: 0.2821667
	speed: 0.0066s/iter; left time: 1.0822s
Updating learning rate to 8.574849299936208e-06
Epoch: 7 cost time: 0.5285482406616211
Epoch: 7, Steps: 131 | Train Loss: 0.2821667 Vali Loss: 0.2922361 Best vali loss: 0.2760685
	iters: 100, epoch: 8 | loss: 0.3615220
	speed: 0.0066s/iter; left time: 0.2124s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5234873294830322
Epoch: 8, Steps: 131 | Train Loss: 0.3615220 Vali Loss: 0.2886726 Best vali loss: 0.2760685

best validation loss 0.2760684587235963

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0072112529843, 'e_layers': 2, 'learning_rate': 0.0002252361471, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4583189
	speed: 0.0091s/iter; left time: 8.6513s
Updating learning rate to 0.0002252361471
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 0.7569165229797363
Epoch: 1, Steps: 131 | Train Loss: 0.4583189 Vali Loss: 0.2815367 Best vali loss: 0.2815367
	iters: 100, epoch: 2 | loss: 0.5993341
	speed: 0.0069s/iter; left time: 5.6576s
Updating learning rate to 0.00011261807355
Validation loss decreased (0.2815 --> 0.2771).  Saving model state dict ...
Epoch: 2 cost time: 0.5549120903015137
Epoch: 2, Steps: 131 | Train Loss: 0.5993341 Vali Loss: 0.2771147 Best vali loss: 0.2771147
	iters: 100, epoch: 3 | loss: 0.5901068
	speed: 0.0072s/iter; left time: 4.9458s
Updating learning rate to 5.6309036775e-05
Epoch: 3 cost time: 0.5717930793762207
Epoch: 3, Steps: 131 | Train Loss: 0.5901068 Vali Loss: 0.2847656 Best vali loss: 0.2771147
	iters: 100, epoch: 4 | loss: 0.5610700
	speed: 0.0070s/iter; left time: 3.9088s
Updating learning rate to 2.81545183875e-05
Epoch: 4 cost time: 0.5672993659973145
Epoch: 4, Steps: 131 | Train Loss: 0.5610700 Vali Loss: 0.2829943 Best vali loss: 0.2771147
	iters: 100, epoch: 5 | loss: 0.3901467
	speed: 0.0069s/iter; left time: 2.9143s
Updating learning rate to 1.407725919375e-05
Epoch: 5 cost time: 0.5429887771606445
Epoch: 5, Steps: 131 | Train Loss: 0.3901467 Vali Loss: 0.2844002 Best vali loss: 0.2771147
	iters: 100, epoch: 6 | loss: 0.3426646
	speed: 0.0069s/iter; left time: 2.0402s
Updating learning rate to 7.038629596875e-06
Epoch: 6 cost time: 0.5560958385467529
Epoch: 6, Steps: 131 | Train Loss: 0.3426646 Vali Loss: 0.2835543 Best vali loss: 0.2771147
	iters: 100, epoch: 7 | loss: 0.2870341
	speed: 0.0069s/iter; left time: 1.1261s
Updating learning rate to 3.5193147984375e-06
Epoch: 7 cost time: 0.5619332790374756
Epoch: 7, Steps: 131 | Train Loss: 0.2870341 Vali Loss: 0.2856575 Best vali loss: 0.2771147
	iters: 100, epoch: 8 | loss: 0.4455310
	speed: 0.0069s/iter; left time: 0.2196s
Updating learning rate to 1.75965739921875e-06
Epoch: 8 cost time: 0.546278715133667
Epoch: 8, Steps: 131 | Train Loss: 0.4455310 Vali Loss: 0.2837080 Best vali loss: 0.2771147

best validation loss 0.2771147014916098

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0077271786073, 'e_layers': 2, 'learning_rate': 0.000225257705, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4583614
	speed: 0.0093s/iter; left time: 8.8354s
Updating learning rate to 0.00021668434409498268
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 0.7853784561157227
Epoch: 1, Steps: 131 | Train Loss: 0.4583614 Vali Loss: 0.2815404 Best vali loss: 0.2815404
	iters: 100, epoch: 2 | loss: 0.5987564
	speed: 0.0067s/iter; left time: 5.4833s
Updating learning rate to 0.00019226947786000944
Validation loss decreased (0.2815 --> 0.2754).  Saving model state dict ...
Epoch: 2 cost time: 0.5174643993377686
Epoch: 2, Steps: 131 | Train Loss: 0.5987564 Vali Loss: 0.2753644 Best vali loss: 0.2753644
	iters: 100, epoch: 3 | loss: 0.5817984
	speed: 0.0071s/iter; left time: 4.8579s
Updating learning rate to 0.00015573004835804142
Epoch: 3 cost time: 0.5719735622406006
Epoch: 3, Steps: 131 | Train Loss: 0.5817984 Vali Loss: 0.2801303 Best vali loss: 0.2753644

best validation loss 0.2753643795554192

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0082296206554, 'e_layers': 2, 'learning_rate': 0.0002285355769, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4034043
	speed: 0.0096s/iter; left time: 9.1163s
Updating learning rate to 0.0002285355769
Validation loss decreased (inf --> 0.2760).  Saving model state dict ...
Epoch: 1 cost time: 0.8140294551849365
Epoch: 1, Steps: 131 | Train Loss: 0.4034043 Vali Loss: 0.2760481 Best vali loss: 0.2760481
	iters: 100, epoch: 2 | loss: 0.6423818
	speed: 0.0074s/iter; left time: 6.0598s
Updating learning rate to 0.00011426778845
Epoch: 2 cost time: 0.5851976871490479
Epoch: 2, Steps: 131 | Train Loss: 0.6423818 Vali Loss: 0.2795075 Best vali loss: 0.2760481
	iters: 100, epoch: 3 | loss: 0.3016035
	speed: 0.0072s/iter; left time: 4.9732s
Updating learning rate to 5.7133894225e-05
Epoch: 3 cost time: 0.5783922672271729
Epoch: 3, Steps: 131 | Train Loss: 0.3016035 Vali Loss: 0.2819703 Best vali loss: 0.2760481

best validation loss 0.2760481030447149

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0084216205378, 'e_layers': 2, 'learning_rate': 0.0002291130475, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4031009
	speed: 0.0095s/iter; left time: 8.9688s
Updating learning rate to 0.00022039295135826812
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.8089766502380371
Epoch: 1, Steps: 131 | Train Loss: 0.4031009 Vali Loss: 0.2760758 Best vali loss: 0.2760758
	iters: 100, epoch: 2 | loss: 0.6420726
	speed: 0.0074s/iter; left time: 6.0776s
Updating learning rate to 0.00019556021852278277
Epoch: 2 cost time: 0.5802476406097412
Epoch: 2, Steps: 131 | Train Loss: 0.6420726 Vali Loss: 0.2786640 Best vali loss: 0.2760758
	iters: 100, epoch: 3 | loss: 0.3073292
	speed: 0.0072s/iter; left time: 4.9228s
Updating learning rate to 0.00015839540745846294
Epoch: 3 cost time: 0.5689656734466553
Epoch: 3, Steps: 131 | Train Loss: 0.3073292 Vali Loss: 0.2801062 Best vali loss: 0.2760758

best validation loss 0.2760758118398485

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0077271786073, 'e_layers': 2, 'learning_rate': 0.000225257705, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3548511
	speed: 0.0094s/iter; left time: 5.2243s
Updating learning rate to 0.0001126288525
Epoch: 4 cost time: 0.7764022350311279
Epoch: 4, Steps: 131 | Train Loss: 0.3548511 Vali Loss: 0.3023156 Best vali loss: 0.2753644
	iters: 100, epoch: 5 | loss: 0.4430224
	speed: 0.0069s/iter; left time: 2.9204s
Updating learning rate to 6.952765664195858e-05
Epoch: 5 cost time: 0.539306640625
Epoch: 5, Steps: 131 | Train Loss: 0.4430224 Vali Loss: 0.2848827 Best vali loss: 0.2753644
	iters: 100, epoch: 6 | loss: 0.4671780
	speed: 0.0069s/iter; left time: 2.0409s
Updating learning rate to 3.298822713999057e-05
Epoch: 6 cost time: 0.5633654594421387
Epoch: 6, Steps: 131 | Train Loss: 0.4671780 Vali Loss: 0.2901158 Best vali loss: 0.2753644
	iters: 100, epoch: 7 | loss: 0.4629783
	speed: 0.0067s/iter; left time: 1.0913s
Updating learning rate to 8.573360905017332e-06
Epoch: 7 cost time: 0.523123025894165
Epoch: 7, Steps: 131 | Train Loss: 0.4629783 Vali Loss: 0.2875193 Best vali loss: 0.2753644
	iters: 100, epoch: 8 | loss: 0.3518901
	speed: 0.0065s/iter; left time: 0.2093s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.519376277923584
Epoch: 8, Steps: 131 | Train Loss: 0.3518901 Vali Loss: 0.2869681 Best vali loss: 0.2753644

best validation loss 0.2753643795554192

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0080866001955, 'e_layers': 2, 'learning_rate': 0.0002271911759, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5706640
	speed: 0.0108s/iter; left time: 10.2331s
Updating learning rate to 0.0002271911759
Validation loss decreased (inf --> 0.2801).  Saving model state dict ...
Epoch: 1 cost time: 0.9854388236999512
Epoch: 1, Steps: 131 | Train Loss: 0.5706640 Vali Loss: 0.2801085 Best vali loss: 0.2801085
	iters: 100, epoch: 2 | loss: 0.5243880
	speed: 0.0095s/iter; left time: 7.7657s
Updating learning rate to 0.00011359558795
Epoch: 2 cost time: 0.7606942653656006
Epoch: 2, Steps: 131 | Train Loss: 0.5243880 Vali Loss: 0.2847739 Best vali loss: 0.2801085
	iters: 100, epoch: 3 | loss: 0.4140931
	speed: 0.0093s/iter; left time: 6.4199s
Updating learning rate to 5.6797793975e-05
Epoch: 3 cost time: 0.7589888572692871
Epoch: 3, Steps: 131 | Train Loss: 0.4140931 Vali Loss: 0.2811898 Best vali loss: 0.2801085
	iters: 100, epoch: 4 | loss: 0.3659140
	speed: 0.0093s/iter; left time: 5.1433s
Updating learning rate to 2.83988969875e-05
Epoch: 4 cost time: 0.7574470043182373
Epoch: 4, Steps: 131 | Train Loss: 0.3659140 Vali Loss: 0.2830991 Best vali loss: 0.2801085
	iters: 100, epoch: 5 | loss: 0.5537363
	speed: 0.0093s/iter; left time: 3.9487s
Updating learning rate to 1.419944849375e-05
Epoch: 5 cost time: 0.7612974643707275
Epoch: 5, Steps: 131 | Train Loss: 0.5537363 Vali Loss: 0.2819423 Best vali loss: 0.2801085
	iters: 100, epoch: 6 | loss: 0.3373350
	speed: 0.0093s/iter; left time: 2.7235s
Updating learning rate to 7.099724246875e-06
Epoch: 6 cost time: 0.7621870040893555
Epoch: 6, Steps: 131 | Train Loss: 0.3373350 Vali Loss: 0.2825088 Best vali loss: 0.2801085
	iters: 100, epoch: 7 | loss: 0.2792687
	speed: 0.0093s/iter; left time: 1.5144s
Updating learning rate to 3.5498621234375e-06
Epoch: 7 cost time: 0.7652790546417236
Epoch: 7, Steps: 131 | Train Loss: 0.2792687 Vali Loss: 0.2834302 Best vali loss: 0.2801085
	iters: 100, epoch: 8 | loss: 0.3110995
	speed: 0.0093s/iter; left time: 0.2968s
Updating learning rate to 1.77493106171875e-06
Epoch: 8 cost time: 0.7565739154815674
Epoch: 8, Steps: 131 | Train Loss: 0.3110995 Vali Loss: 0.2836536 Best vali loss: 0.2801085

best validation loss 0.2801084635247968

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0077754701874, 'e_layers': 2, 'learning_rate': 0.0002292416941, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4036751
	speed: 0.0096s/iter; left time: 9.1025s
Updating learning rate to 0.0002292416941
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.8094072341918945
Epoch: 1, Steps: 131 | Train Loss: 0.4036751 Vali Loss: 0.2761481 Best vali loss: 0.2761481
	iters: 100, epoch: 2 | loss: 0.6382458
	speed: 0.0075s/iter; left time: 6.1032s
Updating learning rate to 0.00011462084705
Epoch: 2 cost time: 0.5922660827636719
Epoch: 2, Steps: 131 | Train Loss: 0.6382458 Vali Loss: 0.2783850 Best vali loss: 0.2761481
	iters: 100, epoch: 3 | loss: 0.3023448
	speed: 0.0074s/iter; left time: 5.0783s
Updating learning rate to 5.7310423525e-05
Epoch: 3 cost time: 0.5925664901733398
Epoch: 3, Steps: 131 | Train Loss: 0.3023448 Vali Loss: 0.2808127 Best vali loss: 0.2761481
	iters: 100, epoch: 4 | loss: 0.3389409
	speed: 0.0073s/iter; left time: 4.0375s
Updating learning rate to 2.86552117625e-05
Epoch: 4 cost time: 0.5807042121887207
Epoch: 4, Steps: 131 | Train Loss: 0.3389409 Vali Loss: 0.2783925 Best vali loss: 0.2761481
	iters: 100, epoch: 5 | loss: 0.4493068
	speed: 0.0073s/iter; left time: 3.1067s
Updating learning rate to 1.432760588125e-05
Epoch: 5 cost time: 0.5966026782989502
Epoch: 5, Steps: 131 | Train Loss: 0.4493068 Vali Loss: 0.2799469 Best vali loss: 0.2761481
	iters: 100, epoch: 6 | loss: 0.4219550
	speed: 0.0074s/iter; left time: 2.1622s
Updating learning rate to 7.163802940625e-06
Epoch: 6 cost time: 0.590813159942627
Epoch: 6, Steps: 131 | Train Loss: 0.4219550 Vali Loss: 0.2814833 Best vali loss: 0.2761481
	iters: 100, epoch: 7 | loss: 0.3767911
	speed: 0.0073s/iter; left time: 1.1839s
Updating learning rate to 3.5819014703125e-06
Epoch: 7 cost time: 0.5828163623809814
Epoch: 7, Steps: 131 | Train Loss: 0.3767911 Vali Loss: 0.2809101 Best vali loss: 0.2761481
	iters: 100, epoch: 8 | loss: 0.3106701
	speed: 0.0071s/iter; left time: 0.2281s
Updating learning rate to 1.79095073515625e-06
Epoch: 8 cost time: 0.5661053657531738
Epoch: 8, Steps: 131 | Train Loss: 0.3106701 Vali Loss: 0.2807446 Best vali loss: 0.2761481

best validation loss 0.27614805142801463

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009139284706, 'e_layers': 4, 'learning_rate': 0.0002406568729, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002314974160652401
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 1.160308837890625
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2808775 Best vali loss: 0.2808775
Updating learning rate to 0.00020541348983336955
Validation loss decreased (0.2809 --> 0.2769).  Saving model state dict ...
Epoch: 2 cost time: 0.9455687999725342
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2769464 Best vali loss: 0.2769464
Updating learning rate to 0.0001663761355218106
Epoch: 3 cost time: 0.9508962631225586
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2807007 Best vali loss: 0.2769464

best validation loss 0.2769463598373522

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0046875553557, 'e_layers': 4, 'learning_rate': 0.0008574476385, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0334748
	speed: 0.0106s/iter; left time: 43.4491s
	iters: 200, epoch: 1 | loss: 0.4764056
	speed: 0.0052s/iter; left time: 20.5585s
	iters: 300, epoch: 1 | loss: 0.4660871
	speed: 0.0052s/iter; left time: 20.2563s
	iters: 400, epoch: 1 | loss: 0.3302639
	speed: 0.0053s/iter; left time: 20.1607s
	iters: 500, epoch: 1 | loss: 1.0015115
	speed: 0.0052s/iter; left time: 19.3081s
Updating learning rate to 0.0008248129809551434
Validation loss decreased (inf --> 0.3313).  Saving model state dict ...
Epoch: 1 cost time: 3.0092437267303467
Epoch: 1, Steps: 523 | Train Loss: 0.6615486 Vali Loss: 0.3312790 Best vali loss: 0.3312790
	iters: 100, epoch: 2 | loss: 0.9184022
	speed: 0.0103s/iter; left time: 36.6123s
	iters: 200, epoch: 2 | loss: 0.5485198
	speed: 0.0049s/iter; left time: 17.1063s
	iters: 300, epoch: 2 | loss: 0.6965352
	speed: 0.0049s/iter; left time: 16.6413s
	iters: 400, epoch: 2 | loss: 0.3789055
	speed: 0.0050s/iter; left time: 16.1891s
	iters: 500, epoch: 2 | loss: 0.9052517
	speed: 0.0049s/iter; left time: 15.5838s
Updating learning rate to 0.0007318773390978706
Validation loss decreased (0.3313 --> 0.3210).  Saving model state dict ...
Epoch: 2 cost time: 2.624952554702759
Epoch: 2, Steps: 523 | Train Loss: 0.6895229 Vali Loss: 0.3210113 Best vali loss: 0.3210113
	iters: 100, epoch: 3 | loss: 0.5756637
	speed: 0.0104s/iter; left time: 31.5793s
	iters: 200, epoch: 3 | loss: 0.2511574
	speed: 0.0050s/iter; left time: 14.7847s
	iters: 300, epoch: 3 | loss: 0.5638603
	speed: 0.0050s/iter; left time: 14.2868s
	iters: 400, epoch: 3 | loss: 0.2847272
	speed: 0.0050s/iter; left time: 13.7906s
	iters: 500, epoch: 3 | loss: 0.2496228
	speed: 0.0050s/iter; left time: 13.2855s
Updating learning rate to 0.0005927893219372603
Epoch: 3 cost time: 2.660881757736206
Epoch: 3, Steps: 523 | Train Loss: 0.3850063 Vali Loss: 0.3284779 Best vali loss: 0.3210113

best validation loss 0.32101129035871684

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010131167679, 'e_layers': 4, 'learning_rate': 0.0002405574749, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023140180117635378
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 1.1653101444244385
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2808835 Best vali loss: 0.2808835
Updating learning rate to 0.00020532864833345133
Validation loss decreased (0.2809 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 0.9464569091796875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2766386 Best vali loss: 0.2766386
Updating learning rate to 0.00016630741753790546
Epoch: 3 cost time: 0.9420461654663086
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2801077 Best vali loss: 0.2766386

best validation loss 0.27663858034833294

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010131167679, 'e_layers': 4, 'learning_rate': 0.0002405574749, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00012027873745
Epoch: 4 cost time: 1.1710216999053955
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2774668 Best vali loss: 0.2766386
Updating learning rate to 7.425005736209454e-05
Epoch: 5 cost time: 0.9421591758728027
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2782130 Best vali loss: 0.2766386
Updating learning rate to 3.5228826566548654e-05
Epoch: 6 cost time: 0.9499084949493408
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2801163 Best vali loss: 0.2766386
Updating learning rate to 9.155673723646202e-06
Epoch: 7 cost time: 0.9499330520629883
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2795224 Best vali loss: 0.2766386
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9449923038482666
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2805654 Best vali loss: 0.2766386

best validation loss 0.27663858034833294

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008497112358, 'e_layers': 4, 'learning_rate': 0.0002416093206, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002416093206
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 1.167095422744751
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2809159 Best vali loss: 0.2809159
Updating learning rate to 0.0001208046603
Validation loss decreased (0.2809 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 0.9451272487640381
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2771542 Best vali loss: 0.2771542
Updating learning rate to 6.040233015e-05
Epoch: 3 cost time: 0.9510650634765625
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2787618 Best vali loss: 0.2771542
Updating learning rate to 3.0201165075e-05
Epoch: 4 cost time: 0.9430902004241943
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2817804 Best vali loss: 0.2771542
Updating learning rate to 1.51005825375e-05
Epoch: 5 cost time: 0.9449193477630615
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2841760 Best vali loss: 0.2771542
Updating learning rate to 7.55029126875e-06
Epoch: 6 cost time: 0.9455955028533936
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2809730 Best vali loss: 0.2771542
Updating learning rate to 3.775145634375e-06
Epoch: 7 cost time: 0.959418773651123
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2827489 Best vali loss: 0.2771542
Updating learning rate to 1.8875728171875e-06
Epoch: 8 cost time: 0.9467852115631104
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2829110 Best vali loss: 0.2771542

best validation loss 0.2771542335463173

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023127490055, 'e_layers': 1, 'learning_rate': 0.0017907228824, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017907228824
Validation loss decreased (inf --> 0.2870).  Saving model state dict ...
Epoch: 1 cost time: 0.48215484619140625
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2870142 Best vali loss: 0.2870142
Updating learning rate to 0.0008953614412
Epoch: 2 cost time: 0.2616894245147705
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2930027 Best vali loss: 0.2870142
Updating learning rate to 0.0004476807206
Epoch: 3 cost time: 0.2838160991668701
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2948994 Best vali loss: 0.2870142
Updating learning rate to 0.0002238403603
Epoch: 4 cost time: 0.2870755195617676
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2986233 Best vali loss: 0.2870142
Updating learning rate to 0.00011192018015
Epoch: 5 cost time: 0.27817869186401367
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3045263 Best vali loss: 0.2870142
Updating learning rate to 5.5960090075e-05
Epoch: 6 cost time: 0.28206944465637207
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3088843 Best vali loss: 0.2870142
Updating learning rate to 2.79800450375e-05
Epoch: 7 cost time: 0.2628297805786133
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3101610 Best vali loss: 0.2870142
Updating learning rate to 1.399002251875e-05
Epoch: 8 cost time: 0.2833256721496582
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3100159 Best vali loss: 0.2870142

best validation loss 0.2870141746010112

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009492050143, 'e_layers': 4, 'learning_rate': 0.0002414921959, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023230094647660803
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 1.1627535820007324
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2809124 Best vali loss: 0.2809124
Updating learning rate to 0.00020612648261226008
Validation loss decreased (0.2809 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 0.9489319324493408
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2766438 Best vali loss: 0.2766438
Updating learning rate to 0.00016695362915819734
Epoch: 3 cost time: 0.9490253925323486
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2809975 Best vali loss: 0.2766438

best validation loss 0.27664382928097814

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5050727
	speed: 0.0099s/iter; left time: 19.8480s
	iters: 200, epoch: 1 | loss: 0.5558906
	speed: 0.0046s/iter; left time: 8.6720s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.3355).  Saving model state dict ...
Epoch: 1 cost time: 1.4719724655151367
Epoch: 1, Steps: 262 | Train Loss: 0.5304817 Vali Loss: 0.3354548 Best vali loss: 0.3354548
	iters: 100, epoch: 2 | loss: 0.6314496
	speed: 0.0093s/iter; left time: 16.1078s
	iters: 200, epoch: 2 | loss: 0.6633098
	speed: 0.0041s/iter; left time: 6.6456s
Updating learning rate to 0.00164194791575
Validation loss decreased (0.3355 --> 0.3234).  Saving model state dict ...
Epoch: 2 cost time: 1.0838937759399414
Epoch: 2, Steps: 262 | Train Loss: 0.6473797 Vali Loss: 0.3234482 Best vali loss: 0.3234482
	iters: 100, epoch: 3 | loss: 0.4414787
	speed: 0.0090s/iter; left time: 13.2185s
	iters: 200, epoch: 3 | loss: 0.7161974
	speed: 0.0042s/iter; left time: 5.8235s
Updating learning rate to 0.000820973957875
Validation loss decreased (0.3234 --> 0.3230).  Saving model state dict ...
Epoch: 3 cost time: 1.1680347919464111
Epoch: 3, Steps: 262 | Train Loss: 0.5788381 Vali Loss: 0.3229915 Best vali loss: 0.3229915

best validation loss 0.3229915307728763

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008011143804, 'e_layers': 1, 'learning_rate': 0.0002400734691, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002400734691
Validation loss decreased (inf --> 0.2784).  Saving model state dict ...
Epoch: 1 cost time: 0.5406384468078613
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2784400 Best vali loss: 0.2784400
Updating learning rate to 0.00012003673455
Validation loss decreased (0.2784 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 0.3239865303039551
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2772094 Best vali loss: 0.2772094
Updating learning rate to 6.0018367275e-05
Validation loss decreased (0.2772 --> 0.2750).  Saving model state dict ...
Epoch: 3 cost time: 0.32611751556396484
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2749652 Best vali loss: 0.2749652

best validation loss 0.2749652265948228

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008011143804, 'e_layers': 1, 'learning_rate': 0.0002400734691, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.00091836375e-05
Epoch: 4 cost time: 0.5426716804504395
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2768514 Best vali loss: 0.2749652
Updating learning rate to 1.500459181875e-05
Epoch: 5 cost time: 0.31938934326171875
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2788777 Best vali loss: 0.2749652
Updating learning rate to 7.502295909375e-06
Epoch: 6 cost time: 0.3207824230194092
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2791553 Best vali loss: 0.2749652
Updating learning rate to 3.7511479546875e-06
Epoch: 7 cost time: 0.31380391120910645
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2791531 Best vali loss: 0.2749652
Updating learning rate to 1.87557397734375e-06
Epoch: 8 cost time: 0.32227087020874023
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2791486 Best vali loss: 0.2749652

best validation loss 0.2749652265948228

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084476017093, 'e_layers': 2, 'learning_rate': 0.000239118425, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7628940
	speed: 0.0094s/iter; left time: 38.2213s
	iters: 200, epoch: 1 | loss: 0.4918357
	speed: 0.0037s/iter; left time: 14.6551s
	iters: 300, epoch: 1 | loss: 0.7005149
	speed: 0.0037s/iter; left time: 14.2074s
	iters: 400, epoch: 1 | loss: 0.6641092
	speed: 0.0034s/iter; left time: 12.8293s
	iters: 500, epoch: 1 | loss: 0.4474361
	speed: 0.0033s/iter; left time: 11.9976s
Updating learning rate to 0.000239118425
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 2.08951997756958
Epoch: 1, Steps: 523 | Train Loss: 0.6133580 Vali Loss: 0.2791657 Best vali loss: 0.2791657
	iters: 100, epoch: 2 | loss: 0.3483416
	speed: 0.0074s/iter; left time: 26.4744s
	iters: 200, epoch: 2 | loss: 0.6099730
	speed: 0.0030s/iter; left time: 10.2506s
	iters: 300, epoch: 2 | loss: 0.2668720
	speed: 0.0030s/iter; left time: 10.1495s
	iters: 400, epoch: 2 | loss: 0.3067049
	speed: 0.0031s/iter; left time: 9.9569s
	iters: 500, epoch: 2 | loss: 0.4761087
	speed: 0.0030s/iter; left time: 9.6222s
Updating learning rate to 0.0001195592125
Validation loss decreased (0.2792 --> 0.2709).  Saving model state dict ...
Epoch: 2 cost time: 1.6225848197937012
Epoch: 2, Steps: 523 | Train Loss: 0.4016000 Vali Loss: 0.2709064 Best vali loss: 0.2709064
	iters: 100, epoch: 3 | loss: 0.4207093
	speed: 0.0079s/iter; left time: 24.1355s
	iters: 200, epoch: 3 | loss: 0.3263216
	speed: 0.0035s/iter; left time: 10.4154s
	iters: 300, epoch: 3 | loss: 0.2069758
	speed: 0.0036s/iter; left time: 10.1022s
	iters: 400, epoch: 3 | loss: 0.6667447
	speed: 0.0036s/iter; left time: 9.7343s
	iters: 500, epoch: 3 | loss: 0.3740148
	speed: 0.0036s/iter; left time: 9.4104s
Updating learning rate to 5.977960625e-05
Epoch: 3 cost time: 1.897695779800415
Epoch: 3, Steps: 523 | Train Loss: 0.3989533 Vali Loss: 0.2720065 Best vali loss: 0.2709064
	iters: 100, epoch: 4 | loss: 0.5086128
	speed: 0.0073s/iter; left time: 18.3533s
	iters: 200, epoch: 4 | loss: 0.4631957
	speed: 0.0030s/iter; left time: 7.2564s
	iters: 300, epoch: 4 | loss: 0.5794242
	speed: 0.0030s/iter; left time: 6.9097s
	iters: 400, epoch: 4 | loss: 0.6563384
	speed: 0.0032s/iter; left time: 7.1178s
	iters: 500, epoch: 4 | loss: 0.3807147
	speed: 0.0031s/iter; left time: 6.6313s
Updating learning rate to 2.9889803125e-05
Epoch: 4 cost time: 1.6503877639770508
Epoch: 4, Steps: 523 | Train Loss: 0.5176571 Vali Loss: 0.2781619 Best vali loss: 0.2709064
	iters: 100, epoch: 5 | loss: 0.4032396
	speed: 0.0076s/iter; left time: 15.0511s
	iters: 200, epoch: 5 | loss: 0.5100064
	speed: 0.0033s/iter; left time: 6.3196s
	iters: 300, epoch: 5 | loss: 0.3328198
	speed: 0.0033s/iter; left time: 5.9742s
	iters: 400, epoch: 5 | loss: 0.2280031
	speed: 0.0033s/iter; left time: 5.6693s
	iters: 500, epoch: 5 | loss: 0.5999366
	speed: 0.0034s/iter; left time: 5.3576s
Updating learning rate to 1.49449015625e-05
Epoch: 5 cost time: 1.7868852615356445
Epoch: 5, Steps: 523 | Train Loss: 0.4148011 Vali Loss: 0.2805036 Best vali loss: 0.2709064
	iters: 100, epoch: 6 | loss: 0.2400942
	speed: 0.0076s/iter; left time: 11.2337s
	iters: 200, epoch: 6 | loss: 0.3845632
	speed: 0.0035s/iter; left time: 4.7607s
	iters: 300, epoch: 6 | loss: 0.5352852
	speed: 0.0035s/iter; left time: 4.4124s
	iters: 400, epoch: 6 | loss: 0.2305817
	speed: 0.0035s/iter; left time: 4.0975s
	iters: 500, epoch: 6 | loss: 0.3514708
	speed: 0.0035s/iter; left time: 3.7708s
Updating learning rate to 7.47245078125e-06
Epoch: 6 cost time: 1.870084524154663
Epoch: 6, Steps: 523 | Train Loss: 0.3483990 Vali Loss: 0.2839621 Best vali loss: 0.2709064
	iters: 100, epoch: 7 | loss: 0.7036214
	speed: 0.0074s/iter; left time: 7.0389s
	iters: 200, epoch: 7 | loss: 0.2113027
	speed: 0.0033s/iter; left time: 2.8021s
	iters: 300, epoch: 7 | loss: 0.4355975
	speed: 0.0033s/iter; left time: 2.4873s
	iters: 400, epoch: 7 | loss: 0.4046327
	speed: 0.0034s/iter; left time: 2.1726s
	iters: 500, epoch: 7 | loss: 0.3188793
	speed: 0.0034s/iter; left time: 1.8805s
Updating learning rate to 3.736225390625e-06
Epoch: 7 cost time: 1.79231595993042
Epoch: 7, Steps: 523 | Train Loss: 0.4148067 Vali Loss: 0.2877078 Best vali loss: 0.2709064
	iters: 100, epoch: 8 | loss: 0.3170052
	speed: 0.0077s/iter; left time: 3.2857s
	iters: 200, epoch: 8 | loss: 0.2789166
	speed: 0.0035s/iter; left time: 1.1263s
	iters: 300, epoch: 8 | loss: 0.3731549
	speed: 0.0035s/iter; left time: 0.7791s
	iters: 400, epoch: 8 | loss: 0.2262696
	speed: 0.0035s/iter; left time: 0.4354s
	iters: 500, epoch: 8 | loss: 0.5786780
	speed: 0.0035s/iter; left time: 0.0830s
Updating learning rate to 1.8681126953125e-06
Epoch: 8 cost time: 1.8629705905914307
Epoch: 8, Steps: 523 | Train Loss: 0.3548049 Vali Loss: 0.2900382 Best vali loss: 0.2709064

best validation loss 0.2709063652635463

[INFO][abstract_intensifier.py:595] Added config 99599f and rejected config a5362b as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084455031916, 'e_layers': 2, 'learning_rate': 0.0002415612132, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7634145
	speed: 0.0094s/iter; left time: 38.2499s
	iters: 200, epoch: 1 | loss: 0.4921302
	speed: 0.0035s/iter; left time: 14.0240s
	iters: 300, epoch: 1 | loss: 0.7017255
	speed: 0.0035s/iter; left time: 13.6755s
	iters: 400, epoch: 1 | loss: 0.6512007
	speed: 0.0035s/iter; left time: 13.4361s
	iters: 500, epoch: 1 | loss: 0.4433740
	speed: 0.0035s/iter; left time: 12.9511s
Updating learning rate to 0.0002415612132
Validation loss decreased (inf --> 0.3022).  Saving model state dict ...
Epoch: 1 cost time: 2.1125943660736084
Epoch: 1, Steps: 523 | Train Loss: 0.6103690 Vali Loss: 0.3022032 Best vali loss: 0.3022032
	iters: 100, epoch: 2 | loss: 0.3440822
	speed: 0.0079s/iter; left time: 28.2283s
	iters: 200, epoch: 2 | loss: 0.6470087
	speed: 0.0035s/iter; left time: 12.1577s
	iters: 300, epoch: 2 | loss: 0.2676426
	speed: 0.0035s/iter; left time: 11.8133s
	iters: 400, epoch: 2 | loss: 0.3101659
	speed: 0.0035s/iter; left time: 11.2757s
	iters: 500, epoch: 2 | loss: 0.5119309
	speed: 0.0033s/iter; left time: 10.5814s
Updating learning rate to 0.0001207806066
Validation loss decreased (0.3022 --> 0.2860).  Saving model state dict ...
Epoch: 2 cost time: 1.8491990566253662
Epoch: 2, Steps: 523 | Train Loss: 0.4161661 Vali Loss: 0.2860233 Best vali loss: 0.2860233
	iters: 100, epoch: 3 | loss: 0.4226702
	speed: 0.0077s/iter; left time: 23.4395s
	iters: 200, epoch: 3 | loss: 0.2487325
	speed: 0.0033s/iter; left time: 9.8076s
	iters: 300, epoch: 3 | loss: 0.2133407
	speed: 0.0034s/iter; left time: 9.5174s
	iters: 400, epoch: 3 | loss: 0.6576101
	speed: 0.0036s/iter; left time: 9.7831s
	iters: 500, epoch: 3 | loss: 0.3955649
	speed: 0.0036s/iter; left time: 9.4160s
Updating learning rate to 6.03903033e-05
Validation loss decreased (0.2860 --> 0.2850).  Saving model state dict ...
Epoch: 3 cost time: 1.8336448669433594
Epoch: 3, Steps: 523 | Train Loss: 0.3875837 Vali Loss: 0.2849882 Best vali loss: 0.2849882
	iters: 100, epoch: 4 | loss: 0.4812860
	speed: 0.0076s/iter; left time: 19.1187s
	iters: 200, epoch: 4 | loss: 0.4427305
	speed: 0.0030s/iter; left time: 7.3410s
	iters: 300, epoch: 4 | loss: 0.5834194
	speed: 0.0030s/iter; left time: 7.0352s
	iters: 400, epoch: 4 | loss: 0.6077651
	speed: 0.0030s/iter; left time: 6.7470s
	iters: 500, epoch: 4 | loss: 0.3594716
	speed: 0.0030s/iter; left time: 6.4034s
Updating learning rate to 3.019515165e-05
Epoch: 4 cost time: 1.623701572418213
Epoch: 4, Steps: 523 | Train Loss: 0.4949346 Vali Loss: 0.2882041 Best vali loss: 0.2849882
	iters: 100, epoch: 5 | loss: 0.3747365
	speed: 0.0077s/iter; left time: 15.3172s
	iters: 200, epoch: 5 | loss: 0.4899329
	speed: 0.0035s/iter; left time: 6.6311s
	iters: 300, epoch: 5 | loss: 0.2990621
	speed: 0.0035s/iter; left time: 6.2745s
	iters: 400, epoch: 5 | loss: 0.2390461
	speed: 0.0034s/iter; left time: 5.7083s
	iters: 500, epoch: 5 | loss: 0.5574514
	speed: 0.0033s/iter; left time: 5.1994s
Updating learning rate to 1.5097575825e-05
Epoch: 5 cost time: 1.8252294063568115
Epoch: 5, Steps: 523 | Train Loss: 0.3920458 Vali Loss: 0.2892505 Best vali loss: 0.2849882
	iters: 100, epoch: 6 | loss: 0.2382238
	speed: 0.0074s/iter; left time: 10.9434s
	iters: 200, epoch: 6 | loss: 0.3856197
	speed: 0.0033s/iter; left time: 4.5269s
	iters: 300, epoch: 6 | loss: 0.5252866
	speed: 0.0034s/iter; left time: 4.3052s
	iters: 400, epoch: 6 | loss: 0.2013140
	speed: 0.0033s/iter; left time: 3.8386s
	iters: 500, epoch: 6 | loss: 0.3344069
	speed: 0.0033s/iter; left time: 3.5275s
Updating learning rate to 7.5487879125e-06
Epoch: 6 cost time: 1.7796175479888916
Epoch: 6, Steps: 523 | Train Loss: 0.3369702 Vali Loss: 0.2880758 Best vali loss: 0.2849882
	iters: 100, epoch: 7 | loss: 0.6951398
	speed: 0.0075s/iter; left time: 7.0600s
	iters: 200, epoch: 7 | loss: 0.2077320
	speed: 0.0033s/iter; left time: 2.7956s
	iters: 300, epoch: 7 | loss: 0.4367715
	speed: 0.0033s/iter; left time: 2.4417s
	iters: 400, epoch: 7 | loss: 0.3944642
	speed: 0.0033s/iter; left time: 2.1078s
	iters: 500, epoch: 7 | loss: 0.3247748
	speed: 0.0032s/iter; left time: 1.7647s
Updating learning rate to 3.77439395625e-06
Epoch: 7 cost time: 1.7392401695251465
Epoch: 7, Steps: 523 | Train Loss: 0.4117765 Vali Loss: 0.2904859 Best vali loss: 0.2849882
	iters: 100, epoch: 8 | loss: 0.3121188
	speed: 0.0073s/iter; left time: 3.0978s
	iters: 200, epoch: 8 | loss: 0.2719412
	speed: 0.0032s/iter; left time: 1.0372s
	iters: 300, epoch: 8 | loss: 0.3341056
	speed: 0.0032s/iter; left time: 0.7214s
	iters: 400, epoch: 8 | loss: 0.2304303
	speed: 0.0032s/iter; left time: 0.4006s
	iters: 500, epoch: 8 | loss: 0.5604507
	speed: 0.0032s/iter; left time: 0.0776s
Updating learning rate to 1.887196978125e-06
Epoch: 8 cost time: 1.720189094543457
Epoch: 8, Steps: 523 | Train Loss: 0.3418093 Vali Loss: 0.2924011 Best vali loss: 0.2849882

best validation loss 0.28498819506979645

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005459653869797237
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 0.5348021984100342
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2832203 Best vali loss: 0.2832203
Updating learning rate to 0.0004844488434208944
Validation loss decreased (0.2832 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 0.3379974365234375
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2771840 Best vali loss: 0.2771840
Updating learning rate to 0.00039238282983148796
Epoch: 3 cost time: 0.32863473892211914
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2872559 Best vali loss: 0.2771840

best validation loss 0.2771839661064446

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014605862157, 'e_layers': 2, 'learning_rate': 0.000243012925, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5605652
	speed: 0.0107s/iter; left time: 10.1973s
Updating learning rate to 0.00023376379627160017
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9280788898468018
Epoch: 1, Steps: 131 | Train Loss: 0.5605652 Vali Loss: 0.2758111 Best vali loss: 0.2758111
	iters: 100, epoch: 2 | loss: 0.3267127
	speed: 0.0090s/iter; left time: 7.3345s
Updating learning rate to 0.00020742450609173894
Validation loss decreased (0.2758 --> 0.2737).  Saving model state dict ...
Epoch: 2 cost time: 0.7161850929260254
Epoch: 2, Steps: 131 | Train Loss: 0.3267127 Vali Loss: 0.2737120 Best vali loss: 0.2737120
	iters: 100, epoch: 3 | loss: 0.4724438
	speed: 0.0090s/iter; left time: 6.2120s
Updating learning rate to 0.00016800497262404006
Epoch: 3 cost time: 0.7058618068695068
Epoch: 3, Steps: 131 | Train Loss: 0.4724438 Vali Loss: 0.2883195 Best vali loss: 0.2737120

best validation loss 0.2737119653580489

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016872522236, 'e_layers': 2, 'learning_rate': 0.000242566638, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5604622
	speed: 0.0108s/iter; left time: 10.2827s
Updating learning rate to 0.000242566638
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9280364513397217
Epoch: 1, Steps: 131 | Train Loss: 0.5604622 Vali Loss: 0.2758196 Best vali loss: 0.2758196
	iters: 100, epoch: 2 | loss: 0.3285993
	speed: 0.0090s/iter; left time: 7.3311s
Updating learning rate to 0.000121283319
Validation loss decreased (0.2758 --> 0.2717).  Saving model state dict ...
Epoch: 2 cost time: 0.7080361843109131
Epoch: 2, Steps: 131 | Train Loss: 0.3285993 Vali Loss: 0.2717067 Best vali loss: 0.2717067
	iters: 100, epoch: 3 | loss: 0.4677055
	speed: 0.0090s/iter; left time: 6.1930s
Updating learning rate to 6.06416595e-05
Epoch: 3 cost time: 0.7085647583007812
Epoch: 3, Steps: 131 | Train Loss: 0.4677055 Vali Loss: 0.2822835 Best vali loss: 0.2717067

best validation loss 0.27170667252872194

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016872522236, 'e_layers': 2, 'learning_rate': 0.000242566638, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4200152
	speed: 0.0112s/iter; left time: 6.2537s
Updating learning rate to 3.032082975e-05
Epoch: 4 cost time: 0.92962646484375
Epoch: 4, Steps: 131 | Train Loss: 0.4200152 Vali Loss: 0.3071154 Best vali loss: 0.2717067
	iters: 100, epoch: 5 | loss: 0.2815134
	speed: 0.0087s/iter; left time: 3.6981s
Updating learning rate to 1.5160414875e-05
Epoch: 5 cost time: 0.7013189792633057
Epoch: 5, Steps: 131 | Train Loss: 0.2815134 Vali Loss: 0.3053546 Best vali loss: 0.2717067
	iters: 100, epoch: 6 | loss: 0.4326225
	speed: 0.0087s/iter; left time: 2.5602s
Updating learning rate to 7.5802074375e-06
Epoch: 6 cost time: 0.7078413963317871
Epoch: 6, Steps: 131 | Train Loss: 0.4326225 Vali Loss: 0.3033707 Best vali loss: 0.2717067
	iters: 100, epoch: 7 | loss: 0.4636963
	speed: 0.0087s/iter; left time: 1.4179s
Updating learning rate to 3.79010371875e-06
Epoch: 7 cost time: 0.7029125690460205
Epoch: 7, Steps: 131 | Train Loss: 0.4636963 Vali Loss: 0.3031778 Best vali loss: 0.2717067
	iters: 100, epoch: 8 | loss: 0.3263646
	speed: 0.0087s/iter; left time: 0.2771s
Updating learning rate to 1.895051859375e-06
Epoch: 8 cost time: 0.705369234085083
Epoch: 8, Steps: 131 | Train Loss: 0.3263646 Vali Loss: 0.3009327 Best vali loss: 0.2717067

best validation loss 0.27170667252872194

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4685515
	speed: 0.0084s/iter; left time: 16.7449s
	iters: 200, epoch: 1 | loss: 0.6288681
	speed: 0.0027s/iter; left time: 5.1375s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 0.965811014175415
Epoch: 1, Steps: 262 | Train Loss: 0.5487098 Vali Loss: 0.2812864 Best vali loss: 0.2812864
	iters: 100, epoch: 2 | loss: 0.3859093
	speed: 0.0064s/iter; left time: 11.0296s
	iters: 200, epoch: 2 | loss: 0.6056238
	speed: 0.0024s/iter; left time: 3.9449s
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 0.6753096580505371
Epoch: 2, Steps: 262 | Train Loss: 0.4957666 Vali Loss: 0.2835033 Best vali loss: 0.2812864
	iters: 100, epoch: 3 | loss: 0.6014801
	speed: 0.0064s/iter; left time: 9.4977s
	iters: 200, epoch: 3 | loss: 0.4612538
	speed: 0.0027s/iter; left time: 3.7173s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.7508907318115234
Epoch: 3, Steps: 262 | Train Loss: 0.5313669 Vali Loss: 0.2853745 Best vali loss: 0.2812864
	iters: 100, epoch: 4 | loss: 0.3968066
	speed: 0.0065s/iter; left time: 7.8313s
	iters: 200, epoch: 4 | loss: 0.4811746
	speed: 0.0027s/iter; left time: 3.0004s
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.7415261268615723
Epoch: 4, Steps: 262 | Train Loss: 0.4389906 Vali Loss: 0.2970574 Best vali loss: 0.2812864
	iters: 100, epoch: 5 | loss: 0.3920619
	speed: 0.0064s/iter; left time: 6.0891s
	iters: 200, epoch: 5 | loss: 0.2992450
	speed: 0.0024s/iter; left time: 2.0720s
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.6949830055236816
Epoch: 5, Steps: 262 | Train Loss: 0.3456535 Vali Loss: 0.2961481 Best vali loss: 0.2812864
	iters: 100, epoch: 6 | loss: 0.4867197
	speed: 0.0062s/iter; left time: 4.2252s
	iters: 200, epoch: 6 | loss: 0.3946985
	speed: 0.0026s/iter; left time: 1.5062s
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.7005786895751953
Epoch: 6, Steps: 262 | Train Loss: 0.4407091 Vali Loss: 0.3040890 Best vali loss: 0.2812864
	iters: 100, epoch: 7 | loss: 0.4573652
	speed: 0.0064s/iter; left time: 2.7146s
	iters: 200, epoch: 7 | loss: 0.2858271
	speed: 0.0027s/iter; left time: 0.8643s
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.7144584655761719
Epoch: 7, Steps: 262 | Train Loss: 0.3715962 Vali Loss: 0.3015124 Best vali loss: 0.2812864
	iters: 100, epoch: 8 | loss: 0.3099633
	speed: 0.0063s/iter; left time: 1.0259s
	iters: 200, epoch: 8 | loss: 0.3661200
	speed: 0.0025s/iter; left time: 0.1568s
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.6903877258300781
Epoch: 8, Steps: 262 | Train Loss: 0.3380416 Vali Loss: 0.3017481 Best vali loss: 0.2812864

best validation loss 0.2812864411803771

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6228932
	speed: 0.0120s/iter; left time: 11.3655s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.0730514526367188
Epoch: 1, Steps: 131 | Train Loss: 0.6228932 Vali Loss: 0.2812964 Best vali loss: 0.2812964
	iters: 100, epoch: 2 | loss: 0.4512645
	speed: 0.0098s/iter; left time: 8.0483s
Updating learning rate to 6.252043389458952e-05
Epoch: 2 cost time: 0.8110239505767822
Epoch: 2, Steps: 131 | Train Loss: 0.4512645 Vali Loss: 0.2815182 Best vali loss: 0.2812964
	iters: 100, epoch: 3 | loss: 0.5318508
	speed: 0.0096s/iter; left time: 6.5781s
Updating learning rate to 5.063887571827247e-05
Validation loss decreased (0.2813 --> 0.2801).  Saving model state dict ...
Epoch: 3 cost time: 0.7993226051330566
Epoch: 3, Steps: 131 | Train Loss: 0.5318508 Vali Loss: 0.2800840 Best vali loss: 0.2800840
	iters: 100, epoch: 4 | loss: 0.6210665
	speed: 0.0099s/iter; left time: 5.5257s
Updating learning rate to 3.662362225e-05
Epoch: 4 cost time: 0.8171412944793701
Epoch: 4, Steps: 131 | Train Loss: 0.6210665 Vali Loss: 0.2817625 Best vali loss: 0.2800840
	iters: 100, epoch: 5 | loss: 0.4864333
	speed: 0.0097s/iter; left time: 4.1052s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.2801 --> 0.2792).  Saving model state dict ...
Epoch: 5 cost time: 0.8037102222442627
Epoch: 5, Steps: 131 | Train Loss: 0.4864333 Vali Loss: 0.2792378 Best vali loss: 0.2792378
	iters: 100, epoch: 6 | loss: 0.6838748
	speed: 0.0101s/iter; left time: 2.9585s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.2792 --> 0.2775).  Saving model state dict ...
Epoch: 6 cost time: 0.8378958702087402
Epoch: 6, Steps: 131 | Train Loss: 0.6838748 Vali Loss: 0.2774889 Best vali loss: 0.2774889
	iters: 100, epoch: 7 | loss: 0.4988169
	speed: 0.0100s/iter; left time: 1.6340s
Updating learning rate to 2.7878072468000404e-06
Epoch: 7 cost time: 0.8280613422393799
Epoch: 7, Steps: 131 | Train Loss: 0.4988169 Vali Loss: 0.2777498 Best vali loss: 0.2774889
	iters: 100, epoch: 8 | loss: 0.6173629
	speed: 0.0098s/iter; left time: 0.3141s
Updating learning rate to 0.0
Validation loss decreased (0.2775 --> 0.2770).  Saving model state dict ...
Epoch: 8 cost time: 0.8154044151306152
Epoch: 8, Steps: 131 | Train Loss: 0.6173629 Vali Loss: 0.2769806 Best vali loss: 0.2769806

best validation loss 0.2769806071500789

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011222520419, 'e_layers': 2, 'learning_rate': 0.0002416863007, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5605300
	speed: 0.0104s/iter; left time: 9.8300s
Updating learning rate to 0.0002416863007
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.936612606048584
Epoch: 1, Steps: 131 | Train Loss: 0.5605300 Vali Loss: 0.2757148 Best vali loss: 0.2757148
	iters: 100, epoch: 2 | loss: 0.3258266
	speed: 0.0090s/iter; left time: 7.3263s
Updating learning rate to 0.00012084315035
Validation loss decreased (0.2757 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.7085952758789062
Epoch: 2, Steps: 131 | Train Loss: 0.3258266 Vali Loss: 0.2723120 Best vali loss: 0.2723120
	iters: 100, epoch: 3 | loss: 0.4613353
	speed: 0.0089s/iter; left time: 6.1449s
Updating learning rate to 6.0421575175e-05
Epoch: 3 cost time: 0.7043733596801758
Epoch: 3, Steps: 131 | Train Loss: 0.4613353 Vali Loss: 0.2819888 Best vali loss: 0.2723120

best validation loss 0.27231199261910766

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084536957161, 'e_layers': 2, 'learning_rate': 0.0002365640659, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7623397
	speed: 0.0088s/iter; left time: 35.9838s
	iters: 200, epoch: 1 | loss: 0.4919468
	speed: 0.0036s/iter; left time: 14.1845s
	iters: 300, epoch: 1 | loss: 0.6996809
	speed: 0.0036s/iter; left time: 13.8424s
	iters: 400, epoch: 1 | loss: 0.6525112
	speed: 0.0036s/iter; left time: 13.4416s
	iters: 500, epoch: 1 | loss: 0.4301616
	speed: 0.0035s/iter; left time: 12.8979s
Updating learning rate to 0.0002365640659
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 2.1092934608459473
Epoch: 1, Steps: 523 | Train Loss: 0.6073280 Vali Loss: 0.2806298 Best vali loss: 0.2806298
	iters: 100, epoch: 2 | loss: 0.3506727
	speed: 0.0082s/iter; left time: 29.2759s
	iters: 200, epoch: 2 | loss: 0.6097969
	speed: 0.0038s/iter; left time: 13.1625s
	iters: 300, epoch: 2 | loss: 0.2767055
	speed: 0.0037s/iter; left time: 12.4931s
	iters: 400, epoch: 2 | loss: 0.3236027
	speed: 0.0037s/iter; left time: 12.1697s
	iters: 500, epoch: 2 | loss: 0.6739963
	speed: 0.0036s/iter; left time: 11.2421s
Updating learning rate to 0.00011828203295
Epoch: 2 cost time: 1.969667673110962
Epoch: 2, Steps: 523 | Train Loss: 0.4469548 Vali Loss: 0.2856892 Best vali loss: 0.2806298
	iters: 100, epoch: 3 | loss: 0.4246511
	speed: 0.0072s/iter; left time: 21.7318s
	iters: 200, epoch: 3 | loss: 0.2582061
	speed: 0.0033s/iter; left time: 9.7570s
	iters: 300, epoch: 3 | loss: 0.2101630
	speed: 0.0033s/iter; left time: 9.2483s
	iters: 400, epoch: 3 | loss: 0.6687216
	speed: 0.0032s/iter; left time: 8.8133s
	iters: 500, epoch: 3 | loss: 0.3880597
	speed: 0.0031s/iter; left time: 8.2240s
Updating learning rate to 5.9141016475e-05
Epoch: 3 cost time: 1.716414213180542
Epoch: 3, Steps: 523 | Train Loss: 0.3899603 Vali Loss: 0.2823224 Best vali loss: 0.2806298

best validation loss 0.28062983495611027

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084476017093, 'e_layers': 2, 'learning_rate': 0.0002367503599, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7623629
	speed: 0.0087s/iter; left time: 35.5647s
	iters: 200, epoch: 1 | loss: 0.4919742
	speed: 0.0032s/iter; left time: 12.8243s
	iters: 300, epoch: 1 | loss: 0.6998230
	speed: 0.0032s/iter; left time: 12.2396s
	iters: 400, epoch: 1 | loss: 0.6574860
	speed: 0.0033s/iter; left time: 12.6470s
	iters: 500, epoch: 1 | loss: 0.4342137
	speed: 0.0033s/iter; left time: 12.3152s
Updating learning rate to 0.0002367503599
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 1.9881796836853027
Epoch: 1, Steps: 523 | Train Loss: 0.6091720 Vali Loss: 0.2835962 Best vali loss: 0.2835962
	iters: 100, epoch: 2 | loss: 0.3495233
	speed: 0.0077s/iter; left time: 27.3248s
	iters: 200, epoch: 2 | loss: 0.6297138
	speed: 0.0033s/iter; left time: 11.4502s
	iters: 300, epoch: 2 | loss: 0.2604819
	speed: 0.0032s/iter; left time: 10.9013s
	iters: 400, epoch: 2 | loss: 0.2998093
	speed: 0.0033s/iter; left time: 10.6640s
	iters: 500, epoch: 2 | loss: 0.4783894
	speed: 0.0033s/iter; left time: 10.5282s
Updating learning rate to 0.00011837517995
Validation loss decreased (0.2836 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 1.7607672214508057
Epoch: 2, Steps: 523 | Train Loss: 0.4035835 Vali Loss: 0.2829940 Best vali loss: 0.2829940
	iters: 100, epoch: 3 | loss: 0.4254568
	speed: 0.0074s/iter; left time: 22.5794s
	iters: 200, epoch: 3 | loss: 0.2473710
	speed: 0.0030s/iter; left time: 8.6786s
	iters: 300, epoch: 3 | loss: 0.2142946
	speed: 0.0032s/iter; left time: 9.0489s
	iters: 400, epoch: 3 | loss: 0.6720617
	speed: 0.0033s/iter; left time: 8.9238s
	iters: 500, epoch: 3 | loss: 0.4006099
	speed: 0.0035s/iter; left time: 9.1098s
Updating learning rate to 5.9187589975e-05
Validation loss decreased (0.2830 --> 0.2809).  Saving model state dict ...
Epoch: 3 cost time: 1.7023310661315918
Epoch: 3, Steps: 523 | Train Loss: 0.3919588 Vali Loss: 0.2809248 Best vali loss: 0.2809248

best validation loss 0.28092478025620116

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011222520419, 'e_layers': 2, 'learning_rate': 0.0002416863007, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4217430
	speed: 0.0107s/iter; left time: 5.9714s
Updating learning rate to 3.02107875875e-05
Epoch: 4 cost time: 0.9376773834228516
Epoch: 4, Steps: 131 | Train Loss: 0.4217430 Vali Loss: 0.3066633 Best vali loss: 0.2723120
	iters: 100, epoch: 5 | loss: 0.2842143
	speed: 0.0088s/iter; left time: 3.7331s
Updating learning rate to 1.510539379375e-05
Epoch: 5 cost time: 0.7121312618255615
Epoch: 5, Steps: 131 | Train Loss: 0.2842143 Vali Loss: 0.3044517 Best vali loss: 0.2723120
	iters: 100, epoch: 6 | loss: 0.4344659
	speed: 0.0087s/iter; left time: 2.5626s
Updating learning rate to 7.552696896875e-06
Epoch: 6 cost time: 0.7048699855804443
Epoch: 6, Steps: 131 | Train Loss: 0.4344659 Vali Loss: 0.3048477 Best vali loss: 0.2723120
	iters: 100, epoch: 7 | loss: 0.4670660
	speed: 0.0087s/iter; left time: 1.4101s
Updating learning rate to 3.7763484484375e-06
Epoch: 7 cost time: 0.6971468925476074
Epoch: 7, Steps: 131 | Train Loss: 0.4670660 Vali Loss: 0.3051965 Best vali loss: 0.2723120
	iters: 100, epoch: 8 | loss: 0.3269700
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 1.88817422421875e-06
Epoch: 8 cost time: 0.7023978233337402
Epoch: 8, Steps: 131 | Train Loss: 0.3269700 Vali Loss: 0.3028675 Best vali loss: 0.2723120

best validation loss 0.27231199261910766

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.008450965823, 'e_layers': 2, 'learning_rate': 0.0002355299584, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7618743
	speed: 0.0089s/iter; left time: 36.3529s
	iters: 200, epoch: 1 | loss: 0.4920239
	speed: 0.0035s/iter; left time: 13.9600s
	iters: 300, epoch: 1 | loss: 0.7023415
	speed: 0.0035s/iter; left time: 13.6377s
	iters: 400, epoch: 1 | loss: 0.6655236
	speed: 0.0035s/iter; left time: 13.3219s
	iters: 500, epoch: 1 | loss: 0.4337393
	speed: 0.0035s/iter; left time: 12.8979s
Updating learning rate to 0.0002355299584
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 2.1031558513641357
Epoch: 1, Steps: 523 | Train Loss: 0.6111005 Vali Loss: 0.2796048 Best vali loss: 0.2796048
	iters: 100, epoch: 2 | loss: 0.3474193
	speed: 0.0080s/iter; left time: 28.6148s
	iters: 200, epoch: 2 | loss: 0.6696487
	speed: 0.0036s/iter; left time: 12.3412s
	iters: 300, epoch: 2 | loss: 0.2777312
	speed: 0.0036s/iter; left time: 11.9844s
	iters: 400, epoch: 2 | loss: 0.3065997
	speed: 0.0032s/iter; left time: 10.4771s
	iters: 500, epoch: 2 | loss: 0.4550248
	speed: 0.0030s/iter; left time: 9.4928s
Updating learning rate to 0.0001177649792
Epoch: 2 cost time: 1.7953732013702393
Epoch: 2, Steps: 523 | Train Loss: 0.4112847 Vali Loss: 0.2818276 Best vali loss: 0.2796048
	iters: 100, epoch: 3 | loss: 0.4168848
	speed: 0.0075s/iter; left time: 22.8693s
	iters: 200, epoch: 3 | loss: 0.2479466
	speed: 0.0035s/iter; left time: 10.4241s
	iters: 300, epoch: 3 | loss: 0.2049461
	speed: 0.0036s/iter; left time: 10.1405s
	iters: 400, epoch: 3 | loss: 0.6594828
	speed: 0.0036s/iter; left time: 9.8131s
	iters: 500, epoch: 3 | loss: 0.3739789
	speed: 0.0033s/iter; left time: 8.8141s
Updating learning rate to 5.88824896e-05
Validation loss decreased (0.2796 --> 0.2764).  Saving model state dict ...
Epoch: 3 cost time: 1.8642807006835938
Epoch: 3, Steps: 523 | Train Loss: 0.3806479 Vali Loss: 0.2763589 Best vali loss: 0.2763589
	iters: 100, epoch: 4 | loss: 0.5053298
	speed: 0.0079s/iter; left time: 19.8338s
	iters: 200, epoch: 4 | loss: 0.4579571
	speed: 0.0033s/iter; left time: 8.0513s
	iters: 300, epoch: 4 | loss: 0.5832109
	speed: 0.0033s/iter; left time: 7.6680s
	iters: 400, epoch: 4 | loss: 0.6541331
	speed: 0.0033s/iter; left time: 7.3592s
	iters: 500, epoch: 4 | loss: 0.3777000
	speed: 0.0033s/iter; left time: 7.0589s
Updating learning rate to 2.94412448e-05
Epoch: 4 cost time: 1.7846605777740479
Epoch: 4, Steps: 523 | Train Loss: 0.5156662 Vali Loss: 0.2807268 Best vali loss: 0.2763589
	iters: 100, epoch: 5 | loss: 0.4177616
	speed: 0.0074s/iter; left time: 14.7379s
	iters: 200, epoch: 5 | loss: 0.5090263
	speed: 0.0033s/iter; left time: 6.1823s
	iters: 300, epoch: 5 | loss: 0.3315627
	speed: 0.0033s/iter; left time: 5.8977s
	iters: 400, epoch: 5 | loss: 0.2259867
	speed: 0.0033s/iter; left time: 5.6152s
	iters: 500, epoch: 5 | loss: 0.5997943
	speed: 0.0033s/iter; left time: 5.3001s
Updating learning rate to 1.47206224e-05
Epoch: 5 cost time: 1.7634224891662598
Epoch: 5, Steps: 523 | Train Loss: 0.4168263 Vali Loss: 0.2828136 Best vali loss: 0.2763589
	iters: 100, epoch: 6 | loss: 0.2355053
	speed: 0.0071s/iter; left time: 10.4274s
	iters: 200, epoch: 6 | loss: 0.3884163
	speed: 0.0030s/iter; left time: 4.1140s
	iters: 300, epoch: 6 | loss: 0.5407841
	speed: 0.0030s/iter; left time: 3.8077s
	iters: 400, epoch: 6 | loss: 0.2192602
	speed: 0.0030s/iter; left time: 3.5097s
	iters: 500, epoch: 6 | loss: 0.3527325
	speed: 0.0030s/iter; left time: 3.2092s
Updating learning rate to 7.3603112e-06
Epoch: 6 cost time: 1.613830804824829
Epoch: 6, Steps: 523 | Train Loss: 0.3473397 Vali Loss: 0.2896969 Best vali loss: 0.2763589
	iters: 100, epoch: 7 | loss: 0.7266970
	speed: 0.0071s/iter; left time: 6.7369s
	iters: 200, epoch: 7 | loss: 0.2111822
	speed: 0.0030s/iter; left time: 2.5483s
	iters: 300, epoch: 7 | loss: 0.4378741
	speed: 0.0030s/iter; left time: 2.2241s
	iters: 400, epoch: 7 | loss: 0.3899605
	speed: 0.0030s/iter; left time: 1.9293s
	iters: 500, epoch: 7 | loss: 0.3274514
	speed: 0.0030s/iter; left time: 1.6479s
Updating learning rate to 3.6801556e-06
Epoch: 7 cost time: 1.6035881042480469
Epoch: 7, Steps: 523 | Train Loss: 0.4186330 Vali Loss: 0.2913635 Best vali loss: 0.2763589
	iters: 100, epoch: 8 | loss: 0.3195733
	speed: 0.0073s/iter; left time: 3.1145s
	iters: 200, epoch: 8 | loss: 0.2800111
	speed: 0.0033s/iter; left time: 1.0684s
	iters: 300, epoch: 8 | loss: 0.3910154
	speed: 0.0030s/iter; left time: 0.6761s
	iters: 400, epoch: 8 | loss: 0.2379929
	speed: 0.0031s/iter; left time: 0.3855s
	iters: 500, epoch: 8 | loss: 0.5960971
	speed: 0.0034s/iter; left time: 0.0821s
Updating learning rate to 1.8400778e-06
Epoch: 8 cost time: 1.7332963943481445
Epoch: 8, Steps: 523 | Train Loss: 0.3649380 Vali Loss: 0.2943620 Best vali loss: 0.2763589

best validation loss 0.2763589220602923

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.008458210215, 'e_layers': 2, 'learning_rate': 0.0002385684094, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7627658
	speed: 0.0089s/iter; left time: 36.1755s
	iters: 200, epoch: 1 | loss: 0.4920540
	speed: 0.0035s/iter; left time: 14.0531s
	iters: 300, epoch: 1 | loss: 0.7003437
	speed: 0.0035s/iter; left time: 13.6757s
	iters: 400, epoch: 1 | loss: 0.6576139
	speed: 0.0035s/iter; left time: 13.2982s
	iters: 500, epoch: 1 | loss: 0.4399980
	speed: 0.0035s/iter; left time: 12.9268s
Updating learning rate to 0.0002385684094
Validation loss decreased (inf --> 0.2854).  Saving model state dict ...
Epoch: 1 cost time: 2.10384202003479
Epoch: 1, Steps: 523 | Train Loss: 0.6105551 Vali Loss: 0.2853551 Best vali loss: 0.2853551
	iters: 100, epoch: 2 | loss: 0.3536825
	speed: 0.0074s/iter; left time: 26.4803s
	iters: 200, epoch: 2 | loss: 0.6038091
	speed: 0.0029s/iter; left time: 10.1150s
	iters: 300, epoch: 2 | loss: 0.2861392
	speed: 0.0029s/iter; left time: 9.8860s
	iters: 400, epoch: 2 | loss: 0.3219641
	speed: 0.0031s/iter; left time: 10.1159s
	iters: 500, epoch: 2 | loss: 0.4218483
	speed: 0.0033s/iter; left time: 10.2867s
Updating learning rate to 0.0001192842047
Epoch: 2 cost time: 1.635260820388794
Epoch: 2, Steps: 523 | Train Loss: 0.3974886 Vali Loss: 0.2866200 Best vali loss: 0.2853551
	iters: 100, epoch: 3 | loss: 0.4218524
	speed: 0.0077s/iter; left time: 23.3017s
	iters: 200, epoch: 3 | loss: 0.2745010
	speed: 0.0035s/iter; left time: 10.3145s
	iters: 300, epoch: 3 | loss: 0.2084020
	speed: 0.0034s/iter; left time: 9.5205s
	iters: 400, epoch: 3 | loss: 0.6702485
	speed: 0.0033s/iter; left time: 9.1648s
	iters: 500, epoch: 3 | loss: 0.3925630
	speed: 0.0033s/iter; left time: 8.7896s
Updating learning rate to 5.964210235e-05
Validation loss decreased (0.2854 --> 0.2738).  Saving model state dict ...
Epoch: 3 cost time: 1.8165345191955566
Epoch: 3, Steps: 523 | Train Loss: 0.3935134 Vali Loss: 0.2737678 Best vali loss: 0.2737678
	iters: 100, epoch: 4 | loss: 0.5083708
	speed: 0.0077s/iter; left time: 19.3350s
	iters: 200, epoch: 4 | loss: 0.4531605
	speed: 0.0030s/iter; left time: 7.2016s
	iters: 300, epoch: 4 | loss: 0.5730812
	speed: 0.0031s/iter; left time: 7.1695s
	iters: 400, epoch: 4 | loss: 0.6074700
	speed: 0.0032s/iter; left time: 7.1730s
	iters: 500, epoch: 4 | loss: 0.4056020
	speed: 0.0031s/iter; left time: 6.4600s
Updating learning rate to 2.9821051175e-05
Epoch: 4 cost time: 1.6653046607971191
Epoch: 4, Steps: 523 | Train Loss: 0.5095369 Vali Loss: 0.2810577 Best vali loss: 0.2737678
	iters: 100, epoch: 5 | loss: 0.3988183
	speed: 0.0071s/iter; left time: 14.1708s
	iters: 200, epoch: 5 | loss: 0.5015582
	speed: 0.0030s/iter; left time: 5.6933s
	iters: 300, epoch: 5 | loss: 0.3516556
	speed: 0.0031s/iter; left time: 5.4873s
	iters: 400, epoch: 5 | loss: 0.2291635
	speed: 0.0033s/iter; left time: 5.6374s
	iters: 500, epoch: 5 | loss: 0.5878405
	speed: 0.0034s/iter; left time: 5.3741s
Updating learning rate to 1.49105255875e-05
Epoch: 5 cost time: 1.7001209259033203
Epoch: 5, Steps: 523 | Train Loss: 0.4138072 Vali Loss: 0.2863352 Best vali loss: 0.2737678
	iters: 100, epoch: 6 | loss: 0.2333004
	speed: 0.0074s/iter; left time: 10.8827s
	iters: 200, epoch: 6 | loss: 0.3834812
	speed: 0.0033s/iter; left time: 4.5316s
	iters: 300, epoch: 6 | loss: 0.5282589
	speed: 0.0033s/iter; left time: 4.2127s
	iters: 400, epoch: 6 | loss: 0.2054428
	speed: 0.0033s/iter; left time: 3.8392s
	iters: 500, epoch: 6 | loss: 0.3401399
	speed: 0.0033s/iter; left time: 3.5027s
Updating learning rate to 7.45526279375e-06
Epoch: 6 cost time: 1.76615571975708
Epoch: 6, Steps: 523 | Train Loss: 0.3381246 Vali Loss: 0.2901952 Best vali loss: 0.2737678
	iters: 100, epoch: 7 | loss: 0.6915559
	speed: 0.0077s/iter; left time: 7.2620s
	iters: 200, epoch: 7 | loss: 0.2108764
	speed: 0.0033s/iter; left time: 2.8211s
	iters: 300, epoch: 7 | loss: 0.4298461
	speed: 0.0032s/iter; left time: 2.3647s
	iters: 400, epoch: 7 | loss: 0.3880361
	speed: 0.0030s/iter; left time: 1.9553s
	iters: 500, epoch: 7 | loss: 0.3202941
	speed: 0.0030s/iter; left time: 1.6508s
Updating learning rate to 3.727631396875e-06
Epoch: 7 cost time: 1.6955327987670898
Epoch: 7, Steps: 523 | Train Loss: 0.4081217 Vali Loss: 0.2918900 Best vali loss: 0.2737678
	iters: 100, epoch: 8 | loss: 0.3153165
	speed: 0.0071s/iter; left time: 3.0275s
	iters: 200, epoch: 8 | loss: 0.2801774
	speed: 0.0030s/iter; left time: 0.9808s
	iters: 300, epoch: 8 | loss: 0.3445546
	speed: 0.0030s/iter; left time: 0.6727s
	iters: 400, epoch: 8 | loss: 0.2239381
	speed: 0.0030s/iter; left time: 0.3763s
	iters: 500, epoch: 8 | loss: 0.5744805
	speed: 0.0030s/iter; left time: 0.0731s
Updating learning rate to 1.8638156984375e-06
Epoch: 8 cost time: 1.6283683776855469
Epoch: 8, Steps: 523 | Train Loss: 0.3476934 Vali Loss: 0.2953529 Best vali loss: 0.2737678

best validation loss 0.27376775001894366

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0085136024295, 'e_layers': 2, 'learning_rate': 0.0002351803712, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7618204
	speed: 0.0089s/iter; left time: 36.3144s
	iters: 200, epoch: 1 | loss: 0.4922232
	speed: 0.0035s/iter; left time: 13.9842s
	iters: 300, epoch: 1 | loss: 0.6996773
	speed: 0.0035s/iter; left time: 13.6327s
	iters: 400, epoch: 1 | loss: 0.6591808
	speed: 0.0035s/iter; left time: 13.2741s
	iters: 500, epoch: 1 | loss: 0.4616237
	speed: 0.0035s/iter; left time: 12.9727s
Updating learning rate to 0.0002351803712
Validation loss decreased (inf --> 0.2732).  Saving model state dict ...
Epoch: 1 cost time: 2.103991985321045
Epoch: 1, Steps: 523 | Train Loss: 0.6149051 Vali Loss: 0.2732278 Best vali loss: 0.2732278
	iters: 100, epoch: 2 | loss: 0.3371197
	speed: 0.0079s/iter; left time: 28.0119s
	iters: 200, epoch: 2 | loss: 0.6176409
	speed: 0.0031s/iter; left time: 10.8498s
	iters: 300, epoch: 2 | loss: 0.2627237
	speed: 0.0031s/iter; left time: 10.3196s
	iters: 400, epoch: 2 | loss: 0.3063074
	speed: 0.0031s/iter; left time: 9.9507s
	iters: 500, epoch: 2 | loss: 0.4769924
	speed: 0.0032s/iter; left time: 10.1227s
Updating learning rate to 0.0001175901856
Epoch: 2 cost time: 1.701594352722168
Epoch: 2, Steps: 523 | Train Loss: 0.4001568 Vali Loss: 0.2831765 Best vali loss: 0.2732278
	iters: 100, epoch: 3 | loss: 0.4504925
	speed: 0.0071s/iter; left time: 21.6296s
	iters: 200, epoch: 3 | loss: 0.2493667
	speed: 0.0030s/iter; left time: 8.9405s
	iters: 300, epoch: 3 | loss: 0.2157474
	speed: 0.0033s/iter; left time: 9.3524s
	iters: 400, epoch: 3 | loss: 0.6702086
	speed: 0.0033s/iter; left time: 9.0081s
	iters: 500, epoch: 3 | loss: 0.4001714
	speed: 0.0033s/iter; left time: 8.6276s
Updating learning rate to 5.87950928e-05
Epoch: 3 cost time: 1.713191270828247
Epoch: 3, Steps: 523 | Train Loss: 0.3971973 Vali Loss: 0.2825386 Best vali loss: 0.2732278

best validation loss 0.27322782322836436

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0088297427064, 'e_layers': 2, 'learning_rate': 0.0002347561854, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7619064
	speed: 0.0089s/iter; left time: 36.1831s
	iters: 200, epoch: 1 | loss: 0.4921079
	speed: 0.0036s/iter; left time: 14.2610s
	iters: 300, epoch: 1 | loss: 0.6997408
	speed: 0.0036s/iter; left time: 13.8083s
	iters: 400, epoch: 1 | loss: 0.6531712
	speed: 0.0036s/iter; left time: 13.5666s
	iters: 500, epoch: 1 | loss: 0.4650324
	speed: 0.0036s/iter; left time: 13.1925s
Updating learning rate to 0.0002347561854
Validation loss decreased (inf --> 0.2738).  Saving model state dict ...
Epoch: 1 cost time: 2.1359994411468506
Epoch: 1, Steps: 523 | Train Loss: 0.6143917 Vali Loss: 0.2737630 Best vali loss: 0.2737630
	iters: 100, epoch: 2 | loss: 0.3534709
	speed: 0.0074s/iter; left time: 26.4116s
	iters: 200, epoch: 2 | loss: 0.6195331
	speed: 0.0031s/iter; left time: 10.7556s
	iters: 300, epoch: 2 | loss: 0.2865462
	speed: 0.0033s/iter; left time: 11.1362s
	iters: 400, epoch: 2 | loss: 0.3024973
	speed: 0.0033s/iter; left time: 10.7483s
	iters: 500, epoch: 2 | loss: 0.8681538
	speed: 0.0033s/iter; left time: 10.4140s
Updating learning rate to 0.0001173780927
Epoch: 2 cost time: 1.713841199874878
Epoch: 2, Steps: 523 | Train Loss: 0.4860402 Vali Loss: 0.2872735 Best vali loss: 0.2737630
	iters: 100, epoch: 3 | loss: 0.4160442
	speed: 0.0074s/iter; left time: 22.6120s
	iters: 200, epoch: 3 | loss: 0.2714346
	speed: 0.0033s/iter; left time: 9.8160s
	iters: 300, epoch: 3 | loss: 0.2129044
	speed: 0.0033s/iter; left time: 9.4234s
	iters: 400, epoch: 3 | loss: 0.6530468
	speed: 0.0033s/iter; left time: 9.0726s
	iters: 500, epoch: 3 | loss: 0.3812965
	speed: 0.0033s/iter; left time: 8.7537s
Updating learning rate to 5.868904635e-05
Epoch: 3 cost time: 1.7739205360412598
Epoch: 3, Steps: 523 | Train Loss: 0.3869453 Vali Loss: 0.2953688 Best vali loss: 0.2737630

best validation loss 0.2737629659980946

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011419354918, 'e_layers': 2, 'learning_rate': 0.000243012925, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5606393
	speed: 0.0104s/iter; left time: 9.8972s
Updating learning rate to 0.00023376379627160017
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9406654834747314
Epoch: 1, Steps: 131 | Train Loss: 0.5606393 Vali Loss: 0.2757898 Best vali loss: 0.2757898
	iters: 100, epoch: 2 | loss: 0.3265777
	speed: 0.0089s/iter; left time: 7.2965s
Updating learning rate to 0.00020742450609173894
Validation loss decreased (0.2758 --> 0.2724).  Saving model state dict ...
Epoch: 2 cost time: 0.7017865180969238
Epoch: 2, Steps: 131 | Train Loss: 0.3265777 Vali Loss: 0.2723774 Best vali loss: 0.2723774
	iters: 100, epoch: 3 | loss: 0.4688227
	speed: 0.0090s/iter; left time: 6.1714s
Updating learning rate to 0.00016800497262404006
Epoch: 3 cost time: 0.7040207386016846
Epoch: 3, Steps: 131 | Train Loss: 0.4688227 Vali Loss: 0.2965715 Best vali loss: 0.2723774

best validation loss 0.272377415832067

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011419354918, 'e_layers': 2, 'learning_rate': 0.000243012925, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4031492
	speed: 0.0107s/iter; left time: 5.9551s
Updating learning rate to 0.0001215064625
Epoch: 4 cost time: 0.9351234436035156
Epoch: 4, Steps: 131 | Train Loss: 0.4031492 Vali Loss: 0.2912180 Best vali loss: 0.2723774
	iters: 100, epoch: 5 | loss: 0.2771690
	speed: 0.0088s/iter; left time: 3.7412s
Updating learning rate to 7.500795237595994e-05
Epoch: 5 cost time: 0.7056598663330078
Epoch: 5, Steps: 131 | Train Loss: 0.2771690 Vali Loss: 0.2893562 Best vali loss: 0.2723774
	iters: 100, epoch: 6 | loss: 0.3849831
	speed: 0.0087s/iter; left time: 2.5546s
Updating learning rate to 3.5588418908261065e-05
Epoch: 6 cost time: 0.7080652713775635
Epoch: 6, Steps: 131 | Train Loss: 0.3849831 Vali Loss: 0.2879484 Best vali loss: 0.2723774
	iters: 100, epoch: 7 | loss: 0.3948636
	speed: 0.0087s/iter; left time: 1.4210s
Updating learning rate to 9.249128728399807e-06
Epoch: 7 cost time: 0.7067747116088867
Epoch: 7, Steps: 131 | Train Loss: 0.3948636 Vali Loss: 0.3003027 Best vali loss: 0.2723774
	iters: 100, epoch: 8 | loss: 0.3034434
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.706059455871582
Epoch: 8, Steps: 131 | Train Loss: 0.3034434 Vali Loss: 0.3015856 Best vali loss: 0.2723774

best validation loss 0.272377415832067

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6915714
	speed: 0.0108s/iter; left time: 10.2763s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 1.0042331218719482
Epoch: 1, Steps: 131 | Train Loss: 0.6915714 Vali Loss: 0.3218369 Best vali loss: 0.3218369
	iters: 100, epoch: 2 | loss: 0.4748999
	speed: 0.0109s/iter; left time: 8.9352s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.3218 --> 0.3050).  Saving model state dict ...
Epoch: 2 cost time: 0.7823233604431152
Epoch: 2, Steps: 131 | Train Loss: 0.4748999 Vali Loss: 0.3050303 Best vali loss: 0.3050303
	iters: 100, epoch: 3 | loss: 0.6866489
	speed: 0.0094s/iter; left time: 6.4797s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.3050 --> 0.2987).  Saving model state dict ...
Epoch: 3 cost time: 0.7991292476654053
Epoch: 3, Steps: 131 | Train Loss: 0.6866489 Vali Loss: 0.2987203 Best vali loss: 0.2987203
	iters: 100, epoch: 4 | loss: 0.4876589
	speed: 0.0098s/iter; left time: 5.4247s
Updating learning rate to 7.5835271e-05
Validation loss decreased (0.2987 --> 0.2925).  Saving model state dict ...
Epoch: 4 cost time: 0.8223190307617188
Epoch: 4, Steps: 131 | Train Loss: 0.4876589 Vali Loss: 0.2925282 Best vali loss: 0.2925282
	iters: 100, epoch: 5 | loss: 0.4878523
	speed: 0.0086s/iter; left time: 3.6734s
Updating learning rate to 4.681436919938325e-05
Validation loss decreased (0.2925 --> 0.2906).  Saving model state dict ...
Epoch: 5 cost time: 0.6977207660675049
Epoch: 5, Steps: 131 | Train Loss: 0.4878523 Vali Loss: 0.2905559 Best vali loss: 0.2905559
	iters: 100, epoch: 6 | loss: 0.5823268
	speed: 0.0086s/iter; left time: 2.5237s
Updating learning rate to 2.221163662278047e-05
Validation loss decreased (0.2906 --> 0.2894).  Saving model state dict ...
Epoch: 6 cost time: 0.7153153419494629
Epoch: 6, Steps: 131 | Train Loss: 0.5823268 Vali Loss: 0.2893925 Best vali loss: 0.2893925
	iters: 100, epoch: 7 | loss: 0.3161128
	speed: 0.0089s/iter; left time: 1.4527s
Updating learning rate to 5.772616280653259e-06
Validation loss decreased (0.2894 --> 0.2885).  Saving model state dict ...
Epoch: 7 cost time: 0.7473568916320801
Epoch: 7, Steps: 131 | Train Loss: 0.3161128 Vali Loss: 0.2885079 Best vali loss: 0.2885079
	iters: 100, epoch: 8 | loss: 0.7024677
	speed: 0.0090s/iter; left time: 0.2893s
Updating learning rate to 0.0
Validation loss decreased (0.2885 --> 0.2883).  Saving model state dict ...
Epoch: 8 cost time: 0.7621026039123535
Epoch: 8, Steps: 131 | Train Loss: 0.7024677 Vali Loss: 0.2882879 Best vali loss: 0.2882879

best validation loss 0.28828788678102574

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010453165005, 'e_layers': 2, 'learning_rate': 0.0002392405217, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7646329
	speed: 0.0086s/iter; left time: 35.2347s
	iters: 200, epoch: 1 | loss: 0.4922313
	speed: 0.0035s/iter; left time: 13.9290s
	iters: 300, epoch: 1 | loss: 0.7010584
	speed: 0.0035s/iter; left time: 13.4957s
	iters: 400, epoch: 1 | loss: 0.6733589
	speed: 0.0035s/iter; left time: 13.2368s
	iters: 500, epoch: 1 | loss: 0.4276837
	speed: 0.0035s/iter; left time: 12.7263s
Updating learning rate to 0.0002301349715229762
Validation loss decreased (inf --> 0.2807).  Saving model state dict ...
Epoch: 1 cost time: 2.082998037338257
Epoch: 1, Steps: 523 | Train Loss: 0.6117931 Vali Loss: 0.2806801 Best vali loss: 0.2806801
	iters: 100, epoch: 2 | loss: 0.3456296
	speed: 0.0078s/iter; left time: 27.7028s
	iters: 200, epoch: 2 | loss: 0.6170862
	speed: 0.0033s/iter; left time: 11.5652s
	iters: 300, epoch: 2 | loss: 0.2635025
	speed: 0.0034s/iter; left time: 11.4438s
	iters: 400, epoch: 2 | loss: 0.2891410
	speed: 0.0035s/iter; left time: 11.4466s
	iters: 500, epoch: 2 | loss: 0.4901619
	speed: 0.0034s/iter; left time: 10.8085s
Updating learning rate to 0.0002042045584643387
Validation loss decreased (0.2807 --> 0.2805).  Saving model state dict ...
Epoch: 2 cost time: 1.8188872337341309
Epoch: 2, Steps: 523 | Train Loss: 0.4011042 Vali Loss: 0.2804551 Best vali loss: 0.2804551
	iters: 100, epoch: 3 | loss: 0.4306040
	speed: 0.0076s/iter; left time: 23.1378s
	iters: 200, epoch: 3 | loss: 0.4341605
	speed: 0.0030s/iter; left time: 8.9473s
	iters: 300, epoch: 3 | loss: 0.2143802
	speed: 0.0030s/iter; left time: 8.5643s
	iters: 400, epoch: 3 | loss: 0.6651139
	speed: 0.0030s/iter; left time: 8.2742s
	iters: 500, epoch: 3 | loss: 0.3796360
	speed: 0.0030s/iter; left time: 7.9407s
Updating learning rate to 0.0001653969528524854
Epoch: 3 cost time: 1.626997470855713
Epoch: 3, Steps: 523 | Train Loss: 0.4247789 Vali Loss: 0.3113759 Best vali loss: 0.2804551
	iters: 100, epoch: 4 | loss: 0.4420434
	speed: 0.0073s/iter; left time: 18.4579s
	iters: 200, epoch: 4 | loss: 0.4499057
	speed: 0.0033s/iter; left time: 7.9155s
	iters: 300, epoch: 4 | loss: 0.5607538
	speed: 0.0032s/iter; left time: 7.4374s
	iters: 400, epoch: 4 | loss: 0.6834094
	speed: 0.0032s/iter; left time: 7.1957s
	iters: 500, epoch: 4 | loss: 0.3563320
	speed: 0.0033s/iter; left time: 6.8893s
Updating learning rate to 0.00011962026085
Epoch: 4 cost time: 1.7352304458618164
Epoch: 4, Steps: 523 | Train Loss: 0.4984888 Vali Loss: 0.3011461 Best vali loss: 0.2804551
	iters: 100, epoch: 5 | loss: 0.3785798
	speed: 0.0075s/iter; left time: 14.9796s
	iters: 200, epoch: 5 | loss: 0.4758111
	speed: 0.0034s/iter; left time: 6.3587s
	iters: 300, epoch: 5 | loss: 0.3389874
	speed: 0.0034s/iter; left time: 6.0778s
	iters: 400, epoch: 5 | loss: 0.2094370
	speed: 0.0034s/iter; left time: 5.7169s
	iters: 500, epoch: 5 | loss: 0.5210943
	speed: 0.0034s/iter; left time: 5.3507s
Updating learning rate to 7.384356884751464e-05
Epoch: 5 cost time: 1.808213233947754
Epoch: 5, Steps: 523 | Train Loss: 0.3847819 Vali Loss: 0.3156023 Best vali loss: 0.2804551
	iters: 100, epoch: 6 | loss: 0.2258353
	speed: 0.0075s/iter; left time: 10.9528s
	iters: 200, epoch: 6 | loss: 0.3436631
	speed: 0.0031s/iter; left time: 4.2485s
	iters: 300, epoch: 6 | loss: 0.5298924
	speed: 0.0031s/iter; left time: 3.8914s
	iters: 400, epoch: 6 | loss: 0.1787300
	speed: 0.0030s/iter; left time: 3.5427s
	iters: 500, epoch: 6 | loss: 0.3162099
	speed: 0.0030s/iter; left time: 3.2555s
Updating learning rate to 3.5035963235661324e-05
Epoch: 6 cost time: 1.642167568206787
Epoch: 6, Steps: 523 | Train Loss: 0.3188661 Vali Loss: 0.3182538 Best vali loss: 0.2804551
	iters: 100, epoch: 7 | loss: 0.6158725
	speed: 0.0072s/iter; left time: 6.8188s
	iters: 200, epoch: 7 | loss: 0.1685189
	speed: 0.0031s/iter; left time: 2.5893s
	iters: 300, epoch: 7 | loss: 0.3655188
	speed: 0.0030s/iter; left time: 2.2645s
	iters: 400, epoch: 7 | loss: 0.2981626
	speed: 0.0030s/iter; left time: 1.9619s
	iters: 500, epoch: 7 | loss: 0.2622833
	speed: 0.0030s/iter; left time: 1.6611s
Updating learning rate to 9.105550177023824e-06
Epoch: 7 cost time: 1.6324050426483154
Epoch: 7, Steps: 523 | Train Loss: 0.3420712 Vali Loss: 0.3162624 Best vali loss: 0.2804551
	iters: 100, epoch: 8 | loss: 0.2726946
	speed: 0.0075s/iter; left time: 3.1773s
	iters: 200, epoch: 8 | loss: 0.2257200
	speed: 0.0033s/iter; left time: 1.0812s
	iters: 300, epoch: 8 | loss: 0.2757190
	speed: 0.0034s/iter; left time: 0.7531s
	iters: 400, epoch: 8 | loss: 0.1894764
	speed: 0.0034s/iter; left time: 0.4171s
	iters: 500, epoch: 8 | loss: 0.4586284
	speed: 0.0035s/iter; left time: 0.0843s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8073148727416992
Epoch: 8, Steps: 523 | Train Loss: 0.2844477 Vali Loss: 0.3189458 Best vali loss: 0.2804551

best validation loss 0.28045511539428375

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010287791942, 'e_layers': 2, 'learning_rate': 0.0002394577498, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7646099
	speed: 0.0086s/iter; left time: 35.2473s
	iters: 200, epoch: 1 | loss: 0.4922102
	speed: 0.0035s/iter; left time: 13.7644s
	iters: 300, epoch: 1 | loss: 0.7012541
	speed: 0.0035s/iter; left time: 13.4701s
	iters: 400, epoch: 1 | loss: 0.6589258
	speed: 0.0034s/iter; left time: 12.8422s
	iters: 500, epoch: 1 | loss: 0.4394052
	speed: 0.0034s/iter; left time: 12.6840s
Updating learning rate to 0.00023034393187071434
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 2.0667426586151123
Epoch: 1, Steps: 523 | Train Loss: 0.6112810 Vali Loss: 0.2829255 Best vali loss: 0.2829255
	iters: 100, epoch: 2 | loss: 0.3447526
	speed: 0.0080s/iter; left time: 28.5029s
	iters: 200, epoch: 2 | loss: 0.6185013
	speed: 0.0034s/iter; left time: 11.8520s
	iters: 300, epoch: 2 | loss: 0.2765824
	speed: 0.0035s/iter; left time: 11.6212s
	iters: 400, epoch: 2 | loss: 0.3003223
	speed: 0.0036s/iter; left time: 11.6606s
	iters: 500, epoch: 2 | loss: 0.4369634
	speed: 0.0035s/iter; left time: 11.0057s
Updating learning rate to 0.00020438997424562582
Validation loss decreased (0.2829 --> 0.2787).  Saving model state dict ...
Epoch: 2 cost time: 1.8728952407836914
Epoch: 2, Steps: 523 | Train Loss: 0.3954244 Vali Loss: 0.2787472 Best vali loss: 0.2787472
	iters: 100, epoch: 3 | loss: 0.4357162
	speed: 0.0080s/iter; left time: 24.3585s
	iters: 200, epoch: 3 | loss: 0.2766105
	speed: 0.0035s/iter; left time: 10.2538s
	iters: 300, epoch: 3 | loss: 0.2159753
	speed: 0.0035s/iter; left time: 9.9239s
	iters: 400, epoch: 3 | loss: 0.7312128
	speed: 0.0035s/iter; left time: 9.5459s
	iters: 500, epoch: 3 | loss: 0.3922671
	speed: 0.0035s/iter; left time: 9.2013s
Updating learning rate to 0.00016554713169994245
Epoch: 3 cost time: 1.8659210205078125
Epoch: 3, Steps: 523 | Train Loss: 0.4103564 Vali Loss: 0.2850139 Best vali loss: 0.2787472

best validation loss 0.2787471788108637

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010385762375, 'e_layers': 2, 'learning_rate': 0.0002275402135, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00021887997978794918
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.7822721004486084
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2760947 Best vali loss: 0.2760947
Updating learning rate to 0.0001942177207292424
Validation loss decreased (0.2761 --> 0.2743).  Saving model state dict ...
Epoch: 2 cost time: 0.7036073207855225
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2743275 Best vali loss: 0.2743275
Updating learning rate to 0.00015730804170163267
Epoch: 3 cost time: 0.5557594299316406
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2775680 Best vali loss: 0.2743275

best validation loss 0.27432753531939036

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010439568707, 'e_layers': 2, 'learning_rate': 0.0002272191102, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00021857109775460327
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.788287878036499
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2760946 Best vali loss: 0.2760946
Updating learning rate to 0.0001939436419187967
Validation loss decreased (0.2761 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 0.7097601890563965
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2741890 Best vali loss: 0.2741890
Updating learning rate to 0.0001570860495951388
Epoch: 3 cost time: 0.5545814037322998
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2765776 Best vali loss: 0.2741890

best validation loss 0.2741890101904495

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010439568707, 'e_layers': 2, 'learning_rate': 0.0002272191102, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001136095551
Epoch: 4 cost time: 0.7755372524261475
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2890237 Best vali loss: 0.2741890
Updating learning rate to 7.013306060486122e-05
Epoch: 5 cost time: 0.5451483726501465
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2866149 Best vali loss: 0.2741890
Updating learning rate to 3.327546828120329e-05
Epoch: 6 cost time: 0.5495367050170898
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3017819 Best vali loss: 0.2741890
Updating learning rate to 8.648012445396728e-06
Epoch: 7 cost time: 0.5480613708496094
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2989904 Best vali loss: 0.2741890
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5467591285705566
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2970673 Best vali loss: 0.2741890

best validation loss 0.2741890101904495

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010175702149, 'e_layers': 2, 'learning_rate': 0.0002270685908, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002184263071581503
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.7819037437438965
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2760958 Best vali loss: 0.2760958
Updating learning rate to 0.00019381516557457663
Validation loss decreased (0.2761 --> 0.2743).  Saving model state dict ...
Epoch: 2 cost time: 0.7160873413085938
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2743164 Best vali loss: 0.2743164
Updating learning rate to 0.00015698198925482402
Epoch: 3 cost time: 0.5542442798614502
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2773583 Best vali loss: 0.2743164
Updating learning rate to 0.0001135342954
Epoch: 4 cost time: 0.5490834712982178
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2867233 Best vali loss: 0.2743164
Updating learning rate to 7.008660154517598e-05
Epoch: 5 cost time: 0.5576879978179932
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2920623 Best vali loss: 0.2743164
Updating learning rate to 3.3253425225423356e-05
Epoch: 6 cost time: 0.5554955005645752
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2920067 Best vali loss: 0.2743164
Updating learning rate to 8.642283641849667e-06
Epoch: 7 cost time: 0.5473184585571289
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2990221 Best vali loss: 0.2743164
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5520360469818115
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2983864 Best vali loss: 0.2743164

best validation loss 0.2743163633275626

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001029038914, 'e_layers': 2, 'learning_rate': 0.0002321762378, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00022333955591944668
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.7716701030731201
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2760572 Best vali loss: 0.2760572
Updating learning rate to 0.0001981748149893802
Validation loss decreased (0.2761 --> 0.2741).  Saving model state dict ...
Epoch: 2 cost time: 0.5571942329406738
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2740890 Best vali loss: 0.2740890
Updating learning rate to 0.00016051311869745867
Epoch: 3 cost time: 0.5570776462554932
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2792691 Best vali loss: 0.2740890
Updating learning rate to 0.0001160881189
Epoch: 4 cost time: 0.549680233001709
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2806062 Best vali loss: 0.2740890
Updating learning rate to 7.166311910254135e-05
Epoch: 5 cost time: 0.5501861572265625
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2843405 Best vali loss: 0.2740890
Updating learning rate to 3.40014228106198e-05
Epoch: 6 cost time: 0.5469868183135986
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2879794 Best vali loss: 0.2740890
Updating learning rate to 8.83668188055333e-06
Epoch: 7 cost time: 0.5469999313354492
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2964711 Best vali loss: 0.2740890
Updating learning rate to 0.0
Epoch: 8 cost time: 0.554161787033081
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2933081 Best vali loss: 0.2740890

best validation loss 0.27408897279363087

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010373968752, 'e_layers': 2, 'learning_rate': 0.0002364220382, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7640222
	speed: 0.0088s/iter; left time: 35.7504s
	iters: 200, epoch: 1 | loss: 0.4921957
	speed: 0.0035s/iter; left time: 14.0696s
	iters: 300, epoch: 1 | loss: 0.7020875
	speed: 0.0035s/iter; left time: 13.7314s
	iters: 400, epoch: 1 | loss: 0.6572536
	speed: 0.0035s/iter; left time: 13.1779s
	iters: 500, epoch: 1 | loss: 0.4532362
	speed: 0.0035s/iter; left time: 12.8589s
Updating learning rate to 0.00022742376016379078
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 2.095468759536743
Epoch: 1, Steps: 523 | Train Loss: 0.6137591 Vali Loss: 0.2866896 Best vali loss: 0.2866896
	iters: 100, epoch: 2 | loss: 0.3542147
	speed: 0.0077s/iter; left time: 27.5648s
	iters: 200, epoch: 2 | loss: 0.6443896
	speed: 0.0032s/iter; left time: 11.2479s
	iters: 300, epoch: 2 | loss: 0.2622768
	speed: 0.0033s/iter; left time: 10.9905s
	iters: 400, epoch: 2 | loss: 0.3294012
	speed: 0.0032s/iter; left time: 10.5717s
	iters: 500, epoch: 2 | loss: 0.4703299
	speed: 0.0033s/iter; left time: 10.3404s
Updating learning rate to 0.00020179883231658248
Validation loss decreased (0.2867 --> 0.2779).  Saving model state dict ...
Epoch: 2 cost time: 1.7438244819641113
Epoch: 2, Steps: 523 | Train Loss: 0.4121224 Vali Loss: 0.2778647 Best vali loss: 0.2778647
	iters: 100, epoch: 3 | loss: 0.4283927
	speed: 0.0081s/iter; left time: 24.5972s
	iters: 200, epoch: 3 | loss: 0.4632454
	speed: 0.0035s/iter; left time: 10.2555s
	iters: 300, epoch: 3 | loss: 0.2128794
	speed: 0.0034s/iter; left time: 9.7194s
	iters: 400, epoch: 3 | loss: 0.7278086
	speed: 0.0034s/iter; left time: 9.4371s
	iters: 500, epoch: 3 | loss: 0.4054792
	speed: 0.0035s/iter; left time: 9.1360s
Updating learning rate to 0.00016344841763256317
Epoch: 3 cost time: 1.8489024639129639
Epoch: 3, Steps: 523 | Train Loss: 0.4475610 Vali Loss: 0.2919188 Best vali loss: 0.2778647

best validation loss 0.27786472777798965

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013911943132, 'e_layers': 2, 'learning_rate': 0.000227672028, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002190067773972683
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.7683126926422119
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2760963 Best vali loss: 0.2760963
Updating learning rate to 0.00019433023144264675
Validation loss decreased (0.2761 --> 0.2743).  Saving model state dict ...
Epoch: 2 cost time: 0.558668851852417
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2742830 Best vali loss: 0.2742830
Updating learning rate to 0.0001573991705642804
Epoch: 3 cost time: 0.5536837577819824
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2781961 Best vali loss: 0.2742830

best validation loss 0.27428296837898913

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6356344
	speed: 0.0098s/iter; left time: 19.5336s
	iters: 200, epoch: 1 | loss: 0.5111187
	speed: 0.0044s/iter; left time: 8.4406s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 1.4382693767547607
Epoch: 1, Steps: 262 | Train Loss: 0.5733765 Vali Loss: 0.2878953 Best vali loss: 0.2878953
	iters: 100, epoch: 2 | loss: 0.8056782
	speed: 0.0093s/iter; left time: 16.0569s
	iters: 200, epoch: 2 | loss: 0.4165036
	speed: 0.0040s/iter; left time: 6.4998s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.2879 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 1.0761666297912598
Epoch: 2, Steps: 262 | Train Loss: 0.6110909 Vali Loss: 0.2800095 Best vali loss: 0.2800095
	iters: 100, epoch: 3 | loss: 0.4709608
	speed: 0.0086s/iter; left time: 12.5954s
	iters: 200, epoch: 3 | loss: 0.4061714
	speed: 0.0039s/iter; left time: 5.2895s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 1.0453755855560303
Epoch: 3, Steps: 262 | Train Loss: 0.4385661 Vali Loss: 0.2802370 Best vali loss: 0.2800095

best validation loss 0.28000953231615044

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013911943132, 'e_layers': 2, 'learning_rate': 0.000227672028, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.000113836014
Epoch: 4 cost time: 0.7910635471343994
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2951062 Best vali loss: 0.2742830
Updating learning rate to 7.027285743571959e-05
Epoch: 5 cost time: 0.5496149063110352
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2921725 Best vali loss: 0.2742830
Updating learning rate to 3.3341796557353245e-05
Epoch: 6 cost time: 0.5497350692749023
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2996018 Best vali loss: 0.2742830
Updating learning rate to 8.665250602731708e-06
Epoch: 7 cost time: 0.5461392402648926
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2974766 Best vali loss: 0.2742830
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5494487285614014
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2946944 Best vali loss: 0.2742830

best validation loss 0.27428296837898913

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010213387298, 'e_layers': 2, 'learning_rate': 0.0002383590905, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3885947
	speed: 0.0101s/iter; left time: 9.6161s
Updating learning rate to 0.00022928708780047775
Validation loss decreased (inf --> 0.2760).  Saving model state dict ...
Epoch: 1 cost time: 0.8898885250091553
Epoch: 1, Steps: 131 | Train Loss: 0.3885947 Vali Loss: 0.2759625 Best vali loss: 0.2759625
	iters: 100, epoch: 2 | loss: 0.3928917
	speed: 0.0085s/iter; left time: 6.9747s
Updating learning rate to 0.00020345220987500398
Epoch: 2 cost time: 0.6680662631988525
Epoch: 2, Steps: 131 | Train Loss: 0.3928917 Vali Loss: 0.2963130 Best vali loss: 0.2759625
	iters: 100, epoch: 3 | loss: 0.3852416
	speed: 0.0082s/iter; left time: 5.6350s
Updating learning rate to 0.00016478758269398053
Validation loss decreased (0.2760 --> 0.2747).  Saving model state dict ...
Epoch: 3 cost time: 0.6583254337310791
Epoch: 3, Steps: 131 | Train Loss: 0.3852416 Vali Loss: 0.2747359 Best vali loss: 0.2747359
	iters: 100, epoch: 4 | loss: 0.2523646
	speed: 0.0085s/iter; left time: 4.7217s
Updating learning rate to 0.00011917954525
Epoch: 4 cost time: 0.662428617477417
Epoch: 4, Steps: 131 | Train Loss: 0.2523646 Vali Loss: 0.2995934 Best vali loss: 0.2747359
	iters: 100, epoch: 5 | loss: 0.3122027
	speed: 0.0082s/iter; left time: 3.4852s
Updating learning rate to 7.357150780601947e-05
Epoch: 5 cost time: 0.6630783081054688
Epoch: 5, Steps: 131 | Train Loss: 0.3122027 Vali Loss: 0.2853379 Best vali loss: 0.2747359
	iters: 100, epoch: 6 | loss: 0.2941356
	speed: 0.0082s/iter; left time: 2.4160s
Updating learning rate to 3.4906880624996015e-05
Epoch: 6 cost time: 0.666243314743042
Epoch: 6, Steps: 131 | Train Loss: 0.2941356 Vali Loss: 0.2991707 Best vali loss: 0.2747359
	iters: 100, epoch: 7 | loss: 0.3830967
	speed: 0.0083s/iter; left time: 1.3469s
Updating learning rate to 9.072002699522255e-06
Epoch: 7 cost time: 0.6618869304656982
Epoch: 7, Steps: 131 | Train Loss: 0.3830967 Vali Loss: 0.3042105 Best vali loss: 0.2747359
	iters: 100, epoch: 8 | loss: 0.3408476
	speed: 0.0082s/iter; left time: 0.2635s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.660881519317627
Epoch: 8, Steps: 131 | Train Loss: 0.3408476 Vali Loss: 0.3115040 Best vali loss: 0.2747359

best validation loss 0.2747359462844346

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0084476017093, 'e_layers': 2, 'learning_rate': 0.0002364657071, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3888375
	speed: 0.0102s/iter; left time: 9.6542s
Updating learning rate to 0.0002364657071
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.8902473449707031
Epoch: 1, Steps: 131 | Train Loss: 0.3888375 Vali Loss: 0.2757685 Best vali loss: 0.2757685
	iters: 100, epoch: 2 | loss: 0.3938226
	speed: 0.0085s/iter; left time: 6.9600s
Updating learning rate to 0.00011823285355
Epoch: 2 cost time: 0.6666908264160156
Epoch: 2, Steps: 131 | Train Loss: 0.3938226 Vali Loss: 0.3007378 Best vali loss: 0.2757685
	iters: 100, epoch: 3 | loss: 0.3848761
	speed: 0.0083s/iter; left time: 5.7176s
Updating learning rate to 5.9116426775e-05
Epoch: 3 cost time: 0.672327995300293
Epoch: 3, Steps: 131 | Train Loss: 0.3848761 Vali Loss: 0.2829794 Best vali loss: 0.2757685
	iters: 100, epoch: 4 | loss: 0.2536608
	speed: 0.0082s/iter; left time: 4.5809s
Updating learning rate to 2.95582133875e-05
Epoch: 4 cost time: 0.6610288619995117
Epoch: 4, Steps: 131 | Train Loss: 0.2536608 Vali Loss: 0.2971701 Best vali loss: 0.2757685
	iters: 100, epoch: 5 | loss: 0.3180158
	speed: 0.0083s/iter; left time: 3.5208s
Updating learning rate to 1.477910669375e-05
Epoch: 5 cost time: 0.6678974628448486
Epoch: 5, Steps: 131 | Train Loss: 0.3180158 Vali Loss: 0.2897259 Best vali loss: 0.2757685
	iters: 100, epoch: 6 | loss: 0.3057762
	speed: 0.0082s/iter; left time: 2.4203s
Updating learning rate to 7.389553346875e-06
Epoch: 6 cost time: 0.6634469032287598
Epoch: 6, Steps: 131 | Train Loss: 0.3057762 Vali Loss: 0.2947455 Best vali loss: 0.2757685
	iters: 100, epoch: 7 | loss: 0.4361705
	speed: 0.0083s/iter; left time: 1.3448s
Updating learning rate to 3.6947766734375e-06
Epoch: 7 cost time: 0.6607413291931152
Epoch: 7, Steps: 131 | Train Loss: 0.4361705 Vali Loss: 0.2944582 Best vali loss: 0.2757685
	iters: 100, epoch: 8 | loss: 0.3832460
	speed: 0.0082s/iter; left time: 0.2618s
Updating learning rate to 1.84738833671875e-06
Epoch: 8 cost time: 0.666374683380127
Epoch: 8, Steps: 131 | Train Loss: 0.3832460 Vali Loss: 0.2960031 Best vali loss: 0.2757685

best validation loss 0.2757685179048065

[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0084476017093, 'e_layers': 2, 'learning_rate': 0.0002384705142, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3888211
	speed: 0.0101s/iter; left time: 9.6004s
Updating learning rate to 0.0002384705142
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.8945410251617432
Epoch: 1, Steps: 131 | Train Loss: 0.3888211 Vali Loss: 0.2757537 Best vali loss: 0.2757537
	iters: 100, epoch: 2 | loss: 0.3941381
	speed: 0.0083s/iter; left time: 6.8227s
Updating learning rate to 0.0001192352571
Epoch: 2 cost time: 0.6585597991943359
Epoch: 2, Steps: 131 | Train Loss: 0.3941381 Vali Loss: 0.3080762 Best vali loss: 0.2757537
	iters: 100, epoch: 3 | loss: 0.3718628
	speed: 0.0082s/iter; left time: 5.6076s
Updating learning rate to 5.961762855e-05
Epoch: 3 cost time: 0.6568365097045898
Epoch: 3, Steps: 131 | Train Loss: 0.3718628 Vali Loss: 0.2816298 Best vali loss: 0.2757537

best validation loss 0.2757537373826157

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010221602415, 'e_layers': 2, 'learning_rate': 0.0002378151919, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3886564
	speed: 0.0102s/iter; left time: 9.6512s
Updating learning rate to 0.000228763890108327
Validation loss decreased (inf --> 0.2760).  Saving model state dict ...
Epoch: 1 cost time: 0.8962211608886719
Epoch: 1, Steps: 131 | Train Loss: 0.3886564 Vali Loss: 0.2759504 Best vali loss: 0.2759504
	iters: 100, epoch: 2 | loss: 0.3920708
	speed: 0.0084s/iter; left time: 6.8928s
Updating learning rate to 0.00020298796338083505
Epoch: 2 cost time: 0.6576313972473145
Epoch: 2, Steps: 131 | Train Loss: 0.3920708 Vali Loss: 0.2954129 Best vali loss: 0.2759504
	iters: 100, epoch: 3 | loss: 0.3940408
	speed: 0.0083s/iter; left time: 5.6935s
Updating learning rate to 0.00016441156290242727
Epoch: 3 cost time: 0.6697628498077393
Epoch: 3, Steps: 131 | Train Loss: 0.3940408 Vali Loss: 0.2782952 Best vali loss: 0.2759504

best validation loss 0.2759503752724661

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010213187619, 'e_layers': 2, 'learning_rate': 0.0002370900892, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3885700
	speed: 0.0101s/iter; left time: 9.5481s
Updating learning rate to 0.00022806638498657763
Validation loss decreased (inf --> 0.2759).  Saving model state dict ...
Epoch: 1 cost time: 0.8874096870422363
Epoch: 1, Steps: 131 | Train Loss: 0.3885700 Vali Loss: 0.2759174 Best vali loss: 0.2759174
	iters: 100, epoch: 2 | loss: 0.3929904
	speed: 0.0084s/iter; left time: 6.9011s
Updating learning rate to 0.0002023690495127217
Epoch: 2 cost time: 0.6620080471038818
Epoch: 2, Steps: 131 | Train Loss: 0.3929904 Vali Loss: 0.3050110 Best vali loss: 0.2759174
	iters: 100, epoch: 3 | loss: 0.3844145
	speed: 0.0082s/iter; left time: 5.6603s
Updating learning rate to 0.00016391026915740065
Validation loss decreased (0.2759 --> 0.2738).  Saving model state dict ...
Epoch: 3 cost time: 0.6608450412750244
Epoch: 3, Steps: 131 | Train Loss: 0.3844145 Vali Loss: 0.2738350 Best vali loss: 0.2738350

best validation loss 0.2738349809771623

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010213187619, 'e_layers': 2, 'learning_rate': 0.0002370900892, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3493569
	speed: 0.0104s/iter; left time: 5.7798s
Updating learning rate to 0.0001185450446
Epoch: 4 cost time: 0.8948588371276855
Epoch: 4, Steps: 131 | Train Loss: 0.3493569 Vali Loss: 0.2941867 Best vali loss: 0.2738350
	iters: 100, epoch: 5 | loss: 0.3136364
	speed: 0.0082s/iter; left time: 3.4899s
Updating learning rate to 7.317982004259936e-05
Epoch: 5 cost time: 0.656641960144043
Epoch: 5, Steps: 131 | Train Loss: 0.3136364 Vali Loss: 0.2941122 Best vali loss: 0.2738350
	iters: 100, epoch: 6 | loss: 0.2710347
	speed: 0.0082s/iter; left time: 2.4087s
Updating learning rate to 3.472103968727829e-05
Epoch: 6 cost time: 0.659576416015625
Epoch: 6, Steps: 131 | Train Loss: 0.2710347 Vali Loss: 0.3001055 Best vali loss: 0.2738350
	iters: 100, epoch: 7 | loss: 0.2236201
	speed: 0.0084s/iter; left time: 1.3637s
Updating learning rate to 9.023704213422364e-06
Epoch: 7 cost time: 0.6651029586791992
Epoch: 7, Steps: 131 | Train Loss: 0.2236201 Vali Loss: 0.3109797 Best vali loss: 0.2738350
	iters: 100, epoch: 8 | loss: 0.2897343
	speed: 0.0082s/iter; left time: 0.2638s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6589105129241943
Epoch: 8, Steps: 131 | Train Loss: 0.2897343 Vali Loss: 0.3087246 Best vali loss: 0.2738350

best validation loss 0.2738349809771623

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.7006809711456299
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2829255 Best vali loss: 0.2829255
Updating learning rate to 0.0005975820137081337
Epoch: 2 cost time: 0.4766819477081299
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2939710 Best vali loss: 0.2829255
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.4813849925994873
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2943636 Best vali loss: 0.2829255
Updating learning rate to 0.000350055439
Epoch: 4 cost time: 0.49044275283813477
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2860285 Best vali loss: 0.2829255
Updating learning rate to 0.0002160950220854117
Validation loss decreased (0.2829 --> 0.2773).  Saving model state dict ...
Epoch: 5 cost time: 0.4981720447540283
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2773377 Best vali loss: 0.2773377
Updating learning rate to 0.00010252886429186618
Epoch: 6 cost time: 0.4851226806640625
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3054787 Best vali loss: 0.2773377
Updating learning rate to 2.6646383663646746e-05
Epoch: 7 cost time: 0.4950127601623535
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2889122 Best vali loss: 0.2773377
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4821162223815918
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2967863 Best vali loss: 0.2773377

best validation loss 0.27733770989272266

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4277424
	speed: 0.0100s/iter; left time: 82.5084s
	iters: 200, epoch: 1 | loss: 0.2593872
	speed: 0.0050s/iter; left time: 40.7362s
	iters: 300, epoch: 1 | loss: 0.3310376
	speed: 0.0050s/iter; left time: 40.3097s
	iters: 400, epoch: 1 | loss: 0.4147624
	speed: 0.0050s/iter; left time: 39.8834s
	iters: 500, epoch: 1 | loss: 0.2040509
	speed: 0.0050s/iter; left time: 39.5393s
	iters: 600, epoch: 1 | loss: 1.2253639
	speed: 0.0050s/iter; left time: 38.9623s
	iters: 700, epoch: 1 | loss: 1.1520661
	speed: 0.0050s/iter; left time: 38.4626s
	iters: 800, epoch: 1 | loss: 0.2324915
	speed: 0.0050s/iter; left time: 37.9745s
	iters: 900, epoch: 1 | loss: 0.2170449
	speed: 0.0050s/iter; left time: 37.4257s
	iters: 1000, epoch: 1 | loss: 0.3583880
	speed: 0.0050s/iter; left time: 36.9920s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 5.486390590667725
Epoch: 1, Steps: 1045 | Train Loss: 0.4822335 Vali Loss: 0.2868643 Best vali loss: 0.2868643
	iters: 100, epoch: 2 | loss: 0.1763929
	speed: 0.0138s/iter; left time: 99.8637s
	iters: 200, epoch: 2 | loss: 0.2803303
	speed: 0.0050s/iter; left time: 35.7830s
	iters: 300, epoch: 2 | loss: 0.2616337
	speed: 0.0050s/iter; left time: 35.2220s
	iters: 400, epoch: 2 | loss: 0.4828585
	speed: 0.0050s/iter; left time: 34.7284s
	iters: 500, epoch: 2 | loss: 0.5062490
	speed: 0.0050s/iter; left time: 34.1210s
	iters: 600, epoch: 2 | loss: 1.3107723
	speed: 0.0049s/iter; left time: 33.1334s
	iters: 700, epoch: 2 | loss: 0.6903986
	speed: 0.0050s/iter; left time: 32.9448s
	iters: 800, epoch: 2 | loss: 0.2614167
	speed: 0.0050s/iter; left time: 32.5511s
	iters: 900, epoch: 2 | loss: 1.1376568
	speed: 0.0050s/iter; left time: 32.1636s
	iters: 1000, epoch: 2 | loss: 0.4134337
	speed: 0.0050s/iter; left time: 31.6571s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.2869 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 5.265451192855835
Epoch: 2, Steps: 1045 | Train Loss: 0.5521143 Vali Loss: 0.2868210 Best vali loss: 0.2868210
	iters: 100, epoch: 3 | loss: 0.4605928
	speed: 0.0135s/iter; left time: 83.5296s
	iters: 200, epoch: 3 | loss: 0.2269321
	speed: 0.0045s/iter; left time: 27.3970s
	iters: 300, epoch: 3 | loss: 0.8102833
	speed: 0.0047s/iter; left time: 27.8107s
	iters: 400, epoch: 3 | loss: 0.3369110
	speed: 0.0045s/iter; left time: 26.6246s
	iters: 500, epoch: 3 | loss: 0.8283812
	speed: 0.0046s/iter; left time: 26.7399s
	iters: 600, epoch: 3 | loss: 0.2423897
	speed: 0.0045s/iter; left time: 25.6546s
	iters: 700, epoch: 3 | loss: 0.1412322
	speed: 0.0046s/iter; left time: 25.7506s
	iters: 800, epoch: 3 | loss: 1.5074129
	speed: 0.0046s/iter; left time: 25.3173s
	iters: 900, epoch: 3 | loss: 0.2908244
	speed: 0.0045s/iter; left time: 24.3856s
	iters: 1000, epoch: 3 | loss: 0.4889799
	speed: 0.0044s/iter; left time: 23.1659s
Updating learning rate to 0.0004164486617318853
Epoch: 3 cost time: 4.774130344390869
Epoch: 3, Steps: 1045 | Train Loss: 0.5333940 Vali Loss: 0.2935212 Best vali loss: 0.2868210
	iters: 100, epoch: 4 | loss: 0.1421055
	speed: 0.0132s/iter; left time: 67.5337s
	iters: 200, epoch: 4 | loss: 0.6631919
	speed: 0.0043s/iter; left time: 21.8169s
	iters: 300, epoch: 4 | loss: 1.0812093
	speed: 0.0044s/iter; left time: 21.4464s
	iters: 400, epoch: 4 | loss: 0.1905651
	speed: 0.0044s/iter; left time: 21.0340s
	iters: 500, epoch: 4 | loss: 0.4401441
	speed: 0.0044s/iter; left time: 20.5611s
	iters: 600, epoch: 4 | loss: 0.3707706
	speed: 0.0044s/iter; left time: 20.1694s
	iters: 700, epoch: 4 | loss: 0.7085202
	speed: 0.0044s/iter; left time: 19.7551s
	iters: 800, epoch: 4 | loss: 0.3775692
	speed: 0.0044s/iter; left time: 19.3667s
	iters: 900, epoch: 4 | loss: 0.2162700
	speed: 0.0044s/iter; left time: 18.8414s
	iters: 1000, epoch: 4 | loss: 0.9056112
	speed: 0.0044s/iter; left time: 18.4428s
Updating learning rate to 0.0003011887262
Epoch: 4 cost time: 4.5986621379852295
Epoch: 4, Steps: 1045 | Train Loss: 0.5095957 Vali Loss: 0.2979448 Best vali loss: 0.2868210
	iters: 100, epoch: 5 | loss: 0.5716396
	speed: 0.0132s/iter; left time: 53.9114s
	iters: 200, epoch: 5 | loss: 0.5676532
	speed: 0.0047s/iter; left time: 18.5724s
	iters: 300, epoch: 5 | loss: 0.2404138
	speed: 0.0047s/iter; left time: 18.0946s
	iters: 400, epoch: 5 | loss: 0.2216989
	speed: 0.0046s/iter; left time: 17.5049s
	iters: 500, epoch: 5 | loss: 0.2054886
	speed: 0.0047s/iter; left time: 17.1918s
	iters: 600, epoch: 5 | loss: 0.5972717
	speed: 0.0046s/iter; left time: 16.6394s
	iters: 700, epoch: 5 | loss: 0.3648386
	speed: 0.0046s/iter; left time: 16.1264s
	iters: 800, epoch: 5 | loss: 0.4278537
	speed: 0.0046s/iter; left time: 15.7165s
	iters: 900, epoch: 5 | loss: 0.8036320
	speed: 0.0046s/iter; left time: 15.1630s
	iters: 1000, epoch: 5 | loss: 0.1442347
	speed: 0.0047s/iter; left time: 14.8876s
Updating learning rate to 0.00018592879066811477
Epoch: 5 cost time: 4.893272161483765
Epoch: 5, Steps: 1045 | Train Loss: 0.4144725 Vali Loss: 0.2872141 Best vali loss: 0.2868210
	iters: 100, epoch: 6 | loss: 0.5359251
	speed: 0.0138s/iter; left time: 41.9128s
	iters: 200, epoch: 6 | loss: 0.3591045
	speed: 0.0050s/iter; left time: 14.7542s
	iters: 300, epoch: 6 | loss: 0.4137720
	speed: 0.0051s/iter; left time: 14.4139s
	iters: 400, epoch: 6 | loss: 0.3504807
	speed: 0.0050s/iter; left time: 13.8008s
	iters: 500, epoch: 6 | loss: 0.6780813
	speed: 0.0051s/iter; left time: 13.4072s
	iters: 600, epoch: 6 | loss: 0.2244362
	speed: 0.0050s/iter; left time: 12.7849s
	iters: 700, epoch: 6 | loss: 0.5883468
	speed: 0.0050s/iter; left time: 12.3006s
	iters: 800, epoch: 6 | loss: 0.2677948
	speed: 0.0051s/iter; left time: 11.8056s
	iters: 900, epoch: 6 | loss: 0.2437501
	speed: 0.0051s/iter; left time: 11.3471s
	iters: 1000, epoch: 6 | loss: 0.5017488
	speed: 0.0051s/iter; left time: 10.7923s
Updating learning rate to 8.821613548704165e-05
Validation loss decreased (0.2868 --> 0.2868).  Saving model state dict ...
Epoch: 6 cost time: 5.328470706939697
Epoch: 6, Steps: 1045 | Train Loss: 0.4163440 Vali Loss: 0.2868059 Best vali loss: 0.2868059
	iters: 100, epoch: 7 | loss: 0.3439981
	speed: 0.0137s/iter; left time: 27.1924s
	iters: 200, epoch: 7 | loss: 0.2864533
	speed: 0.0045s/iter; left time: 8.4290s
	iters: 300, epoch: 7 | loss: 0.2690395
	speed: 0.0046s/iter; left time: 8.1638s
	iters: 400, epoch: 7 | loss: 1.1801217
	speed: 0.0047s/iter; left time: 7.8786s
	iters: 500, epoch: 7 | loss: 0.2784476
	speed: 0.0047s/iter; left time: 7.4401s
	iters: 600, epoch: 7 | loss: 0.2150078
	speed: 0.0047s/iter; left time: 6.9355s
	iters: 700, epoch: 7 | loss: 0.7871215
	speed: 0.0046s/iter; left time: 6.3314s
	iters: 800, epoch: 7 | loss: 0.4547010
	speed: 0.0047s/iter; left time: 6.0052s
	iters: 900, epoch: 7 | loss: 0.4704832
	speed: 0.0046s/iter; left time: 5.5104s
	iters: 1000, epoch: 7 | loss: 0.2679348
	speed: 0.0046s/iter; left time: 4.9671s
Updating learning rate to 2.292662664067406e-05
Validation loss decreased (0.2868 --> 0.2858).  Saving model state dict ...
Epoch: 7 cost time: 4.854783058166504
Epoch: 7, Steps: 1045 | Train Loss: 0.4553308 Vali Loss: 0.2858350 Best vali loss: 0.2858350
	iters: 100, epoch: 8 | loss: 0.2136312
	speed: 0.0133s/iter; left time: 12.5511s
	iters: 200, epoch: 8 | loss: 0.2307798
	speed: 0.0045s/iter; left time: 3.8306s
	iters: 300, epoch: 8 | loss: 0.3413632
	speed: 0.0045s/iter; left time: 3.3537s
	iters: 400, epoch: 8 | loss: 0.8109025
	speed: 0.0045s/iter; left time: 2.9259s
	iters: 500, epoch: 8 | loss: 0.6357345
	speed: 0.0045s/iter; left time: 2.4749s
	iters: 600, epoch: 8 | loss: 0.8333454
	speed: 0.0046s/iter; left time: 2.0551s
	iters: 700, epoch: 8 | loss: 0.3666157
	speed: 0.0046s/iter; left time: 1.5898s
	iters: 800, epoch: 8 | loss: 0.9088144
	speed: 0.0046s/iter; left time: 1.1382s
	iters: 900, epoch: 8 | loss: 0.2746673
	speed: 0.0047s/iter; left time: 0.6819s
	iters: 1000, epoch: 8 | loss: 0.3360132
	speed: 0.0046s/iter; left time: 0.2114s
Updating learning rate to 0.0
Validation loss decreased (0.2858 --> 0.2845).  Saving model state dict ...
Epoch: 8 cost time: 4.811739444732666
Epoch: 8, Steps: 1045 | Train Loss: 0.4951867 Vali Loss: 0.2845411 Best vali loss: 0.2845411

best validation loss 0.2845411427560106

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0068870251911, 'e_layers': 1, 'learning_rate': 0.00023912489, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023912489
Validation loss decreased (inf --> 0.2784).  Saving model state dict ...
Epoch: 1 cost time: 0.5552880764007568
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2784441 Best vali loss: 0.2784441
Updating learning rate to 0.000119562445
Validation loss decreased (0.2784 --> 0.2773).  Saving model state dict ...
Epoch: 2 cost time: 0.3243684768676758
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2772831 Best vali loss: 0.2772831
Updating learning rate to 5.97812225e-05
Validation loss decreased (0.2773 --> 0.2751).  Saving model state dict ...
Epoch: 3 cost time: 0.32330751419067383
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2750656 Best vali loss: 0.2750656

best validation loss 0.2750656413916719

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0056467248753, 'e_layers': 4, 'learning_rate': 0.0002390007823, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002390007823
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 1.251039981842041
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2796235 Best vali loss: 0.2796235
Updating learning rate to 0.00011950039115
Epoch: 2 cost time: 1.02524995803833
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2861943 Best vali loss: 0.2796235
Updating learning rate to 5.9750195575e-05
Epoch: 3 cost time: 1.0185909271240234
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2828571 Best vali loss: 0.2796235

best validation loss 0.27962349973100853

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0077229598935, 'e_layers': 3, 'learning_rate': 0.000239118425, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000239118425
Validation loss decreased (inf --> 0.2789).  Saving model state dict ...
Epoch: 1 cost time: 0.990941047668457
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2789261 Best vali loss: 0.2789261
Updating learning rate to 0.0001195592125
Validation loss decreased (0.2789 --> 0.2753).  Saving model state dict ...
Epoch: 2 cost time: 0.7780768871307373
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2753095 Best vali loss: 0.2753095
Updating learning rate to 5.977960625e-05
Epoch: 3 cost time: 0.777698278427124
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2831123 Best vali loss: 0.2753095

best validation loss 0.2753094568344331

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0068870251911, 'e_layers': 1, 'learning_rate': 0.00023912489, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.989061125e-05
Epoch: 4 cost time: 0.5495212078094482
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2770116 Best vali loss: 0.2750656
Updating learning rate to 1.4945305625e-05
Epoch: 5 cost time: 0.3155546188354492
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2789153 Best vali loss: 0.2750656
Updating learning rate to 7.4726528125e-06
Epoch: 6 cost time: 0.3217203617095947
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2791688 Best vali loss: 0.2750656
Updating learning rate to 3.73632640625e-06
Epoch: 7 cost time: 0.31136202812194824
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2792002 Best vali loss: 0.2750656
Updating learning rate to 1.868163203125e-06
Epoch: 8 cost time: 0.31480908393859863
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2791736 Best vali loss: 0.2750656

best validation loss 0.2750656413916719

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018989586747, 'e_layers': 2, 'learning_rate': 0.0002386923917, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5600399
	speed: 0.0103s/iter; left time: 9.7564s
Updating learning rate to 0.0002386923917
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9196794033050537
Epoch: 1, Steps: 131 | Train Loss: 0.5600399 Vali Loss: 0.2757567 Best vali loss: 0.2757567
	iters: 100, epoch: 2 | loss: 0.3284133
	speed: 0.0089s/iter; left time: 7.2735s
Updating learning rate to 0.00011934619585
Validation loss decreased (0.2758 --> 0.2750).  Saving model state dict ...
Epoch: 2 cost time: 0.6965560913085938
Epoch: 2, Steps: 131 | Train Loss: 0.3284133 Vali Loss: 0.2749794 Best vali loss: 0.2749794
	iters: 100, epoch: 3 | loss: 0.4646199
	speed: 0.0088s/iter; left time: 6.0673s
Updating learning rate to 5.9673097925e-05
Epoch: 3 cost time: 0.6960427761077881
Epoch: 3, Steps: 131 | Train Loss: 0.4646199 Vali Loss: 0.2791270 Best vali loss: 0.2749794
	iters: 100, epoch: 4 | loss: 0.5001206
	speed: 0.0086s/iter; left time: 4.7685s
Updating learning rate to 2.98365489625e-05
Epoch: 4 cost time: 0.6938507556915283
Epoch: 4, Steps: 131 | Train Loss: 0.5001206 Vali Loss: 0.2975923 Best vali loss: 0.2749794
	iters: 100, epoch: 5 | loss: 0.3336132
	speed: 0.0086s/iter; left time: 3.6517s
Updating learning rate to 1.491827448125e-05
Epoch: 5 cost time: 0.6996331214904785
Epoch: 5, Steps: 131 | Train Loss: 0.3336132 Vali Loss: 0.2969765 Best vali loss: 0.2749794
	iters: 100, epoch: 6 | loss: 0.3185532
	speed: 0.0086s/iter; left time: 2.5248s
Updating learning rate to 7.459137240625e-06
Epoch: 6 cost time: 0.6962223052978516
Epoch: 6, Steps: 131 | Train Loss: 0.3185532 Vali Loss: 0.2982578 Best vali loss: 0.2749794
	iters: 100, epoch: 7 | loss: 0.3120965
	speed: 0.0086s/iter; left time: 1.4006s
Updating learning rate to 3.7295686203125e-06
Epoch: 7 cost time: 0.6974246501922607
Epoch: 7, Steps: 131 | Train Loss: 0.3120965 Vali Loss: 0.3037053 Best vali loss: 0.2749794
	iters: 100, epoch: 8 | loss: 0.3971613
	speed: 0.0086s/iter; left time: 0.2753s
Updating learning rate to 1.86478431015625e-06
Epoch: 8 cost time: 0.6970851421356201
Epoch: 8, Steps: 131 | Train Loss: 0.3971613 Vali Loss: 0.3030138 Best vali loss: 0.2749794

best validation loss 0.2749794251238737

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010329343173, 'e_layers': 3, 'learning_rate': 0.0002383062425, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4552527
	speed: 0.0126s/iter; left time: 11.9882s
Updating learning rate to 0.0002383062425
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.2299015522003174
Epoch: 1, Steps: 131 | Train Loss: 0.4552527 Vali Loss: 0.2911535 Best vali loss: 0.2911535
	iters: 100, epoch: 2 | loss: 0.4710102
	speed: 0.0123s/iter; left time: 10.0888s
Updating learning rate to 0.00011915312125
Validation loss decreased (0.2912 --> 0.2784).  Saving model state dict ...
Epoch: 2 cost time: 1.0033814907073975
Epoch: 2, Steps: 131 | Train Loss: 0.4710102 Vali Loss: 0.2783978 Best vali loss: 0.2783978
	iters: 100, epoch: 3 | loss: 0.4195845
	speed: 0.0124s/iter; left time: 8.5378s
Updating learning rate to 5.9576560625e-05
Epoch: 3 cost time: 0.9980778694152832
Epoch: 3, Steps: 131 | Train Loss: 0.4195845 Vali Loss: 0.2788808 Best vali loss: 0.2783978
	iters: 100, epoch: 4 | loss: 0.3843802
	speed: 0.0119s/iter; left time: 6.6071s
Updating learning rate to 2.97882803125e-05
Epoch: 4 cost time: 0.9951441287994385
Epoch: 4, Steps: 131 | Train Loss: 0.3843802 Vali Loss: 0.2816268 Best vali loss: 0.2783978
	iters: 100, epoch: 5 | loss: 0.4743318
	speed: 0.0119s/iter; left time: 5.0487s
Updating learning rate to 1.489414015625e-05
Validation loss decreased (0.2784 --> 0.2770).  Saving model state dict ...
Epoch: 5 cost time: 0.994586706161499
Epoch: 5, Steps: 131 | Train Loss: 0.4743318 Vali Loss: 0.2769573 Best vali loss: 0.2769573
	iters: 100, epoch: 6 | loss: 0.4655825
	speed: 0.0125s/iter; left time: 3.6759s
Updating learning rate to 7.447070078125e-06
Epoch: 6 cost time: 1.0039253234863281
Epoch: 6, Steps: 131 | Train Loss: 0.4655825 Vali Loss: 0.2823755 Best vali loss: 0.2769573
	iters: 100, epoch: 7 | loss: 0.2817813
	speed: 0.0119s/iter; left time: 1.9438s
Updating learning rate to 3.7235350390625e-06
Epoch: 7 cost time: 0.9984433650970459
Epoch: 7, Steps: 131 | Train Loss: 0.2817813 Vali Loss: 0.2810718 Best vali loss: 0.2769573
	iters: 100, epoch: 8 | loss: 0.3447692
	speed: 0.0119s/iter; left time: 0.3814s
Updating learning rate to 1.86176751953125e-06
Epoch: 8 cost time: 0.9951663017272949
Epoch: 8, Steps: 131 | Train Loss: 0.3447692 Vali Loss: 0.2788948 Best vali loss: 0.2769573

best validation loss 0.27695728515372836

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018820758312, 'e_layers': 1, 'learning_rate': 0.0002377440922, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4848864
	speed: 0.0082s/iter; left time: 7.7856s
Updating learning rate to 0.0002377440922
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6453020572662354
Epoch: 1, Steps: 131 | Train Loss: 0.4848864 Vali Loss: 0.2780588 Best vali loss: 0.2780588
	iters: 100, epoch: 2 | loss: 0.2555511
	speed: 0.0058s/iter; left time: 4.7548s
Updating learning rate to 0.0001188720461
Validation loss decreased (0.2781 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 0.4319443702697754
Epoch: 2, Steps: 131 | Train Loss: 0.2555511 Vali Loss: 0.2765971 Best vali loss: 0.2765971
	iters: 100, epoch: 3 | loss: 0.5316510
	speed: 0.0057s/iter; left time: 3.9372s
Updating learning rate to 5.943602305e-05
Validation loss decreased (0.2766 --> 0.2762).  Saving model state dict ...
Epoch: 3 cost time: 0.4327561855316162
Epoch: 3, Steps: 131 | Train Loss: 0.5316510 Vali Loss: 0.2761885 Best vali loss: 0.2761885

best validation loss 0.2761885010927927

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016928960669, 'e_layers': 1, 'learning_rate': 0.0002384712529, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4848534
	speed: 0.0082s/iter; left time: 7.7983s
Updating learning rate to 0.0002384712529
Validation loss decreased (inf --> 0.2780).  Saving model state dict ...
Epoch: 1 cost time: 0.6418778896331787
Epoch: 1, Steps: 131 | Train Loss: 0.4848534 Vali Loss: 0.2780132 Best vali loss: 0.2780132
	iters: 100, epoch: 2 | loss: 0.2552058
	speed: 0.0057s/iter; left time: 4.6841s
Updating learning rate to 0.00011923562645
Validation loss decreased (0.2780 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 0.4250905513763428
Epoch: 2, Steps: 131 | Train Loss: 0.2552058 Vali Loss: 0.2765770 Best vali loss: 0.2765770
	iters: 100, epoch: 3 | loss: 0.5308624
	speed: 0.0057s/iter; left time: 3.9048s
Updating learning rate to 5.9617813225e-05
Validation loss decreased (0.2766 --> 0.2762).  Saving model state dict ...
Epoch: 3 cost time: 0.4191579818725586
Epoch: 3, Steps: 131 | Train Loss: 0.5308624 Vali Loss: 0.2761636 Best vali loss: 0.2761636

best validation loss 0.27616362632783914

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0083563445648, 'e_layers': 1, 'learning_rate': 0.0002374905658, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002374905658
Validation loss decreased (inf --> 0.2784).  Saving model state dict ...
Epoch: 1 cost time: 0.5450634956359863
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2784438 Best vali loss: 0.2784438
Updating learning rate to 0.0001187452829
Validation loss decreased (0.2784 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 0.32556796073913574
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2772404 Best vali loss: 0.2772404
Updating learning rate to 5.937264145e-05
Validation loss decreased (0.2772 --> 0.2749).  Saving model state dict ...
Epoch: 3 cost time: 0.32065701484680176
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2749294 Best vali loss: 0.2749294

best validation loss 0.2749293806296647

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0083563445648, 'e_layers': 1, 'learning_rate': 0.0002374905658, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.9686320725e-05
Epoch: 4 cost time: 0.541928768157959
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2766862 Best vali loss: 0.2749294
Updating learning rate to 1.48431603625e-05
Epoch: 5 cost time: 0.3203866481781006
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2786071 Best vali loss: 0.2749294
Updating learning rate to 7.42158018125e-06
Epoch: 6 cost time: 0.31893301010131836
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2788056 Best vali loss: 0.2749294
Updating learning rate to 3.710790090625e-06
Epoch: 7 cost time: 0.3215818405151367
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2788403 Best vali loss: 0.2749294
Updating learning rate to 1.8553950453125e-06
Epoch: 8 cost time: 0.3173666000366211
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2788085 Best vali loss: 0.2749294

best validation loss 0.2749293806296647

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 0.6864161491394043
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2823039 Best vali loss: 0.2823039
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 0.42503786087036133
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2877063 Best vali loss: 0.2823039
Updating learning rate to 0.0008072813968307993
Epoch: 3 cost time: 0.4238157272338867
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905602 Best vali loss: 0.2823039
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 0.4320859909057617
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2929555 Best vali loss: 0.2823039
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 0.41027259826660156
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2951934 Best vali loss: 0.2823039
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.4300408363342285
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2968102 Best vali loss: 0.2823039
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.4015817642211914
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2942502 Best vali loss: 0.2823039
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4540886878967285
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2953185 Best vali loss: 0.2823039

best validation loss 0.28230392111637814

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010218090916, 'e_layers': 2, 'learning_rate': 0.0002349534789, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597246
	speed: 0.0104s/iter; left time: 9.8781s
Updating learning rate to 0.0002349534789
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9253969192504883
Epoch: 1, Steps: 131 | Train Loss: 0.5597246 Vali Loss: 0.2756523 Best vali loss: 0.2756523
	iters: 100, epoch: 2 | loss: 0.3247566
	speed: 0.0089s/iter; left time: 7.2509s
Updating learning rate to 0.00011747673945
Validation loss decreased (0.2757 --> 0.2707).  Saving model state dict ...
Epoch: 2 cost time: 0.699284553527832
Epoch: 2, Steps: 131 | Train Loss: 0.3247566 Vali Loss: 0.2707139 Best vali loss: 0.2707139
	iters: 100, epoch: 3 | loss: 0.4619537
	speed: 0.0090s/iter; left time: 6.1757s
Updating learning rate to 5.8738369725e-05
Epoch: 3 cost time: 0.7051751613616943
Epoch: 3, Steps: 131 | Train Loss: 0.4619537 Vali Loss: 0.2803822 Best vali loss: 0.2707139
	iters: 100, epoch: 4 | loss: 0.5115038
	speed: 0.0087s/iter; left time: 4.8105s
Updating learning rate to 2.93691848625e-05
Epoch: 4 cost time: 0.6986985206604004
Epoch: 4, Steps: 131 | Train Loss: 0.5115038 Vali Loss: 0.2882727 Best vali loss: 0.2707139
	iters: 100, epoch: 5 | loss: 0.3330763
	speed: 0.0086s/iter; left time: 3.6536s
Updating learning rate to 1.468459243125e-05
Epoch: 5 cost time: 0.7012050151824951
Epoch: 5, Steps: 131 | Train Loss: 0.3330763 Vali Loss: 0.2898176 Best vali loss: 0.2707139
	iters: 100, epoch: 6 | loss: 0.3193828
	speed: 0.0086s/iter; left time: 2.5157s
Updating learning rate to 7.342296215625e-06
Epoch: 6 cost time: 0.6961736679077148
Epoch: 6, Steps: 131 | Train Loss: 0.3193828 Vali Loss: 0.2921143 Best vali loss: 0.2707139
	iters: 100, epoch: 7 | loss: 0.3110380
	speed: 0.0086s/iter; left time: 1.4087s
Updating learning rate to 3.6711481078125e-06
Epoch: 7 cost time: 0.7004477977752686
Epoch: 7, Steps: 131 | Train Loss: 0.3110380 Vali Loss: 0.3003455 Best vali loss: 0.2707139
	iters: 100, epoch: 8 | loss: 0.3967805
	speed: 0.0086s/iter; left time: 0.2754s
Updating learning rate to 1.83557405390625e-06
Epoch: 8 cost time: 0.697230339050293
Epoch: 8, Steps: 131 | Train Loss: 0.3967805 Vali Loss: 0.2981905 Best vali loss: 0.2707139

best validation loss 0.2707138934867805

[INFO][abstract_intensifier.py:595] Added config fc0914 and rejected config 99599f as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010229320995, 'e_layers': 2, 'learning_rate': 0.0002350621775, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597430
	speed: 0.0105s/iter; left time: 9.9913s
Updating learning rate to 0.0002350621775
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9285140037536621
Epoch: 1, Steps: 131 | Train Loss: 0.5597430 Vali Loss: 0.2756230 Best vali loss: 0.2756230
	iters: 100, epoch: 2 | loss: 0.3262955
	speed: 0.0090s/iter; left time: 7.3535s
Updating learning rate to 0.00011753108875
Validation loss decreased (0.2756 --> 0.2706).  Saving model state dict ...
Epoch: 2 cost time: 0.7076663970947266
Epoch: 2, Steps: 131 | Train Loss: 0.3262955 Vali Loss: 0.2705705 Best vali loss: 0.2705705
	iters: 100, epoch: 3 | loss: 0.4621677
	speed: 0.0091s/iter; left time: 6.2427s
Updating learning rate to 5.8765544375e-05
Epoch: 3 cost time: 0.7033939361572266
Epoch: 3, Steps: 131 | Train Loss: 0.4621677 Vali Loss: 0.2865951 Best vali loss: 0.2705705

best validation loss 0.2705704974347927

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0002391240249, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023002290861841467
Validation loss decreased (inf --> 0.2791).  Saving model state dict ...
Epoch: 1 cost time: 0.7323944568634033
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791489 Best vali loss: 0.2791489
Updating learning rate to 0.0002041051222257054
Validation loss decreased (0.2791 --> 0.2740).  Saving model state dict ...
Epoch: 2 cost time: 0.5163648128509521
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2739816 Best vali loss: 0.2739816
Updating learning rate to 0.0001653164137548436
Epoch: 3 cost time: 0.5178816318511963
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2768462 Best vali loss: 0.2739816

best validation loss 0.2739816246510616

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0085649803486, 'e_layers': 2, 'learning_rate': 0.0002417745375, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002417745375
Validation loss decreased (inf --> 0.2791).  Saving model state dict ...
Epoch: 1 cost time: 0.744330883026123
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791468 Best vali loss: 0.2791468
Updating learning rate to 0.00012088726875
Validation loss decreased (0.2791 --> 0.2735).  Saving model state dict ...
Epoch: 2 cost time: 0.5203273296356201
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2734604 Best vali loss: 0.2734604
Updating learning rate to 6.0443634375e-05
Epoch: 3 cost time: 0.5183818340301514
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2742428 Best vali loss: 0.2734604

best validation loss 0.27346041503228324

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010229320995, 'e_layers': 2, 'learning_rate': 0.0002350621775, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4243177
	speed: 0.0109s/iter; left time: 6.0574s
Updating learning rate to 2.93827721875e-05
Epoch: 4 cost time: 0.9370779991149902
Epoch: 4, Steps: 131 | Train Loss: 0.4243177 Vali Loss: 0.3118469 Best vali loss: 0.2705705
	iters: 100, epoch: 5 | loss: 0.2819742
	speed: 0.0086s/iter; left time: 3.6550s
Updating learning rate to 1.469138609375e-05
Epoch: 5 cost time: 0.6920502185821533
Epoch: 5, Steps: 131 | Train Loss: 0.2819742 Vali Loss: 0.2993622 Best vali loss: 0.2705705
	iters: 100, epoch: 6 | loss: 0.4345683
	speed: 0.0085s/iter; left time: 2.5130s
Updating learning rate to 7.345693046875e-06
Epoch: 6 cost time: 0.6982686519622803
Epoch: 6, Steps: 131 | Train Loss: 0.4345683 Vali Loss: 0.3049263 Best vali loss: 0.2705705
	iters: 100, epoch: 7 | loss: 0.4630707
	speed: 0.0085s/iter; left time: 1.3916s
Updating learning rate to 3.6728465234375e-06
Epoch: 7 cost time: 0.6993923187255859
Epoch: 7, Steps: 131 | Train Loss: 0.4630707 Vali Loss: 0.3009571 Best vali loss: 0.2705705
	iters: 100, epoch: 8 | loss: 0.3283034
	speed: 0.0085s/iter; left time: 0.2728s
Updating learning rate to 1.83642326171875e-06
Epoch: 8 cost time: 0.6928026676177979
Epoch: 8, Steps: 131 | Train Loss: 0.3283034 Vali Loss: 0.2984352 Best vali loss: 0.2705705

best validation loss 0.2705704974347927

[INFO][abstract_intensifier.py:595] Added config 966601 and rejected config fc0914 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5135518
	speed: 0.0112s/iter; left time: 10.5980s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.0175261497497559
Epoch: 1, Steps: 131 | Train Loss: 0.5135518 Vali Loss: 0.2873531 Best vali loss: 0.2873531
	iters: 100, epoch: 2 | loss: 0.3462625
	speed: 0.0092s/iter; left time: 7.5412s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.2874 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 0.7708585262298584
Epoch: 2, Steps: 131 | Train Loss: 0.3462625 Vali Loss: 0.2829465 Best vali loss: 0.2829465
	iters: 100, epoch: 3 | loss: 0.4458885
	speed: 0.0090s/iter; left time: 6.2147s
Updating learning rate to 0.000178512795825
Epoch: 3 cost time: 0.7460947036743164
Epoch: 3, Steps: 131 | Train Loss: 0.4458885 Vali Loss: 0.2830954 Best vali loss: 0.2829465
	iters: 100, epoch: 4 | loss: 0.4997855
	speed: 0.0089s/iter; left time: 4.9273s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 0.7435414791107178
Epoch: 4, Steps: 131 | Train Loss: 0.4997855 Vali Loss: 0.2906327 Best vali loss: 0.2829465
	iters: 100, epoch: 5 | loss: 0.3238942
	speed: 0.0093s/iter; left time: 3.9502s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 0.7928299903869629
Epoch: 5, Steps: 131 | Train Loss: 0.3238942 Vali Loss: 0.2876046 Best vali loss: 0.2829465
	iters: 100, epoch: 6 | loss: 0.5614570
	speed: 0.0094s/iter; left time: 2.7538s
Updating learning rate to 2.2314099478125e-05
Epoch: 6 cost time: 0.7964794635772705
Epoch: 6, Steps: 131 | Train Loss: 0.5614570 Vali Loss: 0.2881716 Best vali loss: 0.2829465
	iters: 100, epoch: 7 | loss: 0.4734257
	speed: 0.0092s/iter; left time: 1.5034s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 0.7836248874664307
Epoch: 7, Steps: 131 | Train Loss: 0.4734257 Vali Loss: 0.2874254 Best vali loss: 0.2829465
	iters: 100, epoch: 8 | loss: 0.2365951
	speed: 0.0093s/iter; left time: 0.2991s
Updating learning rate to 5.57852486953125e-06
Epoch: 8 cost time: 0.7911484241485596
Epoch: 8, Steps: 131 | Train Loss: 0.2365951 Vali Loss: 0.2890414 Best vali loss: 0.2829465

best validation loss 0.28294653935630154

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084216205378, 'e_layers': 2, 'learning_rate': 0.0002408164929, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002408164929
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 0.73785400390625
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791586 Best vali loss: 0.2791586
Updating learning rate to 0.00012040824645
Validation loss decreased (0.2792 --> 0.2739).  Saving model state dict ...
Epoch: 2 cost time: 0.5195343494415283
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2739202 Best vali loss: 0.2739202
Updating learning rate to 6.0204123225e-05
Epoch: 3 cost time: 0.5180220603942871
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2749732 Best vali loss: 0.2739202
Updating learning rate to 3.01020616125e-05
Epoch: 4 cost time: 0.5162374973297119
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2859752 Best vali loss: 0.2739202
Updating learning rate to 1.505103080625e-05
Epoch: 5 cost time: 0.5080232620239258
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2872796 Best vali loss: 0.2739202
Updating learning rate to 7.525515403125e-06
Epoch: 6 cost time: 0.510857343673706
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2945684 Best vali loss: 0.2739202
Updating learning rate to 3.7627577015625e-06
Epoch: 7 cost time: 0.5208916664123535
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3005437 Best vali loss: 0.2739202
Updating learning rate to 1.88137885078125e-06
Epoch: 8 cost time: 0.5145831108093262
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2948123 Best vali loss: 0.2739202

best validation loss 0.27392024782099395

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0088090923396, 'e_layers': 2, 'learning_rate': 0.0002404726238, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4972932
	speed: 0.0085s/iter; left time: 34.8828s
	iters: 200, epoch: 1 | loss: 0.2876633
	speed: 0.0034s/iter; left time: 13.5367s
	iters: 300, epoch: 1 | loss: 0.5383649
	speed: 0.0034s/iter; left time: 13.2657s
	iters: 400, epoch: 1 | loss: 0.5313163
	speed: 0.0034s/iter; left time: 12.8158s
	iters: 500, epoch: 1 | loss: 0.4953830
	speed: 0.0034s/iter; left time: 12.4150s
Updating learning rate to 0.0002404726238
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 2.036256790161133
Epoch: 1, Steps: 523 | Train Loss: 0.4700041 Vali Loss: 0.2802196 Best vali loss: 0.2802196
	iters: 100, epoch: 2 | loss: 0.3833587
	speed: 0.0073s/iter; left time: 25.8599s
	iters: 200, epoch: 2 | loss: 0.2123705
	speed: 0.0030s/iter; left time: 10.4009s
	iters: 300, epoch: 2 | loss: 0.4386765
	speed: 0.0030s/iter; left time: 10.1782s
	iters: 400, epoch: 2 | loss: 1.0451648
	speed: 0.0032s/iter; left time: 10.4383s
	iters: 500, epoch: 2 | loss: 0.6388887
	speed: 0.0030s/iter; left time: 9.4814s
Updating learning rate to 0.0001202363119
Validation loss decreased (0.2802 --> 0.2726).  Saving model state dict ...
Epoch: 2 cost time: 1.641404628753662
Epoch: 2, Steps: 523 | Train Loss: 0.5436919 Vali Loss: 0.2725689 Best vali loss: 0.2725689
	iters: 100, epoch: 3 | loss: 0.7071937
	speed: 0.0075s/iter; left time: 22.7718s
	iters: 200, epoch: 3 | loss: 0.4526644
	speed: 0.0032s/iter; left time: 9.4647s
	iters: 300, epoch: 3 | loss: 0.5490040
	speed: 0.0032s/iter; left time: 9.1481s
	iters: 400, epoch: 3 | loss: 0.2870196
	speed: 0.0031s/iter; left time: 8.4743s
	iters: 500, epoch: 3 | loss: 0.2288605
	speed: 0.0032s/iter; left time: 8.5515s
Updating learning rate to 6.011815595e-05
Validation loss decreased (0.2726 --> 0.2718).  Saving model state dict ...
Epoch: 3 cost time: 1.7146546840667725
Epoch: 3, Steps: 523 | Train Loss: 0.4449484 Vali Loss: 0.2717947 Best vali loss: 0.2717947

best validation loss 0.2717946648331724

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001023982482, 'e_layers': 2, 'learning_rate': 0.0002350621775, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597546
	speed: 0.0104s/iter; left time: 9.8827s
Updating learning rate to 0.0002350621775
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9318954944610596
Epoch: 1, Steps: 131 | Train Loss: 0.5597546 Vali Loss: 0.2756282 Best vali loss: 0.2756282
	iters: 100, epoch: 2 | loss: 0.3242798
	speed: 0.0090s/iter; left time: 7.3556s
Updating learning rate to 0.00011753108875
Validation loss decreased (0.2756 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.7096400260925293
Epoch: 2, Steps: 131 | Train Loss: 0.3242798 Vali Loss: 0.2722780 Best vali loss: 0.2722780
	iters: 100, epoch: 3 | loss: 0.4610350
	speed: 0.0090s/iter; left time: 6.2066s
Updating learning rate to 5.8765544375e-05
Epoch: 3 cost time: 0.7047295570373535
Epoch: 3, Steps: 131 | Train Loss: 0.4610350 Vali Loss: 0.2824059 Best vali loss: 0.2722780

best validation loss 0.27227798284939914

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010242618946, 'e_layers': 2, 'learning_rate': 0.0002344652356, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596899
	speed: 0.0104s/iter; left time: 9.8264s
Updating learning rate to 0.0002344652356
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.927056074142456
Epoch: 1, Steps: 131 | Train Loss: 0.5596899 Vali Loss: 0.2756258 Best vali loss: 0.2756258
	iters: 100, epoch: 2 | loss: 0.3254636
	speed: 0.0090s/iter; left time: 7.3349s
Updating learning rate to 0.0001172326178
Validation loss decreased (0.2756 --> 0.2699).  Saving model state dict ...
Epoch: 2 cost time: 0.7047715187072754
Epoch: 2, Steps: 131 | Train Loss: 0.3254636 Vali Loss: 0.2699146 Best vali loss: 0.2699146
	iters: 100, epoch: 3 | loss: 0.4643183
	speed: 0.0090s/iter; left time: 6.1497s
Updating learning rate to 5.86163089e-05
Epoch: 3 cost time: 0.7060902118682861
Epoch: 3, Steps: 131 | Train Loss: 0.4643183 Vali Loss: 0.2764061 Best vali loss: 0.2699146

best validation loss 0.26991459116611216

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010242618946, 'e_layers': 2, 'learning_rate': 0.0002344652356, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4245847
	speed: 0.0106s/iter; left time: 5.9005s
Updating learning rate to 2.930815445e-05
Epoch: 4 cost time: 0.9275028705596924
Epoch: 4, Steps: 131 | Train Loss: 0.4245847 Vali Loss: 0.2974001 Best vali loss: 0.2699146
	iters: 100, epoch: 5 | loss: 0.2802242
	speed: 0.0087s/iter; left time: 3.6889s
Updating learning rate to 1.4654077225e-05
Epoch: 5 cost time: 0.6983451843261719
Epoch: 5, Steps: 131 | Train Loss: 0.2802242 Vali Loss: 0.2981552 Best vali loss: 0.2699146
	iters: 100, epoch: 6 | loss: 0.4356058
	speed: 0.0087s/iter; left time: 2.5470s
Updating learning rate to 7.3270386125e-06
Epoch: 6 cost time: 0.7032186985015869
Epoch: 6, Steps: 131 | Train Loss: 0.4356058 Vali Loss: 0.2996411 Best vali loss: 0.2699146
	iters: 100, epoch: 7 | loss: 0.4648299
	speed: 0.0086s/iter; left time: 1.4022s
Updating learning rate to 3.66351930625e-06
Epoch: 7 cost time: 0.695655107498169
Epoch: 7, Steps: 131 | Train Loss: 0.4648299 Vali Loss: 0.2993894 Best vali loss: 0.2699146
	iters: 100, epoch: 8 | loss: 0.3251450
	speed: 0.0087s/iter; left time: 0.2793s
Updating learning rate to 1.831759653125e-06
Epoch: 8 cost time: 0.7071025371551514
Epoch: 8, Steps: 131 | Train Loss: 0.3251450 Vali Loss: 0.2957793 Best vali loss: 0.2699146

best validation loss 0.26991459116611216

[INFO][abstract_intensifier.py:595] Added config fa32a4 and rejected config 966601 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597192
	speed: 0.0104s/iter; left time: 9.8786s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9353427886962891
Epoch: 1, Steps: 131 | Train Loss: 0.5597192 Vali Loss: 0.2756283 Best vali loss: 0.2756283
	iters: 100, epoch: 2 | loss: 0.3242410
	speed: 0.0090s/iter; left time: 7.3224s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2683).  Saving model state dict ...
Epoch: 2 cost time: 0.7052311897277832
Epoch: 2, Steps: 131 | Train Loss: 0.3242410 Vali Loss: 0.2682513 Best vali loss: 0.2682513
	iters: 100, epoch: 3 | loss: 0.4595214
	speed: 0.0091s/iter; left time: 6.2798s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7079012393951416
Epoch: 3, Steps: 131 | Train Loss: 0.4595214 Vali Loss: 0.2758089 Best vali loss: 0.2682513
	iters: 100, epoch: 4 | loss: 0.5027649
	speed: 0.0086s/iter; left time: 4.7907s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6990664005279541
Epoch: 4, Steps: 131 | Train Loss: 0.5027649 Vali Loss: 0.2937009 Best vali loss: 0.2682513
	iters: 100, epoch: 5 | loss: 0.3329694
	speed: 0.0086s/iter; left time: 3.6743s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.703223466873169
Epoch: 5, Steps: 131 | Train Loss: 0.3329694 Vali Loss: 0.2905674 Best vali loss: 0.2682513
	iters: 100, epoch: 6 | loss: 0.3195593
	speed: 0.0087s/iter; left time: 2.5449s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7026927471160889
Epoch: 6, Steps: 131 | Train Loss: 0.3195593 Vali Loss: 0.2867512 Best vali loss: 0.2682513
	iters: 100, epoch: 7 | loss: 0.3125356
	speed: 0.0086s/iter; left time: 1.4052s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.699376106262207
Epoch: 7, Steps: 131 | Train Loss: 0.3125356 Vali Loss: 0.2939808 Best vali loss: 0.2682513
	iters: 100, epoch: 8 | loss: 0.3974875
	speed: 0.0087s/iter; left time: 0.2791s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7034890651702881
Epoch: 8, Steps: 131 | Train Loss: 0.3974875 Vali Loss: 0.2948959 Best vali loss: 0.2682513

best validation loss 0.2682512956908663

[INFO][abstract_intensifier.py:595] Added config b43035 and rejected config fa32a4 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597133
	speed: 0.0104s/iter; left time: 9.8989s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9396607875823975
Epoch: 1, Steps: 131 | Train Loss: 0.5597133 Vali Loss: 0.2756360 Best vali loss: 0.2756360
	iters: 100, epoch: 2 | loss: 0.3252299
	speed: 0.0089s/iter; left time: 7.3176s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2756 --> 0.2686).  Saving model state dict ...
Epoch: 2 cost time: 0.7075486183166504
Epoch: 2, Steps: 131 | Train Loss: 0.3252299 Vali Loss: 0.2686332 Best vali loss: 0.2686332
	iters: 100, epoch: 3 | loss: 0.4634069
	speed: 0.0090s/iter; left time: 6.1803s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.7016305923461914
Epoch: 3, Steps: 131 | Train Loss: 0.4634069 Vali Loss: 0.2777960 Best vali loss: 0.2686332
	iters: 100, epoch: 4 | loss: 0.5062832
	speed: 0.0087s/iter; left time: 4.8478s
Updating learning rate to 2.9310739475e-05
Epoch: 4 cost time: 0.7121107578277588
Epoch: 4, Steps: 131 | Train Loss: 0.5062832 Vali Loss: 0.2842081 Best vali loss: 0.2686332
	iters: 100, epoch: 5 | loss: 0.3324183
	speed: 0.0087s/iter; left time: 3.6983s
Updating learning rate to 1.46553697375e-05
Epoch: 5 cost time: 0.6988615989685059
Epoch: 5, Steps: 131 | Train Loss: 0.3324183 Vali Loss: 0.2843247 Best vali loss: 0.2686332
	iters: 100, epoch: 6 | loss: 0.3184185
	speed: 0.0087s/iter; left time: 2.5550s
Updating learning rate to 7.32768486875e-06
Epoch: 6 cost time: 0.7047345638275146
Epoch: 6, Steps: 131 | Train Loss: 0.3184185 Vali Loss: 0.2848023 Best vali loss: 0.2686332
	iters: 100, epoch: 7 | loss: 0.3100607
	speed: 0.0087s/iter; left time: 1.4211s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 0.7024688720703125
Epoch: 7, Steps: 131 | Train Loss: 0.3100607 Vali Loss: 0.2879328 Best vali loss: 0.2686332
	iters: 100, epoch: 8 | loss: 0.3994552
	speed: 0.0087s/iter; left time: 0.2780s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 0.7009754180908203
Epoch: 8, Steps: 131 | Train Loss: 0.3994552 Vali Loss: 0.2902172 Best vali loss: 0.2686332

best validation loss 0.26863319962917537

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010222475799, 'e_layers': 2, 'learning_rate': 0.0002349534789, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597477
	speed: 0.0102s/iter; left time: 9.6940s
Updating learning rate to 0.0002349534789
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9219260215759277
Epoch: 1, Steps: 131 | Train Loss: 0.5597477 Vali Loss: 0.2756470 Best vali loss: 0.2756470
	iters: 100, epoch: 2 | loss: 0.3243680
	speed: 0.0090s/iter; left time: 7.3441s
Updating learning rate to 0.00011747673945
Validation loss decreased (0.2756 --> 0.2726).  Saving model state dict ...
Epoch: 2 cost time: 0.7102696895599365
Epoch: 2, Steps: 131 | Train Loss: 0.3243680 Vali Loss: 0.2725942 Best vali loss: 0.2725942
	iters: 100, epoch: 3 | loss: 0.4609085
	speed: 0.0091s/iter; left time: 6.2623s
Updating learning rate to 5.8738369725e-05
Epoch: 3 cost time: 0.7062764167785645
Epoch: 3, Steps: 131 | Train Loss: 0.4609085 Vali Loss: 0.2798150 Best vali loss: 0.2725942

best validation loss 0.2725941651414521

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009258936917, 'e_layers': 2, 'learning_rate': 0.0002349515266, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596972
	speed: 0.0105s/iter; left time: 9.9248s
Updating learning rate to 0.0002349515266
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9306631088256836
Epoch: 1, Steps: 131 | Train Loss: 0.5596972 Vali Loss: 0.2756318 Best vali loss: 0.2756318
	iters: 100, epoch: 2 | loss: 0.3222884
	speed: 0.0088s/iter; left time: 7.2267s
Updating learning rate to 0.0001174757633
Validation loss decreased (0.2756 --> 0.2730).  Saving model state dict ...
Epoch: 2 cost time: 0.7065620422363281
Epoch: 2, Steps: 131 | Train Loss: 0.3222884 Vali Loss: 0.2729899 Best vali loss: 0.2729899
	iters: 100, epoch: 3 | loss: 0.4611466
	speed: 0.0089s/iter; left time: 6.1467s
Updating learning rate to 5.873788165e-05
Epoch: 3 cost time: 0.7035708427429199
Epoch: 3, Steps: 131 | Train Loss: 0.4611466 Vali Loss: 0.2823987 Best vali loss: 0.2729899

best validation loss 0.2729899474305706

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.000904631374, 'e_layers': 2, 'learning_rate': 0.0002346617798, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596646
	speed: 0.0104s/iter; left time: 9.8282s
Updating learning rate to 0.0002346617798
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9223906993865967
Epoch: 1, Steps: 131 | Train Loss: 0.5596646 Vali Loss: 0.2756475 Best vali loss: 0.2756475
	iters: 100, epoch: 2 | loss: 0.3234338
	speed: 0.0089s/iter; left time: 7.2808s
Updating learning rate to 0.0001173308899
Validation loss decreased (0.2756 --> 0.2737).  Saving model state dict ...
Epoch: 2 cost time: 0.7077858448028564
Epoch: 2, Steps: 131 | Train Loss: 0.3234338 Vali Loss: 0.2737333 Best vali loss: 0.2737333
	iters: 100, epoch: 3 | loss: 0.4612800
	speed: 0.0091s/iter; left time: 6.2519s
Updating learning rate to 5.866544495e-05
Epoch: 3 cost time: 0.7057027816772461
Epoch: 3, Steps: 131 | Train Loss: 0.4612800 Vali Loss: 0.2797419 Best vali loss: 0.2737333

best validation loss 0.2737332644428006

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010222475799, 'e_layers': 2, 'learning_rate': 0.0002349534789, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4257423
	speed: 0.0108s/iter; left time: 5.9820s
Updating learning rate to 2.93691848625e-05
Epoch: 4 cost time: 0.9348156452178955
Epoch: 4, Steps: 131 | Train Loss: 0.4257423 Vali Loss: 0.3111358 Best vali loss: 0.2725942
	iters: 100, epoch: 5 | loss: 0.2828091
	speed: 0.0088s/iter; left time: 3.7190s
Updating learning rate to 1.468459243125e-05
Epoch: 5 cost time: 0.703885555267334
Epoch: 5, Steps: 131 | Train Loss: 0.2828091 Vali Loss: 0.3017354 Best vali loss: 0.2725942
	iters: 100, epoch: 6 | loss: 0.4346331
	speed: 0.0087s/iter; left time: 2.5472s
Updating learning rate to 7.342296215625e-06
Epoch: 6 cost time: 0.7082033157348633
Epoch: 6, Steps: 131 | Train Loss: 0.4346331 Vali Loss: 0.3012603 Best vali loss: 0.2725942
	iters: 100, epoch: 7 | loss: 0.4673941
	speed: 0.0087s/iter; left time: 1.4148s
Updating learning rate to 3.6711481078125e-06
Epoch: 7 cost time: 0.6987011432647705
Epoch: 7, Steps: 131 | Train Loss: 0.4673941 Vali Loss: 0.3001869 Best vali loss: 0.2725942
	iters: 100, epoch: 8 | loss: 0.3270153
	speed: 0.0086s/iter; left time: 0.2765s
Updating learning rate to 1.83557405390625e-06
Epoch: 8 cost time: 0.6987924575805664
Epoch: 8, Steps: 131 | Train Loss: 0.3270153 Vali Loss: 0.3000262 Best vali loss: 0.2725942

best validation loss 0.2725941651414521

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010246716793, 'e_layers': 2, 'learning_rate': 0.0002318336459, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5594465
	speed: 0.0103s/iter; left time: 9.7552s
Updating learning rate to 0.0002318336459
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9281439781188965
Epoch: 1, Steps: 131 | Train Loss: 0.5594465 Vali Loss: 0.2756249 Best vali loss: 0.2756249
	iters: 100, epoch: 2 | loss: 0.3267356
	speed: 0.0089s/iter; left time: 7.3064s
Updating learning rate to 0.00011591682295
Validation loss decreased (0.2756 --> 0.2728).  Saving model state dict ...
Epoch: 2 cost time: 0.7063295841217041
Epoch: 2, Steps: 131 | Train Loss: 0.3267356 Vali Loss: 0.2728164 Best vali loss: 0.2728164
	iters: 100, epoch: 3 | loss: 0.4649628
	speed: 0.0091s/iter; left time: 6.2186s
Updating learning rate to 5.7958411475e-05
Epoch: 3 cost time: 0.7055492401123047
Epoch: 3, Steps: 131 | Train Loss: 0.4649628 Vali Loss: 0.2863579 Best vali loss: 0.2728164
	iters: 100, epoch: 4 | loss: 0.5030324
	speed: 0.0086s/iter; left time: 4.7781s
Updating learning rate to 2.89792057375e-05
Epoch: 4 cost time: 0.698810338973999
Epoch: 4, Steps: 131 | Train Loss: 0.5030324 Vali Loss: 0.2906722 Best vali loss: 0.2728164
	iters: 100, epoch: 5 | loss: 0.3324784
	speed: 0.0086s/iter; left time: 3.6435s
Updating learning rate to 1.448960286875e-05
Epoch: 5 cost time: 0.6979985237121582
Epoch: 5, Steps: 131 | Train Loss: 0.3324784 Vali Loss: 0.2935374 Best vali loss: 0.2728164
	iters: 100, epoch: 6 | loss: 0.3173115
	speed: 0.0086s/iter; left time: 2.5289s
Updating learning rate to 7.244801434375e-06
Epoch: 6 cost time: 0.7009453773498535
Epoch: 6, Steps: 131 | Train Loss: 0.3173115 Vali Loss: 0.2968075 Best vali loss: 0.2728164
	iters: 100, epoch: 7 | loss: 0.3140604
	speed: 0.0086s/iter; left time: 1.4002s
Updating learning rate to 3.6224007171875e-06
Epoch: 7 cost time: 0.6975255012512207
Epoch: 7, Steps: 131 | Train Loss: 0.3140604 Vali Loss: 0.3047360 Best vali loss: 0.2728164
	iters: 100, epoch: 8 | loss: 0.3961675
	speed: 0.0085s/iter; left time: 0.2729s
Updating learning rate to 1.81120035859375e-06
Epoch: 8 cost time: 0.696998119354248
Epoch: 8, Steps: 131 | Train Loss: 0.3961675 Vali Loss: 0.3032012 Best vali loss: 0.2728164

best validation loss 0.2728164374673176

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4353122
	speed: 0.0103s/iter; left time: 9.8123s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.9327354431152344
Epoch: 1, Steps: 131 | Train Loss: 0.4353122 Vali Loss: 0.2793132 Best vali loss: 0.2793132
	iters: 100, epoch: 2 | loss: 0.3375421
	speed: 0.0089s/iter; left time: 7.2825s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2793 --> 0.2768).  Saving model state dict ...
Epoch: 2 cost time: 0.7040269374847412
Epoch: 2, Steps: 131 | Train Loss: 0.3375421 Vali Loss: 0.2768490 Best vali loss: 0.2768490
	iters: 100, epoch: 3 | loss: 0.3069846
	speed: 0.0091s/iter; left time: 6.2363s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2768 --> 0.2761).  Saving model state dict ...
Epoch: 3 cost time: 0.7068102359771729
Epoch: 3, Steps: 131 | Train Loss: 0.3069846 Vali Loss: 0.2760502 Best vali loss: 0.2760502
	iters: 100, epoch: 4 | loss: 0.2813764
	speed: 0.0091s/iter; left time: 5.0463s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7037553787231445
Epoch: 4, Steps: 131 | Train Loss: 0.2813764 Vali Loss: 0.2794705 Best vali loss: 0.2760502
	iters: 100, epoch: 5 | loss: 0.2787225
	speed: 0.0086s/iter; left time: 3.6499s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6962096691131592
Epoch: 5, Steps: 131 | Train Loss: 0.2787225 Vali Loss: 0.2813867 Best vali loss: 0.2760502
	iters: 100, epoch: 6 | loss: 0.3063218
	speed: 0.0086s/iter; left time: 2.5323s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7004549503326416
Epoch: 6, Steps: 131 | Train Loss: 0.3063218 Vali Loss: 0.2797477 Best vali loss: 0.2760502
	iters: 100, epoch: 7 | loss: 0.2714681
	speed: 0.0086s/iter; left time: 1.4061s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.698631763458252
Epoch: 7, Steps: 131 | Train Loss: 0.2714681 Vali Loss: 0.2812543 Best vali loss: 0.2760502
	iters: 100, epoch: 8 | loss: 0.3374504
	speed: 0.0086s/iter; left time: 0.2759s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7010171413421631
Epoch: 8, Steps: 131 | Train Loss: 0.3374504 Vali Loss: 0.2812762 Best vali loss: 0.2760502

best validation loss 0.27605015572538694

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010271259146, 'e_layers': 2, 'learning_rate': 0.0002345861556, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4352714
	speed: 0.0102s/iter; left time: 9.7255s
Updating learning rate to 0.00022565775168467396
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.9229617118835449
Epoch: 1, Steps: 131 | Train Loss: 0.4352714 Vali Loss: 0.2793498 Best vali loss: 0.2793498
	iters: 100, epoch: 2 | loss: 0.3369961
	speed: 0.0088s/iter; left time: 7.2138s
Updating learning rate to 0.00020023180849862128
Validation loss decreased (0.2793 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 0.6990015506744385
Epoch: 2, Steps: 131 | Train Loss: 0.3369961 Vali Loss: 0.2765661 Best vali loss: 0.2765661
	iters: 100, epoch: 3 | loss: 0.3174608
	speed: 0.0089s/iter; left time: 6.1248s
Updating learning rate to 0.0001621791954051695
Epoch: 3 cost time: 0.6978859901428223
Epoch: 3, Steps: 131 | Train Loss: 0.3174608 Vali Loss: 0.2808844 Best vali loss: 0.2765661

best validation loss 0.2765661372476548

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004191723262, 'e_layers': 3, 'learning_rate': 0.0043478566088, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0043478566088
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 0.6028826236724854
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2868655 Best vali loss: 0.2868655
Updating learning rate to 0.0021739283044
Epoch: 2 cost time: 0.3810701370239258
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2951149 Best vali loss: 0.2868655
Updating learning rate to 0.0010869641522
Epoch: 3 cost time: 0.38284754753112793
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2931231 Best vali loss: 0.2868655

best validation loss 0.2868654887531716

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4353109
	speed: 0.0104s/iter; left time: 9.8936s
Updating learning rate to 0.00022556132703489248
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.9356203079223633
Epoch: 1, Steps: 131 | Train Loss: 0.4353109 Vali Loss: 0.2793238 Best vali loss: 0.2793238
	iters: 100, epoch: 2 | loss: 0.3405030
	speed: 0.0089s/iter; left time: 7.2688s
Updating learning rate to 0.0002001462484774589
Validation loss decreased (0.2793 --> 0.2770).  Saving model state dict ...
Epoch: 2 cost time: 0.7041127681732178
Epoch: 2, Steps: 131 | Train Loss: 0.3405030 Vali Loss: 0.2770330 Best vali loss: 0.2770330
	iters: 100, epoch: 3 | loss: 0.3075006
	speed: 0.0089s/iter; left time: 6.1052s
Updating learning rate to 0.00016210989544980772
Epoch: 3 cost time: 0.7031006813049316
Epoch: 3, Steps: 131 | Train Loss: 0.3075006 Vali Loss: 0.2781838 Best vali loss: 0.2770330

best validation loss 0.2770329939028994

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010271259146, 'e_layers': 2, 'learning_rate': 0.0002345861556, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3630704
	speed: 0.0108s/iter; left time: 5.9907s
Updating learning rate to 0.0001172930778
Epoch: 4 cost time: 0.9344046115875244
Epoch: 4, Steps: 131 | Train Loss: 0.3630704 Vali Loss: 0.2871516 Best vali loss: 0.2765661
	iters: 100, epoch: 5 | loss: 0.3028237
	speed: 0.0088s/iter; left time: 3.7316s
Updating learning rate to 7.240696019483049e-05
Epoch: 5 cost time: 0.7082273960113525
Epoch: 5, Steps: 131 | Train Loss: 0.3028237 Vali Loss: 0.2863456 Best vali loss: 0.2765661
	iters: 100, epoch: 6 | loss: 0.2748372
	speed: 0.0089s/iter; left time: 2.6051s
Updating learning rate to 3.435434710137871e-05
Epoch: 6 cost time: 0.7045474052429199
Epoch: 6, Steps: 131 | Train Loss: 0.2748372 Vali Loss: 0.2907330 Best vali loss: 0.2765661
	iters: 100, epoch: 7 | loss: 0.2608205
	speed: 0.0087s/iter; left time: 1.4255s
Updating learning rate to 8.928403915326014e-06
Epoch: 7 cost time: 0.7034862041473389
Epoch: 7, Steps: 131 | Train Loss: 0.2608205 Vali Loss: 0.2960523 Best vali loss: 0.2765661
	iters: 100, epoch: 8 | loss: 0.2490317
	speed: 0.0086s/iter; left time: 0.2750s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6995589733123779
Epoch: 8, Steps: 131 | Train Loss: 0.2490317 Vali Loss: 0.2976070 Best vali loss: 0.2765661

best validation loss 0.2765661372476548

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010259774245, 'e_layers': 3, 'learning_rate': 5.14999302e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5227262
	speed: 0.0127s/iter; left time: 12.0239s
Updating learning rate to 5.14999302e-05
Validation loss decreased (inf --> 0.2784).  Saving model state dict ...
Epoch: 1 cost time: 1.2213826179504395
Epoch: 1, Steps: 131 | Train Loss: 0.5227262 Vali Loss: 0.2783697 Best vali loss: 0.2783697
	iters: 100, epoch: 2 | loss: 0.4621345
	speed: 0.0123s/iter; left time: 10.0611s
Updating learning rate to 2.57499651e-05
Epoch: 2 cost time: 1.0092225074768066
Epoch: 2, Steps: 131 | Train Loss: 0.4621345 Vali Loss: 0.2787248 Best vali loss: 0.2783697
	iters: 100, epoch: 3 | loss: 0.3445145
	speed: 0.0121s/iter; left time: 8.2811s
Updating learning rate to 1.287498255e-05
Validation loss decreased (0.2784 --> 0.2764).  Saving model state dict ...
Epoch: 3 cost time: 1.008920669555664
Epoch: 3, Steps: 131 | Train Loss: 0.3445145 Vali Loss: 0.2764275 Best vali loss: 0.2764275
	iters: 100, epoch: 4 | loss: 0.5897033
	speed: 0.0125s/iter; left time: 6.9564s
Updating learning rate to 6.437491275e-06
Epoch: 4 cost time: 1.002089500427246
Epoch: 4, Steps: 131 | Train Loss: 0.5897033 Vali Loss: 0.2766200 Best vali loss: 0.2764275
	iters: 100, epoch: 5 | loss: 0.5437733
	speed: 0.0120s/iter; left time: 5.1013s
Updating learning rate to 3.2187456375e-06
Epoch: 5 cost time: 0.9973437786102295
Epoch: 5, Steps: 131 | Train Loss: 0.5437733 Vali Loss: 0.2767099 Best vali loss: 0.2764275
	iters: 100, epoch: 6 | loss: 0.4979725
	speed: 0.0120s/iter; left time: 3.5222s
Updating learning rate to 1.60937281875e-06
Validation loss decreased (0.2764 --> 0.2763).  Saving model state dict ...
Epoch: 6 cost time: 1.0016672611236572
Epoch: 6, Steps: 131 | Train Loss: 0.4979725 Vali Loss: 0.2762554 Best vali loss: 0.2762554
	iters: 100, epoch: 7 | loss: 0.4627931
	speed: 0.0126s/iter; left time: 2.0473s
Updating learning rate to 8.04686409375e-07
Epoch: 7 cost time: 1.0062837600708008
Epoch: 7, Steps: 131 | Train Loss: 0.4627931 Vali Loss: 0.2762982 Best vali loss: 0.2762554
	iters: 100, epoch: 8 | loss: 0.2563667
	speed: 0.0120s/iter; left time: 0.3850s
Updating learning rate to 4.023432046875e-07
Epoch: 8 cost time: 0.9993371963500977
Epoch: 8, Steps: 131 | Train Loss: 0.2563667 Vali Loss: 0.2763267 Best vali loss: 0.2762554

best validation loss 0.2762554081987386

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010257980271, 'e_layers': 3, 'learning_rate': 0.0002040872158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5090005
	speed: 0.0134s/iter; left time: 12.6729s
Updating learning rate to 0.0002040872158
Validation loss decreased (inf --> 0.2807).  Saving model state dict ...
Epoch: 1 cost time: 1.3225977420806885
Epoch: 1, Steps: 131 | Train Loss: 0.5090005 Vali Loss: 0.2806828 Best vali loss: 0.2806828
	iters: 100, epoch: 2 | loss: 0.3924981
	speed: 0.0133s/iter; left time: 10.8732s
Updating learning rate to 0.0001020436079
Validation loss decreased (0.2807 --> 0.2733).  Saving model state dict ...
Epoch: 2 cost time: 1.0942916870117188
Epoch: 2, Steps: 131 | Train Loss: 0.3924981 Vali Loss: 0.2732629 Best vali loss: 0.2732629
	iters: 100, epoch: 3 | loss: 0.4275736
	speed: 0.0135s/iter; left time: 9.2747s
Updating learning rate to 5.102180395e-05
Epoch: 3 cost time: 1.0937530994415283
Epoch: 3, Steps: 131 | Train Loss: 0.4275736 Vali Loss: 0.2848271 Best vali loss: 0.2732629
	iters: 100, epoch: 4 | loss: 0.4114507
	speed: 0.0130s/iter; left time: 7.2194s
Updating learning rate to 2.5510901975e-05
Epoch: 4 cost time: 1.0885186195373535
Epoch: 4, Steps: 131 | Train Loss: 0.4114507 Vali Loss: 0.2755189 Best vali loss: 0.2732629
	iters: 100, epoch: 5 | loss: 0.3545592
	speed: 0.0129s/iter; left time: 5.4939s
Updating learning rate to 1.27554509875e-05
Epoch: 5 cost time: 1.0939643383026123
Epoch: 5, Steps: 131 | Train Loss: 0.3545592 Vali Loss: 0.2786941 Best vali loss: 0.2732629
	iters: 100, epoch: 6 | loss: 0.3717133
	speed: 0.0129s/iter; left time: 3.8043s
Updating learning rate to 6.37772549375e-06
Epoch: 6 cost time: 1.0868916511535645
Epoch: 6, Steps: 131 | Train Loss: 0.3717133 Vali Loss: 0.2775049 Best vali loss: 0.2732629
	iters: 100, epoch: 7 | loss: 0.3138779
	speed: 0.0129s/iter; left time: 2.1083s
Updating learning rate to 3.188862746875e-06
Epoch: 7 cost time: 1.088637113571167
Epoch: 7, Steps: 131 | Train Loss: 0.3138779 Vali Loss: 0.2793905 Best vali loss: 0.2732629
	iters: 100, epoch: 8 | loss: 0.3291377
	speed: 0.0129s/iter; left time: 0.4139s
Updating learning rate to 1.5944313734375e-06
Epoch: 8 cost time: 1.0917644500732422
Epoch: 8, Steps: 131 | Train Loss: 0.3291377 Vali Loss: 0.2795619 Best vali loss: 0.2732629

best validation loss 0.2732629249445255

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5457089
	speed: 0.0094s/iter; left time: 38.4702s
	iters: 200, epoch: 1 | loss: 0.3453482
	speed: 0.0042s/iter; left time: 16.6988s
	iters: 300, epoch: 1 | loss: 0.7708580
	speed: 0.0043s/iter; left time: 16.5646s
	iters: 400, epoch: 1 | loss: 0.8175723
	speed: 0.0042s/iter; left time: 16.0385s
	iters: 500, epoch: 1 | loss: 0.5403184
	speed: 0.0043s/iter; left time: 15.7207s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 2.4712281227111816
Epoch: 1, Steps: 523 | Train Loss: 0.6039612 Vali Loss: 0.2847145 Best vali loss: 0.2847145
	iters: 100, epoch: 2 | loss: 0.3050781
	speed: 0.0086s/iter; left time: 30.7361s
	iters: 200, epoch: 2 | loss: 0.6690531
	speed: 0.0043s/iter; left time: 14.8349s
	iters: 300, epoch: 2 | loss: 0.3442354
	speed: 0.0041s/iter; left time: 13.7652s
	iters: 400, epoch: 2 | loss: 0.3855413
	speed: 0.0041s/iter; left time: 13.3556s
	iters: 500, epoch: 2 | loss: 0.2462930
	speed: 0.0041s/iter; left time: 13.0789s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 2.210604190826416
Epoch: 2, Steps: 523 | Train Loss: 0.3900402 Vali Loss: 0.2869451 Best vali loss: 0.2847145
	iters: 100, epoch: 3 | loss: 0.4185456
	speed: 0.0084s/iter; left time: 25.6485s
	iters: 200, epoch: 3 | loss: 0.8505863
	speed: 0.0040s/iter; left time: 11.7200s
	iters: 300, epoch: 3 | loss: 0.5458928
	speed: 0.0040s/iter; left time: 11.2169s
	iters: 400, epoch: 3 | loss: 0.2873568
	speed: 0.0040s/iter; left time: 11.0127s
	iters: 500, epoch: 3 | loss: 0.4632634
	speed: 0.0040s/iter; left time: 10.5553s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 2.1285088062286377
Epoch: 3, Steps: 523 | Train Loss: 0.5131290 Vali Loss: 0.2923983 Best vali loss: 0.2847145

best validation loss 0.28471446454569327

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.001027104979, 'e_layers': 3, 'learning_rate': 0.0001011102217, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5065570
	speed: 0.0134s/iter; left time: 12.7300s
Updating learning rate to 9.726194302815428e-05
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 1.322274923324585
Epoch: 1, Steps: 131 | Train Loss: 0.5065570 Vali Loss: 0.2793354 Best vali loss: 0.2793354
	iters: 100, epoch: 2 | loss: 0.3961873
	speed: 0.0132s/iter; left time: 10.8024s
Updating learning rate to 8.630297255567261e-05
Epoch: 2 cost time: 1.088669776916504
Epoch: 2, Steps: 131 | Train Loss: 0.3961873 Vali Loss: 0.2816591 Best vali loss: 0.2793354
	iters: 100, epoch: 3 | loss: 0.4605400
	speed: 0.0129s/iter; left time: 8.8308s
Updating learning rate to 6.99017141936756e-05
Epoch: 3 cost time: 1.0814101696014404
Epoch: 3, Steps: 131 | Train Loss: 0.4605400 Vali Loss: 0.2928504 Best vali loss: 0.2793354

best validation loss 0.2793353902845854

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5307705
	speed: 0.0104s/iter; left time: 9.9072s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 0.9413254261016846
Epoch: 1, Steps: 131 | Train Loss: 0.5307705 Vali Loss: 0.2778702 Best vali loss: 0.2778702
	iters: 100, epoch: 2 | loss: 0.4601234
	speed: 0.0091s/iter; left time: 7.4477s
Updating learning rate to 0.00020018128291779717
Epoch: 2 cost time: 0.7212159633636475
Epoch: 2, Steps: 131 | Train Loss: 0.4601234 Vali Loss: 0.2874450 Best vali loss: 0.2778702
	iters: 100, epoch: 3 | loss: 0.4643113
	speed: 0.0088s/iter; left time: 6.0582s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7219369411468506
Epoch: 3, Steps: 131 | Train Loss: 0.4643113 Vali Loss: 0.3035461 Best vali loss: 0.2778702

best validation loss 0.2778702201720018

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3517729
	speed: 0.0108s/iter; left time: 5.9791s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.9521353244781494
Epoch: 4, Steps: 131 | Train Loss: 0.3517729 Vali Loss: 0.2810266 Best vali loss: 0.2778702
	iters: 100, epoch: 5 | loss: 0.3285225
	speed: 0.0089s/iter; left time: 3.7836s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.7107999324798584
Epoch: 5, Steps: 131 | Train Loss: 0.3285225 Vali Loss: 0.2974876 Best vali loss: 0.2778702
	iters: 100, epoch: 6 | loss: 0.3592200
	speed: 0.0088s/iter; left time: 2.5728s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7146251201629639
Epoch: 6, Steps: 131 | Train Loss: 0.3592200 Vali Loss: 0.2947687 Best vali loss: 0.2778702
	iters: 100, epoch: 7 | loss: 0.3268619
	speed: 0.0089s/iter; left time: 1.4500s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.7223398685455322
Epoch: 7, Steps: 131 | Train Loss: 0.3268619 Vali Loss: 0.2978533 Best vali loss: 0.2778702
	iters: 100, epoch: 8 | loss: 0.5183105
	speed: 0.0088s/iter; left time: 0.2820s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7171697616577148
Epoch: 8, Steps: 131 | Train Loss: 0.5183105 Vali Loss: 0.2968781 Best vali loss: 0.2778702

best validation loss 0.2778702201720018

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4096467
	speed: 0.0106s/iter; left time: 10.0872s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 0.9549770355224609
Epoch: 1, Steps: 131 | Train Loss: 0.4096467 Vali Loss: 0.2795920 Best vali loss: 0.2795920
	iters: 100, epoch: 2 | loss: 0.5544645
	speed: 0.0092s/iter; left time: 7.5181s
Updating learning rate to 0.00020018128291779717
Epoch: 2 cost time: 0.7327120304107666
Epoch: 2, Steps: 131 | Train Loss: 0.5544645 Vali Loss: 0.2825462 Best vali loss: 0.2795920
	iters: 100, epoch: 3 | loss: 0.4803485
	speed: 0.0090s/iter; left time: 6.1901s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.734224796295166
Epoch: 3, Steps: 131 | Train Loss: 0.4803485 Vali Loss: 0.2904750 Best vali loss: 0.2795920
	iters: 100, epoch: 4 | loss: 0.4364286
	speed: 0.0090s/iter; left time: 5.0016s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.7293987274169922
Epoch: 4, Steps: 131 | Train Loss: 0.4364286 Vali Loss: 0.2813485 Best vali loss: 0.2795920
	iters: 100, epoch: 5 | loss: 0.4201134
	speed: 0.0090s/iter; left time: 3.8257s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.7300107479095459
Epoch: 5, Steps: 131 | Train Loss: 0.4201134 Vali Loss: 0.2862471 Best vali loss: 0.2795920
	iters: 100, epoch: 6 | loss: 0.4004342
	speed: 0.0090s/iter; left time: 2.6450s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7360701560974121
Epoch: 6, Steps: 131 | Train Loss: 0.4004342 Vali Loss: 0.2888538 Best vali loss: 0.2795920
	iters: 100, epoch: 7 | loss: 0.2857746
	speed: 0.0090s/iter; left time: 1.4658s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.7401461601257324
Epoch: 7, Steps: 131 | Train Loss: 0.2857746 Vali Loss: 0.2915308 Best vali loss: 0.2795920
	iters: 100, epoch: 8 | loss: 0.2246546
	speed: 0.0091s/iter; left time: 0.2913s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7354884147644043
Epoch: 8, Steps: 131 | Train Loss: 0.2246546 Vali Loss: 0.2900337 Best vali loss: 0.2795920

best validation loss 0.2795920066006257

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010266505806, 'e_layers': 2, 'learning_rate': 0.0002394518032, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3552253
	speed: 0.0089s/iter; left time: 36.3734s
	iters: 200, epoch: 1 | loss: 0.4104273
	speed: 0.0035s/iter; left time: 13.9554s
	iters: 300, epoch: 1 | loss: 0.5999610
	speed: 0.0034s/iter; left time: 13.3924s
	iters: 400, epoch: 1 | loss: 0.7416302
	speed: 0.0034s/iter; left time: 12.7328s
	iters: 500, epoch: 1 | loss: 0.4073518
	speed: 0.0034s/iter; left time: 12.4552s
Updating learning rate to 0.0002394518032
Validation loss decreased (inf --> 0.2824).  Saving model state dict ...
Epoch: 1 cost time: 2.070671558380127
Epoch: 1, Steps: 523 | Train Loss: 0.5029191 Vali Loss: 0.2823914 Best vali loss: 0.2823914
	iters: 100, epoch: 2 | loss: 0.8031589
	speed: 0.0082s/iter; left time: 29.2799s
	iters: 200, epoch: 2 | loss: 0.4499600
	speed: 0.0037s/iter; left time: 12.6449s
	iters: 300, epoch: 2 | loss: 0.6165176
	speed: 0.0036s/iter; left time: 12.2015s
	iters: 400, epoch: 2 | loss: 0.4482142
	speed: 0.0037s/iter; left time: 11.9455s
	iters: 500, epoch: 2 | loss: 0.6635417
	speed: 0.0036s/iter; left time: 11.3818s
Updating learning rate to 0.0001197259016
Validation loss decreased (0.2824 --> 0.2803).  Saving model state dict ...
Epoch: 2 cost time: 1.942347526550293
Epoch: 2, Steps: 523 | Train Loss: 0.5962785 Vali Loss: 0.2802955 Best vali loss: 0.2802955
	iters: 100, epoch: 3 | loss: 0.4410772
	speed: 0.0081s/iter; left time: 24.6127s
	iters: 200, epoch: 3 | loss: 0.3013108
	speed: 0.0035s/iter; left time: 10.3351s
	iters: 300, epoch: 3 | loss: 0.4251672
	speed: 0.0035s/iter; left time: 9.9654s
	iters: 400, epoch: 3 | loss: 0.6016693
	speed: 0.0035s/iter; left time: 9.6247s
	iters: 500, epoch: 3 | loss: 0.4723799
	speed: 0.0035s/iter; left time: 9.2534s
Updating learning rate to 5.98629508e-05
Epoch: 3 cost time: 1.8766238689422607
Epoch: 3, Steps: 523 | Train Loss: 0.4483209 Vali Loss: 0.2878763 Best vali loss: 0.2802955
	iters: 100, epoch: 4 | loss: 0.3598431
	speed: 0.0076s/iter; left time: 19.0175s
	iters: 200, epoch: 4 | loss: 0.7705382
	speed: 0.0033s/iter; left time: 8.0778s
	iters: 300, epoch: 4 | loss: 0.2846656
	speed: 0.0032s/iter; left time: 7.3113s
	iters: 400, epoch: 4 | loss: 0.4553472
	speed: 0.0031s/iter; left time: 6.8451s
	iters: 500, epoch: 4 | loss: 0.3873301
	speed: 0.0031s/iter; left time: 6.6428s
Updating learning rate to 2.99314754e-05
Validation loss decreased (0.2803 --> 0.2770).  Saving model state dict ...
Epoch: 4 cost time: 1.7140674591064453
Epoch: 4, Steps: 523 | Train Loss: 0.4515449 Vali Loss: 0.2770426 Best vali loss: 0.2770426
	iters: 100, epoch: 5 | loss: 0.5489553
	speed: 0.0074s/iter; left time: 14.7315s
	iters: 200, epoch: 5 | loss: 0.2996892
	speed: 0.0030s/iter; left time: 5.7025s
	iters: 300, epoch: 5 | loss: 0.2582310
	speed: 0.0030s/iter; left time: 5.4346s
	iters: 400, epoch: 5 | loss: 0.1766627
	speed: 0.0032s/iter; left time: 5.4755s
	iters: 500, epoch: 5 | loss: 0.2437226
	speed: 0.0033s/iter; left time: 5.2633s
Updating learning rate to 1.49657377e-05
Epoch: 5 cost time: 1.6714544296264648
Epoch: 5, Steps: 523 | Train Loss: 0.3054521 Vali Loss: 0.2789405 Best vali loss: 0.2770426
	iters: 100, epoch: 6 | loss: 0.3433265
	speed: 0.0071s/iter; left time: 10.3855s
	iters: 200, epoch: 6 | loss: 0.3860910
	speed: 0.0030s/iter; left time: 4.0899s
	iters: 300, epoch: 6 | loss: 0.3199137
	speed: 0.0030s/iter; left time: 3.8426s
	iters: 400, epoch: 6 | loss: 0.6397300
	speed: 0.0030s/iter; left time: 3.4582s
	iters: 500, epoch: 6 | loss: 0.3601958
	speed: 0.0029s/iter; left time: 3.1495s
Updating learning rate to 7.48286885e-06
Epoch: 6 cost time: 1.592665433883667
Epoch: 6, Steps: 523 | Train Loss: 0.4098514 Vali Loss: 0.2822335 Best vali loss: 0.2770426
	iters: 100, epoch: 7 | loss: 0.2259955
	speed: 0.0071s/iter; left time: 6.7141s
	iters: 200, epoch: 7 | loss: 0.5118814
	speed: 0.0030s/iter; left time: 2.5431s
	iters: 300, epoch: 7 | loss: 0.3012322
	speed: 0.0033s/iter; left time: 2.4834s
	iters: 400, epoch: 7 | loss: 0.2399750
	speed: 0.0033s/iter; left time: 2.1353s
	iters: 500, epoch: 7 | loss: 0.2841221
	speed: 0.0033s/iter; left time: 1.7948s
Updating learning rate to 3.741434425e-06
Epoch: 7 cost time: 1.7207574844360352
Epoch: 7, Steps: 523 | Train Loss: 0.3126412 Vali Loss: 0.2825734 Best vali loss: 0.2770426
	iters: 100, epoch: 8 | loss: 0.5658345
	speed: 0.0074s/iter; left time: 3.1373s
	iters: 200, epoch: 8 | loss: 0.4893357
	speed: 0.0033s/iter; left time: 1.0580s
	iters: 300, epoch: 8 | loss: 0.3841427
	speed: 0.0033s/iter; left time: 0.7325s
	iters: 400, epoch: 8 | loss: 0.3429302
	speed: 0.0033s/iter; left time: 0.4033s
	iters: 500, epoch: 8 | loss: 0.4693357
	speed: 0.0033s/iter; left time: 0.0788s
Updating learning rate to 1.8707172125e-06
Epoch: 8 cost time: 1.7421822547912598
Epoch: 8, Steps: 523 | Train Loss: 0.4503158 Vali Loss: 0.2824625 Best vali loss: 0.2770426

best validation loss 0.277042557611125

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0046642077899, 'e_layers': 3, 'learning_rate': 0.0046118283421, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0046118283421
Validation loss decreased (inf --> 0.3011).  Saving model state dict ...
Epoch: 1 cost time: 0.6061091423034668
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3010864 Best vali loss: 0.3010864
Updating learning rate to 0.00230591417105
Epoch: 2 cost time: 0.3666853904724121
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3056880 Best vali loss: 0.3010864
Updating learning rate to 0.001152957085525
Validation loss decreased (0.3011 --> 0.2935).  Saving model state dict ...
Epoch: 3 cost time: 0.3748042583465576
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2935094 Best vali loss: 0.2935094

best validation loss 0.29350942601586594

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002409471614, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3574221
	speed: 0.0084s/iter; left time: 34.3722s
	iters: 200, epoch: 1 | loss: 0.4143631
	speed: 0.0033s/iter; left time: 13.1166s
	iters: 300, epoch: 1 | loss: 0.4012587
	speed: 0.0033s/iter; left time: 12.8802s
	iters: 400, epoch: 1 | loss: 0.9851721
	speed: 0.0033s/iter; left time: 12.6123s
	iters: 500, epoch: 1 | loss: 0.6061693
	speed: 0.0033s/iter; left time: 12.1546s
Updating learning rate to 0.0002409471614
Validation loss decreased (inf --> 0.2909).  Saving model state dict ...
Epoch: 1 cost time: 1.98856520652771
Epoch: 1, Steps: 523 | Train Loss: 0.7528771 Vali Loss: 0.2908791 Best vali loss: 0.2908791
	iters: 100, epoch: 2 | loss: 0.4837632
	speed: 0.0080s/iter; left time: 28.4426s
	iters: 200, epoch: 2 | loss: 0.4183211
	speed: 0.0035s/iter; left time: 11.9849s
	iters: 300, epoch: 2 | loss: 0.2572703
	speed: 0.0034s/iter; left time: 11.5038s
	iters: 400, epoch: 2 | loss: 0.3712637
	speed: 0.0034s/iter; left time: 11.1161s
	iters: 500, epoch: 2 | loss: 0.6066352
	speed: 0.0034s/iter; left time: 10.7755s
Updating learning rate to 0.0001204735807
Validation loss decreased (0.2909 --> 0.2805).  Saving model state dict ...
Epoch: 2 cost time: 1.843512773513794
Epoch: 2, Steps: 523 | Train Loss: 0.4274507 Vali Loss: 0.2804656 Best vali loss: 0.2804656
	iters: 100, epoch: 3 | loss: 0.2646525
	speed: 0.0077s/iter; left time: 23.5224s
	iters: 200, epoch: 3 | loss: 0.2186208
	speed: 0.0031s/iter; left time: 9.2094s
	iters: 300, epoch: 3 | loss: 0.2752385
	speed: 0.0031s/iter; left time: 8.8231s
	iters: 400, epoch: 3 | loss: 0.4839715
	speed: 0.0031s/iter; left time: 8.6006s
	iters: 500, epoch: 3 | loss: 0.7382085
	speed: 0.0032s/iter; left time: 8.3349s
Updating learning rate to 6.023679035e-05
Validation loss decreased (0.2805 --> 0.2720).  Saving model state dict ...
Epoch: 3 cost time: 1.6800446510314941
Epoch: 3, Steps: 523 | Train Loss: 0.3961384 Vali Loss: 0.2720181 Best vali loss: 0.2720181

best validation loss 0.2720181326433468

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010256420565, 'e_layers': 2, 'learning_rate': 0.0002420468319, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7652034
	speed: 0.0087s/iter; left time: 35.5948s
	iters: 200, epoch: 1 | loss: 0.4925600
	speed: 0.0035s/iter; left time: 13.9006s
	iters: 300, epoch: 1 | loss: 0.6976975
	speed: 0.0035s/iter; left time: 13.4898s
	iters: 400, epoch: 1 | loss: 0.6759052
	speed: 0.0035s/iter; left time: 13.1199s
	iters: 500, epoch: 1 | loss: 0.4218264
	speed: 0.0035s/iter; left time: 12.8217s
Updating learning rate to 0.0002420468319
Validation loss decreased (inf --> 0.2956).  Saving model state dict ...
Epoch: 1 cost time: 2.080066680908203
Epoch: 1, Steps: 523 | Train Loss: 0.6106385 Vali Loss: 0.2955740 Best vali loss: 0.2955740
	iters: 100, epoch: 2 | loss: 0.3372157
	speed: 0.0077s/iter; left time: 27.3060s
	iters: 200, epoch: 2 | loss: 0.5943205
	speed: 0.0032s/iter; left time: 10.9211s
	iters: 300, epoch: 2 | loss: 0.2547403
	speed: 0.0032s/iter; left time: 10.7443s
	iters: 400, epoch: 2 | loss: 0.3084281
	speed: 0.0031s/iter; left time: 9.9772s
	iters: 500, epoch: 2 | loss: 0.4573122
	speed: 0.0029s/iter; left time: 9.2528s
Updating learning rate to 0.00012102341595
Validation loss decreased (0.2956 --> 0.2849).  Saving model state dict ...
Epoch: 2 cost time: 1.6772596836090088
Epoch: 2, Steps: 523 | Train Loss: 0.3904034 Vali Loss: 0.2848501 Best vali loss: 0.2848501
	iters: 100, epoch: 3 | loss: 0.4530087
	speed: 0.0078s/iter; left time: 23.7557s
	iters: 200, epoch: 3 | loss: 0.3434313
	speed: 0.0033s/iter; left time: 9.6083s
	iters: 300, epoch: 3 | loss: 0.2114542
	speed: 0.0033s/iter; left time: 9.2931s
	iters: 400, epoch: 3 | loss: 0.6822883
	speed: 0.0035s/iter; left time: 9.4918s
	iters: 500, epoch: 3 | loss: 0.3891668
	speed: 0.0033s/iter; left time: 8.6123s
Updating learning rate to 6.0511707975e-05
Validation loss decreased (0.2849 --> 0.2792).  Saving model state dict ...
Epoch: 3 cost time: 1.7908143997192383
Epoch: 3, Steps: 523 | Train Loss: 0.4158699 Vali Loss: 0.2792276 Best vali loss: 0.2792276

best validation loss 0.2792275918598466

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002409471614, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6547220
	speed: 0.0089s/iter; left time: 22.4836s
	iters: 200, epoch: 4 | loss: 0.3746420
	speed: 0.0035s/iter; left time: 8.4191s
	iters: 300, epoch: 4 | loss: 0.3167012
	speed: 0.0035s/iter; left time: 8.1305s
	iters: 400, epoch: 4 | loss: 0.4560791
	speed: 0.0036s/iter; left time: 7.9572s
	iters: 500, epoch: 4 | loss: 0.3156458
	speed: 0.0035s/iter; left time: 7.4049s
Updating learning rate to 3.0118395175e-05
Epoch: 4 cost time: 2.099795341491699
Epoch: 4, Steps: 523 | Train Loss: 0.4235580 Vali Loss: 0.2771923 Best vali loss: 0.2720181
	iters: 100, epoch: 5 | loss: 0.4402306
	speed: 0.0077s/iter; left time: 15.4057s
	iters: 200, epoch: 5 | loss: 0.3139581
	speed: 0.0032s/iter; left time: 6.1354s
	iters: 300, epoch: 5 | loss: 0.2207213
	speed: 0.0032s/iter; left time: 5.7296s
	iters: 400, epoch: 5 | loss: 0.3260656
	speed: 0.0033s/iter; left time: 5.6183s
	iters: 500, epoch: 5 | loss: 0.4224119
	speed: 0.0033s/iter; left time: 5.2179s
Updating learning rate to 1.50591975875e-05
Epoch: 5 cost time: 1.7628142833709717
Epoch: 5, Steps: 523 | Train Loss: 0.3446775 Vali Loss: 0.2787017 Best vali loss: 0.2720181
	iters: 100, epoch: 6 | loss: 0.2508566
	speed: 0.0073s/iter; left time: 10.7866s
	iters: 200, epoch: 6 | loss: 0.1899223
	speed: 0.0032s/iter; left time: 4.3335s
	iters: 300, epoch: 6 | loss: 0.2429000
	speed: 0.0031s/iter; left time: 3.9892s
	iters: 400, epoch: 6 | loss: 0.4004328
	speed: 0.0031s/iter; left time: 3.6760s
	iters: 500, epoch: 6 | loss: 0.5278507
	speed: 0.0031s/iter; left time: 3.3358s
Updating learning rate to 7.52959879375e-06
Epoch: 6 cost time: 1.682915449142456
Epoch: 6, Steps: 523 | Train Loss: 0.3223925 Vali Loss: 0.2798552 Best vali loss: 0.2720181
	iters: 100, epoch: 7 | loss: 0.3347177
	speed: 0.0077s/iter; left time: 7.2621s
	iters: 200, epoch: 7 | loss: 0.3734967
	speed: 0.0036s/iter; left time: 3.0534s
	iters: 300, epoch: 7 | loss: 0.3586963
	speed: 0.0036s/iter; left time: 2.7095s
	iters: 400, epoch: 7 | loss: 0.3809854
	speed: 0.0036s/iter; left time: 2.3230s
	iters: 500, epoch: 7 | loss: 0.2556462
	speed: 0.0036s/iter; left time: 1.9485s
Updating learning rate to 3.764799396875e-06
Epoch: 7 cost time: 1.9101052284240723
Epoch: 7, Steps: 523 | Train Loss: 0.3407085 Vali Loss: 0.2804806 Best vali loss: 0.2720181
	iters: 100, epoch: 8 | loss: 0.3842955
	speed: 0.0077s/iter; left time: 3.2549s
	iters: 200, epoch: 8 | loss: 0.4233410
	speed: 0.0035s/iter; left time: 1.1481s
	iters: 300, epoch: 8 | loss: 0.4799624
	speed: 0.0035s/iter; left time: 0.7909s
	iters: 400, epoch: 8 | loss: 0.3631922
	speed: 0.0035s/iter; left time: 0.4367s
	iters: 500, epoch: 8 | loss: 0.4007653
	speed: 0.0035s/iter; left time: 0.0844s
Updating learning rate to 1.8823996984375e-06
Epoch: 8 cost time: 1.8790733814239502
Epoch: 8, Steps: 523 | Train Loss: 0.4103113 Vali Loss: 0.2820819 Best vali loss: 0.2720181

best validation loss 0.2720181326433468

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00022556132703489248
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 0.705481767654419
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2825157 Best vali loss: 0.2825157
Updating learning rate to 0.0002001462484774589
Epoch: 2 cost time: 0.4763364791870117
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2836084 Best vali loss: 0.2825157
Updating learning rate to 0.00016210989544980772
Epoch: 3 cost time: 0.47794461250305176
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2937221 Best vali loss: 0.2825157
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2825 --> 0.2791).  Saving model state dict ...
Epoch: 4 cost time: 0.4741334915161133
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2790873 Best vali loss: 0.2790873
Updating learning rate to 7.237602035019229e-05
Epoch: 5 cost time: 0.4829287528991699
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2794070 Best vali loss: 0.2790873
Updating learning rate to 3.43396673225411e-05
Validation loss decreased (0.2791 --> 0.2771).  Saving model state dict ...
Epoch: 6 cost time: 0.4765133857727051
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2770578 Best vali loss: 0.2770578
Updating learning rate to 8.924588765107527e-06
Epoch: 7 cost time: 0.4752819538116455
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2801777 Best vali loss: 0.2770578
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4735395908355713
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2807075 Best vali loss: 0.2770578

best validation loss 0.277057752683731

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010273769365, 'e_layers': 2, 'learning_rate': 0.0002418914823, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002418914823
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 0.7972378730773926
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2852542 Best vali loss: 0.2852542
Updating learning rate to 0.00012094574115
Validation loss decreased (0.2853 --> 0.2740).  Saving model state dict ...
Epoch: 2 cost time: 0.5780293941497803
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2739801 Best vali loss: 0.2739801
Updating learning rate to 6.0472870575e-05
Epoch: 3 cost time: 0.5732388496398926
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2809642 Best vali loss: 0.2739801
Updating learning rate to 3.02364352875e-05
Epoch: 4 cost time: 0.5696985721588135
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2769715 Best vali loss: 0.2739801
Updating learning rate to 1.511821764375e-05
Epoch: 5 cost time: 0.5707077980041504
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2799162 Best vali loss: 0.2739801
Updating learning rate to 7.559108821875e-06
Epoch: 6 cost time: 0.5740690231323242
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2796314 Best vali loss: 0.2739801
Updating learning rate to 3.7795544109375e-06
Epoch: 7 cost time: 0.5663704872131348
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2810866 Best vali loss: 0.2739801
Updating learning rate to 1.88977720546875e-06
Epoch: 8 cost time: 0.5758826732635498
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2816170 Best vali loss: 0.2739801

best validation loss 0.273980070208918

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 4, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4539837
	speed: 0.0149s/iter; left time: 14.1489s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.5169546604156494
Epoch: 1, Steps: 131 | Train Loss: 0.4539837 Vali Loss: 0.2814122 Best vali loss: 0.2814122
	iters: 100, epoch: 2 | loss: 0.4830553
	speed: 0.0156s/iter; left time: 12.7883s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 1.3030831813812256
Epoch: 2, Steps: 131 | Train Loss: 0.4830553 Vali Loss: 0.2980602 Best vali loss: 0.2814122
	iters: 100, epoch: 3 | loss: 0.3897132
	speed: 0.0152s/iter; left time: 10.4296s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.2871606349945068
Epoch: 3, Steps: 131 | Train Loss: 0.3897132 Vali Loss: 0.2849334 Best vali loss: 0.2814122

best validation loss 0.28141222908876784

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010537967048, 'e_layers': 2, 'learning_rate': 0.0002346617798, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597602
	speed: 0.0106s/iter; left time: 10.0247s
Updating learning rate to 0.0002346617798
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9317626953125
Epoch: 1, Steps: 131 | Train Loss: 0.5597602 Vali Loss: 0.2756468 Best vali loss: 0.2756468
	iters: 100, epoch: 2 | loss: 0.3258570
	speed: 0.0090s/iter; left time: 7.3412s
Updating learning rate to 0.0001173308899
Validation loss decreased (0.2756 --> 0.2720).  Saving model state dict ...
Epoch: 2 cost time: 0.7064321041107178
Epoch: 2, Steps: 131 | Train Loss: 0.3258570 Vali Loss: 0.2719767 Best vali loss: 0.2719767
	iters: 100, epoch: 3 | loss: 0.4639657
	speed: 0.0092s/iter; left time: 6.3097s
Updating learning rate to 5.866544495e-05
Epoch: 3 cost time: 0.706141471862793
Epoch: 3, Steps: 131 | Train Loss: 0.4639657 Vali Loss: 0.2749538 Best vali loss: 0.2719767

best validation loss 0.2719766953568691

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.002837852389, 'e_layers': 4, 'learning_rate': 0.000309609584, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7877322
	speed: 0.0102s/iter; left time: 41.7995s
	iters: 200, epoch: 1 | loss: 0.2964433
	speed: 0.0049s/iter; left time: 19.5667s
	iters: 300, epoch: 1 | loss: 0.3928342
	speed: 0.0049s/iter; left time: 19.0669s
	iters: 400, epoch: 1 | loss: 0.4311615
	speed: 0.0049s/iter; left time: 18.6718s
	iters: 500, epoch: 1 | loss: 0.1839791
	speed: 0.0049s/iter; left time: 17.9438s
Updating learning rate to 0.000309609584
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 2.8219945430755615
Epoch: 1, Steps: 523 | Train Loss: 0.4184301 Vali Loss: 0.2828024 Best vali loss: 0.2828024
	iters: 100, epoch: 2 | loss: 0.7636011
	speed: 0.0095s/iter; left time: 33.8915s
	iters: 200, epoch: 2 | loss: 0.2543782
	speed: 0.0045s/iter; left time: 15.6634s
	iters: 300, epoch: 2 | loss: 0.8337907
	speed: 0.0045s/iter; left time: 15.1857s
	iters: 400, epoch: 2 | loss: 0.6477751
	speed: 0.0047s/iter; left time: 15.3064s
	iters: 500, epoch: 2 | loss: 1.2364230
	speed: 0.0047s/iter; left time: 14.9469s
Updating learning rate to 0.000154804792
Epoch: 2 cost time: 2.4440114498138428
Epoch: 2, Steps: 523 | Train Loss: 0.7471936 Vali Loss: 0.2857280 Best vali loss: 0.2828024
	iters: 100, epoch: 3 | loss: 0.4649863
	speed: 0.0096s/iter; left time: 29.0431s
	iters: 200, epoch: 3 | loss: 0.2905118
	speed: 0.0047s/iter; left time: 13.7721s
	iters: 300, epoch: 3 | loss: 0.2553993
	speed: 0.0046s/iter; left time: 13.1035s
	iters: 400, epoch: 3 | loss: 0.2351675
	speed: 0.0047s/iter; left time: 12.8112s
	iters: 500, epoch: 3 | loss: 0.4318078
	speed: 0.0047s/iter; left time: 12.3395s
Updating learning rate to 7.7402396e-05
Epoch: 3 cost time: 2.480727434158325
Epoch: 3, Steps: 523 | Train Loss: 0.3355745 Vali Loss: 0.2848681 Best vali loss: 0.2828024

best validation loss 0.28280238312343187

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010537967048, 'e_layers': 2, 'learning_rate': 0.0002346617798, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4243114
	speed: 0.0110s/iter; left time: 6.1352s
Updating learning rate to 2.9332722475e-05
Epoch: 4 cost time: 0.951373815536499
Epoch: 4, Steps: 131 | Train Loss: 0.4243114 Vali Loss: 0.3018360 Best vali loss: 0.2719767
	iters: 100, epoch: 5 | loss: 0.2814454
	speed: 0.0087s/iter; left time: 3.6777s
Updating learning rate to 1.46663612375e-05
Epoch: 5 cost time: 0.6985800266265869
Epoch: 5, Steps: 131 | Train Loss: 0.2814454 Vali Loss: 0.2984058 Best vali loss: 0.2719767
	iters: 100, epoch: 6 | loss: 0.4349005
	speed: 0.0086s/iter; left time: 2.5265s
Updating learning rate to 7.33318061875e-06
Epoch: 6 cost time: 0.7002561092376709
Epoch: 6, Steps: 131 | Train Loss: 0.4349005 Vali Loss: 0.3004023 Best vali loss: 0.2719767
	iters: 100, epoch: 7 | loss: 0.4640754
	speed: 0.0087s/iter; left time: 1.4128s
Updating learning rate to 3.666590309375e-06
Epoch: 7 cost time: 0.7019906044006348
Epoch: 7, Steps: 131 | Train Loss: 0.4640754 Vali Loss: 0.3005452 Best vali loss: 0.2719767
	iters: 100, epoch: 8 | loss: 0.3254964
	speed: 0.0086s/iter; left time: 0.2758s
Updating learning rate to 1.8332951546875e-06
Epoch: 8 cost time: 0.7020318508148193
Epoch: 8, Steps: 131 | Train Loss: 0.3254964 Vali Loss: 0.2979671 Best vali loss: 0.2719767

best validation loss 0.2719766953568691

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010562812053, 'e_layers': 4, 'learning_rate': 0.0002344652356, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4539543
	speed: 0.0148s/iter; left time: 14.0744s
Updating learning rate to 0.0002344652356
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.5197041034698486
Epoch: 1, Steps: 131 | Train Loss: 0.4539543 Vali Loss: 0.2813964 Best vali loss: 0.2813964
	iters: 100, epoch: 2 | loss: 0.4803299
	speed: 0.0156s/iter; left time: 12.7415s
Updating learning rate to 0.0001172326178
Epoch: 2 cost time: 1.2934048175811768
Epoch: 2, Steps: 131 | Train Loss: 0.4803299 Vali Loss: 0.3017100 Best vali loss: 0.2813964
	iters: 100, epoch: 3 | loss: 0.4079166
	speed: 0.0152s/iter; left time: 10.4134s
Updating learning rate to 5.86163089e-05
Epoch: 3 cost time: 1.2880830764770508
Epoch: 3, Steps: 131 | Train Loss: 0.4079166 Vali Loss: 0.2914727 Best vali loss: 0.2813964
	iters: 100, epoch: 4 | loss: 0.3869667
	speed: 0.0152s/iter; left time: 8.4635s
Updating learning rate to 2.930815445e-05
Validation loss decreased (0.2814 --> 0.2796).  Saving model state dict ...
Epoch: 4 cost time: 1.2972476482391357
Epoch: 4, Steps: 131 | Train Loss: 0.3869667 Vali Loss: 0.2796152 Best vali loss: 0.2796152
	iters: 100, epoch: 5 | loss: 0.4565820
	speed: 0.0159s/iter; left time: 6.7396s
Updating learning rate to 1.4654077225e-05
Epoch: 5 cost time: 1.2990105152130127
Epoch: 5, Steps: 131 | Train Loss: 0.4565820 Vali Loss: 0.3015687 Best vali loss: 0.2796152
	iters: 100, epoch: 6 | loss: 0.4825569
	speed: 0.0152s/iter; left time: 4.4797s
Updating learning rate to 7.3270386125e-06
Epoch: 6 cost time: 1.2975561618804932
Epoch: 6, Steps: 131 | Train Loss: 0.4825569 Vali Loss: 0.2915518 Best vali loss: 0.2796152
	iters: 100, epoch: 7 | loss: 0.3798826
	speed: 0.0152s/iter; left time: 2.4825s
Updating learning rate to 3.66351930625e-06
Epoch: 7 cost time: 1.2981815338134766
Epoch: 7, Steps: 131 | Train Loss: 0.3798826 Vali Loss: 0.2941543 Best vali loss: 0.2796152
	iters: 100, epoch: 8 | loss: 0.3673100
	speed: 0.0152s/iter; left time: 0.4871s
Updating learning rate to 1.831759653125e-06
Epoch: 8 cost time: 1.2930173873901367
Epoch: 8, Steps: 131 | Train Loss: 0.3673100 Vali Loss: 0.2981445 Best vali loss: 0.2796152

best validation loss 0.2796151846503183

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5434505
	speed: 0.0099s/iter; left time: 9.3949s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2873).  Saving model state dict ...
Epoch: 1 cost time: 0.871708869934082
Epoch: 1, Steps: 131 | Train Loss: 0.5434505 Vali Loss: 0.2873320 Best vali loss: 0.2873320
	iters: 100, epoch: 2 | loss: 0.6785781
	speed: 0.0083s/iter; left time: 6.7655s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2873 --> 0.2744).  Saving model state dict ...
Epoch: 2 cost time: 0.6412012577056885
Epoch: 2, Steps: 131 | Train Loss: 0.6785781 Vali Loss: 0.2744089 Best vali loss: 0.2744089
	iters: 100, epoch: 3 | loss: 0.3486912
	speed: 0.0083s/iter; left time: 5.6687s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.6411607265472412
Epoch: 3, Steps: 131 | Train Loss: 0.3486912 Vali Loss: 0.2793104 Best vali loss: 0.2744089
	iters: 100, epoch: 4 | loss: 0.5342495
	speed: 0.0080s/iter; left time: 4.4415s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.6437351703643799
Epoch: 4, Steps: 131 | Train Loss: 0.5342495 Vali Loss: 0.2848942 Best vali loss: 0.2744089
	iters: 100, epoch: 5 | loss: 0.6382937
	speed: 0.0081s/iter; left time: 3.4530s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.6467933654785156
Epoch: 5, Steps: 131 | Train Loss: 0.6382937 Vali Loss: 0.2964433 Best vali loss: 0.2744089
	iters: 100, epoch: 6 | loss: 0.4884106
	speed: 0.0081s/iter; left time: 2.3776s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.6440424919128418
Epoch: 6, Steps: 131 | Train Loss: 0.4884106 Vali Loss: 0.2902387 Best vali loss: 0.2744089
	iters: 100, epoch: 7 | loss: 0.4281207
	speed: 0.0081s/iter; left time: 1.3155s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.6444439888000488
Epoch: 7, Steps: 131 | Train Loss: 0.4281207 Vali Loss: 0.2969177 Best vali loss: 0.2744089
	iters: 100, epoch: 8 | loss: 0.2819295
	speed: 0.0080s/iter; left time: 0.2572s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.6407146453857422
Epoch: 8, Steps: 131 | Train Loss: 0.2819295 Vali Loss: 0.2916571 Best vali loss: 0.2744089

best validation loss 0.27440885881944943

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0246521
	speed: 0.0087s/iter; left time: 35.4007s
	iters: 200, epoch: 1 | loss: 0.2399259
	speed: 0.0032s/iter; left time: 12.6026s
	iters: 300, epoch: 1 | loss: 0.3208180
	speed: 0.0031s/iter; left time: 12.0074s
	iters: 400, epoch: 1 | loss: 0.8198326
	speed: 0.0031s/iter; left time: 11.7483s
	iters: 500, epoch: 1 | loss: 0.6980167
	speed: 0.0031s/iter; left time: 11.5963s
Updating learning rate to 0.0008497821375614502
Validation loss decreased (inf --> 0.2928).  Saving model state dict ...
Epoch: 1 cost time: 1.910900592803955
Epoch: 1, Steps: 523 | Train Loss: 0.6206491 Vali Loss: 0.2928238 Best vali loss: 0.2928238
	iters: 100, epoch: 2 | loss: 0.7262076
	speed: 0.0072s/iter; left time: 25.5261s
	iters: 200, epoch: 2 | loss: 0.5265979
	speed: 0.0033s/iter; left time: 11.5525s
	iters: 300, epoch: 2 | loss: 0.2893936
	speed: 0.0032s/iter; left time: 10.6680s
	iters: 400, epoch: 2 | loss: 0.3146605
	speed: 0.0032s/iter; left time: 10.2862s
	iters: 500, epoch: 2 | loss: 0.7289470
	speed: 0.0031s/iter; left time: 9.9260s
Updating learning rate to 0.0007540331008505288
Validation loss decreased (0.2928 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 1.7243993282318115
Epoch: 2, Steps: 523 | Train Loss: 0.5171613 Vali Loss: 0.2838123 Best vali loss: 0.2838123
	iters: 100, epoch: 3 | loss: 0.3225764
	speed: 0.0071s/iter; left time: 21.7075s
	iters: 200, epoch: 3 | loss: 0.3469073
	speed: 0.0035s/iter; left time: 10.2190s
	iters: 300, epoch: 3 | loss: 0.9845026
	speed: 0.0035s/iter; left time: 10.0076s
	iters: 400, epoch: 3 | loss: 0.5150281
	speed: 0.0035s/iter; left time: 9.6399s
	iters: 500, epoch: 3 | loss: 0.5677084
	speed: 0.0035s/iter; left time: 9.3095s
Updating learning rate to 0.0006107345407392943
Epoch: 3 cost time: 1.8505945205688477
Epoch: 3, Steps: 523 | Train Loss: 0.5473445 Vali Loss: 0.2935537 Best vali loss: 0.2838123

best validation loss 0.28381234135890193

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010917796576, 'e_layers': 4, 'learning_rate': 0.0002334497737, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4539967
	speed: 0.0153s/iter; left time: 14.5028s
Updating learning rate to 0.00022456462074541084
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.5384142398834229
Epoch: 1, Steps: 131 | Train Loss: 0.4539967 Vali Loss: 0.2814041 Best vali loss: 0.2814041
	iters: 100, epoch: 2 | loss: 0.4768852
	speed: 0.0156s/iter; left time: 12.7906s
Updating learning rate to 0.00019926184587486747
Epoch: 2 cost time: 1.2953360080718994
Epoch: 2, Steps: 131 | Train Loss: 0.4768852 Vali Loss: 0.3038959 Best vali loss: 0.2814041
	iters: 100, epoch: 3 | loss: 0.4004628
	speed: 0.0151s/iter; left time: 10.3691s
Updating learning rate to 0.00016139356719218473
Epoch: 3 cost time: 1.2865791320800781
Epoch: 3, Steps: 131 | Train Loss: 0.4004628 Vali Loss: 0.3005924 Best vali loss: 0.2814041

best validation loss 0.28140409498320673

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010297286223, 'e_layers': 2, 'learning_rate': 0.0002428533038, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5605968
	speed: 0.0105s/iter; left time: 9.9714s
Updating learning rate to 0.0002428533038
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9296779632568359
Epoch: 1, Steps: 131 | Train Loss: 0.5605968 Vali Loss: 0.2757932 Best vali loss: 0.2757932
	iters: 100, epoch: 2 | loss: 0.3250895
	speed: 0.0089s/iter; left time: 7.2482s
Updating learning rate to 0.0001214266519
Validation loss decreased (0.2758 --> 0.2726).  Saving model state dict ...
Epoch: 2 cost time: 0.6986753940582275
Epoch: 2, Steps: 131 | Train Loss: 0.3250895 Vali Loss: 0.2726040 Best vali loss: 0.2726040
	iters: 100, epoch: 3 | loss: 0.4682446
	speed: 0.0089s/iter; left time: 6.1218s
Updating learning rate to 6.071332595e-05
Epoch: 3 cost time: 0.6977224349975586
Epoch: 3, Steps: 131 | Train Loss: 0.4682446 Vali Loss: 0.2792287 Best vali loss: 0.2726040

best validation loss 0.2726039722223803

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010297286223, 'e_layers': 2, 'learning_rate': 0.0002428533038, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4130588
	speed: 0.0110s/iter; left time: 6.0942s
Updating learning rate to 3.0356662975e-05
Epoch: 4 cost time: 0.9381558895111084
Epoch: 4, Steps: 131 | Train Loss: 0.4130588 Vali Loss: 0.3046987 Best vali loss: 0.2726040
	iters: 100, epoch: 5 | loss: 0.2805967
	speed: 0.0087s/iter; left time: 3.7076s
Updating learning rate to 1.51783314875e-05
Epoch: 5 cost time: 0.7034618854522705
Epoch: 5, Steps: 131 | Train Loss: 0.2805967 Vali Loss: 0.2985100 Best vali loss: 0.2726040
	iters: 100, epoch: 6 | loss: 0.4381394
	speed: 0.0087s/iter; left time: 2.5467s
Updating learning rate to 7.58916574375e-06
Epoch: 6 cost time: 0.6963965892791748
Epoch: 6, Steps: 131 | Train Loss: 0.4381394 Vali Loss: 0.2984275 Best vali loss: 0.2726040
	iters: 100, epoch: 7 | loss: 0.4614787
	speed: 0.0087s/iter; left time: 1.4133s
Updating learning rate to 3.794582871875e-06
Epoch: 7 cost time: 0.7028148174285889
Epoch: 7, Steps: 131 | Train Loss: 0.4614787 Vali Loss: 0.2972554 Best vali loss: 0.2726040
	iters: 100, epoch: 8 | loss: 0.3269829
	speed: 0.0086s/iter; left time: 0.2746s
Updating learning rate to 1.8972914359375e-06
Epoch: 8 cost time: 0.6937296390533447
Epoch: 8, Steps: 131 | Train Loss: 0.3269829 Vali Loss: 0.2981364 Best vali loss: 0.2726040

best validation loss 0.2726039722223803

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269902909, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4577012
	speed: 0.0093s/iter; left time: 8.7824s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.7670581340789795
Epoch: 1, Steps: 131 | Train Loss: 0.4577012 Vali Loss: 0.2816918 Best vali loss: 0.2816918
	iters: 100, epoch: 2 | loss: 0.5947496
	speed: 0.0072s/iter; left time: 5.8627s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2817 --> 0.2769).  Saving model state dict ...
Epoch: 2 cost time: 0.5609776973724365
Epoch: 2, Steps: 131 | Train Loss: 0.5947496 Vali Loss: 0.2768695 Best vali loss: 0.2768695
	iters: 100, epoch: 3 | loss: 0.5738496
	speed: 0.0071s/iter; left time: 4.8658s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.5503389835357666
Epoch: 3, Steps: 131 | Train Loss: 0.5738496 Vali Loss: 0.2802243 Best vali loss: 0.2768695
	iters: 100, epoch: 4 | loss: 0.5424479
	speed: 0.0067s/iter; left time: 3.7474s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.5384066104888916
Epoch: 4, Steps: 131 | Train Loss: 0.5424479 Vali Loss: 0.2991565 Best vali loss: 0.2768695
	iters: 100, epoch: 5 | loss: 0.3691024
	speed: 0.0068s/iter; left time: 2.9041s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.5424606800079346
Epoch: 5, Steps: 131 | Train Loss: 0.3691024 Vali Loss: 0.2940962 Best vali loss: 0.2768695
	iters: 100, epoch: 6 | loss: 0.3131456
	speed: 0.0068s/iter; left time: 1.9867s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.5304286479949951
Epoch: 6, Steps: 131 | Train Loss: 0.3131456 Vali Loss: 0.2904209 Best vali loss: 0.2768695
	iters: 100, epoch: 7 | loss: 0.2777220
	speed: 0.0068s/iter; left time: 1.1003s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.5525898933410645
Epoch: 7, Steps: 131 | Train Loss: 0.2777220 Vali Loss: 0.3026762 Best vali loss: 0.2768695
	iters: 100, epoch: 8 | loss: 0.3581558
	speed: 0.0069s/iter; left time: 0.2204s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5411338806152344
Epoch: 8, Steps: 131 | Train Loss: 0.3581558 Vali Loss: 0.2982420 Best vali loss: 0.2768695

best validation loss 0.27686946857104117

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4577012
	speed: 0.0093s/iter; left time: 8.8088s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.7906265258789062
Epoch: 1, Steps: 131 | Train Loss: 0.4577012 Vali Loss: 0.2816918 Best vali loss: 0.2816918
	iters: 100, epoch: 2 | loss: 0.5947496
	speed: 0.0068s/iter; left time: 5.5847s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2817 --> 0.2769).  Saving model state dict ...
Epoch: 2 cost time: 0.5241453647613525
Epoch: 2, Steps: 131 | Train Loss: 0.5947496 Vali Loss: 0.2768695 Best vali loss: 0.2768695
	iters: 100, epoch: 3 | loss: 0.5738496
	speed: 0.0067s/iter; left time: 4.5721s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.5253298282623291
Epoch: 3, Steps: 131 | Train Loss: 0.5738496 Vali Loss: 0.2802243 Best vali loss: 0.2768695
	iters: 100, epoch: 4 | loss: 0.5424479
	speed: 0.0066s/iter; left time: 3.6792s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.5229969024658203
Epoch: 4, Steps: 131 | Train Loss: 0.5424479 Vali Loss: 0.2991565 Best vali loss: 0.2768695
	iters: 100, epoch: 5 | loss: 0.3691024
	speed: 0.0066s/iter; left time: 2.8053s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.5280663967132568
Epoch: 5, Steps: 131 | Train Loss: 0.3691024 Vali Loss: 0.2940962 Best vali loss: 0.2768695
	iters: 100, epoch: 6 | loss: 0.3131456
	speed: 0.0068s/iter; left time: 1.9867s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.5421078205108643
Epoch: 6, Steps: 131 | Train Loss: 0.3131456 Vali Loss: 0.2904209 Best vali loss: 0.2768695
	iters: 100, epoch: 7 | loss: 0.2777220
	speed: 0.0069s/iter; left time: 1.1185s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.5589582920074463
Epoch: 7, Steps: 131 | Train Loss: 0.2777220 Vali Loss: 0.3026762 Best vali loss: 0.2768695
	iters: 100, epoch: 8 | loss: 0.3581558
	speed: 0.0070s/iter; left time: 0.2232s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5629723072052002
Epoch: 8, Steps: 131 | Train Loss: 0.3581558 Vali Loss: 0.2982420 Best vali loss: 0.2768695

best validation loss 0.27686946857104117

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0041376749186, 'e_layers': 2, 'learning_rate': 0.0013179784539, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2099098
	speed: 0.0086s/iter; left time: 35.0783s
	iters: 200, epoch: 1 | loss: 0.3767673
	speed: 0.0032s/iter; left time: 12.7865s
	iters: 300, epoch: 1 | loss: 0.1723654
	speed: 0.0031s/iter; left time: 12.0207s
	iters: 400, epoch: 1 | loss: 0.1904557
	speed: 0.0031s/iter; left time: 11.9081s
	iters: 500, epoch: 1 | loss: 0.2541685
	speed: 0.0032s/iter; left time: 11.6223s
Updating learning rate to 0.0012678158858745402
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 1.9181091785430908
Epoch: 1, Steps: 523 | Train Loss: 0.2407333 Vali Loss: 0.2859212 Best vali loss: 0.2859212
	iters: 100, epoch: 2 | loss: 0.7432281
	speed: 0.0069s/iter; left time: 24.4117s
	iters: 200, epoch: 2 | loss: 0.4592428
	speed: 0.0030s/iter; left time: 10.3659s
	iters: 300, epoch: 2 | loss: 0.3486603
	speed: 0.0030s/iter; left time: 9.9584s
	iters: 400, epoch: 2 | loss: 0.3520043
	speed: 0.0030s/iter; left time: 9.6646s
	iters: 500, epoch: 2 | loss: 0.3286784
	speed: 0.0030s/iter; left time: 9.3587s
Updating learning rate to 0.0011249649780552258
Validation loss decreased (0.2859 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 1.5925054550170898
Epoch: 2, Steps: 523 | Train Loss: 0.4463628 Vali Loss: 0.2842858 Best vali loss: 0.2842858
	iters: 100, epoch: 3 | loss: 0.3815728
	speed: 0.0071s/iter; left time: 21.5917s
	iters: 200, epoch: 3 | loss: 0.7129388
	speed: 0.0033s/iter; left time: 9.6184s
	iters: 300, epoch: 3 | loss: 0.4407510
	speed: 0.0032s/iter; left time: 9.0180s
	iters: 400, epoch: 3 | loss: 0.3105524
	speed: 0.0032s/iter; left time: 8.8469s
	iters: 500, epoch: 3 | loss: 0.6383157
	speed: 0.0032s/iter; left time: 8.4533s
Updating learning rate to 0.0009111734862108432
Epoch: 3 cost time: 1.7161026000976562
Epoch: 3, Steps: 523 | Train Loss: 0.4968261 Vali Loss: 0.3034029 Best vali loss: 0.2842858

best validation loss 0.2842857687834161

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010266352116, 'e_layers': 2, 'learning_rate': 5.38671387e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6515411
	speed: 0.0095s/iter; left time: 9.0085s
Updating learning rate to 5.38671387e-05
Validation loss decreased (inf --> 0.2885).  Saving model state dict ...
Epoch: 1 cost time: 0.8130238056182861
Epoch: 1, Steps: 131 | Train Loss: 0.6515411 Vali Loss: 0.2885326 Best vali loss: 0.2885326
	iters: 100, epoch: 2 | loss: 0.6563457
	speed: 0.0072s/iter; left time: 5.9067s
Updating learning rate to 2.693356935e-05
Validation loss decreased (0.2885 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 0.5754406452178955
Epoch: 2, Steps: 131 | Train Loss: 0.6563457 Vali Loss: 0.2810364 Best vali loss: 0.2810364
	iters: 100, epoch: 3 | loss: 0.6170737
	speed: 0.0070s/iter; left time: 4.7843s
Updating learning rate to 1.3466784675e-05
Validation loss decreased (0.2810 --> 0.2793).  Saving model state dict ...
Epoch: 3 cost time: 0.5542848110198975
Epoch: 3, Steps: 131 | Train Loss: 0.6170737 Vali Loss: 0.2792664 Best vali loss: 0.2792664

best validation loss 0.27926643441028426

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5896312
	speed: 0.0095s/iter; left time: 9.0252s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.8161418437957764
Epoch: 1, Steps: 131 | Train Loss: 0.5896312 Vali Loss: 0.2829004 Best vali loss: 0.2829004
	iters: 100, epoch: 2 | loss: 0.6393902
	speed: 0.0072s/iter; left time: 5.9188s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2829 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.577080249786377
Epoch: 2, Steps: 131 | Train Loss: 0.6393902 Vali Loss: 0.2826343 Best vali loss: 0.2826343
	iters: 100, epoch: 3 | loss: 0.5793696
	speed: 0.0068s/iter; left time: 4.7013s
Updating learning rate to 5.862147895e-05
Validation loss decreased (0.2826 --> 0.2798).  Saving model state dict ...
Epoch: 3 cost time: 0.5206656455993652
Epoch: 3, Steps: 131 | Train Loss: 0.5793696 Vali Loss: 0.2798111 Best vali loss: 0.2798111

best validation loss 0.2798111036602739

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010266352116, 'e_layers': 2, 'learning_rate': 5.38671387e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5782009
	speed: 0.0094s/iter; left time: 5.2299s
Updating learning rate to 6.7333923375e-06
Validation loss decreased (0.2793 --> 0.2789).  Saving model state dict ...
Epoch: 4 cost time: 0.7783629894256592
Epoch: 4, Steps: 131 | Train Loss: 0.5782009 Vali Loss: 0.2789417 Best vali loss: 0.2789417
	iters: 100, epoch: 5 | loss: 0.6364428
	speed: 0.0065s/iter; left time: 2.7623s
Updating learning rate to 3.36669616875e-06
Validation loss decreased (0.2789 --> 0.2788).  Saving model state dict ...
Epoch: 5 cost time: 0.5101039409637451
Epoch: 5, Steps: 131 | Train Loss: 0.6364428 Vali Loss: 0.2787681 Best vali loss: 0.2787681
	iters: 100, epoch: 6 | loss: 0.6028451
	speed: 0.0067s/iter; left time: 1.9746s
Updating learning rate to 1.683348084375e-06
Validation loss decreased (0.2788 --> 0.2786).  Saving model state dict ...
Epoch: 6 cost time: 0.5297274589538574
Epoch: 6, Steps: 131 | Train Loss: 0.6028451 Vali Loss: 0.2786325 Best vali loss: 0.2786325
	iters: 100, epoch: 7 | loss: 0.5951799
	speed: 0.0065s/iter; left time: 1.0670s
Updating learning rate to 8.416740421875e-07
Epoch: 7 cost time: 0.5165228843688965
Epoch: 7, Steps: 131 | Train Loss: 0.5951799 Vali Loss: 0.2786336 Best vali loss: 0.2786325
	iters: 100, epoch: 8 | loss: 0.4616539
	speed: 0.0067s/iter; left time: 0.2152s
Updating learning rate to 4.2083702109375e-07
Epoch: 8 cost time: 0.5524272918701172
Epoch: 8, Steps: 131 | Train Loss: 0.4616539 Vali Loss: 0.2786783 Best vali loss: 0.2786325

best validation loss 0.27863251078456874

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597183
	speed: 0.0104s/iter; left time: 9.9162s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.928642749786377
Epoch: 1, Steps: 131 | Train Loss: 0.5597183 Vali Loss: 0.2756360 Best vali loss: 0.2756360
	iters: 100, epoch: 2 | loss: 0.3254794
	speed: 0.0089s/iter; left time: 7.2696s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2756 --> 0.2688).  Saving model state dict ...
Epoch: 2 cost time: 0.7078447341918945
Epoch: 2, Steps: 131 | Train Loss: 0.3254794 Vali Loss: 0.2688262 Best vali loss: 0.2688262
	iters: 100, epoch: 3 | loss: 0.4612725
	speed: 0.0090s/iter; left time: 6.1872s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.7107710838317871
Epoch: 3, Steps: 131 | Train Loss: 0.4612725 Vali Loss: 0.2763506 Best vali loss: 0.2688262
	iters: 100, epoch: 4 | loss: 0.4796919
	speed: 0.0088s/iter; left time: 4.8773s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 0.7081108093261719
Epoch: 4, Steps: 131 | Train Loss: 0.4796919 Vali Loss: 0.2791315 Best vali loss: 0.2688262
	iters: 100, epoch: 5 | loss: 0.3390167
	speed: 0.0087s/iter; left time: 3.7011s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.7029564380645752
Epoch: 5, Steps: 131 | Train Loss: 0.3390167 Vali Loss: 0.2894675 Best vali loss: 0.2688262
	iters: 100, epoch: 6 | loss: 0.3069155
	speed: 0.0086s/iter; left time: 2.5359s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.7006456851959229
Epoch: 6, Steps: 131 | Train Loss: 0.3069155 Vali Loss: 0.2961340 Best vali loss: 0.2688262
	iters: 100, epoch: 7 | loss: 0.2831309
	speed: 0.0086s/iter; left time: 1.4027s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 0.7056443691253662
Epoch: 7, Steps: 131 | Train Loss: 0.2831309 Vali Loss: 0.2967120 Best vali loss: 0.2688262
	iters: 100, epoch: 8 | loss: 0.3424630
	speed: 0.0086s/iter; left time: 0.2766s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7000699043273926
Epoch: 8, Steps: 131 | Train Loss: 0.3424630 Vali Loss: 0.2975443 Best vali loss: 0.2688262

best validation loss 0.2688262342032379

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010258645131, 'e_layers': 2, 'learning_rate': 0.0002347732665, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4575515
	speed: 0.0093s/iter; left time: 8.7912s
Updating learning rate to 0.00022583774110008386
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.7825212478637695
Epoch: 1, Steps: 131 | Train Loss: 0.4575515 Vali Loss: 0.2816954 Best vali loss: 0.2816954
	iters: 100, epoch: 2 | loss: 0.5971765
	speed: 0.0068s/iter; left time: 5.5884s
Updating learning rate to 0.00020039151764173323
Validation loss decreased (0.2817 --> 0.2768).  Saving model state dict ...
Epoch: 2 cost time: 0.524688720703125
Epoch: 2, Steps: 131 | Train Loss: 0.5971765 Vali Loss: 0.2768049 Best vali loss: 0.2768049
	iters: 100, epoch: 3 | loss: 0.5676167
	speed: 0.0070s/iter; left time: 4.8247s
Updating learning rate to 0.00016230855297589197
Epoch: 3 cost time: 0.5604424476623535
Epoch: 3, Steps: 131 | Train Loss: 0.5676167 Vali Loss: 0.2798754 Best vali loss: 0.2768049
	iters: 100, epoch: 4 | loss: 0.5476130
	speed: 0.0069s/iter; left time: 3.8518s
Updating learning rate to 0.00011738663325
Epoch: 4 cost time: 0.5592861175537109
Epoch: 4, Steps: 131 | Train Loss: 0.5476130 Vali Loss: 0.2941937 Best vali loss: 0.2768049
	iters: 100, epoch: 5 | loss: 0.3649997
	speed: 0.0069s/iter; left time: 2.9391s
Updating learning rate to 7.246471352410803e-05
Epoch: 5 cost time: 0.5487868785858154
Epoch: 5, Steps: 131 | Train Loss: 0.3649997 Vali Loss: 0.2915381 Best vali loss: 0.2768049
	iters: 100, epoch: 6 | loss: 0.3118646
	speed: 0.0070s/iter; left time: 2.0547s
Updating learning rate to 3.438174885826675e-05
Epoch: 6 cost time: 0.5690386295318604
Epoch: 6, Steps: 131 | Train Loss: 0.3118646 Vali Loss: 0.2897614 Best vali loss: 0.2768049
	iters: 100, epoch: 7 | loss: 0.2773875
	speed: 0.0070s/iter; left time: 1.1412s
Updating learning rate to 8.935525399916131e-06
Epoch: 7 cost time: 0.5626142024993896
Epoch: 7, Steps: 131 | Train Loss: 0.2773875 Vali Loss: 0.3013541 Best vali loss: 0.2768049
	iters: 100, epoch: 8 | loss: 0.3543239
	speed: 0.0071s/iter; left time: 0.2276s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5707738399505615
Epoch: 8, Steps: 131 | Train Loss: 0.3543239 Vali Loss: 0.2969839 Best vali loss: 0.2768049

best validation loss 0.2768048612202087

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010258761691, 'e_layers': 2, 'learning_rate': 5.28877857e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4628115
	speed: 0.0093s/iter; left time: 8.8286s
Updating learning rate to 5.087486421403656e-05
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 0.7962913513183594
Epoch: 1, Steps: 131 | Train Loss: 0.4628115 Vali Loss: 0.2895286 Best vali loss: 0.2895286
	iters: 100, epoch: 2 | loss: 0.3019347
	speed: 0.0069s/iter; left time: 5.6055s
Updating learning rate to 4.514254880520546e-05
Validation loss decreased (0.2895 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 0.5420198440551758
Epoch: 2, Steps: 131 | Train Loss: 0.3019347 Vali Loss: 0.2807965 Best vali loss: 0.2807965
	iters: 100, epoch: 3 | loss: 0.4201570
	speed: 0.0068s/iter; left time: 4.6373s
Updating learning rate to 3.6563532530932656e-05
Epoch: 3 cost time: 0.5323498249053955
Epoch: 3, Steps: 131 | Train Loss: 0.4201570 Vali Loss: 0.2812551 Best vali loss: 0.2807965

best validation loss 0.28079653570380697

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001027127088, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597024
	speed: 0.0105s/iter; left time: 9.9272s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9355051517486572
Epoch: 1, Steps: 131 | Train Loss: 0.5597024 Vali Loss: 0.2756336 Best vali loss: 0.2756336
	iters: 100, epoch: 2 | loss: 0.3236477
	speed: 0.0088s/iter; left time: 7.2266s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.7030315399169922
Epoch: 2, Steps: 131 | Train Loss: 0.3236477 Vali Loss: 0.2689710 Best vali loss: 0.2689710
	iters: 100, epoch: 3 | loss: 0.4624413
	speed: 0.0092s/iter; left time: 6.2944s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7104570865631104
Epoch: 3, Steps: 131 | Train Loss: 0.4624413 Vali Loss: 0.2788871 Best vali loss: 0.2689710

best validation loss 0.26897103930991484

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0055598166579, 'e_layers': 4, 'learning_rate': 0.0001468646066, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7590264
	speed: 0.0101s/iter; left time: 83.8241s
	iters: 200, epoch: 1 | loss: 0.3385119
	speed: 0.0050s/iter; left time: 41.1959s
	iters: 300, epoch: 1 | loss: 1.0003836
	speed: 0.0050s/iter; left time: 40.3014s
	iters: 400, epoch: 1 | loss: 0.5424988
	speed: 0.0050s/iter; left time: 40.1332s
	iters: 500, epoch: 1 | loss: 1.4068172
	speed: 0.0051s/iter; left time: 39.8487s
	iters: 600, epoch: 1 | loss: 0.4918239
	speed: 0.0050s/iter; left time: 38.9705s
	iters: 700, epoch: 1 | loss: 0.3802584
	speed: 0.0050s/iter; left time: 38.6073s
	iters: 800, epoch: 1 | loss: 0.5600526
	speed: 0.0050s/iter; left time: 38.0490s
	iters: 900, epoch: 1 | loss: 0.2787619
	speed: 0.0050s/iter; left time: 37.2300s
	iters: 1000, epoch: 1 | loss: 1.2418933
	speed: 0.0050s/iter; left time: 36.9588s
Updating learning rate to 0.00014127490534403102
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 5.515756845474243
Epoch: 1, Steps: 1045 | Train Loss: 0.7000028 Vali Loss: 0.2842393 Best vali loss: 0.2842393
	iters: 100, epoch: 2 | loss: 0.6528497
	speed: 0.0136s/iter; left time: 98.4017s
	iters: 200, epoch: 2 | loss: 0.3550277
	speed: 0.0048s/iter; left time: 34.0039s
	iters: 300, epoch: 2 | loss: 0.3292221
	speed: 0.0047s/iter; left time: 33.2457s
	iters: 400, epoch: 2 | loss: 0.3455924
	speed: 0.0047s/iter; left time: 32.7216s
	iters: 500, epoch: 2 | loss: 0.2251421
	speed: 0.0047s/iter; left time: 32.2851s
	iters: 600, epoch: 2 | loss: 0.6627288
	speed: 0.0047s/iter; left time: 31.6792s
	iters: 700, epoch: 2 | loss: 0.7065866
	speed: 0.0047s/iter; left time: 31.1497s
	iters: 800, epoch: 2 | loss: 0.7572642
	speed: 0.0047s/iter; left time: 30.7236s
	iters: 900, epoch: 2 | loss: 0.7556049
	speed: 0.0047s/iter; left time: 30.2821s
	iters: 1000, epoch: 2 | loss: 0.4445300
	speed: 0.0047s/iter; left time: 29.8137s
Updating learning rate to 0.00012535678292157728
Validation loss decreased (0.2842 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 4.9807727336883545
Epoch: 2, Steps: 1045 | Train Loss: 0.5234549 Vali Loss: 0.2838370 Best vali loss: 0.2838370
	iters: 100, epoch: 3 | loss: 0.2789042
	speed: 0.0140s/iter; left time: 86.1659s
	iters: 200, epoch: 3 | loss: 0.3442324
	speed: 0.0051s/iter; left time: 30.9275s
	iters: 300, epoch: 3 | loss: 0.4701525
	speed: 0.0051s/iter; left time: 30.3826s
	iters: 400, epoch: 3 | loss: 0.4778551
	speed: 0.0051s/iter; left time: 29.9707s
	iters: 500, epoch: 3 | loss: 0.4122415
	speed: 0.0051s/iter; left time: 29.3740s
	iters: 600, epoch: 3 | loss: 0.7672470
	speed: 0.0051s/iter; left time: 28.9030s
	iters: 700, epoch: 3 | loss: 0.2041417
	speed: 0.0051s/iter; left time: 28.3159s
	iters: 800, epoch: 3 | loss: 0.2725192
	speed: 0.0051s/iter; left time: 27.9739s
	iters: 900, epoch: 3 | loss: 0.3910754
	speed: 0.0051s/iter; left time: 27.4323s
	iters: 1000, epoch: 3 | loss: 0.6222666
	speed: 0.0051s/iter; left time: 26.8008s
Updating learning rate to 0.00010153362917331831
Validation loss decreased (0.2838 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 5.363164663314819
Epoch: 3, Steps: 1045 | Train Loss: 0.4240636 Vali Loss: 0.2835130 Best vali loss: 0.2835130

best validation loss 0.2835129648280791

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001027127088, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4190516
	speed: 0.0106s/iter; left time: 5.8738s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9289836883544922
Epoch: 4, Steps: 131 | Train Loss: 0.4190516 Vali Loss: 0.3087988 Best vali loss: 0.2689710
	iters: 100, epoch: 5 | loss: 0.2815730
	speed: 0.0086s/iter; left time: 3.6344s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6913385391235352
Epoch: 5, Steps: 131 | Train Loss: 0.2815730 Vali Loss: 0.2980210 Best vali loss: 0.2689710
	iters: 100, epoch: 6 | loss: 0.4352213
	speed: 0.0086s/iter; left time: 2.5195s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6982543468475342
Epoch: 6, Steps: 131 | Train Loss: 0.4352213 Vali Loss: 0.3045066 Best vali loss: 0.2689710
	iters: 100, epoch: 7 | loss: 0.4708208
	speed: 0.0087s/iter; left time: 1.4169s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6991987228393555
Epoch: 7, Steps: 131 | Train Loss: 0.4708208 Vali Loss: 0.3010585 Best vali loss: 0.2689710
	iters: 100, epoch: 8 | loss: 0.3288323
	speed: 0.0086s/iter; left time: 0.2754s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6952016353607178
Epoch: 8, Steps: 131 | Train Loss: 0.3288323 Vali Loss: 0.2981170 Best vali loss: 0.2689710

best validation loss 0.26897103930991484

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002450455286, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5610216
	speed: 0.0103s/iter; left time: 9.7460s
Updating learning rate to 0.00023571903850347456
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9339990615844727
Epoch: 1, Steps: 131 | Train Loss: 0.5610216 Vali Loss: 0.2758363 Best vali loss: 0.2758363
	iters: 100, epoch: 2 | loss: 0.3291800
	speed: 0.0089s/iter; left time: 7.2867s
Updating learning rate to 0.000209159441786251
Validation loss decreased (0.2758 --> 0.2757).  Saving model state dict ...
Epoch: 2 cost time: 0.7014131546020508
Epoch: 2, Steps: 131 | Train Loss: 0.3291800 Vali Loss: 0.2757073 Best vali loss: 0.2757073
	iters: 100, epoch: 3 | loss: 0.4681076
	speed: 0.0091s/iter; left time: 6.2188s
Updating learning rate to 0.00016941019628518287
Epoch: 3 cost time: 0.703834056854248
Epoch: 3, Steps: 131 | Train Loss: 0.4681076 Vali Loss: 0.2821960 Best vali loss: 0.2757073
	iters: 100, epoch: 4 | loss: 0.4730149
	speed: 0.0087s/iter; left time: 4.8142s
Updating learning rate to 0.0001225227643
Epoch: 4 cost time: 0.6989562511444092
Epoch: 4, Steps: 131 | Train Loss: 0.4730149 Vali Loss: 0.2811352 Best vali loss: 0.2757073
	iters: 100, epoch: 5 | loss: 0.3407325
	speed: 0.0086s/iter; left time: 3.6439s
Updating learning rate to 7.56353323148171e-05
Epoch: 5 cost time: 0.6934852600097656
Epoch: 5, Steps: 131 | Train Loss: 0.3407325 Vali Loss: 0.2901908 Best vali loss: 0.2757073
	iters: 100, epoch: 6 | loss: 0.3071201
	speed: 0.0086s/iter; left time: 2.5349s
Updating learning rate to 3.588608681374897e-05
Epoch: 6 cost time: 0.6944737434387207
Epoch: 6, Steps: 131 | Train Loss: 0.3071201 Vali Loss: 0.3006995 Best vali loss: 0.2757073
	iters: 100, epoch: 7 | loss: 0.2865458
	speed: 0.0086s/iter; left time: 1.3991s
Updating learning rate to 9.326490096525427e-06
Epoch: 7 cost time: 0.6937487125396729
Epoch: 7, Steps: 131 | Train Loss: 0.2865458 Vali Loss: 0.2989179 Best vali loss: 0.2757073
	iters: 100, epoch: 8 | loss: 0.3354034
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6998002529144287
Epoch: 8, Steps: 131 | Train Loss: 0.3354034 Vali Loss: 0.3018549 Best vali loss: 0.2757073

best validation loss 0.27570732827300076

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010286278762, 'e_layers': 2, 'learning_rate': 0.0002340222962, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597147
	speed: 0.0103s/iter; left time: 9.7460s
Updating learning rate to 0.00022511535290523695
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9296281337738037
Epoch: 1, Steps: 131 | Train Loss: 0.5597147 Vali Loss: 0.2756447 Best vali loss: 0.2756447
	iters: 100, epoch: 2 | loss: 0.3253833
	speed: 0.0089s/iter; left time: 7.2700s
Updating learning rate to 0.00019975052439593342
Validation loss decreased (0.2756 --> 0.2717).  Saving model state dict ...
Epoch: 2 cost time: 0.7032794952392578
Epoch: 2, Steps: 131 | Train Loss: 0.3253833 Vali Loss: 0.2717165 Best vali loss: 0.2717165
	iters: 100, epoch: 3 | loss: 0.4697140
	speed: 0.0090s/iter; left time: 6.2034s
Updating learning rate to 0.00016178937587988786
Epoch: 3 cost time: 0.7040235996246338
Epoch: 3, Steps: 131 | Train Loss: 0.4697140 Vali Loss: 0.2768979 Best vali loss: 0.2717165
	iters: 100, epoch: 4 | loss: 0.5001630
	speed: 0.0085s/iter; left time: 4.7414s
Updating learning rate to 0.0001170111481
Epoch: 4 cost time: 0.694669246673584
Epoch: 4, Steps: 131 | Train Loss: 0.5001630 Vali Loss: 0.2827026 Best vali loss: 0.2717165
	iters: 100, epoch: 5 | loss: 0.3327463
	speed: 0.0086s/iter; left time: 3.6451s
Updating learning rate to 7.223292032011216e-05
Epoch: 5 cost time: 0.6990652084350586
Epoch: 5, Steps: 131 | Train Loss: 0.3327463 Vali Loss: 0.2905898 Best vali loss: 0.2717165
	iters: 100, epoch: 6 | loss: 0.3110247
	speed: 0.0087s/iter; left time: 2.5586s
Updating learning rate to 3.4271771804066605e-05
Epoch: 6 cost time: 0.7037994861602783
Epoch: 6, Steps: 131 | Train Loss: 0.3110247 Vali Loss: 0.3026813 Best vali loss: 0.2717165
	iters: 100, epoch: 7 | loss: 0.2875859
	speed: 0.0085s/iter; left time: 1.3934s
Updating learning rate to 8.906943294763063e-06
Epoch: 7 cost time: 0.6956613063812256
Epoch: 7, Steps: 131 | Train Loss: 0.2875859 Vali Loss: 0.3047551 Best vali loss: 0.2717165
	iters: 100, epoch: 8 | loss: 0.3427179
	speed: 0.0087s/iter; left time: 0.2783s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7012577056884766
Epoch: 8, Steps: 131 | Train Loss: 0.3427179 Vali Loss: 0.3043071 Best vali loss: 0.2717165

best validation loss 0.2717165452656404

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010233942671, 'e_layers': 2, 'learning_rate': 0.0002443250028, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5608414
	speed: 0.0102s/iter; left time: 9.6645s
Updating learning rate to 0.00023502593608384144
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9227659702301025
Epoch: 1, Steps: 131 | Train Loss: 0.5608414 Vali Loss: 0.2758094 Best vali loss: 0.2758094
	iters: 100, epoch: 2 | loss: 0.3251260
	speed: 0.0089s/iter; left time: 7.2825s
Updating learning rate to 0.00020854443454665112
Epoch: 2 cost time: 0.7086851596832275
Epoch: 2, Steps: 131 | Train Loss: 0.3251260 Vali Loss: 0.2763746 Best vali loss: 0.2758094
	iters: 100, epoch: 3 | loss: 0.4708469
	speed: 0.0087s/iter; left time: 5.9484s
Updating learning rate to 0.0001689120667420571
Epoch: 3 cost time: 0.7035036087036133
Epoch: 3, Steps: 131 | Train Loss: 0.4708469 Vali Loss: 0.2819945 Best vali loss: 0.2758094

best validation loss 0.27580940803771303

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001156042232, 'e_layers': 2, 'learning_rate': 0.0002344652356, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596979
	speed: 0.0102s/iter; left time: 9.6693s
Updating learning rate to 0.00022554143392813838
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9235639572143555
Epoch: 1, Steps: 131 | Train Loss: 0.5596979 Vali Loss: 0.2756716 Best vali loss: 0.2756716
	iters: 100, epoch: 2 | loss: 0.3234110
	speed: 0.0088s/iter; left time: 7.2084s
Updating learning rate to 0.00020012859682263075
Validation loss decreased (0.2757 --> 0.2714).  Saving model state dict ...
Epoch: 2 cost time: 0.6985146999359131
Epoch: 2, Steps: 131 | Train Loss: 0.3234110 Vali Loss: 0.2713642 Best vali loss: 0.2713642
	iters: 100, epoch: 3 | loss: 0.4692100
	speed: 0.0091s/iter; left time: 6.2215s
Updating learning rate to 0.00016209559836484873
Epoch: 3 cost time: 0.7077608108520508
Epoch: 3, Steps: 131 | Train Loss: 0.4692100 Vali Loss: 0.2756087 Best vali loss: 0.2713642

best validation loss 0.27136421094999386

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010922921198, 'e_layers': 2, 'learning_rate': 0.000233640005, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596006
	speed: 0.0102s/iter; left time: 9.7054s
Updating learning rate to 0.00022474761179766734
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9304580688476562
Epoch: 1, Steps: 131 | Train Loss: 0.5596006 Vali Loss: 0.2756392 Best vali loss: 0.2756392
	iters: 100, epoch: 2 | loss: 0.3249526
	speed: 0.0089s/iter; left time: 7.3113s
Updating learning rate to 0.00019942421844597942
Validation loss decreased (0.2756 --> 0.2695).  Saving model state dict ...
Epoch: 2 cost time: 0.7012021541595459
Epoch: 2, Steps: 131 | Train Loss: 0.3249526 Vali Loss: 0.2694911 Best vali loss: 0.2694911
	iters: 100, epoch: 3 | loss: 0.4645822
	speed: 0.0090s/iter; left time: 6.2005s
Updating learning rate to 0.00016152508202559837
Epoch: 3 cost time: 0.6963791847229004
Epoch: 3, Steps: 131 | Train Loss: 0.4645822 Vali Loss: 0.2805703 Best vali loss: 0.2694911

best validation loss 0.2694911088097623

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010922921198, 'e_layers': 2, 'learning_rate': 0.000233640005, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4209082
	speed: 0.0105s/iter; left time: 5.8478s
Updating learning rate to 0.0001168200025
Epoch: 4 cost time: 0.9222722053527832
Epoch: 4, Steps: 131 | Train Loss: 0.4209082 Vali Loss: 0.2884980 Best vali loss: 0.2694911
	iters: 100, epoch: 5 | loss: 0.2700348
	speed: 0.0087s/iter; left time: 3.6831s
Updating learning rate to 7.211492297440164e-05
Epoch: 5 cost time: 0.7028324604034424
Epoch: 5, Steps: 131 | Train Loss: 0.2700348 Vali Loss: 0.2891794 Best vali loss: 0.2694911
	iters: 100, epoch: 6 | loss: 0.3831591
	speed: 0.0086s/iter; left time: 2.5280s
Updating learning rate to 3.4215786554020575e-05
Epoch: 6 cost time: 0.7032368183135986
Epoch: 6, Steps: 131 | Train Loss: 0.3831591 Vali Loss: 0.2941885 Best vali loss: 0.2694911
	iters: 100, epoch: 7 | loss: 0.3964288
	speed: 0.0086s/iter; left time: 1.3945s
Updating learning rate to 8.892393202332651e-06
Epoch: 7 cost time: 0.6933333873748779
Epoch: 7, Steps: 131 | Train Loss: 0.3964288 Vali Loss: 0.3056457 Best vali loss: 0.2694911
	iters: 100, epoch: 8 | loss: 0.2995214
	speed: 0.0087s/iter; left time: 0.2788s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7085607051849365
Epoch: 8, Steps: 131 | Train Loss: 0.2995214 Vali Loss: 0.3046566 Best vali loss: 0.2694911

best validation loss 0.2694911088097623

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012100741818, 'e_layers': 2, 'learning_rate': 0.0002337197381, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596012
	speed: 0.0103s/iter; left time: 9.8093s
Updating learning rate to 0.0002248243102372442
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9293704032897949
Epoch: 1, Steps: 131 | Train Loss: 0.5596012 Vali Loss: 0.2756453 Best vali loss: 0.2756453
	iters: 100, epoch: 2 | loss: 0.3253247
	speed: 0.0089s/iter; left time: 7.2716s
Updating learning rate to 0.00019949227490382695
Validation loss decreased (0.2756 --> 0.2707).  Saving model state dict ...
Epoch: 2 cost time: 0.7064392566680908
Epoch: 2, Steps: 131 | Train Loss: 0.3253247 Vali Loss: 0.2706862 Best vali loss: 0.2706862
	iters: 100, epoch: 3 | loss: 0.4611160
	speed: 0.0090s/iter; left time: 6.1792s
Updating learning rate to 0.00016158020484378894
Epoch: 3 cost time: 0.710038423538208
Epoch: 3, Steps: 131 | Train Loss: 0.4611160 Vali Loss: 0.2777267 Best vali loss: 0.2706862
	iters: 100, epoch: 4 | loss: 0.4752416
	speed: 0.0086s/iter; left time: 4.7883s
Updating learning rate to 0.00011685986905
Epoch: 4 cost time: 0.7027685642242432
Epoch: 4, Steps: 131 | Train Loss: 0.4752416 Vali Loss: 0.2815415 Best vali loss: 0.2706862
	iters: 100, epoch: 5 | loss: 0.3329840
	speed: 0.0086s/iter; left time: 3.6602s
Updating learning rate to 7.213953325621109e-05
Epoch: 5 cost time: 0.702885627746582
Epoch: 5, Steps: 131 | Train Loss: 0.3329840 Vali Loss: 0.2879359 Best vali loss: 0.2706862
	iters: 100, epoch: 6 | loss: 0.3041805
	speed: 0.0086s/iter; left time: 2.5415s
Updating learning rate to 3.422746319617306e-05
Epoch: 6 cost time: 0.6972031593322754
Epoch: 6, Steps: 131 | Train Loss: 0.3041805 Vali Loss: 0.2945010 Best vali loss: 0.2706862
	iters: 100, epoch: 7 | loss: 0.2856013
	speed: 0.0086s/iter; left time: 1.4042s
Updating learning rate to 8.895427862755813e-06
Epoch: 7 cost time: 0.7043843269348145
Epoch: 7, Steps: 131 | Train Loss: 0.2856013 Vali Loss: 0.2976091 Best vali loss: 0.2706862
	iters: 100, epoch: 8 | loss: 0.3437656
	speed: 0.0086s/iter; left time: 0.2750s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.696220874786377
Epoch: 8, Steps: 131 | Train Loss: 0.3437656 Vali Loss: 0.2982282 Best vali loss: 0.2706862

best validation loss 0.2706861921560813

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0090271357217, 'e_layers': 3, 'learning_rate': 5.47188441e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7380792
	speed: 0.0098s/iter; left time: 19.5710s
	iters: 200, epoch: 1 | loss: 0.7265552
	speed: 0.0046s/iter; left time: 8.6939s
Updating learning rate to 5.263623210333299e-05
Validation loss decreased (inf --> 0.2957).  Saving model state dict ...
Epoch: 1 cost time: 1.4398555755615234
Epoch: 1, Steps: 262 | Train Loss: 0.7323172 Vali Loss: 0.2957264 Best vali loss: 0.2957264
	iters: 100, epoch: 2 | loss: 0.9449606
	speed: 0.0094s/iter; left time: 16.2544s
	iters: 200, epoch: 2 | loss: 0.5387933
	speed: 0.0042s/iter; left time: 6.7952s
Updating learning rate to 4.670545491089975e-05
Validation loss decreased (0.2957 --> 0.2857).  Saving model state dict ...
Epoch: 2 cost time: 1.12437105178833
Epoch: 2, Steps: 262 | Train Loss: 0.7418770 Vali Loss: 0.2856769 Best vali loss: 0.2856769
	iters: 100, epoch: 3 | loss: 0.8109802
	speed: 0.0093s/iter; left time: 13.6613s
	iters: 200, epoch: 3 | loss: 0.8505808
	speed: 0.0045s/iter; left time: 6.2454s
Updating learning rate to 3.7829419587619125e-05
Validation loss decreased (0.2857 --> 0.2814).  Saving model state dict ...
Epoch: 3 cost time: 1.207559585571289
Epoch: 3, Steps: 262 | Train Loss: 0.8307805 Vali Loss: 0.2814198 Best vali loss: 0.2814198
	iters: 100, epoch: 4 | loss: 0.4407753
	speed: 0.0095s/iter; left time: 11.5218s
	iters: 200, epoch: 4 | loss: 0.6858663
	speed: 0.0045s/iter; left time: 5.0385s
Updating learning rate to 2.735942205e-05
Validation loss decreased (0.2814 --> 0.2803).  Saving model state dict ...
Epoch: 4 cost time: 1.203486442565918
Epoch: 4, Steps: 262 | Train Loss: 0.5633208 Vali Loss: 0.2803152 Best vali loss: 0.2803152
	iters: 100, epoch: 5 | loss: 0.2746297
	speed: 0.0098s/iter; left time: 9.2884s
	iters: 200, epoch: 5 | loss: 0.3691404
	speed: 0.0040s/iter; left time: 3.4357s
Updating learning rate to 1.6889424512380882e-05
Validation loss decreased (0.2803 --> 0.2799).  Saving model state dict ...
Epoch: 5 cost time: 1.156707525253296
Epoch: 5, Steps: 262 | Train Loss: 0.3218851 Vali Loss: 0.2799424 Best vali loss: 0.2799424
	iters: 100, epoch: 6 | loss: 0.7653036
	speed: 0.0093s/iter; left time: 6.3688s
	iters: 200, epoch: 6 | loss: 0.6453708
	speed: 0.0041s/iter; left time: 2.4204s
Updating learning rate to 8.013389189100248e-06
Validation loss decreased (0.2799 --> 0.2791).  Saving model state dict ...
Epoch: 6 cost time: 1.1418888568878174
Epoch: 6, Steps: 262 | Train Loss: 0.7053372 Vali Loss: 0.2791391 Best vali loss: 0.2791391
	iters: 100, epoch: 7 | loss: 0.4939180
	speed: 0.0095s/iter; left time: 4.0477s
	iters: 200, epoch: 7 | loss: 0.3527747
	speed: 0.0045s/iter; left time: 1.4758s
Updating learning rate to 2.0826119966670097e-06
Epoch: 7 cost time: 1.2204840183258057
Epoch: 7, Steps: 262 | Train Loss: 0.4233464 Vali Loss: 0.2793121 Best vali loss: 0.2791391
	iters: 100, epoch: 8 | loss: 0.5945560
	speed: 0.0097s/iter; left time: 1.5819s
	iters: 200, epoch: 8 | loss: 0.4393696
	speed: 0.0045s/iter; left time: 0.2829s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2178833484649658
Epoch: 8, Steps: 262 | Train Loss: 0.5169628 Vali Loss: 0.2793172 Best vali loss: 0.2791391

best validation loss 0.2791391018876448

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597183
	speed: 0.0106s/iter; left time: 10.0424s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9392139911651611
Epoch: 1, Steps: 131 | Train Loss: 0.5597183 Vali Loss: 0.2756360 Best vali loss: 0.2756360
	iters: 100, epoch: 2 | loss: 0.3257625
	speed: 0.0088s/iter; left time: 7.2366s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2756 --> 0.2692).  Saving model state dict ...
Epoch: 2 cost time: 0.7007806301116943
Epoch: 2, Steps: 131 | Train Loss: 0.3257625 Vali Loss: 0.2692123 Best vali loss: 0.2692123
	iters: 100, epoch: 3 | loss: 0.4629001
	speed: 0.0089s/iter; left time: 6.1460s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.7063419818878174
Epoch: 3, Steps: 131 | Train Loss: 0.4629001 Vali Loss: 0.2791917 Best vali loss: 0.2692123

best validation loss 0.26921226316422237

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010262185717, 'e_layers': 2, 'learning_rate': 0.0002346474545, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597149
	speed: 0.0103s/iter; left time: 9.7965s
Updating learning rate to 0.0002346474545
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.926908016204834
Epoch: 1, Steps: 131 | Train Loss: 0.5597149 Vali Loss: 0.2756321 Best vali loss: 0.2756321
	iters: 100, epoch: 2 | loss: 0.3248683
	speed: 0.0089s/iter; left time: 7.3206s
Updating learning rate to 0.00011732372725
Validation loss decreased (0.2756 --> 0.2701).  Saving model state dict ...
Epoch: 2 cost time: 0.7023179531097412
Epoch: 2, Steps: 131 | Train Loss: 0.3248683 Vali Loss: 0.2700642 Best vali loss: 0.2700642
	iters: 100, epoch: 3 | loss: 0.4614123
	speed: 0.0089s/iter; left time: 6.1359s
Updating learning rate to 5.8661863625e-05
Epoch: 3 cost time: 0.7047164440155029
Epoch: 3, Steps: 131 | Train Loss: 0.4614123 Vali Loss: 0.2836451 Best vali loss: 0.2700642

best validation loss 0.270064160211151

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6058317
	speed: 0.0076s/iter; left time: 62.3956s
	iters: 200, epoch: 1 | loss: 0.2699383
	speed: 0.0024s/iter; left time: 19.4242s
	iters: 300, epoch: 1 | loss: 0.7872224
	speed: 0.0023s/iter; left time: 18.8964s
	iters: 400, epoch: 1 | loss: 0.2649958
	speed: 0.0024s/iter; left time: 18.7164s
	iters: 500, epoch: 1 | loss: 1.3114923
	speed: 0.0024s/iter; left time: 18.6905s
	iters: 600, epoch: 1 | loss: 0.2518739
	speed: 0.0024s/iter; left time: 18.4379s
	iters: 700, epoch: 1 | loss: 0.4028115
	speed: 0.0024s/iter; left time: 18.1252s
	iters: 800, epoch: 1 | loss: 0.4955726
	speed: 0.0023s/iter; left time: 17.7659s
	iters: 900, epoch: 1 | loss: 0.2501615
	speed: 0.0022s/iter; left time: 16.3470s
	iters: 1000, epoch: 1 | loss: 0.7284500
	speed: 0.0022s/iter; left time: 15.9992s
Updating learning rate to 0.00022273671327002105
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 2.6781437397003174
Epoch: 1, Steps: 1045 | Train Loss: 0.5368350 Vali Loss: 0.2828754 Best vali loss: 0.2828754
	iters: 100, epoch: 2 | loss: 0.2302637
	speed: 0.0078s/iter; left time: 56.4572s
	iters: 200, epoch: 2 | loss: 0.2109590
	speed: 0.0023s/iter; left time: 16.0192s
	iters: 300, epoch: 2 | loss: 0.8566108
	speed: 0.0022s/iter; left time: 15.7171s
	iters: 400, epoch: 2 | loss: 0.4489828
	speed: 0.0022s/iter; left time: 15.4717s
	iters: 500, epoch: 2 | loss: 0.3540064
	speed: 0.0021s/iter; left time: 14.5916s
	iters: 600, epoch: 2 | loss: 0.6355854
	speed: 0.0021s/iter; left time: 14.0575s
	iters: 700, epoch: 2 | loss: 0.2068795
	speed: 0.0021s/iter; left time: 13.8660s
	iters: 800, epoch: 2 | loss: 0.5405577
	speed: 0.0021s/iter; left time: 13.6565s
	iters: 900, epoch: 2 | loss: 0.5894132
	speed: 0.0021s/iter; left time: 13.5448s
	iters: 1000, epoch: 2 | loss: 0.3379822
	speed: 0.0022s/iter; left time: 13.9557s
Updating learning rate to 0.00019763989751797302
Epoch: 2 cost time: 2.301703453063965
Epoch: 2, Steps: 1045 | Train Loss: 0.4411241 Vali Loss: 0.2874227 Best vali loss: 0.2828754
	iters: 100, epoch: 3 | loss: 0.2250834
	speed: 0.0076s/iter; left time: 46.7758s
	iters: 200, epoch: 3 | loss: 1.0302331
	speed: 0.0021s/iter; left time: 12.8133s
	iters: 300, epoch: 3 | loss: 0.3414331
	speed: 0.0021s/iter; left time: 12.4151s
	iters: 400, epoch: 3 | loss: 0.2229622
	speed: 0.0021s/iter; left time: 12.2986s
	iters: 500, epoch: 3 | loss: 0.8549917
	speed: 0.0021s/iter; left time: 12.0782s
	iters: 600, epoch: 3 | loss: 0.2141382
	speed: 0.0021s/iter; left time: 11.8581s
	iters: 700, epoch: 3 | loss: 0.2604449
	speed: 0.0021s/iter; left time: 11.8526s
	iters: 800, epoch: 3 | loss: 0.2655429
	speed: 0.0021s/iter; left time: 11.5872s
	iters: 900, epoch: 3 | loss: 0.3089024
	speed: 0.0021s/iter; left time: 11.3235s
	iters: 1000, epoch: 3 | loss: 0.5984270
	speed: 0.0021s/iter; left time: 11.1494s
Updating learning rate to 0.00016007985843890398
Epoch: 3 cost time: 2.242408514022827
Epoch: 3, Steps: 1045 | Train Loss: 0.4322159 Vali Loss: 0.2961831 Best vali loss: 0.2828754

best validation loss 0.28287543451732844

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4188609
	speed: 0.0109s/iter; left time: 6.0594s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.9389157295227051
Epoch: 4, Steps: 131 | Train Loss: 0.4188609 Vali Loss: 0.3139332 Best vali loss: 0.2692123
	iters: 100, epoch: 5 | loss: 0.2828319
	speed: 0.0085s/iter; left time: 3.6307s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.6888065338134766
Epoch: 5, Steps: 131 | Train Loss: 0.2828319 Vali Loss: 0.2961807 Best vali loss: 0.2692123
	iters: 100, epoch: 6 | loss: 0.4370209
	speed: 0.0085s/iter; left time: 2.4872s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.6889779567718506
Epoch: 6, Steps: 131 | Train Loss: 0.4370209 Vali Loss: 0.3008167 Best vali loss: 0.2692123
	iters: 100, epoch: 7 | loss: 0.4646296
	speed: 0.0087s/iter; left time: 1.4146s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.7033636569976807
Epoch: 7, Steps: 131 | Train Loss: 0.4646296 Vali Loss: 0.2967910 Best vali loss: 0.2692123
	iters: 100, epoch: 8 | loss: 0.3283209
	speed: 0.0086s/iter; left time: 0.2744s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.6957273483276367
Epoch: 8, Steps: 131 | Train Loss: 0.3283209 Vali Loss: 0.2935700 Best vali loss: 0.2692123

best validation loss 0.26921226316422237

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7705776
	speed: 0.0094s/iter; left time: 38.2680s
	iters: 200, epoch: 1 | loss: 0.2257585
	speed: 0.0041s/iter; left time: 16.4652s
	iters: 300, epoch: 1 | loss: 0.8536066
	speed: 0.0042s/iter; left time: 16.1813s
	iters: 400, epoch: 1 | loss: 0.3156607
	speed: 0.0041s/iter; left time: 15.6781s
	iters: 500, epoch: 1 | loss: 0.2896612
	speed: 0.0042s/iter; left time: 15.5031s
Updating learning rate to 0.0005359963767340445
Validation loss decreased (inf --> 0.2851).  Saving model state dict ...
Epoch: 1 cost time: 2.43361759185791
Epoch: 1, Steps: 523 | Train Loss: 0.4910529 Vali Loss: 0.2850976 Best vali loss: 0.2850976
	iters: 100, epoch: 2 | loss: 0.2725548
	speed: 0.0086s/iter; left time: 30.5483s
	iters: 200, epoch: 2 | loss: 0.7207882
	speed: 0.0042s/iter; left time: 14.4003s
	iters: 300, epoch: 2 | loss: 0.3576042
	speed: 0.0042s/iter; left time: 14.1480s
	iters: 400, epoch: 2 | loss: 0.4042794
	speed: 0.0042s/iter; left time: 13.7249s
	iters: 500, epoch: 2 | loss: 0.4496273
	speed: 0.0043s/iter; left time: 13.4772s
Updating learning rate to 0.00047560308946149616
Epoch: 2 cost time: 2.2325351238250732
Epoch: 2, Steps: 523 | Train Loss: 0.4409708 Vali Loss: 0.2857726 Best vali loss: 0.2850976
	iters: 100, epoch: 3 | loss: 0.7362032
	speed: 0.0089s/iter; left time: 26.9004s
	iters: 200, epoch: 3 | loss: 0.5025969
	speed: 0.0043s/iter; left time: 12.4921s
	iters: 300, epoch: 3 | loss: 0.4368948
	speed: 0.0045s/iter; left time: 12.6351s
	iters: 400, epoch: 3 | loss: 0.3374017
	speed: 0.0041s/iter; left time: 11.1752s
	iters: 500, epoch: 3 | loss: 0.4007300
	speed: 0.0043s/iter; left time: 11.3994s
Updating learning rate to 0.0003852181477030879
Validation loss decreased (0.2851 --> 0.2845).  Saving model state dict ...
Epoch: 3 cost time: 2.2715790271759033
Epoch: 3, Steps: 523 | Train Loss: 0.4827653 Vali Loss: 0.2844521 Best vali loss: 0.2844521
	iters: 100, epoch: 4 | loss: 0.4830664
	speed: 0.0085s/iter; left time: 21.4756s
	iters: 200, epoch: 4 | loss: 0.3793457
	speed: 0.0040s/iter; left time: 9.5571s
	iters: 300, epoch: 4 | loss: 0.5879496
	speed: 0.0039s/iter; left time: 9.0554s
	iters: 400, epoch: 4 | loss: 0.2931855
	speed: 0.0039s/iter; left time: 8.7021s
	iters: 500, epoch: 4 | loss: 0.5635571
	speed: 0.0039s/iter; left time: 8.2439s
Updating learning rate to 0.0002786018395
Epoch: 4 cost time: 2.0867726802825928
Epoch: 4, Steps: 523 | Train Loss: 0.4614209 Vali Loss: 0.2888622 Best vali loss: 0.2844521
	iters: 100, epoch: 5 | loss: 0.3699178
	speed: 0.0084s/iter; left time: 16.6756s
	iters: 200, epoch: 5 | loss: 0.3555698
	speed: 0.0039s/iter; left time: 7.4441s
	iters: 300, epoch: 5 | loss: 0.5231021
	speed: 0.0040s/iter; left time: 7.1342s
	iters: 400, epoch: 5 | loss: 0.4249011
	speed: 0.0039s/iter; left time: 6.5232s
	iters: 500, epoch: 5 | loss: 0.3791834
	speed: 0.0037s/iter; left time: 5.8296s
Updating learning rate to 0.0001719855312969122
Epoch: 5 cost time: 2.0578863620758057
Epoch: 5, Steps: 523 | Train Loss: 0.4105348 Vali Loss: 0.2920804 Best vali loss: 0.2844521
	iters: 100, epoch: 6 | loss: 0.6547170
	speed: 0.0082s/iter; left time: 12.0738s
	iters: 200, epoch: 6 | loss: 0.2235773
	speed: 0.0041s/iter; left time: 5.5781s
	iters: 300, epoch: 6 | loss: 0.4666217
	speed: 0.0042s/iter; left time: 5.3468s
	iters: 400, epoch: 6 | loss: 0.2560591
	speed: 0.0042s/iter; left time: 4.9077s
	iters: 500, epoch: 6 | loss: 0.5689517
	speed: 0.0041s/iter; left time: 4.4267s
Updating learning rate to 8.160058953850389e-05
Epoch: 6 cost time: 2.1943390369415283
Epoch: 6, Steps: 523 | Train Loss: 0.4339853 Vali Loss: 0.2940951 Best vali loss: 0.2844521
	iters: 100, epoch: 7 | loss: 0.3046869
	speed: 0.0085s/iter; left time: 8.0383s
	iters: 200, epoch: 7 | loss: 0.3608889
	speed: 0.0039s/iter; left time: 3.3304s
	iters: 300, epoch: 7 | loss: 0.4522765
	speed: 0.0039s/iter; left time: 2.9193s
	iters: 400, epoch: 7 | loss: 0.5734343
	speed: 0.0039s/iter; left time: 2.5219s
	iters: 500, epoch: 7 | loss: 0.2934568
	speed: 0.0040s/iter; left time: 2.1735s
Updating learning rate to 2.1207302265955462e-05
Epoch: 7 cost time: 2.102328300476074
Epoch: 7, Steps: 523 | Train Loss: 0.3969487 Vali Loss: 0.2907943 Best vali loss: 0.2844521
	iters: 100, epoch: 8 | loss: 0.2389039
	speed: 0.0080s/iter; left time: 3.4069s
	iters: 200, epoch: 8 | loss: 0.4756057
	speed: 0.0037s/iter; left time: 1.1982s
	iters: 300, epoch: 8 | loss: 0.3545722
	speed: 0.0037s/iter; left time: 0.8180s
	iters: 400, epoch: 8 | loss: 0.3294650
	speed: 0.0037s/iter; left time: 0.4597s
	iters: 500, epoch: 8 | loss: 0.5228724
	speed: 0.0036s/iter; left time: 0.0867s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9521968364715576
Epoch: 8, Steps: 523 | Train Loss: 0.3842838 Vali Loss: 0.2919384 Best vali loss: 0.2844521

best validation loss 0.28445213382551776

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021887918326, 'e_layers': 3, 'learning_rate': 0.0046350312805, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4813666
	speed: 0.0097s/iter; left time: 19.3529s
	iters: 200, epoch: 1 | loss: 0.4995256
	speed: 0.0045s/iter; left time: 8.4721s
Updating learning rate to 0.004458620906551766
Validation loss decreased (inf --> 0.3199).  Saving model state dict ...
Epoch: 1 cost time: 1.427283763885498
Epoch: 1, Steps: 262 | Train Loss: 0.4904461 Vali Loss: 0.3199480 Best vali loss: 0.3199480
	iters: 100, epoch: 2 | loss: 0.8744914
	speed: 0.0096s/iter; left time: 16.7360s
	iters: 200, epoch: 2 | loss: 0.4007213
	speed: 0.0044s/iter; left time: 7.1147s
Updating learning rate to 0.003956246664976659
Epoch: 2 cost time: 1.1826410293579102
Epoch: 2, Steps: 262 | Train Loss: 0.6376063 Vali Loss: 0.3264638 Best vali loss: 0.3199480
	iters: 100, epoch: 3 | loss: 0.4354575
	speed: 0.0096s/iter; left time: 14.0887s
	iters: 200, epoch: 3 | loss: 0.3850846
	speed: 0.0044s/iter; left time: 6.0037s
Updating learning rate to 0.003204390480020649
Epoch: 3 cost time: 1.200732707977295
Epoch: 3, Steps: 262 | Train Loss: 0.4102710 Vali Loss: 0.3228423 Best vali loss: 0.3199480
	iters: 100, epoch: 4 | loss: 0.9457154
	speed: 0.0098s/iter; left time: 11.8629s
	iters: 200, epoch: 4 | loss: 0.9082992
	speed: 0.0045s/iter; left time: 5.0113s
Updating learning rate to 0.00231751564025
Epoch: 4 cost time: 1.2036802768707275
Epoch: 4, Steps: 262 | Train Loss: 0.9270073 Vali Loss: 0.3220915 Best vali loss: 0.3199480
	iters: 100, epoch: 5 | loss: 0.6695344
	speed: 0.0093s/iter; left time: 8.8278s
	iters: 200, epoch: 5 | loss: 0.4035912
	speed: 0.0040s/iter; left time: 3.4097s
Updating learning rate to 0.0014306408004793516
Epoch: 5 cost time: 1.1172027587890625
Epoch: 5, Steps: 262 | Train Loss: 0.5365628 Vali Loss: 0.3220635 Best vali loss: 0.3199480
	iters: 100, epoch: 6 | loss: 0.5353507
	speed: 0.0094s/iter; left time: 6.4442s
	iters: 200, epoch: 6 | loss: 0.8404078
	speed: 0.0042s/iter; left time: 2.4634s
Updating learning rate to 0.0006787846155233418
Epoch: 6 cost time: 1.1590147018432617
Epoch: 6, Steps: 262 | Train Loss: 0.6878793 Vali Loss: 0.3224012 Best vali loss: 0.3199480
	iters: 100, epoch: 7 | loss: 0.6285198
	speed: 0.0094s/iter; left time: 4.0096s
	iters: 200, epoch: 7 | loss: 0.7559980
	speed: 0.0042s/iter; left time: 1.3729s
Updating learning rate to 0.00017641037394823463
Epoch: 7 cost time: 1.1437726020812988
Epoch: 7, Steps: 262 | Train Loss: 0.6922589 Vali Loss: 0.3222838 Best vali loss: 0.3199480
	iters: 100, epoch: 8 | loss: 0.6371770
	speed: 0.0090s/iter; left time: 1.4714s
	iters: 200, epoch: 8 | loss: 0.6403775
	speed: 0.0043s/iter; left time: 0.2710s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1645081043243408
Epoch: 8, Steps: 262 | Train Loss: 0.6387772 Vali Loss: 0.3222817 Best vali loss: 0.3199480

best validation loss 0.319947969729504

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010265930608, 'e_layers': 2, 'learning_rate': 0.0002346617798, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597135
	speed: 0.0104s/iter; left time: 9.8931s
Updating learning rate to 0.0002346617798
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9225039482116699
Epoch: 1, Steps: 131 | Train Loss: 0.5597135 Vali Loss: 0.2756323 Best vali loss: 0.2756323
	iters: 100, epoch: 2 | loss: 0.3245380
	speed: 0.0090s/iter; left time: 7.3274s
Updating learning rate to 0.0001173308899
Validation loss decreased (0.2756 --> 0.2703).  Saving model state dict ...
Epoch: 2 cost time: 0.704242467880249
Epoch: 2, Steps: 131 | Train Loss: 0.3245380 Vali Loss: 0.2703337 Best vali loss: 0.2703337
	iters: 100, epoch: 3 | loss: 0.4610620
	speed: 0.0090s/iter; left time: 6.1781s
Updating learning rate to 5.866544495e-05
Epoch: 3 cost time: 0.6993827819824219
Epoch: 3, Steps: 131 | Train Loss: 0.4610620 Vali Loss: 0.2782217 Best vali loss: 0.2703337

best validation loss 0.2703336795141547

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.001026040381, 'e_layers': 2, 'learning_rate': 0.000233640005, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7632548
	speed: 0.0089s/iter; left time: 36.4869s
	iters: 200, epoch: 1 | loss: 0.4922024
	speed: 0.0035s/iter; left time: 14.0270s
	iters: 300, epoch: 1 | loss: 0.7014032
	speed: 0.0035s/iter; left time: 13.7501s
	iters: 400, epoch: 1 | loss: 0.6672524
	speed: 0.0035s/iter; left time: 13.2324s
	iters: 500, epoch: 1 | loss: 0.4320658
	speed: 0.0035s/iter; left time: 12.8167s
Updating learning rate to 0.000233640005
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 2.1018319129943848
Epoch: 1, Steps: 523 | Train Loss: 0.6112357 Vali Loss: 0.2850000 Best vali loss: 0.2850000
	iters: 100, epoch: 2 | loss: 0.3470962
	speed: 0.0076s/iter; left time: 26.9220s
	iters: 200, epoch: 2 | loss: 0.6128694
	speed: 0.0033s/iter; left time: 11.3653s
	iters: 300, epoch: 2 | loss: 0.2711309
	speed: 0.0034s/iter; left time: 11.5588s
	iters: 400, epoch: 2 | loss: 0.3545718
	speed: 0.0036s/iter; left time: 11.6599s
	iters: 500, epoch: 2 | loss: 0.4555629
	speed: 0.0035s/iter; left time: 11.2227s
Updating learning rate to 0.0001168200025
Validation loss decreased (0.2850 --> 0.2759).  Saving model state dict ...
Epoch: 2 cost time: 1.8377294540405273
Epoch: 2, Steps: 523 | Train Loss: 0.4082462 Vali Loss: 0.2758784 Best vali loss: 0.2758784
	iters: 100, epoch: 3 | loss: 0.4205113
	speed: 0.0081s/iter; left time: 24.5576s
	iters: 200, epoch: 3 | loss: 0.2717029
	speed: 0.0035s/iter; left time: 10.3280s
	iters: 300, epoch: 3 | loss: 0.2152498
	speed: 0.0035s/iter; left time: 10.0204s
	iters: 400, epoch: 3 | loss: 0.6173239
	speed: 0.0035s/iter; left time: 9.5851s
	iters: 500, epoch: 3 | loss: 0.3799726
	speed: 0.0035s/iter; left time: 9.2509s
Updating learning rate to 5.841000125e-05
Epoch: 3 cost time: 1.8737668991088867
Epoch: 3, Steps: 523 | Train Loss: 0.3809521 Vali Loss: 0.2842559 Best vali loss: 0.2758784

best validation loss 0.27587840846587663

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070937849963, 'e_layers': 1, 'learning_rate': 7.51775533e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4539378
	speed: 0.0082s/iter; left time: 7.8233s
Updating learning rate to 7.231627804907318e-05
Validation loss decreased (inf --> 0.3313).  Saving model state dict ...
Epoch: 1 cost time: 0.65018630027771
Epoch: 1, Steps: 131 | Train Loss: 0.4539378 Vali Loss: 0.3313225 Best vali loss: 0.3313225
	iters: 100, epoch: 2 | loss: 0.5392336
	speed: 0.0054s/iter; left time: 4.4047s
Updating learning rate to 6.416805551572156e-05
Validation loss decreased (0.3313 --> 0.3121).  Saving model state dict ...
Epoch: 2 cost time: 0.40261173248291016
Epoch: 2, Steps: 131 | Train Loss: 0.5392336 Vali Loss: 0.3120993 Best vali loss: 0.3120993
	iters: 100, epoch: 3 | loss: 0.4099282
	speed: 0.0052s/iter; left time: 3.5405s
Updating learning rate to 5.1973378716826744e-05
Validation loss decreased (0.3121 --> 0.3020).  Saving model state dict ...
Epoch: 3 cost time: 0.39070820808410645
Epoch: 3, Steps: 131 | Train Loss: 0.4099282 Vali Loss: 0.3019661 Best vali loss: 0.3019661

best validation loss 0.3019660847166649

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010265930608, 'e_layers': 2, 'learning_rate': 0.0002346617798, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4226385
	speed: 0.0108s/iter; left time: 6.0273s
Updating learning rate to 2.9332722475e-05
Epoch: 4 cost time: 0.9404118061065674
Epoch: 4, Steps: 131 | Train Loss: 0.4226385 Vali Loss: 0.3117105 Best vali loss: 0.2703337
	iters: 100, epoch: 5 | loss: 0.2838241
	speed: 0.0087s/iter; left time: 3.6799s
Updating learning rate to 1.46663612375e-05
Epoch: 5 cost time: 0.6981070041656494
Epoch: 5, Steps: 131 | Train Loss: 0.2838241 Vali Loss: 0.2973910 Best vali loss: 0.2703337
	iters: 100, epoch: 6 | loss: 0.4347120
	speed: 0.0087s/iter; left time: 2.5536s
Updating learning rate to 7.33318061875e-06
Epoch: 6 cost time: 0.7006468772888184
Epoch: 6, Steps: 131 | Train Loss: 0.4347120 Vali Loss: 0.2993212 Best vali loss: 0.2703337
	iters: 100, epoch: 7 | loss: 0.4663503
	speed: 0.0086s/iter; left time: 1.3975s
Updating learning rate to 3.666590309375e-06
Epoch: 7 cost time: 0.6947071552276611
Epoch: 7, Steps: 131 | Train Loss: 0.4663503 Vali Loss: 0.2980610 Best vali loss: 0.2703337
	iters: 100, epoch: 8 | loss: 0.3281195
	speed: 0.0087s/iter; left time: 0.2772s
Updating learning rate to 1.8332951546875e-06
Epoch: 8 cost time: 0.7049109935760498
Epoch: 8, Steps: 131 | Train Loss: 0.3281195 Vali Loss: 0.2950081 Best vali loss: 0.2703337

best validation loss 0.2703336795141547

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597166
	speed: 0.0103s/iter; left time: 9.7632s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9285564422607422
Epoch: 1, Steps: 131 | Train Loss: 0.5597166 Vali Loss: 0.2756341 Best vali loss: 0.2756341
	iters: 100, epoch: 2 | loss: 0.3232366
	speed: 0.0088s/iter; left time: 7.2371s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2689).  Saving model state dict ...
Epoch: 2 cost time: 0.7045063972473145
Epoch: 2, Steps: 131 | Train Loss: 0.3232366 Vali Loss: 0.2688688 Best vali loss: 0.2688688
	iters: 100, epoch: 3 | loss: 0.4644936
	speed: 0.0090s/iter; left time: 6.2030s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7029633522033691
Epoch: 3, Steps: 131 | Train Loss: 0.4644936 Vali Loss: 0.2769200 Best vali loss: 0.2688688
	iters: 100, epoch: 4 | loss: 0.4832223
	speed: 0.0086s/iter; left time: 4.7562s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.6927878856658936
Epoch: 4, Steps: 131 | Train Loss: 0.4832223 Vali Loss: 0.2756395 Best vali loss: 0.2688688
	iters: 100, epoch: 5 | loss: 0.3339452
	speed: 0.0086s/iter; left time: 3.6408s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.6974005699157715
Epoch: 5, Steps: 131 | Train Loss: 0.3339452 Vali Loss: 0.2836954 Best vali loss: 0.2688688
	iters: 100, epoch: 6 | loss: 0.3059524
	speed: 0.0087s/iter; left time: 2.5549s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7025563716888428
Epoch: 6, Steps: 131 | Train Loss: 0.3059524 Vali Loss: 0.2889816 Best vali loss: 0.2688688
	iters: 100, epoch: 7 | loss: 0.2868344
	speed: 0.0086s/iter; left time: 1.3988s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.6978027820587158
Epoch: 7, Steps: 131 | Train Loss: 0.2868344 Vali Loss: 0.2920583 Best vali loss: 0.2688688
	iters: 100, epoch: 8 | loss: 0.3413995
	speed: 0.0086s/iter; left time: 0.2763s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7049458026885986
Epoch: 8, Steps: 131 | Train Loss: 0.3413995 Vali Loss: 0.2946366 Best vali loss: 0.2688688

best validation loss 0.2688687865332451

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597192
	speed: 0.0102s/iter; left time: 9.7192s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9271137714385986
Epoch: 1, Steps: 131 | Train Loss: 0.5597192 Vali Loss: 0.2756283 Best vali loss: 0.2756283
	iters: 100, epoch: 2 | loss: 0.3248189
	speed: 0.0089s/iter; left time: 7.2850s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.6982433795928955
Epoch: 2, Steps: 131 | Train Loss: 0.3248189 Vali Loss: 0.2690257 Best vali loss: 0.2690257
	iters: 100, epoch: 3 | loss: 0.4634705
	speed: 0.0090s/iter; left time: 6.1998s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7019429206848145
Epoch: 3, Steps: 131 | Train Loss: 0.4634705 Vali Loss: 0.2871046 Best vali loss: 0.2690257
	iters: 100, epoch: 4 | loss: 0.5005210
	speed: 0.0087s/iter; left time: 4.8195s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.7038545608520508
Epoch: 4, Steps: 131 | Train Loss: 0.5005210 Vali Loss: 0.2762958 Best vali loss: 0.2690257
	iters: 100, epoch: 5 | loss: 0.3354051
	speed: 0.0086s/iter; left time: 3.6362s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.6985151767730713
Epoch: 5, Steps: 131 | Train Loss: 0.3354051 Vali Loss: 0.2880938 Best vali loss: 0.2690257
	iters: 100, epoch: 6 | loss: 0.3037331
	speed: 0.0086s/iter; left time: 2.5331s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.6968936920166016
Epoch: 6, Steps: 131 | Train Loss: 0.3037331 Vali Loss: 0.2929939 Best vali loss: 0.2690257
	iters: 100, epoch: 7 | loss: 0.2867334
	speed: 0.0087s/iter; left time: 1.4183s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.7005922794342041
Epoch: 7, Steps: 131 | Train Loss: 0.2867334 Vali Loss: 0.2979438 Best vali loss: 0.2690257
	iters: 100, epoch: 8 | loss: 0.3451170
	speed: 0.0086s/iter; left time: 0.2757s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6986813545227051
Epoch: 8, Steps: 131 | Train Loss: 0.3451170 Vali Loss: 0.2980592 Best vali loss: 0.2690257

best validation loss 0.26902565425459274

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 1, 'learning_rate': 0.0002344859158, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4849069
	speed: 0.0080s/iter; left time: 7.6285s
Updating learning rate to 0.00022556132703489248
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6356525421142578
Epoch: 1, Steps: 131 | Train Loss: 0.4849069 Vali Loss: 0.2780645 Best vali loss: 0.2780645
	iters: 100, epoch: 2 | loss: 0.2558646
	speed: 0.0056s/iter; left time: 4.6142s
Updating learning rate to 0.0002001462484774589
Validation loss decreased (0.2781 --> 0.2768).  Saving model state dict ...
Epoch: 2 cost time: 0.4194660186767578
Epoch: 2, Steps: 131 | Train Loss: 0.2558646 Vali Loss: 0.2767614 Best vali loss: 0.2767614
	iters: 100, epoch: 3 | loss: 0.5228749
	speed: 0.0058s/iter; left time: 3.9995s
Updating learning rate to 0.00016210989544980772
Epoch: 3 cost time: 0.416262149810791
Epoch: 3, Steps: 131 | Train Loss: 0.5228749 Vali Loss: 0.2810369 Best vali loss: 0.2767614

best validation loss 0.2767614069349396

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269601004, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597162
	speed: 0.0104s/iter; left time: 9.8447s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9247157573699951
Epoch: 1, Steps: 131 | Train Loss: 0.5597162 Vali Loss: 0.2756355 Best vali loss: 0.2756355
	iters: 100, epoch: 2 | loss: 0.3242892
	speed: 0.0088s/iter; left time: 7.1934s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2756 --> 0.2703).  Saving model state dict ...
Epoch: 2 cost time: 0.6945858001708984
Epoch: 2, Steps: 131 | Train Loss: 0.3242892 Vali Loss: 0.2702823 Best vali loss: 0.2702823
	iters: 100, epoch: 3 | loss: 0.4609796
	speed: 0.0089s/iter; left time: 6.1399s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.7005231380462646
Epoch: 3, Steps: 131 | Train Loss: 0.4609796 Vali Loss: 0.2763853 Best vali loss: 0.2702823

best validation loss 0.27028233712825156

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0018682829331, 'e_layers': 2, 'learning_rate': 0.0025289717944, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7757419
	speed: 0.0091s/iter; left time: 8.6831s
Updating learning rate to 0.0024327185367722507
Validation loss decreased (inf --> 0.3030).  Saving model state dict ...
Epoch: 1 cost time: 0.7629220485687256
Epoch: 1, Steps: 131 | Train Loss: 0.7757419 Vali Loss: 0.3030474 Best vali loss: 0.3030474
	iters: 100, epoch: 2 | loss: 0.7267430
	speed: 0.0067s/iter; left time: 5.4557s
Updating learning rate to 0.0021586124498248756
Validation loss decreased (0.3030 --> 0.2949).  Saving model state dict ...
Epoch: 2 cost time: 0.5405035018920898
Epoch: 2, Steps: 131 | Train Loss: 0.7267430 Vali Loss: 0.2948667 Best vali loss: 0.2948667
	iters: 100, epoch: 3 | loss: 0.4971521
	speed: 0.0067s/iter; left time: 4.6199s
Updating learning rate to 0.001748383700517746
Validation loss decreased (0.2949 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 0.5291922092437744
Epoch: 3, Steps: 131 | Train Loss: 0.4971521 Vali Loss: 0.2905670 Best vali loss: 0.2905670

best validation loss 0.2905670398892679

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269601004, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4117683
	speed: 0.0105s/iter; left time: 5.8573s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 0.9259359836578369
Epoch: 4, Steps: 131 | Train Loss: 0.4117683 Vali Loss: 0.2911807 Best vali loss: 0.2702823
	iters: 100, epoch: 5 | loss: 0.2685193
	speed: 0.0087s/iter; left time: 3.6926s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.6954636573791504
Epoch: 5, Steps: 131 | Train Loss: 0.2685193 Vali Loss: 0.2927127 Best vali loss: 0.2702823
	iters: 100, epoch: 6 | loss: 0.3799224
	speed: 0.0086s/iter; left time: 2.5291s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.6983535289764404
Epoch: 6, Steps: 131 | Train Loss: 0.3799224 Vali Loss: 0.2969701 Best vali loss: 0.2702823
	iters: 100, epoch: 7 | loss: 0.3986507
	speed: 0.0086s/iter; left time: 1.3967s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 0.6967227458953857
Epoch: 7, Steps: 131 | Train Loss: 0.3986507 Vali Loss: 0.3062533 Best vali loss: 0.2702823
	iters: 100, epoch: 8 | loss: 0.2949185
	speed: 0.0087s/iter; left time: 0.2787s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7093603610992432
Epoch: 8, Steps: 131 | Train Loss: 0.2949185 Vali Loss: 0.3052570 Best vali loss: 0.2702823

best validation loss 0.27028233712825156

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010259426762, 'e_layers': 1, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4849091
	speed: 0.0084s/iter; left time: 7.9624s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.662804365158081
Epoch: 1, Steps: 131 | Train Loss: 0.4849091 Vali Loss: 0.2780609 Best vali loss: 0.2780609
	iters: 100, epoch: 2 | loss: 0.2556424
	speed: 0.0057s/iter; left time: 4.6706s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2781 --> 0.2767).  Saving model state dict ...
Epoch: 2 cost time: 0.41167593002319336
Epoch: 2, Steps: 131 | Train Loss: 0.2556424 Vali Loss: 0.2766760 Best vali loss: 0.2766760
	iters: 100, epoch: 3 | loss: 0.5217844
	speed: 0.0056s/iter; left time: 3.8559s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.4130825996398926
Epoch: 3, Steps: 131 | Train Loss: 0.5217844 Vali Loss: 0.2811222 Best vali loss: 0.2766760
	iters: 100, epoch: 4 | loss: 0.6419015
	speed: 0.0055s/iter; left time: 3.0836s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 0.4152712821960449
Epoch: 4, Steps: 131 | Train Loss: 0.6419015 Vali Loss: 0.2878797 Best vali loss: 0.2766760
	iters: 100, epoch: 5 | loss: 0.3447931
	speed: 0.0055s/iter; left time: 2.3231s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.4086785316467285
Epoch: 5, Steps: 131 | Train Loss: 0.3447931 Vali Loss: 0.2960250 Best vali loss: 0.2766760
	iters: 100, epoch: 6 | loss: 0.3684255
	speed: 0.0054s/iter; left time: 1.5881s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.40672969818115234
Epoch: 6, Steps: 131 | Train Loss: 0.3684255 Vali Loss: 0.2937795 Best vali loss: 0.2766760
	iters: 100, epoch: 7 | loss: 0.4467263
	speed: 0.0056s/iter; left time: 0.9121s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 0.4281444549560547
Epoch: 7, Steps: 131 | Train Loss: 0.4467263 Vali Loss: 0.2920176 Best vali loss: 0.2766760
	iters: 100, epoch: 8 | loss: 0.4221492
	speed: 0.0055s/iter; left time: 0.1760s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.41269659996032715
Epoch: 8, Steps: 131 | Train Loss: 0.4221492 Vali Loss: 0.2925246 Best vali loss: 0.2766760

best validation loss 0.27667601872616515

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010262185717, 'e_layers': 1, 'learning_rate': 0.0002346474545, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4849083
	speed: 0.0082s/iter; left time: 7.7381s
Updating learning rate to 0.0002257167175342117
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6471028327941895
Epoch: 1, Steps: 131 | Train Loss: 0.4849083 Vali Loss: 0.2780619 Best vali loss: 0.2780619
	iters: 100, epoch: 2 | loss: 0.2558264
	speed: 0.0056s/iter; left time: 4.5909s
Updating learning rate to 0.00020028413038255592
Validation loss decreased (0.2781 --> 0.2767).  Saving model state dict ...
Epoch: 2 cost time: 0.419231653213501
Epoch: 2, Steps: 131 | Train Loss: 0.2558264 Vali Loss: 0.2767200 Best vali loss: 0.2767200
	iters: 100, epoch: 3 | loss: 0.5223033
	speed: 0.0057s/iter; left time: 3.8907s
Updating learning rate to 0.0001622215738918956
Epoch: 3 cost time: 0.41657114028930664
Epoch: 3, Steps: 131 | Train Loss: 0.5223033 Vali Loss: 0.2810337 Best vali loss: 0.2767200
	iters: 100, epoch: 4 | loss: 0.6362258
	speed: 0.0055s/iter; left time: 3.0310s
Updating learning rate to 0.00011732372725
Epoch: 4 cost time: 0.41465115547180176
Epoch: 4, Steps: 131 | Train Loss: 0.6362258 Vali Loss: 0.2889355 Best vali loss: 0.2767200
	iters: 100, epoch: 5 | loss: 0.3431349
	speed: 0.0055s/iter; left time: 2.3502s
Updating learning rate to 7.242588060810439e-05
Epoch: 5 cost time: 0.4148681163787842
Epoch: 5, Steps: 131 | Train Loss: 0.3431349 Vali Loss: 0.2981003 Best vali loss: 0.2767200
	iters: 100, epoch: 6 | loss: 0.3700722
	speed: 0.0056s/iter; left time: 1.6498s
Updating learning rate to 3.4363324117444075e-05
Epoch: 6 cost time: 0.4373762607574463
Epoch: 6, Steps: 131 | Train Loss: 0.3700722 Vali Loss: 0.2930919 Best vali loss: 0.2767200
	iters: 100, epoch: 7 | loss: 0.4491543
	speed: 0.0056s/iter; left time: 0.9129s
Updating learning rate to 8.930736965788287e-06
Epoch: 7 cost time: 0.42220449447631836
Epoch: 7, Steps: 131 | Train Loss: 0.4491543 Vali Loss: 0.2917683 Best vali loss: 0.2767200
	iters: 100, epoch: 8 | loss: 0.4211239
	speed: 0.0055s/iter; left time: 0.1761s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4084603786468506
Epoch: 8, Steps: 131 | Train Loss: 0.4211239 Vali Loss: 0.2922056 Best vali loss: 0.2767200

best validation loss 0.2767199523256542

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009536165701, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596263
	speed: 0.0104s/iter; left time: 9.8744s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.926708459854126
Epoch: 1, Steps: 131 | Train Loss: 0.5596263 Vali Loss: 0.2756710 Best vali loss: 0.2756710
	iters: 100, epoch: 2 | loss: 0.3227650
	speed: 0.0088s/iter; left time: 7.2306s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2688).  Saving model state dict ...
Epoch: 2 cost time: 0.7043507099151611
Epoch: 2, Steps: 131 | Train Loss: 0.3227650 Vali Loss: 0.2687642 Best vali loss: 0.2687642
	iters: 100, epoch: 3 | loss: 0.4614899
	speed: 0.0090s/iter; left time: 6.2099s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7085883617401123
Epoch: 3, Steps: 131 | Train Loss: 0.4614899 Vali Loss: 0.2796892 Best vali loss: 0.2687642

best validation loss 0.26876417339934255

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008480770413, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596274
	speed: 0.0105s/iter; left time: 9.9415s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9351027011871338
Epoch: 1, Steps: 131 | Train Loss: 0.5596274 Vali Loss: 0.2756259 Best vali loss: 0.2756259
	iters: 100, epoch: 2 | loss: 0.3226973
	speed: 0.0089s/iter; left time: 7.3060s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2717).  Saving model state dict ...
Epoch: 2 cost time: 0.7074198722839355
Epoch: 2, Steps: 131 | Train Loss: 0.3226973 Vali Loss: 0.2716544 Best vali loss: 0.2716544
	iters: 100, epoch: 3 | loss: 0.4616745
	speed: 0.0090s/iter; left time: 6.1853s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7026124000549316
Epoch: 3, Steps: 131 | Train Loss: 0.4616745 Vali Loss: 0.2768184 Best vali loss: 0.2716544

best validation loss 0.2716543711264721

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.000863609928, 'e_layers': 4, 'learning_rate': 0.0020527463126, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5684955
	speed: 0.0104s/iter; left time: 42.4502s
	iters: 200, epoch: 1 | loss: 0.5660229
	speed: 0.0052s/iter; left time: 20.8038s
	iters: 300, epoch: 1 | loss: 0.3706087
	speed: 0.0053s/iter; left time: 20.4237s
	iters: 400, epoch: 1 | loss: 0.5392973
	speed: 0.0052s/iter; left time: 19.6859s
	iters: 500, epoch: 1 | loss: 1.0163645
	speed: 0.0052s/iter; left time: 19.2692s
Updating learning rate to 0.001974618308124578
Validation loss decreased (inf --> 0.3242).  Saving model state dict ...
Epoch: 1 cost time: 2.990238666534424
Epoch: 1, Steps: 523 | Train Loss: 0.6121578 Vali Loss: 0.3241575 Best vali loss: 0.3241575
	iters: 100, epoch: 2 | loss: 0.3227092
	speed: 0.0104s/iter; left time: 36.9721s
	iters: 200, epoch: 2 | loss: 0.3673038
	speed: 0.0052s/iter; left time: 18.1477s
	iters: 300, epoch: 2 | loss: 0.2264334
	speed: 0.0053s/iter; left time: 17.7247s
	iters: 400, epoch: 2 | loss: 0.5739315
	speed: 0.0052s/iter; left time: 17.0973s
	iters: 500, epoch: 2 | loss: 1.0340350
	speed: 0.0052s/iter; left time: 16.4954s
Updating learning rate to 0.0017521285751475701
Validation loss decreased (0.3242 --> 0.3210).  Saving model state dict ...
Epoch: 2 cost time: 2.7687830924987793
Epoch: 2, Steps: 523 | Train Loss: 0.5048826 Vali Loss: 0.3210499 Best vali loss: 0.3210499
	iters: 100, epoch: 3 | loss: 0.3425153
	speed: 0.0102s/iter; left time: 30.9176s
	iters: 200, epoch: 3 | loss: 0.5566902
	speed: 0.0050s/iter; left time: 14.5601s
	iters: 300, epoch: 3 | loss: 0.2851318
	speed: 0.0050s/iter; left time: 14.1164s
	iters: 400, epoch: 3 | loss: 0.5029275
	speed: 0.0050s/iter; left time: 13.6427s
	iters: 500, epoch: 3 | loss: 0.7271436
	speed: 0.0050s/iter; left time: 13.1334s
Updating learning rate to 0.0014191491586402747
Epoch: 3 cost time: 2.6234190464019775
Epoch: 3, Steps: 523 | Train Loss: 0.4828817 Vali Loss: 0.3229108 Best vali loss: 0.3210499

best validation loss 0.32104991462293636

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009536165701, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4240190
	speed: 0.0109s/iter; left time: 6.0530s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.945399284362793
Epoch: 4, Steps: 131 | Train Loss: 0.4240190 Vali Loss: 0.3102078 Best vali loss: 0.2687642
	iters: 100, epoch: 5 | loss: 0.2812630
	speed: 0.0087s/iter; left time: 3.6952s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.696455717086792
Epoch: 5, Steps: 131 | Train Loss: 0.2812630 Vali Loss: 0.2940535 Best vali loss: 0.2687642
	iters: 100, epoch: 6 | loss: 0.4350465
	speed: 0.0087s/iter; left time: 2.5561s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7055370807647705
Epoch: 6, Steps: 131 | Train Loss: 0.4350465 Vali Loss: 0.3013219 Best vali loss: 0.2687642
	iters: 100, epoch: 7 | loss: 0.4651936
	speed: 0.0086s/iter; left time: 1.4091s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6968975067138672
Epoch: 7, Steps: 131 | Train Loss: 0.4651936 Vali Loss: 0.2961168 Best vali loss: 0.2687642
	iters: 100, epoch: 8 | loss: 0.3300714
	speed: 0.0086s/iter; left time: 0.2754s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6993837356567383
Epoch: 8, Steps: 131 | Train Loss: 0.3300714 Vali Loss: 0.2951748 Best vali loss: 0.2687642

best validation loss 0.26876417339934255

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012371274314, 'e_layers': 1, 'learning_rate': 0.0002034425323, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5344614
	speed: 0.0081s/iter; left time: 7.6435s
Updating learning rate to 0.00019569946196711818
Validation loss decreased (inf --> 0.3188).  Saving model state dict ...
Epoch: 1 cost time: 0.6286652088165283
Epoch: 1, Steps: 131 | Train Loss: 0.5344614 Vali Loss: 0.3187847 Best vali loss: 0.3187847
	iters: 100, epoch: 2 | loss: 0.5151717
	speed: 0.0054s/iter; left time: 4.4215s
Updating learning rate to 0.0001736490632355466
Validation loss decreased (0.3188 --> 0.3005).  Saving model state dict ...
Epoch: 2 cost time: 0.3954596519470215
Epoch: 2, Steps: 131 | Train Loss: 0.5151717 Vali Loss: 0.3004801 Best vali loss: 0.3004801
	iters: 100, epoch: 3 | loss: 0.4593382
	speed: 0.0051s/iter; left time: 3.4822s
Updating learning rate to 0.00014064830942480482
Validation loss decreased (0.3005 --> 0.2922).  Saving model state dict ...
Epoch: 3 cost time: 0.38579344749450684
Epoch: 3, Steps: 131 | Train Loss: 0.4593382 Vali Loss: 0.2921846 Best vali loss: 0.2921846
	iters: 100, epoch: 4 | loss: 0.5172718
	speed: 0.0055s/iter; left time: 3.0358s
Updating learning rate to 0.00010172126615
Validation loss decreased (0.2922 --> 0.2879).  Saving model state dict ...
Epoch: 4 cost time: 0.4270145893096924
Epoch: 4, Steps: 131 | Train Loss: 0.5172718 Vali Loss: 0.2879408 Best vali loss: 0.2879408
	iters: 100, epoch: 5 | loss: 0.5584429
	speed: 0.0057s/iter; left time: 2.4163s
Updating learning rate to 6.279422287519518e-05
Validation loss decreased (0.2879 --> 0.2861).  Saving model state dict ...
Epoch: 5 cost time: 0.4424459934234619
Epoch: 5, Steps: 131 | Train Loss: 0.5584429 Vali Loss: 0.2861158 Best vali loss: 0.2861158
	iters: 100, epoch: 6 | loss: 0.5898550
	speed: 0.0055s/iter; left time: 1.6287s
Updating learning rate to 2.9793469064453394e-05
Validation loss decreased (0.2861 --> 0.2859).  Saving model state dict ...
Epoch: 6 cost time: 0.4263763427734375
Epoch: 6, Steps: 131 | Train Loss: 0.5898550 Vali Loss: 0.2858660 Best vali loss: 0.2858660
	iters: 100, epoch: 7 | loss: 0.5533914
	speed: 0.0051s/iter; left time: 0.8318s
Updating learning rate to 7.743070332881824e-06
Validation loss decreased (0.2859 --> 0.2855).  Saving model state dict ...
Epoch: 7 cost time: 0.38408780097961426
Epoch: 7, Steps: 131 | Train Loss: 0.5533914 Vali Loss: 0.2854875 Best vali loss: 0.2854875
	iters: 100, epoch: 8 | loss: 0.4826561
	speed: 0.0053s/iter; left time: 0.1690s
Updating learning rate to 0.0
Validation loss decreased (0.2855 --> 0.2853).  Saving model state dict ...
Epoch: 8 cost time: 0.4011516571044922
Epoch: 8, Steps: 131 | Train Loss: 0.4826561 Vali Loss: 0.2853485 Best vali loss: 0.2853485

best validation loss 0.2853484752176862

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010257344629, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597171
	speed: 0.0104s/iter; left time: 9.9028s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9270052909851074
Epoch: 1, Steps: 131 | Train Loss: 0.5597171 Vali Loss: 0.2756364 Best vali loss: 0.2756364
	iters: 100, epoch: 2 | loss: 0.3261423
	speed: 0.0089s/iter; left time: 7.2672s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2756 --> 0.2700).  Saving model state dict ...
Epoch: 2 cost time: 0.7038421630859375
Epoch: 2, Steps: 131 | Train Loss: 0.3261423 Vali Loss: 0.2700445 Best vali loss: 0.2700445
	iters: 100, epoch: 3 | loss: 0.4657823
	speed: 0.0091s/iter; left time: 6.2486s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.7037627696990967
Epoch: 3, Steps: 131 | Train Loss: 0.4657823 Vali Loss: 0.2783960 Best vali loss: 0.2700445
	iters: 100, epoch: 4 | loss: 0.5074027
	speed: 0.0086s/iter; left time: 4.7784s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.6957376003265381
Epoch: 4, Steps: 131 | Train Loss: 0.5074027 Vali Loss: 0.2867852 Best vali loss: 0.2700445
	iters: 100, epoch: 5 | loss: 0.3330239
	speed: 0.0087s/iter; left time: 3.6826s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.7037179470062256
Epoch: 5, Steps: 131 | Train Loss: 0.3330239 Vali Loss: 0.2841017 Best vali loss: 0.2700445
	iters: 100, epoch: 6 | loss: 0.3185013
	speed: 0.0087s/iter; left time: 2.5522s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.6973671913146973
Epoch: 6, Steps: 131 | Train Loss: 0.3185013 Vali Loss: 0.2845546 Best vali loss: 0.2700445
	iters: 100, epoch: 7 | loss: 0.3092869
	speed: 0.0087s/iter; left time: 1.4203s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.6989452838897705
Epoch: 7, Steps: 131 | Train Loss: 0.3092869 Vali Loss: 0.2899379 Best vali loss: 0.2700445
	iters: 100, epoch: 8 | loss: 0.3967577
	speed: 0.0087s/iter; left time: 0.2781s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.7067697048187256
Epoch: 8, Steps: 131 | Train Loss: 0.3967577 Vali Loss: 0.2911379 Best vali loss: 0.2700445

best validation loss 0.27004446430071527

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010201303465, 'e_layers': 2, 'learning_rate': 0.0002344652356, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6368848
	speed: 0.0105s/iter; left time: 9.9597s
Updating learning rate to 0.00022554143392813838
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 0.9304947853088379
Epoch: 1, Steps: 131 | Train Loss: 0.6368848 Vali Loss: 0.2799602 Best vali loss: 0.2799602
	iters: 100, epoch: 2 | loss: 0.3916931
	speed: 0.0089s/iter; left time: 7.2802s
Updating learning rate to 0.00020012859682263075
Epoch: 2 cost time: 0.7079346179962158
Epoch: 2, Steps: 131 | Train Loss: 0.3916931 Vali Loss: 0.2812272 Best vali loss: 0.2799602
	iters: 100, epoch: 3 | loss: 0.7728682
	speed: 0.0087s/iter; left time: 5.9991s
Updating learning rate to 0.00016209559836484873
Epoch: 3 cost time: 0.703402042388916
Epoch: 3, Steps: 131 | Train Loss: 0.7728682 Vali Loss: 0.2888607 Best vali loss: 0.2799602

best validation loss 0.2799602212095491

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0012228413212, 'e_layers': 3, 'learning_rate': 0.0003253069217, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00031292566422144085
Validation loss decreased (inf --> 0.2808).  Saving model state dict ...
Epoch: 1 cost time: 0.6783969402313232
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2807812 Best vali loss: 0.2807812
Updating learning rate to 0.00027766682600049563
Validation loss decreased (0.2808 --> 0.2774).  Saving model state dict ...
Epoch: 2 cost time: 0.4580087661743164
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2774389 Best vali loss: 0.2774389
Updating learning rate to 0.00022489824553413877
Epoch: 3 cost time: 0.46048808097839355
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2834918 Best vali loss: 0.2774389

best validation loss 0.27743889795399457

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002472662168, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5612199
	speed: 0.0102s/iter; left time: 9.7169s
Updating learning rate to 0.0002472662168
Validation loss decreased (inf --> 0.2759).  Saving model state dict ...
Epoch: 1 cost time: 0.9136009216308594
Epoch: 1, Steps: 131 | Train Loss: 0.5612199 Vali Loss: 0.2758512 Best vali loss: 0.2758512
	iters: 100, epoch: 2 | loss: 0.3251994
	speed: 0.0089s/iter; left time: 7.2457s
Updating learning rate to 0.0001236331084
Epoch: 2 cost time: 0.6960554122924805
Epoch: 2, Steps: 131 | Train Loss: 0.3251994 Vali Loss: 0.2790499 Best vali loss: 0.2758512
	iters: 100, epoch: 3 | loss: 0.4625784
	speed: 0.0087s/iter; left time: 5.9600s
Updating learning rate to 6.18165542e-05
Epoch: 3 cost time: 0.7079513072967529
Epoch: 3, Steps: 131 | Train Loss: 0.4625784 Vali Loss: 0.2814677 Best vali loss: 0.2758512

best validation loss 0.27585124107221104

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002472662168, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4162476
	speed: 0.0108s/iter; left time: 5.9998s
Updating learning rate to 3.09082771e-05
Epoch: 4 cost time: 0.9294159412384033
Epoch: 4, Steps: 131 | Train Loss: 0.4162476 Vali Loss: 0.3007824 Best vali loss: 0.2758512
	iters: 100, epoch: 5 | loss: 0.2807407
	speed: 0.0087s/iter; left time: 3.7089s
Updating learning rate to 1.545413855e-05
Epoch: 5 cost time: 0.7106926441192627
Epoch: 5, Steps: 131 | Train Loss: 0.2807407 Vali Loss: 0.3020211 Best vali loss: 0.2758512
	iters: 100, epoch: 6 | loss: 0.4302928
	speed: 0.0086s/iter; left time: 2.5419s
Updating learning rate to 7.727069275e-06
Epoch: 6 cost time: 0.7003295421600342
Epoch: 6, Steps: 131 | Train Loss: 0.4302928 Vali Loss: 0.3029583 Best vali loss: 0.2758512
	iters: 100, epoch: 7 | loss: 0.4625472
	speed: 0.0086s/iter; left time: 1.4082s
Updating learning rate to 3.8635346375e-06
Epoch: 7 cost time: 0.6995832920074463
Epoch: 7, Steps: 131 | Train Loss: 0.4625472 Vali Loss: 0.3003693 Best vali loss: 0.2758512
	iters: 100, epoch: 8 | loss: 0.3292681
	speed: 0.0086s/iter; left time: 0.2755s
Updating learning rate to 1.93176731875e-06
Epoch: 8 cost time: 0.7008340358734131
Epoch: 8, Steps: 131 | Train Loss: 0.3292681 Vali Loss: 0.3002164 Best vali loss: 0.2758512

best validation loss 0.27585124107221104

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0017159356462, 'e_layers': 2, 'learning_rate': 0.0019301088022, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2522347
	speed: 0.0084s/iter; left time: 34.4627s
	iters: 200, epoch: 1 | loss: 0.5304207
	speed: 0.0034s/iter; left time: 13.4457s
	iters: 300, epoch: 1 | loss: 0.6299738
	speed: 0.0034s/iter; left time: 13.0311s
	iters: 400, epoch: 1 | loss: 0.4215348
	speed: 0.0033s/iter; left time: 12.6262s
	iters: 500, epoch: 1 | loss: 0.4715028
	speed: 0.0033s/iter; left time: 12.3396s
Updating learning rate to 0.0019301088022
Validation loss decreased (inf --> 0.2950).  Saving model state dict ...
Epoch: 1 cost time: 2.0055439472198486
Epoch: 1, Steps: 523 | Train Loss: 0.4611333 Vali Loss: 0.2950312 Best vali loss: 0.2950312
	iters: 100, epoch: 2 | loss: 0.7266253
	speed: 0.0070s/iter; left time: 25.0096s
	iters: 200, epoch: 2 | loss: 1.0609379
	speed: 0.0033s/iter; left time: 11.4773s
	iters: 300, epoch: 2 | loss: 0.8701621
	speed: 0.0033s/iter; left time: 11.2011s
	iters: 400, epoch: 2 | loss: 0.3931164
	speed: 0.0033s/iter; left time: 10.8248s
	iters: 500, epoch: 2 | loss: 0.6022576
	speed: 0.0033s/iter; left time: 10.4214s
Updating learning rate to 0.0009650544011
Validation loss decreased (0.2950 --> 0.2851).  Saving model state dict ...
Epoch: 2 cost time: 1.7629148960113525
Epoch: 2, Steps: 523 | Train Loss: 0.7306199 Vali Loss: 0.2851386 Best vali loss: 0.2851386
	iters: 100, epoch: 3 | loss: 0.5081106
	speed: 0.0072s/iter; left time: 21.7735s
	iters: 200, epoch: 3 | loss: 0.2993279
	speed: 0.0033s/iter; left time: 9.7898s
	iters: 300, epoch: 3 | loss: 0.4302878
	speed: 0.0033s/iter; left time: 9.4669s
	iters: 400, epoch: 3 | loss: 0.4043292
	speed: 0.0033s/iter; left time: 9.1308s
	iters: 500, epoch: 3 | loss: 0.3986171
	speed: 0.0033s/iter; left time: 8.7892s
Updating learning rate to 0.00048252720055
Epoch: 3 cost time: 1.7801377773284912
Epoch: 3, Steps: 523 | Train Loss: 0.4081345 Vali Loss: 0.2925912 Best vali loss: 0.2851386
	iters: 100, epoch: 4 | loss: 0.2565807
	speed: 0.0067s/iter; left time: 16.8866s
	iters: 200, epoch: 4 | loss: 0.6676998
	speed: 0.0029s/iter; left time: 7.0298s
	iters: 300, epoch: 4 | loss: 0.7021776
	speed: 0.0029s/iter; left time: 6.7162s
	iters: 400, epoch: 4 | loss: 0.3534182
	speed: 0.0029s/iter; left time: 6.5183s
	iters: 500, epoch: 4 | loss: 0.4141102
	speed: 0.0029s/iter; left time: 6.1264s
Updating learning rate to 0.000241263600275
Epoch: 4 cost time: 1.5621418952941895
Epoch: 4, Steps: 523 | Train Loss: 0.4787973 Vali Loss: 0.3028193 Best vali loss: 0.2851386
	iters: 100, epoch: 5 | loss: 0.8052846
	speed: 0.0068s/iter; left time: 13.6214s
	iters: 200, epoch: 5 | loss: 0.2446015
	speed: 0.0029s/iter; left time: 5.5010s
	iters: 300, epoch: 5 | loss: 0.3348113
	speed: 0.0030s/iter; left time: 5.3843s
	iters: 400, epoch: 5 | loss: 0.6650052
	speed: 0.0031s/iter; left time: 5.2804s
	iters: 500, epoch: 5 | loss: 0.3662109
	speed: 0.0031s/iter; left time: 4.9783s
Updating learning rate to 0.0001206318001375
Epoch: 5 cost time: 1.6304383277893066
Epoch: 5, Steps: 523 | Train Loss: 0.4831827 Vali Loss: 0.3022530 Best vali loss: 0.2851386
	iters: 100, epoch: 6 | loss: 0.8804425
	speed: 0.0070s/iter; left time: 10.3140s
	iters: 200, epoch: 6 | loss: 0.6763386
	speed: 0.0032s/iter; left time: 4.3357s
	iters: 300, epoch: 6 | loss: 0.2705931
	speed: 0.0031s/iter; left time: 3.9881s
	iters: 400, epoch: 6 | loss: 0.1937398
	speed: 0.0032s/iter; left time: 3.7071s
	iters: 500, epoch: 6 | loss: 0.4200256
	speed: 0.0032s/iter; left time: 3.3758s
Updating learning rate to 6.031590006875e-05
Epoch: 6 cost time: 1.6892931461334229
Epoch: 6, Steps: 523 | Train Loss: 0.4882279 Vali Loss: 0.3015461 Best vali loss: 0.2851386
	iters: 100, epoch: 7 | loss: 0.2998751
	speed: 0.0069s/iter; left time: 6.5481s
	iters: 200, epoch: 7 | loss: 0.2820105
	speed: 0.0029s/iter; left time: 2.4643s
	iters: 300, epoch: 7 | loss: 0.6411443
	speed: 0.0029s/iter; left time: 2.1686s
	iters: 400, epoch: 7 | loss: 0.2757761
	speed: 0.0029s/iter; left time: 1.8838s
	iters: 500, epoch: 7 | loss: 0.3135156
	speed: 0.0029s/iter; left time: 1.6008s
Updating learning rate to 3.0157950034375e-05
Epoch: 7 cost time: 1.5746147632598877
Epoch: 7, Steps: 523 | Train Loss: 0.3624643 Vali Loss: 0.3015256 Best vali loss: 0.2851386
	iters: 100, epoch: 8 | loss: 0.2106241
	speed: 0.0070s/iter; left time: 2.9859s
	iters: 200, epoch: 8 | loss: 0.2088591
	speed: 0.0032s/iter; left time: 1.0346s
	iters: 300, epoch: 8 | loss: 0.3528488
	speed: 0.0031s/iter; left time: 0.7026s
	iters: 400, epoch: 8 | loss: 0.3045845
	speed: 0.0031s/iter; left time: 0.3794s
	iters: 500, epoch: 8 | loss: 0.3313231
	speed: 0.0030s/iter; left time: 0.0727s
Updating learning rate to 1.50789750171875e-05
Epoch: 8 cost time: 1.6814897060394287
Epoch: 8, Steps: 523 | Train Loss: 0.2816479 Vali Loss: 0.3007296 Best vali loss: 0.2851386

best validation loss 0.28513862405979484

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597166
	speed: 0.0105s/iter; left time: 9.9345s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.936772346496582
Epoch: 1, Steps: 131 | Train Loss: 0.5597166 Vali Loss: 0.2756341 Best vali loss: 0.2756341
	iters: 100, epoch: 2 | loss: 0.3245914
	speed: 0.0089s/iter; left time: 7.2726s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2687).  Saving model state dict ...
Epoch: 2 cost time: 0.703035831451416
Epoch: 2, Steps: 131 | Train Loss: 0.3245914 Vali Loss: 0.2686833 Best vali loss: 0.2686833
	iters: 100, epoch: 3 | loss: 0.4622678
	speed: 0.0089s/iter; left time: 6.1130s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.6991164684295654
Epoch: 3, Steps: 131 | Train Loss: 0.4622678 Vali Loss: 0.2780031 Best vali loss: 0.2686833
	iters: 100, epoch: 4 | loss: 0.5061024
	speed: 0.0086s/iter; left time: 4.7582s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6974413394927979
Epoch: 4, Steps: 131 | Train Loss: 0.5061024 Vali Loss: 0.2862001 Best vali loss: 0.2686833
	iters: 100, epoch: 5 | loss: 0.3352901
	speed: 0.0086s/iter; left time: 3.6554s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6962356567382812
Epoch: 5, Steps: 131 | Train Loss: 0.3352901 Vali Loss: 0.2851954 Best vali loss: 0.2686833
	iters: 100, epoch: 6 | loss: 0.3188750
	speed: 0.0086s/iter; left time: 2.5158s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6952822208404541
Epoch: 6, Steps: 131 | Train Loss: 0.3188750 Vali Loss: 0.2862826 Best vali loss: 0.2686833
	iters: 100, epoch: 7 | loss: 0.3115999
	speed: 0.0087s/iter; left time: 1.4223s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7047450542449951
Epoch: 7, Steps: 131 | Train Loss: 0.3115999 Vali Loss: 0.2899110 Best vali loss: 0.2686833
	iters: 100, epoch: 8 | loss: 0.3971065
	speed: 0.0087s/iter; left time: 0.2777s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7029719352722168
Epoch: 8, Steps: 131 | Train Loss: 0.3971065 Vali Loss: 0.2922031 Best vali loss: 0.2686833

best validation loss 0.26868334387083753

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011239943661, 'e_layers': 2, 'learning_rate': 0.0015763529433, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7038658
	speed: 0.0096s/iter; left time: 9.1335s
Updating learning rate to 0.0015763529433
Validation loss decreased (inf --> 0.3020).  Saving model state dict ...
Epoch: 1 cost time: 0.818472146987915
Epoch: 1, Steps: 131 | Train Loss: 0.7038658 Vali Loss: 0.3020139 Best vali loss: 0.3020139
	iters: 100, epoch: 2 | loss: 0.4179084
	speed: 0.0067s/iter; left time: 5.5214s
Updating learning rate to 0.00078817647165
Validation loss decreased (0.3020 --> 0.2867).  Saving model state dict ...
Epoch: 2 cost time: 0.5123863220214844
Epoch: 2, Steps: 131 | Train Loss: 0.4179084 Vali Loss: 0.2867361 Best vali loss: 0.2867361
	iters: 100, epoch: 3 | loss: 0.5250916
	speed: 0.0066s/iter; left time: 4.5032s
Updating learning rate to 0.000394088235825
Epoch: 3 cost time: 0.5204024314880371
Epoch: 3, Steps: 131 | Train Loss: 0.5250916 Vali Loss: 0.3020067 Best vali loss: 0.2867361

best validation loss 0.2867361039765575

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001007750982, 'e_layers': 3, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4559605
	speed: 0.0125s/iter; left time: 11.8868s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.2229197025299072
Epoch: 1, Steps: 131 | Train Loss: 0.4559605 Vali Loss: 0.2911759 Best vali loss: 0.2911759
	iters: 100, epoch: 2 | loss: 0.4722947
	speed: 0.0123s/iter; left time: 10.0710s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2912 --> 0.2814).  Saving model state dict ...
Epoch: 2 cost time: 1.0038042068481445
Epoch: 2, Steps: 131 | Train Loss: 0.4722947 Vali Loss: 0.2813865 Best vali loss: 0.2813865
	iters: 100, epoch: 3 | loss: 0.4212896
	speed: 0.0125s/iter; left time: 8.5800s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2814 --> 0.2796).  Saving model state dict ...
Epoch: 3 cost time: 1.0095727443695068
Epoch: 3, Steps: 131 | Train Loss: 0.4212896 Vali Loss: 0.2795953 Best vali loss: 0.2795953

best validation loss 0.2795952644743588

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010095384299, 'e_layers': 3, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4559810
	speed: 0.0126s/iter; left time: 11.9837s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.2259600162506104
Epoch: 1, Steps: 131 | Train Loss: 0.4559810 Vali Loss: 0.2911730 Best vali loss: 0.2911730
	iters: 100, epoch: 2 | loss: 0.4702900
	speed: 0.0123s/iter; left time: 10.0697s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2912 --> 0.2795).  Saving model state dict ...
Epoch: 2 cost time: 1.0083751678466797
Epoch: 2, Steps: 131 | Train Loss: 0.4702900 Vali Loss: 0.2794526 Best vali loss: 0.2794526
	iters: 100, epoch: 3 | loss: 0.4220053
	speed: 0.0124s/iter; left time: 8.5526s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.99916672706604
Epoch: 3, Steps: 131 | Train Loss: 0.4220053 Vali Loss: 0.2818014 Best vali loss: 0.2794526

best validation loss 0.2794526339619077

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010095384299, 'e_layers': 3, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3806866
	speed: 0.0132s/iter; left time: 7.3602s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 1.2378756999969482
Epoch: 4, Steps: 131 | Train Loss: 0.3806866 Vali Loss: 0.2799612 Best vali loss: 0.2794526
	iters: 100, epoch: 5 | loss: 0.3704298
	speed: 0.0120s/iter; left time: 5.1108s
Updating learning rate to 1.4657935075e-05
Validation loss decreased (0.2795 --> 0.2790).  Saving model state dict ...
Epoch: 5 cost time: 1.0023865699768066
Epoch: 5, Steps: 131 | Train Loss: 0.3704298 Vali Loss: 0.2790137 Best vali loss: 0.2790137
	iters: 100, epoch: 6 | loss: 0.3356218
	speed: 0.0125s/iter; left time: 3.6604s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.9989914894104004
Epoch: 6, Steps: 131 | Train Loss: 0.3356218 Vali Loss: 0.2817405 Best vali loss: 0.2790137
	iters: 100, epoch: 7 | loss: 0.3593211
	speed: 0.0119s/iter; left time: 1.9317s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.9935081005096436
Epoch: 7, Steps: 131 | Train Loss: 0.3593211 Vali Loss: 0.2808836 Best vali loss: 0.2790137
	iters: 100, epoch: 8 | loss: 0.4512387
	speed: 0.0119s/iter; left time: 0.3821s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.002763271331787
Epoch: 8, Steps: 131 | Train Loss: 0.4512387 Vali Loss: 0.2813947 Best vali loss: 0.2790137

best validation loss 0.2790136836848768

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012955190993, 'e_layers': 2, 'learning_rate': 0.0002059893081, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5738877
	speed: 0.0086s/iter; left time: 17.1849s
	iters: 200, epoch: 1 | loss: 0.6329647
	speed: 0.0031s/iter; left time: 5.9085s
Updating learning rate to 0.0002059893081
Validation loss decreased (inf --> 0.2873).  Saving model state dict ...
Epoch: 1 cost time: 1.0918776988983154
Epoch: 1, Steps: 262 | Train Loss: 0.6034262 Vali Loss: 0.2872587 Best vali loss: 0.2872587
	iters: 100, epoch: 2 | loss: 0.4376252
	speed: 0.0071s/iter; left time: 12.3566s
	iters: 200, epoch: 2 | loss: 0.7766796
	speed: 0.0032s/iter; left time: 5.1815s
Updating learning rate to 0.00010299465405
Validation loss decreased (0.2873 --> 0.2821).  Saving model state dict ...
Epoch: 2 cost time: 0.8608825206756592
Epoch: 2, Steps: 262 | Train Loss: 0.6071524 Vali Loss: 0.2820945 Best vali loss: 0.2820945
	iters: 100, epoch: 3 | loss: 0.4907773
	speed: 0.0077s/iter; left time: 11.2916s
	iters: 200, epoch: 3 | loss: 0.4991258
	speed: 0.0033s/iter; left time: 4.5460s
Updating learning rate to 5.1497327025e-05
Validation loss decreased (0.2821 --> 0.2807).  Saving model state dict ...
Epoch: 3 cost time: 0.9091763496398926
Epoch: 3, Steps: 262 | Train Loss: 0.4949515 Vali Loss: 0.2806702 Best vali loss: 0.2806702
	iters: 100, epoch: 4 | loss: 0.5769568
	speed: 0.0071s/iter; left time: 8.5949s
	iters: 200, epoch: 4 | loss: 0.4559190
	speed: 0.0032s/iter; left time: 3.5522s
Updating learning rate to 2.57486635125e-05
Epoch: 4 cost time: 0.8528842926025391
Epoch: 4, Steps: 262 | Train Loss: 0.5164379 Vali Loss: 0.2806744 Best vali loss: 0.2806702
	iters: 100, epoch: 5 | loss: 0.3375451
	speed: 0.0073s/iter; left time: 6.9224s
	iters: 200, epoch: 5 | loss: 1.0476971
	speed: 0.0031s/iter; left time: 2.6475s
Updating learning rate to 1.287433175625e-05
Validation loss decreased (0.2807 --> 0.2805).  Saving model state dict ...
Epoch: 5 cost time: 0.875530481338501
Epoch: 5, Steps: 262 | Train Loss: 0.6926211 Vali Loss: 0.2804760 Best vali loss: 0.2804760
	iters: 100, epoch: 6 | loss: 0.6215766
	speed: 0.0079s/iter; left time: 5.4529s
	iters: 200, epoch: 6 | loss: 0.7197271
	speed: 0.0036s/iter; left time: 2.0931s
Updating learning rate to 6.437165878125e-06
Epoch: 6 cost time: 0.986668586730957
Epoch: 6, Steps: 262 | Train Loss: 0.6706519 Vali Loss: 0.2804871 Best vali loss: 0.2804760
	iters: 100, epoch: 7 | loss: 0.4131393
	speed: 0.0076s/iter; left time: 3.2282s
	iters: 200, epoch: 7 | loss: 0.5104861
	speed: 0.0031s/iter; left time: 1.0206s
Updating learning rate to 3.2185829390625e-06
Epoch: 7 cost time: 0.869173526763916
Epoch: 7, Steps: 262 | Train Loss: 0.4618127 Vali Loss: 0.2806151 Best vali loss: 0.2804760
	iters: 100, epoch: 8 | loss: 0.3885531
	speed: 0.0071s/iter; left time: 1.1584s
	iters: 200, epoch: 8 | loss: 0.3004723
	speed: 0.0031s/iter; left time: 0.1937s
Updating learning rate to 1.60929146953125e-06
Epoch: 8 cost time: 0.8310141563415527
Epoch: 8, Steps: 262 | Train Loss: 0.3445127 Vali Loss: 0.2806225 Best vali loss: 0.2804760

best validation loss 0.280475971057274

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008096718945, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7634481
	speed: 0.0088s/iter; left time: 35.7996s
	iters: 200, epoch: 1 | loss: 0.4922040
	speed: 0.0035s/iter; left time: 13.9669s
	iters: 300, epoch: 1 | loss: 0.7022431
	speed: 0.0035s/iter; left time: 13.5886s
	iters: 400, epoch: 1 | loss: 0.6720684
	speed: 0.0035s/iter; left time: 13.2911s
	iters: 500, epoch: 1 | loss: 0.4670068
	speed: 0.0035s/iter; left time: 12.9934s
Updating learning rate to 0.00022556132703489248
Validation loss decreased (inf --> 0.2747).  Saving model state dict ...
Epoch: 1 cost time: 2.0932228565216064
Epoch: 1, Steps: 523 | Train Loss: 0.6193941 Vali Loss: 0.2746883 Best vali loss: 0.2746883
	iters: 100, epoch: 2 | loss: 0.3550790
	speed: 0.0077s/iter; left time: 27.2989s
	iters: 200, epoch: 2 | loss: 0.6044696
	speed: 0.0034s/iter; left time: 11.6435s
	iters: 300, epoch: 2 | loss: 0.2630496
	speed: 0.0034s/iter; left time: 11.2680s
	iters: 400, epoch: 2 | loss: 0.3077657
	speed: 0.0033s/iter; left time: 10.9117s
	iters: 500, epoch: 2 | loss: 0.4393439
	speed: 0.0033s/iter; left time: 10.5794s
Updating learning rate to 0.0002001462484774589
Epoch: 2 cost time: 1.7896091938018799
Epoch: 2, Steps: 523 | Train Loss: 0.3939416 Vali Loss: 0.2804668 Best vali loss: 0.2746883
	iters: 100, epoch: 3 | loss: 0.4323466
	speed: 0.0073s/iter; left time: 22.2044s
	iters: 200, epoch: 3 | loss: 0.2883167
	speed: 0.0030s/iter; left time: 8.8474s
	iters: 300, epoch: 3 | loss: 0.2251372
	speed: 0.0030s/iter; left time: 8.5738s
	iters: 400, epoch: 3 | loss: 0.6395475
	speed: 0.0030s/iter; left time: 8.3087s
	iters: 500, epoch: 3 | loss: 0.3926314
	speed: 0.0030s/iter; left time: 7.9315s
Updating learning rate to 0.00016210989544980772
Epoch: 3 cost time: 1.6158075332641602
Epoch: 3, Steps: 523 | Train Loss: 0.3955959 Vali Loss: 0.2911890 Best vali loss: 0.2746883
	iters: 100, epoch: 4 | loss: 0.4650947
	speed: 0.0075s/iter; left time: 18.8414s
	iters: 200, epoch: 4 | loss: 0.4595050
	speed: 0.0035s/iter; left time: 8.4982s
	iters: 300, epoch: 4 | loss: 0.6660132
	speed: 0.0035s/iter; left time: 8.1160s
	iters: 400, epoch: 4 | loss: 0.6965826
	speed: 0.0035s/iter; left time: 7.7789s
	iters: 500, epoch: 4 | loss: 0.3623298
	speed: 0.0035s/iter; left time: 7.4192s
Updating learning rate to 0.0001172429579
Epoch: 4 cost time: 1.8639168739318848
Epoch: 4, Steps: 523 | Train Loss: 0.5299051 Vali Loss: 0.2922100 Best vali loss: 0.2746883
	iters: 100, epoch: 5 | loss: 0.3990680
	speed: 0.0077s/iter; left time: 15.3105s
	iters: 200, epoch: 5 | loss: 0.4776449
	speed: 0.0035s/iter; left time: 6.6188s
	iters: 300, epoch: 5 | loss: 0.2897007
	speed: 0.0035s/iter; left time: 6.2223s
	iters: 400, epoch: 5 | loss: 0.2102550
	speed: 0.0035s/iter; left time: 5.9397s
	iters: 500, epoch: 5 | loss: 0.5522147
	speed: 0.0035s/iter; left time: 5.5371s
Updating learning rate to 7.237602035019229e-05
Epoch: 5 cost time: 1.853639841079712
Epoch: 5, Steps: 523 | Train Loss: 0.3857767 Vali Loss: 0.3037010 Best vali loss: 0.2746883
	iters: 100, epoch: 6 | loss: 0.2252775
	speed: 0.0073s/iter; left time: 10.6622s
	iters: 200, epoch: 6 | loss: 0.3402594
	speed: 0.0031s/iter; left time: 4.3012s
	iters: 300, epoch: 6 | loss: 0.5046266
	speed: 0.0031s/iter; left time: 3.9464s
	iters: 400, epoch: 6 | loss: 0.1743509
	speed: 0.0031s/iter; left time: 3.5705s
	iters: 500, epoch: 6 | loss: 0.3153412
	speed: 0.0030s/iter; left time: 3.2513s
Updating learning rate to 3.43396673225411e-05
Epoch: 6 cost time: 1.6492226123809814
Epoch: 6, Steps: 523 | Train Loss: 0.3119711 Vali Loss: 0.3025330 Best vali loss: 0.2746883
	iters: 100, epoch: 7 | loss: 0.6275475
	speed: 0.0075s/iter; left time: 7.1209s
	iters: 200, epoch: 7 | loss: 0.1795397
	speed: 0.0033s/iter; left time: 2.8093s
	iters: 300, epoch: 7 | loss: 0.3800392
	speed: 0.0033s/iter; left time: 2.4444s
	iters: 400, epoch: 7 | loss: 0.3305871
	speed: 0.0033s/iter; left time: 2.1456s
	iters: 500, epoch: 7 | loss: 0.2619551
	speed: 0.0033s/iter; left time: 1.7961s
Updating learning rate to 8.924588765107527e-06
Epoch: 7 cost time: 1.7748887538909912
Epoch: 7, Steps: 523 | Train Loss: 0.3559337 Vali Loss: 0.3157891 Best vali loss: 0.2746883
	iters: 100, epoch: 8 | loss: 0.2718471
	speed: 0.0077s/iter; left time: 3.2623s
	iters: 200, epoch: 8 | loss: 0.2353797
	speed: 0.0034s/iter; left time: 1.1163s
	iters: 300, epoch: 8 | loss: 0.2945352
	speed: 0.0034s/iter; left time: 0.7724s
	iters: 400, epoch: 8 | loss: 0.2059928
	speed: 0.0035s/iter; left time: 0.4280s
	iters: 500, epoch: 8 | loss: 0.4702737
	speed: 0.0035s/iter; left time: 0.0832s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8495049476623535
Epoch: 8, Steps: 523 | Train Loss: 0.2956057 Vali Loss: 0.3166770 Best vali loss: 0.2746883

best validation loss 0.27468826309505917

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008936967978, 'e_layers': 3, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4560234
	speed: 0.0128s/iter; left time: 12.1387s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2910).  Saving model state dict ...
Epoch: 1 cost time: 1.2297616004943848
Epoch: 1, Steps: 131 | Train Loss: 0.4560234 Vali Loss: 0.2910293 Best vali loss: 0.2910293
	iters: 100, epoch: 2 | loss: 0.4783470
	speed: 0.0122s/iter; left time: 9.9787s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2910 --> 0.2718).  Saving model state dict ...
Epoch: 2 cost time: 0.9962253570556641
Epoch: 2, Steps: 131 | Train Loss: 0.4783470 Vali Loss: 0.2718015 Best vali loss: 0.2718015
	iters: 100, epoch: 3 | loss: 0.4383991
	speed: 0.0124s/iter; left time: 8.5509s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 1.0038936138153076
Epoch: 3, Steps: 131 | Train Loss: 0.4383991 Vali Loss: 0.2944217 Best vali loss: 0.2718015

best validation loss 0.27180147970108437

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010227854273, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597166
	speed: 0.0107s/iter; left time: 10.1148s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9336202144622803
Epoch: 1, Steps: 131 | Train Loss: 0.5597166 Vali Loss: 0.2756327 Best vali loss: 0.2756327
	iters: 100, epoch: 2 | loss: 0.3245978
	speed: 0.0089s/iter; left time: 7.2529s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2695).  Saving model state dict ...
Epoch: 2 cost time: 0.7000508308410645
Epoch: 2, Steps: 131 | Train Loss: 0.3245978 Vali Loss: 0.2694911 Best vali loss: 0.2694911
	iters: 100, epoch: 3 | loss: 0.4631845
	speed: 0.0089s/iter; left time: 6.0913s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.6919028759002686
Epoch: 3, Steps: 131 | Train Loss: 0.4631845 Vali Loss: 0.2816508 Best vali loss: 0.2694911

best validation loss 0.269491100164983

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010222333983, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596893
	speed: 0.0103s/iter; left time: 9.7542s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9203226566314697
Epoch: 1, Steps: 131 | Train Loss: 0.5596893 Vali Loss: 0.2756446 Best vali loss: 0.2756446
	iters: 100, epoch: 2 | loss: 0.3230400
	speed: 0.0088s/iter; left time: 7.2349s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2721).  Saving model state dict ...
Epoch: 2 cost time: 0.7046952247619629
Epoch: 2, Steps: 131 | Train Loss: 0.3230400 Vali Loss: 0.2720531 Best vali loss: 0.2720531
	iters: 100, epoch: 3 | loss: 0.4646207
	speed: 0.0090s/iter; left time: 6.1857s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.6986198425292969
Epoch: 3, Steps: 131 | Train Loss: 0.4646207 Vali Loss: 0.2795472 Best vali loss: 0.2720531

best validation loss 0.27205314982908285

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010227854273, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4228522
	speed: 0.0106s/iter; left time: 5.8880s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.917593240737915
Epoch: 4, Steps: 131 | Train Loss: 0.4228522 Vali Loss: 0.3095016 Best vali loss: 0.2694911
	iters: 100, epoch: 5 | loss: 0.2814955
	speed: 0.0086s/iter; left time: 3.6647s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7010135650634766
Epoch: 5, Steps: 131 | Train Loss: 0.2814955 Vali Loss: 0.2953772 Best vali loss: 0.2694911
	iters: 100, epoch: 6 | loss: 0.4326272
	speed: 0.0087s/iter; left time: 2.5695s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7095329761505127
Epoch: 6, Steps: 131 | Train Loss: 0.4326272 Vali Loss: 0.2996075 Best vali loss: 0.2694911
	iters: 100, epoch: 7 | loss: 0.4683101
	speed: 0.0086s/iter; left time: 1.4085s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7020208835601807
Epoch: 7, Steps: 131 | Train Loss: 0.4683101 Vali Loss: 0.2988143 Best vali loss: 0.2694911
	iters: 100, epoch: 8 | loss: 0.3262474
	speed: 0.0086s/iter; left time: 0.2758s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6944761276245117
Epoch: 8, Steps: 131 | Train Loss: 0.3262474 Vali Loss: 0.2951740 Best vali loss: 0.2694911

best validation loss 0.269491100164983

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010235556525, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5687985
	speed: 0.0102s/iter; left time: 9.6383s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 0.9900331497192383
Epoch: 1, Steps: 131 | Train Loss: 0.5687985 Vali Loss: 0.2802179 Best vali loss: 0.2802179
	iters: 100, epoch: 2 | loss: 0.5259860
	speed: 0.0119s/iter; left time: 9.7522s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.9233062267303467
Epoch: 2, Steps: 131 | Train Loss: 0.5259860 Vali Loss: 0.2837143 Best vali loss: 0.2802179
	iters: 100, epoch: 3 | loss: 0.4063296
	speed: 0.0093s/iter; left time: 6.3745s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7543747425079346
Epoch: 3, Steps: 131 | Train Loss: 0.4063296 Vali Loss: 0.2813481 Best vali loss: 0.2802179
	iters: 100, epoch: 4 | loss: 0.3640749
	speed: 0.0092s/iter; left time: 5.1358s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7553825378417969
Epoch: 4, Steps: 131 | Train Loss: 0.3640749 Vali Loss: 0.2811683 Best vali loss: 0.2802179
	iters: 100, epoch: 5 | loss: 0.5434533
	speed: 0.0092s/iter; left time: 3.9051s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7541408538818359
Epoch: 5, Steps: 131 | Train Loss: 0.5434533 Vali Loss: 0.2831583 Best vali loss: 0.2802179
	iters: 100, epoch: 6 | loss: 0.3319554
	speed: 0.0094s/iter; left time: 2.7605s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7645120620727539
Epoch: 6, Steps: 131 | Train Loss: 0.3319554 Vali Loss: 0.2828109 Best vali loss: 0.2802179
	iters: 100, epoch: 7 | loss: 0.2780913
	speed: 0.0093s/iter; left time: 1.5109s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7670092582702637
Epoch: 7, Steps: 131 | Train Loss: 0.2780913 Vali Loss: 0.2844410 Best vali loss: 0.2802179
	iters: 100, epoch: 8 | loss: 0.3116893
	speed: 0.0093s/iter; left time: 0.2978s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.75433349609375
Epoch: 8, Steps: 131 | Train Loss: 0.3116893 Vali Loss: 0.2845363 Best vali loss: 0.2802179

best validation loss 0.28021786418179234

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010255203038, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5687839
	speed: 0.0117s/iter; left time: 11.0981s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 1.1447927951812744
Epoch: 1, Steps: 131 | Train Loss: 0.5687839 Vali Loss: 0.2802196 Best vali loss: 0.2802196
	iters: 100, epoch: 2 | loss: 0.5271263
	speed: 0.0096s/iter; left time: 7.8417s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.7613792419433594
Epoch: 2, Steps: 131 | Train Loss: 0.5271263 Vali Loss: 0.2848878 Best vali loss: 0.2802196
	iters: 100, epoch: 3 | loss: 0.4060907
	speed: 0.0093s/iter; left time: 6.3766s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.75978684425354
Epoch: 3, Steps: 131 | Train Loss: 0.4060907 Vali Loss: 0.2821046 Best vali loss: 0.2802196
	iters: 100, epoch: 4 | loss: 0.3628909
	speed: 0.0093s/iter; left time: 5.1833s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7648355960845947
Epoch: 4, Steps: 131 | Train Loss: 0.3628909 Vali Loss: 0.2822854 Best vali loss: 0.2802196
	iters: 100, epoch: 5 | loss: 0.5451049
	speed: 0.0093s/iter; left time: 3.9369s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7582664489746094
Epoch: 5, Steps: 131 | Train Loss: 0.5451049 Vali Loss: 0.2830755 Best vali loss: 0.2802196
	iters: 100, epoch: 6 | loss: 0.3343202
	speed: 0.0092s/iter; left time: 2.7084s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7551825046539307
Epoch: 6, Steps: 131 | Train Loss: 0.3343202 Vali Loss: 0.2831589 Best vali loss: 0.2802196
	iters: 100, epoch: 7 | loss: 0.2782279
	speed: 0.0094s/iter; left time: 1.5277s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7679038047790527
Epoch: 7, Steps: 131 | Train Loss: 0.2782279 Vali Loss: 0.2852072 Best vali loss: 0.2802196
	iters: 100, epoch: 8 | loss: 0.3112526
	speed: 0.0093s/iter; left time: 0.2983s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7609355449676514
Epoch: 8, Steps: 131 | Train Loss: 0.3112526 Vali Loss: 0.2851128 Best vali loss: 0.2802196

best validation loss 0.28021955428601375

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0101455890769, 'e_layers': 3, 'learning_rate': 0.0007259579335, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007259579335
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 0.841522216796875
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2801863 Best vali loss: 0.2801863
Updating learning rate to 0.00036297896675
Epoch: 2 cost time: 0.6168508529663086
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2864551 Best vali loss: 0.2801863
Updating learning rate to 0.000181489483375
Validation loss decreased (0.2802 --> 0.2789).  Saving model state dict ...
Epoch: 3 cost time: 0.6140282154083252
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2788946 Best vali loss: 0.2788946

best validation loss 0.2788945502754302

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010200606903, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5687984
	speed: 0.0110s/iter; left time: 10.4585s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 0.9924206733703613
Epoch: 1, Steps: 131 | Train Loss: 0.5687984 Vali Loss: 0.2802074 Best vali loss: 0.2802074
	iters: 100, epoch: 2 | loss: 0.5288066
	speed: 0.0095s/iter; left time: 7.8050s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.760338544845581
Epoch: 2, Steps: 131 | Train Loss: 0.5288066 Vali Loss: 0.2854028 Best vali loss: 0.2802074
	iters: 100, epoch: 3 | loss: 0.4073907
	speed: 0.0093s/iter; left time: 6.3885s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7598786354064941
Epoch: 3, Steps: 131 | Train Loss: 0.4073907 Vali Loss: 0.2805713 Best vali loss: 0.2802074

best validation loss 0.28020737741063545

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0018070556985, 'e_layers': 2, 'learning_rate': 0.0003857584807, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5641387
	speed: 0.0084s/iter; left time: 34.4893s
	iters: 200, epoch: 1 | loss: 1.3302705
	speed: 0.0031s/iter; left time: 12.5439s
	iters: 300, epoch: 1 | loss: 0.3358001
	speed: 0.0031s/iter; left time: 12.0472s
	iters: 400, epoch: 1 | loss: 0.6904014
	speed: 0.0031s/iter; left time: 11.7458s
	iters: 500, epoch: 1 | loss: 0.7954878
	speed: 0.0031s/iter; left time: 11.4602s
Updating learning rate to 0.0003857584807
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 1.8836255073547363
Epoch: 1, Steps: 523 | Train Loss: 0.7432197 Vali Loss: 0.2895242 Best vali loss: 0.2895242
	iters: 100, epoch: 2 | loss: 0.3707855
	speed: 0.0071s/iter; left time: 25.3003s
	iters: 200, epoch: 2 | loss: 0.2538951
	speed: 0.0033s/iter; left time: 11.4741s
	iters: 300, epoch: 2 | loss: 0.5124330
	speed: 0.0033s/iter; left time: 11.1216s
	iters: 400, epoch: 2 | loss: 0.6793525
	speed: 0.0034s/iter; left time: 10.9969s
	iters: 500, epoch: 2 | loss: 0.6403055
	speed: 0.0035s/iter; left time: 10.9276s
Updating learning rate to 0.00019287924035
Validation loss decreased (0.2895 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 1.7913687229156494
Epoch: 2, Steps: 523 | Train Loss: 0.4913543 Vali Loss: 0.2828656 Best vali loss: 0.2828656
	iters: 100, epoch: 3 | loss: 0.6092499
	speed: 0.0068s/iter; left time: 20.6741s
	iters: 200, epoch: 3 | loss: 0.2975695
	speed: 0.0030s/iter; left time: 8.8122s
	iters: 300, epoch: 3 | loss: 0.3160267
	speed: 0.0030s/iter; left time: 8.6587s
	iters: 400, epoch: 3 | loss: 0.7476379
	speed: 0.0032s/iter; left time: 8.7154s
	iters: 500, epoch: 3 | loss: 1.0771543
	speed: 0.0031s/iter; left time: 8.3113s
Updating learning rate to 9.6439620175e-05
Epoch: 3 cost time: 1.6467840671539307
Epoch: 3, Steps: 523 | Train Loss: 0.6095277 Vali Loss: 0.2837970 Best vali loss: 0.2828656

best validation loss 0.2828655836029361

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0101455890769, 'e_layers': 3, 'learning_rate': 0.0007259579335, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 9.07447416875e-05
Epoch: 4 cost time: 0.8422908782958984
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2805410 Best vali loss: 0.2788946
Updating learning rate to 4.537237084375e-05
Epoch: 5 cost time: 0.6093480587005615
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2861584 Best vali loss: 0.2788946
Updating learning rate to 2.2686185421875e-05
Epoch: 6 cost time: 0.6105020046234131
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2824597 Best vali loss: 0.2788946
Updating learning rate to 1.13430927109375e-05
Epoch: 7 cost time: 0.6159298419952393
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2855787 Best vali loss: 0.2788946
Updating learning rate to 5.67154635546875e-06
Epoch: 8 cost time: 0.621915340423584
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2851277 Best vali loss: 0.2788946

best validation loss 0.2788945502754302

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010143882674, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5688230
	speed: 0.0108s/iter; left time: 10.2496s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 0.9848830699920654
Epoch: 1, Steps: 131 | Train Loss: 0.5688230 Vali Loss: 0.2802249 Best vali loss: 0.2802249
	iters: 100, epoch: 2 | loss: 0.5238332
	speed: 0.0097s/iter; left time: 7.9157s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.7676184177398682
Epoch: 2, Steps: 131 | Train Loss: 0.5238332 Vali Loss: 0.2843266 Best vali loss: 0.2802249
	iters: 100, epoch: 3 | loss: 0.4098194
	speed: 0.0094s/iter; left time: 6.4442s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7643702030181885
Epoch: 3, Steps: 131 | Train Loss: 0.4098194 Vali Loss: 0.2819114 Best vali loss: 0.2802249
	iters: 100, epoch: 4 | loss: 0.3644538
	speed: 0.0093s/iter; left time: 5.1871s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7605094909667969
Epoch: 4, Steps: 131 | Train Loss: 0.3644538 Vali Loss: 0.2828592 Best vali loss: 0.2802249
	iters: 100, epoch: 5 | loss: 0.5473076
	speed: 0.0094s/iter; left time: 3.9765s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7622721195220947
Epoch: 5, Steps: 131 | Train Loss: 0.5473076 Vali Loss: 0.2840810 Best vali loss: 0.2802249
	iters: 100, epoch: 6 | loss: 0.3343310
	speed: 0.0094s/iter; left time: 2.7609s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7613263130187988
Epoch: 6, Steps: 131 | Train Loss: 0.3343310 Vali Loss: 0.2840752 Best vali loss: 0.2802249
	iters: 100, epoch: 7 | loss: 0.2778000
	speed: 0.0093s/iter; left time: 1.5170s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7660152912139893
Epoch: 7, Steps: 131 | Train Loss: 0.2778000 Vali Loss: 0.2857531 Best vali loss: 0.2802249
	iters: 100, epoch: 8 | loss: 0.3125013
	speed: 0.0093s/iter; left time: 0.2992s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7599785327911377
Epoch: 8, Steps: 131 | Train Loss: 0.3125013 Vali Loss: 0.2858811 Best vali loss: 0.2802249

best validation loss 0.28022487407259977

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4262856
	speed: 0.0091s/iter; left time: 18.1526s
	iters: 200, epoch: 1 | loss: 0.5656894
	speed: 0.0038s/iter; left time: 7.2154s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.2672886848449707
Epoch: 1, Steps: 262 | Train Loss: 0.4959875 Vali Loss: 0.2813236 Best vali loss: 0.2813236
	iters: 100, epoch: 2 | loss: 0.6726094
	speed: 0.0091s/iter; left time: 15.7328s
	iters: 200, epoch: 2 | loss: 0.3628563
	speed: 0.0038s/iter; left time: 6.2583s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2813 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 1.040867567062378
Epoch: 2, Steps: 262 | Train Loss: 0.5177329 Vali Loss: 0.2787977 Best vali loss: 0.2787977
	iters: 100, epoch: 3 | loss: 0.5121211
	speed: 0.0092s/iter; left time: 13.4884s
	iters: 200, epoch: 3 | loss: 0.4798066
	speed: 0.0038s/iter; left time: 5.2027s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.0327973365783691
Epoch: 3, Steps: 262 | Train Loss: 0.4959639 Vali Loss: 0.3087691 Best vali loss: 0.2787977
	iters: 100, epoch: 4 | loss: 0.6288728
	speed: 0.0087s/iter; left time: 10.5105s
	iters: 200, epoch: 4 | loss: 0.4296001
	speed: 0.0038s/iter; left time: 4.1964s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 1.0265469551086426
Epoch: 4, Steps: 262 | Train Loss: 0.5292365 Vali Loss: 0.3033698 Best vali loss: 0.2787977
	iters: 100, epoch: 5 | loss: 0.3577132
	speed: 0.0089s/iter; left time: 8.4081s
	iters: 200, epoch: 5 | loss: 0.2163030
	speed: 0.0038s/iter; left time: 3.2356s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 1.0461313724517822
Epoch: 5, Steps: 262 | Train Loss: 0.2870081 Vali Loss: 0.3134510 Best vali loss: 0.2787977
	iters: 100, epoch: 6 | loss: 0.3908114
	speed: 0.0088s/iter; left time: 6.0360s
	iters: 200, epoch: 6 | loss: 0.2360938
	speed: 0.0038s/iter; left time: 2.2245s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 1.0277249813079834
Epoch: 6, Steps: 262 | Train Loss: 0.3134526 Vali Loss: 0.3146634 Best vali loss: 0.2787977
	iters: 100, epoch: 7 | loss: 0.3106960
	speed: 0.0087s/iter; left time: 3.7120s
	iters: 200, epoch: 7 | loss: 0.2819164
	speed: 0.0038s/iter; left time: 1.2255s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 1.0314905643463135
Epoch: 7, Steps: 262 | Train Loss: 0.2963062 Vali Loss: 0.3174868 Best vali loss: 0.2787977
	iters: 100, epoch: 8 | loss: 0.4357189
	speed: 0.0087s/iter; left time: 1.4185s
	iters: 200, epoch: 8 | loss: 0.3160326
	speed: 0.0037s/iter; left time: 0.2352s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.019979476928711
Epoch: 8, Steps: 262 | Train Loss: 0.3758757 Vali Loss: 0.3175133 Best vali loss: 0.2787977

best validation loss 0.2787977234831349

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4262858
	speed: 0.0091s/iter; left time: 18.1097s
	iters: 200, epoch: 1 | loss: 0.5656787
	speed: 0.0037s/iter; left time: 7.0221s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.2441308498382568
Epoch: 1, Steps: 262 | Train Loss: 0.4959823 Vali Loss: 0.2812764 Best vali loss: 0.2812764
	iters: 100, epoch: 2 | loss: 0.6759729
	speed: 0.0088s/iter; left time: 15.2995s
	iters: 200, epoch: 2 | loss: 0.3625594
	speed: 0.0037s/iter; left time: 6.1107s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 1.0198910236358643
Epoch: 2, Steps: 262 | Train Loss: 0.5192662 Vali Loss: 0.2841854 Best vali loss: 0.2812764
	iters: 100, epoch: 3 | loss: 0.4984073
	speed: 0.0086s/iter; left time: 12.7250s
	iters: 200, epoch: 3 | loss: 0.4714063
	speed: 0.0037s/iter; left time: 5.1307s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.0177292823791504
Epoch: 3, Steps: 262 | Train Loss: 0.4849068 Vali Loss: 0.3234755 Best vali loss: 0.2812764

best validation loss 0.28127641578552315

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010265463353, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4262860
	speed: 0.0093s/iter; left time: 18.5106s
	iters: 200, epoch: 1 | loss: 0.5655292
	speed: 0.0039s/iter; left time: 7.4117s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.2905185222625732
Epoch: 1, Steps: 262 | Train Loss: 0.4959076 Vali Loss: 0.2814218 Best vali loss: 0.2814218
	iters: 100, epoch: 2 | loss: 0.6787789
	speed: 0.0090s/iter; left time: 15.6764s
	iters: 200, epoch: 2 | loss: 0.3661891
	speed: 0.0038s/iter; left time: 6.2273s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2814 --> 0.2811).  Saving model state dict ...
Epoch: 2 cost time: 1.033618450164795
Epoch: 2, Steps: 262 | Train Loss: 0.5224840 Vali Loss: 0.2811269 Best vali loss: 0.2811269
	iters: 100, epoch: 3 | loss: 0.4993190
	speed: 0.0091s/iter; left time: 13.3721s
	iters: 200, epoch: 3 | loss: 0.4606489
	speed: 0.0039s/iter; left time: 5.3152s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.0516505241394043
Epoch: 3, Steps: 262 | Train Loss: 0.4799839 Vali Loss: 0.3185439 Best vali loss: 0.2811269

best validation loss 0.28112694260886983

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.00593010544, 'e_layers': 4, 'learning_rate': 0.0009408349469, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5671908
	speed: 0.0104s/iter; left time: 42.2820s
	iters: 200, epoch: 1 | loss: 0.7280142
	speed: 0.0052s/iter; left time: 20.7887s
	iters: 300, epoch: 1 | loss: 1.2414467
	speed: 0.0052s/iter; left time: 20.0236s
	iters: 400, epoch: 1 | loss: 0.4177246
	speed: 0.0052s/iter; left time: 19.5446s
	iters: 500, epoch: 1 | loss: 0.2538709
	speed: 0.0052s/iter; left time: 19.2073s
Updating learning rate to 0.0009408349469
Validation loss decreased (inf --> 0.2887).  Saving model state dict ...
Epoch: 1 cost time: 2.9661059379577637
Epoch: 1, Steps: 523 | Train Loss: 0.6416495 Vali Loss: 0.2887284 Best vali loss: 0.2887284
	iters: 100, epoch: 2 | loss: 0.2632621
	speed: 0.0102s/iter; left time: 36.3798s
	iters: 200, epoch: 2 | loss: 0.6115388
	speed: 0.0051s/iter; left time: 17.7519s
	iters: 300, epoch: 2 | loss: 0.9161708
	speed: 0.0051s/iter; left time: 17.2748s
	iters: 400, epoch: 2 | loss: 0.7543407
	speed: 0.0051s/iter; left time: 16.7358s
	iters: 500, epoch: 2 | loss: 0.4608593
	speed: 0.0052s/iter; left time: 16.5470s
Updating learning rate to 0.00047041747345
Epoch: 2 cost time: 2.73050594329834
Epoch: 2, Steps: 523 | Train Loss: 0.6012343 Vali Loss: 0.3169668 Best vali loss: 0.2887284
	iters: 100, epoch: 3 | loss: 0.5643358
	speed: 0.0102s/iter; left time: 31.0543s
	iters: 200, epoch: 3 | loss: 0.5077921
	speed: 0.0052s/iter; left time: 15.2491s
	iters: 300, epoch: 3 | loss: 0.8095841
	speed: 0.0052s/iter; left time: 14.8356s
	iters: 400, epoch: 3 | loss: 0.4448169
	speed: 0.0052s/iter; left time: 14.2346s
	iters: 500, epoch: 3 | loss: 0.2997439
	speed: 0.0052s/iter; left time: 13.8443s
Updating learning rate to 0.000235208736725
Epoch: 3 cost time: 2.7635409832000732
Epoch: 3, Steps: 523 | Train Loss: 0.5252546 Vali Loss: 0.2923643 Best vali loss: 0.2887284

best validation loss 0.2887283858810938

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010265463353, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3669871
	speed: 0.0097s/iter; left time: 11.6940s
	iters: 200, epoch: 4 | loss: 0.4262180
	speed: 0.0038s/iter; left time: 4.2054s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 1.275407314300537
Epoch: 4, Steps: 262 | Train Loss: 0.3966026 Vali Loss: 0.3278580 Best vali loss: 0.2811269
	iters: 100, epoch: 5 | loss: 0.4975143
	speed: 0.0088s/iter; left time: 8.3145s
	iters: 200, epoch: 5 | loss: 0.2631744
	speed: 0.0037s/iter; left time: 3.1623s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 1.0198512077331543
Epoch: 5, Steps: 262 | Train Loss: 0.3803443 Vali Loss: 0.3133646 Best vali loss: 0.2811269
	iters: 100, epoch: 6 | loss: 0.4161523
	speed: 0.0086s/iter; left time: 5.9292s
	iters: 200, epoch: 6 | loss: 0.3941991
	speed: 0.0038s/iter; left time: 2.2014s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 1.020888328552246
Epoch: 6, Steps: 262 | Train Loss: 0.4051757 Vali Loss: 0.3229578 Best vali loss: 0.2811269
	iters: 100, epoch: 7 | loss: 0.5616987
	speed: 0.0086s/iter; left time: 3.6453s
	iters: 200, epoch: 7 | loss: 0.4017174
	speed: 0.0037s/iter; left time: 1.1984s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 1.020012378692627
Epoch: 7, Steps: 262 | Train Loss: 0.4817080 Vali Loss: 0.3287309 Best vali loss: 0.2811269
	iters: 100, epoch: 8 | loss: 0.3431290
	speed: 0.0087s/iter; left time: 1.4177s
	iters: 200, epoch: 8 | loss: 0.2056203
	speed: 0.0037s/iter; left time: 0.2326s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.0098748207092285
Epoch: 8, Steps: 262 | Train Loss: 0.2743747 Vali Loss: 0.3291020 Best vali loss: 0.2811269

best validation loss 0.28112694260886983

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009672997047, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4262750
	speed: 0.0091s/iter; left time: 18.2117s
	iters: 200, epoch: 1 | loss: 0.5651978
	speed: 0.0038s/iter; left time: 7.1638s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.258805274963379
Epoch: 1, Steps: 262 | Train Loss: 0.4957364 Vali Loss: 0.2813846 Best vali loss: 0.2813846
	iters: 100, epoch: 2 | loss: 0.6629765
	speed: 0.0090s/iter; left time: 15.6619s
	iters: 200, epoch: 2 | loss: 0.3382398
	speed: 0.0038s/iter; left time: 6.2628s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2814 --> 0.2799).  Saving model state dict ...
Epoch: 2 cost time: 1.0370564460754395
Epoch: 2, Steps: 262 | Train Loss: 0.5006082 Vali Loss: 0.2798671 Best vali loss: 0.2798671
	iters: 100, epoch: 3 | loss: 0.5138449
	speed: 0.0091s/iter; left time: 13.3348s
	iters: 200, epoch: 3 | loss: 0.4659815
	speed: 0.0037s/iter; left time: 5.1098s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.0193815231323242
Epoch: 3, Steps: 262 | Train Loss: 0.4899132 Vali Loss: 0.3138085 Best vali loss: 0.2798671
	iters: 100, epoch: 4 | loss: 0.6252252
	speed: 0.0086s/iter; left time: 10.4321s
	iters: 200, epoch: 4 | loss: 0.4376151
	speed: 0.0037s/iter; left time: 4.1372s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 1.0170907974243164
Epoch: 4, Steps: 262 | Train Loss: 0.5314202 Vali Loss: 0.3248875 Best vali loss: 0.2798671
	iters: 100, epoch: 5 | loss: 0.3568301
	speed: 0.0088s/iter; left time: 8.3451s
	iters: 200, epoch: 5 | loss: 0.2100749
	speed: 0.0037s/iter; left time: 3.1791s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 1.0304765701293945
Epoch: 5, Steps: 262 | Train Loss: 0.2834525 Vali Loss: 0.3260608 Best vali loss: 0.2798671
	iters: 100, epoch: 6 | loss: 0.3894334
	speed: 0.0089s/iter; left time: 6.0850s
	iters: 200, epoch: 6 | loss: 0.2337567
	speed: 0.0037s/iter; left time: 2.1972s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 1.0205190181732178
Epoch: 6, Steps: 262 | Train Loss: 0.3115950 Vali Loss: 0.3322471 Best vali loss: 0.2798671
	iters: 100, epoch: 7 | loss: 0.3143470
	speed: 0.0088s/iter; left time: 3.7520s
	iters: 200, epoch: 7 | loss: 0.2824671
	speed: 0.0038s/iter; left time: 1.2197s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 1.047283411026001
Epoch: 7, Steps: 262 | Train Loss: 0.2984070 Vali Loss: 0.3355533 Best vali loss: 0.2798671
	iters: 100, epoch: 8 | loss: 0.4315966
	speed: 0.0087s/iter; left time: 1.4187s
	iters: 200, epoch: 8 | loss: 0.3159218
	speed: 0.0037s/iter; left time: 0.2344s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.0156352519989014
Epoch: 8, Steps: 262 | Train Loss: 0.3737592 Vali Loss: 0.3340693 Best vali loss: 0.2798671

best validation loss 0.27986706083438884

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010277496826, 'e_layers': 2, 'learning_rate': 0.0002345059196, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597024
	speed: 0.0104s/iter; left time: 9.8773s
Updating learning rate to 0.0002345059196
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9253966808319092
Epoch: 1, Steps: 131 | Train Loss: 0.5597024 Vali Loss: 0.2756332 Best vali loss: 0.2756332
	iters: 100, epoch: 2 | loss: 0.3250256
	speed: 0.0090s/iter; left time: 7.3526s
Updating learning rate to 0.0001172529598
Validation loss decreased (0.2756 --> 0.2699).  Saving model state dict ...
Epoch: 2 cost time: 0.7063069343566895
Epoch: 2, Steps: 131 | Train Loss: 0.3250256 Vali Loss: 0.2699208 Best vali loss: 0.2699208
	iters: 100, epoch: 3 | loss: 0.4626354
	speed: 0.0090s/iter; left time: 6.2083s
Updating learning rate to 5.86264799e-05
Epoch: 3 cost time: 0.703373908996582
Epoch: 3, Steps: 131 | Train Loss: 0.4626354 Vali Loss: 0.2766515 Best vali loss: 0.2699208
	iters: 100, epoch: 4 | loss: 0.5061437
	speed: 0.0087s/iter; left time: 4.8266s
Updating learning rate to 2.931323995e-05
Epoch: 4 cost time: 0.701143741607666
Epoch: 4, Steps: 131 | Train Loss: 0.5061437 Vali Loss: 0.2873904 Best vali loss: 0.2699208
	iters: 100, epoch: 5 | loss: 0.3358452
	speed: 0.0086s/iter; left time: 3.6758s
Updating learning rate to 1.4656619975e-05
Epoch: 5 cost time: 0.6967697143554688
Epoch: 5, Steps: 131 | Train Loss: 0.3358452 Vali Loss: 0.2895789 Best vali loss: 0.2699208
	iters: 100, epoch: 6 | loss: 0.3181818
	speed: 0.0087s/iter; left time: 2.5453s
Updating learning rate to 7.3283099875e-06
Epoch: 6 cost time: 0.700732946395874
Epoch: 6, Steps: 131 | Train Loss: 0.3181818 Vali Loss: 0.2898274 Best vali loss: 0.2699208
	iters: 100, epoch: 7 | loss: 0.3115030
	speed: 0.0088s/iter; left time: 1.4285s
Updating learning rate to 3.66415499375e-06
Epoch: 7 cost time: 0.7087533473968506
Epoch: 7, Steps: 131 | Train Loss: 0.3115030 Vali Loss: 0.2933584 Best vali loss: 0.2699208
	iters: 100, epoch: 8 | loss: 0.3963430
	speed: 0.0087s/iter; left time: 0.2791s
Updating learning rate to 1.832077496875e-06
Epoch: 8 cost time: 0.704005241394043
Epoch: 8, Steps: 131 | Train Loss: 0.3963430 Vali Loss: 0.2940573 Best vali loss: 0.2699208

best validation loss 0.2699208311894517

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4262832
	speed: 0.0091s/iter; left time: 18.1123s
	iters: 200, epoch: 1 | loss: 0.5652634
	speed: 0.0037s/iter; left time: 7.0850s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.2521357536315918
Epoch: 1, Steps: 262 | Train Loss: 0.4957733 Vali Loss: 0.2813775 Best vali loss: 0.2813775
	iters: 100, epoch: 2 | loss: 0.6869398
	speed: 0.0089s/iter; left time: 15.4879s
	iters: 200, epoch: 2 | loss: 0.3831095
	speed: 0.0037s/iter; left time: 6.1280s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2814 --> 0.2755).  Saving model state dict ...
Epoch: 2 cost time: 1.0193212032318115
Epoch: 2, Steps: 262 | Train Loss: 0.5350246 Vali Loss: 0.2755020 Best vali loss: 0.2755020
	iters: 100, epoch: 3 | loss: 0.4831419
	speed: 0.0090s/iter; left time: 13.1913s
	iters: 200, epoch: 3 | loss: 0.4700228
	speed: 0.0037s/iter; left time: 5.0847s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 1.0192649364471436
Epoch: 3, Steps: 262 | Train Loss: 0.4765823 Vali Loss: 0.2866914 Best vali loss: 0.2755020

best validation loss 0.27550204238425224

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0020485462427, 'e_layers': 3, 'learning_rate': 0.000221227392, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2866720
	speed: 0.0091s/iter; left time: 74.9894s
	iters: 200, epoch: 1 | loss: 0.4396281
	speed: 0.0041s/iter; left time: 33.6247s
	iters: 300, epoch: 1 | loss: 0.2887227
	speed: 0.0041s/iter; left time: 33.1165s
	iters: 400, epoch: 1 | loss: 1.1664222
	speed: 0.0042s/iter; left time: 33.3962s
	iters: 500, epoch: 1 | loss: 0.7329615
	speed: 0.0041s/iter; left time: 32.0934s
	iters: 600, epoch: 1 | loss: 0.3046108
	speed: 0.0040s/iter; left time: 30.8024s
	iters: 700, epoch: 1 | loss: 0.3748202
	speed: 0.0037s/iter; left time: 28.6236s
	iters: 800, epoch: 1 | loss: 0.3902262
	speed: 0.0040s/iter; left time: 29.9778s
	iters: 900, epoch: 1 | loss: 0.6568606
	speed: 0.0040s/iter; left time: 29.8407s
	iters: 1000, epoch: 1 | loss: 0.3177766
	speed: 0.0040s/iter; left time: 29.3859s
Updating learning rate to 0.00021280742574982558
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 4.457170486450195
Epoch: 1, Steps: 1045 | Train Loss: 0.4958701 Vali Loss: 0.2832094 Best vali loss: 0.2832094
	iters: 100, epoch: 2 | loss: 2.2733343
	speed: 0.0120s/iter; left time: 86.5716s
	iters: 200, epoch: 2 | loss: 0.2116185
	speed: 0.0040s/iter; left time: 28.1137s
	iters: 300, epoch: 2 | loss: 0.2724175
	speed: 0.0040s/iter; left time: 27.7133s
	iters: 400, epoch: 2 | loss: 0.4287869
	speed: 0.0039s/iter; left time: 27.2569s
	iters: 500, epoch: 2 | loss: 0.2620900
	speed: 0.0039s/iter; left time: 26.8229s
	iters: 600, epoch: 2 | loss: 0.2975644
	speed: 0.0040s/iter; left time: 26.5558s
	iters: 700, epoch: 2 | loss: 0.3875887
	speed: 0.0040s/iter; left time: 26.3477s
	iters: 800, epoch: 2 | loss: 0.2128343
	speed: 0.0040s/iter; left time: 25.9938s
	iters: 900, epoch: 2 | loss: 0.3114040
	speed: 0.0040s/iter; left time: 25.6623s
	iters: 1000, epoch: 2 | loss: 0.3328433
	speed: 0.0040s/iter; left time: 25.2686s
Updating learning rate to 0.0001888293905337073
Validation loss decreased (0.2832 --> 0.2813).  Saving model state dict ...
Epoch: 2 cost time: 4.1728479862213135
Epoch: 2, Steps: 1045 | Train Loss: 0.4990482 Vali Loss: 0.2812954 Best vali loss: 0.2812954
	iters: 100, epoch: 3 | loss: 0.4615443
	speed: 0.0118s/iter; left time: 73.0975s
	iters: 200, epoch: 3 | loss: 0.2271522
	speed: 0.0041s/iter; left time: 24.9065s
	iters: 300, epoch: 3 | loss: 0.1762681
	speed: 0.0042s/iter; left time: 25.1118s
	iters: 400, epoch: 3 | loss: 0.3466583
	speed: 0.0042s/iter; left time: 24.6373s
	iters: 500, epoch: 3 | loss: 0.2183711
	speed: 0.0043s/iter; left time: 24.7407s
	iters: 600, epoch: 3 | loss: 0.1972219
	speed: 0.0043s/iter; left time: 24.1440s
	iters: 700, epoch: 3 | loss: 0.4464126
	speed: 0.0042s/iter; left time: 23.5821s
	iters: 800, epoch: 3 | loss: 0.9109193
	speed: 0.0042s/iter; left time: 23.1031s
	iters: 900, epoch: 3 | loss: 0.3194676
	speed: 0.0042s/iter; left time: 22.6640s
	iters: 1000, epoch: 3 | loss: 0.2445702
	speed: 0.0042s/iter; left time: 21.9777s
Updating learning rate to 0.0001529437248518686
Epoch: 3 cost time: 4.39992618560791
Epoch: 3, Steps: 1045 | Train Loss: 0.3548586 Vali Loss: 0.2882753 Best vali loss: 0.2812954

best validation loss 0.2812953829687738

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0047743851308, 'e_layers': 1, 'learning_rate': 0.0017326778616, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0017326778616
Validation loss decreased (inf --> 0.2854).  Saving model state dict ...
Epoch: 1 cost time: 0.47496891021728516
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2854043 Best vali loss: 0.2854043
Updating learning rate to 0.0008663389308
Validation loss decreased (0.2854 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 0.27263641357421875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2824866 Best vali loss: 0.2824866
Updating learning rate to 0.0004331694654
Epoch: 3 cost time: 0.2751748561859131
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2837716 Best vali loss: 0.2824866

best validation loss 0.28248660574508183

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3648480
	speed: 0.0095s/iter; left time: 11.4570s
	iters: 200, epoch: 4 | loss: 0.4320393
	speed: 0.0038s/iter; left time: 4.2171s
Updating learning rate to 2.9310739475e-05
Epoch: 4 cost time: 1.2780470848083496
Epoch: 4, Steps: 262 | Train Loss: 0.3984437 Vali Loss: 0.3006174 Best vali loss: 0.2755020
	iters: 100, epoch: 5 | loss: 0.5038554
	speed: 0.0086s/iter; left time: 8.1534s
	iters: 200, epoch: 5 | loss: 0.2710004
	speed: 0.0038s/iter; left time: 3.2482s
Updating learning rate to 1.46553697375e-05
Epoch: 5 cost time: 1.0319263935089111
Epoch: 5, Steps: 262 | Train Loss: 0.3874279 Vali Loss: 0.2950064 Best vali loss: 0.2755020
	iters: 100, epoch: 6 | loss: 0.4146335
	speed: 0.0088s/iter; left time: 6.0144s
	iters: 200, epoch: 6 | loss: 0.3944610
	speed: 0.0039s/iter; left time: 2.2704s
Updating learning rate to 7.32768486875e-06
Epoch: 6 cost time: 1.0508322715759277
Epoch: 6, Steps: 262 | Train Loss: 0.4045472 Vali Loss: 0.2965105 Best vali loss: 0.2755020
	iters: 100, epoch: 7 | loss: 0.5598666
	speed: 0.0088s/iter; left time: 3.7468s
	iters: 200, epoch: 7 | loss: 0.4082454
	speed: 0.0037s/iter; left time: 1.2092s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 1.0366134643554688
Epoch: 7, Steps: 262 | Train Loss: 0.4840560 Vali Loss: 0.3012829 Best vali loss: 0.2755020
	iters: 100, epoch: 8 | loss: 0.3431957
	speed: 0.0088s/iter; left time: 1.4385s
	iters: 200, epoch: 8 | loss: 0.2071494
	speed: 0.0037s/iter; left time: 0.2351s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 1.0231313705444336
Epoch: 8, Steps: 262 | Train Loss: 0.2751726 Vali Loss: 0.2998053 Best vali loss: 0.2755020

best validation loss 0.27550204238425224

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4568672
	speed: 0.0094s/iter; left time: 8.9279s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.8230392932891846
Epoch: 1, Steps: 131 | Train Loss: 0.4568672 Vali Loss: 0.2782075 Best vali loss: 0.2782075
	iters: 100, epoch: 2 | loss: 0.4445904
	speed: 0.0072s/iter; left time: 5.8618s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.5456805229187012
Epoch: 2, Steps: 131 | Train Loss: 0.4445904 Vali Loss: 0.2820267 Best vali loss: 0.2782075
	iters: 100, epoch: 3 | loss: 0.5429516
	speed: 0.0071s/iter; left time: 4.8674s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.5543298721313477
Epoch: 3, Steps: 131 | Train Loss: 0.5429516 Vali Loss: 0.2971389 Best vali loss: 0.2782075
	iters: 100, epoch: 4 | loss: 0.4158134
	speed: 0.0073s/iter; left time: 4.0608s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.586808443069458
Epoch: 4, Steps: 131 | Train Loss: 0.4158134 Vali Loss: 0.2921782 Best vali loss: 0.2782075
	iters: 100, epoch: 5 | loss: 0.3269344
	speed: 0.0070s/iter; left time: 2.9947s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.5707235336303711
Epoch: 5, Steps: 131 | Train Loss: 0.3269344 Vali Loss: 0.2971748 Best vali loss: 0.2782075
	iters: 100, epoch: 6 | loss: 0.3348861
	speed: 0.0072s/iter; left time: 2.1163s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.5662746429443359
Epoch: 6, Steps: 131 | Train Loss: 0.3348861 Vali Loss: 0.3011517 Best vali loss: 0.2782075
	iters: 100, epoch: 7 | loss: 0.3744793
	speed: 0.0070s/iter; left time: 1.1357s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.5391299724578857
Epoch: 7, Steps: 131 | Train Loss: 0.3744793 Vali Loss: 0.2962000 Best vali loss: 0.2782075
	iters: 100, epoch: 8 | loss: 0.3148172
	speed: 0.0070s/iter; left time: 0.2228s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.5498988628387451
Epoch: 8, Steps: 131 | Train Loss: 0.3148172 Vali Loss: 0.2975862 Best vali loss: 0.2782075

best validation loss 0.2782075322081095

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0013930444637, 'e_layers': 3, 'learning_rate': 0.0047522616321, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3224657
	speed: 0.0091s/iter; left time: 75.4581s
	iters: 200, epoch: 1 | loss: 0.2886885
	speed: 0.0041s/iter; left time: 33.6221s
	iters: 300, epoch: 1 | loss: 0.6984731
	speed: 0.0040s/iter; left time: 32.4742s
	iters: 400, epoch: 1 | loss: 0.3562717
	speed: 0.0039s/iter; left time: 31.2839s
	iters: 500, epoch: 1 | loss: 0.3743199
	speed: 0.0038s/iter; left time: 30.0094s
	iters: 600, epoch: 1 | loss: 0.2893721
	speed: 0.0040s/iter; left time: 31.0453s
	iters: 700, epoch: 1 | loss: 0.2777631
	speed: 0.0040s/iter; left time: 30.5017s
	iters: 800, epoch: 1 | loss: 0.3669033
	speed: 0.0040s/iter; left time: 30.4071s
	iters: 900, epoch: 1 | loss: 1.2912366
	speed: 0.0040s/iter; left time: 29.8273s
	iters: 1000, epoch: 1 | loss: 0.8529151
	speed: 0.0040s/iter; left time: 29.3715s
Updating learning rate to 0.004571389443567936
Validation loss decreased (inf --> 0.3308).  Saving model state dict ...
Epoch: 1 cost time: 4.438071250915527
Epoch: 1, Steps: 1045 | Train Loss: 0.5118409 Vali Loss: 0.3308331 Best vali loss: 0.3308331
	iters: 100, epoch: 2 | loss: 0.5744374
	speed: 0.0118s/iter; left time: 85.2183s
	iters: 200, epoch: 2 | loss: 0.4510019
	speed: 0.0040s/iter; left time: 28.3247s
	iters: 300, epoch: 2 | loss: 1.4286212
	speed: 0.0040s/iter; left time: 27.9011s
	iters: 400, epoch: 2 | loss: 0.2560474
	speed: 0.0040s/iter; left time: 27.4926s
	iters: 500, epoch: 2 | loss: 0.3917710
	speed: 0.0040s/iter; left time: 27.2087s
	iters: 600, epoch: 2 | loss: 0.3510423
	speed: 0.0040s/iter; left time: 26.6411s
	iters: 700, epoch: 2 | loss: 0.3336213
	speed: 0.0039s/iter; left time: 26.0664s
	iters: 800, epoch: 2 | loss: 0.4543673
	speed: 0.0039s/iter; left time: 25.6803s
	iters: 900, epoch: 2 | loss: 0.3974164
	speed: 0.0040s/iter; left time: 25.5312s
	iters: 1000, epoch: 2 | loss: 0.4284029
	speed: 0.0040s/iter; left time: 25.0724s
Updating learning rate to 0.00405630902906528
Validation loss decreased (0.3308 --> 0.3185).  Saving model state dict ...
Epoch: 2 cost time: 4.181847095489502
Epoch: 2, Steps: 1045 | Train Loss: 0.5066729 Vali Loss: 0.3184854 Best vali loss: 0.3184854
	iters: 100, epoch: 3 | loss: 0.5218187
	speed: 0.0117s/iter; left time: 72.3428s
	iters: 200, epoch: 3 | loss: 0.4150171
	speed: 0.0039s/iter; left time: 23.8713s
	iters: 300, epoch: 3 | loss: 0.9690294
	speed: 0.0039s/iter; left time: 23.0639s
	iters: 400, epoch: 3 | loss: 1.6558623
	speed: 0.0037s/iter; left time: 21.8495s
	iters: 500, epoch: 3 | loss: 0.5025417
	speed: 0.0038s/iter; left time: 21.6803s
	iters: 600, epoch: 3 | loss: 0.1748773
	speed: 0.0038s/iter; left time: 21.6971s
	iters: 700, epoch: 3 | loss: 0.4378254
	speed: 0.0039s/iter; left time: 21.6283s
	iters: 800, epoch: 3 | loss: 0.2034405
	speed: 0.0039s/iter; left time: 21.4829s
	iters: 900, epoch: 3 | loss: 0.9535604
	speed: 0.0039s/iter; left time: 20.7878s
	iters: 1000, epoch: 3 | loss: 0.4024890
	speed: 0.0038s/iter; left time: 19.9850s
Updating learning rate to 0.0032854367124844756
Epoch: 3 cost time: 4.063028573989868
Epoch: 3, Steps: 1045 | Train Loss: 0.6236462 Vali Loss: 0.3243983 Best vali loss: 0.3184854
	iters: 100, epoch: 4 | loss: 0.8805507
	speed: 0.0119s/iter; left time: 60.8159s
	iters: 200, epoch: 4 | loss: 0.2304916
	speed: 0.0040s/iter; left time: 20.2250s
	iters: 300, epoch: 4 | loss: 1.2189130
	speed: 0.0040s/iter; left time: 19.7175s
	iters: 400, epoch: 4 | loss: 0.2447292
	speed: 0.0041s/iter; left time: 19.5605s
	iters: 500, epoch: 4 | loss: 0.3212758
	speed: 0.0041s/iter; left time: 19.1871s
	iters: 600, epoch: 4 | loss: 0.2150414
	speed: 0.0040s/iter; left time: 18.6388s
	iters: 700, epoch: 4 | loss: 0.2662271
	speed: 0.0041s/iter; left time: 18.5305s
	iters: 800, epoch: 4 | loss: 0.3402710
	speed: 0.0042s/iter; left time: 18.3854s
	iters: 900, epoch: 4 | loss: 0.5197371
	speed: 0.0041s/iter; left time: 17.8508s
	iters: 1000, epoch: 4 | loss: 0.7653394
	speed: 0.0041s/iter; left time: 17.1893s
Updating learning rate to 0.00237613081605
Epoch: 4 cost time: 4.289912700653076
Epoch: 4, Steps: 1045 | Train Loss: 0.5002576 Vali Loss: 0.3203943 Best vali loss: 0.3184854
	iters: 100, epoch: 5 | loss: 0.5375795
	speed: 0.0116s/iter; left time: 47.2189s
	iters: 200, epoch: 5 | loss: 0.2955514
	speed: 0.0036s/iter; left time: 14.2291s
	iters: 300, epoch: 5 | loss: 1.7561704
	speed: 0.0036s/iter; left time: 13.8637s
	iters: 400, epoch: 5 | loss: 0.6502294
	speed: 0.0039s/iter; left time: 14.5948s
	iters: 500, epoch: 5 | loss: 0.7260339
	speed: 0.0040s/iter; left time: 14.8886s
	iters: 600, epoch: 5 | loss: 0.2301238
	speed: 0.0041s/iter; left time: 14.7420s
	iters: 700, epoch: 5 | loss: 0.3226344
	speed: 0.0041s/iter; left time: 14.2775s
	iters: 800, epoch: 5 | loss: 0.3656297
	speed: 0.0041s/iter; left time: 13.7672s
	iters: 900, epoch: 5 | loss: 0.4315602
	speed: 0.0041s/iter; left time: 13.4737s
	iters: 1000, epoch: 5 | loss: 2.2858419
	speed: 0.0041s/iter; left time: 13.1556s
Updating learning rate to 0.0014668249196155244
Epoch: 5 cost time: 4.131582498550415
Epoch: 5, Steps: 1045 | Train Loss: 0.7601355 Vali Loss: 0.3232416 Best vali loss: 0.3184854
	iters: 100, epoch: 6 | loss: 0.2388668
	speed: 0.0119s/iter; left time: 35.9819s
	iters: 200, epoch: 6 | loss: 0.2612825
	speed: 0.0040s/iter; left time: 11.7191s
	iters: 300, epoch: 6 | loss: 0.6082317
	speed: 0.0040s/iter; left time: 11.2304s
	iters: 400, epoch: 6 | loss: 0.2082910
	speed: 0.0039s/iter; left time: 10.8056s
	iters: 500, epoch: 6 | loss: 0.4999316
	speed: 0.0039s/iter; left time: 10.3101s
	iters: 600, epoch: 6 | loss: 0.3159413
	speed: 0.0039s/iter; left time: 9.8908s
	iters: 700, epoch: 6 | loss: 0.5815279
	speed: 0.0040s/iter; left time: 9.6703s
	iters: 800, epoch: 6 | loss: 0.4256641
	speed: 0.0040s/iter; left time: 9.3457s
	iters: 900, epoch: 6 | loss: 0.3020287
	speed: 0.0040s/iter; left time: 8.9210s
	iters: 1000, epoch: 6 | loss: 0.5058760
	speed: 0.0040s/iter; left time: 8.4865s
Updating learning rate to 0.0006959526030347201
Epoch: 6 cost time: 4.190368413925171
Epoch: 6, Steps: 1045 | Train Loss: 0.3947642 Vali Loss: 0.3217061 Best vali loss: 0.3184854
	iters: 100, epoch: 7 | loss: 0.4242799
	speed: 0.0117s/iter; left time: 23.3567s
	iters: 200, epoch: 7 | loss: 0.5225552
	speed: 0.0040s/iter; left time: 7.6128s
	iters: 300, epoch: 7 | loss: 0.4914043
	speed: 0.0039s/iter; left time: 7.0567s
	iters: 400, epoch: 7 | loss: 0.7771119
	speed: 0.0040s/iter; left time: 6.7351s
	iters: 500, epoch: 7 | loss: 0.5602105
	speed: 0.0039s/iter; left time: 6.2813s
	iters: 600, epoch: 7 | loss: 2.2835970
	speed: 0.0039s/iter; left time: 5.8533s
	iters: 700, epoch: 7 | loss: 0.5575166
	speed: 0.0040s/iter; left time: 5.5943s
	iters: 800, epoch: 7 | loss: 0.6180037
	speed: 0.0040s/iter; left time: 5.1693s
	iters: 900, epoch: 7 | loss: 0.3017716
	speed: 0.0040s/iter; left time: 4.7387s
	iters: 1000, epoch: 7 | loss: 0.6604427
	speed: 0.0040s/iter; left time: 4.3104s
Updating learning rate to 0.00018087218853206374
Epoch: 7 cost time: 4.191308259963989
Epoch: 7, Steps: 1045 | Train Loss: 0.7196893 Vali Loss: 0.3213329 Best vali loss: 0.3184854
	iters: 100, epoch: 8 | loss: 0.9637787
	speed: 0.0116s/iter; left time: 10.9650s
	iters: 200, epoch: 8 | loss: 0.4793125
	speed: 0.0037s/iter; left time: 3.1560s
	iters: 300, epoch: 8 | loss: 0.2747889
	speed: 0.0039s/iter; left time: 2.9083s
	iters: 400, epoch: 8 | loss: 0.3340949
	speed: 0.0040s/iter; left time: 2.5521s
	iters: 500, epoch: 8 | loss: 0.2491577
	speed: 0.0040s/iter; left time: 2.1765s
	iters: 600, epoch: 8 | loss: 0.3119994
	speed: 0.0040s/iter; left time: 1.7841s
	iters: 700, epoch: 8 | loss: 0.2304097
	speed: 0.0039s/iter; left time: 1.3400s
	iters: 800, epoch: 8 | loss: 0.3592985
	speed: 0.0037s/iter; left time: 0.9180s
	iters: 900, epoch: 8 | loss: 1.1815604
	speed: 0.0038s/iter; left time: 0.5618s
	iters: 1000, epoch: 8 | loss: 0.3980464
	speed: 0.0039s/iter; left time: 0.1781s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.07465672492981
Epoch: 8, Steps: 1045 | Train Loss: 0.4782447 Vali Loss: 0.3217598 Best vali loss: 0.3184854

best validation loss 0.3184854230968515

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008268657214, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4570490
	speed: 0.0097s/iter; left time: 9.1965s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.8499724864959717
Epoch: 1, Steps: 131 | Train Loss: 0.4570490 Vali Loss: 0.2781077 Best vali loss: 0.2781077
	iters: 100, epoch: 2 | loss: 0.4421031
	speed: 0.0072s/iter; left time: 5.8879s
Updating learning rate to 0.0001172429579
Epoch: 2 cost time: 0.540499210357666
Epoch: 2, Steps: 131 | Train Loss: 0.4421031 Vali Loss: 0.2829844 Best vali loss: 0.2781077
	iters: 100, epoch: 3 | loss: 0.5402905
	speed: 0.0071s/iter; left time: 4.9048s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.577688455581665
Epoch: 3, Steps: 131 | Train Loss: 0.5402905 Vali Loss: 0.2987414 Best vali loss: 0.2781077

best validation loss 0.27810772184203575

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597151
	speed: 0.0102s/iter; left time: 9.6783s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9278371334075928
Epoch: 1, Steps: 131 | Train Loss: 0.5597151 Vali Loss: 0.2756369 Best vali loss: 0.2756369
	iters: 100, epoch: 2 | loss: 0.3258598
	speed: 0.0089s/iter; left time: 7.2743s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2756 --> 0.2686).  Saving model state dict ...
Epoch: 2 cost time: 0.7027976512908936
Epoch: 2, Steps: 131 | Train Loss: 0.3258598 Vali Loss: 0.2686291 Best vali loss: 0.2686291
	iters: 100, epoch: 3 | loss: 0.4630420
	speed: 0.0089s/iter; left time: 6.0900s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.6980512142181396
Epoch: 3, Steps: 131 | Train Loss: 0.4630420 Vali Loss: 0.2805637 Best vali loss: 0.2686291

best validation loss 0.26862911059316447

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008128328337, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596732
	speed: 0.0110s/iter; left time: 10.4294s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9280388355255127
Epoch: 1, Steps: 131 | Train Loss: 0.5596732 Vali Loss: 0.2756365 Best vali loss: 0.2756365
	iters: 100, epoch: 2 | loss: 0.3271175
	speed: 0.0089s/iter; left time: 7.2836s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2737).  Saving model state dict ...
Epoch: 2 cost time: 0.6987075805664062
Epoch: 2, Steps: 131 | Train Loss: 0.3271175 Vali Loss: 0.2736958 Best vali loss: 0.2736958
	iters: 100, epoch: 3 | loss: 0.4674726
	speed: 0.0088s/iter; left time: 6.0559s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7000703811645508
Epoch: 3, Steps: 131 | Train Loss: 0.4674726 Vali Loss: 0.2850075 Best vali loss: 0.2736958

best validation loss 0.2736958295117971

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4170867
	speed: 0.0112s/iter; left time: 6.2087s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.9158427715301514
Epoch: 4, Steps: 131 | Train Loss: 0.4170867 Vali Loss: 0.3050937 Best vali loss: 0.2686291
	iters: 100, epoch: 5 | loss: 0.2809283
	speed: 0.0085s/iter; left time: 3.6302s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.6933729648590088
Epoch: 5, Steps: 131 | Train Loss: 0.2809283 Vali Loss: 0.2952261 Best vali loss: 0.2686291
	iters: 100, epoch: 6 | loss: 0.4337987
	speed: 0.0086s/iter; left time: 2.5361s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.6993660926818848
Epoch: 6, Steps: 131 | Train Loss: 0.4337987 Vali Loss: 0.2991559 Best vali loss: 0.2686291
	iters: 100, epoch: 7 | loss: 0.4657073
	speed: 0.0087s/iter; left time: 1.4129s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.6967780590057373
Epoch: 7, Steps: 131 | Train Loss: 0.4657073 Vali Loss: 0.2974976 Best vali loss: 0.2686291
	iters: 100, epoch: 8 | loss: 0.3260935
	speed: 0.0086s/iter; left time: 0.2762s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.6996867656707764
Epoch: 8, Steps: 131 | Train Loss: 0.3260935 Vali Loss: 0.2955116 Best vali loss: 0.2686291

best validation loss 0.26862911059316447

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008311510269, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596207
	speed: 0.0104s/iter; left time: 9.8305s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9355814456939697
Epoch: 1, Steps: 131 | Train Loss: 0.5596207 Vali Loss: 0.2756375 Best vali loss: 0.2756375
	iters: 100, epoch: 2 | loss: 0.3229024
	speed: 0.0088s/iter; left time: 7.2056s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2718).  Saving model state dict ...
Epoch: 2 cost time: 0.6982038021087646
Epoch: 2, Steps: 131 | Train Loss: 0.3229024 Vali Loss: 0.2717913 Best vali loss: 0.2717913
	iters: 100, epoch: 3 | loss: 0.4650463
	speed: 0.0090s/iter; left time: 6.1793s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7009429931640625
Epoch: 3, Steps: 131 | Train Loss: 0.4650463 Vali Loss: 0.2783217 Best vali loss: 0.2717913
	iters: 100, epoch: 4 | loss: 0.5025388
	speed: 0.0087s/iter; left time: 4.8633s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.6971595287322998
Epoch: 4, Steps: 131 | Train Loss: 0.5025388 Vali Loss: 0.2823320 Best vali loss: 0.2717913
	iters: 100, epoch: 5 | loss: 0.3415784
	speed: 0.0087s/iter; left time: 3.6900s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.7039237022399902
Epoch: 5, Steps: 131 | Train Loss: 0.3415784 Vali Loss: 0.2911373 Best vali loss: 0.2717913
	iters: 100, epoch: 6 | loss: 0.3111291
	speed: 0.0086s/iter; left time: 2.5293s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.6995031833648682
Epoch: 6, Steps: 131 | Train Loss: 0.3111291 Vali Loss: 0.2904418 Best vali loss: 0.2717913
	iters: 100, epoch: 7 | loss: 0.2871301
	speed: 0.0086s/iter; left time: 1.4078s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.6973223686218262
Epoch: 7, Steps: 131 | Train Loss: 0.2871301 Vali Loss: 0.2976288 Best vali loss: 0.2717913
	iters: 100, epoch: 8 | loss: 0.3423793
	speed: 0.0087s/iter; left time: 0.2768s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7027239799499512
Epoch: 8, Steps: 131 | Train Loss: 0.3423793 Vali Loss: 0.2963420 Best vali loss: 0.2717913

best validation loss 0.2717912574601732

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0015691254301, 'e_layers': 3, 'learning_rate': 0.0008473572064, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0008473572064
Validation loss decreased (inf --> 0.2854).  Saving model state dict ...
Epoch: 1 cost time: 0.9615283012390137
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2853755 Best vali loss: 0.2853755
Updating learning rate to 0.0004236786032
Epoch: 2 cost time: 0.7385082244873047
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2857266 Best vali loss: 0.2853755
Updating learning rate to 0.0002118393016
Validation loss decreased (0.2854 --> 0.2834).  Saving model state dict ...
Epoch: 3 cost time: 0.7341287136077881
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2833805 Best vali loss: 0.2833805
Updating learning rate to 0.0001059196508
Validation loss decreased (0.2834 --> 0.2820).  Saving model state dict ...
Epoch: 4 cost time: 0.7349483966827393
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2819872 Best vali loss: 0.2819872
Updating learning rate to 5.29598254e-05
Epoch: 5 cost time: 0.7384908199310303
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2894037 Best vali loss: 0.2819872
Updating learning rate to 2.64799127e-05
Epoch: 6 cost time: 0.7370612621307373
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2863867 Best vali loss: 0.2819872
Updating learning rate to 1.323995635e-05
Epoch: 7 cost time: 0.7318480014801025
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2846076 Best vali loss: 0.2819872
Updating learning rate to 6.619978175e-06
Epoch: 8 cost time: 0.7376918792724609
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2873501 Best vali loss: 0.2819872

best validation loss 0.28198717292931585

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 1, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4849117
	speed: 0.0084s/iter; left time: 7.9717s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6612863540649414
Epoch: 1, Steps: 131 | Train Loss: 0.4849117 Vali Loss: 0.2780629 Best vali loss: 0.2780629
	iters: 100, epoch: 2 | loss: 0.2554128
	speed: 0.0059s/iter; left time: 4.7941s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2781 --> 0.2768).  Saving model state dict ...
Epoch: 2 cost time: 0.43074774742126465
Epoch: 2, Steps: 131 | Train Loss: 0.2554128 Vali Loss: 0.2767583 Best vali loss: 0.2767583
	iters: 100, epoch: 3 | loss: 0.5301881
	speed: 0.0057s/iter; left time: 3.9062s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.413116455078125
Epoch: 3, Steps: 131 | Train Loss: 0.5301881 Vali Loss: 0.2768310 Best vali loss: 0.2767583

best validation loss 0.2767583466719943

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002309238499, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5593511
	speed: 0.0103s/iter; left time: 9.8090s
Updating learning rate to 0.0002309238499
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9230906963348389
Epoch: 1, Steps: 131 | Train Loss: 0.5593511 Vali Loss: 0.2756192 Best vali loss: 0.2756192
	iters: 100, epoch: 2 | loss: 0.3242017
	speed: 0.0089s/iter; left time: 7.2779s
Updating learning rate to 0.00011546192495
Validation loss decreased (0.2756 --> 0.2714).  Saving model state dict ...
Epoch: 2 cost time: 0.7032558917999268
Epoch: 2, Steps: 131 | Train Loss: 0.3242017 Vali Loss: 0.2714465 Best vali loss: 0.2714465
	iters: 100, epoch: 3 | loss: 0.4632476
	speed: 0.0090s/iter; left time: 6.1639s
Updating learning rate to 5.7730962475e-05
Epoch: 3 cost time: 0.7103743553161621
Epoch: 3, Steps: 131 | Train Loss: 0.4632476 Vali Loss: 0.2787597 Best vali loss: 0.2714465

best validation loss 0.2714465352938316

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0021089990006, 'e_layers': 1, 'learning_rate': 0.0001821272917, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4956895
	speed: 0.0077s/iter; left time: 63.4679s
	iters: 200, epoch: 1 | loss: 1.2420388
	speed: 0.0024s/iter; left time: 19.2681s
	iters: 300, epoch: 1 | loss: 0.3174727
	speed: 0.0024s/iter; left time: 19.6264s
	iters: 400, epoch: 1 | loss: 0.4856368
	speed: 0.0023s/iter; left time: 18.1798s
	iters: 500, epoch: 1 | loss: 0.3942396
	speed: 0.0022s/iter; left time: 17.6108s
	iters: 600, epoch: 1 | loss: 0.2118283
	speed: 0.0023s/iter; left time: 17.6294s
	iters: 700, epoch: 1 | loss: 0.2637145
	speed: 0.0023s/iter; left time: 17.7868s
	iters: 800, epoch: 1 | loss: 0.3094356
	speed: 0.0023s/iter; left time: 17.3309s
	iters: 900, epoch: 1 | loss: 1.1459860
	speed: 0.0023s/iter; left time: 17.0545s
	iters: 1000, epoch: 1 | loss: 0.2771780
	speed: 0.0023s/iter; left time: 16.7240s
Updating learning rate to 0.0001821272917
Validation loss decreased (inf --> 0.2917).  Saving model state dict ...
Epoch: 1 cost time: 2.6787021160125732
Epoch: 1, Steps: 1045 | Train Loss: 0.5143220 Vali Loss: 0.2916612 Best vali loss: 0.2916612
	iters: 100, epoch: 2 | loss: 0.9709590
	speed: 0.0075s/iter; left time: 54.1272s
	iters: 200, epoch: 2 | loss: 0.9600559
	speed: 0.0022s/iter; left time: 15.3483s
	iters: 300, epoch: 2 | loss: 0.3486868
	speed: 0.0021s/iter; left time: 14.4463s
	iters: 400, epoch: 2 | loss: 0.5366021
	speed: 0.0021s/iter; left time: 14.8272s
	iters: 500, epoch: 2 | loss: 0.5769027
	speed: 0.0023s/iter; left time: 15.4693s
	iters: 600, epoch: 2 | loss: 0.2500530
	speed: 0.0022s/iter; left time: 14.9326s
	iters: 700, epoch: 2 | loss: 2.4409311
	speed: 0.0022s/iter; left time: 14.5416s
	iters: 800, epoch: 2 | loss: 0.3408021
	speed: 0.0022s/iter; left time: 14.0539s
	iters: 900, epoch: 2 | loss: 0.7659366
	speed: 0.0022s/iter; left time: 14.3831s
	iters: 1000, epoch: 2 | loss: 0.5462648
	speed: 0.0021s/iter; left time: 13.2638s
Updating learning rate to 9.106364585e-05
Validation loss decreased (0.2917 --> 0.2883).  Saving model state dict ...
Epoch: 2 cost time: 2.282334804534912
Epoch: 2, Steps: 1045 | Train Loss: 0.7737194 Vali Loss: 0.2883182 Best vali loss: 0.2883182
	iters: 100, epoch: 3 | loss: 0.2418539
	speed: 0.0075s/iter; left time: 46.2003s
	iters: 200, epoch: 3 | loss: 0.3687418
	speed: 0.0020s/iter; left time: 12.1385s
	iters: 300, epoch: 3 | loss: 1.3628752
	speed: 0.0020s/iter; left time: 11.8914s
	iters: 400, epoch: 3 | loss: 0.2073645
	speed: 0.0020s/iter; left time: 11.7262s
	iters: 500, epoch: 3 | loss: 0.8353143
	speed: 0.0020s/iter; left time: 11.6800s
	iters: 600, epoch: 3 | loss: 0.2300793
	speed: 0.0021s/iter; left time: 12.0222s
	iters: 700, epoch: 3 | loss: 0.2842646
	speed: 0.0021s/iter; left time: 11.8153s
	iters: 800, epoch: 3 | loss: 0.4337457
	speed: 0.0021s/iter; left time: 11.5998s
	iters: 900, epoch: 3 | loss: 0.6893642
	speed: 0.0022s/iter; left time: 11.5918s
	iters: 1000, epoch: 3 | loss: 0.3280716
	speed: 0.0022s/iter; left time: 11.3591s
Updating learning rate to 4.5531822925e-05
Epoch: 3 cost time: 2.2010626792907715
Epoch: 3, Steps: 1045 | Train Loss: 0.4981675 Vali Loss: 0.2954262 Best vali loss: 0.2883182

best validation loss 0.2883181633305133

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002309238499, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4250885
	speed: 0.0107s/iter; left time: 5.9565s
Updating learning rate to 2.88654812375e-05
Epoch: 4 cost time: 0.921698808670044
Epoch: 4, Steps: 131 | Train Loss: 0.4250885 Vali Loss: 0.3099404 Best vali loss: 0.2714465
	iters: 100, epoch: 5 | loss: 0.2818852
	speed: 0.0086s/iter; left time: 3.6557s
Updating learning rate to 1.443274061875e-05
Epoch: 5 cost time: 0.6970548629760742
Epoch: 5, Steps: 131 | Train Loss: 0.2818852 Vali Loss: 0.2976797 Best vali loss: 0.2714465
	iters: 100, epoch: 6 | loss: 0.4348220
	speed: 0.0087s/iter; left time: 2.5460s
Updating learning rate to 7.216370309375e-06
Epoch: 6 cost time: 0.7051565647125244
Epoch: 6, Steps: 131 | Train Loss: 0.4348220 Vali Loss: 0.3027730 Best vali loss: 0.2714465
	iters: 100, epoch: 7 | loss: 0.4643853
	speed: 0.0085s/iter; left time: 1.3867s
Updating learning rate to 3.6081851546875e-06
Epoch: 7 cost time: 0.6948111057281494
Epoch: 7, Steps: 131 | Train Loss: 0.4643853 Vali Loss: 0.3013840 Best vali loss: 0.2714465
	iters: 100, epoch: 8 | loss: 0.3298032
	speed: 0.0085s/iter; left time: 0.2731s
Updating learning rate to 1.80409257734375e-06
Epoch: 8 cost time: 0.6933274269104004
Epoch: 8, Steps: 131 | Train Loss: 0.3298032 Vali Loss: 0.2986254 Best vali loss: 0.2714465

best validation loss 0.2714465352938316

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001027127088, 'e_layers': 4, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4539912
	speed: 0.0149s/iter; left time: 14.1074s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.5101101398468018
Epoch: 1, Steps: 131 | Train Loss: 0.4539912 Vali Loss: 0.2814006 Best vali loss: 0.2814006
	iters: 100, epoch: 2 | loss: 0.4814742
	speed: 0.0155s/iter; left time: 12.6715s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 1.2914540767669678
Epoch: 2, Steps: 131 | Train Loss: 0.4814742 Vali Loss: 0.3019320 Best vali loss: 0.2814006
	iters: 100, epoch: 3 | loss: 0.3993775
	speed: 0.0151s/iter; left time: 10.3718s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2814 --> 0.2802).  Saving model state dict ...
Epoch: 3 cost time: 1.2937238216400146
Epoch: 3, Steps: 131 | Train Loss: 0.3993775 Vali Loss: 0.2801964 Best vali loss: 0.2801964
	iters: 100, epoch: 4 | loss: 0.3789878
	speed: 0.0158s/iter; left time: 8.8043s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 1.2990360260009766
Epoch: 4, Steps: 131 | Train Loss: 0.3789878 Vali Loss: 0.2819035 Best vali loss: 0.2801964
	iters: 100, epoch: 5 | loss: 0.4579745
	speed: 0.0151s/iter; left time: 6.4248s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 1.2892680168151855
Epoch: 5, Steps: 131 | Train Loss: 0.4579745 Vali Loss: 0.2979873 Best vali loss: 0.2801964
	iters: 100, epoch: 6 | loss: 0.4859374
	speed: 0.0151s/iter; left time: 4.4349s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 1.2880918979644775
Epoch: 6, Steps: 131 | Train Loss: 0.4859374 Vali Loss: 0.2857116 Best vali loss: 0.2801964
	iters: 100, epoch: 7 | loss: 0.3839990
	speed: 0.0151s/iter; left time: 2.4644s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 1.2952861785888672
Epoch: 7, Steps: 131 | Train Loss: 0.3839990 Vali Loss: 0.2886259 Best vali loss: 0.2801964
	iters: 100, epoch: 8 | loss: 0.3686480
	speed: 0.0152s/iter; left time: 0.4877s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.297576665878296
Epoch: 8, Steps: 131 | Train Loss: 0.3686480 Vali Loss: 0.2936999 Best vali loss: 0.2801964

best validation loss 0.2801964052933084

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010263613921, 'e_layers': 2, 'learning_rate': 0.0002301158375, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5592871
	speed: 0.0104s/iter; left time: 9.8995s
Updating learning rate to 0.0002301158375
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9258904457092285
Epoch: 1, Steps: 131 | Train Loss: 0.5592871 Vali Loss: 0.2756166 Best vali loss: 0.2756166
	iters: 100, epoch: 2 | loss: 0.3245486
	speed: 0.0089s/iter; left time: 7.2867s
Updating learning rate to 0.00011505791875
Validation loss decreased (0.2756 --> 0.2718).  Saving model state dict ...
Epoch: 2 cost time: 0.7001068592071533
Epoch: 2, Steps: 131 | Train Loss: 0.3245486 Vali Loss: 0.2718168 Best vali loss: 0.2718168
	iters: 100, epoch: 3 | loss: 0.4617549
	speed: 0.0088s/iter; left time: 6.0544s
Updating learning rate to 5.7528959375e-05
Epoch: 3 cost time: 0.7047858238220215
Epoch: 3, Steps: 131 | Train Loss: 0.4617549 Vali Loss: 0.2793144 Best vali loss: 0.2718168
	iters: 100, epoch: 4 | loss: 0.5031669
	speed: 0.0088s/iter; left time: 4.8707s
Updating learning rate to 2.87644796875e-05
Epoch: 4 cost time: 0.7025778293609619
Epoch: 4, Steps: 131 | Train Loss: 0.5031669 Vali Loss: 0.2913034 Best vali loss: 0.2718168
	iters: 100, epoch: 5 | loss: 0.3379248
	speed: 0.0086s/iter; left time: 3.6698s
Updating learning rate to 1.438223984375e-05
Epoch: 5 cost time: 0.6961178779602051
Epoch: 5, Steps: 131 | Train Loss: 0.3379248 Vali Loss: 0.2915811 Best vali loss: 0.2718168
	iters: 100, epoch: 6 | loss: 0.3194074
	speed: 0.0086s/iter; left time: 2.5245s
Updating learning rate to 7.191119921875e-06
Epoch: 6 cost time: 0.6972694396972656
Epoch: 6, Steps: 131 | Train Loss: 0.3194074 Vali Loss: 0.2887324 Best vali loss: 0.2718168
	iters: 100, epoch: 7 | loss: 0.3117017
	speed: 0.0086s/iter; left time: 1.4056s
Updating learning rate to 3.5955599609375e-06
Epoch: 7 cost time: 0.6981461048126221
Epoch: 7, Steps: 131 | Train Loss: 0.3117017 Vali Loss: 0.2950551 Best vali loss: 0.2718168
	iters: 100, epoch: 8 | loss: 0.3963171
	speed: 0.0086s/iter; left time: 0.2750s
Updating learning rate to 1.79777998046875e-06
Epoch: 8 cost time: 0.7022902965545654
Epoch: 8, Steps: 131 | Train Loss: 0.3963171 Vali Loss: 0.2951461 Best vali loss: 0.2718168

best validation loss 0.27181675567995794

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009517490728, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596273
	speed: 0.0105s/iter; left time: 9.9980s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9328062534332275
Epoch: 1, Steps: 131 | Train Loss: 0.5596273 Vali Loss: 0.2756482 Best vali loss: 0.2756482
	iters: 100, epoch: 2 | loss: 0.3232666
	speed: 0.0090s/iter; left time: 7.3415s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.7019200325012207
Epoch: 2, Steps: 131 | Train Loss: 0.3232666 Vali Loss: 0.2722878 Best vali loss: 0.2722878
	iters: 100, epoch: 3 | loss: 0.4625665
	speed: 0.0090s/iter; left time: 6.1647s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7017998695373535
Epoch: 3, Steps: 131 | Train Loss: 0.4625665 Vali Loss: 0.2766355 Best vali loss: 0.2722878

best validation loss 0.2722877769188262

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267537983, 'e_layers': 2, 'learning_rate': 7.39760992e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5564103
	speed: 0.0104s/iter; left time: 9.8443s
Updating learning rate to 7.39760992e-05
Validation loss decreased (inf --> 0.2765).  Saving model state dict ...
Epoch: 1 cost time: 0.9219868183135986
Epoch: 1, Steps: 131 | Train Loss: 0.5564103 Vali Loss: 0.2765002 Best vali loss: 0.2765002
	iters: 100, epoch: 2 | loss: 0.3290419
	speed: 0.0089s/iter; left time: 7.2698s
Updating learning rate to 3.69880496e-05
Epoch: 2 cost time: 0.7048346996307373
Epoch: 2, Steps: 131 | Train Loss: 0.3290419 Vali Loss: 0.2770429 Best vali loss: 0.2765002
	iters: 100, epoch: 3 | loss: 0.4870300
	speed: 0.0086s/iter; left time: 5.9048s
Updating learning rate to 1.84940248e-05
Validation loss decreased (0.2765 --> 0.2743).  Saving model state dict ...
Epoch: 3 cost time: 0.6945881843566895
Epoch: 3, Steps: 131 | Train Loss: 0.4870300 Vali Loss: 0.2742834 Best vali loss: 0.2742834

best validation loss 0.2742833635673154

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5896338
	speed: 0.0095s/iter; left time: 8.9866s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.7880401611328125
Epoch: 1, Steps: 131 | Train Loss: 0.5896338 Vali Loss: 0.2828962 Best vali loss: 0.2828962
	iters: 100, epoch: 2 | loss: 0.6393028
	speed: 0.0067s/iter; left time: 5.5178s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2829 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.5349600315093994
Epoch: 2, Steps: 131 | Train Loss: 0.6393028 Vali Loss: 0.2826451 Best vali loss: 0.2826451
	iters: 100, epoch: 3 | loss: 0.5797235
	speed: 0.0068s/iter; left time: 4.6379s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2826 --> 0.2799).  Saving model state dict ...
Epoch: 3 cost time: 0.5332045555114746
Epoch: 3, Steps: 131 | Train Loss: 0.5797235 Vali Loss: 0.2799454 Best vali loss: 0.2799454

best validation loss 0.27994541590565775

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009517490728, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4056838
	speed: 0.0108s/iter; left time: 5.9882s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.9394621849060059
Epoch: 4, Steps: 131 | Train Loss: 0.4056838 Vali Loss: 0.2920659 Best vali loss: 0.2722878
	iters: 100, epoch: 5 | loss: 0.2709879
	speed: 0.0087s/iter; left time: 3.7036s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.7066659927368164
Epoch: 5, Steps: 131 | Train Loss: 0.2709879 Vali Loss: 0.2911220 Best vali loss: 0.2722878
	iters: 100, epoch: 6 | loss: 0.3795151
	speed: 0.0087s/iter; left time: 2.5532s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7021574974060059
Epoch: 6, Steps: 131 | Train Loss: 0.3795151 Vali Loss: 0.2963788 Best vali loss: 0.2722878
	iters: 100, epoch: 7 | loss: 0.3933592
	speed: 0.0089s/iter; left time: 1.4432s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.7072455883026123
Epoch: 7, Steps: 131 | Train Loss: 0.3933592 Vali Loss: 0.3050548 Best vali loss: 0.2722878
	iters: 100, epoch: 8 | loss: 0.2979009
	speed: 0.0086s/iter; left time: 0.2755s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6942064762115479
Epoch: 8, Steps: 131 | Train Loss: 0.2979009 Vali Loss: 0.3057602 Best vali loss: 0.2722878

best validation loss 0.2722877769188262

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270332488, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597138
	speed: 0.0104s/iter; left time: 9.8778s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9311716556549072
Epoch: 1, Steps: 131 | Train Loss: 0.5597138 Vali Loss: 0.2756413 Best vali loss: 0.2756413
	iters: 100, epoch: 2 | loss: 0.3244491
	speed: 0.0089s/iter; left time: 7.2685s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2719).  Saving model state dict ...
Epoch: 2 cost time: 0.6981222629547119
Epoch: 2, Steps: 131 | Train Loss: 0.3244491 Vali Loss: 0.2719283 Best vali loss: 0.2719283
	iters: 100, epoch: 3 | loss: 0.4647857
	speed: 0.0090s/iter; left time: 6.1759s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7062768936157227
Epoch: 3, Steps: 131 | Train Loss: 0.4647857 Vali Loss: 0.2739589 Best vali loss: 0.2719283
	iters: 100, epoch: 4 | loss: 0.5097596
	speed: 0.0086s/iter; left time: 4.7699s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6981620788574219
Epoch: 4, Steps: 131 | Train Loss: 0.5097596 Vali Loss: 0.2897725 Best vali loss: 0.2719283
	iters: 100, epoch: 5 | loss: 0.3360296
	speed: 0.0086s/iter; left time: 3.6381s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6944806575775146
Epoch: 5, Steps: 131 | Train Loss: 0.3360296 Vali Loss: 0.2885277 Best vali loss: 0.2719283
	iters: 100, epoch: 6 | loss: 0.3198990
	speed: 0.0086s/iter; left time: 2.5158s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6966028213500977
Epoch: 6, Steps: 131 | Train Loss: 0.3198990 Vali Loss: 0.2900214 Best vali loss: 0.2719283
	iters: 100, epoch: 7 | loss: 0.3122242
	speed: 0.0086s/iter; left time: 1.3979s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6962482929229736
Epoch: 7, Steps: 131 | Train Loss: 0.3122242 Vali Loss: 0.2975507 Best vali loss: 0.2719283
	iters: 100, epoch: 8 | loss: 0.3963172
	speed: 0.0086s/iter; left time: 0.2766s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6961641311645508
Epoch: 8, Steps: 131 | Train Loss: 0.3963172 Vali Loss: 0.2958996 Best vali loss: 0.2719283

best validation loss 0.2719283360404656

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5896341
	speed: 0.0094s/iter; left time: 8.9102s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.7885255813598633
Epoch: 1, Steps: 131 | Train Loss: 0.5896341 Vali Loss: 0.2829013 Best vali loss: 0.2829013
	iters: 100, epoch: 2 | loss: 0.6393856
	speed: 0.0068s/iter; left time: 5.5732s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2829 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.5413374900817871
Epoch: 2, Steps: 131 | Train Loss: 0.6393856 Vali Loss: 0.2826204 Best vali loss: 0.2826204
	iters: 100, epoch: 3 | loss: 0.5793195
	speed: 0.0067s/iter; left time: 4.5799s
Updating learning rate to 5.8620599525e-05
Validation loss decreased (0.2826 --> 0.2799).  Saving model state dict ...
Epoch: 3 cost time: 0.5107583999633789
Epoch: 3, Steps: 131 | Train Loss: 0.5793195 Vali Loss: 0.2799280 Best vali loss: 0.2799280
	iters: 100, epoch: 4 | loss: 0.5309698
	speed: 0.0067s/iter; left time: 3.7498s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.5353562831878662
Epoch: 4, Steps: 131 | Train Loss: 0.5309698 Vali Loss: 0.2813560 Best vali loss: 0.2799280
	iters: 100, epoch: 5 | loss: 0.4312478
	speed: 0.0067s/iter; left time: 2.8592s
Updating learning rate to 1.465514988125e-05
Validation loss decreased (0.2799 --> 0.2784).  Saving model state dict ...
Epoch: 5 cost time: 0.5504684448242188
Epoch: 5, Steps: 131 | Train Loss: 0.4312478 Vali Loss: 0.2784282 Best vali loss: 0.2784282
	iters: 100, epoch: 6 | loss: 0.3338062
	speed: 0.0068s/iter; left time: 2.0122s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.5343432426452637
Epoch: 6, Steps: 131 | Train Loss: 0.3338062 Vali Loss: 0.2790854 Best vali loss: 0.2784282
	iters: 100, epoch: 7 | loss: 0.3639835
	speed: 0.0069s/iter; left time: 1.1210s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.5487833023071289
Epoch: 7, Steps: 131 | Train Loss: 0.3639835 Vali Loss: 0.2785810 Best vali loss: 0.2784282
	iters: 100, epoch: 8 | loss: 0.3482680
	speed: 0.0068s/iter; left time: 0.2175s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.5487747192382812
Epoch: 8, Steps: 131 | Train Loss: 0.3482680 Vali Loss: 0.2791874 Best vali loss: 0.2784282

best validation loss 0.2784282214393754

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0013546169955, 'e_layers': 2, 'learning_rate': 0.0008314527275, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4823776
	speed: 0.0091s/iter; left time: 8.6254s
Updating learning rate to 0.0008314527275
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 0.7672469615936279
Epoch: 1, Steps: 131 | Train Loss: 0.4823776 Vali Loss: 0.2802120 Best vali loss: 0.2802120
	iters: 100, epoch: 2 | loss: 0.6150177
	speed: 0.0064s/iter; left time: 5.2350s
Updating learning rate to 0.00041572636375
Epoch: 2 cost time: 0.5019466876983643
Epoch: 2, Steps: 131 | Train Loss: 0.6150177 Vali Loss: 0.2845808 Best vali loss: 0.2802120
	iters: 100, epoch: 3 | loss: 0.3594268
	speed: 0.0062s/iter; left time: 4.2870s
Updating learning rate to 0.000207863181875
Epoch: 3 cost time: 0.4961109161376953
Epoch: 3, Steps: 131 | Train Loss: 0.3594268 Vali Loss: 0.2905290 Best vali loss: 0.2802120

best validation loss 0.28021204739797956

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010478963409, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597264
	speed: 0.0105s/iter; left time: 9.9521s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9435811042785645
Epoch: 1, Steps: 131 | Train Loss: 0.5597264 Vali Loss: 0.2756482 Best vali loss: 0.2756482
	iters: 100, epoch: 2 | loss: 0.3246625
	speed: 0.0088s/iter; left time: 7.2337s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2708).  Saving model state dict ...
Epoch: 2 cost time: 0.7005982398986816
Epoch: 2, Steps: 131 | Train Loss: 0.3246625 Vali Loss: 0.2708036 Best vali loss: 0.2708036
	iters: 100, epoch: 3 | loss: 0.4620632
	speed: 0.0090s/iter; left time: 6.2106s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7055752277374268
Epoch: 3, Steps: 131 | Train Loss: 0.4620632 Vali Loss: 0.2798698 Best vali loss: 0.2708036

best validation loss 0.2708036282462407

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010497804972, 'e_layers': 2, 'learning_rate': 0.0002345527656, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597226
	speed: 0.0104s/iter; left time: 9.8415s
Updating learning rate to 0.0002345527656
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9347562789916992
Epoch: 1, Steps: 131 | Train Loss: 0.5597226 Vali Loss: 0.2756497 Best vali loss: 0.2756497
	iters: 100, epoch: 2 | loss: 0.3273937
	speed: 0.0090s/iter; left time: 7.3702s
Updating learning rate to 0.0001172763828
Epoch: 2 cost time: 0.711871862411499
Epoch: 2, Steps: 131 | Train Loss: 0.3273937 Vali Loss: 0.2761268 Best vali loss: 0.2756497
	iters: 100, epoch: 3 | loss: 0.4619906
	speed: 0.0087s/iter; left time: 5.9457s
Updating learning rate to 5.86381914e-05
Epoch: 3 cost time: 0.6961467266082764
Epoch: 3, Steps: 131 | Train Loss: 0.4619906 Vali Loss: 0.2804667 Best vali loss: 0.2756497

best validation loss 0.27564967179019106

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010478963409, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4244432
	speed: 0.0105s/iter; left time: 5.8411s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9271979331970215
Epoch: 4, Steps: 131 | Train Loss: 0.4244432 Vali Loss: 0.3118448 Best vali loss: 0.2708036
	iters: 100, epoch: 5 | loss: 0.2826051
	speed: 0.0087s/iter; left time: 3.6856s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7004249095916748
Epoch: 5, Steps: 131 | Train Loss: 0.2826051 Vali Loss: 0.3010266 Best vali loss: 0.2708036
	iters: 100, epoch: 6 | loss: 0.4358599
	speed: 0.0087s/iter; left time: 2.5515s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6994552612304688
Epoch: 6, Steps: 131 | Train Loss: 0.4358599 Vali Loss: 0.3037507 Best vali loss: 0.2708036
	iters: 100, epoch: 7 | loss: 0.4656895
	speed: 0.0087s/iter; left time: 1.4148s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7003905773162842
Epoch: 7, Steps: 131 | Train Loss: 0.4656895 Vali Loss: 0.3017631 Best vali loss: 0.2708036
	iters: 100, epoch: 8 | loss: 0.3256219
	speed: 0.0086s/iter; left time: 0.2754s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.700251579284668
Epoch: 8, Steps: 131 | Train Loss: 0.3256219 Vali Loss: 0.2987607 Best vali loss: 0.2708036

best validation loss 0.2708036282462407

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002345024842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597193
	speed: 0.0102s/iter; left time: 9.7006s
Updating learning rate to 0.0002345024842
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9233601093292236
Epoch: 1, Steps: 131 | Train Loss: 0.5597193 Vali Loss: 0.2756360 Best vali loss: 0.2756360
	iters: 100, epoch: 2 | loss: 0.3266651
	speed: 0.0089s/iter; left time: 7.2439s
Updating learning rate to 0.0001172512421
Validation loss decreased (0.2756 --> 0.2700).  Saving model state dict ...
Epoch: 2 cost time: 0.7019939422607422
Epoch: 2, Steps: 131 | Train Loss: 0.3266651 Vali Loss: 0.2700237 Best vali loss: 0.2700237
	iters: 100, epoch: 3 | loss: 0.4656844
	speed: 0.0089s/iter; left time: 6.1301s
Updating learning rate to 5.862562105e-05
Epoch: 3 cost time: 0.7042734622955322
Epoch: 3, Steps: 131 | Train Loss: 0.4656844 Vali Loss: 0.2800675 Best vali loss: 0.2700237
	iters: 100, epoch: 4 | loss: 0.5039247
	speed: 0.0087s/iter; left time: 4.8212s
Updating learning rate to 2.9312810525e-05
Epoch: 4 cost time: 0.6994774341583252
Epoch: 4, Steps: 131 | Train Loss: 0.5039247 Vali Loss: 0.2856933 Best vali loss: 0.2700237
	iters: 100, epoch: 5 | loss: 0.3325627
	speed: 0.0086s/iter; left time: 3.6348s
Updating learning rate to 1.46564052625e-05
Epoch: 5 cost time: 0.695728063583374
Epoch: 5, Steps: 131 | Train Loss: 0.3325627 Vali Loss: 0.2855174 Best vali loss: 0.2700237
	iters: 100, epoch: 6 | loss: 0.3183358
	speed: 0.0087s/iter; left time: 2.5626s
Updating learning rate to 7.32820263125e-06
Epoch: 6 cost time: 0.7038116455078125
Epoch: 6, Steps: 131 | Train Loss: 0.3183358 Vali Loss: 0.2872208 Best vali loss: 0.2700237
	iters: 100, epoch: 7 | loss: 0.3111995
	speed: 0.0087s/iter; left time: 1.4147s
Updating learning rate to 3.664101315625e-06
Epoch: 7 cost time: 0.7074527740478516
Epoch: 7, Steps: 131 | Train Loss: 0.3111995 Vali Loss: 0.2912092 Best vali loss: 0.2700237
	iters: 100, epoch: 8 | loss: 0.3953404
	speed: 0.0087s/iter; left time: 0.2787s
Updating learning rate to 1.8320506578125e-06
Epoch: 8 cost time: 0.7081766128540039
Epoch: 8, Steps: 131 | Train Loss: 0.3953404 Vali Loss: 0.2935685 Best vali loss: 0.2700237

best validation loss 0.2700237148355134

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.001036478383, 'e_layers': 2, 'learning_rate': 0.0003115727225, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002997141918532845
Validation loss decreased (inf --> 0.2810).  Saving model state dict ...
Epoch: 1 cost time: 0.5579113960266113
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2809777 Best vali loss: 0.2809777
Updating learning rate to 0.0002659439537062522
Validation loss decreased (0.2810 --> 0.2807).  Saving model state dict ...
Epoch: 2 cost time: 0.33855462074279785
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2807026 Best vali loss: 0.2807026
Updating learning rate to 0.00021540322068881783
Validation loss decreased (0.2807 --> 0.2764).  Saving model state dict ...
Epoch: 3 cost time: 0.34140563011169434
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2763664 Best vali loss: 0.2763664
Updating learning rate to 0.00015578636125
Epoch: 4 cost time: 0.3357048034667969
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2765728 Best vali loss: 0.2763664
Updating learning rate to 9.61695018111822e-05
Epoch: 5 cost time: 0.32207536697387695
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2862737 Best vali loss: 0.2763664
Updating learning rate to 4.562876879374782e-05
Epoch: 6 cost time: 0.33137989044189453
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2847796 Best vali loss: 0.2763664
Updating learning rate to 1.1858530646715565e-05
Epoch: 7 cost time: 0.30948519706726074
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2832410 Best vali loss: 0.2763664
Updating learning rate to 0.0
Epoch: 8 cost time: 0.326427698135376
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2848328 Best vali loss: 0.2763664

best validation loss 0.2763663870322301

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0111828143683, 'e_layers': 2, 'learning_rate': 0.0002345586581, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5604937
	speed: 0.0105s/iter; left time: 9.9634s
Updating learning rate to 0.0002345586581
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9282939434051514
Epoch: 1, Steps: 131 | Train Loss: 0.5604937 Vali Loss: 0.2757986 Best vali loss: 0.2757986
	iters: 100, epoch: 2 | loss: 0.3267939
	speed: 0.0089s/iter; left time: 7.3030s
Updating learning rate to 0.00011727932905
Epoch: 2 cost time: 0.6992321014404297
Epoch: 2, Steps: 131 | Train Loss: 0.3267939 Vali Loss: 0.2785469 Best vali loss: 0.2757986
	iters: 100, epoch: 3 | loss: 0.4682703
	speed: 0.0086s/iter; left time: 5.8919s
Updating learning rate to 5.8639664525e-05
Epoch: 3 cost time: 0.6947910785675049
Epoch: 3, Steps: 131 | Train Loss: 0.4682703 Vali Loss: 0.2812521 Best vali loss: 0.2757986

best validation loss 0.2757985675454627

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.001324244122, 'e_layers': 2, 'learning_rate': 0.0001358332017, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3341142
	speed: 0.0086s/iter; left time: 34.9823s
	iters: 200, epoch: 1 | loss: 0.3035858
	speed: 0.0032s/iter; left time: 12.8336s
	iters: 300, epoch: 1 | loss: 1.0368747
	speed: 0.0032s/iter; left time: 12.3867s
	iters: 400, epoch: 1 | loss: 0.6607400
	speed: 0.0031s/iter; left time: 11.7234s
	iters: 500, epoch: 1 | loss: 0.6468385
	speed: 0.0032s/iter; left time: 11.6934s
Updating learning rate to 0.00013066335829305364
Validation loss decreased (inf --> 0.2871).  Saving model state dict ...
Epoch: 1 cost time: 1.932593584060669
Epoch: 1, Steps: 523 | Train Loss: 0.5964306 Vali Loss: 0.2870592 Best vali loss: 0.2870592
	iters: 100, epoch: 2 | loss: 0.3347207
	speed: 0.0072s/iter; left time: 25.6678s
	iters: 200, epoch: 2 | loss: 0.2920516
	speed: 0.0033s/iter; left time: 11.5128s
	iters: 300, epoch: 2 | loss: 0.3701494
	speed: 0.0033s/iter; left time: 11.2056s
	iters: 400, epoch: 2 | loss: 1.0580235
	speed: 0.0033s/iter; left time: 10.9122s
	iters: 500, epoch: 2 | loss: 0.8209034
	speed: 0.0034s/iter; left time: 10.6762s
Updating learning rate to 0.00011594088986617503
Validation loss decreased (0.2871 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 1.784175157546997
Epoch: 2, Steps: 523 | Train Loss: 0.5751697 Vali Loss: 0.2824932 Best vali loss: 0.2824932
	iters: 100, epoch: 3 | loss: 0.2946813
	speed: 0.0071s/iter; left time: 21.6904s
	iters: 200, epoch: 3 | loss: 0.7657357
	speed: 0.0034s/iter; left time: 9.9145s
	iters: 300, epoch: 3 | loss: 0.3539477
	speed: 0.0034s/iter; left time: 9.6051s
	iters: 400, epoch: 3 | loss: 0.3698595
	speed: 0.0034s/iter; left time: 9.1962s
	iters: 500, epoch: 3 | loss: 0.2292673
	speed: 0.0033s/iter; left time: 8.7151s
Updating learning rate to 9.390715877784777e-05
Validation loss decreased (0.2825 --> 0.2814).  Saving model state dict ...
Epoch: 3 cost time: 1.7889220714569092
Epoch: 3, Steps: 523 | Train Loss: 0.4026983 Vali Loss: 0.2814205 Best vali loss: 0.2814205

best validation loss 0.2814204805278122

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6367126
	speed: 0.0106s/iter; left time: 10.0545s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 0.9378089904785156
Epoch: 1, Steps: 131 | Train Loss: 0.6367126 Vali Loss: 0.2798126 Best vali loss: 0.2798126
	iters: 100, epoch: 2 | loss: 0.3941064
	speed: 0.0089s/iter; left time: 7.2643s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.7023253440856934
Epoch: 2, Steps: 131 | Train Loss: 0.3941064 Vali Loss: 0.2819437 Best vali loss: 0.2798126
	iters: 100, epoch: 3 | loss: 0.7473517
	speed: 0.0086s/iter; left time: 5.9334s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7034566402435303
Epoch: 3, Steps: 131 | Train Loss: 0.7473517 Vali Loss: 0.2840407 Best vali loss: 0.2798126

best validation loss 0.2798125553237501

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0111828143683, 'e_layers': 2, 'learning_rate': 0.0002345586581, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4211203
	speed: 0.0107s/iter; left time: 5.9697s
Updating learning rate to 2.93198322625e-05
Epoch: 4 cost time: 0.9330604076385498
Epoch: 4, Steps: 131 | Train Loss: 0.4211203 Vali Loss: 0.2995079 Best vali loss: 0.2757986
	iters: 100, epoch: 5 | loss: 0.2855057
	speed: 0.0088s/iter; left time: 3.7215s
Updating learning rate to 1.465991613125e-05
Epoch: 5 cost time: 0.703998327255249
Epoch: 5, Steps: 131 | Train Loss: 0.2855057 Vali Loss: 0.2962553 Best vali loss: 0.2757986
	iters: 100, epoch: 6 | loss: 0.4410522
	speed: 0.0087s/iter; left time: 2.5620s
Updating learning rate to 7.329958065625e-06
Epoch: 6 cost time: 0.7007384300231934
Epoch: 6, Steps: 131 | Train Loss: 0.4410522 Vali Loss: 0.2957771 Best vali loss: 0.2757986
	iters: 100, epoch: 7 | loss: 0.4690670
	speed: 0.0086s/iter; left time: 1.4046s
Updating learning rate to 3.6649790328125e-06
Epoch: 7 cost time: 0.698488712310791
Epoch: 7, Steps: 131 | Train Loss: 0.4690670 Vali Loss: 0.2954844 Best vali loss: 0.2757986
	iters: 100, epoch: 8 | loss: 0.3316128
	speed: 0.0086s/iter; left time: 0.2753s
Updating learning rate to 1.83248951640625e-06
Epoch: 8 cost time: 0.6967387199401855
Epoch: 8, Steps: 131 | Train Loss: 0.3316128 Vali Loss: 0.2935183 Best vali loss: 0.2757986

best validation loss 0.2757985675454627

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.000972272119, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596259
	speed: 0.0105s/iter; left time: 9.9333s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9281916618347168
Epoch: 1, Steps: 131 | Train Loss: 0.5596259 Vali Loss: 0.2756341 Best vali loss: 0.2756341
	iters: 100, epoch: 2 | loss: 0.3260836
	speed: 0.0089s/iter; left time: 7.3111s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2708).  Saving model state dict ...
Epoch: 2 cost time: 0.7011275291442871
Epoch: 2, Steps: 131 | Train Loss: 0.3260836 Vali Loss: 0.2708133 Best vali loss: 0.2708133
	iters: 100, epoch: 3 | loss: 0.4618106
	speed: 0.0089s/iter; left time: 6.1466s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.6978592872619629
Epoch: 3, Steps: 131 | Train Loss: 0.4618106 Vali Loss: 0.2833774 Best vali loss: 0.2708133
	iters: 100, epoch: 4 | loss: 0.5038032
	speed: 0.0086s/iter; left time: 4.7668s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6914782524108887
Epoch: 4, Steps: 131 | Train Loss: 0.5038032 Vali Loss: 0.2911349 Best vali loss: 0.2708133
	iters: 100, epoch: 5 | loss: 0.3359952
	speed: 0.0087s/iter; left time: 3.7039s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7056758403778076
Epoch: 5, Steps: 131 | Train Loss: 0.3359952 Vali Loss: 0.2892252 Best vali loss: 0.2708133
	iters: 100, epoch: 6 | loss: 0.3190456
	speed: 0.0087s/iter; left time: 2.5616s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7026338577270508
Epoch: 6, Steps: 131 | Train Loss: 0.3190456 Vali Loss: 0.2908702 Best vali loss: 0.2708133
	iters: 100, epoch: 7 | loss: 0.3121836
	speed: 0.0087s/iter; left time: 1.4252s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7062156200408936
Epoch: 7, Steps: 131 | Train Loss: 0.3121836 Vali Loss: 0.2976634 Best vali loss: 0.2708133
	iters: 100, epoch: 8 | loss: 0.3945301
	speed: 0.0087s/iter; left time: 0.2786s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.704096794128418
Epoch: 8, Steps: 131 | Train Loss: 0.3945301 Vali Loss: 0.2978980 Best vali loss: 0.2708133

best validation loss 0.27081329302080237

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009777022282, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597147
	speed: 0.0104s/iter; left time: 9.8769s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9286327362060547
Epoch: 1, Steps: 131 | Train Loss: 0.5597147 Vali Loss: 0.2756335 Best vali loss: 0.2756335
	iters: 100, epoch: 2 | loss: 0.3242622
	speed: 0.0088s/iter; left time: 7.2170s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2728).  Saving model state dict ...
Epoch: 2 cost time: 0.6969759464263916
Epoch: 2, Steps: 131 | Train Loss: 0.3242622 Vali Loss: 0.2727625 Best vali loss: 0.2727625
	iters: 100, epoch: 3 | loss: 0.4660461
	speed: 0.0091s/iter; left time: 6.2263s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7089724540710449
Epoch: 3, Steps: 131 | Train Loss: 0.4660461 Vali Loss: 0.2776984 Best vali loss: 0.2727625
	iters: 100, epoch: 4 | loss: 0.5065594
	speed: 0.0086s/iter; left time: 4.7636s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6981029510498047
Epoch: 4, Steps: 131 | Train Loss: 0.5065594 Vali Loss: 0.2904780 Best vali loss: 0.2727625
	iters: 100, epoch: 5 | loss: 0.3315954
	speed: 0.0086s/iter; left time: 3.6566s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6964612007141113
Epoch: 5, Steps: 131 | Train Loss: 0.3315954 Vali Loss: 0.2898625 Best vali loss: 0.2727625
	iters: 100, epoch: 6 | loss: 0.3174348
	speed: 0.0086s/iter; left time: 2.5387s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7021124362945557
Epoch: 6, Steps: 131 | Train Loss: 0.3174348 Vali Loss: 0.2904399 Best vali loss: 0.2727625
	iters: 100, epoch: 7 | loss: 0.3112237
	speed: 0.0087s/iter; left time: 1.4128s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7047111988067627
Epoch: 7, Steps: 131 | Train Loss: 0.3112237 Vali Loss: 0.2967791 Best vali loss: 0.2727625
	iters: 100, epoch: 8 | loss: 0.3990131
	speed: 0.0087s/iter; left time: 0.2793s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7040085792541504
Epoch: 8, Steps: 131 | Train Loss: 0.3990131 Vali Loss: 0.2967127 Best vali loss: 0.2727625

best validation loss 0.2727625029554328

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0032025338939, 'e_layers': 3, 'learning_rate': 0.0001479892669, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4185352
	speed: 0.0096s/iter; left time: 39.1944s
	iters: 200, epoch: 1 | loss: 0.3504643
	speed: 0.0042s/iter; left time: 16.7315s
	iters: 300, epoch: 1 | loss: 0.5824266
	speed: 0.0044s/iter; left time: 16.9571s
	iters: 400, epoch: 1 | loss: 0.6467552
	speed: 0.0044s/iter; left time: 16.6832s
	iters: 500, epoch: 1 | loss: 0.6106182
	speed: 0.0045s/iter; left time: 16.4809s
Updating learning rate to 0.00014235676081013001
Validation loss decreased (inf --> 0.2768).  Saving model state dict ...
Epoch: 1 cost time: 2.54388165473938
Epoch: 1, Steps: 523 | Train Loss: 0.5217599 Vali Loss: 0.2767988 Best vali loss: 0.2767988
	iters: 100, epoch: 2 | loss: 0.3332854
	speed: 0.0084s/iter; left time: 30.0326s
	iters: 200, epoch: 2 | loss: 0.4362043
	speed: 0.0037s/iter; left time: 12.9793s
	iters: 300, epoch: 2 | loss: 0.2739030
	speed: 0.0037s/iter; left time: 12.5619s
	iters: 400, epoch: 2 | loss: 0.2787955
	speed: 0.0039s/iter; left time: 12.6530s
	iters: 500, epoch: 2 | loss: 0.6836382
	speed: 0.0040s/iter; left time: 12.5531s
Updating learning rate to 0.00012631674053390792
Epoch: 2 cost time: 2.0394465923309326
Epoch: 2, Steps: 523 | Train Loss: 0.4011653 Vali Loss: 0.2789645 Best vali loss: 0.2767988
	iters: 100, epoch: 3 | loss: 0.2586008
	speed: 0.0085s/iter; left time: 25.7994s
	iters: 200, epoch: 3 | loss: 0.6995859
	speed: 0.0040s/iter; left time: 11.7467s
	iters: 300, epoch: 3 | loss: 0.6655277
	speed: 0.0040s/iter; left time: 11.3950s
	iters: 400, epoch: 3 | loss: 0.5648363
	speed: 0.0040s/iter; left time: 10.9537s
	iters: 500, epoch: 3 | loss: 0.2426962
	speed: 0.0040s/iter; left time: 10.6114s
Updating learning rate to 0.00010231115375524269
Validation loss decreased (0.2768 --> 0.2744).  Saving model state dict ...
Epoch: 3 cost time: 2.1368486881256104
Epoch: 3, Steps: 523 | Train Loss: 0.4862494 Vali Loss: 0.2744060 Best vali loss: 0.2744060

best validation loss 0.274405968470749

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002341320141, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4568459
	speed: 0.0097s/iter; left time: 9.1899s
Updating learning rate to 0.00022522089491631698
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.8330972194671631
Epoch: 1, Steps: 131 | Train Loss: 0.4568459 Vali Loss: 0.2780979 Best vali loss: 0.2780979
	iters: 100, epoch: 2 | loss: 0.4441428
	speed: 0.0074s/iter; left time: 6.0291s
Updating learning rate to 0.00019984417448148717
Epoch: 2 cost time: 0.5724096298217773
Epoch: 2, Steps: 131 | Train Loss: 0.4441428 Vali Loss: 0.2808883 Best vali loss: 0.2780979
	iters: 100, epoch: 3 | loss: 0.5598527
	speed: 0.0071s/iter; left time: 4.8651s
Updating learning rate to 0.00016186522844116979
Epoch: 3 cost time: 0.5572161674499512
Epoch: 3, Steps: 131 | Train Loss: 0.5598527 Vali Loss: 0.2904769 Best vali loss: 0.2780979

best validation loss 0.27809786819013

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009667415811, 'e_layers': 2, 'learning_rate': 0.0002345024842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6368403
	speed: 0.0105s/iter; left time: 9.9735s
Updating learning rate to 0.0002345024842
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 0.9307849407196045
Epoch: 1, Steps: 131 | Train Loss: 0.6368403 Vali Loss: 0.2797668 Best vali loss: 0.2797668
	iters: 100, epoch: 2 | loss: 0.4012977
	speed: 0.0090s/iter; left time: 7.3222s
Updating learning rate to 0.0001172512421
Epoch: 2 cost time: 0.708099365234375
Epoch: 2, Steps: 131 | Train Loss: 0.4012977 Vali Loss: 0.2802658 Best vali loss: 0.2797668
	iters: 100, epoch: 3 | loss: 0.7456924
	speed: 0.0088s/iter; left time: 6.0159s
Updating learning rate to 5.862562105e-05
Epoch: 3 cost time: 0.7087192535400391
Epoch: 3, Steps: 131 | Train Loss: 0.7456924 Vali Loss: 0.2840955 Best vali loss: 0.2797668

best validation loss 0.27976681014426624

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0032025338939, 'e_layers': 3, 'learning_rate': 0.0001479892669, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3101389
	speed: 0.0100s/iter; left time: 25.1181s
	iters: 200, epoch: 4 | loss: 0.3408307
	speed: 0.0044s/iter; left time: 10.6714s
	iters: 300, epoch: 4 | loss: 0.5498616
	speed: 0.0043s/iter; left time: 10.0685s
	iters: 400, epoch: 4 | loss: 0.5639574
	speed: 0.0044s/iter; left time: 9.7205s
	iters: 500, epoch: 4 | loss: 0.4618969
	speed: 0.0044s/iter; left time: 9.2667s
Updating learning rate to 7.399463345e-05
Epoch: 4 cost time: 2.563586473464966
Epoch: 4, Steps: 523 | Train Loss: 0.4453371 Vali Loss: 0.2958611 Best vali loss: 0.2744060
	iters: 100, epoch: 5 | loss: 0.3204996
	speed: 0.0087s/iter; left time: 17.3189s
	iters: 200, epoch: 5 | loss: 0.3727815
	speed: 0.0044s/iter; left time: 8.3840s
	iters: 300, epoch: 5 | loss: 0.1965189
	speed: 0.0044s/iter; left time: 7.9363s
	iters: 400, epoch: 5 | loss: 0.2413436
	speed: 0.0044s/iter; left time: 7.4769s
	iters: 500, epoch: 5 | loss: 0.5002924
	speed: 0.0044s/iter; left time: 7.0320s
Updating learning rate to 4.5678113144757315e-05
Epoch: 5 cost time: 2.345707893371582
Epoch: 5, Steps: 523 | Train Loss: 0.3262872 Vali Loss: 0.2848569 Best vali loss: 0.2744060
	iters: 100, epoch: 6 | loss: 0.2546261
	speed: 0.0088s/iter; left time: 12.9207s
	iters: 200, epoch: 6 | loss: 0.3942768
	speed: 0.0044s/iter; left time: 6.0275s
	iters: 300, epoch: 6 | loss: 0.4980378
	speed: 0.0043s/iter; left time: 5.4903s
	iters: 400, epoch: 6 | loss: 0.4376435
	speed: 0.0043s/iter; left time: 4.9757s
	iters: 500, epoch: 6 | loss: 0.2481510
	speed: 0.0043s/iter; left time: 4.5502s
Updating learning rate to 2.1672526366092062e-05
Epoch: 6 cost time: 2.2891273498535156
Epoch: 6, Steps: 523 | Train Loss: 0.3665470 Vali Loss: 0.2871804 Best vali loss: 0.2744060
	iters: 100, epoch: 7 | loss: 0.4168476
	speed: 0.0086s/iter; left time: 8.1225s
	iters: 200, epoch: 7 | loss: 0.5138913
	speed: 0.0043s/iter; left time: 3.6217s
	iters: 300, epoch: 7 | loss: 0.5014118
	speed: 0.0042s/iter; left time: 3.1596s
	iters: 400, epoch: 7 | loss: 0.6242100
	speed: 0.0043s/iter; left time: 2.7541s
	iters: 500, epoch: 7 | loss: 0.2490950
	speed: 0.0043s/iter; left time: 2.3497s
Updating learning rate to 5.632506089869979e-06
Epoch: 7 cost time: 2.273212194442749
Epoch: 7, Steps: 523 | Train Loss: 0.4610911 Vali Loss: 0.2879276 Best vali loss: 0.2744060
	iters: 100, epoch: 8 | loss: 0.3604948
	speed: 0.0088s/iter; left time: 3.7332s
	iters: 200, epoch: 8 | loss: 0.1564043
	speed: 0.0044s/iter; left time: 1.4359s
	iters: 300, epoch: 8 | loss: 0.2788059
	speed: 0.0045s/iter; left time: 1.0018s
	iters: 400, epoch: 8 | loss: 0.4778269
	speed: 0.0044s/iter; left time: 0.5437s
	iters: 500, epoch: 8 | loss: 0.3619556
	speed: 0.0044s/iter; left time: 0.1056s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3467307090759277
Epoch: 8, Steps: 523 | Train Loss: 0.3270975 Vali Loss: 0.2881185 Best vali loss: 0.2744060

best validation loss 0.274405968470749

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.000234404346, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6368377
	speed: 0.0104s/iter; left time: 9.9146s
Updating learning rate to 0.00022548286180054693
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 0.9256036281585693
Epoch: 1, Steps: 131 | Train Loss: 0.6368377 Vali Loss: 0.2798300 Best vali loss: 0.2798300
	iters: 100, epoch: 2 | loss: 0.3923408
	speed: 0.0088s/iter; left time: 7.2315s
Updating learning rate to 0.00020007662429809888
Epoch: 2 cost time: 0.7020285129547119
Epoch: 2, Steps: 131 | Train Loss: 0.3923408 Vali Loss: 0.2808536 Best vali loss: 0.2798300
	iters: 100, epoch: 3 | loss: 0.7689291
	speed: 0.0085s/iter; left time: 5.8600s
Updating learning rate to 0.00016205350284428704
Epoch: 3 cost time: 0.6961603164672852
Epoch: 3, Steps: 131 | Train Loss: 0.7689291 Vali Loss: 0.2982772 Best vali loss: 0.2798300
	iters: 100, epoch: 4 | loss: 0.5156689
	speed: 0.0086s/iter; left time: 4.7971s
Updating learning rate to 0.000117202173
Epoch: 4 cost time: 0.7017970085144043
Epoch: 4, Steps: 131 | Train Loss: 0.5156689 Vali Loss: 0.3068442 Best vali loss: 0.2798300
	iters: 100, epoch: 5 | loss: 0.3798399
	speed: 0.0086s/iter; left time: 3.6687s
Updating learning rate to 7.235084315571296e-05
Epoch: 5 cost time: 0.699627161026001
Epoch: 5, Steps: 131 | Train Loss: 0.3798399 Vali Loss: 0.3172186 Best vali loss: 0.2798300
	iters: 100, epoch: 6 | loss: 0.3323914
	speed: 0.0086s/iter; left time: 2.5232s
Updating learning rate to 3.432772170190112e-05
Epoch: 6 cost time: 0.7018394470214844
Epoch: 6, Steps: 131 | Train Loss: 0.3323914 Vali Loss: 0.3078585 Best vali loss: 0.2798300
	iters: 100, epoch: 7 | loss: 0.2978490
	speed: 0.0087s/iter; left time: 1.4196s
Updating learning rate to 8.921484199453047e-06
Epoch: 7 cost time: 0.7045879364013672
Epoch: 7, Steps: 131 | Train Loss: 0.2978490 Vali Loss: 0.3220513 Best vali loss: 0.2798300
	iters: 100, epoch: 8 | loss: 0.3195912
	speed: 0.0087s/iter; left time: 0.2772s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7022216320037842
Epoch: 8, Steps: 131 | Train Loss: 0.3195912 Vali Loss: 0.3103728 Best vali loss: 0.2798300

best validation loss 0.2798300427147428

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0098408118752, 'e_layers': 3, 'learning_rate': 0.0001127364947, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4610177
	speed: 0.0106s/iter; left time: 10.0981s
Updating learning rate to 0.0001127364947
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 0.9406511783599854
Epoch: 1, Steps: 131 | Train Loss: 0.4610177 Vali Loss: 0.2813616 Best vali loss: 0.2813616
	iters: 100, epoch: 2 | loss: 0.5040976
	speed: 0.0079s/iter; left time: 6.4886s
Updating learning rate to 5.636824735e-05
Validation loss decreased (0.2814 --> 0.2771).  Saving model state dict ...
Epoch: 2 cost time: 0.6199207305908203
Epoch: 2, Steps: 131 | Train Loss: 0.5040976 Vali Loss: 0.2771207 Best vali loss: 0.2771207
	iters: 100, epoch: 3 | loss: 0.5766721
	speed: 0.0078s/iter; left time: 5.3406s
Updating learning rate to 2.8184123675e-05
Epoch: 3 cost time: 0.6238555908203125
Epoch: 3, Steps: 131 | Train Loss: 0.5766721 Vali Loss: 0.2781570 Best vali loss: 0.2771207
	iters: 100, epoch: 4 | loss: 0.4080654
	speed: 0.0077s/iter; left time: 4.2959s
Updating learning rate to 1.40920618375e-05
Epoch: 4 cost time: 0.6420609951019287
Epoch: 4, Steps: 131 | Train Loss: 0.4080654 Vali Loss: 0.2784553 Best vali loss: 0.2771207
	iters: 100, epoch: 5 | loss: 0.3660402
	speed: 0.0076s/iter; left time: 3.2317s
Updating learning rate to 7.04603091875e-06
Epoch: 5 cost time: 0.6149387359619141
Epoch: 5, Steps: 131 | Train Loss: 0.3660402 Vali Loss: 0.2772932 Best vali loss: 0.2771207
	iters: 100, epoch: 6 | loss: 0.5887247
	speed: 0.0076s/iter; left time: 2.2346s
Updating learning rate to 3.523015459375e-06
Epoch: 6 cost time: 0.6277358531951904
Epoch: 6, Steps: 131 | Train Loss: 0.5887247 Vali Loss: 0.2775572 Best vali loss: 0.2771207
	iters: 100, epoch: 7 | loss: 0.7117225
	speed: 0.0082s/iter; left time: 1.3318s
Updating learning rate to 1.7615077296875e-06
Epoch: 7 cost time: 0.6886863708496094
Epoch: 7, Steps: 131 | Train Loss: 0.7117225 Vali Loss: 0.2775139 Best vali loss: 0.2771207
	iters: 100, epoch: 8 | loss: 0.3301510
	speed: 0.0078s/iter; left time: 0.2511s
Updating learning rate to 8.8075386484375e-07
Epoch: 8 cost time: 0.6234102249145508
Epoch: 8, Steps: 131 | Train Loss: 0.3301510 Vali Loss: 0.2774918 Best vali loss: 0.2771207

best validation loss 0.2771206677248151

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042709596571, 'e_layers': 3, 'learning_rate': 0.001787831536, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4232174
	speed: 0.0095s/iter; left time: 78.4245s
	iters: 200, epoch: 1 | loss: 0.2432436
	speed: 0.0042s/iter; left time: 34.6237s
	iters: 300, epoch: 1 | loss: 0.7264855
	speed: 0.0042s/iter; left time: 34.1075s
	iters: 400, epoch: 1 | loss: 0.6013070
	speed: 0.0043s/iter; left time: 33.8684s
	iters: 500, epoch: 1 | loss: 1.3240676
	speed: 0.0041s/iter; left time: 32.2350s
	iters: 600, epoch: 1 | loss: 0.8752918
	speed: 0.0040s/iter; left time: 30.9661s
	iters: 700, epoch: 1 | loss: 0.2791680
	speed: 0.0040s/iter; left time: 30.6552s
	iters: 800, epoch: 1 | loss: 1.3520538
	speed: 0.0040s/iter; left time: 30.2398s
	iters: 900, epoch: 1 | loss: 0.3711104
	speed: 0.0040s/iter; left time: 29.8446s
	iters: 1000, epoch: 1 | loss: 0.2156402
	speed: 0.0040s/iter; left time: 29.5104s
Updating learning rate to 0.001787831536
Validation loss decreased (inf --> 0.3202).  Saving model state dict ...
Epoch: 1 cost time: 4.548569917678833
Epoch: 1, Steps: 1045 | Train Loss: 0.6411585 Vali Loss: 0.3202402 Best vali loss: 0.3202402
	iters: 100, epoch: 2 | loss: 2.0127563
	speed: 0.0118s/iter; left time: 84.8674s
	iters: 200, epoch: 2 | loss: 0.7128757
	speed: 0.0040s/iter; left time: 28.4688s
	iters: 300, epoch: 2 | loss: 0.7892525
	speed: 0.0040s/iter; left time: 28.2093s
	iters: 400, epoch: 2 | loss: 0.4758508
	speed: 0.0040s/iter; left time: 27.6628s
	iters: 500, epoch: 2 | loss: 0.3505583
	speed: 0.0040s/iter; left time: 27.2643s
	iters: 600, epoch: 2 | loss: 0.4982171
	speed: 0.0039s/iter; left time: 25.9992s
	iters: 700, epoch: 2 | loss: 0.4180262
	speed: 0.0037s/iter; left time: 24.7098s
	iters: 800, epoch: 2 | loss: 0.2325643
	speed: 0.0037s/iter; left time: 24.1116s
	iters: 900, epoch: 2 | loss: 0.2149940
	speed: 0.0037s/iter; left time: 23.5643s
	iters: 1000, epoch: 2 | loss: 0.3329953
	speed: 0.0038s/iter; left time: 23.6937s
Updating learning rate to 0.000893915768
Epoch: 2 cost time: 4.079725503921509
Epoch: 2, Steps: 1045 | Train Loss: 0.6038091 Vali Loss: 0.3210142 Best vali loss: 0.3202402
	iters: 100, epoch: 3 | loss: 0.6607512
	speed: 0.0113s/iter; left time: 69.9104s
	iters: 200, epoch: 3 | loss: 0.2435981
	speed: 0.0036s/iter; left time: 21.8559s
	iters: 300, epoch: 3 | loss: 0.4288599
	speed: 0.0036s/iter; left time: 21.4364s
	iters: 400, epoch: 3 | loss: 0.4578162
	speed: 0.0038s/iter; left time: 22.1843s
	iters: 500, epoch: 3 | loss: 0.3732153
	speed: 0.0039s/iter; left time: 22.3310s
	iters: 600, epoch: 3 | loss: 0.4853542
	speed: 0.0037s/iter; left time: 21.0557s
	iters: 700, epoch: 3 | loss: 1.0410638
	speed: 0.0037s/iter; left time: 20.8806s
	iters: 800, epoch: 3 | loss: 0.3909370
	speed: 0.0037s/iter; left time: 20.4844s
	iters: 900, epoch: 3 | loss: 0.4101565
	speed: 0.0038s/iter; left time: 20.6447s
	iters: 1000, epoch: 3 | loss: 0.7919317
	speed: 0.0035s/iter; left time: 18.5194s
Updating learning rate to 0.000446957884
Epoch: 3 cost time: 3.908773422241211
Epoch: 3, Steps: 1045 | Train Loss: 0.5283684 Vali Loss: 0.3222705 Best vali loss: 0.3202402

best validation loss 0.320240249871853

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269501017, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597175
	speed: 0.0104s/iter; left time: 9.8878s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9398019313812256
Epoch: 1, Steps: 131 | Train Loss: 0.5597175 Vali Loss: 0.2756358 Best vali loss: 0.2756358
	iters: 100, epoch: 2 | loss: 0.3254812
	speed: 0.0092s/iter; left time: 7.4983s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2693).  Saving model state dict ...
Epoch: 2 cost time: 0.7111926078796387
Epoch: 2, Steps: 131 | Train Loss: 0.3254812 Vali Loss: 0.2693273 Best vali loss: 0.2693273
	iters: 100, epoch: 3 | loss: 0.4609138
	speed: 0.0093s/iter; left time: 6.3816s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7185087203979492
Epoch: 3, Steps: 131 | Train Loss: 0.4609138 Vali Loss: 0.2771032 Best vali loss: 0.2693273

best validation loss 0.26932732198441417

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009540751059, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596256
	speed: 0.0105s/iter; left time: 9.9977s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9505276679992676
Epoch: 1, Steps: 131 | Train Loss: 0.5596256 Vali Loss: 0.2756542 Best vali loss: 0.2756542
	iters: 100, epoch: 2 | loss: 0.3241510
	speed: 0.0092s/iter; left time: 7.5072s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2727).  Saving model state dict ...
Epoch: 2 cost time: 0.7143328189849854
Epoch: 2, Steps: 131 | Train Loss: 0.3241510 Vali Loss: 0.2726661 Best vali loss: 0.2726661
	iters: 100, epoch: 3 | loss: 0.4609031
	speed: 0.0092s/iter; left time: 6.3471s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7201151847839355
Epoch: 3, Steps: 131 | Train Loss: 0.4609031 Vali Loss: 0.2837525 Best vali loss: 0.2726661

best validation loss 0.27266606645275554

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269501017, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4273106
	speed: 0.0109s/iter; left time: 6.0347s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9514269828796387
Epoch: 4, Steps: 131 | Train Loss: 0.4273106 Vali Loss: 0.3088227 Best vali loss: 0.2693273
	iters: 100, epoch: 5 | loss: 0.2805761
	speed: 0.0089s/iter; left time: 3.7892s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7098431587219238
Epoch: 5, Steps: 131 | Train Loss: 0.2805761 Vali Loss: 0.2931170 Best vali loss: 0.2693273
	iters: 100, epoch: 6 | loss: 0.4335807
	speed: 0.0090s/iter; left time: 2.6514s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7203750610351562
Epoch: 6, Steps: 131 | Train Loss: 0.4335807 Vali Loss: 0.3009449 Best vali loss: 0.2693273
	iters: 100, epoch: 7 | loss: 0.4669073
	speed: 0.0090s/iter; left time: 1.4733s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7240540981292725
Epoch: 7, Steps: 131 | Train Loss: 0.4669073 Vali Loss: 0.2991176 Best vali loss: 0.2693273
	iters: 100, epoch: 8 | loss: 0.3265151
	speed: 0.0090s/iter; left time: 0.2884s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7191832065582275
Epoch: 8, Steps: 131 | Train Loss: 0.3265151 Vali Loss: 0.2955475 Best vali loss: 0.2693273

best validation loss 0.26932732198441417

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0016447053474, 'e_layers': 2, 'learning_rate': 0.0032001008737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4068926
	speed: 0.0086s/iter; left time: 70.8949s
	iters: 200, epoch: 1 | loss: 0.5606336
	speed: 0.0031s/iter; left time: 25.1693s
	iters: 300, epoch: 1 | loss: 0.2669000
	speed: 0.0031s/iter; left time: 24.8238s
	iters: 400, epoch: 1 | loss: 1.1115328
	speed: 0.0031s/iter; left time: 24.4337s
	iters: 500, epoch: 1 | loss: 0.6858050
	speed: 0.0031s/iter; left time: 24.2300s
	iters: 600, epoch: 1 | loss: 0.1866462
	speed: 0.0031s/iter; left time: 23.8122s
	iters: 700, epoch: 1 | loss: 0.4739857
	speed: 0.0030s/iter; left time: 23.3557s
	iters: 800, epoch: 1 | loss: 0.5982545
	speed: 0.0031s/iter; left time: 23.1346s
	iters: 900, epoch: 1 | loss: 0.5501465
	speed: 0.0031s/iter; left time: 22.7686s
	iters: 1000, epoch: 1 | loss: 0.2471123
	speed: 0.0031s/iter; left time: 22.4876s
Updating learning rate to 0.0030783042864414582
Validation loss decreased (inf --> 0.2851).  Saving model state dict ...
Epoch: 1 cost time: 3.49591064453125
Epoch: 1, Steps: 1045 | Train Loss: 0.5087909 Vali Loss: 0.2851125 Best vali loss: 0.2851125
	iters: 100, epoch: 2 | loss: 0.8232349
	speed: 0.0101s/iter; left time: 72.6909s
	iters: 200, epoch: 2 | loss: 0.2774862
	speed: 0.0033s/iter; left time: 23.5693s
	iters: 300, epoch: 2 | loss: 0.4255908
	speed: 0.0033s/iter; left time: 23.3062s
	iters: 400, epoch: 2 | loss: 0.3190898
	speed: 0.0032s/iter; left time: 21.9981s
	iters: 500, epoch: 2 | loss: 0.4327244
	speed: 0.0031s/iter; left time: 20.9459s
	iters: 600, epoch: 2 | loss: 0.3938121
	speed: 0.0031s/iter; left time: 21.1081s
	iters: 700, epoch: 2 | loss: 1.3375406
	speed: 0.0033s/iter; left time: 22.1223s
	iters: 800, epoch: 2 | loss: 0.5292107
	speed: 0.0033s/iter; left time: 21.5049s
	iters: 900, epoch: 2 | loss: 0.2495311
	speed: 0.0033s/iter; left time: 21.3940s
	iters: 1000, epoch: 2 | loss: 0.6099069
	speed: 0.0033s/iter; left time: 20.6509s
Updating learning rate to 0.0027314569509871325
Validation loss decreased (0.2851 --> 0.2798).  Saving model state dict ...
Epoch: 2 cost time: 3.422788381576538
Epoch: 2, Steps: 1045 | Train Loss: 0.5398127 Vali Loss: 0.2798238 Best vali loss: 0.2798238
	iters: 100, epoch: 3 | loss: 0.7221404
	speed: 0.0101s/iter; left time: 62.3117s
	iters: 200, epoch: 3 | loss: 1.1733673
	speed: 0.0029s/iter; left time: 17.6269s
	iters: 300, epoch: 3 | loss: 0.2751416
	speed: 0.0030s/iter; left time: 17.9225s
	iters: 400, epoch: 3 | loss: 0.6632339
	speed: 0.0030s/iter; left time: 17.6140s
	iters: 500, epoch: 3 | loss: 0.2514867
	speed: 0.0030s/iter; left time: 17.3539s
	iters: 600, epoch: 3 | loss: 0.2144351
	speed: 0.0030s/iter; left time: 16.7521s
	iters: 700, epoch: 3 | loss: 0.2955955
	speed: 0.0030s/iter; left time: 16.7111s
	iters: 800, epoch: 3 | loss: 0.6884007
	speed: 0.0030s/iter; left time: 16.3626s
	iters: 900, epoch: 3 | loss: 0.3797538
	speed: 0.0028s/iter; left time: 15.0623s
	iters: 1000, epoch: 3 | loss: 0.3212934
	speed: 0.0028s/iter; left time: 14.8806s
Updating learning rate to 0.002212363229981019
Epoch: 3 cost time: 3.1315839290618896
Epoch: 3, Steps: 1045 | Train Loss: 0.4984849 Vali Loss: 0.2847364 Best vali loss: 0.2798238
	iters: 100, epoch: 4 | loss: 0.2428815
	speed: 0.0098s/iter; left time: 50.3493s
	iters: 200, epoch: 4 | loss: 0.2928385
	speed: 0.0030s/iter; left time: 15.1840s
	iters: 300, epoch: 4 | loss: 0.5377660
	speed: 0.0031s/iter; left time: 15.0568s
	iters: 400, epoch: 4 | loss: 0.4003577
	speed: 0.0030s/iter; left time: 14.6848s
	iters: 500, epoch: 4 | loss: 0.8478839
	speed: 0.0030s/iter; left time: 14.2279s
	iters: 600, epoch: 4 | loss: 1.8810829
	speed: 0.0030s/iter; left time: 13.9657s
	iters: 700, epoch: 4 | loss: 0.6913818
	speed: 0.0031s/iter; left time: 13.8954s
	iters: 800, epoch: 4 | loss: 1.2282149
	speed: 0.0030s/iter; left time: 13.3216s
	iters: 900, epoch: 4 | loss: 0.3120986
	speed: 0.0030s/iter; left time: 13.1125s
	iters: 1000, epoch: 4 | loss: 0.3593351
	speed: 0.0030s/iter; left time: 12.8463s
Updating learning rate to 0.00160005043685
Epoch: 4 cost time: 3.2273871898651123
Epoch: 4, Steps: 1045 | Train Loss: 0.6793841 Vali Loss: 0.2920266 Best vali loss: 0.2798238
	iters: 100, epoch: 5 | loss: 0.1504057
	speed: 0.0105s/iter; left time: 42.8010s
	iters: 200, epoch: 5 | loss: 0.4589968
	speed: 0.0033s/iter; left time: 13.1593s
	iters: 300, epoch: 5 | loss: 0.5704273
	speed: 0.0033s/iter; left time: 12.7868s
	iters: 400, epoch: 5 | loss: 0.3214976
	speed: 0.0033s/iter; left time: 12.5111s
	iters: 500, epoch: 5 | loss: 1.3627182
	speed: 0.0033s/iter; left time: 12.1733s
	iters: 600, epoch: 5 | loss: 0.8645625
	speed: 0.0033s/iter; left time: 11.7578s
	iters: 700, epoch: 5 | loss: 0.6152583
	speed: 0.0033s/iter; left time: 11.5394s
	iters: 800, epoch: 5 | loss: 0.3640011
	speed: 0.0029s/iter; left time: 9.7992s
	iters: 900, epoch: 5 | loss: 0.3755077
	speed: 0.0029s/iter; left time: 9.4872s
	iters: 1000, epoch: 5 | loss: 0.2532234
	speed: 0.0029s/iter; left time: 9.2718s
Updating learning rate to 0.0009877376437189807
Epoch: 5 cost time: 3.369947910308838
Epoch: 5, Steps: 1045 | Train Loss: 0.5336599 Vali Loss: 0.2929721 Best vali loss: 0.2798238
	iters: 100, epoch: 6 | loss: 1.1877429
	speed: 0.0098s/iter; left time: 29.8369s
	iters: 200, epoch: 6 | loss: 0.4079078
	speed: 0.0028s/iter; left time: 8.1621s
	iters: 300, epoch: 6 | loss: 0.2560887
	speed: 0.0028s/iter; left time: 7.9487s
	iters: 400, epoch: 6 | loss: 0.1781691
	speed: 0.0028s/iter; left time: 7.5975s
	iters: 500, epoch: 6 | loss: 0.5691229
	speed: 0.0028s/iter; left time: 7.3152s
	iters: 600, epoch: 6 | loss: 0.5306818
	speed: 0.0028s/iter; left time: 7.0716s
	iters: 700, epoch: 6 | loss: 0.3134937
	speed: 0.0028s/iter; left time: 6.7553s
	iters: 800, epoch: 6 | loss: 0.2147118
	speed: 0.0028s/iter; left time: 6.4894s
	iters: 900, epoch: 6 | loss: 0.3421075
	speed: 0.0028s/iter; left time: 6.3344s
	iters: 1000, epoch: 6 | loss: 0.3144287
	speed: 0.0029s/iter; left time: 6.2474s
Updating learning rate to 0.00046864392271286735
Epoch: 6 cost time: 2.9901282787323
Epoch: 6, Steps: 1045 | Train Loss: 0.4314455 Vali Loss: 0.2953987 Best vali loss: 0.2798238
	iters: 100, epoch: 7 | loss: 0.2140303
	speed: 0.0102s/iter; left time: 20.2950s
	iters: 200, epoch: 7 | loss: 0.4510964
	speed: 0.0033s/iter; left time: 6.2981s
	iters: 300, epoch: 7 | loss: 0.3335415
	speed: 0.0033s/iter; left time: 5.9024s
	iters: 400, epoch: 7 | loss: 0.1917892
	speed: 0.0033s/iter; left time: 5.5783s
	iters: 500, epoch: 7 | loss: 0.2517607
	speed: 0.0033s/iter; left time: 5.2173s
	iters: 600, epoch: 7 | loss: 0.6223680
	speed: 0.0033s/iter; left time: 4.8909s
	iters: 700, epoch: 7 | loss: 0.2101179
	speed: 0.0033s/iter; left time: 4.5513s
	iters: 800, epoch: 7 | loss: 0.3937073
	speed: 0.0033s/iter; left time: 4.2720s
	iters: 900, epoch: 7 | loss: 0.6981254
	speed: 0.0034s/iter; left time: 4.0172s
	iters: 1000, epoch: 7 | loss: 0.1553473
	speed: 0.0034s/iter; left time: 3.6742s
Updating learning rate to 0.00012179658725854187
Epoch: 7 cost time: 3.4993131160736084
Epoch: 7, Steps: 1045 | Train Loss: 0.3521884 Vali Loss: 0.2991388 Best vali loss: 0.2798238
	iters: 100, epoch: 8 | loss: 0.5182807
	speed: 0.0100s/iter; left time: 9.4491s
	iters: 200, epoch: 8 | loss: 0.3575241
	speed: 0.0028s/iter; left time: 2.3416s
	iters: 300, epoch: 8 | loss: 0.5704269
	speed: 0.0028s/iter; left time: 2.0803s
	iters: 400, epoch: 8 | loss: 0.3479931
	speed: 0.0028s/iter; left time: 1.7995s
	iters: 500, epoch: 8 | loss: 0.4289085
	speed: 0.0028s/iter; left time: 1.5276s
	iters: 600, epoch: 8 | loss: 0.4308293
	speed: 0.0028s/iter; left time: 1.2429s
	iters: 700, epoch: 8 | loss: 0.2812087
	speed: 0.0028s/iter; left time: 0.9734s
	iters: 800, epoch: 8 | loss: 0.3807442
	speed: 0.0030s/iter; left time: 0.7340s
	iters: 900, epoch: 8 | loss: 0.3262791
	speed: 0.0031s/iter; left time: 0.4499s
	iters: 1000, epoch: 8 | loss: 1.0503070
	speed: 0.0031s/iter; left time: 0.1412s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0678958892822266
Epoch: 8, Steps: 1045 | Train Loss: 0.4692502 Vali Loss: 0.3035172 Best vali loss: 0.2798238

best validation loss 0.2798238138409519

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009533351662, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596229
	speed: 0.0106s/iter; left time: 10.0172s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9540839195251465
Epoch: 1, Steps: 131 | Train Loss: 0.5596229 Vali Loss: 0.2756719 Best vali loss: 0.2756719
	iters: 100, epoch: 2 | loss: 0.3232895
	speed: 0.0091s/iter; left time: 7.4733s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2714).  Saving model state dict ...
Epoch: 2 cost time: 0.7068157196044922
Epoch: 2, Steps: 131 | Train Loss: 0.3232895 Vali Loss: 0.2714298 Best vali loss: 0.2714298
	iters: 100, epoch: 3 | loss: 0.4612270
	speed: 0.0093s/iter; left time: 6.3857s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7113580703735352
Epoch: 3, Steps: 131 | Train Loss: 0.4612270 Vali Loss: 0.2773074 Best vali loss: 0.2714298
	iters: 100, epoch: 4 | loss: 0.5125698
	speed: 0.0089s/iter; left time: 4.9669s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7116146087646484
Epoch: 4, Steps: 131 | Train Loss: 0.5125698 Vali Loss: 0.2885935 Best vali loss: 0.2714298
	iters: 100, epoch: 5 | loss: 0.3339599
	speed: 0.0089s/iter; left time: 3.7861s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7110798358917236
Epoch: 5, Steps: 131 | Train Loss: 0.3339599 Vali Loss: 0.2883042 Best vali loss: 0.2714298
	iters: 100, epoch: 6 | loss: 0.3185718
	speed: 0.0091s/iter; left time: 2.6746s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7200276851654053
Epoch: 6, Steps: 131 | Train Loss: 0.3185718 Vali Loss: 0.2891876 Best vali loss: 0.2714298
	iters: 100, epoch: 7 | loss: 0.3117441
	speed: 0.0091s/iter; left time: 1.4753s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7233114242553711
Epoch: 7, Steps: 131 | Train Loss: 0.3117441 Vali Loss: 0.2968884 Best vali loss: 0.2714298
	iters: 100, epoch: 8 | loss: 0.3977016
	speed: 0.0090s/iter; left time: 0.2886s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7230067253112793
Epoch: 8, Steps: 131 | Train Loss: 0.3977016 Vali Loss: 0.2982688 Best vali loss: 0.2714298

best validation loss 0.27142976739230146

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0010094780392, 'e_layers': 2, 'learning_rate': 0.0001135989447, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7592650
	speed: 0.0092s/iter; left time: 8.7131s
Updating learning rate to 0.0001135989447
Validation loss decreased (inf --> 0.3298).  Saving model state dict ...
Epoch: 1 cost time: 0.7699601650238037
Epoch: 1, Steps: 131 | Train Loss: 0.7592650 Vali Loss: 0.3297784 Best vali loss: 0.3297784
	iters: 100, epoch: 2 | loss: 0.5822340
	speed: 0.0066s/iter; left time: 5.3835s
Updating learning rate to 5.679947235e-05
Validation loss decreased (0.3298 --> 0.3116).  Saving model state dict ...
Epoch: 2 cost time: 0.5250906944274902
Epoch: 2, Steps: 131 | Train Loss: 0.5822340 Vali Loss: 0.3115857 Best vali loss: 0.3115857
	iters: 100, epoch: 3 | loss: 0.5774566
	speed: 0.0064s/iter; left time: 4.3870s
Updating learning rate to 2.8399736175e-05
Validation loss decreased (0.3116 --> 0.3062).  Saving model state dict ...
Epoch: 3 cost time: 0.505119800567627
Epoch: 3, Steps: 131 | Train Loss: 0.5774566 Vali Loss: 0.3061764 Best vali loss: 0.3061764

best validation loss 0.3061764329206372

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0031671224673, 'e_layers': 1, 'learning_rate': 0.002260133875, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9117899
	speed: 0.0077s/iter; left time: 31.3825s
	iters: 200, epoch: 1 | loss: 0.1790809
	speed: 0.0023s/iter; left time: 9.3544s
	iters: 300, epoch: 1 | loss: 0.1633659
	speed: 0.0024s/iter; left time: 9.1580s
	iters: 400, epoch: 1 | loss: 0.3575577
	speed: 0.0023s/iter; left time: 8.8655s
	iters: 500, epoch: 1 | loss: 0.6185080
	speed: 0.0023s/iter; left time: 8.6234s
Updating learning rate to 0.0021741126514239614
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 1.4999773502349854
Epoch: 1, Steps: 523 | Train Loss: 0.4460605 Vali Loss: 0.2846786 Best vali loss: 0.2846786
	iters: 100, epoch: 2 | loss: 0.5507695
	speed: 0.0057s/iter; left time: 20.4018s
	iters: 200, epoch: 2 | loss: 0.2215645
	speed: 0.0024s/iter; left time: 8.3069s
	iters: 300, epoch: 2 | loss: 0.2756495
	speed: 0.0024s/iter; left time: 7.9858s
	iters: 400, epoch: 2 | loss: 0.4615442
	speed: 0.0024s/iter; left time: 7.7867s
	iters: 500, epoch: 2 | loss: 0.7183712
	speed: 0.0024s/iter; left time: 7.5594s
Updating learning rate to 0.0019291449322009645
Epoch: 2 cost time: 1.2974412441253662
Epoch: 2, Steps: 523 | Train Loss: 0.4455798 Vali Loss: 0.2852896 Best vali loss: 0.2846786
	iters: 100, epoch: 3 | loss: 0.6476106
	speed: 0.0056s/iter; left time: 16.9048s
	iters: 200, epoch: 3 | loss: 0.2008024
	speed: 0.0024s/iter; left time: 6.9305s
	iters: 300, epoch: 3 | loss: 0.3147728
	speed: 0.0023s/iter; left time: 6.6443s
	iters: 400, epoch: 3 | loss: 0.2709348
	speed: 0.0023s/iter; left time: 6.3097s
	iters: 500, epoch: 3 | loss: 0.3264318
	speed: 0.0023s/iter; left time: 6.1964s
Updating learning rate to 0.0015625248319448056
Epoch: 3 cost time: 1.2559514045715332
Epoch: 3, Steps: 523 | Train Loss: 0.3521105 Vali Loss: 0.2962890 Best vali loss: 0.2846786

best validation loss 0.2846785606771386

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0068317105002, 'e_layers': 2, 'learning_rate': 0.0044094389851, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3541841
	speed: 0.0086s/iter; left time: 35.2614s
	iters: 200, epoch: 1 | loss: 0.3831720
	speed: 0.0033s/iter; left time: 13.2737s
	iters: 300, epoch: 1 | loss: 0.4319780
	speed: 0.0033s/iter; left time: 12.8413s
	iters: 400, epoch: 1 | loss: 0.6284100
	speed: 0.0033s/iter; left time: 12.4939s
	iters: 500, epoch: 1 | loss: 0.3923915
	speed: 0.0033s/iter; left time: 12.2462s
Updating learning rate to 0.0044094389851
Validation loss decreased (inf --> 0.2993).  Saving model state dict ...
Epoch: 1 cost time: 1.9929296970367432
Epoch: 1, Steps: 523 | Train Loss: 0.4380271 Vali Loss: 0.2993349 Best vali loss: 0.2993349
	iters: 100, epoch: 2 | loss: 0.5053071
	speed: 0.0071s/iter; left time: 25.3250s
	iters: 200, epoch: 2 | loss: 0.5672616
	speed: 0.0033s/iter; left time: 11.5090s
	iters: 300, epoch: 2 | loss: 1.2687453
	speed: 0.0033s/iter; left time: 11.1694s
	iters: 400, epoch: 2 | loss: 0.2750027
	speed: 0.0034s/iter; left time: 11.1823s
	iters: 500, epoch: 2 | loss: 0.2818978
	speed: 0.0034s/iter; left time: 10.6225s
Updating learning rate to 0.00220471949255
Validation loss decreased (0.2993 --> 0.2915).  Saving model state dict ...
Epoch: 2 cost time: 1.787123441696167
Epoch: 2, Steps: 523 | Train Loss: 0.5796429 Vali Loss: 0.2915334 Best vali loss: 0.2915334
	iters: 100, epoch: 3 | loss: 0.3661716
	speed: 0.0068s/iter; left time: 20.7911s
	iters: 200, epoch: 3 | loss: 0.8640665
	speed: 0.0031s/iter; left time: 9.0962s
	iters: 300, epoch: 3 | loss: 0.3575367
	speed: 0.0031s/iter; left time: 8.8264s
	iters: 400, epoch: 3 | loss: 0.7485712
	speed: 0.0030s/iter; left time: 8.2825s
	iters: 500, epoch: 3 | loss: 0.4759166
	speed: 0.0030s/iter; left time: 7.7970s
Updating learning rate to 0.001102359746275
Epoch: 3 cost time: 1.6330757141113281
Epoch: 3, Steps: 523 | Train Loss: 0.5624525 Vali Loss: 0.3000397 Best vali loss: 0.2915334

best validation loss 0.29153342829866896

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0031671224673, 'e_layers': 1, 'learning_rate': 0.002260133875, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8130311
	speed: 0.0076s/iter; left time: 19.0692s
	iters: 200, epoch: 4 | loss: 0.1699151
	speed: 0.0024s/iter; left time: 5.7812s
	iters: 300, epoch: 4 | loss: 0.1651419
	speed: 0.0024s/iter; left time: 5.4492s
	iters: 400, epoch: 4 | loss: 0.3372381
	speed: 0.0024s/iter; left time: 5.2692s
	iters: 500, epoch: 4 | loss: 0.5409239
	speed: 0.0023s/iter; left time: 4.9689s
Updating learning rate to 0.0011300669375
Epoch: 4 cost time: 1.4907071590423584
Epoch: 4, Steps: 523 | Train Loss: 0.4052500 Vali Loss: 0.2918142 Best vali loss: 0.2846786
	iters: 100, epoch: 5 | loss: 0.3887544
	speed: 0.0056s/iter; left time: 11.1758s
	iters: 200, epoch: 5 | loss: 0.2121832
	speed: 0.0024s/iter; left time: 4.5756s
	iters: 300, epoch: 5 | loss: 0.2517479
	speed: 0.0024s/iter; left time: 4.3655s
	iters: 400, epoch: 5 | loss: 0.3998149
	speed: 0.0024s/iter; left time: 4.0847s
	iters: 500, epoch: 5 | loss: 0.4765487
	speed: 0.0023s/iter; left time: 3.7250s
Updating learning rate to 0.0006976090430551947
Epoch: 5 cost time: 1.2885096073150635
Epoch: 5, Steps: 523 | Train Loss: 0.3458098 Vali Loss: 0.3047829 Best vali loss: 0.2846786
	iters: 100, epoch: 6 | loss: 0.5435935
	speed: 0.0055s/iter; left time: 8.1505s
	iters: 200, epoch: 6 | loss: 0.1983229
	speed: 0.0023s/iter; left time: 3.2029s
	iters: 300, epoch: 6 | loss: 0.2837439
	speed: 0.0024s/iter; left time: 2.9935s
	iters: 400, epoch: 6 | loss: 0.2525361
	speed: 0.0024s/iter; left time: 2.8051s
	iters: 500, epoch: 6 | loss: 0.3063571
	speed: 0.0024s/iter; left time: 2.5407s
Updating learning rate to 0.0003309889427990357
Epoch: 6 cost time: 1.2718279361724854
Epoch: 6, Steps: 523 | Train Loss: 0.3169107 Vali Loss: 0.3087452 Best vali loss: 0.2846786
	iters: 100, epoch: 7 | loss: 0.4817449
	speed: 0.0057s/iter; left time: 5.3860s
	iters: 200, epoch: 7 | loss: 0.3497646
	speed: 0.0023s/iter; left time: 1.9330s
	iters: 300, epoch: 7 | loss: 0.4268687
	speed: 0.0023s/iter; left time: 1.7168s
	iters: 400, epoch: 7 | loss: 0.2847046
	speed: 0.0024s/iter; left time: 1.5281s
	iters: 500, epoch: 7 | loss: 0.3271926
	speed: 0.0025s/iter; left time: 1.3530s
Updating learning rate to 8.602122357603851e-05
Epoch: 7 cost time: 1.2597458362579346
Epoch: 7, Steps: 523 | Train Loss: 0.3740551 Vali Loss: 0.3055842 Best vali loss: 0.2846786
	iters: 100, epoch: 8 | loss: 0.2551365
	speed: 0.0056s/iter; left time: 2.3834s
	iters: 200, epoch: 8 | loss: 0.2342816
	speed: 0.0024s/iter; left time: 0.7800s
	iters: 300, epoch: 8 | loss: 0.2473860
	speed: 0.0024s/iter; left time: 0.5423s
	iters: 400, epoch: 8 | loss: 0.3848791
	speed: 0.0024s/iter; left time: 0.2975s
	iters: 500, epoch: 8 | loss: 0.3077188
	speed: 0.0023s/iter; left time: 0.0554s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2760512828826904
Epoch: 8, Steps: 523 | Train Loss: 0.2858804 Vali Loss: 0.3035473 Best vali loss: 0.2846786

best validation loss 0.2846785606771386

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010254590453, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596719
	speed: 0.0105s/iter; left time: 9.9857s
Updating learning rate to 0.00022556132703489248
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9444975852966309
Epoch: 1, Steps: 131 | Train Loss: 0.5596719 Vali Loss: 0.2756208 Best vali loss: 0.2756208
	iters: 100, epoch: 2 | loss: 0.3253713
	speed: 0.0090s/iter; left time: 7.3262s
Updating learning rate to 0.0002001462484774589
Validation loss decreased (0.2756 --> 0.2704).  Saving model state dict ...
Epoch: 2 cost time: 0.703484058380127
Epoch: 2, Steps: 131 | Train Loss: 0.3253713 Vali Loss: 0.2704231 Best vali loss: 0.2704231
	iters: 100, epoch: 3 | loss: 0.4632023
	speed: 0.0090s/iter; left time: 6.1918s
Updating learning rate to 0.00016210989544980772
Epoch: 3 cost time: 0.7015395164489746
Epoch: 3, Steps: 131 | Train Loss: 0.4632023 Vali Loss: 0.2811780 Best vali loss: 0.2704231
	iters: 100, epoch: 4 | loss: 0.4902786
	speed: 0.0085s/iter; left time: 4.7297s
Updating learning rate to 0.0001172429579
Epoch: 4 cost time: 0.6877763271331787
Epoch: 4, Steps: 131 | Train Loss: 0.4902786 Vali Loss: 0.2768523 Best vali loss: 0.2704231
	iters: 100, epoch: 5 | loss: 0.3340614
	speed: 0.0085s/iter; left time: 3.6273s
Updating learning rate to 7.237602035019229e-05
Epoch: 5 cost time: 0.6919097900390625
Epoch: 5, Steps: 131 | Train Loss: 0.3340614 Vali Loss: 0.2894074 Best vali loss: 0.2704231
	iters: 100, epoch: 6 | loss: 0.3081504
	speed: 0.0086s/iter; left time: 2.5160s
Updating learning rate to 3.43396673225411e-05
Epoch: 6 cost time: 0.6873071193695068
Epoch: 6, Steps: 131 | Train Loss: 0.3081504 Vali Loss: 0.2957520 Best vali loss: 0.2704231
	iters: 100, epoch: 7 | loss: 0.2850962
	speed: 0.0085s/iter; left time: 1.3936s
Updating learning rate to 8.924588765107527e-06
Epoch: 7 cost time: 0.6916565895080566
Epoch: 7, Steps: 131 | Train Loss: 0.2850962 Vali Loss: 0.3012655 Best vali loss: 0.2704231
	iters: 100, epoch: 8 | loss: 0.3437178
	speed: 0.0085s/iter; left time: 0.2728s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6933884620666504
Epoch: 8, Steps: 131 | Train Loss: 0.3437178 Vali Loss: 0.3022031 Best vali loss: 0.2704231

best validation loss 0.27042312327704493

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002334418304, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596204
	speed: 0.0104s/iter; left time: 9.8855s
Updating learning rate to 0.00022455697976926553
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9159300327301025
Epoch: 1, Steps: 131 | Train Loss: 0.5596204 Vali Loss: 0.2756698 Best vali loss: 0.2756698
	iters: 100, epoch: 2 | loss: 0.3263227
	speed: 0.0090s/iter; left time: 7.3270s
Updating learning rate to 0.00019925506584421996
Validation loss decreased (0.2757 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.7051219940185547
Epoch: 2, Steps: 131 | Train Loss: 0.3263227 Vali Loss: 0.2722880 Best vali loss: 0.2722880
	iters: 100, epoch: 3 | loss: 0.4646661
	speed: 0.0090s/iter; left time: 6.2003s
Updating learning rate to 0.00016138807565753058
Epoch: 3 cost time: 0.70615553855896
Epoch: 3, Steps: 131 | Train Loss: 0.4646661 Vali Loss: 0.2774188 Best vali loss: 0.2722880
	iters: 100, epoch: 4 | loss: 0.4937331
	speed: 0.0086s/iter; left time: 4.7760s
Updating learning rate to 0.0001167209152
Epoch: 4 cost time: 0.6988978385925293
Epoch: 4, Steps: 131 | Train Loss: 0.4937331 Vali Loss: 0.2782923 Best vali loss: 0.2722880
	iters: 100, epoch: 5 | loss: 0.3367791
	speed: 0.0085s/iter; left time: 3.6248s
Updating learning rate to 7.205375474246942e-05
Epoch: 5 cost time: 0.6919293403625488
Epoch: 5, Steps: 131 | Train Loss: 0.3367791 Vali Loss: 0.2929942 Best vali loss: 0.2722880
	iters: 100, epoch: 6 | loss: 0.3063656
	speed: 0.0086s/iter; left time: 2.5359s
Updating learning rate to 3.4186764555780036e-05
Epoch: 6 cost time: 0.7017419338226318
Epoch: 6, Steps: 131 | Train Loss: 0.3063656 Vali Loss: 0.2984546 Best vali loss: 0.2722880
	iters: 100, epoch: 7 | loss: 0.2888227
	speed: 0.0086s/iter; left time: 1.4081s
Updating learning rate to 8.884850630734456e-06
Epoch: 7 cost time: 0.6988749504089355
Epoch: 7, Steps: 131 | Train Loss: 0.2888227 Vali Loss: 0.3014388 Best vali loss: 0.2722880
	iters: 100, epoch: 8 | loss: 0.3444051
	speed: 0.0086s/iter; left time: 0.2767s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6992640495300293
Epoch: 8, Steps: 131 | Train Loss: 0.3444051 Vali Loss: 0.3011733 Best vali loss: 0.2722880

best validation loss 0.2722879711382005

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002323483187, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5595016
	speed: 0.0106s/iter; left time: 10.0271s
Updating learning rate to 0.00022350508738016973
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.936830997467041
Epoch: 1, Steps: 131 | Train Loss: 0.5595016 Vali Loss: 0.2756361 Best vali loss: 0.2756361
	iters: 100, epoch: 2 | loss: 0.3239197
	speed: 0.0090s/iter; left time: 7.3272s
Updating learning rate to 0.00019832169522503154
Validation loss decreased (0.2756 --> 0.2718).  Saving model state dict ...
Epoch: 2 cost time: 0.7059035301208496
Epoch: 2, Steps: 131 | Train Loss: 0.3239197 Vali Loss: 0.2718048 Best vali loss: 0.2718048
	iters: 100, epoch: 3 | loss: 0.4649946
	speed: 0.0089s/iter; left time: 6.1433s
Updating learning rate to 0.00016063208540218689
Epoch: 3 cost time: 0.6960251331329346
Epoch: 3, Steps: 131 | Train Loss: 0.4649946 Vali Loss: 0.2764789 Best vali loss: 0.2718048

best validation loss 0.27180476953833466

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015942939796, 'e_layers': 2, 'learning_rate': 0.000232832274, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5593312
	speed: 0.0104s/iter; left time: 9.8887s
Updating learning rate to 0.0002239706232283299
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9207947254180908
Epoch: 1, Steps: 131 | Train Loss: 0.5593312 Vali Loss: 0.2756576 Best vali loss: 0.2756576
	iters: 100, epoch: 2 | loss: 0.3260436
	speed: 0.0089s/iter; left time: 7.2491s
Updating learning rate to 0.00019873477691224214
Validation loss decreased (0.2757 --> 0.2734).  Saving model state dict ...
Epoch: 2 cost time: 0.7041683197021484
Epoch: 2, Steps: 131 | Train Loss: 0.3260436 Vali Loss: 0.2734102 Best vali loss: 0.2734102
	iters: 100, epoch: 3 | loss: 0.4624265
	speed: 0.0090s/iter; left time: 6.1723s
Updating learning rate to 0.00016096666388984454
Epoch: 3 cost time: 0.7054507732391357
Epoch: 3, Steps: 131 | Train Loss: 0.4624265 Vali Loss: 0.2797454 Best vali loss: 0.2734102

best validation loss 0.2734102051512554

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010269501017, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6860985
	speed: 0.0093s/iter; left time: 8.8335s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2936).  Saving model state dict ...
Epoch: 1 cost time: 0.7818200588226318
Epoch: 1, Steps: 131 | Train Loss: 0.6860985 Vali Loss: 0.2935661 Best vali loss: 0.2935661
	iters: 100, epoch: 2 | loss: 0.7138724
	speed: 0.0069s/iter; left time: 5.6380s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2936 --> 0.2831).  Saving model state dict ...
Epoch: 2 cost time: 0.5507614612579346
Epoch: 2, Steps: 131 | Train Loss: 0.7138724 Vali Loss: 0.2831452 Best vali loss: 0.2831452
	iters: 100, epoch: 3 | loss: 0.3716455
	speed: 0.0069s/iter; left time: 4.7486s
Updating learning rate to 0.00016213827184708514
Validation loss decreased (0.2831 --> 0.2812).  Saving model state dict ...
Epoch: 3 cost time: 0.5667762756347656
Epoch: 3, Steps: 131 | Train Loss: 0.3716455 Vali Loss: 0.2811650 Best vali loss: 0.2811650

best validation loss 0.28116495487259063

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002323483187, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4089668
	speed: 0.0109s/iter; left time: 6.0545s
Updating learning rate to 0.00011617415935
Epoch: 4 cost time: 0.9478914737701416
Epoch: 4, Steps: 131 | Train Loss: 0.4089668 Vali Loss: 0.2901696 Best vali loss: 0.2718048
	iters: 100, epoch: 5 | loss: 0.2713596
	speed: 0.0085s/iter; left time: 3.6169s
Updating learning rate to 7.171623329781312e-05
Epoch: 5 cost time: 0.6877751350402832
Epoch: 5, Steps: 131 | Train Loss: 0.2713596 Vali Loss: 0.2950933 Best vali loss: 0.2718048
	iters: 100, epoch: 6 | loss: 0.3829479
	speed: 0.0085s/iter; left time: 2.5031s
Updating learning rate to 3.402662347496845e-05
Epoch: 6 cost time: 0.6925253868103027
Epoch: 6, Steps: 131 | Train Loss: 0.3829479 Vali Loss: 0.3015006 Best vali loss: 0.2718048
	iters: 100, epoch: 7 | loss: 0.3952205
	speed: 0.0086s/iter; left time: 1.4088s
Updating learning rate to 8.843231319830268e-06
Epoch: 7 cost time: 0.6999952793121338
Epoch: 7, Steps: 131 | Train Loss: 0.3952205 Vali Loss: 0.3073753 Best vali loss: 0.2718048
	iters: 100, epoch: 8 | loss: 0.2963208
	speed: 0.0086s/iter; left time: 0.2742s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6964919567108154
Epoch: 8, Steps: 131 | Train Loss: 0.2963208 Vali Loss: 0.3074806 Best vali loss: 0.2718048

best validation loss 0.27180476953833466

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021335198053, 'e_layers': 2, 'learning_rate': 0.0002344242021, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596858
	speed: 0.0104s/iter; left time: 9.8253s
Updating learning rate to 0.0002255019621727397
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9234628677368164
Epoch: 1, Steps: 131 | Train Loss: 0.5596858 Vali Loss: 0.2756723 Best vali loss: 0.2756723
	iters: 100, epoch: 2 | loss: 0.3238760
	speed: 0.0089s/iter; left time: 7.2861s
Updating learning rate to 0.00020009357253957782
Validation loss decreased (0.2757 --> 0.2724).  Saving model state dict ...
Epoch: 2 cost time: 0.7060465812683105
Epoch: 2, Steps: 131 | Train Loss: 0.3238760 Vali Loss: 0.2723831 Best vali loss: 0.2723831
	iters: 100, epoch: 3 | loss: 0.4655290
	speed: 0.0091s/iter; left time: 6.2490s
Updating learning rate to 0.00016206723019453775
Epoch: 3 cost time: 0.7069551944732666
Epoch: 3, Steps: 131 | Train Loss: 0.4655290 Vali Loss: 0.2761209 Best vali loss: 0.2723831
	iters: 100, epoch: 4 | loss: 0.4945946
	speed: 0.0086s/iter; left time: 4.7883s
Updating learning rate to 0.00011721210105
Epoch: 4 cost time: 0.6974928379058838
Epoch: 4, Steps: 131 | Train Loss: 0.4945946 Vali Loss: 0.2771119 Best vali loss: 0.2723831
	iters: 100, epoch: 5 | loss: 0.3311564
	speed: 0.0086s/iter; left time: 3.6749s
Updating learning rate to 7.235697190546226e-05
Epoch: 5 cost time: 0.6967527866363525
Epoch: 5, Steps: 131 | Train Loss: 0.3311564 Vali Loss: 0.2925512 Best vali loss: 0.2723831
	iters: 100, epoch: 6 | loss: 0.3071401
	speed: 0.0086s/iter; left time: 2.5241s
Updating learning rate to 3.433062956042216e-05
Epoch: 6 cost time: 0.6956312656402588
Epoch: 6, Steps: 131 | Train Loss: 0.3071401 Vali Loss: 0.3025357 Best vali loss: 0.2723831
	iters: 100, epoch: 7 | loss: 0.2867069
	speed: 0.0086s/iter; left time: 1.4097s
Updating learning rate to 8.922239927260299e-06
Epoch: 7 cost time: 0.6939334869384766
Epoch: 7, Steps: 131 | Train Loss: 0.2867069 Vali Loss: 0.3037070 Best vali loss: 0.2723831
	iters: 100, epoch: 8 | loss: 0.3406140
	speed: 0.0085s/iter; left time: 0.2735s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6970312595367432
Epoch: 8, Steps: 131 | Train Loss: 0.3406140 Vali Loss: 0.3048014 Best vali loss: 0.2723831

best validation loss 0.27238312870119974

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0012829369265, 'e_layers': 2, 'learning_rate': 0.0047653779869, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2961285
	speed: 0.0084s/iter; left time: 69.3783s
	iters: 200, epoch: 1 | loss: 0.5185509
	speed: 0.0031s/iter; left time: 25.1072s
	iters: 300, epoch: 1 | loss: 1.1804243
	speed: 0.0031s/iter; left time: 24.7862s
	iters: 400, epoch: 1 | loss: 0.4555851
	speed: 0.0031s/iter; left time: 24.4187s
	iters: 500, epoch: 1 | loss: 0.3229803
	speed: 0.0030s/iter; left time: 23.8690s
	iters: 600, epoch: 1 | loss: 0.8331150
	speed: 0.0029s/iter; left time: 22.6881s
	iters: 700, epoch: 1 | loss: 0.4179190
	speed: 0.0029s/iter; left time: 22.1673s
	iters: 800, epoch: 1 | loss: 0.3191640
	speed: 0.0031s/iter; left time: 23.3242s
	iters: 900, epoch: 1 | loss: 1.0305543
	speed: 0.0031s/iter; left time: 23.1302s
	iters: 1000, epoch: 1 | loss: 0.7263315
	speed: 0.0031s/iter; left time: 22.8189s
Updating learning rate to 0.0047653779869
Validation loss decreased (inf --> 0.3246).  Saving model state dict ...
Epoch: 1 cost time: 3.43996262550354
Epoch: 1, Steps: 1045 | Train Loss: 0.6100753 Vali Loss: 0.3246218 Best vali loss: 0.3246218
	iters: 100, epoch: 2 | loss: 0.4030503
	speed: 0.0097s/iter; left time: 69.7043s
	iters: 200, epoch: 2 | loss: 0.4159356
	speed: 0.0030s/iter; left time: 21.4884s
	iters: 300, epoch: 2 | loss: 2.0335808
	speed: 0.0030s/iter; left time: 21.0276s
	iters: 400, epoch: 2 | loss: 0.5916277
	speed: 0.0031s/iter; left time: 21.1801s
	iters: 500, epoch: 2 | loss: 0.6049970
	speed: 0.0031s/iter; left time: 20.8634s
	iters: 600, epoch: 2 | loss: 0.2964453
	speed: 0.0031s/iter; left time: 20.6252s
	iters: 700, epoch: 2 | loss: 0.3674357
	speed: 0.0031s/iter; left time: 20.3047s
	iters: 800, epoch: 2 | loss: 1.1319133
	speed: 0.0030s/iter; left time: 19.4896s
	iters: 900, epoch: 2 | loss: 0.2658249
	speed: 0.0031s/iter; left time: 20.0196s
	iters: 1000, epoch: 2 | loss: 0.3045835
	speed: 0.0029s/iter; left time: 18.4905s
Updating learning rate to 0.00238268899345
Validation loss decreased (0.3246 --> 0.3186).  Saving model state dict ...
Epoch: 2 cost time: 3.1940178871154785
Epoch: 2, Steps: 1045 | Train Loss: 0.6415394 Vali Loss: 0.3185864 Best vali loss: 0.3185864
	iters: 100, epoch: 3 | loss: 0.5171182
	speed: 0.0092s/iter; left time: 56.6653s
	iters: 200, epoch: 3 | loss: 0.5393630
	speed: 0.0030s/iter; left time: 18.1580s
	iters: 300, epoch: 3 | loss: 0.4493350
	speed: 0.0031s/iter; left time: 18.2641s
	iters: 400, epoch: 3 | loss: 0.3729669
	speed: 0.0031s/iter; left time: 17.9760s
	iters: 500, epoch: 3 | loss: 0.6241949
	speed: 0.0031s/iter; left time: 17.7050s
	iters: 600, epoch: 3 | loss: 0.5184586
	speed: 0.0031s/iter; left time: 17.3067s
	iters: 700, epoch: 3 | loss: 0.4986306
	speed: 0.0031s/iter; left time: 17.0390s
	iters: 800, epoch: 3 | loss: 2.4654837
	speed: 0.0030s/iter; left time: 16.6044s
	iters: 900, epoch: 3 | loss: 0.5980603
	speed: 0.0031s/iter; left time: 16.4524s
	iters: 1000, epoch: 3 | loss: 0.5041595
	speed: 0.0031s/iter; left time: 16.1479s
Updating learning rate to 0.001191344496725
Epoch: 3 cost time: 3.2014622688293457
Epoch: 3, Steps: 1045 | Train Loss: 0.7087771 Vali Loss: 0.3226227 Best vali loss: 0.3185864
	iters: 100, epoch: 4 | loss: 0.3903961
	speed: 0.0097s/iter; left time: 49.6641s
	iters: 200, epoch: 4 | loss: 0.4035822
	speed: 0.0030s/iter; left time: 15.0787s
	iters: 300, epoch: 4 | loss: 0.2967640
	speed: 0.0030s/iter; left time: 14.9833s
	iters: 400, epoch: 4 | loss: 0.2661138
	speed: 0.0030s/iter; left time: 14.6164s
	iters: 500, epoch: 4 | loss: 0.4895932
	speed: 0.0031s/iter; left time: 14.4650s
	iters: 600, epoch: 4 | loss: 0.7332084
	speed: 0.0030s/iter; left time: 13.9241s
	iters: 700, epoch: 4 | loss: 0.7854276
	speed: 0.0030s/iter; left time: 13.7933s
	iters: 800, epoch: 4 | loss: 0.5805252
	speed: 0.0030s/iter; left time: 13.4552s
	iters: 900, epoch: 4 | loss: 0.2476985
	speed: 0.0030s/iter; left time: 12.7973s
	iters: 1000, epoch: 4 | loss: 0.3483912
	speed: 0.0029s/iter; left time: 12.2573s
Updating learning rate to 0.0005956722483625
Epoch: 4 cost time: 3.18395733833313
Epoch: 4, Steps: 1045 | Train Loss: 0.4541700 Vali Loss: 0.3217755 Best vali loss: 0.3185864
	iters: 100, epoch: 5 | loss: 0.4054601
	speed: 0.0095s/iter; left time: 38.9441s
	iters: 200, epoch: 5 | loss: 0.6677852
	speed: 0.0030s/iter; left time: 11.9841s
	iters: 300, epoch: 5 | loss: 0.3994352
	speed: 0.0030s/iter; left time: 11.6430s
	iters: 400, epoch: 5 | loss: 0.2966830
	speed: 0.0029s/iter; left time: 10.9648s
	iters: 500, epoch: 5 | loss: 0.9193306
	speed: 0.0028s/iter; left time: 10.2624s
	iters: 600, epoch: 5 | loss: 0.9429149
	speed: 0.0028s/iter; left time: 9.9186s
	iters: 700, epoch: 5 | loss: 1.5770003
	speed: 0.0028s/iter; left time: 9.6665s
	iters: 800, epoch: 5 | loss: 0.3192870
	speed: 0.0028s/iter; left time: 9.4370s
	iters: 900, epoch: 5 | loss: 0.6803221
	speed: 0.0028s/iter; left time: 9.2432s
	iters: 1000, epoch: 5 | loss: 0.3243819
	speed: 0.0028s/iter; left time: 8.8659s
Updating learning rate to 0.00029783612418125
Epoch: 5 cost time: 3.0262413024902344
Epoch: 5, Steps: 1045 | Train Loss: 0.6532600 Vali Loss: 0.3222548 Best vali loss: 0.3185864
	iters: 100, epoch: 6 | loss: 0.5936159
	speed: 0.0100s/iter; left time: 30.3233s
	iters: 200, epoch: 6 | loss: 0.7032496
	speed: 0.0034s/iter; left time: 9.8552s
	iters: 300, epoch: 6 | loss: 0.2727725
	speed: 0.0033s/iter; left time: 9.4973s
	iters: 400, epoch: 6 | loss: 0.3821458
	speed: 0.0033s/iter; left time: 9.0717s
	iters: 500, epoch: 6 | loss: 0.4376084
	speed: 0.0033s/iter; left time: 8.7864s
	iters: 600, epoch: 6 | loss: 0.3315480
	speed: 0.0033s/iter; left time: 8.4524s
	iters: 700, epoch: 6 | loss: 1.0931947
	speed: 0.0033s/iter; left time: 8.1306s
	iters: 800, epoch: 6 | loss: 0.9910213
	speed: 0.0033s/iter; left time: 7.7936s
	iters: 900, epoch: 6 | loss: 0.5358400
	speed: 0.0033s/iter; left time: 7.4587s
	iters: 1000, epoch: 6 | loss: 0.4925879
	speed: 0.0034s/iter; left time: 7.1557s
Updating learning rate to 0.000148918062090625
Epoch: 6 cost time: 3.525099754333496
Epoch: 6, Steps: 1045 | Train Loss: 0.5833584 Vali Loss: 0.3222528 Best vali loss: 0.3185864
	iters: 100, epoch: 7 | loss: 0.3471599
	speed: 0.0104s/iter; left time: 20.7330s
	iters: 200, epoch: 7 | loss: 0.7088953
	speed: 0.0033s/iter; left time: 6.2148s
	iters: 300, epoch: 7 | loss: 0.1889121
	speed: 0.0033s/iter; left time: 5.9255s
	iters: 400, epoch: 7 | loss: 0.2705972
	speed: 0.0033s/iter; left time: 5.5663s
	iters: 500, epoch: 7 | loss: 0.5174531
	speed: 0.0033s/iter; left time: 5.2813s
	iters: 600, epoch: 7 | loss: 0.2838533
	speed: 0.0033s/iter; left time: 4.9828s
	iters: 700, epoch: 7 | loss: 0.3592143
	speed: 0.0034s/iter; left time: 4.6674s
	iters: 800, epoch: 7 | loss: 0.5103979
	speed: 0.0034s/iter; left time: 4.3401s
	iters: 900, epoch: 7 | loss: 0.3645572
	speed: 0.0034s/iter; left time: 4.0061s
	iters: 1000, epoch: 7 | loss: 0.2799125
	speed: 0.0034s/iter; left time: 3.6745s
Updating learning rate to 7.44590310453125e-05
Epoch: 7 cost time: 3.513890504837036
Epoch: 7, Steps: 1045 | Train Loss: 0.3830953 Vali Loss: 0.3220392 Best vali loss: 0.3185864
	iters: 100, epoch: 8 | loss: 0.2807201
	speed: 0.0098s/iter; left time: 9.2634s
	iters: 200, epoch: 8 | loss: 0.5551889
	speed: 0.0030s/iter; left time: 2.5227s
	iters: 300, epoch: 8 | loss: 0.4165809
	speed: 0.0029s/iter; left time: 2.1662s
	iters: 400, epoch: 8 | loss: 0.4542125
	speed: 0.0029s/iter; left time: 1.8531s
	iters: 500, epoch: 8 | loss: 0.5805372
	speed: 0.0029s/iter; left time: 1.5990s
	iters: 600, epoch: 8 | loss: 0.4395513
	speed: 0.0029s/iter; left time: 1.2887s
	iters: 700, epoch: 8 | loss: 0.4391873
	speed: 0.0028s/iter; left time: 0.9721s
	iters: 800, epoch: 8 | loss: 0.4429030
	speed: 0.0028s/iter; left time: 0.6864s
	iters: 900, epoch: 8 | loss: 0.6391780
	speed: 0.0029s/iter; left time: 0.4248s
	iters: 1000, epoch: 8 | loss: 1.2627685
	speed: 0.0030s/iter; left time: 0.1385s
Updating learning rate to 3.722951552265625e-05
Epoch: 8 cost time: 3.069873809814453
Epoch: 8, Steps: 1045 | Train Loss: 0.5510828 Vali Loss: 0.3220792 Best vali loss: 0.3185864

best validation loss 0.3185863698745758

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597133
	speed: 0.0106s/iter; left time: 10.0915s
Updating learning rate to 0.00022556132703489248
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9480643272399902
Epoch: 1, Steps: 131 | Train Loss: 0.5597133 Vali Loss: 0.2756360 Best vali loss: 0.2756360
	iters: 100, epoch: 2 | loss: 0.3249217
	speed: 0.0089s/iter; left time: 7.2703s
Updating learning rate to 0.0002001462484774589
Validation loss decreased (0.2756 --> 0.2692).  Saving model state dict ...
Epoch: 2 cost time: 0.7010188102722168
Epoch: 2, Steps: 131 | Train Loss: 0.3249217 Vali Loss: 0.2692328 Best vali loss: 0.2692328
	iters: 100, epoch: 3 | loss: 0.4613262
	speed: 0.0090s/iter; left time: 6.1537s
Updating learning rate to 0.00016210989544980772
Epoch: 3 cost time: 0.7020254135131836
Epoch: 3, Steps: 131 | Train Loss: 0.4613262 Vali Loss: 0.2811350 Best vali loss: 0.2692328

best validation loss 0.2692327516235885

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0099664009457, 'e_layers': 2, 'learning_rate': 0.0020534115208, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3655651
	speed: 0.0089s/iter; left time: 17.8263s
	iters: 200, epoch: 1 | loss: 0.3884368
	speed: 0.0037s/iter; left time: 7.0106s
Updating learning rate to 0.0019752581983449972
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 1.2193603515625
Epoch: 1, Steps: 262 | Train Loss: 0.3770009 Vali Loss: 0.2821008 Best vali loss: 0.2821008
	iters: 100, epoch: 2 | loss: 0.4395925
	speed: 0.0077s/iter; left time: 13.3993s
	iters: 200, epoch: 2 | loss: 1.0942338
	speed: 0.0031s/iter; left time: 5.0422s
Updating learning rate to 0.0017526963658621307
Validation loss decreased (0.2821 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 0.8572616577148438
Epoch: 2, Steps: 262 | Train Loss: 0.7669131 Vali Loss: 0.2819199 Best vali loss: 0.2819199
	iters: 100, epoch: 3 | loss: 0.6978099
	speed: 0.0071s/iter; left time: 10.4048s
	iters: 200, epoch: 3 | loss: 0.3272765
	speed: 0.0032s/iter; left time: 4.3850s
Updating learning rate to 0.0014196090448188815
Epoch: 3 cost time: 0.8458077907562256
Epoch: 3, Steps: 262 | Train Loss: 0.5125432 Vali Loss: 0.2933772 Best vali loss: 0.2819199

best validation loss 0.28191992289162604

[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002345024842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597193
	speed: 0.0104s/iter; left time: 9.8620s
Updating learning rate to 0.00022557726483771572
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.921154260635376
Epoch: 1, Steps: 131 | Train Loss: 0.5597193 Vali Loss: 0.2756360 Best vali loss: 0.2756360
	iters: 100, epoch: 2 | loss: 0.3238973
	speed: 0.0088s/iter; left time: 7.2272s
Updating learning rate to 0.0002001603904914556
Validation loss decreased (0.2756 --> 0.2693).  Saving model state dict ...
Epoch: 2 cost time: 0.6967058181762695
Epoch: 2, Steps: 131 | Train Loss: 0.3238973 Vali Loss: 0.2692515 Best vali loss: 0.2692515
	iters: 100, epoch: 3 | loss: 0.4656022
	speed: 0.0089s/iter; left time: 6.0930s
Updating learning rate to 0.00016212134987589813
Epoch: 3 cost time: 0.6961641311645508
Epoch: 3, Steps: 131 | Train Loss: 0.4656022 Vali Loss: 0.2746686 Best vali loss: 0.2692515

best validation loss 0.2692514824441659

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4180543
	speed: 0.0106s/iter; left time: 5.9010s
Updating learning rate to 0.0001172429579
Epoch: 4 cost time: 0.9208858013153076
Epoch: 4, Steps: 131 | Train Loss: 0.4180543 Vali Loss: 0.2825011 Best vali loss: 0.2692328
	iters: 100, epoch: 5 | loss: 0.2671917
	speed: 0.0086s/iter; left time: 3.6654s
Updating learning rate to 7.237602035019229e-05
Epoch: 5 cost time: 0.6987676620483398
Epoch: 5, Steps: 131 | Train Loss: 0.2671917 Vali Loss: 0.2923641 Best vali loss: 0.2692328
	iters: 100, epoch: 6 | loss: 0.3818689
	speed: 0.0086s/iter; left time: 2.5390s
Updating learning rate to 3.43396673225411e-05
Epoch: 6 cost time: 0.7008113861083984
Epoch: 6, Steps: 131 | Train Loss: 0.3818689 Vali Loss: 0.2967460 Best vali loss: 0.2692328
	iters: 100, epoch: 7 | loss: 0.3957249
	speed: 0.0086s/iter; left time: 1.4048s
Updating learning rate to 8.924588765107527e-06
Epoch: 7 cost time: 0.6970973014831543
Epoch: 7, Steps: 131 | Train Loss: 0.3957249 Vali Loss: 0.3013313 Best vali loss: 0.2692328
	iters: 100, epoch: 8 | loss: 0.2987464
	speed: 0.0087s/iter; left time: 0.2768s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6965701580047607
Epoch: 8, Steps: 131 | Train Loss: 0.2987464 Vali Loss: 0.3036554 Best vali loss: 0.2692328

best validation loss 0.2692327516235885

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050488852332, 'e_layers': 2, 'learning_rate': 0.0010448565371, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3696285
	speed: 0.0091s/iter; left time: 8.6020s
Updating learning rate to 0.0010448565371
Validation loss decreased (inf --> 0.2881).  Saving model state dict ...
Epoch: 1 cost time: 0.7360174655914307
Epoch: 1, Steps: 131 | Train Loss: 0.3696285 Vali Loss: 0.2881233 Best vali loss: 0.2881233
	iters: 100, epoch: 2 | loss: 0.4531218
	speed: 0.0062s/iter; left time: 5.0687s
Updating learning rate to 0.00052242826855
Validation loss decreased (0.2881 --> 0.2849).  Saving model state dict ...
Epoch: 2 cost time: 0.49607014656066895
Epoch: 2, Steps: 131 | Train Loss: 0.4531218 Vali Loss: 0.2849024 Best vali loss: 0.2849024
	iters: 100, epoch: 3 | loss: 0.5614489
	speed: 0.0066s/iter; left time: 4.5272s
Updating learning rate to 0.000261214134275
Epoch: 3 cost time: 0.5302708148956299
Epoch: 3, Steps: 131 | Train Loss: 0.5614489 Vali Loss: 0.2861917 Best vali loss: 0.2849024
	iters: 100, epoch: 4 | loss: 0.4896688
	speed: 0.0066s/iter; left time: 3.6741s
Updating learning rate to 0.0001306070671375
Epoch: 4 cost time: 0.5333852767944336
Epoch: 4, Steps: 131 | Train Loss: 0.4896688 Vali Loss: 0.2871680 Best vali loss: 0.2849024
	iters: 100, epoch: 5 | loss: 0.4515477
	speed: 0.0067s/iter; left time: 2.8433s
Updating learning rate to 6.530353356875e-05
Epoch: 5 cost time: 0.5345914363861084
Epoch: 5, Steps: 131 | Train Loss: 0.4515477 Vali Loss: 0.2882043 Best vali loss: 0.2849024
	iters: 100, epoch: 6 | loss: 0.4131109
	speed: 0.0066s/iter; left time: 1.9432s
Updating learning rate to 3.2651766784375e-05
Epoch: 6 cost time: 0.5214335918426514
Epoch: 6, Steps: 131 | Train Loss: 0.4131109 Vali Loss: 0.2886281 Best vali loss: 0.2849024
	iters: 100, epoch: 7 | loss: 0.3584624
	speed: 0.0065s/iter; left time: 1.0592s
Updating learning rate to 1.63258833921875e-05
Epoch: 7 cost time: 0.536268949508667
Epoch: 7, Steps: 131 | Train Loss: 0.3584624 Vali Loss: 0.2885125 Best vali loss: 0.2849024
	iters: 100, epoch: 8 | loss: 0.4124110
	speed: 0.0069s/iter; left time: 0.2216s
Updating learning rate to 8.16294169609375e-06
Epoch: 8 cost time: 0.552161455154419
Epoch: 8, Steps: 131 | Train Loss: 0.4124110 Vali Loss: 0.2886833 Best vali loss: 0.2849024

best validation loss 0.2849023552267203

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0026080332723, 'e_layers': 1, 'learning_rate': 0.0016728296172, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5717912
	speed: 0.0083s/iter; left time: 7.9227s
Updating learning rate to 0.0016728296172
Validation loss decreased (inf --> 0.2939).  Saving model state dict ...
Epoch: 1 cost time: 0.666205883026123
Epoch: 1, Steps: 131 | Train Loss: 0.5717912 Vali Loss: 0.2939203 Best vali loss: 0.2939203
	iters: 100, epoch: 2 | loss: 0.5736373
	speed: 0.0058s/iter; left time: 4.7366s
Updating learning rate to 0.0008364148086
Epoch: 2 cost time: 0.42757725715637207
Epoch: 2, Steps: 131 | Train Loss: 0.5736373 Vali Loss: 0.3186805 Best vali loss: 0.2939203
	iters: 100, epoch: 3 | loss: 0.4058238
	speed: 0.0058s/iter; left time: 3.9503s
Updating learning rate to 0.0004182074043
Epoch: 3 cost time: 0.4399073123931885
Epoch: 3, Steps: 131 | Train Loss: 0.4058238 Vali Loss: 0.2998415 Best vali loss: 0.2939203
	iters: 100, epoch: 4 | loss: 0.4998326
	speed: 0.0057s/iter; left time: 3.1563s
Updating learning rate to 0.00020910370215
Epoch: 4 cost time: 0.42737507820129395
Epoch: 4, Steps: 131 | Train Loss: 0.4998326 Vali Loss: 0.3146853 Best vali loss: 0.2939203
	iters: 100, epoch: 5 | loss: 0.2913213
	speed: 0.0058s/iter; left time: 2.4733s
Updating learning rate to 0.000104551851075
Epoch: 5 cost time: 0.445232629776001
Epoch: 5, Steps: 131 | Train Loss: 0.2913213 Vali Loss: 0.3202034 Best vali loss: 0.2939203
	iters: 100, epoch: 6 | loss: 0.3781015
	speed: 0.0057s/iter; left time: 1.6882s
Updating learning rate to 5.22759255375e-05
Epoch: 6 cost time: 0.43505120277404785
Epoch: 6, Steps: 131 | Train Loss: 0.3781015 Vali Loss: 0.3244515 Best vali loss: 0.2939203
	iters: 100, epoch: 7 | loss: 0.3371353
	speed: 0.0057s/iter; left time: 0.9296s
Updating learning rate to 2.613796276875e-05
Epoch: 7 cost time: 0.4385848045349121
Epoch: 7, Steps: 131 | Train Loss: 0.3371353 Vali Loss: 0.3337561 Best vali loss: 0.2939203
	iters: 100, epoch: 8 | loss: 0.2538196
	speed: 0.0057s/iter; left time: 0.1816s
Updating learning rate to 1.3068981384375e-05
Epoch: 8 cost time: 0.4299633502960205
Epoch: 8, Steps: 131 | Train Loss: 0.2538196 Vali Loss: 0.3363382 Best vali loss: 0.2939203

best validation loss 0.29392032408944824

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0026621639732, 'e_layers': 4, 'learning_rate': 0.0001591162817, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4818107
	speed: 0.0114s/iter; left time: 10.7844s
Updating learning rate to 0.0001530602788259651
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 1.0627684593200684
Epoch: 1, Steps: 131 | Train Loss: 0.4818107 Vali Loss: 0.2802903 Best vali loss: 0.2802903
	iters: 100, epoch: 2 | loss: 0.4279178
	speed: 0.0097s/iter; left time: 7.9676s
Updating learning rate to 0.00013581424174362948
Validation loss decreased (0.2803 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 0.8064987659454346
Epoch: 2, Steps: 131 | Train Loss: 0.4279178 Vali Loss: 0.2794479 Best vali loss: 0.2794479
	iters: 100, epoch: 3 | loss: 0.5936036
	speed: 0.0095s/iter; left time: 6.5056s
Updating learning rate to 0.00011000372326306326
Validation loss decreased (0.2794 --> 0.2792).  Saving model state dict ...
Epoch: 3 cost time: 0.7771251201629639
Epoch: 3, Steps: 131 | Train Loss: 0.5936036 Vali Loss: 0.2792067 Best vali loss: 0.2792067

best validation loss 0.27920668067077403

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597165
	speed: 0.0103s/iter; left time: 9.7793s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9254281520843506
Epoch: 1, Steps: 131 | Train Loss: 0.5597165 Vali Loss: 0.2756341 Best vali loss: 0.2756341
	iters: 100, epoch: 2 | loss: 0.3246097
	speed: 0.0088s/iter; left time: 7.1931s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2756 --> 0.2687).  Saving model state dict ...
Epoch: 2 cost time: 0.6990201473236084
Epoch: 2, Steps: 131 | Train Loss: 0.3246097 Vali Loss: 0.2687323 Best vali loss: 0.2687323
	iters: 100, epoch: 3 | loss: 0.4627759
	speed: 0.0089s/iter; left time: 6.1020s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.7067782878875732
Epoch: 3, Steps: 131 | Train Loss: 0.4627759 Vali Loss: 0.2799435 Best vali loss: 0.2687323

best validation loss 0.26873226509789366

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.001027127088, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5896343
	speed: 0.0094s/iter; left time: 8.8983s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.7779576778411865
Epoch: 1, Steps: 131 | Train Loss: 0.5896343 Vali Loss: 0.2828962 Best vali loss: 0.2828962
	iters: 100, epoch: 2 | loss: 0.6383349
	speed: 0.0069s/iter; left time: 5.6843s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2829 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 0.5482704639434814
Epoch: 2, Steps: 131 | Train Loss: 0.6383349 Vali Loss: 0.2824866 Best vali loss: 0.2824866
	iters: 100, epoch: 3 | loss: 0.5858661
	speed: 0.0070s/iter; left time: 4.7894s
Updating learning rate to 0.00016213827184708514
Validation loss decreased (0.2825 --> 0.2791).  Saving model state dict ...
Epoch: 3 cost time: 0.5586409568786621
Epoch: 3, Steps: 131 | Train Loss: 0.5858661 Vali Loss: 0.2790802 Best vali loss: 0.2790802

best validation loss 0.27908022338770366

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4222226
	speed: 0.0108s/iter; left time: 5.9864s
Updating learning rate to 2.9316150425e-05
Epoch: 4 cost time: 0.9312629699707031
Epoch: 4, Steps: 131 | Train Loss: 0.4222226 Vali Loss: 0.3060089 Best vali loss: 0.2687323
	iters: 100, epoch: 5 | loss: 0.2821300
	speed: 0.0086s/iter; left time: 3.6576s
Updating learning rate to 1.46580752125e-05
Epoch: 5 cost time: 0.6871492862701416
Epoch: 5, Steps: 131 | Train Loss: 0.2821300 Vali Loss: 0.2937254 Best vali loss: 0.2687323
	iters: 100, epoch: 6 | loss: 0.4358373
	speed: 0.0085s/iter; left time: 2.5090s
Updating learning rate to 7.32903760625e-06
Epoch: 6 cost time: 0.6960797309875488
Epoch: 6, Steps: 131 | Train Loss: 0.4358373 Vali Loss: 0.2979500 Best vali loss: 0.2687323
	iters: 100, epoch: 7 | loss: 0.4660062
	speed: 0.0086s/iter; left time: 1.3954s
Updating learning rate to 3.664518803125e-06
Epoch: 7 cost time: 0.693044900894165
Epoch: 7, Steps: 131 | Train Loss: 0.4660062 Vali Loss: 0.2949273 Best vali loss: 0.2687323
	iters: 100, epoch: 8 | loss: 0.3276581
	speed: 0.0085s/iter; left time: 0.2721s
Updating learning rate to 1.8322594015625e-06
Epoch: 8 cost time: 0.6926290988922119
Epoch: 8, Steps: 131 | Train Loss: 0.3276581 Vali Loss: 0.2926539 Best vali loss: 0.2687323

best validation loss 0.26873226509789366

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009572218537, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596921
	speed: 0.0110s/iter; left time: 10.4037s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9242405891418457
Epoch: 1, Steps: 131 | Train Loss: 0.5596921 Vali Loss: 0.2756446 Best vali loss: 0.2756446
	iters: 100, epoch: 2 | loss: 0.3243724
	speed: 0.0088s/iter; left time: 7.2024s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2756 --> 0.2740).  Saving model state dict ...
Epoch: 2 cost time: 0.6946687698364258
Epoch: 2, Steps: 131 | Train Loss: 0.3243724 Vali Loss: 0.2739977 Best vali loss: 0.2739977
	iters: 100, epoch: 3 | loss: 0.4597746
	speed: 0.0090s/iter; left time: 6.1733s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.706078052520752
Epoch: 3, Steps: 131 | Train Loss: 0.4597746 Vali Loss: 0.2844586 Best vali loss: 0.2739977
	iters: 100, epoch: 4 | loss: 0.5058976
	speed: 0.0087s/iter; left time: 4.8385s
Updating learning rate to 2.9310739475e-05
Epoch: 4 cost time: 0.7010288238525391
Epoch: 4, Steps: 131 | Train Loss: 0.5058976 Vali Loss: 0.2932134 Best vali loss: 0.2739977
	iters: 100, epoch: 5 | loss: 0.3341430
	speed: 0.0087s/iter; left time: 3.6925s
Updating learning rate to 1.46553697375e-05
Epoch: 5 cost time: 0.7017343044281006
Epoch: 5, Steps: 131 | Train Loss: 0.3341430 Vali Loss: 0.2926452 Best vali loss: 0.2739977
	iters: 100, epoch: 6 | loss: 0.3188850
	speed: 0.0086s/iter; left time: 2.5408s
Updating learning rate to 7.32768486875e-06
Epoch: 6 cost time: 0.6976089477539062
Epoch: 6, Steps: 131 | Train Loss: 0.3188850 Vali Loss: 0.2922031 Best vali loss: 0.2739977
	iters: 100, epoch: 7 | loss: 0.3115499
	speed: 0.0085s/iter; left time: 1.3880s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 0.6938714981079102
Epoch: 7, Steps: 131 | Train Loss: 0.3115499 Vali Loss: 0.3019280 Best vali loss: 0.2739977
	iters: 100, epoch: 8 | loss: 0.3964601
	speed: 0.0086s/iter; left time: 0.2750s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 0.696143388748169
Epoch: 8, Steps: 131 | Train Loss: 0.3964601 Vali Loss: 0.3011215 Best vali loss: 0.2739977

best validation loss 0.27399770568054643

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009539795854, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596229
	speed: 0.0110s/iter; left time: 10.4195s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.927962064743042
Epoch: 1, Steps: 131 | Train Loss: 0.5596229 Vali Loss: 0.2756697 Best vali loss: 0.2756697
	iters: 100, epoch: 2 | loss: 0.3249904
	speed: 0.0088s/iter; left time: 7.2063s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2757 --> 0.2705).  Saving model state dict ...
Epoch: 2 cost time: 0.6979057788848877
Epoch: 2, Steps: 131 | Train Loss: 0.3249904 Vali Loss: 0.2704519 Best vali loss: 0.2704519
	iters: 100, epoch: 3 | loss: 0.4639196
	speed: 0.0090s/iter; left time: 6.1562s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7061614990234375
Epoch: 3, Steps: 131 | Train Loss: 0.4639196 Vali Loss: 0.2898429 Best vali loss: 0.2704519
	iters: 100, epoch: 4 | loss: 0.5000811
	speed: 0.0087s/iter; left time: 4.8531s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.7103426456451416
Epoch: 4, Steps: 131 | Train Loss: 0.5000811 Vali Loss: 0.2798642 Best vali loss: 0.2704519
	iters: 100, epoch: 5 | loss: 0.3365117
	speed: 0.0087s/iter; left time: 3.6909s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.6998019218444824
Epoch: 5, Steps: 131 | Train Loss: 0.3365117 Vali Loss: 0.2922526 Best vali loss: 0.2704519
	iters: 100, epoch: 6 | loss: 0.3048696
	speed: 0.0086s/iter; left time: 2.5388s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7025880813598633
Epoch: 6, Steps: 131 | Train Loss: 0.3048696 Vali Loss: 0.3066671 Best vali loss: 0.2704519
	iters: 100, epoch: 7 | loss: 0.2855755
	speed: 0.0086s/iter; left time: 1.3991s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.696038007736206
Epoch: 7, Steps: 131 | Train Loss: 0.2855755 Vali Loss: 0.3043852 Best vali loss: 0.2704519
	iters: 100, epoch: 8 | loss: 0.3450159
	speed: 0.0086s/iter; left time: 0.2747s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6949827671051025
Epoch: 8, Steps: 131 | Train Loss: 0.3450159 Vali Loss: 0.3076594 Best vali loss: 0.2704519

best validation loss 0.2704518978016755

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009551426869, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596240
	speed: 0.0108s/iter; left time: 10.2038s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9228267669677734
Epoch: 1, Steps: 131 | Train Loss: 0.5596240 Vali Loss: 0.2756524 Best vali loss: 0.2756524
	iters: 100, epoch: 2 | loss: 0.3237250
	speed: 0.0089s/iter; left time: 7.2666s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2757 --> 0.2712).  Saving model state dict ...
Epoch: 2 cost time: 0.6999301910400391
Epoch: 2, Steps: 131 | Train Loss: 0.3237250 Vali Loss: 0.2712115 Best vali loss: 0.2712115
	iters: 100, epoch: 3 | loss: 0.4651962
	speed: 0.0089s/iter; left time: 6.1269s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7026934623718262
Epoch: 3, Steps: 131 | Train Loss: 0.4651962 Vali Loss: 0.2800672 Best vali loss: 0.2712115

best validation loss 0.27121150482538775

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009546618148, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596265
	speed: 0.0108s/iter; left time: 10.2391s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.924994707107544
Epoch: 1, Steps: 131 | Train Loss: 0.5596265 Vali Loss: 0.2756701 Best vali loss: 0.2756701
	iters: 100, epoch: 2 | loss: 0.3252133
	speed: 0.0089s/iter; left time: 7.2932s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2757 --> 0.2709).  Saving model state dict ...
Epoch: 2 cost time: 0.7036898136138916
Epoch: 2, Steps: 131 | Train Loss: 0.3252133 Vali Loss: 0.2709029 Best vali loss: 0.2709029
	iters: 100, epoch: 3 | loss: 0.4618884
	speed: 0.0089s/iter; left time: 6.1260s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7031095027923584
Epoch: 3, Steps: 131 | Train Loss: 0.4618884 Vali Loss: 0.2772292 Best vali loss: 0.2709029

best validation loss 0.270902941354636

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002340282181, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596799
	speed: 0.0108s/iter; left time: 10.2704s
Updating learning rate to 0.0002340282181
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9333724975585938
Epoch: 1, Steps: 131 | Train Loss: 0.5596799 Vali Loss: 0.2756595 Best vali loss: 0.2756595
	iters: 100, epoch: 2 | loss: 0.3245126
	speed: 0.0089s/iter; left time: 7.3132s
Updating learning rate to 0.00011701410905
Validation loss decreased (0.2757 --> 0.2697).  Saving model state dict ...
Epoch: 2 cost time: 0.7096962928771973
Epoch: 2, Steps: 131 | Train Loss: 0.3245126 Vali Loss: 0.2696509 Best vali loss: 0.2696509
	iters: 100, epoch: 3 | loss: 0.4613726
	speed: 0.0091s/iter; left time: 6.2277s
Updating learning rate to 5.8507054525e-05
Epoch: 3 cost time: 0.7009322643280029
Epoch: 3, Steps: 131 | Train Loss: 0.4613726 Vali Loss: 0.2765981 Best vali loss: 0.2696509

best validation loss 0.2696509225388893

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002340282181, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4240349
	speed: 0.0110s/iter; left time: 6.1264s
Updating learning rate to 2.92535272625e-05
Epoch: 4 cost time: 0.9189934730529785
Epoch: 4, Steps: 131 | Train Loss: 0.4240349 Vali Loss: 0.3048038 Best vali loss: 0.2696509
	iters: 100, epoch: 5 | loss: 0.2812233
	speed: 0.0086s/iter; left time: 3.6593s
Updating learning rate to 1.462676363125e-05
Epoch: 5 cost time: 0.6978943347930908
Epoch: 5, Steps: 131 | Train Loss: 0.2812233 Vali Loss: 0.2934137 Best vali loss: 0.2696509
	iters: 100, epoch: 6 | loss: 0.4338499
	speed: 0.0087s/iter; left time: 2.5543s
Updating learning rate to 7.313381815625e-06
Epoch: 6 cost time: 0.7000906467437744
Epoch: 6, Steps: 131 | Train Loss: 0.4338499 Vali Loss: 0.2976647 Best vali loss: 0.2696509
	iters: 100, epoch: 7 | loss: 0.4644489
	speed: 0.0087s/iter; left time: 1.4220s
Updating learning rate to 3.6566909078125e-06
Epoch: 7 cost time: 0.7060565948486328
Epoch: 7, Steps: 131 | Train Loss: 0.4644489 Vali Loss: 0.2968609 Best vali loss: 0.2696509
	iters: 100, epoch: 8 | loss: 0.3284018
	speed: 0.0086s/iter; left time: 0.2756s
Updating learning rate to 1.82834545390625e-06
Epoch: 8 cost time: 0.6985569000244141
Epoch: 8, Steps: 131 | Train Loss: 0.3284018 Vali Loss: 0.2943393 Best vali loss: 0.2696509

best validation loss 0.2696509225388893

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3662876
	speed: 0.0090s/iter; left time: 73.9472s
	iters: 200, epoch: 1 | loss: 0.2519838
	speed: 0.0033s/iter; left time: 27.0450s
	iters: 300, epoch: 1 | loss: 0.2990503
	speed: 0.0033s/iter; left time: 26.7467s
	iters: 400, epoch: 1 | loss: 0.2896096
	speed: 0.0033s/iter; left time: 26.3005s
	iters: 500, epoch: 1 | loss: 0.1778556
	speed: 0.0033s/iter; left time: 25.9613s
	iters: 600, epoch: 1 | loss: 0.1724462
	speed: 0.0033s/iter; left time: 25.5027s
	iters: 700, epoch: 1 | loss: 0.7559402
	speed: 0.0033s/iter; left time: 25.2044s
	iters: 800, epoch: 1 | loss: 0.3406625
	speed: 0.0033s/iter; left time: 25.1417s
	iters: 900, epoch: 1 | loss: 0.2690923
	speed: 0.0033s/iter; left time: 24.4719s
	iters: 1000, epoch: 1 | loss: 0.5827324
	speed: 0.0030s/iter; left time: 22.0627s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2937).  Saving model state dict ...
Epoch: 1 cost time: 3.663682222366333
Epoch: 1, Steps: 1045 | Train Loss: 0.3505661 Vali Loss: 0.2936903 Best vali loss: 0.2936903
	iters: 100, epoch: 2 | loss: 0.8929913
	speed: 0.0099s/iter; left time: 71.4178s
	iters: 200, epoch: 2 | loss: 0.4255711
	speed: 0.0030s/iter; left time: 21.2465s
	iters: 300, epoch: 2 | loss: 0.3723169
	speed: 0.0031s/iter; left time: 21.6199s
	iters: 400, epoch: 2 | loss: 0.5482992
	speed: 0.0033s/iter; left time: 22.9237s
	iters: 500, epoch: 2 | loss: 0.3599067
	speed: 0.0033s/iter; left time: 22.5937s
	iters: 600, epoch: 2 | loss: 0.2933590
	speed: 0.0031s/iter; left time: 21.0509s
	iters: 700, epoch: 2 | loss: 0.6088434
	speed: 0.0031s/iter; left time: 20.7037s
	iters: 800, epoch: 2 | loss: 0.3126443
	speed: 0.0031s/iter; left time: 19.9828s
	iters: 900, epoch: 2 | loss: 0.7916147
	speed: 0.0031s/iter; left time: 19.7256s
	iters: 1000, epoch: 2 | loss: 0.1915305
	speed: 0.0031s/iter; left time: 19.5045s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2937 --> 0.2854).  Saving model state dict ...
Epoch: 2 cost time: 3.2870774269104004
Epoch: 2, Steps: 1045 | Train Loss: 0.4797077 Vali Loss: 0.2853899 Best vali loss: 0.2853899
	iters: 100, epoch: 3 | loss: 0.4385720
	speed: 0.0102s/iter; left time: 63.0500s
	iters: 200, epoch: 3 | loss: 0.5745622
	speed: 0.0033s/iter; left time: 20.1844s
	iters: 300, epoch: 3 | loss: 0.4503968
	speed: 0.0033s/iter; left time: 19.8371s
	iters: 400, epoch: 3 | loss: 0.2010202
	speed: 0.0033s/iter; left time: 19.6512s
	iters: 500, epoch: 3 | loss: 0.3526537
	speed: 0.0033s/iter; left time: 19.2273s
	iters: 600, epoch: 3 | loss: 0.1163778
	speed: 0.0033s/iter; left time: 18.8738s
	iters: 700, epoch: 3 | loss: 1.2200030
	speed: 0.0033s/iter; left time: 18.5598s
	iters: 800, epoch: 3 | loss: 0.8932264
	speed: 0.0033s/iter; left time: 18.3046s
	iters: 900, epoch: 3 | loss: 0.2862356
	speed: 0.0033s/iter; left time: 17.9620s
	iters: 1000, epoch: 3 | loss: 0.6237437
	speed: 0.0034s/iter; left time: 17.6593s
Updating learning rate to 5.863230085e-05
Validation loss decreased (0.2854 --> 0.2837).  Saving model state dict ...
Epoch: 3 cost time: 3.5241503715515137
Epoch: 3, Steps: 1045 | Train Loss: 0.5156791 Vali Loss: 0.2837365 Best vali loss: 0.2837365
	iters: 100, epoch: 4 | loss: 0.5348526
	speed: 0.0102s/iter; left time: 52.3223s
	iters: 200, epoch: 4 | loss: 0.5354694
	speed: 0.0033s/iter; left time: 16.6637s
	iters: 300, epoch: 4 | loss: 0.2442528
	speed: 0.0033s/iter; left time: 16.2965s
	iters: 400, epoch: 4 | loss: 0.3050577
	speed: 0.0033s/iter; left time: 15.8183s
	iters: 500, epoch: 4 | loss: 0.5386388
	speed: 0.0033s/iter; left time: 15.7884s
	iters: 600, epoch: 4 | loss: 0.5421121
	speed: 0.0032s/iter; left time: 14.7710s
	iters: 700, epoch: 4 | loss: 0.2034556
	speed: 0.0032s/iter; left time: 14.3887s
	iters: 800, epoch: 4 | loss: 0.4587612
	speed: 0.0031s/iter; left time: 13.8968s
	iters: 900, epoch: 4 | loss: 0.2408489
	speed: 0.0031s/iter; left time: 13.4814s
	iters: 1000, epoch: 4 | loss: 0.3224875
	speed: 0.0031s/iter; left time: 13.2847s
Updating learning rate to 2.9316150425e-05
Validation loss decreased (0.2837 --> 0.2829).  Saving model state dict ...
Epoch: 4 cost time: 3.4133849143981934
Epoch: 4, Steps: 1045 | Train Loss: 0.3925937 Vali Loss: 0.2828976 Best vali loss: 0.2828976
	iters: 100, epoch: 5 | loss: 0.7001723
	speed: 0.0104s/iter; left time: 42.2420s
	iters: 200, epoch: 5 | loss: 0.3310998
	speed: 0.0033s/iter; left time: 13.1388s
	iters: 300, epoch: 5 | loss: 0.2865752
	speed: 0.0034s/iter; left time: 13.1973s
	iters: 400, epoch: 5 | loss: 0.7999819
	speed: 0.0034s/iter; left time: 12.8291s
	iters: 500, epoch: 5 | loss: 0.3330458
	speed: 0.0034s/iter; left time: 12.3939s
	iters: 600, epoch: 5 | loss: 0.4270664
	speed: 0.0033s/iter; left time: 11.8130s
	iters: 700, epoch: 5 | loss: 0.2171195
	speed: 0.0033s/iter; left time: 11.5646s
	iters: 800, epoch: 5 | loss: 0.2390399
	speed: 0.0033s/iter; left time: 11.1855s
	iters: 900, epoch: 5 | loss: 0.2471639
	speed: 0.0033s/iter; left time: 10.8920s
	iters: 1000, epoch: 5 | loss: 0.4008504
	speed: 0.0033s/iter; left time: 10.5909s
Updating learning rate to 1.46580752125e-05
Epoch: 5 cost time: 3.529247999191284
Epoch: 5, Steps: 1045 | Train Loss: 0.3982115 Vali Loss: 0.2833582 Best vali loss: 0.2828976
	iters: 100, epoch: 6 | loss: 0.2122467
	speed: 0.0100s/iter; left time: 30.3701s
	iters: 200, epoch: 6 | loss: 0.2915354
	speed: 0.0033s/iter; left time: 9.8151s
	iters: 300, epoch: 6 | loss: 0.4070898
	speed: 0.0034s/iter; left time: 9.5321s
	iters: 400, epoch: 6 | loss: 0.4710587
	speed: 0.0033s/iter; left time: 9.1339s
	iters: 500, epoch: 6 | loss: 0.1297955
	speed: 0.0035s/iter; left time: 9.1090s
	iters: 600, epoch: 6 | loss: 0.5080361
	speed: 0.0031s/iter; left time: 7.8581s
	iters: 700, epoch: 6 | loss: 0.7356752
	speed: 0.0031s/iter; left time: 7.5904s
	iters: 800, epoch: 6 | loss: 0.1539989
	speed: 0.0031s/iter; left time: 7.2358s
	iters: 900, epoch: 6 | loss: 0.2864113
	speed: 0.0031s/iter; left time: 7.0286s
	iters: 1000, epoch: 6 | loss: 0.3446524
	speed: 0.0031s/iter; left time: 6.6932s
Updating learning rate to 7.32903760625e-06
Epoch: 6 cost time: 3.4172301292419434
Epoch: 6, Steps: 1045 | Train Loss: 0.3540500 Vali Loss: 0.2838934 Best vali loss: 0.2828976
	iters: 100, epoch: 7 | loss: 0.6954756
	speed: 0.0102s/iter; left time: 20.3040s
	iters: 200, epoch: 7 | loss: 0.9970095
	speed: 0.0031s/iter; left time: 5.8493s
	iters: 300, epoch: 7 | loss: 0.5692982
	speed: 0.0031s/iter; left time: 5.5352s
	iters: 400, epoch: 7 | loss: 0.1356845
	speed: 0.0031s/iter; left time: 5.2582s
	iters: 500, epoch: 7 | loss: 0.7872328
	speed: 0.0031s/iter; left time: 4.8707s
	iters: 600, epoch: 7 | loss: 0.4156255
	speed: 0.0031s/iter; left time: 4.5906s
	iters: 700, epoch: 7 | loss: 0.6598312
	speed: 0.0031s/iter; left time: 4.2432s
	iters: 800, epoch: 7 | loss: 0.4477611
	speed: 0.0030s/iter; left time: 3.8486s
	iters: 900, epoch: 7 | loss: 0.2210256
	speed: 0.0029s/iter; left time: 3.4707s
	iters: 1000, epoch: 7 | loss: 0.2254058
	speed: 0.0029s/iter; left time: 3.1860s
Updating learning rate to 3.664518803125e-06
Epoch: 7 cost time: 3.207926034927368
Epoch: 7, Steps: 1045 | Train Loss: 0.5154350 Vali Loss: 0.2866856 Best vali loss: 0.2828976
	iters: 100, epoch: 8 | loss: 0.5782449
	speed: 0.0098s/iter; left time: 9.3177s
	iters: 200, epoch: 8 | loss: 0.2107422
	speed: 0.0033s/iter; left time: 2.8074s
	iters: 300, epoch: 8 | loss: 0.2112338
	speed: 0.0033s/iter; left time: 2.4877s
	iters: 400, epoch: 8 | loss: 0.3334157
	speed: 0.0033s/iter; left time: 2.1595s
	iters: 500, epoch: 8 | loss: 0.1192872
	speed: 0.0034s/iter; left time: 1.8588s
	iters: 600, epoch: 8 | loss: 0.5766839
	speed: 0.0034s/iter; left time: 1.5067s
	iters: 700, epoch: 8 | loss: 0.2837342
	speed: 0.0034s/iter; left time: 1.1689s
	iters: 800, epoch: 8 | loss: 0.1778058
	speed: 0.0033s/iter; left time: 0.8141s
	iters: 900, epoch: 8 | loss: 0.1396032
	speed: 0.0033s/iter; left time: 0.4850s
	iters: 1000, epoch: 8 | loss: 0.8032739
	speed: 0.0033s/iter; left time: 0.1534s
Updating learning rate to 1.8322594015625e-06
Epoch: 8 cost time: 3.528289794921875
Epoch: 8, Steps: 1045 | Train Loss: 0.3434025 Vali Loss: 0.2878861 Best vali loss: 0.2828976

best validation loss 0.28289763965529996

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009552700577, 'e_layers': 2, 'learning_rate': 0.0002339836701, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5595843
	speed: 0.0107s/iter; left time: 10.1831s
Updating learning rate to 0.0002339836701
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9230589866638184
Epoch: 1, Steps: 131 | Train Loss: 0.5595843 Vali Loss: 0.2756451 Best vali loss: 0.2756451
	iters: 100, epoch: 2 | loss: 0.3249799
	speed: 0.0090s/iter; left time: 7.3496s
Updating learning rate to 0.00011699183505
Validation loss decreased (0.2756 --> 0.2712).  Saving model state dict ...
Epoch: 2 cost time: 0.7061407566070557
Epoch: 2, Steps: 131 | Train Loss: 0.3249799 Vali Loss: 0.2711819 Best vali loss: 0.2711819
	iters: 100, epoch: 3 | loss: 0.4606470
	speed: 0.0091s/iter; left time: 6.2776s
Updating learning rate to 5.8495917525e-05
Epoch: 3 cost time: 0.7075018882751465
Epoch: 3, Steps: 131 | Train Loss: 0.4606470 Vali Loss: 0.2773124 Best vali loss: 0.2711819
	iters: 100, epoch: 4 | loss: 0.5043381
	speed: 0.0086s/iter; left time: 4.7649s
Updating learning rate to 2.92479587625e-05
Epoch: 4 cost time: 0.6967728137969971
Epoch: 4, Steps: 131 | Train Loss: 0.5043381 Vali Loss: 0.2923364 Best vali loss: 0.2711819
	iters: 100, epoch: 5 | loss: 0.3373760
	speed: 0.0087s/iter; left time: 3.7039s
Updating learning rate to 1.462397938125e-05
Epoch: 5 cost time: 0.699887752532959
Epoch: 5, Steps: 131 | Train Loss: 0.3373760 Vali Loss: 0.2921379 Best vali loss: 0.2711819
	iters: 100, epoch: 6 | loss: 0.3178615
	speed: 0.0087s/iter; left time: 2.5507s
Updating learning rate to 7.311989690625e-06
Epoch: 6 cost time: 0.7083544731140137
Epoch: 6, Steps: 131 | Train Loss: 0.3178615 Vali Loss: 0.2949856 Best vali loss: 0.2711819
	iters: 100, epoch: 7 | loss: 0.3118485
	speed: 0.0087s/iter; left time: 1.4162s
Updating learning rate to 3.6559948453125e-06
Epoch: 7 cost time: 0.698509931564331
Epoch: 7, Steps: 131 | Train Loss: 0.3118485 Vali Loss: 0.3013533 Best vali loss: 0.2711819
	iters: 100, epoch: 8 | loss: 0.3965080
	speed: 0.0086s/iter; left time: 0.2742s
Updating learning rate to 1.82799742265625e-06
Epoch: 8 cost time: 0.6921646595001221
Epoch: 8, Steps: 131 | Train Loss: 0.3965080 Vali Loss: 0.3017769 Best vali loss: 0.2711819

best validation loss 0.2711818590400032

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3662886
	speed: 0.0085s/iter; left time: 70.4156s
	iters: 200, epoch: 1 | loss: 0.2519809
	speed: 0.0033s/iter; left time: 26.9507s
	iters: 300, epoch: 1 | loss: 0.2990781
	speed: 0.0033s/iter; left time: 26.6583s
	iters: 400, epoch: 1 | loss: 0.2896470
	speed: 0.0033s/iter; left time: 26.3869s
	iters: 500, epoch: 1 | loss: 0.1777367
	speed: 0.0033s/iter; left time: 26.2319s
	iters: 600, epoch: 1 | loss: 0.1720646
	speed: 0.0033s/iter; left time: 25.7403s
	iters: 700, epoch: 1 | loss: 0.7466667
	speed: 0.0033s/iter; left time: 25.1012s
	iters: 800, epoch: 1 | loss: 0.3461083
	speed: 0.0034s/iter; left time: 25.6311s
	iters: 900, epoch: 1 | loss: 0.2715504
	speed: 0.0034s/iter; left time: 25.5297s
	iters: 1000, epoch: 1 | loss: 0.6097280
	speed: 0.0034s/iter; left time: 25.0439s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2953).  Saving model state dict ...
Epoch: 1 cost time: 3.7558326721191406
Epoch: 1, Steps: 1045 | Train Loss: 0.3530849 Vali Loss: 0.2953288 Best vali loss: 0.2953288
	iters: 100, epoch: 2 | loss: 0.8785657
	speed: 0.0104s/iter; left time: 74.7318s
	iters: 200, epoch: 2 | loss: 0.4220332
	speed: 0.0033s/iter; left time: 23.7423s
	iters: 300, epoch: 2 | loss: 0.3159912
	speed: 0.0033s/iter; left time: 23.3678s
	iters: 400, epoch: 2 | loss: 0.5426643
	speed: 0.0033s/iter; left time: 23.0470s
	iters: 500, epoch: 2 | loss: 0.3500074
	speed: 0.0033s/iter; left time: 22.7220s
	iters: 600, epoch: 2 | loss: 0.3127593
	speed: 0.0034s/iter; left time: 23.0508s
	iters: 700, epoch: 2 | loss: 0.6432618
	speed: 0.0034s/iter; left time: 22.2661s
	iters: 800, epoch: 2 | loss: 0.3037394
	speed: 0.0035s/iter; left time: 22.8854s
	iters: 900, epoch: 2 | loss: 0.8753076
	speed: 0.0032s/iter; left time: 20.3866s
	iters: 1000, epoch: 2 | loss: 0.1904483
	speed: 0.0030s/iter; left time: 18.9466s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2953 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 3.4903905391693115
Epoch: 2, Steps: 1045 | Train Loss: 0.4834778 Vali Loss: 0.2808660 Best vali loss: 0.2808660
	iters: 100, epoch: 3 | loss: 0.4283951
	speed: 0.0101s/iter; left time: 62.5641s
	iters: 200, epoch: 3 | loss: 0.6020361
	speed: 0.0030s/iter; left time: 18.3328s
	iters: 300, epoch: 3 | loss: 0.4913516
	speed: 0.0030s/iter; left time: 18.1366s
	iters: 400, epoch: 3 | loss: 0.1951362
	speed: 0.0031s/iter; left time: 17.9180s
	iters: 500, epoch: 3 | loss: 0.3365032
	speed: 0.0031s/iter; left time: 17.6649s
	iters: 600, epoch: 3 | loss: 0.1207852
	speed: 0.0031s/iter; left time: 17.3784s
	iters: 700, epoch: 3 | loss: 1.1290256
	speed: 0.0030s/iter; left time: 16.8918s
	iters: 800, epoch: 3 | loss: 0.9698770
	speed: 0.0031s/iter; left time: 16.7440s
	iters: 900, epoch: 3 | loss: 0.2971636
	speed: 0.0031s/iter; left time: 16.4437s
	iters: 1000, epoch: 3 | loss: 0.5893135
	speed: 0.0030s/iter; left time: 16.0375s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 3.2226758003234863
Epoch: 3, Steps: 1045 | Train Loss: 0.5159587 Vali Loss: 0.2833526 Best vali loss: 0.2808660

best validation loss 0.28086599020454334

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345656375, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597034
	speed: 0.0103s/iter; left time: 9.7705s
Updating learning rate to 0.0002345656375
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.924809455871582
Epoch: 1, Steps: 131 | Train Loss: 0.5597034 Vali Loss: 0.2756360 Best vali loss: 0.2756360
	iters: 100, epoch: 2 | loss: 0.3255763
	speed: 0.0088s/iter; left time: 7.2015s
Updating learning rate to 0.00011728281875
Validation loss decreased (0.2756 --> 0.2706).  Saving model state dict ...
Epoch: 2 cost time: 0.7004852294921875
Epoch: 2, Steps: 131 | Train Loss: 0.3255763 Vali Loss: 0.2706166 Best vali loss: 0.2706166
	iters: 100, epoch: 3 | loss: 0.4633271
	speed: 0.0091s/iter; left time: 6.2425s
Updating learning rate to 5.8641409375e-05
Epoch: 3 cost time: 0.7068595886230469
Epoch: 3, Steps: 131 | Train Loss: 0.4633271 Vali Loss: 0.2768063 Best vali loss: 0.2706166

best validation loss 0.2706166034118976

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021940145954, 'e_layers': 2, 'learning_rate': 8.7142091e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.7142091e-05
Validation loss decreased (inf --> 0.3152).  Saving model state dict ...
Epoch: 1 cost time: 0.5733201503753662
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3152000 Best vali loss: 0.3152000
Updating learning rate to 4.35710455e-05
Validation loss decreased (0.3152 --> 0.2959).  Saving model state dict ...
Epoch: 2 cost time: 0.3248567581176758
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2958805 Best vali loss: 0.2958805
Updating learning rate to 2.178552275e-05
Validation loss decreased (0.2959 --> 0.2908).  Saving model state dict ...
Epoch: 3 cost time: 0.3376333713531494
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2907600 Best vali loss: 0.2907600

best validation loss 0.2907599878271258

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345656375, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4215112
	speed: 0.0106s/iter; left time: 5.8780s
Updating learning rate to 2.93207046875e-05
Epoch: 4 cost time: 0.9241397380828857
Epoch: 4, Steps: 131 | Train Loss: 0.4215112 Vali Loss: 0.3093794 Best vali loss: 0.2706166
	iters: 100, epoch: 5 | loss: 0.2794428
	speed: 0.0086s/iter; left time: 3.6584s
Updating learning rate to 1.466035234375e-05
Epoch: 5 cost time: 0.6938347816467285
Epoch: 5, Steps: 131 | Train Loss: 0.2794428 Vali Loss: 0.3007556 Best vali loss: 0.2706166
	iters: 100, epoch: 6 | loss: 0.4335238
	speed: 0.0085s/iter; left time: 2.4929s
Updating learning rate to 7.330176171875e-06
Epoch: 6 cost time: 0.6893634796142578
Epoch: 6, Steps: 131 | Train Loss: 0.4335238 Vali Loss: 0.3041361 Best vali loss: 0.2706166
	iters: 100, epoch: 7 | loss: 0.4619540
	speed: 0.0086s/iter; left time: 1.3963s
Updating learning rate to 3.6650880859375e-06
Epoch: 7 cost time: 0.6992092132568359
Epoch: 7, Steps: 131 | Train Loss: 0.4619540 Vali Loss: 0.3028732 Best vali loss: 0.2706166
	iters: 100, epoch: 8 | loss: 0.3273402
	speed: 0.0086s/iter; left time: 0.2744s
Updating learning rate to 1.83254404296875e-06
Epoch: 8 cost time: 0.6960783004760742
Epoch: 8, Steps: 131 | Train Loss: 0.3273402 Vali Loss: 0.3001969 Best vali loss: 0.2706166

best validation loss 0.2706166034118976

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597192
	speed: 0.0104s/iter; left time: 9.9052s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9275832176208496
Epoch: 1, Steps: 131 | Train Loss: 0.5597192 Vali Loss: 0.2756283 Best vali loss: 0.2756283
	iters: 100, epoch: 2 | loss: 0.3242410
	speed: 0.0089s/iter; left time: 7.2403s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2683).  Saving model state dict ...
Epoch: 2 cost time: 0.6954147815704346
Epoch: 2, Steps: 131 | Train Loss: 0.3242410 Vali Loss: 0.2682513 Best vali loss: 0.2682513
	iters: 100, epoch: 3 | loss: 0.4595214
	speed: 0.0090s/iter; left time: 6.1929s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7050795555114746
Epoch: 3, Steps: 131 | Train Loss: 0.4595214 Vali Loss: 0.2758089 Best vali loss: 0.2682513
	iters: 100, epoch: 4 | loss: 0.5027649
	speed: 0.0087s/iter; left time: 4.8131s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7040479183197021
Epoch: 4, Steps: 131 | Train Loss: 0.5027649 Vali Loss: 0.2937009 Best vali loss: 0.2682513
	iters: 100, epoch: 5 | loss: 0.3329694
	speed: 0.0087s/iter; left time: 3.6859s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7013733386993408
Epoch: 5, Steps: 131 | Train Loss: 0.3329694 Vali Loss: 0.2905674 Best vali loss: 0.2682513
	iters: 100, epoch: 6 | loss: 0.3195593
	speed: 0.0087s/iter; left time: 2.5575s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7023622989654541
Epoch: 6, Steps: 131 | Train Loss: 0.3195593 Vali Loss: 0.2867512 Best vali loss: 0.2682513
	iters: 100, epoch: 7 | loss: 0.3125356
	speed: 0.0087s/iter; left time: 1.4166s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7018773555755615
Epoch: 7, Steps: 131 | Train Loss: 0.3125356 Vali Loss: 0.2939808 Best vali loss: 0.2682513
	iters: 100, epoch: 8 | loss: 0.3974875
	speed: 0.0087s/iter; left time: 0.2787s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6962811946868896
Epoch: 8, Steps: 131 | Train Loss: 0.3974875 Vali Loss: 0.2948959 Best vali loss: 0.2682513

best validation loss 0.2682512956908663

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0088218926041, 'e_layers': 4, 'learning_rate': 0.001848719585, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6320112
	speed: 0.0109s/iter; left time: 10.3363s
Updating learning rate to 0.00177835688546713
Validation loss decreased (inf --> 0.3036).  Saving model state dict ...
Epoch: 1 cost time: 1.0094356536865234
Epoch: 1, Steps: 131 | Train Loss: 0.6320112 Vali Loss: 0.3036140 Best vali loss: 0.3036140
	iters: 100, epoch: 2 | loss: 0.5730146
	speed: 0.0092s/iter; left time: 7.5329s
Updating learning rate to 0.0015779808700329399
Validation loss decreased (0.3036 --> 0.3026).  Saving model state dict ...
Epoch: 2 cost time: 0.7606651782989502
Epoch: 2, Steps: 131 | Train Loss: 0.5730146 Vali Loss: 0.3026432 Best vali loss: 0.3026432
	iters: 100, epoch: 3 | loss: 0.7117800
	speed: 0.0094s/iter; left time: 6.4486s
Updating learning rate to 0.0012780969706341822
Epoch: 3 cost time: 0.7932929992675781
Epoch: 3, Steps: 131 | Train Loss: 0.7117800 Vali Loss: 0.3049767 Best vali loss: 0.3026432
	iters: 100, epoch: 4 | loss: 0.4597515
	speed: 0.0094s/iter; left time: 5.2249s
Updating learning rate to 0.0009243597925
Validation loss decreased (0.3026 --> 0.2921).  Saving model state dict ...
Epoch: 4 cost time: 0.7912161350250244
Epoch: 4, Steps: 131 | Train Loss: 0.4597515 Vali Loss: 0.2920752 Best vali loss: 0.2920752
	iters: 100, epoch: 5 | loss: 0.3908288
	speed: 0.0093s/iter; left time: 3.9621s
Updating learning rate to 0.0005706226143658179
Epoch: 5 cost time: 0.7744982242584229
Epoch: 5, Steps: 131 | Train Loss: 0.3908288 Vali Loss: 0.2994000 Best vali loss: 0.2920752
	iters: 100, epoch: 6 | loss: 0.4190523
	speed: 0.0087s/iter; left time: 2.5583s
Updating learning rate to 0.0002707387149670601
Epoch: 6 cost time: 0.7139701843261719
Epoch: 6, Steps: 131 | Train Loss: 0.4190523 Vali Loss: 0.2939561 Best vali loss: 0.2920752
	iters: 100, epoch: 7 | loss: 0.6053495
	speed: 0.0087s/iter; left time: 1.4133s
Updating learning rate to 7.036269953286999e-05
Epoch: 7 cost time: 0.7157008647918701
Epoch: 7, Steps: 131 | Train Loss: 0.6053495 Vali Loss: 0.3023685 Best vali loss: 0.2920752
	iters: 100, epoch: 8 | loss: 0.4228298
	speed: 0.0086s/iter; left time: 0.2760s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7271814346313477
Epoch: 8, Steps: 131 | Train Loss: 0.4228298 Vali Loss: 0.3009599 Best vali loss: 0.2920752

best validation loss 0.2920751650511177

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0093062962736, 'e_layers': 4, 'learning_rate': 0.004604809476, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6980897
	speed: 0.0109s/iter; left time: 10.3779s
Updating learning rate to 0.004604809476
Validation loss decreased (inf --> 0.3302).  Saving model state dict ...
Epoch: 1 cost time: 1.001368761062622
Epoch: 1, Steps: 131 | Train Loss: 0.6980897 Vali Loss: 0.3301600 Best vali loss: 0.3301600
	iters: 100, epoch: 2 | loss: 0.7832168
	speed: 0.0089s/iter; left time: 7.2760s
Updating learning rate to 0.002302404738
Validation loss decreased (0.3302 --> 0.3228).  Saving model state dict ...
Epoch: 2 cost time: 0.7108032703399658
Epoch: 2, Steps: 131 | Train Loss: 0.7832168 Vali Loss: 0.3228226 Best vali loss: 0.3228226
	iters: 100, epoch: 3 | loss: 0.6392645
	speed: 0.0093s/iter; left time: 6.3836s
Updating learning rate to 0.001151202369
Validation loss decreased (0.3228 --> 0.3221).  Saving model state dict ...
Epoch: 3 cost time: 0.8025290966033936
Epoch: 3, Steps: 131 | Train Loss: 0.6392645 Vali Loss: 0.3221197 Best vali loss: 0.3221197

best validation loss 0.3221196853713326

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6861063
	speed: 0.0087s/iter; left time: 8.2736s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2936).  Saving model state dict ...
Epoch: 1 cost time: 0.7170217037200928
Epoch: 1, Steps: 131 | Train Loss: 0.6861063 Vali Loss: 0.2935699 Best vali loss: 0.2935699
	iters: 100, epoch: 2 | loss: 0.7137581
	speed: 0.0064s/iter; left time: 5.2058s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2936 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 0.5113542079925537
Epoch: 2, Steps: 131 | Train Loss: 0.7137581 Vali Loss: 0.2830493 Best vali loss: 0.2830493
	iters: 100, epoch: 3 | loss: 0.3722335
	speed: 0.0063s/iter; left time: 4.2939s
Updating learning rate to 5.8620599525e-05
Validation loss decreased (0.2830 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 0.49626708030700684
Epoch: 3, Steps: 131 | Train Loss: 0.3722335 Vali Loss: 0.2813075 Best vali loss: 0.2813075

best validation loss 0.28130750416844874

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010266902592, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6860982
	speed: 0.0094s/iter; left time: 8.9005s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2936).  Saving model state dict ...
Epoch: 1 cost time: 0.7712142467498779
Epoch: 1, Steps: 131 | Train Loss: 0.6860982 Vali Loss: 0.2935659 Best vali loss: 0.2935659
	iters: 100, epoch: 2 | loss: 0.7137509
	speed: 0.0063s/iter; left time: 5.1922s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2936 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 0.5064740180969238
Epoch: 2, Steps: 131 | Train Loss: 0.7137509 Vali Loss: 0.2830496 Best vali loss: 0.2830496
	iters: 100, epoch: 3 | loss: 0.3722324
	speed: 0.0066s/iter; left time: 4.5025s
Updating learning rate to 5.863230085e-05
Validation loss decreased (0.2830 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 0.508744478225708
Epoch: 3, Steps: 131 | Train Loss: 0.3722324 Vali Loss: 0.2813076 Best vali loss: 0.2813076

best validation loss 0.2813076239485154

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6420767
	speed: 0.0092s/iter; left time: 5.1274s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.7748825550079346
Epoch: 4, Steps: 131 | Train Loss: 0.6420767 Vali Loss: 0.2814638 Best vali loss: 0.2813075
	iters: 100, epoch: 5 | loss: 0.6995653
	speed: 0.0067s/iter; left time: 2.8442s
Updating learning rate to 1.465514988125e-05
Validation loss decreased (0.2813 --> 0.2809).  Saving model state dict ...
Epoch: 5 cost time: 0.5188159942626953
Epoch: 5, Steps: 131 | Train Loss: 0.6995653 Vali Loss: 0.2809433 Best vali loss: 0.2809433
	iters: 100, epoch: 6 | loss: 0.3673664
	speed: 0.0066s/iter; left time: 1.9360s
Updating learning rate to 7.327574940625e-06
Validation loss decreased (0.2809 --> 0.2808).  Saving model state dict ...
Epoch: 6 cost time: 0.5243756771087646
Epoch: 6, Steps: 131 | Train Loss: 0.3673664 Vali Loss: 0.2808361 Best vali loss: 0.2808361
	iters: 100, epoch: 7 | loss: 0.3894901
	speed: 0.0064s/iter; left time: 1.0450s
Updating learning rate to 3.6637874703125e-06
Validation loss decreased (0.2808 --> 0.2808).  Saving model state dict ...
Epoch: 7 cost time: 0.5103087425231934
Epoch: 7, Steps: 131 | Train Loss: 0.3894901 Vali Loss: 0.2808046 Best vali loss: 0.2808046
	iters: 100, epoch: 8 | loss: 0.7139167
	speed: 0.0066s/iter; left time: 0.2105s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.5105404853820801
Epoch: 8, Steps: 131 | Train Loss: 0.7139167 Vali Loss: 0.2808073 Best vali loss: 0.2808046

best validation loss 0.2808045650468346

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6861057
	speed: 0.0091s/iter; left time: 8.6344s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2936).  Saving model state dict ...
Epoch: 1 cost time: 0.7489283084869385
Epoch: 1, Steps: 131 | Train Loss: 0.6861057 Vali Loss: 0.2935696 Best vali loss: 0.2935696
	iters: 100, epoch: 2 | loss: 0.7137589
	speed: 0.0065s/iter; left time: 5.3310s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2936 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 0.518204927444458
Epoch: 2, Steps: 131 | Train Loss: 0.7137589 Vali Loss: 0.2830491 Best vali loss: 0.2830491
	iters: 100, epoch: 3 | loss: 0.3722327
	speed: 0.0067s/iter; left time: 4.5796s
Updating learning rate to 5.862147895e-05
Validation loss decreased (0.2830 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 0.5311102867126465
Epoch: 3, Steps: 131 | Train Loss: 0.3722327 Vali Loss: 0.2813073 Best vali loss: 0.2813073
	iters: 100, epoch: 4 | loss: 0.3880946
	speed: 0.0064s/iter; left time: 3.5707s
Updating learning rate to 2.9310739475e-05
Validation loss decreased (0.2813 --> 0.2810).  Saving model state dict ...
Epoch: 4 cost time: 0.5025286674499512
Epoch: 4, Steps: 131 | Train Loss: 0.3880946 Vali Loss: 0.2810310 Best vali loss: 0.2810310
	iters: 100, epoch: 5 | loss: 0.7178543
	speed: 0.0064s/iter; left time: 2.7235s
Updating learning rate to 1.46553697375e-05
Validation loss decreased (0.2810 --> 0.2808).  Saving model state dict ...
Epoch: 5 cost time: 0.5133237838745117
Epoch: 5, Steps: 131 | Train Loss: 0.7178543 Vali Loss: 0.2807702 Best vali loss: 0.2807702
	iters: 100, epoch: 6 | loss: 0.9332871
	speed: 0.0064s/iter; left time: 1.8824s
Updating learning rate to 7.32768486875e-06
Validation loss decreased (0.2808 --> 0.2807).  Saving model state dict ...
Epoch: 6 cost time: 0.4979221820831299
Epoch: 6, Steps: 131 | Train Loss: 0.9332871 Vali Loss: 0.2807003 Best vali loss: 0.2807003
	iters: 100, epoch: 7 | loss: 0.5756082
	speed: 0.0062s/iter; left time: 1.0128s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 0.4931502342224121
Epoch: 7, Steps: 131 | Train Loss: 0.5756082 Vali Loss: 0.2807674 Best vali loss: 0.2807003
	iters: 100, epoch: 8 | loss: 0.5175461
	speed: 0.0068s/iter; left time: 0.2170s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 0.5579216480255127
Epoch: 8, Steps: 131 | Train Loss: 0.5175461 Vali Loss: 0.2807589 Best vali loss: 0.2807003

best validation loss 0.2807003176314275

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022597711689, 'e_layers': 4, 'learning_rate': 0.0018966089138, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0508612
	speed: 0.0105s/iter; left time: 42.7191s
	iters: 200, epoch: 1 | loss: 0.9523950
	speed: 0.0051s/iter; left time: 20.1284s
	iters: 300, epoch: 1 | loss: 0.8475858
	speed: 0.0051s/iter; left time: 19.9151s
	iters: 400, epoch: 1 | loss: 1.0780543
	speed: 0.0050s/iter; left time: 19.0239s
	iters: 500, epoch: 1 | loss: 0.7457333
	speed: 0.0051s/iter; left time: 18.6902s
Updating learning rate to 0.0018244235352191417
Validation loss decreased (inf --> 0.3431).  Saving model state dict ...
Epoch: 1 cost time: 2.922649383544922
Epoch: 1, Steps: 523 | Train Loss: 0.9349259 Vali Loss: 0.3431150 Best vali loss: 0.3431150
	iters: 100, epoch: 2 | loss: 0.3142855
	speed: 0.0103s/iter; left time: 36.5305s
	iters: 200, epoch: 2 | loss: 0.2896951
	speed: 0.0052s/iter; left time: 18.0442s
	iters: 300, epoch: 2 | loss: 0.5332441
	speed: 0.0052s/iter; left time: 17.3968s
	iters: 400, epoch: 2 | loss: 0.4542115
	speed: 0.0049s/iter; left time: 16.0469s
	iters: 500, epoch: 2 | loss: 0.6936678
	speed: 0.0049s/iter; left time: 15.5470s
Updating learning rate to 0.001618856969003416
Validation loss decreased (0.3431 --> 0.3235).  Saving model state dict ...
Epoch: 2 cost time: 2.6904938220977783
Epoch: 2, Steps: 523 | Train Loss: 0.4570208 Vali Loss: 0.3235267 Best vali loss: 0.3235267
	iters: 100, epoch: 3 | loss: 0.7101151
	speed: 0.0101s/iter; left time: 30.5453s
	iters: 200, epoch: 3 | loss: 0.3021002
	speed: 0.0045s/iter; left time: 13.3092s
	iters: 300, epoch: 3 | loss: 0.7108321
	speed: 0.0046s/iter; left time: 12.9646s
	iters: 400, epoch: 3 | loss: 0.3585390
	speed: 0.0046s/iter; left time: 12.6168s
	iters: 500, epoch: 3 | loss: 0.8871898
	speed: 0.0046s/iter; left time: 12.0813s
Updating learning rate to 0.0013112048613936045
Validation loss decreased (0.3235 --> 0.3203).  Saving model state dict ...
Epoch: 3 cost time: 2.4468297958374023
Epoch: 3, Steps: 523 | Train Loss: 0.5937553 Vali Loss: 0.3203143 Best vali loss: 0.3203143
	iters: 100, epoch: 4 | loss: 0.2569923
	speed: 0.0104s/iter; left time: 26.1279s
	iters: 200, epoch: 4 | loss: 0.6964116
	speed: 0.0052s/iter; left time: 12.6477s
	iters: 300, epoch: 4 | loss: 0.8865288
	speed: 0.0052s/iter; left time: 12.1489s
	iters: 400, epoch: 4 | loss: 0.3874958
	speed: 0.0053s/iter; left time: 11.6622s
	iters: 500, epoch: 4 | loss: 0.5243494
	speed: 0.0052s/iter; left time: 11.1030s
Updating learning rate to 0.0009483044569
Validation loss decreased (0.3203 --> 0.3184).  Saving model state dict ...
Epoch: 4 cost time: 2.7827517986297607
Epoch: 4, Steps: 523 | Train Loss: 0.5503556 Vali Loss: 0.3183533 Best vali loss: 0.3183533
	iters: 100, epoch: 5 | loss: 0.3701147
	speed: 0.0103s/iter; left time: 20.5981s
	iters: 200, epoch: 5 | loss: 0.3866223
	speed: 0.0052s/iter; left time: 9.9131s
	iters: 300, epoch: 5 | loss: 0.4441674
	speed: 0.0052s/iter; left time: 9.2503s
	iters: 400, epoch: 5 | loss: 0.4972748
	speed: 0.0051s/iter; left time: 8.6578s
	iters: 500, epoch: 5 | loss: 0.3117078
	speed: 0.0052s/iter; left time: 8.2113s
Updating learning rate to 0.0005854040524063957
Epoch: 5 cost time: 2.734848976135254
Epoch: 5, Steps: 523 | Train Loss: 0.4019774 Vali Loss: 0.3229485 Best vali loss: 0.3183533
	iters: 100, epoch: 6 | loss: 0.4610366
	speed: 0.0103s/iter; left time: 15.1949s
	iters: 200, epoch: 6 | loss: 0.5225849
	speed: 0.0052s/iter; left time: 7.1581s
	iters: 300, epoch: 6 | loss: 0.5937871
	speed: 0.0053s/iter; left time: 6.6796s
	iters: 400, epoch: 6 | loss: 0.4216737
	speed: 0.0050s/iter; left time: 5.8928s
	iters: 500, epoch: 6 | loss: 0.6520607
	speed: 0.0047s/iter; left time: 5.0550s
Updating learning rate to 0.000277751944796584
Epoch: 6 cost time: 2.6812288761138916
Epoch: 6, Steps: 523 | Train Loss: 0.5302286 Vali Loss: 0.3219002 Best vali loss: 0.3183533
	iters: 100, epoch: 7 | loss: 1.0308249
	speed: 0.0094s/iter; left time: 8.8670s
	iters: 200, epoch: 7 | loss: 0.3096777
	speed: 0.0049s/iter; left time: 4.1425s
	iters: 300, epoch: 7 | loss: 0.7620939
	speed: 0.0047s/iter; left time: 3.5119s
	iters: 400, epoch: 7 | loss: 0.4161172
	speed: 0.0047s/iter; left time: 3.0343s
	iters: 500, epoch: 7 | loss: 0.5690148
	speed: 0.0048s/iter; left time: 2.6013s
Updating learning rate to 7.218537858085834e-05
Epoch: 7 cost time: 2.5007338523864746
Epoch: 7, Steps: 523 | Train Loss: 0.6175457 Vali Loss: 0.3225579 Best vali loss: 0.3183533
	iters: 100, epoch: 8 | loss: 0.3765407
	speed: 0.0098s/iter; left time: 4.1395s
	iters: 200, epoch: 8 | loss: 0.4423325
	speed: 0.0048s/iter; left time: 1.5655s
	iters: 300, epoch: 8 | loss: 0.6286142
	speed: 0.0049s/iter; left time: 1.0967s
	iters: 400, epoch: 8 | loss: 0.6538481
	speed: 0.0050s/iter; left time: 0.6149s
	iters: 500, epoch: 8 | loss: 0.3484484
	speed: 0.0049s/iter; left time: 0.1187s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.6045849323272705
Epoch: 8, Steps: 523 | Train Loss: 0.4899568 Vali Loss: 0.3224304 Best vali loss: 0.3183533

best validation loss 0.31835329016153147

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6200974
	speed: 0.0097s/iter; left time: 9.2266s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 0.7671370506286621
Epoch: 1, Steps: 131 | Train Loss: 0.6200974 Vali Loss: 0.3112050 Best vali loss: 0.3112050
	iters: 100, epoch: 2 | loss: 0.6486608
	speed: 0.0066s/iter; left time: 5.4109s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.3112 --> 0.2948).  Saving model state dict ...
Epoch: 2 cost time: 0.5103304386138916
Epoch: 2, Steps: 131 | Train Loss: 0.6486608 Vali Loss: 0.2948357 Best vali loss: 0.2948357
	iters: 100, epoch: 3 | loss: 0.3054154
	speed: 0.0065s/iter; left time: 4.4511s
Updating learning rate to 5.8620599525e-05
Validation loss decreased (0.2948 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 0.5099940299987793
Epoch: 3, Steps: 131 | Train Loss: 0.3054154 Vali Loss: 0.2905856 Best vali loss: 0.2905856

best validation loss 0.2905855732320542

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6200874
	speed: 0.0096s/iter; left time: 9.0846s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 0.73311448097229
Epoch: 1, Steps: 131 | Train Loss: 0.6200874 Vali Loss: 0.3112004 Best vali loss: 0.3112004
	iters: 100, epoch: 2 | loss: 0.6489525
	speed: 0.0070s/iter; left time: 5.6965s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.3112 --> 0.2953).  Saving model state dict ...
Epoch: 2 cost time: 0.5772569179534912
Epoch: 2, Steps: 131 | Train Loss: 0.6489525 Vali Loss: 0.2952531 Best vali loss: 0.2952531
	iters: 100, epoch: 3 | loss: 0.3019913
	speed: 0.0065s/iter; left time: 4.4646s
Updating learning rate to 0.00016213827184708514
Validation loss decreased (0.2953 --> 0.2887).  Saving model state dict ...
Epoch: 3 cost time: 0.49787163734436035
Epoch: 3, Steps: 131 | Train Loss: 0.3019913 Vali Loss: 0.2887147 Best vali loss: 0.2887147

best validation loss 0.2887146811628927

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002341627361, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6201730
	speed: 0.0097s/iter; left time: 9.2246s
Updating learning rate to 0.0002341627361
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 0.753972053527832
Epoch: 1, Steps: 131 | Train Loss: 0.6201730 Vali Loss: 0.3112371 Best vali loss: 0.3112371
	iters: 100, epoch: 2 | loss: 0.6486923
	speed: 0.0068s/iter; left time: 5.5445s
Updating learning rate to 0.00011708136805
Validation loss decreased (0.3112 --> 0.2949).  Saving model state dict ...
Epoch: 2 cost time: 0.5510730743408203
Epoch: 2, Steps: 131 | Train Loss: 0.6486923 Vali Loss: 0.2948664 Best vali loss: 0.2948664
	iters: 100, epoch: 3 | loss: 0.3054610
	speed: 0.0068s/iter; left time: 4.6719s
Updating learning rate to 5.8540684025e-05
Validation loss decreased (0.2949 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 0.5506629943847656
Epoch: 3, Steps: 131 | Train Loss: 0.3054610 Vali Loss: 0.2906112 Best vali loss: 0.2906112

best validation loss 0.2906111590966012

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5645682
	speed: 0.0101s/iter; left time: 5.5927s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2887 --> 0.2855).  Saving model state dict ...
Epoch: 4 cost time: 0.7897515296936035
Epoch: 4, Steps: 131 | Train Loss: 0.5645682 Vali Loss: 0.2854885 Best vali loss: 0.2854885
	iters: 100, epoch: 5 | loss: 0.6213312
	speed: 0.0065s/iter; left time: 2.7566s
Updating learning rate to 7.238868935291489e-05
Validation loss decreased (0.2855 --> 0.2832).  Saving model state dict ...
Epoch: 5 cost time: 0.49547386169433594
Epoch: 5, Steps: 131 | Train Loss: 0.6213312 Vali Loss: 0.2831569 Best vali loss: 0.2831569
	iters: 100, epoch: 6 | loss: 0.2916496
	speed: 0.0061s/iter; left time: 1.8011s
Updating learning rate to 3.434567828220285e-05
Validation loss decreased (0.2832 --> 0.2829).  Saving model state dict ...
Epoch: 6 cost time: 0.4856538772583008
Epoch: 6, Steps: 131 | Train Loss: 0.2916496 Vali Loss: 0.2829270 Best vali loss: 0.2829270
	iters: 100, epoch: 7 | loss: 0.6857756
	speed: 0.0060s/iter; left time: 0.9789s
Updating learning rate to 8.92615096262566e-06
Validation loss decreased (0.2829 --> 0.2826).  Saving model state dict ...
Epoch: 7 cost time: 0.48050951957702637
Epoch: 7, Steps: 131 | Train Loss: 0.6857756 Vali Loss: 0.2825788 Best vali loss: 0.2825788
	iters: 100, epoch: 8 | loss: 0.7057882
	speed: 0.0060s/iter; left time: 0.1920s
Updating learning rate to 0.0
Validation loss decreased (0.2826 --> 0.2825).  Saving model state dict ...
Epoch: 8 cost time: 0.47736072540283203
Epoch: 8, Steps: 131 | Train Loss: 0.7057882 Vali Loss: 0.2824826 Best vali loss: 0.2824826

best validation loss 0.2824825821267756

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010261589177, 'e_layers': 4, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4539925
	speed: 0.0156s/iter; left time: 14.7643s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.5310897827148438
Epoch: 1, Steps: 131 | Train Loss: 0.4539925 Vali Loss: 0.2814095 Best vali loss: 0.2814095
	iters: 100, epoch: 2 | loss: 0.4804446
	speed: 0.0154s/iter; left time: 12.6293s
Updating learning rate to 0.00011724119905
Epoch: 2 cost time: 1.2826335430145264
Epoch: 2, Steps: 131 | Train Loss: 0.4804446 Vali Loss: 0.2874864 Best vali loss: 0.2814095
	iters: 100, epoch: 3 | loss: 0.4041847
	speed: 0.0151s/iter; left time: 10.4071s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 1.2806472778320312
Epoch: 3, Steps: 131 | Train Loss: 0.4041847 Vali Loss: 0.2984240 Best vali loss: 0.2814095
	iters: 100, epoch: 4 | loss: 0.3878454
	speed: 0.0150s/iter; left time: 8.3183s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 1.2811672687530518
Epoch: 4, Steps: 131 | Train Loss: 0.3878454 Vali Loss: 0.2872914 Best vali loss: 0.2814095
	iters: 100, epoch: 5 | loss: 0.4549539
	speed: 0.0150s/iter; left time: 6.3937s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 1.2808942794799805
Epoch: 5, Steps: 131 | Train Loss: 0.4549539 Vali Loss: 0.3086404 Best vali loss: 0.2814095
	iters: 100, epoch: 6 | loss: 0.4885069
	speed: 0.0151s/iter; left time: 4.4532s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 1.2877979278564453
Epoch: 6, Steps: 131 | Train Loss: 0.4885069 Vali Loss: 0.2955365 Best vali loss: 0.2814095
	iters: 100, epoch: 7 | loss: 0.3856914
	speed: 0.0151s/iter; left time: 2.4650s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 1.284430980682373
Epoch: 7, Steps: 131 | Train Loss: 0.3856914 Vali Loss: 0.2973349 Best vali loss: 0.2814095
	iters: 100, epoch: 8 | loss: 0.3678334
	speed: 0.0152s/iter; left time: 0.4850s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 1.2927193641662598
Epoch: 8, Steps: 131 | Train Loss: 0.3678334 Vali Loss: 0.3043271 Best vali loss: 0.2814095

best validation loss 0.2814095331007506

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0009554616945, 'e_layers': 2, 'learning_rate': 5.1564547e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6917701
	speed: 0.0095s/iter; left time: 9.0532s
Updating learning rate to 4.960198828825814e-05
Validation loss decreased (inf --> 0.3444).  Saving model state dict ...
Epoch: 1 cost time: 0.7393548488616943
Epoch: 1, Steps: 131 | Train Loss: 0.6917701 Vali Loss: 0.3443633 Best vali loss: 0.3443633
	iters: 100, epoch: 2 | loss: 0.6819196
	speed: 0.0062s/iter; left time: 5.0972s
Updating learning rate to 4.401309392625622e-05
Validation loss decreased (0.3444 --> 0.3308).  Saving model state dict ...
Epoch: 2 cost time: 0.48188138008117676
Epoch: 2, Steps: 131 | Train Loss: 0.6819196 Vali Loss: 0.3308335 Best vali loss: 0.3308335
	iters: 100, epoch: 3 | loss: 0.3514827
	speed: 0.0061s/iter; left time: 4.1751s
Updating learning rate to 3.56487224171555e-05
Validation loss decreased (0.3308 --> 0.3221).  Saving model state dict ...
Epoch: 3 cost time: 0.484128475189209
Epoch: 3, Steps: 131 | Train Loss: 0.3514827 Vali Loss: 0.3220599 Best vali loss: 0.3220599
	iters: 100, epoch: 4 | loss: 0.7277141
	speed: 0.0067s/iter; left time: 3.7217s
Updating learning rate to 2.57822735e-05
Validation loss decreased (0.3221 --> 0.3167).  Saving model state dict ...
Epoch: 4 cost time: 0.554823637008667
Epoch: 4, Steps: 131 | Train Loss: 0.7277141 Vali Loss: 0.3166574 Best vali loss: 0.3166574
	iters: 100, epoch: 5 | loss: 0.7395460
	speed: 0.0065s/iter; left time: 2.7473s
Updating learning rate to 1.5915824582844506e-05
Validation loss decreased (0.3167 --> 0.3132).  Saving model state dict ...
Epoch: 5 cost time: 0.49709129333496094
Epoch: 5, Steps: 131 | Train Loss: 0.7395460 Vali Loss: 0.3132424 Best vali loss: 0.3132424
	iters: 100, epoch: 6 | loss: 0.6104829
	speed: 0.0062s/iter; left time: 1.8338s
Updating learning rate to 7.551453073743779e-06
Validation loss decreased (0.3132 --> 0.3114).  Saving model state dict ...
Epoch: 6 cost time: 0.4977591037750244
Epoch: 6, Steps: 131 | Train Loss: 0.6104829 Vali Loss: 0.3114363 Best vali loss: 0.3114363
	iters: 100, epoch: 7 | loss: 0.7096533
	speed: 0.0065s/iter; left time: 1.0670s
Updating learning rate to 1.9625587117418635e-06
Validation loss decreased (0.3114 --> 0.3106).  Saving model state dict ...
Epoch: 7 cost time: 0.5506336688995361
Epoch: 7, Steps: 131 | Train Loss: 0.7096533 Vali Loss: 0.3106252 Best vali loss: 0.3106252
	iters: 100, epoch: 8 | loss: 0.6811337
	speed: 0.0066s/iter; left time: 0.2121s
Updating learning rate to 0.0
Validation loss decreased (0.3106 --> 0.3104).  Saving model state dict ...
Epoch: 8 cost time: 0.4983816146850586
Epoch: 8, Steps: 131 | Train Loss: 0.6811337 Vali Loss: 0.3104109 Best vali loss: 0.3104109

best validation loss 0.31041091802440285

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.003544347717, 'e_layers': 2, 'learning_rate': 5.09670539e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6921087
	speed: 0.0094s/iter; left time: 8.8928s
Updating learning rate to 4.902723591530477e-05
Validation loss decreased (inf --> 0.3446).  Saving model state dict ...
Epoch: 1 cost time: 0.7818794250488281
Epoch: 1, Steps: 131 | Train Loss: 0.6921087 Vali Loss: 0.3445695 Best vali loss: 0.3445695
	iters: 100, epoch: 2 | loss: 0.6823584
	speed: 0.0068s/iter; left time: 5.5442s
Updating learning rate to 4.350310166489513e-05
Validation loss decreased (0.3446 --> 0.3311).  Saving model state dict ...
Epoch: 2 cost time: 0.5424418449401855
Epoch: 2, Steps: 131 | Train Loss: 0.6823584 Vali Loss: 0.3310949 Best vali loss: 0.3310949
	iters: 100, epoch: 3 | loss: 0.3519656
	speed: 0.0063s/iter; left time: 4.3600s
Updating learning rate to 3.5235650511994264e-05
Validation loss decreased (0.3311 --> 0.3223).  Saving model state dict ...
Epoch: 3 cost time: 0.4884374141693115
Epoch: 3, Steps: 131 | Train Loss: 0.3519656 Vali Loss: 0.3223452 Best vali loss: 0.3223452

best validation loss 0.32234519057311106

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0065696116289, 'e_layers': 3, 'learning_rate': 5.25316913e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.053232285013561e-05
Validation loss decreased (inf --> 0.2953).  Saving model state dict ...
Epoch: 1 cost time: 0.6900296211242676
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2952642 Best vali loss: 0.2952642
Updating learning rate to 4.483860322271418e-05
Validation loss decreased (0.2953 --> 0.2832).  Saving model state dict ...
Epoch: 2 cost time: 0.449664831161499
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2831736 Best vali loss: 0.2831736
Updating learning rate to 3.631734961731367e-05
Validation loss decreased (0.2832 --> 0.2802).  Saving model state dict ...
Epoch: 3 cost time: 0.4548380374908447
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2801509 Best vali loss: 0.2801509

best validation loss 0.28015089881779226

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009537212599, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596306
	speed: 0.0103s/iter; left time: 9.8156s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9225354194641113
Epoch: 1, Steps: 131 | Train Loss: 0.5596306 Vali Loss: 0.2756743 Best vali loss: 0.2756743
	iters: 100, epoch: 2 | loss: 0.3234662
	speed: 0.0089s/iter; left time: 7.2716s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2757 --> 0.2698).  Saving model state dict ...
Epoch: 2 cost time: 0.7036318778991699
Epoch: 2, Steps: 131 | Train Loss: 0.3234662 Vali Loss: 0.2698257 Best vali loss: 0.2698257
	iters: 100, epoch: 3 | loss: 0.4619146
	speed: 0.0089s/iter; left time: 6.1324s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.7026386260986328
Epoch: 3, Steps: 131 | Train Loss: 0.4619146 Vali Loss: 0.2861534 Best vali loss: 0.2698257

best validation loss 0.2698257465307577

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009537212599, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4210312
	speed: 0.0107s/iter; left time: 5.9583s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 0.9362659454345703
Epoch: 4, Steps: 131 | Train Loss: 0.4210312 Vali Loss: 0.2833812 Best vali loss: 0.2698257
	iters: 100, epoch: 5 | loss: 0.2712858
	speed: 0.0088s/iter; left time: 3.7362s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.708622932434082
Epoch: 5, Steps: 131 | Train Loss: 0.2712858 Vali Loss: 0.2914339 Best vali loss: 0.2698257
	iters: 100, epoch: 6 | loss: 0.3882669
	speed: 0.0086s/iter; left time: 2.5205s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.6986050605773926
Epoch: 6, Steps: 131 | Train Loss: 0.3882669 Vali Loss: 0.2980389 Best vali loss: 0.2698257
	iters: 100, epoch: 7 | loss: 0.4015119
	speed: 0.0086s/iter; left time: 1.4086s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 0.6990909576416016
Epoch: 7, Steps: 131 | Train Loss: 0.4015119 Vali Loss: 0.3042895 Best vali loss: 0.2698257
	iters: 100, epoch: 8 | loss: 0.3009099
	speed: 0.0086s/iter; left time: 0.2760s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6924593448638916
Epoch: 8, Steps: 131 | Train Loss: 0.3009099 Vali Loss: 0.3065526 Best vali loss: 0.2698257

best validation loss 0.2698257465307577

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009535221786, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596262
	speed: 0.0104s/iter; left time: 9.8845s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9236149787902832
Epoch: 1, Steps: 131 | Train Loss: 0.5596262 Vali Loss: 0.2756706 Best vali loss: 0.2756706
	iters: 100, epoch: 2 | loss: 0.3238724
	speed: 0.0089s/iter; left time: 7.3040s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2757 --> 0.2692).  Saving model state dict ...
Epoch: 2 cost time: 0.7049496173858643
Epoch: 2, Steps: 131 | Train Loss: 0.3238724 Vali Loss: 0.2692478 Best vali loss: 0.2692478
	iters: 100, epoch: 3 | loss: 0.4645897
	speed: 0.0092s/iter; left time: 6.3020s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.7070438861846924
Epoch: 3, Steps: 131 | Train Loss: 0.4645897 Vali Loss: 0.2773714 Best vali loss: 0.2692478
	iters: 100, epoch: 4 | loss: 0.5042129
	speed: 0.0086s/iter; left time: 4.7625s
Updating learning rate to 2.9316150425e-05
Epoch: 4 cost time: 0.6943516731262207
Epoch: 4, Steps: 131 | Train Loss: 0.5042129 Vali Loss: 0.2876592 Best vali loss: 0.2692478
	iters: 100, epoch: 5 | loss: 0.3321972
	speed: 0.0086s/iter; left time: 3.6645s
Updating learning rate to 1.46580752125e-05
Epoch: 5 cost time: 0.6997201442718506
Epoch: 5, Steps: 131 | Train Loss: 0.3321972 Vali Loss: 0.2871892 Best vali loss: 0.2692478
	iters: 100, epoch: 6 | loss: 0.3167997
	speed: 0.0086s/iter; left time: 2.5212s
Updating learning rate to 7.32903760625e-06
Epoch: 6 cost time: 0.7033686637878418
Epoch: 6, Steps: 131 | Train Loss: 0.3167997 Vali Loss: 0.2905987 Best vali loss: 0.2692478
	iters: 100, epoch: 7 | loss: 0.3131320
	speed: 0.0087s/iter; left time: 1.4204s
Updating learning rate to 3.664518803125e-06
Epoch: 7 cost time: 0.7051258087158203
Epoch: 7, Steps: 131 | Train Loss: 0.3131320 Vali Loss: 0.2945277 Best vali loss: 0.2692478
	iters: 100, epoch: 8 | loss: 0.3979339
	speed: 0.0086s/iter; left time: 0.2751s
Updating learning rate to 1.8322594015625e-06
Epoch: 8 cost time: 0.7017538547515869
Epoch: 8, Steps: 131 | Train Loss: 0.3979339 Vali Loss: 0.2954018 Best vali loss: 0.2692478

best validation loss 0.2692478134668463

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011924446504, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597134
	speed: 0.0102s/iter; left time: 9.7196s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.917661190032959
Epoch: 1, Steps: 131 | Train Loss: 0.5597134 Vali Loss: 0.2756578 Best vali loss: 0.2756578
	iters: 100, epoch: 2 | loss: 0.3246828
	speed: 0.0088s/iter; left time: 7.1954s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2757 --> 0.2707).  Saving model state dict ...
Epoch: 2 cost time: 0.6982941627502441
Epoch: 2, Steps: 131 | Train Loss: 0.3246828 Vali Loss: 0.2707070 Best vali loss: 0.2707070
	iters: 100, epoch: 3 | loss: 0.4643940
	speed: 0.0090s/iter; left time: 6.2159s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7039060592651367
Epoch: 3, Steps: 131 | Train Loss: 0.4643940 Vali Loss: 0.2781088 Best vali loss: 0.2707070
	iters: 100, epoch: 4 | loss: 0.4953918
	speed: 0.0087s/iter; left time: 4.8384s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.7032709121704102
Epoch: 4, Steps: 131 | Train Loss: 0.4953918 Vali Loss: 0.2800775 Best vali loss: 0.2707070
	iters: 100, epoch: 5 | loss: 0.3343106
	speed: 0.0087s/iter; left time: 3.7088s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.7001020908355713
Epoch: 5, Steps: 131 | Train Loss: 0.3343106 Vali Loss: 0.2899219 Best vali loss: 0.2707070
	iters: 100, epoch: 6 | loss: 0.3071932
	speed: 0.0087s/iter; left time: 2.5648s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7049140930175781
Epoch: 6, Steps: 131 | Train Loss: 0.3071932 Vali Loss: 0.3001388 Best vali loss: 0.2707070
	iters: 100, epoch: 7 | loss: 0.2840303
	speed: 0.0087s/iter; left time: 1.4149s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.698697566986084
Epoch: 7, Steps: 131 | Train Loss: 0.2840303 Vali Loss: 0.2992634 Best vali loss: 0.2707070
	iters: 100, epoch: 8 | loss: 0.3414983
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.704592227935791
Epoch: 8, Steps: 131 | Train Loss: 0.3414983 Vali Loss: 0.3020018 Best vali loss: 0.2707070

best validation loss 0.2707069598861501

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266579242, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5434438
	speed: 0.0101s/iter; left time: 9.5582s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 0.8704729080200195
Epoch: 1, Steps: 131 | Train Loss: 0.5434438 Vali Loss: 0.2873537 Best vali loss: 0.2873537
	iters: 100, epoch: 2 | loss: 0.6784791
	speed: 0.0083s/iter; left time: 6.7646s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2874 --> 0.2754).  Saving model state dict ...
Epoch: 2 cost time: 0.6417026519775391
Epoch: 2, Steps: 131 | Train Loss: 0.6784791 Vali Loss: 0.2754481 Best vali loss: 0.2754481
	iters: 100, epoch: 3 | loss: 0.3465571
	speed: 0.0084s/iter; left time: 5.7486s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.6462645530700684
Epoch: 3, Steps: 131 | Train Loss: 0.3465571 Vali Loss: 0.2791181 Best vali loss: 0.2754481

best validation loss 0.2754480666212541

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012162569998, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596647
	speed: 0.0104s/iter; left time: 9.8734s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9243502616882324
Epoch: 1, Steps: 131 | Train Loss: 0.5596647 Vali Loss: 0.2756518 Best vali loss: 0.2756518
	iters: 100, epoch: 2 | loss: 0.3253976
	speed: 0.0090s/iter; left time: 7.3540s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2757 --> 0.2697).  Saving model state dict ...
Epoch: 2 cost time: 0.7023763656616211
Epoch: 2, Steps: 131 | Train Loss: 0.3253976 Vali Loss: 0.2696917 Best vali loss: 0.2696917
	iters: 100, epoch: 3 | loss: 0.4628836
	speed: 0.0091s/iter; left time: 6.2603s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.6986260414123535
Epoch: 3, Steps: 131 | Train Loss: 0.4628836 Vali Loss: 0.2752426 Best vali loss: 0.2696917

best validation loss 0.2696917385317305

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5434505
	speed: 0.0100s/iter; left time: 9.5319s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2873).  Saving model state dict ...
Epoch: 1 cost time: 0.8781681060791016
Epoch: 1, Steps: 131 | Train Loss: 0.5434505 Vali Loss: 0.2873320 Best vali loss: 0.2873320
	iters: 100, epoch: 2 | loss: 0.6783807
	speed: 0.0082s/iter; left time: 6.6903s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2873 --> 0.2736).  Saving model state dict ...
Epoch: 2 cost time: 0.6367208957672119
Epoch: 2, Steps: 131 | Train Loss: 0.6783807 Vali Loss: 0.2736311 Best vali loss: 0.2736311
	iters: 100, epoch: 3 | loss: 0.3420452
	speed: 0.0082s/iter; left time: 5.6620s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.6434986591339111
Epoch: 3, Steps: 131 | Train Loss: 0.3420452 Vali Loss: 0.2829535 Best vali loss: 0.2736311

best validation loss 0.2736311289802188

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012162569998, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4067057
	speed: 0.0108s/iter; left time: 6.0075s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 0.9311561584472656
Epoch: 4, Steps: 131 | Train Loss: 0.4067057 Vali Loss: 0.2969839 Best vali loss: 0.2696917
	iters: 100, epoch: 5 | loss: 0.2831326
	speed: 0.0086s/iter; left time: 3.6494s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.6931047439575195
Epoch: 5, Steps: 131 | Train Loss: 0.2831326 Vali Loss: 0.2802662 Best vali loss: 0.2696917
	iters: 100, epoch: 6 | loss: 0.3870172
	speed: 0.0087s/iter; left time: 2.5436s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.7002420425415039
Epoch: 6, Steps: 131 | Train Loss: 0.3870172 Vali Loss: 0.2938140 Best vali loss: 0.2696917
	iters: 100, epoch: 7 | loss: 0.4016884
	speed: 0.0086s/iter; left time: 1.4005s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 0.6966493129730225
Epoch: 7, Steps: 131 | Train Loss: 0.4016884 Vali Loss: 0.2990763 Best vali loss: 0.2696917
	iters: 100, epoch: 8 | loss: 0.3031986
	speed: 0.0086s/iter; left time: 0.2739s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6896262168884277
Epoch: 8, Steps: 131 | Train Loss: 0.3031986 Vali Loss: 0.2983132 Best vali loss: 0.2696917

best validation loss 0.2696917385317305

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.011225143845, 'e_layers': 2, 'learning_rate': 8.45085139e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5585358
	speed: 0.0104s/iter; left time: 9.8388s
Updating learning rate to 8.129210010757779e-05
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 0.9206528663635254
Epoch: 1, Steps: 131 | Train Loss: 0.5585358 Vali Loss: 0.2761073 Best vali loss: 0.2761073
	iters: 100, epoch: 2 | loss: 0.3296230
	speed: 0.0090s/iter; left time: 7.3409s
Updating learning rate to 7.21325285733438e-05
Epoch: 2 cost time: 0.7053303718566895
Epoch: 2, Steps: 131 | Train Loss: 0.3296230 Vali Loss: 0.2768248 Best vali loss: 0.2761073
	iters: 100, epoch: 3 | loss: 0.4836056
	speed: 0.0086s/iter; left time: 5.9301s
Updating learning rate to 5.842426103166245e-05
Validation loss decreased (0.2761 --> 0.2724).  Saving model state dict ...
Epoch: 3 cost time: 0.703291654586792
Epoch: 3, Steps: 131 | Train Loss: 0.4836056 Vali Loss: 0.2724125 Best vali loss: 0.2724125
	iters: 100, epoch: 4 | loss: 0.5989968
	speed: 0.0090s/iter; left time: 4.9942s
Updating learning rate to 4.225425695e-05
Epoch: 4 cost time: 0.7013225555419922
Epoch: 4, Steps: 131 | Train Loss: 0.5989968 Vali Loss: 0.2815073 Best vali loss: 0.2724125
	iters: 100, epoch: 5 | loss: 0.3510700
	speed: 0.0087s/iter; left time: 3.6805s
Updating learning rate to 2.6084252868337553e-05
Epoch: 5 cost time: 0.6990616321563721
Epoch: 5, Steps: 131 | Train Loss: 0.3510700 Vali Loss: 0.2851301 Best vali loss: 0.2724125
	iters: 100, epoch: 6 | loss: 0.3319267
	speed: 0.0086s/iter; left time: 2.5205s
Updating learning rate to 1.2375985326656198e-05
Epoch: 6 cost time: 0.6994843482971191
Epoch: 6, Steps: 131 | Train Loss: 0.3319267 Vali Loss: 0.2852510 Best vali loss: 0.2724125
	iters: 100, epoch: 7 | loss: 0.3337482
	speed: 0.0086s/iter; left time: 1.4081s
Updating learning rate to 3.2164137924222115e-06
Epoch: 7 cost time: 0.69612717628479
Epoch: 7, Steps: 131 | Train Loss: 0.3337482 Vali Loss: 0.2918753 Best vali loss: 0.2724125
	iters: 100, epoch: 8 | loss: 0.4459598
	speed: 0.0086s/iter; left time: 0.2759s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6955158710479736
Epoch: 8, Steps: 131 | Train Loss: 0.4459598 Vali Loss: 0.2910973 Best vali loss: 0.2724125

best validation loss 0.2724125111754741

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021119534029, 'e_layers': 2, 'learning_rate': 0.0001000769716, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5592027
	speed: 0.0106s/iter; left time: 10.0591s
Updating learning rate to 0.0001000769716
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9397780895233154
Epoch: 1, Steps: 131 | Train Loss: 0.5592027 Vali Loss: 0.2757479 Best vali loss: 0.2757479
	iters: 100, epoch: 2 | loss: 0.3294110
	speed: 0.0090s/iter; left time: 7.3253s
Updating learning rate to 5.00384858e-05
Epoch: 2 cost time: 0.7040045261383057
Epoch: 2, Steps: 131 | Train Loss: 0.3294110 Vali Loss: 0.2761732 Best vali loss: 0.2757479
	iters: 100, epoch: 3 | loss: 0.4818670
	speed: 0.0085s/iter; left time: 5.8610s
Updating learning rate to 2.50192429e-05
Validation loss decreased (0.2757 --> 0.2707).  Saving model state dict ...
Epoch: 3 cost time: 0.6955845355987549
Epoch: 3, Steps: 131 | Train Loss: 0.4818670 Vali Loss: 0.2707389 Best vali loss: 0.2707389
	iters: 100, epoch: 4 | loss: 0.5937410
	speed: 0.0090s/iter; left time: 4.9802s
Updating learning rate to 1.250962145e-05
Epoch: 4 cost time: 0.7008836269378662
Epoch: 4, Steps: 131 | Train Loss: 0.5937410 Vali Loss: 0.2730159 Best vali loss: 0.2707389
	iters: 100, epoch: 5 | loss: 0.3460308
	speed: 0.0086s/iter; left time: 3.6705s
Updating learning rate to 6.254810725e-06
Epoch: 5 cost time: 0.6993710994720459
Epoch: 5, Steps: 131 | Train Loss: 0.3460308 Vali Loss: 0.2742669 Best vali loss: 0.2707389
	iters: 100, epoch: 6 | loss: 0.3440528
	speed: 0.0085s/iter; left time: 2.5086s
Updating learning rate to 3.1274053625e-06
Epoch: 6 cost time: 0.6942007541656494
Epoch: 6, Steps: 131 | Train Loss: 0.3440528 Vali Loss: 0.2759245 Best vali loss: 0.2707389
	iters: 100, epoch: 7 | loss: 0.3470932
	speed: 0.0086s/iter; left time: 1.4032s
Updating learning rate to 1.56370268125e-06
Epoch: 7 cost time: 0.7066524028778076
Epoch: 7, Steps: 131 | Train Loss: 0.3470932 Vali Loss: 0.2761723 Best vali loss: 0.2707389
	iters: 100, epoch: 8 | loss: 0.4839188
	speed: 0.0087s/iter; left time: 0.2771s
Updating learning rate to 7.81851340625e-07
Epoch: 8 cost time: 0.6984305381774902
Epoch: 8, Steps: 131 | Train Loss: 0.4839188 Vali Loss: 0.2765631 Best vali loss: 0.2707389

best validation loss 0.27073890885131074

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.001132523881, 'e_layers': 4, 'learning_rate': 0.0005106494367, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3733597
	speed: 0.0130s/iter; left time: 25.9615s
	iters: 200, epoch: 1 | loss: 0.4352749
	speed: 0.0076s/iter; left time: 14.4062s
Updating learning rate to 0.0004912139997777739
Validation loss decreased (inf --> 0.3086).  Saving model state dict ...
Epoch: 1 cost time: 2.274894952774048
Epoch: 1, Steps: 262 | Train Loss: 0.4043173 Vali Loss: 0.3086231 Best vali loss: 0.3086231
	iters: 100, epoch: 2 | loss: 0.2983930
	speed: 0.0163s/iter; left time: 28.1953s
	iters: 200, epoch: 2 | loss: 0.6262128
	speed: 0.0077s/iter; left time: 12.5221s
Updating learning rate to 0.0004358665580998303
Epoch: 2 cost time: 2.035130739212036
Epoch: 2, Steps: 262 | Train Loss: 0.4623029 Vali Loss: 0.3228338 Best vali loss: 0.3086231
	iters: 100, epoch: 3 | loss: 0.6263496
	speed: 0.0158s/iter; left time: 23.3463s
	iters: 200, epoch: 3 | loss: 0.6641803
	speed: 0.0078s/iter; left time: 10.6429s
Updating learning rate to 0.00035303325793582785
Epoch: 3 cost time: 2.062817096710205
Epoch: 3, Steps: 262 | Train Loss: 0.6452650 Vali Loss: 0.3271866 Best vali loss: 0.3086231

best validation loss 0.3086231147441646

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011490518547, 'e_layers': 1, 'learning_rate': 6.43791407e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8378618
	speed: 0.0084s/iter; left time: 7.9364s
Updating learning rate to 6.43791407e-05
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 0.664719820022583
Epoch: 1, Steps: 131 | Train Loss: 0.8378618 Vali Loss: 0.2853379 Best vali loss: 0.2853379
	iters: 100, epoch: 2 | loss: 0.3309472
	speed: 0.0057s/iter; left time: 4.6976s
Updating learning rate to 3.218957035e-05
Validation loss decreased (0.2853 --> 0.2804).  Saving model state dict ...
Epoch: 2 cost time: 0.4367668628692627
Epoch: 2, Steps: 131 | Train Loss: 0.3309472 Vali Loss: 0.2803940 Best vali loss: 0.2803940
	iters: 100, epoch: 3 | loss: 0.5137697
	speed: 0.0056s/iter; left time: 3.8401s
Updating learning rate to 1.6094785175e-05
Validation loss decreased (0.2804 --> 0.2788).  Saving model state dict ...
Epoch: 3 cost time: 0.4271275997161865
Epoch: 3, Steps: 131 | Train Loss: 0.5137697 Vali Loss: 0.2788354 Best vali loss: 0.2788354

best validation loss 0.2788354475044238

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0114897536296, 'e_layers': 2, 'learning_rate': 0.000751723546, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000751723546
Validation loss decreased (inf --> 0.2984).  Saving model state dict ...
Epoch: 1 cost time: 0.565436601638794
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2983688 Best vali loss: 0.2983688
Updating learning rate to 0.000375861773
Validation loss decreased (0.2984 --> 0.2858).  Saving model state dict ...
Epoch: 2 cost time: 0.32674527168273926
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2858134 Best vali loss: 0.2858134
Updating learning rate to 0.0001879308865
Validation loss decreased (0.2858 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 0.31046342849731445
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2839152 Best vali loss: 0.2839152

best validation loss 0.28391516423659857

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011490518547, 'e_layers': 1, 'learning_rate': 6.43791407e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8100005
	speed: 0.0084s/iter; left time: 4.6803s
Updating learning rate to 8.0473925875e-06
Epoch: 4 cost time: 0.6658837795257568
Epoch: 4, Steps: 131 | Train Loss: 0.8100005 Vali Loss: 0.2794056 Best vali loss: 0.2788354
	iters: 100, epoch: 5 | loss: 0.3211775
	speed: 0.0053s/iter; left time: 2.2528s
Updating learning rate to 4.02369629375e-06
Validation loss decreased (0.2788 --> 0.2785).  Saving model state dict ...
Epoch: 5 cost time: 0.3931899070739746
Epoch: 5, Steps: 131 | Train Loss: 0.3211775 Vali Loss: 0.2785409 Best vali loss: 0.2785409
	iters: 100, epoch: 6 | loss: 0.5130202
	speed: 0.0057s/iter; left time: 1.6706s
Updating learning rate to 2.011848146875e-06
Epoch: 6 cost time: 0.4197652339935303
Epoch: 6, Steps: 131 | Train Loss: 0.5130202 Vali Loss: 0.2786829 Best vali loss: 0.2785409
	iters: 100, epoch: 7 | loss: 0.3691545
	speed: 0.0054s/iter; left time: 0.8780s
Updating learning rate to 1.0059240734375e-06
Epoch: 7 cost time: 0.4078207015991211
Epoch: 7, Steps: 131 | Train Loss: 0.3691545 Vali Loss: 0.2787722 Best vali loss: 0.2785409
	iters: 100, epoch: 8 | loss: 0.3716304
	speed: 0.0054s/iter; left time: 0.1718s
Updating learning rate to 5.0296203671875e-07
Epoch: 8 cost time: 0.42523717880249023
Epoch: 8, Steps: 131 | Train Loss: 0.3716304 Vali Loss: 0.2787518 Best vali loss: 0.2785409

best validation loss 0.2785408916239315

[INFO][smbo.py:320] Finished 550 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5434409
	speed: 0.0100s/iter; left time: 9.4891s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 0.8770081996917725
Epoch: 1, Steps: 131 | Train Loss: 0.5434409 Vali Loss: 0.2873526 Best vali loss: 0.2873526
	iters: 100, epoch: 2 | loss: 0.6791366
	speed: 0.0084s/iter; left time: 6.8370s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2874 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 0.6543726921081543
Epoch: 2, Steps: 131 | Train Loss: 0.6791366 Vali Loss: 0.2741635 Best vali loss: 0.2741635
	iters: 100, epoch: 3 | loss: 0.3459068
	speed: 0.0085s/iter; left time: 5.8230s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.6539220809936523
Epoch: 3, Steps: 131 | Train Loss: 0.3459068 Vali Loss: 0.2801890 Best vali loss: 0.2741635
	iters: 100, epoch: 4 | loss: 0.5287413
	speed: 0.0081s/iter; left time: 4.4820s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.6459486484527588
Epoch: 4, Steps: 131 | Train Loss: 0.5287413 Vali Loss: 0.2855637 Best vali loss: 0.2741635
	iters: 100, epoch: 5 | loss: 0.6374210
	speed: 0.0080s/iter; left time: 3.4192s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.6425104141235352
Epoch: 5, Steps: 131 | Train Loss: 0.6374210 Vali Loss: 0.2995736 Best vali loss: 0.2741635
	iters: 100, epoch: 6 | loss: 0.4866497
	speed: 0.0080s/iter; left time: 2.3461s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.641383171081543
Epoch: 6, Steps: 131 | Train Loss: 0.4866497 Vali Loss: 0.2934278 Best vali loss: 0.2741635
	iters: 100, epoch: 7 | loss: 0.4267360
	speed: 0.0079s/iter; left time: 1.2855s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.634789228439331
Epoch: 7, Steps: 131 | Train Loss: 0.4267360 Vali Loss: 0.3014322 Best vali loss: 0.2741635
	iters: 100, epoch: 8 | loss: 0.2807451
	speed: 0.0080s/iter; left time: 0.2547s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.6340954303741455
Epoch: 8, Steps: 131 | Train Loss: 0.2807451 Vali Loss: 0.2958149 Best vali loss: 0.2741635

best validation loss 0.2741635108845258

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0043382214479, 'e_layers': 3, 'learning_rate': 5.56809462e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1001803
	speed: 0.0101s/iter; left time: 9.6311s
Updating learning rate to 5.3561716372521055e-05
Validation loss decreased (inf --> 0.3291).  Saving model state dict ...
Epoch: 1 cost time: 0.9104447364807129
Epoch: 1, Steps: 131 | Train Loss: 1.1001803 Vali Loss: 0.3290572 Best vali loss: 0.3290572
	iters: 100, epoch: 2 | loss: 0.5327470
	speed: 0.0081s/iter; left time: 6.6238s
Updating learning rate to 4.752666042045166e-05
Validation loss decreased (0.3291 --> 0.3109).  Saving model state dict ...
Epoch: 2 cost time: 0.6686720848083496
Epoch: 2, Steps: 131 | Train Loss: 0.5327470 Vali Loss: 0.3108713 Best vali loss: 0.3108713
	iters: 100, epoch: 3 | loss: 0.4270772
	speed: 0.0076s/iter; left time: 5.2501s
Updating learning rate to 3.8494560904575954e-05
Validation loss decreased (0.3109 --> 0.3003).  Saving model state dict ...
Epoch: 3 cost time: 0.601240873336792
Epoch: 3, Steps: 131 | Train Loss: 0.4270772 Vali Loss: 0.3003157 Best vali loss: 0.3003157
	iters: 100, epoch: 4 | loss: 0.6540863
	speed: 0.0081s/iter; left time: 4.5009s
Updating learning rate to 2.78404731e-05
Validation loss decreased (0.3003 --> 0.2947).  Saving model state dict ...
Epoch: 4 cost time: 0.693300724029541
Epoch: 4, Steps: 131 | Train Loss: 0.6540863 Vali Loss: 0.2947062 Best vali loss: 0.2947062
	iters: 100, epoch: 5 | loss: 0.5888164
	speed: 0.0077s/iter; left time: 3.2781s
Updating learning rate to 1.718638529542405e-05
Validation loss decreased (0.2947 --> 0.2919).  Saving model state dict ...
Epoch: 5 cost time: 0.602881669998169
Epoch: 5, Steps: 131 | Train Loss: 0.5888164 Vali Loss: 0.2919230 Best vali loss: 0.2919230
	iters: 100, epoch: 6 | loss: 0.4435945
	speed: 0.0079s/iter; left time: 2.3305s
Updating learning rate to 8.15428577954834e-06
Validation loss decreased (0.2919 --> 0.2904).  Saving model state dict ...
Epoch: 6 cost time: 0.6831309795379639
Epoch: 6, Steps: 131 | Train Loss: 0.4435945 Vali Loss: 0.2903886 Best vali loss: 0.2903886
	iters: 100, epoch: 7 | loss: 0.6051540
	speed: 0.0082s/iter; left time: 1.3441s
Updating learning rate to 2.119229827478946e-06
Validation loss decreased (0.2904 --> 0.2897).  Saving model state dict ...
Epoch: 7 cost time: 0.6711499691009521
Epoch: 7, Steps: 131 | Train Loss: 0.6051540 Vali Loss: 0.2897125 Best vali loss: 0.2897125
	iters: 100, epoch: 8 | loss: 0.5899323
	speed: 0.0083s/iter; left time: 0.2651s
Updating learning rate to 0.0
Validation loss decreased (0.2897 --> 0.2895).  Saving model state dict ...
Epoch: 8 cost time: 0.6969959735870361
Epoch: 8, Steps: 131 | Train Loss: 0.5899323 Vali Loss: 0.2895469 Best vali loss: 0.2895469

best validation loss 0.2895469237943261

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269501017, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5434494
	speed: 0.0099s/iter; left time: 9.4385s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 0.8787975311279297
Epoch: 1, Steps: 131 | Train Loss: 0.5434494 Vali Loss: 0.2873543 Best vali loss: 0.2873543
	iters: 100, epoch: 2 | loss: 0.6787891
	speed: 0.0083s/iter; left time: 6.7971s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2874 --> 0.2748).  Saving model state dict ...
Epoch: 2 cost time: 0.6472394466400146
Epoch: 2, Steps: 131 | Train Loss: 0.6787891 Vali Loss: 0.2747779 Best vali loss: 0.2747779
	iters: 100, epoch: 3 | loss: 0.3452197
	speed: 0.0083s/iter; left time: 5.7165s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.6443793773651123
Epoch: 3, Steps: 131 | Train Loss: 0.3452197 Vali Loss: 0.2796049 Best vali loss: 0.2747779

best validation loss 0.27477792348171

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266812845, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3662878
	speed: 0.0087s/iter; left time: 71.5470s
	iters: 200, epoch: 1 | loss: 0.2519819
	speed: 0.0033s/iter; left time: 27.1248s
	iters: 300, epoch: 1 | loss: 0.2990686
	speed: 0.0032s/iter; left time: 25.6091s
	iters: 400, epoch: 1 | loss: 0.2895899
	speed: 0.0032s/iter; left time: 25.1804s
	iters: 500, epoch: 1 | loss: 0.1778894
	speed: 0.0032s/iter; left time: 24.9122s
	iters: 600, epoch: 1 | loss: 0.1711106
	speed: 0.0031s/iter; left time: 24.3826s
	iters: 700, epoch: 1 | loss: 0.7751127
	speed: 0.0032s/iter; left time: 24.1837s
	iters: 800, epoch: 1 | loss: 0.3494189
	speed: 0.0031s/iter; left time: 23.7167s
	iters: 900, epoch: 1 | loss: 0.2726506
	speed: 0.0032s/iter; left time: 23.6078s
	iters: 1000, epoch: 1 | loss: 0.5939379
	speed: 0.0032s/iter; left time: 23.2096s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 3.6100504398345947
Epoch: 1, Steps: 1045 | Train Loss: 0.3547048 Vali Loss: 0.2939869 Best vali loss: 0.2939869
	iters: 100, epoch: 2 | loss: 0.8489887
	speed: 0.0099s/iter; left time: 71.7302s
	iters: 200, epoch: 2 | loss: 0.4129914
	speed: 0.0028s/iter; left time: 20.0853s
	iters: 300, epoch: 2 | loss: 0.3260498
	speed: 0.0028s/iter; left time: 19.7544s
	iters: 400, epoch: 2 | loss: 0.4904910
	speed: 0.0029s/iter; left time: 19.9412s
	iters: 500, epoch: 2 | loss: 0.3575651
	speed: 0.0029s/iter; left time: 19.7267s
	iters: 600, epoch: 2 | loss: 0.3113535
	speed: 0.0028s/iter; left time: 19.1001s
	iters: 700, epoch: 2 | loss: 0.6567472
	speed: 0.0028s/iter; left time: 18.8255s
	iters: 800, epoch: 2 | loss: 0.3184907
	speed: 0.0028s/iter; left time: 18.4800s
	iters: 900, epoch: 2 | loss: 0.7265348
	speed: 0.0029s/iter; left time: 18.9028s
	iters: 1000, epoch: 2 | loss: 0.1850266
	speed: 0.0028s/iter; left time: 17.9997s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2940 --> 0.2802).  Saving model state dict ...
Epoch: 2 cost time: 3.0408759117126465
Epoch: 2, Steps: 1045 | Train Loss: 0.4634239 Vali Loss: 0.2802070 Best vali loss: 0.2802070
	iters: 100, epoch: 3 | loss: 0.4271829
	speed: 0.0099s/iter; left time: 61.3280s
	iters: 200, epoch: 3 | loss: 0.5670783
	speed: 0.0031s/iter; left time: 18.5359s
	iters: 300, epoch: 3 | loss: 0.4785488
	speed: 0.0030s/iter; left time: 18.1102s
	iters: 400, epoch: 3 | loss: 0.1918799
	speed: 0.0030s/iter; left time: 17.8020s
	iters: 500, epoch: 3 | loss: 0.3649670
	speed: 0.0031s/iter; left time: 17.7265s
	iters: 600, epoch: 3 | loss: 0.1200558
	speed: 0.0031s/iter; left time: 17.2999s
	iters: 700, epoch: 3 | loss: 0.8997669
	speed: 0.0030s/iter; left time: 16.5315s
	iters: 800, epoch: 3 | loss: 0.9353561
	speed: 0.0029s/iter; left time: 15.7662s
	iters: 900, epoch: 3 | loss: 0.2413652
	speed: 0.0029s/iter; left time: 15.4203s
	iters: 1000, epoch: 3 | loss: 0.6275331
	speed: 0.0029s/iter; left time: 15.0308s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2802 --> 0.2799).  Saving model state dict ...
Epoch: 3 cost time: 3.1433095932006836
Epoch: 3, Steps: 1045 | Train Loss: 0.4853734 Vali Loss: 0.2799349 Best vali loss: 0.2799349

best validation loss 0.2799348621485445

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009649829047, 'e_layers': 2, 'learning_rate': 0.0002374345065, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3662799
	speed: 0.0087s/iter; left time: 71.8084s
	iters: 200, epoch: 1 | loss: 0.2518732
	speed: 0.0031s/iter; left time: 25.5385s
	iters: 300, epoch: 1 | loss: 0.2988828
	speed: 0.0032s/iter; left time: 25.4268s
	iters: 400, epoch: 1 | loss: 0.2902341
	speed: 0.0031s/iter; left time: 25.0768s
	iters: 500, epoch: 1 | loss: 0.1778338
	speed: 0.0031s/iter; left time: 24.7321s
	iters: 600, epoch: 1 | loss: 0.1713369
	speed: 0.0031s/iter; left time: 24.3249s
	iters: 700, epoch: 1 | loss: 0.7671600
	speed: 0.0031s/iter; left time: 24.0136s
	iters: 800, epoch: 1 | loss: 0.3435108
	speed: 0.0031s/iter; left time: 23.6887s
	iters: 900, epoch: 1 | loss: 0.2671064
	speed: 0.0031s/iter; left time: 23.3563s
	iters: 1000, epoch: 1 | loss: 0.6181737
	speed: 0.0032s/iter; left time: 23.2709s
Updating learning rate to 0.0002374345065
Validation loss decreased (inf --> 0.2999).  Saving model state dict ...
Epoch: 1 cost time: 3.5768136978149414
Epoch: 1, Steps: 1045 | Train Loss: 0.3552391 Vali Loss: 0.2999298 Best vali loss: 0.2999298
	iters: 100, epoch: 2 | loss: 0.8611528
	speed: 0.0097s/iter; left time: 69.8805s
	iters: 200, epoch: 2 | loss: 0.4182527
	speed: 0.0028s/iter; left time: 20.0935s
	iters: 300, epoch: 2 | loss: 0.3353909
	speed: 0.0028s/iter; left time: 19.4643s
	iters: 400, epoch: 2 | loss: 0.5717427
	speed: 0.0028s/iter; left time: 19.2821s
	iters: 500, epoch: 2 | loss: 0.3437607
	speed: 0.0028s/iter; left time: 18.9465s
	iters: 600, epoch: 2 | loss: 0.3031314
	speed: 0.0028s/iter; left time: 18.5825s
	iters: 700, epoch: 2 | loss: 0.5954832
	speed: 0.0028s/iter; left time: 18.4373s
	iters: 800, epoch: 2 | loss: 0.3094681
	speed: 0.0028s/iter; left time: 17.9850s
	iters: 900, epoch: 2 | loss: 0.7778079
	speed: 0.0028s/iter; left time: 17.7246s
	iters: 1000, epoch: 2 | loss: 0.1837809
	speed: 0.0028s/iter; left time: 17.5969s
Updating learning rate to 0.00011871725325
Validation loss decreased (0.2999 --> 0.2763).  Saving model state dict ...
Epoch: 2 cost time: 2.9514496326446533
Epoch: 2, Steps: 1045 | Train Loss: 0.4699971 Vali Loss: 0.2763321 Best vali loss: 0.2763321
	iters: 100, epoch: 3 | loss: 0.4401794
	speed: 0.0105s/iter; left time: 65.0233s
	iters: 200, epoch: 3 | loss: 0.5658861
	speed: 0.0031s/iter; left time: 19.0953s
	iters: 300, epoch: 3 | loss: 0.4762547
	speed: 0.0031s/iter; left time: 18.6651s
	iters: 400, epoch: 3 | loss: 0.1949235
	speed: 0.0031s/iter; left time: 18.3693s
	iters: 500, epoch: 3 | loss: 0.3409534
	speed: 0.0031s/iter; left time: 17.9868s
	iters: 600, epoch: 3 | loss: 0.1173937
	speed: 0.0030s/iter; left time: 17.1969s
	iters: 700, epoch: 3 | loss: 0.9806924
	speed: 0.0031s/iter; left time: 17.1158s
	iters: 800, epoch: 3 | loss: 0.9107803
	speed: 0.0031s/iter; left time: 17.2314s
	iters: 900, epoch: 3 | loss: 0.2427379
	speed: 0.0031s/iter; left time: 16.7777s
	iters: 1000, epoch: 3 | loss: 0.5805927
	speed: 0.0031s/iter; left time: 16.4460s
Updating learning rate to 5.9358626625e-05
Epoch: 3 cost time: 3.298501491546631
Epoch: 3, Steps: 1045 | Train Loss: 0.4850394 Vali Loss: 0.2821300 Best vali loss: 0.2763321

best validation loss 0.27633206617792283

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269501017, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4407300
	speed: 0.0101s/iter; left time: 5.6287s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.8628740310668945
Epoch: 4, Steps: 131 | Train Loss: 0.4407300 Vali Loss: 0.2892885 Best vali loss: 0.2747779
	iters: 100, epoch: 5 | loss: 0.5374222
	speed: 0.0081s/iter; left time: 3.4253s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.640430212020874
Epoch: 5, Steps: 131 | Train Loss: 0.5374222 Vali Loss: 0.2869523 Best vali loss: 0.2747779
	iters: 100, epoch: 6 | loss: 0.2979228
	speed: 0.0081s/iter; left time: 2.3682s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6425118446350098
Epoch: 6, Steps: 131 | Train Loss: 0.2979228 Vali Loss: 0.2905363 Best vali loss: 0.2747779
	iters: 100, epoch: 7 | loss: 0.4895802
	speed: 0.0082s/iter; left time: 1.3356s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6568245887756348
Epoch: 7, Steps: 131 | Train Loss: 0.4895802 Vali Loss: 0.2925771 Best vali loss: 0.2747779
	iters: 100, epoch: 8 | loss: 0.6168759
	speed: 0.0082s/iter; left time: 0.2615s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6435954570770264
Epoch: 8, Steps: 131 | Train Loss: 0.6168759 Vali Loss: 0.2942807 Best vali loss: 0.2747779

best validation loss 0.27477792348171

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597197
	speed: 0.0104s/iter; left time: 9.9125s
Updating learning rate to 0.0002345270279
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9275741577148438
Epoch: 1, Steps: 131 | Train Loss: 0.5597197 Vali Loss: 0.2756308 Best vali loss: 0.2756308
	iters: 100, epoch: 2 | loss: 0.3261468
	speed: 0.0090s/iter; left time: 7.3446s
Updating learning rate to 0.00011726351395
Validation loss decreased (0.2756 --> 0.2687).  Saving model state dict ...
Epoch: 2 cost time: 0.7071001529693604
Epoch: 2, Steps: 131 | Train Loss: 0.3261468 Vali Loss: 0.2687075 Best vali loss: 0.2687075
	iters: 100, epoch: 3 | loss: 0.4606575
	speed: 0.0089s/iter; left time: 6.0817s
Updating learning rate to 5.8631756975e-05
Epoch: 3 cost time: 0.6994280815124512
Epoch: 3, Steps: 131 | Train Loss: 0.4606575 Vali Loss: 0.2780584 Best vali loss: 0.2687075
	iters: 100, epoch: 4 | loss: 0.5029598
	speed: 0.0085s/iter; left time: 4.7394s
Updating learning rate to 2.93158784875e-05
Epoch: 4 cost time: 0.6959402561187744
Epoch: 4, Steps: 131 | Train Loss: 0.5029598 Vali Loss: 0.2876117 Best vali loss: 0.2687075
	iters: 100, epoch: 5 | loss: 0.3333544
	speed: 0.0086s/iter; left time: 3.6700s
Updating learning rate to 1.465793924375e-05
Epoch: 5 cost time: 0.6995663642883301
Epoch: 5, Steps: 131 | Train Loss: 0.3333544 Vali Loss: 0.2902576 Best vali loss: 0.2687075
	iters: 100, epoch: 6 | loss: 0.3184530
	speed: 0.0086s/iter; left time: 2.5141s
Updating learning rate to 7.328969621875e-06
Epoch: 6 cost time: 0.7007424831390381
Epoch: 6, Steps: 131 | Train Loss: 0.3184530 Vali Loss: 0.2874815 Best vali loss: 0.2687075
	iters: 100, epoch: 7 | loss: 0.3144735
	speed: 0.0086s/iter; left time: 1.4027s
Updating learning rate to 3.6644848109375e-06
Epoch: 7 cost time: 0.6913881301879883
Epoch: 7, Steps: 131 | Train Loss: 0.3144735 Vali Loss: 0.2926695 Best vali loss: 0.2687075
	iters: 100, epoch: 8 | loss: 0.3969638
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 1.83224240546875e-06
Epoch: 8 cost time: 0.7016422748565674
Epoch: 8, Steps: 131 | Train Loss: 0.3969638 Vali Loss: 0.2936316 Best vali loss: 0.2687075

best validation loss 0.26870745737431173

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5308950
	speed: 0.0105s/iter; left time: 9.9790s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2775).  Saving model state dict ...
Epoch: 1 cost time: 0.9364502429962158
Epoch: 1, Steps: 131 | Train Loss: 0.5308950 Vali Loss: 0.2775216 Best vali loss: 0.2775216
	iters: 100, epoch: 2 | loss: 0.4610664
	speed: 0.0090s/iter; left time: 7.3610s
Updating learning rate to 0.00011724119905
Epoch: 2 cost time: 0.712895393371582
Epoch: 2, Steps: 131 | Train Loss: 0.4610664 Vali Loss: 0.2845488 Best vali loss: 0.2775216
	iters: 100, epoch: 3 | loss: 0.4709416
	speed: 0.0088s/iter; left time: 6.0260s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.7157175540924072
Epoch: 3, Steps: 131 | Train Loss: 0.4709416 Vali Loss: 0.2948564 Best vali loss: 0.2775216
	iters: 100, epoch: 4 | loss: 0.3896012
	speed: 0.0088s/iter; left time: 4.8724s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.7150154113769531
Epoch: 4, Steps: 131 | Train Loss: 0.3896012 Vali Loss: 0.2842616 Best vali loss: 0.2775216
	iters: 100, epoch: 5 | loss: 0.6391081
	speed: 0.0088s/iter; left time: 3.7545s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.7195947170257568
Epoch: 5, Steps: 131 | Train Loss: 0.6391081 Vali Loss: 0.2893769 Best vali loss: 0.2775216
	iters: 100, epoch: 6 | loss: 0.3185463
	speed: 0.0089s/iter; left time: 2.6043s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.7206966876983643
Epoch: 6, Steps: 131 | Train Loss: 0.3185463 Vali Loss: 0.2855805 Best vali loss: 0.2775216
	iters: 100, epoch: 7 | loss: 0.3148103
	speed: 0.0089s/iter; left time: 1.4462s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.7203471660614014
Epoch: 7, Steps: 131 | Train Loss: 0.3148103 Vali Loss: 0.2874022 Best vali loss: 0.2775216
	iters: 100, epoch: 8 | loss: 0.5011997
	speed: 0.0088s/iter; left time: 0.2819s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.7121767997741699
Epoch: 8, Steps: 131 | Train Loss: 0.5011997 Vali Loss: 0.2878384 Best vali loss: 0.2775216

best validation loss 0.2775215533374632

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5308934
	speed: 0.0107s/iter; left time: 10.1221s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2775).  Saving model state dict ...
Epoch: 1 cost time: 0.9502911567687988
Epoch: 1, Steps: 131 | Train Loss: 0.5308934 Vali Loss: 0.2775179 Best vali loss: 0.2775179
	iters: 100, epoch: 2 | loss: 0.4614071
	speed: 0.0091s/iter; left time: 7.4350s
Updating learning rate to 0.0001172429579
Epoch: 2 cost time: 0.7184944152832031
Epoch: 2, Steps: 131 | Train Loss: 0.4614071 Vali Loss: 0.2850290 Best vali loss: 0.2775179
	iters: 100, epoch: 3 | loss: 0.4740745
	speed: 0.0088s/iter; left time: 6.0679s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.713630199432373
Epoch: 3, Steps: 131 | Train Loss: 0.4740745 Vali Loss: 0.2949119 Best vali loss: 0.2775179

best validation loss 0.2775178756266999

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0011475492899, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6795852
	speed: 0.0106s/iter; left time: 10.0760s
Updating learning rate to 0.0011475492899
Validation loss decreased (inf --> 0.3033).  Saving model state dict ...
Epoch: 1 cost time: 0.9360454082489014
Epoch: 1, Steps: 131 | Train Loss: 0.6795852 Vali Loss: 0.3032601 Best vali loss: 0.3032601
	iters: 100, epoch: 2 | loss: 0.3536332
	speed: 0.0088s/iter; left time: 7.2137s
Updating learning rate to 0.00057377464495
Validation loss decreased (0.3033 --> 0.3023).  Saving model state dict ...
Epoch: 2 cost time: 0.698176383972168
Epoch: 2, Steps: 131 | Train Loss: 0.3536332 Vali Loss: 0.3023188 Best vali loss: 0.3023188
	iters: 100, epoch: 3 | loss: 0.5285726
	speed: 0.0089s/iter; left time: 6.1334s
Updating learning rate to 0.000286887322475
Validation loss decreased (0.3023 --> 0.2997).  Saving model state dict ...
Epoch: 3 cost time: 0.7101962566375732
Epoch: 3, Steps: 131 | Train Loss: 0.5285726 Vali Loss: 0.2997094 Best vali loss: 0.2997094

best validation loss 0.29970942224300057

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010269501017, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5308782
	speed: 0.0106s/iter; left time: 10.1000s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 0.9490373134613037
Epoch: 1, Steps: 131 | Train Loss: 0.5308782 Vali Loss: 0.2776367 Best vali loss: 0.2776367
	iters: 100, epoch: 2 | loss: 0.4606963
	speed: 0.0092s/iter; left time: 7.5373s
Updating learning rate to 0.00020018128291779717
Epoch: 2 cost time: 0.7293119430541992
Epoch: 2, Steps: 131 | Train Loss: 0.4606963 Vali Loss: 0.2871752 Best vali loss: 0.2776367
	iters: 100, epoch: 3 | loss: 0.4639901
	speed: 0.0088s/iter; left time: 6.0638s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7176082134246826
Epoch: 3, Steps: 131 | Train Loss: 0.4639901 Vali Loss: 0.3056793 Best vali loss: 0.2776367

best validation loss 0.2776366592938681

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3518630
	speed: 0.0108s/iter; left time: 6.0103s
Updating learning rate to 2.9310739475e-05
Epoch: 4 cost time: 0.9470946788787842
Epoch: 4, Steps: 131 | Train Loss: 0.3518630 Vali Loss: 0.2839108 Best vali loss: 0.2775179
	iters: 100, epoch: 5 | loss: 0.3451694
	speed: 0.0088s/iter; left time: 3.7563s
Updating learning rate to 1.46553697375e-05
Epoch: 5 cost time: 0.7124509811401367
Epoch: 5, Steps: 131 | Train Loss: 0.3451694 Vali Loss: 0.2859559 Best vali loss: 0.2775179
	iters: 100, epoch: 6 | loss: 0.4087331
	speed: 0.0088s/iter; left time: 2.5990s
Updating learning rate to 7.32768486875e-06
Epoch: 6 cost time: 0.717949390411377
Epoch: 6, Steps: 131 | Train Loss: 0.4087331 Vali Loss: 0.2874109 Best vali loss: 0.2775179
	iters: 100, epoch: 7 | loss: 0.3626587
	speed: 0.0089s/iter; left time: 1.4433s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 0.7141656875610352
Epoch: 7, Steps: 131 | Train Loss: 0.3626587 Vali Loss: 0.2868909 Best vali loss: 0.2775179
	iters: 100, epoch: 8 | loss: 0.6108693
	speed: 0.0088s/iter; left time: 0.2824s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 0.7135870456695557
Epoch: 8, Steps: 131 | Train Loss: 0.6108693 Vali Loss: 0.2876240 Best vali loss: 0.2775179

best validation loss 0.2775178756266999

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.00100956434, 'e_layers': 2, 'learning_rate': 0.0002343724533, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596457
	speed: 0.0105s/iter; left time: 9.9830s
Updating learning rate to 0.00022545218294416368
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9328305721282959
Epoch: 1, Steps: 131 | Train Loss: 0.5596457 Vali Loss: 0.2756518 Best vali loss: 0.2756518
	iters: 100, epoch: 2 | loss: 0.3250969
	speed: 0.0089s/iter; left time: 7.2693s
Updating learning rate to 0.0002000494021758787
Validation loss decreased (0.2757 --> 0.2737).  Saving model state dict ...
Epoch: 2 cost time: 0.7030479907989502
Epoch: 2, Steps: 131 | Train Loss: 0.3250969 Vali Loss: 0.2737208 Best vali loss: 0.2737208
	iters: 100, epoch: 3 | loss: 0.4689031
	speed: 0.0089s/iter; left time: 6.0821s
Updating learning rate to 0.00016203145409033536
Epoch: 3 cost time: 0.6991822719573975
Epoch: 3, Steps: 131 | Train Loss: 0.4689031 Vali Loss: 0.2776433 Best vali loss: 0.2737208
	iters: 100, epoch: 4 | loss: 0.4798540
	speed: 0.0086s/iter; left time: 4.7855s
Updating learning rate to 0.00011718622665
Epoch: 4 cost time: 0.6949465274810791
Epoch: 4, Steps: 131 | Train Loss: 0.4798540 Vali Loss: 0.2840253 Best vali loss: 0.2737208
	iters: 100, epoch: 5 | loss: 0.3347288
	speed: 0.0086s/iter; left time: 3.6450s
Updating learning rate to 7.234099920966465e-05
Epoch: 5 cost time: 0.7013685703277588
Epoch: 5, Steps: 131 | Train Loss: 0.3347288 Vali Loss: 0.2893506 Best vali loss: 0.2737208
	iters: 100, epoch: 6 | loss: 0.3135302
	speed: 0.0085s/iter; left time: 2.4985s
Updating learning rate to 3.432305112412129e-05
Epoch: 6 cost time: 0.69207763671875
Epoch: 6, Steps: 131 | Train Loss: 0.3135302 Vali Loss: 0.3032259 Best vali loss: 0.2737208
	iters: 100, epoch: 7 | loss: 0.2887682
	speed: 0.0085s/iter; left time: 1.3916s
Updating learning rate to 8.920270355836308e-06
Epoch: 7 cost time: 0.6967289447784424
Epoch: 7, Steps: 131 | Train Loss: 0.2887682 Vali Loss: 0.3013611 Best vali loss: 0.2737208
	iters: 100, epoch: 8 | loss: 0.3455293
	speed: 0.0085s/iter; left time: 0.2718s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6914525032043457
Epoch: 8, Steps: 131 | Train Loss: 0.3455293 Vali Loss: 0.3039715 Best vali loss: 0.2737208

best validation loss 0.2737207781785303

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0014527826337, 'e_layers': 3, 'learning_rate': 5.20463326e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.20463326e-05
Validation loss decreased (inf --> 0.2941).  Saving model state dict ...
Epoch: 1 cost time: 0.7551429271697998
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2941391 Best vali loss: 0.2941391
Updating learning rate to 2.60231663e-05
Validation loss decreased (0.2941 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 0.5263524055480957
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2836173 Best vali loss: 0.2836173
Updating learning rate to 1.301158315e-05
Validation loss decreased (0.2836 --> 0.2803).  Saving model state dict ...
Epoch: 3 cost time: 0.5337283611297607
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2802907 Best vali loss: 0.2802907
Updating learning rate to 6.505791575e-06
Validation loss decreased (0.2803 --> 0.2797).  Saving model state dict ...
Epoch: 4 cost time: 0.5275464057922363
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2797156 Best vali loss: 0.2797156
Updating learning rate to 3.2528957875e-06
Validation loss decreased (0.2797 --> 0.2791).  Saving model state dict ...
Epoch: 5 cost time: 0.5262417793273926
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2791052 Best vali loss: 0.2791052
Updating learning rate to 1.62644789375e-06
Epoch: 6 cost time: 0.5318565368652344
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2791113 Best vali loss: 0.2791052
Updating learning rate to 8.13223946875e-07
Validation loss decreased (0.2791 --> 0.2791).  Saving model state dict ...
Epoch: 7 cost time: 0.5324344635009766
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2790755 Best vali loss: 0.2790755
Updating learning rate to 4.066119734375e-07
Validation loss decreased (0.2791 --> 0.2790).  Saving model state dict ...
Epoch: 8 cost time: 0.5344359874725342
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2790221 Best vali loss: 0.2790221

best validation loss 0.27902211381317116

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.001604045923, 'e_layers': 4, 'learning_rate': 5.28294815e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.081877908551684e-05
Validation loss decreased (inf --> 0.2900).  Saving model state dict ...
Epoch: 1 cost time: 0.9046428203582764
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2899971 Best vali loss: 0.2899971
Updating learning rate to 4.509278305760963e-05
Validation loss decreased (0.2900 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 0.6716222763061523
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2808096 Best vali loss: 0.2808096
Updating learning rate to 3.652322440524401e-05
Validation loss decreased (0.2808 --> 0.2790).  Saving model state dict ...
Epoch: 3 cost time: 0.6723134517669678
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2789921 Best vali loss: 0.2789921

best validation loss 0.2789920539761086

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009536165701, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596263
	speed: 0.0105s/iter; left time: 9.9752s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9417915344238281
Epoch: 1, Steps: 131 | Train Loss: 0.5596263 Vali Loss: 0.2756710 Best vali loss: 0.2756710
	iters: 100, epoch: 2 | loss: 0.3238081
	speed: 0.0089s/iter; left time: 7.3128s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2757 --> 0.2693).  Saving model state dict ...
Epoch: 2 cost time: 0.7068014144897461
Epoch: 2, Steps: 131 | Train Loss: 0.3238081 Vali Loss: 0.2693016 Best vali loss: 0.2693016
	iters: 100, epoch: 3 | loss: 0.4660360
	speed: 0.0089s/iter; left time: 6.1314s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7047924995422363
Epoch: 3, Steps: 131 | Train Loss: 0.4660360 Vali Loss: 0.2810200 Best vali loss: 0.2693016

best validation loss 0.2693016474997966

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025797805, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597187
	speed: 0.0105s/iter; left time: 9.9200s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9349403381347656
Epoch: 1, Steps: 131 | Train Loss: 0.5597187 Vali Loss: 0.2756341 Best vali loss: 0.2756341
	iters: 100, epoch: 2 | loss: 0.3253442
	speed: 0.0089s/iter; left time: 7.2732s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2756 --> 0.2694).  Saving model state dict ...
Epoch: 2 cost time: 0.7030389308929443
Epoch: 2, Steps: 131 | Train Loss: 0.3253442 Vali Loss: 0.2693563 Best vali loss: 0.2693563
	iters: 100, epoch: 3 | loss: 0.4645121
	speed: 0.0091s/iter; left time: 6.2201s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.703300952911377
Epoch: 3, Steps: 131 | Train Loss: 0.4645121 Vali Loss: 0.2808093 Best vali loss: 0.2693563

best validation loss 0.2693562967575984

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009536165701, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4293717
	speed: 0.0106s/iter; left time: 5.8723s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.9280669689178467
Epoch: 4, Steps: 131 | Train Loss: 0.4293717 Vali Loss: 0.2825797 Best vali loss: 0.2693016
	iters: 100, epoch: 5 | loss: 0.2693863
	speed: 0.0086s/iter; left time: 3.6760s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.701920747756958
Epoch: 5, Steps: 131 | Train Loss: 0.2693863 Vali Loss: 0.2890871 Best vali loss: 0.2693016
	iters: 100, epoch: 6 | loss: 0.3934849
	speed: 0.0086s/iter; left time: 2.5422s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.6989362239837646
Epoch: 6, Steps: 131 | Train Loss: 0.3934849 Vali Loss: 0.2935043 Best vali loss: 0.2693016
	iters: 100, epoch: 7 | loss: 0.4025592
	speed: 0.0086s/iter; left time: 1.3943s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.7002573013305664
Epoch: 7, Steps: 131 | Train Loss: 0.4025592 Vali Loss: 0.3038481 Best vali loss: 0.2693016
	iters: 100, epoch: 8 | loss: 0.3010399
	speed: 0.0087s/iter; left time: 0.2790s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7017307281494141
Epoch: 8, Steps: 131 | Train Loss: 0.3010399 Vali Loss: 0.3058574 Best vali loss: 0.2693016

best validation loss 0.2693016474997966

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 3, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4559304
	speed: 0.0126s/iter; left time: 11.9901s
Updating learning rate to 0.0002345270279
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.2258591651916504
Epoch: 1, Steps: 131 | Train Loss: 0.4559304 Vali Loss: 0.2911947 Best vali loss: 0.2911947
	iters: 100, epoch: 2 | loss: 0.4736560
	speed: 0.0122s/iter; left time: 9.9929s
Updating learning rate to 0.00011726351395
Validation loss decreased (0.2912 --> 0.2784).  Saving model state dict ...
Epoch: 2 cost time: 1.003441333770752
Epoch: 2, Steps: 131 | Train Loss: 0.4736560 Vali Loss: 0.2783514 Best vali loss: 0.2783514
	iters: 100, epoch: 3 | loss: 0.4245494
	speed: 0.0125s/iter; left time: 8.5706s
Updating learning rate to 5.8631756975e-05
Epoch: 3 cost time: 1.00435209274292
Epoch: 3, Steps: 131 | Train Loss: 0.4245494 Vali Loss: 0.2812056 Best vali loss: 0.2783514
	iters: 100, epoch: 4 | loss: 0.3831628
	speed: 0.0120s/iter; left time: 6.6586s
Updating learning rate to 2.93158784875e-05
Epoch: 4 cost time: 1.0014762878417969
Epoch: 4, Steps: 131 | Train Loss: 0.3831628 Vali Loss: 0.2811594 Best vali loss: 0.2783514
	iters: 100, epoch: 5 | loss: 0.4765835
	speed: 0.0119s/iter; left time: 5.0606s
Updating learning rate to 1.465793924375e-05
Epoch: 5 cost time: 0.9970479011535645
Epoch: 5, Steps: 131 | Train Loss: 0.4765835 Vali Loss: 0.2837115 Best vali loss: 0.2783514
	iters: 100, epoch: 6 | loss: 0.4728111
	speed: 0.0119s/iter; left time: 3.5125s
Updating learning rate to 7.328969621875e-06
Epoch: 6 cost time: 1.0020077228546143
Epoch: 6, Steps: 131 | Train Loss: 0.4728111 Vali Loss: 0.2854031 Best vali loss: 0.2783514
	iters: 100, epoch: 7 | loss: 0.2872471
	speed: 0.0120s/iter; left time: 1.9576s
Updating learning rate to 3.6644848109375e-06
Epoch: 7 cost time: 1.014280080795288
Epoch: 7, Steps: 131 | Train Loss: 0.2872471 Vali Loss: 0.2856319 Best vali loss: 0.2783514
	iters: 100, epoch: 8 | loss: 0.3461226
	speed: 0.0121s/iter; left time: 0.3858s
Updating learning rate to 1.83224240546875e-06
Epoch: 8 cost time: 0.9989621639251709
Epoch: 8, Steps: 131 | Train Loss: 0.3461226 Vali Loss: 0.2837808 Best vali loss: 0.2783514

best validation loss 0.27835141805057056

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 3, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4559328
	speed: 0.0128s/iter; left time: 12.1106s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.2389984130859375
Epoch: 1, Steps: 131 | Train Loss: 0.4559328 Vali Loss: 0.2912451 Best vali loss: 0.2912451
	iters: 100, epoch: 2 | loss: 0.4736239
	speed: 0.0124s/iter; left time: 10.1084s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2912 --> 0.2790).  Saving model state dict ...
Epoch: 2 cost time: 1.008049488067627
Epoch: 2, Steps: 131 | Train Loss: 0.4736239 Vali Loss: 0.2790492 Best vali loss: 0.2790492
	iters: 100, epoch: 3 | loss: 0.4201623
	speed: 0.0125s/iter; left time: 8.5994s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.007796287536621
Epoch: 3, Steps: 131 | Train Loss: 0.4201623 Vali Loss: 0.2812252 Best vali loss: 0.2790492
	iters: 100, epoch: 4 | loss: 0.3860784
	speed: 0.0120s/iter; left time: 6.6676s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.998760461807251
Epoch: 4, Steps: 131 | Train Loss: 0.3860784 Vali Loss: 0.2817438 Best vali loss: 0.2790492
	iters: 100, epoch: 5 | loss: 0.4714620
	speed: 0.0119s/iter; left time: 5.0484s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.9988343715667725
Epoch: 5, Steps: 131 | Train Loss: 0.4714620 Vali Loss: 0.2823110 Best vali loss: 0.2790492
	iters: 100, epoch: 6 | loss: 0.4664584
	speed: 0.0119s/iter; left time: 3.5068s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.9984145164489746
Epoch: 6, Steps: 131 | Train Loss: 0.4664584 Vali Loss: 0.2847725 Best vali loss: 0.2790492
	iters: 100, epoch: 7 | loss: 0.2874258
	speed: 0.0119s/iter; left time: 1.9423s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 1.0005300045013428
Epoch: 7, Steps: 131 | Train Loss: 0.2874258 Vali Loss: 0.2855921 Best vali loss: 0.2790492
	iters: 100, epoch: 8 | loss: 0.3450817
	speed: 0.0120s/iter; left time: 0.3826s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.0096960067749023
Epoch: 8, Steps: 131 | Train Loss: 0.3450817 Vali Loss: 0.2834514 Best vali loss: 0.2790492

best validation loss 0.2790491951746584

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010265982034, 'e_layers': 3, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4559358
	speed: 0.0127s/iter; left time: 12.0094s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.2311480045318604
Epoch: 1, Steps: 131 | Train Loss: 0.4559358 Vali Loss: 0.2912413 Best vali loss: 0.2912413
	iters: 100, epoch: 2 | loss: 0.4749289
	speed: 0.0124s/iter; left time: 10.1049s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2912 --> 0.2784).  Saving model state dict ...
Epoch: 2 cost time: 1.0140728950500488
Epoch: 2, Steps: 131 | Train Loss: 0.4749289 Vali Loss: 0.2783594 Best vali loss: 0.2783594
	iters: 100, epoch: 3 | loss: 0.4197191
	speed: 0.0126s/iter; left time: 8.6323s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.0063867568969727
Epoch: 3, Steps: 131 | Train Loss: 0.4197191 Vali Loss: 0.2827251 Best vali loss: 0.2783594

best validation loss 0.2783594140834904

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4568620
	speed: 0.0097s/iter; left time: 9.1876s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.8284118175506592
Epoch: 1, Steps: 131 | Train Loss: 0.4568620 Vali Loss: 0.2782113 Best vali loss: 0.2782113
	iters: 100, epoch: 2 | loss: 0.4411734
	speed: 0.0072s/iter; left time: 5.9148s
Updating learning rate to 0.00011724119905
Epoch: 2 cost time: 0.544938325881958
Epoch: 2, Steps: 131 | Train Loss: 0.4411734 Vali Loss: 0.2843616 Best vali loss: 0.2782113
	iters: 100, epoch: 3 | loss: 0.5434100
	speed: 0.0071s/iter; left time: 4.8672s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.570061445236206
Epoch: 3, Steps: 131 | Train Loss: 0.5434100 Vali Loss: 0.2927866 Best vali loss: 0.2782113

best validation loss 0.27821129230749836

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 3, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4559383
	speed: 0.0127s/iter; left time: 12.0631s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.238661289215088
Epoch: 1, Steps: 131 | Train Loss: 0.4559383 Vali Loss: 0.2912377 Best vali loss: 0.2912377
	iters: 100, epoch: 2 | loss: 0.4738930
	speed: 0.0123s/iter; left time: 10.0314s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2912 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 0.9963934421539307
Epoch: 2, Steps: 131 | Train Loss: 0.4738930 Vali Loss: 0.2788387 Best vali loss: 0.2788387
	iters: 100, epoch: 3 | loss: 0.4184422
	speed: 0.0125s/iter; left time: 8.5930s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 1.0008206367492676
Epoch: 3, Steps: 131 | Train Loss: 0.4184422 Vali Loss: 0.2809690 Best vali loss: 0.2788387

best validation loss 0.27883874989322854

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3888739
	speed: 0.0097s/iter; left time: 5.3977s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.8283448219299316
Epoch: 4, Steps: 131 | Train Loss: 0.3888739 Vali Loss: 0.2952764 Best vali loss: 0.2782113
	iters: 100, epoch: 5 | loss: 0.3895366
	speed: 0.0075s/iter; left time: 3.1744s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.5776691436767578
Epoch: 5, Steps: 131 | Train Loss: 0.3895366 Vali Loss: 0.2900147 Best vali loss: 0.2782113
	iters: 100, epoch: 6 | loss: 0.4685557
	speed: 0.0070s/iter; left time: 2.0683s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.5510134696960449
Epoch: 6, Steps: 131 | Train Loss: 0.4685557 Vali Loss: 0.2978871 Best vali loss: 0.2782113
	iters: 100, epoch: 7 | loss: 0.3990496
	speed: 0.0071s/iter; left time: 1.1539s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.5599822998046875
Epoch: 7, Steps: 131 | Train Loss: 0.3990496 Vali Loss: 0.2953214 Best vali loss: 0.2782113
	iters: 100, epoch: 8 | loss: 0.3251271
	speed: 0.0071s/iter; left time: 0.2262s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.5457859039306641
Epoch: 8, Steps: 131 | Train Loss: 0.3251271 Vali Loss: 0.2949141 Best vali loss: 0.2782113

best validation loss 0.27821129230749836

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.002080366195, 'e_layers': 2, 'learning_rate': 0.0048009782423, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6991171
	speed: 0.0105s/iter; left time: 9.9788s
Updating learning rate to 0.0048009782423
Validation loss decreased (inf --> 0.3476).  Saving model state dict ...
Epoch: 1 cost time: 0.9396317005157471
Epoch: 1, Steps: 131 | Train Loss: 0.6991171 Vali Loss: 0.3476064 Best vali loss: 0.3476064
	iters: 100, epoch: 2 | loss: 0.4240176
	speed: 0.0089s/iter; left time: 7.2866s
Updating learning rate to 0.00240048912115
Validation loss decreased (0.3476 --> 0.3335).  Saving model state dict ...
Epoch: 2 cost time: 0.7024862766265869
Epoch: 2, Steps: 131 | Train Loss: 0.4240176 Vali Loss: 0.3335266 Best vali loss: 0.3335266
	iters: 100, epoch: 3 | loss: 0.6130480
	speed: 0.0088s/iter; left time: 6.0656s
Updating learning rate to 0.001200244560575
Validation loss decreased (0.3335 --> 0.3225).  Saving model state dict ...
Epoch: 3 cost time: 0.7014772891998291
Epoch: 3, Steps: 131 | Train Loss: 0.6130480 Vali Loss: 0.3224571 Best vali loss: 0.3224571
	iters: 100, epoch: 4 | loss: 0.7707433
	speed: 0.0089s/iter; left time: 4.9247s
Updating learning rate to 0.0006001222802875
Validation loss decreased (0.3225 --> 0.3101).  Saving model state dict ...
Epoch: 4 cost time: 0.7034738063812256
Epoch: 4, Steps: 131 | Train Loss: 0.7707433 Vali Loss: 0.3101263 Best vali loss: 0.3101263
	iters: 100, epoch: 5 | loss: 0.4006549
	speed: 0.0089s/iter; left time: 3.7938s
Updating learning rate to 0.00030006114014375
Epoch: 5 cost time: 0.6991753578186035
Epoch: 5, Steps: 131 | Train Loss: 0.4006549 Vali Loss: 0.3156116 Best vali loss: 0.3101263
	iters: 100, epoch: 6 | loss: 0.3848856
	speed: 0.0087s/iter; left time: 2.5538s
Updating learning rate to 0.000150030570071875
Epoch: 6 cost time: 0.7110395431518555
Epoch: 6, Steps: 131 | Train Loss: 0.3848856 Vali Loss: 0.3167490 Best vali loss: 0.3101263
	iters: 100, epoch: 7 | loss: 0.4156796
	speed: 0.0088s/iter; left time: 1.4270s
Updating learning rate to 7.50152850359375e-05
Epoch: 7 cost time: 0.7112932205200195
Epoch: 7, Steps: 131 | Train Loss: 0.4156796 Vali Loss: 0.3186484 Best vali loss: 0.3101263
	iters: 100, epoch: 8 | loss: 0.6151190
	speed: 0.0087s/iter; left time: 0.2790s
Updating learning rate to 3.750764251796875e-05
Epoch: 8 cost time: 0.7091648578643799
Epoch: 8, Steps: 131 | Train Loss: 0.6151190 Vali Loss: 0.3203565 Best vali loss: 0.3101263

best validation loss 0.3101263238638695

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0085038966667, 'e_layers': 4, 'learning_rate': 0.0010265210581, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3810010
	speed: 0.0104s/iter; left time: 42.3141s
	iters: 200, epoch: 1 | loss: 0.2641384
	speed: 0.0053s/iter; left time: 20.9583s
	iters: 300, epoch: 1 | loss: 0.4294207
	speed: 0.0053s/iter; left time: 20.5451s
	iters: 400, epoch: 1 | loss: 1.2459018
	speed: 0.0051s/iter; left time: 19.2475s
	iters: 500, epoch: 1 | loss: 1.6702380
	speed: 0.0050s/iter; left time: 18.3824s
Updating learning rate to 0.0010265210581
Validation loss decreased (inf --> 0.3270).  Saving model state dict ...
Epoch: 1 cost time: 2.9601786136627197
Epoch: 1, Steps: 523 | Train Loss: 0.7981400 Vali Loss: 0.3270026 Best vali loss: 0.3270026
	iters: 100, epoch: 2 | loss: 1.1383984
	speed: 0.0098s/iter; left time: 34.9765s
	iters: 200, epoch: 2 | loss: 0.8616985
	speed: 0.0047s/iter; left time: 16.1021s
	iters: 300, epoch: 2 | loss: 0.7665411
	speed: 0.0046s/iter; left time: 15.5416s
	iters: 400, epoch: 2 | loss: 0.2883666
	speed: 0.0047s/iter; left time: 15.3063s
	iters: 500, epoch: 2 | loss: 0.2832382
	speed: 0.0046s/iter; left time: 14.6851s
Updating learning rate to 0.00051326052905
Validation loss decreased (0.3270 --> 0.3179).  Saving model state dict ...
Epoch: 2 cost time: 2.470322370529175
Epoch: 2, Steps: 523 | Train Loss: 0.6676485 Vali Loss: 0.3179446 Best vali loss: 0.3179446
	iters: 100, epoch: 3 | loss: 1.4228289
	speed: 0.0105s/iter; left time: 31.8018s
	iters: 200, epoch: 3 | loss: 0.5708206
	speed: 0.0047s/iter; left time: 13.9090s
	iters: 300, epoch: 3 | loss: 0.3927593
	speed: 0.0046s/iter; left time: 13.1744s
	iters: 400, epoch: 3 | loss: 0.4047348
	speed: 0.0050s/iter; left time: 13.6104s
	iters: 500, epoch: 3 | loss: 0.3986349
	speed: 0.0050s/iter; left time: 13.1356s
Updating learning rate to 0.000256630264525
Epoch: 3 cost time: 2.5863704681396484
Epoch: 3, Steps: 523 | Train Loss: 0.6379557 Vali Loss: 0.3238111 Best vali loss: 0.3179446
	iters: 100, epoch: 4 | loss: 0.5429618
	speed: 0.0099s/iter; left time: 24.8106s
	iters: 200, epoch: 4 | loss: 0.4206957
	speed: 0.0050s/iter; left time: 11.9764s
	iters: 300, epoch: 4 | loss: 1.0619153
	speed: 0.0049s/iter; left time: 11.4246s
	iters: 400, epoch: 4 | loss: 0.9936700
	speed: 0.0050s/iter; left time: 11.0109s
	iters: 500, epoch: 4 | loss: 0.7391306
	speed: 0.0050s/iter; left time: 10.4789s
Updating learning rate to 0.0001283151322625
Epoch: 4 cost time: 2.622471570968628
Epoch: 4, Steps: 523 | Train Loss: 0.7516747 Vali Loss: 0.3236945 Best vali loss: 0.3179446
	iters: 100, epoch: 5 | loss: 0.3919845
	speed: 0.0099s/iter; left time: 19.6735s
	iters: 200, epoch: 5 | loss: 0.2474021
	speed: 0.0046s/iter; left time: 8.6777s
	iters: 300, epoch: 5 | loss: 0.6595009
	speed: 0.0047s/iter; left time: 8.3466s
	iters: 400, epoch: 5 | loss: 0.7020980
	speed: 0.0046s/iter; left time: 7.7766s
	iters: 500, epoch: 5 | loss: 0.9162536
	speed: 0.0045s/iter; left time: 7.2334s
Updating learning rate to 6.415756613125e-05
Epoch: 5 cost time: 2.474299192428589
Epoch: 5, Steps: 523 | Train Loss: 0.5834478 Vali Loss: 0.3192276 Best vali loss: 0.3179446
	iters: 100, epoch: 6 | loss: 0.3150742
	speed: 0.0102s/iter; left time: 14.9574s
	iters: 200, epoch: 6 | loss: 0.2982151
	speed: 0.0051s/iter; left time: 7.0440s
	iters: 300, epoch: 6 | loss: 0.7443859
	speed: 0.0050s/iter; left time: 6.3751s
	iters: 400, epoch: 6 | loss: 1.0842049
	speed: 0.0050s/iter; left time: 5.8838s
	iters: 500, epoch: 6 | loss: 0.2580035
	speed: 0.0051s/iter; left time: 5.4394s
Updating learning rate to 3.2078783065625e-05
Epoch: 6 cost time: 2.716343879699707
Epoch: 6, Steps: 523 | Train Loss: 0.5399767 Vali Loss: 0.3220010 Best vali loss: 0.3179446
	iters: 100, epoch: 7 | loss: 0.7233951
	speed: 0.0103s/iter; left time: 9.7364s
	iters: 200, epoch: 7 | loss: 0.3411116
	speed: 0.0053s/iter; left time: 4.4873s
	iters: 300, epoch: 7 | loss: 1.5550716
	speed: 0.0053s/iter; left time: 3.9266s
	iters: 400, epoch: 7 | loss: 0.9365562
	speed: 0.0053s/iter; left time: 3.4058s
	iters: 500, epoch: 7 | loss: 0.2817833
	speed: 0.0053s/iter; left time: 2.8826s
Updating learning rate to 1.60393915328125e-05
Epoch: 7 cost time: 2.7939083576202393
Epoch: 7, Steps: 523 | Train Loss: 0.7675835 Vali Loss: 0.3216952 Best vali loss: 0.3179446
	iters: 100, epoch: 8 | loss: 0.3734278
	speed: 0.0099s/iter; left time: 4.2005s
	iters: 200, epoch: 8 | loss: 0.8671587
	speed: 0.0049s/iter; left time: 1.5966s
	iters: 300, epoch: 8 | loss: 0.2268906
	speed: 0.0049s/iter; left time: 1.0985s
	iters: 400, epoch: 8 | loss: 0.3608395
	speed: 0.0049s/iter; left time: 0.6112s
	iters: 500, epoch: 8 | loss: 0.9459965
	speed: 0.0049s/iter; left time: 0.1176s
Updating learning rate to 8.01969576640625e-06
Epoch: 8 cost time: 2.6045053005218506
Epoch: 8, Steps: 523 | Train Loss: 0.5548626 Vali Loss: 0.3218791 Best vali loss: 0.3179446

best validation loss 0.3179445940129772

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0047065878916, 'e_layers': 2, 'learning_rate': 6.01986772e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2291369
	speed: 0.0087s/iter; left time: 35.3504s
	iters: 200, epoch: 1 | loss: 0.8058780
	speed: 0.0034s/iter; left time: 13.5582s
	iters: 300, epoch: 1 | loss: 0.5503475
	speed: 0.0034s/iter; left time: 13.2120s
	iters: 400, epoch: 1 | loss: 0.4919018
	speed: 0.0033s/iter; left time: 12.6365s
	iters: 500, epoch: 1 | loss: 0.3027359
	speed: 0.0033s/iter; left time: 12.2661s
Updating learning rate to 6.01986772e-05
Validation loss decreased (inf --> 0.3231).  Saving model state dict ...
Epoch: 1 cost time: 2.018449068069458
Epoch: 1, Steps: 523 | Train Loss: 0.4760000 Vali Loss: 0.3230912 Best vali loss: 0.3230912
	iters: 100, epoch: 2 | loss: 0.3399404
	speed: 0.0071s/iter; left time: 25.1882s
	iters: 200, epoch: 2 | loss: 0.3817469
	speed: 0.0031s/iter; left time: 10.6658s
	iters: 300, epoch: 2 | loss: 0.5428281
	speed: 0.0031s/iter; left time: 10.2764s
	iters: 400, epoch: 2 | loss: 0.7145288
	speed: 0.0031s/iter; left time: 10.0760s
	iters: 500, epoch: 2 | loss: 0.4396446
	speed: 0.0031s/iter; left time: 9.6817s
Updating learning rate to 3.00993386e-05
Validation loss decreased (0.3231 --> 0.3064).  Saving model state dict ...
Epoch: 2 cost time: 1.6462669372558594
Epoch: 2, Steps: 523 | Train Loss: 0.4837378 Vali Loss: 0.3063882 Best vali loss: 0.3063882
	iters: 100, epoch: 3 | loss: 0.8004486
	speed: 0.0071s/iter; left time: 21.6117s
	iters: 200, epoch: 3 | loss: 0.3825682
	speed: 0.0033s/iter; left time: 9.7578s
	iters: 300, epoch: 3 | loss: 0.7533664
	speed: 0.0033s/iter; left time: 9.4568s
	iters: 400, epoch: 3 | loss: 0.2142804
	speed: 0.0033s/iter; left time: 9.1453s
	iters: 500, epoch: 3 | loss: 0.4366649
	speed: 0.0033s/iter; left time: 8.7758s
Updating learning rate to 1.50496693e-05
Validation loss decreased (0.3064 --> 0.3015).  Saving model state dict ...
Epoch: 3 cost time: 1.7780373096466064
Epoch: 3, Steps: 523 | Train Loss: 0.5174657 Vali Loss: 0.3015433 Best vali loss: 0.3015433

best validation loss 0.3015433157097677

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002344259171, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597231
	speed: 0.0106s/iter; left time: 10.0878s
Updating learning rate to 0.0002344259171
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9432942867279053
Epoch: 1, Steps: 131 | Train Loss: 0.5597231 Vali Loss: 0.2756363 Best vali loss: 0.2756363
	iters: 100, epoch: 2 | loss: 0.3248575
	speed: 0.0088s/iter; left time: 7.1909s
Updating learning rate to 0.00011721295855
Validation loss decreased (0.2756 --> 0.2699).  Saving model state dict ...
Epoch: 2 cost time: 0.6987018585205078
Epoch: 2, Steps: 131 | Train Loss: 0.3248575 Vali Loss: 0.2698901 Best vali loss: 0.2698901
	iters: 100, epoch: 3 | loss: 0.4660833
	speed: 0.0089s/iter; left time: 6.1195s
Updating learning rate to 5.8606479275e-05
Epoch: 3 cost time: 0.7005603313446045
Epoch: 3, Steps: 131 | Train Loss: 0.4660833 Vali Loss: 0.2766566 Best vali loss: 0.2698901

best validation loss 0.26989012772640625

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0035375137683, 'e_layers': 2, 'learning_rate': 0.0043144250707, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7033080
	speed: 0.0106s/iter; left time: 10.0538s
Updating learning rate to 0.004150217044036645
Validation loss decreased (inf --> 0.3319).  Saving model state dict ...
Epoch: 1 cost time: 0.9405186176300049
Epoch: 1, Steps: 131 | Train Loss: 0.7033080 Vali Loss: 0.3318583 Best vali loss: 0.3318583
	iters: 100, epoch: 2 | loss: 0.4364755
	speed: 0.0089s/iter; left time: 7.2685s
Updating learning rate to 0.0036825921475566094
Validation loss decreased (0.3319 --> 0.3254).  Saving model state dict ...
Epoch: 2 cost time: 0.6972832679748535
Epoch: 2, Steps: 131 | Train Loss: 0.4364755 Vali Loss: 0.3254369 Best vali loss: 0.3254369
	iters: 100, epoch: 3 | loss: 0.6235301
	speed: 0.0089s/iter; left time: 6.1201s
Updating learning rate to 0.0029827420327187357
Validation loss decreased (0.3254 --> 0.3249).  Saving model state dict ...
Epoch: 3 cost time: 0.7070705890655518
Epoch: 3, Steps: 131 | Train Loss: 0.6235301 Vali Loss: 0.3248752 Best vali loss: 0.3248752

best validation loss 0.32487515107146336

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002344259171, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4193707
	speed: 0.0109s/iter; left time: 6.0624s
Updating learning rate to 2.93032396375e-05
Epoch: 4 cost time: 0.942272424697876
Epoch: 4, Steps: 131 | Train Loss: 0.4193707 Vali Loss: 0.3065363 Best vali loss: 0.2698901
	iters: 100, epoch: 5 | loss: 0.2812069
	speed: 0.0086s/iter; left time: 3.6682s
Updating learning rate to 1.465161981875e-05
Epoch: 5 cost time: 0.6921539306640625
Epoch: 5, Steps: 131 | Train Loss: 0.2812069 Vali Loss: 0.2893133 Best vali loss: 0.2698901
	iters: 100, epoch: 6 | loss: 0.4325984
	speed: 0.0085s/iter; left time: 2.5096s
Updating learning rate to 7.325809909375e-06
Epoch: 6 cost time: 0.6908242702484131
Epoch: 6, Steps: 131 | Train Loss: 0.4325984 Vali Loss: 0.3003102 Best vali loss: 0.2698901
	iters: 100, epoch: 7 | loss: 0.4666186
	speed: 0.0085s/iter; left time: 1.3866s
Updating learning rate to 3.6629049546875e-06
Epoch: 7 cost time: 0.6960804462432861
Epoch: 7, Steps: 131 | Train Loss: 0.4666186 Vali Loss: 0.2956424 Best vali loss: 0.2698901
	iters: 100, epoch: 8 | loss: 0.3248565
	speed: 0.0086s/iter; left time: 0.2744s
Updating learning rate to 1.83145247734375e-06
Epoch: 8 cost time: 0.6946067810058594
Epoch: 8, Steps: 131 | Train Loss: 0.3248565 Vali Loss: 0.2937120 Best vali loss: 0.2698901

best validation loss 0.26989012772640625

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039247190875, 'e_layers': 2, 'learning_rate': 0.004712525906, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6867044
	speed: 0.0103s/iter; left time: 9.8169s
Updating learning rate to 0.004533166068491305
Validation loss decreased (inf --> 0.3206).  Saving model state dict ...
Epoch: 1 cost time: 0.9265749454498291
Epoch: 1, Steps: 131 | Train Loss: 0.6867044 Vali Loss: 0.3205751 Best vali loss: 0.3205751
	iters: 100, epoch: 2 | loss: 0.4027136
	speed: 0.0089s/iter; left time: 7.2924s
Updating learning rate to 0.00402239246532494
Validation loss decreased (0.3206 --> 0.3126).  Saving model state dict ...
Epoch: 2 cost time: 0.7024052143096924
Epoch: 2, Steps: 131 | Train Loss: 0.4027136 Vali Loss: 0.3125630 Best vali loss: 0.3125630
	iters: 100, epoch: 3 | loss: 0.5812679
	speed: 0.0091s/iter; left time: 6.2750s
Updating learning rate to 0.0032579657474087424
Validation loss decreased (0.3126 --> 0.3078).  Saving model state dict ...
Epoch: 3 cost time: 0.706226110458374
Epoch: 3, Steps: 131 | Train Loss: 0.5812679 Vali Loss: 0.3078163 Best vali loss: 0.3078163
	iters: 100, epoch: 4 | loss: 0.6998436
	speed: 0.0091s/iter; left time: 5.0553s
Updating learning rate to 0.002356262953
Validation loss decreased (0.3078 --> 0.3071).  Saving model state dict ...
Epoch: 4 cost time: 0.7103466987609863
Epoch: 4, Steps: 131 | Train Loss: 0.6998436 Vali Loss: 0.3070603 Best vali loss: 0.3070603
	iters: 100, epoch: 5 | loss: 0.3820727
	speed: 0.0090s/iter; left time: 3.8070s
Updating learning rate to 0.0014545601585912579
Validation loss decreased (0.3071 --> 0.3018).  Saving model state dict ...
Epoch: 5 cost time: 0.705388069152832
Epoch: 5, Steps: 131 | Train Loss: 0.3820727 Vali Loss: 0.3018302 Best vali loss: 0.3018302
	iters: 100, epoch: 6 | loss: 0.3920500
	speed: 0.0091s/iter; left time: 2.6635s
Updating learning rate to 0.0006901334406750609
Epoch: 6 cost time: 0.7091672420501709
Epoch: 6, Steps: 131 | Train Loss: 0.3920500 Vali Loss: 0.3099883 Best vali loss: 0.3018302
	iters: 100, epoch: 7 | loss: 0.4122492
	speed: 0.0086s/iter; left time: 1.3994s
Updating learning rate to 0.00017935983750869602
Epoch: 7 cost time: 0.7008383274078369
Epoch: 7, Steps: 131 | Train Loss: 0.4122492 Vali Loss: 0.3220159 Best vali loss: 0.3018302
	iters: 100, epoch: 8 | loss: 0.5591639
	speed: 0.0086s/iter; left time: 0.2763s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6962177753448486
Epoch: 8, Steps: 131 | Train Loss: 0.5591639 Vali Loss: 0.3242686 Best vali loss: 0.3018302

best validation loss 0.30183021148459627

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013139864585, 'e_layers': 2, 'learning_rate': 0.0049160201534, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7114860
	speed: 0.0104s/iter; left time: 9.8330s
Updating learning rate to 0.0047289152772696285
Validation loss decreased (inf --> 0.3152).  Saving model state dict ...
Epoch: 1 cost time: 0.9257943630218506
Epoch: 1, Steps: 131 | Train Loss: 0.7114860 Vali Loss: 0.3152316 Best vali loss: 0.3152316
	iters: 100, epoch: 2 | loss: 0.3724231
	speed: 0.0088s/iter; left time: 7.2353s
Updating learning rate to 0.004196085670159436
Validation loss decreased (0.3152 --> 0.3051).  Saving model state dict ...
Epoch: 2 cost time: 0.7002911567687988
Epoch: 2, Steps: 131 | Train Loss: 0.3724231 Vali Loss: 0.3051450 Best vali loss: 0.3051450
	iters: 100, epoch: 3 | loss: 0.5820265
	speed: 0.0090s/iter; left time: 6.1549s
Updating learning rate to 0.003398649809639534
Epoch: 3 cost time: 0.7064197063446045
Epoch: 3, Steps: 131 | Train Loss: 0.5820265 Vali Loss: 0.3105726 Best vali loss: 0.3051450
	iters: 100, epoch: 4 | loss: 0.6932561
	speed: 0.0086s/iter; left time: 4.7923s
Updating learning rate to 0.0024580100767
Epoch: 4 cost time: 0.6996901035308838
Epoch: 4, Steps: 131 | Train Loss: 0.6932561 Vali Loss: 0.3146680 Best vali loss: 0.3051450
	iters: 100, epoch: 5 | loss: 0.4133847
	speed: 0.0086s/iter; left time: 3.6567s
Updating learning rate to 0.0015173703437604666
Epoch: 5 cost time: 0.6989779472351074
Epoch: 5, Steps: 131 | Train Loss: 0.4133847 Vali Loss: 0.3231860 Best vali loss: 0.3051450
	iters: 100, epoch: 6 | loss: 0.3863820
	speed: 0.0087s/iter; left time: 2.5472s
Updating learning rate to 0.0007199344832405644
Epoch: 6 cost time: 0.7002019882202148
Epoch: 6, Steps: 131 | Train Loss: 0.3863820 Vali Loss: 0.3217736 Best vali loss: 0.3051450
	iters: 100, epoch: 7 | loss: 0.4367401
	speed: 0.0087s/iter; left time: 1.4141s
Updating learning rate to 0.00018710487613037195
Epoch: 7 cost time: 0.7072091102600098
Epoch: 7, Steps: 131 | Train Loss: 0.4367401 Vali Loss: 0.3226608 Best vali loss: 0.3051450
	iters: 100, epoch: 8 | loss: 0.6962761
	speed: 0.0086s/iter; left time: 0.2764s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6959271430969238
Epoch: 8, Steps: 131 | Train Loss: 0.6962761 Vali Loss: 0.3225455 Best vali loss: 0.3051450

best validation loss 0.3051449811870877

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011913590175, 'e_layers': 2, 'learning_rate': 0.0047853426661, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7018787
	speed: 0.0104s/iter; left time: 9.8339s
Updating learning rate to 0.0046032114056813915
Validation loss decreased (inf --> 0.3273).  Saving model state dict ...
Epoch: 1 cost time: 0.9268920421600342
Epoch: 1, Steps: 131 | Train Loss: 0.7018787 Vali Loss: 0.3272649 Best vali loss: 0.3272649
	iters: 100, epoch: 2 | loss: 0.3808175
	speed: 0.0088s/iter; left time: 7.1807s
Updating learning rate to 0.004084545457800312
Validation loss decreased (0.3273 --> 0.3246).  Saving model state dict ...
Epoch: 2 cost time: 0.6950232982635498
Epoch: 2, Steps: 131 | Train Loss: 0.3808175 Vali Loss: 0.3246235 Best vali loss: 0.3246235
	iters: 100, epoch: 3 | loss: 0.6244740
	speed: 0.0090s/iter; left time: 6.1598s
Updating learning rate to 0.0033083070113031294
Validation loss decreased (0.3246 --> 0.3220).  Saving model state dict ...
Epoch: 3 cost time: 0.702451229095459
Epoch: 3, Steps: 131 | Train Loss: 0.6244740 Vali Loss: 0.3220135 Best vali loss: 0.3220135

best validation loss 0.32201349161158

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012503607221, 'e_layers': 2, 'learning_rate': 0.0049763792574, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6978248
	speed: 0.0103s/iter; left time: 9.8050s
Updating learning rate to 0.004786977099662788
Validation loss decreased (inf --> 0.3141).  Saving model state dict ...
Epoch: 1 cost time: 0.9161388874053955
Epoch: 1, Steps: 131 | Train Loss: 0.6978248 Vali Loss: 0.3140890 Best vali loss: 0.3140890
	iters: 100, epoch: 2 | loss: 0.4234647
	speed: 0.0088s/iter; left time: 7.2014s
Updating learning rate to 0.004247605388031808
Epoch: 2 cost time: 0.7030007839202881
Epoch: 2, Steps: 131 | Train Loss: 0.4234647 Vali Loss: 0.3339556 Best vali loss: 0.3140890
	iters: 100, epoch: 3 | loss: 0.5745355
	speed: 0.0087s/iter; left time: 5.9681s
Updating learning rate to 0.0034403785761861344
Epoch: 3 cost time: 0.701995849609375
Epoch: 3, Steps: 131 | Train Loss: 0.5745355 Vali Loss: 0.3143288 Best vali loss: 0.3140890

best validation loss 0.3140890249458109

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0091153155541, 'e_layers': 2, 'learning_rate': 0.0042269997295, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5675046
	speed: 0.0089s/iter; left time: 8.4396s
Updating learning rate to 0.0042269997295
Validation loss decreased (inf --> 0.2938).  Saving model state dict ...
Epoch: 1 cost time: 0.7195866107940674
Epoch: 1, Steps: 131 | Train Loss: 0.5675046 Vali Loss: 0.2938315 Best vali loss: 0.2938315
	iters: 100, epoch: 2 | loss: 0.5645645
	speed: 0.0061s/iter; left time: 4.9646s
Updating learning rate to 0.00211349986475
Validation loss decreased (0.2938 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 0.47901225090026855
Epoch: 2, Steps: 131 | Train Loss: 0.5645645 Vali Loss: 0.2833345 Best vali loss: 0.2833345
	iters: 100, epoch: 3 | loss: 0.5970012
	speed: 0.0062s/iter; left time: 4.2816s
Updating learning rate to 0.001056749932375
Epoch: 3 cost time: 0.5062179565429688
Epoch: 3, Steps: 131 | Train Loss: 0.5970012 Vali Loss: 0.2901512 Best vali loss: 0.2833345

best validation loss 0.2833344708447919

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0091153155541, 'e_layers': 2, 'learning_rate': 0.0042269997295, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5107928
	speed: 0.0092s/iter; left time: 5.0962s
Updating learning rate to 0.0005283749661875
Epoch: 4 cost time: 0.7573442459106445
Epoch: 4, Steps: 131 | Train Loss: 0.5107928 Vali Loss: 0.2976611 Best vali loss: 0.2833345
	iters: 100, epoch: 5 | loss: 0.4471123
	speed: 0.0068s/iter; left time: 2.9088s
Updating learning rate to 0.00026418748309375
Epoch: 5 cost time: 0.5260000228881836
Epoch: 5, Steps: 131 | Train Loss: 0.4471123 Vali Loss: 0.3026061 Best vali loss: 0.2833345
	iters: 100, epoch: 6 | loss: 0.5269893
	speed: 0.0064s/iter; left time: 1.8890s
Updating learning rate to 0.000132093741546875
Epoch: 6 cost time: 0.5103280544281006
Epoch: 6, Steps: 131 | Train Loss: 0.5269893 Vali Loss: 0.3060643 Best vali loss: 0.2833345
	iters: 100, epoch: 7 | loss: 0.3866641
	speed: 0.0062s/iter; left time: 1.0076s
Updating learning rate to 6.60468707734375e-05
Epoch: 7 cost time: 0.4915180206298828
Epoch: 7, Steps: 131 | Train Loss: 0.3866641 Vali Loss: 0.3095218 Best vali loss: 0.2833345
	iters: 100, epoch: 8 | loss: 0.3607105
	speed: 0.0060s/iter; left time: 0.1908s
Updating learning rate to 3.302343538671875e-05
Epoch: 8 cost time: 0.4691925048828125
Epoch: 8, Steps: 131 | Train Loss: 0.3607105 Vali Loss: 0.3099352 Best vali loss: 0.2833345

best validation loss 0.2833344708447919

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0045899582429, 'e_layers': 2, 'learning_rate': 0.0019326669796, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5529346
	speed: 0.0085s/iter; left time: 70.3319s
	iters: 200, epoch: 1 | loss: 0.2815267
	speed: 0.0034s/iter; left time: 27.4378s
	iters: 300, epoch: 1 | loss: 0.3857135
	speed: 0.0033s/iter; left time: 26.5315s
	iters: 400, epoch: 1 | loss: 0.3004329
	speed: 0.0033s/iter; left time: 26.4322s
	iters: 500, epoch: 1 | loss: 1.0305007
	speed: 0.0033s/iter; left time: 26.1271s
	iters: 600, epoch: 1 | loss: 0.3317752
	speed: 0.0033s/iter; left time: 25.9441s
	iters: 700, epoch: 1 | loss: 0.4798610
	speed: 0.0034s/iter; left time: 25.7360s
	iters: 800, epoch: 1 | loss: 0.3662398
	speed: 0.0034s/iter; left time: 25.5159s
	iters: 900, epoch: 1 | loss: 0.3502281
	speed: 0.0033s/iter; left time: 24.9737s
	iters: 1000, epoch: 1 | loss: 0.4450740
	speed: 0.0033s/iter; left time: 24.5516s
Updating learning rate to 0.0018591092226064242
Validation loss decreased (inf --> 0.3214).  Saving model state dict ...
Epoch: 1 cost time: 3.7522857189178467
Epoch: 1, Steps: 1045 | Train Loss: 0.4524286 Vali Loss: 0.3214379 Best vali loss: 0.3214379
	iters: 100, epoch: 2 | loss: 0.3349316
	speed: 0.0099s/iter; left time: 71.3608s
	iters: 200, epoch: 2 | loss: 1.3964887
	speed: 0.0030s/iter; left time: 21.5611s
	iters: 300, epoch: 2 | loss: 0.4874411
	speed: 0.0033s/iter; left time: 22.8894s
	iters: 400, epoch: 2 | loss: 1.7500037
	speed: 0.0031s/iter; left time: 21.4926s
	iters: 500, epoch: 2 | loss: 1.0840114
	speed: 0.0031s/iter; left time: 20.7997s
	iters: 600, epoch: 2 | loss: 0.4229565
	speed: 0.0032s/iter; left time: 21.8247s
	iters: 700, epoch: 2 | loss: 0.7928499
	speed: 0.0034s/iter; left time: 22.2966s
	iters: 800, epoch: 2 | loss: 0.2884516
	speed: 0.0034s/iter; left time: 21.9338s
	iters: 900, epoch: 2 | loss: 0.4569835
	speed: 0.0034s/iter; left time: 21.8670s
	iters: 1000, epoch: 2 | loss: 0.3088866
	speed: 0.0034s/iter; left time: 21.7008s
Updating learning rate to 0.0016496344533252414
Epoch: 2 cost time: 3.4251327514648438
Epoch: 2, Steps: 1045 | Train Loss: 0.7323005 Vali Loss: 0.3271974 Best vali loss: 0.3214379
	iters: 100, epoch: 3 | loss: 0.2911707
	speed: 0.0102s/iter; left time: 63.0487s
	iters: 200, epoch: 3 | loss: 0.6780369
	speed: 0.0032s/iter; left time: 19.1393s
	iters: 300, epoch: 3 | loss: 1.3466879
	speed: 0.0032s/iter; left time: 19.0195s
	iters: 400, epoch: 3 | loss: 0.5295537
	speed: 0.0031s/iter; left time: 18.1006s
	iters: 500, epoch: 3 | loss: 0.4086140
	speed: 0.0031s/iter; left time: 17.9963s
	iters: 600, epoch: 3 | loss: 0.1928820
	speed: 0.0031s/iter; left time: 17.8120s
	iters: 700, epoch: 3 | loss: 0.6214361
	speed: 0.0031s/iter; left time: 17.5423s
	iters: 800, epoch: 3 | loss: 0.8938824
	speed: 0.0031s/iter; left time: 16.9802s
	iters: 900, epoch: 3 | loss: 0.2428922
	speed: 0.0031s/iter; left time: 16.9122s
	iters: 1000, epoch: 3 | loss: 0.4260340
	speed: 0.0032s/iter; left time: 16.6377s
Updating learning rate to 0.0013361333064859995
Epoch: 3 cost time: 3.3277742862701416
Epoch: 3, Steps: 1045 | Train Loss: 0.5631190 Vali Loss: 0.3222483 Best vali loss: 0.3214379
	iters: 100, epoch: 4 | loss: 0.7408249
	speed: 0.0099s/iter; left time: 50.7466s
	iters: 200, epoch: 4 | loss: 1.9568155
	speed: 0.0031s/iter; left time: 15.6856s
	iters: 300, epoch: 4 | loss: 0.9706916
	speed: 0.0032s/iter; left time: 15.5752s
	iters: 400, epoch: 4 | loss: 0.8911861
	speed: 0.0032s/iter; left time: 15.5342s
	iters: 500, epoch: 4 | loss: 0.8422501
	speed: 0.0034s/iter; left time: 16.1782s
	iters: 600, epoch: 4 | loss: 1.3124443
	speed: 0.0034s/iter; left time: 15.8202s
	iters: 700, epoch: 4 | loss: 0.7378978
	speed: 0.0034s/iter; left time: 15.3149s
	iters: 800, epoch: 4 | loss: 0.4001344
	speed: 0.0034s/iter; left time: 15.2061s
	iters: 900, epoch: 4 | loss: 0.2412800
	speed: 0.0034s/iter; left time: 14.5894s
	iters: 1000, epoch: 4 | loss: 0.5459484
	speed: 0.0034s/iter; left time: 14.3479s
Updating learning rate to 0.0009663334898
Epoch: 4 cost time: 3.504204273223877
Epoch: 4, Steps: 1045 | Train Loss: 0.8639473 Vali Loss: 0.3306405 Best vali loss: 0.3214379
	iters: 100, epoch: 5 | loss: 0.1924279
	speed: 0.0106s/iter; left time: 43.3324s
	iters: 200, epoch: 5 | loss: 0.3301370
	speed: 0.0035s/iter; left time: 13.8698s
	iters: 300, epoch: 5 | loss: 0.3920639
	speed: 0.0035s/iter; left time: 13.5212s
	iters: 400, epoch: 5 | loss: 0.4901178
	speed: 0.0036s/iter; left time: 13.5001s
	iters: 500, epoch: 5 | loss: 0.3205233
	speed: 0.0035s/iter; left time: 12.9191s
	iters: 600, epoch: 5 | loss: 0.4837489
	speed: 0.0036s/iter; left time: 12.7473s
	iters: 700, epoch: 5 | loss: 0.3367742
	speed: 0.0036s/iter; left time: 12.4202s
	iters: 800, epoch: 5 | loss: 1.4363827
	speed: 0.0034s/iter; left time: 11.5232s
	iters: 900, epoch: 5 | loss: 0.1704360
	speed: 0.0034s/iter; left time: 11.1525s
	iters: 1000, epoch: 5 | loss: 1.2945459
	speed: 0.0035s/iter; left time: 11.0872s
Updating learning rate to 0.0005965336731140006
Validation loss decreased (0.3214 --> 0.3205).  Saving model state dict ...
Epoch: 5 cost time: 3.6783509254455566
Epoch: 5, Steps: 1045 | Train Loss: 0.5447158 Vali Loss: 0.3204936 Best vali loss: 0.3204936
	iters: 100, epoch: 6 | loss: 1.3020362
	speed: 0.0100s/iter; left time: 30.3460s
	iters: 200, epoch: 6 | loss: 1.3840053
	speed: 0.0031s/iter; left time: 9.0694s
	iters: 300, epoch: 6 | loss: 1.9371334
	speed: 0.0031s/iter; left time: 8.6822s
	iters: 400, epoch: 6 | loss: 1.0724466
	speed: 0.0031s/iter; left time: 8.4509s
	iters: 500, epoch: 6 | loss: 0.3915348
	speed: 0.0031s/iter; left time: 8.1206s
	iters: 600, epoch: 6 | loss: 0.7245327
	speed: 0.0030s/iter; left time: 7.6305s
	iters: 700, epoch: 6 | loss: 1.0383993
	speed: 0.0031s/iter; left time: 7.5297s
	iters: 800, epoch: 6 | loss: 0.4088137
	speed: 0.0030s/iter; left time: 7.1152s
	iters: 900, epoch: 6 | loss: 0.3933979
	speed: 0.0031s/iter; left time: 6.8490s
	iters: 1000, epoch: 6 | loss: 0.2593494
	speed: 0.0030s/iter; left time: 6.5123s
Updating learning rate to 0.0002830325262747586
Epoch: 6 cost time: 3.2383365631103516
Epoch: 6, Steps: 1045 | Train Loss: 0.8911649 Vali Loss: 0.3211032 Best vali loss: 0.3204936
	iters: 100, epoch: 7 | loss: 0.2989152
	speed: 0.0097s/iter; left time: 19.2263s
	iters: 200, epoch: 7 | loss: 0.3263204
	speed: 0.0030s/iter; left time: 5.7393s
	iters: 300, epoch: 7 | loss: 0.1600353
	speed: 0.0031s/iter; left time: 5.4824s
	iters: 400, epoch: 7 | loss: 0.2407183
	speed: 0.0030s/iter; left time: 5.1433s
	iters: 500, epoch: 7 | loss: 0.6241813
	speed: 0.0030s/iter; left time: 4.8499s
	iters: 600, epoch: 7 | loss: 2.2565279
	speed: 0.0030s/iter; left time: 4.5162s
	iters: 700, epoch: 7 | loss: 0.3784166
	speed: 0.0030s/iter; left time: 4.2154s
	iters: 800, epoch: 7 | loss: 0.4420454
	speed: 0.0031s/iter; left time: 3.9519s
	iters: 900, epoch: 7 | loss: 0.3181417
	speed: 0.0031s/iter; left time: 3.6656s
	iters: 1000, epoch: 7 | loss: 0.6734206
	speed: 0.0031s/iter; left time: 3.3890s
Updating learning rate to 7.355775699357573e-05
Epoch: 7 cost time: 3.231738805770874
Epoch: 7, Steps: 1045 | Train Loss: 0.5718723 Vali Loss: 0.3218198 Best vali loss: 0.3204936
	iters: 100, epoch: 8 | loss: 0.3469947
	speed: 0.0098s/iter; left time: 9.2476s
	iters: 200, epoch: 8 | loss: 0.3251477
	speed: 0.0031s/iter; left time: 2.6044s
	iters: 300, epoch: 8 | loss: 0.2214615
	speed: 0.0031s/iter; left time: 2.3053s
	iters: 400, epoch: 8 | loss: 0.4967887
	speed: 0.0030s/iter; left time: 1.9603s
	iters: 500, epoch: 8 | loss: 0.3345538
	speed: 0.0032s/iter; left time: 1.7342s
	iters: 600, epoch: 8 | loss: 1.2019389
	speed: 0.0034s/iter; left time: 1.5223s
	iters: 700, epoch: 8 | loss: 1.8268324
	speed: 0.0034s/iter; left time: 1.1758s
	iters: 800, epoch: 8 | loss: 1.3629675
	speed: 0.0035s/iter; left time: 0.8513s
	iters: 900, epoch: 8 | loss: 0.4892190
	speed: 0.0035s/iter; left time: 0.5052s
	iters: 1000, epoch: 8 | loss: 0.2596202
	speed: 0.0034s/iter; left time: 0.1582s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.45424485206604
Epoch: 8, Steps: 1045 | Train Loss: 0.6865524 Vali Loss: 0.3219010 Best vali loss: 0.3204936

best validation loss 0.3204936454202128

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062533033479, 'e_layers': 1, 'learning_rate': 0.0049192734847, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2595699
	speed: 0.0074s/iter; left time: 61.0221s
	iters: 200, epoch: 1 | loss: 0.5052082
	speed: 0.0023s/iter; left time: 18.5928s
	iters: 300, epoch: 1 | loss: 0.1710308
	speed: 0.0023s/iter; left time: 18.3781s
	iters: 400, epoch: 1 | loss: 0.4632632
	speed: 0.0022s/iter; left time: 17.7111s
	iters: 500, epoch: 1 | loss: 0.5103304
	speed: 0.0023s/iter; left time: 18.0201s
	iters: 600, epoch: 1 | loss: 0.2602946
	speed: 0.0023s/iter; left time: 17.5287s
	iters: 700, epoch: 1 | loss: 0.4662802
	speed: 0.0023s/iter; left time: 17.4288s
	iters: 800, epoch: 1 | loss: 0.5076011
	speed: 0.0023s/iter; left time: 17.2146s
	iters: 900, epoch: 1 | loss: 0.1788063
	speed: 0.0023s/iter; left time: 16.9860s
	iters: 1000, epoch: 1 | loss: 0.4816837
	speed: 0.0023s/iter; left time: 16.7598s
Updating learning rate to 0.004732044786019902
Validation loss decreased (inf --> 0.2903).  Saving model state dict ...
Epoch: 1 cost time: 2.6282529830932617
Epoch: 1, Steps: 1045 | Train Loss: 0.3804068 Vali Loss: 0.2903121 Best vali loss: 0.2903121
	iters: 100, epoch: 2 | loss: 0.4905973
	speed: 0.0078s/iter; left time: 56.4121s
	iters: 200, epoch: 2 | loss: 0.4209034
	speed: 0.0023s/iter; left time: 16.6518s
	iters: 300, epoch: 2 | loss: 0.1871752
	speed: 0.0023s/iter; left time: 16.2625s
	iters: 400, epoch: 2 | loss: 0.5544910
	speed: 0.0023s/iter; left time: 16.1284s
	iters: 500, epoch: 2 | loss: 0.3304807
	speed: 0.0023s/iter; left time: 15.9258s
	iters: 600, epoch: 2 | loss: 0.2164900
	speed: 0.0023s/iter; left time: 15.7348s
	iters: 700, epoch: 2 | loss: 0.5468025
	speed: 0.0023s/iter; left time: 15.3713s
	iters: 800, epoch: 2 | loss: 0.7660534
	speed: 0.0023s/iter; left time: 14.9054s
	iters: 900, epoch: 2 | loss: 0.2981569
	speed: 0.0023s/iter; left time: 14.7988s
	iters: 1000, epoch: 2 | loss: 0.2047418
	speed: 0.0023s/iter; left time: 14.6710s
Updating learning rate to 0.004198862562121273
Validation loss decreased (0.2903 --> 0.2855).  Saving model state dict ...
Epoch: 2 cost time: 2.4649007320404053
Epoch: 2, Steps: 1045 | Train Loss: 0.4015892 Vali Loss: 0.2855190 Best vali loss: 0.2855190
	iters: 100, epoch: 3 | loss: 0.2940539
	speed: 0.0078s/iter; left time: 47.9119s
	iters: 200, epoch: 3 | loss: 0.2024051
	speed: 0.0021s/iter; left time: 12.5858s
	iters: 300, epoch: 3 | loss: 0.4520760
	speed: 0.0020s/iter; left time: 12.1938s
	iters: 400, epoch: 3 | loss: 0.3457485
	speed: 0.0020s/iter; left time: 11.9942s
	iters: 500, epoch: 3 | loss: 0.8931047
	speed: 0.0020s/iter; left time: 11.7701s
	iters: 600, epoch: 3 | loss: 0.1548544
	speed: 0.0021s/iter; left time: 11.7114s
	iters: 700, epoch: 3 | loss: 1.0467131
	speed: 0.0021s/iter; left time: 11.5455s
	iters: 800, epoch: 3 | loss: 0.2756552
	speed: 0.0020s/iter; left time: 11.1934s
	iters: 900, epoch: 3 | loss: 0.3426522
	speed: 0.0020s/iter; left time: 10.9280s
	iters: 1000, epoch: 3 | loss: 0.2837796
	speed: 0.0020s/iter; left time: 10.6844s
Updating learning rate to 0.003400898973283786
Validation loss decreased (0.2855 --> 0.2840).  Saving model state dict ...
Epoch: 3 cost time: 2.1787142753601074
Epoch: 3, Steps: 1045 | Train Loss: 0.4291043 Vali Loss: 0.2840348 Best vali loss: 0.2840348
	iters: 100, epoch: 4 | loss: 0.2275485
	speed: 0.0074s/iter; left time: 38.1652s
	iters: 200, epoch: 4 | loss: 0.4786279
	speed: 0.0021s/iter; left time: 10.5058s
	iters: 300, epoch: 4 | loss: 0.8047848
	speed: 0.0020s/iter; left time: 10.0024s
	iters: 400, epoch: 4 | loss: 0.5745742
	speed: 0.0020s/iter; left time: 9.7542s
	iters: 500, epoch: 4 | loss: 0.3032182
	speed: 0.0020s/iter; left time: 9.6851s
	iters: 600, epoch: 4 | loss: 0.4564135
	speed: 0.0020s/iter; left time: 9.3933s
	iters: 700, epoch: 4 | loss: 1.2412685
	speed: 0.0020s/iter; left time: 9.1625s
	iters: 800, epoch: 4 | loss: 0.3757348
	speed: 0.0020s/iter; left time: 8.9383s
	iters: 900, epoch: 4 | loss: 0.1772231
	speed: 0.0020s/iter; left time: 8.8436s
	iters: 1000, epoch: 4 | loss: 0.2915877
	speed: 0.0020s/iter; left time: 8.5732s
Updating learning rate to 0.00245963674235
Epoch: 4 cost time: 2.1718525886535645
Epoch: 4, Steps: 1045 | Train Loss: 0.4930981 Vali Loss: 0.2849219 Best vali loss: 0.2840348
	iters: 100, epoch: 5 | loss: 0.7640554
	speed: 0.0077s/iter; left time: 31.2817s
	iters: 200, epoch: 5 | loss: 0.2207799
	speed: 0.0020s/iter; left time: 8.1591s
	iters: 300, epoch: 5 | loss: 0.4083268
	speed: 0.0020s/iter; left time: 7.6833s
	iters: 400, epoch: 5 | loss: 0.1858782
	speed: 0.0020s/iter; left time: 7.4759s
	iters: 500, epoch: 5 | loss: 0.4730366
	speed: 0.0020s/iter; left time: 7.2854s
	iters: 600, epoch: 5 | loss: 0.2593055
	speed: 0.0020s/iter; left time: 7.1460s
	iters: 700, epoch: 5 | loss: 1.1137340
	speed: 0.0023s/iter; left time: 8.0974s
	iters: 800, epoch: 5 | loss: 0.3174945
	speed: 0.0024s/iter; left time: 7.9740s
	iters: 900, epoch: 5 | loss: 0.3085177
	speed: 0.0024s/iter; left time: 7.8282s
	iters: 1000, epoch: 5 | loss: 0.4248281
	speed: 0.0024s/iter; left time: 7.5395s
Updating learning rate to 0.0015183745114162141
Validation loss decreased (0.2840 --> 0.2837).  Saving model state dict ...
Epoch: 5 cost time: 2.3111655712127686
Epoch: 5, Steps: 1045 | Train Loss: 0.4475957 Vali Loss: 0.2837163 Best vali loss: 0.2837163
	iters: 100, epoch: 6 | loss: 0.2817215
	speed: 0.0078s/iter; left time: 23.6769s
	iters: 200, epoch: 6 | loss: 0.3558522
	speed: 0.0021s/iter; left time: 6.1428s
	iters: 300, epoch: 6 | loss: 0.5230598
	speed: 0.0022s/iter; left time: 6.1385s
	iters: 400, epoch: 6 | loss: 0.3356778
	speed: 0.0023s/iter; left time: 6.2344s
	iters: 500, epoch: 6 | loss: 0.4295774
	speed: 0.0024s/iter; left time: 6.4126s
	iters: 600, epoch: 6 | loss: 0.5525455
	speed: 0.0022s/iter; left time: 5.6481s
	iters: 700, epoch: 6 | loss: 0.5324417
	speed: 0.0022s/iter; left time: 5.2856s
	iters: 800, epoch: 6 | loss: 0.5742279
	speed: 0.0021s/iter; left time: 4.9994s
	iters: 900, epoch: 6 | loss: 0.8733595
	speed: 0.0021s/iter; left time: 4.7626s
	iters: 1000, epoch: 6 | loss: 0.4979231
	speed: 0.0021s/iter; left time: 4.5914s
Updating learning rate to 0.0007204109225787261
Epoch: 6 cost time: 2.325207233428955
Epoch: 6, Steps: 1045 | Train Loss: 0.4956386 Vali Loss: 0.2931823 Best vali loss: 0.2837163
	iters: 100, epoch: 7 | loss: 0.2453681
	speed: 0.0079s/iter; left time: 15.6421s
	iters: 200, epoch: 7 | loss: 0.7185217
	speed: 0.0024s/iter; left time: 4.4866s
	iters: 300, epoch: 7 | loss: 0.2792843
	speed: 0.0024s/iter; left time: 4.2467s
	iters: 400, epoch: 7 | loss: 0.4116280
	speed: 0.0024s/iter; left time: 3.9910s
	iters: 500, epoch: 7 | loss: 0.3993596
	speed: 0.0023s/iter; left time: 3.7259s
	iters: 600, epoch: 7 | loss: 0.2383161
	speed: 0.0024s/iter; left time: 3.5183s
	iters: 700, epoch: 7 | loss: 0.1918899
	speed: 0.0024s/iter; left time: 3.2766s
	iters: 800, epoch: 7 | loss: 0.2537725
	speed: 0.0024s/iter; left time: 3.0610s
	iters: 900, epoch: 7 | loss: 0.3513528
	speed: 0.0022s/iter; left time: 2.5857s
	iters: 1000, epoch: 7 | loss: 0.2317789
	speed: 0.0022s/iter; left time: 2.3566s
Updating learning rate to 0.00018722869868009778
Epoch: 7 cost time: 2.4570188522338867
Epoch: 7, Steps: 1045 | Train Loss: 0.3321272 Vali Loss: 0.2906476 Best vali loss: 0.2837163
	iters: 100, epoch: 8 | loss: 0.2413895
	speed: 0.0078s/iter; left time: 7.3391s
	iters: 200, epoch: 8 | loss: 0.3860245
	speed: 0.0021s/iter; left time: 1.8092s
	iters: 300, epoch: 8 | loss: 0.6276498
	speed: 0.0021s/iter; left time: 1.5811s
	iters: 400, epoch: 8 | loss: 0.1725437
	speed: 0.0021s/iter; left time: 1.3769s
	iters: 500, epoch: 8 | loss: 1.2590773
	speed: 0.0021s/iter; left time: 1.1685s
	iters: 600, epoch: 8 | loss: 0.9646575
	speed: 0.0021s/iter; left time: 0.9368s
	iters: 700, epoch: 8 | loss: 0.5576735
	speed: 0.0021s/iter; left time: 0.7195s
	iters: 800, epoch: 8 | loss: 0.2083829
	speed: 0.0021s/iter; left time: 0.5168s
	iters: 900, epoch: 8 | loss: 0.7435272
	speed: 0.0021s/iter; left time: 0.3082s
	iters: 1000, epoch: 8 | loss: 0.2988763
	speed: 0.0021s/iter; left time: 0.0976s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2524077892303467
Epoch: 8, Steps: 1045 | Train Loss: 0.5459802 Vali Loss: 0.2926317 Best vali loss: 0.2837163

best validation loss 0.2837163207421475

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6372702
	speed: 0.0094s/iter; left time: 8.9062s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 0.7977783679962158
Epoch: 1, Steps: 131 | Train Loss: 0.6372702 Vali Loss: 0.2799182 Best vali loss: 0.2799182
	iters: 100, epoch: 2 | loss: 0.6602901
	speed: 0.0064s/iter; left time: 5.2365s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2799 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 0.47770094871520996
Epoch: 2, Steps: 131 | Train Loss: 0.6602901 Vali Loss: 0.2797242 Best vali loss: 0.2797242
	iters: 100, epoch: 3 | loss: 0.8015974
	speed: 0.0066s/iter; left time: 4.5679s
Updating learning rate to 5.8620599525e-05
Validation loss decreased (0.2797 --> 0.2774).  Saving model state dict ...
Epoch: 3 cost time: 0.556997537612915
Epoch: 3, Steps: 131 | Train Loss: 0.8015974 Vali Loss: 0.2773909 Best vali loss: 0.2773909

best validation loss 0.2773909330611869

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6372686
	speed: 0.0094s/iter; left time: 8.9365s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 0.7939534187316895
Epoch: 1, Steps: 131 | Train Loss: 0.6372686 Vali Loss: 0.2799180 Best vali loss: 0.2799180
	iters: 100, epoch: 2 | loss: 0.6602960
	speed: 0.0066s/iter; left time: 5.3809s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2799 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 0.49358177185058594
Epoch: 2, Steps: 131 | Train Loss: 0.6602960 Vali Loss: 0.2797252 Best vali loss: 0.2797252
	iters: 100, epoch: 3 | loss: 0.8015212
	speed: 0.0062s/iter; left time: 4.2354s
Updating learning rate to 5.862147895e-05
Validation loss decreased (0.2797 --> 0.2774).  Saving model state dict ...
Epoch: 3 cost time: 0.4865899085998535
Epoch: 3, Steps: 131 | Train Loss: 0.8015212 Vali Loss: 0.2773931 Best vali loss: 0.2773931

best validation loss 0.27739314693374323

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6372710
	speed: 0.0093s/iter; left time: 8.8111s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 0.7844235897064209
Epoch: 1, Steps: 131 | Train Loss: 0.6372710 Vali Loss: 0.2799168 Best vali loss: 0.2799168
	iters: 100, epoch: 2 | loss: 0.6602829
	speed: 0.0066s/iter; left time: 5.3583s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2799 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 0.49544525146484375
Epoch: 2, Steps: 131 | Train Loss: 0.6602829 Vali Loss: 0.2797282 Best vali loss: 0.2797282
	iters: 100, epoch: 3 | loss: 0.8015840
	speed: 0.0063s/iter; left time: 4.3348s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2797 --> 0.2774).  Saving model state dict ...
Epoch: 3 cost time: 0.5019726753234863
Epoch: 3, Steps: 131 | Train Loss: 0.8015840 Vali Loss: 0.2773801 Best vali loss: 0.2773801

best validation loss 0.2773801369620948

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6041378
	speed: 0.0093s/iter; left time: 5.1746s
Updating learning rate to 2.931587015e-05
Validation loss decreased (0.2774 --> 0.2768).  Saving model state dict ...
Epoch: 4 cost time: 0.7723934650421143
Epoch: 4, Steps: 131 | Train Loss: 0.6041378 Vali Loss: 0.2768280 Best vali loss: 0.2768280
	iters: 100, epoch: 5 | loss: 0.6059214
	speed: 0.0067s/iter; left time: 2.8415s
Updating learning rate to 1.4657935075e-05
Validation loss decreased (0.2768 --> 0.2767).  Saving model state dict ...
Epoch: 5 cost time: 0.5371725559234619
Epoch: 5, Steps: 131 | Train Loss: 0.6059214 Vali Loss: 0.2766554 Best vali loss: 0.2766554
	iters: 100, epoch: 6 | loss: 0.7656414
	speed: 0.0066s/iter; left time: 1.9460s
Updating learning rate to 7.3289675375e-06
Validation loss decreased (0.2767 --> 0.2763).  Saving model state dict ...
Epoch: 6 cost time: 0.5231904983520508
Epoch: 6, Steps: 131 | Train Loss: 0.7656414 Vali Loss: 0.2762873 Best vali loss: 0.2762873
	iters: 100, epoch: 7 | loss: 0.5379236
	speed: 0.0065s/iter; left time: 1.0600s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.5107545852661133
Epoch: 7, Steps: 131 | Train Loss: 0.5379236 Vali Loss: 0.2763261 Best vali loss: 0.2762873
	iters: 100, epoch: 8 | loss: 0.6230103
	speed: 0.0066s/iter; left time: 0.2101s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.5350167751312256
Epoch: 8, Steps: 131 | Train Loss: 0.6230103 Vali Loss: 0.2763639 Best vali loss: 0.2762873

best validation loss 0.27628730962869624

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6372690
	speed: 0.0094s/iter; left time: 8.9290s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 0.7925796508789062
Epoch: 1, Steps: 131 | Train Loss: 0.6372690 Vali Loss: 0.2799181 Best vali loss: 0.2799181
	iters: 100, epoch: 2 | loss: 0.6602946
	speed: 0.0068s/iter; left time: 5.5949s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2799 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 0.541811466217041
Epoch: 2, Steps: 131 | Train Loss: 0.6602946 Vali Loss: 0.2797251 Best vali loss: 0.2797251
	iters: 100, epoch: 3 | loss: 0.8015339
	speed: 0.0062s/iter; left time: 4.2822s
Updating learning rate to 5.8620599525e-05
Validation loss decreased (0.2797 --> 0.2774).  Saving model state dict ...
Epoch: 3 cost time: 0.4826631546020508
Epoch: 3, Steps: 131 | Train Loss: 0.8015339 Vali Loss: 0.2773927 Best vali loss: 0.2773927
	iters: 100, epoch: 4 | loss: 0.5485234
	speed: 0.0063s/iter; left time: 3.4885s
Updating learning rate to 2.93102997625e-05
Validation loss decreased (0.2774 --> 0.2771).  Saving model state dict ...
Epoch: 4 cost time: 0.494905948638916
Epoch: 4, Steps: 131 | Train Loss: 0.5485234 Vali Loss: 0.2771099 Best vali loss: 0.2771099
	iters: 100, epoch: 5 | loss: 0.6325514
	speed: 0.0067s/iter; left time: 2.8596s
Updating learning rate to 1.465514988125e-05
Validation loss decreased (0.2771 --> 0.2766).  Saving model state dict ...
Epoch: 5 cost time: 0.5462756156921387
Epoch: 5, Steps: 131 | Train Loss: 0.6325514 Vali Loss: 0.2765712 Best vali loss: 0.2765712
	iters: 100, epoch: 6 | loss: 0.5004907
	speed: 0.0068s/iter; left time: 1.9921s
Updating learning rate to 7.327574940625e-06
Validation loss decreased (0.2766 --> 0.2763).  Saving model state dict ...
Epoch: 6 cost time: 0.5500349998474121
Epoch: 6, Steps: 131 | Train Loss: 0.5004907 Vali Loss: 0.2763088 Best vali loss: 0.2763088
	iters: 100, epoch: 7 | loss: 0.4481231
	speed: 0.0064s/iter; left time: 1.0483s
Updating learning rate to 3.6637874703125e-06
Validation loss decreased (0.2763 --> 0.2761).  Saving model state dict ...
Epoch: 7 cost time: 0.5024716854095459
Epoch: 7, Steps: 131 | Train Loss: 0.4481231 Vali Loss: 0.2760726 Best vali loss: 0.2760726
	iters: 100, epoch: 8 | loss: 0.3901329
	speed: 0.0066s/iter; left time: 0.2120s
Updating learning rate to 1.83189373515625e-06
Validation loss decreased (0.2761 --> 0.2761).  Saving model state dict ...
Epoch: 8 cost time: 0.5207376480102539
Epoch: 8, Steps: 131 | Train Loss: 0.3901329 Vali Loss: 0.2760575 Best vali loss: 0.2760575

best validation loss 0.2760575135851846

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022338020823, 'e_layers': 2, 'learning_rate': 0.0044672732498, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3422748
	speed: 0.0088s/iter; left time: 17.5871s
	iters: 200, epoch: 1 | loss: 0.7597843
	speed: 0.0036s/iter; left time: 6.8095s
Updating learning rate to 0.0044672732498
Validation loss decreased (inf --> 0.3221).  Saving model state dict ...
Epoch: 1 cost time: 1.195753574371338
Epoch: 1, Steps: 262 | Train Loss: 0.5510295 Vali Loss: 0.3221172 Best vali loss: 0.3221172
	iters: 100, epoch: 2 | loss: 0.7330074
	speed: 0.0080s/iter; left time: 13.9187s
	iters: 200, epoch: 2 | loss: 0.4477608
	speed: 0.0033s/iter; left time: 5.3965s
Updating learning rate to 0.0022336366249
Validation loss decreased (0.3221 --> 0.3176).  Saving model state dict ...
Epoch: 2 cost time: 0.9059329032897949
Epoch: 2, Steps: 262 | Train Loss: 0.5903841 Vali Loss: 0.3175749 Best vali loss: 0.3175749
	iters: 100, epoch: 3 | loss: 0.3944626
	speed: 0.0076s/iter; left time: 11.1598s
	iters: 200, epoch: 3 | loss: 0.7113153
	speed: 0.0033s/iter; left time: 4.4937s
Updating learning rate to 0.00111681831245
Epoch: 3 cost time: 0.9053385257720947
Epoch: 3, Steps: 262 | Train Loss: 0.5528890 Vali Loss: 0.3212380 Best vali loss: 0.3175749
	iters: 100, epoch: 4 | loss: 0.4600063
	speed: 0.0075s/iter; left time: 9.0600s
	iters: 200, epoch: 4 | loss: 0.7075288
	speed: 0.0032s/iter; left time: 3.5932s
Updating learning rate to 0.000558409156225
Validation loss decreased (0.3176 --> 0.3161).  Saving model state dict ...
Epoch: 4 cost time: 0.8807218074798584
Epoch: 4, Steps: 262 | Train Loss: 0.5837675 Vali Loss: 0.3160534 Best vali loss: 0.3160534
	iters: 100, epoch: 5 | loss: 0.4186941
	speed: 0.0077s/iter; left time: 7.3060s
	iters: 200, epoch: 5 | loss: 0.4859221
	speed: 0.0036s/iter; left time: 3.0785s
Updating learning rate to 0.0002792045781125
Epoch: 5 cost time: 0.9722208976745605
Epoch: 5, Steps: 262 | Train Loss: 0.4523081 Vali Loss: 0.3205999 Best vali loss: 0.3160534
	iters: 100, epoch: 6 | loss: 0.3836550
	speed: 0.0080s/iter; left time: 5.5037s
	iters: 200, epoch: 6 | loss: 0.9192806
	speed: 0.0032s/iter; left time: 1.8936s
Updating learning rate to 0.00013960228905625
Validation loss decreased (0.3161 --> 0.3098).  Saving model state dict ...
Epoch: 6 cost time: 0.9124817848205566
Epoch: 6, Steps: 262 | Train Loss: 0.6514678 Vali Loss: 0.3098304 Best vali loss: 0.3098304
	iters: 100, epoch: 7 | loss: 0.3692184
	speed: 0.0074s/iter; left time: 3.1256s
	iters: 200, epoch: 7 | loss: 0.4541591
	speed: 0.0032s/iter; left time: 1.0285s
Updating learning rate to 6.9801144528125e-05
Epoch: 7 cost time: 0.8692610263824463
Epoch: 7, Steps: 262 | Train Loss: 0.4116887 Vali Loss: 0.3131119 Best vali loss: 0.3098304
	iters: 100, epoch: 8 | loss: 0.3015614
	speed: 0.0074s/iter; left time: 1.2074s
	iters: 200, epoch: 8 | loss: 0.5221285
	speed: 0.0033s/iter; left time: 0.2048s
Updating learning rate to 3.49005722640625e-05
Epoch: 8 cost time: 0.8876605033874512
Epoch: 8, Steps: 262 | Train Loss: 0.4118450 Vali Loss: 0.3137584 Best vali loss: 0.3098304

best validation loss 0.3098304371445451

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267350887, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597044
	speed: 0.0103s/iter; left time: 9.7320s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9170176982879639
Epoch: 1, Steps: 131 | Train Loss: 0.5597044 Vali Loss: 0.2756345 Best vali loss: 0.2756345
	iters: 100, epoch: 2 | loss: 0.3242216
	speed: 0.0088s/iter; left time: 7.2156s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2714).  Saving model state dict ...
Epoch: 2 cost time: 0.6974542140960693
Epoch: 2, Steps: 131 | Train Loss: 0.3242216 Vali Loss: 0.2713818 Best vali loss: 0.2713818
	iters: 100, epoch: 3 | loss: 0.4649405
	speed: 0.0089s/iter; left time: 6.1190s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.6990926265716553
Epoch: 3, Steps: 131 | Train Loss: 0.4649405 Vali Loss: 0.2791822 Best vali loss: 0.2713818

best validation loss 0.2713818160873135

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010338120658, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596798
	speed: 0.0106s/iter; left time: 10.0323s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9293558597564697
Epoch: 1, Steps: 131 | Train Loss: 0.5596798 Vali Loss: 0.2756404 Best vali loss: 0.2756404
	iters: 100, epoch: 2 | loss: 0.3249873
	speed: 0.0089s/iter; left time: 7.2981s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2756 --> 0.2732).  Saving model state dict ...
Epoch: 2 cost time: 0.70310378074646
Epoch: 2, Steps: 131 | Train Loss: 0.3249873 Vali Loss: 0.2731587 Best vali loss: 0.2731587
	iters: 100, epoch: 3 | loss: 0.4643253
	speed: 0.0089s/iter; left time: 6.1153s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.6992912292480469
Epoch: 3, Steps: 131 | Train Loss: 0.4643253 Vali Loss: 0.2777767 Best vali loss: 0.2731587

best validation loss 0.2731587159540539

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010574346805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597333
	speed: 0.0106s/iter; left time: 10.0515s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9334545135498047
Epoch: 1, Steps: 131 | Train Loss: 0.5597333 Vali Loss: 0.2756409 Best vali loss: 0.2756409
	iters: 100, epoch: 2 | loss: 0.3248191
	speed: 0.0087s/iter; left time: 7.1480s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2756 --> 0.2741).  Saving model state dict ...
Epoch: 2 cost time: 0.6922786235809326
Epoch: 2, Steps: 131 | Train Loss: 0.3248191 Vali Loss: 0.2741293 Best vali loss: 0.2741293
	iters: 100, epoch: 3 | loss: 0.4623029
	speed: 0.0091s/iter; left time: 6.2258s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.6995291709899902
Epoch: 3, Steps: 131 | Train Loss: 0.4623029 Vali Loss: 0.2764351 Best vali loss: 0.2741293

best validation loss 0.2741293177235831

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267350887, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4232879
	speed: 0.0108s/iter; left time: 6.0012s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9394326210021973
Epoch: 4, Steps: 131 | Train Loss: 0.4232879 Vali Loss: 0.2982142 Best vali loss: 0.2713818
	iters: 100, epoch: 5 | loss: 0.2838634
	speed: 0.0087s/iter; left time: 3.6981s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.699843168258667
Epoch: 5, Steps: 131 | Train Loss: 0.2838634 Vali Loss: 0.2990495 Best vali loss: 0.2713818
	iters: 100, epoch: 6 | loss: 0.4321077
	speed: 0.0086s/iter; left time: 2.5195s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6895558834075928
Epoch: 6, Steps: 131 | Train Loss: 0.4321077 Vali Loss: 0.3009854 Best vali loss: 0.2713818
	iters: 100, epoch: 7 | loss: 0.4622071
	speed: 0.0086s/iter; left time: 1.4096s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6987202167510986
Epoch: 7, Steps: 131 | Train Loss: 0.4622071 Vali Loss: 0.3002355 Best vali loss: 0.2713818
	iters: 100, epoch: 8 | loss: 0.3259107
	speed: 0.0086s/iter; left time: 0.2747s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.702568769454956
Epoch: 8, Steps: 131 | Train Loss: 0.3259107 Vali Loss: 0.3006300 Best vali loss: 0.2713818

best validation loss 0.2713818160873135

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0092655280455, 'e_layers': 2, 'learning_rate': 0.0002468869287, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002374903544852517
Validation loss decreased (inf --> 0.2775).  Saving model state dict ...
Epoch: 1 cost time: 0.7855188846588135
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2775422 Best vali loss: 0.2775422
Updating learning rate to 0.00021073117508504485
Epoch: 2 cost time: 0.5549423694610596
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2813317 Best vali loss: 0.2775422
Updating learning rate to 0.0001706832329904956
Epoch: 3 cost time: 0.5514214038848877
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2937934 Best vali loss: 0.2775422
Updating learning rate to 0.00012344346435
Epoch: 4 cost time: 0.5523056983947754
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2809564 Best vali loss: 0.2775422
Updating learning rate to 7.620369570950441e-05
Epoch: 5 cost time: 0.5547668933868408
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2940456 Best vali loss: 0.2775422
Updating learning rate to 3.615575361495518e-05
Epoch: 6 cost time: 0.5605964660644531
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2891482 Best vali loss: 0.2775422
Updating learning rate to 9.39657421474831e-06
Epoch: 7 cost time: 0.5566296577453613
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2860261 Best vali loss: 0.2775422
Updating learning rate to 0.0
Epoch: 8 cost time: 0.554957389831543
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2914300 Best vali loss: 0.2775422

best validation loss 0.27754220650204053

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0091100274837, 'e_layers': 2, 'learning_rate': 0.0002469033223, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00023750612414100375
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 0.7960836887359619
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2854879 Best vali loss: 0.2854879
Updating learning rate to 0.00021074516789790882
Validation loss decreased (0.2855 --> 0.2749).  Saving model state dict ...
Epoch: 2 cost time: 0.570345401763916
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2748750 Best vali loss: 0.2748750
Updating learning rate to 0.000170694566570054
Epoch: 3 cost time: 0.5713157653808594
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2897046 Best vali loss: 0.2748750
Updating learning rate to 0.00012345166115
Epoch: 4 cost time: 0.5700771808624268
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2829048 Best vali loss: 0.2748750
Updating learning rate to 7.620875572994599e-05
Epoch: 5 cost time: 0.5665702819824219
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2827052 Best vali loss: 0.2748750
Updating learning rate to 3.6158154402091144e-05
Epoch: 6 cost time: 0.5667543411254883
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2805778 Best vali loss: 0.2748750
Updating learning rate to 9.39719815899622e-06
Epoch: 7 cost time: 0.5686702728271484
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2827134 Best vali loss: 0.2748750
Updating learning rate to 0.0
Epoch: 8 cost time: 0.562809944152832
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2829901 Best vali loss: 0.2748750

best validation loss 0.2748750457592106

[INFO][smbo.py:320] Finished 600 trials.
{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0094866322316, 'e_layers': 2, 'learning_rate': 0.0002627457932, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002527456268954616
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 0.8221821784973145
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2779113 Best vali loss: 0.2779113
Updating learning rate to 0.0002242675626499791
Epoch: 2 cost time: 0.5961711406707764
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2818551 Best vali loss: 0.2779113
Updating learning rate to 0.00018164712759063202
Epoch: 3 cost time: 0.5933945178985596
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2834027 Best vali loss: 0.2779113

best validation loss 0.27791134753205954

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0084908053457, 'e_layers': 2, 'learning_rate': 0.000249079347, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023959932883228828
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 0.8176076412200928
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2776485 Best vali loss: 0.2776485
Updating learning rate to 0.00021260252115860856
Epoch: 2 cost time: 0.5968234539031982
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2803887 Best vali loss: 0.2776485
Updating learning rate to 0.0001721989432206076
Epoch: 3 cost time: 0.5989654064178467
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2845370 Best vali loss: 0.2776485

best validation loss 0.27764847981038704

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0010527217651, 'e_layers': 2, 'learning_rate': 0.0001748674569, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001682119606161048
Validation loss decreased (inf --> 0.3316).  Saving model state dict ...
Epoch: 1 cost time: 0.5495562553405762
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3316200 Best vali loss: 0.3316200
Updating learning rate to 0.00014925871074141815
Validation loss decreased (0.3316 --> 0.3138).  Saving model state dict ...
Epoch: 2 cost time: 0.3252847194671631
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3137823 Best vali loss: 0.3137823
Updating learning rate to 0.00012089316775772321
Validation loss decreased (0.3138 --> 0.3063).  Saving model state dict ...
Epoch: 3 cost time: 0.3231539726257324
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3062960 Best vali loss: 0.3062960

best validation loss 0.3062960419259403

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0084908053457, 'e_layers': 2, 'learning_rate': 0.000249079347, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001245396735
Epoch: 4 cost time: 0.8388779163360596
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2864078 Best vali loss: 0.2776485
Updating learning rate to 7.688040377939239e-05
Epoch: 5 cost time: 0.5888772010803223
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2798745 Best vali loss: 0.2776485
Updating learning rate to 3.6476825841391435e-05
Epoch: 6 cost time: 0.5886566638946533
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2811204 Best vali loss: 0.2776485
Updating learning rate to 9.480018167711714e-06
Epoch: 7 cost time: 0.5901539325714111
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2813846 Best vali loss: 0.2776485
Updating learning rate to 0.0
Epoch: 8 cost time: 0.590054988861084
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2832658 Best vali loss: 0.2776485

best validation loss 0.27764847981038704

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0082161144836, 'e_layers': 4, 'learning_rate': 0.0006375419833, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5943439
	speed: 0.0105s/iter; left time: 9.9513s
Updating learning rate to 0.0006375419833
Validation loss decreased (inf --> 0.2915).  Saving model state dict ...
Epoch: 1 cost time: 0.9525294303894043
Epoch: 1, Steps: 131 | Train Loss: 0.5943439 Vali Loss: 0.2915016 Best vali loss: 0.2915016
	iters: 100, epoch: 2 | loss: 0.3219308
	speed: 0.0086s/iter; left time: 7.0620s
Updating learning rate to 0.00031877099165
Validation loss decreased (0.2915 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 0.6934823989868164
Epoch: 2, Steps: 131 | Train Loss: 0.3219308 Vali Loss: 0.2842938 Best vali loss: 0.2842938
	iters: 100, epoch: 3 | loss: 0.6264948
	speed: 0.0090s/iter; left time: 6.2049s
Updating learning rate to 0.000159385495825
Epoch: 3 cost time: 0.7710177898406982
Epoch: 3, Steps: 131 | Train Loss: 0.6264948 Vali Loss: 0.2863336 Best vali loss: 0.2842938
	iters: 100, epoch: 4 | loss: 0.4532502
	speed: 0.0087s/iter; left time: 4.8518s
Updating learning rate to 7.96927479125e-05
Epoch: 4 cost time: 0.7075014114379883
Epoch: 4, Steps: 131 | Train Loss: 0.4532502 Vali Loss: 0.2851117 Best vali loss: 0.2842938
	iters: 100, epoch: 5 | loss: 0.4543368
	speed: 0.0084s/iter; left time: 3.5584s
Updating learning rate to 3.984637395625e-05
Epoch: 5 cost time: 0.6916627883911133
Epoch: 5, Steps: 131 | Train Loss: 0.4543368 Vali Loss: 0.2856519 Best vali loss: 0.2842938
	iters: 100, epoch: 6 | loss: 0.3170831
	speed: 0.0084s/iter; left time: 2.4660s
Updating learning rate to 1.9923186978125e-05
Epoch: 6 cost time: 0.6979396343231201
Epoch: 6, Steps: 131 | Train Loss: 0.3170831 Vali Loss: 0.2861415 Best vali loss: 0.2842938
	iters: 100, epoch: 7 | loss: 0.5077584
	speed: 0.0085s/iter; left time: 1.3822s
Updating learning rate to 9.9615934890625e-06
Epoch: 7 cost time: 0.7046215534210205
Epoch: 7, Steps: 131 | Train Loss: 0.5077584 Vali Loss: 0.2864407 Best vali loss: 0.2842938
	iters: 100, epoch: 8 | loss: 0.5907435
	speed: 0.0082s/iter; left time: 0.2634s
Updating learning rate to 4.98079674453125e-06
Epoch: 8 cost time: 0.6787805557250977
Epoch: 8, Steps: 131 | Train Loss: 0.5907435 Vali Loss: 0.2865112 Best vali loss: 0.2842938

best validation loss 0.28429382468143244

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0033446530995, 'e_layers': 1, 'learning_rate': 0.0002513691056, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5094745
	speed: 0.0080s/iter; left time: 15.9044s
	iters: 200, epoch: 1 | loss: 0.3094606
	speed: 0.0026s/iter; left time: 5.0021s
Updating learning rate to 0.0002513691056
Validation loss decreased (inf --> 0.3018).  Saving model state dict ...
Epoch: 1 cost time: 0.9599840641021729
Epoch: 1, Steps: 262 | Train Loss: 0.4094675 Vali Loss: 0.3018196 Best vali loss: 0.3018196
	iters: 100, epoch: 2 | loss: 0.5247159
	speed: 0.0063s/iter; left time: 10.8902s
	iters: 200, epoch: 2 | loss: 0.5192605
	speed: 0.0025s/iter; left time: 4.0663s
Updating learning rate to 0.0001256845528
Validation loss decreased (0.3018 --> 0.2869).  Saving model state dict ...
Epoch: 2 cost time: 0.6842398643493652
Epoch: 2, Steps: 262 | Train Loss: 0.5219882 Vali Loss: 0.2869411 Best vali loss: 0.2869411
	iters: 100, epoch: 3 | loss: 0.6595877
	speed: 0.0062s/iter; left time: 9.1187s
	iters: 200, epoch: 3 | loss: 0.6389571
	speed: 0.0026s/iter; left time: 3.5334s
Updating learning rate to 6.28422764e-05
Validation loss decreased (0.2869 --> 0.2837).  Saving model state dict ...
Epoch: 3 cost time: 0.7085237503051758
Epoch: 3, Steps: 262 | Train Loss: 0.6492724 Vali Loss: 0.2837367 Best vali loss: 0.2837367
	iters: 100, epoch: 4 | loss: 0.6518323
	speed: 0.0059s/iter; left time: 7.2005s
	iters: 200, epoch: 4 | loss: 0.8256080
	speed: 0.0025s/iter; left time: 2.7411s
Updating learning rate to 3.14211382e-05
Validation loss decreased (0.2837 --> 0.2827).  Saving model state dict ...
Epoch: 4 cost time: 0.6717188358306885
Epoch: 4, Steps: 262 | Train Loss: 0.7387202 Vali Loss: 0.2826772 Best vali loss: 0.2826772
	iters: 100, epoch: 5 | loss: 0.4211077
	speed: 0.0061s/iter; left time: 5.7852s
	iters: 200, epoch: 5 | loss: 0.5508000
	speed: 0.0026s/iter; left time: 2.1720s
Updating learning rate to 1.57105691e-05
Validation loss decreased (0.2827 --> 0.2822).  Saving model state dict ...
Epoch: 5 cost time: 0.691770076751709
Epoch: 5, Steps: 262 | Train Loss: 0.4859538 Vali Loss: 0.2822379 Best vali loss: 0.2822379
	iters: 100, epoch: 6 | loss: 0.3682207
	speed: 0.0060s/iter; left time: 4.1503s
	iters: 200, epoch: 6 | loss: 0.3691153
	speed: 0.0024s/iter; left time: 1.3901s
Updating learning rate to 7.85528455e-06
Validation loss decreased (0.2822 --> 0.2821).  Saving model state dict ...
Epoch: 6 cost time: 0.6774015426635742
Epoch: 6, Steps: 262 | Train Loss: 0.3686680 Vali Loss: 0.2820937 Best vali loss: 0.2820937
	iters: 100, epoch: 7 | loss: 0.2460286
	speed: 0.0060s/iter; left time: 2.5600s
	iters: 200, epoch: 7 | loss: 0.7211033
	speed: 0.0025s/iter; left time: 0.8128s
Updating learning rate to 3.927642275e-06
Validation loss decreased (0.2821 --> 0.2820).  Saving model state dict ...
Epoch: 7 cost time: 0.6905097961425781
Epoch: 7, Steps: 262 | Train Loss: 0.4835660 Vali Loss: 0.2820029 Best vali loss: 0.2820029
	iters: 100, epoch: 8 | loss: 0.6406626
	speed: 0.0062s/iter; left time: 1.0060s
	iters: 200, epoch: 8 | loss: 0.5939074
	speed: 0.0024s/iter; left time: 0.1538s
Updating learning rate to 1.9638211375e-06
Validation loss decreased (0.2820 --> 0.2820).  Saving model state dict ...
Epoch: 8 cost time: 0.6900753974914551
Epoch: 8, Steps: 262 | Train Loss: 0.6172850 Vali Loss: 0.2819626 Best vali loss: 0.2819626

best validation loss 0.2819625575326774

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002345436852, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597211
	speed: 0.0105s/iter; left time: 9.9325s
Updating learning rate to 0.0002345436852
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9433214664459229
Epoch: 1, Steps: 131 | Train Loss: 0.5597211 Vali Loss: 0.2756334 Best vali loss: 0.2756334
	iters: 100, epoch: 2 | loss: 0.3247230
	speed: 0.0088s/iter; left time: 7.2215s
Updating learning rate to 0.0001172718426
Validation loss decreased (0.2756 --> 0.2685).  Saving model state dict ...
Epoch: 2 cost time: 0.7009010314941406
Epoch: 2, Steps: 131 | Train Loss: 0.3247230 Vali Loss: 0.2685058 Best vali loss: 0.2685058
	iters: 100, epoch: 3 | loss: 0.4615740
	speed: 0.0090s/iter; left time: 6.1638s
Updating learning rate to 5.86359213e-05
Epoch: 3 cost time: 0.7016804218292236
Epoch: 3, Steps: 131 | Train Loss: 0.4615740 Vali Loss: 0.2799071 Best vali loss: 0.2685058

best validation loss 0.26850581705548054

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017874325304, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5595547
	speed: 0.0103s/iter; left time: 9.7503s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9194703102111816
Epoch: 1, Steps: 131 | Train Loss: 0.5595547 Vali Loss: 0.2756685 Best vali loss: 0.2756685
	iters: 100, epoch: 2 | loss: 0.3262138
	speed: 0.0090s/iter; left time: 7.3885s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2757 --> 0.2741).  Saving model state dict ...
Epoch: 2 cost time: 0.7067594528198242
Epoch: 2, Steps: 131 | Train Loss: 0.3262138 Vali Loss: 0.2741385 Best vali loss: 0.2741385
	iters: 100, epoch: 3 | loss: 0.4614669
	speed: 0.0090s/iter; left time: 6.2103s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.7029790878295898
Epoch: 3, Steps: 131 | Train Loss: 0.4614669 Vali Loss: 0.2777731 Best vali loss: 0.2741385

best validation loss 0.27413850029679027

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.003701388908, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5598534
	speed: 0.0104s/iter; left time: 9.8587s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.925983190536499
Epoch: 1, Steps: 131 | Train Loss: 0.5598534 Vali Loss: 0.2756570 Best vali loss: 0.2756570
	iters: 100, epoch: 2 | loss: 0.3267060
	speed: 0.0089s/iter; left time: 7.2477s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2757 --> 0.2726).  Saving model state dict ...
Epoch: 2 cost time: 0.7028982639312744
Epoch: 2, Steps: 131 | Train Loss: 0.3267060 Vali Loss: 0.2725754 Best vali loss: 0.2725754
	iters: 100, epoch: 3 | loss: 0.4654750
	speed: 0.0088s/iter; left time: 6.0672s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.6938092708587646
Epoch: 3, Steps: 131 | Train Loss: 0.4654750 Vali Loss: 0.2851975 Best vali loss: 0.2725754

best validation loss 0.27257542953299696

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002345436852, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4205623
	speed: 0.0107s/iter; left time: 5.9522s
Updating learning rate to 2.931796065e-05
Epoch: 4 cost time: 0.9273531436920166
Epoch: 4, Steps: 131 | Train Loss: 0.4205623 Vali Loss: 0.3091167 Best vali loss: 0.2685058
	iters: 100, epoch: 5 | loss: 0.2812589
	speed: 0.0087s/iter; left time: 3.6849s
Updating learning rate to 1.4658980325e-05
Epoch: 5 cost time: 0.698958158493042
Epoch: 5, Steps: 131 | Train Loss: 0.2812589 Vali Loss: 0.2931725 Best vali loss: 0.2685058
	iters: 100, epoch: 6 | loss: 0.4346253
	speed: 0.0087s/iter; left time: 2.5468s
Updating learning rate to 7.3294901625e-06
Epoch: 6 cost time: 0.7036910057067871
Epoch: 6, Steps: 131 | Train Loss: 0.4346253 Vali Loss: 0.3016728 Best vali loss: 0.2685058
	iters: 100, epoch: 7 | loss: 0.4645765
	speed: 0.0086s/iter; left time: 1.4018s
Updating learning rate to 3.66474508125e-06
Epoch: 7 cost time: 0.6990048885345459
Epoch: 7, Steps: 131 | Train Loss: 0.4645765 Vali Loss: 0.2994955 Best vali loss: 0.2685058
	iters: 100, epoch: 8 | loss: 0.3248147
	speed: 0.0086s/iter; left time: 0.2748s
Updating learning rate to 1.832372540625e-06
Epoch: 8 cost time: 0.6962540149688721
Epoch: 8, Steps: 131 | Train Loss: 0.3248147 Vali Loss: 0.2959390 Best vali loss: 0.2685058

best validation loss 0.26850581705548054

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024564374578, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5598436
	speed: 0.0104s/iter; left time: 9.8538s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.935467004776001
Epoch: 1, Steps: 131 | Train Loss: 0.5598436 Vali Loss: 0.2756852 Best vali loss: 0.2756852
	iters: 100, epoch: 2 | loss: 0.3280282
	speed: 0.0089s/iter; left time: 7.3164s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 0.6990044116973877
Epoch: 2, Steps: 131 | Train Loss: 0.3280282 Vali Loss: 0.2741809 Best vali loss: 0.2741809
	iters: 100, epoch: 3 | loss: 0.4657441
	speed: 0.0090s/iter; left time: 6.1545s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7043366432189941
Epoch: 3, Steps: 131 | Train Loss: 0.4657441 Vali Loss: 0.2931334 Best vali loss: 0.2741809
	iters: 100, epoch: 4 | loss: 0.5021537
	speed: 0.0086s/iter; left time: 4.7760s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7006244659423828
Epoch: 4, Steps: 131 | Train Loss: 0.5021537 Vali Loss: 0.2955400 Best vali loss: 0.2741809
	iters: 100, epoch: 5 | loss: 0.3328853
	speed: 0.0087s/iter; left time: 3.6809s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7035908699035645
Epoch: 5, Steps: 131 | Train Loss: 0.3328853 Vali Loss: 0.2985818 Best vali loss: 0.2741809
	iters: 100, epoch: 6 | loss: 0.3200606
	speed: 0.0087s/iter; left time: 2.5687s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6984395980834961
Epoch: 6, Steps: 131 | Train Loss: 0.3200606 Vali Loss: 0.2956521 Best vali loss: 0.2741809
	iters: 100, epoch: 7 | loss: 0.3137453
	speed: 0.0087s/iter; left time: 1.4126s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.704695463180542
Epoch: 7, Steps: 131 | Train Loss: 0.3137453 Vali Loss: 0.3042316 Best vali loss: 0.2741809
	iters: 100, epoch: 8 | loss: 0.3972515
	speed: 0.0086s/iter; left time: 0.2766s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6993751525878906
Epoch: 8, Steps: 131 | Train Loss: 0.3972515 Vali Loss: 0.3047484 Best vali loss: 0.2741809

best validation loss 0.2741809405106601

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002343811396, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596656
	speed: 0.0103s/iter; left time: 9.7971s
Updating learning rate to 0.00022546053864155532
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9300177097320557
Epoch: 1, Steps: 131 | Train Loss: 0.5596656 Vali Loss: 0.2756422 Best vali loss: 0.2756422
	iters: 100, epoch: 2 | loss: 0.3236215
	speed: 0.0089s/iter; left time: 7.3089s
Updating learning rate to 0.00020005681639669541
Validation loss decreased (0.2756 --> 0.2691).  Saving model state dict ...
Epoch: 2 cost time: 0.7020289897918701
Epoch: 2, Steps: 131 | Train Loss: 0.3236215 Vali Loss: 0.2690845 Best vali loss: 0.2690845
	iters: 100, epoch: 3 | loss: 0.4651029
	speed: 0.0092s/iter; left time: 6.2950s
Updating learning rate to 0.00016203745929188463
Epoch: 3 cost time: 0.7047567367553711
Epoch: 3, Steps: 131 | Train Loss: 0.4651029 Vali Loss: 0.2819394 Best vali loss: 0.2690845
	iters: 100, epoch: 4 | loss: 0.4796658
	speed: 0.0086s/iter; left time: 4.7580s
Updating learning rate to 0.0001171905698
Epoch: 4 cost time: 0.6950852870941162
Epoch: 4, Steps: 131 | Train Loss: 0.4796658 Vali Loss: 0.2799864 Best vali loss: 0.2690845
	iters: 100, epoch: 5 | loss: 0.3355630
	speed: 0.0087s/iter; left time: 3.6814s
Updating learning rate to 7.234368030811537e-05
Epoch: 5 cost time: 0.705744743347168
Epoch: 5, Steps: 131 | Train Loss: 0.3355630 Vali Loss: 0.2872821 Best vali loss: 0.2690845
	iters: 100, epoch: 6 | loss: 0.3034881
	speed: 0.0087s/iter; left time: 2.5568s
Updating learning rate to 3.432432320330458e-05
Epoch: 6 cost time: 0.7030014991760254
Epoch: 6, Steps: 131 | Train Loss: 0.3034881 Vali Loss: 0.2847512 Best vali loss: 0.2690845
	iters: 100, epoch: 7 | loss: 0.2852349
	speed: 0.0087s/iter; left time: 1.4254s
Updating learning rate to 8.920600958444682e-06
Epoch: 7 cost time: 0.7063071727752686
Epoch: 7, Steps: 131 | Train Loss: 0.2852349 Vali Loss: 0.2917064 Best vali loss: 0.2690845
	iters: 100, epoch: 8 | loss: 0.3444910
	speed: 0.0087s/iter; left time: 0.2773s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7055263519287109
Epoch: 8, Steps: 131 | Train Loss: 0.3444910 Vali Loss: 0.2925186 Best vali loss: 0.2690845

best validation loss 0.26908454614840016

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021253518718, 'e_layers': 2, 'learning_rate': 0.0002374688659, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7641537
	speed: 0.0086s/iter; left time: 35.2774s
	iters: 200, epoch: 1 | loss: 0.4922898
	speed: 0.0033s/iter; left time: 13.2390s
	iters: 300, epoch: 1 | loss: 0.7026092
	speed: 0.0033s/iter; left time: 12.8438s
	iters: 400, epoch: 1 | loss: 0.6670389
	speed: 0.0033s/iter; left time: 12.4495s
	iters: 500, epoch: 1 | loss: 0.4701622
	speed: 0.0033s/iter; left time: 12.0887s
Updating learning rate to 0.0002284307453568387
Validation loss decreased (inf --> 0.2990).  Saving model state dict ...
Epoch: 1 cost time: 1.9836547374725342
Epoch: 1, Steps: 523 | Train Loss: 0.6192507 Vali Loss: 0.2989899 Best vali loss: 0.2989899
	iters: 100, epoch: 2 | loss: 0.3575124
	speed: 0.0080s/iter; left time: 28.5746s
	iters: 200, epoch: 2 | loss: 0.6680101
	speed: 0.0035s/iter; left time: 12.0983s
	iters: 300, epoch: 2 | loss: 0.2641821
	speed: 0.0036s/iter; left time: 12.0132s
	iters: 400, epoch: 2 | loss: 0.2995141
	speed: 0.0036s/iter; left time: 11.6136s
	iters: 500, epoch: 2 | loss: 0.4817112
	speed: 0.0036s/iter; left time: 11.3960s
Updating learning rate to 0.00020269235564928444
Validation loss decreased (0.2990 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 1.8967998027801514
Epoch: 2, Steps: 523 | Train Loss: 0.4141860 Vali Loss: 0.2808628 Best vali loss: 0.2808628
	iters: 100, epoch: 3 | loss: 0.4332226
	speed: 0.0080s/iter; left time: 24.3688s
	iters: 200, epoch: 3 | loss: 0.3735861
	speed: 0.0035s/iter; left time: 10.3007s
	iters: 300, epoch: 3 | loss: 0.2104875
	speed: 0.0035s/iter; left time: 9.8675s
	iters: 400, epoch: 3 | loss: 0.6700555
	speed: 0.0035s/iter; left time: 9.4966s
	iters: 500, epoch: 3 | loss: 0.3868179
	speed: 0.0035s/iter; left time: 9.1758s
Updating learning rate to 0.0001641721332912286
Epoch: 3 cost time: 1.8607680797576904
Epoch: 3, Steps: 523 | Train Loss: 0.4148339 Vali Loss: 0.3075163 Best vali loss: 0.2808628

best validation loss 0.280862848713922

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013541182315, 'e_layers': 4, 'learning_rate': 0.000294370569, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0720674
	speed: 0.0103s/iter; left time: 42.0587s
	iters: 200, epoch: 1 | loss: 0.3382562
	speed: 0.0050s/iter; left time: 19.9796s
	iters: 300, epoch: 1 | loss: 0.2627592
	speed: 0.0050s/iter; left time: 19.5733s
	iters: 400, epoch: 1 | loss: 0.4209776
	speed: 0.0048s/iter; left time: 18.2274s
	iters: 500, epoch: 1 | loss: 0.3836909
	speed: 0.0048s/iter; left time: 17.8325s
Updating learning rate to 0.00028316675633640074
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 2.8381218910217285
Epoch: 1, Steps: 523 | Train Loss: 0.4955503 Vali Loss: 0.2874800 Best vali loss: 0.2874800
	iters: 100, epoch: 2 | loss: 0.4259721
	speed: 0.0095s/iter; left time: 33.6809s
	iters: 200, epoch: 2 | loss: 0.3971063
	speed: 0.0045s/iter; left time: 15.4991s
	iters: 300, epoch: 2 | loss: 0.2859921
	speed: 0.0045s/iter; left time: 15.0838s
	iters: 400, epoch: 2 | loss: 0.3900455
	speed: 0.0044s/iter; left time: 14.4167s
	iters: 500, epoch: 2 | loss: 0.4367085
	speed: 0.0044s/iter; left time: 14.0225s
Updating learning rate to 0.00025126099726082124
Validation loss decreased (0.2875 --> 0.2847).  Saving model state dict ...
Epoch: 2 cost time: 2.3674252033233643
Epoch: 2, Steps: 523 | Train Loss: 0.3871649 Vali Loss: 0.2846925 Best vali loss: 0.2846925
	iters: 100, epoch: 3 | loss: 0.3344941
	speed: 0.0099s/iter; left time: 30.0658s
	iters: 200, epoch: 3 | loss: 0.4839491
	speed: 0.0053s/iter; left time: 15.4939s
	iters: 300, epoch: 3 | loss: 0.3200327
	speed: 0.0052s/iter; left time: 14.8018s
	iters: 400, epoch: 3 | loss: 0.3306750
	speed: 0.0052s/iter; left time: 14.3559s
	iters: 500, epoch: 3 | loss: 0.3535103
	speed: 0.0052s/iter; left time: 13.6249s
Updating learning rate to 0.00020351065436609227
Epoch: 3 cost time: 2.762303590774536
Epoch: 3, Steps: 523 | Train Loss: 0.3645322 Vali Loss: 0.2886919 Best vali loss: 0.2846925

best validation loss 0.2846924743995032

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0012094223518, 'e_layers': 3, 'learning_rate': 0.0014479029813, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4789562
	speed: 0.0095s/iter; left time: 39.0099s
	iters: 200, epoch: 1 | loss: 0.2498733
	speed: 0.0043s/iter; left time: 17.0194s
	iters: 300, epoch: 1 | loss: 0.7589673
	speed: 0.0043s/iter; left time: 16.5839s
	iters: 400, epoch: 1 | loss: 0.6026551
	speed: 0.0043s/iter; left time: 16.3025s
	iters: 500, epoch: 1 | loss: 1.3590518
	speed: 0.0043s/iter; left time: 15.7761s
Updating learning rate to 0.0014479029813
Validation loss decreased (inf --> 0.3350).  Saving model state dict ...
Epoch: 1 cost time: 2.498732805252075
Epoch: 1, Steps: 523 | Train Loss: 0.8899007 Vali Loss: 0.3350324 Best vali loss: 0.3350324
	iters: 100, epoch: 2 | loss: 0.5018590
	speed: 0.0087s/iter; left time: 31.0268s
	iters: 200, epoch: 2 | loss: 0.5815237
	speed: 0.0040s/iter; left time: 13.8130s
	iters: 300, epoch: 2 | loss: 0.5154066
	speed: 0.0040s/iter; left time: 13.4859s
	iters: 400, epoch: 2 | loss: 0.5565153
	speed: 0.0040s/iter; left time: 13.0459s
	iters: 500, epoch: 2 | loss: 0.3644401
	speed: 0.0040s/iter; left time: 12.7065s
Updating learning rate to 0.00072395149065
Validation loss decreased (0.3350 --> 0.3206).  Saving model state dict ...
Epoch: 2 cost time: 2.1432809829711914
Epoch: 2, Steps: 523 | Train Loss: 0.5039489 Vali Loss: 0.3205545 Best vali loss: 0.3205545
	iters: 100, epoch: 3 | loss: 0.2965362
	speed: 0.0087s/iter; left time: 26.4734s
	iters: 200, epoch: 3 | loss: 0.6011590
	speed: 0.0038s/iter; left time: 11.0938s
	iters: 300, epoch: 3 | loss: 0.6123607
	speed: 0.0040s/iter; left time: 11.2928s
	iters: 400, epoch: 3 | loss: 0.8449653
	speed: 0.0043s/iter; left time: 11.7147s
	iters: 500, epoch: 3 | loss: 0.5688315
	speed: 0.0043s/iter; left time: 11.3601s
Updating learning rate to 0.000361975745325
Epoch: 3 cost time: 2.166665554046631
Epoch: 3, Steps: 523 | Train Loss: 0.5847706 Vali Loss: 0.3248053 Best vali loss: 0.3205545

best validation loss 0.3205544880694198

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021253518718, 'e_layers': 2, 'learning_rate': 0.0002374688659, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3674147
	speed: 0.0093s/iter; left time: 23.4936s
	iters: 200, epoch: 4 | loss: 0.4955309
	speed: 0.0035s/iter; left time: 8.5690s
	iters: 300, epoch: 4 | loss: 0.3715374
	speed: 0.0035s/iter; left time: 8.1385s
	iters: 400, epoch: 4 | loss: 0.5617199
	speed: 0.0035s/iter; left time: 7.8145s
	iters: 500, epoch: 4 | loss: 0.3760625
	speed: 0.0035s/iter; left time: 7.4488s
Updating learning rate to 0.00011873443295
Epoch: 4 cost time: 2.1138596534729004
Epoch: 4, Steps: 523 | Train Loss: 0.4344531 Vali Loss: 0.2908889 Best vali loss: 0.2808628
	iters: 100, epoch: 5 | loss: 0.3231350
	speed: 0.0077s/iter; left time: 15.3305s
	iters: 200, epoch: 5 | loss: 0.4801831
	speed: 0.0035s/iter; left time: 6.6458s
	iters: 300, epoch: 5 | loss: 0.2263962
	speed: 0.0035s/iter; left time: 6.2947s
	iters: 400, epoch: 5 | loss: 0.2626812
	speed: 0.0035s/iter; left time: 5.9548s
	iters: 500, epoch: 5 | loss: 0.2915520
	speed: 0.0035s/iter; left time: 5.6127s
Updating learning rate to 7.329673260877139e-05
Epoch: 5 cost time: 1.8745107650756836
Epoch: 5, Steps: 523 | Train Loss: 0.3167895 Vali Loss: 0.2969491 Best vali loss: 0.2808628
	iters: 100, epoch: 6 | loss: 0.3733200
	speed: 0.0078s/iter; left time: 11.4329s
	iters: 200, epoch: 6 | loss: 0.2067231
	speed: 0.0033s/iter; left time: 4.5144s
	iters: 300, epoch: 6 | loss: 0.1887489
	speed: 0.0033s/iter; left time: 4.1989s
	iters: 400, epoch: 6 | loss: 0.3794707
	speed: 0.0033s/iter; left time: 3.8704s
	iters: 500, epoch: 6 | loss: 0.2916785
	speed: 0.0033s/iter; left time: 3.5700s
Updating learning rate to 3.4776510250715554e-05
Epoch: 6 cost time: 1.7928521633148193
Epoch: 6, Steps: 523 | Train Loss: 0.2879882 Vali Loss: 0.2956004 Best vali loss: 0.2808628
	iters: 100, epoch: 7 | loss: 0.3747280
	speed: 0.0074s/iter; left time: 6.9842s
	iters: 200, epoch: 7 | loss: 0.4037808
	speed: 0.0035s/iter; left time: 2.9972s
	iters: 300, epoch: 7 | loss: 0.4263222
	speed: 0.0033s/iter; left time: 2.5006s
	iters: 400, epoch: 7 | loss: 0.4265582
	speed: 0.0034s/iter; left time: 2.1767s
	iters: 500, epoch: 7 | loss: 0.2992274
	speed: 0.0034s/iter; left time: 1.8436s
Updating learning rate to 9.038120543161279e-06
Epoch: 7 cost time: 1.8030426502227783
Epoch: 7, Steps: 523 | Train Loss: 0.3861233 Vali Loss: 0.3077508 Best vali loss: 0.2808628
	iters: 100, epoch: 8 | loss: 0.2857998
	speed: 0.0072s/iter; left time: 3.0472s
	iters: 200, epoch: 8 | loss: 0.3872133
	speed: 0.0030s/iter; left time: 0.9822s
	iters: 300, epoch: 8 | loss: 0.2408390
	speed: 0.0030s/iter; left time: 0.6792s
	iters: 400, epoch: 8 | loss: 0.1948597
	speed: 0.0030s/iter; left time: 0.3768s
	iters: 500, epoch: 8 | loss: 0.4711782
	speed: 0.0030s/iter; left time: 0.0729s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.623617172241211
Epoch: 8, Steps: 523 | Train Loss: 0.3159780 Vali Loss: 0.3091186 Best vali loss: 0.2808628

best validation loss 0.280862848713922

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021300818404, 'e_layers': 4, 'learning_rate': 0.0020188531915, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019420151671359696
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 0.6662912368774414
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856969 Best vali loss: 0.2856969
Updating learning rate to 0.0017231989867148767
Epoch: 2 cost time: 0.4569826126098633
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2877514 Best vali loss: 0.2856969
Updating learning rate to 0.001395717430132218
Epoch: 3 cost time: 0.4484086036682129
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2906597 Best vali loss: 0.2856969
Updating learning rate to 0.00100942659575
Validation loss decreased (0.2857 --> 0.2752).  Saving model state dict ...
Epoch: 4 cost time: 0.45861315727233887
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2751592 Best vali loss: 0.2751592
Updating learning rate to 0.0006231357613677821
Validation loss decreased (0.2752 --> 0.2735).  Saving model state dict ...
Epoch: 5 cost time: 0.4434022903442383
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2735085 Best vali loss: 0.2735085
Updating learning rate to 0.0002956542047851233
Epoch: 6 cost time: 0.4358365535736084
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2757877 Best vali loss: 0.2735085
Updating learning rate to 7.683802436403038e-05
Epoch: 7 cost time: 0.4594852924346924
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2805025 Best vali loss: 0.2735085
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43758273124694824
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2801673 Best vali loss: 0.2735085

best validation loss 0.2735085085161825

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009532678819, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596097
	speed: 0.0105s/iter; left time: 9.9946s
Updating learning rate to 0.0002344823981
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9307525157928467
Epoch: 1, Steps: 131 | Train Loss: 0.5596097 Vali Loss: 0.2756423 Best vali loss: 0.2756423
	iters: 100, epoch: 2 | loss: 0.3234071
	speed: 0.0089s/iter; left time: 7.2730s
Updating learning rate to 0.00011724119905
Validation loss decreased (0.2756 --> 0.2709).  Saving model state dict ...
Epoch: 2 cost time: 0.7055928707122803
Epoch: 2, Steps: 131 | Train Loss: 0.3234071 Vali Loss: 0.2709305 Best vali loss: 0.2709305
	iters: 100, epoch: 3 | loss: 0.4584975
	speed: 0.0090s/iter; left time: 6.2144s
Updating learning rate to 5.8620599525e-05
Epoch: 3 cost time: 0.7003047466278076
Epoch: 3, Steps: 131 | Train Loss: 0.4584975 Vali Loss: 0.2766277 Best vali loss: 0.2709305
	iters: 100, epoch: 4 | loss: 0.5070525
	speed: 0.0087s/iter; left time: 4.8295s
Updating learning rate to 2.93102997625e-05
Epoch: 4 cost time: 0.7015500068664551
Epoch: 4, Steps: 131 | Train Loss: 0.5070525 Vali Loss: 0.2906212 Best vali loss: 0.2709305
	iters: 100, epoch: 5 | loss: 0.3319912
	speed: 0.0086s/iter; left time: 3.6434s
Updating learning rate to 1.465514988125e-05
Epoch: 5 cost time: 0.6956675052642822
Epoch: 5, Steps: 131 | Train Loss: 0.3319912 Vali Loss: 0.2887361 Best vali loss: 0.2709305
	iters: 100, epoch: 6 | loss: 0.3191677
	speed: 0.0086s/iter; left time: 2.5159s
Updating learning rate to 7.327574940625e-06
Epoch: 6 cost time: 0.6989521980285645
Epoch: 6, Steps: 131 | Train Loss: 0.3191677 Vali Loss: 0.2902497 Best vali loss: 0.2709305
	iters: 100, epoch: 7 | loss: 0.3104038
	speed: 0.0086s/iter; left time: 1.3968s
Updating learning rate to 3.6637874703125e-06
Epoch: 7 cost time: 0.7007710933685303
Epoch: 7, Steps: 131 | Train Loss: 0.3104038 Vali Loss: 0.2984634 Best vali loss: 0.2709305
	iters: 100, epoch: 8 | loss: 0.3981272
	speed: 0.0087s/iter; left time: 0.2780s
Updating learning rate to 1.83189373515625e-06
Epoch: 8 cost time: 0.70802903175354
Epoch: 8, Steps: 131 | Train Loss: 0.3981272 Vali Loss: 0.2973571 Best vali loss: 0.2709305

best validation loss 0.2709305182448458

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0045540781927, 'e_layers': 1, 'learning_rate': 0.0040853461618, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8403717
	speed: 0.0077s/iter; left time: 31.5325s
	iters: 200, epoch: 1 | loss: 0.4826518
	speed: 0.0026s/iter; left time: 10.2002s
	iters: 300, epoch: 1 | loss: 0.2831148
	speed: 0.0025s/iter; left time: 9.7264s
	iters: 400, epoch: 1 | loss: 0.4718874
	speed: 0.0025s/iter; left time: 9.3203s
	iters: 500, epoch: 1 | loss: 0.4794187
	speed: 0.0025s/iter; left time: 9.0813s
Updating learning rate to 0.003929856931955282
Validation loss decreased (inf --> 0.3550).  Saving model state dict ...
Epoch: 1 cost time: 1.5621216297149658
Epoch: 1, Steps: 523 | Train Loss: 0.5114889 Vali Loss: 0.3550049 Best vali loss: 0.3550049
	iters: 100, epoch: 2 | loss: 0.6536087
	speed: 0.0060s/iter; left time: 21.4119s
	iters: 200, epoch: 2 | loss: 0.3464929
	speed: 0.0026s/iter; left time: 8.9981s
	iters: 300, epoch: 2 | loss: 0.3735389
	speed: 0.0025s/iter; left time: 8.4596s
	iters: 400, epoch: 2 | loss: 0.5198613
	speed: 0.0026s/iter; left time: 8.3604s
	iters: 500, epoch: 2 | loss: 1.0900558
	speed: 0.0025s/iter; left time: 8.0004s
Updating learning rate to 0.003487061068151607
Validation loss decreased (0.3550 --> 0.3142).  Saving model state dict ...
Epoch: 2 cost time: 1.3740622997283936
Epoch: 2, Steps: 523 | Train Loss: 0.5967115 Vali Loss: 0.3142388 Best vali loss: 0.3142388
	iters: 100, epoch: 3 | loss: 0.2994593
	speed: 0.0061s/iter; left time: 18.5548s
	iters: 200, epoch: 3 | loss: 0.6318288
	speed: 0.0025s/iter; left time: 7.2931s
	iters: 300, epoch: 3 | loss: 0.3969908
	speed: 0.0025s/iter; left time: 7.0529s
	iters: 400, epoch: 3 | loss: 0.3524431
	speed: 0.0025s/iter; left time: 6.8451s
	iters: 500, epoch: 3 | loss: 0.7886243
	speed: 0.0025s/iter; left time: 6.5671s
Updating learning rate to 0.0028243702266985845
Epoch: 3 cost time: 1.3418371677398682
Epoch: 3, Steps: 523 | Train Loss: 0.4938693 Vali Loss: 0.3439968 Best vali loss: 0.3142388

best validation loss 0.31423877753170504

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0119635466446, 'e_layers': 4, 'learning_rate': 0.0002640298194, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6799690
	speed: 0.0106s/iter; left time: 43.2256s
	iters: 200, epoch: 1 | loss: 1.2555999
	speed: 0.0052s/iter; left time: 20.8956s
	iters: 300, epoch: 1 | loss: 0.6537992
	speed: 0.0053s/iter; left time: 20.3979s
	iters: 400, epoch: 1 | loss: 0.2923514
	speed: 0.0053s/iter; left time: 19.8734s
	iters: 500, epoch: 1 | loss: 0.1926882
	speed: 0.0052s/iter; left time: 19.2896s
Updating learning rate to 0.0002539807827581557
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 3.009530782699585
Epoch: 1, Steps: 523 | Train Loss: 0.6148815 Vali Loss: 0.2850181 Best vali loss: 0.2850181
	iters: 100, epoch: 2 | loss: 0.1583194
	speed: 0.0105s/iter; left time: 37.2763s
	iters: 200, epoch: 2 | loss: 0.3081677
	speed: 0.0052s/iter; left time: 18.0821s
	iters: 300, epoch: 2 | loss: 0.3005169
	speed: 0.0053s/iter; left time: 17.8173s
	iters: 400, epoch: 2 | loss: 0.3411942
	speed: 0.0050s/iter; left time: 16.3017s
	iters: 500, epoch: 2 | loss: 0.3060136
	speed: 0.0050s/iter; left time: 15.6540s
Updating learning rate to 0.00022536354756659972
Validation loss decreased (0.2850 --> 0.2753).  Saving model state dict ...
Epoch: 2 cost time: 2.7179629802703857
Epoch: 2, Steps: 523 | Train Loss: 0.2828424 Vali Loss: 0.2753290 Best vali loss: 0.2753290
	iters: 100, epoch: 3 | loss: 0.3030343
	speed: 0.0105s/iter; left time: 31.9563s
	iters: 200, epoch: 3 | loss: 0.4369148
	speed: 0.0053s/iter; left time: 15.4826s
	iters: 300, epoch: 3 | loss: 0.3806289
	speed: 0.0052s/iter; left time: 14.7379s
	iters: 400, epoch: 3 | loss: 0.3659717
	speed: 0.0052s/iter; left time: 14.1306s
	iters: 500, epoch: 3 | loss: 0.2898948
	speed: 0.0049s/iter; left time: 12.9801s
Updating learning rate to 0.00018253482846736338
Epoch: 3 cost time: 2.7111949920654297
Epoch: 3, Steps: 523 | Train Loss: 0.3552889 Vali Loss: 0.2843757 Best vali loss: 0.2753290

best validation loss 0.2753289506509872

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009288764012, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596040
	speed: 0.0103s/iter; left time: 9.7952s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9202752113342285
Epoch: 1, Steps: 131 | Train Loss: 0.5596040 Vali Loss: 0.2756390 Best vali loss: 0.2756390
	iters: 100, epoch: 2 | loss: 0.3224733
	speed: 0.0088s/iter; left time: 7.1932s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2710).  Saving model state dict ...
Epoch: 2 cost time: 0.699984073638916
Epoch: 2, Steps: 131 | Train Loss: 0.3224733 Vali Loss: 0.2709995 Best vali loss: 0.2709995
	iters: 100, epoch: 3 | loss: 0.4617337
	speed: 0.0091s/iter; left time: 6.2241s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.705768346786499
Epoch: 3, Steps: 131 | Train Loss: 0.4617337 Vali Loss: 0.2802846 Best vali loss: 0.2709995

best validation loss 0.2709994849639118

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009288764012, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4222057
	speed: 0.0109s/iter; left time: 6.0691s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9348948001861572
Epoch: 4, Steps: 131 | Train Loss: 0.4222057 Vali Loss: 0.3085045 Best vali loss: 0.2709995
	iters: 100, epoch: 5 | loss: 0.2831663
	speed: 0.0087s/iter; left time: 3.7185s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6979310512542725
Epoch: 5, Steps: 131 | Train Loss: 0.2831663 Vali Loss: 0.3025040 Best vali loss: 0.2709995
	iters: 100, epoch: 6 | loss: 0.4346651
	speed: 0.0087s/iter; left time: 2.5467s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.705181360244751
Epoch: 6, Steps: 131 | Train Loss: 0.4346651 Vali Loss: 0.3051028 Best vali loss: 0.2709995
	iters: 100, epoch: 7 | loss: 0.4656140
	speed: 0.0087s/iter; left time: 1.4110s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7051806449890137
Epoch: 7, Steps: 131 | Train Loss: 0.4656140 Vali Loss: 0.3042018 Best vali loss: 0.2709995
	iters: 100, epoch: 8 | loss: 0.3276662
	speed: 0.0086s/iter; left time: 0.2749s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6944692134857178
Epoch: 8, Steps: 131 | Train Loss: 0.3276662 Vali Loss: 0.3015832 Best vali loss: 0.2709995

best validation loss 0.2709994849639118

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0117064864071, 'e_layers': 2, 'learning_rate': 5.07883031e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6558328
	speed: 0.0094s/iter; left time: 8.9456s
Updating learning rate to 4.885528841253477e-05
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 0.7984707355499268
Epoch: 1, Steps: 131 | Train Loss: 0.6558328 Vali Loss: 0.2894890 Best vali loss: 0.2894890
	iters: 100, epoch: 2 | loss: 0.6594218
	speed: 0.0067s/iter; left time: 5.5205s
Updating learning rate to 4.335052831348388e-05
Validation loss decreased (0.2895 --> 0.2813).  Saving model state dict ...
Epoch: 2 cost time: 0.518566370010376
Epoch: 2, Steps: 131 | Train Loss: 0.6594218 Vali Loss: 0.2813118 Best vali loss: 0.2813118
	iters: 100, epoch: 3 | loss: 0.6221740
	speed: 0.0066s/iter; left time: 4.5097s
Updating learning rate to 3.5112072627153266e-05
Validation loss decreased (0.2813 --> 0.2796).  Saving model state dict ...
Epoch: 3 cost time: 0.5218887329101562
Epoch: 3, Steps: 131 | Train Loss: 0.6221740 Vali Loss: 0.2796151 Best vali loss: 0.2796151
	iters: 100, epoch: 4 | loss: 0.6076672
	speed: 0.0066s/iter; left time: 3.6722s
Updating learning rate to 2.539415155e-05
Epoch: 4 cost time: 0.5190072059631348
Epoch: 4, Steps: 131 | Train Loss: 0.6076672 Vali Loss: 0.2801029 Best vali loss: 0.2796151
	iters: 100, epoch: 5 | loss: 0.4646508
	speed: 0.0067s/iter; left time: 2.8360s
Updating learning rate to 1.5676230472846737e-05
Validation loss decreased (0.2796 --> 0.2777).  Saving model state dict ...
Epoch: 5 cost time: 0.5384373664855957
Epoch: 5, Steps: 131 | Train Loss: 0.4646508 Vali Loss: 0.2776822 Best vali loss: 0.2776822
	iters: 100, epoch: 6 | loss: 0.3532042
	speed: 0.0067s/iter; left time: 1.9620s
Updating learning rate to 7.437774786516125e-06
Epoch: 6 cost time: 0.5250751972198486
Epoch: 6, Steps: 131 | Train Loss: 0.3532042 Vali Loss: 0.2779096 Best vali loss: 0.2776822
	iters: 100, epoch: 7 | loss: 0.3969851
	speed: 0.0065s/iter; left time: 1.0648s
Updating learning rate to 1.9330146874652324e-06
Epoch: 7 cost time: 0.5193347930908203
Epoch: 7, Steps: 131 | Train Loss: 0.3969851 Vali Loss: 0.2782329 Best vali loss: 0.2776822
	iters: 100, epoch: 8 | loss: 0.3692723
	speed: 0.0065s/iter; left time: 0.2094s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5181889533996582
Epoch: 8, Steps: 131 | Train Loss: 0.3692723 Vali Loss: 0.2781980 Best vali loss: 0.2776822

best validation loss 0.27768221811740185

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0038817000301, 'e_layers': 2, 'learning_rate': 0.0005289400998, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5305053
	speed: 0.0087s/iter; left time: 17.4173s
	iters: 200, epoch: 1 | loss: 0.4268722
	speed: 0.0035s/iter; left time: 6.6672s
Updating learning rate to 0.0005088085159648487
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.1912379264831543
Epoch: 1, Steps: 262 | Train Loss: 0.4786887 Vali Loss: 0.2856006 Best vali loss: 0.2856006
	iters: 100, epoch: 2 | loss: 0.2674130
	speed: 0.0080s/iter; left time: 13.9261s
	iters: 200, epoch: 2 | loss: 0.3780337
	speed: 0.0035s/iter; left time: 5.6572s
Updating learning rate to 0.00045147861560503456
Validation loss decreased (0.2856 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.9522569179534912
Epoch: 2, Steps: 262 | Train Loss: 0.3227233 Vali Loss: 0.2827448 Best vali loss: 0.2827448
	iters: 100, epoch: 3 | loss: 0.7619054
	speed: 0.0078s/iter; left time: 11.4924s
	iters: 200, epoch: 3 | loss: 0.6121974
	speed: 0.0034s/iter; left time: 4.6511s
Updating learning rate to 0.00036567835635349855
Validation loss decreased (0.2827 --> 0.2824).  Saving model state dict ...
Epoch: 3 cost time: 0.9449808597564697
Epoch: 3, Steps: 262 | Train Loss: 0.6870514 Vali Loss: 0.2823716 Best vali loss: 0.2823716
	iters: 100, epoch: 4 | loss: 0.3508118
	speed: 0.0078s/iter; left time: 9.4075s
	iters: 200, epoch: 4 | loss: 0.9311453
	speed: 0.0034s/iter; left time: 3.7422s
Updating learning rate to 0.0002644700499
Epoch: 4 cost time: 0.9287328720092773
Epoch: 4, Steps: 262 | Train Loss: 0.6409785 Vali Loss: 0.2891631 Best vali loss: 0.2823716
	iters: 100, epoch: 5 | loss: 0.3333390
	speed: 0.0080s/iter; left time: 7.5620s
	iters: 200, epoch: 5 | loss: 0.7312353
	speed: 0.0036s/iter; left time: 3.0685s
Updating learning rate to 0.00016326174344650143
Epoch: 5 cost time: 0.9837915897369385
Epoch: 5, Steps: 262 | Train Loss: 0.5322871 Vali Loss: 0.2907404 Best vali loss: 0.2823716
	iters: 100, epoch: 6 | loss: 0.3876832
	speed: 0.0080s/iter; left time: 5.4990s
	iters: 200, epoch: 6 | loss: 0.4976565
	speed: 0.0035s/iter; left time: 2.0565s
Updating learning rate to 7.746148419496541e-05
Epoch: 6 cost time: 0.9802422523498535
Epoch: 6, Steps: 262 | Train Loss: 0.4426698 Vali Loss: 0.2888336 Best vali loss: 0.2823716
	iters: 100, epoch: 7 | loss: 0.4515167
	speed: 0.0080s/iter; left time: 3.4112s
	iters: 200, epoch: 7 | loss: 0.5404732
	speed: 0.0036s/iter; left time: 1.1584s
Updating learning rate to 2.0131583835151324e-05
Epoch: 7 cost time: 0.9704275131225586
Epoch: 7, Steps: 262 | Train Loss: 0.4959949 Vali Loss: 0.2899308 Best vali loss: 0.2823716
	iters: 100, epoch: 8 | loss: 0.4934717
	speed: 0.0076s/iter; left time: 1.2431s
	iters: 200, epoch: 8 | loss: 0.3759834
	speed: 0.0034s/iter; left time: 0.2115s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9188284873962402
Epoch: 8, Steps: 262 | Train Loss: 0.4347276 Vali Loss: 0.2907005 Best vali loss: 0.2823716

best validation loss 0.28237158825358477

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0052300417596, 'e_layers': 2, 'learning_rate': 0.0034863293547, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8255149
	speed: 0.0089s/iter; left time: 36.4442s
	iters: 200, epoch: 1 | loss: 0.7016453
	speed: 0.0034s/iter; left time: 13.6562s
	iters: 300, epoch: 1 | loss: 0.3711920
	speed: 0.0034s/iter; left time: 13.2481s
	iters: 400, epoch: 1 | loss: 0.2913324
	speed: 0.0034s/iter; left time: 12.8741s
	iters: 500, epoch: 1 | loss: 0.5051777
	speed: 0.0034s/iter; left time: 12.5870s
Updating learning rate to 0.003353638844550306
Validation loss decreased (inf --> 0.3251).  Saving model state dict ...
Epoch: 1 cost time: 2.069667100906372
Epoch: 1, Steps: 523 | Train Loss: 0.5389724 Vali Loss: 0.3250594 Best vali loss: 0.3250594
	iters: 100, epoch: 2 | loss: 0.6645294
	speed: 0.0075s/iter; left time: 26.8616s
	iters: 200, epoch: 2 | loss: 0.5870487
	speed: 0.0035s/iter; left time: 12.0996s
	iters: 300, epoch: 2 | loss: 1.1637003
	speed: 0.0035s/iter; left time: 11.8149s
	iters: 400, epoch: 2 | loss: 0.8199008
	speed: 0.0035s/iter; left time: 11.4589s
	iters: 500, epoch: 2 | loss: 0.6321337
	speed: 0.0035s/iter; left time: 11.0235s
Updating learning rate to 0.0029757682414290453
Validation loss decreased (0.3251 --> 0.3207).  Saving model state dict ...
Epoch: 2 cost time: 1.866722822189331
Epoch: 2, Steps: 523 | Train Loss: 0.7734626 Vali Loss: 0.3206769 Best vali loss: 0.3206769
	iters: 100, epoch: 3 | loss: 0.4307108
	speed: 0.0076s/iter; left time: 23.1013s
	iters: 200, epoch: 3 | loss: 0.3112309
	speed: 0.0035s/iter; left time: 10.2076s
	iters: 300, epoch: 3 | loss: 0.7047117
	speed: 0.0035s/iter; left time: 9.8111s
	iters: 400, epoch: 3 | loss: 1.4729927
	speed: 0.0035s/iter; left time: 9.4876s
	iters: 500, epoch: 3 | loss: 0.3107619
	speed: 0.0034s/iter; left time: 9.0574s
Updating learning rate to 0.0024102449192558825
Epoch: 3 cost time: 1.8427364826202393
Epoch: 3, Steps: 523 | Train Loss: 0.6460816 Vali Loss: 0.3220607 Best vali loss: 0.3206769

best validation loss 0.3206768667899618

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002479786131, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5614283
	speed: 0.0103s/iter; left time: 9.8152s
Updating learning rate to 0.0002479786131
Validation loss decreased (inf --> 0.2759).  Saving model state dict ...
Epoch: 1 cost time: 0.9299027919769287
Epoch: 1, Steps: 131 | Train Loss: 0.5614283 Vali Loss: 0.2758639 Best vali loss: 0.2758639
	iters: 100, epoch: 2 | loss: 0.3314966
	speed: 0.0089s/iter; left time: 7.2575s
Updating learning rate to 0.00012398930655
Epoch: 2 cost time: 0.6979436874389648
Epoch: 2, Steps: 131 | Train Loss: 0.3314966 Vali Loss: 0.2778846 Best vali loss: 0.2758639
	iters: 100, epoch: 3 | loss: 0.4647410
	speed: 0.0085s/iter; left time: 5.8505s
Updating learning rate to 6.1994653275e-05
Epoch: 3 cost time: 0.6906032562255859
Epoch: 3, Steps: 131 | Train Loss: 0.4647410 Vali Loss: 0.2811542 Best vali loss: 0.2758639

best validation loss 0.2758638511396953

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0020467244147, 'e_layers': 4, 'learning_rate': 0.0042319322741, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0042319322741
Validation loss decreased (inf --> 0.2970).  Saving model state dict ...
Epoch: 1 cost time: 0.6935238838195801
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2969960 Best vali loss: 0.2969960
Updating learning rate to 0.00211596613705
Validation loss decreased (0.2970 --> 0.2912).  Saving model state dict ...
Epoch: 2 cost time: 0.4062943458557129
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2911751 Best vali loss: 0.2911751
Updating learning rate to 0.001057983068525
Epoch: 3 cost time: 0.4115409851074219
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2933579 Best vali loss: 0.2911751

best validation loss 0.29117510712426053

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002479786131, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4153858
	speed: 0.0107s/iter; left time: 5.9425s
Updating learning rate to 3.09973266375e-05
Epoch: 4 cost time: 0.9222836494445801
Epoch: 4, Steps: 131 | Train Loss: 0.4153858 Vali Loss: 0.3024369 Best vali loss: 0.2758639
	iters: 100, epoch: 5 | loss: 0.2841314
	speed: 0.0085s/iter; left time: 3.6277s
Updating learning rate to 1.549866331875e-05
Epoch: 5 cost time: 0.6888554096221924
Epoch: 5, Steps: 131 | Train Loss: 0.2841314 Vali Loss: 0.2991042 Best vali loss: 0.2758639
	iters: 100, epoch: 6 | loss: 0.4321125
	speed: 0.0085s/iter; left time: 2.5019s
Updating learning rate to 7.749331659375e-06
Epoch: 6 cost time: 0.6941370964050293
Epoch: 6, Steps: 131 | Train Loss: 0.4321125 Vali Loss: 0.3010785 Best vali loss: 0.2758639
	iters: 100, epoch: 7 | loss: 0.4573342
	speed: 0.0086s/iter; left time: 1.4066s
Updating learning rate to 3.8746658296875e-06
Epoch: 7 cost time: 0.7069485187530518
Epoch: 7, Steps: 131 | Train Loss: 0.4573342 Vali Loss: 0.2989043 Best vali loss: 0.2758639
	iters: 100, epoch: 8 | loss: 0.3264784
	speed: 0.0085s/iter; left time: 0.2736s
Updating learning rate to 1.93733291484375e-06
Epoch: 8 cost time: 0.6930413246154785
Epoch: 8, Steps: 131 | Train Loss: 0.3264784 Vali Loss: 0.2985317 Best vali loss: 0.2758639

best validation loss 0.2758638511396953

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0009497321382, 'e_layers': 4, 'learning_rate': 0.0040539755633, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040539755633
Validation loss decreased (inf --> 0.2966).  Saving model state dict ...
Epoch: 1 cost time: 0.6858515739440918
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2965584 Best vali loss: 0.2965584
Updating learning rate to 0.00202698778165
Validation loss decreased (0.2966 --> 0.2893).  Saving model state dict ...
Epoch: 2 cost time: 0.44109678268432617
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2893123 Best vali loss: 0.2893123
Updating learning rate to 0.001013493890825
Epoch: 3 cost time: 0.46230220794677734
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2918344 Best vali loss: 0.2893123
Updating learning rate to 0.0005067469454125
Epoch: 4 cost time: 0.4592766761779785
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2991614 Best vali loss: 0.2893123
Updating learning rate to 0.00025337347270625
Epoch: 5 cost time: 0.4034266471862793
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3071011 Best vali loss: 0.2893123
Updating learning rate to 0.000126686736353125
Epoch: 6 cost time: 0.4136838912963867
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3111936 Best vali loss: 0.2893123
Updating learning rate to 6.33433681765625e-05
Epoch: 7 cost time: 0.43934035301208496
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3116573 Best vali loss: 0.2893123
Updating learning rate to 3.167168408828125e-05
Epoch: 8 cost time: 0.45380234718322754
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3104096 Best vali loss: 0.2893123

best validation loss 0.28931226499043416

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008249116732, 'e_layers': 4, 'learning_rate': 0.0042147319252, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0042147319252
Validation loss decreased (inf --> 0.2942).  Saving model state dict ...
Epoch: 1 cost time: 0.6698641777038574
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2941532 Best vali loss: 0.2941532
Updating learning rate to 0.0021073659626
Validation loss decreased (0.2942 --> 0.2938).  Saving model state dict ...
Epoch: 2 cost time: 0.45481443405151367
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2938335 Best vali loss: 0.2938335
Updating learning rate to 0.0010536829813
Validation loss decreased (0.2938 --> 0.2891).  Saving model state dict ...
Epoch: 3 cost time: 0.4473080635070801
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2890925 Best vali loss: 0.2890925
Updating learning rate to 0.00052684149065
Epoch: 4 cost time: 0.42181921005249023
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2901481 Best vali loss: 0.2890925
Updating learning rate to 0.000263420745325
Epoch: 5 cost time: 0.405747652053833
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2978628 Best vali loss: 0.2890925
Updating learning rate to 0.0001317103726625
Epoch: 6 cost time: 0.4633903503417969
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3012045 Best vali loss: 0.2890925
Updating learning rate to 6.585518633125e-05
Epoch: 7 cost time: 0.40728306770324707
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3012993 Best vali loss: 0.2890925
Updating learning rate to 3.2927593165625e-05
Epoch: 8 cost time: 0.40925121307373047
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3034706 Best vali loss: 0.2890925

best validation loss 0.2890924774179586

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0032711494032, 'e_layers': 1, 'learning_rate': 0.0004665875287, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4813687
	speed: 0.0079s/iter; left time: 15.8566s
	iters: 200, epoch: 1 | loss: 0.5376925
	speed: 0.0026s/iter; left time: 4.8565s
Updating learning rate to 0.0004488290982954763
Validation loss decreased (inf --> 0.2873).  Saving model state dict ...
Epoch: 1 cost time: 0.9394528865814209
Epoch: 1, Steps: 262 | Train Loss: 0.5095306 Vali Loss: 0.2872522 Best vali loss: 0.2872522
	iters: 100, epoch: 2 | loss: 0.3197966
	speed: 0.0061s/iter; left time: 10.6507s
	iters: 200, epoch: 2 | loss: 0.4138568
	speed: 0.0025s/iter; left time: 4.0654s
Updating learning rate to 0.0003982573671304214
Validation loss decreased (0.2873 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 0.6926422119140625
Epoch: 2, Steps: 262 | Train Loss: 0.3668267 Vali Loss: 0.2871218 Best vali loss: 0.2871218
	iters: 100, epoch: 3 | loss: 0.2732562
	speed: 0.0063s/iter; left time: 9.3048s
	iters: 200, epoch: 3 | loss: 0.4560176
	speed: 0.0024s/iter; left time: 3.2734s
Updating learning rate to 0.0003225714228408304
Epoch: 3 cost time: 0.6801948547363281
Epoch: 3, Steps: 262 | Train Loss: 0.3646369 Vali Loss: 0.2928785 Best vali loss: 0.2871218

best validation loss 0.2871218442850372

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0039841275778, 'e_layers': 4, 'learning_rate': 0.0041541351244, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0041541351244
Validation loss decreased (inf --> 0.2941).  Saving model state dict ...
Epoch: 1 cost time: 0.6742603778839111
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2940707 Best vali loss: 0.2940707
Updating learning rate to 0.0020770675622
Validation loss decreased (0.2941 --> 0.2927).  Saving model state dict ...
Epoch: 2 cost time: 0.42324376106262207
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2926992 Best vali loss: 0.2926992
Updating learning rate to 0.0010385337811
Epoch: 3 cost time: 0.4447934627532959
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2967830 Best vali loss: 0.2926992

best validation loss 0.2926992098608616

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0057252649927, 'e_layers': 2, 'learning_rate': 6.84374592e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1196889
	speed: 0.0085s/iter; left time: 34.5975s
	iters: 200, epoch: 1 | loss: 0.3059742
	speed: 0.0032s/iter; left time: 12.6757s
	iters: 300, epoch: 1 | loss: 0.3633988
	speed: 0.0032s/iter; left time: 12.3926s
	iters: 400, epoch: 1 | loss: 0.8875382
	speed: 0.0032s/iter; left time: 12.0542s
	iters: 500, epoch: 1 | loss: 0.7374781
	speed: 0.0032s/iter; left time: 11.7435s
Updating learning rate to 6.583271350597813e-05
Validation loss decreased (inf --> 0.3014).  Saving model state dict ...
Epoch: 1 cost time: 1.934805154800415
Epoch: 1, Steps: 523 | Train Loss: 0.6828156 Vali Loss: 0.3013750 Best vali loss: 0.3013750
	iters: 100, epoch: 2 | loss: 0.8017678
	speed: 0.0069s/iter; left time: 24.7540s
	iters: 200, epoch: 2 | loss: 0.5555147
	speed: 0.0031s/iter; left time: 10.8254s
	iters: 300, epoch: 2 | loss: 0.2989158
	speed: 0.0033s/iter; left time: 10.9585s
	iters: 400, epoch: 2 | loss: 0.3193056
	speed: 0.0033s/iter; left time: 10.6748s
	iters: 500, epoch: 2 | loss: 0.9730848
	speed: 0.0030s/iter; left time: 9.5148s
Updating learning rate to 5.841502534374884e-05
Validation loss decreased (0.3014 --> 0.2877).  Saving model state dict ...
Epoch: 2 cost time: 1.6784098148345947
Epoch: 2, Steps: 523 | Train Loss: 0.5897177 Vali Loss: 0.2877407 Best vali loss: 0.2877407
	iters: 100, epoch: 3 | loss: 0.3392952
	speed: 0.0067s/iter; left time: 20.3190s
	iters: 200, epoch: 3 | loss: 0.4479181
	speed: 0.0031s/iter; left time: 9.0629s
	iters: 300, epoch: 3 | loss: 1.0457476
	speed: 0.0031s/iter; left time: 8.9152s
	iters: 400, epoch: 3 | loss: 0.6645376
	speed: 0.0031s/iter; left time: 8.5637s
	iters: 500, epoch: 3 | loss: 0.6488066
	speed: 0.0031s/iter; left time: 8.2920s
Updating learning rate to 4.7313670494500896e-05
Validation loss decreased (0.2877 --> 0.2832).  Saving model state dict ...
Epoch: 3 cost time: 1.6500401496887207
Epoch: 3, Steps: 523 | Train Loss: 0.6292610 Vali Loss: 0.2831792 Best vali loss: 0.2831792

best validation loss 0.2831792080987559

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0057252649927, 'e_layers': 2, 'learning_rate': 6.84374592e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9751953
	speed: 0.0085s/iter; left time: 21.2987s
	iters: 200, epoch: 4 | loss: 0.2321546
	speed: 0.0031s/iter; left time: 7.4979s
	iters: 300, epoch: 4 | loss: 0.3302704
	speed: 0.0029s/iter; left time: 6.8107s
	iters: 400, epoch: 4 | loss: 0.7796687
	speed: 0.0029s/iter; left time: 6.4699s
	iters: 500, epoch: 4 | loss: 0.7601907
	speed: 0.0029s/iter; left time: 6.1763s
Updating learning rate to 3.42187296e-05
Validation loss decreased (0.2832 --> 0.2813).  Saving model state dict ...
Epoch: 4 cost time: 1.830324411392212
Epoch: 4, Steps: 523 | Train Loss: 0.6154960 Vali Loss: 0.2813376 Best vali loss: 0.2813376
	iters: 100, epoch: 5 | loss: 0.7797884
	speed: 0.0073s/iter; left time: 14.4693s
	iters: 200, epoch: 5 | loss: 0.5317683
	speed: 0.0035s/iter; left time: 6.5701s
	iters: 300, epoch: 5 | loss: 0.2803941
	speed: 0.0035s/iter; left time: 6.1909s
	iters: 400, epoch: 5 | loss: 0.3030792
	speed: 0.0035s/iter; left time: 5.8617s
	iters: 500, epoch: 5 | loss: 0.8794857
	speed: 0.0034s/iter; left time: 5.4565s
Updating learning rate to 2.1123788705499105e-05
Validation loss decreased (0.2813 --> 0.2808).  Saving model state dict ...
Epoch: 5 cost time: 1.8521015644073486
Epoch: 5, Steps: 523 | Train Loss: 0.5549032 Vali Loss: 0.2808105 Best vali loss: 0.2808105
	iters: 100, epoch: 6 | loss: 0.3275993
	speed: 0.0072s/iter; left time: 10.6422s
	iters: 200, epoch: 6 | loss: 0.4177263
	speed: 0.0034s/iter; left time: 4.6387s
	iters: 300, epoch: 6 | loss: 1.0177143
	speed: 0.0034s/iter; left time: 4.3155s
	iters: 400, epoch: 6 | loss: 0.5991562
	speed: 0.0034s/iter; left time: 3.9477s
	iters: 500, epoch: 6 | loss: 0.6282796
	speed: 0.0034s/iter; left time: 3.6292s
Updating learning rate to 1.0022433856251166e-05
Validation loss decreased (0.2808 --> 0.2808).  Saving model state dict ...
Epoch: 6 cost time: 1.803560495376587
Epoch: 6, Steps: 523 | Train Loss: 0.5980951 Vali Loss: 0.2807691 Best vali loss: 0.2807691
	iters: 100, epoch: 7 | loss: 0.2840804
	speed: 0.0074s/iter; left time: 6.9894s
	iters: 200, epoch: 7 | loss: 0.7711926
	speed: 0.0034s/iter; left time: 2.8783s
	iters: 300, epoch: 7 | loss: 0.4158688
	speed: 0.0034s/iter; left time: 2.5267s
	iters: 400, epoch: 7 | loss: 0.3796372
	speed: 0.0034s/iter; left time: 2.1856s
	iters: 500, epoch: 7 | loss: 0.5316504
	speed: 0.0035s/iter; left time: 1.9045s
Updating learning rate to 2.60474569402187e-06
Validation loss decreased (0.2808 --> 0.2807).  Saving model state dict ...
Epoch: 7 cost time: 1.8181183338165283
Epoch: 7, Steps: 523 | Train Loss: 0.4764859 Vali Loss: 0.2806648 Best vali loss: 0.2806648
	iters: 100, epoch: 8 | loss: 0.4143007
	speed: 0.0072s/iter; left time: 3.0554s
	iters: 200, epoch: 8 | loss: 0.8409700
	speed: 0.0032s/iter; left time: 1.0367s
	iters: 300, epoch: 8 | loss: 0.7625375
	speed: 0.0032s/iter; left time: 0.7148s
	iters: 400, epoch: 8 | loss: 0.4545410
	speed: 0.0032s/iter; left time: 0.3976s
	iters: 500, epoch: 8 | loss: 0.7416763
	speed: 0.0032s/iter; left time: 0.0760s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.71852707862854
Epoch: 8, Steps: 523 | Train Loss: 0.6428051 Vali Loss: 0.2807025 Best vali loss: 0.2806648

best validation loss 0.28066475706589894

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0020355691423, 'e_layers': 2, 'learning_rate': 0.0017579343515, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3692039
	speed: 0.0090s/iter; left time: 36.6662s
	iters: 200, epoch: 1 | loss: 0.4083018
	speed: 0.0031s/iter; left time: 12.5025s
	iters: 300, epoch: 1 | loss: 0.4224066
	speed: 0.0031s/iter; left time: 11.9939s
	iters: 400, epoch: 1 | loss: 0.6061646
	speed: 0.0031s/iter; left time: 11.7050s
	iters: 500, epoch: 1 | loss: 0.3754884
	speed: 0.0031s/iter; left time: 11.5035s
Updating learning rate to 0.0016910269591746759
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 1.8876550197601318
Epoch: 1, Steps: 523 | Train Loss: 0.4363130 Vali Loss: 0.2939870 Best vali loss: 0.2939870
	iters: 100, epoch: 2 | loss: 0.4893053
	speed: 0.0072s/iter; left time: 25.5393s
	iters: 200, epoch: 2 | loss: 0.5209724
	speed: 0.0033s/iter; left time: 11.5204s
	iters: 300, epoch: 2 | loss: 1.2281017
	speed: 0.0033s/iter; left time: 11.1187s
	iters: 400, epoch: 2 | loss: 0.2636981
	speed: 0.0033s/iter; left time: 10.7372s
	iters: 500, epoch: 2 | loss: 0.2509907
	speed: 0.0033s/iter; left time: 10.4853s
Updating learning rate to 0.0015004908261632129
Validation loss decreased (0.2940 --> 0.2891).  Saving model state dict ...
Epoch: 2 cost time: 1.7747461795806885
Epoch: 2, Steps: 523 | Train Loss: 0.5506137 Vali Loss: 0.2891486 Best vali loss: 0.2891486
	iters: 100, epoch: 3 | loss: 0.3607175
	speed: 0.0072s/iter; left time: 21.7608s
	iters: 200, epoch: 3 | loss: 0.8226348
	speed: 0.0033s/iter; left time: 9.7359s
	iters: 300, epoch: 3 | loss: 0.3605642
	speed: 0.0033s/iter; left time: 9.4122s
	iters: 400, epoch: 3 | loss: 0.6611366
	speed: 0.0033s/iter; left time: 9.0752s
	iters: 500, epoch: 3 | loss: 0.4446065
	speed: 0.0033s/iter; left time: 8.7743s
Updating learning rate to 0.001215333351502259
Epoch: 3 cost time: 1.770723819732666
Epoch: 3, Steps: 523 | Train Loss: 0.5299319 Vali Loss: 0.2930967 Best vali loss: 0.2891486
	iters: 100, epoch: 4 | loss: 0.3630563
	speed: 0.0069s/iter; left time: 17.4694s
	iters: 200, epoch: 4 | loss: 0.4961885
	speed: 0.0031s/iter; left time: 7.5179s
	iters: 300, epoch: 4 | loss: 0.3355612
	speed: 0.0031s/iter; left time: 7.1531s
	iters: 400, epoch: 4 | loss: 0.4736227
	speed: 0.0031s/iter; left time: 6.8495s
	iters: 500, epoch: 4 | loss: 0.3329781
	speed: 0.0030s/iter; left time: 6.3256s
Updating learning rate to 0.00087896717575
Epoch: 4 cost time: 1.650383710861206
Epoch: 4, Steps: 523 | Train Loss: 0.4002814 Vali Loss: 0.2988261 Best vali loss: 0.2891486
	iters: 100, epoch: 5 | loss: 0.5629978
	speed: 0.0069s/iter; left time: 13.7155s
	iters: 200, epoch: 5 | loss: 0.3185189
	speed: 0.0031s/iter; left time: 5.8787s
	iters: 300, epoch: 5 | loss: 0.3762740
	speed: 0.0031s/iter; left time: 5.5300s
	iters: 400, epoch: 5 | loss: 0.4184450
	speed: 0.0031s/iter; left time: 5.2111s
	iters: 500, epoch: 5 | loss: 0.2343218
	speed: 0.0031s/iter; left time: 4.9232s
Updating learning rate to 0.0005426009999977409
Epoch: 5 cost time: 1.6599538326263428
Epoch: 5, Steps: 523 | Train Loss: 0.3821115 Vali Loss: 0.3053531 Best vali loss: 0.2891486
	iters: 100, epoch: 6 | loss: 0.8225269
	speed: 0.0072s/iter; left time: 10.5419s
	iters: 200, epoch: 6 | loss: 0.5720783
	speed: 0.0033s/iter; left time: 4.5617s
	iters: 300, epoch: 6 | loss: 0.2460238
	speed: 0.0033s/iter; left time: 4.2292s
	iters: 400, epoch: 6 | loss: 0.1923306
	speed: 0.0033s/iter; left time: 3.8976s
	iters: 500, epoch: 6 | loss: 0.2654038
	speed: 0.0033s/iter; left time: 3.5689s
Updating learning rate to 0.00025744352533678714
Epoch: 6 cost time: 1.7811295986175537
Epoch: 6, Steps: 523 | Train Loss: 0.4196727 Vali Loss: 0.3095366 Best vali loss: 0.2891486
	iters: 100, epoch: 7 | loss: 0.4045576
	speed: 0.0071s/iter; left time: 6.7273s
	iters: 200, epoch: 7 | loss: 0.5924295
	speed: 0.0031s/iter; left time: 2.6263s
	iters: 300, epoch: 7 | loss: 0.2391607
	speed: 0.0032s/iter; left time: 2.3825s
	iters: 400, epoch: 7 | loss: 0.2380283
	speed: 0.0031s/iter; left time: 2.0262s
	iters: 500, epoch: 7 | loss: 0.2798245
	speed: 0.0032s/iter; left time: 1.7280s
Updating learning rate to 6.690739232532399e-05
Epoch: 7 cost time: 1.680983543395996
Epoch: 7, Steps: 523 | Train Loss: 0.3508001 Vali Loss: 0.3111077 Best vali loss: 0.2891486
	iters: 100, epoch: 8 | loss: 0.2568358
	speed: 0.0069s/iter; left time: 2.9276s
	iters: 200, epoch: 8 | loss: 0.3842555
	speed: 0.0030s/iter; left time: 0.9688s
	iters: 300, epoch: 8 | loss: 0.2007544
	speed: 0.0030s/iter; left time: 0.6718s
	iters: 400, epoch: 8 | loss: 0.2455654
	speed: 0.0030s/iter; left time: 0.3709s
	iters: 500, epoch: 8 | loss: 0.4418375
	speed: 0.0030s/iter; left time: 0.0712s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6089847087860107
Epoch: 8, Steps: 523 | Train Loss: 0.3058497 Vali Loss: 0.3192575 Best vali loss: 0.2891486

best validation loss 0.28914855270414114

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345067337, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597125
	speed: 0.0105s/iter; left time: 9.9746s
Updating learning rate to 0.0002345067337
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9459748268127441
Epoch: 1, Steps: 131 | Train Loss: 0.5597125 Vali Loss: 0.2756342 Best vali loss: 0.2756342
	iters: 100, epoch: 2 | loss: 0.3235030
	speed: 0.0089s/iter; left time: 7.2766s
Updating learning rate to 0.00011725336685
Validation loss decreased (0.2756 --> 0.2684).  Saving model state dict ...
Epoch: 2 cost time: 0.6998705863952637
Epoch: 2, Steps: 131 | Train Loss: 0.3235030 Vali Loss: 0.2684067 Best vali loss: 0.2684067
	iters: 100, epoch: 3 | loss: 0.4588784
	speed: 0.0091s/iter; left time: 6.2257s
Updating learning rate to 5.8626683425e-05
Epoch: 3 cost time: 0.702965259552002
Epoch: 3, Steps: 131 | Train Loss: 0.4588784 Vali Loss: 0.2779192 Best vali loss: 0.2684067
	iters: 100, epoch: 4 | loss: 0.5041515
	speed: 0.0086s/iter; left time: 4.7959s
Updating learning rate to 2.93133417125e-05
Epoch: 4 cost time: 0.6987764835357666
Epoch: 4, Steps: 131 | Train Loss: 0.5041515 Vali Loss: 0.2952746 Best vali loss: 0.2684067
	iters: 100, epoch: 5 | loss: 0.3307805
	speed: 0.0087s/iter; left time: 3.6793s
Updating learning rate to 1.465667085625e-05
Epoch: 5 cost time: 0.7029650211334229
Epoch: 5, Steps: 131 | Train Loss: 0.3307805 Vali Loss: 0.2894567 Best vali loss: 0.2684067
	iters: 100, epoch: 6 | loss: 0.3195121
	speed: 0.0086s/iter; left time: 2.5292s
Updating learning rate to 7.328335428125e-06
Epoch: 6 cost time: 0.6956474781036377
Epoch: 6, Steps: 131 | Train Loss: 0.3195121 Vali Loss: 0.2924229 Best vali loss: 0.2684067
	iters: 100, epoch: 7 | loss: 0.3106071
	speed: 0.0087s/iter; left time: 1.4179s
Updating learning rate to 3.6641677140625e-06
Epoch: 7 cost time: 0.6993370056152344
Epoch: 7, Steps: 131 | Train Loss: 0.3106071 Vali Loss: 0.2965164 Best vali loss: 0.2684067
	iters: 100, epoch: 8 | loss: 0.3956763
	speed: 0.0086s/iter; left time: 0.2740s
Updating learning rate to 1.83208385703125e-06
Epoch: 8 cost time: 0.6944019794464111
Epoch: 8, Steps: 131 | Train Loss: 0.3956763 Vali Loss: 0.2958910 Best vali loss: 0.2684067

best validation loss 0.26840668820279734

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266899409, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597166
	speed: 0.0102s/iter; left time: 9.6805s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9255869388580322
Epoch: 1, Steps: 131 | Train Loss: 0.5597166 Vali Loss: 0.2756341 Best vali loss: 0.2756341
	iters: 100, epoch: 2 | loss: 0.3245914
	speed: 0.0088s/iter; left time: 7.2191s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2687).  Saving model state dict ...
Epoch: 2 cost time: 0.698585033416748
Epoch: 2, Steps: 131 | Train Loss: 0.3245914 Vali Loss: 0.2686833 Best vali loss: 0.2686833
	iters: 100, epoch: 3 | loss: 0.4622678
	speed: 0.0090s/iter; left time: 6.1995s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7020323276519775
Epoch: 3, Steps: 131 | Train Loss: 0.4622678 Vali Loss: 0.2780031 Best vali loss: 0.2686833

best validation loss 0.26868334387083753

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0020646239673, 'e_layers': 2, 'learning_rate': 0.0003244825464, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003244825464
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 0.5573139190673828
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2809091 Best vali loss: 0.2809091
Updating learning rate to 0.0001622412732
Validation loss decreased (0.2809 --> 0.2776).  Saving model state dict ...
Epoch: 2 cost time: 0.3407249450683594
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2775756 Best vali loss: 0.2775756
Updating learning rate to 8.11206366e-05
Validation loss decreased (0.2776 --> 0.2760).  Saving model state dict ...
Epoch: 3 cost time: 0.31840085983276367
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2759745 Best vali loss: 0.2759745

best validation loss 0.27597445613081545

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009537405829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596248
	speed: 0.0104s/iter; left time: 9.8683s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9221069812774658
Epoch: 1, Steps: 131 | Train Loss: 0.5596248 Vali Loss: 0.2756703 Best vali loss: 0.2756703
	iters: 100, epoch: 2 | loss: 0.3245817
	speed: 0.0088s/iter; left time: 7.1866s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2711).  Saving model state dict ...
Epoch: 2 cost time: 0.696129560470581
Epoch: 2, Steps: 131 | Train Loss: 0.3245817 Vali Loss: 0.2710991 Best vali loss: 0.2710991
	iters: 100, epoch: 3 | loss: 0.4610536
	speed: 0.0090s/iter; left time: 6.1631s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7012190818786621
Epoch: 3, Steps: 131 | Train Loss: 0.4610536 Vali Loss: 0.2812550 Best vali loss: 0.2710991

best validation loss 0.27109906360002733

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266899409, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4218988
	speed: 0.0108s/iter; left time: 5.9918s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9214839935302734
Epoch: 4, Steps: 131 | Train Loss: 0.4218988 Vali Loss: 0.3036967 Best vali loss: 0.2686833
	iters: 100, epoch: 5 | loss: 0.2826976
	speed: 0.0086s/iter; left time: 3.6580s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6923730373382568
Epoch: 5, Steps: 131 | Train Loss: 0.2826976 Vali Loss: 0.2903727 Best vali loss: 0.2686833
	iters: 100, epoch: 6 | loss: 0.4351587
	speed: 0.0085s/iter; left time: 2.5103s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6934082508087158
Epoch: 6, Steps: 131 | Train Loss: 0.4351587 Vali Loss: 0.2963485 Best vali loss: 0.2686833
	iters: 100, epoch: 7 | loss: 0.4666146
	speed: 0.0086s/iter; left time: 1.4080s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6973228454589844
Epoch: 7, Steps: 131 | Train Loss: 0.4666146 Vali Loss: 0.2945157 Best vali loss: 0.2686833
	iters: 100, epoch: 8 | loss: 0.3285515
	speed: 0.0086s/iter; left time: 0.2750s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6902692317962646
Epoch: 8, Steps: 131 | Train Loss: 0.3285515 Vali Loss: 0.2914033 Best vali loss: 0.2686833

best validation loss 0.26868334387083753

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010172639937, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596936
	speed: 0.0105s/iter; left time: 9.9716s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.928912878036499
Epoch: 1, Steps: 131 | Train Loss: 0.5596936 Vali Loss: 0.2756443 Best vali loss: 0.2756443
	iters: 100, epoch: 2 | loss: 0.3236721
	speed: 0.0089s/iter; left time: 7.2704s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2756 --> 0.2732).  Saving model state dict ...
Epoch: 2 cost time: 0.6960325241088867
Epoch: 2, Steps: 131 | Train Loss: 0.3236721 Vali Loss: 0.2732077 Best vali loss: 0.2732077
	iters: 100, epoch: 3 | loss: 0.4705325
	speed: 0.0090s/iter; left time: 6.1536s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.6978793144226074
Epoch: 3, Steps: 131 | Train Loss: 0.4705325 Vali Loss: 0.2810397 Best vali loss: 0.2732077
	iters: 100, epoch: 4 | loss: 0.4796485
	speed: 0.0086s/iter; left time: 4.7899s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 0.6988821029663086
Epoch: 4, Steps: 131 | Train Loss: 0.4796485 Vali Loss: 0.2801336 Best vali loss: 0.2732077
	iters: 100, epoch: 5 | loss: 0.3431799
	speed: 0.0086s/iter; left time: 3.6712s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.699946403503418
Epoch: 5, Steps: 131 | Train Loss: 0.3431799 Vali Loss: 0.2890268 Best vali loss: 0.2732077
	iters: 100, epoch: 6 | loss: 0.3116642
	speed: 0.0087s/iter; left time: 2.5520s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.6946470737457275
Epoch: 6, Steps: 131 | Train Loss: 0.3116642 Vali Loss: 0.3013161 Best vali loss: 0.2732077
	iters: 100, epoch: 7 | loss: 0.2888345
	speed: 0.0088s/iter; left time: 1.4307s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 0.7061972618103027
Epoch: 7, Steps: 131 | Train Loss: 0.2888345 Vali Loss: 0.3039962 Best vali loss: 0.2732077
	iters: 100, epoch: 8 | loss: 0.3448394
	speed: 0.0086s/iter; left time: 0.2754s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6958742141723633
Epoch: 8, Steps: 131 | Train Loss: 0.3448394 Vali Loss: 0.3032356 Best vali loss: 0.2732077

best validation loss 0.27320769215303975

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.002348591284, 'e_layers': 1, 'learning_rate': 0.000544419828, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3195038
	speed: 0.0084s/iter; left time: 7.9334s
Updating learning rate to 0.0005236990820912576
Validation loss decreased (inf --> 0.2920).  Saving model state dict ...
Epoch: 1 cost time: 0.6445486545562744
Epoch: 1, Steps: 131 | Train Loss: 0.3195038 Vali Loss: 0.2920201 Best vali loss: 0.2920201
	iters: 100, epoch: 2 | loss: 0.4709684
	speed: 0.0055s/iter; left time: 4.4907s
Updating learning rate to 0.00046469139009560695
Validation loss decreased (0.2920 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 0.41970300674438477
Epoch: 2, Steps: 131 | Train Loss: 0.4709684 Vali Loss: 0.2825247 Best vali loss: 0.2825247
	iters: 100, epoch: 3 | loss: 0.4547390
	speed: 0.0052s/iter; left time: 3.5856s
Updating learning rate to 0.00037638013821332593
Validation loss decreased (0.2825 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 0.4003901481628418
Epoch: 3, Steps: 131 | Train Loss: 0.4547390 Vali Loss: 0.2819283 Best vali loss: 0.2819283
	iters: 100, epoch: 4 | loss: 0.5203313
	speed: 0.0054s/iter; left time: 2.9940s
Updating learning rate to 0.000272209914
Epoch: 4 cost time: 0.3960416316986084
Epoch: 4, Steps: 131 | Train Loss: 0.5203313 Vali Loss: 0.2823223 Best vali loss: 0.2819283
	iters: 100, epoch: 5 | loss: 0.6448215
	speed: 0.0054s/iter; left time: 2.3007s
Updating learning rate to 0.00016803968978667413
Epoch: 5 cost time: 0.43076229095458984
Epoch: 5, Steps: 131 | Train Loss: 0.6448215 Vali Loss: 0.2820144 Best vali loss: 0.2819283
	iters: 100, epoch: 6 | loss: 0.4526404
	speed: 0.0052s/iter; left time: 1.5260s
Updating learning rate to 7.97284379043931e-05
Epoch: 6 cost time: 0.374284029006958
Epoch: 6, Steps: 131 | Train Loss: 0.4526404 Vali Loss: 0.2819851 Best vali loss: 0.2819283
	iters: 100, epoch: 7 | loss: 0.4781104
	speed: 0.0053s/iter; left time: 0.8629s
Updating learning rate to 2.0720745908742434e-05
Epoch: 7 cost time: 0.40706968307495117
Epoch: 7, Steps: 131 | Train Loss: 0.4781104 Vali Loss: 0.2822385 Best vali loss: 0.2819283
	iters: 100, epoch: 8 | loss: 0.6435966
	speed: 0.0054s/iter; left time: 0.1736s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.41789817810058594
Epoch: 8, Steps: 131 | Train Loss: 0.6435966 Vali Loss: 0.2822722 Best vali loss: 0.2819283

best validation loss 0.2819282831634541

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597192
	speed: 0.0105s/iter; left time: 10.0107s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9378561973571777
Epoch: 1, Steps: 131 | Train Loss: 0.5597192 Vali Loss: 0.2756283 Best vali loss: 0.2756283
	iters: 100, epoch: 2 | loss: 0.3248189
	speed: 0.0087s/iter; left time: 7.1525s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.6925013065338135
Epoch: 2, Steps: 131 | Train Loss: 0.3248189 Vali Loss: 0.2690257 Best vali loss: 0.2690257
	iters: 100, epoch: 3 | loss: 0.4634705
	speed: 0.0090s/iter; left time: 6.1549s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7030551433563232
Epoch: 3, Steps: 131 | Train Loss: 0.4634705 Vali Loss: 0.2871046 Best vali loss: 0.2690257

best validation loss 0.26902565425459274

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0018288404354, 'e_layers': 1, 'learning_rate': 0.0010093668138, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5229726
	speed: 0.0076s/iter; left time: 62.6947s
	iters: 200, epoch: 1 | loss: 0.1854776
	speed: 0.0024s/iter; left time: 19.3309s
	iters: 300, epoch: 1 | loss: 0.3233475
	speed: 0.0024s/iter; left time: 19.4834s
	iters: 400, epoch: 1 | loss: 0.3562175
	speed: 0.0024s/iter; left time: 18.9141s
	iters: 500, epoch: 1 | loss: 0.1722490
	speed: 0.0023s/iter; left time: 18.0036s
	iters: 600, epoch: 1 | loss: 0.2613948
	speed: 0.0023s/iter; left time: 17.9044s
	iters: 700, epoch: 1 | loss: 0.3931531
	speed: 0.0024s/iter; left time: 18.2214s
	iters: 800, epoch: 1 | loss: 0.3619711
	speed: 0.0024s/iter; left time: 18.0330s
	iters: 900, epoch: 1 | loss: 0.5164862
	speed: 0.0024s/iter; left time: 17.7148s
	iters: 1000, epoch: 1 | loss: 0.2755706
	speed: 0.0024s/iter; left time: 17.5469s
Updating learning rate to 0.0010093668138
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 2.722259521484375
Epoch: 1, Steps: 1045 | Train Loss: 0.3368840 Vali Loss: 0.2839849 Best vali loss: 0.2839849
	iters: 100, epoch: 2 | loss: 1.1098876
	speed: 0.0083s/iter; left time: 59.5651s
	iters: 200, epoch: 2 | loss: 2.1223700
	speed: 0.0023s/iter; left time: 16.6643s
	iters: 300, epoch: 2 | loss: 0.5972539
	speed: 0.0023s/iter; left time: 16.3454s
	iters: 400, epoch: 2 | loss: 0.2996816
	speed: 0.0023s/iter; left time: 16.0945s
	iters: 500, epoch: 2 | loss: 0.3462479
	speed: 0.0023s/iter; left time: 15.9750s
	iters: 600, epoch: 2 | loss: 0.2708194
	speed: 0.0024s/iter; left time: 15.8312s
	iters: 700, epoch: 2 | loss: 0.2427891
	speed: 0.0023s/iter; left time: 15.4308s
	iters: 800, epoch: 2 | loss: 0.5393879
	speed: 0.0023s/iter; left time: 15.1087s
	iters: 900, epoch: 2 | loss: 0.4481044
	speed: 0.0023s/iter; left time: 14.9420s
	iters: 1000, epoch: 2 | loss: 0.8907676
	speed: 0.0023s/iter; left time: 14.7315s
Updating learning rate to 0.0005046834069
Epoch: 2 cost time: 2.488354206085205
Epoch: 2, Steps: 1045 | Train Loss: 0.6867309 Vali Loss: 0.2872457 Best vali loss: 0.2839849
	iters: 100, epoch: 3 | loss: 1.0380900
	speed: 0.0078s/iter; left time: 48.0103s
	iters: 200, epoch: 3 | loss: 0.3291612
	speed: 0.0024s/iter; left time: 14.6140s
	iters: 300, epoch: 3 | loss: 0.6438898
	speed: 0.0025s/iter; left time: 14.6883s
	iters: 400, epoch: 3 | loss: 0.3296384
	speed: 0.0025s/iter; left time: 14.5120s
	iters: 500, epoch: 3 | loss: 0.4444216
	speed: 0.0024s/iter; left time: 13.7901s
	iters: 600, epoch: 3 | loss: 0.2283395
	speed: 0.0024s/iter; left time: 13.6625s
	iters: 700, epoch: 3 | loss: 0.2553506
	speed: 0.0023s/iter; left time: 12.9016s
	iters: 800, epoch: 3 | loss: 0.3709994
	speed: 0.0023s/iter; left time: 12.8229s
	iters: 900, epoch: 3 | loss: 0.4991037
	speed: 0.0023s/iter; left time: 12.4735s
	iters: 1000, epoch: 3 | loss: 0.3494121
	speed: 0.0023s/iter; left time: 12.1548s
Updating learning rate to 0.00025234170345
Epoch: 3 cost time: 2.516289710998535
Epoch: 3, Steps: 1045 | Train Loss: 0.4488406 Vali Loss: 0.2893637 Best vali loss: 0.2839849

best validation loss 0.28398492016859683

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597197
	speed: 0.0106s/iter; left time: 10.0478s
Updating learning rate to 0.00022560087439875675
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9388236999511719
Epoch: 1, Steps: 131 | Train Loss: 0.5597197 Vali Loss: 0.2756308 Best vali loss: 0.2756308
	iters: 100, epoch: 2 | loss: 0.3249927
	speed: 0.0088s/iter; left time: 7.2378s
Updating learning rate to 0.0002001813398498083
Validation loss decreased (0.2756 --> 0.2697).  Saving model state dict ...
Epoch: 2 cost time: 0.705622673034668
Epoch: 2, Steps: 131 | Train Loss: 0.3249927 Vali Loss: 0.2697049 Best vali loss: 0.2697049
	iters: 100, epoch: 3 | loss: 0.4631271
	speed: 0.0089s/iter; left time: 6.1466s
Updating learning rate to 0.0001621383179595776
Epoch: 3 cost time: 0.7025988101959229
Epoch: 3, Steps: 131 | Train Loss: 0.4631271 Vali Loss: 0.2785315 Best vali loss: 0.2697049

best validation loss 0.2697049226624321

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4215973
	speed: 0.0109s/iter; left time: 6.0596s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.9362061023712158
Epoch: 4, Steps: 131 | Train Loss: 0.4215973 Vali Loss: 0.2934066 Best vali loss: 0.2690257
	iters: 100, epoch: 5 | loss: 0.2674249
	speed: 0.0087s/iter; left time: 3.7061s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.6976792812347412
Epoch: 5, Steps: 131 | Train Loss: 0.2674249 Vali Loss: 0.2930243 Best vali loss: 0.2690257
	iters: 100, epoch: 6 | loss: 0.3831972
	speed: 0.0086s/iter; left time: 2.5187s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.6960964202880859
Epoch: 6, Steps: 131 | Train Loss: 0.3831972 Vali Loss: 0.2969673 Best vali loss: 0.2690257
	iters: 100, epoch: 7 | loss: 0.3989047
	speed: 0.0086s/iter; left time: 1.4067s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.697594165802002
Epoch: 7, Steps: 131 | Train Loss: 0.3989047 Vali Loss: 0.3018232 Best vali loss: 0.2690257
	iters: 100, epoch: 8 | loss: 0.2976196
	speed: 0.0086s/iter; left time: 0.2766s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7001526355743408
Epoch: 8, Steps: 131 | Train Loss: 0.2976196 Vali Loss: 0.3038442 Best vali loss: 0.2690257

best validation loss 0.26902565425459274

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6200969
	speed: 0.0092s/iter; left time: 8.7016s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 0.7714283466339111
Epoch: 1, Steps: 131 | Train Loss: 0.6200969 Vali Loss: 0.3112046 Best vali loss: 0.3112046
	iters: 100, epoch: 2 | loss: 0.6486596
	speed: 0.0066s/iter; left time: 5.4352s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.3112 --> 0.2948).  Saving model state dict ...
Epoch: 2 cost time: 0.534846305847168
Epoch: 2, Steps: 131 | Train Loss: 0.6486596 Vali Loss: 0.2948356 Best vali loss: 0.2948356
	iters: 100, epoch: 3 | loss: 0.3054149
	speed: 0.0066s/iter; left time: 4.5519s
Updating learning rate to 5.862147895e-05
Validation loss decreased (0.2948 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 0.5367872714996338
Epoch: 3, Steps: 131 | Train Loss: 0.3054149 Vali Loss: 0.2905855 Best vali loss: 0.2905855
	iters: 100, epoch: 4 | loss: 0.6913322
	speed: 0.0065s/iter; left time: 3.6398s
Updating learning rate to 2.9310739475e-05
Validation loss decreased (0.2906 --> 0.2884).  Saving model state dict ...
Epoch: 4 cost time: 0.5090253353118896
Epoch: 4, Steps: 131 | Train Loss: 0.6913322 Vali Loss: 0.2884130 Best vali loss: 0.2884130
	iters: 100, epoch: 5 | loss: 0.7064196
	speed: 0.0065s/iter; left time: 2.7505s
Updating learning rate to 1.46553697375e-05
Validation loss decreased (0.2884 --> 0.2876).  Saving model state dict ...
Epoch: 5 cost time: 0.5278129577636719
Epoch: 5, Steps: 131 | Train Loss: 0.7064196 Vali Loss: 0.2876385 Best vali loss: 0.2876385
	iters: 100, epoch: 6 | loss: 0.4942333
	speed: 0.0065s/iter; left time: 1.8994s
Updating learning rate to 7.32768486875e-06
Validation loss decreased (0.2876 --> 0.2873).  Saving model state dict ...
Epoch: 6 cost time: 0.5157265663146973
Epoch: 6, Steps: 131 | Train Loss: 0.4942333 Vali Loss: 0.2872721 Best vali loss: 0.2872721
	iters: 100, epoch: 7 | loss: 0.6860821
	speed: 0.0065s/iter; left time: 1.0538s
Updating learning rate to 3.663842434375e-06
Validation loss decreased (0.2873 --> 0.2871).  Saving model state dict ...
Epoch: 7 cost time: 0.5138742923736572
Epoch: 7, Steps: 131 | Train Loss: 0.6860821 Vali Loss: 0.2870618 Best vali loss: 0.2870618
	iters: 100, epoch: 8 | loss: 0.6469914
	speed: 0.0065s/iter; left time: 0.2070s
Updating learning rate to 1.8319212171875e-06
Validation loss decreased (0.2871 --> 0.2870).  Saving model state dict ...
Epoch: 8 cost time: 0.5142638683319092
Epoch: 8, Steps: 131 | Train Loss: 0.6469914 Vali Loss: 0.2869642 Best vali loss: 0.2869642

best validation loss 0.2869642387373202

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010266899409, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6200874
	speed: 0.0093s/iter; left time: 8.8057s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 0.7868382930755615
Epoch: 1, Steps: 131 | Train Loss: 0.6200874 Vali Loss: 0.3112004 Best vali loss: 0.3112004
	iters: 100, epoch: 2 | loss: 0.6486556
	speed: 0.0067s/iter; left time: 5.4706s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.3112 --> 0.2948).  Saving model state dict ...
Epoch: 2 cost time: 0.5226984024047852
Epoch: 2, Steps: 131 | Train Loss: 0.6486556 Vali Loss: 0.2948315 Best vali loss: 0.2948315
	iters: 100, epoch: 3 | loss: 0.3054087
	speed: 0.0067s/iter; left time: 4.6339s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2948 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 0.5421361923217773
Epoch: 3, Steps: 131 | Train Loss: 0.3054087 Vali Loss: 0.2905821 Best vali loss: 0.2905821
	iters: 100, epoch: 4 | loss: 0.6913305
	speed: 0.0065s/iter; left time: 3.6382s
Updating learning rate to 2.931587015e-05
Validation loss decreased (0.2906 --> 0.2884).  Saving model state dict ...
Epoch: 4 cost time: 0.5280239582061768
Epoch: 4, Steps: 131 | Train Loss: 0.6913305 Vali Loss: 0.2884096 Best vali loss: 0.2884096
	iters: 100, epoch: 5 | loss: 0.7064165
	speed: 0.0066s/iter; left time: 2.7861s
Updating learning rate to 1.4657935075e-05
Validation loss decreased (0.2884 --> 0.2876).  Saving model state dict ...
Epoch: 5 cost time: 0.5089309215545654
Epoch: 5, Steps: 131 | Train Loss: 0.7064165 Vali Loss: 0.2876355 Best vali loss: 0.2876355
	iters: 100, epoch: 6 | loss: 0.4942233
	speed: 0.0065s/iter; left time: 1.9251s
Updating learning rate to 7.3289675375e-06
Validation loss decreased (0.2876 --> 0.2873).  Saving model state dict ...
Epoch: 6 cost time: 0.527066707611084
Epoch: 6, Steps: 131 | Train Loss: 0.4942233 Vali Loss: 0.2872692 Best vali loss: 0.2872692
	iters: 100, epoch: 7 | loss: 0.6860790
	speed: 0.0066s/iter; left time: 1.0788s
Updating learning rate to 3.66448376875e-06
Validation loss decreased (0.2873 --> 0.2871).  Saving model state dict ...
Epoch: 7 cost time: 0.5327959060668945
Epoch: 7, Steps: 131 | Train Loss: 0.6860790 Vali Loss: 0.2870589 Best vali loss: 0.2870589
	iters: 100, epoch: 8 | loss: 0.6469852
	speed: 0.0066s/iter; left time: 0.2103s
Updating learning rate to 1.832241884375e-06
Validation loss decreased (0.2871 --> 0.2870).  Saving model state dict ...
Epoch: 8 cost time: 0.5239746570587158
Epoch: 8, Steps: 131 | Train Loss: 0.6469852 Vali Loss: 0.2869612 Best vali loss: 0.2869612

best validation loss 0.28696118160533657

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6200867
	speed: 0.0094s/iter; left time: 8.9457s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 0.7897298336029053
Epoch: 1, Steps: 131 | Train Loss: 0.6200867 Vali Loss: 0.3112002 Best vali loss: 0.3112002
	iters: 100, epoch: 2 | loss: 0.6486554
	speed: 0.0066s/iter; left time: 5.4140s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.3112 --> 0.2948).  Saving model state dict ...
Epoch: 2 cost time: 0.5065226554870605
Epoch: 2, Steps: 131 | Train Loss: 0.6486554 Vali Loss: 0.2948313 Best vali loss: 0.2948313
	iters: 100, epoch: 3 | loss: 0.3054085
	speed: 0.0067s/iter; left time: 4.5922s
Updating learning rate to 5.863230085e-05
Validation loss decreased (0.2948 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 0.5480597019195557
Epoch: 3, Steps: 131 | Train Loss: 0.3054085 Vali Loss: 0.2905819 Best vali loss: 0.2905819

best validation loss 0.2905818976714027

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2760).  Saving model state dict ...
Epoch: 1 cost time: 0.7807009220123291
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2760466 Best vali loss: 0.2760466
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2760 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 0.5421178340911865
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2742443 Best vali loss: 0.2742443
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.5528414249420166
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2761830 Best vali loss: 0.2742443

best validation loss 0.2742443340402768

[INFO][smbo.py:320] Finished 650 trials.
{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0010743890251, 'e_layers': 3, 'learning_rate': 0.0019967040396, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0019967040396
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 0.6248135566711426
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2844274 Best vali loss: 0.2844274
Updating learning rate to 0.0009983520198
Validation loss decreased (0.2844 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 0.39188551902770996
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2780959 Best vali loss: 0.2780959
Updating learning rate to 0.0004991760099
Epoch: 3 cost time: 0.3825232982635498
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2823310 Best vali loss: 0.2780959

best validation loss 0.2780959273679144

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.7724649906158447
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2873344 Best vali loss: 0.2742443
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.5420739650726318
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2869057 Best vali loss: 0.2742443
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.5491824150085449
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3015475 Best vali loss: 0.2742443
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.5467479228973389
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2948439 Best vali loss: 0.2742443
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5424563884735107
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2942845 Best vali loss: 0.2742443

best validation loss 0.2742443340402768

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0032179734888, 'e_layers': 4, 'learning_rate': 0.000139589496, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2424309
	speed: 0.0109s/iter; left time: 90.4470s
	iters: 200, epoch: 1 | loss: 0.2803212
	speed: 0.0051s/iter; left time: 41.9796s
	iters: 300, epoch: 1 | loss: 0.7586770
	speed: 0.0051s/iter; left time: 41.3898s
	iters: 400, epoch: 1 | loss: 1.1519227
	speed: 0.0052s/iter; left time: 41.3419s
	iters: 500, epoch: 1 | loss: 0.5520750
	speed: 0.0052s/iter; left time: 41.0110s
	iters: 600, epoch: 1 | loss: 0.2392525
	speed: 0.0051s/iter; left time: 39.5838s
	iters: 700, epoch: 1 | loss: 0.3379192
	speed: 0.0051s/iter; left time: 39.3986s
	iters: 800, epoch: 1 | loss: 0.2564037
	speed: 0.0051s/iter; left time: 38.7739s
	iters: 900, epoch: 1 | loss: 1.4143078
	speed: 0.0051s/iter; left time: 38.0584s
	iters: 1000, epoch: 1 | loss: 0.2775576
	speed: 0.0052s/iter; left time: 37.9287s
Updating learning rate to 0.00013427668715398306
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 5.636361837387085
Epoch: 1, Steps: 1045 | Train Loss: 0.5510868 Vali Loss: 0.2840387 Best vali loss: 0.2840387
	iters: 100, epoch: 2 | loss: 0.8717600
	speed: 0.0147s/iter; left time: 105.8280s
	iters: 200, epoch: 2 | loss: 0.2375886
	speed: 0.0052s/iter; left time: 37.1671s
	iters: 300, epoch: 2 | loss: 0.3125334
	speed: 0.0052s/iter; left time: 36.5519s
	iters: 400, epoch: 2 | loss: 0.5038072
	speed: 0.0052s/iter; left time: 36.0291s
	iters: 500, epoch: 2 | loss: 0.7261542
	speed: 0.0052s/iter; left time: 35.3202s
	iters: 600, epoch: 2 | loss: 0.6130418
	speed: 0.0052s/iter; left time: 34.8497s
	iters: 700, epoch: 2 | loss: 0.9149454
	speed: 0.0052s/iter; left time: 34.5396s
	iters: 800, epoch: 2 | loss: 0.6899634
	speed: 0.0052s/iter; left time: 33.7907s
	iters: 900, epoch: 2 | loss: 0.2563638
	speed: 0.0051s/iter; left time: 32.9970s
	iters: 1000, epoch: 2 | loss: 0.3440031
	speed: 0.0052s/iter; left time: 32.8195s
Updating learning rate to 0.00011914708760200622
Epoch: 2 cost time: 5.4723896980285645
Epoch: 2, Steps: 1045 | Train Loss: 0.5470161 Vali Loss: 0.2946888 Best vali loss: 0.2840387
	iters: 100, epoch: 3 | loss: 0.2013431
	speed: 0.0138s/iter; left time: 85.3228s
	iters: 200, epoch: 3 | loss: 0.7203001
	speed: 0.0045s/iter; left time: 27.1924s
	iters: 300, epoch: 3 | loss: 0.2684289
	speed: 0.0045s/iter; left time: 26.7752s
	iters: 400, epoch: 3 | loss: 0.2573219
	speed: 0.0045s/iter; left time: 26.1457s
	iters: 500, epoch: 3 | loss: 0.2136058
	speed: 0.0045s/iter; left time: 25.8388s
	iters: 600, epoch: 3 | loss: 0.4582606
	speed: 0.0044s/iter; left time: 25.1494s
	iters: 700, epoch: 3 | loss: 0.4713858
	speed: 0.0044s/iter; left time: 24.6879s
	iters: 800, epoch: 3 | loss: 0.2029952
	speed: 0.0045s/iter; left time: 24.3838s
	iters: 900, epoch: 3 | loss: 0.4207447
	speed: 0.0045s/iter; left time: 24.3185s
	iters: 1000, epoch: 3 | loss: 0.3608766
	speed: 0.0045s/iter; left time: 23.7341s
Updating learning rate to 9.650404172569649e-05
Validation loss decreased (0.2840 --> 0.2778).  Saving model state dict ...
Epoch: 3 cost time: 4.707558870315552
Epoch: 3, Steps: 1045 | Train Loss: 0.3575263 Vali Loss: 0.2777717 Best vali loss: 0.2777717
	iters: 100, epoch: 4 | loss: 0.3010463
	speed: 0.0136s/iter; left time: 69.5686s
	iters: 200, epoch: 4 | loss: 0.5324020
	speed: 0.0049s/iter; left time: 24.4506s
	iters: 300, epoch: 4 | loss: 0.4856012
	speed: 0.0048s/iter; left time: 23.8057s
	iters: 400, epoch: 4 | loss: 0.1841349
	speed: 0.0048s/iter; left time: 23.3412s
	iters: 500, epoch: 4 | loss: 0.3033450
	speed: 0.0049s/iter; left time: 22.9801s
	iters: 600, epoch: 4 | loss: 0.1615934
	speed: 0.0049s/iter; left time: 22.6234s
	iters: 700, epoch: 4 | loss: 0.3623082
	speed: 0.0048s/iter; left time: 21.9428s
	iters: 800, epoch: 4 | loss: 0.5044892
	speed: 0.0049s/iter; left time: 21.4886s
	iters: 900, epoch: 4 | loss: 0.2133269
	speed: 0.0049s/iter; left time: 21.0436s
	iters: 1000, epoch: 4 | loss: 0.2144413
	speed: 0.0049s/iter; left time: 20.5747s
Updating learning rate to 6.9794748e-05
Validation loss decreased (0.2778 --> 0.2766).  Saving model state dict ...
Epoch: 4 cost time: 5.11038064956665
Epoch: 4, Steps: 1045 | Train Loss: 0.3262688 Vali Loss: 0.2766072 Best vali loss: 0.2766072
	iters: 100, epoch: 5 | loss: 0.5863203
	speed: 0.0139s/iter; left time: 56.7711s
	iters: 200, epoch: 5 | loss: 0.8102961
	speed: 0.0049s/iter; left time: 19.4717s
	iters: 300, epoch: 5 | loss: 0.3833536
	speed: 0.0049s/iter; left time: 19.1759s
	iters: 400, epoch: 5 | loss: 0.5285568
	speed: 0.0049s/iter; left time: 18.3619s
	iters: 500, epoch: 5 | loss: 0.4380239
	speed: 0.0048s/iter; left time: 17.8339s
	iters: 600, epoch: 5 | loss: 0.2951755
	speed: 0.0048s/iter; left time: 17.3132s
	iters: 700, epoch: 5 | loss: 0.1749775
	speed: 0.0049s/iter; left time: 16.9461s
	iters: 800, epoch: 5 | loss: 0.4444875
	speed: 0.0048s/iter; left time: 16.3790s
	iters: 900, epoch: 5 | loss: 0.1899081
	speed: 0.0048s/iter; left time: 15.9058s
	iters: 1000, epoch: 5 | loss: 0.2952746
	speed: 0.0049s/iter; left time: 15.5042s
Updating learning rate to 4.3085454274303516e-05
Epoch: 5 cost time: 5.13015079498291
Epoch: 5, Steps: 1045 | Train Loss: 0.4146374 Vali Loss: 0.2801043 Best vali loss: 0.2766072
	iters: 100, epoch: 6 | loss: 0.3842018
	speed: 0.0134s/iter; left time: 40.5964s
	iters: 200, epoch: 6 | loss: 0.2267136
	speed: 0.0046s/iter; left time: 13.5685s
	iters: 300, epoch: 6 | loss: 0.2185452
	speed: 0.0046s/iter; left time: 13.1097s
	iters: 400, epoch: 6 | loss: 0.7140107
	speed: 0.0047s/iter; left time: 12.9190s
	iters: 500, epoch: 6 | loss: 0.2245784
	speed: 0.0048s/iter; left time: 12.7609s
	iters: 600, epoch: 6 | loss: 0.2370866
	speed: 0.0048s/iter; left time: 12.1481s
	iters: 700, epoch: 6 | loss: 0.1514656
	speed: 0.0048s/iter; left time: 11.7655s
	iters: 800, epoch: 6 | loss: 0.4191965
	speed: 0.0048s/iter; left time: 11.2811s
	iters: 900, epoch: 6 | loss: 0.5333442
	speed: 0.0048s/iter; left time: 10.7309s
	iters: 1000, epoch: 6 | loss: 0.4760494
	speed: 0.0048s/iter; left time: 10.2108s
Updating learning rate to 2.0442408397993776e-05
Epoch: 6 cost time: 4.998902797698975
Epoch: 6, Steps: 1045 | Train Loss: 0.3585192 Vali Loss: 0.2861902 Best vali loss: 0.2766072
	iters: 100, epoch: 7 | loss: 0.8804879
	speed: 0.0132s/iter; left time: 26.3162s
	iters: 200, epoch: 7 | loss: 0.2703411
	speed: 0.0045s/iter; left time: 8.5490s
	iters: 300, epoch: 7 | loss: 0.5776670
	speed: 0.0045s/iter; left time: 8.0362s
	iters: 400, epoch: 7 | loss: 0.1634730
	speed: 0.0045s/iter; left time: 7.5729s
	iters: 500, epoch: 7 | loss: 0.2929199
	speed: 0.0047s/iter; left time: 7.4115s
	iters: 600, epoch: 7 | loss: 0.3075141
	speed: 0.0047s/iter; left time: 7.0721s
	iters: 700, epoch: 7 | loss: 0.6815363
	speed: 0.0048s/iter; left time: 6.6124s
	iters: 800, epoch: 7 | loss: 0.3609118
	speed: 0.0048s/iter; left time: 6.2081s
	iters: 900, epoch: 7 | loss: 0.3766348
	speed: 0.0047s/iter; left time: 5.6278s
	iters: 1000, epoch: 7 | loss: 0.4002637
	speed: 0.0048s/iter; left time: 5.1993s
Updating learning rate to 5.312808846016934e-06
Epoch: 7 cost time: 4.896847486495972
Epoch: 7, Steps: 1045 | Train Loss: 0.4311750 Vali Loss: 0.2869090 Best vali loss: 0.2766072
	iters: 100, epoch: 8 | loss: 0.2034569
	speed: 0.0133s/iter; left time: 12.5479s
	iters: 200, epoch: 8 | loss: 0.4455377
	speed: 0.0046s/iter; left time: 3.8708s
	iters: 300, epoch: 8 | loss: 0.3114263
	speed: 0.0046s/iter; left time: 3.4293s
	iters: 400, epoch: 8 | loss: 0.2768115
	speed: 0.0046s/iter; left time: 2.9712s
	iters: 500, epoch: 8 | loss: 0.2619627
	speed: 0.0046s/iter; left time: 2.5342s
	iters: 600, epoch: 8 | loss: 0.3116060
	speed: 0.0047s/iter; left time: 2.0840s
	iters: 700, epoch: 8 | loss: 0.4067634
	speed: 0.0047s/iter; left time: 1.6258s
	iters: 800, epoch: 8 | loss: 0.2776799
	speed: 0.0046s/iter; left time: 1.1219s
	iters: 900, epoch: 8 | loss: 0.1694665
	speed: 0.0049s/iter; left time: 0.7180s
	iters: 1000, epoch: 8 | loss: 0.2790786
	speed: 0.0049s/iter; left time: 0.2245s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.927691221237183
Epoch: 8, Steps: 1045 | Train Loss: 0.2943789 Vali Loss: 0.2895374 Best vali loss: 0.2766072

best validation loss 0.2766072404411212

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345067337, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3662866
	speed: 0.0094s/iter; left time: 77.2762s
	iters: 200, epoch: 1 | loss: 0.2519830
	speed: 0.0034s/iter; left time: 27.4928s
	iters: 300, epoch: 1 | loss: 0.2990759
	speed: 0.0034s/iter; left time: 27.1103s
	iters: 400, epoch: 1 | loss: 0.2896078
	speed: 0.0033s/iter; left time: 26.5636s
	iters: 500, epoch: 1 | loss: 0.1778107
	speed: 0.0034s/iter; left time: 26.4102s
	iters: 600, epoch: 1 | loss: 0.1719901
	speed: 0.0034s/iter; left time: 26.1221s
	iters: 700, epoch: 1 | loss: 0.7615879
	speed: 0.0033s/iter; left time: 25.4886s
	iters: 800, epoch: 1 | loss: 0.3483056
	speed: 0.0033s/iter; left time: 25.2485s
	iters: 900, epoch: 1 | loss: 0.2647784
	speed: 0.0034s/iter; left time: 25.0178s
	iters: 1000, epoch: 1 | loss: 0.5971620
	speed: 0.0033s/iter; left time: 24.6452s
Updating learning rate to 0.0002345067337
Validation loss decreased (inf --> 0.2973).  Saving model state dict ...
Epoch: 1 cost time: 3.7745063304901123
Epoch: 1, Steps: 1045 | Train Loss: 0.3528588 Vali Loss: 0.2973267 Best vali loss: 0.2973267
	iters: 100, epoch: 2 | loss: 0.8725691
	speed: 0.0104s/iter; left time: 75.3530s
	iters: 200, epoch: 2 | loss: 0.4148460
	speed: 0.0033s/iter; left time: 23.8229s
	iters: 300, epoch: 2 | loss: 0.3185151
	speed: 0.0034s/iter; left time: 23.9351s
	iters: 400, epoch: 2 | loss: 0.5257099
	speed: 0.0035s/iter; left time: 24.2688s
	iters: 500, epoch: 2 | loss: 0.4089536
	speed: 0.0034s/iter; left time: 23.3401s
	iters: 600, epoch: 2 | loss: 0.3203601
	speed: 0.0035s/iter; left time: 23.6862s
	iters: 700, epoch: 2 | loss: 0.6432111
	speed: 0.0036s/iter; left time: 23.5395s
	iters: 800, epoch: 2 | loss: 0.3165636
	speed: 0.0034s/iter; left time: 22.4600s
	iters: 900, epoch: 2 | loss: 0.8389971
	speed: 0.0035s/iter; left time: 22.3975s
	iters: 1000, epoch: 2 | loss: 0.1723878
	speed: 0.0036s/iter; left time: 22.5548s
Updating learning rate to 0.00011725336685
Validation loss decreased (0.2973 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 3.663224220275879
Epoch: 2, Steps: 1045 | Train Loss: 0.4832113 Vali Loss: 0.2811912 Best vali loss: 0.2811912
	iters: 100, epoch: 3 | loss: 0.4447874
	speed: 0.0103s/iter; left time: 63.6998s
	iters: 200, epoch: 3 | loss: 0.5905567
	speed: 0.0030s/iter; left time: 18.5147s
	iters: 300, epoch: 3 | loss: 0.4467819
	speed: 0.0030s/iter; left time: 18.1655s
	iters: 400, epoch: 3 | loss: 0.1988893
	speed: 0.0030s/iter; left time: 17.8303s
	iters: 500, epoch: 3 | loss: 0.3574716
	speed: 0.0030s/iter; left time: 17.5412s
	iters: 600, epoch: 3 | loss: 0.1177821
	speed: 0.0031s/iter; left time: 17.3556s
	iters: 700, epoch: 3 | loss: 1.1435879
	speed: 0.0031s/iter; left time: 17.0456s
	iters: 800, epoch: 3 | loss: 0.9259489
	speed: 0.0030s/iter; left time: 16.6414s
	iters: 900, epoch: 3 | loss: 0.2911123
	speed: 0.0031s/iter; left time: 16.4189s
	iters: 1000, epoch: 3 | loss: 0.6706609
	speed: 0.0030s/iter; left time: 15.9293s
Updating learning rate to 5.8626683425e-05
Epoch: 3 cost time: 3.2208104133605957
Epoch: 3, Steps: 1045 | Train Loss: 0.5187579 Vali Loss: 0.2873242 Best vali loss: 0.2811912
	iters: 100, epoch: 4 | loss: 0.5330635
	speed: 0.0096s/iter; left time: 49.1036s
	iters: 200, epoch: 4 | loss: 0.4644775
	speed: 0.0031s/iter; left time: 15.5637s
	iters: 300, epoch: 4 | loss: 0.2490766
	speed: 0.0031s/iter; left time: 15.4297s
	iters: 400, epoch: 4 | loss: 0.2916009
	speed: 0.0031s/iter; left time: 15.1203s
	iters: 500, epoch: 4 | loss: 0.5684797
	speed: 0.0031s/iter; left time: 14.6003s
	iters: 600, epoch: 4 | loss: 0.5715805
	speed: 0.0032s/iter; left time: 14.5733s
	iters: 700, epoch: 4 | loss: 0.2762434
	speed: 0.0032s/iter; left time: 14.3624s
	iters: 800, epoch: 4 | loss: 0.4253508
	speed: 0.0031s/iter; left time: 13.7476s
	iters: 900, epoch: 4 | loss: 0.2478258
	speed: 0.0030s/iter; left time: 13.1500s
	iters: 1000, epoch: 4 | loss: 0.2996612
	speed: 0.0031s/iter; left time: 12.9296s
Updating learning rate to 2.93133417125e-05
Epoch: 4 cost time: 3.278564453125
Epoch: 4, Steps: 1045 | Train Loss: 0.3927360 Vali Loss: 0.2821652 Best vali loss: 0.2811912
	iters: 100, epoch: 5 | loss: 0.6559723
	speed: 0.0102s/iter; left time: 41.5292s
	iters: 200, epoch: 5 | loss: 0.3092171
	speed: 0.0033s/iter; left time: 13.2459s
	iters: 300, epoch: 5 | loss: 0.2929865
	speed: 0.0033s/iter; left time: 12.9308s
	iters: 400, epoch: 5 | loss: 0.8343179
	speed: 0.0033s/iter; left time: 12.6524s
	iters: 500, epoch: 5 | loss: 0.3294075
	speed: 0.0035s/iter; left time: 12.8981s
	iters: 600, epoch: 5 | loss: 0.6487579
	speed: 0.0034s/iter; left time: 12.1810s
	iters: 700, epoch: 5 | loss: 0.2091836
	speed: 0.0035s/iter; left time: 12.0649s
	iters: 800, epoch: 5 | loss: 0.2461551
	speed: 0.0035s/iter; left time: 11.9366s
	iters: 900, epoch: 5 | loss: 0.2394302
	speed: 0.0034s/iter; left time: 11.0562s
	iters: 1000, epoch: 5 | loss: 0.4373182
	speed: 0.0034s/iter; left time: 10.7783s
Updating learning rate to 1.465667085625e-05
Epoch: 5 cost time: 3.589489459991455
Epoch: 5, Steps: 1045 | Train Loss: 0.4202746 Vali Loss: 0.2817643 Best vali loss: 0.2811912
	iters: 100, epoch: 6 | loss: 0.1963138
	speed: 0.0103s/iter; left time: 31.1747s
	iters: 200, epoch: 6 | loss: 0.2871098
	speed: 0.0033s/iter; left time: 9.8138s
	iters: 300, epoch: 6 | loss: 0.4287185
	speed: 0.0033s/iter; left time: 9.4200s
	iters: 400, epoch: 6 | loss: 0.4892072
	speed: 0.0033s/iter; left time: 9.0232s
	iters: 500, epoch: 6 | loss: 0.1215277
	speed: 0.0033s/iter; left time: 8.7859s
	iters: 600, epoch: 6 | loss: 0.5133743
	speed: 0.0033s/iter; left time: 8.3700s
	iters: 700, epoch: 6 | loss: 0.7719513
	speed: 0.0033s/iter; left time: 8.1216s
	iters: 800, epoch: 6 | loss: 0.1428213
	speed: 0.0033s/iter; left time: 7.7191s
	iters: 900, epoch: 6 | loss: 0.2839471
	speed: 0.0033s/iter; left time: 7.2684s
	iters: 1000, epoch: 6 | loss: 0.3551351
	speed: 0.0033s/iter; left time: 7.0261s
Updating learning rate to 7.328335428125e-06
Epoch: 6 cost time: 3.5028088092803955
Epoch: 6, Steps: 1045 | Train Loss: 0.3590106 Vali Loss: 0.2870413 Best vali loss: 0.2811912
	iters: 100, epoch: 7 | loss: 0.6958091
	speed: 0.0101s/iter; left time: 20.0396s
	iters: 200, epoch: 7 | loss: 0.9336030
	speed: 0.0033s/iter; left time: 6.2344s
	iters: 300, epoch: 7 | loss: 0.5571445
	speed: 0.0033s/iter; left time: 5.9100s
	iters: 400, epoch: 7 | loss: 0.1475450
	speed: 0.0033s/iter; left time: 5.6197s
	iters: 500, epoch: 7 | loss: 0.8136707
	speed: 0.0033s/iter; left time: 5.2413s
	iters: 600, epoch: 7 | loss: 0.4093769
	speed: 0.0033s/iter; left time: 4.9312s
	iters: 700, epoch: 7 | loss: 0.6462408
	speed: 0.0033s/iter; left time: 4.6466s
	iters: 800, epoch: 7 | loss: 0.4259056
	speed: 0.0033s/iter; left time: 4.2530s
	iters: 900, epoch: 7 | loss: 0.2270194
	speed: 0.0033s/iter; left time: 3.9663s
	iters: 1000, epoch: 7 | loss: 0.2053712
	speed: 0.0033s/iter; left time: 3.6427s
Updating learning rate to 3.6641677140625e-06
Epoch: 7 cost time: 3.4986438751220703
Epoch: 7, Steps: 1045 | Train Loss: 0.5061686 Vali Loss: 0.2849474 Best vali loss: 0.2811912
	iters: 100, epoch: 8 | loss: 0.5452941
	speed: 0.0099s/iter; left time: 9.3911s
	iters: 200, epoch: 8 | loss: 0.2174318
	speed: 0.0033s/iter; left time: 2.7892s
	iters: 300, epoch: 8 | loss: 0.2104712
	speed: 0.0033s/iter; left time: 2.4714s
	iters: 400, epoch: 8 | loss: 0.3784521
	speed: 0.0033s/iter; left time: 2.1382s
	iters: 500, epoch: 8 | loss: 0.1247797
	speed: 0.0033s/iter; left time: 1.8046s
	iters: 600, epoch: 8 | loss: 0.5319663
	speed: 0.0033s/iter; left time: 1.4814s
	iters: 700, epoch: 8 | loss: 0.2788720
	speed: 0.0032s/iter; left time: 1.1024s
	iters: 800, epoch: 8 | loss: 0.1757125
	speed: 0.0030s/iter; left time: 0.7380s
	iters: 900, epoch: 8 | loss: 0.1493718
	speed: 0.0031s/iter; left time: 0.4455s
	iters: 1000, epoch: 8 | loss: 0.7860122
	speed: 0.0030s/iter; left time: 0.1401s
Updating learning rate to 1.83208385703125e-06
Epoch: 8 cost time: 3.364288330078125
Epoch: 8, Steps: 1045 | Train Loss: 0.3398364 Vali Loss: 0.2857239 Best vali loss: 0.2811912

best validation loss 0.28119116270129857

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3662878
	speed: 0.0091s/iter; left time: 75.0907s
	iters: 200, epoch: 1 | loss: 0.2519819
	speed: 0.0033s/iter; left time: 27.1261s
	iters: 300, epoch: 1 | loss: 0.2990686
	speed: 0.0032s/iter; left time: 25.4431s
	iters: 400, epoch: 1 | loss: 0.2895899
	speed: 0.0031s/iter; left time: 24.6998s
	iters: 500, epoch: 1 | loss: 0.1778894
	speed: 0.0031s/iter; left time: 24.3809s
	iters: 600, epoch: 1 | loss: 0.1711106
	speed: 0.0034s/iter; left time: 26.1044s
	iters: 700, epoch: 1 | loss: 0.7751127
	speed: 0.0033s/iter; left time: 25.6037s
	iters: 800, epoch: 1 | loss: 0.3494189
	speed: 0.0030s/iter; left time: 22.9044s
	iters: 900, epoch: 1 | loss: 0.2726506
	speed: 0.0032s/iter; left time: 24.0594s
	iters: 1000, epoch: 1 | loss: 0.5939379
	speed: 0.0033s/iter; left time: 24.4302s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 3.627335548400879
Epoch: 1, Steps: 1045 | Train Loss: 0.3547048 Vali Loss: 0.2939869 Best vali loss: 0.2939869
	iters: 100, epoch: 2 | loss: 0.8489887
	speed: 0.0102s/iter; left time: 73.8474s
	iters: 200, epoch: 2 | loss: 0.4129914
	speed: 0.0033s/iter; left time: 23.6973s
	iters: 300, epoch: 2 | loss: 0.3260498
	speed: 0.0033s/iter; left time: 23.1368s
	iters: 400, epoch: 2 | loss: 0.4904910
	speed: 0.0033s/iter; left time: 23.0742s
	iters: 500, epoch: 2 | loss: 0.3575651
	speed: 0.0033s/iter; left time: 22.7072s
	iters: 600, epoch: 2 | loss: 0.3113535
	speed: 0.0033s/iter; left time: 22.4244s
	iters: 700, epoch: 2 | loss: 0.6567472
	speed: 0.0033s/iter; left time: 22.0679s
	iters: 800, epoch: 2 | loss: 0.3184907
	speed: 0.0035s/iter; left time: 22.6892s
	iters: 900, epoch: 2 | loss: 0.7265348
	speed: 0.0034s/iter; left time: 21.7115s
	iters: 1000, epoch: 2 | loss: 0.1850266
	speed: 0.0033s/iter; left time: 20.6801s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2940 --> 0.2802).  Saving model state dict ...
Epoch: 2 cost time: 3.5291848182678223
Epoch: 2, Steps: 1045 | Train Loss: 0.4634239 Vali Loss: 0.2802070 Best vali loss: 0.2802070
	iters: 100, epoch: 3 | loss: 0.4271829
	speed: 0.0104s/iter; left time: 63.8930s
	iters: 200, epoch: 3 | loss: 0.5670783
	speed: 0.0033s/iter; left time: 20.2357s
	iters: 300, epoch: 3 | loss: 0.4785488
	speed: 0.0034s/iter; left time: 20.1196s
	iters: 400, epoch: 3 | loss: 0.1918799
	speed: 0.0034s/iter; left time: 19.9083s
	iters: 500, epoch: 3 | loss: 0.3649670
	speed: 0.0033s/iter; left time: 19.2127s
	iters: 600, epoch: 3 | loss: 0.1200558
	speed: 0.0035s/iter; left time: 19.6130s
	iters: 700, epoch: 3 | loss: 0.8997669
	speed: 0.0034s/iter; left time: 19.0302s
	iters: 800, epoch: 3 | loss: 0.9353561
	speed: 0.0033s/iter; left time: 18.1046s
	iters: 900, epoch: 3 | loss: 0.2413652
	speed: 0.0035s/iter; left time: 18.6958s
	iters: 1000, epoch: 3 | loss: 0.6275331
	speed: 0.0035s/iter; left time: 18.2268s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2802 --> 0.2799).  Saving model state dict ...
Epoch: 3 cost time: 3.5722293853759766
Epoch: 3, Steps: 1045 | Train Loss: 0.4853734 Vali Loss: 0.2799349 Best vali loss: 0.2799349

best validation loss 0.2799348621485445

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010260391019, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5896323
	speed: 0.0100s/iter; left time: 9.4645s
Updating learning rate to 0.00022560296709871823
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.7934598922729492
Epoch: 1, Steps: 131 | Train Loss: 0.5896323 Vali Loss: 0.2829059 Best vali loss: 0.2829059
	iters: 100, epoch: 2 | loss: 0.6386315
	speed: 0.0071s/iter; left time: 5.8020s
Updating learning rate to 0.00020018319675520953
Validation loss decreased (0.2829 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 0.5636909008026123
Epoch: 2, Steps: 131 | Train Loss: 0.6386315 Vali Loss: 0.2825095 Best vali loss: 0.2825095
	iters: 100, epoch: 3 | loss: 0.5850947
	speed: 0.0070s/iter; left time: 4.7979s
Updating learning rate to 0.00016213982197348114
Validation loss decreased (0.2825 --> 0.2793).  Saving model state dict ...
Epoch: 3 cost time: 0.5421984195709229
Epoch: 3, Steps: 131 | Train Loss: 0.5850947 Vali Loss: 0.2793341 Best vali loss: 0.2793341

best validation loss 0.27933414059307726

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002345436852, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5896267
	speed: 0.0100s/iter; left time: 9.4847s
Updating learning rate to 0.0002345436852
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.8149607181549072
Epoch: 1, Steps: 131 | Train Loss: 0.5896267 Vali Loss: 0.2829005 Best vali loss: 0.2829005
	iters: 100, epoch: 2 | loss: 0.6394133
	speed: 0.0067s/iter; left time: 5.5005s
Updating learning rate to 0.0001172718426
Validation loss decreased (0.2829 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.5041491985321045
Epoch: 2, Steps: 131 | Train Loss: 0.6394133 Vali Loss: 0.2826238 Best vali loss: 0.2826238
	iters: 100, epoch: 3 | loss: 0.5791202
	speed: 0.0068s/iter; left time: 4.6712s
Updating learning rate to 5.86359213e-05
Validation loss decreased (0.2826 --> 0.2799).  Saving model state dict ...
Epoch: 3 cost time: 0.5412800312042236
Epoch: 3, Steps: 131 | Train Loss: 0.5791202 Vali Loss: 0.2798876 Best vali loss: 0.2798876

best validation loss 0.27988755090079726

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010260391019, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5220163
	speed: 0.0100s/iter; left time: 5.5816s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2793 --> 0.2787).  Saving model state dict ...
Epoch: 4 cost time: 0.790097713470459
Epoch: 4, Steps: 131 | Train Loss: 0.5220163 Vali Loss: 0.2787466 Best vali loss: 0.2787466
	iters: 100, epoch: 5 | loss: 0.5467114
	speed: 0.0071s/iter; left time: 3.0182s
Updating learning rate to 7.238938142651887e-05
Epoch: 5 cost time: 0.5721225738525391
Epoch: 5, Steps: 131 | Train Loss: 0.5467114 Vali Loss: 0.2838427 Best vali loss: 0.2787466
	iters: 100, epoch: 6 | loss: 0.4869352
	speed: 0.0069s/iter; left time: 2.0283s
Updating learning rate to 3.434600664479046e-05
Epoch: 6 cost time: 0.5533626079559326
Epoch: 6, Steps: 131 | Train Loss: 0.4869352 Vali Loss: 0.2883693 Best vali loss: 0.2787466
	iters: 100, epoch: 7 | loss: 0.4522417
	speed: 0.0067s/iter; left time: 1.0863s
Updating learning rate to 8.92623630128176e-06
Epoch: 7 cost time: 0.5264124870300293
Epoch: 7, Steps: 131 | Train Loss: 0.4522417 Vali Loss: 0.2930934 Best vali loss: 0.2787466
	iters: 100, epoch: 8 | loss: 0.3894577
	speed: 0.0069s/iter; left time: 0.2223s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5587344169616699
Epoch: 8, Steps: 131 | Train Loss: 0.3894577 Vali Loss: 0.2891597 Best vali loss: 0.2787466

best validation loss 0.2787465894918275

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 4, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4539977
	speed: 0.0154s/iter; left time: 14.5731s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.5219249725341797
Epoch: 1, Steps: 131 | Train Loss: 0.4539977 Vali Loss: 0.2814205 Best vali loss: 0.2814205
	iters: 100, epoch: 2 | loss: 0.4844173
	speed: 0.0156s/iter; left time: 12.7551s
Updating learning rate to 0.0001172429579
Epoch: 2 cost time: 1.2945785522460938
Epoch: 2, Steps: 131 | Train Loss: 0.4844173 Vali Loss: 0.3049334 Best vali loss: 0.2814205
	iters: 100, epoch: 3 | loss: 0.3939325
	speed: 0.0151s/iter; left time: 10.3989s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 1.2915558815002441
Epoch: 3, Steps: 131 | Train Loss: 0.3939325 Vali Loss: 0.2928709 Best vali loss: 0.2814205
	iters: 100, epoch: 4 | loss: 0.3865761
	speed: 0.0151s/iter; left time: 8.3973s
Updating learning rate to 2.9310739475e-05
Validation loss decreased (0.2814 --> 0.2791).  Saving model state dict ...
Epoch: 4 cost time: 1.2845618724822998
Epoch: 4, Steps: 131 | Train Loss: 0.3865761 Vali Loss: 0.2790508 Best vali loss: 0.2790508
	iters: 100, epoch: 5 | loss: 0.4588301
	speed: 0.0158s/iter; left time: 6.7269s
Updating learning rate to 1.46553697375e-05
Epoch: 5 cost time: 1.2931528091430664
Epoch: 5, Steps: 131 | Train Loss: 0.4588301 Vali Loss: 0.3043781 Best vali loss: 0.2790508
	iters: 100, epoch: 6 | loss: 0.4844358
	speed: 0.0152s/iter; left time: 4.4580s
Updating learning rate to 7.32768486875e-06
Epoch: 6 cost time: 1.289989709854126
Epoch: 6, Steps: 131 | Train Loss: 0.4844358 Vali Loss: 0.2943177 Best vali loss: 0.2790508
	iters: 100, epoch: 7 | loss: 0.3836366
	speed: 0.0152s/iter; left time: 2.4756s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 1.294482707977295
Epoch: 7, Steps: 131 | Train Loss: 0.3836366 Vali Loss: 0.2967826 Best vali loss: 0.2790508
	iters: 100, epoch: 8 | loss: 0.3688506
	speed: 0.0152s/iter; left time: 0.4852s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 1.2960999011993408
Epoch: 8, Steps: 131 | Train Loss: 0.3688506 Vali Loss: 0.3054801 Best vali loss: 0.2790508

best validation loss 0.27905083481221005

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266899409, 'e_layers': 4, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4539988
	speed: 0.0153s/iter; left time: 14.5148s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 1.5225117206573486
Epoch: 1, Steps: 131 | Train Loss: 0.4539988 Vali Loss: 0.2814000 Best vali loss: 0.2814000
	iters: 100, epoch: 2 | loss: 0.4837565
	speed: 0.0156s/iter; left time: 12.7729s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 1.2981419563293457
Epoch: 2, Steps: 131 | Train Loss: 0.4837565 Vali Loss: 0.2996200 Best vali loss: 0.2814000
	iters: 100, epoch: 3 | loss: 0.3898405
	speed: 0.0151s/iter; left time: 10.4060s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.2886977195739746
Epoch: 3, Steps: 131 | Train Loss: 0.3898405 Vali Loss: 0.2855852 Best vali loss: 0.2814000
	iters: 100, epoch: 4 | loss: 0.3780142
	speed: 0.0152s/iter; left time: 8.4650s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 1.291121006011963
Epoch: 4, Steps: 131 | Train Loss: 0.3780142 Vali Loss: 0.3002075 Best vali loss: 0.2814000
	iters: 100, epoch: 5 | loss: 0.4528986
	speed: 0.0152s/iter; left time: 6.4634s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 1.295287847518921
Epoch: 5, Steps: 131 | Train Loss: 0.4528986 Vali Loss: 0.3106913 Best vali loss: 0.2814000
	iters: 100, epoch: 6 | loss: 0.4866121
	speed: 0.0153s/iter; left time: 4.4859s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 1.2939927577972412
Epoch: 6, Steps: 131 | Train Loss: 0.4866121 Vali Loss: 0.2965984 Best vali loss: 0.2814000
	iters: 100, epoch: 7 | loss: 0.3832892
	speed: 0.0152s/iter; left time: 2.4750s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 1.2912092208862305
Epoch: 7, Steps: 131 | Train Loss: 0.3832892 Vali Loss: 0.2983927 Best vali loss: 0.2814000
	iters: 100, epoch: 8 | loss: 0.3649142
	speed: 0.0153s/iter; left time: 0.4895s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.3063116073608398
Epoch: 8, Steps: 131 | Train Loss: 0.3649142 Vali Loss: 0.3043412 Best vali loss: 0.2814000

best validation loss 0.2813999529452783

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010703052635, 'e_layers': 2, 'learning_rate': 0.000146530972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6459369
	speed: 0.0093s/iter; left time: 8.8203s
Updating learning rate to 0.000146530972
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 0.7871019840240479
Epoch: 1, Steps: 131 | Train Loss: 0.6459369 Vali Loss: 0.2847700 Best vali loss: 0.2847700
	iters: 100, epoch: 2 | loss: 0.6631384
	speed: 0.0069s/iter; left time: 5.6755s
Updating learning rate to 7.3265486e-05
Validation loss decreased (0.2848 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 0.5559713840484619
Epoch: 2, Steps: 131 | Train Loss: 0.6631384 Vali Loss: 0.2799973 Best vali loss: 0.2799973
	iters: 100, epoch: 3 | loss: 0.8260219
	speed: 0.0069s/iter; left time: 4.7449s
Updating learning rate to 3.6632743e-05
Validation loss decreased (0.2800 --> 0.2786).  Saving model state dict ...
Epoch: 3 cost time: 0.5597431659698486
Epoch: 3, Steps: 131 | Train Loss: 0.8260219 Vali Loss: 0.2785722 Best vali loss: 0.2785722

best validation loss 0.27857220381243425

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597177
	speed: 0.0105s/iter; left time: 9.9616s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9266774654388428
Epoch: 1, Steps: 131 | Train Loss: 0.5597177 Vali Loss: 0.2756320 Best vali loss: 0.2756320
	iters: 100, epoch: 2 | loss: 0.3249262
	speed: 0.0089s/iter; left time: 7.2430s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2686).  Saving model state dict ...
Epoch: 2 cost time: 0.6984870433807373
Epoch: 2, Steps: 131 | Train Loss: 0.3249262 Vali Loss: 0.2685760 Best vali loss: 0.2685760
	iters: 100, epoch: 3 | loss: 0.4614208
	speed: 0.0090s/iter; left time: 6.1513s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.7006199359893799
Epoch: 3, Steps: 131 | Train Loss: 0.4614208 Vali Loss: 0.2762515 Best vali loss: 0.2685760

best validation loss 0.26857602188426705

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0108137245732, 'e_layers': 4, 'learning_rate': 5.20317237e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4187104
	speed: 0.0121s/iter; left time: 24.1785s
	iters: 200, epoch: 1 | loss: 0.5832345
	speed: 0.0067s/iter; left time: 12.6996s
Updating learning rate to 5.20317237e-05
Validation loss decreased (inf --> 0.2764).  Saving model state dict ...
Epoch: 1 cost time: 2.012446641921997
Epoch: 1, Steps: 262 | Train Loss: 0.5009725 Vali Loss: 0.2764297 Best vali loss: 0.2764297
	iters: 100, epoch: 2 | loss: 0.3152965
	speed: 0.0141s/iter; left time: 24.4791s
	iters: 200, epoch: 2 | loss: 0.7883837
	speed: 0.0065s/iter; left time: 10.6711s
Updating learning rate to 2.601586185e-05
Epoch: 2 cost time: 1.7458057403564453
Epoch: 2, Steps: 262 | Train Loss: 0.5518401 Vali Loss: 0.2766666 Best vali loss: 0.2764297
	iters: 100, epoch: 3 | loss: 0.2600095
	speed: 0.0136s/iter; left time: 19.9926s
	iters: 200, epoch: 3 | loss: 0.4452176
	speed: 0.0065s/iter; left time: 8.8770s
Updating learning rate to 1.3007930925e-05
Validation loss decreased (0.2764 --> 0.2746).  Saving model state dict ...
Epoch: 3 cost time: 1.7296335697174072
Epoch: 3, Steps: 262 | Train Loss: 0.3526135 Vali Loss: 0.2745521 Best vali loss: 0.2745521

best validation loss 0.2745520830619907

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4192512
	speed: 0.0108s/iter; left time: 6.0289s
Updating learning rate to 2.93167934875e-05
Epoch: 4 cost time: 0.9322018623352051
Epoch: 4, Steps: 131 | Train Loss: 0.4192512 Vali Loss: 0.3094434 Best vali loss: 0.2685760
	iters: 100, epoch: 5 | loss: 0.2799697
	speed: 0.0086s/iter; left time: 3.6565s
Updating learning rate to 1.465839674375e-05
Epoch: 5 cost time: 0.6975753307342529
Epoch: 5, Steps: 131 | Train Loss: 0.2799697 Vali Loss: 0.2947343 Best vali loss: 0.2685760
	iters: 100, epoch: 6 | loss: 0.4347050
	speed: 0.0087s/iter; left time: 2.5451s
Updating learning rate to 7.329198371875e-06
Epoch: 6 cost time: 0.7021965980529785
Epoch: 6, Steps: 131 | Train Loss: 0.4347050 Vali Loss: 0.2996664 Best vali loss: 0.2685760
	iters: 100, epoch: 7 | loss: 0.4634379
	speed: 0.0087s/iter; left time: 1.4123s
Updating learning rate to 3.6645991859375e-06
Epoch: 7 cost time: 0.7096664905548096
Epoch: 7, Steps: 131 | Train Loss: 0.4634379 Vali Loss: 0.2980065 Best vali loss: 0.2685760
	iters: 100, epoch: 8 | loss: 0.3252388
	speed: 0.0088s/iter; left time: 0.2802s
Updating learning rate to 1.83229959296875e-06
Epoch: 8 cost time: 0.7046647071838379
Epoch: 8, Steps: 131 | Train Loss: 0.3252388 Vali Loss: 0.2942451 Best vali loss: 0.2685760

best validation loss 0.26857602188426705

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0024365314006, 'e_layers': 4, 'learning_rate': 0.0022094264226, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0021253351365148865
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 0.6948916912078857
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2878309 Best vali loss: 0.2878309
Updating learning rate to 0.0018858634142765974
Validation loss decreased (0.2878 --> 0.2876).  Saving model state dict ...
Epoch: 2 cost time: 0.4581260681152344
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2876005 Best vali loss: 0.2876005
Updating learning rate to 0.0015274686547793448
Epoch: 3 cost time: 0.42321228981018066
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2917458 Best vali loss: 0.2876005
Updating learning rate to 0.0011047132113
Validation loss decreased (0.2876 --> 0.2831).  Saving model state dict ...
Epoch: 4 cost time: 0.4155921936035156
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2831265 Best vali loss: 0.2831265
Updating learning rate to 0.0006819577678206554
Epoch: 5 cost time: 0.4544484615325928
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2856550 Best vali loss: 0.2831265
Updating learning rate to 0.00032356300832340275
Epoch: 6 cost time: 0.42403459548950195
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2881346 Best vali loss: 0.2831265
Updating learning rate to 8.409128608511368e-05
Epoch: 7 cost time: 0.4108259677886963
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2917241 Best vali loss: 0.2831265
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43348169326782227
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2916789 Best vali loss: 0.2831265

best validation loss 0.2831264568909077

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0022725424595, 'e_layers': 4, 'learning_rate': 0.0020219737153, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019450169230707367
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 0.6634624004364014
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856320 Best vali loss: 0.2856320
Updating learning rate to 0.0017258625203847937
Validation loss decreased (0.2856 --> 0.2832).  Saving model state dict ...
Epoch: 2 cost time: 0.41190528869628906
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2831968 Best vali loss: 0.2831968
Updating learning rate to 0.0013978747784114986
Epoch: 3 cost time: 0.41118311882019043
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2852023 Best vali loss: 0.2831968
Updating learning rate to 0.00101098685765
Epoch: 4 cost time: 0.41970252990722656
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2876054 Best vali loss: 0.2831968
Updating learning rate to 0.0006240989368885017
Validation loss decreased (0.2832 --> 0.2801).  Saving model state dict ...
Epoch: 5 cost time: 0.40730714797973633
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2801087 Best vali loss: 0.2801087
Updating learning rate to 0.00029611119491520626
Epoch: 6 cost time: 0.40920066833496094
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2846964 Best vali loss: 0.2801087
Updating learning rate to 7.69567922292632e-05
Epoch: 7 cost time: 0.46475839614868164
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2864974 Best vali loss: 0.2801087
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4479672908782959
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2880123 Best vali loss: 0.2801087

best validation loss 0.28010869308801867

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0016183728734, 'e_layers': 2, 'learning_rate': 0.0001463941992, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001463941992
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 0.568692684173584
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2824722 Best vali loss: 0.2824722
Updating learning rate to 7.31970996e-05
Validation loss decreased (0.2825 --> 0.2784).  Saving model state dict ...
Epoch: 2 cost time: 0.3358592987060547
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2784215 Best vali loss: 0.2784215
Updating learning rate to 3.65985498e-05
Epoch: 3 cost time: 0.34665441513061523
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2793689 Best vali loss: 0.2784215

best validation loss 0.2784214897054241

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0020544790871, 'e_layers': 4, 'learning_rate': 0.0020170081114, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0019402403112158528
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 0.6829993724822998
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856590 Best vali loss: 0.2856590
Updating learning rate to 0.0017216241123396057
Epoch: 2 cost time: 0.4501185417175293
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2859955 Best vali loss: 0.2856590
Updating learning rate to 0.0013944418492893899
Epoch: 3 cost time: 0.43611931800842285
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2911271 Best vali loss: 0.2856590

best validation loss 0.2856589933339882

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0020078499296, 'e_layers': 4, 'learning_rate': 0.0019409473522, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001867074442289778
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 0.6751055717468262
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856108 Best vali loss: 0.2856108
Updating learning rate to 0.001656702193433347
Validation loss decreased (0.2856 --> 0.2804).  Saving model state dict ...
Epoch: 2 cost time: 0.4538767337799072
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2803656 Best vali loss: 0.2803656
Updating learning rate to 0.0013418578734899144
Epoch: 3 cost time: 0.42357683181762695
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2889943 Best vali loss: 0.2803656

best validation loss 0.2803656019190068

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0016183728734, 'e_layers': 2, 'learning_rate': 0.0001463941992, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.82992749e-05
Epoch: 4 cost time: 0.5777311325073242
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2796763 Best vali loss: 0.2784215
Updating learning rate to 9.14963745e-06
Epoch: 5 cost time: 0.34805870056152344
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2785209 Best vali loss: 0.2784215
Updating learning rate to 4.574818725e-06
Validation loss decreased (0.2784 --> 0.2784).  Saving model state dict ...
Epoch: 6 cost time: 0.34508824348449707
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2784068 Best vali loss: 0.2784068
Updating learning rate to 2.2874093625e-06
Epoch: 7 cost time: 0.3433833122253418
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2784677 Best vali loss: 0.2784068
Updating learning rate to 1.14370468125e-06
Epoch: 8 cost time: 0.3523275852203369
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2784080 Best vali loss: 0.2784068

best validation loss 0.2784067739913702

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.00217367258, 'e_layers': 2, 'learning_rate': 0.0027308661294, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0026269287261904894
Validation loss decreased (inf --> 0.2897).  Saving model state dict ...
Epoch: 1 cost time: 0.5568716526031494
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2896715 Best vali loss: 0.2896715
Updating learning rate to 0.0023309400440057
Epoch: 2 cost time: 0.33341383934020996
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2941510 Best vali loss: 0.2896715
Updating learning rate to 0.0018879616765641797
Epoch: 3 cost time: 0.3184974193572998
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2967084 Best vali loss: 0.2896715
Updating learning rate to 0.0013654330647
Epoch: 4 cost time: 0.31227922439575195
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2930839 Best vali loss: 0.2896715
Updating learning rate to 0.0008429044528358204
Epoch: 5 cost time: 0.3152201175689697
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3132098 Best vali loss: 0.2896715
Updating learning rate to 0.0003999260853943002
Epoch: 6 cost time: 0.3167264461517334
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3190269 Best vali loss: 0.2896715
Updating learning rate to 0.00010393740320951046
Epoch: 7 cost time: 0.3138291835784912
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3201979 Best vali loss: 0.2896715
Updating learning rate to 0.0
Epoch: 8 cost time: 0.33043360710144043
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3188741 Best vali loss: 0.2896715

best validation loss 0.28967145512032216

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0012979578779, 'e_layers': 2, 'learning_rate': 0.0001456117957, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7733078
	speed: 0.0089s/iter; left time: 17.8713s
	iters: 200, epoch: 1 | loss: 0.8318306
	speed: 0.0036s/iter; left time: 6.9051s
Updating learning rate to 0.0001400697767197225
Validation loss decreased (inf --> 0.2769).  Saving model state dict ...
Epoch: 1 cost time: 1.2024905681610107
Epoch: 1, Steps: 262 | Train Loss: 0.8025692 Vali Loss: 0.2769014 Best vali loss: 0.2769014
	iters: 100, epoch: 2 | loss: 0.3713484
	speed: 0.0079s/iter; left time: 13.7269s
	iters: 200, epoch: 2 | loss: 0.3733864
	speed: 0.0034s/iter; left time: 5.5934s
Updating learning rate to 0.00012428744193011007
Epoch: 2 cost time: 0.9532101154327393
Epoch: 2, Steps: 262 | Train Loss: 0.3723674 Vali Loss: 0.2808606 Best vali loss: 0.2769014
	iters: 100, epoch: 3 | loss: 0.3285845
	speed: 0.0080s/iter; left time: 11.7177s
	iters: 200, epoch: 3 | loss: 0.7050658
	speed: 0.0037s/iter; left time: 5.0900s
Updating learning rate to 0.00010066750873566012
Epoch: 3 cost time: 0.9963169097900391
Epoch: 3, Steps: 262 | Train Loss: 0.5168251 Vali Loss: 0.2822129 Best vali loss: 0.2769014
	iters: 100, epoch: 4 | loss: 0.4008675
	speed: 0.0079s/iter; left time: 9.6044s
	iters: 200, epoch: 4 | loss: 0.3249794
	speed: 0.0034s/iter; left time: 3.7987s
Updating learning rate to 7.280589785e-05
Epoch: 4 cost time: 0.9348857402801514
Epoch: 4, Steps: 262 | Train Loss: 0.3629234 Vali Loss: 0.2836835 Best vali loss: 0.2769014
	iters: 100, epoch: 5 | loss: 0.4697510
	speed: 0.0080s/iter; left time: 7.6204s
	iters: 200, epoch: 5 | loss: 0.3393979
	speed: 0.0036s/iter; left time: 3.0691s
Updating learning rate to 4.494428696433989e-05
Epoch: 5 cost time: 0.9898240566253662
Epoch: 5, Steps: 262 | Train Loss: 0.4045744 Vali Loss: 0.2956144 Best vali loss: 0.2769014
	iters: 100, epoch: 6 | loss: 0.5691840
	speed: 0.0078s/iter; left time: 5.3445s
	iters: 200, epoch: 6 | loss: 0.5789176
	speed: 0.0034s/iter; left time: 1.9745s
Updating learning rate to 2.1324353769889923e-05
Epoch: 6 cost time: 0.9286026954650879
Epoch: 6, Steps: 262 | Train Loss: 0.5740508 Vali Loss: 0.2869662 Best vali loss: 0.2769014
	iters: 100, epoch: 7 | loss: 0.4574421
	speed: 0.0076s/iter; left time: 3.2156s
	iters: 200, epoch: 7 | loss: 0.2987165
	speed: 0.0032s/iter; left time: 1.0334s
Updating learning rate to 5.5420189802775035e-06
Epoch: 7 cost time: 0.8754730224609375
Epoch: 7, Steps: 262 | Train Loss: 0.3780793 Vali Loss: 0.2904194 Best vali loss: 0.2769014
	iters: 100, epoch: 8 | loss: 0.4659761
	speed: 0.0074s/iter; left time: 1.2073s
	iters: 200, epoch: 8 | loss: 0.3544099
	speed: 0.0032s/iter; left time: 0.1993s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8731391429901123
Epoch: 8, Steps: 262 | Train Loss: 0.4101930 Vali Loss: 0.2861542 Best vali loss: 0.2769014

best validation loss 0.2769014417748329

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0020021591, 'e_layers': 3, 'learning_rate': 0.0001466797763, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00014109710972845204
Validation loss decreased (inf --> 0.2993).  Saving model state dict ...
Epoch: 1 cost time: 0.6110658645629883
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2992919 Best vali loss: 0.2992919
Updating learning rate to 0.0001251990203923279
Validation loss decreased (0.2993 --> 0.2852).  Saving model state dict ...
Epoch: 2 cost time: 0.38056230545043945
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2852490 Best vali loss: 0.2852490
Updating learning rate to 0.00010140584827651377
Validation loss decreased (0.2852 --> 0.2810).  Saving model state dict ...
Epoch: 3 cost time: 0.3946807384490967
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2810137 Best vali loss: 0.2810137

best validation loss 0.2810137261019714

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0069144700314, 'e_layers': 3, 'learning_rate': 0.0030459706311, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3978546
	speed: 0.0103s/iter; left time: 9.7318s
Updating learning rate to 0.002930040276901888
Validation loss decreased (inf --> 0.2947).  Saving model state dict ...
Epoch: 1 cost time: 0.9209704399108887
Epoch: 1, Steps: 131 | Train Loss: 0.3978546 Vali Loss: 0.2946632 Best vali loss: 0.2946632
	iters: 100, epoch: 2 | loss: 0.4245559
	speed: 0.0078s/iter; left time: 6.3695s
Updating learning rate to 0.0025998985598229387
Epoch: 2 cost time: 0.6206159591674805
Epoch: 2, Steps: 131 | Train Loss: 0.4245559 Vali Loss: 0.3007007 Best vali loss: 0.2946632
	iters: 100, epoch: 3 | loss: 0.5218294
	speed: 0.0075s/iter; left time: 5.1496s
Updating learning rate to 0.0021058065635463034
Validation loss decreased (0.2947 --> 0.2922).  Saving model state dict ...
Epoch: 3 cost time: 0.5958662033081055
Epoch: 3, Steps: 131 | Train Loss: 0.5218294 Vali Loss: 0.2922308 Best vali loss: 0.2922308

best validation loss 0.2922307624747958

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002339399362, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596962
	speed: 0.0105s/iter; left time: 9.9579s
Updating learning rate to 0.0002339399362
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.936711311340332
Epoch: 1, Steps: 131 | Train Loss: 0.5596962 Vali Loss: 0.2756462 Best vali loss: 0.2756462
	iters: 100, epoch: 2 | loss: 0.3249726
	speed: 0.0088s/iter; left time: 7.2386s
Updating learning rate to 0.0001169699681
Validation loss decreased (0.2756 --> 0.2709).  Saving model state dict ...
Epoch: 2 cost time: 0.6949586868286133
Epoch: 2, Steps: 131 | Train Loss: 0.3249726 Vali Loss: 0.2708660 Best vali loss: 0.2708660
	iters: 100, epoch: 3 | loss: 0.4613673
	speed: 0.0089s/iter; left time: 6.0886s
Updating learning rate to 5.848498405e-05
Epoch: 3 cost time: 0.7068438529968262
Epoch: 3, Steps: 131 | Train Loss: 0.4613673 Vali Loss: 0.2786279 Best vali loss: 0.2708660

best validation loss 0.27086597013845903

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002339399362, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4254043
	speed: 0.0107s/iter; left time: 5.9386s
Updating learning rate to 2.9242492025e-05
Epoch: 4 cost time: 0.9227240085601807
Epoch: 4, Steps: 131 | Train Loss: 0.4254043 Vali Loss: 0.3057820 Best vali loss: 0.2708660
	iters: 100, epoch: 5 | loss: 0.2823278
	speed: 0.0086s/iter; left time: 3.6396s
Updating learning rate to 1.46212460125e-05
Epoch: 5 cost time: 0.694291353225708
Epoch: 5, Steps: 131 | Train Loss: 0.2823278 Vali Loss: 0.2930703 Best vali loss: 0.2708660
	iters: 100, epoch: 6 | loss: 0.4334020
	speed: 0.0087s/iter; left time: 2.5531s
Updating learning rate to 7.31062300625e-06
Epoch: 6 cost time: 0.7008287906646729
Epoch: 6, Steps: 131 | Train Loss: 0.4334020 Vali Loss: 0.2994822 Best vali loss: 0.2708660
	iters: 100, epoch: 7 | loss: 0.4637548
	speed: 0.0087s/iter; left time: 1.4124s
Updating learning rate to 3.655311503125e-06
Epoch: 7 cost time: 0.7025680541992188
Epoch: 7, Steps: 131 | Train Loss: 0.4637548 Vali Loss: 0.2972791 Best vali loss: 0.2708660
	iters: 100, epoch: 8 | loss: 0.3285254
	speed: 0.0086s/iter; left time: 0.2765s
Updating learning rate to 1.8276557515625e-06
Epoch: 8 cost time: 0.6955783367156982
Epoch: 8, Steps: 131 | Train Loss: 0.3285254 Vali Loss: 0.2949024 Best vali loss: 0.2708660

best validation loss 0.27086597013845903

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009536165701, 'e_layers': 2, 'learning_rate': 0.0002360481416, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5598453
	speed: 0.0103s/iter; left time: 9.7831s
Updating learning rate to 0.00022706409415578302
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9320371150970459
Epoch: 1, Steps: 131 | Train Loss: 0.5598453 Vali Loss: 0.2756498 Best vali loss: 0.2756498
	iters: 100, epoch: 2 | loss: 0.3247457
	speed: 0.0089s/iter; left time: 7.2623s
Updating learning rate to 0.00020147969160592117
Validation loss decreased (0.2756 --> 0.2714).  Saving model state dict ...
Epoch: 2 cost time: 0.7092013359069824
Epoch: 2, Steps: 131 | Train Loss: 0.3247457 Vali Loss: 0.2713667 Best vali loss: 0.2713667
	iters: 100, epoch: 3 | loss: 0.4653279
	speed: 0.0091s/iter; left time: 6.2762s
Updating learning rate to 0.00016318992731544437
Epoch: 3 cost time: 0.7056682109832764
Epoch: 3, Steps: 131 | Train Loss: 0.4653279 Vali Loss: 0.2890097 Best vali loss: 0.2713667
	iters: 100, epoch: 4 | loss: 0.4922830
	speed: 0.0086s/iter; left time: 4.7653s
Updating learning rate to 0.0001180240708
Epoch: 4 cost time: 0.696763277053833
Epoch: 4, Steps: 131 | Train Loss: 0.4922830 Vali Loss: 0.2809752 Best vali loss: 0.2713667
	iters: 100, epoch: 5 | loss: 0.3367355
	speed: 0.0086s/iter; left time: 3.6423s
Updating learning rate to 7.285821428455563e-05
Epoch: 5 cost time: 0.6956171989440918
Epoch: 5, Steps: 131 | Train Loss: 0.3367355 Vali Loss: 0.2957394 Best vali loss: 0.2713667
	iters: 100, epoch: 6 | loss: 0.3072321
	speed: 0.0086s/iter; left time: 2.5202s
Updating learning rate to 3.4568449994078816e-05
Epoch: 6 cost time: 0.699446439743042
Epoch: 6, Steps: 131 | Train Loss: 0.3072321 Vali Loss: 0.3017341 Best vali loss: 0.2713667
	iters: 100, epoch: 7 | loss: 0.2826573
	speed: 0.0086s/iter; left time: 1.3999s
Updating learning rate to 8.984047444216993e-06
Epoch: 7 cost time: 0.699080228805542
Epoch: 7, Steps: 131 | Train Loss: 0.2826573 Vali Loss: 0.2968154 Best vali loss: 0.2713667
	iters: 100, epoch: 8 | loss: 0.3437074
	speed: 0.0086s/iter; left time: 0.2751s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6977405548095703
Epoch: 8, Steps: 131 | Train Loss: 0.3437074 Vali Loss: 0.2995193 Best vali loss: 0.2713667

best validation loss 0.27136674251818843

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014838437101, 'e_layers': 1, 'learning_rate': 0.001031291596, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0009920403967976492
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 0.5063884258270264
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2873960 Best vali loss: 0.2873960
Updating learning rate to 0.0008802624384561486
Validation loss decreased (0.2874 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 0.2740480899810791
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2834376 Best vali loss: 0.2834376
Updating learning rate to 0.0007129749018632757
Epoch: 3 cost time: 0.2628180980682373
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2985308 Best vali loss: 0.2834376
Updating learning rate to 0.000515645798
Epoch: 4 cost time: 0.26991963386535645
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2930273 Best vali loss: 0.2834376
Updating learning rate to 0.00031831669413672425
Epoch: 5 cost time: 0.2595069408416748
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2980435 Best vali loss: 0.2834376
Updating learning rate to 0.00015102915754385134
Epoch: 6 cost time: 0.26114702224731445
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2946768 Best vali loss: 0.2834376
Updating learning rate to 3.9251199202350606e-05
Epoch: 7 cost time: 0.2877025604248047
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2964686 Best vali loss: 0.2834376
Updating learning rate to 0.0
Epoch: 8 cost time: 0.2614772319793701
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2980305 Best vali loss: 0.2834376

best validation loss 0.28343756527384667

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0021786866859, 'e_layers': 4, 'learning_rate': 0.0010266618001, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009875868120117922
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 0.6837491989135742
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2832566 Best vali loss: 0.2832566
Updating learning rate to 0.0008763106604679488
Epoch: 2 cost time: 0.4247443675994873
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2832815 Best vali loss: 0.2832566
Updating learning rate to 0.0007097741308201949
Validation loss decreased (0.2833 --> 0.2808).  Saving model state dict ...
Epoch: 3 cost time: 0.42116570472717285
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2807532 Best vali loss: 0.2807532

best validation loss 0.2807532231319611

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021744175352, 'e_layers': 1, 'learning_rate': 0.0010264462302, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009873794467525742
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 0.49787235260009766
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2834236 Best vali loss: 0.2834236
Updating learning rate to 0.000876126660048894
Validation loss decreased (0.2834 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 0.2635507583618164
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2807847 Best vali loss: 0.2807847
Updating learning rate to 0.0007096250983555716
Epoch: 3 cost time: 0.26761722564697266
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2917096 Best vali loss: 0.2807847

best validation loss 0.28078466806769947

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0107550665455, 'e_layers': 1, 'learning_rate': 0.0001787980014, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001719929076736922
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.5165345668792725
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2828650 Best vali loss: 0.2828650
Updating learning rate to 0.00015261364032627089
Validation loss decreased (0.2829 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.27501463890075684
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2791529 Best vali loss: 0.2791529
Updating learning rate to 0.00012361051713788508
Epoch: 3 cost time: 0.2826051712036133
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2795922 Best vali loss: 0.2791529

best validation loss 0.2791529300821098

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0107550665455, 'e_layers': 1, 'learning_rate': 0.0001787980014, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.93990007e-05
Epoch: 4 cost time: 0.49678945541381836
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2825930 Best vali loss: 0.2791529
Updating learning rate to 5.518748426211494e-05
Epoch: 5 cost time: 0.2680482864379883
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2829514 Best vali loss: 0.2791529
Updating learning rate to 2.6184361073729095e-05
Epoch: 6 cost time: 0.27243852615356445
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2824914 Best vali loss: 0.2791529
Updating learning rate to 6.805093726307804e-06
Epoch: 7 cost time: 0.2666130065917969
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2837191 Best vali loss: 0.2791529
Updating learning rate to 0.0
Epoch: 8 cost time: 0.27008676528930664
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2835896 Best vali loss: 0.2791529

best validation loss 0.2791529300821098

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010268458921, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597113
	speed: 0.0104s/iter; left time: 9.8947s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9354398250579834
Epoch: 1, Steps: 131 | Train Loss: 0.5597113 Vali Loss: 0.2756385 Best vali loss: 0.2756385
	iters: 100, epoch: 2 | loss: 0.3250865
	speed: 0.0089s/iter; left time: 7.2518s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2704).  Saving model state dict ...
Epoch: 2 cost time: 0.7009925842285156
Epoch: 2, Steps: 131 | Train Loss: 0.3250865 Vali Loss: 0.2704150 Best vali loss: 0.2704150
	iters: 100, epoch: 3 | loss: 0.4630783
	speed: 0.0089s/iter; left time: 6.1231s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7071397304534912
Epoch: 3, Steps: 131 | Train Loss: 0.4630783 Vali Loss: 0.2801611 Best vali loss: 0.2704150
	iters: 100, epoch: 4 | loss: 0.5089498
	speed: 0.0088s/iter; left time: 4.8854s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.706195592880249
Epoch: 4, Steps: 131 | Train Loss: 0.5089498 Vali Loss: 0.2876658 Best vali loss: 0.2704150
	iters: 100, epoch: 5 | loss: 0.3360337
	speed: 0.0086s/iter; left time: 3.6697s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7012381553649902
Epoch: 5, Steps: 131 | Train Loss: 0.3360337 Vali Loss: 0.2858819 Best vali loss: 0.2704150
	iters: 100, epoch: 6 | loss: 0.3180122
	speed: 0.0086s/iter; left time: 2.5271s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6942987442016602
Epoch: 6, Steps: 131 | Train Loss: 0.3180122 Vali Loss: 0.2852642 Best vali loss: 0.2704150
	iters: 100, epoch: 7 | loss: 0.3092312
	speed: 0.0087s/iter; left time: 1.4202s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7077922821044922
Epoch: 7, Steps: 131 | Train Loss: 0.3092312 Vali Loss: 0.2902732 Best vali loss: 0.2704150
	iters: 100, epoch: 8 | loss: 0.3955055
	speed: 0.0087s/iter; left time: 0.2790s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7066302299499512
Epoch: 8, Steps: 131 | Train Loss: 0.3955055 Vali Loss: 0.2914931 Best vali loss: 0.2704150

best validation loss 0.2704149863231399

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0061752764271, 'e_layers': 2, 'learning_rate': 0.0013321716897, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5766841
	speed: 0.0089s/iter; left time: 17.7316s
	iters: 200, epoch: 1 | loss: 0.3791675
	speed: 0.0037s/iter; left time: 7.0248s
Updating learning rate to 0.0013321716897
Validation loss decreased (inf --> 0.3127).  Saving model state dict ...
Epoch: 1 cost time: 1.2122206687927246
Epoch: 1, Steps: 262 | Train Loss: 0.4779258 Vali Loss: 0.3127396 Best vali loss: 0.3127396
	iters: 100, epoch: 2 | loss: 0.5583104
	speed: 0.0085s/iter; left time: 14.7995s
	iters: 200, epoch: 2 | loss: 0.7091430
	speed: 0.0037s/iter; left time: 6.0773s
Updating learning rate to 0.00066608584485
Validation loss decreased (0.3127 --> 0.3104).  Saving model state dict ...
Epoch: 2 cost time: 1.0077900886535645
Epoch: 2, Steps: 262 | Train Loss: 0.6337267 Vali Loss: 0.3104343 Best vali loss: 0.3104343
	iters: 100, epoch: 3 | loss: 1.0050162
	speed: 0.0087s/iter; left time: 12.8575s
	iters: 200, epoch: 3 | loss: 0.4056223
	speed: 0.0034s/iter; left time: 4.7074s
Updating learning rate to 0.000333042922425
Validation loss decreased (0.3104 --> 0.2915).  Saving model state dict ...
Epoch: 3 cost time: 0.963984489440918
Epoch: 3, Steps: 262 | Train Loss: 0.7053193 Vali Loss: 0.2915234 Best vali loss: 0.2915234
	iters: 100, epoch: 4 | loss: 0.4282804
	speed: 0.0085s/iter; left time: 10.3427s
	iters: 200, epoch: 4 | loss: 0.2405734
	speed: 0.0035s/iter; left time: 3.9266s
Updating learning rate to 0.0001665214612125
Epoch: 4 cost time: 0.9871037006378174
Epoch: 4, Steps: 262 | Train Loss: 0.3344269 Vali Loss: 0.2928610 Best vali loss: 0.2915234
	iters: 100, epoch: 5 | loss: 0.5014709
	speed: 0.0082s/iter; left time: 7.8199s
	iters: 200, epoch: 5 | loss: 0.5351914
	speed: 0.0036s/iter; left time: 3.0718s
Updating learning rate to 8.326073060625e-05
Epoch: 5 cost time: 0.9773731231689453
Epoch: 5, Steps: 262 | Train Loss: 0.5183311 Vali Loss: 0.2943666 Best vali loss: 0.2915234
	iters: 100, epoch: 6 | loss: 0.3600490
	speed: 0.0081s/iter; left time: 5.5466s
	iters: 200, epoch: 6 | loss: 0.3807355
	speed: 0.0036s/iter; left time: 2.1160s
Updating learning rate to 4.1630365303125e-05
Epoch: 6 cost time: 0.9779233932495117
Epoch: 6, Steps: 262 | Train Loss: 0.3703922 Vali Loss: 0.2921540 Best vali loss: 0.2915234
	iters: 100, epoch: 7 | loss: 0.3332697
	speed: 0.0081s/iter; left time: 3.4480s
	iters: 200, epoch: 7 | loss: 0.4511845
	speed: 0.0035s/iter; left time: 1.1462s
Updating learning rate to 2.08151826515625e-05
Epoch: 7 cost time: 0.9547755718231201
Epoch: 7, Steps: 262 | Train Loss: 0.3922271 Vali Loss: 0.2953743 Best vali loss: 0.2915234
	iters: 100, epoch: 8 | loss: 0.3373482
	speed: 0.0083s/iter; left time: 1.3457s
	iters: 200, epoch: 8 | loss: 0.2982168
	speed: 0.0037s/iter; left time: 0.2317s
Updating learning rate to 1.040759132578125e-05
Epoch: 8 cost time: 1.0024094581604004
Epoch: 8, Steps: 262 | Train Loss: 0.3177825 Vali Loss: 0.2922362 Best vali loss: 0.2915234

best validation loss 0.2915234046604785

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.00102723566, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597022
	speed: 0.0106s/iter; left time: 10.0858s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9414246082305908
Epoch: 1, Steps: 131 | Train Loss: 0.5597022 Vali Loss: 0.2756443 Best vali loss: 0.2756443
	iters: 100, epoch: 2 | loss: 0.3266971
	speed: 0.0089s/iter; left time: 7.2696s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2709).  Saving model state dict ...
Epoch: 2 cost time: 0.7043631076812744
Epoch: 2, Steps: 131 | Train Loss: 0.3266971 Vali Loss: 0.2708529 Best vali loss: 0.2708529
	iters: 100, epoch: 3 | loss: 0.4613996
	speed: 0.0089s/iter; left time: 6.1233s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.7064797878265381
Epoch: 3, Steps: 131 | Train Loss: 0.4613996 Vali Loss: 0.2864759 Best vali loss: 0.2708529

best validation loss 0.2708529165439244

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0012140849819, 'e_layers': 1, 'learning_rate': 0.0009371538998, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9456248
	speed: 0.0078s/iter; left time: 64.7028s
	iters: 200, epoch: 1 | loss: 0.5377607
	speed: 0.0024s/iter; left time: 19.8715s
	iters: 300, epoch: 1 | loss: 0.3926802
	speed: 0.0024s/iter; left time: 19.4837s
	iters: 400, epoch: 1 | loss: 0.5043005
	speed: 0.0024s/iter; left time: 19.3002s
	iters: 500, epoch: 1 | loss: 0.5241114
	speed: 0.0025s/iter; left time: 19.5730s
	iters: 600, epoch: 1 | loss: 0.4486433
	speed: 0.0025s/iter; left time: 19.1250s
	iters: 700, epoch: 1 | loss: 1.0248485
	speed: 0.0025s/iter; left time: 18.9172s
	iters: 800, epoch: 1 | loss: 0.4060450
	speed: 0.0025s/iter; left time: 18.6855s
	iters: 900, epoch: 1 | loss: 0.8379635
	speed: 0.0025s/iter; left time: 18.5503s
	iters: 1000, epoch: 1 | loss: 0.2773906
	speed: 0.0025s/iter; left time: 18.2030s
Updating learning rate to 0.0009371538998
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 2.839472532272339
Epoch: 1, Steps: 1045 | Train Loss: 0.5899368 Vali Loss: 0.2894515 Best vali loss: 0.2894515
	iters: 100, epoch: 2 | loss: 0.4485381
	speed: 0.0079s/iter; left time: 57.1313s
	iters: 200, epoch: 2 | loss: 0.1873633
	speed: 0.0021s/iter; left time: 14.6483s
	iters: 300, epoch: 2 | loss: 0.1334847
	speed: 0.0021s/iter; left time: 14.5400s
	iters: 400, epoch: 2 | loss: 0.2681090
	speed: 0.0021s/iter; left time: 14.5120s
	iters: 500, epoch: 2 | loss: 0.4409265
	speed: 0.0021s/iter; left time: 14.2107s
	iters: 600, epoch: 2 | loss: 1.2705642
	speed: 0.0021s/iter; left time: 14.0156s
	iters: 700, epoch: 2 | loss: 0.1852736
	speed: 0.0021s/iter; left time: 13.7648s
	iters: 800, epoch: 2 | loss: 0.3254437
	speed: 0.0021s/iter; left time: 13.5531s
	iters: 900, epoch: 2 | loss: 0.4363116
	speed: 0.0021s/iter; left time: 13.4019s
	iters: 1000, epoch: 2 | loss: 0.3822730
	speed: 0.0021s/iter; left time: 13.1403s
Updating learning rate to 0.0004685769499
Validation loss decreased (0.2895 --> 0.2881).  Saving model state dict ...
Epoch: 2 cost time: 2.2148594856262207
Epoch: 2, Steps: 1045 | Train Loss: 0.4078288 Vali Loss: 0.2881256 Best vali loss: 0.2881256
	iters: 100, epoch: 3 | loss: 0.6965349
	speed: 0.0074s/iter; left time: 45.6747s
	iters: 200, epoch: 3 | loss: 0.9470535
	speed: 0.0021s/iter; left time: 12.7373s
	iters: 300, epoch: 3 | loss: 0.2097555
	speed: 0.0021s/iter; left time: 12.6038s
	iters: 400, epoch: 3 | loss: 0.5048689
	speed: 0.0021s/iter; left time: 12.2216s
	iters: 500, epoch: 3 | loss: 0.9462750
	speed: 0.0021s/iter; left time: 11.8846s
	iters: 600, epoch: 3 | loss: 0.1800999
	speed: 0.0021s/iter; left time: 11.7202s
	iters: 700, epoch: 3 | loss: 0.3048255
	speed: 0.0021s/iter; left time: 11.5607s
	iters: 800, epoch: 3 | loss: 0.3697162
	speed: 0.0021s/iter; left time: 11.4246s
	iters: 900, epoch: 3 | loss: 0.1933158
	speed: 0.0021s/iter; left time: 11.1969s
	iters: 1000, epoch: 3 | loss: 0.4869316
	speed: 0.0021s/iter; left time: 11.0265s
Updating learning rate to 0.00023428847495
Epoch: 3 cost time: 2.2107982635498047
Epoch: 3, Steps: 1045 | Train Loss: 0.4839377 Vali Loss: 0.2940740 Best vali loss: 0.2881256

best validation loss 0.28812560061177783

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0085967811443, 'e_layers': 1, 'learning_rate': 0.0003811149052, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4367721
	speed: 0.0079s/iter; left time: 32.1410s
	iters: 200, epoch: 1 | loss: 0.3029185
	speed: 0.0023s/iter; left time: 9.1075s
	iters: 300, epoch: 1 | loss: 0.9413080
	speed: 0.0023s/iter; left time: 8.8720s
	iters: 400, epoch: 1 | loss: 0.3414372
	speed: 0.0023s/iter; left time: 8.6805s
	iters: 500, epoch: 1 | loss: 0.2991908
	speed: 0.0023s/iter; left time: 8.6559s
Updating learning rate to 0.0003666095828246297
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 1.4950978755950928
Epoch: 1, Steps: 523 | Train Loss: 0.4643253 Vali Loss: 0.2796227 Best vali loss: 0.2796227
	iters: 100, epoch: 2 | loss: 0.3219373
	speed: 0.0057s/iter; left time: 20.3420s
	iters: 200, epoch: 2 | loss: 0.2462785
	speed: 0.0023s/iter; left time: 7.8610s
	iters: 300, epoch: 2 | loss: 0.6328742
	speed: 0.0023s/iter; left time: 7.6285s
	iters: 400, epoch: 2 | loss: 0.6474847
	speed: 0.0023s/iter; left time: 7.5225s
	iters: 500, epoch: 2 | loss: 0.4447295
	speed: 0.0024s/iter; left time: 7.6311s
Updating learning rate to 0.00032530191953909413
Epoch: 2 cost time: 1.2527196407318115
Epoch: 2, Steps: 523 | Train Loss: 0.4586608 Vali Loss: 0.2810388 Best vali loss: 0.2796227
	iters: 100, epoch: 3 | loss: 0.3347015
	speed: 0.0059s/iter; left time: 17.7904s
	iters: 200, epoch: 3 | loss: 0.2063561
	speed: 0.0024s/iter; left time: 7.1275s
	iters: 300, epoch: 3 | loss: 0.6214673
	speed: 0.0023s/iter; left time: 6.5987s
	iters: 400, epoch: 3 | loss: 0.2957964
	speed: 0.0023s/iter; left time: 6.2998s
	iters: 500, epoch: 3 | loss: 0.3878872
	speed: 0.0023s/iter; left time: 6.0357s
Updating learning rate to 0.0002634806326237159
Epoch: 3 cost time: 1.2694463729858398
Epoch: 3, Steps: 523 | Train Loss: 0.3692417 Vali Loss: 0.2823154 Best vali loss: 0.2796227

best validation loss 0.27962266071084796

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.00102723566, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4226406
	speed: 0.0109s/iter; left time: 6.0472s
Updating learning rate to 2.93167934875e-05
Epoch: 4 cost time: 0.9449892044067383
Epoch: 4, Steps: 131 | Train Loss: 0.4226406 Vali Loss: 0.3090792 Best vali loss: 0.2708529
	iters: 100, epoch: 5 | loss: 0.2836218
	speed: 0.0085s/iter; left time: 3.6330s
Updating learning rate to 1.465839674375e-05
Epoch: 5 cost time: 0.6920943260192871
Epoch: 5, Steps: 131 | Train Loss: 0.2836218 Vali Loss: 0.3054910 Best vali loss: 0.2708529
	iters: 100, epoch: 6 | loss: 0.4349272
	speed: 0.0087s/iter; left time: 2.5480s
Updating learning rate to 7.329198371875e-06
Epoch: 6 cost time: 0.7052402496337891
Epoch: 6, Steps: 131 | Train Loss: 0.4349272 Vali Loss: 0.3049916 Best vali loss: 0.2708529
	iters: 100, epoch: 7 | loss: 0.4682712
	speed: 0.0085s/iter; left time: 1.3888s
Updating learning rate to 3.6645991859375e-06
Epoch: 7 cost time: 0.6885101795196533
Epoch: 7, Steps: 131 | Train Loss: 0.4682712 Vali Loss: 0.3059199 Best vali loss: 0.2708529
	iters: 100, epoch: 8 | loss: 0.3291653
	speed: 0.0086s/iter; left time: 0.2754s
Updating learning rate to 1.83229959296875e-06
Epoch: 8 cost time: 0.6991705894470215
Epoch: 8, Steps: 131 | Train Loss: 0.3291653 Vali Loss: 0.3023562 Best vali loss: 0.2708529

best validation loss 0.2708529165439244

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008585361671, 'e_layers': 2, 'learning_rate': 0.0011850312005, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2533560
	speed: 0.0086s/iter; left time: 35.1684s
	iters: 200, epoch: 1 | loss: 0.7867097
	speed: 0.0034s/iter; left time: 13.5258s
	iters: 300, epoch: 1 | loss: 0.7368405
	speed: 0.0033s/iter; left time: 12.9713s
	iters: 400, epoch: 1 | loss: 0.6013421
	speed: 0.0033s/iter; left time: 12.6586s
	iters: 500, epoch: 1 | loss: 0.7820613
	speed: 0.0033s/iter; left time: 12.2705s
Updating learning rate to 0.0011399286360146146
Validation loss decreased (inf --> 0.3177).  Saving model state dict ...
Epoch: 1 cost time: 2.0122735500335693
Epoch: 1, Steps: 523 | Train Loss: 0.6320619 Vali Loss: 0.3177222 Best vali loss: 0.3177222
	iters: 100, epoch: 2 | loss: 0.7294261
	speed: 0.0074s/iter; left time: 26.2609s
	iters: 200, epoch: 2 | loss: 0.4312190
	speed: 0.0033s/iter; left time: 11.5269s
	iters: 300, epoch: 2 | loss: 0.2366150
	speed: 0.0033s/iter; left time: 11.1576s
	iters: 400, epoch: 2 | loss: 1.4043207
	speed: 0.0033s/iter; left time: 10.9106s
	iters: 500, epoch: 2 | loss: 0.7139575
	speed: 0.0033s/iter; left time: 10.5551s
Updating learning rate to 0.0010114873991455926
Validation loss decreased (0.3177 --> 0.3077).  Saving model state dict ...
Epoch: 2 cost time: 1.782923698425293
Epoch: 2, Steps: 523 | Train Loss: 0.7031077 Vali Loss: 0.3077069 Best vali loss: 0.3077069
	iters: 100, epoch: 3 | loss: 0.4184510
	speed: 0.0075s/iter; left time: 22.9438s
	iters: 200, epoch: 3 | loss: 0.2706411
	speed: 0.0034s/iter; left time: 9.8748s
	iters: 300, epoch: 3 | loss: 1.1348172
	speed: 0.0034s/iter; left time: 9.6667s
	iters: 400, epoch: 3 | loss: 0.8608095
	speed: 0.0034s/iter; left time: 9.4072s
	iters: 500, epoch: 3 | loss: 0.7831688
	speed: 0.0033s/iter; left time: 8.7613s
Updating learning rate to 0.0008192615038835315
Epoch: 3 cost time: 1.797370433807373
Epoch: 3, Steps: 523 | Train Loss: 0.6935775 Vali Loss: 0.3151964 Best vali loss: 0.3077069
	iters: 100, epoch: 4 | loss: 0.4166867
	speed: 0.0074s/iter; left time: 18.7433s
	iters: 200, epoch: 4 | loss: 0.3077938
	speed: 0.0033s/iter; left time: 8.0744s
	iters: 300, epoch: 4 | loss: 0.6956415
	speed: 0.0033s/iter; left time: 7.6940s
	iters: 400, epoch: 4 | loss: 0.6961184
	speed: 0.0033s/iter; left time: 7.3733s
	iters: 500, epoch: 4 | loss: 0.3708321
	speed: 0.0034s/iter; left time: 7.0897s
Updating learning rate to 0.00059251560025
Epoch: 4 cost time: 1.785569667816162
Epoch: 4, Steps: 523 | Train Loss: 0.4974145 Vali Loss: 0.3083021 Best vali loss: 0.3077069
	iters: 100, epoch: 5 | loss: 0.3530468
	speed: 0.0073s/iter; left time: 14.4962s
	iters: 200, epoch: 5 | loss: 0.2406131
	speed: 0.0034s/iter; left time: 6.4039s
	iters: 300, epoch: 5 | loss: 0.4782013
	speed: 0.0034s/iter; left time: 6.0362s
	iters: 400, epoch: 5 | loss: 0.3945336
	speed: 0.0034s/iter; left time: 5.7356s
	iters: 500, epoch: 5 | loss: 0.2801351
	speed: 0.0034s/iter; left time: 5.4031s
Updating learning rate to 0.0003657696966164686
Epoch: 5 cost time: 1.7960560321807861
Epoch: 5, Steps: 523 | Train Loss: 0.3493060 Vali Loss: 0.3275652 Best vali loss: 0.3077069
	iters: 100, epoch: 6 | loss: 0.2747977
	speed: 0.0071s/iter; left time: 10.4275s
	iters: 200, epoch: 6 | loss: 0.3027764
	speed: 0.0034s/iter; left time: 4.6237s
	iters: 300, epoch: 6 | loss: 0.4029473
	speed: 0.0033s/iter; left time: 4.2498s
	iters: 400, epoch: 6 | loss: 0.4592872
	speed: 0.0034s/iter; left time: 3.9473s
	iters: 500, epoch: 6 | loss: 0.5405006
	speed: 0.0034s/iter; left time: 3.5917s
Updating learning rate to 0.00017354380135440743
Epoch: 6 cost time: 1.7889814376831055
Epoch: 6, Steps: 523 | Train Loss: 0.3960618 Vali Loss: 0.3291052 Best vali loss: 0.3077069
	iters: 100, epoch: 7 | loss: 0.4148721
	speed: 0.0071s/iter; left time: 6.7360s
	iters: 200, epoch: 7 | loss: 0.5715620
	speed: 0.0034s/iter; left time: 2.8459s
	iters: 300, epoch: 7 | loss: 0.5634729
	speed: 0.0034s/iter; left time: 2.5266s
	iters: 400, epoch: 7 | loss: 0.4265236
	speed: 0.0034s/iter; left time: 2.1733s
	iters: 500, epoch: 7 | loss: 0.2789365
	speed: 0.0034s/iter; left time: 1.8360s
Updating learning rate to 4.5102564485385555e-05
Epoch: 7 cost time: 1.7930810451507568
Epoch: 7, Steps: 523 | Train Loss: 0.4510734 Vali Loss: 0.3557889 Best vali loss: 0.3077069
	iters: 100, epoch: 8 | loss: 0.3626283
	speed: 0.0073s/iter; left time: 3.0956s
	iters: 200, epoch: 8 | loss: 0.4244418
	speed: 0.0033s/iter; left time: 1.0843s
	iters: 300, epoch: 8 | loss: 0.4702854
	speed: 0.0034s/iter; left time: 0.7582s
	iters: 400, epoch: 8 | loss: 0.5869907
	speed: 0.0034s/iter; left time: 0.4191s
	iters: 500, epoch: 8 | loss: 0.8835569
	speed: 0.0032s/iter; left time: 0.0770s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7792270183563232
Epoch: 8, Steps: 523 | Train Loss: 0.5455806 Vali Loss: 0.3565850 Best vali loss: 0.3077069

best validation loss 0.30770690543538975

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0056403964723, 'e_layers': 4, 'learning_rate': 0.0002890798508, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002890798508
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 0.9983320236206055
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2785559 Best vali loss: 0.2785559
Updating learning rate to 0.0001445399254
Epoch: 2 cost time: 0.7665526866912842
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2882446 Best vali loss: 0.2785559
Updating learning rate to 7.22699627e-05
Epoch: 3 cost time: 0.769636869430542
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3021217 Best vali loss: 0.2785559
Updating learning rate to 3.613498135e-05
Epoch: 4 cost time: 0.7708489894866943
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3075752 Best vali loss: 0.2785559
Updating learning rate to 1.8067490675e-05
Epoch: 5 cost time: 0.7655777931213379
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3056261 Best vali loss: 0.2785559
Updating learning rate to 9.0337453375e-06
Epoch: 6 cost time: 0.7810616493225098
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2990464 Best vali loss: 0.2785559
Updating learning rate to 4.51687266875e-06
Epoch: 7 cost time: 0.7818400859832764
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3040300 Best vali loss: 0.2785559
Updating learning rate to 2.258436334375e-06
Epoch: 8 cost time: 0.7719800472259521
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3030531 Best vali loss: 0.2785559

best validation loss 0.27855588020822647

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010248814997, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597030
	speed: 0.0103s/iter; left time: 9.8115s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9306347370147705
Epoch: 1, Steps: 131 | Train Loss: 0.5597030 Vali Loss: 0.2756207 Best vali loss: 0.2756207
	iters: 100, epoch: 2 | loss: 0.3252069
	speed: 0.0089s/iter; left time: 7.2404s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2704).  Saving model state dict ...
Epoch: 2 cost time: 0.7000412940979004
Epoch: 2, Steps: 131 | Train Loss: 0.3252069 Vali Loss: 0.2704096 Best vali loss: 0.2704096
	iters: 100, epoch: 3 | loss: 0.4605612
	speed: 0.0090s/iter; left time: 6.1954s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7037646770477295
Epoch: 3, Steps: 131 | Train Loss: 0.4605612 Vali Loss: 0.2817050 Best vali loss: 0.2704096

best validation loss 0.2704096453790108

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002344480312, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597159
	speed: 0.0105s/iter; left time: 9.9509s
Updating learning rate to 0.0002344480312
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9433166980743408
Epoch: 1, Steps: 131 | Train Loss: 0.5597159 Vali Loss: 0.2756395 Best vali loss: 0.2756395
	iters: 100, epoch: 2 | loss: 0.3266950
	speed: 0.0089s/iter; left time: 7.2755s
Updating learning rate to 0.0001172240156
Validation loss decreased (0.2756 --> 0.2728).  Saving model state dict ...
Epoch: 2 cost time: 0.7041535377502441
Epoch: 2, Steps: 131 | Train Loss: 0.3266950 Vali Loss: 0.2728320 Best vali loss: 0.2728320
	iters: 100, epoch: 3 | loss: 0.4642806
	speed: 0.0089s/iter; left time: 6.1432s
Updating learning rate to 5.86120078e-05
Epoch: 3 cost time: 0.7045450210571289
Epoch: 3, Steps: 131 | Train Loss: 0.4642806 Vali Loss: 0.2864531 Best vali loss: 0.2728320

best validation loss 0.2728320093525524

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.000234761628, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597316
	speed: 0.0104s/iter; left time: 9.9157s
Updating learning rate to 0.000234761628
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9183096885681152
Epoch: 1, Steps: 131 | Train Loss: 0.5597316 Vali Loss: 0.2756483 Best vali loss: 0.2756483
	iters: 100, epoch: 2 | loss: 0.3263842
	speed: 0.0088s/iter; left time: 7.1739s
Updating learning rate to 0.000117380814
Validation loss decreased (0.2756 --> 0.2718).  Saving model state dict ...
Epoch: 2 cost time: 0.6965103149414062
Epoch: 2, Steps: 131 | Train Loss: 0.3263842 Vali Loss: 0.2717988 Best vali loss: 0.2717988
	iters: 100, epoch: 3 | loss: 0.4614306
	speed: 0.0088s/iter; left time: 6.0522s
Updating learning rate to 5.8690407e-05
Epoch: 3 cost time: 0.7011387348175049
Epoch: 3, Steps: 131 | Train Loss: 0.4614306 Vali Loss: 0.2834289 Best vali loss: 0.2717988

best validation loss 0.2717988476428723

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010248814997, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4266613
	speed: 0.0107s/iter; left time: 5.9706s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9303562641143799
Epoch: 4, Steps: 131 | Train Loss: 0.4266613 Vali Loss: 0.3076506 Best vali loss: 0.2704096
	iters: 100, epoch: 5 | loss: 0.2808943
	speed: 0.0086s/iter; left time: 3.6622s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6957736015319824
Epoch: 5, Steps: 131 | Train Loss: 0.2808943 Vali Loss: 0.3013078 Best vali loss: 0.2704096
	iters: 100, epoch: 6 | loss: 0.4349678
	speed: 0.0087s/iter; left time: 2.5707s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7071237564086914
Epoch: 6, Steps: 131 | Train Loss: 0.4349678 Vali Loss: 0.3035522 Best vali loss: 0.2704096
	iters: 100, epoch: 7 | loss: 0.4656061
	speed: 0.0086s/iter; left time: 1.4082s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6969695091247559
Epoch: 7, Steps: 131 | Train Loss: 0.4656061 Vali Loss: 0.3042447 Best vali loss: 0.2704096
	iters: 100, epoch: 8 | loss: 0.3276595
	speed: 0.0086s/iter; left time: 0.2754s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6973378658294678
Epoch: 8, Steps: 131 | Train Loss: 0.3276595 Vali Loss: 0.2994160 Best vali loss: 0.2704096

best validation loss 0.2704096453790108

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002347579153, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597317
	speed: 0.0104s/iter; left time: 9.9158s
Updating learning rate to 0.0002347579153
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9331142902374268
Epoch: 1, Steps: 131 | Train Loss: 0.5597317 Vali Loss: 0.2756482 Best vali loss: 0.2756482
	iters: 100, epoch: 2 | loss: 0.3256822
	speed: 0.0089s/iter; left time: 7.2723s
Updating learning rate to 0.00011737895765
Validation loss decreased (0.2756 --> 0.2724).  Saving model state dict ...
Epoch: 2 cost time: 0.7062742710113525
Epoch: 2, Steps: 131 | Train Loss: 0.3256822 Vali Loss: 0.2724151 Best vali loss: 0.2724151
	iters: 100, epoch: 3 | loss: 0.4633058
	speed: 0.0091s/iter; left time: 6.2586s
Updating learning rate to 5.8689478825e-05
Epoch: 3 cost time: 0.7048122882843018
Epoch: 3, Steps: 131 | Train Loss: 0.4633058 Vali Loss: 0.2837727 Best vali loss: 0.2724151
	iters: 100, epoch: 4 | loss: 0.5092246
	speed: 0.0086s/iter; left time: 4.8075s
Updating learning rate to 2.93447394125e-05
Epoch: 4 cost time: 0.6968369483947754
Epoch: 4, Steps: 131 | Train Loss: 0.5092246 Vali Loss: 0.2889162 Best vali loss: 0.2724151
	iters: 100, epoch: 5 | loss: 0.3325913
	speed: 0.0086s/iter; left time: 3.6423s
Updating learning rate to 1.467236970625e-05
Epoch: 5 cost time: 0.697014570236206
Epoch: 5, Steps: 131 | Train Loss: 0.3325913 Vali Loss: 0.2869871 Best vali loss: 0.2724151
	iters: 100, epoch: 6 | loss: 0.3177238
	speed: 0.0087s/iter; left time: 2.5550s
Updating learning rate to 7.336184853125e-06
Epoch: 6 cost time: 0.7042622566223145
Epoch: 6, Steps: 131 | Train Loss: 0.3177238 Vali Loss: 0.2917465 Best vali loss: 0.2724151
	iters: 100, epoch: 7 | loss: 0.3116515
	speed: 0.0087s/iter; left time: 1.4143s
Updating learning rate to 3.6680924265625e-06
Epoch: 7 cost time: 0.700430154800415
Epoch: 7, Steps: 131 | Train Loss: 0.3116515 Vali Loss: 0.2978713 Best vali loss: 0.2724151
	iters: 100, epoch: 8 | loss: 0.3957136
	speed: 0.0087s/iter; left time: 0.2791s
Updating learning rate to 1.83404621328125e-06
Epoch: 8 cost time: 0.7067179679870605
Epoch: 8, Steps: 131 | Train Loss: 0.3957136 Vali Loss: 0.2973672 Best vali loss: 0.2724151

best validation loss 0.27241506415612193

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.001783382997, 'e_layers': 3, 'learning_rate': 0.0001817422073, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0001817422073
Validation loss decreased (inf --> 0.2926).  Saving model state dict ...
Epoch: 1 cost time: 0.6246752738952637
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2926204 Best vali loss: 0.2926204
Updating learning rate to 9.087110365e-05
Validation loss decreased (0.2926 --> 0.2814).  Saving model state dict ...
Epoch: 2 cost time: 0.39258456230163574
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2813500 Best vali loss: 0.2813500
Updating learning rate to 4.5435551825e-05
Validation loss decreased (0.2814 --> 0.2803).  Saving model state dict ...
Epoch: 3 cost time: 0.3863983154296875
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2803062 Best vali loss: 0.2803062
Updating learning rate to 2.27177759125e-05
Validation loss decreased (0.2803 --> 0.2803).  Saving model state dict ...
Epoch: 4 cost time: 0.38916468620300293
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2802694 Best vali loss: 0.2802694
Updating learning rate to 1.135888795625e-05
Validation loss decreased (0.2803 --> 0.2802).  Saving model state dict ...
Epoch: 5 cost time: 0.3946094512939453
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2802136 Best vali loss: 0.2802136
Updating learning rate to 5.679443978125e-06
Epoch: 6 cost time: 0.38083887100219727
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2803155 Best vali loss: 0.2802136
Updating learning rate to 2.8397219890625e-06
Epoch: 7 cost time: 0.37856554985046387
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2803540 Best vali loss: 0.2802136
Updating learning rate to 1.41986099453125e-06
Epoch: 8 cost time: 0.3945801258087158
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2803028 Best vali loss: 0.2802136

best validation loss 0.2802136075589771

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010971007413, 'e_layers': 1, 'learning_rate': 0.0029884574731, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0585654
	speed: 0.0079s/iter; left time: 32.0745s
	iters: 200, epoch: 1 | loss: 0.4687079
	speed: 0.0025s/iter; left time: 10.0229s
	iters: 300, epoch: 1 | loss: 1.0541146
	speed: 0.0024s/iter; left time: 9.4205s
	iters: 400, epoch: 1 | loss: 0.6007906
	speed: 0.0024s/iter; left time: 9.2555s
	iters: 500, epoch: 1 | loss: 0.9112575
	speed: 0.0024s/iter; left time: 9.0278s
Updating learning rate to 0.002874716083138745
Validation loss decreased (inf --> 0.2933).  Saving model state dict ...
Epoch: 1 cost time: 1.5672211647033691
Epoch: 1, Steps: 523 | Train Loss: 0.8186872 Vali Loss: 0.2933156 Best vali loss: 0.2933156
	iters: 100, epoch: 2 | loss: 0.2814430
	speed: 0.0059s/iter; left time: 21.0856s
	iters: 200, epoch: 2 | loss: 0.2631159
	speed: 0.0025s/iter; left time: 8.7767s
	iters: 300, epoch: 2 | loss: 0.5031943
	speed: 0.0025s/iter; left time: 8.4887s
	iters: 400, epoch: 2 | loss: 0.7691247
	speed: 0.0025s/iter; left time: 8.1563s
	iters: 500, epoch: 2 | loss: 0.9495443
	speed: 0.0024s/iter; left time: 7.7270s
Updating learning rate to 0.002550808008808312
Validation loss decreased (0.2933 --> 0.2887).  Saving model state dict ...
Epoch: 2 cost time: 1.3388876914978027
Epoch: 2, Steps: 523 | Train Loss: 0.5532844 Vali Loss: 0.2886969 Best vali loss: 0.2886969
	iters: 100, epoch: 3 | loss: 0.4670463
	speed: 0.0056s/iter; left time: 17.0937s
	iters: 200, epoch: 3 | loss: 0.4481046
	speed: 0.0024s/iter; left time: 6.9180s
	iters: 300, epoch: 3 | loss: 0.5299546
	speed: 0.0023s/iter; left time: 6.6705s
	iters: 400, epoch: 3 | loss: 0.4734224
	speed: 0.0023s/iter; left time: 6.4353s
	iters: 500, epoch: 3 | loss: 0.4843884
	speed: 0.0024s/iter; left time: 6.2559s
Updating learning rate to 0.0020660453181915056
Epoch: 3 cost time: 1.2707061767578125
Epoch: 3, Steps: 523 | Train Loss: 0.4805832 Vali Loss: 0.2986852 Best vali loss: 0.2886969

best validation loss 0.288696930072883

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010257880548, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597237
	speed: 0.0106s/iter; left time: 10.0156s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9505290985107422
Epoch: 1, Steps: 131 | Train Loss: 0.5597237 Vali Loss: 0.2756483 Best vali loss: 0.2756483
	iters: 100, epoch: 2 | loss: 0.3249697
	speed: 0.0090s/iter; left time: 7.3524s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2702).  Saving model state dict ...
Epoch: 2 cost time: 0.705657958984375
Epoch: 2, Steps: 131 | Train Loss: 0.3249697 Vali Loss: 0.2701609 Best vali loss: 0.2701609
	iters: 100, epoch: 3 | loss: 0.4615843
	speed: 0.0089s/iter; left time: 6.1306s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.7012519836425781
Epoch: 3, Steps: 131 | Train Loss: 0.4615843 Vali Loss: 0.2790138 Best vali loss: 0.2701609

best validation loss 0.2701608809497375

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010241593292, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596900
	speed: 0.0103s/iter; left time: 9.7720s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9250872135162354
Epoch: 1, Steps: 131 | Train Loss: 0.5596900 Vali Loss: 0.2756391 Best vali loss: 0.2756391
	iters: 100, epoch: 2 | loss: 0.3252128
	speed: 0.0089s/iter; left time: 7.2874s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2756 --> 0.2703).  Saving model state dict ...
Epoch: 2 cost time: 0.7022652626037598
Epoch: 2, Steps: 131 | Train Loss: 0.3252128 Vali Loss: 0.2702871 Best vali loss: 0.2702871
	iters: 100, epoch: 3 | loss: 0.4629647
	speed: 0.0091s/iter; left time: 6.2661s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.7075791358947754
Epoch: 3, Steps: 131 | Train Loss: 0.4629647 Vali Loss: 0.2786514 Best vali loss: 0.2702871

best validation loss 0.2702870601036594

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010257880548, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4239175
	speed: 0.0107s/iter; left time: 5.9625s
Updating learning rate to 2.93167934875e-05
Epoch: 4 cost time: 0.9378113746643066
Epoch: 4, Steps: 131 | Train Loss: 0.4239175 Vali Loss: 0.3053504 Best vali loss: 0.2701609
	iters: 100, epoch: 5 | loss: 0.2806280
	speed: 0.0087s/iter; left time: 3.7073s
Updating learning rate to 1.465839674375e-05
Epoch: 5 cost time: 0.6992232799530029
Epoch: 5, Steps: 131 | Train Loss: 0.2806280 Vali Loss: 0.2933681 Best vali loss: 0.2701609
	iters: 100, epoch: 6 | loss: 0.4346632
	speed: 0.0086s/iter; left time: 2.5259s
Updating learning rate to 7.329198371875e-06
Epoch: 6 cost time: 0.694915771484375
Epoch: 6, Steps: 131 | Train Loss: 0.4346632 Vali Loss: 0.2973561 Best vali loss: 0.2701609
	iters: 100, epoch: 7 | loss: 0.4658882
	speed: 0.0087s/iter; left time: 1.4113s
Updating learning rate to 3.6645991859375e-06
Epoch: 7 cost time: 0.6963238716125488
Epoch: 7, Steps: 131 | Train Loss: 0.4658882 Vali Loss: 0.2969704 Best vali loss: 0.2701609
	iters: 100, epoch: 8 | loss: 0.3287846
	speed: 0.0086s/iter; left time: 0.2766s
Updating learning rate to 1.83229959296875e-06
Epoch: 8 cost time: 0.7076873779296875
Epoch: 8, Steps: 131 | Train Loss: 0.3287846 Vali Loss: 0.2947572 Best vali loss: 0.2701609

best validation loss 0.2701608809497375

[INFO][smbo.py:320] Finished 700 trials.
{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016283669919, 'e_layers': 2, 'learning_rate': 0.0002153438962, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3664927
	speed: 0.0086s/iter; left time: 71.0089s
	iters: 200, epoch: 1 | loss: 0.2525960
	speed: 0.0032s/iter; left time: 26.3025s
	iters: 300, epoch: 1 | loss: 0.2998595
	speed: 0.0033s/iter; left time: 26.5794s
	iters: 400, epoch: 1 | loss: 0.2878259
	speed: 0.0032s/iter; left time: 25.8124s
	iters: 500, epoch: 1 | loss: 0.1771040
	speed: 0.0033s/iter; left time: 26.0385s
	iters: 600, epoch: 1 | loss: 0.1706871
	speed: 0.0033s/iter; left time: 25.9680s
	iters: 700, epoch: 1 | loss: 0.7247168
	speed: 0.0033s/iter; left time: 25.3614s
	iters: 800, epoch: 1 | loss: 0.3406124
	speed: 0.0033s/iter; left time: 24.7284s
	iters: 900, epoch: 1 | loss: 0.2700946
	speed: 0.0034s/iter; left time: 25.1916s
	iters: 1000, epoch: 1 | loss: 0.5723628
	speed: 0.0034s/iter; left time: 24.9876s
Updating learning rate to 0.0002153438962
Validation loss decreased (inf --> 0.2938).  Saving model state dict ...
Epoch: 1 cost time: 3.7265448570251465
Epoch: 1, Steps: 1045 | Train Loss: 0.3462352 Vali Loss: 0.2937983 Best vali loss: 0.2937983
	iters: 100, epoch: 2 | loss: 0.8519970
	speed: 0.0100s/iter; left time: 72.3000s
	iters: 200, epoch: 2 | loss: 0.4197699
	speed: 0.0031s/iter; left time: 22.2147s
	iters: 300, epoch: 2 | loss: 0.3155989
	speed: 0.0031s/iter; left time: 21.9419s
	iters: 400, epoch: 2 | loss: 0.5576861
	speed: 0.0031s/iter; left time: 21.7472s
	iters: 500, epoch: 2 | loss: 0.3320735
	speed: 0.0031s/iter; left time: 21.3135s
	iters: 600, epoch: 2 | loss: 0.3091357
	speed: 0.0031s/iter; left time: 20.8466s
	iters: 700, epoch: 2 | loss: 0.6388885
	speed: 0.0031s/iter; left time: 20.4825s
	iters: 800, epoch: 2 | loss: 0.3214979
	speed: 0.0031s/iter; left time: 20.4445s
	iters: 900, epoch: 2 | loss: 0.8005059
	speed: 0.0031s/iter; left time: 20.0795s
	iters: 1000, epoch: 2 | loss: 0.1910259
	speed: 0.0031s/iter; left time: 19.7241s
Updating learning rate to 0.0001076719481
Validation loss decreased (0.2938 --> 0.2854).  Saving model state dict ...
Epoch: 2 cost time: 3.3040010929107666
Epoch: 2, Steps: 1045 | Train Loss: 0.4738179 Vali Loss: 0.2854480 Best vali loss: 0.2854480
	iters: 100, epoch: 3 | loss: 0.4222687
	speed: 0.0102s/iter; left time: 63.2508s
	iters: 200, epoch: 3 | loss: 0.5524799
	speed: 0.0029s/iter; left time: 17.7337s
	iters: 300, epoch: 3 | loss: 0.4514993
	speed: 0.0029s/iter; left time: 17.4826s
	iters: 400, epoch: 3 | loss: 0.1940881
	speed: 0.0029s/iter; left time: 17.2292s
	iters: 500, epoch: 3 | loss: 0.3360468
	speed: 0.0030s/iter; left time: 17.3816s
	iters: 600, epoch: 3 | loss: 0.1189992
	speed: 0.0031s/iter; left time: 17.8263s
	iters: 700, epoch: 3 | loss: 0.9333624
	speed: 0.0031s/iter; left time: 17.4296s
	iters: 800, epoch: 3 | loss: 0.9266624
	speed: 0.0032s/iter; left time: 17.2434s
	iters: 900, epoch: 3 | loss: 0.2662598
	speed: 0.0032s/iter; left time: 17.3130s
	iters: 1000, epoch: 3 | loss: 0.6435987
	speed: 0.0033s/iter; left time: 17.5524s
Updating learning rate to 5.383597405e-05
Validation loss decreased (0.2854 --> 0.2765).  Saving model state dict ...
Epoch: 3 cost time: 3.26362681388855
Epoch: 3, Steps: 1045 | Train Loss: 0.4845265 Vali Loss: 0.2765048 Best vali loss: 0.2765048
	iters: 100, epoch: 4 | loss: 0.5387653
	speed: 0.0103s/iter; left time: 52.9219s
	iters: 200, epoch: 4 | loss: 0.5146123
	speed: 0.0033s/iter; left time: 16.8065s
	iters: 300, epoch: 4 | loss: 0.2376683
	speed: 0.0033s/iter; left time: 16.4135s
	iters: 400, epoch: 4 | loss: 0.2908149
	speed: 0.0033s/iter; left time: 16.0302s
	iters: 500, epoch: 4 | loss: 0.6360966
	speed: 0.0033s/iter; left time: 15.7747s
	iters: 600, epoch: 4 | loss: 0.6421981
	speed: 0.0033s/iter; left time: 15.3295s
	iters: 700, epoch: 4 | loss: 0.2063547
	speed: 0.0033s/iter; left time: 15.1461s
	iters: 800, epoch: 4 | loss: 0.4094405
	speed: 0.0033s/iter; left time: 14.6884s
	iters: 900, epoch: 4 | loss: 0.2486234
	speed: 0.0033s/iter; left time: 14.3399s
	iters: 1000, epoch: 4 | loss: 0.3363315
	speed: 0.0033s/iter; left time: 14.1047s
Updating learning rate to 2.6917987025e-05
Epoch: 4 cost time: 3.515254497528076
Epoch: 4, Steps: 1045 | Train Loss: 0.4060905 Vali Loss: 0.2785578 Best vali loss: 0.2765048
	iters: 100, epoch: 5 | loss: 0.6532066
	speed: 0.0101s/iter; left time: 41.1795s
	iters: 200, epoch: 5 | loss: 0.3393809
	speed: 0.0031s/iter; left time: 12.3611s
	iters: 300, epoch: 5 | loss: 0.2924428
	speed: 0.0032s/iter; left time: 12.4334s
	iters: 400, epoch: 5 | loss: 0.7752274
	speed: 0.0034s/iter; left time: 12.6698s
	iters: 500, epoch: 5 | loss: 0.3084175
	speed: 0.0033s/iter; left time: 12.2594s
	iters: 600, epoch: 5 | loss: 0.5303445
	speed: 0.0033s/iter; left time: 11.9506s
	iters: 700, epoch: 5 | loss: 0.2118272
	speed: 0.0034s/iter; left time: 11.6851s
	iters: 800, epoch: 5 | loss: 0.2348856
	speed: 0.0034s/iter; left time: 11.4730s
	iters: 900, epoch: 5 | loss: 0.2174603
	speed: 0.0033s/iter; left time: 10.9808s
	iters: 1000, epoch: 5 | loss: 0.3730503
	speed: 0.0034s/iter; left time: 10.6667s
Updating learning rate to 1.34589935125e-05
Epoch: 5 cost time: 3.4751434326171875
Epoch: 5, Steps: 1045 | Train Loss: 0.3936243 Vali Loss: 0.2773957 Best vali loss: 0.2765048
	iters: 100, epoch: 6 | loss: 0.1972868
	speed: 0.0098s/iter; left time: 29.6036s
	iters: 200, epoch: 6 | loss: 0.2888124
	speed: 0.0032s/iter; left time: 9.2813s
	iters: 300, epoch: 6 | loss: 0.4189720
	speed: 0.0033s/iter; left time: 9.4543s
	iters: 400, epoch: 6 | loss: 0.4740045
	speed: 0.0031s/iter; left time: 8.5891s
	iters: 500, epoch: 6 | loss: 0.1243570
	speed: 0.0031s/iter; left time: 8.2631s
	iters: 600, epoch: 6 | loss: 0.5095971
	speed: 0.0033s/iter; left time: 8.3372s
	iters: 700, epoch: 6 | loss: 0.7647558
	speed: 0.0033s/iter; left time: 8.1369s
	iters: 800, epoch: 6 | loss: 0.2320893
	speed: 0.0030s/iter; left time: 7.0468s
	iters: 900, epoch: 6 | loss: 0.2864277
	speed: 0.0030s/iter; left time: 6.6357s
	iters: 1000, epoch: 6 | loss: 0.3537082
	speed: 0.0030s/iter; left time: 6.5134s
Updating learning rate to 6.72949675625e-06
Epoch: 6 cost time: 3.3167266845703125
Epoch: 6, Steps: 1045 | Train Loss: 0.3650011 Vali Loss: 0.2790792 Best vali loss: 0.2765048
	iters: 100, epoch: 7 | loss: 0.7084022
	speed: 0.0099s/iter; left time: 19.6716s
	iters: 200, epoch: 7 | loss: 0.9091367
	speed: 0.0033s/iter; left time: 6.2635s
	iters: 300, epoch: 7 | loss: 0.5212028
	speed: 0.0033s/iter; left time: 5.9533s
	iters: 400, epoch: 7 | loss: 0.1449597
	speed: 0.0033s/iter; left time: 5.5901s
	iters: 500, epoch: 7 | loss: 0.8481552
	speed: 0.0033s/iter; left time: 5.2940s
	iters: 600, epoch: 7 | loss: 0.4107394
	speed: 0.0033s/iter; left time: 4.9039s
	iters: 700, epoch: 7 | loss: 0.6562281
	speed: 0.0033s/iter; left time: 4.6040s
	iters: 800, epoch: 7 | loss: 0.4401925
	speed: 0.0034s/iter; left time: 4.4190s
	iters: 900, epoch: 7 | loss: 0.2289816
	speed: 0.0035s/iter; left time: 4.1547s
	iters: 1000, epoch: 7 | loss: 0.2691318
	speed: 0.0034s/iter; left time: 3.7546s
Updating learning rate to 3.364748378125e-06
Epoch: 7 cost time: 3.549067974090576
Epoch: 7, Steps: 1045 | Train Loss: 0.5137130 Vali Loss: 0.2821578 Best vali loss: 0.2765048
	iters: 100, epoch: 8 | loss: 0.5214008
	speed: 0.0101s/iter; left time: 9.5458s
	iters: 200, epoch: 8 | loss: 0.2066757
	speed: 0.0033s/iter; left time: 2.8102s
	iters: 300, epoch: 8 | loss: 0.2097231
	speed: 0.0033s/iter; left time: 2.4718s
	iters: 400, epoch: 8 | loss: 0.3613499
	speed: 0.0033s/iter; left time: 2.1518s
	iters: 500, epoch: 8 | loss: 0.1274020
	speed: 0.0033s/iter; left time: 1.7896s
	iters: 600, epoch: 8 | loss: 0.5148522
	speed: 0.0032s/iter; left time: 1.4086s
	iters: 700, epoch: 8 | loss: 0.2693856
	speed: 0.0031s/iter; left time: 1.0808s
	iters: 800, epoch: 8 | loss: 0.1618781
	speed: 0.0032s/iter; left time: 0.7869s
	iters: 900, epoch: 8 | loss: 0.1445276
	speed: 0.0032s/iter; left time: 0.4631s
	iters: 1000, epoch: 8 | loss: 0.7530992
	speed: 0.0032s/iter; left time: 0.1450s
Updating learning rate to 1.6823741890625e-06
Epoch: 8 cost time: 3.4152512550354004
Epoch: 8, Steps: 1045 | Train Loss: 0.3270294 Vali Loss: 0.2838441 Best vali loss: 0.2765048

best validation loss 0.2765047552196365

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0040068643978, 'e_layers': 2, 'learning_rate': 5.04491378e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3759603
	speed: 0.0094s/iter; left time: 8.8918s
Updating learning rate to 4.852903182313074e-05
Validation loss decreased (inf --> 0.3096).  Saving model state dict ...
Epoch: 1 cost time: 0.7898802757263184
Epoch: 1, Steps: 131 | Train Loss: 0.3759603 Vali Loss: 0.3095888 Best vali loss: 0.3095888
	iters: 100, epoch: 2 | loss: 0.3305215
	speed: 0.0066s/iter; left time: 5.3990s
Updating learning rate to 4.306103262169729e-05
Validation loss decreased (0.3096 --> 0.2922).  Saving model state dict ...
Epoch: 2 cost time: 0.5143899917602539
Epoch: 2, Steps: 131 | Train Loss: 0.3305215 Vali Loss: 0.2922486 Best vali loss: 0.2922486
	iters: 100, epoch: 3 | loss: 0.2731612
	speed: 0.0067s/iter; left time: 4.5892s
Updating learning rate to 3.4877593506581695e-05
Validation loss decreased (0.2922 --> 0.2853).  Saving model state dict ...
Epoch: 3 cost time: 0.5292277336120605
Epoch: 3, Steps: 131 | Train Loss: 0.2731612 Vali Loss: 0.2852573 Best vali loss: 0.2852573
	iters: 100, epoch: 4 | loss: 0.4638055
	speed: 0.0065s/iter; left time: 3.6066s
Updating learning rate to 2.52245689e-05
Validation loss decreased (0.2853 --> 0.2827).  Saving model state dict ...
Epoch: 4 cost time: 0.5065197944641113
Epoch: 4, Steps: 131 | Train Loss: 0.4638055 Vali Loss: 0.2827445 Best vali loss: 0.2827445
	iters: 100, epoch: 5 | loss: 0.4373103
	speed: 0.0062s/iter; left time: 2.6328s
Updating learning rate to 1.5571544293418303e-05
Validation loss decreased (0.2827 --> 0.2812).  Saving model state dict ...
Epoch: 5 cost time: 0.48399925231933594
Epoch: 5, Steps: 131 | Train Loss: 0.4373103 Vali Loss: 0.2812257 Best vali loss: 0.2812257
	iters: 100, epoch: 6 | loss: 0.5108351
	speed: 0.0064s/iter; left time: 1.8775s
Updating learning rate to 7.38810517830271e-06
Validation loss decreased (0.2812 --> 0.2806).  Saving model state dict ...
Epoch: 6 cost time: 0.5022566318511963
Epoch: 6, Steps: 131 | Train Loss: 0.5108351 Vali Loss: 0.2806008 Best vali loss: 0.2806008
	iters: 100, epoch: 7 | loss: 0.6305141
	speed: 0.0064s/iter; left time: 1.0470s
Updating learning rate to 1.9201059768692575e-06
Validation loss decreased (0.2806 --> 0.2805).  Saving model state dict ...
Epoch: 7 cost time: 0.5173308849334717
Epoch: 7, Steps: 131 | Train Loss: 0.6305141 Vali Loss: 0.2804718 Best vali loss: 0.2804718
	iters: 100, epoch: 8 | loss: 0.5685234
	speed: 0.0065s/iter; left time: 0.2067s
Updating learning rate to 0.0
Validation loss decreased (0.2805 --> 0.2804).  Saving model state dict ...
Epoch: 8 cost time: 0.4938809871673584
Epoch: 8, Steps: 131 | Train Loss: 0.5685234 Vali Loss: 0.2803983 Best vali loss: 0.2803983

best validation loss 0.28039834639227224

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0040449239681, 'e_layers': 2, 'learning_rate': 5.19830897e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3750691
	speed: 0.0095s/iter; left time: 8.9751s
Updating learning rate to 5.000460115526414e-05
Validation loss decreased (inf --> 0.3088).  Saving model state dict ...
Epoch: 1 cost time: 0.7936875820159912
Epoch: 1, Steps: 131 | Train Loss: 0.3750691 Vali Loss: 0.3087920 Best vali loss: 0.3087920
	iters: 100, epoch: 2 | loss: 0.3296569
	speed: 0.0070s/iter; left time: 5.7566s
Updating learning rate to 4.437034246694928e-05
Validation loss decreased (0.3088 --> 0.2916).  Saving model state dict ...
Epoch: 2 cost time: 0.5634613037109375
Epoch: 2, Steps: 131 | Train Loss: 0.3296569 Vali Loss: 0.2916025 Best vali loss: 0.2916025
	iters: 100, epoch: 3 | loss: 0.2726111
	speed: 0.0065s/iter; left time: 4.4420s
Updating learning rate to 3.593807844566917e-05
Validation loss decreased (0.2916 --> 0.2848).  Saving model state dict ...
Epoch: 3 cost time: 0.49807238578796387
Epoch: 3, Steps: 131 | Train Loss: 0.2726111 Vali Loss: 0.2848214 Best vali loss: 0.2848214

best validation loss 0.28482138969256293

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0093823758661, 'e_layers': 2, 'learning_rate': 5.21008665e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3751190
	speed: 0.0095s/iter; left time: 8.9885s
Updating learning rate to 5.011789534272648e-05
Validation loss decreased (inf --> 0.3087).  Saving model state dict ...
Epoch: 1 cost time: 0.7718386650085449
Epoch: 1, Steps: 131 | Train Loss: 0.3751190 Vali Loss: 0.3087298 Best vali loss: 0.3087298
	iters: 100, epoch: 2 | loss: 0.3297162
	speed: 0.0065s/iter; left time: 5.2855s
Updating learning rate to 4.447087125392251e-05
Validation loss decreased (0.3087 --> 0.2915).  Saving model state dict ...
Epoch: 2 cost time: 0.5210342407226562
Epoch: 2, Steps: 131 | Train Loss: 0.3297162 Vali Loss: 0.2915461 Best vali loss: 0.2915461
	iters: 100, epoch: 3 | loss: 0.2728374
	speed: 0.0064s/iter; left time: 4.4020s
Updating learning rate to 3.601950246070766e-05
Validation loss decreased (0.2915 --> 0.2848).  Saving model state dict ...
Epoch: 3 cost time: 0.49993324279785156
Epoch: 3, Steps: 131 | Train Loss: 0.2728374 Vali Loss: 0.2847893 Best vali loss: 0.2847893

best validation loss 0.284789320686884

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0095074080943, 'e_layers': 2, 'learning_rate': 5.0895904e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3758183
	speed: 0.0094s/iter; left time: 8.8920s
Updating learning rate to 4.895879399712966e-05
Validation loss decreased (inf --> 0.3094).  Saving model state dict ...
Epoch: 1 cost time: 0.7790098190307617
Epoch: 1, Steps: 131 | Train Loss: 0.3758183 Vali Loss: 0.3093559 Best vali loss: 0.3093559
	iters: 100, epoch: 2 | loss: 0.3304056
	speed: 0.0067s/iter; left time: 5.4899s
Updating learning rate to 4.344237142650976e-05
Validation loss decreased (0.3094 --> 0.2921).  Saving model state dict ...
Epoch: 2 cost time: 0.5147233009338379
Epoch: 2, Steps: 131 | Train Loss: 0.3304056 Vali Loss: 0.2920521 Best vali loss: 0.2920521
	iters: 100, epoch: 3 | loss: 0.2732722
	speed: 0.0065s/iter; left time: 4.4876s
Updating learning rate to 3.518646161802205e-05
Validation loss decreased (0.2921 --> 0.2851).  Saving model state dict ...
Epoch: 3 cost time: 0.5105433464050293
Epoch: 3, Steps: 131 | Train Loss: 0.2732722 Vali Loss: 0.2851286 Best vali loss: 0.2851286

best validation loss 0.2851286272093371

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0093823758661, 'e_layers': 2, 'learning_rate': 5.21008665e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3364938
	speed: 0.0093s/iter; left time: 5.1512s
Updating learning rate to 2.605043325e-05
Validation loss decreased (0.2848 --> 0.2825).  Saving model state dict ...
Epoch: 4 cost time: 0.7628283500671387
Epoch: 4, Steps: 131 | Train Loss: 0.3364938 Vali Loss: 0.2824522 Best vali loss: 0.2824522
	iters: 100, epoch: 5 | loss: 0.3076327
	speed: 0.0063s/iter; left time: 2.6600s
Updating learning rate to 1.608136403929234e-05
Validation loss decreased (0.2825 --> 0.2810).  Saving model state dict ...
Epoch: 5 cost time: 0.4904055595397949
Epoch: 5, Steps: 131 | Train Loss: 0.3076327 Vali Loss: 0.2810414 Best vali loss: 0.2810414
	iters: 100, epoch: 6 | loss: 0.2652796
	speed: 0.0066s/iter; left time: 1.9264s
Updating learning rate to 7.629995246077489e-06
Validation loss decreased (0.2810 --> 0.2805).  Saving model state dict ...
Epoch: 6 cost time: 0.5434567928314209
Epoch: 6, Steps: 131 | Train Loss: 0.2652796 Vali Loss: 0.2804533 Best vali loss: 0.2804533
	iters: 100, epoch: 7 | loss: 0.4474261
	speed: 0.0069s/iter; left time: 1.1237s
Updating learning rate to 1.98297115727352e-06
Validation loss decreased (0.2805 --> 0.2803).  Saving model state dict ...
Epoch: 7 cost time: 0.5460538864135742
Epoch: 7, Steps: 131 | Train Loss: 0.4474261 Vali Loss: 0.2802797 Best vali loss: 0.2802797
	iters: 100, epoch: 8 | loss: 0.4325341
	speed: 0.0067s/iter; left time: 0.2140s
Updating learning rate to 0.0
Validation loss decreased (0.2803 --> 0.2802).  Saving model state dict ...
Epoch: 8 cost time: 0.5242621898651123
Epoch: 8, Steps: 131 | Train Loss: 0.4325341 Vali Loss: 0.2802394 Best vali loss: 0.2802394

best validation loss 0.2802393728968999

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0094048309699, 'e_layers': 2, 'learning_rate': 5.12933849e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3755832
	speed: 0.0095s/iter; left time: 9.0190s
Updating learning rate to 4.9341146681166746e-05
Validation loss decreased (inf --> 0.3091).  Saving model state dict ...
Epoch: 1 cost time: 0.7917065620422363
Epoch: 1, Steps: 131 | Train Loss: 0.3755832 Vali Loss: 0.3091448 Best vali loss: 0.3091448
	iters: 100, epoch: 2 | loss: 0.3301722
	speed: 0.0070s/iter; left time: 5.7255s
Updating learning rate to 4.378164259640083e-05
Validation loss decreased (0.3091 --> 0.2919).  Saving model state dict ...
Epoch: 2 cost time: 0.5613865852355957
Epoch: 2, Steps: 131 | Train Loss: 0.3301722 Vali Loss: 0.2918809 Best vali loss: 0.2918809
	iters: 100, epoch: 3 | loss: 0.2731160
	speed: 0.0068s/iter; left time: 4.6894s
Updating learning rate to 3.546125674557783e-05
Validation loss decreased (0.2919 --> 0.2850).  Saving model state dict ...
Epoch: 3 cost time: 0.5416522026062012
Epoch: 3, Steps: 131 | Train Loss: 0.2731160 Vali Loss: 0.2850132 Best vali loss: 0.2850132
	iters: 100, epoch: 4 | loss: 0.4631767
	speed: 0.0066s/iter; left time: 3.6578s
Updating learning rate to 2.564669245e-05
Validation loss decreased (0.2850 --> 0.2826).  Saving model state dict ...
Epoch: 4 cost time: 0.5197489261627197
Epoch: 4, Steps: 131 | Train Loss: 0.4631767 Vali Loss: 0.2825698 Best vali loss: 0.2825698
	iters: 100, epoch: 5 | loss: 0.4380789
	speed: 0.0069s/iter; left time: 2.9215s
Updating learning rate to 1.5832128154422167e-05
Validation loss decreased (0.2826 --> 0.2811).  Saving model state dict ...
Epoch: 5 cost time: 0.5552740097045898
Epoch: 5, Steps: 131 | Train Loss: 0.4380789 Vali Loss: 0.2810846 Best vali loss: 0.2810846
	iters: 100, epoch: 6 | loss: 0.5116702
	speed: 0.0064s/iter; left time: 1.8685s
Updating learning rate to 7.511742303599171e-06
Validation loss decreased (0.2811 --> 0.2805).  Saving model state dict ...
Epoch: 6 cost time: 0.49781370162963867
Epoch: 6, Steps: 131 | Train Loss: 0.5116702 Vali Loss: 0.2804718 Best vali loss: 0.2804718
	iters: 100, epoch: 7 | loss: 0.6300339
	speed: 0.0066s/iter; left time: 1.0787s
Updating learning rate to 1.952238218833253e-06
Validation loss decreased (0.2805 --> 0.2804).  Saving model state dict ...
Epoch: 7 cost time: 0.5234954357147217
Epoch: 7, Steps: 131 | Train Loss: 0.6300339 Vali Loss: 0.2803569 Best vali loss: 0.2803569
	iters: 100, epoch: 8 | loss: 0.5686359
	speed: 0.0067s/iter; left time: 0.2134s
Updating learning rate to 0.0
Validation loss decreased (0.2804 --> 0.2803).  Saving model state dict ...
Epoch: 8 cost time: 0.5275046825408936
Epoch: 8, Steps: 131 | Train Loss: 0.5686359 Vali Loss: 0.2802873 Best vali loss: 0.2802873

best validation loss 0.28028732151978963

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0041538938232, 'e_layers': 4, 'learning_rate': 8.17425869e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7409127
	speed: 0.0112s/iter; left time: 10.6077s
Updating learning rate to 8.17425869e-05
Validation loss decreased (inf --> 0.3331).  Saving model state dict ...
Epoch: 1 cost time: 1.0084986686706543
Epoch: 1, Steps: 131 | Train Loss: 0.7409127 Vali Loss: 0.3331128 Best vali loss: 0.3331128
	iters: 100, epoch: 2 | loss: 0.4575312
	speed: 0.0092s/iter; left time: 7.5473s
Updating learning rate to 4.087129345e-05
Validation loss decreased (0.3331 --> 0.3164).  Saving model state dict ...
Epoch: 2 cost time: 0.7714810371398926
Epoch: 2, Steps: 131 | Train Loss: 0.4575312 Vali Loss: 0.3163892 Best vali loss: 0.3163892
	iters: 100, epoch: 3 | loss: 0.5977159
	speed: 0.0087s/iter; left time: 5.9563s
Updating learning rate to 2.0435646725e-05
Validation loss decreased (0.3164 --> 0.3107).  Saving model state dict ...
Epoch: 3 cost time: 0.6971726417541504
Epoch: 3, Steps: 131 | Train Loss: 0.5977159 Vali Loss: 0.3107200 Best vali loss: 0.3107200
	iters: 100, epoch: 4 | loss: 0.5391629
	speed: 0.0083s/iter; left time: 4.6341s
Updating learning rate to 1.02178233625e-05
Validation loss decreased (0.3107 --> 0.3082).  Saving model state dict ...
Epoch: 4 cost time: 0.6768498420715332
Epoch: 4, Steps: 131 | Train Loss: 0.5391629 Vali Loss: 0.3081718 Best vali loss: 0.3081718
	iters: 100, epoch: 5 | loss: 0.4157229
	speed: 0.0082s/iter; left time: 3.4669s
Updating learning rate to 5.10891168125e-06
Validation loss decreased (0.3082 --> 0.3071).  Saving model state dict ...
Epoch: 5 cost time: 0.6833550930023193
Epoch: 5, Steps: 131 | Train Loss: 0.4157229 Vali Loss: 0.3070583 Best vali loss: 0.3070583
	iters: 100, epoch: 6 | loss: 0.4632981
	speed: 0.0086s/iter; left time: 2.5406s
Updating learning rate to 2.554455840625e-06
Validation loss decreased (0.3071 --> 0.3065).  Saving model state dict ...
Epoch: 6 cost time: 0.7452006340026855
Epoch: 6, Steps: 131 | Train Loss: 0.4632981 Vali Loss: 0.3065205 Best vali loss: 0.3065205
	iters: 100, epoch: 7 | loss: 0.5744660
	speed: 0.0088s/iter; left time: 1.4264s
Updating learning rate to 1.2772279203125e-06
Validation loss decreased (0.3065 --> 0.3063).  Saving model state dict ...
Epoch: 7 cost time: 0.6993930339813232
Epoch: 7, Steps: 131 | Train Loss: 0.5744660 Vali Loss: 0.3062560 Best vali loss: 0.3062560
	iters: 100, epoch: 8 | loss: 0.5168613
	speed: 0.0083s/iter; left time: 0.2647s
Updating learning rate to 6.3861396015625e-07
Validation loss decreased (0.3063 --> 0.3061).  Saving model state dict ...
Epoch: 8 cost time: 0.6753122806549072
Epoch: 8, Steps: 131 | Train Loss: 0.5168613 Vali Loss: 0.3061249 Best vali loss: 0.3061249

best validation loss 0.30612493214131997

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0015215057299, 'e_layers': 2, 'learning_rate': 5.05942222e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3758546
	speed: 0.0092s/iter; left time: 8.7424s
Updating learning rate to 4.8668594276954085e-05
Validation loss decreased (inf --> 0.3095).  Saving model state dict ...
Epoch: 1 cost time: 0.7732620239257812
Epoch: 1, Steps: 131 | Train Loss: 0.3758546 Vali Loss: 0.3095063 Best vali loss: 0.3095063
	iters: 100, epoch: 2 | loss: 0.3302292
	speed: 0.0068s/iter; left time: 5.5926s
Updating learning rate to 4.318486990323948e-05
Validation loss decreased (0.3095 --> 0.2922).  Saving model state dict ...
Epoch: 2 cost time: 0.5491278171539307
Epoch: 2, Steps: 131 | Train Loss: 0.3302292 Vali Loss: 0.2921797 Best vali loss: 0.2921797
	iters: 100, epoch: 3 | loss: 0.2730146
	speed: 0.0067s/iter; left time: 4.6256s
Updating learning rate to 3.497789640466901e-05
Validation loss decreased (0.2922 --> 0.2852).  Saving model state dict ...
Epoch: 3 cost time: 0.5461218357086182
Epoch: 3, Steps: 131 | Train Loss: 0.2730146 Vali Loss: 0.2852137 Best vali loss: 0.2852137

best validation loss 0.28521372546888984

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012079377365, 'e_layers': 3, 'learning_rate': 0.0001438690765, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4234958
	speed: 0.0093s/iter; left time: 77.0471s
	iters: 200, epoch: 1 | loss: 0.3826686
	speed: 0.0041s/iter; left time: 33.7480s
	iters: 300, epoch: 1 | loss: 0.5192215
	speed: 0.0042s/iter; left time: 33.5377s
	iters: 400, epoch: 1 | loss: 0.3632186
	speed: 0.0042s/iter; left time: 33.3648s
	iters: 500, epoch: 1 | loss: 1.1230066
	speed: 0.0042s/iter; left time: 32.8686s
	iters: 600, epoch: 1 | loss: 0.2338144
	speed: 0.0042s/iter; left time: 32.2251s
	iters: 700, epoch: 1 | loss: 1.0250702
	speed: 0.0040s/iter; left time: 30.5037s
	iters: 800, epoch: 1 | loss: 0.7208047
	speed: 0.0039s/iter; left time: 29.2532s
	iters: 900, epoch: 1 | loss: 1.1345222
	speed: 0.0040s/iter; left time: 29.5685s
	iters: 1000, epoch: 1 | loss: 0.5050448
	speed: 0.0039s/iter; left time: 28.4056s
Updating learning rate to 0.0001438690765
Validation loss decreased (inf --> 0.2863).  Saving model state dict ...
Epoch: 1 cost time: 4.4931159019470215
Epoch: 1, Steps: 1045 | Train Loss: 0.6430867 Vali Loss: 0.2862947 Best vali loss: 0.2862947
	iters: 100, epoch: 2 | loss: 0.4242600
	speed: 0.0119s/iter; left time: 86.0240s
	iters: 200, epoch: 2 | loss: 0.2838600
	speed: 0.0041s/iter; left time: 29.4080s
	iters: 300, epoch: 2 | loss: 0.3207969
	speed: 0.0041s/iter; left time: 28.9762s
	iters: 400, epoch: 2 | loss: 0.2435053
	speed: 0.0041s/iter; left time: 28.2380s
	iters: 500, epoch: 2 | loss: 1.6012608
	speed: 0.0042s/iter; left time: 28.5411s
	iters: 600, epoch: 2 | loss: 1.1314361
	speed: 0.0042s/iter; left time: 27.9291s
	iters: 700, epoch: 2 | loss: 0.3157160
	speed: 0.0040s/iter; left time: 26.7774s
	iters: 800, epoch: 2 | loss: 0.2746641
	speed: 0.0038s/iter; left time: 24.7556s
	iters: 900, epoch: 2 | loss: 0.3120646
	speed: 0.0039s/iter; left time: 24.9728s
	iters: 1000, epoch: 2 | loss: 0.4644955
	speed: 0.0038s/iter; left time: 23.8326s
Updating learning rate to 7.193453825e-05
Validation loss decreased (0.2863 --> 0.2831).  Saving model state dict ...
Epoch: 2 cost time: 4.238293409347534
Epoch: 2, Steps: 1045 | Train Loss: 0.5372059 Vali Loss: 0.2831068 Best vali loss: 0.2831068
	iters: 100, epoch: 3 | loss: 1.3622463
	speed: 0.0114s/iter; left time: 70.1599s
	iters: 200, epoch: 3 | loss: 0.6155819
	speed: 0.0036s/iter; left time: 22.0918s
	iters: 300, epoch: 3 | loss: 0.5341833
	speed: 0.0037s/iter; left time: 21.8593s
	iters: 400, epoch: 3 | loss: 1.7699106
	speed: 0.0038s/iter; left time: 22.2842s
	iters: 500, epoch: 3 | loss: 0.6828603
	speed: 0.0038s/iter; left time: 21.6679s
	iters: 600, epoch: 3 | loss: 0.3027887
	speed: 0.0037s/iter; left time: 20.8420s
	iters: 700, epoch: 3 | loss: 0.4015263
	speed: 0.0040s/iter; left time: 22.4278s
	iters: 800, epoch: 3 | loss: 1.2130663
	speed: 0.0040s/iter; left time: 22.0014s
	iters: 900, epoch: 3 | loss: 0.1503668
	speed: 0.0041s/iter; left time: 21.9691s
	iters: 1000, epoch: 3 | loss: 0.5222023
	speed: 0.0040s/iter; left time: 21.1314s
Updating learning rate to 3.5967269125e-05
Validation loss decreased (0.2831 --> 0.2817).  Saving model state dict ...
Epoch: 3 cost time: 4.049243211746216
Epoch: 3, Steps: 1045 | Train Loss: 0.7554733 Vali Loss: 0.2817306 Best vali loss: 0.2817306

best validation loss 0.2817306429446963

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010272019602, 'e_layers': 2, 'learning_rate': 0.0002345048067, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596958
	speed: 0.0105s/iter; left time: 10.0053s
Updating learning rate to 0.0002345048067
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9390532970428467
Epoch: 1, Steps: 131 | Train Loss: 0.5596958 Vali Loss: 0.2756446 Best vali loss: 0.2756446
	iters: 100, epoch: 2 | loss: 0.3261484
	speed: 0.0089s/iter; left time: 7.2887s
Updating learning rate to 0.00011725240335
Validation loss decreased (0.2756 --> 0.2740).  Saving model state dict ...
Epoch: 2 cost time: 0.7028763294219971
Epoch: 2, Steps: 131 | Train Loss: 0.3261484 Vali Loss: 0.2739904 Best vali loss: 0.2739904
	iters: 100, epoch: 3 | loss: 0.4650532
	speed: 0.0091s/iter; left time: 6.2830s
Updating learning rate to 5.8626201675e-05
Epoch: 3 cost time: 0.705432653427124
Epoch: 3, Steps: 131 | Train Loss: 0.4650532 Vali Loss: 0.2842058 Best vali loss: 0.2739904

best validation loss 0.2739903570196805

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010272019602, 'e_layers': 2, 'learning_rate': 0.0002345048067, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4223362
	speed: 0.0108s/iter; left time: 6.0258s
Updating learning rate to 2.93131008375e-05
Epoch: 4 cost time: 0.9367451667785645
Epoch: 4, Steps: 131 | Train Loss: 0.4223362 Vali Loss: 0.3087985 Best vali loss: 0.2739904
	iters: 100, epoch: 5 | loss: 0.2840420
	speed: 0.0087s/iter; left time: 3.7135s
Updating learning rate to 1.465655041875e-05
Epoch: 5 cost time: 0.7010529041290283
Epoch: 5, Steps: 131 | Train Loss: 0.2840420 Vali Loss: 0.3048480 Best vali loss: 0.2739904
	iters: 100, epoch: 6 | loss: 0.4344271
	speed: 0.0087s/iter; left time: 2.5620s
Updating learning rate to 7.328275209375e-06
Epoch: 6 cost time: 0.6985697746276855
Epoch: 6, Steps: 131 | Train Loss: 0.4344271 Vali Loss: 0.3050001 Best vali loss: 0.2739904
	iters: 100, epoch: 7 | loss: 0.4676568
	speed: 0.0085s/iter; left time: 1.3851s
Updating learning rate to 3.6641376046875e-06
Epoch: 7 cost time: 0.6912157535552979
Epoch: 7, Steps: 131 | Train Loss: 0.4676568 Vali Loss: 0.3043447 Best vali loss: 0.2739904
	iters: 100, epoch: 8 | loss: 0.3266708
	speed: 0.0085s/iter; left time: 0.2731s
Updating learning rate to 1.83206880234375e-06
Epoch: 8 cost time: 0.6944253444671631
Epoch: 8, Steps: 131 | Train Loss: 0.3266708 Vali Loss: 0.3020452 Best vali loss: 0.2739904

best validation loss 0.2739903570196805

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4096508
	speed: 0.0105s/iter; left time: 9.9958s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 0.9557335376739502
Epoch: 1, Steps: 131 | Train Loss: 0.4096508 Vali Loss: 0.2795811 Best vali loss: 0.2795811
	iters: 100, epoch: 2 | loss: 0.5564824
	speed: 0.0092s/iter; left time: 7.5443s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.7278461456298828
Epoch: 2, Steps: 131 | Train Loss: 0.5564824 Vali Loss: 0.2824339 Best vali loss: 0.2795811
	iters: 100, epoch: 3 | loss: 0.4709175
	speed: 0.0089s/iter; left time: 6.1273s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7275426387786865
Epoch: 3, Steps: 131 | Train Loss: 0.4709175 Vali Loss: 0.2928469 Best vali loss: 0.2795811
	iters: 100, epoch: 4 | loss: 0.4450585
	speed: 0.0089s/iter; left time: 4.9518s
Updating learning rate to 2.931587015e-05
Validation loss decreased (0.2796 --> 0.2788).  Saving model state dict ...
Epoch: 4 cost time: 0.7204506397247314
Epoch: 4, Steps: 131 | Train Loss: 0.4450585 Vali Loss: 0.2788269 Best vali loss: 0.2788269
	iters: 100, epoch: 5 | loss: 0.4385357
	speed: 0.0093s/iter; left time: 3.9421s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7254743576049805
Epoch: 5, Steps: 131 | Train Loss: 0.4385357 Vali Loss: 0.2828124 Best vali loss: 0.2788269
	iters: 100, epoch: 6 | loss: 0.4493611
	speed: 0.0089s/iter; left time: 2.6154s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.723041296005249
Epoch: 6, Steps: 131 | Train Loss: 0.4493611 Vali Loss: 0.2855414 Best vali loss: 0.2788269
	iters: 100, epoch: 7 | loss: 0.3093489
	speed: 0.0089s/iter; left time: 1.4437s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7217049598693848
Epoch: 7, Steps: 131 | Train Loss: 0.3093489 Vali Loss: 0.2839077 Best vali loss: 0.2788269
	iters: 100, epoch: 8 | loss: 0.2496476
	speed: 0.0089s/iter; left time: 0.2846s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7200968265533447
Epoch: 8, Steps: 131 | Train Loss: 0.2496476 Vali Loss: 0.2844419 Best vali loss: 0.2788269

best validation loss 0.2788269275009034

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0065602556148, 'e_layers': 4, 'learning_rate': 0.0033801437413, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5468063
	speed: 0.0105s/iter; left time: 20.9854s
	iters: 200, epoch: 1 | loss: 0.4477646
	speed: 0.0051s/iter; left time: 9.6484s
Updating learning rate to 0.0033801437413
Validation loss decreased (inf --> 0.3145).  Saving model state dict ...
Epoch: 1 cost time: 1.606872797012329
Epoch: 1, Steps: 262 | Train Loss: 0.4972855 Vali Loss: 0.3144896 Best vali loss: 0.3144896
	iters: 100, epoch: 2 | loss: 0.5231930
	speed: 0.0104s/iter; left time: 18.0775s
	iters: 200, epoch: 2 | loss: 0.6243196
	speed: 0.0047s/iter; left time: 7.7463s
Updating learning rate to 0.00169007187065
Validation loss decreased (0.3145 --> 0.2984).  Saving model state dict ...
Epoch: 2 cost time: 1.2770805358886719
Epoch: 2, Steps: 262 | Train Loss: 0.5737563 Vali Loss: 0.2984042 Best vali loss: 0.2984042
	iters: 100, epoch: 3 | loss: 0.7547202
	speed: 0.0099s/iter; left time: 14.6296s
	iters: 200, epoch: 3 | loss: 0.4770023
	speed: 0.0047s/iter; left time: 6.4285s
Updating learning rate to 0.000845035935325
Validation loss decreased (0.2984 --> 0.2907).  Saving model state dict ...
Epoch: 3 cost time: 1.251274585723877
Epoch: 3, Steps: 262 | Train Loss: 0.6158613 Vali Loss: 0.2907297 Best vali loss: 0.2907297
	iters: 100, epoch: 4 | loss: 0.6511228
	speed: 0.0107s/iter; left time: 12.9137s
	iters: 200, epoch: 4 | loss: 0.2859899
	speed: 0.0053s/iter; left time: 5.8544s
Updating learning rate to 0.0004225179676625
Epoch: 4 cost time: 1.4171156883239746
Epoch: 4, Steps: 262 | Train Loss: 0.4685563 Vali Loss: 0.2921595 Best vali loss: 0.2907297
	iters: 100, epoch: 5 | loss: 0.6178493
	speed: 0.0110s/iter; left time: 10.4073s
	iters: 200, epoch: 5 | loss: 0.5870276
	speed: 0.0050s/iter; left time: 4.2659s
Updating learning rate to 0.00021125898383125
Epoch: 5 cost time: 1.376396894454956
Epoch: 5, Steps: 262 | Train Loss: 0.6024384 Vali Loss: 0.2910372 Best vali loss: 0.2907297
	iters: 100, epoch: 6 | loss: 0.5376644
	speed: 0.0104s/iter; left time: 7.1458s
	iters: 200, epoch: 6 | loss: 0.3834569
	speed: 0.0047s/iter; left time: 2.7598s
Updating learning rate to 0.000105629491915625
Epoch: 6 cost time: 1.2605781555175781
Epoch: 6, Steps: 262 | Train Loss: 0.4605606 Vali Loss: 0.2931653 Best vali loss: 0.2907297
	iters: 100, epoch: 7 | loss: 0.5325091
	speed: 0.0100s/iter; left time: 4.2680s
	iters: 200, epoch: 7 | loss: 0.5384780
	speed: 0.0052s/iter; left time: 1.6828s
Updating learning rate to 5.28147459578125e-05
Epoch: 7 cost time: 1.3669722080230713
Epoch: 7, Steps: 262 | Train Loss: 0.5354936 Vali Loss: 0.2927388 Best vali loss: 0.2907297
	iters: 100, epoch: 8 | loss: 0.4183031
	speed: 0.0114s/iter; left time: 1.8526s
	iters: 200, epoch: 8 | loss: 0.5501163
	speed: 0.0052s/iter; left time: 0.3284s
Updating learning rate to 2.640737297890625e-05
Epoch: 8 cost time: 1.41506028175354
Epoch: 8, Steps: 262 | Train Loss: 0.4842097 Vali Loss: 0.2925911 Best vali loss: 0.2907297

best validation loss 0.2907296898374774

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0012044157509, 'e_layers': 4, 'learning_rate': 0.0030946177192, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6920508
	speed: 0.0103s/iter; left time: 84.7647s
	iters: 200, epoch: 1 | loss: 0.3977483
	speed: 0.0052s/iter; left time: 42.2652s
	iters: 300, epoch: 1 | loss: 0.3065712
	speed: 0.0052s/iter; left time: 41.5789s
	iters: 400, epoch: 1 | loss: 0.3034820
	speed: 0.0052s/iter; left time: 41.4220s
	iters: 500, epoch: 1 | loss: 0.3067906
	speed: 0.0052s/iter; left time: 41.1864s
	iters: 600, epoch: 1 | loss: 0.9560983
	speed: 0.0052s/iter; left time: 40.2879s
	iters: 700, epoch: 1 | loss: 0.3625492
	speed: 0.0052s/iter; left time: 40.2135s
	iters: 800, epoch: 1 | loss: 0.5931553
	speed: 0.0052s/iter; left time: 39.4909s
	iters: 900, epoch: 1 | loss: 0.3262937
	speed: 0.0052s/iter; left time: 38.7880s
	iters: 1000, epoch: 1 | loss: 0.3691448
	speed: 0.0050s/iter; left time: 36.5446s
Updating learning rate to 0.0029768358454578202
Validation loss decreased (inf --> 0.3270).  Saving model state dict ...
Epoch: 1 cost time: 5.654666185379028
Epoch: 1, Steps: 1045 | Train Loss: 0.4613884 Vali Loss: 0.3270023 Best vali loss: 0.3270023
	iters: 100, epoch: 2 | loss: 0.3328582
	speed: 0.0142s/iter; left time: 102.6326s
	iters: 200, epoch: 2 | loss: 0.3482958
	speed: 0.0051s/iter; left time: 36.0223s
	iters: 300, epoch: 2 | loss: 0.2369123
	speed: 0.0051s/iter; left time: 35.6930s
	iters: 400, epoch: 2 | loss: 0.5665819
	speed: 0.0051s/iter; left time: 35.2848s
	iters: 500, epoch: 2 | loss: 0.4759415
	speed: 0.0051s/iter; left time: 34.5469s
	iters: 600, epoch: 2 | loss: 0.9311062
	speed: 0.0051s/iter; left time: 33.9843s
	iters: 700, epoch: 2 | loss: 0.5485371
	speed: 0.0051s/iter; left time: 33.8909s
	iters: 800, epoch: 2 | loss: 0.3926998
	speed: 0.0048s/iter; left time: 31.4399s
	iters: 900, epoch: 2 | loss: 1.4283756
	speed: 0.0046s/iter; left time: 29.7574s
	iters: 1000, epoch: 2 | loss: 1.3961207
	speed: 0.0047s/iter; left time: 29.7308s
Updating learning rate to 0.0026414214468131834
Validation loss decreased (0.3270 --> 0.3239).  Saving model state dict ...
Epoch: 2 cost time: 5.224223613739014
Epoch: 2, Steps: 1045 | Train Loss: 0.6657429 Vali Loss: 0.3238960 Best vali loss: 0.3238960
	iters: 100, epoch: 3 | loss: 0.3159735
	speed: 0.0140s/iter; left time: 86.6459s
	iters: 200, epoch: 3 | loss: 0.3177947
	speed: 0.0051s/iter; left time: 30.9500s
	iters: 300, epoch: 3 | loss: 0.3281295
	speed: 0.0051s/iter; left time: 30.3546s
	iters: 400, epoch: 3 | loss: 0.7622985
	speed: 0.0051s/iter; left time: 30.0327s
	iters: 500, epoch: 3 | loss: 0.2657925
	speed: 0.0051s/iter; left time: 29.2812s
	iters: 600, epoch: 3 | loss: 0.9636316
	speed: 0.0050s/iter; left time: 28.6341s
	iters: 700, epoch: 3 | loss: 0.1668263
	speed: 0.0051s/iter; left time: 28.2316s
	iters: 800, epoch: 3 | loss: 0.5755658
	speed: 0.0051s/iter; left time: 28.0083s
	iters: 900, epoch: 3 | loss: 0.3863377
	speed: 0.0051s/iter; left time: 27.1852s
	iters: 1000, epoch: 3 | loss: 0.3187899
	speed: 0.0050s/iter; left time: 26.5856s
Updating learning rate to 0.0021394383249206408
Validation loss decreased (0.3239 --> 0.3205).  Saving model state dict ...
Epoch: 3 cost time: 5.352685213088989
Epoch: 3, Steps: 1045 | Train Loss: 0.4401140 Vali Loss: 0.3204895 Best vali loss: 0.3204895

best validation loss 0.32048946262159594

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021153529942, 'e_layers': 4, 'learning_rate': 0.0020155602657, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0020155602657
Validation loss decreased (inf --> 0.2916).  Saving model state dict ...
Epoch: 1 cost time: 0.675792932510376
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2916352 Best vali loss: 0.2916352
Updating learning rate to 0.00100778013285
Validation loss decreased (0.2916 --> 0.2862).  Saving model state dict ...
Epoch: 2 cost time: 0.44918227195739746
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2861998 Best vali loss: 0.2861998
Updating learning rate to 0.000503890066425
Epoch: 3 cost time: 0.4481995105743408
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2908899 Best vali loss: 0.2861998

best validation loss 0.2861997722642889

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021393848099, 'e_layers': 4, 'learning_rate': 0.0019547901467, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6401643
	speed: 0.0107s/iter; left time: 21.3753s
	iters: 200, epoch: 1 | loss: 0.9964014
	speed: 0.0054s/iter; left time: 10.1571s
Updating learning rate to 0.0019547901467
Validation loss decreased (inf --> 0.2910).  Saving model state dict ...
Epoch: 1 cost time: 1.6755321025848389
Epoch: 1, Steps: 262 | Train Loss: 0.8182828 Vali Loss: 0.2909964 Best vali loss: 0.2909964
	iters: 100, epoch: 2 | loss: 0.5349016
	speed: 0.0111s/iter; left time: 19.2824s
	iters: 200, epoch: 2 | loss: 0.7456529
	speed: 0.0050s/iter; left time: 8.1197s
Updating learning rate to 0.00097739507335
Epoch: 2 cost time: 1.3444366455078125
Epoch: 2, Steps: 262 | Train Loss: 0.6402772 Vali Loss: 0.3003921 Best vali loss: 0.2909964
	iters: 100, epoch: 3 | loss: 0.4043133
	speed: 0.0111s/iter; left time: 16.3535s
	iters: 200, epoch: 3 | loss: 0.5486863
	speed: 0.0053s/iter; left time: 7.3385s
Updating learning rate to 0.000488697536675
Validation loss decreased (0.2910 --> 0.2876).  Saving model state dict ...
Epoch: 3 cost time: 1.4421110153198242
Epoch: 3, Steps: 262 | Train Loss: 0.4764998 Vali Loss: 0.2875991 Best vali loss: 0.2875991

best validation loss 0.28759906534625057

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021153529942, 'e_layers': 4, 'learning_rate': 0.0020155602657, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002519450332125
Epoch: 4 cost time: 0.6849365234375
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2991196 Best vali loss: 0.2861998
Updating learning rate to 0.00012597251660625
Epoch: 5 cost time: 0.412827730178833
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3041660 Best vali loss: 0.2861998
Updating learning rate to 6.2986258303125e-05
Epoch: 6 cost time: 0.4417440891265869
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2913637 Best vali loss: 0.2861998
Updating learning rate to 3.14931291515625e-05
Epoch: 7 cost time: 0.45953941345214844
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2993527 Best vali loss: 0.2861998
Updating learning rate to 1.574656457578125e-05
Epoch: 8 cost time: 0.4537928104400635
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2985579 Best vali loss: 0.2861998

best validation loss 0.2861997722642889

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0020980224013, 'e_layers': 4, 'learning_rate': 0.0019899657788, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019142272161156012
Validation loss decreased (inf --> 0.2920).  Saving model state dict ...
Epoch: 1 cost time: 0.6839454174041748
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2920496 Best vali loss: 0.2920496
Updating learning rate to 0.0016985420376593246
Validation loss decreased (0.2920 --> 0.2893).  Saving model state dict ...
Epoch: 2 cost time: 0.44474172592163086
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2892883 Best vali loss: 0.2892883
Updating learning rate to 0.0013757463566601265
Epoch: 3 cost time: 0.44255828857421875
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2941470 Best vali loss: 0.2892883
Updating learning rate to 0.0009949828894
Epoch: 4 cost time: 0.44823670387268066
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2916163 Best vali loss: 0.2892883
Updating learning rate to 0.0006142194221398736
Validation loss decreased (0.2893 --> 0.2849).  Saving model state dict ...
Epoch: 5 cost time: 0.44272708892822266
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2848674 Best vali loss: 0.2848674
Updating learning rate to 0.00029142374114067543
Validation loss decreased (0.2849 --> 0.2841).  Saving model state dict ...
Epoch: 6 cost time: 0.44635510444641113
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2840661 Best vali loss: 0.2840661
Updating learning rate to 7.573856268439868e-05
Epoch: 7 cost time: 0.44789934158325195
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2970635 Best vali loss: 0.2840661
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4392585754394531
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2900312 Best vali loss: 0.2840661

best validation loss 0.2840661362905226

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345187116, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597131
	speed: 0.0106s/iter; left time: 10.0425s
Updating learning rate to 0.0002345187116
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9322235584259033
Epoch: 1, Steps: 131 | Train Loss: 0.5597131 Vali Loss: 0.2756337 Best vali loss: 0.2756337
	iters: 100, epoch: 2 | loss: 0.3243003
	speed: 0.0089s/iter; left time: 7.2862s
Updating learning rate to 0.0001172593558
Validation loss decreased (0.2756 --> 0.2699).  Saving model state dict ...
Epoch: 2 cost time: 0.7048747539520264
Epoch: 2, Steps: 131 | Train Loss: 0.3243003 Vali Loss: 0.2698937 Best vali loss: 0.2698937
	iters: 100, epoch: 3 | loss: 0.4616637
	speed: 0.0089s/iter; left time: 6.0985s
Updating learning rate to 5.86296779e-05
Epoch: 3 cost time: 0.7003929615020752
Epoch: 3, Steps: 131 | Train Loss: 0.4616637 Vali Loss: 0.2781130 Best vali loss: 0.2698937
	iters: 100, epoch: 4 | loss: 0.5041983
	speed: 0.0087s/iter; left time: 4.8349s
Updating learning rate to 2.931483895e-05
Epoch: 4 cost time: 0.7043783664703369
Epoch: 4, Steps: 131 | Train Loss: 0.5041983 Vali Loss: 0.2853292 Best vali loss: 0.2698937
	iters: 100, epoch: 5 | loss: 0.3315018
	speed: 0.0086s/iter; left time: 3.6660s
Updating learning rate to 1.4657419475e-05
Epoch: 5 cost time: 0.6979413032531738
Epoch: 5, Steps: 131 | Train Loss: 0.3315018 Vali Loss: 0.2871847 Best vali loss: 0.2698937
	iters: 100, epoch: 6 | loss: 0.3178228
	speed: 0.0087s/iter; left time: 2.5458s
Updating learning rate to 7.3287097375e-06
Epoch: 6 cost time: 0.7030963897705078
Epoch: 6, Steps: 131 | Train Loss: 0.3178228 Vali Loss: 0.2911497 Best vali loss: 0.2698937
	iters: 100, epoch: 7 | loss: 0.3121099
	speed: 0.0086s/iter; left time: 1.3962s
Updating learning rate to 3.66435486875e-06
Epoch: 7 cost time: 0.696160078048706
Epoch: 7, Steps: 131 | Train Loss: 0.3121099 Vali Loss: 0.2935499 Best vali loss: 0.2698937
	iters: 100, epoch: 8 | loss: 0.3980076
	speed: 0.0086s/iter; left time: 0.2746s
Updating learning rate to 1.832177434375e-06
Epoch: 8 cost time: 0.6974091529846191
Epoch: 8, Steps: 131 | Train Loss: 0.3980076 Vali Loss: 0.2959020 Best vali loss: 0.2698937

best validation loss 0.26989371085441793

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597151
	speed: 0.0106s/iter; left time: 10.0738s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9394121170043945
Epoch: 1, Steps: 131 | Train Loss: 0.5597151 Vali Loss: 0.2756369 Best vali loss: 0.2756369
	iters: 100, epoch: 2 | loss: 0.3240521
	speed: 0.0089s/iter; left time: 7.2563s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2756 --> 0.2697).  Saving model state dict ...
Epoch: 2 cost time: 0.6989631652832031
Epoch: 2, Steps: 131 | Train Loss: 0.3240521 Vali Loss: 0.2696961 Best vali loss: 0.2696961
	iters: 100, epoch: 3 | loss: 0.4670205
	speed: 0.0090s/iter; left time: 6.1648s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.7005317211151123
Epoch: 3, Steps: 131 | Train Loss: 0.4670205 Vali Loss: 0.2803657 Best vali loss: 0.2696961

best validation loss 0.26969614559587113

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029539552571, 'e_layers': 4, 'learning_rate': 0.0019576577402, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001883148829016539
Validation loss decreased (inf --> 0.3016).  Saving model state dict ...
Epoch: 1 cost time: 0.6654312610626221
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3016459 Best vali loss: 0.3016459
Updating learning rate to 0.0016709654017688761
Validation loss decreased (0.3016 --> 0.2907).  Saving model state dict ...
Epoch: 2 cost time: 0.4297459125518799
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2906711 Best vali loss: 0.2906711
Updating learning rate to 0.0013534104618079107
Epoch: 3 cost time: 0.44387102127075195
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2973047 Best vali loss: 0.2906711

best validation loss 0.29067113874746814

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010262429802, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597103
	speed: 0.0106s/iter; left time: 10.0485s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9310417175292969
Epoch: 1, Steps: 131 | Train Loss: 0.5597103 Vali Loss: 0.2756382 Best vali loss: 0.2756382
	iters: 100, epoch: 2 | loss: 0.3256605
	speed: 0.0089s/iter; left time: 7.2462s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2756 --> 0.2696).  Saving model state dict ...
Epoch: 2 cost time: 0.6972644329071045
Epoch: 2, Steps: 131 | Train Loss: 0.3256605 Vali Loss: 0.2696055 Best vali loss: 0.2696055
	iters: 100, epoch: 3 | loss: 0.4655938
	speed: 0.0089s/iter; left time: 6.1214s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.7004036903381348
Epoch: 3, Steps: 131 | Train Loss: 0.4655938 Vali Loss: 0.2814603 Best vali loss: 0.2696055

best validation loss 0.2696054847034747

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010262429802, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4176189
	speed: 0.0109s/iter; left time: 6.0467s
Updating learning rate to 2.9310739475e-05
Epoch: 4 cost time: 0.9316089153289795
Epoch: 4, Steps: 131 | Train Loss: 0.4176189 Vali Loss: 0.3186586 Best vali loss: 0.2696055
	iters: 100, epoch: 5 | loss: 0.2812394
	speed: 0.0085s/iter; left time: 3.6319s
Updating learning rate to 1.46553697375e-05
Epoch: 5 cost time: 0.6937916278839111
Epoch: 5, Steps: 131 | Train Loss: 0.2812394 Vali Loss: 0.2935324 Best vali loss: 0.2696055
	iters: 100, epoch: 6 | loss: 0.4343260
	speed: 0.0087s/iter; left time: 2.5571s
Updating learning rate to 7.32768486875e-06
Epoch: 6 cost time: 0.6990306377410889
Epoch: 6, Steps: 131 | Train Loss: 0.4343260 Vali Loss: 0.2986333 Best vali loss: 0.2696055
	iters: 100, epoch: 7 | loss: 0.4655786
	speed: 0.0086s/iter; left time: 1.4098s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 0.6928675174713135
Epoch: 7, Steps: 131 | Train Loss: 0.4655786 Vali Loss: 0.2975487 Best vali loss: 0.2696055
	iters: 100, epoch: 8 | loss: 0.3248431
	speed: 0.0086s/iter; left time: 0.2744s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 0.6959421634674072
Epoch: 8, Steps: 131 | Train Loss: 0.3248431 Vali Loss: 0.2936611 Best vali loss: 0.2696055

best validation loss 0.2696054847034747

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0041242838006, 'e_layers': 1, 'learning_rate': 9.13860667e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4410002
	speed: 0.0080s/iter; left time: 15.8846s
	iters: 200, epoch: 1 | loss: 0.4015236
	speed: 0.0026s/iter; left time: 4.9258s
Updating learning rate to 9.13860667e-05
Validation loss decreased (inf --> 0.3120).  Saving model state dict ...
Epoch: 1 cost time: 0.9410858154296875
Epoch: 1, Steps: 262 | Train Loss: 0.4212619 Vali Loss: 0.3120496 Best vali loss: 0.3120496
	iters: 100, epoch: 2 | loss: 0.6361697
	speed: 0.0061s/iter; left time: 10.5731s
	iters: 200, epoch: 2 | loss: 0.5470181
	speed: 0.0024s/iter; left time: 4.0014s
Updating learning rate to 4.569303335e-05
Validation loss decreased (0.3120 --> 0.2941).  Saving model state dict ...
Epoch: 2 cost time: 0.6867780685424805
Epoch: 2, Steps: 262 | Train Loss: 0.5915939 Vali Loss: 0.2941438 Best vali loss: 0.2941438
	iters: 100, epoch: 3 | loss: 0.5340940
	speed: 0.0062s/iter; left time: 9.1149s
	iters: 200, epoch: 3 | loss: 0.3298807
	speed: 0.0027s/iter; left time: 3.7493s
Updating learning rate to 2.2846516675e-05
Validation loss decreased (0.2941 --> 0.2888).  Saving model state dict ...
Epoch: 3 cost time: 0.7327313423156738
Epoch: 3, Steps: 262 | Train Loss: 0.4319873 Vali Loss: 0.2888170 Best vali loss: 0.2888170
	iters: 100, epoch: 4 | loss: 0.4003409
	speed: 0.0062s/iter; left time: 7.5603s
	iters: 200, epoch: 4 | loss: 0.4328314
	speed: 0.0026s/iter; left time: 2.8687s
Updating learning rate to 1.14232583375e-05
Validation loss decreased (0.2888 --> 0.2869).  Saving model state dict ...
Epoch: 4 cost time: 0.7086031436920166
Epoch: 4, Steps: 262 | Train Loss: 0.4165861 Vali Loss: 0.2869190 Best vali loss: 0.2869190
	iters: 100, epoch: 5 | loss: 0.5224179
	speed: 0.0062s/iter; left time: 5.8689s
	iters: 200, epoch: 5 | loss: 0.2456475
	speed: 0.0025s/iter; left time: 2.1152s
Updating learning rate to 5.71162916875e-06
Validation loss decreased (0.2869 --> 0.2861).  Saving model state dict ...
Epoch: 5 cost time: 0.6919305324554443
Epoch: 5, Steps: 262 | Train Loss: 0.3840327 Vali Loss: 0.2861430 Best vali loss: 0.2861430
	iters: 100, epoch: 6 | loss: 0.7319356
	speed: 0.0063s/iter; left time: 4.3239s
	iters: 200, epoch: 6 | loss: 0.6981485
	speed: 0.0024s/iter; left time: 1.4207s
Updating learning rate to 2.855814584375e-06
Validation loss decreased (0.2861 --> 0.2858).  Saving model state dict ...
Epoch: 6 cost time: 0.688894510269165
Epoch: 6, Steps: 262 | Train Loss: 0.7150421 Vali Loss: 0.2857514 Best vali loss: 0.2857514
	iters: 100, epoch: 7 | loss: 0.5493132
	speed: 0.0057s/iter; left time: 2.4300s
	iters: 200, epoch: 7 | loss: 0.5511456
	speed: 0.0023s/iter; left time: 0.7418s
Updating learning rate to 1.4279072921875e-06
Validation loss decreased (0.2858 --> 0.2856).  Saving model state dict ...
Epoch: 7 cost time: 0.6339848041534424
Epoch: 7, Steps: 262 | Train Loss: 0.5502294 Vali Loss: 0.2855730 Best vali loss: 0.2855730
	iters: 100, epoch: 8 | loss: 0.4690574
	speed: 0.0056s/iter; left time: 0.9150s
	iters: 200, epoch: 8 | loss: 0.3322080
	speed: 0.0024s/iter; left time: 0.1495s
Updating learning rate to 7.1395364609375e-07
Validation loss decreased (0.2856 --> 0.2855).  Saving model state dict ...
Epoch: 8 cost time: 0.6568105220794678
Epoch: 8, Steps: 262 | Train Loss: 0.4006327 Vali Loss: 0.2854843 Best vali loss: 0.2854843

best validation loss 0.2854842868778687

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009535988645, 'e_layers': 2, 'learning_rate': 5.10951241e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5577759
	speed: 0.0105s/iter; left time: 9.9461s
Updating learning rate to 5.10951241e-05
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.9374921321868896
Epoch: 1, Steps: 131 | Train Loss: 0.5577759 Vali Loss: 0.2781145 Best vali loss: 0.2781145
	iters: 100, epoch: 2 | loss: 0.3316391
	speed: 0.0089s/iter; left time: 7.2673s
Updating learning rate to 2.554756205e-05
Validation loss decreased (0.2781 --> 0.2779).  Saving model state dict ...
Epoch: 2 cost time: 0.7019007205963135
Epoch: 2, Steps: 131 | Train Loss: 0.3316391 Vali Loss: 0.2778933 Best vali loss: 0.2778933
	iters: 100, epoch: 3 | loss: 0.4944824
	speed: 0.0090s/iter; left time: 6.1845s
Updating learning rate to 1.2773781025e-05
Validation loss decreased (0.2779 --> 0.2756).  Saving model state dict ...
Epoch: 3 cost time: 0.6960601806640625
Epoch: 3, Steps: 131 | Train Loss: 0.4944824 Vali Loss: 0.2756344 Best vali loss: 0.2756344
	iters: 100, epoch: 4 | loss: 0.6083809
	speed: 0.0089s/iter; left time: 4.9461s
Updating learning rate to 6.3868905125e-06
Validation loss decreased (0.2756 --> 0.2752).  Saving model state dict ...
Epoch: 4 cost time: 0.7021610736846924
Epoch: 4, Steps: 131 | Train Loss: 0.6083809 Vali Loss: 0.2752455 Best vali loss: 0.2752455
	iters: 100, epoch: 5 | loss: 0.3491498
	speed: 0.0089s/iter; left time: 3.7763s
Updating learning rate to 3.19344525625e-06
Epoch: 5 cost time: 0.6987183094024658
Epoch: 5, Steps: 131 | Train Loss: 0.3491498 Vali Loss: 0.2758709 Best vali loss: 0.2752455
	iters: 100, epoch: 6 | loss: 0.3505900
	speed: 0.0085s/iter; left time: 2.5002s
Updating learning rate to 1.596722628125e-06
Epoch: 6 cost time: 0.6898365020751953
Epoch: 6, Steps: 131 | Train Loss: 0.3505900 Vali Loss: 0.2757543 Best vali loss: 0.2752455
	iters: 100, epoch: 7 | loss: 0.3729991
	speed: 0.0086s/iter; left time: 1.3990s
Updating learning rate to 7.983613140625e-07
Epoch: 7 cost time: 0.7012050151824951
Epoch: 7, Steps: 131 | Train Loss: 0.3729991 Vali Loss: 0.2757574 Best vali loss: 0.2752455
	iters: 100, epoch: 8 | loss: 0.5085257
	speed: 0.0087s/iter; left time: 0.2779s
Updating learning rate to 3.9918065703125e-07
Epoch: 8 cost time: 0.7005815505981445
Epoch: 8, Steps: 131 | Train Loss: 0.5085257 Vali Loss: 0.2758120 Best vali loss: 0.2752455

best validation loss 0.2752454793222689

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0079123790288, 'e_layers': 2, 'learning_rate': 0.0002294846992, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4987753
	speed: 0.0087s/iter; left time: 35.3421s
	iters: 200, epoch: 1 | loss: 0.2876690
	speed: 0.0032s/iter; left time: 12.8746s
	iters: 300, epoch: 1 | loss: 0.5274217
	speed: 0.0031s/iter; left time: 12.0262s
	iters: 400, epoch: 1 | loss: 0.5341587
	speed: 0.0030s/iter; left time: 11.4639s
	iters: 500, epoch: 1 | loss: 0.4991651
	speed: 0.0032s/iter; left time: 11.8133s
Updating learning rate to 0.00022075045790769462
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 1.9158248901367188
Epoch: 1, Steps: 523 | Train Loss: 0.4694380 Vali Loss: 0.2792761 Best vali loss: 0.2792761
	iters: 100, epoch: 2 | loss: 0.3920615
	speed: 0.0074s/iter; left time: 26.3426s
	iters: 200, epoch: 2 | loss: 0.1965361
	speed: 0.0032s/iter; left time: 11.2062s
	iters: 300, epoch: 2 | loss: 0.4418991
	speed: 0.0032s/iter; left time: 10.8704s
	iters: 400, epoch: 2 | loss: 1.0648611
	speed: 0.0033s/iter; left time: 10.6641s
	iters: 500, epoch: 2 | loss: 0.5574275
	speed: 0.0033s/iter; left time: 10.3036s
Updating learning rate to 0.00019587744309143752
Validation loss decreased (0.2793 --> 0.2749).  Saving model state dict ...
Epoch: 2 cost time: 1.7421448230743408
Epoch: 2, Steps: 523 | Train Loss: 0.5305570 Vali Loss: 0.2748753 Best vali loss: 0.2748753
	iters: 100, epoch: 3 | loss: 0.6864119
	speed: 0.0074s/iter; left time: 22.6268s
	iters: 200, epoch: 3 | loss: 0.4198993
	speed: 0.0030s/iter; left time: 8.8657s
	iters: 300, epoch: 3 | loss: 0.5523701
	speed: 0.0032s/iter; left time: 9.1194s
	iters: 400, epoch: 3 | loss: 0.2890744
	speed: 0.0033s/iter; left time: 9.0558s
	iters: 500, epoch: 3 | loss: 0.2258292
	speed: 0.0033s/iter; left time: 8.7016s
Updating learning rate to 0.0001586523457825631
Epoch: 3 cost time: 1.7017507553100586
Epoch: 3, Steps: 523 | Train Loss: 0.4347169 Vali Loss: 0.2803543 Best vali loss: 0.2748753

best validation loss 0.2748752945570664

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0087198051637, 'e_layers': 4, 'learning_rate': 0.0001440737814, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3450592
	speed: 0.0105s/iter; left time: 86.9992s
	iters: 200, epoch: 1 | loss: 0.3099810
	speed: 0.0052s/iter; left time: 42.5322s
	iters: 300, epoch: 1 | loss: 0.3524095
	speed: 0.0052s/iter; left time: 41.6733s
	iters: 400, epoch: 1 | loss: 0.4105181
	speed: 0.0052s/iter; left time: 41.3132s
	iters: 500, epoch: 1 | loss: 0.3323908
	speed: 0.0052s/iter; left time: 40.9511s
	iters: 600, epoch: 1 | loss: 1.4320682
	speed: 0.0052s/iter; left time: 40.2203s
	iters: 700, epoch: 1 | loss: 0.8161066
	speed: 0.0052s/iter; left time: 39.6709s
	iters: 800, epoch: 1 | loss: 0.3507544
	speed: 0.0052s/iter; left time: 39.0584s
	iters: 900, epoch: 1 | loss: 0.2668839
	speed: 0.0051s/iter; left time: 38.3370s
	iters: 1000, epoch: 1 | loss: 0.5102130
	speed: 0.0051s/iter; left time: 37.5601s
Updating learning rate to 0.00013859029960348266
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 5.659373760223389
Epoch: 1, Steps: 1045 | Train Loss: 0.5126385 Vali Loss: 0.2816708 Best vali loss: 0.2816708
	iters: 100, epoch: 2 | loss: 0.5630468
	speed: 0.0144s/iter; left time: 103.8361s
	iters: 200, epoch: 2 | loss: 0.4821972
	speed: 0.0051s/iter; left time: 36.5173s
	iters: 300, epoch: 2 | loss: 0.7232932
	speed: 0.0051s/iter; left time: 36.0083s
	iters: 400, epoch: 2 | loss: 0.8463228
	speed: 0.0051s/iter; left time: 35.4725s
	iters: 500, epoch: 2 | loss: 0.2301375
	speed: 0.0051s/iter; left time: 34.9880s
	iters: 600, epoch: 2 | loss: 0.2066611
	speed: 0.0051s/iter; left time: 34.4451s
	iters: 700, epoch: 2 | loss: 0.2126065
	speed: 0.0050s/iter; left time: 32.8645s
	iters: 800, epoch: 2 | loss: 0.3867331
	speed: 0.0048s/iter; left time: 31.5967s
	iters: 900, epoch: 2 | loss: 0.2459602
	speed: 0.0048s/iter; left time: 31.1148s
	iters: 1000, epoch: 2 | loss: 0.5464807
	speed: 0.0048s/iter; left time: 30.5168s
Updating learning rate to 0.00012297466460956414
Epoch: 2 cost time: 5.284026145935059
Epoch: 2, Steps: 1045 | Train Loss: 0.4443439 Vali Loss: 0.2842506 Best vali loss: 0.2816708
	iters: 100, epoch: 3 | loss: 0.2498040
	speed: 0.0142s/iter; left time: 87.5090s
	iters: 200, epoch: 3 | loss: 0.8277078
	speed: 0.0051s/iter; left time: 30.9754s
	iters: 300, epoch: 3 | loss: 0.2703232
	speed: 0.0052s/iter; left time: 30.9315s
	iters: 400, epoch: 3 | loss: 0.5890535
	speed: 0.0051s/iter; left time: 30.1694s
	iters: 500, epoch: 3 | loss: 0.3799511
	speed: 0.0051s/iter; left time: 29.5614s
	iters: 600, epoch: 3 | loss: 0.2525932
	speed: 0.0051s/iter; left time: 29.1275s
	iters: 700, epoch: 3 | loss: 0.7570180
	speed: 0.0051s/iter; left time: 28.6136s
	iters: 800, epoch: 3 | loss: 0.3560900
	speed: 0.0050s/iter; left time: 27.5769s
	iters: 900, epoch: 3 | loss: 0.6164938
	speed: 0.0051s/iter; left time: 27.6259s
	iters: 1000, epoch: 3 | loss: 0.2383305
	speed: 0.0052s/iter; left time: 27.1582s
Updating learning rate to 9.960421528998482e-05
Validation loss decreased (0.2817 --> 0.2791).  Saving model state dict ...
Epoch: 3 cost time: 5.396095514297485
Epoch: 3, Steps: 1045 | Train Loss: 0.4537365 Vali Loss: 0.2791334 Best vali loss: 0.2791334

best validation loss 0.2791334492299538

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0028910706003, 'e_layers': 3, 'learning_rate': 0.0001825351522, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0537759
	speed: 0.0094s/iter; left time: 77.3050s
	iters: 200, epoch: 1 | loss: 0.5044447
	speed: 0.0038s/iter; left time: 30.7151s
	iters: 300, epoch: 1 | loss: 0.3517217
	speed: 0.0038s/iter; left time: 30.6586s
	iters: 400, epoch: 1 | loss: 0.1763172
	speed: 0.0038s/iter; left time: 29.9174s
	iters: 500, epoch: 1 | loss: 0.3804277
	speed: 0.0039s/iter; left time: 30.6506s
	iters: 600, epoch: 1 | loss: 1.8843842
	speed: 0.0039s/iter; left time: 30.5830s
	iters: 700, epoch: 1 | loss: 0.3618175
	speed: 0.0039s/iter; left time: 29.5868s
	iters: 800, epoch: 1 | loss: 0.2516489
	speed: 0.0037s/iter; left time: 27.8731s
	iters: 900, epoch: 1 | loss: 0.1836933
	speed: 0.0037s/iter; left time: 27.6364s
	iters: 1000, epoch: 1 | loss: 0.2617137
	speed: 0.0037s/iter; left time: 27.5145s
Updating learning rate to 0.0001825351522
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 4.257035255432129
Epoch: 1, Steps: 1045 | Train Loss: 0.5409945 Vali Loss: 0.2882888 Best vali loss: 0.2882888
	iters: 100, epoch: 2 | loss: 0.3254350
	speed: 0.0119s/iter; left time: 85.7195s
	iters: 200, epoch: 2 | loss: 0.3325751
	speed: 0.0039s/iter; left time: 27.6311s
	iters: 300, epoch: 2 | loss: 0.3033693
	speed: 0.0037s/iter; left time: 26.2861s
	iters: 400, epoch: 2 | loss: 0.4986320
	speed: 0.0038s/iter; left time: 26.2413s
	iters: 500, epoch: 2 | loss: 0.2264113
	speed: 0.0040s/iter; left time: 27.3084s
	iters: 600, epoch: 2 | loss: 0.2832710
	speed: 0.0040s/iter; left time: 26.8161s
	iters: 700, epoch: 2 | loss: 0.2565888
	speed: 0.0039s/iter; left time: 25.9791s
	iters: 800, epoch: 2 | loss: 0.3171576
	speed: 0.0039s/iter; left time: 25.4948s
	iters: 900, epoch: 2 | loss: 0.1796943
	speed: 0.0037s/iter; left time: 23.7727s
	iters: 1000, epoch: 2 | loss: 0.2532220
	speed: 0.0038s/iter; left time: 23.8483s
Updating learning rate to 9.12675761e-05
Validation loss decreased (0.2883 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 4.07733941078186
Epoch: 2, Steps: 1045 | Train Loss: 0.2976357 Vali Loss: 0.2828898 Best vali loss: 0.2828898
	iters: 100, epoch: 3 | loss: 0.1804103
	speed: 0.0113s/iter; left time: 69.7965s
	iters: 200, epoch: 3 | loss: 0.5319291
	speed: 0.0036s/iter; left time: 21.9698s
	iters: 300, epoch: 3 | loss: 0.2636096
	speed: 0.0037s/iter; left time: 22.1131s
	iters: 400, epoch: 3 | loss: 1.4014512
	speed: 0.0037s/iter; left time: 21.4634s
	iters: 500, epoch: 3 | loss: 0.2764021
	speed: 0.0037s/iter; left time: 21.2693s
	iters: 600, epoch: 3 | loss: 1.0454314
	speed: 0.0036s/iter; left time: 20.2340s
	iters: 700, epoch: 3 | loss: 0.2301618
	speed: 0.0036s/iter; left time: 20.2178s
	iters: 800, epoch: 3 | loss: 1.9620292
	speed: 0.0037s/iter; left time: 20.0265s
	iters: 900, epoch: 3 | loss: 0.2588667
	speed: 0.0037s/iter; left time: 19.9508s
	iters: 1000, epoch: 3 | loss: 1.1383628
	speed: 0.0038s/iter; left time: 19.8591s
Updating learning rate to 4.563378805e-05
Validation loss decreased (0.2829 --> 0.2828).  Saving model state dict ...
Epoch: 3 cost time: 3.865753650665283
Epoch: 3, Steps: 1045 | Train Loss: 0.7288654 Vali Loss: 0.2827502 Best vali loss: 0.2827502

best validation loss 0.28275020264834444

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0079123790288, 'e_layers': 2, 'learning_rate': 0.0002294846992, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2307086
	speed: 0.0090s/iter; left time: 22.6230s
	iters: 200, epoch: 4 | loss: 0.2797941
	speed: 0.0033s/iter; left time: 7.8981s
	iters: 300, epoch: 4 | loss: 0.3220010
	speed: 0.0030s/iter; left time: 6.9210s
	iters: 400, epoch: 4 | loss: 0.3940097
	speed: 0.0030s/iter; left time: 6.6704s
	iters: 500, epoch: 4 | loss: 0.4180700
	speed: 0.0030s/iter; left time: 6.3203s
Updating learning rate to 0.0001147423496
Epoch: 4 cost time: 1.9031190872192383
Epoch: 4, Steps: 523 | Train Loss: 0.3289167 Vali Loss: 0.2829794 Best vali loss: 0.2748753
	iters: 100, epoch: 5 | loss: 0.3494343
	speed: 0.0071s/iter; left time: 14.1392s
	iters: 200, epoch: 5 | loss: 0.1957424
	speed: 0.0029s/iter; left time: 5.5194s
	iters: 300, epoch: 5 | loss: 0.3876853
	speed: 0.0029s/iter; left time: 5.2100s
	iters: 400, epoch: 5 | loss: 0.6302029
	speed: 0.0029s/iter; left time: 4.9508s
	iters: 500, epoch: 5 | loss: 0.4349599
	speed: 0.0032s/iter; left time: 5.0227s
Updating learning rate to 7.083235341743692e-05
Epoch: 5 cost time: 1.622711181640625
Epoch: 5, Steps: 523 | Train Loss: 0.3996050 Vali Loss: 0.2898212 Best vali loss: 0.2748753
	iters: 100, epoch: 6 | loss: 0.4437380
	speed: 0.0069s/iter; left time: 10.1520s
	iters: 200, epoch: 6 | loss: 0.2468576
	speed: 0.0029s/iter; left time: 3.9704s
	iters: 300, epoch: 6 | loss: 0.3598146
	speed: 0.0029s/iter; left time: 3.6633s
	iters: 400, epoch: 6 | loss: 0.2070550
	speed: 0.0029s/iter; left time: 3.3957s
	iters: 500, epoch: 6 | loss: 0.1984788
	speed: 0.0029s/iter; left time: 3.0915s
Updating learning rate to 3.360725610856247e-05
Epoch: 6 cost time: 1.5629165172576904
Epoch: 6, Steps: 523 | Train Loss: 0.2911888 Vali Loss: 0.2991610 Best vali loss: 0.2748753
	iters: 100, epoch: 7 | loss: 0.1855018
	speed: 0.0073s/iter; left time: 6.9183s
	iters: 200, epoch: 7 | loss: 0.2625242
	speed: 0.0036s/iter; left time: 3.0132s
	iters: 300, epoch: 7 | loss: 0.2396889
	speed: 0.0036s/iter; left time: 2.6612s
	iters: 400, epoch: 7 | loss: 0.5349889
	speed: 0.0037s/iter; left time: 2.3618s
	iters: 500, epoch: 7 | loss: 0.2703789
	speed: 0.0035s/iter; left time: 1.8981s
Updating learning rate to 8.73424129230537e-06
Epoch: 7 cost time: 1.8862860202789307
Epoch: 7, Steps: 523 | Train Loss: 0.2986165 Vali Loss: 0.3144346 Best vali loss: 0.2748753
	iters: 100, epoch: 8 | loss: 0.1586103
	speed: 0.0075s/iter; left time: 3.1955s
	iters: 200, epoch: 8 | loss: 0.2145717
	speed: 0.0035s/iter; left time: 1.1343s
	iters: 300, epoch: 8 | loss: 0.2319546
	speed: 0.0035s/iter; left time: 0.7847s
	iters: 400, epoch: 8 | loss: 0.5073452
	speed: 0.0035s/iter; left time: 0.4400s
	iters: 500, epoch: 8 | loss: 0.2920807
	speed: 0.0035s/iter; left time: 0.0848s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.877124309539795
Epoch: 8, Steps: 523 | Train Loss: 0.2809125 Vali Loss: 0.3146949 Best vali loss: 0.2748753

best validation loss 0.2748752945570664

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0058740586444, 'e_layers': 4, 'learning_rate': 0.0001193150459, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0001193150459
Validation loss decreased (inf --> 0.3416).  Saving model state dict ...
Epoch: 1 cost time: 0.6624569892883301
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3416486 Best vali loss: 0.3416486
Updating learning rate to 5.965752295e-05
Validation loss decreased (0.3416 --> 0.3265).  Saving model state dict ...
Epoch: 2 cost time: 0.44350576400756836
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3264898 Best vali loss: 0.3264898
Updating learning rate to 2.9828761475e-05
Validation loss decreased (0.3265 --> 0.3207).  Saving model state dict ...
Epoch: 3 cost time: 0.4275505542755127
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3206600 Best vali loss: 0.3206600
Updating learning rate to 1.49143807375e-05
Validation loss decreased (0.3207 --> 0.3181).  Saving model state dict ...
Epoch: 4 cost time: 0.42094898223876953
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3181037 Best vali loss: 0.3181037
Updating learning rate to 7.45719036875e-06
Validation loss decreased (0.3181 --> 0.3169).  Saving model state dict ...
Epoch: 5 cost time: 0.43671464920043945
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3168614 Best vali loss: 0.3168614
Updating learning rate to 3.728595184375e-06
Validation loss decreased (0.3169 --> 0.3163).  Saving model state dict ...
Epoch: 6 cost time: 0.4233412742614746
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3162891 Best vali loss: 0.3162891
Updating learning rate to 1.8642975921875e-06
Validation loss decreased (0.3163 --> 0.3160).  Saving model state dict ...
Epoch: 7 cost time: 0.4451003074645996
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3159952 Best vali loss: 0.3159952
Updating learning rate to 9.3214879609375e-07
Validation loss decreased (0.3160 --> 0.3158).  Saving model state dict ...
Epoch: 8 cost time: 0.4258139133453369
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3158404 Best vali loss: 0.3158404

best validation loss 0.3158403962529162

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260851931, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597250
	speed: 0.0103s/iter; left time: 9.7789s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.928119421005249
Epoch: 1, Steps: 131 | Train Loss: 0.5597250 Vali Loss: 0.2756482 Best vali loss: 0.2756482
	iters: 100, epoch: 2 | loss: 0.3250094
	speed: 0.0089s/iter; left time: 7.2531s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2702).  Saving model state dict ...
Epoch: 2 cost time: 0.6991028785705566
Epoch: 2, Steps: 131 | Train Loss: 0.3250094 Vali Loss: 0.2701928 Best vali loss: 0.2701928
	iters: 100, epoch: 3 | loss: 0.4612505
	speed: 0.0089s/iter; left time: 6.1251s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.701885461807251
Epoch: 3, Steps: 131 | Train Loss: 0.4612505 Vali Loss: 0.2784959 Best vali loss: 0.2701928
	iters: 100, epoch: 4 | loss: 0.5056636
	speed: 0.0086s/iter; left time: 4.7902s
Updating learning rate to 2.93167934875e-05
Epoch: 4 cost time: 0.695202112197876
Epoch: 4, Steps: 131 | Train Loss: 0.5056636 Vali Loss: 0.2886786 Best vali loss: 0.2701928
	iters: 100, epoch: 5 | loss: 0.3324776
	speed: 0.0086s/iter; left time: 3.6347s
Updating learning rate to 1.465839674375e-05
Epoch: 5 cost time: 0.6908342838287354
Epoch: 5, Steps: 131 | Train Loss: 0.3324776 Vali Loss: 0.2863693 Best vali loss: 0.2701928
	iters: 100, epoch: 6 | loss: 0.3173034
	speed: 0.0086s/iter; left time: 2.5344s
Updating learning rate to 7.329198371875e-06
Epoch: 6 cost time: 0.7009148597717285
Epoch: 6, Steps: 131 | Train Loss: 0.3173034 Vali Loss: 0.2853515 Best vali loss: 0.2701928
	iters: 100, epoch: 7 | loss: 0.3119255
	speed: 0.0086s/iter; left time: 1.4012s
Updating learning rate to 3.6645991859375e-06
Epoch: 7 cost time: 0.6995935440063477
Epoch: 7, Steps: 131 | Train Loss: 0.3119255 Vali Loss: 0.2901928 Best vali loss: 0.2701928
	iters: 100, epoch: 8 | loss: 0.3970635
	speed: 0.0086s/iter; left time: 0.2761s
Updating learning rate to 1.83229959296875e-06
Epoch: 8 cost time: 0.6959996223449707
Epoch: 8, Steps: 131 | Train Loss: 0.3970635 Vali Loss: 0.2917587 Best vali loss: 0.2701928

best validation loss 0.2701928271330524

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002342318139, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596894
	speed: 0.0104s/iter; left time: 9.8966s
Updating learning rate to 0.0002342318139
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.932180643081665
Epoch: 1, Steps: 131 | Train Loss: 0.5596894 Vali Loss: 0.2756371 Best vali loss: 0.2756371
	iters: 100, epoch: 2 | loss: 0.3251837
	speed: 0.0088s/iter; left time: 7.2067s
Updating learning rate to 0.00011711590695
Validation loss decreased (0.2756 --> 0.2699).  Saving model state dict ...
Epoch: 2 cost time: 0.6993551254272461
Epoch: 2, Steps: 131 | Train Loss: 0.3251837 Vali Loss: 0.2699305 Best vali loss: 0.2699305
	iters: 100, epoch: 3 | loss: 0.4619479
	speed: 0.0089s/iter; left time: 6.1110s
Updating learning rate to 5.8557953475e-05
Epoch: 3 cost time: 0.6989331245422363
Epoch: 3, Steps: 131 | Train Loss: 0.4619479 Vali Loss: 0.2755530 Best vali loss: 0.2699305

best validation loss 0.2699305407173707

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021223334952, 'e_layers': 2, 'learning_rate': 0.0017891518482, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0017210563106533603
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 0.5569005012512207
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2833317 Best vali loss: 0.2833317
Updating learning rate to 0.001527136626317332
Epoch: 2 cost time: 0.32901668548583984
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2859670 Best vali loss: 0.2833317
Updating learning rate to 0.00123691530924576
Epoch: 3 cost time: 0.34113216400146484
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2946202 Best vali loss: 0.2833317

best validation loss 0.2833316580719024

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0023383884207, 'e_layers': 2, 'learning_rate': 0.0010194326494, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009806328044772072
Validation loss decreased (inf --> 0.2826).  Saving model state dict ...
Epoch: 1 cost time: 0.5704765319824219
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2826028 Best vali loss: 0.2826028
Updating learning rate to 0.0008701401943768541
Epoch: 2 cost time: 0.3401782512664795
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2831339 Best vali loss: 0.2826028
Updating learning rate to 0.0007047763173687146
Epoch: 3 cost time: 0.34337830543518066
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2973818 Best vali loss: 0.2826028

best validation loss 0.2826027518900942

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002342318139, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4276118
	speed: 0.0109s/iter; left time: 6.0512s
Updating learning rate to 2.92789767375e-05
Epoch: 4 cost time: 0.935166597366333
Epoch: 4, Steps: 131 | Train Loss: 0.4276118 Vali Loss: 0.3041329 Best vali loss: 0.2699305
	iters: 100, epoch: 5 | loss: 0.2813298
	speed: 0.0086s/iter; left time: 3.6534s
Updating learning rate to 1.463948836875e-05
Epoch: 5 cost time: 0.6902012825012207
Epoch: 5, Steps: 131 | Train Loss: 0.2813298 Vali Loss: 0.2943141 Best vali loss: 0.2699305
	iters: 100, epoch: 6 | loss: 0.4359493
	speed: 0.0086s/iter; left time: 2.5307s
Updating learning rate to 7.319744184375e-06
Epoch: 6 cost time: 0.7045950889587402
Epoch: 6, Steps: 131 | Train Loss: 0.4359493 Vali Loss: 0.2984862 Best vali loss: 0.2699305
	iters: 100, epoch: 7 | loss: 0.4682488
	speed: 0.0087s/iter; left time: 1.4160s
Updating learning rate to 3.6598720921875e-06
Epoch: 7 cost time: 0.7033929824829102
Epoch: 7, Steps: 131 | Train Loss: 0.4682488 Vali Loss: 0.2984133 Best vali loss: 0.2699305
	iters: 100, epoch: 8 | loss: 0.3273152
	speed: 0.0086s/iter; left time: 0.2758s
Updating learning rate to 1.82993604609375e-06
Epoch: 8 cost time: 0.7018561363220215
Epoch: 8, Steps: 131 | Train Loss: 0.3273152 Vali Loss: 0.2936446 Best vali loss: 0.2699305

best validation loss 0.2699305407173707

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0021235760485, 'e_layers': 4, 'learning_rate': 0.0011922284095, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2726142
	speed: 0.0103s/iter; left time: 84.7145s
	iters: 200, epoch: 1 | loss: 0.3643934
	speed: 0.0052s/iter; left time: 42.1644s
	iters: 300, epoch: 1 | loss: 0.9182674
	speed: 0.0052s/iter; left time: 41.5426s
	iters: 400, epoch: 1 | loss: 1.3544147
	speed: 0.0051s/iter; left time: 40.5659s
	iters: 500, epoch: 1 | loss: 0.5931420
	speed: 0.0052s/iter; left time: 40.6472s
	iters: 600, epoch: 1 | loss: 0.2631598
	speed: 0.0052s/iter; left time: 40.1206s
	iters: 700, epoch: 1 | loss: 0.3367655
	speed: 0.0051s/iter; left time: 39.3043s
	iters: 800, epoch: 1 | loss: 0.2784546
	speed: 0.0051s/iter; left time: 38.3955s
	iters: 900, epoch: 1 | loss: 1.4648540
	speed: 0.0051s/iter; left time: 38.2593s
	iters: 1000, epoch: 1 | loss: 0.3833953
	speed: 0.0051s/iter; left time: 37.6886s
Updating learning rate to 0.0011922284095
Validation loss decreased (inf --> 0.3246).  Saving model state dict ...
Epoch: 1 cost time: 5.618369102478027
Epoch: 1, Steps: 1045 | Train Loss: 0.6229461 Vali Loss: 0.3246055 Best vali loss: 0.3246055
	iters: 100, epoch: 2 | loss: 0.9933501
	speed: 0.0141s/iter; left time: 101.8657s
	iters: 200, epoch: 2 | loss: 0.2964800
	speed: 0.0050s/iter; left time: 35.7018s
	iters: 300, epoch: 2 | loss: 0.3236136
	speed: 0.0050s/iter; left time: 35.0867s
	iters: 400, epoch: 2 | loss: 0.5940441
	speed: 0.0050s/iter; left time: 34.5523s
	iters: 500, epoch: 2 | loss: 0.8573854
	speed: 0.0050s/iter; left time: 34.1726s
	iters: 600, epoch: 2 | loss: 1.1188978
	speed: 0.0050s/iter; left time: 33.5712s
	iters: 700, epoch: 2 | loss: 1.2322196
	speed: 0.0051s/iter; left time: 33.5157s
	iters: 800, epoch: 2 | loss: 1.1467844
	speed: 0.0050s/iter; left time: 32.7341s
	iters: 900, epoch: 2 | loss: 0.5217427
	speed: 0.0050s/iter; left time: 32.0813s
	iters: 1000, epoch: 2 | loss: 0.3971104
	speed: 0.0050s/iter; left time: 31.6480s
Updating learning rate to 0.00059611420475
Validation loss decreased (0.3246 --> 0.3225).  Saving model state dict ...
Epoch: 2 cost time: 5.28459620475769
Epoch: 2, Steps: 1045 | Train Loss: 0.7481628 Vali Loss: 0.3224955 Best vali loss: 0.3224955
	iters: 100, epoch: 3 | loss: 0.2329984
	speed: 0.0144s/iter; left time: 88.6960s
	iters: 200, epoch: 3 | loss: 1.2375875
	speed: 0.0050s/iter; left time: 30.6434s
	iters: 300, epoch: 3 | loss: 0.3379366
	speed: 0.0051s/iter; left time: 30.2039s
	iters: 400, epoch: 3 | loss: 0.3294647
	speed: 0.0051s/iter; left time: 29.6716s
	iters: 500, epoch: 3 | loss: 0.2822600
	speed: 0.0051s/iter; left time: 29.5498s
	iters: 600, epoch: 3 | loss: 0.5341761
	speed: 0.0052s/iter; left time: 29.3184s
	iters: 700, epoch: 3 | loss: 0.4935136
	speed: 0.0051s/iter; left time: 28.6712s
	iters: 800, epoch: 3 | loss: 0.2938503
	speed: 0.0051s/iter; left time: 27.9705s
	iters: 900, epoch: 3 | loss: 0.4825555
	speed: 0.0051s/iter; left time: 27.2688s
	iters: 1000, epoch: 3 | loss: 0.7276105
	speed: 0.0051s/iter; left time: 26.8854s
Updating learning rate to 0.000298057102375
Validation loss decreased (0.3225 --> 0.3206).  Saving model state dict ...
Epoch: 3 cost time: 5.361742734909058
Epoch: 3, Steps: 1045 | Train Loss: 0.4951953 Vali Loss: 0.3206254 Best vali loss: 0.3206254
	iters: 100, epoch: 4 | loss: 0.4111063
	speed: 0.0143s/iter; left time: 73.4732s
	iters: 200, epoch: 4 | loss: 1.2584310
	speed: 0.0052s/iter; left time: 26.2934s
	iters: 300, epoch: 4 | loss: 1.1108270
	speed: 0.0052s/iter; left time: 25.8112s
	iters: 400, epoch: 4 | loss: 0.2350276
	speed: 0.0052s/iter; left time: 25.1479s
	iters: 500, epoch: 4 | loss: 0.4851063
	speed: 0.0052s/iter; left time: 24.6408s
	iters: 600, epoch: 4 | loss: 0.2048526
	speed: 0.0052s/iter; left time: 24.2052s
	iters: 700, epoch: 4 | loss: 0.4195471
	speed: 0.0051s/iter; left time: 23.2353s
	iters: 800, epoch: 4 | loss: 0.5965761
	speed: 0.0051s/iter; left time: 22.4024s
	iters: 900, epoch: 4 | loss: 0.3276145
	speed: 0.0051s/iter; left time: 22.0159s
	iters: 1000, epoch: 4 | loss: 0.2661878
	speed: 0.0051s/iter; left time: 21.5831s
Updating learning rate to 0.0001490285511875
Epoch: 4 cost time: 5.44416069984436
Epoch: 4, Steps: 1045 | Train Loss: 0.5315276 Vali Loss: 0.3224686 Best vali loss: 0.3206254
	iters: 100, epoch: 5 | loss: 1.3553547
	speed: 0.0145s/iter; left time: 59.2248s
	iters: 200, epoch: 5 | loss: 1.1390150
	speed: 0.0051s/iter; left time: 20.4546s
	iters: 300, epoch: 5 | loss: 0.5798338
	speed: 0.0052s/iter; left time: 20.2153s
	iters: 400, epoch: 5 | loss: 1.2193234
	speed: 0.0049s/iter; left time: 18.3865s
	iters: 500, epoch: 5 | loss: 0.4900436
	speed: 0.0048s/iter; left time: 17.7950s
	iters: 600, epoch: 5 | loss: 0.3547368
	speed: 0.0048s/iter; left time: 17.1416s
	iters: 700, epoch: 5 | loss: 0.2415548
	speed: 0.0048s/iter; left time: 16.7361s
	iters: 800, epoch: 5 | loss: 1.1388147
	speed: 0.0047s/iter; left time: 15.7645s
	iters: 900, epoch: 5 | loss: 0.3080633
	speed: 0.0047s/iter; left time: 15.5177s
	iters: 1000, epoch: 5 | loss: 0.3967447
	speed: 0.0047s/iter; left time: 15.0616s
Updating learning rate to 7.451427559375e-05
Epoch: 5 cost time: 5.1522767543792725
Epoch: 5, Steps: 1045 | Train Loss: 0.7223485 Vali Loss: 0.3213563 Best vali loss: 0.3206254
	iters: 100, epoch: 6 | loss: 0.4490099
	speed: 0.0135s/iter; left time: 40.9551s
	iters: 200, epoch: 6 | loss: 0.2929802
	speed: 0.0046s/iter; left time: 13.3945s
	iters: 300, epoch: 6 | loss: 0.3061959
	speed: 0.0045s/iter; left time: 12.8264s
	iters: 400, epoch: 6 | loss: 1.7428699
	speed: 0.0045s/iter; left time: 12.3000s
	iters: 500, epoch: 6 | loss: 0.2968007
	speed: 0.0045s/iter; left time: 11.9397s
	iters: 600, epoch: 6 | loss: 0.3175168
	speed: 0.0046s/iter; left time: 11.7442s
	iters: 700, epoch: 6 | loss: 0.2375393
	speed: 0.0049s/iter; left time: 11.8598s
	iters: 800, epoch: 6 | loss: 0.5600891
	speed: 0.0049s/iter; left time: 11.4604s
	iters: 900, epoch: 6 | loss: 0.7822328
	speed: 0.0049s/iter; left time: 10.9220s
	iters: 1000, epoch: 6 | loss: 0.5031956
	speed: 0.0049s/iter; left time: 10.4037s
Updating learning rate to 3.7257137796875e-05
Epoch: 6 cost time: 4.9417901039123535
Epoch: 6, Steps: 1045 | Train Loss: 0.5488430 Vali Loss: 0.3223909 Best vali loss: 0.3206254
	iters: 100, epoch: 7 | loss: 2.1755497
	speed: 0.0138s/iter; left time: 27.4216s
	iters: 200, epoch: 7 | loss: 0.5061083
	speed: 0.0048s/iter; left time: 9.0899s
	iters: 300, epoch: 7 | loss: 0.7050589
	speed: 0.0048s/iter; left time: 8.5197s
	iters: 400, epoch: 7 | loss: 0.2955476
	speed: 0.0048s/iter; left time: 8.0824s
	iters: 500, epoch: 7 | loss: 0.6302091
	speed: 0.0048s/iter; left time: 7.6222s
	iters: 600, epoch: 7 | loss: 0.3493205
	speed: 0.0048s/iter; left time: 7.1533s
	iters: 700, epoch: 7 | loss: 0.8527948
	speed: 0.0048s/iter; left time: 6.7234s
	iters: 800, epoch: 7 | loss: 0.4360315
	speed: 0.0048s/iter; left time: 6.1829s
	iters: 900, epoch: 7 | loss: 0.4800796
	speed: 0.0048s/iter; left time: 5.7327s
	iters: 1000, epoch: 7 | loss: 0.4835225
	speed: 0.0048s/iter; left time: 5.2301s
Updating learning rate to 1.86285688984375e-05
Epoch: 7 cost time: 5.049512147903442
Epoch: 7, Steps: 1045 | Train Loss: 0.6914223 Vali Loss: 0.3225089 Best vali loss: 0.3206254
	iters: 100, epoch: 8 | loss: 0.2624516
	speed: 0.0139s/iter; left time: 13.1922s
	iters: 200, epoch: 8 | loss: 0.6134848
	speed: 0.0051s/iter; left time: 4.3303s
	iters: 300, epoch: 8 | loss: 0.4977574
	speed: 0.0051s/iter; left time: 3.8120s
	iters: 400, epoch: 8 | loss: 0.3208464
	speed: 0.0051s/iter; left time: 3.2694s
	iters: 500, epoch: 8 | loss: 0.3111197
	speed: 0.0051s/iter; left time: 2.7581s
	iters: 600, epoch: 8 | loss: 0.4133093
	speed: 0.0052s/iter; left time: 2.2997s
	iters: 700, epoch: 8 | loss: 1.1111156
	speed: 0.0051s/iter; left time: 1.7477s
	iters: 800, epoch: 8 | loss: 1.1216880
	speed: 0.0051s/iter; left time: 1.2621s
	iters: 900, epoch: 8 | loss: 0.2522112
	speed: 0.0051s/iter; left time: 0.7417s
	iters: 1000, epoch: 8 | loss: 0.3836043
	speed: 0.0051s/iter; left time: 0.2362s
Updating learning rate to 9.31428444921875e-06
Epoch: 8 cost time: 5.363970041275024
Epoch: 8, Steps: 1045 | Train Loss: 0.5287588 Vali Loss: 0.3222846 Best vali loss: 0.3206254

best validation loss 0.32062536810534115

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.002129670857, 'e_layers': 4, 'learning_rate': 0.0011946746878, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2996639
	speed: 0.0104s/iter; left time: 85.6668s
	iters: 200, epoch: 1 | loss: 0.3540034
	speed: 0.0052s/iter; left time: 42.0746s
	iters: 300, epoch: 1 | loss: 0.8231877
	speed: 0.0051s/iter; left time: 41.2767s
	iters: 400, epoch: 1 | loss: 1.3681543
	speed: 0.0051s/iter; left time: 40.6069s
	iters: 500, epoch: 1 | loss: 0.5960636
	speed: 0.0050s/iter; left time: 39.6142s
	iters: 600, epoch: 1 | loss: 0.2629413
	speed: 0.0050s/iter; left time: 38.9825s
	iters: 700, epoch: 1 | loss: 0.3341051
	speed: 0.0050s/iter; left time: 38.3819s
	iters: 800, epoch: 1 | loss: 0.2865390
	speed: 0.0050s/iter; left time: 37.9309s
	iters: 900, epoch: 1 | loss: 1.4613458
	speed: 0.0050s/iter; left time: 37.4686s
	iters: 1000, epoch: 1 | loss: 0.3787207
	speed: 0.0050s/iter; left time: 36.9838s
Updating learning rate to 0.0011492050899338658
Validation loss decreased (inf --> 0.3268).  Saving model state dict ...
Epoch: 1 cost time: 5.544005870819092
Epoch: 1, Steps: 1045 | Train Loss: 0.6164725 Vali Loss: 0.3267731 Best vali loss: 0.3267731
	iters: 100, epoch: 2 | loss: 1.0013958
	speed: 0.0139s/iter; left time: 100.4541s
	iters: 200, epoch: 2 | loss: 0.2956204
	speed: 0.0047s/iter; left time: 33.7368s
	iters: 300, epoch: 2 | loss: 0.3223149
	speed: 0.0049s/iter; left time: 34.5294s
	iters: 400, epoch: 2 | loss: 0.5936672
	speed: 0.0049s/iter; left time: 34.2223s
	iters: 500, epoch: 2 | loss: 0.8590912
	speed: 0.0049s/iter; left time: 33.6765s
	iters: 600, epoch: 2 | loss: 1.1072749
	speed: 0.0048s/iter; left time: 32.3867s
	iters: 700, epoch: 2 | loss: 1.2294344
	speed: 0.0049s/iter; left time: 32.4891s
	iters: 800, epoch: 2 | loss: 1.1383590
	speed: 0.0048s/iter; left time: 31.2210s
	iters: 900, epoch: 2 | loss: 0.5203784
	speed: 0.0048s/iter; left time: 30.8453s
	iters: 1000, epoch: 2 | loss: 0.3961812
	speed: 0.0048s/iter; left time: 30.1661s
Updating learning rate to 0.0010197186304276508
Validation loss decreased (0.3268 --> 0.3229).  Saving model state dict ...
Epoch: 2 cost time: 5.094783782958984
Epoch: 2, Steps: 1045 | Train Loss: 0.7463717 Vali Loss: 0.3229205 Best vali loss: 0.3229205
	iters: 100, epoch: 3 | loss: 0.2337691
	speed: 0.0137s/iter; left time: 84.8247s
	iters: 200, epoch: 3 | loss: 1.1441324
	speed: 0.0046s/iter; left time: 28.2119s
	iters: 300, epoch: 3 | loss: 0.3441376
	speed: 0.0046s/iter; left time: 27.6517s
	iters: 400, epoch: 3 | loss: 0.3291509
	speed: 0.0046s/iter; left time: 27.1923s
	iters: 500, epoch: 3 | loss: 0.2923273
	speed: 0.0046s/iter; left time: 26.7157s
	iters: 600, epoch: 3 | loss: 0.5298677
	speed: 0.0046s/iter; left time: 26.3022s
	iters: 700, epoch: 3 | loss: 0.4935422
	speed: 0.0047s/iter; left time: 26.0402s
	iters: 800, epoch: 3 | loss: 0.2917564
	speed: 0.0047s/iter; left time: 25.5450s
	iters: 900, epoch: 3 | loss: 0.4843183
	speed: 0.0047s/iter; left time: 25.0129s
	iters: 1000, epoch: 3 | loss: 0.7267870
	speed: 0.0046s/iter; left time: 24.4762s
Updating learning rate to 0.0008259284489434981
Validation loss decreased (0.3229 --> 0.3204).  Saving model state dict ...
Epoch: 3 cost time: 4.8964455127716064
Epoch: 3, Steps: 1045 | Train Loss: 0.4869789 Vali Loss: 0.3203662 Best vali loss: 0.3203662
	iters: 100, epoch: 4 | loss: 0.4105265
	speed: 0.0137s/iter; left time: 70.3427s
	iters: 200, epoch: 4 | loss: 1.2625152
	speed: 0.0046s/iter; left time: 22.9145s
	iters: 300, epoch: 4 | loss: 1.1110781
	speed: 0.0046s/iter; left time: 22.6561s
	iters: 400, epoch: 4 | loss: 0.2351669
	speed: 0.0047s/iter; left time: 22.5747s
	iters: 500, epoch: 4 | loss: 0.4814997
	speed: 0.0047s/iter; left time: 22.3126s
	iters: 600, epoch: 4 | loss: 0.2047910
	speed: 0.0048s/iter; left time: 22.3839s
	iters: 700, epoch: 4 | loss: 0.4190411
	speed: 0.0050s/iter; left time: 22.6024s
	iters: 800, epoch: 4 | loss: 0.6028709
	speed: 0.0050s/iter; left time: 22.0429s
	iters: 900, epoch: 4 | loss: 0.3298908
	speed: 0.0050s/iter; left time: 21.5287s
	iters: 1000, epoch: 4 | loss: 0.2658337
	speed: 0.0049s/iter; left time: 20.5324s
Updating learning rate to 0.0005973373439
Epoch: 4 cost time: 5.037820816040039
Epoch: 4, Steps: 1045 | Train Loss: 0.5323214 Vali Loss: 0.3219092 Best vali loss: 0.3203662
	iters: 100, epoch: 5 | loss: 1.3560793
	speed: 0.0142s/iter; left time: 57.9799s
	iters: 200, epoch: 5 | loss: 1.1394274
	speed: 0.0051s/iter; left time: 20.2701s
	iters: 300, epoch: 5 | loss: 0.5790510
	speed: 0.0051s/iter; left time: 19.7140s
	iters: 400, epoch: 5 | loss: 1.2181990
	speed: 0.0051s/iter; left time: 19.3558s
	iters: 500, epoch: 5 | loss: 0.4914643
	speed: 0.0051s/iter; left time: 18.8466s
	iters: 600, epoch: 5 | loss: 0.3559828
	speed: 0.0051s/iter; left time: 18.2857s
	iters: 700, epoch: 5 | loss: 0.2419406
	speed: 0.0051s/iter; left time: 17.7572s
	iters: 800, epoch: 5 | loss: 1.1396554
	speed: 0.0051s/iter; left time: 17.2507s
	iters: 900, epoch: 5 | loss: 0.3114096
	speed: 0.0051s/iter; left time: 16.6600s
	iters: 1000, epoch: 5 | loss: 0.3970813
	speed: 0.0050s/iter; left time: 16.0617s
Updating learning rate to 0.00036874623885650205
Epoch: 5 cost time: 5.3584816455841064
Epoch: 5, Steps: 1045 | Train Loss: 0.7230291 Vali Loss: 0.3213022 Best vali loss: 0.3203662
	iters: 100, epoch: 6 | loss: 0.4479530
	speed: 0.0139s/iter; left time: 42.3256s
	iters: 200, epoch: 6 | loss: 0.2926608
	speed: 0.0051s/iter; left time: 15.0351s
	iters: 300, epoch: 6 | loss: 0.3063019
	speed: 0.0051s/iter; left time: 14.3263s
	iters: 400, epoch: 6 | loss: 1.7418184
	speed: 0.0051s/iter; left time: 13.9739s
	iters: 500, epoch: 6 | loss: 0.2969452
	speed: 0.0051s/iter; left time: 13.5016s
	iters: 600, epoch: 6 | loss: 0.3175668
	speed: 0.0051s/iter; left time: 12.9780s
	iters: 700, epoch: 6 | loss: 0.2358528
	speed: 0.0051s/iter; left time: 12.5076s
	iters: 800, epoch: 6 | loss: 0.5605671
	speed: 0.0051s/iter; left time: 11.9566s
	iters: 900, epoch: 6 | loss: 0.7809118
	speed: 0.0051s/iter; left time: 11.4724s
	iters: 1000, epoch: 6 | loss: 0.5012748
	speed: 0.0052s/iter; left time: 11.0427s
Updating learning rate to 0.00017495605737234926
Epoch: 6 cost time: 5.386119604110718
Epoch: 6, Steps: 1045 | Train Loss: 0.5481853 Vali Loss: 0.3221373 Best vali loss: 0.3203662
	iters: 100, epoch: 7 | loss: 2.1693115
	speed: 0.0144s/iter; left time: 28.7656s
	iters: 200, epoch: 7 | loss: 0.5064772
	speed: 0.0052s/iter; left time: 9.7845s
	iters: 300, epoch: 7 | loss: 0.7019317
	speed: 0.0052s/iter; left time: 9.2592s
	iters: 400, epoch: 7 | loss: 0.2963564
	speed: 0.0051s/iter; left time: 8.6956s
	iters: 500, epoch: 7 | loss: 0.6306005
	speed: 0.0052s/iter; left time: 8.2413s
	iters: 600, epoch: 7 | loss: 0.3491888
	speed: 0.0052s/iter; left time: 7.7217s
	iters: 700, epoch: 7 | loss: 0.8522862
	speed: 0.0052s/iter; left time: 7.1774s
	iters: 800, epoch: 7 | loss: 0.4359555
	speed: 0.0052s/iter; left time: 6.6845s
	iters: 900, epoch: 7 | loss: 0.4793190
	speed: 0.0052s/iter; left time: 6.1906s
	iters: 1000, epoch: 7 | loss: 0.4837271
	speed: 0.0052s/iter; left time: 5.6460s
Updating learning rate to 4.5469597866134287e-05
Epoch: 7 cost time: 5.447326421737671
Epoch: 7, Steps: 1045 | Train Loss: 0.6905154 Vali Loss: 0.3262332 Best vali loss: 0.3203662
	iters: 100, epoch: 8 | loss: 0.2665217
	speed: 0.0141s/iter; left time: 13.3099s
	iters: 200, epoch: 8 | loss: 0.6135502
	speed: 0.0052s/iter; left time: 4.4209s
	iters: 300, epoch: 8 | loss: 0.4969582
	speed: 0.0052s/iter; left time: 3.8986s
	iters: 400, epoch: 8 | loss: 0.3227865
	speed: 0.0052s/iter; left time: 3.3654s
	iters: 500, epoch: 8 | loss: 0.3122229
	speed: 0.0052s/iter; left time: 2.8157s
	iters: 600, epoch: 8 | loss: 0.4120909
	speed: 0.0052s/iter; left time: 2.3121s
	iters: 700, epoch: 8 | loss: 1.1017293
	speed: 0.0052s/iter; left time: 1.7986s
	iters: 800, epoch: 8 | loss: 1.1107543
	speed: 0.0051s/iter; left time: 1.2649s
	iters: 900, epoch: 8 | loss: 0.2514453
	speed: 0.0052s/iter; left time: 0.7559s
	iters: 1000, epoch: 8 | loss: 0.3835483
	speed: 0.0052s/iter; left time: 0.2379s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.453088760375977
Epoch: 8, Steps: 1045 | Train Loss: 0.5271608 Vali Loss: 0.3226484 Best vali loss: 0.3203662

best validation loss 0.32036617207633555

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0069423276892, 'e_layers': 1, 'learning_rate': 0.0036570589572, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0035178704384720753
Validation loss decreased (inf --> 0.2887).  Saving model state dict ...
Epoch: 1 cost time: 0.5192384719848633
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2886622 Best vali loss: 0.2886622
Updating learning rate to 0.003121495072517562
Epoch: 2 cost time: 0.2688939571380615
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2927989 Best vali loss: 0.2886622
Updating learning rate to 0.0025282774156513963
Validation loss decreased (0.2887 --> 0.2868).  Saving model state dict ...
Epoch: 3 cost time: 0.2801187038421631
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2868181 Best vali loss: 0.2868181

best validation loss 0.2868181302362146

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.000234191009, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597007
	speed: 0.0100s/iter; left time: 9.4465s
Updating learning rate to 0.000234191009
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9522099494934082
Epoch: 1, Steps: 131 | Train Loss: 0.5597007 Vali Loss: 0.2756736 Best vali loss: 0.2756736
	iters: 100, epoch: 2 | loss: 0.3242247
	speed: 0.0088s/iter; left time: 7.2236s
Updating learning rate to 0.0001170955045
Validation loss decreased (0.2757 --> 0.2707).  Saving model state dict ...
Epoch: 2 cost time: 0.695075511932373
Epoch: 2, Steps: 131 | Train Loss: 0.3242247 Vali Loss: 0.2706513 Best vali loss: 0.2706513
	iters: 100, epoch: 3 | loss: 0.4639628
	speed: 0.0089s/iter; left time: 6.1255s
Updating learning rate to 5.854775225e-05
Epoch: 3 cost time: 0.7020442485809326
Epoch: 3, Steps: 131 | Train Loss: 0.4639628 Vali Loss: 0.2773762 Best vali loss: 0.2706513

best validation loss 0.27065132255224367

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.000234433846, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597223
	speed: 0.0104s/iter; left time: 9.8687s
Updating learning rate to 0.000234433846
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9202375411987305
Epoch: 1, Steps: 131 | Train Loss: 0.5597223 Vali Loss: 0.2756370 Best vali loss: 0.2756370
	iters: 100, epoch: 2 | loss: 0.3247102
	speed: 0.0088s/iter; left time: 7.2031s
Updating learning rate to 0.000117216923
Validation loss decreased (0.2756 --> 0.2701).  Saving model state dict ...
Epoch: 2 cost time: 0.6984663009643555
Epoch: 2, Steps: 131 | Train Loss: 0.3247102 Vali Loss: 0.2701034 Best vali loss: 0.2701034
	iters: 100, epoch: 3 | loss: 0.4628356
	speed: 0.0089s/iter; left time: 6.1299s
Updating learning rate to 5.86084615e-05
Epoch: 3 cost time: 0.7015001773834229
Epoch: 3, Steps: 131 | Train Loss: 0.4628356 Vali Loss: 0.2785683 Best vali loss: 0.2701034

best validation loss 0.27010339983957504

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.000234433846, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4165650
	speed: 0.0107s/iter; left time: 5.9442s
Updating learning rate to 2.930423075e-05
Epoch: 4 cost time: 0.9172389507293701
Epoch: 4, Steps: 131 | Train Loss: 0.4165650 Vali Loss: 0.3065394 Best vali loss: 0.2701034
	iters: 100, epoch: 5 | loss: 0.2808883
	speed: 0.0086s/iter; left time: 3.6760s
Updating learning rate to 1.4652115375e-05
Epoch: 5 cost time: 0.6965987682342529
Epoch: 5, Steps: 131 | Train Loss: 0.2808883 Vali Loss: 0.2900417 Best vali loss: 0.2701034
	iters: 100, epoch: 6 | loss: 0.4331618
	speed: 0.0086s/iter; left time: 2.5360s
Updating learning rate to 7.3260576875e-06
Epoch: 6 cost time: 0.6986165046691895
Epoch: 6, Steps: 131 | Train Loss: 0.4331618 Vali Loss: 0.2970391 Best vali loss: 0.2701034
	iters: 100, epoch: 7 | loss: 0.4663351
	speed: 0.0086s/iter; left time: 1.4035s
Updating learning rate to 3.66302884375e-06
Epoch: 7 cost time: 0.6977264881134033
Epoch: 7, Steps: 131 | Train Loss: 0.4663351 Vali Loss: 0.2938068 Best vali loss: 0.2701034
	iters: 100, epoch: 8 | loss: 0.3265152
	speed: 0.0087s/iter; left time: 0.2778s
Updating learning rate to 1.831514421875e-06
Epoch: 8 cost time: 0.7034282684326172
Epoch: 8, Steps: 131 | Train Loss: 0.3265152 Vali Loss: 0.2914474 Best vali loss: 0.2701034

best validation loss 0.27010339983957504

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0041671015006, 'e_layers': 2, 'learning_rate': 5.09279053e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7157293
	speed: 0.0086s/iter; left time: 8.1990s
Updating learning rate to 5.09279053e-05
Validation loss decreased (inf --> 0.2953).  Saving model state dict ...
Epoch: 1 cost time: 0.7785804271697998
Epoch: 1, Steps: 131 | Train Loss: 0.7157293 Vali Loss: 0.2952620 Best vali loss: 0.2952620
	iters: 100, epoch: 2 | loss: 0.6574692
	speed: 0.0070s/iter; left time: 5.7041s
Updating learning rate to 2.546395265e-05
Validation loss decreased (0.2953 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 0.5577316284179688
Epoch: 2, Steps: 131 | Train Loss: 0.6574692 Vali Loss: 0.2828880 Best vali loss: 0.2828880
	iters: 100, epoch: 3 | loss: 0.6089262
	speed: 0.0065s/iter; left time: 4.4384s
Updating learning rate to 1.2731976325e-05
Validation loss decreased (0.2829 --> 0.2811).  Saving model state dict ...
Epoch: 3 cost time: 0.5083646774291992
Epoch: 3, Steps: 131 | Train Loss: 0.6089262 Vali Loss: 0.2811336 Best vali loss: 0.2811336
	iters: 100, epoch: 4 | loss: 0.5925116
	speed: 0.0065s/iter; left time: 3.6309s
Updating learning rate to 6.3659881625e-06
Validation loss decreased (0.2811 --> 0.2805).  Saving model state dict ...
Epoch: 4 cost time: 0.5133240222930908
Epoch: 4, Steps: 131 | Train Loss: 0.5925116 Vali Loss: 0.2805269 Best vali loss: 0.2805269
	iters: 100, epoch: 5 | loss: 0.4975904
	speed: 0.0075s/iter; left time: 3.1868s
Updating learning rate to 3.18299408125e-06
Validation loss decreased (0.2805 --> 0.2804).  Saving model state dict ...
Epoch: 5 cost time: 0.5307052135467529
Epoch: 5, Steps: 131 | Train Loss: 0.4975904 Vali Loss: 0.2804160 Best vali loss: 0.2804160
	iters: 100, epoch: 6 | loss: 0.7312629
	speed: 0.0076s/iter; left time: 2.2430s
Updating learning rate to 1.591497040625e-06
Validation loss decreased (0.2804 --> 0.2803).  Saving model state dict ...
Epoch: 6 cost time: 0.6449718475341797
Epoch: 6, Steps: 131 | Train Loss: 0.7312629 Vali Loss: 0.2803262 Best vali loss: 0.2803262
	iters: 100, epoch: 7 | loss: 0.3330900
	speed: 0.0066s/iter; left time: 1.0707s
Updating learning rate to 7.957485203125e-07
Validation loss decreased (0.2803 --> 0.2803).  Saving model state dict ...
Epoch: 7 cost time: 0.5174403190612793
Epoch: 7, Steps: 131 | Train Loss: 0.3330900 Vali Loss: 0.2802749 Best vali loss: 0.2802749
	iters: 100, epoch: 8 | loss: 0.6148511
	speed: 0.0070s/iter; left time: 0.2227s
Updating learning rate to 3.9787426015625e-07
Validation loss decreased (0.2803 --> 0.2803).  Saving model state dict ...
Epoch: 8 cost time: 0.5654113292694092
Epoch: 8, Steps: 131 | Train Loss: 0.6148511 Vali Loss: 0.2802577 Best vali loss: 0.2802577

best validation loss 0.28025767437950216

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0011237426607, 'e_layers': 1, 'learning_rate': 5.17171235e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7896093
	speed: 0.0089s/iter; left time: 17.8076s
	iters: 200, epoch: 1 | loss: 0.5510463
	speed: 0.0027s/iter; left time: 5.0546s
Updating learning rate to 4.974875769100424e-05
Validation loss decreased (inf --> 0.3245).  Saving model state dict ...
Epoch: 1 cost time: 1.1254358291625977
Epoch: 1, Steps: 262 | Train Loss: 0.6703278 Vali Loss: 0.3245281 Best vali loss: 0.3245281
	iters: 100, epoch: 2 | loss: 0.5451180
	speed: 0.0065s/iter; left time: 11.2306s
	iters: 200, epoch: 2 | loss: 0.3722679
	speed: 0.0026s/iter; left time: 4.1874s
Updating learning rate to 4.414332611515608e-05
Validation loss decreased (0.3245 --> 0.3067).  Saving model state dict ...
Epoch: 2 cost time: 0.7129132747650146
Epoch: 2, Steps: 262 | Train Loss: 0.4586930 Vali Loss: 0.3067378 Best vali loss: 0.3067378
	iters: 100, epoch: 3 | loss: 0.6233929
	speed: 0.0061s/iter; left time: 8.9398s
	iters: 200, epoch: 3 | loss: 0.9026262
	speed: 0.0024s/iter; left time: 3.3320s
Updating learning rate to 3.575420491651463e-05
Validation loss decreased (0.3067 --> 0.2977).  Saving model state dict ...
Epoch: 3 cost time: 0.6896491050720215
Epoch: 3, Steps: 262 | Train Loss: 0.7630096 Vali Loss: 0.2977358 Best vali loss: 0.2977358
	iters: 100, epoch: 4 | loss: 0.4878374
	speed: 0.0062s/iter; left time: 7.4661s
	iters: 200, epoch: 4 | loss: 0.5153278
	speed: 0.0026s/iter; left time: 2.9198s
Updating learning rate to 2.585856175e-05
Validation loss decreased (0.2977 --> 0.2923).  Saving model state dict ...
Epoch: 4 cost time: 0.7183845043182373
Epoch: 4, Steps: 262 | Train Loss: 0.5015826 Vali Loss: 0.2923313 Best vali loss: 0.2923313
	iters: 100, epoch: 5 | loss: 0.4617425
	speed: 0.0061s/iter; left time: 5.8293s
	iters: 200, epoch: 5 | loss: 0.5025378
	speed: 0.0026s/iter; left time: 2.1659s
Updating learning rate to 1.596291858348538e-05
Validation loss decreased (0.2923 --> 0.2895).  Saving model state dict ...
Epoch: 5 cost time: 0.6939821243286133
Epoch: 5, Steps: 262 | Train Loss: 0.4821401 Vali Loss: 0.2895078 Best vali loss: 0.2895078
	iters: 100, epoch: 6 | loss: 0.5889448
	speed: 0.0062s/iter; left time: 4.2821s
	iters: 200, epoch: 6 | loss: 0.5985386
	speed: 0.0025s/iter; left time: 1.4584s
Updating learning rate to 7.573797384843924e-06
Validation loss decreased (0.2895 --> 0.2881).  Saving model state dict ...
Epoch: 6 cost time: 0.6976940631866455
Epoch: 6, Steps: 262 | Train Loss: 0.5937417 Vali Loss: 0.2881010 Best vali loss: 0.2881010
	iters: 100, epoch: 7 | loss: 0.5881513
	speed: 0.0062s/iter; left time: 2.6309s
	iters: 200, epoch: 7 | loss: 0.3309420
	speed: 0.0026s/iter; left time: 0.8597s
Updating learning rate to 1.9683658089957594e-06
Validation loss decreased (0.2881 --> 0.2875).  Saving model state dict ...
Epoch: 7 cost time: 0.7240285873413086
Epoch: 7, Steps: 262 | Train Loss: 0.4595466 Vali Loss: 0.2874629 Best vali loss: 0.2874629
	iters: 100, epoch: 8 | loss: 0.2734147
	speed: 0.0062s/iter; left time: 1.0098s
	iters: 200, epoch: 8 | loss: 0.6759078
	speed: 0.0024s/iter; left time: 0.1519s
Updating learning rate to 0.0
Validation loss decreased (0.2875 --> 0.2873).  Saving model state dict ...
Epoch: 8 cost time: 0.6869325637817383
Epoch: 8, Steps: 262 | Train Loss: 0.4746612 Vali Loss: 0.2873046 Best vali loss: 0.2873046

best validation loss 0.28730460852329154

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012527633614, 'e_layers': 4, 'learning_rate': 0.0020200195434, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0019431371274100274
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 0.6810905933380127
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2940130 Best vali loss: 0.2940130
Updating learning rate to 0.0017241945303337466
Validation loss decreased (0.2940 --> 0.2888).  Saving model state dict ...
Epoch: 2 cost time: 0.44411706924438477
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2888049 Best vali loss: 0.2888049
Updating learning rate to 0.0013965237778564368
Validation loss decreased (0.2888 --> 0.2887).  Saving model state dict ...
Epoch: 3 cost time: 0.4531216621398926
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2887058 Best vali loss: 0.2887058

best validation loss 0.2887057673647396

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0015969437661, 'e_layers': 4, 'learning_rate': 0.0020195568756, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0019426920688546416
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 0.6652333736419678
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2850140 Best vali loss: 0.2850140
Updating learning rate to 0.0017237996186643383
Epoch: 2 cost time: 0.43472743034362793
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2921844 Best vali loss: 0.2850140
Updating learning rate to 0.0013962039163055624
Validation loss decreased (0.2850 --> 0.2779).  Saving model state dict ...
Epoch: 3 cost time: 0.44998836517333984
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2778770 Best vali loss: 0.2778770

best validation loss 0.2778770016549954

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0060926224291, 'e_layers': 3, 'learning_rate': 0.0002322644741, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002322644741
Validation loss decreased (inf --> 0.3052).  Saving model state dict ...
Epoch: 1 cost time: 0.6149284839630127
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3051935 Best vali loss: 0.3051935
Updating learning rate to 0.00011613223705
Validation loss decreased (0.3052 --> 0.2873).  Saving model state dict ...
Epoch: 2 cost time: 0.382932186126709
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2873045 Best vali loss: 0.2873045
Updating learning rate to 5.8066118525e-05
Validation loss decreased (0.2873 --> 0.2850).  Saving model state dict ...
Epoch: 3 cost time: 0.36676883697509766
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2850212 Best vali loss: 0.2850212

best validation loss 0.2850211608549528

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0015969437661, 'e_layers': 4, 'learning_rate': 0.0020195568756, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0010097784378
Epoch: 4 cost time: 0.6821625232696533
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2966526 Best vali loss: 0.2778770
Updating learning rate to 0.0006233529592944378
Epoch: 5 cost time: 0.4558990001678467
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2832280 Best vali loss: 0.2778770
Updating learning rate to 0.00029575725693566166
Epoch: 6 cost time: 0.4590628147125244
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2848593 Best vali loss: 0.2778770
Updating learning rate to 7.686480674535857e-05
Epoch: 7 cost time: 0.46302342414855957
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2859495 Best vali loss: 0.2778770
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4382760524749756
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2878287 Best vali loss: 0.2778770

best validation loss 0.2778770016549954

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013101198079, 'e_layers': 2, 'learning_rate': 0.0002153389936, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5577743
	speed: 0.0104s/iter; left time: 9.8563s
Updating learning rate to 0.00020714314116930947
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9266855716705322
Epoch: 1, Steps: 131 | Train Loss: 0.5577743 Vali Loss: 0.2755961 Best vali loss: 0.2755961
	iters: 100, epoch: 2 | loss: 0.3243892
	speed: 0.0089s/iter; left time: 7.3118s
Updating learning rate to 0.00018380332811422328
Validation loss decreased (0.2756 --> 0.2711).  Saving model state dict ...
Epoch: 2 cost time: 0.7039663791656494
Epoch: 2, Steps: 131 | Train Loss: 0.3243892 Vali Loss: 0.2710808 Best vali loss: 0.2710808
	iters: 100, epoch: 3 | loss: 0.4686748
	speed: 0.0090s/iter; left time: 6.1718s
Updating learning rate to 0.00014887282939644606
Epoch: 3 cost time: 0.6953637599945068
Epoch: 3, Steps: 131 | Train Loss: 0.4686748 Vali Loss: 0.2798798 Best vali loss: 0.2710808
	iters: 100, epoch: 4 | loss: 0.4880058
	speed: 0.0086s/iter; left time: 4.7798s
Updating learning rate to 0.0001076694968
Epoch: 4 cost time: 0.6959052085876465
Epoch: 4, Steps: 131 | Train Loss: 0.4880058 Vali Loss: 0.2748038 Best vali loss: 0.2710808
	iters: 100, epoch: 5 | loss: 0.3304054
	speed: 0.0087s/iter; left time: 3.6886s
Updating learning rate to 6.646616420355395e-05
Epoch: 5 cost time: 0.7009806632995605
Epoch: 5, Steps: 131 | Train Loss: 0.3304054 Vali Loss: 0.2907276 Best vali loss: 0.2710808
	iters: 100, epoch: 6 | loss: 0.3089577
	speed: 0.0086s/iter; left time: 2.5269s
Updating learning rate to 3.153566548577673e-05
Epoch: 6 cost time: 0.692699670791626
Epoch: 6, Steps: 131 | Train Loss: 0.3089577 Vali Loss: 0.2971882 Best vali loss: 0.2710808
	iters: 100, epoch: 7 | loss: 0.2870315
	speed: 0.0086s/iter; left time: 1.3967s
Updating learning rate to 8.195852430690517e-06
Epoch: 7 cost time: 0.696455717086792
Epoch: 7, Steps: 131 | Train Loss: 0.2870315 Vali Loss: 0.2985749 Best vali loss: 0.2710808
	iters: 100, epoch: 8 | loss: 0.3525339
	speed: 0.0087s/iter; left time: 0.2770s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7000467777252197
Epoch: 8, Steps: 131 | Train Loss: 0.3525339 Vali Loss: 0.2996302 Best vali loss: 0.2710808

best validation loss 0.27108079844489336

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0026377322782, 'e_layers': 4, 'learning_rate': 0.0013661038036, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3538829
	speed: 0.0104s/iter; left time: 85.7944s
	iters: 200, epoch: 1 | loss: 0.2326257
	speed: 0.0051s/iter; left time: 41.3802s
	iters: 300, epoch: 1 | loss: 0.9074427
	speed: 0.0051s/iter; left time: 40.9520s
	iters: 400, epoch: 1 | loss: 0.3081702
	speed: 0.0050s/iter; left time: 40.1284s
	iters: 500, epoch: 1 | loss: 0.2434363
	speed: 0.0047s/iter; left time: 36.8518s
	iters: 600, epoch: 1 | loss: 1.2022227
	speed: 0.0046s/iter; left time: 35.8641s
	iters: 700, epoch: 1 | loss: 0.2602151
	speed: 0.0044s/iter; left time: 33.7055s
	iters: 800, epoch: 1 | loss: 0.3124388
	speed: 0.0044s/iter; left time: 33.5006s
	iters: 900, epoch: 1 | loss: 0.9165607
	speed: 0.0045s/iter; left time: 33.4003s
	iters: 1000, epoch: 1 | loss: 0.2472450
	speed: 0.0048s/iter; left time: 35.3302s
Updating learning rate to 0.0013141095735159293
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 5.245198011398315
Epoch: 1, Steps: 1045 | Train Loss: 0.4984240 Vali Loss: 0.2877126 Best vali loss: 0.2877126
	iters: 100, epoch: 2 | loss: 0.2191420
	speed: 0.0133s/iter; left time: 95.6955s
	iters: 200, epoch: 2 | loss: 0.3991462
	speed: 0.0047s/iter; left time: 33.2731s
	iters: 300, epoch: 2 | loss: 0.4654310
	speed: 0.0046s/iter; left time: 32.3304s
	iters: 400, epoch: 2 | loss: 1.0584354
	speed: 0.0047s/iter; left time: 32.4895s
	iters: 500, epoch: 2 | loss: 0.1896552
	speed: 0.0047s/iter; left time: 31.9461s
	iters: 600, epoch: 2 | loss: 0.4339104
	speed: 0.0047s/iter; left time: 31.6157s
	iters: 700, epoch: 2 | loss: 0.5257730
	speed: 0.0046s/iter; left time: 30.7256s
	iters: 800, epoch: 2 | loss: 0.2928573
	speed: 0.0047s/iter; left time: 30.5157s
	iters: 900, epoch: 2 | loss: 0.2800821
	speed: 0.0047s/iter; left time: 30.2164s
	iters: 1000, epoch: 2 | loss: 0.2814401
	speed: 0.0050s/iter; left time: 31.6941s
Updating learning rate to 0.0011660425334651477
Epoch: 2 cost time: 4.976470947265625
Epoch: 2, Steps: 1045 | Train Loss: 0.4145873 Vali Loss: 0.2896050 Best vali loss: 0.2877126
	iters: 100, epoch: 3 | loss: 1.2330083
	speed: 0.0139s/iter; left time: 85.8538s
	iters: 200, epoch: 3 | loss: 0.2807882
	speed: 0.0051s/iter; left time: 30.7180s
	iters: 300, epoch: 3 | loss: 1.0116588
	speed: 0.0051s/iter; left time: 30.1607s
	iters: 400, epoch: 3 | loss: 0.4364945
	speed: 0.0051s/iter; left time: 29.9561s
	iters: 500, epoch: 3 | loss: 0.2476094
	speed: 0.0047s/iter; left time: 27.1669s
	iters: 600, epoch: 3 | loss: 0.4087074
	speed: 0.0044s/iter; left time: 24.7780s
	iters: 700, epoch: 3 | loss: 0.2783730
	speed: 0.0044s/iter; left time: 24.3950s
	iters: 800, epoch: 3 | loss: 0.4246166
	speed: 0.0044s/iter; left time: 24.0353s
	iters: 900, epoch: 3 | loss: 0.3805733
	speed: 0.0044s/iter; left time: 23.5198s
	iters: 1000, epoch: 3 | loss: 0.3151235
	speed: 0.0044s/iter; left time: 23.2837s
Updating learning rate to 0.0009444445480643262
Epoch: 3 cost time: 4.914056777954102
Epoch: 3, Steps: 1045 | Train Loss: 0.5016953 Vali Loss: 0.2888674 Best vali loss: 0.2877126
	iters: 100, epoch: 4 | loss: 0.2526913
	speed: 0.0132s/iter; left time: 67.6472s
	iters: 200, epoch: 4 | loss: 0.2673494
	speed: 0.0047s/iter; left time: 23.5239s
	iters: 300, epoch: 4 | loss: 0.2251255
	speed: 0.0049s/iter; left time: 24.1851s
	iters: 400, epoch: 4 | loss: 0.1910677
	speed: 0.0049s/iter; left time: 23.6383s
	iters: 500, epoch: 4 | loss: 1.6416461
	speed: 0.0047s/iter; left time: 22.2133s
	iters: 600, epoch: 4 | loss: 0.4198802
	speed: 0.0047s/iter; left time: 21.7132s
	iters: 700, epoch: 4 | loss: 0.7224108
	speed: 0.0047s/iter; left time: 21.3099s
	iters: 800, epoch: 4 | loss: 0.2676096
	speed: 0.0047s/iter; left time: 20.8320s
	iters: 900, epoch: 4 | loss: 0.2082583
	speed: 0.0047s/iter; left time: 20.2454s
	iters: 1000, epoch: 4 | loss: 0.3239158
	speed: 0.0047s/iter; left time: 19.9958s
Updating learning rate to 0.0006830519018
Epoch: 4 cost time: 4.988966941833496
Epoch: 4, Steps: 1045 | Train Loss: 0.4519955 Vali Loss: 0.2951895 Best vali loss: 0.2877126
	iters: 100, epoch: 5 | loss: 0.9475172
	speed: 0.0136s/iter; left time: 55.6971s
	iters: 200, epoch: 5 | loss: 0.3317268
	speed: 0.0046s/iter; left time: 18.4162s
	iters: 300, epoch: 5 | loss: 0.2515252
	speed: 0.0045s/iter; left time: 17.5870s
	iters: 400, epoch: 5 | loss: 1.2780890
	speed: 0.0046s/iter; left time: 17.2213s
	iters: 500, epoch: 5 | loss: 0.8828964
	speed: 0.0047s/iter; left time: 17.2062s
	iters: 600, epoch: 5 | loss: 0.5015236
	speed: 0.0046s/iter; left time: 16.5790s
	iters: 700, epoch: 5 | loss: 0.7786312
	speed: 0.0045s/iter; left time: 15.7094s
	iters: 800, epoch: 5 | loss: 0.4849027
	speed: 0.0044s/iter; left time: 14.9154s
	iters: 900, epoch: 5 | loss: 0.2769434
	speed: 0.0044s/iter; left time: 14.4288s
	iters: 1000, epoch: 5 | loss: 0.3053007
	speed: 0.0044s/iter; left time: 13.9397s
Updating learning rate to 0.0004216592555356738
Epoch: 5 cost time: 4.762386322021484
Epoch: 5, Steps: 1045 | Train Loss: 0.6039056 Vali Loss: 0.2977869 Best vali loss: 0.2877126
	iters: 100, epoch: 6 | loss: 0.2924262
	speed: 0.0130s/iter; left time: 39.5934s
	iters: 200, epoch: 6 | loss: 1.3181453
	speed: 0.0044s/iter; left time: 12.8372s
	iters: 300, epoch: 6 | loss: 0.2111309
	speed: 0.0044s/iter; left time: 12.4771s
	iters: 400, epoch: 6 | loss: 0.4520583
	speed: 0.0044s/iter; left time: 11.9960s
	iters: 500, epoch: 6 | loss: 0.2066858
	speed: 0.0044s/iter; left time: 11.5284s
	iters: 600, epoch: 6 | loss: 0.2776860
	speed: 0.0044s/iter; left time: 11.1371s
	iters: 700, epoch: 6 | loss: 0.5032445
	speed: 0.0044s/iter; left time: 10.6760s
	iters: 800, epoch: 6 | loss: 0.6438231
	speed: 0.0046s/iter; left time: 10.6928s
	iters: 900, epoch: 6 | loss: 0.2169017
	speed: 0.0048s/iter; left time: 10.6484s
	iters: 1000, epoch: 6 | loss: 0.2164535
	speed: 0.0050s/iter; left time: 10.7230s
Updating learning rate to 0.00020006127013485228
Epoch: 6 cost time: 4.774028062820435
Epoch: 6, Steps: 1045 | Train Loss: 0.4338555 Vali Loss: 0.3060589 Best vali loss: 0.2877126
	iters: 100, epoch: 7 | loss: 0.3928626
	speed: 0.0137s/iter; left time: 27.3150s
	iters: 200, epoch: 7 | loss: 0.5047365
	speed: 0.0050s/iter; left time: 9.4677s
	iters: 300, epoch: 7 | loss: 0.6596696
	speed: 0.0048s/iter; left time: 8.5474s
	iters: 400, epoch: 7 | loss: 1.5103202
	speed: 0.0048s/iter; left time: 8.0771s
	iters: 500, epoch: 7 | loss: 0.3178386
	speed: 0.0047s/iter; left time: 7.4593s
	iters: 600, epoch: 7 | loss: 0.3675446
	speed: 0.0045s/iter; left time: 6.6528s
	iters: 700, epoch: 7 | loss: 0.3736507
	speed: 0.0046s/iter; left time: 6.3305s
	iters: 800, epoch: 7 | loss: 0.3370032
	speed: 0.0044s/iter; left time: 5.7403s
	iters: 900, epoch: 7 | loss: 0.4502583
	speed: 0.0044s/iter; left time: 5.2817s
	iters: 1000, epoch: 7 | loss: 0.1829631
	speed: 0.0045s/iter; left time: 4.8551s
Updating learning rate to 5.199423008407066e-05
Epoch: 7 cost time: 4.907552242279053
Epoch: 7, Steps: 1045 | Train Loss: 0.5096847 Vali Loss: 0.3025716 Best vali loss: 0.2877126
	iters: 100, epoch: 8 | loss: 0.5459583
	speed: 0.0141s/iter; left time: 13.3571s
	iters: 200, epoch: 8 | loss: 0.3515520
	speed: 0.0046s/iter; left time: 3.8922s
	iters: 300, epoch: 8 | loss: 0.5425200
	speed: 0.0045s/iter; left time: 3.3688s
	iters: 400, epoch: 8 | loss: 0.4225742
	speed: 0.0046s/iter; left time: 2.9502s
	iters: 500, epoch: 8 | loss: 0.1694746
	speed: 0.0045s/iter; left time: 2.4762s
	iters: 600, epoch: 8 | loss: 0.2559648
	speed: 0.0045s/iter; left time: 2.0267s
	iters: 700, epoch: 8 | loss: 0.2232117
	speed: 0.0044s/iter; left time: 1.5194s
	iters: 800, epoch: 8 | loss: 0.8531327
	speed: 0.0045s/iter; left time: 1.0976s
	iters: 900, epoch: 8 | loss: 0.5541567
	speed: 0.0045s/iter; left time: 0.6514s
	iters: 1000, epoch: 8 | loss: 0.3602658
	speed: 0.0046s/iter; left time: 0.2101s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.808067798614502
Epoch: 8, Steps: 1045 | Train Loss: 0.4278811 Vali Loss: 0.3049500 Best vali loss: 0.2877126

best validation loss 0.2877125668787256

[INFO][smbo.py:320] Finished 750 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0105787606783, 'e_layers': 1, 'learning_rate': 0.0001498429977, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4771886
	speed: 0.0076s/iter; left time: 62.8978s
	iters: 200, epoch: 1 | loss: 0.4297555
	speed: 0.0023s/iter; left time: 19.0336s
	iters: 300, epoch: 1 | loss: 0.5270208
	speed: 0.0023s/iter; left time: 18.6459s
	iters: 400, epoch: 1 | loss: 0.2962594
	speed: 0.0023s/iter; left time: 18.4005s
	iters: 500, epoch: 1 | loss: 0.8924119
	speed: 0.0023s/iter; left time: 17.9681s
	iters: 600, epoch: 1 | loss: 1.5778193
	speed: 0.0023s/iter; left time: 17.9268s
	iters: 700, epoch: 1 | loss: 0.2550533
	speed: 0.0023s/iter; left time: 17.7655s
	iters: 800, epoch: 1 | loss: 0.3046237
	speed: 0.0023s/iter; left time: 17.4523s
	iters: 900, epoch: 1 | loss: 0.5441484
	speed: 0.0023s/iter; left time: 17.3483s
	iters: 1000, epoch: 1 | loss: 0.3046676
	speed: 0.0023s/iter; left time: 17.0389s
Updating learning rate to 0.00014413993818258291
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 2.679901123046875
Epoch: 1, Steps: 1045 | Train Loss: 0.5608949 Vali Loss: 0.2822914 Best vali loss: 0.2822914
	iters: 100, epoch: 2 | loss: 0.3381022
	speed: 0.0079s/iter; left time: 56.9531s
	iters: 200, epoch: 2 | loss: 0.1974229
	speed: 0.0021s/iter; left time: 15.0014s
	iters: 300, epoch: 2 | loss: 1.4048707
	speed: 0.0021s/iter; left time: 14.7269s
	iters: 400, epoch: 2 | loss: 0.3497386
	speed: 0.0021s/iter; left time: 14.5221s
	iters: 500, epoch: 2 | loss: 0.3651668
	speed: 0.0021s/iter; left time: 14.3980s
	iters: 600, epoch: 2 | loss: 0.5736563
	speed: 0.0021s/iter; left time: 14.4239s
	iters: 700, epoch: 2 | loss: 0.2484961
	speed: 0.0022s/iter; left time: 14.2346s
	iters: 800, epoch: 2 | loss: 0.5030593
	speed: 0.0021s/iter; left time: 13.9720s
	iters: 900, epoch: 2 | loss: 0.2287012
	speed: 0.0022s/iter; left time: 14.1038s
	iters: 1000, epoch: 2 | loss: 0.9916493
	speed: 0.0023s/iter; left time: 14.5465s
Updating learning rate to 0.00012789899874349512
Validation loss decreased (0.2823 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 2.2868030071258545
Epoch: 2, Steps: 1045 | Train Loss: 0.5200864 Vali Loss: 0.2818428 Best vali loss: 0.2818428
	iters: 100, epoch: 3 | loss: 0.8357967
	speed: 0.0079s/iter; left time: 48.6011s
	iters: 200, epoch: 3 | loss: 0.5892704
	speed: 0.0021s/iter; left time: 12.5113s
	iters: 300, epoch: 3 | loss: 0.2843540
	speed: 0.0021s/iter; left time: 12.3460s
	iters: 400, epoch: 3 | loss: 0.3797572
	speed: 0.0021s/iter; left time: 12.2845s
	iters: 500, epoch: 3 | loss: 0.9669622
	speed: 0.0021s/iter; left time: 12.0663s
	iters: 600, epoch: 3 | loss: 0.4268683
	speed: 0.0022s/iter; left time: 12.3291s
	iters: 700, epoch: 3 | loss: 0.3382625
	speed: 0.0022s/iter; left time: 12.2639s
	iters: 800, epoch: 3 | loss: 0.4158073
	speed: 0.0022s/iter; left time: 12.0517s
	iters: 900, epoch: 3 | loss: 0.1662487
	speed: 0.0022s/iter; left time: 11.7696s
	iters: 1000, epoch: 3 | loss: 0.3220266
	speed: 0.0021s/iter; left time: 11.1138s
Updating learning rate to 0.00010359271518785513
Epoch: 3 cost time: 2.2567222118377686
Epoch: 3, Steps: 1045 | Train Loss: 0.4725354 Vali Loss: 0.2830303 Best vali loss: 0.2818428

best validation loss 0.28184282921556647

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.004289342491, 'e_layers': 1, 'learning_rate': 5.75791314e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6330669
	speed: 0.0080s/iter; left time: 16.0435s
	iters: 200, epoch: 1 | loss: 0.7529084
	speed: 0.0026s/iter; left time: 4.9817s
Updating learning rate to 5.538765620011897e-05
Validation loss decreased (inf --> 0.3029).  Saving model state dict ...
Epoch: 1 cost time: 0.9426493644714355
Epoch: 1, Steps: 262 | Train Loss: 0.6929877 Vali Loss: 0.3028510 Best vali loss: 0.3028510
	iters: 100, epoch: 2 | loss: 1.0765811
	speed: 0.0063s/iter; left time: 10.8532s
	iters: 200, epoch: 2 | loss: 0.9112850
	speed: 0.0028s/iter; left time: 4.5173s
Updating learning rate to 4.914686283388563e-05
Validation loss decreased (0.3029 --> 0.2886).  Saving model state dict ...
Epoch: 2 cost time: 0.7553460597991943
Epoch: 2, Steps: 262 | Train Loss: 0.9939331 Vali Loss: 0.2885507 Best vali loss: 0.2885507
	iters: 100, epoch: 3 | loss: 0.6010174
	speed: 0.0065s/iter; left time: 9.5589s
	iters: 200, epoch: 3 | loss: 0.5092947
	speed: 0.0027s/iter; left time: 3.7213s
Updating learning rate to 3.980685551837626e-05
Validation loss decreased (0.2886 --> 0.2834).  Saving model state dict ...
Epoch: 3 cost time: 0.7305431365966797
Epoch: 3, Steps: 262 | Train Loss: 0.5551560 Vali Loss: 0.2834048 Best vali loss: 0.2834048

best validation loss 0.28340478498293326

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3662868
	speed: 0.0086s/iter; left time: 70.9499s
	iters: 200, epoch: 1 | loss: 0.2519838
	speed: 0.0033s/iter; left time: 27.1621s
	iters: 300, epoch: 1 | loss: 0.2990442
	speed: 0.0033s/iter; left time: 26.8125s
	iters: 400, epoch: 1 | loss: 0.2895895
	speed: 0.0033s/iter; left time: 26.0239s
	iters: 500, epoch: 1 | loss: 0.1778567
	speed: 0.0033s/iter; left time: 25.7972s
	iters: 600, epoch: 1 | loss: 0.1721627
	speed: 0.0033s/iter; left time: 25.8856s
	iters: 700, epoch: 1 | loss: 0.7470512
	speed: 0.0033s/iter; left time: 25.1588s
	iters: 800, epoch: 1 | loss: 0.3441483
	speed: 0.0033s/iter; left time: 24.9826s
	iters: 900, epoch: 1 | loss: 0.2698459
	speed: 0.0033s/iter; left time: 24.7646s
	iters: 1000, epoch: 1 | loss: 0.5810307
	speed: 0.0033s/iter; left time: 24.4420s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2980).  Saving model state dict ...
Epoch: 1 cost time: 3.7242889404296875
Epoch: 1, Steps: 1045 | Train Loss: 0.3499000 Vali Loss: 0.2980155 Best vali loss: 0.2980155
	iters: 100, epoch: 2 | loss: 0.8617923
	speed: 0.0100s/iter; left time: 72.4840s
	iters: 200, epoch: 2 | loss: 0.4195094
	speed: 0.0029s/iter; left time: 20.6095s
	iters: 300, epoch: 2 | loss: 0.3008893
	speed: 0.0029s/iter; left time: 20.3906s
	iters: 400, epoch: 2 | loss: 0.5087313
	speed: 0.0029s/iter; left time: 20.2167s
	iters: 500, epoch: 2 | loss: 0.3663823
	speed: 0.0029s/iter; left time: 19.6824s
	iters: 600, epoch: 2 | loss: 0.3059518
	speed: 0.0029s/iter; left time: 19.2538s
	iters: 700, epoch: 2 | loss: 0.6402940
	speed: 0.0029s/iter; left time: 19.0639s
	iters: 800, epoch: 2 | loss: 0.3293448
	speed: 0.0030s/iter; left time: 19.6441s
	iters: 900, epoch: 2 | loss: 0.8080883
	speed: 0.0029s/iter; left time: 18.8003s
	iters: 1000, epoch: 2 | loss: 0.2000471
	speed: 0.0033s/iter; left time: 20.8563s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2980 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 3.144470453262329
Epoch: 2, Steps: 1045 | Train Loss: 0.4741031 Vali Loss: 0.2824648 Best vali loss: 0.2824648
	iters: 100, epoch: 3 | loss: 0.4385769
	speed: 0.0101s/iter; left time: 62.5258s
	iters: 200, epoch: 3 | loss: 0.5774116
	speed: 0.0032s/iter; left time: 19.1515s
	iters: 300, epoch: 3 | loss: 0.4890284
	speed: 0.0031s/iter; left time: 18.7534s
	iters: 400, epoch: 3 | loss: 0.1975052
	speed: 0.0031s/iter; left time: 18.4413s
	iters: 500, epoch: 3 | loss: 0.3665906
	speed: 0.0032s/iter; left time: 18.1793s
	iters: 600, epoch: 3 | loss: 0.1168306
	speed: 0.0031s/iter; left time: 17.7544s
	iters: 700, epoch: 3 | loss: 1.0061996
	speed: 0.0031s/iter; left time: 17.4295s
	iters: 800, epoch: 3 | loss: 0.9228376
	speed: 0.0031s/iter; left time: 17.1637s
	iters: 900, epoch: 3 | loss: 0.2799838
	speed: 0.0032s/iter; left time: 16.9341s
	iters: 1000, epoch: 3 | loss: 0.5498312
	speed: 0.0031s/iter; left time: 16.4895s
Updating learning rate to 5.8633586975e-05
Validation loss decreased (0.2825 --> 0.2786).  Saving model state dict ...
Epoch: 3 cost time: 3.3225646018981934
Epoch: 3, Steps: 1045 | Train Loss: 0.4944795 Vali Loss: 0.2785891 Best vali loss: 0.2785891

best validation loss 0.2785890529527235

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3342665
	speed: 0.0090s/iter; left time: 46.1987s
	iters: 200, epoch: 4 | loss: 0.2581745
	speed: 0.0034s/iter; left time: 17.1519s
	iters: 300, epoch: 4 | loss: 0.2158165
	speed: 0.0034s/iter; left time: 16.6302s
	iters: 400, epoch: 4 | loss: 0.2675105
	speed: 0.0034s/iter; left time: 16.2447s
	iters: 500, epoch: 4 | loss: 0.1822924
	speed: 0.0034s/iter; left time: 15.9938s
	iters: 600, epoch: 4 | loss: 0.1882697
	speed: 0.0034s/iter; left time: 15.7583s
	iters: 700, epoch: 4 | loss: 0.5238401
	speed: 0.0034s/iter; left time: 15.3566s
	iters: 800, epoch: 4 | loss: 0.3239388
	speed: 0.0034s/iter; left time: 15.0210s
	iters: 900, epoch: 4 | loss: 0.2579286
	speed: 0.0034s/iter; left time: 14.7160s
	iters: 1000, epoch: 4 | loss: 0.5376014
	speed: 0.0034s/iter; left time: 14.3711s
Updating learning rate to 2.93167934875e-05
Validation loss decreased (0.2786 --> 0.2760).  Saving model state dict ...
Epoch: 4 cost time: 3.8164119720458984
Epoch: 4, Steps: 1045 | Train Loss: 0.3089639 Vali Loss: 0.2759866 Best vali loss: 0.2759866
	iters: 100, epoch: 5 | loss: 0.6605009
	speed: 0.0108s/iter; left time: 44.1390s
	iters: 200, epoch: 5 | loss: 0.3582279
	speed: 0.0034s/iter; left time: 13.4533s
	iters: 300, epoch: 5 | loss: 0.1804801
	speed: 0.0033s/iter; left time: 12.9455s
	iters: 400, epoch: 5 | loss: 0.4633786
	speed: 0.0034s/iter; left time: 12.7053s
	iters: 500, epoch: 5 | loss: 0.3106757
	speed: 0.0034s/iter; left time: 12.3440s
	iters: 600, epoch: 5 | loss: 0.2425271
	speed: 0.0033s/iter; left time: 11.9315s
	iters: 700, epoch: 5 | loss: 0.3911455
	speed: 0.0031s/iter; left time: 10.8604s
	iters: 800, epoch: 5 | loss: 0.2630414
	speed: 0.0031s/iter; left time: 10.4260s
	iters: 900, epoch: 5 | loss: 0.3887508
	speed: 0.0031s/iter; left time: 10.0897s
	iters: 1000, epoch: 5 | loss: 0.1546299
	speed: 0.0031s/iter; left time: 9.7333s
Updating learning rate to 1.465839674375e-05
Epoch: 5 cost time: 3.428204298019409
Epoch: 5, Steps: 1045 | Train Loss: 0.3413358 Vali Loss: 0.2782677 Best vali loss: 0.2759866
	iters: 100, epoch: 6 | loss: 0.3476596
	speed: 0.0099s/iter; left time: 30.1343s
	iters: 200, epoch: 6 | loss: 0.5244508
	speed: 0.0031s/iter; left time: 8.9836s
	iters: 300, epoch: 6 | loss: 0.3972560
	speed: 0.0031s/iter; left time: 8.7856s
	iters: 400, epoch: 6 | loss: 0.1848677
	speed: 0.0031s/iter; left time: 8.4100s
	iters: 500, epoch: 6 | loss: 0.2934351
	speed: 0.0031s/iter; left time: 8.0594s
	iters: 600, epoch: 6 | loss: 0.1165347
	speed: 0.0031s/iter; left time: 7.7506s
	iters: 700, epoch: 6 | loss: 0.7370656
	speed: 0.0031s/iter; left time: 7.4612s
	iters: 800, epoch: 6 | loss: 0.3871429
	speed: 0.0031s/iter; left time: 7.2164s
	iters: 900, epoch: 6 | loss: 0.1761392
	speed: 0.0030s/iter; left time: 6.8179s
	iters: 1000, epoch: 6 | loss: 0.4544103
	speed: 0.0031s/iter; left time: 6.5157s
Updating learning rate to 7.329198371875e-06
Epoch: 6 cost time: 3.251894474029541
Epoch: 6, Steps: 1045 | Train Loss: 0.3618962 Vali Loss: 0.2794992 Best vali loss: 0.2759866
	iters: 100, epoch: 7 | loss: 0.4951977
	speed: 0.0098s/iter; left time: 19.5540s
	iters: 200, epoch: 7 | loss: 0.3976200
	speed: 0.0031s/iter; left time: 5.9399s
	iters: 300, epoch: 7 | loss: 0.2357450
	speed: 0.0032s/iter; left time: 5.7116s
	iters: 400, epoch: 7 | loss: 0.2849428
	speed: 0.0032s/iter; left time: 5.3287s
	iters: 500, epoch: 7 | loss: 0.4214500
	speed: 0.0031s/iter; left time: 4.9988s
	iters: 600, epoch: 7 | loss: 0.4327332
	speed: 0.0031s/iter; left time: 4.6940s
	iters: 700, epoch: 7 | loss: 0.1996650
	speed: 0.0032s/iter; left time: 4.4493s
	iters: 800, epoch: 7 | loss: 0.3855962
	speed: 0.0032s/iter; left time: 4.1048s
	iters: 900, epoch: 7 | loss: 0.2214122
	speed: 0.0032s/iter; left time: 3.7901s
	iters: 1000, epoch: 7 | loss: 0.3156610
	speed: 0.0032s/iter; left time: 3.4466s
Updating learning rate to 3.6645991859375e-06
Epoch: 7 cost time: 3.343324899673462
Epoch: 7, Steps: 1045 | Train Loss: 0.3390023 Vali Loss: 0.2800317 Best vali loss: 0.2759866
	iters: 100, epoch: 8 | loss: 0.5652027
	speed: 0.0098s/iter; left time: 9.3059s
	iters: 200, epoch: 8 | loss: 0.2653246
	speed: 0.0032s/iter; left time: 2.6791s
	iters: 300, epoch: 8 | loss: 0.2728487
	speed: 0.0031s/iter; left time: 2.3454s
	iters: 400, epoch: 8 | loss: 0.7125875
	speed: 0.0031s/iter; left time: 2.0199s
	iters: 500, epoch: 8 | loss: 0.2670698
	speed: 0.0031s/iter; left time: 1.6751s
	iters: 600, epoch: 8 | loss: 0.3722757
	speed: 0.0031s/iter; left time: 1.3626s
	iters: 700, epoch: 8 | loss: 0.2115984
	speed: 0.0031s/iter; left time: 1.0617s
	iters: 800, epoch: 8 | loss: 0.2396850
	speed: 0.0030s/iter; left time: 0.7450s
	iters: 900, epoch: 8 | loss: 0.1953266
	speed: 0.0030s/iter; left time: 0.4367s
	iters: 1000, epoch: 8 | loss: 0.3557951
	speed: 0.0030s/iter; left time: 0.1380s
Updating learning rate to 1.83229959296875e-06
Epoch: 8 cost time: 3.2469499111175537
Epoch: 8, Steps: 1045 | Train Loss: 0.3457714 Vali Loss: 0.2801859 Best vali loss: 0.2759866

best validation loss 0.27598660284367227

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010233418694, 'e_layers': 2, 'learning_rate': 0.0004659819873, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5968710
	speed: 0.0104s/iter; left time: 9.8915s
Updating learning rate to 0.0004659819873
Validation loss decreased (inf --> 0.2749).  Saving model state dict ...
Epoch: 1 cost time: 0.9305682182312012
Epoch: 1, Steps: 131 | Train Loss: 0.5968710 Vali Loss: 0.2748825 Best vali loss: 0.2748825
	iters: 100, epoch: 2 | loss: 0.3286690
	speed: 0.0089s/iter; left time: 7.2840s
Updating learning rate to 0.00023299099365
Epoch: 2 cost time: 0.6974830627441406
Epoch: 2, Steps: 131 | Train Loss: 0.3286690 Vali Loss: 0.2876028 Best vali loss: 0.2748825
	iters: 100, epoch: 3 | loss: 0.4573900
	speed: 0.0085s/iter; left time: 5.8512s
Updating learning rate to 0.000116495496825
Epoch: 3 cost time: 0.6904923915863037
Epoch: 3, Steps: 131 | Train Loss: 0.4573900 Vali Loss: 0.2850452 Best vali loss: 0.2748825
	iters: 100, epoch: 4 | loss: 0.4717267
	speed: 0.0087s/iter; left time: 4.8238s
Updating learning rate to 5.82477484125e-05
Epoch: 4 cost time: 0.7016119956970215
Epoch: 4, Steps: 131 | Train Loss: 0.4717267 Vali Loss: 0.2827269 Best vali loss: 0.2748825
	iters: 100, epoch: 5 | loss: 0.3162241
	speed: 0.0086s/iter; left time: 3.6407s
Updating learning rate to 2.912387420625e-05
Epoch: 5 cost time: 0.6941730976104736
Epoch: 5, Steps: 131 | Train Loss: 0.3162241 Vali Loss: 0.2854808 Best vali loss: 0.2748825
	iters: 100, epoch: 6 | loss: 0.3013138
	speed: 0.0087s/iter; left time: 2.5488s
Updating learning rate to 1.4561937103125e-05
Epoch: 6 cost time: 0.7041070461273193
Epoch: 6, Steps: 131 | Train Loss: 0.3013138 Vali Loss: 0.2873139 Best vali loss: 0.2748825
	iters: 100, epoch: 7 | loss: 0.2944167
	speed: 0.0086s/iter; left time: 1.4021s
Updating learning rate to 7.2809685515625e-06
Epoch: 7 cost time: 0.7026317119598389
Epoch: 7, Steps: 131 | Train Loss: 0.2944167 Vali Loss: 0.2894932 Best vali loss: 0.2748825
	iters: 100, epoch: 8 | loss: 0.3579123
	speed: 0.0086s/iter; left time: 0.2761s
Updating learning rate to 3.64048427578125e-06
Epoch: 8 cost time: 0.6949870586395264
Epoch: 8, Steps: 131 | Train Loss: 0.3579123 Vali Loss: 0.2887365 Best vali loss: 0.2748825

best validation loss 0.27488253765741927

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010046486723, 'e_layers': 2, 'learning_rate': 0.0004541920578, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5951778
	speed: 0.0104s/iter; left time: 9.8971s
Updating learning rate to 0.0004541920578
Validation loss decreased (inf --> 0.2762).  Saving model state dict ...
Epoch: 1 cost time: 0.9384539127349854
Epoch: 1, Steps: 131 | Train Loss: 0.5951778 Vali Loss: 0.2761594 Best vali loss: 0.2761594
	iters: 100, epoch: 2 | loss: 0.3214179
	speed: 0.0089s/iter; left time: 7.2514s
Updating learning rate to 0.0002270960289
Epoch: 2 cost time: 0.6984450817108154
Epoch: 2, Steps: 131 | Train Loss: 0.3214179 Vali Loss: 0.2848988 Best vali loss: 0.2761594
	iters: 100, epoch: 3 | loss: 0.4492996
	speed: 0.0087s/iter; left time: 5.9874s
Updating learning rate to 0.00011354801445
Epoch: 3 cost time: 0.7006344795227051
Epoch: 3, Steps: 131 | Train Loss: 0.4492996 Vali Loss: 0.2784748 Best vali loss: 0.2761594
	iters: 100, epoch: 4 | loss: 0.4482128
	speed: 0.0086s/iter; left time: 4.8023s
Updating learning rate to 5.6774007225e-05
Epoch: 4 cost time: 0.6964244842529297
Epoch: 4, Steps: 131 | Train Loss: 0.4482128 Vali Loss: 0.2793224 Best vali loss: 0.2761594
	iters: 100, epoch: 5 | loss: 0.3150650
	speed: 0.0087s/iter; left time: 3.7187s
Updating learning rate to 2.83870036125e-05
Epoch: 5 cost time: 0.7023055553436279
Epoch: 5, Steps: 131 | Train Loss: 0.3150650 Vali Loss: 0.2797217 Best vali loss: 0.2761594
	iters: 100, epoch: 6 | loss: 0.2941264
	speed: 0.0087s/iter; left time: 2.5498s
Updating learning rate to 1.419350180625e-05
Epoch: 6 cost time: 0.7009449005126953
Epoch: 6, Steps: 131 | Train Loss: 0.2941264 Vali Loss: 0.2808539 Best vali loss: 0.2761594
	iters: 100, epoch: 7 | loss: 0.2852178
	speed: 0.0087s/iter; left time: 1.4113s
Updating learning rate to 7.096750903125e-06
Epoch: 7 cost time: 0.7018411159515381
Epoch: 7, Steps: 131 | Train Loss: 0.2852178 Vali Loss: 0.2830487 Best vali loss: 0.2761594
	iters: 100, epoch: 8 | loss: 0.3481034
	speed: 0.0088s/iter; left time: 0.2829s
Updating learning rate to 3.5483754515625e-06
Epoch: 8 cost time: 0.709071159362793
Epoch: 8, Steps: 131 | Train Loss: 0.3481034 Vali Loss: 0.2836043 Best vali loss: 0.2761594

best validation loss 0.27615941921855136

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022561174318, 'e_layers': 2, 'learning_rate': 0.0004655962595, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5963489
	speed: 0.0104s/iter; left time: 9.8539s
Updating learning rate to 0.0004655962595
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 0.9276089668273926
Epoch: 1, Steps: 131 | Train Loss: 0.5963489 Vali Loss: 0.2802984 Best vali loss: 0.2802984
	iters: 100, epoch: 2 | loss: 0.3329368
	speed: 0.0089s/iter; left time: 7.3046s
Updating learning rate to 0.00023279812975
Epoch: 2 cost time: 0.7062997817993164
Epoch: 2, Steps: 131 | Train Loss: 0.3329368 Vali Loss: 0.2977157 Best vali loss: 0.2802984
	iters: 100, epoch: 3 | loss: 0.4455236
	speed: 0.0086s/iter; left time: 5.9391s
Updating learning rate to 0.000116399064875
Epoch: 3 cost time: 0.7007293701171875
Epoch: 3, Steps: 131 | Train Loss: 0.4455236 Vali Loss: 0.2845476 Best vali loss: 0.2802984

best validation loss 0.2802983762584862

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0038900198779, 'e_layers': 2, 'learning_rate': 8.13816151e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.828421180680073e-05
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.7044334411621094
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2780658 Best vali loss: 0.2780658
Updating learning rate to 6.946355350056176e-05
Validation loss decreased (0.2781 --> 0.2777).  Saving model state dict ...
Epoch: 2 cost time: 0.47884678840637207
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2777429 Best vali loss: 0.2777429
Updating learning rate to 5.626250544894131e-05
Validation loss decreased (0.2777 --> 0.2767).  Saving model state dict ...
Epoch: 3 cost time: 0.47298383712768555
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2767055 Best vali loss: 0.2767055

best validation loss 0.2767054967252505

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345458708, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597017
	speed: 0.0104s/iter; left time: 9.8505s
Updating learning rate to 0.0002345458708
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9306464195251465
Epoch: 1, Steps: 131 | Train Loss: 0.5597017 Vali Loss: 0.2756333 Best vali loss: 0.2756333
	iters: 100, epoch: 2 | loss: 0.3240323
	speed: 0.0089s/iter; left time: 7.2723s
Updating learning rate to 0.0001172729354
Validation loss decreased (0.2756 --> 0.2694).  Saving model state dict ...
Epoch: 2 cost time: 0.702225923538208
Epoch: 2, Steps: 131 | Train Loss: 0.3240323 Vali Loss: 0.2694195 Best vali loss: 0.2694195
	iters: 100, epoch: 3 | loss: 0.4641241
	speed: 0.0091s/iter; left time: 6.2224s
Updating learning rate to 5.86364677e-05
Epoch: 3 cost time: 0.7091209888458252
Epoch: 3, Steps: 131 | Train Loss: 0.4641241 Vali Loss: 0.2809387 Best vali loss: 0.2694195

best validation loss 0.2694195464846369

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345458708, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4215982
	speed: 0.0107s/iter; left time: 5.9605s
Updating learning rate to 2.931823385e-05
Epoch: 4 cost time: 0.9292597770690918
Epoch: 4, Steps: 131 | Train Loss: 0.4215982 Vali Loss: 0.3129468 Best vali loss: 0.2694195
	iters: 100, epoch: 5 | loss: 0.2806553
	speed: 0.0086s/iter; left time: 3.6681s
Updating learning rate to 1.4659116925e-05
Epoch: 5 cost time: 0.6966598033905029
Epoch: 5, Steps: 131 | Train Loss: 0.2806553 Vali Loss: 0.2947020 Best vali loss: 0.2694195
	iters: 100, epoch: 6 | loss: 0.4353945
	speed: 0.0086s/iter; left time: 2.5383s
Updating learning rate to 7.3295584625e-06
Epoch: 6 cost time: 0.6962296962738037
Epoch: 6, Steps: 131 | Train Loss: 0.4353945 Vali Loss: 0.2974264 Best vali loss: 0.2694195
	iters: 100, epoch: 7 | loss: 0.4721832
	speed: 0.0086s/iter; left time: 1.4054s
Updating learning rate to 3.66477923125e-06
Epoch: 7 cost time: 0.7004899978637695
Epoch: 7, Steps: 131 | Train Loss: 0.4721832 Vali Loss: 0.2978879 Best vali loss: 0.2694195
	iters: 100, epoch: 8 | loss: 0.3298661
	speed: 0.0087s/iter; left time: 0.2781s
Updating learning rate to 1.832389615625e-06
Epoch: 8 cost time: 0.704265832901001
Epoch: 8, Steps: 131 | Train Loss: 0.3298661 Vali Loss: 0.2944194 Best vali loss: 0.2694195

best validation loss 0.2694195464846369

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014147169131, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5595339
	speed: 0.0104s/iter; left time: 9.8495s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9326939582824707
Epoch: 1, Steps: 131 | Train Loss: 0.5595339 Vali Loss: 0.2756652 Best vali loss: 0.2756652
	iters: 100, epoch: 2 | loss: 0.3266495
	speed: 0.0090s/iter; left time: 7.3500s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2757 --> 0.2720).  Saving model state dict ...
Epoch: 2 cost time: 0.7076592445373535
Epoch: 2, Steps: 131 | Train Loss: 0.3266495 Vali Loss: 0.2719797 Best vali loss: 0.2719797
	iters: 100, epoch: 3 | loss: 0.4620396
	speed: 0.0090s/iter; left time: 6.2172s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.6989133358001709
Epoch: 3, Steps: 131 | Train Loss: 0.4620396 Vali Loss: 0.2859545 Best vali loss: 0.2719797
	iters: 100, epoch: 4 | loss: 0.5001548
	speed: 0.0087s/iter; left time: 4.8369s
Updating learning rate to 2.9310739475e-05
Epoch: 4 cost time: 0.7054452896118164
Epoch: 4, Steps: 131 | Train Loss: 0.5001548 Vali Loss: 0.2899199 Best vali loss: 0.2719797
	iters: 100, epoch: 5 | loss: 0.3338971
	speed: 0.0086s/iter; left time: 3.6471s
Updating learning rate to 1.46553697375e-05
Epoch: 5 cost time: 0.6954293251037598
Epoch: 5, Steps: 131 | Train Loss: 0.3338971 Vali Loss: 0.2966098 Best vali loss: 0.2719797
	iters: 100, epoch: 6 | loss: 0.3187667
	speed: 0.0086s/iter; left time: 2.5381s
Updating learning rate to 7.32768486875e-06
Epoch: 6 cost time: 0.7041661739349365
Epoch: 6, Steps: 131 | Train Loss: 0.3187667 Vali Loss: 0.2936850 Best vali loss: 0.2719797
	iters: 100, epoch: 7 | loss: 0.3145705
	speed: 0.0087s/iter; left time: 1.4131s
Updating learning rate to 3.663842434375e-06
Epoch: 7 cost time: 0.6993839740753174
Epoch: 7, Steps: 131 | Train Loss: 0.3145705 Vali Loss: 0.3008138 Best vali loss: 0.2719797
	iters: 100, epoch: 8 | loss: 0.3969366
	speed: 0.0088s/iter; left time: 0.2814s
Updating learning rate to 1.8319212171875e-06
Epoch: 8 cost time: 0.7066831588745117
Epoch: 8, Steps: 131 | Train Loss: 0.3969366 Vali Loss: 0.3011041 Best vali loss: 0.2719797

best validation loss 0.2719796956937612

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009540547186, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596267
	speed: 0.0110s/iter; left time: 10.4087s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9407060146331787
Epoch: 1, Steps: 131 | Train Loss: 0.5596267 Vali Loss: 0.2756711 Best vali loss: 0.2756711
	iters: 100, epoch: 2 | loss: 0.3247713
	speed: 0.0090s/iter; left time: 7.3257s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2704).  Saving model state dict ...
Epoch: 2 cost time: 0.7074649333953857
Epoch: 2, Steps: 131 | Train Loss: 0.3247713 Vali Loss: 0.2704038 Best vali loss: 0.2704038
	iters: 100, epoch: 3 | loss: 0.4607882
	speed: 0.0091s/iter; left time: 6.2485s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7042453289031982
Epoch: 3, Steps: 131 | Train Loss: 0.4607882 Vali Loss: 0.2831017 Best vali loss: 0.2704038
	iters: 100, epoch: 4 | loss: 0.5051574
	speed: 0.0086s/iter; left time: 4.7863s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6972792148590088
Epoch: 4, Steps: 131 | Train Loss: 0.5051574 Vali Loss: 0.2914878 Best vali loss: 0.2704038
	iters: 100, epoch: 5 | loss: 0.3373873
	speed: 0.0087s/iter; left time: 3.7032s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6985018253326416
Epoch: 5, Steps: 131 | Train Loss: 0.3373873 Vali Loss: 0.2897828 Best vali loss: 0.2704038
	iters: 100, epoch: 6 | loss: 0.3186285
	speed: 0.0086s/iter; left time: 2.5218s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6959335803985596
Epoch: 6, Steps: 131 | Train Loss: 0.3186285 Vali Loss: 0.2926156 Best vali loss: 0.2704038
	iters: 100, epoch: 7 | loss: 0.3130107
	speed: 0.0086s/iter; left time: 1.4070s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7006428241729736
Epoch: 7, Steps: 131 | Train Loss: 0.3130107 Vali Loss: 0.2992861 Best vali loss: 0.2704038
	iters: 100, epoch: 8 | loss: 0.3994291
	speed: 0.0087s/iter; left time: 0.2777s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7029273509979248
Epoch: 8, Steps: 131 | Train Loss: 0.3994291 Vali Loss: 0.2989787 Best vali loss: 0.2704038

best validation loss 0.27040377076384126

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010101064789, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596619
	speed: 0.0103s/iter; left time: 9.8139s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9223339557647705
Epoch: 1, Steps: 131 | Train Loss: 0.5596619 Vali Loss: 0.2756479 Best vali loss: 0.2756479
	iters: 100, epoch: 2 | loss: 0.3245781
	speed: 0.0090s/iter; left time: 7.3506s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2731).  Saving model state dict ...
Epoch: 2 cost time: 0.7033283710479736
Epoch: 2, Steps: 131 | Train Loss: 0.3245781 Vali Loss: 0.2730701 Best vali loss: 0.2730701
	iters: 100, epoch: 3 | loss: 0.4627759
	speed: 0.0090s/iter; left time: 6.1577s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7060112953186035
Epoch: 3, Steps: 131 | Train Loss: 0.4627759 Vali Loss: 0.2761668 Best vali loss: 0.2730701

best validation loss 0.27307005192808786

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0088503262635, 'e_layers': 2, 'learning_rate': 0.0001892647485, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3483322
	speed: 0.0090s/iter; left time: 18.0547s
	iters: 200, epoch: 1 | loss: 0.6860993
	speed: 0.0037s/iter; left time: 7.0563s
Updating learning rate to 0.0001892647485
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 1.2352104187011719
Epoch: 1, Steps: 262 | Train Loss: 0.5172158 Vali Loss: 0.2829368 Best vali loss: 0.2829368
	iters: 100, epoch: 2 | loss: 0.2402024
	speed: 0.0085s/iter; left time: 14.7972s
	iters: 200, epoch: 2 | loss: 0.7078001
	speed: 0.0036s/iter; left time: 5.8849s
Updating learning rate to 9.463237425e-05
Validation loss decreased (0.2829 --> 0.2739).  Saving model state dict ...
Epoch: 2 cost time: 0.9928510189056396
Epoch: 2, Steps: 262 | Train Loss: 0.4740013 Vali Loss: 0.2739494 Best vali loss: 0.2739494
	iters: 100, epoch: 3 | loss: 0.4871792
	speed: 0.0086s/iter; left time: 12.7286s
	iters: 200, epoch: 3 | loss: 0.2776473
	speed: 0.0036s/iter; left time: 4.9132s
Updating learning rate to 4.7316187125e-05
Epoch: 3 cost time: 0.9832448959350586
Epoch: 3, Steps: 262 | Train Loss: 0.3824133 Vali Loss: 0.2853949 Best vali loss: 0.2739494

best validation loss 0.2739493640083591

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0033382313402, 'e_layers': 2, 'learning_rate': 0.0005152817631, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004956700187522098
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 0.5634644031524658
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2852318 Best vali loss: 0.2852318
Updating learning rate to 0.00043982049600488506
Validation loss decreased (0.2852 --> 0.2845).  Saving model state dict ...
Epoch: 2 cost time: 0.32109928131103516
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2845338 Best vali loss: 0.2845338
Updating learning rate to 0.0003562357784191215
Validation loss decreased (0.2845 --> 0.2838).  Saving model state dict ...
Epoch: 3 cost time: 0.31240129470825195
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2837538 Best vali loss: 0.2837538

best validation loss 0.2837537673269785

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010101064789, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4161418
	speed: 0.0113s/iter; left time: 6.2681s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.9290986061096191
Epoch: 4, Steps: 131 | Train Loss: 0.4161418 Vali Loss: 0.2834662 Best vali loss: 0.2730701
	iters: 100, epoch: 5 | loss: 0.2692590
	speed: 0.0087s/iter; left time: 3.6858s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.6968028545379639
Epoch: 5, Steps: 131 | Train Loss: 0.2692590 Vali Loss: 0.2863816 Best vali loss: 0.2730701
	iters: 100, epoch: 6 | loss: 0.3861161
	speed: 0.0085s/iter; left time: 2.5085s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.6942682266235352
Epoch: 6, Steps: 131 | Train Loss: 0.3861161 Vali Loss: 0.2956788 Best vali loss: 0.2730701
	iters: 100, epoch: 7 | loss: 0.3963846
	speed: 0.0086s/iter; left time: 1.4084s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.6973297595977783
Epoch: 7, Steps: 131 | Train Loss: 0.3963846 Vali Loss: 0.3036769 Best vali loss: 0.2730701
	iters: 100, epoch: 8 | loss: 0.3006242
	speed: 0.0087s/iter; left time: 0.2769s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7002336978912354
Epoch: 8, Steps: 131 | Train Loss: 0.3006242 Vali Loss: 0.3023346 Best vali loss: 0.2730701

best validation loss 0.27307005192808786

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0041766919882, 'e_layers': 4, 'learning_rate': 0.0012422400629, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2402340
	speed: 0.0102s/iter; left time: 84.3909s
	iters: 200, epoch: 1 | loss: 1.2274401
	speed: 0.0051s/iter; left time: 41.5080s
	iters: 300, epoch: 1 | loss: 1.1855011
	speed: 0.0051s/iter; left time: 40.9677s
	iters: 400, epoch: 1 | loss: 0.3677918
	speed: 0.0051s/iter; left time: 40.6219s
	iters: 500, epoch: 1 | loss: 0.3792925
	speed: 0.0051s/iter; left time: 39.8553s
	iters: 600, epoch: 1 | loss: 0.6094579
	speed: 0.0051s/iter; left time: 39.3477s
	iters: 700, epoch: 1 | loss: 0.9377992
	speed: 0.0052s/iter; left time: 39.5082s
	iters: 800, epoch: 1 | loss: 0.3649383
	speed: 0.0051s/iter; left time: 38.7146s
	iters: 900, epoch: 1 | loss: 0.3590570
	speed: 0.0051s/iter; left time: 38.2737s
	iters: 1000, epoch: 1 | loss: 1.2883599
	speed: 0.0051s/iter; left time: 37.6403s
Updating learning rate to 0.0012422400629
Validation loss decreased (inf --> 0.2983).  Saving model state dict ...
Epoch: 1 cost time: 5.5816967487335205
Epoch: 1, Steps: 1045 | Train Loss: 0.6959872 Vali Loss: 0.2983323 Best vali loss: 0.2983323
	iters: 100, epoch: 2 | loss: 0.2242987
	speed: 0.0140s/iter; left time: 101.0650s
	iters: 200, epoch: 2 | loss: 0.4367217
	speed: 0.0050s/iter; left time: 35.8119s
	iters: 300, epoch: 2 | loss: 0.2401443
	speed: 0.0050s/iter; left time: 35.0416s
	iters: 400, epoch: 2 | loss: 0.5729172
	speed: 0.0050s/iter; left time: 34.6187s
	iters: 500, epoch: 2 | loss: 0.3669669
	speed: 0.0050s/iter; left time: 34.2781s
	iters: 600, epoch: 2 | loss: 0.6560550
	speed: 0.0050s/iter; left time: 33.9074s
	iters: 700, epoch: 2 | loss: 1.5440959
	speed: 0.0051s/iter; left time: 33.8633s
	iters: 800, epoch: 2 | loss: 0.3608920
	speed: 0.0052s/iter; left time: 33.9849s
	iters: 900, epoch: 2 | loss: 0.5049922
	speed: 0.0051s/iter; left time: 32.8864s
	iters: 1000, epoch: 2 | loss: 0.2897694
	speed: 0.0051s/iter; left time: 32.3401s
Updating learning rate to 0.00062112003145
Epoch: 2 cost time: 5.337935209274292
Epoch: 2, Steps: 1045 | Train Loss: 0.5196853 Vali Loss: 0.3255913 Best vali loss: 0.2983323
	iters: 100, epoch: 3 | loss: 0.3740990
	speed: 0.0139s/iter; left time: 85.9809s
	iters: 200, epoch: 3 | loss: 0.4089912
	speed: 0.0052s/iter; left time: 31.3882s
	iters: 300, epoch: 3 | loss: 1.0126845
	speed: 0.0052s/iter; left time: 30.9334s
	iters: 400, epoch: 3 | loss: 0.4737279
	speed: 0.0051s/iter; left time: 30.1902s
	iters: 500, epoch: 3 | loss: 0.3744567
	speed: 0.0051s/iter; left time: 29.6329s
	iters: 600, epoch: 3 | loss: 0.8168782
	speed: 0.0051s/iter; left time: 28.9092s
	iters: 700, epoch: 3 | loss: 0.2707962
	speed: 0.0050s/iter; left time: 27.8886s
	iters: 800, epoch: 3 | loss: 1.6014886
	speed: 0.0051s/iter; left time: 27.7878s
	iters: 900, epoch: 3 | loss: 0.3128971
	speed: 0.0050s/iter; left time: 27.0361s
	iters: 1000, epoch: 3 | loss: 0.6729963
	speed: 0.0051s/iter; left time: 26.6278s
Updating learning rate to 0.000310560015725
Epoch: 3 cost time: 5.365305185317993
Epoch: 3, Steps: 1045 | Train Loss: 0.6319016 Vali Loss: 0.3243073 Best vali loss: 0.2983323
	iters: 100, epoch: 4 | loss: 0.7763100
	speed: 0.0137s/iter; left time: 70.3528s
	iters: 200, epoch: 4 | loss: 0.2370007
	speed: 0.0050s/iter; left time: 25.3005s
	iters: 300, epoch: 4 | loss: 1.3799341
	speed: 0.0050s/iter; left time: 24.8129s
	iters: 400, epoch: 4 | loss: 1.0794268
	speed: 0.0051s/iter; left time: 24.7593s
	iters: 500, epoch: 4 | loss: 0.1731572
	speed: 0.0051s/iter; left time: 24.2584s
	iters: 600, epoch: 4 | loss: 1.4086931
	speed: 0.0051s/iter; left time: 23.7961s
	iters: 700, epoch: 4 | loss: 0.5321562
	speed: 0.0051s/iter; left time: 23.0441s
	iters: 800, epoch: 4 | loss: 0.5339226
	speed: 0.0051s/iter; left time: 22.6598s
	iters: 900, epoch: 4 | loss: 0.5370550
	speed: 0.0052s/iter; left time: 22.2884s
	iters: 1000, epoch: 4 | loss: 0.1420481
	speed: 0.0052s/iter; left time: 21.8472s
Updating learning rate to 0.0001552800078625
Epoch: 4 cost time: 5.3700950145721436
Epoch: 4, Steps: 1045 | Train Loss: 0.6799704 Vali Loss: 0.3223454 Best vali loss: 0.2983323
	iters: 100, epoch: 5 | loss: 0.9394142
	speed: 0.0139s/iter; left time: 56.8064s
	iters: 200, epoch: 5 | loss: 0.5823652
	speed: 0.0051s/iter; left time: 20.2822s
	iters: 300, epoch: 5 | loss: 0.3142895
	speed: 0.0050s/iter; left time: 19.5574s
	iters: 400, epoch: 5 | loss: 0.5936848
	speed: 0.0051s/iter; left time: 19.3220s
	iters: 500, epoch: 5 | loss: 0.2381209
	speed: 0.0052s/iter; left time: 18.9697s
	iters: 600, epoch: 5 | loss: 0.3215540
	speed: 0.0051s/iter; left time: 18.4155s
	iters: 700, epoch: 5 | loss: 0.7317590
	speed: 0.0051s/iter; left time: 17.7625s
	iters: 800, epoch: 5 | loss: 0.6521714
	speed: 0.0051s/iter; left time: 17.3121s
	iters: 900, epoch: 5 | loss: 0.2996607
	speed: 0.0051s/iter; left time: 16.7660s
	iters: 1000, epoch: 5 | loss: 0.3637443
	speed: 0.0051s/iter; left time: 16.3065s
Updating learning rate to 7.764000393125e-05
Epoch: 5 cost time: 5.3744823932647705
Epoch: 5, Steps: 1045 | Train Loss: 0.5036764 Vali Loss: 0.3220057 Best vali loss: 0.2983323
	iters: 100, epoch: 6 | loss: 0.4514439
	speed: 0.0138s/iter; left time: 42.0220s
	iters: 200, epoch: 6 | loss: 1.2889581
	speed: 0.0051s/iter; left time: 14.8270s
	iters: 300, epoch: 6 | loss: 1.5131760
	speed: 0.0051s/iter; left time: 14.3745s
	iters: 400, epoch: 6 | loss: 0.5118284
	speed: 0.0051s/iter; left time: 13.9136s
	iters: 500, epoch: 6 | loss: 0.3897617
	speed: 0.0051s/iter; left time: 13.4286s
	iters: 600, epoch: 6 | loss: 0.9128115
	speed: 0.0048s/iter; left time: 12.1398s
	iters: 700, epoch: 6 | loss: 0.2462391
	speed: 0.0048s/iter; left time: 11.6721s
	iters: 800, epoch: 6 | loss: 0.2849905
	speed: 0.0048s/iter; left time: 11.2665s
	iters: 900, epoch: 6 | loss: 0.4170935
	speed: 0.0048s/iter; left time: 10.6513s
	iters: 1000, epoch: 6 | loss: 1.2489513
	speed: 0.0048s/iter; left time: 10.2202s
Updating learning rate to 3.8820001965625e-05
Epoch: 6 cost time: 5.179367542266846
Epoch: 6, Steps: 1045 | Train Loss: 0.7265254 Vali Loss: 0.3209168 Best vali loss: 0.2983323
	iters: 100, epoch: 7 | loss: 0.5675955
	speed: 0.0139s/iter; left time: 27.6210s
	iters: 200, epoch: 7 | loss: 0.7910653
	speed: 0.0050s/iter; left time: 9.3629s
	iters: 300, epoch: 7 | loss: 0.6630933
	speed: 0.0048s/iter; left time: 8.5370s
	iters: 400, epoch: 7 | loss: 0.3380711
	speed: 0.0047s/iter; left time: 8.0181s
	iters: 500, epoch: 7 | loss: 0.3511595
	speed: 0.0048s/iter; left time: 7.5627s
	iters: 600, epoch: 7 | loss: 0.3382432
	speed: 0.0048s/iter; left time: 7.1396s
	iters: 700, epoch: 7 | loss: 0.3427510
	speed: 0.0047s/iter; left time: 6.5647s
	iters: 800, epoch: 7 | loss: 0.2791103
	speed: 0.0048s/iter; left time: 6.1439s
	iters: 900, epoch: 7 | loss: 0.2685293
	speed: 0.0048s/iter; left time: 5.6758s
	iters: 1000, epoch: 7 | loss: 0.5703721
	speed: 0.0048s/iter; left time: 5.1938s
Updating learning rate to 1.94100009828125e-05
Epoch: 7 cost time: 5.050132989883423
Epoch: 7, Steps: 1045 | Train Loss: 0.4509991 Vali Loss: 0.3166702 Best vali loss: 0.2983323
	iters: 100, epoch: 8 | loss: 0.2711370
	speed: 0.0135s/iter; left time: 12.7324s
	iters: 200, epoch: 8 | loss: 1.1801587
	speed: 0.0046s/iter; left time: 3.9246s
	iters: 300, epoch: 8 | loss: 1.1393929
	speed: 0.0047s/iter; left time: 3.4924s
	iters: 400, epoch: 8 | loss: 0.7462602
	speed: 0.0047s/iter; left time: 3.0142s
	iters: 500, epoch: 8 | loss: 1.5131263
	speed: 0.0047s/iter; left time: 2.5619s
	iters: 600, epoch: 8 | loss: 1.1746885
	speed: 0.0047s/iter; left time: 2.0894s
	iters: 700, epoch: 8 | loss: 0.4898385
	speed: 0.0047s/iter; left time: 1.6425s
	iters: 800, epoch: 8 | loss: 1.1474448
	speed: 0.0047s/iter; left time: 1.1629s
	iters: 900, epoch: 8 | loss: 0.4724469
	speed: 0.0047s/iter; left time: 0.6926s
	iters: 1000, epoch: 8 | loss: 0.2159070
	speed: 0.0047s/iter; left time: 0.2173s
Updating learning rate to 9.70500049140625e-06
Epoch: 8 cost time: 4.945196151733398
Epoch: 8, Steps: 1045 | Train Loss: 0.8350401 Vali Loss: 0.3048951 Best vali loss: 0.2983323

best validation loss 0.2983322832033775

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.003746349411, 'e_layers': 4, 'learning_rate': 0.0023846806153, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4682503
	speed: 0.0104s/iter; left time: 85.9546s
	iters: 200, epoch: 1 | loss: 0.9799919
	speed: 0.0051s/iter; left time: 41.9415s
	iters: 300, epoch: 1 | loss: 0.2583656
	speed: 0.0051s/iter; left time: 41.1824s
	iters: 400, epoch: 1 | loss: 0.4164098
	speed: 0.0051s/iter; left time: 40.6657s
	iters: 500, epoch: 1 | loss: 0.3984331
	speed: 0.0052s/iter; left time: 40.8209s
	iters: 600, epoch: 1 | loss: 0.5746520
	speed: 0.0051s/iter; left time: 39.4281s
	iters: 700, epoch: 1 | loss: 0.4838186
	speed: 0.0050s/iter; left time: 38.4533s
	iters: 800, epoch: 1 | loss: 0.7336850
	speed: 0.0051s/iter; left time: 38.2452s
	iters: 900, epoch: 1 | loss: 0.5243836
	speed: 0.0051s/iter; left time: 37.8167s
	iters: 1000, epoch: 1 | loss: 0.2567163
	speed: 0.0051s/iter; left time: 37.2013s
Updating learning rate to 0.0023846806153
Validation loss decreased (inf --> 0.3250).  Saving model state dict ...
Epoch: 1 cost time: 5.59059476852417
Epoch: 1, Steps: 1045 | Train Loss: 0.5094706 Vali Loss: 0.3249778 Best vali loss: 0.3249778
	iters: 100, epoch: 2 | loss: 0.6058714
	speed: 0.0139s/iter; left time: 99.9709s
	iters: 200, epoch: 2 | loss: 0.7318095
	speed: 0.0048s/iter; left time: 34.1258s
	iters: 300, epoch: 2 | loss: 0.5657801
	speed: 0.0048s/iter; left time: 33.4565s
	iters: 400, epoch: 2 | loss: 0.5941494
	speed: 0.0048s/iter; left time: 33.0474s
	iters: 500, epoch: 2 | loss: 0.7752452
	speed: 0.0048s/iter; left time: 32.5984s
	iters: 600, epoch: 2 | loss: 0.3315414
	speed: 0.0047s/iter; left time: 31.8661s
	iters: 700, epoch: 2 | loss: 2.1000757
	speed: 0.0047s/iter; left time: 31.2836s
	iters: 800, epoch: 2 | loss: 0.2255586
	speed: 0.0048s/iter; left time: 31.0771s
	iters: 900, epoch: 2 | loss: 0.2518828
	speed: 0.0047s/iter; left time: 30.2951s
	iters: 1000, epoch: 2 | loss: 0.2998805
	speed: 0.0047s/iter; left time: 29.7543s
Updating learning rate to 0.00119234030765
Validation loss decreased (0.3250 --> 0.3207).  Saving model state dict ...
Epoch: 2 cost time: 5.006178140640259
Epoch: 2, Steps: 1045 | Train Loss: 0.6481795 Vali Loss: 0.3206891 Best vali loss: 0.3206891
	iters: 100, epoch: 3 | loss: 1.3591896
	speed: 0.0145s/iter; left time: 89.2796s
	iters: 200, epoch: 3 | loss: 0.2381992
	speed: 0.0051s/iter; left time: 30.6836s
	iters: 300, epoch: 3 | loss: 0.3965360
	speed: 0.0050s/iter; left time: 30.1186s
	iters: 400, epoch: 3 | loss: 0.6810002
	speed: 0.0050s/iter; left time: 29.2910s
	iters: 500, epoch: 3 | loss: 0.8842978
	speed: 0.0049s/iter; left time: 28.4081s
	iters: 600, epoch: 3 | loss: 0.5441712
	speed: 0.0048s/iter; left time: 27.4359s
	iters: 700, epoch: 3 | loss: 0.6837025
	speed: 0.0049s/iter; left time: 27.5348s
	iters: 800, epoch: 3 | loss: 0.2610968
	speed: 0.0050s/iter; left time: 27.4420s
	iters: 900, epoch: 3 | loss: 0.8669067
	speed: 0.0050s/iter; left time: 27.0681s
	iters: 1000, epoch: 3 | loss: 0.1668277
	speed: 0.0050s/iter; left time: 26.4754s
Updating learning rate to 0.000596170153825
Epoch: 3 cost time: 5.258983135223389
Epoch: 3, Steps: 1045 | Train Loss: 0.6081928 Vali Loss: 0.3223252 Best vali loss: 0.3206891
	iters: 100, epoch: 4 | loss: 0.3622531
	speed: 0.0140s/iter; left time: 71.8119s
	iters: 200, epoch: 4 | loss: 0.6582111
	speed: 0.0051s/iter; left time: 25.5039s
	iters: 300, epoch: 4 | loss: 2.5178623
	speed: 0.0050s/iter; left time: 24.7746s
	iters: 400, epoch: 4 | loss: 0.5639568
	speed: 0.0051s/iter; left time: 24.4101s
	iters: 500, epoch: 4 | loss: 0.4083863
	speed: 0.0050s/iter; left time: 23.8130s
	iters: 600, epoch: 4 | loss: 0.9418770
	speed: 0.0050s/iter; left time: 23.3308s
	iters: 700, epoch: 4 | loss: 0.3589403
	speed: 0.0051s/iter; left time: 23.1280s
	iters: 800, epoch: 4 | loss: 0.1778422
	speed: 0.0051s/iter; left time: 22.4737s
	iters: 900, epoch: 4 | loss: 0.3824595
	speed: 0.0051s/iter; left time: 22.2151s
	iters: 1000, epoch: 4 | loss: 0.5262995
	speed: 0.0051s/iter; left time: 21.3624s
Updating learning rate to 0.0002980850769125
Epoch: 4 cost time: 5.32837986946106
Epoch: 4, Steps: 1045 | Train Loss: 0.6898088 Vali Loss: 0.3218979 Best vali loss: 0.3206891
	iters: 100, epoch: 5 | loss: 1.5571198
	speed: 0.0138s/iter; left time: 56.3915s
	iters: 200, epoch: 5 | loss: 0.8090007
	speed: 0.0045s/iter; left time: 17.8335s
	iters: 300, epoch: 5 | loss: 0.4399464
	speed: 0.0045s/iter; left time: 17.5899s
	iters: 400, epoch: 5 | loss: 0.2884442
	speed: 0.0046s/iter; left time: 17.4321s
	iters: 500, epoch: 5 | loss: 0.9868280
	speed: 0.0046s/iter; left time: 16.8809s
	iters: 600, epoch: 5 | loss: 0.4755239
	speed: 0.0046s/iter; left time: 16.3868s
	iters: 700, epoch: 5 | loss: 0.2658478
	speed: 0.0047s/iter; left time: 16.2123s
	iters: 800, epoch: 5 | loss: 0.6635672
	speed: 0.0048s/iter; left time: 16.1086s
	iters: 900, epoch: 5 | loss: 0.2707494
	speed: 0.0047s/iter; left time: 15.5270s
	iters: 1000, epoch: 5 | loss: 0.6766646
	speed: 0.0047s/iter; left time: 15.0265s
Updating learning rate to 0.00014904253845625
Validation loss decreased (0.3207 --> 0.3192).  Saving model state dict ...
Epoch: 5 cost time: 4.8758156299591064
Epoch: 5, Steps: 1045 | Train Loss: 0.6433692 Vali Loss: 0.3192116 Best vali loss: 0.3192116
	iters: 100, epoch: 6 | loss: 0.2367095
	speed: 0.0142s/iter; left time: 42.9675s
	iters: 200, epoch: 6 | loss: 1.0535530
	speed: 0.0051s/iter; left time: 14.9145s
	iters: 300, epoch: 6 | loss: 0.4528381
	speed: 0.0051s/iter; left time: 14.5134s
	iters: 400, epoch: 6 | loss: 0.8878527
	speed: 0.0051s/iter; left time: 13.8519s
	iters: 500, epoch: 6 | loss: 0.6246204
	speed: 0.0049s/iter; left time: 12.9014s
	iters: 600, epoch: 6 | loss: 1.3144701
	speed: 0.0048s/iter; left time: 12.2743s
	iters: 700, epoch: 6 | loss: 0.3390587
	speed: 0.0048s/iter; left time: 11.7692s
	iters: 800, epoch: 6 | loss: 0.2319246
	speed: 0.0049s/iter; left time: 11.4004s
	iters: 900, epoch: 6 | loss: 0.4595659
	speed: 0.0049s/iter; left time: 10.8818s
	iters: 1000, epoch: 6 | loss: 0.6638144
	speed: 0.0046s/iter; left time: 9.9264s
Updating learning rate to 7.4521269228125e-05
Epoch: 6 cost time: 5.159552097320557
Epoch: 6, Steps: 1045 | Train Loss: 0.6264407 Vali Loss: 0.3220024 Best vali loss: 0.3192116
	iters: 100, epoch: 7 | loss: 1.0276523
	speed: 0.0132s/iter; left time: 26.2254s
	iters: 200, epoch: 7 | loss: 0.3583397
	speed: 0.0045s/iter; left time: 8.4836s
	iters: 300, epoch: 7 | loss: 0.2528757
	speed: 0.0044s/iter; left time: 7.9350s
	iters: 400, epoch: 7 | loss: 0.2753434
	speed: 0.0045s/iter; left time: 7.5879s
	iters: 500, epoch: 7 | loss: 0.2214130
	speed: 0.0045s/iter; left time: 7.1811s
	iters: 600, epoch: 7 | loss: 0.4020102
	speed: 0.0044s/iter; left time: 6.5893s
	iters: 700, epoch: 7 | loss: 0.2985000
	speed: 0.0045s/iter; left time: 6.2374s
	iters: 800, epoch: 7 | loss: 0.4201434
	speed: 0.0044s/iter; left time: 5.6659s
	iters: 900, epoch: 7 | loss: 0.6370863
	speed: 0.0044s/iter; left time: 5.2481s
	iters: 1000, epoch: 7 | loss: 0.3166316
	speed: 0.0044s/iter; left time: 4.8157s
Updating learning rate to 3.72606346140625e-05
Epoch: 7 cost time: 4.683365106582642
Epoch: 7, Steps: 1045 | Train Loss: 0.4209996 Vali Loss: 0.3221834 Best vali loss: 0.3192116
	iters: 100, epoch: 8 | loss: 0.2912669
	speed: 0.0139s/iter; left time: 13.1203s
	iters: 200, epoch: 8 | loss: 0.2782994
	speed: 0.0051s/iter; left time: 4.3498s
	iters: 300, epoch: 8 | loss: 0.8492864
	speed: 0.0052s/iter; left time: 3.8572s
	iters: 400, epoch: 8 | loss: 0.2689771
	speed: 0.0051s/iter; left time: 3.3078s
	iters: 500, epoch: 8 | loss: 0.3972538
	speed: 0.0051s/iter; left time: 2.7899s
	iters: 600, epoch: 8 | loss: 0.6981690
	speed: 0.0051s/iter; left time: 2.2786s
	iters: 700, epoch: 8 | loss: 0.2862508
	speed: 0.0051s/iter; left time: 1.7817s
	iters: 800, epoch: 8 | loss: 0.2995389
	speed: 0.0051s/iter; left time: 1.2567s
	iters: 900, epoch: 8 | loss: 0.6347599
	speed: 0.0051s/iter; left time: 0.7497s
	iters: 1000, epoch: 8 | loss: 0.2865055
	speed: 0.0051s/iter; left time: 0.2353s
Updating learning rate to 1.863031730703125e-05
Epoch: 8 cost time: 5.397395372390747
Epoch: 8, Steps: 1045 | Train Loss: 0.4290308 Vali Loss: 0.3221458 Best vali loss: 0.3192116

best validation loss 0.3192115502370339

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010264673558, 'e_layers': 3, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4559465
	speed: 0.0126s/iter; left time: 11.9993s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.227567434310913
Epoch: 1, Steps: 131 | Train Loss: 0.4559465 Vali Loss: 0.2912084 Best vali loss: 0.2912084
	iters: 100, epoch: 2 | loss: 0.4809361
	speed: 0.0123s/iter; left time: 10.0430s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2912 --> 0.2746).  Saving model state dict ...
Epoch: 2 cost time: 0.9966301918029785
Epoch: 2, Steps: 131 | Train Loss: 0.4809361 Vali Loss: 0.2746022 Best vali loss: 0.2746022
	iters: 100, epoch: 3 | loss: 0.4307700
	speed: 0.0136s/iter; left time: 9.3177s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.9947102069854736
Epoch: 3, Steps: 131 | Train Loss: 0.4307700 Vali Loss: 0.2915386 Best vali loss: 0.2746022

best validation loss 0.27460220335872254

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0016932895097, 'e_layers': 4, 'learning_rate': 0.001181576171, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001181576171
Validation loss decreased (inf --> 0.2894).  Saving model state dict ...
Epoch: 1 cost time: 0.6832702159881592
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2893528 Best vali loss: 0.2893528
Updating learning rate to 0.0005907880855
Validation loss decreased (0.2894 --> 0.2888).  Saving model state dict ...
Epoch: 2 cost time: 0.41913819313049316
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2888211 Best vali loss: 0.2888211
Updating learning rate to 0.00029539404275
Validation loss decreased (0.2888 --> 0.2774).  Saving model state dict ...
Epoch: 3 cost time: 0.42030763626098633
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2774376 Best vali loss: 0.2774376

best validation loss 0.2774375896497746

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0013514624821, 'e_layers': 4, 'learning_rate': 0.0011791927988, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0011791927988
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 0.6680648326873779
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2894846 Best vali loss: 0.2894846
Updating learning rate to 0.0005895963994
Epoch: 2 cost time: 0.42342185974121094
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2949969 Best vali loss: 0.2894846
Updating learning rate to 0.0002947981997
Validation loss decreased (0.2895 --> 0.2849).  Saving model state dict ...
Epoch: 3 cost time: 0.4135298728942871
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2848544 Best vali loss: 0.2848544

best validation loss 0.2848544082108728

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010264673558, 'e_layers': 3, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3677099
	speed: 0.0131s/iter; left time: 7.2909s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 1.2289698123931885
Epoch: 4, Steps: 131 | Train Loss: 0.3677099 Vali Loss: 0.2967800 Best vali loss: 0.2746022
	iters: 100, epoch: 5 | loss: 0.3326238
	speed: 0.0119s/iter; left time: 5.0737s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.9900350570678711
Epoch: 5, Steps: 131 | Train Loss: 0.3326238 Vali Loss: 0.2815779 Best vali loss: 0.2746022
	iters: 100, epoch: 6 | loss: 0.3091067
	speed: 0.0119s/iter; left time: 3.4855s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.9944500923156738
Epoch: 6, Steps: 131 | Train Loss: 0.3091067 Vali Loss: 0.3032152 Best vali loss: 0.2746022
	iters: 100, epoch: 7 | loss: 0.3213222
	speed: 0.0118s/iter; left time: 1.9286s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 1.000723123550415
Epoch: 7, Steps: 131 | Train Loss: 0.3213222 Vali Loss: 0.3025294 Best vali loss: 0.2746022
	iters: 100, epoch: 8 | loss: 0.3717500
	speed: 0.0120s/iter; left time: 0.3826s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9966630935668945
Epoch: 8, Steps: 131 | Train Loss: 0.3717500 Vali Loss: 0.3039959 Best vali loss: 0.2746022

best validation loss 0.27460220335872254

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0016171755826, 'e_layers': 4, 'learning_rate': 0.0011919753919, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011466085298667647
Validation loss decreased (inf --> 0.2888).  Saving model state dict ...
Epoch: 1 cost time: 0.6571874618530273
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2887966 Best vali loss: 0.2887966
Updating learning rate to 0.0010174146372599912
Validation loss decreased (0.2888 --> 0.2877).  Saving model state dict ...
Epoch: 2 cost time: 0.43149447441101074
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2877485 Best vali loss: 0.2877485
Updating learning rate to 0.0008240623130835076
Validation loss decreased (0.2877 --> 0.2778).  Saving model state dict ...
Epoch: 3 cost time: 0.4903419017791748
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2777714 Best vali loss: 0.2777714
Updating learning rate to 0.00059598769595
Epoch: 4 cost time: 0.43831539154052734
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2852310 Best vali loss: 0.2777714
Updating learning rate to 0.0003679130788164925
Epoch: 5 cost time: 0.4391939640045166
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2877482 Best vali loss: 0.2777714
Updating learning rate to 0.00017456075464000875
Epoch: 6 cost time: 0.43953919410705566
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2914290 Best vali loss: 0.2777714
Updating learning rate to 4.5366862033235096e-05
Epoch: 7 cost time: 0.4350011348724365
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2992777 Best vali loss: 0.2777714
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43877100944519043
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2993793 Best vali loss: 0.2777714

best validation loss 0.27777140289711305

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020945177881, 'e_layers': 2, 'learning_rate': 0.0005008543418, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5953940
	speed: 0.0105s/iter; left time: 9.9797s
Updating learning rate to 0.0004817917084792161
Validation loss decreased (inf --> 0.2714).  Saving model state dict ...
Epoch: 1 cost time: 0.9324429035186768
Epoch: 1, Steps: 131 | Train Loss: 0.5953940 Vali Loss: 0.2713720 Best vali loss: 0.2713720
	iters: 100, epoch: 2 | loss: 0.3248327
	speed: 0.0089s/iter; left time: 7.2407s
Updating learning rate to 0.00042750592163675244
Epoch: 2 cost time: 0.6986351013183594
Epoch: 2, Steps: 131 | Train Loss: 0.3248327 Vali Loss: 0.2861067 Best vali loss: 0.2713720
	iters: 100, epoch: 3 | loss: 0.4792128
	speed: 0.0086s/iter; left time: 5.8910s
Updating learning rate to 0.00034626150021749096
Epoch: 3 cost time: 0.696021556854248
Epoch: 3, Steps: 131 | Train Loss: 0.4792128 Vali Loss: 0.3104594 Best vali loss: 0.2713720
	iters: 100, epoch: 4 | loss: 0.4495423
	speed: 0.0085s/iter; left time: 4.7527s
Updating learning rate to 0.0002504271709
Epoch: 4 cost time: 0.6884067058563232
Epoch: 4, Steps: 131 | Train Loss: 0.4495423 Vali Loss: 0.2852284 Best vali loss: 0.2713720
	iters: 100, epoch: 5 | loss: 0.3116367
	speed: 0.0085s/iter; left time: 3.6007s
Updating learning rate to 0.00015459284158250908
Epoch: 5 cost time: 0.6919691562652588
Epoch: 5, Steps: 131 | Train Loss: 0.3116367 Vali Loss: 0.2819333 Best vali loss: 0.2713720
	iters: 100, epoch: 6 | loss: 0.2774793
	speed: 0.0088s/iter; left time: 2.5764s
Updating learning rate to 7.334842016324757e-05
Epoch: 6 cost time: 0.7105276584625244
Epoch: 6, Steps: 131 | Train Loss: 0.2774793 Vali Loss: 0.2895615 Best vali loss: 0.2713720
	iters: 100, epoch: 7 | loss: 0.2537074
	speed: 0.0088s/iter; left time: 1.4264s
Updating learning rate to 1.906263332078389e-05
Epoch: 7 cost time: 0.7040834426879883
Epoch: 7, Steps: 131 | Train Loss: 0.2537074 Vali Loss: 0.2954623 Best vali loss: 0.2713720
	iters: 100, epoch: 8 | loss: 0.2917076
	speed: 0.0087s/iter; left time: 0.2789s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6994047164916992
Epoch: 8, Steps: 131 | Train Loss: 0.2917076 Vali Loss: 0.2949258 Best vali loss: 0.2713720

best validation loss 0.27137197623380543

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0112905283628, 'e_layers': 2, 'learning_rate': 0.000808304729, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4729682
	speed: 0.0085s/iter; left time: 34.5778s
	iters: 200, epoch: 1 | loss: 0.2957809
	speed: 0.0032s/iter; left time: 12.6872s
	iters: 300, epoch: 1 | loss: 0.4465237
	speed: 0.0032s/iter; left time: 12.3917s
	iters: 400, epoch: 1 | loss: 0.7403992
	speed: 0.0032s/iter; left time: 12.1369s
	iters: 500, epoch: 1 | loss: 0.7194305
	speed: 0.0032s/iter; left time: 11.7464s
Updating learning rate to 0.0007775404620775912
Validation loss decreased (inf --> 0.2912).  Saving model state dict ...
Epoch: 1 cost time: 1.9372081756591797
Epoch: 1, Steps: 523 | Train Loss: 0.5350205 Vali Loss: 0.2912231 Best vali loss: 0.2912231
	iters: 100, epoch: 2 | loss: 1.0316470
	speed: 0.0069s/iter; left time: 24.4165s
	iters: 200, epoch: 2 | loss: 0.8023084
	speed: 0.0029s/iter; left time: 9.8845s
	iters: 300, epoch: 2 | loss: 0.8421810
	speed: 0.0029s/iter; left time: 9.7191s
	iters: 400, epoch: 2 | loss: 0.3576384
	speed: 0.0029s/iter; left time: 9.3803s
	iters: 500, epoch: 2 | loss: 0.3628611
	speed: 0.0029s/iter; left time: 9.0680s
Updating learning rate to 0.0006899312420705273
Epoch: 2 cost time: 1.5448567867279053
Epoch: 2, Steps: 523 | Train Loss: 0.6793272 Vali Loss: 0.2958196 Best vali loss: 0.2912231
	iters: 100, epoch: 3 | loss: 0.6123359
	speed: 0.0068s/iter; left time: 20.5578s
	iters: 200, epoch: 3 | loss: 0.4331576
	speed: 0.0028s/iter; left time: 8.3226s
	iters: 300, epoch: 3 | loss: 0.5200648
	speed: 0.0028s/iter; left time: 8.0015s
	iters: 400, epoch: 3 | loss: 0.8428602
	speed: 0.0028s/iter; left time: 7.7362s
	iters: 500, epoch: 3 | loss: 1.3225284
	speed: 0.0029s/iter; left time: 7.5507s
Updating learning rate to 0.0005588147785453269
Epoch: 3 cost time: 1.5233850479125977
Epoch: 3, Steps: 523 | Train Loss: 0.7461894 Vali Loss: 0.2936884 Best vali loss: 0.2912231

best validation loss 0.2912231451762835

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023287927654, 'e_layers': 1, 'learning_rate': 0.0004678335276, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5247937
	speed: 0.0076s/iter; left time: 30.9141s
	iters: 200, epoch: 1 | loss: 0.2205113
	speed: 0.0024s/iter; left time: 9.4994s
	iters: 300, epoch: 1 | loss: 0.3534147
	speed: 0.0024s/iter; left time: 9.2646s
	iters: 400, epoch: 1 | loss: 0.7326813
	speed: 0.0024s/iter; left time: 9.0217s
	iters: 500, epoch: 1 | loss: 0.7436016
	speed: 0.0024s/iter; left time: 8.8737s
Updating learning rate to 0.0004678335276
Validation loss decreased (inf --> 0.2890).  Saving model state dict ...
Epoch: 1 cost time: 1.5120556354522705
Epoch: 1, Steps: 523 | Train Loss: 0.5150005 Vali Loss: 0.2889654 Best vali loss: 0.2889654
	iters: 100, epoch: 2 | loss: 0.2570342
	speed: 0.0059s/iter; left time: 21.0294s
	iters: 200, epoch: 2 | loss: 0.6330802
	speed: 0.0024s/iter; left time: 8.4012s
	iters: 300, epoch: 2 | loss: 0.4285742
	speed: 0.0024s/iter; left time: 8.1025s
	iters: 400, epoch: 2 | loss: 0.3262656
	speed: 0.0025s/iter; left time: 8.0383s
	iters: 500, epoch: 2 | loss: 0.4746075
	speed: 0.0025s/iter; left time: 7.8373s
Updating learning rate to 0.0002339167638
Validation loss decreased (0.2890 --> 0.2783).  Saving model state dict ...
Epoch: 2 cost time: 1.319032907485962
Epoch: 2, Steps: 523 | Train Loss: 0.4239123 Vali Loss: 0.2783454 Best vali loss: 0.2783454
	iters: 100, epoch: 3 | loss: 0.5743521
	speed: 0.0059s/iter; left time: 18.0785s
	iters: 200, epoch: 3 | loss: 1.0364053
	speed: 0.0025s/iter; left time: 7.2656s
	iters: 300, epoch: 3 | loss: 0.3014321
	speed: 0.0025s/iter; left time: 7.0519s
	iters: 400, epoch: 3 | loss: 0.3018838
	speed: 0.0025s/iter; left time: 6.9791s
	iters: 500, epoch: 3 | loss: 0.2957841
	speed: 0.0025s/iter; left time: 6.6760s
Updating learning rate to 0.0001169583819
Epoch: 3 cost time: 1.3354682922363281
Epoch: 3, Steps: 523 | Train Loss: 0.5019715 Vali Loss: 0.2927389 Best vali loss: 0.2783454

best validation loss 0.27834541181863665

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019033686091, 'e_layers': 2, 'learning_rate': 0.0006442669248, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6259161
	speed: 0.0105s/iter; left time: 9.9400s
Updating learning rate to 0.0006197459750483542
Validation loss decreased (inf --> 0.2873).  Saving model state dict ...
Epoch: 1 cost time: 0.9481828212738037
Epoch: 1, Steps: 131 | Train Loss: 0.6259161 Vali Loss: 0.2872593 Best vali loss: 0.2872593
	iters: 100, epoch: 2 | loss: 0.3371418
	speed: 0.0088s/iter; left time: 7.2102s
Updating learning rate to 0.0005499162181101417
Epoch: 2 cost time: 0.6947734355926514
Epoch: 2, Steps: 131 | Train Loss: 0.3371418 Vali Loss: 0.2955479 Best vali loss: 0.2872593
	iters: 100, epoch: 3 | loss: 0.4771678
	speed: 0.0086s/iter; left time: 5.9030s
Updating learning rate to 0.00044540860147088265
Validation loss decreased (0.2873 --> 0.2814).  Saving model state dict ...
Epoch: 3 cost time: 0.6915810108184814
Epoch: 3, Steps: 131 | Train Loss: 0.4771678 Vali Loss: 0.2814344 Best vali loss: 0.2814344

best validation loss 0.2814343995700409

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023287927654, 'e_layers': 1, 'learning_rate': 0.0004678335276, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4146775
	speed: 0.0078s/iter; left time: 19.5806s
	iters: 200, epoch: 4 | loss: 0.2003244
	speed: 0.0024s/iter; left time: 5.8721s
	iters: 300, epoch: 4 | loss: 0.2637336
	speed: 0.0025s/iter; left time: 5.6851s
	iters: 400, epoch: 4 | loss: 0.5192429
	speed: 0.0024s/iter; left time: 5.4009s
	iters: 500, epoch: 4 | loss: 0.5536141
	speed: 0.0025s/iter; left time: 5.1891s
Updating learning rate to 5.847919095e-05
Epoch: 4 cost time: 1.5450003147125244
Epoch: 4, Steps: 523 | Train Loss: 0.3903185 Vali Loss: 0.2921719 Best vali loss: 0.2783454
	iters: 100, epoch: 5 | loss: 0.2291244
	speed: 0.0057s/iter; left time: 11.4180s
	iters: 200, epoch: 5 | loss: 0.5921295
	speed: 0.0024s/iter; left time: 4.5750s
	iters: 300, epoch: 5 | loss: 0.2542124
	speed: 0.0024s/iter; left time: 4.2846s
	iters: 400, epoch: 5 | loss: 0.2907417
	speed: 0.0024s/iter; left time: 4.0471s
	iters: 500, epoch: 5 | loss: 0.3105188
	speed: 0.0024s/iter; left time: 3.8062s
Updating learning rate to 2.9239595475e-05
Epoch: 5 cost time: 1.2961184978485107
Epoch: 5, Steps: 523 | Train Loss: 0.3353454 Vali Loss: 0.2922830 Best vali loss: 0.2783454
	iters: 100, epoch: 6 | loss: 0.4774381
	speed: 0.0057s/iter; left time: 8.4166s
	iters: 200, epoch: 6 | loss: 0.7280207
	speed: 0.0023s/iter; left time: 3.2161s
	iters: 300, epoch: 6 | loss: 0.2866607
	speed: 0.0023s/iter; left time: 2.9375s
	iters: 400, epoch: 6 | loss: 0.2597958
	speed: 0.0023s/iter; left time: 2.6862s
	iters: 500, epoch: 6 | loss: 0.2739256
	speed: 0.0023s/iter; left time: 2.4761s
Updating learning rate to 1.46197977375e-05
Epoch: 6 cost time: 1.258589267730713
Epoch: 6, Steps: 523 | Train Loss: 0.4051682 Vali Loss: 0.2940651 Best vali loss: 0.2783454
	iters: 100, epoch: 7 | loss: 0.2011408
	speed: 0.0056s/iter; left time: 5.3033s
	iters: 200, epoch: 7 | loss: 0.3013836
	speed: 0.0022s/iter; left time: 1.8499s
	iters: 300, epoch: 7 | loss: 0.2424752
	speed: 0.0022s/iter; left time: 1.6430s
	iters: 400, epoch: 7 | loss: 0.3953364
	speed: 0.0022s/iter; left time: 1.4330s
	iters: 500, epoch: 7 | loss: 0.1879883
	speed: 0.0023s/iter; left time: 1.2689s
Updating learning rate to 7.30989886875e-06
Epoch: 7 cost time: 1.2022457122802734
Epoch: 7, Steps: 523 | Train Loss: 0.2656649 Vali Loss: 0.2924812 Best vali loss: 0.2783454
	iters: 100, epoch: 8 | loss: 0.3058862
	speed: 0.0056s/iter; left time: 2.3591s
	iters: 200, epoch: 8 | loss: 0.1785326
	speed: 0.0022s/iter; left time: 0.6999s
	iters: 300, epoch: 8 | loss: 0.4423078
	speed: 0.0022s/iter; left time: 0.4860s
	iters: 400, epoch: 8 | loss: 0.8171168
	speed: 0.0021s/iter; left time: 0.2665s
	iters: 500, epoch: 8 | loss: 0.3834065
	speed: 0.0022s/iter; left time: 0.0536s
Updating learning rate to 3.654949434375e-06
Epoch: 8 cost time: 1.1810731887817383
Epoch: 8, Steps: 523 | Train Loss: 0.4254500 Vali Loss: 0.2931058 Best vali loss: 0.2783454

best validation loss 0.27834541181863665

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0008984412354, 'e_layers': 2, 'learning_rate': 0.0005340207043, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2998530
	speed: 0.0087s/iter; left time: 35.5555s
	iters: 200, epoch: 1 | loss: 0.8960506
	speed: 0.0035s/iter; left time: 13.9127s
	iters: 300, epoch: 1 | loss: 0.3811898
	speed: 0.0035s/iter; left time: 13.4589s
	iters: 400, epoch: 1 | loss: 0.4116248
	speed: 0.0035s/iter; left time: 13.2473s
	iters: 500, epoch: 1 | loss: 0.4058972
	speed: 0.0035s/iter; left time: 12.8746s
Updating learning rate to 0.0005340207043
Validation loss decreased (inf --> 0.2923).  Saving model state dict ...
Epoch: 1 cost time: 2.0916354656219482
Epoch: 1, Steps: 523 | Train Loss: 0.4789231 Vali Loss: 0.2923085 Best vali loss: 0.2923085
	iters: 100, epoch: 2 | loss: 0.2895089
	speed: 0.0072s/iter; left time: 25.6291s
	iters: 200, epoch: 2 | loss: 0.3787370
	speed: 0.0031s/iter; left time: 10.6329s
	iters: 300, epoch: 2 | loss: 0.6656889
	speed: 0.0030s/iter; left time: 10.0974s
	iters: 400, epoch: 2 | loss: 0.4370650
	speed: 0.0030s/iter; left time: 9.7149s
	iters: 500, epoch: 2 | loss: 0.6393207
	speed: 0.0030s/iter; left time: 9.4817s
Updating learning rate to 0.00026701035215
Validation loss decreased (0.2923 --> 0.2853).  Saving model state dict ...
Epoch: 2 cost time: 1.6249518394470215
Epoch: 2, Steps: 523 | Train Loss: 0.4820641 Vali Loss: 0.2852876 Best vali loss: 0.2852876
	iters: 100, epoch: 3 | loss: 0.1997878
	speed: 0.0075s/iter; left time: 22.9257s
	iters: 200, epoch: 3 | loss: 0.6265827
	speed: 0.0035s/iter; left time: 10.1591s
	iters: 300, epoch: 3 | loss: 0.5478569
	speed: 0.0035s/iter; left time: 9.9954s
	iters: 400, epoch: 3 | loss: 0.2773029
	speed: 0.0036s/iter; left time: 9.8012s
	iters: 500, epoch: 3 | loss: 0.3093567
	speed: 0.0033s/iter; left time: 8.7076s
Updating learning rate to 0.000133505176075
Epoch: 3 cost time: 1.8529984951019287
Epoch: 3, Steps: 523 | Train Loss: 0.3921774 Vali Loss: 0.2914256 Best vali loss: 0.2852876
	iters: 100, epoch: 4 | loss: 0.1631112
	speed: 0.0075s/iter; left time: 18.7824s
	iters: 200, epoch: 4 | loss: 0.3522864
	speed: 0.0037s/iter; left time: 8.9367s
	iters: 300, epoch: 4 | loss: 0.2435893
	speed: 0.0037s/iter; left time: 8.6278s
	iters: 400, epoch: 4 | loss: 0.2856126
	speed: 0.0037s/iter; left time: 8.2548s
	iters: 500, epoch: 4 | loss: 0.3485192
	speed: 0.0036s/iter; left time: 7.7124s
Updating learning rate to 6.67525880375e-05
Epoch: 4 cost time: 1.9585306644439697
Epoch: 4, Steps: 523 | Train Loss: 0.2786237 Vali Loss: 0.2992690 Best vali loss: 0.2852876
	iters: 100, epoch: 5 | loss: 0.2658187
	speed: 0.0074s/iter; left time: 14.7950s
	iters: 200, epoch: 5 | loss: 0.2019051
	speed: 0.0035s/iter; left time: 6.6765s
	iters: 300, epoch: 5 | loss: 0.2011287
	speed: 0.0035s/iter; left time: 6.2739s
	iters: 400, epoch: 5 | loss: 0.3923254
	speed: 0.0032s/iter; left time: 5.5007s
	iters: 500, epoch: 5 | loss: 0.2675714
	speed: 0.0030s/iter; left time: 4.7444s
Updating learning rate to 3.337629401875e-05
Epoch: 5 cost time: 1.792496681213379
Epoch: 5, Steps: 523 | Train Loss: 0.2657499 Vali Loss: 0.3096642 Best vali loss: 0.2852876
	iters: 100, epoch: 6 | loss: 0.1694793
	speed: 0.0074s/iter; left time: 10.8805s
	iters: 200, epoch: 6 | loss: 0.3254836
	speed: 0.0034s/iter; left time: 4.6195s
	iters: 300, epoch: 6 | loss: 0.3625450
	speed: 0.0032s/iter; left time: 4.0883s
	iters: 400, epoch: 6 | loss: 0.4792298
	speed: 0.0032s/iter; left time: 3.7646s
	iters: 500, epoch: 6 | loss: 0.3760151
	speed: 0.0032s/iter; left time: 3.4398s
Updating learning rate to 1.6688147009375e-05
Epoch: 6 cost time: 1.7677264213562012
Epoch: 6, Steps: 523 | Train Loss: 0.3425506 Vali Loss: 0.3097769 Best vali loss: 0.2852876
	iters: 100, epoch: 7 | loss: 0.4056360
	speed: 0.0071s/iter; left time: 6.7193s
	iters: 200, epoch: 7 | loss: 0.4980017
	speed: 0.0032s/iter; left time: 2.6971s
	iters: 300, epoch: 7 | loss: 0.2018638
	speed: 0.0032s/iter; left time: 2.3757s
	iters: 400, epoch: 7 | loss: 0.2717507
	speed: 0.0032s/iter; left time: 2.0585s
	iters: 500, epoch: 7 | loss: 0.2605510
	speed: 0.0032s/iter; left time: 1.7416s
Updating learning rate to 8.3440735046875e-06
Epoch: 7 cost time: 1.7021052837371826
Epoch: 7, Steps: 523 | Train Loss: 0.3275606 Vali Loss: 0.3133805 Best vali loss: 0.2852876
	iters: 100, epoch: 8 | loss: 0.3239845
	speed: 0.0070s/iter; left time: 2.9533s
	iters: 200, epoch: 8 | loss: 0.2672848
	speed: 0.0030s/iter; left time: 0.9672s
	iters: 300, epoch: 8 | loss: 0.2831027
	speed: 0.0030s/iter; left time: 0.6643s
	iters: 400, epoch: 8 | loss: 0.2865061
	speed: 0.0030s/iter; left time: 0.3713s
	iters: 500, epoch: 8 | loss: 0.5018650
	speed: 0.0032s/iter; left time: 0.0767s
Updating learning rate to 4.17203675234375e-06
Epoch: 8 cost time: 1.6319668292999268
Epoch: 8, Steps: 523 | Train Loss: 0.3325486 Vali Loss: 0.3133946 Best vali loss: 0.2852876

best validation loss 0.2852875655271077

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009005358357, 'e_layers': 2, 'learning_rate': 0.0006237634214, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2727538
	speed: 0.0088s/iter; left time: 35.7656s
	iters: 200, epoch: 1 | loss: 0.4361167
	speed: 0.0035s/iter; left time: 13.9275s
	iters: 300, epoch: 1 | loss: 0.3959199
	speed: 0.0035s/iter; left time: 13.6017s
	iters: 400, epoch: 1 | loss: 1.1543852
	speed: 0.0036s/iter; left time: 13.5045s
	iters: 500, epoch: 1 | loss: 0.6316808
	speed: 0.0035s/iter; left time: 13.0627s
Updating learning rate to 0.0006000228397803364
Validation loss decreased (inf --> 0.2982).  Saving model state dict ...
Epoch: 1 cost time: 2.1110801696777344
Epoch: 1, Steps: 523 | Train Loss: 0.7781713 Vali Loss: 0.2982062 Best vali loss: 0.2982062
	iters: 100, epoch: 2 | loss: 0.5254877
	speed: 0.0078s/iter; left time: 27.8458s
	iters: 200, epoch: 2 | loss: 0.3809062
	speed: 0.0031s/iter; left time: 10.7617s
	iters: 300, epoch: 2 | loss: 0.2758333
	speed: 0.0031s/iter; left time: 10.4875s
	iters: 400, epoch: 2 | loss: 0.3631322
	speed: 0.0031s/iter; left time: 10.2481s
	iters: 500, epoch: 2 | loss: 0.6813853
	speed: 0.0031s/iter; left time: 9.8462s
Updating learning rate to 0.000532415383264031
Validation loss decreased (0.2982 --> 0.2911).  Saving model state dict ...
Epoch: 2 cost time: 1.676727056503296
Epoch: 2, Steps: 523 | Train Loss: 0.4453489 Vali Loss: 0.2911184 Best vali loss: 0.2911184
	iters: 100, epoch: 3 | loss: 0.2878257
	speed: 0.0077s/iter; left time: 23.4730s
	iters: 200, epoch: 3 | loss: 0.2671849
	speed: 0.0031s/iter; left time: 9.1141s
	iters: 300, epoch: 3 | loss: 0.3108024
	speed: 0.0031s/iter; left time: 8.8865s
	iters: 400, epoch: 3 | loss: 0.6131418
	speed: 0.0031s/iter; left time: 8.4761s
	iters: 500, epoch: 3 | loss: 1.2636774
	speed: 0.0031s/iter; left time: 8.1593s
Updating learning rate to 0.000431233674242572
Epoch: 3 cost time: 1.6785473823547363
Epoch: 3, Steps: 523 | Train Loss: 0.5485264 Vali Loss: 0.3000421 Best vali loss: 0.2911184
	iters: 100, epoch: 4 | loss: 0.6667327
	speed: 0.0076s/iter; left time: 19.1375s
	iters: 200, epoch: 4 | loss: 0.6186904
	speed: 0.0032s/iter; left time: 7.7332s
	iters: 300, epoch: 4 | loss: 0.6430187
	speed: 0.0032s/iter; left time: 7.4206s
	iters: 400, epoch: 4 | loss: 0.4420475
	speed: 0.0032s/iter; left time: 7.0647s
	iters: 500, epoch: 4 | loss: 0.5544246
	speed: 0.0032s/iter; left time: 6.7801s
Updating learning rate to 0.0003118817107
Epoch: 4 cost time: 1.7329223155975342
Epoch: 4, Steps: 523 | Train Loss: 0.5849828 Vali Loss: 0.2922989 Best vali loss: 0.2911184
	iters: 100, epoch: 5 | loss: 0.6887044
	speed: 0.0075s/iter; left time: 15.0457s
	iters: 200, epoch: 5 | loss: 0.4775070
	speed: 0.0034s/iter; left time: 6.3839s
	iters: 300, epoch: 5 | loss: 0.6171719
	speed: 0.0034s/iter; left time: 6.0747s
	iters: 400, epoch: 5 | loss: 0.5802257
	speed: 0.0033s/iter; left time: 5.5806s
	iters: 500, epoch: 5 | loss: 0.7728746
	speed: 0.0031s/iter; left time: 4.9250s
Updating learning rate to 0.00019252974715742806
Epoch: 5 cost time: 1.7581477165222168
Epoch: 5, Steps: 523 | Train Loss: 0.6272967 Vali Loss: 0.2926614 Best vali loss: 0.2911184
	iters: 100, epoch: 6 | loss: 0.4891615
	speed: 0.0075s/iter; left time: 10.9554s
	iters: 200, epoch: 6 | loss: 0.5664247
	speed: 0.0033s/iter; left time: 4.5628s
	iters: 300, epoch: 6 | loss: 0.2860852
	speed: 0.0033s/iter; left time: 4.2273s
	iters: 400, epoch: 6 | loss: 0.4064703
	speed: 0.0034s/iter; left time: 3.9264s
	iters: 500, epoch: 6 | loss: 0.2192732
	speed: 0.0033s/iter; left time: 3.5661s
Updating learning rate to 9.1348038135969e-05
Epoch: 6 cost time: 1.779036045074463
Epoch: 6, Steps: 523 | Train Loss: 0.3934830 Vali Loss: 0.3066009 Best vali loss: 0.2911184
	iters: 100, epoch: 7 | loss: 0.4398530
	speed: 0.0074s/iter; left time: 6.9938s
	iters: 200, epoch: 7 | loss: 0.5897357
	speed: 0.0031s/iter; left time: 2.6280s
	iters: 300, epoch: 7 | loss: 0.5710081
	speed: 0.0031s/iter; left time: 2.3278s
	iters: 400, epoch: 7 | loss: 0.3168951
	speed: 0.0031s/iter; left time: 2.0191s
	iters: 500, epoch: 7 | loss: 0.6200122
	speed: 0.0031s/iter; left time: 1.7026s
Updating learning rate to 2.3740581619663625e-05
Epoch: 7 cost time: 1.6744787693023682
Epoch: 7, Steps: 523 | Train Loss: 0.5075008 Vali Loss: 0.3093992 Best vali loss: 0.2911184
	iters: 100, epoch: 8 | loss: 0.9415175
	speed: 0.0072s/iter; left time: 3.0701s
	iters: 200, epoch: 8 | loss: 0.2072721
	speed: 0.0031s/iter; left time: 1.0108s
	iters: 300, epoch: 8 | loss: 0.2525981
	speed: 0.0031s/iter; left time: 0.6965s
	iters: 400, epoch: 8 | loss: 0.2599892
	speed: 0.0032s/iter; left time: 0.3939s
	iters: 500, epoch: 8 | loss: 0.6040348
	speed: 0.0033s/iter; left time: 0.0791s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.695519208908081
Epoch: 8, Steps: 523 | Train Loss: 0.4530823 Vali Loss: 0.3032565 Best vali loss: 0.2911184

best validation loss 0.29111835272970943

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0008986326126, 'e_layers': 4, 'learning_rate': 0.0005490690793, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3548659
	speed: 0.0109s/iter; left time: 44.5835s
	iters: 200, epoch: 1 | loss: 0.5282652
	speed: 0.0058s/iter; left time: 23.2671s
	iters: 300, epoch: 1 | loss: 0.4297257
	speed: 0.0058s/iter; left time: 22.7177s
	iters: 400, epoch: 1 | loss: 0.2291644
	speed: 0.0059s/iter; left time: 22.1663s
	iters: 500, epoch: 1 | loss: 0.2519854
	speed: 0.0058s/iter; left time: 21.4406s
Updating learning rate to 0.0005281713818000433
Validation loss decreased (inf --> 0.3299).  Saving model state dict ...
Epoch: 1 cost time: 3.3115947246551514
Epoch: 1, Steps: 523 | Train Loss: 0.3588013 Vali Loss: 0.3299432 Best vali loss: 0.3299432
	iters: 100, epoch: 2 | loss: 0.3616612
	speed: 0.0120s/iter; left time: 42.8991s
	iters: 200, epoch: 2 | loss: 0.2344655
	speed: 0.0056s/iter; left time: 19.3257s
	iters: 300, epoch: 2 | loss: 0.5631905
	speed: 0.0056s/iter; left time: 18.8512s
	iters: 400, epoch: 2 | loss: 0.3634570
	speed: 0.0056s/iter; left time: 18.4224s
	iters: 500, epoch: 2 | loss: 0.2957821
	speed: 0.0056s/iter; left time: 17.7881s
Updating learning rate to 0.00046865977430644206
Validation loss decreased (0.3299 --> 0.3222).  Saving model state dict ...
Epoch: 2 cost time: 2.9830076694488525
Epoch: 2, Steps: 523 | Train Loss: 0.3637113 Vali Loss: 0.3222205 Best vali loss: 0.3222205
	iters: 100, epoch: 3 | loss: 0.9719636
	speed: 0.0124s/iter; left time: 37.7941s
	iters: 200, epoch: 3 | loss: 0.6187288
	speed: 0.0058s/iter; left time: 16.9248s
	iters: 300, epoch: 3 | loss: 0.4077542
	speed: 0.0057s/iter; left time: 16.0922s
	iters: 400, epoch: 3 | loss: 1.0105439
	speed: 0.0057s/iter; left time: 15.5778s
	iters: 500, epoch: 3 | loss: 0.2099939
	speed: 0.0057s/iter; left time: 15.0686s
Updating learning rate to 0.0003795943595860318
Epoch: 3 cost time: 3.028672933578491
Epoch: 3, Steps: 523 | Train Loss: 0.6437969 Vali Loss: 0.3236687 Best vali loss: 0.3222205

best validation loss 0.32222047905888246

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009574650938, 'e_layers': 2, 'learning_rate': 0.000507391375, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2989057
	speed: 0.0087s/iter; left time: 35.4236s
	iters: 200, epoch: 1 | loss: 0.9227794
	speed: 0.0035s/iter; left time: 13.9548s
	iters: 300, epoch: 1 | loss: 0.3703090
	speed: 0.0035s/iter; left time: 13.5087s
	iters: 400, epoch: 1 | loss: 0.4013485
	speed: 0.0035s/iter; left time: 13.1446s
	iters: 500, epoch: 1 | loss: 0.3764791
	speed: 0.0035s/iter; left time: 12.7761s
Updating learning rate to 0.00048807994066762944
Validation loss decreased (inf --> 0.3254).  Saving model state dict ...
Epoch: 1 cost time: 2.0740346908569336
Epoch: 1, Steps: 523 | Train Loss: 0.4739643 Vali Loss: 0.3254073 Best vali loss: 0.3254073
	iters: 100, epoch: 2 | loss: 0.3115201
	speed: 0.0076s/iter; left time: 27.0861s
	iters: 200, epoch: 2 | loss: 0.3842859
	speed: 0.0035s/iter; left time: 12.0642s
	iters: 300, epoch: 2 | loss: 0.6286343
	speed: 0.0035s/iter; left time: 11.7213s
	iters: 400, epoch: 2 | loss: 0.3812222
	speed: 0.0035s/iter; left time: 11.3820s
	iters: 500, epoch: 2 | loss: 0.6925306
	speed: 0.0035s/iter; left time: 11.1220s
Updating learning rate to 0.0004330856284890332
Validation loss decreased (0.3254 --> 0.2910).  Saving model state dict ...
Epoch: 2 cost time: 1.876007080078125
Epoch: 2, Steps: 523 | Train Loss: 0.4796386 Vali Loss: 0.2910239 Best vali loss: 0.2910239
	iters: 100, epoch: 3 | loss: 0.1973615
	speed: 0.0076s/iter; left time: 22.9744s
	iters: 200, epoch: 3 | loss: 0.6683919
	speed: 0.0032s/iter; left time: 9.5102s
	iters: 300, epoch: 3 | loss: 0.5697492
	speed: 0.0032s/iter; left time: 9.1201s
	iters: 400, epoch: 3 | loss: 0.2613473
	speed: 0.0032s/iter; left time: 8.7694s
	iters: 500, epoch: 3 | loss: 0.2993273
	speed: 0.0032s/iter; left time: 8.4514s
Updating learning rate to 0.0003507808239687212
Validation loss decreased (0.2910 --> 0.2909).  Saving model state dict ...
Epoch: 3 cost time: 1.7217612266540527
Epoch: 3, Steps: 523 | Train Loss: 0.3992354 Vali Loss: 0.2908820 Best vali loss: 0.2908820

best validation loss 0.29088197503891433

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009609773953, 'e_layers': 2, 'learning_rate': 0.0006111319024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3035358
	speed: 0.0086s/iter; left time: 35.0625s
	iters: 200, epoch: 1 | loss: 0.8876500
	speed: 0.0034s/iter; left time: 13.5081s
	iters: 300, epoch: 1 | loss: 0.3824002
	speed: 0.0034s/iter; left time: 13.2579s
	iters: 400, epoch: 1 | loss: 0.3976751
	speed: 0.0034s/iter; left time: 12.8960s
	iters: 500, epoch: 1 | loss: 0.4027008
	speed: 0.0034s/iter; left time: 12.6037s
Updating learning rate to 0.0005878720793460226
Validation loss decreased (inf --> 0.3088).  Saving model state dict ...
Epoch: 1 cost time: 2.035403251647949
Epoch: 1, Steps: 523 | Train Loss: 0.4747924 Vali Loss: 0.3088438 Best vali loss: 0.3088438
	iters: 100, epoch: 2 | loss: 0.2983484
	speed: 0.0072s/iter; left time: 25.7523s
	iters: 200, epoch: 2 | loss: 0.3981184
	speed: 0.0032s/iter; left time: 11.1365s
	iters: 300, epoch: 2 | loss: 0.6748613
	speed: 0.0032s/iter; left time: 10.8988s
	iters: 400, epoch: 2 | loss: 0.4578544
	speed: 0.0032s/iter; left time: 10.5137s
	iters: 500, epoch: 2 | loss: 0.7235815
	speed: 0.0032s/iter; left time: 10.2601s
Updating learning rate to 0.0005216337073932376
Validation loss decreased (0.3088 --> 0.2878).  Saving model state dict ...
Epoch: 2 cost time: 1.7271685600280762
Epoch: 2, Steps: 523 | Train Loss: 0.5105528 Vali Loss: 0.2877792 Best vali loss: 0.2877792
	iters: 100, epoch: 3 | loss: 0.1949746
	speed: 0.0072s/iter; left time: 21.8849s
	iters: 200, epoch: 3 | loss: 0.6902428
	speed: 0.0030s/iter; left time: 8.8411s
	iters: 300, epoch: 3 | loss: 0.6106640
	speed: 0.0030s/iter; left time: 8.5747s
	iters: 400, epoch: 3 | loss: 0.2954497
	speed: 0.0030s/iter; left time: 8.2419s
	iters: 500, epoch: 3 | loss: 0.2877605
	speed: 0.0030s/iter; left time: 7.9213s
Updating learning rate to 0.00042250097821911956
Epoch: 3 cost time: 1.6157705783843994
Epoch: 3, Steps: 523 | Train Loss: 0.4158183 Vali Loss: 0.2982913 Best vali loss: 0.2877792

best validation loss 0.2877792192296762

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009609773953, 'e_layers': 2, 'learning_rate': 0.0006111319024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2939101
	speed: 0.0091s/iter; left time: 22.8479s
	iters: 200, epoch: 4 | loss: 0.5893416
	speed: 0.0035s/iter; left time: 8.4304s
	iters: 300, epoch: 4 | loss: 0.3456431
	speed: 0.0035s/iter; left time: 8.0178s
	iters: 400, epoch: 4 | loss: 0.3762079
	speed: 0.0035s/iter; left time: 7.6679s
	iters: 500, epoch: 4 | loss: 0.3454630
	speed: 0.0035s/iter; left time: 7.3247s
Updating learning rate to 0.0003055659512
Epoch: 4 cost time: 2.085306167602539
Epoch: 4, Steps: 523 | Train Loss: 0.3901132 Vali Loss: 0.3014172 Best vali loss: 0.2877792
	iters: 100, epoch: 5 | loss: 0.2768829
	speed: 0.0070s/iter; left time: 14.0428s
	iters: 200, epoch: 5 | loss: 0.3266446
	speed: 0.0030s/iter; left time: 5.6952s
	iters: 300, epoch: 5 | loss: 0.2902779
	speed: 0.0030s/iter; left time: 5.3888s
	iters: 400, epoch: 5 | loss: 0.3091321
	speed: 0.0031s/iter; left time: 5.3263s
	iters: 500, epoch: 5 | loss: 0.3929121
	speed: 0.0031s/iter; left time: 4.9267s
Updating learning rate to 0.0001886309241808805
Epoch: 5 cost time: 1.6424689292907715
Epoch: 5, Steps: 523 | Train Loss: 0.3191699 Vali Loss: 0.2995139 Best vali loss: 0.2877792
	iters: 100, epoch: 6 | loss: 0.1883535
	speed: 0.0068s/iter; left time: 10.0230s
	iters: 200, epoch: 6 | loss: 0.3980099
	speed: 0.0035s/iter; left time: 4.8139s
	iters: 300, epoch: 6 | loss: 0.3845253
	speed: 0.0035s/iter; left time: 4.5037s
	iters: 400, epoch: 6 | loss: 0.2221025
	speed: 0.0035s/iter; left time: 4.0655s
	iters: 500, epoch: 6 | loss: 0.2300338
	speed: 0.0035s/iter; left time: 3.7514s
Updating learning rate to 8.949819500676235e-05
Epoch: 6 cost time: 1.8207197189331055
Epoch: 6, Steps: 523 | Train Loss: 0.2846050 Vali Loss: 0.3178876 Best vali loss: 0.2877792
	iters: 100, epoch: 7 | loss: 0.1448679
	speed: 0.0071s/iter; left time: 6.7483s
	iters: 200, epoch: 7 | loss: 0.3042884
	speed: 0.0033s/iter; left time: 2.7692s
	iters: 300, epoch: 7 | loss: 0.2151673
	speed: 0.0033s/iter; left time: 2.4517s
	iters: 400, epoch: 7 | loss: 0.1937380
	speed: 0.0030s/iter; left time: 1.9444s
	iters: 500, epoch: 7 | loss: 0.3000189
	speed: 0.0032s/iter; left time: 1.7499s
Updating learning rate to 2.3259823053977344e-05
Epoch: 7 cost time: 1.7121729850769043
Epoch: 7, Steps: 523 | Train Loss: 0.2316161 Vali Loss: 0.3221971 Best vali loss: 0.2877792
	iters: 100, epoch: 8 | loss: 0.2244748
	speed: 0.0067s/iter; left time: 2.8545s
	iters: 200, epoch: 8 | loss: 0.1846898
	speed: 0.0030s/iter; left time: 0.9565s
	iters: 300, epoch: 8 | loss: 0.1616577
	speed: 0.0030s/iter; left time: 0.6635s
	iters: 400, epoch: 8 | loss: 0.3177011
	speed: 0.0030s/iter; left time: 0.3730s
	iters: 500, epoch: 8 | loss: 0.2247412
	speed: 0.0032s/iter; left time: 0.0765s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6189417839050293
Epoch: 8, Steps: 523 | Train Loss: 0.2226529 Vali Loss: 0.3294782 Best vali loss: 0.2877792

best validation loss 0.2877792192296762

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009435440162, 'e_layers': 2, 'learning_rate': 0.000592868999, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3028817
	speed: 0.0084s/iter; left time: 34.2923s
	iters: 200, epoch: 1 | loss: 0.8951922
	speed: 0.0032s/iter; left time: 12.8214s
	iters: 300, epoch: 1 | loss: 0.3681577
	speed: 0.0033s/iter; left time: 12.6576s
	iters: 400, epoch: 1 | loss: 0.4033443
	speed: 0.0033s/iter; left time: 12.3733s
	iters: 500, epoch: 1 | loss: 0.4127296
	speed: 0.0033s/iter; left time: 12.0543s
Updating learning rate to 0.0005703042663182772
Validation loss decreased (inf --> 0.3229).  Saving model state dict ...
Epoch: 1 cost time: 1.9659390449523926
Epoch: 1, Steps: 523 | Train Loss: 0.4764611 Vali Loss: 0.3229365 Best vali loss: 0.3229365
	iters: 100, epoch: 2 | loss: 0.2911341
	speed: 0.0070s/iter; left time: 25.0755s
	iters: 200, epoch: 2 | loss: 0.3784012
	speed: 0.0029s/iter; left time: 10.0064s
	iters: 300, epoch: 2 | loss: 0.6361156
	speed: 0.0029s/iter; left time: 9.7543s
	iters: 400, epoch: 2 | loss: 0.3978973
	speed: 0.0029s/iter; left time: 9.3583s
	iters: 500, epoch: 2 | loss: 0.7159351
	speed: 0.0029s/iter; left time: 9.0870s
Updating learning rate to 0.0005060453442740902
Validation loss decreased (0.3229 --> 0.2873).  Saving model state dict ...
Epoch: 2 cost time: 1.5545563697814941
Epoch: 2, Steps: 523 | Train Loss: 0.4838967 Vali Loss: 0.2873325 Best vali loss: 0.2873325
	iters: 100, epoch: 3 | loss: 0.1987790
	speed: 0.0073s/iter; left time: 22.1869s
	iters: 200, epoch: 3 | loss: 0.7373844
	speed: 0.0032s/iter; left time: 9.4641s
	iters: 300, epoch: 3 | loss: 0.6361737
	speed: 0.0032s/iter; left time: 9.1508s
	iters: 400, epoch: 3 | loss: 0.2707761
	speed: 0.0032s/iter; left time: 8.7679s
	iters: 500, epoch: 3 | loss: 0.3027066
	speed: 0.0031s/iter; left time: 8.2875s
Updating learning rate to 0.0004098750712400875
Epoch: 3 cost time: 1.710925579071045
Epoch: 3, Steps: 523 | Train Loss: 0.4291640 Vali Loss: 0.2975178 Best vali loss: 0.2873325
	iters: 100, epoch: 4 | loss: 0.1572314
	speed: 0.0071s/iter; left time: 17.9339s
	iters: 200, epoch: 4 | loss: 0.3893603
	speed: 0.0031s/iter; left time: 7.6087s
	iters: 300, epoch: 4 | loss: 0.2598988
	speed: 0.0031s/iter; left time: 7.2939s
	iters: 400, epoch: 4 | loss: 0.2863608
	speed: 0.0032s/iter; left time: 6.9938s
	iters: 500, epoch: 4 | loss: 0.4045856
	speed: 0.0032s/iter; left time: 6.6657s
Updating learning rate to 0.0002964344995
Epoch: 4 cost time: 1.6880016326904297
Epoch: 4, Steps: 523 | Train Loss: 0.2994874 Vali Loss: 0.2875975 Best vali loss: 0.2873325
	iters: 100, epoch: 5 | loss: 0.2534241
	speed: 0.0070s/iter; left time: 13.9034s
	iters: 200, epoch: 5 | loss: 0.2267684
	speed: 0.0032s/iter; left time: 5.9715s
	iters: 300, epoch: 5 | loss: 0.1954665
	speed: 0.0033s/iter; left time: 5.8603s
	iters: 400, epoch: 5 | loss: 0.3659262
	speed: 0.0035s/iter; left time: 5.9608s
	iters: 500, epoch: 5 | loss: 0.2698164
	speed: 0.0034s/iter; left time: 5.4724s
Updating learning rate to 0.00018299392775991252
Epoch: 5 cost time: 1.772477149963379
Epoch: 5, Steps: 523 | Train Loss: 0.2622803 Vali Loss: 0.3043979 Best vali loss: 0.2873325
	iters: 100, epoch: 6 | loss: 0.1585555
	speed: 0.0072s/iter; left time: 10.6489s
	iters: 200, epoch: 6 | loss: 0.3273493
	speed: 0.0031s/iter; left time: 4.3073s
	iters: 300, epoch: 6 | loss: 0.3239777
	speed: 0.0031s/iter; left time: 3.9976s
	iters: 400, epoch: 6 | loss: 0.4506263
	speed: 0.0032s/iter; left time: 3.6988s
	iters: 500, epoch: 6 | loss: 0.3679521
	speed: 0.0032s/iter; left time: 3.3749s
Updating learning rate to 8.682365472590979e-05
Epoch: 6 cost time: 1.7020626068115234
Epoch: 6, Steps: 523 | Train Loss: 0.3256922 Vali Loss: 0.3128748 Best vali loss: 0.2873325
	iters: 100, epoch: 7 | loss: 0.3073032
	speed: 0.0071s/iter; left time: 6.7619s
	iters: 200, epoch: 7 | loss: 0.4162647
	speed: 0.0034s/iter; left time: 2.8838s
	iters: 300, epoch: 7 | loss: 0.1721463
	speed: 0.0030s/iter; left time: 2.2231s
	iters: 400, epoch: 7 | loss: 0.2415569
	speed: 0.0030s/iter; left time: 1.9427s
	iters: 500, epoch: 7 | loss: 0.2178958
	speed: 0.0029s/iter; left time: 1.6063s
Updating learning rate to 2.2564732681722736e-05
Epoch: 7 cost time: 1.6679904460906982
Epoch: 7, Steps: 523 | Train Loss: 0.2710334 Vali Loss: 0.3348372 Best vali loss: 0.2873325
	iters: 100, epoch: 8 | loss: 0.2804713
	speed: 0.0069s/iter; left time: 2.9348s
	iters: 200, epoch: 8 | loss: 0.2382557
	speed: 0.0032s/iter; left time: 1.0212s
	iters: 300, epoch: 8 | loss: 0.2495638
	speed: 0.0033s/iter; left time: 0.7325s
	iters: 400, epoch: 8 | loss: 0.2311574
	speed: 0.0033s/iter; left time: 0.4105s
	iters: 500, epoch: 8 | loss: 0.4288585
	speed: 0.0033s/iter; left time: 0.0803s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7400052547454834
Epoch: 8, Steps: 523 | Train Loss: 0.2856613 Vali Loss: 0.3364947 Best vali loss: 0.2873325

best validation loss 0.28733253297796035

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0048526946253, 'e_layers': 2, 'learning_rate': 0.0004871974688, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3506233
	speed: 0.0089s/iter; left time: 36.3223s
	iters: 200, epoch: 1 | loss: 0.4257355
	speed: 0.0034s/iter; left time: 13.6710s
	iters: 300, epoch: 1 | loss: 0.3772414
	speed: 0.0034s/iter; left time: 13.3220s
	iters: 400, epoch: 1 | loss: 1.1314971
	speed: 0.0034s/iter; left time: 12.9081s
	iters: 500, epoch: 1 | loss: 0.6500582
	speed: 0.0034s/iter; left time: 12.7036s
Updating learning rate to 0.0004871974688
Validation loss decreased (inf --> 0.2896).  Saving model state dict ...
Epoch: 1 cost time: 2.0731849670410156
Epoch: 1, Steps: 523 | Train Loss: 0.7870311 Vali Loss: 0.2895564 Best vali loss: 0.2895564
	iters: 100, epoch: 2 | loss: 0.5235269
	speed: 0.0079s/iter; left time: 28.0768s
	iters: 200, epoch: 2 | loss: 0.3826458
	speed: 0.0035s/iter; left time: 12.0156s
	iters: 300, epoch: 2 | loss: 0.2817907
	speed: 0.0036s/iter; left time: 12.0201s
	iters: 400, epoch: 2 | loss: 0.3895572
	speed: 0.0036s/iter; left time: 11.6662s
	iters: 500, epoch: 2 | loss: 0.7047805
	speed: 0.0035s/iter; left time: 11.0565s
Updating learning rate to 0.0002435987344
Validation loss decreased (0.2896 --> 0.2866).  Saving model state dict ...
Epoch: 2 cost time: 1.8809840679168701
Epoch: 2, Steps: 523 | Train Loss: 0.4564602 Vali Loss: 0.2865781 Best vali loss: 0.2865781
	iters: 100, epoch: 3 | loss: 0.2774964
	speed: 0.0078s/iter; left time: 23.7391s
	iters: 200, epoch: 3 | loss: 0.2480095
	speed: 0.0031s/iter; left time: 9.0315s
	iters: 300, epoch: 3 | loss: 0.3156389
	speed: 0.0030s/iter; left time: 8.6503s
	iters: 400, epoch: 3 | loss: 0.5948377
	speed: 0.0031s/iter; left time: 8.3622s
	iters: 500, epoch: 3 | loss: 1.0200235
	speed: 0.0030s/iter; left time: 8.0446s
Updating learning rate to 0.0001217993672
Epoch: 3 cost time: 1.636812448501587
Epoch: 3, Steps: 523 | Train Loss: 0.4912012 Vali Loss: 0.2891386 Best vali loss: 0.2865781
	iters: 100, epoch: 4 | loss: 0.5276595
	speed: 0.0071s/iter; left time: 17.9368s
	iters: 200, epoch: 4 | loss: 0.5770916
	speed: 0.0031s/iter; left time: 7.4115s
	iters: 300, epoch: 4 | loss: 0.5334278
	speed: 0.0031s/iter; left time: 7.1242s
	iters: 400, epoch: 4 | loss: 0.4612085
	speed: 0.0031s/iter; left time: 6.7891s
	iters: 500, epoch: 4 | loss: 0.5114703
	speed: 0.0031s/iter; left time: 6.4730s
Updating learning rate to 6.08996836e-05
Epoch: 4 cost time: 1.6393113136291504
Epoch: 4, Steps: 523 | Train Loss: 0.5221716 Vali Loss: 0.2956927 Best vali loss: 0.2865781
	iters: 100, epoch: 5 | loss: 0.5986650
	speed: 0.0073s/iter; left time: 14.4677s
	iters: 200, epoch: 5 | loss: 0.4672307
	speed: 0.0031s/iter; left time: 5.9043s
	iters: 300, epoch: 5 | loss: 0.5645461
	speed: 0.0031s/iter; left time: 5.4846s
	iters: 400, epoch: 5 | loss: 0.5974709
	speed: 0.0031s/iter; left time: 5.1710s
	iters: 500, epoch: 5 | loss: 0.6644617
	speed: 0.0034s/iter; left time: 5.3549s
Updating learning rate to 3.04498418e-05
Epoch: 5 cost time: 1.7022829055786133
Epoch: 5, Steps: 523 | Train Loss: 0.5784749 Vali Loss: 0.3087470 Best vali loss: 0.2865781
	iters: 100, epoch: 6 | loss: 0.4632837
	speed: 0.0076s/iter; left time: 11.0996s
	iters: 200, epoch: 6 | loss: 0.5378459
	speed: 0.0033s/iter; left time: 4.5246s
	iters: 300, epoch: 6 | loss: 0.2433751
	speed: 0.0033s/iter; left time: 4.2286s
	iters: 400, epoch: 6 | loss: 0.3874206
	speed: 0.0032s/iter; left time: 3.8004s
	iters: 500, epoch: 6 | loss: 0.2161091
	speed: 0.0032s/iter; left time: 3.3915s
Updating learning rate to 1.52249209e-05
Epoch: 6 cost time: 1.743166208267212
Epoch: 6, Steps: 523 | Train Loss: 0.3696069 Vali Loss: 0.3050517 Best vali loss: 0.2865781
	iters: 100, epoch: 7 | loss: 0.4229330
	speed: 0.0078s/iter; left time: 7.3893s
	iters: 200, epoch: 7 | loss: 0.5715849
	speed: 0.0036s/iter; left time: 3.0649s
	iters: 300, epoch: 7 | loss: 0.5469790
	speed: 0.0035s/iter; left time: 2.6222s
	iters: 400, epoch: 7 | loss: 0.3013967
	speed: 0.0033s/iter; left time: 2.1519s
	iters: 500, epoch: 7 | loss: 0.5722444
	speed: 0.0033s/iter; left time: 1.8200s
Updating learning rate to 7.61246045e-06
Epoch: 7 cost time: 1.8601677417755127
Epoch: 7, Steps: 523 | Train Loss: 0.4830276 Vali Loss: 0.3109767 Best vali loss: 0.2865781
	iters: 100, epoch: 8 | loss: 0.9151571
	speed: 0.0077s/iter; left time: 3.2608s
	iters: 200, epoch: 8 | loss: 0.2394421
	speed: 0.0035s/iter; left time: 1.1455s
	iters: 300, epoch: 8 | loss: 0.2486625
	speed: 0.0035s/iter; left time: 0.7869s
	iters: 400, epoch: 8 | loss: 0.2549196
	speed: 0.0035s/iter; left time: 0.4373s
	iters: 500, epoch: 8 | loss: 0.5988393
	speed: 0.0036s/iter; left time: 0.0855s
Updating learning rate to 3.806230225e-06
Epoch: 8 cost time: 1.8828272819519043
Epoch: 8, Steps: 523 | Train Loss: 0.4514041 Vali Loss: 0.3115092 Best vali loss: 0.2865781

best validation loss 0.28657805219198434

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0009682373645, 'e_layers': 3, 'learning_rate': 0.0002850493026, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6443443
	speed: 0.0110s/iter; left time: 10.4126s
Updating learning rate to 0.0002742002595143782
Validation loss decreased (inf --> 0.2755).  Saving model state dict ...
Epoch: 1 cost time: 1.0000581741333008
Epoch: 1, Steps: 131 | Train Loss: 0.6443443 Vali Loss: 0.2755150 Best vali loss: 0.2755150
	iters: 100, epoch: 2 | loss: 0.4938287
	speed: 0.0096s/iter; left time: 7.8259s
Updating learning rate to 0.0002433047987204781
Epoch: 2 cost time: 0.7496309280395508
Epoch: 2, Steps: 131 | Train Loss: 0.4938287 Vali Loss: 0.2795903 Best vali loss: 0.2755150
	iters: 100, epoch: 3 | loss: 0.6602175
	speed: 0.0093s/iter; left time: 6.4070s
Updating learning rate to 0.0001970664740561216
Epoch: 3 cost time: 0.7597126960754395
Epoch: 3, Steps: 131 | Train Loss: 0.6602175 Vali Loss: 0.2797449 Best vali loss: 0.2755150

best validation loss 0.2755149942363847

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0046946414763, 'e_layers': 1, 'learning_rate': 0.0001037990381, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4684662
	speed: 0.0080s/iter; left time: 15.9585s
	iters: 200, epoch: 1 | loss: 0.2835141
	speed: 0.0025s/iter; left time: 4.6885s
Updating learning rate to 9.984842244747462e-05
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 0.924008846282959
Epoch: 1, Steps: 262 | Train Loss: 0.3759901 Vali Loss: 0.2830870 Best vali loss: 0.2830870
	iters: 100, epoch: 2 | loss: 0.4115191
	speed: 0.0065s/iter; left time: 11.2240s
	iters: 200, epoch: 2 | loss: 0.5697733
	speed: 0.0027s/iter; left time: 4.4870s
Updating learning rate to 8.85980209105754e-05
Validation loss decreased (0.2831 --> 0.2778).  Saving model state dict ...
Epoch: 2 cost time: 0.749025821685791
Epoch: 2, Steps: 262 | Train Loss: 0.4906462 Vali Loss: 0.2777757 Best vali loss: 0.2777757
	iters: 100, epoch: 3 | loss: 0.3022316
	speed: 0.0066s/iter; left time: 9.7331s
	iters: 200, epoch: 3 | loss: 0.2894957
	speed: 0.0026s/iter; left time: 3.5671s
Updating learning rate to 7.176060513815137e-05
Epoch: 3 cost time: 0.7277266979217529
Epoch: 3, Steps: 262 | Train Loss: 0.2958636 Vali Loss: 0.2831825 Best vali loss: 0.2777757

best validation loss 0.2777756711017159

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0085613066848, 'e_layers': 2, 'learning_rate': 0.0005003805573, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005003805573
Validation loss decreased (inf --> 0.3064).  Saving model state dict ...
Epoch: 1 cost time: 0.5483314990997314
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3063869 Best vali loss: 0.3063869
Updating learning rate to 0.00025019027865
Validation loss decreased (0.3064 --> 0.2914).  Saving model state dict ...
Epoch: 2 cost time: 0.3377532958984375
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2913818 Best vali loss: 0.2913818
Updating learning rate to 0.000125095139325
Validation loss decreased (0.2914 --> 0.2869).  Saving model state dict ...
Epoch: 3 cost time: 0.3265705108642578
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2868946 Best vali loss: 0.2868946

best validation loss 0.2868945732263882

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0009682373645, 'e_layers': 3, 'learning_rate': 0.0002850493026, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4508587
	speed: 0.0115s/iter; left time: 6.4012s
Updating learning rate to 0.0001425246513
Epoch: 4 cost time: 1.0151004791259766
Epoch: 4, Steps: 131 | Train Loss: 0.4508587 Vali Loss: 0.2838608 Best vali loss: 0.2755150
	iters: 100, epoch: 5 | loss: 0.3550312
	speed: 0.0092s/iter; left time: 3.9285s
Updating learning rate to 8.798282854387846e-05
Epoch: 5 cost time: 0.7473819255828857
Epoch: 5, Steps: 131 | Train Loss: 0.3550312 Vali Loss: 0.2890470 Best vali loss: 0.2755150
	iters: 100, epoch: 6 | loss: 0.4756442
	speed: 0.0092s/iter; left time: 2.7155s
Updating learning rate to 4.174450387952193e-05
Epoch: 6 cost time: 0.7539258003234863
Epoch: 6, Steps: 131 | Train Loss: 0.4756442 Vali Loss: 0.3053432 Best vali loss: 0.2755150
	iters: 100, epoch: 7 | loss: 0.4158755
	speed: 0.0093s/iter; left time: 1.5092s
Updating learning rate to 1.0849043085621844e-05
Epoch: 7 cost time: 0.7546560764312744
Epoch: 7, Steps: 131 | Train Loss: 0.4158755 Vali Loss: 0.3166117 Best vali loss: 0.2755150
	iters: 100, epoch: 8 | loss: 0.2746958
	speed: 0.0092s/iter; left time: 0.2957s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.76759934425354
Epoch: 8, Steps: 131 | Train Loss: 0.2746958 Vali Loss: 0.3177364 Best vali loss: 0.2755150

best validation loss 0.2755149942363847

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010345529083, 'e_layers': 2, 'learning_rate': 0.0002227197722, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5585907
	speed: 0.0104s/iter; left time: 9.8913s
Updating learning rate to 0.00021424300561057814
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9259562492370605
Epoch: 1, Steps: 131 | Train Loss: 0.5585907 Vali Loss: 0.2756303 Best vali loss: 0.2756303
	iters: 100, epoch: 2 | loss: 0.3259239
	speed: 0.0089s/iter; left time: 7.2707s
Updating learning rate to 0.00019010321671347156
Validation loss decreased (0.2756 --> 0.2745).  Saving model state dict ...
Epoch: 2 cost time: 0.7051107883453369
Epoch: 2, Steps: 131 | Train Loss: 0.3259239 Vali Loss: 0.2744524 Best vali loss: 0.2744524
	iters: 100, epoch: 3 | loss: 0.4683818
	speed: 0.0090s/iter; left time: 6.1663s
Updating learning rate to 0.00015397546954053345
Epoch: 3 cost time: 0.704833984375
Epoch: 3, Steps: 131 | Train Loss: 0.4683818 Vali Loss: 0.2871607 Best vali loss: 0.2744524
	iters: 100, epoch: 4 | loss: 0.4974242
	speed: 0.0086s/iter; left time: 4.8031s
Updating learning rate to 0.0001113598861
Epoch: 4 cost time: 0.6951446533203125
Epoch: 4, Steps: 131 | Train Loss: 0.4974242 Vali Loss: 0.2878898 Best vali loss: 0.2744524
	iters: 100, epoch: 5 | loss: 0.3389904
	speed: 0.0086s/iter; left time: 3.6498s
Updating learning rate to 6.874430265946656e-05
Epoch: 5 cost time: 0.6963388919830322
Epoch: 5, Steps: 131 | Train Loss: 0.3389904 Vali Loss: 0.2931514 Best vali loss: 0.2744524
	iters: 100, epoch: 6 | loss: 0.3092777
	speed: 0.0087s/iter; left time: 2.5453s
Updating learning rate to 3.261655548652845e-05
Epoch: 6 cost time: 0.7024273872375488
Epoch: 6, Steps: 131 | Train Loss: 0.3092777 Vali Loss: 0.3005347 Best vali loss: 0.2744524
	iters: 100, epoch: 7 | loss: 0.2913867
	speed: 0.0087s/iter; left time: 1.4153s
Updating learning rate to 8.476766589421863e-06
Epoch: 7 cost time: 0.7056605815887451
Epoch: 7, Steps: 131 | Train Loss: 0.2913867 Vali Loss: 0.2998215 Best vali loss: 0.2744524
	iters: 100, epoch: 8 | loss: 0.3493065
	speed: 0.0087s/iter; left time: 0.2772s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7082695960998535
Epoch: 8, Steps: 131 | Train Loss: 0.3493065 Vali Loss: 0.3017451 Best vali loss: 0.2744524

best validation loss 0.2744523929414717

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0008496345343, 'e_layers': 3, 'learning_rate': 0.0005084299861, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5669734
	speed: 0.0115s/iter; left time: 10.9561s
Updating learning rate to 0.0005084299861
Validation loss decreased (inf --> 0.2917).  Saving model state dict ...
Epoch: 1 cost time: 1.062396764755249
Epoch: 1, Steps: 131 | Train Loss: 0.5669734 Vali Loss: 0.2916549 Best vali loss: 0.2916549
	iters: 100, epoch: 2 | loss: 0.5814939
	speed: 0.0103s/iter; left time: 8.3927s
Updating learning rate to 0.00025421499305
Validation loss decreased (0.2917 --> 0.2895).  Saving model state dict ...
Epoch: 2 cost time: 0.814032793045044
Epoch: 2, Steps: 131 | Train Loss: 0.5814939 Vali Loss: 0.2895449 Best vali loss: 0.2895449
	iters: 100, epoch: 3 | loss: 0.4159591
	speed: 0.0103s/iter; left time: 7.0553s
Updating learning rate to 0.000127107496525
Epoch: 3 cost time: 0.8071138858795166
Epoch: 3, Steps: 131 | Train Loss: 0.4159591 Vali Loss: 0.2900991 Best vali loss: 0.2895449
	iters: 100, epoch: 4 | loss: 0.3272395
	speed: 0.0099s/iter; left time: 5.4917s
Updating learning rate to 6.35537482625e-05
Validation loss decreased (0.2895 --> 0.2822).  Saving model state dict ...
Epoch: 4 cost time: 0.8073933124542236
Epoch: 4, Steps: 131 | Train Loss: 0.3272395 Vali Loss: 0.2821657 Best vali loss: 0.2821657
	iters: 100, epoch: 5 | loss: 0.3601255
	speed: 0.0103s/iter; left time: 4.3949s
Updating learning rate to 3.177687413125e-05
Epoch: 5 cost time: 0.8120019435882568
Epoch: 5, Steps: 131 | Train Loss: 0.3601255 Vali Loss: 0.2849176 Best vali loss: 0.2821657
	iters: 100, epoch: 6 | loss: 0.4547568
	speed: 0.0100s/iter; left time: 2.9500s
Updating learning rate to 1.5888437065625e-05
Epoch: 6 cost time: 0.8219690322875977
Epoch: 6, Steps: 131 | Train Loss: 0.4547568 Vali Loss: 0.2862905 Best vali loss: 0.2821657
	iters: 100, epoch: 7 | loss: 0.3111190
	speed: 0.0100s/iter; left time: 1.6375s
Updating learning rate to 7.9442185328125e-06
Epoch: 7 cost time: 0.8167440891265869
Epoch: 7, Steps: 131 | Train Loss: 0.3111190 Vali Loss: 0.2882278 Best vali loss: 0.2821657
	iters: 100, epoch: 8 | loss: 0.3863804
	speed: 0.0100s/iter; left time: 0.3200s
Updating learning rate to 3.97210926640625e-06
Epoch: 8 cost time: 0.8197462558746338
Epoch: 8, Steps: 131 | Train Loss: 0.3863804 Vali Loss: 0.2900869 Best vali loss: 0.2821657

best validation loss 0.28216574134082767

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0060173391195, 'e_layers': 4, 'learning_rate': 0.0025723668113, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5330287
	speed: 0.0105s/iter; left time: 42.9670s
	iters: 200, epoch: 1 | loss: 0.4598862
	speed: 0.0052s/iter; left time: 20.5669s
	iters: 300, epoch: 1 | loss: 0.5989810
	speed: 0.0052s/iter; left time: 20.2256s
	iters: 400, epoch: 1 | loss: 1.0838714
	speed: 0.0053s/iter; left time: 19.8728s
	iters: 500, epoch: 1 | loss: 0.2485902
	speed: 0.0050s/iter; left time: 18.4677s
Updating learning rate to 0.0025723668113
Validation loss decreased (inf --> 0.3224).  Saving model state dict ...
Epoch: 1 cost time: 2.953810691833496
Epoch: 1, Steps: 523 | Train Loss: 0.5848715 Vali Loss: 0.3223687 Best vali loss: 0.3223687
	iters: 100, epoch: 2 | loss: 0.5160160
	speed: 0.0102s/iter; left time: 36.3538s
	iters: 200, epoch: 2 | loss: 0.3939062
	speed: 0.0048s/iter; left time: 16.5930s
	iters: 300, epoch: 2 | loss: 0.3912199
	speed: 0.0046s/iter; left time: 15.4077s
	iters: 400, epoch: 2 | loss: 0.4247267
	speed: 0.0046s/iter; left time: 14.9998s
	iters: 500, epoch: 2 | loss: 0.5378126
	speed: 0.0046s/iter; left time: 14.4828s
Updating learning rate to 0.00128618340565
Validation loss decreased (0.3224 --> 0.3207).  Saving model state dict ...
Epoch: 2 cost time: 2.5024945735931396
Epoch: 2, Steps: 523 | Train Loss: 0.4527363 Vali Loss: 0.3207007 Best vali loss: 0.3207007
	iters: 100, epoch: 3 | loss: 0.9732506
	speed: 0.0101s/iter; left time: 30.6298s
	iters: 200, epoch: 3 | loss: 0.3543604
	speed: 0.0050s/iter; left time: 14.6105s
	iters: 300, epoch: 3 | loss: 0.2993454
	speed: 0.0050s/iter; left time: 14.0832s
	iters: 400, epoch: 3 | loss: 0.8508373
	speed: 0.0049s/iter; left time: 13.5500s
	iters: 500, epoch: 3 | loss: 0.8193015
	speed: 0.0049s/iter; left time: 13.0119s
Updating learning rate to 0.000643091702825
Epoch: 3 cost time: 2.636960983276367
Epoch: 3, Steps: 523 | Train Loss: 0.6594191 Vali Loss: 0.3213824 Best vali loss: 0.3207007

best validation loss 0.3207007334461971

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021368889049, 'e_layers': 3, 'learning_rate': 0.0014847918768, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014282803509072701
Validation loss decreased (inf --> 0.2830).  Saving model state dict ...
Epoch: 1 cost time: 0.6160097122192383
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2830310 Best vali loss: 0.2830310
Updating learning rate to 0.0012673491407679904
Epoch: 2 cost time: 0.38704967498779297
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2871743 Best vali loss: 0.2830310
Updating learning rate to 0.001026498564280814
Epoch: 3 cost time: 0.40055251121520996
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2906029 Best vali loss: 0.2830310

best validation loss 0.2830310093731453

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0016332240166, 'e_layers': 3, 'learning_rate': 0.0012353264644, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0011883096504143463
Validation loss decreased (inf --> 0.2810).  Saving model state dict ...
Epoch: 1 cost time: 0.6222913265228271
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2809913 Best vali loss: 0.2809913
Updating learning rate to 0.001054417092178221
Epoch: 2 cost time: 0.37453317642211914
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2840774 Best vali loss: 0.2809913
Updating learning rate to 0.0008540327179440114
Epoch: 3 cost time: 0.3719162940979004
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3035614 Best vali loss: 0.2809913

best validation loss 0.280991277139663

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0016332240166, 'e_layers': 3, 'learning_rate': 0.0012353264644, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0006176632322
Epoch: 4 cost time: 0.614372968673706
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2877361 Best vali loss: 0.2809913
Updating learning rate to 0.00038129374645598854
Epoch: 5 cost time: 0.37714433670043945
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2903164 Best vali loss: 0.2809913
Updating learning rate to 0.00018090937222177894
Epoch: 6 cost time: 0.38199830055236816
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2951360 Best vali loss: 0.2809913
Updating learning rate to 4.7016813985653646e-05
Epoch: 7 cost time: 0.358917236328125
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2914813 Best vali loss: 0.2809913
Updating learning rate to 0.0
Epoch: 8 cost time: 0.37906789779663086
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2942290 Best vali loss: 0.2809913

best validation loss 0.280991277139663

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0031576926739, 'e_layers': 1, 'learning_rate': 0.0004368533422, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2715598
	speed: 0.0076s/iter; left time: 30.8640s
	iters: 200, epoch: 1 | loss: 0.5415853
	speed: 0.0023s/iter; left time: 9.3357s
	iters: 300, epoch: 1 | loss: 0.4010066
	speed: 0.0025s/iter; left time: 9.7070s
	iters: 400, epoch: 1 | loss: 0.3538769
	speed: 0.0025s/iter; left time: 9.3200s
	iters: 500, epoch: 1 | loss: 0.6917770
	speed: 0.0025s/iter; left time: 9.1210s
Updating learning rate to 0.0004368533422
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 1.5262465476989746
Epoch: 1, Steps: 523 | Train Loss: 0.4519611 Vali Loss: 0.2785931 Best vali loss: 0.2785931
	iters: 100, epoch: 2 | loss: 0.4069500
	speed: 0.0058s/iter; left time: 20.7521s
	iters: 200, epoch: 2 | loss: 0.8422984
	speed: 0.0024s/iter; left time: 8.3404s
	iters: 300, epoch: 2 | loss: 0.3106251
	speed: 0.0024s/iter; left time: 8.0587s
	iters: 400, epoch: 2 | loss: 0.3070649
	speed: 0.0023s/iter; left time: 7.6041s
	iters: 500, epoch: 2 | loss: 0.3434678
	speed: 0.0023s/iter; left time: 7.3989s
Updating learning rate to 0.0002184266711
Epoch: 2 cost time: 1.281869888305664
Epoch: 2, Steps: 523 | Train Loss: 0.4420813 Vali Loss: 0.2878197 Best vali loss: 0.2785931
	iters: 100, epoch: 3 | loss: 0.2666929
	speed: 0.0055s/iter; left time: 16.8127s
	iters: 200, epoch: 3 | loss: 0.4078115
	speed: 0.0022s/iter; left time: 6.4811s
	iters: 300, epoch: 3 | loss: 0.3986705
	speed: 0.0023s/iter; left time: 6.4677s
	iters: 400, epoch: 3 | loss: 0.3025171
	speed: 0.0023s/iter; left time: 6.3147s
	iters: 500, epoch: 3 | loss: 0.3892819
	speed: 0.0023s/iter; left time: 6.0243s
Updating learning rate to 0.00010921333555
Epoch: 3 cost time: 1.2201855182647705
Epoch: 3, Steps: 523 | Train Loss: 0.3529948 Vali Loss: 0.2939924 Best vali loss: 0.2785931
	iters: 100, epoch: 4 | loss: 0.2916205
	speed: 0.0055s/iter; left time: 13.8767s
	iters: 200, epoch: 4 | loss: 0.2674715
	speed: 0.0023s/iter; left time: 5.5245s
	iters: 300, epoch: 4 | loss: 0.2394232
	speed: 0.0022s/iter; left time: 5.1949s
	iters: 400, epoch: 4 | loss: 0.3993179
	speed: 0.0023s/iter; left time: 5.1210s
	iters: 500, epoch: 4 | loss: 0.1735490
	speed: 0.0024s/iter; left time: 5.0297s
Updating learning rate to 5.4606667775e-05
Epoch: 4 cost time: 1.2333474159240723
Epoch: 4, Steps: 523 | Train Loss: 0.2742764 Vali Loss: 0.2910355 Best vali loss: 0.2785931
	iters: 100, epoch: 5 | loss: 0.3679563
	speed: 0.0060s/iter; left time: 11.8906s
	iters: 200, epoch: 5 | loss: 0.3478850
	speed: 0.0023s/iter; left time: 4.3270s
	iters: 300, epoch: 5 | loss: 0.5935787
	speed: 0.0022s/iter; left time: 3.8956s
	iters: 400, epoch: 5 | loss: 0.2944812
	speed: 0.0022s/iter; left time: 3.6508s
	iters: 500, epoch: 5 | loss: 0.3298415
	speed: 0.0022s/iter; left time: 3.4351s
Updating learning rate to 2.73033338875e-05
Epoch: 5 cost time: 1.2247347831726074
Epoch: 5, Steps: 523 | Train Loss: 0.3867485 Vali Loss: 0.2956602 Best vali loss: 0.2785931
	iters: 100, epoch: 6 | loss: 0.2672016
	speed: 0.0057s/iter; left time: 8.3486s
	iters: 200, epoch: 6 | loss: 0.3933748
	speed: 0.0024s/iter; left time: 3.3488s
	iters: 300, epoch: 6 | loss: 0.4425310
	speed: 0.0024s/iter; left time: 3.0852s
	iters: 400, epoch: 6 | loss: 0.1903559
	speed: 0.0024s/iter; left time: 2.7699s
	iters: 500, epoch: 6 | loss: 0.4758384
	speed: 0.0024s/iter; left time: 2.5446s
Updating learning rate to 1.365166694375e-05
Epoch: 6 cost time: 1.2928626537322998
Epoch: 6, Steps: 523 | Train Loss: 0.3538603 Vali Loss: 0.2938452 Best vali loss: 0.2785931
	iters: 100, epoch: 7 | loss: 0.5032443
	speed: 0.0055s/iter; left time: 5.1931s
	iters: 200, epoch: 7 | loss: 0.3033502
	speed: 0.0023s/iter; left time: 1.9622s
	iters: 300, epoch: 7 | loss: 0.3610175
	speed: 0.0023s/iter; left time: 1.7335s
	iters: 400, epoch: 7 | loss: 0.4338341
	speed: 0.0024s/iter; left time: 1.5260s
	iters: 500, epoch: 7 | loss: 0.6218298
	speed: 0.0024s/iter; left time: 1.3027s
Updating learning rate to 6.825833471875e-06
Epoch: 7 cost time: 1.2475731372833252
Epoch: 7, Steps: 523 | Train Loss: 0.4446552 Vali Loss: 0.2959324 Best vali loss: 0.2785931
	iters: 100, epoch: 8 | loss: 0.2724055
	speed: 0.0060s/iter; left time: 2.5233s
	iters: 200, epoch: 8 | loss: 0.7558007
	speed: 0.0025s/iter; left time: 0.8050s
	iters: 300, epoch: 8 | loss: 0.4380261
	speed: 0.0025s/iter; left time: 0.5580s
	iters: 400, epoch: 8 | loss: 0.5946922
	speed: 0.0025s/iter; left time: 0.3069s
	iters: 500, epoch: 8 | loss: 0.2760367
	speed: 0.0025s/iter; left time: 0.0592s
Updating learning rate to 3.4129167359375e-06
Epoch: 8 cost time: 1.338451862335205
Epoch: 8, Steps: 523 | Train Loss: 0.4673922 Vali Loss: 0.2957079 Best vali loss: 0.2785931

best validation loss 0.2785931130481192

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0032181255246, 'e_layers': 3, 'learning_rate': 0.0001018404482, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4180578
	speed: 0.0092s/iter; left time: 37.7678s
	iters: 200, epoch: 1 | loss: 0.4124054
	speed: 0.0040s/iter; left time: 15.8820s
	iters: 300, epoch: 1 | loss: 0.3298268
	speed: 0.0040s/iter; left time: 15.5913s
	iters: 400, epoch: 1 | loss: 0.6660799
	speed: 0.0040s/iter; left time: 15.0546s
	iters: 500, epoch: 1 | loss: 0.3184558
	speed: 0.0040s/iter; left time: 14.6023s
Updating learning rate to 9.796437693687795e-05
Validation loss decreased (inf --> 0.3098).  Saving model state dict ...
Epoch: 1 cost time: 2.3610851764678955
Epoch: 1, Steps: 523 | Train Loss: 0.4289651 Vali Loss: 0.3098059 Best vali loss: 0.3098059
	iters: 100, epoch: 2 | loss: 0.5550875
	speed: 0.0088s/iter; left time: 31.4130s
	iters: 200, epoch: 2 | loss: 0.3924191
	speed: 0.0043s/iter; left time: 14.9272s
	iters: 300, epoch: 2 | loss: 0.4735814
	speed: 0.0043s/iter; left time: 14.4114s
	iters: 400, epoch: 2 | loss: 0.3924509
	speed: 0.0044s/iter; left time: 14.2869s
	iters: 500, epoch: 2 | loss: 0.4206543
	speed: 0.0043s/iter; left time: 13.7002s
Updating learning rate to 8.692625986064865e-05
Validation loss decreased (0.3098 --> 0.2949).  Saving model state dict ...
Epoch: 2 cost time: 2.303755044937134
Epoch: 2, Steps: 523 | Train Loss: 0.4468386 Vali Loss: 0.2948526 Best vali loss: 0.2948526
	iters: 100, epoch: 3 | loss: 0.7855764
	speed: 0.0085s/iter; left time: 25.9082s
	iters: 200, epoch: 3 | loss: 1.0802802
	speed: 0.0041s/iter; left time: 12.0207s
	iters: 300, epoch: 3 | loss: 0.2966489
	speed: 0.0040s/iter; left time: 11.3875s
	iters: 400, epoch: 3 | loss: 0.2924065
	speed: 0.0041s/iter; left time: 11.1702s
	iters: 500, epoch: 3 | loss: 0.9008350
	speed: 0.0041s/iter; left time: 10.7223s
Updating learning rate to 7.040655023538757e-05
Validation loss decreased (0.2949 --> 0.2890).  Saving model state dict ...
Epoch: 3 cost time: 2.1660680770874023
Epoch: 3, Steps: 523 | Train Loss: 0.6711494 Vali Loss: 0.2890260 Best vali loss: 0.2890260
	iters: 100, epoch: 4 | loss: 0.4227932
	speed: 0.0080s/iter; left time: 20.0139s
	iters: 200, epoch: 4 | loss: 0.5013074
	speed: 0.0036s/iter; left time: 8.6115s
	iters: 300, epoch: 4 | loss: 0.7075703
	speed: 0.0036s/iter; left time: 8.2548s
	iters: 400, epoch: 4 | loss: 0.3412507
	speed: 0.0037s/iter; left time: 8.1298s
	iters: 500, epoch: 4 | loss: 0.4134353
	speed: 0.0036s/iter; left time: 7.7218s
Updating learning rate to 5.09202241e-05
Validation loss decreased (0.2890 --> 0.2853).  Saving model state dict ...
Epoch: 4 cost time: 1.9257457256317139
Epoch: 4, Steps: 523 | Train Loss: 0.4772714 Vali Loss: 0.2852787 Best vali loss: 0.2852787
	iters: 100, epoch: 5 | loss: 0.2431453
	speed: 0.0077s/iter; left time: 15.4132s
	iters: 200, epoch: 5 | loss: 0.2305570
	speed: 0.0035s/iter; left time: 6.5965s
	iters: 300, epoch: 5 | loss: 0.3102347
	speed: 0.0035s/iter; left time: 6.2724s
	iters: 400, epoch: 5 | loss: 0.4536763
	speed: 0.0038s/iter; left time: 6.4940s
	iters: 500, epoch: 5 | loss: 0.6753385
	speed: 0.0040s/iter; left time: 6.3423s
Updating learning rate to 3.143389796461244e-05
Validation loss decreased (0.2853 --> 0.2837).  Saving model state dict ...
Epoch: 5 cost time: 1.9630045890808105
Epoch: 5, Steps: 523 | Train Loss: 0.3825904 Vali Loss: 0.2836747 Best vali loss: 0.2836747
	iters: 100, epoch: 6 | loss: 0.2432990
	speed: 0.0086s/iter; left time: 12.6797s
	iters: 200, epoch: 6 | loss: 0.2265832
	speed: 0.0042s/iter; left time: 5.7411s
	iters: 300, epoch: 6 | loss: 0.4976176
	speed: 0.0042s/iter; left time: 5.3482s
	iters: 400, epoch: 6 | loss: 0.8150800
	speed: 0.0042s/iter; left time: 4.8883s
	iters: 500, epoch: 6 | loss: 0.3397707
	speed: 0.0042s/iter; left time: 4.5147s
Updating learning rate to 1.4914188339351339e-05
Validation loss decreased (0.2837 --> 0.2831).  Saving model state dict ...
Epoch: 6 cost time: 2.237718105316162
Epoch: 6, Steps: 523 | Train Loss: 0.4244701 Vali Loss: 0.2830604 Best vali loss: 0.2830604
	iters: 100, epoch: 7 | loss: 0.7722658
	speed: 0.0089s/iter; left time: 8.3915s
	iters: 200, epoch: 7 | loss: 0.3582723
	speed: 0.0043s/iter; left time: 3.6602s
	iters: 300, epoch: 7 | loss: 0.2990089
	speed: 0.0043s/iter; left time: 3.2009s
	iters: 400, epoch: 7 | loss: 0.2756498
	speed: 0.0043s/iter; left time: 2.7840s
	iters: 500, epoch: 7 | loss: 0.3609198
	speed: 0.0043s/iter; left time: 2.3610s
Updating learning rate to 3.8760712631220436e-06
Validation loss decreased (0.2831 --> 0.2828).  Saving model state dict ...
Epoch: 7 cost time: 2.2927591800689697
Epoch: 7, Steps: 523 | Train Loss: 0.4132233 Vali Loss: 0.2828490 Best vali loss: 0.2828490
	iters: 100, epoch: 8 | loss: 0.5649726
	speed: 0.0086s/iter; left time: 3.6499s
	iters: 200, epoch: 8 | loss: 0.3415784
	speed: 0.0042s/iter; left time: 1.3473s
	iters: 300, epoch: 8 | loss: 0.6824598
	speed: 0.0042s/iter; left time: 0.9383s
	iters: 400, epoch: 8 | loss: 0.7110104
	speed: 0.0042s/iter; left time: 0.5184s
	iters: 500, epoch: 8 | loss: 1.0471957
	speed: 0.0042s/iter; left time: 0.1012s
Updating learning rate to 0.0
Validation loss decreased (0.2828 --> 0.2828).  Saving model state dict ...
Epoch: 8 cost time: 2.2282445430755615
Epoch: 8, Steps: 523 | Train Loss: 0.6694434 Vali Loss: 0.2828021 Best vali loss: 0.2828021

best validation loss 0.28280212799161286

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.006590053763, 'e_layers': 3, 'learning_rate': 0.0001046042347, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2102384
	speed: 0.0094s/iter; left time: 77.9394s
	iters: 200, epoch: 1 | loss: 0.1450123
	speed: 0.0040s/iter; left time: 32.6993s
	iters: 300, epoch: 1 | loss: 0.2156903
	speed: 0.0043s/iter; left time: 34.4409s
	iters: 400, epoch: 1 | loss: 1.9129850
	speed: 0.0043s/iter; left time: 34.1565s
	iters: 500, epoch: 1 | loss: 0.2932897
	speed: 0.0043s/iter; left time: 33.4675s
	iters: 600, epoch: 1 | loss: 0.3477474
	speed: 0.0043s/iter; left time: 33.2654s
	iters: 700, epoch: 1 | loss: 0.5689393
	speed: 0.0043s/iter; left time: 33.0092s
	iters: 800, epoch: 1 | loss: 0.2722454
	speed: 0.0043s/iter; left time: 32.8379s
	iters: 900, epoch: 1 | loss: 0.3030705
	speed: 0.0043s/iter; left time: 32.2653s
	iters: 1000, epoch: 1 | loss: 0.7420484
	speed: 0.0043s/iter; left time: 31.8202s
Updating learning rate to 0.00010062297307666846
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 4.725669622421265
Epoch: 1, Steps: 1045 | Train Loss: 0.5011267 Vali Loss: 0.2806244 Best vali loss: 0.2806244
	iters: 100, epoch: 2 | loss: 0.8197623
	speed: 0.0124s/iter; left time: 89.5511s
	iters: 200, epoch: 2 | loss: 0.2109883
	speed: 0.0042s/iter; left time: 30.0415s
	iters: 300, epoch: 2 | loss: 0.1731827
	speed: 0.0041s/iter; left time: 28.9031s
	iters: 400, epoch: 2 | loss: 0.8869458
	speed: 0.0041s/iter; left time: 28.6335s
	iters: 500, epoch: 2 | loss: 0.2280177
	speed: 0.0042s/iter; left time: 28.5592s
	iters: 600, epoch: 2 | loss: 0.4182777
	speed: 0.0043s/iter; left time: 28.8256s
	iters: 700, epoch: 2 | loss: 0.3369135
	speed: 0.0042s/iter; left time: 27.9668s
	iters: 800, epoch: 2 | loss: 0.4955223
	speed: 0.0043s/iter; left time: 27.7002s
	iters: 900, epoch: 2 | loss: 1.2835016
	speed: 0.0042s/iter; left time: 27.2056s
	iters: 1000, epoch: 2 | loss: 0.4133322
	speed: 0.0043s/iter; left time: 27.1782s
Updating learning rate to 8.928529919859958e-05
Epoch: 2 cost time: 4.4554808139801025
Epoch: 2, Steps: 1045 | Train Loss: 0.5266444 Vali Loss: 0.3082035 Best vali loss: 0.2806244
	iters: 100, epoch: 3 | loss: 0.6133102
	speed: 0.0122s/iter; left time: 75.0697s
	iters: 200, epoch: 3 | loss: 0.2095921
	speed: 0.0042s/iter; left time: 25.5851s
	iters: 300, epoch: 3 | loss: 0.8996435
	speed: 0.0042s/iter; left time: 25.2566s
	iters: 400, epoch: 3 | loss: 0.3947703
	speed: 0.0042s/iter; left time: 24.7279s
	iters: 500, epoch: 3 | loss: 0.4518201
	speed: 0.0042s/iter; left time: 24.4838s
	iters: 600, epoch: 3 | loss: 0.4259594
	speed: 0.0042s/iter; left time: 23.8269s
	iters: 700, epoch: 3 | loss: 0.1844636
	speed: 0.0042s/iter; left time: 23.6428s
	iters: 800, epoch: 3 | loss: 0.2650157
	speed: 0.0042s/iter; left time: 22.8681s
	iters: 900, epoch: 3 | loss: 0.5386576
	speed: 0.0042s/iter; left time: 22.6417s
	iters: 1000, epoch: 3 | loss: 0.8105659
	speed: 0.0038s/iter; left time: 20.0861s
Updating learning rate to 7.231727113745971e-05
Epoch: 3 cost time: 4.381889820098877
Epoch: 3, Steps: 1045 | Train Loss: 0.4793799 Vali Loss: 0.3107062 Best vali loss: 0.2806244

best validation loss 0.28062443769346074

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0072742342485, 'e_layers': 3, 'learning_rate': 0.0002327252623, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5841249
	speed: 0.0096s/iter; left time: 39.2430s
	iters: 200, epoch: 1 | loss: 0.6914281
	speed: 0.0044s/iter; left time: 17.4024s
	iters: 300, epoch: 1 | loss: 1.0108057
	speed: 0.0043s/iter; left time: 16.7490s
	iters: 400, epoch: 1 | loss: 1.6680707
	speed: 0.0044s/iter; left time: 16.5177s
	iters: 500, epoch: 1 | loss: 0.3231252
	speed: 0.0044s/iter; left time: 16.1390s
Updating learning rate to 0.0002327252623
Validation loss decreased (inf --> 0.2820).  Saving model state dict ...
Epoch: 1 cost time: 2.5453827381134033
Epoch: 1, Steps: 523 | Train Loss: 0.8555109 Vali Loss: 0.2820393 Best vali loss: 0.2820393
	iters: 100, epoch: 2 | loss: 0.6040096
	speed: 0.0083s/iter; left time: 29.7287s
	iters: 200, epoch: 2 | loss: 0.3967027
	speed: 0.0037s/iter; left time: 12.6546s
	iters: 300, epoch: 2 | loss: 0.4399544
	speed: 0.0038s/iter; left time: 12.8877s
	iters: 400, epoch: 2 | loss: 0.3645188
	speed: 0.0038s/iter; left time: 12.3798s
	iters: 500, epoch: 2 | loss: 0.3734821
	speed: 0.0037s/iter; left time: 11.6318s
Updating learning rate to 0.00011636263115
Epoch: 2 cost time: 1.9901297092437744
Epoch: 2, Steps: 523 | Train Loss: 0.4357335 Vali Loss: 0.2829656 Best vali loss: 0.2820393
	iters: 100, epoch: 3 | loss: 0.5461330
	speed: 0.0082s/iter; left time: 24.9993s
	iters: 200, epoch: 3 | loss: 0.3411852
	speed: 0.0040s/iter; left time: 11.7562s
	iters: 300, epoch: 3 | loss: 0.5481306
	speed: 0.0040s/iter; left time: 11.2966s
	iters: 400, epoch: 3 | loss: 0.3370526
	speed: 0.0043s/iter; left time: 11.7116s
	iters: 500, epoch: 3 | loss: 1.2096422
	speed: 0.0043s/iter; left time: 11.3590s
Updating learning rate to 5.8181315575e-05
Epoch: 3 cost time: 2.1895203590393066
Epoch: 3, Steps: 523 | Train Loss: 0.5964287 Vali Loss: 0.2847725 Best vali loss: 0.2820393

best validation loss 0.28203932831791884

[INFO][smbo.py:320] Finished 800 trials.
{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0022408581422, 'e_layers': 1, 'learning_rate': 7.21134588e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.21134588e-05
Validation loss decreased (inf --> 0.3506).  Saving model state dict ...
Epoch: 1 cost time: 0.49345922470092773
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3505878 Best vali loss: 0.3505878
Updating learning rate to 3.60567294e-05
Validation loss decreased (0.3506 --> 0.3395).  Saving model state dict ...
Epoch: 2 cost time: 0.2634305953979492
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3394810 Best vali loss: 0.3394810
Updating learning rate to 1.80283647e-05
Validation loss decreased (0.3395 --> 0.3349).  Saving model state dict ...
Epoch: 3 cost time: 0.25824809074401855
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3349202 Best vali loss: 0.3349202

best validation loss 0.3349201871298999

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.006590053763, 'e_layers': 3, 'learning_rate': 0.0001046042347, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2118310
	speed: 0.0096s/iter; left time: 48.9740s
	iters: 200, epoch: 4 | loss: 0.1253770
	speed: 0.0042s/iter; left time: 20.9426s
	iters: 300, epoch: 4 | loss: 0.2089463
	speed: 0.0040s/iter; left time: 19.9490s
	iters: 400, epoch: 4 | loss: 0.7340540
	speed: 0.0042s/iter; left time: 20.2266s
	iters: 500, epoch: 4 | loss: 0.2201080
	speed: 0.0042s/iter; left time: 19.6934s
	iters: 600, epoch: 4 | loss: 0.2432347
	speed: 0.0041s/iter; left time: 18.8116s
	iters: 700, epoch: 4 | loss: 0.4010589
	speed: 0.0040s/iter; left time: 18.0944s
	iters: 800, epoch: 4 | loss: 0.2780121
	speed: 0.0040s/iter; left time: 17.6758s
	iters: 900, epoch: 4 | loss: 0.2366311
	speed: 0.0040s/iter; left time: 17.3106s
	iters: 1000, epoch: 4 | loss: 0.4408737
	speed: 0.0040s/iter; left time: 16.9324s
Updating learning rate to 5.230211735e-05
Epoch: 4 cost time: 4.5197319984436035
Epoch: 4, Steps: 1045 | Train Loss: 0.3100127 Vali Loss: 0.3070084 Best vali loss: 0.2806244
	iters: 100, epoch: 5 | loss: 0.3763038
	speed: 0.0121s/iter; left time: 49.4774s
	iters: 200, epoch: 5 | loss: 0.2039636
	speed: 0.0043s/iter; left time: 17.2074s
	iters: 300, epoch: 5 | loss: 0.1735919
	speed: 0.0043s/iter; left time: 16.6017s
	iters: 400, epoch: 5 | loss: 0.5958353
	speed: 0.0043s/iter; left time: 16.0873s
	iters: 500, epoch: 5 | loss: 0.2045040
	speed: 0.0043s/iter; left time: 15.9827s
	iters: 600, epoch: 5 | loss: 0.3852331
	speed: 0.0044s/iter; left time: 15.8730s
	iters: 700, epoch: 5 | loss: 0.2883933
	speed: 0.0043s/iter; left time: 15.0116s
	iters: 800, epoch: 5 | loss: 0.4392324
	speed: 0.0044s/iter; left time: 14.8188s
	iters: 900, epoch: 5 | loss: 0.7952433
	speed: 0.0044s/iter; left time: 14.3548s
	iters: 1000, epoch: 5 | loss: 0.3864405
	speed: 0.0044s/iter; left time: 13.9483s
Updating learning rate to 3.2286963562540286e-05
Epoch: 5 cost time: 4.575445652008057
Epoch: 5, Steps: 1045 | Train Loss: 0.3848741 Vali Loss: 0.3459993 Best vali loss: 0.2806244
	iters: 100, epoch: 6 | loss: 0.4977601
	speed: 0.0124s/iter; left time: 37.5465s
	iters: 200, epoch: 6 | loss: 0.1876235
	speed: 0.0042s/iter; left time: 12.4755s
	iters: 300, epoch: 6 | loss: 0.7112004
	speed: 0.0043s/iter; left time: 12.1119s
	iters: 400, epoch: 6 | loss: 0.3355008
	speed: 0.0043s/iter; left time: 11.7490s
	iters: 500, epoch: 6 | loss: 0.4020908
	speed: 0.0042s/iter; left time: 11.1995s
	iters: 600, epoch: 6 | loss: 0.2558467
	speed: 0.0042s/iter; left time: 10.7636s
	iters: 700, epoch: 6 | loss: 0.1667963
	speed: 0.0043s/iter; left time: 10.4164s
	iters: 800, epoch: 6 | loss: 0.2502487
	speed: 0.0043s/iter; left time: 9.9447s
	iters: 900, epoch: 6 | loss: 0.4168973
	speed: 0.0043s/iter; left time: 9.6304s
	iters: 1000, epoch: 6 | loss: 0.6037565
	speed: 0.0043s/iter; left time: 9.2740s
Updating learning rate to 1.5318935501400424e-05
Epoch: 6 cost time: 4.514325141906738
Epoch: 6, Steps: 1045 | Train Loss: 0.3827721 Vali Loss: 0.3539656 Best vali loss: 0.2806244
	iters: 100, epoch: 7 | loss: 0.1276450
	speed: 0.0119s/iter; left time: 23.7379s
	iters: 200, epoch: 7 | loss: 0.1383677
	speed: 0.0035s/iter; left time: 6.7040s
	iters: 300, epoch: 7 | loss: 0.2342902
	speed: 0.0036s/iter; left time: 6.3785s
	iters: 400, epoch: 7 | loss: 0.2832341
	speed: 0.0036s/iter; left time: 6.0175s
	iters: 500, epoch: 7 | loss: 0.1892687
	speed: 0.0035s/iter; left time: 5.6249s
	iters: 600, epoch: 7 | loss: 0.4558354
	speed: 0.0036s/iter; left time: 5.3101s
	iters: 700, epoch: 7 | loss: 0.2975830
	speed: 0.0035s/iter; left time: 4.8956s
	iters: 800, epoch: 7 | loss: 0.1611628
	speed: 0.0036s/iter; left time: 4.6067s
	iters: 900, epoch: 7 | loss: 0.2436894
	speed: 0.0036s/iter; left time: 4.2394s
	iters: 1000, epoch: 7 | loss: 0.1385082
	speed: 0.0037s/iter; left time: 4.0523s
Updating learning rate to 3.981261623331541e-06
Epoch: 7 cost time: 3.7724695205688477
Epoch: 7, Steps: 1045 | Train Loss: 0.2269585 Vali Loss: 0.3615193 Best vali loss: 0.2806244
	iters: 100, epoch: 8 | loss: 0.1537302
	speed: 0.0110s/iter; left time: 10.4039s
	iters: 200, epoch: 8 | loss: 0.6567165
	speed: 0.0035s/iter; left time: 2.9755s
	iters: 300, epoch: 8 | loss: 0.3412909
	speed: 0.0035s/iter; left time: 2.5997s
	iters: 400, epoch: 8 | loss: 0.1780545
	speed: 0.0035s/iter; left time: 2.2488s
	iters: 500, epoch: 8 | loss: 0.2540290
	speed: 0.0035s/iter; left time: 1.9000s
	iters: 600, epoch: 8 | loss: 0.2260093
	speed: 0.0035s/iter; left time: 1.5706s
	iters: 700, epoch: 8 | loss: 0.4940161
	speed: 0.0035s/iter; left time: 1.2225s
	iters: 800, epoch: 8 | loss: 0.2845533
	speed: 0.0035s/iter; left time: 0.8674s
	iters: 900, epoch: 8 | loss: 0.2736599
	speed: 0.0035s/iter; left time: 0.5137s
	iters: 1000, epoch: 8 | loss: 0.2027524
	speed: 0.0034s/iter; left time: 0.1587s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.696444511413574
Epoch: 8, Steps: 1045 | Train Loss: 0.3064812 Vali Loss: 0.3576210 Best vali loss: 0.2806244

best validation loss 0.28062443769346074

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0055095081107, 'e_layers': 2, 'learning_rate': 0.000524770858, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5928671
	speed: 0.0103s/iter; left time: 9.7499s
Updating learning rate to 0.0005047979564822934
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 0.9264650344848633
Epoch: 1, Steps: 131 | Train Loss: 0.5928671 Vali Loss: 0.2779284 Best vali loss: 0.2779284
	iters: 100, epoch: 2 | loss: 0.3146434
	speed: 0.0089s/iter; left time: 7.2605s
Updating learning rate to 0.0004479199451304414
Epoch: 2 cost time: 0.7018132209777832
Epoch: 2, Steps: 131 | Train Loss: 0.3146434 Vali Loss: 0.2909068 Best vali loss: 0.2779284
	iters: 100, epoch: 3 | loss: 0.4503757
	speed: 0.0087s/iter; left time: 5.9996s
Updating learning rate to 0.00036279598557230656
Epoch: 3 cost time: 0.7020318508148193
Epoch: 3, Steps: 131 | Train Loss: 0.4503757 Vali Loss: 0.2865145 Best vali loss: 0.2779284
	iters: 100, epoch: 4 | loss: 0.4348877
	speed: 0.0086s/iter; left time: 4.7843s
Updating learning rate to 0.000262385429
Epoch: 4 cost time: 0.6980879306793213
Epoch: 4, Steps: 131 | Train Loss: 0.4348877 Vali Loss: 0.2930489 Best vali loss: 0.2779284
	iters: 100, epoch: 5 | loss: 0.3055099
	speed: 0.0087s/iter; left time: 3.7040s
Updating learning rate to 0.00016197487242769343
Epoch: 5 cost time: 0.7006666660308838
Epoch: 5, Steps: 131 | Train Loss: 0.3055099 Vali Loss: 0.2852707 Best vali loss: 0.2779284
	iters: 100, epoch: 6 | loss: 0.2660872
	speed: 0.0087s/iter; left time: 2.5469s
Updating learning rate to 7.685091286955862e-05
Epoch: 6 cost time: 0.6966772079467773
Epoch: 6, Steps: 131 | Train Loss: 0.2660872 Vali Loss: 0.2930589 Best vali loss: 0.2779284
	iters: 100, epoch: 7 | loss: 0.2471053
	speed: 0.0086s/iter; left time: 1.3973s
Updating learning rate to 1.997290151770658e-05
Epoch: 7 cost time: 0.6926298141479492
Epoch: 7, Steps: 131 | Train Loss: 0.2471053 Vali Loss: 0.2980519 Best vali loss: 0.2779284
	iters: 100, epoch: 8 | loss: 0.2889504
	speed: 0.0087s/iter; left time: 0.2769s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6958990097045898
Epoch: 8, Steps: 131 | Train Loss: 0.2889504 Vali Loss: 0.3017673 Best vali loss: 0.2779284

best validation loss 0.2779284089460121

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0096224997413, 'e_layers': 2, 'learning_rate': 0.000524080885, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5907629
	speed: 0.0104s/iter; left time: 9.8661s
Updating learning rate to 0.0005041342440159507
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 0.935619592666626
Epoch: 1, Steps: 131 | Train Loss: 0.5907629 Vali Loss: 0.2803051 Best vali loss: 0.2803051
	iters: 100, epoch: 2 | loss: 0.3273571
	speed: 0.0089s/iter; left time: 7.2936s
Updating learning rate to 0.0004473310163368736
Epoch: 2 cost time: 0.6994655132293701
Epoch: 2, Steps: 131 | Train Loss: 0.3273571 Vali Loss: 0.2881169 Best vali loss: 0.2803051
	iters: 100, epoch: 3 | loss: 0.4561406
	speed: 0.0087s/iter; left time: 5.9888s
Updating learning rate to 0.000362318978454367
Epoch: 3 cost time: 0.7039926052093506
Epoch: 3, Steps: 131 | Train Loss: 0.4561406 Vali Loss: 0.2816615 Best vali loss: 0.2803051
	iters: 100, epoch: 4 | loss: 0.4363686
	speed: 0.0086s/iter; left time: 4.7560s
Updating learning rate to 0.0002620404425
Epoch: 4 cost time: 0.6953525543212891
Epoch: 4, Steps: 131 | Train Loss: 0.4363686 Vali Loss: 0.2815270 Best vali loss: 0.2803051
	iters: 100, epoch: 5 | loss: 0.2977363
	speed: 0.0087s/iter; left time: 3.7019s
Updating learning rate to 0.0001617619065456331
Epoch: 5 cost time: 0.699138879776001
Epoch: 5, Steps: 131 | Train Loss: 0.2977363 Vali Loss: 0.2862647 Best vali loss: 0.2803051
	iters: 100, epoch: 6 | loss: 0.2688963
	speed: 0.0085s/iter; left time: 2.5070s
Updating learning rate to 7.674986866312644e-05
Epoch: 6 cost time: 0.6942727565765381
Epoch: 6, Steps: 131 | Train Loss: 0.2688963 Vali Loss: 0.2936283 Best vali loss: 0.2803051
	iters: 100, epoch: 7 | loss: 0.2460135
	speed: 0.0086s/iter; left time: 1.3956s
Updating learning rate to 1.9946640984049287e-05
Epoch: 7 cost time: 0.6955113410949707
Epoch: 7, Steps: 131 | Train Loss: 0.2460135 Vali Loss: 0.3003459 Best vali loss: 0.2803051
	iters: 100, epoch: 8 | loss: 0.2791466
	speed: 0.0088s/iter; left time: 0.2804s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.703937292098999
Epoch: 8, Steps: 131 | Train Loss: 0.2791466 Vali Loss: 0.3010910 Best vali loss: 0.2803051

best validation loss 0.28030512195153945

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0090148020211, 'e_layers': 2, 'learning_rate': 0.0005134007949, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5917478
	speed: 0.0105s/iter; left time: 9.9278s
Updating learning rate to 0.0004938606406415675
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 0.920569658279419
Epoch: 1, Steps: 131 | Train Loss: 0.5917478 Vali Loss: 0.2822896 Best vali loss: 0.2822896
	iters: 100, epoch: 2 | loss: 0.3167495
	speed: 0.0089s/iter; left time: 7.2915s
Updating learning rate to 0.00043821498922017694
Epoch: 2 cost time: 0.709805965423584
Epoch: 2, Steps: 131 | Train Loss: 0.3167495 Vali Loss: 0.2892812 Best vali loss: 0.2822896
	iters: 100, epoch: 3 | loss: 0.4624446
	speed: 0.0086s/iter; left time: 5.8990s
Updating learning rate to 0.00035493538663564875
Epoch: 3 cost time: 0.6989586353302002
Epoch: 3, Steps: 131 | Train Loss: 0.4624446 Vali Loss: 0.2897715 Best vali loss: 0.2822896

best validation loss 0.2822896301657704

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002344908271, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597159
	speed: 0.0107s/iter; left time: 10.1255s
Updating learning rate to 0.0002344908271
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9405937194824219
Epoch: 1, Steps: 131 | Train Loss: 0.5597159 Vali Loss: 0.2756370 Best vali loss: 0.2756370
	iters: 100, epoch: 2 | loss: 0.3251950
	speed: 0.0088s/iter; left time: 7.2265s
Updating learning rate to 0.00011724541355
Validation loss decreased (0.2756 --> 0.2696).  Saving model state dict ...
Epoch: 2 cost time: 0.6947934627532959
Epoch: 2, Steps: 131 | Train Loss: 0.3251950 Vali Loss: 0.2695805 Best vali loss: 0.2695805
	iters: 100, epoch: 3 | loss: 0.4655302
	speed: 0.0089s/iter; left time: 6.0821s
Updating learning rate to 5.8622706775e-05
Epoch: 3 cost time: 0.6953351497650146
Epoch: 3, Steps: 131 | Train Loss: 0.4655302 Vali Loss: 0.2759022 Best vali loss: 0.2695805

best validation loss 0.2695805165305728

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266899409, 'e_layers': 2, 'learning_rate': 0.0002356369109, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5598506
	speed: 0.0106s/iter; left time: 10.0378s
Updating learning rate to 0.0002356369109
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.93564772605896
Epoch: 1, Steps: 131 | Train Loss: 0.5598506 Vali Loss: 0.2756273 Best vali loss: 0.2756273
	iters: 100, epoch: 2 | loss: 0.3243192
	speed: 0.0088s/iter; left time: 7.1986s
Updating learning rate to 0.00011781845545
Validation loss decreased (0.2756 --> 0.2692).  Saving model state dict ...
Epoch: 2 cost time: 0.6924409866333008
Epoch: 2, Steps: 131 | Train Loss: 0.3243192 Vali Loss: 0.2692396 Best vali loss: 0.2692396
	iters: 100, epoch: 3 | loss: 0.4640512
	speed: 0.0089s/iter; left time: 6.1047s
Updating learning rate to 5.8909227725e-05
Epoch: 3 cost time: 0.7061142921447754
Epoch: 3, Steps: 131 | Train Loss: 0.4640512 Vali Loss: 0.2816041 Best vali loss: 0.2692396

best validation loss 0.26923960473910724

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266899409, 'e_layers': 2, 'learning_rate': 0.0002356369109, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4153127
	speed: 0.0106s/iter; left time: 5.9140s
Updating learning rate to 2.94546138625e-05
Epoch: 4 cost time: 0.9207441806793213
Epoch: 4, Steps: 131 | Train Loss: 0.4153127 Vali Loss: 0.3092358 Best vali loss: 0.2692396
	iters: 100, epoch: 5 | loss: 0.2803534
	speed: 0.0087s/iter; left time: 3.7029s
Updating learning rate to 1.472730693125e-05
Epoch: 5 cost time: 0.6952567100524902
Epoch: 5, Steps: 131 | Train Loss: 0.2803534 Vali Loss: 0.2949586 Best vali loss: 0.2692396
	iters: 100, epoch: 6 | loss: 0.4325967
	speed: 0.0086s/iter; left time: 2.5400s
Updating learning rate to 7.363653465625e-06
Epoch: 6 cost time: 0.697288990020752
Epoch: 6, Steps: 131 | Train Loss: 0.4325967 Vali Loss: 0.3018491 Best vali loss: 0.2692396
	iters: 100, epoch: 7 | loss: 0.4661662
	speed: 0.0086s/iter; left time: 1.3964s
Updating learning rate to 3.6818267328125e-06
Epoch: 7 cost time: 0.6925885677337646
Epoch: 7, Steps: 131 | Train Loss: 0.4661662 Vali Loss: 0.2997919 Best vali loss: 0.2692396
	iters: 100, epoch: 8 | loss: 0.3253458
	speed: 0.0086s/iter; left time: 0.2761s
Updating learning rate to 1.84091336640625e-06
Epoch: 8 cost time: 0.7007958889007568
Epoch: 8, Steps: 131 | Train Loss: 0.3253458 Vali Loss: 0.2957456 Best vali loss: 0.2692396

best validation loss 0.26923960473910724

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.00302789563, 'e_layers': 2, 'learning_rate': 0.0010235006768, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3306749
	speed: 0.0081s/iter; left time: 67.1630s
	iters: 200, epoch: 1 | loss: 1.4738166
	speed: 0.0030s/iter; left time: 24.2795s
	iters: 300, epoch: 1 | loss: 1.2059512
	speed: 0.0029s/iter; left time: 23.3217s
	iters: 400, epoch: 1 | loss: 0.1475116
	speed: 0.0029s/iter; left time: 23.0442s
	iters: 500, epoch: 1 | loss: 0.3003748
	speed: 0.0029s/iter; left time: 22.8455s
	iters: 600, epoch: 1 | loss: 0.3052330
	speed: 0.0029s/iter; left time: 22.7799s
	iters: 700, epoch: 1 | loss: 1.9268069
	speed: 0.0030s/iter; left time: 22.7506s
	iters: 800, epoch: 1 | loss: 1.3246131
	speed: 0.0031s/iter; left time: 23.5690s
	iters: 900, epoch: 1 | loss: 0.3574230
	speed: 0.0030s/iter; left time: 22.3116s
	iters: 1000, epoch: 1 | loss: 0.3387292
	speed: 0.0028s/iter; left time: 20.9715s
Updating learning rate to 0.0009845460018034849
Validation loss decreased (inf --> 0.3248).  Saving model state dict ...
Epoch: 1 cost time: 3.327476739883423
Epoch: 1, Steps: 1045 | Train Loss: 0.7711134 Vali Loss: 0.3248397 Best vali loss: 0.3248397
	iters: 100, epoch: 2 | loss: 0.1892060
	speed: 0.0101s/iter; left time: 72.7134s
	iters: 200, epoch: 2 | loss: 0.1645396
	speed: 0.0032s/iter; left time: 22.7412s
	iters: 300, epoch: 2 | loss: 0.6543642
	speed: 0.0031s/iter; left time: 21.4057s
	iters: 400, epoch: 2 | loss: 0.2859275
	speed: 0.0030s/iter; left time: 20.9704s
	iters: 500, epoch: 2 | loss: 0.7194110
	speed: 0.0030s/iter; left time: 20.6854s
	iters: 600, epoch: 2 | loss: 0.6786465
	speed: 0.0033s/iter; left time: 22.3389s
	iters: 700, epoch: 2 | loss: 0.2783759
	speed: 0.0033s/iter; left time: 22.1228s
	iters: 800, epoch: 2 | loss: 0.3425595
	speed: 0.0033s/iter; left time: 21.5913s
	iters: 900, epoch: 2 | loss: 0.5024844
	speed: 0.0033s/iter; left time: 21.0120s
	iters: 1000, epoch: 2 | loss: 0.4667958
	speed: 0.0033s/iter; left time: 21.0501s
Updating learning rate to 0.0008736124729571505
Validation loss decreased (0.3248 --> 0.3002).  Saving model state dict ...
Epoch: 2 cost time: 3.4135820865631104
Epoch: 2, Steps: 1045 | Train Loss: 0.4282310 Vali Loss: 0.3001582 Best vali loss: 0.3001582
	iters: 100, epoch: 3 | loss: 0.1857846
	speed: 0.0104s/iter; left time: 64.1747s
	iters: 200, epoch: 3 | loss: 0.3580440
	speed: 0.0033s/iter; left time: 20.2963s
	iters: 300, epoch: 3 | loss: 0.2813613
	speed: 0.0033s/iter; left time: 19.9818s
	iters: 400, epoch: 3 | loss: 0.2518984
	speed: 0.0033s/iter; left time: 19.5681s
	iters: 500, epoch: 3 | loss: 0.3505135
	speed: 0.0033s/iter; left time: 19.0309s
	iters: 600, epoch: 3 | loss: 0.4785925
	speed: 0.0033s/iter; left time: 18.7692s
	iters: 700, epoch: 3 | loss: 1.4859431
	speed: 0.0034s/iter; left time: 19.1403s
	iters: 800, epoch: 3 | loss: 0.9919950
	speed: 0.0034s/iter; left time: 18.5988s
	iters: 900, epoch: 3 | loss: 1.1497433
	speed: 0.0034s/iter; left time: 18.0948s
	iters: 1000, epoch: 3 | loss: 0.3711764
	speed: 0.0034s/iter; left time: 18.0481s
Updating learning rate to 0.0007075887144129083
Epoch: 3 cost time: 3.5539426803588867
Epoch: 3, Steps: 1045 | Train Loss: 0.5905052 Vali Loss: 0.3079945 Best vali loss: 0.3001582
	iters: 100, epoch: 4 | loss: 1.4085990
	speed: 0.0101s/iter; left time: 51.9632s
	iters: 200, epoch: 4 | loss: 0.7010719
	speed: 0.0033s/iter; left time: 16.7853s
	iters: 300, epoch: 4 | loss: 0.2243967
	speed: 0.0034s/iter; left time: 16.5874s
	iters: 400, epoch: 4 | loss: 0.5687509
	speed: 0.0033s/iter; left time: 16.0604s
	iters: 500, epoch: 4 | loss: 0.3371009
	speed: 0.0033s/iter; left time: 15.6711s
	iters: 600, epoch: 4 | loss: 0.5493548
	speed: 0.0029s/iter; left time: 13.6096s
	iters: 700, epoch: 4 | loss: 0.3481388
	speed: 0.0030s/iter; left time: 13.4533s
	iters: 800, epoch: 4 | loss: 2.1555214
	speed: 0.0029s/iter; left time: 12.7908s
	iters: 900, epoch: 4 | loss: 0.3273541
	speed: 0.0031s/iter; left time: 13.2701s
	iters: 1000, epoch: 4 | loss: 0.9484384
	speed: 0.0031s/iter; left time: 12.9299s
Updating learning rate to 0.0005117503384
Epoch: 4 cost time: 3.3194098472595215
Epoch: 4, Steps: 1045 | Train Loss: 0.7568727 Vali Loss: 0.3102710 Best vali loss: 0.3001582
	iters: 100, epoch: 5 | loss: 0.5207201
	speed: 0.0096s/iter; left time: 39.0763s
	iters: 200, epoch: 5 | loss: 0.3187556
	speed: 0.0031s/iter; left time: 12.2923s
	iters: 300, epoch: 5 | loss: 0.4466039
	speed: 0.0031s/iter; left time: 11.9198s
	iters: 400, epoch: 5 | loss: 0.3602767
	speed: 0.0032s/iter; left time: 11.9127s
	iters: 500, epoch: 5 | loss: 0.2576645
	speed: 0.0031s/iter; left time: 11.2602s
	iters: 600, epoch: 5 | loss: 0.5168414
	speed: 0.0031s/iter; left time: 10.9900s
	iters: 700, epoch: 5 | loss: 1.0334662
	speed: 0.0031s/iter; left time: 10.7531s
	iters: 800, epoch: 5 | loss: 0.3264718
	speed: 0.0031s/iter; left time: 10.4583s
	iters: 900, epoch: 5 | loss: 0.3388595
	speed: 0.0031s/iter; left time: 10.1044s
	iters: 1000, epoch: 5 | loss: 0.5224218
	speed: 0.0031s/iter; left time: 9.7882s
Updating learning rate to 0.00031591196238709183
Epoch: 5 cost time: 3.260876178741455
Epoch: 5, Steps: 1045 | Train Loss: 0.4642081 Vali Loss: 0.3016918 Best vali loss: 0.3001582
	iters: 100, epoch: 6 | loss: 0.6593295
	speed: 0.0100s/iter; left time: 30.4638s
	iters: 200, epoch: 6 | loss: 0.1421539
	speed: 0.0033s/iter; left time: 9.7954s
	iters: 300, epoch: 6 | loss: 0.2904195
	speed: 0.0033s/iter; left time: 9.4571s
	iters: 400, epoch: 6 | loss: 1.6489131
	speed: 0.0033s/iter; left time: 9.1375s
	iters: 500, epoch: 6 | loss: 0.3883290
	speed: 0.0033s/iter; left time: 8.7778s
	iters: 600, epoch: 6 | loss: 0.4488525
	speed: 0.0034s/iter; left time: 8.5603s
	iters: 700, epoch: 6 | loss: 0.3004437
	speed: 0.0034s/iter; left time: 8.3333s
	iters: 800, epoch: 6 | loss: 0.2579335
	speed: 0.0029s/iter; left time: 6.6627s
	iters: 900, epoch: 6 | loss: 0.4306738
	speed: 0.0029s/iter; left time: 6.3815s
	iters: 1000, epoch: 6 | loss: 1.1188941
	speed: 0.0029s/iter; left time: 6.1491s
Updating learning rate to 0.0001498882038428496
Epoch: 6 cost time: 3.369476556777954
Epoch: 6, Steps: 1045 | Train Loss: 0.5685943 Vali Loss: 0.3013725 Best vali loss: 0.3001582
	iters: 100, epoch: 7 | loss: 0.6820726
	speed: 0.0098s/iter; left time: 19.5317s
	iters: 200, epoch: 7 | loss: 0.2445465
	speed: 0.0031s/iter; left time: 5.8485s
	iters: 300, epoch: 7 | loss: 0.9967678
	speed: 0.0030s/iter; left time: 5.4606s
	iters: 400, epoch: 7 | loss: 0.4831471
	speed: 0.0031s/iter; left time: 5.2707s
	iters: 500, epoch: 7 | loss: 0.4569917
	speed: 0.0031s/iter; left time: 4.8682s
	iters: 600, epoch: 7 | loss: 2.0468943
	speed: 0.0030s/iter; left time: 4.5413s
	iters: 700, epoch: 7 | loss: 0.3063191
	speed: 0.0030s/iter; left time: 4.2372s
	iters: 800, epoch: 7 | loss: 0.4975176
	speed: 0.0030s/iter; left time: 3.9324s
	iters: 900, epoch: 7 | loss: 1.4824607
	speed: 0.0030s/iter; left time: 3.6284s
	iters: 1000, epoch: 7 | loss: 0.2341086
	speed: 0.0030s/iter; left time: 3.3070s
Updating learning rate to 3.895467499651521e-05
Epoch: 7 cost time: 3.2404425144195557
Epoch: 7, Steps: 1045 | Train Loss: 0.7430826 Vali Loss: 0.3003527 Best vali loss: 0.3001582
	iters: 100, epoch: 8 | loss: 0.4690593
	speed: 0.0097s/iter; left time: 9.1958s
	iters: 200, epoch: 8 | loss: 0.5106547
	speed: 0.0031s/iter; left time: 2.6102s
	iters: 300, epoch: 8 | loss: 0.1753604
	speed: 0.0031s/iter; left time: 2.2801s
	iters: 400, epoch: 8 | loss: 0.1330616
	speed: 0.0031s/iter; left time: 1.9900s
	iters: 500, epoch: 8 | loss: 0.3565885
	speed: 0.0031s/iter; left time: 1.6735s
	iters: 600, epoch: 8 | loss: 0.4397471
	speed: 0.0031s/iter; left time: 1.3631s
	iters: 700, epoch: 8 | loss: 0.3016828
	speed: 0.0031s/iter; left time: 1.0593s
	iters: 800, epoch: 8 | loss: 0.7488959
	speed: 0.0031s/iter; left time: 0.7569s
	iters: 900, epoch: 8 | loss: 0.3001556
	speed: 0.0030s/iter; left time: 0.4437s
	iters: 1000, epoch: 8 | loss: 0.3007039
	speed: 0.0030s/iter; left time: 0.1395s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2344624996185303
Epoch: 8, Steps: 1045 | Train Loss: 0.3735910 Vali Loss: 0.3022114 Best vali loss: 0.3001582

best validation loss 0.3001581655088611

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019348698691, 'e_layers': 2, 'learning_rate': 0.001024292271, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5923622
	speed: 0.0104s/iter; left time: 9.8903s
Updating learning rate to 0.0009853074677432022
Validation loss decreased (inf --> 0.2969).  Saving model state dict ...
Epoch: 1 cost time: 0.9252350330352783
Epoch: 1, Steps: 131 | Train Loss: 0.5923622 Vali Loss: 0.2968876 Best vali loss: 0.2968876
	iters: 100, epoch: 2 | loss: 0.3636830
	speed: 0.0089s/iter; left time: 7.2607s
Updating learning rate to 0.0008742881408705344
Validation loss decreased (0.2969 --> 0.2930).  Saving model state dict ...
Epoch: 2 cost time: 0.7018709182739258
Epoch: 2, Steps: 131 | Train Loss: 0.3636830 Vali Loss: 0.2930058 Best vali loss: 0.2930058
	iters: 100, epoch: 3 | loss: 0.5147539
	speed: 0.0090s/iter; left time: 6.2042s
Updating learning rate to 0.0007081359765056564
Epoch: 3 cost time: 0.698230504989624
Epoch: 3, Steps: 131 | Train Loss: 0.5147539 Vali Loss: 0.3058235 Best vali loss: 0.2930058
	iters: 100, epoch: 4 | loss: 0.5693390
	speed: 0.0087s/iter; left time: 4.8107s
Updating learning rate to 0.0005121461355
Epoch: 4 cost time: 0.6980950832366943
Epoch: 4, Steps: 131 | Train Loss: 0.5693390 Vali Loss: 0.2980758 Best vali loss: 0.2930058
	iters: 100, epoch: 5 | loss: 0.3490652
	speed: 0.0087s/iter; left time: 3.6927s
Updating learning rate to 0.0003161562944943437
Epoch: 5 cost time: 0.7055749893188477
Epoch: 5, Steps: 131 | Train Loss: 0.3490652 Vali Loss: 0.3045387 Best vali loss: 0.2930058
	iters: 100, epoch: 6 | loss: 0.3338570
	speed: 0.0088s/iter; left time: 2.5838s
Updating learning rate to 0.0001500041301294656
Epoch: 6 cost time: 0.703284502029419
Epoch: 6, Steps: 131 | Train Loss: 0.3338570 Vali Loss: 0.3193561 Best vali loss: 0.2930058
	iters: 100, epoch: 7 | loss: 0.3185450
	speed: 0.0088s/iter; left time: 1.4304s
Updating learning rate to 3.898480325679789e-05
Epoch: 7 cost time: 0.7119166851043701
Epoch: 7, Steps: 131 | Train Loss: 0.3185450 Vali Loss: 0.3220310 Best vali loss: 0.2930058
	iters: 100, epoch: 8 | loss: 0.3806169
	speed: 0.0087s/iter; left time: 0.2795s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7040095329284668
Epoch: 8, Steps: 131 | Train Loss: 0.3806169 Vali Loss: 0.3221846 Best vali loss: 0.2930058

best validation loss 0.2930058180155387

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008591282482, 'e_layers': 2, 'learning_rate': 0.0004606395996, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00044310754876731716
Validation loss decreased (inf --> 0.2768).  Saving model state dict ...
Epoch: 1 cost time: 0.7756361961364746
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2768346 Best vali loss: 0.2768346
Updating learning rate to 0.000393180492080108
Epoch: 2 cost time: 0.5469951629638672
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2909254 Best vali loss: 0.2768346
Updating learning rate to 0.00031845937132910434
Epoch: 3 cost time: 0.5454177856445312
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2846563 Best vali loss: 0.2768346

best validation loss 0.27683462846474205

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.001348127381, 'e_layers': 4, 'learning_rate': 0.0010614447698, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9455652
	speed: 0.0154s/iter; left time: 14.6145s
Updating learning rate to 0.0010210459337546872
Validation loss decreased (inf --> 0.3087).  Saving model state dict ...
Epoch: 1 cost time: 1.567643404006958
Epoch: 1, Steps: 131 | Train Loss: 0.9455652 Vali Loss: 0.3087074 Best vali loss: 0.3087074
	iters: 100, epoch: 2 | loss: 0.4237131
	speed: 0.0160s/iter; left time: 13.0817s
Updating learning rate to 0.0009059997821902868
Validation loss decreased (0.3087 --> 0.3034).  Saving model state dict ...
Epoch: 2 cost time: 1.3360679149627686
Epoch: 2, Steps: 131 | Train Loss: 0.4237131 Vali Loss: 0.3034294 Best vali loss: 0.3034294
	iters: 100, epoch: 3 | loss: 0.5283890
	speed: 0.0162s/iter; left time: 11.1163s
Updating learning rate to 0.0007338210487865183
Epoch: 3 cost time: 1.3232274055480957
Epoch: 3, Steps: 131 | Train Loss: 0.5283890 Vali Loss: 0.3106502 Best vali loss: 0.3034294

best validation loss 0.3034293677819932

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0011591756046, 'e_layers': 2, 'learning_rate': 0.0010777390153, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6864412
	speed: 0.0100s/iter; left time: 9.5259s
Updating learning rate to 0.0010367200164622694
Validation loss decreased (inf --> 0.3025).  Saving model state dict ...
Epoch: 1 cost time: 0.8551709651947021
Epoch: 1, Steps: 131 | Train Loss: 0.6864412 Vali Loss: 0.3025445 Best vali loss: 0.3025445
	iters: 100, epoch: 2 | loss: 0.6201110
	speed: 0.0072s/iter; left time: 5.8905s
Updating learning rate to 0.0009199077906839712
Validation loss decreased (0.3025 --> 0.2933).  Saving model state dict ...
Epoch: 2 cost time: 0.5407915115356445
Epoch: 2, Steps: 131 | Train Loss: 0.6201110 Vali Loss: 0.2933032 Best vali loss: 0.2933032
	iters: 100, epoch: 3 | loss: 0.5357741
	speed: 0.0075s/iter; left time: 5.1284s
Updating learning rate to 0.0007450859404343881
Epoch: 3 cost time: 0.588268518447876
Epoch: 3, Steps: 131 | Train Loss: 0.5357741 Vali Loss: 0.2996983 Best vali loss: 0.2933032

best validation loss 0.2933032494654838

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008591282482, 'e_layers': 2, 'learning_rate': 0.0004606395996, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002303197998
Epoch: 4 cost time: 0.7755131721496582
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3056504 Best vali loss: 0.2768346
Updating learning rate to 0.0001421802282708957
Epoch: 5 cost time: 0.5475044250488281
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2895967 Best vali loss: 0.2768346
Updating learning rate to 6.745910751989199e-05
Epoch: 6 cost time: 0.5504639148712158
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2883829 Best vali loss: 0.2768346
Updating learning rate to 1.7532050832682848e-05
Epoch: 7 cost time: 0.5521595478057861
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2848614 Best vali loss: 0.2768346
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5474107265472412
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2879210 Best vali loss: 0.2768346

best validation loss 0.27683462846474205

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029620282956, 'e_layers': 4, 'learning_rate': 0.0010501148649, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2053399
	speed: 0.0105s/iter; left time: 86.7011s
	iters: 200, epoch: 1 | loss: 0.3586387
	speed: 0.0052s/iter; left time: 42.2586s
	iters: 300, epoch: 1 | loss: 0.7040663
	speed: 0.0052s/iter; left time: 41.9313s
	iters: 400, epoch: 1 | loss: 1.3095329
	speed: 0.0052s/iter; left time: 41.2427s
	iters: 500, epoch: 1 | loss: 0.6367137
	speed: 0.0050s/iter; left time: 39.1972s
	iters: 600, epoch: 1 | loss: 0.4389529
	speed: 0.0049s/iter; left time: 37.7412s
	iters: 700, epoch: 1 | loss: 1.0223507
	speed: 0.0048s/iter; left time: 37.1019s
	iters: 800, epoch: 1 | loss: 0.3466797
	speed: 0.0048s/iter; left time: 36.6391s
	iters: 900, epoch: 1 | loss: 0.3267910
	speed: 0.0049s/iter; left time: 36.5516s
	iters: 1000, epoch: 1 | loss: 0.3413433
	speed: 0.0047s/iter; left time: 34.4088s
Updating learning rate to 0.0010101472476834825
Validation loss decreased (inf --> 0.3530).  Saving model state dict ...
Epoch: 1 cost time: 5.4571146965026855
Epoch: 1, Steps: 1045 | Train Loss: 0.6690409 Vali Loss: 0.3530089 Best vali loss: 0.3530089
	iters: 100, epoch: 2 | loss: 0.3055788
	speed: 0.0134s/iter; left time: 96.8043s
	iters: 200, epoch: 2 | loss: 0.8277534
	speed: 0.0045s/iter; left time: 31.8274s
	iters: 300, epoch: 2 | loss: 1.2764295
	speed: 0.0045s/iter; left time: 31.4233s
	iters: 400, epoch: 2 | loss: 1.1848552
	speed: 0.0045s/iter; left time: 31.0255s
	iters: 500, epoch: 2 | loss: 1.3032924
	speed: 0.0045s/iter; left time: 30.4314s
	iters: 600, epoch: 2 | loss: 0.2711942
	speed: 0.0045s/iter; left time: 30.2081s
	iters: 700, epoch: 2 | loss: 0.6299829
	speed: 0.0045s/iter; left time: 29.6561s
	iters: 800, epoch: 2 | loss: 0.2274633
	speed: 0.0045s/iter; left time: 29.2743s
	iters: 900, epoch: 2 | loss: 0.2615336
	speed: 0.0045s/iter; left time: 28.6568s
	iters: 1000, epoch: 2 | loss: 0.6563016
	speed: 0.0044s/iter; left time: 28.0799s
Updating learning rate to 0.0008963291034477925
Validation loss decreased (0.3530 --> 0.3257).  Saving model state dict ...
Epoch: 2 cost time: 4.718963146209717
Epoch: 2, Steps: 1045 | Train Loss: 0.6944385 Vali Loss: 0.3256644 Best vali loss: 0.3256644
	iters: 100, epoch: 3 | loss: 0.3505041
	speed: 0.0144s/iter; left time: 88.6984s
	iters: 200, epoch: 3 | loss: 1.1879729
	speed: 0.0051s/iter; left time: 30.9729s
	iters: 300, epoch: 3 | loss: 0.6948307
	speed: 0.0051s/iter; left time: 30.5237s
	iters: 400, epoch: 3 | loss: 0.4770170
	speed: 0.0051s/iter; left time: 29.8755s
	iters: 500, epoch: 3 | loss: 0.3136328
	speed: 0.0051s/iter; left time: 29.3040s
	iters: 600, epoch: 3 | loss: 0.3084058
	speed: 0.0051s/iter; left time: 28.8696s
	iters: 700, epoch: 3 | loss: 0.3764568
	speed: 0.0051s/iter; left time: 28.5788s
	iters: 800, epoch: 3 | loss: 0.2929226
	speed: 0.0051s/iter; left time: 28.0170s
	iters: 900, epoch: 3 | loss: 0.3971445
	speed: 0.0051s/iter; left time: 27.4815s
	iters: 1000, epoch: 3 | loss: 0.1772041
	speed: 0.0051s/iter; left time: 26.9474s
Updating learning rate to 0.0007259882128887673
Validation loss decreased (0.3257 --> 0.3207).  Saving model state dict ...
Epoch: 3 cost time: 5.380283355712891
Epoch: 3, Steps: 1045 | Train Loss: 0.4576091 Vali Loss: 0.3207331 Best vali loss: 0.3207331
	iters: 100, epoch: 4 | loss: 0.4238130
	speed: 0.0146s/iter; left time: 74.7298s
	iters: 200, epoch: 4 | loss: 0.4645935
	speed: 0.0052s/iter; left time: 25.9977s
	iters: 300, epoch: 4 | loss: 0.2723876
	speed: 0.0052s/iter; left time: 25.5733s
	iters: 400, epoch: 4 | loss: 1.2451428
	speed: 0.0052s/iter; left time: 25.0220s
	iters: 500, epoch: 4 | loss: 0.6433235
	speed: 0.0052s/iter; left time: 24.3562s
	iters: 600, epoch: 4 | loss: 0.3587976
	speed: 0.0052s/iter; left time: 23.8540s
	iters: 700, epoch: 4 | loss: 1.1288787
	speed: 0.0052s/iter; left time: 23.5585s
	iters: 800, epoch: 4 | loss: 0.2854899
	speed: 0.0052s/iter; left time: 22.8625s
	iters: 900, epoch: 4 | loss: 1.4887992
	speed: 0.0052s/iter; left time: 22.5327s
	iters: 1000, epoch: 4 | loss: 0.2831427
	speed: 0.0051s/iter; left time: 21.6431s
Updating learning rate to 0.00052505743245
Epoch: 4 cost time: 5.44814658164978
Epoch: 4, Steps: 1045 | Train Loss: 0.6594369 Vali Loss: 0.3218883 Best vali loss: 0.3207331
	iters: 100, epoch: 5 | loss: 1.4016157
	speed: 0.0140s/iter; left time: 57.2552s
	iters: 200, epoch: 5 | loss: 0.5419017
	speed: 0.0050s/iter; left time: 20.0661s
	iters: 300, epoch: 5 | loss: 0.3266385
	speed: 0.0052s/iter; left time: 20.1113s
	iters: 400, epoch: 5 | loss: 0.8245682
	speed: 0.0051s/iter; left time: 19.4334s
	iters: 500, epoch: 5 | loss: 0.3575951
	speed: 0.0052s/iter; left time: 19.0639s
	iters: 600, epoch: 5 | loss: 0.2223767
	speed: 0.0052s/iter; left time: 18.5487s
	iters: 700, epoch: 5 | loss: 0.7061056
	speed: 0.0052s/iter; left time: 17.9350s
	iters: 800, epoch: 5 | loss: 1.2451379
	speed: 0.0052s/iter; left time: 17.4396s
	iters: 900, epoch: 5 | loss: 0.2482228
	speed: 0.0052s/iter; left time: 16.9363s
	iters: 1000, epoch: 5 | loss: 0.2314337
	speed: 0.0052s/iter; left time: 16.4754s
Updating learning rate to 0.00032412665201123276
Epoch: 5 cost time: 5.411588430404663
Epoch: 5, Steps: 1045 | Train Loss: 0.6105596 Vali Loss: 0.3251012 Best vali loss: 0.3207331
	iters: 100, epoch: 6 | loss: 1.2348769
	speed: 0.0144s/iter; left time: 43.5692s
	iters: 200, epoch: 6 | loss: 0.3487209
	speed: 0.0052s/iter; left time: 15.1525s
	iters: 300, epoch: 6 | loss: 0.3519791
	speed: 0.0051s/iter; left time: 14.4882s
	iters: 400, epoch: 6 | loss: 0.2817511
	speed: 0.0051s/iter; left time: 13.9787s
	iters: 500, epoch: 6 | loss: 1.4250839
	speed: 0.0051s/iter; left time: 13.4731s
	iters: 600, epoch: 6 | loss: 0.2776279
	speed: 0.0051s/iter; left time: 13.0530s
	iters: 700, epoch: 6 | loss: 1.0570459
	speed: 0.0051s/iter; left time: 12.5308s
	iters: 800, epoch: 6 | loss: 0.9549572
	speed: 0.0051s/iter; left time: 11.8052s
	iters: 900, epoch: 6 | loss: 0.2890327
	speed: 0.0049s/iter; left time: 10.9859s
	iters: 1000, epoch: 6 | loss: 0.2598867
	speed: 0.0049s/iter; left time: 10.5434s
Updating learning rate to 0.00015378576145220742
Epoch: 6 cost time: 5.350263595581055
Epoch: 6, Steps: 1045 | Train Loss: 0.6480962 Vali Loss: 0.3208387 Best vali loss: 0.3207331
	iters: 100, epoch: 7 | loss: 0.4126029
	speed: 0.0142s/iter; left time: 28.2625s
	iters: 200, epoch: 7 | loss: 0.4376177
	speed: 0.0051s/iter; left time: 9.6847s
	iters: 300, epoch: 7 | loss: 0.2914983
	speed: 0.0051s/iter; left time: 9.0961s
	iters: 400, epoch: 7 | loss: 0.4400073
	speed: 0.0051s/iter; left time: 8.6433s
	iters: 500, epoch: 7 | loss: 1.2901530
	speed: 0.0051s/iter; left time: 8.0488s
	iters: 600, epoch: 7 | loss: 0.2298238
	speed: 0.0051s/iter; left time: 7.6774s
	iters: 700, epoch: 7 | loss: 1.8841877
	speed: 0.0051s/iter; left time: 7.0932s
	iters: 800, epoch: 7 | loss: 1.1238705
	speed: 0.0051s/iter; left time: 6.5342s
	iters: 900, epoch: 7 | loss: 0.4224515
	speed: 0.0051s/iter; left time: 6.0610s
	iters: 1000, epoch: 7 | loss: 0.5360248
	speed: 0.0051s/iter; left time: 5.5436s
Updating learning rate to 3.9967617216517484e-05
Epoch: 7 cost time: 5.3706278800964355
Epoch: 7, Steps: 1045 | Train Loss: 0.7068238 Vali Loss: 0.3221302 Best vali loss: 0.3207331
	iters: 100, epoch: 8 | loss: 0.1899429
	speed: 0.0141s/iter; left time: 13.3458s
	iters: 200, epoch: 8 | loss: 0.2463209
	speed: 0.0051s/iter; left time: 4.3179s
	iters: 300, epoch: 8 | loss: 0.3245729
	speed: 0.0051s/iter; left time: 3.8265s
	iters: 400, epoch: 8 | loss: 0.3071558
	speed: 0.0051s/iter; left time: 3.3049s
	iters: 500, epoch: 8 | loss: 1.4165570
	speed: 0.0047s/iter; left time: 2.5832s
	iters: 600, epoch: 8 | loss: 0.7542239
	speed: 0.0044s/iter; left time: 1.9794s
	iters: 700, epoch: 8 | loss: 0.3184976
	speed: 0.0044s/iter; left time: 1.5312s
	iters: 800, epoch: 8 | loss: 0.4463828
	speed: 0.0045s/iter; left time: 1.0987s
	iters: 900, epoch: 8 | loss: 1.1485448
	speed: 0.0045s/iter; left time: 0.6522s
	iters: 1000, epoch: 8 | loss: 0.4030963
	speed: 0.0044s/iter; left time: 0.2043s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.97397518157959
Epoch: 8, Steps: 1045 | Train Loss: 0.5555295 Vali Loss: 0.3220683 Best vali loss: 0.3207331

best validation loss 0.32073311184630954

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269744113, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597177
	speed: 0.0104s/iter; left time: 9.8936s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9274022579193115
Epoch: 1, Steps: 131 | Train Loss: 0.5597177 Vali Loss: 0.2756320 Best vali loss: 0.2756320
	iters: 100, epoch: 2 | loss: 0.3249262
	speed: 0.0089s/iter; left time: 7.2989s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2686).  Saving model state dict ...
Epoch: 2 cost time: 0.6981496810913086
Epoch: 2, Steps: 131 | Train Loss: 0.3249262 Vali Loss: 0.2685760 Best vali loss: 0.2685760
	iters: 100, epoch: 3 | loss: 0.4614208
	speed: 0.0088s/iter; left time: 6.0423s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.6949319839477539
Epoch: 3, Steps: 131 | Train Loss: 0.4614208 Vali Loss: 0.2762515 Best vali loss: 0.2685760
	iters: 100, epoch: 4 | loss: 0.5032542
	speed: 0.0085s/iter; left time: 4.7211s
Updating learning rate to 2.93167934875e-05
Epoch: 4 cost time: 0.6903104782104492
Epoch: 4, Steps: 131 | Train Loss: 0.5032542 Vali Loss: 0.2873762 Best vali loss: 0.2685760
	iters: 100, epoch: 5 | loss: 0.3343807
	speed: 0.0086s/iter; left time: 3.6604s
Updating learning rate to 1.465839674375e-05
Epoch: 5 cost time: 0.6985695362091064
Epoch: 5, Steps: 131 | Train Loss: 0.3343807 Vali Loss: 0.2852389 Best vali loss: 0.2685760
	iters: 100, epoch: 6 | loss: 0.3178844
	speed: 0.0085s/iter; left time: 2.5136s
Updating learning rate to 7.329198371875e-06
Epoch: 6 cost time: 0.6946895122528076
Epoch: 6, Steps: 131 | Train Loss: 0.3178844 Vali Loss: 0.2845012 Best vali loss: 0.2685760
	iters: 100, epoch: 7 | loss: 0.3120793
	speed: 0.0086s/iter; left time: 1.3969s
Updating learning rate to 3.6645991859375e-06
Epoch: 7 cost time: 0.6955676078796387
Epoch: 7, Steps: 131 | Train Loss: 0.3120793 Vali Loss: 0.2906099 Best vali loss: 0.2685760
	iters: 100, epoch: 8 | loss: 0.3968960
	speed: 0.0086s/iter; left time: 0.2746s
Updating learning rate to 1.83229959296875e-06
Epoch: 8 cost time: 0.6960151195526123
Epoch: 8, Steps: 131 | Train Loss: 0.3968960 Vali Loss: 0.2921039 Best vali loss: 0.2685760

best validation loss 0.26857602188426705

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002345436852, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597211
	speed: 0.0105s/iter; left time: 9.9186s
Updating learning rate to 0.0002256168977180252
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9243898391723633
Epoch: 1, Steps: 131 | Train Loss: 0.5597211 Vali Loss: 0.2756334 Best vali loss: 0.2756334
	iters: 100, epoch: 2 | loss: 0.3226328
	speed: 0.0088s/iter; left time: 7.2329s
Updating learning rate to 0.00020019555774470143
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.6979820728302002
Epoch: 2, Steps: 131 | Train Loss: 0.3226328 Vali Loss: 0.2689584 Best vali loss: 0.2689584
	iters: 100, epoch: 3 | loss: 0.4635731
	speed: 0.0091s/iter; left time: 6.2487s
Updating learning rate to 0.00016214983384594655
Epoch: 3 cost time: 0.710932731628418
Epoch: 3, Steps: 131 | Train Loss: 0.4635731 Vali Loss: 0.2762170 Best vali loss: 0.2689584

best validation loss 0.2689583512565468

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019486744244, 'e_layers': 4, 'learning_rate': 0.0031459671481, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6156379
	speed: 0.0125s/iter; left time: 11.8893s
Updating learning rate to 0.003026230903091247
Validation loss decreased (inf --> 0.3268).  Saving model state dict ...
Epoch: 1 cost time: 1.216768503189087
Epoch: 1, Steps: 131 | Train Loss: 0.6156379 Vali Loss: 0.3268111 Best vali loss: 0.3268111
	iters: 100, epoch: 2 | loss: 0.3490027
	speed: 0.0119s/iter; left time: 9.7126s
Updating learning rate to 0.002685250925955807
Validation loss decreased (0.3268 --> 0.3194).  Saving model state dict ...
Epoch: 2 cost time: 0.9879202842712402
Epoch: 2, Steps: 131 | Train Loss: 0.3490027 Vali Loss: 0.3194394 Best vali loss: 0.3194394
	iters: 100, epoch: 3 | loss: 0.5527812
	speed: 0.0119s/iter; left time: 8.1977s
Updating learning rate to 0.0021749383272213606
Epoch: 3 cost time: 0.9959878921508789
Epoch: 3, Steps: 131 | Train Loss: 0.5527812 Vali Loss: 0.3224045 Best vali loss: 0.3194394

best validation loss 0.31943940608729304

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0012063032305, 'e_layers': 4, 'learning_rate': 0.0002841259864, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3306399
	speed: 0.0110s/iter; left time: 44.9569s
	iters: 200, epoch: 1 | loss: 0.4534609
	speed: 0.0059s/iter; left time: 23.3736s
	iters: 300, epoch: 1 | loss: 0.4068874
	speed: 0.0058s/iter; left time: 22.5788s
	iters: 400, epoch: 1 | loss: 0.2024260
	speed: 0.0058s/iter; left time: 22.0540s
	iters: 500, epoch: 1 | loss: 0.2397663
	speed: 0.0058s/iter; left time: 21.4214s
Updating learning rate to 0.00027331208494477013
Validation loss decreased (inf --> 0.3127).  Saving model state dict ...
Epoch: 1 cost time: 3.3120720386505127
Epoch: 1, Steps: 523 | Train Loss: 0.3266361 Vali Loss: 0.3127019 Best vali loss: 0.3127019
	iters: 100, epoch: 2 | loss: 0.3197197
	speed: 0.0121s/iter; left time: 42.9820s
	iters: 200, epoch: 2 | loss: 0.2219667
	speed: 0.0057s/iter; left time: 19.9040s
	iters: 300, epoch: 2 | loss: 0.4524102
	speed: 0.0057s/iter; left time: 19.2783s
	iters: 400, epoch: 2 | loss: 0.3272430
	speed: 0.0058s/iter; left time: 18.8219s
	iters: 500, epoch: 2 | loss: 0.2850235
	speed: 0.0057s/iter; left time: 18.1214s
Updating learning rate to 0.0002425166990473784
Validation loss decreased (0.3127 --> 0.3005).  Saving model state dict ...
Epoch: 2 cost time: 3.046159029006958
Epoch: 2, Steps: 523 | Train Loss: 0.3212726 Vali Loss: 0.3004973 Best vali loss: 0.3004973
	iters: 100, epoch: 3 | loss: 0.8974048
	speed: 0.0123s/iter; left time: 37.4803s
	iters: 200, epoch: 3 | loss: 0.6015881
	speed: 0.0056s/iter; left time: 16.4825s
	iters: 300, epoch: 3 | loss: 0.3730106
	speed: 0.0056s/iter; left time: 15.9636s
	iters: 400, epoch: 3 | loss: 0.7840746
	speed: 0.0056s/iter; left time: 15.3636s
	iters: 500, epoch: 3 | loss: 0.1942753
	speed: 0.0056s/iter; left time: 14.8584s
Updating learning rate to 0.00019642814704983442
Validation loss decreased (0.3005 --> 0.2970).  Saving model state dict ...
Epoch: 3 cost time: 2.9780564308166504
Epoch: 3, Steps: 523 | Train Loss: 0.5700707 Vali Loss: 0.2970339 Best vali loss: 0.2970339

best validation loss 0.2970339060938017

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002345436852, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4203484
	speed: 0.0107s/iter; left time: 5.9367s
Updating learning rate to 0.0001172718426
Epoch: 4 cost time: 0.9397168159484863
Epoch: 4, Steps: 131 | Train Loss: 0.4203484 Vali Loss: 0.2817876 Best vali loss: 0.2689584
	iters: 100, epoch: 5 | loss: 0.2740405
	speed: 0.0088s/iter; left time: 3.7264s
Updating learning rate to 7.239385135405345e-05
Epoch: 5 cost time: 0.7043061256408691
Epoch: 5, Steps: 131 | Train Loss: 0.2740405 Vali Loss: 0.2940553 Best vali loss: 0.2689584
	iters: 100, epoch: 6 | loss: 0.3883237
	speed: 0.0087s/iter; left time: 2.5702s
Updating learning rate to 3.4348127455298564e-05
Epoch: 6 cost time: 0.7046082019805908
Epoch: 6, Steps: 131 | Train Loss: 0.3883237 Vali Loss: 0.2877750 Best vali loss: 0.2689584
	iters: 100, epoch: 7 | loss: 0.3976028
	speed: 0.0086s/iter; left time: 1.4023s
Updating learning rate to 8.926787481974798e-06
Epoch: 7 cost time: 0.6977076530456543
Epoch: 7, Steps: 131 | Train Loss: 0.3976028 Vali Loss: 0.2969285 Best vali loss: 0.2689584
	iters: 100, epoch: 8 | loss: 0.2986639
	speed: 0.0087s/iter; left time: 0.2798s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7023215293884277
Epoch: 8, Steps: 131 | Train Loss: 0.2986639 Vali Loss: 0.2988850 Best vali loss: 0.2689584

best validation loss 0.2689583512565468

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0014073254907, 'e_layers': 4, 'learning_rate': 0.0002848636337, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3304798
	speed: 0.0110s/iter; left time: 44.8485s
	iters: 200, epoch: 1 | loss: 0.4592178
	speed: 0.0058s/iter; left time: 22.9503s
	iters: 300, epoch: 1 | loss: 0.4076699
	speed: 0.0058s/iter; left time: 22.5101s
	iters: 400, epoch: 1 | loss: 0.2258319
	speed: 0.0058s/iter; left time: 21.9377s
	iters: 500, epoch: 1 | loss: 0.2366379
	speed: 0.0058s/iter; left time: 21.3727s
Updating learning rate to 0.00027402165721611123
Validation loss decreased (inf --> 0.3032).  Saving model state dict ...
Epoch: 1 cost time: 3.2929301261901855
Epoch: 1, Steps: 523 | Train Loss: 0.3319675 Vali Loss: 0.3032461 Best vali loss: 0.3032461
	iters: 100, epoch: 2 | loss: 0.3069184
	speed: 0.0122s/iter; left time: 43.5785s
	iters: 200, epoch: 2 | loss: 0.2146616
	speed: 0.0059s/iter; left time: 20.4868s
	iters: 300, epoch: 2 | loss: 0.4536916
	speed: 0.0059s/iter; left time: 19.8867s
	iters: 400, epoch: 2 | loss: 0.3381577
	speed: 0.0057s/iter; left time: 18.5068s
	iters: 500, epoch: 2 | loss: 0.2567522
	speed: 0.0057s/iter; left time: 18.0158s
Updating learning rate to 0.00024314632040135537
Validation loss decreased (0.3032 --> 0.2985).  Saving model state dict ...
Epoch: 2 cost time: 3.077592611312866
Epoch: 2, Steps: 523 | Train Loss: 0.3140363 Vali Loss: 0.2985122 Best vali loss: 0.2985122
	iters: 100, epoch: 3 | loss: 0.9853483
	speed: 0.0125s/iter; left time: 37.9678s
	iters: 200, epoch: 3 | loss: 0.5837272
	speed: 0.0058s/iter; left time: 16.9726s
	iters: 300, epoch: 3 | loss: 0.3584003
	speed: 0.0058s/iter; left time: 16.3940s
	iters: 400, epoch: 3 | loss: 0.8440073
	speed: 0.0058s/iter; left time: 15.8258s
	iters: 500, epoch: 3 | loss: 0.1877573
	speed: 0.0058s/iter; left time: 15.2512s
Updating learning rate to 0.00019693811340015387
Validation loss decreased (0.2985 --> 0.2905).  Saving model state dict ...
Epoch: 3 cost time: 3.060999631881714
Epoch: 3, Steps: 523 | Train Loss: 0.5918481 Vali Loss: 0.2905153 Best vali loss: 0.2905153
	iters: 100, epoch: 4 | loss: 0.3928121
	speed: 0.0124s/iter; left time: 31.1368s
	iters: 200, epoch: 4 | loss: 0.7175391
	speed: 0.0059s/iter; left time: 14.2556s
	iters: 300, epoch: 4 | loss: 0.2652928
	speed: 0.0060s/iter; left time: 13.7933s
	iters: 400, epoch: 4 | loss: 0.8722660
	speed: 0.0060s/iter; left time: 13.2379s
	iters: 500, epoch: 4 | loss: 0.2155511
	speed: 0.0059s/iter; left time: 12.5266s
Updating learning rate to 0.00014243181685
Epoch: 4 cost time: 3.127476692199707
Epoch: 4, Steps: 523 | Train Loss: 0.4926922 Vali Loss: 0.2935646 Best vali loss: 0.2905153
	iters: 100, epoch: 5 | loss: 0.3947354
	speed: 0.0120s/iter; left time: 23.8421s
	iters: 200, epoch: 5 | loss: 0.2140789
	speed: 0.0060s/iter; left time: 11.3136s
	iters: 300, epoch: 5 | loss: 0.3871781
	speed: 0.0059s/iter; left time: 10.6634s
	iters: 400, epoch: 5 | loss: 0.5033660
	speed: 0.0059s/iter; left time: 10.0277s
	iters: 500, epoch: 5 | loss: 0.3082634
	speed: 0.0059s/iter; left time: 9.4462s
Updating learning rate to 8.792552029984619e-05
Validation loss decreased (0.2905 --> 0.2868).  Saving model state dict ...
Epoch: 5 cost time: 3.1465671062469482
Epoch: 5, Steps: 523 | Train Loss: 0.3615244 Vali Loss: 0.2867761 Best vali loss: 0.2867761
	iters: 100, epoch: 6 | loss: 0.4031218
	speed: 0.0127s/iter; left time: 18.6013s
	iters: 200, epoch: 6 | loss: 0.2277258
	speed: 0.0057s/iter; left time: 7.8611s
	iters: 300, epoch: 6 | loss: 0.3931764
	speed: 0.0058s/iter; left time: 7.3935s
	iters: 400, epoch: 6 | loss: 0.4295227
	speed: 0.0058s/iter; left time: 6.7896s
	iters: 500, epoch: 6 | loss: 0.3953993
	speed: 0.0058s/iter; left time: 6.2023s
Updating learning rate to 4.171731329864465e-05
Epoch: 6 cost time: 3.0725045204162598
Epoch: 6, Steps: 523 | Train Loss: 0.3697892 Vali Loss: 0.3003211 Best vali loss: 0.2867761
	iters: 100, epoch: 7 | loss: 0.3793481
	speed: 0.0117s/iter; left time: 11.1026s
	iters: 200, epoch: 7 | loss: 0.3369003
	speed: 0.0057s/iter; left time: 4.8659s
	iters: 300, epoch: 7 | loss: 0.7281552
	speed: 0.0058s/iter; left time: 4.2981s
	iters: 400, epoch: 7 | loss: 0.2503628
	speed: 0.0058s/iter; left time: 3.7253s
	iters: 500, epoch: 7 | loss: 0.7325066
	speed: 0.0057s/iter; left time: 3.1369s
Updating learning rate to 1.0841976483888787e-05
Epoch: 7 cost time: 3.0474767684936523
Epoch: 7, Steps: 523 | Train Loss: 0.4854546 Vali Loss: 0.3020369 Best vali loss: 0.2867761
	iters: 100, epoch: 8 | loss: 0.2155193
	speed: 0.0115s/iter; left time: 4.8816s
	iters: 200, epoch: 8 | loss: 0.6487203
	speed: 0.0057s/iter; left time: 1.8364s
	iters: 300, epoch: 8 | loss: 0.5479903
	speed: 0.0058s/iter; left time: 1.2935s
	iters: 400, epoch: 8 | loss: 0.6769913
	speed: 0.0057s/iter; left time: 0.7125s
	iters: 500, epoch: 8 | loss: 0.3221975
	speed: 0.0058s/iter; left time: 0.1389s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.031374216079712
Epoch: 8, Steps: 523 | Train Loss: 0.4822838 Vali Loss: 0.2981667 Best vali loss: 0.2867761

best validation loss 0.2867760908962759

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0012616410432, 'e_layers': 2, 'learning_rate': 0.0005311312651, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005109162850013582
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 0.7844173908233643
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857981 Best vali loss: 0.2857981
Updating learning rate to 0.0004533488921761999
Validation loss decreased (0.2858 --> 0.2802).  Saving model state dict ...
Epoch: 2 cost time: 0.5779190063476562
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2802187 Best vali loss: 0.2802187
Updating learning rate to 0.00036719320033244023
Epoch: 3 cost time: 0.5740728378295898
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3007011 Best vali loss: 0.2802187
Updating learning rate to 0.00026556563255
Validation loss decreased (0.2802 --> 0.2745).  Saving model state dict ...
Epoch: 4 cost time: 0.5705704689025879
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2745090 Best vali loss: 0.2745090
Updating learning rate to 0.0001639380647675598
Epoch: 5 cost time: 0.5742042064666748
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2924407 Best vali loss: 0.2745090
Updating learning rate to 7.778237292380008e-05
Epoch: 6 cost time: 0.5697007179260254
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2917487 Best vali loss: 0.2745090
Updating learning rate to 2.0214980098641846e-05
Epoch: 7 cost time: 0.570181131362915
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2978695 Best vali loss: 0.2745090
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5743551254272461
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2997919 Best vali loss: 0.2745090

best validation loss 0.2745090144308538

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0008293996704, 'e_layers': 3, 'learning_rate': 0.0030642564317, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029476301156568497
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 0.5936927795410156
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2877608 Best vali loss: 0.2877608
Updating learning rate to 0.0026155064669247815
Validation loss decreased (0.2878 --> 0.2853).  Saving model state dict ...
Epoch: 2 cost time: 0.3579854965209961
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2852564 Best vali loss: 0.2852564
Updating learning rate to 0.002118448300314879
Epoch: 3 cost time: 0.39814305305480957
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2960745 Best vali loss: 0.2852564

best validation loss 0.28525639575580186

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0016879097128, 'e_layers': 3, 'learning_rate': 0.0031137894074, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5901828
	speed: 0.0102s/iter; left time: 9.6740s
Updating learning rate to 0.0029952778547236544
Validation loss decreased (inf --> 0.2956).  Saving model state dict ...
Epoch: 1 cost time: 0.8958175182342529
Epoch: 1, Steps: 131 | Train Loss: 0.5901828 Vali Loss: 0.2955866 Best vali loss: 0.2955866
	iters: 100, epoch: 2 | loss: 0.7189661
	speed: 0.0078s/iter; left time: 6.4020s
Updating learning rate to 0.0026577855062796907
Validation loss decreased (0.2956 --> 0.2870).  Saving model state dict ...
Epoch: 2 cost time: 0.6386048793792725
Epoch: 2, Steps: 131 | Train Loss: 0.7189661 Vali Loss: 0.2869988 Best vali loss: 0.2869988
	iters: 100, epoch: 3 | loss: 0.5997609
	speed: 0.0081s/iter; left time: 5.5987s
Updating learning rate to 0.0021526925127429456
Epoch: 3 cost time: 0.6769673824310303
Epoch: 3, Steps: 131 | Train Loss: 0.5997609 Vali Loss: 0.2911893 Best vali loss: 0.2869988

best validation loss 0.28699875847696593

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0017197136394, 'e_layers': 1, 'learning_rate': 6.04017787e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6493660
	speed: 0.0081s/iter; left time: 16.0971s
	iters: 200, epoch: 1 | loss: 0.4504638
	speed: 0.0027s/iter; left time: 5.1355s
Updating learning rate to 5.81028728841031e-05
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 0.9586753845214844
Epoch: 1, Steps: 262 | Train Loss: 0.5499149 Vali Loss: 0.2857073 Best vali loss: 0.2857073
	iters: 100, epoch: 2 | loss: 0.4955473
	speed: 0.0063s/iter; left time: 10.9296s
	iters: 200, epoch: 2 | loss: 0.4366932
	speed: 0.0025s/iter; left time: 4.0863s
Updating learning rate to 5.155614300724958e-05
Validation loss decreased (0.2857 --> 0.2804).  Saving model state dict ...
Epoch: 2 cost time: 0.7068660259246826
Epoch: 2, Steps: 262 | Train Loss: 0.4661202 Vali Loss: 0.2804033 Best vali loss: 0.2804033
	iters: 100, epoch: 3 | loss: 0.5241854
	speed: 0.0064s/iter; left time: 9.3947s
	iters: 200, epoch: 3 | loss: 0.5554149
	speed: 0.0025s/iter; left time: 3.3907s
Updating learning rate to 4.175826934693629e-05
Validation loss decreased (0.2804 --> 0.2797).  Saving model state dict ...
Epoch: 3 cost time: 0.705108642578125
Epoch: 3, Steps: 262 | Train Loss: 0.5398001 Vali Loss: 0.2797342 Best vali loss: 0.2797342

best validation loss 0.27973423658826174

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0017197136394, 'e_layers': 1, 'learning_rate': 6.04017787e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5677024
	speed: 0.0082s/iter; left time: 9.8854s
	iters: 200, epoch: 4 | loss: 0.4318305
	speed: 0.0027s/iter; left time: 3.0295s
Updating learning rate to 3.020088935e-05
Validation loss decreased (0.2797 --> 0.2783).  Saving model state dict ...
Epoch: 4 cost time: 0.9870338439941406
Epoch: 4, Steps: 262 | Train Loss: 0.4997664 Vali Loss: 0.2782504 Best vali loss: 0.2782504
	iters: 100, epoch: 5 | loss: 0.4707183
	speed: 0.0064s/iter; left time: 6.0919s
	iters: 200, epoch: 5 | loss: 0.4155311
	speed: 0.0025s/iter; left time: 2.1180s
Updating learning rate to 1.864350935306372e-05
Epoch: 5 cost time: 0.7023837566375732
Epoch: 5, Steps: 262 | Train Loss: 0.4431247 Vali Loss: 0.2788433 Best vali loss: 0.2782504
	iters: 100, epoch: 6 | loss: 0.5221439
	speed: 0.0063s/iter; left time: 4.3338s
	iters: 200, epoch: 6 | loss: 0.5296825
	speed: 0.0025s/iter; left time: 1.4891s
Updating learning rate to 8.845635692750419e-06
Epoch: 6 cost time: 0.7096874713897705
Epoch: 6, Steps: 262 | Train Loss: 0.5259132 Vali Loss: 0.2795318 Best vali loss: 0.2782504
	iters: 100, epoch: 7 | loss: 0.6964360
	speed: 0.0060s/iter; left time: 2.5535s
	iters: 200, epoch: 7 | loss: 0.3549513
	speed: 0.0025s/iter; left time: 0.7994s
Updating learning rate to 2.2989058158969017e-06
Epoch: 7 cost time: 0.6843457221984863
Epoch: 7, Steps: 262 | Train Loss: 0.5256937 Vali Loss: 0.2785863 Best vali loss: 0.2782504
	iters: 100, epoch: 8 | loss: 0.4490564
	speed: 0.0062s/iter; left time: 1.0083s
	iters: 200, epoch: 8 | loss: 0.3891796
	speed: 0.0023s/iter; left time: 0.1477s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6619582176208496
Epoch: 8, Steps: 262 | Train Loss: 0.4191180 Vali Loss: 0.2785553 Best vali loss: 0.2782504

best validation loss 0.2782504107261422

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345345781, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597187
	speed: 0.0105s/iter; left time: 9.9870s
Updating learning rate to 0.0002345345781
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.940577507019043
Epoch: 1, Steps: 131 | Train Loss: 0.5597187 Vali Loss: 0.2756370 Best vali loss: 0.2756370
	iters: 100, epoch: 2 | loss: 0.3253211
	speed: 0.0089s/iter; left time: 7.2896s
Updating learning rate to 0.00011726728905
Validation loss decreased (0.2756 --> 0.2679).  Saving model state dict ...
Epoch: 2 cost time: 0.7021880149841309
Epoch: 2, Steps: 131 | Train Loss: 0.3253211 Vali Loss: 0.2678756 Best vali loss: 0.2678756
	iters: 100, epoch: 3 | loss: 0.4601770
	speed: 0.0089s/iter; left time: 6.0833s
Updating learning rate to 5.8633644525e-05
Epoch: 3 cost time: 0.6986949443817139
Epoch: 3, Steps: 131 | Train Loss: 0.4601770 Vali Loss: 0.2778857 Best vali loss: 0.2678756
	iters: 100, epoch: 4 | loss: 0.5039198
	speed: 0.0086s/iter; left time: 4.8048s
Updating learning rate to 2.93168222625e-05
Epoch: 4 cost time: 0.696338415145874
Epoch: 4, Steps: 131 | Train Loss: 0.5039198 Vali Loss: 0.2887892 Best vali loss: 0.2678756
	iters: 100, epoch: 5 | loss: 0.3314363
	speed: 0.0087s/iter; left time: 3.6821s
Updating learning rate to 1.465841113125e-05
Epoch: 5 cost time: 0.6948106288909912
Epoch: 5, Steps: 131 | Train Loss: 0.3314363 Vali Loss: 0.2881077 Best vali loss: 0.2678756
	iters: 100, epoch: 6 | loss: 0.3178321
	speed: 0.0087s/iter; left time: 2.5473s
Updating learning rate to 7.329205565625e-06
Epoch: 6 cost time: 0.7061159610748291
Epoch: 6, Steps: 131 | Train Loss: 0.3178321 Vali Loss: 0.2857802 Best vali loss: 0.2678756
	iters: 100, epoch: 7 | loss: 0.3117185
	speed: 0.0087s/iter; left time: 1.4126s
Updating learning rate to 3.6646027828125e-06
Epoch: 7 cost time: 0.6944212913513184
Epoch: 7, Steps: 131 | Train Loss: 0.3117185 Vali Loss: 0.2923144 Best vali loss: 0.2678756
	iters: 100, epoch: 8 | loss: 0.3959344
	speed: 0.0086s/iter; left time: 0.2763s
Updating learning rate to 1.83230139140625e-06
Epoch: 8 cost time: 0.7020614147186279
Epoch: 8, Steps: 131 | Train Loss: 0.3959344 Vali Loss: 0.2929602 Best vali loss: 0.2678756

best validation loss 0.26787560238364727

[INFO][abstract_intensifier.py:595] Added config fb7232 and rejected config b43035 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4096663
	speed: 0.0109s/iter; left time: 10.3684s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 0.9731380939483643
Epoch: 1, Steps: 131 | Train Loss: 0.4096663 Vali Loss: 0.2795999 Best vali loss: 0.2795999
	iters: 100, epoch: 2 | loss: 0.5570035
	speed: 0.0092s/iter; left time: 7.5482s
Updating learning rate to 0.0001172646017
Epoch: 2 cost time: 0.7348361015319824
Epoch: 2, Steps: 131 | Train Loss: 0.5570035 Vali Loss: 0.2823287 Best vali loss: 0.2795999
	iters: 100, epoch: 3 | loss: 0.4741428
	speed: 0.0090s/iter; left time: 6.1747s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.7287838459014893
Epoch: 3, Steps: 131 | Train Loss: 0.4741428 Vali Loss: 0.2976066 Best vali loss: 0.2795999
	iters: 100, epoch: 4 | loss: 0.4444546
	speed: 0.0090s/iter; left time: 4.9977s
Updating learning rate to 2.9316150425e-05
Validation loss decreased (0.2796 --> 0.2787).  Saving model state dict ...
Epoch: 4 cost time: 0.7358262538909912
Epoch: 4, Steps: 131 | Train Loss: 0.4444546 Vali Loss: 0.2787095 Best vali loss: 0.2787095
	iters: 100, epoch: 5 | loss: 0.4393420
	speed: 0.0094s/iter; left time: 3.9932s
Updating learning rate to 1.46580752125e-05
Epoch: 5 cost time: 0.7315371036529541
Epoch: 5, Steps: 131 | Train Loss: 0.4393420 Vali Loss: 0.2827413 Best vali loss: 0.2787095
	iters: 100, epoch: 6 | loss: 0.4507882
	speed: 0.0090s/iter; left time: 2.6456s
Updating learning rate to 7.32903760625e-06
Epoch: 6 cost time: 0.7316677570343018
Epoch: 6, Steps: 131 | Train Loss: 0.4507882 Vali Loss: 0.2866529 Best vali loss: 0.2787095
	iters: 100, epoch: 7 | loss: 0.3081740
	speed: 0.0090s/iter; left time: 1.4651s
Updating learning rate to 3.664518803125e-06
Epoch: 7 cost time: 0.7289526462554932
Epoch: 7, Steps: 131 | Train Loss: 0.3081740 Vali Loss: 0.2844642 Best vali loss: 0.2787095
	iters: 100, epoch: 8 | loss: 0.2481055
	speed: 0.0090s/iter; left time: 0.2869s
Updating learning rate to 1.8322594015625e-06
Epoch: 8 cost time: 0.7301712036132812
Epoch: 8, Steps: 131 | Train Loss: 0.2481055 Vali Loss: 0.2849272 Best vali loss: 0.2787095

best validation loss 0.2787094721705686

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0012170536371, 'e_layers': 3, 'learning_rate': 0.0020180773364, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0019412688412624272
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 0.6235928535461426
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2878730 Best vali loss: 0.2878730
Updating learning rate to 0.0017225367529636625
Epoch: 2 cost time: 0.3901712894439697
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2966110 Best vali loss: 0.2878730
Updating learning rate to 0.001395181049135875
Epoch: 3 cost time: 0.37442970275878906
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2924190 Best vali loss: 0.2878730

best validation loss 0.28787300199015337

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021579402631, 'e_layers': 4, 'learning_rate': 0.0024289526769, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002336506170263205
Validation loss decreased (inf --> 0.3169).  Saving model state dict ...
Epoch: 1 cost time: 0.816741943359375
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3168805 Best vali loss: 0.3168805
Updating learning rate to 0.0020732407929586034
Epoch: 2 cost time: 0.580780029296875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3265247 Best vali loss: 0.3168805
Updating learning rate to 0.0016792363121742324
Validation loss decreased (0.3169 --> 0.3165).  Saving model state dict ...
Epoch: 3 cost time: 0.5767076015472412
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3164598 Best vali loss: 0.3164598

best validation loss 0.31645979531948876

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017745705519, 'e_layers': 4, 'learning_rate': 0.0024262880724, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0024262880724
Validation loss decreased (inf --> 0.3241).  Saving model state dict ...
Epoch: 1 cost time: 0.8296031951904297
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3240718 Best vali loss: 0.3240718
Updating learning rate to 0.0012131440362
Validation loss decreased (0.3241 --> 0.3179).  Saving model state dict ...
Epoch: 2 cost time: 0.5981040000915527
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3178634 Best vali loss: 0.3178634
Updating learning rate to 0.0006065720181
Epoch: 3 cost time: 0.5965414047241211
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3226784 Best vali loss: 0.3178634

best validation loss 0.31786342882320934

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0012170536371, 'e_layers': 3, 'learning_rate': 0.0020180773364, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0010090386682
Epoch: 4 cost time: 0.6024770736694336
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2954210 Best vali loss: 0.2878730
Updating learning rate to 0.0006228962872641251
Epoch: 5 cost time: 0.36801576614379883
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2979566 Best vali loss: 0.2878730
Updating learning rate to 0.00029554058343633733
Validation loss decreased (0.2879 --> 0.2837).  Saving model state dict ...
Epoch: 6 cost time: 0.37149643898010254
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2837357 Best vali loss: 0.2837357
Updating learning rate to 7.680849513757263e-05
Epoch: 7 cost time: 0.3548870086669922
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2858021 Best vali loss: 0.2837357
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3590981960296631
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2889448 Best vali loss: 0.2837357

best validation loss 0.28373571697244326

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016423858548, 'e_layers': 4, 'learning_rate': 0.0020445154319, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0020445154319
Validation loss decreased (inf --> 0.2913).  Saving model state dict ...
Epoch: 1 cost time: 0.6803481578826904
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2913221 Best vali loss: 0.2913221
Updating learning rate to 0.00102225771595
Epoch: 2 cost time: 0.42486023902893066
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3151373 Best vali loss: 0.2913221
Updating learning rate to 0.000511128857975
Epoch: 3 cost time: 0.45636987686157227
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2987481 Best vali loss: 0.2913221
Updating learning rate to 0.0002555644289875
Epoch: 4 cost time: 0.4290139675140381
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3077498 Best vali loss: 0.2913221
Updating learning rate to 0.00012778221449375
Epoch: 5 cost time: 0.4581117630004883
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2963817 Best vali loss: 0.2913221
Updating learning rate to 6.3891107246875e-05
Epoch: 6 cost time: 0.4208965301513672
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3033098 Best vali loss: 0.2913221
Updating learning rate to 3.19455536234375e-05
Epoch: 7 cost time: 0.40708327293395996
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3039391 Best vali loss: 0.2913221
Updating learning rate to 1.597277681171875e-05
Epoch: 8 cost time: 0.4532008171081543
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3055939 Best vali loss: 0.2913221

best validation loss 0.2913221367099729

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017206465171, 'e_layers': 4, 'learning_rate': 0.0024249130563, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0024249130563
Validation loss decreased (inf --> 0.3342).  Saving model state dict ...
Epoch: 1 cost time: 0.8272342681884766
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3342245 Best vali loss: 0.3342245
Updating learning rate to 0.00121245652815
Validation loss decreased (0.3342 --> 0.3184).  Saving model state dict ...
Epoch: 2 cost time: 0.5989644527435303
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3184134 Best vali loss: 0.3184134
Updating learning rate to 0.000606228264075
Epoch: 3 cost time: 0.5936522483825684
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3213408 Best vali loss: 0.3184134
Updating learning rate to 0.0003031141320375
Epoch: 4 cost time: 0.5940537452697754
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3224878 Best vali loss: 0.3184134
Updating learning rate to 0.00015155706601875
Epoch: 5 cost time: 0.6033363342285156
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3197658 Best vali loss: 0.3184134
Updating learning rate to 7.5778533009375e-05
Epoch: 6 cost time: 0.6063616275787354
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3219408 Best vali loss: 0.3184134
Updating learning rate to 3.78892665046875e-05
Epoch: 7 cost time: 0.5984055995941162
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3224743 Best vali loss: 0.3184134
Updating learning rate to 1.894463325234375e-05
Epoch: 8 cost time: 0.5947766304016113
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3220210 Best vali loss: 0.3184134

best validation loss 0.31841340076972136

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0009530048267, 'e_layers': 3, 'learning_rate': 0.0011621709775, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6190421
	speed: 0.0097s/iter; left time: 39.6604s
	iters: 200, epoch: 1 | loss: 0.4013383
	speed: 0.0044s/iter; left time: 17.5127s
	iters: 300, epoch: 1 | loss: 0.2558710
	speed: 0.0044s/iter; left time: 17.0176s
	iters: 400, epoch: 1 | loss: 0.4384619
	speed: 0.0044s/iter; left time: 16.7285s
	iters: 500, epoch: 1 | loss: 0.5989056
	speed: 0.0044s/iter; left time: 16.1347s
Updating learning rate to 0.0011621709775
Validation loss decreased (inf --> 0.2999).  Saving model state dict ...
Epoch: 1 cost time: 2.55428409576416
Epoch: 1, Steps: 523 | Train Loss: 0.4627238 Vali Loss: 0.2999440 Best vali loss: 0.2999440
	iters: 100, epoch: 2 | loss: 0.2662753
	speed: 0.0091s/iter; left time: 32.3063s
	iters: 200, epoch: 2 | loss: 0.9169877
	speed: 0.0044s/iter; left time: 15.3226s
	iters: 300, epoch: 2 | loss: 0.4034922
	speed: 0.0044s/iter; left time: 14.8287s
	iters: 400, epoch: 2 | loss: 0.1702422
	speed: 0.0045s/iter; left time: 14.5339s
	iters: 500, epoch: 2 | loss: 0.2941853
	speed: 0.0045s/iter; left time: 14.1029s
Updating learning rate to 0.00058108548875
Validation loss decreased (0.2999 --> 0.2998).  Saving model state dict ...
Epoch: 2 cost time: 2.3672244548797607
Epoch: 2, Steps: 523 | Train Loss: 0.4102365 Vali Loss: 0.2998350 Best vali loss: 0.2998350
	iters: 100, epoch: 3 | loss: 0.4035654
	speed: 0.0086s/iter; left time: 26.0223s
	iters: 200, epoch: 3 | loss: 0.3552456
	speed: 0.0040s/iter; left time: 11.7878s
	iters: 300, epoch: 3 | loss: 0.7195910
	speed: 0.0040s/iter; left time: 11.3529s
	iters: 400, epoch: 3 | loss: 0.3737767
	speed: 0.0038s/iter; left time: 10.4048s
	iters: 500, epoch: 3 | loss: 0.3432241
	speed: 0.0037s/iter; left time: 9.7420s
Updating learning rate to 0.000290542744375
Validation loss decreased (0.2998 --> 0.2858).  Saving model state dict ...
Epoch: 3 cost time: 2.072960138320923
Epoch: 3, Steps: 523 | Train Loss: 0.4390805 Vali Loss: 0.2857691 Best vali loss: 0.2857691

best validation loss 0.28576912111666797

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0072723069227, 'e_layers': 1, 'learning_rate': 0.00034492328, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4839931
	speed: 0.0078s/iter; left time: 15.6034s
	iters: 200, epoch: 1 | loss: 0.4531884
	speed: 0.0026s/iter; left time: 4.9834s
Updating learning rate to 0.0003317954193393298
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 0.939629316329956
Epoch: 1, Steps: 262 | Train Loss: 0.4685907 Vali Loss: 0.2824757 Best vali loss: 0.2824757
	iters: 100, epoch: 2 | loss: 0.6653153
	speed: 0.0060s/iter; left time: 10.4175s
	iters: 200, epoch: 2 | loss: 0.2605789
	speed: 0.0024s/iter; left time: 3.9208s
Updating learning rate to 0.0002944104351385531
Validation loss decreased (0.2825 --> 0.2813).  Saving model state dict ...
Epoch: 2 cost time: 0.6659653186798096
Epoch: 2, Steps: 262 | Train Loss: 0.4629471 Vali Loss: 0.2813286 Best vali loss: 0.2813286
	iters: 100, epoch: 3 | loss: 0.3980258
	speed: 0.0062s/iter; left time: 9.1783s
	iters: 200, epoch: 3 | loss: 0.4304949
	speed: 0.0026s/iter; left time: 3.6013s
Updating learning rate to 0.00023845985234651246
Epoch: 3 cost time: 0.7332384586334229
Epoch: 3, Steps: 262 | Train Loss: 0.4142603 Vali Loss: 0.2813574 Best vali loss: 0.2813286

best validation loss 0.2813286165093436

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0104094165294, 'e_layers': 2, 'learning_rate': 0.0010501641958, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010101947010378977
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 0.5697660446166992
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2883341 Best vali loss: 0.2883341
Updating learning rate to 0.0008963712100047486
Validation loss decreased (0.2883 --> 0.2847).  Saving model state dict ...
Epoch: 2 cost time: 0.3216536045074463
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2846576 Best vali loss: 0.2846576
Updating learning rate to 0.0007260223173978341
Epoch: 3 cost time: 0.31137681007385254
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2855347 Best vali loss: 0.2846576

best validation loss 0.28465755804735915

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0072723069227, 'e_layers': 1, 'learning_rate': 0.00034492328, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4333116
	speed: 0.0081s/iter; left time: 9.8492s
	iters: 200, epoch: 4 | loss: 0.4069181
	speed: 0.0027s/iter; left time: 3.0115s
Updating learning rate to 0.00017246164
Epoch: 4 cost time: 0.9871318340301514
Epoch: 4, Steps: 262 | Train Loss: 0.4201148 Vali Loss: 0.2850995 Best vali loss: 0.2813286
	iters: 100, epoch: 5 | loss: 0.6167474
	speed: 0.0065s/iter; left time: 6.1230s
	iters: 200, epoch: 5 | loss: 0.2596816
	speed: 0.0027s/iter; left time: 2.2693s
Updating learning rate to 0.00010646342765348755
Epoch: 5 cost time: 0.7389636039733887
Epoch: 5, Steps: 262 | Train Loss: 0.4382145 Vali Loss: 0.2837275 Best vali loss: 0.2813286
	iters: 100, epoch: 6 | loss: 0.4006047
	speed: 0.0065s/iter; left time: 4.4898s
	iters: 200, epoch: 6 | loss: 0.4347892
	speed: 0.0025s/iter; left time: 1.4944s
Updating learning rate to 5.0512844861446875e-05
Epoch: 6 cost time: 0.7250614166259766
Epoch: 6, Steps: 262 | Train Loss: 0.4176969 Vali Loss: 0.2834846 Best vali loss: 0.2813286
	iters: 100, epoch: 7 | loss: 0.5552040
	speed: 0.0063s/iter; left time: 2.6799s
	iters: 200, epoch: 7 | loss: 0.3524211
	speed: 0.0026s/iter; left time: 0.8461s
Updating learning rate to 1.312786066067017e-05
Epoch: 7 cost time: 0.7236778736114502
Epoch: 7, Steps: 262 | Train Loss: 0.4538126 Vali Loss: 0.2835078 Best vali loss: 0.2813286
	iters: 100, epoch: 8 | loss: 0.3100350
	speed: 0.0063s/iter; left time: 1.0323s
	iters: 200, epoch: 8 | loss: 0.3946834
	speed: 0.0026s/iter; left time: 0.1665s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7416207790374756
Epoch: 8, Steps: 262 | Train Loss: 0.3523592 Vali Loss: 0.2840668 Best vali loss: 0.2813286

best validation loss 0.2813286165093436

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0041633207872, 'e_layers': 3, 'learning_rate': 5.11402709e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4096674
	speed: 0.0094s/iter; left time: 38.5156s
	iters: 200, epoch: 1 | loss: 0.3227360
	speed: 0.0042s/iter; left time: 16.6197s
	iters: 300, epoch: 1 | loss: 0.6188940
	speed: 0.0042s/iter; left time: 16.1412s
	iters: 400, epoch: 1 | loss: 0.7346166
	speed: 0.0042s/iter; left time: 15.9401s
	iters: 500, epoch: 1 | loss: 0.8740787
	speed: 0.0043s/iter; left time: 15.9836s
Updating learning rate to 4.919386023579628e-05
Validation loss decreased (inf --> 0.3039).  Saving model state dict ...
Epoch: 1 cost time: 2.4625191688537598
Epoch: 1, Steps: 523 | Train Loss: 0.5919985 Vali Loss: 0.3038705 Best vali loss: 0.3038705
	iters: 100, epoch: 2 | loss: 0.4230845
	speed: 0.0082s/iter; left time: 29.1425s
	iters: 200, epoch: 2 | loss: 0.8541181
	speed: 0.0040s/iter; left time: 13.7038s
	iters: 300, epoch: 2 | loss: 0.3811717
	speed: 0.0040s/iter; left time: 13.4507s
	iters: 400, epoch: 2 | loss: 0.5216859
	speed: 0.0038s/iter; left time: 12.5402s
	iters: 500, epoch: 2 | loss: 0.7507352
	speed: 0.0038s/iter; left time: 12.0007s
Updating learning rate to 4.365095162255353e-05
Validation loss decreased (0.3039 --> 0.2889).  Saving model state dict ...
Epoch: 2 cost time: 2.0683507919311523
Epoch: 2, Steps: 523 | Train Loss: 0.5861591 Vali Loss: 0.2889461 Best vali loss: 0.2889461
	iters: 100, epoch: 3 | loss: 0.5336261
	speed: 0.0087s/iter; left time: 26.3258s
	iters: 200, epoch: 3 | loss: 0.5208962
	speed: 0.0044s/iter; left time: 12.7848s
	iters: 300, epoch: 3 | loss: 0.2466638
	speed: 0.0042s/iter; left time: 11.9549s
	iters: 400, epoch: 3 | loss: 0.2511205
	speed: 0.0041s/iter; left time: 11.2543s
	iters: 500, epoch: 3 | loss: 0.4060261
	speed: 0.0041s/iter; left time: 10.9115s
Updating learning rate to 3.535540265004626e-05
Validation loss decreased (0.2889 --> 0.2848).  Saving model state dict ...
Epoch: 3 cost time: 2.2439253330230713
Epoch: 3, Steps: 523 | Train Loss: 0.3916665 Vali Loss: 0.2848491 Best vali loss: 0.2848491
	iters: 100, epoch: 4 | loss: 0.2910360
	speed: 0.0087s/iter; left time: 21.9874s
	iters: 200, epoch: 4 | loss: 0.4650118
	speed: 0.0043s/iter; left time: 10.4377s
	iters: 300, epoch: 4 | loss: 0.8322041
	speed: 0.0044s/iter; left time: 10.1555s
	iters: 400, epoch: 4 | loss: 0.5945562
	speed: 0.0044s/iter; left time: 9.6844s
	iters: 500, epoch: 4 | loss: 0.4378425
	speed: 0.0043s/iter; left time: 9.1972s
Updating learning rate to 2.557013545e-05
Validation loss decreased (0.2848 --> 0.2831).  Saving model state dict ...
Epoch: 4 cost time: 2.3065085411071777
Epoch: 4, Steps: 523 | Train Loss: 0.5241301 Vali Loss: 0.2830611 Best vali loss: 0.2830611
	iters: 100, epoch: 5 | loss: 0.5635242
	speed: 0.0085s/iter; left time: 16.8983s
	iters: 200, epoch: 5 | loss: 0.3154903
	speed: 0.0040s/iter; left time: 7.5788s
	iters: 300, epoch: 5 | loss: 0.5385537
	speed: 0.0040s/iter; left time: 7.1672s
	iters: 400, epoch: 5 | loss: 0.4816247
	speed: 0.0040s/iter; left time: 6.7548s
	iters: 500, epoch: 5 | loss: 0.4586698
	speed: 0.0040s/iter; left time: 6.3906s
Updating learning rate to 1.5784868249953742e-05
Validation loss decreased (0.2831 --> 0.2821).  Saving model state dict ...
Epoch: 5 cost time: 2.1380374431610107
Epoch: 5, Steps: 523 | Train Loss: 0.4715725 Vali Loss: 0.2820516 Best vali loss: 0.2820516
	iters: 100, epoch: 6 | loss: 0.2805023
	speed: 0.0086s/iter; left time: 12.6256s
	iters: 200, epoch: 6 | loss: 0.3399318
	speed: 0.0040s/iter; left time: 5.4797s
	iters: 300, epoch: 6 | loss: 0.2433180
	speed: 0.0040s/iter; left time: 5.0816s
	iters: 400, epoch: 6 | loss: 0.9459060
	speed: 0.0041s/iter; left time: 4.7571s
	iters: 500, epoch: 6 | loss: 0.9984019
	speed: 0.0041s/iter; left time: 4.3488s
Updating learning rate to 7.489319277446469e-06
Validation loss decreased (0.2821 --> 0.2819).  Saving model state dict ...
Epoch: 6 cost time: 2.1476211547851562
Epoch: 6, Steps: 523 | Train Loss: 0.5616120 Vali Loss: 0.2818853 Best vali loss: 0.2818853
	iters: 100, epoch: 7 | loss: 0.2270470
	speed: 0.0081s/iter; left time: 7.6805s
	iters: 200, epoch: 7 | loss: 0.6768770
	speed: 0.0037s/iter; left time: 3.1083s
	iters: 300, epoch: 7 | loss: 0.4749916
	speed: 0.0037s/iter; left time: 2.7376s
	iters: 400, epoch: 7 | loss: 0.5253079
	speed: 0.0037s/iter; left time: 2.3662s
	iters: 500, epoch: 7 | loss: 0.5044516
	speed: 0.0037s/iter; left time: 2.0184s
Updating learning rate to 1.9464106642037193e-06
Validation loss decreased (0.2819 --> 0.2817).  Saving model state dict ...
Epoch: 7 cost time: 1.9582366943359375
Epoch: 7, Steps: 523 | Train Loss: 0.4817350 Vali Loss: 0.2817086 Best vali loss: 0.2817086
	iters: 100, epoch: 8 | loss: 0.4278881
	speed: 0.0086s/iter; left time: 3.6667s
	iters: 200, epoch: 8 | loss: 0.5201312
	speed: 0.0040s/iter; left time: 1.2958s
	iters: 300, epoch: 8 | loss: 0.8290651
	speed: 0.0040s/iter; left time: 0.8870s
	iters: 400, epoch: 8 | loss: 0.3501283
	speed: 0.0038s/iter; left time: 0.4724s
	iters: 500, epoch: 8 | loss: 0.7178497
	speed: 0.0038s/iter; left time: 0.0907s
Updating learning rate to 0.0
Validation loss decreased (0.2817 --> 0.2817).  Saving model state dict ...
Epoch: 8 cost time: 2.075460433959961
Epoch: 8, Steps: 523 | Train Loss: 0.5690125 Vali Loss: 0.2816993 Best vali loss: 0.2816993

best validation loss 0.2816992894274987

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.002111704205, 'e_layers': 4, 'learning_rate': 0.0005931116225, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9404359
	speed: 0.0151s/iter; left time: 14.3669s
Updating learning rate to 0.0005705376555111554
Validation loss decreased (inf --> 0.3057).  Saving model state dict ...
Epoch: 1 cost time: 1.55499267578125
Epoch: 1, Steps: 131 | Train Loss: 0.9404359 Vali Loss: 0.3056812 Best vali loss: 0.3056812
	iters: 100, epoch: 2 | loss: 0.4329030
	speed: 0.0158s/iter; left time: 12.9086s
Updating learning rate to 0.0005062524363851528
Epoch: 2 cost time: 1.308694839477539
Epoch: 2, Steps: 131 | Train Loss: 0.4329030 Vali Loss: 0.3088645 Best vali loss: 0.3056812
	iters: 100, epoch: 3 | loss: 0.5200834
	speed: 0.0154s/iter; left time: 10.6025s
Updating learning rate to 0.00041004280698696375
Validation loss decreased (0.3057 --> 0.3056).  Saving model state dict ...
Epoch: 3 cost time: 1.316293478012085
Epoch: 3, Steps: 131 | Train Loss: 0.5200834 Vali Loss: 0.3055666 Best vali loss: 0.3055666
	iters: 100, epoch: 4 | loss: 0.5340953
	speed: 0.0162s/iter; left time: 9.0224s
Updating learning rate to 0.00029655581125
Validation loss decreased (0.3056 --> 0.3015).  Saving model state dict ...
Epoch: 4 cost time: 1.3290276527404785
Epoch: 4, Steps: 131 | Train Loss: 0.5340953 Vali Loss: 0.3014593 Best vali loss: 0.3014593
	iters: 100, epoch: 5 | loss: 0.4468150
	speed: 0.0161s/iter; left time: 6.8506s
Updating learning rate to 0.00018306881551303632
Epoch: 5 cost time: 1.316429853439331
Epoch: 5, Steps: 131 | Train Loss: 0.4468150 Vali Loss: 0.3053204 Best vali loss: 0.3014593
	iters: 100, epoch: 6 | loss: 0.4131285
	speed: 0.0156s/iter; left time: 4.5860s
Updating learning rate to 8.685918611484718e-05
Validation loss decreased (0.3015 --> 0.2968).  Saving model state dict ...
Epoch: 6 cost time: 1.322545051574707
Epoch: 6, Steps: 131 | Train Loss: 0.4131285 Vali Loss: 0.2967579 Best vali loss: 0.2967579
	iters: 100, epoch: 7 | loss: 0.3889665
	speed: 0.0162s/iter; left time: 2.6325s
Updating learning rate to 2.257396698884461e-05
Validation loss decreased (0.2968 --> 0.2946).  Saving model state dict ...
Epoch: 7 cost time: 1.3248262405395508
Epoch: 7, Steps: 131 | Train Loss: 0.3889665 Vali Loss: 0.2945636 Best vali loss: 0.2945636
	iters: 100, epoch: 8 | loss: 0.4443447
	speed: 0.0162s/iter; left time: 0.5198s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.326387643814087
Epoch: 8, Steps: 131 | Train Loss: 0.4443447 Vali Loss: 0.2980367 Best vali loss: 0.2945636

best validation loss 0.29456359417343636

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022168187406, 'e_layers': 4, 'learning_rate': 0.0005960181891, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9294064
	speed: 0.0150s/iter; left time: 14.2361s
Updating learning rate to 0.0005733335975069659
Validation loss decreased (inf --> 0.3080).  Saving model state dict ...
Epoch: 1 cost time: 1.544022560119629
Epoch: 1, Steps: 131 | Train Loss: 0.9294064 Vali Loss: 0.3079565 Best vali loss: 0.3079565
	iters: 100, epoch: 2 | loss: 0.4240081
	speed: 0.0159s/iter; left time: 13.0371s
Updating learning rate to 0.000508733346161568
Validation loss decreased (0.3080 --> 0.3043).  Saving model state dict ...
Epoch: 2 cost time: 1.3290815353393555
Epoch: 2, Steps: 131 | Train Loss: 0.4240081 Vali Loss: 0.3042987 Best vali loss: 0.3042987
	iters: 100, epoch: 3 | loss: 0.5000436
	speed: 0.0160s/iter; left time: 10.9744s
Updating learning rate to 0.0004120522377284066
Epoch: 3 cost time: 1.3210670948028564
Epoch: 3, Steps: 131 | Train Loss: 0.5000436 Vali Loss: 0.3064348 Best vali loss: 0.3042987

best validation loss 0.3042987066214747

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019121713548, 'e_layers': 2, 'learning_rate': 0.0008006762642, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4207515
	speed: 0.0107s/iter; left time: 10.1237s
Updating learning rate to 0.0007702023384309898
Validation loss decreased (inf --> 0.2985).  Saving model state dict ...
Epoch: 1 cost time: 0.9576752185821533
Epoch: 1, Steps: 131 | Train Loss: 0.4207515 Vali Loss: 0.2984841 Best vali loss: 0.2984841
	iters: 100, epoch: 2 | loss: 0.5868461
	speed: 0.0092s/iter; left time: 7.5650s
Updating learning rate to 0.0006834199400754658
Epoch: 2 cost time: 0.737126350402832
Epoch: 2, Steps: 131 | Train Loss: 0.5868461 Vali Loss: 0.3105018 Best vali loss: 0.2984841
	iters: 100, epoch: 3 | loss: 0.5573854
	speed: 0.0090s/iter; left time: 6.1511s
Updating learning rate to 0.0005535409025986568
Validation loss decreased (0.2985 --> 0.2882).  Saving model state dict ...
Epoch: 3 cost time: 0.728358268737793
Epoch: 3, Steps: 131 | Train Loss: 0.5573854 Vali Loss: 0.2882126 Best vali loss: 0.2882126

best validation loss 0.2882126079655438

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0018303048712, 'e_layers': 2, 'learning_rate': 0.0008114246207, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4209948
	speed: 0.0106s/iter; left time: 10.0988s
Updating learning rate to 0.0008114246207
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 0.9579126834869385
Epoch: 1, Steps: 131 | Train Loss: 0.4209948 Vali Loss: 0.2875072 Best vali loss: 0.2875072
	iters: 100, epoch: 2 | loss: 0.6062091
	speed: 0.0092s/iter; left time: 7.5164s
Updating learning rate to 0.00040571231035
Epoch: 2 cost time: 0.7292466163635254
Epoch: 2, Steps: 131 | Train Loss: 0.6062091 Vali Loss: 0.3019538 Best vali loss: 0.2875072
	iters: 100, epoch: 3 | loss: 0.5570512
	speed: 0.0089s/iter; left time: 6.1315s
Updating learning rate to 0.000202856155175
Epoch: 3 cost time: 0.7349979877471924
Epoch: 3, Steps: 131 | Train Loss: 0.5570512 Vali Loss: 0.2901573 Best vali loss: 0.2875072

best validation loss 0.28750722755859137

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0018303048712, 'e_layers': 2, 'learning_rate': 0.0008114246207, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3727995
	speed: 0.0110s/iter; left time: 6.1195s
Updating learning rate to 0.0001014280775875
Epoch: 4 cost time: 0.9549005031585693
Epoch: 4, Steps: 131 | Train Loss: 0.3727995 Vali Loss: 0.2992928 Best vali loss: 0.2875072
	iters: 100, epoch: 5 | loss: 0.3935492
	speed: 0.0089s/iter; left time: 3.8011s
Updating learning rate to 5.071403879375e-05
Epoch: 5 cost time: 0.7232241630554199
Epoch: 5, Steps: 131 | Train Loss: 0.3935492 Vali Loss: 0.2969001 Best vali loss: 0.2875072
	iters: 100, epoch: 6 | loss: 0.4007312
	speed: 0.0090s/iter; left time: 2.6378s
Updating learning rate to 2.5357019396875e-05
Epoch: 6 cost time: 0.734316349029541
Epoch: 6, Steps: 131 | Train Loss: 0.4007312 Vali Loss: 0.2983763 Best vali loss: 0.2875072
	iters: 100, epoch: 7 | loss: 0.4148561
	speed: 0.0090s/iter; left time: 1.4645s
Updating learning rate to 1.26785096984375e-05
Epoch: 7 cost time: 0.7341773509979248
Epoch: 7, Steps: 131 | Train Loss: 0.4148561 Vali Loss: 0.3034007 Best vali loss: 0.2875072
	iters: 100, epoch: 8 | loss: 0.4230961
	speed: 0.0090s/iter; left time: 0.2865s
Updating learning rate to 6.33925484921875e-06
Epoch: 8 cost time: 0.7315173149108887
Epoch: 8, Steps: 131 | Train Loss: 0.4230961 Vali Loss: 0.3055426 Best vali loss: 0.2875072

best validation loss 0.28750722755859137

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020642797485, 'e_layers': 4, 'learning_rate': 0.0002704421117, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6688184
	speed: 0.0105s/iter; left time: 43.0491s
	iters: 200, epoch: 1 | loss: 0.8085912
	speed: 0.0052s/iter; left time: 20.6086s
	iters: 300, epoch: 1 | loss: 0.4997311
	speed: 0.0052s/iter; left time: 20.1063s
	iters: 400, epoch: 1 | loss: 0.4891911
	speed: 0.0052s/iter; left time: 19.5093s
	iters: 500, epoch: 1 | loss: 0.9570147
	speed: 0.0052s/iter; left time: 19.0987s
Updating learning rate to 0.0002601490217143806
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 2.9590022563934326
Epoch: 1, Steps: 523 | Train Loss: 0.6846693 Vali Loss: 0.2812351 Best vali loss: 0.2812351
	iters: 100, epoch: 2 | loss: 0.4374544
	speed: 0.0103s/iter; left time: 36.5460s
	iters: 200, epoch: 2 | loss: 0.7441000
	speed: 0.0053s/iter; left time: 18.2672s
	iters: 300, epoch: 2 | loss: 0.7412133
	speed: 0.0053s/iter; left time: 17.7711s
	iters: 400, epoch: 2 | loss: 0.4496954
	speed: 0.0049s/iter; left time: 16.0615s
	iters: 500, epoch: 2 | loss: 0.4481818
	speed: 0.0048s/iter; left time: 15.2551s
Updating learning rate to 0.00023083678140073987
Validation loss decreased (0.2812 --> 0.2760).  Saving model state dict ...
Epoch: 2 cost time: 2.7086598873138428
Epoch: 2, Steps: 523 | Train Loss: 0.5641290 Vali Loss: 0.2760122 Best vali loss: 0.2760122
	iters: 100, epoch: 3 | loss: 0.9464607
	speed: 0.0100s/iter; left time: 30.4078s
	iters: 200, epoch: 3 | loss: 0.3319318
	speed: 0.0049s/iter; left time: 14.4337s
	iters: 300, epoch: 3 | loss: 0.3328520
	speed: 0.0049s/iter; left time: 13.8834s
	iters: 400, epoch: 3 | loss: 0.4102201
	speed: 0.0049s/iter; left time: 13.3905s
	iters: 500, epoch: 3 | loss: 0.3393245
	speed: 0.0049s/iter; left time: 12.8453s
Updating learning rate to 0.0001869679136307095
Epoch: 3 cost time: 2.597367286682129
Epoch: 3, Steps: 523 | Train Loss: 0.4721578 Vali Loss: 0.2825360 Best vali loss: 0.2760122
	iters: 100, epoch: 4 | loss: 0.4750553
	speed: 0.0102s/iter; left time: 25.7834s
	iters: 200, epoch: 4 | loss: 0.3172592
	speed: 0.0052s/iter; left time: 12.5063s
	iters: 300, epoch: 4 | loss: 0.3198361
	speed: 0.0050s/iter; left time: 11.6681s
	iters: 400, epoch: 4 | loss: 0.6816779
	speed: 0.0051s/iter; left time: 11.3127s
	iters: 500, epoch: 4 | loss: 0.4599980
	speed: 0.0051s/iter; left time: 10.8741s
Updating learning rate to 0.00013522105585
Epoch: 4 cost time: 2.7317988872528076
Epoch: 4, Steps: 523 | Train Loss: 0.4507653 Vali Loss: 0.2925041 Best vali loss: 0.2760122
	iters: 100, epoch: 5 | loss: 0.4497482
	speed: 0.0100s/iter; left time: 19.8496s
	iters: 200, epoch: 5 | loss: 0.3476366
	speed: 0.0047s/iter; left time: 8.8048s
	iters: 300, epoch: 5 | loss: 0.4263015
	speed: 0.0047s/iter; left time: 8.4670s
	iters: 400, epoch: 5 | loss: 0.3546286
	speed: 0.0047s/iter; left time: 7.9272s
	iters: 500, epoch: 5 | loss: 0.3665956
	speed: 0.0049s/iter; left time: 7.7536s
Updating learning rate to 8.347419806929051e-05
Epoch: 5 cost time: 2.530841827392578
Epoch: 5, Steps: 523 | Train Loss: 0.3889821 Vali Loss: 0.2953634 Best vali loss: 0.2760122
	iters: 100, epoch: 6 | loss: 0.2733952
	speed: 0.0096s/iter; left time: 14.1367s
	iters: 200, epoch: 6 | loss: 0.3861867
	speed: 0.0046s/iter; left time: 6.2477s
	iters: 300, epoch: 6 | loss: 0.4528671
	speed: 0.0045s/iter; left time: 5.7601s
	iters: 400, epoch: 6 | loss: 0.2699190
	speed: 0.0046s/iter; left time: 5.3388s
	iters: 500, epoch: 6 | loss: 0.2141290
	speed: 0.0046s/iter; left time: 4.8840s
Updating learning rate to 3.960533029926014e-05
Epoch: 6 cost time: 2.4289228916168213
Epoch: 6, Steps: 523 | Train Loss: 0.3192994 Vali Loss: 0.2982126 Best vali loss: 0.2760122
	iters: 100, epoch: 7 | loss: 0.2811612
	speed: 0.0100s/iter; left time: 9.5141s
	iters: 200, epoch: 7 | loss: 0.3345885
	speed: 0.0051s/iter; left time: 4.3287s
	iters: 300, epoch: 7 | loss: 0.2325192
	speed: 0.0051s/iter; left time: 3.7958s
	iters: 400, epoch: 7 | loss: 0.5315111
	speed: 0.0051s/iter; left time: 3.3290s
	iters: 500, epoch: 7 | loss: 0.4488838
	speed: 0.0051s/iter; left time: 2.7908s
Updating learning rate to 1.0293089985619406e-05
Epoch: 7 cost time: 2.717676877975464
Epoch: 7, Steps: 523 | Train Loss: 0.3657328 Vali Loss: 0.2906176 Best vali loss: 0.2760122
	iters: 100, epoch: 8 | loss: 0.2930810
	speed: 0.0101s/iter; left time: 4.2983s
	iters: 200, epoch: 8 | loss: 0.5252815
	speed: 0.0052s/iter; left time: 1.6972s
	iters: 300, epoch: 8 | loss: 0.2975353
	speed: 0.0053s/iter; left time: 1.1883s
	iters: 400, epoch: 8 | loss: 0.3383549
	speed: 0.0052s/iter; left time: 0.6499s
	iters: 500, epoch: 8 | loss: 0.8154528
	speed: 0.0051s/iter; left time: 0.1230s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7546937465667725
Epoch: 8, Steps: 523 | Train Loss: 0.4539411 Vali Loss: 0.2946803 Best vali loss: 0.2760122

best validation loss 0.27601219286436307

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0077444211183, 'e_layers': 2, 'learning_rate': 0.004188802329, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3421031
	speed: 0.0088s/iter; left time: 36.0776s
	iters: 200, epoch: 1 | loss: 0.4266526
	speed: 0.0034s/iter; left time: 13.6240s
	iters: 300, epoch: 1 | loss: 0.3303957
	speed: 0.0034s/iter; left time: 13.3463s
	iters: 400, epoch: 1 | loss: 0.8012645
	speed: 0.0034s/iter; left time: 13.0010s
	iters: 500, epoch: 1 | loss: 0.3966540
	speed: 0.0034s/iter; left time: 12.5470s
Updating learning rate to 0.004029375533249354
Validation loss decreased (inf --> 0.3014).  Saving model state dict ...
Epoch: 1 cost time: 2.0591304302215576
Epoch: 1, Steps: 523 | Train Loss: 0.4594140 Vali Loss: 0.3013607 Best vali loss: 0.3013607
	iters: 100, epoch: 2 | loss: 0.4052629
	speed: 0.0072s/iter; left time: 25.4884s
	iters: 200, epoch: 2 | loss: 0.6014460
	speed: 0.0032s/iter; left time: 10.9380s
	iters: 300, epoch: 2 | loss: 0.3393119
	speed: 0.0032s/iter; left time: 10.7008s
	iters: 400, epoch: 2 | loss: 1.7231464
	speed: 0.0033s/iter; left time: 10.7898s
	iters: 500, epoch: 2 | loss: 0.4068584
	speed: 0.0035s/iter; left time: 10.9876s
Updating learning rate to 0.0035753664304429516
Validation loss decreased (0.3014 --> 0.2893).  Saving model state dict ...
Epoch: 2 cost time: 1.7479498386383057
Epoch: 2, Steps: 523 | Train Loss: 0.6952051 Vali Loss: 0.2893122 Best vali loss: 0.2893122
	iters: 100, epoch: 3 | loss: 0.3486707
	speed: 0.0067s/iter; left time: 20.5097s
	iters: 200, epoch: 3 | loss: 0.5593938
	speed: 0.0028s/iter; left time: 8.2108s
	iters: 300, epoch: 3 | loss: 0.8853674
	speed: 0.0028s/iter; left time: 7.8917s
	iters: 400, epoch: 3 | loss: 0.3320588
	speed: 0.0028s/iter; left time: 7.6940s
	iters: 500, epoch: 3 | loss: 0.6654019
	speed: 0.0028s/iter; left time: 7.3326s
Updating learning rate to 0.0028958937908803014
Epoch: 3 cost time: 1.496654987335205
Epoch: 3, Steps: 523 | Train Loss: 0.5581785 Vali Loss: 0.2967466 Best vali loss: 0.2893122
	iters: 100, epoch: 4 | loss: 0.2372326
	speed: 0.0064s/iter; left time: 16.1911s
	iters: 200, epoch: 4 | loss: 0.6203593
	speed: 0.0030s/iter; left time: 7.1726s
	iters: 300, epoch: 4 | loss: 0.4706114
	speed: 0.0030s/iter; left time: 6.9883s
	iters: 400, epoch: 4 | loss: 0.5112142
	speed: 0.0029s/iter; left time: 6.5160s
	iters: 500, epoch: 4 | loss: 0.2956591
	speed: 0.0029s/iter; left time: 6.2104s
Updating learning rate to 0.0020944011645
Epoch: 4 cost time: 1.5754163265228271
Epoch: 4, Steps: 523 | Train Loss: 0.4270153 Vali Loss: 0.2911539 Best vali loss: 0.2893122
	iters: 100, epoch: 5 | loss: 0.3269827
	speed: 0.0066s/iter; left time: 13.1389s
	iters: 200, epoch: 5 | loss: 0.3980344
	speed: 0.0028s/iter; left time: 5.3762s
	iters: 300, epoch: 5 | loss: 0.5941065
	speed: 0.0028s/iter; left time: 5.0708s
	iters: 400, epoch: 5 | loss: 0.4614357
	speed: 0.0028s/iter; left time: 4.7885s
	iters: 500, epoch: 5 | loss: 0.3135367
	speed: 0.0028s/iter; left time: 4.4972s
Updating learning rate to 0.0012929085381196991
Epoch: 5 cost time: 1.529860019683838
Epoch: 5, Steps: 523 | Train Loss: 0.4188192 Vali Loss: 0.2894153 Best vali loss: 0.2893122
	iters: 100, epoch: 6 | loss: 0.8557385
	speed: 0.0067s/iter; left time: 9.8392s
	iters: 200, epoch: 6 | loss: 0.8066234
	speed: 0.0030s/iter; left time: 4.0838s
	iters: 300, epoch: 6 | loss: 0.6531503
	speed: 0.0030s/iter; left time: 3.8390s
	iters: 400, epoch: 6 | loss: 0.3551703
	speed: 0.0029s/iter; left time: 3.4237s
	iters: 500, epoch: 6 | loss: 0.7085748
	speed: 0.0029s/iter; left time: 3.1269s
Updating learning rate to 0.0006134358985570483
Epoch: 6 cost time: 1.5839693546295166
Epoch: 6, Steps: 523 | Train Loss: 0.6758515 Vali Loss: 0.2956096 Best vali loss: 0.2893122
	iters: 100, epoch: 7 | loss: 0.6212035
	speed: 0.0067s/iter; left time: 6.3795s
	iters: 200, epoch: 7 | loss: 0.6568576
	speed: 0.0030s/iter; left time: 2.5175s
	iters: 300, epoch: 7 | loss: 0.2605154
	speed: 0.0030s/iter; left time: 2.2057s
	iters: 400, epoch: 7 | loss: 0.3736068
	speed: 0.0030s/iter; left time: 1.9130s
	iters: 500, epoch: 7 | loss: 0.5207193
	speed: 0.0030s/iter; left time: 1.6186s
Updating learning rate to 0.00015942679575064545
Epoch: 7 cost time: 1.5876333713531494
Epoch: 7, Steps: 523 | Train Loss: 0.4865805 Vali Loss: 0.3033777 Best vali loss: 0.2893122
	iters: 100, epoch: 8 | loss: 0.4085446
	speed: 0.0066s/iter; left time: 2.8183s
	iters: 200, epoch: 8 | loss: 0.2944784
	speed: 0.0029s/iter; left time: 0.9276s
	iters: 300, epoch: 8 | loss: 0.4126486
	speed: 0.0029s/iter; left time: 0.6484s
	iters: 400, epoch: 8 | loss: 0.4214617
	speed: 0.0029s/iter; left time: 0.3537s
	iters: 500, epoch: 8 | loss: 0.2890204
	speed: 0.0029s/iter; left time: 0.0686s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5364251136779785
Epoch: 8, Steps: 523 | Train Loss: 0.3652308 Vali Loss: 0.3043800 Best vali loss: 0.2893122

best validation loss 0.28931221763810155

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010263191983, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597249
	speed: 0.0116s/iter; left time: 11.0217s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 1.114555835723877
Epoch: 1, Steps: 131 | Train Loss: 0.5597249 Vali Loss: 0.2756472 Best vali loss: 0.2756472
	iters: 100, epoch: 2 | loss: 0.3251583
	speed: 0.0089s/iter; left time: 7.3032s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2687).  Saving model state dict ...
Epoch: 2 cost time: 0.6974854469299316
Epoch: 2, Steps: 131 | Train Loss: 0.3251583 Vali Loss: 0.2686743 Best vali loss: 0.2686743
	iters: 100, epoch: 3 | loss: 0.4595742
	speed: 0.0091s/iter; left time: 6.2698s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.706862211227417
Epoch: 3, Steps: 131 | Train Loss: 0.4595742 Vali Loss: 0.2789699 Best vali loss: 0.2686743

best validation loss 0.26867431309108797

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260905124, 'e_layers': 2, 'learning_rate': 0.0002344859158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597180
	speed: 0.0098s/iter; left time: 9.3346s
Updating learning rate to 0.0002344859158
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9331731796264648
Epoch: 1, Steps: 131 | Train Loss: 0.5597180 Vali Loss: 0.2756357 Best vali loss: 0.2756357
	iters: 100, epoch: 2 | loss: 0.3259155
	speed: 0.0088s/iter; left time: 7.2116s
Updating learning rate to 0.0001172429579
Validation loss decreased (0.2756 --> 0.2699).  Saving model state dict ...
Epoch: 2 cost time: 0.6949179172515869
Epoch: 2, Steps: 131 | Train Loss: 0.3259155 Vali Loss: 0.2698993 Best vali loss: 0.2698993
	iters: 100, epoch: 3 | loss: 0.4649566
	speed: 0.0090s/iter; left time: 6.2090s
Updating learning rate to 5.862147895e-05
Epoch: 3 cost time: 0.7039411067962646
Epoch: 3, Steps: 131 | Train Loss: 0.4649566 Vali Loss: 0.2798421 Best vali loss: 0.2698993

best validation loss 0.2698992654354256

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266899409, 'e_layers': 2, 'learning_rate': 0.0002379388227, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5601073
	speed: 0.0106s/iter; left time: 10.0450s
Updating learning rate to 0.00022888281549118095
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.932281494140625
Epoch: 1, Steps: 131 | Train Loss: 0.5601073 Vali Loss: 0.2756846 Best vali loss: 0.2756846
	iters: 100, epoch: 2 | loss: 0.3255608
	speed: 0.0089s/iter; left time: 7.2724s
Updating learning rate to 0.00020309348886935678
Validation loss decreased (0.2757 --> 0.2735).  Saving model state dict ...
Epoch: 2 cost time: 0.69962477684021
Epoch: 2, Steps: 131 | Train Loss: 0.3255608 Vali Loss: 0.2734677 Best vali loss: 0.2734677
	iters: 100, epoch: 3 | loss: 0.4671683
	speed: 0.0089s/iter; left time: 6.1117s
Updating learning rate to 0.00016449703403187226
Epoch: 3 cost time: 0.6957535743713379
Epoch: 3, Steps: 131 | Train Loss: 0.4671683 Vali Loss: 0.2871750 Best vali loss: 0.2734677

best validation loss 0.2734676652479544

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010263191983, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4250871
	speed: 0.0109s/iter; left time: 6.0591s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9321773052215576
Epoch: 4, Steps: 131 | Train Loss: 0.4250871 Vali Loss: 0.3075061 Best vali loss: 0.2686743
	iters: 100, epoch: 5 | loss: 0.2805289
	speed: 0.0087s/iter; left time: 3.6791s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6944375038146973
Epoch: 5, Steps: 131 | Train Loss: 0.2805289 Vali Loss: 0.2933733 Best vali loss: 0.2686743
	iters: 100, epoch: 6 | loss: 0.4336008
	speed: 0.0086s/iter; left time: 2.5152s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6931593418121338
Epoch: 6, Steps: 131 | Train Loss: 0.4336008 Vali Loss: 0.2995478 Best vali loss: 0.2686743
	iters: 100, epoch: 7 | loss: 0.4631855
	speed: 0.0087s/iter; left time: 1.4171s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6995856761932373
Epoch: 7, Steps: 131 | Train Loss: 0.4631855 Vali Loss: 0.2964811 Best vali loss: 0.2686743
	iters: 100, epoch: 8 | loss: 0.3284833
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6936609745025635
Epoch: 8, Steps: 131 | Train Loss: 0.3284833 Vali Loss: 0.2955784 Best vali loss: 0.2686743

best validation loss 0.26867431309108797

[INFO][smbo.py:320] Finished 850 trials.
{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008317796664, 'e_layers': 2, 'learning_rate': 0.0005867682645, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5368966
	speed: 0.0098s/iter; left time: 80.6623s
	iters: 200, epoch: 1 | loss: 0.6481923
	speed: 0.0034s/iter; left time: 27.4789s
	iters: 300, epoch: 1 | loss: 0.4079996
	speed: 0.0034s/iter; left time: 27.0498s
	iters: 400, epoch: 1 | loss: 1.0906523
	speed: 0.0034s/iter; left time: 26.7536s
	iters: 500, epoch: 1 | loss: 0.3664202
	speed: 0.0033s/iter; left time: 26.3313s
	iters: 600, epoch: 1 | loss: 0.3583631
	speed: 0.0034s/iter; left time: 26.2304s
	iters: 700, epoch: 1 | loss: 0.5207233
	speed: 0.0034s/iter; left time: 26.0169s
	iters: 800, epoch: 1 | loss: 0.2633289
	speed: 0.0034s/iter; left time: 25.5936s
	iters: 900, epoch: 1 | loss: 0.8618181
	speed: 0.0034s/iter; left time: 25.2877s
	iters: 1000, epoch: 1 | loss: 0.5336654
	speed: 0.0034s/iter; left time: 25.0373s
Updating learning rate to 0.0005644357271993595
Validation loss decreased (inf --> 0.3083).  Saving model state dict ...
Epoch: 1 cost time: 3.9689555168151855
Epoch: 1, Steps: 1045 | Train Loss: 0.5588060 Vali Loss: 0.3083296 Best vali loss: 0.3083296
	iters: 100, epoch: 2 | loss: 2.2212234
	speed: 0.0101s/iter; left time: 72.5653s
	iters: 200, epoch: 2 | loss: 0.3499796
	speed: 0.0028s/iter; left time: 20.0967s
	iters: 300, epoch: 2 | loss: 0.3785610
	speed: 0.0028s/iter; left time: 19.8839s
	iters: 400, epoch: 2 | loss: 0.5086163
	speed: 0.0028s/iter; left time: 19.5947s
	iters: 500, epoch: 2 | loss: 0.2620664
	speed: 0.0028s/iter; left time: 18.9406s
	iters: 600, epoch: 2 | loss: 0.9988823
	speed: 0.0029s/iter; left time: 19.4710s
	iters: 700, epoch: 2 | loss: 0.4124967
	speed: 0.0029s/iter; left time: 19.0320s
	iters: 800, epoch: 2 | loss: 0.4449672
	speed: 0.0029s/iter; left time: 18.6758s
	iters: 900, epoch: 2 | loss: 0.2313918
	speed: 0.0029s/iter; left time: 18.6446s
	iters: 1000, epoch: 2 | loss: 1.0270814
	speed: 0.0028s/iter; left time: 17.7341s
Updating learning rate to 0.0005008380416565059
Validation loss decreased (0.3083 --> 0.2881).  Saving model state dict ...
Epoch: 2 cost time: 3.0137269496917725
Epoch: 2, Steps: 1045 | Train Loss: 0.6835266 Vali Loss: 0.2880622 Best vali loss: 0.2880622
	iters: 100, epoch: 3 | loss: 0.6944395
	speed: 0.0103s/iter; left time: 63.8057s
	iters: 200, epoch: 3 | loss: 0.2925507
	speed: 0.0034s/iter; left time: 20.4080s
	iters: 300, epoch: 3 | loss: 0.1586895
	speed: 0.0034s/iter; left time: 20.1723s
	iters: 400, epoch: 3 | loss: 0.1512564
	speed: 0.0034s/iter; left time: 19.8076s
	iters: 500, epoch: 3 | loss: 1.2719253
	speed: 0.0034s/iter; left time: 19.5305s
	iters: 600, epoch: 3 | loss: 0.3633003
	speed: 0.0033s/iter; left time: 18.9358s
	iters: 700, epoch: 3 | loss: 0.1726946
	speed: 0.0033s/iter; left time: 18.4509s
	iters: 800, epoch: 3 | loss: 1.4458400
	speed: 0.0030s/iter; left time: 16.5829s
	iters: 900, epoch: 3 | loss: 0.3027250
	speed: 0.0031s/iter; left time: 16.8157s
	iters: 1000, epoch: 3 | loss: 0.3299996
	speed: 0.0031s/iter; left time: 16.3762s
Updating learning rate to 0.0004056573789808835
Epoch: 3 cost time: 3.453270673751831
Epoch: 3, Steps: 1045 | Train Loss: 0.5183421 Vali Loss: 0.2999065 Best vali loss: 0.2880622
	iters: 100, epoch: 4 | loss: 0.5061294
	speed: 0.0099s/iter; left time: 50.6425s
	iters: 200, epoch: 4 | loss: 1.5536758
	speed: 0.0034s/iter; left time: 17.0101s
	iters: 300, epoch: 4 | loss: 0.2399525
	speed: 0.0034s/iter; left time: 16.5082s
	iters: 400, epoch: 4 | loss: 0.3837948
	speed: 0.0034s/iter; left time: 16.1915s
	iters: 500, epoch: 4 | loss: 0.3791103
	speed: 0.0033s/iter; left time: 15.6698s
	iters: 600, epoch: 4 | loss: 0.1878628
	speed: 0.0035s/iter; left time: 15.9625s
	iters: 700, epoch: 4 | loss: 0.3966206
	speed: 0.0034s/iter; left time: 15.3818s
	iters: 800, epoch: 4 | loss: 0.3110799
	speed: 0.0030s/iter; left time: 13.3843s
	iters: 900, epoch: 4 | loss: 0.6409919
	speed: 0.0030s/iter; left time: 12.8357s
	iters: 1000, epoch: 4 | loss: 0.3581506
	speed: 0.0030s/iter; left time: 12.5080s
Updating learning rate to 0.00029338413225
Epoch: 4 cost time: 3.425442695617676
Epoch: 4, Steps: 1045 | Train Loss: 0.4957369 Vali Loss: 0.2973269 Best vali loss: 0.2880622
	iters: 100, epoch: 5 | loss: 0.5488952
	speed: 0.0096s/iter; left time: 39.0030s
	iters: 200, epoch: 5 | loss: 0.3183679
	speed: 0.0030s/iter; left time: 12.0199s
	iters: 300, epoch: 5 | loss: 0.4791144
	speed: 0.0031s/iter; left time: 11.9762s
	iters: 400, epoch: 5 | loss: 0.3291812
	speed: 0.0034s/iter; left time: 12.7331s
	iters: 500, epoch: 5 | loss: 0.3052078
	speed: 0.0034s/iter; left time: 12.5831s
	iters: 600, epoch: 5 | loss: 0.4777825
	speed: 0.0034s/iter; left time: 12.2118s
	iters: 700, epoch: 5 | loss: 1.1839956
	speed: 0.0034s/iter; left time: 11.9447s
	iters: 800, epoch: 5 | loss: 0.4669064
	speed: 0.0034s/iter; left time: 11.6275s
	iters: 900, epoch: 5 | loss: 1.0585353
	speed: 0.0034s/iter; left time: 11.3068s
	iters: 1000, epoch: 5 | loss: 0.2374332
	speed: 0.0034s/iter; left time: 10.8662s
Updating learning rate to 0.0001811108855191166
Epoch: 5 cost time: 3.4950056076049805
Epoch: 5, Steps: 1045 | Train Loss: 0.5405420 Vali Loss: 0.3078679 Best vali loss: 0.2880622
	iters: 100, epoch: 6 | loss: 0.2394837
	speed: 0.0104s/iter; left time: 31.4401s
	iters: 200, epoch: 6 | loss: 0.6411735
	speed: 0.0035s/iter; left time: 10.2133s
	iters: 300, epoch: 6 | loss: 0.3828550
	speed: 0.0035s/iter; left time: 9.8502s
	iters: 400, epoch: 6 | loss: 0.3402137
	speed: 0.0036s/iter; left time: 9.8942s
	iters: 500, epoch: 6 | loss: 0.2844784
	speed: 0.0035s/iter; left time: 9.3041s
	iters: 600, epoch: 6 | loss: 0.1836918
	speed: 0.0034s/iter; left time: 8.6563s
	iters: 700, epoch: 6 | loss: 1.5034512
	speed: 0.0033s/iter; left time: 8.0703s
	iters: 800, epoch: 6 | loss: 0.4605658
	speed: 0.0031s/iter; left time: 7.1647s
	iters: 900, epoch: 6 | loss: 1.4155169
	speed: 0.0030s/iter; left time: 6.7164s
	iters: 1000, epoch: 6 | loss: 1.4094380
	speed: 0.0031s/iter; left time: 6.6229s
Updating learning rate to 8.593022284349414e-05
Epoch: 6 cost time: 3.517796039581299
Epoch: 6, Steps: 1045 | Train Loss: 0.6860868 Vali Loss: 0.3117092 Best vali loss: 0.2880622
	iters: 100, epoch: 7 | loss: 0.3731741
	speed: 0.0098s/iter; left time: 19.4253s
	iters: 200, epoch: 7 | loss: 0.8509268
	speed: 0.0032s/iter; left time: 6.0061s
	iters: 300, epoch: 7 | loss: 0.3685472
	speed: 0.0032s/iter; left time: 5.7216s
	iters: 400, epoch: 7 | loss: 0.1974186
	speed: 0.0031s/iter; left time: 5.3228s
	iters: 500, epoch: 7 | loss: 0.5593527
	speed: 0.0032s/iter; left time: 5.1374s
	iters: 600, epoch: 7 | loss: 0.3899326
	speed: 0.0031s/iter; left time: 4.6769s
	iters: 700, epoch: 7 | loss: 0.3276066
	speed: 0.0031s/iter; left time: 4.3425s
	iters: 800, epoch: 7 | loss: 1.0633426
	speed: 0.0030s/iter; left time: 3.8969s
	iters: 900, epoch: 7 | loss: 0.4202946
	speed: 0.0030s/iter; left time: 3.5566s
	iters: 1000, epoch: 7 | loss: 0.2254948
	speed: 0.0030s/iter; left time: 3.2534s
Updating learning rate to 2.2332537300640478e-05
Epoch: 7 cost time: 3.2841203212738037
Epoch: 7, Steps: 1045 | Train Loss: 0.4776090 Vali Loss: 0.3142041 Best vali loss: 0.2880622
	iters: 100, epoch: 8 | loss: 0.6845405
	speed: 0.0103s/iter; left time: 9.7155s
	iters: 200, epoch: 8 | loss: 0.5780939
	speed: 0.0032s/iter; left time: 2.7037s
	iters: 300, epoch: 8 | loss: 0.3379260
	speed: 0.0031s/iter; left time: 2.3491s
	iters: 400, epoch: 8 | loss: 0.3316270
	speed: 0.0032s/iter; left time: 2.0627s
	iters: 500, epoch: 8 | loss: 0.2226285
	speed: 0.0033s/iter; left time: 1.7751s
	iters: 600, epoch: 8 | loss: 0.3343102
	speed: 0.0033s/iter; left time: 1.4753s
	iters: 700, epoch: 8 | loss: 0.2246085
	speed: 0.0033s/iter; left time: 1.1333s
	iters: 800, epoch: 8 | loss: 0.4435106
	speed: 0.0032s/iter; left time: 0.7759s
	iters: 900, epoch: 8 | loss: 0.2361383
	speed: 0.0031s/iter; left time: 0.4508s
	iters: 1000, epoch: 8 | loss: 0.2110564
	speed: 0.0030s/iter; left time: 0.1396s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.3665881156921387
Epoch: 8, Steps: 1045 | Train Loss: 0.3604440 Vali Loss: 0.3136130 Best vali loss: 0.2880622

best validation loss 0.28806215721397604

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008236207945, 'e_layers': 2, 'learning_rate': 0.0005612752553, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5412248
	speed: 0.0086s/iter; left time: 71.0731s
	iters: 200, epoch: 1 | loss: 0.6929041
	speed: 0.0033s/iter; left time: 26.9156s
	iters: 300, epoch: 1 | loss: 0.3864804
	speed: 0.0033s/iter; left time: 26.5836s
	iters: 400, epoch: 1 | loss: 1.1644682
	speed: 0.0033s/iter; left time: 26.0586s
	iters: 500, epoch: 1 | loss: 0.3535002
	speed: 0.0033s/iter; left time: 26.1921s
	iters: 600, epoch: 1 | loss: 0.3812622
	speed: 0.0034s/iter; left time: 26.3831s
	iters: 700, epoch: 1 | loss: 0.5062680
	speed: 0.0033s/iter; left time: 25.6518s
	iters: 800, epoch: 1 | loss: 0.2637978
	speed: 0.0033s/iter; left time: 25.3228s
	iters: 900, epoch: 1 | loss: 0.8710938
	speed: 0.0034s/iter; left time: 25.3043s
	iters: 1000, epoch: 1 | loss: 0.5581110
	speed: 0.0033s/iter; left time: 24.4692s
Updating learning rate to 0.0005399129878883585
Validation loss decreased (inf --> 0.2988).  Saving model state dict ...
Epoch: 1 cost time: 3.7420990467071533
Epoch: 1, Steps: 1045 | Train Loss: 0.5719111 Vali Loss: 0.2988226 Best vali loss: 0.2988226
	iters: 100, epoch: 2 | loss: 2.4090302
	speed: 0.0102s/iter; left time: 73.4984s
	iters: 200, epoch: 2 | loss: 0.3295452
	speed: 0.0033s/iter; left time: 23.4842s
	iters: 300, epoch: 2 | loss: 0.3373479
	speed: 0.0033s/iter; left time: 23.3657s
	iters: 400, epoch: 2 | loss: 0.4593377
	speed: 0.0033s/iter; left time: 22.8755s
	iters: 500, epoch: 2 | loss: 0.2659647
	speed: 0.0033s/iter; left time: 22.6448s
	iters: 600, epoch: 2 | loss: 1.0150226
	speed: 0.0033s/iter; left time: 22.3179s
	iters: 700, epoch: 2 | loss: 0.4126652
	speed: 0.0033s/iter; left time: 21.8794s
	iters: 800, epoch: 2 | loss: 0.4717738
	speed: 0.0033s/iter; left time: 21.5038s
	iters: 900, epoch: 2 | loss: 0.2221268
	speed: 0.0033s/iter; left time: 21.4895s
	iters: 1000, epoch: 2 | loss: 1.0538083
	speed: 0.0033s/iter; left time: 21.0986s
Updating learning rate to 0.00047907839721742033
Validation loss decreased (0.2988 --> 0.2921).  Saving model state dict ...
Epoch: 2 cost time: 3.509977102279663
Epoch: 2, Steps: 1045 | Train Loss: 0.6976622 Vali Loss: 0.2921367 Best vali loss: 0.2921367
	iters: 100, epoch: 3 | loss: 0.7436258
	speed: 0.0104s/iter; left time: 63.9669s
	iters: 200, epoch: 3 | loss: 0.3436099
	speed: 0.0033s/iter; left time: 20.2469s
	iters: 300, epoch: 3 | loss: 0.1636857
	speed: 0.0033s/iter; left time: 19.9094s
	iters: 400, epoch: 3 | loss: 0.1518620
	speed: 0.0033s/iter; left time: 19.4855s
	iters: 500, epoch: 3 | loss: 1.1439854
	speed: 0.0033s/iter; left time: 19.1348s
	iters: 600, epoch: 3 | loss: 0.3585941
	speed: 0.0033s/iter; left time: 18.8881s
	iters: 700, epoch: 3 | loss: 0.1806679
	speed: 0.0033s/iter; left time: 18.5612s
	iters: 800, epoch: 3 | loss: 1.3366561
	speed: 0.0034s/iter; left time: 18.3382s
	iters: 900, epoch: 3 | loss: 0.3297767
	speed: 0.0033s/iter; left time: 17.7511s
	iters: 1000, epoch: 3 | loss: 0.3126004
	speed: 0.0033s/iter; left time: 17.3457s
Updating learning rate to 0.000388032998249898
Epoch: 3 cost time: 3.5085740089416504
Epoch: 3, Steps: 1045 | Train Loss: 0.5065064 Vali Loss: 0.2948985 Best vali loss: 0.2921367
	iters: 100, epoch: 4 | loss: 0.4793685
	speed: 0.0103s/iter; left time: 52.5719s
	iters: 200, epoch: 4 | loss: 1.5454829
	speed: 0.0033s/iter; left time: 16.6548s
	iters: 300, epoch: 4 | loss: 0.2487595
	speed: 0.0034s/iter; left time: 16.5092s
	iters: 400, epoch: 4 | loss: 0.4106683
	speed: 0.0033s/iter; left time: 16.0380s
	iters: 500, epoch: 4 | loss: 0.3995230
	speed: 0.0033s/iter; left time: 15.7732s
	iters: 600, epoch: 4 | loss: 0.2238888
	speed: 0.0033s/iter; left time: 15.4787s
	iters: 700, epoch: 4 | loss: 0.3602576
	speed: 0.0033s/iter; left time: 15.0254s
	iters: 800, epoch: 4 | loss: 0.3053234
	speed: 0.0033s/iter; left time: 14.6210s
	iters: 900, epoch: 4 | loss: 0.6087705
	speed: 0.0033s/iter; left time: 14.4497s
	iters: 1000, epoch: 4 | loss: 0.3291498
	speed: 0.0033s/iter; left time: 14.0752s
Updating learning rate to 0.00028063762765
Epoch: 4 cost time: 3.515479564666748
Epoch: 4, Steps: 1045 | Train Loss: 0.4911192 Vali Loss: 0.2939817 Best vali loss: 0.2921367
	iters: 100, epoch: 5 | loss: 0.5535395
	speed: 0.0100s/iter; left time: 40.7261s
	iters: 200, epoch: 5 | loss: 0.3021062
	speed: 0.0033s/iter; left time: 13.1555s
	iters: 300, epoch: 5 | loss: 0.4716479
	speed: 0.0033s/iter; left time: 12.6885s
	iters: 400, epoch: 5 | loss: 0.3138229
	speed: 0.0033s/iter; left time: 12.4262s
	iters: 500, epoch: 5 | loss: 0.3193221
	speed: 0.0033s/iter; left time: 12.0132s
	iters: 600, epoch: 5 | loss: 0.4908416
	speed: 0.0033s/iter; left time: 11.7283s
	iters: 700, epoch: 5 | loss: 1.1054274
	speed: 0.0033s/iter; left time: 11.5224s
	iters: 800, epoch: 5 | loss: 0.3932106
	speed: 0.0033s/iter; left time: 11.1625s
	iters: 900, epoch: 5 | loss: 0.9976751
	speed: 0.0032s/iter; left time: 10.6574s
	iters: 1000, epoch: 5 | loss: 0.2379938
	speed: 0.0033s/iter; left time: 10.5940s
Updating learning rate to 0.00017324225705010198
Validation loss decreased (0.2921 --> 0.2908).  Saving model state dict ...
Epoch: 5 cost time: 3.47139835357666
Epoch: 5, Steps: 1045 | Train Loss: 0.5185587 Vali Loss: 0.2907766 Best vali loss: 0.2907766
	iters: 100, epoch: 6 | loss: 0.2038302
	speed: 0.0103s/iter; left time: 31.3536s
	iters: 200, epoch: 6 | loss: 0.7351592
	speed: 0.0034s/iter; left time: 9.9626s
	iters: 300, epoch: 6 | loss: 0.4278511
	speed: 0.0034s/iter; left time: 9.7590s
	iters: 400, epoch: 6 | loss: 0.3697989
	speed: 0.0034s/iter; left time: 9.3312s
	iters: 500, epoch: 6 | loss: 0.2834526
	speed: 0.0034s/iter; left time: 8.9321s
	iters: 600, epoch: 6 | loss: 0.1799293
	speed: 0.0034s/iter; left time: 8.5990s
	iters: 700, epoch: 6 | loss: 1.5208344
	speed: 0.0034s/iter; left time: 8.2784s
	iters: 800, epoch: 6 | loss: 0.4742302
	speed: 0.0033s/iter; left time: 7.8082s
	iters: 900, epoch: 6 | loss: 1.6732955
	speed: 0.0034s/iter; left time: 7.6048s
	iters: 1000, epoch: 6 | loss: 2.0281758
	speed: 0.0034s/iter; left time: 7.3164s
Updating learning rate to 8.219685808257967e-05
Epoch: 6 cost time: 3.5872445106506348
Epoch: 6, Steps: 1045 | Train Loss: 0.7896557 Vali Loss: 0.2988530 Best vali loss: 0.2907766
	iters: 100, epoch: 7 | loss: 0.3728046
	speed: 0.0099s/iter; left time: 19.7733s
	iters: 200, epoch: 7 | loss: 0.9659496
	speed: 0.0031s/iter; left time: 5.8040s
	iters: 300, epoch: 7 | loss: 0.5906532
	speed: 0.0030s/iter; left time: 5.4273s
	iters: 400, epoch: 7 | loss: 0.2069819
	speed: 0.0031s/iter; left time: 5.1918s
	iters: 500, epoch: 7 | loss: 0.5885589
	speed: 0.0030s/iter; left time: 4.8525s
	iters: 600, epoch: 7 | loss: 0.4033934
	speed: 0.0031s/iter; left time: 4.5741s
	iters: 700, epoch: 7 | loss: 0.3663996
	speed: 0.0031s/iter; left time: 4.2868s
	iters: 800, epoch: 7 | loss: 1.2321337
	speed: 0.0031s/iter; left time: 3.9515s
	iters: 900, epoch: 7 | loss: 0.5047412
	speed: 0.0031s/iter; left time: 3.6335s
	iters: 1000, epoch: 7 | loss: 0.2221118
	speed: 0.0030s/iter; left time: 3.3186s
Updating learning rate to 2.136226741164144e-05
Epoch: 7 cost time: 3.2357535362243652
Epoch: 7, Steps: 1045 | Train Loss: 0.5453728 Vali Loss: 0.3066307 Best vali loss: 0.2907766
	iters: 100, epoch: 8 | loss: 0.7305307
	speed: 0.0098s/iter; left time: 9.2490s
	iters: 200, epoch: 8 | loss: 0.6289682
	speed: 0.0030s/iter; left time: 2.5306s
	iters: 300, epoch: 8 | loss: 0.3863534
	speed: 0.0030s/iter; left time: 2.2219s
	iters: 400, epoch: 8 | loss: 0.3235004
	speed: 0.0030s/iter; left time: 1.9138s
	iters: 500, epoch: 8 | loss: 0.2334714
	speed: 0.0030s/iter; left time: 1.6334s
	iters: 600, epoch: 8 | loss: 0.4099159
	speed: 0.0030s/iter; left time: 1.3227s
	iters: 700, epoch: 8 | loss: 0.2463651
	speed: 0.0030s/iter; left time: 1.0220s
	iters: 800, epoch: 8 | loss: 0.3982728
	speed: 0.0029s/iter; left time: 0.7226s
	iters: 900, epoch: 8 | loss: 0.2359635
	speed: 0.0030s/iter; left time: 0.4412s
	iters: 1000, epoch: 8 | loss: 0.2045159
	speed: 0.0029s/iter; left time: 0.1342s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1427745819091797
Epoch: 8, Steps: 1045 | Train Loss: 0.3797857 Vali Loss: 0.3091062 Best vali loss: 0.2907766

best validation loss 0.2907765580735361

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008324953268, 'e_layers': 2, 'learning_rate': 0.0005604401812, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5426275
	speed: 0.0086s/iter; left time: 70.9048s
	iters: 200, epoch: 1 | loss: 0.6885765
	speed: 0.0033s/iter; left time: 26.7751s
	iters: 300, epoch: 1 | loss: 0.4250457
	speed: 0.0033s/iter; left time: 26.8448s
	iters: 400, epoch: 1 | loss: 1.0982604
	speed: 0.0033s/iter; left time: 26.3054s
	iters: 500, epoch: 1 | loss: 0.3666600
	speed: 0.0033s/iter; left time: 25.7955s
	iters: 600, epoch: 1 | loss: 0.3960604
	speed: 0.0033s/iter; left time: 25.4721s
	iters: 700, epoch: 1 | loss: 0.5568246
	speed: 0.0033s/iter; left time: 25.1787s
	iters: 800, epoch: 1 | loss: 0.2695972
	speed: 0.0033s/iter; left time: 24.8743s
	iters: 900, epoch: 1 | loss: 0.6862381
	speed: 0.0033s/iter; left time: 24.6255s
	iters: 1000, epoch: 1 | loss: 0.5312118
	speed: 0.0033s/iter; left time: 24.4689s
Updating learning rate to 0.0005391096969037984
Validation loss decreased (inf --> 0.3065).  Saving model state dict ...
Epoch: 1 cost time: 3.7104251384735107
Epoch: 1, Steps: 1045 | Train Loss: 0.5561102 Vali Loss: 0.3064672 Best vali loss: 0.3064672
	iters: 100, epoch: 2 | loss: 2.5144777
	speed: 0.0103s/iter; left time: 74.5391s
	iters: 200, epoch: 2 | loss: 0.3188885
	speed: 0.0033s/iter; left time: 23.7011s
	iters: 300, epoch: 2 | loss: 0.4309325
	speed: 0.0033s/iter; left time: 23.3362s
	iters: 400, epoch: 2 | loss: 0.5056570
	speed: 0.0033s/iter; left time: 22.9521s
	iters: 500, epoch: 2 | loss: 0.2253632
	speed: 0.0033s/iter; left time: 22.4576s
	iters: 600, epoch: 2 | loss: 1.1320000
	speed: 0.0033s/iter; left time: 22.3678s
	iters: 700, epoch: 2 | loss: 0.4276799
	speed: 0.0034s/iter; left time: 22.1770s
	iters: 800, epoch: 2 | loss: 0.5050423
	speed: 0.0033s/iter; left time: 21.6187s
	iters: 900, epoch: 2 | loss: 0.2560676
	speed: 0.0033s/iter; left time: 21.3652s
	iters: 1000, epoch: 2 | loss: 1.0617785
	speed: 0.0033s/iter; left time: 21.0284s
Updating learning rate to 0.00047836561688796873
Epoch: 2 cost time: 3.514725685119629
Epoch: 2, Steps: 1045 | Train Loss: 0.7377887 Vali Loss: 0.3138944 Best vali loss: 0.3064672
	iters: 100, epoch: 3 | loss: 0.9649740
	speed: 0.0102s/iter; left time: 62.9700s
	iters: 200, epoch: 3 | loss: 0.3839840
	speed: 0.0033s/iter; left time: 20.1998s
	iters: 300, epoch: 3 | loss: 0.1930885
	speed: 0.0033s/iter; left time: 19.8070s
	iters: 400, epoch: 3 | loss: 0.1605448
	speed: 0.0033s/iter; left time: 19.5260s
	iters: 500, epoch: 3 | loss: 1.3122211
	speed: 0.0033s/iter; left time: 19.2923s
	iters: 600, epoch: 3 | loss: 0.3786768
	speed: 0.0033s/iter; left time: 18.8045s
	iters: 700, epoch: 3 | loss: 0.1980285
	speed: 0.0033s/iter; left time: 18.4428s
	iters: 800, epoch: 3 | loss: 1.4690490
	speed: 0.0033s/iter; left time: 18.2425s
	iters: 900, epoch: 3 | loss: 0.3545067
	speed: 0.0033s/iter; left time: 17.8805s
	iters: 1000, epoch: 3 | loss: 0.3168097
	speed: 0.0033s/iter; left time: 17.5864s
Updating learning rate to 0.00038745567668846447
Validation loss decreased (0.3065 --> 0.3033).  Saving model state dict ...
Epoch: 3 cost time: 3.513620138168335
Epoch: 3, Steps: 1045 | Train Loss: 0.5731883 Vali Loss: 0.3032877 Best vali loss: 0.3032877

best validation loss 0.3032876821910196

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0110445867638, 'e_layers': 4, 'learning_rate': 0.0001011013582, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7956478
	speed: 0.0113s/iter; left time: 10.6912s
Updating learning rate to 0.0001011013582
Validation loss decreased (inf --> 0.2891).  Saving model state dict ...
Epoch: 1 cost time: 1.029223918914795
Epoch: 1, Steps: 131 | Train Loss: 0.7956478 Vali Loss: 0.2890604 Best vali loss: 0.2890604
	iters: 100, epoch: 2 | loss: 0.7311602
	speed: 0.0092s/iter; left time: 7.5332s
Updating learning rate to 5.05506791e-05
Validation loss decreased (0.2891 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 0.726982593536377
Epoch: 2, Steps: 131 | Train Loss: 0.7311602 Vali Loss: 0.2819487 Best vali loss: 0.2819487
	iters: 100, epoch: 3 | loss: 0.7373720
	speed: 0.0087s/iter; left time: 5.9687s
Updating learning rate to 2.527533955e-05
Validation loss decreased (0.2819 --> 0.2802).  Saving model state dict ...
Epoch: 3 cost time: 0.707859992980957
Epoch: 3, Steps: 131 | Train Loss: 0.7373720 Vali Loss: 0.2801697 Best vali loss: 0.2801697

best validation loss 0.28016968889943994

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0021231936327, 'e_layers': 2, 'learning_rate': 0.0003114181316, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5917169
	speed: 0.0093s/iter; left time: 8.8587s
Updating learning rate to 0.00029956548471907316
Validation loss decreased (inf --> 0.2891).  Saving model state dict ...
Epoch: 1 cost time: 0.7721211910247803
Epoch: 1, Steps: 131 | Train Loss: 0.5917169 Vali Loss: 0.2890636 Best vali loss: 0.2890636
	iters: 100, epoch: 2 | loss: 0.6136352
	speed: 0.0068s/iter; left time: 5.5368s
Updating learning rate to 0.0002658120021194023
Validation loss decreased (0.2891 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.5526258945465088
Epoch: 2, Steps: 131 | Train Loss: 0.6136352 Vali Loss: 0.2826231 Best vali loss: 0.2826231
	iters: 100, epoch: 3 | loss: 0.6697710
	speed: 0.0067s/iter; left time: 4.5918s
Updating learning rate to 0.0002152963455507056
Epoch: 3 cost time: 0.5243263244628906
Epoch: 3, Steps: 131 | Train Loss: 0.6697710 Vali Loss: 0.2830705 Best vali loss: 0.2826231

best validation loss 0.2826230912436425

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0110445867638, 'e_layers': 4, 'learning_rate': 0.0001011013582, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6781949
	speed: 0.0112s/iter; left time: 6.2294s
Updating learning rate to 1.2637669775e-05
Validation loss decreased (0.2802 --> 0.2795).  Saving model state dict ...
Epoch: 4 cost time: 1.020632266998291
Epoch: 4, Steps: 131 | Train Loss: 0.6781949 Vali Loss: 0.2795040 Best vali loss: 0.2795040
	iters: 100, epoch: 5 | loss: 0.6978759
	speed: 0.0090s/iter; left time: 3.8315s
Updating learning rate to 6.3188348875e-06
Validation loss decreased (0.2795 --> 0.2795).  Saving model state dict ...
Epoch: 5 cost time: 0.7307298183441162
Epoch: 5, Steps: 131 | Train Loss: 0.6978759 Vali Loss: 0.2794618 Best vali loss: 0.2794618
	iters: 100, epoch: 6 | loss: 0.7260005
	speed: 0.0089s/iter; left time: 2.6164s
Updating learning rate to 3.15941744375e-06
Epoch: 6 cost time: 0.7449016571044922
Epoch: 6, Steps: 131 | Train Loss: 0.7260005 Vali Loss: 0.2796208 Best vali loss: 0.2794618
	iters: 100, epoch: 7 | loss: 0.6406072
	speed: 0.0089s/iter; left time: 1.4482s
Updating learning rate to 1.579708721875e-06
Epoch: 7 cost time: 0.7626304626464844
Epoch: 7, Steps: 131 | Train Loss: 0.6406072 Vali Loss: 0.2795972 Best vali loss: 0.2794618
	iters: 100, epoch: 8 | loss: 0.5749881
	speed: 0.0092s/iter; left time: 0.2931s
Updating learning rate to 7.898543609375e-07
Epoch: 8 cost time: 0.7672758102416992
Epoch: 8, Steps: 131 | Train Loss: 0.5749881 Vali Loss: 0.2796140 Best vali loss: 0.2794618

best validation loss 0.27946176899437036

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269910981, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597190
	speed: 0.0104s/iter; left time: 9.8377s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9301168918609619
Epoch: 1, Steps: 131 | Train Loss: 0.5597190 Vali Loss: 0.2756285 Best vali loss: 0.2756285
	iters: 100, epoch: 2 | loss: 0.3251027
	speed: 0.0089s/iter; left time: 7.3154s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2756 --> 0.2687).  Saving model state dict ...
Epoch: 2 cost time: 0.7034640312194824
Epoch: 2, Steps: 131 | Train Loss: 0.3251027 Vali Loss: 0.2687037 Best vali loss: 0.2687037
	iters: 100, epoch: 3 | loss: 0.4611880
	speed: 0.0090s/iter; left time: 6.1683s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.7000198364257812
Epoch: 3, Steps: 131 | Train Loss: 0.4611880 Vali Loss: 0.2782691 Best vali loss: 0.2687037
	iters: 100, epoch: 4 | loss: 0.4997675
	speed: 0.0086s/iter; left time: 4.7969s
Updating learning rate to 2.9316150425e-05
Epoch: 4 cost time: 0.693199872970581
Epoch: 4, Steps: 131 | Train Loss: 0.4997675 Vali Loss: 0.2825605 Best vali loss: 0.2687037
	iters: 100, epoch: 5 | loss: 0.3350612
	speed: 0.0086s/iter; left time: 3.6382s
Updating learning rate to 1.46580752125e-05
Epoch: 5 cost time: 0.6958799362182617
Epoch: 5, Steps: 131 | Train Loss: 0.3350612 Vali Loss: 0.2857200 Best vali loss: 0.2687037
	iters: 100, epoch: 6 | loss: 0.3167257
	speed: 0.0086s/iter; left time: 2.5263s
Updating learning rate to 7.32903760625e-06
Epoch: 6 cost time: 0.6991589069366455
Epoch: 6, Steps: 131 | Train Loss: 0.3167257 Vali Loss: 0.2843423 Best vali loss: 0.2687037
	iters: 100, epoch: 7 | loss: 0.3122940
	speed: 0.0087s/iter; left time: 1.4204s
Updating learning rate to 3.664518803125e-06
Epoch: 7 cost time: 0.7040512561798096
Epoch: 7, Steps: 131 | Train Loss: 0.3122940 Vali Loss: 0.2896066 Best vali loss: 0.2687037
	iters: 100, epoch: 8 | loss: 0.3968060
	speed: 0.0086s/iter; left time: 0.2740s
Updating learning rate to 1.8322594015625e-06
Epoch: 8 cost time: 0.6961956024169922
Epoch: 8, Steps: 131 | Train Loss: 0.3968060 Vali Loss: 0.2909500 Best vali loss: 0.2687037

best validation loss 0.26870373432278943

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009535668006, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596246
	speed: 0.0104s/iter; left time: 9.8853s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.922476053237915
Epoch: 1, Steps: 131 | Train Loss: 0.5596246 Vali Loss: 0.2756690 Best vali loss: 0.2756690
	iters: 100, epoch: 2 | loss: 0.3255533
	speed: 0.0088s/iter; left time: 7.2094s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2712).  Saving model state dict ...
Epoch: 2 cost time: 0.7020556926727295
Epoch: 2, Steps: 131 | Train Loss: 0.3255533 Vali Loss: 0.2711506 Best vali loss: 0.2711506
	iters: 100, epoch: 3 | loss: 0.4622154
	speed: 0.0091s/iter; left time: 6.2341s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7087647914886475
Epoch: 3, Steps: 131 | Train Loss: 0.4622154 Vali Loss: 0.2811652 Best vali loss: 0.2711506
	iters: 100, epoch: 4 | loss: 0.5041597
	speed: 0.0086s/iter; left time: 4.7743s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6962385177612305
Epoch: 4, Steps: 131 | Train Loss: 0.5041597 Vali Loss: 0.2921013 Best vali loss: 0.2711506
	iters: 100, epoch: 5 | loss: 0.3335848
	speed: 0.0086s/iter; left time: 3.6742s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7015774250030518
Epoch: 5, Steps: 131 | Train Loss: 0.3335848 Vali Loss: 0.2895642 Best vali loss: 0.2711506
	iters: 100, epoch: 6 | loss: 0.3180839
	speed: 0.0087s/iter; left time: 2.5434s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.697777271270752
Epoch: 6, Steps: 131 | Train Loss: 0.3180839 Vali Loss: 0.2945237 Best vali loss: 0.2711506
	iters: 100, epoch: 7 | loss: 0.3117288
	speed: 0.0087s/iter; left time: 1.4221s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7022843360900879
Epoch: 7, Steps: 131 | Train Loss: 0.3117288 Vali Loss: 0.3006463 Best vali loss: 0.2711506
	iters: 100, epoch: 8 | loss: 0.3982513
	speed: 0.0087s/iter; left time: 0.2779s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6959729194641113
Epoch: 8, Steps: 131 | Train Loss: 0.3982513 Vali Loss: 0.3016078 Best vali loss: 0.2711506

best validation loss 0.2711506137266262

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014736807504, 'e_layers': 1, 'learning_rate': 0.0001131228152, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2834168
	speed: 0.0077s/iter; left time: 63.8125s
	iters: 200, epoch: 1 | loss: 0.2971038
	speed: 0.0024s/iter; left time: 19.3242s
	iters: 300, epoch: 1 | loss: 0.3075972
	speed: 0.0024s/iter; left time: 19.3953s
	iters: 400, epoch: 1 | loss: 0.8464664
	speed: 0.0024s/iter; left time: 19.1047s
	iters: 500, epoch: 1 | loss: 0.9989873
	speed: 0.0024s/iter; left time: 18.8848s
	iters: 600, epoch: 1 | loss: 0.2689430
	speed: 0.0024s/iter; left time: 18.5871s
	iters: 700, epoch: 1 | loss: 0.8764557
	speed: 0.0023s/iter; left time: 17.4986s
	iters: 800, epoch: 1 | loss: 0.3837741
	speed: 0.0023s/iter; left time: 17.1770s
	iters: 900, epoch: 1 | loss: 1.0471041
	speed: 0.0023s/iter; left time: 16.8996s
	iters: 1000, epoch: 1 | loss: 0.2380023
	speed: 0.0023s/iter; left time: 16.6732s
Updating learning rate to 0.00010881733441166834
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 2.709484815597534
Epoch: 1, Steps: 1045 | Train Loss: 0.5547851 Vali Loss: 0.2861112 Best vali loss: 0.2861112
	iters: 100, epoch: 2 | loss: 0.2916951
	speed: 0.0080s/iter; left time: 57.8450s
	iters: 200, epoch: 2 | loss: 0.3041365
	speed: 0.0024s/iter; left time: 17.0284s
	iters: 300, epoch: 2 | loss: 0.2164384
	speed: 0.0024s/iter; left time: 16.6362s
	iters: 400, epoch: 2 | loss: 0.2449969
	speed: 0.0024s/iter; left time: 16.6743s
	iters: 500, epoch: 2 | loss: 0.2458966
	speed: 0.0024s/iter; left time: 16.4235s
	iters: 600, epoch: 2 | loss: 0.2036722
	speed: 0.0023s/iter; left time: 15.7156s
	iters: 700, epoch: 2 | loss: 0.2699253
	speed: 0.0023s/iter; left time: 15.4811s
	iters: 800, epoch: 2 | loss: 0.2605376
	speed: 0.0024s/iter; left time: 15.3279s
	iters: 900, epoch: 2 | loss: 0.2312951
	speed: 0.0023s/iter; left time: 15.0480s
	iters: 1000, epoch: 2 | loss: 0.5123174
	speed: 0.0023s/iter; left time: 14.6961s
Updating learning rate to 9.655636246741633e-05
Validation loss decreased (0.2861 --> 0.2782).  Saving model state dict ...
Epoch: 2 cost time: 2.5101280212402344
Epoch: 2, Steps: 1045 | Train Loss: 0.2780911 Vali Loss: 0.2781850 Best vali loss: 0.2781850
	iters: 100, epoch: 3 | loss: 0.4408067
	speed: 0.0080s/iter; left time: 49.4489s
	iters: 200, epoch: 3 | loss: 1.1304781
	speed: 0.0023s/iter; left time: 14.1240s
	iters: 300, epoch: 3 | loss: 0.5712911
	speed: 0.0023s/iter; left time: 13.9978s
	iters: 400, epoch: 3 | loss: 0.2937680
	speed: 0.0024s/iter; left time: 13.8132s
	iters: 500, epoch: 3 | loss: 0.3200137
	speed: 0.0023s/iter; left time: 13.2559s
	iters: 600, epoch: 3 | loss: 0.4112342
	speed: 0.0023s/iter; left time: 13.0295s
	iters: 700, epoch: 3 | loss: 0.1650884
	speed: 0.0023s/iter; left time: 12.6984s
	iters: 800, epoch: 3 | loss: 0.2083990
	speed: 0.0023s/iter; left time: 12.4821s
	iters: 900, epoch: 3 | loss: 0.5898000
	speed: 0.0023s/iter; left time: 12.3497s
	iters: 1000, epoch: 3 | loss: 0.3572804
	speed: 0.0023s/iter; left time: 12.0493s
Updating learning rate to 7.820652119976888e-05
Epoch: 3 cost time: 2.4589405059814453
Epoch: 3, Steps: 1045 | Train Loss: 0.4488160 Vali Loss: 0.2952539 Best vali loss: 0.2781850

best validation loss 0.2781849957811385

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0065920528184, 'e_layers': 3, 'learning_rate': 0.0022719067545, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6730952
	speed: 0.0096s/iter; left time: 19.1724s
	iters: 200, epoch: 1 | loss: 0.8352363
	speed: 0.0044s/iter; left time: 8.3507s
Updating learning rate to 0.0022719067545
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.4135406017303467
Epoch: 1, Steps: 262 | Train Loss: 0.7541658 Vali Loss: 0.2873582 Best vali loss: 0.2873582
	iters: 100, epoch: 2 | loss: 0.4294244
	speed: 0.0096s/iter; left time: 16.6881s
	iters: 200, epoch: 2 | loss: 0.7206510
	speed: 0.0044s/iter; left time: 7.2735s
Updating learning rate to 0.00113595337725
Epoch: 2 cost time: 1.2067830562591553
Epoch: 2, Steps: 262 | Train Loss: 0.5750377 Vali Loss: 0.2933140 Best vali loss: 0.2873582
	iters: 100, epoch: 3 | loss: 0.3774065
	speed: 0.0097s/iter; left time: 14.3531s
	iters: 200, epoch: 3 | loss: 0.4162115
	speed: 0.0046s/iter; left time: 6.3333s
Updating learning rate to 0.000567976688625
Epoch: 3 cost time: 1.2458415031433105
Epoch: 3, Steps: 262 | Train Loss: 0.3968090 Vali Loss: 0.2927081 Best vali loss: 0.2873582

best validation loss 0.28735823682157824

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002365601026, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5599845
	speed: 0.0104s/iter; left time: 9.8371s
Updating learning rate to 0.0002365601026
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9314773082733154
Epoch: 1, Steps: 131 | Train Loss: 0.5599845 Vali Loss: 0.2756672 Best vali loss: 0.2756672
	iters: 100, epoch: 2 | loss: 0.3243997
	speed: 0.0089s/iter; left time: 7.2505s
Updating learning rate to 0.0001182800513
Validation loss decreased (0.2757 --> 0.2708).  Saving model state dict ...
Epoch: 2 cost time: 0.6914463043212891
Epoch: 2, Steps: 131 | Train Loss: 0.3243997 Vali Loss: 0.2708262 Best vali loss: 0.2708262
	iters: 100, epoch: 3 | loss: 0.4613337
	speed: 0.0089s/iter; left time: 6.1031s
Updating learning rate to 5.914002565e-05
Epoch: 3 cost time: 0.702538013458252
Epoch: 3, Steps: 131 | Train Loss: 0.4613337 Vali Loss: 0.2784198 Best vali loss: 0.2708262

best validation loss 0.27082623928707744

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025917739, 'e_layers': 2, 'learning_rate': 0.0002365601026, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4199211
	speed: 0.0108s/iter; left time: 6.0114s
Updating learning rate to 2.9570012825e-05
Epoch: 4 cost time: 0.9344611167907715
Epoch: 4, Steps: 131 | Train Loss: 0.4199211 Vali Loss: 0.3089103 Best vali loss: 0.2708262
	iters: 100, epoch: 5 | loss: 0.2820731
	speed: 0.0087s/iter; left time: 3.6773s
Updating learning rate to 1.47850064125e-05
Epoch: 5 cost time: 0.6957345008850098
Epoch: 5, Steps: 131 | Train Loss: 0.2820731 Vali Loss: 0.2994455 Best vali loss: 0.2708262
	iters: 100, epoch: 6 | loss: 0.4318382
	speed: 0.0087s/iter; left time: 2.5564s
Updating learning rate to 7.39250320625e-06
Epoch: 6 cost time: 0.7078440189361572
Epoch: 6, Steps: 131 | Train Loss: 0.4318382 Vali Loss: 0.3034939 Best vali loss: 0.2708262
	iters: 100, epoch: 7 | loss: 0.4667252
	speed: 0.0087s/iter; left time: 1.4216s
Updating learning rate to 3.696251603125e-06
Epoch: 7 cost time: 0.7021076679229736
Epoch: 7, Steps: 131 | Train Loss: 0.4667252 Vali Loss: 0.3010453 Best vali loss: 0.2708262
	iters: 100, epoch: 8 | loss: 0.3298542
	speed: 0.0087s/iter; left time: 0.2787s
Updating learning rate to 1.8481258015625e-06
Epoch: 8 cost time: 0.6996400356292725
Epoch: 8, Steps: 131 | Train Loss: 0.3298542 Vali Loss: 0.2990486 Best vali loss: 0.2708262

best validation loss 0.27082623928707744

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0021310255605, 'e_layers': 2, 'learning_rate': 0.0020167452075, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019399874134997392
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 0.5566973686218262
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2875796 Best vali loss: 0.2875796
Updating learning rate to 0.0017213997098243605
Epoch: 2 cost time: 0.4860575199127197
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2981160 Best vali loss: 0.2875796
Updating learning rate to 0.0013942600928559727
Validation loss decreased (0.2876 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 0.3275296688079834
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2838740 Best vali loss: 0.2838740
Updating learning rate to 0.00100837260375
Epoch: 4 cost time: 0.3372988700866699
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3016403 Best vali loss: 0.2838740
Updating learning rate to 0.0006224851146440275
Epoch: 5 cost time: 0.3202962875366211
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2978694 Best vali loss: 0.2838740
Updating learning rate to 0.00029534549767563966
Epoch: 6 cost time: 0.33573269844055176
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3030953 Best vali loss: 0.2838740
Updating learning rate to 7.675779400026102e-05
Epoch: 7 cost time: 0.3185570240020752
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3020676 Best vali loss: 0.2838740
Updating learning rate to 0.0
Epoch: 8 cost time: 0.32221508026123047
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3026656 Best vali loss: 0.2838740

best validation loss 0.2838739980747816

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0084866854837, 'e_layers': 3, 'learning_rate': 0.0021365145901, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3922729
	speed: 0.0093s/iter; left time: 76.6807s
	iters: 200, epoch: 1 | loss: 1.4541484
	speed: 0.0041s/iter; left time: 33.5628s
	iters: 300, epoch: 1 | loss: 1.3573387
	speed: 0.0042s/iter; left time: 33.6125s
	iters: 400, epoch: 1 | loss: 0.2181830
	speed: 0.0042s/iter; left time: 33.1480s
	iters: 500, epoch: 1 | loss: 2.0854347
	speed: 0.0042s/iter; left time: 32.8116s
	iters: 600, epoch: 1 | loss: 0.3021106
	speed: 0.0039s/iter; left time: 29.9310s
	iters: 700, epoch: 1 | loss: 0.2872398
	speed: 0.0039s/iter; left time: 29.6666s
	iters: 800, epoch: 1 | loss: 0.5025142
	speed: 0.0039s/iter; left time: 29.6316s
	iters: 900, epoch: 1 | loss: 0.3921185
	speed: 0.0040s/iter; left time: 29.8450s
	iters: 1000, epoch: 1 | loss: 0.8943972
	speed: 0.0040s/iter; left time: 29.4395s
Updating learning rate to 0.0020551983454025658
Validation loss decreased (inf --> 0.3195).  Saving model state dict ...
Epoch: 1 cost time: 4.465209722518921
Epoch: 1, Steps: 1045 | Train Loss: 0.7885758 Vali Loss: 0.3194644 Best vali loss: 0.3194644
	iters: 100, epoch: 2 | loss: 0.3185594
	speed: 0.0116s/iter; left time: 84.0025s
	iters: 200, epoch: 2 | loss: 1.0748791
	speed: 0.0036s/iter; left time: 25.8584s
	iters: 300, epoch: 2 | loss: 0.2836112
	speed: 0.0036s/iter; left time: 25.5966s
	iters: 400, epoch: 2 | loss: 1.4450117
	speed: 0.0037s/iter; left time: 25.2835s
	iters: 500, epoch: 2 | loss: 0.3244290
	speed: 0.0037s/iter; left time: 24.9791s
	iters: 600, epoch: 2 | loss: 0.6326724
	speed: 0.0037s/iter; left time: 24.5736s
	iters: 700, epoch: 2 | loss: 0.2288339
	speed: 0.0037s/iter; left time: 24.2147s
	iters: 800, epoch: 2 | loss: 0.4535131
	speed: 0.0036s/iter; left time: 23.6053s
	iters: 900, epoch: 2 | loss: 0.6304193
	speed: 0.0037s/iter; left time: 23.6293s
	iters: 1000, epoch: 2 | loss: 0.4694073
	speed: 0.0036s/iter; left time: 23.0282s
Updating learning rate to 0.0018236292724318536
Epoch: 2 cost time: 3.857944965362549
Epoch: 2, Steps: 1045 | Train Loss: 0.5861336 Vali Loss: 0.3217223 Best vali loss: 0.3194644
	iters: 100, epoch: 3 | loss: 0.4178945
	speed: 0.0113s/iter; left time: 69.7023s
	iters: 200, epoch: 3 | loss: 1.5753311
	speed: 0.0036s/iter; left time: 22.1134s
	iters: 300, epoch: 3 | loss: 0.6692026
	speed: 0.0037s/iter; left time: 22.1446s
	iters: 400, epoch: 3 | loss: 0.2959099
	speed: 0.0039s/iter; left time: 23.0968s
	iters: 500, epoch: 3 | loss: 0.3104094
	speed: 0.0039s/iter; left time: 22.7313s
	iters: 600, epoch: 3 | loss: 1.0874881
	speed: 0.0042s/iter; left time: 23.9184s
	iters: 700, epoch: 3 | loss: 0.8405470
	speed: 0.0042s/iter; left time: 23.6445s
	iters: 800, epoch: 3 | loss: 0.4561852
	speed: 0.0043s/iter; left time: 23.3372s
	iters: 900, epoch: 3 | loss: 0.3490297
	speed: 0.0043s/iter; left time: 22.8569s
	iters: 1000, epoch: 3 | loss: 1.2231380
	speed: 0.0043s/iter; left time: 22.4718s
Updating learning rate to 0.0014770616633687805
Epoch: 3 cost time: 4.238881826400757
Epoch: 3, Steps: 1045 | Train Loss: 0.7225135 Vali Loss: 0.3227803 Best vali loss: 0.3194644
	iters: 100, epoch: 4 | loss: 1.0925037
	speed: 0.0115s/iter; left time: 58.8124s
	iters: 200, epoch: 4 | loss: 0.2633043
	speed: 0.0036s/iter; left time: 17.8686s
	iters: 300, epoch: 4 | loss: 0.2558081
	speed: 0.0035s/iter; left time: 17.4820s
	iters: 400, epoch: 4 | loss: 0.2986555
	speed: 0.0036s/iter; left time: 17.2236s
	iters: 500, epoch: 4 | loss: 0.3748810
	speed: 0.0039s/iter; left time: 18.6457s
	iters: 600, epoch: 4 | loss: 0.6735092
	speed: 0.0040s/iter; left time: 18.4888s
	iters: 700, epoch: 4 | loss: 0.4284529
	speed: 0.0040s/iter; left time: 18.1140s
	iters: 800, epoch: 4 | loss: 1.7228069
	speed: 0.0040s/iter; left time: 17.6669s
	iters: 900, epoch: 4 | loss: 1.0145155
	speed: 0.0040s/iter; left time: 17.3569s
	iters: 1000, epoch: 4 | loss: 0.2388628
	speed: 0.0040s/iter; left time: 16.8944s
Updating learning rate to 0.00106825729505
Epoch: 4 cost time: 4.036677122116089
Epoch: 4, Steps: 1045 | Train Loss: 0.6363300 Vali Loss: 0.3221483 Best vali loss: 0.3194644
	iters: 100, epoch: 5 | loss: 0.3923927
	speed: 0.0126s/iter; left time: 51.5742s
	iters: 200, epoch: 5 | loss: 0.1929565
	speed: 0.0043s/iter; left time: 16.9219s
	iters: 300, epoch: 5 | loss: 0.9475021
	speed: 0.0041s/iter; left time: 15.8839s
	iters: 400, epoch: 5 | loss: 0.6122083
	speed: 0.0041s/iter; left time: 15.4952s
	iters: 500, epoch: 5 | loss: 0.3143244
	speed: 0.0042s/iter; left time: 15.5507s
	iters: 600, epoch: 5 | loss: 0.5284821
	speed: 0.0042s/iter; left time: 15.1285s
	iters: 700, epoch: 5 | loss: 1.5687779
	speed: 0.0042s/iter; left time: 14.7394s
	iters: 800, epoch: 5 | loss: 0.3212615
	speed: 0.0043s/iter; left time: 14.4621s
	iters: 900, epoch: 5 | loss: 0.6971264
	speed: 0.0043s/iter; left time: 14.1081s
	iters: 1000, epoch: 5 | loss: 0.4854411
	speed: 0.0042s/iter; left time: 13.4641s
Updating learning rate to 0.0006594529267312197
Epoch: 5 cost time: 4.453780651092529
Epoch: 5, Steps: 1045 | Train Loss: 0.6060473 Vali Loss: 0.3211992 Best vali loss: 0.3194644
	iters: 100, epoch: 6 | loss: 1.1024925
	speed: 0.0123s/iter; left time: 37.3513s
	iters: 200, epoch: 6 | loss: 1.4150192
	speed: 0.0043s/iter; left time: 12.5553s
	iters: 300, epoch: 6 | loss: 0.4306921
	speed: 0.0042s/iter; left time: 12.0245s
	iters: 400, epoch: 6 | loss: 0.5640053
	speed: 0.0042s/iter; left time: 11.4269s
	iters: 500, epoch: 6 | loss: 0.9530232
	speed: 0.0042s/iter; left time: 10.9395s
	iters: 600, epoch: 6 | loss: 0.4170370
	speed: 0.0041s/iter; left time: 10.4992s
	iters: 700, epoch: 6 | loss: 0.2431124
	speed: 0.0043s/iter; left time: 10.4430s
	iters: 800, epoch: 6 | loss: 1.4160950
	speed: 0.0043s/iter; left time: 10.0696s
	iters: 900, epoch: 6 | loss: 0.3110892
	speed: 0.0043s/iter; left time: 9.5695s
	iters: 1000, epoch: 6 | loss: 0.4039169
	speed: 0.0042s/iter; left time: 9.0234s
Updating learning rate to 0.0003128853176681466
Epoch: 6 cost time: 4.450439691543579
Epoch: 6, Steps: 1045 | Train Loss: 0.7256483 Vali Loss: 0.3220035 Best vali loss: 0.3194644
	iters: 100, epoch: 7 | loss: 1.3934695
	speed: 0.0115s/iter; left time: 22.9311s
	iters: 200, epoch: 7 | loss: 0.2198685
	speed: 0.0036s/iter; left time: 6.8943s
	iters: 300, epoch: 7 | loss: 0.4642531
	speed: 0.0036s/iter; left time: 6.4553s
	iters: 400, epoch: 7 | loss: 0.2477676
	speed: 0.0036s/iter; left time: 6.1574s
	iters: 500, epoch: 7 | loss: 0.3887799
	speed: 0.0036s/iter; left time: 5.7505s
	iters: 600, epoch: 7 | loss: 0.4224951
	speed: 0.0036s/iter; left time: 5.3753s
	iters: 700, epoch: 7 | loss: 0.4820581
	speed: 0.0036s/iter; left time: 5.0228s
	iters: 800, epoch: 7 | loss: 1.2838088
	speed: 0.0036s/iter; left time: 4.6467s
	iters: 900, epoch: 7 | loss: 1.1909106
	speed: 0.0036s/iter; left time: 4.2710s
	iters: 1000, epoch: 7 | loss: 0.7103362
	speed: 0.0038s/iter; left time: 4.1303s
Updating learning rate to 8.13162446974343e-05
Epoch: 7 cost time: 3.8522021770477295
Epoch: 7, Steps: 1045 | Train Loss: 0.6803748 Vali Loss: 0.3220835 Best vali loss: 0.3194644
	iters: 100, epoch: 8 | loss: 0.3839908
	speed: 0.0112s/iter; left time: 10.6397s
	iters: 200, epoch: 8 | loss: 1.6304994
	speed: 0.0036s/iter; left time: 3.0429s
	iters: 300, epoch: 8 | loss: 0.3075689
	speed: 0.0036s/iter; left time: 2.6773s
	iters: 400, epoch: 8 | loss: 0.4263156
	speed: 0.0036s/iter; left time: 2.3430s
	iters: 500, epoch: 8 | loss: 0.2656767
	speed: 0.0036s/iter; left time: 1.9908s
	iters: 600, epoch: 8 | loss: 1.2570270
	speed: 0.0037s/iter; left time: 1.6319s
	iters: 700, epoch: 8 | loss: 0.2845536
	speed: 0.0037s/iter; left time: 1.2697s
	iters: 800, epoch: 8 | loss: 1.4917537
	speed: 0.0037s/iter; left time: 0.9124s
	iters: 900, epoch: 8 | loss: 0.2188650
	speed: 0.0035s/iter; left time: 0.5150s
	iters: 1000, epoch: 8 | loss: 0.4722787
	speed: 0.0037s/iter; left time: 0.1714s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.835056781768799
Epoch: 8, Steps: 1045 | Train Loss: 0.6738529 Vali Loss: 0.3221158 Best vali loss: 0.3194644

best validation loss 0.31946441156574235

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597140
	speed: 0.0106s/iter; left time: 10.0743s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9474546909332275
Epoch: 1, Steps: 131 | Train Loss: 0.5597140 Vali Loss: 0.2756323 Best vali loss: 0.2756323
	iters: 100, epoch: 2 | loss: 0.3247757
	speed: 0.0089s/iter; left time: 7.2933s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2756 --> 0.2688).  Saving model state dict ...
Epoch: 2 cost time: 0.7078046798706055
Epoch: 2, Steps: 131 | Train Loss: 0.3247757 Vali Loss: 0.2687530 Best vali loss: 0.2687530
	iters: 100, epoch: 3 | loss: 0.4608576
	speed: 0.0091s/iter; left time: 6.2362s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.6982812881469727
Epoch: 3, Steps: 131 | Train Loss: 0.4608576 Vali Loss: 0.2787606 Best vali loss: 0.2687530

best validation loss 0.26875295035898483

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002343474432, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596890
	speed: 0.0111s/iter; left time: 10.5154s
Updating learning rate to 0.0002343474432
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9307520389556885
Epoch: 1, Steps: 131 | Train Loss: 0.5596890 Vali Loss: 0.2756484 Best vali loss: 0.2756484
	iters: 100, epoch: 2 | loss: 0.3260092
	speed: 0.0089s/iter; left time: 7.2648s
Updating learning rate to 0.0001171737216
Validation loss decreased (0.2756 --> 0.2694).  Saving model state dict ...
Epoch: 2 cost time: 0.6957831382751465
Epoch: 2, Steps: 131 | Train Loss: 0.3260092 Vali Loss: 0.2693889 Best vali loss: 0.2693889
	iters: 100, epoch: 3 | loss: 0.4609378
	speed: 0.0091s/iter; left time: 6.2257s
Updating learning rate to 5.85868608e-05
Epoch: 3 cost time: 0.7051918506622314
Epoch: 3, Steps: 131 | Train Loss: 0.4609378 Vali Loss: 0.2794567 Best vali loss: 0.2693889

best validation loss 0.2693889167460424

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009583474561, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596167
	speed: 0.0105s/iter; left time: 9.9910s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9402866363525391
Epoch: 1, Steps: 131 | Train Loss: 0.5596167 Vali Loss: 0.2756596 Best vali loss: 0.2756596
	iters: 100, epoch: 2 | loss: 0.3260186
	speed: 0.0114s/iter; left time: 9.3108s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2757 --> 0.2733).  Saving model state dict ...
Epoch: 2 cost time: 0.8633584976196289
Epoch: 2, Steps: 131 | Train Loss: 0.3260186 Vali Loss: 0.2733366 Best vali loss: 0.2733366
	iters: 100, epoch: 3 | loss: 0.4644074
	speed: 0.0089s/iter; left time: 6.1260s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.6960716247558594
Epoch: 3, Steps: 131 | Train Loss: 0.4644074 Vali Loss: 0.2831509 Best vali loss: 0.2733366

best validation loss 0.2733365863883039

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4235527
	speed: 0.0114s/iter; left time: 6.3163s
Updating learning rate to 2.9315984725e-05
Epoch: 4 cost time: 0.9342944622039795
Epoch: 4, Steps: 131 | Train Loss: 0.4235527 Vali Loss: 0.3044121 Best vali loss: 0.2687530
	iters: 100, epoch: 5 | loss: 0.2817497
	speed: 0.0087s/iter; left time: 3.7038s
Updating learning rate to 1.46579923625e-05
Epoch: 5 cost time: 0.698261022567749
Epoch: 5, Steps: 131 | Train Loss: 0.2817497 Vali Loss: 0.2924414 Best vali loss: 0.2687530
	iters: 100, epoch: 6 | loss: 0.4347767
	speed: 0.0087s/iter; left time: 2.5612s
Updating learning rate to 7.32899618125e-06
Epoch: 6 cost time: 0.7002763748168945
Epoch: 6, Steps: 131 | Train Loss: 0.4347767 Vali Loss: 0.2955705 Best vali loss: 0.2687530
	iters: 100, epoch: 7 | loss: 0.4688076
	speed: 0.0087s/iter; left time: 1.4125s
Updating learning rate to 3.664498090625e-06
Epoch: 7 cost time: 0.7010042667388916
Epoch: 7, Steps: 131 | Train Loss: 0.4688076 Vali Loss: 0.2957532 Best vali loss: 0.2687530
	iters: 100, epoch: 8 | loss: 0.3297298
	speed: 0.0086s/iter; left time: 0.2763s
Updating learning rate to 1.8322490453125e-06
Epoch: 8 cost time: 0.7038002014160156
Epoch: 8, Steps: 131 | Train Loss: 0.3297298 Vali Loss: 0.2923630 Best vali loss: 0.2687530

best validation loss 0.26875295035898483

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0025690792701, 'e_layers': 4, 'learning_rate': 0.0005337927204, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00051347644469054
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.0207123756408691
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856627 Best vali loss: 0.2856627
Updating learning rate to 0.0004556205863714274
Validation loss decreased (0.2857 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 0.7831337451934814
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2788169 Best vali loss: 0.2788169
Updating learning rate to 0.00036903317540708534
Epoch: 3 cost time: 0.7810964584350586
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2941035 Best vali loss: 0.2788169
Updating learning rate to 0.0002668963602
Validation loss decreased (0.2788 --> 0.2760).  Saving model state dict ...
Epoch: 4 cost time: 0.7824058532714844
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2759561 Best vali loss: 0.2759561
Updating learning rate to 0.00016475954499291467
Epoch: 5 cost time: 0.780977725982666
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2975158 Best vali loss: 0.2759561
Updating learning rate to 7.817213402857265e-05
Epoch: 6 cost time: 0.7858526706695557
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3056473 Best vali loss: 0.2759561
Updating learning rate to 2.0316275709460006e-05
Epoch: 7 cost time: 0.7825233936309814
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3062246 Best vali loss: 0.2759561
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7847509384155273
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3104331 Best vali loss: 0.2759561

best validation loss 0.2759561474414597

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019161939989, 'e_layers': 4, 'learning_rate': 0.0005339988048, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9028521
	speed: 0.0155s/iter; left time: 14.6849s
Updating learning rate to 0.0005136746854701049
Validation loss decreased (inf --> 0.3231).  Saving model state dict ...
Epoch: 1 cost time: 1.5441749095916748
Epoch: 1, Steps: 131 | Train Loss: 0.9028521 Vali Loss: 0.3231208 Best vali loss: 0.3231208
	iters: 100, epoch: 2 | loss: 0.4155620
	speed: 0.0159s/iter; left time: 13.0011s
Updating learning rate to 0.00045579649040979574
Validation loss decreased (0.3231 --> 0.2859).  Saving model state dict ...
Epoch: 2 cost time: 1.3258018493652344
Epoch: 2, Steps: 131 | Train Loss: 0.4155620 Vali Loss: 0.2858876 Best vali loss: 0.2858876
	iters: 100, epoch: 3 | loss: 0.5021316
	speed: 0.0162s/iter; left time: 11.1605s
Updating learning rate to 0.0003691756501498598
Epoch: 3 cost time: 1.3334379196166992
Epoch: 3, Steps: 131 | Train Loss: 0.5021316 Vali Loss: 0.2970348 Best vali loss: 0.2858876
	iters: 100, epoch: 4 | loss: 0.4932227
	speed: 0.0156s/iter; left time: 8.6541s
Updating learning rate to 0.0002669994024
Epoch: 4 cost time: 1.326176404953003
Epoch: 4, Steps: 131 | Train Loss: 0.4932227 Vali Loss: 0.3124640 Best vali loss: 0.2858876
	iters: 100, epoch: 5 | loss: 0.3931760
	speed: 0.0155s/iter; left time: 6.5682s
Updating learning rate to 0.00016482315465014022
Epoch: 5 cost time: 1.3209247589111328
Epoch: 5, Steps: 131 | Train Loss: 0.3931760 Vali Loss: 0.2965549 Best vali loss: 0.2858876
	iters: 100, epoch: 6 | loss: 0.3541817
	speed: 0.0154s/iter; left time: 4.5409s
Updating learning rate to 7.820231439020427e-05
Epoch: 6 cost time: 1.318530797958374
Epoch: 6, Steps: 131 | Train Loss: 0.3541817 Vali Loss: 0.3093534 Best vali loss: 0.2858876
	iters: 100, epoch: 7 | loss: 0.3268390
	speed: 0.0154s/iter; left time: 2.5159s
Updating learning rate to 2.032411932989507e-05
Epoch: 7 cost time: 1.3214380741119385
Epoch: 7, Steps: 131 | Train Loss: 0.3268390 Vali Loss: 0.3156738 Best vali loss: 0.2858876
	iters: 100, epoch: 8 | loss: 0.3398278
	speed: 0.0155s/iter; left time: 0.4972s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3255987167358398
Epoch: 8, Steps: 131 | Train Loss: 0.3398278 Vali Loss: 0.3176941 Best vali loss: 0.2858876

best validation loss 0.2858875688898293

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0035215814388, 'e_layers': 1, 'learning_rate': 0.0005285132504, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6226126
	speed: 0.0085s/iter; left time: 8.0476s
Updating learning rate to 0.0005083979125527863
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 0.6581254005432129
Epoch: 1, Steps: 131 | Train Loss: 0.6226126 Vali Loss: 0.2812508 Best vali loss: 0.2812508
	iters: 100, epoch: 2 | loss: 0.4521288
	speed: 0.0056s/iter; left time: 4.6144s
Updating learning rate to 0.0004511142768523919
Epoch: 2 cost time: 0.41835665702819824
Epoch: 2, Steps: 131 | Train Loss: 0.4521288 Vali Loss: 0.2889809 Best vali loss: 0.2812508
	iters: 100, epoch: 3 | loss: 0.4624268
	speed: 0.0055s/iter; left time: 3.7500s
Updating learning rate to 0.0003653832575567511
Epoch: 3 cost time: 0.4116683006286621
Epoch: 3, Steps: 131 | Train Loss: 0.4624268 Vali Loss: 0.2966894 Best vali loss: 0.2812508

best validation loss 0.28125084141964096

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.001241487701, 'e_layers': 4, 'learning_rate': 0.0001266530394, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3479472
	speed: 0.0107s/iter; left time: 43.6142s
	iters: 200, epoch: 1 | loss: 0.3330970
	speed: 0.0054s/iter; left time: 21.3339s
	iters: 300, epoch: 1 | loss: 0.8245723
	speed: 0.0053s/iter; left time: 20.7454s
	iters: 400, epoch: 1 | loss: 0.4292243
	speed: 0.0054s/iter; left time: 20.2665s
	iters: 500, epoch: 1 | loss: 0.3683985
	speed: 0.0050s/iter; left time: 18.3786s
Updating learning rate to 0.0001266530394
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 3.0165352821350098
Epoch: 1, Steps: 523 | Train Loss: 0.4606479 Vali Loss: 0.2822056 Best vali loss: 0.2822056
	iters: 100, epoch: 2 | loss: 0.8918177
	speed: 0.0100s/iter; left time: 35.4867s
	iters: 200, epoch: 2 | loss: 0.5649248
	speed: 0.0046s/iter; left time: 16.0860s
	iters: 300, epoch: 2 | loss: 0.6286414
	speed: 0.0047s/iter; left time: 15.7334s
	iters: 400, epoch: 2 | loss: 0.7567697
	speed: 0.0047s/iter; left time: 15.4233s
	iters: 500, epoch: 2 | loss: 0.4121479
	speed: 0.0047s/iter; left time: 14.8280s
Updating learning rate to 6.33265197e-05
Epoch: 2 cost time: 2.4931693077087402
Epoch: 2, Steps: 523 | Train Loss: 0.6508603 Vali Loss: 0.2830069 Best vali loss: 0.2822056
	iters: 100, epoch: 3 | loss: 0.5282826
	speed: 0.0103s/iter; left time: 31.1965s
	iters: 200, epoch: 3 | loss: 0.6172633
	speed: 0.0051s/iter; left time: 14.9874s
	iters: 300, epoch: 3 | loss: 0.4607619
	speed: 0.0051s/iter; left time: 14.4647s
	iters: 400, epoch: 3 | loss: 0.6412711
	speed: 0.0052s/iter; left time: 14.1115s
	iters: 500, epoch: 3 | loss: 0.3252046
	speed: 0.0052s/iter; left time: 13.7142s
Updating learning rate to 3.166325985e-05
Epoch: 3 cost time: 2.7362327575683594
Epoch: 3, Steps: 523 | Train Loss: 0.5145567 Vali Loss: 0.2854814 Best vali loss: 0.2822056

best validation loss 0.2822056142907685

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345458708, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597017
	speed: 0.0106s/iter; left time: 10.0638s
Updating learning rate to 0.00022561900013357832
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9465897083282471
Epoch: 1, Steps: 131 | Train Loss: 0.5597017 Vali Loss: 0.2756333 Best vali loss: 0.2756333
	iters: 100, epoch: 2 | loss: 0.3246475
	speed: 0.0089s/iter; left time: 7.2642s
Updating learning rate to 0.0002001974232709919
Validation loss decreased (0.2756 --> 0.2713).  Saving model state dict ...
Epoch: 2 cost time: 0.7050042152404785
Epoch: 2, Steps: 131 | Train Loss: 0.3246475 Vali Loss: 0.2712949 Best vali loss: 0.2712949
	iters: 100, epoch: 3 | loss: 0.4610249
	speed: 0.0091s/iter; left time: 6.2390s
Updating learning rate to 0.00016215134484240143
Epoch: 3 cost time: 0.7126941680908203
Epoch: 3, Steps: 131 | Train Loss: 0.4610249 Vali Loss: 0.2769890 Best vali loss: 0.2712949

best validation loss 0.271294935856135

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345458708, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4204557
	speed: 0.0108s/iter; left time: 5.9786s
Updating learning rate to 0.0001172729354
Epoch: 4 cost time: 0.9385733604431152
Epoch: 4, Steps: 131 | Train Loss: 0.4204557 Vali Loss: 0.2809328 Best vali loss: 0.2712949
	iters: 100, epoch: 5 | loss: 0.2706031
	speed: 0.0087s/iter; left time: 3.7166s
Updating learning rate to 7.239452595759856e-05
Epoch: 5 cost time: 0.7041628360748291
Epoch: 5, Steps: 131 | Train Loss: 0.2706031 Vali Loss: 0.2904720 Best vali loss: 0.2712949
	iters: 100, epoch: 6 | loss: 0.3933958
	speed: 0.0087s/iter; left time: 2.5561s
Updating learning rate to 3.4348447529008085e-05
Epoch: 6 cost time: 0.7096309661865234
Epoch: 6, Steps: 131 | Train Loss: 0.3933958 Vali Loss: 0.2973372 Best vali loss: 0.2712949
	iters: 100, epoch: 7 | loss: 0.3965562
	speed: 0.0087s/iter; left time: 1.4178s
Updating learning rate to 8.926870666421671e-06
Epoch: 7 cost time: 0.7074568271636963
Epoch: 7, Steps: 131 | Train Loss: 0.3965562 Vali Loss: 0.3000257 Best vali loss: 0.2712949
	iters: 100, epoch: 8 | loss: 0.2977262
	speed: 0.0087s/iter; left time: 0.2783s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7039632797241211
Epoch: 8, Steps: 131 | Train Loss: 0.2977262 Vali Loss: 0.3014571 Best vali loss: 0.2712949

best validation loss 0.271294935856135

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010285678245, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596936
	speed: 0.0103s/iter; left time: 9.8105s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9252114295959473
Epoch: 1, Steps: 131 | Train Loss: 0.5596936 Vali Loss: 0.2756504 Best vali loss: 0.2756504
	iters: 100, epoch: 2 | loss: 0.3264692
	speed: 0.0090s/iter; left time: 7.3253s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2757 --> 0.2733).  Saving model state dict ...
Epoch: 2 cost time: 0.701406717300415
Epoch: 2, Steps: 131 | Train Loss: 0.3264692 Vali Loss: 0.2732936 Best vali loss: 0.2732936
	iters: 100, epoch: 3 | loss: 0.4736587
	speed: 0.0089s/iter; left time: 6.1375s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.6998152732849121
Epoch: 3, Steps: 131 | Train Loss: 0.4736587 Vali Loss: 0.2818301 Best vali loss: 0.2732936
	iters: 100, epoch: 4 | loss: 0.4820535
	speed: 0.0086s/iter; left time: 4.8076s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.7003130912780762
Epoch: 4, Steps: 131 | Train Loss: 0.4820535 Vali Loss: 0.2797222 Best vali loss: 0.2732936
	iters: 100, epoch: 5 | loss: 0.3314440
	speed: 0.0087s/iter; left time: 3.7029s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.7034900188446045
Epoch: 5, Steps: 131 | Train Loss: 0.3314440 Vali Loss: 0.2941575 Best vali loss: 0.2732936
	iters: 100, epoch: 6 | loss: 0.3092191
	speed: 0.0088s/iter; left time: 2.5768s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7033655643463135
Epoch: 6, Steps: 131 | Train Loss: 0.3092191 Vali Loss: 0.3078519 Best vali loss: 0.2732936
	iters: 100, epoch: 7 | loss: 0.2854902
	speed: 0.0086s/iter; left time: 1.3979s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.6966743469238281
Epoch: 7, Steps: 131 | Train Loss: 0.2854902 Vali Loss: 0.3084868 Best vali loss: 0.2732936
	iters: 100, epoch: 8 | loss: 0.3442065
	speed: 0.0087s/iter; left time: 0.2793s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7054753303527832
Epoch: 8, Steps: 131 | Train Loss: 0.3442065 Vali Loss: 0.3072269 Best vali loss: 0.2732936

best validation loss 0.27329357850059516

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0021593188012, 'e_layers': 4, 'learning_rate': 0.0020172593902, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4442286
	speed: 0.0107s/iter; left time: 21.2725s
	iters: 200, epoch: 1 | loss: 0.8142658
	speed: 0.0053s/iter; left time: 9.9891s
Updating learning rate to 0.0019404820262859895
Validation loss decreased (inf --> 0.2903).  Saving model state dict ...
Epoch: 1 cost time: 1.6558611392974854
Epoch: 1, Steps: 262 | Train Loss: 0.6292472 Vali Loss: 0.2902825 Best vali loss: 0.2902825
	iters: 100, epoch: 2 | loss: 0.5170583
	speed: 0.0109s/iter; left time: 18.8682s
	iters: 200, epoch: 2 | loss: 0.3481742
	speed: 0.0049s/iter; left time: 7.9701s
Updating learning rate to 0.0017218385922113297
Validation loss decreased (0.2903 --> 0.2892).  Saving model state dict ...
Epoch: 2 cost time: 1.2944321632385254
Epoch: 2, Steps: 262 | Train Loss: 0.4326162 Vali Loss: 0.2891739 Best vali loss: 0.2891739
	iters: 100, epoch: 3 | loss: 0.5616520
	speed: 0.0103s/iter; left time: 15.1020s
	iters: 200, epoch: 3 | loss: 0.7289948
	speed: 0.0049s/iter; left time: 6.6914s
Updating learning rate to 0.001394615568806222
Validation loss decreased (0.2892 --> 0.2864).  Saving model state dict ...
Epoch: 3 cost time: 1.3184685707092285
Epoch: 3, Steps: 262 | Train Loss: 0.6453234 Vali Loss: 0.2863695 Best vali loss: 0.2863695
	iters: 100, epoch: 4 | loss: 0.4433999
	speed: 0.0104s/iter; left time: 12.6210s
	iters: 200, epoch: 4 | loss: 0.6653896
	speed: 0.0049s/iter; left time: 5.3958s
Updating learning rate to 0.0010086296951
Epoch: 4 cost time: 1.298757791519165
Epoch: 4, Steps: 262 | Train Loss: 0.5543948 Vali Loss: 0.2885034 Best vali loss: 0.2863695
	iters: 100, epoch: 5 | loss: 0.6343727
	speed: 0.0104s/iter; left time: 9.8780s
	iters: 200, epoch: 5 | loss: 0.3603640
	speed: 0.0049s/iter; left time: 4.1679s
Updating learning rate to 0.0006226438213937781
Epoch: 5 cost time: 1.335017442703247
Epoch: 5, Steps: 262 | Train Loss: 0.4973683 Vali Loss: 0.2979235 Best vali loss: 0.2863695
	iters: 100, epoch: 6 | loss: 0.5307360
	speed: 0.0110s/iter; left time: 7.5372s
	iters: 200, epoch: 6 | loss: 0.6286465
	speed: 0.0055s/iter; left time: 3.2041s
Updating learning rate to 0.0002954207979886702
Epoch: 6 cost time: 1.4678120613098145
Epoch: 6, Steps: 262 | Train Loss: 0.5796912 Vali Loss: 0.2994938 Best vali loss: 0.2863695
	iters: 100, epoch: 7 | loss: 0.3394275
	speed: 0.0114s/iter; left time: 4.8648s
	iters: 200, epoch: 7 | loss: 0.5196788
	speed: 0.0054s/iter; left time: 1.7479s
Updating learning rate to 7.677736391401031e-05
Epoch: 7 cost time: 1.4616305828094482
Epoch: 7, Steps: 262 | Train Loss: 0.4295531 Vali Loss: 0.3072899 Best vali loss: 0.2863695
	iters: 100, epoch: 8 | loss: 0.3994757
	speed: 0.0115s/iter; left time: 1.8732s
	iters: 200, epoch: 8 | loss: 0.2395338
	speed: 0.0055s/iter; left time: 0.3490s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4820961952209473
Epoch: 8, Steps: 262 | Train Loss: 0.3195048 Vali Loss: 0.3130029 Best vali loss: 0.2863695

best validation loss 0.2863694609386321

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0043029496227, 'e_layers': 4, 'learning_rate': 0.000247977119, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3296474
	speed: 0.0110s/iter; left time: 45.1289s
	iters: 200, epoch: 1 | loss: 0.4333967
	speed: 0.0058s/iter; left time: 23.0748s
	iters: 300, epoch: 1 | loss: 0.3861203
	speed: 0.0058s/iter; left time: 22.5497s
	iters: 400, epoch: 1 | loss: 0.2252834
	speed: 0.0058s/iter; left time: 22.0139s
	iters: 500, epoch: 1 | loss: 0.2333635
	speed: 0.0058s/iter; left time: 21.4928s
Updating learning rate to 0.000247977119
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 3.304365873336792
Epoch: 1, Steps: 523 | Train Loss: 0.3215623 Vali Loss: 0.2931812 Best vali loss: 0.2931812
	iters: 100, epoch: 2 | loss: 0.3662795
	speed: 0.0123s/iter; left time: 43.7469s
	iters: 200, epoch: 2 | loss: 0.2232329
	speed: 0.0059s/iter; left time: 20.3040s
	iters: 300, epoch: 2 | loss: 0.4471414
	speed: 0.0058s/iter; left time: 19.5711s
	iters: 400, epoch: 2 | loss: 0.3206467
	speed: 0.0058s/iter; left time: 19.0309s
	iters: 500, epoch: 2 | loss: 0.2446103
	speed: 0.0059s/iter; left time: 18.5151s
Updating learning rate to 0.0001239885595
Epoch: 2 cost time: 3.097913980484009
Epoch: 2, Steps: 523 | Train Loss: 0.3203821 Vali Loss: 0.2939762 Best vali loss: 0.2931812
	iters: 100, epoch: 3 | loss: 0.9034174
	speed: 0.0118s/iter; left time: 35.9773s
	iters: 200, epoch: 3 | loss: 0.5776180
	speed: 0.0058s/iter; left time: 17.1454s
	iters: 300, epoch: 3 | loss: 0.3277274
	speed: 0.0058s/iter; left time: 16.4799s
	iters: 400, epoch: 3 | loss: 0.7280146
	speed: 0.0057s/iter; left time: 15.6537s
	iters: 500, epoch: 3 | loss: 0.1833089
	speed: 0.0057s/iter; left time: 15.1206s
Updating learning rate to 6.199427975e-05
Validation loss decreased (0.2932 --> 0.2784).  Saving model state dict ...
Epoch: 3 cost time: 3.0599429607391357
Epoch: 3, Steps: 523 | Train Loss: 0.5440173 Vali Loss: 0.2784437 Best vali loss: 0.2784437

best validation loss 0.278443744287654

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0087906940603, 'e_layers': 1, 'learning_rate': 0.0027527257671, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6179640
	speed: 0.0079s/iter; left time: 32.1222s
	iters: 200, epoch: 1 | loss: 0.8441036
	speed: 0.0025s/iter; left time: 10.1452s
	iters: 300, epoch: 1 | loss: 0.6868969
	speed: 0.0025s/iter; left time: 9.6942s
	iters: 400, epoch: 1 | loss: 0.8296102
	speed: 0.0024s/iter; left time: 9.0794s
	iters: 500, epoch: 1 | loss: 0.5229119
	speed: 0.0024s/iter; left time: 8.6739s
Updating learning rate to 0.0027527257671
Validation loss decreased (inf --> 0.3135).  Saving model state dict ...
Epoch: 1 cost time: 1.5567841529846191
Epoch: 1, Steps: 523 | Train Loss: 0.7002973 Vali Loss: 0.3135259 Best vali loss: 0.3135259
	iters: 100, epoch: 2 | loss: 0.3632089
	speed: 0.0062s/iter; left time: 21.9530s
	iters: 200, epoch: 2 | loss: 0.3619696
	speed: 0.0025s/iter; left time: 8.6543s
	iters: 300, epoch: 2 | loss: 0.5818944
	speed: 0.0025s/iter; left time: 8.3625s
	iters: 400, epoch: 2 | loss: 0.5010689
	speed: 0.0025s/iter; left time: 8.1929s
	iters: 500, epoch: 2 | loss: 0.3699481
	speed: 0.0025s/iter; left time: 7.9081s
Updating learning rate to 0.00137636288355
Validation loss decreased (0.3135 --> 0.2965).  Saving model state dict ...
Epoch: 2 cost time: 1.3497200012207031
Epoch: 2, Steps: 523 | Train Loss: 0.4356180 Vali Loss: 0.2965003 Best vali loss: 0.2965003
	iters: 100, epoch: 3 | loss: 1.3596771
	speed: 0.0060s/iter; left time: 18.2636s
	iters: 200, epoch: 3 | loss: 0.7217348
	speed: 0.0023s/iter; left time: 6.7000s
	iters: 300, epoch: 3 | loss: 0.4357679
	speed: 0.0023s/iter; left time: 6.4840s
	iters: 400, epoch: 3 | loss: 0.3926077
	speed: 0.0023s/iter; left time: 6.3049s
	iters: 500, epoch: 3 | loss: 0.3573105
	speed: 0.0023s/iter; left time: 6.0218s
Updating learning rate to 0.000688181441775
Epoch: 3 cost time: 1.231001377105713
Epoch: 3, Steps: 523 | Train Loss: 0.6534196 Vali Loss: 0.3026172 Best vali loss: 0.2965003

best validation loss 0.2965002760828627

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0099310841923, 'e_layers': 2, 'learning_rate': 0.0002478788145, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3429327
	speed: 0.0089s/iter; left time: 36.2839s
	iters: 200, epoch: 1 | loss: 0.4145863
	speed: 0.0035s/iter; left time: 14.1304s
	iters: 300, epoch: 1 | loss: 0.3977756
	speed: 0.0035s/iter; left time: 13.7711s
	iters: 400, epoch: 1 | loss: 1.0112759
	speed: 0.0035s/iter; left time: 13.3080s
	iters: 500, epoch: 1 | loss: 0.5761340
	speed: 0.0035s/iter; left time: 12.9735s
Updating learning rate to 0.0002478788145
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 2.109072208404541
Epoch: 1, Steps: 523 | Train Loss: 0.7485409 Vali Loss: 0.2867572 Best vali loss: 0.2867572
	iters: 100, epoch: 2 | loss: 0.4751837
	speed: 0.0080s/iter; left time: 28.5302s
	iters: 200, epoch: 2 | loss: 0.4260884
	speed: 0.0034s/iter; left time: 11.6135s
	iters: 300, epoch: 2 | loss: 0.2383481
	speed: 0.0033s/iter; left time: 11.1973s
	iters: 400, epoch: 2 | loss: 0.3603138
	speed: 0.0033s/iter; left time: 10.8857s
	iters: 500, epoch: 2 | loss: 0.6073957
	speed: 0.0033s/iter; left time: 10.5325s
Updating learning rate to 0.00012393940725
Validation loss decreased (0.2868 --> 0.2814).  Saving model state dict ...
Epoch: 2 cost time: 1.7987573146820068
Epoch: 2, Steps: 523 | Train Loss: 0.4214659 Vali Loss: 0.2813572 Best vali loss: 0.2813572
	iters: 100, epoch: 3 | loss: 0.2615599
	speed: 0.0081s/iter; left time: 24.5966s
	iters: 200, epoch: 3 | loss: 0.2302941
	speed: 0.0033s/iter; left time: 9.7454s
	iters: 300, epoch: 3 | loss: 0.2720569
	speed: 0.0033s/iter; left time: 9.4473s
	iters: 400, epoch: 3 | loss: 0.4877280
	speed: 0.0033s/iter; left time: 9.0988s
	iters: 500, epoch: 3 | loss: 0.6882546
	speed: 0.0033s/iter; left time: 8.8270s
Updating learning rate to 6.1969703625e-05
Epoch: 3 cost time: 1.7821133136749268
Epoch: 3, Steps: 523 | Train Loss: 0.3879787 Vali Loss: 0.2864368 Best vali loss: 0.2813572

best validation loss 0.2813571802343565

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0043029496227, 'e_layers': 4, 'learning_rate': 0.000247977119, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3148741
	speed: 0.0118s/iter; left time: 29.7414s
	iters: 200, epoch: 4 | loss: 0.3108606
	speed: 0.0057s/iter; left time: 13.8911s
	iters: 300, epoch: 4 | loss: 0.3546773
	speed: 0.0057s/iter; left time: 13.1029s
	iters: 400, epoch: 4 | loss: 0.2066087
	speed: 0.0057s/iter; left time: 12.5854s
	iters: 500, epoch: 4 | loss: 0.2141866
	speed: 0.0058s/iter; left time: 12.2573s
Updating learning rate to 3.0997139875e-05
Epoch: 4 cost time: 3.271756410598755
Epoch: 4, Steps: 523 | Train Loss: 0.2802415 Vali Loss: 0.2821233 Best vali loss: 0.2784437
	iters: 100, epoch: 5 | loss: 0.2473747
	speed: 0.0120s/iter; left time: 23.8208s
	iters: 200, epoch: 5 | loss: 0.1796176
	speed: 0.0058s/iter; left time: 10.9796s
	iters: 300, epoch: 5 | loss: 0.3570404
	speed: 0.0058s/iter; left time: 10.3998s
	iters: 400, epoch: 5 | loss: 0.2971979
	speed: 0.0058s/iter; left time: 9.8204s
	iters: 500, epoch: 5 | loss: 0.2187163
	speed: 0.0058s/iter; left time: 9.2698s
Updating learning rate to 1.54985699375e-05
Epoch: 5 cost time: 3.073615312576294
Epoch: 5, Steps: 523 | Train Loss: 0.2599894 Vali Loss: 0.2842343 Best vali loss: 0.2784437
	iters: 100, epoch: 6 | loss: 0.6760312
	speed: 0.0118s/iter; left time: 17.2957s
	iters: 200, epoch: 6 | loss: 0.5016068
	speed: 0.0057s/iter; left time: 7.8443s
	iters: 300, epoch: 6 | loss: 0.3031912
	speed: 0.0058s/iter; left time: 7.3346s
	iters: 400, epoch: 6 | loss: 0.4850335
	speed: 0.0057s/iter; left time: 6.7177s
	iters: 500, epoch: 6 | loss: 0.1762424
	speed: 0.0058s/iter; left time: 6.1613s
Updating learning rate to 7.74928496875e-06
Epoch: 6 cost time: 3.0501673221588135
Epoch: 6, Steps: 523 | Train Loss: 0.4284210 Vali Loss: 0.2887166 Best vali loss: 0.2784437
	iters: 100, epoch: 7 | loss: 0.3547041
	speed: 0.0116s/iter; left time: 10.9496s
	iters: 200, epoch: 7 | loss: 0.5164052
	speed: 0.0057s/iter; left time: 4.7901s
	iters: 300, epoch: 7 | loss: 0.2117123
	speed: 0.0056s/iter; left time: 4.2075s
	iters: 400, epoch: 7 | loss: 0.4990149
	speed: 0.0056s/iter; left time: 3.6517s
	iters: 500, epoch: 7 | loss: 0.1866719
	speed: 0.0056s/iter; left time: 3.0852s
Updating learning rate to 3.874642484375e-06
Epoch: 7 cost time: 2.9890010356903076
Epoch: 7, Steps: 523 | Train Loss: 0.3537017 Vali Loss: 0.2904115 Best vali loss: 0.2784437
	iters: 100, epoch: 8 | loss: 0.3385850
	speed: 0.0116s/iter; left time: 4.9292s
	iters: 200, epoch: 8 | loss: 0.1824759
	speed: 0.0057s/iter; left time: 1.8310s
	iters: 300, epoch: 8 | loss: 0.3360104
	speed: 0.0057s/iter; left time: 1.2659s
	iters: 400, epoch: 8 | loss: 0.4526368
	speed: 0.0057s/iter; left time: 0.7016s
	iters: 500, epoch: 8 | loss: 0.2129886
	speed: 0.0057s/iter; left time: 0.1358s
Updating learning rate to 1.9373212421875e-06
Epoch: 8 cost time: 2.9948251247406006
Epoch: 8, Steps: 523 | Train Loss: 0.3045393 Vali Loss: 0.2905057 Best vali loss: 0.2784437

best validation loss 0.278443744287654

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3663055
	speed: 0.0087s/iter; left time: 71.4616s
	iters: 200, epoch: 1 | loss: 0.2519925
	speed: 0.0034s/iter; left time: 28.1330s
	iters: 300, epoch: 1 | loss: 0.2989404
	speed: 0.0035s/iter; left time: 28.1435s
	iters: 400, epoch: 1 | loss: 0.2896250
	speed: 0.0034s/iter; left time: 26.9044s
	iters: 500, epoch: 1 | loss: 0.1775123
	speed: 0.0034s/iter; left time: 26.5428s
	iters: 600, epoch: 1 | loss: 0.1726243
	speed: 0.0034s/iter; left time: 26.0239s
	iters: 700, epoch: 1 | loss: 0.7594680
	speed: 0.0034s/iter; left time: 25.9913s
	iters: 800, epoch: 1 | loss: 0.3511123
	speed: 0.0033s/iter; left time: 24.9489s
	iters: 900, epoch: 1 | loss: 0.2661128
	speed: 0.0034s/iter; left time: 25.1390s
	iters: 1000, epoch: 1 | loss: 0.5944540
	speed: 0.0034s/iter; left time: 24.7386s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2865).  Saving model state dict ...
Epoch: 1 cost time: 3.7967793941497803
Epoch: 1, Steps: 1045 | Train Loss: 0.3528147 Vali Loss: 0.2864814 Best vali loss: 0.2864814
	iters: 100, epoch: 2 | loss: 0.8687969
	speed: 0.0103s/iter; left time: 73.9860s
	iters: 200, epoch: 2 | loss: 0.4097129
	speed: 0.0033s/iter; left time: 23.5162s
	iters: 300, epoch: 2 | loss: 0.3129992
	speed: 0.0033s/iter; left time: 23.1274s
	iters: 400, epoch: 2 | loss: 0.5471574
	speed: 0.0033s/iter; left time: 22.8607s
	iters: 500, epoch: 2 | loss: 0.3786546
	speed: 0.0033s/iter; left time: 22.6921s
	iters: 600, epoch: 2 | loss: 0.3006824
	speed: 0.0033s/iter; left time: 21.9951s
	iters: 700, epoch: 2 | loss: 0.8054199
	speed: 0.0033s/iter; left time: 21.9305s
	iters: 800, epoch: 2 | loss: 0.3187152
	speed: 0.0033s/iter; left time: 21.3074s
	iters: 900, epoch: 2 | loss: 0.8625395
	speed: 0.0033s/iter; left time: 20.8790s
	iters: 1000, epoch: 2 | loss: 0.1937642
	speed: 0.0033s/iter; left time: 20.7545s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 3.484294891357422
Epoch: 2, Steps: 1045 | Train Loss: 0.4998442 Vali Loss: 0.2907166 Best vali loss: 0.2864814
	iters: 100, epoch: 3 | loss: 0.4618832
	speed: 0.0099s/iter; left time: 61.1552s
	iters: 200, epoch: 3 | loss: 0.5501449
	speed: 0.0031s/iter; left time: 18.8174s
	iters: 300, epoch: 3 | loss: 0.4325864
	speed: 0.0031s/iter; left time: 18.5588s
	iters: 400, epoch: 3 | loss: 0.1988484
	speed: 0.0031s/iter; left time: 18.1451s
	iters: 500, epoch: 3 | loss: 0.3612678
	speed: 0.0032s/iter; left time: 18.5486s
	iters: 600, epoch: 3 | loss: 0.1189732
	speed: 0.0031s/iter; left time: 17.4476s
	iters: 700, epoch: 3 | loss: 0.9218363
	speed: 0.0031s/iter; left time: 17.2234s
	iters: 800, epoch: 3 | loss: 0.8762743
	speed: 0.0030s/iter; left time: 16.4952s
	iters: 900, epoch: 3 | loss: 0.2763324
	speed: 0.0030s/iter; left time: 16.1316s
	iters: 1000, epoch: 3 | loss: 0.6209026
	speed: 0.0029s/iter; left time: 15.5474s
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2865 --> 0.2782).  Saving model state dict ...
Epoch: 3 cost time: 3.2387478351593018
Epoch: 3, Steps: 1045 | Train Loss: 0.4819050 Vali Loss: 0.2781768 Best vali loss: 0.2781768
	iters: 100, epoch: 4 | loss: 0.5149980
	speed: 0.0106s/iter; left time: 54.3909s
	iters: 200, epoch: 4 | loss: 0.4728536
	speed: 0.0033s/iter; left time: 16.6619s
	iters: 300, epoch: 4 | loss: 0.2431170
	speed: 0.0031s/iter; left time: 15.4272s
	iters: 400, epoch: 4 | loss: 0.3043668
	speed: 0.0030s/iter; left time: 14.4814s
	iters: 500, epoch: 4 | loss: 0.4919285
	speed: 0.0030s/iter; left time: 14.1211s
	iters: 600, epoch: 4 | loss: 0.5744810
	speed: 0.0030s/iter; left time: 13.8312s
	iters: 700, epoch: 4 | loss: 0.2967351
	speed: 0.0031s/iter; left time: 14.0923s
	iters: 800, epoch: 4 | loss: 0.4468611
	speed: 0.0030s/iter; left time: 13.3533s
	iters: 900, epoch: 4 | loss: 0.2494787
	speed: 0.0030s/iter; left time: 12.8900s
	iters: 1000, epoch: 4 | loss: 0.3297409
	speed: 0.0030s/iter; left time: 12.6647s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 3.256885051727295
Epoch: 4, Steps: 1045 | Train Loss: 0.3924561 Vali Loss: 0.2817720 Best vali loss: 0.2781768
	iters: 100, epoch: 5 | loss: 0.6750441
	speed: 0.0097s/iter; left time: 39.7443s
	iters: 200, epoch: 5 | loss: 0.3416441
	speed: 0.0031s/iter; left time: 12.3404s
	iters: 300, epoch: 5 | loss: 0.2850364
	speed: 0.0032s/iter; left time: 12.2649s
	iters: 400, epoch: 5 | loss: 0.7870558
	speed: 0.0032s/iter; left time: 11.9424s
	iters: 500, epoch: 5 | loss: 0.3801554
	speed: 0.0032s/iter; left time: 11.6064s
	iters: 600, epoch: 5 | loss: 0.5194349
	speed: 0.0032s/iter; left time: 11.3468s
	iters: 700, epoch: 5 | loss: 0.2206149
	speed: 0.0032s/iter; left time: 10.9877s
	iters: 800, epoch: 5 | loss: 0.2355848
	speed: 0.0032s/iter; left time: 10.6832s
	iters: 900, epoch: 5 | loss: 0.2103424
	speed: 0.0031s/iter; left time: 10.2079s
	iters: 1000, epoch: 5 | loss: 0.4048355
	speed: 0.0031s/iter; left time: 9.8931s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 3.3203048706054688
Epoch: 5, Steps: 1045 | Train Loss: 0.4059748 Vali Loss: 0.2851845 Best vali loss: 0.2781768
	iters: 100, epoch: 6 | loss: 0.2154278
	speed: 0.0099s/iter; left time: 30.1370s
	iters: 200, epoch: 6 | loss: 0.2971473
	speed: 0.0030s/iter; left time: 8.7570s
	iters: 300, epoch: 6 | loss: 0.4120885
	speed: 0.0030s/iter; left time: 8.4992s
	iters: 400, epoch: 6 | loss: 0.4604430
	speed: 0.0031s/iter; left time: 8.4104s
	iters: 500, epoch: 6 | loss: 0.1359768
	speed: 0.0031s/iter; left time: 8.1780s
	iters: 600, epoch: 6 | loss: 0.5044622
	speed: 0.0031s/iter; left time: 7.8495s
	iters: 700, epoch: 6 | loss: 0.7518541
	speed: 0.0030s/iter; left time: 7.3058s
	iters: 800, epoch: 6 | loss: 0.1918210
	speed: 0.0030s/iter; left time: 6.9981s
	iters: 900, epoch: 6 | loss: 0.2928428
	speed: 0.0031s/iter; left time: 6.9478s
	iters: 1000, epoch: 6 | loss: 0.3449893
	speed: 0.0031s/iter; left time: 6.6227s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 3.2450404167175293
Epoch: 6, Steps: 1045 | Train Loss: 0.3607053 Vali Loss: 0.2819651 Best vali loss: 0.2781768
	iters: 100, epoch: 7 | loss: 0.7039157
	speed: 0.0097s/iter; left time: 19.3141s
	iters: 200, epoch: 7 | loss: 0.8856690
	speed: 0.0031s/iter; left time: 5.7970s
	iters: 300, epoch: 7 | loss: 0.5915461
	speed: 0.0031s/iter; left time: 5.4748s
	iters: 400, epoch: 7 | loss: 0.1480086
	speed: 0.0031s/iter; left time: 5.1910s
	iters: 500, epoch: 7 | loss: 0.8176883
	speed: 0.0031s/iter; left time: 4.9299s
	iters: 600, epoch: 7 | loss: 0.4051853
	speed: 0.0031s/iter; left time: 4.5538s
	iters: 700, epoch: 7 | loss: 0.6307594
	speed: 0.0031s/iter; left time: 4.2770s
	iters: 800, epoch: 7 | loss: 0.4248672
	speed: 0.0031s/iter; left time: 3.9663s
	iters: 900, epoch: 7 | loss: 0.2264834
	speed: 0.0031s/iter; left time: 3.6689s
	iters: 1000, epoch: 7 | loss: 0.2334292
	speed: 0.0031s/iter; left time: 3.3671s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 3.246044635772705
Epoch: 7, Steps: 1045 | Train Loss: 0.5067552 Vali Loss: 0.2839255 Best vali loss: 0.2781768
	iters: 100, epoch: 8 | loss: 0.5451485
	speed: 0.0099s/iter; left time: 9.3712s
	iters: 200, epoch: 8 | loss: 0.2134001
	speed: 0.0029s/iter; left time: 2.4920s
	iters: 300, epoch: 8 | loss: 0.2270673
	speed: 0.0030s/iter; left time: 2.2049s
	iters: 400, epoch: 8 | loss: 0.3538059
	speed: 0.0030s/iter; left time: 1.9118s
	iters: 500, epoch: 8 | loss: 0.1228236
	speed: 0.0030s/iter; left time: 1.6215s
	iters: 600, epoch: 8 | loss: 0.5804168
	speed: 0.0030s/iter; left time: 1.3247s
	iters: 700, epoch: 8 | loss: 0.2929226
	speed: 0.0030s/iter; left time: 1.0315s
	iters: 800, epoch: 8 | loss: 0.1862933
	speed: 0.0030s/iter; left time: 0.7339s
	iters: 900, epoch: 8 | loss: 0.1487363
	speed: 0.0030s/iter; left time: 0.4360s
	iters: 1000, epoch: 8 | loss: 0.7665830
	speed: 0.0030s/iter; left time: 0.1401s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 3.1515722274780273
Epoch: 8, Steps: 1045 | Train Loss: 0.3437197 Vali Loss: 0.2853238 Best vali loss: 0.2781768

best validation loss 0.2781768028799953

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3663056
	speed: 0.0085s/iter; left time: 70.3683s
	iters: 200, epoch: 1 | loss: 0.2519925
	speed: 0.0033s/iter; left time: 26.8743s
	iters: 300, epoch: 1 | loss: 0.2989422
	speed: 0.0032s/iter; left time: 26.1932s
	iters: 400, epoch: 1 | loss: 0.2896265
	speed: 0.0033s/iter; left time: 26.1790s
	iters: 500, epoch: 1 | loss: 0.1775169
	speed: 0.0033s/iter; left time: 25.9509s
	iters: 600, epoch: 1 | loss: 0.1724613
	speed: 0.0033s/iter; left time: 25.7620s
	iters: 700, epoch: 1 | loss: 0.7688232
	speed: 0.0033s/iter; left time: 25.3067s
	iters: 800, epoch: 1 | loss: 0.3499015
	speed: 0.0033s/iter; left time: 24.9956s
	iters: 900, epoch: 1 | loss: 0.2712490
	speed: 0.0033s/iter; left time: 24.7692s
	iters: 1000, epoch: 1 | loss: 0.5901213
	speed: 0.0033s/iter; left time: 24.4513s
Updating learning rate to 0.0002345270279
Validation loss decreased (inf --> 0.2970).  Saving model state dict ...
Epoch: 1 cost time: 3.707399368286133
Epoch: 1, Steps: 1045 | Train Loss: 0.3536940 Vali Loss: 0.2970098 Best vali loss: 0.2970098
	iters: 100, epoch: 2 | loss: 0.8822587
	speed: 0.0103s/iter; left time: 74.1753s
	iters: 200, epoch: 2 | loss: 0.4159080
	speed: 0.0032s/iter; left time: 23.0575s
	iters: 300, epoch: 2 | loss: 0.3253062
	speed: 0.0032s/iter; left time: 22.7955s
	iters: 400, epoch: 2 | loss: 0.5294783
	speed: 0.0032s/iter; left time: 22.4174s
	iters: 500, epoch: 2 | loss: 0.3594117
	speed: 0.0033s/iter; left time: 22.1539s
	iters: 600, epoch: 2 | loss: 0.3247614
	speed: 0.0033s/iter; left time: 22.0356s
	iters: 700, epoch: 2 | loss: 0.6563803
	speed: 0.0033s/iter; left time: 21.8588s
	iters: 800, epoch: 2 | loss: 0.3261035
	speed: 0.0031s/iter; left time: 20.3037s
	iters: 900, epoch: 2 | loss: 0.8075100
	speed: 0.0031s/iter; left time: 19.6923s
	iters: 1000, epoch: 2 | loss: 0.1862440
	speed: 0.0030s/iter; left time: 19.1685s
Updating learning rate to 0.00011726351395
Validation loss decreased (0.2970 --> 0.2816).  Saving model state dict ...
Epoch: 2 cost time: 3.3870503902435303
Epoch: 2, Steps: 1045 | Train Loss: 0.4813362 Vali Loss: 0.2815540 Best vali loss: 0.2815540
	iters: 100, epoch: 3 | loss: 0.4369247
	speed: 0.0100s/iter; left time: 61.6257s
	iters: 200, epoch: 3 | loss: 0.5540135
	speed: 0.0030s/iter; left time: 18.2020s
	iters: 300, epoch: 3 | loss: 0.4801791
	speed: 0.0030s/iter; left time: 17.9708s
	iters: 400, epoch: 3 | loss: 0.1915143
	speed: 0.0029s/iter; left time: 17.1658s
	iters: 500, epoch: 3 | loss: 0.3259542
	speed: 0.0029s/iter; left time: 16.9272s
	iters: 600, epoch: 3 | loss: 0.1193496
	speed: 0.0030s/iter; left time: 16.9353s
	iters: 700, epoch: 3 | loss: 0.9664029
	speed: 0.0033s/iter; left time: 18.2043s
	iters: 800, epoch: 3 | loss: 0.8930366
	speed: 0.0030s/iter; left time: 16.1925s
	iters: 900, epoch: 3 | loss: 0.2732762
	speed: 0.0032s/iter; left time: 17.0079s
	iters: 1000, epoch: 3 | loss: 0.6466584
	speed: 0.0033s/iter; left time: 17.5557s
Updating learning rate to 5.8631756975e-05
Epoch: 3 cost time: 3.236083984375
Epoch: 3, Steps: 1045 | Train Loss: 0.4887309 Vali Loss: 0.2842945 Best vali loss: 0.2815540
	iters: 100, epoch: 4 | loss: 0.5829903
	speed: 0.0098s/iter; left time: 50.0900s
	iters: 200, epoch: 4 | loss: 0.4694074
	speed: 0.0031s/iter; left time: 15.4907s
	iters: 300, epoch: 4 | loss: 0.2554465
	speed: 0.0031s/iter; left time: 15.2040s
	iters: 400, epoch: 4 | loss: 0.2889478
	speed: 0.0031s/iter; left time: 14.7336s
	iters: 500, epoch: 4 | loss: 0.4545169
	speed: 0.0031s/iter; left time: 14.5141s
	iters: 600, epoch: 4 | loss: 0.5192930
	speed: 0.0030s/iter; left time: 14.0320s
	iters: 700, epoch: 4 | loss: 0.2175388
	speed: 0.0031s/iter; left time: 13.8220s
	iters: 800, epoch: 4 | loss: 0.4237514
	speed: 0.0031s/iter; left time: 13.5433s
	iters: 900, epoch: 4 | loss: 0.2573386
	speed: 0.0031s/iter; left time: 13.2028s
	iters: 1000, epoch: 4 | loss: 0.3311000
	speed: 0.0030s/iter; left time: 12.8025s
Updating learning rate to 2.93158784875e-05
Epoch: 4 cost time: 3.2301127910614014
Epoch: 4, Steps: 1045 | Train Loss: 0.3800331 Vali Loss: 0.2863941 Best vali loss: 0.2815540
	iters: 100, epoch: 5 | loss: 0.6367176
	speed: 0.0098s/iter; left time: 40.0277s
	iters: 200, epoch: 5 | loss: 0.3654739
	speed: 0.0030s/iter; left time: 12.0231s
	iters: 300, epoch: 5 | loss: 0.2784647
	speed: 0.0031s/iter; left time: 11.8827s
	iters: 400, epoch: 5 | loss: 0.7756874
	speed: 0.0030s/iter; left time: 11.5318s
	iters: 500, epoch: 5 | loss: 0.3527682
	speed: 0.0030s/iter; left time: 11.1928s
	iters: 600, epoch: 5 | loss: 0.6734641
	speed: 0.0031s/iter; left time: 11.0330s
	iters: 700, epoch: 5 | loss: 0.2111751
	speed: 0.0031s/iter; left time: 10.6853s
	iters: 800, epoch: 5 | loss: 0.2274403
	speed: 0.0031s/iter; left time: 10.6001s
	iters: 900, epoch: 5 | loss: 0.2033448
	speed: 0.0031s/iter; left time: 10.2878s
	iters: 1000, epoch: 5 | loss: 0.3725651
	speed: 0.0031s/iter; left time: 9.9848s
Updating learning rate to 1.465793924375e-05
Epoch: 5 cost time: 3.2598001956939697
Epoch: 5, Steps: 1045 | Train Loss: 0.4097101 Vali Loss: 0.2831981 Best vali loss: 0.2815540
	iters: 100, epoch: 6 | loss: 0.2048970
	speed: 0.0101s/iter; left time: 30.7457s
	iters: 200, epoch: 6 | loss: 0.3129099
	speed: 0.0034s/iter; left time: 9.8897s
	iters: 300, epoch: 6 | loss: 0.4771804
	speed: 0.0034s/iter; left time: 9.5271s
	iters: 400, epoch: 6 | loss: 0.4801255
	speed: 0.0034s/iter; left time: 9.1816s
	iters: 500, epoch: 6 | loss: 0.1289153
	speed: 0.0033s/iter; left time: 8.8175s
	iters: 600, epoch: 6 | loss: 0.5099102
	speed: 0.0033s/iter; left time: 8.4051s
	iters: 700, epoch: 6 | loss: 0.7585594
	speed: 0.0034s/iter; left time: 8.1913s
	iters: 800, epoch: 6 | loss: 0.1906367
	speed: 0.0033s/iter; left time: 7.7778s
	iters: 900, epoch: 6 | loss: 0.2815256
	speed: 0.0033s/iter; left time: 7.4346s
	iters: 1000, epoch: 6 | loss: 0.3519083
	speed: 0.0033s/iter; left time: 7.0478s
Updating learning rate to 7.328969621875e-06
Epoch: 6 cost time: 3.5320193767547607
Epoch: 6, Steps: 1045 | Train Loss: 0.3696568 Vali Loss: 0.2837452 Best vali loss: 0.2815540
	iters: 100, epoch: 7 | loss: 0.7192180
	speed: 0.0099s/iter; left time: 19.6700s
	iters: 200, epoch: 7 | loss: 0.9116143
	speed: 0.0031s/iter; left time: 5.7910s
	iters: 300, epoch: 7 | loss: 0.5209430
	speed: 0.0031s/iter; left time: 5.5200s
	iters: 400, epoch: 7 | loss: 0.1373117
	speed: 0.0031s/iter; left time: 5.2255s
	iters: 500, epoch: 7 | loss: 0.8164837
	speed: 0.0031s/iter; left time: 4.9163s
	iters: 600, epoch: 7 | loss: 0.4068752
	speed: 0.0031s/iter; left time: 4.6375s
	iters: 700, epoch: 7 | loss: 0.6511846
	speed: 0.0031s/iter; left time: 4.2990s
	iters: 800, epoch: 7 | loss: 0.4471037
	speed: 0.0033s/iter; left time: 4.2061s
	iters: 900, epoch: 7 | loss: 0.2089021
	speed: 0.0031s/iter; left time: 3.6675s
	iters: 1000, epoch: 7 | loss: 0.2567212
	speed: 0.0031s/iter; left time: 3.3317s
Updating learning rate to 3.6644848109375e-06
Epoch: 7 cost time: 3.2764267921447754
Epoch: 7, Steps: 1045 | Train Loss: 0.5076357 Vali Loss: 0.2857340 Best vali loss: 0.2815540
	iters: 100, epoch: 8 | loss: 0.5303594
	speed: 0.0101s/iter; left time: 9.5389s
	iters: 200, epoch: 8 | loss: 0.1984227
	speed: 0.0030s/iter; left time: 2.5036s
	iters: 300, epoch: 8 | loss: 0.2120616
	speed: 0.0031s/iter; left time: 2.2931s
	iters: 400, epoch: 8 | loss: 0.3580997
	speed: 0.0031s/iter; left time: 1.9920s
	iters: 500, epoch: 8 | loss: 0.1248137
	speed: 0.0031s/iter; left time: 1.6908s
	iters: 600, epoch: 8 | loss: 0.5473174
	speed: 0.0031s/iter; left time: 1.3923s
	iters: 700, epoch: 8 | loss: 0.3046020
	speed: 0.0031s/iter; left time: 1.0696s
	iters: 800, epoch: 8 | loss: 0.1697073
	speed: 0.0032s/iter; left time: 0.7992s
	iters: 900, epoch: 8 | loss: 0.1529732
	speed: 0.0033s/iter; left time: 0.4862s
	iters: 1000, epoch: 8 | loss: 0.7599957
	speed: 0.0032s/iter; left time: 0.1456s
Updating learning rate to 1.83224240546875e-06
Epoch: 8 cost time: 3.290632724761963
Epoch: 8, Steps: 1045 | Train Loss: 0.3358353 Vali Loss: 0.2890509 Best vali loss: 0.2815540

best validation loss 0.2815540063199433

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0100610138635, 'e_layers': 3, 'learning_rate': 9.35365239e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5506225
	speed: 0.0097s/iter; left time: 19.3851s
	iters: 200, epoch: 1 | loss: 0.2852654
	speed: 0.0044s/iter; left time: 8.3284s
Updating learning rate to 8.997650193673139e-05
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 1.4393301010131836
Epoch: 1, Steps: 262 | Train Loss: 0.4179440 Vali Loss: 0.2835082 Best vali loss: 0.2835082
	iters: 100, epoch: 2 | loss: 0.4032844
	speed: 0.0098s/iter; left time: 16.9196s
	iters: 200, epoch: 2 | loss: 0.6443275
	speed: 0.0044s/iter; left time: 7.2101s
Updating learning rate to 7.983841711915378e-05
Validation loss decreased (0.2835 --> 0.2795).  Saving model state dict ...
Epoch: 2 cost time: 1.1830978393554688
Epoch: 2, Steps: 262 | Train Loss: 0.5238059 Vali Loss: 0.2794818 Best vali loss: 0.2794818
	iters: 100, epoch: 3 | loss: 0.8131500
	speed: 0.0095s/iter; left time: 13.9462s
	iters: 200, epoch: 3 | loss: 0.5830989
	speed: 0.0041s/iter; left time: 5.6483s
Updating learning rate to 6.466570095877562e-05
Epoch: 3 cost time: 1.130392074584961
Epoch: 3, Steps: 262 | Train Loss: 0.6981244 Vali Loss: 0.2800265 Best vali loss: 0.2794818

best validation loss 0.27948177371183797

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597190
	speed: 0.0102s/iter; left time: 9.6872s
Updating learning rate to 0.0002345378908
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9191174507141113
Epoch: 1, Steps: 131 | Train Loss: 0.5597190 Vali Loss: 0.2756370 Best vali loss: 0.2756370
	iters: 100, epoch: 2 | loss: 0.3250505
	speed: 0.0089s/iter; left time: 7.2938s
Updating learning rate to 0.0001172689454
Validation loss decreased (0.2756 --> 0.2683).  Saving model state dict ...
Epoch: 2 cost time: 0.707413911819458
Epoch: 2, Steps: 131 | Train Loss: 0.3250505 Vali Loss: 0.2682858 Best vali loss: 0.2682858
	iters: 100, epoch: 3 | loss: 0.4626047
	speed: 0.0090s/iter; left time: 6.1789s
Updating learning rate to 5.86344727e-05
Epoch: 3 cost time: 0.7058243751525879
Epoch: 3, Steps: 131 | Train Loss: 0.4626047 Vali Loss: 0.2789358 Best vali loss: 0.2682858

best validation loss 0.2682857631794712

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010862136698, 'e_layers': 2, 'learning_rate': 0.0002276561951, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5588960
	speed: 0.0104s/iter; left time: 9.9102s
Updating learning rate to 0.00021899154710114315
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9301042556762695
Epoch: 1, Steps: 131 | Train Loss: 0.5588960 Vali Loss: 0.2755951 Best vali loss: 0.2755951
	iters: 100, epoch: 2 | loss: 0.3254512
	speed: 0.0089s/iter; left time: 7.3026s
Updating learning rate to 0.00019431671721716883
Validation loss decreased (0.2756 --> 0.2694).  Saving model state dict ...
Epoch: 2 cost time: 0.7021737098693848
Epoch: 2, Steps: 131 | Train Loss: 0.3254512 Vali Loss: 0.2693876 Best vali loss: 0.2693876
	iters: 100, epoch: 3 | loss: 0.4636842
	speed: 0.0090s/iter; left time: 6.2012s
Updating learning rate to 0.00015738822462002227
Epoch: 3 cost time: 0.7005212306976318
Epoch: 3, Steps: 131 | Train Loss: 0.4636842 Vali Loss: 0.2957505 Best vali loss: 0.2693876

best validation loss 0.26938763490260514

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4229465
	speed: 0.0108s/iter; left time: 6.0010s
Updating learning rate to 2.931723635e-05
Epoch: 4 cost time: 0.9341626167297363
Epoch: 4, Steps: 131 | Train Loss: 0.4229465 Vali Loss: 0.3050514 Best vali loss: 0.2682858
	iters: 100, epoch: 5 | loss: 0.2802559
	speed: 0.0086s/iter; left time: 3.6664s
Updating learning rate to 1.4658618175e-05
Epoch: 5 cost time: 0.6945614814758301
Epoch: 5, Steps: 131 | Train Loss: 0.2802559 Vali Loss: 0.2944849 Best vali loss: 0.2682858
	iters: 100, epoch: 6 | loss: 0.4353726
	speed: 0.0087s/iter; left time: 2.5566s
Updating learning rate to 7.3293090875e-06
Epoch: 6 cost time: 0.7033498287200928
Epoch: 6, Steps: 131 | Train Loss: 0.4353726 Vali Loss: 0.2981851 Best vali loss: 0.2682858
	iters: 100, epoch: 7 | loss: 0.4645784
	speed: 0.0087s/iter; left time: 1.4112s
Updating learning rate to 3.66465454375e-06
Epoch: 7 cost time: 0.701148271560669
Epoch: 7, Steps: 131 | Train Loss: 0.4645784 Vali Loss: 0.2951200 Best vali loss: 0.2682858
	iters: 100, epoch: 8 | loss: 0.3250094
	speed: 0.0086s/iter; left time: 0.2767s
Updating learning rate to 1.832327271875e-06
Epoch: 8 cost time: 0.7022099494934082
Epoch: 8, Steps: 131 | Train Loss: 0.3250094 Vali Loss: 0.2946287 Best vali loss: 0.2682858

best validation loss 0.2682857631794712

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011057449439, 'e_layers': 2, 'learning_rate': 0.0002332517232, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5595174
	speed: 0.0103s/iter; left time: 9.8033s
Updating learning rate to 0.0002332517232
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9292786121368408
Epoch: 1, Steps: 131 | Train Loss: 0.5595174 Vali Loss: 0.2756541 Best vali loss: 0.2756541
	iters: 100, epoch: 2 | loss: 0.3245210
	speed: 0.0089s/iter; left time: 7.3052s
Updating learning rate to 0.0001166258616
Validation loss decreased (0.2757 --> 0.2722).  Saving model state dict ...
Epoch: 2 cost time: 0.7046387195587158
Epoch: 2, Steps: 131 | Train Loss: 0.3245210 Vali Loss: 0.2721638 Best vali loss: 0.2721638
	iters: 100, epoch: 3 | loss: 0.4626904
	speed: 0.0091s/iter; left time: 6.2291s
Updating learning rate to 5.83129308e-05
Epoch: 3 cost time: 0.7049741744995117
Epoch: 3, Steps: 131 | Train Loss: 0.4626904 Vali Loss: 0.2776061 Best vali loss: 0.2721638
	iters: 100, epoch: 4 | loss: 0.5063268
	speed: 0.0087s/iter; left time: 4.8200s
Updating learning rate to 2.91564654e-05
Epoch: 4 cost time: 0.702101469039917
Epoch: 4, Steps: 131 | Train Loss: 0.5063268 Vali Loss: 0.2924609 Best vali loss: 0.2721638
	iters: 100, epoch: 5 | loss: 0.3369276
	speed: 0.0087s/iter; left time: 3.6803s
Updating learning rate to 1.45782327e-05
Epoch: 5 cost time: 0.7018544673919678
Epoch: 5, Steps: 131 | Train Loss: 0.3369276 Vali Loss: 0.2916132 Best vali loss: 0.2721638
	iters: 100, epoch: 6 | loss: 0.3180507
	speed: 0.0088s/iter; left time: 2.5810s
Updating learning rate to 7.28911635e-06
Epoch: 6 cost time: 0.7081630229949951
Epoch: 6, Steps: 131 | Train Loss: 0.3180507 Vali Loss: 0.2937641 Best vali loss: 0.2721638
	iters: 100, epoch: 7 | loss: 0.3101774
	speed: 0.0087s/iter; left time: 1.4154s
Updating learning rate to 3.644558175e-06
Epoch: 7 cost time: 0.705129861831665
Epoch: 7, Steps: 131 | Train Loss: 0.3101774 Vali Loss: 0.3013851 Best vali loss: 0.2721638
	iters: 100, epoch: 8 | loss: 0.3950011
	speed: 0.0086s/iter; left time: 0.2763s
Updating learning rate to 1.8222790875e-06
Epoch: 8 cost time: 0.6981444358825684
Epoch: 8, Steps: 131 | Train Loss: 0.3950011 Vali Loss: 0.2996461 Best vali loss: 0.2721638

best validation loss 0.2721638296252514

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021457305757, 'e_layers': 2, 'learning_rate': 0.0005022899895, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5953801
	speed: 0.0103s/iter; left time: 9.7395s
Updating learning rate to 0.00048317271509217956
Validation loss decreased (inf --> 0.2763).  Saving model state dict ...
Epoch: 1 cost time: 0.9253439903259277
Epoch: 1, Steps: 131 | Train Loss: 0.5953801 Vali Loss: 0.2762962 Best vali loss: 0.2762962
	iters: 100, epoch: 2 | loss: 0.3323524
	speed: 0.0089s/iter; left time: 7.2875s
Updating learning rate to 0.0004287313235987849
Epoch: 2 cost time: 0.7074487209320068
Epoch: 2, Steps: 131 | Train Loss: 0.3323524 Vali Loss: 0.2957149 Best vali loss: 0.2762962
	iters: 100, epoch: 3 | loss: 0.4524632
	speed: 0.0087s/iter; left time: 5.9962s
Updating learning rate to 0.00034725402336224244
Epoch: 3 cost time: 0.7037620544433594
Epoch: 3, Steps: 131 | Train Loss: 0.4524632 Vali Loss: 0.2877351 Best vali loss: 0.2762962
	iters: 100, epoch: 4 | loss: 0.4314898
	speed: 0.0087s/iter; left time: 4.8144s
Updating learning rate to 0.00025114499475
Epoch: 4 cost time: 0.7057623863220215
Epoch: 4, Steps: 131 | Train Loss: 0.4314898 Vali Loss: 0.2916756 Best vali loss: 0.2762962
	iters: 100, epoch: 5 | loss: 0.3024081
	speed: 0.0086s/iter; left time: 3.6751s
Updating learning rate to 0.00015503596613775756
Epoch: 5 cost time: 0.702634334564209
Epoch: 5, Steps: 131 | Train Loss: 0.3024081 Vali Loss: 0.2913151 Best vali loss: 0.2762962
	iters: 100, epoch: 6 | loss: 0.2722669
	speed: 0.0087s/iter; left time: 2.5440s
Updating learning rate to 7.355866590121514e-05
Epoch: 6 cost time: 0.6962399482727051
Epoch: 6, Steps: 131 | Train Loss: 0.2722669 Vali Loss: 0.2923541 Best vali loss: 0.2762962
	iters: 100, epoch: 7 | loss: 0.2490835
	speed: 0.0086s/iter; left time: 1.4005s
Updating learning rate to 1.9117274407820438e-05
Epoch: 7 cost time: 0.6963098049163818
Epoch: 7, Steps: 131 | Train Loss: 0.2490835 Vali Loss: 0.2973468 Best vali loss: 0.2762962
	iters: 100, epoch: 8 | loss: 0.2915963
	speed: 0.0088s/iter; left time: 0.2813s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7059535980224609
Epoch: 8, Steps: 131 | Train Loss: 0.2915963 Vali Loss: 0.3015492 Best vali loss: 0.2762962

best validation loss 0.27629622848626184

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020990565305, 'e_layers': 2, 'learning_rate': 0.0005033076194, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5957444
	speed: 0.0105s/iter; left time: 9.9796s
Updating learning rate to 0.0004841516137603203
Validation loss decreased (inf --> 0.2737).  Saving model state dict ...
Epoch: 1 cost time: 0.9397733211517334
Epoch: 1, Steps: 131 | Train Loss: 0.5957444 Vali Loss: 0.2736777 Best vali loss: 0.2736777
	iters: 100, epoch: 2 | loss: 0.3162381
	speed: 0.0089s/iter; left time: 7.2930s
Updating learning rate to 0.0004295999250502989
Epoch: 2 cost time: 0.7018194198608398
Epoch: 2, Steps: 131 | Train Loss: 0.3162381 Vali Loss: 0.2856138 Best vali loss: 0.2736777
	iters: 100, epoch: 3 | loss: 0.4594944
	speed: 0.0086s/iter; left time: 5.9089s
Updating learning rate to 0.0003479575533637471
Epoch: 3 cost time: 0.6992714405059814
Epoch: 3, Steps: 131 | Train Loss: 0.4594944 Vali Loss: 0.2830902 Best vali loss: 0.2736777

best validation loss 0.27367768458005176

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.000944065315, 'e_layers': 3, 'learning_rate': 0.0007667636424, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3812572
	speed: 0.0100s/iter; left time: 9.4494s
Updating learning rate to 0.0007375804389435817
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 0.8680210113525391
Epoch: 1, Steps: 131 | Train Loss: 0.3812572 Vali Loss: 0.2853329 Best vali loss: 0.2853329
	iters: 100, epoch: 2 | loss: 0.4522073
	speed: 0.0078s/iter; left time: 6.3698s
Updating learning rate to 0.0006544737067541685
Validation loss decreased (0.2853 --> 0.2795).  Saving model state dict ...
Epoch: 2 cost time: 0.6447272300720215
Epoch: 2, Steps: 131 | Train Loss: 0.4522073 Vali Loss: 0.2794710 Best vali loss: 0.2794710
	iters: 100, epoch: 3 | loss: 0.5954460
	speed: 0.0078s/iter; left time: 5.3620s
Updating learning rate to 0.0005300956924431952
Epoch: 3 cost time: 0.6581251621246338
Epoch: 3, Steps: 131 | Train Loss: 0.5954460 Vali Loss: 0.2912791 Best vali loss: 0.2794710

best validation loss 0.2794710001057965

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020181303617, 'e_layers': 2, 'learning_rate': 0.0005089442679, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5940429
	speed: 0.0105s/iter; left time: 9.9894s
Updating learning rate to 0.0004895737301008756
Validation loss decreased (inf --> 0.2727).  Saving model state dict ...
Epoch: 1 cost time: 0.9369421005249023
Epoch: 1, Steps: 131 | Train Loss: 0.5940429 Vali Loss: 0.2726847 Best vali loss: 0.2726847
	iters: 100, epoch: 2 | loss: 0.3392958
	speed: 0.0089s/iter; left time: 7.2864s
Updating learning rate to 0.00043441110548905645
Epoch: 2 cost time: 0.7039327621459961
Epoch: 2, Steps: 131 | Train Loss: 0.3392958 Vali Loss: 0.2912292 Best vali loss: 0.2726847
	iters: 100, epoch: 3 | loss: 0.4620575
	speed: 0.0086s/iter; left time: 5.9002s
Updating learning rate to 0.00035185440361125496
Epoch: 3 cost time: 0.6963207721710205
Epoch: 3, Steps: 131 | Train Loss: 0.4620575 Vali Loss: 0.2819806 Best vali loss: 0.2726847

best validation loss 0.27268469602966805

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020181303617, 'e_layers': 2, 'learning_rate': 0.0005089442679, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3692204
	speed: 0.0107s/iter; left time: 5.9375s
Updating learning rate to 0.00025447213395
Epoch: 4 cost time: 0.9317750930786133
Epoch: 4, Steps: 131 | Train Loss: 0.3692204 Vali Loss: 0.2855267 Best vali loss: 0.2726847
	iters: 100, epoch: 5 | loss: 0.2604341
	speed: 0.0086s/iter; left time: 3.6398s
Updating learning rate to 0.00015708986428874513
Epoch: 5 cost time: 0.6937069892883301
Epoch: 5, Steps: 131 | Train Loss: 0.2604341 Vali Loss: 0.2839712 Best vali loss: 0.2726847
	iters: 100, epoch: 6 | loss: 0.3127812
	speed: 0.0086s/iter; left time: 2.5368s
Updating learning rate to 7.453316241094355e-05
Epoch: 6 cost time: 0.7051553726196289
Epoch: 6, Steps: 131 | Train Loss: 0.3127812 Vali Loss: 0.2896485 Best vali loss: 0.2726847
	iters: 100, epoch: 7 | loss: 0.3421457
	speed: 0.0087s/iter; left time: 1.4198s
Updating learning rate to 1.9370537799124464e-05
Epoch: 7 cost time: 0.7074418067932129
Epoch: 7, Steps: 131 | Train Loss: 0.3421457 Vali Loss: 0.2872751 Best vali loss: 0.2726847
	iters: 100, epoch: 8 | loss: 0.2542019
	speed: 0.0087s/iter; left time: 0.2793s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7053172588348389
Epoch: 8, Steps: 131 | Train Loss: 0.2542019 Vali Loss: 0.2909434 Best vali loss: 0.2726847

best validation loss 0.27268469602966805

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0110391052023, 'e_layers': 2, 'learning_rate': 0.0001005580989, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7620327
	speed: 0.0092s/iter; left time: 18.3241s
	iters: 200, epoch: 1 | loss: 0.6920720
	speed: 0.0034s/iter; left time: 6.4390s
Updating learning rate to 9.673083415097787e-05
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 1.1898448467254639
Epoch: 1, Steps: 262 | Train Loss: 0.7270524 Vali Loss: 0.2804741 Best vali loss: 0.2804741
	iters: 100, epoch: 2 | loss: 0.6423456
	speed: 0.0081s/iter; left time: 14.1115s
	iters: 200, epoch: 2 | loss: 0.5824216
	speed: 0.0037s/iter; left time: 6.0899s
Updating learning rate to 8.583170626770874e-05
Validation loss decreased (0.2805 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 1.0200483798980713
Epoch: 2, Steps: 262 | Train Loss: 0.6123836 Vali Loss: 0.2781205 Best vali loss: 0.2781205
	iters: 100, epoch: 3 | loss: 0.5000532
	speed: 0.0083s/iter; left time: 12.2456s
	iters: 200, epoch: 3 | loss: 0.6725670
	speed: 0.0036s/iter; left time: 4.9317s
Updating learning rate to 6.952000866958008e-05
Epoch: 3 cost time: 0.9961209297180176
Epoch: 3, Steps: 262 | Train Loss: 0.5863101 Vali Loss: 0.2781553 Best vali loss: 0.2781205
	iters: 100, epoch: 4 | loss: 0.5628127
	speed: 0.0080s/iter; left time: 9.7197s
	iters: 200, epoch: 4 | loss: 0.2769305
	speed: 0.0036s/iter; left time: 3.9982s
Updating learning rate to 5.027904945e-05
Epoch: 4 cost time: 0.9762072563171387
Epoch: 4, Steps: 262 | Train Loss: 0.4198716 Vali Loss: 0.2819719 Best vali loss: 0.2781205
	iters: 100, epoch: 5 | loss: 0.5402858
	speed: 0.0079s/iter; left time: 7.4873s
	iters: 200, epoch: 5 | loss: 0.3909211
	speed: 0.0036s/iter; left time: 3.0164s
Updating learning rate to 3.103809023041992e-05
Epoch: 5 cost time: 0.9648318290710449
Epoch: 5, Steps: 262 | Train Loss: 0.4656035 Vali Loss: 0.2856897 Best vali loss: 0.2781205
	iters: 100, epoch: 6 | loss: 0.3623533
	speed: 0.0078s/iter; left time: 5.3497s
	iters: 200, epoch: 6 | loss: 0.3140424
	speed: 0.0035s/iter; left time: 2.0831s
Updating learning rate to 1.472639263229125e-05
Epoch: 6 cost time: 0.9707520008087158
Epoch: 6, Steps: 262 | Train Loss: 0.3381978 Vali Loss: 0.2842844 Best vali loss: 0.2781205
	iters: 100, epoch: 7 | loss: 0.3568423
	speed: 0.0082s/iter; left time: 3.4919s
	iters: 200, epoch: 7 | loss: 0.4703303
	speed: 0.0036s/iter; left time: 1.1729s
Updating learning rate to 3.827264749022132e-06
Epoch: 7 cost time: 1.0113615989685059
Epoch: 7, Steps: 262 | Train Loss: 0.4135863 Vali Loss: 0.2856837 Best vali loss: 0.2781205
	iters: 100, epoch: 8 | loss: 0.4118465
	speed: 0.0081s/iter; left time: 1.3282s
	iters: 200, epoch: 8 | loss: 0.3975154
	speed: 0.0033s/iter; left time: 0.2104s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9215710163116455
Epoch: 8, Steps: 262 | Train Loss: 0.4046809 Vali Loss: 0.2853887 Best vali loss: 0.2781205

best validation loss 0.27812052308382623

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0115202760518, 'e_layers': 4, 'learning_rate': 0.0002609076359, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7495853
	speed: 0.0103s/iter; left time: 85.0186s
	iters: 200, epoch: 1 | loss: 0.3799436
	speed: 0.0051s/iter; left time: 41.2577s
	iters: 300, epoch: 1 | loss: 0.2613471
	speed: 0.0051s/iter; left time: 41.2621s
	iters: 400, epoch: 1 | loss: 0.2885972
	speed: 0.0051s/iter; left time: 40.5188s
	iters: 500, epoch: 1 | loss: 0.2466155
	speed: 0.0050s/iter; left time: 39.6943s
	iters: 600, epoch: 1 | loss: 0.5722142
	speed: 0.0051s/iter; left time: 39.2025s
	iters: 700, epoch: 1 | loss: 0.2407844
	speed: 0.0051s/iter; left time: 38.7607s
	iters: 800, epoch: 1 | loss: 0.4646746
	speed: 0.0050s/iter; left time: 38.0975s
	iters: 900, epoch: 1 | loss: 0.2967048
	speed: 0.0051s/iter; left time: 37.7501s
	iters: 1000, epoch: 1 | loss: 0.2965427
	speed: 0.0051s/iter; left time: 37.3711s
Updating learning rate to 0.00025097743029195847
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 5.552191495895386
Epoch: 1, Steps: 1045 | Train Loss: 0.3797010 Vali Loss: 0.2894713 Best vali loss: 0.2894713
	iters: 100, epoch: 2 | loss: 0.3283553
	speed: 0.0139s/iter; left time: 100.0368s
	iters: 200, epoch: 2 | loss: 0.3206559
	speed: 0.0050s/iter; left time: 35.5180s
	iters: 300, epoch: 2 | loss: 0.2469522
	speed: 0.0050s/iter; left time: 35.2205s
	iters: 400, epoch: 2 | loss: 0.5548092
	speed: 0.0050s/iter; left time: 34.3068s
	iters: 500, epoch: 2 | loss: 0.4910619
	speed: 0.0050s/iter; left time: 34.2678s
	iters: 600, epoch: 2 | loss: 0.5366827
	speed: 0.0050s/iter; left time: 33.5293s
	iters: 700, epoch: 2 | loss: 0.4219124
	speed: 0.0050s/iter; left time: 32.7872s
	iters: 800, epoch: 2 | loss: 0.3352614
	speed: 0.0050s/iter; left time: 32.4262s
	iters: 900, epoch: 2 | loss: 1.2839694
	speed: 0.0051s/iter; left time: 32.5160s
	iters: 1000, epoch: 2 | loss: 1.1752858
	speed: 0.0050s/iter; left time: 31.3947s
Updating learning rate to 0.00022269859725412033
Validation loss decreased (0.2895 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 5.259308815002441
Epoch: 2, Steps: 1045 | Train Loss: 0.5694946 Vali Loss: 0.2826280 Best vali loss: 0.2826280
	iters: 100, epoch: 3 | loss: 0.4397001
	speed: 0.0132s/iter; left time: 81.6998s
	iters: 200, epoch: 3 | loss: 0.3089008
	speed: 0.0046s/iter; left time: 27.6567s
	iters: 300, epoch: 3 | loss: 0.2461595
	speed: 0.0045s/iter; left time: 27.0875s
	iters: 400, epoch: 3 | loss: 0.6993264
	speed: 0.0045s/iter; left time: 26.6568s
	iters: 500, epoch: 3 | loss: 0.2112136
	speed: 0.0046s/iter; left time: 26.3435s
	iters: 600, epoch: 3 | loss: 0.9016417
	speed: 0.0048s/iter; left time: 27.2007s
	iters: 700, epoch: 3 | loss: 0.1325328
	speed: 0.0048s/iter; left time: 26.5790s
	iters: 800, epoch: 3 | loss: 0.6337785
	speed: 0.0048s/iter; left time: 26.2778s
	iters: 900, epoch: 3 | loss: 0.2978090
	speed: 0.0048s/iter; left time: 25.6395s
	iters: 1000, epoch: 3 | loss: 0.3020248
	speed: 0.0048s/iter; left time: 25.1884s
Updating learning rate to 0.00018037633276823655
Epoch: 3 cost time: 4.916351556777954
Epoch: 3, Steps: 1045 | Train Loss: 0.4173087 Vali Loss: 0.2909819 Best vali loss: 0.2826280
	iters: 100, epoch: 4 | loss: 0.3695574
	speed: 0.0137s/iter; left time: 70.4065s
	iters: 200, epoch: 4 | loss: 0.3703574
	speed: 0.0048s/iter; left time: 23.9534s
	iters: 300, epoch: 4 | loss: 0.3651535
	speed: 0.0048s/iter; left time: 23.6183s
	iters: 400, epoch: 4 | loss: 0.1145924
	speed: 0.0048s/iter; left time: 22.9298s
	iters: 500, epoch: 4 | loss: 0.9592241
	speed: 0.0047s/iter; left time: 22.2863s
	iters: 600, epoch: 4 | loss: 0.2606057
	speed: 0.0045s/iter; left time: 20.6639s
	iters: 700, epoch: 4 | loss: 1.3778969
	speed: 0.0044s/iter; left time: 19.9690s
	iters: 800, epoch: 4 | loss: 0.6160970
	speed: 0.0044s/iter; left time: 19.4825s
	iters: 900, epoch: 4 | loss: 0.1307178
	speed: 0.0045s/iter; left time: 19.2610s
	iters: 1000, epoch: 4 | loss: 0.4121785
	speed: 0.0045s/iter; left time: 18.9830s
Updating learning rate to 0.00013045381795
Epoch: 4 cost time: 4.846365451812744
Epoch: 4, Steps: 1045 | Train Loss: 0.4976381 Vali Loss: 0.2885059 Best vali loss: 0.2826280
	iters: 100, epoch: 5 | loss: 0.4120102
	speed: 0.0131s/iter; left time: 53.5600s
	iters: 200, epoch: 5 | loss: 0.5697942
	speed: 0.0044s/iter; left time: 17.6509s
	iters: 300, epoch: 5 | loss: 0.2278662
	speed: 0.0045s/iter; left time: 17.3726s
	iters: 400, epoch: 5 | loss: 1.0933423
	speed: 0.0045s/iter; left time: 17.0575s
	iters: 500, epoch: 5 | loss: 0.1681856
	speed: 0.0048s/iter; left time: 17.7234s
	iters: 600, epoch: 5 | loss: 0.4007685
	speed: 0.0049s/iter; left time: 17.6245s
	iters: 700, epoch: 5 | loss: 0.3421823
	speed: 0.0049s/iter; left time: 17.1197s
	iters: 800, epoch: 5 | loss: 1.5099889
	speed: 0.0048s/iter; left time: 16.3208s
	iters: 900, epoch: 5 | loss: 0.9016097
	speed: 0.0048s/iter; left time: 15.8941s
	iters: 1000, epoch: 5 | loss: 0.1661615
	speed: 0.0049s/iter; left time: 15.6044s
Updating learning rate to 8.053130313176344e-05
Epoch: 5 cost time: 4.958740234375
Epoch: 5, Steps: 1045 | Train Loss: 0.5791909 Vali Loss: 0.2849244 Best vali loss: 0.2826280
	iters: 100, epoch: 6 | loss: 0.2488740
	speed: 0.0138s/iter; left time: 41.7654s
	iters: 200, epoch: 6 | loss: 0.9711237
	speed: 0.0046s/iter; left time: 13.6493s
	iters: 300, epoch: 6 | loss: 0.3579606
	speed: 0.0047s/iter; left time: 13.3081s
	iters: 400, epoch: 6 | loss: 0.2537719
	speed: 0.0048s/iter; left time: 12.9986s
	iters: 500, epoch: 6 | loss: 0.2889365
	speed: 0.0048s/iter; left time: 12.5641s
	iters: 600, epoch: 6 | loss: 0.1780766
	speed: 0.0048s/iter; left time: 12.1157s
	iters: 700, epoch: 6 | loss: 0.9252404
	speed: 0.0048s/iter; left time: 11.8142s
	iters: 800, epoch: 6 | loss: 0.8821175
	speed: 0.0046s/iter; left time: 10.7136s
	iters: 900, epoch: 6 | loss: 0.2420094
	speed: 0.0045s/iter; left time: 10.0095s
	iters: 1000, epoch: 6 | loss: 0.2479014
	speed: 0.0045s/iter; left time: 9.5697s
Updating learning rate to 3.820903864587965e-05
Epoch: 6 cost time: 4.921525716781616
Epoch: 6, Steps: 1045 | Train Loss: 0.4596012 Vali Loss: 0.2858686 Best vali loss: 0.2826280
	iters: 100, epoch: 7 | loss: 0.9968597
	speed: 0.0130s/iter; left time: 25.8811s
	iters: 200, epoch: 7 | loss: 0.4440085
	speed: 0.0047s/iter; left time: 8.8665s
	iters: 300, epoch: 7 | loss: 0.3025333
	speed: 0.0047s/iter; left time: 8.3314s
	iters: 400, epoch: 7 | loss: 0.5143442
	speed: 0.0047s/iter; left time: 8.0120s
	iters: 500, epoch: 7 | loss: 0.3918281
	speed: 0.0048s/iter; left time: 7.5943s
	iters: 600, epoch: 7 | loss: 0.6760052
	speed: 0.0047s/iter; left time: 6.9744s
	iters: 700, epoch: 7 | loss: 1.0665470
	speed: 0.0047s/iter; left time: 6.4756s
	iters: 800, epoch: 7 | loss: 0.4113858
	speed: 0.0047s/iter; left time: 6.0078s
	iters: 900, epoch: 7 | loss: 0.3970156
	speed: 0.0047s/iter; left time: 5.5664s
	iters: 1000, epoch: 7 | loss: 0.1881201
	speed: 0.0047s/iter; left time: 5.0905s
Updating learning rate to 9.930205608041492e-06
Epoch: 7 cost time: 4.913640737533569
Epoch: 7, Steps: 1045 | Train Loss: 0.5388647 Vali Loss: 0.2917520 Best vali loss: 0.2826280
	iters: 100, epoch: 8 | loss: 0.2889307
	speed: 0.0130s/iter; left time: 12.2937s
	iters: 200, epoch: 8 | loss: 0.2760628
	speed: 0.0043s/iter; left time: 3.6545s
	iters: 300, epoch: 8 | loss: 0.7475345
	speed: 0.0043s/iter; left time: 3.1833s
	iters: 400, epoch: 8 | loss: 0.2012026
	speed: 0.0043s/iter; left time: 2.7796s
	iters: 500, epoch: 8 | loss: 0.2941327
	speed: 0.0043s/iter; left time: 2.3573s
	iters: 600, epoch: 8 | loss: 0.3349464
	speed: 0.0043s/iter; left time: 1.9223s
	iters: 700, epoch: 8 | loss: 0.2853509
	speed: 0.0046s/iter; left time: 1.5854s
	iters: 800, epoch: 8 | loss: 0.2438675
	speed: 0.0047s/iter; left time: 1.1551s
	iters: 900, epoch: 8 | loss: 0.4657359
	speed: 0.0048s/iter; left time: 0.6960s
	iters: 1000, epoch: 8 | loss: 0.5635715
	speed: 0.0048s/iter; left time: 0.2201s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.722132205963135
Epoch: 8, Steps: 1045 | Train Loss: 0.3701335 Vali Loss: 0.2892978 Best vali loss: 0.2826280

best validation loss 0.2826279625878453

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0015805393457, 'e_layers': 2, 'learning_rate': 8.07100708e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4163376
	speed: 0.0088s/iter; left time: 36.0883s
	iters: 200, epoch: 1 | loss: 0.4462556
	speed: 0.0034s/iter; left time: 13.4340s
	iters: 300, epoch: 1 | loss: 0.4204704
	speed: 0.0034s/iter; left time: 13.1068s
	iters: 400, epoch: 1 | loss: 0.8083978
	speed: 0.0034s/iter; left time: 12.8838s
	iters: 500, epoch: 1 | loss: 0.9810213
	speed: 0.0034s/iter; left time: 12.4508s
Updating learning rate to 7.763822663982842e-05
Validation loss decreased (inf --> 0.3133).  Saving model state dict ...
Epoch: 1 cost time: 2.03720760345459
Epoch: 1, Steps: 523 | Train Loss: 0.6144965 Vali Loss: 0.3133314 Best vali loss: 0.3133314
	iters: 100, epoch: 2 | loss: 0.3557090
	speed: 0.0074s/iter; left time: 26.2480s
	iters: 200, epoch: 2 | loss: 0.5992981
	speed: 0.0035s/iter; left time: 12.0109s
	iters: 300, epoch: 2 | loss: 0.5376678
	speed: 0.0035s/iter; left time: 11.6656s
	iters: 400, epoch: 2 | loss: 0.2827719
	speed: 0.0035s/iter; left time: 11.2879s
	iters: 500, epoch: 2 | loss: 0.4867885
	speed: 0.0035s/iter; left time: 10.9750s
Updating learning rate to 6.889035458636317e-05
Validation loss decreased (0.3133 --> 0.3001).  Saving model state dict ...
Epoch: 2 cost time: 1.8512258529663086
Epoch: 2, Steps: 523 | Train Loss: 0.4524471 Vali Loss: 0.3001289 Best vali loss: 0.3001289
	iters: 100, epoch: 3 | loss: 0.9148958
	speed: 0.0072s/iter; left time: 21.8705s
	iters: 200, epoch: 3 | loss: 0.7759619
	speed: 0.0030s/iter; left time: 8.8465s
	iters: 300, epoch: 3 | loss: 0.5931015
	speed: 0.0030s/iter; left time: 8.6091s
	iters: 400, epoch: 3 | loss: 0.3325840
	speed: 0.0031s/iter; left time: 8.4195s
	iters: 500, epoch: 3 | loss: 0.2357758
	speed: 0.0030s/iter; left time: 7.7982s
Updating learning rate to 5.57982388600867e-05
Validation loss decreased (0.3001 --> 0.2939).  Saving model state dict ...
Epoch: 3 cost time: 1.6250274181365967
Epoch: 3, Steps: 523 | Train Loss: 0.5704638 Vali Loss: 0.2939494 Best vali loss: 0.2939494

best validation loss 0.29394936827577683

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269744113, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597177
	speed: 0.0105s/iter; left time: 9.9812s
Updating learning rate to 0.00022560791579784574
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9411299228668213
Epoch: 1, Steps: 131 | Train Loss: 0.5597177 Vali Loss: 0.2756320 Best vali loss: 0.2756320
	iters: 100, epoch: 2 | loss: 0.3243264
	speed: 0.0087s/iter; left time: 7.1240s
Updating learning rate to 0.00020018758786062745
Validation loss decreased (0.2756 --> 0.2696).  Saving model state dict ...
Epoch: 2 cost time: 0.6894981861114502
Epoch: 2, Steps: 131 | Train Loss: 0.3243264 Vali Loss: 0.2695553 Best vali loss: 0.2695553
	iters: 100, epoch: 3 | loss: 0.4656848
	speed: 0.0089s/iter; left time: 6.1006s
Updating learning rate to 0.00016214337858094004
Epoch: 3 cost time: 0.7100145816802979
Epoch: 3, Steps: 131 | Train Loss: 0.4656848 Vali Loss: 0.2820250 Best vali loss: 0.2695553

best validation loss 0.269555311723463

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0084304094852, 'e_layers': 1, 'learning_rate': 0.0002498380731, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00024032917763957436
Validation loss decreased (inf --> 0.3251).  Saving model state dict ...
Epoch: 1 cost time: 0.4998757839202881
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3250812 Best vali loss: 0.3250812
Updating learning rate to 0.0002132501343937952
Validation loss decreased (0.3251 --> 0.3072).  Saving model state dict ...
Epoch: 2 cost time: 0.27004456520080566
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3072271 Best vali loss: 0.3072271
Updating learning rate to 0.00017272348222469413
Validation loss decreased (0.3072 --> 0.2984).  Saving model state dict ...
Epoch: 3 cost time: 0.27042198181152344
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2983651 Best vali loss: 0.2983651

best validation loss 0.298365080182594

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269744113, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4146569
	speed: 0.0109s/iter; left time: 6.0454s
Updating learning rate to 0.00011726717395
Epoch: 4 cost time: 0.9332382678985596
Epoch: 4, Steps: 131 | Train Loss: 0.4146569 Vali Loss: 0.2844758 Best vali loss: 0.2695553
	iters: 100, epoch: 5 | loss: 0.2685639
	speed: 0.0086s/iter; left time: 3.6650s
Updating learning rate to 7.239096931905996e-05
Epoch: 5 cost time: 0.6983544826507568
Epoch: 5, Steps: 131 | Train Loss: 0.2685639 Vali Loss: 0.2923557 Best vali loss: 0.2695553
	iters: 100, epoch: 6 | loss: 0.3839744
	speed: 0.0086s/iter; left time: 2.5337s
Updating learning rate to 3.434676003937255e-05
Epoch: 6 cost time: 0.69278883934021
Epoch: 6, Steps: 131 | Train Loss: 0.3839744 Vali Loss: 0.2970090 Best vali loss: 0.2695553
	iters: 100, epoch: 7 | loss: 0.3946351
	speed: 0.0087s/iter; left time: 1.4111s
Updating learning rate to 8.926432102154258e-06
Epoch: 7 cost time: 0.7003171443939209
Epoch: 7, Steps: 131 | Train Loss: 0.3946351 Vali Loss: 0.3016595 Best vali loss: 0.2695553
	iters: 100, epoch: 8 | loss: 0.2986743
	speed: 0.0086s/iter; left time: 0.2756s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6943795680999756
Epoch: 8, Steps: 131 | Train Loss: 0.2986743 Vali Loss: 0.3051416 Best vali loss: 0.2695553

best validation loss 0.269555311723463

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022410579475, 'e_layers': 4, 'learning_rate': 0.0020200496769, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019431661140219738
Validation loss decreased (inf --> 0.3034).  Saving model state dict ...
Epoch: 1 cost time: 0.6611819267272949
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3033854 Best vali loss: 0.3033854
Updating learning rate to 0.001724220250884842
Validation loss decreased (0.3034 --> 0.3015).  Saving model state dict ...
Epoch: 2 cost time: 0.4127166271209717
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3015203 Best vali loss: 0.3015203
Updating learning rate to 0.0013965446104020414
Epoch: 3 cost time: 0.46734189987182617
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3069506 Best vali loss: 0.3015203
Updating learning rate to 0.00101002483845
Epoch: 4 cost time: 0.40512871742248535
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3153666 Best vali loss: 0.3015203
Updating learning rate to 0.0006235050664979587
Validation loss decreased (0.3015 --> 0.2957).  Saving model state dict ...
Epoch: 5 cost time: 0.4183368682861328
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2957222 Best vali loss: 0.2957222
Updating learning rate to 0.0002958294260151579
Epoch: 6 cost time: 0.4610316753387451
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3270515 Best vali loss: 0.2957222
Updating learning rate to 7.688356287802609e-05
Epoch: 7 cost time: 0.4551270008087158
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3124154 Best vali loss: 0.2957222
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4238457679748535
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3207845 Best vali loss: 0.2957222

best validation loss 0.29572220692496265

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019328650631, 'e_layers': 2, 'learning_rate': 0.000324563729, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00031221075760932
Validation loss decreased (inf --> 0.2865).  Saving model state dict ...
Epoch: 1 cost time: 0.7836852073669434
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2864566 Best vali loss: 0.2864566
Updating learning rate to 0.00027703247135154647
Validation loss decreased (0.2865 --> 0.2759).  Saving model state dict ...
Epoch: 2 cost time: 0.5631890296936035
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2759004 Best vali loss: 0.2759004
Updating learning rate to 0.00022438444541746642
Epoch: 3 cost time: 0.5682544708251953
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2995039 Best vali loss: 0.2759004
Updating learning rate to 0.0001622818645
Epoch: 4 cost time: 0.5651473999023438
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2862045 Best vali loss: 0.2759004
Updating learning rate to 0.0001001792835825336
Epoch: 5 cost time: 0.5578427314758301
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2877886 Best vali loss: 0.2759004
Updating learning rate to 4.753125764845355e-05
Epoch: 6 cost time: 0.5633783340454102
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2911241 Best vali loss: 0.2759004
Updating learning rate to 1.235297139068002e-05
Epoch: 7 cost time: 0.5605504512786865
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2940259 Best vali loss: 0.2759004
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5624797344207764
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2954518 Best vali loss: 0.2759004

best validation loss 0.27590044916185935

[INFO][smbo.py:320] Finished 900 trials.
{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0035846957009, 'e_layers': 2, 'learning_rate': 0.001462558863, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001462558863
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 0.56258225440979
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2878002 Best vali loss: 0.2878002
Updating learning rate to 0.0007312794315
Epoch: 2 cost time: 0.3151061534881592
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2891273 Best vali loss: 0.2878002
Updating learning rate to 0.00036563971575
Epoch: 3 cost time: 0.31107211112976074
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905906 Best vali loss: 0.2878002

best validation loss 0.2878002191662744

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.00102705242, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597141
	speed: 0.0105s/iter; left time: 9.9660s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9351646900177002
Epoch: 1, Steps: 131 | Train Loss: 0.5597141 Vali Loss: 0.2756468 Best vali loss: 0.2756468
	iters: 100, epoch: 2 | loss: 0.3247823
	speed: 0.0088s/iter; left time: 7.2193s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2756 --> 0.2711).  Saving model state dict ...
Epoch: 2 cost time: 0.7010183334350586
Epoch: 2, Steps: 131 | Train Loss: 0.3247823 Vali Loss: 0.2711067 Best vali loss: 0.2711067
	iters: 100, epoch: 3 | loss: 0.4624473
	speed: 0.0089s/iter; left time: 6.1451s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.6996586322784424
Epoch: 3, Steps: 131 | Train Loss: 0.4624473 Vali Loss: 0.2759639 Best vali loss: 0.2711067

best validation loss 0.27110668406162

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271475873, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597029
	speed: 0.0103s/iter; left time: 9.7850s
Updating learning rate to 0.0002345378908
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9160611629486084
Epoch: 1, Steps: 131 | Train Loss: 0.5597029 Vali Loss: 0.2756335 Best vali loss: 0.2756335
	iters: 100, epoch: 2 | loss: 0.3240543
	speed: 0.0089s/iter; left time: 7.2739s
Updating learning rate to 0.0001172689454
Validation loss decreased (0.2756 --> 0.2689).  Saving model state dict ...
Epoch: 2 cost time: 0.7015612125396729
Epoch: 2, Steps: 131 | Train Loss: 0.3240543 Vali Loss: 0.2688943 Best vali loss: 0.2688943
	iters: 100, epoch: 3 | loss: 0.4633613
	speed: 0.0090s/iter; left time: 6.2169s
Updating learning rate to 5.86344727e-05
Epoch: 3 cost time: 0.7144308090209961
Epoch: 3, Steps: 131 | Train Loss: 0.4633613 Vali Loss: 0.2749748 Best vali loss: 0.2688943

best validation loss 0.26889430135543924

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271475873, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4225113
	speed: 0.0107s/iter; left time: 5.9650s
Updating learning rate to 2.931723635e-05
Epoch: 4 cost time: 0.9263861179351807
Epoch: 4, Steps: 131 | Train Loss: 0.4225113 Vali Loss: 0.2952424 Best vali loss: 0.2688943
	iters: 100, epoch: 5 | loss: 0.2809562
	speed: 0.0086s/iter; left time: 3.6523s
Updating learning rate to 1.4658618175e-05
Epoch: 5 cost time: 0.6929945945739746
Epoch: 5, Steps: 131 | Train Loss: 0.2809562 Vali Loss: 0.2895954 Best vali loss: 0.2688943
	iters: 100, epoch: 6 | loss: 0.4363644
	speed: 0.0085s/iter; left time: 2.5121s
Updating learning rate to 7.3293090875e-06
Epoch: 6 cost time: 0.6932821273803711
Epoch: 6, Steps: 131 | Train Loss: 0.4363644 Vali Loss: 0.2945897 Best vali loss: 0.2688943
	iters: 100, epoch: 7 | loss: 0.4673900
	speed: 0.0087s/iter; left time: 1.4204s
Updating learning rate to 3.66465454375e-06
Epoch: 7 cost time: 0.6997833251953125
Epoch: 7, Steps: 131 | Train Loss: 0.4673900 Vali Loss: 0.2923978 Best vali loss: 0.2688943
	iters: 100, epoch: 8 | loss: 0.3301294
	speed: 0.0086s/iter; left time: 0.2752s
Updating learning rate to 1.832327271875e-06
Epoch: 8 cost time: 0.698575496673584
Epoch: 8, Steps: 131 | Train Loss: 0.3301294 Vali Loss: 0.2895574 Best vali loss: 0.2688943

best validation loss 0.26889430135543924

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010278975877, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597020
	speed: 0.0104s/iter; left time: 9.9031s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9297261238098145
Epoch: 1, Steps: 131 | Train Loss: 0.5597020 Vali Loss: 0.2756332 Best vali loss: 0.2756332
	iters: 100, epoch: 2 | loss: 0.3251440
	speed: 0.0090s/iter; left time: 7.3742s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2712).  Saving model state dict ...
Epoch: 2 cost time: 0.7071418762207031
Epoch: 2, Steps: 131 | Train Loss: 0.3251440 Vali Loss: 0.2711590 Best vali loss: 0.2711590
	iters: 100, epoch: 3 | loss: 0.4668310
	speed: 0.0090s/iter; left time: 6.1789s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.7005665302276611
Epoch: 3, Steps: 131 | Train Loss: 0.4668310 Vali Loss: 0.2844278 Best vali loss: 0.2711590
	iters: 100, epoch: 4 | loss: 0.5110258
	speed: 0.0086s/iter; left time: 4.8087s
Updating learning rate to 2.93167934875e-05
Epoch: 4 cost time: 0.6975703239440918
Epoch: 4, Steps: 131 | Train Loss: 0.5110258 Vali Loss: 0.2854246 Best vali loss: 0.2711590
	iters: 100, epoch: 5 | loss: 0.3336246
	speed: 0.0086s/iter; left time: 3.6560s
Updating learning rate to 1.465839674375e-05
Epoch: 5 cost time: 0.6959493160247803
Epoch: 5, Steps: 131 | Train Loss: 0.3336246 Vali Loss: 0.2838291 Best vali loss: 0.2711590
	iters: 100, epoch: 6 | loss: 0.3195649
	speed: 0.0086s/iter; left time: 2.5280s
Updating learning rate to 7.329198371875e-06
Epoch: 6 cost time: 0.698458194732666
Epoch: 6, Steps: 131 | Train Loss: 0.3195649 Vali Loss: 0.2871286 Best vali loss: 0.2711590
	iters: 100, epoch: 7 | loss: 0.3113918
	speed: 0.0087s/iter; left time: 1.4200s
Updating learning rate to 3.6645991859375e-06
Epoch: 7 cost time: 0.7076294422149658
Epoch: 7, Steps: 131 | Train Loss: 0.3113918 Vali Loss: 0.2946364 Best vali loss: 0.2711590
	iters: 100, epoch: 8 | loss: 0.3976147
	speed: 0.0088s/iter; left time: 0.2809s
Updating learning rate to 1.83229959296875e-06
Epoch: 8 cost time: 0.705528974533081
Epoch: 8, Steps: 131 | Train Loss: 0.3976147 Vali Loss: 0.2938066 Best vali loss: 0.2711590

best validation loss 0.2711590420982571

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010272422243, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597000
	speed: 0.0103s/iter; left time: 9.7347s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9229848384857178
Epoch: 1, Steps: 131 | Train Loss: 0.5597000 Vali Loss: 0.2756443 Best vali loss: 0.2756443
	iters: 100, epoch: 2 | loss: 0.3269577
	speed: 0.0089s/iter; left time: 7.2457s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.702484130859375
Epoch: 2, Steps: 131 | Train Loss: 0.3269577 Vali Loss: 0.2722542 Best vali loss: 0.2722542
	iters: 100, epoch: 3 | loss: 0.4625379
	speed: 0.0090s/iter; left time: 6.1832s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7050971984863281
Epoch: 3, Steps: 131 | Train Loss: 0.4625379 Vali Loss: 0.2827406 Best vali loss: 0.2722542
	iters: 100, epoch: 4 | loss: 0.5092029
	speed: 0.0086s/iter; left time: 4.7675s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.6944544315338135
Epoch: 4, Steps: 131 | Train Loss: 0.5092029 Vali Loss: 0.2914013 Best vali loss: 0.2722542
	iters: 100, epoch: 5 | loss: 0.3342466
	speed: 0.0086s/iter; left time: 3.6389s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6934704780578613
Epoch: 5, Steps: 131 | Train Loss: 0.3342466 Vali Loss: 0.2933974 Best vali loss: 0.2722542
	iters: 100, epoch: 6 | loss: 0.3202364
	speed: 0.0087s/iter; left time: 2.5593s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7008826732635498
Epoch: 6, Steps: 131 | Train Loss: 0.3202364 Vali Loss: 0.2921217 Best vali loss: 0.2722542
	iters: 100, epoch: 7 | loss: 0.3131115
	speed: 0.0086s/iter; left time: 1.4059s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7030880451202393
Epoch: 7, Steps: 131 | Train Loss: 0.3131115 Vali Loss: 0.3014858 Best vali loss: 0.2722542
	iters: 100, epoch: 8 | loss: 0.3966587
	speed: 0.0087s/iter; left time: 0.2785s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6986477375030518
Epoch: 8, Steps: 131 | Train Loss: 0.3966587 Vali Loss: 0.2993973 Best vali loss: 0.2722542

best validation loss 0.2722541988228457

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.004017113093, 'e_layers': 1, 'learning_rate': 0.0001769628797, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8253240
	speed: 0.0078s/iter; left time: 31.8579s
	iters: 200, epoch: 1 | loss: 0.3611309
	speed: 0.0026s/iter; left time: 10.4496s
	iters: 300, epoch: 1 | loss: 0.4022897
	speed: 0.0027s/iter; left time: 10.5054s
	iters: 400, epoch: 1 | loss: 0.6866411
	speed: 0.0026s/iter; left time: 9.8222s
	iters: 500, epoch: 1 | loss: 0.2896671
	speed: 0.0025s/iter; left time: 9.2880s
Updating learning rate to 0.00017022763113454353
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 1.621046543121338
Epoch: 1, Steps: 523 | Train Loss: 0.5130105 Vali Loss: 0.2836345 Best vali loss: 0.2836345
	iters: 100, epoch: 2 | loss: 0.8106762
	speed: 0.0058s/iter; left time: 20.7487s
	iters: 200, epoch: 2 | loss: 0.5211809
	speed: 0.0025s/iter; left time: 8.4996s
	iters: 300, epoch: 2 | loss: 0.6271425
	speed: 0.0024s/iter; left time: 8.1866s
	iters: 400, epoch: 2 | loss: 0.5806549
	speed: 0.0024s/iter; left time: 7.8588s
	iters: 500, epoch: 2 | loss: 0.6122642
	speed: 0.0024s/iter; left time: 7.5255s
Updating learning rate to 0.00015104726597708461
Validation loss decreased (0.2836 --> 0.2789).  Saving model state dict ...
Epoch: 2 cost time: 1.3073515892028809
Epoch: 2, Steps: 523 | Train Loss: 0.6303837 Vali Loss: 0.2789260 Best vali loss: 0.2789260
	iters: 100, epoch: 3 | loss: 0.7871439
	speed: 0.0059s/iter; left time: 17.8007s
	iters: 200, epoch: 3 | loss: 0.3168303
	speed: 0.0023s/iter; left time: 6.8166s
	iters: 300, epoch: 3 | loss: 0.3271371
	speed: 0.0024s/iter; left time: 6.6999s
	iters: 400, epoch: 3 | loss: 0.5706783
	speed: 0.0025s/iter; left time: 6.9328s
	iters: 500, epoch: 3 | loss: 0.3062088
	speed: 0.0025s/iter; left time: 6.5431s
Updating learning rate to 0.00012234182095240324
Epoch: 3 cost time: 1.29923415184021
Epoch: 3, Steps: 523 | Train Loss: 0.4615997 Vali Loss: 0.2878196 Best vali loss: 0.2789260

best validation loss 0.27892600522470457

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0014757317567, 'e_layers': 4, 'learning_rate': 0.001383168761, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4786486
	speed: 0.0109s/iter; left time: 21.6985s
	iters: 200, epoch: 1 | loss: 0.7252516
	speed: 0.0056s/iter; left time: 10.6396s
Updating learning rate to 0.001383168761
Validation loss decreased (inf --> 0.3156).  Saving model state dict ...
Epoch: 1 cost time: 1.7413103580474854
Epoch: 1, Steps: 262 | Train Loss: 0.6019501 Vali Loss: 0.3156144 Best vali loss: 0.3156144
	iters: 100, epoch: 2 | loss: 0.4760491
	speed: 0.0122s/iter; left time: 21.0918s
	iters: 200, epoch: 2 | loss: 0.4433192
	speed: 0.0055s/iter; left time: 8.9111s
Updating learning rate to 0.0006915843805
Epoch: 2 cost time: 1.4744596481323242
Epoch: 2, Steps: 262 | Train Loss: 0.4596841 Vali Loss: 0.3326616 Best vali loss: 0.3156144
	iters: 100, epoch: 3 | loss: 0.5834289
	speed: 0.0120s/iter; left time: 17.6406s
	iters: 200, epoch: 3 | loss: 0.6228188
	speed: 0.0053s/iter; left time: 7.2791s
Updating learning rate to 0.00034579219025
Epoch: 3 cost time: 1.4652717113494873
Epoch: 3, Steps: 262 | Train Loss: 0.6031239 Vali Loss: 0.3201173 Best vali loss: 0.3156144

best validation loss 0.3156143676817927

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0041525317056, 'e_layers': 1, 'learning_rate': 5.95857319e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.731788501605743e-05
Validation loss decreased (inf --> 0.3260).  Saving model state dict ...
Epoch: 1 cost time: 0.5002992153167725
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3260038 Best vali loss: 0.3260038
Updating learning rate to 5.085960349422679e-05
Validation loss decreased (0.3260 --> 0.3083).  Saving model state dict ...
Epoch: 2 cost time: 0.25666093826293945
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3083388 Best vali loss: 0.3083388
Updating learning rate to 4.119410215173901e-05
Validation loss decreased (0.3083 --> 0.2985).  Saving model state dict ...
Epoch: 3 cost time: 0.26233673095703125
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2985473 Best vali loss: 0.2985473

best validation loss 0.2985473482964118

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.004017113093, 'e_layers': 1, 'learning_rate': 0.0001769628797, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7721291
	speed: 0.0078s/iter; left time: 19.7114s
	iters: 200, epoch: 4 | loss: 0.3426912
	speed: 0.0024s/iter; left time: 5.8914s
	iters: 300, epoch: 4 | loss: 0.3949402
	speed: 0.0025s/iter; left time: 5.7444s
	iters: 400, epoch: 4 | loss: 0.6140955
	speed: 0.0024s/iter; left time: 5.3919s
	iters: 500, epoch: 4 | loss: 0.2723487
	speed: 0.0024s/iter; left time: 5.1313s
Updating learning rate to 8.848143985e-05
Epoch: 4 cost time: 1.5417213439941406
Epoch: 4, Steps: 523 | Train Loss: 0.4792409 Vali Loss: 0.2910681 Best vali loss: 0.2789260
	iters: 100, epoch: 5 | loss: 0.5383653
	speed: 0.0057s/iter; left time: 11.4258s
	iters: 200, epoch: 5 | loss: 0.4920014
	speed: 0.0025s/iter; left time: 4.7529s
	iters: 300, epoch: 5 | loss: 0.4277393
	speed: 0.0025s/iter; left time: 4.4375s
	iters: 400, epoch: 5 | loss: 0.5628706
	speed: 0.0025s/iter; left time: 4.1757s
	iters: 500, epoch: 5 | loss: 0.5695466
	speed: 0.0024s/iter; left time: 3.8855s
Updating learning rate to 5.462105874759677e-05
Epoch: 5 cost time: 1.3313407897949219
Epoch: 5, Steps: 523 | Train Loss: 0.5181046 Vali Loss: 0.2932645 Best vali loss: 0.2789260
	iters: 100, epoch: 6 | loss: 0.6497251
	speed: 0.0057s/iter; left time: 8.3601s
	iters: 200, epoch: 6 | loss: 0.2489636
	speed: 0.0025s/iter; left time: 3.3741s
	iters: 300, epoch: 6 | loss: 0.2858307
	speed: 0.0024s/iter; left time: 3.0755s
	iters: 400, epoch: 6 | loss: 0.4941763
	speed: 0.0024s/iter; left time: 2.8313s
	iters: 500, epoch: 6 | loss: 0.2707895
	speed: 0.0024s/iter; left time: 2.6128s
Updating learning rate to 2.5915613722915392e-05
Epoch: 6 cost time: 1.3130509853363037
Epoch: 6, Steps: 523 | Train Loss: 0.3898970 Vali Loss: 0.2967944 Best vali loss: 0.2789260
	iters: 100, epoch: 7 | loss: 0.2386200
	speed: 0.0057s/iter; left time: 5.4377s
	iters: 200, epoch: 7 | loss: 0.5266759
	speed: 0.0024s/iter; left time: 2.0693s
	iters: 300, epoch: 7 | loss: 0.2420262
	speed: 0.0024s/iter; left time: 1.8206s
	iters: 400, epoch: 7 | loss: 0.3254689
	speed: 0.0024s/iter; left time: 1.5846s
	iters: 500, epoch: 7 | loss: 0.4356065
	speed: 0.0025s/iter; left time: 1.3433s
Updating learning rate to 6.735248565456464e-06
Epoch: 7 cost time: 1.311363697052002
Epoch: 7, Steps: 523 | Train Loss: 0.3536795 Vali Loss: 0.2961799 Best vali loss: 0.2789260
	iters: 100, epoch: 8 | loss: 0.2560465
	speed: 0.0058s/iter; left time: 2.4382s
	iters: 200, epoch: 8 | loss: 0.5046996
	speed: 0.0024s/iter; left time: 0.7937s
	iters: 300, epoch: 8 | loss: 0.2873577
	speed: 0.0025s/iter; left time: 0.5596s
	iters: 400, epoch: 8 | loss: 0.5070041
	speed: 0.0025s/iter; left time: 0.3088s
	iters: 500, epoch: 8 | loss: 0.3104827
	speed: 0.0025s/iter; left time: 0.0596s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3365857601165771
Epoch: 8, Steps: 523 | Train Loss: 0.3731181 Vali Loss: 0.2964021 Best vali loss: 0.2789260

best validation loss 0.27892600522470457

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032565750535, 'e_layers': 4, 'learning_rate': 0.0031694500263, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3189570
	speed: 0.0105s/iter; left time: 86.7298s
	iters: 200, epoch: 1 | loss: 0.3829000
	speed: 0.0051s/iter; left time: 41.2344s
	iters: 300, epoch: 1 | loss: 0.3426242
	speed: 0.0051s/iter; left time: 40.8148s
	iters: 400, epoch: 1 | loss: 0.4920774
	speed: 0.0051s/iter; left time: 40.5809s
	iters: 500, epoch: 1 | loss: 0.4974460
	speed: 0.0051s/iter; left time: 39.7563s
	iters: 600, epoch: 1 | loss: 1.6896080
	speed: 0.0051s/iter; left time: 39.3700s
	iters: 700, epoch: 1 | loss: 0.3117369
	speed: 0.0051s/iter; left time: 39.0694s
	iters: 800, epoch: 1 | loss: 0.2026065
	speed: 0.0051s/iter; left time: 38.4854s
	iters: 900, epoch: 1 | loss: 0.5043706
	speed: 0.0051s/iter; left time: 37.9022s
	iters: 1000, epoch: 1 | loss: 0.4077427
	speed: 0.0051s/iter; left time: 37.3144s
Updating learning rate to 0.0031694500263
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 5.5679521560668945
Epoch: 1, Steps: 1045 | Train Loss: 0.5150069 Vali Loss: 0.3201302 Best vali loss: 0.3201302
	iters: 100, epoch: 2 | loss: 0.7672250
	speed: 0.0139s/iter; left time: 100.0173s
	iters: 200, epoch: 2 | loss: 0.2468347
	speed: 0.0049s/iter; left time: 34.6147s
	iters: 300, epoch: 2 | loss: 0.3754789
	speed: 0.0049s/iter; left time: 34.1866s
	iters: 400, epoch: 2 | loss: 1.4387492
	speed: 0.0048s/iter; left time: 33.4101s
	iters: 500, epoch: 2 | loss: 0.9910377
	speed: 0.0048s/iter; left time: 32.6076s
	iters: 600, epoch: 2 | loss: 0.2925748
	speed: 0.0048s/iter; left time: 32.3281s
	iters: 700, epoch: 2 | loss: 0.4327236
	speed: 0.0048s/iter; left time: 32.0232s
	iters: 800, epoch: 2 | loss: 0.4058634
	speed: 0.0048s/iter; left time: 31.5777s
	iters: 900, epoch: 2 | loss: 0.3699072
	speed: 0.0048s/iter; left time: 30.9299s
	iters: 1000, epoch: 2 | loss: 0.2409284
	speed: 0.0048s/iter; left time: 30.4081s
Updating learning rate to 0.00158472501315
Epoch: 2 cost time: 5.088757038116455
Epoch: 2, Steps: 1045 | Train Loss: 0.5561323 Vali Loss: 0.3215290 Best vali loss: 0.3201302
	iters: 100, epoch: 3 | loss: 0.4039260
	speed: 0.0135s/iter; left time: 83.4237s
	iters: 200, epoch: 3 | loss: 1.0963560
	speed: 0.0046s/iter; left time: 28.1982s
	iters: 300, epoch: 3 | loss: 0.8311340
	speed: 0.0046s/iter; left time: 27.6581s
	iters: 400, epoch: 3 | loss: 0.8883191
	speed: 0.0045s/iter; left time: 26.6941s
	iters: 500, epoch: 3 | loss: 0.3536950
	speed: 0.0046s/iter; left time: 26.5373s
	iters: 600, epoch: 3 | loss: 0.5349537
	speed: 0.0044s/iter; left time: 24.7966s
	iters: 700, epoch: 3 | loss: 1.1019522
	speed: 0.0045s/iter; left time: 24.9064s
	iters: 800, epoch: 3 | loss: 0.2254510
	speed: 0.0045s/iter; left time: 24.4928s
	iters: 900, epoch: 3 | loss: 0.4764925
	speed: 0.0044s/iter; left time: 23.4129s
	iters: 1000, epoch: 3 | loss: 0.6368118
	speed: 0.0044s/iter; left time: 22.9841s
Updating learning rate to 0.000792362506575
Epoch: 3 cost time: 4.749816656112671
Epoch: 3, Steps: 1045 | Train Loss: 0.6549091 Vali Loss: 0.3228231 Best vali loss: 0.3201302
	iters: 100, epoch: 4 | loss: 0.2713556
	speed: 0.0129s/iter; left time: 66.3485s
	iters: 200, epoch: 4 | loss: 0.2573378
	speed: 0.0044s/iter; left time: 22.1708s
	iters: 300, epoch: 4 | loss: 0.3576707
	speed: 0.0044s/iter; left time: 21.8371s
	iters: 400, epoch: 4 | loss: 0.4138997
	speed: 0.0044s/iter; left time: 21.2050s
	iters: 500, epoch: 4 | loss: 1.1553385
	speed: 0.0044s/iter; left time: 21.0287s
	iters: 600, epoch: 4 | loss: 1.7598259
	speed: 0.0044s/iter; left time: 20.3651s
	iters: 700, epoch: 4 | loss: 0.4042681
	speed: 0.0044s/iter; left time: 19.8694s
	iters: 800, epoch: 4 | loss: 0.8594896
	speed: 0.0045s/iter; left time: 19.6994s
	iters: 900, epoch: 4 | loss: 0.3297084
	speed: 0.0044s/iter; left time: 19.0836s
	iters: 1000, epoch: 4 | loss: 0.9396948
	speed: 0.0044s/iter; left time: 18.7712s
Updating learning rate to 0.0003961812532875
Epoch: 4 cost time: 4.670227527618408
Epoch: 4, Steps: 1045 | Train Loss: 0.6748589 Vali Loss: 0.3215713 Best vali loss: 0.3201302
	iters: 100, epoch: 5 | loss: 0.3571400
	speed: 0.0133s/iter; left time: 54.4620s
	iters: 200, epoch: 5 | loss: 0.5654482
	speed: 0.0048s/iter; left time: 18.9277s
	iters: 300, epoch: 5 | loss: 0.4110843
	speed: 0.0047s/iter; left time: 18.2064s
	iters: 400, epoch: 5 | loss: 0.4521129
	speed: 0.0048s/iter; left time: 18.0115s
	iters: 500, epoch: 5 | loss: 0.3638857
	speed: 0.0047s/iter; left time: 17.2303s
	iters: 600, epoch: 5 | loss: 0.2388792
	speed: 0.0047s/iter; left time: 16.9386s
	iters: 700, epoch: 5 | loss: 0.2611396
	speed: 0.0047s/iter; left time: 16.4644s
	iters: 800, epoch: 5 | loss: 0.4173564
	speed: 0.0047s/iter; left time: 15.9608s
	iters: 900, epoch: 5 | loss: 0.5164946
	speed: 0.0047s/iter; left time: 15.3307s
	iters: 1000, epoch: 5 | loss: 0.8028385
	speed: 0.0047s/iter; left time: 14.9611s
Updating learning rate to 0.00019809062664375
Epoch: 5 cost time: 4.963435411453247
Epoch: 5, Steps: 1045 | Train Loss: 0.4386379 Vali Loss: 0.3217767 Best vali loss: 0.3201302
	iters: 100, epoch: 6 | loss: 0.3844773
	speed: 0.0132s/iter; left time: 40.0212s
	iters: 200, epoch: 6 | loss: 0.6290682
	speed: 0.0045s/iter; left time: 13.3116s
	iters: 300, epoch: 6 | loss: 0.2589766
	speed: 0.0046s/iter; left time: 12.9485s
	iters: 400, epoch: 6 | loss: 0.3725792
	speed: 0.0046s/iter; left time: 12.4763s
	iters: 500, epoch: 6 | loss: 0.3858511
	speed: 0.0045s/iter; left time: 11.8235s
	iters: 600, epoch: 6 | loss: 1.2288067
	speed: 0.0045s/iter; left time: 11.3523s
	iters: 700, epoch: 6 | loss: 0.5031787
	speed: 0.0045s/iter; left time: 10.9447s
	iters: 800, epoch: 6 | loss: 0.4227548
	speed: 0.0044s/iter; left time: 10.3158s
	iters: 900, epoch: 6 | loss: 0.1971509
	speed: 0.0044s/iter; left time: 9.7730s
	iters: 1000, epoch: 6 | loss: 0.2585131
	speed: 0.0044s/iter; left time: 9.3603s
Updating learning rate to 9.9045313321875e-05
Epoch: 6 cost time: 4.718001365661621
Epoch: 6, Steps: 1045 | Train Loss: 0.4641357 Vali Loss: 0.3219589 Best vali loss: 0.3201302
	iters: 100, epoch: 7 | loss: 0.4012221
	speed: 0.0137s/iter; left time: 27.3588s
	iters: 200, epoch: 7 | loss: 0.8768114
	speed: 0.0051s/iter; left time: 9.6451s
	iters: 300, epoch: 7 | loss: 0.5063714
	speed: 0.0051s/iter; left time: 9.2084s
	iters: 400, epoch: 7 | loss: 0.3863810
	speed: 0.0051s/iter; left time: 8.6089s
	iters: 500, epoch: 7 | loss: 0.2937344
	speed: 0.0052s/iter; left time: 8.2128s
	iters: 600, epoch: 7 | loss: 0.3424453
	speed: 0.0051s/iter; left time: 7.6280s
	iters: 700, epoch: 7 | loss: 0.2956267
	speed: 0.0050s/iter; left time: 7.0230s
	iters: 800, epoch: 7 | loss: 1.1929425
	speed: 0.0051s/iter; left time: 6.5257s
	iters: 900, epoch: 7 | loss: 0.4700225
	speed: 0.0051s/iter; left time: 6.0472s
	iters: 1000, epoch: 7 | loss: 0.9764675
	speed: 0.0051s/iter; left time: 5.5884s
Updating learning rate to 4.95226566609375e-05
Epoch: 7 cost time: 5.373975515365601
Epoch: 7, Steps: 1045 | Train Loss: 0.5742025 Vali Loss: 0.3219723 Best vali loss: 0.3201302
	iters: 100, epoch: 8 | loss: 0.4306040
	speed: 0.0141s/iter; left time: 13.3485s
	iters: 200, epoch: 8 | loss: 0.4540069
	speed: 0.0051s/iter; left time: 4.2777s
	iters: 300, epoch: 8 | loss: 0.4826390
	speed: 0.0051s/iter; left time: 3.7683s
	iters: 400, epoch: 8 | loss: 0.2751320
	speed: 0.0050s/iter; left time: 3.2564s
	iters: 500, epoch: 8 | loss: 1.7515546
	speed: 0.0050s/iter; left time: 2.7454s
	iters: 600, epoch: 8 | loss: 0.4026672
	speed: 0.0050s/iter; left time: 2.2304s
	iters: 700, epoch: 8 | loss: 0.4541202
	speed: 0.0050s/iter; left time: 1.7333s
	iters: 800, epoch: 8 | loss: 0.5292845
	speed: 0.0050s/iter; left time: 1.2324s
	iters: 900, epoch: 8 | loss: 0.5133194
	speed: 0.0050s/iter; left time: 0.7312s
	iters: 1000, epoch: 8 | loss: 0.4161255
	speed: 0.0050s/iter; left time: 0.2300s
Updating learning rate to 2.476132833046875e-05
Epoch: 8 cost time: 5.287539005279541
Epoch: 8, Steps: 1045 | Train Loss: 0.5709453 Vali Loss: 0.3219956 Best vali loss: 0.3201302

best validation loss 0.32013020453598473

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.00172389009, 'e_layers': 4, 'learning_rate': 6.80200191e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.1891326
	speed: 0.0102s/iter; left time: 84.6005s
	iters: 200, epoch: 1 | loss: 0.3004620
	speed: 0.0050s/iter; left time: 40.6953s
	iters: 300, epoch: 1 | loss: 0.4164272
	speed: 0.0050s/iter; left time: 40.2238s
	iters: 400, epoch: 1 | loss: 0.6822938
	speed: 0.0050s/iter; left time: 39.8083s
	iters: 500, epoch: 1 | loss: 0.1904512
	speed: 0.0050s/iter; left time: 39.0757s
	iters: 600, epoch: 1 | loss: 0.5961967
	speed: 0.0050s/iter; left time: 38.7976s
	iters: 700, epoch: 1 | loss: 0.3007430
	speed: 0.0050s/iter; left time: 38.3058s
	iters: 800, epoch: 1 | loss: 0.1521004
	speed: 0.0050s/iter; left time: 37.8088s
	iters: 900, epoch: 1 | loss: 0.3463019
	speed: 0.0050s/iter; left time: 37.2929s
	iters: 1000, epoch: 1 | loss: 0.7020067
	speed: 0.0050s/iter; left time: 36.6874s
Updating learning rate to 6.80200191e-05
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 5.480122089385986
Epoch: 1, Steps: 1045 | Train Loss: 0.3876116 Vali Loss: 0.2813735 Best vali loss: 0.2813735
	iters: 100, epoch: 2 | loss: 0.3357944
	speed: 0.0140s/iter; left time: 101.2655s
	iters: 200, epoch: 2 | loss: 0.3702322
	speed: 0.0049s/iter; left time: 35.1089s
	iters: 300, epoch: 2 | loss: 0.4713605
	speed: 0.0050s/iter; left time: 34.9447s
	iters: 400, epoch: 2 | loss: 0.7906271
	speed: 0.0049s/iter; left time: 34.1065s
	iters: 500, epoch: 2 | loss: 0.2539980
	speed: 0.0049s/iter; left time: 33.7239s
	iters: 600, epoch: 2 | loss: 0.3820893
	speed: 0.0049s/iter; left time: 32.9396s
	iters: 700, epoch: 2 | loss: 0.7694391
	speed: 0.0049s/iter; left time: 32.7259s
	iters: 800, epoch: 2 | loss: 0.7286478
	speed: 0.0049s/iter; left time: 32.2417s
	iters: 900, epoch: 2 | loss: 0.4620639
	speed: 0.0050s/iter; left time: 31.8328s
	iters: 1000, epoch: 2 | loss: 0.8925788
	speed: 0.0049s/iter; left time: 31.2018s
Updating learning rate to 3.401000955e-05
Epoch: 2 cost time: 5.199289798736572
Epoch: 2, Steps: 1045 | Train Loss: 0.5456831 Vali Loss: 0.2833697 Best vali loss: 0.2813735
	iters: 100, epoch: 3 | loss: 0.3631906
	speed: 0.0138s/iter; left time: 84.8944s
	iters: 200, epoch: 3 | loss: 0.5102172
	speed: 0.0050s/iter; left time: 30.1913s
	iters: 300, epoch: 3 | loss: 0.6299052
	speed: 0.0049s/iter; left time: 29.5534s
	iters: 400, epoch: 3 | loss: 0.4408007
	speed: 0.0050s/iter; left time: 29.0655s
	iters: 500, epoch: 3 | loss: 0.4593977
	speed: 0.0050s/iter; left time: 28.5681s
	iters: 600, epoch: 3 | loss: 0.3586167
	speed: 0.0050s/iter; left time: 28.1415s
	iters: 700, epoch: 3 | loss: 0.3536069
	speed: 0.0050s/iter; left time: 27.9586s
	iters: 800, epoch: 3 | loss: 0.1427406
	speed: 0.0050s/iter; left time: 27.3524s
	iters: 900, epoch: 3 | loss: 0.2170700
	speed: 0.0050s/iter; left time: 26.8191s
	iters: 1000, epoch: 3 | loss: 0.2504020
	speed: 0.0049s/iter; left time: 25.9082s
Updating learning rate to 1.7005004775e-05
Validation loss decreased (0.2814 --> 0.2802).  Saving model state dict ...
Epoch: 3 cost time: 5.227284908294678
Epoch: 3, Steps: 1045 | Train Loss: 0.3725948 Vali Loss: 0.2802325 Best vali loss: 0.2802325
	iters: 100, epoch: 4 | loss: 0.2749914
	speed: 0.0147s/iter; left time: 75.4962s
	iters: 200, epoch: 4 | loss: 0.2420982
	speed: 0.0053s/iter; left time: 26.5702s
	iters: 300, epoch: 4 | loss: 0.6097918
	speed: 0.0052s/iter; left time: 25.6805s
	iters: 400, epoch: 4 | loss: 0.1505443
	speed: 0.0052s/iter; left time: 25.2744s
	iters: 500, epoch: 4 | loss: 0.7170870
	speed: 0.0052s/iter; left time: 24.7720s
	iters: 600, epoch: 4 | loss: 0.4053732
	speed: 0.0052s/iter; left time: 23.9490s
	iters: 700, epoch: 4 | loss: 1.0256784
	speed: 0.0052s/iter; left time: 23.6482s
	iters: 800, epoch: 4 | loss: 0.2890413
	speed: 0.0052s/iter; left time: 23.1003s
	iters: 900, epoch: 4 | loss: 0.2985501
	speed: 0.0053s/iter; left time: 22.7580s
	iters: 1000, epoch: 4 | loss: 0.1444219
	speed: 0.0052s/iter; left time: 21.9999s
Updating learning rate to 8.5025023875e-06
Validation loss decreased (0.2802 --> 0.2753).  Saving model state dict ...
Epoch: 4 cost time: 5.505439758300781
Epoch: 4, Steps: 1045 | Train Loss: 0.4157578 Vali Loss: 0.2752716 Best vali loss: 0.2752716
	iters: 100, epoch: 5 | loss: 0.4772454
	speed: 0.0147s/iter; left time: 60.0380s
	iters: 200, epoch: 5 | loss: 0.8226447
	speed: 0.0050s/iter; left time: 19.8905s
	iters: 300, epoch: 5 | loss: 0.7849314
	speed: 0.0050s/iter; left time: 19.4187s
	iters: 400, epoch: 5 | loss: 0.3842897
	speed: 0.0050s/iter; left time: 18.9070s
	iters: 500, epoch: 5 | loss: 0.5748374
	speed: 0.0050s/iter; left time: 18.3199s
	iters: 600, epoch: 5 | loss: 0.3687410
	speed: 0.0050s/iter; left time: 17.9098s
	iters: 700, epoch: 5 | loss: 0.1194412
	speed: 0.0050s/iter; left time: 17.4630s
	iters: 800, epoch: 5 | loss: 0.3260528
	speed: 0.0050s/iter; left time: 16.8446s
	iters: 900, epoch: 5 | loss: 0.3905024
	speed: 0.0050s/iter; left time: 16.3947s
	iters: 1000, epoch: 5 | loss: 0.3823898
	speed: 0.0050s/iter; left time: 15.8609s
Updating learning rate to 4.25125119375e-06
Epoch: 5 cost time: 5.258023738861084
Epoch: 5, Steps: 1045 | Train Loss: 0.4631076 Vali Loss: 0.2821950 Best vali loss: 0.2752716
	iters: 100, epoch: 6 | loss: 0.3184156
	speed: 0.0138s/iter; left time: 41.7799s
	iters: 200, epoch: 6 | loss: 0.7480301
	speed: 0.0050s/iter; left time: 14.6787s
	iters: 300, epoch: 6 | loss: 0.2608209
	speed: 0.0050s/iter; left time: 14.1874s
	iters: 400, epoch: 6 | loss: 0.6354711
	speed: 0.0050s/iter; left time: 13.7004s
	iters: 500, epoch: 6 | loss: 0.3595416
	speed: 0.0050s/iter; left time: 13.1260s
	iters: 600, epoch: 6 | loss: 0.3099910
	speed: 0.0050s/iter; left time: 12.7073s
	iters: 700, epoch: 6 | loss: 0.1823995
	speed: 0.0050s/iter; left time: 12.1798s
	iters: 800, epoch: 6 | loss: 0.3782490
	speed: 0.0050s/iter; left time: 11.7053s
	iters: 900, epoch: 6 | loss: 0.3508714
	speed: 0.0050s/iter; left time: 11.1831s
	iters: 1000, epoch: 6 | loss: 0.4483763
	speed: 0.0050s/iter; left time: 10.6595s
Updating learning rate to 2.125625596875e-06
Epoch: 6 cost time: 5.260849237442017
Epoch: 6, Steps: 1045 | Train Loss: 0.3992166 Vali Loss: 0.2812363 Best vali loss: 0.2752716
	iters: 100, epoch: 7 | loss: 0.7921103
	speed: 0.0140s/iter; left time: 27.9201s
	iters: 200, epoch: 7 | loss: 0.3375953
	speed: 0.0053s/iter; left time: 9.9621s
	iters: 300, epoch: 7 | loss: 0.6012310
	speed: 0.0052s/iter; left time: 9.3859s
	iters: 400, epoch: 7 | loss: 0.1908514
	speed: 0.0053s/iter; left time: 8.8902s
	iters: 500, epoch: 7 | loss: 0.2485089
	speed: 0.0052s/iter; left time: 8.2930s
	iters: 600, epoch: 7 | loss: 0.1587925
	speed: 0.0052s/iter; left time: 7.7663s
	iters: 700, epoch: 7 | loss: 0.2329021
	speed: 0.0051s/iter; left time: 7.1388s
	iters: 800, epoch: 7 | loss: 0.2827117
	speed: 0.0052s/iter; left time: 6.7332s
	iters: 900, epoch: 7 | loss: 0.1793299
	speed: 0.0052s/iter; left time: 6.2224s
	iters: 1000, epoch: 7 | loss: 0.4315290
	speed: 0.0052s/iter; left time: 5.7188s
Updating learning rate to 1.0628127984375e-06
Epoch: 7 cost time: 5.499353647232056
Epoch: 7, Steps: 1045 | Train Loss: 0.3455562 Vali Loss: 0.2796565 Best vali loss: 0.2752716
	iters: 100, epoch: 8 | loss: 0.2843574
	speed: 0.0139s/iter; left time: 13.1791s
	iters: 200, epoch: 8 | loss: 0.2911219
	speed: 0.0045s/iter; left time: 3.8480s
	iters: 300, epoch: 8 | loss: 0.1541618
	speed: 0.0046s/iter; left time: 3.4048s
	iters: 400, epoch: 8 | loss: 0.2354657
	speed: 0.0045s/iter; left time: 2.9335s
	iters: 500, epoch: 8 | loss: 0.2219628
	speed: 0.0045s/iter; left time: 2.4832s
	iters: 600, epoch: 8 | loss: 0.3222026
	speed: 0.0046s/iter; left time: 2.0316s
	iters: 700, epoch: 8 | loss: 0.1547493
	speed: 0.0045s/iter; left time: 1.5679s
	iters: 800, epoch: 8 | loss: 0.5114679
	speed: 0.0046s/iter; left time: 1.1202s
	iters: 900, epoch: 8 | loss: 0.2453999
	speed: 0.0046s/iter; left time: 0.6648s
	iters: 1000, epoch: 8 | loss: 0.4427770
	speed: 0.0046s/iter; left time: 0.2095s
Updating learning rate to 5.3140639921875e-07
Epoch: 8 cost time: 4.800286054611206
Epoch: 8, Steps: 1045 | Train Loss: 0.2863666 Vali Loss: 0.2794383 Best vali loss: 0.2752716

best validation loss 0.2752715879355101

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4568450
	speed: 0.0095s/iter; left time: 9.0081s
Updating learning rate to 0.0002345270279
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.7991943359375
Epoch: 1, Steps: 131 | Train Loss: 0.4568450 Vali Loss: 0.2781984 Best vali loss: 0.2781984
	iters: 100, epoch: 2 | loss: 0.4411408
	speed: 0.0070s/iter; left time: 5.6926s
Updating learning rate to 0.00011726351395
Epoch: 2 cost time: 0.534827709197998
Epoch: 2, Steps: 131 | Train Loss: 0.4411408 Vali Loss: 0.2797798 Best vali loss: 0.2781984
	iters: 100, epoch: 3 | loss: 0.5439259
	speed: 0.0069s/iter; left time: 4.7267s
Updating learning rate to 5.8631756975e-05
Epoch: 3 cost time: 0.5369589328765869
Epoch: 3, Steps: 131 | Train Loss: 0.5439259 Vali Loss: 0.2949674 Best vali loss: 0.2781984

best validation loss 0.2781984419012965

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4568397
	speed: 0.0095s/iter; left time: 8.9723s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.7856950759887695
Epoch: 1, Steps: 131 | Train Loss: 0.4568397 Vali Loss: 0.2782099 Best vali loss: 0.2782099
	iters: 100, epoch: 2 | loss: 0.4424340
	speed: 0.0070s/iter; left time: 5.7111s
Updating learning rate to 0.0001172639389
Epoch: 2 cost time: 0.5364859104156494
Epoch: 2, Steps: 131 | Train Loss: 0.4424340 Vali Loss: 0.2794308 Best vali loss: 0.2782099
	iters: 100, epoch: 3 | loss: 0.5435737
	speed: 0.0071s/iter; left time: 4.8909s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.5639631748199463
Epoch: 3, Steps: 131 | Train Loss: 0.5435737 Vali Loss: 0.2897926 Best vali loss: 0.2782099

best validation loss 0.2782098700418132

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0082255921893, 'e_layers': 3, 'learning_rate': 0.0012373324341, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4178852
	speed: 0.0095s/iter; left time: 78.6309s
	iters: 200, epoch: 1 | loss: 0.2064227
	speed: 0.0043s/iter; left time: 34.7359s
	iters: 300, epoch: 1 | loss: 0.3504094
	speed: 0.0042s/iter; left time: 34.2144s
	iters: 400, epoch: 1 | loss: 0.4140530
	speed: 0.0043s/iter; left time: 34.1231s
	iters: 500, epoch: 1 | loss: 0.4323806
	speed: 0.0043s/iter; left time: 33.6100s
	iters: 600, epoch: 1 | loss: 0.8374165
	speed: 0.0043s/iter; left time: 33.1109s
	iters: 700, epoch: 1 | loss: 0.2442687
	speed: 0.0043s/iter; left time: 32.6759s
	iters: 800, epoch: 1 | loss: 0.2233685
	speed: 0.0043s/iter; left time: 32.3416s
	iters: 900, epoch: 1 | loss: 0.2997372
	speed: 0.0043s/iter; left time: 31.8366s
	iters: 1000, epoch: 1 | loss: 0.2154174
	speed: 0.0043s/iter; left time: 31.4030s
Updating learning rate to 0.0011902392724386802
Validation loss decreased (inf --> 0.3015).  Saving model state dict ...
Epoch: 1 cost time: 4.715146541595459
Epoch: 1, Steps: 1045 | Train Loss: 0.3641359 Vali Loss: 0.3014929 Best vali loss: 0.3014929
	iters: 100, epoch: 2 | loss: 0.4246347
	speed: 0.0123s/iter; left time: 88.8790s
	iters: 200, epoch: 2 | loss: 0.4829160
	speed: 0.0039s/iter; left time: 28.0990s
	iters: 300, epoch: 2 | loss: 0.4022851
	speed: 0.0038s/iter; left time: 26.8551s
	iters: 400, epoch: 2 | loss: 0.2682347
	speed: 0.0039s/iter; left time: 26.6852s
	iters: 500, epoch: 2 | loss: 0.4217944
	speed: 0.0038s/iter; left time: 26.2064s
	iters: 600, epoch: 2 | loss: 0.4276170
	speed: 0.0038s/iter; left time: 25.4710s
	iters: 700, epoch: 2 | loss: 1.5035710
	speed: 0.0038s/iter; left time: 25.2004s
	iters: 800, epoch: 2 | loss: 0.3858105
	speed: 0.0039s/iter; left time: 25.7231s
	iters: 900, epoch: 2 | loss: 0.2315217
	speed: 0.0039s/iter; left time: 24.7720s
	iters: 1000, epoch: 2 | loss: 0.3422750
	speed: 0.0039s/iter; left time: 24.4064s
Updating learning rate to 0.0010561292944170834
Validation loss decreased (0.3015 --> 0.3007).  Saving model state dict ...
Epoch: 2 cost time: 4.101574182510376
Epoch: 2, Steps: 1045 | Train Loss: 0.4890660 Vali Loss: 0.3007180 Best vali loss: 0.3007180
	iters: 100, epoch: 3 | loss: 0.3343767
	speed: 0.0124s/iter; left time: 76.4117s
	iters: 200, epoch: 3 | loss: 0.8718280
	speed: 0.0043s/iter; left time: 26.1262s
	iters: 300, epoch: 3 | loss: 0.4907508
	speed: 0.0043s/iter; left time: 25.7014s
	iters: 400, epoch: 3 | loss: 0.4509951
	speed: 0.0043s/iter; left time: 25.2453s
	iters: 500, epoch: 3 | loss: 1.2765177
	speed: 0.0043s/iter; left time: 24.8253s
	iters: 600, epoch: 3 | loss: 0.1397132
	speed: 0.0041s/iter; left time: 23.1895s
	iters: 700, epoch: 3 | loss: 0.4527030
	speed: 0.0040s/iter; left time: 22.2055s
	iters: 800, epoch: 3 | loss: 0.4402376
	speed: 0.0042s/iter; left time: 22.8325s
	iters: 900, epoch: 3 | loss: 0.2014054
	speed: 0.0040s/iter; left time: 21.5327s
	iters: 1000, epoch: 3 | loss: 0.1867766
	speed: 0.0040s/iter; left time: 21.0778s
Updating learning rate to 0.0008554195284790196
Validation loss decreased (0.3007 --> 0.2854).  Saving model state dict ...
Epoch: 3 cost time: 4.390640020370483
Epoch: 3, Steps: 1045 | Train Loss: 0.4845304 Vali Loss: 0.2854013 Best vali loss: 0.2854013

best validation loss 0.2854013348676406

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3892307
	speed: 0.0098s/iter; left time: 5.4547s
Updating learning rate to 2.93158784875e-05
Epoch: 4 cost time: 0.822925329208374
Epoch: 4, Steps: 131 | Train Loss: 0.3892307 Vali Loss: 0.3016944 Best vali loss: 0.2781984
	iters: 100, epoch: 5 | loss: 0.3909003
	speed: 0.0075s/iter; left time: 3.1694s
Updating learning rate to 1.465793924375e-05
Epoch: 5 cost time: 0.585559606552124
Epoch: 5, Steps: 131 | Train Loss: 0.3909003 Vali Loss: 0.2985433 Best vali loss: 0.2781984
	iters: 100, epoch: 6 | loss: 0.4693839
	speed: 0.0072s/iter; left time: 2.1182s
Updating learning rate to 7.328969621875e-06
Epoch: 6 cost time: 0.5823004245758057
Epoch: 6, Steps: 131 | Train Loss: 0.4693839 Vali Loss: 0.3023863 Best vali loss: 0.2781984
	iters: 100, epoch: 7 | loss: 0.4000013
	speed: 0.0074s/iter; left time: 1.2021s
Updating learning rate to 3.6644848109375e-06
Epoch: 7 cost time: 0.5840930938720703
Epoch: 7, Steps: 131 | Train Loss: 0.4000013 Vali Loss: 0.2985196 Best vali loss: 0.2781984
	iters: 100, epoch: 8 | loss: 0.3238034
	speed: 0.0072s/iter; left time: 0.2303s
Updating learning rate to 1.83224240546875e-06
Epoch: 8 cost time: 0.5679473876953125
Epoch: 8, Steps: 131 | Train Loss: 0.3238034 Vali Loss: 0.3000601 Best vali loss: 0.2781984

best validation loss 0.2781984419012965

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010265229638, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596895
	speed: 0.0106s/iter; left time: 10.0203s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9286727905273438
Epoch: 1, Steps: 131 | Train Loss: 0.5596895 Vali Loss: 0.2756502 Best vali loss: 0.2756502
	iters: 100, epoch: 2 | loss: 0.3251008
	speed: 0.0088s/iter; left time: 7.2385s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2708).  Saving model state dict ...
Epoch: 2 cost time: 0.7013578414916992
Epoch: 2, Steps: 131 | Train Loss: 0.3251008 Vali Loss: 0.2708493 Best vali loss: 0.2708493
	iters: 100, epoch: 3 | loss: 0.4619477
	speed: 0.0090s/iter; left time: 6.1861s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7065999507904053
Epoch: 3, Steps: 131 | Train Loss: 0.4619477 Vali Loss: 0.2795440 Best vali loss: 0.2708493
	iters: 100, epoch: 4 | loss: 0.5046189
	speed: 0.0086s/iter; left time: 4.7984s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.695213794708252
Epoch: 4, Steps: 131 | Train Loss: 0.5046189 Vali Loss: 0.2938128 Best vali loss: 0.2708493
	iters: 100, epoch: 5 | loss: 0.3323258
	speed: 0.0085s/iter; left time: 3.6197s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6918389797210693
Epoch: 5, Steps: 131 | Train Loss: 0.3323258 Vali Loss: 0.2905309 Best vali loss: 0.2708493
	iters: 100, epoch: 6 | loss: 0.3206990
	speed: 0.0086s/iter; left time: 2.5360s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.7058200836181641
Epoch: 6, Steps: 131 | Train Loss: 0.3206990 Vali Loss: 0.2911455 Best vali loss: 0.2708493
	iters: 100, epoch: 7 | loss: 0.3121229
	speed: 0.0087s/iter; left time: 1.4116s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6986768245697021
Epoch: 7, Steps: 131 | Train Loss: 0.3121229 Vali Loss: 0.3006236 Best vali loss: 0.2708493
	iters: 100, epoch: 8 | loss: 0.3985133
	speed: 0.0086s/iter; left time: 0.2759s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6961367130279541
Epoch: 8, Steps: 131 | Train Loss: 0.3985133 Vali Loss: 0.2980562 Best vali loss: 0.2708493

best validation loss 0.27084931120547984

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0059837215728, 'e_layers': 2, 'learning_rate': 9.14856557e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.800369025980227e-05
Validation loss decreased (inf --> 0.2935).  Saving model state dict ...
Epoch: 1 cost time: 0.5361604690551758
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2935072 Best vali loss: 0.2935072
Updating learning rate to 7.808789161338386e-05
Validation loss decreased (0.2935 --> 0.2823).  Saving model state dict ...
Epoch: 2 cost time: 0.33617615699768066
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2822945 Best vali loss: 0.2822945
Updating learning rate to 6.324785021772343e-05
Validation loss decreased (0.2823 --> 0.2794).  Saving model state dict ...
Epoch: 3 cost time: 0.32151222229003906
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2794284 Best vali loss: 0.2794284
Updating learning rate to 4.574282785e-05
Epoch: 4 cost time: 0.3287780284881592
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2794790 Best vali loss: 0.2794284
Updating learning rate to 2.8237805482276582e-05
Validation loss decreased (0.2794 --> 0.2788).  Saving model state dict ...
Epoch: 5 cost time: 0.32514309883117676
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2787543 Best vali loss: 0.2787543
Updating learning rate to 1.3397764086616141e-05
Validation loss decreased (0.2788 --> 0.2786).  Saving model state dict ...
Epoch: 6 cost time: 0.31682658195495605
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2785946 Best vali loss: 0.2785946
Updating learning rate to 3.4819654401977325e-06
Epoch: 7 cost time: 0.3206326961517334
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2787428 Best vali loss: 0.2785946
Updating learning rate to 0.0
Epoch: 8 cost time: 0.32511329650878906
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2786982 Best vali loss: 0.2785946

best validation loss 0.27859461493720883

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269910981, 'e_layers': 2, 'learning_rate': 0.0002344914096, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4568688
	speed: 0.0095s/iter; left time: 9.0498s
Updating learning rate to 0.0002344914096
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.8063340187072754
Epoch: 1, Steps: 131 | Train Loss: 0.4568688 Vali Loss: 0.2782091 Best vali loss: 0.2782091
	iters: 100, epoch: 2 | loss: 0.4419777
	speed: 0.0072s/iter; left time: 5.9048s
Updating learning rate to 0.0001172457048
Epoch: 2 cost time: 0.5539276599884033
Epoch: 2, Steps: 131 | Train Loss: 0.4419777 Vali Loss: 0.2843263 Best vali loss: 0.2782091
	iters: 100, epoch: 3 | loss: 0.5433109
	speed: 0.0073s/iter; left time: 5.0266s
Updating learning rate to 5.86228524e-05
Epoch: 3 cost time: 0.5883986949920654
Epoch: 3, Steps: 131 | Train Loss: 0.5433109 Vali Loss: 0.2920565 Best vali loss: 0.2782091

best validation loss 0.2782091497571418

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0021166536294, 'e_layers': 1, 'learning_rate': 0.0020190772704, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6340231
	speed: 0.0078s/iter; left time: 32.0546s
	iters: 200, epoch: 1 | loss: 0.6811383
	speed: 0.0025s/iter; left time: 9.9580s
	iters: 300, epoch: 1 | loss: 0.2531899
	speed: 0.0024s/iter; left time: 9.4962s
	iters: 400, epoch: 1 | loss: 0.4206424
	speed: 0.0024s/iter; left time: 9.1813s
	iters: 500, epoch: 1 | loss: 0.5065807
	speed: 0.0024s/iter; left time: 8.8592s
Updating learning rate to 0.0019422307175406583
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.5540800094604492
Epoch: 1, Steps: 523 | Train Loss: 0.4991149 Vali Loss: 0.2856537 Best vali loss: 0.2856537
	iters: 100, epoch: 2 | loss: 0.4861488
	speed: 0.0057s/iter; left time: 20.3405s
	iters: 200, epoch: 2 | loss: 0.3320123
	speed: 0.0022s/iter; left time: 7.7053s
	iters: 300, epoch: 2 | loss: 0.2809336
	speed: 0.0023s/iter; left time: 7.6526s
	iters: 400, epoch: 2 | loss: 0.8222147
	speed: 0.0022s/iter; left time: 7.2875s
	iters: 500, epoch: 2 | loss: 0.3037449
	speed: 0.0022s/iter; left time: 7.0592s
Updating learning rate to 0.0017233902500197321
Epoch: 2 cost time: 1.2108490467071533
Epoch: 2, Steps: 523 | Train Loss: 0.4450108 Vali Loss: 0.2936426 Best vali loss: 0.2856537
	iters: 100, epoch: 3 | loss: 0.2981052
	speed: 0.0056s/iter; left time: 16.9689s
	iters: 200, epoch: 3 | loss: 0.4493721
	speed: 0.0022s/iter; left time: 6.5860s
	iters: 300, epoch: 3 | loss: 0.9244694
	speed: 0.0022s/iter; left time: 6.3746s
	iters: 400, epoch: 3 | loss: 0.7845871
	speed: 0.0023s/iter; left time: 6.2007s
	iters: 500, epoch: 3 | loss: 0.7495546
	speed: 0.0023s/iter; left time: 5.9857s
Updating learning rate to 0.0013958723452235043
Epoch: 3 cost time: 1.2181556224822998
Epoch: 3, Steps: 523 | Train Loss: 0.6412177 Vali Loss: 0.2990999 Best vali loss: 0.2856537

best validation loss 0.28565373122359616

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345345781, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597187
	speed: 0.0105s/iter; left time: 9.9660s
Updating learning rate to 0.00022560813723637995
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9496860504150391
Epoch: 1, Steps: 131 | Train Loss: 0.5597187 Vali Loss: 0.2756370 Best vali loss: 0.2756370
	iters: 100, epoch: 2 | loss: 0.3243628
	speed: 0.0088s/iter; left time: 7.2183s
Updating learning rate to 0.00020018778434861796
Validation loss decreased (0.2756 --> 0.2694).  Saving model state dict ...
Epoch: 2 cost time: 0.6948423385620117
Epoch: 2, Steps: 131 | Train Loss: 0.3243628 Vali Loss: 0.2693949 Best vali loss: 0.2693949
	iters: 100, epoch: 3 | loss: 0.4611989
	speed: 0.0091s/iter; left time: 6.2597s
Updating learning rate to 0.0001621435377278031
Epoch: 3 cost time: 0.7092504501342773
Epoch: 3, Steps: 131 | Train Loss: 0.4611989 Vali Loss: 0.2854047 Best vali loss: 0.2693949

best validation loss 0.2693949407385645

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345345781, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4194126
	speed: 0.0108s/iter; left time: 5.9782s
Updating learning rate to 0.00011726728905
Epoch: 4 cost time: 0.9331207275390625
Epoch: 4, Steps: 131 | Train Loss: 0.4194126 Vali Loss: 0.2876117 Best vali loss: 0.2693949
	iters: 100, epoch: 5 | loss: 0.2685261
	speed: 0.0088s/iter; left time: 3.7368s
Updating learning rate to 7.23910403721969e-05
Epoch: 5 cost time: 0.6973779201507568
Epoch: 5, Steps: 131 | Train Loss: 0.2685261 Vali Loss: 0.2884054 Best vali loss: 0.2693949
	iters: 100, epoch: 6 | loss: 0.3839689
	speed: 0.0085s/iter; left time: 2.5023s
Updating learning rate to 3.434679375138204e-05
Epoch: 6 cost time: 0.6937425136566162
Epoch: 6, Steps: 131 | Train Loss: 0.3839689 Vali Loss: 0.2993398 Best vali loss: 0.2693949
	iters: 100, epoch: 7 | loss: 0.3925456
	speed: 0.0085s/iter; left time: 1.3907s
Updating learning rate to 8.926440863620066e-06
Epoch: 7 cost time: 0.6889886856079102
Epoch: 7, Steps: 131 | Train Loss: 0.3925456 Vali Loss: 0.3011820 Best vali loss: 0.2693949
	iters: 100, epoch: 8 | loss: 0.2945228
	speed: 0.0085s/iter; left time: 0.2713s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6898965835571289
Epoch: 8, Steps: 131 | Train Loss: 0.2945228 Vali Loss: 0.3036359 Best vali loss: 0.2693949

best validation loss 0.2693949407385645

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597177
	speed: 0.0105s/iter; left time: 9.9256s
Updating learning rate to 0.00022560791579784574
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9304606914520264
Epoch: 1, Steps: 131 | Train Loss: 0.5597177 Vali Loss: 0.2756320 Best vali loss: 0.2756320
	iters: 100, epoch: 2 | loss: 0.3243264
	speed: 0.0089s/iter; left time: 7.2436s
Updating learning rate to 0.00020018758786062745
Validation loss decreased (0.2756 --> 0.2696).  Saving model state dict ...
Epoch: 2 cost time: 0.7033803462982178
Epoch: 2, Steps: 131 | Train Loss: 0.3243264 Vali Loss: 0.2695553 Best vali loss: 0.2695553
	iters: 100, epoch: 3 | loss: 0.4656848
	speed: 0.0089s/iter; left time: 6.1476s
Updating learning rate to 0.00016214337858094004
Epoch: 3 cost time: 0.7017488479614258
Epoch: 3, Steps: 131 | Train Loss: 0.4656848 Vali Loss: 0.2820250 Best vali loss: 0.2695553
	iters: 100, epoch: 4 | loss: 0.4726299
	speed: 0.0086s/iter; left time: 4.7993s
Updating learning rate to 0.00011726717395
Epoch: 4 cost time: 0.7066526412963867
Epoch: 4, Steps: 131 | Train Loss: 0.4726299 Vali Loss: 0.2740350 Best vali loss: 0.2695553
	iters: 100, epoch: 5 | loss: 0.3342592
	speed: 0.0087s/iter; left time: 3.6908s
Updating learning rate to 7.239096931905996e-05
Epoch: 5 cost time: 0.7020535469055176
Epoch: 5, Steps: 131 | Train Loss: 0.3342592 Vali Loss: 0.2881088 Best vali loss: 0.2695553
	iters: 100, epoch: 6 | loss: 0.3039674
	speed: 0.0086s/iter; left time: 2.5267s
Updating learning rate to 3.434676003937255e-05
Epoch: 6 cost time: 0.6984755992889404
Epoch: 6, Steps: 131 | Train Loss: 0.3039674 Vali Loss: 0.2961760 Best vali loss: 0.2695553
	iters: 100, epoch: 7 | loss: 0.2873196
	speed: 0.0087s/iter; left time: 1.4116s
Updating learning rate to 8.926432102154258e-06
Epoch: 7 cost time: 0.7038192749023438
Epoch: 7, Steps: 131 | Train Loss: 0.2873196 Vali Loss: 0.3009507 Best vali loss: 0.2695553
	iters: 100, epoch: 8 | loss: 0.3450612
	speed: 0.0088s/iter; left time: 0.2802s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7070496082305908
Epoch: 8, Steps: 131 | Train Loss: 0.3450612 Vali Loss: 0.3011935 Best vali loss: 0.2695553

best validation loss 0.269555311723463

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271651985, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597015
	speed: 0.0106s/iter; left time: 10.0647s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9377224445343018
Epoch: 1, Steps: 131 | Train Loss: 0.5597015 Vali Loss: 0.2756336 Best vali loss: 0.2756336
	iters: 100, epoch: 2 | loss: 0.3247772
	speed: 0.0090s/iter; left time: 7.3367s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2718).  Saving model state dict ...
Epoch: 2 cost time: 0.7050075531005859
Epoch: 2, Steps: 131 | Train Loss: 0.3247772 Vali Loss: 0.2718295 Best vali loss: 0.2718295
	iters: 100, epoch: 3 | loss: 0.4651505
	speed: 0.0091s/iter; left time: 6.2664s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7028379440307617
Epoch: 3, Steps: 131 | Train Loss: 0.4651505 Vali Loss: 0.2774057 Best vali loss: 0.2718295
	iters: 100, epoch: 4 | loss: 0.4903965
	speed: 0.0086s/iter; left time: 4.7820s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.6926436424255371
Epoch: 4, Steps: 131 | Train Loss: 0.4903965 Vali Loss: 0.2804234 Best vali loss: 0.2718295
	iters: 100, epoch: 5 | loss: 0.3356081
	speed: 0.0085s/iter; left time: 3.6101s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.6907439231872559
Epoch: 5, Steps: 131 | Train Loss: 0.3356081 Vali Loss: 0.2884223 Best vali loss: 0.2718295
	iters: 100, epoch: 6 | loss: 0.3018737
	speed: 0.0085s/iter; left time: 2.5014s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.6926572322845459
Epoch: 6, Steps: 131 | Train Loss: 0.3018737 Vali Loss: 0.3022231 Best vali loss: 0.2718295
	iters: 100, epoch: 7 | loss: 0.2863420
	speed: 0.0086s/iter; left time: 1.3975s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.7002918720245361
Epoch: 7, Steps: 131 | Train Loss: 0.2863420 Vali Loss: 0.2971564 Best vali loss: 0.2718295
	iters: 100, epoch: 8 | loss: 0.3391972
	speed: 0.0087s/iter; left time: 0.2779s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7015242576599121
Epoch: 8, Steps: 131 | Train Loss: 0.3391972 Vali Loss: 0.2991912 Best vali loss: 0.2718295

best validation loss 0.2718295250607494

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 7.01359786e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5560392
	speed: 0.0103s/iter; left time: 9.7453s
Updating learning rate to 7.01359786e-05
Validation loss decreased (inf --> 0.2767).  Saving model state dict ...
Epoch: 1 cost time: 0.9254662990570068
Epoch: 1, Steps: 131 | Train Loss: 0.5560392 Vali Loss: 0.2766997 Best vali loss: 0.2766997
	iters: 100, epoch: 2 | loss: 0.3292570
	speed: 0.0088s/iter; left time: 7.1979s
Updating learning rate to 3.50679893e-05
Epoch: 2 cost time: 0.6977493762969971
Epoch: 2, Steps: 131 | Train Loss: 0.3292570 Vali Loss: 0.2771724 Best vali loss: 0.2766997
	iters: 100, epoch: 3 | loss: 0.4882289
	speed: 0.0086s/iter; left time: 5.9011s
Updating learning rate to 1.753399465e-05
Validation loss decreased (0.2767 --> 0.2745).  Saving model state dict ...
Epoch: 3 cost time: 0.6983797550201416
Epoch: 3, Steps: 131 | Train Loss: 0.4882289 Vali Loss: 0.2744971 Best vali loss: 0.2744971

best validation loss 0.27449708930973493

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 0.739830493927002
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791811 Best vali loss: 0.2791811
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2792 --> 0.2745).  Saving model state dict ...
Epoch: 2 cost time: 0.5190863609313965
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2745109 Best vali loss: 0.2745109
Updating learning rate to 5.863196945e-05
Validation loss decreased (0.2745 --> 0.2734).  Saving model state dict ...
Epoch: 3 cost time: 0.5213847160339355
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2734457 Best vali loss: 0.2734457

best validation loss 0.2734456891384476

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 0.7362730503082275
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791811 Best vali loss: 0.2791811
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2792 --> 0.2744).  Saving model state dict ...
Epoch: 2 cost time: 0.514869213104248
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2744076 Best vali loss: 0.2744076
Updating learning rate to 5.86317403e-05
Validation loss decreased (0.2744 --> 0.2735).  Saving model state dict ...
Epoch: 3 cost time: 0.5172367095947266
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2735239 Best vali loss: 0.2735239

best validation loss 0.27352389710438924

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.9315984725e-05
Epoch: 4 cost time: 0.7375562191009521
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2845457 Best vali loss: 0.2734457
Updating learning rate to 1.46579923625e-05
Epoch: 5 cost time: 0.5188698768615723
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2859022 Best vali loss: 0.2734457
Updating learning rate to 7.32899618125e-06
Epoch: 6 cost time: 0.5105457305908203
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2889188 Best vali loss: 0.2734457
Updating learning rate to 3.664498090625e-06
Epoch: 7 cost time: 0.5117924213409424
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2914849 Best vali loss: 0.2734457
Updating learning rate to 1.8322490453125e-06
Epoch: 8 cost time: 0.5106298923492432
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2920756 Best vali loss: 0.2734457

best validation loss 0.2734456891384476

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0021322655656, 'e_layers': 3, 'learning_rate': 0.0022566171063, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0021707297317627083
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 0.6090250015258789
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2833116 Best vali loss: 0.2833116
Updating learning rate to 0.0019261431823531469
Epoch: 2 cost time: 0.3703460693359375
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2886936 Best vali loss: 0.2833116
Updating learning rate to 0.0015600935430363303
Epoch: 3 cost time: 0.3864164352416992
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2871568 Best vali loss: 0.2833116
Updating learning rate to 0.00112830855315
Epoch: 4 cost time: 0.37573742866516113
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2860567 Best vali loss: 0.2833116
Updating learning rate to 0.0006965235632636696
Epoch: 5 cost time: 0.3977484703063965
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2900251 Best vali loss: 0.2833116
Updating learning rate to 0.00033047392394685296
Epoch: 6 cost time: 0.3768351078033447
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2934013 Best vali loss: 0.2833116
Updating learning rate to 8.588737453729167e-05
Epoch: 7 cost time: 0.40180158615112305
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2862928 Best vali loss: 0.2833116
Updating learning rate to 0.0
Epoch: 8 cost time: 0.388016939163208
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2886432 Best vali loss: 0.2833116

best validation loss 0.2833115592759619

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0021280876436, 'e_layers': 3, 'learning_rate': 0.0020393273654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0020393273654
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 0.6403629779815674
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2832744 Best vali loss: 0.2832744
Updating learning rate to 0.0010196636827
Epoch: 2 cost time: 0.36782288551330566
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2859839 Best vali loss: 0.2832744
Updating learning rate to 0.00050983184135
Epoch: 3 cost time: 0.3691883087158203
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905165 Best vali loss: 0.2832744
Updating learning rate to 0.000254915920675
Epoch: 4 cost time: 0.3516664505004883
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2870416 Best vali loss: 0.2832744
Updating learning rate to 0.0001274579603375
Epoch: 5 cost time: 0.3524138927459717
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2934454 Best vali loss: 0.2832744
Updating learning rate to 6.372898016875e-05
Epoch: 6 cost time: 0.35646772384643555
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2924382 Best vali loss: 0.2832744
Updating learning rate to 3.1864490084375e-05
Epoch: 7 cost time: 0.3486640453338623
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2891199 Best vali loss: 0.2832744
Updating learning rate to 1.59322450421875e-05
Epoch: 8 cost time: 0.3682527542114258
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2892920 Best vali loss: 0.2832744

best validation loss 0.28327444446778466

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0060154448451, 'e_layers': 2, 'learning_rate': 5.59367076e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4141288
	speed: 0.0088s/iter; left time: 35.8613s
	iters: 200, epoch: 1 | loss: 0.3595824
	speed: 0.0033s/iter; left time: 13.1841s
	iters: 300, epoch: 1 | loss: 0.2343910
	speed: 0.0033s/iter; left time: 12.6430s
	iters: 400, epoch: 1 | loss: 1.1655024
	speed: 0.0034s/iter; left time: 12.7868s
	iters: 500, epoch: 1 | loss: 0.2738233
	speed: 0.0033s/iter; left time: 12.2889s
Updating learning rate to 5.59367076e-05
Validation loss decreased (inf --> 0.2894).  Saving model state dict ...
Epoch: 1 cost time: 2.0027050971984863
Epoch: 1, Steps: 523 | Train Loss: 0.4894856 Vali Loss: 0.2894435 Best vali loss: 0.2894435
	iters: 100, epoch: 2 | loss: 0.7302707
	speed: 0.0070s/iter; left time: 24.8623s
	iters: 200, epoch: 2 | loss: 0.3176287
	speed: 0.0032s/iter; left time: 11.2406s
	iters: 300, epoch: 2 | loss: 0.5169585
	speed: 0.0032s/iter; left time: 10.7953s
	iters: 400, epoch: 2 | loss: 1.0734477
	speed: 0.0034s/iter; left time: 10.9689s
	iters: 500, epoch: 2 | loss: 0.2441198
	speed: 0.0031s/iter; left time: 9.7906s
Updating learning rate to 2.79683538e-05
Validation loss decreased (0.2894 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 1.7134006023406982
Epoch: 2, Steps: 523 | Train Loss: 0.5764851 Vali Loss: 0.2819432 Best vali loss: 0.2819432
	iters: 100, epoch: 3 | loss: 0.5611846
	speed: 0.0069s/iter; left time: 20.9873s
	iters: 200, epoch: 3 | loss: 0.5236566
	speed: 0.0029s/iter; left time: 8.5208s
	iters: 300, epoch: 3 | loss: 0.5162225
	speed: 0.0029s/iter; left time: 8.2847s
	iters: 400, epoch: 3 | loss: 0.6882570
	speed: 0.0030s/iter; left time: 8.2216s
	iters: 500, epoch: 3 | loss: 0.3439135
	speed: 0.0031s/iter; left time: 8.1453s
Updating learning rate to 1.39841769e-05
Validation loss decreased (0.2819 --> 0.2796).  Saving model state dict ...
Epoch: 3 cost time: 1.611520767211914
Epoch: 3, Steps: 523 | Train Loss: 0.5266468 Vali Loss: 0.2795924 Best vali loss: 0.2795924

best validation loss 0.27959241910067667

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017045868408, 'e_layers': 3, 'learning_rate': 0.0003147321933, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3238252
	speed: 0.0099s/iter; left time: 40.2891s
	iters: 200, epoch: 1 | loss: 0.8695107
	speed: 0.0043s/iter; left time: 17.1428s
	iters: 300, epoch: 1 | loss: 0.7074540
	speed: 0.0043s/iter; left time: 16.7618s
	iters: 400, epoch: 1 | loss: 0.3280159
	speed: 0.0043s/iter; left time: 16.2159s
	iters: 500, epoch: 1 | loss: 0.2677417
	speed: 0.0043s/iter; left time: 15.6799s
Updating learning rate to 0.0003147321933
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 2.518566608428955
Epoch: 1, Steps: 523 | Train Loss: 0.4993095 Vali Loss: 0.2851644 Best vali loss: 0.2851644
	iters: 100, epoch: 2 | loss: 0.7240296
	speed: 0.0092s/iter; left time: 32.8939s
	iters: 200, epoch: 2 | loss: 0.3460587
	speed: 0.0041s/iter; left time: 14.0250s
	iters: 300, epoch: 2 | loss: 0.2997660
	speed: 0.0040s/iter; left time: 13.5698s
	iters: 400, epoch: 2 | loss: 0.3634235
	speed: 0.0041s/iter; left time: 13.2211s
	iters: 500, epoch: 2 | loss: 0.1649765
	speed: 0.0040s/iter; left time: 12.7930s
Updating learning rate to 0.00015736609665
Epoch: 2 cost time: 2.154801845550537
Epoch: 2, Steps: 523 | Train Loss: 0.3796509 Vali Loss: 0.2969104 Best vali loss: 0.2851644
	iters: 100, epoch: 3 | loss: 0.7021579
	speed: 0.0092s/iter; left time: 28.0522s
	iters: 200, epoch: 3 | loss: 0.6944479
	speed: 0.0045s/iter; left time: 13.1399s
	iters: 300, epoch: 3 | loss: 0.9305409
	speed: 0.0045s/iter; left time: 12.7485s
	iters: 400, epoch: 3 | loss: 0.9252585
	speed: 0.0045s/iter; left time: 12.2725s
	iters: 500, epoch: 3 | loss: 0.8296385
	speed: 0.0045s/iter; left time: 11.8486s
Updating learning rate to 7.8683048325e-05
Validation loss decreased (0.2852 --> 0.2735).  Saving model state dict ...
Epoch: 3 cost time: 2.377671957015991
Epoch: 3, Steps: 523 | Train Loss: 0.8164087 Vali Loss: 0.2735270 Best vali loss: 0.2735270

best validation loss 0.273527034062043

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0078312971673, 'e_layers': 3, 'learning_rate': 0.0008289467984, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5483305
	speed: 0.0102s/iter; left time: 9.6684s
Updating learning rate to 0.0007973968894912599
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 0.9033193588256836
Epoch: 1, Steps: 131 | Train Loss: 0.5483305 Vali Loss: 0.2844045 Best vali loss: 0.2844045
	iters: 100, epoch: 2 | loss: 0.5599138
	speed: 0.0081s/iter; left time: 6.6532s
Updating learning rate to 0.0007075503503957589
Epoch: 2 cost time: 0.653695821762085
Epoch: 2, Steps: 131 | Train Loss: 0.5599138 Vali Loss: 0.2949635 Best vali loss: 0.2844045
	iters: 100, epoch: 3 | loss: 0.4224283
	speed: 0.0080s/iter; left time: 5.5229s
Updating learning rate to 0.000573085502229882
Epoch: 3 cost time: 0.6780452728271484
Epoch: 3, Steps: 131 | Train Loss: 0.4224283 Vali Loss: 0.2922288 Best vali loss: 0.2844045

best validation loss 0.28440446390809515

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017045868408, 'e_layers': 3, 'learning_rate': 0.0003147321933, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3242450
	speed: 0.0103s/iter; left time: 25.9738s
	iters: 200, epoch: 4 | loss: 0.6067252
	speed: 0.0046s/iter; left time: 11.0546s
	iters: 300, epoch: 4 | loss: 0.5046087
	speed: 0.0046s/iter; left time: 10.7184s
	iters: 400, epoch: 4 | loss: 0.2809387
	speed: 0.0045s/iter; left time: 10.0537s
	iters: 500, epoch: 4 | loss: 0.2362770
	speed: 0.0046s/iter; left time: 9.7187s
Updating learning rate to 3.93415241625e-05
Epoch: 4 cost time: 2.665982484817505
Epoch: 4, Steps: 523 | Train Loss: 0.3905589 Vali Loss: 0.2798728 Best vali loss: 0.2735270
	iters: 100, epoch: 5 | loss: 0.6464455
	speed: 0.0096s/iter; left time: 19.1289s
	iters: 200, epoch: 5 | loss: 0.2795520
	speed: 0.0046s/iter; left time: 8.6405s
	iters: 300, epoch: 5 | loss: 0.2358914
	speed: 0.0046s/iter; left time: 8.1603s
	iters: 400, epoch: 5 | loss: 0.2960233
	speed: 0.0047s/iter; left time: 7.9493s
	iters: 500, epoch: 5 | loss: 0.1498529
	speed: 0.0047s/iter; left time: 7.4212s
Updating learning rate to 1.967076208125e-05
Epoch: 5 cost time: 2.4417271614074707
Epoch: 5, Steps: 523 | Train Loss: 0.3215530 Vali Loss: 0.2985650 Best vali loss: 0.2735270
	iters: 100, epoch: 6 | loss: 0.4288452
	speed: 0.0095s/iter; left time: 14.0007s
	iters: 200, epoch: 6 | loss: 0.3588585
	speed: 0.0046s/iter; left time: 6.2356s
	iters: 300, epoch: 6 | loss: 0.5744957
	speed: 0.0045s/iter; left time: 5.7175s
	iters: 400, epoch: 6 | loss: 0.5468759
	speed: 0.0045s/iter; left time: 5.3009s
	iters: 500, epoch: 6 | loss: 0.6354072
	speed: 0.0046s/iter; left time: 4.9150s
Updating learning rate to 9.835381040625e-06
Epoch: 6 cost time: 2.417142868041992
Epoch: 6, Steps: 523 | Train Loss: 0.5088965 Vali Loss: 0.2954152 Best vali loss: 0.2735270
	iters: 100, epoch: 7 | loss: 0.5025513
	speed: 0.0094s/iter; left time: 8.9479s
	iters: 200, epoch: 7 | loss: 0.2771193
	speed: 0.0044s/iter; left time: 3.7637s
	iters: 300, epoch: 7 | loss: 0.2541228
	speed: 0.0044s/iter; left time: 3.3072s
	iters: 400, epoch: 7 | loss: 0.4355282
	speed: 0.0046s/iter; left time: 2.9526s
	iters: 500, epoch: 7 | loss: 0.2361890
	speed: 0.0045s/iter; left time: 2.4840s
Updating learning rate to 4.9176905203125e-06
Epoch: 7 cost time: 2.3876960277557373
Epoch: 7, Steps: 523 | Train Loss: 0.3411021 Vali Loss: 0.2933071 Best vali loss: 0.2735270
	iters: 100, epoch: 8 | loss: 0.3127539
	speed: 0.0099s/iter; left time: 4.1841s
	iters: 200, epoch: 8 | loss: 0.3322516
	speed: 0.0045s/iter; left time: 1.4690s
	iters: 300, epoch: 8 | loss: 0.2410984
	speed: 0.0046s/iter; left time: 1.0193s
	iters: 400, epoch: 8 | loss: 0.4994612
	speed: 0.0045s/iter; left time: 0.5610s
	iters: 500, epoch: 8 | loss: 0.2954474
	speed: 0.0046s/iter; left time: 0.1097s
Updating learning rate to 2.45884526015625e-06
Epoch: 8 cost time: 2.4194846153259277
Epoch: 8, Steps: 523 | Train Loss: 0.3362025 Vali Loss: 0.2960509 Best vali loss: 0.2735270

best validation loss 0.273527034062043

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0008649392597, 'e_layers': 2, 'learning_rate': 0.0031949008732, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7675989
	speed: 0.0092s/iter; left time: 8.7125s
Updating learning rate to 0.0031949008732
Validation loss decreased (inf --> 0.2976).  Saving model state dict ...
Epoch: 1 cost time: 0.7675156593322754
Epoch: 1, Steps: 131 | Train Loss: 0.7675989 Vali Loss: 0.2976148 Best vali loss: 0.2976148
	iters: 100, epoch: 2 | loss: 0.3054770
	speed: 0.0069s/iter; left time: 5.6134s
Updating learning rate to 0.0015974504366
Validation loss decreased (0.2976 --> 0.2882).  Saving model state dict ...
Epoch: 2 cost time: 0.5432188510894775
Epoch: 2, Steps: 131 | Train Loss: 0.3054770 Vali Loss: 0.2881887 Best vali loss: 0.2881887
	iters: 100, epoch: 3 | loss: 0.5253372
	speed: 0.0068s/iter; left time: 4.6555s
Updating learning rate to 0.0007987252183
Epoch: 3 cost time: 0.5381171703338623
Epoch: 3, Steps: 131 | Train Loss: 0.5253372 Vali Loss: 0.2938366 Best vali loss: 0.2881887
	iters: 100, epoch: 4 | loss: 0.7416556
	speed: 0.0067s/iter; left time: 3.7204s
Updating learning rate to 0.00039936260915
Epoch: 4 cost time: 0.5464537143707275
Epoch: 4, Steps: 131 | Train Loss: 0.7416556 Vali Loss: 0.3016976 Best vali loss: 0.2881887
	iters: 100, epoch: 5 | loss: 0.4364856
	speed: 0.0066s/iter; left time: 2.7847s
Updating learning rate to 0.000199681304575
Epoch: 5 cost time: 0.5251648426055908
Epoch: 5, Steps: 131 | Train Loss: 0.4364856 Vali Loss: 0.3037526 Best vali loss: 0.2881887
	iters: 100, epoch: 6 | loss: 0.3727317
	speed: 0.0068s/iter; left time: 2.0102s
Updating learning rate to 9.98406522875e-05
Epoch: 6 cost time: 0.5572066307067871
Epoch: 6, Steps: 131 | Train Loss: 0.3727317 Vali Loss: 0.3047884 Best vali loss: 0.2881887
	iters: 100, epoch: 7 | loss: 0.4137566
	speed: 0.0069s/iter; left time: 1.1172s
Updating learning rate to 4.992032614375e-05
Epoch: 7 cost time: 0.5419535636901855
Epoch: 7, Steps: 131 | Train Loss: 0.4137566 Vali Loss: 0.3121546 Best vali loss: 0.2881887
	iters: 100, epoch: 8 | loss: 0.4427109
	speed: 0.0068s/iter; left time: 0.2173s
Updating learning rate to 2.4960163071875e-05
Epoch: 8 cost time: 0.5328154563903809
Epoch: 8, Steps: 131 | Train Loss: 0.4427109 Vali Loss: 0.3099804 Best vali loss: 0.2881887

best validation loss 0.28818869498492883

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269065849, 'e_layers': 2, 'learning_rate': 0.0002343299316, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596883
	speed: 0.0105s/iter; left time: 9.9733s
Updating learning rate to 0.0002343299316
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9276082515716553
Epoch: 1, Steps: 131 | Train Loss: 0.5596883 Vali Loss: 0.2756491 Best vali loss: 0.2756491
	iters: 100, epoch: 2 | loss: 0.3251604
	speed: 0.0088s/iter; left time: 7.2282s
Updating learning rate to 0.0001171649658
Validation loss decreased (0.2756 --> 0.2695).  Saving model state dict ...
Epoch: 2 cost time: 0.7039539813995361
Epoch: 2, Steps: 131 | Train Loss: 0.3251604 Vali Loss: 0.2694595 Best vali loss: 0.2694595
	iters: 100, epoch: 3 | loss: 0.4599957
	speed: 0.0092s/iter; left time: 6.3070s
Updating learning rate to 5.85824829e-05
Epoch: 3 cost time: 0.7079381942749023
Epoch: 3, Steps: 131 | Train Loss: 0.4599957 Vali Loss: 0.2803836 Best vali loss: 0.2694595
	iters: 100, epoch: 4 | loss: 0.5022552
	speed: 0.0087s/iter; left time: 4.8539s
Updating learning rate to 2.929124145e-05
Epoch: 4 cost time: 0.700432300567627
Epoch: 4, Steps: 131 | Train Loss: 0.5022552 Vali Loss: 0.2874384 Best vali loss: 0.2694595
	iters: 100, epoch: 5 | loss: 0.3341188
	speed: 0.0087s/iter; left time: 3.6920s
Updating learning rate to 1.4645620725e-05
Epoch: 5 cost time: 0.7009828090667725
Epoch: 5, Steps: 131 | Train Loss: 0.3341188 Vali Loss: 0.2880886 Best vali loss: 0.2694595
	iters: 100, epoch: 6 | loss: 0.3177568
	speed: 0.0087s/iter; left time: 2.5495s
Updating learning rate to 7.3228103625e-06
Epoch: 6 cost time: 0.7029538154602051
Epoch: 6, Steps: 131 | Train Loss: 0.3177568 Vali Loss: 0.2876846 Best vali loss: 0.2694595
	iters: 100, epoch: 7 | loss: 0.3132778
	speed: 0.0086s/iter; left time: 1.4011s
Updating learning rate to 3.66140518125e-06
Epoch: 7 cost time: 0.6959259510040283
Epoch: 7, Steps: 131 | Train Loss: 0.3132778 Vali Loss: 0.2945464 Best vali loss: 0.2694595
	iters: 100, epoch: 8 | loss: 0.3946350
	speed: 0.0087s/iter; left time: 0.2777s
Updating learning rate to 1.830702590625e-06
Epoch: 8 cost time: 0.7066853046417236
Epoch: 8, Steps: 131 | Train Loss: 0.3946350 Vali Loss: 0.2953689 Best vali loss: 0.2694595

best validation loss 0.2694595457453318

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021562222836, 'e_layers': 4, 'learning_rate': 0.0005275866134, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005275866134
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 0.6796879768371582
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2801915 Best vali loss: 0.2801915
Updating learning rate to 0.0002637933067
Epoch: 2 cost time: 0.4546048641204834
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2853277 Best vali loss: 0.2801915
Updating learning rate to 0.00013189665335
Epoch: 3 cost time: 0.45635008811950684
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2842228 Best vali loss: 0.2801915

best validation loss 0.28019150171128293

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0018042453699, 'e_layers': 4, 'learning_rate': 0.0005454963374, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5899200
	speed: 0.0103s/iter; left time: 42.1234s
	iters: 200, epoch: 1 | loss: 0.4802430
	speed: 0.0051s/iter; left time: 20.2827s
	iters: 300, epoch: 1 | loss: 1.1153952
	speed: 0.0051s/iter; left time: 19.7787s
	iters: 400, epoch: 1 | loss: 0.4295414
	speed: 0.0051s/iter; left time: 19.1547s
	iters: 500, epoch: 1 | loss: 0.2008187
	speed: 0.0051s/iter; left time: 18.7204s
Updating learning rate to 0.0005247346192918655
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 2.91760516166687
Epoch: 1, Steps: 523 | Train Loss: 0.5631837 Vali Loss: 0.2834691 Best vali loss: 0.2834691
	iters: 100, epoch: 2 | loss: 0.6824764
	speed: 0.0101s/iter; left time: 36.0739s
	iters: 200, epoch: 2 | loss: 0.2346254
	speed: 0.0050s/iter; left time: 17.4506s
	iters: 300, epoch: 2 | loss: 0.2993006
	speed: 0.0051s/iter; left time: 17.0895s
	iters: 400, epoch: 2 | loss: 0.2645095
	speed: 0.0051s/iter; left time: 16.6550s
	iters: 500, epoch: 2 | loss: 0.4606776
	speed: 0.0051s/iter; left time: 16.0988s
Updating learning rate to 0.0004656102483439824
Validation loss decreased (0.2835 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 2.6882686614990234
Epoch: 2, Steps: 523 | Train Loss: 0.3883179 Vali Loss: 0.2827569 Best vali loss: 0.2827569
	iters: 100, epoch: 3 | loss: 0.7018110
	speed: 0.0101s/iter; left time: 30.7248s
	iters: 200, epoch: 3 | loss: 1.1769812
	speed: 0.0051s/iter; left time: 14.9384s
	iters: 300, epoch: 3 | loss: 0.3041307
	speed: 0.0051s/iter; left time: 14.3521s
	iters: 400, epoch: 3 | loss: 0.4134284
	speed: 0.0051s/iter; left time: 13.8392s
	iters: 500, epoch: 3 | loss: 0.4241095
	speed: 0.0051s/iter; left time: 13.3278s
Updating learning rate to 0.00037712437406940854
Epoch: 3 cost time: 2.6878089904785156
Epoch: 3, Steps: 523 | Train Loss: 0.6040922 Vali Loss: 0.2899150 Best vali loss: 0.2827569

best validation loss 0.28275686132282785

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.004416915315, 'e_layers': 2, 'learning_rate': 0.0019322227003, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4179779
	speed: 0.0091s/iter; left time: 8.6790s
Updating learning rate to 0.0019322227003
Validation loss decreased (inf --> 0.2865).  Saving model state dict ...
Epoch: 1 cost time: 0.747938871383667
Epoch: 1, Steps: 131 | Train Loss: 0.4179779 Vali Loss: 0.2865030 Best vali loss: 0.2865030
	iters: 100, epoch: 2 | loss: 0.2978271
	speed: 0.0068s/iter; left time: 5.5613s
Updating learning rate to 0.00096611135015
Epoch: 2 cost time: 0.5467243194580078
Epoch: 2, Steps: 131 | Train Loss: 0.2978271 Vali Loss: 0.2875988 Best vali loss: 0.2865030
	iters: 100, epoch: 3 | loss: 0.5968304
	speed: 0.0066s/iter; left time: 4.5088s
Updating learning rate to 0.000483055675075
Epoch: 3 cost time: 0.523578405380249
Epoch: 3, Steps: 131 | Train Loss: 0.5968304 Vali Loss: 0.2901471 Best vali loss: 0.2865030

best validation loss 0.286503012897845

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021562222836, 'e_layers': 4, 'learning_rate': 0.0005275866134, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.5948326675e-05
Epoch: 4 cost time: 0.6666996479034424
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2810109 Best vali loss: 0.2801915
Updating learning rate to 3.29741633375e-05
Epoch: 5 cost time: 0.4539637565612793
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2825683 Best vali loss: 0.2801915
Updating learning rate to 1.648708166875e-05
Validation loss decreased (0.2802 --> 0.2801).  Saving model state dict ...
Epoch: 6 cost time: 0.4578373432159424
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2800761 Best vali loss: 0.2800761
Updating learning rate to 8.243540834375e-06
Epoch: 7 cost time: 0.45599818229675293
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2809211 Best vali loss: 0.2800761
Updating learning rate to 4.1217704171875e-06
Epoch: 8 cost time: 0.4506409168243408
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2808879 Best vali loss: 0.2800761

best validation loss 0.28007608318515054

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0019693396814, 'e_layers': 1, 'learning_rate': 0.0006377406938, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5219879
	speed: 0.0079s/iter; left time: 15.7891s
	iters: 200, epoch: 1 | loss: 0.5354469
	speed: 0.0026s/iter; left time: 4.9022s
Updating learning rate to 0.0006134681339256838
Validation loss decreased (inf --> 0.2810).  Saving model state dict ...
Epoch: 1 cost time: 0.93839430809021
Epoch: 1, Steps: 262 | Train Loss: 0.5287174 Vali Loss: 0.2809752 Best vali loss: 0.2809752
	iters: 100, epoch: 2 | loss: 0.3183291
	speed: 0.0065s/iter; left time: 11.3009s
	iters: 200, epoch: 2 | loss: 0.5636159
	speed: 0.0026s/iter; left time: 4.2350s
Updating learning rate to 0.0005443457315122968
Epoch: 2 cost time: 0.7327945232391357
Epoch: 2, Steps: 262 | Train Loss: 0.4409725 Vali Loss: 0.2831847 Best vali loss: 0.2809752
	iters: 100, epoch: 3 | loss: 0.5385183
	speed: 0.0064s/iter; left time: 9.3587s
	iters: 200, epoch: 3 | loss: 0.3314735
	speed: 0.0026s/iter; left time: 3.5889s
Updating learning rate to 0.00044089674573113887
Epoch: 3 cost time: 0.7282814979553223
Epoch: 3, Steps: 262 | Train Loss: 0.4349959 Vali Loss: 0.2871827 Best vali loss: 0.2809752
	iters: 100, epoch: 4 | loss: 0.8044646
	speed: 0.0062s/iter; left time: 7.5233s
	iters: 200, epoch: 4 | loss: 0.5459751
	speed: 0.0024s/iter; left time: 2.6501s
Updating learning rate to 0.0003188703469
Epoch: 4 cost time: 0.6718084812164307
Epoch: 4, Steps: 262 | Train Loss: 0.6752199 Vali Loss: 0.2884937 Best vali loss: 0.2809752
	iters: 100, epoch: 5 | loss: 0.3164631
	speed: 0.0061s/iter; left time: 5.7859s
	iters: 200, epoch: 5 | loss: 0.3222210
	speed: 0.0025s/iter; left time: 2.1130s
Updating learning rate to 0.00019684394806886117
Epoch: 5 cost time: 0.6941235065460205
Epoch: 5, Steps: 262 | Train Loss: 0.3193420 Vali Loss: 0.2882069 Best vali loss: 0.2809752
	iters: 100, epoch: 6 | loss: 0.6688650
	speed: 0.0061s/iter; left time: 4.2122s
	iters: 200, epoch: 6 | loss: 0.3919844
	speed: 0.0024s/iter; left time: 1.3986s
Updating learning rate to 9.339496228770322e-05
Epoch: 6 cost time: 0.6796121597290039
Epoch: 6, Steps: 262 | Train Loss: 0.5304247 Vali Loss: 0.2992636 Best vali loss: 0.2809752
	iters: 100, epoch: 7 | loss: 0.4203884
	speed: 0.0060s/iter; left time: 2.5672s
	iters: 200, epoch: 7 | loss: 0.3169690
	speed: 0.0025s/iter; left time: 0.8084s
Updating learning rate to 2.427255987431617e-05
Epoch: 7 cost time: 0.6904840469360352
Epoch: 7, Steps: 262 | Train Loss: 0.3686787 Vali Loss: 0.2963373 Best vali loss: 0.2809752
	iters: 100, epoch: 8 | loss: 0.2850744
	speed: 0.0063s/iter; left time: 1.0315s
	iters: 200, epoch: 8 | loss: 0.2488929
	speed: 0.0026s/iter; left time: 0.1616s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6996908187866211
Epoch: 8, Steps: 262 | Train Loss: 0.2669836 Vali Loss: 0.2974068 Best vali loss: 0.2809752

best validation loss 0.28097515290844793

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011369292158, 'e_layers': 2, 'learning_rate': 9.67325355e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 9.67325355e-05
Validation loss decreased (inf --> 0.3045).  Saving model state dict ...
Epoch: 1 cost time: 0.5472533702850342
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3045462 Best vali loss: 0.3045462
Updating learning rate to 4.836626775e-05
Validation loss decreased (0.3045 --> 0.2885).  Saving model state dict ...
Epoch: 2 cost time: 0.34833288192749023
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2884913 Best vali loss: 0.2884913
Updating learning rate to 2.4183133875e-05
Validation loss decreased (0.2885 --> 0.2846).  Saving model state dict ...
Epoch: 3 cost time: 0.31777262687683105
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2846305 Best vali loss: 0.2846305
Updating learning rate to 1.20915669375e-05
Validation loss decreased (0.2846 --> 0.2830).  Saving model state dict ...
Epoch: 4 cost time: 0.3166811466217041
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2829774 Best vali loss: 0.2829774
Updating learning rate to 6.04578346875e-06
Validation loss decreased (0.2830 --> 0.2824).  Saving model state dict ...
Epoch: 5 cost time: 0.3542637825012207
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2823510 Best vali loss: 0.2823510
Updating learning rate to 3.022891734375e-06
Validation loss decreased (0.2824 --> 0.2822).  Saving model state dict ...
Epoch: 6 cost time: 0.3312838077545166
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2821608 Best vali loss: 0.2821608
Updating learning rate to 1.5114458671875e-06
Validation loss decreased (0.2822 --> 0.2820).  Saving model state dict ...
Epoch: 7 cost time: 0.3172335624694824
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2820374 Best vali loss: 0.2820374
Updating learning rate to 7.5572293359375e-07
Validation loss decreased (0.2820 --> 0.2820).  Saving model state dict ...
Epoch: 8 cost time: 0.34794092178344727
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2819825 Best vali loss: 0.2819825

best validation loss 0.2819824634586049

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010259811934, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597185
	speed: 0.0104s/iter; left time: 9.8658s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9353463649749756
Epoch: 1, Steps: 131 | Train Loss: 0.5597185 Vali Loss: 0.2756347 Best vali loss: 0.2756347
	iters: 100, epoch: 2 | loss: 0.3239341
	speed: 0.0090s/iter; left time: 7.3459s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.6993637084960938
Epoch: 2, Steps: 131 | Train Loss: 0.3239341 Vali Loss: 0.2690299 Best vali loss: 0.2690299
	iters: 100, epoch: 3 | loss: 0.4602075
	speed: 0.0090s/iter; left time: 6.1534s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.7040166854858398
Epoch: 3, Steps: 131 | Train Loss: 0.4602075 Vali Loss: 0.2798043 Best vali loss: 0.2690299

best validation loss 0.2690298935213511

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010134645159, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596855
	speed: 0.0105s/iter; left time: 9.9211s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9260952472686768
Epoch: 1, Steps: 131 | Train Loss: 0.5596855 Vali Loss: 0.2756435 Best vali loss: 0.2756435
	iters: 100, epoch: 2 | loss: 0.3253742
	speed: 0.0089s/iter; left time: 7.3032s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.7009596824645996
Epoch: 2, Steps: 131 | Train Loss: 0.3253742 Vali Loss: 0.2722625 Best vali loss: 0.2722625
	iters: 100, epoch: 3 | loss: 0.4619334
	speed: 0.0089s/iter; left time: 6.1444s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.7029447555541992
Epoch: 3, Steps: 131 | Train Loss: 0.4619334 Vali Loss: 0.2831799 Best vali loss: 0.2722625

best validation loss 0.27226252811200646

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.00355925651, 'e_layers': 3, 'learning_rate': 0.0002150347205, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7088323
	speed: 0.0097s/iter; left time: 39.4227s
	iters: 200, epoch: 1 | loss: 0.9460229
	speed: 0.0045s/iter; left time: 17.7829s
	iters: 300, epoch: 1 | loss: 0.5731751
	speed: 0.0045s/iter; left time: 17.3367s
	iters: 400, epoch: 1 | loss: 0.5764920
	speed: 0.0042s/iter; left time: 15.7873s
	iters: 500, epoch: 1 | loss: 0.3734574
	speed: 0.0041s/iter; left time: 14.9450s
Updating learning rate to 0.0002068504487746176
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 2.51910138130188
Epoch: 1, Steps: 523 | Train Loss: 0.6355959 Vali Loss: 0.2775972 Best vali loss: 0.2775972
	iters: 100, epoch: 2 | loss: 0.9843383
	speed: 0.0084s/iter; left time: 30.0743s
	iters: 200, epoch: 2 | loss: 0.3302830
	speed: 0.0038s/iter; left time: 13.0838s
	iters: 300, epoch: 2 | loss: 0.1834522
	speed: 0.0038s/iter; left time: 12.6661s
	iters: 400, epoch: 2 | loss: 0.3309081
	speed: 0.0038s/iter; left time: 12.2678s
	iters: 500, epoch: 2 | loss: 0.4946513
	speed: 0.0038s/iter; left time: 11.9815s
Updating learning rate to 0.00018354361477805197
Epoch: 2 cost time: 2.019871711730957
Epoch: 2, Steps: 523 | Train Loss: 0.4647266 Vali Loss: 0.2894684 Best vali loss: 0.2775972
	iters: 100, epoch: 3 | loss: 0.5373586
	speed: 0.0084s/iter; left time: 25.6380s
	iters: 200, epoch: 3 | loss: 0.3826915
	speed: 0.0040s/iter; left time: 11.8241s
	iters: 300, epoch: 3 | loss: 0.1871015
	speed: 0.0040s/iter; left time: 11.3580s
	iters: 400, epoch: 3 | loss: 0.3166073
	speed: 0.0041s/iter; left time: 11.2916s
	iters: 500, epoch: 3 | loss: 0.3432248
	speed: 0.0041s/iter; left time: 10.9401s
Updating learning rate to 0.0001486624727093039
Epoch: 3 cost time: 2.1726253032684326
Epoch: 3, Steps: 523 | Train Loss: 0.3533967 Vali Loss: 0.2871122 Best vali loss: 0.2775972

best validation loss 0.2775971883621833

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010259811934, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4248635
	speed: 0.0106s/iter; left time: 5.8819s
Updating learning rate to 2.9315984725e-05
Epoch: 4 cost time: 0.9250338077545166
Epoch: 4, Steps: 131 | Train Loss: 0.4248635 Vali Loss: 0.3038316 Best vali loss: 0.2690299
	iters: 100, epoch: 5 | loss: 0.2813718
	speed: 0.0086s/iter; left time: 3.6514s
Updating learning rate to 1.46579923625e-05
Epoch: 5 cost time: 0.6936285495758057
Epoch: 5, Steps: 131 | Train Loss: 0.2813718 Vali Loss: 0.2880310 Best vali loss: 0.2690299
	iters: 100, epoch: 6 | loss: 0.4340374
	speed: 0.0086s/iter; left time: 2.5248s
Updating learning rate to 7.32899618125e-06
Epoch: 6 cost time: 0.693514347076416
Epoch: 6, Steps: 131 | Train Loss: 0.4340374 Vali Loss: 0.2946239 Best vali loss: 0.2690299
	iters: 100, epoch: 7 | loss: 0.4639482
	speed: 0.0086s/iter; left time: 1.4052s
Updating learning rate to 3.664498090625e-06
Epoch: 7 cost time: 0.7039980888366699
Epoch: 7, Steps: 131 | Train Loss: 0.4639482 Vali Loss: 0.2943582 Best vali loss: 0.2690299
	iters: 100, epoch: 8 | loss: 0.3263981
	speed: 0.0087s/iter; left time: 0.2770s
Updating learning rate to 1.8322490453125e-06
Epoch: 8 cost time: 0.7040691375732422
Epoch: 8, Steps: 131 | Train Loss: 0.3263981 Vali Loss: 0.2917069 Best vali loss: 0.2690299

best validation loss 0.2690298935213511

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011757600313, 'e_layers': 3, 'learning_rate': 0.0002119963544, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7063898
	speed: 0.0091s/iter; left time: 37.3596s
	iters: 200, epoch: 1 | loss: 0.9455767
	speed: 0.0040s/iter; left time: 16.0566s
	iters: 300, epoch: 1 | loss: 0.5728700
	speed: 0.0041s/iter; left time: 15.8118s
	iters: 400, epoch: 1 | loss: 0.5763702
	speed: 0.0040s/iter; left time: 15.2226s
	iters: 500, epoch: 1 | loss: 0.3736715
	speed: 0.0038s/iter; left time: 13.9624s
Updating learning rate to 0.0002119963544
Validation loss decreased (inf --> 0.2778).  Saving model state dict ...
Epoch: 1 cost time: 2.3356776237487793
Epoch: 1, Steps: 523 | Train Loss: 0.6349756 Vali Loss: 0.2777549 Best vali loss: 0.2777549
	iters: 100, epoch: 2 | loss: 0.9933443
	speed: 0.0083s/iter; left time: 29.6202s
	iters: 200, epoch: 2 | loss: 0.3333401
	speed: 0.0037s/iter; left time: 12.9123s
	iters: 300, epoch: 2 | loss: 0.1799640
	speed: 0.0037s/iter; left time: 12.5283s
	iters: 400, epoch: 2 | loss: 0.3177731
	speed: 0.0037s/iter; left time: 12.1114s
	iters: 500, epoch: 2 | loss: 0.4878179
	speed: 0.0037s/iter; left time: 11.7405s
Updating learning rate to 0.0001059981772
Epoch: 2 cost time: 1.9919321537017822
Epoch: 2, Steps: 523 | Train Loss: 0.4624479 Vali Loss: 0.2835461 Best vali loss: 0.2777549
	iters: 100, epoch: 3 | loss: 0.5611132
	speed: 0.0087s/iter; left time: 26.5704s
	iters: 200, epoch: 3 | loss: 0.3758593
	speed: 0.0045s/iter; left time: 13.1713s
	iters: 300, epoch: 3 | loss: 0.1935853
	speed: 0.0045s/iter; left time: 12.8749s
	iters: 400, epoch: 3 | loss: 0.3149814
	speed: 0.0045s/iter; left time: 12.3555s
	iters: 500, epoch: 3 | loss: 0.3214856
	speed: 0.0043s/iter; left time: 11.4325s
Updating learning rate to 5.29990886e-05
Epoch: 3 cost time: 2.3666749000549316
Epoch: 3, Steps: 523 | Train Loss: 0.3534050 Vali Loss: 0.2811164 Best vali loss: 0.2777549
	iters: 100, epoch: 4 | loss: 0.5464430
	speed: 0.0090s/iter; left time: 22.5253s
	iters: 200, epoch: 4 | loss: 0.4425925
	speed: 0.0044s/iter; left time: 10.6994s
	iters: 300, epoch: 4 | loss: 0.2686181
	speed: 0.0044s/iter; left time: 10.2732s
	iters: 400, epoch: 4 | loss: 0.3141174
	speed: 0.0044s/iter; left time: 9.7848s
	iters: 500, epoch: 4 | loss: 0.5360388
	speed: 0.0044s/iter; left time: 9.4081s
Updating learning rate to 2.64995443e-05
Epoch: 4 cost time: 2.358637809753418
Epoch: 4, Steps: 523 | Train Loss: 0.4215620 Vali Loss: 0.2817841 Best vali loss: 0.2777549
	iters: 100, epoch: 5 | loss: 0.2293778
	speed: 0.0090s/iter; left time: 17.8673s
	iters: 200, epoch: 5 | loss: 0.5622926
	speed: 0.0045s/iter; left time: 8.5354s
	iters: 300, epoch: 5 | loss: 0.3735101
	speed: 0.0045s/iter; left time: 8.0123s
	iters: 400, epoch: 5 | loss: 0.2950787
	speed: 0.0045s/iter; left time: 7.5703s
	iters: 500, epoch: 5 | loss: 0.2971196
	speed: 0.0045s/iter; left time: 7.1206s
Updating learning rate to 1.324977215e-05
Epoch: 5 cost time: 2.3771824836730957
Epoch: 5, Steps: 523 | Train Loss: 0.3514758 Vali Loss: 0.2816462 Best vali loss: 0.2777549
	iters: 100, epoch: 6 | loss: 0.2948396
	speed: 0.0090s/iter; left time: 13.2090s
	iters: 200, epoch: 6 | loss: 0.4272225
	speed: 0.0044s/iter; left time: 6.0621s
	iters: 300, epoch: 6 | loss: 0.3608530
	speed: 0.0044s/iter; left time: 5.6106s
	iters: 400, epoch: 6 | loss: 0.5230983
	speed: 0.0044s/iter; left time: 5.1262s
	iters: 500, epoch: 6 | loss: 0.3801015
	speed: 0.0044s/iter; left time: 4.7304s
Updating learning rate to 6.624886075e-06
Epoch: 6 cost time: 2.3449137210845947
Epoch: 6, Steps: 523 | Train Loss: 0.3972230 Vali Loss: 0.2854258 Best vali loss: 0.2777549
	iters: 100, epoch: 7 | loss: 0.2793705
	speed: 0.0087s/iter; left time: 8.1960s
	iters: 200, epoch: 7 | loss: 0.4790675
	speed: 0.0041s/iter; left time: 3.4680s
	iters: 300, epoch: 7 | loss: 0.5215555
	speed: 0.0041s/iter; left time: 3.0479s
	iters: 400, epoch: 7 | loss: 0.2432659
	speed: 0.0041s/iter; left time: 2.6363s
	iters: 500, epoch: 7 | loss: 0.3794085
	speed: 0.0041s/iter; left time: 2.2405s
Updating learning rate to 3.3124430375e-06
Epoch: 7 cost time: 2.1750693321228027
Epoch: 7, Steps: 523 | Train Loss: 0.3805336 Vali Loss: 0.2845610 Best vali loss: 0.2777549
	iters: 100, epoch: 8 | loss: 0.3194106
	speed: 0.0086s/iter; left time: 3.6632s
	iters: 200, epoch: 8 | loss: 0.2534984
	speed: 0.0041s/iter; left time: 1.3334s
	iters: 300, epoch: 8 | loss: 0.2795972
	speed: 0.0041s/iter; left time: 0.9196s
	iters: 400, epoch: 8 | loss: 0.1876915
	speed: 0.0041s/iter; left time: 0.5040s
	iters: 500, epoch: 8 | loss: 0.5089189
	speed: 0.0040s/iter; left time: 0.0959s
Updating learning rate to 1.65622151875e-06
Epoch: 8 cost time: 2.1688804626464844
Epoch: 8, Steps: 523 | Train Loss: 0.3098233 Vali Loss: 0.2855457 Best vali loss: 0.2777549

best validation loss 0.2777549270228765

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009677152586, 'e_layers': 3, 'learning_rate': 0.0002035693271, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6990514
	speed: 0.0097s/iter; left time: 39.5353s
	iters: 200, epoch: 1 | loss: 0.9452648
	speed: 0.0044s/iter; left time: 17.3733s
	iters: 300, epoch: 1 | loss: 0.5725507
	speed: 0.0044s/iter; left time: 16.9275s
	iters: 400, epoch: 1 | loss: 0.5775136
	speed: 0.0043s/iter; left time: 16.2962s
	iters: 500, epoch: 1 | loss: 0.3710259
	speed: 0.0043s/iter; left time: 15.8605s
Updating learning rate to 0.00019582143092739259
Validation loss decreased (inf --> 0.2775).  Saving model state dict ...
Epoch: 1 cost time: 2.533270835876465
Epoch: 1, Steps: 523 | Train Loss: 0.6330813 Vali Loss: 0.2774590 Best vali loss: 0.2774590
	iters: 100, epoch: 2 | loss: 0.9750172
	speed: 0.0089s/iter; left time: 31.6682s
	iters: 200, epoch: 2 | loss: 0.3319661
	speed: 0.0040s/iter; left time: 13.8490s
	iters: 300, epoch: 2 | loss: 0.1776329
	speed: 0.0040s/iter; left time: 13.5720s
	iters: 400, epoch: 2 | loss: 0.3467121
	speed: 0.0038s/iter; left time: 12.4599s
	iters: 500, epoch: 2 | loss: 0.4890481
	speed: 0.0038s/iter; left time: 12.0786s
Updating learning rate to 0.00017375728936699618
Epoch: 2 cost time: 2.104759693145752
Epoch: 2, Steps: 523 | Train Loss: 0.4640753 Vali Loss: 0.2859618 Best vali loss: 0.2774590
	iters: 100, epoch: 3 | loss: 0.5769638
	speed: 0.0082s/iter; left time: 25.0459s
	iters: 200, epoch: 3 | loss: 0.3723625
	speed: 0.0039s/iter; left time: 11.3704s
	iters: 300, epoch: 3 | loss: 0.1875408
	speed: 0.0042s/iter; left time: 11.8543s
	iters: 400, epoch: 3 | loss: 0.3263972
	speed: 0.0044s/iter; left time: 12.1525s
	iters: 500, epoch: 3 | loss: 0.3484933
	speed: 0.0044s/iter; left time: 11.6758s
Updating learning rate to 0.00014073596795943983
Epoch: 3 cost time: 2.213716506958008
Epoch: 3, Steps: 523 | Train Loss: 0.3623515 Vali Loss: 0.2826845 Best vali loss: 0.2774590
	iters: 100, epoch: 4 | loss: 0.5373978
	speed: 0.0088s/iter; left time: 22.1780s
	iters: 200, epoch: 4 | loss: 0.4491503
	speed: 0.0044s/iter; left time: 10.5758s
	iters: 300, epoch: 4 | loss: 0.2928038
	speed: 0.0044s/iter; left time: 10.1637s
	iters: 400, epoch: 4 | loss: 0.3079981
	speed: 0.0044s/iter; left time: 9.7713s
	iters: 500, epoch: 4 | loss: 0.5275654
	speed: 0.0044s/iter; left time: 9.3334s
Updating learning rate to 0.00010178466355
Epoch: 4 cost time: 2.3400096893310547
Epoch: 4, Steps: 523 | Train Loss: 0.4229831 Vali Loss: 0.2899659 Best vali loss: 0.2774590
	iters: 100, epoch: 5 | loss: 0.2147673
	speed: 0.0090s/iter; left time: 17.9303s
	iters: 200, epoch: 5 | loss: 0.5488250
	speed: 0.0044s/iter; left time: 8.3136s
	iters: 300, epoch: 5 | loss: 0.3843681
	speed: 0.0045s/iter; left time: 8.0877s
	iters: 400, epoch: 5 | loss: 0.2918066
	speed: 0.0044s/iter; left time: 7.4804s
	iters: 500, epoch: 5 | loss: 0.2816832
	speed: 0.0044s/iter; left time: 7.0168s
Updating learning rate to 6.283335914056016e-05
Epoch: 5 cost time: 2.3634843826293945
Epoch: 5, Steps: 523 | Train Loss: 0.3442900 Vali Loss: 0.2913625 Best vali loss: 0.2774590
	iters: 100, epoch: 6 | loss: 0.2845021
	speed: 0.0087s/iter; left time: 12.7952s
	iters: 200, epoch: 6 | loss: 0.3851556
	speed: 0.0043s/iter; left time: 5.9343s
	iters: 300, epoch: 6 | loss: 0.3450578
	speed: 0.0043s/iter; left time: 5.5217s
	iters: 400, epoch: 6 | loss: 0.4940777
	speed: 0.0043s/iter; left time: 5.0675s
	iters: 500, epoch: 6 | loss: 0.3722887
	speed: 0.0043s/iter; left time: 4.6312s
Updating learning rate to 2.9812037733003796e-05
Epoch: 6 cost time: 2.3002138137817383
Epoch: 6, Steps: 523 | Train Loss: 0.3762164 Vali Loss: 0.3019539 Best vali loss: 0.2774590
	iters: 100, epoch: 7 | loss: 0.2713263
	speed: 0.0083s/iter; left time: 7.8543s
	iters: 200, epoch: 7 | loss: 0.4467170
	speed: 0.0039s/iter; left time: 3.2820s
	iters: 300, epoch: 7 | loss: 0.4699841
	speed: 0.0039s/iter; left time: 2.9102s
	iters: 400, epoch: 7 | loss: 0.2081480
	speed: 0.0038s/iter; left time: 2.4795s
	iters: 500, epoch: 7 | loss: 0.3740914
	speed: 0.0039s/iter; left time: 2.1181s
Updating learning rate to 7.747896172607393e-06
Epoch: 7 cost time: 2.064934015274048
Epoch: 7, Steps: 523 | Train Loss: 0.3540534 Vali Loss: 0.3010711 Best vali loss: 0.2774590
	iters: 100, epoch: 8 | loss: 0.2857047
	speed: 0.0088s/iter; left time: 3.7488s
	iters: 200, epoch: 8 | loss: 0.2351020
	speed: 0.0042s/iter; left time: 1.3743s
	iters: 300, epoch: 8 | loss: 0.2642235
	speed: 0.0041s/iter; left time: 0.9127s
	iters: 400, epoch: 8 | loss: 0.1817869
	speed: 0.0040s/iter; left time: 0.4974s
	iters: 500, epoch: 8 | loss: 0.4706444
	speed: 0.0042s/iter; left time: 0.1001s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2062907218933105
Epoch: 8, Steps: 523 | Train Loss: 0.2874923 Vali Loss: 0.3016103 Best vali loss: 0.2774590

best validation loss 0.2774589941287936

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008901420328, 'e_layers': 3, 'learning_rate': 7.17477051e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.901697067327283e-05
Validation loss decreased (inf --> 0.3111).  Saving model state dict ...
Epoch: 1 cost time: 0.6335089206695557
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3111410 Best vali loss: 0.3111410
Updating learning rate to 6.124049695539131e-05
Validation loss decreased (0.3111 --> 0.2950).  Saving model state dict ...
Epoch: 2 cost time: 0.4113321304321289
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2949801 Best vali loss: 0.2949801
Updating learning rate to 4.960218157599313e-05
Validation loss decreased (0.2950 --> 0.2876).  Saving model state dict ...
Epoch: 3 cost time: 0.3701150417327881
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2876349 Best vali loss: 0.2876349

best validation loss 0.28763492073477226

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012300443208, 'e_layers': 1, 'learning_rate': 0.0001802466014, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4600849
	speed: 0.0076s/iter; left time: 62.6985s
	iters: 200, epoch: 1 | loss: 0.6542556
	speed: 0.0023s/iter; left time: 18.9991s
	iters: 300, epoch: 1 | loss: 0.2781258
	speed: 0.0024s/iter; left time: 19.3177s
	iters: 400, epoch: 1 | loss: 0.3171406
	speed: 0.0023s/iter; left time: 18.3582s
	iters: 500, epoch: 1 | loss: 0.3819371
	speed: 0.0023s/iter; left time: 17.8297s
	iters: 600, epoch: 1 | loss: 0.6636325
	speed: 0.0023s/iter; left time: 17.8502s
	iters: 700, epoch: 1 | loss: 0.1658179
	speed: 0.0023s/iter; left time: 17.8532s
	iters: 800, epoch: 1 | loss: 0.2864134
	speed: 0.0023s/iter; left time: 17.3835s
	iters: 900, epoch: 1 | loss: 0.3649454
	speed: 0.0023s/iter; left time: 17.2768s
	iters: 1000, epoch: 1 | loss: 0.3674910
	speed: 0.0023s/iter; left time: 16.7198s
Updating learning rate to 0.00017338637361909013
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 2.665888547897339
Epoch: 1, Steps: 1045 | Train Loss: 0.3939844 Vali Loss: 0.2831712 Best vali loss: 0.2831712
	iters: 100, epoch: 2 | loss: 0.2222484
	speed: 0.0080s/iter; left time: 57.6523s
	iters: 200, epoch: 2 | loss: 0.2994577
	speed: 0.0022s/iter; left time: 15.8115s
	iters: 300, epoch: 2 | loss: 1.4579685
	speed: 0.0022s/iter; left time: 15.7653s
	iters: 400, epoch: 2 | loss: 0.6831861
	speed: 0.0023s/iter; left time: 16.1740s
	iters: 500, epoch: 2 | loss: 1.2566806
	speed: 0.0023s/iter; left time: 15.5390s
	iters: 600, epoch: 2 | loss: 0.2431123
	speed: 0.0022s/iter; left time: 14.7049s
	iters: 700, epoch: 2 | loss: 0.1709015
	speed: 0.0022s/iter; left time: 14.6430s
	iters: 800, epoch: 2 | loss: 0.3550417
	speed: 0.0022s/iter; left time: 14.5954s
	iters: 900, epoch: 2 | loss: 0.3706431
	speed: 0.0022s/iter; left time: 14.2133s
	iters: 1000, epoch: 2 | loss: 0.1958818
	speed: 0.0022s/iter; left time: 13.8329s
Updating learning rate to 0.00015385009776788434
Epoch: 2 cost time: 2.3602418899536133
Epoch: 2, Steps: 1045 | Train Loss: 0.5255122 Vali Loss: 0.2844473 Best vali loss: 0.2831712
	iters: 100, epoch: 3 | loss: 0.3108025
	speed: 0.0078s/iter; left time: 47.8618s
	iters: 200, epoch: 3 | loss: 0.2118922
	speed: 0.0022s/iter; left time: 13.4659s
	iters: 300, epoch: 3 | loss: 0.1892766
	speed: 0.0021s/iter; left time: 12.5316s
	iters: 400, epoch: 3 | loss: 0.3444561
	speed: 0.0021s/iter; left time: 12.2351s
	iters: 500, epoch: 3 | loss: 0.4684060
	speed: 0.0021s/iter; left time: 12.2668s
	iters: 600, epoch: 3 | loss: 0.3029606
	speed: 0.0022s/iter; left time: 12.6022s
	iters: 700, epoch: 3 | loss: 0.5209264
	speed: 0.0022s/iter; left time: 12.0440s
	iters: 800, epoch: 3 | loss: 0.2418760
	speed: 0.0021s/iter; left time: 11.5617s
	iters: 900, epoch: 3 | loss: 0.4942913
	speed: 0.0021s/iter; left time: 11.2054s
	iters: 1000, epoch: 3 | loss: 0.1640228
	speed: 0.0021s/iter; left time: 10.9811s
Updating learning rate to 0.0001246119947479471
Epoch: 3 cost time: 2.2744641304016113
Epoch: 3, Steps: 1045 | Train Loss: 0.3248910 Vali Loss: 0.2959015 Best vali loss: 0.2831712

best validation loss 0.28317124383539993

[INFO][smbo.py:320] Finished 950 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002340835451, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596891
	speed: 0.0106s/iter; left time: 10.0859s
Updating learning rate to 0.00022517427065778635
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.937192440032959
Epoch: 1, Steps: 131 | Train Loss: 0.5596891 Vali Loss: 0.2756731 Best vali loss: 0.2756731
	iters: 100, epoch: 2 | loss: 0.3246216
	speed: 0.0090s/iter; left time: 7.3648s
Updating learning rate to 0.0001998028036021985
Validation loss decreased (0.2757 --> 0.2717).  Saving model state dict ...
Epoch: 2 cost time: 0.7042698860168457
Epoch: 2, Steps: 131 | Train Loss: 0.3246216 Vali Loss: 0.2716707 Best vali loss: 0.2716707
	iters: 100, epoch: 3 | loss: 0.4636310
	speed: 0.0089s/iter; left time: 6.1159s
Updating learning rate to 0.00016183171979952814
Epoch: 3 cost time: 0.7006793022155762
Epoch: 3, Steps: 131 | Train Loss: 0.4636310 Vali Loss: 0.2764386 Best vali loss: 0.2716707

best validation loss 0.27167068635189384

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269445805, 'e_layers': 2, 'learning_rate': 0.0002340835451, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4180230
	speed: 0.0108s/iter; left time: 5.9890s
Updating learning rate to 0.00011704177255
Epoch: 4 cost time: 0.9183168411254883
Epoch: 4, Steps: 131 | Train Loss: 0.4180230 Vali Loss: 0.2918385 Best vali loss: 0.2716707
	iters: 100, epoch: 5 | loss: 0.2720146
	speed: 0.0086s/iter; left time: 3.6683s
Updating learning rate to 7.225182530047185e-05
Epoch: 5 cost time: 0.6930525302886963
Epoch: 5, Steps: 131 | Train Loss: 0.2720146 Vali Loss: 0.2897237 Best vali loss: 0.2716707
	iters: 100, epoch: 6 | loss: 0.3881718
	speed: 0.0086s/iter; left time: 2.5149s
Updating learning rate to 3.428074149780149e-05
Epoch: 6 cost time: 0.6925842761993408
Epoch: 6, Steps: 131 | Train Loss: 0.3881718 Vali Loss: 0.2910303 Best vali loss: 0.2716707
	iters: 100, epoch: 7 | loss: 0.4006480
	speed: 0.0086s/iter; left time: 1.4007s
Updating learning rate to 8.909274442213647e-06
Epoch: 7 cost time: 0.6937150955200195
Epoch: 7, Steps: 131 | Train Loss: 0.4006480 Vali Loss: 0.2986065 Best vali loss: 0.2716707
	iters: 100, epoch: 8 | loss: 0.3068188
	speed: 0.0087s/iter; left time: 0.2770s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7003815174102783
Epoch: 8, Steps: 131 | Train Loss: 0.3068188 Vali Loss: 0.2983801 Best vali loss: 0.2716707

best validation loss 0.27167068635189384

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0053548647711, 'e_layers': 3, 'learning_rate': 8.69594302e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5168325
	speed: 0.0097s/iter; left time: 79.8700s
	iters: 200, epoch: 1 | loss: 0.3813174
	speed: 0.0044s/iter; left time: 36.1283s
	iters: 300, epoch: 1 | loss: 0.2472551
	speed: 0.0044s/iter; left time: 35.8271s
	iters: 400, epoch: 1 | loss: 0.5261275
	speed: 0.0040s/iter; left time: 31.9100s
	iters: 500, epoch: 1 | loss: 1.2588139
	speed: 0.0040s/iter; left time: 31.4441s
	iters: 600, epoch: 1 | loss: 0.2578128
	speed: 0.0040s/iter; left time: 31.2174s
	iters: 700, epoch: 1 | loss: 0.4765503
	speed: 0.0040s/iter; left time: 30.7026s
	iters: 800, epoch: 1 | loss: 0.4825180
	speed: 0.0040s/iter; left time: 30.2690s
	iters: 900, epoch: 1 | loss: 0.6046929
	speed: 0.0040s/iter; left time: 29.9768s
	iters: 1000, epoch: 1 | loss: 0.3041711
	speed: 0.0040s/iter; left time: 29.4459s
Updating learning rate to 8.69594302e-05
Validation loss decreased (inf --> 0.2767).  Saving model state dict ...
Epoch: 1 cost time: 4.568876028060913
Epoch: 1, Steps: 1045 | Train Loss: 0.5056091 Vali Loss: 0.2767000 Best vali loss: 0.2767000
	iters: 100, epoch: 2 | loss: 0.2640456
	speed: 0.0119s/iter; left time: 85.7423s
	iters: 200, epoch: 2 | loss: 0.3105004
	speed: 0.0038s/iter; left time: 26.9930s
	iters: 300, epoch: 2 | loss: 0.3510731
	speed: 0.0038s/iter; left time: 26.9705s
	iters: 400, epoch: 2 | loss: 1.0576265
	speed: 0.0039s/iter; left time: 26.7050s
	iters: 500, epoch: 2 | loss: 0.2765031
	speed: 0.0039s/iter; left time: 26.5844s
	iters: 600, epoch: 2 | loss: 0.5066169
	speed: 0.0039s/iter; left time: 26.2473s
	iters: 700, epoch: 2 | loss: 0.6843008
	speed: 0.0039s/iter; left time: 25.6071s
	iters: 800, epoch: 2 | loss: 0.6850877
	speed: 0.0039s/iter; left time: 25.6207s
	iters: 900, epoch: 2 | loss: 0.3705073
	speed: 0.0040s/iter; left time: 25.7479s
	iters: 1000, epoch: 2 | loss: 0.2183247
	speed: 0.0041s/iter; left time: 26.0572s
Updating learning rate to 4.34797151e-05
Epoch: 2 cost time: 4.129138946533203
Epoch: 2, Steps: 1045 | Train Loss: 0.4724586 Vali Loss: 0.2871488 Best vali loss: 0.2767000
	iters: 100, epoch: 3 | loss: 0.1779302
	speed: 0.0118s/iter; left time: 72.5188s
	iters: 200, epoch: 3 | loss: 0.6532878
	speed: 0.0040s/iter; left time: 24.2687s
	iters: 300, epoch: 3 | loss: 0.2622817
	speed: 0.0040s/iter; left time: 23.9585s
	iters: 400, epoch: 3 | loss: 0.4278455
	speed: 0.0040s/iter; left time: 23.5477s
	iters: 500, epoch: 3 | loss: 0.3590228
	speed: 0.0040s/iter; left time: 22.9154s
	iters: 600, epoch: 3 | loss: 0.4112971
	speed: 0.0040s/iter; left time: 22.7346s
	iters: 700, epoch: 3 | loss: 0.2836982
	speed: 0.0040s/iter; left time: 22.2731s
	iters: 800, epoch: 3 | loss: 0.5626853
	speed: 0.0040s/iter; left time: 21.8980s
	iters: 900, epoch: 3 | loss: 0.2491327
	speed: 0.0040s/iter; left time: 21.4893s
	iters: 1000, epoch: 3 | loss: 0.2568706
	speed: 0.0040s/iter; left time: 20.9205s
Updating learning rate to 2.173985755e-05
Epoch: 3 cost time: 4.2201573848724365
Epoch: 3, Steps: 1045 | Train Loss: 0.3644052 Vali Loss: 0.2946154 Best vali loss: 0.2767000
	iters: 100, epoch: 4 | loss: 0.3862318
	speed: 0.0116s/iter; left time: 59.3510s
	iters: 200, epoch: 4 | loss: 0.3105426
	speed: 0.0038s/iter; left time: 19.0002s
	iters: 300, epoch: 4 | loss: 0.8539608
	speed: 0.0038s/iter; left time: 18.7244s
	iters: 400, epoch: 4 | loss: 0.3693434
	speed: 0.0038s/iter; left time: 18.3863s
	iters: 500, epoch: 4 | loss: 0.9179845
	speed: 0.0038s/iter; left time: 17.9229s
	iters: 600, epoch: 4 | loss: 0.2405429
	speed: 0.0038s/iter; left time: 17.5188s
	iters: 700, epoch: 4 | loss: 0.1501292
	speed: 0.0037s/iter; left time: 16.7019s
	iters: 800, epoch: 4 | loss: 0.3964949
	speed: 0.0037s/iter; left time: 16.2034s
	iters: 900, epoch: 4 | loss: 0.3081135
	speed: 0.0037s/iter; left time: 15.7999s
	iters: 1000, epoch: 4 | loss: 0.2564154
	speed: 0.0036s/iter; left time: 15.3359s
Updating learning rate to 1.0869928775e-05
Epoch: 4 cost time: 3.940164804458618
Epoch: 4, Steps: 1045 | Train Loss: 0.4189759 Vali Loss: 0.2962686 Best vali loss: 0.2767000
	iters: 100, epoch: 5 | loss: 0.4600082
	speed: 0.0114s/iter; left time: 46.3978s
	iters: 200, epoch: 5 | loss: 0.2168506
	speed: 0.0040s/iter; left time: 15.9306s
	iters: 300, epoch: 5 | loss: 0.4671074
	speed: 0.0036s/iter; left time: 14.1132s
	iters: 400, epoch: 5 | loss: 0.7608175
	speed: 0.0040s/iter; left time: 15.1737s
	iters: 500, epoch: 5 | loss: 0.2050611
	speed: 0.0040s/iter; left time: 14.6552s
	iters: 600, epoch: 5 | loss: 0.3072945
	speed: 0.0040s/iter; left time: 14.3204s
	iters: 700, epoch: 5 | loss: 0.6341081
	speed: 0.0040s/iter; left time: 13.9574s
	iters: 800, epoch: 5 | loss: 0.3917524
	speed: 0.0040s/iter; left time: 13.5605s
	iters: 900, epoch: 5 | loss: 0.4419450
	speed: 0.0040s/iter; left time: 13.2150s
	iters: 1000, epoch: 5 | loss: 0.1707825
	speed: 0.0040s/iter; left time: 12.7593s
Updating learning rate to 5.4349643875e-06
Epoch: 5 cost time: 4.184472560882568
Epoch: 5, Steps: 1045 | Train Loss: 0.4055727 Vali Loss: 0.3091369 Best vali loss: 0.2767000
	iters: 100, epoch: 6 | loss: 0.4017629
	speed: 0.0115s/iter; left time: 34.9317s
	iters: 200, epoch: 6 | loss: 0.4165011
	speed: 0.0037s/iter; left time: 10.8545s
	iters: 300, epoch: 6 | loss: 0.2590775
	speed: 0.0037s/iter; left time: 10.5382s
	iters: 400, epoch: 6 | loss: 0.2042011
	speed: 0.0036s/iter; left time: 9.9454s
	iters: 500, epoch: 6 | loss: 0.4178631
	speed: 0.0037s/iter; left time: 9.6511s
	iters: 600, epoch: 6 | loss: 0.3971392
	speed: 0.0037s/iter; left time: 9.2811s
	iters: 700, epoch: 6 | loss: 0.6295160
	speed: 0.0036s/iter; left time: 8.6984s
	iters: 800, epoch: 6 | loss: 0.2717882
	speed: 0.0036s/iter; left time: 8.3445s
	iters: 900, epoch: 6 | loss: 0.4034622
	speed: 0.0037s/iter; left time: 8.1625s
	iters: 1000, epoch: 6 | loss: 0.4688170
	speed: 0.0037s/iter; left time: 7.9279s
Updating learning rate to 2.71748219375e-06
Epoch: 6 cost time: 3.85632061958313
Epoch: 6, Steps: 1045 | Train Loss: 0.3870128 Vali Loss: 0.3146544 Best vali loss: 0.2767000
	iters: 100, epoch: 7 | loss: 0.9859026
	speed: 0.0114s/iter; left time: 22.6028s
	iters: 200, epoch: 7 | loss: 0.2573996
	speed: 0.0039s/iter; left time: 7.4077s
	iters: 300, epoch: 7 | loss: 0.2957189
	speed: 0.0039s/iter; left time: 7.0095s
	iters: 400, epoch: 7 | loss: 0.2523350
	speed: 0.0040s/iter; left time: 6.7396s
	iters: 500, epoch: 7 | loss: 0.1646429
	speed: 0.0036s/iter; left time: 5.7391s
	iters: 600, epoch: 7 | loss: 0.3962938
	speed: 0.0039s/iter; left time: 5.7499s
	iters: 700, epoch: 7 | loss: 0.9143980
	speed: 0.0040s/iter; left time: 5.5485s
	iters: 800, epoch: 7 | loss: 0.3381494
	speed: 0.0040s/iter; left time: 5.1616s
	iters: 900, epoch: 7 | loss: 0.4817611
	speed: 0.0040s/iter; left time: 4.7641s
	iters: 1000, epoch: 7 | loss: 0.2553749
	speed: 0.0042s/iter; left time: 4.6351s
Updating learning rate to 1.358741096875e-06
Epoch: 7 cost time: 4.176170110702515
Epoch: 7, Steps: 1045 | Train Loss: 0.4341976 Vali Loss: 0.3192450 Best vali loss: 0.2767000
	iters: 100, epoch: 8 | loss: 0.1722801
	speed: 0.0122s/iter; left time: 11.5168s
	iters: 200, epoch: 8 | loss: 0.1876801
	speed: 0.0039s/iter; left time: 3.3415s
	iters: 300, epoch: 8 | loss: 0.9072387
	speed: 0.0037s/iter; left time: 2.7497s
	iters: 400, epoch: 8 | loss: 0.2684446
	speed: 0.0036s/iter; left time: 2.3123s
	iters: 500, epoch: 8 | loss: 0.3542578
	speed: 0.0036s/iter; left time: 1.9645s
	iters: 600, epoch: 8 | loss: 0.6377631
	speed: 0.0037s/iter; left time: 1.6415s
	iters: 700, epoch: 8 | loss: 0.3489827
	speed: 0.0036s/iter; left time: 1.2553s
	iters: 800, epoch: 8 | loss: 0.2182787
	speed: 0.0036s/iter; left time: 0.8892s
	iters: 900, epoch: 8 | loss: 0.7791443
	speed: 0.0036s/iter; left time: 0.5272s
	iters: 1000, epoch: 8 | loss: 0.2148353
	speed: 0.0036s/iter; left time: 0.1665s
Updating learning rate to 6.793705484375e-07
Epoch: 8 cost time: 3.9000930786132812
Epoch: 8, Steps: 1045 | Train Loss: 0.4088905 Vali Loss: 0.3191336 Best vali loss: 0.2767000

best validation loss 0.2766999958776417

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0001499357613, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5566428
	speed: 0.0104s/iter; left time: 9.8769s
Updating learning rate to 0.0001499357613
Validation loss decreased (inf --> 0.2755).  Saving model state dict ...
Epoch: 1 cost time: 0.9263536930084229
Epoch: 1, Steps: 131 | Train Loss: 0.5566428 Vali Loss: 0.2754985 Best vali loss: 0.2754985
	iters: 100, epoch: 2 | loss: 0.3264403
	speed: 0.0090s/iter; left time: 7.3882s
Updating learning rate to 7.496788065e-05
Epoch: 2 cost time: 0.7044148445129395
Epoch: 2, Steps: 131 | Train Loss: 0.3264403 Vali Loss: 0.2763942 Best vali loss: 0.2754985
	iters: 100, epoch: 3 | loss: 0.4744990
	speed: 0.0088s/iter; left time: 6.0167s
Updating learning rate to 3.7483940325e-05
Epoch: 3 cost time: 0.7040610313415527
Epoch: 3, Steps: 131 | Train Loss: 0.4744990 Vali Loss: 0.2780119 Best vali loss: 0.2754985
	iters: 100, epoch: 4 | loss: 0.5535207
	speed: 0.0087s/iter; left time: 4.8422s
Updating learning rate to 1.87419701625e-05
Epoch: 4 cost time: 0.7000594139099121
Epoch: 4, Steps: 131 | Train Loss: 0.5535207 Vali Loss: 0.2871307 Best vali loss: 0.2754985
	iters: 100, epoch: 5 | loss: 0.3423626
	speed: 0.0087s/iter; left time: 3.6926s
Updating learning rate to 9.37098508125e-06
Epoch: 5 cost time: 0.6991472244262695
Epoch: 5, Steps: 131 | Train Loss: 0.3423626 Vali Loss: 0.2920391 Best vali loss: 0.2754985
	iters: 100, epoch: 6 | loss: 0.3280127
	speed: 0.0087s/iter; left time: 2.5485s
Updating learning rate to 4.685492540625e-06
Epoch: 6 cost time: 0.7018222808837891
Epoch: 6, Steps: 131 | Train Loss: 0.3280127 Vali Loss: 0.2924135 Best vali loss: 0.2754985
	iters: 100, epoch: 7 | loss: 0.3192786
	speed: 0.0086s/iter; left time: 1.3987s
Updating learning rate to 2.3427462703125e-06
Epoch: 7 cost time: 0.6930527687072754
Epoch: 7, Steps: 131 | Train Loss: 0.3192786 Vali Loss: 0.2966981 Best vali loss: 0.2754985
	iters: 100, epoch: 8 | loss: 0.4457507
	speed: 0.0087s/iter; left time: 0.2792s
Updating learning rate to 1.17137313515625e-06
Epoch: 8 cost time: 0.6957910060882568
Epoch: 8, Steps: 131 | Train Loss: 0.4457507 Vali Loss: 0.2969667 Best vali loss: 0.2754985

best validation loss 0.2754984815553379

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020691823152, 'e_layers': 4, 'learning_rate': 0.0005029546805, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5718160
	speed: 0.0131s/iter; left time: 12.3973s
Updating learning rate to 0.0004838121077973518
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 1.2503268718719482
Epoch: 1, Steps: 131 | Train Loss: 0.5718160 Vali Loss: 0.2805526 Best vali loss: 0.2805526
	iters: 100, epoch: 2 | loss: 0.3478046
	speed: 0.0122s/iter; left time: 10.0185s
Updating learning rate to 0.0004292986728555317
Validation loss decreased (0.2806 --> 0.2802).  Saving model state dict ...
Epoch: 2 cost time: 0.992591142654419
Epoch: 2, Steps: 131 | Train Loss: 0.3478046 Vali Loss: 0.2801984 Best vali loss: 0.2801984
	iters: 100, epoch: 3 | loss: 0.5111470
	speed: 0.0124s/iter; left time: 8.5404s
Updating learning rate to 0.00034771355197891357
Epoch: 3 cost time: 0.9900808334350586
Epoch: 3, Steps: 131 | Train Loss: 0.5111470 Vali Loss: 0.2891014 Best vali loss: 0.2801984

best validation loss 0.280198430086255

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020847112498, 'e_layers': 2, 'learning_rate': 0.0003325190854, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3935923
	speed: 0.0093s/iter; left time: 18.6160s
	iters: 200, epoch: 1 | loss: 0.5807214
	speed: 0.0036s/iter; left time: 6.7421s
Updating learning rate to 0.0003198633312852163
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 1.2148692607879639
Epoch: 1, Steps: 262 | Train Loss: 0.4871569 Vali Loss: 0.2861859 Best vali loss: 0.2861859
	iters: 100, epoch: 2 | loss: 0.3801430
	speed: 0.0088s/iter; left time: 15.2002s
	iters: 200, epoch: 2 | loss: 0.3317637
	speed: 0.0038s/iter; left time: 6.1412s
Updating learning rate to 0.00028382279278014436
Validation loss decreased (0.2862 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 1.0410912036895752
Epoch: 2, Steps: 262 | Train Loss: 0.3559534 Vali Loss: 0.2850063 Best vali loss: 0.2850063
	iters: 100, epoch: 3 | loss: 0.4697117
	speed: 0.0088s/iter; left time: 12.9282s
	iters: 200, epoch: 3 | loss: 0.5296679
	speed: 0.0034s/iter; left time: 4.6822s
Updating learning rate to 0.0002298843151638862
Validation loss decreased (0.2850 --> 0.2844).  Saving model state dict ...
Epoch: 3 cost time: 0.9469895362854004
Epoch: 3, Steps: 262 | Train Loss: 0.4996898 Vali Loss: 0.2843683 Best vali loss: 0.2843683

best validation loss 0.2843682932982262

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020909985936, 'e_layers': 2, 'learning_rate': 0.0003339214507, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3934419
	speed: 0.0091s/iter; left time: 18.2106s
	iters: 200, epoch: 1 | loss: 0.5825354
	speed: 0.0035s/iter; left time: 6.7146s
Updating learning rate to 0.0003212123222341033
Validation loss decreased (inf --> 0.2866).  Saving model state dict ...
Epoch: 1 cost time: 1.2182633876800537
Epoch: 1, Steps: 262 | Train Loss: 0.4879886 Vali Loss: 0.2865716 Best vali loss: 0.2865716
	iters: 100, epoch: 2 | loss: 0.3863660
	speed: 0.0088s/iter; left time: 15.1854s
	iters: 200, epoch: 2 | loss: 0.3383358
	speed: 0.0037s/iter; left time: 6.0443s
Updating learning rate to 0.0002850197864368097
Validation loss decreased (0.2866 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 1.0312600135803223
Epoch: 2, Steps: 262 | Train Loss: 0.3623509 Vali Loss: 0.2836720 Best vali loss: 0.2836720
	iters: 100, epoch: 3 | loss: 0.4817331
	speed: 0.0090s/iter; left time: 13.3005s
	iters: 200, epoch: 3 | loss: 0.5123457
	speed: 0.0036s/iter; left time: 5.0037s
Updating learning rate to 0.00023085382879710307
Validation loss decreased (0.2837 --> 0.2776).  Saving model state dict ...
Epoch: 3 cost time: 1.0189669132232666
Epoch: 3, Steps: 262 | Train Loss: 0.4970394 Vali Loss: 0.2775666 Best vali loss: 0.2775666

best validation loss 0.2775665553374643

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020909985936, 'e_layers': 2, 'learning_rate': 0.0003339214507, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3185022
	speed: 0.0096s/iter; left time: 11.5746s
	iters: 200, epoch: 4 | loss: 0.3078924
	speed: 0.0036s/iter; left time: 3.9537s
Updating learning rate to 0.00016696072535
Epoch: 4 cost time: 1.219818115234375
Epoch: 4, Steps: 262 | Train Loss: 0.3131973 Vali Loss: 0.2797278 Best vali loss: 0.2775666
	iters: 100, epoch: 5 | loss: 0.2940997
	speed: 0.0084s/iter; left time: 7.9696s
	iters: 200, epoch: 5 | loss: 0.2528356
	speed: 0.0035s/iter; left time: 2.9602s
Updating learning rate to 0.00010306762190289695
Epoch: 5 cost time: 0.9729557037353516
Epoch: 5, Steps: 262 | Train Loss: 0.2734676 Vali Loss: 0.2927046 Best vali loss: 0.2775666
	iters: 100, epoch: 6 | loss: 0.3645218
	speed: 0.0084s/iter; left time: 5.7698s
	iters: 200, epoch: 6 | loss: 0.3699985
	speed: 0.0038s/iter; left time: 2.2207s
Updating learning rate to 4.89016642631903e-05
Epoch: 6 cost time: 1.024379014968872
Epoch: 6, Steps: 262 | Train Loss: 0.3672602 Vali Loss: 0.2976811 Best vali loss: 0.2775666
	iters: 100, epoch: 7 | loss: 0.3984613
	speed: 0.0085s/iter; left time: 3.6188s
	iters: 200, epoch: 7 | loss: 0.2114455
	speed: 0.0036s/iter; left time: 1.1695s
Updating learning rate to 1.2709128465896659e-05
Epoch: 7 cost time: 0.9970593452453613
Epoch: 7, Steps: 262 | Train Loss: 0.3049534 Vali Loss: 0.3056093 Best vali loss: 0.2775666
	iters: 100, epoch: 8 | loss: 0.2274189
	speed: 0.0086s/iter; left time: 1.3952s
	iters: 200, epoch: 8 | loss: 0.2137094
	speed: 0.0036s/iter; left time: 0.2292s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0017740726470947
Epoch: 8, Steps: 262 | Train Loss: 0.2205642 Vali Loss: 0.3041438 Best vali loss: 0.2775666

best validation loss 0.2775665553374643

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021111192172, 'e_layers': 2, 'learning_rate': 0.0003264271259, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3934210
	speed: 0.0091s/iter; left time: 18.1806s
	iters: 200, epoch: 1 | loss: 0.5821256
	speed: 0.0034s/iter; left time: 6.4842s
Updating learning rate to 0.00031400323318774747
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 1.1913228034973145
Epoch: 1, Steps: 262 | Train Loss: 0.4877733 Vali Loss: 0.2821804 Best vali loss: 0.2821804
	iters: 100, epoch: 2 | loss: 0.3800737
	speed: 0.0083s/iter; left time: 14.3404s
	iters: 200, epoch: 2 | loss: 0.3367051
	speed: 0.0035s/iter; left time: 5.6412s
Updating learning rate to 0.0002786229800935625
Validation loss decreased (0.2822 --> 0.2813).  Saving model state dict ...
Epoch: 2 cost time: 0.9542531967163086
Epoch: 2, Steps: 262 | Train Loss: 0.3583894 Vali Loss: 0.2813444 Best vali loss: 0.2813444
	iters: 100, epoch: 3 | loss: 0.4501771
	speed: 0.0086s/iter; left time: 12.6507s
	iters: 200, epoch: 3 | loss: 0.5049127
	speed: 0.0035s/iter; left time: 4.7921s
Updating learning rate to 0.00022567268942824166
Validation loss decreased (0.2813 --> 0.2778).  Saving model state dict ...
Epoch: 3 cost time: 0.9589822292327881
Epoch: 3, Steps: 262 | Train Loss: 0.4775449 Vali Loss: 0.2777781 Best vali loss: 0.2777781
	iters: 100, epoch: 4 | loss: 0.5506208
	speed: 0.0087s/iter; left time: 10.5820s
	iters: 200, epoch: 4 | loss: 0.2626770
	speed: 0.0039s/iter; left time: 4.3661s
Updating learning rate to 0.00016321356295
Epoch: 4 cost time: 1.0790033340454102
Epoch: 4, Steps: 262 | Train Loss: 0.4066489 Vali Loss: 0.2931177 Best vali loss: 0.2777781
	iters: 100, epoch: 5 | loss: 0.2784471
	speed: 0.0087s/iter; left time: 8.2428s
	iters: 200, epoch: 5 | loss: 0.2617029
	speed: 0.0038s/iter; left time: 3.2196s
Updating learning rate to 0.00010075443647175837
Epoch: 5 cost time: 1.0200421810150146
Epoch: 5, Steps: 262 | Train Loss: 0.2700750 Vali Loss: 0.2932466 Best vali loss: 0.2777781
	iters: 100, epoch: 6 | loss: 0.2836023
	speed: 0.0087s/iter; left time: 5.9595s
	iters: 200, epoch: 6 | loss: 0.3315036
	speed: 0.0037s/iter; left time: 2.1983s
Updating learning rate to 4.780414580643756e-05
Epoch: 6 cost time: 1.035724401473999
Epoch: 6, Steps: 262 | Train Loss: 0.3075530 Vali Loss: 0.3030553 Best vali loss: 0.2777781
	iters: 100, epoch: 7 | loss: 0.4288602
	speed: 0.0087s/iter; left time: 3.6797s
	iters: 200, epoch: 7 | loss: 0.2222323
	speed: 0.0037s/iter; left time: 1.2007s
Updating learning rate to 1.242389271225253e-05
Epoch: 7 cost time: 1.0237481594085693
Epoch: 7, Steps: 262 | Train Loss: 0.3255463 Vali Loss: 0.3043559 Best vali loss: 0.2777781
	iters: 100, epoch: 8 | loss: 0.2429392
	speed: 0.0088s/iter; left time: 1.4319s
	iters: 200, epoch: 8 | loss: 0.2329647
	speed: 0.0038s/iter; left time: 0.2422s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.065138339996338
Epoch: 8, Steps: 262 | Train Loss: 0.2379519 Vali Loss: 0.3073203 Best vali loss: 0.2777781

best validation loss 0.277778074239523

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4577011
	speed: 0.0093s/iter; left time: 8.8168s
Updating learning rate to 0.0002345270279
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.7854666709899902
Epoch: 1, Steps: 131 | Train Loss: 0.4577011 Vali Loss: 0.2816915 Best vali loss: 0.2816915
	iters: 100, epoch: 2 | loss: 0.5951143
	speed: 0.0072s/iter; left time: 5.8821s
Updating learning rate to 0.00011726351395
Validation loss decreased (0.2817 --> 0.2770).  Saving model state dict ...
Epoch: 2 cost time: 0.5628607273101807
Epoch: 2, Steps: 131 | Train Loss: 0.5951143 Vali Loss: 0.2770146 Best vali loss: 0.2770146
	iters: 100, epoch: 3 | loss: 0.5799219
	speed: 0.0070s/iter; left time: 4.8002s
Updating learning rate to 5.8631756975e-05
Epoch: 3 cost time: 0.5373969078063965
Epoch: 3, Steps: 131 | Train Loss: 0.5799219 Vali Loss: 0.2855565 Best vali loss: 0.2770146
	iters: 100, epoch: 4 | loss: 0.5567586
	speed: 0.0069s/iter; left time: 3.8193s
Updating learning rate to 2.93158784875e-05
Epoch: 4 cost time: 0.5438385009765625
Epoch: 4, Steps: 131 | Train Loss: 0.5567586 Vali Loss: 0.2903643 Best vali loss: 0.2770146
	iters: 100, epoch: 5 | loss: 0.3849140
	speed: 0.0069s/iter; left time: 2.9440s
Updating learning rate to 1.465793924375e-05
Epoch: 5 cost time: 0.5613799095153809
Epoch: 5, Steps: 131 | Train Loss: 0.3849140 Vali Loss: 0.2937867 Best vali loss: 0.2770146
	iters: 100, epoch: 6 | loss: 0.3367172
	speed: 0.0069s/iter; left time: 2.0385s
Updating learning rate to 7.328969621875e-06
Epoch: 6 cost time: 0.5501184463500977
Epoch: 6, Steps: 131 | Train Loss: 0.3367172 Vali Loss: 0.2910448 Best vali loss: 0.2770146
	iters: 100, epoch: 7 | loss: 0.2865988
	speed: 0.0067s/iter; left time: 1.0859s
Updating learning rate to 3.6644848109375e-06
Epoch: 7 cost time: 0.5231137275695801
Epoch: 7, Steps: 131 | Train Loss: 0.2865988 Vali Loss: 0.2914076 Best vali loss: 0.2770146
	iters: 100, epoch: 8 | loss: 0.4379427
	speed: 0.0066s/iter; left time: 0.2126s
Updating learning rate to 1.83224240546875e-06
Epoch: 8 cost time: 0.5313043594360352
Epoch: 8, Steps: 131 | Train Loss: 0.4379427 Vali Loss: 0.2904636 Best vali loss: 0.2770146

best validation loss 0.2770146230764219

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4577012
	speed: 0.0092s/iter; left time: 8.7378s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.7655718326568604
Epoch: 1, Steps: 131 | Train Loss: 0.4577012 Vali Loss: 0.2816918 Best vali loss: 0.2816918
	iters: 100, epoch: 2 | loss: 0.5944636
	speed: 0.0070s/iter; left time: 5.7364s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2817 --> 0.2767).  Saving model state dict ...
Epoch: 2 cost time: 0.5531396865844727
Epoch: 2, Steps: 131 | Train Loss: 0.5944636 Vali Loss: 0.2766559 Best vali loss: 0.2766559
	iters: 100, epoch: 3 | loss: 0.5829356
	speed: 0.0071s/iter; left time: 4.8948s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.5657968521118164
Epoch: 3, Steps: 131 | Train Loss: 0.5829356 Vali Loss: 0.2819669 Best vali loss: 0.2766559

best validation loss 0.2766558756977708

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4577012
	speed: 0.0092s/iter; left time: 8.6920s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.7670702934265137
Epoch: 1, Steps: 131 | Train Loss: 0.4577012 Vali Loss: 0.2816912 Best vali loss: 0.2816912
	iters: 100, epoch: 2 | loss: 0.5952533
	speed: 0.0067s/iter; left time: 5.4532s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2817 --> 0.2768).  Saving model state dict ...
Epoch: 2 cost time: 0.5198876857757568
Epoch: 2, Steps: 131 | Train Loss: 0.5952533 Vali Loss: 0.2767691 Best vali loss: 0.2767691
	iters: 100, epoch: 3 | loss: 0.5817071
	speed: 0.0069s/iter; left time: 4.7246s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.5537309646606445
Epoch: 3, Steps: 131 | Train Loss: 0.5817071 Vali Loss: 0.2832752 Best vali loss: 0.2767691

best validation loss 0.27676907912112825

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266887129, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4577029
	speed: 0.0095s/iter; left time: 9.0579s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.805908203125
Epoch: 1, Steps: 131 | Train Loss: 0.4577029 Vali Loss: 0.2816924 Best vali loss: 0.2816924
	iters: 100, epoch: 2 | loss: 0.5951616
	speed: 0.0068s/iter; left time: 5.5805s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2817 --> 0.2769).  Saving model state dict ...
Epoch: 2 cost time: 0.5250535011291504
Epoch: 2, Steps: 131 | Train Loss: 0.5951616 Vali Loss: 0.2769422 Best vali loss: 0.2769422
	iters: 100, epoch: 3 | loss: 0.5828624
	speed: 0.0067s/iter; left time: 4.6313s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.5178189277648926
Epoch: 3, Steps: 131 | Train Loss: 0.5828624 Vali Loss: 0.2848183 Best vali loss: 0.2769422

best validation loss 0.2769422334403786

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3713646
	speed: 0.0096s/iter; left time: 5.3549s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.7888286113739014
Epoch: 4, Steps: 131 | Train Loss: 0.3713646 Vali Loss: 0.2920980 Best vali loss: 0.2766559
	iters: 100, epoch: 5 | loss: 0.4774283
	speed: 0.0069s/iter; left time: 2.9463s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.5576627254486084
Epoch: 5, Steps: 131 | Train Loss: 0.4774283 Vali Loss: 0.2844680 Best vali loss: 0.2766559
	iters: 100, epoch: 6 | loss: 0.5171452
	speed: 0.0068s/iter; left time: 2.0102s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.5537214279174805
Epoch: 6, Steps: 131 | Train Loss: 0.5171452 Vali Loss: 0.2874263 Best vali loss: 0.2766559
	iters: 100, epoch: 7 | loss: 0.5058694
	speed: 0.0069s/iter; left time: 1.1219s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.5526103973388672
Epoch: 7, Steps: 131 | Train Loss: 0.5058694 Vali Loss: 0.2895494 Best vali loss: 0.2766559
	iters: 100, epoch: 8 | loss: 0.3762958
	speed: 0.0069s/iter; left time: 0.2198s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.5401356220245361
Epoch: 8, Steps: 131 | Train Loss: 0.3762958 Vali Loss: 0.2911123 Best vali loss: 0.2766559

best validation loss 0.2766558756977708

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010501327088, 'e_layers': 2, 'learning_rate': 9.8836147e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5592117
	speed: 0.0105s/iter; left time: 9.9800s
Updating learning rate to 9.50744201427884e-05
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 0.9309945106506348
Epoch: 1, Steps: 131 | Train Loss: 0.5592117 Vali Loss: 0.2757604 Best vali loss: 0.2757604
	iters: 100, epoch: 2 | loss: 0.3290339
	speed: 0.0089s/iter; left time: 7.2639s
Updating learning rate to 8.436192838502522e-05
Epoch: 2 cost time: 0.7004916667938232
Epoch: 2, Steps: 131 | Train Loss: 0.3290339 Vali Loss: 0.2764146 Best vali loss: 0.2757604
	iters: 100, epoch: 3 | loss: 0.4792618
	speed: 0.0087s/iter; left time: 5.9644s
Updating learning rate to 6.832955148785029e-05
Validation loss decreased (0.2758 --> 0.2725).  Saving model state dict ...
Epoch: 3 cost time: 0.7036542892456055
Epoch: 3, Steps: 131 | Train Loss: 0.4792618 Vali Loss: 0.2725366 Best vali loss: 0.2725366
	iters: 100, epoch: 4 | loss: 0.5833067
	speed: 0.0091s/iter; left time: 5.0550s
Updating learning rate to 4.94180735e-05
Epoch: 4 cost time: 0.7057263851165771
Epoch: 4, Steps: 131 | Train Loss: 0.5833067 Vali Loss: 0.2857858 Best vali loss: 0.2725366
	iters: 100, epoch: 5 | loss: 0.3454476
	speed: 0.0087s/iter; left time: 3.6940s
Updating learning rate to 3.0506595512149717e-05
Epoch: 5 cost time: 0.7041792869567871
Epoch: 5, Steps: 131 | Train Loss: 0.3454476 Vali Loss: 0.2889516 Best vali loss: 0.2725366
	iters: 100, epoch: 6 | loss: 0.3263962
	speed: 0.0087s/iter; left time: 2.5680s
Updating learning rate to 1.447421861497478e-05
Epoch: 6 cost time: 0.7050859928131104
Epoch: 6, Steps: 131 | Train Loss: 0.3263962 Vali Loss: 0.2916262 Best vali loss: 0.2725366
	iters: 100, epoch: 7 | loss: 0.3230782
	speed: 0.0087s/iter; left time: 1.4121s
Updating learning rate to 3.761726857211592e-06
Epoch: 7 cost time: 0.7027542591094971
Epoch: 7, Steps: 131 | Train Loss: 0.3230782 Vali Loss: 0.2968973 Best vali loss: 0.2725366
	iters: 100, epoch: 8 | loss: 0.4237261
	speed: 0.0086s/iter; left time: 0.2749s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6970705986022949
Epoch: 8, Steps: 131 | Train Loss: 0.4237261 Vali Loss: 0.2936840 Best vali loss: 0.2725366

best validation loss 0.27253664774538283

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010726862235, 'e_layers': 2, 'learning_rate': 9.97368368e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5592429
	speed: 0.0104s/iter; left time: 9.8888s
Updating learning rate to 9.594082947846925e-05
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9350841045379639
Epoch: 1, Steps: 131 | Train Loss: 0.5592429 Vali Loss: 0.2757472 Best vali loss: 0.2757472
	iters: 100, epoch: 2 | loss: 0.3290385
	speed: 0.0090s/iter; left time: 7.3228s
Updating learning rate to 8.5130715217688e-05
Epoch: 2 cost time: 0.7065150737762451
Epoch: 2, Steps: 131 | Train Loss: 0.3290385 Vali Loss: 0.2762564 Best vali loss: 0.2757472
	iters: 100, epoch: 3 | loss: 0.4796322
	speed: 0.0087s/iter; left time: 5.9620s
Updating learning rate to 6.89522359199304e-05
Validation loss decreased (0.2757 --> 0.2726).  Saving model state dict ...
Epoch: 3 cost time: 0.7086756229400635
Epoch: 3, Steps: 131 | Train Loss: 0.4796322 Vali Loss: 0.2726443 Best vali loss: 0.2726443
	iters: 100, epoch: 4 | loss: 0.5804220
	speed: 0.0092s/iter; left time: 5.1272s
Updating learning rate to 4.98684184e-05
Epoch: 4 cost time: 0.7134244441986084
Epoch: 4, Steps: 131 | Train Loss: 0.5804220 Vali Loss: 0.2870482 Best vali loss: 0.2726443
	iters: 100, epoch: 5 | loss: 0.3454582
	speed: 0.0088s/iter; left time: 3.7359s
Updating learning rate to 3.078460088006961e-05
Epoch: 5 cost time: 0.7070250511169434
Epoch: 5, Steps: 131 | Train Loss: 0.3454582 Vali Loss: 0.2907607 Best vali loss: 0.2726443
	iters: 100, epoch: 6 | loss: 0.3265180
	speed: 0.0088s/iter; left time: 2.5768s
Updating learning rate to 1.4606121582312003e-05
Epoch: 6 cost time: 0.7042450904846191
Epoch: 6, Steps: 131 | Train Loss: 0.3265180 Vali Loss: 0.2924546 Best vali loss: 0.2726443
	iters: 100, epoch: 7 | loss: 0.3196917
	speed: 0.0087s/iter; left time: 1.4227s
Updating learning rate to 3.7960073215307504e-06
Epoch: 7 cost time: 0.7080278396606445
Epoch: 7, Steps: 131 | Train Loss: 0.3196917 Vali Loss: 0.2980677 Best vali loss: 0.2726443
	iters: 100, epoch: 8 | loss: 0.4198519
	speed: 0.0086s/iter; left time: 0.2764s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.69931960105896
Epoch: 8, Steps: 131 | Train Loss: 0.4198519 Vali Loss: 0.2943332 Best vali loss: 0.2726443

best validation loss 0.27264430277761625

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0054086234225, 'e_layers': 4, 'learning_rate': 0.0037384816456, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5980667
	speed: 0.0118s/iter; left time: 11.2273s
Updating learning rate to 0.0037384816456
Validation loss decreased (inf --> 0.3246).  Saving model state dict ...
Epoch: 1 cost time: 1.033172369003296
Epoch: 1, Steps: 131 | Train Loss: 0.5980667 Vali Loss: 0.3245971 Best vali loss: 0.3245971
	iters: 100, epoch: 2 | loss: 0.5517913
	speed: 0.0096s/iter; left time: 7.8930s
Updating learning rate to 0.0018692408228
Validation loss decreased (0.3246 --> 0.3183).  Saving model state dict ...
Epoch: 2 cost time: 0.7978005409240723
Epoch: 2, Steps: 131 | Train Loss: 0.5517913 Vali Loss: 0.3182753 Best vali loss: 0.3182753
	iters: 100, epoch: 3 | loss: 0.6516255
	speed: 0.0097s/iter; left time: 6.6357s
Updating learning rate to 0.0009346204114
Epoch: 3 cost time: 0.8050050735473633
Epoch: 3, Steps: 131 | Train Loss: 0.6516255 Vali Loss: 0.3219208 Best vali loss: 0.3182753

best validation loss 0.31827529047935504

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021941026171, 'e_layers': 4, 'learning_rate': 0.0004128424428, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3672524
	speed: 0.0104s/iter; left time: 42.3613s
	iters: 200, epoch: 1 | loss: 0.6328798
	speed: 0.0052s/iter; left time: 20.6759s
	iters: 300, epoch: 1 | loss: 0.5930024
	speed: 0.0052s/iter; left time: 20.1440s
	iters: 400, epoch: 1 | loss: 0.5448884
	speed: 0.0052s/iter; left time: 19.5902s
	iters: 500, epoch: 1 | loss: 0.2770797
	speed: 0.0051s/iter; left time: 18.9146s
Updating learning rate to 0.00039712956292744085
Validation loss decreased (inf --> 0.2885).  Saving model state dict ...
Epoch: 1 cost time: 2.963361978530884
Epoch: 1, Steps: 523 | Train Loss: 0.4830206 Vali Loss: 0.2885070 Best vali loss: 0.2885070
	iters: 100, epoch: 2 | loss: 0.6093662
	speed: 0.0100s/iter; left time: 35.6455s
	iters: 200, epoch: 2 | loss: 0.7451113
	speed: 0.0046s/iter; left time: 16.0284s
	iters: 300, epoch: 2 | loss: 0.5779978
	speed: 0.0046s/iter; left time: 15.5173s
	iters: 400, epoch: 2 | loss: 0.3474525
	speed: 0.0046s/iter; left time: 15.0858s
	iters: 500, epoch: 2 | loss: 0.2056871
	speed: 0.0046s/iter; left time: 14.4745s
Updating learning rate to 0.0003523830668327497
Epoch: 2 cost time: 2.451093912124634
Epoch: 2, Steps: 523 | Train Loss: 0.4971230 Vali Loss: 0.2933471 Best vali loss: 0.2885070
	iters: 100, epoch: 3 | loss: 0.3263609
	speed: 0.0102s/iter; left time: 31.0147s
	iters: 200, epoch: 3 | loss: 0.2471077
	speed: 0.0052s/iter; left time: 15.3016s
	iters: 300, epoch: 3 | loss: 0.2236062
	speed: 0.0052s/iter; left time: 14.8113s
	iters: 400, epoch: 3 | loss: 0.3343064
	speed: 0.0051s/iter; left time: 13.9870s
	iters: 500, epoch: 3 | loss: 0.2741371
	speed: 0.0052s/iter; left time: 13.6337s
Updating learning rate to 0.00028541520291834615
Epoch: 3 cost time: 2.752912998199463
Epoch: 3, Steps: 523 | Train Loss: 0.2811037 Vali Loss: 0.3035768 Best vali loss: 0.2885070

best validation loss 0.2885070371778537

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002344630875, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597154
	speed: 0.0103s/iter; left time: 9.7716s
Updating learning rate to 0.0002344630875
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.930978536605835
Epoch: 1, Steps: 131 | Train Loss: 0.5597154 Vali Loss: 0.2756380 Best vali loss: 0.2756380
	iters: 100, epoch: 2 | loss: 0.3270322
	speed: 0.0089s/iter; left time: 7.2743s
Updating learning rate to 0.00011723154375
Validation loss decreased (0.2756 --> 0.2718).  Saving model state dict ...
Epoch: 2 cost time: 0.7072861194610596
Epoch: 2, Steps: 131 | Train Loss: 0.3270322 Vali Loss: 0.2717726 Best vali loss: 0.2717726
	iters: 100, epoch: 3 | loss: 0.4650740
	speed: 0.0090s/iter; left time: 6.1557s
Updating learning rate to 5.8615771875e-05
Epoch: 3 cost time: 0.6982662677764893
Epoch: 3, Steps: 131 | Train Loss: 0.4650740 Vali Loss: 0.2997676 Best vali loss: 0.2717726

best validation loss 0.2717726479324988

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002344630875, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4214261
	speed: 0.0114s/iter; left time: 6.3647s
Updating learning rate to 2.93078859375e-05
Epoch: 4 cost time: 0.9418566226959229
Epoch: 4, Steps: 131 | Train Loss: 0.4214261 Vali Loss: 0.3087658 Best vali loss: 0.2717726
	iters: 100, epoch: 5 | loss: 0.2823890
	speed: 0.0087s/iter; left time: 3.6799s
Updating learning rate to 1.465394296875e-05
Epoch: 5 cost time: 0.6994285583496094
Epoch: 5, Steps: 131 | Train Loss: 0.2823890 Vali Loss: 0.2985739 Best vali loss: 0.2717726
	iters: 100, epoch: 6 | loss: 0.4312645
	speed: 0.0087s/iter; left time: 2.5617s
Updating learning rate to 7.326971484375e-06
Epoch: 6 cost time: 0.703728199005127
Epoch: 6, Steps: 131 | Train Loss: 0.4312645 Vali Loss: 0.3023665 Best vali loss: 0.2717726
	iters: 100, epoch: 7 | loss: 0.4648125
	speed: 0.0087s/iter; left time: 1.4213s
Updating learning rate to 3.6634857421875e-06
Epoch: 7 cost time: 0.700465202331543
Epoch: 7, Steps: 131 | Train Loss: 0.4648125 Vali Loss: 0.2995289 Best vali loss: 0.2717726
	iters: 100, epoch: 8 | loss: 0.3255348
	speed: 0.0086s/iter; left time: 0.2763s
Updating learning rate to 1.83174287109375e-06
Epoch: 8 cost time: 0.7016017436981201
Epoch: 8, Steps: 131 | Train Loss: 0.3255348 Vali Loss: 0.2975997 Best vali loss: 0.2717726

best validation loss 0.2717726479324988

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010349934474, 'e_layers': 3, 'learning_rate': 0.0041414038037, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4773405
	speed: 0.0105s/iter; left time: 20.9417s
	iters: 200, epoch: 1 | loss: 0.5059322
	speed: 0.0043s/iter; left time: 8.1669s
Updating learning rate to 0.0041414038037
Validation loss decreased (inf --> 0.3198).  Saving model state dict ...
Epoch: 1 cost time: 1.3952865600585938
Epoch: 1, Steps: 262 | Train Loss: 0.4916363 Vali Loss: 0.3197978 Best vali loss: 0.3197978
	iters: 100, epoch: 2 | loss: 0.8745965
	speed: 0.0091s/iter; left time: 15.8640s
	iters: 200, epoch: 2 | loss: 0.4007921
	speed: 0.0042s/iter; left time: 6.7922s
Updating learning rate to 0.00207070190185
Epoch: 2 cost time: 1.1220757961273193
Epoch: 2, Steps: 262 | Train Loss: 0.6376943 Vali Loss: 0.3264514 Best vali loss: 0.3197978
	iters: 100, epoch: 3 | loss: 0.4350382
	speed: 0.0092s/iter; left time: 13.5727s
	iters: 200, epoch: 3 | loss: 0.3849781
	speed: 0.0042s/iter; left time: 5.7700s
Updating learning rate to 0.001035350950925
Epoch: 3 cost time: 1.1404235363006592
Epoch: 3, Steps: 262 | Train Loss: 0.4100081 Vali Loss: 0.3229170 Best vali loss: 0.3197978
	iters: 100, epoch: 4 | loss: 0.9416646
	speed: 0.0094s/iter; left time: 11.3236s
	iters: 200, epoch: 4 | loss: 0.9074956
	speed: 0.0042s/iter; left time: 4.6169s
Updating learning rate to 0.0005176754754625
Epoch: 4 cost time: 1.148789405822754
Epoch: 4, Steps: 262 | Train Loss: 0.9245801 Vali Loss: 0.3216294 Best vali loss: 0.3197978
	iters: 100, epoch: 5 | loss: 0.6698264
	speed: 0.0095s/iter; left time: 8.9919s
	iters: 200, epoch: 5 | loss: 0.4035920
	speed: 0.0045s/iter; left time: 3.8169s
Updating learning rate to 0.00025883773773125
Epoch: 5 cost time: 1.2155630588531494
Epoch: 5, Steps: 262 | Train Loss: 0.5367092 Vali Loss: 0.3220316 Best vali loss: 0.3197978
	iters: 100, epoch: 6 | loss: 0.5369121
	speed: 0.0095s/iter; left time: 6.5307s
	iters: 200, epoch: 6 | loss: 0.8402264
	speed: 0.0043s/iter; left time: 2.5290s
Updating learning rate to 0.000129418868865625
Epoch: 6 cost time: 1.15279221534729
Epoch: 6, Steps: 262 | Train Loss: 0.6885692 Vali Loss: 0.3220922 Best vali loss: 0.3197978
	iters: 100, epoch: 7 | loss: 0.6281449
	speed: 0.0092s/iter; left time: 3.9141s
	iters: 200, epoch: 7 | loss: 0.7559292
	speed: 0.0042s/iter; left time: 1.3566s
Updating learning rate to 6.47094344328125e-05
Epoch: 7 cost time: 1.1343741416931152
Epoch: 7, Steps: 262 | Train Loss: 0.6920370 Vali Loss: 0.3221325 Best vali loss: 0.3197978
	iters: 100, epoch: 8 | loss: 0.6374923
	speed: 0.0093s/iter; left time: 1.5204s
	iters: 200, epoch: 8 | loss: 0.6395742
	speed: 0.0042s/iter; left time: 0.2625s
Updating learning rate to 3.235471721640625e-05
Epoch: 8 cost time: 1.1327521800994873
Epoch: 8, Steps: 262 | Train Loss: 0.6385332 Vali Loss: 0.3221459 Best vali loss: 0.3197978

best validation loss 0.3197977970017958

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002340768163, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596894
	speed: 0.0109s/iter; left time: 10.3695s
Updating learning rate to 0.0002340768163
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9344770908355713
Epoch: 1, Steps: 131 | Train Loss: 0.5596894 Vali Loss: 0.2756730 Best vali loss: 0.2756730
	iters: 100, epoch: 2 | loss: 0.3246673
	speed: 0.0089s/iter; left time: 7.2748s
Updating learning rate to 0.00011703840815
Validation loss decreased (0.2757 --> 0.2688).  Saving model state dict ...
Epoch: 2 cost time: 0.7048907279968262
Epoch: 2, Steps: 131 | Train Loss: 0.3246673 Vali Loss: 0.2688056 Best vali loss: 0.2688056
	iters: 100, epoch: 3 | loss: 0.4628629
	speed: 0.0091s/iter; left time: 6.2415s
Updating learning rate to 5.8519204075e-05
Epoch: 3 cost time: 0.7060563564300537
Epoch: 3, Steps: 131 | Train Loss: 0.4628629 Vali Loss: 0.2812051 Best vali loss: 0.2688056
	iters: 100, epoch: 4 | loss: 0.5028346
	speed: 0.0086s/iter; left time: 4.7945s
Updating learning rate to 2.92596020375e-05
Epoch: 4 cost time: 0.6985864639282227
Epoch: 4, Steps: 131 | Train Loss: 0.5028346 Vali Loss: 0.2854942 Best vali loss: 0.2688056
	iters: 100, epoch: 5 | loss: 0.3343298
	speed: 0.0087s/iter; left time: 3.6936s
Updating learning rate to 1.462980101875e-05
Epoch: 5 cost time: 0.7019350528717041
Epoch: 5, Steps: 131 | Train Loss: 0.3343298 Vali Loss: 0.2872857 Best vali loss: 0.2688056
	iters: 100, epoch: 6 | loss: 0.3169556
	speed: 0.0087s/iter; left time: 2.5547s
Updating learning rate to 7.314900509375e-06
Epoch: 6 cost time: 0.7065231800079346
Epoch: 6, Steps: 131 | Train Loss: 0.3169556 Vali Loss: 0.2893462 Best vali loss: 0.2688056
	iters: 100, epoch: 7 | loss: 0.3128564
	speed: 0.0087s/iter; left time: 1.4179s
Updating learning rate to 3.6574502546875e-06
Epoch: 7 cost time: 0.702538251876831
Epoch: 7, Steps: 131 | Train Loss: 0.3128564 Vali Loss: 0.2947618 Best vali loss: 0.2688056
	iters: 100, epoch: 8 | loss: 0.3955491
	speed: 0.0087s/iter; left time: 0.2772s
Updating learning rate to 1.82872512734375e-06
Epoch: 8 cost time: 0.7044596672058105
Epoch: 8, Steps: 131 | Train Loss: 0.3955491 Vali Loss: 0.2951760 Best vali loss: 0.2688056

best validation loss 0.26880564400146956

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0066620060077, 'e_layers': 2, 'learning_rate': 0.0002432971554, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3452262
	speed: 0.0092s/iter; left time: 37.4084s
	iters: 200, epoch: 1 | loss: 0.4142711
	speed: 0.0037s/iter; left time: 14.5615s
	iters: 300, epoch: 1 | loss: 0.3991848
	speed: 0.0037s/iter; left time: 14.2007s
	iters: 400, epoch: 1 | loss: 1.0001227
	speed: 0.0036s/iter; left time: 13.8041s
	iters: 500, epoch: 1 | loss: 0.5718042
	speed: 0.0036s/iter; left time: 13.4490s
Updating learning rate to 0.0002432971554
Validation loss decreased (inf --> 0.2891).  Saving model state dict ...
Epoch: 1 cost time: 2.185993194580078
Epoch: 1, Steps: 523 | Train Loss: 0.7461218 Vali Loss: 0.2890959 Best vali loss: 0.2890959
	iters: 100, epoch: 2 | loss: 0.4769391
	speed: 0.0082s/iter; left time: 29.1103s
	iters: 200, epoch: 2 | loss: 0.3857142
	speed: 0.0036s/iter; left time: 12.3574s
	iters: 300, epoch: 2 | loss: 0.2410651
	speed: 0.0035s/iter; left time: 11.8427s
	iters: 400, epoch: 2 | loss: 0.3799103
	speed: 0.0035s/iter; left time: 11.4452s
	iters: 500, epoch: 2 | loss: 0.5885476
	speed: 0.0036s/iter; left time: 11.2584s
Updating learning rate to 0.0001216485777
Validation loss decreased (0.2891 --> 0.2884).  Saving model state dict ...
Epoch: 2 cost time: 1.8990581035614014
Epoch: 2, Steps: 523 | Train Loss: 0.4144353 Vali Loss: 0.2884129 Best vali loss: 0.2884129
	iters: 100, epoch: 3 | loss: 0.2549127
	speed: 0.0082s/iter; left time: 24.8169s
	iters: 200, epoch: 3 | loss: 0.2284300
	speed: 0.0035s/iter; left time: 10.3552s
	iters: 300, epoch: 3 | loss: 0.2872277
	speed: 0.0034s/iter; left time: 9.6555s
	iters: 400, epoch: 3 | loss: 0.4546383
	speed: 0.0034s/iter; left time: 9.3053s
	iters: 500, epoch: 3 | loss: 0.6592709
	speed: 0.0034s/iter; left time: 8.9162s
Updating learning rate to 6.082428885e-05
Validation loss decreased (0.2884 --> 0.2775).  Saving model state dict ...
Epoch: 3 cost time: 1.838667392730713
Epoch: 3, Steps: 523 | Train Loss: 0.3768959 Vali Loss: 0.2774770 Best vali loss: 0.2774770

best validation loss 0.2774769744938659

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023705568731, 'e_layers': 2, 'learning_rate': 0.0005089322703, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5172853
	speed: 0.0093s/iter; left time: 8.8318s
Updating learning rate to 0.0005089322703
Validation loss decreased (inf --> 0.2960).  Saving model state dict ...
Epoch: 1 cost time: 0.7814536094665527
Epoch: 1, Steps: 131 | Train Loss: 0.5172853 Vali Loss: 0.2960161 Best vali loss: 0.2960161
	iters: 100, epoch: 2 | loss: 0.4568106
	speed: 0.0067s/iter; left time: 5.4709s
Updating learning rate to 0.00025446613515
Validation loss decreased (0.2960 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.5208430290222168
Epoch: 2, Steps: 131 | Train Loss: 0.4568106 Vali Loss: 0.2826565 Best vali loss: 0.2826565
	iters: 100, epoch: 3 | loss: 0.6281806
	speed: 0.0062s/iter; left time: 4.2506s
Updating learning rate to 0.000127233067575
Validation loss decreased (0.2827 --> 0.2810).  Saving model state dict ...
Epoch: 3 cost time: 0.4797194004058838
Epoch: 3, Steps: 131 | Train Loss: 0.6281806 Vali Loss: 0.2810019 Best vali loss: 0.2810019

best validation loss 0.28100187466374205

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0045112835794, 'e_layers': 3, 'learning_rate': 8.90948157e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3181514
	speed: 0.0093s/iter; left time: 76.4534s
	iters: 200, epoch: 1 | loss: 0.4778572
	speed: 0.0039s/iter; left time: 31.6661s
	iters: 300, epoch: 1 | loss: 0.3156026
	speed: 0.0040s/iter; left time: 31.8921s
	iters: 400, epoch: 1 | loss: 1.1844977
	speed: 0.0039s/iter; left time: 30.9229s
	iters: 500, epoch: 1 | loss: 0.7364479
	speed: 0.0037s/iter; left time: 29.1789s
	iters: 600, epoch: 1 | loss: 0.3232661
	speed: 0.0037s/iter; left time: 28.7865s
	iters: 700, epoch: 1 | loss: 0.3860980
	speed: 0.0037s/iter; left time: 28.5881s
	iters: 800, epoch: 1 | loss: 0.4044264
	speed: 0.0037s/iter; left time: 27.9249s
	iters: 900, epoch: 1 | loss: 0.6663031
	speed: 0.0037s/iter; left time: 27.5035s
	iters: 1000, epoch: 1 | loss: 0.3241464
	speed: 0.0037s/iter; left time: 27.4782s
Updating learning rate to 8.90948157e-05
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 4.227464437484741
Epoch: 1, Steps: 1045 | Train Loss: 0.5136797 Vali Loss: 0.2876248 Best vali loss: 0.2876248
	iters: 100, epoch: 2 | loss: 2.3618300
	speed: 0.0119s/iter; left time: 85.9954s
	iters: 200, epoch: 2 | loss: 0.2136225
	speed: 0.0040s/iter; left time: 28.3290s
	iters: 300, epoch: 2 | loss: 0.2772296
	speed: 0.0040s/iter; left time: 27.9725s
	iters: 400, epoch: 2 | loss: 0.4694294
	speed: 0.0040s/iter; left time: 27.5313s
	iters: 500, epoch: 2 | loss: 0.2731828
	speed: 0.0040s/iter; left time: 27.1362s
	iters: 600, epoch: 2 | loss: 0.2994632
	speed: 0.0040s/iter; left time: 26.6572s
	iters: 700, epoch: 2 | loss: 0.3748362
	speed: 0.0040s/iter; left time: 26.4634s
	iters: 800, epoch: 2 | loss: 0.2162757
	speed: 0.0040s/iter; left time: 26.0676s
	iters: 900, epoch: 2 | loss: 0.2877412
	speed: 0.0040s/iter; left time: 25.6633s
	iters: 1000, epoch: 2 | loss: 0.3435017
	speed: 0.0040s/iter; left time: 25.1957s
Updating learning rate to 4.454740785e-05
Validation loss decreased (0.2876 --> 0.2813).  Saving model state dict ...
Epoch: 2 cost time: 4.206640958786011
Epoch: 2, Steps: 1045 | Train Loss: 0.5117112 Vali Loss: 0.2813159 Best vali loss: 0.2813159
	iters: 100, epoch: 3 | loss: 0.4636875
	speed: 0.0113s/iter; left time: 69.9717s
	iters: 200, epoch: 3 | loss: 0.2058809
	speed: 0.0035s/iter; left time: 21.1124s
	iters: 300, epoch: 3 | loss: 0.1795600
	speed: 0.0035s/iter; left time: 20.8695s
	iters: 400, epoch: 3 | loss: 0.3391953
	speed: 0.0035s/iter; left time: 20.4512s
	iters: 500, epoch: 3 | loss: 0.2051664
	speed: 0.0035s/iter; left time: 20.3451s
	iters: 600, epoch: 3 | loss: 0.1987261
	speed: 0.0035s/iter; left time: 19.9229s
	iters: 700, epoch: 3 | loss: 0.4888853
	speed: 0.0036s/iter; left time: 19.8085s
	iters: 800, epoch: 3 | loss: 0.8620837
	speed: 0.0037s/iter; left time: 20.1423s
	iters: 900, epoch: 3 | loss: 0.3060700
	speed: 0.0035s/iter; left time: 18.6510s
	iters: 1000, epoch: 3 | loss: 0.2561518
	speed: 0.0040s/iter; left time: 20.8997s
Updating learning rate to 2.2273703925e-05
Epoch: 3 cost time: 3.8076441287994385
Epoch: 3, Steps: 1045 | Train Loss: 0.3505407 Vali Loss: 0.2832189 Best vali loss: 0.2813159

best validation loss 0.2813159347012744

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0066620060077, 'e_layers': 2, 'learning_rate': 0.0002432971554, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6230798
	speed: 0.0094s/iter; left time: 23.5905s
	iters: 200, epoch: 4 | loss: 0.3759064
	speed: 0.0037s/iter; left time: 8.8737s
	iters: 300, epoch: 4 | loss: 0.3137200
	speed: 0.0037s/iter; left time: 8.4695s
	iters: 400, epoch: 4 | loss: 0.4710164
	speed: 0.0036s/iter; left time: 8.0711s
	iters: 500, epoch: 4 | loss: 0.3114190
	speed: 0.0036s/iter; left time: 7.6978s
Updating learning rate to 3.0412144425e-05
Epoch: 4 cost time: 2.181631088256836
Epoch: 4, Steps: 523 | Train Loss: 0.4190283 Vali Loss: 0.2816216 Best vali loss: 0.2774770
	iters: 100, epoch: 5 | loss: 0.4554412
	speed: 0.0080s/iter; left time: 15.9635s
	iters: 200, epoch: 5 | loss: 0.3231477
	speed: 0.0035s/iter; left time: 6.5939s
	iters: 300, epoch: 5 | loss: 0.2135841
	speed: 0.0033s/iter; left time: 5.8493s
	iters: 400, epoch: 5 | loss: 0.3242483
	speed: 0.0034s/iter; left time: 5.7796s
	iters: 500, epoch: 5 | loss: 0.3903590
	speed: 0.0034s/iter; left time: 5.4944s
Updating learning rate to 1.52060722125e-05
Epoch: 5 cost time: 1.8344392776489258
Epoch: 5, Steps: 523 | Train Loss: 0.3413560 Vali Loss: 0.2890907 Best vali loss: 0.2774770
	iters: 100, epoch: 6 | loss: 0.2467831
	speed: 0.0072s/iter; left time: 10.5938s
	iters: 200, epoch: 6 | loss: 0.1870408
	speed: 0.0030s/iter; left time: 4.1314s
	iters: 300, epoch: 6 | loss: 0.2508914
	speed: 0.0030s/iter; left time: 3.8325s
	iters: 400, epoch: 6 | loss: 0.4079264
	speed: 0.0030s/iter; left time: 3.5534s
	iters: 500, epoch: 6 | loss: 0.5469412
	speed: 0.0030s/iter; left time: 3.2336s
Updating learning rate to 7.60303610625e-06
Epoch: 6 cost time: 1.623032808303833
Epoch: 6, Steps: 523 | Train Loss: 0.3279166 Vali Loss: 0.2877042 Best vali loss: 0.2774770
	iters: 100, epoch: 7 | loss: 0.3434167
	speed: 0.0071s/iter; left time: 6.7061s
	iters: 200, epoch: 7 | loss: 0.3772314
	speed: 0.0031s/iter; left time: 2.5915s
	iters: 300, epoch: 7 | loss: 0.3453906
	speed: 0.0031s/iter; left time: 2.2816s
	iters: 400, epoch: 7 | loss: 0.3795962
	speed: 0.0032s/iter; left time: 2.0829s
	iters: 500, epoch: 7 | loss: 0.2587045
	speed: 0.0033s/iter; left time: 1.8195s
Updating learning rate to 3.801518053125e-06
Epoch: 7 cost time: 1.6850688457489014
Epoch: 7, Steps: 523 | Train Loss: 0.3408679 Vali Loss: 0.2884977 Best vali loss: 0.2774770
	iters: 100, epoch: 8 | loss: 0.3855579
	speed: 0.0078s/iter; left time: 3.2897s
	iters: 200, epoch: 8 | loss: 0.4187565
	speed: 0.0035s/iter; left time: 1.1491s
	iters: 300, epoch: 8 | loss: 0.4674567
	speed: 0.0035s/iter; left time: 0.7928s
	iters: 400, epoch: 8 | loss: 0.3586143
	speed: 0.0035s/iter; left time: 0.4400s
	iters: 500, epoch: 8 | loss: 0.4121836
	speed: 0.0036s/iter; left time: 0.0852s
Updating learning rate to 1.9007590265625e-06
Epoch: 8 cost time: 1.8928210735321045
Epoch: 8, Steps: 523 | Train Loss: 0.4085138 Vali Loss: 0.2901184 Best vali loss: 0.2774770

best validation loss 0.2774769744938659

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023467808343, 'e_layers': 4, 'learning_rate': 0.0005094768122, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5889230
	speed: 0.0110s/iter; left time: 10.3967s
Updating learning rate to 0.0005094768122
Validation loss decreased (inf --> 0.2919).  Saving model state dict ...
Epoch: 1 cost time: 0.9978792667388916
Epoch: 1, Steps: 131 | Train Loss: 0.5889230 Vali Loss: 0.2918821 Best vali loss: 0.2918821
	iters: 100, epoch: 2 | loss: 0.6305618
	speed: 0.0093s/iter; left time: 7.5770s
Updating learning rate to 0.0002547384061
Validation loss decreased (0.2919 --> 0.2857).  Saving model state dict ...
Epoch: 2 cost time: 0.7441370487213135
Epoch: 2, Steps: 131 | Train Loss: 0.6305618 Vali Loss: 0.2856529 Best vali loss: 0.2856529
	iters: 100, epoch: 3 | loss: 0.4300610
	speed: 0.0085s/iter; left time: 5.8305s
Updating learning rate to 0.00012736920305
Validation loss decreased (0.2857 --> 0.2831).  Saving model state dict ...
Epoch: 3 cost time: 0.6930179595947266
Epoch: 3, Steps: 131 | Train Loss: 0.4300610 Vali Loss: 0.2830920 Best vali loss: 0.2830920
	iters: 100, epoch: 4 | loss: 0.5050111
	speed: 0.0088s/iter; left time: 4.9077s
Updating learning rate to 6.3684601525e-05
Validation loss decreased (0.2831 --> 0.2816).  Saving model state dict ...
Epoch: 4 cost time: 0.7589128017425537
Epoch: 4, Steps: 131 | Train Loss: 0.5050111 Vali Loss: 0.2815552 Best vali loss: 0.2815552
	iters: 100, epoch: 5 | loss: 0.5495836
	speed: 0.0091s/iter; left time: 3.8676s
Updating learning rate to 3.18423007625e-05
Epoch: 5 cost time: 0.7511134147644043
Epoch: 5, Steps: 131 | Train Loss: 0.5495836 Vali Loss: 0.2824792 Best vali loss: 0.2815552
	iters: 100, epoch: 6 | loss: 0.3422276
	speed: 0.0087s/iter; left time: 2.5692s
Updating learning rate to 1.592115038125e-05
Epoch: 6 cost time: 0.7189702987670898
Epoch: 6, Steps: 131 | Train Loss: 0.3422276 Vali Loss: 0.2825276 Best vali loss: 0.2815552
	iters: 100, epoch: 7 | loss: 0.3147863
	speed: 0.0087s/iter; left time: 1.4113s
Updating learning rate to 7.960575190625e-06
Epoch: 7 cost time: 0.7195689678192139
Epoch: 7, Steps: 131 | Train Loss: 0.3147863 Vali Loss: 0.2825591 Best vali loss: 0.2815552
	iters: 100, epoch: 8 | loss: 0.3788101
	speed: 0.0092s/iter; left time: 0.2939s
Updating learning rate to 3.9802875953125e-06
Epoch: 8 cost time: 0.7859454154968262
Epoch: 8, Steps: 131 | Train Loss: 0.3788101 Vali Loss: 0.2825441 Best vali loss: 0.2815552

best validation loss 0.2815551986566659

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0053999333419, 'e_layers': 1, 'learning_rate': 0.000191472068, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000191472068
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 0.5019207000732422
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2828455 Best vali loss: 0.2828455
Updating learning rate to 9.5736034e-05
Validation loss decreased (0.2828 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 0.27956485748291016
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2823954 Best vali loss: 0.2823954
Updating learning rate to 4.7868017e-05
Validation loss decreased (0.2824 --> 0.2778).  Saving model state dict ...
Epoch: 3 cost time: 0.2756016254425049
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2778165 Best vali loss: 0.2778165
Updating learning rate to 2.39340085e-05
Epoch: 4 cost time: 0.26930880546569824
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2782791 Best vali loss: 0.2778165
Updating learning rate to 1.196700425e-05
Epoch: 5 cost time: 0.2743370532989502
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2781633 Best vali loss: 0.2778165
Updating learning rate to 5.983502125e-06
Epoch: 6 cost time: 0.27209925651550293
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2782000 Best vali loss: 0.2778165
Updating learning rate to 2.9917510625e-06
Epoch: 7 cost time: 0.2879338264465332
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2782632 Best vali loss: 0.2778165
Updating learning rate to 1.49587553125e-06
Epoch: 8 cost time: 0.2636287212371826
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2782610 Best vali loss: 0.2778165

best validation loss 0.2778164574584805

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0031187896494, 'e_layers': 4, 'learning_rate': 7.71924296e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.42544676861292e-05
Validation loss decreased (inf --> 0.3460).  Saving model state dict ...
Epoch: 1 cost time: 0.6658937931060791
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3459777 Best vali loss: 0.3459777
Updating learning rate to 6.588786001321258e-05
Validation loss decreased (0.3460 --> 0.3321).  Saving model state dict ...
Epoch: 2 cost time: 0.39669036865234375
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3320985 Best vali loss: 0.3320985
Updating learning rate to 5.336634675596428e-05
Validation loss decreased (0.3321 --> 0.3231).  Saving model state dict ...
Epoch: 3 cost time: 0.45465826988220215
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3231320 Best vali loss: 0.3231320

best validation loss 0.32313198138232035

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014397663629, 'e_layers': 1, 'learning_rate': 0.0031943944496, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6539592
	speed: 0.0077s/iter; left time: 63.5294s
	iters: 200, epoch: 1 | loss: 1.4209172
	speed: 0.0025s/iter; left time: 20.3113s
	iters: 300, epoch: 1 | loss: 1.2082692
	speed: 0.0025s/iter; left time: 19.7717s
	iters: 400, epoch: 1 | loss: 1.2481591
	speed: 0.0024s/iter; left time: 19.3306s
	iters: 500, epoch: 1 | loss: 0.4112383
	speed: 0.0024s/iter; left time: 19.1863s
	iters: 600, epoch: 1 | loss: 0.2715108
	speed: 0.0025s/iter; left time: 19.2424s
	iters: 700, epoch: 1 | loss: 0.2076018
	speed: 0.0025s/iter; left time: 18.9305s
	iters: 800, epoch: 1 | loss: 0.2500927
	speed: 0.0025s/iter; left time: 18.6384s
	iters: 900, epoch: 1 | loss: 0.6426197
	speed: 0.0024s/iter; left time: 18.1769s
	iters: 1000, epoch: 1 | loss: 0.2380842
	speed: 0.0024s/iter; left time: 17.9107s
Updating learning rate to 0.0030728150501765487
Validation loss decreased (inf --> 0.3075).  Saving model state dict ...
Epoch: 1 cost time: 2.825592517852783
Epoch: 1, Steps: 1045 | Train Loss: 0.6552452 Vali Loss: 0.3074619 Best vali loss: 0.3074619
	iters: 100, epoch: 2 | loss: 0.4188221
	speed: 0.0081s/iter; left time: 58.6202s
	iters: 200, epoch: 2 | loss: 0.3430218
	speed: 0.0022s/iter; left time: 15.9913s
	iters: 300, epoch: 2 | loss: 0.8343698
	speed: 0.0024s/iter; left time: 16.7951s
	iters: 400, epoch: 2 | loss: 0.8611714
	speed: 0.0024s/iter; left time: 16.5435s
	iters: 500, epoch: 2 | loss: 0.2992823
	speed: 0.0024s/iter; left time: 16.2388s
	iters: 600, epoch: 2 | loss: 0.4284238
	speed: 0.0025s/iter; left time: 16.4736s
	iters: 700, epoch: 2 | loss: 0.3399212
	speed: 0.0024s/iter; left time: 15.9250s
	iters: 800, epoch: 2 | loss: 0.3905440
	speed: 0.0025s/iter; left time: 16.0710s
	iters: 900, epoch: 2 | loss: 0.4443071
	speed: 0.0025s/iter; left time: 15.9123s
	iters: 1000, epoch: 2 | loss: 0.2949897
	speed: 0.0024s/iter; left time: 15.2876s
Updating learning rate to 0.0027265862133484145
Validation loss decreased (0.3075 --> 0.2924).  Saving model state dict ...
Epoch: 2 cost time: 2.5166730880737305
Epoch: 2, Steps: 1045 | Train Loss: 0.4654853 Vali Loss: 0.2924054 Best vali loss: 0.2924054
	iters: 100, epoch: 3 | loss: 0.7071536
	speed: 0.0079s/iter; left time: 48.4984s
	iters: 200, epoch: 3 | loss: 0.2327768
	speed: 0.0024s/iter; left time: 14.6724s
	iters: 300, epoch: 3 | loss: 0.7070599
	speed: 0.0024s/iter; left time: 14.3359s
	iters: 400, epoch: 3 | loss: 0.2888631
	speed: 0.0024s/iter; left time: 14.2806s
	iters: 500, epoch: 3 | loss: 0.3088656
	speed: 0.0024s/iter; left time: 13.7448s
	iters: 600, epoch: 3 | loss: 0.6516097
	speed: 0.0024s/iter; left time: 13.7096s
	iters: 700, epoch: 3 | loss: 0.2505160
	speed: 0.0024s/iter; left time: 13.3540s
	iters: 800, epoch: 3 | loss: 0.8469123
	speed: 0.0024s/iter; left time: 13.2052s
	iters: 900, epoch: 3 | loss: 0.4106319
	speed: 0.0024s/iter; left time: 12.8303s
	iters: 1000, epoch: 3 | loss: 0.3529313
	speed: 0.0024s/iter; left time: 12.5538s
Updating learning rate to 0.0022084181409504603
Epoch: 3 cost time: 2.549907922744751
Epoch: 3, Steps: 1045 | Train Loss: 0.4757320 Vali Loss: 0.3067516 Best vali loss: 0.2924054

best validation loss 0.2924054181012756

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010261202615, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597241
	speed: 0.0105s/iter; left time: 9.9272s
Updating learning rate to 0.0002345378908
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9396722316741943
Epoch: 1, Steps: 131 | Train Loss: 0.5597241 Vali Loss: 0.2756483 Best vali loss: 0.2756483
	iters: 100, epoch: 2 | loss: 0.3250796
	speed: 0.0089s/iter; left time: 7.2830s
Updating learning rate to 0.0001172689454
Validation loss decreased (0.2756 --> 0.2708).  Saving model state dict ...
Epoch: 2 cost time: 0.6977055072784424
Epoch: 2, Steps: 131 | Train Loss: 0.3250796 Vali Loss: 0.2707501 Best vali loss: 0.2707501
	iters: 100, epoch: 3 | loss: 0.4642054
	speed: 0.0090s/iter; left time: 6.1702s
Updating learning rate to 5.86344727e-05
Epoch: 3 cost time: 0.7038578987121582
Epoch: 3, Steps: 131 | Train Loss: 0.4642054 Vali Loss: 0.2870249 Best vali loss: 0.2707501

best validation loss 0.2707501161094047

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010261202615, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4232076
	speed: 0.0109s/iter; left time: 6.0605s
Updating learning rate to 2.931723635e-05
Epoch: 4 cost time: 0.9335718154907227
Epoch: 4, Steps: 131 | Train Loss: 0.4232076 Vali Loss: 0.3110511 Best vali loss: 0.2707501
	iters: 100, epoch: 5 | loss: 0.2817963
	speed: 0.0086s/iter; left time: 3.6367s
Updating learning rate to 1.4658618175e-05
Epoch: 5 cost time: 0.6912333965301514
Epoch: 5, Steps: 131 | Train Loss: 0.2817963 Vali Loss: 0.2992151 Best vali loss: 0.2707501
	iters: 100, epoch: 6 | loss: 0.4357759
	speed: 0.0086s/iter; left time: 2.5320s
Updating learning rate to 7.3293090875e-06
Epoch: 6 cost time: 0.6992659568786621
Epoch: 6, Steps: 131 | Train Loss: 0.4357759 Vali Loss: 0.3015196 Best vali loss: 0.2707501
	iters: 100, epoch: 7 | loss: 0.4671029
	speed: 0.0086s/iter; left time: 1.3957s
Updating learning rate to 3.66465454375e-06
Epoch: 7 cost time: 0.6949145793914795
Epoch: 7, Steps: 131 | Train Loss: 0.4671029 Vali Loss: 0.3017730 Best vali loss: 0.2707501
	iters: 100, epoch: 8 | loss: 0.3257418
	speed: 0.0086s/iter; left time: 0.2747s
Updating learning rate to 1.832327271875e-06
Epoch: 8 cost time: 0.6970138549804688
Epoch: 8, Steps: 131 | Train Loss: 0.3257418 Vali Loss: 0.2980330 Best vali loss: 0.2707501

best validation loss 0.2707501161094047

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0019173691495, 'e_layers': 2, 'learning_rate': 0.0044501839857, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4031003
	speed: 0.0089s/iter; left time: 36.2338s
	iters: 200, epoch: 1 | loss: 0.3983169
	speed: 0.0032s/iter; left time: 12.8057s
	iters: 300, epoch: 1 | loss: 0.2448115
	speed: 0.0032s/iter; left time: 12.5038s
	iters: 400, epoch: 1 | loss: 1.3719172
	speed: 0.0032s/iter; left time: 12.2275s
	iters: 500, epoch: 1 | loss: 0.3003567
	speed: 0.0033s/iter; left time: 12.0341s
Updating learning rate to 0.0044501839857
Validation loss decreased (inf --> 0.3235).  Saving model state dict ...
Epoch: 1 cost time: 1.9787213802337646
Epoch: 1, Steps: 523 | Train Loss: 0.5437005 Vali Loss: 0.3234511 Best vali loss: 0.3234511
	iters: 100, epoch: 2 | loss: 0.7881393
	speed: 0.0070s/iter; left time: 25.0263s
	iters: 200, epoch: 2 | loss: 0.3511676
	speed: 0.0031s/iter; left time: 10.7094s
	iters: 300, epoch: 2 | loss: 0.5439186
	speed: 0.0030s/iter; left time: 10.0550s
	iters: 400, epoch: 2 | loss: 1.1144353
	speed: 0.0030s/iter; left time: 9.7884s
	iters: 500, epoch: 2 | loss: 0.2894056
	speed: 0.0030s/iter; left time: 9.4574s
Updating learning rate to 0.00222509199285
Validation loss decreased (0.3235 --> 0.3208).  Saving model state dict ...
Epoch: 2 cost time: 1.6293444633483887
Epoch: 2, Steps: 523 | Train Loss: 0.6174133 Vali Loss: 0.3207625 Best vali loss: 0.3207625
	iters: 100, epoch: 3 | loss: 0.5181218
	speed: 0.0069s/iter; left time: 21.0825s
	iters: 200, epoch: 3 | loss: 0.4895590
	speed: 0.0029s/iter; left time: 8.6241s
	iters: 300, epoch: 3 | loss: 0.5501577
	speed: 0.0034s/iter; left time: 9.5945s
	iters: 400, epoch: 3 | loss: 0.7535497
	speed: 0.0033s/iter; left time: 9.0060s
	iters: 500, epoch: 3 | loss: 0.4289495
	speed: 0.0032s/iter; left time: 8.4482s
Updating learning rate to 0.001112545996425
Epoch: 3 cost time: 1.6898458003997803
Epoch: 3, Steps: 523 | Train Loss: 0.5480676 Vali Loss: 0.3208045 Best vali loss: 0.3207625
	iters: 100, epoch: 4 | loss: 0.4125985
	speed: 0.0073s/iter; left time: 18.2836s
	iters: 200, epoch: 4 | loss: 0.4062365
	speed: 0.0035s/iter; left time: 8.4701s
	iters: 300, epoch: 4 | loss: 0.3956552
	speed: 0.0034s/iter; left time: 7.9664s
	iters: 400, epoch: 4 | loss: 0.7347637
	speed: 0.0034s/iter; left time: 7.6310s
	iters: 500, epoch: 4 | loss: 0.9133127
	speed: 0.0035s/iter; left time: 7.4284s
Updating learning rate to 0.0005562729982125
Validation loss decreased (0.3208 --> 0.3205).  Saving model state dict ...
Epoch: 4 cost time: 1.854710340499878
Epoch: 4, Steps: 523 | Train Loss: 0.5725133 Vali Loss: 0.3205388 Best vali loss: 0.3205388
	iters: 100, epoch: 5 | loss: 0.3705877
	speed: 0.0070s/iter; left time: 14.0470s
	iters: 200, epoch: 5 | loss: 0.8546126
	speed: 0.0028s/iter; left time: 5.3788s
	iters: 300, epoch: 5 | loss: 1.0373305
	speed: 0.0029s/iter; left time: 5.1426s
	iters: 400, epoch: 5 | loss: 0.4588912
	speed: 0.0029s/iter; left time: 4.8444s
	iters: 500, epoch: 5 | loss: 0.3869751
	speed: 0.0029s/iter; left time: 4.5534s
Updating learning rate to 0.00027813649910625
Validation loss decreased (0.3205 --> 0.3144).  Saving model state dict ...
Epoch: 5 cost time: 1.5389721393585205
Epoch: 5, Steps: 523 | Train Loss: 0.6216794 Vali Loss: 0.3144395 Best vali loss: 0.3144395
	iters: 100, epoch: 6 | loss: 0.3339910
	speed: 0.0070s/iter; left time: 10.2753s
	iters: 200, epoch: 6 | loss: 0.9024146
	speed: 0.0032s/iter; left time: 4.3948s
	iters: 300, epoch: 6 | loss: 0.2971385
	speed: 0.0032s/iter; left time: 4.0785s
	iters: 400, epoch: 6 | loss: 0.5737346
	speed: 0.0032s/iter; left time: 3.7410s
	iters: 500, epoch: 6 | loss: 0.5959730
	speed: 0.0033s/iter; left time: 3.5583s
Updating learning rate to 0.000139068249553125
Epoch: 6 cost time: 1.7327756881713867
Epoch: 6, Steps: 523 | Train Loss: 0.5406504 Vali Loss: 0.3176177 Best vali loss: 0.3144395
	iters: 100, epoch: 7 | loss: 0.7905294
	speed: 0.0077s/iter; left time: 7.2931s
	iters: 200, epoch: 7 | loss: 0.8011943
	speed: 0.0036s/iter; left time: 3.0104s
	iters: 300, epoch: 7 | loss: 0.4029736
	speed: 0.0036s/iter; left time: 2.6844s
	iters: 400, epoch: 7 | loss: 1.1053569
	speed: 0.0036s/iter; left time: 2.3214s
	iters: 500, epoch: 7 | loss: 0.4159534
	speed: 0.0032s/iter; left time: 1.7733s
Updating learning rate to 6.95341247765625e-05
Epoch: 7 cost time: 1.8757872581481934
Epoch: 7, Steps: 523 | Train Loss: 0.7032015 Vali Loss: 0.3153216 Best vali loss: 0.3144395
	iters: 100, epoch: 8 | loss: 0.4464121
	speed: 0.0069s/iter; left time: 2.9221s
	iters: 200, epoch: 8 | loss: 0.4361826
	speed: 0.0031s/iter; left time: 0.9998s
	iters: 300, epoch: 8 | loss: 0.2494922
	speed: 0.0032s/iter; left time: 0.7189s
	iters: 400, epoch: 8 | loss: 0.2811986
	speed: 0.0032s/iter; left time: 0.3935s
	iters: 500, epoch: 8 | loss: 0.5674174
	speed: 0.0032s/iter; left time: 0.0767s
Updating learning rate to 3.476706238828125e-05
Validation loss decreased (0.3144 --> 0.3137).  Saving model state dict ...
Epoch: 8 cost time: 1.6787242889404297
Epoch: 8, Steps: 523 | Train Loss: 0.3961406 Vali Loss: 0.3137375 Best vali loss: 0.3137375

best validation loss 0.31373749277147495

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0083998983175, 'e_layers': 3, 'learning_rate': 0.0002256345866, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002256345866
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 0.813471794128418
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2779455 Best vali loss: 0.2779455
Updating learning rate to 0.0001128172933
Validation loss decreased (0.2779 --> 0.2771).  Saving model state dict ...
Epoch: 2 cost time: 0.588437557220459
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2771257 Best vali loss: 0.2771257
Updating learning rate to 5.640864665e-05
Validation loss decreased (0.2771 --> 0.2750).  Saving model state dict ...
Epoch: 3 cost time: 0.5896308422088623
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2749628 Best vali loss: 0.2749628
Updating learning rate to 2.8204323325e-05
Epoch: 4 cost time: 0.590040922164917
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2793796 Best vali loss: 0.2749628
Updating learning rate to 1.41021616625e-05
Epoch: 5 cost time: 0.5869953632354736
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2792388 Best vali loss: 0.2749628
Updating learning rate to 7.05108083125e-06
Epoch: 6 cost time: 0.5919296741485596
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2812060 Best vali loss: 0.2749628
Updating learning rate to 3.525540415625e-06
Epoch: 7 cost time: 0.5884220600128174
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2814604 Best vali loss: 0.2749628
Updating learning rate to 1.7627702078125e-06
Epoch: 8 cost time: 0.5947742462158203
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2819648 Best vali loss: 0.2749628

best validation loss 0.2749628260449079

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0083722724802, 'e_layers': 2, 'learning_rate': 0.0002277647134, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8032414
	speed: 0.0087s/iter; left time: 35.4104s
	iters: 200, epoch: 1 | loss: 0.3628525
	speed: 0.0034s/iter; left time: 13.5383s
	iters: 300, epoch: 1 | loss: 0.7148328
	speed: 0.0034s/iter; left time: 13.1360s
	iters: 400, epoch: 1 | loss: 0.5239318
	speed: 0.0034s/iter; left time: 12.7944s
	iters: 500, epoch: 1 | loss: 0.2201218
	speed: 0.0034s/iter; left time: 12.5158s
Updating learning rate to 0.0002277647134
Validation loss decreased (inf --> 0.2818).  Saving model state dict ...
Epoch: 1 cost time: 2.0275614261627197
Epoch: 1, Steps: 523 | Train Loss: 0.5249960 Vali Loss: 0.2818226 Best vali loss: 0.2818226
	iters: 100, epoch: 2 | loss: 0.6059073
	speed: 0.0073s/iter; left time: 26.1605s
	iters: 200, epoch: 2 | loss: 0.2278540
	speed: 0.0034s/iter; left time: 11.6832s
	iters: 300, epoch: 2 | loss: 0.8718393
	speed: 0.0033s/iter; left time: 11.2424s
	iters: 400, epoch: 2 | loss: 0.5222848
	speed: 0.0034s/iter; left time: 10.9935s
	iters: 500, epoch: 2 | loss: 0.3973358
	speed: 0.0033s/iter; left time: 10.5507s
Updating learning rate to 0.0001138823567
Validation loss decreased (0.2818 --> 0.2786).  Saving model state dict ...
Epoch: 2 cost time: 1.8016228675842285
Epoch: 2, Steps: 523 | Train Loss: 0.5250442 Vali Loss: 0.2785708 Best vali loss: 0.2785708
	iters: 100, epoch: 3 | loss: 0.3337969
	speed: 0.0072s/iter; left time: 21.7482s
	iters: 200, epoch: 3 | loss: 0.2551608
	speed: 0.0030s/iter; left time: 8.7405s
	iters: 300, epoch: 3 | loss: 0.3433638
	speed: 0.0031s/iter; left time: 8.7533s
	iters: 400, epoch: 3 | loss: 0.4215407
	speed: 0.0032s/iter; left time: 8.8037s
	iters: 500, epoch: 3 | loss: 0.3431267
	speed: 0.0033s/iter; left time: 8.8273s
Updating learning rate to 5.694117835e-05
Epoch: 3 cost time: 1.6770596504211426
Epoch: 3, Steps: 523 | Train Loss: 0.3393978 Vali Loss: 0.2791209 Best vali loss: 0.2785708

best validation loss 0.2785708197333991

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.004180663354, 'e_layers': 4, 'learning_rate': 0.0004564896447, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4191338
	speed: 0.0103s/iter; left time: 42.2384s
	iters: 200, epoch: 1 | loss: 0.3737154
	speed: 0.0051s/iter; left time: 20.3785s
	iters: 300, epoch: 1 | loss: 0.5684789
	speed: 0.0051s/iter; left time: 19.9768s
	iters: 400, epoch: 1 | loss: 0.9044980
	speed: 0.0052s/iter; left time: 19.5911s
	iters: 500, epoch: 1 | loss: 0.2361485
	speed: 0.0052s/iter; left time: 19.1975s
Updating learning rate to 0.0004391155421208397
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 2.9570915699005127
Epoch: 1, Steps: 523 | Train Loss: 0.5003949 Vali Loss: 0.2800387 Best vali loss: 0.2800387
	iters: 100, epoch: 2 | loss: 0.4444616
	speed: 0.0101s/iter; left time: 35.9690s
	iters: 200, epoch: 2 | loss: 0.3536314
	speed: 0.0049s/iter; left time: 17.0242s
	iters: 300, epoch: 2 | loss: 0.3257227
	speed: 0.0049s/iter; left time: 16.5776s
	iters: 400, epoch: 2 | loss: 0.3924193
	speed: 0.0050s/iter; left time: 16.1889s
	iters: 500, epoch: 2 | loss: 0.5613514
	speed: 0.0051s/iter; left time: 15.9735s
Updating learning rate to 0.00038963828400440386
Validation loss decreased (0.2800 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 2.637181282043457
Epoch: 2, Steps: 523 | Train Loss: 0.4155173 Vali Loss: 0.2793513 Best vali loss: 0.2793513
	iters: 100, epoch: 3 | loss: 0.8146272
	speed: 0.0102s/iter; left time: 30.8872s
	iters: 200, epoch: 3 | loss: 0.3403864
	speed: 0.0050s/iter; left time: 14.6931s
	iters: 300, epoch: 3 | loss: 0.2231025
	speed: 0.0051s/iter; left time: 14.3605s
	iters: 400, epoch: 3 | loss: 0.7715626
	speed: 0.0050s/iter; left time: 13.6996s
	iters: 500, epoch: 3 | loss: 0.5079806
	speed: 0.0050s/iter; left time: 13.2469s
Updating learning rate to 0.00031559033438645817
Epoch: 3 cost time: 2.6658833026885986
Epoch: 3, Steps: 523 | Train Loss: 0.5315319 Vali Loss: 0.2866010 Best vali loss: 0.2793513

best validation loss 0.27935127610830446

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010268749268, 'e_layers': 2, 'learning_rate': 0.0002401344177, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5603787
	speed: 0.0104s/iter; left time: 9.9009s
Updating learning rate to 0.0002401344177
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9297478199005127
Epoch: 1, Steps: 131 | Train Loss: 0.5603787 Vali Loss: 0.2756895 Best vali loss: 0.2756895
	iters: 100, epoch: 2 | loss: 0.3244953
	speed: 0.0089s/iter; left time: 7.3031s
Updating learning rate to 0.00012006720885
Validation loss decreased (0.2757 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.7018024921417236
Epoch: 2, Steps: 131 | Train Loss: 0.3244953 Vali Loss: 0.2723417 Best vali loss: 0.2723417
	iters: 100, epoch: 3 | loss: 0.4588074
	speed: 0.0091s/iter; left time: 6.2517s
Updating learning rate to 6.0033604425e-05
Epoch: 3 cost time: 0.7025980949401855
Epoch: 3, Steps: 131 | Train Loss: 0.4588074 Vali Loss: 0.2826466 Best vali loss: 0.2723417

best validation loss 0.2723416927890203

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010268749268, 'e_layers': 2, 'learning_rate': 0.0002401344177, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4231568
	speed: 0.0106s/iter; left time: 5.8869s
Updating learning rate to 3.00168022125e-05
Epoch: 4 cost time: 0.9212980270385742
Epoch: 4, Steps: 131 | Train Loss: 0.4231568 Vali Loss: 0.3020346 Best vali loss: 0.2723417
	iters: 100, epoch: 5 | loss: 0.2852554
	speed: 0.0087s/iter; left time: 3.6791s
Updating learning rate to 1.500840110625e-05
Epoch: 5 cost time: 0.6973285675048828
Epoch: 5, Steps: 131 | Train Loss: 0.2852554 Vali Loss: 0.3032185 Best vali loss: 0.2723417
	iters: 100, epoch: 6 | loss: 0.4340703
	speed: 0.0086s/iter; left time: 2.5319s
Updating learning rate to 7.504200553125e-06
Epoch: 6 cost time: 0.6974329948425293
Epoch: 6, Steps: 131 | Train Loss: 0.4340703 Vali Loss: 0.3028546 Best vali loss: 0.2723417
	iters: 100, epoch: 7 | loss: 0.4652506
	speed: 0.0086s/iter; left time: 1.4068s
Updating learning rate to 3.7521002765625e-06
Epoch: 7 cost time: 0.6952981948852539
Epoch: 7, Steps: 131 | Train Loss: 0.4652506 Vali Loss: 0.3048364 Best vali loss: 0.2723417
	iters: 100, epoch: 8 | loss: 0.3242418
	speed: 0.0086s/iter; left time: 0.2761s
Updating learning rate to 1.87605013828125e-06
Epoch: 8 cost time: 0.7046911716461182
Epoch: 8, Steps: 131 | Train Loss: 0.3242418 Vali Loss: 0.3019829 Best vali loss: 0.2723417

best validation loss 0.2723416927890203

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0100911124881, 'e_layers': 1, 'learning_rate': 5.98940094e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7763897
	speed: 0.0075s/iter; left time: 7.0759s
Updating learning rate to 5.7614429402349304e-05
Validation loss decreased (inf --> 0.3342).  Saving model state dict ...
Epoch: 1 cost time: 0.6304488182067871
Epoch: 1, Steps: 131 | Train Loss: 0.7763897 Vali Loss: 0.3342277 Best vali loss: 0.3342277
	iters: 100, epoch: 2 | loss: 0.5548863
	speed: 0.0051s/iter; left time: 4.1884s
Updating learning rate to 5.1122734799595406e-05
Validation loss decreased (0.3342 --> 0.3163).  Saving model state dict ...
Epoch: 2 cost time: 0.3795053958892822
Epoch: 2, Steps: 131 | Train Loss: 0.5548863 Vali Loss: 0.3163189 Best vali loss: 0.3163189
	iters: 100, epoch: 3 | loss: 0.8710089
	speed: 0.0051s/iter; left time: 3.5202s
Updating learning rate to 4.1407227247649475e-05
Validation loss decreased (0.3163 --> 0.3061).  Saving model state dict ...
Epoch: 3 cost time: 0.38799500465393066
Epoch: 3, Steps: 131 | Train Loss: 0.8710089 Vali Loss: 0.3060546 Best vali loss: 0.3060546
	iters: 100, epoch: 4 | loss: 0.4860876
	speed: 0.0051s/iter; left time: 2.8224s
Updating learning rate to 2.99470047e-05
Validation loss decreased (0.3061 --> 0.3003).  Saving model state dict ...
Epoch: 4 cost time: 0.3863036632537842
Epoch: 4, Steps: 131 | Train Loss: 0.4860876 Vali Loss: 0.3003121 Best vali loss: 0.3003121
	iters: 100, epoch: 5 | loss: 0.6489555
	speed: 0.0050s/iter; left time: 2.1284s
Updating learning rate to 1.8486782152350525e-05
Validation loss decreased (0.3003 --> 0.2970).  Saving model state dict ...
Epoch: 5 cost time: 0.3919999599456787
Epoch: 5, Steps: 131 | Train Loss: 0.6489555 Vali Loss: 0.2970420 Best vali loss: 0.2970420
	iters: 100, epoch: 6 | loss: 0.3647217
	speed: 0.0050s/iter; left time: 1.4589s
Updating learning rate to 8.77127460040459e-06
Validation loss decreased (0.2970 --> 0.2953).  Saving model state dict ...
Epoch: 6 cost time: 0.37735438346862793
Epoch: 6, Steps: 131 | Train Loss: 0.3647217 Vali Loss: 0.2953134 Best vali loss: 0.2953134
	iters: 100, epoch: 7 | loss: 0.6063953
	speed: 0.0050s/iter; left time: 0.8188s
Updating learning rate to 2.279579997650693e-06
Validation loss decreased (0.2953 --> 0.2946).  Saving model state dict ...
Epoch: 7 cost time: 0.38203883171081543
Epoch: 7, Steps: 131 | Train Loss: 0.6063953 Vali Loss: 0.2945515 Best vali loss: 0.2945515
	iters: 100, epoch: 8 | loss: 0.3299376
	speed: 0.0050s/iter; left time: 0.1611s
Updating learning rate to 0.0
Validation loss decreased (0.2946 --> 0.2943).  Saving model state dict ...
Epoch: 8 cost time: 0.3870551586151123
Epoch: 8, Steps: 131 | Train Loss: 0.3299376 Vali Loss: 0.2943481 Best vali loss: 0.2943481

best validation loss 0.2943480828795658

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010256721933, 'e_layers': 2, 'learning_rate': 0.0002344823981, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597218
	speed: 0.0098s/iter; left time: 9.3457s
Updating learning rate to 0.00022555794321937672
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9408981800079346
Epoch: 1, Steps: 131 | Train Loss: 0.5597218 Vali Loss: 0.2756534 Best vali loss: 0.2756534
	iters: 100, epoch: 2 | loss: 0.3253003
	speed: 0.0088s/iter; left time: 7.2361s
Updating learning rate to 0.00020014324593269683
Validation loss decreased (0.2757 --> 0.2717).  Saving model state dict ...
Epoch: 2 cost time: 0.7044246196746826
Epoch: 2, Steps: 131 | Train Loss: 0.3253003 Vali Loss: 0.2716847 Best vali loss: 0.2716847
	iters: 100, epoch: 3 | loss: 0.4698809
	speed: 0.0091s/iter; left time: 6.2537s
Updating learning rate to 0.00016210746351705271
Epoch: 3 cost time: 0.7050561904907227
Epoch: 3, Steps: 131 | Train Loss: 0.4698809 Vali Loss: 0.3048527 Best vali loss: 0.2716847
	iters: 100, epoch: 4 | loss: 0.4868093
	speed: 0.0086s/iter; left time: 4.7604s
Updating learning rate to 0.00011724119905
Epoch: 4 cost time: 0.6948511600494385
Epoch: 4, Steps: 131 | Train Loss: 0.4868093 Vali Loss: 0.2783388 Best vali loss: 0.2716847
	iters: 100, epoch: 5 | loss: 0.3356953
	speed: 0.0086s/iter; left time: 3.6570s
Updating learning rate to 7.237493458294731e-05
Epoch: 5 cost time: 0.6933341026306152
Epoch: 5, Steps: 131 | Train Loss: 0.3356953 Vali Loss: 0.2977876 Best vali loss: 0.2716847
	iters: 100, epoch: 6 | loss: 0.3115215
	speed: 0.0086s/iter; left time: 2.5372s
Updating learning rate to 3.43391521673032e-05
Epoch: 6 cost time: 0.693913459777832
Epoch: 6, Steps: 131 | Train Loss: 0.3115215 Vali Loss: 0.3093906 Best vali loss: 0.2716847
	iters: 100, epoch: 7 | loss: 0.2850581
	speed: 0.0086s/iter; left time: 1.4078s
Updating learning rate to 8.924454880623285e-06
Epoch: 7 cost time: 0.7036828994750977
Epoch: 7, Steps: 131 | Train Loss: 0.2850581 Vali Loss: 0.3055176 Best vali loss: 0.2716847
	iters: 100, epoch: 8 | loss: 0.3438487
	speed: 0.0087s/iter; left time: 0.2778s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6974239349365234
Epoch: 8, Steps: 131 | Train Loss: 0.3438487 Vali Loss: 0.3078585 Best vali loss: 0.2716847

best validation loss 0.2716847045264664

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0016923026973, 'e_layers': 2, 'learning_rate': 0.0009969939256, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7054808
	speed: 0.0091s/iter; left time: 18.1497s
	iters: 200, epoch: 1 | loss: 0.7833430
	speed: 0.0037s/iter; left time: 7.0198s
Updating learning rate to 0.0009969939256
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 1.2291784286499023
Epoch: 1, Steps: 262 | Train Loss: 0.7444119 Vali Loss: 0.2846240 Best vali loss: 0.2846240
	iters: 100, epoch: 2 | loss: 0.2994973
	speed: 0.0080s/iter; left time: 13.8669s
	iters: 200, epoch: 2 | loss: 0.4529901
	speed: 0.0035s/iter; left time: 5.7553s
Updating learning rate to 0.0004984969628
Epoch: 2 cost time: 0.9636664390563965
Epoch: 2, Steps: 262 | Train Loss: 0.3762437 Vali Loss: 0.2882317 Best vali loss: 0.2846240
	iters: 100, epoch: 3 | loss: 0.3078838
	speed: 0.0082s/iter; left time: 12.0627s
	iters: 200, epoch: 3 | loss: 0.7081807
	speed: 0.0035s/iter; left time: 4.8256s
Updating learning rate to 0.0002492484814
Epoch: 3 cost time: 0.9925918579101562
Epoch: 3, Steps: 262 | Train Loss: 0.5080322 Vali Loss: 0.2896088 Best vali loss: 0.2846240

best validation loss 0.2846239995960854

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008394487324, 'e_layers': 3, 'learning_rate': 9.33016171e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3970679
	speed: 0.0085s/iter; left time: 34.8514s
	iters: 200, epoch: 1 | loss: 0.2990887
	speed: 0.0040s/iter; left time: 15.9863s
	iters: 300, epoch: 1 | loss: 0.5402588
	speed: 0.0040s/iter; left time: 15.5422s
	iters: 400, epoch: 1 | loss: 0.6875816
	speed: 0.0040s/iter; left time: 15.1291s
	iters: 500, epoch: 1 | loss: 0.8412048
	speed: 0.0040s/iter; left time: 14.8189s
Updating learning rate to 8.975053574444754e-05
Validation loss decreased (inf --> 0.2920).  Saving model state dict ...
Epoch: 1 cost time: 2.3549904823303223
Epoch: 1, Steps: 523 | Train Loss: 0.5530404 Vali Loss: 0.2919796 Best vali loss: 0.2919796
	iters: 100, epoch: 2 | loss: 0.4087084
	speed: 0.0085s/iter; left time: 30.3603s
	iters: 200, epoch: 2 | loss: 0.8400221
	speed: 0.0039s/iter; left time: 13.4402s
	iters: 300, epoch: 2 | loss: 0.3621643
	speed: 0.0039s/iter; left time: 13.2370s
	iters: 400, epoch: 2 | loss: 0.5137113
	speed: 0.0039s/iter; left time: 12.8177s
	iters: 500, epoch: 2 | loss: 0.7453316
	speed: 0.0039s/iter; left time: 12.3380s
Updating learning rate to 7.963791162354037e-05
Validation loss decreased (0.2920 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 2.0946202278137207
Epoch: 2, Steps: 523 | Train Loss: 0.5739875 Vali Loss: 0.2818793 Best vali loss: 0.2818793
	iters: 100, epoch: 3 | loss: 0.4748165
	speed: 0.0086s/iter; left time: 26.1278s
	iters: 200, epoch: 3 | loss: 0.5136681
	speed: 0.0042s/iter; left time: 12.4593s
	iters: 300, epoch: 3 | loss: 0.2431782
	speed: 0.0042s/iter; left time: 11.9664s
	iters: 400, epoch: 3 | loss: 0.2449029
	speed: 0.0043s/iter; left time: 11.7017s
	iters: 500, epoch: 3 | loss: 0.4013537
	speed: 0.0042s/iter; left time: 11.1401s
Updating learning rate to 6.450330008852069e-05
Validation loss decreased (0.2819 --> 0.2817).  Saving model state dict ...
Epoch: 3 cost time: 2.253847122192383
Epoch: 3, Steps: 523 | Train Loss: 0.3755839 Vali Loss: 0.2816828 Best vali loss: 0.2816828

best validation loss 0.28168281076033347

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008494282282, 'e_layers': 2, 'learning_rate': 0.0002368468104, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5599092
	speed: 0.0107s/iter; left time: 10.1411s
Updating learning rate to 0.0002368468104
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9357669353485107
Epoch: 1, Steps: 131 | Train Loss: 0.5599092 Vali Loss: 0.2756846 Best vali loss: 0.2756846
	iters: 100, epoch: 2 | loss: 0.3242921
	speed: 0.0089s/iter; left time: 7.2611s
Updating learning rate to 0.0001184234052
Validation loss decreased (0.2757 --> 0.2716).  Saving model state dict ...
Epoch: 2 cost time: 0.6969077587127686
Epoch: 2, Steps: 131 | Train Loss: 0.3242921 Vali Loss: 0.2715919 Best vali loss: 0.2715919
	iters: 100, epoch: 3 | loss: 0.4633231
	speed: 0.0090s/iter; left time: 6.1958s
Updating learning rate to 5.92117026e-05
Epoch: 3 cost time: 0.6954903602600098
Epoch: 3, Steps: 131 | Train Loss: 0.4633231 Vali Loss: 0.2781755 Best vali loss: 0.2715919

best validation loss 0.27159188779236526

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008494282282, 'e_layers': 2, 'learning_rate': 0.0002368468104, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4238327
	speed: 0.0103s/iter; left time: 5.7111s
Updating learning rate to 2.96058513e-05
Epoch: 4 cost time: 0.9567444324493408
Epoch: 4, Steps: 131 | Train Loss: 0.4238327 Vali Loss: 0.3066239 Best vali loss: 0.2715919
	iters: 100, epoch: 5 | loss: 0.2836271
	speed: 0.0089s/iter; left time: 3.7686s
Updating learning rate to 1.480292565e-05
Epoch: 5 cost time: 0.7072975635528564
Epoch: 5, Steps: 131 | Train Loss: 0.2836271 Vali Loss: 0.3041600 Best vali loss: 0.2715919
	iters: 100, epoch: 6 | loss: 0.4357703
	speed: 0.0088s/iter; left time: 2.5846s
Updating learning rate to 7.401462825e-06
Epoch: 6 cost time: 0.70853590965271
Epoch: 6, Steps: 131 | Train Loss: 0.4357703 Vali Loss: 0.3067912 Best vali loss: 0.2715919
	iters: 100, epoch: 7 | loss: 0.4665478
	speed: 0.0087s/iter; left time: 1.4261s
Updating learning rate to 3.7007314125e-06
Epoch: 7 cost time: 0.6998813152313232
Epoch: 7, Steps: 131 | Train Loss: 0.4665478 Vali Loss: 0.3082807 Best vali loss: 0.2715919
	iters: 100, epoch: 8 | loss: 0.3278446
	speed: 0.0089s/iter; left time: 0.2847s
Updating learning rate to 1.85036570625e-06
Epoch: 8 cost time: 0.7073817253112793
Epoch: 8, Steps: 131 | Train Loss: 0.3278446 Vali Loss: 0.3031361 Best vali loss: 0.2715919

best validation loss 0.27159188779236526

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0028726558238, 'e_layers': 2, 'learning_rate': 0.0021879615721, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4089601
	speed: 0.0097s/iter; left time: 19.2828s
	iters: 200, epoch: 1 | loss: 0.5607256
	speed: 0.0039s/iter; left time: 7.4310s
Updating learning rate to 0.0021879615721
Validation loss decreased (inf --> 0.3355).  Saving model state dict ...
Epoch: 1 cost time: 1.3131260871887207
Epoch: 1, Steps: 262 | Train Loss: 0.4848428 Vali Loss: 0.3355277 Best vali loss: 0.3355277
	iters: 100, epoch: 2 | loss: 0.3963831
	speed: 0.0093s/iter; left time: 16.1795s
	iters: 200, epoch: 2 | loss: 0.9658371
	speed: 0.0037s/iter; left time: 6.0953s
Updating learning rate to 0.00109398078605
Validation loss decreased (0.3355 --> 0.3190).  Saving model state dict ...
Epoch: 2 cost time: 1.037337064743042
Epoch: 2, Steps: 262 | Train Loss: 0.6811101 Vali Loss: 0.3189508 Best vali loss: 0.3189508
	iters: 100, epoch: 3 | loss: 0.7331874
	speed: 0.0093s/iter; left time: 13.7701s
	iters: 200, epoch: 3 | loss: 1.2271086
	speed: 0.0039s/iter; left time: 5.3256s
Updating learning rate to 0.000546990393025
Validation loss decreased (0.3190 --> 0.3157).  Saving model state dict ...
Epoch: 3 cost time: 1.0678784847259521
Epoch: 3, Steps: 262 | Train Loss: 0.9801480 Vali Loss: 0.3157229 Best vali loss: 0.3157229
	iters: 100, epoch: 4 | loss: 1.0898178
	speed: 0.0096s/iter; left time: 11.6045s
	iters: 200, epoch: 4 | loss: 0.7642913
	speed: 0.0038s/iter; left time: 4.2620s
Updating learning rate to 0.0002734951965125
Validation loss decreased (0.3157 --> 0.3125).  Saving model state dict ...
Epoch: 4 cost time: 1.063666820526123
Epoch: 4, Steps: 262 | Train Loss: 0.9270546 Vali Loss: 0.3125491 Best vali loss: 0.3125491
	iters: 100, epoch: 5 | loss: 0.4700586
	speed: 0.0097s/iter; left time: 9.2418s
	iters: 200, epoch: 5 | loss: 0.7468958
	speed: 0.0038s/iter; left time: 3.2306s
Updating learning rate to 0.00013674759825625
Validation loss decreased (0.3125 --> 0.3017).  Saving model state dict ...
Epoch: 5 cost time: 1.0586342811584473
Epoch: 5, Steps: 262 | Train Loss: 0.6084772 Vali Loss: 0.3017242 Best vali loss: 0.3017242
	iters: 100, epoch: 6 | loss: 0.9894428
	speed: 0.0098s/iter; left time: 6.7017s
	iters: 200, epoch: 6 | loss: 0.7986739
	speed: 0.0038s/iter; left time: 2.2469s
Updating learning rate to 6.8373799128125e-05
Validation loss decreased (0.3017 --> 0.3004).  Saving model state dict ...
Epoch: 6 cost time: 1.0773365497589111
Epoch: 6, Steps: 262 | Train Loss: 0.8940583 Vali Loss: 0.3003589 Best vali loss: 0.3003589
	iters: 100, epoch: 7 | loss: 0.8038902
	speed: 0.0096s/iter; left time: 4.0733s
	iters: 200, epoch: 7 | loss: 0.4599684
	speed: 0.0039s/iter; left time: 1.2765s
Updating learning rate to 3.41868995640625e-05
Validation loss decreased (0.3004 --> 0.2990).  Saving model state dict ...
Epoch: 7 cost time: 1.0799353122711182
Epoch: 7, Steps: 262 | Train Loss: 0.6319293 Vali Loss: 0.2989893 Best vali loss: 0.2989893
	iters: 100, epoch: 8 | loss: 0.8086236
	speed: 0.0095s/iter; left time: 1.5431s
	iters: 200, epoch: 8 | loss: 0.4478040
	speed: 0.0038s/iter; left time: 0.2406s
Updating learning rate to 1.709344978203125e-05
Epoch: 8 cost time: 1.06589674949646
Epoch: 8, Steps: 262 | Train Loss: 0.6282138 Vali Loss: 0.3002089 Best vali loss: 0.2989893

best validation loss 0.2989893429072739

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020926347247, 'e_layers': 1, 'learning_rate': 0.0005335217645, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8329309
	speed: 0.0085s/iter; left time: 8.0411s
Updating learning rate to 0.0005335217645
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 0.6728956699371338
Epoch: 1, Steps: 131 | Train Loss: 0.8329309 Vali Loss: 0.2809254 Best vali loss: 0.2809254
	iters: 100, epoch: 2 | loss: 0.3072140
	speed: 0.0059s/iter; left time: 4.8372s
Updating learning rate to 0.00026676088225
Epoch: 2 cost time: 0.43167924880981445
Epoch: 2, Steps: 131 | Train Loss: 0.3072140 Vali Loss: 0.2936036 Best vali loss: 0.2809254
	iters: 100, epoch: 3 | loss: 0.4645900
	speed: 0.0058s/iter; left time: 3.9626s
Updating learning rate to 0.000133380441125
Epoch: 3 cost time: 0.4265408515930176
Epoch: 3, Steps: 131 | Train Loss: 0.4645900 Vali Loss: 0.2976063 Best vali loss: 0.2809254
	iters: 100, epoch: 4 | loss: 0.3082277
	speed: 0.0057s/iter; left time: 3.1439s
Updating learning rate to 6.66902205625e-05
Epoch: 4 cost time: 0.4231100082397461
Epoch: 4, Steps: 131 | Train Loss: 0.3082277 Vali Loss: 0.2995615 Best vali loss: 0.2809254
	iters: 100, epoch: 5 | loss: 0.2847992
	speed: 0.0061s/iter; left time: 2.5919s
Updating learning rate to 3.334511028125e-05
Epoch: 5 cost time: 0.46640729904174805
Epoch: 5, Steps: 131 | Train Loss: 0.2847992 Vali Loss: 0.3059908 Best vali loss: 0.2809254
	iters: 100, epoch: 6 | loss: 0.3562178
	speed: 0.0058s/iter; left time: 1.7053s
Updating learning rate to 1.6672555140625e-05
Epoch: 6 cost time: 0.42572641372680664
Epoch: 6, Steps: 131 | Train Loss: 0.3562178 Vali Loss: 0.3061486 Best vali loss: 0.2809254
	iters: 100, epoch: 7 | loss: 0.4283639
	speed: 0.0059s/iter; left time: 0.9629s
Updating learning rate to 8.3362775703125e-06
Epoch: 7 cost time: 0.44407057762145996
Epoch: 7, Steps: 131 | Train Loss: 0.4283639 Vali Loss: 0.3085390 Best vali loss: 0.2809254
	iters: 100, epoch: 8 | loss: 0.3755631
	speed: 0.0058s/iter; left time: 0.1853s
Updating learning rate to 4.16813878515625e-06
Epoch: 8 cost time: 0.43032288551330566
Epoch: 8, Steps: 131 | Train Loss: 0.3755631 Vali Loss: 0.3081246 Best vali loss: 0.2809254

best validation loss 0.2809253918078363

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010269910981, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6367616
	speed: 0.0109s/iter; left time: 10.3058s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2797).  Saving model state dict ...
Epoch: 1 cost time: 0.9645378589630127
Epoch: 1, Steps: 131 | Train Loss: 0.6367616 Vali Loss: 0.2797020 Best vali loss: 0.2797020
	iters: 100, epoch: 2 | loss: 0.4034622
	speed: 0.0093s/iter; left time: 7.6201s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2797 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.7257475852966309
Epoch: 2, Steps: 131 | Train Loss: 0.4034622 Vali Loss: 0.2792404 Best vali loss: 0.2792404
	iters: 100, epoch: 3 | loss: 0.7436813
	speed: 0.0094s/iter; left time: 6.4473s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.7345132827758789
Epoch: 3, Steps: 131 | Train Loss: 0.7436813 Vali Loss: 0.2837299 Best vali loss: 0.2792404

best validation loss 0.2792403771309615

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270450872, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597138
	speed: 0.0107s/iter; left time: 10.1561s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.964256763458252
Epoch: 1, Steps: 131 | Train Loss: 0.5597138 Vali Loss: 0.2756413 Best vali loss: 0.2756413
	iters: 100, epoch: 2 | loss: 0.3244491
	speed: 0.0095s/iter; left time: 7.7416s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2719).  Saving model state dict ...
Epoch: 2 cost time: 0.7288029193878174
Epoch: 2, Steps: 131 | Train Loss: 0.3244491 Vali Loss: 0.2719283 Best vali loss: 0.2719283
	iters: 100, epoch: 3 | loss: 0.4647857
	speed: 0.0093s/iter; left time: 6.4229s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7151308059692383
Epoch: 3, Steps: 131 | Train Loss: 0.4647857 Vali Loss: 0.2739589 Best vali loss: 0.2719283

best validation loss 0.2719283360404656

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009537448367, 'e_layers': 2, 'learning_rate': 0.000237787264, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5601643
	speed: 0.0105s/iter; left time: 10.0113s
Updating learning rate to 0.000237787264
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9466557502746582
Epoch: 1, Steps: 131 | Train Loss: 0.5601643 Vali Loss: 0.2756634 Best vali loss: 0.2756634
	iters: 100, epoch: 2 | loss: 0.3273720
	speed: 0.0090s/iter; left time: 7.3505s
Updating learning rate to 0.000118893632
Validation loss decreased (0.2757 --> 0.2717).  Saving model state dict ...
Epoch: 2 cost time: 0.7035853862762451
Epoch: 2, Steps: 131 | Train Loss: 0.3273720 Vali Loss: 0.2716853 Best vali loss: 0.2716853
	iters: 100, epoch: 3 | loss: 0.4605669
	speed: 0.0090s/iter; left time: 6.1493s
Updating learning rate to 5.9446816e-05
Epoch: 3 cost time: 0.7054247856140137
Epoch: 3, Steps: 131 | Train Loss: 0.4605669 Vali Loss: 0.2850508 Best vali loss: 0.2716853

best validation loss 0.27168531786247274

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009537448367, 'e_layers': 2, 'learning_rate': 0.000237787264, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4247708
	speed: 0.0110s/iter; left time: 6.1134s
Updating learning rate to 2.9723408e-05
Epoch: 4 cost time: 0.9481556415557861
Epoch: 4, Steps: 131 | Train Loss: 0.4247708 Vali Loss: 0.3106377 Best vali loss: 0.2716853
	iters: 100, epoch: 5 | loss: 0.2851360
	speed: 0.0087s/iter; left time: 3.7179s
Updating learning rate to 1.4861704e-05
Epoch: 5 cost time: 0.697521448135376
Epoch: 5, Steps: 131 | Train Loss: 0.2851360 Vali Loss: 0.3021165 Best vali loss: 0.2716853
	iters: 100, epoch: 6 | loss: 0.4341521
	speed: 0.0085s/iter; left time: 2.5031s
Updating learning rate to 7.430852e-06
Epoch: 6 cost time: 0.6907508373260498
Epoch: 6, Steps: 131 | Train Loss: 0.4341521 Vali Loss: 0.3043303 Best vali loss: 0.2716853
	iters: 100, epoch: 7 | loss: 0.4636177
	speed: 0.0086s/iter; left time: 1.3966s
Updating learning rate to 3.715426e-06
Epoch: 7 cost time: 0.6955087184906006
Epoch: 7, Steps: 131 | Train Loss: 0.4636177 Vali Loss: 0.3035185 Best vali loss: 0.2716853
	iters: 100, epoch: 8 | loss: 0.3289398
	speed: 0.0086s/iter; left time: 0.2740s
Updating learning rate to 1.857713e-06
Epoch: 8 cost time: 0.6938643455505371
Epoch: 8, Steps: 131 | Train Loss: 0.3289398 Vali Loss: 0.3010778 Best vali loss: 0.2716853

best validation loss 0.27168531786247274

[INFO][smbo.py:320] Finished 1000 trials.
{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0045476706775, 'e_layers': 3, 'learning_rate': 0.0003361739197, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003361739197
Validation loss decreased (inf --> 0.2948).  Saving model state dict ...
Epoch: 1 cost time: 0.6311652660369873
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2948335 Best vali loss: 0.2948335
Updating learning rate to 0.00016808695985
Validation loss decreased (0.2948 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 0.40894436836242676
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2834324 Best vali loss: 0.2834324
Updating learning rate to 8.4043479925e-05
Validation loss decreased (0.2834 --> 0.2817).  Saving model state dict ...
Epoch: 3 cost time: 0.3655855655670166
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2817230 Best vali loss: 0.2817230
Updating learning rate to 4.20217399625e-05
Epoch: 4 cost time: 0.3899204730987549
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2831844 Best vali loss: 0.2817230
Updating learning rate to 2.101086998125e-05
Epoch: 5 cost time: 0.39763975143432617
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2828876 Best vali loss: 0.2817230
Updating learning rate to 1.0505434990625e-05
Epoch: 6 cost time: 0.37197065353393555
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2829591 Best vali loss: 0.2817230
Updating learning rate to 5.2527174953125e-06
Epoch: 7 cost time: 0.35738134384155273
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2831285 Best vali loss: 0.2817230
Updating learning rate to 2.62635874765625e-06
Epoch: 8 cost time: 0.36234545707702637
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2831430 Best vali loss: 0.2817230

best validation loss 0.2817230497668028

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0001650436008, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5558010
	speed: 0.0105s/iter; left time: 10.0017s
Updating learning rate to 0.0001650436008
Validation loss decreased (inf --> 0.2755).  Saving model state dict ...
Epoch: 1 cost time: 0.9406769275665283
Epoch: 1, Steps: 131 | Train Loss: 0.5558010 Vali Loss: 0.2754802 Best vali loss: 0.2754802
	iters: 100, epoch: 2 | loss: 0.3254459
	speed: 0.0089s/iter; left time: 7.2789s
Updating learning rate to 8.25218004e-05
Epoch: 2 cost time: 0.7007484436035156
Epoch: 2, Steps: 131 | Train Loss: 0.3254459 Vali Loss: 0.2789421 Best vali loss: 0.2754802
	iters: 100, epoch: 3 | loss: 0.4744406
	speed: 0.0086s/iter; left time: 5.9263s
Updating learning rate to 4.12609002e-05
Epoch: 3 cost time: 0.7002952098846436
Epoch: 3, Steps: 131 | Train Loss: 0.4744406 Vali Loss: 0.2772973 Best vali loss: 0.2754802
	iters: 100, epoch: 4 | loss: 0.5424004
	speed: 0.0086s/iter; left time: 4.7560s
Updating learning rate to 2.06304501e-05
Epoch: 4 cost time: 0.6954178810119629
Epoch: 4, Steps: 131 | Train Loss: 0.5424004 Vali Loss: 0.2886125 Best vali loss: 0.2754802
	iters: 100, epoch: 5 | loss: 0.3517563
	speed: 0.0086s/iter; left time: 3.6448s
Updating learning rate to 1.031522505e-05
Epoch: 5 cost time: 0.70068359375
Epoch: 5, Steps: 131 | Train Loss: 0.3517563 Vali Loss: 0.2944224 Best vali loss: 0.2754802
	iters: 100, epoch: 6 | loss: 0.3254868
	speed: 0.0086s/iter; left time: 2.5353s
Updating learning rate to 5.157612525e-06
Epoch: 6 cost time: 0.6929435729980469
Epoch: 6, Steps: 131 | Train Loss: 0.3254868 Vali Loss: 0.2956059 Best vali loss: 0.2754802
	iters: 100, epoch: 7 | loss: 0.3208840
	speed: 0.0085s/iter; left time: 1.3827s
Updating learning rate to 2.5788062625e-06
Epoch: 7 cost time: 0.6906514167785645
Epoch: 7, Steps: 131 | Train Loss: 0.3208840 Vali Loss: 0.2974780 Best vali loss: 0.2754802
	iters: 100, epoch: 8 | loss: 0.4309362
	speed: 0.0086s/iter; left time: 0.2747s
Updating learning rate to 1.28940313125e-06
Epoch: 8 cost time: 0.6935055255889893
Epoch: 8, Steps: 131 | Train Loss: 0.4309362 Vali Loss: 0.2994297 Best vali loss: 0.2754802

best validation loss 0.2754801708045348

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0001391628334, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5576641
	speed: 0.0105s/iter; left time: 9.9564s
Updating learning rate to 0.0001391628334
Validation loss decreased (inf --> 0.2755).  Saving model state dict ...
Epoch: 1 cost time: 0.9242820739746094
Epoch: 1, Steps: 131 | Train Loss: 0.5576641 Vali Loss: 0.2755183 Best vali loss: 0.2755183
	iters: 100, epoch: 2 | loss: 0.3281306
	speed: 0.0088s/iter; left time: 7.2195s
Updating learning rate to 6.95814167e-05
Validation loss decreased (0.2755 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 0.6983466148376465
Epoch: 2, Steps: 131 | Train Loss: 0.3281306 Vali Loss: 0.2741579 Best vali loss: 0.2741579
	iters: 100, epoch: 3 | loss: 0.4770149
	speed: 0.0090s/iter; left time: 6.1864s
Updating learning rate to 3.479070835e-05
Epoch: 3 cost time: 0.7020876407623291
Epoch: 3, Steps: 131 | Train Loss: 0.4770149 Vali Loss: 0.2757409 Best vali loss: 0.2741579

best validation loss 0.27415788839766864

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.000144219547, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5571886
	speed: 0.0104s/iter; left time: 9.8879s
Updating learning rate to 0.000144219547
Validation loss decreased (inf --> 0.2755).  Saving model state dict ...
Epoch: 1 cost time: 0.9225165843963623
Epoch: 1, Steps: 131 | Train Loss: 0.5571886 Vali Loss: 0.2755152 Best vali loss: 0.2755152
	iters: 100, epoch: 2 | loss: 0.3274782
	speed: 0.0089s/iter; left time: 7.2979s
Updating learning rate to 7.21097735e-05
Validation loss decreased (0.2755 --> 0.2747).  Saving model state dict ...
Epoch: 2 cost time: 0.7019290924072266
Epoch: 2, Steps: 131 | Train Loss: 0.3274782 Vali Loss: 0.2746791 Best vali loss: 0.2746791
	iters: 100, epoch: 3 | loss: 0.4763278
	speed: 0.0089s/iter; left time: 6.0827s
Updating learning rate to 3.605488675e-05
Epoch: 3 cost time: 0.6958394050598145
Epoch: 3, Steps: 131 | Train Loss: 0.4763278 Vali Loss: 0.2773729 Best vali loss: 0.2746791

best validation loss 0.2746791481727914

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0051307246619, 'e_layers': 3, 'learning_rate': 0.0026353457492, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3830146
	speed: 0.0095s/iter; left time: 78.4401s
	iters: 200, epoch: 1 | loss: 0.4238299
	speed: 0.0042s/iter; left time: 34.4181s
	iters: 300, epoch: 1 | loss: 0.8563423
	speed: 0.0042s/iter; left time: 33.9189s
	iters: 400, epoch: 1 | loss: 0.3652646
	speed: 0.0043s/iter; left time: 33.9148s
	iters: 500, epoch: 1 | loss: 1.4664216
	speed: 0.0039s/iter; left time: 30.5720s
	iters: 600, epoch: 1 | loss: 0.3022358
	speed: 0.0039s/iter; left time: 29.9964s
	iters: 700, epoch: 1 | loss: 0.6320350
	speed: 0.0038s/iter; left time: 29.3809s
	iters: 800, epoch: 1 | loss: 1.4828979
	speed: 0.0038s/iter; left time: 28.7065s
	iters: 900, epoch: 1 | loss: 0.3130784
	speed: 0.0039s/iter; left time: 29.2626s
	iters: 1000, epoch: 1 | loss: 1.8323259
	speed: 0.0039s/iter; left time: 28.8081s
Updating learning rate to 0.0026353457492
Validation loss decreased (inf --> 0.3212).  Saving model state dict ...
Epoch: 1 cost time: 4.443507194519043
Epoch: 1, Steps: 1045 | Train Loss: 0.8057446 Vali Loss: 0.3211687 Best vali loss: 0.3211687
	iters: 100, epoch: 2 | loss: 0.4136036
	speed: 0.0118s/iter; left time: 85.1847s
	iters: 200, epoch: 2 | loss: 0.1933096
	speed: 0.0038s/iter; left time: 27.1359s
	iters: 300, epoch: 2 | loss: 1.2559680
	speed: 0.0037s/iter; left time: 25.9495s
	iters: 400, epoch: 2 | loss: 0.5915031
	speed: 0.0038s/iter; left time: 26.5604s
	iters: 500, epoch: 2 | loss: 0.4049902
	speed: 0.0039s/iter; left time: 26.7919s
	iters: 600, epoch: 2 | loss: 0.3373646
	speed: 0.0039s/iter; left time: 26.1376s
	iters: 700, epoch: 2 | loss: 0.2577087
	speed: 0.0037s/iter; left time: 24.5648s
	iters: 800, epoch: 2 | loss: 0.1960875
	speed: 0.0037s/iter; left time: 24.2048s
	iters: 900, epoch: 2 | loss: 0.4340114
	speed: 0.0038s/iter; left time: 24.1385s
	iters: 1000, epoch: 2 | loss: 1.2618183
	speed: 0.0037s/iter; left time: 23.5871s
Updating learning rate to 0.0013176728746
Epoch: 2 cost time: 3.9876937866210938
Epoch: 2, Steps: 1045 | Train Loss: 0.5346365 Vali Loss: 0.3221766 Best vali loss: 0.3211687
	iters: 100, epoch: 3 | loss: 0.5973541
	speed: 0.0117s/iter; left time: 72.1531s
	iters: 200, epoch: 3 | loss: 0.2487863
	speed: 0.0039s/iter; left time: 23.8846s
	iters: 300, epoch: 3 | loss: 0.2742477
	speed: 0.0037s/iter; left time: 22.0241s
	iters: 400, epoch: 3 | loss: 0.4731413
	speed: 0.0037s/iter; left time: 21.4927s
	iters: 500, epoch: 3 | loss: 0.4055966
	speed: 0.0037s/iter; left time: 21.2019s
	iters: 600, epoch: 3 | loss: 0.3888141
	speed: 0.0037s/iter; left time: 20.8192s
	iters: 700, epoch: 3 | loss: 0.5458472
	speed: 0.0037s/iter; left time: 20.4526s
	iters: 800, epoch: 3 | loss: 0.2488258
	speed: 0.0037s/iter; left time: 20.0702s
	iters: 900, epoch: 3 | loss: 1.6848469
	speed: 0.0037s/iter; left time: 19.7658s
	iters: 1000, epoch: 3 | loss: 0.3115289
	speed: 0.0037s/iter; left time: 19.3744s
Updating learning rate to 0.0006588364373
Epoch: 3 cost time: 3.9286587238311768
Epoch: 3, Steps: 1045 | Train Loss: 0.5178989 Vali Loss: 0.3274380 Best vali loss: 0.3211687

best validation loss 0.32116874721623034

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0001391628334, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4616155
	speed: 0.0108s/iter; left time: 5.9823s
Updating learning rate to 1.7395354175e-05
Epoch: 4 cost time: 0.941272497177124
Epoch: 4, Steps: 131 | Train Loss: 0.4616155 Vali Loss: 0.2825381 Best vali loss: 0.2741579
	iters: 100, epoch: 5 | loss: 0.3007499
	speed: 0.0087s/iter; left time: 3.6879s
Updating learning rate to 8.6976770875e-06
Epoch: 5 cost time: 0.6973080635070801
Epoch: 5, Steps: 131 | Train Loss: 0.3007499 Vali Loss: 0.2886296 Best vali loss: 0.2741579
	iters: 100, epoch: 6 | loss: 0.4624647
	speed: 0.0086s/iter; left time: 2.5254s
Updating learning rate to 4.34883854375e-06
Epoch: 6 cost time: 0.6958813667297363
Epoch: 6, Steps: 131 | Train Loss: 0.4624647 Vali Loss: 0.2855368 Best vali loss: 0.2741579
	iters: 100, epoch: 7 | loss: 0.5305980
	speed: 0.0087s/iter; left time: 1.4129s
Updating learning rate to 2.174419271875e-06
Epoch: 7 cost time: 0.6980082988739014
Epoch: 7, Steps: 131 | Train Loss: 0.5305980 Vali Loss: 0.2914971 Best vali loss: 0.2741579
	iters: 100, epoch: 8 | loss: 0.3473742
	speed: 0.0087s/iter; left time: 0.2779s
Updating learning rate to 1.0872096359375e-06
Epoch: 8 cost time: 0.6974401473999023
Epoch: 8, Steps: 131 | Train Loss: 0.3473742 Vali Loss: 0.2902789 Best vali loss: 0.2741579

best validation loss 0.27415788839766864

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015165999948, 'e_layers': 4, 'learning_rate': 0.0016362063402, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0016362063402
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 0.6581385135650635
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2862260 Best vali loss: 0.2862260
Updating learning rate to 0.0008181031701
Validation loss decreased (0.2862 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 0.43973255157470703
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2818160 Best vali loss: 0.2818160
Updating learning rate to 0.00040905158505
Epoch: 3 cost time: 0.40863656997680664
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2873573 Best vali loss: 0.2818160
Updating learning rate to 0.000204525792525
Epoch: 4 cost time: 0.44794797897338867
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2859942 Best vali loss: 0.2818160
Updating learning rate to 0.0001022628962625
Epoch: 5 cost time: 0.44224071502685547
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2877162 Best vali loss: 0.2818160
Updating learning rate to 5.113144813125e-05
Epoch: 6 cost time: 0.432293176651001
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2858589 Best vali loss: 0.2818160
Updating learning rate to 2.5565724065625e-05
Epoch: 7 cost time: 0.44253063201904297
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2866960 Best vali loss: 0.2818160
Updating learning rate to 1.27828620328125e-05
Epoch: 8 cost time: 0.399538516998291
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2867715 Best vali loss: 0.2818160

best validation loss 0.2818160211565593

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0025278808041, 'e_layers': 2, 'learning_rate': 5.07868963e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5751754
	speed: 0.0088s/iter; left time: 35.9765s
	iters: 200, epoch: 1 | loss: 0.7305396
	speed: 0.0034s/iter; left time: 13.6966s
	iters: 300, epoch: 1 | loss: 0.2986618
	speed: 0.0034s/iter; left time: 13.3544s
	iters: 400, epoch: 1 | loss: 0.9627597
	speed: 0.0035s/iter; left time: 13.1046s
	iters: 500, epoch: 1 | loss: 0.5526475
	speed: 0.0034s/iter; left time: 12.6828s
Updating learning rate to 5.07868963e-05
Validation loss decreased (inf --> 0.3088).  Saving model state dict ...
Epoch: 1 cost time: 2.0604987144470215
Epoch: 1, Steps: 523 | Train Loss: 0.6239568 Vali Loss: 0.3087508 Best vali loss: 0.3087508
	iters: 100, epoch: 2 | loss: 0.2942443
	speed: 0.0075s/iter; left time: 26.5983s
	iters: 200, epoch: 2 | loss: 1.2032946
	speed: 0.0034s/iter; left time: 11.7627s
	iters: 300, epoch: 2 | loss: 1.1146520
	speed: 0.0034s/iter; left time: 11.4163s
	iters: 400, epoch: 2 | loss: 0.3099909
	speed: 0.0034s/iter; left time: 11.1125s
	iters: 500, epoch: 2 | loss: 0.4781757
	speed: 0.0034s/iter; left time: 10.6793s
Updating learning rate to 2.539344815e-05
Validation loss decreased (0.3088 --> 0.2919).  Saving model state dict ...
Epoch: 2 cost time: 1.8119027614593506
Epoch: 2, Steps: 523 | Train Loss: 0.6800715 Vali Loss: 0.2919059 Best vali loss: 0.2919059
	iters: 100, epoch: 3 | loss: 0.4080345
	speed: 0.0072s/iter; left time: 21.9604s
	iters: 200, epoch: 3 | loss: 0.6252753
	speed: 0.0034s/iter; left time: 9.9840s
	iters: 300, epoch: 3 | loss: 0.3346399
	speed: 0.0034s/iter; left time: 9.5769s
	iters: 400, epoch: 3 | loss: 0.9658467
	speed: 0.0034s/iter; left time: 9.2849s
	iters: 500, epoch: 3 | loss: 0.3375239
	speed: 0.0034s/iter; left time: 9.0113s
Updating learning rate to 1.2696724075e-05
Validation loss decreased (0.2919 --> 0.2877).  Saving model state dict ...
Epoch: 3 cost time: 1.8132259845733643
Epoch: 3, Steps: 523 | Train Loss: 0.5342641 Vali Loss: 0.2877210 Best vali loss: 0.2877210
	iters: 100, epoch: 4 | loss: 0.7804404
	speed: 0.0073s/iter; left time: 18.2685s
	iters: 200, epoch: 4 | loss: 0.4691005
	speed: 0.0034s/iter; left time: 8.1744s
	iters: 300, epoch: 4 | loss: 0.6612918
	speed: 0.0034s/iter; left time: 7.8007s
	iters: 400, epoch: 4 | loss: 0.3101303
	speed: 0.0033s/iter; left time: 7.3799s
	iters: 500, epoch: 4 | loss: 0.3781128
	speed: 0.0033s/iter; left time: 7.0349s
Updating learning rate to 6.3483620375e-06
Validation loss decreased (0.2877 --> 0.2860).  Saving model state dict ...
Epoch: 4 cost time: 1.796682357788086
Epoch: 4, Steps: 523 | Train Loss: 0.5198152 Vali Loss: 0.2859695 Best vali loss: 0.2859695
	iters: 100, epoch: 5 | loss: 0.8787531
	speed: 0.0068s/iter; left time: 13.5580s
	iters: 200, epoch: 5 | loss: 0.2518785
	speed: 0.0031s/iter; left time: 5.9506s
	iters: 300, epoch: 5 | loss: 0.3038715
	speed: 0.0032s/iter; left time: 5.7413s
	iters: 400, epoch: 5 | loss: 0.4875893
	speed: 0.0032s/iter; left time: 5.3794s
	iters: 500, epoch: 5 | loss: 0.7770108
	speed: 0.0032s/iter; left time: 5.1304s
Updating learning rate to 3.17418101875e-06
Validation loss decreased (0.2860 --> 0.2854).  Saving model state dict ...
Epoch: 5 cost time: 1.6802217960357666
Epoch: 5, Steps: 523 | Train Loss: 0.5398206 Vali Loss: 0.2854236 Best vali loss: 0.2854236
	iters: 100, epoch: 6 | loss: 0.5726086
	speed: 0.0074s/iter; left time: 10.8795s
	iters: 200, epoch: 6 | loss: 0.3806780
	speed: 0.0034s/iter; left time: 4.6869s
	iters: 300, epoch: 6 | loss: 1.0887167
	speed: 0.0034s/iter; left time: 4.3674s
	iters: 400, epoch: 6 | loss: 0.4487711
	speed: 0.0034s/iter; left time: 3.9908s
	iters: 500, epoch: 6 | loss: 0.2846389
	speed: 0.0034s/iter; left time: 3.6652s
Updating learning rate to 1.587090509375e-06
Validation loss decreased (0.2854 --> 0.2851).  Saving model state dict ...
Epoch: 6 cost time: 1.8262183666229248
Epoch: 6, Steps: 523 | Train Loss: 0.5550826 Vali Loss: 0.2851386 Best vali loss: 0.2851386
	iters: 100, epoch: 7 | loss: 0.3784485
	speed: 0.0071s/iter; left time: 6.6792s
	iters: 200, epoch: 7 | loss: 0.5601793
	speed: 0.0033s/iter; left time: 2.7569s
	iters: 300, epoch: 7 | loss: 0.4290449
	speed: 0.0033s/iter; left time: 2.4480s
	iters: 400, epoch: 7 | loss: 0.6963245
	speed: 0.0033s/iter; left time: 2.1049s
	iters: 500, epoch: 7 | loss: 0.7111631
	speed: 0.0033s/iter; left time: 1.7979s
Updating learning rate to 7.935452546875e-07
Validation loss decreased (0.2851 --> 0.2850).  Saving model state dict ...
Epoch: 7 cost time: 1.7418291568756104
Epoch: 7, Steps: 523 | Train Loss: 0.5550321 Vali Loss: 0.2849885 Best vali loss: 0.2849885
	iters: 100, epoch: 8 | loss: 0.5654100
	speed: 0.0071s/iter; left time: 3.0097s
	iters: 200, epoch: 8 | loss: 0.4492014
	speed: 0.0032s/iter; left time: 1.0354s
	iters: 300, epoch: 8 | loss: 0.3506225
	speed: 0.0032s/iter; left time: 0.7143s
	iters: 400, epoch: 8 | loss: 0.3925713
	speed: 0.0032s/iter; left time: 0.3985s
	iters: 500, epoch: 8 | loss: 0.5539606
	speed: 0.0032s/iter; left time: 0.0762s
Updating learning rate to 3.9677262734375e-07
Validation loss decreased (0.2850 --> 0.2849).  Saving model state dict ...
Epoch: 8 cost time: 1.7076618671417236
Epoch: 8, Steps: 523 | Train Loss: 0.4623532 Vali Loss: 0.2849145 Best vali loss: 0.2849145

best validation loss 0.2849144798399747

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009030674882, 'e_layers': 1, 'learning_rate': 0.002013378626, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4276710
	speed: 0.0077s/iter; left time: 15.4261s
	iters: 200, epoch: 1 | loss: 0.7406267
	speed: 0.0025s/iter; left time: 4.8066s
Updating learning rate to 0.002013378626
Validation loss decreased (inf --> 0.2956).  Saving model state dict ...
Epoch: 1 cost time: 0.9251282215118408
Epoch: 1, Steps: 262 | Train Loss: 0.5841489 Vali Loss: 0.2955960 Best vali loss: 0.2955960
	iters: 100, epoch: 2 | loss: 0.3864564
	speed: 0.0063s/iter; left time: 10.8444s
	iters: 200, epoch: 2 | loss: 0.3884037
	speed: 0.0025s/iter; left time: 4.1054s
Updating learning rate to 0.001006689313
Validation loss decreased (0.2956 --> 0.2831).  Saving model state dict ...
Epoch: 2 cost time: 0.6965892314910889
Epoch: 2, Steps: 262 | Train Loss: 0.3874300 Vali Loss: 0.2831333 Best vali loss: 0.2831333
	iters: 100, epoch: 3 | loss: 0.5709844
	speed: 0.0059s/iter; left time: 8.6614s
	iters: 200, epoch: 3 | loss: 0.3910825
	speed: 0.0024s/iter; left time: 3.3095s
Updating learning rate to 0.0005033446565
Epoch: 3 cost time: 0.6773521900177002
Epoch: 3, Steps: 262 | Train Loss: 0.4810335 Vali Loss: 0.2938383 Best vali loss: 0.2831333

best validation loss 0.283133294944561

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002344883352, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597146
	speed: 0.0105s/iter; left time: 9.9601s
Updating learning rate to 0.0002344883352
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9461038112640381
Epoch: 1, Steps: 131 | Train Loss: 0.5597146 Vali Loss: 0.2756366 Best vali loss: 0.2756366
	iters: 100, epoch: 2 | loss: 0.3259598
	speed: 0.0089s/iter; left time: 7.3058s
Updating learning rate to 0.0001172441676
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.6970632076263428
Epoch: 2, Steps: 131 | Train Loss: 0.3259598 Vali Loss: 0.2690314 Best vali loss: 0.2690314
	iters: 100, epoch: 3 | loss: 0.4639037
	speed: 0.0090s/iter; left time: 6.1554s
Updating learning rate to 5.86220838e-05
Epoch: 3 cost time: 0.7042224407196045
Epoch: 3, Steps: 131 | Train Loss: 0.4639037 Vali Loss: 0.2770361 Best vali loss: 0.2690314

best validation loss 0.2690313800465622

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0066422879897, 'e_layers': 4, 'learning_rate': 0.0039527792986, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6980019
	speed: 0.0102s/iter; left time: 84.1811s
	iters: 200, epoch: 1 | loss: 0.1939895
	speed: 0.0052s/iter; left time: 42.4989s
	iters: 300, epoch: 1 | loss: 0.3407589
	speed: 0.0052s/iter; left time: 41.8831s
	iters: 400, epoch: 1 | loss: 1.4435371
	speed: 0.0051s/iter; left time: 40.6897s
	iters: 500, epoch: 1 | loss: 0.4825367
	speed: 0.0050s/iter; left time: 39.2293s
	iters: 600, epoch: 1 | loss: 0.4974789
	speed: 0.0049s/iter; left time: 38.3183s
	iters: 700, epoch: 1 | loss: 0.6628182
	speed: 0.0049s/iter; left time: 37.4381s
	iters: 800, epoch: 1 | loss: 1.2039868
	speed: 0.0049s/iter; left time: 37.1219s
	iters: 900, epoch: 1 | loss: 0.5258272
	speed: 0.0049s/iter; left time: 36.6520s
	iters: 1000, epoch: 1 | loss: 1.1673496
	speed: 0.0050s/iter; left time: 36.9459s
Updating learning rate to 0.0038023355945554296
Validation loss decreased (inf --> 0.3293).  Saving model state dict ...
Epoch: 1 cost time: 5.507637023925781
Epoch: 1, Steps: 1045 | Train Loss: 0.7216285 Vali Loss: 0.3293160 Best vali loss: 0.3293160
	iters: 100, epoch: 2 | loss: 1.1299289
	speed: 0.0137s/iter; left time: 98.9355s
	iters: 200, epoch: 2 | loss: 0.3917995
	speed: 0.0048s/iter; left time: 34.3170s
	iters: 300, epoch: 2 | loss: 1.1132987
	speed: 0.0049s/iter; left time: 34.0291s
	iters: 400, epoch: 2 | loss: 0.2382190
	speed: 0.0048s/iter; left time: 33.3680s
	iters: 500, epoch: 2 | loss: 0.6899578
	speed: 0.0048s/iter; left time: 32.7564s
	iters: 600, epoch: 2 | loss: 0.7268203
	speed: 0.0049s/iter; left time: 32.6415s
	iters: 700, epoch: 2 | loss: 0.3161197
	speed: 0.0048s/iter; left time: 31.8803s
	iters: 800, epoch: 2 | loss: 0.1667505
	speed: 0.0049s/iter; left time: 31.6149s
	iters: 900, epoch: 2 | loss: 1.5020690
	speed: 0.0048s/iter; left time: 30.9894s
	iters: 1000, epoch: 2 | loss: 0.5400942
	speed: 0.0048s/iter; left time: 30.4514s
Updating learning rate to 0.0033739081725869323
Validation loss decreased (0.3293 --> 0.3253).  Saving model state dict ...
Epoch: 2 cost time: 5.086524248123169
Epoch: 2, Steps: 1045 | Train Loss: 0.6815058 Vali Loss: 0.3252758 Best vali loss: 0.3252758
	iters: 100, epoch: 3 | loss: 0.4303369
	speed: 0.0138s/iter; left time: 85.2482s
	iters: 200, epoch: 3 | loss: 0.7684389
	speed: 0.0048s/iter; left time: 28.9806s
	iters: 300, epoch: 3 | loss: 0.3631757
	speed: 0.0048s/iter; left time: 28.4948s
	iters: 400, epoch: 3 | loss: 0.3149343
	speed: 0.0047s/iter; left time: 27.8485s
	iters: 500, epoch: 3 | loss: 0.4064501
	speed: 0.0047s/iter; left time: 27.2069s
	iters: 600, epoch: 3 | loss: 0.3559951
	speed: 0.0048s/iter; left time: 27.0025s
	iters: 700, epoch: 3 | loss: 0.2178359
	speed: 0.0047s/iter; left time: 26.3479s
	iters: 800, epoch: 3 | loss: 0.3162640
	speed: 0.0048s/iter; left time: 26.1049s
	iters: 900, epoch: 3 | loss: 0.4032890
	speed: 0.0048s/iter; left time: 25.6253s
	iters: 1000, epoch: 3 | loss: 1.2533176
	speed: 0.0049s/iter; left time: 25.6399s
Updating learning rate to 0.00273272122398496
Validation loss decreased (0.3253 --> 0.3217).  Saving model state dict ...
Epoch: 3 cost time: 5.016433954238892
Epoch: 3, Steps: 1045 | Train Loss: 0.4830037 Vali Loss: 0.3216863 Best vali loss: 0.3216863

best validation loss 0.3216863494406583

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002344883352, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4224098
	speed: 0.0116s/iter; left time: 6.4228s
Updating learning rate to 2.93110419e-05
Epoch: 4 cost time: 1.0268704891204834
Epoch: 4, Steps: 131 | Train Loss: 0.4224098 Vali Loss: 0.3032871 Best vali loss: 0.2690314
	iters: 100, epoch: 5 | loss: 0.2815731
	speed: 0.0104s/iter; left time: 4.4334s
Updating learning rate to 1.465552095e-05
Epoch: 5 cost time: 0.6966629028320312
Epoch: 5, Steps: 131 | Train Loss: 0.2815731 Vali Loss: 0.2910380 Best vali loss: 0.2690314
	iters: 100, epoch: 6 | loss: 0.4344598
	speed: 0.0087s/iter; left time: 2.5496s
Updating learning rate to 7.327760475e-06
Epoch: 6 cost time: 0.694831371307373
Epoch: 6, Steps: 131 | Train Loss: 0.4344598 Vali Loss: 0.2973667 Best vali loss: 0.2690314
	iters: 100, epoch: 7 | loss: 0.4686647
	speed: 0.0087s/iter; left time: 1.4168s
Updating learning rate to 3.6638802375e-06
Epoch: 7 cost time: 0.7005190849304199
Epoch: 7, Steps: 131 | Train Loss: 0.4686647 Vali Loss: 0.2947663 Best vali loss: 0.2690314
	iters: 100, epoch: 8 | loss: 0.3275872
	speed: 0.0087s/iter; left time: 0.2779s
Updating learning rate to 1.83194011875e-06
Epoch: 8 cost time: 0.7058613300323486
Epoch: 8, Steps: 131 | Train Loss: 0.3275872 Vali Loss: 0.2923433 Best vali loss: 0.2690314

best validation loss 0.2690313800465622

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269910981, 'e_layers': 2, 'learning_rate': 0.0002338894369, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596872
	speed: 0.0104s/iter; left time: 9.8308s
Updating learning rate to 0.00022498755026125004
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9337549209594727
Epoch: 1, Steps: 131 | Train Loss: 0.5596872 Vali Loss: 0.2756464 Best vali loss: 0.2756464
	iters: 100, epoch: 2 | loss: 0.3232488
	speed: 0.0089s/iter; left time: 7.2656s
Updating learning rate to 0.00019963712188994655
Validation loss decreased (0.2756 --> 0.2720).  Saving model state dict ...
Epoch: 2 cost time: 0.6997098922729492
Epoch: 2, Steps: 131 | Train Loss: 0.3232488 Vali Loss: 0.2720179 Best vali loss: 0.2720179
	iters: 100, epoch: 3 | loss: 0.4617632
	speed: 0.0090s/iter; left time: 6.1863s
Updating learning rate to 0.00016169752470341506
Epoch: 3 cost time: 0.695913553237915
Epoch: 3, Steps: 131 | Train Loss: 0.4617632 Vali Loss: 0.2843934 Best vali loss: 0.2720179
	iters: 100, epoch: 4 | loss: 0.4931353
	speed: 0.0086s/iter; left time: 4.8009s
Updating learning rate to 0.00011694471845
Epoch: 4 cost time: 0.7004048824310303
Epoch: 4, Steps: 131 | Train Loss: 0.4931353 Vali Loss: 0.2775433 Best vali loss: 0.2720179
	iters: 100, epoch: 5 | loss: 0.3306210
	speed: 0.0087s/iter; left time: 3.6778s
Updating learning rate to 7.219191219658496e-05
Epoch: 5 cost time: 0.6926133632659912
Epoch: 5, Steps: 131 | Train Loss: 0.3306210 Vali Loss: 0.2915310 Best vali loss: 0.2720179
	iters: 100, epoch: 6 | loss: 0.3073225
	speed: 0.0087s/iter; left time: 2.5452s
Updating learning rate to 3.4252315010053446e-05
Epoch: 6 cost time: 0.7012004852294922
Epoch: 6, Steps: 131 | Train Loss: 0.3073225 Vali Loss: 0.2963602 Best vali loss: 0.2720179
	iters: 100, epoch: 7 | loss: 0.2884655
	speed: 0.0085s/iter; left time: 1.3846s
Updating learning rate to 8.901886638749951e-06
Epoch: 7 cost time: 0.6921355724334717
Epoch: 7, Steps: 131 | Train Loss: 0.2884655 Vali Loss: 0.3009610 Best vali loss: 0.2720179
	iters: 100, epoch: 8 | loss: 0.3477730
	speed: 0.0086s/iter; left time: 0.2742s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6918957233428955
Epoch: 8, Steps: 131 | Train Loss: 0.3477730 Vali Loss: 0.3029907 Best vali loss: 0.2720179

best validation loss 0.27201789019053735

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011551403403, 'e_layers': 2, 'learning_rate': 0.0005020194538, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7882738
	speed: 0.0085s/iter; left time: 69.9056s
	iters: 200, epoch: 1 | loss: 0.2695545
	speed: 0.0033s/iter; left time: 26.8776s
	iters: 300, epoch: 1 | loss: 0.2070358
	speed: 0.0033s/iter; left time: 26.3378s
	iters: 400, epoch: 1 | loss: 0.2594240
	speed: 0.0033s/iter; left time: 26.2456s
	iters: 500, epoch: 1 | loss: 0.4343654
	speed: 0.0033s/iter; left time: 25.6777s
	iters: 600, epoch: 1 | loss: 0.6509857
	speed: 0.0033s/iter; left time: 25.6105s
	iters: 700, epoch: 1 | loss: 0.2778204
	speed: 0.0032s/iter; left time: 24.8423s
	iters: 800, epoch: 1 | loss: 0.3893738
	speed: 0.0033s/iter; left time: 24.6912s
	iters: 900, epoch: 1 | loss: 0.8381072
	speed: 0.0033s/iter; left time: 24.4540s
	iters: 1000, epoch: 1 | loss: 1.2068226
	speed: 0.0032s/iter; left time: 23.8716s
Updating learning rate to 0.00048291247604415776
Validation loss decreased (inf --> 0.2888).  Saving model state dict ...
Epoch: 1 cost time: 3.6814987659454346
Epoch: 1, Steps: 1045 | Train Loss: 0.5321763 Vali Loss: 0.2887926 Best vali loss: 0.2887926
	iters: 100, epoch: 2 | loss: 0.8838402
	speed: 0.0100s/iter; left time: 72.2665s
	iters: 200, epoch: 2 | loss: 1.5683867
	speed: 0.0031s/iter; left time: 22.0319s
	iters: 300, epoch: 2 | loss: 1.2684385
	speed: 0.0030s/iter; left time: 21.0521s
	iters: 400, epoch: 2 | loss: 1.2004286
	speed: 0.0032s/iter; left time: 21.8157s
	iters: 500, epoch: 2 | loss: 1.1427031
	speed: 0.0031s/iter; left time: 21.2726s
	iters: 600, epoch: 2 | loss: 0.3364233
	speed: 0.0031s/iter; left time: 21.0658s
	iters: 700, epoch: 2 | loss: 0.3180735
	speed: 0.0031s/iter; left time: 20.6797s
	iters: 800, epoch: 2 | loss: 0.3435119
	speed: 0.0031s/iter; left time: 20.0530s
	iters: 900, epoch: 2 | loss: 0.5377297
	speed: 0.0031s/iter; left time: 19.8897s
	iters: 1000, epoch: 2 | loss: 0.5620040
	speed: 0.0031s/iter; left time: 19.5189s
Updating learning rate to 0.0004285004069347733
Epoch: 2 cost time: 3.2863800525665283
Epoch: 2, Steps: 1045 | Train Loss: 0.8161540 Vali Loss: 0.2922885 Best vali loss: 0.2887926
	iters: 100, epoch: 3 | loss: 1.2150768
	speed: 0.0097s/iter; left time: 59.7661s
	iters: 200, epoch: 3 | loss: 0.3208139
	speed: 0.0032s/iter; left time: 19.6943s
	iters: 300, epoch: 3 | loss: 0.9524589
	speed: 0.0032s/iter; left time: 19.2338s
	iters: 400, epoch: 3 | loss: 0.4787450
	speed: 0.0033s/iter; left time: 19.3128s
	iters: 500, epoch: 3 | loss: 1.1467271
	speed: 0.0031s/iter; left time: 17.7861s
	iters: 600, epoch: 3 | loss: 0.3915005
	speed: 0.0032s/iter; left time: 18.1408s
	iters: 700, epoch: 3 | loss: 0.4550767
	speed: 0.0033s/iter; left time: 18.2024s
	iters: 800, epoch: 3 | loss: 0.6304147
	speed: 0.0032s/iter; left time: 17.6323s
	iters: 900, epoch: 3 | loss: 0.8089311
	speed: 0.0030s/iter; left time: 16.2764s
	iters: 1000, epoch: 3 | loss: 1.3684856
	speed: 0.0032s/iter; left time: 16.6369s
Updating learning rate to 0.00034706699074711585
Epoch: 3 cost time: 3.342656373977661
Epoch: 3, Steps: 1045 | Train Loss: 0.7768230 Vali Loss: 0.2937303 Best vali loss: 0.2887926
	iters: 100, epoch: 4 | loss: 0.9345849
	speed: 0.0101s/iter; left time: 51.9431s
	iters: 200, epoch: 4 | loss: 0.4581355
	speed: 0.0034s/iter; left time: 17.0052s
	iters: 300, epoch: 4 | loss: 0.4219137
	speed: 0.0034s/iter; left time: 16.6364s
	iters: 400, epoch: 4 | loss: 0.3320947
	speed: 0.0034s/iter; left time: 16.4119s
	iters: 500, epoch: 4 | loss: 0.3662048
	speed: 0.0034s/iter; left time: 15.9233s
	iters: 600, epoch: 4 | loss: 0.2415177
	speed: 0.0034s/iter; left time: 15.5010s
	iters: 700, epoch: 4 | loss: 0.9997223
	speed: 0.0034s/iter; left time: 15.2088s
	iters: 800, epoch: 4 | loss: 0.1342875
	speed: 0.0033s/iter; left time: 14.5681s
	iters: 900, epoch: 4 | loss: 0.2224763
	speed: 0.0033s/iter; left time: 14.2591s
	iters: 1000, epoch: 4 | loss: 0.2980472
	speed: 0.0033s/iter; left time: 13.7374s
Updating learning rate to 0.0002510097269
Epoch: 4 cost time: 3.53251576423645
Epoch: 4, Steps: 1045 | Train Loss: 0.4408985 Vali Loss: 0.2975144 Best vali loss: 0.2887926
	iters: 100, epoch: 5 | loss: 0.8030648
	speed: 0.0100s/iter; left time: 40.6801s
	iters: 200, epoch: 5 | loss: 0.3308209
	speed: 0.0034s/iter; left time: 13.3530s
	iters: 300, epoch: 5 | loss: 0.2433537
	speed: 0.0033s/iter; left time: 12.9992s
	iters: 400, epoch: 5 | loss: 0.1816923
	speed: 0.0034s/iter; left time: 12.7396s
	iters: 500, epoch: 5 | loss: 0.5226836
	speed: 0.0034s/iter; left time: 12.4094s
	iters: 600, epoch: 5 | loss: 0.2622457
	speed: 0.0033s/iter; left time: 11.9573s
	iters: 700, epoch: 5 | loss: 0.6322639
	speed: 0.0035s/iter; left time: 12.0724s
	iters: 800, epoch: 5 | loss: 0.1912315
	speed: 0.0033s/iter; left time: 11.2075s
	iters: 900, epoch: 5 | loss: 0.1617025
	speed: 0.0035s/iter; left time: 11.4829s
	iters: 1000, epoch: 5 | loss: 0.2451376
	speed: 0.0034s/iter; left time: 10.9364s
Updating learning rate to 0.0001549524630528842
Epoch: 5 cost time: 3.5661776065826416
Epoch: 5, Steps: 1045 | Train Loss: 0.3574197 Vali Loss: 0.2895799 Best vali loss: 0.2887926
	iters: 100, epoch: 6 | loss: 0.2394448
	speed: 0.0097s/iter; left time: 29.5347s
	iters: 200, epoch: 6 | loss: 0.2290276
	speed: 0.0030s/iter; left time: 8.9311s
	iters: 300, epoch: 6 | loss: 0.2058002
	speed: 0.0031s/iter; left time: 8.6703s
	iters: 400, epoch: 6 | loss: 0.2373058
	speed: 0.0031s/iter; left time: 8.4134s
	iters: 500, epoch: 6 | loss: 0.2145168
	speed: 0.0031s/iter; left time: 8.0891s
	iters: 600, epoch: 6 | loss: 0.4360771
	speed: 0.0031s/iter; left time: 7.8517s
	iters: 700, epoch: 6 | loss: 0.6935222
	speed: 0.0031s/iter; left time: 7.5106s
	iters: 800, epoch: 6 | loss: 0.2317256
	speed: 0.0030s/iter; left time: 7.0923s
	iters: 900, epoch: 6 | loss: 0.2709362
	speed: 0.0031s/iter; left time: 6.9157s
	iters: 1000, epoch: 6 | loss: 0.1567616
	speed: 0.0031s/iter; left time: 6.5452s
Updating learning rate to 7.351904686522666e-05
Epoch: 6 cost time: 3.248441219329834
Epoch: 6, Steps: 1045 | Train Loss: 0.2915118 Vali Loss: 0.3103111 Best vali loss: 0.2887926
	iters: 100, epoch: 7 | loss: 0.3032172
	speed: 0.0098s/iter; left time: 19.4856s
	iters: 200, epoch: 7 | loss: 0.7097377
	speed: 0.0031s/iter; left time: 5.7687s
	iters: 300, epoch: 7 | loss: 0.3920988
	speed: 0.0030s/iter; left time: 5.4369s
	iters: 400, epoch: 7 | loss: 0.2642949
	speed: 0.0031s/iter; left time: 5.1641s
	iters: 500, epoch: 7 | loss: 0.2651462
	speed: 0.0031s/iter; left time: 4.8899s
	iters: 600, epoch: 7 | loss: 0.4574262
	speed: 0.0031s/iter; left time: 4.5578s
	iters: 700, epoch: 7 | loss: 0.3608591
	speed: 0.0031s/iter; left time: 4.3075s
	iters: 800, epoch: 7 | loss: 0.4565700
	speed: 0.0031s/iter; left time: 3.9774s
	iters: 900, epoch: 7 | loss: 0.2621720
	speed: 0.0032s/iter; left time: 3.8127s
	iters: 1000, epoch: 7 | loss: 0.3462047
	speed: 0.0033s/iter; left time: 3.6470s
Updating learning rate to 1.9106977755842243e-05
Epoch: 7 cost time: 3.2905313968658447
Epoch: 7, Steps: 1045 | Train Loss: 0.3817727 Vali Loss: 0.3136635 Best vali loss: 0.2887926
	iters: 100, epoch: 8 | loss: 0.3159314
	speed: 0.0102s/iter; left time: 9.6194s
	iters: 200, epoch: 8 | loss: 0.3332142
	speed: 0.0033s/iter; left time: 2.8164s
	iters: 300, epoch: 8 | loss: 0.2641388
	speed: 0.0033s/iter; left time: 2.4825s
	iters: 400, epoch: 8 | loss: 0.1563188
	speed: 0.0033s/iter; left time: 2.1383s
	iters: 500, epoch: 8 | loss: 0.4836592
	speed: 0.0033s/iter; left time: 1.8140s
	iters: 600, epoch: 8 | loss: 0.1943684
	speed: 0.0033s/iter; left time: 1.4886s
	iters: 700, epoch: 8 | loss: 0.1761062
	speed: 0.0033s/iter; left time: 1.1553s
	iters: 800, epoch: 8 | loss: 0.1309184
	speed: 0.0033s/iter; left time: 0.8208s
	iters: 900, epoch: 8 | loss: 0.6347477
	speed: 0.0033s/iter; left time: 0.4851s
	iters: 1000, epoch: 8 | loss: 0.2273421
	speed: 0.0033s/iter; left time: 0.1534s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5064773559570312
Epoch: 8, Steps: 1045 | Train Loss: 0.2916745 Vali Loss: 0.3145377 Best vali loss: 0.2887926

best validation loss 0.2887925601174017

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011471871035, 'e_layers': 2, 'learning_rate': 0.000215795242, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8117329
	speed: 0.0094s/iter; left time: 8.9549s
Updating learning rate to 0.00020758202464856
Validation loss decreased (inf --> 0.2795).  Saving model state dict ...
Epoch: 1 cost time: 0.8095097541809082
Epoch: 1, Steps: 131 | Train Loss: 0.8117329 Vali Loss: 0.2794753 Best vali loss: 0.2794753
	iters: 100, epoch: 2 | loss: 0.5384968
	speed: 0.0071s/iter; left time: 5.8199s
Updating learning rate to 0.00018419276048299604
Validation loss decreased (0.2795 --> 0.2762).  Saving model state dict ...
Epoch: 2 cost time: 0.5681436061859131
Epoch: 2, Steps: 131 | Train Loss: 0.5384968 Vali Loss: 0.2761628 Best vali loss: 0.2761628
	iters: 100, epoch: 3 | loss: 0.5323868
	speed: 0.0068s/iter; left time: 4.6805s
Updating learning rate to 0.00014918825294830759
Epoch: 3 cost time: 0.5073411464691162
Epoch: 3, Steps: 131 | Train Loss: 0.5323868 Vali Loss: 0.2838383 Best vali loss: 0.2761628

best validation loss 0.2761628131201029

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.005380683915, 'e_layers': 2, 'learning_rate': 0.0005014042356, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6455634
	speed: 0.0086s/iter; left time: 71.0118s
	iters: 200, epoch: 1 | loss: 0.2499979
	speed: 0.0033s/iter; left time: 27.2382s
	iters: 300, epoch: 1 | loss: 0.4001545
	speed: 0.0033s/iter; left time: 26.7121s
	iters: 400, epoch: 1 | loss: 0.2378837
	speed: 0.0033s/iter; left time: 25.8878s
	iters: 500, epoch: 1 | loss: 0.9894079
	speed: 0.0033s/iter; left time: 25.9272s
	iters: 600, epoch: 1 | loss: 0.2908364
	speed: 0.0033s/iter; left time: 25.7756s
	iters: 700, epoch: 1 | loss: 0.5785074
	speed: 0.0033s/iter; left time: 25.3528s
	iters: 800, epoch: 1 | loss: 0.4121242
	speed: 0.0033s/iter; left time: 25.0417s
	iters: 900, epoch: 1 | loss: 0.3560495
	speed: 0.0033s/iter; left time: 24.6473s
	iters: 1000, epoch: 1 | loss: 1.1328981
	speed: 0.0033s/iter; left time: 24.3190s
Updating learning rate to 0.00048232067319265354
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 3.7192165851593018
Epoch: 1, Steps: 1045 | Train Loss: 0.5293423 Vali Loss: 0.2836112 Best vali loss: 0.2836112
	iters: 100, epoch: 2 | loss: 0.8489177
	speed: 0.0099s/iter; left time: 71.6002s
	iters: 200, epoch: 2 | loss: 0.2603974
	speed: 0.0031s/iter; left time: 22.2209s
	iters: 300, epoch: 2 | loss: 0.2934822
	speed: 0.0034s/iter; left time: 23.5321s
	iters: 400, epoch: 2 | loss: 0.5630051
	speed: 0.0033s/iter; left time: 23.0311s
	iters: 500, epoch: 2 | loss: 1.3466146
	speed: 0.0033s/iter; left time: 22.7574s
	iters: 600, epoch: 2 | loss: 0.4070159
	speed: 0.0033s/iter; left time: 22.3965s
	iters: 700, epoch: 2 | loss: 0.5309473
	speed: 0.0033s/iter; left time: 21.8945s
	iters: 800, epoch: 2 | loss: 1.1512357
	speed: 0.0033s/iter; left time: 21.5365s
	iters: 900, epoch: 2 | loss: 0.5309899
	speed: 0.0034s/iter; left time: 21.6096s
	iters: 1000, epoch: 2 | loss: 0.5995682
	speed: 0.0033s/iter; left time: 20.8293s
Updating learning rate to 0.00042797528535420867
Epoch: 2 cost time: 3.4825022220611572
Epoch: 2, Steps: 1045 | Train Loss: 0.6532174 Vali Loss: 0.2930849 Best vali loss: 0.2836112
	iters: 100, epoch: 3 | loss: 0.2570958
	speed: 0.0101s/iter; left time: 62.4612s
	iters: 200, epoch: 3 | loss: 0.7345256
	speed: 0.0033s/iter; left time: 20.2042s
	iters: 300, epoch: 3 | loss: 0.2501104
	speed: 0.0033s/iter; left time: 19.7525s
	iters: 400, epoch: 3 | loss: 0.1809721
	speed: 0.0033s/iter; left time: 19.5401s
	iters: 500, epoch: 3 | loss: 0.6853670
	speed: 0.0033s/iter; left time: 19.0953s
	iters: 600, epoch: 3 | loss: 0.3690123
	speed: 0.0033s/iter; left time: 18.5749s
	iters: 700, epoch: 3 | loss: 1.0306163
	speed: 0.0033s/iter; left time: 18.5656s
	iters: 800, epoch: 3 | loss: 0.5030271
	speed: 0.0033s/iter; left time: 17.8992s
	iters: 900, epoch: 3 | loss: 0.2234418
	speed: 0.0033s/iter; left time: 17.7235s
	iters: 1000, epoch: 3 | loss: 0.5991489
	speed: 0.0034s/iter; left time: 17.7663s
Updating learning rate to 0.00034664166474090107
Epoch: 3 cost time: 3.4978480339050293
Epoch: 3, Steps: 1045 | Train Loss: 0.4833317 Vali Loss: 0.2894163 Best vali loss: 0.2836112

best validation loss 0.2836112338466332

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0042003187012, 'e_layers': 3, 'learning_rate': 0.0003539792247, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2351289
	speed: 0.0096s/iter; left time: 79.3451s
	iters: 200, epoch: 1 | loss: 0.4829054
	speed: 0.0043s/iter; left time: 35.3040s
	iters: 300, epoch: 1 | loss: 0.6768979
	speed: 0.0043s/iter; left time: 34.7935s
	iters: 400, epoch: 1 | loss: 1.3247423
	speed: 0.0043s/iter; left time: 34.1467s
	iters: 500, epoch: 1 | loss: 0.2348274
	speed: 0.0043s/iter; left time: 33.9293s
	iters: 600, epoch: 1 | loss: 0.5929601
	speed: 0.0045s/iter; left time: 34.8809s
	iters: 700, epoch: 1 | loss: 0.5018893
	speed: 0.0043s/iter; left time: 32.7059s
	iters: 800, epoch: 1 | loss: 1.3989959
	speed: 0.0043s/iter; left time: 32.8129s
	iters: 900, epoch: 1 | loss: 0.1475715
	speed: 0.0045s/iter; left time: 33.2799s
	iters: 1000, epoch: 1 | loss: 0.6153034
	speed: 0.0044s/iter; left time: 32.3198s
Updating learning rate to 0.00034050669266727187
Validation loss decreased (inf --> 0.3213).  Saving model state dict ...
Epoch: 1 cost time: 4.813453435897827
Epoch: 1, Steps: 1045 | Train Loss: 0.6211222 Vali Loss: 0.3213451 Best vali loss: 0.3213451
	iters: 100, epoch: 2 | loss: 0.4588139
	speed: 0.0119s/iter; left time: 86.1540s
	iters: 200, epoch: 2 | loss: 0.5386323
	speed: 0.0036s/iter; left time: 25.5541s
	iters: 300, epoch: 2 | loss: 1.2366668
	speed: 0.0036s/iter; left time: 25.5340s
	iters: 400, epoch: 2 | loss: 0.2492409
	speed: 0.0036s/iter; left time: 24.8725s
	iters: 500, epoch: 2 | loss: 1.1146455
	speed: 0.0036s/iter; left time: 24.3872s
	iters: 600, epoch: 2 | loss: 0.9048054
	speed: 0.0036s/iter; left time: 23.9360s
	iters: 700, epoch: 2 | loss: 0.3445059
	speed: 0.0036s/iter; left time: 23.5677s
	iters: 800, epoch: 2 | loss: 0.4410829
	speed: 0.0036s/iter; left time: 23.2770s
	iters: 900, epoch: 2 | loss: 0.1920999
	speed: 0.0036s/iter; left time: 23.1489s
	iters: 1000, epoch: 2 | loss: 0.2857862
	speed: 0.0036s/iter; left time: 22.6877s
Updating learning rate to 0.00030214016744226335
Validation loss decreased (0.3213 --> 0.3066).  Saving model state dict ...
Epoch: 2 cost time: 3.800004243850708
Epoch: 2, Steps: 1045 | Train Loss: 0.5766280 Vali Loss: 0.3065818 Best vali loss: 0.3065818
	iters: 100, epoch: 3 | loss: 0.5245222
	speed: 0.0114s/iter; left time: 70.1468s
	iters: 200, epoch: 3 | loss: 0.2536537
	speed: 0.0036s/iter; left time: 21.6200s
	iters: 300, epoch: 3 | loss: 0.3632099
	speed: 0.0036s/iter; left time: 21.3714s
	iters: 400, epoch: 3 | loss: 0.6409252
	speed: 0.0035s/iter; left time: 20.8410s
	iters: 500, epoch: 3 | loss: 0.1782234
	speed: 0.0036s/iter; left time: 20.6290s
	iters: 600, epoch: 3 | loss: 0.2135185
	speed: 0.0035s/iter; left time: 20.0655s
	iters: 700, epoch: 3 | loss: 0.3634823
	speed: 0.0035s/iter; left time: 19.7163s
	iters: 800, epoch: 3 | loss: 0.6221433
	speed: 0.0035s/iter; left time: 19.3157s
	iters: 900, epoch: 3 | loss: 0.7629739
	speed: 0.0035s/iter; left time: 18.9239s
	iters: 1000, epoch: 3 | loss: 0.2596700
	speed: 0.0036s/iter; left time: 19.1310s
Updating learning rate to 0.0002447206046970647
Validation loss decreased (0.3066 --> 0.2902).  Saving model state dict ...
Epoch: 3 cost time: 3.7778446674346924
Epoch: 3, Steps: 1045 | Train Loss: 0.4182322 Vali Loss: 0.2902004 Best vali loss: 0.2902004

best validation loss 0.2902004117054007

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011471871035, 'e_layers': 2, 'learning_rate': 0.000215795242, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7086654
	speed: 0.0093s/iter; left time: 5.1494s
Updating learning rate to 0.000107897621
Epoch: 4 cost time: 0.7767527103424072
Epoch: 4, Steps: 131 | Train Loss: 0.7086654 Vali Loss: 0.2892335 Best vali loss: 0.2761628
	iters: 100, epoch: 5 | loss: 0.4855622
	speed: 0.0068s/iter; left time: 2.8726s
Updating learning rate to 6.660698905169241e-05
Epoch: 5 cost time: 0.5277700424194336
Epoch: 5, Steps: 131 | Train Loss: 0.4855622 Vali Loss: 0.2773840 Best vali loss: 0.2761628
	iters: 100, epoch: 6 | loss: 0.4789141
	speed: 0.0063s/iter; left time: 1.8556s
Updating learning rate to 3.160248151700397e-05
Epoch: 6 cost time: 0.5092544555664062
Epoch: 6, Steps: 131 | Train Loss: 0.4789141 Vali Loss: 0.2922852 Best vali loss: 0.2761628
	iters: 100, epoch: 7 | loss: 0.3806871
	speed: 0.0066s/iter; left time: 1.0691s
Updating learning rate to 8.213217351440005e-06
Epoch: 7 cost time: 0.5100123882293701
Epoch: 7, Steps: 131 | Train Loss: 0.3806871 Vali Loss: 0.2886738 Best vali loss: 0.2761628
	iters: 100, epoch: 8 | loss: 0.4461077
	speed: 0.0063s/iter; left time: 0.2029s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4984405040740967
Epoch: 8, Steps: 131 | Train Loss: 0.4461077 Vali Loss: 0.2928833 Best vali loss: 0.2761628

best validation loss 0.2761628131201029

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0034140873251, 'e_layers': 4, 'learning_rate': 0.0002361227689, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002361227689
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 0.7534856796264648
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2823182 Best vali loss: 0.2823182
Updating learning rate to 0.00011806138445
Epoch: 2 cost time: 0.5276122093200684
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2827322 Best vali loss: 0.2823182
Updating learning rate to 5.9030692225e-05
Epoch: 3 cost time: 0.5243110656738281
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2825078 Best vali loss: 0.2823182
Updating learning rate to 2.95153461125e-05
Epoch: 4 cost time: 0.5228784084320068
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2825264 Best vali loss: 0.2823182
Updating learning rate to 1.475767305625e-05
Epoch: 5 cost time: 0.5188610553741455
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2825194 Best vali loss: 0.2823182
Updating learning rate to 7.378836528125e-06
Epoch: 6 cost time: 0.5226631164550781
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2839999 Best vali loss: 0.2823182
Updating learning rate to 3.6894182640625e-06
Epoch: 7 cost time: 0.5251736640930176
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2842803 Best vali loss: 0.2823182
Updating learning rate to 1.84470913203125e-06
Epoch: 8 cost time: 0.5202960968017578
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2846767 Best vali loss: 0.2823182

best validation loss 0.2823181558925452

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0028090466791, 'e_layers': 2, 'learning_rate': 0.000818703695, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6851845
	speed: 0.0086s/iter; left time: 71.4368s
	iters: 200, epoch: 1 | loss: 0.2602486
	speed: 0.0032s/iter; left time: 25.7899s
	iters: 300, epoch: 1 | loss: 0.3974393
	speed: 0.0032s/iter; left time: 25.4652s
	iters: 400, epoch: 1 | loss: 0.2290405
	speed: 0.0031s/iter; left time: 24.5441s
	iters: 500, epoch: 1 | loss: 0.9642131
	speed: 0.0031s/iter; left time: 24.3143s
	iters: 600, epoch: 1 | loss: 0.2601028
	speed: 0.0031s/iter; left time: 24.1711s
	iters: 700, epoch: 1 | loss: 0.5849988
	speed: 0.0031s/iter; left time: 23.8590s
	iters: 800, epoch: 1 | loss: 0.4238269
	speed: 0.0031s/iter; left time: 23.3497s
	iters: 900, epoch: 1 | loss: 0.3092870
	speed: 0.0032s/iter; left time: 23.9354s
	iters: 1000, epoch: 1 | loss: 1.1429607
	speed: 0.0033s/iter; left time: 24.6055s
Updating learning rate to 0.0007875436410009315
Validation loss decreased (inf --> 0.2945).  Saving model state dict ...
Epoch: 1 cost time: 3.575840711593628
Epoch: 1, Steps: 1045 | Train Loss: 0.5257302 Vali Loss: 0.2945305 Best vali loss: 0.2945305
	iters: 100, epoch: 2 | loss: 0.8969707
	speed: 0.0098s/iter; left time: 71.0433s
	iters: 200, epoch: 2 | loss: 0.2966241
	speed: 0.0032s/iter; left time: 22.9366s
	iters: 300, epoch: 2 | loss: 0.3024979
	speed: 0.0033s/iter; left time: 23.1518s
	iters: 400, epoch: 2 | loss: 0.6839639
	speed: 0.0033s/iter; left time: 22.9816s
	iters: 500, epoch: 2 | loss: 1.4130336
	speed: 0.0033s/iter; left time: 22.5654s
	iters: 600, epoch: 2 | loss: 0.3121105
	speed: 0.0033s/iter; left time: 22.3058s
	iters: 700, epoch: 2 | loss: 0.5633317
	speed: 0.0034s/iter; left time: 22.3073s
	iters: 800, epoch: 2 | loss: 1.1735233
	speed: 0.0033s/iter; left time: 21.5965s
	iters: 900, epoch: 2 | loss: 0.4737539
	speed: 0.0033s/iter; left time: 21.0654s
	iters: 1000, epoch: 2 | loss: 0.8255549
	speed: 0.0033s/iter; left time: 21.1158s
Updating learning rate to 0.0006988073147584915
Epoch: 2 cost time: 3.4564599990844727
Epoch: 2, Steps: 1045 | Train Loss: 0.6941365 Vali Loss: 0.2991807 Best vali loss: 0.2945305
	iters: 100, epoch: 3 | loss: 0.2740244
	speed: 0.0101s/iter; left time: 62.5754s
	iters: 200, epoch: 3 | loss: 0.7777504
	speed: 0.0030s/iter; left time: 18.1043s
	iters: 300, epoch: 3 | loss: 0.2630329
	speed: 0.0030s/iter; left time: 17.8453s
	iters: 400, epoch: 3 | loss: 0.1868182
	speed: 0.0030s/iter; left time: 17.6055s
	iters: 500, epoch: 3 | loss: 0.6545935
	speed: 0.0030s/iter; left time: 17.1987s
	iters: 600, epoch: 3 | loss: 0.4077741
	speed: 0.0031s/iter; left time: 17.3699s
	iters: 700, epoch: 3 | loss: 1.2706198
	speed: 0.0031s/iter; left time: 17.0456s
	iters: 800, epoch: 3 | loss: 0.4939781
	speed: 0.0030s/iter; left time: 16.3545s
	iters: 900, epoch: 3 | loss: 0.2293189
	speed: 0.0030s/iter; left time: 16.1124s
	iters: 1000, epoch: 3 | loss: 0.5863867
	speed: 0.0030s/iter; left time: 15.8030s
Updating learning rate to 0.0005660040175462909
Validation loss decreased (0.2945 --> 0.2885).  Saving model state dict ...
Epoch: 3 cost time: 3.1864540576934814
Epoch: 3, Steps: 1045 | Train Loss: 0.5144297 Vali Loss: 0.2885409 Best vali loss: 0.2885409
	iters: 100, epoch: 4 | loss: 0.9127281
	speed: 0.0100s/iter; left time: 51.2292s
	iters: 200, epoch: 4 | loss: 0.4220414
	speed: 0.0031s/iter; left time: 15.4432s
	iters: 300, epoch: 4 | loss: 0.4333601
	speed: 0.0031s/iter; left time: 15.0259s
	iters: 400, epoch: 4 | loss: 0.5716537
	speed: 0.0030s/iter; left time: 14.6619s
	iters: 500, epoch: 4 | loss: 0.2519400
	speed: 0.0032s/iter; left time: 15.2755s
	iters: 600, epoch: 4 | loss: 0.9675485
	speed: 0.0033s/iter; left time: 15.3533s
	iters: 700, epoch: 4 | loss: 0.2232087
	speed: 0.0033s/iter; left time: 14.9958s
	iters: 800, epoch: 4 | loss: 0.3481805
	speed: 0.0033s/iter; left time: 14.7773s
	iters: 900, epoch: 4 | loss: 0.1942728
	speed: 0.0033s/iter; left time: 14.2608s
	iters: 1000, epoch: 4 | loss: 0.3312173
	speed: 0.0033s/iter; left time: 14.0390s
Updating learning rate to 0.0004093518475
Epoch: 4 cost time: 3.3881170749664307
Epoch: 4, Steps: 1045 | Train Loss: 0.4656151 Vali Loss: 0.2886343 Best vali loss: 0.2885409
	iters: 100, epoch: 5 | loss: 0.6042551
	speed: 0.0102s/iter; left time: 41.5827s
	iters: 200, epoch: 5 | loss: 0.5836512
	speed: 0.0034s/iter; left time: 13.4878s
	iters: 300, epoch: 5 | loss: 0.7488199
	speed: 0.0034s/iter; left time: 13.3593s
	iters: 400, epoch: 5 | loss: 0.2861101
	speed: 0.0035s/iter; left time: 13.1115s
	iters: 500, epoch: 5 | loss: 0.7260820
	speed: 0.0034s/iter; left time: 12.4748s
	iters: 600, epoch: 5 | loss: 0.4816243
	speed: 0.0033s/iter; left time: 11.9245s
	iters: 700, epoch: 5 | loss: 1.0607626
	speed: 0.0032s/iter; left time: 11.2534s
	iters: 800, epoch: 5 | loss: 0.3952913
	speed: 0.0032s/iter; left time: 10.7651s
	iters: 900, epoch: 5 | loss: 0.3580550
	speed: 0.0031s/iter; left time: 10.1236s
	iters: 1000, epoch: 5 | loss: 0.7444862
	speed: 0.0032s/iter; left time: 10.2806s
Updating learning rate to 0.00025269967745370923
Epoch: 5 cost time: 3.494603157043457
Epoch: 5, Steps: 1045 | Train Loss: 0.5989138 Vali Loss: 0.2993223 Best vali loss: 0.2885409
	iters: 100, epoch: 6 | loss: 0.2370924
	speed: 0.0098s/iter; left time: 29.8579s
	iters: 200, epoch: 6 | loss: 0.7418523
	speed: 0.0031s/iter; left time: 9.0262s
	iters: 300, epoch: 6 | loss: 0.2356798
	speed: 0.0031s/iter; left time: 8.7176s
	iters: 400, epoch: 6 | loss: 0.3105453
	speed: 0.0031s/iter; left time: 8.4644s
	iters: 500, epoch: 6 | loss: 0.3128250
	speed: 0.0031s/iter; left time: 8.1493s
	iters: 600, epoch: 6 | loss: 0.3334076
	speed: 0.0031s/iter; left time: 7.7998s
	iters: 700, epoch: 6 | loss: 0.2744721
	speed: 0.0031s/iter; left time: 7.5295s
	iters: 800, epoch: 6 | loss: 0.5874225
	speed: 0.0031s/iter; left time: 7.2446s
	iters: 900, epoch: 6 | loss: 0.2681524
	speed: 0.0031s/iter; left time: 6.9240s
	iters: 1000, epoch: 6 | loss: 0.4194734
	speed: 0.0031s/iter; left time: 6.6080s
Updating learning rate to 0.00011989638024150855
Epoch: 6 cost time: 3.268601894378662
Epoch: 6, Steps: 1045 | Train Loss: 0.3720923 Vali Loss: 0.3087205 Best vali loss: 0.2885409
	iters: 100, epoch: 7 | loss: 0.6683797
	speed: 0.0099s/iter; left time: 19.6149s
	iters: 200, epoch: 7 | loss: 0.4833098
	speed: 0.0033s/iter; left time: 6.3090s
	iters: 300, epoch: 7 | loss: 0.2237957
	speed: 0.0033s/iter; left time: 5.9633s
	iters: 400, epoch: 7 | loss: 0.2385882
	speed: 0.0033s/iter; left time: 5.5866s
	iters: 500, epoch: 7 | loss: 1.1427143
	speed: 0.0033s/iter; left time: 5.2042s
	iters: 600, epoch: 7 | loss: 0.3399131
	speed: 0.0033s/iter; left time: 4.9577s
	iters: 700, epoch: 7 | loss: 0.4209545
	speed: 0.0033s/iter; left time: 4.5911s
	iters: 800, epoch: 7 | loss: 0.3334389
	speed: 0.0034s/iter; left time: 4.3363s
	iters: 900, epoch: 7 | loss: 0.4543821
	speed: 0.0033s/iter; left time: 3.9520s
	iters: 1000, epoch: 7 | loss: 0.2610417
	speed: 0.0033s/iter; left time: 3.6345s
Updating learning rate to 3.116005399906846e-05
Epoch: 7 cost time: 3.5020313262939453
Epoch: 7, Steps: 1045 | Train Loss: 0.4566518 Vali Loss: 0.3191261 Best vali loss: 0.2885409
	iters: 100, epoch: 8 | loss: 0.3900861
	speed: 0.0103s/iter; left time: 9.7424s
	iters: 200, epoch: 8 | loss: 0.4592133
	speed: 0.0033s/iter; left time: 2.7631s
	iters: 300, epoch: 8 | loss: 0.3416570
	speed: 0.0033s/iter; left time: 2.4452s
	iters: 400, epoch: 8 | loss: 0.7954628
	speed: 0.0033s/iter; left time: 2.1046s
	iters: 500, epoch: 8 | loss: 0.3160274
	speed: 0.0033s/iter; left time: 1.7786s
	iters: 600, epoch: 8 | loss: 0.6709160
	speed: 0.0032s/iter; left time: 1.4489s
	iters: 700, epoch: 8 | loss: 0.3334065
	speed: 0.0033s/iter; left time: 1.1316s
	iters: 800, epoch: 8 | loss: 1.6709243
	speed: 0.0033s/iter; left time: 0.8080s
	iters: 900, epoch: 8 | loss: 0.3101757
	speed: 0.0033s/iter; left time: 0.4861s
	iters: 1000, epoch: 8 | loss: 0.5630867
	speed: 0.0033s/iter; left time: 0.1519s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4632437229156494
Epoch: 8, Steps: 1045 | Train Loss: 0.5850956 Vali Loss: 0.3182963 Best vali loss: 0.2885409

best validation loss 0.2885409337785351

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027919087463, 'e_layers': 3, 'learning_rate': 0.0026748540346, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3658082
	speed: 0.0098s/iter; left time: 9.3165s
Updating learning rate to 0.0026748540346
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 0.8291044235229492
Epoch: 1, Steps: 131 | Train Loss: 0.3658082 Vali Loss: 0.2845054 Best vali loss: 0.2845054
	iters: 100, epoch: 2 | loss: 0.5960206
	speed: 0.0080s/iter; left time: 6.5101s
Updating learning rate to 0.0013374270173
Epoch: 2 cost time: 0.6653573513031006
Epoch: 2, Steps: 131 | Train Loss: 0.5960206 Vali Loss: 0.2865748 Best vali loss: 0.2845054
	iters: 100, epoch: 3 | loss: 0.8122998
	speed: 0.0077s/iter; left time: 5.3115s
Updating learning rate to 0.00066871350865
Epoch: 3 cost time: 0.6356856822967529
Epoch: 3, Steps: 131 | Train Loss: 0.8122998 Vali Loss: 0.2898466 Best vali loss: 0.2845054

best validation loss 0.2845053582020345

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0043037768481, 'e_layers': 1, 'learning_rate': 0.0025030268353, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5808868
	speed: 0.0079s/iter; left time: 15.7610s
	iters: 200, epoch: 1 | loss: 0.9180948
	speed: 0.0026s/iter; left time: 4.9612s
Updating learning rate to 0.002407761048880085
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 0.945429801940918
Epoch: 1, Steps: 262 | Train Loss: 0.7494908 Vali Loss: 0.2803458 Best vali loss: 0.2803458
	iters: 100, epoch: 2 | loss: 0.4394470
	speed: 0.0063s/iter; left time: 10.9070s
	iters: 200, epoch: 2 | loss: 0.3993602
	speed: 0.0025s/iter; left time: 4.1632s
Updating learning rate to 0.0021364670420162667
Epoch: 2 cost time: 0.7145407199859619
Epoch: 2, Steps: 262 | Train Loss: 0.4194036 Vali Loss: 0.2862939 Best vali loss: 0.2803458
	iters: 100, epoch: 3 | loss: 0.3730740
	speed: 0.0062s/iter; left time: 9.1199s
	iters: 200, epoch: 3 | loss: 0.3617819
	speed: 0.0027s/iter; left time: 3.6942s
Updating learning rate to 0.0017304468679672663
Epoch: 3 cost time: 0.7275364398956299
Epoch: 3, Steps: 262 | Train Loss: 0.3674279 Vali Loss: 0.2941118 Best vali loss: 0.2803458

best validation loss 0.28034576455005794

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0077572519988, 'e_layers': 2, 'learning_rate': 0.0002327756273, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0342834
	speed: 0.0089s/iter; left time: 17.8115s
	iters: 200, epoch: 1 | loss: 0.8075422
	speed: 0.0035s/iter; left time: 6.6065s
Updating learning rate to 0.0002327756273
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 1.1916985511779785
Epoch: 1, Steps: 262 | Train Loss: 0.9209128 Vali Loss: 0.2836833 Best vali loss: 0.2836833
	iters: 100, epoch: 2 | loss: 0.8698033
	speed: 0.0080s/iter; left time: 13.7935s
	iters: 200, epoch: 2 | loss: 0.4319567
	speed: 0.0033s/iter; left time: 5.4004s
Updating learning rate to 0.00011638781365
Validation loss decreased (0.2837 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.9018943309783936
Epoch: 2, Steps: 262 | Train Loss: 0.6508800 Vali Loss: 0.2792082 Best vali loss: 0.2792082
	iters: 100, epoch: 3 | loss: 0.6471059
	speed: 0.0074s/iter; left time: 10.8705s
	iters: 200, epoch: 3 | loss: 0.5879133
	speed: 0.0031s/iter; left time: 4.3190s
Updating learning rate to 5.8193906825e-05
Epoch: 3 cost time: 0.8630402088165283
Epoch: 3, Steps: 262 | Train Loss: 0.6175096 Vali Loss: 0.2803953 Best vali loss: 0.2792082

best validation loss 0.27920815867866094

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0077572519988, 'e_layers': 2, 'learning_rate': 0.0002327756273, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9143884
	speed: 0.0090s/iter; left time: 10.8611s
	iters: 200, epoch: 4 | loss: 0.7750080
	speed: 0.0036s/iter; left time: 4.0037s
Updating learning rate to 2.90969534125e-05
Epoch: 4 cost time: 1.2040154933929443
Epoch: 4, Steps: 262 | Train Loss: 0.8446982 Vali Loss: 0.2838750 Best vali loss: 0.2792082
	iters: 100, epoch: 5 | loss: 0.8579488
	speed: 0.0079s/iter; left time: 7.4751s
	iters: 200, epoch: 5 | loss: 0.4061589
	speed: 0.0035s/iter; left time: 2.9438s
Updating learning rate to 1.454847670625e-05
Epoch: 5 cost time: 0.955296516418457
Epoch: 5, Steps: 262 | Train Loss: 0.6320539 Vali Loss: 0.2826021 Best vali loss: 0.2792082
	iters: 100, epoch: 6 | loss: 0.6254687
	speed: 0.0080s/iter; left time: 5.5049s
	iters: 200, epoch: 6 | loss: 0.5909281
	speed: 0.0037s/iter; left time: 2.1851s
Updating learning rate to 7.274238353125e-06
Epoch: 6 cost time: 0.9918043613433838
Epoch: 6, Steps: 262 | Train Loss: 0.6081984 Vali Loss: 0.2832242 Best vali loss: 0.2792082
	iters: 100, epoch: 7 | loss: 0.3207694
	speed: 0.0080s/iter; left time: 3.3827s
	iters: 200, epoch: 7 | loss: 1.1390938
	speed: 0.0036s/iter; left time: 1.1703s
Updating learning rate to 3.6371191765625e-06
Epoch: 7 cost time: 0.9698972702026367
Epoch: 7, Steps: 262 | Train Loss: 0.7299316 Vali Loss: 0.2837604 Best vali loss: 0.2792082
	iters: 100, epoch: 8 | loss: 0.3761301
	speed: 0.0078s/iter; left time: 1.2747s
	iters: 200, epoch: 8 | loss: 0.4445011
	speed: 0.0036s/iter; left time: 0.2274s
Updating learning rate to 1.81855958828125e-06
Epoch: 8 cost time: 0.9731338024139404
Epoch: 8, Steps: 262 | Train Loss: 0.4103156 Vali Loss: 0.2834751 Best vali loss: 0.2792082

best validation loss 0.27920815867866094

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084274546782, 'e_layers': 2, 'learning_rate': 0.0002110448865, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002110448865
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6762640476226807
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2781223 Best vali loss: 0.2781223
Updating learning rate to 0.00010552244325
Validation loss decreased (0.2781 --> 0.2756).  Saving model state dict ...
Epoch: 2 cost time: 0.4364314079284668
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2755728 Best vali loss: 0.2755728
Updating learning rate to 5.2761221625e-05
Epoch: 3 cost time: 0.4282867908477783
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2860576 Best vali loss: 0.2755728
Updating learning rate to 2.63806108125e-05
Epoch: 4 cost time: 0.42330241203308105
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2858771 Best vali loss: 0.2755728
Updating learning rate to 1.319030540625e-05
Epoch: 5 cost time: 0.42635035514831543
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2883620 Best vali loss: 0.2755728
Updating learning rate to 6.595152703125e-06
Epoch: 6 cost time: 0.42629432678222656
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2915778 Best vali loss: 0.2755728
Updating learning rate to 3.2975763515625e-06
Epoch: 7 cost time: 0.43523430824279785
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2898019 Best vali loss: 0.2755728
Updating learning rate to 1.64878817578125e-06
Epoch: 8 cost time: 0.4332883358001709
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2902958 Best vali loss: 0.2755728

best validation loss 0.2755727742674981

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.007155383109, 'e_layers': 2, 'learning_rate': 0.00024070303, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00024070303
Validation loss decreased (inf --> 0.3056).  Saving model state dict ...
Epoch: 1 cost time: 0.5537068843841553
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3055989 Best vali loss: 0.3055989
Updating learning rate to 0.000120351515
Validation loss decreased (0.3056 --> 0.2886).  Saving model state dict ...
Epoch: 2 cost time: 0.3228881359100342
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2886007 Best vali loss: 0.2886007
Updating learning rate to 6.01757575e-05
Validation loss decreased (0.2886 --> 0.2861).  Saving model state dict ...
Epoch: 3 cost time: 0.33333587646484375
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2861253 Best vali loss: 0.2861253
Updating learning rate to 3.008787875e-05
Validation loss decreased (0.2861 --> 0.2838).  Saving model state dict ...
Epoch: 4 cost time: 0.33905792236328125
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2837677 Best vali loss: 0.2837677
Updating learning rate to 1.5043939375e-05
Validation loss decreased (0.2838 --> 0.2834).  Saving model state dict ...
Epoch: 5 cost time: 0.34258532524108887
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2833960 Best vali loss: 0.2833960
Updating learning rate to 7.5219696875e-06
Validation loss decreased (0.2834 --> 0.2832).  Saving model state dict ...
Epoch: 6 cost time: 0.31627988815307617
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2831955 Best vali loss: 0.2831955
Updating learning rate to 3.76098484375e-06
Validation loss decreased (0.2832 --> 0.2831).  Saving model state dict ...
Epoch: 7 cost time: 0.33116912841796875
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2830838 Best vali loss: 0.2830838
Updating learning rate to 1.880492421875e-06
Validation loss decreased (0.2831 --> 0.2831).  Saving model state dict ...
Epoch: 8 cost time: 0.32930469512939453
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2830512 Best vali loss: 0.2830512

best validation loss 0.28305119835740794

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0046324688534, 'e_layers': 2, 'learning_rate': 0.0036271134648, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3571048
	speed: 0.0091s/iter; left time: 8.5939s
Updating learning rate to 0.0034890646785124086
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 0.7618551254272461
Epoch: 1, Steps: 131 | Train Loss: 0.3571048 Vali Loss: 0.2860627 Best vali loss: 0.2860627
	iters: 100, epoch: 2 | loss: 0.4488005
	speed: 0.0069s/iter; left time: 5.6389s
Updating learning rate to 0.003095934995946557
Epoch: 2 cost time: 0.5475044250488281
Epoch: 2, Steps: 131 | Train Loss: 0.4488005 Vali Loss: 0.2872969 Best vali loss: 0.2860627
	iters: 100, epoch: 3 | loss: 0.5687811
	speed: 0.0067s/iter; left time: 4.6105s
Updating learning rate to 0.002507574847543649
Epoch: 3 cost time: 0.5366191864013672
Epoch: 3, Steps: 131 | Train Loss: 0.5687811 Vali Loss: 0.2896819 Best vali loss: 0.2860627

best validation loss 0.28606271325943416

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0106500205295, 'e_layers': 4, 'learning_rate': 0.0001767912618, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5492867
	speed: 0.0105s/iter; left time: 21.0277s
	iters: 200, epoch: 1 | loss: 0.3017506
	speed: 0.0053s/iter; left time: 10.1326s
Updating learning rate to 0.00017006254505193226
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 1.6553845405578613
Epoch: 1, Steps: 262 | Train Loss: 0.4255187 Vali Loss: 0.2842703 Best vali loss: 0.2842703
	iters: 100, epoch: 2 | loss: 0.8607229
	speed: 0.0111s/iter; left time: 19.2470s
	iters: 200, epoch: 2 | loss: 0.6784250
	speed: 0.0050s/iter; left time: 8.2162s
Updating learning rate to 0.0001509007809366531
Validation loss decreased (0.2843 --> 0.2806).  Saving model state dict ...
Epoch: 2 cost time: 1.3543696403503418
Epoch: 2, Steps: 262 | Train Loss: 0.7695739 Vali Loss: 0.2805847 Best vali loss: 0.2805847
	iters: 100, epoch: 3 | loss: 0.6679949
	speed: 0.0110s/iter; left time: 16.1599s
	iters: 200, epoch: 3 | loss: 0.2648474
	speed: 0.0050s/iter; left time: 6.8655s
Updating learning rate to 0.0001222231743388896
Epoch: 3 cost time: 1.3665432929992676
Epoch: 3, Steps: 262 | Train Loss: 0.4664212 Vali Loss: 0.2824190 Best vali loss: 0.2805847

best validation loss 0.2805847088037791

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0028152375084, 'e_layers': 4, 'learning_rate': 7.26812449e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.991497973027517e-05
Validation loss decreased (inf --> 0.3510).  Saving model state dict ...
Epoch: 1 cost time: 0.6611316204071045
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3509826 Best vali loss: 0.3509826
Updating learning rate to 6.203732301693507e-05
Validation loss decreased (0.3510 --> 0.3393).  Saving model state dict ...
Epoch: 2 cost time: 0.41339969635009766
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3392608 Best vali loss: 0.3392608
Updating learning rate to 5.024757658344984e-05
Validation loss decreased (0.3393 --> 0.3307).  Saving model state dict ...
Epoch: 3 cost time: 0.44739508628845215
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3306911 Best vali loss: 0.3306911

best validation loss 0.3306910505344452

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0106500205295, 'e_layers': 4, 'learning_rate': 0.0001767912618, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4025158
	speed: 0.0106s/iter; left time: 12.8531s
	iters: 200, epoch: 4 | loss: 0.2834838
	speed: 0.0054s/iter; left time: 5.9692s
Updating learning rate to 8.83956309e-05
Epoch: 4 cost time: 1.6564362049102783
Epoch: 4, Steps: 262 | Train Loss: 0.3429998 Vali Loss: 0.2855850 Best vali loss: 0.2805847
	iters: 100, epoch: 5 | loss: 0.5474136
	speed: 0.0108s/iter; left time: 10.2934s
	iters: 200, epoch: 5 | loss: 0.4837143
	speed: 0.0049s/iter; left time: 4.1341s
Updating learning rate to 5.456808746111042e-05
Epoch: 5 cost time: 1.3237934112548828
Epoch: 5, Steps: 262 | Train Loss: 0.5155639 Vali Loss: 0.2847741 Best vali loss: 0.2805847
	iters: 100, epoch: 6 | loss: 0.5458129
	speed: 0.0105s/iter; left time: 7.2395s
	iters: 200, epoch: 6 | loss: 0.2375282
	speed: 0.0050s/iter; left time: 2.9355s
Updating learning rate to 2.5890480863346887e-05
Epoch: 6 cost time: 1.3569047451019287
Epoch: 6, Steps: 262 | Train Loss: 0.3916706 Vali Loss: 0.2815933 Best vali loss: 0.2805847
	iters: 100, epoch: 7 | loss: 0.3724078
	speed: 0.0108s/iter; left time: 4.5961s
	iters: 200, epoch: 7 | loss: 0.3529849
	speed: 0.0050s/iter; left time: 1.6142s
Updating learning rate to 6.728716748067748e-06
Epoch: 7 cost time: 1.3321850299835205
Epoch: 7, Steps: 262 | Train Loss: 0.3626963 Vali Loss: 0.2849037 Best vali loss: 0.2805847
	iters: 100, epoch: 8 | loss: 0.5269376
	speed: 0.0109s/iter; left time: 1.7780s
	iters: 200, epoch: 8 | loss: 0.4215473
	speed: 0.0050s/iter; left time: 0.3173s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3724815845489502
Epoch: 8, Steps: 262 | Train Loss: 0.4742424 Vali Loss: 0.2844703 Best vali loss: 0.2805847

best validation loss 0.2805847088037791

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0107878307022, 'e_layers': 2, 'learning_rate': 0.0003865083087, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003865083087
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 0.8149237632751465
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2809360 Best vali loss: 0.2809360
Updating learning rate to 0.00019325415435
Epoch: 2 cost time: 0.5936462879180908
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2838471 Best vali loss: 0.2809360
Updating learning rate to 9.6627077175e-05
Validation loss decreased (0.2809 --> 0.2785).  Saving model state dict ...
Epoch: 3 cost time: 0.5923497676849365
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2785182 Best vali loss: 0.2785182
Updating learning rate to 4.83135385875e-05
Epoch: 4 cost time: 0.5964932441711426
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2817236 Best vali loss: 0.2785182
Updating learning rate to 2.415676929375e-05
Epoch: 5 cost time: 0.5959880352020264
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2814671 Best vali loss: 0.2785182
Updating learning rate to 1.2078384646875e-05
Epoch: 6 cost time: 0.5907313823699951
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2799681 Best vali loss: 0.2785182
Updating learning rate to 6.0391923234375e-06
Epoch: 7 cost time: 0.5984702110290527
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2802946 Best vali loss: 0.2785182
Updating learning rate to 3.01959616171875e-06
Epoch: 8 cost time: 0.5931069850921631
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2809860 Best vali loss: 0.2785182

best validation loss 0.27851816906544213

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0059010066723, 'e_layers': 4, 'learning_rate': 0.0028190630765, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4808044
	speed: 0.0102s/iter; left time: 9.6595s
Updating learning rate to 0.0028190630765
Validation loss decreased (inf --> 0.3116).  Saving model state dict ...
Epoch: 1 cost time: 0.9148156642913818
Epoch: 1, Steps: 131 | Train Loss: 0.4808044 Vali Loss: 0.3116039 Best vali loss: 0.3116039
	iters: 100, epoch: 2 | loss: 0.7986303
	speed: 0.0092s/iter; left time: 7.5540s
Updating learning rate to 0.00140953153825
Epoch: 2 cost time: 0.7827844619750977
Epoch: 2, Steps: 131 | Train Loss: 0.7986303 Vali Loss: 0.3151147 Best vali loss: 0.3116039
	iters: 100, epoch: 3 | loss: 0.5138641
	speed: 0.0093s/iter; left time: 6.4180s
Updating learning rate to 0.000704765769125
Epoch: 3 cost time: 0.7876443862915039
Epoch: 3, Steps: 131 | Train Loss: 0.5138641 Vali Loss: 0.3174987 Best vali loss: 0.3116039
	iters: 100, epoch: 4 | loss: 0.6981480
	speed: 0.0090s/iter; left time: 4.9996s
Updating learning rate to 0.0003523828845625
Epoch: 4 cost time: 0.7429568767547607
Epoch: 4, Steps: 131 | Train Loss: 0.6981480 Vali Loss: 0.3177495 Best vali loss: 0.3116039
	iters: 100, epoch: 5 | loss: 0.4738365
	speed: 0.0089s/iter; left time: 3.7721s
Updating learning rate to 0.00017619144228125
Epoch: 5 cost time: 0.7335140705108643
Epoch: 5, Steps: 131 | Train Loss: 0.4738365 Vali Loss: 0.3174485 Best vali loss: 0.3116039
	iters: 100, epoch: 6 | loss: 0.5373287
	speed: 0.0089s/iter; left time: 2.6187s
Updating learning rate to 8.8095721140625e-05
Epoch: 6 cost time: 0.7415063381195068
Epoch: 6, Steps: 131 | Train Loss: 0.5373287 Vali Loss: 0.3180412 Best vali loss: 0.3116039
	iters: 100, epoch: 7 | loss: 0.7649080
	speed: 0.0088s/iter; left time: 1.4404s
Updating learning rate to 4.40478605703125e-05
Epoch: 7 cost time: 0.7387740612030029
Epoch: 7, Steps: 131 | Train Loss: 0.7649080 Vali Loss: 0.3162925 Best vali loss: 0.3116039
	iters: 100, epoch: 8 | loss: 0.3767858
	speed: 0.0087s/iter; left time: 0.2799s
Updating learning rate to 2.202393028515625e-05
Epoch: 8 cost time: 0.7268674373626709
Epoch: 8, Steps: 131 | Train Loss: 0.3767858 Vali Loss: 0.3160628 Best vali loss: 0.3116039

best validation loss 0.3116038820975418

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270163229, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597192
	speed: 0.0103s/iter; left time: 9.7695s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9249372482299805
Epoch: 1, Steps: 131 | Train Loss: 0.5597192 Vali Loss: 0.2756283 Best vali loss: 0.2756283
	iters: 100, epoch: 2 | loss: 0.3242410
	speed: 0.0089s/iter; left time: 7.2616s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2683).  Saving model state dict ...
Epoch: 2 cost time: 0.7022254467010498
Epoch: 2, Steps: 131 | Train Loss: 0.3242410 Vali Loss: 0.2682513 Best vali loss: 0.2682513
	iters: 100, epoch: 3 | loss: 0.4595214
	speed: 0.0090s/iter; left time: 6.1868s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7022609710693359
Epoch: 3, Steps: 131 | Train Loss: 0.4595214 Vali Loss: 0.2758089 Best vali loss: 0.2682513

best validation loss 0.2682512956908663

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0020383091675, 'e_layers': 4, 'learning_rate': 0.0011928165372, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0361879
	speed: 0.0100s/iter; left time: 41.0462s
	iters: 200, epoch: 1 | loss: 0.2946145
	speed: 0.0046s/iter; left time: 18.3893s
	iters: 300, epoch: 1 | loss: 0.2372107
	speed: 0.0046s/iter; left time: 17.9107s
	iters: 400, epoch: 1 | loss: 0.7898367
	speed: 0.0046s/iter; left time: 17.4234s
	iters: 500, epoch: 1 | loss: 0.6227476
	speed: 0.0046s/iter; left time: 16.8522s
Updating learning rate to 0.0011928165372
Validation loss decreased (inf --> 0.2894).  Saving model state dict ...
Epoch: 1 cost time: 2.681919574737549
Epoch: 1, Steps: 523 | Train Loss: 0.5961195 Vali Loss: 0.2893907 Best vali loss: 0.2893907
	iters: 100, epoch: 2 | loss: 0.5661957
	speed: 0.0101s/iter; left time: 36.0671s
	iters: 200, epoch: 2 | loss: 0.5797023
	speed: 0.0052s/iter; left time: 17.8393s
	iters: 300, epoch: 2 | loss: 1.3655895
	speed: 0.0053s/iter; left time: 17.6979s
	iters: 400, epoch: 2 | loss: 0.2922122
	speed: 0.0051s/iter; left time: 16.7586s
	iters: 500, epoch: 2 | loss: 0.2372964
	speed: 0.0052s/iter; left time: 16.5552s
Updating learning rate to 0.0005964082686
Validation loss decreased (0.2894 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 2.756922960281372
Epoch: 2, Steps: 523 | Train Loss: 0.6081992 Vali Loss: 0.2867558 Best vali loss: 0.2867558
	iters: 100, epoch: 3 | loss: 0.8416639
	speed: 0.0098s/iter; left time: 29.8422s
	iters: 200, epoch: 3 | loss: 0.7216529
	speed: 0.0051s/iter; left time: 14.8620s
	iters: 300, epoch: 3 | loss: 0.8404780
	speed: 0.0051s/iter; left time: 14.3468s
	iters: 400, epoch: 3 | loss: 0.7788330
	speed: 0.0050s/iter; left time: 13.8060s
	iters: 500, epoch: 3 | loss: 0.4989332
	speed: 0.0050s/iter; left time: 13.2100s
Updating learning rate to 0.0002982041343
Epoch: 3 cost time: 2.6267292499542236
Epoch: 3, Steps: 523 | Train Loss: 0.7363122 Vali Loss: 0.2887039 Best vali loss: 0.2867558

best validation loss 0.2867557860165557

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012798220825, 'e_layers': 2, 'learning_rate': 0.000193466084, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4566371
	speed: 0.0096s/iter; left time: 9.0812s
Updating learning rate to 0.000193466084
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 0.8081948757171631
Epoch: 1, Steps: 131 | Train Loss: 0.4566371 Vali Loss: 0.2775696 Best vali loss: 0.2775696
	iters: 100, epoch: 2 | loss: 0.4508969
	speed: 0.0072s/iter; left time: 5.8923s
Updating learning rate to 9.6733042e-05
Epoch: 2 cost time: 0.5458004474639893
Epoch: 2, Steps: 131 | Train Loss: 0.4508969 Vali Loss: 0.2783572 Best vali loss: 0.2775696
	iters: 100, epoch: 3 | loss: 0.5599252
	speed: 0.0068s/iter; left time: 4.7006s
Updating learning rate to 4.8366521e-05
Epoch: 3 cost time: 0.5353837013244629
Epoch: 3, Steps: 131 | Train Loss: 0.5599252 Vali Loss: 0.3106728 Best vali loss: 0.2775696

best validation loss 0.2775696015775802

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270163229, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4226800
	speed: 0.0107s/iter; left time: 5.9675s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9296483993530273
Epoch: 4, Steps: 131 | Train Loss: 0.4226800 Vali Loss: 0.3073942 Best vali loss: 0.2682513
	iters: 100, epoch: 5 | loss: 0.2812731
	speed: 0.0088s/iter; left time: 3.7209s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.7023463249206543
Epoch: 5, Steps: 131 | Train Loss: 0.2812731 Vali Loss: 0.2951188 Best vali loss: 0.2682513
	iters: 100, epoch: 6 | loss: 0.4335765
	speed: 0.0086s/iter; left time: 2.5165s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6930022239685059
Epoch: 6, Steps: 131 | Train Loss: 0.4335765 Vali Loss: 0.3002216 Best vali loss: 0.2682513
	iters: 100, epoch: 7 | loss: 0.4642428
	speed: 0.0087s/iter; left time: 1.4174s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.7039937973022461
Epoch: 7, Steps: 131 | Train Loss: 0.4642428 Vali Loss: 0.2976949 Best vali loss: 0.2682513
	iters: 100, epoch: 8 | loss: 0.3257310
	speed: 0.0086s/iter; left time: 0.2738s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.6904661655426025
Epoch: 8, Steps: 131 | Train Loss: 0.3257310 Vali Loss: 0.2952941 Best vali loss: 0.2682513

best validation loss 0.2682512956908663

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0074244741377, 'e_layers': 4, 'learning_rate': 0.0014834056283, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7218219
	speed: 0.0105s/iter; left time: 20.9962s
	iters: 200, epoch: 1 | loss: 0.6674776
	speed: 0.0052s/iter; left time: 9.9308s
Updating learning rate to 0.0014834056283
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 1.6290905475616455
Epoch: 1, Steps: 262 | Train Loss: 0.6946498 Vali Loss: 0.2868396 Best vali loss: 0.2868396
	iters: 100, epoch: 2 | loss: 0.6120157
	speed: 0.0106s/iter; left time: 18.4602s
	iters: 200, epoch: 2 | loss: 0.5472791
	speed: 0.0045s/iter; left time: 7.3537s
Updating learning rate to 0.00074170281415
Validation loss decreased (0.2868 --> 0.2847).  Saving model state dict ...
Epoch: 2 cost time: 1.24470853805542
Epoch: 2, Steps: 262 | Train Loss: 0.5796474 Vali Loss: 0.2847006 Best vali loss: 0.2847006
	iters: 100, epoch: 3 | loss: 0.3466467
	speed: 0.0105s/iter; left time: 15.5062s
	iters: 200, epoch: 3 | loss: 0.6706989
	speed: 0.0053s/iter; left time: 7.2496s
Updating learning rate to 0.000370851407075
Epoch: 3 cost time: 1.4196867942810059
Epoch: 3, Steps: 262 | Train Loss: 0.5086728 Vali Loss: 0.2868913 Best vali loss: 0.2847006
	iters: 100, epoch: 4 | loss: 0.4471123
	speed: 0.0111s/iter; left time: 13.4674s
	iters: 200, epoch: 4 | loss: 0.3076718
	speed: 0.0051s/iter; left time: 5.6668s
Updating learning rate to 0.0001854257035375
Epoch: 4 cost time: 1.3848204612731934
Epoch: 4, Steps: 262 | Train Loss: 0.3773921 Vali Loss: 0.2882644 Best vali loss: 0.2847006
	iters: 100, epoch: 5 | loss: 0.5374356
	speed: 0.0107s/iter; left time: 10.1524s
	iters: 200, epoch: 5 | loss: 0.8388087
	speed: 0.0048s/iter; left time: 4.1095s
Updating learning rate to 9.271285176875e-05
Epoch: 5 cost time: 1.3107271194458008
Epoch: 5, Steps: 262 | Train Loss: 0.6881222 Vali Loss: 0.2904220 Best vali loss: 0.2847006
	iters: 100, epoch: 6 | loss: 0.7363111
	speed: 0.0104s/iter; left time: 7.1763s
	iters: 200, epoch: 6 | loss: 0.8972431
	speed: 0.0044s/iter; left time: 2.5990s
Updating learning rate to 4.6356425884375e-05
Epoch: 6 cost time: 1.2452366352081299
Epoch: 6, Steps: 262 | Train Loss: 0.8167771 Vali Loss: 0.2915254 Best vali loss: 0.2847006
	iters: 100, epoch: 7 | loss: 0.8276160
	speed: 0.0097s/iter; left time: 4.1408s
	iters: 200, epoch: 7 | loss: 0.3160913
	speed: 0.0045s/iter; left time: 1.4665s
Updating learning rate to 2.31782129421875e-05
Epoch: 7 cost time: 1.2190296649932861
Epoch: 7, Steps: 262 | Train Loss: 0.5718537 Vali Loss: 0.2905989 Best vali loss: 0.2847006
	iters: 100, epoch: 8 | loss: 0.4833595
	speed: 0.0101s/iter; left time: 1.6433s
	iters: 200, epoch: 8 | loss: 0.4672741
	speed: 0.0048s/iter; left time: 0.3021s
Updating learning rate to 1.158910647109375e-05
Epoch: 8 cost time: 1.3034029006958008
Epoch: 8, Steps: 262 | Train Loss: 0.4753168 Vali Loss: 0.2914103 Best vali loss: 0.2847006

best validation loss 0.2847005661068551

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0108721804965, 'e_layers': 3, 'learning_rate': 0.0026129456257, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3777667
	speed: 0.0097s/iter; left time: 39.4379s
	iters: 200, epoch: 1 | loss: 0.2686432
	speed: 0.0040s/iter; left time: 16.0643s
	iters: 300, epoch: 1 | loss: 0.4141548
	speed: 0.0040s/iter; left time: 15.6468s
	iters: 400, epoch: 1 | loss: 0.8325041
	speed: 0.0040s/iter; left time: 15.0341s
	iters: 500, epoch: 1 | loss: 0.9737198
	speed: 0.0040s/iter; left time: 14.8591s
Updating learning rate to 0.0026129456257
Validation loss decreased (inf --> 0.3097).  Saving model state dict ...
Epoch: 1 cost time: 2.383814573287964
Epoch: 1, Steps: 523 | Train Loss: 0.5733577 Vali Loss: 0.3097202 Best vali loss: 0.3097202
	iters: 100, epoch: 2 | loss: 0.4273154
	speed: 0.0087s/iter; left time: 30.9551s
	iters: 200, epoch: 2 | loss: 0.8615111
	speed: 0.0037s/iter; left time: 12.9454s
	iters: 300, epoch: 2 | loss: 0.3971961
	speed: 0.0037s/iter; left time: 12.4791s
	iters: 400, epoch: 2 | loss: 0.5382970
	speed: 0.0036s/iter; left time: 11.8974s
	iters: 500, epoch: 2 | loss: 0.7682154
	speed: 0.0037s/iter; left time: 11.5524s
Updating learning rate to 0.00130647281285
Epoch: 2 cost time: 1.977506160736084
Epoch: 2, Steps: 523 | Train Loss: 0.5985070 Vali Loss: 0.3100125 Best vali loss: 0.3097202
	iters: 100, epoch: 3 | loss: 0.5863094
	speed: 0.0079s/iter; left time: 24.1351s
	iters: 200, epoch: 3 | loss: 0.5139680
	speed: 0.0037s/iter; left time: 10.7770s
	iters: 300, epoch: 3 | loss: 0.2527422
	speed: 0.0037s/iter; left time: 10.5942s
	iters: 400, epoch: 3 | loss: 0.2679630
	speed: 0.0037s/iter; left time: 10.0295s
	iters: 500, epoch: 3 | loss: 0.4216312
	speed: 0.0036s/iter; left time: 9.6088s
Updating learning rate to 0.000653236406425
Validation loss decreased (0.3097 --> 0.3011).  Saving model state dict ...
Epoch: 3 cost time: 1.9522645473480225
Epoch: 3, Steps: 523 | Train Loss: 0.4085228 Vali Loss: 0.3011430 Best vali loss: 0.3011430
	iters: 100, epoch: 4 | loss: 0.3274348
	speed: 0.0084s/iter; left time: 21.1711s
	iters: 200, epoch: 4 | loss: 0.4994341
	speed: 0.0040s/iter; left time: 9.6840s
	iters: 300, epoch: 4 | loss: 0.8083124
	speed: 0.0040s/iter; left time: 9.2427s
	iters: 400, epoch: 4 | loss: 0.6083053
	speed: 0.0040s/iter; left time: 8.8711s
	iters: 500, epoch: 4 | loss: 0.4252678
	speed: 0.0041s/iter; left time: 8.5904s
Updating learning rate to 0.0003266182032125
Validation loss decreased (0.3011 --> 0.3000).  Saving model state dict ...
Epoch: 4 cost time: 2.1521739959716797
Epoch: 4, Steps: 523 | Train Loss: 0.5337509 Vali Loss: 0.2999788 Best vali loss: 0.2999788
	iters: 100, epoch: 5 | loss: 0.5731244
	speed: 0.0086s/iter; left time: 17.0914s
	iters: 200, epoch: 5 | loss: 0.3089363
	speed: 0.0037s/iter; left time: 7.0501s
	iters: 300, epoch: 5 | loss: 0.5780966
	speed: 0.0037s/iter; left time: 6.6094s
	iters: 400, epoch: 5 | loss: 0.4868663
	speed: 0.0037s/iter; left time: 6.3219s
	iters: 500, epoch: 5 | loss: 0.4780952
	speed: 0.0037s/iter; left time: 5.9269s
Updating learning rate to 0.00016330910160625
Epoch: 5 cost time: 2.014362096786499
Epoch: 5, Steps: 523 | Train Loss: 0.4850238 Vali Loss: 0.3012955 Best vali loss: 0.2999788
	iters: 100, epoch: 6 | loss: 0.2681150
	speed: 0.0079s/iter; left time: 11.5562s
	iters: 200, epoch: 6 | loss: 0.4016968
	speed: 0.0037s/iter; left time: 5.0138s
	iters: 300, epoch: 6 | loss: 0.2624969
	speed: 0.0037s/iter; left time: 4.7047s
	iters: 400, epoch: 6 | loss: 0.9615142
	speed: 0.0037s/iter; left time: 4.3316s
	iters: 500, epoch: 6 | loss: 1.0030112
	speed: 0.0037s/iter; left time: 3.9926s
Updating learning rate to 8.1654550803125e-05
Epoch: 6 cost time: 1.9581537246704102
Epoch: 6, Steps: 523 | Train Loss: 0.5793668 Vali Loss: 0.3018403 Best vali loss: 0.2999788
	iters: 100, epoch: 7 | loss: 0.2370025
	speed: 0.0084s/iter; left time: 7.9389s
	iters: 200, epoch: 7 | loss: 0.5298278
	speed: 0.0040s/iter; left time: 3.3871s
	iters: 300, epoch: 7 | loss: 0.5457358
	speed: 0.0037s/iter; left time: 2.7384s
	iters: 400, epoch: 7 | loss: 0.5563270
	speed: 0.0037s/iter; left time: 2.3718s
	iters: 500, epoch: 7 | loss: 0.6155975
	speed: 0.0037s/iter; left time: 2.0197s
Updating learning rate to 4.08272754015625e-05
Epoch: 7 cost time: 2.0229363441467285
Epoch: 7, Steps: 523 | Train Loss: 0.4968981 Vali Loss: 0.3007342 Best vali loss: 0.2999788
	iters: 100, epoch: 8 | loss: 0.4590952
	speed: 0.0083s/iter; left time: 3.5308s
	iters: 200, epoch: 8 | loss: 0.5490478
	speed: 0.0040s/iter; left time: 1.3084s
	iters: 300, epoch: 8 | loss: 0.8710625
	speed: 0.0040s/iter; left time: 0.9066s
	iters: 400, epoch: 8 | loss: 0.3663117
	speed: 0.0040s/iter; left time: 0.4973s
	iters: 500, epoch: 8 | loss: 0.7591839
	speed: 0.0040s/iter; left time: 0.0955s
Updating learning rate to 2.041363770078125e-05
Epoch: 8 cost time: 2.142794609069824
Epoch: 8, Steps: 523 | Train Loss: 0.6009402 Vali Loss: 0.3024818 Best vali loss: 0.2999788

best validation loss 0.29997883028880334

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0070200605068, 'e_layers': 3, 'learning_rate': 0.0003278703285, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3957869
	speed: 0.0097s/iter; left time: 19.3181s
	iters: 200, epoch: 1 | loss: 0.5828714
	speed: 0.0038s/iter; left time: 7.2125s
Updating learning rate to 0.00031539150715945104
Validation loss decreased (inf --> 0.2797).  Saving model state dict ...
Epoch: 1 cost time: 1.322356939315796
Epoch: 1, Steps: 262 | Train Loss: 0.4893292 Vali Loss: 0.2797167 Best vali loss: 0.2797167
	iters: 100, epoch: 2 | loss: 0.5562280
	speed: 0.0089s/iter; left time: 15.5147s
	iters: 200, epoch: 2 | loss: 0.3717205
	speed: 0.0040s/iter; left time: 6.5505s
Updating learning rate to 0.0002798548305661055
Epoch: 2 cost time: 1.0894224643707275
Epoch: 2, Steps: 262 | Train Loss: 0.4639743 Vali Loss: 0.2803869 Best vali loss: 0.2797167
	iters: 100, epoch: 3 | loss: 0.6786536
	speed: 0.0092s/iter; left time: 13.5914s
	iters: 200, epoch: 3 | loss: 0.4020034
	speed: 0.0043s/iter; left time: 5.8366s
Updating learning rate to 0.00022667043559052477
Epoch: 3 cost time: 1.1611251831054688
Epoch: 3, Steps: 262 | Train Loss: 0.5403285 Vali Loss: 0.2830534 Best vali loss: 0.2797167

best validation loss 0.2797166520571035

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044446379001, 'e_layers': 1, 'learning_rate': 6.16990992e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.16990992e-05
Validation loss decreased (inf --> 0.3517).  Saving model state dict ...
Epoch: 1 cost time: 0.5051858425140381
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3516878 Best vali loss: 0.3516878
Updating learning rate to 3.08495496e-05
Validation loss decreased (0.3517 --> 0.3414).  Saving model state dict ...
Epoch: 2 cost time: 0.27178120613098145
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3414491 Best vali loss: 0.3414491
Updating learning rate to 1.54247748e-05
Validation loss decreased (0.3414 --> 0.3371).  Saving model state dict ...
Epoch: 3 cost time: 0.2732124328613281
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3370928 Best vali loss: 0.3370928

best validation loss 0.3370927832369558

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0025953951676, 'e_layers': 4, 'learning_rate': 8.82136821e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.82136821e-05
Validation loss decreased (inf --> 0.3234).  Saving model state dict ...
Epoch: 1 cost time: 0.6742434501647949
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3234201 Best vali loss: 0.3234201
Updating learning rate to 4.410684105e-05
Validation loss decreased (0.3234 --> 0.3059).  Saving model state dict ...
Epoch: 2 cost time: 0.43883681297302246
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3059409 Best vali loss: 0.3059409
Updating learning rate to 2.2053420525e-05
Validation loss decreased (0.3059 --> 0.3007).  Saving model state dict ...
Epoch: 3 cost time: 0.4518160820007324
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3007105 Best vali loss: 0.3007105

best validation loss 0.3007104574370535

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0070200605068, 'e_layers': 3, 'learning_rate': 0.0003278703285, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3894330
	speed: 0.0101s/iter; left time: 12.2581s
	iters: 200, epoch: 4 | loss: 0.5942939
	speed: 0.0046s/iter; left time: 5.0583s
Updating learning rate to 0.00016393516425
Epoch: 4 cost time: 1.4590160846710205
Epoch: 4, Steps: 262 | Train Loss: 0.4918634 Vali Loss: 0.2899139 Best vali loss: 0.2797167
	iters: 100, epoch: 5 | loss: 0.3749805
	speed: 0.0096s/iter; left time: 9.1563s
	iters: 200, epoch: 5 | loss: 0.3475373
	speed: 0.0045s/iter; left time: 3.8268s
Updating learning rate to 0.00010119989290947525
Epoch: 5 cost time: 1.2170708179473877
Epoch: 5, Steps: 262 | Train Loss: 0.3612589 Vali Loss: 0.2924685 Best vali loss: 0.2797167
	iters: 100, epoch: 6 | loss: 0.5685557
	speed: 0.0099s/iter; left time: 6.8086s
	iters: 200, epoch: 6 | loss: 0.3364135
	speed: 0.0046s/iter; left time: 2.6869s
Updating learning rate to 4.8015497933894536e-05
Epoch: 6 cost time: 1.2281694412231445
Epoch: 6, Steps: 262 | Train Loss: 0.4524846 Vali Loss: 0.2926859 Best vali loss: 0.2797167
	iters: 100, epoch: 7 | loss: 0.4319911
	speed: 0.0093s/iter; left time: 3.9459s
	iters: 200, epoch: 7 | loss: 0.3786738
	speed: 0.0039s/iter; left time: 1.2778s
Updating learning rate to 1.2478821340548994e-05
Epoch: 7 cost time: 1.089860200881958
Epoch: 7, Steps: 262 | Train Loss: 0.4053325 Vali Loss: 0.2953201 Best vali loss: 0.2797167
	iters: 100, epoch: 8 | loss: 0.3180582
	speed: 0.0088s/iter; left time: 1.4373s
	iters: 200, epoch: 8 | loss: 0.3388828
	speed: 0.0038s/iter; left time: 0.2412s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0555622577667236
Epoch: 8, Steps: 262 | Train Loss: 0.3284705 Vali Loss: 0.2948139 Best vali loss: 0.2797167

best validation loss 0.2797166520571035

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001089705499, 'e_layers': 2, 'learning_rate': 0.0002384765383, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5600496
	speed: 0.0107s/iter; left time: 10.1510s
Updating learning rate to 0.0002384765383
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9423787593841553
Epoch: 1, Steps: 131 | Train Loss: 0.5600496 Vali Loss: 0.2756799 Best vali loss: 0.2756799
	iters: 100, epoch: 2 | loss: 0.3250113
	speed: 0.0089s/iter; left time: 7.2771s
Updating learning rate to 0.00011923826915
Validation loss decreased (0.2757 --> 0.2721).  Saving model state dict ...
Epoch: 2 cost time: 0.7031207084655762
Epoch: 2, Steps: 131 | Train Loss: 0.3250113 Vali Loss: 0.2721065 Best vali loss: 0.2721065
	iters: 100, epoch: 3 | loss: 0.4606253
	speed: 0.0089s/iter; left time: 6.1094s
Updating learning rate to 5.9619134575e-05
Epoch: 3 cost time: 0.6913571357727051
Epoch: 3, Steps: 131 | Train Loss: 0.4606253 Vali Loss: 0.2844752 Best vali loss: 0.2721065
	iters: 100, epoch: 4 | loss: 0.5049853
	speed: 0.0086s/iter; left time: 4.7682s
Updating learning rate to 2.98095672875e-05
Epoch: 4 cost time: 0.697113037109375
Epoch: 4, Steps: 131 | Train Loss: 0.5049853 Vali Loss: 0.2940126 Best vali loss: 0.2721065
	iters: 100, epoch: 5 | loss: 0.3285377
	speed: 0.0085s/iter; left time: 3.5988s
Updating learning rate to 1.490478364375e-05
Epoch: 5 cost time: 0.6888980865478516
Epoch: 5, Steps: 131 | Train Loss: 0.3285377 Vali Loss: 0.2932489 Best vali loss: 0.2721065
	iters: 100, epoch: 6 | loss: 0.3185034
	speed: 0.0086s/iter; left time: 2.5254s
Updating learning rate to 7.452391821875e-06
Epoch: 6 cost time: 0.694760799407959
Epoch: 6, Steps: 131 | Train Loss: 0.3185034 Vali Loss: 0.2985646 Best vali loss: 0.2721065
	iters: 100, epoch: 7 | loss: 0.3133178
	speed: 0.0085s/iter; left time: 1.3904s
Updating learning rate to 3.7261959109375e-06
Epoch: 7 cost time: 0.6898002624511719
Epoch: 7, Steps: 131 | Train Loss: 0.3133178 Vali Loss: 0.3049985 Best vali loss: 0.2721065
	iters: 100, epoch: 8 | loss: 0.3967937
	speed: 0.0087s/iter; left time: 0.2785s
Updating learning rate to 1.86309795546875e-06
Epoch: 8 cost time: 0.7051708698272705
Epoch: 8, Steps: 131 | Train Loss: 0.3967937 Vali Loss: 0.3025460 Best vali loss: 0.2721065

best validation loss 0.27210651589131524

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0021892616552, 'e_layers': 1, 'learning_rate': 0.0049488352641, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3858730
	speed: 0.0080s/iter; left time: 16.0227s
	iters: 200, epoch: 1 | loss: 0.3622594
	speed: 0.0025s/iter; left time: 4.8184s
Updating learning rate to 0.0049488352641
Validation loss decreased (inf --> 0.2889).  Saving model state dict ...
Epoch: 1 cost time: 0.9416894912719727
Epoch: 1, Steps: 262 | Train Loss: 0.3740662 Vali Loss: 0.2889344 Best vali loss: 0.2889344
	iters: 100, epoch: 2 | loss: 0.6522214
	speed: 0.0063s/iter; left time: 10.8446s
	iters: 200, epoch: 2 | loss: 0.5106189
	speed: 0.0025s/iter; left time: 4.1550s
Updating learning rate to 0.00247441763205
Validation loss decreased (0.2889 --> 0.2879).  Saving model state dict ...
Epoch: 2 cost time: 0.7076053619384766
Epoch: 2, Steps: 262 | Train Loss: 0.5814202 Vali Loss: 0.2878849 Best vali loss: 0.2878849
	iters: 100, epoch: 3 | loss: 0.4902149
	speed: 0.0065s/iter; left time: 9.6060s
	iters: 200, epoch: 3 | loss: 0.3061575
	speed: 0.0026s/iter; left time: 3.5849s
Updating learning rate to 0.001237208816025
Epoch: 3 cost time: 0.7329185009002686
Epoch: 3, Steps: 262 | Train Loss: 0.3981862 Vali Loss: 0.2937970 Best vali loss: 0.2878849
	iters: 100, epoch: 4 | loss: 0.3295494
	speed: 0.0062s/iter; left time: 7.5235s
	iters: 200, epoch: 4 | loss: 0.3940639
	speed: 0.0025s/iter; left time: 2.7981s
Updating learning rate to 0.0006186044080125
Epoch: 4 cost time: 0.7024056911468506
Epoch: 4, Steps: 262 | Train Loss: 0.3618066 Vali Loss: 0.3072834 Best vali loss: 0.2878849
	iters: 100, epoch: 5 | loss: 0.3867028
	speed: 0.0062s/iter; left time: 5.8638s
	iters: 200, epoch: 5 | loss: 0.2434745
	speed: 0.0025s/iter; left time: 2.1327s
Updating learning rate to 0.00030930220400625
Epoch: 5 cost time: 0.6924090385437012
Epoch: 5, Steps: 262 | Train Loss: 0.3150886 Vali Loss: 0.3142163 Best vali loss: 0.2878849
	iters: 100, epoch: 6 | loss: 0.5478657
	speed: 0.0061s/iter; left time: 4.1721s
	iters: 200, epoch: 6 | loss: 0.3650336
	speed: 0.0025s/iter; left time: 1.4469s
Updating learning rate to 0.000154651102003125
Epoch: 6 cost time: 0.6786036491394043
Epoch: 6, Steps: 262 | Train Loss: 0.4564497 Vali Loss: 0.3176318 Best vali loss: 0.2878849
	iters: 100, epoch: 7 | loss: 0.4316542
	speed: 0.0060s/iter; left time: 2.5662s
	iters: 200, epoch: 7 | loss: 0.4284679
	speed: 0.0025s/iter; left time: 0.8127s
Updating learning rate to 7.73255510015625e-05
Epoch: 7 cost time: 0.6962900161743164
Epoch: 7, Steps: 262 | Train Loss: 0.4300611 Vali Loss: 0.3152845 Best vali loss: 0.2878849
	iters: 100, epoch: 8 | loss: 0.3486362
	speed: 0.0061s/iter; left time: 0.9997s
	iters: 200, epoch: 8 | loss: 0.2504525
	speed: 0.0024s/iter; left time: 0.1522s
Updating learning rate to 3.866277550078125e-05
Epoch: 8 cost time: 0.6831190586090088
Epoch: 8, Steps: 262 | Train Loss: 0.2995444 Vali Loss: 0.3134060 Best vali loss: 0.2878849

best validation loss 0.28788492725258114

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0053693534693, 'e_layers': 2, 'learning_rate': 0.0013826506004, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3551868
	speed: 0.0086s/iter; left time: 71.1026s
	iters: 200, epoch: 1 | loss: 1.0466872
	speed: 0.0033s/iter; left time: 26.5538s
	iters: 300, epoch: 1 | loss: 0.9127150
	speed: 0.0033s/iter; left time: 26.7702s
	iters: 400, epoch: 1 | loss: 0.2977602
	speed: 0.0033s/iter; left time: 26.4406s
	iters: 500, epoch: 1 | loss: 0.3458170
	speed: 0.0028s/iter; left time: 22.0105s
	iters: 600, epoch: 1 | loss: 0.1228559
	speed: 0.0028s/iter; left time: 21.5155s
	iters: 700, epoch: 1 | loss: 1.2824506
	speed: 0.0028s/iter; left time: 21.2716s
	iters: 800, epoch: 1 | loss: 0.3878575
	speed: 0.0028s/iter; left time: 21.0280s
	iters: 900, epoch: 1 | loss: 0.4908069
	speed: 0.0027s/iter; left time: 20.4899s
	iters: 1000, epoch: 1 | loss: 1.3541019
	speed: 0.0028s/iter; left time: 20.2444s
Updating learning rate to 0.0013300265953620008
Validation loss decreased (inf --> 0.2826).  Saving model state dict ...
Epoch: 1 cost time: 3.3709020614624023
Epoch: 1, Steps: 1045 | Train Loss: 0.6596239 Vali Loss: 0.2826138 Best vali loss: 0.2826138
	iters: 100, epoch: 2 | loss: 0.5792544
	speed: 0.0098s/iter; left time: 70.4798s
	iters: 200, epoch: 2 | loss: 0.3365333
	speed: 0.0033s/iter; left time: 23.6393s
	iters: 300, epoch: 2 | loss: 0.3239085
	speed: 0.0034s/iter; left time: 23.7057s
	iters: 400, epoch: 2 | loss: 0.2611534
	speed: 0.0033s/iter; left time: 23.0301s
	iters: 500, epoch: 2 | loss: 0.2940876
	speed: 0.0033s/iter; left time: 22.8014s
	iters: 600, epoch: 2 | loss: 0.2861529
	speed: 0.0033s/iter; left time: 22.3295s
	iters: 700, epoch: 2 | loss: 0.1910972
	speed: 0.0033s/iter; left time: 22.0339s
	iters: 800, epoch: 2 | loss: 0.2749384
	speed: 0.0032s/iter; left time: 21.0155s
	iters: 900, epoch: 2 | loss: 0.3160567
	speed: 0.0033s/iter; left time: 20.9439s
	iters: 1000, epoch: 2 | loss: 0.4511954
	speed: 0.0033s/iter; left time: 20.9401s
Updating learning rate to 0.0011801661079772455
Epoch: 2 cost time: 3.507908344268799
Epoch: 2, Steps: 1045 | Train Loss: 0.3314378 Vali Loss: 0.2876687 Best vali loss: 0.2826138
	iters: 100, epoch: 3 | loss: 0.2487561
	speed: 0.0102s/iter; left time: 62.8295s
	iters: 200, epoch: 3 | loss: 0.7588837
	speed: 0.0034s/iter; left time: 20.3654s
	iters: 300, epoch: 3 | loss: 0.3714927
	speed: 0.0031s/iter; left time: 18.4877s
	iters: 400, epoch: 3 | loss: 0.7557777
	speed: 0.0031s/iter; left time: 18.0228s
	iters: 500, epoch: 3 | loss: 1.1520292
	speed: 0.0031s/iter; left time: 17.7178s
	iters: 600, epoch: 3 | loss: 0.2452284
	speed: 0.0031s/iter; left time: 17.3560s
	iters: 700, epoch: 3 | loss: 0.2632333
	speed: 0.0031s/iter; left time: 17.1810s
	iters: 800, epoch: 3 | loss: 0.2299605
	speed: 0.0031s/iter; left time: 16.9271s
	iters: 900, epoch: 3 | loss: 0.1746687
	speed: 0.0031s/iter; left time: 16.5385s
	iters: 1000, epoch: 3 | loss: 0.3397106
	speed: 0.0031s/iter; left time: 16.1876s
Updating learning rate to 0.0009558840389613621
Epoch: 3 cost time: 3.31078839302063
Epoch: 3, Steps: 1045 | Train Loss: 0.4539741 Vali Loss: 0.2842631 Best vali loss: 0.2826138

best validation loss 0.28261377789044123

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010247152722, 'e_layers': 4, 'learning_rate': 0.000820226578, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.1950886
	speed: 0.0110s/iter; left time: 44.9098s
	iters: 200, epoch: 1 | loss: 0.3920419
	speed: 0.0055s/iter; left time: 21.9588s
	iters: 300, epoch: 1 | loss: 0.6036071
	speed: 0.0056s/iter; left time: 21.6168s
	iters: 400, epoch: 1 | loss: 0.9348690
	speed: 0.0055s/iter; left time: 20.9469s
	iters: 500, epoch: 1 | loss: 0.7907286
	speed: 0.0056s/iter; left time: 20.4968s
Updating learning rate to 0.0007890085627179863
Validation loss decreased (inf --> 0.3287).  Saving model state dict ...
Epoch: 1 cost time: 3.1767303943634033
Epoch: 1, Steps: 523 | Train Loss: 0.5832670 Vali Loss: 0.3286887 Best vali loss: 0.3286887
	iters: 100, epoch: 2 | loss: 2.5366209
	speed: 0.0113s/iter; left time: 40.1925s
	iters: 200, epoch: 2 | loss: 0.4650034
	speed: 0.0052s/iter; left time: 18.1643s
	iters: 300, epoch: 2 | loss: 0.6045946
	speed: 0.0053s/iter; left time: 17.6637s
	iters: 400, epoch: 2 | loss: 1.2658520
	speed: 0.0053s/iter; left time: 17.1754s
	iters: 500, epoch: 2 | loss: 0.7334070
	speed: 0.0053s/iter; left time: 16.6110s
Updating learning rate to 0.0007001071767066184
Epoch: 2 cost time: 2.789886713027954
Epoch: 2, Steps: 523 | Train Loss: 1.1210956 Vali Loss: 0.3299013 Best vali loss: 0.3286887
	iters: 100, epoch: 3 | loss: 0.4932686
	speed: 0.0108s/iter; left time: 32.7606s
	iters: 200, epoch: 3 | loss: 0.4601830
	speed: 0.0053s/iter; left time: 15.6295s
	iters: 300, epoch: 3 | loss: 0.6890413
	speed: 0.0053s/iter; left time: 15.0274s
	iters: 400, epoch: 3 | loss: 0.4136600
	speed: 0.0053s/iter; left time: 14.4481s
	iters: 500, epoch: 3 | loss: 0.6351663
	speed: 0.0053s/iter; left time: 13.9733s
Updating learning rate to 0.0005670568500930561
Validation loss decreased (0.3287 --> 0.3263).  Saving model state dict ...
Epoch: 3 cost time: 2.809619903564453
Epoch: 3, Steps: 523 | Train Loss: 0.5382639 Vali Loss: 0.3262900 Best vali loss: 0.3262900

best validation loss 0.32629003952364355

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010144096492, 'e_layers': 2, 'learning_rate': 0.0004823920524, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004823920524
Validation loss decreased (inf --> 0.2791).  Saving model state dict ...
Epoch: 1 cost time: 0.776848316192627
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2791485 Best vali loss: 0.2791485
Updating learning rate to 0.0002411960262
Validation loss decreased (0.2791 --> 0.2756).  Saving model state dict ...
Epoch: 2 cost time: 0.5525815486907959
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2755782 Best vali loss: 0.2755782
Updating learning rate to 0.0001205980131
Validation loss decreased (0.2756 --> 0.2753).  Saving model state dict ...
Epoch: 3 cost time: 0.5551424026489258
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2752683 Best vali loss: 0.2752683

best validation loss 0.2752683331151574

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010144096492, 'e_layers': 2, 'learning_rate': 0.0004823920524, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.029900655e-05
Epoch: 4 cost time: 0.7750325202941895
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2792313 Best vali loss: 0.2752683
Updating learning rate to 3.0149503275e-05
Epoch: 5 cost time: 0.5469467639923096
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2829363 Best vali loss: 0.2752683
Updating learning rate to 1.50747516375e-05
Epoch: 6 cost time: 0.5485413074493408
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2854764 Best vali loss: 0.2752683
Updating learning rate to 7.53737581875e-06
Epoch: 7 cost time: 0.556225061416626
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2885800 Best vali loss: 0.2752683
Updating learning rate to 3.768687909375e-06
Epoch: 8 cost time: 0.5514194965362549
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2885138 Best vali loss: 0.2752683

best validation loss 0.2752683331151574

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0101970370387, 'e_layers': 2, 'learning_rate': 0.0003873649866, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2219667
	speed: 0.0087s/iter; left time: 71.8701s
	iters: 200, epoch: 1 | loss: 0.7064926
	speed: 0.0033s/iter; left time: 27.1809s
	iters: 300, epoch: 1 | loss: 0.3820355
	speed: 0.0034s/iter; left time: 27.3727s
	iters: 400, epoch: 1 | loss: 0.3092728
	speed: 0.0034s/iter; left time: 26.9328s
	iters: 500, epoch: 1 | loss: 0.8590061
	speed: 0.0033s/iter; left time: 26.1016s
	iters: 600, epoch: 1 | loss: 0.1587165
	speed: 0.0033s/iter; left time: 25.8839s
	iters: 700, epoch: 1 | loss: 0.9528393
	speed: 0.0033s/iter; left time: 25.3035s
	iters: 800, epoch: 1 | loss: 0.5982668
	speed: 0.0033s/iter; left time: 24.7999s
	iters: 900, epoch: 1 | loss: 0.5524009
	speed: 0.0032s/iter; left time: 24.1957s
	iters: 1000, epoch: 1 | loss: 0.3722028
	speed: 0.0032s/iter; left time: 23.8417s
Updating learning rate to 0.0003873649866
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 3.727604627609253
Epoch: 1, Steps: 1045 | Train Loss: 0.5113200 Vali Loss: 0.2863604 Best vali loss: 0.2863604
	iters: 100, epoch: 2 | loss: 1.0634538
	speed: 0.0098s/iter; left time: 71.0247s
	iters: 200, epoch: 2 | loss: 0.2205922
	speed: 0.0029s/iter; left time: 20.8593s
	iters: 300, epoch: 2 | loss: 0.2501421
	speed: 0.0029s/iter; left time: 20.3082s
	iters: 400, epoch: 2 | loss: 0.8439047
	speed: 0.0029s/iter; left time: 20.1348s
	iters: 500, epoch: 2 | loss: 0.8637558
	speed: 0.0029s/iter; left time: 19.7428s
	iters: 600, epoch: 2 | loss: 0.1504312
	speed: 0.0029s/iter; left time: 19.4283s
	iters: 700, epoch: 2 | loss: 1.2810724
	speed: 0.0029s/iter; left time: 19.2205s
	iters: 800, epoch: 2 | loss: 0.4043309
	speed: 0.0029s/iter; left time: 18.9199s
	iters: 900, epoch: 2 | loss: 0.4055429
	speed: 0.0029s/iter; left time: 18.5221s
	iters: 1000, epoch: 2 | loss: 0.5238889
	speed: 0.0029s/iter; left time: 18.3382s
Updating learning rate to 0.0001936824933
Validation loss decreased (0.2864 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 3.075174570083618
Epoch: 2, Steps: 1045 | Train Loss: 0.6007115 Vali Loss: 0.2833235 Best vali loss: 0.2833235
	iters: 100, epoch: 3 | loss: 0.2982926
	speed: 0.0099s/iter; left time: 60.8478s
	iters: 200, epoch: 3 | loss: 0.3806376
	speed: 0.0031s/iter; left time: 18.5703s
	iters: 300, epoch: 3 | loss: 0.4173605
	speed: 0.0030s/iter; left time: 18.1605s
	iters: 400, epoch: 3 | loss: 1.7759643
	speed: 0.0030s/iter; left time: 17.7353s
	iters: 500, epoch: 3 | loss: 0.3821331
	speed: 0.0031s/iter; left time: 17.6438s
	iters: 600, epoch: 3 | loss: 0.1684171
	speed: 0.0031s/iter; left time: 17.3631s
	iters: 700, epoch: 3 | loss: 0.3346452
	speed: 0.0031s/iter; left time: 17.1608s
	iters: 800, epoch: 3 | loss: 0.5682730
	speed: 0.0030s/iter; left time: 16.5295s
	iters: 900, epoch: 3 | loss: 0.3871872
	speed: 0.0030s/iter; left time: 16.2286s
	iters: 1000, epoch: 3 | loss: 0.5283134
	speed: 0.0030s/iter; left time: 15.6400s
Updating learning rate to 9.684124665e-05
Epoch: 3 cost time: 3.2106258869171143
Epoch: 3, Steps: 1045 | Train Loss: 0.5241224 Vali Loss: 0.2857670 Best vali loss: 0.2833235
	iters: 100, epoch: 4 | loss: 0.2619882
	speed: 0.0096s/iter; left time: 49.3595s
	iters: 200, epoch: 4 | loss: 0.8601077
	speed: 0.0031s/iter; left time: 15.4472s
	iters: 300, epoch: 4 | loss: 0.1469744
	speed: 0.0030s/iter; left time: 14.9411s
	iters: 400, epoch: 4 | loss: 0.1849125
	speed: 0.0030s/iter; left time: 14.6909s
	iters: 500, epoch: 4 | loss: 0.9269180
	speed: 0.0030s/iter; left time: 14.3232s
	iters: 600, epoch: 4 | loss: 0.3886370
	speed: 0.0034s/iter; left time: 15.9232s
	iters: 700, epoch: 4 | loss: 0.2291598
	speed: 0.0034s/iter; left time: 15.5029s
	iters: 800, epoch: 4 | loss: 0.2604243
	speed: 0.0032s/iter; left time: 14.1624s
	iters: 900, epoch: 4 | loss: 0.1936248
	speed: 0.0031s/iter; left time: 13.5426s
	iters: 1000, epoch: 4 | loss: 0.6514933
	speed: 0.0031s/iter; left time: 13.1437s
Updating learning rate to 4.8420623325e-05
Epoch: 4 cost time: 3.3261637687683105
Epoch: 4, Steps: 1045 | Train Loss: 0.4104240 Vali Loss: 0.2924353 Best vali loss: 0.2833235
	iters: 100, epoch: 5 | loss: 0.2780232
	speed: 0.0100s/iter; left time: 40.7765s
	iters: 200, epoch: 5 | loss: 1.0852637
	speed: 0.0031s/iter; left time: 12.2091s
	iters: 300, epoch: 5 | loss: 0.3284224
	speed: 0.0030s/iter; left time: 11.6044s
	iters: 400, epoch: 5 | loss: 0.5401307
	speed: 0.0030s/iter; left time: 11.1890s
	iters: 500, epoch: 5 | loss: 0.4444370
	speed: 0.0030s/iter; left time: 10.9313s
	iters: 600, epoch: 5 | loss: 0.3151242
	speed: 0.0030s/iter; left time: 10.6381s
	iters: 700, epoch: 5 | loss: 0.1477654
	speed: 0.0030s/iter; left time: 10.5030s
	iters: 800, epoch: 5 | loss: 0.1716507
	speed: 0.0030s/iter; left time: 10.0222s
	iters: 900, epoch: 5 | loss: 0.7455197
	speed: 0.0030s/iter; left time: 9.6824s
	iters: 1000, epoch: 5 | loss: 0.3193907
	speed: 0.0029s/iter; left time: 9.3531s
Updating learning rate to 2.42103116625e-05
Epoch: 5 cost time: 3.1589114665985107
Epoch: 5, Steps: 1045 | Train Loss: 0.4375728 Vali Loss: 0.2908839 Best vali loss: 0.2833235
	iters: 100, epoch: 6 | loss: 0.2108502
	speed: 0.0099s/iter; left time: 30.1504s
	iters: 200, epoch: 6 | loss: 0.2772539
	speed: 0.0033s/iter; left time: 9.6285s
	iters: 300, epoch: 6 | loss: 0.5092342
	speed: 0.0032s/iter; left time: 9.1911s
	iters: 400, epoch: 6 | loss: 0.8190774
	speed: 0.0033s/iter; left time: 9.0602s
	iters: 500, epoch: 6 | loss: 0.2122483
	speed: 0.0033s/iter; left time: 8.5787s
	iters: 600, epoch: 6 | loss: 0.9843741
	speed: 0.0032s/iter; left time: 8.2149s
	iters: 700, epoch: 6 | loss: 0.1379350
	speed: 0.0031s/iter; left time: 7.4840s
	iters: 800, epoch: 6 | loss: 0.3275492
	speed: 0.0030s/iter; left time: 7.1194s
	iters: 900, epoch: 6 | loss: 0.2257145
	speed: 0.0031s/iter; left time: 6.9146s
	iters: 1000, epoch: 6 | loss: 0.4099541
	speed: 0.0030s/iter; left time: 6.4040s
Updating learning rate to 1.210515583125e-05
Epoch: 6 cost time: 3.3615615367889404
Epoch: 6, Steps: 1045 | Train Loss: 0.4114191 Vali Loss: 0.2905433 Best vali loss: 0.2833235
	iters: 100, epoch: 7 | loss: 0.2751777
	speed: 0.0101s/iter; left time: 20.0621s
	iters: 200, epoch: 7 | loss: 0.2843103
	speed: 0.0033s/iter; left time: 6.2229s
	iters: 300, epoch: 7 | loss: 0.7152550
	speed: 0.0033s/iter; left time: 5.8540s
	iters: 400, epoch: 7 | loss: 0.3610615
	speed: 0.0032s/iter; left time: 5.4700s
	iters: 500, epoch: 7 | loss: 0.5159409
	speed: 0.0033s/iter; left time: 5.2322s
	iters: 600, epoch: 7 | loss: 0.3670209
	speed: 0.0033s/iter; left time: 4.9300s
	iters: 700, epoch: 7 | loss: 0.3015840
	speed: 0.0033s/iter; left time: 4.5905s
	iters: 800, epoch: 7 | loss: 0.6142550
	speed: 0.0033s/iter; left time: 4.2049s
	iters: 900, epoch: 7 | loss: 0.1442755
	speed: 0.0033s/iter; left time: 3.9250s
	iters: 1000, epoch: 7 | loss: 0.4761769
	speed: 0.0033s/iter; left time: 3.6055s
Updating learning rate to 6.052577915625e-06
Epoch: 7 cost time: 3.469005584716797
Epoch: 7, Steps: 1045 | Train Loss: 0.4055058 Vali Loss: 0.2909345 Best vali loss: 0.2833235
	iters: 100, epoch: 8 | loss: 0.2615000
	speed: 0.0100s/iter; left time: 9.4368s
	iters: 200, epoch: 8 | loss: 0.4116079
	speed: 0.0033s/iter; left time: 2.8319s
	iters: 300, epoch: 8 | loss: 0.3179871
	speed: 0.0033s/iter; left time: 2.4764s
	iters: 400, epoch: 8 | loss: 0.7878496
	speed: 0.0033s/iter; left time: 2.1621s
	iters: 500, epoch: 8 | loss: 0.3285763
	speed: 0.0033s/iter; left time: 1.8213s
	iters: 600, epoch: 8 | loss: 0.4441844
	speed: 0.0033s/iter; left time: 1.4826s
	iters: 700, epoch: 8 | loss: 0.3077570
	speed: 0.0033s/iter; left time: 1.1463s
	iters: 800, epoch: 8 | loss: 0.7992886
	speed: 0.0033s/iter; left time: 0.8139s
	iters: 900, epoch: 8 | loss: 0.2565523
	speed: 0.0033s/iter; left time: 0.4850s
	iters: 1000, epoch: 8 | loss: 1.2888688
	speed: 0.0033s/iter; left time: 0.1527s
Updating learning rate to 3.0262889578125e-06
Epoch: 8 cost time: 3.5124928951263428
Epoch: 8, Steps: 1045 | Train Loss: 0.5204172 Vali Loss: 0.2904688 Best vali loss: 0.2833235

best validation loss 0.2833234959816392

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0035302435028, 'e_layers': 4, 'learning_rate': 0.0001024997956, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 9.859862942071522e-05
Validation loss decreased (inf --> 0.2976).  Saving model state dict ...
Epoch: 1 cost time: 0.6523561477661133
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2976037 Best vali loss: 0.2976037
Updating learning rate to 8.748904806949751e-05
Validation loss decreased (0.2976 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 0.4629807472229004
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2849519 Best vali loss: 0.2849519
Updating learning rate to 7.086238459846407e-05
Validation loss decreased (0.2850 --> 0.2812).  Saving model state dict ...
Epoch: 3 cost time: 0.46732330322265625
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2812169 Best vali loss: 0.2812169
Updating learning rate to 5.12498978e-05
Validation loss decreased (0.2812 --> 0.2796).  Saving model state dict ...
Epoch: 4 cost time: 0.4258720874786377
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2796256 Best vali loss: 0.2796256
Updating learning rate to 3.1637411001535935e-05
Epoch: 5 cost time: 0.4432344436645508
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2812707 Best vali loss: 0.2796256
Updating learning rate to 1.5010747530502478e-05
Epoch: 6 cost time: 0.4195992946624756
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2804122 Best vali loss: 0.2796256
Updating learning rate to 3.901166179284777e-06
Epoch: 7 cost time: 0.42701244354248047
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2803916 Best vali loss: 0.2796256
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4609193801879883
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2803790 Best vali loss: 0.2796256

best validation loss 0.2796256207442275

[INFO][smbo.py:320] Finished 1050 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033394601555, 'e_layers': 4, 'learning_rate': 0.0001797120479, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3426008
	speed: 0.0103s/iter; left time: 85.4456s
	iters: 200, epoch: 1 | loss: 0.3122496
	speed: 0.0051s/iter; left time: 41.7706s
	iters: 300, epoch: 1 | loss: 0.3493339
	speed: 0.0052s/iter; left time: 42.0220s
	iters: 400, epoch: 1 | loss: 0.4122522
	speed: 0.0052s/iter; left time: 41.6548s
	iters: 500, epoch: 1 | loss: 0.3327300
	speed: 0.0051s/iter; left time: 40.0121s
	iters: 600, epoch: 1 | loss: 1.4263090
	speed: 0.0051s/iter; left time: 39.6150s
	iters: 700, epoch: 1 | loss: 0.8113346
	speed: 0.0051s/iter; left time: 39.1620s
	iters: 800, epoch: 1 | loss: 0.3475377
	speed: 0.0051s/iter; left time: 38.6684s
	iters: 900, epoch: 1 | loss: 0.2586527
	speed: 0.0051s/iter; left time: 37.7426s
	iters: 1000, epoch: 1 | loss: 0.5198598
	speed: 0.0051s/iter; left time: 37.3113s
Updating learning rate to 0.00017287216535024898
Validation loss decreased (inf --> 0.2824).  Saving model state dict ...
Epoch: 1 cost time: 5.622064113616943
Epoch: 1, Steps: 1045 | Train Loss: 0.5112860 Vali Loss: 0.2824211 Best vali loss: 0.2824211
	iters: 100, epoch: 2 | loss: 0.5659448
	speed: 0.0147s/iter; left time: 106.0191s
	iters: 200, epoch: 2 | loss: 0.4752416
	speed: 0.0052s/iter; left time: 36.9871s
	iters: 300, epoch: 2 | loss: 0.7472331
	speed: 0.0051s/iter; left time: 36.0103s
	iters: 400, epoch: 2 | loss: 0.8542452
	speed: 0.0051s/iter; left time: 35.4668s
	iters: 500, epoch: 2 | loss: 0.2255794
	speed: 0.0048s/iter; left time: 32.4870s
	iters: 600, epoch: 2 | loss: 0.2068004
	speed: 0.0047s/iter; left time: 31.6970s
	iters: 700, epoch: 2 | loss: 0.2087465
	speed: 0.0045s/iter; left time: 29.7941s
	iters: 800, epoch: 2 | loss: 0.4227306
	speed: 0.0045s/iter; left time: 29.2954s
	iters: 900, epoch: 2 | loss: 0.2454842
	speed: 0.0045s/iter; left time: 29.0569s
	iters: 1000, epoch: 2 | loss: 0.5079007
	speed: 0.0046s/iter; left time: 28.9327s
Updating learning rate to 0.00015339382781550583
Epoch: 2 cost time: 5.064803123474121
Epoch: 2, Steps: 1045 | Train Loss: 0.4459906 Vali Loss: 0.2854544 Best vali loss: 0.2824211
	iters: 100, epoch: 3 | loss: 0.2367087
	speed: 0.0132s/iter; left time: 81.2751s
	iters: 200, epoch: 3 | loss: 0.8493060
	speed: 0.0045s/iter; left time: 27.2987s
	iters: 300, epoch: 3 | loss: 0.2491560
	speed: 0.0045s/iter; left time: 26.9816s
	iters: 400, epoch: 3 | loss: 0.5632560
	speed: 0.0045s/iter; left time: 26.6789s
	iters: 500, epoch: 3 | loss: 0.3824565
	speed: 0.0045s/iter; left time: 26.1487s
	iters: 600, epoch: 3 | loss: 0.2458406
	speed: 0.0045s/iter; left time: 25.6053s
	iters: 700, epoch: 3 | loss: 0.6581206
	speed: 0.0045s/iter; left time: 25.0498s
	iters: 800, epoch: 3 | loss: 0.3938909
	speed: 0.0045s/iter; left time: 24.6967s
	iters: 900, epoch: 3 | loss: 0.6257449
	speed: 0.0045s/iter; left time: 24.2258s
	iters: 1000, epoch: 3 | loss: 0.2465630
	speed: 0.0046s/iter; left time: 24.0246s
Updating learning rate to 0.00012424243561386572
Validation loss decreased (0.2824 --> 0.2804).  Saving model state dict ...
Epoch: 3 cost time: 4.759199142456055
Epoch: 3, Steps: 1045 | Train Loss: 0.4451043 Vali Loss: 0.2804097 Best vali loss: 0.2804097

best validation loss 0.2804096696455712

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027028157436, 'e_layers': 3, 'learning_rate': 0.0004009713301, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7119638
	speed: 0.0097s/iter; left time: 39.4577s
	iters: 200, epoch: 1 | loss: 0.3555964
	speed: 0.0043s/iter; left time: 17.1385s
	iters: 300, epoch: 1 | loss: 0.3690509
	speed: 0.0042s/iter; left time: 16.4585s
	iters: 400, epoch: 1 | loss: 0.2371345
	speed: 0.0042s/iter; left time: 16.0211s
	iters: 500, epoch: 1 | loss: 0.9849441
	speed: 0.0042s/iter; left time: 15.5486s
Updating learning rate to 0.0004009713301
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 2.4961462020874023
Epoch: 1, Steps: 523 | Train Loss: 0.5317379 Vali Loss: 0.2848546 Best vali loss: 0.2848546
	iters: 100, epoch: 2 | loss: 0.6627058
	speed: 0.0088s/iter; left time: 31.4653s
	iters: 200, epoch: 2 | loss: 0.9546438
	speed: 0.0043s/iter; left time: 14.8514s
	iters: 300, epoch: 2 | loss: 0.2375677
	speed: 0.0042s/iter; left time: 14.2880s
	iters: 400, epoch: 2 | loss: 0.6673884
	speed: 0.0043s/iter; left time: 13.9541s
	iters: 500, epoch: 2 | loss: 0.2710417
	speed: 0.0042s/iter; left time: 13.3475s
Updating learning rate to 0.00020048566505
Validation loss decreased (0.2849 --> 0.2823).  Saving model state dict ...
Epoch: 2 cost time: 2.268921375274658
Epoch: 2, Steps: 523 | Train Loss: 0.5586695 Vali Loss: 0.2822909 Best vali loss: 0.2822909
	iters: 100, epoch: 3 | loss: 0.3471477
	speed: 0.0087s/iter; left time: 26.4564s
	iters: 200, epoch: 3 | loss: 0.4010819
	speed: 0.0043s/iter; left time: 12.5007s
	iters: 300, epoch: 3 | loss: 0.6649806
	speed: 0.0042s/iter; left time: 12.0314s
	iters: 400, epoch: 3 | loss: 0.4405316
	speed: 0.0042s/iter; left time: 11.5693s
	iters: 500, epoch: 3 | loss: 0.7697741
	speed: 0.0043s/iter; left time: 11.2760s
Updating learning rate to 0.000100242832525
Validation loss decreased (0.2823 --> 0.2817).  Saving model state dict ...
Epoch: 3 cost time: 2.2663280963897705
Epoch: 3, Steps: 523 | Train Loss: 0.5247032 Vali Loss: 0.2817056 Best vali loss: 0.2817056

best validation loss 0.28170556419065956

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0020106702993, 'e_layers': 4, 'learning_rate': 0.0010195485949, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6356766
	speed: 0.0107s/iter; left time: 21.3847s
	iters: 200, epoch: 1 | loss: 0.4074533
	speed: 0.0054s/iter; left time: 10.1823s
Updating learning rate to 0.0009807443370643757
Validation loss decreased (inf --> 0.3179).  Saving model state dict ...
Epoch: 1 cost time: 1.6752848625183105
Epoch: 1, Steps: 262 | Train Loss: 0.5215649 Vali Loss: 0.3179140 Best vali loss: 0.3179140
	iters: 100, epoch: 2 | loss: 0.7071530
	speed: 0.0109s/iter; left time: 18.9617s
	iters: 200, epoch: 2 | loss: 0.4066356
	speed: 0.0049s/iter; left time: 7.9591s
Updating learning rate to 0.0008702391600515032
Validation loss decreased (0.3179 --> 0.2999).  Saving model state dict ...
Epoch: 2 cost time: 1.3385202884674072
Epoch: 2, Steps: 262 | Train Loss: 0.5568943 Vali Loss: 0.2999227 Best vali loss: 0.2999227
	iters: 100, epoch: 3 | loss: 0.5702233
	speed: 0.0111s/iter; left time: 16.3315s
	iters: 200, epoch: 3 | loss: 0.4815852
	speed: 0.0050s/iter; left time: 6.8920s
Updating learning rate to 0.0007048564753296683
Validation loss decreased (0.2999 --> 0.2957).  Saving model state dict ...
Epoch: 3 cost time: 1.3517067432403564
Epoch: 3, Steps: 262 | Train Loss: 0.5259043 Vali Loss: 0.2956511 Best vali loss: 0.2956511

best validation loss 0.2956511133242026

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033394601555, 'e_layers': 4, 'learning_rate': 0.0001797120479, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3130019
	speed: 0.0106s/iter; left time: 54.1723s
	iters: 200, epoch: 4 | loss: 0.3297632
	speed: 0.0051s/iter; left time: 25.5826s
	iters: 300, epoch: 4 | loss: 0.2828593
	speed: 0.0051s/iter; left time: 25.3139s
	iters: 400, epoch: 4 | loss: 0.3912256
	speed: 0.0051s/iter; left time: 24.6936s
	iters: 500, epoch: 4 | loss: 0.2845168
	speed: 0.0052s/iter; left time: 24.3552s
	iters: 600, epoch: 4 | loss: 0.9938526
	speed: 0.0051s/iter; left time: 23.7873s
	iters: 700, epoch: 4 | loss: 0.5460808
	speed: 0.0051s/iter; left time: 23.2337s
	iters: 800, epoch: 4 | loss: 0.2699638
	speed: 0.0051s/iter; left time: 22.7219s
	iters: 900, epoch: 4 | loss: 0.2361039
	speed: 0.0051s/iter; left time: 22.2443s
	iters: 1000, epoch: 4 | loss: 0.4434513
	speed: 0.0052s/iter; left time: 21.8124s
Updating learning rate to 8.985602395e-05
Epoch: 4 cost time: 5.631030321121216
Epoch: 4, Steps: 1045 | Train Loss: 0.4090819 Vali Loss: 0.2817427 Best vali loss: 0.2804097
	iters: 100, epoch: 5 | loss: 0.4312054
	speed: 0.0142s/iter; left time: 58.0872s
	iters: 200, epoch: 5 | loss: 0.3891883
	speed: 0.0052s/iter; left time: 20.7146s
	iters: 300, epoch: 5 | loss: 0.4121089
	speed: 0.0052s/iter; left time: 20.0351s
	iters: 400, epoch: 5 | loss: 0.6823999
	speed: 0.0052s/iter; left time: 19.5616s
	iters: 500, epoch: 5 | loss: 0.2000975
	speed: 0.0052s/iter; left time: 19.1584s
	iters: 600, epoch: 5 | loss: 0.1674984
	speed: 0.0052s/iter; left time: 18.6317s
	iters: 700, epoch: 5 | loss: 0.1688579
	speed: 0.0052s/iter; left time: 18.1741s
	iters: 800, epoch: 5 | loss: 0.3054663
	speed: 0.0052s/iter; left time: 17.5848s
	iters: 900, epoch: 5 | loss: 0.2319256
	speed: 0.0052s/iter; left time: 17.1866s
	iters: 1000, epoch: 5 | loss: 0.3241856
	speed: 0.0051s/iter; left time: 16.1517s
Updating learning rate to 5.546961228613429e-05
Epoch: 5 cost time: 5.440033674240112
Epoch: 5, Steps: 1045 | Train Loss: 0.3312934 Vali Loss: 0.2882004 Best vali loss: 0.2804097
	iters: 100, epoch: 6 | loss: 0.2293365
	speed: 0.0137s/iter; left time: 41.7410s
	iters: 200, epoch: 6 | loss: 0.7052578
	speed: 0.0048s/iter; left time: 14.2394s
	iters: 300, epoch: 6 | loss: 0.2272847
	speed: 0.0048s/iter; left time: 13.6551s
	iters: 400, epoch: 6 | loss: 0.4383138
	speed: 0.0049s/iter; left time: 13.2932s
	iters: 500, epoch: 6 | loss: 0.3492277
	speed: 0.0048s/iter; left time: 12.7544s
	iters: 600, epoch: 6 | loss: 0.2364798
	speed: 0.0049s/iter; left time: 12.3431s
	iters: 700, epoch: 6 | loss: 0.5278293
	speed: 0.0049s/iter; left time: 11.9984s
	iters: 800, epoch: 6 | loss: 0.3685248
	speed: 0.0051s/iter; left time: 11.9333s
	iters: 900, epoch: 6 | loss: 0.4999549
	speed: 0.0052s/iter; left time: 11.6229s
	iters: 1000, epoch: 6 | loss: 0.2408551
	speed: 0.0052s/iter; left time: 11.0106s
Updating learning rate to 2.6318220084494182e-05
Epoch: 6 cost time: 5.217159986495972
Epoch: 6, Steps: 1045 | Train Loss: 0.3823064 Vali Loss: 0.2862581 Best vali loss: 0.2804097
	iters: 100, epoch: 7 | loss: 0.6147343
	speed: 0.0143s/iter; left time: 28.5280s
	iters: 200, epoch: 7 | loss: 0.2160206
	speed: 0.0052s/iter; left time: 9.7435s
	iters: 300, epoch: 7 | loss: 0.4560612
	speed: 0.0052s/iter; left time: 9.2669s
	iters: 400, epoch: 7 | loss: 0.2135376
	speed: 0.0052s/iter; left time: 8.7549s
	iters: 500, epoch: 7 | loss: 0.1448260
	speed: 0.0051s/iter; left time: 8.1044s
	iters: 600, epoch: 7 | loss: 0.4761448
	speed: 0.0051s/iter; left time: 7.6326s
	iters: 700, epoch: 7 | loss: 0.1907259
	speed: 0.0051s/iter; left time: 7.0677s
	iters: 800, epoch: 7 | loss: 0.3160405
	speed: 0.0051s/iter; left time: 6.5712s
	iters: 900, epoch: 7 | loss: 0.2120062
	speed: 0.0052s/iter; left time: 6.1973s
	iters: 1000, epoch: 7 | loss: 0.1898908
	speed: 0.0052s/iter; left time: 5.6201s
Updating learning rate to 6.839882549751015e-06
Epoch: 7 cost time: 5.401944398880005
Epoch: 7, Steps: 1045 | Train Loss: 0.3029988 Vali Loss: 0.2882923 Best vali loss: 0.2804097
	iters: 100, epoch: 8 | loss: 0.3481562
	speed: 0.0139s/iter; left time: 13.1825s
	iters: 200, epoch: 8 | loss: 0.3027962
	speed: 0.0047s/iter; left time: 3.9676s
	iters: 300, epoch: 8 | loss: 0.2948374
	speed: 0.0047s/iter; left time: 3.4952s
	iters: 400, epoch: 8 | loss: 0.5443355
	speed: 0.0046s/iter; left time: 2.9872s
	iters: 500, epoch: 8 | loss: 0.3871477
	speed: 0.0047s/iter; left time: 2.5430s
	iters: 600, epoch: 8 | loss: 0.1966075
	speed: 0.0046s/iter; left time: 2.0737s
	iters: 700, epoch: 8 | loss: 0.1597121
	speed: 0.0046s/iter; left time: 1.5907s
	iters: 800, epoch: 8 | loss: 0.2454667
	speed: 0.0046s/iter; left time: 1.1354s
	iters: 900, epoch: 8 | loss: 0.1772290
	speed: 0.0047s/iter; left time: 0.6835s
	iters: 1000, epoch: 8 | loss: 0.1197788
	speed: 0.0046s/iter; left time: 0.2129s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.91119384765625
Epoch: 8, Steps: 1045 | Train Loss: 0.2776067 Vali Loss: 0.2883274 Best vali loss: 0.2804097

best validation loss 0.2804096696455712

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0114255908324, 'e_layers': 3, 'learning_rate': 6.13856019e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4216604
	speed: 0.0093s/iter; left time: 38.1481s
	iters: 200, epoch: 1 | loss: 0.4187682
	speed: 0.0039s/iter; left time: 15.6152s
	iters: 300, epoch: 1 | loss: 0.3392207
	speed: 0.0039s/iter; left time: 15.3421s
	iters: 400, epoch: 1 | loss: 0.6735873
	speed: 0.0039s/iter; left time: 14.9060s
	iters: 500, epoch: 1 | loss: 0.3321090
	speed: 0.0040s/iter; left time: 14.5683s
Updating learning rate to 5.9049251543147975e-05
Validation loss decreased (inf --> 0.3176).  Saving model state dict ...
Epoch: 1 cost time: 2.3232922554016113
Epoch: 1, Steps: 523 | Train Loss: 0.4370691 Vali Loss: 0.3175868 Best vali loss: 0.3175868
	iters: 100, epoch: 2 | loss: 0.5751241
	speed: 0.0084s/iter; left time: 29.9704s
	iters: 200, epoch: 2 | loss: 0.3987918
	speed: 0.0039s/iter; left time: 13.4694s
	iters: 300, epoch: 2 | loss: 0.5706112
	speed: 0.0039s/iter; left time: 13.2106s
	iters: 400, epoch: 2 | loss: 0.4090653
	speed: 0.0039s/iter; left time: 12.8273s
	iters: 500, epoch: 2 | loss: 0.4270496
	speed: 0.0039s/iter; left time: 12.4343s
Updating learning rate to 5.23958886353539e-05
Validation loss decreased (0.3176 --> 0.3022).  Saving model state dict ...
Epoch: 2 cost time: 2.086111068725586
Epoch: 2, Steps: 523 | Train Loss: 0.4761284 Vali Loss: 0.3022263 Best vali loss: 0.3022263
	iters: 100, epoch: 3 | loss: 0.7851728
	speed: 0.0085s/iter; left time: 25.7886s
	iters: 200, epoch: 3 | loss: 1.1068727
	speed: 0.0037s/iter; left time: 10.8345s
	iters: 300, epoch: 3 | loss: 0.3012968
	speed: 0.0038s/iter; left time: 10.8802s
	iters: 400, epoch: 3 | loss: 0.2973551
	speed: 0.0040s/iter; left time: 11.0085s
	iters: 500, epoch: 3 | loss: 0.9117923
	speed: 0.0039s/iter; left time: 10.3666s
Updating learning rate to 4.243842736644449e-05
Validation loss decreased (0.3022 --> 0.2951).  Saving model state dict ...
Epoch: 3 cost time: 2.0436198711395264
Epoch: 3, Steps: 523 | Train Loss: 0.6804979 Vali Loss: 0.2950780 Best vali loss: 0.2950780
	iters: 100, epoch: 4 | loss: 0.4270384
	speed: 0.0083s/iter; left time: 20.9591s
	iters: 200, epoch: 4 | loss: 0.5231724
	speed: 0.0040s/iter; left time: 9.5951s
	iters: 300, epoch: 4 | loss: 0.7247626
	speed: 0.0040s/iter; left time: 9.2605s
	iters: 400, epoch: 4 | loss: 0.3505998
	speed: 0.0040s/iter; left time: 8.7796s
	iters: 500, epoch: 4 | loss: 0.4194438
	speed: 0.0040s/iter; left time: 8.3956s
Updating learning rate to 3.069280095e-05
Validation loss decreased (0.2951 --> 0.2908).  Saving model state dict ...
Epoch: 4 cost time: 2.1167690753936768
Epoch: 4, Steps: 523 | Train Loss: 0.4890034 Vali Loss: 0.2908242 Best vali loss: 0.2908242
	iters: 100, epoch: 5 | loss: 0.2467804
	speed: 0.0083s/iter; left time: 16.6336s
	iters: 200, epoch: 5 | loss: 0.2372377
	speed: 0.0040s/iter; left time: 7.5735s
	iters: 300, epoch: 5 | loss: 0.3156435
	speed: 0.0040s/iter; left time: 7.1664s
	iters: 400, epoch: 5 | loss: 0.4778818
	speed: 0.0040s/iter; left time: 6.7537s
	iters: 500, epoch: 5 | loss: 0.6642884
	speed: 0.0040s/iter; left time: 6.3720s
Updating learning rate to 1.8947174533555512e-05
Validation loss decreased (0.2908 --> 0.2886).  Saving model state dict ...
Epoch: 5 cost time: 2.128430128097534
Epoch: 5, Steps: 523 | Train Loss: 0.3883664 Vali Loss: 0.2886352 Best vali loss: 0.2886352
	iters: 100, epoch: 6 | loss: 0.2468573
	speed: 0.0079s/iter; left time: 11.6494s
	iters: 200, epoch: 6 | loss: 0.2359426
	speed: 0.0036s/iter; left time: 4.8815s
	iters: 300, epoch: 6 | loss: 0.5217342
	speed: 0.0035s/iter; left time: 4.4486s
	iters: 400, epoch: 6 | loss: 0.8100988
	speed: 0.0037s/iter; left time: 4.3063s
	iters: 500, epoch: 6 | loss: 0.3476944
	speed: 0.0040s/iter; left time: 4.2796s
Updating learning rate to 8.989713264646093e-06
Validation loss decreased (0.2886 --> 0.2875).  Saving model state dict ...
Epoch: 6 cost time: 1.96044921875
Epoch: 6, Steps: 523 | Train Loss: 0.4324654 Vali Loss: 0.2875058 Best vali loss: 0.2875058
	iters: 100, epoch: 7 | loss: 0.8054070
	speed: 0.0088s/iter; left time: 8.2882s
	iters: 200, epoch: 7 | loss: 0.3650501
	speed: 0.0043s/iter; left time: 3.6471s
	iters: 300, epoch: 7 | loss: 0.3071500
	speed: 0.0042s/iter; left time: 3.1528s
	iters: 400, epoch: 7 | loss: 0.2835360
	speed: 0.0043s/iter; left time: 2.7961s
	iters: 500, epoch: 7 | loss: 0.3709607
	speed: 0.0042s/iter; left time: 2.3055s
Updating learning rate to 2.3363503568520225e-06
Validation loss decreased (0.2875 --> 0.2871).  Saving model state dict ...
Epoch: 7 cost time: 2.269981861114502
Epoch: 7, Steps: 523 | Train Loss: 0.4264208 Vali Loss: 0.2870742 Best vali loss: 0.2870742
	iters: 100, epoch: 8 | loss: 0.5767532
	speed: 0.0087s/iter; left time: 3.7067s
	iters: 200, epoch: 8 | loss: 0.3487503
	speed: 0.0043s/iter; left time: 1.3869s
	iters: 300, epoch: 8 | loss: 0.6815673
	speed: 0.0043s/iter; left time: 0.9585s
	iters: 400, epoch: 8 | loss: 0.7648615
	speed: 0.0043s/iter; left time: 0.5329s
	iters: 500, epoch: 8 | loss: 1.0427581
	speed: 0.0043s/iter; left time: 0.1027s
Updating learning rate to 0.0
Validation loss decreased (0.2871 --> 0.2870).  Saving model state dict ...
Epoch: 8 cost time: 2.2755701541900635
Epoch: 8, Steps: 523 | Train Loss: 0.6829381 Vali Loss: 0.2869660 Best vali loss: 0.2869660

best validation loss 0.2869660322242352

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0075428915345, 'e_layers': 4, 'learning_rate': 0.0038691790486, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3811382
	speed: 0.0104s/iter; left time: 42.5228s
	iters: 200, epoch: 1 | loss: 0.2703027
	speed: 0.0051s/iter; left time: 20.4752s
	iters: 300, epoch: 1 | loss: 1.3038386
	speed: 0.0052s/iter; left time: 20.3547s
	iters: 400, epoch: 1 | loss: 0.8242965
	speed: 0.0052s/iter; left time: 19.5896s
	iters: 500, epoch: 1 | loss: 0.3893054
	speed: 0.0052s/iter; left time: 19.2142s
Updating learning rate to 0.0037219171896115165
Validation loss decreased (inf --> 0.2966).  Saving model state dict ...
Epoch: 1 cost time: 2.9621684551239014
Epoch: 1, Steps: 523 | Train Loss: 0.6337763 Vali Loss: 0.2965509 Best vali loss: 0.2965509
	iters: 100, epoch: 2 | loss: 0.7571270
	speed: 0.0101s/iter; left time: 35.8472s
	iters: 200, epoch: 2 | loss: 0.2486158
	speed: 0.0050s/iter; left time: 17.2431s
	iters: 300, epoch: 2 | loss: 1.1857756
	speed: 0.0050s/iter; left time: 16.7756s
	iters: 400, epoch: 2 | loss: 0.3159467
	speed: 0.0052s/iter; left time: 16.8282s
	iters: 500, epoch: 2 | loss: 0.4036682
	speed: 0.0052s/iter; left time: 16.4653s
Updating learning rate to 0.003302550895744987
Validation loss decreased (0.2966 --> 0.2920).  Saving model state dict ...
Epoch: 2 cost time: 2.6921305656433105
Epoch: 2, Steps: 523 | Train Loss: 0.5822267 Vali Loss: 0.2920313 Best vali loss: 0.2920313
	iters: 100, epoch: 3 | loss: 0.4299330
	speed: 0.0098s/iter; left time: 29.7349s
	iters: 200, epoch: 3 | loss: 0.5777121
	speed: 0.0046s/iter; left time: 13.6240s
	iters: 300, epoch: 3 | loss: 0.5824752
	speed: 0.0044s/iter; left time: 12.3923s
	iters: 400, epoch: 3 | loss: 0.7147626
	speed: 0.0044s/iter; left time: 11.9627s
	iters: 500, epoch: 3 | loss: 1.4460014
	speed: 0.0044s/iter; left time: 11.5215s
Updating learning rate to 0.0026749248836766704
Epoch: 3 cost time: 2.3860065937042236
Epoch: 3, Steps: 523 | Train Loss: 0.7501769 Vali Loss: 0.2976600 Best vali loss: 0.2920313
	iters: 100, epoch: 4 | loss: 0.4513539
	speed: 0.0099s/iter; left time: 24.8610s
	iters: 200, epoch: 4 | loss: 0.8323688
	speed: 0.0050s/iter; left time: 12.0854s
	iters: 300, epoch: 4 | loss: 0.5378400
	speed: 0.0050s/iter; left time: 11.6517s
	iters: 400, epoch: 4 | loss: 0.4272357
	speed: 0.0051s/iter; left time: 11.2874s
	iters: 500, epoch: 4 | loss: 0.5479566
	speed: 0.0051s/iter; left time: 10.8783s
Updating learning rate to 0.0019345895243
Validation loss decreased (0.2920 --> 0.2896).  Saving model state dict ...
Epoch: 4 cost time: 2.6867942810058594
Epoch: 4, Steps: 523 | Train Loss: 0.5593510 Vali Loss: 0.2896381 Best vali loss: 0.2896381
	iters: 100, epoch: 5 | loss: 1.0306879
	speed: 0.0101s/iter; left time: 20.1568s
	iters: 200, epoch: 5 | loss: 0.3421679
	speed: 0.0050s/iter; left time: 9.5460s
	iters: 300, epoch: 5 | loss: 0.8592111
	speed: 0.0050s/iter; left time: 9.0179s
	iters: 400, epoch: 5 | loss: 0.1964827
	speed: 0.0051s/iter; left time: 8.6020s
	iters: 500, epoch: 5 | loss: 0.2707402
	speed: 0.0050s/iter; left time: 8.0243s
Updating learning rate to 0.0011942541649233298
Epoch: 5 cost time: 2.6801798343658447
Epoch: 5, Steps: 523 | Train Loss: 0.5398580 Vali Loss: 0.2970554 Best vali loss: 0.2896381
	iters: 100, epoch: 6 | loss: 0.3188851
	speed: 0.0101s/iter; left time: 14.8951s
	iters: 200, epoch: 6 | loss: 0.8545318
	speed: 0.0051s/iter; left time: 7.0046s
	iters: 300, epoch: 6 | loss: 0.7811080
	speed: 0.0051s/iter; left time: 6.5101s
	iters: 400, epoch: 6 | loss: 0.5279416
	speed: 0.0051s/iter; left time: 5.9903s
	iters: 500, epoch: 6 | loss: 0.2692775
	speed: 0.0051s/iter; left time: 5.4867s
Updating learning rate to 0.0005666281528550129
Epoch: 6 cost time: 2.707554817199707
Epoch: 6, Steps: 523 | Train Loss: 0.5503488 Vali Loss: 0.3058099 Best vali loss: 0.2896381
	iters: 100, epoch: 7 | loss: 0.3630644
	speed: 0.0097s/iter; left time: 9.2322s
	iters: 200, epoch: 7 | loss: 0.7576218
	speed: 0.0047s/iter; left time: 4.0053s
	iters: 300, epoch: 7 | loss: 0.2167383
	speed: 0.0048s/iter; left time: 3.5578s
	iters: 400, epoch: 7 | loss: 0.3215106
	speed: 0.0048s/iter; left time: 3.1003s
	iters: 500, epoch: 7 | loss: 0.4036058
	speed: 0.0047s/iter; left time: 2.5877s
Updating learning rate to 0.0001472618589884834
Epoch: 7 cost time: 2.5319666862487793
Epoch: 7, Steps: 523 | Train Loss: 0.4125082 Vali Loss: 0.3141235 Best vali loss: 0.2896381
	iters: 100, epoch: 8 | loss: 0.7953237
	speed: 0.0096s/iter; left time: 4.0745s
	iters: 200, epoch: 8 | loss: 0.6343966
	speed: 0.0044s/iter; left time: 1.4180s
	iters: 300, epoch: 8 | loss: 0.2667692
	speed: 0.0044s/iter; left time: 0.9803s
	iters: 400, epoch: 8 | loss: 0.4940244
	speed: 0.0044s/iter; left time: 0.5466s
	iters: 500, epoch: 8 | loss: 0.3073875
	speed: 0.0045s/iter; left time: 0.1070s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.371788263320923
Epoch: 8, Steps: 523 | Train Loss: 0.4995803 Vali Loss: 0.3151194 Best vali loss: 0.2896381

best validation loss 0.2896380559047743

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027999392492, 'e_layers': 4, 'learning_rate': 0.0003351483562, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9873472
	speed: 0.0103s/iter; left time: 42.0431s
	iters: 200, epoch: 1 | loss: 0.3579699
	speed: 0.0051s/iter; left time: 20.2115s
	iters: 300, epoch: 1 | loss: 0.7848670
	speed: 0.0051s/iter; left time: 19.8640s
	iters: 400, epoch: 1 | loss: 0.4340390
	speed: 0.0051s/iter; left time: 19.1215s
	iters: 500, epoch: 1 | loss: 0.7984591
	speed: 0.0051s/iter; left time: 18.7425s
Updating learning rate to 0.0003351483562
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 2.898085832595825
Epoch: 1, Steps: 523 | Train Loss: 0.6725365 Vali Loss: 0.2813804 Best vali loss: 0.2813804
	iters: 100, epoch: 2 | loss: 0.6985123
	speed: 0.0100s/iter; left time: 35.7204s
	iters: 200, epoch: 2 | loss: 0.2749512
	speed: 0.0050s/iter; left time: 17.3325s
	iters: 300, epoch: 2 | loss: 0.3002910
	speed: 0.0050s/iter; left time: 16.7282s
	iters: 400, epoch: 2 | loss: 0.8418249
	speed: 0.0050s/iter; left time: 16.2479s
	iters: 500, epoch: 2 | loss: 0.5555527
	speed: 0.0050s/iter; left time: 15.6602s
Updating learning rate to 0.0001675741781
Validation loss decreased (0.2814 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 2.6346356868743896
Epoch: 2, Steps: 523 | Train Loss: 0.5342264 Vali Loss: 0.2796936 Best vali loss: 0.2796936
	iters: 100, epoch: 3 | loss: 0.2638330
	speed: 0.0099s/iter; left time: 30.0891s
	iters: 200, epoch: 3 | loss: 0.2368355
	speed: 0.0048s/iter; left time: 14.1099s
	iters: 300, epoch: 3 | loss: 0.4230146
	speed: 0.0047s/iter; left time: 13.3653s
	iters: 400, epoch: 3 | loss: 0.3242013
	speed: 0.0048s/iter; left time: 13.0415s
	iters: 500, epoch: 3 | loss: 0.3295145
	speed: 0.0048s/iter; left time: 12.5700s
Updating learning rate to 8.378708905e-05
Epoch: 3 cost time: 2.528660297393799
Epoch: 3, Steps: 523 | Train Loss: 0.3154798 Vali Loss: 0.2852101 Best vali loss: 0.2796936

best validation loss 0.27969358276815476

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008056936485, 'e_layers': 1, 'learning_rate': 0.0015389168254, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0015389168254
Validation loss decreased (inf --> 0.2943).  Saving model state dict ...
Epoch: 1 cost time: 0.4852316379547119
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2943494 Best vali loss: 0.2943494
Updating learning rate to 0.0007694584127
Epoch: 2 cost time: 0.27422380447387695
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2959150 Best vali loss: 0.2943494
Updating learning rate to 0.00038472920635
Epoch: 3 cost time: 0.26761913299560547
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3043837 Best vali loss: 0.2943494

best validation loss 0.29434936115980237

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.000920320077, 'e_layers': 3, 'learning_rate': 0.0005735578366, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4827901
	speed: 0.0094s/iter; left time: 77.2484s
	iters: 200, epoch: 1 | loss: 0.7378732
	speed: 0.0042s/iter; left time: 34.4027s
	iters: 300, epoch: 1 | loss: 0.4094523
	speed: 0.0042s/iter; left time: 33.9944s
	iters: 400, epoch: 1 | loss: 0.6660203
	speed: 0.0042s/iter; left time: 33.1134s
	iters: 500, epoch: 1 | loss: 0.3735153
	speed: 0.0042s/iter; left time: 33.0878s
	iters: 600, epoch: 1 | loss: 1.2408134
	speed: 0.0041s/iter; left time: 31.6726s
	iters: 700, epoch: 1 | loss: 0.3076918
	speed: 0.0041s/iter; left time: 31.6394s
	iters: 800, epoch: 1 | loss: 0.3273656
	speed: 0.0041s/iter; left time: 31.2491s
	iters: 900, epoch: 1 | loss: 1.2095367
	speed: 0.0042s/iter; left time: 31.0765s
	iters: 1000, epoch: 1 | loss: 0.1559176
	speed: 0.0042s/iter; left time: 30.9137s
Updating learning rate to 0.0005735578366
Validation loss decreased (inf --> 0.2977).  Saving model state dict ...
Epoch: 1 cost time: 4.607783555984497
Epoch: 1, Steps: 1045 | Train Loss: 0.5910976 Vali Loss: 0.2977410 Best vali loss: 0.2977410
	iters: 100, epoch: 2 | loss: 0.1251817
	speed: 0.0126s/iter; left time: 90.8109s
	iters: 200, epoch: 2 | loss: 0.6462177
	speed: 0.0043s/iter; left time: 30.3317s
	iters: 300, epoch: 2 | loss: 0.2739298
	speed: 0.0042s/iter; left time: 29.5298s
	iters: 400, epoch: 2 | loss: 0.4132838
	speed: 0.0042s/iter; left time: 29.2689s
	iters: 500, epoch: 2 | loss: 0.6578438
	speed: 0.0043s/iter; left time: 28.9806s
	iters: 600, epoch: 2 | loss: 0.3808437
	speed: 0.0042s/iter; left time: 28.4089s
	iters: 700, epoch: 2 | loss: 0.3705242
	speed: 0.0043s/iter; left time: 28.1478s
	iters: 800, epoch: 2 | loss: 0.3026462
	speed: 0.0042s/iter; left time: 27.3906s
	iters: 900, epoch: 2 | loss: 0.4780843
	speed: 0.0042s/iter; left time: 26.9402s
	iters: 1000, epoch: 2 | loss: 0.4668682
	speed: 0.0042s/iter; left time: 26.4084s
Updating learning rate to 0.0002867789183
Validation loss decreased (0.2977 --> 0.2876).  Saving model state dict ...
Epoch: 2 cost time: 4.454699993133545
Epoch: 2, Steps: 1045 | Train Loss: 0.4115423 Vali Loss: 0.2875728 Best vali loss: 0.2875728
	iters: 100, epoch: 3 | loss: 0.2427682
	speed: 0.0123s/iter; left time: 75.9034s
	iters: 200, epoch: 3 | loss: 0.6065082
	speed: 0.0043s/iter; left time: 25.9337s
	iters: 300, epoch: 3 | loss: 0.2715469
	speed: 0.0043s/iter; left time: 25.5592s
	iters: 400, epoch: 3 | loss: 0.2681288
	speed: 0.0042s/iter; left time: 24.8129s
	iters: 500, epoch: 3 | loss: 0.6586750
	speed: 0.0043s/iter; left time: 24.7250s
	iters: 600, epoch: 3 | loss: 0.3320151
	speed: 0.0038s/iter; left time: 21.6068s
	iters: 700, epoch: 3 | loss: 0.3658104
	speed: 0.0035s/iter; left time: 19.4945s
	iters: 800, epoch: 3 | loss: 0.2711453
	speed: 0.0038s/iter; left time: 20.9067s
	iters: 900, epoch: 3 | loss: 0.3244928
	speed: 0.0039s/iter; left time: 21.1896s
	iters: 1000, epoch: 3 | loss: 0.5402845
	speed: 0.0035s/iter; left time: 18.3880s
Updating learning rate to 0.00014338945915
Epoch: 3 cost time: 4.185280084609985
Epoch: 3, Steps: 1045 | Train Loss: 0.3881375 Vali Loss: 0.2940082 Best vali loss: 0.2875728

best validation loss 0.28757282268074463

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027999392492, 'e_layers': 4, 'learning_rate': 0.0003351483562, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8992672
	speed: 0.0108s/iter; left time: 27.2931s
	iters: 200, epoch: 4 | loss: 0.3036903
	speed: 0.0053s/iter; left time: 12.9063s
	iters: 300, epoch: 4 | loss: 0.6769218
	speed: 0.0053s/iter; left time: 12.2611s
	iters: 400, epoch: 4 | loss: 0.3747482
	speed: 0.0053s/iter; left time: 11.7106s
	iters: 500, epoch: 4 | loss: 0.6940356
	speed: 0.0052s/iter; left time: 11.0864s
Updating learning rate to 4.1893544525e-05
Epoch: 4 cost time: 3.0273046493530273
Epoch: 4, Steps: 523 | Train Loss: 0.5897326 Vali Loss: 0.2835737 Best vali loss: 0.2796936
	iters: 100, epoch: 5 | loss: 0.5056076
	speed: 0.0098s/iter; left time: 19.5875s
	iters: 200, epoch: 5 | loss: 0.2451041
	speed: 0.0046s/iter; left time: 8.7617s
	iters: 300, epoch: 5 | loss: 0.2435773
	speed: 0.0046s/iter; left time: 8.2365s
	iters: 400, epoch: 5 | loss: 0.6907877
	speed: 0.0047s/iter; left time: 7.8868s
	iters: 500, epoch: 5 | loss: 0.5564343
	speed: 0.0047s/iter; left time: 7.4329s
Updating learning rate to 2.09467722625e-05
Epoch: 5 cost time: 2.464045286178589
Epoch: 5, Steps: 523 | Train Loss: 0.4483022 Vali Loss: 0.2840537 Best vali loss: 0.2796936
	iters: 100, epoch: 6 | loss: 0.2308515
	speed: 0.0096s/iter; left time: 14.0904s
	iters: 200, epoch: 6 | loss: 0.2356255
	speed: 0.0049s/iter; left time: 6.7074s
	iters: 300, epoch: 6 | loss: 0.3491542
	speed: 0.0049s/iter; left time: 6.2728s
	iters: 400, epoch: 6 | loss: 0.2587094
	speed: 0.0049s/iter; left time: 5.7570s
	iters: 500, epoch: 6 | loss: 0.3202373
	speed: 0.0049s/iter; left time: 5.2380s
Updating learning rate to 1.047338613125e-05
Epoch: 6 cost time: 2.603416919708252
Epoch: 6, Steps: 523 | Train Loss: 0.2789156 Vali Loss: 0.2864962 Best vali loss: 0.2796936
	iters: 100, epoch: 7 | loss: 0.5259505
	speed: 0.0095s/iter; left time: 9.0200s
	iters: 200, epoch: 7 | loss: 0.3365283
	speed: 0.0045s/iter; left time: 3.7973s
	iters: 300, epoch: 7 | loss: 0.2675270
	speed: 0.0044s/iter; left time: 3.3191s
	iters: 400, epoch: 7 | loss: 0.6413934
	speed: 0.0045s/iter; left time: 2.9038s
	iters: 500, epoch: 7 | loss: 0.4246933
	speed: 0.0045s/iter; left time: 2.4552s
Updating learning rate to 5.236693065625e-06
Epoch: 7 cost time: 2.3755955696105957
Epoch: 7, Steps: 523 | Train Loss: 0.4392185 Vali Loss: 0.2849302 Best vali loss: 0.2796936
	iters: 100, epoch: 8 | loss: 0.2645976
	speed: 0.0095s/iter; left time: 4.0138s
	iters: 200, epoch: 8 | loss: 0.3298179
	speed: 0.0048s/iter; left time: 1.5713s
	iters: 300, epoch: 8 | loss: 0.5418087
	speed: 0.0048s/iter; left time: 1.0829s
	iters: 400, epoch: 8 | loss: 0.4485384
	speed: 0.0049s/iter; left time: 0.6046s
	iters: 500, epoch: 8 | loss: 0.5252013
	speed: 0.0049s/iter; left time: 0.1168s
Updating learning rate to 2.6183465328125e-06
Epoch: 8 cost time: 2.569028854370117
Epoch: 8, Steps: 523 | Train Loss: 0.4219928 Vali Loss: 0.2852990 Best vali loss: 0.2796936

best validation loss 0.27969358276815476

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0020337052296, 'e_layers': 3, 'learning_rate': 0.0020186061717, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3944367
	speed: 0.0103s/iter; left time: 9.7470s
Updating learning rate to 0.0019417775489672972
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 0.891106367111206
Epoch: 1, Steps: 131 | Train Loss: 0.3944367 Vali Loss: 0.2931896 Best vali loss: 0.2931896
	iters: 100, epoch: 2 | loss: 0.4719593
	speed: 0.0076s/iter; left time: 6.2209s
Updating learning rate to 0.0017229881421270432
Validation loss decreased (0.2932 --> 0.2904).  Saving model state dict ...
Epoch: 2 cost time: 0.6153128147125244
Epoch: 2, Steps: 131 | Train Loss: 0.4719593 Vali Loss: 0.2904062 Best vali loss: 0.2904062
	iters: 100, epoch: 3 | loss: 0.4780118
	speed: 0.0080s/iter; left time: 5.4933s
Updating learning rate to 0.001395546655039755
Epoch: 3 cost time: 0.6688544750213623
Epoch: 3, Steps: 131 | Train Loss: 0.4780118 Vali Loss: 0.2961954 Best vali loss: 0.2904062
	iters: 100, epoch: 4 | loss: 0.4036445
	speed: 0.0077s/iter; left time: 4.2994s
Updating learning rate to 0.00100930308585
Epoch: 4 cost time: 0.6236717700958252
Epoch: 4, Steps: 131 | Train Loss: 0.4036445 Vali Loss: 0.2970316 Best vali loss: 0.2904062
	iters: 100, epoch: 5 | loss: 0.3275475
	speed: 0.0079s/iter; left time: 3.3640s
Updating learning rate to 0.0006230595166602452
Epoch: 5 cost time: 0.6658501625061035
Epoch: 5, Steps: 131 | Train Loss: 0.3275475 Vali Loss: 0.2999217 Best vali loss: 0.2904062
	iters: 100, epoch: 6 | loss: 0.3280995
	speed: 0.0078s/iter; left time: 2.2925s
Updating learning rate to 0.00029561802957295697
Epoch: 6 cost time: 0.6454544067382812
Epoch: 6, Steps: 131 | Train Loss: 0.3280995 Vali Loss: 0.3101003 Best vali loss: 0.2904062
	iters: 100, epoch: 7 | loss: 0.4310971
	speed: 0.0079s/iter; left time: 1.2947s
Updating learning rate to 7.68286227327029e-05
Epoch: 7 cost time: 0.6583378314971924
Epoch: 7, Steps: 131 | Train Loss: 0.4310971 Vali Loss: 0.3042988 Best vali loss: 0.2904062
	iters: 100, epoch: 8 | loss: 0.2965522
	speed: 0.0078s/iter; left time: 0.2501s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6501579284667969
Epoch: 8, Steps: 131 | Train Loss: 0.2965522 Vali Loss: 0.3049018 Best vali loss: 0.2904062

best validation loss 0.2904062495882425

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.005018656971, 'e_layers': 4, 'learning_rate': 5.52318681e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5137123
	speed: 0.0109s/iter; left time: 21.8428s
	iters: 200, epoch: 1 | loss: 0.4993165
	speed: 0.0054s/iter; left time: 10.2924s
Updating learning rate to 5.52318681e-05
Validation loss decreased (inf --> 0.2784).  Saving model state dict ...
Epoch: 1 cost time: 1.6859502792358398
Epoch: 1, Steps: 262 | Train Loss: 0.5065144 Vali Loss: 0.2784236 Best vali loss: 0.2784236
	iters: 100, epoch: 2 | loss: 0.9613261
	speed: 0.0110s/iter; left time: 19.0101s
	iters: 200, epoch: 2 | loss: 0.3609509
	speed: 0.0047s/iter; left time: 7.7420s
Updating learning rate to 2.761593405e-05
Validation loss decreased (0.2784 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 1.29337477684021
Epoch: 2, Steps: 262 | Train Loss: 0.6611385 Vali Loss: 0.2781048 Best vali loss: 0.2781048
	iters: 100, epoch: 3 | loss: 0.7899437
	speed: 0.0104s/iter; left time: 15.3179s
	iters: 200, epoch: 3 | loss: 0.3445010
	speed: 0.0046s/iter; left time: 6.3348s
Updating learning rate to 1.3807967025e-05
Epoch: 3 cost time: 1.2586588859558105
Epoch: 3, Steps: 262 | Train Loss: 0.5672223 Vali Loss: 0.2797737 Best vali loss: 0.2781048
	iters: 100, epoch: 4 | loss: 0.4152607
	speed: 0.0102s/iter; left time: 12.3075s
	iters: 200, epoch: 4 | loss: 0.4773998
	speed: 0.0048s/iter; left time: 5.3009s
Updating learning rate to 6.9039835125e-06
Validation loss decreased (0.2781 --> 0.2780).  Saving model state dict ...
Epoch: 4 cost time: 1.2913215160369873
Epoch: 4, Steps: 262 | Train Loss: 0.4463303 Vali Loss: 0.2780112 Best vali loss: 0.2780112
	iters: 100, epoch: 5 | loss: 0.3975581
	speed: 0.0106s/iter; left time: 10.0975s
	iters: 200, epoch: 5 | loss: 0.8029752
	speed: 0.0049s/iter; left time: 4.1230s
Updating learning rate to 3.45199175625e-06
Validation loss decreased (0.2780 --> 0.2777).  Saving model state dict ...
Epoch: 5 cost time: 1.318075180053711
Epoch: 5, Steps: 262 | Train Loss: 0.6002667 Vali Loss: 0.2777119 Best vali loss: 0.2777119
	iters: 100, epoch: 6 | loss: 0.7576406
	speed: 0.0105s/iter; left time: 7.2427s
	iters: 200, epoch: 6 | loss: 0.5541344
	speed: 0.0048s/iter; left time: 2.8121s
Updating learning rate to 1.725995878125e-06
Validation loss decreased (0.2777 --> 0.2775).  Saving model state dict ...
Epoch: 6 cost time: 1.3035869598388672
Epoch: 6, Steps: 262 | Train Loss: 0.6558875 Vali Loss: 0.2775410 Best vali loss: 0.2775410
	iters: 100, epoch: 7 | loss: 0.6856256
	speed: 0.0110s/iter; left time: 4.6879s
	iters: 200, epoch: 7 | loss: 0.4574468
	speed: 0.0053s/iter; left time: 1.7345s
Updating learning rate to 8.629979390625e-07
Epoch: 7 cost time: 1.441650390625
Epoch: 7, Steps: 262 | Train Loss: 0.5715362 Vali Loss: 0.2777570 Best vali loss: 0.2775410
	iters: 100, epoch: 8 | loss: 0.4502225
	speed: 0.0110s/iter; left time: 1.7880s
	iters: 200, epoch: 8 | loss: 0.4478482
	speed: 0.0049s/iter; left time: 0.3110s
Updating learning rate to 4.3149896953125e-07
Epoch: 8 cost time: 1.3325154781341553
Epoch: 8, Steps: 262 | Train Loss: 0.4490353 Vali Loss: 0.2776173 Best vali loss: 0.2775410

best validation loss 0.2775410436185242

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019990405951, 'e_layers': 2, 'learning_rate': 0.0005385544705, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005180569614687018
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 0.7848389148712158
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856422 Best vali loss: 0.2856422
Updating learning rate to 0.0004596849943144402
Validation loss decreased (0.2856 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 0.5708098411560059
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2832998 Best vali loss: 0.2832998
Updating learning rate to 0.00037232517189325176
Epoch: 3 cost time: 0.5709350109100342
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3058024 Best vali loss: 0.2832998

best validation loss 0.2832998225251375

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020476485708, 'e_layers': 2, 'learning_rate': 0.0006552082417, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006302708628696691
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 0.7962782382965088
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2878876 Best vali loss: 0.2878876
Updating learning rate to 0.0005592552162476922
Epoch: 2 cost time: 0.5671703815460205
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2886028 Best vali loss: 0.2878876
Updating learning rate to 0.00045297279027382565
Epoch: 3 cost time: 0.5681965351104736
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2943959 Best vali loss: 0.2878876

best validation loss 0.28788758584361573

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0027096741408, 'e_layers': 4, 'learning_rate': 0.0001509319553, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3818542
	speed: 0.0155s/iter; left time: 14.7188s
Updating learning rate to 0.0001451874498017892
Validation loss decreased (inf --> 0.2826).  Saving model state dict ...
Epoch: 1 cost time: 1.5892229080200195
Epoch: 1, Steps: 131 | Train Loss: 0.3818542 Vali Loss: 0.2825560 Best vali loss: 0.2825560
	iters: 100, epoch: 2 | loss: 0.4929501
	speed: 0.0163s/iter; left time: 13.2967s
Updating learning rate to 0.00012882848219518745
Validation loss decreased (0.2826 --> 0.2752).  Saving model state dict ...
Epoch: 2 cost time: 1.3515772819519043
Epoch: 2, Steps: 131 | Train Loss: 0.4929501 Vali Loss: 0.2752390 Best vali loss: 0.2752390
	iters: 100, epoch: 3 | loss: 0.4934597
	speed: 0.0166s/iter; left time: 11.4073s
Updating learning rate to 0.00010434555700388916
Epoch: 3 cost time: 1.3580992221832275
Epoch: 3, Steps: 131 | Train Loss: 0.4934597 Vali Loss: 0.2774873 Best vali loss: 0.2752390

best validation loss 0.2752390129054599

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0027096741408, 'e_layers': 4, 'learning_rate': 0.0001509319553, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3359630
	speed: 0.0162s/iter; left time: 9.0051s
Updating learning rate to 7.546597765e-05
Epoch: 4 cost time: 1.5990514755249023
Epoch: 4, Steps: 131 | Train Loss: 0.3359630 Vali Loss: 0.2824910 Best vali loss: 0.2752390
	iters: 100, epoch: 5 | loss: 0.3732761
	speed: 0.0159s/iter; left time: 6.7610s
Updating learning rate to 4.658639829611085e-05
Epoch: 5 cost time: 1.3553152084350586
Epoch: 5, Steps: 131 | Train Loss: 0.3732761 Vali Loss: 0.2912356 Best vali loss: 0.2752390
	iters: 100, epoch: 6 | loss: 0.3806823
	speed: 0.0158s/iter; left time: 4.6539s
Updating learning rate to 2.210347310481257e-05
Epoch: 6 cost time: 1.3522086143493652
Epoch: 6, Steps: 131 | Train Loss: 0.3806823 Vali Loss: 0.2927558 Best vali loss: 0.2752390
	iters: 100, epoch: 7 | loss: 0.3593871
	speed: 0.0158s/iter; left time: 2.5820s
Updating learning rate to 5.744505498210787e-06
Epoch: 7 cost time: 1.3501865863800049
Epoch: 7, Steps: 131 | Train Loss: 0.3593871 Vali Loss: 0.2977221 Best vali loss: 0.2752390
	iters: 100, epoch: 8 | loss: 0.3517630
	speed: 0.0159s/iter; left time: 0.5075s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3573341369628906
Epoch: 8, Steps: 131 | Train Loss: 0.3517630 Vali Loss: 0.2998285 Best vali loss: 0.2752390

best validation loss 0.2752390129054599

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021901957771, 'e_layers': 3, 'learning_rate': 0.0004616636637, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5397831
	speed: 0.0094s/iter; left time: 77.8693s
	iters: 200, epoch: 1 | loss: 0.3736158
	speed: 0.0040s/iter; left time: 32.6496s
	iters: 300, epoch: 1 | loss: 0.2535224
	speed: 0.0040s/iter; left time: 32.5442s
	iters: 400, epoch: 1 | loss: 0.5473937
	speed: 0.0040s/iter; left time: 32.1129s
	iters: 500, epoch: 1 | loss: 1.1979039
	speed: 0.0040s/iter; left time: 31.6549s
	iters: 600, epoch: 1 | loss: 0.3039076
	speed: 0.0040s/iter; left time: 31.1449s
	iters: 700, epoch: 1 | loss: 0.4699822
	speed: 0.0040s/iter; left time: 30.6236s
	iters: 800, epoch: 1 | loss: 0.4564209
	speed: 0.0040s/iter; left time: 30.2485s
	iters: 900, epoch: 1 | loss: 1.1810406
	speed: 0.0040s/iter; left time: 29.6888s
	iters: 1000, epoch: 1 | loss: 0.3391230
	speed: 0.0040s/iter; left time: 29.6081s
Updating learning rate to 0.0004440926367483019
Validation loss decreased (inf --> 0.3019).  Saving model state dict ...
Epoch: 1 cost time: 4.4610373973846436
Epoch: 1, Steps: 1045 | Train Loss: 0.5662693 Vali Loss: 0.3019275 Best vali loss: 0.3019275
	iters: 100, epoch: 2 | loss: 0.2775945
	speed: 0.0119s/iter; left time: 85.6377s
	iters: 200, epoch: 2 | loss: 0.3390319
	speed: 0.0041s/iter; left time: 29.1229s
	iters: 300, epoch: 2 | loss: 0.4017794
	speed: 0.0038s/iter; left time: 26.4930s
	iters: 400, epoch: 2 | loss: 1.7397443
	speed: 0.0038s/iter; left time: 26.1304s
	iters: 500, epoch: 2 | loss: 0.3277271
	speed: 0.0039s/iter; left time: 26.4158s
	iters: 600, epoch: 2 | loss: 0.6223882
	speed: 0.0038s/iter; left time: 25.5701s
	iters: 700, epoch: 2 | loss: 0.7919263
	speed: 0.0039s/iter; left time: 25.4936s
	iters: 800, epoch: 2 | loss: 0.7511750
	speed: 0.0039s/iter; left time: 25.3479s
	iters: 900, epoch: 2 | loss: 0.4368837
	speed: 0.0040s/iter; left time: 25.6755s
	iters: 1000, epoch: 2 | loss: 0.4265293
	speed: 0.0039s/iter; left time: 24.5569s
Updating learning rate to 0.00039405458546484784
Epoch: 2 cost time: 4.097085475921631
Epoch: 2, Steps: 1045 | Train Loss: 0.6114780 Vali Loss: 0.3086805 Best vali loss: 0.3019275
	iters: 100, epoch: 3 | loss: 0.3089826
	speed: 0.0120s/iter; left time: 74.0137s
	iters: 200, epoch: 3 | loss: 0.5859692
	speed: 0.0043s/iter; left time: 26.1561s
	iters: 300, epoch: 3 | loss: 0.2842932
	speed: 0.0044s/iter; left time: 26.0544s
	iters: 400, epoch: 3 | loss: 0.5518044
	speed: 0.0043s/iter; left time: 25.4875s
	iters: 500, epoch: 3 | loss: 0.5593127
	speed: 0.0043s/iter; left time: 24.9498s
	iters: 600, epoch: 3 | loss: 0.6362087
	speed: 0.0044s/iter; left time: 24.6970s
	iters: 700, epoch: 3 | loss: 0.4135402
	speed: 0.0044s/iter; left time: 24.2596s
	iters: 800, epoch: 3 | loss: 0.6079445
	speed: 0.0044s/iter; left time: 23.9418s
	iters: 900, epoch: 3 | loss: 0.3833030
	speed: 0.0044s/iter; left time: 23.4060s
	iters: 1000, epoch: 3 | loss: 0.3279060
	speed: 0.0044s/iter; left time: 23.1688s
Updating learning rate to 0.00031916734956147924
Epoch: 3 cost time: 4.589057445526123
Epoch: 3, Steps: 1045 | Train Loss: 0.4659265 Vali Loss: 0.3191008 Best vali loss: 0.3019275
	iters: 100, epoch: 4 | loss: 0.4951922
	speed: 0.0123s/iter; left time: 63.0012s
	iters: 200, epoch: 4 | loss: 0.3792434
	speed: 0.0043s/iter; left time: 21.7713s
	iters: 300, epoch: 4 | loss: 1.4300914
	speed: 0.0040s/iter; left time: 19.7595s
	iters: 400, epoch: 4 | loss: 0.6661306
	speed: 0.0040s/iter; left time: 19.2997s
	iters: 500, epoch: 4 | loss: 1.9884163
	speed: 0.0040s/iter; left time: 19.0978s
	iters: 600, epoch: 4 | loss: 0.3696571
	speed: 0.0040s/iter; left time: 18.6643s
	iters: 700, epoch: 4 | loss: 0.1929872
	speed: 0.0041s/iter; left time: 18.6385s
	iters: 800, epoch: 4 | loss: 0.4785537
	speed: 0.0041s/iter; left time: 18.0933s
	iters: 900, epoch: 4 | loss: 0.3795392
	speed: 0.0041s/iter; left time: 17.5601s
	iters: 1000, epoch: 4 | loss: 0.3233199
	speed: 0.0040s/iter; left time: 17.0360s
Updating learning rate to 0.00023083183185
Epoch: 4 cost time: 4.3184216022491455
Epoch: 4, Steps: 1045 | Train Loss: 0.6703131 Vali Loss: 0.3211680 Best vali loss: 0.3019275
	iters: 100, epoch: 5 | loss: 0.5152870
	speed: 0.0124s/iter; left time: 50.4288s
	iters: 200, epoch: 5 | loss: 0.2667412
	speed: 0.0043s/iter; left time: 17.0318s
	iters: 300, epoch: 5 | loss: 1.2658484
	speed: 0.0042s/iter; left time: 16.3626s
	iters: 400, epoch: 5 | loss: 0.8217652
	speed: 0.0043s/iter; left time: 16.2460s
	iters: 500, epoch: 5 | loss: 0.2591750
	speed: 0.0043s/iter; left time: 15.9336s
	iters: 600, epoch: 5 | loss: 0.4836000
	speed: 0.0043s/iter; left time: 15.3587s
	iters: 700, epoch: 5 | loss: 1.0623547
	speed: 0.0043s/iter; left time: 15.0550s
	iters: 800, epoch: 5 | loss: 0.5186294
	speed: 0.0043s/iter; left time: 14.5311s
	iters: 900, epoch: 5 | loss: 0.4645089
	speed: 0.0043s/iter; left time: 14.0524s
	iters: 1000, epoch: 5 | loss: 0.1988723
	speed: 0.0042s/iter; left time: 13.4068s
Updating learning rate to 0.00014249631413852076
Epoch: 5 cost time: 4.519725322723389
Epoch: 5, Steps: 1045 | Train Loss: 0.5856782 Vali Loss: 0.3215672 Best vali loss: 0.3019275
	iters: 100, epoch: 6 | loss: 0.5169570
	speed: 0.0124s/iter; left time: 37.5062s
	iters: 200, epoch: 6 | loss: 0.6478072
	speed: 0.0043s/iter; left time: 12.6726s
	iters: 300, epoch: 6 | loss: 0.3665654
	speed: 0.0043s/iter; left time: 12.1659s
	iters: 400, epoch: 6 | loss: 0.2921356
	speed: 0.0043s/iter; left time: 11.7270s
	iters: 500, epoch: 6 | loss: 0.5654678
	speed: 0.0043s/iter; left time: 11.4035s
	iters: 600, epoch: 6 | loss: 0.4608137
	speed: 0.0041s/iter; left time: 10.2992s
	iters: 700, epoch: 6 | loss: 0.7984839
	speed: 0.0040s/iter; left time: 9.7453s
	iters: 800, epoch: 6 | loss: 0.3910362
	speed: 0.0040s/iter; left time: 9.3442s
	iters: 900, epoch: 6 | loss: 0.8036883
	speed: 0.0040s/iter; left time: 8.9459s
	iters: 1000, epoch: 6 | loss: 0.5536113
	speed: 0.0040s/iter; left time: 8.5422s
Updating learning rate to 6.760907823515213e-05
Epoch: 6 cost time: 4.372868537902832
Epoch: 6, Steps: 1045 | Train Loss: 0.5396567 Vali Loss: 0.3043802 Best vali loss: 0.3019275
	iters: 100, epoch: 7 | loss: 1.0488399
	speed: 0.0118s/iter; left time: 23.4314s
	iters: 200, epoch: 7 | loss: 0.2997556
	speed: 0.0038s/iter; left time: 7.2649s
	iters: 300, epoch: 7 | loss: 0.4407485
	speed: 0.0039s/iter; left time: 6.9279s
	iters: 400, epoch: 7 | loss: 0.4170972
	speed: 0.0039s/iter; left time: 6.6083s
	iters: 500, epoch: 7 | loss: 0.3354347
	speed: 0.0039s/iter; left time: 6.1722s
	iters: 600, epoch: 7 | loss: 0.6410215
	speed: 0.0042s/iter; left time: 6.3300s
	iters: 700, epoch: 7 | loss: 1.4458874
	speed: 0.0043s/iter; left time: 6.0313s
	iters: 800, epoch: 7 | loss: 0.3920597
	speed: 0.0043s/iter; left time: 5.5293s
	iters: 900, epoch: 7 | loss: 0.5204925
	speed: 0.0043s/iter; left time: 5.1483s
	iters: 1000, epoch: 7 | loss: 0.3125325
	speed: 0.0040s/iter; left time: 4.3605s
Updating learning rate to 1.757102695169805e-05
Epoch: 7 cost time: 4.275189161300659
Epoch: 7, Steps: 1045 | Train Loss: 0.5853870 Vali Loss: 0.3040097 Best vali loss: 0.3019275
	iters: 100, epoch: 8 | loss: 0.3377041
	speed: 0.0117s/iter; left time: 11.0861s
	iters: 200, epoch: 8 | loss: 0.3071090
	speed: 0.0037s/iter; left time: 3.1723s
	iters: 300, epoch: 8 | loss: 1.0396045
	speed: 0.0038s/iter; left time: 2.8013s
	iters: 400, epoch: 8 | loss: 0.3643990
	speed: 0.0037s/iter; left time: 2.4112s
	iters: 500, epoch: 8 | loss: 0.4335121
	speed: 0.0037s/iter; left time: 2.0347s
	iters: 600, epoch: 8 | loss: 1.0433800
	speed: 0.0038s/iter; left time: 1.6766s
	iters: 700, epoch: 8 | loss: 0.5177226
	speed: 0.0038s/iter; left time: 1.2994s
	iters: 800, epoch: 8 | loss: 0.2710107
	speed: 0.0037s/iter; left time: 0.9171s
	iters: 900, epoch: 8 | loss: 1.3482735
	speed: 0.0037s/iter; left time: 0.5459s
	iters: 1000, epoch: 8 | loss: 0.2818000
	speed: 0.0038s/iter; left time: 0.1755s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.9742190837860107
Epoch: 8, Steps: 1045 | Train Loss: 0.5944516 Vali Loss: 0.3050663 Best vali loss: 0.3019275

best validation loss 0.3019274911081627

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023270608225, 'e_layers': 3, 'learning_rate': 0.0004711292073, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2462883
	speed: 0.0092s/iter; left time: 75.7481s
	iters: 200, epoch: 1 | loss: 0.5077140
	speed: 0.0040s/iter; left time: 32.6278s
	iters: 300, epoch: 1 | loss: 1.5536460
	speed: 0.0040s/iter; left time: 32.2597s
	iters: 400, epoch: 1 | loss: 0.2890722
	speed: 0.0040s/iter; left time: 31.8382s
	iters: 500, epoch: 1 | loss: 0.2754586
	speed: 0.0040s/iter; left time: 31.5237s
	iters: 600, epoch: 1 | loss: 0.4262963
	speed: 0.0040s/iter; left time: 31.0443s
	iters: 700, epoch: 1 | loss: 0.2944596
	speed: 0.0040s/iter; left time: 30.6461s
	iters: 800, epoch: 1 | loss: 0.2186087
	speed: 0.0040s/iter; left time: 30.1578s
	iters: 900, epoch: 1 | loss: 1.4254558
	speed: 0.0040s/iter; left time: 29.7710s
	iters: 1000, epoch: 1 | loss: 0.9336530
	speed: 0.0040s/iter; left time: 29.4059s
Updating learning rate to 0.00045319791954636854
Validation loss decreased (inf --> 0.3281).  Saving model state dict ...
Epoch: 1 cost time: 4.439999103546143
Epoch: 1, Steps: 1045 | Train Loss: 0.6170653 Vali Loss: 0.3281319 Best vali loss: 0.3281319
	iters: 100, epoch: 2 | loss: 0.4524588
	speed: 0.0122s/iter; left time: 88.0693s
	iters: 200, epoch: 2 | loss: 0.4159958
	speed: 0.0043s/iter; left time: 30.3104s
	iters: 300, epoch: 2 | loss: 0.2924110
	speed: 0.0043s/iter; left time: 30.0128s
	iters: 400, epoch: 2 | loss: 0.4480335
	speed: 0.0043s/iter; left time: 29.5324s
	iters: 500, epoch: 2 | loss: 1.6540700
	speed: 0.0043s/iter; left time: 29.6201s
	iters: 600, epoch: 2 | loss: 0.9513150
	speed: 0.0043s/iter; left time: 28.6945s
	iters: 700, epoch: 2 | loss: 0.9204487
	speed: 0.0043s/iter; left time: 28.7442s
	iters: 800, epoch: 2 | loss: 0.2283986
	speed: 0.0044s/iter; left time: 28.6014s
	iters: 900, epoch: 2 | loss: 1.3790598
	speed: 0.0044s/iter; left time: 27.9782s
	iters: 1000, epoch: 2 | loss: 0.7771429
	speed: 0.0044s/iter; left time: 27.7627s
Updating learning rate to 0.00040213393229843636
Validation loss decreased (0.3281 --> 0.3195).  Saving model state dict ...
Epoch: 2 cost time: 4.558704376220703
Epoch: 2, Steps: 1045 | Train Loss: 0.7519334 Vali Loss: 0.3195057 Best vali loss: 0.3195057
	iters: 100, epoch: 3 | loss: 0.4628375
	speed: 0.0127s/iter; left time: 78.0781s
	iters: 200, epoch: 3 | loss: 0.3249615
	speed: 0.0043s/iter; left time: 26.1398s
	iters: 300, epoch: 3 | loss: 0.4175720
	speed: 0.0042s/iter; left time: 25.3709s
	iters: 400, epoch: 3 | loss: 0.5293394
	speed: 0.0041s/iter; left time: 24.0319s
	iters: 500, epoch: 3 | loss: 0.3000255
	speed: 0.0040s/iter; left time: 23.3489s
	iters: 600, epoch: 3 | loss: 0.3466510
	speed: 0.0040s/iter; left time: 22.8447s
	iters: 700, epoch: 3 | loss: 0.2970583
	speed: 0.0041s/iter; left time: 22.8530s
	iters: 800, epoch: 3 | loss: 0.4142761
	speed: 0.0041s/iter; left time: 22.4502s
	iters: 900, epoch: 3 | loss: 0.2699335
	speed: 0.0041s/iter; left time: 21.9074s
	iters: 1000, epoch: 3 | loss: 0.3664352
	speed: 0.0041s/iter; left time: 21.4481s
Updating learning rate to 0.000325711274718504
Epoch: 3 cost time: 4.346768379211426
Epoch: 3, Steps: 1045 | Train Loss: 0.3729090 Vali Loss: 0.3263791 Best vali loss: 0.3195057
	iters: 100, epoch: 4 | loss: 0.3479049
	speed: 0.0120s/iter; left time: 61.5762s
	iters: 200, epoch: 4 | loss: 0.5098171
	speed: 0.0042s/iter; left time: 20.9550s
	iters: 300, epoch: 4 | loss: 0.3570204
	speed: 0.0042s/iter; left time: 20.4976s
	iters: 400, epoch: 4 | loss: 1.3522671
	speed: 0.0042s/iter; left time: 20.1384s
	iters: 500, epoch: 4 | loss: 0.2098982
	speed: 0.0042s/iter; left time: 19.8897s
	iters: 600, epoch: 4 | loss: 0.1776465
	speed: 0.0042s/iter; left time: 19.2972s
	iters: 700, epoch: 4 | loss: 0.7395518
	speed: 0.0041s/iter; left time: 18.6349s
	iters: 800, epoch: 4 | loss: 1.2560134
	speed: 0.0041s/iter; left time: 18.0384s
	iters: 900, epoch: 4 | loss: 0.1872497
	speed: 0.0042s/iter; left time: 18.1630s
	iters: 1000, epoch: 4 | loss: 0.3405536
	speed: 0.0042s/iter; left time: 17.6561s
Updating learning rate to 0.00023556460365
Epoch: 4 cost time: 4.383568286895752
Epoch: 4, Steps: 1045 | Train Loss: 0.5477923 Vali Loss: 0.3234506 Best vali loss: 0.3195057
	iters: 100, epoch: 5 | loss: 0.4985937
	speed: 0.0120s/iter; left time: 49.1554s
	iters: 200, epoch: 5 | loss: 0.7145122
	speed: 0.0043s/iter; left time: 17.2844s
	iters: 300, epoch: 5 | loss: 0.6454078
	speed: 0.0043s/iter; left time: 16.6062s
	iters: 400, epoch: 5 | loss: 0.3688692
	speed: 0.0043s/iter; left time: 16.3033s
	iters: 500, epoch: 5 | loss: 1.0425211
	speed: 0.0042s/iter; left time: 15.6352s
	iters: 600, epoch: 5 | loss: 0.2393350
	speed: 0.0042s/iter; left time: 15.1980s
	iters: 700, epoch: 5 | loss: 0.3279752
	speed: 0.0043s/iter; left time: 14.9622s
	iters: 800, epoch: 5 | loss: 0.5098864
	speed: 0.0041s/iter; left time: 14.0183s
	iters: 900, epoch: 5 | loss: 0.3467124
	speed: 0.0041s/iter; left time: 13.5802s
	iters: 1000, epoch: 5 | loss: 0.2908495
	speed: 0.0042s/iter; left time: 13.4710s
Updating learning rate to 0.00014541793258149606
Epoch: 5 cost time: 4.4795238971710205
Epoch: 5, Steps: 1045 | Train Loss: 0.4984662 Vali Loss: 0.3243146 Best vali loss: 0.3195057
	iters: 100, epoch: 6 | loss: 0.6588084
	speed: 0.0121s/iter; left time: 36.8774s
	iters: 200, epoch: 6 | loss: 0.4037946
	speed: 0.0043s/iter; left time: 12.5499s
	iters: 300, epoch: 6 | loss: 0.5477992
	speed: 0.0042s/iter; left time: 11.9415s
	iters: 400, epoch: 6 | loss: 0.5495529
	speed: 0.0042s/iter; left time: 11.5434s
	iters: 500, epoch: 6 | loss: 0.2619874
	speed: 0.0043s/iter; left time: 11.2771s
	iters: 600, epoch: 6 | loss: 0.3819895
	speed: 0.0043s/iter; left time: 10.7891s
	iters: 700, epoch: 6 | loss: 0.7489612
	speed: 0.0043s/iter; left time: 10.4381s
	iters: 800, epoch: 6 | loss: 1.5107189
	speed: 0.0041s/iter; left time: 9.6072s
	iters: 900, epoch: 6 | loss: 0.8138254
	speed: 0.0040s/iter; left time: 8.9694s
	iters: 1000, epoch: 6 | loss: 0.3297471
	speed: 0.0040s/iter; left time: 8.5443s
Updating learning rate to 6.899527500156368e-05
Epoch: 6 cost time: 4.413635969161987
Epoch: 6, Steps: 1045 | Train Loss: 0.6207184 Vali Loss: 0.3220736 Best vali loss: 0.3195057
	iters: 100, epoch: 7 | loss: 0.3252541
	speed: 0.0122s/iter; left time: 24.2320s
	iters: 200, epoch: 7 | loss: 0.3705356
	speed: 0.0043s/iter; left time: 8.1373s
	iters: 300, epoch: 7 | loss: 0.2372153
	speed: 0.0043s/iter; left time: 7.7206s
	iters: 400, epoch: 7 | loss: 0.5410480
	speed: 0.0042s/iter; left time: 7.0554s
	iters: 500, epoch: 7 | loss: 0.7390466
	speed: 0.0040s/iter; left time: 6.3657s
	iters: 600, epoch: 7 | loss: 1.2800848
	speed: 0.0040s/iter; left time: 5.9902s
	iters: 700, epoch: 7 | loss: 0.2323119
	speed: 0.0040s/iter; left time: 5.5674s
	iters: 800, epoch: 7 | loss: 0.1944620
	speed: 0.0040s/iter; left time: 5.1635s
	iters: 900, epoch: 7 | loss: 0.2159861
	speed: 0.0040s/iter; left time: 4.7909s
	iters: 1000, epoch: 7 | loss: 0.4578536
	speed: 0.0040s/iter; left time: 4.3644s
Updating learning rate to 1.793128775363145e-05
Epoch: 7 cost time: 4.331974029541016
Epoch: 7, Steps: 1045 | Train Loss: 0.4593798 Vali Loss: 0.3210523 Best vali loss: 0.3195057
	iters: 100, epoch: 8 | loss: 0.3191603
	speed: 0.0121s/iter; left time: 11.4523s
	iters: 200, epoch: 8 | loss: 0.5372099
	speed: 0.0042s/iter; left time: 3.5424s
	iters: 300, epoch: 8 | loss: 0.3807971
	speed: 0.0042s/iter; left time: 3.1640s
	iters: 400, epoch: 8 | loss: 0.3861971
	speed: 0.0042s/iter; left time: 2.7380s
	iters: 500, epoch: 8 | loss: 0.2025123
	speed: 0.0043s/iter; left time: 2.3295s
	iters: 600, epoch: 8 | loss: 0.3426046
	speed: 0.0042s/iter; left time: 1.8771s
	iters: 700, epoch: 8 | loss: 0.4555267
	speed: 0.0042s/iter; left time: 1.4508s
	iters: 800, epoch: 8 | loss: 0.4773631
	speed: 0.0042s/iter; left time: 1.0261s
	iters: 900, epoch: 8 | loss: 0.3207966
	speed: 0.0042s/iter; left time: 0.6144s
	iters: 1000, epoch: 8 | loss: 0.3639899
	speed: 0.0041s/iter; left time: 0.1904s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.4197070598602295
Epoch: 8, Steps: 1045 | Train Loss: 0.3786158 Vali Loss: 0.3216114 Best vali loss: 0.3195057

best validation loss 0.3195057448821247

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023415258681, 'e_layers': 3, 'learning_rate': 0.0004699353305, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2464166
	speed: 0.0097s/iter; left time: 79.9901s
	iters: 200, epoch: 1 | loss: 0.5256062
	speed: 0.0043s/iter; left time: 34.7224s
	iters: 300, epoch: 1 | loss: 1.5570663
	speed: 0.0043s/iter; left time: 34.9161s
	iters: 400, epoch: 1 | loss: 0.3005809
	speed: 0.0043s/iter; left time: 34.0834s
	iters: 500, epoch: 1 | loss: 0.3140364
	speed: 0.0044s/iter; left time: 34.2700s
	iters: 600, epoch: 1 | loss: 0.4686102
	speed: 0.0043s/iter; left time: 33.1462s
	iters: 700, epoch: 1 | loss: 0.2863484
	speed: 0.0043s/iter; left time: 32.7690s
	iters: 800, epoch: 1 | loss: 0.2224456
	speed: 0.0043s/iter; left time: 32.2809s
	iters: 900, epoch: 1 | loss: 1.3237886
	speed: 0.0043s/iter; left time: 31.8662s
	iters: 1000, epoch: 1 | loss: 0.7697262
	speed: 0.0043s/iter; left time: 31.6121s
Updating learning rate to 0.00045204948197643846
Validation loss decreased (inf --> 0.3202).  Saving model state dict ...
Epoch: 1 cost time: 4.749273300170898
Epoch: 1, Steps: 1045 | Train Loss: 0.6014625 Vali Loss: 0.3202241 Best vali loss: 0.3202241
	iters: 100, epoch: 2 | loss: 0.4150521
	speed: 0.0123s/iter; left time: 88.4680s
	iters: 200, epoch: 2 | loss: 0.3762783
	speed: 0.0040s/iter; left time: 28.4952s
	iters: 300, epoch: 2 | loss: 0.2873786
	speed: 0.0041s/iter; left time: 28.9840s
	iters: 400, epoch: 2 | loss: 0.4493366
	speed: 0.0043s/iter; left time: 29.9705s
	iters: 500, epoch: 2 | loss: 1.6638402
	speed: 0.0043s/iter; left time: 29.4734s
	iters: 600, epoch: 2 | loss: 0.8110287
	speed: 0.0043s/iter; left time: 29.1641s
	iters: 700, epoch: 2 | loss: 0.8322393
	speed: 0.0043s/iter; left time: 28.3905s
	iters: 800, epoch: 2 | loss: 0.2359462
	speed: 0.0043s/iter; left time: 28.1688s
	iters: 900, epoch: 2 | loss: 1.4486024
	speed: 0.0043s/iter; left time: 27.5092s
	iters: 1000, epoch: 2 | loss: 0.7810760
	speed: 0.0043s/iter; left time: 27.1521s
Updating learning rate to 0.0004011148947078457
Validation loss decreased (0.3202 --> 0.3095).  Saving model state dict ...
Epoch: 2 cost time: 4.471912384033203
Epoch: 2, Steps: 1045 | Train Loss: 0.7300778 Vali Loss: 0.3095419 Best vali loss: 0.3095419
	iters: 100, epoch: 3 | loss: 0.4555373
	speed: 0.0129s/iter; left time: 79.5407s
	iters: 200, epoch: 3 | loss: 0.2809430
	speed: 0.0043s/iter; left time: 26.1578s
	iters: 300, epoch: 3 | loss: 0.4019904
	speed: 0.0043s/iter; left time: 25.5524s
	iters: 400, epoch: 3 | loss: 0.5189796
	speed: 0.0043s/iter; left time: 25.1328s
	iters: 500, epoch: 3 | loss: 0.2945326
	speed: 0.0043s/iter; left time: 25.0190s
	iters: 600, epoch: 3 | loss: 0.3520944
	speed: 0.0043s/iter; left time: 24.4838s
	iters: 700, epoch: 3 | loss: 0.2841988
	speed: 0.0042s/iter; left time: 23.6014s
	iters: 800, epoch: 3 | loss: 0.4220099
	speed: 0.0043s/iter; left time: 23.3144s
	iters: 900, epoch: 3 | loss: 0.2442078
	speed: 0.0043s/iter; left time: 23.0795s
	iters: 1000, epoch: 3 | loss: 0.3278333
	speed: 0.0043s/iter; left time: 22.8711s
Updating learning rate to 0.0003248858978826814
Epoch: 3 cost time: 4.536486625671387
Epoch: 3, Steps: 1045 | Train Loss: 0.3582327 Vali Loss: 0.3213414 Best vali loss: 0.3095419

best validation loss 0.3095418856783665

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023745880391, 'e_layers': 3, 'learning_rate': 0.0004644412462, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2465989
	speed: 0.0094s/iter; left time: 78.0189s
	iters: 200, epoch: 1 | loss: 0.5140596
	speed: 0.0042s/iter; left time: 33.9383s
	iters: 300, epoch: 1 | loss: 1.5648078
	speed: 0.0042s/iter; left time: 33.5623s
	iters: 400, epoch: 1 | loss: 0.2886498
	speed: 0.0041s/iter; left time: 32.4703s
	iters: 500, epoch: 1 | loss: 0.2759072
	speed: 0.0042s/iter; left time: 32.8961s
	iters: 600, epoch: 1 | loss: 0.4144943
	speed: 0.0041s/iter; left time: 31.6547s
	iters: 700, epoch: 1 | loss: 0.2300505
	speed: 0.0038s/iter; left time: 28.7567s
	iters: 800, epoch: 1 | loss: 0.2143599
	speed: 0.0038s/iter; left time: 29.0340s
	iters: 900, epoch: 1 | loss: 1.2596720
	speed: 0.0039s/iter; left time: 29.2819s
	iters: 1000, epoch: 1 | loss: 0.6217176
	speed: 0.0037s/iter; left time: 27.2712s
Updating learning rate to 0.0004467645038091077
Validation loss decreased (inf --> 0.3096).  Saving model state dict ...
Epoch: 1 cost time: 4.439936637878418
Epoch: 1, Steps: 1045 | Train Loss: 0.5630318 Vali Loss: 0.3096010 Best vali loss: 0.3096010
	iters: 100, epoch: 2 | loss: 0.4382774
	speed: 0.0125s/iter; left time: 89.8552s
	iters: 200, epoch: 2 | loss: 0.3900813
	speed: 0.0043s/iter; left time: 30.6574s
	iters: 300, epoch: 2 | loss: 0.2942950
	speed: 0.0043s/iter; left time: 30.2700s
	iters: 400, epoch: 2 | loss: 0.4326271
	speed: 0.0043s/iter; left time: 29.4438s
	iters: 500, epoch: 2 | loss: 1.6578729
	speed: 0.0043s/iter; left time: 29.1494s
	iters: 600, epoch: 2 | loss: 0.7705999
	speed: 0.0043s/iter; left time: 29.1196s
	iters: 700, epoch: 2 | loss: 0.8066058
	speed: 0.0044s/iter; left time: 28.8813s
	iters: 800, epoch: 2 | loss: 0.2388863
	speed: 0.0042s/iter; left time: 27.3795s
	iters: 900, epoch: 2 | loss: 1.3073089
	speed: 0.0040s/iter; left time: 25.6571s
	iters: 1000, epoch: 2 | loss: 0.7837712
	speed: 0.0037s/iter; left time: 23.1504s
Updating learning rate to 0.0003964254004253754
Epoch: 2 cost time: 4.407867908477783
Epoch: 2, Steps: 1045 | Train Loss: 0.7120326 Vali Loss: 0.3108618 Best vali loss: 0.3096010
	iters: 100, epoch: 3 | loss: 0.4677503
	speed: 0.0120s/iter; left time: 74.2659s
	iters: 200, epoch: 3 | loss: 0.3090147
	speed: 0.0043s/iter; left time: 25.9875s
	iters: 300, epoch: 3 | loss: 0.4013236
	speed: 0.0042s/iter; left time: 24.7993s
	iters: 400, epoch: 3 | loss: 0.5151523
	speed: 0.0040s/iter; left time: 23.7305s
	iters: 500, epoch: 3 | loss: 0.2921961
	speed: 0.0040s/iter; left time: 22.9277s
	iters: 600, epoch: 3 | loss: 0.3681766
	speed: 0.0040s/iter; left time: 22.5695s
	iters: 700, epoch: 3 | loss: 0.3030742
	speed: 0.0039s/iter; left time: 21.8890s
	iters: 800, epoch: 3 | loss: 0.4202559
	speed: 0.0040s/iter; left time: 21.7037s
	iters: 900, epoch: 3 | loss: 0.2746152
	speed: 0.0040s/iter; left time: 21.4726s
	iters: 1000, epoch: 3 | loss: 0.3688961
	speed: 0.0040s/iter; left time: 20.9307s
Updating learning rate to 0.0003210876082138679
Epoch: 3 cost time: 4.267297267913818
Epoch: 3, Steps: 1045 | Train Loss: 0.3720455 Vali Loss: 0.3304618 Best vali loss: 0.3096010

best validation loss 0.3096009613402318

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021988543749, 'e_layers': 3, 'learning_rate': 0.0004670957648, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2468950
	speed: 0.0095s/iter; left time: 78.3697s
	iters: 200, epoch: 1 | loss: 0.5496637
	speed: 0.0041s/iter; left time: 33.5134s
	iters: 300, epoch: 1 | loss: 1.5397537
	speed: 0.0040s/iter; left time: 32.4795s
	iters: 400, epoch: 1 | loss: 0.3137135
	speed: 0.0043s/iter; left time: 33.9244s
	iters: 500, epoch: 1 | loss: 0.2923464
	speed: 0.0041s/iter; left time: 32.2444s
	iters: 600, epoch: 1 | loss: 0.4606860
	speed: 0.0043s/iter; left time: 33.0331s
	iters: 700, epoch: 1 | loss: 0.2403220
	speed: 0.0042s/iter; left time: 32.2815s
	iters: 800, epoch: 1 | loss: 0.2162905
	speed: 0.0042s/iter; left time: 31.7569s
	iters: 900, epoch: 1 | loss: 1.2630196
	speed: 0.0042s/iter; left time: 31.2598s
	iters: 1000, epoch: 1 | loss: 0.7202851
	speed: 0.0042s/iter; left time: 31.1663s
Updating learning rate to 0.000449317990810713
Validation loss decreased (inf --> 0.3139).  Saving model state dict ...
Epoch: 1 cost time: 4.639784097671509
Epoch: 1, Steps: 1045 | Train Loss: 0.5842975 Vali Loss: 0.3138578 Best vali loss: 0.3138578
	iters: 100, epoch: 2 | loss: 0.4224037
	speed: 0.0122s/iter; left time: 88.2002s
	iters: 200, epoch: 2 | loss: 0.3959078
	speed: 0.0040s/iter; left time: 28.3298s
	iters: 300, epoch: 2 | loss: 0.2949152
	speed: 0.0039s/iter; left time: 27.6033s
	iters: 400, epoch: 2 | loss: 0.4241352
	speed: 0.0038s/iter; left time: 26.2303s
	iters: 500, epoch: 2 | loss: 1.6834648
	speed: 0.0038s/iter; left time: 25.7133s
	iters: 600, epoch: 2 | loss: 0.5808043
	speed: 0.0040s/iter; left time: 26.9200s
	iters: 700, epoch: 2 | loss: 0.7235975
	speed: 0.0043s/iter; left time: 28.6908s
	iters: 800, epoch: 2 | loss: 0.2398378
	speed: 0.0043s/iter; left time: 27.9608s
	iters: 900, epoch: 2 | loss: 1.2135069
	speed: 0.0042s/iter; left time: 26.8281s
	iters: 1000, epoch: 2 | loss: 0.7489070
	speed: 0.0038s/iter; left time: 24.2375s
Updating learning rate to 0.00039869117377679835
Validation loss decreased (0.3139 --> 0.3025).  Saving model state dict ...
Epoch: 2 cost time: 4.21347451210022
Epoch: 2, Steps: 1045 | Train Loss: 0.6727480 Vali Loss: 0.3024585 Best vali loss: 0.3024585
	iters: 100, epoch: 3 | loss: 0.4600147
	speed: 0.0128s/iter; left time: 78.9750s
	iters: 200, epoch: 3 | loss: 0.2689341
	speed: 0.0043s/iter; left time: 26.3801s
	iters: 300, epoch: 3 | loss: 0.4038746
	speed: 0.0044s/iter; left time: 26.1433s
	iters: 400, epoch: 3 | loss: 0.5002273
	speed: 0.0044s/iter; left time: 25.5770s
	iters: 500, epoch: 3 | loss: 0.2885618
	speed: 0.0043s/iter; left time: 25.0510s
	iters: 600, epoch: 3 | loss: 0.2988929
	speed: 0.0043s/iter; left time: 24.5403s
	iters: 700, epoch: 3 | loss: 0.3030422
	speed: 0.0044s/iter; left time: 24.5201s
	iters: 800, epoch: 3 | loss: 0.4220859
	speed: 0.0044s/iter; left time: 23.8696s
	iters: 900, epoch: 3 | loss: 0.2798566
	speed: 0.0043s/iter; left time: 23.2306s
	iters: 1000, epoch: 3 | loss: 0.3516166
	speed: 0.0043s/iter; left time: 22.8844s
Updating learning rate to 0.00032292278765843035
Epoch: 3 cost time: 4.587860345840454
Epoch: 3, Steps: 1045 | Train Loss: 0.3577107 Vali Loss: 0.3142996 Best vali loss: 0.3024585

best validation loss 0.302458529214781

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021988543749, 'e_layers': 3, 'learning_rate': 0.0004670957648, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2275456
	speed: 0.0097s/iter; left time: 49.9458s
	iters: 200, epoch: 4 | loss: 0.5472578
	speed: 0.0041s/iter; left time: 20.6818s
	iters: 300, epoch: 4 | loss: 1.5434600
	speed: 0.0042s/iter; left time: 20.5063s
	iters: 400, epoch: 4 | loss: 0.3116161
	speed: 0.0042s/iter; left time: 20.0884s
	iters: 500, epoch: 4 | loss: 0.2695392
	speed: 0.0042s/iter; left time: 19.7102s
	iters: 600, epoch: 4 | loss: 0.4458234
	speed: 0.0042s/iter; left time: 19.3453s
	iters: 700, epoch: 4 | loss: 0.2458261
	speed: 0.0041s/iter; left time: 18.7520s
	iters: 800, epoch: 4 | loss: 0.2215599
	speed: 0.0042s/iter; left time: 18.6229s
	iters: 900, epoch: 4 | loss: 1.3322320
	speed: 0.0042s/iter; left time: 17.9969s
	iters: 1000, epoch: 4 | loss: 0.6461269
	speed: 0.0041s/iter; left time: 17.4748s
Updating learning rate to 0.0002335478824
Epoch: 4 cost time: 4.60254168510437
Epoch: 4, Steps: 1045 | Train Loss: 0.5790987 Vali Loss: 0.3088332 Best vali loss: 0.3024585
	iters: 100, epoch: 5 | loss: 0.4067859
	speed: 0.0120s/iter; left time: 48.7864s
	iters: 200, epoch: 5 | loss: 0.3931091
	speed: 0.0043s/iter; left time: 16.9409s
	iters: 300, epoch: 5 | loss: 0.2858422
	speed: 0.0042s/iter; left time: 16.3651s
	iters: 400, epoch: 5 | loss: 0.4452839
	speed: 0.0043s/iter; left time: 16.1455s
	iters: 500, epoch: 5 | loss: 1.6408261
	speed: 0.0043s/iter; left time: 15.8228s
	iters: 600, epoch: 5 | loss: 0.7282848
	speed: 0.0043s/iter; left time: 15.2643s
	iters: 700, epoch: 5 | loss: 0.7605788
	speed: 0.0043s/iter; left time: 14.8426s
	iters: 800, epoch: 5 | loss: 0.2592879
	speed: 0.0043s/iter; left time: 14.4566s
	iters: 900, epoch: 5 | loss: 1.1818210
	speed: 0.0043s/iter; left time: 13.9941s
	iters: 1000, epoch: 5 | loss: 0.7831525
	speed: 0.0043s/iter; left time: 13.5997s
Updating learning rate to 0.00014417297714156967
Epoch: 5 cost time: 4.48391056060791
Epoch: 5, Steps: 1045 | Train Loss: 0.6884972 Vali Loss: 0.3103072 Best vali loss: 0.3024585
	iters: 100, epoch: 6 | loss: 0.4657818
	speed: 0.0120s/iter; left time: 36.4194s
	iters: 200, epoch: 6 | loss: 0.3205400
	speed: 0.0043s/iter; left time: 12.6260s
	iters: 300, epoch: 6 | loss: 0.4173625
	speed: 0.0042s/iter; left time: 11.9751s
	iters: 400, epoch: 6 | loss: 0.5290059
	speed: 0.0042s/iter; left time: 11.5877s
	iters: 500, epoch: 6 | loss: 0.2973787
	speed: 0.0042s/iter; left time: 11.0546s
	iters: 600, epoch: 6 | loss: 0.3464727
	speed: 0.0042s/iter; left time: 10.5934s
	iters: 700, epoch: 6 | loss: 0.2966437
	speed: 0.0043s/iter; left time: 10.4363s
	iters: 800, epoch: 6 | loss: 0.4145054
	speed: 0.0043s/iter; left time: 10.0343s
	iters: 900, epoch: 6 | loss: 0.2694709
	speed: 0.0043s/iter; left time: 9.5044s
	iters: 1000, epoch: 6 | loss: 0.3657873
	speed: 0.0042s/iter; left time: 8.9416s
Updating learning rate to 6.840459102320168e-05
Epoch: 6 cost time: 4.470245361328125
Epoch: 6, Steps: 1045 | Train Loss: 0.3722949 Vali Loss: 0.3258049 Best vali loss: 0.3024585
	iters: 100, epoch: 7 | loss: 0.3481862
	speed: 0.0122s/iter; left time: 24.3449s
	iters: 200, epoch: 7 | loss: 0.5099324
	speed: 0.0044s/iter; left time: 8.2334s
	iters: 300, epoch: 7 | loss: 0.3592546
	speed: 0.0042s/iter; left time: 7.5818s
	iters: 400, epoch: 7 | loss: 1.3520784
	speed: 0.0044s/iter; left time: 7.3583s
	iters: 500, epoch: 7 | loss: 0.2087205
	speed: 0.0043s/iter; left time: 6.8530s
	iters: 600, epoch: 7 | loss: 0.1770120
	speed: 0.0043s/iter; left time: 6.3615s
	iters: 700, epoch: 7 | loss: 0.7308844
	speed: 0.0042s/iter; left time: 5.9116s
	iters: 800, epoch: 7 | loss: 1.2241026
	speed: 0.0043s/iter; left time: 5.6158s
	iters: 900, epoch: 7 | loss: 0.1869294
	speed: 0.0043s/iter; left time: 5.0968s
	iters: 1000, epoch: 7 | loss: 0.3409925
	speed: 0.0043s/iter; left time: 4.7178s
Updating learning rate to 1.777777398928703e-05
Epoch: 7 cost time: 4.536773204803467
Epoch: 7, Steps: 1045 | Train Loss: 0.5438093 Vali Loss: 0.3235925 Best vali loss: 0.3024585
	iters: 100, epoch: 8 | loss: 0.4968168
	speed: 0.0121s/iter; left time: 11.4808s
	iters: 200, epoch: 8 | loss: 0.7111886
	speed: 0.0042s/iter; left time: 3.5680s
	iters: 300, epoch: 8 | loss: 0.6481635
	speed: 0.0040s/iter; left time: 2.9966s
	iters: 400, epoch: 8 | loss: 0.3678807
	speed: 0.0040s/iter; left time: 2.5900s
	iters: 500, epoch: 8 | loss: 1.0482212
	speed: 0.0040s/iter; left time: 2.1837s
	iters: 600, epoch: 8 | loss: 0.2404798
	speed: 0.0040s/iter; left time: 1.7941s
	iters: 700, epoch: 8 | loss: 0.3267155
	speed: 0.0040s/iter; left time: 1.3868s
	iters: 800, epoch: 8 | loss: 0.5104005
	speed: 0.0040s/iter; left time: 0.9846s
	iters: 900, epoch: 8 | loss: 0.3446324
	speed: 0.0040s/iter; left time: 0.5851s
	iters: 1000, epoch: 8 | loss: 0.2912636
	speed: 0.0040s/iter; left time: 0.1839s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.261102199554443
Epoch: 8, Steps: 1045 | Train Loss: 0.4985763 Vali Loss: 0.3223685 Best vali loss: 0.3024585

best validation loss 0.302458529214781

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0038480641348, 'e_layers': 2, 'learning_rate': 0.0004613818596, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2854182
	speed: 0.0085s/iter; left time: 70.0141s
	iters: 200, epoch: 1 | loss: 0.3051891
	speed: 0.0032s/iter; left time: 26.2737s
	iters: 300, epoch: 1 | loss: 1.0956262
	speed: 0.0032s/iter; left time: 25.4833s
	iters: 400, epoch: 1 | loss: 0.2711571
	speed: 0.0032s/iter; left time: 25.3054s
	iters: 500, epoch: 1 | loss: 0.9608470
	speed: 0.0032s/iter; left time: 24.9165s
	iters: 600, epoch: 1 | loss: 0.9443306
	speed: 0.0032s/iter; left time: 24.6777s
	iters: 700, epoch: 1 | loss: 0.4225152
	speed: 0.0032s/iter; left time: 24.3697s
	iters: 800, epoch: 1 | loss: 0.2382918
	speed: 0.0030s/iter; left time: 22.3973s
	iters: 900, epoch: 1 | loss: 0.5046072
	speed: 0.0029s/iter; left time: 21.8674s
	iters: 1000, epoch: 1 | loss: 0.3931587
	speed: 0.0030s/iter; left time: 21.7424s
Updating learning rate to 0.00044382155817821806
Validation loss decreased (inf --> 0.2999).  Saving model state dict ...
Epoch: 1 cost time: 3.5191519260406494
Epoch: 1, Steps: 1045 | Train Loss: 0.5421141 Vali Loss: 0.2999232 Best vali loss: 0.2999232
	iters: 100, epoch: 2 | loss: 0.3081563
	speed: 0.0102s/iter; left time: 73.3015s
	iters: 200, epoch: 2 | loss: 0.2553615
	speed: 0.0034s/iter; left time: 23.8818s
	iters: 300, epoch: 2 | loss: 0.5022208
	speed: 0.0034s/iter; left time: 23.8077s
	iters: 400, epoch: 2 | loss: 0.7186360
	speed: 0.0035s/iter; left time: 24.0277s
	iters: 500, epoch: 2 | loss: 1.2013949
	speed: 0.0034s/iter; left time: 23.1244s
	iters: 600, epoch: 2 | loss: 0.7074263
	speed: 0.0034s/iter; left time: 22.5840s
	iters: 700, epoch: 2 | loss: 0.7087259
	speed: 0.0035s/iter; left time: 23.4691s
	iters: 800, epoch: 2 | loss: 0.4824458
	speed: 0.0035s/iter; left time: 22.8616s
	iters: 900, epoch: 2 | loss: 0.3621157
	speed: 0.0034s/iter; left time: 21.7398s
	iters: 1000, epoch: 2 | loss: 1.0278630
	speed: 0.0034s/iter; left time: 21.4502s
Updating learning rate to 0.00039381405061980976
Validation loss decreased (0.2999 --> 0.2918).  Saving model state dict ...
Epoch: 2 cost time: 3.618006944656372
Epoch: 2, Steps: 1045 | Train Loss: 0.6274346 Vali Loss: 0.2918087 Best vali loss: 0.2918087
	iters: 100, epoch: 3 | loss: 0.2171506
	speed: 0.0108s/iter; left time: 66.6515s
	iters: 200, epoch: 3 | loss: 0.4522311
	speed: 0.0034s/iter; left time: 20.4271s
	iters: 300, epoch: 3 | loss: 0.2225416
	speed: 0.0034s/iter; left time: 20.0946s
	iters: 400, epoch: 3 | loss: 0.4168528
	speed: 0.0034s/iter; left time: 19.8385s
	iters: 500, epoch: 3 | loss: 0.3004253
	speed: 0.0034s/iter; left time: 19.4031s
	iters: 600, epoch: 3 | loss: 0.5068265
	speed: 0.0033s/iter; left time: 18.9207s
	iters: 700, epoch: 3 | loss: 0.4332230
	speed: 0.0033s/iter; left time: 18.6501s
	iters: 800, epoch: 3 | loss: 1.3623155
	speed: 0.0034s/iter; left time: 18.6920s
	iters: 900, epoch: 3 | loss: 1.3171020
	speed: 0.0036s/iter; left time: 19.1237s
	iters: 1000, epoch: 3 | loss: 1.0601454
	speed: 0.0035s/iter; left time: 18.7099s
Updating learning rate to 0.000318972526631358
Epoch: 3 cost time: 3.594627618789673
Epoch: 3, Steps: 1045 | Train Loss: 0.6288814 Vali Loss: 0.2981912 Best vali loss: 0.2918087
	iters: 100, epoch: 4 | loss: 0.2913032
	speed: 0.0101s/iter; left time: 51.5487s
	iters: 200, epoch: 4 | loss: 0.8860487
	speed: 0.0033s/iter; left time: 16.7383s
	iters: 300, epoch: 4 | loss: 1.3855275
	speed: 0.0034s/iter; left time: 16.5593s
	iters: 400, epoch: 4 | loss: 1.1923013
	speed: 0.0034s/iter; left time: 16.4491s
	iters: 500, epoch: 4 | loss: 0.4060998
	speed: 0.0034s/iter; left time: 16.0703s
	iters: 600, epoch: 4 | loss: 0.3376242
	speed: 0.0034s/iter; left time: 15.9121s
	iters: 700, epoch: 4 | loss: 0.2317020
	speed: 0.0034s/iter; left time: 15.4976s
	iters: 800, epoch: 4 | loss: 1.6478740
	speed: 0.0034s/iter; left time: 15.0402s
	iters: 900, epoch: 4 | loss: 0.1803017
	speed: 0.0034s/iter; left time: 14.7317s
	iters: 1000, epoch: 4 | loss: 0.3999155
	speed: 0.0034s/iter; left time: 14.3036s
Updating learning rate to 0.0002306909298
Epoch: 4 cost time: 3.5885303020477295
Epoch: 4, Steps: 1045 | Train Loss: 0.6958698 Vali Loss: 0.2936316 Best vali loss: 0.2918087
	iters: 100, epoch: 5 | loss: 0.4318622
	speed: 0.0098s/iter; left time: 40.1201s
	iters: 200, epoch: 5 | loss: 1.2650195
	speed: 0.0029s/iter; left time: 11.5417s
	iters: 300, epoch: 5 | loss: 0.3277037
	speed: 0.0028s/iter; left time: 10.8508s
	iters: 400, epoch: 5 | loss: 0.6355067
	speed: 0.0028s/iter; left time: 10.4913s
	iters: 500, epoch: 5 | loss: 0.2908584
	speed: 0.0028s/iter; left time: 10.2865s
	iters: 600, epoch: 5 | loss: 0.3246616
	speed: 0.0028s/iter; left time: 9.9131s
	iters: 700, epoch: 5 | loss: 0.2040187
	speed: 0.0028s/iter; left time: 9.6752s
	iters: 800, epoch: 5 | loss: 0.1814319
	speed: 0.0028s/iter; left time: 9.3625s
	iters: 900, epoch: 5 | loss: 0.5793651
	speed: 0.0028s/iter; left time: 9.2034s
	iters: 1000, epoch: 5 | loss: 0.4074436
	speed: 0.0028s/iter; left time: 8.7729s
Updating learning rate to 0.00014240933296864202
Epoch: 5 cost time: 2.9711878299713135
Epoch: 5, Steps: 1045 | Train Loss: 0.4647872 Vali Loss: 0.3031702 Best vali loss: 0.2918087
	iters: 100, epoch: 6 | loss: 0.3880534
	speed: 0.0094s/iter; left time: 28.6297s
	iters: 200, epoch: 6 | loss: 0.2518446
	speed: 0.0030s/iter; left time: 8.8174s
	iters: 300, epoch: 6 | loss: 0.2924775
	speed: 0.0031s/iter; left time: 8.8772s
	iters: 400, epoch: 6 | loss: 0.5797441
	speed: 0.0031s/iter; left time: 8.4838s
	iters: 500, epoch: 6 | loss: 0.9125501
	speed: 0.0031s/iter; left time: 8.2459s
	iters: 600, epoch: 6 | loss: 0.4142438
	speed: 0.0030s/iter; left time: 7.6887s
	iters: 700, epoch: 6 | loss: 0.2025165
	speed: 0.0031s/iter; left time: 7.6014s
	iters: 800, epoch: 6 | loss: 1.1103574
	speed: 0.0031s/iter; left time: 7.2391s
	iters: 900, epoch: 6 | loss: 0.3604778
	speed: 0.0031s/iter; left time: 6.9907s
	iters: 1000, epoch: 6 | loss: 0.4040442
	speed: 0.0031s/iter; left time: 6.6470s
Updating learning rate to 6.756780898019022e-05
Validation loss decreased (0.2918 --> 0.2889).  Saving model state dict ...
Epoch: 6 cost time: 3.2615814208984375
Epoch: 6, Steps: 1045 | Train Loss: 0.4916309 Vali Loss: 0.2888851 Best vali loss: 0.2888851
	iters: 100, epoch: 7 | loss: 0.4211246
	speed: 0.0105s/iter; left time: 20.9940s
	iters: 200, epoch: 7 | loss: 0.2443404
	speed: 0.0034s/iter; left time: 6.3435s
	iters: 300, epoch: 7 | loss: 0.2978033
	speed: 0.0034s/iter; left time: 6.0182s
	iters: 400, epoch: 7 | loss: 1.0796605
	speed: 0.0034s/iter; left time: 5.6976s
	iters: 500, epoch: 7 | loss: 0.5037843
	speed: 0.0034s/iter; left time: 5.3464s
	iters: 600, epoch: 7 | loss: 0.3014182
	speed: 0.0034s/iter; left time: 5.0151s
	iters: 700, epoch: 7 | loss: 0.2383793
	speed: 0.0034s/iter; left time: 4.6765s
	iters: 800, epoch: 7 | loss: 0.2372737
	speed: 0.0034s/iter; left time: 4.3505s
	iters: 900, epoch: 7 | loss: 0.2607481
	speed: 0.0033s/iter; left time: 3.9838s
	iters: 1000, epoch: 7 | loss: 0.3691151
	speed: 0.0034s/iter; left time: 3.6551s
Updating learning rate to 1.756030142178193e-05
Epoch: 7 cost time: 3.5521693229675293
Epoch: 7, Steps: 1045 | Train Loss: 0.3953648 Vali Loss: 0.3141964 Best vali loss: 0.2888851
	iters: 100, epoch: 8 | loss: 0.7403931
	speed: 0.0099s/iter; left time: 9.3875s
	iters: 200, epoch: 8 | loss: 0.4286734
	speed: 0.0031s/iter; left time: 2.5964s
	iters: 300, epoch: 8 | loss: 0.4215529
	speed: 0.0030s/iter; left time: 2.2464s
	iters: 400, epoch: 8 | loss: 0.5517135
	speed: 0.0030s/iter; left time: 1.9569s
	iters: 500, epoch: 8 | loss: 0.5545710
	speed: 0.0030s/iter; left time: 1.6545s
	iters: 600, epoch: 8 | loss: 0.2528337
	speed: 0.0030s/iter; left time: 1.3557s
	iters: 700, epoch: 8 | loss: 0.1941336
	speed: 0.0031s/iter; left time: 1.0646s
	iters: 800, epoch: 8 | loss: 0.5309592
	speed: 0.0032s/iter; left time: 0.7844s
	iters: 900, epoch: 8 | loss: 0.2241409
	speed: 0.0029s/iter; left time: 0.4208s
	iters: 1000, epoch: 8 | loss: 0.2272266
	speed: 0.0029s/iter; left time: 0.1352s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.198017120361328
Epoch: 8, Steps: 1045 | Train Loss: 0.4126198 Vali Loss: 0.3177135 Best vali loss: 0.2888851

best validation loss 0.28888506945201836

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0099866173088, 'e_layers': 2, 'learning_rate': 0.0001713690701, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5241352
	speed: 0.0094s/iter; left time: 8.9396s
Updating learning rate to 0.00016484672323544095
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.7997040748596191
Epoch: 1, Steps: 131 | Train Loss: 0.5241352 Vali Loss: 0.2792840 Best vali loss: 0.2792840
	iters: 100, epoch: 2 | loss: 0.4273764
	speed: 0.0070s/iter; left time: 5.7098s
Updating learning rate to 0.0001462726508266714
Epoch: 2 cost time: 0.5584473609924316
Epoch: 2, Steps: 131 | Train Loss: 0.4273764 Vali Loss: 0.2807084 Best vali loss: 0.2792840
	iters: 100, epoch: 3 | loss: 0.4319593
	speed: 0.0070s/iter; left time: 4.8337s
Updating learning rate to 0.00011847458702354084
Epoch: 3 cost time: 0.5750734806060791
Epoch: 3, Steps: 131 | Train Loss: 0.4319593 Vali Loss: 0.2801477 Best vali loss: 0.2792840
	iters: 100, epoch: 4 | loss: 0.6709718
	speed: 0.0068s/iter; left time: 3.7767s
Updating learning rate to 8.568453505e-05
Epoch: 4 cost time: 0.5139980316162109
Epoch: 4, Steps: 131 | Train Loss: 0.6709718 Vali Loss: 0.2878320 Best vali loss: 0.2792840
	iters: 100, epoch: 5 | loss: 0.4096305
	speed: 0.0064s/iter; left time: 2.7287s
Updating learning rate to 5.2894483076459164e-05
Epoch: 5 cost time: 0.5042312145233154
Epoch: 5, Steps: 131 | Train Loss: 0.4096305 Vali Loss: 0.2949741 Best vali loss: 0.2792840
	iters: 100, epoch: 6 | loss: 0.4324967
	speed: 0.0068s/iter; left time: 2.0138s
Updating learning rate to 2.5096419273328592e-05
Epoch: 6 cost time: 0.527332067489624
Epoch: 6, Steps: 131 | Train Loss: 0.4324967 Vali Loss: 0.2917537 Best vali loss: 0.2792840
	iters: 100, epoch: 7 | loss: 0.3221457
	speed: 0.0065s/iter; left time: 1.0657s
Updating learning rate to 6.522346864559037e-06
Epoch: 7 cost time: 0.5201611518859863
Epoch: 7, Steps: 131 | Train Loss: 0.3221457 Vali Loss: 0.2915431 Best vali loss: 0.2792840
	iters: 100, epoch: 8 | loss: 0.4273227
	speed: 0.0069s/iter; left time: 0.2203s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5550775527954102
Epoch: 8, Steps: 131 | Train Loss: 0.4273227 Vali Loss: 0.2913894 Best vali loss: 0.2792840

best validation loss 0.2792839697853435

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0037418801676, 'e_layers': 1, 'learning_rate': 0.0015075012128, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2865854
	speed: 0.0076s/iter; left time: 63.0292s
	iters: 200, epoch: 1 | loss: 0.3646728
	speed: 0.0024s/iter; left time: 19.2113s
	iters: 300, epoch: 1 | loss: 0.3161912
	speed: 0.0024s/iter; left time: 18.9693s
	iters: 400, epoch: 1 | loss: 0.8658327
	speed: 0.0023s/iter; left time: 18.4751s
	iters: 500, epoch: 1 | loss: 0.9699453
	speed: 0.0024s/iter; left time: 18.5457s
	iters: 600, epoch: 1 | loss: 0.2806097
	speed: 0.0023s/iter; left time: 18.1039s
	iters: 700, epoch: 1 | loss: 0.8743119
	speed: 0.0023s/iter; left time: 17.9255s
	iters: 800, epoch: 1 | loss: 0.3579774
	speed: 0.0023s/iter; left time: 17.6367s
	iters: 900, epoch: 1 | loss: 1.1805286
	speed: 0.0024s/iter; left time: 17.5445s
	iters: 1000, epoch: 1 | loss: 0.2427225
	speed: 0.0023s/iter; left time: 17.1012s
Updating learning rate to 0.0014501253642709307
Validation loss decreased (inf --> 0.2963).  Saving model state dict ...
Epoch: 1 cost time: 2.7066752910614014
Epoch: 1, Steps: 1045 | Train Loss: 0.5739378 Vali Loss: 0.2963454 Best vali loss: 0.2963454
	iters: 100, epoch: 2 | loss: 0.2962300
	speed: 0.0079s/iter; left time: 57.1437s
	iters: 200, epoch: 2 | loss: 0.3246815
	speed: 0.0021s/iter; left time: 14.9665s
	iters: 300, epoch: 2 | loss: 0.2879318
	speed: 0.0021s/iter; left time: 14.7025s
	iters: 400, epoch: 2 | loss: 0.2528443
	speed: 0.0021s/iter; left time: 14.5862s
	iters: 500, epoch: 2 | loss: 0.2574038
	speed: 0.0021s/iter; left time: 14.2717s
	iters: 600, epoch: 2 | loss: 0.2308302
	speed: 0.0021s/iter; left time: 14.0432s
	iters: 700, epoch: 2 | loss: 0.2884465
	speed: 0.0022s/iter; left time: 14.4349s
	iters: 800, epoch: 2 | loss: 0.2902320
	speed: 0.0022s/iter; left time: 14.0144s
	iters: 900, epoch: 2 | loss: 0.2546539
	speed: 0.0021s/iter; left time: 13.7885s
	iters: 1000, epoch: 2 | loss: 0.9782178
	speed: 0.0021s/iter; left time: 13.3018s
Updating learning rate to 0.0012867327715089122
Validation loss decreased (0.2963 --> 0.2848).  Saving model state dict ...
Epoch: 2 cost time: 2.259542465209961
Epoch: 2, Steps: 1045 | Train Loss: 0.3461472 Vali Loss: 0.2848327 Best vali loss: 0.2848327
	iters: 100, epoch: 3 | loss: 0.4019802
	speed: 0.0081s/iter; left time: 49.8447s
	iters: 200, epoch: 3 | loss: 1.2140180
	speed: 0.0024s/iter; left time: 14.4880s
	iters: 300, epoch: 3 | loss: 0.5839844
	speed: 0.0024s/iter; left time: 14.1188s
	iters: 400, epoch: 3 | loss: 0.4119845
	speed: 0.0024s/iter; left time: 14.1726s
	iters: 500, epoch: 3 | loss: 0.3208801
	speed: 0.0024s/iter; left time: 13.9171s
	iters: 600, epoch: 3 | loss: 0.4291976
	speed: 0.0024s/iter; left time: 13.8618s
	iters: 700, epoch: 3 | loss: 0.1783274
	speed: 0.0025s/iter; left time: 13.6987s
	iters: 800, epoch: 3 | loss: 0.2118582
	speed: 0.0024s/iter; left time: 13.3344s
	iters: 900, epoch: 3 | loss: 0.7069253
	speed: 0.0025s/iter; left time: 13.1966s
	iters: 1000, epoch: 3 | loss: 0.3720102
	speed: 0.0024s/iter; left time: 12.8202s
Updating learning rate to 0.0010421984756044198
Epoch: 3 cost time: 2.565065860748291
Epoch: 3, Steps: 1045 | Train Loss: 0.4831166 Vali Loss: 0.3135840 Best vali loss: 0.2848327

best validation loss 0.28483266651342243

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270601119, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597032
	speed: 0.0106s/iter; left time: 10.0244s
Updating learning rate to 0.0002345378908
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9317848682403564
Epoch: 1, Steps: 131 | Train Loss: 0.5597032 Vali Loss: 0.2756343 Best vali loss: 0.2756343
	iters: 100, epoch: 2 | loss: 0.3246343
	speed: 0.0089s/iter; left time: 7.2614s
Updating learning rate to 0.0001172689454
Validation loss decreased (0.2756 --> 0.2707).  Saving model state dict ...
Epoch: 2 cost time: 0.7063705921173096
Epoch: 2, Steps: 131 | Train Loss: 0.3246343 Vali Loss: 0.2706610 Best vali loss: 0.2706610
	iters: 100, epoch: 3 | loss: 0.4623035
	speed: 0.0090s/iter; left time: 6.1755s
Updating learning rate to 5.86344727e-05
Epoch: 3 cost time: 0.7018280029296875
Epoch: 3, Steps: 131 | Train Loss: 0.4623035 Vali Loss: 0.2805844 Best vali loss: 0.2706610

best validation loss 0.2706609612151388

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.004598105355, 'e_layers': 2, 'learning_rate': 0.0016348365347, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3311694
	speed: 0.0088s/iter; left time: 72.3040s
	iters: 200, epoch: 1 | loss: 0.3531225
	speed: 0.0034s/iter; left time: 27.6051s
	iters: 300, epoch: 1 | loss: 0.2761430
	speed: 0.0033s/iter; left time: 26.9282s
	iters: 400, epoch: 1 | loss: 0.4050205
	speed: 0.0033s/iter; left time: 26.5218s
	iters: 500, epoch: 1 | loss: 0.2090109
	speed: 0.0033s/iter; left time: 26.3241s
	iters: 600, epoch: 1 | loss: 0.5079453
	speed: 0.0033s/iter; left time: 25.9710s
	iters: 700, epoch: 1 | loss: 0.8482668
	speed: 0.0034s/iter; left time: 25.7819s
	iters: 800, epoch: 1 | loss: 0.3290246
	speed: 0.0034s/iter; left time: 25.6739s
	iters: 900, epoch: 1 | loss: 0.1910590
	speed: 0.0033s/iter; left time: 24.9875s
	iters: 1000, epoch: 1 | loss: 1.1420919
	speed: 0.0033s/iter; left time: 24.4077s
Updating learning rate to 0.001572614274055504
Validation loss decreased (inf --> 0.3000).  Saving model state dict ...
Epoch: 1 cost time: 3.7590715885162354
Epoch: 1, Steps: 1045 | Train Loss: 0.5592854 Vali Loss: 0.2999564 Best vali loss: 0.2999564
	iters: 100, epoch: 2 | loss: 0.3292572
	speed: 0.0103s/iter; left time: 74.4304s
	iters: 200, epoch: 2 | loss: 0.3978167
	speed: 0.0034s/iter; left time: 24.1994s
	iters: 300, epoch: 2 | loss: 0.4175453
	speed: 0.0034s/iter; left time: 23.5666s
	iters: 400, epoch: 2 | loss: 0.1628644
	speed: 0.0033s/iter; left time: 23.0586s
	iters: 500, epoch: 2 | loss: 0.1969265
	speed: 0.0034s/iter; left time: 22.9714s
	iters: 600, epoch: 2 | loss: 0.4888871
	speed: 0.0034s/iter; left time: 22.6430s
	iters: 700, epoch: 2 | loss: 1.7456894
	speed: 0.0034s/iter; left time: 22.3538s
	iters: 800, epoch: 2 | loss: 1.1398585
	speed: 0.0034s/iter; left time: 22.0060s
	iters: 900, epoch: 2 | loss: 0.2933789
	speed: 0.0034s/iter; left time: 21.8396s
	iters: 1000, epoch: 2 | loss: 0.6115523
	speed: 0.0033s/iter; left time: 21.0171s
Updating learning rate to 0.0013954202672589431
Epoch: 2 cost time: 3.5614802837371826
Epoch: 2, Steps: 1045 | Train Loss: 0.5783776 Vali Loss: 0.3012686 Best vali loss: 0.2999564
	iters: 100, epoch: 3 | loss: 0.3737454
	speed: 0.0100s/iter; left time: 61.5936s
	iters: 200, epoch: 3 | loss: 0.3028006
	speed: 0.0030s/iter; left time: 18.4945s
	iters: 300, epoch: 3 | loss: 0.3925056
	speed: 0.0031s/iter; left time: 18.4107s
	iters: 400, epoch: 3 | loss: 0.2790624
	speed: 0.0030s/iter; left time: 17.8543s
	iters: 500, epoch: 3 | loss: 0.5138463
	speed: 0.0031s/iter; left time: 17.6524s
	iters: 600, epoch: 3 | loss: 0.3965061
	speed: 0.0031s/iter; left time: 17.3003s
	iters: 700, epoch: 3 | loss: 0.3449385
	speed: 0.0031s/iter; left time: 17.0985s
	iters: 800, epoch: 3 | loss: 0.2412002
	speed: 0.0031s/iter; left time: 16.7219s
	iters: 900, epoch: 3 | loss: 0.1910922
	speed: 0.0030s/iter; left time: 16.2748s
	iters: 1000, epoch: 3 | loss: 0.2368388
	speed: 0.0029s/iter; left time: 15.2713s
Updating learning rate to 0.0011302306955774226
Validation loss decreased (0.3000 --> 0.2875).  Saving model state dict ...
Epoch: 3 cost time: 3.209648847579956
Epoch: 3, Steps: 1045 | Train Loss: 0.3272536 Vali Loss: 0.2874551 Best vali loss: 0.2874551

best validation loss 0.28745507451405355

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270601119, 'e_layers': 2, 'learning_rate': 0.0002345378908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4196284
	speed: 0.0110s/iter; left time: 6.1347s
Updating learning rate to 2.931723635e-05
Epoch: 4 cost time: 0.9467308521270752
Epoch: 4, Steps: 131 | Train Loss: 0.4196284 Vali Loss: 0.3041298 Best vali loss: 0.2706610
	iters: 100, epoch: 5 | loss: 0.2810391
	speed: 0.0087s/iter; left time: 3.6813s
Updating learning rate to 1.4658618175e-05
Epoch: 5 cost time: 0.6962909698486328
Epoch: 5, Steps: 131 | Train Loss: 0.2810391 Vali Loss: 0.2981970 Best vali loss: 0.2706610
	iters: 100, epoch: 6 | loss: 0.4317425
	speed: 0.0085s/iter; left time: 2.4964s
Updating learning rate to 7.3293090875e-06
Epoch: 6 cost time: 0.6917088031768799
Epoch: 6, Steps: 131 | Train Loss: 0.4317425 Vali Loss: 0.2987803 Best vali loss: 0.2706610
	iters: 100, epoch: 7 | loss: 0.4640654
	speed: 0.0086s/iter; left time: 1.4022s
Updating learning rate to 3.66465454375e-06
Epoch: 7 cost time: 0.7008588314056396
Epoch: 7, Steps: 131 | Train Loss: 0.4640654 Vali Loss: 0.2986266 Best vali loss: 0.2706610
	iters: 100, epoch: 8 | loss: 0.3273794
	speed: 0.0085s/iter; left time: 0.2727s
Updating learning rate to 1.832327271875e-06
Epoch: 8 cost time: 0.692518949508667
Epoch: 8, Steps: 131 | Train Loss: 0.3273794 Vali Loss: 0.2956778 Best vali loss: 0.2706610

best validation loss 0.2706609612151388

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0027076102037, 'e_layers': 3, 'learning_rate': 7.59114646e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3217567
	speed: 0.0092s/iter; left time: 37.7757s
	iters: 200, epoch: 1 | loss: 0.4248620
	speed: 0.0040s/iter; left time: 15.9547s
	iters: 300, epoch: 1 | loss: 1.0031649
	speed: 0.0040s/iter; left time: 15.5397s
	iters: 400, epoch: 1 | loss: 0.2204154
	speed: 0.0040s/iter; left time: 15.1250s
	iters: 500, epoch: 1 | loss: 0.3038076
	speed: 0.0038s/iter; left time: 14.0008s
Updating learning rate to 7.302225651344755e-05
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 2.326000452041626
Epoch: 1, Steps: 523 | Train Loss: 0.4548013 Vali Loss: 0.2814119 Best vali loss: 0.2814119
	iters: 100, epoch: 2 | loss: 0.5353078
	speed: 0.0089s/iter; left time: 31.7223s
	iters: 200, epoch: 2 | loss: 0.2158982
	speed: 0.0044s/iter; left time: 15.2089s
	iters: 300, epoch: 2 | loss: 0.4236708
	speed: 0.0044s/iter; left time: 14.7814s
	iters: 400, epoch: 2 | loss: 0.7428866
	speed: 0.0044s/iter; left time: 14.3467s
	iters: 500, epoch: 2 | loss: 0.3424348
	speed: 0.0044s/iter; left time: 13.9119s
Updating learning rate to 6.479448799423128e-05
Epoch: 2 cost time: 2.3432679176330566
Epoch: 2, Steps: 523 | Train Loss: 0.4520397 Vali Loss: 0.2817334 Best vali loss: 0.2814119
	iters: 100, epoch: 3 | loss: 0.5402305
	speed: 0.0083s/iter; left time: 25.2354s
	iters: 200, epoch: 3 | loss: 0.5961598
	speed: 0.0039s/iter; left time: 11.4672s
	iters: 300, epoch: 3 | loss: 0.1876002
	speed: 0.0037s/iter; left time: 10.3698s
	iters: 400, epoch: 3 | loss: 0.6246057
	speed: 0.0037s/iter; left time: 10.0094s
	iters: 500, epoch: 3 | loss: 0.4270397
	speed: 0.0037s/iter; left time: 9.8213s
Updating learning rate to 5.248076221449451e-05
Validation loss decreased (0.2814 --> 0.2787).  Saving model state dict ...
Epoch: 3 cost time: 2.0031943321228027
Epoch: 3, Steps: 523 | Train Loss: 0.4751272 Vali Loss: 0.2786888 Best vali loss: 0.2786888
	iters: 100, epoch: 4 | loss: 0.4084376
	speed: 0.0081s/iter; left time: 20.2752s
	iters: 200, epoch: 4 | loss: 0.3060923
	speed: 0.0036s/iter; left time: 8.7612s
	iters: 300, epoch: 4 | loss: 0.4736509
	speed: 0.0037s/iter; left time: 8.4730s
	iters: 400, epoch: 4 | loss: 0.4664400
	speed: 0.0037s/iter; left time: 8.1889s
	iters: 500, epoch: 4 | loss: 0.4076497
	speed: 0.0037s/iter; left time: 7.7707s
Updating learning rate to 3.79557323e-05
Epoch: 4 cost time: 1.9510509967803955
Epoch: 4, Steps: 523 | Train Loss: 0.4124541 Vali Loss: 0.2804959 Best vali loss: 0.2786888
	iters: 100, epoch: 5 | loss: 0.3284076
	speed: 0.0080s/iter; left time: 15.9985s
	iters: 200, epoch: 5 | loss: 0.4105113
	speed: 0.0038s/iter; left time: 7.1108s
	iters: 300, epoch: 5 | loss: 0.2646539
	speed: 0.0037s/iter; left time: 6.6626s
	iters: 400, epoch: 5 | loss: 0.6150632
	speed: 0.0040s/iter; left time: 6.8060s
	iters: 500, epoch: 5 | loss: 0.6543072
	speed: 0.0040s/iter; left time: 6.3415s
Updating learning rate to 2.34307023855055e-05
Epoch: 5 cost time: 2.05350661277771
Epoch: 5, Steps: 523 | Train Loss: 0.4545886 Vali Loss: 0.2836086 Best vali loss: 0.2786888
	iters: 100, epoch: 6 | loss: 0.8165060
	speed: 0.0081s/iter; left time: 11.8630s
	iters: 200, epoch: 6 | loss: 0.3571647
	speed: 0.0037s/iter; left time: 5.1084s
	iters: 300, epoch: 6 | loss: 1.5947433
	speed: 0.0040s/iter; left time: 5.0909s
	iters: 400, epoch: 6 | loss: 0.8810356
	speed: 0.0040s/iter; left time: 4.6811s
	iters: 500, epoch: 6 | loss: 0.3746862
	speed: 0.0040s/iter; left time: 4.2792s
Updating learning rate to 1.111697660576873e-05
Epoch: 6 cost time: 2.0812184810638428
Epoch: 6, Steps: 523 | Train Loss: 0.8048271 Vali Loss: 0.2859330 Best vali loss: 0.2786888
	iters: 100, epoch: 7 | loss: 0.7473195
	speed: 0.0084s/iter; left time: 7.9779s
	iters: 200, epoch: 7 | loss: 0.3039538
	speed: 0.0040s/iter; left time: 3.3867s
	iters: 300, epoch: 7 | loss: 0.1965356
	speed: 0.0040s/iter; left time: 2.9738s
	iters: 400, epoch: 7 | loss: 0.3874237
	speed: 0.0040s/iter; left time: 2.5880s
	iters: 500, epoch: 7 | loss: 0.3772646
	speed: 0.0040s/iter; left time: 2.1881s
Updating learning rate to 2.889208086552454e-06
Epoch: 7 cost time: 2.130525588989258
Epoch: 7, Steps: 523 | Train Loss: 0.4024994 Vali Loss: 0.2843381 Best vali loss: 0.2786888
	iters: 100, epoch: 8 | loss: 0.6023557
	speed: 0.0087s/iter; left time: 3.6703s
	iters: 200, epoch: 8 | loss: 0.5529423
	speed: 0.0043s/iter; left time: 1.4004s
	iters: 300, epoch: 8 | loss: 0.3983920
	speed: 0.0045s/iter; left time: 0.9976s
	iters: 400, epoch: 8 | loss: 0.4129060
	speed: 0.0040s/iter; left time: 0.4972s
	iters: 500, epoch: 8 | loss: 0.6629298
	speed: 0.0040s/iter; left time: 0.0962s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.23468279838562
Epoch: 8, Steps: 523 | Train Loss: 0.5259052 Vali Loss: 0.2839970 Best vali loss: 0.2786888

best validation loss 0.2786888458574514

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0014130766604, 'e_layers': 3, 'learning_rate': 0.0006258624141, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5726998
	speed: 0.0103s/iter; left time: 9.7615s
Updating learning rate to 0.0006020419443275467
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.9079890251159668
Epoch: 1, Steps: 131 | Train Loss: 0.5726998 Vali Loss: 0.2818576 Best vali loss: 0.2818576
	iters: 100, epoch: 2 | loss: 0.4599065
	speed: 0.0084s/iter; left time: 6.8309s
Updating learning rate to 0.0005342069855999466
Validation loss decreased (0.2819 --> 0.2807).  Saving model state dict ...
Epoch: 2 cost time: 0.6919808387756348
Epoch: 2, Steps: 131 | Train Loss: 0.4599065 Vali Loss: 0.2807023 Best vali loss: 0.2807023
	iters: 100, epoch: 3 | loss: 0.6893351
	speed: 0.0082s/iter; left time: 5.6543s
Updating learning rate to 0.0004326847954580446
Epoch: 3 cost time: 0.6807663440704346
Epoch: 3, Steps: 131 | Train Loss: 0.6893351 Vali Loss: 0.2826768 Best vali loss: 0.2807023
	iters: 100, epoch: 4 | loss: 0.4211779
	speed: 0.0078s/iter; left time: 4.3109s
Updating learning rate to 0.00031293120705
Epoch: 4 cost time: 0.6209607124328613
Epoch: 4, Steps: 131 | Train Loss: 0.4211779 Vali Loss: 0.2868692 Best vali loss: 0.2807023
	iters: 100, epoch: 5 | loss: 0.4206048
	speed: 0.0079s/iter; left time: 3.3695s
Updating learning rate to 0.00019317761864195542
Epoch: 5 cost time: 0.6655361652374268
Epoch: 5, Steps: 131 | Train Loss: 0.4206048 Vali Loss: 0.2879123 Best vali loss: 0.2807023
	iters: 100, epoch: 6 | loss: 0.5022886
	speed: 0.0080s/iter; left time: 2.3456s
Updating learning rate to 9.165542850005346e-05
Epoch: 6 cost time: 0.6548025608062744
Epoch: 6, Steps: 131 | Train Loss: 0.5022886 Vali Loss: 0.2913955 Best vali loss: 0.2807023
	iters: 100, epoch: 7 | loss: 0.6770094
	speed: 0.0078s/iter; left time: 1.2656s
Updating learning rate to 2.382046977245332e-05
Epoch: 7 cost time: 0.6244769096374512
Epoch: 7, Steps: 131 | Train Loss: 0.6770094 Vali Loss: 0.2907766 Best vali loss: 0.2807023
	iters: 100, epoch: 8 | loss: 0.4210952
	speed: 0.0074s/iter; left time: 0.2380s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6039638519287109
Epoch: 8, Steps: 131 | Train Loss: 0.4210952 Vali Loss: 0.2904213 Best vali loss: 0.2807023

best validation loss 0.28070225591839537

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008525944678, 'e_layers': 1, 'learning_rate': 0.0001433899763, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4290438
	speed: 0.0081s/iter; left time: 16.2064s
	iters: 200, epoch: 1 | loss: 0.3919207
	speed: 0.0025s/iter; left time: 4.8223s
Updating learning rate to 0.00013793252028542423
Validation loss decreased (inf --> 0.3010).  Saving model state dict ...
Epoch: 1 cost time: 0.9369096755981445
Epoch: 1, Steps: 262 | Train Loss: 0.4104822 Vali Loss: 0.3009604 Best vali loss: 0.3009604
	iters: 100, epoch: 2 | loss: 0.6308382
	speed: 0.0062s/iter; left time: 10.7043s
	iters: 200, epoch: 2 | loss: 0.5325010
	speed: 0.0025s/iter; left time: 4.1351s
Updating learning rate to 0.00012239100044795416
Validation loss decreased (0.3010 --> 0.2863).  Saving model state dict ...
Epoch: 2 cost time: 0.6849720478057861
Epoch: 2, Steps: 262 | Train Loss: 0.5816696 Vali Loss: 0.2862804 Best vali loss: 0.2862804
	iters: 100, epoch: 3 | loss: 0.5180603
	speed: 0.0062s/iter; left time: 9.1520s
	iters: 200, epoch: 3 | loss: 0.3177190
	speed: 0.0028s/iter; left time: 3.7847s
Updating learning rate to 9.913147229861645e-05
Validation loss decreased (0.2863 --> 0.2818).  Saving model state dict ...
Epoch: 3 cost time: 0.755626916885376
Epoch: 3, Steps: 262 | Train Loss: 0.4178897 Vali Loss: 0.2817776 Best vali loss: 0.2817776

best validation loss 0.28177755740815796

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 1, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4849054
	speed: 0.0084s/iter; left time: 7.9777s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6526963710784912
Epoch: 1, Steps: 131 | Train Loss: 0.4849054 Vali Loss: 0.2780644 Best vali loss: 0.2780644
	iters: 100, epoch: 2 | loss: 0.2553572
	speed: 0.0057s/iter; left time: 4.6771s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2781 --> 0.2767).  Saving model state dict ...
Epoch: 2 cost time: 0.4370903968811035
Epoch: 2, Steps: 131 | Train Loss: 0.2553572 Vali Loss: 0.2767399 Best vali loss: 0.2767399
	iters: 100, epoch: 3 | loss: 0.5308921
	speed: 0.0057s/iter; left time: 3.9340s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.41342711448669434
Epoch: 3, Steps: 131 | Train Loss: 0.5308921 Vali Loss: 0.2767702 Best vali loss: 0.2767399

best validation loss 0.27673991598042025

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020810262153, 'e_layers': 1, 'learning_rate': 0.0004897546502, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4786412
	speed: 0.0084s/iter; left time: 7.9293s
Updating learning rate to 0.0004711144737360024
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6568539142608643
Epoch: 1, Steps: 131 | Train Loss: 0.4786412 Vali Loss: 0.2781445 Best vali loss: 0.2781445
	iters: 100, epoch: 2 | loss: 0.2478168
	speed: 0.0059s/iter; left time: 4.8058s
Updating learning rate to 0.0004180317422370327
Epoch: 2 cost time: 0.42434120178222656
Epoch: 2, Steps: 131 | Train Loss: 0.2478168 Vali Loss: 0.2829128 Best vali loss: 0.2781445
	iters: 100, epoch: 3 | loss: 0.4916874
	speed: 0.0055s/iter; left time: 3.7528s
Updating learning rate to 0.00033858782037764993
Epoch: 3 cost time: 0.41597890853881836
Epoch: 3, Steps: 131 | Train Loss: 0.4916874 Vali Loss: 0.2925965 Best vali loss: 0.2781445

best validation loss 0.27814453826401925

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 1, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4478197
	speed: 0.0085s/iter; left time: 4.7462s
Updating learning rate to 2.9315984725e-05
Epoch: 4 cost time: 0.6391294002532959
Epoch: 4, Steps: 131 | Train Loss: 0.4478197 Vali Loss: 0.2802803 Best vali loss: 0.2767399
	iters: 100, epoch: 5 | loss: 0.2297960
	speed: 0.0054s/iter; left time: 2.3097s
Updating learning rate to 1.46579923625e-05
Epoch: 5 cost time: 0.40989065170288086
Epoch: 5, Steps: 131 | Train Loss: 0.2297960 Vali Loss: 0.2813256 Best vali loss: 0.2767399
	iters: 100, epoch: 6 | loss: 0.4842894
	speed: 0.0053s/iter; left time: 1.5681s
Updating learning rate to 7.32899618125e-06
Epoch: 6 cost time: 0.40457630157470703
Epoch: 6, Steps: 131 | Train Loss: 0.4842894 Vali Loss: 0.2810045 Best vali loss: 0.2767399
	iters: 100, epoch: 7 | loss: 0.6222801
	speed: 0.0054s/iter; left time: 0.8763s
Updating learning rate to 3.664498090625e-06
Epoch: 7 cost time: 0.40637707710266113
Epoch: 7, Steps: 131 | Train Loss: 0.6222801 Vali Loss: 0.2828712 Best vali loss: 0.2767399
	iters: 100, epoch: 8 | loss: 0.3524914
	speed: 0.0054s/iter; left time: 0.1721s
Updating learning rate to 1.8322490453125e-06
Epoch: 8 cost time: 0.4046356678009033
Epoch: 8, Steps: 131 | Train Loss: 0.3524914 Vali Loss: 0.2826312 Best vali loss: 0.2767399

best validation loss 0.27673991598042025

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024742343051, 'e_layers': 4, 'learning_rate': 0.0018062893426, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1397532
	speed: 0.0106s/iter; left time: 43.3767s
	iters: 200, epoch: 1 | loss: 0.4974315
	speed: 0.0053s/iter; left time: 21.3144s
	iters: 300, epoch: 1 | loss: 0.4730442
	speed: 0.0053s/iter; left time: 20.7375s
	iters: 400, epoch: 1 | loss: 0.3296973
	speed: 0.0053s/iter; left time: 20.1844s
	iters: 500, epoch: 1 | loss: 1.0018885
	speed: 0.0052s/iter; left time: 19.3163s
Updating learning rate to 0.0018062893426
Validation loss decreased (inf --> 0.3301).  Saving model state dict ...
Epoch: 1 cost time: 3.041081190109253
Epoch: 1, Steps: 523 | Train Loss: 0.6883629 Vali Loss: 0.3301121 Best vali loss: 0.3301121
	iters: 100, epoch: 2 | loss: 0.9212490
	speed: 0.0107s/iter; left time: 37.9750s
	iters: 200, epoch: 2 | loss: 0.5489965
	speed: 0.0053s/iter; left time: 18.4131s
	iters: 300, epoch: 2 | loss: 0.6962382
	speed: 0.0053s/iter; left time: 17.7896s
	iters: 400, epoch: 2 | loss: 0.3772328
	speed: 0.0053s/iter; left time: 17.1956s
	iters: 500, epoch: 2 | loss: 0.9055845
	speed: 0.0053s/iter; left time: 16.8993s
Updating learning rate to 0.0009031446713
Validation loss decreased (0.3301 --> 0.3199).  Saving model state dict ...
Epoch: 2 cost time: 2.8119513988494873
Epoch: 2, Steps: 523 | Train Loss: 0.6898602 Vali Loss: 0.3198785 Best vali loss: 0.3198785
	iters: 100, epoch: 3 | loss: 0.5577346
	speed: 0.0107s/iter; left time: 32.4255s
	iters: 200, epoch: 3 | loss: 0.2410460
	speed: 0.0053s/iter; left time: 15.5564s
	iters: 300, epoch: 3 | loss: 0.5660554
	speed: 0.0053s/iter; left time: 14.9831s
	iters: 400, epoch: 3 | loss: 0.2817524
	speed: 0.0053s/iter; left time: 14.5864s
	iters: 500, epoch: 3 | loss: 0.2522803
	speed: 0.0053s/iter; left time: 13.8986s
Updating learning rate to 0.00045157233565
Epoch: 3 cost time: 2.800117254257202
Epoch: 3, Steps: 523 | Train Loss: 0.3797738 Vali Loss: 0.3245654 Best vali loss: 0.3198785
	iters: 100, epoch: 4 | loss: 0.4975051
	speed: 0.0101s/iter; left time: 25.5069s
	iters: 200, epoch: 4 | loss: 0.2574506
	speed: 0.0052s/iter; left time: 12.6470s
	iters: 300, epoch: 4 | loss: 0.9316496
	speed: 0.0053s/iter; left time: 12.3230s
	iters: 400, epoch: 4 | loss: 0.3140714
	speed: 0.0053s/iter; left time: 11.6489s
	iters: 500, epoch: 4 | loss: 0.4799606
	speed: 0.0053s/iter; left time: 11.1762s
Updating learning rate to 0.000225786167825
Epoch: 4 cost time: 2.7780206203460693
Epoch: 4, Steps: 523 | Train Loss: 0.4961275 Vali Loss: 0.3224457 Best vali loss: 0.3198785
	iters: 100, epoch: 5 | loss: 1.1055293
	speed: 0.0102s/iter; left time: 20.2667s
	iters: 200, epoch: 5 | loss: 0.2452249
	speed: 0.0053s/iter; left time: 9.9799s
	iters: 300, epoch: 5 | loss: 0.7929044
	speed: 0.0053s/iter; left time: 9.4662s
	iters: 400, epoch: 5 | loss: 1.6617129
	speed: 0.0053s/iter; left time: 8.9867s
	iters: 500, epoch: 5 | loss: 0.3753537
	speed: 0.0052s/iter; left time: 8.3464s
Updating learning rate to 0.0001128930839125
Epoch: 5 cost time: 2.7810957431793213
Epoch: 5, Steps: 523 | Train Loss: 0.8361450 Vali Loss: 0.3223051 Best vali loss: 0.3198785
	iters: 100, epoch: 6 | loss: 0.5063531
	speed: 0.0103s/iter; left time: 15.1868s
	iters: 200, epoch: 6 | loss: 0.2146761
	speed: 0.0052s/iter; left time: 7.1902s
	iters: 300, epoch: 6 | loss: 0.2881695
	speed: 0.0053s/iter; left time: 6.7479s
	iters: 400, epoch: 6 | loss: 0.2965395
	speed: 0.0053s/iter; left time: 6.1909s
	iters: 500, epoch: 6 | loss: 0.9306741
	speed: 0.0054s/iter; left time: 5.7371s
Updating learning rate to 5.644654195625e-05
Epoch: 6 cost time: 2.808180809020996
Epoch: 6, Steps: 523 | Train Loss: 0.4472825 Vali Loss: 0.3220783 Best vali loss: 0.3198785
	iters: 100, epoch: 7 | loss: 1.6082031
	speed: 0.0103s/iter; left time: 9.7797s
	iters: 200, epoch: 7 | loss: 0.2572418
	speed: 0.0053s/iter; left time: 4.4631s
	iters: 300, epoch: 7 | loss: 0.2147164
	speed: 0.0053s/iter; left time: 3.9571s
	iters: 400, epoch: 7 | loss: 1.0824108
	speed: 0.0053s/iter; left time: 3.4128s
	iters: 500, epoch: 7 | loss: 0.7510197
	speed: 0.0052s/iter; left time: 2.8532s
Updating learning rate to 2.8223270978125e-05
Epoch: 7 cost time: 2.791719675064087
Epoch: 7, Steps: 523 | Train Loss: 0.7827184 Vali Loss: 0.3222387 Best vali loss: 0.3198785
	iters: 100, epoch: 8 | loss: 0.4749204
	speed: 0.0101s/iter; left time: 4.2852s
	iters: 200, epoch: 8 | loss: 0.6374768
	speed: 0.0052s/iter; left time: 1.6906s
	iters: 300, epoch: 8 | loss: 1.1952072
	speed: 0.0053s/iter; left time: 1.1811s
	iters: 400, epoch: 8 | loss: 0.2169794
	speed: 0.0053s/iter; left time: 0.6512s
	iters: 500, epoch: 8 | loss: 0.3877870
	speed: 0.0052s/iter; left time: 0.1245s
Updating learning rate to 1.41116354890625e-05
Epoch: 8 cost time: 2.7668075561523438
Epoch: 8, Steps: 523 | Train Loss: 0.5824742 Vali Loss: 0.3221487 Best vali loss: 0.3198785

best validation loss 0.3198785455575349

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0018070739158, 'e_layers': 1, 'learning_rate': 0.000933762031, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000933762031
Validation loss decreased (inf --> 0.2935).  Saving model state dict ...
Epoch: 1 cost time: 0.4809243679046631
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2934586 Best vali loss: 0.2934586
Updating learning rate to 0.0004668810155
Validation loss decreased (0.2935 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 0.2781984806060791
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2828951 Best vali loss: 0.2828951
Updating learning rate to 0.00023344050775
Validation loss decreased (0.2829 --> 0.2820).  Saving model state dict ...
Epoch: 3 cost time: 0.26198244094848633
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2820002 Best vali loss: 0.2820002
Updating learning rate to 0.000116720253875
Validation loss decreased (0.2820 --> 0.2816).  Saving model state dict ...
Epoch: 4 cost time: 0.2576615810394287
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2815820 Best vali loss: 0.2815820
Updating learning rate to 5.83601269375e-05
Validation loss decreased (0.2816 --> 0.2812).  Saving model state dict ...
Epoch: 5 cost time: 0.26036524772644043
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2811808 Best vali loss: 0.2811808
Updating learning rate to 2.918006346875e-05
Validation loss decreased (0.2812 --> 0.2812).  Saving model state dict ...
Epoch: 6 cost time: 0.2682478427886963
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2811753 Best vali loss: 0.2811753
Updating learning rate to 1.4590031734375e-05
Epoch: 7 cost time: 0.2595179080963135
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2812885 Best vali loss: 0.2811753
Updating learning rate to 7.2950158671875e-06
Epoch: 8 cost time: 0.2649664878845215
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2812908 Best vali loss: 0.2811753

best validation loss 0.28117529421147025

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020990564753, 'e_layers': 3, 'learning_rate': 0.0004715354981, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6054990
	speed: 0.0112s/iter; left time: 22.3723s
	iters: 200, epoch: 1 | loss: 0.9171470
	speed: 0.0057s/iter; left time: 10.7280s
Updating learning rate to 0.0004715354981
Validation loss decreased (inf --> 0.2977).  Saving model state dict ...
Epoch: 1 cost time: 1.7589972019195557
Epoch: 1, Steps: 262 | Train Loss: 0.7613230 Vali Loss: 0.2976961 Best vali loss: 0.2976961
	iters: 100, epoch: 2 | loss: 0.7667387
	speed: 0.0126s/iter; left time: 21.8207s
	iters: 200, epoch: 2 | loss: 0.5689380
	speed: 0.0058s/iter; left time: 9.4743s
Updating learning rate to 0.00023576774905
Validation loss decreased (0.2977 --> 0.2935).  Saving model state dict ...
Epoch: 2 cost time: 1.5532832145690918
Epoch: 2, Steps: 262 | Train Loss: 0.6678384 Vali Loss: 0.2934709 Best vali loss: 0.2934709
	iters: 100, epoch: 3 | loss: 0.3683954
	speed: 0.0127s/iter; left time: 18.7543s
	iters: 200, epoch: 3 | loss: 0.4046852
	speed: 0.0056s/iter; left time: 7.7358s
Updating learning rate to 0.000117883874525
Validation loss decreased (0.2935 --> 0.2916).  Saving model state dict ...
Epoch: 3 cost time: 1.5185678005218506
Epoch: 3, Steps: 262 | Train Loss: 0.3865403 Vali Loss: 0.2915526 Best vali loss: 0.2915526

best validation loss 0.29155263612265037

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0048736010373, 'e_layers': 2, 'learning_rate': 5.28775528e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6026421
	speed: 0.0089s/iter; left time: 17.8499s
	iters: 200, epoch: 1 | loss: 0.4657663
	speed: 0.0033s/iter; left time: 6.3031s
Updating learning rate to 5.28775528e-05
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 1.165881633758545
Epoch: 1, Steps: 262 | Train Loss: 0.5342042 Vali Loss: 0.2781450 Best vali loss: 0.2781450
	iters: 100, epoch: 2 | loss: 0.4605008
	speed: 0.0082s/iter; left time: 14.2309s
	iters: 200, epoch: 2 | loss: 0.9811027
	speed: 0.0035s/iter; left time: 5.6412s
Updating learning rate to 2.64387764e-05
Validation loss decreased (0.2781 --> 0.2773).  Saving model state dict ...
Epoch: 2 cost time: 0.9668035507202148
Epoch: 2, Steps: 262 | Train Loss: 0.7208017 Vali Loss: 0.2772833 Best vali loss: 0.2772833
	iters: 100, epoch: 3 | loss: 0.4650313
	speed: 0.0082s/iter; left time: 12.0861s
	iters: 200, epoch: 3 | loss: 0.6567951
	speed: 0.0036s/iter; left time: 4.8844s
Updating learning rate to 1.32193882e-05
Epoch: 3 cost time: 0.9929988384246826
Epoch: 3, Steps: 262 | Train Loss: 0.5609132 Vali Loss: 0.2773633 Best vali loss: 0.2772833

best validation loss 0.27728333180391374

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0031254087454, 'e_layers': 1, 'learning_rate': 0.0001694736363, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001630234300889159
Validation loss decreased (inf --> 0.3049).  Saving model state dict ...
Epoch: 1 cost time: 0.5118396282196045
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3048806 Best vali loss: 0.3048806
Updating learning rate to 0.00014465479688003632
Validation loss decreased (0.3049 --> 0.2894).  Saving model state dict ...
Epoch: 2 cost time: 0.2630617618560791
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2894014 Best vali loss: 0.2894014
Updating learning rate to 0.00011716419456733844
Validation loss decreased (0.2894 --> 0.2834).  Saving model state dict ...
Epoch: 3 cost time: 0.2639200687408447
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2834178 Best vali loss: 0.2834178

best validation loss 0.28341783703415313

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0048736010373, 'e_layers': 2, 'learning_rate': 5.28775528e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5204199
	speed: 0.0091s/iter; left time: 10.9761s
	iters: 200, epoch: 4 | loss: 0.3989213
	speed: 0.0033s/iter; left time: 3.7203s
Updating learning rate to 6.6096941e-06
Validation loss decreased (0.2773 --> 0.2751).  Saving model state dict ...
Epoch: 4 cost time: 1.151900053024292
Epoch: 4, Steps: 262 | Train Loss: 0.4596706 Vali Loss: 0.2751327 Best vali loss: 0.2751327
	iters: 100, epoch: 5 | loss: 0.4220855
	speed: 0.0078s/iter; left time: 7.3846s
	iters: 200, epoch: 5 | loss: 0.8648176
	speed: 0.0032s/iter; left time: 2.7197s
Updating learning rate to 3.30484705e-06
Epoch: 5 cost time: 0.8957467079162598
Epoch: 5, Steps: 262 | Train Loss: 0.6434515 Vali Loss: 0.2755835 Best vali loss: 0.2751327
	iters: 100, epoch: 6 | loss: 0.4537727
	speed: 0.0081s/iter; left time: 5.5314s
	iters: 200, epoch: 6 | loss: 0.6283962
	speed: 0.0036s/iter; left time: 2.1005s
Updating learning rate to 1.652423525e-06
Epoch: 6 cost time: 0.9964368343353271
Epoch: 6, Steps: 262 | Train Loss: 0.5410845 Vali Loss: 0.2753303 Best vali loss: 0.2751327
	iters: 100, epoch: 7 | loss: 0.4787444
	speed: 0.0079s/iter; left time: 3.3593s
	iters: 200, epoch: 7 | loss: 0.6759412
	speed: 0.0033s/iter; left time: 1.0739s
Updating learning rate to 8.262117625e-07
Epoch: 7 cost time: 0.9270801544189453
Epoch: 7, Steps: 262 | Train Loss: 0.5773428 Vali Loss: 0.2754043 Best vali loss: 0.2751327
	iters: 100, epoch: 8 | loss: 0.3430369
	speed: 0.0078s/iter; left time: 1.2704s
	iters: 200, epoch: 8 | loss: 0.4150888
	speed: 0.0035s/iter; left time: 0.2227s
Updating learning rate to 4.1310588125e-07
Epoch: 8 cost time: 0.9597482681274414
Epoch: 8, Steps: 262 | Train Loss: 0.3790629 Vali Loss: 0.2754483 Best vali loss: 0.2751327

best validation loss 0.2751326952039553

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020884308533, 'e_layers': 3, 'learning_rate': 0.0004689093915, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4643919
	speed: 0.0108s/iter; left time: 21.5005s
	iters: 200, epoch: 1 | loss: 0.6416150
	speed: 0.0054s/iter; left time: 10.1892s
Updating learning rate to 0.00045106259045458595
Validation loss decreased (inf --> 0.3096).  Saving model state dict ...
Epoch: 1 cost time: 1.6922881603240967
Epoch: 1, Steps: 262 | Train Loss: 0.5530035 Vali Loss: 0.3095531 Best vali loss: 0.3095531
	iters: 100, epoch: 2 | loss: 0.6863594
	speed: 0.0123s/iter; left time: 21.4191s
	iters: 200, epoch: 2 | loss: 0.3271633
	speed: 0.0055s/iter; left time: 8.9267s
Updating learning rate to 0.0004002392009958538
Validation loss decreased (0.3096 --> 0.2995).  Saving model state dict ...
Epoch: 2 cost time: 1.4915502071380615
Epoch: 2, Steps: 262 | Train Loss: 0.5067614 Vali Loss: 0.2995056 Best vali loss: 0.2995056
	iters: 100, epoch: 3 | loss: 0.4743196
	speed: 0.0126s/iter; left time: 18.5164s
	iters: 200, epoch: 3 | loss: 0.5549566
	speed: 0.0056s/iter; left time: 7.6238s
Updating learning rate to 0.00032417662345372286
Validation loss decreased (0.2995 --> 0.2902).  Saving model state dict ...
Epoch: 3 cost time: 1.4929981231689453
Epoch: 3, Steps: 262 | Train Loss: 0.5146381 Vali Loss: 0.2902227 Best vali loss: 0.2902227
	iters: 100, epoch: 4 | loss: 0.9556327
	speed: 0.0124s/iter; left time: 14.9615s
	iters: 200, epoch: 4 | loss: 0.4650626
	speed: 0.0054s/iter; left time: 5.9967s
Updating learning rate to 0.00023445469575
Epoch: 4 cost time: 1.4484798908233643
Epoch: 4, Steps: 262 | Train Loss: 0.7103477 Vali Loss: 0.2976467 Best vali loss: 0.2902227
	iters: 100, epoch: 5 | loss: 0.4317768
	speed: 0.0118s/iter; left time: 11.2125s
	iters: 200, epoch: 5 | loss: 0.6033720
	speed: 0.0054s/iter; left time: 4.5960s
Updating learning rate to 0.0001447327680462772
Epoch: 5 cost time: 1.4543101787567139
Epoch: 5, Steps: 262 | Train Loss: 0.5175744 Vali Loss: 0.3034842 Best vali loss: 0.2902227
	iters: 100, epoch: 6 | loss: 0.5752817
	speed: 0.0118s/iter; left time: 8.1129s
	iters: 200, epoch: 6 | loss: 0.9740434
	speed: 0.0055s/iter; left time: 3.2306s
Updating learning rate to 6.86701905041462e-05
Epoch: 6 cost time: 1.4904239177703857
Epoch: 6, Steps: 262 | Train Loss: 0.7746626 Vali Loss: 0.3006871 Best vali loss: 0.2902227
	iters: 100, epoch: 7 | loss: 0.3160431
	speed: 0.0121s/iter; left time: 5.1602s
	iters: 200, epoch: 7 | loss: 0.2238012
	speed: 0.0055s/iter; left time: 1.7863s
Updating learning rate to 1.7846801045414033e-05
Epoch: 7 cost time: 1.477832555770874
Epoch: 7, Steps: 262 | Train Loss: 0.2699221 Vali Loss: 0.3023158 Best vali loss: 0.2902227
	iters: 100, epoch: 8 | loss: 0.3350511
	speed: 0.0117s/iter; left time: 1.9131s
	iters: 200, epoch: 8 | loss: 0.3139952
	speed: 0.0054s/iter; left time: 0.3398s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4509689807891846
Epoch: 8, Steps: 262 | Train Loss: 0.3245232 Vali Loss: 0.3012997 Best vali loss: 0.2902227

best validation loss 0.29022272799528415

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0062339040585, 'e_layers': 1, 'learning_rate': 0.0034664338283, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003334500546535557
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 0.49039793014526367
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2832037 Best vali loss: 0.2832037
Updating learning rate to 0.002958786347412687
Epoch: 2 cost time: 0.2657132148742676
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2955204 Best vali loss: 0.2832037
Updating learning rate to 0.002396490311890151
Epoch: 3 cost time: 0.29053378105163574
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2893436 Best vali loss: 0.2832037
Updating learning rate to 0.00173321691415
Epoch: 4 cost time: 0.2760157585144043
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3085793 Best vali loss: 0.2832037
Updating learning rate to 0.001069943516409849
Epoch: 5 cost time: 0.2832615375518799
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3084106 Best vali loss: 0.2832037
Updating learning rate to 0.0005076474808873129
Epoch: 6 cost time: 0.27330493927001953
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3095955 Best vali loss: 0.2832037
Updating learning rate to 0.000131933281764443
Epoch: 7 cost time: 0.27336907386779785
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3101516 Best vali loss: 0.2832037
Updating learning rate to 0.0
Epoch: 8 cost time: 0.2689783573150635
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3083531 Best vali loss: 0.2832037

best validation loss 0.28320369431135956

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0107909460093, 'e_layers': 3, 'learning_rate': 0.0002210285999, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1134619
	speed: 0.0092s/iter; left time: 18.3224s
	iters: 200, epoch: 1 | loss: 0.6911094
	speed: 0.0043s/iter; left time: 8.1647s
Updating learning rate to 0.0002210285999
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 1.417757511138916
Epoch: 1, Steps: 262 | Train Loss: 0.9022856 Vali Loss: 0.2792662 Best vali loss: 0.2792662
	iters: 100, epoch: 2 | loss: 0.8403865
	speed: 0.0096s/iter; left time: 16.7339s
	iters: 200, epoch: 2 | loss: 0.4027002
	speed: 0.0043s/iter; left time: 7.0605s
Updating learning rate to 0.00011051429995
Validation loss decreased (0.2793 --> 0.2740).  Saving model state dict ...
Epoch: 2 cost time: 1.1835353374481201
Epoch: 2, Steps: 262 | Train Loss: 0.6215433 Vali Loss: 0.2739667 Best vali loss: 0.2739667
	iters: 100, epoch: 3 | loss: 0.5070292
	speed: 0.0097s/iter; left time: 14.3527s
	iters: 200, epoch: 3 | loss: 0.5468623
	speed: 0.0043s/iter; left time: 5.9696s
Updating learning rate to 5.5257149975e-05
Epoch: 3 cost time: 1.1809825897216797
Epoch: 3, Steps: 262 | Train Loss: 0.5269458 Vali Loss: 0.2905427 Best vali loss: 0.2739667

best validation loss 0.2739666772292156

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0077289967039, 'e_layers': 2, 'learning_rate': 0.0002868749682, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7229555
	speed: 0.0084s/iter; left time: 16.7135s
	iters: 200, epoch: 1 | loss: 0.5352176
	speed: 0.0035s/iter; left time: 6.5572s
Updating learning rate to 0.0002759564398549031
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 1.1939635276794434
Epoch: 1, Steps: 262 | Train Loss: 0.6290865 Vali Loss: 0.2832051 Best vali loss: 0.2832051
	iters: 100, epoch: 2 | loss: 0.5811785
	speed: 0.0081s/iter; left time: 14.0311s
	iters: 200, epoch: 2 | loss: 0.7579030
	speed: 0.0035s/iter; left time: 5.6650s
Updating learning rate to 0.00024486310178344756
Validation loss decreased (0.2832 --> 0.2785).  Saving model state dict ...
Epoch: 2 cost time: 0.9683828353881836
Epoch: 2, Steps: 262 | Train Loss: 0.6695408 Vali Loss: 0.2784983 Best vali loss: 0.2784983
	iters: 100, epoch: 3 | loss: 0.6120423
	speed: 0.0082s/iter; left time: 12.0324s
	iters: 200, epoch: 3 | loss: 0.5690023
	speed: 0.0037s/iter; left time: 5.0117s
Updating learning rate to 0.000198328632845201
Epoch: 3 cost time: 0.9997541904449463
Epoch: 3, Steps: 262 | Train Loss: 0.5905223 Vali Loss: 0.2996840 Best vali loss: 0.2784983

best validation loss 0.27849831949405485

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0016708494967, 'e_layers': 1, 'learning_rate': 0.0043404014684, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6760647
	speed: 0.0070s/iter; left time: 28.7536s
	iters: 200, epoch: 1 | loss: 0.8159987
	speed: 0.0023s/iter; left time: 9.1897s
	iters: 300, epoch: 1 | loss: 0.4665882
	speed: 0.0023s/iter; left time: 8.9727s
	iters: 400, epoch: 1 | loss: 1.1107970
	speed: 0.0023s/iter; left time: 8.7357s
	iters: 500, epoch: 1 | loss: 0.3131339
	speed: 0.0025s/iter; left time: 9.0551s
Updating learning rate to 0.0043404014684
Validation loss decreased (inf --> 0.3137).  Saving model state dict ...
Epoch: 1 cost time: 1.4949135780334473
Epoch: 1, Steps: 523 | Train Loss: 0.6765165 Vali Loss: 0.3137313 Best vali loss: 0.3137313
	iters: 100, epoch: 2 | loss: 0.3188528
	speed: 0.0059s/iter; left time: 20.8908s
	iters: 200, epoch: 2 | loss: 0.6723535
	speed: 0.0025s/iter; left time: 8.7445s
	iters: 300, epoch: 2 | loss: 0.6078799
	speed: 0.0027s/iter; left time: 9.0626s
	iters: 400, epoch: 2 | loss: 1.7545036
	speed: 0.0026s/iter; left time: 8.4053s
	iters: 500, epoch: 2 | loss: 0.3757616
	speed: 0.0026s/iter; left time: 8.1898s
Updating learning rate to 0.0021702007342
Epoch: 2 cost time: 1.3864109516143799
Epoch: 2, Steps: 523 | Train Loss: 0.7458703 Vali Loss: 0.3378227 Best vali loss: 0.3137313
	iters: 100, epoch: 3 | loss: 0.2697462
	speed: 0.0056s/iter; left time: 17.0173s
	iters: 200, epoch: 3 | loss: 0.8886009
	speed: 0.0023s/iter; left time: 6.6412s
	iters: 300, epoch: 3 | loss: 0.3480209
	speed: 0.0023s/iter; left time: 6.3981s
	iters: 400, epoch: 3 | loss: 0.2117284
	speed: 0.0023s/iter; left time: 6.2114s
	iters: 500, epoch: 3 | loss: 0.5855616
	speed: 0.0023s/iter; left time: 6.1277s
Updating learning rate to 0.0010851003671
Validation loss decreased (0.3137 --> 0.2924).  Saving model state dict ...
Epoch: 3 cost time: 1.2303903102874756
Epoch: 3, Steps: 523 | Train Loss: 0.4607316 Vali Loss: 0.2923709 Best vali loss: 0.2923709

best validation loss 0.29237090042861874

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0107909460093, 'e_layers': 3, 'learning_rate': 0.0002210285999, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7132484
	speed: 0.0094s/iter; left time: 11.3478s
	iters: 200, epoch: 4 | loss: 0.4636149
	speed: 0.0045s/iter; left time: 4.9734s
Updating learning rate to 2.76285749875e-05
Epoch: 4 cost time: 1.4275827407836914
Epoch: 4, Steps: 262 | Train Loss: 0.5884317 Vali Loss: 0.2799842 Best vali loss: 0.2739667
	iters: 100, epoch: 5 | loss: 0.6085259
	speed: 0.0093s/iter; left time: 8.8385s
	iters: 200, epoch: 5 | loss: 0.3454610
	speed: 0.0044s/iter; left time: 3.7252s
Updating learning rate to 1.381428749375e-05
Epoch: 5 cost time: 1.1794393062591553
Epoch: 5, Steps: 262 | Train Loss: 0.4769934 Vali Loss: 0.2863111 Best vali loss: 0.2739667
	iters: 100, epoch: 6 | loss: 0.4234037
	speed: 0.0095s/iter; left time: 6.5419s
	iters: 200, epoch: 6 | loss: 0.4583924
	speed: 0.0045s/iter; left time: 2.6435s
Updating learning rate to 6.907143746875e-06
Epoch: 6 cost time: 1.2134284973144531
Epoch: 6, Steps: 262 | Train Loss: 0.4408981 Vali Loss: 0.2902404 Best vali loss: 0.2739667
	iters: 100, epoch: 7 | loss: 0.5842838
	speed: 0.0095s/iter; left time: 4.0470s
	iters: 200, epoch: 7 | loss: 0.3401953
	speed: 0.0041s/iter; left time: 1.3357s
Updating learning rate to 3.4535718734375e-06
Epoch: 7 cost time: 1.161407709121704
Epoch: 7, Steps: 262 | Train Loss: 0.4622395 Vali Loss: 0.2917607 Best vali loss: 0.2739667
	iters: 100, epoch: 8 | loss: 0.3117554
	speed: 0.0094s/iter; left time: 1.5298s
	iters: 200, epoch: 8 | loss: 0.3205566
	speed: 0.0044s/iter; left time: 0.2765s
Updating learning rate to 1.72678593671875e-06
Epoch: 8 cost time: 1.1608710289001465
Epoch: 8, Steps: 262 | Train Loss: 0.3161560 Vali Loss: 0.2897880 Best vali loss: 0.2739667

best validation loss 0.2739666772292156

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0019991654988, 'e_layers': 1, 'learning_rate': 0.0010475007571, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4408504
	speed: 0.0077s/iter; left time: 7.2764s
Updating learning rate to 0.0010475007571
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 0.6578264236450195
Epoch: 1, Steps: 131 | Train Loss: 0.4408504 Vali Loss: 0.2820938 Best vali loss: 0.2820938
	iters: 100, epoch: 2 | loss: 0.8691888
	speed: 0.0054s/iter; left time: 4.4498s
Updating learning rate to 0.00052375037855
Validation loss decreased (0.2821 --> 0.2820).  Saving model state dict ...
Epoch: 2 cost time: 0.41811633110046387
Epoch: 2, Steps: 131 | Train Loss: 0.8691888 Vali Loss: 0.2819640 Best vali loss: 0.2819640
	iters: 100, epoch: 3 | loss: 0.6330298
	speed: 0.0053s/iter; left time: 3.6267s
Updating learning rate to 0.000261875189275
Epoch: 3 cost time: 0.40316176414489746
Epoch: 3, Steps: 131 | Train Loss: 0.6330298 Vali Loss: 0.2897961 Best vali loss: 0.2819640
	iters: 100, epoch: 4 | loss: 0.6707374
	speed: 0.0054s/iter; left time: 2.9961s
Updating learning rate to 0.0001309375946375
Epoch: 4 cost time: 0.40996408462524414
Epoch: 4, Steps: 131 | Train Loss: 0.6707374 Vali Loss: 0.2967941 Best vali loss: 0.2819640
	iters: 100, epoch: 5 | loss: 0.4057854
	speed: 0.0054s/iter; left time: 2.2744s
Updating learning rate to 6.546879731875e-05
Epoch: 5 cost time: 0.4120805263519287
Epoch: 5, Steps: 131 | Train Loss: 0.4057854 Vali Loss: 0.2894333 Best vali loss: 0.2819640
	iters: 100, epoch: 6 | loss: 0.2297744
	speed: 0.0055s/iter; left time: 1.6269s
Updating learning rate to 3.2734398659375e-05
Epoch: 6 cost time: 0.4235537052154541
Epoch: 6, Steps: 131 | Train Loss: 0.2297744 Vali Loss: 0.2909309 Best vali loss: 0.2819640
	iters: 100, epoch: 7 | loss: 0.3284883
	speed: 0.0051s/iter; left time: 0.8300s
Updating learning rate to 1.63671993296875e-05
Epoch: 7 cost time: 0.3836996555328369
Epoch: 7, Steps: 131 | Train Loss: 0.3284883 Vali Loss: 0.2916586 Best vali loss: 0.2819640
	iters: 100, epoch: 8 | loss: 0.4520336
	speed: 0.0054s/iter; left time: 0.1731s
Updating learning rate to 8.18359966484375e-06
Epoch: 8 cost time: 0.43549394607543945
Epoch: 8, Steps: 131 | Train Loss: 0.4520336 Vali Loss: 0.2921188 Best vali loss: 0.2819640

best validation loss 0.2819640365131019

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0043903654508, 'e_layers': 3, 'learning_rate': 0.0001023242601, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9312540
	speed: 0.0090s/iter; left time: 36.6793s
	iters: 200, epoch: 1 | loss: 0.4479349
	speed: 0.0041s/iter; left time: 16.2773s
	iters: 300, epoch: 1 | loss: 0.3633824
	speed: 0.0041s/iter; left time: 15.7594s
	iters: 400, epoch: 1 | loss: 0.5900260
	speed: 0.0041s/iter; left time: 15.4279s
	iters: 500, epoch: 1 | loss: 0.9975622
	speed: 0.0040s/iter; left time: 14.8723s
Updating learning rate to 9.842977484287565e-05
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 2.4238836765289307
Epoch: 1, Steps: 523 | Train Loss: 0.6660319 Vali Loss: 0.2822072 Best vali loss: 0.2822072
	iters: 100, epoch: 2 | loss: 0.3293548
	speed: 0.0083s/iter; left time: 29.5929s
	iters: 200, epoch: 2 | loss: 0.5718639
	speed: 0.0037s/iter; left time: 12.9617s
	iters: 300, epoch: 2 | loss: 0.6986771
	speed: 0.0037s/iter; left time: 12.4736s
	iters: 400, epoch: 2 | loss: 0.7835506
	speed: 0.0037s/iter; left time: 12.0979s
	iters: 500, epoch: 2 | loss: 0.5449753
	speed: 0.0037s/iter; left time: 11.8555s
Updating learning rate to 8.733921914830303e-05
Validation loss decreased (0.2822 --> 0.2790).  Saving model state dict ...
Epoch: 2 cost time: 1.9932868480682373
Epoch: 2, Steps: 523 | Train Loss: 0.5856843 Vali Loss: 0.2789565 Best vali loss: 0.2789565
	iters: 100, epoch: 3 | loss: 0.3541873
	speed: 0.0089s/iter; left time: 27.1101s
	iters: 200, epoch: 3 | loss: 0.4716793
	speed: 0.0045s/iter; left time: 13.1749s
	iters: 300, epoch: 3 | loss: 0.5234195
	speed: 0.0045s/iter; left time: 12.7882s
	iters: 400, epoch: 3 | loss: 0.4610489
	speed: 0.0045s/iter; left time: 12.2646s
	iters: 500, epoch: 3 | loss: 0.4159508
	speed: 0.0045s/iter; left time: 11.7818s
Updating learning rate to 7.07410295846431e-05
Epoch: 3 cost time: 2.392049551010132
Epoch: 3, Steps: 523 | Train Loss: 0.4452572 Vali Loss: 0.2791619 Best vali loss: 0.2789565
	iters: 100, epoch: 4 | loss: 0.2201004
	speed: 0.0084s/iter; left time: 21.1942s
	iters: 200, epoch: 4 | loss: 0.7955310
	speed: 0.0040s/iter; left time: 9.5765s
	iters: 300, epoch: 4 | loss: 0.2792866
	speed: 0.0040s/iter; left time: 9.2123s
	iters: 400, epoch: 4 | loss: 0.3221622
	speed: 0.0040s/iter; left time: 8.7914s
	iters: 500, epoch: 4 | loss: 0.2420469
	speed: 0.0039s/iter; left time: 8.3012s
Updating learning rate to 5.116213005e-05
Epoch: 4 cost time: 2.1041059494018555
Epoch: 4, Steps: 523 | Train Loss: 0.3718254 Vali Loss: 0.2820253 Best vali loss: 0.2789565
	iters: 100, epoch: 5 | loss: 0.4218684
	speed: 0.0084s/iter; left time: 16.7026s
	iters: 200, epoch: 5 | loss: 0.1933220
	speed: 0.0037s/iter; left time: 7.0937s
	iters: 300, epoch: 5 | loss: 0.4720616
	speed: 0.0038s/iter; left time: 6.7939s
	iters: 400, epoch: 5 | loss: 0.1779133
	speed: 0.0037s/iter; left time: 6.3349s
	iters: 500, epoch: 5 | loss: 0.9159256
	speed: 0.0037s/iter; left time: 5.9466s
Updating learning rate to 3.15832305153569e-05
Epoch: 5 cost time: 2.0142996311187744
Epoch: 5, Steps: 523 | Train Loss: 0.4362182 Vali Loss: 0.2860177 Best vali loss: 0.2789565
	iters: 100, epoch: 6 | loss: 0.4259951
	speed: 0.0083s/iter; left time: 12.2024s
	iters: 200, epoch: 6 | loss: 0.4611164
	speed: 0.0040s/iter; left time: 5.5207s
	iters: 300, epoch: 6 | loss: 0.2759732
	speed: 0.0040s/iter; left time: 5.1178s
	iters: 400, epoch: 6 | loss: 0.4036739
	speed: 0.0040s/iter; left time: 4.7050s
	iters: 500, epoch: 6 | loss: 0.3282275
	speed: 0.0040s/iter; left time: 4.3002s
Updating learning rate to 1.4985040951696965e-05
Epoch: 6 cost time: 2.14388370513916
Epoch: 6, Steps: 523 | Train Loss: 0.3789973 Vali Loss: 0.2931103 Best vali loss: 0.2789565
	iters: 100, epoch: 7 | loss: 0.4136880
	speed: 0.0084s/iter; left time: 7.9754s
	iters: 200, epoch: 7 | loss: 0.4728771
	speed: 0.0041s/iter; left time: 3.4886s
	iters: 300, epoch: 7 | loss: 0.7124729
	speed: 0.0041s/iter; left time: 3.0484s
	iters: 400, epoch: 7 | loss: 0.3451152
	speed: 0.0045s/iter; left time: 2.9023s
	iters: 500, epoch: 7 | loss: 0.3200469
	speed: 0.0045s/iter; left time: 2.4852s
Updating learning rate to 3.894485257124345e-06
Epoch: 7 cost time: 2.27555251121521
Epoch: 7, Steps: 523 | Train Loss: 0.4528400 Vali Loss: 0.2978986 Best vali loss: 0.2789565
	iters: 100, epoch: 8 | loss: 0.2717841
	speed: 0.0088s/iter; left time: 3.7442s
	iters: 200, epoch: 8 | loss: 0.2965208
	speed: 0.0044s/iter; left time: 1.4288s
	iters: 300, epoch: 8 | loss: 0.3265941
	speed: 0.0045s/iter; left time: 1.0100s
	iters: 400, epoch: 8 | loss: 0.5533264
	speed: 0.0045s/iter; left time: 0.5519s
	iters: 500, epoch: 8 | loss: 0.5827224
	speed: 0.0044s/iter; left time: 0.1053s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3456437587738037
Epoch: 8, Steps: 523 | Train Loss: 0.4061895 Vali Loss: 0.2945236 Best vali loss: 0.2789565

best validation loss 0.278956476231852

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0036884798213, 'e_layers': 2, 'learning_rate': 0.0021129771773, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3734310
	speed: 0.0076s/iter; left time: 63.1638s
	iters: 200, epoch: 1 | loss: 0.8854591
	speed: 0.0033s/iter; left time: 27.1117s
	iters: 300, epoch: 1 | loss: 0.4209933
	speed: 0.0031s/iter; left time: 25.1233s
	iters: 400, epoch: 1 | loss: 0.1427501
	speed: 0.0031s/iter; left time: 24.7964s
	iters: 500, epoch: 1 | loss: 0.3788263
	speed: 0.0033s/iter; left time: 25.7955s
	iters: 600, epoch: 1 | loss: 0.3059219
	speed: 0.0033s/iter; left time: 25.3240s
	iters: 700, epoch: 1 | loss: 0.1955927
	speed: 0.0034s/iter; left time: 25.8409s
	iters: 800, epoch: 1 | loss: 0.4889878
	speed: 0.0033s/iter; left time: 24.6543s
	iters: 900, epoch: 1 | loss: 0.4016179
	speed: 0.0033s/iter; left time: 24.5290s
	iters: 1000, epoch: 1 | loss: 1.0160010
	speed: 0.0033s/iter; left time: 24.0806s
Updating learning rate to 0.002032556772035471
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 3.6460485458374023
Epoch: 1, Steps: 1045 | Train Loss: 0.4609581 Vali Loss: 0.2834217 Best vali loss: 0.2834217
	iters: 100, epoch: 2 | loss: 0.1951130
	speed: 0.0102s/iter; left time: 73.3602s
	iters: 200, epoch: 2 | loss: 0.9335386
	speed: 0.0032s/iter; left time: 22.6659s
	iters: 300, epoch: 2 | loss: 0.4415587
	speed: 0.0032s/iter; left time: 22.4113s
	iters: 400, epoch: 2 | loss: 0.1752545
	speed: 0.0033s/iter; left time: 22.8452s
	iters: 500, epoch: 2 | loss: 0.4180119
	speed: 0.0032s/iter; left time: 21.9127s
	iters: 600, epoch: 2 | loss: 0.2572880
	speed: 0.0032s/iter; left time: 21.7561s
	iters: 700, epoch: 2 | loss: 0.3284038
	speed: 0.0033s/iter; left time: 21.8637s
	iters: 800, epoch: 2 | loss: 0.2224659
	speed: 0.0033s/iter; left time: 21.2227s
	iters: 900, epoch: 2 | loss: 0.2065864
	speed: 0.0032s/iter; left time: 20.6095s
	iters: 1000, epoch: 2 | loss: 0.2936012
	speed: 0.0032s/iter; left time: 20.4225s
Updating learning rate to 0.00180353883393062
Epoch: 2 cost time: 3.4196243286132812
Epoch: 2, Steps: 1045 | Train Loss: 0.3471822 Vali Loss: 0.2883432 Best vali loss: 0.2834217
	iters: 100, epoch: 3 | loss: 0.3921168
	speed: 0.0098s/iter; left time: 60.3609s
	iters: 200, epoch: 3 | loss: 0.4255019
	speed: 0.0032s/iter; left time: 19.3735s
	iters: 300, epoch: 3 | loss: 1.0609549
	speed: 0.0032s/iter; left time: 18.8738s
	iters: 400, epoch: 3 | loss: 0.5939039
	speed: 0.0032s/iter; left time: 18.9375s
	iters: 500, epoch: 3 | loss: 0.3395019
	speed: 0.0031s/iter; left time: 17.9194s
	iters: 600, epoch: 3 | loss: 0.3054729
	speed: 0.0030s/iter; left time: 16.9574s
	iters: 700, epoch: 3 | loss: 1.2498000
	speed: 0.0030s/iter; left time: 16.7124s
	iters: 800, epoch: 3 | loss: 1.6064838
	speed: 0.0031s/iter; left time: 16.7019s
	iters: 900, epoch: 3 | loss: 1.1540053
	speed: 0.0031s/iter; left time: 16.7213s
	iters: 1000, epoch: 3 | loss: 0.7902828
	speed: 0.0031s/iter; left time: 16.1589s
Updating learning rate to 0.0014607892680091315
Epoch: 3 cost time: 3.2801480293273926
Epoch: 3, Steps: 1045 | Train Loss: 0.7918024 Vali Loss: 0.2872662 Best vali loss: 0.2834217

best validation loss 0.28342165178129247

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020134647764, 'e_layers': 2, 'learning_rate': 0.0010890279531, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010890279531
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 0.662015438079834
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2859626 Best vali loss: 0.2859626
Updating learning rate to 0.00054451397655
Epoch: 2 cost time: 0.437638521194458
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2872469 Best vali loss: 0.2859626
Updating learning rate to 0.000272256988275
Validation loss decreased (0.2860 --> 0.2857).  Saving model state dict ...
Epoch: 3 cost time: 0.4296908378601074
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2856564 Best vali loss: 0.2856564

best validation loss 0.28565635413275015

[INFO][smbo.py:320] Finished 1100 trials.
{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0020742059008, 'e_layers': 2, 'learning_rate': 0.0005005330104, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00048148260702740955
Validation loss decreased (inf --> 0.2863).  Saving model state dict ...
Epoch: 1 cost time: 0.8231244087219238
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2863494 Best vali loss: 0.2863494
Updating learning rate to 0.00042723164813077835
Validation loss decreased (0.2863 --> 0.2784).  Saving model state dict ...
Epoch: 2 cost time: 0.7617604732513428
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2784443 Best vali loss: 0.2784443
Updating learning rate to 0.00034603935041595165
Epoch: 3 cost time: 0.5925190448760986
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2799729 Best vali loss: 0.2784443

best validation loss 0.278444321902989

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0020742059008, 'e_layers': 2, 'learning_rate': 0.0005005330104, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002502665052
Epoch: 4 cost time: 0.8147943019866943
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2840307 Best vali loss: 0.2784443
Updating learning rate to 0.00015449365998404844
Validation loss decreased (0.2784 --> 0.2743).  Saving model state dict ...
Epoch: 5 cost time: 0.5915689468383789
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2742734 Best vali loss: 0.2742734
Updating learning rate to 7.330136226922167e-05
Epoch: 6 cost time: 0.5889899730682373
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845912 Best vali loss: 0.2742734
Updating learning rate to 1.905040337259049e-05
Epoch: 7 cost time: 0.5902800559997559
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2820501 Best vali loss: 0.2742734
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5920765399932861
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2861789 Best vali loss: 0.2742734

best validation loss 0.2742733741258768

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0020830026669, 'e_layers': 2, 'learning_rate': 0.000501237831, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5684834
	speed: 0.0102s/iter; left time: 9.7028s
Updating learning rate to 0.0004821606019906257
Validation loss decreased (inf --> 0.2906).  Saving model state dict ...
Epoch: 1 cost time: 0.988619327545166
Epoch: 1, Steps: 131 | Train Loss: 0.5684834 Vali Loss: 0.2905779 Best vali loss: 0.2905779
	iters: 100, epoch: 2 | loss: 0.6091155
	speed: 0.0095s/iter; left time: 7.7403s
Updating learning rate to 0.00042783325014366833
Validation loss decreased (0.2906 --> 0.2823).  Saving model state dict ...
Epoch: 2 cost time: 0.7585399150848389
Epoch: 2, Steps: 131 | Train Loss: 0.6091155 Vali Loss: 0.2823041 Best vali loss: 0.2823041
	iters: 100, epoch: 3 | loss: 0.4276520
	speed: 0.0096s/iter; left time: 6.6271s
Updating learning rate to 0.00034652662229915643
Epoch: 3 cost time: 0.7626047134399414
Epoch: 3, Steps: 131 | Train Loss: 0.4276520 Vali Loss: 0.2887711 Best vali loss: 0.2823041
	iters: 100, epoch: 4 | loss: 0.3662244
	speed: 0.0092s/iter; left time: 5.1304s
Updating learning rate to 0.0002506189155
Epoch: 4 cost time: 0.7537438869476318
Epoch: 4, Steps: 131 | Train Loss: 0.3662244 Vali Loss: 0.2911519 Best vali loss: 0.2823041
	iters: 100, epoch: 5 | loss: 0.6143652
	speed: 0.0093s/iter; left time: 3.9660s
Updating learning rate to 0.0001547112087008436
Epoch: 5 cost time: 0.7595465183258057
Epoch: 5, Steps: 131 | Train Loss: 0.6143652 Vali Loss: 0.2976643 Best vali loss: 0.2823041
	iters: 100, epoch: 6 | loss: 0.3066869
	speed: 0.0093s/iter; left time: 2.7289s
Updating learning rate to 7.340458085633168e-05
Epoch: 6 cost time: 0.7593502998352051
Epoch: 6, Steps: 131 | Train Loss: 0.3066869 Vali Loss: 0.3023966 Best vali loss: 0.2823041
	iters: 100, epoch: 7 | loss: 0.2460756
	speed: 0.0092s/iter; left time: 1.5043s
Updating learning rate to 1.9077229009374327e-05
Epoch: 7 cost time: 0.7562980651855469
Epoch: 7, Steps: 131 | Train Loss: 0.2460756 Vali Loss: 0.3058219 Best vali loss: 0.2823041
	iters: 100, epoch: 8 | loss: 0.2620472
	speed: 0.0093s/iter; left time: 0.2970s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7609176635742188
Epoch: 8, Steps: 131 | Train Loss: 0.2620472 Vali Loss: 0.3046022 Best vali loss: 0.2823041

best validation loss 0.28230406910834943

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0031341053641, 'e_layers': 2, 'learning_rate': 0.0013086285564, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3267066
	speed: 0.0089s/iter; left time: 36.2603s
	iters: 200, epoch: 1 | loss: 1.0475662
	speed: 0.0035s/iter; left time: 13.7597s
	iters: 300, epoch: 1 | loss: 0.6673295
	speed: 0.0034s/iter; left time: 13.2364s
	iters: 400, epoch: 1 | loss: 0.3600038
	speed: 0.0034s/iter; left time: 12.9060s
	iters: 500, epoch: 1 | loss: 0.3900408
	speed: 0.0035s/iter; left time: 12.8421s
Updating learning rate to 0.0013086285564
Validation loss decreased (inf --> 0.2889).  Saving model state dict ...
Epoch: 1 cost time: 2.0693891048431396
Epoch: 1, Steps: 523 | Train Loss: 0.5583294 Vali Loss: 0.2889275 Best vali loss: 0.2889275
	iters: 100, epoch: 2 | loss: 1.1404581
	speed: 0.0070s/iter; left time: 24.9455s
	iters: 200, epoch: 2 | loss: 0.7002866
	speed: 0.0029s/iter; left time: 10.0873s
	iters: 300, epoch: 2 | loss: 0.2169406
	speed: 0.0029s/iter; left time: 9.8738s
	iters: 400, epoch: 2 | loss: 0.4923623
	speed: 0.0030s/iter; left time: 9.7759s
	iters: 500, epoch: 2 | loss: 0.9418476
	speed: 0.0030s/iter; left time: 9.4886s
Updating learning rate to 0.0006543142782
Validation loss decreased (0.2889 --> 0.2882).  Saving model state dict ...
Epoch: 2 cost time: 1.5904171466827393
Epoch: 2, Steps: 523 | Train Loss: 0.6983790 Vali Loss: 0.2881852 Best vali loss: 0.2881852
	iters: 100, epoch: 3 | loss: 0.3234026
	speed: 0.0072s/iter; left time: 21.9711s
	iters: 200, epoch: 3 | loss: 0.5382923
	speed: 0.0035s/iter; left time: 10.2137s
	iters: 300, epoch: 3 | loss: 0.4589106
	speed: 0.0035s/iter; left time: 9.8043s
	iters: 400, epoch: 3 | loss: 1.1187065
	speed: 0.0035s/iter; left time: 9.5486s
	iters: 500, epoch: 3 | loss: 0.3507878
	speed: 0.0035s/iter; left time: 9.1463s
Updating learning rate to 0.0003271571391
Validation loss decreased (0.2882 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 1.8534891605377197
Epoch: 3, Steps: 523 | Train Loss: 0.5580200 Vali Loss: 0.2836468 Best vali loss: 0.2836468
	iters: 100, epoch: 4 | loss: 0.4266652
	speed: 0.0074s/iter; left time: 18.6796s
	iters: 200, epoch: 4 | loss: 0.3412147
	speed: 0.0034s/iter; left time: 8.2157s
	iters: 300, epoch: 4 | loss: 0.7392253
	speed: 0.0034s/iter; left time: 7.9074s
	iters: 400, epoch: 4 | loss: 0.4446356
	speed: 0.0034s/iter; left time: 7.5739s
	iters: 500, epoch: 4 | loss: 0.2829552
	speed: 0.0034s/iter; left time: 7.1806s
Updating learning rate to 0.00016357856955
Epoch: 4 cost time: 1.8288297653198242
Epoch: 4, Steps: 523 | Train Loss: 0.4469392 Vali Loss: 0.2863015 Best vali loss: 0.2836468
	iters: 100, epoch: 5 | loss: 0.6369697
	speed: 0.0068s/iter; left time: 13.5993s
	iters: 200, epoch: 5 | loss: 0.4552090
	speed: 0.0029s/iter; left time: 5.5063s
	iters: 300, epoch: 5 | loss: 0.2682351
	speed: 0.0029s/iter; left time: 5.2022s
	iters: 400, epoch: 5 | loss: 0.2933094
	speed: 0.0030s/iter; left time: 5.0437s
	iters: 500, epoch: 5 | loss: 0.5659242
	speed: 0.0029s/iter; left time: 4.6579s
Updating learning rate to 8.1789284775e-05
Epoch: 5 cost time: 1.5667762756347656
Epoch: 5, Steps: 523 | Train Loss: 0.4439295 Vali Loss: 0.2998830 Best vali loss: 0.2836468
	iters: 100, epoch: 6 | loss: 0.2869951
	speed: 0.0068s/iter; left time: 9.9540s
	iters: 200, epoch: 6 | loss: 0.2591015
	speed: 0.0031s/iter; left time: 4.2404s
	iters: 300, epoch: 6 | loss: 0.3367181
	speed: 0.0030s/iter; left time: 3.8708s
	iters: 400, epoch: 6 | loss: 0.5903668
	speed: 0.0030s/iter; left time: 3.4761s
	iters: 500, epoch: 6 | loss: 0.3639041
	speed: 0.0031s/iter; left time: 3.3118s
Updating learning rate to 4.08946423875e-05
Epoch: 6 cost time: 1.635859489440918
Epoch: 6, Steps: 523 | Train Loss: 0.3674171 Vali Loss: 0.3088065 Best vali loss: 0.2836468
	iters: 100, epoch: 7 | loss: 0.4347583
	speed: 0.0067s/iter; left time: 6.3863s
	iters: 200, epoch: 7 | loss: 0.3480622
	speed: 0.0030s/iter; left time: 2.5368s
	iters: 300, epoch: 7 | loss: 0.3034927
	speed: 0.0030s/iter; left time: 2.2656s
	iters: 400, epoch: 7 | loss: 0.3230668
	speed: 0.0029s/iter; left time: 1.8897s
	iters: 500, epoch: 7 | loss: 0.6637857
	speed: 0.0031s/iter; left time: 1.6826s
Updating learning rate to 2.044732119375e-05
Epoch: 7 cost time: 1.6061770915985107
Epoch: 7, Steps: 523 | Train Loss: 0.4146332 Vali Loss: 0.3111546 Best vali loss: 0.2836468
	iters: 100, epoch: 8 | loss: 0.1835019
	speed: 0.0069s/iter; left time: 2.9193s
	iters: 200, epoch: 8 | loss: 0.2775518
	speed: 0.0030s/iter; left time: 0.9626s
	iters: 300, epoch: 8 | loss: 0.3826567
	speed: 0.0030s/iter; left time: 0.6700s
	iters: 400, epoch: 8 | loss: 0.2941848
	speed: 0.0030s/iter; left time: 0.3660s
	iters: 500, epoch: 8 | loss: 0.4153807
	speed: 0.0030s/iter; left time: 0.0715s
Updating learning rate to 1.0223660596875e-05
Epoch: 8 cost time: 1.5960659980773926
Epoch: 8, Steps: 523 | Train Loss: 0.3106552 Vali Loss: 0.3122760 Best vali loss: 0.2836468

best validation loss 0.2836467643881784

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0115547168461, 'e_layers': 2, 'learning_rate': 0.0001350218375, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012988287480415745
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 0.5474755764007568
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2869364 Best vali loss: 0.2869364
Updating learning rate to 0.00011524834720225903
Validation loss decreased (0.2869 --> 0.2798).  Saving model state dict ...
Epoch: 2 cost time: 0.3171672821044922
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2797962 Best vali loss: 0.2797962
Updating learning rate to 9.33462288593707e-05
Validation loss decreased (0.2798 --> 0.2797).  Saving model state dict ...
Epoch: 3 cost time: 0.31939125061035156
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2797329 Best vali loss: 0.2797329

best validation loss 0.27973288397400653

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0022664959229, 'e_layers': 4, 'learning_rate': 0.0042469532257, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6636145
	speed: 0.0103s/iter; left time: 84.7214s
	iters: 200, epoch: 1 | loss: 0.7904764
	speed: 0.0050s/iter; left time: 40.8353s
	iters: 300, epoch: 1 | loss: 0.3942422
	speed: 0.0050s/iter; left time: 40.4716s
	iters: 400, epoch: 1 | loss: 0.8444801
	speed: 0.0049s/iter; left time: 39.1374s
	iters: 500, epoch: 1 | loss: 0.4719065
	speed: 0.0047s/iter; left time: 37.2368s
	iters: 600, epoch: 1 | loss: 1.2945241
	speed: 0.0047s/iter; left time: 36.7100s
	iters: 700, epoch: 1 | loss: 0.2263552
	speed: 0.0049s/iter; left time: 37.2162s
	iters: 800, epoch: 1 | loss: 0.2203901
	speed: 0.0051s/iter; left time: 38.2076s
	iters: 900, epoch: 1 | loss: 0.3612122
	speed: 0.0050s/iter; left time: 37.6552s
	iters: 1000, epoch: 1 | loss: 0.2574911
	speed: 0.0050s/iter; left time: 36.9525s
Updating learning rate to 0.004085313193228509
Validation loss decreased (inf --> 0.3081).  Saving model state dict ...
Epoch: 1 cost time: 5.4281325340271
Epoch: 1, Steps: 1045 | Train Loss: 0.5524692 Vali Loss: 0.3080711 Best vali loss: 0.3080711
	iters: 100, epoch: 2 | loss: 0.5080248
	speed: 0.0142s/iter; left time: 102.5417s
	iters: 200, epoch: 2 | loss: 1.0891427
	speed: 0.0045s/iter; left time: 31.8564s
	iters: 300, epoch: 2 | loss: 0.2834358
	speed: 0.0048s/iter; left time: 33.3931s
	iters: 400, epoch: 2 | loss: 0.2137488
	speed: 0.0043s/iter; left time: 29.9560s
	iters: 500, epoch: 2 | loss: 0.4994064
	speed: 0.0043s/iter; left time: 29.5012s
	iters: 600, epoch: 2 | loss: 0.4311533
	speed: 0.0043s/iter; left time: 29.0104s
	iters: 700, epoch: 2 | loss: 0.2271398
	speed: 0.0044s/iter; left time: 28.8544s
	iters: 800, epoch: 2 | loss: 0.2512284
	speed: 0.0044s/iter; left time: 28.5765s
	iters: 900, epoch: 2 | loss: 0.5525585
	speed: 0.0044s/iter; left time: 28.0877s
	iters: 1000, epoch: 2 | loss: 0.6717335
	speed: 0.0044s/iter; left time: 27.5783s
Updating learning rate to 0.0036250013254872757
Epoch: 2 cost time: 4.704208850860596
Epoch: 2, Steps: 1045 | Train Loss: 0.4727572 Vali Loss: 0.3200878 Best vali loss: 0.3080711
	iters: 100, epoch: 3 | loss: 2.2937121
	speed: 0.0129s/iter; left time: 79.8512s
	iters: 200, epoch: 3 | loss: 1.1727132
	speed: 0.0048s/iter; left time: 28.8633s
	iters: 300, epoch: 3 | loss: 0.6852248
	speed: 0.0048s/iter; left time: 28.4676s
	iters: 400, epoch: 3 | loss: 1.5583656
	speed: 0.0048s/iter; left time: 28.1573s
	iters: 500, epoch: 3 | loss: 0.3445644
	speed: 0.0048s/iter; left time: 27.5869s
	iters: 600, epoch: 3 | loss: 0.3166274
	speed: 0.0047s/iter; left time: 26.5818s
	iters: 700, epoch: 3 | loss: 0.3274838
	speed: 0.0047s/iter; left time: 26.2316s
	iters: 800, epoch: 3 | loss: 0.2250193
	speed: 0.0047s/iter; left time: 25.8667s
	iters: 900, epoch: 3 | loss: 0.3963855
	speed: 0.0048s/iter; left time: 25.6282s
	iters: 1000, epoch: 3 | loss: 0.5842504
	speed: 0.0047s/iter; left time: 24.9553s
Updating learning rate to 0.002936095931602433
Validation loss decreased (0.3081 --> 0.3020).  Saving model state dict ...
Epoch: 3 cost time: 4.991598606109619
Epoch: 3, Steps: 1045 | Train Loss: 0.7904346 Vali Loss: 0.3020164 Best vali loss: 0.3020164

best validation loss 0.3020164315454044

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020539117892, 'e_layers': 3, 'learning_rate': 0.000476497838, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3195717
	speed: 0.0098s/iter; left time: 39.9880s
	iters: 200, epoch: 1 | loss: 0.9016653
	speed: 0.0042s/iter; left time: 16.9025s
	iters: 300, epoch: 1 | loss: 0.7426710
	speed: 0.0042s/iter; left time: 16.4185s
	iters: 400, epoch: 1 | loss: 0.2963602
	speed: 0.0043s/iter; left time: 16.1655s
	iters: 500, epoch: 1 | loss: 0.2760786
	speed: 0.0043s/iter; left time: 15.6665s
Updating learning rate to 0.000476497838
Validation loss decreased (inf --> 0.3113).  Saving model state dict ...
Epoch: 1 cost time: 2.5043833255767822
Epoch: 1, Steps: 523 | Train Loss: 0.5072693 Vali Loss: 0.3113025 Best vali loss: 0.3113025
	iters: 100, epoch: 2 | loss: 0.8074183
	speed: 0.0094s/iter; left time: 33.5536s
	iters: 200, epoch: 2 | loss: 0.3540848
	speed: 0.0043s/iter; left time: 14.7327s
	iters: 300, epoch: 2 | loss: 0.3075307
	speed: 0.0043s/iter; left time: 14.3188s
	iters: 400, epoch: 2 | loss: 0.6481662
	speed: 0.0043s/iter; left time: 13.8770s
	iters: 500, epoch: 2 | loss: 0.1846537
	speed: 0.0043s/iter; left time: 13.5345s
Updating learning rate to 0.000238248919
Epoch: 2 cost time: 2.269806146621704
Epoch: 2, Steps: 523 | Train Loss: 0.4603707 Vali Loss: 0.3263554 Best vali loss: 0.3113025
	iters: 100, epoch: 3 | loss: 0.9101803
	speed: 0.0091s/iter; left time: 27.6326s
	iters: 200, epoch: 3 | loss: 0.9702843
	speed: 0.0042s/iter; left time: 12.3075s
	iters: 300, epoch: 3 | loss: 1.2213671
	speed: 0.0042s/iter; left time: 11.9968s
	iters: 400, epoch: 3 | loss: 1.2493994
	speed: 0.0042s/iter; left time: 11.5708s
	iters: 500, epoch: 3 | loss: 1.0951011
	speed: 0.0042s/iter; left time: 10.9615s
Updating learning rate to 0.0001191244595
Epoch: 3 cost time: 2.2329578399658203
Epoch: 3, Steps: 523 | Train Loss: 1.0892665 Vali Loss: 0.3207579 Best vali loss: 0.3113025

best validation loss 0.3113025034967964

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0115547168461, 'e_layers': 2, 'learning_rate': 0.0001350218375, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.751091875e-05
Epoch: 4 cost time: 0.5592684745788574
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2802694 Best vali loss: 0.2797329
Updating learning rate to 4.167560864062931e-05
Validation loss decreased (0.2797 --> 0.2797).  Saving model state dict ...
Epoch: 5 cost time: 0.31253576278686523
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2797149 Best vali loss: 0.2797149
Updating learning rate to 1.9773490297740964e-05
Epoch: 6 cost time: 0.30797910690307617
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2799207 Best vali loss: 0.2797149
Updating learning rate to 5.138962695842537e-06
Validation loss decreased (0.2797 --> 0.2793).  Saving model state dict ...
Epoch: 7 cost time: 0.3113367557525635
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2793416 Best vali loss: 0.2793416
Updating learning rate to 0.0
Validation loss decreased (0.2793 --> 0.2791).  Saving model state dict ...
Epoch: 8 cost time: 0.3418583869934082
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2791252 Best vali loss: 0.2791252

best validation loss 0.27912523599972555

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.002044005178, 'e_layers': 3, 'learning_rate': 0.0004743372039, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4644350
	speed: 0.0095s/iter; left time: 38.7755s
	iters: 200, epoch: 1 | loss: 0.8794373
	speed: 0.0039s/iter; left time: 15.6323s
	iters: 300, epoch: 1 | loss: 0.5752660
	speed: 0.0040s/iter; left time: 15.4156s
	iters: 400, epoch: 1 | loss: 0.8157726
	speed: 0.0040s/iter; left time: 15.0296s
	iters: 500, epoch: 1 | loss: 0.4200081
	speed: 0.0040s/iter; left time: 14.8502s
Updating learning rate to 0.0004743372039
Validation loss decreased (inf --> 0.3039).  Saving model state dict ...
Epoch: 1 cost time: 2.3685455322265625
Epoch: 1, Steps: 523 | Train Loss: 0.6309838 Vali Loss: 0.3039385 Best vali loss: 0.3039385
	iters: 100, epoch: 2 | loss: 0.4978058
	speed: 0.0088s/iter; left time: 31.1979s
	iters: 200, epoch: 2 | loss: 0.2850523
	speed: 0.0040s/iter; left time: 13.9226s
	iters: 300, epoch: 2 | loss: 0.8161574
	speed: 0.0040s/iter; left time: 13.4783s
	iters: 400, epoch: 2 | loss: 0.4149483
	speed: 0.0040s/iter; left time: 13.0507s
	iters: 500, epoch: 2 | loss: 0.5345960
	speed: 0.0040s/iter; left time: 12.7329s
Updating learning rate to 0.00023716860195
Validation loss decreased (0.3039 --> 0.2935).  Saving model state dict ...
Epoch: 2 cost time: 2.142749547958374
Epoch: 2, Steps: 523 | Train Loss: 0.5097120 Vali Loss: 0.2935178 Best vali loss: 0.2935178
	iters: 100, epoch: 3 | loss: 0.2269387
	speed: 0.0088s/iter; left time: 26.6345s
	iters: 200, epoch: 3 | loss: 0.4145825
	speed: 0.0040s/iter; left time: 11.6406s
	iters: 300, epoch: 3 | loss: 0.2262517
	speed: 0.0041s/iter; left time: 11.5252s
	iters: 400, epoch: 3 | loss: 0.3966873
	speed: 0.0040s/iter; left time: 11.0742s
	iters: 500, epoch: 3 | loss: 0.3477552
	speed: 0.0040s/iter; left time: 10.5529s
Updating learning rate to 0.000118584300975
Validation loss decreased (0.2935 --> 0.2888).  Saving model state dict ...
Epoch: 3 cost time: 2.1314032077789307
Epoch: 3, Steps: 523 | Train Loss: 0.3224431 Vali Loss: 0.2888241 Best vali loss: 0.2888241
	iters: 100, epoch: 4 | loss: 0.6826681
	speed: 0.0091s/iter; left time: 22.9164s
	iters: 200, epoch: 4 | loss: 0.3187103
	speed: 0.0041s/iter; left time: 9.8328s
	iters: 300, epoch: 4 | loss: 0.6674001
	speed: 0.0041s/iter; left time: 9.5009s
	iters: 400, epoch: 4 | loss: 0.4953978
	speed: 0.0041s/iter; left time: 8.9925s
	iters: 500, epoch: 4 | loss: 0.2564828
	speed: 0.0041s/iter; left time: 8.6295s
Updating learning rate to 5.92921504875e-05
Validation loss decreased (0.2888 --> 0.2880).  Saving model state dict ...
Epoch: 4 cost time: 2.171095848083496
Epoch: 4, Steps: 523 | Train Loss: 0.4841318 Vali Loss: 0.2880232 Best vali loss: 0.2880232
	iters: 100, epoch: 5 | loss: 0.5840395
	speed: 0.0089s/iter; left time: 17.7670s
	iters: 200, epoch: 5 | loss: 0.3591418
	speed: 0.0044s/iter; left time: 8.3153s
	iters: 300, epoch: 5 | loss: 0.2633313
	speed: 0.0044s/iter; left time: 7.9527s
	iters: 400, epoch: 5 | loss: 0.3486145
	speed: 0.0044s/iter; left time: 7.5083s
	iters: 500, epoch: 5 | loss: 0.2378684
	speed: 0.0044s/iter; left time: 7.0755s
Updating learning rate to 2.964607524375e-05
Epoch: 5 cost time: 2.3321127891540527
Epoch: 5, Steps: 523 | Train Loss: 0.3585991 Vali Loss: 0.2911974 Best vali loss: 0.2880232
	iters: 100, epoch: 6 | loss: 0.3318319
	speed: 0.0083s/iter; left time: 12.2358s
	iters: 200, epoch: 6 | loss: 0.4772842
	speed: 0.0037s/iter; left time: 5.0953s
	iters: 300, epoch: 6 | loss: 0.3994227
	speed: 0.0037s/iter; left time: 4.7545s
	iters: 400, epoch: 6 | loss: 0.8053954
	speed: 0.0037s/iter; left time: 4.3496s
	iters: 500, epoch: 6 | loss: 0.4819814
	speed: 0.0037s/iter; left time: 3.9807s
Updating learning rate to 1.4823037621875e-05
Epoch: 6 cost time: 1.9891934394836426
Epoch: 6, Steps: 523 | Train Loss: 0.4991831 Vali Loss: 0.2959142 Best vali loss: 0.2880232
	iters: 100, epoch: 7 | loss: 0.2752188
	speed: 0.0084s/iter; left time: 7.9907s
	iters: 200, epoch: 7 | loss: 0.3501976
	speed: 0.0045s/iter; left time: 3.7800s
	iters: 300, epoch: 7 | loss: 0.3812006
	speed: 0.0045s/iter; left time: 3.3510s
	iters: 400, epoch: 7 | loss: 0.3020312
	speed: 0.0045s/iter; left time: 2.8980s
	iters: 500, epoch: 7 | loss: 0.7236071
	speed: 0.0045s/iter; left time: 2.4401s
Updating learning rate to 7.4115188109375e-06
Epoch: 7 cost time: 2.347090482711792
Epoch: 7, Steps: 523 | Train Loss: 0.4064510 Vali Loss: 0.2954303 Best vali loss: 0.2880232
	iters: 100, epoch: 8 | loss: 0.6476312
	speed: 0.0086s/iter; left time: 3.6472s
	iters: 200, epoch: 8 | loss: 0.2674306
	speed: 0.0040s/iter; left time: 1.2958s
	iters: 300, epoch: 8 | loss: 0.4517501
	speed: 0.0040s/iter; left time: 0.8959s
	iters: 400, epoch: 8 | loss: 0.2625906
	speed: 0.0042s/iter; left time: 0.5182s
	iters: 500, epoch: 8 | loss: 0.2047368
	speed: 0.0045s/iter; left time: 0.1071s
Updating learning rate to 3.70575940546875e-06
Epoch: 8 cost time: 2.209784507751465
Epoch: 8, Steps: 523 | Train Loss: 0.3668278 Vali Loss: 0.2972234 Best vali loss: 0.2880232

best validation loss 0.2880231742108121

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020441760243, 'e_layers': 3, 'learning_rate': 0.0004740144006, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3184885
	speed: 0.0100s/iter; left time: 40.6535s
	iters: 200, epoch: 1 | loss: 0.9267406
	speed: 0.0045s/iter; left time: 17.8691s
	iters: 300, epoch: 1 | loss: 0.7701785
	speed: 0.0046s/iter; left time: 17.8895s
	iters: 400, epoch: 1 | loss: 0.3177656
	speed: 0.0045s/iter; left time: 17.0128s
	iters: 500, epoch: 1 | loss: 0.2878016
	speed: 0.0046s/iter; left time: 16.7904s
Updating learning rate to 0.0004740144006
Validation loss decreased (inf --> 0.3109).  Saving model state dict ...
Epoch: 1 cost time: 2.6502227783203125
Epoch: 1, Steps: 523 | Train Loss: 0.5241949 Vali Loss: 0.3109161 Best vali loss: 0.3109161
	iters: 100, epoch: 2 | loss: 0.7332934
	speed: 0.0096s/iter; left time: 34.0731s
	iters: 200, epoch: 2 | loss: 0.3234375
	speed: 0.0043s/iter; left time: 14.8464s
	iters: 300, epoch: 2 | loss: 0.3219278
	speed: 0.0043s/iter; left time: 14.3693s
	iters: 400, epoch: 2 | loss: 0.4069578
	speed: 0.0043s/iter; left time: 14.0128s
	iters: 500, epoch: 2 | loss: 0.1721151
	speed: 0.0043s/iter; left time: 13.6122s
Updating learning rate to 0.0002370072003
Validation loss decreased (0.3109 --> 0.2981).  Saving model state dict ...
Epoch: 2 cost time: 2.2896509170532227
Epoch: 2, Steps: 523 | Train Loss: 0.3915463 Vali Loss: 0.2980913 Best vali loss: 0.2980913
	iters: 100, epoch: 3 | loss: 0.8932875
	speed: 0.0098s/iter; left time: 29.7657s
	iters: 200, epoch: 3 | loss: 0.9152510
	speed: 0.0041s/iter; left time: 12.1942s
	iters: 300, epoch: 3 | loss: 0.9414049
	speed: 0.0041s/iter; left time: 11.6578s
	iters: 400, epoch: 3 | loss: 1.0483963
	speed: 0.0041s/iter; left time: 11.2516s
	iters: 500, epoch: 3 | loss: 0.9975646
	speed: 0.0041s/iter; left time: 10.8900s
Updating learning rate to 0.00011850360015
Epoch: 3 cost time: 2.2044153213500977
Epoch: 3, Steps: 523 | Train Loss: 0.9591809 Vali Loss: 0.3011270 Best vali loss: 0.2980913
	iters: 100, epoch: 4 | loss: 1.3289143
	speed: 0.0094s/iter; left time: 23.6731s
	iters: 200, epoch: 4 | loss: 0.3616569
	speed: 0.0045s/iter; left time: 10.8674s
	iters: 300, epoch: 4 | loss: 0.3822654
	speed: 0.0045s/iter; left time: 10.3923s
	iters: 400, epoch: 4 | loss: 0.6290694
	speed: 0.0045s/iter; left time: 10.0501s
	iters: 500, epoch: 4 | loss: 0.2875512
	speed: 0.0046s/iter; left time: 9.8195s
Updating learning rate to 5.9251800075e-05
Validation loss decreased (0.2981 --> 0.2937).  Saving model state dict ...
Epoch: 4 cost time: 2.4098706245422363
Epoch: 4, Steps: 523 | Train Loss: 0.5978914 Vali Loss: 0.2937492 Best vali loss: 0.2937492
	iters: 100, epoch: 5 | loss: 0.4795257
	speed: 0.0100s/iter; left time: 19.9815s
	iters: 200, epoch: 5 | loss: 0.3707033
	speed: 0.0045s/iter; left time: 8.4584s
	iters: 300, epoch: 5 | loss: 0.3656836
	speed: 0.0045s/iter; left time: 8.1553s
	iters: 400, epoch: 5 | loss: 0.8383751
	speed: 0.0046s/iter; left time: 7.7098s
	iters: 500, epoch: 5 | loss: 0.5314737
	speed: 0.0045s/iter; left time: 7.0926s
Updating learning rate to 2.96259000375e-05
Epoch: 5 cost time: 2.389431953430176
Epoch: 5, Steps: 523 | Train Loss: 0.5171523 Vali Loss: 0.2995005 Best vali loss: 0.2937492
	iters: 100, epoch: 6 | loss: 0.3767367
	speed: 0.0092s/iter; left time: 13.5850s
	iters: 200, epoch: 6 | loss: 0.4487860
	speed: 0.0043s/iter; left time: 5.8814s
	iters: 300, epoch: 6 | loss: 0.4757102
	speed: 0.0043s/iter; left time: 5.4410s
	iters: 400, epoch: 6 | loss: 0.2556362
	speed: 0.0043s/iter; left time: 4.9914s
	iters: 500, epoch: 6 | loss: 0.2794532
	speed: 0.0043s/iter; left time: 4.5857s
Updating learning rate to 1.481295001875e-05
Validation loss decreased (0.2937 --> 0.2930).  Saving model state dict ...
Epoch: 6 cost time: 2.287675380706787
Epoch: 6, Steps: 523 | Train Loss: 0.3672644 Vali Loss: 0.2930382 Best vali loss: 0.2930382
	iters: 100, epoch: 7 | loss: 0.6141294
	speed: 0.0096s/iter; left time: 9.1112s
	iters: 200, epoch: 7 | loss: 0.2901534
	speed: 0.0042s/iter; left time: 3.5608s
	iters: 300, epoch: 7 | loss: 0.2893583
	speed: 0.0042s/iter; left time: 3.1450s
	iters: 400, epoch: 7 | loss: 0.8396080
	speed: 0.0042s/iter; left time: 2.7492s
	iters: 500, epoch: 7 | loss: 0.5850617
	speed: 0.0042s/iter; left time: 2.3183s
Updating learning rate to 7.406475009375e-06
Epoch: 7 cost time: 2.2481372356414795
Epoch: 7, Steps: 523 | Train Loss: 0.5236622 Vali Loss: 0.3022937 Best vali loss: 0.2930382
	iters: 100, epoch: 8 | loss: 0.6479837
	speed: 0.0092s/iter; left time: 3.8991s
	iters: 200, epoch: 8 | loss: 0.2451956
	speed: 0.0043s/iter; left time: 1.3898s
	iters: 300, epoch: 8 | loss: 0.6730010
	speed: 0.0043s/iter; left time: 0.9599s
	iters: 400, epoch: 8 | loss: 0.3535728
	speed: 0.0041s/iter; left time: 0.5107s
	iters: 500, epoch: 8 | loss: 0.4918688
	speed: 0.0042s/iter; left time: 0.1013s
Updating learning rate to 3.7032375046875e-06
Epoch: 8 cost time: 2.2649190425872803
Epoch: 8, Steps: 523 | Train Loss: 0.4823244 Vali Loss: 0.3002262 Best vali loss: 0.2930382

best validation loss 0.29303817103546587

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002337334212, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596804
	speed: 0.0103s/iter; left time: 9.8008s
Updating learning rate to 0.00022483747255525984
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9354398250579834
Epoch: 1, Steps: 131 | Train Loss: 0.5596804 Vali Loss: 0.2756459 Best vali loss: 0.2756459
	iters: 100, epoch: 2 | loss: 0.3237171
	speed: 0.0090s/iter; left time: 7.3551s
Updating learning rate to 0.00019950395416022576
Validation loss decreased (0.2756 --> 0.2719).  Saving model state dict ...
Epoch: 2 cost time: 0.7014989852905273
Epoch: 2, Steps: 131 | Train Loss: 0.3237171 Vali Loss: 0.2718924 Best vali loss: 0.2718924
	iters: 100, epoch: 3 | loss: 0.4647935
	speed: 0.0090s/iter; left time: 6.1660s
Updating learning rate to 0.00016158966454162563
Epoch: 3 cost time: 0.7048008441925049
Epoch: 3, Steps: 131 | Train Loss: 0.4647935 Vali Loss: 0.2800914 Best vali loss: 0.2718924

best validation loss 0.2718923574887762

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.000233475699, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596473
	speed: 0.0106s/iter; left time: 10.0333s
Updating learning rate to 0.000233475699
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9418065547943115
Epoch: 1, Steps: 131 | Train Loss: 0.5596473 Vali Loss: 0.2756404 Best vali loss: 0.2756404
	iters: 100, epoch: 2 | loss: 0.3254656
	speed: 0.0089s/iter; left time: 7.2447s
Updating learning rate to 0.0001167378495
Validation loss decreased (0.2756 --> 0.2706).  Saving model state dict ...
Epoch: 2 cost time: 0.7000820636749268
Epoch: 2, Steps: 131 | Train Loss: 0.3254656 Vali Loss: 0.2706440 Best vali loss: 0.2706440
	iters: 100, epoch: 3 | loss: 0.4617459
	speed: 0.0089s/iter; left time: 6.1148s
Updating learning rate to 5.836892475e-05
Epoch: 3 cost time: 0.7052836418151855
Epoch: 3, Steps: 131 | Train Loss: 0.4617459 Vali Loss: 0.2778023 Best vali loss: 0.2706440

best validation loss 0.27064402332178233

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010263819311, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596908
	speed: 0.0105s/iter; left time: 9.9849s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9348816871643066
Epoch: 1, Steps: 131 | Train Loss: 0.5596908 Vali Loss: 0.2756503 Best vali loss: 0.2756503
	iters: 100, epoch: 2 | loss: 0.3248058
	speed: 0.0090s/iter; left time: 7.3573s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2757 --> 0.2712).  Saving model state dict ...
Epoch: 2 cost time: 0.7017381191253662
Epoch: 2, Steps: 131 | Train Loss: 0.3248058 Vali Loss: 0.2712418 Best vali loss: 0.2712418
	iters: 100, epoch: 3 | loss: 0.4628934
	speed: 0.0090s/iter; left time: 6.1551s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7001078128814697
Epoch: 3, Steps: 131 | Train Loss: 0.4628934 Vali Loss: 0.2778363 Best vali loss: 0.2712418

best validation loss 0.2712418097419427

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.000233475699, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4262025
	speed: 0.0106s/iter; left time: 5.9061s
Updating learning rate to 2.9184462375e-05
Epoch: 4 cost time: 0.9260447025299072
Epoch: 4, Steps: 131 | Train Loss: 0.4262025 Vali Loss: 0.3037640 Best vali loss: 0.2706440
	iters: 100, epoch: 5 | loss: 0.2813751
	speed: 0.0086s/iter; left time: 3.6674s
Updating learning rate to 1.45922311875e-05
Epoch: 5 cost time: 0.6993937492370605
Epoch: 5, Steps: 131 | Train Loss: 0.2813751 Vali Loss: 0.2936767 Best vali loss: 0.2706440
	iters: 100, epoch: 6 | loss: 0.4333233
	speed: 0.0086s/iter; left time: 2.5317s
Updating learning rate to 7.29611559375e-06
Epoch: 6 cost time: 0.7059183120727539
Epoch: 6, Steps: 131 | Train Loss: 0.4333233 Vali Loss: 0.2984044 Best vali loss: 0.2706440
	iters: 100, epoch: 7 | loss: 0.4657331
	speed: 0.0087s/iter; left time: 1.4135s
Updating learning rate to 3.648057796875e-06
Epoch: 7 cost time: 0.6992309093475342
Epoch: 7, Steps: 131 | Train Loss: 0.4657331 Vali Loss: 0.2966099 Best vali loss: 0.2706440
	iters: 100, epoch: 8 | loss: 0.3287376
	speed: 0.0087s/iter; left time: 0.2790s
Updating learning rate to 1.8240288984375e-06
Epoch: 8 cost time: 0.703110933303833
Epoch: 8, Steps: 131 | Train Loss: 0.3287376 Vali Loss: 0.2942303 Best vali loss: 0.2706440

best validation loss 0.27064402332178233

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0050469069905, 'e_layers': 1, 'learning_rate': 0.0011944575173, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5977263
	speed: 0.0083s/iter; left time: 7.9130s
Updating learning rate to 0.0011489961849938581
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 0.6659245491027832
Epoch: 1, Steps: 131 | Train Loss: 0.5977263 Vali Loss: 0.2900704 Best vali loss: 0.2900704
	iters: 100, epoch: 2 | loss: 0.3428213
	speed: 0.0055s/iter; left time: 4.5098s
Updating learning rate to 0.001019533263811039
Epoch: 2 cost time: 0.41884660720825195
Epoch: 2, Steps: 131 | Train Loss: 0.3428213 Vali Loss: 0.2905985 Best vali loss: 0.2900704
	iters: 100, epoch: 3 | loss: 0.4462748
	speed: 0.0053s/iter; left time: 3.6725s
Updating learning rate to 0.0008257783099173239
Epoch: 3 cost time: 0.40135741233825684
Epoch: 3, Steps: 131 | Train Loss: 0.4462748 Vali Loss: 0.3066964 Best vali loss: 0.2900704
	iters: 100, epoch: 4 | loss: 0.4275002
	speed: 0.0053s/iter; left time: 2.9679s
Updating learning rate to 0.00059722875865
Epoch: 4 cost time: 0.41335511207580566
Epoch: 4, Steps: 131 | Train Loss: 0.4275002 Vali Loss: 0.3132572 Best vali loss: 0.2900704
	iters: 100, epoch: 5 | loss: 0.3909844
	speed: 0.0052s/iter; left time: 2.2278s
Updating learning rate to 0.00036867920738267626
Epoch: 5 cost time: 0.4025599956512451
Epoch: 5, Steps: 131 | Train Loss: 0.3909844 Vali Loss: 0.3047796 Best vali loss: 0.2900704
	iters: 100, epoch: 6 | loss: 0.2603763
	speed: 0.0053s/iter; left time: 1.5704s
Updating learning rate to 0.0001749242534889611
Epoch: 6 cost time: 0.3998067378997803
Epoch: 6, Steps: 131 | Train Loss: 0.2603763 Vali Loss: 0.3151059 Best vali loss: 0.2900704
	iters: 100, epoch: 7 | loss: 0.3598814
	speed: 0.0052s/iter; left time: 0.8493s
Updating learning rate to 4.5461332306141904e-05
Epoch: 7 cost time: 0.40039563179016113
Epoch: 7, Steps: 131 | Train Loss: 0.3598814 Vali Loss: 0.3153433 Best vali loss: 0.2900704
	iters: 100, epoch: 8 | loss: 0.2783382
	speed: 0.0054s/iter; left time: 0.1714s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3999316692352295
Epoch: 8, Steps: 131 | Train Loss: 0.2783382 Vali Loss: 0.3156061 Best vali loss: 0.2900704

best validation loss 0.2900703966994408

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010261156824, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597233
	speed: 0.0104s/iter; left time: 9.8388s
Updating learning rate to 0.00022560087439875675
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9292254447937012
Epoch: 1, Steps: 131 | Train Loss: 0.5597233 Vali Loss: 0.2756456 Best vali loss: 0.2756456
	iters: 100, epoch: 2 | loss: 0.3240392
	speed: 0.0089s/iter; left time: 7.2705s
Updating learning rate to 0.0002001813398498083
Validation loss decreased (0.2756 --> 0.2720).  Saving model state dict ...
Epoch: 2 cost time: 0.7035303115844727
Epoch: 2, Steps: 131 | Train Loss: 0.3240392 Vali Loss: 0.2719692 Best vali loss: 0.2719692
	iters: 100, epoch: 3 | loss: 0.4601369
	speed: 0.0090s/iter; left time: 6.1650s
Updating learning rate to 0.0001621383179595776
Epoch: 3 cost time: 0.7011623382568359
Epoch: 3, Steps: 131 | Train Loss: 0.4601369 Vali Loss: 0.2800113 Best vali loss: 0.2719692
	iters: 100, epoch: 4 | loss: 0.5126417
	speed: 0.0087s/iter; left time: 4.8179s
Updating learning rate to 0.00011726351395
Epoch: 4 cost time: 0.7001833915710449
Epoch: 4, Steps: 131 | Train Loss: 0.5126417 Vali Loss: 0.2780367 Best vali loss: 0.2719692
	iters: 100, epoch: 5 | loss: 0.3329052
	speed: 0.0087s/iter; left time: 3.6998s
Updating learning rate to 7.238870994042242e-05
Epoch: 5 cost time: 0.7039034366607666
Epoch: 5, Steps: 131 | Train Loss: 0.3329052 Vali Loss: 0.2867198 Best vali loss: 0.2719692
	iters: 100, epoch: 6 | loss: 0.3113851
	speed: 0.0087s/iter; left time: 2.5573s
Updating learning rate to 3.4345688050191696e-05
Epoch: 6 cost time: 0.6997296810150146
Epoch: 6, Steps: 131 | Train Loss: 0.3113851 Vali Loss: 0.2931266 Best vali loss: 0.2719692
	iters: 100, epoch: 7 | loss: 0.2860522
	speed: 0.0086s/iter; left time: 1.3987s
Updating learning rate to 8.926153501243248e-06
Epoch: 7 cost time: 0.7023565769195557
Epoch: 7, Steps: 131 | Train Loss: 0.2860522 Vali Loss: 0.2957991 Best vali loss: 0.2719692
	iters: 100, epoch: 8 | loss: 0.3408316
	speed: 0.0085s/iter; left time: 0.2735s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6934332847595215
Epoch: 8, Steps: 131 | Train Loss: 0.3408316 Vali Loss: 0.2951869 Best vali loss: 0.2719692

best validation loss 0.2719691684583875

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.002108599372, 'e_layers': 2, 'learning_rate': 0.0004694888933, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004516200362806227
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 0.7904634475708008
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2861374 Best vali loss: 0.2861374
Updating learning rate to 0.00040073383672209874
Validation loss decreased (0.2861 --> 0.2719).  Saving model state dict ...
Epoch: 2 cost time: 0.5777168273925781
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2719213 Best vali loss: 0.2719213
Updating learning rate to 0.00032457725722266574
Epoch: 3 cost time: 0.575901985168457
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2977481 Best vali loss: 0.2719213

best validation loss 0.27192128960329964

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269744113, 'e_layers': 2, 'learning_rate': 0.0002364953768, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5599688
	speed: 0.0105s/iter; left time: 9.9750s
Updating learning rate to 0.0002364953768
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.939539909362793
Epoch: 1, Steps: 131 | Train Loss: 0.5599688 Vali Loss: 0.2756645 Best vali loss: 0.2756645
	iters: 100, epoch: 2 | loss: 0.3254058
	speed: 0.0090s/iter; left time: 7.3457s
Updating learning rate to 0.0001182476884
Validation loss decreased (0.2757 --> 0.2729).  Saving model state dict ...
Epoch: 2 cost time: 0.7060303688049316
Epoch: 2, Steps: 131 | Train Loss: 0.3254058 Vali Loss: 0.2728811 Best vali loss: 0.2728811
	iters: 100, epoch: 3 | loss: 0.4659860
	speed: 0.0089s/iter; left time: 6.1178s
Updating learning rate to 5.91238442e-05
Epoch: 3 cost time: 0.7019126415252686
Epoch: 3, Steps: 131 | Train Loss: 0.4659860 Vali Loss: 0.2782914 Best vali loss: 0.2728811

best validation loss 0.2728811433298431

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020555904038, 'e_layers': 2, 'learning_rate': 0.0005728403813, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005510379424895156
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 0.6053962707519531
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2842460 Best vali loss: 0.2842460
Updating learning rate to 0.0004889498497273587
Validation loss decreased (0.2842 --> 0.2832).  Saving model state dict ...
Epoch: 2 cost time: 0.38663601875305176
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2832363 Best vali loss: 0.2832363
Updating learning rate to 0.0003960284523066054
Epoch: 3 cost time: 0.3886282444000244
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2893116 Best vali loss: 0.2832363

best validation loss 0.28323628088717745

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.002108599372, 'e_layers': 2, 'learning_rate': 0.0004694888933, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00023474444665
Epoch: 4 cost time: 0.799558162689209
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2819354 Best vali loss: 0.2719213
Updating learning rate to 0.0001449116360773343
Epoch: 5 cost time: 0.570451021194458
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2859956 Best vali loss: 0.2719213
Updating learning rate to 6.875505657790129e-05
Epoch: 6 cost time: 0.567338228225708
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2971315 Best vali loss: 0.2719213
Updating learning rate to 1.786885701937731e-05
Epoch: 7 cost time: 0.5691254138946533
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2954036 Best vali loss: 0.2719213
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5695919990539551
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2989982 Best vali loss: 0.2719213

best validation loss 0.27192128960329964

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0009001925426, 'e_layers': 4, 'learning_rate': 0.0010377984531, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3895422
	speed: 0.0109s/iter; left time: 90.4180s
	iters: 200, epoch: 1 | loss: 0.3902651
	speed: 0.0051s/iter; left time: 41.6290s
	iters: 300, epoch: 1 | loss: 0.7247326
	speed: 0.0050s/iter; left time: 40.4700s
	iters: 400, epoch: 1 | loss: 0.6834992
	speed: 0.0051s/iter; left time: 40.3736s
	iters: 500, epoch: 1 | loss: 1.2428936
	speed: 0.0051s/iter; left time: 39.9864s
	iters: 600, epoch: 1 | loss: 0.3043495
	speed: 0.0051s/iter; left time: 39.6267s
	iters: 700, epoch: 1 | loss: 0.3936035
	speed: 0.0051s/iter; left time: 38.7713s
	iters: 800, epoch: 1 | loss: 1.1467505
	speed: 0.0050s/iter; left time: 38.1587s
	iters: 900, epoch: 1 | loss: 0.6433908
	speed: 0.0051s/iter; left time: 37.8326s
	iters: 1000, epoch: 1 | loss: 0.2814203
	speed: 0.0051s/iter; left time: 37.3747s
Updating learning rate to 0.0009982996013954823
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 5.5597076416015625
Epoch: 1, Steps: 1045 | Train Loss: 0.6200447 Vali Loss: 0.3217898 Best vali loss: 0.3217898
	iters: 100, epoch: 2 | loss: 0.6744536
	speed: 0.0135s/iter; left time: 97.2982s
	iters: 200, epoch: 2 | loss: 0.3263453
	speed: 0.0045s/iter; left time: 32.0874s
	iters: 300, epoch: 2 | loss: 0.3578217
	speed: 0.0046s/iter; left time: 32.4041s
	iters: 400, epoch: 2 | loss: 0.3266757
	speed: 0.0048s/iter; left time: 33.4631s
	iters: 500, epoch: 2 | loss: 0.2537595
	speed: 0.0049s/iter; left time: 33.0656s
	iters: 600, epoch: 2 | loss: 0.4008113
	speed: 0.0048s/iter; left time: 32.5043s
	iters: 700, epoch: 2 | loss: 0.4816433
	speed: 0.0048s/iter; left time: 32.0214s
	iters: 800, epoch: 2 | loss: 0.6658030
	speed: 0.0046s/iter; left time: 29.8044s
	iters: 900, epoch: 2 | loss: 0.6767229
	speed: 0.0044s/iter; left time: 28.0898s
	iters: 1000, epoch: 2 | loss: 0.2979822
	speed: 0.0044s/iter; left time: 27.6962s
Updating learning rate to 0.0008858163883959595
Validation loss decreased (0.3218 --> 0.3166).  Saving model state dict ...
Epoch: 2 cost time: 4.869124174118042
Epoch: 2, Steps: 1045 | Train Loss: 0.4462018 Vali Loss: 0.3165547 Best vali loss: 0.3165547
	iters: 100, epoch: 3 | loss: 0.2099443
	speed: 0.0139s/iter; left time: 86.0689s
	iters: 200, epoch: 3 | loss: 0.7687535
	speed: 0.0052s/iter; left time: 31.4973s
	iters: 300, epoch: 3 | loss: 1.0517273
	speed: 0.0051s/iter; left time: 30.7403s
	iters: 400, epoch: 3 | loss: 0.9794081
	speed: 0.0051s/iter; left time: 30.2000s
	iters: 500, epoch: 3 | loss: 0.3502048
	speed: 0.0052s/iter; left time: 30.0743s
	iters: 600, epoch: 3 | loss: 0.3995623
	speed: 0.0051s/iter; left time: 28.9998s
	iters: 700, epoch: 3 | loss: 0.1497319
	speed: 0.0052s/iter; left time: 28.7719s
	iters: 800, epoch: 3 | loss: 0.4363163
	speed: 0.0052s/iter; left time: 28.3974s
	iters: 900, epoch: 3 | loss: 0.3216693
	speed: 0.0050s/iter; left time: 26.6886s
	iters: 1000, epoch: 3 | loss: 1.0400726
	speed: 0.0049s/iter; left time: 25.6608s
Updating learning rate to 0.0007174733636177444
Epoch: 3 cost time: 5.372723340988159
Epoch: 3, Steps: 1045 | Train Loss: 0.5707390 Vali Loss: 0.3240047 Best vali loss: 0.3165547
	iters: 100, epoch: 4 | loss: 0.2439835
	speed: 0.0136s/iter; left time: 69.6701s
	iters: 200, epoch: 4 | loss: 0.3879204
	speed: 0.0049s/iter; left time: 24.8193s
	iters: 300, epoch: 4 | loss: 1.5358096
	speed: 0.0050s/iter; left time: 24.4330s
	iters: 400, epoch: 4 | loss: 0.3699085
	speed: 0.0050s/iter; left time: 23.9335s
	iters: 500, epoch: 4 | loss: 0.3648708
	speed: 0.0049s/iter; left time: 23.2063s
	iters: 600, epoch: 4 | loss: 0.5063398
	speed: 0.0049s/iter; left time: 22.7826s
	iters: 700, epoch: 4 | loss: 0.4132959
	speed: 0.0050s/iter; left time: 22.5576s
	iters: 800, epoch: 4 | loss: 0.2562584
	speed: 0.0050s/iter; left time: 21.9091s
	iters: 900, epoch: 4 | loss: 0.8809825
	speed: 0.0050s/iter; left time: 21.4755s
	iters: 1000, epoch: 4 | loss: 0.4765562
	speed: 0.0050s/iter; left time: 20.9481s
Updating learning rate to 0.00051889922655
Epoch: 4 cost time: 5.208528518676758
Epoch: 4, Steps: 1045 | Train Loss: 0.5435925 Vali Loss: 0.3209540 Best vali loss: 0.3165547
	iters: 100, epoch: 5 | loss: 0.6561584
	speed: 0.0141s/iter; left time: 57.6661s
	iters: 200, epoch: 5 | loss: 0.4478464
	speed: 0.0049s/iter; left time: 19.3429s
	iters: 300, epoch: 5 | loss: 0.5235750
	speed: 0.0049s/iter; left time: 18.9859s
	iters: 400, epoch: 5 | loss: 0.2058634
	speed: 0.0049s/iter; left time: 18.5785s
	iters: 500, epoch: 5 | loss: 0.6504284
	speed: 0.0048s/iter; left time: 17.7569s
	iters: 600, epoch: 5 | loss: 0.9623228
	speed: 0.0048s/iter; left time: 17.1609s
	iters: 700, epoch: 5 | loss: 0.6965710
	speed: 0.0049s/iter; left time: 17.0179s
	iters: 800, epoch: 5 | loss: 0.4061725
	speed: 0.0049s/iter; left time: 16.5904s
	iters: 900, epoch: 5 | loss: 0.5751740
	speed: 0.0049s/iter; left time: 15.9612s
	iters: 1000, epoch: 5 | loss: 0.2591019
	speed: 0.0049s/iter; left time: 15.7117s
Updating learning rate to 0.0003203250894822557
Epoch: 5 cost time: 5.146627187728882
Epoch: 5, Steps: 1045 | Train Loss: 0.5383214 Vali Loss: 0.3208041 Best vali loss: 0.3165547
	iters: 100, epoch: 6 | loss: 0.4374874
	speed: 0.0133s/iter; left time: 40.2531s
	iters: 200, epoch: 6 | loss: 0.4932308
	speed: 0.0044s/iter; left time: 13.0552s
	iters: 300, epoch: 6 | loss: 0.6448284
	speed: 0.0044s/iter; left time: 12.4270s
	iters: 400, epoch: 6 | loss: 0.4889250
	speed: 0.0043s/iter; left time: 11.6684s
	iters: 500, epoch: 6 | loss: 0.4977565
	speed: 0.0042s/iter; left time: 11.1838s
	iters: 600, epoch: 6 | loss: 0.3700619
	speed: 0.0046s/iter; left time: 11.6829s
	iters: 700, epoch: 6 | loss: 0.3150524
	speed: 0.0048s/iter; left time: 11.5846s
	iters: 800, epoch: 6 | loss: 0.4339508
	speed: 0.0044s/iter; left time: 10.2519s
	iters: 900, epoch: 6 | loss: 1.2425402
	speed: 0.0044s/iter; left time: 9.9334s
	iters: 1000, epoch: 6 | loss: 0.4968260
	speed: 0.0048s/iter; left time: 10.2243s
Updating learning rate to 0.00015198206470404043
Epoch: 6 cost time: 4.7352683544158936
Epoch: 6, Steps: 1045 | Train Loss: 0.5420659 Vali Loss: 0.3219622 Best vali loss: 0.3165547
	iters: 100, epoch: 7 | loss: 0.5687326
	speed: 0.0136s/iter; left time: 27.0707s
	iters: 200, epoch: 7 | loss: 0.2152323
	speed: 0.0049s/iter; left time: 9.2257s
	iters: 300, epoch: 7 | loss: 0.1835734
	speed: 0.0049s/iter; left time: 8.8080s
	iters: 400, epoch: 7 | loss: 0.7343506
	speed: 0.0046s/iter; left time: 7.8259s
	iters: 500, epoch: 7 | loss: 1.1415883
	speed: 0.0043s/iter; left time: 6.8942s
	iters: 600, epoch: 7 | loss: 0.3805343
	speed: 0.0043s/iter; left time: 6.3470s
	iters: 700, epoch: 7 | loss: 0.2356386
	speed: 0.0044s/iter; left time: 6.1811s
	iters: 800, epoch: 7 | loss: 0.2534555
	speed: 0.0044s/iter; left time: 5.6974s
	iters: 900, epoch: 7 | loss: 0.6396684
	speed: 0.0047s/iter; left time: 5.6298s
	iters: 1000, epoch: 7 | loss: 0.4428133
	speed: 0.0048s/iter; left time: 5.2616s
Updating learning rate to 3.949885170451773e-05
Epoch: 7 cost time: 4.881444215774536
Epoch: 7, Steps: 1045 | Train Loss: 0.4795587 Vali Loss: 0.3218099 Best vali loss: 0.3165547
	iters: 100, epoch: 8 | loss: 0.3907464
	speed: 0.0136s/iter; left time: 12.8300s
	iters: 200, epoch: 8 | loss: 0.3378714
	speed: 0.0044s/iter; left time: 3.6881s
	iters: 300, epoch: 8 | loss: 0.8247975
	speed: 0.0044s/iter; left time: 3.2594s
	iters: 400, epoch: 8 | loss: 1.2472640
	speed: 0.0045s/iter; left time: 2.8955s
	iters: 500, epoch: 8 | loss: 0.5222126
	speed: 0.0047s/iter; left time: 2.5436s
	iters: 600, epoch: 8 | loss: 0.5046286
	speed: 0.0046s/iter; left time: 2.0686s
	iters: 700, epoch: 8 | loss: 0.3062249
	speed: 0.0044s/iter; left time: 1.5116s
	iters: 800, epoch: 8 | loss: 0.3533630
	speed: 0.0048s/iter; left time: 1.1699s
	iters: 900, epoch: 8 | loss: 2.8562303
	speed: 0.0048s/iter; left time: 0.7024s
	iters: 1000, epoch: 8 | loss: 0.3373430
	speed: 0.0046s/iter; left time: 0.2109s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.827585697174072
Epoch: 8, Steps: 1045 | Train Loss: 0.7680682 Vali Loss: 0.3218485 Best vali loss: 0.3165547

best validation loss 0.3165546807714358

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0040485614799, 'e_layers': 3, 'learning_rate': 0.0011835518915, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4476966
	speed: 0.0100s/iter; left time: 19.8784s
	iters: 200, epoch: 1 | loss: 0.3663594
	speed: 0.0046s/iter; left time: 8.7306s
Updating learning rate to 0.0011385056298609346
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 1.4720127582550049
Epoch: 1, Steps: 262 | Train Loss: 0.4070280 Vali Loss: 0.2858876 Best vali loss: 0.2858876
	iters: 100, epoch: 2 | loss: 0.6885513
	speed: 0.0098s/iter; left time: 16.9801s
	iters: 200, epoch: 2 | loss: 0.3503143
	speed: 0.0044s/iter; left time: 7.2201s
Updating learning rate to 0.0010102247299329074
Epoch: 2 cost time: 1.2193996906280518
Epoch: 2, Steps: 262 | Train Loss: 0.5194328 Vali Loss: 0.2865955 Best vali loss: 0.2858876
	iters: 100, epoch: 3 | loss: 0.4403952
	speed: 0.0097s/iter; left time: 14.3598s
	iters: 200, epoch: 3 | loss: 0.3356573
	speed: 0.0042s/iter; left time: 5.7044s
Updating learning rate to 0.0008182387958607072
Epoch: 3 cost time: 1.1705257892608643
Epoch: 3, Steps: 262 | Train Loss: 0.3880262 Vali Loss: 0.2998526 Best vali loss: 0.2858876
	iters: 100, epoch: 4 | loss: 0.5255281
	speed: 0.0092s/iter; left time: 11.1893s
	iters: 200, epoch: 4 | loss: 0.3827128
	speed: 0.0042s/iter; left time: 4.6194s
Updating learning rate to 0.00059177594575
Epoch: 4 cost time: 1.123338222503662
Epoch: 4, Steps: 262 | Train Loss: 0.4541204 Vali Loss: 0.2933671 Best vali loss: 0.2858876
	iters: 100, epoch: 5 | loss: 0.3420956
	speed: 0.0088s/iter; left time: 8.3593s
	iters: 200, epoch: 5 | loss: 0.4367064
	speed: 0.0040s/iter; left time: 3.4335s
Updating learning rate to 0.0003653130956392929
Epoch: 5 cost time: 1.0941593647003174
Epoch: 5, Steps: 262 | Train Loss: 0.3894010 Vali Loss: 0.2949939 Best vali loss: 0.2858876
	iters: 100, epoch: 6 | loss: 0.2282767
	speed: 0.0087s/iter; left time: 5.9938s
	iters: 200, epoch: 6 | loss: 0.2828001
	speed: 0.0039s/iter; left time: 2.2609s
Updating learning rate to 0.00017332716156709258
Epoch: 6 cost time: 1.0633611679077148
Epoch: 6, Steps: 262 | Train Loss: 0.2555384 Vali Loss: 0.2902004 Best vali loss: 0.2858876
	iters: 100, epoch: 7 | loss: 0.4029751
	speed: 0.0092s/iter; left time: 3.8895s
	iters: 200, epoch: 7 | loss: 0.4718616
	speed: 0.0044s/iter; left time: 1.4374s
Updating learning rate to 4.504626163906542e-05
Epoch: 7 cost time: 1.1966450214385986
Epoch: 7, Steps: 262 | Train Loss: 0.4374183 Vali Loss: 0.2918525 Best vali loss: 0.2858876
	iters: 100, epoch: 8 | loss: 0.4911910
	speed: 0.0095s/iter; left time: 1.5527s
	iters: 200, epoch: 8 | loss: 0.2717521
	speed: 0.0042s/iter; left time: 0.2658s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1482152938842773
Epoch: 8, Steps: 262 | Train Loss: 0.3814715 Vali Loss: 0.2936110 Best vali loss: 0.2858876

best validation loss 0.28588759896368643

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002344844874, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597149
	speed: 0.0105s/iter; left time: 9.9678s
Updating learning rate to 0.0002344844874
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9389533996582031
Epoch: 1, Steps: 131 | Train Loss: 0.5597149 Vali Loss: 0.2756366 Best vali loss: 0.2756366
	iters: 100, epoch: 2 | loss: 0.3260749
	speed: 0.0089s/iter; left time: 7.2902s
Updating learning rate to 0.0001172422437
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.6979739665985107
Epoch: 2, Steps: 131 | Train Loss: 0.3260749 Vali Loss: 0.2689690 Best vali loss: 0.2689690
	iters: 100, epoch: 3 | loss: 0.4638384
	speed: 0.0089s/iter; left time: 6.1422s
Updating learning rate to 5.862112185e-05
Epoch: 3 cost time: 0.6925919055938721
Epoch: 3, Steps: 131 | Train Loss: 0.4638384 Vali Loss: 0.2808306 Best vali loss: 0.2689690

best validation loss 0.26896897730839747

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002344717606, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597185
	speed: 0.0106s/iter; left time: 10.0337s
Updating learning rate to 0.0002344717606
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9311394691467285
Epoch: 1, Steps: 131 | Train Loss: 0.5597185 Vali Loss: 0.2756398 Best vali loss: 0.2756398
	iters: 100, epoch: 2 | loss: 0.3259237
	speed: 0.0090s/iter; left time: 7.3683s
Updating learning rate to 0.0001172358803
Validation loss decreased (0.2756 --> 0.2719).  Saving model state dict ...
Epoch: 2 cost time: 0.711606502532959
Epoch: 2, Steps: 131 | Train Loss: 0.3259237 Vali Loss: 0.2718855 Best vali loss: 0.2718855
	iters: 100, epoch: 3 | loss: 0.4663467
	speed: 0.0091s/iter; left time: 6.2500s
Updating learning rate to 5.861794015e-05
Epoch: 3 cost time: 0.7075309753417969
Epoch: 3, Steps: 131 | Train Loss: 0.4663467 Vali Loss: 0.2890775 Best vali loss: 0.2718855

best validation loss 0.27188552348043626

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020777103323, 'e_layers': 2, 'learning_rate': 0.0004967980742, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00047788982337220175
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 0.7722551822662354
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2776394 Best vali loss: 0.2776394
Updating learning rate to 0.0004240436806736188
Validation loss decreased (0.2776 --> 0.2729).  Saving model state dict ...
Epoch: 2 cost time: 0.5508682727813721
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2729128 Best vali loss: 0.2729128
Updating learning rate to 0.00034345723321361127
Epoch: 3 cost time: 0.5483379364013672
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2775062 Best vali loss: 0.2729128

best validation loss 0.2729127858597446

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002344844874, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4191966
	speed: 0.0108s/iter; left time: 6.0036s
Updating learning rate to 2.9310560925e-05
Epoch: 4 cost time: 0.9260659217834473
Epoch: 4, Steps: 131 | Train Loss: 0.4191966 Vali Loss: 0.3098196 Best vali loss: 0.2689690
	iters: 100, epoch: 5 | loss: 0.2801966
	speed: 0.0087s/iter; left time: 3.6810s
Updating learning rate to 1.46552804625e-05
Epoch: 5 cost time: 0.6996824741363525
Epoch: 5, Steps: 131 | Train Loss: 0.2801966 Vali Loss: 0.2935688 Best vali loss: 0.2689690
	iters: 100, epoch: 6 | loss: 0.4361949
	speed: 0.0086s/iter; left time: 2.5208s
Updating learning rate to 7.32764023125e-06
Epoch: 6 cost time: 0.6977856159210205
Epoch: 6, Steps: 131 | Train Loss: 0.4361949 Vali Loss: 0.2995689 Best vali loss: 0.2689690
	iters: 100, epoch: 7 | loss: 0.4651754
	speed: 0.0087s/iter; left time: 1.4105s
Updating learning rate to 3.663820115625e-06
Epoch: 7 cost time: 0.7006206512451172
Epoch: 7, Steps: 131 | Train Loss: 0.4651754 Vali Loss: 0.2958287 Best vali loss: 0.2689690
	iters: 100, epoch: 8 | loss: 0.3270429
	speed: 0.0086s/iter; left time: 0.2747s
Updating learning rate to 1.8319100578125e-06
Epoch: 8 cost time: 0.693356990814209
Epoch: 8, Steps: 131 | Train Loss: 0.3270429 Vali Loss: 0.2945427 Best vali loss: 0.2689690

best validation loss 0.26896897730839747

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002085857378, 'e_layers': 2, 'learning_rate': 0.000500777882, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004817181587570762
Validation loss decreased (inf --> 0.2777).  Saving model state dict ...
Epoch: 1 cost time: 0.7764804363250732
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2777186 Best vali loss: 0.2777186
Updating learning rate to 0.00042744065911521836
Epoch: 2 cost time: 0.5566308498382568
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2911039 Best vali loss: 0.2777186
Updating learning rate to 0.00034620864036814
Validation loss decreased (0.2777 --> 0.2725).  Saving model state dict ...
Epoch: 3 cost time: 0.5452842712402344
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2724537 Best vali loss: 0.2724537
Updating learning rate to 0.000250388941
Epoch: 4 cost time: 0.5500378608703613
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2727002 Best vali loss: 0.2724537
Updating learning rate to 0.00015456924163186007
Epoch: 5 cost time: 0.5489161014556885
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2791784 Best vali loss: 0.2724537
Updating learning rate to 7.333722288478167e-05
Epoch: 6 cost time: 0.5473978519439697
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2941810 Best vali loss: 0.2724537
Updating learning rate to 1.9059723242923844e-05
Epoch: 7 cost time: 0.5521721839904785
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3120693 Best vali loss: 0.2724537
Updating learning rate to 0.0
Epoch: 8 cost time: 0.547722578048706
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3091175 Best vali loss: 0.2724537

best validation loss 0.2724537074166898

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020789382169, 'e_layers': 4, 'learning_rate': 0.0005056431362, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00048639824024499846
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.2328295707702637
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2855736 Best vali loss: 0.2855736
Updating learning rate to 0.00043159341333372654
Epoch: 2 cost time: 1.0155532360076904
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2914840 Best vali loss: 0.2855736
Updating learning rate to 0.0003495721935564323
Epoch: 3 cost time: 1.0150072574615479
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2958745 Best vali loss: 0.2855736
Updating learning rate to 0.0002528215681
Validation loss decreased (0.2856 --> 0.2691).  Saving model state dict ...
Epoch: 4 cost time: 1.0141518115997314
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2691023 Best vali loss: 0.2691023
Updating learning rate to 0.00015607094264356774
Epoch: 5 cost time: 1.0243353843688965
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2842205 Best vali loss: 0.2691023
Updating learning rate to 7.40497228662735e-05
Epoch: 6 cost time: 1.0186095237731934
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2914520 Best vali loss: 0.2691023
Updating learning rate to 1.9244895955001556e-05
Epoch: 7 cost time: 1.0245964527130127
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2956245 Best vali loss: 0.2691023
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0242300033569336
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2941794 Best vali loss: 0.2691023

best validation loss 0.2691022670758883

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020822905735, 'e_layers': 1, 'learning_rate': 0.0005066021036, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004873207091216012
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 0.5422272682189941
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2786861 Best vali loss: 0.2786861
Updating learning rate to 0.0004324119432094649
Epoch: 2 cost time: 0.3195781707763672
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2793882 Best vali loss: 0.2786861
Updating learning rate to 0.00035023516772451143
Epoch: 3 cost time: 0.32260608673095703
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2880721 Best vali loss: 0.2786861

best validation loss 0.2786860753442329

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002377238508, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5600857
	speed: 0.0105s/iter; left time: 9.9405s
Updating learning rate to 0.0002377238508
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.934699296951294
Epoch: 1, Steps: 131 | Train Loss: 0.5600857 Vali Loss: 0.2756779 Best vali loss: 0.2756779
	iters: 100, epoch: 2 | loss: 0.3255143
	speed: 0.0089s/iter; left time: 7.2991s
Updating learning rate to 0.0001188619254
Validation loss decreased (0.2757 --> 0.2710).  Saving model state dict ...
Epoch: 2 cost time: 0.7051069736480713
Epoch: 2, Steps: 131 | Train Loss: 0.3255143 Vali Loss: 0.2709916 Best vali loss: 0.2709916
	iters: 100, epoch: 3 | loss: 0.4611151
	speed: 0.0090s/iter; left time: 6.1708s
Updating learning rate to 5.94309627e-05
Epoch: 3 cost time: 0.6992738246917725
Epoch: 3, Steps: 131 | Train Loss: 0.4611151 Vali Loss: 0.2824320 Best vali loss: 0.2709916

best validation loss 0.2709915809978912

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012864500212, 'e_layers': 1, 'learning_rate': 0.0005196844842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004999051712580326
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 0.5488986968994141
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2786821 Best vali loss: 0.2786821
Updating learning rate to 0.0004435784535276266
Epoch: 2 cost time: 0.32212138175964355
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2792079 Best vali loss: 0.2786821
Updating learning rate to 0.0003592795631802687
Epoch: 3 cost time: 0.3180255889892578
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2898195 Best vali loss: 0.2786821

best validation loss 0.2786821433107132

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002377238508, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4272755
	speed: 0.0108s/iter; left time: 5.9948s
Updating learning rate to 2.971548135e-05
Epoch: 4 cost time: 0.9324450492858887
Epoch: 4, Steps: 131 | Train Loss: 0.4272755 Vali Loss: 0.3120892 Best vali loss: 0.2709916
	iters: 100, epoch: 5 | loss: 0.2827825
	speed: 0.0087s/iter; left time: 3.7150s
Updating learning rate to 1.4857740675e-05
Epoch: 5 cost time: 0.7051863670349121
Epoch: 5, Steps: 131 | Train Loss: 0.2827825 Vali Loss: 0.3024525 Best vali loss: 0.2709916
	iters: 100, epoch: 6 | loss: 0.4345103
	speed: 0.0088s/iter; left time: 2.5980s
Updating learning rate to 7.4288703375e-06
Epoch: 6 cost time: 0.7095844745635986
Epoch: 6, Steps: 131 | Train Loss: 0.4345103 Vali Loss: 0.2989968 Best vali loss: 0.2709916
	iters: 100, epoch: 7 | loss: 0.4667592
	speed: 0.0088s/iter; left time: 1.4271s
Updating learning rate to 3.71443516875e-06
Epoch: 7 cost time: 0.712482213973999
Epoch: 7, Steps: 131 | Train Loss: 0.4667592 Vali Loss: 0.2988515 Best vali loss: 0.2709916
	iters: 100, epoch: 8 | loss: 0.3260051
	speed: 0.0087s/iter; left time: 0.2784s
Updating learning rate to 1.857217584375e-06
Epoch: 8 cost time: 0.7068240642547607
Epoch: 8, Steps: 131 | Train Loss: 0.3260051 Vali Loss: 0.2967006 Best vali loss: 0.2709916

best validation loss 0.2709915809978912

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002082922261, 'e_layers': 4, 'learning_rate': 0.0005028169364, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00048367960626999464
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.2466723918914795
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2855793 Best vali loss: 0.2855793
Updating learning rate to 0.0004291811009119424
Epoch: 2 cost time: 1.0247743129730225
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2897672 Best vali loss: 0.2855793
Updating learning rate to 0.00034761832373642553
Epoch: 3 cost time: 1.0253279209136963
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2880872 Best vali loss: 0.2855793
Updating learning rate to 0.0002514084682
Validation loss decreased (0.2856 --> 0.2790).  Saving model state dict ...
Epoch: 4 cost time: 1.023575782775879
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2789773 Best vali loss: 0.2789773
Updating learning rate to 0.00015519861266357447
Epoch: 5 cost time: 1.027071475982666
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2875831 Best vali loss: 0.2789773
Updating learning rate to 7.363583548805752e-05
Epoch: 6 cost time: 1.019592523574829
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2962973 Best vali loss: 0.2789773
Updating learning rate to 1.91373301300053e-05
Epoch: 7 cost time: 1.0237700939178467
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3144630 Best vali loss: 0.2789773
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0226454734802246
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3130628 Best vali loss: 0.2789773

best validation loss 0.27897734088873766

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010431293237, 'e_layers': 3, 'learning_rate': 0.0008160077812, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007849503343103141
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 0.6122660636901855
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2836105 Best vali loss: 0.2836105
Updating learning rate to 0.0006965062083937542
Validation loss decreased (0.2836 --> 0.2811).  Saving model state dict ...
Epoch: 2 cost time: 0.3754465579986572
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2810893 Best vali loss: 0.2810893
Updating learning rate to 0.0005641402198731186
Epoch: 3 cost time: 0.37118005752563477
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2838294 Best vali loss: 0.2810893
Updating learning rate to 0.0004080038906
Epoch: 4 cost time: 0.3719139099121094
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2894333 Best vali loss: 0.2810893
Updating learning rate to 0.0002518675613268814
Epoch: 5 cost time: 0.39824771881103516
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2858547 Best vali loss: 0.2810893
Updating learning rate to 0.00011950157280624575
Epoch: 6 cost time: 0.38454747200012207
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2867178 Best vali loss: 0.2810893
Updating learning rate to 3.1057446889685824e-05
Epoch: 7 cost time: 0.3792886734008789
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2879536 Best vali loss: 0.2810893
Updating learning rate to 0.0
Epoch: 8 cost time: 0.37477803230285645
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2885181 Best vali loss: 0.2810893

best validation loss 0.2810892713429007

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020507499534, 'e_layers': 4, 'learning_rate': 0.0005053302571, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004860972693966782
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 1.2506341934204102
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2855189 Best vali loss: 0.2855189
Updating learning rate to 0.0004313263543170758
Epoch: 2 cost time: 1.0193030834197998
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2931244 Best vali loss: 0.2855189
Updating learning rate to 0.00034935588718248067
Epoch: 3 cost time: 1.022287130355835
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2941860 Best vali loss: 0.2855189

best validation loss 0.28551885459049786

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020848253851, 'e_layers': 4, 'learning_rate': 0.000513089742, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004935614264876484
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 1.2377572059631348
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857523 Best vali loss: 0.2857523
Updating learning rate to 0.00043794948896272803
Epoch: 2 cost time: 1.0207972526550293
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2897209 Best vali loss: 0.2857523
Updating learning rate to 0.00035472034278993917
Epoch: 3 cost time: 1.0181853771209717
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3114693 Best vali loss: 0.2857523

best validation loss 0.2857523494053392

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020843627383, 'e_layers': 4, 'learning_rate': 0.000508160043, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004888193529838776
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.2436566352844238
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2855681 Best vali loss: 0.2855681
Updating learning rate to 0.00043374172766667374
Epoch: 2 cost time: 1.02410888671875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2876505 Best vali loss: 0.2855681
Updating learning rate to 0.0003513122362230158
Epoch: 3 cost time: 1.0288116931915283
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3049732 Best vali loss: 0.2855681

best validation loss 0.28556809432779645

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020507499534, 'e_layers': 4, 'learning_rate': 0.0005053302571, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00025266512855
Epoch: 4 cost time: 1.2422325611114502
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2867350 Best vali loss: 0.2855189
Updating learning rate to 0.00015597436991751938
Validation loss decreased (0.2855 --> 0.2760).  Saving model state dict ...
Epoch: 5 cost time: 1.0185534954071045
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2760457 Best vali loss: 0.2760457
Updating learning rate to 7.400390278292427e-05
Epoch: 6 cost time: 1.023646354675293
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2818010 Best vali loss: 0.2760457
Updating learning rate to 1.9232987703321832e-05
Epoch: 7 cost time: 1.0164830684661865
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2822476 Best vali loss: 0.2760457
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0272047519683838
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2831670 Best vali loss: 0.2760457

best validation loss 0.27604565784950247

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0077924389608, 'e_layers': 4, 'learning_rate': 0.0005055460058, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004863048066507261
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 1.2362256050109863
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2861209 Best vali loss: 0.2861209
Updating learning rate to 0.0004315105073514768
Epoch: 2 cost time: 1.019925832748413
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3031816 Best vali loss: 0.2861209
Updating learning rate to 0.0003495050432590028
Epoch: 3 cost time: 1.021296501159668
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2960394 Best vali loss: 0.2861209
Updating learning rate to 0.0002527730029
Validation loss decreased (0.2861 --> 0.2713).  Saving model state dict ...
Epoch: 4 cost time: 1.021332025527954
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2712521 Best vali loss: 0.2712521
Updating learning rate to 0.00015604096254099721
Epoch: 5 cost time: 1.0243265628814697
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2830723 Best vali loss: 0.2712521
Updating learning rate to 7.403549844852317e-05
Epoch: 6 cost time: 1.024493932723999
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2873088 Best vali loss: 0.2712521
Updating learning rate to 1.9241199149273872e-05
Epoch: 7 cost time: 1.0321054458618164
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3008291 Best vali loss: 0.2712521
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0190634727478027
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2960739 Best vali loss: 0.2712521

best validation loss 0.27125210784079196

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0069107629017, 'e_layers': 4, 'learning_rate': 0.0005045692517, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004853652280400829
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 1.2428557872772217
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2860067 Best vali loss: 0.2860067
Updating learning rate to 0.0004306767955776459
Epoch: 2 cost time: 1.0216727256774902
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2956627 Best vali loss: 0.2860067
Updating learning rate to 0.0003488297724032205
Validation loss decreased (0.2860 --> 0.2815).  Saving model state dict ...
Epoch: 3 cost time: 1.0237371921539307
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2814861 Best vali loss: 0.2814861
Updating learning rate to 0.00025228462585
Validation loss decreased (0.2815 --> 0.2755).  Saving model state dict ...
Epoch: 4 cost time: 1.026505947113037
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2754717 Best vali loss: 0.2754717
Updating learning rate to 0.00015573947929677955
Validation loss decreased (0.2755 --> 0.2736).  Saving model state dict ...
Epoch: 5 cost time: 1.0278549194335938
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2736101 Best vali loss: 0.2736101
Updating learning rate to 7.389245612235406e-05
Epoch: 6 cost time: 1.0300030708312988
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2869069 Best vali loss: 0.2736101
Updating learning rate to 1.9204023659917115e-05
Epoch: 7 cost time: 1.023329496383667
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3010846 Best vali loss: 0.2736101
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0263164043426514
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3015085 Best vali loss: 0.2736101

best validation loss 0.27361005274236044

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0047541123502, 'e_layers': 4, 'learning_rate': 0.000507581349, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00048826268421278414
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.2442238330841064
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857483 Best vali loss: 0.2857483
Updating learning rate to 0.0004332477814408578
Epoch: 2 cost time: 1.0219368934631348
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2899997 Best vali loss: 0.2857483
Updating learning rate to 0.0003509121609199113
Epoch: 3 cost time: 1.021364450454712
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2871761 Best vali loss: 0.2857483

best validation loss 0.2857482970376004

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0091007474306, 'e_layers': 3, 'learning_rate': 0.0007507131799, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007221408607980368
Validation loss decreased (inf --> 0.2996).  Saving model state dict ...
Epoch: 1 cost time: 1.0327692031860352
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2996293 Best vali loss: 0.2996293
Updating learning rate to 0.0006407737800667033
Validation loss decreased (0.2996 --> 0.2840).  Saving model state dict ...
Epoch: 2 cost time: 0.8114371299743652
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2840273 Best vali loss: 0.2840273
Updating learning rate to 0.0005189993381529216
Epoch: 3 cost time: 0.8146347999572754
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2971808 Best vali loss: 0.2840273

best validation loss 0.2840273039087836

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014582878136, 'e_layers': 2, 'learning_rate': 7.1278721e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2954083
	speed: 0.0087s/iter; left time: 72.2029s
	iters: 200, epoch: 1 | loss: 1.0855620
	speed: 0.0034s/iter; left time: 27.4491s
	iters: 300, epoch: 1 | loss: 0.3196371
	speed: 0.0033s/iter; left time: 26.8136s
	iters: 400, epoch: 1 | loss: 0.3271403
	speed: 0.0033s/iter; left time: 26.4192s
	iters: 500, epoch: 1 | loss: 0.4672905
	speed: 0.0033s/iter; left time: 25.8588s
	iters: 600, epoch: 1 | loss: 0.3748662
	speed: 0.0033s/iter; left time: 25.7953s
	iters: 700, epoch: 1 | loss: 0.2005015
	speed: 0.0033s/iter; left time: 25.5812s
	iters: 800, epoch: 1 | loss: 1.5792720
	speed: 0.0033s/iter; left time: 25.1718s
	iters: 900, epoch: 1 | loss: 0.1743842
	speed: 0.0033s/iter; left time: 24.8597s
	iters: 1000, epoch: 1 | loss: 1.5130061
	speed: 0.0033s/iter; left time: 24.4859s
Updating learning rate to 7.1278721e-05
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 3.737945079803467
Epoch: 1, Steps: 1045 | Train Loss: 0.6337068 Vali Loss: 0.2809318 Best vali loss: 0.2809318
	iters: 100, epoch: 2 | loss: 0.3510657
	speed: 0.0098s/iter; left time: 71.0109s
	iters: 200, epoch: 2 | loss: 1.4845686
	speed: 0.0028s/iter; left time: 20.1865s
	iters: 300, epoch: 2 | loss: 1.7637012
	speed: 0.0028s/iter; left time: 19.8827s
	iters: 400, epoch: 2 | loss: 0.2811031
	speed: 0.0029s/iter; left time: 19.7646s
	iters: 500, epoch: 2 | loss: 0.3695255
	speed: 0.0029s/iter; left time: 19.5058s
	iters: 600, epoch: 2 | loss: 0.3033127
	speed: 0.0029s/iter; left time: 19.6567s
	iters: 700, epoch: 2 | loss: 0.2956249
	speed: 0.0028s/iter; left time: 18.7408s
	iters: 800, epoch: 2 | loss: 0.8796968
	speed: 0.0029s/iter; left time: 18.6693s
	iters: 900, epoch: 2 | loss: 0.2256880
	speed: 0.0029s/iter; left time: 18.8480s
	iters: 1000, epoch: 2 | loss: 1.0815486
	speed: 0.0030s/iter; left time: 19.2484s
Updating learning rate to 3.56393605e-05
Epoch: 2 cost time: 3.0628600120544434
Epoch: 2, Steps: 1045 | Train Loss: 0.7035835 Vali Loss: 0.2827592 Best vali loss: 0.2809318
	iters: 100, epoch: 3 | loss: 0.4136283
	speed: 0.0095s/iter; left time: 58.7370s
	iters: 200, epoch: 3 | loss: 0.3250759
	speed: 0.0031s/iter; left time: 18.5926s
	iters: 300, epoch: 3 | loss: 1.0196775
	speed: 0.0029s/iter; left time: 17.4145s
	iters: 400, epoch: 3 | loss: 0.8964386
	speed: 0.0029s/iter; left time: 17.0731s
	iters: 500, epoch: 3 | loss: 0.2008295
	speed: 0.0029s/iter; left time: 16.7375s
	iters: 600, epoch: 3 | loss: 0.2408644
	speed: 0.0029s/iter; left time: 16.6149s
	iters: 700, epoch: 3 | loss: 0.3081610
	speed: 0.0029s/iter; left time: 16.2758s
	iters: 800, epoch: 3 | loss: 0.4831722
	speed: 0.0029s/iter; left time: 15.8433s
	iters: 900, epoch: 3 | loss: 1.1347389
	speed: 0.0029s/iter; left time: 15.5433s
	iters: 1000, epoch: 3 | loss: 0.1743055
	speed: 0.0029s/iter; left time: 15.3282s
Updating learning rate to 1.781968025e-05
Validation loss decreased (0.2809 --> 0.2787).  Saving model state dict ...
Epoch: 3 cost time: 3.094006299972534
Epoch: 3, Steps: 1045 | Train Loss: 0.5196892 Vali Loss: 0.2786726 Best vali loss: 0.2786726

best validation loss 0.27867261072923455

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014582878136, 'e_layers': 2, 'learning_rate': 7.1278721e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2500642
	speed: 0.0087s/iter; left time: 44.7873s
	iters: 200, epoch: 4 | loss: 0.9945436
	speed: 0.0033s/iter; left time: 16.7394s
	iters: 300, epoch: 4 | loss: 0.3299164
	speed: 0.0033s/iter; left time: 16.3992s
	iters: 400, epoch: 4 | loss: 0.3070772
	speed: 0.0033s/iter; left time: 16.0771s
	iters: 500, epoch: 4 | loss: 0.2481712
	speed: 0.0034s/iter; left time: 15.8733s
	iters: 600, epoch: 4 | loss: 0.3784283
	speed: 0.0034s/iter; left time: 15.5824s
	iters: 700, epoch: 4 | loss: 0.1988164
	speed: 0.0034s/iter; left time: 15.2564s
	iters: 800, epoch: 4 | loss: 1.4184217
	speed: 0.0034s/iter; left time: 14.9228s
	iters: 900, epoch: 4 | loss: 0.1574606
	speed: 0.0033s/iter; left time: 14.4035s
	iters: 1000, epoch: 4 | loss: 0.9684072
	speed: 0.0033s/iter; left time: 13.8216s
Updating learning rate to 8.909840125e-06
Epoch: 4 cost time: 3.734783172607422
Epoch: 4, Steps: 1045 | Train Loss: 0.5251307 Vali Loss: 0.2802137 Best vali loss: 0.2786726
	iters: 100, epoch: 5 | loss: 0.3081887
	speed: 0.0100s/iter; left time: 40.9800s
	iters: 200, epoch: 5 | loss: 1.4397374
	speed: 0.0033s/iter; left time: 12.9754s
	iters: 300, epoch: 5 | loss: 1.5894459
	speed: 0.0033s/iter; left time: 12.7320s
	iters: 400, epoch: 5 | loss: 0.2863606
	speed: 0.0032s/iter; left time: 12.1361s
	iters: 500, epoch: 5 | loss: 0.3646705
	speed: 0.0031s/iter; left time: 11.5879s
	iters: 600, epoch: 5 | loss: 0.2707546
	speed: 0.0031s/iter; left time: 11.1817s
	iters: 700, epoch: 5 | loss: 0.2945061
	speed: 0.0031s/iter; left time: 10.8868s
	iters: 800, epoch: 5 | loss: 0.8456888
	speed: 0.0031s/iter; left time: 10.6079s
	iters: 900, epoch: 5 | loss: 0.2166910
	speed: 0.0031s/iter; left time: 10.2706s
	iters: 1000, epoch: 5 | loss: 1.0377468
	speed: 0.0031s/iter; left time: 9.9387s
Updating learning rate to 4.4549200625e-06
Epoch: 5 cost time: 3.353217601776123
Epoch: 5, Steps: 1045 | Train Loss: 0.6653790 Vali Loss: 0.2802554 Best vali loss: 0.2786726
	iters: 100, epoch: 6 | loss: 0.4061207
	speed: 0.0101s/iter; left time: 30.6821s
	iters: 200, epoch: 6 | loss: 0.3157024
	speed: 0.0033s/iter; left time: 9.7024s
	iters: 300, epoch: 6 | loss: 0.9501825
	speed: 0.0033s/iter; left time: 9.3907s
	iters: 400, epoch: 6 | loss: 0.8493681
	speed: 0.0033s/iter; left time: 9.0804s
	iters: 500, epoch: 6 | loss: 0.1742918
	speed: 0.0033s/iter; left time: 8.7488s
	iters: 600, epoch: 6 | loss: 0.2441376
	speed: 0.0033s/iter; left time: 8.3671s
	iters: 700, epoch: 6 | loss: 0.2895628
	speed: 0.0033s/iter; left time: 8.0828s
	iters: 800, epoch: 6 | loss: 0.4606787
	speed: 0.0033s/iter; left time: 7.7861s
	iters: 900, epoch: 6 | loss: 1.0145228
	speed: 0.0034s/iter; left time: 7.5527s
	iters: 1000, epoch: 6 | loss: 0.1589574
	speed: 0.0034s/iter; left time: 7.2529s
Updating learning rate to 2.22746003125e-06
Epoch: 6 cost time: 3.516038417816162
Epoch: 6, Steps: 1045 | Train Loss: 0.4863525 Vali Loss: 0.2796291 Best vali loss: 0.2786726
	iters: 100, epoch: 7 | loss: 0.2101714
	speed: 0.0103s/iter; left time: 20.5929s
	iters: 200, epoch: 7 | loss: 0.2917478
	speed: 0.0034s/iter; left time: 6.3558s
	iters: 300, epoch: 7 | loss: 0.4101770
	speed: 0.0033s/iter; left time: 5.9534s
	iters: 400, epoch: 7 | loss: 1.2298518
	speed: 0.0033s/iter; left time: 5.6387s
	iters: 500, epoch: 7 | loss: 1.5897675
	speed: 0.0033s/iter; left time: 5.3100s
	iters: 600, epoch: 7 | loss: 1.1063294
	speed: 0.0033s/iter; left time: 4.9498s
	iters: 700, epoch: 7 | loss: 0.8983482
	speed: 0.0032s/iter; left time: 4.4090s
	iters: 800, epoch: 7 | loss: 0.3508876
	speed: 0.0031s/iter; left time: 3.9622s
	iters: 900, epoch: 7 | loss: 0.6993216
	speed: 0.0031s/iter; left time: 3.6713s
	iters: 1000, epoch: 7 | loss: 1.0368319
	speed: 0.0031s/iter; left time: 3.3359s
Updating learning rate to 1.113730015625e-06
Epoch: 7 cost time: 3.4149372577667236
Epoch: 7, Steps: 1045 | Train Loss: 0.7823434 Vali Loss: 0.2793299 Best vali loss: 0.2786726
	iters: 100, epoch: 8 | loss: 0.3394273
	speed: 0.0097s/iter; left time: 9.1819s
	iters: 200, epoch: 8 | loss: 0.9517548
	speed: 0.0031s/iter; left time: 2.6031s
	iters: 300, epoch: 8 | loss: 0.4067243
	speed: 0.0031s/iter; left time: 2.2924s
	iters: 400, epoch: 8 | loss: 1.0967517
	speed: 0.0031s/iter; left time: 2.0239s
	iters: 500, epoch: 8 | loss: 0.3113226
	speed: 0.0031s/iter; left time: 1.6696s
	iters: 600, epoch: 8 | loss: 0.2358480
	speed: 0.0031s/iter; left time: 1.3759s
	iters: 700, epoch: 8 | loss: 0.3900721
	speed: 0.0030s/iter; left time: 1.0532s
	iters: 800, epoch: 8 | loss: 1.2122691
	speed: 0.0031s/iter; left time: 0.7612s
	iters: 900, epoch: 8 | loss: 0.3011045
	speed: 0.0032s/iter; left time: 0.4637s
	iters: 1000, epoch: 8 | loss: 1.2254566
	speed: 0.0030s/iter; left time: 0.1366s
Updating learning rate to 5.568650078125e-07
Epoch: 8 cost time: 3.244288682937622
Epoch: 8, Steps: 1045 | Train Loss: 0.6470731 Vali Loss: 0.2792193 Best vali loss: 0.2786726

best validation loss 0.27867261072923455

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0020774512103, 'e_layers': 2, 'learning_rate': 0.0018733449342, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3683015
	speed: 0.0087s/iter; left time: 17.3711s
	iters: 200, epoch: 1 | loss: 0.3936557
	speed: 0.0033s/iter; left time: 6.2788s
Updating learning rate to 0.0018020449881205416
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 1.1428203582763672
Epoch: 1, Steps: 262 | Train Loss: 0.3809786 Vali Loss: 0.2876529 Best vali loss: 0.2876529
	iters: 100, epoch: 2 | loss: 0.4123555
	speed: 0.0075s/iter; left time: 13.0642s
	iters: 200, epoch: 2 | loss: 1.1043555
	speed: 0.0032s/iter; left time: 5.1910s
Updating learning rate to 0.0015989999203371433
Validation loss decreased (0.2877 --> 0.2849).  Saving model state dict ...
Epoch: 2 cost time: 0.8694641590118408
Epoch: 2, Steps: 262 | Train Loss: 0.7583555 Vali Loss: 0.2849147 Best vali loss: 0.2849147
	iters: 100, epoch: 3 | loss: 0.6691493
	speed: 0.0075s/iter; left time: 11.0059s
	iters: 200, epoch: 3 | loss: 0.3361443
	speed: 0.0031s/iter; left time: 4.2956s
Updating learning rate to 0.0012951215018117046
Epoch: 3 cost time: 0.8668293952941895
Epoch: 3, Steps: 262 | Train Loss: 0.5026468 Vali Loss: 0.2975630 Best vali loss: 0.2849147
	iters: 100, epoch: 4 | loss: 0.5651755
	speed: 0.0072s/iter; left time: 8.7584s
	iters: 200, epoch: 4 | loss: 0.3566899
	speed: 0.0033s/iter; left time: 3.6568s
Updating learning rate to 0.0009366724671
Epoch: 4 cost time: 0.8975355625152588
Epoch: 4, Steps: 262 | Train Loss: 0.4609327 Vali Loss: 0.2912546 Best vali loss: 0.2849147
	iters: 100, epoch: 5 | loss: 0.4538685
	speed: 0.0074s/iter; left time: 6.9926s
	iters: 200, epoch: 5 | loss: 0.5266429
	speed: 0.0031s/iter; left time: 2.5923s
Updating learning rate to 0.0005782234323882954
Epoch: 5 cost time: 0.8485372066497803
Epoch: 5, Steps: 262 | Train Loss: 0.4902557 Vali Loss: 0.2969312 Best vali loss: 0.2849147
	iters: 100, epoch: 6 | loss: 0.4876574
	speed: 0.0075s/iter; left time: 5.1785s
	iters: 200, epoch: 6 | loss: 0.3811837
	speed: 0.0032s/iter; left time: 1.9016s
Updating learning rate to 0.0002743450138628567
Epoch: 6 cost time: 0.8929898738861084
Epoch: 6, Steps: 262 | Train Loss: 0.4344205 Vali Loss: 0.2963719 Best vali loss: 0.2849147
	iters: 100, epoch: 7 | loss: 0.5693784
	speed: 0.0073s/iter; left time: 3.1106s
	iters: 200, epoch: 7 | loss: 0.4347363
	speed: 0.0032s/iter; left time: 1.0331s
Updating learning rate to 7.12999460794584e-05
Epoch: 7 cost time: 0.8713817596435547
Epoch: 7, Steps: 262 | Train Loss: 0.5020574 Vali Loss: 0.2960139 Best vali loss: 0.2849147
	iters: 100, epoch: 8 | loss: 0.2248537
	speed: 0.0074s/iter; left time: 1.1986s
	iters: 200, epoch: 8 | loss: 0.3717726
	speed: 0.0032s/iter; left time: 0.1996s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.880112886428833
Epoch: 8, Steps: 262 | Train Loss: 0.2983131 Vali Loss: 0.3012069 Best vali loss: 0.2849147

best validation loss 0.2849146548635058

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022066877623, 'e_layers': 4, 'learning_rate': 0.0005134112974, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005134112974
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.2329387664794922
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856863 Best vali loss: 0.2856863
Updating learning rate to 0.0002567056487
Epoch: 2 cost time: 1.007918119430542
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2869303 Best vali loss: 0.2856863
Updating learning rate to 0.00012835282435
Epoch: 3 cost time: 1.008467674255371
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2976417 Best vali loss: 0.2856863
Updating learning rate to 6.4176412175e-05
Epoch: 4 cost time: 1.008713960647583
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3070312 Best vali loss: 0.2856863
Updating learning rate to 3.20882060875e-05
Epoch: 5 cost time: 1.0077791213989258
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3203279 Best vali loss: 0.2856863
Updating learning rate to 1.604410304375e-05
Epoch: 6 cost time: 1.0130834579467773
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3105371 Best vali loss: 0.2856863
Updating learning rate to 8.022051521875e-06
Epoch: 7 cost time: 1.0170152187347412
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3079820 Best vali loss: 0.2856863
Updating learning rate to 4.0110257609375e-06
Epoch: 8 cost time: 1.0191552639007568
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3112028 Best vali loss: 0.2856863

best validation loss 0.28568625665145453

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023485754123, 'e_layers': 4, 'learning_rate': 0.0005178746247, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005178746247
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.2318263053894043
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856679 Best vali loss: 0.2856679
Updating learning rate to 0.00025893731235
Epoch: 2 cost time: 1.009122610092163
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2967936 Best vali loss: 0.2856679
Updating learning rate to 0.000129468656175
Epoch: 3 cost time: 1.0145080089569092
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3316945 Best vali loss: 0.2856679

best validation loss 0.2856678991080128

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010308784231, 'e_layers': 1, 'learning_rate': 9.98838359e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6614959
	speed: 0.0078s/iter; left time: 31.6641s
	iters: 200, epoch: 1 | loss: 0.7977081
	speed: 0.0025s/iter; left time: 10.0541s
	iters: 300, epoch: 1 | loss: 0.3766426
	speed: 0.0025s/iter; left time: 9.8581s
	iters: 400, epoch: 1 | loss: 0.9780100
	speed: 0.0025s/iter; left time: 9.5464s
	iters: 500, epoch: 1 | loss: 0.2562494
	speed: 0.0027s/iter; left time: 9.9168s
Updating learning rate to 9.608223375836303e-05
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 1.5958755016326904
Epoch: 1, Steps: 523 | Train Loss: 0.6140212 Vali Loss: 0.2823304 Best vali loss: 0.2823304
	iters: 100, epoch: 2 | loss: 0.3549058
	speed: 0.0060s/iter; left time: 21.3898s
	iters: 200, epoch: 2 | loss: 0.7228528
	speed: 0.0025s/iter; left time: 8.7532s
	iters: 300, epoch: 2 | loss: 0.5758150
	speed: 0.0024s/iter; left time: 8.1716s
	iters: 400, epoch: 2 | loss: 1.6959147
	speed: 0.0022s/iter; left time: 7.0671s
	iters: 500, epoch: 2 | loss: 0.3495721
	speed: 0.0022s/iter; left time: 6.8323s
Updating learning rate to 8.525618679790715e-05
Validation loss decreased (0.2823 --> 0.2802).  Saving model state dict ...
Epoch: 2 cost time: 1.2640931606292725
Epoch: 2, Steps: 523 | Train Loss: 0.7398121 Vali Loss: 0.2801672 Best vali loss: 0.2801672
	iters: 100, epoch: 3 | loss: 0.2521558
	speed: 0.0052s/iter; left time: 15.9411s
	iters: 200, epoch: 3 | loss: 0.7690949
	speed: 0.0021s/iter; left time: 6.1557s
	iters: 300, epoch: 3 | loss: 0.2801207
	speed: 0.0023s/iter; left time: 6.5147s
	iters: 400, epoch: 3 | loss: 0.2089446
	speed: 0.0023s/iter; left time: 6.3506s
	iters: 500, epoch: 3 | loss: 0.4983949
	speed: 0.0023s/iter; left time: 6.0207s
Updating learning rate to 6.905386253000169e-05
Epoch: 3 cost time: 1.1932330131530762
Epoch: 3, Steps: 523 | Train Loss: 0.4017422 Vali Loss: 0.2824972 Best vali loss: 0.2801672

best validation loss 0.28016719387206235

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0015521320655, 'e_layers': 3, 'learning_rate': 0.0006597538329, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006597538329
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 0.6875195503234863
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2805738 Best vali loss: 0.2805738
Updating learning rate to 0.00032987691645
Epoch: 2 cost time: 0.46741390228271484
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2895552 Best vali loss: 0.2805738
Updating learning rate to 0.000164938458225
Epoch: 3 cost time: 0.4494304656982422
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2820876 Best vali loss: 0.2805738

best validation loss 0.2805737538069941

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010308784231, 'e_layers': 1, 'learning_rate': 9.98838359e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5873800
	speed: 0.0078s/iter; left time: 19.6123s
	iters: 200, epoch: 4 | loss: 0.7329234
	speed: 0.0023s/iter; left time: 5.6367s
	iters: 300, epoch: 4 | loss: 0.3511108
	speed: 0.0023s/iter; left time: 5.4118s
	iters: 400, epoch: 4 | loss: 0.9056544
	speed: 0.0023s/iter; left time: 5.1623s
	iters: 500, epoch: 4 | loss: 0.2563191
	speed: 0.0024s/iter; left time: 4.9915s
Updating learning rate to 4.994191795e-05
Epoch: 4 cost time: 1.4843924045562744
Epoch: 4, Steps: 523 | Train Loss: 0.5666775 Vali Loss: 0.2856429 Best vali loss: 0.2801672
	iters: 100, epoch: 5 | loss: 0.3404379
	speed: 0.0055s/iter; left time: 11.0272s
	iters: 200, epoch: 5 | loss: 0.6371307
	speed: 0.0021s/iter; left time: 4.0066s
	iters: 300, epoch: 5 | loss: 0.5625520
	speed: 0.0021s/iter; left time: 3.7977s
	iters: 400, epoch: 5 | loss: 1.5006706
	speed: 0.0023s/iter; left time: 3.9344s
	iters: 500, epoch: 5 | loss: 0.3414541
	speed: 0.0023s/iter; left time: 3.6789s
Updating learning rate to 3.082997336999831e-05
Epoch: 5 cost time: 1.1882948875427246
Epoch: 5, Steps: 523 | Train Loss: 0.6764490 Vali Loss: 0.2869867 Best vali loss: 0.2801672
	iters: 100, epoch: 6 | loss: 0.2213694
	speed: 0.0056s/iter; left time: 8.2155s
	iters: 200, epoch: 6 | loss: 0.7401564
	speed: 0.0024s/iter; left time: 3.2765s
	iters: 300, epoch: 6 | loss: 0.2549496
	speed: 0.0024s/iter; left time: 3.0217s
	iters: 400, epoch: 6 | loss: 0.2149550
	speed: 0.0024s/iter; left time: 2.8472s
	iters: 500, epoch: 6 | loss: 0.4631849
	speed: 0.0025s/iter; left time: 2.6506s
Updating learning rate to 1.4627649102092842e-05
Epoch: 6 cost time: 1.3006908893585205
Epoch: 6, Steps: 523 | Train Loss: 0.3789231 Vali Loss: 0.2870351 Best vali loss: 0.2801672
	iters: 100, epoch: 7 | loss: 0.9164107
	speed: 0.0058s/iter; left time: 5.4647s
	iters: 200, epoch: 7 | loss: 0.4327006
	speed: 0.0024s/iter; left time: 2.0269s
	iters: 300, epoch: 7 | loss: 0.7865021
	speed: 0.0024s/iter; left time: 1.7925s
	iters: 400, epoch: 7 | loss: 0.2233104
	speed: 0.0024s/iter; left time: 1.5588s
	iters: 500, epoch: 7 | loss: 0.3664924
	speed: 0.0024s/iter; left time: 1.3180s
Updating learning rate to 3.80160214163696e-06
Epoch: 7 cost time: 1.2953267097473145
Epoch: 7, Steps: 523 | Train Loss: 0.5450833 Vali Loss: 0.2891951 Best vali loss: 0.2801672
	iters: 100, epoch: 8 | loss: 0.2855875
	speed: 0.0057s/iter; left time: 2.4288s
	iters: 200, epoch: 8 | loss: 0.6286293
	speed: 0.0025s/iter; left time: 0.7989s
	iters: 300, epoch: 8 | loss: 0.9575995
	speed: 0.0025s/iter; left time: 0.5594s
	iters: 400, epoch: 8 | loss: 0.5291262
	speed: 0.0025s/iter; left time: 0.3110s
	iters: 500, epoch: 8 | loss: 0.2855299
	speed: 0.0025s/iter; left time: 0.0602s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3365139961242676
Epoch: 8, Steps: 523 | Train Loss: 0.5372945 Vali Loss: 0.2898387 Best vali loss: 0.2801672

best validation loss 0.28016719387206235

[INFO][smbo.py:320] Finished 1150 trials.
{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0118514408806, 'e_layers': 4, 'learning_rate': 0.0008020773021, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0008020773021
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 0.7026634216308594
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2839705 Best vali loss: 0.2839705
Updating learning rate to 0.00040103865105
Epoch: 2 cost time: 0.4226365089416504
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2851697 Best vali loss: 0.2839705
Updating learning rate to 0.000200519325525
Validation loss decreased (0.2840 --> 0.2833).  Saving model state dict ...
Epoch: 3 cost time: 0.45473670959472656
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2833441 Best vali loss: 0.2833441
Updating learning rate to 0.0001002596627625
Validation loss decreased (0.2833 --> 0.2826).  Saving model state dict ...
Epoch: 4 cost time: 0.42914414405822754
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2825776 Best vali loss: 0.2825776
Updating learning rate to 5.012983138125e-05
Epoch: 5 cost time: 0.4602372646331787
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2837159 Best vali loss: 0.2825776
Updating learning rate to 2.5064915690625e-05
Epoch: 6 cost time: 0.4503040313720703
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2831068 Best vali loss: 0.2825776
Updating learning rate to 1.25324578453125e-05
Epoch: 7 cost time: 0.43857383728027344
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2835685 Best vali loss: 0.2825776
Updating learning rate to 6.26622892265625e-06
Epoch: 8 cost time: 0.44994425773620605
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2836045 Best vali loss: 0.2825776

best validation loss 0.2825775705762803

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0016448986355, 'e_layers': 2, 'learning_rate': 0.002935116587, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7316332
	speed: 0.0089s/iter; left time: 17.7283s
	iters: 200, epoch: 1 | loss: 0.8114967
	speed: 0.0036s/iter; left time: 6.8943s
Updating learning rate to 0.002935116587
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 1.216325283050537
Epoch: 1, Steps: 262 | Train Loss: 0.7715649 Vali Loss: 0.3112451 Best vali loss: 0.3112451
	iters: 100, epoch: 2 | loss: 0.3651781
	speed: 0.0083s/iter; left time: 14.3435s
	iters: 200, epoch: 2 | loss: 0.6507355
	speed: 0.0037s/iter; left time: 6.0579s
Updating learning rate to 0.0014675582935
Validation loss decreased (0.3112 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 1.0149455070495605
Epoch: 2, Steps: 262 | Train Loss: 0.5079568 Vali Loss: 0.2870558 Best vali loss: 0.2870558
	iters: 100, epoch: 3 | loss: 0.6203583
	speed: 0.0082s/iter; left time: 12.0375s
	iters: 200, epoch: 3 | loss: 0.4022687
	speed: 0.0036s/iter; left time: 4.9017s
Updating learning rate to 0.00073377914675
Epoch: 3 cost time: 0.9764969348907471
Epoch: 3, Steps: 262 | Train Loss: 0.5113135 Vali Loss: 0.2938656 Best vali loss: 0.2870558
	iters: 100, epoch: 4 | loss: 0.3227341
	speed: 0.0078s/iter; left time: 9.4392s
	iters: 200, epoch: 4 | loss: 0.5451958
	speed: 0.0031s/iter; left time: 3.4595s
Updating learning rate to 0.000366889573375
Epoch: 4 cost time: 0.8807759284973145
Epoch: 4, Steps: 262 | Train Loss: 0.4339650 Vali Loss: 0.3005999 Best vali loss: 0.2870558
	iters: 100, epoch: 5 | loss: 0.3590211
	speed: 0.0075s/iter; left time: 7.1396s
	iters: 200, epoch: 5 | loss: 0.4830900
	speed: 0.0032s/iter; left time: 2.6877s
Updating learning rate to 0.0001834447866875
Epoch: 5 cost time: 0.8713860511779785
Epoch: 5, Steps: 262 | Train Loss: 0.4210555 Vali Loss: 0.3110505 Best vali loss: 0.2870558
	iters: 100, epoch: 6 | loss: 0.5420287
	speed: 0.0074s/iter; left time: 5.1134s
	iters: 200, epoch: 6 | loss: 0.3751135
	speed: 0.0032s/iter; left time: 1.8760s
Updating learning rate to 9.172239334375e-05
Epoch: 6 cost time: 0.8979465961456299
Epoch: 6, Steps: 262 | Train Loss: 0.4585711 Vali Loss: 0.3009612 Best vali loss: 0.2870558
	iters: 100, epoch: 7 | loss: 0.4967301
	speed: 0.0079s/iter; left time: 3.3698s
	iters: 200, epoch: 7 | loss: 0.4305762
	speed: 0.0038s/iter; left time: 1.2498s
Updating learning rate to 4.5861196671875e-05
Epoch: 7 cost time: 1.0398976802825928
Epoch: 7, Steps: 262 | Train Loss: 0.4636531 Vali Loss: 0.3067314 Best vali loss: 0.2870558
	iters: 100, epoch: 8 | loss: 0.3530413
	speed: 0.0082s/iter; left time: 1.3424s
	iters: 200, epoch: 8 | loss: 0.3066667
	speed: 0.0036s/iter; left time: 0.2270s
Updating learning rate to 2.29305983359375e-05
Epoch: 8 cost time: 0.9711596965789795
Epoch: 8, Steps: 262 | Train Loss: 0.3298540 Vali Loss: 0.3097065 Best vali loss: 0.2870558

best validation loss 0.2870557858359641

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020718476285, 'e_layers': 4, 'learning_rate': 0.0005079618929, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004886287445230001
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.2553157806396484
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2855591 Best vali loss: 0.2855591
Updating learning rate to 0.0004335725959769723
Epoch: 2 cost time: 1.0151894092559814
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2931716 Best vali loss: 0.2855591
Updating learning rate to 0.00035117524679282
Validation loss decreased (0.2856 --> 0.2804).  Saving model state dict ...
Epoch: 3 cost time: 1.0114870071411133
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2803836 Best vali loss: 0.2803836

best validation loss 0.28038358319288914

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0020743997701, 'e_layers': 4, 'learning_rate': 0.0009438502875, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009079271249380718
Validation loss decreased (inf --> 0.2989).  Saving model state dict ...
Epoch: 1 cost time: 0.9686644077301025
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2988858 Best vali loss: 0.2988858
Updating learning rate to 0.0008056266131080612
Validation loss decreased (0.2989 --> 0.2823).  Saving model state dict ...
Epoch: 2 cost time: 0.7109005451202393
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2822518 Best vali loss: 0.2822518
Updating learning rate to 0.0006525230775796385
Validation loss decreased (0.2823 --> 0.2822).  Saving model state dict ...
Epoch: 3 cost time: 0.7196195125579834
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2822462 Best vali loss: 0.2822462

best validation loss 0.282246205200711

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0020073606234, 'e_layers': 4, 'learning_rate': 0.0009999327675, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009618750926403086
Validation loss decreased (inf --> 0.3011).  Saving model state dict ...
Epoch: 1 cost time: 0.9534811973571777
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3011420 Best vali loss: 0.3011420
Updating learning rate to 0.0008534960040649407
Validation loss decreased (0.3011 --> 0.2872).  Saving model state dict ...
Epoch: 2 cost time: 0.711052417755127
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2871920 Best vali loss: 0.2871920
Updating learning rate to 0.0006912952355506117
Validation loss decreased (0.2872 --> 0.2723).  Saving model state dict ...
Epoch: 3 cost time: 0.7193577289581299
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2723087 Best vali loss: 0.2723087

best validation loss 0.2723086938489188

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0020073606234, 'e_layers': 4, 'learning_rate': 0.0009999327675, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00049996638375
Epoch: 4 cost time: 0.9529383182525635
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2790013 Best vali loss: 0.2723087
Updating learning rate to 0.0003086375319493884
Epoch: 5 cost time: 0.7096667289733887
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2877630 Best vali loss: 0.2723087
Updating learning rate to 0.00014643676343505934
Epoch: 6 cost time: 0.7148993015289307
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2854607 Best vali loss: 0.2723087
Updating learning rate to 3.8057674859691416e-05
Epoch: 7 cost time: 0.7110447883605957
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2888320 Best vali loss: 0.2723087
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7182004451751709
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2958014 Best vali loss: 0.2723087

best validation loss 0.2723086938489188

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0020711619401, 'e_layers': 4, 'learning_rate': 0.0008253090562, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007938976006096937
Validation loss decreased (inf --> 0.3019).  Saving model state dict ...
Epoch: 1 cost time: 0.9569149017333984
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3019007 Best vali loss: 0.3019007
Updating learning rate to 0.0007044453432068447
Validation loss decreased (0.3019 --> 0.2844).  Saving model state dict ...
Epoch: 2 cost time: 0.7162690162658691
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2843872 Best vali loss: 0.2843872
Updating learning rate to 0.0005705705792943044
Validation loss decreased (0.2844 --> 0.2742).  Saving model state dict ...
Epoch: 3 cost time: 0.7154150009155273
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2742118 Best vali loss: 0.2742118
Updating learning rate to 0.0004126545281
Epoch: 4 cost time: 0.7219505310058594
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2814573 Best vali loss: 0.2742118
Updating learning rate to 0.00025473847690569567
Epoch: 5 cost time: 0.7242927551269531
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2891727 Best vali loss: 0.2742118
Updating learning rate to 0.0001208637129931553
Epoch: 6 cost time: 0.7208139896392822
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2882917 Best vali loss: 0.2742118
Updating learning rate to 3.141145559030637e-05
Epoch: 7 cost time: 0.7280521392822266
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2946384 Best vali loss: 0.2742118
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7244806289672852
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2955372 Best vali loss: 0.2742118

best validation loss 0.27421175576843443

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054358322131, 'e_layers': 1, 'learning_rate': 0.0001130266673, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4503764
	speed: 0.0087s/iter; left time: 8.2499s
Updating learning rate to 0.00010872484592321637
Validation loss decreased (inf --> 0.2830).  Saving model state dict ...
Epoch: 1 cost time: 0.6892812252044678
Epoch: 1, Steps: 131 | Train Loss: 0.4503764 Vali Loss: 0.2830191 Best vali loss: 0.2830191
	iters: 100, epoch: 2 | loss: 0.4644930
	speed: 0.0054s/iter; left time: 4.4004s
Updating learning rate to 9.64742951013729e-05
Validation loss decreased (0.2830 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 0.3850421905517578
Epoch: 2, Steps: 131 | Train Loss: 0.4644930 Vali Loss: 0.2793650 Best vali loss: 0.2793650
	iters: 100, epoch: 3 | loss: 0.4207793
	speed: 0.0057s/iter; left time: 3.8924s
Updating learning rate to 7.814005014557554e-05
Epoch: 3 cost time: 0.43691563606262207
Epoch: 3, Steps: 131 | Train Loss: 0.4207793 Vali Loss: 0.2802113 Best vali loss: 0.2793650
	iters: 100, epoch: 4 | loss: 0.4667860
	speed: 0.0055s/iter; left time: 3.0638s
Updating learning rate to 5.651333365e-05
Validation loss decreased (0.2794 --> 0.2773).  Saving model state dict ...
Epoch: 4 cost time: 0.4212033748626709
Epoch: 4, Steps: 131 | Train Loss: 0.4667860 Vali Loss: 0.2773251 Best vali loss: 0.2773251
	iters: 100, epoch: 5 | loss: 0.4982420
	speed: 0.0055s/iter; left time: 2.3425s
Updating learning rate to 3.488661715442448e-05
Epoch: 5 cost time: 0.40860605239868164
Epoch: 5, Steps: 131 | Train Loss: 0.4982420 Vali Loss: 0.2805843 Best vali loss: 0.2773251
	iters: 100, epoch: 6 | loss: 0.5874751
	speed: 0.0056s/iter; left time: 1.6604s
Updating learning rate to 1.65523721986271e-05
Epoch: 6 cost time: 0.4400298595428467
Epoch: 6, Steps: 131 | Train Loss: 0.5874751 Vali Loss: 0.2793233 Best vali loss: 0.2773251
	iters: 100, epoch: 7 | loss: 0.5055488
	speed: 0.0055s/iter; left time: 0.8915s
Updating learning rate to 4.3018213767836305e-06
Epoch: 7 cost time: 0.4184856414794922
Epoch: 7, Steps: 131 | Train Loss: 0.5055488 Vali Loss: 0.2783085 Best vali loss: 0.2773251
	iters: 100, epoch: 8 | loss: 0.4108672
	speed: 0.0054s/iter; left time: 0.1728s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4008815288543701
Epoch: 8, Steps: 131 | Train Loss: 0.4108672 Vali Loss: 0.2782858 Best vali loss: 0.2773251

best validation loss 0.2773250783185792

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0019874824667, 'e_layers': 4, 'learning_rate': 0.0009487683739, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009487683739
Validation loss decreased (inf --> 0.2988).  Saving model state dict ...
Epoch: 1 cost time: 0.9439589977264404
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2987888 Best vali loss: 0.2987888
Updating learning rate to 0.00047438418695
Validation loss decreased (0.2988 --> 0.2821).  Saving model state dict ...
Epoch: 2 cost time: 0.7182309627532959
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2821109 Best vali loss: 0.2821109
Updating learning rate to 0.000237192093475
Validation loss decreased (0.2821 --> 0.2752).  Saving model state dict ...
Epoch: 3 cost time: 0.7239470481872559
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2752064 Best vali loss: 0.2752064

best validation loss 0.27520643374697346

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0019742140643, 'e_layers': 4, 'learning_rate': 0.0008287902144, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008287902144
Validation loss decreased (inf --> 0.3020).  Saving model state dict ...
Epoch: 1 cost time: 0.948784351348877
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3020254 Best vali loss: 0.3020254
Updating learning rate to 0.0004143951072
Validation loss decreased (0.3020 --> 0.2802).  Saving model state dict ...
Epoch: 2 cost time: 0.7207226753234863
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2801980 Best vali loss: 0.2801980
Updating learning rate to 0.0002071975536
Validation loss decreased (0.2802 --> 0.2801).  Saving model state dict ...
Epoch: 3 cost time: 0.7210812568664551
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2800917 Best vali loss: 0.2800917

best validation loss 0.2800917008766325

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021086241016, 'e_layers': 3, 'learning_rate': 0.0004748476954, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5192689
	speed: 0.0122s/iter; left time: 11.6024s
Updating learning rate to 0.0004567748811201069
Validation loss decreased (inf --> 0.2689).  Saving model state dict ...
Epoch: 1 cost time: 1.1561126708984375
Epoch: 1, Steps: 131 | Train Loss: 0.5192689 Vali Loss: 0.2688601 Best vali loss: 0.2688601
	iters: 100, epoch: 2 | loss: 0.5339792
	speed: 0.0113s/iter; left time: 9.2480s
Updating learning rate to 0.00040530786042407204
Epoch: 2 cost time: 0.9107940196990967
Epoch: 2, Steps: 131 | Train Loss: 0.5339792 Vali Loss: 0.2860331 Best vali loss: 0.2688601
	iters: 100, epoch: 3 | loss: 0.5422429
	speed: 0.0110s/iter; left time: 7.5848s
Updating learning rate to 0.0003282820206631623
Epoch: 3 cost time: 0.9192121028900146
Epoch: 3, Steps: 131 | Train Loss: 0.5422429 Vali Loss: 0.2873501 Best vali loss: 0.2688601

best validation loss 0.2688601235666874

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021086241016, 'e_layers': 3, 'learning_rate': 0.0004748476954, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3623826
	speed: 0.0125s/iter; left time: 6.9758s
Updating learning rate to 0.0002374238477
Epoch: 4 cost time: 1.156095027923584
Epoch: 4, Steps: 131 | Train Loss: 0.3623826 Vali Loss: 0.2810968 Best vali loss: 0.2688601
	iters: 100, epoch: 5 | loss: 0.3175769
	speed: 0.0111s/iter; left time: 4.7072s
Updating learning rate to 0.00014656567473683767
Epoch: 5 cost time: 0.9140303134918213
Epoch: 5, Steps: 131 | Train Loss: 0.3175769 Vali Loss: 0.2894705 Best vali loss: 0.2688601
	iters: 100, epoch: 6 | loss: 0.3395327
	speed: 0.0110s/iter; left time: 3.2324s
Updating learning rate to 6.953983497592793e-05
Epoch: 6 cost time: 0.9126818180084229
Epoch: 6, Steps: 131 | Train Loss: 0.3395327 Vali Loss: 0.3016192 Best vali loss: 0.2688601
	iters: 100, epoch: 7 | loss: 0.2376708
	speed: 0.0112s/iter; left time: 1.8187s
Updating learning rate to 1.8072814279893058e-05
Epoch: 7 cost time: 0.9204692840576172
Epoch: 7, Steps: 131 | Train Loss: 0.2376708 Vali Loss: 0.3164099 Best vali loss: 0.2688601
	iters: 100, epoch: 8 | loss: 0.2656786
	speed: 0.0112s/iter; left time: 0.3581s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.915485143661499
Epoch: 8, Steps: 131 | Train Loss: 0.2656786 Vali Loss: 0.3184485 Best vali loss: 0.2688601

best validation loss 0.2688601235666874

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270163229, 'e_layers': 2, 'learning_rate': 0.0002345285984, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002345285984
Validation loss decreased (inf --> 0.2760).  Saving model state dict ...
Epoch: 1 cost time: 0.7851929664611816
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2760462 Best vali loss: 0.2760462
Updating learning rate to 0.0001172642992
Validation loss decreased (0.2760 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 0.5492644309997559
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2742151 Best vali loss: 0.2742151
Updating learning rate to 5.86321496e-05
Validation loss decreased (0.2742 --> 0.2734).  Saving model state dict ...
Epoch: 3 cost time: 0.5576837062835693
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2733648 Best vali loss: 0.2733648
Updating learning rate to 2.93160748e-05
Epoch: 4 cost time: 0.5565228462219238
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2822047 Best vali loss: 0.2733648
Updating learning rate to 1.46580374e-05
Epoch: 5 cost time: 0.5515909194946289
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2879556 Best vali loss: 0.2733648
Updating learning rate to 7.3290187e-06
Epoch: 6 cost time: 0.5523877143859863
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2850483 Best vali loss: 0.2733648
Updating learning rate to 3.66450935e-06
Epoch: 7 cost time: 0.5467488765716553
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2872539 Best vali loss: 0.2733648
Updating learning rate to 1.832254675e-06
Epoch: 8 cost time: 0.5497255325317383
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2892478 Best vali loss: 0.2733648

best validation loss 0.27336482567918396

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0013521167874, 'e_layers': 4, 'learning_rate': 0.0023142680228, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.002226186440905142
Validation loss decreased (inf --> 0.2904).  Saving model state dict ...
Epoch: 1 cost time: 0.6845684051513672
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2903967 Best vali loss: 0.2903967
Updating learning rate to 0.0019753513176025317
Validation loss decreased (0.2904 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 0.4312899112701416
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2818201 Best vali loss: 0.2818201
Updating learning rate to 0.0015999500265889372
Epoch: 3 cost time: 0.4318573474884033
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2908354 Best vali loss: 0.2818201
Updating learning rate to 0.0011571340114
Epoch: 4 cost time: 0.42877936363220215
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2938275 Best vali loss: 0.2818201
Updating learning rate to 0.0007143179962110632
Epoch: 5 cost time: 0.4469945430755615
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2915227 Best vali loss: 0.2818201
Updating learning rate to 0.0003389167051974683
Epoch: 6 cost time: 0.40897345542907715
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2943612 Best vali loss: 0.2818201
Updating learning rate to 8.808158189485806e-05
Epoch: 7 cost time: 0.4157226085662842
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2971885 Best vali loss: 0.2818201
Updating learning rate to 0.0
Epoch: 8 cost time: 0.44858622550964355
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3009959 Best vali loss: 0.2818201

best validation loss 0.2818200896335118

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.002077946506, 'e_layers': 4, 'learning_rate': 0.0008885515024, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008885515024
Validation loss decreased (inf --> 0.2920).  Saving model state dict ...
Epoch: 1 cost time: 0.6730754375457764
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2920475 Best vali loss: 0.2920475
Updating learning rate to 0.0004442757512
Validation loss decreased (0.2920 --> 0.2817).  Saving model state dict ...
Epoch: 2 cost time: 0.4607717990875244
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2817069 Best vali loss: 0.2817069
Updating learning rate to 0.0002221378756
Epoch: 3 cost time: 0.42325377464294434
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2832295 Best vali loss: 0.2817069

best validation loss 0.28170688000364613

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001026167583, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597242
	speed: 0.0105s/iter; left time: 9.9295s
Updating learning rate to 0.00022560081023737435
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9350049495697021
Epoch: 1, Steps: 131 | Train Loss: 0.5597242 Vali Loss: 0.2756478 Best vali loss: 0.2756478
	iters: 100, epoch: 2 | loss: 0.3236870
	speed: 0.0088s/iter; left time: 7.2371s
Updating learning rate to 0.00020018128291779717
Validation loss decreased (0.2756 --> 0.2716).  Saving model state dict ...
Epoch: 2 cost time: 0.7020769119262695
Epoch: 2, Steps: 131 | Train Loss: 0.3236870 Vali Loss: 0.2715607 Best vali loss: 0.2715607
	iters: 100, epoch: 3 | loss: 0.4605071
	speed: 0.0089s/iter; left time: 6.1161s
Updating learning rate to 0.00016213827184708514
Epoch: 3 cost time: 0.7002513408660889
Epoch: 3, Steps: 131 | Train Loss: 0.4605071 Vali Loss: 0.2804220 Best vali loss: 0.2715607

best validation loss 0.27156068317594917

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020807779969, 'e_layers': 2, 'learning_rate': 0.0005803793035, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005582899315484031
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 0.614750862121582
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2841992 Best vali loss: 0.2841992
Updating learning rate to 0.0004953847223325876
Validation loss decreased (0.2842 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 0.3759472370147705
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2829092 Best vali loss: 0.2829092
Updating learning rate to 0.0004012404237185201
Epoch: 3 cost time: 0.38453245162963867
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2896106 Best vali loss: 0.2829092

best validation loss 0.2829092409906444

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001026167583, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4163880
	speed: 0.0109s/iter; left time: 6.0639s
Updating learning rate to 0.0001172634806
Epoch: 4 cost time: 0.9312076568603516
Epoch: 4, Steps: 131 | Train Loss: 0.4163880 Vali Loss: 0.2906370 Best vali loss: 0.2715607
	iters: 100, epoch: 5 | loss: 0.2682770
	speed: 0.0086s/iter; left time: 3.6688s
Updating learning rate to 7.238868935291489e-05
Epoch: 5 cost time: 0.7005054950714111
Epoch: 5, Steps: 131 | Train Loss: 0.2682770 Vali Loss: 0.2895497 Best vali loss: 0.2715607
	iters: 100, epoch: 6 | loss: 0.3769566
	speed: 0.0086s/iter; left time: 2.5422s
Updating learning rate to 3.434567828220285e-05
Epoch: 6 cost time: 0.7001335620880127
Epoch: 6, Steps: 131 | Train Loss: 0.3769566 Vali Loss: 0.2976267 Best vali loss: 0.2715607
	iters: 100, epoch: 7 | loss: 0.4003962
	speed: 0.0085s/iter; left time: 1.3893s
Updating learning rate to 8.92615096262566e-06
Epoch: 7 cost time: 0.6971712112426758
Epoch: 7, Steps: 131 | Train Loss: 0.4003962 Vali Loss: 0.3077119 Best vali loss: 0.2715607
	iters: 100, epoch: 8 | loss: 0.3000050
	speed: 0.0087s/iter; left time: 0.2788s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7012495994567871
Epoch: 8, Steps: 131 | Train Loss: 0.3000050 Vali Loss: 0.3068761 Best vali loss: 0.2715607

best validation loss 0.27156068317594917

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020763981402, 'e_layers': 2, 'learning_rate': 0.0005348554993, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005348554993
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 0.6156549453735352
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2844100 Best vali loss: 0.2844100
Updating learning rate to 0.00026742774965
Validation loss decreased (0.2844 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 0.374927282333374
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2824475 Best vali loss: 0.2824475
Updating learning rate to 0.000133713874825
Epoch: 3 cost time: 0.38100194931030273
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2857896 Best vali loss: 0.2824475
Updating learning rate to 6.68569374125e-05
Epoch: 4 cost time: 0.3787655830383301
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2839629 Best vali loss: 0.2824475
Updating learning rate to 3.342846870625e-05
Validation loss decreased (0.2824 --> 0.2819).  Saving model state dict ...
Epoch: 5 cost time: 0.3739621639251709
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2819042 Best vali loss: 0.2819042
Updating learning rate to 1.6714234353125e-05
Validation loss decreased (0.2819 --> 0.2813).  Saving model state dict ...
Epoch: 6 cost time: 0.37906813621520996
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2812564 Best vali loss: 0.2812564
Updating learning rate to 8.3571171765625e-06
Validation loss decreased (0.2813 --> 0.2805).  Saving model state dict ...
Epoch: 7 cost time: 0.3807060718536377
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2804714 Best vali loss: 0.2804714
Updating learning rate to 4.17855858828125e-06
Epoch: 8 cost time: 0.37341809272766113
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2817233 Best vali loss: 0.2804714

best validation loss 0.28047144340954555

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0074247556484, 'e_layers': 3, 'learning_rate': 0.0004761629314, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5249690
	speed: 0.0123s/iter; left time: 11.6346s
Updating learning rate to 0.00045804005893051796
Validation loss decreased (inf --> 0.2711).  Saving model state dict ...
Epoch: 1 cost time: 1.1529231071472168
Epoch: 1, Steps: 131 | Train Loss: 0.5249690 Vali Loss: 0.2711412 Best vali loss: 0.2711412
	iters: 100, epoch: 2 | loss: 0.5526053
	speed: 0.0113s/iter; left time: 9.2804s
Updating learning rate to 0.0004064304845713024
Validation loss decreased (0.2711 --> 0.2707).  Saving model state dict ...
Epoch: 2 cost time: 0.9177532196044922
Epoch: 2, Steps: 131 | Train Loss: 0.5526053 Vali Loss: 0.2706754 Best vali loss: 0.2706754
	iters: 100, epoch: 3 | loss: 0.4963929
	speed: 0.0113s/iter; left time: 7.7763s
Updating learning rate to 0.0003291912981765874
Epoch: 3 cost time: 0.9042177200317383
Epoch: 3, Steps: 131 | Train Loss: 0.4963929 Vali Loss: 0.2775687 Best vali loss: 0.2706754
	iters: 100, epoch: 4 | loss: 0.3054891
	speed: 0.0110s/iter; left time: 6.1058s
Updating learning rate to 0.0002380814657
Epoch: 4 cost time: 0.9111227989196777
Epoch: 4, Steps: 131 | Train Loss: 0.3054891 Vali Loss: 0.2866855 Best vali loss: 0.2706754
	iters: 100, epoch: 5 | loss: 0.3032462
	speed: 0.0110s/iter; left time: 4.6676s
Updating learning rate to 0.00014697163322341261
Epoch: 5 cost time: 0.9129681587219238
Epoch: 5, Steps: 131 | Train Loss: 0.3032462 Vali Loss: 0.3020532 Best vali loss: 0.2706754
	iters: 100, epoch: 6 | loss: 0.2959245
	speed: 0.0110s/iter; left time: 3.2450s
Updating learning rate to 6.97324468286976e-05
Epoch: 6 cost time: 0.9099469184875488
Epoch: 6, Steps: 131 | Train Loss: 0.2959245 Vali Loss: 0.3184548 Best vali loss: 0.2706754
	iters: 100, epoch: 7 | loss: 0.3364431
	speed: 0.0111s/iter; left time: 1.8144s
Updating learning rate to 1.812287246948205e-05
Epoch: 7 cost time: 0.9157602787017822
Epoch: 7, Steps: 131 | Train Loss: 0.3364431 Vali Loss: 0.3263693 Best vali loss: 0.2706754
	iters: 100, epoch: 8 | loss: 0.2879710
	speed: 0.0110s/iter; left time: 0.3520s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9111595153808594
Epoch: 8, Steps: 131 | Train Loss: 0.2879710 Vali Loss: 0.3291855 Best vali loss: 0.2706754

best validation loss 0.2706754257817302

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024525385935, 'e_layers': 3, 'learning_rate': 0.0004611137882, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5205106
	speed: 0.0122s/iter; left time: 11.5797s
Updating learning rate to 0.0004435636896383622
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 1.156879186630249
Epoch: 1, Steps: 131 | Train Loss: 0.5205106 Vali Loss: 0.2838097 Best vali loss: 0.2838097
	iters: 100, epoch: 2 | loss: 0.6166322
	speed: 0.0114s/iter; left time: 9.2991s
Updating learning rate to 0.0003935852373674187
Validation loss decreased (0.2838 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.9186358451843262
Epoch: 2, Steps: 131 | Train Loss: 0.6166322 Vali Loss: 0.2826557 Best vali loss: 0.2826557
	iters: 100, epoch: 3 | loss: 0.6849971
	speed: 0.0115s/iter; left time: 7.8925s
Updating learning rate to 0.0003187871976896225
Epoch: 3 cost time: 0.9128410816192627
Epoch: 3, Steps: 131 | Train Loss: 0.6849971 Vali Loss: 0.2870924 Best vali loss: 0.2826557

best validation loss 0.2826557056573121

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019927071312, 'e_layers': 3, 'learning_rate': 0.0004646360892, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5206435
	speed: 0.0121s/iter; left time: 11.4612s
Updating learning rate to 0.0004469519310389843
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 1.1448323726654053
Epoch: 1, Steps: 131 | Train Loss: 0.5206435 Vali Loss: 0.2894606 Best vali loss: 0.2894606
	iters: 100, epoch: 2 | loss: 0.5798997
	speed: 0.0113s/iter; left time: 9.2450s
Updating learning rate to 0.0003965917093286588
Epoch: 2 cost time: 0.9111013412475586
Epoch: 2, Steps: 131 | Train Loss: 0.5798997 Vali Loss: 0.2927529 Best vali loss: 0.2894606
	iters: 100, epoch: 3 | loss: 0.6147891
	speed: 0.0110s/iter; left time: 7.5289s
Updating learning rate to 0.00032122231130787403
Epoch: 3 cost time: 0.9137454032897949
Epoch: 3, Steps: 131 | Train Loss: 0.6147891 Vali Loss: 0.3011287 Best vali loss: 0.2894606

best validation loss 0.2894606431783376

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.002092587218, 'e_layers': 3, 'learning_rate': 0.0004616394224, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5216377
	speed: 0.0121s/iter; left time: 11.4814s
Updating learning rate to 0.0004440693180778462
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 1.1477527618408203
Epoch: 1, Steps: 131 | Train Loss: 0.5216377 Vali Loss: 0.2838199 Best vali loss: 0.2838199
	iters: 100, epoch: 2 | loss: 0.5333928
	speed: 0.0114s/iter; left time: 9.3464s
Updating learning rate to 0.00039403389422104044
Validation loss decreased (0.2838 --> 0.2831).  Saving model state dict ...
Epoch: 2 cost time: 0.9169278144836426
Epoch: 2, Steps: 131 | Train Loss: 0.5333928 Vali Loss: 0.2830737 Best vali loss: 0.2830737
	iters: 100, epoch: 3 | loss: 0.5256207
	speed: 0.0114s/iter; left time: 7.8219s
Updating learning rate to 0.00031915059053953473
Epoch: 3 cost time: 0.9135622978210449
Epoch: 3, Steps: 131 | Train Loss: 0.5256207 Vali Loss: 0.2866501 Best vali loss: 0.2830737

best validation loss 0.28307367861825056

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024525385935, 'e_layers': 3, 'learning_rate': 0.0004611137882, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3578999
	speed: 0.0126s/iter; left time: 7.0167s
Updating learning rate to 0.0002305568941
Epoch: 4 cost time: 1.1615283489227295
Epoch: 4, Steps: 131 | Train Loss: 0.3578999 Vali Loss: 0.2891673 Best vali loss: 0.2826557
	iters: 100, epoch: 5 | loss: 0.3264579
	speed: 0.0110s/iter; left time: 4.6937s
Updating learning rate to 0.00014232659051037749
Epoch: 5 cost time: 0.9081130027770996
Epoch: 5, Steps: 131 | Train Loss: 0.3264579 Vali Loss: 0.3026743 Best vali loss: 0.2826557
	iters: 100, epoch: 6 | loss: 0.3567807
	speed: 0.0111s/iter; left time: 3.2616s
Updating learning rate to 6.75285508325813e-05
Epoch: 6 cost time: 0.9188315868377686
Epoch: 6, Steps: 131 | Train Loss: 0.3567807 Vali Loss: 0.3092931 Best vali loss: 0.2826557
	iters: 100, epoch: 7 | loss: 0.2499985
	speed: 0.0111s/iter; left time: 1.8039s
Updating learning rate to 1.7550098561637757e-05
Epoch: 7 cost time: 0.9130961894989014
Epoch: 7, Steps: 131 | Train Loss: 0.2499985 Vali Loss: 0.3170284 Best vali loss: 0.2826557
	iters: 100, epoch: 8 | loss: 0.2723626
	speed: 0.0111s/iter; left time: 0.3553s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9145538806915283
Epoch: 8, Steps: 131 | Train Loss: 0.2723626 Vali Loss: 0.3233682 Best vali loss: 0.2826557

best validation loss 0.2826557056573121

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0093955994224, 'e_layers': 3, 'learning_rate': 0.0011166146534, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3290994
	speed: 0.0093s/iter; left time: 37.9606s
	iters: 200, epoch: 1 | loss: 0.6851377
	speed: 0.0042s/iter; left time: 16.6291s
	iters: 300, epoch: 1 | loss: 1.6742522
	speed: 0.0041s/iter; left time: 16.0521s
	iters: 400, epoch: 1 | loss: 0.4534346
	speed: 0.0041s/iter; left time: 15.5809s
	iters: 500, epoch: 1 | loss: 0.8874596
	speed: 0.0042s/iter; left time: 15.3064s
Updating learning rate to 0.0011166146534
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 2.4240334033966064
Epoch: 1, Steps: 523 | Train Loss: 0.8058767 Vali Loss: 0.2846204 Best vali loss: 0.2846204
	iters: 100, epoch: 2 | loss: 0.2779039
	speed: 0.0083s/iter; left time: 29.4196s
	iters: 200, epoch: 2 | loss: 0.4306944
	speed: 0.0036s/iter; left time: 12.4532s
	iters: 300, epoch: 2 | loss: 0.3853840
	speed: 0.0037s/iter; left time: 12.3491s
	iters: 400, epoch: 2 | loss: 0.5268584
	speed: 0.0037s/iter; left time: 12.0242s
	iters: 500, epoch: 2 | loss: 0.8042840
	speed: 0.0037s/iter; left time: 11.5932s
Updating learning rate to 0.0005583073267
Epoch: 2 cost time: 1.943211317062378
Epoch: 2, Steps: 523 | Train Loss: 0.4850249 Vali Loss: 0.2857922 Best vali loss: 0.2846204
	iters: 100, epoch: 3 | loss: 1.2138554
	speed: 0.0081s/iter; left time: 24.5927s
	iters: 200, epoch: 3 | loss: 0.5302766
	speed: 0.0040s/iter; left time: 11.7597s
	iters: 300, epoch: 3 | loss: 0.7741320
	speed: 0.0040s/iter; left time: 11.3543s
	iters: 400, epoch: 3 | loss: 1.2127181
	speed: 0.0040s/iter; left time: 10.9629s
	iters: 500, epoch: 3 | loss: 0.3243953
	speed: 0.0040s/iter; left time: 10.5469s
Updating learning rate to 0.00027915366335
Epoch: 3 cost time: 2.124359130859375
Epoch: 3, Steps: 523 | Train Loss: 0.8110755 Vali Loss: 0.3054868 Best vali loss: 0.2846204
	iters: 100, epoch: 4 | loss: 0.3464869
	speed: 0.0083s/iter; left time: 20.8144s
	iters: 200, epoch: 4 | loss: 0.4224980
	speed: 0.0040s/iter; left time: 9.6392s
	iters: 300, epoch: 4 | loss: 0.3475971
	speed: 0.0040s/iter; left time: 9.3787s
	iters: 400, epoch: 4 | loss: 0.3258539
	speed: 0.0040s/iter; left time: 8.9100s
	iters: 500, epoch: 4 | loss: 0.5168328
	speed: 0.0040s/iter; left time: 8.4861s
Updating learning rate to 0.000139576831675
Epoch: 4 cost time: 2.1275837421417236
Epoch: 4, Steps: 523 | Train Loss: 0.3918538 Vali Loss: 0.2998849 Best vali loss: 0.2846204
	iters: 100, epoch: 5 | loss: 0.4044018
	speed: 0.0086s/iter; left time: 17.1568s
	iters: 200, epoch: 5 | loss: 0.5769161
	speed: 0.0042s/iter; left time: 7.8679s
	iters: 300, epoch: 5 | loss: 0.3900650
	speed: 0.0040s/iter; left time: 7.1283s
	iters: 400, epoch: 5 | loss: 0.4061109
	speed: 0.0040s/iter; left time: 6.7111s
	iters: 500, epoch: 5 | loss: 0.2709963
	speed: 0.0039s/iter; left time: 6.2437s
Updating learning rate to 6.97884158375e-05
Epoch: 5 cost time: 2.148561477661133
Epoch: 5, Steps: 523 | Train Loss: 0.4096980 Vali Loss: 0.2863768 Best vali loss: 0.2846204
	iters: 100, epoch: 6 | loss: 0.6624668
	speed: 0.0082s/iter; left time: 12.1097s
	iters: 200, epoch: 6 | loss: 0.3645753
	speed: 0.0040s/iter; left time: 5.4333s
	iters: 300, epoch: 6 | loss: 0.3081176
	speed: 0.0039s/iter; left time: 4.9756s
	iters: 400, epoch: 6 | loss: 0.3603555
	speed: 0.0039s/iter; left time: 4.5337s
	iters: 500, epoch: 6 | loss: 0.2153210
	speed: 0.0039s/iter; left time: 4.2234s
Updating learning rate to 3.489420791875e-05
Epoch: 6 cost time: 2.0894124507904053
Epoch: 6, Steps: 523 | Train Loss: 0.3821672 Vali Loss: 0.2878960 Best vali loss: 0.2846204
	iters: 100, epoch: 7 | loss: 0.3131368
	speed: 0.0079s/iter; left time: 7.4755s
	iters: 200, epoch: 7 | loss: 0.3794037
	speed: 0.0036s/iter; left time: 3.0481s
	iters: 300, epoch: 7 | loss: 0.8313429
	speed: 0.0038s/iter; left time: 2.8360s
	iters: 400, epoch: 7 | loss: 0.2479303
	speed: 0.0040s/iter; left time: 2.5910s
	iters: 500, epoch: 7 | loss: 0.5741079
	speed: 0.0040s/iter; left time: 2.1877s
Updating learning rate to 1.7447103959375e-05
Epoch: 7 cost time: 2.025994300842285
Epoch: 7, Steps: 523 | Train Loss: 0.4691843 Vali Loss: 0.2874722 Best vali loss: 0.2846204
	iters: 100, epoch: 8 | loss: 1.0236727
	speed: 0.0083s/iter; left time: 3.5357s
	iters: 200, epoch: 8 | loss: 0.2565723
	speed: 0.0040s/iter; left time: 1.2886s
	iters: 300, epoch: 8 | loss: 0.2988590
	speed: 0.0040s/iter; left time: 0.8918s
	iters: 400, epoch: 8 | loss: 0.3211435
	speed: 0.0040s/iter; left time: 0.4981s
	iters: 500, epoch: 8 | loss: 0.3785671
	speed: 0.0040s/iter; left time: 0.0957s
Updating learning rate to 8.7235519796875e-06
Epoch: 8 cost time: 2.122637987136841
Epoch: 8, Steps: 523 | Train Loss: 0.4557629 Vali Loss: 0.2887155 Best vali loss: 0.2846204

best validation loss 0.2846204337742569

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024173645777, 'e_layers': 3, 'learning_rate': 0.00046339841, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5208543
	speed: 0.0121s/iter; left time: 11.5237s
Updating learning rate to 0.0004457613581986368
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 1.146552562713623
Epoch: 1, Steps: 131 | Train Loss: 0.5208543 Vali Loss: 0.2879115 Best vali loss: 0.2879115
	iters: 100, epoch: 2 | loss: 0.5615920
	speed: 0.0113s/iter; left time: 9.2125s
Updating learning rate to 0.000395535284051032
Validation loss decreased (0.2879 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 0.9103610515594482
Epoch: 2, Steps: 131 | Train Loss: 0.5615920 Vali Loss: 0.2809602 Best vali loss: 0.2809602
	iters: 100, epoch: 3 | loss: 0.6203740
	speed: 0.0114s/iter; left time: 7.8210s
Updating learning rate to 0.00032036665204566257
Epoch: 3 cost time: 0.9088397026062012
Epoch: 3, Steps: 131 | Train Loss: 0.6203740 Vali Loss: 0.2930777 Best vali loss: 0.2809602
	iters: 100, epoch: 4 | loss: 0.3651969
	speed: 0.0110s/iter; left time: 6.0995s
Updating learning rate to 0.000231699205
Epoch: 4 cost time: 0.9055144786834717
Epoch: 4, Steps: 131 | Train Loss: 0.3651969 Vali Loss: 0.2819122 Best vali loss: 0.2809602
	iters: 100, epoch: 5 | loss: 0.3268390
	speed: 0.0109s/iter; left time: 4.6373s
Updating learning rate to 0.00014303175795433743
Epoch: 5 cost time: 0.9057369232177734
Epoch: 5, Steps: 131 | Train Loss: 0.3268390 Vali Loss: 0.2963461 Best vali loss: 0.2809602
	iters: 100, epoch: 6 | loss: 0.3282671
	speed: 0.0110s/iter; left time: 3.2215s
Updating learning rate to 6.7863125948968e-05
Epoch: 6 cost time: 0.9129667282104492
Epoch: 6, Steps: 131 | Train Loss: 0.3282671 Vali Loss: 0.2992532 Best vali loss: 0.2809602
	iters: 100, epoch: 7 | loss: 0.3648907
	speed: 0.0109s/iter; left time: 1.7777s
Updating learning rate to 1.7637051801363208e-05
Epoch: 7 cost time: 0.9057841300964355
Epoch: 7, Steps: 131 | Train Loss: 0.3648907 Vali Loss: 0.3058545 Best vali loss: 0.2809602
	iters: 100, epoch: 8 | loss: 0.3358565
	speed: 0.0110s/iter; left time: 0.3520s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9102094173431396
Epoch: 8, Steps: 131 | Train Loss: 0.3358565 Vali Loss: 0.3085083 Best vali loss: 0.2809602

best validation loss 0.2809602434349663

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044423223636, 'e_layers': 3, 'learning_rate': 0.0004640677066, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5211820
	speed: 0.0120s/iter; left time: 11.3946s
Updating learning rate to 0.00044640518121359646
Validation loss decreased (inf --> 0.2709).  Saving model state dict ...
Epoch: 1 cost time: 1.1363182067871094
Epoch: 1, Steps: 131 | Train Loss: 0.5211820 Vali Loss: 0.2709239 Best vali loss: 0.2709239
	iters: 100, epoch: 2 | loss: 0.5467330
	speed: 0.0113s/iter; left time: 9.2421s
Updating learning rate to 0.00039610656443327455
Epoch: 2 cost time: 0.9145734310150146
Epoch: 2, Steps: 131 | Train Loss: 0.5467330 Vali Loss: 0.2828462 Best vali loss: 0.2709239
	iters: 100, epoch: 3 | loss: 0.6045149
	speed: 0.0111s/iter; left time: 7.6298s
Updating learning rate to 0.00032082936470574175
Epoch: 3 cost time: 0.9198381900787354
Epoch: 3, Steps: 131 | Train Loss: 0.6045149 Vali Loss: 0.2804224 Best vali loss: 0.2709239

best validation loss 0.2709238540676279

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0057849269892, 'e_layers': 4, 'learning_rate': 0.0043421913412, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6655164
	speed: 0.0109s/iter; left time: 21.8175s
	iters: 200, epoch: 1 | loss: 1.0852799
	speed: 0.0057s/iter; left time: 10.7921s
Updating learning rate to 0.0043421913412
Validation loss decreased (inf --> 0.3197).  Saving model state dict ...
Epoch: 1 cost time: 1.7535793781280518
Epoch: 1, Steps: 262 | Train Loss: 0.8753982 Vali Loss: 0.3196602 Best vali loss: 0.3196602
	iters: 100, epoch: 2 | loss: 0.7262262
	speed: 0.0123s/iter; left time: 21.3714s
	iters: 200, epoch: 2 | loss: 0.3324309
	speed: 0.0058s/iter; left time: 9.4283s
Updating learning rate to 0.0021710956706
Epoch: 2 cost time: 1.5543889999389648
Epoch: 2, Steps: 262 | Train Loss: 0.5293286 Vali Loss: 0.3267587 Best vali loss: 0.3196602
	iters: 100, epoch: 3 | loss: 0.4374743
	speed: 0.0119s/iter; left time: 17.4842s
	iters: 200, epoch: 3 | loss: 0.7818027
	speed: 0.0056s/iter; left time: 7.6438s
Updating learning rate to 0.0010855478353
Epoch: 3 cost time: 1.5001394748687744
Epoch: 3, Steps: 262 | Train Loss: 0.6096385 Vali Loss: 0.3220949 Best vali loss: 0.3196602

best validation loss 0.31966021230846764

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0015434375973, 'e_layers': 4, 'learning_rate': 0.0014147759748, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3584429
	speed: 0.0104s/iter; left time: 42.6291s
	iters: 200, epoch: 1 | loss: 0.8241574
	speed: 0.0053s/iter; left time: 21.1241s
	iters: 300, epoch: 1 | loss: 0.9317526
	speed: 0.0053s/iter; left time: 20.5605s
	iters: 400, epoch: 1 | loss: 0.2168825
	speed: 0.0053s/iter; left time: 20.1039s
	iters: 500, epoch: 1 | loss: 0.8130838
	speed: 0.0052s/iter; left time: 19.0888s
Updating learning rate to 0.0014147759748
Validation loss decreased (inf --> 0.3252).  Saving model state dict ...
Epoch: 1 cost time: 3.0011065006256104
Epoch: 1, Steps: 523 | Train Loss: 0.6288638 Vali Loss: 0.3251808 Best vali loss: 0.3251808
	iters: 100, epoch: 2 | loss: 0.3936775
	speed: 0.0107s/iter; left time: 37.9535s
	iters: 200, epoch: 2 | loss: 1.1142433
	speed: 0.0053s/iter; left time: 18.2127s
	iters: 300, epoch: 2 | loss: 0.7535557
	speed: 0.0053s/iter; left time: 17.7125s
	iters: 400, epoch: 2 | loss: 0.7400370
	speed: 0.0052s/iter; left time: 17.1163s
	iters: 500, epoch: 2 | loss: 0.6070299
	speed: 0.0052s/iter; left time: 16.4593s
Updating learning rate to 0.0007073879874
Validation loss decreased (0.3252 --> 0.3231).  Saving model state dict ...
Epoch: 2 cost time: 2.779113531112671
Epoch: 2, Steps: 523 | Train Loss: 0.7217087 Vali Loss: 0.3231295 Best vali loss: 0.3231295
	iters: 100, epoch: 3 | loss: 0.9483610
	speed: 0.0105s/iter; left time: 31.8818s
	iters: 200, epoch: 3 | loss: 0.6378444
	speed: 0.0053s/iter; left time: 15.6413s
	iters: 300, epoch: 3 | loss: 0.3689336
	speed: 0.0051s/iter; left time: 14.4169s
	iters: 400, epoch: 3 | loss: 0.3026183
	speed: 0.0049s/iter; left time: 13.5439s
	iters: 500, epoch: 3 | loss: 0.7255964
	speed: 0.0049s/iter; left time: 13.0293s
Updating learning rate to 0.0003536939937
Validation loss decreased (0.3231 --> 0.3207).  Saving model state dict ...
Epoch: 3 cost time: 2.6932566165924072
Epoch: 3, Steps: 523 | Train Loss: 0.5966707 Vali Loss: 0.3207485 Best vali loss: 0.3207485

best validation loss 0.3207485391420696

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044423223636, 'e_layers': 3, 'learning_rate': 0.0004640677066, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3561291
	speed: 0.0125s/iter; left time: 6.9331s
Updating learning rate to 0.0002320338533
Epoch: 4 cost time: 1.1430773735046387
Epoch: 4, Steps: 131 | Train Loss: 0.3561291 Vali Loss: 0.2917965 Best vali loss: 0.2709239
	iters: 100, epoch: 5 | loss: 0.3419120
	speed: 0.0111s/iter; left time: 4.7202s
Updating learning rate to 0.0001432383418942583
Epoch: 5 cost time: 0.9131786823272705
Epoch: 5, Steps: 131 | Train Loss: 0.3419120 Vali Loss: 0.2916727 Best vali loss: 0.2709239
	iters: 100, epoch: 6 | loss: 0.3515936
	speed: 0.0110s/iter; left time: 3.2352s
Updating learning rate to 6.796114216672545e-05
Epoch: 6 cost time: 0.9090840816497803
Epoch: 6, Steps: 131 | Train Loss: 0.3515936 Vali Loss: 0.3072557 Best vali loss: 0.2709239
	iters: 100, epoch: 7 | loss: 0.2431887
	speed: 0.0109s/iter; left time: 1.7810s
Updating learning rate to 1.7662525386403512e-05
Epoch: 7 cost time: 0.9060699939727783
Epoch: 7, Steps: 131 | Train Loss: 0.2431887 Vali Loss: 0.3121170 Best vali loss: 0.2709239
	iters: 100, epoch: 8 | loss: 0.2677864
	speed: 0.0110s/iter; left time: 0.3520s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9025778770446777
Epoch: 8, Steps: 131 | Train Loss: 0.2677864 Vali Loss: 0.3145982 Best vali loss: 0.2709239

best validation loss 0.2709238540676279

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020827917766, 'e_layers': 4, 'learning_rate': 0.0005090316657, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004896578015201788
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.2446532249450684
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2855772 Best vali loss: 0.2855772
Updating learning rate to 0.0004344857041775768
Epoch: 2 cost time: 1.017319679260254
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2860381 Best vali loss: 0.2855772
Updating learning rate to 0.00035191482535629746
Epoch: 3 cost time: 1.0250709056854248
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3057108 Best vali loss: 0.2855772
Updating learning rate to 0.00025451583285
Validation loss decreased (0.2856 --> 0.2789).  Saving model state dict ...
Epoch: 4 cost time: 1.0213322639465332
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2789428 Best vali loss: 0.2789428
Updating learning rate to 0.00015711684034370253
Validation loss decreased (0.2789 --> 0.2766).  Saving model state dict ...
Epoch: 5 cost time: 1.0251398086547852
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2766292 Best vali loss: 0.2766292
Updating learning rate to 7.454596152242316e-05
Epoch: 6 cost time: 1.0239062309265137
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2808648 Best vali loss: 0.2766292
Updating learning rate to 1.93738641798212e-05
Epoch: 7 cost time: 1.0209705829620361
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2942398 Best vali loss: 0.2766292
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0208063125610352
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2894784 Best vali loss: 0.2766292

best validation loss 0.27662921824633474

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0009597550568, 'e_layers': 4, 'learning_rate': 0.0033329349161, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6375861
	speed: 0.0098s/iter; left time: 80.8207s
	iters: 200, epoch: 1 | loss: 0.3408422
	speed: 0.0052s/iter; left time: 42.1647s
	iters: 300, epoch: 1 | loss: 0.9660802
	speed: 0.0051s/iter; left time: 41.4745s
	iters: 400, epoch: 1 | loss: 0.3553701
	speed: 0.0052s/iter; left time: 41.0029s
	iters: 500, epoch: 1 | loss: 0.8123534
	speed: 0.0052s/iter; left time: 40.5424s
	iters: 600, epoch: 1 | loss: 0.2833392
	speed: 0.0051s/iter; left time: 39.6772s
	iters: 700, epoch: 1 | loss: 0.3146118
	speed: 0.0052s/iter; left time: 39.5162s
	iters: 800, epoch: 1 | loss: 0.5684640
	speed: 0.0052s/iter; left time: 39.1389s
	iters: 900, epoch: 1 | loss: 0.6221778
	speed: 0.0052s/iter; left time: 38.4368s
	iters: 1000, epoch: 1 | loss: 1.5110179
	speed: 0.0052s/iter; left time: 37.9547s
Updating learning rate to 0.0033329349161
Validation loss decreased (inf --> 0.3222).  Saving model state dict ...
Epoch: 1 cost time: 5.641856670379639
Epoch: 1, Steps: 1045 | Train Loss: 0.6411843 Vali Loss: 0.3221586 Best vali loss: 0.3221586
	iters: 100, epoch: 2 | loss: 0.7808758
	speed: 0.0135s/iter; left time: 97.2552s
	iters: 200, epoch: 2 | loss: 0.3242115
	speed: 0.0046s/iter; left time: 33.0884s
	iters: 300, epoch: 2 | loss: 0.4487355
	speed: 0.0047s/iter; left time: 33.2051s
	iters: 400, epoch: 2 | loss: 0.3604609
	speed: 0.0046s/iter; left time: 31.5569s
	iters: 500, epoch: 2 | loss: 0.5342181
	speed: 0.0045s/iter; left time: 30.8309s
	iters: 600, epoch: 2 | loss: 1.8956163
	speed: 0.0046s/iter; left time: 30.6243s
	iters: 700, epoch: 2 | loss: 1.2661260
	speed: 0.0046s/iter; left time: 30.1258s
	iters: 800, epoch: 2 | loss: 0.2997634
	speed: 0.0045s/iter; left time: 29.4920s
	iters: 900, epoch: 2 | loss: 0.3525351
	speed: 0.0046s/iter; left time: 29.2066s
	iters: 1000, epoch: 2 | loss: 0.1219769
	speed: 0.0045s/iter; left time: 28.5856s
Updating learning rate to 0.00166646745805
Epoch: 2 cost time: 4.818042755126953
Epoch: 2, Steps: 1045 | Train Loss: 0.6384520 Vali Loss: 0.3236301 Best vali loss: 0.3221586
	iters: 100, epoch: 3 | loss: 0.5634662
	speed: 0.0141s/iter; left time: 86.8676s
	iters: 200, epoch: 3 | loss: 1.1775564
	speed: 0.0051s/iter; left time: 30.7514s
	iters: 300, epoch: 3 | loss: 0.3336482
	speed: 0.0051s/iter; left time: 30.3448s
	iters: 400, epoch: 3 | loss: 0.4270752
	speed: 0.0051s/iter; left time: 29.7220s
	iters: 500, epoch: 3 | loss: 0.6756392
	speed: 0.0051s/iter; left time: 29.5370s
	iters: 600, epoch: 3 | loss: 0.2710993
	speed: 0.0051s/iter; left time: 28.7574s
	iters: 700, epoch: 3 | loss: 0.4885834
	speed: 0.0051s/iter; left time: 28.2474s
	iters: 800, epoch: 3 | loss: 1.7062007
	speed: 0.0051s/iter; left time: 27.7249s
	iters: 900, epoch: 3 | loss: 1.0446627
	speed: 0.0050s/iter; left time: 26.8814s
	iters: 1000, epoch: 3 | loss: 0.3829311
	speed: 0.0051s/iter; left time: 26.7138s
Updating learning rate to 0.000833233729025
Validation loss decreased (0.3222 --> 0.3221).  Saving model state dict ...
Epoch: 3 cost time: 5.338018417358398
Epoch: 3, Steps: 1045 | Train Loss: 0.7070862 Vali Loss: 0.3221376 Best vali loss: 0.3221376
	iters: 100, epoch: 4 | loss: 0.2712368
	speed: 0.0142s/iter; left time: 72.5482s
	iters: 200, epoch: 4 | loss: 0.4259748
	speed: 0.0048s/iter; left time: 23.8937s
	iters: 300, epoch: 4 | loss: 0.2653733
	speed: 0.0047s/iter; left time: 23.2338s
	iters: 400, epoch: 4 | loss: 0.4416284
	speed: 0.0047s/iter; left time: 22.7174s
	iters: 500, epoch: 4 | loss: 0.6511123
	speed: 0.0047s/iter; left time: 22.3392s
	iters: 600, epoch: 4 | loss: 0.2914619
	speed: 0.0048s/iter; left time: 22.0318s
	iters: 700, epoch: 4 | loss: 0.2841229
	speed: 0.0047s/iter; left time: 21.4584s
	iters: 800, epoch: 4 | loss: 1.0043874
	speed: 0.0048s/iter; left time: 21.0369s
	iters: 900, epoch: 4 | loss: 0.2055702
	speed: 0.0048s/iter; left time: 20.5903s
	iters: 1000, epoch: 4 | loss: 0.9903767
	speed: 0.0047s/iter; left time: 19.9978s
Updating learning rate to 0.0004166168645125
Validation loss decreased (0.3221 --> 0.3221).  Saving model state dict ...
Epoch: 4 cost time: 4.997848749160767
Epoch: 4, Steps: 1045 | Train Loss: 0.4831245 Vali Loss: 0.3221298 Best vali loss: 0.3221298
	iters: 100, epoch: 5 | loss: 0.3285212
	speed: 0.0143s/iter; left time: 58.2620s
	iters: 200, epoch: 5 | loss: 0.2678744
	speed: 0.0052s/iter; left time: 20.6665s
	iters: 300, epoch: 5 | loss: 0.5032318
	speed: 0.0052s/iter; left time: 20.0892s
	iters: 400, epoch: 5 | loss: 0.2574026
	speed: 0.0052s/iter; left time: 19.5515s
	iters: 500, epoch: 5 | loss: 0.2849511
	speed: 0.0051s/iter; left time: 18.8834s
	iters: 600, epoch: 5 | loss: 0.3873788
	speed: 0.0051s/iter; left time: 18.4385s
	iters: 700, epoch: 5 | loss: 0.1525629
	speed: 0.0052s/iter; left time: 18.0029s
	iters: 800, epoch: 5 | loss: 1.2202325
	speed: 0.0052s/iter; left time: 17.5533s
	iters: 900, epoch: 5 | loss: 0.4160953
	speed: 0.0051s/iter; left time: 16.7492s
	iters: 1000, epoch: 5 | loss: 0.4380028
	speed: 0.0051s/iter; left time: 16.3611s
Updating learning rate to 0.00020830843225625
Epoch: 5 cost time: 5.43122673034668
Epoch: 5, Steps: 1045 | Train Loss: 0.4256253 Vali Loss: 0.3221925 Best vali loss: 0.3221298
	iters: 100, epoch: 6 | loss: 0.5594453
	speed: 0.0138s/iter; left time: 41.8925s
	iters: 200, epoch: 6 | loss: 0.3426637
	speed: 0.0050s/iter; left time: 14.5629s
	iters: 300, epoch: 6 | loss: 0.4600841
	speed: 0.0049s/iter; left time: 13.9813s
	iters: 400, epoch: 6 | loss: 0.7545911
	speed: 0.0050s/iter; left time: 13.5740s
	iters: 500, epoch: 6 | loss: 0.6067755
	speed: 0.0049s/iter; left time: 12.9698s
	iters: 600, epoch: 6 | loss: 0.3653366
	speed: 0.0049s/iter; left time: 12.5310s
	iters: 700, epoch: 6 | loss: 0.5958161
	speed: 0.0050s/iter; left time: 12.0817s
	iters: 800, epoch: 6 | loss: 0.4181231
	speed: 0.0049s/iter; left time: 11.5562s
	iters: 900, epoch: 6 | loss: 0.4609569
	speed: 0.0049s/iter; left time: 11.0069s
	iters: 1000, epoch: 6 | loss: 0.4205087
	speed: 0.0049s/iter; left time: 10.5225s
Updating learning rate to 0.000104154216128125
Epoch: 6 cost time: 5.200190782546997
Epoch: 6, Steps: 1045 | Train Loss: 0.4984301 Vali Loss: 0.3223881 Best vali loss: 0.3221298
	iters: 100, epoch: 7 | loss: 0.3832949
	speed: 0.0135s/iter; left time: 26.9728s
	iters: 200, epoch: 7 | loss: 0.1762312
	speed: 0.0048s/iter; left time: 8.9873s
	iters: 300, epoch: 7 | loss: 0.4900937
	speed: 0.0049s/iter; left time: 8.7868s
	iters: 400, epoch: 7 | loss: 0.4123373
	speed: 0.0050s/iter; left time: 8.4171s
	iters: 500, epoch: 7 | loss: 0.1700941
	speed: 0.0049s/iter; left time: 7.8601s
	iters: 600, epoch: 7 | loss: 0.4185925
	speed: 0.0050s/iter; left time: 7.4284s
	iters: 700, epoch: 7 | loss: 0.4055303
	speed: 0.0049s/iter; left time: 6.8518s
	iters: 800, epoch: 7 | loss: 0.2519323
	speed: 0.0049s/iter; left time: 6.3440s
	iters: 900, epoch: 7 | loss: 0.3379869
	speed: 0.0048s/iter; left time: 5.7582s
	iters: 1000, epoch: 7 | loss: 2.3113356
	speed: 0.0049s/iter; left time: 5.2952s
Updating learning rate to 5.20771080640625e-05
Epoch: 7 cost time: 5.125699281692505
Epoch: 7, Steps: 1045 | Train Loss: 0.5357429 Vali Loss: 0.3222434 Best vali loss: 0.3221298
	iters: 100, epoch: 8 | loss: 1.3504976
	speed: 0.0139s/iter; left time: 13.1608s
	iters: 200, epoch: 8 | loss: 0.4584454
	speed: 0.0051s/iter; left time: 4.2811s
	iters: 300, epoch: 8 | loss: 0.4988788
	speed: 0.0051s/iter; left time: 3.7748s
	iters: 400, epoch: 8 | loss: 0.3463722
	speed: 0.0050s/iter; left time: 3.2562s
	iters: 500, epoch: 8 | loss: 0.5399970
	speed: 0.0050s/iter; left time: 2.7498s
	iters: 600, epoch: 8 | loss: 0.7862182
	speed: 0.0050s/iter; left time: 2.2440s
	iters: 700, epoch: 8 | loss: 1.1272410
	speed: 0.0050s/iter; left time: 1.7395s
	iters: 800, epoch: 8 | loss: 0.6887525
	speed: 0.0051s/iter; left time: 1.2424s
	iters: 900, epoch: 8 | loss: 0.2761746
	speed: 0.0050s/iter; left time: 0.7339s
	iters: 1000, epoch: 8 | loss: 0.2982431
	speed: 0.0050s/iter; left time: 0.2307s
Updating learning rate to 2.603855403203125e-05
Epoch: 8 cost time: 5.297883749008179
Epoch: 8, Steps: 1045 | Train Loss: 0.6370820 Vali Loss: 0.3222574 Best vali loss: 0.3221298

best validation loss 0.32212975653364295

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001932214488, 'e_layers': 3, 'learning_rate': 0.0005056216338, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00048637755623136855
Validation loss decreased (inf --> 0.2910).  Saving model state dict ...
Epoch: 1 cost time: 1.008608341217041
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2909963 Best vali loss: 0.2909963
Updating learning rate to 0.00043157505988730064
Validation loss decreased (0.2910 --> 0.2708).  Saving model state dict ...
Epoch: 2 cost time: 0.7759053707122803
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2708013 Best vali loss: 0.2708013
Updating learning rate to 0.0003495573280503143
Epoch: 3 cost time: 0.7717585563659668
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2827972 Best vali loss: 0.2708013

best validation loss 0.2708013018918064

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014508996352, 'e_layers': 4, 'learning_rate': 0.0005061200327, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004868569859527366
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.2315125465393066
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2856800 Best vali loss: 0.2856800
Updating learning rate to 0.0004320004699582636
Epoch: 2 cost time: 1.0115151405334473
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2909434 Best vali loss: 0.2856800
Updating learning rate to 0.00034990189200118376
Epoch: 3 cost time: 1.0096096992492676
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2903191 Best vali loss: 0.2856800

best validation loss 0.2856799961300134

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0021091546948, 'e_layers': 4, 'learning_rate': 0.0004887905391, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5103801
	speed: 0.0134s/iter; left time: 12.6893s
Updating learning rate to 0.0004887905391
Validation loss decreased (inf --> 0.2903).  Saving model state dict ...
Epoch: 1 cost time: 1.4044198989868164
Epoch: 1, Steps: 131 | Train Loss: 0.5103801 Vali Loss: 0.2903080 Best vali loss: 0.2903080
	iters: 100, epoch: 2 | loss: 0.5384714
	speed: 0.0160s/iter; left time: 13.0896s
Updating learning rate to 0.00024439526955
Validation loss decreased (0.2903 --> 0.2889).  Saving model state dict ...
Epoch: 2 cost time: 1.1745176315307617
Epoch: 2, Steps: 131 | Train Loss: 0.5384714 Vali Loss: 0.2889253 Best vali loss: 0.2889253
	iters: 100, epoch: 3 | loss: 0.4737840
	speed: 0.0146s/iter; left time: 9.9961s
Updating learning rate to 0.000122197634775
Validation loss decreased (0.2889 --> 0.2832).  Saving model state dict ...
Epoch: 3 cost time: 1.1825392246246338
Epoch: 3, Steps: 131 | Train Loss: 0.4737840 Vali Loss: 0.2831802 Best vali loss: 0.2831802

best validation loss 0.2831801513937957

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001932214488, 'e_layers': 3, 'learning_rate': 0.0005056216338, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002528108169
Epoch: 4 cost time: 1.0075914859771729
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2862410 Best vali loss: 0.2708013
Updating learning rate to 0.00015606430574968577
Epoch: 5 cost time: 0.7795543670654297
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2806378 Best vali loss: 0.2708013
Updating learning rate to 7.404657391269939e-05
Epoch: 6 cost time: 0.7811908721923828
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2927273 Best vali loss: 0.2708013
Updating learning rate to 1.9244077568631494e-05
Epoch: 7 cost time: 0.7785594463348389
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2896017 Best vali loss: 0.2708013
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7789938449859619
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2915110 Best vali loss: 0.2708013

best validation loss 0.2708013018918064

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021101001248, 'e_layers': 4, 'learning_rate': 0.000525984625, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4682288
	speed: 0.0148s/iter; left time: 14.0655s
Updating learning rate to 0.000525984625
Validation loss decreased (inf --> 0.2863).  Saving model state dict ...
Epoch: 1 cost time: 1.5082013607025146
Epoch: 1, Steps: 131 | Train Loss: 0.4682288 Vali Loss: 0.2862756 Best vali loss: 0.2862756
	iters: 100, epoch: 2 | loss: 0.4954790
	speed: 0.0155s/iter; left time: 12.6816s
Updating learning rate to 0.0002629923125
Epoch: 2 cost time: 1.2910101413726807
Epoch: 2, Steps: 131 | Train Loss: 0.4954790 Vali Loss: 0.2975613 Best vali loss: 0.2862756
	iters: 100, epoch: 3 | loss: 0.4569328
	speed: 0.0152s/iter; left time: 10.4547s
Updating learning rate to 0.00013149615625
Epoch: 3 cost time: 1.2899324893951416
Epoch: 3, Steps: 131 | Train Loss: 0.4569328 Vali Loss: 0.2904397 Best vali loss: 0.2862756
	iters: 100, epoch: 4 | loss: 0.4385382
	speed: 0.0152s/iter; left time: 8.4261s
Updating learning rate to 6.5748078125e-05
Validation loss decreased (0.2863 --> 0.2754).  Saving model state dict ...
Epoch: 4 cost time: 1.288872480392456
Epoch: 4, Steps: 131 | Train Loss: 0.4385382 Vali Loss: 0.2753890 Best vali loss: 0.2753890
	iters: 100, epoch: 5 | loss: 0.5020353
	speed: 0.0160s/iter; left time: 6.7856s
Updating learning rate to 3.28740390625e-05
Validation loss decreased (0.2754 --> 0.2745).  Saving model state dict ...
Epoch: 5 cost time: 1.299757957458496
Epoch: 5, Steps: 131 | Train Loss: 0.5020353 Vali Loss: 0.2744880 Best vali loss: 0.2744880
	iters: 100, epoch: 6 | loss: 0.5375528
	speed: 0.0159s/iter; left time: 4.6777s
Updating learning rate to 1.643701953125e-05
Validation loss decreased (0.2745 --> 0.2735).  Saving model state dict ...
Epoch: 6 cost time: 1.2926154136657715
Epoch: 6, Steps: 131 | Train Loss: 0.5375528 Vali Loss: 0.2734706 Best vali loss: 0.2734706
	iters: 100, epoch: 7 | loss: 0.4327572
	speed: 0.0159s/iter; left time: 2.5912s
Updating learning rate to 8.218509765625e-06
Validation loss decreased (0.2735 --> 0.2734).  Saving model state dict ...
Epoch: 7 cost time: 1.292405605316162
Epoch: 7, Steps: 131 | Train Loss: 0.4327572 Vali Loss: 0.2734371 Best vali loss: 0.2734371
	iters: 100, epoch: 8 | loss: 0.4063130
	speed: 0.0158s/iter; left time: 0.5063s
Updating learning rate to 4.1092548828125e-06
Validation loss decreased (0.2734 --> 0.2732).  Saving model state dict ...
Epoch: 8 cost time: 1.2956092357635498
Epoch: 8, Steps: 131 | Train Loss: 0.4063130 Vali Loss: 0.2732356 Best vali loss: 0.2732356

best validation loss 0.2732355889305611

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.002232063351, 'e_layers': 4, 'learning_rate': 0.0008085680843, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4462820
	speed: 0.0103s/iter; left time: 42.1669s
	iters: 200, epoch: 1 | loss: 0.4487143
	speed: 0.0051s/iter; left time: 20.2266s
	iters: 300, epoch: 1 | loss: 0.7800807
	speed: 0.0051s/iter; left time: 19.9895s
	iters: 400, epoch: 1 | loss: 0.5991035
	speed: 0.0051s/iter; left time: 19.3620s
	iters: 500, epoch: 1 | loss: 0.8865989
	speed: 0.0051s/iter; left time: 18.7093s
Updating learning rate to 0.0008085680843
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 2.9218757152557373
Epoch: 1, Steps: 523 | Train Loss: 0.6321559 Vali Loss: 0.2839047 Best vali loss: 0.2839047
	iters: 100, epoch: 2 | loss: 0.5044491
	speed: 0.0100s/iter; left time: 35.7676s
	iters: 200, epoch: 2 | loss: 0.3571872
	speed: 0.0046s/iter; left time: 16.0397s
	iters: 300, epoch: 2 | loss: 0.2532542
	speed: 0.0045s/iter; left time: 15.1834s
	iters: 400, epoch: 2 | loss: 0.8036140
	speed: 0.0045s/iter; left time: 14.7302s
	iters: 500, epoch: 2 | loss: 0.2477490
	speed: 0.0046s/iter; left time: 14.4034s
Updating learning rate to 0.00040428404215
Epoch: 2 cost time: 2.4560842514038086
Epoch: 2, Steps: 523 | Train Loss: 0.4332507 Vali Loss: 0.2894969 Best vali loss: 0.2839047
	iters: 100, epoch: 3 | loss: 0.7134982
	speed: 0.0097s/iter; left time: 29.6183s
	iters: 200, epoch: 3 | loss: 0.6675247
	speed: 0.0049s/iter; left time: 14.2841s
	iters: 300, epoch: 3 | loss: 0.3066398
	speed: 0.0049s/iter; left time: 13.8656s
	iters: 400, epoch: 3 | loss: 0.4471592
	speed: 0.0048s/iter; left time: 13.2112s
	iters: 500, epoch: 3 | loss: 0.2398281
	speed: 0.0048s/iter; left time: 12.7721s
Updating learning rate to 0.000202142021075
Epoch: 3 cost time: 2.5799217224121094
Epoch: 3, Steps: 523 | Train Loss: 0.4749300 Vali Loss: 0.2945482 Best vali loss: 0.2839047
	iters: 100, epoch: 4 | loss: 0.2207087
	speed: 0.0101s/iter; left time: 25.4481s
	iters: 200, epoch: 4 | loss: 0.3563229
	speed: 0.0053s/iter; left time: 12.7456s
	iters: 300, epoch: 4 | loss: 0.7105132
	speed: 0.0052s/iter; left time: 12.1055s
	iters: 400, epoch: 4 | loss: 0.6983774
	speed: 0.0053s/iter; left time: 11.6868s
	iters: 500, epoch: 4 | loss: 0.2768992
	speed: 0.0052s/iter; left time: 11.0844s
Updating learning rate to 0.0001010710105375
Epoch: 4 cost time: 2.780324697494507
Epoch: 4, Steps: 523 | Train Loss: 0.4525643 Vali Loss: 0.2882460 Best vali loss: 0.2839047
	iters: 100, epoch: 5 | loss: 0.3097947
	speed: 0.0102s/iter; left time: 20.2634s
	iters: 200, epoch: 5 | loss: 0.4870141
	speed: 0.0051s/iter; left time: 9.7274s
	iters: 300, epoch: 5 | loss: 0.2938040
	speed: 0.0052s/iter; left time: 9.2677s
	iters: 400, epoch: 5 | loss: 0.2011748
	speed: 0.0052s/iter; left time: 8.7619s
	iters: 500, epoch: 5 | loss: 0.7478908
	speed: 0.0052s/iter; left time: 8.2391s
Updating learning rate to 5.053550526875e-05
Epoch: 5 cost time: 2.736441135406494
Epoch: 5, Steps: 523 | Train Loss: 0.4079357 Vali Loss: 0.2926741 Best vali loss: 0.2839047
	iters: 100, epoch: 6 | loss: 0.4179639
	speed: 0.0101s/iter; left time: 14.8567s
	iters: 200, epoch: 6 | loss: 0.9542850
	speed: 0.0050s/iter; left time: 6.8543s
	iters: 300, epoch: 6 | loss: 0.3166077
	speed: 0.0050s/iter; left time: 6.3111s
	iters: 400, epoch: 6 | loss: 0.2587034
	speed: 0.0050s/iter; left time: 5.8422s
	iters: 500, epoch: 6 | loss: 0.8198133
	speed: 0.0050s/iter; left time: 5.3458s
Updating learning rate to 2.5267752634375e-05
Epoch: 6 cost time: 2.6431188583374023
Epoch: 6, Steps: 523 | Train Loss: 0.5534747 Vali Loss: 0.2941307 Best vali loss: 0.2839047
	iters: 100, epoch: 7 | loss: 0.5885219
	speed: 0.0099s/iter; left time: 9.4153s
	iters: 200, epoch: 7 | loss: 0.1883603
	speed: 0.0049s/iter; left time: 4.1481s
	iters: 300, epoch: 7 | loss: 0.5067929
	speed: 0.0049s/iter; left time: 3.6882s
	iters: 400, epoch: 7 | loss: 0.7454885
	speed: 0.0049s/iter; left time: 3.1663s
	iters: 500, epoch: 7 | loss: 0.6383840
	speed: 0.0049s/iter; left time: 2.6778s
Updating learning rate to 1.26338763171875e-05
Epoch: 7 cost time: 2.616079568862915
Epoch: 7, Steps: 523 | Train Loss: 0.5335095 Vali Loss: 0.2932103 Best vali loss: 0.2839047
	iters: 100, epoch: 8 | loss: 0.1756538
	speed: 0.0095s/iter; left time: 4.0204s
	iters: 200, epoch: 8 | loss: 0.6795660
	speed: 0.0045s/iter; left time: 1.4649s
	iters: 300, epoch: 8 | loss: 0.2263636
	speed: 0.0048s/iter; left time: 1.0802s
	iters: 400, epoch: 8 | loss: 0.5383172
	speed: 0.0047s/iter; left time: 0.5815s
	iters: 500, epoch: 8 | loss: 0.2465835
	speed: 0.0045s/iter; left time: 0.1088s
Updating learning rate to 6.31693815859375e-06
Epoch: 8 cost time: 2.4545676708221436
Epoch: 8, Steps: 523 | Train Loss: 0.3732968 Vali Loss: 0.2940240 Best vali loss: 0.2839047

best validation loss 0.28390471956440844

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0104943685388, 'e_layers': 4, 'learning_rate': 0.0005064622108, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4597736
	speed: 0.0150s/iter; left time: 14.2619s
Updating learning rate to 0.0005064622108
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 1.524501085281372
Epoch: 1, Steps: 131 | Train Loss: 0.4597736 Vali Loss: 0.2834866 Best vali loss: 0.2834866
	iters: 100, epoch: 2 | loss: 0.5133730
	speed: 0.0156s/iter; left time: 12.7449s
Updating learning rate to 0.0002532311054
Epoch: 2 cost time: 1.285487413406372
Epoch: 2, Steps: 131 | Train Loss: 0.5133730 Vali Loss: 0.2975786 Best vali loss: 0.2834866
	iters: 100, epoch: 3 | loss: 0.3891831
	speed: 0.0151s/iter; left time: 10.3921s
Updating learning rate to 0.0001266155527
Epoch: 3 cost time: 1.2865054607391357
Epoch: 3, Steps: 131 | Train Loss: 0.3891831 Vali Loss: 0.2940444 Best vali loss: 0.2834866

best validation loss 0.2834866052059136

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0024127091327, 'e_layers': 1, 'learning_rate': 0.000296527473, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3160680
	speed: 0.0084s/iter; left time: 8.0100s
Updating learning rate to 0.000296527473
Validation loss decreased (inf --> 0.2789).  Saving model state dict ...
Epoch: 1 cost time: 0.6521358489990234
Epoch: 1, Steps: 131 | Train Loss: 0.3160680 Vali Loss: 0.2788561 Best vali loss: 0.2788561
	iters: 100, epoch: 2 | loss: 0.9835920
	speed: 0.0057s/iter; left time: 4.6891s
Updating learning rate to 0.0001482637365
Validation loss decreased (0.2789 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 0.4167165756225586
Epoch: 2, Steps: 131 | Train Loss: 0.9835920 Vali Loss: 0.2780940 Best vali loss: 0.2780940
	iters: 100, epoch: 3 | loss: 0.2432145
	speed: 0.0056s/iter; left time: 3.8660s
Updating learning rate to 7.413186825e-05
Epoch: 3 cost time: 0.40906667709350586
Epoch: 3, Steps: 131 | Train Loss: 0.2432145 Vali Loss: 0.2832436 Best vali loss: 0.2780940

best validation loss 0.2780940275114236

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012030067437, 'e_layers': 3, 'learning_rate': 0.0004749847142, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004749847142
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.9397375583648682
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2793014 Best vali loss: 0.2793014
Updating learning rate to 0.0002374923571
Epoch: 2 cost time: 0.7260932922363281
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2883424 Best vali loss: 0.2793014
Updating learning rate to 0.00011874617855
Epoch: 3 cost time: 0.7236011028289795
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3016929 Best vali loss: 0.2793014

best validation loss 0.27930136223338536

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0024127091327, 'e_layers': 1, 'learning_rate': 0.000296527473, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3131302
	speed: 0.0086s/iter; left time: 4.7715s
Updating learning rate to 3.7065934125e-05
Epoch: 4 cost time: 0.6511147022247314
Epoch: 4, Steps: 131 | Train Loss: 0.3131302 Vali Loss: 0.2900022 Best vali loss: 0.2780940
	iters: 100, epoch: 5 | loss: 0.7893423
	speed: 0.0055s/iter; left time: 2.3456s
Updating learning rate to 1.85329670625e-05
Epoch: 5 cost time: 0.4177396297454834
Epoch: 5, Steps: 131 | Train Loss: 0.7893423 Vali Loss: 0.2901832 Best vali loss: 0.2780940
	iters: 100, epoch: 6 | loss: 0.2284348
	speed: 0.0056s/iter; left time: 1.6358s
Updating learning rate to 9.26648353125e-06
Epoch: 6 cost time: 0.4213674068450928
Epoch: 6, Steps: 131 | Train Loss: 0.2284348 Vali Loss: 0.2929853 Best vali loss: 0.2780940
	iters: 100, epoch: 7 | loss: 0.3322699
	speed: 0.0055s/iter; left time: 0.8912s
Updating learning rate to 4.633241765625e-06
Epoch: 7 cost time: 0.40502142906188965
Epoch: 7, Steps: 131 | Train Loss: 0.3322699 Vali Loss: 0.2941536 Best vali loss: 0.2780940
	iters: 100, epoch: 8 | loss: 0.3974751
	speed: 0.0056s/iter; left time: 0.1800s
Updating learning rate to 2.3166208828125e-06
Epoch: 8 cost time: 0.42090940475463867
Epoch: 8, Steps: 131 | Train Loss: 0.3974751 Vali Loss: 0.2934480 Best vali loss: 0.2780940

best validation loss 0.2780940275114236

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012750108518, 'e_layers': 3, 'learning_rate': 0.0004735481174, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004735481174
Validation loss decreased (inf --> 0.2794).  Saving model state dict ...
Epoch: 1 cost time: 0.9436688423156738
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2793573 Best vali loss: 0.2793573
Updating learning rate to 0.0002367740587
Epoch: 2 cost time: 0.7236554622650146
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2926718 Best vali loss: 0.2793573
Updating learning rate to 0.00011838702935
Epoch: 3 cost time: 0.7245798110961914
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2932570 Best vali loss: 0.2793573
Updating learning rate to 5.9193514675e-05
Epoch: 4 cost time: 0.7291080951690674
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2904141 Best vali loss: 0.2793573
Updating learning rate to 2.95967573375e-05
Epoch: 5 cost time: 0.7337217330932617
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2839548 Best vali loss: 0.2793573
Updating learning rate to 1.479837866875e-05
Epoch: 6 cost time: 0.7303340435028076
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2987723 Best vali loss: 0.2793573
Updating learning rate to 7.399189334375e-06
Epoch: 7 cost time: 0.7323765754699707
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3006011 Best vali loss: 0.2793573
Updating learning rate to 3.6995946671875e-06
Epoch: 8 cost time: 0.724261999130249
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3011214 Best vali loss: 0.2793573

best validation loss 0.2793573260296229

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008442949786, 'e_layers': 3, 'learning_rate': 0.0004740087933, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00045596790783012156
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.8081841468811035
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2818743 Best vali loss: 0.2818743
Updating learning rate to 0.00040459181269224124
Epoch: 2 cost time: 0.5925838947296143
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2822056 Best vali loss: 0.2818743
Updating learning rate to 0.00032770205264563923
Epoch: 3 cost time: 0.593541145324707
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2953210 Best vali loss: 0.2818743
Updating learning rate to 0.00023700439665
Epoch: 4 cost time: 0.5939054489135742
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2846651 Best vali loss: 0.2818743
Updating learning rate to 0.00014630674065436083
Validation loss decreased (0.2819 --> 0.2770).  Saving model state dict ...
Epoch: 5 cost time: 0.5926423072814941
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2770330 Best vali loss: 0.2770330
Updating learning rate to 6.941698060775875e-05
Epoch: 6 cost time: 0.5950431823730469
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2871714 Best vali loss: 0.2770330
Updating learning rate to 1.8040885469878427e-05
Epoch: 7 cost time: 0.5948858261108398
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2879954 Best vali loss: 0.2770330
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6010634899139404
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2909725 Best vali loss: 0.2770330

best validation loss 0.27703299536586207

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008931944615, 'e_layers': 3, 'learning_rate': 0.0004737307796, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004557004753965277
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.8104760646820068
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2818866 Best vali loss: 0.2818866
Updating learning rate to 0.0004043545131559749
Epoch: 2 cost time: 0.5933208465576172
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2827913 Best vali loss: 0.2818866
Updating learning rate to 0.00032750985017715895
Epoch: 3 cost time: 0.5924272537231445
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2891777 Best vali loss: 0.2818866

best validation loss 0.2818865920695819

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0055653707876, 'e_layers': 2, 'learning_rate': 0.0003139300461, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2110261
	speed: 0.0086s/iter; left time: 35.2902s
	iters: 200, epoch: 1 | loss: 0.7200952
	speed: 0.0033s/iter; left time: 13.1526s
	iters: 300, epoch: 1 | loss: 0.4755152
	speed: 0.0033s/iter; left time: 12.6700s
	iters: 400, epoch: 1 | loss: 0.4205647
	speed: 0.0033s/iter; left time: 12.4065s
	iters: 500, epoch: 1 | loss: 0.2355499
	speed: 0.0033s/iter; left time: 12.3008s
Updating learning rate to 0.0003139300461
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 1.9821631908416748
Epoch: 1, Steps: 523 | Train Loss: 0.4125502 Vali Loss: 0.2861921 Best vali loss: 0.2861921
	iters: 100, epoch: 2 | loss: 0.3166395
	speed: 0.0069s/iter; left time: 24.7084s
	iters: 200, epoch: 2 | loss: 0.3414671
	speed: 0.0030s/iter; left time: 10.3881s
	iters: 300, epoch: 2 | loss: 0.5372137
	speed: 0.0030s/iter; left time: 10.0761s
	iters: 400, epoch: 2 | loss: 0.6881080
	speed: 0.0030s/iter; left time: 9.7963s
	iters: 500, epoch: 2 | loss: 0.4084362
	speed: 0.0030s/iter; left time: 9.4860s
Updating learning rate to 0.00015696502305
Validation loss decreased (0.2862 --> 0.2805).  Saving model state dict ...
Epoch: 2 cost time: 1.6114063262939453
Epoch: 2, Steps: 523 | Train Loss: 0.4583729 Vali Loss: 0.2805080 Best vali loss: 0.2805080
	iters: 100, epoch: 3 | loss: 0.7332268
	speed: 0.0071s/iter; left time: 21.6232s
	iters: 200, epoch: 3 | loss: 0.3582107
	speed: 0.0031s/iter; left time: 9.0765s
	iters: 300, epoch: 3 | loss: 0.5245641
	speed: 0.0031s/iter; left time: 8.7938s
	iters: 400, epoch: 3 | loss: 0.1965383
	speed: 0.0030s/iter; left time: 8.3100s
	iters: 500, epoch: 3 | loss: 0.4053224
	speed: 0.0031s/iter; left time: 8.1925s
Updating learning rate to 7.8482511525e-05
Epoch: 3 cost time: 1.6575360298156738
Epoch: 3, Steps: 523 | Train Loss: 0.4435725 Vali Loss: 0.2819844 Best vali loss: 0.2805080

best validation loss 0.2805080491898449

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011759228595, 'e_layers': 3, 'learning_rate': 0.0004886538695, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004886538695
Validation loss decreased (inf --> 0.2794).  Saving model state dict ...
Epoch: 1 cost time: 0.9572107791900635
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2794409 Best vali loss: 0.2794409
Updating learning rate to 0.00024432693475
Epoch: 2 cost time: 0.7296605110168457
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2886591 Best vali loss: 0.2794409
Updating learning rate to 0.000122163467375
Epoch: 3 cost time: 0.726628303527832
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2887557 Best vali loss: 0.2794409

best validation loss 0.2794409100563387

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011759228595, 'e_layers': 3, 'learning_rate': 0.0004886538695, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.10817336875e-05
Epoch: 4 cost time: 0.9458911418914795
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2889751 Best vali loss: 0.2794409
Updating learning rate to 3.054086684375e-05
Epoch: 5 cost time: 0.723264217376709
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3007431 Best vali loss: 0.2794409
Updating learning rate to 1.5270433421875e-05
Epoch: 6 cost time: 0.7282307147979736
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3013804 Best vali loss: 0.2794409
Updating learning rate to 7.6352167109375e-06
Epoch: 7 cost time: 0.7333323955535889
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3048007 Best vali loss: 0.2794409
Updating learning rate to 3.81760835546875e-06
Epoch: 8 cost time: 0.7214963436126709
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3061933 Best vali loss: 0.2794409

best validation loss 0.2794409100563387

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011217245192, 'e_layers': 3, 'learning_rate': 0.0004884770144, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004884770144
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.9471077919006348
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2792964 Best vali loss: 0.2792964
Updating learning rate to 0.0002442385072
Epoch: 2 cost time: 0.727250337600708
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2905745 Best vali loss: 0.2792964
Updating learning rate to 0.0001221192536
Epoch: 3 cost time: 0.7270674705505371
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2904385 Best vali loss: 0.2792964
Updating learning rate to 6.10596268e-05
Epoch: 4 cost time: 0.7316298484802246
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2994211 Best vali loss: 0.2792964
Updating learning rate to 3.05298134e-05
Epoch: 5 cost time: 0.7292821407318115
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2876682 Best vali loss: 0.2792964
Updating learning rate to 1.52649067e-05
Epoch: 6 cost time: 0.7234959602355957
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3059702 Best vali loss: 0.2792964
Updating learning rate to 7.63245335e-06
Epoch: 7 cost time: 0.727609395980835
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3083453 Best vali loss: 0.2792964
Updating learning rate to 3.816226675e-06
Epoch: 8 cost time: 0.7322850227355957
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3108254 Best vali loss: 0.2792964

best validation loss 0.2792964202014874

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016932561863, 'e_layers': 1, 'learning_rate': 0.0004734561665, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4212021
	speed: 0.0083s/iter; left time: 7.8863s
Updating learning rate to 0.000455436314135303
Validation loss decreased (inf --> 0.2781).  Saving model state dict ...
Epoch: 1 cost time: 0.6484105587005615
Epoch: 1, Steps: 131 | Train Loss: 0.4212021 Vali Loss: 0.2781383 Best vali loss: 0.2781383
	iters: 100, epoch: 2 | loss: 0.5298777
	speed: 0.0055s/iter; left time: 4.5181s
Updating learning rate to 0.00040412011621336857
Epoch: 2 cost time: 0.39717745780944824
Epoch: 2, Steps: 131 | Train Loss: 0.5298777 Vali Loss: 0.2842919 Best vali loss: 0.2781383
	iters: 100, epoch: 3 | loss: 0.4175241
	speed: 0.0053s/iter; left time: 3.6242s
Updating learning rate to 0.00032731999868531876
Epoch: 3 cost time: 0.39424633979797363
Epoch: 3, Steps: 131 | Train Loss: 0.4175241 Vali Loss: 0.2816978 Best vali loss: 0.2781383
	iters: 100, epoch: 4 | loss: 0.4123829
	speed: 0.0053s/iter; left time: 2.9547s
Updating learning rate to 0.00023672808325
Epoch: 4 cost time: 0.3973879814147949
Epoch: 4, Steps: 131 | Train Loss: 0.4123829 Vali Loss: 0.2960296 Best vali loss: 0.2781383
	iters: 100, epoch: 5 | loss: 0.4086810
	speed: 0.0052s/iter; left time: 2.2309s
Updating learning rate to 0.0001461361678146813
Epoch: 5 cost time: 0.38957905769348145
Epoch: 5, Steps: 131 | Train Loss: 0.4086810 Vali Loss: 0.3041260 Best vali loss: 0.2781383
	iters: 100, epoch: 6 | loss: 0.3144199
	speed: 0.0055s/iter; left time: 1.6044s
Updating learning rate to 6.933605028663145e-05
Epoch: 6 cost time: 0.4194655418395996
Epoch: 6, Steps: 131 | Train Loss: 0.3144199 Vali Loss: 0.3069232 Best vali loss: 0.2781383
	iters: 100, epoch: 7 | loss: 0.3059564
	speed: 0.0055s/iter; left time: 0.8941s
Updating learning rate to 1.801985236469703e-05
Epoch: 7 cost time: 0.39937329292297363
Epoch: 7, Steps: 131 | Train Loss: 0.3059564 Vali Loss: 0.3012226 Best vali loss: 0.2781383
	iters: 100, epoch: 8 | loss: 0.4026466
	speed: 0.0054s/iter; left time: 0.1720s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.40534019470214844
Epoch: 8, Steps: 131 | Train Loss: 0.4026466 Vali Loss: 0.3034181 Best vali loss: 0.2781383

best validation loss 0.2781382701950208

[INFO][smbo.py:320] Finished 1200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018537449642, 'e_layers': 1, 'learning_rate': 0.0004732389777, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4193777
	speed: 0.0083s/iter; left time: 7.8708s
Updating learning rate to 0.00045522739159179767
Validation loss decreased (inf --> 0.2780).  Saving model state dict ...
Epoch: 1 cost time: 0.6452505588531494
Epoch: 1, Steps: 131 | Train Loss: 0.4193777 Vali Loss: 0.2779671 Best vali loss: 0.2779671
	iters: 100, epoch: 2 | loss: 0.5292276
	speed: 0.0055s/iter; left time: 4.4694s
Updating learning rate to 0.00040393473397672965
Epoch: 2 cost time: 0.39153218269348145
Epoch: 2, Steps: 131 | Train Loss: 0.5292276 Vali Loss: 0.2824112 Best vali loss: 0.2779671
	iters: 100, epoch: 3 | loss: 0.4219311
	speed: 0.0051s/iter; left time: 3.5152s
Updating learning rate to 0.0003271698470075911
Epoch: 3 cost time: 0.3784935474395752
Epoch: 3, Steps: 131 | Train Loss: 0.4219311 Vali Loss: 0.2846961 Best vali loss: 0.2779671

best validation loss 0.2779670751097035

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0017426832761, 'e_layers': 2, 'learning_rate': 8.83551831e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4037236
	speed: 0.0085s/iter; left time: 70.4377s
	iters: 200, epoch: 1 | loss: 0.9554867
	speed: 0.0033s/iter; left time: 27.1505s
	iters: 300, epoch: 1 | loss: 0.4144079
	speed: 0.0032s/iter; left time: 26.1899s
	iters: 400, epoch: 1 | loss: 0.4045040
	speed: 0.0033s/iter; left time: 26.3930s
	iters: 500, epoch: 1 | loss: 0.4562622
	speed: 0.0033s/iter; left time: 26.2132s
	iters: 600, epoch: 1 | loss: 0.1542730
	speed: 0.0033s/iter; left time: 25.6854s
	iters: 700, epoch: 1 | loss: 0.6936100
	speed: 0.0033s/iter; left time: 25.6164s
	iters: 800, epoch: 1 | loss: 0.4523467
	speed: 0.0033s/iter; left time: 24.9398s
	iters: 900, epoch: 1 | loss: 1.2746142
	speed: 0.0030s/iter; left time: 22.4733s
	iters: 1000, epoch: 1 | loss: 0.5114257
	speed: 0.0031s/iter; left time: 22.6045s
Updating learning rate to 8.499236417868856e-05
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 3.6591639518737793
Epoch: 1, Steps: 1045 | Train Loss: 0.5720654 Vali Loss: 0.2813119 Best vali loss: 0.2813119
	iters: 100, epoch: 2 | loss: 0.2899058
	speed: 0.0100s/iter; left time: 72.2363s
	iters: 200, epoch: 2 | loss: 1.8633162
	speed: 0.0032s/iter; left time: 22.8349s
	iters: 300, epoch: 2 | loss: 0.2213532
	speed: 0.0032s/iter; left time: 22.2576s
	iters: 400, epoch: 2 | loss: 0.7172918
	speed: 0.0032s/iter; left time: 22.3955s
	iters: 500, epoch: 2 | loss: 0.6864640
	speed: 0.0033s/iter; left time: 22.3603s
	iters: 600, epoch: 2 | loss: 1.1508052
	speed: 0.0033s/iter; left time: 21.9516s
	iters: 700, epoch: 2 | loss: 0.1139352
	speed: 0.0033s/iter; left time: 21.5395s
	iters: 800, epoch: 2 | loss: 0.2894149
	speed: 0.0032s/iter; left time: 21.1745s
	iters: 900, epoch: 2 | loss: 0.2264317
	speed: 0.0032s/iter; left time: 20.7613s
	iters: 1000, epoch: 2 | loss: 0.3583317
	speed: 0.0032s/iter; left time: 19.9897s
Updating learning rate to 7.541586611149452e-05
Validation loss decreased (0.2813 --> 0.2785).  Saving model state dict ...
Epoch: 2 cost time: 3.4138004779815674
Epoch: 2, Steps: 1045 | Train Loss: 0.5917250 Vali Loss: 0.2785105 Best vali loss: 0.2785105
	iters: 100, epoch: 3 | loss: 0.6642550
	speed: 0.0100s/iter; left time: 61.9541s
	iters: 200, epoch: 3 | loss: 0.6951658
	speed: 0.0033s/iter; left time: 20.3135s
	iters: 300, epoch: 3 | loss: 0.5078499
	speed: 0.0033s/iter; left time: 19.7623s
	iters: 400, epoch: 3 | loss: 1.3879861
	speed: 0.0033s/iter; left time: 19.3769s
	iters: 500, epoch: 3 | loss: 0.2181568
	speed: 0.0033s/iter; left time: 19.2509s
	iters: 600, epoch: 3 | loss: 0.5959984
	speed: 0.0034s/iter; left time: 19.0487s
	iters: 700, epoch: 3 | loss: 0.3280676
	speed: 0.0034s/iter; left time: 18.7887s
	iters: 800, epoch: 3 | loss: 0.3394942
	speed: 0.0032s/iter; left time: 17.5350s
	iters: 900, epoch: 3 | loss: 1.3135073
	speed: 0.0032s/iter; left time: 17.4420s
	iters: 1000, epoch: 3 | loss: 0.2558529
	speed: 0.0031s/iter; left time: 16.4919s
Updating learning rate to 6.108362391797699e-05
Epoch: 3 cost time: 3.4652364253997803
Epoch: 3, Steps: 1045 | Train Loss: 0.6306334 Vali Loss: 0.2797405 Best vali loss: 0.2785105

best validation loss 0.2785104681963192

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016883223809, 'e_layers': 1, 'learning_rate': 0.0004700701619, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4219619
	speed: 0.0086s/iter; left time: 8.1467s
Updating learning rate to 0.0004521791816618384
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.6874048709869385
Epoch: 1, Steps: 131 | Train Loss: 0.4219619 Vali Loss: 0.2782171 Best vali loss: 0.2782171
	iters: 100, epoch: 2 | loss: 0.5313860
	speed: 0.0059s/iter; left time: 4.8577s
Updating learning rate to 0.0004012299805064741
Epoch: 2 cost time: 0.43656444549560547
Epoch: 2, Steps: 131 | Train Loss: 0.5313860 Vali Loss: 0.2867895 Best vali loss: 0.2782171
	iters: 100, epoch: 3 | loss: 0.4169849
	speed: 0.0057s/iter; left time: 3.9066s
Updating learning rate to 0.00032497911245415274
Epoch: 3 cost time: 0.43536877632141113
Epoch: 3, Steps: 131 | Train Loss: 0.4169849 Vali Loss: 0.2826934 Best vali loss: 0.2782171

best validation loss 0.27821708694737657

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018537449642, 'e_layers': 1, 'learning_rate': 0.0004732389777, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3163525
	speed: 0.0084s/iter; left time: 4.6902s
Updating learning rate to 0.00023661948885
Epoch: 4 cost time: 0.6573700904846191
Epoch: 4, Steps: 131 | Train Loss: 0.3163525 Vali Loss: 0.2972515 Best vali loss: 0.2779671
	iters: 100, epoch: 5 | loss: 0.4062905
	speed: 0.0058s/iter; left time: 2.4619s
Updating learning rate to 0.00014606913069240894
Epoch: 5 cost time: 0.449749231338501
Epoch: 5, Steps: 131 | Train Loss: 0.4062905 Vali Loss: 0.3024450 Best vali loss: 0.2779671
	iters: 100, epoch: 6 | loss: 0.3577619
	speed: 0.0058s/iter; left time: 1.6927s
Updating learning rate to 6.930424372327035e-05
Epoch: 6 cost time: 0.42870140075683594
Epoch: 6, Steps: 131 | Train Loss: 0.3577619 Vali Loss: 0.3013351 Best vali loss: 0.2779671
	iters: 100, epoch: 7 | loss: 0.3472105
	speed: 0.0056s/iter; left time: 0.9070s
Updating learning rate to 1.8011586108202374e-05
Epoch: 7 cost time: 0.41932034492492676
Epoch: 7, Steps: 131 | Train Loss: 0.3472105 Vali Loss: 0.3043110 Best vali loss: 0.2779671
	iters: 100, epoch: 8 | loss: 0.3721343
	speed: 0.0055s/iter; left time: 0.1754s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4115269184112549
Epoch: 8, Steps: 131 | Train Loss: 0.3721343 Vali Loss: 0.3043399 Best vali loss: 0.2779671

best validation loss 0.2779670751097035

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017608335373, 'e_layers': 1, 'learning_rate': 0.0004699692839, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4213411
	speed: 0.0082s/iter; left time: 7.8221s
Updating learning rate to 0.0004520821431020981
Validation loss decreased (inf --> 0.2783).  Saving model state dict ...
Epoch: 1 cost time: 0.6492893695831299
Epoch: 1, Steps: 131 | Train Loss: 0.4213411 Vali Loss: 0.2783171 Best vali loss: 0.2783171
	iters: 100, epoch: 2 | loss: 0.5301877
	speed: 0.0055s/iter; left time: 4.5104s
Updating learning rate to 0.0004011438757475379
Epoch: 2 cost time: 0.4018228054046631
Epoch: 2, Steps: 131 | Train Loss: 0.5301877 Vali Loss: 0.2832031 Best vali loss: 0.2783171
	iters: 100, epoch: 3 | loss: 0.4195214
	speed: 0.0055s/iter; left time: 3.7594s
Updating learning rate to 0.0003249093712845077
Epoch: 3 cost time: 0.42072129249572754
Epoch: 3, Steps: 131 | Train Loss: 0.4195214 Vali Loss: 0.2855409 Best vali loss: 0.2783171
	iters: 100, epoch: 4 | loss: 0.4173360
	speed: 0.0055s/iter; left time: 3.0812s
Updating learning rate to 0.00023498464195
Epoch: 4 cost time: 0.4179701805114746
Epoch: 4, Steps: 131 | Train Loss: 0.4173360 Vali Loss: 0.2926677 Best vali loss: 0.2783171
	iters: 100, epoch: 5 | loss: 0.4173960
	speed: 0.0056s/iter; left time: 2.3591s
Updating learning rate to 0.00014505991261549235
Epoch: 5 cost time: 0.41196513175964355
Epoch: 5, Steps: 131 | Train Loss: 0.4173960 Vali Loss: 0.2989716 Best vali loss: 0.2783171
	iters: 100, epoch: 6 | loss: 0.3174920
	speed: 0.0052s/iter; left time: 1.5391s
Updating learning rate to 6.882540815246215e-05
Epoch: 6 cost time: 0.3828566074371338
Epoch: 6, Steps: 131 | Train Loss: 0.3174920 Vali Loss: 0.3044053 Best vali loss: 0.2783171
	iters: 100, epoch: 7 | loss: 0.3054076
	speed: 0.0051s/iter; left time: 0.8288s
Updating learning rate to 1.7887140797901902e-05
Epoch: 7 cost time: 0.3812243938446045
Epoch: 7, Steps: 131 | Train Loss: 0.3054076 Vali Loss: 0.2997790 Best vali loss: 0.2783171
	iters: 100, epoch: 8 | loss: 0.4052340
	speed: 0.0053s/iter; left time: 0.1705s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4121077060699463
Epoch: 8, Steps: 131 | Train Loss: 0.4052340 Vali Loss: 0.3039990 Best vali loss: 0.2783171

best validation loss 0.2783171434181248

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017175234758, 'e_layers': 3, 'learning_rate': 0.000471154082, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5197776
	speed: 0.0120s/iter; left time: 11.3628s
Updating learning rate to 0.00045322184750947223
Validation loss decreased (inf --> 0.2745).  Saving model state dict ...
Epoch: 1 cost time: 1.144289255142212
Epoch: 1, Steps: 131 | Train Loss: 0.5197776 Vali Loss: 0.2744601 Best vali loss: 0.2744601
	iters: 100, epoch: 2 | loss: 0.5874717
	speed: 0.0113s/iter; left time: 9.2438s
Updating learning rate to 0.0004021551641829613
Epoch: 2 cost time: 0.912813663482666
Epoch: 2, Steps: 131 | Train Loss: 0.5874717 Vali Loss: 0.2941459 Best vali loss: 0.2744601
	iters: 100, epoch: 3 | loss: 0.5085485
	speed: 0.0110s/iter; left time: 7.5794s
Updating learning rate to 0.0003257284716362915
Epoch: 3 cost time: 0.9084718227386475
Epoch: 3, Steps: 131 | Train Loss: 0.5085485 Vali Loss: 0.2826790 Best vali loss: 0.2744601
	iters: 100, epoch: 4 | loss: 0.3114448
	speed: 0.0111s/iter; left time: 6.1902s
Updating learning rate to 0.000235577041
Epoch: 4 cost time: 0.9194340705871582
Epoch: 4, Steps: 131 | Train Loss: 0.3114448 Vali Loss: 0.2781912 Best vali loss: 0.2744601
	iters: 100, epoch: 5 | loss: 0.3006808
	speed: 0.0110s/iter; left time: 4.6776s
Updating learning rate to 0.00014542561036370852
Epoch: 5 cost time: 0.9116990566253662
Epoch: 5, Steps: 131 | Train Loss: 0.3006808 Vali Loss: 0.3009278 Best vali loss: 0.2744601
	iters: 100, epoch: 6 | loss: 0.2959573
	speed: 0.0112s/iter; left time: 3.2962s
Updating learning rate to 6.899891781703868e-05
Epoch: 6 cost time: 0.9312453269958496
Epoch: 6, Steps: 131 | Train Loss: 0.2959573 Vali Loss: 0.3137216 Best vali loss: 0.2744601
	iters: 100, epoch: 7 | loss: 0.3316911
	speed: 0.0112s/iter; left time: 1.8201s
Updating learning rate to 1.793223449052777e-05
Epoch: 7 cost time: 0.909968376159668
Epoch: 7, Steps: 131 | Train Loss: 0.3316911 Vali Loss: 0.3174201 Best vali loss: 0.2744601
	iters: 100, epoch: 8 | loss: 0.2897894
	speed: 0.0110s/iter; left time: 0.3519s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9105229377746582
Epoch: 8, Steps: 131 | Train Loss: 0.2897894 Vali Loss: 0.3222883 Best vali loss: 0.2744601

best validation loss 0.2744601268824169

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010267041315, 'e_layers': 4, 'learning_rate': 0.0004733921175, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3318921
	speed: 0.0142s/iter; left time: 13.4634s
Updating learning rate to 0.00045537470285521406
Validation loss decreased (inf --> 0.2891).  Saving model state dict ...
Epoch: 1 cost time: 1.4087848663330078
Epoch: 1, Steps: 131 | Train Loss: 0.3318921 Vali Loss: 0.2890823 Best vali loss: 0.2890823
	iters: 100, epoch: 2 | loss: 0.4873328
	speed: 0.0145s/iter; left time: 11.8441s
Updating learning rate to 0.00040406544697225446
Validation loss decreased (0.2891 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 1.1858713626861572
Epoch: 2, Steps: 131 | Train Loss: 0.4873328 Vali Loss: 0.2838596 Best vali loss: 0.2838596
	iters: 100, epoch: 3 | loss: 0.4126841
	speed: 0.0145s/iter; left time: 9.9918s
Updating learning rate to 0.000327275718939739
Validation loss decreased (0.2839 --> 0.2797).  Saving model state dict ...
Epoch: 3 cost time: 1.1811165809631348
Epoch: 3, Steps: 131 | Train Loss: 0.4126841 Vali Loss: 0.2796627 Best vali loss: 0.2796627

best validation loss 0.27966267400268463

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009622369715, 'e_layers': 3, 'learning_rate': 0.0001427312038, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5760992
	speed: 0.0101s/iter; left time: 41.1224s
	iters: 200, epoch: 1 | loss: 0.2378938
	speed: 0.0047s/iter; left time: 18.6542s
	iters: 300, epoch: 1 | loss: 0.6546641
	speed: 0.0047s/iter; left time: 18.2161s
	iters: 400, epoch: 1 | loss: 0.3549813
	speed: 0.0047s/iter; left time: 17.8017s
	iters: 500, epoch: 1 | loss: 0.6758369
	speed: 0.0045s/iter; left time: 16.5615s
Updating learning rate to 0.0001427312038
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 2.6872668266296387
Epoch: 1, Steps: 523 | Train Loss: 0.4998950 Vali Loss: 0.2801951 Best vali loss: 0.2801951
	iters: 100, epoch: 2 | loss: 0.3839309
	speed: 0.0099s/iter; left time: 35.2813s
	iters: 200, epoch: 2 | loss: 0.2703717
	speed: 0.0045s/iter; left time: 15.5713s
	iters: 300, epoch: 2 | loss: 0.1771986
	speed: 0.0047s/iter; left time: 15.7129s
	iters: 400, epoch: 2 | loss: 0.4100072
	speed: 0.0047s/iter; left time: 15.1704s
	iters: 500, epoch: 2 | loss: 0.2478871
	speed: 0.0046s/iter; left time: 14.6388s
Updating learning rate to 7.13656019e-05
Validation loss decreased (0.2802 --> 0.2720).  Saving model state dict ...
Epoch: 2 cost time: 2.442134141921997
Epoch: 2, Steps: 523 | Train Loss: 0.2978791 Vali Loss: 0.2720403 Best vali loss: 0.2720403
	iters: 100, epoch: 3 | loss: 0.9246942
	speed: 0.0099s/iter; left time: 30.1341s
	iters: 200, epoch: 3 | loss: 0.2953398
	speed: 0.0044s/iter; left time: 12.9272s
	iters: 300, epoch: 3 | loss: 0.6168821
	speed: 0.0044s/iter; left time: 12.5014s
	iters: 400, epoch: 3 | loss: 0.3201658
	speed: 0.0044s/iter; left time: 12.0804s
	iters: 500, epoch: 3 | loss: 0.4582554
	speed: 0.0044s/iter; left time: 11.5996s
Updating learning rate to 3.568280095e-05
Epoch: 3 cost time: 2.349195957183838
Epoch: 3, Steps: 523 | Train Loss: 0.5230675 Vali Loss: 0.2797544 Best vali loss: 0.2720403

best validation loss 0.2720402522395649

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.00100498457, 'e_layers': 1, 'learning_rate': 0.0006916788709, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4153612
	speed: 0.0077s/iter; left time: 63.2159s
	iters: 200, epoch: 1 | loss: 0.1983517
	speed: 0.0025s/iter; left time: 20.0497s
	iters: 300, epoch: 1 | loss: 0.4760990
	speed: 0.0024s/iter; left time: 19.2993s
	iters: 400, epoch: 1 | loss: 0.4602489
	speed: 0.0023s/iter; left time: 18.2010s
	iters: 500, epoch: 1 | loss: 0.7384443
	speed: 0.0023s/iter; left time: 17.6989s
	iters: 600, epoch: 1 | loss: 0.3415243
	speed: 0.0024s/iter; left time: 18.8125s
	iters: 700, epoch: 1 | loss: 0.4633279
	speed: 0.0023s/iter; left time: 17.3832s
	iters: 800, epoch: 1 | loss: 1.0988600
	speed: 0.0023s/iter; left time: 17.3419s
	iters: 900, epoch: 1 | loss: 0.4791534
	speed: 0.0023s/iter; left time: 17.0008s
	iters: 1000, epoch: 1 | loss: 0.3415526
	speed: 0.0023s/iter; left time: 16.8001s
Updating learning rate to 0.0006916788709
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 2.6976478099823
Epoch: 1, Steps: 1045 | Train Loss: 0.5012923 Vali Loss: 0.2878219 Best vali loss: 0.2878219
	iters: 100, epoch: 2 | loss: 0.2564582
	speed: 0.0079s/iter; left time: 56.9962s
	iters: 200, epoch: 2 | loss: 0.3379354
	speed: 0.0023s/iter; left time: 16.5365s
	iters: 300, epoch: 2 | loss: 1.1169410
	speed: 0.0022s/iter; left time: 15.5663s
	iters: 400, epoch: 2 | loss: 0.2348863
	speed: 0.0022s/iter; left time: 15.2841s
	iters: 500, epoch: 2 | loss: 0.3285091
	speed: 0.0022s/iter; left time: 15.0438s
	iters: 600, epoch: 2 | loss: 1.1103797
	speed: 0.0022s/iter; left time: 14.7683s
	iters: 700, epoch: 2 | loss: 0.5031216
	speed: 0.0022s/iter; left time: 14.5206s
	iters: 800, epoch: 2 | loss: 0.5458887
	speed: 0.0022s/iter; left time: 14.2638s
	iters: 900, epoch: 2 | loss: 0.3908733
	speed: 0.0022s/iter; left time: 14.1863s
	iters: 1000, epoch: 2 | loss: 0.6179299
	speed: 0.0023s/iter; left time: 14.2973s
Updating learning rate to 0.00034583943545
Validation loss decreased (0.2878 --> 0.2849).  Saving model state dict ...
Epoch: 2 cost time: 2.3656322956085205
Epoch: 2, Steps: 1045 | Train Loss: 0.5442923 Vali Loss: 0.2848905 Best vali loss: 0.2848905
	iters: 100, epoch: 3 | loss: 0.4400114
	speed: 0.0079s/iter; left time: 48.5342s
	iters: 200, epoch: 3 | loss: 0.4337348
	speed: 0.0022s/iter; left time: 13.2074s
	iters: 300, epoch: 3 | loss: 0.2561998
	speed: 0.0022s/iter; left time: 12.9991s
	iters: 400, epoch: 3 | loss: 0.3076662
	speed: 0.0022s/iter; left time: 12.7603s
	iters: 500, epoch: 3 | loss: 0.4537178
	speed: 0.0021s/iter; left time: 12.3731s
	iters: 600, epoch: 3 | loss: 0.2479314
	speed: 0.0022s/iter; left time: 12.7197s
	iters: 700, epoch: 3 | loss: 0.4154937
	speed: 0.0022s/iter; left time: 12.5108s
	iters: 800, epoch: 3 | loss: 0.4328847
	speed: 0.0022s/iter; left time: 12.0804s
	iters: 900, epoch: 3 | loss: 0.4436717
	speed: 0.0022s/iter; left time: 11.7983s
	iters: 1000, epoch: 3 | loss: 0.3462611
	speed: 0.0022s/iter; left time: 11.5823s
Updating learning rate to 0.000172919717725
Epoch: 3 cost time: 2.323277711868286
Epoch: 3, Steps: 1045 | Train Loss: 0.3777573 Vali Loss: 0.2884140 Best vali loss: 0.2848905

best validation loss 0.2848905065370874

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009622369715, 'e_layers': 3, 'learning_rate': 0.0001427312038, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5003435
	speed: 0.0107s/iter; left time: 27.0377s
	iters: 200, epoch: 4 | loss: 0.1893300
	speed: 0.0046s/iter; left time: 11.0731s
	iters: 300, epoch: 4 | loss: 0.4503851
	speed: 0.0045s/iter; left time: 10.5229s
	iters: 400, epoch: 4 | loss: 0.2756170
	speed: 0.0045s/iter; left time: 10.0151s
	iters: 500, epoch: 4 | loss: 0.5732175
	speed: 0.0045s/iter; left time: 9.4706s
Updating learning rate to 1.7841400475e-05
Epoch: 4 cost time: 2.6652987003326416
Epoch: 4, Steps: 523 | Train Loss: 0.3977786 Vali Loss: 0.2823044 Best vali loss: 0.2720403
	iters: 100, epoch: 5 | loss: 0.2483844
	speed: 0.0096s/iter; left time: 19.0423s
	iters: 200, epoch: 5 | loss: 0.2344038
	speed: 0.0045s/iter; left time: 8.4270s
	iters: 300, epoch: 5 | loss: 0.1736203
	speed: 0.0044s/iter; left time: 7.9787s
	iters: 400, epoch: 5 | loss: 0.3793699
	speed: 0.0044s/iter; left time: 7.5056s
	iters: 500, epoch: 5 | loss: 0.2071009
	speed: 0.0045s/iter; left time: 7.1159s
Updating learning rate to 8.9207002375e-06
Epoch: 5 cost time: 2.372230291366577
Epoch: 5, Steps: 523 | Train Loss: 0.2485759 Vali Loss: 0.2812376 Best vali loss: 0.2720403
	iters: 100, epoch: 6 | loss: 0.7355188
	speed: 0.0094s/iter; left time: 13.7805s
	iters: 200, epoch: 6 | loss: 0.2728853
	speed: 0.0043s/iter; left time: 5.9162s
	iters: 300, epoch: 6 | loss: 0.5001664
	speed: 0.0043s/iter; left time: 5.4752s
	iters: 400, epoch: 6 | loss: 0.3124972
	speed: 0.0043s/iter; left time: 5.0700s
	iters: 500, epoch: 6 | loss: 0.2988572
	speed: 0.0043s/iter; left time: 4.6222s
Updating learning rate to 4.46035011875e-06
Epoch: 6 cost time: 2.306206703186035
Epoch: 6, Steps: 523 | Train Loss: 0.4239850 Vali Loss: 0.2864280 Best vali loss: 0.2720403
	iters: 100, epoch: 7 | loss: 0.3161892
	speed: 0.0094s/iter; left time: 8.9135s
	iters: 200, epoch: 7 | loss: 0.2583210
	speed: 0.0043s/iter; left time: 3.6639s
	iters: 300, epoch: 7 | loss: 0.4169411
	speed: 0.0043s/iter; left time: 3.2307s
	iters: 400, epoch: 7 | loss: 0.2470958
	speed: 0.0043s/iter; left time: 2.7928s
	iters: 500, epoch: 7 | loss: 0.4754190
	speed: 0.0043s/iter; left time: 2.3542s
Updating learning rate to 2.230175059375e-06
Epoch: 7 cost time: 2.2976431846618652
Epoch: 7, Steps: 523 | Train Loss: 0.3427932 Vali Loss: 0.2859857 Best vali loss: 0.2720403
	iters: 100, epoch: 8 | loss: 0.1868203
	speed: 0.0092s/iter; left time: 3.9135s
	iters: 200, epoch: 8 | loss: 0.2244936
	speed: 0.0043s/iter; left time: 1.4031s
	iters: 300, epoch: 8 | loss: 0.3587293
	speed: 0.0043s/iter; left time: 0.9686s
	iters: 400, epoch: 8 | loss: 0.2676152
	speed: 0.0043s/iter; left time: 0.5372s
	iters: 500, epoch: 8 | loss: 0.3544168
	speed: 0.0043s/iter; left time: 0.1041s
Updating learning rate to 1.1150875296875e-06
Epoch: 8 cost time: 2.3008546829223633
Epoch: 8, Steps: 523 | Train Loss: 0.2784150 Vali Loss: 0.2875444 Best vali loss: 0.2720403

best validation loss 0.2720402522395649

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038856565761, 'e_layers': 2, 'learning_rate': 0.0001470072765, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3577343
	speed: 0.0086s/iter; left time: 71.0491s
	iters: 200, epoch: 1 | loss: 0.3421971
	speed: 0.0031s/iter; left time: 25.3078s
	iters: 300, epoch: 1 | loss: 0.9902608
	speed: 0.0031s/iter; left time: 25.0419s
	iters: 400, epoch: 1 | loss: 0.6497359
	speed: 0.0031s/iter; left time: 24.6759s
	iters: 500, epoch: 1 | loss: 0.5212597
	speed: 0.0033s/iter; left time: 25.6776s
	iters: 600, epoch: 1 | loss: 0.6626974
	speed: 0.0032s/iter; left time: 24.7424s
	iters: 700, epoch: 1 | loss: 0.5949977
	speed: 0.0032s/iter; left time: 24.2943s
	iters: 800, epoch: 1 | loss: 0.1866393
	speed: 0.0031s/iter; left time: 23.7680s
	iters: 900, epoch: 1 | loss: 0.2071768
	speed: 0.0031s/iter; left time: 23.0233s
	iters: 1000, epoch: 1 | loss: 0.2277340
	speed: 0.0031s/iter; left time: 23.0382s
Updating learning rate to 0.0001470072765
Validation loss decreased (inf --> 0.2772).  Saving model state dict ...
Epoch: 1 cost time: 3.5501275062561035
Epoch: 1, Steps: 1045 | Train Loss: 0.4740433 Vali Loss: 0.2772417 Best vali loss: 0.2772417
	iters: 100, epoch: 2 | loss: 0.3874823
	speed: 0.0100s/iter; left time: 72.1398s
	iters: 200, epoch: 2 | loss: 0.2747785
	speed: 0.0031s/iter; left time: 21.7108s
	iters: 300, epoch: 2 | loss: 0.2720746
	speed: 0.0029s/iter; left time: 20.4948s
	iters: 400, epoch: 2 | loss: 0.3370290
	speed: 0.0030s/iter; left time: 20.5560s
	iters: 500, epoch: 2 | loss: 0.1458155
	speed: 0.0030s/iter; left time: 20.2568s
	iters: 600, epoch: 2 | loss: 0.2804107
	speed: 0.0029s/iter; left time: 19.3400s
	iters: 700, epoch: 2 | loss: 0.2471821
	speed: 0.0029s/iter; left time: 18.9917s
	iters: 800, epoch: 2 | loss: 0.1590373
	speed: 0.0029s/iter; left time: 18.8042s
	iters: 900, epoch: 2 | loss: 0.3095785
	speed: 0.0029s/iter; left time: 18.4897s
	iters: 1000, epoch: 2 | loss: 0.5979937
	speed: 0.0029s/iter; left time: 18.3970s
Updating learning rate to 7.350363825e-05
Epoch: 2 cost time: 3.1159348487854004
Epoch: 2, Steps: 1045 | Train Loss: 0.3011382 Vali Loss: 0.2787233 Best vali loss: 0.2772417
	iters: 100, epoch: 3 | loss: 0.6471130
	speed: 0.0097s/iter; left time: 59.8430s
	iters: 200, epoch: 3 | loss: 0.5473163
	speed: 0.0030s/iter; left time: 18.1630s
	iters: 300, epoch: 3 | loss: 0.1588638
	speed: 0.0030s/iter; left time: 17.8446s
	iters: 400, epoch: 3 | loss: 0.3320550
	speed: 0.0030s/iter; left time: 17.5582s
	iters: 500, epoch: 3 | loss: 0.2511831
	speed: 0.0030s/iter; left time: 17.3133s
	iters: 600, epoch: 3 | loss: 0.4054716
	speed: 0.0030s/iter; left time: 17.0177s
	iters: 700, epoch: 3 | loss: 0.1893196
	speed: 0.0030s/iter; left time: 16.7040s
	iters: 800, epoch: 3 | loss: 0.3801285
	speed: 0.0030s/iter; left time: 16.3136s
	iters: 900, epoch: 3 | loss: 0.1694067
	speed: 0.0030s/iter; left time: 16.0429s
	iters: 1000, epoch: 3 | loss: 0.2550332
	speed: 0.0030s/iter; left time: 15.6296s
Updating learning rate to 3.6751819125e-05
Epoch: 3 cost time: 3.164719343185425
Epoch: 3, Steps: 1045 | Train Loss: 0.3335891 Vali Loss: 0.2803340 Best vali loss: 0.2772417
	iters: 100, epoch: 4 | loss: 0.7419263
	speed: 0.0096s/iter; left time: 49.4118s
	iters: 200, epoch: 4 | loss: 0.3772211
	speed: 0.0030s/iter; left time: 15.1006s
	iters: 300, epoch: 4 | loss: 1.1880015
	speed: 0.0029s/iter; left time: 14.5206s
	iters: 400, epoch: 4 | loss: 0.3962006
	speed: 0.0030s/iter; left time: 14.2702s
	iters: 500, epoch: 4 | loss: 0.3427262
	speed: 0.0030s/iter; left time: 14.0310s
	iters: 600, epoch: 4 | loss: 0.7919195
	speed: 0.0029s/iter; left time: 13.5568s
	iters: 700, epoch: 4 | loss: 0.4361193
	speed: 0.0030s/iter; left time: 13.4899s
	iters: 800, epoch: 4 | loss: 0.1882990
	speed: 0.0030s/iter; left time: 13.3118s
	iters: 900, epoch: 4 | loss: 0.2313561
	speed: 0.0032s/iter; left time: 13.9954s
	iters: 1000, epoch: 4 | loss: 0.2869779
	speed: 0.0030s/iter; left time: 12.8470s
Updating learning rate to 1.83759095625e-05
Epoch: 4 cost time: 3.1740033626556396
Epoch: 4, Steps: 1045 | Train Loss: 0.4980747 Vali Loss: 0.2794548 Best vali loss: 0.2772417
	iters: 100, epoch: 5 | loss: 0.4602358
	speed: 0.0100s/iter; left time: 40.8666s
	iters: 200, epoch: 5 | loss: 0.9016137
	speed: 0.0033s/iter; left time: 12.9684s
	iters: 300, epoch: 5 | loss: 0.4046006
	speed: 0.0033s/iter; left time: 12.8826s
	iters: 400, epoch: 5 | loss: 0.3213777
	speed: 0.0033s/iter; left time: 12.6100s
	iters: 500, epoch: 5 | loss: 0.3091965
	speed: 0.0033s/iter; left time: 12.2518s
	iters: 600, epoch: 5 | loss: 0.4481548
	speed: 0.0033s/iter; left time: 11.7732s
	iters: 700, epoch: 5 | loss: 0.2174245
	speed: 0.0031s/iter; left time: 10.7171s
	iters: 800, epoch: 5 | loss: 0.4139021
	speed: 0.0033s/iter; left time: 11.2342s
	iters: 900, epoch: 5 | loss: 0.4959790
	speed: 0.0033s/iter; left time: 10.8873s
	iters: 1000, epoch: 5 | loss: 0.2642240
	speed: 0.0033s/iter; left time: 10.3655s
Updating learning rate to 9.18795478125e-06
Epoch: 5 cost time: 3.442561149597168
Epoch: 5, Steps: 1045 | Train Loss: 0.4236709 Vali Loss: 0.2876358 Best vali loss: 0.2772417
	iters: 100, epoch: 6 | loss: 1.5057235
	speed: 0.0096s/iter; left time: 29.1016s
	iters: 200, epoch: 6 | loss: 0.3152630
	speed: 0.0029s/iter; left time: 8.3799s
	iters: 300, epoch: 6 | loss: 0.3821474
	speed: 0.0029s/iter; left time: 8.1868s
	iters: 400, epoch: 6 | loss: 0.9182804
	speed: 0.0029s/iter; left time: 7.8804s
	iters: 500, epoch: 6 | loss: 0.3238191
	speed: 0.0029s/iter; left time: 7.6540s
	iters: 600, epoch: 6 | loss: 0.4518367
	speed: 0.0029s/iter; left time: 7.3698s
	iters: 700, epoch: 6 | loss: 0.9063336
	speed: 0.0029s/iter; left time: 7.0982s
	iters: 800, epoch: 6 | loss: 0.5477181
	speed: 0.0030s/iter; left time: 6.9076s
	iters: 900, epoch: 6 | loss: 0.5109426
	speed: 0.0029s/iter; left time: 6.5958s
	iters: 1000, epoch: 6 | loss: 0.9978269
	speed: 0.0029s/iter; left time: 6.2407s
Updating learning rate to 4.593977390625e-06
Epoch: 6 cost time: 3.0769524574279785
Epoch: 6, Steps: 1045 | Train Loss: 0.6859891 Vali Loss: 0.2854037 Best vali loss: 0.2772417
	iters: 100, epoch: 7 | loss: 0.4195604
	speed: 0.0096s/iter; left time: 19.1162s
	iters: 200, epoch: 7 | loss: 0.9635951
	speed: 0.0030s/iter; left time: 5.6715s
	iters: 300, epoch: 7 | loss: 0.1871511
	speed: 0.0029s/iter; left time: 5.1900s
	iters: 400, epoch: 7 | loss: 0.2603297
	speed: 0.0029s/iter; left time: 4.8536s
	iters: 500, epoch: 7 | loss: 0.3096642
	speed: 0.0029s/iter; left time: 4.5621s
	iters: 600, epoch: 7 | loss: 0.4606286
	speed: 0.0029s/iter; left time: 4.2869s
	iters: 700, epoch: 7 | loss: 0.4309011
	speed: 0.0029s/iter; left time: 4.0061s
	iters: 800, epoch: 7 | loss: 0.2368002
	speed: 0.0029s/iter; left time: 3.7200s
	iters: 900, epoch: 7 | loss: 0.2175782
	speed: 0.0029s/iter; left time: 3.4259s
	iters: 1000, epoch: 7 | loss: 0.3447491
	speed: 0.0029s/iter; left time: 3.1675s
Updating learning rate to 2.2969886953125e-06
Epoch: 7 cost time: 3.0684666633605957
Epoch: 7, Steps: 1045 | Train Loss: 0.3830958 Vali Loss: 0.2864788 Best vali loss: 0.2772417
	iters: 100, epoch: 8 | loss: 0.3786182
	speed: 0.0099s/iter; left time: 9.4068s
	iters: 200, epoch: 8 | loss: 0.2622003
	speed: 0.0033s/iter; left time: 2.7889s
	iters: 300, epoch: 8 | loss: 0.7534885
	speed: 0.0033s/iter; left time: 2.4544s
	iters: 400, epoch: 8 | loss: 0.9816276
	speed: 0.0033s/iter; left time: 2.1515s
	iters: 500, epoch: 8 | loss: 0.9590618
	speed: 0.0033s/iter; left time: 1.7996s
	iters: 600, epoch: 8 | loss: 0.6408533
	speed: 0.0033s/iter; left time: 1.4737s
	iters: 700, epoch: 8 | loss: 0.4461184
	speed: 0.0033s/iter; left time: 1.1348s
	iters: 800, epoch: 8 | loss: 0.4984135
	speed: 0.0032s/iter; left time: 0.7801s
	iters: 900, epoch: 8 | loss: 0.3744023
	speed: 0.0031s/iter; left time: 0.4573s
	iters: 1000, epoch: 8 | loss: 0.6300601
	speed: 0.0031s/iter; left time: 0.1440s
Updating learning rate to 1.14849434765625e-06
Epoch: 8 cost time: 3.4330365657806396
Epoch: 8, Steps: 1045 | Train Loss: 0.5924844 Vali Loss: 0.2841529 Best vali loss: 0.2772417

best validation loss 0.2772416997993245

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021498009258, 'e_layers': 3, 'learning_rate': 0.0004754282718, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5190852
	speed: 0.0120s/iter; left time: 11.4032s
Updating learning rate to 0.0004573333606466165
Validation loss decreased (inf --> 0.2758).  Saving model state dict ...
Epoch: 1 cost time: 1.13724946975708
Epoch: 1, Steps: 131 | Train Loss: 0.5190852 Vali Loss: 0.2758466 Best vali loss: 0.2758466
	iters: 100, epoch: 2 | loss: 0.5301900
	speed: 0.0113s/iter; left time: 9.2186s
Updating learning rate to 0.0004058034133787905
Validation loss decreased (0.2758 --> 0.2750).  Saving model state dict ...
Epoch: 2 cost time: 0.9096722602844238
Epoch: 2, Steps: 131 | Train Loss: 0.5301900 Vali Loss: 0.2749805 Best vali loss: 0.2749805
	iters: 100, epoch: 3 | loss: 0.5142782
	speed: 0.0115s/iter; left time: 7.9121s
Updating learning rate to 0.00032868339734791344
Epoch: 3 cost time: 0.9150540828704834
Epoch: 3, Steps: 131 | Train Loss: 0.5142782 Vali Loss: 0.2959325 Best vali loss: 0.2749805
	iters: 100, epoch: 4 | loss: 0.3208134
	speed: 0.0109s/iter; left time: 6.0744s
Updating learning rate to 0.0002377141359
Epoch: 4 cost time: 0.9043455123901367
Epoch: 4, Steps: 131 | Train Loss: 0.3208134 Vali Loss: 0.2776384 Best vali loss: 0.2749805
	iters: 100, epoch: 5 | loss: 0.3124581
	speed: 0.0109s/iter; left time: 4.6325s
Updating learning rate to 0.0001467448744520866
Epoch: 5 cost time: 0.9063916206359863
Epoch: 5, Steps: 131 | Train Loss: 0.3124581 Vali Loss: 0.2819603 Best vali loss: 0.2749805
	iters: 100, epoch: 6 | loss: 0.3113598
	speed: 0.0110s/iter; left time: 3.2268s
Updating learning rate to 6.962485842120949e-05
Epoch: 6 cost time: 0.9115309715270996
Epoch: 6, Steps: 131 | Train Loss: 0.3113598 Vali Loss: 0.2911082 Best vali loss: 0.2749805
	iters: 100, epoch: 7 | loss: 0.3468331
	speed: 0.0110s/iter; left time: 1.7960s
Updating learning rate to 1.8094911153383516e-05
Epoch: 7 cost time: 0.9186837673187256
Epoch: 7, Steps: 131 | Train Loss: 0.3468331 Vali Loss: 0.2991490 Best vali loss: 0.2749805
	iters: 100, epoch: 8 | loss: 0.3104624
	speed: 0.0110s/iter; left time: 0.3534s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9093325138092041
Epoch: 8, Steps: 131 | Train Loss: 0.3104624 Vali Loss: 0.3040762 Best vali loss: 0.2749805

best validation loss 0.2749805491335909

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0037308743484, 'e_layers': 2, 'learning_rate': 0.0001999479835, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6932651
	speed: 0.0091s/iter; left time: 18.0983s
	iters: 200, epoch: 1 | loss: 0.6107062
	speed: 0.0034s/iter; left time: 6.4518s
Updating learning rate to 0.00019233791651127722
Validation loss decreased (inf --> 0.2886).  Saving model state dict ...
Epoch: 1 cost time: 1.1741182804107666
Epoch: 1, Steps: 262 | Train Loss: 0.6519857 Vali Loss: 0.2885910 Best vali loss: 0.2885910
	iters: 100, epoch: 2 | loss: 0.6751928
	speed: 0.0081s/iter; left time: 14.0425s
	iters: 200, epoch: 2 | loss: 0.4220678
	speed: 0.0036s/iter; left time: 5.8279s
Updating learning rate to 0.00017066627925871295
Validation loss decreased (0.2886 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 0.9808433055877686
Epoch: 2, Steps: 262 | Train Loss: 0.5486303 Vali Loss: 0.2817519 Best vali loss: 0.2817519
	iters: 100, epoch: 3 | loss: 0.6477334
	speed: 0.0080s/iter; left time: 11.7170s
	iters: 200, epoch: 3 | loss: 0.8571776
	speed: 0.0031s/iter; left time: 4.2853s
Updating learning rate to 0.00013823238206012915
Epoch: 3 cost time: 0.8840506076812744
Epoch: 3, Steps: 262 | Train Loss: 0.7524555 Vali Loss: 0.2822038 Best vali loss: 0.2817519

best validation loss 0.281751891634818

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.004519690274, 'e_layers': 2, 'learning_rate': 7.69189333e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.69189333e-05
Validation loss decreased (inf --> 0.3115).  Saving model state dict ...
Epoch: 1 cost time: 0.5517377853393555
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3114670 Best vali loss: 0.3114670
Updating learning rate to 3.845946665e-05
Validation loss decreased (0.3115 --> 0.2939).  Saving model state dict ...
Epoch: 2 cost time: 0.30887341499328613
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2938875 Best vali loss: 0.2938875
Updating learning rate to 1.9229733325e-05
Validation loss decreased (0.2939 --> 0.2887).  Saving model state dict ...
Epoch: 3 cost time: 0.324115514755249
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2887367 Best vali loss: 0.2887367

best validation loss 0.2887366659005542

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0036150977396, 'e_layers': 2, 'learning_rate': 0.0001923352663, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7693524
	speed: 0.0091s/iter; left time: 18.1179s
	iters: 200, epoch: 1 | loss: 0.8301437
	speed: 0.0035s/iter; left time: 6.6983s
Updating learning rate to 0.00018501494110733892
Validation loss decreased (inf --> 0.2766).  Saving model state dict ...
Epoch: 1 cost time: 1.2009375095367432
Epoch: 1, Steps: 262 | Train Loss: 0.7997481 Vali Loss: 0.2765685 Best vali loss: 0.2765685
	iters: 100, epoch: 2 | loss: 0.3696069
	speed: 0.0081s/iter; left time: 13.9993s
	iters: 200, epoch: 2 | loss: 0.3408226
	speed: 0.0035s/iter; left time: 5.7800s
Updating learning rate to 0.00016416841868102522
Epoch: 2 cost time: 0.9709374904632568
Epoch: 2, Steps: 262 | Train Loss: 0.3552147 Vali Loss: 0.2833644 Best vali loss: 0.2765685
	iters: 100, epoch: 3 | loss: 0.3297114
	speed: 0.0079s/iter; left time: 11.7073s
	iters: 200, epoch: 3 | loss: 0.6879783
	speed: 0.0035s/iter; left time: 4.8522s
Updating learning rate to 0.0001329693930862688
Epoch: 3 cost time: 0.9687449932098389
Epoch: 3, Steps: 262 | Train Loss: 0.5088449 Vali Loss: 0.2912891 Best vali loss: 0.2765685

best validation loss 0.2765685013121679

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0036150977396, 'e_layers': 2, 'learning_rate': 0.0001923352663, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6377917
	speed: 0.0092s/iter; left time: 11.1321s
	iters: 200, epoch: 4 | loss: 0.7233778
	speed: 0.0035s/iter; left time: 3.9202s
Updating learning rate to 9.616763315e-05
Epoch: 4 cost time: 1.2163846492767334
Epoch: 4, Steps: 262 | Train Loss: 0.6805847 Vali Loss: 0.2864307 Best vali loss: 0.2765685
	iters: 100, epoch: 5 | loss: 0.3457850
	speed: 0.0081s/iter; left time: 7.6808s
	iters: 200, epoch: 5 | loss: 0.2377733
	speed: 0.0037s/iter; left time: 3.1160s
Updating learning rate to 5.9365873213731213e-05
Epoch: 5 cost time: 1.0029542446136475
Epoch: 5, Steps: 262 | Train Loss: 0.2917791 Vali Loss: 0.2830665 Best vali loss: 0.2765685
	iters: 100, epoch: 6 | loss: 0.2888532
	speed: 0.0077s/iter; left time: 5.2735s
	iters: 200, epoch: 6 | loss: 0.5331025
	speed: 0.0034s/iter; left time: 2.0053s
Updating learning rate to 2.8166847618974782e-05
Epoch: 6 cost time: 0.9035484790802002
Epoch: 6, Steps: 262 | Train Loss: 0.4109778 Vali Loss: 0.2843545 Best vali loss: 0.2765685
	iters: 100, epoch: 7 | loss: 0.3654539
	speed: 0.0078s/iter; left time: 3.3209s
	iters: 200, epoch: 7 | loss: 0.2779803
	speed: 0.0037s/iter; left time: 1.1908s
Updating learning rate to 7.320325192661079e-06
Epoch: 7 cost time: 0.9836828708648682
Epoch: 7, Steps: 262 | Train Loss: 0.3217171 Vali Loss: 0.2825118 Best vali loss: 0.2765685
	iters: 100, epoch: 8 | loss: 0.4123609
	speed: 0.0078s/iter; left time: 1.2659s
	iters: 200, epoch: 8 | loss: 0.3141964
	speed: 0.0032s/iter; left time: 0.1988s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8773102760314941
Epoch: 8, Steps: 262 | Train Loss: 0.3632786 Vali Loss: 0.2829239 Best vali loss: 0.2765685

best validation loss 0.2765685013121679

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0021144936496, 'e_layers': 3, 'learning_rate': 0.0010102183634, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6267486
	speed: 0.0103s/iter; left time: 9.7389s
Updating learning rate to 0.0009717692163561546
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 0.9127118587493896
Epoch: 1, Steps: 131 | Train Loss: 0.6267486 Vali Loss: 0.2842866 Best vali loss: 0.2842866
	iters: 100, epoch: 2 | loss: 0.5707626
	speed: 0.0077s/iter; left time: 6.2803s
Updating learning rate to 0.0008622753093196579
Epoch: 2 cost time: 0.5966315269470215
Epoch: 2, Steps: 131 | Train Loss: 0.5707626 Vali Loss: 0.2936434 Best vali loss: 0.2842866
	iters: 100, epoch: 3 | loss: 0.5180290
	speed: 0.0075s/iter; left time: 5.1716s
Updating learning rate to 0.0006984060970720779
Validation loss decreased (0.2843 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 0.6272797584533691
Epoch: 3, Steps: 131 | Train Loss: 0.5180290 Vali Loss: 0.2819201 Best vali loss: 0.2819201
	iters: 100, epoch: 4 | loss: 0.3043121
	speed: 0.0080s/iter; left time: 4.4318s
Updating learning rate to 0.0005051091817
Epoch: 4 cost time: 0.633603572845459
Epoch: 4, Steps: 131 | Train Loss: 0.3043121 Vali Loss: 0.2908123 Best vali loss: 0.2819201
	iters: 100, epoch: 5 | loss: 0.3237284
	speed: 0.0074s/iter; left time: 3.1522s
Updating learning rate to 0.00031181226632792224
Epoch: 5 cost time: 0.6004233360290527
Epoch: 5, Steps: 131 | Train Loss: 0.3237284 Vali Loss: 0.2834196 Best vali loss: 0.2819201
	iters: 100, epoch: 6 | loss: 0.2441316
	speed: 0.0082s/iter; left time: 2.4071s
Updating learning rate to 0.00014794305408034205
Epoch: 6 cost time: 0.690462589263916
Epoch: 6, Steps: 131 | Train Loss: 0.2441316 Vali Loss: 0.2980387 Best vali loss: 0.2819201
	iters: 100, epoch: 7 | loss: 0.4512136
	speed: 0.0083s/iter; left time: 1.3563s
Updating learning rate to 3.8449147043845406e-05
Epoch: 7 cost time: 0.6953930854797363
Epoch: 7, Steps: 131 | Train Loss: 0.4512136 Vali Loss: 0.2999016 Best vali loss: 0.2819201
	iters: 100, epoch: 8 | loss: 0.2999445
	speed: 0.0083s/iter; left time: 0.2669s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6860620975494385
Epoch: 8, Steps: 131 | Train Loss: 0.2999445 Vali Loss: 0.3027469 Best vali loss: 0.2819201

best validation loss 0.2819200769654212

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042580902685, 'e_layers': 1, 'learning_rate': 0.0005169991825, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4206234
	speed: 0.0083s/iter; left time: 7.8847s
Updating learning rate to 0.0004973220727684087
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 0.6517608165740967
Epoch: 1, Steps: 131 | Train Loss: 0.4206234 Vali Loss: 0.2883263 Best vali loss: 0.2883263
	iters: 100, epoch: 2 | loss: 0.5189754
	speed: 0.0055s/iter; left time: 4.4907s
Updating learning rate to 0.0004412864051568257
Validation loss decreased (0.2883 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.4125485420227051
Epoch: 2, Steps: 131 | Train Loss: 0.5189754 Vali Loss: 0.2826347 Best vali loss: 0.2826347
	iters: 100, epoch: 3 | loss: 0.3784550
	speed: 0.0055s/iter; left time: 3.8097s
Updating learning rate to 0.0003574231020945227
Epoch: 3 cost time: 0.41780948638916016
Epoch: 3, Steps: 131 | Train Loss: 0.3784550 Vali Loss: 0.2988701 Best vali loss: 0.2826347
	iters: 100, epoch: 4 | loss: 0.4446972
	speed: 0.0051s/iter; left time: 2.8457s
Updating learning rate to 0.00025849959125
Epoch: 4 cost time: 0.3822176456451416
Epoch: 4, Steps: 131 | Train Loss: 0.4446972 Vali Loss: 0.2996490 Best vali loss: 0.2826347
	iters: 100, epoch: 5 | loss: 0.3206867
	speed: 0.0053s/iter; left time: 2.2601s
Updating learning rate to 0.00015957608040547728
Epoch: 5 cost time: 0.40312743186950684
Epoch: 5, Steps: 131 | Train Loss: 0.3206867 Vali Loss: 0.3000973 Best vali loss: 0.2826347
	iters: 100, epoch: 6 | loss: 0.2539316
	speed: 0.0054s/iter; left time: 1.5859s
Updating learning rate to 7.57127773431743e-05
Epoch: 6 cost time: 0.4094350337982178
Epoch: 6, Steps: 131 | Train Loss: 0.2539316 Vali Loss: 0.3097206 Best vali loss: 0.2826347
	iters: 100, epoch: 7 | loss: 0.4663942
	speed: 0.0052s/iter; left time: 0.8505s
Updating learning rate to 1.967710973159129e-05
Epoch: 7 cost time: 0.39180827140808105
Epoch: 7, Steps: 131 | Train Loss: 0.4663942 Vali Loss: 0.3087913 Best vali loss: 0.2826347
	iters: 100, epoch: 8 | loss: 0.4501156
	speed: 0.0055s/iter; left time: 0.1747s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4244251251220703
Epoch: 8, Steps: 131 | Train Loss: 0.4501156 Vali Loss: 0.3103486 Best vali loss: 0.2826347

best validation loss 0.2826347394519776

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0052502861924, 'e_layers': 2, 'learning_rate': 0.0008672822134, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5737607
	speed: 0.0086s/iter; left time: 71.1114s
	iters: 200, epoch: 1 | loss: 0.2789902
	speed: 0.0034s/iter; left time: 27.6352s
	iters: 300, epoch: 1 | loss: 0.5751685
	speed: 0.0034s/iter; left time: 27.4089s
	iters: 400, epoch: 1 | loss: 1.5401652
	speed: 0.0031s/iter; left time: 24.9035s
	iters: 500, epoch: 1 | loss: 0.3584434
	speed: 0.0031s/iter; left time: 24.3460s
	iters: 600, epoch: 1 | loss: 1.2427821
	speed: 0.0031s/iter; left time: 24.0396s
	iters: 700, epoch: 1 | loss: 0.5342520
	speed: 0.0032s/iter; left time: 24.8417s
	iters: 800, epoch: 1 | loss: 0.4097308
	speed: 0.0034s/iter; left time: 25.4361s
	iters: 900, epoch: 1 | loss: 0.7105184
	speed: 0.0033s/iter; left time: 24.8843s
	iters: 1000, epoch: 1 | loss: 0.5771869
	speed: 0.0034s/iter; left time: 24.9555s
Updating learning rate to 0.000834273249635673
Validation loss decreased (inf --> 0.2958).  Saving model state dict ...
Epoch: 1 cost time: 3.6918785572052
Epoch: 1, Steps: 1045 | Train Loss: 0.6800998 Vali Loss: 0.2958067 Best vali loss: 0.2958067
	iters: 100, epoch: 2 | loss: 0.9327940
	speed: 0.0104s/iter; left time: 74.8795s
	iters: 200, epoch: 2 | loss: 0.7379683
	speed: 0.0035s/iter; left time: 24.5779s
	iters: 300, epoch: 2 | loss: 0.9029343
	speed: 0.0034s/iter; left time: 24.1922s
	iters: 400, epoch: 2 | loss: 1.2253320
	speed: 0.0034s/iter; left time: 23.7196s
	iters: 500, epoch: 2 | loss: 0.3313697
	speed: 0.0034s/iter; left time: 22.9890s
	iters: 600, epoch: 2 | loss: 0.1396968
	speed: 0.0034s/iter; left time: 22.5226s
	iters: 700, epoch: 2 | loss: 0.3865943
	speed: 0.0033s/iter; left time: 21.9717s
	iters: 800, epoch: 2 | loss: 0.4164023
	speed: 0.0031s/iter; left time: 20.1582s
	iters: 900, epoch: 2 | loss: 0.3030501
	speed: 0.0031s/iter; left time: 19.8819s
	iters: 1000, epoch: 2 | loss: 0.8531000
	speed: 0.0031s/iter; left time: 19.7093s
Updating learning rate to 0.0007402716738488091
Validation loss decreased (0.2958 --> 0.2887).  Saving model state dict ...
Epoch: 2 cost time: 3.4994893074035645
Epoch: 2, Steps: 1045 | Train Loss: 0.6229242 Vali Loss: 0.2886574 Best vali loss: 0.2886574
	iters: 100, epoch: 3 | loss: 0.4446784
	speed: 0.0099s/iter; left time: 60.8425s
	iters: 200, epoch: 3 | loss: 0.2653266
	speed: 0.0030s/iter; left time: 18.5137s
	iters: 300, epoch: 3 | loss: 0.2309824
	speed: 0.0029s/iter; left time: 17.5428s
	iters: 400, epoch: 3 | loss: 0.9321285
	speed: 0.0031s/iter; left time: 18.2181s
	iters: 500, epoch: 3 | loss: 0.6795592
	speed: 0.0033s/iter; left time: 19.2046s
	iters: 600, epoch: 3 | loss: 0.2715990
	speed: 0.0031s/iter; left time: 17.7041s
	iters: 700, epoch: 3 | loss: 0.5474002
	speed: 0.0032s/iter; left time: 17.7166s
	iters: 800, epoch: 3 | loss: 1.4010466
	speed: 0.0033s/iter; left time: 18.2541s
	iters: 900, epoch: 3 | loss: 0.3067749
	speed: 0.0030s/iter; left time: 16.0613s
	iters: 1000, epoch: 3 | loss: 0.5371578
	speed: 0.0032s/iter; left time: 16.8382s
Updating learning rate to 0.0005995883738265521
Epoch: 3 cost time: 3.307868003845215
Epoch: 3, Steps: 1045 | Train Loss: 0.5616654 Vali Loss: 0.2953810 Best vali loss: 0.2886574

best validation loss 0.2886574055103176

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.00259325325, 'e_layers': 1, 'learning_rate': 5.07695426e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.07695426e-05
Validation loss decreased (inf --> 0.3480).  Saving model state dict ...
Epoch: 1 cost time: 0.503373384475708
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3480372 Best vali loss: 0.3480372
Updating learning rate to 2.53847713e-05
Validation loss decreased (0.3480 --> 0.3353).  Saving model state dict ...
Epoch: 2 cost time: 0.2748398780822754
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3353403 Best vali loss: 0.3353403
Updating learning rate to 1.269238565e-05
Validation loss decreased (0.3353 --> 0.3301).  Saving model state dict ...
Epoch: 3 cost time: 0.27211880683898926
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3301221 Best vali loss: 0.3301221

best validation loss 0.33012214365081743

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020700457701, 'e_layers': 3, 'learning_rate': 0.0005065428814, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00048726374093237604
Validation loss decreased (inf --> 0.2905).  Saving model state dict ...
Epoch: 1 cost time: 1.0057957172393799
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2904785 Best vali loss: 0.2904785
Updating learning rate to 0.0004323613938998565
Validation loss decreased (0.2905 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 0.774632453918457
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2829552 Best vali loss: 0.2829552
Updating learning rate to 0.0003501942249471273
Epoch: 3 cost time: 0.7673945426940918
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2840813 Best vali loss: 0.2829552

best validation loss 0.2829551505594725

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020700457701, 'e_layers': 3, 'learning_rate': 0.0005065428814, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002532714407
Epoch: 4 cost time: 0.9947569370269775
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2947849 Best vali loss: 0.2829552
Updating learning rate to 0.00015634865645287272
Epoch: 5 cost time: 0.7670936584472656
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2898746 Best vali loss: 0.2829552
Updating learning rate to 7.418148750014347e-05
Epoch: 6 cost time: 0.7755248546600342
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3035465 Best vali loss: 0.2829552
Updating learning rate to 1.9279140467623918e-05
Epoch: 7 cost time: 0.7763218879699707
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3038840 Best vali loss: 0.2829552
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7722113132476807
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3070807 Best vali loss: 0.2829552

best validation loss 0.2829551505594725

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020947186755, 'e_layers': 3, 'learning_rate': 0.000506451422, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004871757624985182
Validation loss decreased (inf --> 0.2905).  Saving model state dict ...
Epoch: 1 cost time: 0.9962074756622314
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2905181 Best vali loss: 0.2905181
Updating learning rate to 0.00043228332841888496
Validation loss decreased (0.2905 --> 0.2721).  Saving model state dict ...
Epoch: 2 cost time: 0.7724826335906982
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2721024 Best vali loss: 0.2721024
Updating learning rate to 0.00035013099524857033
Epoch: 3 cost time: 0.7792253494262695
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2851610 Best vali loss: 0.2721024
Updating learning rate to 0.000253225711
Epoch: 4 cost time: 0.7759087085723877
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2801702 Best vali loss: 0.2721024
Updating learning rate to 0.00015632042675142976
Epoch: 5 cost time: 0.7716000080108643
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2840719 Best vali loss: 0.2721024
Updating learning rate to 7.41680935811151e-05
Epoch: 6 cost time: 0.7702481746673584
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2859510 Best vali loss: 0.2721024
Updating learning rate to 1.92756595014818e-05
Epoch: 7 cost time: 0.7825262546539307
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2898344 Best vali loss: 0.2721024
Updating learning rate to 0.0
Epoch: 8 cost time: 0.776146411895752
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2897949 Best vali loss: 0.2721024

best validation loss 0.2721024352396319

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010014785859, 'e_layers': 4, 'learning_rate': 0.0005057312277, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004864829789619175
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.2181117534637451
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857170 Best vali loss: 0.2857170
Updating learning rate to 0.0004316686041322339
Epoch: 2 cost time: 1.0164275169372559
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2898807 Best vali loss: 0.2857170
Updating learning rate to 0.0003496330948852234
Epoch: 3 cost time: 1.0122404098510742
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2911591 Best vali loss: 0.2857170
Updating learning rate to 0.00025286561385
Validation loss decreased (0.2857 --> 0.2775).  Saving model state dict ...
Epoch: 4 cost time: 1.0116477012634277
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2775168 Best vali loss: 0.2775168
Updating learning rate to 0.00015609813281477661
Validation loss decreased (0.2775 --> 0.2772).  Saving model state dict ...
Epoch: 5 cost time: 1.0123846530914307
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2771662 Best vali loss: 0.2771662
Updating learning rate to 7.406262356776604e-05
Epoch: 6 cost time: 1.0155844688415527
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2847934 Best vali loss: 0.2771662
Updating learning rate to 1.9248248738082444e-05
Epoch: 7 cost time: 1.0197548866271973
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2975501 Best vali loss: 0.2771662
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0136990547180176
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2960575 Best vali loss: 0.2771662

best validation loss 0.27716622848788264

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008595119631, 'e_layers': 3, 'learning_rate': 0.0005055799549, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00048633746364004475
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 0.950592041015625
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2795565 Best vali loss: 0.2795565
Updating learning rate to 0.00043153948472088945
Validation loss decreased (0.2796 --> 0.2763).  Saving model state dict ...
Epoch: 2 cost time: 0.7345428466796875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2762717 Best vali loss: 0.2762717
Updating learning rate to 0.0003495285136880597
Epoch: 3 cost time: 0.7369258403778076
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2939456 Best vali loss: 0.2762717

best validation loss 0.2762717094318093

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269910981, 'e_layers': 2, 'learning_rate': 0.0002358395622, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5598798
	speed: 0.0103s/iter; left time: 9.8073s
Updating learning rate to 0.0002358395622
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9335081577301025
Epoch: 1, Steps: 131 | Train Loss: 0.5598798 Vali Loss: 0.2756303 Best vali loss: 0.2756303
	iters: 100, epoch: 2 | loss: 0.3241628
	speed: 0.0089s/iter; left time: 7.2776s
Updating learning rate to 0.0001179197811
Validation loss decreased (0.2756 --> 0.2696).  Saving model state dict ...
Epoch: 2 cost time: 0.7009053230285645
Epoch: 2, Steps: 131 | Train Loss: 0.3241628 Vali Loss: 0.2696044 Best vali loss: 0.2696044
	iters: 100, epoch: 3 | loss: 0.4612712
	speed: 0.0090s/iter; left time: 6.1909s
Updating learning rate to 5.895989055e-05
Epoch: 3 cost time: 0.7073068618774414
Epoch: 3, Steps: 131 | Train Loss: 0.4612712 Vali Loss: 0.2738574 Best vali loss: 0.2696044

best validation loss 0.26960443005148654

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009444185214, 'e_layers': 1, 'learning_rate': 0.0005051456988, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3686208
	speed: 0.0079s/iter; left time: 15.8305s
	iters: 200, epoch: 1 | loss: 0.3251564
	speed: 0.0026s/iter; left time: 4.9996s
Updating learning rate to 0.0004859197354287156
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 0.9578735828399658
Epoch: 1, Steps: 262 | Train Loss: 0.3468886 Vali Loss: 0.2862238 Best vali loss: 0.2862238
	iters: 100, epoch: 2 | loss: 0.5067596
	speed: 0.0065s/iter; left time: 11.3228s
	iters: 200, epoch: 2 | loss: 0.3033440
	speed: 0.0025s/iter; left time: 4.1554s
Updating learning rate to 0.0004311688239543486
Epoch: 2 cost time: 0.716876745223999
Epoch: 2, Steps: 262 | Train Loss: 0.4050518 Vali Loss: 0.2876956 Best vali loss: 0.2862238
	iters: 100, epoch: 3 | loss: 0.8702297
	speed: 0.0062s/iter; left time: 9.1486s
	iters: 200, epoch: 3 | loss: 0.6877712
	speed: 0.0026s/iter; left time: 3.5274s
Updating learning rate to 0.0003492282943306229
Epoch: 3 cost time: 0.7121384143829346
Epoch: 3, Steps: 262 | Train Loss: 0.7790004 Vali Loss: 0.2872502 Best vali loss: 0.2862238

best validation loss 0.2862237870316383

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269910981, 'e_layers': 2, 'learning_rate': 0.0002358395622, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4253551
	speed: 0.0107s/iter; left time: 5.9687s
Updating learning rate to 2.9479945275e-05
Epoch: 4 cost time: 0.9243426322937012
Epoch: 4, Steps: 131 | Train Loss: 0.4253551 Vali Loss: 0.2945862 Best vali loss: 0.2696044
	iters: 100, epoch: 5 | loss: 0.2813212
	speed: 0.0086s/iter; left time: 3.6505s
Updating learning rate to 1.47399726375e-05
Epoch: 5 cost time: 0.6963965892791748
Epoch: 5, Steps: 131 | Train Loss: 0.2813212 Vali Loss: 0.2937073 Best vali loss: 0.2696044
	iters: 100, epoch: 6 | loss: 0.4351766
	speed: 0.0086s/iter; left time: 2.5311s
Updating learning rate to 7.36998631875e-06
Epoch: 6 cost time: 0.7012820243835449
Epoch: 6, Steps: 131 | Train Loss: 0.4351766 Vali Loss: 0.2977480 Best vali loss: 0.2696044
	iters: 100, epoch: 7 | loss: 0.4657750
	speed: 0.0086s/iter; left time: 1.4098s
Updating learning rate to 3.684993159375e-06
Epoch: 7 cost time: 0.6943917274475098
Epoch: 7, Steps: 131 | Train Loss: 0.4657750 Vali Loss: 0.2950901 Best vali loss: 0.2696044
	iters: 100, epoch: 8 | loss: 0.3293762
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 1.8424965796875e-06
Epoch: 8 cost time: 0.6988668441772461
Epoch: 8, Steps: 131 | Train Loss: 0.3293762 Vali Loss: 0.2938007 Best vali loss: 0.2696044

best validation loss 0.26960443005148654

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021071651394, 'e_layers': 3, 'learning_rate': 0.0004743275703, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5173827
	speed: 0.0122s/iter; left time: 11.5717s
Updating learning rate to 0.00045627455210298925
Validation loss decreased (inf --> 0.2913).  Saving model state dict ...
Epoch: 1 cost time: 1.1458451747894287
Epoch: 1, Steps: 131 | Train Loss: 0.5173827 Vali Loss: 0.2913357 Best vali loss: 0.2913357
	iters: 100, epoch: 2 | loss: 0.5680146
	speed: 0.0114s/iter; left time: 9.3211s
Updating learning rate to 0.0004048639058814344
Validation loss decreased (0.2913 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 0.9160101413726807
Epoch: 2, Steps: 131 | Train Loss: 0.5680146 Vali Loss: 0.2796514 Best vali loss: 0.2796514
	iters: 100, epoch: 3 | loss: 0.4988432
	speed: 0.0114s/iter; left time: 7.8334s
Updating learning rate to 0.00032792243648389874
Epoch: 3 cost time: 0.9114351272583008
Epoch: 3, Steps: 131 | Train Loss: 0.4988432 Vali Loss: 0.2897616 Best vali loss: 0.2796514
	iters: 100, epoch: 4 | loss: 0.3071684
	speed: 0.0110s/iter; left time: 6.1183s
Updating learning rate to 0.00023716378515
Epoch: 4 cost time: 0.9170184135437012
Epoch: 4, Steps: 131 | Train Loss: 0.3071684 Vali Loss: 0.2860651 Best vali loss: 0.2796514
	iters: 100, epoch: 5 | loss: 0.3048328
	speed: 0.0111s/iter; left time: 4.7167s
Updating learning rate to 0.0001464051338161013
Epoch: 5 cost time: 0.9127824306488037
Epoch: 5, Steps: 131 | Train Loss: 0.3048328 Vali Loss: 0.3037523 Best vali loss: 0.2796514
	iters: 100, epoch: 6 | loss: 0.3045169
	speed: 0.0110s/iter; left time: 3.2376s
Updating learning rate to 6.94636644185656e-05
Epoch: 6 cost time: 0.91752028465271
Epoch: 6, Steps: 131 | Train Loss: 0.3045169 Vali Loss: 0.3114030 Best vali loss: 0.2796514
	iters: 100, epoch: 7 | loss: 0.3415485
	speed: 0.0110s/iter; left time: 1.7989s
Updating learning rate to 1.8053018197010754e-05
Epoch: 7 cost time: 0.9166989326477051
Epoch: 7, Steps: 131 | Train Loss: 0.3415485 Vali Loss: 0.3162956 Best vali loss: 0.2796514
	iters: 100, epoch: 8 | loss: 0.2971939
	speed: 0.0110s/iter; left time: 0.3509s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9076876640319824
Epoch: 8, Steps: 131 | Train Loss: 0.2971939 Vali Loss: 0.3191382 Best vali loss: 0.2796514

best validation loss 0.27965136268583096

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021038624535, 'e_layers': 3, 'learning_rate': 0.0004750360134, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5195686
	speed: 0.0120s/iter; left time: 11.4156s
Updating learning rate to 0.0004569560316930087
Validation loss decreased (inf --> 0.2691).  Saving model state dict ...
Epoch: 1 cost time: 1.1273531913757324
Epoch: 1, Steps: 131 | Train Loss: 0.5195686 Vali Loss: 0.2690689 Best vali loss: 0.2690689
	iters: 100, epoch: 2 | loss: 0.5737228
	speed: 0.0113s/iter; left time: 9.2344s
Updating learning rate to 0.0004054685998914818
Epoch: 2 cost time: 0.9183745384216309
Epoch: 2, Steps: 131 | Train Loss: 0.5737228 Vali Loss: 0.2885330 Best vali loss: 0.2690689
	iters: 100, epoch: 3 | loss: 0.5205364
	speed: 0.0111s/iter; left time: 7.6029s
Updating learning rate to 0.0003284122127524704
Epoch: 3 cost time: 0.908287525177002
Epoch: 3, Steps: 131 | Train Loss: 0.5205364 Vali Loss: 0.2867842 Best vali loss: 0.2690689
	iters: 100, epoch: 4 | loss: 0.3240791
	speed: 0.0110s/iter; left time: 6.1301s
Updating learning rate to 0.0002375180067
Epoch: 4 cost time: 0.914705753326416
Epoch: 4, Steps: 131 | Train Loss: 0.3240791 Vali Loss: 0.2783557 Best vali loss: 0.2690689
	iters: 100, epoch: 5 | loss: 0.3135900
	speed: 0.0111s/iter; left time: 4.7263s
Updating learning rate to 0.0001466238006475296
Epoch: 5 cost time: 0.9180660247802734
Epoch: 5, Steps: 131 | Train Loss: 0.3135900 Vali Loss: 0.2817967 Best vali loss: 0.2690689
	iters: 100, epoch: 6 | loss: 0.3143383
	speed: 0.0111s/iter; left time: 3.2633s
Updating learning rate to 6.956741350851819e-05
Epoch: 6 cost time: 0.9282124042510986
Epoch: 6, Steps: 131 | Train Loss: 0.3143383 Vali Loss: 0.2932929 Best vali loss: 0.2690689
	iters: 100, epoch: 7 | loss: 0.3514459
	speed: 0.0112s/iter; left time: 1.8282s
Updating learning rate to 1.8079981706991328e-05
Epoch: 7 cost time: 0.9198055267333984
Epoch: 7, Steps: 131 | Train Loss: 0.3514459 Vali Loss: 0.2970249 Best vali loss: 0.2690689
	iters: 100, epoch: 8 | loss: 0.3123966
	speed: 0.0111s/iter; left time: 0.3543s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9209113121032715
Epoch: 8, Steps: 131 | Train Loss: 0.3123966 Vali Loss: 0.2987095 Best vali loss: 0.2690689

best validation loss 0.2690688768764019

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.002110919673, 'e_layers': 3, 'learning_rate': 0.0004745264551, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4369184
	speed: 0.0120s/iter; left time: 11.4139s
Updating learning rate to 0.0004745264551
Validation loss decreased (inf --> 0.2772).  Saving model state dict ...
Epoch: 1 cost time: 1.1414930820465088
Epoch: 1, Steps: 131 | Train Loss: 0.4369184 Vali Loss: 0.2771550 Best vali loss: 0.2771550
	iters: 100, epoch: 2 | loss: 0.4479947
	speed: 0.0115s/iter; left time: 9.4300s
Updating learning rate to 0.00023726322755
Epoch: 2 cost time: 0.9313101768493652
Epoch: 2, Steps: 131 | Train Loss: 0.4479947 Vali Loss: 0.2817940 Best vali loss: 0.2771550
	iters: 100, epoch: 3 | loss: 0.4241879
	speed: 0.0111s/iter; left time: 7.6477s
Updating learning rate to 0.000118631613775
Epoch: 3 cost time: 0.9172165393829346
Epoch: 3, Steps: 131 | Train Loss: 0.4241879 Vali Loss: 0.2791329 Best vali loss: 0.2771550

best validation loss 0.2771550203597692

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021059444361, 'e_layers': 1, 'learning_rate': 0.0004769968385, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4191458
	speed: 0.0081s/iter; left time: 7.6940s
Updating learning rate to 0.00045884222733137085
Validation loss decreased (inf --> 0.2783).  Saving model state dict ...
Epoch: 1 cost time: 0.6314032077789307
Epoch: 1, Steps: 131 | Train Loss: 0.4191458 Vali Loss: 0.2782548 Best vali loss: 0.2782548
	iters: 100, epoch: 2 | loss: 0.5316501
	speed: 0.0058s/iter; left time: 4.7036s
Updating learning rate to 0.0004071422688039472
Epoch: 2 cost time: 0.423429012298584
Epoch: 2, Steps: 131 | Train Loss: 0.5316501 Vali Loss: 0.2846169 Best vali loss: 0.2782548
	iters: 100, epoch: 3 | loss: 0.4216835
	speed: 0.0055s/iter; left time: 3.7559s
Updating learning rate to 0.00032976781294223823
Epoch: 3 cost time: 0.4159996509552002
Epoch: 3, Steps: 131 | Train Loss: 0.4216835 Vali Loss: 0.2860853 Best vali loss: 0.2782548

best validation loss 0.27825482566479015

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0044341329982, 'e_layers': 2, 'learning_rate': 0.0013967577779, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6383487
	speed: 0.0095s/iter; left time: 9.0134s
Updating learning rate to 0.0013435968503888779
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 0.7888202667236328
Epoch: 1, Steps: 131 | Train Loss: 0.6383487 Vali Loss: 0.2859682 Best vali loss: 0.2859682
	iters: 100, epoch: 2 | loss: 0.4547421
	speed: 0.0066s/iter; left time: 5.3970s
Updating learning rate to 0.0011922073371640719
Epoch: 2 cost time: 0.5102026462554932
Epoch: 2, Steps: 131 | Train Loss: 0.4547421 Vali Loss: 0.3055613 Best vali loss: 0.2859682
	iters: 100, epoch: 3 | loss: 0.5036958
	speed: 0.0069s/iter; left time: 4.7379s
Updating learning rate to 0.0009656369192647039
Epoch: 3 cost time: 0.5728845596313477
Epoch: 3, Steps: 131 | Train Loss: 0.5036958 Vali Loss: 0.2953044 Best vali loss: 0.2859682

best validation loss 0.28596815068999293

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.002110919673, 'e_layers': 3, 'learning_rate': 0.0004745264551, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3410121
	speed: 0.0125s/iter; left time: 6.9687s
Updating learning rate to 5.93158068875e-05
Epoch: 4 cost time: 1.154858112335205
Epoch: 4, Steps: 131 | Train Loss: 0.3410121 Vali Loss: 0.2858958 Best vali loss: 0.2771550
	iters: 100, epoch: 5 | loss: 0.3061500
	speed: 0.0111s/iter; left time: 4.7349s
Updating learning rate to 2.965790344375e-05
Epoch: 5 cost time: 0.9123637676239014
Epoch: 5, Steps: 131 | Train Loss: 0.3061500 Vali Loss: 0.2886556 Best vali loss: 0.2771550
	iters: 100, epoch: 6 | loss: 0.3364684
	speed: 0.0110s/iter; left time: 3.2401s
Updating learning rate to 1.4828951721875e-05
Epoch: 6 cost time: 0.9146804809570312
Epoch: 6, Steps: 131 | Train Loss: 0.3364684 Vali Loss: 0.2902159 Best vali loss: 0.2771550
	iters: 100, epoch: 7 | loss: 0.4856536
	speed: 0.0110s/iter; left time: 1.7965s
Updating learning rate to 7.4144758609375e-06
Epoch: 7 cost time: 0.9181146621704102
Epoch: 7, Steps: 131 | Train Loss: 0.4856536 Vali Loss: 0.2916385 Best vali loss: 0.2771550
	iters: 100, epoch: 8 | loss: 0.3479361
	speed: 0.0112s/iter; left time: 0.3585s
Updating learning rate to 3.70723793046875e-06
Epoch: 8 cost time: 0.9281342029571533
Epoch: 8, Steps: 131 | Train Loss: 0.3479361 Vali Loss: 0.2911878 Best vali loss: 0.2771550

best validation loss 0.2771550203597692

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0034165488875, 'e_layers': 1, 'learning_rate': 0.0036443452071, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3680522
	speed: 0.0076s/iter; left time: 62.6087s
	iters: 200, epoch: 1 | loss: 0.5599000
	speed: 0.0024s/iter; left time: 19.2145s
	iters: 300, epoch: 1 | loss: 0.3605894
	speed: 0.0024s/iter; left time: 18.9870s
	iters: 400, epoch: 1 | loss: 0.2704833
	speed: 0.0024s/iter; left time: 18.7959s
	iters: 500, epoch: 1 | loss: 0.8887613
	speed: 0.0023s/iter; left time: 18.4082s
	iters: 600, epoch: 1 | loss: 0.6509559
	speed: 0.0023s/iter; left time: 18.1566s
	iters: 700, epoch: 1 | loss: 0.2171329
	speed: 0.0023s/iter; left time: 17.9257s
	iters: 800, epoch: 1 | loss: 0.6573917
	speed: 0.0023s/iter; left time: 17.6387s
	iters: 900, epoch: 1 | loss: 0.4720380
	speed: 0.0023s/iter; left time: 17.3284s
	iters: 1000, epoch: 1 | loss: 0.3162511
	speed: 0.0024s/iter; left time: 17.5113s
Updating learning rate to 0.0035056405766726484
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 2.704525947570801
Epoch: 1, Steps: 1045 | Train Loss: 0.4761556 Vali Loss: 0.2845754 Best vali loss: 0.2845754
	iters: 100, epoch: 2 | loss: 0.5311091
	speed: 0.0078s/iter; left time: 56.2531s
	iters: 200, epoch: 2 | loss: 2.0182927
	speed: 0.0023s/iter; left time: 16.4351s
	iters: 300, epoch: 2 | loss: 1.0899553
	speed: 0.0023s/iter; left time: 16.1340s
	iters: 400, epoch: 2 | loss: 0.2596465
	speed: 0.0023s/iter; left time: 15.8426s
	iters: 500, epoch: 2 | loss: 0.1612726
	speed: 0.0023s/iter; left time: 15.7342s
	iters: 600, epoch: 2 | loss: 0.4032753
	speed: 0.0023s/iter; left time: 15.2827s
	iters: 700, epoch: 2 | loss: 0.3564008
	speed: 0.0023s/iter; left time: 15.0216s
	iters: 800, epoch: 2 | loss: 0.7578625
	speed: 0.0023s/iter; left time: 14.8781s
	iters: 900, epoch: 2 | loss: 0.8405870
	speed: 0.0023s/iter; left time: 14.7833s
	iters: 1000, epoch: 2 | loss: 0.5029626
	speed: 0.0023s/iter; left time: 14.4641s
Updating learning rate to 0.0031106432080125514
Epoch: 2 cost time: 2.4314987659454346
Epoch: 2, Steps: 1045 | Train Loss: 0.6921364 Vali Loss: 0.2973677 Best vali loss: 0.2845754
	iters: 100, epoch: 3 | loss: 2.1431406
	speed: 0.0079s/iter; left time: 48.6493s
	iters: 200, epoch: 3 | loss: 0.2387759
	speed: 0.0021s/iter; left time: 12.8411s
	iters: 300, epoch: 3 | loss: 0.1789394
	speed: 0.0021s/iter; left time: 12.2532s
	iters: 400, epoch: 3 | loss: 0.2873864
	speed: 0.0021s/iter; left time: 12.0921s
	iters: 500, epoch: 3 | loss: 0.2324398
	speed: 0.0021s/iter; left time: 11.9112s
	iters: 600, epoch: 3 | loss: 0.4557979
	speed: 0.0021s/iter; left time: 11.7041s
	iters: 700, epoch: 3 | loss: 0.2372880
	speed: 0.0021s/iter; left time: 11.4881s
	iters: 800, epoch: 3 | loss: 0.4385145
	speed: 0.0021s/iter; left time: 11.2824s
	iters: 900, epoch: 3 | loss: 0.1225347
	speed: 0.0021s/iter; left time: 11.0540s
	iters: 1000, epoch: 3 | loss: 1.0963988
	speed: 0.0021s/iter; left time: 10.9614s
Updating learning rate to 0.0025194878698381463
Epoch: 3 cost time: 2.211376667022705
Epoch: 3, Steps: 1045 | Train Loss: 0.5431216 Vali Loss: 0.3143324 Best vali loss: 0.2845754
	iters: 100, epoch: 4 | loss: 1.0811771
	speed: 0.0078s/iter; left time: 39.7430s
	iters: 200, epoch: 4 | loss: 0.2400912
	speed: 0.0023s/iter; left time: 11.7893s
	iters: 300, epoch: 4 | loss: 0.3223721
	speed: 0.0024s/iter; left time: 11.5797s
	iters: 400, epoch: 4 | loss: 0.5044151
	speed: 0.0024s/iter; left time: 11.3817s
	iters: 500, epoch: 4 | loss: 0.3364128
	speed: 0.0023s/iter; left time: 11.0817s
	iters: 600, epoch: 4 | loss: 0.3947841
	speed: 0.0024s/iter; left time: 10.9037s
	iters: 700, epoch: 4 | loss: 0.3160605
	speed: 0.0024s/iter; left time: 10.6505s
	iters: 800, epoch: 4 | loss: 0.2444349
	speed: 0.0024s/iter; left time: 10.6068s
	iters: 900, epoch: 4 | loss: 0.2959988
	speed: 0.0024s/iter; left time: 10.1713s
	iters: 1000, epoch: 4 | loss: 0.3104040
	speed: 0.0024s/iter; left time: 10.1260s
Updating learning rate to 0.00182217260355
Epoch: 4 cost time: 2.5067808628082275
Epoch: 4, Steps: 1045 | Train Loss: 0.4046151 Vali Loss: 0.3369252 Best vali loss: 0.2845754
	iters: 100, epoch: 5 | loss: 0.2842395
	speed: 0.0078s/iter; left time: 31.8691s
	iters: 200, epoch: 5 | loss: 0.4900124
	speed: 0.0022s/iter; left time: 8.8448s
	iters: 300, epoch: 5 | loss: 0.7874790
	speed: 0.0023s/iter; left time: 8.9352s
	iters: 400, epoch: 5 | loss: 0.7549604
	speed: 0.0024s/iter; left time: 9.2361s
	iters: 500, epoch: 5 | loss: 0.3710873
	speed: 0.0024s/iter; left time: 8.6581s
	iters: 600, epoch: 5 | loss: 0.2490280
	speed: 0.0022s/iter; left time: 7.7204s
	iters: 700, epoch: 5 | loss: 0.2543654
	speed: 0.0021s/iter; left time: 7.2454s
	iters: 800, epoch: 5 | loss: 0.3892004
	speed: 0.0020s/iter; left time: 6.9102s
	iters: 900, epoch: 5 | loss: 0.5801963
	speed: 0.0020s/iter; left time: 6.7172s
	iters: 1000, epoch: 5 | loss: 0.4152150
	speed: 0.0021s/iter; left time: 6.5818s
Updating learning rate to 0.0011248573372618542
Epoch: 5 cost time: 2.31969952583313
Epoch: 5, Steps: 1045 | Train Loss: 0.4575784 Vali Loss: 0.3850431 Best vali loss: 0.2845754
	iters: 100, epoch: 6 | loss: 0.2789641
	speed: 0.0080s/iter; left time: 24.4298s
	iters: 200, epoch: 6 | loss: 0.3685053
	speed: 0.0024s/iter; left time: 6.9447s
	iters: 300, epoch: 6 | loss: 0.2151729
	speed: 0.0024s/iter; left time: 6.7340s
	iters: 400, epoch: 6 | loss: 0.4509560
	speed: 0.0024s/iter; left time: 6.5296s
	iters: 500, epoch: 6 | loss: 0.2084425
	speed: 0.0024s/iter; left time: 6.3282s
	iters: 600, epoch: 6 | loss: 0.1966503
	speed: 0.0024s/iter; left time: 6.0501s
	iters: 700, epoch: 6 | loss: 0.4536021
	speed: 0.0024s/iter; left time: 5.8433s
	iters: 800, epoch: 6 | loss: 0.2438161
	speed: 0.0024s/iter; left time: 5.5728s
	iters: 900, epoch: 6 | loss: 0.3554842
	speed: 0.0024s/iter; left time: 5.3703s
	iters: 1000, epoch: 6 | loss: 0.4729619
	speed: 0.0024s/iter; left time: 5.1394s
Updating learning rate to 0.0005337019990874487
Epoch: 6 cost time: 2.5376250743865967
Epoch: 6, Steps: 1045 | Train Loss: 0.3244555 Vali Loss: 0.3900499 Best vali loss: 0.2845754
	iters: 100, epoch: 7 | loss: 0.1675985
	speed: 0.0079s/iter; left time: 15.7286s
	iters: 200, epoch: 7 | loss: 0.4195666
	speed: 0.0024s/iter; left time: 4.5517s
	iters: 300, epoch: 7 | loss: 0.3571326
	speed: 0.0024s/iter; left time: 4.2341s
	iters: 400, epoch: 7 | loss: 0.7964025
	speed: 0.0024s/iter; left time: 4.0149s
	iters: 500, epoch: 7 | loss: 0.2690348
	speed: 0.0024s/iter; left time: 3.7511s
	iters: 600, epoch: 7 | loss: 0.2066343
	speed: 0.0025s/iter; left time: 3.6747s
	iters: 700, epoch: 7 | loss: 0.1670302
	speed: 0.0024s/iter; left time: 3.2968s
	iters: 800, epoch: 7 | loss: 0.1659949
	speed: 0.0024s/iter; left time: 3.0447s
	iters: 900, epoch: 7 | loss: 0.4273529
	speed: 0.0024s/iter; left time: 2.8281s
	iters: 1000, epoch: 7 | loss: 0.2123448
	speed: 0.0024s/iter; left time: 2.6196s
Updating learning rate to 0.00013870463042735178
Epoch: 7 cost time: 2.5290005207061768
Epoch: 7, Steps: 1045 | Train Loss: 0.3189092 Vali Loss: 0.4006438 Best vali loss: 0.2845754
	iters: 100, epoch: 8 | loss: 0.5685450
	speed: 0.0078s/iter; left time: 7.3452s
	iters: 200, epoch: 8 | loss: 0.1869350
	speed: 0.0023s/iter; left time: 1.9046s
	iters: 300, epoch: 8 | loss: 0.1615386
	speed: 0.0023s/iter; left time: 1.6842s
	iters: 400, epoch: 8 | loss: 0.3198435
	speed: 0.0022s/iter; left time: 1.4480s
	iters: 500, epoch: 8 | loss: 0.1551969
	speed: 0.0023s/iter; left time: 1.2321s
	iters: 600, epoch: 8 | loss: 0.2353959
	speed: 0.0023s/iter; left time: 1.0143s
	iters: 700, epoch: 8 | loss: 0.1581976
	speed: 0.0023s/iter; left time: 0.7830s
	iters: 800, epoch: 8 | loss: 0.1562647
	speed: 0.0023s/iter; left time: 0.5591s
	iters: 900, epoch: 8 | loss: 0.1725358
	speed: 0.0023s/iter; left time: 0.3324s
	iters: 1000, epoch: 8 | loss: 0.1323594
	speed: 0.0023s/iter; left time: 0.1040s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.394598960876465
Epoch: 8, Steps: 1045 | Train Loss: 0.2246812 Vali Loss: 0.4161698 Best vali loss: 0.2845754

best validation loss 0.2845753815015393

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021050639487, 'e_layers': 1, 'learning_rate': 0.0004787615336, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4208300
	speed: 0.0084s/iter; left time: 8.0021s
Updating learning rate to 0.0004605397577233773
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 0.6617143154144287
Epoch: 1, Steps: 131 | Train Loss: 0.4208300 Vali Loss: 0.2779046 Best vali loss: 0.2779046
	iters: 100, epoch: 2 | loss: 0.5301895
	speed: 0.0059s/iter; left time: 4.7974s
Updating learning rate to 0.0004086485302899155
Epoch: 2 cost time: 0.4307892322540283
Epoch: 2, Steps: 131 | Train Loss: 0.5301895 Vali Loss: 0.2843541 Best vali loss: 0.2779046
	iters: 100, epoch: 3 | loss: 0.4176808
	speed: 0.0053s/iter; left time: 3.6233s
Updating learning rate to 0.00033098782028121115
Epoch: 3 cost time: 0.3938744068145752
Epoch: 3, Steps: 131 | Train Loss: 0.4176808 Vali Loss: 0.2897239 Best vali loss: 0.2779046
	iters: 100, epoch: 4 | loss: 0.4374238
	speed: 0.0053s/iter; left time: 2.9206s
Updating learning rate to 0.0002393807668
Epoch: 4 cost time: 0.38420772552490234
Epoch: 4, Steps: 131 | Train Loss: 0.4374238 Vali Loss: 0.2955296 Best vali loss: 0.2779046
	iters: 100, epoch: 5 | loss: 0.4112561
	speed: 0.0053s/iter; left time: 2.2569s
Updating learning rate to 0.00014777371331878888
Epoch: 5 cost time: 0.3973228931427002
Epoch: 5, Steps: 131 | Train Loss: 0.4112561 Vali Loss: 0.3031685 Best vali loss: 0.2779046
	iters: 100, epoch: 6 | loss: 0.3148986
	speed: 0.0053s/iter; left time: 1.5663s
Updating learning rate to 7.011300331008445e-05
Epoch: 6 cost time: 0.4059751033782959
Epoch: 6, Steps: 131 | Train Loss: 0.3148986 Vali Loss: 0.3066843 Best vali loss: 0.2779046
	iters: 100, epoch: 7 | loss: 0.3054076
	speed: 0.0053s/iter; left time: 0.8704s
Updating learning rate to 1.822177587662265e-05
Epoch: 7 cost time: 0.3982055187225342
Epoch: 7, Steps: 131 | Train Loss: 0.3054076 Vali Loss: 0.3013771 Best vali loss: 0.2779046
	iters: 100, epoch: 8 | loss: 0.4007895
	speed: 0.0054s/iter; left time: 0.1741s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.42164182662963867
Epoch: 8, Steps: 131 | Train Loss: 0.4007895 Vali Loss: 0.3059423 Best vali loss: 0.2779046

best validation loss 0.2779046400866131

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.007539058353, 'e_layers': 3, 'learning_rate': 0.000473909479, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5315366
	speed: 0.0126s/iter; left time: 11.9363s
Updating learning rate to 0.0004558723734555937
Validation loss decreased (inf --> 0.2826).  Saving model state dict ...
Epoch: 1 cost time: 1.2239978313446045
Epoch: 1, Steps: 131 | Train Loss: 0.5315366 Vali Loss: 0.2826011 Best vali loss: 0.2826011
	iters: 100, epoch: 2 | loss: 0.4394132
	speed: 0.0123s/iter; left time: 10.0219s
Updating learning rate to 0.00040450704263474184
Epoch: 2 cost time: 0.9982786178588867
Epoch: 2, Steps: 131 | Train Loss: 0.4394132 Vali Loss: 0.2853102 Best vali loss: 0.2826011
	iters: 100, epoch: 3 | loss: 0.3273060
	speed: 0.0120s/iter; left time: 8.2609s
Updating learning rate to 0.00032763339252703575
Epoch: 3 cost time: 0.9982469081878662
Epoch: 3, Steps: 131 | Train Loss: 0.3273060 Vali Loss: 0.2868282 Best vali loss: 0.2826011

best validation loss 0.28260109799419825

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013036778434, 'e_layers': 3, 'learning_rate': 0.0001198854009, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001198854009
Validation loss decreased (inf --> 0.3215).  Saving model state dict ...
Epoch: 1 cost time: 0.6104955673217773
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3215226 Best vali loss: 0.3215226
Updating learning rate to 5.994270045e-05
Validation loss decreased (0.3215 --> 0.3025).  Saving model state dict ...
Epoch: 2 cost time: 0.3730154037475586
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3025083 Best vali loss: 0.3025083
Updating learning rate to 2.9971350225e-05
Validation loss decreased (0.3025 --> 0.2970).  Saving model state dict ...
Epoch: 3 cost time: 0.3678476810455322
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2970202 Best vali loss: 0.2970202

best validation loss 0.29702022876181805

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010058952426, 'e_layers': 3, 'learning_rate': 0.0009261397527, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5414852
	speed: 0.0098s/iter; left time: 19.5563s
	iters: 200, epoch: 1 | loss: 0.5742270
	speed: 0.0047s/iter; left time: 8.8895s
Updating learning rate to 0.0009261397527
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 1.4660844802856445
Epoch: 1, Steps: 262 | Train Loss: 0.5578561 Vali Loss: 0.2879139 Best vali loss: 0.2879139
	iters: 100, epoch: 2 | loss: 0.5743170
	speed: 0.0098s/iter; left time: 16.9732s
	iters: 200, epoch: 2 | loss: 0.6281334
	speed: 0.0045s/iter; left time: 7.4155s
Updating learning rate to 0.00046306987635
Epoch: 2 cost time: 1.2222182750701904
Epoch: 2, Steps: 262 | Train Loss: 0.6012252 Vali Loss: 0.2913741 Best vali loss: 0.2879139
	iters: 100, epoch: 3 | loss: 0.4689512
	speed: 0.0094s/iter; left time: 13.8445s
	iters: 200, epoch: 3 | loss: 0.8446249
	speed: 0.0041s/iter; left time: 5.6943s
Updating learning rate to 0.000231534938175
Epoch: 3 cost time: 1.1476097106933594
Epoch: 3, Steps: 262 | Train Loss: 0.6567881 Vali Loss: 0.2943608 Best vali loss: 0.2879139

best validation loss 0.2879139461584719

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.007539058353, 'e_layers': 3, 'learning_rate': 0.000473909479, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4307561
	speed: 0.0131s/iter; left time: 7.3072s
Updating learning rate to 0.0002369547395
Epoch: 4 cost time: 1.2364847660064697
Epoch: 4, Steps: 131 | Train Loss: 0.4307561 Vali Loss: 0.2861223 Best vali loss: 0.2826011
	iters: 100, epoch: 5 | loss: 0.3322421
	speed: 0.0120s/iter; left time: 5.1055s
Updating learning rate to 0.0001462760864729643
Epoch: 5 cost time: 0.9982850551605225
Epoch: 5, Steps: 131 | Train Loss: 0.3322421 Vali Loss: 0.2915834 Best vali loss: 0.2826011
	iters: 100, epoch: 6 | loss: 0.2767393
	speed: 0.0120s/iter; left time: 3.5350s
Updating learning rate to 6.940243636525815e-05
Epoch: 6 cost time: 1.0047416687011719
Epoch: 6, Steps: 131 | Train Loss: 0.2767393 Vali Loss: 0.3016119 Best vali loss: 0.2826011
	iters: 100, epoch: 7 | loss: 0.3757186
	speed: 0.0121s/iter; left time: 1.9691s
Updating learning rate to 1.803710554440627e-05
Epoch: 7 cost time: 1.0073578357696533
Epoch: 7, Steps: 131 | Train Loss: 0.3757186 Vali Loss: 0.3050819 Best vali loss: 0.2826011
	iters: 100, epoch: 8 | loss: 0.3506524
	speed: 0.0120s/iter; left time: 0.3854s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9992156028747559
Epoch: 8, Steps: 131 | Train Loss: 0.3506524 Vali Loss: 0.3104628 Best vali loss: 0.2826011

best validation loss 0.28260109799419825

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0027867335367, 'e_layers': 3, 'learning_rate': 0.000474913451, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5546570
	speed: 0.0107s/iter; left time: 10.1552s
Updating learning rate to 0.00045683813404660096
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 0.9602968692779541
Epoch: 1, Steps: 131 | Train Loss: 0.5546570 Vali Loss: 0.2853385 Best vali loss: 0.2853385
	iters: 100, epoch: 2 | loss: 0.5124403
	speed: 0.0090s/iter; left time: 7.3758s
Updating learning rate to 0.00040536398633940257
Epoch: 2 cost time: 0.7284095287322998
Epoch: 2, Steps: 131 | Train Loss: 0.5124403 Vali Loss: 0.2909137 Best vali loss: 0.2853385
	iters: 100, epoch: 3 | loss: 0.4884645
	speed: 0.0088s/iter; left time: 6.0547s
Updating learning rate to 0.00032832748025251495
Epoch: 3 cost time: 0.7254602909088135
Epoch: 3, Steps: 131 | Train Loss: 0.4884645 Vali Loss: 0.3066496 Best vali loss: 0.2853385
	iters: 100, epoch: 4 | loss: 0.3693825
	speed: 0.0086s/iter; left time: 4.7973s
Updating learning rate to 0.0002374567255
Epoch: 4 cost time: 0.7133653163909912
Epoch: 4, Steps: 131 | Train Loss: 0.3693825 Vali Loss: 0.2954874 Best vali loss: 0.2853385
	iters: 100, epoch: 5 | loss: 0.3116083
	speed: 0.0087s/iter; left time: 3.6779s
Updating learning rate to 0.00014658597074748508
Epoch: 5 cost time: 0.7167167663574219
Epoch: 5, Steps: 131 | Train Loss: 0.3116083 Vali Loss: 0.3179824 Best vali loss: 0.2853385
	iters: 100, epoch: 6 | loss: 0.2648624
	speed: 0.0086s/iter; left time: 2.5395s
Updating learning rate to 6.954946466059744e-05
Epoch: 6 cost time: 0.7113268375396729
Epoch: 6, Steps: 131 | Train Loss: 0.2648624 Vali Loss: 0.3394633 Best vali loss: 0.2853385
	iters: 100, epoch: 7 | loss: 0.2530155
	speed: 0.0087s/iter; left time: 1.4135s
Updating learning rate to 1.807531695339906e-05
Epoch: 7 cost time: 0.7180516719818115
Epoch: 7, Steps: 131 | Train Loss: 0.2530155 Vali Loss: 0.3399511 Best vali loss: 0.2853385
	iters: 100, epoch: 8 | loss: 0.2652677
	speed: 0.0088s/iter; left time: 0.2830s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7335209846496582
Epoch: 8, Steps: 131 | Train Loss: 0.2652677 Vali Loss: 0.3397349 Best vali loss: 0.2853385

best validation loss 0.2853385096325135

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0038645427448, 'e_layers': 4, 'learning_rate': 0.000505651286, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4794891
	speed: 0.0109s/iter; left time: 44.5385s
	iters: 200, epoch: 1 | loss: 0.3014530
	speed: 0.0056s/iter; left time: 22.1499s
	iters: 300, epoch: 1 | loss: 1.1491145
	speed: 0.0055s/iter; left time: 21.4423s
	iters: 400, epoch: 1 | loss: 0.2532724
	speed: 0.0051s/iter; left time: 19.3889s
	iters: 500, epoch: 1 | loss: 0.6820828
	speed: 0.0051s/iter; left time: 18.7509s
Updating learning rate to 0.000505651286
Validation loss decreased (inf --> 0.3102).  Saving model state dict ...
Epoch: 1 cost time: 3.066404342651367
Epoch: 1, Steps: 523 | Train Loss: 0.5730824 Vali Loss: 0.3102137 Best vali loss: 0.3102137
	iters: 100, epoch: 2 | loss: 0.4038310
	speed: 0.0108s/iter; left time: 38.6420s
	iters: 200, epoch: 2 | loss: 0.5230930
	speed: 0.0048s/iter; left time: 16.5700s
	iters: 300, epoch: 2 | loss: 0.3168822
	speed: 0.0048s/iter; left time: 16.2242s
	iters: 400, epoch: 2 | loss: 0.9924496
	speed: 0.0048s/iter; left time: 15.6965s
	iters: 500, epoch: 2 | loss: 0.5324212
	speed: 0.0048s/iter; left time: 15.1908s
Updating learning rate to 0.000252825643
Epoch: 2 cost time: 2.5791354179382324
Epoch: 2, Steps: 523 | Train Loss: 0.5537354 Vali Loss: 0.3205718 Best vali loss: 0.3102137
	iters: 100, epoch: 3 | loss: 1.2815267
	speed: 0.0100s/iter; left time: 30.5024s
	iters: 200, epoch: 3 | loss: 0.6317692
	speed: 0.0048s/iter; left time: 13.9851s
	iters: 300, epoch: 3 | loss: 0.2743872
	speed: 0.0048s/iter; left time: 13.6976s
	iters: 400, epoch: 3 | loss: 1.1981797
	speed: 0.0048s/iter; left time: 13.0778s
	iters: 500, epoch: 3 | loss: 0.4247983
	speed: 0.0047s/iter; left time: 12.5302s
Updating learning rate to 0.0001264128215
Epoch: 3 cost time: 2.533097267150879
Epoch: 3, Steps: 523 | Train Loss: 0.7621322 Vali Loss: 0.3221142 Best vali loss: 0.3102137
	iters: 100, epoch: 4 | loss: 0.2418828
	speed: 0.0099s/iter; left time: 24.9013s
	iters: 200, epoch: 4 | loss: 0.9731521
	speed: 0.0048s/iter; left time: 11.5344s
	iters: 300, epoch: 4 | loss: 1.2580398
	speed: 0.0048s/iter; left time: 11.0817s
	iters: 400, epoch: 4 | loss: 0.3370125
	speed: 0.0048s/iter; left time: 10.6065s
	iters: 500, epoch: 4 | loss: 0.3133608
	speed: 0.0048s/iter; left time: 10.2611s
Updating learning rate to 6.320641075e-05
Epoch: 4 cost time: 2.5434577465057373
Epoch: 4, Steps: 523 | Train Loss: 0.6246896 Vali Loss: 0.3212343 Best vali loss: 0.3102137
	iters: 100, epoch: 5 | loss: 0.6322471
	speed: 0.0100s/iter; left time: 19.8757s
	iters: 200, epoch: 5 | loss: 0.3347255
	speed: 0.0049s/iter; left time: 9.2546s
	iters: 300, epoch: 5 | loss: 1.0404257
	speed: 0.0049s/iter; left time: 8.7971s
	iters: 400, epoch: 5 | loss: 0.5345608
	speed: 0.0049s/iter; left time: 8.2614s
	iters: 500, epoch: 5 | loss: 0.2541116
	speed: 0.0049s/iter; left time: 7.7790s
Updating learning rate to 3.1603205375e-05
Epoch: 5 cost time: 2.590344190597534
Epoch: 5, Steps: 523 | Train Loss: 0.5592141 Vali Loss: 0.3217462 Best vali loss: 0.3102137
	iters: 100, epoch: 6 | loss: 0.2884640
	speed: 0.0100s/iter; left time: 14.6996s
	iters: 200, epoch: 6 | loss: 0.3927297
	speed: 0.0050s/iter; left time: 6.8544s
	iters: 300, epoch: 6 | loss: 0.9558486
	speed: 0.0054s/iter; left time: 6.8465s
	iters: 400, epoch: 6 | loss: 0.6319789
	speed: 0.0054s/iter; left time: 6.3290s
	iters: 500, epoch: 6 | loss: 0.2816818
	speed: 0.0053s/iter; left time: 5.6874s
Updating learning rate to 1.58016026875e-05
Epoch: 6 cost time: 2.7603933811187744
Epoch: 6, Steps: 523 | Train Loss: 0.5101406 Vali Loss: 0.3223991 Best vali loss: 0.3102137
	iters: 100, epoch: 7 | loss: 0.3591898
	speed: 0.0107s/iter; left time: 10.1731s
	iters: 200, epoch: 7 | loss: 0.7699999
	speed: 0.0053s/iter; left time: 4.5137s
	iters: 300, epoch: 7 | loss: 0.9538017
	speed: 0.0050s/iter; left time: 3.7048s
	iters: 400, epoch: 7 | loss: 0.2996473
	speed: 0.0048s/iter; left time: 3.1374s
	iters: 500, epoch: 7 | loss: 0.4143096
	speed: 0.0050s/iter; left time: 2.7085s
Updating learning rate to 7.90080134375e-06
Epoch: 7 cost time: 2.700113534927368
Epoch: 7, Steps: 523 | Train Loss: 0.5593896 Vali Loss: 0.3225127 Best vali loss: 0.3102137
	iters: 100, epoch: 8 | loss: 0.7313778
	speed: 0.0103s/iter; left time: 4.3703s
	iters: 200, epoch: 8 | loss: 0.2385483
	speed: 0.0049s/iter; left time: 1.5799s
	iters: 300, epoch: 8 | loss: 0.6330838
	speed: 0.0049s/iter; left time: 1.0900s
	iters: 400, epoch: 8 | loss: 0.3345312
	speed: 0.0049s/iter; left time: 0.6082s
	iters: 500, epoch: 8 | loss: 0.3523566
	speed: 0.0049s/iter; left time: 0.1169s
Updating learning rate to 3.950400671875e-06
Epoch: 8 cost time: 2.5979678630828857
Epoch: 8, Steps: 523 | Train Loss: 0.4579796 Vali Loss: 0.3223998 Best vali loss: 0.3102137

best validation loss 0.31021369300441876

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011110496351, 'e_layers': 4, 'learning_rate': 0.0007612920948, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2011426
	speed: 0.0104s/iter; left time: 86.1069s
	iters: 200, epoch: 1 | loss: 0.3165964
	speed: 0.0052s/iter; left time: 42.6164s
	iters: 300, epoch: 1 | loss: 0.3038082
	speed: 0.0054s/iter; left time: 43.7761s
	iters: 400, epoch: 1 | loss: 0.7723904
	speed: 0.0053s/iter; left time: 42.0834s
	iters: 500, epoch: 1 | loss: 0.9067062
	speed: 0.0053s/iter; left time: 41.4561s
	iters: 600, epoch: 1 | loss: 1.2079329
	speed: 0.0053s/iter; left time: 40.8513s
	iters: 700, epoch: 1 | loss: 0.9687458
	speed: 0.0052s/iter; left time: 40.0301s
	iters: 800, epoch: 1 | loss: 0.1810726
	speed: 0.0052s/iter; left time: 39.1781s
	iters: 900, epoch: 1 | loss: 0.5768739
	speed: 0.0052s/iter; left time: 38.8739s
	iters: 1000, epoch: 1 | loss: 0.2388743
	speed: 0.0053s/iter; left time: 38.6485s
Updating learning rate to 0.0007612920948
Validation loss decreased (inf --> 0.3292).  Saving model state dict ...
Epoch: 1 cost time: 5.759106159210205
Epoch: 1, Steps: 1045 | Train Loss: 0.5674143 Vali Loss: 0.3292449 Best vali loss: 0.3292449
	iters: 100, epoch: 2 | loss: 0.5073553
	speed: 0.0146s/iter; left time: 105.4775s
	iters: 200, epoch: 2 | loss: 0.6368168
	speed: 0.0052s/iter; left time: 36.8263s
	iters: 300, epoch: 2 | loss: 0.2956099
	speed: 0.0052s/iter; left time: 36.2711s
	iters: 400, epoch: 2 | loss: 0.5394603
	speed: 0.0052s/iter; left time: 35.7892s
	iters: 500, epoch: 2 | loss: 0.4539841
	speed: 0.0051s/iter; left time: 35.0590s
	iters: 600, epoch: 2 | loss: 0.2129255
	speed: 0.0051s/iter; left time: 34.5843s
	iters: 700, epoch: 2 | loss: 0.2347385
	speed: 0.0051s/iter; left time: 33.9414s
	iters: 800, epoch: 2 | loss: 0.3555846
	speed: 0.0051s/iter; left time: 33.3502s
	iters: 900, epoch: 2 | loss: 0.4573894
	speed: 0.0054s/iter; left time: 34.5927s
	iters: 1000, epoch: 2 | loss: 0.3556273
	speed: 0.0052s/iter; left time: 32.6370s
Updating learning rate to 0.0003806460474
Validation loss decreased (0.3292 --> 0.3227).  Saving model state dict ...
Epoch: 2 cost time: 5.44341254234314
Epoch: 2, Steps: 1045 | Train Loss: 0.4049492 Vali Loss: 0.3227196 Best vali loss: 0.3227196
	iters: 100, epoch: 3 | loss: 1.3539847
	speed: 0.0144s/iter; left time: 88.8155s
	iters: 200, epoch: 3 | loss: 0.6965612
	speed: 0.0048s/iter; left time: 29.4199s
	iters: 300, epoch: 3 | loss: 0.2752695
	speed: 0.0049s/iter; left time: 29.2639s
	iters: 400, epoch: 3 | loss: 1.5114114
	speed: 0.0049s/iter; left time: 28.9474s
	iters: 500, epoch: 3 | loss: 0.4987508
	speed: 0.0049s/iter; left time: 28.2561s
	iters: 600, epoch: 3 | loss: 0.3602217
	speed: 0.0047s/iter; left time: 26.8498s
	iters: 700, epoch: 3 | loss: 1.4216402
	speed: 0.0047s/iter; left time: 26.3452s
	iters: 800, epoch: 3 | loss: 0.3421032
	speed: 0.0047s/iter; left time: 25.5627s
	iters: 900, epoch: 3 | loss: 0.2695575
	speed: 0.0047s/iter; left time: 25.4423s
	iters: 1000, epoch: 3 | loss: 1.0384899
	speed: 0.0047s/iter; left time: 24.8342s
Updating learning rate to 0.0001903230237
Epoch: 3 cost time: 5.053182363510132
Epoch: 3, Steps: 1045 | Train Loss: 0.7767990 Vali Loss: 0.3259167 Best vali loss: 0.3227196

best validation loss 0.3227196075507104

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0105943011493, 'e_layers': 3, 'learning_rate': 0.0004750308739, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5539029
	speed: 0.0107s/iter; left time: 10.1556s
Updating learning rate to 0.0004750308739
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 0.9648950099945068
Epoch: 1, Steps: 131 | Train Loss: 0.5539029 Vali Loss: 0.2838957 Best vali loss: 0.2838957
	iters: 100, epoch: 2 | loss: 0.5311393
	speed: 0.0091s/iter; left time: 7.4249s
Updating learning rate to 0.00023751543695
Validation loss decreased (0.2839 --> 0.2799).  Saving model state dict ...
Epoch: 2 cost time: 0.7410614490509033
Epoch: 2, Steps: 131 | Train Loss: 0.5311393 Vali Loss: 0.2799332 Best vali loss: 0.2799332
	iters: 100, epoch: 3 | loss: 0.4559582
	speed: 0.0093s/iter; left time: 6.4096s
Updating learning rate to 0.000118757718475
Epoch: 3 cost time: 0.7415511608123779
Epoch: 3, Steps: 131 | Train Loss: 0.4559582 Vali Loss: 0.2937561 Best vali loss: 0.2799332

best validation loss 0.2799331651229582

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0027056250419, 'e_layers': 1, 'learning_rate': 0.0008852078113, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4395891
	speed: 0.0077s/iter; left time: 31.3978s
	iters: 200, epoch: 1 | loss: 0.4042430
	speed: 0.0024s/iter; left time: 9.7046s
	iters: 300, epoch: 1 | loss: 0.5325019
	speed: 0.0024s/iter; left time: 9.4236s
	iters: 400, epoch: 1 | loss: 0.4352755
	speed: 0.0024s/iter; left time: 9.1881s
	iters: 500, epoch: 1 | loss: 0.2598720
	speed: 0.0024s/iter; left time: 8.9822s
Updating learning rate to 0.0008515165950895916
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 1.5247211456298828
Epoch: 1, Steps: 523 | Train Loss: 0.4142963 Vali Loss: 0.2843670 Best vali loss: 0.2843670
	iters: 100, epoch: 2 | loss: 0.3216019
	speed: 0.0059s/iter; left time: 20.9288s
	iters: 200, epoch: 2 | loss: 0.1992650
	speed: 0.0024s/iter; left time: 8.2857s
	iters: 300, epoch: 2 | loss: 0.7043839
	speed: 0.0024s/iter; left time: 8.1973s
	iters: 400, epoch: 2 | loss: 0.2574219
	speed: 0.0023s/iter; left time: 7.5647s
	iters: 500, epoch: 2 | loss: 0.7868682
	speed: 0.0024s/iter; left time: 7.4871s
Updating learning rate to 0.0007555721287147659
Epoch: 2 cost time: 1.2919108867645264
Epoch: 2, Steps: 523 | Train Loss: 0.4539082 Vali Loss: 0.2881109 Best vali loss: 0.2843670
	iters: 100, epoch: 3 | loss: 0.3369989
	speed: 0.0054s/iter; left time: 16.4481s
	iters: 200, epoch: 3 | loss: 0.3257385
	speed: 0.0023s/iter; left time: 6.7230s
	iters: 300, epoch: 3 | loss: 0.3143244
	speed: 0.0023s/iter; left time: 6.5310s
	iters: 400, epoch: 3 | loss: 0.5837944
	speed: 0.0023s/iter; left time: 6.3611s
	iters: 500, epoch: 3 | loss: 0.4072012
	speed: 0.0023s/iter; left time: 6.1537s
Updating learning rate to 0.0006119810874423364
Epoch: 3 cost time: 1.236159086227417
Epoch: 3, Steps: 523 | Train Loss: 0.3936115 Vali Loss: 0.2921482 Best vali loss: 0.2843670

best validation loss 0.2843670132807215

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0105943011493, 'e_layers': 3, 'learning_rate': 0.0004750308739, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3570482
	speed: 0.0110s/iter; left time: 6.1272s
Updating learning rate to 5.93788592375e-05
Epoch: 4 cost time: 0.9895749092102051
Epoch: 4, Steps: 131 | Train Loss: 0.3570482 Vali Loss: 0.3022229 Best vali loss: 0.2799332
	iters: 100, epoch: 5 | loss: 0.3869409
	speed: 0.0089s/iter; left time: 3.7993s
Updating learning rate to 2.968942961875e-05
Epoch: 5 cost time: 0.717808723449707
Epoch: 5, Steps: 131 | Train Loss: 0.3869409 Vali Loss: 0.2974058 Best vali loss: 0.2799332
	iters: 100, epoch: 6 | loss: 0.3807229
	speed: 0.0086s/iter; left time: 2.5423s
Updating learning rate to 1.4844714809375e-05
Epoch: 6 cost time: 0.7143247127532959
Epoch: 6, Steps: 131 | Train Loss: 0.3807229 Vali Loss: 0.3068322 Best vali loss: 0.2799332
	iters: 100, epoch: 7 | loss: 0.3400882
	speed: 0.0088s/iter; left time: 1.4316s
Updating learning rate to 7.4223574046875e-06
Epoch: 7 cost time: 0.7164011001586914
Epoch: 7, Steps: 131 | Train Loss: 0.3400882 Vali Loss: 0.3105488 Best vali loss: 0.2799332
	iters: 100, epoch: 8 | loss: 0.3166141
	speed: 0.0090s/iter; left time: 0.2874s
Updating learning rate to 3.71117870234375e-06
Epoch: 8 cost time: 0.7530117034912109
Epoch: 8, Steps: 131 | Train Loss: 0.3166141 Vali Loss: 0.3103235 Best vali loss: 0.2799332

best validation loss 0.2799331651229582

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010260544313, 'e_layers': 2, 'learning_rate': 0.0002347500489, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596933
	speed: 0.0104s/iter; left time: 9.8487s
Updating learning rate to 0.0002347500489
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9277207851409912
Epoch: 1, Steps: 131 | Train Loss: 0.5596933 Vali Loss: 0.2756427 Best vali loss: 0.2756427
	iters: 100, epoch: 2 | loss: 0.3257193
	speed: 0.0090s/iter; left time: 7.3242s
Updating learning rate to 0.00011737502445
Validation loss decreased (0.2756 --> 0.2693).  Saving model state dict ...
Epoch: 2 cost time: 0.703376293182373
Epoch: 2, Steps: 131 | Train Loss: 0.3257193 Vali Loss: 0.2693140 Best vali loss: 0.2693140
	iters: 100, epoch: 3 | loss: 0.4622351
	speed: 0.0091s/iter; left time: 6.2484s
Updating learning rate to 5.8687512225e-05
Epoch: 3 cost time: 0.708061933517456
Epoch: 3, Steps: 131 | Train Loss: 0.4622351 Vali Loss: 0.2807258 Best vali loss: 0.2693140
	iters: 100, epoch: 4 | loss: 0.5071533
	speed: 0.0086s/iter; left time: 4.8067s
Updating learning rate to 2.93437561125e-05
Epoch: 4 cost time: 0.6982264518737793
Epoch: 4, Steps: 131 | Train Loss: 0.5071533 Vali Loss: 0.2885978 Best vali loss: 0.2693140
	iters: 100, epoch: 5 | loss: 0.3344550
	speed: 0.0086s/iter; left time: 3.6706s
Updating learning rate to 1.467187805625e-05
Epoch: 5 cost time: 0.6999502182006836
Epoch: 5, Steps: 131 | Train Loss: 0.3344550 Vali Loss: 0.2898230 Best vali loss: 0.2693140
	iters: 100, epoch: 6 | loss: 0.3183374
	speed: 0.0086s/iter; left time: 2.5222s
Updating learning rate to 7.335939028125e-06
Epoch: 6 cost time: 0.6934976577758789
Epoch: 6, Steps: 131 | Train Loss: 0.3183374 Vali Loss: 0.2887860 Best vali loss: 0.2693140
	iters: 100, epoch: 7 | loss: 0.3116730
	speed: 0.0087s/iter; left time: 1.4114s
Updating learning rate to 3.6679695140625e-06
Epoch: 7 cost time: 0.703789234161377
Epoch: 7, Steps: 131 | Train Loss: 0.3116730 Vali Loss: 0.2964632 Best vali loss: 0.2693140
	iters: 100, epoch: 8 | loss: 0.3962923
	speed: 0.0086s/iter; left time: 0.2747s
Updating learning rate to 1.83398475703125e-06
Epoch: 8 cost time: 0.6953282356262207
Epoch: 8, Steps: 131 | Train Loss: 0.3962923 Vali Loss: 0.2955085 Best vali loss: 0.2693140

best validation loss 0.2693140002465594

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0024716168655, 'e_layers': 4, 'learning_rate': 0.0005717348472, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3775190
	speed: 0.0104s/iter; left time: 42.5165s
	iters: 200, epoch: 1 | loss: 0.6681532
	speed: 0.0051s/iter; left time: 20.4711s
	iters: 300, epoch: 1 | loss: 1.0995891
	speed: 0.0051s/iter; left time: 19.9094s
	iters: 400, epoch: 1 | loss: 0.2628760
	speed: 0.0052s/iter; left time: 19.5175s
	iters: 500, epoch: 1 | loss: 0.2191656
	speed: 0.0051s/iter; left time: 18.9734s
Updating learning rate to 0.0005717348472
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 2.9434423446655273
Epoch: 1, Steps: 523 | Train Loss: 0.5254606 Vali Loss: 0.2841088 Best vali loss: 0.2841088
	iters: 100, epoch: 2 | loss: 0.3139285
	speed: 0.0103s/iter; left time: 36.5524s
	iters: 200, epoch: 2 | loss: 0.4578498
	speed: 0.0050s/iter; left time: 17.4536s
	iters: 300, epoch: 2 | loss: 0.7808594
	speed: 0.0050s/iter; left time: 16.8750s
	iters: 400, epoch: 2 | loss: 0.6781122
	speed: 0.0050s/iter; left time: 16.3731s
	iters: 500, epoch: 2 | loss: 0.3815116
	speed: 0.0051s/iter; left time: 16.0860s
Updating learning rate to 0.0002858674236
Epoch: 2 cost time: 2.6725404262542725
Epoch: 2, Steps: 523 | Train Loss: 0.5224523 Vali Loss: 0.2844520 Best vali loss: 0.2841088
	iters: 100, epoch: 3 | loss: 0.2821281
	speed: 0.0104s/iter; left time: 31.5253s
	iters: 200, epoch: 3 | loss: 0.4168521
	speed: 0.0051s/iter; left time: 14.9314s
	iters: 300, epoch: 3 | loss: 0.4020226
	speed: 0.0050s/iter; left time: 14.3113s
	iters: 400, epoch: 3 | loss: 0.9312668
	speed: 0.0051s/iter; left time: 13.8907s
	iters: 500, epoch: 3 | loss: 0.5659378
	speed: 0.0051s/iter; left time: 13.4287s
Updating learning rate to 0.0001429337118
Epoch: 3 cost time: 2.6850671768188477
Epoch: 3, Steps: 523 | Train Loss: 0.5196415 Vali Loss: 0.2861487 Best vali loss: 0.2841088
	iters: 100, epoch: 4 | loss: 0.3508936
	speed: 0.0098s/iter; left time: 24.6228s
	iters: 200, epoch: 4 | loss: 0.3004817
	speed: 0.0047s/iter; left time: 11.3251s
	iters: 300, epoch: 4 | loss: 0.2922908
	speed: 0.0047s/iter; left time: 10.9417s
	iters: 400, epoch: 4 | loss: 0.3924226
	speed: 0.0048s/iter; left time: 10.5846s
	iters: 500, epoch: 4 | loss: 0.3734997
	speed: 0.0047s/iter; left time: 9.9937s
Updating learning rate to 7.14668559e-05
Epoch: 4 cost time: 2.5133023262023926
Epoch: 4, Steps: 523 | Train Loss: 0.3419177 Vali Loss: 0.2871168 Best vali loss: 0.2841088
	iters: 100, epoch: 5 | loss: 0.3361674
	speed: 0.0098s/iter; left time: 19.4770s
	iters: 200, epoch: 5 | loss: 0.6995088
	speed: 0.0047s/iter; left time: 8.9642s
	iters: 300, epoch: 5 | loss: 0.5650544
	speed: 0.0048s/iter; left time: 8.5536s
	iters: 400, epoch: 5 | loss: 0.3803349
	speed: 0.0048s/iter; left time: 8.1087s
	iters: 500, epoch: 5 | loss: 0.2675688
	speed: 0.0048s/iter; left time: 7.6631s
Updating learning rate to 3.573342795e-05
Epoch: 5 cost time: 2.5395750999450684
Epoch: 5, Steps: 523 | Train Loss: 0.4497269 Vali Loss: 0.2882571 Best vali loss: 0.2841088
	iters: 100, epoch: 6 | loss: 0.6638532
	speed: 0.0097s/iter; left time: 14.1938s
	iters: 200, epoch: 6 | loss: 0.7718797
	speed: 0.0047s/iter; left time: 6.4536s
	iters: 300, epoch: 6 | loss: 0.4881109
	speed: 0.0047s/iter; left time: 5.9286s
	iters: 400, epoch: 6 | loss: 1.3363355
	speed: 0.0046s/iter; left time: 5.3476s
	iters: 500, epoch: 6 | loss: 0.2880636
	speed: 0.0046s/iter; left time: 4.9162s
Updating learning rate to 1.7866713975e-05
Epoch: 6 cost time: 2.4659557342529297
Epoch: 6, Steps: 523 | Train Loss: 0.7096486 Vali Loss: 0.2893944 Best vali loss: 0.2841088
	iters: 100, epoch: 7 | loss: 0.5274336
	speed: 0.0099s/iter; left time: 9.4176s
	iters: 200, epoch: 7 | loss: 1.2686385
	speed: 0.0050s/iter; left time: 4.2289s
	iters: 300, epoch: 7 | loss: 0.4734574
	speed: 0.0050s/iter; left time: 3.7579s
	iters: 400, epoch: 7 | loss: 0.3525223
	speed: 0.0051s/iter; left time: 3.2795s
	iters: 500, epoch: 7 | loss: 0.2318198
	speed: 0.0050s/iter; left time: 2.7193s
Updating learning rate to 8.9333569875e-06
Epoch: 7 cost time: 2.6521239280700684
Epoch: 7, Steps: 523 | Train Loss: 0.5707743 Vali Loss: 0.2884322 Best vali loss: 0.2841088
	iters: 100, epoch: 8 | loss: 0.4449356
	speed: 0.0100s/iter; left time: 4.2486s
	iters: 200, epoch: 8 | loss: 0.3505462
	speed: 0.0051s/iter; left time: 1.6562s
	iters: 300, epoch: 8 | loss: 0.3415091
	speed: 0.0051s/iter; left time: 1.1316s
	iters: 400, epoch: 8 | loss: 0.7129481
	speed: 0.0051s/iter; left time: 0.6266s
	iters: 500, epoch: 8 | loss: 0.4547395
	speed: 0.0051s/iter; left time: 0.1222s
Updating learning rate to 4.46667849375e-06
Epoch: 8 cost time: 2.6886141300201416
Epoch: 8, Steps: 523 | Train Loss: 0.4609357 Vali Loss: 0.2888087 Best vali loss: 0.2841088

best validation loss 0.28410876210115354

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0036675915602, 'e_layers': 1, 'learning_rate': 0.0012014366455, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2930009
	speed: 0.0070s/iter; left time: 28.6449s
	iters: 200, epoch: 1 | loss: 1.3877006
	speed: 0.0024s/iter; left time: 9.7225s
	iters: 300, epoch: 1 | loss: 0.3851194
	speed: 0.0024s/iter; left time: 9.3885s
	iters: 400, epoch: 1 | loss: 0.7455535
	speed: 0.0024s/iter; left time: 9.2487s
	iters: 500, epoch: 1 | loss: 0.4321665
	speed: 0.0025s/iter; left time: 9.0498s
Updating learning rate to 0.0011557096859432343
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 1.5370292663574219
Epoch: 1, Steps: 523 | Train Loss: 0.6487082 Vali Loss: 0.2847389 Best vali loss: 0.2847389
	iters: 100, epoch: 2 | loss: 0.6516668
	speed: 0.0060s/iter; left time: 21.2103s
	iters: 200, epoch: 2 | loss: 0.8420954
	speed: 0.0024s/iter; left time: 8.3218s
	iters: 300, epoch: 2 | loss: 0.2544760
	speed: 0.0024s/iter; left time: 8.0297s
	iters: 400, epoch: 2 | loss: 0.2845562
	speed: 0.0024s/iter; left time: 7.7523s
	iters: 500, epoch: 2 | loss: 0.2574290
	speed: 0.0023s/iter; left time: 7.4194s
Updating learning rate to 0.001025490322349534
Epoch: 2 cost time: 1.289991855621338
Epoch: 2, Steps: 523 | Train Loss: 0.4580447 Vali Loss: 0.2952859 Best vali loss: 0.2847389
	iters: 100, epoch: 3 | loss: 0.3539616
	speed: 0.0057s/iter; left time: 17.3010s
	iters: 200, epoch: 3 | loss: 0.3413922
	speed: 0.0023s/iter; left time: 6.8844s
	iters: 300, epoch: 3 | loss: 0.8363016
	speed: 0.0023s/iter; left time: 6.3932s
	iters: 400, epoch: 3 | loss: 0.4362655
	speed: 0.0022s/iter; left time: 6.0605s
	iters: 500, epoch: 3 | loss: 0.2625016
	speed: 0.0022s/iter; left time: 5.8004s
Updating learning rate to 0.0008306032723845698
Epoch: 3 cost time: 1.2199511528015137
Epoch: 3, Steps: 523 | Train Loss: 0.4460845 Vali Loss: 0.2978525 Best vali loss: 0.2847389

best validation loss 0.28473889095969873

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0027568223796, 'e_layers': 3, 'learning_rate': 0.0004750673926, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5180116
	speed: 0.0112s/iter; left time: 10.6609s
Updating learning rate to 0.000456986216593322
Validation loss decreased (inf --> 0.2732).  Saving model state dict ...
Epoch: 1 cost time: 1.1323728561401367
Epoch: 1, Steps: 131 | Train Loss: 0.5180116 Vali Loss: 0.2731563 Best vali loss: 0.2731563
	iters: 100, epoch: 2 | loss: 0.5271583
	speed: 0.0112s/iter; left time: 9.1899s
Updating learning rate to 0.00040549538371403593
Epoch: 2 cost time: 0.9088568687438965
Epoch: 2, Steps: 131 | Train Loss: 0.5271583 Vali Loss: 0.2868455 Best vali loss: 0.2731563
	iters: 100, epoch: 3 | loss: 0.5458227
	speed: 0.0109s/iter; left time: 7.5148s
Updating learning rate to 0.00032843390650245084
Epoch: 3 cost time: 0.904322624206543
Epoch: 3, Steps: 131 | Train Loss: 0.5458227 Vali Loss: 0.2952611 Best vali loss: 0.2731563

best validation loss 0.2731562897579605

[INFO][smbo.py:320] Finished 1250 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013397992436, 'e_layers': 3, 'learning_rate': 0.0004798217576, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5230091
	speed: 0.0121s/iter; left time: 11.4859s
Updating learning rate to 0.00046155962935011597
Validation loss decreased (inf --> 0.2716).  Saving model state dict ...
Epoch: 1 cost time: 1.146493911743164
Epoch: 1, Steps: 131 | Train Loss: 0.5230091 Vali Loss: 0.2715824 Best vali loss: 0.2715824
	iters: 100, epoch: 2 | loss: 0.5678592
	speed: 0.0113s/iter; left time: 9.2198s
Updating learning rate to 0.0004095534880799039
Epoch: 2 cost time: 0.9125981330871582
Epoch: 2, Steps: 131 | Train Loss: 0.5678592 Vali Loss: 0.2791875 Best vali loss: 0.2715824
	iters: 100, epoch: 3 | loss: 0.5464866
	speed: 0.0110s/iter; left time: 7.5515s
Updating learning rate to 0.00033172079736090905
Epoch: 3 cost time: 0.9080169200897217
Epoch: 3, Steps: 131 | Train Loss: 0.5464866 Vali Loss: 0.2979659 Best vali loss: 0.2715824

best validation loss 0.2715824270733851

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013397992436, 'e_layers': 3, 'learning_rate': 0.0004798217576, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4125284
	speed: 0.0124s/iter; left time: 6.9137s
Updating learning rate to 0.0002399108788
Epoch: 4 cost time: 1.13543701171875
Epoch: 4, Steps: 131 | Train Loss: 0.4125284 Vali Loss: 0.2913594 Best vali loss: 0.2715824
	iters: 100, epoch: 5 | loss: 0.3505198
	speed: 0.0110s/iter; left time: 4.6947s
Updating learning rate to 0.00014810096023909095
Epoch: 5 cost time: 0.9092981815338135
Epoch: 5, Steps: 131 | Train Loss: 0.3505198 Vali Loss: 0.2908157 Best vali loss: 0.2715824
	iters: 100, epoch: 6 | loss: 0.3649505
	speed: 0.0110s/iter; left time: 3.2377s
Updating learning rate to 7.026826952009609e-05
Epoch: 6 cost time: 0.9114367961883545
Epoch: 6, Steps: 131 | Train Loss: 0.3649505 Vali Loss: 0.2995690 Best vali loss: 0.2715824
	iters: 100, epoch: 7 | loss: 0.2592550
	speed: 0.0110s/iter; left time: 1.7878s
Updating learning rate to 1.826212824988403e-05
Epoch: 7 cost time: 0.9059009552001953
Epoch: 7, Steps: 131 | Train Loss: 0.2592550 Vali Loss: 0.3056048 Best vali loss: 0.2715824
	iters: 100, epoch: 8 | loss: 0.2822848
	speed: 0.0110s/iter; left time: 0.3529s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9151530265808105
Epoch: 8, Steps: 131 | Train Loss: 0.2822848 Vali Loss: 0.3061084 Best vali loss: 0.2715824

best validation loss 0.2715824270733851

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0079293866921, 'e_layers': 3, 'learning_rate': 0.0017259965906, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8600953
	speed: 0.0101s/iter; left time: 20.0768s
	iters: 200, epoch: 1 | loss: 0.9477775
	speed: 0.0044s/iter; left time: 8.4322s
Updating learning rate to 0.0016603047569198014
Validation loss decreased (inf --> 0.3159).  Saving model state dict ...
Epoch: 1 cost time: 1.4579288959503174
Epoch: 1, Steps: 262 | Train Loss: 0.9039364 Vali Loss: 0.3158983 Best vali loss: 0.3158983
	iters: 100, epoch: 2 | loss: 0.5442947
	speed: 0.0098s/iter; left time: 16.9877s
	iters: 200, epoch: 2 | loss: 0.5557542
	speed: 0.0041s/iter; left time: 6.7339s
Updating learning rate to 0.0014732302420590606
Epoch: 2 cost time: 1.1415486335754395
Epoch: 2, Steps: 262 | Train Loss: 0.5500245 Vali Loss: 0.3227790 Best vali loss: 0.3158983
	iters: 100, epoch: 3 | loss: 0.5668569
	speed: 0.0091s/iter; left time: 13.3887s
	iters: 200, epoch: 3 | loss: 0.6106671
	speed: 0.0046s/iter; left time: 6.2472s
Updating learning rate to 0.0011932534450706253
Epoch: 3 cost time: 1.1981754302978516
Epoch: 3, Steps: 262 | Train Loss: 0.5887620 Vali Loss: 0.3200035 Best vali loss: 0.3158983
	iters: 100, epoch: 4 | loss: 0.5693153
	speed: 0.0097s/iter; left time: 11.7597s
	iters: 200, epoch: 4 | loss: 0.8007548
	speed: 0.0046s/iter; left time: 5.1408s
Updating learning rate to 0.0008629982953
Epoch: 4 cost time: 1.2426726818084717
Epoch: 4, Steps: 262 | Train Loss: 0.6850351 Vali Loss: 0.3243195 Best vali loss: 0.3158983
	iters: 100, epoch: 5 | loss: 0.8074380
	speed: 0.0100s/iter; left time: 9.4723s
	iters: 200, epoch: 5 | loss: 0.3554147
	speed: 0.0045s/iter; left time: 3.8336s
Updating learning rate to 0.0005327431455293747
Epoch: 5 cost time: 1.2291381359100342
Epoch: 5, Steps: 262 | Train Loss: 0.5814263 Vali Loss: 0.3238810 Best vali loss: 0.3158983
	iters: 100, epoch: 6 | loss: 0.6337871
	speed: 0.0094s/iter; left time: 6.4523s
	iters: 200, epoch: 6 | loss: 0.7831592
	speed: 0.0040s/iter; left time: 2.3209s
Updating learning rate to 0.0002527663485409394
Epoch: 6 cost time: 1.0879442691802979
Epoch: 6, Steps: 262 | Train Loss: 0.7084731 Vali Loss: 0.3210871 Best vali loss: 0.3158983
	iters: 100, epoch: 7 | loss: 0.4655222
	speed: 0.0089s/iter; left time: 3.7919s
	iters: 200, epoch: 7 | loss: 0.6509339
	speed: 0.0040s/iter; left time: 1.3036s
Updating learning rate to 6.569183368019861e-05
Epoch: 7 cost time: 1.0960166454315186
Epoch: 7, Steps: 262 | Train Loss: 0.5582281 Vali Loss: 0.3227333 Best vali loss: 0.3158983
	iters: 100, epoch: 8 | loss: 0.6036257
	speed: 0.0088s/iter; left time: 1.4346s
	iters: 200, epoch: 8 | loss: 0.4247418
	speed: 0.0045s/iter; left time: 0.2846s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.180454969406128
Epoch: 8, Steps: 262 | Train Loss: 0.5141838 Vali Loss: 0.3223881 Best vali loss: 0.3158983

best validation loss 0.315898287746267

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0095342903622, 'e_layers': 2, 'learning_rate': 0.0004770523146, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5488761
	speed: 0.0094s/iter; left time: 8.8745s
Updating learning rate to 0.0004588955919980377
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 0.8827915191650391
Epoch: 1, Steps: 131 | Train Loss: 0.5488761 Vali Loss: 0.2864121 Best vali loss: 0.2864121
	iters: 100, epoch: 2 | loss: 0.6613575
	speed: 0.0083s/iter; left time: 6.7744s
Updating learning rate to 0.0004071896206171991
Validation loss decreased (0.2864 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 0.64501953125
Epoch: 2, Steps: 131 | Train Loss: 0.6613575 Vali Loss: 0.2827936 Best vali loss: 0.2827936
	iters: 100, epoch: 3 | loss: 0.3163233
	speed: 0.0083s/iter; left time: 5.7059s
Updating learning rate to 0.00032980616588441935
Epoch: 3 cost time: 0.6405768394470215
Epoch: 3, Steps: 131 | Train Loss: 0.3163233 Vali Loss: 0.2859986 Best vali loss: 0.2827936
	iters: 100, epoch: 4 | loss: 0.5194788
	speed: 0.0081s/iter; left time: 4.4956s
Updating learning rate to 0.0002385261573
Epoch: 4 cost time: 0.6527137756347656
Epoch: 4, Steps: 131 | Train Loss: 0.5194788 Vali Loss: 0.2862378 Best vali loss: 0.2827936
	iters: 100, epoch: 5 | loss: 0.5427196
	speed: 0.0080s/iter; left time: 3.4188s
Updating learning rate to 0.0001472461487155807
Epoch: 5 cost time: 0.6368670463562012
Epoch: 5, Steps: 131 | Train Loss: 0.5427196 Vali Loss: 0.2981734 Best vali loss: 0.2827936
	iters: 100, epoch: 6 | loss: 0.4174626
	speed: 0.0081s/iter; left time: 2.3691s
Updating learning rate to 6.98626939828009e-05
Epoch: 6 cost time: 0.6429831981658936
Epoch: 6, Steps: 131 | Train Loss: 0.4174626 Vali Loss: 0.3029688 Best vali loss: 0.2827936
	iters: 100, epoch: 7 | loss: 0.3751929
	speed: 0.0080s/iter; left time: 1.3062s
Updating learning rate to 1.8156722601962357e-05
Epoch: 7 cost time: 0.6391510963439941
Epoch: 7, Steps: 131 | Train Loss: 0.3751929 Vali Loss: 0.3097289 Best vali loss: 0.2827936
	iters: 100, epoch: 8 | loss: 0.2240043
	speed: 0.0081s/iter; left time: 0.2592s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6415178775787354
Epoch: 8, Steps: 131 | Train Loss: 0.2240043 Vali Loss: 0.3091885 Best vali loss: 0.2827936

best validation loss 0.2827935892161759

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0038102083931, 'e_layers': 4, 'learning_rate': 9.0694625e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4590709
	speed: 0.0110s/iter; left time: 22.0637s
	iters: 200, epoch: 1 | loss: 0.6579985
	speed: 0.0056s/iter; left time: 10.6074s
Updating learning rate to 8.724276637314324e-05
Validation loss decreased (inf --> 0.2780).  Saving model state dict ...
Epoch: 1 cost time: 1.739995002746582
Epoch: 1, Steps: 262 | Train Loss: 0.5585347 Vali Loss: 0.2779693 Best vali loss: 0.2779693
	iters: 100, epoch: 2 | loss: 0.4056792
	speed: 0.0121s/iter; left time: 20.9445s
	iters: 200, epoch: 2 | loss: 0.3874823
	speed: 0.0053s/iter; left time: 8.6142s
Updating learning rate to 7.74127046773355e-05
Epoch: 2 cost time: 1.4309988021850586
Epoch: 2, Steps: 262 | Train Loss: 0.3965807 Vali Loss: 0.2780903 Best vali loss: 0.2779693
	iters: 100, epoch: 3 | loss: 0.4078956
	speed: 0.0114s/iter; left time: 16.8551s
	iters: 200, epoch: 3 | loss: 0.4971333
	speed: 0.0052s/iter; left time: 7.1571s
Updating learning rate to 6.270097769603235e-05
Epoch: 3 cost time: 1.4146735668182373
Epoch: 3, Steps: 262 | Train Loss: 0.4525145 Vali Loss: 0.2879399 Best vali loss: 0.2779693

best validation loss 0.27796931014534443

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0118099661071, 'e_layers': 2, 'learning_rate': 0.0004808046649, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5493314
	speed: 0.0101s/iter; left time: 9.5979s
Updating learning rate to 0.00046250512696852894
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 0.8740866184234619
Epoch: 1, Steps: 131 | Train Loss: 0.5493314 Vali Loss: 0.2857685 Best vali loss: 0.2857685
	iters: 100, epoch: 2 | loss: 0.6767287
	speed: 0.0083s/iter; left time: 6.8163s
Updating learning rate to 0.0004103924519384578
Validation loss decreased (0.2858 --> 0.2786).  Saving model state dict ...
Epoch: 2 cost time: 0.6457898616790771
Epoch: 2, Steps: 131 | Train Loss: 0.6767287 Vali Loss: 0.2786221 Best vali loss: 0.2786221
	iters: 100, epoch: 3 | loss: 0.3332957
	speed: 0.0084s/iter; left time: 5.7498s
Updating learning rate to 0.0003324003221805394
Epoch: 3 cost time: 0.645338773727417
Epoch: 3, Steps: 131 | Train Loss: 0.3332957 Vali Loss: 0.2827956 Best vali loss: 0.2786221

best validation loss 0.27862210853275376

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047246276457, 'e_layers': 3, 'learning_rate': 0.0004750451412, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4287688
	speed: 0.0125s/iter; left time: 11.8781s
Updating learning rate to 0.0004569648120868071
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 1.200129508972168
Epoch: 1, Steps: 131 | Train Loss: 0.4287688 Vali Loss: 0.2852098 Best vali loss: 0.2852098
	iters: 100, epoch: 2 | loss: 0.7985966
	speed: 0.0119s/iter; left time: 9.7243s
Updating learning rate to 0.00040547639095612044
Validation loss decreased (0.2852 --> 0.2783).  Saving model state dict ...
Epoch: 2 cost time: 0.9606797695159912
Epoch: 2, Steps: 131 | Train Loss: 0.7985966 Vali Loss: 0.2783412 Best vali loss: 0.2783412
	iters: 100, epoch: 3 | loss: 0.3487981
	speed: 0.0120s/iter; left time: 8.2433s
Updating learning rate to 0.00032841852318138734
Epoch: 3 cost time: 0.9602377414703369
Epoch: 3, Steps: 131 | Train Loss: 0.3487981 Vali Loss: 0.2798973 Best vali loss: 0.2783412

best validation loss 0.27834115889201866

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0038102083931, 'e_layers': 4, 'learning_rate': 9.0694625e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2984825
	speed: 0.0113s/iter; left time: 13.6819s
	iters: 200, epoch: 4 | loss: 0.5153487
	speed: 0.0057s/iter; left time: 6.3689s
Updating learning rate to 4.53473125e-05
Epoch: 4 cost time: 1.761721134185791
Epoch: 4, Steps: 262 | Train Loss: 0.4069156 Vali Loss: 0.2964579 Best vali loss: 0.2779693
	iters: 100, epoch: 5 | loss: 0.3718822
	speed: 0.0118s/iter; left time: 11.2424s
	iters: 200, epoch: 5 | loss: 0.3519470
	speed: 0.0052s/iter; left time: 4.4549s
Updating learning rate to 2.7993647303967664e-05
Epoch: 5 cost time: 1.430687665939331
Epoch: 5, Steps: 262 | Train Loss: 0.3619146 Vali Loss: 0.3016498 Best vali loss: 0.2779693
	iters: 100, epoch: 6 | loss: 0.3700927
	speed: 0.0113s/iter; left time: 7.7866s
	iters: 200, epoch: 6 | loss: 0.4240029
	speed: 0.0052s/iter; left time: 3.0485s
Updating learning rate to 1.3281920322664513e-05
Epoch: 6 cost time: 1.412487268447876
Epoch: 6, Steps: 262 | Train Loss: 0.3970478 Vali Loss: 0.2979937 Best vali loss: 0.2779693
	iters: 100, epoch: 7 | loss: 0.5359237
	speed: 0.0116s/iter; left time: 4.9373s
	iters: 200, epoch: 7 | loss: 0.4768961
	speed: 0.0053s/iter; left time: 1.7289s
Updating learning rate to 3.451858626856771e-06
Epoch: 7 cost time: 1.4307563304901123
Epoch: 7, Steps: 262 | Train Loss: 0.5064099 Vali Loss: 0.3037831 Best vali loss: 0.2779693
	iters: 100, epoch: 8 | loss: 0.3495785
	speed: 0.0115s/iter; left time: 1.8769s
	iters: 200, epoch: 8 | loss: 0.2254834
	speed: 0.0053s/iter; left time: 0.3309s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4317667484283447
Epoch: 8, Steps: 262 | Train Loss: 0.2875310 Vali Loss: 0.3038632 Best vali loss: 0.2779693

best validation loss 0.27796931014534443

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0059885243152, 'e_layers': 3, 'learning_rate': 0.0004752717529, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4367981
	speed: 0.0122s/iter; left time: 11.5361s
Updating learning rate to 0.0004571827988925359
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 1.1459476947784424
Epoch: 1, Steps: 131 | Train Loss: 0.4367981 Vali Loss: 0.2781836 Best vali loss: 0.2781836
	iters: 100, epoch: 2 | loss: 0.4905485
	speed: 0.0113s/iter; left time: 9.2469s
Updating learning rate to 0.00040566981614100357
Epoch: 2 cost time: 0.9171974658966064
Epoch: 2, Steps: 131 | Train Loss: 0.4905485 Vali Loss: 0.2805050 Best vali loss: 0.2781836
	iters: 100, epoch: 3 | loss: 0.4550412
	speed: 0.0110s/iter; left time: 7.5653s
Updating learning rate to 0.0003285751893029724
Validation loss decreased (0.2782 --> 0.2763).  Saving model state dict ...
Epoch: 3 cost time: 0.918471097946167
Epoch: 3, Steps: 131 | Train Loss: 0.4550412 Vali Loss: 0.2762716 Best vali loss: 0.2762716
	iters: 100, epoch: 4 | loss: 0.5599737
	speed: 0.0116s/iter; left time: 6.4481s
Updating learning rate to 0.00023763587645
Epoch: 4 cost time: 0.9327924251556396
Epoch: 4, Steps: 131 | Train Loss: 0.5599737 Vali Loss: 0.2788270 Best vali loss: 0.2762716
	iters: 100, epoch: 5 | loss: 0.3481579
	speed: 0.0112s/iter; left time: 4.7466s
Updating learning rate to 0.0001466965635970276
Epoch: 5 cost time: 0.9161221981048584
Epoch: 5, Steps: 131 | Train Loss: 0.3481579 Vali Loss: 0.2874453 Best vali loss: 0.2762716
	iters: 100, epoch: 6 | loss: 0.2640463
	speed: 0.0112s/iter; left time: 3.2830s
Updating learning rate to 6.960193675899642e-05
Epoch: 6 cost time: 0.9269504547119141
Epoch: 6, Steps: 131 | Train Loss: 0.2640463 Vali Loss: 0.2902533 Best vali loss: 0.2762716
	iters: 100, epoch: 7 | loss: 0.4386427
	speed: 0.0111s/iter; left time: 1.8097s
Updating learning rate to 1.8088954007464105e-05
Epoch: 7 cost time: 0.9198110103607178
Epoch: 7, Steps: 131 | Train Loss: 0.4386427 Vali Loss: 0.2983942 Best vali loss: 0.2762716
	iters: 100, epoch: 8 | loss: 0.2398131
	speed: 0.0112s/iter; left time: 0.3583s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9343447685241699
Epoch: 8, Steps: 131 | Train Loss: 0.2398131 Vali Loss: 0.3042065 Best vali loss: 0.2762716

best validation loss 0.2762715860165021

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0060245578937, 'e_layers': 3, 'learning_rate': 0.000475241346, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00045715354928625734
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 1.0322659015655518
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2845668 Best vali loss: 0.2845668
Updating learning rate to 0.0004056438622284112
Epoch: 2 cost time: 0.8199713230133057
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2919781 Best vali loss: 0.2845668
Updating learning rate to 0.00032855416774454265
Epoch: 3 cost time: 0.8191432952880859
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2856736 Best vali loss: 0.2845668
Updating learning rate to 0.000237620673
Validation loss decreased (0.2846 --> 0.2839).  Saving model state dict ...
Epoch: 4 cost time: 0.8110406398773193
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2839287 Best vali loss: 0.2839287
Updating learning rate to 0.0001466871782554574
Epoch: 5 cost time: 0.8180351257324219
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2877426 Best vali loss: 0.2839287
Updating learning rate to 6.959748377158886e-05
Epoch: 6 cost time: 0.8086979389190674
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2982941 Best vali loss: 0.2839287
Updating learning rate to 1.8087796713742666e-05
Epoch: 7 cost time: 0.8186371326446533
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3024154 Best vali loss: 0.2839287
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8144338130950928
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3069908 Best vali loss: 0.2839287

best validation loss 0.28392872042530043

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019937966108, 'e_layers': 2, 'learning_rate': 0.0012065427391, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5858976
	speed: 0.0102s/iter; left time: 9.7116s
Updating learning rate to 0.0012065427391
Validation loss decreased (inf --> 0.2993).  Saving model state dict ...
Epoch: 1 cost time: 0.8896615505218506
Epoch: 1, Steps: 131 | Train Loss: 0.5858976 Vali Loss: 0.2993290 Best vali loss: 0.2993290
	iters: 100, epoch: 2 | loss: 0.4014029
	speed: 0.0085s/iter; left time: 6.9431s
Updating learning rate to 0.00060327136955
Validation loss decreased (0.2993 --> 0.2934).  Saving model state dict ...
Epoch: 2 cost time: 0.6572580337524414
Epoch: 2, Steps: 131 | Train Loss: 0.4014029 Vali Loss: 0.2934267 Best vali loss: 0.2934267
	iters: 100, epoch: 3 | loss: 0.7062122
	speed: 0.0086s/iter; left time: 5.9243s
Updating learning rate to 0.000301635684775
Validation loss decreased (0.2934 --> 0.2934).  Saving model state dict ...
Epoch: 3 cost time: 0.6574583053588867
Epoch: 3, Steps: 131 | Train Loss: 0.7062122 Vali Loss: 0.2933869 Best vali loss: 0.2933869

best validation loss 0.2933868575812095

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0073688103364, 'e_layers': 4, 'learning_rate': 0.0004813098903, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3010524
	speed: 0.0117s/iter; left time: 23.2722s
	iters: 200, epoch: 1 | loss: 0.2888709
	speed: 0.0063s/iter; left time: 12.0259s
Updating learning rate to 0.00046299112337171134
Validation loss decreased (inf --> 0.3243).  Saving model state dict ...
Epoch: 1 cost time: 1.9173343181610107
Epoch: 1, Steps: 262 | Train Loss: 0.2949616 Vali Loss: 0.3243392 Best vali loss: 0.3243392
	iters: 100, epoch: 2 | loss: 0.5495340
	speed: 0.0136s/iter; left time: 23.6105s
	iters: 200, epoch: 2 | loss: 0.7609482
	speed: 0.0062s/iter; left time: 10.1931s
Updating learning rate to 0.0004108236887916416
Validation loss decreased (0.3243 --> 0.2977).  Saving model state dict ...
Epoch: 2 cost time: 1.6756839752197266
Epoch: 2, Steps: 262 | Train Loss: 0.6552411 Vali Loss: 0.2976565 Best vali loss: 0.2976565
	iters: 100, epoch: 3 | loss: 0.5864410
	speed: 0.0140s/iter; left time: 20.5847s
	iters: 200, epoch: 3 | loss: 0.6719273
	speed: 0.0063s/iter; left time: 8.6811s
Updating learning rate to 0.0003327496055756344
Epoch: 3 cost time: 1.6934480667114258
Epoch: 3, Steps: 262 | Train Loss: 0.6291842 Vali Loss: 0.3070311 Best vali loss: 0.2976565

best validation loss 0.29765650264810745

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014443206954, 'e_layers': 4, 'learning_rate': 0.0001732433542, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001732433542
Validation loss decreased (inf --> 0.3124).  Saving model state dict ...
Epoch: 1 cost time: 0.6847665309906006
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3123881 Best vali loss: 0.3123881
Updating learning rate to 8.66216771e-05
Validation loss decreased (0.3124 --> 0.2944).  Saving model state dict ...
Epoch: 2 cost time: 0.43958210945129395
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2943712 Best vali loss: 0.2943712
Updating learning rate to 4.331083855e-05
Validation loss decreased (0.2944 --> 0.2881).  Saving model state dict ...
Epoch: 3 cost time: 0.4508671760559082
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2881222 Best vali loss: 0.2881222

best validation loss 0.2881222414167985

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014443206954, 'e_layers': 4, 'learning_rate': 0.0001732433542, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.1655419275e-05
Validation loss decreased (0.2881 --> 0.2870).  Saving model state dict ...
Epoch: 4 cost time: 0.6729567050933838
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2869586 Best vali loss: 0.2869586
Updating learning rate to 1.08277096375e-05
Validation loss decreased (0.2870 --> 0.2862).  Saving model state dict ...
Epoch: 5 cost time: 0.4482133388519287
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2861859 Best vali loss: 0.2861859
Updating learning rate to 5.41385481875e-06
Validation loss decreased (0.2862 --> 0.2858).  Saving model state dict ...
Epoch: 6 cost time: 0.5239520072937012
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2858272 Best vali loss: 0.2858272
Updating learning rate to 2.706927409375e-06
Validation loss decreased (0.2858 --> 0.2856).  Saving model state dict ...
Epoch: 7 cost time: 0.39699411392211914
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2856284 Best vali loss: 0.2856284
Updating learning rate to 1.3534637046875e-06
Validation loss decreased (0.2856 --> 0.2856).  Saving model state dict ...
Epoch: 8 cost time: 0.4186429977416992
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2855670 Best vali loss: 0.2855670

best validation loss 0.28556696085869576

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0075761804579, 'e_layers': 4, 'learning_rate': 0.0004810608213, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3015512
	speed: 0.0118s/iter; left time: 23.4888s
	iters: 200, epoch: 1 | loss: 0.2801885
	speed: 0.0064s/iter; left time: 12.0913s
Updating learning rate to 0.0004627515339960698
Validation loss decreased (inf --> 0.3041).  Saving model state dict ...
Epoch: 1 cost time: 1.9420106410980225
Epoch: 1, Steps: 262 | Train Loss: 0.2908699 Vali Loss: 0.3041108 Best vali loss: 0.3041108
	iters: 100, epoch: 2 | loss: 0.5429955
	speed: 0.0136s/iter; left time: 23.6519s
	iters: 200, epoch: 2 | loss: 0.7807788
	speed: 0.0063s/iter; left time: 10.3678s
Updating learning rate to 0.00041061109510219995
Epoch: 2 cost time: 1.681473970413208
Epoch: 2, Steps: 262 | Train Loss: 0.6618871 Vali Loss: 0.3173668 Best vali loss: 0.3041108
	iters: 100, epoch: 3 | loss: 0.5754640
	speed: 0.0133s/iter; left time: 19.6627s
	iters: 200, epoch: 3 | loss: 0.7109028
	speed: 0.0062s/iter; left time: 8.5416s
Updating learning rate to 0.0003325774137857266
Epoch: 3 cost time: 1.667679786682129
Epoch: 3, Steps: 262 | Train Loss: 0.6431834 Vali Loss: 0.3124728 Best vali loss: 0.3041108
	iters: 100, epoch: 4 | loss: 0.5744553
	speed: 0.0132s/iter; left time: 16.0349s
	iters: 200, epoch: 4 | loss: 0.5872149
	speed: 0.0063s/iter; left time: 7.0078s
Updating learning rate to 0.00024053041065
Epoch: 4 cost time: 1.6986331939697266
Epoch: 4, Steps: 262 | Train Loss: 0.5808351 Vali Loss: 0.3127894 Best vali loss: 0.3041108
	iters: 100, epoch: 5 | loss: 0.3152626
	speed: 0.0136s/iter; left time: 12.9480s
	iters: 200, epoch: 5 | loss: 0.4274643
	speed: 0.0062s/iter; left time: 5.2967s
Updating learning rate to 0.00014848340751427347
Epoch: 5 cost time: 1.684281826019287
Epoch: 5, Steps: 262 | Train Loss: 0.3713634 Vali Loss: 0.3100156 Best vali loss: 0.3041108
	iters: 100, epoch: 6 | loss: 0.4440778
	speed: 0.0133s/iter; left time: 9.1163s
	iters: 200, epoch: 6 | loss: 0.5873070
	speed: 0.0063s/iter; left time: 3.7035s
Updating learning rate to 7.044972619780004e-05
Epoch: 6 cost time: 1.6854383945465088
Epoch: 6, Steps: 262 | Train Loss: 0.5156924 Vali Loss: 0.3060115 Best vali loss: 0.3041108
	iters: 100, epoch: 7 | loss: 0.6406609
	speed: 0.0133s/iter; left time: 5.6469s
	iters: 200, epoch: 7 | loss: 0.3982169
	speed: 0.0063s/iter; left time: 2.0363s
Updating learning rate to 1.8309287303930176e-05
Epoch: 7 cost time: 1.674673080444336
Epoch: 7, Steps: 262 | Train Loss: 0.5194389 Vali Loss: 0.3087439 Best vali loss: 0.3041108
	iters: 100, epoch: 8 | loss: 0.3554363
	speed: 0.0134s/iter; left time: 2.1812s
	iters: 200, epoch: 8 | loss: 0.3835771
	speed: 0.0063s/iter; left time: 0.3977s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6910450458526611
Epoch: 8, Steps: 262 | Train Loss: 0.3695067 Vali Loss: 0.3069538 Best vali loss: 0.3041108

best validation loss 0.30411081609006885

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0074416260117, 'e_layers': 4, 'learning_rate': 0.0004712650959, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00045332863619448936
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 1.0145108699798584
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2782144 Best vali loss: 0.2782144
Updating learning rate to 0.00040224992047370933
Epoch: 2 cost time: 0.7761726379394531
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2907719 Best vali loss: 0.2782144
Updating learning rate to 0.00032580522017643766
Epoch: 3 cost time: 0.7857844829559326
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3021968 Best vali loss: 0.2782144
Updating learning rate to 0.00023563254795
Epoch: 4 cost time: 0.771416187286377
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3080478 Best vali loss: 0.2782144
Updating learning rate to 0.00014545987572356242
Epoch: 5 cost time: 0.7820003032684326
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3085440 Best vali loss: 0.2782144
Updating learning rate to 6.90151754262907e-05
Epoch: 6 cost time: 0.7787222862243652
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3173299 Best vali loss: 0.2782144
Updating learning rate to 1.7936459705510643e-05
Epoch: 7 cost time: 0.7897706031799316
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3294143 Best vali loss: 0.2782144
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7756290435791016
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3306089 Best vali loss: 0.2782144

best validation loss 0.2782144204153364

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0064450228841, 'e_layers': 3, 'learning_rate': 0.0035766541097, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5478086
	speed: 0.0126s/iter; left time: 11.9912s
Updating learning rate to 0.0035766541097
Validation loss decreased (inf --> 0.3367).  Saving model state dict ...
Epoch: 1 cost time: 1.2389867305755615
Epoch: 1, Steps: 131 | Train Loss: 0.5478086 Vali Loss: 0.3367076 Best vali loss: 0.3367076
	iters: 100, epoch: 2 | loss: 0.5628036
	speed: 0.0124s/iter; left time: 10.1774s
Updating learning rate to 0.00178832705485
Validation loss decreased (0.3367 --> 0.3224).  Saving model state dict ...
Epoch: 2 cost time: 1.0109527111053467
Epoch: 2, Steps: 131 | Train Loss: 0.5628036 Vali Loss: 0.3224224 Best vali loss: 0.3224224
	iters: 100, epoch: 3 | loss: 0.6762914
	speed: 0.0125s/iter; left time: 8.6114s
Updating learning rate to 0.000894163527425
Epoch: 3 cost time: 1.0052824020385742
Epoch: 3, Steps: 131 | Train Loss: 0.6762914 Vali Loss: 0.3245443 Best vali loss: 0.3224224

best validation loss 0.3224223678042872

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6367028
	speed: 0.0105s/iter; left time: 9.9403s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 0.9431965351104736
Epoch: 1, Steps: 131 | Train Loss: 0.6367028 Vali Loss: 0.2797896 Best vali loss: 0.2797896
	iters: 100, epoch: 2 | loss: 0.4002717
	speed: 0.0091s/iter; left time: 7.4300s
Updating learning rate to 0.0001172634806
Epoch: 2 cost time: 0.7145493030548096
Epoch: 2, Steps: 131 | Train Loss: 0.4002717 Vali Loss: 0.2819240 Best vali loss: 0.2797896
	iters: 100, epoch: 3 | loss: 0.7466203
	speed: 0.0087s/iter; left time: 5.9673s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7043700218200684
Epoch: 3, Steps: 131 | Train Loss: 0.7466203 Vali Loss: 0.2850465 Best vali loss: 0.2797896

best validation loss 0.2797896207797567

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030037455001, 'e_layers': 3, 'learning_rate': 0.0004689508825, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5209992
	speed: 0.0120s/iter; left time: 11.3463s
Updating learning rate to 0.0004689508825
Validation loss decreased (inf --> 0.2695).  Saving model state dict ...
Epoch: 1 cost time: 1.1429150104522705
Epoch: 1, Steps: 131 | Train Loss: 0.5209992 Vali Loss: 0.2694524 Best vali loss: 0.2694524
	iters: 100, epoch: 2 | loss: 0.5731626
	speed: 0.0114s/iter; left time: 9.3147s
Updating learning rate to 0.00023447544125
Epoch: 2 cost time: 0.9216687679290771
Epoch: 2, Steps: 131 | Train Loss: 0.5731626 Vali Loss: 0.2816200 Best vali loss: 0.2694524
	iters: 100, epoch: 3 | loss: 0.5203249
	speed: 0.0112s/iter; left time: 7.6892s
Updating learning rate to 0.000117237720625
Epoch: 3 cost time: 0.9098103046417236
Epoch: 3, Steps: 131 | Train Loss: 0.5203249 Vali Loss: 0.2841626 Best vali loss: 0.2694524

best validation loss 0.26945244844250626

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030037455001, 'e_layers': 3, 'learning_rate': 0.0004689508825, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3277807
	speed: 0.0124s/iter; left time: 6.9127s
Updating learning rate to 5.86188603125e-05
Epoch: 4 cost time: 1.1562376022338867
Epoch: 4, Steps: 131 | Train Loss: 0.3277807 Vali Loss: 0.2837324 Best vali loss: 0.2694524
	iters: 100, epoch: 5 | loss: 0.3373191
	speed: 0.0112s/iter; left time: 4.7640s
Updating learning rate to 2.930943015625e-05
Epoch: 5 cost time: 0.9156525135040283
Epoch: 5, Steps: 131 | Train Loss: 0.3373191 Vali Loss: 0.2823504 Best vali loss: 0.2694524
	iters: 100, epoch: 6 | loss: 0.3728533
	speed: 0.0111s/iter; left time: 3.2539s
Updating learning rate to 1.4654715078125e-05
Epoch: 6 cost time: 0.9109702110290527
Epoch: 6, Steps: 131 | Train Loss: 0.3728533 Vali Loss: 0.2963435 Best vali loss: 0.2694524
	iters: 100, epoch: 7 | loss: 0.2924296
	speed: 0.0112s/iter; left time: 1.8178s
Updating learning rate to 7.3273575390625e-06
Epoch: 7 cost time: 0.925513744354248
Epoch: 7, Steps: 131 | Train Loss: 0.2924296 Vali Loss: 0.2925778 Best vali loss: 0.2694524
	iters: 100, epoch: 8 | loss: 0.3050532
	speed: 0.0113s/iter; left time: 0.3610s
Updating learning rate to 3.66367876953125e-06
Epoch: 8 cost time: 0.9163863658905029
Epoch: 8, Steps: 131 | Train Loss: 0.3050532 Vali Loss: 0.2950718 Best vali loss: 0.2694524

best validation loss 0.26945244844250626

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.001347394757, 'e_layers': 3, 'learning_rate': 0.0002624850326, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5971550
	speed: 0.0096s/iter; left time: 39.1961s
	iters: 200, epoch: 1 | loss: 0.3672022
	speed: 0.0044s/iter; left time: 17.4508s
	iters: 300, epoch: 1 | loss: 0.3362971
	speed: 0.0043s/iter; left time: 16.7877s
	iters: 400, epoch: 1 | loss: 0.4192178
	speed: 0.0044s/iter; left time: 16.5210s
	iters: 500, epoch: 1 | loss: 0.3790818
	speed: 0.0044s/iter; left time: 16.2883s
Updating learning rate to 0.0002524947909048489
Validation loss decreased (inf --> 0.2731).  Saving model state dict ...
Epoch: 1 cost time: 2.536653995513916
Epoch: 1, Steps: 523 | Train Loss: 0.4197908 Vali Loss: 0.2731197 Best vali loss: 0.2731197
	iters: 100, epoch: 2 | loss: 0.6614848
	speed: 0.0088s/iter; left time: 31.2042s
	iters: 200, epoch: 2 | loss: 0.6943710
	speed: 0.0043s/iter; left time: 14.9910s
	iters: 300, epoch: 2 | loss: 0.3678991
	speed: 0.0045s/iter; left time: 15.0292s
	iters: 400, epoch: 2 | loss: 0.5367395
	speed: 0.0045s/iter; left time: 14.5290s
	iters: 500, epoch: 2 | loss: 0.4197777
	speed: 0.0045s/iter; left time: 14.1194s
Updating learning rate to 0.00022404498955571597
Epoch: 2 cost time: 2.3242199420928955
Epoch: 2, Steps: 523 | Train Loss: 0.5360544 Vali Loss: 0.2770508 Best vali loss: 0.2731197
	iters: 100, epoch: 3 | loss: 0.5898096
	speed: 0.0088s/iter; left time: 26.8761s
	iters: 200, epoch: 3 | loss: 0.4130174
	speed: 0.0044s/iter; left time: 12.9704s
	iters: 300, epoch: 3 | loss: 0.2881373
	speed: 0.0044s/iter; left time: 12.4545s
	iters: 400, epoch: 3 | loss: 0.3821730
	speed: 0.0043s/iter; left time: 11.7988s
	iters: 500, epoch: 3 | loss: 0.2533065
	speed: 0.0040s/iter; left time: 10.5524s
Updating learning rate to 0.00018146685290991522
Epoch: 3 cost time: 2.273240327835083
Epoch: 3, Steps: 523 | Train Loss: 0.3852888 Vali Loss: 0.2834123 Best vali loss: 0.2731197
	iters: 100, epoch: 4 | loss: 0.6095546
	speed: 0.0089s/iter; left time: 22.3229s
	iters: 200, epoch: 4 | loss: 0.2212898
	speed: 0.0043s/iter; left time: 10.4958s
	iters: 300, epoch: 4 | loss: 0.2788816
	speed: 0.0043s/iter; left time: 10.0644s
	iters: 400, epoch: 4 | loss: 0.2953224
	speed: 0.0044s/iter; left time: 9.7684s
	iters: 500, epoch: 4 | loss: 0.3056627
	speed: 0.0044s/iter; left time: 9.3275s
Updating learning rate to 0.0001312425163
Epoch: 4 cost time: 2.3239622116088867
Epoch: 4, Steps: 523 | Train Loss: 0.3421422 Vali Loss: 0.2857430 Best vali loss: 0.2731197
	iters: 100, epoch: 5 | loss: 0.2268322
	speed: 0.0088s/iter; left time: 17.4475s
	iters: 200, epoch: 5 | loss: 0.4403844
	speed: 0.0043s/iter; left time: 8.1689s
	iters: 300, epoch: 5 | loss: 0.3248741
	speed: 0.0043s/iter; left time: 7.7899s
	iters: 400, epoch: 5 | loss: 0.2562860
	speed: 0.0044s/iter; left time: 7.5228s
	iters: 500, epoch: 5 | loss: 0.1731017
	speed: 0.0044s/iter; left time: 6.9421s
Updating learning rate to 8.101817969008475e-05
Epoch: 5 cost time: 2.305145502090454
Epoch: 5, Steps: 523 | Train Loss: 0.2842957 Vali Loss: 0.2950330 Best vali loss: 0.2731197
	iters: 100, epoch: 6 | loss: 0.2746089
	speed: 0.0088s/iter; left time: 12.9729s
	iters: 200, epoch: 6 | loss: 0.2102345
	speed: 0.0044s/iter; left time: 6.0906s
	iters: 300, epoch: 6 | loss: 0.3947129
	speed: 0.0044s/iter; left time: 5.5728s
	iters: 400, epoch: 6 | loss: 0.2186325
	speed: 0.0045s/iter; left time: 5.2159s
	iters: 500, epoch: 6 | loss: 0.2272420
	speed: 0.0040s/iter; left time: 4.2887s
Updating learning rate to 3.844004304428401e-05
Epoch: 6 cost time: 2.294538974761963
Epoch: 6, Steps: 523 | Train Loss: 0.2650862 Vali Loss: 0.3116017 Best vali loss: 0.2731197
	iters: 100, epoch: 7 | loss: 0.1737541
	speed: 0.0088s/iter; left time: 8.3629s
	iters: 200, epoch: 7 | loss: 0.2056072
	speed: 0.0043s/iter; left time: 3.6691s
	iters: 300, epoch: 7 | loss: 0.2195870
	speed: 0.0044s/iter; left time: 3.2719s
	iters: 400, epoch: 7 | loss: 0.1903962
	speed: 0.0044s/iter; left time: 2.8563s
	iters: 500, epoch: 7 | loss: 0.2508713
	speed: 0.0044s/iter; left time: 2.3801s
Updating learning rate to 9.99024169515107e-06
Epoch: 7 cost time: 2.3153789043426514
Epoch: 7, Steps: 523 | Train Loss: 0.2080432 Vali Loss: 0.3123669 Best vali loss: 0.2731197
	iters: 100, epoch: 8 | loss: 0.1530209
	speed: 0.0087s/iter; left time: 3.6757s
	iters: 200, epoch: 8 | loss: 0.2491009
	speed: 0.0041s/iter; left time: 1.3213s
	iters: 300, epoch: 8 | loss: 0.3796311
	speed: 0.0041s/iter; left time: 0.9177s
	iters: 400, epoch: 8 | loss: 0.2559022
	speed: 0.0041s/iter; left time: 0.5049s
	iters: 500, epoch: 8 | loss: 0.3256992
	speed: 0.0041s/iter; left time: 0.0981s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1769444942474365
Epoch: 8, Steps: 523 | Train Loss: 0.2726709 Vali Loss: 0.3149840 Best vali loss: 0.2731197

best validation loss 0.27311968824186483

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345067337, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6366983
	speed: 0.0103s/iter; left time: 9.8148s
Updating learning rate to 0.0002345067337
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 0.926349401473999
Epoch: 1, Steps: 131 | Train Loss: 0.6366983 Vali Loss: 0.2797996 Best vali loss: 0.2797996
	iters: 100, epoch: 2 | loss: 0.3943277
	speed: 0.0090s/iter; left time: 7.3366s
Updating learning rate to 0.00011725336685
Epoch: 2 cost time: 0.7134609222412109
Epoch: 2, Steps: 131 | Train Loss: 0.3943277 Vali Loss: 0.2827519 Best vali loss: 0.2797996
	iters: 100, epoch: 3 | loss: 0.7433141
	speed: 0.0086s/iter; left time: 5.9228s
Updating learning rate to 5.8626683425e-05
Epoch: 3 cost time: 0.7016232013702393
Epoch: 3, Steps: 131 | Train Loss: 0.7433141 Vali Loss: 0.2831725 Best vali loss: 0.2797996
	iters: 100, epoch: 4 | loss: 0.4907636
	speed: 0.0088s/iter; left time: 4.8712s
Updating learning rate to 2.93133417125e-05
Epoch: 4 cost time: 0.7068212032318115
Epoch: 4, Steps: 131 | Train Loss: 0.4907636 Vali Loss: 0.3126073 Best vali loss: 0.2797996
	iters: 100, epoch: 5 | loss: 0.3953638
	speed: 0.0087s/iter; left time: 3.7018s
Updating learning rate to 1.465667085625e-05
Epoch: 5 cost time: 0.7071044445037842
Epoch: 5, Steps: 131 | Train Loss: 0.3953638 Vali Loss: 0.3132569 Best vali loss: 0.2797996
	iters: 100, epoch: 6 | loss: 0.3703465
	speed: 0.0087s/iter; left time: 2.5591s
Updating learning rate to 7.328335428125e-06
Epoch: 6 cost time: 0.7065961360931396
Epoch: 6, Steps: 131 | Train Loss: 0.3703465 Vali Loss: 0.3038498 Best vali loss: 0.2797996
	iters: 100, epoch: 7 | loss: 0.3349234
	speed: 0.0087s/iter; left time: 1.4218s
Updating learning rate to 3.6641677140625e-06
Epoch: 7 cost time: 0.7121865749359131
Epoch: 7, Steps: 131 | Train Loss: 0.3349234 Vali Loss: 0.3026121 Best vali loss: 0.2797996
	iters: 100, epoch: 8 | loss: 0.3402911
	speed: 0.0088s/iter; left time: 0.2801s
Updating learning rate to 1.83208385703125e-06
Epoch: 8 cost time: 0.7057721614837646
Epoch: 8, Steps: 131 | Train Loss: 0.3402911 Vali Loss: 0.3009579 Best vali loss: 0.2797996

best validation loss 0.2797996040368532

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270163229, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7634003
	speed: 0.0089s/iter; left time: 36.1555s
	iters: 200, epoch: 1 | loss: 0.4921808
	speed: 0.0035s/iter; left time: 14.1083s
	iters: 300, epoch: 1 | loss: 0.7027397
	speed: 0.0035s/iter; left time: 13.6902s
	iters: 400, epoch: 1 | loss: 0.6618288
	speed: 0.0035s/iter; left time: 13.2659s
	iters: 500, epoch: 1 | loss: 0.4262041
	speed: 0.0035s/iter; left time: 12.9849s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.3029).  Saving model state dict ...
Epoch: 1 cost time: 2.1091878414154053
Epoch: 1, Steps: 523 | Train Loss: 0.6092707 Vali Loss: 0.3029413 Best vali loss: 0.3029413
	iters: 100, epoch: 2 | loss: 0.3342353
	speed: 0.0081s/iter; left time: 28.9030s
	iters: 200, epoch: 2 | loss: 0.5835950
	speed: 0.0034s/iter; left time: 11.6159s
	iters: 300, epoch: 2 | loss: 0.2659121
	speed: 0.0033s/iter; left time: 11.2559s
	iters: 400, epoch: 2 | loss: 0.2959126
	speed: 0.0034s/iter; left time: 11.0308s
	iters: 500, epoch: 2 | loss: 0.4805759
	speed: 0.0033s/iter; left time: 10.5470s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.3029 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 1.8195295333862305
Epoch: 2, Steps: 523 | Train Loss: 0.3920462 Vali Loss: 0.2808326 Best vali loss: 0.2808326
	iters: 100, epoch: 3 | loss: 0.4232666
	speed: 0.0073s/iter; left time: 22.2448s
	iters: 200, epoch: 3 | loss: 0.2470868
	speed: 0.0032s/iter; left time: 9.4953s
	iters: 300, epoch: 3 | loss: 0.2176273
	speed: 0.0033s/iter; left time: 9.2885s
	iters: 400, epoch: 3 | loss: 0.5963046
	speed: 0.0033s/iter; left time: 9.0210s
	iters: 500, epoch: 3 | loss: 0.3955803
	speed: 0.0033s/iter; left time: 8.6683s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.7171893119812012
Epoch: 3, Steps: 523 | Train Loss: 0.3759731 Vali Loss: 0.2858096 Best vali loss: 0.2808326

best validation loss 0.28083262376157536

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0034681014487, 'e_layers': 4, 'learning_rate': 0.0002050111741, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8893558
	speed: 0.0105s/iter; left time: 42.8623s
	iters: 200, epoch: 1 | loss: 0.3123104
	speed: 0.0051s/iter; left time: 20.3715s
	iters: 300, epoch: 1 | loss: 0.6430470
	speed: 0.0052s/iter; left time: 20.1250s
	iters: 400, epoch: 1 | loss: 0.2540827
	speed: 0.0052s/iter; left time: 19.5640s
	iters: 500, epoch: 1 | loss: 1.0029272
	speed: 0.0052s/iter; left time: 19.1586s
Updating learning rate to 0.0002050111741
Validation loss decreased (inf --> 0.2880).  Saving model state dict ...
Epoch: 1 cost time: 2.9697437286376953
Epoch: 1, Steps: 523 | Train Loss: 0.6203446 Vali Loss: 0.2879526 Best vali loss: 0.2879526
	iters: 100, epoch: 2 | loss: 0.4041103
	speed: 0.0103s/iter; left time: 36.5488s
	iters: 200, epoch: 2 | loss: 0.6739002
	speed: 0.0052s/iter; left time: 18.1106s
	iters: 300, epoch: 2 | loss: 0.7229915
	speed: 0.0051s/iter; left time: 17.1783s
	iters: 400, epoch: 2 | loss: 0.3665385
	speed: 0.0046s/iter; left time: 15.0063s
	iters: 500, epoch: 2 | loss: 0.3568267
	speed: 0.0046s/iter; left time: 14.5632s
Updating learning rate to 0.00010250558705
Validation loss decreased (0.2880 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 2.620281457901001
Epoch: 2, Steps: 523 | Train Loss: 0.5048735 Vali Loss: 0.2838530 Best vali loss: 0.2838530
	iters: 100, epoch: 3 | loss: 0.3214398
	speed: 0.0099s/iter; left time: 29.9918s
	iters: 200, epoch: 3 | loss: 0.5020705
	speed: 0.0049s/iter; left time: 14.3687s
	iters: 300, epoch: 3 | loss: 0.6444849
	speed: 0.0049s/iter; left time: 13.8755s
	iters: 400, epoch: 3 | loss: 0.6904546
	speed: 0.0049s/iter; left time: 13.3209s
	iters: 500, epoch: 3 | loss: 0.9650594
	speed: 0.0049s/iter; left time: 12.8202s
Updating learning rate to 5.1252793525e-05
Epoch: 3 cost time: 2.5869455337524414
Epoch: 3, Steps: 523 | Train Loss: 0.6247018 Vali Loss: 0.2860898 Best vali loss: 0.2838530

best validation loss 0.2838530116151726

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7634208
	speed: 0.0088s/iter; left time: 36.0669s
	iters: 200, epoch: 1 | loss: 0.4923020
	speed: 0.0035s/iter; left time: 13.9874s
	iters: 300, epoch: 1 | loss: 0.7022892
	speed: 0.0035s/iter; left time: 13.6290s
	iters: 400, epoch: 1 | loss: 0.6544111
	speed: 0.0035s/iter; left time: 13.2574s
	iters: 500, epoch: 1 | loss: 0.4267646
	speed: 0.0035s/iter; left time: 12.9267s
Updating learning rate to 0.0002345270279
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 2.099487066268921
Epoch: 1, Steps: 523 | Train Loss: 0.6078376 Vali Loss: 0.2855187 Best vali loss: 0.2855187
	iters: 100, epoch: 2 | loss: 0.3367270
	speed: 0.0080s/iter; left time: 28.3962s
	iters: 200, epoch: 2 | loss: 0.6225951
	speed: 0.0035s/iter; left time: 12.1833s
	iters: 300, epoch: 2 | loss: 0.2683086
	speed: 0.0035s/iter; left time: 11.8355s
	iters: 400, epoch: 2 | loss: 0.3039180
	speed: 0.0035s/iter; left time: 11.4135s
	iters: 500, epoch: 2 | loss: 0.4496998
	speed: 0.0035s/iter; left time: 11.1034s
Updating learning rate to 0.00011726351395
Validation loss decreased (0.2855 --> 0.2785).  Saving model state dict ...
Epoch: 2 cost time: 1.8827924728393555
Epoch: 2, Steps: 523 | Train Loss: 0.3962497 Vali Loss: 0.2784771 Best vali loss: 0.2784771
	iters: 100, epoch: 3 | loss: 0.4159178
	speed: 0.0079s/iter; left time: 24.1016s
	iters: 200, epoch: 3 | loss: 0.2816670
	speed: 0.0032s/iter; left time: 9.5310s
	iters: 300, epoch: 3 | loss: 0.2095559
	speed: 0.0033s/iter; left time: 9.4292s
	iters: 400, epoch: 3 | loss: 0.6738414
	speed: 0.0034s/iter; left time: 9.2154s
	iters: 500, epoch: 3 | loss: 0.3878987
	speed: 0.0033s/iter; left time: 8.7477s
Updating learning rate to 5.8631756975e-05
Epoch: 3 cost time: 1.7616443634033203
Epoch: 3, Steps: 523 | Train Loss: 0.3937762 Vali Loss: 0.2813376 Best vali loss: 0.2784771

best validation loss 0.278477105011768

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3389646
	speed: 0.0089s/iter; left time: 22.2715s
	iters: 200, epoch: 4 | loss: 0.4781350
	speed: 0.0034s/iter; left time: 8.2110s
	iters: 300, epoch: 4 | loss: 0.3864616
	speed: 0.0034s/iter; left time: 7.9376s
	iters: 400, epoch: 4 | loss: 0.5618963
	speed: 0.0034s/iter; left time: 7.6130s
	iters: 500, epoch: 4 | loss: 0.3792487
	speed: 0.0034s/iter; left time: 7.2493s
Updating learning rate to 2.93158784875e-05
Epoch: 4 cost time: 2.0466253757476807
Epoch: 4, Steps: 523 | Train Loss: 0.4289412 Vali Loss: 0.2785732 Best vali loss: 0.2784771
	iters: 100, epoch: 5 | loss: 0.3194077
	speed: 0.0076s/iter; left time: 15.2366s
	iters: 200, epoch: 5 | loss: 0.4967966
	speed: 0.0035s/iter; left time: 6.5446s
	iters: 300, epoch: 5 | loss: 0.2457939
	speed: 0.0035s/iter; left time: 6.2013s
	iters: 400, epoch: 5 | loss: 0.2633061
	speed: 0.0034s/iter; left time: 5.6858s
	iters: 500, epoch: 5 | loss: 0.2944084
	speed: 0.0033s/iter; left time: 5.2458s
Updating learning rate to 1.465793924375e-05
Epoch: 5 cost time: 1.8140554428100586
Epoch: 5, Steps: 523 | Train Loss: 0.3239425 Vali Loss: 0.2811689 Best vali loss: 0.2784771
	iters: 100, epoch: 6 | loss: 0.3882528
	speed: 0.0077s/iter; left time: 11.3889s
	iters: 200, epoch: 6 | loss: 0.2217118
	speed: 0.0035s/iter; left time: 4.8013s
	iters: 300, epoch: 6 | loss: 0.1926710
	speed: 0.0035s/iter; left time: 4.4306s
	iters: 400, epoch: 6 | loss: 0.4749433
	speed: 0.0035s/iter; left time: 4.0723s
	iters: 500, epoch: 6 | loss: 0.3323019
	speed: 0.0035s/iter; left time: 3.7654s
Updating learning rate to 7.328969621875e-06
Epoch: 6 cost time: 1.8664157390594482
Epoch: 6, Steps: 523 | Train Loss: 0.3219762 Vali Loss: 0.2834115 Best vali loss: 0.2784771
	iters: 100, epoch: 7 | loss: 0.4387776
	speed: 0.0072s/iter; left time: 6.8585s
	iters: 200, epoch: 7 | loss: 0.4286462
	speed: 0.0030s/iter; left time: 2.5691s
	iters: 300, epoch: 7 | loss: 0.5060346
	speed: 0.0030s/iter; left time: 2.2642s
	iters: 400, epoch: 7 | loss: 0.5147532
	speed: 0.0030s/iter; left time: 1.9607s
	iters: 500, epoch: 7 | loss: 0.3405530
	speed: 0.0030s/iter; left time: 1.6465s
Updating learning rate to 3.6644848109375e-06
Epoch: 7 cost time: 1.6286530494689941
Epoch: 7, Steps: 523 | Train Loss: 0.4457529 Vali Loss: 0.2856465 Best vali loss: 0.2784771
	iters: 100, epoch: 8 | loss: 0.3758814
	speed: 0.0074s/iter; left time: 3.1245s
	iters: 200, epoch: 8 | loss: 0.4651297
	speed: 0.0033s/iter; left time: 1.0668s
	iters: 300, epoch: 8 | loss: 0.2773597
	speed: 0.0033s/iter; left time: 0.7382s
	iters: 400, epoch: 8 | loss: 0.2261061
	speed: 0.0033s/iter; left time: 0.4068s
	iters: 500, epoch: 8 | loss: 0.5643933
	speed: 0.0033s/iter; left time: 0.0796s
Updating learning rate to 1.83224240546875e-06
Epoch: 8 cost time: 1.7619402408599854
Epoch: 8, Steps: 523 | Train Loss: 0.3817740 Vali Loss: 0.2870035 Best vali loss: 0.2784771

best validation loss 0.278477105011768

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010653215385, 'e_layers': 2, 'learning_rate': 5.87566832e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.87566832e-05
Validation loss decreased (inf --> 0.3063).  Saving model state dict ...
Epoch: 1 cost time: 0.5400080680847168
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3063100 Best vali loss: 0.3063100
Updating learning rate to 2.93783416e-05
Validation loss decreased (0.3063 --> 0.2892).  Saving model state dict ...
Epoch: 2 cost time: 0.32845354080200195
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2891513 Best vali loss: 0.2891513
Updating learning rate to 1.46891708e-05
Validation loss decreased (0.2892 --> 0.2846).  Saving model state dict ...
Epoch: 3 cost time: 0.3359053134918213
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2845938 Best vali loss: 0.2845938
Updating learning rate to 7.3445854e-06
Validation loss decreased (0.2846 --> 0.2832).  Saving model state dict ...
Epoch: 4 cost time: 0.34215855598449707
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2831695 Best vali loss: 0.2831695
Updating learning rate to 3.6722927e-06
Validation loss decreased (0.2832 --> 0.2827).  Saving model state dict ...
Epoch: 5 cost time: 0.34168052673339844
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2826724 Best vali loss: 0.2826724
Updating learning rate to 1.83614635e-06
Validation loss decreased (0.2827 --> 0.2824).  Saving model state dict ...
Epoch: 6 cost time: 0.3253633975982666
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2823948 Best vali loss: 0.2823948
Updating learning rate to 9.18073175e-07
Validation loss decreased (0.2824 --> 0.2822).  Saving model state dict ...
Epoch: 7 cost time: 0.32155585289001465
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2822103 Best vali loss: 0.2822103
Updating learning rate to 4.590365875e-07
Validation loss decreased (0.2822 --> 0.2821).  Saving model state dict ...
Epoch: 8 cost time: 0.32926321029663086
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2821317 Best vali loss: 0.2821317

best validation loss 0.28213166119374944

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0026680040577, 'e_layers': 3, 'learning_rate': 0.0004749025775, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5229339
	speed: 0.0121s/iter; left time: 11.5113s
Updating learning rate to 0.00045682767439455255
Validation loss decreased (inf --> 0.2696).  Saving model state dict ...
Epoch: 1 cost time: 1.143909215927124
Epoch: 1, Steps: 131 | Train Loss: 0.5229339 Vali Loss: 0.2695698 Best vali loss: 0.2695698
	iters: 100, epoch: 2 | loss: 0.5662367
	speed: 0.0112s/iter; left time: 9.1907s
Updating learning rate to 0.00040535470522660993
Epoch: 2 cost time: 0.911813497543335
Epoch: 2, Steps: 131 | Train Loss: 0.5662367 Vali Loss: 0.2780230 Best vali loss: 0.2695698
	iters: 100, epoch: 3 | loss: 0.5051602
	speed: 0.0110s/iter; left time: 7.5878s
Updating learning rate to 0.00032831996294836404
Epoch: 3 cost time: 0.9163663387298584
Epoch: 3, Steps: 131 | Train Loss: 0.5051602 Vali Loss: 0.2753701 Best vali loss: 0.2695698
	iters: 100, epoch: 4 | loss: 0.3180299
	speed: 0.0110s/iter; left time: 6.1373s
Updating learning rate to 0.00023745128875
Epoch: 4 cost time: 0.9098553657531738
Epoch: 4, Steps: 131 | Train Loss: 0.3180299 Vali Loss: 0.2813416 Best vali loss: 0.2695698
	iters: 100, epoch: 5 | loss: 0.3087617
	speed: 0.0111s/iter; left time: 4.7066s
Updating learning rate to 0.00014658261455163598
Epoch: 5 cost time: 0.9115560054779053
Epoch: 5, Steps: 131 | Train Loss: 0.3087617 Vali Loss: 0.2925982 Best vali loss: 0.2695698
	iters: 100, epoch: 6 | loss: 0.3075835
	speed: 0.0111s/iter; left time: 3.2522s
Updating learning rate to 6.954787227339005e-05
Epoch: 6 cost time: 0.9246730804443359
Epoch: 6, Steps: 131 | Train Loss: 0.3075835 Vali Loss: 0.3046081 Best vali loss: 0.2695698
	iters: 100, epoch: 7 | loss: 0.3533604
	speed: 0.0111s/iter; left time: 1.8144s
Updating learning rate to 1.807490310544744e-05
Epoch: 7 cost time: 0.9120831489562988
Epoch: 7, Steps: 131 | Train Loss: 0.3533604 Vali Loss: 0.3110894 Best vali loss: 0.2695698
	iters: 100, epoch: 8 | loss: 0.3012893
	speed: 0.0110s/iter; left time: 0.3530s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9099819660186768
Epoch: 8, Steps: 131 | Train Loss: 0.3012893 Vali Loss: 0.3167946 Best vali loss: 0.2695698

best validation loss 0.26956981661573315

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.003481730366, 'e_layers': 4, 'learning_rate': 9.6964076e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2818694
	speed: 0.0101s/iter; left time: 83.7473s
	iters: 200, epoch: 1 | loss: 0.2560872
	speed: 0.0050s/iter; left time: 41.0286s
	iters: 300, epoch: 1 | loss: 0.4181938
	speed: 0.0051s/iter; left time: 40.7901s
	iters: 400, epoch: 1 | loss: 0.6463681
	speed: 0.0051s/iter; left time: 40.2461s
	iters: 500, epoch: 1 | loss: 0.5035881
	speed: 0.0051s/iter; left time: 39.8431s
	iters: 600, epoch: 1 | loss: 0.9641552
	speed: 0.0050s/iter; left time: 39.0625s
	iters: 700, epoch: 1 | loss: 0.2449807
	speed: 0.0050s/iter; left time: 38.5812s
	iters: 800, epoch: 1 | loss: 0.2305461
	speed: 0.0050s/iter; left time: 38.0329s
	iters: 900, epoch: 1 | loss: 1.0216167
	speed: 0.0050s/iter; left time: 37.2439s
	iters: 1000, epoch: 1 | loss: 0.2952234
	speed: 0.0050s/iter; left time: 37.0283s
Updating learning rate to 9.6964076e-05
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 5.510905027389526
Epoch: 1, Steps: 1045 | Train Loss: 0.4862629 Vali Loss: 0.2862232 Best vali loss: 0.2862232
	iters: 100, epoch: 2 | loss: 0.4466307
	speed: 0.0140s/iter; left time: 101.2932s
	iters: 200, epoch: 2 | loss: 0.8283738
	speed: 0.0050s/iter; left time: 35.5728s
	iters: 300, epoch: 2 | loss: 0.2023706
	speed: 0.0050s/iter; left time: 35.4156s
	iters: 400, epoch: 2 | loss: 0.6265634
	speed: 0.0051s/iter; left time: 35.2583s
	iters: 500, epoch: 2 | loss: 0.5162288
	speed: 0.0051s/iter; left time: 34.4474s
	iters: 600, epoch: 2 | loss: 0.3298518
	speed: 0.0051s/iter; left time: 34.0712s
	iters: 700, epoch: 2 | loss: 0.2253252
	speed: 0.0048s/iter; left time: 31.5493s
	iters: 800, epoch: 2 | loss: 1.0582108
	speed: 0.0044s/iter; left time: 28.9522s
	iters: 900, epoch: 2 | loss: 0.1730825
	speed: 0.0043s/iter; left time: 27.4898s
	iters: 1000, epoch: 2 | loss: 0.3098117
	speed: 0.0044s/iter; left time: 27.7625s
Updating learning rate to 4.8482038e-05
Validation loss decreased (0.2862 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 5.052726745605469
Epoch: 2, Steps: 1045 | Train Loss: 0.4716449 Vali Loss: 0.2817780 Best vali loss: 0.2817780
	iters: 100, epoch: 3 | loss: 0.2094040
	speed: 0.0130s/iter; left time: 80.2852s
	iters: 200, epoch: 3 | loss: 0.3641635
	speed: 0.0044s/iter; left time: 26.4974s
	iters: 300, epoch: 3 | loss: 0.4392391
	speed: 0.0044s/iter; left time: 26.0077s
	iters: 400, epoch: 3 | loss: 0.2192031
	speed: 0.0044s/iter; left time: 25.5616s
	iters: 500, epoch: 3 | loss: 0.3410447
	speed: 0.0044s/iter; left time: 25.2633s
	iters: 600, epoch: 3 | loss: 0.6281921
	speed: 0.0043s/iter; left time: 24.4479s
	iters: 700, epoch: 3 | loss: 0.2387299
	speed: 0.0043s/iter; left time: 24.0929s
	iters: 800, epoch: 3 | loss: 0.3527307
	speed: 0.0044s/iter; left time: 23.9570s
	iters: 900, epoch: 3 | loss: 0.4256454
	speed: 0.0044s/iter; left time: 23.5421s
	iters: 1000, epoch: 3 | loss: 0.6415163
	speed: 0.0044s/iter; left time: 23.3770s
Updating learning rate to 2.4241019e-05
Epoch: 3 cost time: 4.600084066390991
Epoch: 3, Steps: 1045 | Train Loss: 0.3859869 Vali Loss: 0.2828289 Best vali loss: 0.2817780

best validation loss 0.2817779853081074

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0028470378222, 'e_layers': 1, 'learning_rate': 0.0022939736898, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022066645149628077
Validation loss decreased (inf --> 0.2950).  Saving model state dict ...
Epoch: 1 cost time: 0.5552985668182373
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2949651 Best vali loss: 0.2949651
Updating learning rate to 0.001958029020860553
Epoch: 2 cost time: 0.3260157108306885
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3047142 Best vali loss: 0.2949651
Updating learning rate to 0.001585919707583937
Validation loss decreased (0.2950 --> 0.2936).  Saving model state dict ...
Epoch: 3 cost time: 0.31871914863586426
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2935639 Best vali loss: 0.2935639

best validation loss 0.2935639100808023

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.00320861083, 'e_layers': 4, 'learning_rate': 0.0010190823955, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009802958813225112
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 0.8366043567657471
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2874031 Best vali loss: 0.2874031
Updating learning rate to 0.0008698412339729406
Epoch: 2 cost time: 0.6136517524719238
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2972815 Best vali loss: 0.2874031
Updating learning rate to 0.000704534172236389
Validation loss decreased (0.2874 --> 0.2820).  Saving model state dict ...
Epoch: 3 cost time: 0.6197104454040527
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2820018 Best vali loss: 0.2820018

best validation loss 0.2820017742552071

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.003481730366, 'e_layers': 4, 'learning_rate': 9.6964076e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2428790
	speed: 0.0103s/iter; left time: 52.9212s
	iters: 200, epoch: 4 | loss: 0.2069559
	speed: 0.0050s/iter; left time: 25.2996s
	iters: 300, epoch: 4 | loss: 0.3950585
	speed: 0.0050s/iter; left time: 24.5784s
	iters: 400, epoch: 4 | loss: 0.6202897
	speed: 0.0050s/iter; left time: 24.3409s
	iters: 500, epoch: 4 | loss: 0.4648983
	speed: 0.0050s/iter; left time: 23.7371s
	iters: 600, epoch: 4 | loss: 0.8671008
	speed: 0.0048s/iter; left time: 22.4240s
	iters: 700, epoch: 4 | loss: 0.2232218
	speed: 0.0049s/iter; left time: 21.9922s
	iters: 800, epoch: 4 | loss: 0.2199781
	speed: 0.0047s/iter; left time: 20.9086s
	iters: 900, epoch: 4 | loss: 1.0063932
	speed: 0.0048s/iter; left time: 20.7306s
	iters: 1000, epoch: 4 | loss: 0.2884476
	speed: 0.0048s/iter; left time: 20.1872s
Updating learning rate to 1.21205095e-05
Epoch: 4 cost time: 5.377408504486084
Epoch: 4, Steps: 1045 | Train Loss: 0.4535223 Vali Loss: 0.2826113 Best vali loss: 0.2817780
	iters: 100, epoch: 5 | loss: 0.4492485
	speed: 0.0140s/iter; left time: 57.2879s
	iters: 200, epoch: 5 | loss: 0.6883333
	speed: 0.0051s/iter; left time: 20.1113s
	iters: 300, epoch: 5 | loss: 0.1951522
	speed: 0.0051s/iter; left time: 19.6084s
	iters: 400, epoch: 5 | loss: 0.6153585
	speed: 0.0050s/iter; left time: 19.0859s
	iters: 500, epoch: 5 | loss: 0.5132840
	speed: 0.0051s/iter; left time: 18.7683s
	iters: 600, epoch: 5 | loss: 0.3179911
	speed: 0.0051s/iter; left time: 18.2827s
	iters: 700, epoch: 5 | loss: 0.2170267
	speed: 0.0051s/iter; left time: 17.8047s
	iters: 800, epoch: 5 | loss: 0.8568418
	speed: 0.0051s/iter; left time: 17.2697s
	iters: 900, epoch: 5 | loss: 0.1820541
	speed: 0.0051s/iter; left time: 16.6081s
	iters: 1000, epoch: 5 | loss: 0.2961509
	speed: 0.0051s/iter; left time: 16.1199s
Updating learning rate to 6.06025475e-06
Epoch: 5 cost time: 5.346725225448608
Epoch: 5, Steps: 1045 | Train Loss: 0.4331441 Vali Loss: 0.2825916 Best vali loss: 0.2817780
	iters: 100, epoch: 6 | loss: 0.2098646
	speed: 0.0137s/iter; left time: 41.6722s
	iters: 200, epoch: 6 | loss: 0.3519216
	speed: 0.0050s/iter; left time: 14.7850s
	iters: 300, epoch: 6 | loss: 0.4441293
	speed: 0.0050s/iter; left time: 14.2389s
	iters: 400, epoch: 6 | loss: 0.1867483
	speed: 0.0050s/iter; left time: 13.7909s
	iters: 500, epoch: 6 | loss: 0.3372981
	speed: 0.0051s/iter; left time: 13.3679s
	iters: 600, epoch: 6 | loss: 0.6617558
	speed: 0.0050s/iter; left time: 12.7800s
	iters: 700, epoch: 6 | loss: 0.2435817
	speed: 0.0050s/iter; left time: 12.2043s
	iters: 800, epoch: 6 | loss: 0.3503690
	speed: 0.0047s/iter; left time: 11.0401s
	iters: 900, epoch: 6 | loss: 0.4280032
	speed: 0.0044s/iter; left time: 9.8151s
	iters: 1000, epoch: 6 | loss: 0.6440298
	speed: 0.0043s/iter; left time: 9.1317s
Updating learning rate to 3.030127375e-06
Epoch: 6 cost time: 5.094002962112427
Epoch: 6, Steps: 1045 | Train Loss: 0.3857702 Vali Loss: 0.2829539 Best vali loss: 0.2817780
	iters: 100, epoch: 7 | loss: 0.2284449
	speed: 0.0128s/iter; left time: 25.4020s
	iters: 200, epoch: 7 | loss: 0.5782977
	speed: 0.0043s/iter; left time: 8.1574s
	iters: 300, epoch: 7 | loss: 0.3510012
	speed: 0.0043s/iter; left time: 7.7499s
	iters: 400, epoch: 7 | loss: 0.9978974
	speed: 0.0047s/iter; left time: 7.8831s
	iters: 500, epoch: 7 | loss: 0.2906710
	speed: 0.0048s/iter; left time: 7.6906s
	iters: 600, epoch: 7 | loss: 0.3058113
	speed: 0.0044s/iter; left time: 6.5766s
	iters: 700, epoch: 7 | loss: 1.0234663
	speed: 0.0044s/iter; left time: 6.1636s
	iters: 800, epoch: 7 | loss: 0.3066271
	speed: 0.0044s/iter; left time: 5.6815s
	iters: 900, epoch: 7 | loss: 0.4730404
	speed: 0.0044s/iter; left time: 5.2518s
	iters: 1000, epoch: 7 | loss: 0.5555550
	speed: 0.0044s/iter; left time: 4.7635s
Updating learning rate to 1.5150636875e-06
Epoch: 7 cost time: 4.683337926864624
Epoch: 7, Steps: 1045 | Train Loss: 0.5110812 Vali Loss: 0.2830487 Best vali loss: 0.2817780
	iters: 100, epoch: 8 | loss: 0.2883429
	speed: 0.0137s/iter; left time: 12.9429s
	iters: 200, epoch: 8 | loss: 1.0893042
	speed: 0.0048s/iter; left time: 4.0867s
	iters: 300, epoch: 8 | loss: 0.4944044
	speed: 0.0049s/iter; left time: 3.6186s
	iters: 400, epoch: 8 | loss: 0.9524196
	speed: 0.0049s/iter; left time: 3.1371s
	iters: 500, epoch: 8 | loss: 2.1605208
	speed: 0.0048s/iter; left time: 2.6387s
	iters: 600, epoch: 8 | loss: 0.2628990
	speed: 0.0049s/iter; left time: 2.1659s
	iters: 700, epoch: 8 | loss: 1.0490285
	speed: 0.0048s/iter; left time: 1.6764s
	iters: 800, epoch: 8 | loss: 0.6777448
	speed: 0.0049s/iter; left time: 1.1989s
	iters: 900, epoch: 8 | loss: 0.2989686
	speed: 0.0049s/iter; left time: 0.7091s
	iters: 1000, epoch: 8 | loss: 0.3013363
	speed: 0.0049s/iter; left time: 0.2232s
Updating learning rate to 7.5753184375e-07
Epoch: 8 cost time: 5.099572658538818
Epoch: 8, Steps: 1045 | Train Loss: 0.7574969 Vali Loss: 0.2830984 Best vali loss: 0.2817780

best validation loss 0.2817779853081074

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0048789245516, 'e_layers': 4, 'learning_rate': 0.0010206650006, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00098181825210248
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 0.8515985012054443
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2883074 Best vali loss: 0.2883074
Updating learning rate to 0.0008711920719220157
Epoch: 2 cost time: 0.6168463230133057
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3021464 Best vali loss: 0.2883074
Updating learning rate to 0.0007056282931622622
Epoch: 3 cost time: 0.6170191764831543
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3081556 Best vali loss: 0.2883074
Updating learning rate to 0.0005103325003
Validation loss decreased (0.2883 --> 0.2795).  Saving model state dict ...
Epoch: 4 cost time: 0.6050262451171875
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2795479 Best vali loss: 0.2795479
Updating learning rate to 0.00031503670743773777
Epoch: 5 cost time: 0.6146433353424072
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2853670 Best vali loss: 0.2795479
Updating learning rate to 0.00014947292867798423
Epoch: 6 cost time: 0.617046594619751
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2954723 Best vali loss: 0.2795479
Updating learning rate to 3.88467484975199e-05
Epoch: 7 cost time: 0.6146790981292725
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2958858 Best vali loss: 0.2795479
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6131722927093506
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2949984 Best vali loss: 0.2795479

best validation loss 0.2795478628720436

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0008461630386, 'e_layers': 4, 'learning_rate': 0.0010169313847, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5863171
	speed: 0.0106s/iter; left time: 21.1171s
	iters: 200, epoch: 1 | loss: 0.5283876
	speed: 0.0053s/iter; left time: 10.1354s
Updating learning rate to 0.0009782267384963457
Validation loss decreased (inf --> 0.3083).  Saving model state dict ...
Epoch: 1 cost time: 1.654892921447754
Epoch: 1, Steps: 262 | Train Loss: 0.5573523 Vali Loss: 0.3083041 Best vali loss: 0.3083041
	iters: 100, epoch: 2 | loss: 0.4721099
	speed: 0.0109s/iter; left time: 18.9355s
	iters: 200, epoch: 2 | loss: 0.6025173
	speed: 0.0046s/iter; left time: 7.5622s
Updating learning rate to 0.0008680052314113978
Validation loss decreased (0.3083 --> 0.2910).  Saving model state dict ...
Epoch: 2 cost time: 1.2808072566986084
Epoch: 2, Steps: 262 | Train Loss: 0.5373136 Vali Loss: 0.2910389 Best vali loss: 0.2910389
	iters: 100, epoch: 3 | loss: 0.3956126
	speed: 0.0106s/iter; left time: 15.6051s
	iters: 200, epoch: 3 | loss: 0.4187887
	speed: 0.0048s/iter; left time: 6.5725s
Updating learning rate to 0.0007030470887383897
Validation loss decreased (0.2910 --> 0.2854).  Saving model state dict ...
Epoch: 3 cost time: 1.2859115600585938
Epoch: 3, Steps: 262 | Train Loss: 0.4072007 Vali Loss: 0.2853793 Best vali loss: 0.2853793
	iters: 100, epoch: 4 | loss: 0.5808672
	speed: 0.0109s/iter; left time: 13.2091s
	iters: 200, epoch: 4 | loss: 0.4194305
	speed: 0.0053s/iter; left time: 5.8803s
Updating learning rate to 0.00050846569235
Epoch: 4 cost time: 1.4042205810546875
Epoch: 4, Steps: 262 | Train Loss: 0.5001488 Vali Loss: 0.2979199 Best vali loss: 0.2853793
	iters: 100, epoch: 5 | loss: 0.5206482
	speed: 0.0109s/iter; left time: 10.3666s
	iters: 200, epoch: 5 | loss: 0.4116678
	speed: 0.0052s/iter; left time: 4.4175s
Updating learning rate to 0.00031388429596161026
Epoch: 5 cost time: 1.4031774997711182
Epoch: 5, Steps: 262 | Train Loss: 0.4661580 Vali Loss: 0.2897940 Best vali loss: 0.2853793
	iters: 100, epoch: 6 | loss: 0.2901112
	speed: 0.0112s/iter; left time: 7.6878s
	iters: 200, epoch: 6 | loss: 0.3261299
	speed: 0.0051s/iter; left time: 2.9850s
Updating learning rate to 0.00014892615328860218
Epoch: 6 cost time: 1.377671480178833
Epoch: 6, Steps: 262 | Train Loss: 0.3081205 Vali Loss: 0.2908874 Best vali loss: 0.2853793
	iters: 100, epoch: 7 | loss: 0.3293668
	speed: 0.0105s/iter; left time: 4.4539s
	iters: 200, epoch: 7 | loss: 0.3619670
	speed: 0.0050s/iter; left time: 1.6117s
Updating learning rate to 3.8704646203654254e-05
Epoch: 7 cost time: 1.3328797817230225
Epoch: 7, Steps: 262 | Train Loss: 0.3456669 Vali Loss: 0.2970947 Best vali loss: 0.2853793
	iters: 100, epoch: 8 | loss: 0.2138757
	speed: 0.0111s/iter; left time: 1.8163s
	iters: 200, epoch: 8 | loss: 0.3735014
	speed: 0.0051s/iter; left time: 0.3244s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.417814016342163
Epoch: 8, Steps: 262 | Train Loss: 0.2936886 Vali Loss: 0.3052206 Best vali loss: 0.2853793

best validation loss 0.2853792718836436

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0033635116986, 'e_layers': 4, 'learning_rate': 0.0010115083747, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6844492
	speed: 0.0104s/iter; left time: 20.8627s
	iters: 200, epoch: 1 | loss: 0.8497465
	speed: 0.0054s/iter; left time: 10.1495s
Updating learning rate to 0.0009730101295245436
Validation loss decreased (inf --> 0.3124).  Saving model state dict ...
Epoch: 1 cost time: 1.6370511054992676
Epoch: 1, Steps: 262 | Train Loss: 0.7670979 Vali Loss: 0.3124157 Best vali loss: 0.3124157
	iters: 100, epoch: 2 | loss: 0.4693743
	speed: 0.0112s/iter; left time: 19.4332s
	iters: 200, epoch: 2 | loss: 0.4452595
	speed: 0.0050s/iter; left time: 8.2433s
Updating learning rate to 0.0008633764028386765
Epoch: 2 cost time: 1.4072186946868896
Epoch: 2, Steps: 262 | Train Loss: 0.4573169 Vali Loss: 0.3294892 Best vali loss: 0.3124157
	iters: 100, epoch: 3 | loss: 0.6069152
	speed: 0.0112s/iter; left time: 16.4513s
	iters: 200, epoch: 3 | loss: 0.6775243
	speed: 0.0054s/iter; left time: 7.3976s
Updating learning rate to 0.0006992979356981147
Epoch: 3 cost time: 1.4404959678649902
Epoch: 3, Steps: 262 | Train Loss: 0.6422198 Vali Loss: 0.3211515 Best vali loss: 0.3124157

best validation loss 0.3124157178464012

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270316918, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597159
	speed: 0.0103s/iter; left time: 9.7785s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9325993061065674
Epoch: 1, Steps: 131 | Train Loss: 0.5597159 Vali Loss: 0.2756418 Best vali loss: 0.2756418
	iters: 100, epoch: 2 | loss: 0.3240530
	speed: 0.0089s/iter; left time: 7.3069s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2756 --> 0.2725).  Saving model state dict ...
Epoch: 2 cost time: 0.7016842365264893
Epoch: 2, Steps: 131 | Train Loss: 0.3240530 Vali Loss: 0.2724546 Best vali loss: 0.2724546
	iters: 100, epoch: 3 | loss: 0.4630087
	speed: 0.0091s/iter; left time: 6.2303s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.6971025466918945
Epoch: 3, Steps: 131 | Train Loss: 0.4630087 Vali Loss: 0.2766079 Best vali loss: 0.2724546

best validation loss 0.27245462102577916

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030406701589, 'e_layers': 3, 'learning_rate': 0.0004741408878, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5214490
	speed: 0.0121s/iter; left time: 11.4831s
Updating learning rate to 0.0004741408878
Validation loss decreased (inf --> 0.2703).  Saving model state dict ...
Epoch: 1 cost time: 1.1331257820129395
Epoch: 1, Steps: 131 | Train Loss: 0.5214490 Vali Loss: 0.2703299 Best vali loss: 0.2703299
	iters: 100, epoch: 2 | loss: 0.5055002
	speed: 0.0113s/iter; left time: 9.2220s
Updating learning rate to 0.0002370704439
Epoch: 2 cost time: 0.9087867736816406
Epoch: 2, Steps: 131 | Train Loss: 0.5055002 Vali Loss: 0.2804512 Best vali loss: 0.2703299
	iters: 100, epoch: 3 | loss: 0.4923904
	speed: 0.0110s/iter; left time: 7.5597s
Updating learning rate to 0.00011853522195
Epoch: 3 cost time: 0.9090642929077148
Epoch: 3, Steps: 131 | Train Loss: 0.4923904 Vali Loss: 0.2816686 Best vali loss: 0.2703299

best validation loss 0.27032986621889493

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030406701589, 'e_layers': 3, 'learning_rate': 0.0004741408878, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3324265
	speed: 0.0123s/iter; left time: 6.8505s
Updating learning rate to 5.9267610975e-05
Epoch: 4 cost time: 1.1426246166229248
Epoch: 4, Steps: 131 | Train Loss: 0.3324265 Vali Loss: 0.2848954 Best vali loss: 0.2703299
	iters: 100, epoch: 5 | loss: 0.3393418
	speed: 0.0111s/iter; left time: 4.7172s
Updating learning rate to 2.96338054875e-05
Epoch: 5 cost time: 0.9129281044006348
Epoch: 5, Steps: 131 | Train Loss: 0.3393418 Vali Loss: 0.2785495 Best vali loss: 0.2703299
	iters: 100, epoch: 6 | loss: 0.3725621
	speed: 0.0109s/iter; left time: 3.2097s
Updating learning rate to 1.481690274375e-05
Epoch: 6 cost time: 0.9071378707885742
Epoch: 6, Steps: 131 | Train Loss: 0.3725621 Vali Loss: 0.2847066 Best vali loss: 0.2703299
	iters: 100, epoch: 7 | loss: 0.2830297
	speed: 0.0111s/iter; left time: 1.8071s
Updating learning rate to 7.408451371875e-06
Epoch: 7 cost time: 0.9143929481506348
Epoch: 7, Steps: 131 | Train Loss: 0.2830297 Vali Loss: 0.2820343 Best vali loss: 0.2703299
	iters: 100, epoch: 8 | loss: 0.2992430
	speed: 0.0111s/iter; left time: 0.3562s
Updating learning rate to 3.7042256859375e-06
Epoch: 8 cost time: 0.9195175170898438
Epoch: 8, Steps: 131 | Train Loss: 0.2992430 Vali Loss: 0.2840359 Best vali loss: 0.2703299

best validation loss 0.27032986621889493

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0027774723985, 'e_layers': 3, 'learning_rate': 0.0004741133436, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5191454
	speed: 0.0120s/iter; left time: 11.3887s
Updating learning rate to 0.0004741133436
Validation loss decreased (inf --> 0.2746).  Saving model state dict ...
Epoch: 1 cost time: 1.1481804847717285
Epoch: 1, Steps: 131 | Train Loss: 0.5191454 Vali Loss: 0.2745858 Best vali loss: 0.2745858
	iters: 100, epoch: 2 | loss: 0.5388513
	speed: 0.0114s/iter; left time: 9.2924s
Updating learning rate to 0.0002370566718
Epoch: 2 cost time: 0.9153919219970703
Epoch: 2, Steps: 131 | Train Loss: 0.5388513 Vali Loss: 0.2988855 Best vali loss: 0.2745858
	iters: 100, epoch: 3 | loss: 0.5047888
	speed: 0.0111s/iter; left time: 7.5977s
Updating learning rate to 0.0001185283359
Epoch: 3 cost time: 0.914902925491333
Epoch: 3, Steps: 131 | Train Loss: 0.5047888 Vali Loss: 0.2891740 Best vali loss: 0.2745858
	iters: 100, epoch: 4 | loss: 0.3136778
	speed: 0.0111s/iter; left time: 6.1500s
Updating learning rate to 5.926416795e-05
Epoch: 4 cost time: 0.9155914783477783
Epoch: 4, Steps: 131 | Train Loss: 0.3136778 Vali Loss: 0.2788863 Best vali loss: 0.2745858
	iters: 100, epoch: 5 | loss: 0.3129312
	speed: 0.0111s/iter; left time: 4.7231s
Updating learning rate to 2.9632083975e-05
Epoch: 5 cost time: 0.9153835773468018
Epoch: 5, Steps: 131 | Train Loss: 0.3129312 Vali Loss: 0.2807974 Best vali loss: 0.2745858
	iters: 100, epoch: 6 | loss: 0.3309472
	speed: 0.0111s/iter; left time: 3.2655s
Updating learning rate to 1.48160419875e-05
Epoch: 6 cost time: 0.9224696159362793
Epoch: 6, Steps: 131 | Train Loss: 0.3309472 Vali Loss: 0.2834913 Best vali loss: 0.2745858
	iters: 100, epoch: 7 | loss: 0.3987794
	speed: 0.0111s/iter; left time: 1.8150s
Updating learning rate to 7.40802099375e-06
Epoch: 7 cost time: 0.9133048057556152
Epoch: 7, Steps: 131 | Train Loss: 0.3987794 Vali Loss: 0.2843181 Best vali loss: 0.2745858
	iters: 100, epoch: 8 | loss: 0.3560145
	speed: 0.0111s/iter; left time: 0.3547s
Updating learning rate to 3.704010496875e-06
Epoch: 8 cost time: 0.9210031032562256
Epoch: 8, Steps: 131 | Train Loss: 0.3560145 Vali Loss: 0.2855582 Best vali loss: 0.2745858

best validation loss 0.2745857953681694

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0016725949795, 'e_layers': 4, 'learning_rate': 8.32847755e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.011493747712373e-05
Validation loss decreased (inf --> 0.3427).  Saving model state dict ...
Epoch: 1 cost time: 0.7251300811767578
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3426703 Best vali loss: 0.3426703
Updating learning rate to 7.108800251282462e-05
Validation loss decreased (0.3427 --> 0.3289).  Saving model state dict ...
Epoch: 2 cost time: 0.4452786445617676
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3288790 Best vali loss: 0.3288790
Updating learning rate to 5.757823962604797e-05
Validation loss decreased (0.3289 --> 0.3198).  Saving model state dict ...
Epoch: 3 cost time: 0.45192670822143555
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3197958 Best vali loss: 0.3197958
Updating learning rate to 4.164238775e-05
Validation loss decreased (0.3198 --> 0.3141).  Saving model state dict ...
Epoch: 4 cost time: 0.448972225189209
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3140936 Best vali loss: 0.3140936
Updating learning rate to 2.5706535873952035e-05
Validation loss decreased (0.3141 --> 0.3105).  Saving model state dict ...
Epoch: 5 cost time: 0.41150879859924316
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3105327 Best vali loss: 0.3105327
Updating learning rate to 1.2196772987175385e-05
Validation loss decreased (0.3105 --> 0.3086).  Saving model state dict ...
Epoch: 6 cost time: 0.44813013076782227
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3086497 Best vali loss: 0.3086497
Updating learning rate to 3.1698380228762664e-06
Validation loss decreased (0.3086 --> 0.3078).  Saving model state dict ...
Epoch: 7 cost time: 0.40640711784362793
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3077516 Best vali loss: 0.3077516
Updating learning rate to 0.0
Validation loss decreased (0.3078 --> 0.3075).  Saving model state dict ...
Epoch: 8 cost time: 0.41283154487609863
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3075475 Best vali loss: 0.3075475

best validation loss 0.3075475452856399

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019020899567, 'e_layers': 4, 'learning_rate': 0.0003079410625, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2753650
	speed: 0.0105s/iter; left time: 87.1444s
	iters: 200, epoch: 1 | loss: 0.4663835
	speed: 0.0052s/iter; left time: 42.3543s
	iters: 300, epoch: 1 | loss: 0.2336886
	speed: 0.0053s/iter; left time: 42.4693s
	iters: 400, epoch: 1 | loss: 0.5106540
	speed: 0.0053s/iter; left time: 42.4453s
	iters: 500, epoch: 1 | loss: 0.2071808
	speed: 0.0053s/iter; left time: 41.8787s
	iters: 600, epoch: 1 | loss: 0.7456832
	speed: 0.0053s/iter; left time: 41.1690s
	iters: 700, epoch: 1 | loss: 0.2585230
	speed: 0.0053s/iter; left time: 40.8161s
	iters: 800, epoch: 1 | loss: 1.0364668
	speed: 0.0050s/iter; left time: 37.8363s
	iters: 900, epoch: 1 | loss: 1.3089091
	speed: 0.0047s/iter; left time: 35.1521s
	iters: 1000, epoch: 1 | loss: 0.3418168
	speed: 0.0046s/iter; left time: 34.0123s
Updating learning rate to 0.0003079410625
Validation loss decreased (inf --> 0.3023).  Saving model state dict ...
Epoch: 1 cost time: 5.606808423995972
Epoch: 1, Steps: 1045 | Train Loss: 0.5384671 Vali Loss: 0.3022748 Best vali loss: 0.3022748
	iters: 100, epoch: 2 | loss: 0.5431379
	speed: 0.0136s/iter; left time: 97.8050s
	iters: 200, epoch: 2 | loss: 0.1605058
	speed: 0.0046s/iter; left time: 32.4614s
	iters: 300, epoch: 2 | loss: 0.8663079
	speed: 0.0046s/iter; left time: 32.2150s
	iters: 400, epoch: 2 | loss: 0.7486780
	speed: 0.0045s/iter; left time: 31.3888s
	iters: 500, epoch: 2 | loss: 0.1521307
	speed: 0.0045s/iter; left time: 30.7970s
	iters: 600, epoch: 2 | loss: 0.4501109
	speed: 0.0046s/iter; left time: 30.8643s
	iters: 700, epoch: 2 | loss: 0.5228422
	speed: 0.0045s/iter; left time: 30.0786s
	iters: 800, epoch: 2 | loss: 0.6116765
	speed: 0.0045s/iter; left time: 29.5500s
	iters: 900, epoch: 2 | loss: 0.2954284
	speed: 0.0046s/iter; left time: 29.2025s
	iters: 1000, epoch: 2 | loss: 0.7669126
	speed: 0.0046s/iter; left time: 28.7638s
Updating learning rate to 0.00015397053125
Epoch: 2 cost time: 4.798096418380737
Epoch: 2, Steps: 1045 | Train Loss: 0.5117731 Vali Loss: 0.3044158 Best vali loss: 0.3022748
	iters: 100, epoch: 3 | loss: 0.4007050
	speed: 0.0139s/iter; left time: 86.0516s
	iters: 200, epoch: 3 | loss: 0.3417281
	speed: 0.0047s/iter; left time: 28.6735s
	iters: 300, epoch: 3 | loss: 1.7243907
	speed: 0.0047s/iter; left time: 27.9865s
	iters: 400, epoch: 3 | loss: 0.3201859
	speed: 0.0047s/iter; left time: 27.4269s
	iters: 500, epoch: 3 | loss: 0.3495736
	speed: 0.0047s/iter; left time: 26.9295s
	iters: 600, epoch: 3 | loss: 0.6866497
	speed: 0.0047s/iter; left time: 26.3973s
	iters: 700, epoch: 3 | loss: 1.8316902
	speed: 0.0047s/iter; left time: 26.0946s
	iters: 800, epoch: 3 | loss: 0.2400949
	speed: 0.0047s/iter; left time: 25.5198s
	iters: 900, epoch: 3 | loss: 0.2768778
	speed: 0.0047s/iter; left time: 25.3109s
	iters: 1000, epoch: 3 | loss: 0.7755027
	speed: 0.0047s/iter; left time: 24.8339s
Updating learning rate to 7.6985265625e-05
Validation loss decreased (0.3023 --> 0.2838).  Saving model state dict ...
Epoch: 3 cost time: 4.943111419677734
Epoch: 3, Steps: 1045 | Train Loss: 0.6947398 Vali Loss: 0.2838469 Best vali loss: 0.2838469

best validation loss 0.28384686144212223

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0014705301053, 'e_layers': 2, 'learning_rate': 0.001114914019, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001072480130832
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 0.5566086769104004
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2809034 Best vali loss: 0.2809034
Updating learning rate to 0.0009516386411374236
Epoch: 2 cost time: 0.3353710174560547
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2840558 Best vali loss: 0.2809034
Updating learning rate to 0.0007707865712914385
Epoch: 3 cost time: 0.3399636745452881
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2914354 Best vali loss: 0.2809034

best validation loss 0.28090339794882435

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092686582036, 'e_layers': 3, 'learning_rate': 0.0004748304645, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5380137
	speed: 0.0122s/iter; left time: 11.5903s
Updating learning rate to 0.0004567583060321886
Validation loss decreased (inf --> 0.2751).  Saving model state dict ...
Epoch: 1 cost time: 1.161707878112793
Epoch: 1, Steps: 131 | Train Loss: 0.5380137 Vali Loss: 0.2750939 Best vali loss: 0.2750939
	iters: 100, epoch: 2 | loss: 0.5252561
	speed: 0.0114s/iter; left time: 9.2925s
Updating learning rate to 0.0004052931529309541
Epoch: 2 cost time: 0.9147803783416748
Epoch: 2, Steps: 131 | Train Loss: 0.5252561 Vali Loss: 0.2784885 Best vali loss: 0.2750939
	iters: 100, epoch: 3 | loss: 0.5758419
	speed: 0.0109s/iter; left time: 7.5051s
Updating learning rate to 0.000328270108223185
Epoch: 3 cost time: 0.9064109325408936
Epoch: 3, Steps: 131 | Train Loss: 0.5758419 Vali Loss: 0.2821525 Best vali loss: 0.2750939

best validation loss 0.27509387188261

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092686582036, 'e_layers': 3, 'learning_rate': 0.0004748304645, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3680608
	speed: 0.0122s/iter; left time: 6.7908s
Updating learning rate to 0.00023741523225
Epoch: 4 cost time: 1.1317646503448486
Epoch: 4, Steps: 131 | Train Loss: 0.3680608 Vali Loss: 0.2791879 Best vali loss: 0.2750939
	iters: 100, epoch: 5 | loss: 0.3140794
	speed: 0.0111s/iter; left time: 4.7164s
Updating learning rate to 0.00014656035627681505
Epoch: 5 cost time: 0.9180870056152344
Epoch: 5, Steps: 131 | Train Loss: 0.3140794 Vali Loss: 0.2859781 Best vali loss: 0.2750939
	iters: 100, epoch: 6 | loss: 0.3342178
	speed: 0.0109s/iter; left time: 3.2139s
Updating learning rate to 6.953731156904591e-05
Epoch: 6 cost time: 0.9096283912658691
Epoch: 6, Steps: 131 | Train Loss: 0.3342178 Vali Loss: 0.3125480 Best vali loss: 0.2750939
	iters: 100, epoch: 7 | loss: 0.2300828
	speed: 0.0110s/iter; left time: 1.7938s
Updating learning rate to 1.8072158467811433e-05
Epoch: 7 cost time: 0.9096124172210693
Epoch: 7, Steps: 131 | Train Loss: 0.2300828 Vali Loss: 0.3251524 Best vali loss: 0.2750939
	iters: 100, epoch: 8 | loss: 0.2630424
	speed: 0.0111s/iter; left time: 0.3542s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9212098121643066
Epoch: 8, Steps: 131 | Train Loss: 0.2630424 Vali Loss: 0.3298460 Best vali loss: 0.2750939

best validation loss 0.27509387188261

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021566939635, 'e_layers': 3, 'learning_rate': 0.0003228481178, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003105604429726064
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 1.0353188514709473
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2799577 Best vali loss: 0.2799577
Updating learning rate to 0.00027556810559484663
Epoch: 2 cost time: 0.8125874996185303
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2927804 Best vali loss: 0.2799577
Updating learning rate to 0.00022319837182615643
Epoch: 3 cost time: 0.815985918045044
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3169121 Best vali loss: 0.2799577
Updating learning rate to 0.0001614240589
Epoch: 4 cost time: 0.8128879070281982
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2820250 Best vali loss: 0.2799577
Updating learning rate to 9.964974597384359e-05
Epoch: 5 cost time: 0.8053674697875977
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2910380 Best vali loss: 0.2799577
Updating learning rate to 4.7280012205153346e-05
Epoch: 6 cost time: 0.8092489242553711
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3043933 Best vali loss: 0.2799577
Updating learning rate to 1.2287674827393584e-05
Epoch: 7 cost time: 0.8174076080322266
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3041715 Best vali loss: 0.2799577
Updating learning rate to 0.0
Epoch: 8 cost time: 0.811920166015625
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3034472 Best vali loss: 0.2799577

best validation loss 0.2799577081334241

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0023094469233, 'e_layers': 2, 'learning_rate': 0.0039062276974, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0037575557581782763
Validation loss decreased (inf --> 0.2926).  Saving model state dict ...
Epoch: 1 cost time: 0.5508389472961426
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2925661 Best vali loss: 0.2925661
Updating learning rate to 0.0033341738955451265
Epoch: 2 cost time: 0.3405759334564209
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3114652 Best vali loss: 0.2925661
Updating learning rate to 0.002700538160120307
Epoch: 3 cost time: 0.3355293273925781
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3082013 Best vali loss: 0.2925661
Updating learning rate to 0.0019531138487
Epoch: 4 cost time: 0.3346245288848877
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2965560 Best vali loss: 0.2925661
Updating learning rate to 0.0012056895372796934
Epoch: 5 cost time: 0.3360311985015869
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3032081 Best vali loss: 0.2925661
Updating learning rate to 0.0005720538018548735
Epoch: 6 cost time: 0.33654093742370605
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3019019 Best vali loss: 0.2925661
Updating learning rate to 0.00014867193922172398
Epoch: 7 cost time: 0.3211197853088379
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3074147 Best vali loss: 0.2925661
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3359715938568115
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3063302 Best vali loss: 0.2925661

best validation loss 0.2925661279615216

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0102123676054, 'e_layers': 2, 'learning_rate': 0.0003160343899, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003160343899
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 0.5694208145141602
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2806010 Best vali loss: 0.2806010
Updating learning rate to 0.00015801719495
Epoch: 2 cost time: 0.33297157287597656
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2812725 Best vali loss: 0.2806010
Updating learning rate to 7.9008597475e-05
Validation loss decreased (0.2806 --> 0.2791).  Saving model state dict ...
Epoch: 3 cost time: 0.3300132751464844
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2791443 Best vali loss: 0.2791443

best validation loss 0.2791442802046346

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0032224402371, 'e_layers': 4, 'learning_rate': 6.08470788e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5635922
	speed: 0.0110s/iter; left time: 10.4373s
Updating learning rate to 5.853122475821071e-05
Validation loss decreased (inf --> 0.3195).  Saving model state dict ...
Epoch: 1 cost time: 1.0069172382354736
Epoch: 1, Steps: 131 | Train Loss: 0.5635922 Vali Loss: 0.3195444 Best vali loss: 0.3195444
	iters: 100, epoch: 2 | loss: 0.5806435
	speed: 0.0091s/iter; left time: 7.4836s
Updating learning rate to 5.1936230417436107e-05
Validation loss decreased (0.3195 --> 0.3023).  Saving model state dict ...
Epoch: 2 cost time: 0.7391452789306641
Epoch: 2, Steps: 131 | Train Loss: 0.5806435 Vali Loss: 0.3023396 Best vali loss: 0.3023396
	iters: 100, epoch: 3 | loss: 0.6785287
	speed: 0.0085s/iter; left time: 5.8720s
Updating learning rate to 4.206612388228655e-05
Validation loss decreased (0.3023 --> 0.2943).  Saving model state dict ...
Epoch: 3 cost time: 0.7022833824157715
Epoch: 3, Steps: 131 | Train Loss: 0.6785287 Vali Loss: 0.2943155 Best vali loss: 0.2943155

best validation loss 0.2943154773711272

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0009242074493, 'e_layers': 4, 'learning_rate': 0.0022738398108, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2799632
	speed: 0.0105s/iter; left time: 86.3840s
	iters: 200, epoch: 1 | loss: 0.4866564
	speed: 0.0051s/iter; left time: 41.7097s
	iters: 300, epoch: 1 | loss: 0.2315515
	speed: 0.0051s/iter; left time: 41.3301s
	iters: 400, epoch: 1 | loss: 1.1328940
	speed: 0.0052s/iter; left time: 41.1471s
	iters: 500, epoch: 1 | loss: 0.4315227
	speed: 0.0051s/iter; left time: 40.4308s
	iters: 600, epoch: 1 | loss: 0.5244300
	speed: 0.0051s/iter; left time: 39.5400s
	iters: 700, epoch: 1 | loss: 1.3910854
	speed: 0.0051s/iter; left time: 39.2559s
	iters: 800, epoch: 1 | loss: 0.4985231
	speed: 0.0051s/iter; left time: 38.5471s
	iters: 900, epoch: 1 | loss: 1.5456462
	speed: 0.0051s/iter; left time: 38.2144s
	iters: 1000, epoch: 1 | loss: 1.1670772
	speed: 0.0051s/iter; left time: 37.4204s
Updating learning rate to 0.0022738398108
Validation loss decreased (inf --> 0.3343).  Saving model state dict ...
Epoch: 1 cost time: 5.6042115688323975
Epoch: 1, Steps: 1045 | Train Loss: 0.7689350 Vali Loss: 0.3342814 Best vali loss: 0.3342814
	iters: 100, epoch: 2 | loss: 0.2754962
	speed: 0.0142s/iter; left time: 102.8274s
	iters: 200, epoch: 2 | loss: 0.1864400
	speed: 0.0052s/iter; left time: 36.7752s
	iters: 300, epoch: 2 | loss: 1.5229042
	speed: 0.0051s/iter; left time: 35.4912s
	iters: 400, epoch: 2 | loss: 0.3200517
	speed: 0.0049s/iter; left time: 33.6823s
	iters: 500, epoch: 2 | loss: 0.2299605
	speed: 0.0050s/iter; left time: 34.2106s
	iters: 600, epoch: 2 | loss: 1.4279268
	speed: 0.0051s/iter; left time: 34.3282s
	iters: 700, epoch: 2 | loss: 0.5325240
	speed: 0.0051s/iter; left time: 33.6915s
	iters: 800, epoch: 2 | loss: 0.5964409
	speed: 0.0051s/iter; left time: 33.3992s
	iters: 900, epoch: 2 | loss: 0.6107651
	speed: 0.0051s/iter; left time: 32.8510s
	iters: 1000, epoch: 2 | loss: 0.6767661
	speed: 0.0051s/iter; left time: 32.0862s
Updating learning rate to 0.0011369199054
Validation loss decreased (0.3343 --> 0.3215).  Saving model state dict ...
Epoch: 2 cost time: 5.356302976608276
Epoch: 2, Steps: 1045 | Train Loss: 0.6379275 Vali Loss: 0.3214970 Best vali loss: 0.3214970
	iters: 100, epoch: 3 | loss: 1.3157032
	speed: 0.0142s/iter; left time: 87.8316s
	iters: 200, epoch: 3 | loss: 1.2290893
	speed: 0.0050s/iter; left time: 30.3297s
	iters: 300, epoch: 3 | loss: 0.2009583
	speed: 0.0051s/iter; left time: 30.5374s
	iters: 400, epoch: 3 | loss: 1.0670816
	speed: 0.0051s/iter; left time: 30.0088s
	iters: 500, epoch: 3 | loss: 1.1481067
	speed: 0.0051s/iter; left time: 29.5957s
	iters: 600, epoch: 3 | loss: 0.4671236
	speed: 0.0051s/iter; left time: 28.8091s
	iters: 700, epoch: 3 | loss: 0.7006101
	speed: 0.0051s/iter; left time: 28.6126s
	iters: 800, epoch: 3 | loss: 0.5892012
	speed: 0.0051s/iter; left time: 28.0891s
	iters: 900, epoch: 3 | loss: 0.3055151
	speed: 0.0051s/iter; left time: 27.4452s
	iters: 1000, epoch: 3 | loss: 0.2507963
	speed: 0.0051s/iter; left time: 26.9881s
Updating learning rate to 0.0005684599527
Validation loss decreased (0.3215 --> 0.3186).  Saving model state dict ...
Epoch: 3 cost time: 5.373922348022461
Epoch: 3, Steps: 1045 | Train Loss: 0.7274185 Vali Loss: 0.3186015 Best vali loss: 0.3186015

best validation loss 0.3186014840132067

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0102123676054, 'e_layers': 2, 'learning_rate': 0.0003160343899, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.95042987375e-05
Validation loss decreased (0.2791 --> 0.2778).  Saving model state dict ...
Epoch: 4 cost time: 0.579143762588501
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2778421 Best vali loss: 0.2778421
Updating learning rate to 1.975214936875e-05
Epoch: 5 cost time: 0.3369128704071045
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2803214 Best vali loss: 0.2778421
Updating learning rate to 9.876074684375e-06
Epoch: 6 cost time: 0.3350679874420166
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2804232 Best vali loss: 0.2778421
Updating learning rate to 4.9380373421875e-06
Epoch: 7 cost time: 0.3543732166290283
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2796432 Best vali loss: 0.2778421
Updating learning rate to 2.46901867109375e-06
Epoch: 8 cost time: 0.3403482437133789
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2801578 Best vali loss: 0.2778421

best validation loss 0.2778421067263877

[INFO][smbo.py:320] Finished 1300 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0062266882032, 'e_layers': 4, 'learning_rate': 0.0013899161569, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0262946
	speed: 0.0103s/iter; left time: 85.1652s
	iters: 200, epoch: 1 | loss: 0.5226457
	speed: 0.0050s/iter; left time: 41.1496s
	iters: 300, epoch: 1 | loss: 0.7302323
	speed: 0.0050s/iter; left time: 40.4833s
	iters: 400, epoch: 1 | loss: 0.4659320
	speed: 0.0051s/iter; left time: 40.2494s
	iters: 500, epoch: 1 | loss: 0.2294168
	speed: 0.0050s/iter; left time: 39.2281s
	iters: 600, epoch: 1 | loss: 1.1765745
	speed: 0.0050s/iter; left time: 38.8362s
	iters: 700, epoch: 1 | loss: 0.4084171
	speed: 0.0050s/iter; left time: 38.4966s
	iters: 800, epoch: 1 | loss: 0.3810160
	speed: 0.0050s/iter; left time: 37.9659s
	iters: 900, epoch: 1 | loss: 0.3294446
	speed: 0.0051s/iter; left time: 37.6814s
	iters: 1000, epoch: 1 | loss: 0.8532860
	speed: 0.0050s/iter; left time: 37.0462s
Updating learning rate to 0.0013899161569
Validation loss decreased (inf --> 0.2889).  Saving model state dict ...
Epoch: 1 cost time: 5.518213987350464
Epoch: 1, Steps: 1045 | Train Loss: 0.6123260 Vali Loss: 0.2889483 Best vali loss: 0.2889483
	iters: 100, epoch: 2 | loss: 0.3608087
	speed: 0.0138s/iter; left time: 99.8356s
	iters: 200, epoch: 2 | loss: 0.3562521
	speed: 0.0050s/iter; left time: 35.8185s
	iters: 300, epoch: 2 | loss: 0.3521729
	speed: 0.0050s/iter; left time: 35.2786s
	iters: 400, epoch: 2 | loss: 1.1332374
	speed: 0.0050s/iter; left time: 34.8528s
	iters: 500, epoch: 2 | loss: 0.8175883
	speed: 0.0051s/iter; left time: 34.5436s
	iters: 600, epoch: 2 | loss: 0.1834773
	speed: 0.0050s/iter; left time: 33.8584s
	iters: 700, epoch: 2 | loss: 0.3145940
	speed: 0.0051s/iter; left time: 33.4815s
	iters: 800, epoch: 2 | loss: 0.3405477
	speed: 0.0050s/iter; left time: 32.6326s
	iters: 900, epoch: 2 | loss: 0.3666966
	speed: 0.0051s/iter; left time: 32.5597s
	iters: 1000, epoch: 2 | loss: 0.3464586
	speed: 0.0050s/iter; left time: 31.8749s
Updating learning rate to 0.00069495807845
Validation loss decreased (0.2889 --> 0.2860).  Saving model state dict ...
Epoch: 2 cost time: 5.309537410736084
Epoch: 2, Steps: 1045 | Train Loss: 0.4571834 Vali Loss: 0.2860004 Best vali loss: 0.2860004
	iters: 100, epoch: 3 | loss: 0.3489470
	speed: 0.0139s/iter; left time: 85.8104s
	iters: 200, epoch: 3 | loss: 0.1471002
	speed: 0.0051s/iter; left time: 30.7057s
	iters: 300, epoch: 3 | loss: 1.0137354
	speed: 0.0050s/iter; left time: 29.8473s
	iters: 400, epoch: 3 | loss: 0.2432245
	speed: 0.0050s/iter; left time: 29.3782s
	iters: 500, epoch: 3 | loss: 0.2207648
	speed: 0.0050s/iter; left time: 29.1392s
	iters: 600, epoch: 3 | loss: 0.5944488
	speed: 0.0050s/iter; left time: 28.1064s
	iters: 700, epoch: 3 | loss: 0.2086827
	speed: 0.0049s/iter; left time: 27.1266s
	iters: 800, epoch: 3 | loss: 1.0785724
	speed: 0.0048s/iter; left time: 26.4819s
	iters: 900, epoch: 3 | loss: 0.5458108
	speed: 0.0049s/iter; left time: 26.1043s
	iters: 1000, epoch: 3 | loss: 0.2370582
	speed: 0.0048s/iter; left time: 25.1614s
Updating learning rate to 0.000347479039225
Epoch: 3 cost time: 5.190657377243042
Epoch: 3, Steps: 1045 | Train Loss: 0.4638345 Vali Loss: 0.2887348 Best vali loss: 0.2860004
	iters: 100, epoch: 4 | loss: 1.2656920
	speed: 0.0133s/iter; left time: 68.2528s
	iters: 200, epoch: 4 | loss: 0.3342527
	speed: 0.0047s/iter; left time: 23.6708s
	iters: 300, epoch: 4 | loss: 0.3189473
	speed: 0.0049s/iter; left time: 23.9747s
	iters: 400, epoch: 4 | loss: 0.3284614
	speed: 0.0050s/iter; left time: 24.3560s
	iters: 500, epoch: 4 | loss: 1.0061382
	speed: 0.0050s/iter; left time: 23.7266s
	iters: 600, epoch: 4 | loss: 0.2491675
	speed: 0.0051s/iter; left time: 23.4069s
	iters: 700, epoch: 4 | loss: 0.7565970
	speed: 0.0050s/iter; left time: 22.8118s
	iters: 800, epoch: 4 | loss: 0.2646740
	speed: 0.0050s/iter; left time: 22.2614s
	iters: 900, epoch: 4 | loss: 0.2975306
	speed: 0.0051s/iter; left time: 21.8831s
	iters: 1000, epoch: 4 | loss: 0.3528558
	speed: 0.0051s/iter; left time: 21.3577s
Updating learning rate to 0.0001737395196125
Epoch: 4 cost time: 5.226654529571533
Epoch: 4, Steps: 1045 | Train Loss: 0.5174316 Vali Loss: 0.2967953 Best vali loss: 0.2860004
	iters: 100, epoch: 5 | loss: 1.0101244
	speed: 0.0139s/iter; left time: 56.8473s
	iters: 200, epoch: 5 | loss: 0.7008232
	speed: 0.0051s/iter; left time: 20.3007s
	iters: 300, epoch: 5 | loss: 0.2859598
	speed: 0.0051s/iter; left time: 19.7612s
	iters: 400, epoch: 5 | loss: 0.5014528
	speed: 0.0051s/iter; left time: 19.2726s
	iters: 500, epoch: 5 | loss: 0.3581288
	speed: 0.0051s/iter; left time: 18.7720s
	iters: 600, epoch: 5 | loss: 0.5490078
	speed: 0.0051s/iter; left time: 18.2077s
	iters: 700, epoch: 5 | loss: 0.4793511
	speed: 0.0051s/iter; left time: 17.6052s
	iters: 800, epoch: 5 | loss: 0.5366185
	speed: 0.0051s/iter; left time: 17.3846s
	iters: 900, epoch: 5 | loss: 0.2624974
	speed: 0.0051s/iter; left time: 16.7200s
	iters: 1000, epoch: 5 | loss: 0.3011167
	speed: 0.0051s/iter; left time: 16.0756s
Updating learning rate to 8.686975980625e-05
Epoch: 5 cost time: 5.35520076751709
Epoch: 5, Steps: 1045 | Train Loss: 0.4985081 Vali Loss: 0.2940053 Best vali loss: 0.2860004
	iters: 100, epoch: 6 | loss: 0.1875857
	speed: 0.0139s/iter; left time: 42.1613s
	iters: 200, epoch: 6 | loss: 0.4033582
	speed: 0.0051s/iter; left time: 14.8318s
	iters: 300, epoch: 6 | loss: 0.3654829
	speed: 0.0050s/iter; left time: 14.2623s
	iters: 400, epoch: 6 | loss: 0.1993832
	speed: 0.0050s/iter; left time: 13.6751s
	iters: 500, epoch: 6 | loss: 0.2538306
	speed: 0.0048s/iter; left time: 12.5549s
	iters: 600, epoch: 6 | loss: 0.2769067
	speed: 0.0044s/iter; left time: 11.1738s
	iters: 700, epoch: 6 | loss: 0.4368093
	speed: 0.0044s/iter; left time: 10.6823s
	iters: 800, epoch: 6 | loss: 0.1596905
	speed: 0.0044s/iter; left time: 10.3140s
	iters: 900, epoch: 6 | loss: 0.3209727
	speed: 0.0044s/iter; left time: 9.9384s
	iters: 1000, epoch: 6 | loss: 0.4266285
	speed: 0.0045s/iter; left time: 9.6630s
Updating learning rate to 4.3434879903125e-05
Epoch: 6 cost time: 4.939945220947266
Epoch: 6, Steps: 1045 | Train Loss: 0.3030648 Vali Loss: 0.2968510 Best vali loss: 0.2860004
	iters: 100, epoch: 7 | loss: 0.5255845
	speed: 0.0136s/iter; left time: 27.1070s
	iters: 200, epoch: 7 | loss: 0.3582780
	speed: 0.0047s/iter; left time: 8.8361s
	iters: 300, epoch: 7 | loss: 0.6301863
	speed: 0.0047s/iter; left time: 8.3586s
	iters: 400, epoch: 7 | loss: 0.4828166
	speed: 0.0047s/iter; left time: 7.9084s
	iters: 500, epoch: 7 | loss: 0.5012826
	speed: 0.0047s/iter; left time: 7.4173s
	iters: 600, epoch: 7 | loss: 0.1885067
	speed: 0.0046s/iter; left time: 6.9012s
	iters: 700, epoch: 7 | loss: 0.2935242
	speed: 0.0046s/iter; left time: 6.4313s
	iters: 800, epoch: 7 | loss: 0.3419956
	speed: 0.0046s/iter; left time: 5.9211s
	iters: 900, epoch: 7 | loss: 0.3247807
	speed: 0.0046s/iter; left time: 5.5255s
	iters: 1000, epoch: 7 | loss: 0.5450378
	speed: 0.0046s/iter; left time: 5.0385s
Updating learning rate to 2.17174399515625e-05
Epoch: 7 cost time: 4.876954793930054
Epoch: 7, Steps: 1045 | Train Loss: 0.4191993 Vali Loss: 0.2964940 Best vali loss: 0.2860004
	iters: 100, epoch: 8 | loss: 0.2335894
	speed: 0.0131s/iter; left time: 12.3715s
	iters: 200, epoch: 8 | loss: 0.2665399
	speed: 0.0044s/iter; left time: 3.7416s
	iters: 300, epoch: 8 | loss: 0.6063613
	speed: 0.0045s/iter; left time: 3.3887s
	iters: 400, epoch: 8 | loss: 0.8766758
	speed: 0.0045s/iter; left time: 2.9118s
	iters: 500, epoch: 8 | loss: 0.1723313
	speed: 0.0046s/iter; left time: 2.5055s
	iters: 600, epoch: 8 | loss: 0.6343018
	speed: 0.0046s/iter; left time: 2.0321s
	iters: 700, epoch: 8 | loss: 0.1941224
	speed: 0.0046s/iter; left time: 1.6041s
	iters: 800, epoch: 8 | loss: 0.2733973
	speed: 0.0046s/iter; left time: 1.1294s
	iters: 900, epoch: 8 | loss: 1.4383544
	speed: 0.0046s/iter; left time: 0.6787s
	iters: 1000, epoch: 8 | loss: 0.3358043
	speed: 0.0045s/iter; left time: 0.2081s
Updating learning rate to 1.085871997578125e-05
Epoch: 8 cost time: 4.7773048877716064
Epoch: 8, Steps: 1045 | Train Loss: 0.5031478 Vali Loss: 0.2984417 Best vali loss: 0.2860004

best validation loss 0.28600041499010204

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0030135234332, 'e_layers': 3, 'learning_rate': 0.000520066367, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4287870
	speed: 0.0126s/iter; left time: 11.9261s
Updating learning rate to 0.0005002725195094016
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 1.1883177757263184
Epoch: 1, Steps: 131 | Train Loss: 0.4287870 Vali Loss: 0.2849431 Best vali loss: 0.2849431
	iters: 100, epoch: 2 | loss: 0.8756045
	speed: 0.0118s/iter; left time: 9.6571s
Updating learning rate to 0.0004439044108863758
Epoch: 2 cost time: 0.954559326171875
Epoch: 2, Steps: 131 | Train Loss: 0.8756045 Vali Loss: 0.2902104 Best vali loss: 0.2849431
	iters: 100, epoch: 3 | loss: 0.3813907
	speed: 0.0114s/iter; left time: 7.8627s
Updating learning rate to 0.00035954357469060124
Validation loss decreased (0.2849 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 0.9523062705993652
Epoch: 3, Steps: 131 | Train Loss: 0.3813907 Vali Loss: 0.2819380 Best vali loss: 0.2819380
	iters: 100, epoch: 4 | loss: 0.5709291
	speed: 0.0119s/iter; left time: 6.6252s
Updating learning rate to 0.0002600331835
Validation loss decreased (0.2819 --> 0.2794).  Saving model state dict ...
Epoch: 4 cost time: 0.9490833282470703
Epoch: 4, Steps: 131 | Train Loss: 0.5709291 Vali Loss: 0.2793512 Best vali loss: 0.2793512
	iters: 100, epoch: 5 | loss: 0.3435456
	speed: 0.0119s/iter; left time: 5.0787s
Updating learning rate to 0.00016052279230939877
Epoch: 5 cost time: 0.9529633522033691
Epoch: 5, Steps: 131 | Train Loss: 0.3435456 Vali Loss: 0.3008605 Best vali loss: 0.2793512
	iters: 100, epoch: 6 | loss: 0.2914079
	speed: 0.0115s/iter; left time: 3.3707s
Updating learning rate to 7.616195611362415e-05
Epoch: 6 cost time: 0.9567477703094482
Epoch: 6, Steps: 131 | Train Loss: 0.2914079 Vali Loss: 0.3079504 Best vali loss: 0.2793512
	iters: 100, epoch: 7 | loss: 0.2269967
	speed: 0.0114s/iter; left time: 1.8609s
Updating learning rate to 1.9793847490598358e-05
Epoch: 7 cost time: 0.9531874656677246
Epoch: 7, Steps: 131 | Train Loss: 0.2269967 Vali Loss: 0.3230616 Best vali loss: 0.2793512
	iters: 100, epoch: 8 | loss: 0.3712059
	speed: 0.0114s/iter; left time: 0.3659s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9545743465423584
Epoch: 8, Steps: 131 | Train Loss: 0.3712059 Vali Loss: 0.3338760 Best vali loss: 0.2793512

best validation loss 0.27935115840630975

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0030049727756, 'e_layers': 3, 'learning_rate': 0.0005082478941, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4284733
	speed: 0.0124s/iter; left time: 11.8123s
Updating learning rate to 0.000488903860450477
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 1.1950461864471436
Epoch: 1, Steps: 131 | Train Loss: 0.4284733 Vali Loss: 0.2863533 Best vali loss: 0.2863533
	iters: 100, epoch: 2 | loss: 0.8242081
	speed: 0.0118s/iter; left time: 9.6239s
Updating learning rate to 0.0004338167132709461
Validation loss decreased (0.2864 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 0.9515233039855957
Epoch: 2, Steps: 131 | Train Loss: 0.8242081 Vali Loss: 0.2836289 Best vali loss: 0.2836289
	iters: 100, epoch: 3 | loss: 0.4150584
	speed: 0.0120s/iter; left time: 8.2436s
Updating learning rate to 0.0003513729713532583
Validation loss decreased (0.2836 --> 0.2825).  Saving model state dict ...
Epoch: 3 cost time: 0.9606082439422607
Epoch: 3, Steps: 131 | Train Loss: 0.4150584 Vali Loss: 0.2825438 Best vali loss: 0.2825438

best validation loss 0.2825437552392948

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0029603106781, 'e_layers': 3, 'learning_rate': 0.0005202033028, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4283046
	speed: 0.0125s/iter; left time: 11.8669s
Updating learning rate to 0.0005004042435008457
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 1.195695161819458
Epoch: 1, Steps: 131 | Train Loss: 0.4283046 Vali Loss: 0.2839569 Best vali loss: 0.2839569
	iters: 100, epoch: 2 | loss: 0.8048403
	speed: 0.0119s/iter; left time: 9.6951s
Updating learning rate to 0.00044402129290275946
Epoch: 2 cost time: 0.957763671875
Epoch: 2, Steps: 131 | Train Loss: 0.8048403 Vali Loss: 0.2877684 Best vali loss: 0.2839569
	iters: 100, epoch: 3 | loss: 0.3597951
	speed: 0.0115s/iter; left time: 7.9058s
Updating learning rate to 0.0003596382441215801
Epoch: 3 cost time: 0.9560916423797607
Epoch: 3, Steps: 131 | Train Loss: 0.3597951 Vali Loss: 0.2849435 Best vali loss: 0.2839569

best validation loss 0.2839568982606663

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0059483885986, 'e_layers': 2, 'learning_rate': 0.0015383174869, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5909271
	speed: 0.0087s/iter; left time: 35.4370s
	iters: 200, epoch: 1 | loss: 0.3040358
	speed: 0.0033s/iter; left time: 13.2387s
	iters: 300, epoch: 1 | loss: 0.3123992
	speed: 0.0034s/iter; left time: 13.1622s
	iters: 400, epoch: 1 | loss: 0.4342460
	speed: 0.0033s/iter; left time: 12.6663s
	iters: 500, epoch: 1 | loss: 0.9494388
	speed: 0.0034s/iter; left time: 12.3497s
Updating learning rate to 0.0015383174869
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 2.018706798553467
Epoch: 1, Steps: 523 | Train Loss: 0.5182094 Vali Loss: 0.2835583 Best vali loss: 0.2835583
	iters: 100, epoch: 2 | loss: 1.2973287
	speed: 0.0072s/iter; left time: 25.8050s
	iters: 200, epoch: 2 | loss: 0.3126911
	speed: 0.0034s/iter; left time: 11.6638s
	iters: 300, epoch: 2 | loss: 0.3586405
	speed: 0.0034s/iter; left time: 11.3830s
	iters: 400, epoch: 2 | loss: 0.4351355
	speed: 0.0034s/iter; left time: 10.9595s
	iters: 500, epoch: 2 | loss: 0.6150390
	speed: 0.0033s/iter; left time: 10.5812s
Updating learning rate to 0.00076915874345
Epoch: 2 cost time: 1.7930848598480225
Epoch: 2, Steps: 523 | Train Loss: 0.6037670 Vali Loss: 0.2897951 Best vali loss: 0.2835583
	iters: 100, epoch: 3 | loss: 0.3900512
	speed: 0.0073s/iter; left time: 22.0536s
	iters: 200, epoch: 3 | loss: 0.5079040
	speed: 0.0033s/iter; left time: 9.7896s
	iters: 300, epoch: 3 | loss: 0.3159805
	speed: 0.0033s/iter; left time: 9.4885s
	iters: 400, epoch: 3 | loss: 0.9211289
	speed: 0.0033s/iter; left time: 9.0926s
	iters: 500, epoch: 3 | loss: 0.6017603
	speed: 0.0033s/iter; left time: 8.7909s
Updating learning rate to 0.000384579371725
Epoch: 3 cost time: 1.785660982131958
Epoch: 3, Steps: 523 | Train Loss: 0.5473650 Vali Loss: 0.2942156 Best vali loss: 0.2835583

best validation loss 0.2835582943820918

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0030049727756, 'e_layers': 3, 'learning_rate': 0.0005082478941, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3531474
	speed: 0.0129s/iter; left time: 7.1590s
Updating learning rate to 0.00025412394705
Epoch: 4 cost time: 1.2056026458740234
Epoch: 4, Steps: 131 | Train Loss: 0.3531474 Vali Loss: 0.2904325 Best vali loss: 0.2825438
	iters: 100, epoch: 5 | loss: 0.6048431
	speed: 0.0116s/iter; left time: 4.9100s
Updating learning rate to 0.00015687492274674166
Epoch: 5 cost time: 0.9572288990020752
Epoch: 5, Steps: 131 | Train Loss: 0.6048431 Vali Loss: 0.2945868 Best vali loss: 0.2825438
	iters: 100, epoch: 6 | loss: 0.2888341
	speed: 0.0115s/iter; left time: 3.3773s
Updating learning rate to 7.443118082905387e-05
Epoch: 6 cost time: 0.9568061828613281
Epoch: 6, Steps: 131 | Train Loss: 0.2888341 Vali Loss: 0.3003397 Best vali loss: 0.2825438
	iters: 100, epoch: 7 | loss: 0.4259614
	speed: 0.0115s/iter; left time: 1.8674s
Updating learning rate to 1.9344033649523014e-05
Epoch: 7 cost time: 0.9615421295166016
Epoch: 7, Steps: 131 | Train Loss: 0.4259614 Vali Loss: 0.3017071 Best vali loss: 0.2825438
	iters: 100, epoch: 8 | loss: 0.2894523
	speed: 0.0117s/iter; left time: 0.3734s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9596939086914062
Epoch: 8, Steps: 131 | Train Loss: 0.2894523 Vali Loss: 0.3120640 Best vali loss: 0.2825438

best validation loss 0.2825437552392948

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029509421816, 'e_layers': 3, 'learning_rate': 0.0004694063066, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6846856
	speed: 0.0109s/iter; left time: 10.3066s
Updating learning rate to 0.0004515405928497289
Validation loss decreased (inf --> 0.2885).  Saving model state dict ...
Epoch: 1 cost time: 0.9873025417327881
Epoch: 1, Steps: 131 | Train Loss: 0.6846856 Vali Loss: 0.2884980 Best vali loss: 0.2884980
	iters: 100, epoch: 2 | loss: 0.3493578
	speed: 0.0093s/iter; left time: 7.6071s
Updating learning rate to 0.0004006633445642958
Validation loss decreased (0.2885 --> 0.2791).  Saving model state dict ...
Epoch: 2 cost time: 0.7435922622680664
Epoch: 2, Steps: 131 | Train Loss: 0.3493578 Vali Loss: 0.2791439 Best vali loss: 0.2791439
	iters: 100, epoch: 3 | loss: 0.4397054
	speed: 0.0095s/iter; left time: 6.4956s
Updating learning rate to 0.0003245201615917539
Epoch: 3 cost time: 0.7304234504699707
Epoch: 3, Steps: 131 | Train Loss: 0.4397054 Vali Loss: 0.2864000 Best vali loss: 0.2791439
	iters: 100, epoch: 4 | loss: 0.3165944
	speed: 0.0091s/iter; left time: 5.0522s
Updating learning rate to 0.0002347031533
Epoch: 4 cost time: 0.742037296295166
Epoch: 4, Steps: 131 | Train Loss: 0.3165944 Vali Loss: 0.2796392 Best vali loss: 0.2791439
	iters: 100, epoch: 5 | loss: 0.2853017
	speed: 0.0092s/iter; left time: 3.8925s
Updating learning rate to 0.00014488614500824616
Epoch: 5 cost time: 0.7447752952575684
Epoch: 5, Steps: 131 | Train Loss: 0.2853017 Vali Loss: 0.2903146 Best vali loss: 0.2791439
	iters: 100, epoch: 6 | loss: 0.2669894
	speed: 0.0092s/iter; left time: 2.7138s
Updating learning rate to 6.874296203570419e-05
Epoch: 6 cost time: 0.7414581775665283
Epoch: 6, Steps: 131 | Train Loss: 0.2669894 Vali Loss: 0.2845447 Best vali loss: 0.2791439
	iters: 100, epoch: 7 | loss: 0.2766023
	speed: 0.0090s/iter; left time: 1.4673s
Updating learning rate to 1.7865713750271135e-05
Epoch: 7 cost time: 0.7278902530670166
Epoch: 7, Steps: 131 | Train Loss: 0.2766023 Vali Loss: 0.2919260 Best vali loss: 0.2791439
	iters: 100, epoch: 8 | loss: 0.3216097
	speed: 0.0091s/iter; left time: 0.2906s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7385280132293701
Epoch: 8, Steps: 131 | Train Loss: 0.3216097 Vali Loss: 0.2909717 Best vali loss: 0.2791439

best validation loss 0.2791438639585127

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029616294941, 'e_layers': 4, 'learning_rate': 0.0004707010889, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3303704
	speed: 0.0140s/iter; left time: 13.3135s
Updating learning rate to 0.0004707010889
Validation loss decreased (inf --> 0.2888).  Saving model state dict ...
Epoch: 1 cost time: 1.4059019088745117
Epoch: 1, Steps: 131 | Train Loss: 0.3303704 Vali Loss: 0.2887606 Best vali loss: 0.2887606
	iters: 100, epoch: 2 | loss: 0.4876696
	speed: 0.0144s/iter; left time: 11.7819s
Updating learning rate to 0.00023535054445
Validation loss decreased (0.2888 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 1.1841058731079102
Epoch: 2, Steps: 131 | Train Loss: 0.4876696 Vali Loss: 0.2842566 Best vali loss: 0.2842566
	iters: 100, epoch: 3 | loss: 0.4069885
	speed: 0.0146s/iter; left time: 10.0406s
Updating learning rate to 0.000117675272225
Epoch: 3 cost time: 1.1824901103973389
Epoch: 3, Steps: 131 | Train Loss: 0.4069885 Vali Loss: 0.2918864 Best vali loss: 0.2842566
	iters: 100, epoch: 4 | loss: 0.4680042
	speed: 0.0140s/iter; left time: 7.7867s
Updating learning rate to 5.88376361125e-05
Epoch: 4 cost time: 1.1778860092163086
Epoch: 4, Steps: 131 | Train Loss: 0.4680042 Vali Loss: 0.2907080 Best vali loss: 0.2842566
	iters: 100, epoch: 5 | loss: 0.2979182
	speed: 0.0140s/iter; left time: 5.9302s
Updating learning rate to 2.941881805625e-05
Epoch: 5 cost time: 1.1767301559448242
Epoch: 5, Steps: 131 | Train Loss: 0.2979182 Vali Loss: 0.2983900 Best vali loss: 0.2842566
	iters: 100, epoch: 6 | loss: 0.2912596
	speed: 0.0141s/iter; left time: 4.1488s
Updating learning rate to 1.4709409028125e-05
Epoch: 6 cost time: 1.1840906143188477
Epoch: 6, Steps: 131 | Train Loss: 0.2912596 Vali Loss: 0.3081267 Best vali loss: 0.2842566
	iters: 100, epoch: 7 | loss: 0.2660135
	speed: 0.0140s/iter; left time: 2.2822s
Updating learning rate to 7.3547045140625e-06
Epoch: 7 cost time: 1.1759388446807861
Epoch: 7, Steps: 131 | Train Loss: 0.2660135 Vali Loss: 0.3141805 Best vali loss: 0.2842566
	iters: 100, epoch: 8 | loss: 0.2873656
	speed: 0.0141s/iter; left time: 0.4500s
Updating learning rate to 3.67735225703125e-06
Epoch: 8 cost time: 1.179718255996704
Epoch: 8, Steps: 131 | Train Loss: 0.2873656 Vali Loss: 0.3163658 Best vali loss: 0.2842566

best validation loss 0.2842565839531786

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029573299506, 'e_layers': 4, 'learning_rate': 0.0004712524328, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3316170
	speed: 0.0139s/iter; left time: 13.2122s
Updating learning rate to 0.0004712524328
Validation loss decreased (inf --> 0.2889).  Saving model state dict ...
Epoch: 1 cost time: 1.4026062488555908
Epoch: 1, Steps: 131 | Train Loss: 0.3316170 Vali Loss: 0.2888748 Best vali loss: 0.2888748
	iters: 100, epoch: 2 | loss: 0.5147741
	speed: 0.0144s/iter; left time: 11.8132s
Updating learning rate to 0.0002356262164
Validation loss decreased (0.2889 --> 0.2879).  Saving model state dict ...
Epoch: 2 cost time: 1.1801013946533203
Epoch: 2, Steps: 131 | Train Loss: 0.5147741 Vali Loss: 0.2878791 Best vali loss: 0.2878791
	iters: 100, epoch: 3 | loss: 0.4052120
	speed: 0.0145s/iter; left time: 9.9691s
Updating learning rate to 0.0001178131082
Validation loss decreased (0.2879 --> 0.2826).  Saving model state dict ...
Epoch: 3 cost time: 1.1773898601531982
Epoch: 3, Steps: 131 | Train Loss: 0.4052120 Vali Loss: 0.2826333 Best vali loss: 0.2826333

best validation loss 0.2826333309292749

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029430045193, 'e_layers': 4, 'learning_rate': 0.0004733470992, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3304243
	speed: 0.0141s/iter; left time: 13.4214s
Updating learning rate to 0.0004733470992
Validation loss decreased (inf --> 0.2894).  Saving model state dict ...
Epoch: 1 cost time: 1.4227488040924072
Epoch: 1, Steps: 131 | Train Loss: 0.3304243 Vali Loss: 0.2894178 Best vali loss: 0.2894178
	iters: 100, epoch: 2 | loss: 0.4896219
	speed: 0.0145s/iter; left time: 11.8230s
Updating learning rate to 0.0002366735496
Validation loss decreased (0.2894 --> 0.2806).  Saving model state dict ...
Epoch: 2 cost time: 1.1791751384735107
Epoch: 2, Steps: 131 | Train Loss: 0.4896219 Vali Loss: 0.2805555 Best vali loss: 0.2805555
	iters: 100, epoch: 3 | loss: 0.4271907
	speed: 0.0145s/iter; left time: 9.9275s
Updating learning rate to 0.0001183367748
Epoch: 3 cost time: 1.177579402923584
Epoch: 3, Steps: 131 | Train Loss: 0.4271907 Vali Loss: 0.2833221 Best vali loss: 0.2805555

best validation loss 0.28055551786678085

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029914119281, 'e_layers': 3, 'learning_rate': 0.00047486302, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004567896224622489
Validation loss decreased (inf --> 0.2897).  Saving model state dict ...
Epoch: 1 cost time: 0.9956951141357422
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2897048 Best vali loss: 0.2897048
Updating learning rate to 0.0004053209407883615
Validation loss decreased (0.2897 --> 0.2711).  Saving model state dict ...
Epoch: 2 cost time: 0.78074049949646
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2710695 Best vali loss: 0.2710695
Updating learning rate to 0.00032829261519842616
Epoch: 3 cost time: 0.786163330078125
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2813174 Best vali loss: 0.2710695

best validation loss 0.27106945859472653

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029914119281, 'e_layers': 3, 'learning_rate': 0.00047486302, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00023743151
Epoch: 4 cost time: 1.0002925395965576
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2770596 Best vali loss: 0.2710695
Updating learning rate to 0.00014657040480157388
Epoch: 5 cost time: 0.7783851623535156
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2899660 Best vali loss: 0.2710695
Updating learning rate to 6.954207921163845e-05
Epoch: 6 cost time: 0.7794981002807617
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2979100 Best vali loss: 0.2710695
Updating learning rate to 1.80733975377511e-05
Epoch: 7 cost time: 0.7748112678527832
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3008771 Best vali loss: 0.2710695
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7887048721313477
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3030357 Best vali loss: 0.2710695

best validation loss 0.27106945859472653

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029562785811, 'e_layers': 3, 'learning_rate': 0.0004753112905, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6857291
	speed: 0.0110s/iter; left time: 10.4773s
Updating learning rate to 0.0004753112905
Validation loss decreased (inf --> 0.2881).  Saving model state dict ...
Epoch: 1 cost time: 1.0037062168121338
Epoch: 1, Steps: 131 | Train Loss: 0.6857291 Vali Loss: 0.2881112 Best vali loss: 0.2881112
	iters: 100, epoch: 2 | loss: 0.3450282
	speed: 0.0092s/iter; left time: 7.5423s
Updating learning rate to 0.00023765564525
Validation loss decreased (0.2881 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.7229259014129639
Epoch: 2, Steps: 131 | Train Loss: 0.3450282 Vali Loss: 0.2826862 Best vali loss: 0.2826862
	iters: 100, epoch: 3 | loss: 0.4135660
	speed: 0.0093s/iter; left time: 6.3967s
Updating learning rate to 0.000118827822625
Epoch: 3 cost time: 0.746117353439331
Epoch: 3, Steps: 131 | Train Loss: 0.4135660 Vali Loss: 0.2932829 Best vali loss: 0.2826862
	iters: 100, epoch: 4 | loss: 0.3060195
	speed: 0.0090s/iter; left time: 4.9967s
Updating learning rate to 5.94139113125e-05
Validation loss decreased (0.2827 --> 0.2782).  Saving model state dict ...
Epoch: 4 cost time: 0.7211258411407471
Epoch: 4, Steps: 131 | Train Loss: 0.3060195 Vali Loss: 0.2781763 Best vali loss: 0.2781763
	iters: 100, epoch: 5 | loss: 0.2940496
	speed: 0.0095s/iter; left time: 4.0432s
Updating learning rate to 2.970695565625e-05
Epoch: 5 cost time: 0.7507045269012451
Epoch: 5, Steps: 131 | Train Loss: 0.2940496 Vali Loss: 0.2865615 Best vali loss: 0.2781763
	iters: 100, epoch: 6 | loss: 0.2808295
	speed: 0.0091s/iter; left time: 2.6646s
Updating learning rate to 1.4853477828125e-05
Epoch: 6 cost time: 0.7449367046356201
Epoch: 6, Steps: 131 | Train Loss: 0.2808295 Vali Loss: 0.2869258 Best vali loss: 0.2781763
	iters: 100, epoch: 7 | loss: 0.3101663
	speed: 0.0093s/iter; left time: 1.5121s
Updating learning rate to 7.4267389140625e-06
Epoch: 7 cost time: 0.7487678527832031
Epoch: 7, Steps: 131 | Train Loss: 0.3101663 Vali Loss: 0.2883754 Best vali loss: 0.2781763
	iters: 100, epoch: 8 | loss: 0.3780399
	speed: 0.0089s/iter; left time: 0.2861s
Updating learning rate to 3.71336945703125e-06
Epoch: 8 cost time: 0.7157399654388428
Epoch: 8, Steps: 131 | Train Loss: 0.3780399 Vali Loss: 0.2878247 Best vali loss: 0.2781763

best validation loss 0.27817634745251957

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0029516808793, 'e_layers': 3, 'learning_rate': 0.0005049541154, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004857354437377012
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 1.0265276432037354
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2868168 Best vali loss: 0.2868168
Updating learning rate to 0.00043100529729369724
Epoch: 2 cost time: 0.8140988349914551
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3219972 Best vali loss: 0.2868168
Updating learning rate to 0.00034909584473407485
Epoch: 3 cost time: 0.814690113067627
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2951884 Best vali loss: 0.2868168
Updating learning rate to 0.0002524770577
Validation loss decreased (0.2868 --> 0.2831).  Saving model state dict ...
Epoch: 4 cost time: 0.8104894161224365
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2831147 Best vali loss: 0.2831147
Updating learning rate to 0.0001558582706659252
Epoch: 5 cost time: 0.8173389434814453
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2911152 Best vali loss: 0.2831147
Updating learning rate to 7.394881810630279e-05
Epoch: 6 cost time: 0.8027167320251465
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3067529 Best vali loss: 0.2831147
Updating learning rate to 1.9218671662298833e-05
Epoch: 7 cost time: 0.8078124523162842
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3113538 Best vali loss: 0.2831147
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8086588382720947
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3141969 Best vali loss: 0.2831147

best validation loss 0.28311469889941737

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0101753893511, 'e_layers': 3, 'learning_rate': 0.0003702057989, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6731542
	speed: 0.0101s/iter; left time: 9.5551s
Updating learning rate to 0.0003561156796603497
Validation loss decreased (inf --> 0.2811).  Saving model state dict ...
Epoch: 1 cost time: 0.8823606967926025
Epoch: 1, Steps: 131 | Train Loss: 0.6731542 Vali Loss: 0.2810873 Best vali loss: 0.2810873
	iters: 100, epoch: 2 | loss: 0.5216601
	speed: 0.0079s/iter; left time: 6.4983s
Updating learning rate to 0.00031599041486838665
Epoch: 2 cost time: 0.634453296661377
Epoch: 2, Steps: 131 | Train Loss: 0.5216601 Vali Loss: 0.2831369 Best vali loss: 0.2810873
	iters: 100, epoch: 3 | loss: 0.4141085
	speed: 0.0074s/iter; left time: 5.1044s
Updating learning rate to 0.0002559387123522561
Epoch: 3 cost time: 0.5912468433380127
Epoch: 3, Steps: 131 | Train Loss: 0.4141085 Vali Loss: 0.2917893 Best vali loss: 0.2810873

best validation loss 0.28108731881975463

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021056158571, 'e_layers': 4, 'learning_rate': 0.0005059875591, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3361116
	speed: 0.0140s/iter; left time: 13.2689s
Updating learning rate to 0.0004867295543289175
Validation loss decreased (inf --> 0.2905).  Saving model state dict ...
Epoch: 1 cost time: 1.399977207183838
Epoch: 1, Steps: 131 | Train Loss: 0.3361116 Vali Loss: 0.2904515 Best vali loss: 0.2904515
	iters: 100, epoch: 2 | loss: 0.5001564
	speed: 0.0144s/iter; left time: 11.7858s
Updating learning rate to 0.00043188739666781946
Epoch: 2 cost time: 1.1824612617492676
Epoch: 2, Steps: 131 | Train Loss: 0.5001564 Vali Loss: 0.2920914 Best vali loss: 0.2904515
	iters: 100, epoch: 3 | loss: 0.4500343
	speed: 0.0141s/iter; left time: 9.6858s
Updating learning rate to 0.00034981030747521086
Epoch: 3 cost time: 1.1877069473266602
Epoch: 3, Steps: 131 | Train Loss: 0.4500343 Vali Loss: 0.2909140 Best vali loss: 0.2904515

best validation loss 0.290451498651602

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029870051061, 'e_layers': 3, 'learning_rate': 0.0004694415863, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5212348
	speed: 0.0121s/iter; left time: 11.4818s
Updating learning rate to 0.0004694415863
Validation loss decreased (inf --> 0.2931).  Saving model state dict ...
Epoch: 1 cost time: 1.1491117477416992
Epoch: 1, Steps: 131 | Train Loss: 0.5212348 Vali Loss: 0.2930987 Best vali loss: 0.2930987
	iters: 100, epoch: 2 | loss: 0.5307866
	speed: 0.0114s/iter; left time: 9.3146s
Updating learning rate to 0.00023472079315
Validation loss decreased (0.2931 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 0.9191808700561523
Epoch: 2, Steps: 131 | Train Loss: 0.5307866 Vali Loss: 0.2824965 Best vali loss: 0.2824965
	iters: 100, epoch: 3 | loss: 0.5373825
	speed: 0.0115s/iter; left time: 7.8791s
Updating learning rate to 0.000117360396575
Epoch: 3 cost time: 0.9265847206115723
Epoch: 3, Steps: 131 | Train Loss: 0.5373825 Vali Loss: 0.2955270 Best vali loss: 0.2824965

best validation loss 0.2824965156268435

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0101753893511, 'e_layers': 3, 'learning_rate': 0.0003702057989, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6125345
	speed: 0.0106s/iter; left time: 5.8664s
Updating learning rate to 0.00018510289945
Epoch: 4 cost time: 0.9230527877807617
Epoch: 4, Steps: 131 | Train Loss: 0.6125345 Vali Loss: 0.2856613 Best vali loss: 0.2810873
	iters: 100, epoch: 5 | loss: 0.3861600
	speed: 0.0080s/iter; left time: 3.4004s
Updating learning rate to 0.00011426708654774392
Epoch: 5 cost time: 0.6464667320251465
Epoch: 5, Steps: 131 | Train Loss: 0.3861600 Vali Loss: 0.2823368 Best vali loss: 0.2810873
	iters: 100, epoch: 6 | loss: 0.3869249
	speed: 0.0077s/iter; left time: 2.2492s
Updating learning rate to 5.4215384031613356e-05
Epoch: 6 cost time: 0.6212422847747803
Epoch: 6, Steps: 131 | Train Loss: 0.3869249 Vali Loss: 0.2894733 Best vali loss: 0.2810873
	iters: 100, epoch: 7 | loss: 0.4176005
	speed: 0.0078s/iter; left time: 1.2732s
Updating learning rate to 1.4090119239650284e-05
Epoch: 7 cost time: 0.6535568237304688
Epoch: 7, Steps: 131 | Train Loss: 0.4176005 Vali Loss: 0.2944383 Best vali loss: 0.2810873
	iters: 100, epoch: 8 | loss: 0.3096899
	speed: 0.0081s/iter; left time: 0.2594s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6750011444091797
Epoch: 8, Steps: 131 | Train Loss: 0.3096899 Vali Loss: 0.2894035 Best vali loss: 0.2810873

best validation loss 0.28108731881975463

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009731217461, 'e_layers': 3, 'learning_rate': 0.0004886776863, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4369018
	speed: 0.0122s/iter; left time: 11.5499s
Updating learning rate to 0.0004700784993337706
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 1.152480125427246
Epoch: 1, Steps: 131 | Train Loss: 0.4369018 Vali Loss: 0.2798975 Best vali loss: 0.2798975
	iters: 100, epoch: 2 | loss: 0.4409088
	speed: 0.0114s/iter; left time: 9.3447s
Updating learning rate to 0.00041711249604864116
Epoch: 2 cost time: 0.9242455959320068
Epoch: 2, Steps: 131 | Train Loss: 0.4409088 Vali Loss: 0.2826096 Best vali loss: 0.2798975
	iters: 100, epoch: 3 | loss: 0.4102086
	speed: 0.0112s/iter; left time: 7.6682s
Updating learning rate to 0.0003378432703067573
Epoch: 3 cost time: 0.9224667549133301
Epoch: 3, Steps: 131 | Train Loss: 0.4102086 Vali Loss: 0.2811938 Best vali loss: 0.2798975
	iters: 100, epoch: 4 | loss: 0.5601280
	speed: 0.0111s/iter; left time: 6.1693s
Updating learning rate to 0.00024433884315
Epoch: 4 cost time: 0.9202682971954346
Epoch: 4, Steps: 131 | Train Loss: 0.5601280 Vali Loss: 0.2891723 Best vali loss: 0.2798975
	iters: 100, epoch: 5 | loss: 0.3558483
	speed: 0.0112s/iter; left time: 4.7407s
Updating learning rate to 0.0001508344159932427
Epoch: 5 cost time: 0.9159207344055176
Epoch: 5, Steps: 131 | Train Loss: 0.3558483 Vali Loss: 0.2925248 Best vali loss: 0.2798975
	iters: 100, epoch: 6 | loss: 0.2698514
	speed: 0.0111s/iter; left time: 3.2582s
Updating learning rate to 7.156519025135881e-05
Epoch: 6 cost time: 0.9242064952850342
Epoch: 6, Steps: 131 | Train Loss: 0.2698514 Vali Loss: 0.3039304 Best vali loss: 0.2798975
	iters: 100, epoch: 7 | loss: 0.4437101
	speed: 0.0113s/iter; left time: 1.8363s
Updating learning rate to 1.8599186966229383e-05
Epoch: 7 cost time: 0.925511360168457
Epoch: 7, Steps: 131 | Train Loss: 0.4437101 Vali Loss: 0.3108205 Best vali loss: 0.2798975
	iters: 100, epoch: 8 | loss: 0.2379783
	speed: 0.0111s/iter; left time: 0.3540s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9147098064422607
Epoch: 8, Steps: 131 | Train Loss: 0.2379783 Vali Loss: 0.3177721 Best vali loss: 0.2798975

best validation loss 0.2798975111383982

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.007755673957, 'e_layers': 4, 'learning_rate': 0.0014176417194, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6881599
	speed: 0.0117s/iter; left time: 11.0943s
Updating learning rate to 0.0014176417194
Validation loss decreased (inf --> 0.3031).  Saving model state dict ...
Epoch: 1 cost time: 1.0686180591583252
Epoch: 1, Steps: 131 | Train Loss: 0.6881599 Vali Loss: 0.3031401 Best vali loss: 0.3031401
	iters: 100, epoch: 2 | loss: 0.4682851
	speed: 0.0099s/iter; left time: 8.1231s
Updating learning rate to 0.0007088208597
Validation loss decreased (0.3031 --> 0.3023).  Saving model state dict ...
Epoch: 2 cost time: 0.8147404193878174
Epoch: 2, Steps: 131 | Train Loss: 0.4682851 Vali Loss: 0.3023392 Best vali loss: 0.3023392
	iters: 100, epoch: 3 | loss: 0.6191511
	speed: 0.0102s/iter; left time: 6.9976s
Updating learning rate to 0.00035441042985
Epoch: 3 cost time: 0.825613260269165
Epoch: 3, Steps: 131 | Train Loss: 0.6191511 Vali Loss: 0.3069689 Best vali loss: 0.3023392
	iters: 100, epoch: 4 | loss: 0.6485826
	speed: 0.0100s/iter; left time: 5.5664s
Updating learning rate to 0.000177205214925
Validation loss decreased (0.3023 --> 0.2980).  Saving model state dict ...
Epoch: 4 cost time: 0.8333561420440674
Epoch: 4, Steps: 131 | Train Loss: 0.6485826 Vali Loss: 0.2979676 Best vali loss: 0.2979676
	iters: 100, epoch: 5 | loss: 0.4728295
	speed: 0.0101s/iter; left time: 4.2725s
Updating learning rate to 8.86026074625e-05
Epoch: 5 cost time: 0.8235113620758057
Epoch: 5, Steps: 131 | Train Loss: 0.4728295 Vali Loss: 0.3022152 Best vali loss: 0.2979676
	iters: 100, epoch: 6 | loss: 0.6511724
	speed: 0.0099s/iter; left time: 2.8984s
Updating learning rate to 4.430130373125e-05
Epoch: 6 cost time: 0.8309128284454346
Epoch: 6, Steps: 131 | Train Loss: 0.6511724 Vali Loss: 0.3046820 Best vali loss: 0.2979676
	iters: 100, epoch: 7 | loss: 0.5352263
	speed: 0.0098s/iter; left time: 1.6048s
Updating learning rate to 2.2150651865625e-05
Epoch: 7 cost time: 0.8263094425201416
Epoch: 7, Steps: 131 | Train Loss: 0.5352263 Vali Loss: 0.3023530 Best vali loss: 0.2979676
	iters: 100, epoch: 8 | loss: 0.5913677
	speed: 0.0097s/iter; left time: 0.3116s
Updating learning rate to 1.10753259328125e-05
Epoch: 8 cost time: 0.8212525844573975
Epoch: 8, Steps: 131 | Train Loss: 0.5913677 Vali Loss: 0.3025011 Best vali loss: 0.2979676

best validation loss 0.29796757819750974

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008936536053, 'e_layers': 2, 'learning_rate': 0.0011307633713, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0011307633713
Validation loss decreased (inf --> 0.2903).  Saving model state dict ...
Epoch: 1 cost time: 0.5497939586639404
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2903085 Best vali loss: 0.2903085
Updating learning rate to 0.00056538168565
Validation loss decreased (0.2903 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 0.31429266929626465
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2837818 Best vali loss: 0.2837818
Updating learning rate to 0.000282690842825
Epoch: 3 cost time: 0.3194613456726074
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2852590 Best vali loss: 0.2837818

best validation loss 0.28378184705518267

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0083385729022, 'e_layers': 3, 'learning_rate': 0.0004754402966, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9983255
	speed: 0.0100s/iter; left time: 40.6887s
	iters: 200, epoch: 1 | loss: 1.6104985
	speed: 0.0045s/iter; left time: 17.8268s
	iters: 300, epoch: 1 | loss: 0.3700340
	speed: 0.0045s/iter; left time: 17.4525s
	iters: 400, epoch: 1 | loss: 1.6045705
	speed: 0.0045s/iter; left time: 16.9784s
	iters: 500, epoch: 1 | loss: 0.3565503
	speed: 0.0045s/iter; left time: 16.4438s
Updating learning rate to 0.0004573449277799177
Validation loss decreased (inf --> 0.3015).  Saving model state dict ...
Epoch: 1 cost time: 2.6095950603485107
Epoch: 1, Steps: 523 | Train Loss: 0.9879958 Vali Loss: 0.3015320 Best vali loss: 0.3015320
	iters: 100, epoch: 2 | loss: 0.5185507
	speed: 0.0093s/iter; left time: 33.0129s
	iters: 200, epoch: 2 | loss: 0.4584955
	speed: 0.0043s/iter; left time: 15.0334s
	iters: 300, epoch: 2 | loss: 0.3266322
	speed: 0.0042s/iter; left time: 14.2731s
	iters: 400, epoch: 2 | loss: 0.6742139
	speed: 0.0041s/iter; left time: 13.3116s
	iters: 500, epoch: 2 | loss: 0.2721390
	speed: 0.0043s/iter; left time: 13.7283s
Updating learning rate to 0.0004058136771876017
Validation loss decreased (0.3015 --> 0.2956).  Saving model state dict ...
Epoch: 2 cost time: 2.274440288543701
Epoch: 2, Steps: 523 | Train Loss: 0.4500063 Vali Loss: 0.2956431 Best vali loss: 0.2956431
	iters: 100, epoch: 3 | loss: 0.3210117
	speed: 0.0095s/iter; left time: 28.8862s
	iters: 200, epoch: 3 | loss: 0.7823684
	speed: 0.0044s/iter; left time: 12.9343s
	iters: 300, epoch: 3 | loss: 0.2461600
	speed: 0.0044s/iter; left time: 12.5491s
	iters: 400, epoch: 3 | loss: 0.2919481
	speed: 0.0044s/iter; left time: 12.1386s
	iters: 500, epoch: 3 | loss: 0.8698725
	speed: 0.0044s/iter; left time: 11.6432s
Updating learning rate to 0.00032869171059378215
Epoch: 3 cost time: 2.3482275009155273
Epoch: 3, Steps: 523 | Train Loss: 0.5022721 Vali Loss: 0.3160739 Best vali loss: 0.2956431

best validation loss 0.29564307841194215

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0020586414198, 'e_layers': 3, 'learning_rate': 0.0005006827357, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5360204
	speed: 0.0128s/iter; left time: 12.1269s
Updating learning rate to 0.000481626633747494
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 1.2269344329833984
Epoch: 1, Steps: 131 | Train Loss: 0.5360204 Vali Loss: 0.2841506 Best vali loss: 0.2841506
	iters: 100, epoch: 2 | loss: 0.4589865
	speed: 0.0124s/iter; left time: 10.1702s
Updating learning rate to 0.00042735944666825093
Epoch: 2 cost time: 1.0044574737548828
Epoch: 2, Steps: 131 | Train Loss: 0.4589865 Vali Loss: 0.2869536 Best vali loss: 0.2841506
	iters: 100, epoch: 3 | loss: 0.3311916
	speed: 0.0119s/iter; left time: 8.2019s
Updating learning rate to 0.0003461428617618095
Epoch: 3 cost time: 0.9962558746337891
Epoch: 3, Steps: 131 | Train Loss: 0.3311916 Vali Loss: 0.3036553 Best vali loss: 0.2841506

best validation loss 0.284150576083888

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008936536053, 'e_layers': 2, 'learning_rate': 0.0011307633713, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001413454214125
Epoch: 4 cost time: 0.5553297996520996
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2849613 Best vali loss: 0.2837818
Updating learning rate to 7.067271070625e-05
Epoch: 5 cost time: 0.3055839538574219
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2859385 Best vali loss: 0.2837818
Updating learning rate to 3.5336355353125e-05
Epoch: 6 cost time: 0.33301520347595215
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2861208 Best vali loss: 0.2837818
Updating learning rate to 1.76681776765625e-05
Epoch: 7 cost time: 0.3256838321685791
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2857929 Best vali loss: 0.2837818
Updating learning rate to 8.83408883828125e-06
Epoch: 8 cost time: 0.3255958557128906
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2858106 Best vali loss: 0.2837818

best validation loss 0.28378184705518267

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0008262510422, 'e_layers': 1, 'learning_rate': 0.0005183008541, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2455257
	speed: 0.0077s/iter; left time: 63.9777s
	iters: 200, epoch: 1 | loss: 1.1010828
	speed: 0.0024s/iter; left time: 19.4931s
	iters: 300, epoch: 1 | loss: 0.2659319
	speed: 0.0024s/iter; left time: 19.3087s
	iters: 400, epoch: 1 | loss: 0.3594224
	speed: 0.0024s/iter; left time: 18.9801s
	iters: 500, epoch: 1 | loss: 0.2869549
	speed: 0.0024s/iter; left time: 18.9392s
	iters: 600, epoch: 1 | loss: 0.7753894
	speed: 0.0024s/iter; left time: 18.5484s
	iters: 700, epoch: 1 | loss: 0.2034542
	speed: 0.0024s/iter; left time: 18.1569s
	iters: 800, epoch: 1 | loss: 0.7049331
	speed: 0.0024s/iter; left time: 17.9426s
	iters: 900, epoch: 1 | loss: 0.2325640
	speed: 0.0023s/iter; left time: 17.4449s
	iters: 1000, epoch: 1 | loss: 1.4937023
	speed: 0.0024s/iter; left time: 17.5630s
Updating learning rate to 0.0005183008541
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 2.7563040256500244
Epoch: 1, Steps: 1045 | Train Loss: 0.5668961 Vali Loss: 0.2845020 Best vali loss: 0.2845020
	iters: 100, epoch: 2 | loss: 1.2811394
	speed: 0.0082s/iter; left time: 59.1865s
	iters: 200, epoch: 2 | loss: 0.3130702
	speed: 0.0025s/iter; left time: 17.9864s
	iters: 300, epoch: 2 | loss: 0.8716125
	speed: 0.0024s/iter; left time: 17.0592s
	iters: 400, epoch: 2 | loss: 0.2716858
	speed: 0.0025s/iter; left time: 17.1578s
	iters: 500, epoch: 2 | loss: 1.4990953
	speed: 0.0025s/iter; left time: 16.7864s
	iters: 600, epoch: 2 | loss: 0.8372549
	speed: 0.0025s/iter; left time: 16.5631s
	iters: 700, epoch: 2 | loss: 1.6608196
	speed: 0.0025s/iter; left time: 16.6207s
	iters: 800, epoch: 2 | loss: 1.0342271
	speed: 0.0024s/iter; left time: 15.4856s
	iters: 900, epoch: 2 | loss: 0.6523616
	speed: 0.0024s/iter; left time: 15.2131s
	iters: 1000, epoch: 2 | loss: 1.7594957
	speed: 0.0024s/iter; left time: 15.1604s
Updating learning rate to 0.00025915042705
Epoch: 2 cost time: 2.5921454429626465
Epoch: 2, Steps: 1045 | Train Loss: 1.0180762 Vali Loss: 0.2856992 Best vali loss: 0.2845020
	iters: 100, epoch: 3 | loss: 0.3082497
	speed: 0.0081s/iter; left time: 50.1331s
	iters: 200, epoch: 3 | loss: 0.2408112
	speed: 0.0025s/iter; left time: 15.0015s
	iters: 300, epoch: 3 | loss: 0.3736312
	speed: 0.0025s/iter; left time: 14.6911s
	iters: 400, epoch: 3 | loss: 0.1439134
	speed: 0.0023s/iter; left time: 13.7877s
	iters: 500, epoch: 3 | loss: 0.5225167
	speed: 0.0023s/iter; left time: 13.0742s
	iters: 600, epoch: 3 | loss: 0.2196041
	speed: 0.0022s/iter; left time: 12.7253s
	iters: 700, epoch: 3 | loss: 0.3024430
	speed: 0.0023s/iter; left time: 12.5651s
	iters: 800, epoch: 3 | loss: 0.2829206
	speed: 0.0022s/iter; left time: 11.8686s
	iters: 900, epoch: 3 | loss: 0.1811618
	speed: 0.0021s/iter; left time: 11.1887s
	iters: 1000, epoch: 3 | loss: 0.4593356
	speed: 0.0021s/iter; left time: 10.9843s
Updating learning rate to 0.000129575213525
Epoch: 3 cost time: 2.4122159481048584
Epoch: 3, Steps: 1045 | Train Loss: 0.3034587 Vali Loss: 0.2949489 Best vali loss: 0.2845020
	iters: 100, epoch: 4 | loss: 0.3914008
	speed: 0.0082s/iter; left time: 41.9136s
	iters: 200, epoch: 4 | loss: 0.6340629
	speed: 0.0025s/iter; left time: 12.3704s
	iters: 300, epoch: 4 | loss: 0.2936970
	speed: 0.0025s/iter; left time: 12.1033s
	iters: 400, epoch: 4 | loss: 0.2620755
	speed: 0.0024s/iter; left time: 11.7413s
	iters: 500, epoch: 4 | loss: 0.2578622
	speed: 0.0021s/iter; left time: 9.8522s
	iters: 600, epoch: 4 | loss: 0.9064770
	speed: 0.0021s/iter; left time: 9.5567s
	iters: 700, epoch: 4 | loss: 0.4354208
	speed: 0.0021s/iter; left time: 9.3326s
	iters: 800, epoch: 4 | loss: 0.2588313
	speed: 0.0021s/iter; left time: 9.3256s
	iters: 900, epoch: 4 | loss: 1.6322223
	speed: 0.0021s/iter; left time: 8.9636s
	iters: 1000, epoch: 4 | loss: 0.2832748
	speed: 0.0021s/iter; left time: 8.6983s
Updating learning rate to 6.47876067625e-05
Epoch: 4 cost time: 2.3619742393493652
Epoch: 4, Steps: 1045 | Train Loss: 0.5355325 Vali Loss: 0.2940952 Best vali loss: 0.2845020
	iters: 100, epoch: 5 | loss: 0.6073970
	speed: 0.0074s/iter; left time: 30.2474s
	iters: 200, epoch: 5 | loss: 0.2777823
	speed: 0.0021s/iter; left time: 8.2531s
	iters: 300, epoch: 5 | loss: 0.2801578
	speed: 0.0020s/iter; left time: 7.8195s
	iters: 400, epoch: 5 | loss: 0.2319387
	speed: 0.0021s/iter; left time: 7.8668s
	iters: 500, epoch: 5 | loss: 0.3128906
	speed: 0.0021s/iter; left time: 7.6142s
	iters: 600, epoch: 5 | loss: 0.2262918
	speed: 0.0020s/iter; left time: 7.3294s
	iters: 700, epoch: 5 | loss: 0.2585233
	speed: 0.0023s/iter; left time: 8.0968s
	iters: 800, epoch: 5 | loss: 0.5955517
	speed: 0.0023s/iter; left time: 7.7793s
	iters: 900, epoch: 5 | loss: 0.1764058
	speed: 0.0021s/iter; left time: 6.7808s
	iters: 1000, epoch: 5 | loss: 0.8449764
	speed: 0.0020s/iter; left time: 6.3641s
Updating learning rate to 3.239380338125e-05
Epoch: 5 cost time: 2.2457995414733887
Epoch: 5, Steps: 1045 | Train Loss: 0.3811915 Vali Loss: 0.3021654 Best vali loss: 0.2845020
	iters: 100, epoch: 6 | loss: 0.1843605
	speed: 0.0081s/iter; left time: 24.6458s
	iters: 200, epoch: 6 | loss: 0.3274286
	speed: 0.0024s/iter; left time: 7.0552s
	iters: 300, epoch: 6 | loss: 0.4719316
	speed: 0.0024s/iter; left time: 6.8003s
	iters: 400, epoch: 6 | loss: 0.5140246
	speed: 0.0024s/iter; left time: 6.6046s
	iters: 500, epoch: 6 | loss: 0.1835350
	speed: 0.0024s/iter; left time: 6.2487s
	iters: 600, epoch: 6 | loss: 0.2534752
	speed: 0.0024s/iter; left time: 6.1899s
	iters: 700, epoch: 6 | loss: 0.4409277
	speed: 0.0025s/iter; left time: 6.0808s
	iters: 800, epoch: 6 | loss: 0.1923630
	speed: 0.0024s/iter; left time: 5.6127s
	iters: 900, epoch: 6 | loss: 0.7596262
	speed: 0.0024s/iter; left time: 5.3238s
	iters: 1000, epoch: 6 | loss: 0.3970742
	speed: 0.0024s/iter; left time: 5.1068s
Updating learning rate to 1.6196901690625e-05
Epoch: 6 cost time: 2.5522983074188232
Epoch: 6, Steps: 1045 | Train Loss: 0.3724747 Vali Loss: 0.3000445 Best vali loss: 0.2845020
	iters: 100, epoch: 7 | loss: 0.2747899
	speed: 0.0083s/iter; left time: 16.4735s
	iters: 200, epoch: 7 | loss: 0.3075512
	speed: 0.0024s/iter; left time: 4.5173s
	iters: 300, epoch: 7 | loss: 0.2540788
	speed: 0.0024s/iter; left time: 4.2535s
	iters: 400, epoch: 7 | loss: 0.4404252
	speed: 0.0022s/iter; left time: 3.8015s
	iters: 500, epoch: 7 | loss: 0.3734584
	speed: 0.0022s/iter; left time: 3.4704s
	iters: 600, epoch: 7 | loss: 0.4262594
	speed: 0.0022s/iter; left time: 3.2726s
	iters: 700, epoch: 7 | loss: 0.3644004
	speed: 0.0022s/iter; left time: 3.0509s
	iters: 800, epoch: 7 | loss: 0.5409851
	speed: 0.0021s/iter; left time: 2.7639s
	iters: 900, epoch: 7 | loss: 0.9251664
	speed: 0.0021s/iter; left time: 2.5127s
	iters: 1000, epoch: 7 | loss: 0.3702833
	speed: 0.0022s/iter; left time: 2.3772s
Updating learning rate to 8.0984508453125e-06
Epoch: 7 cost time: 2.3633861541748047
Epoch: 7, Steps: 1045 | Train Loss: 0.4277398 Vali Loss: 0.3000260 Best vali loss: 0.2845020
	iters: 100, epoch: 8 | loss: 0.2709048
	speed: 0.0075s/iter; left time: 7.0841s
	iters: 200, epoch: 8 | loss: 0.2093036
	speed: 0.0022s/iter; left time: 1.8479s
	iters: 300, epoch: 8 | loss: 1.1314975
	speed: 0.0022s/iter; left time: 1.6091s
	iters: 400, epoch: 8 | loss: 0.5038667
	speed: 0.0021s/iter; left time: 1.3860s
	iters: 500, epoch: 8 | loss: 0.1665584
	speed: 0.0021s/iter; left time: 1.1617s
	iters: 600, epoch: 8 | loss: 0.3384596
	speed: 0.0021s/iter; left time: 0.9449s
	iters: 700, epoch: 8 | loss: 0.3072395
	speed: 0.0021s/iter; left time: 0.7267s
	iters: 800, epoch: 8 | loss: 0.4531018
	speed: 0.0021s/iter; left time: 0.5260s
	iters: 900, epoch: 8 | loss: 0.3024727
	speed: 0.0021s/iter; left time: 0.3080s
	iters: 1000, epoch: 8 | loss: 0.1770986
	speed: 0.0021s/iter; left time: 0.0963s
Updating learning rate to 4.04922542265625e-06
Epoch: 8 cost time: 2.2591516971588135
Epoch: 8, Steps: 1045 | Train Loss: 0.3860503 Vali Loss: 0.3002331 Best vali loss: 0.2845020

best validation loss 0.2845020355700383

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.000827224008, 'e_layers': 1, 'learning_rate': 0.0033442957191, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0032170110423208028
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 0.4984447956085205
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2846562 Best vali loss: 0.2846562
Updating learning rate to 0.0028545349501843758
Epoch: 2 cost time: 0.26905298233032227
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2865477 Best vali loss: 0.2846562
Updating learning rate to 0.002312051141864532
Epoch: 3 cost time: 0.27263736724853516
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3031391 Best vali loss: 0.2846562
Updating learning rate to 0.00167214785955
Epoch: 4 cost time: 0.2635312080383301
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3091366 Best vali loss: 0.2846562
Updating learning rate to 0.001032244577235468
Epoch: 5 cost time: 0.2742762565612793
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3041960 Best vali loss: 0.2846562
Updating learning rate to 0.0004897607689156245
Epoch: 6 cost time: 0.2760601043701172
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3122494 Best vali loss: 0.2846562
Updating learning rate to 0.00012728467677919724
Epoch: 7 cost time: 0.2702810764312744
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3138605 Best vali loss: 0.2846562
Updating learning rate to 0.0
Epoch: 8 cost time: 0.27260351181030273
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3135161 Best vali loss: 0.2846562

best validation loss 0.28465619925984487

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025473956795, 'e_layers': 3, 'learning_rate': 0.0004690396139, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5221004
	speed: 0.0122s/iter; left time: 11.5363s
Updating learning rate to 0.0004511878565596032
Validation loss decreased (inf --> 0.2930).  Saving model state dict ...
Epoch: 1 cost time: 1.1482315063476562
Epoch: 1, Steps: 131 | Train Loss: 0.5221004 Vali Loss: 0.2929611 Best vali loss: 0.2929611
	iters: 100, epoch: 2 | loss: 0.5552961
	speed: 0.0113s/iter; left time: 9.2069s
Updating learning rate to 0.000400350352766905
Epoch: 2 cost time: 0.910714864730835
Epoch: 2, Steps: 131 | Train Loss: 0.5552961 Vali Loss: 0.2987421 Best vali loss: 0.2929611
	iters: 100, epoch: 3 | loss: 0.5233953
	speed: 0.0109s/iter; left time: 7.4980s
Updating learning rate to 0.0003242666516312242
Validation loss decreased (0.2930 --> 0.2917).  Saving model state dict ...
Epoch: 3 cost time: 0.9015383720397949
Epoch: 3, Steps: 131 | Train Loss: 0.5233953 Vali Loss: 0.2916779 Best vali loss: 0.2916779

best validation loss 0.2916778658415226

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047275695897, 'e_layers': 4, 'learning_rate': 0.0001531465739, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00014731777950021863
Validation loss decreased (inf --> 0.3111).  Saving model state dict ...
Epoch: 1 cost time: 0.6750442981719971
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3110544 Best vali loss: 0.3110544
Updating learning rate to 0.00013071877741008836
Validation loss decreased (0.3111 --> 0.2952).  Saving model state dict ...
Epoch: 2 cost time: 0.45450353622436523
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2951873 Best vali loss: 0.2951873
Updating learning rate to 0.00010587661522750295
Validation loss decreased (0.2952 --> 0.2881).  Saving model state dict ...
Epoch: 3 cost time: 0.4535953998565674
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2880759 Best vali loss: 0.2880759

best validation loss 0.2880758550773105

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029843569008, 'e_layers': 3, 'learning_rate': 0.0005073655874, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5280515
	speed: 0.0121s/iter; left time: 11.4717s
Updating learning rate to 0.0004880551345497132
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 1.145704746246338
Epoch: 1, Steps: 131 | Train Loss: 0.5280515 Vali Loss: 0.2805083 Best vali loss: 0.2805083
	iters: 100, epoch: 2 | loss: 0.6047356
	speed: 0.0114s/iter; left time: 9.2937s
Updating learning rate to 0.000433063617395618
Validation loss decreased (0.2805 --> 0.2793).  Saving model state dict ...
Epoch: 2 cost time: 0.9109785556793213
Epoch: 2, Steps: 131 | Train Loss: 0.6047356 Vali Loss: 0.2792701 Best vali loss: 0.2792701
	iters: 100, epoch: 3 | loss: 0.5195378
	speed: 0.0115s/iter; left time: 7.8744s
Updating learning rate to 0.000350762995925081
Epoch: 3 cost time: 0.9126317501068115
Epoch: 3, Steps: 131 | Train Loss: 0.5195378 Vali Loss: 0.2883517 Best vali loss: 0.2792701

best validation loss 0.2792701298040544

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029843569008, 'e_layers': 3, 'learning_rate': 0.0005073655874, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3738659
	speed: 0.0124s/iter; left time: 6.9026s
Updating learning rate to 0.0002536827937
Validation loss decreased (0.2793 --> 0.2792).  Saving model state dict ...
Epoch: 4 cost time: 1.1383161544799805
Epoch: 4, Steps: 131 | Train Loss: 0.3738659 Vali Loss: 0.2791579 Best vali loss: 0.2791579
	iters: 100, epoch: 5 | loss: 0.3095148
	speed: 0.0115s/iter; left time: 4.8820s
Updating learning rate to 0.00015660259147491905
Epoch: 5 cost time: 0.9126396179199219
Epoch: 5, Steps: 131 | Train Loss: 0.3095148 Vali Loss: 0.2894620 Best vali loss: 0.2791579
	iters: 100, epoch: 6 | loss: 0.3327251
	speed: 0.0111s/iter; left time: 3.2566s
Updating learning rate to 7.430197000438204e-05
Epoch: 6 cost time: 0.9076979160308838
Epoch: 6, Steps: 131 | Train Loss: 0.3327251 Vali Loss: 0.2953059 Best vali loss: 0.2791579
	iters: 100, epoch: 7 | loss: 0.2302109
	speed: 0.0109s/iter; left time: 1.7811s
Updating learning rate to 1.9310452850286804e-05
Epoch: 7 cost time: 0.9075107574462891
Epoch: 7, Steps: 131 | Train Loss: 0.2302109 Vali Loss: 0.3068868 Best vali loss: 0.2791579
	iters: 100, epoch: 8 | loss: 0.2599114
	speed: 0.0109s/iter; left time: 0.3488s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.905442476272583
Epoch: 8, Steps: 131 | Train Loss: 0.2599114 Vali Loss: 0.3064145 Best vali loss: 0.2791579

best validation loss 0.2791579213670835

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270163229, 'e_layers': 2, 'learning_rate': 0.0002345024711, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597091
	speed: 0.0104s/iter; left time: 9.8514s
Updating learning rate to 0.0002345024711
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9253783226013184
Epoch: 1, Steps: 131 | Train Loss: 0.5597091 Vali Loss: 0.2756343 Best vali loss: 0.2756343
	iters: 100, epoch: 2 | loss: 0.3257749
	speed: 0.0089s/iter; left time: 7.3052s
Updating learning rate to 0.00011725123555
Validation loss decreased (0.2756 --> 0.2693).  Saving model state dict ...
Epoch: 2 cost time: 0.6982033252716064
Epoch: 2, Steps: 131 | Train Loss: 0.3257749 Vali Loss: 0.2693016 Best vali loss: 0.2693016
	iters: 100, epoch: 3 | loss: 0.4644490
	speed: 0.0096s/iter; left time: 6.5938s
Updating learning rate to 5.8625617775e-05
Epoch: 3 cost time: 0.6923222541809082
Epoch: 3, Steps: 131 | Train Loss: 0.4644490 Vali Loss: 0.2784023 Best vali loss: 0.2693016
	iters: 100, epoch: 4 | loss: 0.5051542
	speed: 0.0086s/iter; left time: 4.7853s
Updating learning rate to 2.93128088875e-05
Epoch: 4 cost time: 0.6974754333496094
Epoch: 4, Steps: 131 | Train Loss: 0.5051542 Vali Loss: 0.2873658 Best vali loss: 0.2693016
	iters: 100, epoch: 5 | loss: 0.3353076
	speed: 0.0086s/iter; left time: 3.6711s
Updating learning rate to 1.465640444375e-05
Epoch: 5 cost time: 0.7001678943634033
Epoch: 5, Steps: 131 | Train Loss: 0.3353076 Vali Loss: 0.2851546 Best vali loss: 0.2693016
	iters: 100, epoch: 6 | loss: 0.3174826
	speed: 0.0087s/iter; left time: 2.5646s
Updating learning rate to 7.328202221875e-06
Epoch: 6 cost time: 0.7015318870544434
Epoch: 6, Steps: 131 | Train Loss: 0.3174826 Vali Loss: 0.2867310 Best vali loss: 0.2693016
	iters: 100, epoch: 7 | loss: 0.3092281
	speed: 0.0086s/iter; left time: 1.4081s
Updating learning rate to 3.6641011109375e-06
Epoch: 7 cost time: 0.6999921798706055
Epoch: 7, Steps: 131 | Train Loss: 0.3092281 Vali Loss: 0.2913083 Best vali loss: 0.2693016
	iters: 100, epoch: 8 | loss: 0.3968123
	speed: 0.0086s/iter; left time: 0.2766s
Updating learning rate to 1.83205055546875e-06
Epoch: 8 cost time: 0.6999199390411377
Epoch: 8, Steps: 131 | Train Loss: 0.3968123 Vali Loss: 0.2932134 Best vali loss: 0.2693016

best validation loss 0.26930162154329274

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002345264902, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597128
	speed: 0.0105s/iter; left time: 9.9685s
Updating learning rate to 0.0002345264902
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9342019557952881
Epoch: 1, Steps: 131 | Train Loss: 0.5597128 Vali Loss: 0.2756323 Best vali loss: 0.2756323
	iters: 100, epoch: 2 | loss: 0.3248375
	speed: 0.0089s/iter; left time: 7.2524s
Updating learning rate to 0.0001172632451
Validation loss decreased (0.2756 --> 0.2687).  Saving model state dict ...
Epoch: 2 cost time: 0.6944217681884766
Epoch: 2, Steps: 131 | Train Loss: 0.3248375 Vali Loss: 0.2687057 Best vali loss: 0.2687057
	iters: 100, epoch: 3 | loss: 0.4608320
	speed: 0.0088s/iter; left time: 6.0763s
Updating learning rate to 5.863162255e-05
Epoch: 3 cost time: 0.6998496055603027
Epoch: 3, Steps: 131 | Train Loss: 0.4608320 Vali Loss: 0.2794372 Best vali loss: 0.2687057
	iters: 100, epoch: 4 | loss: 0.5069759
	speed: 0.0086s/iter; left time: 4.7837s
Updating learning rate to 2.9315811275e-05
Epoch: 4 cost time: 0.7013747692108154
Epoch: 4, Steps: 131 | Train Loss: 0.5069759 Vali Loss: 0.2879285 Best vali loss: 0.2687057
	iters: 100, epoch: 5 | loss: 0.3348525
	speed: 0.0086s/iter; left time: 3.6346s
Updating learning rate to 1.46579056375e-05
Epoch: 5 cost time: 0.6969006061553955
Epoch: 5, Steps: 131 | Train Loss: 0.3348525 Vali Loss: 0.2854443 Best vali loss: 0.2687057
	iters: 100, epoch: 6 | loss: 0.3199118
	speed: 0.0086s/iter; left time: 2.5253s
Updating learning rate to 7.32895281875e-06
Epoch: 6 cost time: 0.6932370662689209
Epoch: 6, Steps: 131 | Train Loss: 0.3199118 Vali Loss: 0.2865961 Best vali loss: 0.2687057
	iters: 100, epoch: 7 | loss: 0.3101389
	speed: 0.0086s/iter; left time: 1.4001s
Updating learning rate to 3.664476409375e-06
Epoch: 7 cost time: 0.6932611465454102
Epoch: 7, Steps: 131 | Train Loss: 0.3101389 Vali Loss: 0.2905628 Best vali loss: 0.2687057
	iters: 100, epoch: 8 | loss: 0.3986647
	speed: 0.0085s/iter; left time: 0.2729s
Updating learning rate to 1.8322382046875e-06
Epoch: 8 cost time: 0.6929512023925781
Epoch: 8, Steps: 131 | Train Loss: 0.3986647 Vali Loss: 0.2926922 Best vali loss: 0.2687057

best validation loss 0.2687056592048079

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.000801841182, 'e_layers': 2, 'learning_rate': 0.0004975594355, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.1969585
	speed: 0.0089s/iter; left time: 36.4685s
	iters: 200, epoch: 1 | loss: 0.6267563
	speed: 0.0033s/iter; left time: 13.1122s
	iters: 300, epoch: 1 | loss: 0.3495841
	speed: 0.0033s/iter; left time: 12.9053s
	iters: 400, epoch: 1 | loss: 0.5506153
	speed: 0.0033s/iter; left time: 12.5410s
	iters: 500, epoch: 1 | loss: 0.4689092
	speed: 0.0033s/iter; left time: 12.1614s
Updating learning rate to 0.0004975594355
Validation loss decreased (inf --> 0.2938).  Saving model state dict ...
Epoch: 1 cost time: 2.01253342628479
Epoch: 1, Steps: 523 | Train Loss: 0.4385647 Vali Loss: 0.2937571 Best vali loss: 0.2937571
	iters: 100, epoch: 2 | loss: 0.9977120
	speed: 0.0076s/iter; left time: 26.9656s
	iters: 200, epoch: 2 | loss: 0.6282858
	speed: 0.0035s/iter; left time: 12.0829s
	iters: 300, epoch: 2 | loss: 0.6432024
	speed: 0.0035s/iter; left time: 11.7925s
	iters: 400, epoch: 2 | loss: 0.5586095
	speed: 0.0036s/iter; left time: 11.6912s
	iters: 500, epoch: 2 | loss: 0.3349230
	speed: 0.0036s/iter; left time: 11.4384s
Updating learning rate to 0.00024877971775
Validation loss decreased (0.2938 --> 0.2918).  Saving model state dict ...
Epoch: 2 cost time: 1.8984923362731934
Epoch: 2, Steps: 523 | Train Loss: 0.6325465 Vali Loss: 0.2917563 Best vali loss: 0.2917563
	iters: 100, epoch: 3 | loss: 0.3425500
	speed: 0.0078s/iter; left time: 23.7725s
	iters: 200, epoch: 3 | loss: 0.3969005
	speed: 0.0035s/iter; left time: 10.2451s
	iters: 300, epoch: 3 | loss: 0.2340458
	speed: 0.0035s/iter; left time: 9.9665s
	iters: 400, epoch: 3 | loss: 0.2911674
	speed: 0.0035s/iter; left time: 9.5995s
	iters: 500, epoch: 3 | loss: 0.3404274
	speed: 0.0035s/iter; left time: 9.1826s
Updating learning rate to 0.000124389858875
Epoch: 3 cost time: 1.8614320755004883
Epoch: 3, Steps: 523 | Train Loss: 0.3210182 Vali Loss: 0.2940244 Best vali loss: 0.2917563

best validation loss 0.2917562922322205

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0097397982406, 'e_layers': 1, 'learning_rate': 0.0012334949992, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0012334949992
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 0.4929158687591553
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2877970 Best vali loss: 0.2877970
Updating learning rate to 0.0006167474996
Validation loss decreased (0.2878 --> 0.2823).  Saving model state dict ...
Epoch: 2 cost time: 0.26542186737060547
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2823072 Best vali loss: 0.2823072
Updating learning rate to 0.0003083737498
Validation loss decreased (0.2823 --> 0.2809).  Saving model state dict ...
Epoch: 3 cost time: 0.26798105239868164
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2808788 Best vali loss: 0.2808788

best validation loss 0.2808787948848502

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.003179949775, 'e_layers': 3, 'learning_rate': 0.0025600959589, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002462658108296283
Validation loss decreased (inf --> 0.3096).  Saving model state dict ...
Epoch: 1 cost time: 0.8652911186218262
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3095974 Best vali loss: 0.3095974
Updating learning rate to 0.002185178585963233
Epoch: 2 cost time: 0.6139774322509766
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3375999 Best vali loss: 0.3095974
Updating learning rate to 0.001769901133817924
Epoch: 3 cost time: 0.6031420230865479
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3171796 Best vali loss: 0.3095974

best validation loss 0.3095974124976364

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0097397982406, 'e_layers': 1, 'learning_rate': 0.0012334949992, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001541868749
Epoch: 4 cost time: 0.4926919937133789
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2811267 Best vali loss: 0.2808788
Updating learning rate to 7.709343745e-05
Validation loss decreased (0.2809 --> 0.2806).  Saving model state dict ...
Epoch: 5 cost time: 0.2630136013031006
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2805682 Best vali loss: 0.2805682
Updating learning rate to 3.8546718725e-05
Validation loss decreased (0.2806 --> 0.2806).  Saving model state dict ...
Epoch: 6 cost time: 0.26172375679016113
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2805681 Best vali loss: 0.2805681
Updating learning rate to 1.92733593625e-05
Validation loss decreased (0.2806 --> 0.2805).  Saving model state dict ...
Epoch: 7 cost time: 0.2869091033935547
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2804918 Best vali loss: 0.2804918
Updating learning rate to 9.63667968125e-06
Epoch: 8 cost time: 0.28035664558410645
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2805959 Best vali loss: 0.2804918

best validation loss 0.28049180043501765

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030023757283, 'e_layers': 3, 'learning_rate': 0.0004664783523, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5199800
	speed: 0.0122s/iter; left time: 11.6191s
Updating learning rate to 0.0004664783523
Validation loss decreased (inf --> 0.3002).  Saving model state dict ...
Epoch: 1 cost time: 1.1483051776885986
Epoch: 1, Steps: 131 | Train Loss: 0.5199800 Vali Loss: 0.3002270 Best vali loss: 0.3002270
	iters: 100, epoch: 2 | loss: 0.5419517
	speed: 0.0112s/iter; left time: 9.1397s
Updating learning rate to 0.00023323917615
Validation loss decreased (0.3002 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 0.9133226871490479
Epoch: 2, Steps: 131 | Train Loss: 0.5419517 Vali Loss: 0.2828167 Best vali loss: 0.2828167
	iters: 100, epoch: 3 | loss: 0.4861700
	speed: 0.0113s/iter; left time: 7.7874s
Updating learning rate to 0.000116619588075
Validation loss decreased (0.2828 --> 0.2808).  Saving model state dict ...
Epoch: 3 cost time: 0.9154865741729736
Epoch: 3, Steps: 131 | Train Loss: 0.4861700 Vali Loss: 0.2808473 Best vali loss: 0.2808473
	iters: 100, epoch: 4 | loss: 0.3106606
	speed: 0.0113s/iter; left time: 6.2812s
Updating learning rate to 5.83097940375e-05
Epoch: 4 cost time: 0.9067718982696533
Epoch: 4, Steps: 131 | Train Loss: 0.3106606 Vali Loss: 0.2815272 Best vali loss: 0.2808473
	iters: 100, epoch: 5 | loss: 0.3126889
	speed: 0.0110s/iter; left time: 4.6597s
Updating learning rate to 2.915489701875e-05
Epoch: 5 cost time: 0.9072678089141846
Epoch: 5, Steps: 131 | Train Loss: 0.3126889 Vali Loss: 0.2850370 Best vali loss: 0.2808473
	iters: 100, epoch: 6 | loss: 0.3338715
	speed: 0.0110s/iter; left time: 3.2355s
Updating learning rate to 1.4577448509375e-05
Epoch: 6 cost time: 0.9145197868347168
Epoch: 6, Steps: 131 | Train Loss: 0.3338715 Vali Loss: 0.2975284 Best vali loss: 0.2808473
	iters: 100, epoch: 7 | loss: 0.3984015
	speed: 0.0110s/iter; left time: 1.7984s
Updating learning rate to 7.2887242546875e-06
Epoch: 7 cost time: 0.9095509052276611
Epoch: 7, Steps: 131 | Train Loss: 0.3984015 Vali Loss: 0.2959912 Best vali loss: 0.2808473
	iters: 100, epoch: 8 | loss: 0.3513290
	speed: 0.0109s/iter; left time: 0.3501s
Updating learning rate to 3.64436212734375e-06
Epoch: 8 cost time: 0.9047071933746338
Epoch: 8, Steps: 131 | Train Loss: 0.3513290 Vali Loss: 0.2993161 Best vali loss: 0.2808473

best validation loss 0.28084729037217465

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009537056025, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596257
	speed: 0.0105s/iter; left time: 9.9840s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9257261753082275
Epoch: 1, Steps: 131 | Train Loss: 0.5596257 Vali Loss: 0.2756705 Best vali loss: 0.2756705
	iters: 100, epoch: 2 | loss: 0.3233859
	speed: 0.0089s/iter; left time: 7.3138s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2757 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.6996943950653076
Epoch: 2, Steps: 131 | Train Loss: 0.3233859 Vali Loss: 0.2689683 Best vali loss: 0.2689683
	iters: 100, epoch: 3 | loss: 0.4619944
	speed: 0.0089s/iter; left time: 6.1441s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.705111026763916
Epoch: 3, Steps: 131 | Train Loss: 0.4619944 Vali Loss: 0.2838104 Best vali loss: 0.2689683
	iters: 100, epoch: 4 | loss: 0.5042028
	speed: 0.0086s/iter; left time: 4.7858s
Updating learning rate to 2.9315984725e-05
Epoch: 4 cost time: 0.6931631565093994
Epoch: 4, Steps: 131 | Train Loss: 0.5042028 Vali Loss: 0.2853748 Best vali loss: 0.2689683
	iters: 100, epoch: 5 | loss: 0.3341747
	speed: 0.0086s/iter; left time: 3.6646s
Updating learning rate to 1.46579923625e-05
Epoch: 5 cost time: 0.6953983306884766
Epoch: 5, Steps: 131 | Train Loss: 0.3341747 Vali Loss: 0.2888285 Best vali loss: 0.2689683
	iters: 100, epoch: 6 | loss: 0.3180521
	speed: 0.0086s/iter; left time: 2.5307s
Updating learning rate to 7.32899618125e-06
Epoch: 6 cost time: 0.7024307250976562
Epoch: 6, Steps: 131 | Train Loss: 0.3180521 Vali Loss: 0.2890993 Best vali loss: 0.2689683
	iters: 100, epoch: 7 | loss: 0.3104232
	speed: 0.0086s/iter; left time: 1.4085s
Updating learning rate to 3.664498090625e-06
Epoch: 7 cost time: 0.6972103118896484
Epoch: 7, Steps: 131 | Train Loss: 0.3104232 Vali Loss: 0.2949770 Best vali loss: 0.2689683
	iters: 100, epoch: 8 | loss: 0.3955244
	speed: 0.0087s/iter; left time: 0.2786s
Updating learning rate to 1.8322490453125e-06
Epoch: 8 cost time: 0.7035562992095947
Epoch: 8, Steps: 131 | Train Loss: 0.3955244 Vali Loss: 0.2950139 Best vali loss: 0.2689683

best validation loss 0.26896830308211256

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009571535605, 'e_layers': 2, 'learning_rate': 0.0002345064925, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596921
	speed: 0.0105s/iter; left time: 9.9384s
Updating learning rate to 0.0002345064925
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9301903247833252
Epoch: 1, Steps: 131 | Train Loss: 0.5596921 Vali Loss: 0.2756451 Best vali loss: 0.2756451
	iters: 100, epoch: 2 | loss: 0.3264007
	speed: 0.0088s/iter; left time: 7.2358s
Updating learning rate to 0.00011725324625
Validation loss decreased (0.2756 --> 0.2732).  Saving model state dict ...
Epoch: 2 cost time: 0.6995551586151123
Epoch: 2, Steps: 131 | Train Loss: 0.3264007 Vali Loss: 0.2732340 Best vali loss: 0.2732340
	iters: 100, epoch: 3 | loss: 0.4634607
	speed: 0.0090s/iter; left time: 6.1839s
Updating learning rate to 5.8626623125e-05
Epoch: 3 cost time: 0.7052457332611084
Epoch: 3, Steps: 131 | Train Loss: 0.4634607 Vali Loss: 0.2855977 Best vali loss: 0.2732340

best validation loss 0.2732339921206868

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004975149535, 'e_layers': 3, 'learning_rate': 0.0004627686626, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5226340
	speed: 0.0122s/iter; left time: 11.5581s
Updating learning rate to 0.0004627686626
Validation loss decreased (inf --> 0.2930).  Saving model state dict ...
Epoch: 1 cost time: 1.1518211364746094
Epoch: 1, Steps: 131 | Train Loss: 0.5226340 Vali Loss: 0.2929611 Best vali loss: 0.2929611
	iters: 100, epoch: 2 | loss: 0.5253593
	speed: 0.0113s/iter; left time: 9.2396s
Updating learning rate to 0.0002313843313
Validation loss decreased (0.2930 --> 0.2847).  Saving model state dict ...
Epoch: 2 cost time: 0.9148304462432861
Epoch: 2, Steps: 131 | Train Loss: 0.5253593 Vali Loss: 0.2846619 Best vali loss: 0.2846619
	iters: 100, epoch: 3 | loss: 0.4837509
	speed: 0.0114s/iter; left time: 7.8489s
Updating learning rate to 0.00011569216565
Validation loss decreased (0.2847 --> 0.2800).  Saving model state dict ...
Epoch: 3 cost time: 0.9213194847106934
Epoch: 3, Steps: 131 | Train Loss: 0.4837509 Vali Loss: 0.2799690 Best vali loss: 0.2799690

best validation loss 0.2799690421040327

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0047193022412, 'e_layers': 3, 'learning_rate': 0.0003432410531, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5020400
	speed: 0.0121s/iter; left time: 11.4783s
Updating learning rate to 0.0003432410531
Validation loss decreased (inf --> 0.2824).  Saving model state dict ...
Epoch: 1 cost time: 1.1439204216003418
Epoch: 1, Steps: 131 | Train Loss: 0.5020400 Vali Loss: 0.2823716 Best vali loss: 0.2823716
	iters: 100, epoch: 2 | loss: 0.5440251
	speed: 0.0114s/iter; left time: 9.3593s
Updating learning rate to 0.00017162052655
Epoch: 2 cost time: 0.9253931045532227
Epoch: 2, Steps: 131 | Train Loss: 0.5440251 Vali Loss: 0.2964208 Best vali loss: 0.2823716
	iters: 100, epoch: 3 | loss: 0.5098361
	speed: 0.0111s/iter; left time: 7.6065s
Updating learning rate to 8.5810263275e-05
Validation loss decreased (0.2824 --> 0.2806).  Saving model state dict ...
Epoch: 3 cost time: 0.9099359512329102
Epoch: 3, Steps: 131 | Train Loss: 0.5098361 Vali Loss: 0.2805804 Best vali loss: 0.2805804

best validation loss 0.2805803830005636

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009571535605, 'e_layers': 2, 'learning_rate': 0.0002345064925, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4195701
	speed: 0.0109s/iter; left time: 6.0449s
Updating learning rate to 2.93133115625e-05
Epoch: 4 cost time: 0.9318585395812988
Epoch: 4, Steps: 131 | Train Loss: 0.4195701 Vali Loss: 0.3148220 Best vali loss: 0.2732340
	iters: 100, epoch: 5 | loss: 0.2810425
	speed: 0.0088s/iter; left time: 3.7389s
Updating learning rate to 1.465665578125e-05
Epoch: 5 cost time: 0.7076799869537354
Epoch: 5, Steps: 131 | Train Loss: 0.2810425 Vali Loss: 0.3025805 Best vali loss: 0.2732340
	iters: 100, epoch: 6 | loss: 0.4296047
	speed: 0.0086s/iter; left time: 2.5269s
Updating learning rate to 7.328327890625e-06
Epoch: 6 cost time: 0.702317476272583
Epoch: 6, Steps: 131 | Train Loss: 0.4296047 Vali Loss: 0.3039841 Best vali loss: 0.2732340
	iters: 100, epoch: 7 | loss: 0.4668010
	speed: 0.0086s/iter; left time: 1.4037s
Updating learning rate to 3.6641639453125e-06
Epoch: 7 cost time: 0.7047708034515381
Epoch: 7, Steps: 131 | Train Loss: 0.4668010 Vali Loss: 0.3035178 Best vali loss: 0.2732340
	iters: 100, epoch: 8 | loss: 0.3296549
	speed: 0.0087s/iter; left time: 0.2787s
Updating learning rate to 1.83208197265625e-06
Epoch: 8 cost time: 0.6980295181274414
Epoch: 8, Steps: 131 | Train Loss: 0.3296549 Vali Loss: 0.2995347 Best vali loss: 0.2732340

best validation loss 0.2732339921206868

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045592532265, 'e_layers': 3, 'learning_rate': 0.0003840033288, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5044826
	speed: 0.0123s/iter; left time: 11.6547s
Updating learning rate to 0.0003840033288
Validation loss decreased (inf --> 0.2778).  Saving model state dict ...
Epoch: 1 cost time: 1.1544172763824463
Epoch: 1, Steps: 131 | Train Loss: 0.5044826 Vali Loss: 0.2777531 Best vali loss: 0.2777531
	iters: 100, epoch: 2 | loss: 0.5510320
	speed: 0.0114s/iter; left time: 9.2972s
Updating learning rate to 0.0001920016644
Epoch: 2 cost time: 0.9154326915740967
Epoch: 2, Steps: 131 | Train Loss: 0.5510320 Vali Loss: 0.2813478 Best vali loss: 0.2777531
	iters: 100, epoch: 3 | loss: 0.5024855
	speed: 0.0112s/iter; left time: 7.6706s
Updating learning rate to 9.60008322e-05
Epoch: 3 cost time: 0.9164829254150391
Epoch: 3, Steps: 131 | Train Loss: 0.5024855 Vali Loss: 0.2832240 Best vali loss: 0.2777531
	iters: 100, epoch: 4 | loss: 0.3229797
	speed: 0.0110s/iter; left time: 6.1323s
Updating learning rate to 4.80004161e-05
Epoch: 4 cost time: 0.9091861248016357
Epoch: 4, Steps: 131 | Train Loss: 0.3229797 Vali Loss: 0.2789231 Best vali loss: 0.2777531
	iters: 100, epoch: 5 | loss: 0.3250094
	speed: 0.0110s/iter; left time: 4.6765s
Updating learning rate to 2.400020805e-05
Epoch: 5 cost time: 0.9159274101257324
Epoch: 5, Steps: 131 | Train Loss: 0.3250094 Vali Loss: 0.2858345 Best vali loss: 0.2777531
	iters: 100, epoch: 6 | loss: 0.3425025
	speed: 0.0110s/iter; left time: 3.2247s
Updating learning rate to 1.2000104025e-05
Epoch: 6 cost time: 0.9121134281158447
Epoch: 6, Steps: 131 | Train Loss: 0.3425025 Vali Loss: 0.2956558 Best vali loss: 0.2777531
	iters: 100, epoch: 7 | loss: 0.4088778
	speed: 0.0110s/iter; left time: 1.7951s
Updating learning rate to 6.0000520125e-06
Epoch: 7 cost time: 0.9160449504852295
Epoch: 7, Steps: 131 | Train Loss: 0.4088778 Vali Loss: 0.2945633 Best vali loss: 0.2777531
	iters: 100, epoch: 8 | loss: 0.3556317
	speed: 0.0110s/iter; left time: 0.3529s
Updating learning rate to 3.00002600625e-06
Epoch: 8 cost time: 0.9116311073303223
Epoch: 8, Steps: 131 | Train Loss: 0.3556317 Vali Loss: 0.2971776 Best vali loss: 0.2777531

best validation loss 0.2777530574619039

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0059392982299, 'e_layers': 3, 'learning_rate': 0.0001146593069, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4302554
	speed: 0.0096s/iter; left time: 19.2224s
	iters: 200, epoch: 1 | loss: 0.3452003
	speed: 0.0042s/iter; left time: 7.8747s
Updating learning rate to 0.0001146593069
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 1.3589305877685547
Epoch: 1, Steps: 262 | Train Loss: 0.3877279 Vali Loss: 0.2803408 Best vali loss: 0.2803408
	iters: 100, epoch: 2 | loss: 0.4320892
	speed: 0.0097s/iter; left time: 16.8080s
	iters: 200, epoch: 2 | loss: 0.7100095
	speed: 0.0045s/iter; left time: 7.4230s
Updating learning rate to 5.732965345e-05
Validation loss decreased (0.2803 --> 0.2773).  Saving model state dict ...
Epoch: 2 cost time: 1.232938289642334
Epoch: 2, Steps: 262 | Train Loss: 0.5710494 Vali Loss: 0.2773200 Best vali loss: 0.2773200
	iters: 100, epoch: 3 | loss: 0.8177020
	speed: 0.0101s/iter; left time: 14.8365s
	iters: 200, epoch: 3 | loss: 0.5176995
	speed: 0.0046s/iter; left time: 6.3709s
Updating learning rate to 2.8664826725e-05
Epoch: 3 cost time: 1.2605316638946533
Epoch: 3, Steps: 262 | Train Loss: 0.6677008 Vali Loss: 0.2781171 Best vali loss: 0.2773200
	iters: 100, epoch: 4 | loss: 0.6164742
	speed: 0.0097s/iter; left time: 11.7659s
	iters: 200, epoch: 4 | loss: 0.3785316
	speed: 0.0041s/iter; left time: 4.6005s
Updating learning rate to 1.43324133625e-05
Validation loss decreased (0.2773 --> 0.2768).  Saving model state dict ...
Epoch: 4 cost time: 1.143052339553833
Epoch: 4, Steps: 262 | Train Loss: 0.4975029 Vali Loss: 0.2768065 Best vali loss: 0.2768065
	iters: 100, epoch: 5 | loss: 0.6197645
	speed: 0.0096s/iter; left time: 9.1068s
	iters: 200, epoch: 5 | loss: 0.3293707
	speed: 0.0044s/iter; left time: 3.7269s
Updating learning rate to 7.16620668125e-06
Epoch: 5 cost time: 1.2001826763153076
Epoch: 5, Steps: 262 | Train Loss: 0.4745676 Vali Loss: 0.2795554 Best vali loss: 0.2768065
	iters: 100, epoch: 6 | loss: 0.7039970
	speed: 0.0097s/iter; left time: 6.6967s
	iters: 200, epoch: 6 | loss: 0.3098684
	speed: 0.0045s/iter; left time: 2.6414s
Updating learning rate to 3.583103340625e-06
Epoch: 6 cost time: 1.216980218887329
Epoch: 6, Steps: 262 | Train Loss: 0.5069327 Vali Loss: 0.2807096 Best vali loss: 0.2768065
	iters: 100, epoch: 7 | loss: 0.4618669
	speed: 0.0097s/iter; left time: 4.1302s
	iters: 200, epoch: 7 | loss: 0.5516518
	speed: 0.0044s/iter; left time: 1.4230s
Updating learning rate to 1.7915516703125e-06
Epoch: 7 cost time: 1.1979374885559082
Epoch: 7, Steps: 262 | Train Loss: 0.5067593 Vali Loss: 0.2807540 Best vali loss: 0.2768065
	iters: 100, epoch: 8 | loss: 0.3662125
	speed: 0.0096s/iter; left time: 1.5612s
	iters: 200, epoch: 8 | loss: 0.3364995
	speed: 0.0045s/iter; left time: 0.2820s
Updating learning rate to 8.9577583515625e-07
Epoch: 8 cost time: 1.2176382541656494
Epoch: 8, Steps: 262 | Train Loss: 0.3513560 Vali Loss: 0.2808380 Best vali loss: 0.2768065

best validation loss 0.2768064598338495

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030070423801, 'e_layers': 3, 'learning_rate': 0.0004678789836, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5175293
	speed: 0.0120s/iter; left time: 11.3415s
Updating learning rate to 0.0004678789836
Validation loss decreased (inf --> 0.3082).  Saving model state dict ...
Epoch: 1 cost time: 1.140669345855713
Epoch: 1, Steps: 131 | Train Loss: 0.5175293 Vali Loss: 0.3081610 Best vali loss: 0.3081610
	iters: 100, epoch: 2 | loss: 0.5229318
	speed: 0.0113s/iter; left time: 9.2774s
Updating learning rate to 0.0002339394918
Validation loss decreased (0.3082 --> 0.2846).  Saving model state dict ...
Epoch: 2 cost time: 0.9215049743652344
Epoch: 2, Steps: 131 | Train Loss: 0.5229318 Vali Loss: 0.2845733 Best vali loss: 0.2845733
	iters: 100, epoch: 3 | loss: 0.5181239
	speed: 0.0115s/iter; left time: 7.9154s
Updating learning rate to 0.0001169697459
Epoch: 3 cost time: 0.9216258525848389
Epoch: 3, Steps: 131 | Train Loss: 0.5181239 Vali Loss: 0.2893302 Best vali loss: 0.2845733

best validation loss 0.2845732969903467

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.003003274172, 'e_layers': 3, 'learning_rate': 0.0004690515227, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5214372
	speed: 0.0121s/iter; left time: 11.4450s
Updating learning rate to 0.0004690515227
Validation loss decreased (inf --> 0.2923).  Saving model state dict ...
Epoch: 1 cost time: 1.1513957977294922
Epoch: 1, Steps: 131 | Train Loss: 0.5214372 Vali Loss: 0.2923113 Best vali loss: 0.2923113
	iters: 100, epoch: 2 | loss: 0.5650891
	speed: 0.0114s/iter; left time: 9.3487s
Updating learning rate to 0.00023452576135
Validation loss decreased (0.2923 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.917618989944458
Epoch: 2, Steps: 131 | Train Loss: 0.5650891 Vali Loss: 0.2825894 Best vali loss: 0.2825894
	iters: 100, epoch: 3 | loss: 0.5756949
	speed: 0.0115s/iter; left time: 7.9064s
Updating learning rate to 0.000117262880675
Epoch: 3 cost time: 0.9210851192474365
Epoch: 3, Steps: 131 | Train Loss: 0.5756949 Vali Loss: 0.3068504 Best vali loss: 0.2825894

best validation loss 0.28258938124273825

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0075797181171, 'e_layers': 1, 'learning_rate': 0.0028530948346, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0028530948346
Validation loss decreased (inf --> 0.3066).  Saving model state dict ...
Epoch: 1 cost time: 0.4955127239227295
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3066378 Best vali loss: 0.3066378
Updating learning rate to 0.0014265474173
Validation loss decreased (0.3066 --> 0.2999).  Saving model state dict ...
Epoch: 2 cost time: 0.27862119674682617
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2999200 Best vali loss: 0.2999200
Updating learning rate to 0.00071327370865
Epoch: 3 cost time: 0.28255462646484375
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3180643 Best vali loss: 0.2999200

best validation loss 0.2999199864898929

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.003003274172, 'e_layers': 3, 'learning_rate': 0.0004690515227, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3402767
	speed: 0.0126s/iter; left time: 6.9946s
Updating learning rate to 5.86314403375e-05
Epoch: 4 cost time: 1.1504597663879395
Epoch: 4, Steps: 131 | Train Loss: 0.3402767 Vali Loss: 0.2921868 Best vali loss: 0.2825894
	iters: 100, epoch: 5 | loss: 0.3388908
	speed: 0.0110s/iter; left time: 4.6834s
Updating learning rate to 2.931572016875e-05
Epoch: 5 cost time: 0.9098176956176758
Epoch: 5, Steps: 131 | Train Loss: 0.3388908 Vali Loss: 0.2936163 Best vali loss: 0.2825894
	iters: 100, epoch: 6 | loss: 0.4007435
	speed: 0.0110s/iter; left time: 3.2346s
Updating learning rate to 1.4657860084375e-05
Epoch: 6 cost time: 0.9160990715026855
Epoch: 6, Steps: 131 | Train Loss: 0.4007435 Vali Loss: 0.2971767 Best vali loss: 0.2825894
	iters: 100, epoch: 7 | loss: 0.2905605
	speed: 0.0112s/iter; left time: 1.8248s
Updating learning rate to 7.3289300421875e-06
Epoch: 7 cost time: 0.9227280616760254
Epoch: 7, Steps: 131 | Train Loss: 0.2905605 Vali Loss: 0.2955173 Best vali loss: 0.2825894
	iters: 100, epoch: 8 | loss: 0.3023467
	speed: 0.0112s/iter; left time: 0.3570s
Updating learning rate to 3.66446502109375e-06
Epoch: 8 cost time: 0.9100208282470703
Epoch: 8, Steps: 131 | Train Loss: 0.3023467 Vali Loss: 0.2965136 Best vali loss: 0.2825894

best validation loss 0.28258938124273825

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0068034743153, 'e_layers': 2, 'learning_rate': 0.0001467270736, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5072019
	speed: 0.0088s/iter; left time: 35.9563s
	iters: 200, epoch: 1 | loss: 0.2883653
	speed: 0.0034s/iter; left time: 13.4012s
	iters: 300, epoch: 1 | loss: 0.4610477
	speed: 0.0035s/iter; left time: 13.4604s
	iters: 400, epoch: 1 | loss: 0.5361484
	speed: 0.0035s/iter; left time: 13.0989s
	iters: 500, epoch: 1 | loss: 0.4789199
	speed: 0.0035s/iter; left time: 12.7641s
Updating learning rate to 0.00014114260688215857
Validation loss decreased (inf --> 0.2790).  Saving model state dict ...
Epoch: 1 cost time: 2.0601541996002197
Epoch: 1, Steps: 523 | Train Loss: 0.4543367 Vali Loss: 0.2790069 Best vali loss: 0.2790069
	iters: 100, epoch: 2 | loss: 0.3844539
	speed: 0.0075s/iter; left time: 26.8846s
	iters: 200, epoch: 2 | loss: 0.2373729
	speed: 0.0034s/iter; left time: 11.9207s
	iters: 300, epoch: 2 | loss: 0.4281274
	speed: 0.0035s/iter; left time: 11.6516s
	iters: 400, epoch: 2 | loss: 1.0186853
	speed: 0.0035s/iter; left time: 11.2567s
	iters: 500, epoch: 2 | loss: 0.5618201
	speed: 0.0035s/iter; left time: 10.9819s
Updating learning rate to 0.00012523939116310882
Validation loss decreased (0.2790 --> 0.2721).  Saving model state dict ...
Epoch: 2 cost time: 1.8391494750976562
Epoch: 2, Steps: 523 | Train Loss: 0.5260919 Vali Loss: 0.2721379 Best vali loss: 0.2721379
	iters: 100, epoch: 3 | loss: 0.6439378
	speed: 0.0077s/iter; left time: 23.4926s
	iters: 200, epoch: 3 | loss: 0.4615453
	speed: 0.0034s/iter; left time: 10.0493s
	iters: 300, epoch: 3 | loss: 0.5240277
	speed: 0.0034s/iter; left time: 9.7560s
	iters: 400, epoch: 3 | loss: 0.2644781
	speed: 0.0034s/iter; left time: 9.4325s
	iters: 500, epoch: 3 | loss: 0.2341863
	speed: 0.0034s/iter; left time: 8.9475s
Updating learning rate to 0.00010143854687306657
Epoch: 3 cost time: 1.834704875946045
Epoch: 3, Steps: 523 | Train Loss: 0.4256350 Vali Loss: 0.3041429 Best vali loss: 0.2721379
	iters: 100, epoch: 4 | loss: 0.2390348
	speed: 0.0071s/iter; left time: 17.9039s
	iters: 200, epoch: 4 | loss: 0.3621485
	speed: 0.0030s/iter; left time: 7.2957s
	iters: 300, epoch: 4 | loss: 0.2823078
	speed: 0.0032s/iter; left time: 7.3039s
	iters: 400, epoch: 4 | loss: 0.6603836
	speed: 0.0030s/iter; left time: 6.7041s
	iters: 500, epoch: 4 | loss: 0.3046218
	speed: 0.0030s/iter; left time: 6.3505s
Updating learning rate to 7.33635368e-05
Epoch: 4 cost time: 1.633641004562378
Epoch: 4, Steps: 523 | Train Loss: 0.3696993 Vali Loss: 0.2950433 Best vali loss: 0.2721379
	iters: 100, epoch: 5 | loss: 0.1818844
	speed: 0.0074s/iter; left time: 14.8371s
	iters: 200, epoch: 5 | loss: 0.2769012
	speed: 0.0034s/iter; left time: 6.4535s
	iters: 300, epoch: 5 | loss: 0.3255375
	speed: 0.0033s/iter; left time: 5.8907s
	iters: 400, epoch: 5 | loss: 0.6082715
	speed: 0.0033s/iter; left time: 5.5702s
	iters: 500, epoch: 5 | loss: 0.3822074
	speed: 0.0033s/iter; left time: 5.2287s
Updating learning rate to 4.528852672693342e-05
Epoch: 5 cost time: 1.796867847442627
Epoch: 5, Steps: 523 | Train Loss: 0.3549604 Vali Loss: 0.2906926 Best vali loss: 0.2721379
	iters: 100, epoch: 6 | loss: 0.3191043
	speed: 0.0073s/iter; left time: 10.7927s
	iters: 200, epoch: 6 | loss: 0.2418103
	speed: 0.0033s/iter; left time: 4.4736s
	iters: 300, epoch: 6 | loss: 0.3168697
	speed: 0.0034s/iter; left time: 4.2647s
	iters: 400, epoch: 6 | loss: 0.1833948
	speed: 0.0035s/iter; left time: 4.1247s
	iters: 500, epoch: 6 | loss: 0.4106719
	speed: 0.0035s/iter; left time: 3.7569s
Updating learning rate to 2.1487682436891176e-05
Epoch: 6 cost time: 1.812098741531372
Epoch: 6, Steps: 523 | Train Loss: 0.2943702 Vali Loss: 0.3136874 Best vali loss: 0.2721379
	iters: 100, epoch: 7 | loss: 0.2893325
	speed: 0.0071s/iter; left time: 6.7381s
	iters: 200, epoch: 7 | loss: 0.3384662
	speed: 0.0030s/iter; left time: 2.5810s
	iters: 300, epoch: 7 | loss: 0.2685556
	speed: 0.0030s/iter; left time: 2.2579s
	iters: 400, epoch: 7 | loss: 0.2824117
	speed: 0.0030s/iter; left time: 1.9391s
	iters: 500, epoch: 7 | loss: 0.2317762
	speed: 0.0030s/iter; left time: 1.6607s
Updating learning rate to 5.584466717841419e-06
Epoch: 7 cost time: 1.6235249042510986
Epoch: 7, Steps: 523 | Train Loss: 0.2821084 Vali Loss: 0.3077756 Best vali loss: 0.2721379
	iters: 100, epoch: 8 | loss: 0.3886564
	speed: 0.0074s/iter; left time: 3.1474s
	iters: 200, epoch: 8 | loss: 0.1685884
	speed: 0.0035s/iter; left time: 1.1267s
	iters: 300, epoch: 8 | loss: 0.3109142
	speed: 0.0035s/iter; left time: 0.7750s
	iters: 400, epoch: 8 | loss: 0.2643540
	speed: 0.0035s/iter; left time: 0.4296s
	iters: 500, epoch: 8 | loss: 0.4195214
	speed: 0.0035s/iter; left time: 0.0834s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8612372875213623
Epoch: 8, Steps: 523 | Train Loss: 0.3104069 Vali Loss: 0.3123745 Best vali loss: 0.2721379

best validation loss 0.2721379300715889

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00111155329, 'e_layers': 2, 'learning_rate': 0.000417496596, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2091020
	speed: 0.0088s/iter; left time: 36.1192s
	iters: 200, epoch: 1 | loss: 0.7030981
	speed: 0.0034s/iter; left time: 13.4905s
	iters: 300, epoch: 1 | loss: 0.4760828
	speed: 0.0034s/iter; left time: 13.0583s
	iters: 400, epoch: 1 | loss: 0.4208304
	speed: 0.0034s/iter; left time: 12.7699s
	iters: 500, epoch: 1 | loss: 0.2306572
	speed: 0.0034s/iter; left time: 12.4463s
Updating learning rate to 0.0004016065779687668
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 2.0371787548065186
Epoch: 1, Steps: 523 | Train Loss: 0.4079541 Vali Loss: 0.2841346 Best vali loss: 0.2841346
	iters: 100, epoch: 2 | loss: 0.3155676
	speed: 0.0076s/iter; left time: 26.9453s
	iters: 200, epoch: 2 | loss: 0.3446247
	speed: 0.0035s/iter; left time: 12.0738s
	iters: 300, epoch: 2 | loss: 0.5404868
	speed: 0.0035s/iter; left time: 11.6347s
	iters: 400, epoch: 2 | loss: 0.6896770
	speed: 0.0031s/iter; left time: 10.2027s
	iters: 500, epoch: 2 | loss: 0.4033269
	speed: 0.0032s/iter; left time: 10.0704s
Updating learning rate to 0.0003563556350769502
Validation loss decreased (0.2841 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 1.7915818691253662
Epoch: 2, Steps: 523 | Train Loss: 0.4587366 Vali Loss: 0.2815232 Best vali loss: 0.2815232
	iters: 100, epoch: 3 | loss: 0.6929901
	speed: 0.0072s/iter; left time: 21.9316s
	iters: 200, epoch: 3 | loss: 0.3536799
	speed: 0.0031s/iter; left time: 9.2547s
	iters: 300, epoch: 3 | loss: 0.5312493
	speed: 0.0031s/iter; left time: 8.8873s
	iters: 400, epoch: 3 | loss: 0.2005207
	speed: 0.0031s/iter; left time: 8.5782s
	iters: 500, epoch: 3 | loss: 0.4057208
	speed: 0.0031s/iter; left time: 8.2261s
Updating learning rate to 0.0002886328131790106
Epoch: 3 cost time: 1.6864917278289795
Epoch: 3, Steps: 523 | Train Loss: 0.4368322 Vali Loss: 0.2861532 Best vali loss: 0.2815232
	iters: 100, epoch: 4 | loss: 0.2206934
	speed: 0.0072s/iter; left time: 18.0272s
	iters: 200, epoch: 4 | loss: 0.5757755
	speed: 0.0034s/iter; left time: 8.2829s
	iters: 300, epoch: 4 | loss: 0.3915980
	speed: 0.0035s/iter; left time: 8.0438s
	iters: 400, epoch: 4 | loss: 0.2671534
	speed: 0.0034s/iter; left time: 7.5965s
	iters: 500, epoch: 4 | loss: 0.8523543
	speed: 0.0036s/iter; left time: 7.6161s
Updating learning rate to 0.000208748298
Epoch: 4 cost time: 1.8516919612884521
Epoch: 4, Steps: 523 | Train Loss: 0.4615149 Vali Loss: 0.2823458 Best vali loss: 0.2815232
	iters: 100, epoch: 5 | loss: 0.7259080
	speed: 0.0073s/iter; left time: 14.5146s
	iters: 200, epoch: 5 | loss: 0.5444353
	speed: 0.0034s/iter; left time: 6.4323s
	iters: 300, epoch: 5 | loss: 0.3805336
	speed: 0.0033s/iter; left time: 5.9798s
	iters: 400, epoch: 5 | loss: 0.5724723
	speed: 0.0034s/iter; left time: 5.6917s
	iters: 500, epoch: 5 | loss: 0.5324688
	speed: 0.0033s/iter; left time: 5.3212s
Updating learning rate to 0.0001288637828209894
Epoch: 5 cost time: 1.7945075035095215
Epoch: 5, Steps: 523 | Train Loss: 0.5511636 Vali Loss: 0.2856331 Best vali loss: 0.2815232
	iters: 100, epoch: 6 | loss: 0.9496456
	speed: 0.0069s/iter; left time: 10.1661s
	iters: 200, epoch: 6 | loss: 0.2785689
	speed: 0.0031s/iter; left time: 4.1860s
	iters: 300, epoch: 6 | loss: 0.5159406
	speed: 0.0030s/iter; left time: 3.8209s
	iters: 400, epoch: 6 | loss: 0.6411630
	speed: 0.0030s/iter; left time: 3.5425s
	iters: 500, epoch: 6 | loss: 0.6452555
	speed: 0.0031s/iter; left time: 3.2776s
Updating learning rate to 6.11409609230498e-05
Epoch: 6 cost time: 1.6286709308624268
Epoch: 6, Steps: 523 | Train Loss: 0.6061147 Vali Loss: 0.2869050 Best vali loss: 0.2815232
	iters: 100, epoch: 7 | loss: 0.4582140
	speed: 0.0066s/iter; left time: 6.2847s
	iters: 200, epoch: 7 | loss: 1.1809494
	speed: 0.0028s/iter; left time: 2.3625s
	iters: 300, epoch: 7 | loss: 0.3053649
	speed: 0.0028s/iter; left time: 2.0736s
	iters: 400, epoch: 7 | loss: 0.4806565
	speed: 0.0028s/iter; left time: 1.7835s
	iters: 500, epoch: 7 | loss: 0.6646861
	speed: 0.0028s/iter; left time: 1.5212s
Updating learning rate to 1.5890018031233226e-05
Epoch: 7 cost time: 1.4994416236877441
Epoch: 7, Steps: 523 | Train Loss: 0.6179742 Vali Loss: 0.2893412 Best vali loss: 0.2815232
	iters: 100, epoch: 8 | loss: 0.6266273
	speed: 0.0070s/iter; left time: 2.9723s
	iters: 200, epoch: 8 | loss: 0.4177829
	speed: 0.0030s/iter; left time: 0.9850s
	iters: 300, epoch: 8 | loss: 0.3177859
	speed: 0.0030s/iter; left time: 0.6812s
	iters: 400, epoch: 8 | loss: 0.2971240
	speed: 0.0031s/iter; left time: 0.3818s
	iters: 500, epoch: 8 | loss: 0.6874081
	speed: 0.0031s/iter; left time: 0.0736s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6525514125823975
Epoch: 8, Steps: 523 | Train Loss: 0.4693457 Vali Loss: 0.2886408 Best vali loss: 0.2815232

best validation loss 0.2815232349926098

[INFO][smbo.py:320] Finished 1350 trials.
{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010372506272, 'e_layers': 3, 'learning_rate': 0.0026951317463, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2678848
	speed: 0.0095s/iter; left time: 78.6574s
	iters: 200, epoch: 1 | loss: 0.5005035
	speed: 0.0041s/iter; left time: 33.5158s
	iters: 300, epoch: 1 | loss: 0.6183661
	speed: 0.0040s/iter; left time: 32.2376s
	iters: 400, epoch: 1 | loss: 0.3388708
	speed: 0.0040s/iter; left time: 31.8464s
	iters: 500, epoch: 1 | loss: 0.4863684
	speed: 0.0040s/iter; left time: 31.5177s
	iters: 600, epoch: 1 | loss: 0.6264195
	speed: 0.0039s/iter; left time: 29.9595s
	iters: 700, epoch: 1 | loss: 0.1892025
	speed: 0.0039s/iter; left time: 29.9333s
	iters: 800, epoch: 1 | loss: 0.6675180
	speed: 0.0039s/iter; left time: 29.1330s
	iters: 900, epoch: 1 | loss: 0.3086559
	speed: 0.0041s/iter; left time: 30.8426s
	iters: 1000, epoch: 1 | loss: 0.2020781
	speed: 0.0041s/iter; left time: 30.3636s
Updating learning rate to 0.002592554402063986
Validation loss decreased (inf --> 0.2978).  Saving model state dict ...
Epoch: 1 cost time: 4.46095085144043
Epoch: 1, Steps: 1045 | Train Loss: 0.4205868 Vali Loss: 0.2978032 Best vali loss: 0.2978032
	iters: 100, epoch: 2 | loss: 0.2926864
	speed: 0.0122s/iter; left time: 87.7898s
	iters: 200, epoch: 2 | loss: 0.5723693
	speed: 0.0041s/iter; left time: 29.2811s
	iters: 300, epoch: 2 | loss: 0.2991318
	speed: 0.0041s/iter; left time: 29.0081s
	iters: 400, epoch: 2 | loss: 1.5145888
	speed: 0.0042s/iter; left time: 28.8017s
	iters: 500, epoch: 2 | loss: 1.2179617
	speed: 0.0042s/iter; left time: 28.7131s
	iters: 600, epoch: 2 | loss: 0.2649424
	speed: 0.0042s/iter; left time: 28.0126s
	iters: 700, epoch: 2 | loss: 1.1428481
	speed: 0.0042s/iter; left time: 27.5835s
	iters: 800, epoch: 2 | loss: 0.4292837
	speed: 0.0042s/iter; left time: 27.5636s
	iters: 900, epoch: 2 | loss: 0.4521963
	speed: 0.0042s/iter; left time: 27.0409s
	iters: 1000, epoch: 2 | loss: 1.2519822
	speed: 0.0042s/iter; left time: 26.7805s
Updating learning rate to 0.002300438840149936
Epoch: 2 cost time: 4.416811466217041
Epoch: 2, Steps: 1045 | Train Loss: 0.7437991 Vali Loss: 0.3050096 Best vali loss: 0.2978032
	iters: 100, epoch: 3 | loss: 0.1954290
	speed: 0.0121s/iter; left time: 74.7182s
	iters: 200, epoch: 3 | loss: 0.2187569
	speed: 0.0042s/iter; left time: 25.2868s
	iters: 300, epoch: 3 | loss: 0.3513776
	speed: 0.0042s/iter; left time: 25.1051s
	iters: 400, epoch: 3 | loss: 0.6807119
	speed: 0.0042s/iter; left time: 24.7073s
	iters: 500, epoch: 3 | loss: 1.5696692
	speed: 0.0042s/iter; left time: 24.3786s
	iters: 600, epoch: 3 | loss: 0.2731768
	speed: 0.0042s/iter; left time: 23.8310s
	iters: 700, epoch: 3 | loss: 2.0912595
	speed: 0.0042s/iter; left time: 23.4308s
	iters: 800, epoch: 3 | loss: 0.2774155
	speed: 0.0042s/iter; left time: 22.9789s
	iters: 900, epoch: 3 | loss: 0.3049659
	speed: 0.0042s/iter; left time: 22.5497s
	iters: 1000, epoch: 3 | loss: 0.4006118
	speed: 0.0042s/iter; left time: 22.2512s
Updating learning rate to 0.0018632570068251014
Validation loss decreased (0.2978 --> 0.2889).  Saving model state dict ...
Epoch: 3 cost time: 4.429696321487427
Epoch: 3, Steps: 1045 | Train Loss: 0.6363374 Vali Loss: 0.2888663 Best vali loss: 0.2888663

best validation loss 0.28886626424200695

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030092835813, 'e_layers': 3, 'learning_rate': 0.0004431480615, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5190162
	speed: 0.0121s/iter; left time: 11.4810s
Updating learning rate to 0.0004431480615
Validation loss decreased (inf --> 0.3095).  Saving model state dict ...
Epoch: 1 cost time: 1.1421971321105957
Epoch: 1, Steps: 131 | Train Loss: 0.5190162 Vali Loss: 0.3094986 Best vali loss: 0.3094986
	iters: 100, epoch: 2 | loss: 0.5441826
	speed: 0.0112s/iter; left time: 9.1848s
Updating learning rate to 0.00022157403075
Validation loss decreased (0.3095 --> 0.2763).  Saving model state dict ...
Epoch: 2 cost time: 0.9094114303588867
Epoch: 2, Steps: 131 | Train Loss: 0.5441826 Vali Loss: 0.2762814 Best vali loss: 0.2762814
	iters: 100, epoch: 3 | loss: 0.4719286
	speed: 0.0115s/iter; left time: 7.8924s
Updating learning rate to 0.000110787015375
Epoch: 3 cost time: 0.9070010185241699
Epoch: 3, Steps: 131 | Train Loss: 0.4719286 Vali Loss: 0.2869478 Best vali loss: 0.2762814

best validation loss 0.2762814286518558

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030159493309, 'e_layers': 3, 'learning_rate': 0.0004688813223, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5184507
	speed: 0.0120s/iter; left time: 11.4078s
Updating learning rate to 0.0004688813223
Validation loss decreased (inf --> 0.2750).  Saving model state dict ...
Epoch: 1 cost time: 1.1315414905548096
Epoch: 1, Steps: 131 | Train Loss: 0.5184507 Vali Loss: 0.2750147 Best vali loss: 0.2750147
	iters: 100, epoch: 2 | loss: 0.5674301
	speed: 0.0113s/iter; left time: 9.2389s
Updating learning rate to 0.00023444066115
Epoch: 2 cost time: 0.9133045673370361
Epoch: 2, Steps: 131 | Train Loss: 0.5674301 Vali Loss: 0.2825327 Best vali loss: 0.2750147
	iters: 100, epoch: 3 | loss: 0.5186278
	speed: 0.0110s/iter; left time: 7.5748s
Updating learning rate to 0.000117220330575
Epoch: 3 cost time: 0.9126465320587158
Epoch: 3, Steps: 131 | Train Loss: 0.5186278 Vali Loss: 0.2773751 Best vali loss: 0.2750147

best validation loss 0.27501468988278843

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030159493309, 'e_layers': 3, 'learning_rate': 0.0004688813223, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3339382
	speed: 0.0125s/iter; left time: 6.9649s
Updating learning rate to 5.86101652875e-05
Epoch: 4 cost time: 1.1401500701904297
Epoch: 4, Steps: 131 | Train Loss: 0.3339382 Vali Loss: 0.2756564 Best vali loss: 0.2750147
	iters: 100, epoch: 5 | loss: 0.3336318
	speed: 0.0110s/iter; left time: 4.6704s
Updating learning rate to 2.930508264375e-05
Validation loss decreased (0.2750 --> 0.2746).  Saving model state dict ...
Epoch: 5 cost time: 0.9073975086212158
Epoch: 5, Steps: 131 | Train Loss: 0.3336318 Vali Loss: 0.2745905 Best vali loss: 0.2745905
	iters: 100, epoch: 6 | loss: 0.3642069
	speed: 0.0114s/iter; left time: 3.3593s
Updating learning rate to 1.4652541321875e-05
Epoch: 6 cost time: 0.9178810119628906
Epoch: 6, Steps: 131 | Train Loss: 0.3642069 Vali Loss: 0.2849970 Best vali loss: 0.2745905
	iters: 100, epoch: 7 | loss: 0.2864178
	speed: 0.0111s/iter; left time: 1.8090s
Updating learning rate to 7.3262706609375e-06
Epoch: 7 cost time: 0.9027526378631592
Epoch: 7, Steps: 131 | Train Loss: 0.2864178 Vali Loss: 0.2802013 Best vali loss: 0.2745905
	iters: 100, epoch: 8 | loss: 0.3030739
	speed: 0.0110s/iter; left time: 0.3518s
Updating learning rate to 3.66313533046875e-06
Epoch: 8 cost time: 0.9039576053619385
Epoch: 8, Steps: 131 | Train Loss: 0.3030739 Vali Loss: 0.2809383 Best vali loss: 0.2745905

best validation loss 0.27459045847848074

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030078194566, 'e_layers': 3, 'learning_rate': 0.0004693444981, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5189671
	speed: 0.0121s/iter; left time: 11.4401s
Updating learning rate to 0.0004693444981
Validation loss decreased (inf --> 0.3059).  Saving model state dict ...
Epoch: 1 cost time: 1.141493797302246
Epoch: 1, Steps: 131 | Train Loss: 0.5189671 Vali Loss: 0.3059321 Best vali loss: 0.3059321
	iters: 100, epoch: 2 | loss: 0.5449075
	speed: 0.0113s/iter; left time: 9.2798s
Updating learning rate to 0.00023467224905
Validation loss decreased (0.3059 --> 0.2789).  Saving model state dict ...
Epoch: 2 cost time: 0.9160425662994385
Epoch: 2, Steps: 131 | Train Loss: 0.5449075 Vali Loss: 0.2788918 Best vali loss: 0.2788918
	iters: 100, epoch: 3 | loss: 0.5137029
	speed: 0.0114s/iter; left time: 7.8376s
Updating learning rate to 0.000117336124525
Epoch: 3 cost time: 0.9098396301269531
Epoch: 3, Steps: 131 | Train Loss: 0.5137029 Vali Loss: 0.2825305 Best vali loss: 0.2788918
	iters: 100, epoch: 4 | loss: 0.3115143
	speed: 0.0110s/iter; left time: 6.1323s
Updating learning rate to 5.86680622625e-05
Validation loss decreased (0.2789 --> 0.2774).  Saving model state dict ...
Epoch: 4 cost time: 0.9057364463806152
Epoch: 4, Steps: 131 | Train Loss: 0.3115143 Vali Loss: 0.2773834 Best vali loss: 0.2773834
	iters: 100, epoch: 5 | loss: 0.3140693
	speed: 0.0114s/iter; left time: 4.8595s
Updating learning rate to 2.933403113125e-05
Epoch: 5 cost time: 0.9145979881286621
Epoch: 5, Steps: 131 | Train Loss: 0.3140693 Vali Loss: 0.2793278 Best vali loss: 0.2773834
	iters: 100, epoch: 6 | loss: 0.3371385
	speed: 0.0111s/iter; left time: 3.2524s
Updating learning rate to 1.4667015565625e-05
Epoch: 6 cost time: 0.9164290428161621
Epoch: 6, Steps: 131 | Train Loss: 0.3371385 Vali Loss: 0.2842806 Best vali loss: 0.2773834
	iters: 100, epoch: 7 | loss: 0.3956741
	speed: 0.0110s/iter; left time: 1.7982s
Updating learning rate to 7.3335077828125e-06
Epoch: 7 cost time: 0.9102308750152588
Epoch: 7, Steps: 131 | Train Loss: 0.3956741 Vali Loss: 0.2853278 Best vali loss: 0.2773834
	iters: 100, epoch: 8 | loss: 0.3565679
	speed: 0.0110s/iter; left time: 0.3530s
Updating learning rate to 3.66675389140625e-06
Epoch: 8 cost time: 0.9128715991973877
Epoch: 8, Steps: 131 | Train Loss: 0.3565679 Vali Loss: 0.2867552 Best vali loss: 0.2773834

best validation loss 0.27738337455661644

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030058994095, 'e_layers': 3, 'learning_rate': 0.0004683042938, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5207250
	speed: 0.0121s/iter; left time: 11.4931s
Updating learning rate to 0.00045048052291448614
Validation loss decreased (inf --> 0.2989).  Saving model state dict ...
Epoch: 1 cost time: 1.1461501121520996
Epoch: 1, Steps: 131 | Train Loss: 0.5207250 Vali Loss: 0.2988646 Best vali loss: 0.2988646
	iters: 100, epoch: 2 | loss: 0.5346860
	speed: 0.0114s/iter; left time: 9.3132s
Updating learning rate to 0.0003997227178023786
Validation loss decreased (0.2989 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 0.9117419719696045
Epoch: 2, Steps: 131 | Train Loss: 0.5346860 Vali Loss: 0.2836640 Best vali loss: 0.2836640
	iters: 100, epoch: 3 | loss: 0.6191078
	speed: 0.0116s/iter; left time: 7.9390s
Updating learning rate to 0.00032375829417134673
Epoch: 3 cost time: 0.9169156551361084
Epoch: 3, Steps: 131 | Train Loss: 0.6191078 Vali Loss: 0.2860615 Best vali loss: 0.2836640
	iters: 100, epoch: 4 | loss: 0.3295400
	speed: 0.0111s/iter; left time: 6.1576s
Updating learning rate to 0.0002341521469
Validation loss decreased (0.2837 --> 0.2826).  Saving model state dict ...
Epoch: 4 cost time: 0.911332368850708
Epoch: 4, Steps: 131 | Train Loss: 0.3295400 Vali Loss: 0.2825794 Best vali loss: 0.2825794
	iters: 100, epoch: 5 | loss: 0.3024589
	speed: 0.0115s/iter; left time: 4.8877s
Updating learning rate to 0.0001445459996286533
Epoch: 5 cost time: 0.9217972755432129
Epoch: 5, Steps: 131 | Train Loss: 0.3024589 Vali Loss: 0.3025761 Best vali loss: 0.2825794
	iters: 100, epoch: 6 | loss: 0.3001572
	speed: 0.0110s/iter; left time: 3.2475s
Updating learning rate to 6.858157599762138e-05
Epoch: 6 cost time: 0.9127569198608398
Epoch: 6, Steps: 131 | Train Loss: 0.3001572 Vali Loss: 0.3119442 Best vali loss: 0.2825794
	iters: 100, epoch: 7 | loss: 0.3352139
	speed: 0.0112s/iter; left time: 1.8243s
Updating learning rate to 1.7823770885513862e-05
Epoch: 7 cost time: 0.9190330505371094
Epoch: 7, Steps: 131 | Train Loss: 0.3352139 Vali Loss: 0.3252034 Best vali loss: 0.2825794
	iters: 100, epoch: 8 | loss: 0.2974404
	speed: 0.0110s/iter; left time: 0.3536s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9170832633972168
Epoch: 8, Steps: 131 | Train Loss: 0.2974404 Vali Loss: 0.3324877 Best vali loss: 0.2825794

best validation loss 0.2825793616304658

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030242768582, 'e_layers': 3, 'learning_rate': 0.0004705395676, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5208915
	speed: 0.0121s/iter; left time: 11.4651s
Updating learning rate to 0.0004526307216711755
Validation loss decreased (inf --> 0.2976).  Saving model state dict ...
Epoch: 1 cost time: 1.141033411026001
Epoch: 1, Steps: 131 | Train Loss: 0.5208915 Vali Loss: 0.2976241 Best vali loss: 0.2976241
	iters: 100, epoch: 2 | loss: 0.5918248
	speed: 0.0114s/iter; left time: 9.3410s
Updating learning rate to 0.0004016306433332729
Validation loss decreased (0.2976 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 0.9217886924743652
Epoch: 2, Steps: 131 | Train Loss: 0.5918248 Vali Loss: 0.2829241 Best vali loss: 0.2829241
	iters: 100, epoch: 3 | loss: 0.5964005
	speed: 0.0116s/iter; left time: 7.9420s
Updating learning rate to 0.0003253036321963766
Epoch: 3 cost time: 0.9201109409332275
Epoch: 3, Steps: 131 | Train Loss: 0.5964005 Vali Loss: 0.3001237 Best vali loss: 0.2829241

best validation loss 0.28292408872599406

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020737358946, 'e_layers': 4, 'learning_rate': 0.0004962891416, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3489687
	speed: 0.0125s/iter; left time: 11.8754s
Updating learning rate to 0.00047740026086591785
Validation loss decreased (inf --> 0.2827).  Saving model state dict ...
Epoch: 1 cost time: 1.1771860122680664
Epoch: 1, Steps: 131 | Train Loss: 0.3489687 Vali Loss: 0.2826717 Best vali loss: 0.2826717
	iters: 100, epoch: 2 | loss: 0.5976030
	speed: 0.0116s/iter; left time: 9.5098s
Updating learning rate to 0.0004236092795273053
Epoch: 2 cost time: 0.9292697906494141
Epoch: 2, Steps: 131 | Train Loss: 0.5976030 Vali Loss: 0.2908829 Best vali loss: 0.2826717
	iters: 100, epoch: 3 | loss: 0.2906418
	speed: 0.0112s/iter; left time: 7.6756s
Updating learning rate to 0.00034310538687650605
Epoch: 3 cost time: 0.9209702014923096
Epoch: 3, Steps: 131 | Train Loss: 0.2906418 Vali Loss: 0.2872042 Best vali loss: 0.2826717

best validation loss 0.2826717115935893

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0040118867338, 'e_layers': 1, 'learning_rate': 6.2002657e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7766815
	speed: 0.0083s/iter; left time: 7.9127s
Updating learning rate to 6.2002657e-05
Validation loss decreased (inf --> 0.2946).  Saving model state dict ...
Epoch: 1 cost time: 0.6341128349304199
Epoch: 1, Steps: 131 | Train Loss: 0.7766815 Vali Loss: 0.2945567 Best vali loss: 0.2945567
	iters: 100, epoch: 2 | loss: 0.3976657
	speed: 0.0050s/iter; left time: 4.1141s
Updating learning rate to 3.10013285e-05
Validation loss decreased (0.2946 --> 0.2840).  Saving model state dict ...
Epoch: 2 cost time: 0.3688042163848877
Epoch: 2, Steps: 131 | Train Loss: 0.3976657 Vali Loss: 0.2839761 Best vali loss: 0.2839761
	iters: 100, epoch: 3 | loss: 0.5737161
	speed: 0.0053s/iter; left time: 3.6407s
Updating learning rate to 1.550066425e-05
Validation loss decreased (0.2840 --> 0.2816).  Saving model state dict ...
Epoch: 3 cost time: 0.3999645709991455
Epoch: 3, Steps: 131 | Train Loss: 0.5737161 Vali Loss: 0.2815620 Best vali loss: 0.2815620

best validation loss 0.2815620479374492

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0040118867338, 'e_layers': 1, 'learning_rate': 6.2002657e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6911413
	speed: 0.0083s/iter; left time: 4.5942s
Updating learning rate to 7.750332125e-06
Validation loss decreased (0.2816 --> 0.2808).  Saving model state dict ...
Epoch: 4 cost time: 0.6255159378051758
Epoch: 4, Steps: 131 | Train Loss: 0.6911413 Vali Loss: 0.2807780 Best vali loss: 0.2807780
	iters: 100, epoch: 5 | loss: 0.3910310
	speed: 0.0052s/iter; left time: 2.2174s
Updating learning rate to 3.8751660625e-06
Validation loss decreased (0.2808 --> 0.2805).  Saving model state dict ...
Epoch: 5 cost time: 0.39882421493530273
Epoch: 5, Steps: 131 | Train Loss: 0.3910310 Vali Loss: 0.2804842 Best vali loss: 0.2804842
	iters: 100, epoch: 6 | loss: 0.5652941
	speed: 0.0055s/iter; left time: 1.6026s
Updating learning rate to 1.93758303125e-06
Validation loss decreased (0.2805 --> 0.2804).  Saving model state dict ...
Epoch: 6 cost time: 0.42780566215515137
Epoch: 6, Steps: 131 | Train Loss: 0.5652941 Vali Loss: 0.2803688 Best vali loss: 0.2803688
	iters: 100, epoch: 7 | loss: 0.5068689
	speed: 0.0056s/iter; left time: 0.9075s
Updating learning rate to 9.68791515625e-07
Validation loss decreased (0.2804 --> 0.2803).  Saving model state dict ...
Epoch: 7 cost time: 0.4294588565826416
Epoch: 7, Steps: 131 | Train Loss: 0.5068689 Vali Loss: 0.2802912 Best vali loss: 0.2802912
	iters: 100, epoch: 8 | loss: 0.4832264
	speed: 0.0054s/iter; left time: 0.1728s
Updating learning rate to 4.843957578125e-07
Validation loss decreased (0.2803 --> 0.2802).  Saving model state dict ...
Epoch: 8 cost time: 0.3966844081878662
Epoch: 8, Steps: 131 | Train Loss: 0.4832264 Vali Loss: 0.2802427 Best vali loss: 0.2802427

best validation loss 0.28024271415396224

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0046966310606, 'e_layers': 1, 'learning_rate': 0.0001521788384, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00014638687623955133
Validation loss decreased (inf --> 0.3078).  Saving model state dict ...
Epoch: 1 cost time: 0.5004000663757324
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3077733 Best vali loss: 0.3077733
Updating learning rate to 0.00012989276349286588
Validation loss decreased (0.3078 --> 0.2903).  Saving model state dict ...
Epoch: 2 cost time: 0.25397181510925293
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2902909 Best vali loss: 0.2902909
Updating learning rate to 0.00010520757930612217
Validation loss decreased (0.2903 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 0.2747020721435547
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2835702 Best vali loss: 0.2835702
Updating learning rate to 7.60894192e-05
Validation loss decreased (0.2836 --> 0.2819).  Saving model state dict ...
Epoch: 4 cost time: 0.2918376922607422
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2819273 Best vali loss: 0.2819273
Updating learning rate to 4.697125909387784e-05
Validation loss decreased (0.2819 --> 0.2811).  Saving model state dict ...
Epoch: 5 cost time: 0.26967310905456543
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2811472 Best vali loss: 0.2811472
Updating learning rate to 2.2286074907134118e-05
Validation loss decreased (0.2811 --> 0.2807).  Saving model state dict ...
Epoch: 6 cost time: 0.2621428966522217
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2807480 Best vali loss: 0.2807480
Updating learning rate to 5.791962160448675e-06
Validation loss decreased (0.2807 --> 0.2806).  Saving model state dict ...
Epoch: 7 cost time: 0.26207470893859863
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2806057 Best vali loss: 0.2806057
Updating learning rate to 0.0
Epoch: 8 cost time: 0.261427640914917
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2806137 Best vali loss: 0.2806057

best validation loss 0.2806057094219849

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030093901987, 'e_layers': 3, 'learning_rate': 0.0004750614978, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5222912
	speed: 0.0122s/iter; left time: 11.6003s
Updating learning rate to 0.00045698054615078785
Validation loss decreased (inf --> 0.2690).  Saving model state dict ...
Epoch: 1 cost time: 1.1499240398406982
Epoch: 1, Steps: 131 | Train Loss: 0.5222912 Vali Loss: 0.2690417 Best vali loss: 0.2690417
	iters: 100, epoch: 2 | loss: 0.5491835
	speed: 0.0112s/iter; left time: 9.1991s
Updating learning rate to 0.000405490352187509
Epoch: 2 cost time: 0.9116389751434326
Epoch: 2, Steps: 131 | Train Loss: 0.5491835 Vali Loss: 0.2767742 Best vali loss: 0.2690417
	iters: 100, epoch: 3 | loss: 0.5198060
	speed: 0.0111s/iter; left time: 7.6457s
Updating learning rate to 0.00032842983118130226
Epoch: 3 cost time: 0.9137165546417236
Epoch: 3, Steps: 131 | Train Loss: 0.5198060 Vali Loss: 0.2925176 Best vali loss: 0.2690417
	iters: 100, epoch: 4 | loss: 0.3166255
	speed: 0.0112s/iter; left time: 6.2219s
Updating learning rate to 0.0002375307489
Epoch: 4 cost time: 0.9111497402191162
Epoch: 4, Steps: 131 | Train Loss: 0.3166255 Vali Loss: 0.2778449 Best vali loss: 0.2690417
	iters: 100, epoch: 5 | loss: 0.3031162
	speed: 0.0111s/iter; left time: 4.7054s
Updating learning rate to 0.00014663166661869773
Epoch: 5 cost time: 0.9172375202178955
Epoch: 5, Steps: 131 | Train Loss: 0.3031162 Vali Loss: 0.2887575 Best vali loss: 0.2690417
	iters: 100, epoch: 6 | loss: 0.3293374
	speed: 0.0111s/iter; left time: 3.2568s
Updating learning rate to 6.957114561249095e-05
Epoch: 6 cost time: 0.9129643440246582
Epoch: 6, Steps: 131 | Train Loss: 0.3293374 Vali Loss: 0.2953130 Best vali loss: 0.2690417
	iters: 100, epoch: 7 | loss: 0.3450881
	speed: 0.0110s/iter; left time: 1.7930s
Updating learning rate to 1.8080951649212164e-05
Epoch: 7 cost time: 0.906519889831543
Epoch: 7, Steps: 131 | Train Loss: 0.3450881 Vali Loss: 0.3032640 Best vali loss: 0.2690417
	iters: 100, epoch: 8 | loss: 0.3017938
	speed: 0.0110s/iter; left time: 0.3519s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9116320610046387
Epoch: 8, Steps: 131 | Train Loss: 0.3017938 Vali Loss: 0.3094653 Best vali loss: 0.2690417

best validation loss 0.2690417377168071

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0085908792001, 'e_layers': 2, 'learning_rate': 0.0027759810217, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3867769
	speed: 0.0088s/iter; left time: 36.1196s
	iters: 200, epoch: 1 | loss: 0.3554243
	speed: 0.0033s/iter; left time: 13.2387s
	iters: 300, epoch: 1 | loss: 0.2567089
	speed: 0.0032s/iter; left time: 12.5949s
	iters: 400, epoch: 1 | loss: 1.3598777
	speed: 0.0032s/iter; left time: 12.2402s
	iters: 500, epoch: 1 | loss: 0.2850120
	speed: 0.0033s/iter; left time: 12.0666s
Updating learning rate to 0.0027759810217
Validation loss decreased (inf --> 0.3224).  Saving model state dict ...
Epoch: 1 cost time: 1.997098445892334
Epoch: 1, Steps: 523 | Train Loss: 0.5287600 Vali Loss: 0.3224031 Best vali loss: 0.3224031
	iters: 100, epoch: 2 | loss: 0.7944554
	speed: 0.0072s/iter; left time: 25.6682s
	iters: 200, epoch: 2 | loss: 0.3479367
	speed: 0.0033s/iter; left time: 11.2695s
	iters: 300, epoch: 2 | loss: 0.5434611
	speed: 0.0033s/iter; left time: 11.2100s
	iters: 400, epoch: 2 | loss: 1.1107558
	speed: 0.0033s/iter; left time: 10.7652s
	iters: 500, epoch: 2 | loss: 0.2919375
	speed: 0.0033s/iter; left time: 10.2847s
Updating learning rate to 0.00138799051085
Validation loss decreased (0.3224 --> 0.3203).  Saving model state dict ...
Epoch: 2 cost time: 1.7567424774169922
Epoch: 2, Steps: 523 | Train Loss: 0.6177093 Vali Loss: 0.3203365 Best vali loss: 0.3203365
	iters: 100, epoch: 3 | loss: 0.5551848
	speed: 0.0070s/iter; left time: 21.1929s
	iters: 200, epoch: 3 | loss: 0.4758818
	speed: 0.0033s/iter; left time: 9.6037s
	iters: 300, epoch: 3 | loss: 0.5480956
	speed: 0.0034s/iter; left time: 9.7641s
	iters: 400, epoch: 3 | loss: 0.7431374
	speed: 0.0035s/iter; left time: 9.6218s
	iters: 500, epoch: 3 | loss: 0.4258288
	speed: 0.0035s/iter; left time: 9.3169s
Updating learning rate to 0.000693995255425
Validation loss decreased (0.3203 --> 0.3179).  Saving model state dict ...
Epoch: 3 cost time: 1.8106343746185303
Epoch: 3, Steps: 523 | Train Loss: 0.5496257 Vali Loss: 0.3179358 Best vali loss: 0.3179358

best validation loss 0.3179357935223893

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0028351780776, 'e_layers': 2, 'learning_rate': 0.0036756291679, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3838826
	speed: 0.0088s/iter; left time: 36.1050s
	iters: 200, epoch: 1 | loss: 0.4297267
	speed: 0.0034s/iter; left time: 13.5454s
	iters: 300, epoch: 1 | loss: 0.7084798
	speed: 0.0034s/iter; left time: 13.0677s
	iters: 400, epoch: 1 | loss: 0.7504906
	speed: 0.0033s/iter; left time: 12.6255s
	iters: 500, epoch: 1 | loss: 0.3061807
	speed: 0.0033s/iter; left time: 12.2778s
Updating learning rate to 0.0036756291679
Validation loss decreased (inf --> 0.3214).  Saving model state dict ...
Epoch: 1 cost time: 2.026829957962036
Epoch: 1, Steps: 523 | Train Loss: 0.5157521 Vali Loss: 0.3213845 Best vali loss: 0.3213845
	iters: 100, epoch: 2 | loss: 0.5199780
	speed: 0.0078s/iter; left time: 27.8861s
	iters: 200, epoch: 2 | loss: 0.8911880
	speed: 0.0035s/iter; left time: 12.0643s
	iters: 300, epoch: 2 | loss: 0.7992174
	speed: 0.0033s/iter; left time: 10.9544s
	iters: 400, epoch: 2 | loss: 0.3352474
	speed: 0.0033s/iter; left time: 10.6182s
	iters: 500, epoch: 2 | loss: 0.5098506
	speed: 0.0032s/iter; left time: 10.2453s
Updating learning rate to 0.00183781458395
Epoch: 2 cost time: 1.777451515197754
Epoch: 2, Steps: 523 | Train Loss: 0.6110963 Vali Loss: 0.3322542 Best vali loss: 0.3213845
	iters: 100, epoch: 3 | loss: 1.7041532
	speed: 0.0072s/iter; left time: 21.9771s
	iters: 200, epoch: 3 | loss: 0.7799761
	speed: 0.0030s/iter; left time: 8.8673s
	iters: 300, epoch: 3 | loss: 1.1888106
	speed: 0.0030s/iter; left time: 8.5989s
	iters: 400, epoch: 3 | loss: 1.2568660
	speed: 0.0030s/iter; left time: 8.1603s
	iters: 500, epoch: 3 | loss: 0.9704608
	speed: 0.0030s/iter; left time: 7.9267s
Updating learning rate to 0.000918907291975
Epoch: 3 cost time: 1.611604928970337
Epoch: 3, Steps: 523 | Train Loss: 1.1800533 Vali Loss: 0.3232255 Best vali loss: 0.3213845

best validation loss 0.32138447669103004

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013404805012, 'e_layers': 4, 'learning_rate': 0.0045335490613, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0445009
	speed: 0.0104s/iter; left time: 42.5173s
	iters: 200, epoch: 1 | loss: 0.4821568
	speed: 0.0049s/iter; left time: 19.3393s
	iters: 300, epoch: 1 | loss: 0.8778389
	speed: 0.0048s/iter; left time: 18.7948s
	iters: 400, epoch: 1 | loss: 0.5828004
	speed: 0.0049s/iter; left time: 18.4121s
	iters: 500, epoch: 1 | loss: 0.4740634
	speed: 0.0049s/iter; left time: 17.9927s
Updating learning rate to 0.004361001124335413
Validation loss decreased (inf --> 0.3209).  Saving model state dict ...
Epoch: 1 cost time: 2.814995050430298
Epoch: 1, Steps: 523 | Train Loss: 0.6922721 Vali Loss: 0.3209061 Best vali loss: 0.3209061
	iters: 100, epoch: 2 | loss: 0.4410646
	speed: 0.0095s/iter; left time: 33.7745s
	iters: 200, epoch: 2 | loss: 0.7612476
	speed: 0.0045s/iter; left time: 15.4963s
	iters: 300, epoch: 2 | loss: 0.4111401
	speed: 0.0045s/iter; left time: 14.9898s
	iters: 400, epoch: 2 | loss: 0.4103706
	speed: 0.0045s/iter; left time: 14.6150s
	iters: 500, epoch: 2 | loss: 0.8441563
	speed: 0.0045s/iter; left time: 14.1419s
Updating learning rate to 0.0038696261726935684
Epoch: 2 cost time: 2.3789565563201904
Epoch: 2, Steps: 523 | Train Loss: 0.5735958 Vali Loss: 0.3251108 Best vali loss: 0.3209061
	iters: 100, epoch: 3 | loss: 0.3689256
	speed: 0.0094s/iter; left time: 28.5377s
	iters: 200, epoch: 3 | loss: 0.3379510
	speed: 0.0045s/iter; left time: 13.3364s
	iters: 300, epoch: 3 | loss: 0.2458961
	speed: 0.0045s/iter; left time: 12.8926s
	iters: 400, epoch: 3 | loss: 0.3585630
	speed: 0.0049s/iter; left time: 13.4178s
	iters: 500, epoch: 3 | loss: 0.9526231
	speed: 0.0050s/iter; left time: 13.3086s
Updating learning rate to 0.0031342315884369076
Epoch: 3 cost time: 2.508073568344116
Epoch: 3, Steps: 523 | Train Loss: 0.4527918 Vali Loss: 0.3222170 Best vali loss: 0.3209061

best validation loss 0.32090611216657533

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0085908792001, 'e_layers': 2, 'learning_rate': 0.0027759810217, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3939063
	speed: 0.0087s/iter; left time: 21.8232s
	iters: 200, epoch: 4 | loss: 0.3901120
	speed: 0.0034s/iter; left time: 8.2044s
	iters: 300, epoch: 4 | loss: 0.2467460
	speed: 0.0035s/iter; left time: 8.1467s
	iters: 400, epoch: 4 | loss: 1.3473060
	speed: 0.0037s/iter; left time: 8.0888s
	iters: 500, epoch: 4 | loss: 0.2833035
	speed: 0.0036s/iter; left time: 7.6136s
Updating learning rate to 0.0003469976277125
Epoch: 4 cost time: 2.087209463119507
Epoch: 4, Steps: 523 | Train Loss: 0.5322748 Vali Loss: 0.3191086 Best vali loss: 0.3179358
	iters: 100, epoch: 5 | loss: 0.7803503
	speed: 0.0073s/iter; left time: 14.6436s
	iters: 200, epoch: 5 | loss: 0.3496083
	speed: 0.0034s/iter; left time: 6.4871s
	iters: 300, epoch: 5 | loss: 0.5633649
	speed: 0.0034s/iter; left time: 6.1513s
	iters: 400, epoch: 5 | loss: 1.1159995
	speed: 0.0034s/iter; left time: 5.8195s
	iters: 500, epoch: 5 | loss: 0.2872804
	speed: 0.0035s/iter; left time: 5.6272s
Updating learning rate to 0.00017349881385625
Epoch: 5 cost time: 1.8444135189056396
Epoch: 5, Steps: 523 | Train Loss: 0.6193207 Vali Loss: 0.3183982 Best vali loss: 0.3179358
	iters: 100, epoch: 6 | loss: 0.5147207
	speed: 0.0072s/iter; left time: 10.5881s
	iters: 200, epoch: 6 | loss: 0.4754494
	speed: 0.0034s/iter; left time: 4.6996s
	iters: 300, epoch: 6 | loss: 0.5461042
	speed: 0.0034s/iter; left time: 4.3315s
	iters: 400, epoch: 6 | loss: 0.7434269
	speed: 0.0034s/iter; left time: 3.9784s
	iters: 500, epoch: 6 | loss: 0.4269702
	speed: 0.0034s/iter; left time: 3.6768s
Updating learning rate to 8.6749406928125e-05
Validation loss decreased (0.3179 --> 0.3177).  Saving model state dict ...
Epoch: 6 cost time: 1.8229320049285889
Epoch: 6, Steps: 523 | Train Loss: 0.5413343 Vali Loss: 0.3176968 Best vali loss: 0.3176968
	iters: 100, epoch: 7 | loss: 0.4029185
	speed: 0.0072s/iter; left time: 6.7790s
	iters: 200, epoch: 7 | loss: 0.4004329
	speed: 0.0030s/iter; left time: 2.5407s
	iters: 300, epoch: 7 | loss: 0.3888386
	speed: 0.0030s/iter; left time: 2.2412s
	iters: 400, epoch: 7 | loss: 0.7271786
	speed: 0.0031s/iter; left time: 1.9927s
	iters: 500, epoch: 7 | loss: 0.9060093
	speed: 0.0032s/iter; left time: 1.7435s
Updating learning rate to 4.33747034640625e-05
Validation loss decreased (0.3177 --> 0.3171).  Saving model state dict ...
Epoch: 7 cost time: 1.6506190299987793
Epoch: 7, Steps: 523 | Train Loss: 0.5650756 Vali Loss: 0.3170846 Best vali loss: 0.3170846
	iters: 100, epoch: 8 | loss: 0.3884641
	speed: 0.0071s/iter; left time: 3.0172s
	iters: 200, epoch: 8 | loss: 0.9368923
	speed: 0.0032s/iter; left time: 1.0302s
	iters: 300, epoch: 8 | loss: 1.0313098
	speed: 0.0032s/iter; left time: 0.7121s
	iters: 400, epoch: 8 | loss: 0.4663579
	speed: 0.0031s/iter; left time: 0.3906s
	iters: 500, epoch: 8 | loss: 0.3636945
	speed: 0.0030s/iter; left time: 0.0722s
Updating learning rate to 2.168735173203125e-05
Validation loss decreased (0.3171 --> 0.3161).  Saving model state dict ...
Epoch: 8 cost time: 1.6786901950836182
Epoch: 8, Steps: 523 | Train Loss: 0.6373437 Vali Loss: 0.3161372 Best vali loss: 0.3161372

best validation loss 0.3161372050958834

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028473535761, 'e_layers': 3, 'learning_rate': 0.000474861519, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5227953
	speed: 0.0120s/iter; left time: 11.3427s
Updating learning rate to 0.00045678817859065975
Validation loss decreased (inf --> 0.2780).  Saving model state dict ...
Epoch: 1 cost time: 1.1383602619171143
Epoch: 1, Steps: 131 | Train Loss: 0.5227953 Vali Loss: 0.2780265 Best vali loss: 0.2780265
	iters: 100, epoch: 2 | loss: 0.5732219
	speed: 0.0113s/iter; left time: 9.2470s
Updating learning rate to 0.0004053196596047223
Epoch: 2 cost time: 0.9118518829345703
Epoch: 2, Steps: 131 | Train Loss: 0.5732219 Vali Loss: 0.2831895 Best vali loss: 0.2780265
	iters: 100, epoch: 3 | loss: 0.5704776
	speed: 0.0111s/iter; left time: 7.6146s
Updating learning rate to 0.0003282915774945102
Epoch: 3 cost time: 0.9104173183441162
Epoch: 3, Steps: 131 | Train Loss: 0.5704776 Vali Loss: 0.3016954 Best vali loss: 0.2780265
	iters: 100, epoch: 4 | loss: 0.3306838
	speed: 0.0110s/iter; left time: 6.1402s
Updating learning rate to 0.0002374307595
Epoch: 4 cost time: 0.9170935153961182
Epoch: 4, Steps: 131 | Train Loss: 0.3306838 Vali Loss: 0.2883449 Best vali loss: 0.2780265
	iters: 100, epoch: 5 | loss: 0.3051069
	speed: 0.0111s/iter; left time: 4.7045s
Updating learning rate to 0.00014656994150548988
Epoch: 5 cost time: 0.9133985042572021
Epoch: 5, Steps: 131 | Train Loss: 0.3051069 Vali Loss: 0.2918645 Best vali loss: 0.2780265
	iters: 100, epoch: 6 | loss: 0.3222583
	speed: 0.0109s/iter; left time: 3.2131s
Updating learning rate to 6.954185939527772e-05
Epoch: 6 cost time: 0.9058213233947754
Epoch: 6, Steps: 131 | Train Loss: 0.3222583 Vali Loss: 0.2953489 Best vali loss: 0.2780265
	iters: 100, epoch: 7 | loss: 0.3585359
	speed: 0.0110s/iter; left time: 1.7880s
Updating learning rate to 1.8073340409340247e-05
Epoch: 7 cost time: 0.9081630706787109
Epoch: 7, Steps: 131 | Train Loss: 0.3585359 Vali Loss: 0.3000900 Best vali loss: 0.2780265
	iters: 100, epoch: 8 | loss: 0.3123925
	speed: 0.0110s/iter; left time: 0.3531s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9086868762969971
Epoch: 8, Steps: 131 | Train Loss: 0.3123925 Vali Loss: 0.3048496 Best vali loss: 0.2780265

best validation loss 0.27802652142202156

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029829928539, 'e_layers': 1, 'learning_rate': 0.0004920100678, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2383699
	speed: 0.0077s/iter; left time: 63.2073s
	iters: 200, epoch: 1 | loss: 0.2878563
	speed: 0.0024s/iter; left time: 19.2253s
	iters: 300, epoch: 1 | loss: 0.2516053
	speed: 0.0024s/iter; left time: 19.1292s
	iters: 400, epoch: 1 | loss: 1.5473571
	speed: 0.0024s/iter; left time: 18.8058s
	iters: 500, epoch: 1 | loss: 1.4238474
	speed: 0.0024s/iter; left time: 18.6810s
	iters: 600, epoch: 1 | loss: 0.4502476
	speed: 0.0024s/iter; left time: 18.4190s
	iters: 700, epoch: 1 | loss: 0.2302501
	speed: 0.0024s/iter; left time: 18.2669s
	iters: 800, epoch: 1 | loss: 0.4495532
	speed: 0.0024s/iter; left time: 18.1650s
	iters: 900, epoch: 1 | loss: 1.2113577
	speed: 0.0023s/iter; left time: 17.4729s
	iters: 1000, epoch: 1 | loss: 0.9876493
	speed: 0.0024s/iter; left time: 17.4854s
Updating learning rate to 0.0004920100678
Validation loss decreased (inf --> 0.2924).  Saving model state dict ...
Epoch: 1 cost time: 2.7340505123138428
Epoch: 1, Steps: 1045 | Train Loss: 0.7078094 Vali Loss: 0.2924116 Best vali loss: 0.2924116
	iters: 100, epoch: 2 | loss: 0.5119486
	speed: 0.0077s/iter; left time: 55.2722s
	iters: 200, epoch: 2 | loss: 0.7301681
	speed: 0.0020s/iter; left time: 14.3722s
	iters: 300, epoch: 2 | loss: 0.2092330
	speed: 0.0020s/iter; left time: 14.1796s
	iters: 400, epoch: 2 | loss: 0.2311901
	speed: 0.0020s/iter; left time: 13.6940s
	iters: 500, epoch: 2 | loss: 0.4885707
	speed: 0.0020s/iter; left time: 13.5272s
	iters: 600, epoch: 2 | loss: 0.7275288
	speed: 0.0020s/iter; left time: 13.4592s
	iters: 700, epoch: 2 | loss: 0.3484491
	speed: 0.0020s/iter; left time: 13.2895s
	iters: 800, epoch: 2 | loss: 0.4567420
	speed: 0.0020s/iter; left time: 13.2170s
	iters: 900, epoch: 2 | loss: 0.3257198
	speed: 0.0020s/iter; left time: 13.0910s
	iters: 1000, epoch: 2 | loss: 0.3936859
	speed: 0.0020s/iter; left time: 12.6682s
Updating learning rate to 0.0002460050339
Validation loss decreased (0.2924 --> 0.2908).  Saving model state dict ...
Epoch: 2 cost time: 2.1353578567504883
Epoch: 2, Steps: 1045 | Train Loss: 0.4423236 Vali Loss: 0.2908110 Best vali loss: 0.2908110
	iters: 100, epoch: 3 | loss: 0.7261066
	speed: 0.0075s/iter; left time: 46.0320s
	iters: 200, epoch: 3 | loss: 0.3735105
	speed: 0.0020s/iter; left time: 12.4131s
	iters: 300, epoch: 3 | loss: 0.1968558
	speed: 0.0020s/iter; left time: 12.1653s
	iters: 400, epoch: 3 | loss: 0.2660770
	speed: 0.0022s/iter; left time: 12.9665s
	iters: 500, epoch: 3 | loss: 0.4645471
	speed: 0.0022s/iter; left time: 12.8839s
	iters: 600, epoch: 3 | loss: 0.3248846
	speed: 0.0022s/iter; left time: 12.7277s
	iters: 700, epoch: 3 | loss: 0.3628252
	speed: 0.0022s/iter; left time: 12.4362s
	iters: 800, epoch: 3 | loss: 0.3356257
	speed: 0.0022s/iter; left time: 12.2021s
	iters: 900, epoch: 3 | loss: 1.0555457
	speed: 0.0022s/iter; left time: 11.9717s
	iters: 1000, epoch: 3 | loss: 0.3561732
	speed: 0.0022s/iter; left time: 11.7695s
Updating learning rate to 0.00012300251695
Epoch: 3 cost time: 2.314647674560547
Epoch: 3, Steps: 1045 | Train Loss: 0.4462152 Vali Loss: 0.3063422 Best vali loss: 0.2908110
	iters: 100, epoch: 4 | loss: 0.2987019
	speed: 0.0076s/iter; left time: 38.8110s
	iters: 200, epoch: 4 | loss: 0.1984798
	speed: 0.0020s/iter; left time: 10.3021s
	iters: 300, epoch: 4 | loss: 0.4409896
	speed: 0.0020s/iter; left time: 10.0761s
	iters: 400, epoch: 4 | loss: 0.3457311
	speed: 0.0020s/iter; left time: 9.8717s
	iters: 500, epoch: 4 | loss: 0.4014493
	speed: 0.0021s/iter; left time: 9.6934s
	iters: 600, epoch: 4 | loss: 0.1644551
	speed: 0.0021s/iter; left time: 9.6645s
	iters: 700, epoch: 4 | loss: 0.4709256
	speed: 0.0022s/iter; left time: 9.7749s
	iters: 800, epoch: 4 | loss: 0.3295889
	speed: 0.0021s/iter; left time: 9.3472s
	iters: 900, epoch: 4 | loss: 0.3066738
	speed: 0.0020s/iter; left time: 8.8542s
	iters: 1000, epoch: 4 | loss: 0.4902624
	speed: 0.0020s/iter; left time: 8.5716s
Updating learning rate to 6.1501258475e-05
Epoch: 4 cost time: 2.200019359588623
Epoch: 4, Steps: 1045 | Train Loss: 0.3447258 Vali Loss: 0.3044513 Best vali loss: 0.2908110
	iters: 100, epoch: 5 | loss: 0.3263888
	speed: 0.0075s/iter; left time: 30.7046s
	iters: 200, epoch: 5 | loss: 0.2334331
	speed: 0.0020s/iter; left time: 8.0702s
	iters: 300, epoch: 5 | loss: 0.6625587
	speed: 0.0020s/iter; left time: 7.8391s
	iters: 400, epoch: 5 | loss: 0.4799659
	speed: 0.0020s/iter; left time: 7.5717s
	iters: 500, epoch: 5 | loss: 0.3594295
	speed: 0.0020s/iter; left time: 7.5010s
	iters: 600, epoch: 5 | loss: 0.6117763
	speed: 0.0021s/iter; left time: 7.4490s
	iters: 700, epoch: 5 | loss: 0.2975623
	speed: 0.0020s/iter; left time: 6.9919s
	iters: 800, epoch: 5 | loss: 0.2068948
	speed: 0.0020s/iter; left time: 6.7667s
	iters: 900, epoch: 5 | loss: 0.4655481
	speed: 0.0020s/iter; left time: 6.5926s
	iters: 1000, epoch: 5 | loss: 0.2295246
	speed: 0.0020s/iter; left time: 6.3940s
Updating learning rate to 3.07506292375e-05
Epoch: 5 cost time: 2.160008430480957
Epoch: 5, Steps: 1045 | Train Loss: 0.3873082 Vali Loss: 0.3127590 Best vali loss: 0.2908110
	iters: 100, epoch: 6 | loss: 0.4271567
	speed: 0.0074s/iter; left time: 22.4429s
	iters: 200, epoch: 6 | loss: 0.6829481
	speed: 0.0020s/iter; left time: 6.0107s
	iters: 300, epoch: 6 | loss: 0.5172976
	speed: 0.0021s/iter; left time: 5.8508s
	iters: 400, epoch: 6 | loss: 0.1770395
	speed: 0.0020s/iter; left time: 5.6078s
	iters: 500, epoch: 6 | loss: 0.4057996
	speed: 0.0020s/iter; left time: 5.2935s
	iters: 600, epoch: 6 | loss: 0.3413337
	speed: 0.0020s/iter; left time: 5.1026s
	iters: 700, epoch: 6 | loss: 0.2235199
	speed: 0.0020s/iter; left time: 4.9675s
	iters: 800, epoch: 6 | loss: 0.2257727
	speed: 0.0020s/iter; left time: 4.6715s
	iters: 900, epoch: 6 | loss: 0.1645962
	speed: 0.0020s/iter; left time: 4.5161s
	iters: 1000, epoch: 6 | loss: 0.4865005
	speed: 0.0021s/iter; left time: 4.4180s
Updating learning rate to 1.537531461875e-05
Epoch: 6 cost time: 2.164916753768921
Epoch: 6, Steps: 1045 | Train Loss: 0.3651964 Vali Loss: 0.3107291 Best vali loss: 0.2908110
	iters: 100, epoch: 7 | loss: 0.3148106
	speed: 0.0079s/iter; left time: 15.6523s
	iters: 200, epoch: 7 | loss: 0.7959331
	speed: 0.0024s/iter; left time: 4.6328s
	iters: 300, epoch: 7 | loss: 0.7179802
	speed: 0.0024s/iter; left time: 4.3674s
	iters: 400, epoch: 7 | loss: 0.3831908
	speed: 0.0024s/iter; left time: 4.1365s
	iters: 500, epoch: 7 | loss: 0.2421648
	speed: 0.0024s/iter; left time: 3.8332s
	iters: 600, epoch: 7 | loss: 0.2842964
	speed: 0.0024s/iter; left time: 3.5602s
	iters: 700, epoch: 7 | loss: 0.1825213
	speed: 0.0024s/iter; left time: 3.3625s
	iters: 800, epoch: 7 | loss: 0.7373357
	speed: 0.0024s/iter; left time: 3.1398s
	iters: 900, epoch: 7 | loss: 0.3416317
	speed: 0.0024s/iter; left time: 2.8837s
	iters: 1000, epoch: 7 | loss: 0.2418531
	speed: 0.0025s/iter; left time: 2.6839s
Updating learning rate to 7.687657309375e-06
Epoch: 7 cost time: 2.5617334842681885
Epoch: 7, Steps: 1045 | Train Loss: 0.4241718 Vali Loss: 0.3114468 Best vali loss: 0.2908110
	iters: 100, epoch: 8 | loss: 0.3569538
	speed: 0.0074s/iter; left time: 7.0348s
	iters: 200, epoch: 8 | loss: 0.1874126
	speed: 0.0020s/iter; left time: 1.7007s
	iters: 300, epoch: 8 | loss: 0.3356481
	speed: 0.0020s/iter; left time: 1.4995s
	iters: 400, epoch: 8 | loss: 0.5414028
	speed: 0.0020s/iter; left time: 1.2921s
	iters: 500, epoch: 8 | loss: 0.4152540
	speed: 0.0020s/iter; left time: 1.1019s
	iters: 600, epoch: 8 | loss: 0.2436126
	speed: 0.0020s/iter; left time: 0.8927s
	iters: 700, epoch: 8 | loss: 0.3844472
	speed: 0.0020s/iter; left time: 0.6958s
	iters: 800, epoch: 8 | loss: 0.2897227
	speed: 0.0020s/iter; left time: 0.4946s
	iters: 900, epoch: 8 | loss: 0.3442301
	speed: 0.0020s/iter; left time: 0.2932s
	iters: 1000, epoch: 8 | loss: 0.2455189
	speed: 0.0020s/iter; left time: 0.0920s
Updating learning rate to 3.8438286546875e-06
Epoch: 8 cost time: 2.139232873916626
Epoch: 8, Steps: 1045 | Train Loss: 0.3344203 Vali Loss: 0.3133361 Best vali loss: 0.2908110

best validation loss 0.29081095357772896

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017921773152, 'e_layers': 3, 'learning_rate': 0.000508060704, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004887237948494376
Validation loss decreased (inf --> 0.2794).  Saving model state dict ...
Epoch: 1 cost time: 0.9649257659912109
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2794459 Best vali loss: 0.2794459
Updating learning rate to 0.0004336569365264056
Epoch: 2 cost time: 0.724292516708374
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3192623 Best vali loss: 0.2794459
Updating learning rate to 0.0003512435590282719
Epoch: 3 cost time: 0.7257094383239746
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2927482 Best vali loss: 0.2794459

best validation loss 0.27944589643152107

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001026524843, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596901
	speed: 0.0105s/iter; left time: 9.9649s
Updating learning rate to 0.00022560087439875675
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9293310642242432
Epoch: 1, Steps: 131 | Train Loss: 0.5596901 Vali Loss: 0.2756502 Best vali loss: 0.2756502
	iters: 100, epoch: 2 | loss: 0.3247090
	speed: 0.0089s/iter; left time: 7.2955s
Updating learning rate to 0.0002001813398498083
Validation loss decreased (0.2757 --> 0.2706).  Saving model state dict ...
Epoch: 2 cost time: 0.6998858451843262
Epoch: 2, Steps: 131 | Train Loss: 0.3247090 Vali Loss: 0.2706312 Best vali loss: 0.2706312
	iters: 100, epoch: 3 | loss: 0.4644425
	speed: 0.0089s/iter; left time: 6.0938s
Updating learning rate to 0.0001621383179595776
Epoch: 3 cost time: 0.7005476951599121
Epoch: 3, Steps: 131 | Train Loss: 0.4644425 Vali Loss: 0.2814344 Best vali loss: 0.2706312

best validation loss 0.2706311563658156

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0014805281484, 'e_layers': 4, 'learning_rate': 0.0010016524614, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0780406
	speed: 0.0104s/iter; left time: 42.6455s
	iters: 200, epoch: 1 | loss: 0.4312440
	speed: 0.0052s/iter; left time: 20.6429s
	iters: 300, epoch: 1 | loss: 0.4806974
	speed: 0.0052s/iter; left time: 20.2364s
	iters: 400, epoch: 1 | loss: 0.3273431
	speed: 0.0052s/iter; left time: 19.5256s
	iters: 500, epoch: 1 | loss: 1.0017087
	speed: 0.0052s/iter; left time: 19.2768s
Updating learning rate to 0.0009635293345885059
Validation loss decreased (inf --> 0.3312).  Saving model state dict ...
Epoch: 1 cost time: 2.975447654724121
Epoch: 1, Steps: 523 | Train Loss: 0.6638068 Vali Loss: 0.3311901 Best vali loss: 0.3311901
	iters: 100, epoch: 2 | loss: 0.9200027
	speed: 0.0102s/iter; left time: 36.3510s
	iters: 200, epoch: 2 | loss: 0.5486521
	speed: 0.0048s/iter; left time: 16.4781s
	iters: 300, epoch: 2 | loss: 0.6984693
	speed: 0.0047s/iter; left time: 15.9034s
	iters: 400, epoch: 2 | loss: 0.3779633
	speed: 0.0047s/iter; left time: 15.2077s
	iters: 500, epoch: 2 | loss: 0.9052970
	speed: 0.0048s/iter; left time: 15.1848s
Updating learning rate to 0.0008549638546240683
Validation loss decreased (0.3312 --> 0.3207).  Saving model state dict ...
Epoch: 2 cost time: 2.5217535495758057
Epoch: 2, Steps: 523 | Train Loss: 0.6900769 Vali Loss: 0.3207328 Best vali loss: 0.3207328
	iters: 100, epoch: 3 | loss: 0.5845563
	speed: 0.0098s/iter; left time: 29.7082s
	iters: 200, epoch: 3 | loss: 0.2495234
	speed: 0.0047s/iter; left time: 13.7338s
	iters: 300, epoch: 3 | loss: 0.5643642
	speed: 0.0046s/iter; left time: 13.2002s
	iters: 400, epoch: 3 | loss: 0.2840156
	speed: 0.0047s/iter; left time: 12.8795s
	iters: 500, epoch: 3 | loss: 0.2497320
	speed: 0.0047s/iter; left time: 12.3252s
Updating learning rate to 0.0006924841316827464
Epoch: 3 cost time: 2.4796926975250244
Epoch: 3, Steps: 523 | Train Loss: 0.3864383 Vali Loss: 0.3274332 Best vali loss: 0.3207328

best validation loss 0.32073284383598605

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001026524843, 'e_layers': 2, 'learning_rate': 0.0002345270279, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4197293
	speed: 0.0107s/iter; left time: 5.9360s
Updating learning rate to 0.00011726351395
Epoch: 4 cost time: 0.9300580024719238
Epoch: 4, Steps: 131 | Train Loss: 0.4197293 Vali Loss: 0.2877485 Best vali loss: 0.2706312
	iters: 100, epoch: 5 | loss: 0.2692283
	speed: 0.0086s/iter; left time: 3.6674s
Updating learning rate to 7.238870994042242e-05
Epoch: 5 cost time: 0.6957905292510986
Epoch: 5, Steps: 131 | Train Loss: 0.2692283 Vali Loss: 0.2920325 Best vali loss: 0.2706312
	iters: 100, epoch: 6 | loss: 0.3796405
	speed: 0.0086s/iter; left time: 2.5430s
Updating learning rate to 3.4345688050191696e-05
Epoch: 6 cost time: 0.6995618343353271
Epoch: 6, Steps: 131 | Train Loss: 0.3796405 Vali Loss: 0.3007253 Best vali loss: 0.2706312
	iters: 100, epoch: 7 | loss: 0.3947589
	speed: 0.0087s/iter; left time: 1.4213s
Updating learning rate to 8.926153501243248e-06
Epoch: 7 cost time: 0.7120199203491211
Epoch: 7, Steps: 131 | Train Loss: 0.3947589 Vali Loss: 0.3079136 Best vali loss: 0.2706312
	iters: 100, epoch: 8 | loss: 0.2963741
	speed: 0.0087s/iter; left time: 0.2798s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7061355113983154
Epoch: 8, Steps: 131 | Train Loss: 0.2963741 Vali Loss: 0.3087448 Best vali loss: 0.2706312

best validation loss 0.2706311563658156

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015825554482, 'e_layers': 1, 'learning_rate': 0.0008014580518, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4392225
	speed: 0.0071s/iter; left time: 14.1798s
	iters: 200, epoch: 1 | loss: 0.7463240
	speed: 0.0025s/iter; left time: 4.8273s
Updating learning rate to 0.0007709543710121953
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 0.9348015785217285
Epoch: 1, Steps: 262 | Train Loss: 0.5927733 Vali Loss: 0.2822384 Best vali loss: 0.2822384
	iters: 100, epoch: 2 | loss: 0.3882566
	speed: 0.0065s/iter; left time: 11.3004s
	iters: 200, epoch: 2 | loss: 0.4176469
	speed: 0.0027s/iter; left time: 4.3703s
Updating learning rate to 0.0006840872375321696
Validation loss decreased (0.2822 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 0.7354121208190918
Epoch: 2, Steps: 262 | Train Loss: 0.4029517 Vali Loss: 0.2809779 Best vali loss: 0.2809779
	iters: 100, epoch: 3 | loss: 0.5835998
	speed: 0.0063s/iter; left time: 9.2452s
	iters: 200, epoch: 3 | loss: 0.4368602
	speed: 0.0026s/iter; left time: 3.5738s
Updating learning rate to 0.0005540813849797309
Epoch: 3 cost time: 0.7276592254638672
Epoch: 3, Steps: 262 | Train Loss: 0.5102300 Vali Loss: 0.2834924 Best vali loss: 0.2809779
	iters: 100, epoch: 4 | loss: 0.4188705
	speed: 0.0063s/iter; left time: 7.6407s
	iters: 200, epoch: 4 | loss: 0.6532267
	speed: 0.0026s/iter; left time: 2.8654s
Updating learning rate to 0.0004007290259
Epoch: 4 cost time: 0.7135274410247803
Epoch: 4, Steps: 262 | Train Loss: 0.5360486 Vali Loss: 0.2875031 Best vali loss: 0.2809779
	iters: 100, epoch: 5 | loss: 0.4526599
	speed: 0.0059s/iter; left time: 5.5907s
	iters: 200, epoch: 5 | loss: 0.2994128
	speed: 0.0023s/iter; left time: 1.9551s
Updating learning rate to 0.00024737666682026903
Epoch: 5 cost time: 0.640838623046875
Epoch: 5, Steps: 262 | Train Loss: 0.3760364 Vali Loss: 0.2822592 Best vali loss: 0.2809779
	iters: 100, epoch: 6 | loss: 0.6149515
	speed: 0.0058s/iter; left time: 3.9557s
	iters: 200, epoch: 6 | loss: 0.7408990
	speed: 0.0024s/iter; left time: 1.4349s
Updating learning rate to 0.00011737081426783038
Epoch: 6 cost time: 0.6851146221160889
Epoch: 6, Steps: 262 | Train Loss: 0.6779253 Vali Loss: 0.2874119 Best vali loss: 0.2809779
	iters: 100, epoch: 7 | loss: 0.6196285
	speed: 0.0064s/iter; left time: 2.7245s
	iters: 200, epoch: 7 | loss: 0.2230613
	speed: 0.0023s/iter; left time: 0.7624s
Updating learning rate to 3.0503680787804683e-05
Epoch: 7 cost time: 0.6947011947631836
Epoch: 7, Steps: 262 | Train Loss: 0.4213449 Vali Loss: 0.2890056 Best vali loss: 0.2809779
	iters: 100, epoch: 8 | loss: 0.4045459
	speed: 0.0061s/iter; left time: 0.9872s
	iters: 200, epoch: 8 | loss: 0.4126697
	speed: 0.0024s/iter; left time: 0.1511s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.66489577293396
Epoch: 8, Steps: 262 | Train Loss: 0.4086078 Vali Loss: 0.2880171 Best vali loss: 0.2809779

best validation loss 0.2809779389711861

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021206306518, 'e_layers': 3, 'learning_rate': 0.0004747931954, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5539395
	speed: 0.0108s/iter; left time: 10.2683s
Updating learning rate to 0.000456722455402846
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 0.9712390899658203
Epoch: 1, Steps: 131 | Train Loss: 0.5539395 Vali Loss: 0.2844982 Best vali loss: 0.2844982
	iters: 100, epoch: 2 | loss: 0.5643027
	speed: 0.0090s/iter; left time: 7.3893s
Updating learning rate to 0.00040526134176428475
Validation loss decreased (0.2845 --> 0.2691).  Saving model state dict ...
Epoch: 2 cost time: 0.734297513961792
Epoch: 2, Steps: 131 | Train Loss: 0.5643027 Vali Loss: 0.2691407 Best vali loss: 0.2691407
	iters: 100, epoch: 3 | loss: 0.4847693
	speed: 0.0090s/iter; left time: 6.1581s
Updating learning rate to 0.0003282443425396304
Epoch: 3 cost time: 0.7155346870422363
Epoch: 3, Steps: 131 | Train Loss: 0.4847693 Vali Loss: 0.2937151 Best vali loss: 0.2691407
	iters: 100, epoch: 4 | loss: 0.3721023
	speed: 0.0088s/iter; left time: 4.9144s
Updating learning rate to 0.0002373965977
Epoch: 4 cost time: 0.7442922592163086
Epoch: 4, Steps: 131 | Train Loss: 0.3721023 Vali Loss: 0.3004943 Best vali loss: 0.2691407
	iters: 100, epoch: 5 | loss: 0.3098356
	speed: 0.0090s/iter; left time: 3.8240s
Updating learning rate to 0.00014654885286036963
Epoch: 5 cost time: 0.7367322444915771
Epoch: 5, Steps: 131 | Train Loss: 0.3098356 Vali Loss: 0.3150144 Best vali loss: 0.2691407
	iters: 100, epoch: 6 | loss: 0.2713472
	speed: 0.0090s/iter; left time: 2.6385s
Updating learning rate to 6.953185363571526e-05
Epoch: 6 cost time: 0.7423670291900635
Epoch: 6, Steps: 131 | Train Loss: 0.2713472 Vali Loss: 0.3288503 Best vali loss: 0.2691407
	iters: 100, epoch: 7 | loss: 0.2563523
	speed: 0.0088s/iter; left time: 1.4354s
Updating learning rate to 1.8070739997153992e-05
Epoch: 7 cost time: 0.7243490219116211
Epoch: 7, Steps: 131 | Train Loss: 0.2563523 Vali Loss: 0.3291199 Best vali loss: 0.2691407
	iters: 100, epoch: 8 | loss: 0.2659556
	speed: 0.0089s/iter; left time: 0.2848s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7445759773254395
Epoch: 8, Steps: 131 | Train Loss: 0.2659556 Vali Loss: 0.3346527 Best vali loss: 0.2691407

best validation loss 0.26914069415601755

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0041304746826, 'e_layers': 3, 'learning_rate': 0.0004749238523, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00045684813947069166
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 0.9918794631958008
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2894949 Best vali loss: 0.2894949
Updating learning rate to 0.00040537286440428413
Validation loss decreased (0.2895 --> 0.2754).  Saving model state dict ...
Epoch: 2 cost time: 0.7789618968963623
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2754000 Best vali loss: 0.2754000
Updating learning rate to 0.00032833467110510747
Epoch: 3 cost time: 0.7806656360626221
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2805150 Best vali loss: 0.2754000

best validation loss 0.2754000379288671

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.004017492361, 'e_layers': 3, 'learning_rate': 0.0004750757238, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004569942307059026
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 1.1845483779907227
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2894859 Best vali loss: 0.2894859
Updating learning rate to 0.00040550249483804366
Validation loss decreased (0.2895 --> 0.2716).  Saving model state dict ...
Epoch: 2 cost time: 0.7787275314331055
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2715662 Best vali loss: 0.2715662
Updating learning rate to 0.0003284396662085567
Epoch: 3 cost time: 0.7823100090026855
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2824645 Best vali loss: 0.2715662

best validation loss 0.27156617319818854

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0101486122034, 'e_layers': 1, 'learning_rate': 0.0006792943317, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2197903
	speed: 0.0078s/iter; left time: 64.7911s
	iters: 200, epoch: 1 | loss: 0.8468814
	speed: 0.0024s/iter; left time: 19.8134s
	iters: 300, epoch: 1 | loss: 0.8137890
	speed: 0.0024s/iter; left time: 19.4718s
	iters: 400, epoch: 1 | loss: 0.9533958
	speed: 0.0024s/iter; left time: 19.1416s
	iters: 500, epoch: 1 | loss: 0.4856200
	speed: 0.0024s/iter; left time: 18.8907s
	iters: 600, epoch: 1 | loss: 0.4070953
	speed: 0.0024s/iter; left time: 18.6481s
	iters: 700, epoch: 1 | loss: 0.2423686
	speed: 0.0024s/iter; left time: 18.6998s
	iters: 800, epoch: 1 | loss: 1.1388278
	speed: 0.0024s/iter; left time: 17.9182s
	iters: 900, epoch: 1 | loss: 0.4283280
	speed: 0.0024s/iter; left time: 17.9519s
	iters: 1000, epoch: 1 | loss: 0.3072454
	speed: 0.0024s/iter; left time: 17.5180s
Updating learning rate to 0.0006792943317
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 2.7722396850585938
Epoch: 1, Steps: 1045 | Train Loss: 0.5843342 Vali Loss: 0.2855553 Best vali loss: 0.2855553
	iters: 100, epoch: 2 | loss: 0.2047947
	speed: 0.0078s/iter; left time: 56.5019s
	iters: 200, epoch: 2 | loss: 0.2376443
	speed: 0.0021s/iter; left time: 15.1199s
	iters: 300, epoch: 2 | loss: 0.3326429
	speed: 0.0022s/iter; left time: 15.5924s
	iters: 400, epoch: 2 | loss: 0.4291963
	speed: 0.0023s/iter; left time: 15.6899s
	iters: 500, epoch: 2 | loss: 1.5212299
	speed: 0.0022s/iter; left time: 14.6782s
	iters: 600, epoch: 2 | loss: 0.3817755
	speed: 0.0021s/iter; left time: 14.4337s
	iters: 700, epoch: 2 | loss: 0.3136937
	speed: 0.0021s/iter; left time: 13.9360s
	iters: 800, epoch: 2 | loss: 2.4737337
	speed: 0.0021s/iter; left time: 13.5985s
	iters: 900, epoch: 2 | loss: 1.0340968
	speed: 0.0021s/iter; left time: 13.3598s
	iters: 1000, epoch: 2 | loss: 0.3979965
	speed: 0.0021s/iter; left time: 13.2318s
Updating learning rate to 0.00033964716585
Validation loss decreased (0.2856 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 2.270028591156006
Epoch: 2, Steps: 1045 | Train Loss: 0.7326804 Vali Loss: 0.2829238 Best vali loss: 0.2829238
	iters: 100, epoch: 3 | loss: 0.4951377
	speed: 0.0076s/iter; left time: 46.8677s
	iters: 200, epoch: 3 | loss: 0.2298056
	speed: 0.0023s/iter; left time: 14.0211s
	iters: 300, epoch: 3 | loss: 1.2429957
	speed: 0.0022s/iter; left time: 13.3547s
	iters: 400, epoch: 3 | loss: 1.4260844
	speed: 0.0022s/iter; left time: 13.0227s
	iters: 500, epoch: 3 | loss: 0.6339782
	speed: 0.0022s/iter; left time: 12.7052s
	iters: 600, epoch: 3 | loss: 0.2437407
	speed: 0.0021s/iter; left time: 11.8226s
	iters: 700, epoch: 3 | loss: 0.2393546
	speed: 0.0021s/iter; left time: 11.8841s
	iters: 800, epoch: 3 | loss: 0.2395250
	speed: 0.0021s/iter; left time: 11.4375s
	iters: 900, epoch: 3 | loss: 0.2617964
	speed: 0.0021s/iter; left time: 11.2994s
	iters: 1000, epoch: 3 | loss: 0.3799590
	speed: 0.0021s/iter; left time: 11.2057s
Updating learning rate to 0.000169823582925
Epoch: 3 cost time: 2.304685115814209
Epoch: 3, Steps: 1045 | Train Loss: 0.5392377 Vali Loss: 0.2848608 Best vali loss: 0.2829238

best validation loss 0.28292378834208043

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.004017492361, 'e_layers': 3, 'learning_rate': 0.0004750757238, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002375378619
Epoch: 4 cost time: 1.015958547592163
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2826150 Best vali loss: 0.2715662
Updating learning rate to 0.00014663605759144334
Epoch: 5 cost time: 0.781273603439331
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2825521 Best vali loss: 0.2715662
Updating learning rate to 6.957322896195637e-05
Epoch: 6 cost time: 0.7789742946624756
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2881793 Best vali loss: 0.2715662
Updating learning rate to 1.8081493094097412e-05
Epoch: 7 cost time: 0.7774462699890137
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2910033 Best vali loss: 0.2715662
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7835845947265625
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2926217 Best vali loss: 0.2715662

best validation loss 0.27156617319818854

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0085659333037, 'e_layers': 3, 'learning_rate': 0.0005056674927, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4599018
	speed: 0.0127s/iter; left time: 12.0682s
Updating learning rate to 0.0005056674927
Validation loss decreased (inf --> 0.2972).  Saving model state dict ...
Epoch: 1 cost time: 1.2140743732452393
Epoch: 1, Steps: 131 | Train Loss: 0.4599018 Vali Loss: 0.2971917 Best vali loss: 0.2971917
	iters: 100, epoch: 2 | loss: 0.5033961
	speed: 0.0122s/iter; left time: 10.0026s
Updating learning rate to 0.00025283374635
Validation loss decreased (0.2972 --> 0.2921).  Saving model state dict ...
Epoch: 2 cost time: 0.9986982345581055
Epoch: 2, Steps: 131 | Train Loss: 0.5033961 Vali Loss: 0.2921060 Best vali loss: 0.2921060
	iters: 100, epoch: 3 | loss: 0.4159758
	speed: 0.0123s/iter; left time: 8.4434s
Updating learning rate to 0.000126416873175
Validation loss decreased (0.2921 --> 0.2892).  Saving model state dict ...
Epoch: 3 cost time: 0.9967517852783203
Epoch: 3, Steps: 131 | Train Loss: 0.4159758 Vali Loss: 0.2892415 Best vali loss: 0.2892415
	iters: 100, epoch: 4 | loss: 0.3742003
	speed: 0.0125s/iter; left time: 6.9496s
Updating learning rate to 6.32084365875e-05
Validation loss decreased (0.2892 --> 0.2868).  Saving model state dict ...
Epoch: 4 cost time: 1.004897117614746
Epoch: 4, Steps: 131 | Train Loss: 0.3742003 Vali Loss: 0.2868177 Best vali loss: 0.2868177
	iters: 100, epoch: 5 | loss: 0.4513322
	speed: 0.0123s/iter; left time: 5.2422s
Updating learning rate to 3.160421829375e-05
Epoch: 5 cost time: 1.0077805519104004
Epoch: 5, Steps: 131 | Train Loss: 0.4513322 Vali Loss: 0.2880714 Best vali loss: 0.2868177
	iters: 100, epoch: 6 | loss: 0.4243489
	speed: 0.0120s/iter; left time: 3.5192s
Updating learning rate to 1.5802109146875e-05
Epoch: 6 cost time: 1.0031919479370117
Epoch: 6, Steps: 131 | Train Loss: 0.4243489 Vali Loss: 0.2879864 Best vali loss: 0.2868177
	iters: 100, epoch: 7 | loss: 0.2644426
	speed: 0.0119s/iter; left time: 1.9447s
Updating learning rate to 7.9010545734375e-06
Epoch: 7 cost time: 0.9985554218292236
Epoch: 7, Steps: 131 | Train Loss: 0.2644426 Vali Loss: 0.2900054 Best vali loss: 0.2868177
	iters: 100, epoch: 8 | loss: 0.3296558
	speed: 0.0119s/iter; left time: 0.3808s
Updating learning rate to 3.95052728671875e-06
Epoch: 8 cost time: 0.9998347759246826
Epoch: 8, Steps: 131 | Train Loss: 0.3296558 Vali Loss: 0.2889178 Best vali loss: 0.2868177

best validation loss 0.28681772821795853

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.002116128347, 'e_layers': 3, 'learning_rate': 0.0004767432357, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5542594
	speed: 0.0108s/iter; left time: 10.2888s
Updating learning rate to 0.0004585982767132171
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 0.9641969203948975
Epoch: 1, Steps: 131 | Train Loss: 0.5542594 Vali Loss: 0.2844488 Best vali loss: 0.2844488
	iters: 100, epoch: 2 | loss: 0.5686390
	speed: 0.0091s/iter; left time: 7.4130s
Updating learning rate to 0.00040692580527414325
Validation loss decreased (0.2844 --> 0.2742).  Saving model state dict ...
Epoch: 2 cost time: 0.7239634990692139
Epoch: 2, Steps: 131 | Train Loss: 0.5686390 Vali Loss: 0.2742370 Best vali loss: 0.2742370
	iters: 100, epoch: 3 | loss: 0.5003479
	speed: 0.0090s/iter; left time: 6.1640s
Updating learning rate to 0.00032959248674725754
Epoch: 3 cost time: 0.7242550849914551
Epoch: 3, Steps: 131 | Train Loss: 0.5003479 Vali Loss: 0.2954454 Best vali loss: 0.2742370
	iters: 100, epoch: 4 | loss: 0.3878029
	speed: 0.0086s/iter; left time: 4.7918s
Updating learning rate to 0.00023837161785
Epoch: 4 cost time: 0.7143287658691406
Epoch: 4, Steps: 131 | Train Loss: 0.3878029 Vali Loss: 0.2859815 Best vali loss: 0.2742370
	iters: 100, epoch: 5 | loss: 0.3077662
	speed: 0.0090s/iter; left time: 3.8042s
Updating learning rate to 0.00014715074895274252
Epoch: 5 cost time: 0.744370698928833
Epoch: 5, Steps: 131 | Train Loss: 0.3077662 Vali Loss: 0.3117782 Best vali loss: 0.2742370
	iters: 100, epoch: 6 | loss: 0.2695249
	speed: 0.0088s/iter; left time: 2.5782s
Updating learning rate to 6.981743042585674e-05
Epoch: 6 cost time: 0.7176828384399414
Epoch: 6, Steps: 131 | Train Loss: 0.2695249 Vali Loss: 0.3323774 Best vali loss: 0.2742370
	iters: 100, epoch: 7 | loss: 0.2588957
	speed: 0.0088s/iter; left time: 1.4288s
Updating learning rate to 1.8144958986782906e-05
Epoch: 7 cost time: 0.7322711944580078
Epoch: 7, Steps: 131 | Train Loss: 0.2588957 Vali Loss: 0.3385173 Best vali loss: 0.2742370
	iters: 100, epoch: 8 | loss: 0.2689832
	speed: 0.0087s/iter; left time: 0.2787s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.719541072845459
Epoch: 8, Steps: 131 | Train Loss: 0.2689832 Vali Loss: 0.3390627 Best vali loss: 0.2742370

best validation loss 0.27423702516756165

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266188538, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596891
	speed: 0.0106s/iter; left time: 10.0307s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9329454898834229
Epoch: 1, Steps: 131 | Train Loss: 0.5596891 Vali Loss: 0.2756477 Best vali loss: 0.2756477
	iters: 100, epoch: 2 | loss: 0.3272797
	speed: 0.0089s/iter; left time: 7.2873s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2756 --> 0.2705).  Saving model state dict ...
Epoch: 2 cost time: 0.7032830715179443
Epoch: 2, Steps: 131 | Train Loss: 0.3272797 Vali Loss: 0.2705255 Best vali loss: 0.2705255
	iters: 100, epoch: 3 | loss: 0.4630398
	speed: 0.0090s/iter; left time: 6.2065s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.7031655311584473
Epoch: 3, Steps: 131 | Train Loss: 0.4630398 Vali Loss: 0.2788894 Best vali loss: 0.2705255

best validation loss 0.2705255430087852

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.003062049807, 'e_layers': 3, 'learning_rate': 0.0004750612053, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4461220
	speed: 0.0096s/iter; left time: 39.3851s
	iters: 200, epoch: 1 | loss: 0.4582852
	speed: 0.0042s/iter; left time: 16.8831s
	iters: 300, epoch: 1 | loss: 0.6184392
	speed: 0.0040s/iter; left time: 15.5292s
	iters: 400, epoch: 1 | loss: 0.3754303
	speed: 0.0040s/iter; left time: 15.1419s
	iters: 500, epoch: 1 | loss: 0.2978444
	speed: 0.0040s/iter; left time: 14.8178s
Updating learning rate to 0.00045698026478340625
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 2.4136390686035156
Epoch: 1, Steps: 523 | Train Loss: 0.4392242 Vali Loss: 0.2857741 Best vali loss: 0.2857741
	iters: 100, epoch: 2 | loss: 0.3112244
	speed: 0.0085s/iter; left time: 30.2550s
	iters: 200, epoch: 2 | loss: 0.3920573
	speed: 0.0040s/iter; left time: 13.8396s
	iters: 300, epoch: 2 | loss: 0.3593357
	speed: 0.0040s/iter; left time: 13.4484s
	iters: 400, epoch: 2 | loss: 0.6445777
	speed: 0.0040s/iter; left time: 13.0804s
	iters: 500, epoch: 2 | loss: 0.8557627
	speed: 0.0040s/iter; left time: 12.6197s
Updating learning rate to 0.0004054901025231423
Epoch: 2 cost time: 2.1329474449157715
Epoch: 2, Steps: 523 | Train Loss: 0.5125916 Vali Loss: 0.2878295 Best vali loss: 0.2857741
	iters: 100, epoch: 3 | loss: 0.2673939
	speed: 0.0086s/iter; left time: 26.0347s
	iters: 200, epoch: 3 | loss: 0.6088058
	speed: 0.0040s/iter; left time: 11.7347s
	iters: 300, epoch: 3 | loss: 0.8493496
	speed: 0.0041s/iter; left time: 11.6997s
	iters: 400, epoch: 3 | loss: 0.3948941
	speed: 0.0043s/iter; left time: 11.8239s
	iters: 500, epoch: 3 | loss: 0.2363304
	speed: 0.0043s/iter; left time: 11.3214s
Updating learning rate to 0.00032842962896385033
Epoch: 3 cost time: 2.2139008045196533
Epoch: 3, Steps: 523 | Train Loss: 0.4713548 Vali Loss: 0.2961776 Best vali loss: 0.2857741

best validation loss 0.28577412439350214

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.003260349847, 'e_layers': 4, 'learning_rate': 0.0004749900317, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3294466
	speed: 0.0142s/iter; left time: 13.4423s
Updating learning rate to 0.00045691180006725865
Validation loss decreased (inf --> 0.2898).  Saving model state dict ...
Epoch: 1 cost time: 1.4086921215057373
Epoch: 1, Steps: 131 | Train Loss: 0.3294466 Vali Loss: 0.2898197 Best vali loss: 0.2898197
	iters: 100, epoch: 2 | loss: 0.4929306
	speed: 0.0144s/iter; left time: 11.7704s
Updating learning rate to 0.0004054293520555416
Epoch: 2 cost time: 1.1782069206237793
Epoch: 2, Steps: 131 | Train Loss: 0.4929306 Vali Loss: 0.2899053 Best vali loss: 0.2898197
	iters: 100, epoch: 3 | loss: 0.4540618
	speed: 0.0140s/iter; left time: 9.6509s
Updating learning rate to 0.0003283804236850794
Validation loss decreased (0.2898 --> 0.2847).  Saving model state dict ...
Epoch: 3 cost time: 1.1773784160614014
Epoch: 3, Steps: 131 | Train Loss: 0.4540618 Vali Loss: 0.2846556 Best vali loss: 0.2846556

best validation loss 0.28465555369432816

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010266188538, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4280016
	speed: 0.0108s/iter; left time: 6.0228s
Updating learning rate to 2.9315984725e-05
Epoch: 4 cost time: 0.9401156902313232
Epoch: 4, Steps: 131 | Train Loss: 0.4280016 Vali Loss: 0.3024315 Best vali loss: 0.2705255
	iters: 100, epoch: 5 | loss: 0.2818363
	speed: 0.0087s/iter; left time: 3.6792s
Updating learning rate to 1.46579923625e-05
Epoch: 5 cost time: 0.7040524482727051
Epoch: 5, Steps: 131 | Train Loss: 0.2818363 Vali Loss: 0.2910526 Best vali loss: 0.2705255
	iters: 100, epoch: 6 | loss: 0.4357273
	speed: 0.0086s/iter; left time: 2.5383s
Updating learning rate to 7.32899618125e-06
Epoch: 6 cost time: 0.6981565952301025
Epoch: 6, Steps: 131 | Train Loss: 0.4357273 Vali Loss: 0.2977432 Best vali loss: 0.2705255
	iters: 100, epoch: 7 | loss: 0.4650855
	speed: 0.0087s/iter; left time: 1.4253s
Updating learning rate to 3.664498090625e-06
Epoch: 7 cost time: 0.7054221630096436
Epoch: 7, Steps: 131 | Train Loss: 0.4650855 Vali Loss: 0.2968104 Best vali loss: 0.2705255
	iters: 100, epoch: 8 | loss: 0.3264759
	speed: 0.0087s/iter; left time: 0.2769s
Updating learning rate to 1.8322490453125e-06
Epoch: 8 cost time: 0.701636552810669
Epoch: 8, Steps: 131 | Train Loss: 0.3264759 Vali Loss: 0.2936582 Best vali loss: 0.2705255

best validation loss 0.2705255430087852

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008858724982, 'e_layers': 3, 'learning_rate': 0.0040265596193, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003873307819003854
Validation loss decreased (inf --> 0.2900).  Saving model state dict ...
Epoch: 1 cost time: 0.6144111156463623
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2900137 Best vali loss: 0.2900137
Updating learning rate to 0.0034368836154794764
Epoch: 2 cost time: 0.39390110969543457
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2921314 Best vali loss: 0.2900137
Updating learning rate to 0.0027837286375181967
Epoch: 3 cost time: 0.38601064682006836
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2932133 Best vali loss: 0.2900137
Updating learning rate to 0.00201327980965
Epoch: 4 cost time: 0.39435386657714844
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3115365 Best vali loss: 0.2900137
Updating learning rate to 0.0012428309817818035
Epoch: 5 cost time: 0.42813920974731445
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3116339 Best vali loss: 0.2900137
Updating learning rate to 0.0005896760038205236
Epoch: 6 cost time: 0.3596920967102051
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3109696 Best vali loss: 0.2900137
Updating learning rate to 0.00015325180029614565
Epoch: 7 cost time: 0.3809361457824707
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3104449 Best vali loss: 0.2900137
Updating learning rate to 0.0
Epoch: 8 cost time: 0.373119592666626
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3103280 Best vali loss: 0.2900137

best validation loss 0.29001368200437605

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030273592327, 'e_layers': 3, 'learning_rate': 0.0004745280224, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9976312
	speed: 0.0098s/iter; left time: 39.8552s
	iters: 200, epoch: 1 | loss: 1.6151425
	speed: 0.0045s/iter; left time: 17.7385s
	iters: 300, epoch: 1 | loss: 0.3771704
	speed: 0.0044s/iter; left time: 17.2561s
	iters: 400, epoch: 1 | loss: 1.3902978
	speed: 0.0044s/iter; left time: 16.7240s
	iters: 500, epoch: 1 | loss: 0.3578890
	speed: 0.0044s/iter; left time: 16.3340s
Updating learning rate to 0.0004745280224
Validation loss decreased (inf --> 0.2885).  Saving model state dict ...
Epoch: 1 cost time: 2.570437431335449
Epoch: 1, Steps: 523 | Train Loss: 0.9476262 Vali Loss: 0.2884736 Best vali loss: 0.2884736
	iters: 100, epoch: 2 | loss: 0.5076888
	speed: 0.0092s/iter; left time: 32.6174s
	iters: 200, epoch: 2 | loss: 0.4621760
	speed: 0.0044s/iter; left time: 15.3650s
	iters: 300, epoch: 2 | loss: 0.3371057
	speed: 0.0044s/iter; left time: 14.8900s
	iters: 400, epoch: 2 | loss: 0.6332325
	speed: 0.0044s/iter; left time: 14.4431s
	iters: 500, epoch: 2 | loss: 0.2741612
	speed: 0.0045s/iter; left time: 14.1973s
Updating learning rate to 0.0002372640112
Epoch: 2 cost time: 2.3360555171966553
Epoch: 2, Steps: 523 | Train Loss: 0.4428728 Vali Loss: 0.2923922 Best vali loss: 0.2884736
	iters: 100, epoch: 3 | loss: 0.3382671
	speed: 0.0089s/iter; left time: 27.0255s
	iters: 200, epoch: 3 | loss: 0.6194559
	speed: 0.0045s/iter; left time: 13.2099s
	iters: 300, epoch: 3 | loss: 0.2412062
	speed: 0.0041s/iter; left time: 11.6929s
	iters: 400, epoch: 3 | loss: 0.2823833
	speed: 0.0041s/iter; left time: 11.2083s
	iters: 500, epoch: 3 | loss: 0.8229467
	speed: 0.0041s/iter; left time: 10.9001s
Updating learning rate to 0.0001186320056
Epoch: 3 cost time: 2.2517359256744385
Epoch: 3, Steps: 523 | Train Loss: 0.4608519 Vali Loss: 0.3032996 Best vali loss: 0.2884736
	iters: 100, epoch: 4 | loss: 0.6008899
	speed: 0.0086s/iter; left time: 21.7117s
	iters: 200, epoch: 4 | loss: 0.5343152
	speed: 0.0041s/iter; left time: 9.8899s
	iters: 300, epoch: 4 | loss: 0.2920645
	speed: 0.0044s/iter; left time: 10.1737s
	iters: 400, epoch: 4 | loss: 0.3339090
	speed: 0.0044s/iter; left time: 9.7538s
	iters: 500, epoch: 4 | loss: 0.2480844
	speed: 0.0044s/iter; left time: 9.2422s
Updating learning rate to 5.93160028e-05
Epoch: 4 cost time: 2.2568109035491943
Epoch: 4, Steps: 523 | Train Loss: 0.4018526 Vali Loss: 0.2918778 Best vali loss: 0.2884736
	iters: 100, epoch: 5 | loss: 0.3651121
	speed: 0.0088s/iter; left time: 17.5247s
	iters: 200, epoch: 5 | loss: 0.6915421
	speed: 0.0041s/iter; left time: 7.8412s
	iters: 300, epoch: 5 | loss: 0.3373580
	speed: 0.0042s/iter; left time: 7.5058s
	iters: 400, epoch: 5 | loss: 0.3506008
	speed: 0.0042s/iter; left time: 7.1115s
	iters: 500, epoch: 5 | loss: 0.6257949
	speed: 0.0044s/iter; left time: 7.0105s
Updating learning rate to 2.96580014e-05
Epoch: 5 cost time: 2.2525298595428467
Epoch: 5, Steps: 523 | Train Loss: 0.4740816 Vali Loss: 0.3073047 Best vali loss: 0.2884736
	iters: 100, epoch: 6 | loss: 0.5608411
	speed: 0.0090s/iter; left time: 13.2687s
	iters: 200, epoch: 6 | loss: 0.1800991
	speed: 0.0044s/iter; left time: 6.0252s
	iters: 300, epoch: 6 | loss: 0.3365903
	speed: 0.0044s/iter; left time: 5.5541s
	iters: 400, epoch: 6 | loss: 0.4594235
	speed: 0.0044s/iter; left time: 5.1439s
	iters: 500, epoch: 6 | loss: 0.3017129
	speed: 0.0044s/iter; left time: 4.7373s
Updating learning rate to 1.48290007e-05
Epoch: 6 cost time: 2.335644006729126
Epoch: 6, Steps: 523 | Train Loss: 0.3677334 Vali Loss: 0.3082946 Best vali loss: 0.2884736
	iters: 100, epoch: 7 | loss: 0.3201410
	speed: 0.0087s/iter; left time: 8.2552s
	iters: 200, epoch: 7 | loss: 0.5830761
	speed: 0.0042s/iter; left time: 3.5240s
	iters: 300, epoch: 7 | loss: 0.2947646
	speed: 0.0041s/iter; left time: 3.0877s
	iters: 400, epoch: 7 | loss: 0.3157294
	speed: 0.0041s/iter; left time: 2.6828s
	iters: 500, epoch: 7 | loss: 0.3060883
	speed: 0.0041s/iter; left time: 2.2507s
Updating learning rate to 7.41450035e-06
Epoch: 7 cost time: 2.2003748416900635
Epoch: 7, Steps: 523 | Train Loss: 0.3639599 Vali Loss: 0.3088979 Best vali loss: 0.2884736
	iters: 100, epoch: 8 | loss: 0.2202552
	speed: 0.0088s/iter; left time: 3.7148s
	iters: 200, epoch: 8 | loss: 0.8340180
	speed: 0.0041s/iter; left time: 1.3173s
	iters: 300, epoch: 8 | loss: 0.2524721
	speed: 0.0038s/iter; left time: 0.8616s
	iters: 400, epoch: 8 | loss: 0.4767337
	speed: 0.0038s/iter; left time: 0.4754s
	iters: 500, epoch: 8 | loss: 0.4766630
	speed: 0.0039s/iter; left time: 0.0938s
Updating learning rate to 3.707250175e-06
Epoch: 8 cost time: 2.0901942253112793
Epoch: 8, Steps: 523 | Train Loss: 0.4520284 Vali Loss: 0.3090683 Best vali loss: 0.2884736

best validation loss 0.2884735842039701

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0078236249427, 'e_layers': 3, 'learning_rate': 0.0004750824811, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4460118
	speed: 0.0097s/iter; left time: 39.7637s
	iters: 200, epoch: 1 | loss: 0.4577266
	speed: 0.0044s/iter; left time: 17.4576s
	iters: 300, epoch: 1 | loss: 0.6286089
	speed: 0.0043s/iter; left time: 16.7881s
	iters: 400, epoch: 1 | loss: 0.3791425
	speed: 0.0044s/iter; left time: 16.5627s
	iters: 500, epoch: 1 | loss: 0.3237189
	speed: 0.0043s/iter; left time: 16.0184s
Updating learning rate to 0.0004570007308214851
Validation loss decreased (inf --> 0.2967).  Saving model state dict ...
Epoch: 1 cost time: 2.5401451587677
Epoch: 1, Steps: 523 | Train Loss: 0.4470418 Vali Loss: 0.2967440 Best vali loss: 0.2967440
	iters: 100, epoch: 2 | loss: 0.3336953
	speed: 0.0086s/iter; left time: 30.7787s
	iters: 200, epoch: 2 | loss: 0.3453670
	speed: 0.0040s/iter; left time: 13.8512s
	iters: 300, epoch: 2 | loss: 0.3738613
	speed: 0.0040s/iter; left time: 13.4482s
	iters: 400, epoch: 2 | loss: 0.6453731
	speed: 0.0040s/iter; left time: 13.0494s
	iters: 500, epoch: 2 | loss: 0.8786502
	speed: 0.0040s/iter; left time: 12.6111s
Updating learning rate to 0.0004055082625543699
Validation loss decreased (0.2967 --> 0.2897).  Saving model state dict ...
Epoch: 2 cost time: 2.1316611766815186
Epoch: 2, Steps: 523 | Train Loss: 0.5153894 Vali Loss: 0.2896617 Best vali loss: 0.2896617
	iters: 100, epoch: 3 | loss: 0.2676061
	speed: 0.0086s/iter; left time: 26.0376s
	iters: 200, epoch: 3 | loss: 0.7296347
	speed: 0.0038s/iter; left time: 11.1962s
	iters: 300, epoch: 3 | loss: 0.8081574
	speed: 0.0039s/iter; left time: 10.9650s
	iters: 400, epoch: 3 | loss: 0.3907730
	speed: 0.0036s/iter; left time: 9.9812s
	iters: 500, epoch: 3 | loss: 0.2425999
	speed: 0.0038s/iter; left time: 10.1061s
Updating learning rate to 0.00032844433781193544
Epoch: 3 cost time: 2.04559588432312
Epoch: 3, Steps: 523 | Train Loss: 0.4877542 Vali Loss: 0.2925059 Best vali loss: 0.2896617

best validation loss 0.289661657947641

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0015533732999, 'e_layers': 2, 'learning_rate': 0.0009295763356, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009295763356
Validation loss decreased (inf --> 0.2953).  Saving model state dict ...
Epoch: 1 cost time: 0.5352771282196045
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2953387 Best vali loss: 0.2953387
Updating learning rate to 0.0004647881678
Validation loss decreased (0.2953 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 0.32176780700683594
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2823629 Best vali loss: 0.2823629
Updating learning rate to 0.0002323940839
Epoch: 3 cost time: 0.33073902130126953
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2833252 Best vali loss: 0.2823629

best validation loss 0.28236286747229505

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001564418341, 'e_layers': 4, 'learning_rate': 0.0004749497044, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5401167
	speed: 0.0124s/iter; left time: 11.7600s
Updating learning rate to 0.0004568730076337229
Validation loss decreased (inf --> 0.2902).  Saving model state dict ...
Epoch: 1 cost time: 1.1748037338256836
Epoch: 1, Steps: 131 | Train Loss: 0.5401167 Vali Loss: 0.2902012 Best vali loss: 0.2902012
	iters: 100, epoch: 2 | loss: 0.5507191
	speed: 0.0113s/iter; left time: 9.2541s
Updating learning rate to 0.0004053949305518931
Validation loss decreased (0.2902 --> 0.2856).  Saving model state dict ...
Epoch: 2 cost time: 0.9370708465576172
Epoch: 2, Steps: 131 | Train Loss: 0.5507191 Vali Loss: 0.2855854 Best vali loss: 0.2855854
	iters: 100, epoch: 3 | loss: 0.4574518
	speed: 0.0113s/iter; left time: 7.7539s
Updating learning rate to 0.0003283525437402884
Validation loss decreased (0.2856 --> 0.2724).  Saving model state dict ...
Epoch: 3 cost time: 0.9224281311035156
Epoch: 3, Steps: 131 | Train Loss: 0.4574518 Vali Loss: 0.2724467 Best vali loss: 0.2724467

best validation loss 0.2724467057827548

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001564418341, 'e_layers': 4, 'learning_rate': 0.0004749497044, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3707598
	speed: 0.0125s/iter; left time: 6.9327s
Updating learning rate to 0.0002374748522
Epoch: 4 cost time: 1.1632840633392334
Epoch: 4, Steps: 131 | Train Loss: 0.3707598 Vali Loss: 0.2744784 Best vali loss: 0.2724467
	iters: 100, epoch: 5 | loss: 0.3002447
	speed: 0.0109s/iter; left time: 4.6478s
Updating learning rate to 0.00014659716065971163
Epoch: 5 cost time: 0.9166092872619629
Epoch: 5, Steps: 131 | Train Loss: 0.3002447 Vali Loss: 0.2949892 Best vali loss: 0.2724467
	iters: 100, epoch: 6 | loss: 0.3431217
	speed: 0.0108s/iter; left time: 3.1748s
Updating learning rate to 6.95547738481069e-05
Epoch: 6 cost time: 0.9175045490264893
Epoch: 6, Steps: 131 | Train Loss: 0.3431217 Vali Loss: 0.3149274 Best vali loss: 0.2724467
	iters: 100, epoch: 7 | loss: 0.2532862
	speed: 0.0108s/iter; left time: 1.7647s
Updating learning rate to 1.8076696766277085e-05
Epoch: 7 cost time: 0.9186005592346191
Epoch: 7, Steps: 131 | Train Loss: 0.2532862 Vali Loss: 0.3137739 Best vali loss: 0.2724467
	iters: 100, epoch: 8 | loss: 0.3474598
	speed: 0.0109s/iter; left time: 0.3482s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9238417148590088
Epoch: 8, Steps: 131 | Train Loss: 0.3474598 Vali Loss: 0.3193867 Best vali loss: 0.2724467

best validation loss 0.2724467057827548

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030323479237, 'e_layers': 3, 'learning_rate': 0.0004743619462, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9972010
	speed: 0.0096s/iter; left time: 39.2645s
	iters: 200, epoch: 1 | loss: 1.6112829
	speed: 0.0045s/iter; left time: 17.8905s
	iters: 300, epoch: 1 | loss: 0.3603529
	speed: 0.0044s/iter; left time: 17.2251s
	iters: 400, epoch: 1 | loss: 1.4901682
	speed: 0.0045s/iter; left time: 16.9284s
	iters: 500, epoch: 1 | loss: 0.3783129
	speed: 0.0045s/iter; left time: 16.4311s
Updating learning rate to 0.0004743619462
Validation loss decreased (inf --> 0.2999).  Saving model state dict ...
Epoch: 1 cost time: 2.587235689163208
Epoch: 1, Steps: 523 | Train Loss: 0.9674636 Vali Loss: 0.2998614 Best vali loss: 0.2998614
	iters: 100, epoch: 2 | loss: 0.5184209
	speed: 0.0091s/iter; left time: 32.3226s
	iters: 200, epoch: 2 | loss: 0.4597664
	speed: 0.0040s/iter; left time: 13.9537s
	iters: 300, epoch: 2 | loss: 0.3315029
	speed: 0.0040s/iter; left time: 13.4750s
	iters: 400, epoch: 2 | loss: 0.6704537
	speed: 0.0043s/iter; left time: 13.8926s
	iters: 500, epoch: 2 | loss: 0.3027667
	speed: 0.0044s/iter; left time: 14.0174s
Updating learning rate to 0.0002371809731
Validation loss decreased (0.2999 --> 0.2938).  Saving model state dict ...
Epoch: 2 cost time: 2.2154369354248047
Epoch: 2, Steps: 523 | Train Loss: 0.4565821 Vali Loss: 0.2937517 Best vali loss: 0.2937517
	iters: 100, epoch: 3 | loss: 0.3285777
	speed: 0.0093s/iter; left time: 28.1270s
	iters: 200, epoch: 3 | loss: 0.6359381
	speed: 0.0044s/iter; left time: 12.8142s
	iters: 300, epoch: 3 | loss: 0.2547222
	speed: 0.0044s/iter; left time: 12.4474s
	iters: 400, epoch: 3 | loss: 0.2866649
	speed: 0.0043s/iter; left time: 11.8268s
	iters: 500, epoch: 3 | loss: 0.8352343
	speed: 0.0043s/iter; left time: 11.2724s
Updating learning rate to 0.00011859048655
Epoch: 3 cost time: 2.2941031455993652
Epoch: 3, Steps: 523 | Train Loss: 0.4682275 Vali Loss: 0.2962085 Best vali loss: 0.2937517
	iters: 100, epoch: 4 | loss: 0.6284857
	speed: 0.0086s/iter; left time: 21.5617s
	iters: 200, epoch: 4 | loss: 0.5456716
	speed: 0.0039s/iter; left time: 9.3145s
	iters: 300, epoch: 4 | loss: 0.2948523
	speed: 0.0038s/iter; left time: 8.8899s
	iters: 400, epoch: 4 | loss: 0.3790347
	speed: 0.0039s/iter; left time: 8.5852s
	iters: 500, epoch: 4 | loss: 0.2577920
	speed: 0.0039s/iter; left time: 8.1994s
Updating learning rate to 5.9295243275e-05
Epoch: 4 cost time: 2.0658609867095947
Epoch: 4, Steps: 523 | Train Loss: 0.4211673 Vali Loss: 0.2939604 Best vali loss: 0.2937517
	iters: 100, epoch: 5 | loss: 0.3947363
	speed: 0.0085s/iter; left time: 16.9727s
	iters: 200, epoch: 5 | loss: 0.7133451
	speed: 0.0040s/iter; left time: 7.5643s
	iters: 300, epoch: 5 | loss: 0.3620934
	speed: 0.0043s/iter; left time: 7.7078s
	iters: 400, epoch: 5 | loss: 0.3610503
	speed: 0.0043s/iter; left time: 7.3095s
	iters: 500, epoch: 5 | loss: 0.6161669
	speed: 0.0043s/iter; left time: 6.7913s
Updating learning rate to 2.96476216375e-05
Epoch: 5 cost time: 2.222853660583496
Epoch: 5, Steps: 523 | Train Loss: 0.4894784 Vali Loss: 0.2976024 Best vali loss: 0.2937517
	iters: 100, epoch: 6 | loss: 0.6161741
	speed: 0.0089s/iter; left time: 13.1466s
	iters: 200, epoch: 6 | loss: 0.1871465
	speed: 0.0042s/iter; left time: 5.7885s
	iters: 300, epoch: 6 | loss: 0.3335014
	speed: 0.0043s/iter; left time: 5.4845s
	iters: 400, epoch: 6 | loss: 0.4981098
	speed: 0.0044s/iter; left time: 5.1309s
	iters: 500, epoch: 6 | loss: 0.3210832
	speed: 0.0043s/iter; left time: 4.6479s
Updating learning rate to 1.482381081875e-05
Epoch: 6 cost time: 2.290095567703247
Epoch: 6, Steps: 523 | Train Loss: 0.3912030 Vali Loss: 0.3034499 Best vali loss: 0.2937517
	iters: 100, epoch: 7 | loss: 0.3031881
	speed: 0.0088s/iter; left time: 8.3621s
	iters: 200, epoch: 7 | loss: 0.5747998
	speed: 0.0042s/iter; left time: 3.5265s
	iters: 300, epoch: 7 | loss: 0.2995685
	speed: 0.0041s/iter; left time: 3.0747s
	iters: 400, epoch: 7 | loss: 0.3274527
	speed: 0.0044s/iter; left time: 2.8568s
	iters: 500, epoch: 7 | loss: 0.3122610
	speed: 0.0044s/iter; left time: 2.3929s
Updating learning rate to 7.411905409375e-06
Epoch: 7 cost time: 2.2678537368774414
Epoch: 7, Steps: 523 | Train Loss: 0.3634540 Vali Loss: 0.3029835 Best vali loss: 0.2937517
	iters: 100, epoch: 8 | loss: 0.2294519
	speed: 0.0090s/iter; left time: 3.8208s
	iters: 200, epoch: 8 | loss: 0.8224687
	speed: 0.0043s/iter; left time: 1.3965s
	iters: 300, epoch: 8 | loss: 0.2191630
	speed: 0.0043s/iter; left time: 0.9625s
	iters: 400, epoch: 8 | loss: 0.4721280
	speed: 0.0043s/iter; left time: 0.5319s
	iters: 500, epoch: 8 | loss: 0.4712802
	speed: 0.0043s/iter; left time: 0.1034s
Updating learning rate to 3.7059527046875e-06
Epoch: 8 cost time: 2.2961602210998535
Epoch: 8, Steps: 523 | Train Loss: 0.4428983 Vali Loss: 0.3065604 Best vali loss: 0.2937517

best validation loss 0.2937516774684357

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0022474630632, 'e_layers': 1, 'learning_rate': 0.0017057254969, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5170784
	speed: 0.0076s/iter; left time: 63.0366s
	iters: 200, epoch: 1 | loss: 1.1781714
	speed: 0.0023s/iter; left time: 18.3827s
	iters: 300, epoch: 1 | loss: 0.5795605
	speed: 0.0022s/iter; left time: 17.6973s
	iters: 400, epoch: 1 | loss: 1.6305190
	speed: 0.0023s/iter; left time: 18.3027s
	iters: 500, epoch: 1 | loss: 1.0277512
	speed: 0.0024s/iter; left time: 18.5764s
	iters: 600, epoch: 1 | loss: 0.7980742
	speed: 0.0023s/iter; left time: 18.0774s
	iters: 700, epoch: 1 | loss: 0.4021231
	speed: 0.0022s/iter; left time: 16.9571s
	iters: 800, epoch: 1 | loss: 0.2921385
	speed: 0.0022s/iter; left time: 16.7241s
	iters: 900, epoch: 1 | loss: 0.3555658
	speed: 0.0022s/iter; left time: 16.6068s
	iters: 1000, epoch: 1 | loss: 0.2601997
	speed: 0.0022s/iter; left time: 16.1400s
Updating learning rate to 0.0016408051857842772
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 2.6116013526916504
Epoch: 1, Steps: 1045 | Train Loss: 0.7041182 Vali Loss: 0.2824776 Best vali loss: 0.2824776
	iters: 100, epoch: 2 | loss: 0.2117624
	speed: 0.0080s/iter; left time: 57.7839s
	iters: 200, epoch: 2 | loss: 0.2611692
	speed: 0.0023s/iter; left time: 16.0175s
	iters: 300, epoch: 2 | loss: 1.1322879
	speed: 0.0023s/iter; left time: 15.8548s
	iters: 400, epoch: 2 | loss: 1.9553441
	speed: 0.0022s/iter; left time: 15.4972s
	iters: 500, epoch: 2 | loss: 0.2156689
	speed: 0.0023s/iter; left time: 15.4116s
	iters: 600, epoch: 2 | loss: 0.3095120
	speed: 0.0023s/iter; left time: 15.1479s
	iters: 700, epoch: 2 | loss: 0.7367021
	speed: 0.0022s/iter; left time: 14.8251s
	iters: 800, epoch: 2 | loss: 0.5564378
	speed: 0.0022s/iter; left time: 14.4987s
	iters: 900, epoch: 2 | loss: 0.3315045
	speed: 0.0022s/iter; left time: 14.3269s
	iters: 1000, epoch: 2 | loss: 0.3474281
	speed: 0.0023s/iter; left time: 14.2264s
Updating learning rate to 0.0014559277813003917
Epoch: 2 cost time: 2.3818676471710205
Epoch: 2, Steps: 1045 | Train Loss: 0.6057817 Vali Loss: 0.2872681 Best vali loss: 0.2824776
	iters: 100, epoch: 3 | loss: 0.8594580
	speed: 0.0077s/iter; left time: 47.6530s
	iters: 200, epoch: 3 | loss: 0.3118252
	speed: 0.0021s/iter; left time: 13.0315s
	iters: 300, epoch: 3 | loss: 0.7089167
	speed: 0.0021s/iter; left time: 12.7975s
	iters: 400, epoch: 3 | loss: 0.2919856
	speed: 0.0022s/iter; left time: 12.7603s
	iters: 500, epoch: 3 | loss: 0.3360882
	speed: 0.0022s/iter; left time: 12.5089s
	iters: 600, epoch: 3 | loss: 0.2159416
	speed: 0.0022s/iter; left time: 12.3629s
	iters: 700, epoch: 3 | loss: 0.2888118
	speed: 0.0022s/iter; left time: 12.0519s
	iters: 800, epoch: 3 | loss: 0.2525132
	speed: 0.0022s/iter; left time: 11.8904s
	iters: 900, epoch: 3 | loss: 0.6538063
	speed: 0.0021s/iter; left time: 11.4932s
	iters: 1000, epoch: 3 | loss: 0.6222136
	speed: 0.0021s/iter; left time: 11.2576s
Updating learning rate to 0.0011792391923631702
Epoch: 3 cost time: 2.297041893005371
Epoch: 3, Steps: 1045 | Train Loss: 0.4541560 Vali Loss: 0.2970849 Best vali loss: 0.2824776
	iters: 100, epoch: 4 | loss: 0.2662786
	speed: 0.0076s/iter; left time: 38.7412s
	iters: 200, epoch: 4 | loss: 0.8807315
	speed: 0.0020s/iter; left time: 10.1297s
	iters: 300, epoch: 4 | loss: 0.2522234
	speed: 0.0020s/iter; left time: 9.8437s
	iters: 400, epoch: 4 | loss: 0.4375956
	speed: 0.0020s/iter; left time: 9.5309s
	iters: 500, epoch: 4 | loss: 0.4381203
	speed: 0.0020s/iter; left time: 9.4466s
	iters: 600, epoch: 4 | loss: 0.3546777
	speed: 0.0020s/iter; left time: 9.2643s
	iters: 700, epoch: 4 | loss: 0.6822544
	speed: 0.0020s/iter; left time: 9.0121s
	iters: 800, epoch: 4 | loss: 0.4020917
	speed: 0.0020s/iter; left time: 8.7853s
	iters: 900, epoch: 4 | loss: 0.4117924
	speed: 0.0020s/iter; left time: 8.6239s
	iters: 1000, epoch: 4 | loss: 0.4817761
	speed: 0.0020s/iter; left time: 8.4220s
Updating learning rate to 0.00085286274845
Epoch: 4 cost time: 2.137646198272705
Epoch: 4, Steps: 1045 | Train Loss: 0.4607542 Vali Loss: 0.3068895 Best vali loss: 0.2824776
	iters: 100, epoch: 5 | loss: 0.1953897
	speed: 0.0077s/iter; left time: 31.3586s
	iters: 200, epoch: 5 | loss: 0.2635127
	speed: 0.0025s/iter; left time: 9.8471s
	iters: 300, epoch: 5 | loss: 0.4676401
	speed: 0.0025s/iter; left time: 9.5908s
	iters: 400, epoch: 5 | loss: 0.2981323
	speed: 0.0025s/iter; left time: 9.2638s
	iters: 500, epoch: 5 | loss: 0.4212982
	speed: 0.0024s/iter; left time: 9.0062s
	iters: 600, epoch: 5 | loss: 0.3246377
	speed: 0.0024s/iter; left time: 8.7638s
	iters: 700, epoch: 5 | loss: 0.3496164
	speed: 0.0023s/iter; left time: 8.1705s
	iters: 800, epoch: 5 | loss: 0.2531379
	speed: 0.0023s/iter; left time: 7.7371s
	iters: 900, epoch: 5 | loss: 1.2943962
	speed: 0.0023s/iter; left time: 7.5452s
	iters: 1000, epoch: 5 | loss: 0.2048404
	speed: 0.0024s/iter; left time: 7.7670s
Updating learning rate to 0.0005264863045368299
Epoch: 5 cost time: 2.5277349948883057
Epoch: 5, Steps: 1045 | Train Loss: 0.4072602 Vali Loss: 0.3058911 Best vali loss: 0.2824776
	iters: 100, epoch: 6 | loss: 0.2393936
	speed: 0.0079s/iter; left time: 24.0524s
	iters: 200, epoch: 6 | loss: 0.1494179
	speed: 0.0024s/iter; left time: 7.1544s
	iters: 300, epoch: 6 | loss: 0.5262574
	speed: 0.0024s/iter; left time: 6.9199s
	iters: 400, epoch: 6 | loss: 0.1551566
	speed: 0.0023s/iter; left time: 6.4032s
	iters: 500, epoch: 6 | loss: 0.1648805
	speed: 0.0024s/iter; left time: 6.2591s
	iters: 600, epoch: 6 | loss: 0.2669267
	speed: 0.0024s/iter; left time: 6.0220s
	iters: 700, epoch: 6 | loss: 0.8351929
	speed: 0.0024s/iter; left time: 5.7314s
	iters: 800, epoch: 6 | loss: 0.4525023
	speed: 0.0024s/iter; left time: 5.5260s
	iters: 900, epoch: 6 | loss: 0.2568570
	speed: 0.0024s/iter; left time: 5.3001s
	iters: 1000, epoch: 6 | loss: 0.2903749
	speed: 0.0023s/iter; left time: 5.0131s
Updating learning rate to 0.0002497977155996084
Epoch: 6 cost time: 2.5238678455352783
Epoch: 6, Steps: 1045 | Train Loss: 0.3336960 Vali Loss: 0.3081274 Best vali loss: 0.2824776
	iters: 100, epoch: 7 | loss: 0.2218035
	speed: 0.0079s/iter; left time: 15.8096s
	iters: 200, epoch: 7 | loss: 0.2346241
	speed: 0.0025s/iter; left time: 4.6439s
	iters: 300, epoch: 7 | loss: 0.3095464
	speed: 0.0024s/iter; left time: 4.3331s
	iters: 400, epoch: 7 | loss: 0.5781428
	speed: 0.0025s/iter; left time: 4.2233s
	iters: 500, epoch: 7 | loss: 0.2184577
	speed: 0.0025s/iter; left time: 3.9038s
	iters: 600, epoch: 7 | loss: 0.1754928
	speed: 0.0024s/iter; left time: 3.5313s
	iters: 700, epoch: 7 | loss: 0.1635863
	speed: 0.0025s/iter; left time: 3.4351s
	iters: 800, epoch: 7 | loss: 0.4899215
	speed: 0.0025s/iter; left time: 3.1637s
	iters: 900, epoch: 7 | loss: 0.3519644
	speed: 0.0024s/iter; left time: 2.8879s
	iters: 1000, epoch: 7 | loss: 0.8137002
	speed: 0.0024s/iter; left time: 2.5919s
Updating learning rate to 6.492031111572286e-05
Epoch: 7 cost time: 2.5613651275634766
Epoch: 7, Steps: 1045 | Train Loss: 0.3557240 Vali Loss: 0.3117067 Best vali loss: 0.2824776
	iters: 100, epoch: 8 | loss: 0.1665199
	speed: 0.0079s/iter; left time: 7.5012s
	iters: 200, epoch: 8 | loss: 0.2678578
	speed: 0.0024s/iter; left time: 2.0249s
	iters: 300, epoch: 8 | loss: 0.1376332
	speed: 0.0025s/iter; left time: 1.8556s
	iters: 400, epoch: 8 | loss: 0.7674730
	speed: 0.0024s/iter; left time: 1.5361s
	iters: 500, epoch: 8 | loss: 0.8488134
	speed: 0.0023s/iter; left time: 1.2390s
	iters: 600, epoch: 8 | loss: 0.5579525
	speed: 0.0022s/iter; left time: 0.9799s
	iters: 700, epoch: 8 | loss: 0.2612041
	speed: 0.0022s/iter; left time: 0.7603s
	iters: 800, epoch: 8 | loss: 0.2035831
	speed: 0.0022s/iter; left time: 0.5451s
	iters: 900, epoch: 8 | loss: 0.5187768
	speed: 0.0022s/iter; left time: 0.3199s
	iters: 1000, epoch: 8 | loss: 0.1460159
	speed: 0.0022s/iter; left time: 0.1006s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.422484874725342
Epoch: 8, Steps: 1045 | Train Loss: 0.3875830 Vali Loss: 0.3129368 Best vali loss: 0.2824776

best validation loss 0.2824775678112233

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271346462, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597024
	speed: 0.0105s/iter; left time: 9.9596s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9345448017120361
Epoch: 1, Steps: 131 | Train Loss: 0.5597024 Vali Loss: 0.2756336 Best vali loss: 0.2756336
	iters: 100, epoch: 2 | loss: 0.3236477
	speed: 0.0089s/iter; left time: 7.2877s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.2756 --> 0.2690).  Saving model state dict ...
Epoch: 2 cost time: 0.7026605606079102
Epoch: 2, Steps: 131 | Train Loss: 0.3236477 Vali Loss: 0.2689710 Best vali loss: 0.2689710
	iters: 100, epoch: 3 | loss: 0.4624413
	speed: 0.0090s/iter; left time: 6.1831s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 0.7014777660369873
Epoch: 3, Steps: 131 | Train Loss: 0.4624413 Vali Loss: 0.2788871 Best vali loss: 0.2689710

best validation loss 0.26897103930991484

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271587311, 'e_layers': 2, 'learning_rate': 0.0002340880514, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596923
	speed: 0.0104s/iter; left time: 9.8501s
Updating learning rate to 0.0002340880514
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9222612380981445
Epoch: 1, Steps: 131 | Train Loss: 0.5596923 Vali Loss: 0.2756718 Best vali loss: 0.2756718
	iters: 100, epoch: 2 | loss: 0.3244926
	speed: 0.0089s/iter; left time: 7.2532s
Updating learning rate to 0.0001170440257
Validation loss decreased (0.2757 --> 0.2705).  Saving model state dict ...
Epoch: 2 cost time: 0.6947968006134033
Epoch: 2, Steps: 131 | Train Loss: 0.3244926 Vali Loss: 0.2704908 Best vali loss: 0.2704908
	iters: 100, epoch: 3 | loss: 0.4656294
	speed: 0.0089s/iter; left time: 6.1114s
Updating learning rate to 5.852201285e-05
Epoch: 3 cost time: 0.698866605758667
Epoch: 3, Steps: 131 | Train Loss: 0.4656294 Vali Loss: 0.2788862 Best vali loss: 0.2704908

best validation loss 0.2704907635988113

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0041623264127, 'e_layers': 4, 'learning_rate': 0.0005063412437, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7834967
	speed: 0.0124s/iter; left time: 11.7914s
Updating learning rate to 0.0005063412437
Validation loss decreased (inf --> 0.2971).  Saving model state dict ...
Epoch: 1 cost time: 1.2053630352020264
Epoch: 1, Steps: 131 | Train Loss: 0.7834967 Vali Loss: 0.2970648 Best vali loss: 0.2970648
	iters: 100, epoch: 2 | loss: 0.4945908
	speed: 0.0118s/iter; left time: 9.6334s
Updating learning rate to 0.00025317062185
Validation loss decreased (0.2971 --> 0.2916).  Saving model state dict ...
Epoch: 2 cost time: 0.9599041938781738
Epoch: 2, Steps: 131 | Train Loss: 0.4945908 Vali Loss: 0.2916260 Best vali loss: 0.2916260
	iters: 100, epoch: 3 | loss: 0.4082411
	speed: 0.0119s/iter; left time: 8.1783s
Updating learning rate to 0.000126585310925
Validation loss decreased (0.2916 --> 0.2867).  Saving model state dict ...
Epoch: 3 cost time: 0.9505350589752197
Epoch: 3, Steps: 131 | Train Loss: 0.4082411 Vali Loss: 0.2866931 Best vali loss: 0.2866931

best validation loss 0.2866930754522091

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271346462, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4190516
	speed: 0.0115s/iter; left time: 6.3707s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 0.9328703880310059
Epoch: 4, Steps: 131 | Train Loss: 0.4190516 Vali Loss: 0.3087988 Best vali loss: 0.2689710
	iters: 100, epoch: 5 | loss: 0.2815730
	speed: 0.0087s/iter; left time: 3.6897s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 0.6930592060089111
Epoch: 5, Steps: 131 | Train Loss: 0.2815730 Vali Loss: 0.2980210 Best vali loss: 0.2689710
	iters: 100, epoch: 6 | loss: 0.4352213
	speed: 0.0086s/iter; left time: 2.5400s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 0.6983864307403564
Epoch: 6, Steps: 131 | Train Loss: 0.4352213 Vali Loss: 0.3045066 Best vali loss: 0.2689710
	iters: 100, epoch: 7 | loss: 0.4708208
	speed: 0.0086s/iter; left time: 1.4013s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 0.6997084617614746
Epoch: 7, Steps: 131 | Train Loss: 0.4708208 Vali Loss: 0.3010585 Best vali loss: 0.2689710
	iters: 100, epoch: 8 | loss: 0.3288323
	speed: 0.0087s/iter; left time: 0.2794s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 0.7066624164581299
Epoch: 8, Steps: 131 | Train Loss: 0.3288323 Vali Loss: 0.2981170 Best vali loss: 0.2689710

best validation loss 0.26897103930991484

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0036579927906, 'e_layers': 4, 'learning_rate': 0.0012942510946, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0012449915954156347
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 0.665846586227417
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2883695 Best vali loss: 0.2883695
Updating learning rate to 0.001104712410074886
Validation loss decreased (0.2884 --> 0.2864).  Saving model state dict ...
Epoch: 2 cost time: 0.41530418395996094
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2864405 Best vali loss: 0.2864405
Updating learning rate to 0.0008947697729119014
Epoch: 3 cost time: 0.4456639289855957
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2904355 Best vali loss: 0.2864405
Updating learning rate to 0.0006471255473
Validation loss decreased (0.2864 --> 0.2863).  Saving model state dict ...
Epoch: 4 cost time: 0.44258689880371094
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2862803 Best vali loss: 0.2862803
Updating learning rate to 0.0003994813216880988
Epoch: 5 cost time: 0.44432854652404785
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2873863 Best vali loss: 0.2862803
Updating learning rate to 0.00018953868452511414
Epoch: 6 cost time: 0.44913792610168457
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2913214 Best vali loss: 0.2862803
Updating learning rate to 4.925949918436543e-05
Epoch: 7 cost time: 0.4138474464416504
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2875334 Best vali loss: 0.2862803
Updating learning rate to 0.0
Epoch: 8 cost time: 0.44901418685913086
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2897658 Best vali loss: 0.2862803

best validation loss 0.28628029061676

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0072266261779, 'e_layers': 3, 'learning_rate': 0.0004780969089, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6901135
	speed: 0.0110s/iter; left time: 10.4314s
Updating learning rate to 0.0004599004287948116
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 0.9909276962280273
Epoch: 1, Steps: 131 | Train Loss: 0.6901135 Vali Loss: 0.2882546 Best vali loss: 0.2882546
	iters: 100, epoch: 2 | loss: 0.3420030
	speed: 0.0092s/iter; left time: 7.4959s
Updating learning rate to 0.0004080812376237585
Validation loss decreased (0.2883 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.7264580726623535
Epoch: 2, Steps: 131 | Train Loss: 0.3420030 Vali Loss: 0.2826748 Best vali loss: 0.2826748
	iters: 100, epoch: 3 | loss: 0.4224820
	speed: 0.0096s/iter; left time: 6.5993s
Updating learning rate to 0.00033052833750049583
Epoch: 3 cost time: 0.7644782066345215
Epoch: 3, Steps: 131 | Train Loss: 0.4224820 Vali Loss: 0.2880132 Best vali loss: 0.2826748
	iters: 100, epoch: 4 | loss: 0.3411005
	speed: 0.0090s/iter; left time: 4.9909s
Updating learning rate to 0.00023904845445
Validation loss decreased (0.2827 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 0.7225596904754639
Epoch: 4, Steps: 131 | Train Loss: 0.3411005 Vali Loss: 0.2818213 Best vali loss: 0.2818213
	iters: 100, epoch: 5 | loss: 0.2803124
	speed: 0.0092s/iter; left time: 3.9268s
Updating learning rate to 0.00014756857139950418
Epoch: 5 cost time: 0.7262365818023682
Epoch: 5, Steps: 131 | Train Loss: 0.2803124 Vali Loss: 0.2828618 Best vali loss: 0.2818213
	iters: 100, epoch: 6 | loss: 0.2561855
	speed: 0.0089s/iter; left time: 2.6126s
Updating learning rate to 7.001567127624149e-05
Epoch: 6 cost time: 0.7200889587402344
Epoch: 6, Steps: 131 | Train Loss: 0.2561855 Vali Loss: 0.2872741 Best vali loss: 0.2818213
	iters: 100, epoch: 7 | loss: 0.2625523
	speed: 0.0089s/iter; left time: 1.4429s
Updating learning rate to 1.8196480105188376e-05
Epoch: 7 cost time: 0.7172882556915283
Epoch: 7, Steps: 131 | Train Loss: 0.2625523 Vali Loss: 0.2999166 Best vali loss: 0.2818213
	iters: 100, epoch: 8 | loss: 0.3019155
	speed: 0.0089s/iter; left time: 0.2834s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7171423435211182
Epoch: 8, Steps: 131 | Train Loss: 0.3019155 Vali Loss: 0.2979607 Best vali loss: 0.2818213

best validation loss 0.281821332287283

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.007897478745, 'e_layers': 3, 'learning_rate': 0.0003945037327, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5743673
	speed: 0.0097s/iter; left time: 39.5329s
	iters: 200, epoch: 1 | loss: 0.5225665
	speed: 0.0041s/iter; left time: 16.4627s
	iters: 300, epoch: 1 | loss: 0.3358752
	speed: 0.0042s/iter; left time: 16.1346s
	iters: 400, epoch: 1 | loss: 0.1785542
	speed: 0.0043s/iter; left time: 16.0993s
	iters: 500, epoch: 1 | loss: 0.7067503
	speed: 0.0041s/iter; left time: 15.0821s
Updating learning rate to 0.00037948882842041683
Validation loss decreased (inf --> 0.2984).  Saving model state dict ...
Epoch: 1 cost time: 2.436000108718872
Epoch: 1, Steps: 523 | Train Loss: 0.4636227 Vali Loss: 0.2984354 Best vali loss: 0.2984354
	iters: 100, epoch: 2 | loss: 0.6306343
	speed: 0.0097s/iter; left time: 34.5390s
	iters: 200, epoch: 2 | loss: 0.3993532
	speed: 0.0046s/iter; left time: 15.9322s
	iters: 300, epoch: 2 | loss: 0.8385239
	speed: 0.0046s/iter; left time: 15.4318s
	iters: 400, epoch: 2 | loss: 0.2649753
	speed: 0.0046s/iter; left time: 14.9658s
	iters: 500, epoch: 2 | loss: 0.6818249
	speed: 0.0046s/iter; left time: 14.4689s
Updating learning rate to 0.00033672999864778753
Validation loss decreased (0.2984 --> 0.2905).  Saving model state dict ...
Epoch: 2 cost time: 2.4366466999053955
Epoch: 2, Steps: 523 | Train Loss: 0.5630623 Vali Loss: 0.2904831 Best vali loss: 0.2904831
	iters: 100, epoch: 3 | loss: 0.3232606
	speed: 0.0096s/iter; left time: 29.3257s
	iters: 200, epoch: 3 | loss: 0.6989597
	speed: 0.0042s/iter; left time: 12.2529s
	iters: 300, epoch: 3 | loss: 0.2628970
	speed: 0.0041s/iter; left time: 11.7467s
	iters: 400, epoch: 3 | loss: 0.7587101
	speed: 0.0041s/iter; left time: 11.3479s
	iters: 500, epoch: 3 | loss: 0.3200089
	speed: 0.0043s/iter; left time: 11.2446s
Updating learning rate to 0.00027273688760523794
Epoch: 3 cost time: 2.2255821228027344
Epoch: 3, Steps: 523 | Train Loss: 0.4727673 Vali Loss: 0.2986684 Best vali loss: 0.2904831

best validation loss 0.2904831280979626

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0044087384255, 'e_layers': 2, 'learning_rate': 0.0001672711215, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3822312
	speed: 0.0089s/iter; left time: 17.6990s
	iters: 200, epoch: 1 | loss: 0.8555542
	speed: 0.0036s/iter; left time: 6.7779s
Updating learning rate to 0.0001672711215
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 1.1716804504394531
Epoch: 1, Steps: 262 | Train Loss: 0.6188927 Vali Loss: 0.2832262 Best vali loss: 0.2832262
	iters: 100, epoch: 2 | loss: 0.6114610
	speed: 0.0078s/iter; left time: 13.5440s
	iters: 200, epoch: 2 | loss: 0.2641937
	speed: 0.0035s/iter; left time: 5.7446s
Updating learning rate to 8.363556075e-05
Validation loss decreased (0.2832 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.9489047527313232
Epoch: 2, Steps: 262 | Train Loss: 0.4378273 Vali Loss: 0.2826149 Best vali loss: 0.2826149
	iters: 100, epoch: 3 | loss: 0.3962511
	speed: 0.0077s/iter; left time: 11.3492s
	iters: 200, epoch: 3 | loss: 0.6788591
	speed: 0.0034s/iter; left time: 4.6647s
Updating learning rate to 4.1817780375e-05
Validation loss decreased (0.2826 --> 0.2784).  Saving model state dict ...
Epoch: 3 cost time: 0.9406096935272217
Epoch: 3, Steps: 262 | Train Loss: 0.5375551 Vali Loss: 0.2784033 Best vali loss: 0.2784033

best validation loss 0.2784032873967271

[INFO][smbo.py:320] Finished 1400 trials.
{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0071529983289, 'e_layers': 2, 'learning_rate': 0.0003003009286, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003003009286
Validation loss decreased (inf --> 0.2827).  Saving model state dict ...
Epoch: 1 cost time: 0.5426113605499268
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2827215 Best vali loss: 0.2827215
Updating learning rate to 0.0001501504643
Validation loss decreased (0.2827 --> 0.2791).  Saving model state dict ...
Epoch: 2 cost time: 0.3307616710662842
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2791083 Best vali loss: 0.2791083
Updating learning rate to 7.507523215e-05
Epoch: 3 cost time: 0.3347017765045166
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2801546 Best vali loss: 0.2791083

best validation loss 0.2791082699665043

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0044087384255, 'e_layers': 2, 'learning_rate': 0.0001672711215, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3663807
	speed: 0.0088s/iter; left time: 10.6773s
	iters: 200, epoch: 4 | loss: 0.7379730
	speed: 0.0035s/iter; left time: 3.8705s
Updating learning rate to 2.09088901875e-05
Epoch: 4 cost time: 1.1515393257141113
Epoch: 4, Steps: 262 | Train Loss: 0.5521768 Vali Loss: 0.2811315 Best vali loss: 0.2784033
	iters: 100, epoch: 5 | loss: 0.6071540
	speed: 0.0076s/iter; left time: 7.2587s
	iters: 200, epoch: 5 | loss: 0.2741366
	speed: 0.0033s/iter; left time: 2.8158s
Updating learning rate to 1.045444509375e-05
Epoch: 5 cost time: 0.9125251770019531
Epoch: 5, Steps: 262 | Train Loss: 0.4406453 Vali Loss: 0.2811589 Best vali loss: 0.2784033
	iters: 100, epoch: 6 | loss: 0.3856141
	speed: 0.0079s/iter; left time: 5.4019s
	iters: 200, epoch: 6 | loss: 0.6769429
	speed: 0.0037s/iter; left time: 2.1713s
Updating learning rate to 5.227222546875e-06
Epoch: 6 cost time: 0.9880712032318115
Epoch: 6, Steps: 262 | Train Loss: 0.5312785 Vali Loss: 0.2808257 Best vali loss: 0.2784033
	iters: 100, epoch: 7 | loss: 0.4460258
	speed: 0.0079s/iter; left time: 3.3648s
	iters: 200, epoch: 7 | loss: 0.8579276
	speed: 0.0035s/iter; left time: 1.1379s
Updating learning rate to 2.6136112734375e-06
Epoch: 7 cost time: 0.9372670650482178
Epoch: 7, Steps: 262 | Train Loss: 0.6519767 Vali Loss: 0.2807703 Best vali loss: 0.2784033
	iters: 100, epoch: 8 | loss: 0.4056438
	speed: 0.0080s/iter; left time: 1.3068s
	iters: 200, epoch: 8 | loss: 0.4061345
	speed: 0.0035s/iter; left time: 0.2213s
Updating learning rate to 1.30680563671875e-06
Epoch: 8 cost time: 0.947319507598877
Epoch: 8, Steps: 262 | Train Loss: 0.4058892 Vali Loss: 0.2808302 Best vali loss: 0.2784033

best validation loss 0.2784032873967271

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.003031889687, 'e_layers': 4, 'learning_rate': 0.0004820645556, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3273282
	speed: 0.0141s/iter; left time: 13.3584s
Updating learning rate to 0.0004820645556
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 1.4083561897277832
Epoch: 1, Steps: 131 | Train Loss: 0.3273282 Vali Loss: 0.2895021 Best vali loss: 0.2895021
	iters: 100, epoch: 2 | loss: 0.5172831
	speed: 0.0142s/iter; left time: 11.5845s
Updating learning rate to 0.0002410322778
Epoch: 2 cost time: 1.167590618133545
Epoch: 2, Steps: 131 | Train Loss: 0.5172831 Vali Loss: 0.2937025 Best vali loss: 0.2895021
	iters: 100, epoch: 3 | loss: 0.4290262
	speed: 0.0139s/iter; left time: 9.5490s
Updating learning rate to 0.0001205161389
Validation loss decreased (0.2895 --> 0.2811).  Saving model state dict ...
Epoch: 3 cost time: 1.1758553981781006
Epoch: 3, Steps: 131 | Train Loss: 0.4290262 Vali Loss: 0.2811029 Best vali loss: 0.2811029
	iters: 100, epoch: 4 | loss: 0.4823057
	speed: 0.0144s/iter; left time: 8.0006s
Updating learning rate to 6.025806945e-05
Validation loss decreased (0.2811 --> 0.2734).  Saving model state dict ...
Epoch: 4 cost time: 1.1782236099243164
Epoch: 4, Steps: 131 | Train Loss: 0.4823057 Vali Loss: 0.2734283 Best vali loss: 0.2734283
	iters: 100, epoch: 5 | loss: 0.3054824
	speed: 0.0145s/iter; left time: 6.1517s
Updating learning rate to 3.0129034725e-05
Epoch: 5 cost time: 1.1735470294952393
Epoch: 5, Steps: 131 | Train Loss: 0.3054824 Vali Loss: 0.2773103 Best vali loss: 0.2734283
	iters: 100, epoch: 6 | loss: 0.3136107
	speed: 0.0140s/iter; left time: 4.1178s
Updating learning rate to 1.50645173625e-05
Epoch: 6 cost time: 1.1777091026306152
Epoch: 6, Steps: 131 | Train Loss: 0.3136107 Vali Loss: 0.2781372 Best vali loss: 0.2734283
	iters: 100, epoch: 7 | loss: 0.2716679
	speed: 0.0140s/iter; left time: 2.2834s
Updating learning rate to 7.53225868125e-06
Epoch: 7 cost time: 1.173414707183838
Epoch: 7, Steps: 131 | Train Loss: 0.2716679 Vali Loss: 0.2797492 Best vali loss: 0.2734283
	iters: 100, epoch: 8 | loss: 0.2987794
	speed: 0.0140s/iter; left time: 0.4478s
Updating learning rate to 3.766129340625e-06
Epoch: 8 cost time: 1.1884057521820068
Epoch: 8, Steps: 131 | Train Loss: 0.2987794 Vali Loss: 0.2819394 Best vali loss: 0.2734283

best validation loss 0.2734283289337699

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030103339213, 'e_layers': 4, 'learning_rate': 0.0004757130119, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3302616
	speed: 0.0141s/iter; left time: 13.3912s
Updating learning rate to 0.0004757130119
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 1.411008596420288
Epoch: 1, Steps: 131 | Train Loss: 0.3302616 Vali Loss: 0.2895072 Best vali loss: 0.2895072
	iters: 100, epoch: 2 | loss: 0.4817753
	speed: 0.0144s/iter; left time: 11.7545s
Updating learning rate to 0.00023785650595
Epoch: 2 cost time: 1.1829140186309814
Epoch: 2, Steps: 131 | Train Loss: 0.4817753 Vali Loss: 0.2901796 Best vali loss: 0.2895072
	iters: 100, epoch: 3 | loss: 0.4251318
	speed: 0.0141s/iter; left time: 9.6608s
Updating learning rate to 0.000118928252975
Validation loss decreased (0.2895 --> 0.2751).  Saving model state dict ...
Epoch: 3 cost time: 1.178086757659912
Epoch: 3, Steps: 131 | Train Loss: 0.4251318 Vali Loss: 0.2751398 Best vali loss: 0.2751398
	iters: 100, epoch: 4 | loss: 0.4599364
	speed: 0.0145s/iter; left time: 8.0847s
Updating learning rate to 5.94641264875e-05
Epoch: 4 cost time: 1.1763780117034912
Epoch: 4, Steps: 131 | Train Loss: 0.4599364 Vali Loss: 0.2792690 Best vali loss: 0.2751398
	iters: 100, epoch: 5 | loss: 0.3030863
	speed: 0.0140s/iter; left time: 5.9561s
Updating learning rate to 2.973206324375e-05
Epoch: 5 cost time: 1.1817264556884766
Epoch: 5, Steps: 131 | Train Loss: 0.3030863 Vali Loss: 0.2884537 Best vali loss: 0.2751398
	iters: 100, epoch: 6 | loss: 0.2866433
	speed: 0.0140s/iter; left time: 4.1013s
Updating learning rate to 1.4866031621875e-05
Epoch: 6 cost time: 1.1755332946777344
Epoch: 6, Steps: 131 | Train Loss: 0.2866433 Vali Loss: 0.2906585 Best vali loss: 0.2751398
	iters: 100, epoch: 7 | loss: 0.2631888
	speed: 0.0139s/iter; left time: 2.2695s
Updating learning rate to 7.4330158109375e-06
Epoch: 7 cost time: 1.1863460540771484
Epoch: 7, Steps: 131 | Train Loss: 0.2631888 Vali Loss: 0.2937977 Best vali loss: 0.2751398
	iters: 100, epoch: 8 | loss: 0.2982006
	speed: 0.0141s/iter; left time: 0.4501s
Updating learning rate to 3.71650790546875e-06
Epoch: 8 cost time: 1.1805119514465332
Epoch: 8, Steps: 131 | Train Loss: 0.2982006 Vali Loss: 0.2950489 Best vali loss: 0.2751398

best validation loss 0.27513983968732614

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032061479263, 'e_layers': 4, 'learning_rate': 0.0004819059439, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3258801
	speed: 0.0142s/iter; left time: 13.4292s
Updating learning rate to 0.0004819059439
Validation loss decreased (inf --> 0.2899).  Saving model state dict ...
Epoch: 1 cost time: 1.4090220928192139
Epoch: 1, Steps: 131 | Train Loss: 0.3258801 Vali Loss: 0.2898933 Best vali loss: 0.2898933
	iters: 100, epoch: 2 | loss: 0.4940665
	speed: 0.0143s/iter; left time: 11.7155s
Updating learning rate to 0.00024095297195
Epoch: 2 cost time: 1.1804192066192627
Epoch: 2, Steps: 131 | Train Loss: 0.4940665 Vali Loss: 0.2928156 Best vali loss: 0.2898933
	iters: 100, epoch: 3 | loss: 0.4285191
	speed: 0.0140s/iter; left time: 9.6228s
Updating learning rate to 0.000120476485975
Validation loss decreased (0.2899 --> 0.2775).  Saving model state dict ...
Epoch: 3 cost time: 1.178462028503418
Epoch: 3, Steps: 131 | Train Loss: 0.4285191 Vali Loss: 0.2774913 Best vali loss: 0.2774913

best validation loss 0.2774913306128097

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0101027116913, 'e_layers': 3, 'learning_rate': 0.0004749627027, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5227770
	speed: 0.0120s/iter; left time: 11.4151s
Updating learning rate to 0.0004568855112153867
Validation loss decreased (inf --> 0.2722).  Saving model state dict ...
Epoch: 1 cost time: 1.1332862377166748
Epoch: 1, Steps: 131 | Train Loss: 0.5227770 Vali Loss: 0.2722205 Best vali loss: 0.2722205
	iters: 100, epoch: 2 | loss: 0.5459065
	speed: 0.0114s/iter; left time: 9.3074s
Updating learning rate to 0.0004054060252949301
Epoch: 2 cost time: 0.9120707511901855
Epoch: 2, Steps: 131 | Train Loss: 0.5459065 Vali Loss: 0.2817342 Best vali loss: 0.2722205
	iters: 100, epoch: 3 | loss: 0.5378747
	speed: 0.0110s/iter; left time: 7.5447s
Updating learning rate to 0.00032836153000731787
Epoch: 3 cost time: 0.9173877239227295
Epoch: 3, Steps: 131 | Train Loss: 0.5378747 Vali Loss: 0.2819359 Best vali loss: 0.2722205

best validation loss 0.2722204533894295

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0066222359509, 'e_layers': 1, 'learning_rate': 0.0032768336283, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3416497
	speed: 0.0079s/iter; left time: 15.7085s
	iters: 200, epoch: 1 | loss: 0.9155706
	speed: 0.0025s/iter; left time: 4.7595s
Updating learning rate to 0.0032768336283
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 0.9153611660003662
Epoch: 1, Steps: 262 | Train Loss: 0.6286102 Vali Loss: 0.2831583 Best vali loss: 0.2831583
	iters: 100, epoch: 2 | loss: 0.8437250
	speed: 0.0060s/iter; left time: 10.4452s
	iters: 200, epoch: 2 | loss: 0.6133989
	speed: 0.0023s/iter; left time: 3.7598s
Updating learning rate to 0.00163841681415
Epoch: 2 cost time: 0.6462244987487793
Epoch: 2, Steps: 262 | Train Loss: 0.7285619 Vali Loss: 0.2884354 Best vali loss: 0.2831583
	iters: 100, epoch: 3 | loss: 0.5747247
	speed: 0.0057s/iter; left time: 8.4233s
	iters: 200, epoch: 3 | loss: 0.5727817
	speed: 0.0023s/iter; left time: 3.0970s
Updating learning rate to 0.000819208407075
Epoch: 3 cost time: 0.6374449729919434
Epoch: 3, Steps: 262 | Train Loss: 0.5737532 Vali Loss: 0.2879309 Best vali loss: 0.2831583

best validation loss 0.2831583389975671

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0101027116913, 'e_layers': 3, 'learning_rate': 0.0004749627027, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3411599
	speed: 0.0125s/iter; left time: 6.9543s
Updating learning rate to 0.00023748135135
Epoch: 4 cost time: 1.1597113609313965
Epoch: 4, Steps: 131 | Train Loss: 0.3411599 Vali Loss: 0.2797625 Best vali loss: 0.2722205
	iters: 100, epoch: 5 | loss: 0.3140095
	speed: 0.0111s/iter; left time: 4.7317s
Updating learning rate to 0.00014660117269268218
Epoch: 5 cost time: 0.9179966449737549
Epoch: 5, Steps: 131 | Train Loss: 0.3140095 Vali Loss: 0.2846506 Best vali loss: 0.2722205
	iters: 100, epoch: 6 | loss: 0.3433464
	speed: 0.0111s/iter; left time: 3.2748s
Updating learning rate to 6.955667740506995e-05
Epoch: 6 cost time: 0.921053409576416
Epoch: 6, Steps: 131 | Train Loss: 0.3433464 Vali Loss: 0.3041087 Best vali loss: 0.2722205
	iters: 100, epoch: 7 | loss: 0.2432093
	speed: 0.0110s/iter; left time: 1.7988s
Updating learning rate to 1.8077191484613366e-05
Epoch: 7 cost time: 0.9104733467102051
Epoch: 7, Steps: 131 | Train Loss: 0.2432093 Vali Loss: 0.3073957 Best vali loss: 0.2722205
	iters: 100, epoch: 8 | loss: 0.2639672
	speed: 0.0112s/iter; left time: 0.3570s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9153218269348145
Epoch: 8, Steps: 131 | Train Loss: 0.2639672 Vali Loss: 0.3124648 Best vali loss: 0.2722205

best validation loss 0.2722204533894295

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.007832029785, 'e_layers': 4, 'learning_rate': 0.0044436839849, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6825885
	speed: 0.0114s/iter; left time: 10.7888s
Updating learning rate to 0.0044436839849
Validation loss decreased (inf --> 0.2963).  Saving model state dict ...
Epoch: 1 cost time: 1.0513012409210205
Epoch: 1, Steps: 131 | Train Loss: 0.6825885 Vali Loss: 0.2962692 Best vali loss: 0.2962692
	iters: 100, epoch: 2 | loss: 0.4296567
	speed: 0.0093s/iter; left time: 7.6196s
Updating learning rate to 0.00222184199245
Epoch: 2 cost time: 0.7725257873535156
Epoch: 2, Steps: 131 | Train Loss: 0.4296567 Vali Loss: 0.3028259 Best vali loss: 0.2962692
	iters: 100, epoch: 3 | loss: 0.5743914
	speed: 0.0092s/iter; left time: 6.3436s
Updating learning rate to 0.001110920996225
Validation loss decreased (0.2963 --> 0.2877).  Saving model state dict ...
Epoch: 3 cost time: 0.7762770652770996
Epoch: 3, Steps: 131 | Train Loss: 0.5743914 Vali Loss: 0.2877430 Best vali loss: 0.2877430
	iters: 100, epoch: 4 | loss: 0.4349214
	speed: 0.0095s/iter; left time: 5.2560s
Updating learning rate to 0.0005554604981125
Epoch: 4 cost time: 0.7953293323516846
Epoch: 4, Steps: 131 | Train Loss: 0.4349214 Vali Loss: 0.2901115 Best vali loss: 0.2877430
	iters: 100, epoch: 5 | loss: 0.5975533
	speed: 0.0093s/iter; left time: 3.9662s
Updating learning rate to 0.00027773024905625
Epoch: 5 cost time: 0.7861871719360352
Epoch: 5, Steps: 131 | Train Loss: 0.5975533 Vali Loss: 0.2943453 Best vali loss: 0.2877430
	iters: 100, epoch: 6 | loss: 0.6053207
	speed: 0.0094s/iter; left time: 2.7630s
Updating learning rate to 0.000138865124528125
Epoch: 6 cost time: 0.8010547161102295
Epoch: 6, Steps: 131 | Train Loss: 0.6053207 Vali Loss: 0.2954037 Best vali loss: 0.2877430
	iters: 100, epoch: 7 | loss: 0.3383065
	speed: 0.0093s/iter; left time: 1.5160s
Updating learning rate to 6.94325622640625e-05
Epoch: 7 cost time: 0.7818422317504883
Epoch: 7, Steps: 131 | Train Loss: 0.3383065 Vali Loss: 0.2960905 Best vali loss: 0.2877430
	iters: 100, epoch: 8 | loss: 0.4459838
	speed: 0.0088s/iter; left time: 0.2814s
Updating learning rate to 3.471628113203125e-05
Epoch: 8 cost time: 0.7268953323364258
Epoch: 8, Steps: 131 | Train Loss: 0.4459838 Vali Loss: 0.2952857 Best vali loss: 0.2877430

best validation loss 0.2877430403518517

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0027673111193, 'e_layers': 2, 'learning_rate': 0.0004851446769, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004666799570973556
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 0.7583701610565186
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2804728 Best vali loss: 0.2804728
Updating learning rate to 0.00041409688389627326
Epoch: 2 cost time: 0.5296649932861328
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2823321 Best vali loss: 0.2804728
Updating learning rate to 0.00033540075352487224
Epoch: 3 cost time: 0.5360128879547119
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2944053 Best vali loss: 0.2804728
Updating learning rate to 0.00024257233845
Epoch: 4 cost time: 0.5386679172515869
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2830581 Best vali loss: 0.2804728
Updating learning rate to 0.00014974392337512778
Epoch: 5 cost time: 0.5344448089599609
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2850783 Best vali loss: 0.2804728
Updating learning rate to 7.104779300372672e-05
Epoch: 6 cost time: 0.5327277183532715
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2857073 Best vali loss: 0.2804728
Updating learning rate to 1.8464719802644374e-05
Epoch: 7 cost time: 0.5280411243438721
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2881795 Best vali loss: 0.2804728
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5290403366088867
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2884880 Best vali loss: 0.2804728

best validation loss 0.2804728352079253

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021464563752, 'e_layers': 3, 'learning_rate': 5.45651496e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4196886
	speed: 0.0109s/iter; left time: 10.3217s
Updating learning rate to 5.2488387251928213e-05
Validation loss decreased (inf --> 0.2894).  Saving model state dict ...
Epoch: 1 cost time: 0.90728759765625
Epoch: 1, Steps: 131 | Train Loss: 0.4196886 Vali Loss: 0.2893615 Best vali loss: 0.2893615
	iters: 100, epoch: 2 | loss: 0.6043977
	speed: 0.0083s/iter; left time: 6.7672s
Updating learning rate to 4.6574268449309214e-05
Validation loss decreased (0.2894 --> 0.2804).  Saving model state dict ...
Epoch: 2 cost time: 0.676994800567627
Epoch: 2, Steps: 131 | Train Loss: 0.6043977 Vali Loss: 0.2803651 Best vali loss: 0.2803651
	iters: 100, epoch: 3 | loss: 0.5144364
	speed: 0.0077s/iter; left time: 5.2723s
Updating learning rate to 3.7723164168221306e-05
Validation loss decreased (0.2804 --> 0.2787).  Saving model state dict ...
Epoch: 3 cost time: 0.6017880439758301
Epoch: 3, Steps: 131 | Train Loss: 0.5144364 Vali Loss: 0.2787322 Best vali loss: 0.2787322

best validation loss 0.27873218312233344

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.002104969177, 'e_layers': 3, 'learning_rate': 0.0004932607838, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4092364
	speed: 0.0108s/iter; left time: 10.2088s
Updating learning rate to 0.00047448716307164744
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.9968516826629639
Epoch: 1, Steps: 131 | Train Loss: 0.4092364 Vali Loss: 0.2793303 Best vali loss: 0.2793303
	iters: 100, epoch: 2 | loss: 0.4337118
	speed: 0.0094s/iter; left time: 7.7203s
Updating learning rate to 0.0004210244144591857
Epoch: 2 cost time: 0.7679023742675781
Epoch: 2, Steps: 131 | Train Loss: 0.4337118 Vali Loss: 0.2809458 Best vali loss: 0.2793303
	iters: 100, epoch: 3 | loss: 0.3960578
	speed: 0.0091s/iter; left time: 6.2785s
Updating learning rate to 0.00034101175679783925
Epoch: 3 cost time: 0.7568728923797607
Epoch: 3, Steps: 131 | Train Loss: 0.3960578 Vali Loss: 0.2874175 Best vali loss: 0.2793303

best validation loss 0.2793302641909288

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.002100213088, 'e_layers': 3, 'learning_rate': 0.000501647923, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4081304
	speed: 0.0108s/iter; left time: 10.2762s
Updating learning rate to 0.000482555085793249
Validation loss decreased (inf --> 0.2793).  Saving model state dict ...
Epoch: 1 cost time: 0.978379487991333
Epoch: 1, Steps: 131 | Train Loss: 0.4081304 Vali Loss: 0.2792948 Best vali loss: 0.2792948
	iters: 100, epoch: 2 | loss: 0.4400706
	speed: 0.0094s/iter; left time: 7.6528s
Updating learning rate to 0.0004281832855607235
Epoch: 2 cost time: 0.7567446231842041
Epoch: 2, Steps: 131 | Train Loss: 0.4400706 Vali Loss: 0.2854778 Best vali loss: 0.2792948
	iters: 100, epoch: 3 | loss: 0.3654056
	speed: 0.0091s/iter; left time: 6.2466s
Updating learning rate to 0.00034681013600622914
Epoch: 3 cost time: 0.7598488330841064
Epoch: 3, Steps: 131 | Train Loss: 0.3654056 Vali Loss: 0.2893231 Best vali loss: 0.2792948

best validation loss 0.2792948339953215

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021464563752, 'e_layers': 3, 'learning_rate': 5.45651496e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4031046
	speed: 0.0104s/iter; left time: 5.7995s
Updating learning rate to 2.72825748e-05
Validation loss decreased (0.2787 --> 0.2786).  Saving model state dict ...
Epoch: 4 cost time: 0.8964438438415527
Epoch: 4, Steps: 131 | Train Loss: 0.4031046 Vali Loss: 0.2786195 Best vali loss: 0.2786195
	iters: 100, epoch: 5 | loss: 0.5812758
	speed: 0.0081s/iter; left time: 3.4311s
Updating learning rate to 1.68419854317787e-05
Validation loss decreased (0.2786 --> 0.2783).  Saving model state dict ...
Epoch: 5 cost time: 0.657219409942627
Epoch: 5, Steps: 131 | Train Loss: 0.5812758 Vali Loss: 0.2783208 Best vali loss: 0.2783208
	iters: 100, epoch: 6 | loss: 0.4852242
	speed: 0.0079s/iter; left time: 2.3190s
Updating learning rate to 7.990881150690786e-06
Validation loss decreased (0.2783 --> 0.2775).  Saving model state dict ...
Epoch: 6 cost time: 0.6449062824249268
Epoch: 6, Steps: 131 | Train Loss: 0.4852242 Vali Loss: 0.2774719 Best vali loss: 0.2774719
	iters: 100, epoch: 7 | loss: 0.4964914
	speed: 0.0079s/iter; left time: 1.2893s
Updating learning rate to 2.0767623480717877e-06
Epoch: 7 cost time: 0.6432793140411377
Epoch: 7, Steps: 131 | Train Loss: 0.4964914 Vali Loss: 0.2777857 Best vali loss: 0.2774719
	iters: 100, epoch: 8 | loss: 0.5283185
	speed: 0.0079s/iter; left time: 0.2534s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6498534679412842
Epoch: 8, Steps: 131 | Train Loss: 0.5283185 Vali Loss: 0.2777749 Best vali loss: 0.2774719

best validation loss 0.2774718721456446

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0047701691746, 'e_layers': 4, 'learning_rate': 0.0003862312133, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003862312133
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 0.6807260513305664
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2806415 Best vali loss: 0.2806415
Updating learning rate to 0.00019311560665
Epoch: 2 cost time: 0.46246862411499023
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2808610 Best vali loss: 0.2806415
Updating learning rate to 9.6557803325e-05
Epoch: 3 cost time: 0.430375337600708
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2827500 Best vali loss: 0.2806415
Updating learning rate to 4.82789016625e-05
Epoch: 4 cost time: 0.4274766445159912
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2826093 Best vali loss: 0.2806415
Updating learning rate to 2.413945083125e-05
Epoch: 5 cost time: 0.41005420684814453
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2832558 Best vali loss: 0.2806415
Updating learning rate to 1.2069725415625e-05
Epoch: 6 cost time: 0.41881275177001953
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2846341 Best vali loss: 0.2806415
Updating learning rate to 6.0348627078125e-06
Epoch: 7 cost time: 0.4549367427825928
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2840572 Best vali loss: 0.2806415
Updating learning rate to 3.01743135390625e-06
Epoch: 8 cost time: 0.4749488830566406
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2842245 Best vali loss: 0.2806415

best validation loss 0.28064153120392715

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021154495642, 'e_layers': 3, 'learning_rate': 0.0003614661271, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003614661271
Validation loss decreased (inf --> 0.2801).  Saving model state dict ...
Epoch: 1 cost time: 0.8078815937042236
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2800571 Best vali loss: 0.2800571
Updating learning rate to 0.00018073306355
Validation loss decreased (0.2801 --> 0.2775).  Saving model state dict ...
Epoch: 2 cost time: 0.5882699489593506
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2775460 Best vali loss: 0.2775460
Updating learning rate to 9.0366531775e-05
Epoch: 3 cost time: 0.5935132503509521
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2827768 Best vali loss: 0.2775460
Updating learning rate to 4.51832658875e-05
Epoch: 4 cost time: 0.6003162860870361
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2959161 Best vali loss: 0.2775460
Updating learning rate to 2.259163294375e-05
Epoch: 5 cost time: 0.597557783126831
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3028704 Best vali loss: 0.2775460
Updating learning rate to 1.1295816471875e-05
Epoch: 6 cost time: 0.5954537391662598
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3033843 Best vali loss: 0.2775460
Updating learning rate to 5.6479082359375e-06
Epoch: 7 cost time: 0.5958938598632812
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3079945 Best vali loss: 0.2775460
Updating learning rate to 2.82395411796875e-06
Epoch: 8 cost time: 0.5934619903564453
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3098213 Best vali loss: 0.2775460

best validation loss 0.2775459759970853

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271109863, 'e_layers': 2, 'learning_rate': 0.0002345264902, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597004
	speed: 0.0106s/iter; left time: 10.0892s
Updating learning rate to 0.0002345264902
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9322667121887207
Epoch: 1, Steps: 131 | Train Loss: 0.5597004 Vali Loss: 0.2756343 Best vali loss: 0.2756343
	iters: 100, epoch: 2 | loss: 0.3247904
	speed: 0.0089s/iter; left time: 7.2811s
Updating learning rate to 0.0001172632451
Validation loss decreased (0.2756 --> 0.2702).  Saving model state dict ...
Epoch: 2 cost time: 0.7033414840698242
Epoch: 2, Steps: 131 | Train Loss: 0.3247904 Vali Loss: 0.2702056 Best vali loss: 0.2702056
	iters: 100, epoch: 3 | loss: 0.4606627
	speed: 0.0091s/iter; left time: 6.2363s
Updating learning rate to 5.863162255e-05
Epoch: 3 cost time: 0.705303430557251
Epoch: 3, Steps: 131 | Train Loss: 0.4606627 Vali Loss: 0.2757261 Best vali loss: 0.2702056

best validation loss 0.2702055536667713

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013280634098, 'e_layers': 4, 'learning_rate': 0.000479958445, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4622556
	speed: 0.0150s/iter; left time: 14.2096s
Updating learning rate to 0.000479958445
Validation loss decreased (inf --> 0.2917).  Saving model state dict ...
Epoch: 1 cost time: 1.5091028213500977
Epoch: 1, Steps: 131 | Train Loss: 0.4622556 Vali Loss: 0.2917126 Best vali loss: 0.2917126
	iters: 100, epoch: 2 | loss: 0.4781395
	speed: 0.0155s/iter; left time: 12.7101s
Updating learning rate to 0.0002399792225
Epoch: 2 cost time: 1.2904882431030273
Epoch: 2, Steps: 131 | Train Loss: 0.4781395 Vali Loss: 0.2924032 Best vali loss: 0.2917126
	iters: 100, epoch: 3 | loss: 0.4102707
	speed: 0.0151s/iter; left time: 10.3977s
Updating learning rate to 0.00011998961125
Epoch: 3 cost time: 1.2878804206848145
Epoch: 3, Steps: 131 | Train Loss: 0.4102707 Vali Loss: 0.2960320 Best vali loss: 0.2917126

best validation loss 0.29171260776307867

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0078596519334, 'e_layers': 3, 'learning_rate': 0.0001635158974, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4826446
	speed: 0.0098s/iter; left time: 19.5563s
	iters: 200, epoch: 1 | loss: 0.4004770
	speed: 0.0043s/iter; left time: 8.0744s
Updating learning rate to 0.00015729244412403777
Validation loss decreased (inf --> 0.2900).  Saving model state dict ...
Epoch: 1 cost time: 1.3948066234588623
Epoch: 1, Steps: 262 | Train Loss: 0.4415608 Vali Loss: 0.2899875 Best vali loss: 0.2899875
	iters: 100, epoch: 2 | loss: 0.6814523
	speed: 0.0096s/iter; left time: 16.6860s
	iters: 200, epoch: 2 | loss: 0.3413655
	speed: 0.0044s/iter; left time: 7.1956s
Updating learning rate to 0.00013956954864167187
Validation loss decreased (0.2900 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 1.2100391387939453
Epoch: 2, Steps: 262 | Train Loss: 0.5114089 Vali Loss: 0.2826010 Best vali loss: 0.2826010
	iters: 100, epoch: 3 | loss: 0.4682448
	speed: 0.0095s/iter; left time: 13.9591s
	iters: 200, epoch: 3 | loss: 0.3360068
	speed: 0.0043s/iter; left time: 5.8597s
Updating learning rate to 0.00011304536113164493
Validation loss decreased (0.2826 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 1.161470651626587
Epoch: 3, Steps: 262 | Train Loss: 0.4021258 Vali Loss: 0.2813066 Best vali loss: 0.2813066

best validation loss 0.2813066088463924

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010271109863, 'e_layers': 2, 'learning_rate': 0.0002345264902, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4186186
	speed: 0.0108s/iter; left time: 6.0208s
Updating learning rate to 2.9315811275e-05
Epoch: 4 cost time: 0.937563419342041
Epoch: 4, Steps: 131 | Train Loss: 0.4186186 Vali Loss: 0.3046195 Best vali loss: 0.2702056
	iters: 100, epoch: 5 | loss: 0.2824232
	speed: 0.0087s/iter; left time: 3.6947s
Updating learning rate to 1.46579056375e-05
Epoch: 5 cost time: 0.7020947933197021
Epoch: 5, Steps: 131 | Train Loss: 0.2824232 Vali Loss: 0.2983406 Best vali loss: 0.2702056
	iters: 100, epoch: 6 | loss: 0.4321745
	speed: 0.0085s/iter; left time: 2.5109s
Updating learning rate to 7.32895281875e-06
Epoch: 6 cost time: 0.6893348693847656
Epoch: 6, Steps: 131 | Train Loss: 0.4321745 Vali Loss: 0.2993207 Best vali loss: 0.2702056
	iters: 100, epoch: 7 | loss: 0.4648241
	speed: 0.0085s/iter; left time: 1.3909s
Updating learning rate to 3.664476409375e-06
Epoch: 7 cost time: 0.7000172138214111
Epoch: 7, Steps: 131 | Train Loss: 0.4648241 Vali Loss: 0.2997239 Best vali loss: 0.2702056
	iters: 100, epoch: 8 | loss: 0.3291136
	speed: 0.0087s/iter; left time: 0.2780s
Updating learning rate to 1.8322382046875e-06
Epoch: 8 cost time: 0.7035036087036133
Epoch: 8, Steps: 131 | Train Loss: 0.3291136 Vali Loss: 0.2964944 Best vali loss: 0.2702056

best validation loss 0.2702055536667713

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0032899143762, 'e_layers': 2, 'learning_rate': 0.0034597463217, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00332806756799992
Validation loss decreased (inf --> 0.2953).  Saving model state dict ...
Epoch: 1 cost time: 0.5758533477783203
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2953451 Best vali loss: 0.2953451
Updating learning rate to 0.002953078203479642
Validation loss decreased (0.2953 --> 0.2893).  Saving model state dict ...
Epoch: 2 cost time: 0.3491804599761963
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2893100 Best vali loss: 0.2893100
Updating learning rate to 0.0023918669596003253
Epoch: 3 cost time: 0.3182637691497803
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3061780 Best vali loss: 0.2893100
Updating learning rate to 0.00172987316085
Epoch: 4 cost time: 0.32890820503234863
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3068316 Best vali loss: 0.2893100
Updating learning rate to 0.001067879362099675
Epoch: 5 cost time: 0.3162655830383301
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2997249 Best vali loss: 0.2893100
Updating learning rate to 0.0005066681182203578
Epoch: 6 cost time: 0.3167431354522705
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3258592 Best vali loss: 0.2893100
Updating learning rate to 0.00013167875370008008
Epoch: 7 cost time: 0.34098267555236816
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3166911 Best vali loss: 0.2893100
Updating learning rate to 0.0
Epoch: 8 cost time: 0.30934810638427734
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3240024 Best vali loss: 0.2893100

best validation loss 0.28931004321012144

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0024814880902, 'e_layers': 3, 'learning_rate': 0.0001514749646, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3703837
	speed: 0.0098s/iter; left time: 19.6667s
	iters: 200, epoch: 1 | loss: 0.3859569
	speed: 0.0043s/iter; left time: 8.2293s
Updating learning rate to 0.00014570979204090584
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 1.3745982646942139
Epoch: 1, Steps: 262 | Train Loss: 0.3781703 Vali Loss: 0.2814700 Best vali loss: 0.2814700
	iters: 100, epoch: 2 | loss: 0.4439043
	speed: 0.0087s/iter; left time: 15.0461s
	iters: 200, epoch: 2 | loss: 0.5066862
	speed: 0.0040s/iter; left time: 6.5182s
Updating learning rate to 0.0001292919696243261
Validation loss decreased (0.2815 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 1.1049137115478516
Epoch: 2, Steps: 262 | Train Loss: 0.4752952 Vali Loss: 0.2800407 Best vali loss: 0.2800407
	iters: 100, epoch: 3 | loss: 0.5938225
	speed: 0.0096s/iter; left time: 14.1938s
	iters: 200, epoch: 3 | loss: 0.2487709
	speed: 0.0044s/iter; left time: 6.0975s
Updating learning rate to 0.00010472096198525423
Validation loss decreased (0.2800 --> 0.2790).  Saving model state dict ...
Epoch: 3 cost time: 1.2112834453582764
Epoch: 3, Steps: 262 | Train Loss: 0.4212967 Vali Loss: 0.2790459 Best vali loss: 0.2790459
	iters: 100, epoch: 4 | loss: 0.7183555
	speed: 0.0095s/iter; left time: 11.5537s
	iters: 200, epoch: 4 | loss: 0.6328331
	speed: 0.0041s/iter; left time: 4.5919s
Updating learning rate to 7.57374823e-05
Validation loss decreased (0.2790 --> 0.2767).  Saving model state dict ...
Epoch: 4 cost time: 1.149972915649414
Epoch: 4, Steps: 262 | Train Loss: 0.6755943 Vali Loss: 0.2766738 Best vali loss: 0.2766738
	iters: 100, epoch: 5 | loss: 0.6389787
	speed: 0.0092s/iter; left time: 8.6882s
	iters: 200, epoch: 5 | loss: 0.3618204
	speed: 0.0039s/iter; left time: 3.2791s
Updating learning rate to 4.675400261474577e-05
Epoch: 5 cost time: 1.08609938621521
Epoch: 5, Steps: 262 | Train Loss: 0.5003995 Vali Loss: 0.2799459 Best vali loss: 0.2766738
	iters: 100, epoch: 6 | loss: 0.2479253
	speed: 0.0087s/iter; left time: 5.9933s
	iters: 200, epoch: 6 | loss: 0.6596391
	speed: 0.0040s/iter; left time: 2.3308s
Updating learning rate to 2.218299497567389e-05
Epoch: 6 cost time: 1.0931828022003174
Epoch: 6, Steps: 262 | Train Loss: 0.4537822 Vali Loss: 0.2813729 Best vali loss: 0.2766738
	iters: 100, epoch: 7 | loss: 0.5498220
	speed: 0.0094s/iter; left time: 4.0152s
	iters: 200, epoch: 7 | loss: 0.3670200
	speed: 0.0045s/iter; left time: 1.4560s
Updating learning rate to 5.7651725590941456e-06
Epoch: 7 cost time: 1.2117557525634766
Epoch: 7, Steps: 262 | Train Loss: 0.4584210 Vali Loss: 0.2835215 Best vali loss: 0.2766738
	iters: 100, epoch: 8 | loss: 0.5101467
	speed: 0.0097s/iter; left time: 1.5888s
	iters: 200, epoch: 8 | loss: 0.3911347
	speed: 0.0046s/iter; left time: 0.2895s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.255464792251587
Epoch: 8, Steps: 262 | Train Loss: 0.4506407 Vali Loss: 0.2838728 Best vali loss: 0.2766738

best validation loss 0.2766738225421572

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0021211022658, 'e_layers': 3, 'learning_rate': 0.0004750635599, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5518785
	speed: 0.0108s/iter; left time: 10.2738s
Updating learning rate to 0.00045698252976677985
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 0.9857418537139893
Epoch: 1, Steps: 131 | Train Loss: 0.5518785 Vali Loss: 0.2821182 Best vali loss: 0.2821182
	iters: 100, epoch: 2 | loss: 0.4505877
	speed: 0.0092s/iter; left time: 7.5099s
Updating learning rate to 0.0004054921122999558
Epoch: 2 cost time: 0.7448532581329346
Epoch: 2, Steps: 131 | Train Loss: 0.4505877 Vali Loss: 0.2886392 Best vali loss: 0.2821182
	iters: 100, epoch: 3 | loss: 0.4081609
	speed: 0.0089s/iter; left time: 6.1292s
Updating learning rate to 0.00032843125679705526
Epoch: 3 cost time: 0.7346413135528564
Epoch: 3, Steps: 131 | Train Loss: 0.4081609 Vali Loss: 0.2903717 Best vali loss: 0.2821182

best validation loss 0.2821181827803534

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002347548792, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597308
	speed: 0.0103s/iter; left time: 9.7294s
Updating learning rate to 0.0002347548792
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9133822917938232
Epoch: 1, Steps: 131 | Train Loss: 0.5597308 Vali Loss: 0.2756482 Best vali loss: 0.2756482
	iters: 100, epoch: 2 | loss: 0.3259293
	speed: 0.0089s/iter; left time: 7.2656s
Updating learning rate to 0.0001173774396
Validation loss decreased (0.2756 --> 0.2729).  Saving model state dict ...
Epoch: 2 cost time: 0.7011072635650635
Epoch: 2, Steps: 131 | Train Loss: 0.3259293 Vali Loss: 0.2728579 Best vali loss: 0.2728579
	iters: 100, epoch: 3 | loss: 0.4627674
	speed: 0.0091s/iter; left time: 6.2296s
Updating learning rate to 5.86887198e-05
Epoch: 3 cost time: 0.7058324813842773
Epoch: 3, Steps: 131 | Train Loss: 0.4627674 Vali Loss: 0.2779588 Best vali loss: 0.2728579

best validation loss 0.272857877125568

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030045535688, 'e_layers': 3, 'learning_rate': 0.0004716577482, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5210580
	speed: 0.0121s/iter; left time: 11.5178s
Updating learning rate to 0.0004716577482
Validation loss decreased (inf --> 0.2692).  Saving model state dict ...
Epoch: 1 cost time: 1.144970417022705
Epoch: 1, Steps: 131 | Train Loss: 0.5210580 Vali Loss: 0.2692109 Best vali loss: 0.2692109
	iters: 100, epoch: 2 | loss: 0.5511774
	speed: 0.0112s/iter; left time: 9.1991s
Updating learning rate to 0.0002358288741
Epoch: 2 cost time: 0.911182165145874
Epoch: 2, Steps: 131 | Train Loss: 0.5511774 Vali Loss: 0.2795510 Best vali loss: 0.2692109
	iters: 100, epoch: 3 | loss: 0.5228217
	speed: 0.0111s/iter; left time: 7.5936s
Updating learning rate to 0.00011791443705
Epoch: 3 cost time: 0.9130604267120361
Epoch: 3, Steps: 131 | Train Loss: 0.5228217 Vali Loss: 0.2812838 Best vali loss: 0.2692109

best validation loss 0.269210911730312

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030045535688, 'e_layers': 3, 'learning_rate': 0.0004716577482, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3434947
	speed: 0.0125s/iter; left time: 6.9236s
Updating learning rate to 5.8957218525e-05
Epoch: 4 cost time: 1.1508474349975586
Epoch: 4, Steps: 131 | Train Loss: 0.3434947 Vali Loss: 0.2824108 Best vali loss: 0.2692109
	iters: 100, epoch: 5 | loss: 0.3466483
	speed: 0.0111s/iter; left time: 4.7319s
Updating learning rate to 2.94786092625e-05
Epoch: 5 cost time: 0.9187848567962646
Epoch: 5, Steps: 131 | Train Loss: 0.3466483 Vali Loss: 0.2771040 Best vali loss: 0.2692109
	iters: 100, epoch: 6 | loss: 0.3819845
	speed: 0.0111s/iter; left time: 3.2508s
Updating learning rate to 1.473930463125e-05
Epoch: 6 cost time: 0.9194943904876709
Epoch: 6, Steps: 131 | Train Loss: 0.3819845 Vali Loss: 0.2834340 Best vali loss: 0.2692109
	iters: 100, epoch: 7 | loss: 0.2833223
	speed: 0.0112s/iter; left time: 1.8191s
Updating learning rate to 7.369652315625e-06
Epoch: 7 cost time: 0.9182066917419434
Epoch: 7, Steps: 131 | Train Loss: 0.2833223 Vali Loss: 0.2830539 Best vali loss: 0.2692109
	iters: 100, epoch: 8 | loss: 0.3021237
	speed: 0.0111s/iter; left time: 0.3560s
Updating learning rate to 3.6848261578125e-06
Epoch: 8 cost time: 0.9166631698608398
Epoch: 8, Steps: 131 | Train Loss: 0.3021237 Vali Loss: 0.2837905 Best vali loss: 0.2692109

best validation loss 0.269210911730312

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010262959421, 'e_layers': 2, 'learning_rate': 0.0002345292034, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5597337
	speed: 0.0106s/iter; left time: 10.0995s
Updating learning rate to 0.0002345292034
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9489631652832031
Epoch: 1, Steps: 131 | Train Loss: 0.5597337 Vali Loss: 0.2756437 Best vali loss: 0.2756437
	iters: 100, epoch: 2 | loss: 0.3239042
	speed: 0.0089s/iter; left time: 7.3162s
Updating learning rate to 0.0001172646017
Validation loss decreased (0.2756 --> 0.2686).  Saving model state dict ...
Epoch: 2 cost time: 0.7028892040252686
Epoch: 2, Steps: 131 | Train Loss: 0.3239042 Vali Loss: 0.2686209 Best vali loss: 0.2686209
	iters: 100, epoch: 3 | loss: 0.4608155
	speed: 0.0089s/iter; left time: 6.1134s
Updating learning rate to 5.863230085e-05
Epoch: 3 cost time: 0.704200029373169
Epoch: 3, Steps: 131 | Train Loss: 0.4608155 Vali Loss: 0.2768970 Best vali loss: 0.2686209
	iters: 100, epoch: 4 | loss: 0.5046833
	speed: 0.0087s/iter; left time: 4.8249s
Updating learning rate to 2.9316150425e-05
Epoch: 4 cost time: 0.6979098320007324
Epoch: 4, Steps: 131 | Train Loss: 0.5046833 Vali Loss: 0.2877438 Best vali loss: 0.2686209
	iters: 100, epoch: 5 | loss: 0.3354858
	speed: 0.0086s/iter; left time: 3.6592s
Updating learning rate to 1.46580752125e-05
Epoch: 5 cost time: 0.6987931728363037
Epoch: 5, Steps: 131 | Train Loss: 0.3354858 Vali Loss: 0.2871609 Best vali loss: 0.2686209
	iters: 100, epoch: 6 | loss: 0.3184739
	speed: 0.0087s/iter; left time: 2.5493s
Updating learning rate to 7.32903760625e-06
Epoch: 6 cost time: 0.7057502269744873
Epoch: 6, Steps: 131 | Train Loss: 0.3184739 Vali Loss: 0.2855037 Best vali loss: 0.2686209
	iters: 100, epoch: 7 | loss: 0.3108261
	speed: 0.0087s/iter; left time: 1.4168s
Updating learning rate to 3.664518803125e-06
Epoch: 7 cost time: 0.6992928981781006
Epoch: 7, Steps: 131 | Train Loss: 0.3108261 Vali Loss: 0.2898875 Best vali loss: 0.2686209
	iters: 100, epoch: 8 | loss: 0.3965119
	speed: 0.0087s/iter; left time: 0.2775s
Updating learning rate to 1.8322594015625e-06
Epoch: 8 cost time: 0.7007410526275635
Epoch: 8, Steps: 131 | Train Loss: 0.3965119 Vali Loss: 0.2918804 Best vali loss: 0.2686209

best validation loss 0.26862086780721167

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032954141897, 'e_layers': 3, 'learning_rate': 0.0005043445061, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5539119
	speed: 0.0108s/iter; left time: 10.2382s
Updating learning rate to 0.0004851490363101519
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 0.9661805629730225
Epoch: 1, Steps: 131 | Train Loss: 0.5539119 Vali Loss: 0.2834706 Best vali loss: 0.2834706
	iters: 100, epoch: 2 | loss: 0.5202687
	speed: 0.0091s/iter; left time: 7.4596s
Updating learning rate to 0.00043048496320874504
Epoch: 2 cost time: 0.7393250465393066
Epoch: 2, Steps: 131 | Train Loss: 0.5202687 Vali Loss: 0.2926398 Best vali loss: 0.2834706
	iters: 100, epoch: 3 | loss: 0.4721556
	speed: 0.0088s/iter; left time: 6.0669s
Updating learning rate to 0.000348674396394412
Epoch: 3 cost time: 0.7294707298278809
Epoch: 3, Steps: 131 | Train Loss: 0.4721556 Vali Loss: 0.3096937 Best vali loss: 0.2834706
	iters: 100, epoch: 4 | loss: 0.3863588
	speed: 0.0090s/iter; left time: 4.9883s
Updating learning rate to 0.00025217225305
Epoch: 4 cost time: 0.7487921714782715
Epoch: 4, Steps: 131 | Train Loss: 0.3863588 Vali Loss: 0.3320114 Best vali loss: 0.2834706
	iters: 100, epoch: 5 | loss: 0.3126177
	speed: 0.0089s/iter; left time: 3.7793s
Updating learning rate to 0.00015567010970558804
Epoch: 5 cost time: 0.7372646331787109
Epoch: 5, Steps: 131 | Train Loss: 0.3126177 Vali Loss: 0.3306958 Best vali loss: 0.2834706
	iters: 100, epoch: 6 | loss: 0.2696033
	speed: 0.0090s/iter; left time: 2.6315s
Updating learning rate to 7.385954289125498e-05
Epoch: 6 cost time: 0.7340147495269775
Epoch: 6, Steps: 131 | Train Loss: 0.2696033 Vali Loss: 0.3584335 Best vali loss: 0.2834706
	iters: 100, epoch: 7 | loss: 0.2619838
	speed: 0.0089s/iter; left time: 1.4450s
Updating learning rate to 1.9195469789848098e-05
Epoch: 7 cost time: 0.7413985729217529
Epoch: 7, Steps: 131 | Train Loss: 0.2619838 Vali Loss: 0.3651249 Best vali loss: 0.2834706
	iters: 100, epoch: 8 | loss: 0.2677929
	speed: 0.0091s/iter; left time: 0.2898s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7402729988098145
Epoch: 8, Steps: 131 | Train Loss: 0.2677929 Vali Loss: 0.3673547 Best vali loss: 0.2834706

best validation loss 0.2834705862359692

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0031564561353, 'e_layers': 3, 'learning_rate': 0.0004823651165, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5544897
	speed: 0.0106s/iter; left time: 10.0222s
Updating learning rate to 0.0004640061874158862
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 0.9561736583709717
Epoch: 1, Steps: 131 | Train Loss: 0.5544897 Vali Loss: 0.2837108 Best vali loss: 0.2837108
	iters: 100, epoch: 2 | loss: 0.5183867
	speed: 0.0089s/iter; left time: 7.2579s
Updating learning rate to 0.0004117243806924945
Epoch: 2 cost time: 0.7280113697052002
Epoch: 2, Steps: 131 | Train Loss: 0.5183867 Vali Loss: 0.2884891 Best vali loss: 0.2837108
	iters: 100, epoch: 3 | loss: 0.4958770
	speed: 0.0089s/iter; left time: 6.1345s
Updating learning rate to 0.0003334791274677032
Epoch: 3 cost time: 0.738518238067627
Epoch: 3, Steps: 131 | Train Loss: 0.4958770 Vali Loss: 0.3072528 Best vali loss: 0.2837108

best validation loss 0.2837107604367443

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025275330624, 'e_layers': 4, 'learning_rate': 0.0021864708311, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3701456
	speed: 0.0109s/iter; left time: 44.3856s
	iters: 200, epoch: 1 | loss: 0.2554889
	speed: 0.0050s/iter; left time: 19.9267s
	iters: 300, epoch: 1 | loss: 1.2474586
	speed: 0.0050s/iter; left time: 19.5464s
	iters: 400, epoch: 1 | loss: 0.8260399
	speed: 0.0050s/iter; left time: 19.0210s
	iters: 500, epoch: 1 | loss: 0.3629481
	speed: 0.0051s/iter; left time: 18.6284s
Updating learning rate to 0.002103253240193116
Validation loss decreased (inf --> 0.2898).  Saving model state dict ...
Epoch: 1 cost time: 2.88061785697937
Epoch: 1, Steps: 523 | Train Loss: 0.6124162 Vali Loss: 0.2897798 Best vali loss: 0.2897798
	iters: 100, epoch: 2 | loss: 0.7396635
	speed: 0.0103s/iter; left time: 36.5453s
	iters: 200, epoch: 2 | loss: 0.2467337
	speed: 0.0050s/iter; left time: 17.4178s
	iters: 300, epoch: 2 | loss: 1.1479070
	speed: 0.0051s/iter; left time: 17.1600s
	iters: 400, epoch: 2 | loss: 0.2600543
	speed: 0.0051s/iter; left time: 16.7695s
	iters: 500, epoch: 2 | loss: 0.4396497
	speed: 0.0051s/iter; left time: 16.2739s
Updating learning rate to 0.001866269591318698
Validation loss decreased (0.2898 --> 0.2861).  Saving model state dict ...
Epoch: 2 cost time: 2.7089791297912598
Epoch: 2, Steps: 523 | Train Loss: 0.5668016 Vali Loss: 0.2861022 Best vali loss: 0.2861022
	iters: 100, epoch: 3 | loss: 0.4167704
	speed: 0.0101s/iter; left time: 30.7158s
	iters: 200, epoch: 3 | loss: 0.2361273
	speed: 0.0052s/iter; left time: 15.1362s
	iters: 300, epoch: 3 | loss: 0.4818270
	speed: 0.0051s/iter; left time: 14.5949s
	iters: 400, epoch: 3 | loss: 0.6530879
	speed: 0.0051s/iter; left time: 14.0222s
	iters: 500, epoch: 3 | loss: 1.4057866
	speed: 0.0047s/iter; left time: 12.2842s
Updating learning rate to 0.0015115984967557492
Epoch: 3 cost time: 2.6537132263183594
Epoch: 3, Steps: 523 | Train Loss: 0.6387198 Vali Loss: 0.2963757 Best vali loss: 0.2861022

best validation loss 0.2861021973577828

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021739264972, 'e_layers': 3, 'learning_rate': 0.0004738602997, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7120039
	speed: 0.0105s/iter; left time: 9.9634s
Updating learning rate to 0.0004558250659312471
Validation loss decreased (inf --> 0.2788).  Saving model state dict ...
Epoch: 1 cost time: 0.9167420864105225
Epoch: 1, Steps: 131 | Train Loss: 0.7120039 Vali Loss: 0.2787942 Best vali loss: 0.2787942
	iters: 100, epoch: 2 | loss: 0.4187089
	speed: 0.0084s/iter; left time: 6.8592s
Updating learning rate to 0.0004044650654764798
Epoch: 2 cost time: 0.6833925247192383
Epoch: 2, Steps: 131 | Train Loss: 0.4187089 Vali Loss: 0.2849764 Best vali loss: 0.2787942
	iters: 100, epoch: 3 | loss: 0.4438806
	speed: 0.0084s/iter; left time: 5.7401s
Updating learning rate to 0.00032759939282537307
Epoch: 3 cost time: 0.7028288841247559
Epoch: 3, Steps: 131 | Train Loss: 0.4438806 Vali Loss: 0.2848147 Best vali loss: 0.2787942

best validation loss 0.278794201921468

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021739264972, 'e_layers': 3, 'learning_rate': 0.0004738602997, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5604911
	speed: 0.0109s/iter; left time: 6.0389s
Updating learning rate to 0.00023693014985
Epoch: 4 cost time: 0.9399216175079346
Epoch: 4, Steps: 131 | Train Loss: 0.5604911 Vali Loss: 0.2867178 Best vali loss: 0.2787942
	iters: 100, epoch: 5 | loss: 0.3620808
	speed: 0.0085s/iter; left time: 3.6150s
Updating learning rate to 0.00014626090687462696
Epoch: 5 cost time: 0.6975405216217041
Epoch: 5, Steps: 131 | Train Loss: 0.3620808 Vali Loss: 0.2888609 Best vali loss: 0.2787942
	iters: 100, epoch: 6 | loss: 0.3570354
	speed: 0.0086s/iter; left time: 2.5203s
Updating learning rate to 6.939523422352015e-05
Epoch: 6 cost time: 0.6939647197723389
Epoch: 6, Steps: 131 | Train Loss: 0.3570354 Vali Loss: 0.2795621 Best vali loss: 0.2787942
	iters: 100, epoch: 7 | loss: 0.4372854
	speed: 0.0086s/iter; left time: 1.3978s
Updating learning rate to 1.8035233768752886e-05
Epoch: 7 cost time: 0.696660041809082
Epoch: 7, Steps: 131 | Train Loss: 0.4372854 Vali Loss: 0.2963726 Best vali loss: 0.2787942
	iters: 100, epoch: 8 | loss: 0.3373507
	speed: 0.0080s/iter; left time: 0.2558s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6390419006347656
Epoch: 8, Steps: 131 | Train Loss: 0.3373507 Vali Loss: 0.2954920 Best vali loss: 0.2787942

best validation loss 0.278794201921468

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0008374671459, 'e_layers': 1, 'learning_rate': 0.0007392593651, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7788109
	speed: 0.0076s/iter; left time: 30.9027s
	iters: 200, epoch: 1 | loss: 0.3287145
	speed: 0.0023s/iter; left time: 9.2166s
	iters: 300, epoch: 1 | loss: 0.5181205
	speed: 0.0023s/iter; left time: 8.9543s
	iters: 400, epoch: 1 | loss: 0.9190601
	speed: 0.0022s/iter; left time: 8.2379s
	iters: 500, epoch: 1 | loss: 0.2048109
	speed: 0.0022s/iter; left time: 8.1012s
Updating learning rate to 0.0007111229808665892
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 1.4341115951538086
Epoch: 1, Steps: 523 | Train Loss: 0.5499034 Vali Loss: 0.2822478 Best vali loss: 0.2822478
	iters: 100, epoch: 2 | loss: 0.7615060
	speed: 0.0056s/iter; left time: 19.7808s
	iters: 200, epoch: 2 | loss: 0.9572761
	speed: 0.0022s/iter; left time: 7.6507s
	iters: 300, epoch: 2 | loss: 0.8225791
	speed: 0.0022s/iter; left time: 7.4541s
	iters: 400, epoch: 2 | loss: 0.9380352
	speed: 0.0021s/iter; left time: 6.9809s
	iters: 500, epoch: 2 | loss: 0.5790663
	speed: 0.0021s/iter; left time: 6.5803s
Updating learning rate to 0.0006309973376089358
Epoch: 2 cost time: 1.1665911674499512
Epoch: 2, Steps: 523 | Train Loss: 0.8116926 Vali Loss: 0.2852460 Best vali loss: 0.2822478
	iters: 100, epoch: 3 | loss: 0.2495804
	speed: 0.0058s/iter; left time: 17.7603s
	iters: 200, epoch: 3 | loss: 0.4867384
	speed: 0.0025s/iter; left time: 7.3063s
	iters: 300, epoch: 3 | loss: 0.6360374
	speed: 0.0025s/iter; left time: 7.1081s
	iters: 400, epoch: 3 | loss: 0.3949006
	speed: 0.0025s/iter; left time: 6.7450s
	iters: 500, epoch: 3 | loss: 0.3508132
	speed: 0.0025s/iter; left time: 6.5705s
Updating learning rate to 0.0005110808381722525
Validation loss decreased (0.2822 --> 0.2812).  Saving model state dict ...
Epoch: 3 cost time: 1.3393893241882324
Epoch: 3, Steps: 523 | Train Loss: 0.4236140 Vali Loss: 0.2812246 Best vali loss: 0.2812246
	iters: 100, epoch: 4 | loss: 0.2170682
	speed: 0.0058s/iter; left time: 14.6550s
	iters: 200, epoch: 4 | loss: 0.2302835
	speed: 0.0022s/iter; left time: 5.3425s
	iters: 300, epoch: 4 | loss: 0.2813104
	speed: 0.0023s/iter; left time: 5.2695s
	iters: 400, epoch: 4 | loss: 0.2395456
	speed: 0.0023s/iter; left time: 5.1621s
	iters: 500, epoch: 4 | loss: 0.3653747
	speed: 0.0024s/iter; left time: 5.0467s
Updating learning rate to 0.00036962968255
Epoch: 4 cost time: 1.2409725189208984
Epoch: 4, Steps: 523 | Train Loss: 0.2667165 Vali Loss: 0.3009814 Best vali loss: 0.2812246
	iters: 100, epoch: 5 | loss: 0.3066762
	speed: 0.0054s/iter; left time: 10.7743s
	iters: 200, epoch: 5 | loss: 0.1603078
	speed: 0.0022s/iter; left time: 4.1263s
	iters: 300, epoch: 5 | loss: 0.3495236
	speed: 0.0022s/iter; left time: 3.8565s
	iters: 400, epoch: 5 | loss: 0.1621076
	speed: 0.0021s/iter; left time: 3.5785s
	iters: 500, epoch: 5 | loss: 0.3441868
	speed: 0.0022s/iter; left time: 3.4524s
Updating learning rate to 0.00022817852692774747
Epoch: 5 cost time: 1.1639955043792725
Epoch: 5, Steps: 523 | Train Loss: 0.2645604 Vali Loss: 0.3025141 Best vali loss: 0.2812246
	iters: 100, epoch: 6 | loss: 0.4472401
	speed: 0.0057s/iter; left time: 8.4508s
	iters: 200, epoch: 6 | loss: 0.2720197
	speed: 0.0025s/iter; left time: 3.4487s
	iters: 300, epoch: 6 | loss: 0.3222424
	speed: 0.0025s/iter; left time: 3.2027s
	iters: 400, epoch: 6 | loss: 0.2142385
	speed: 0.0025s/iter; left time: 2.9374s
	iters: 500, epoch: 6 | loss: 0.2072553
	speed: 0.0025s/iter; left time: 2.7054s
Updating learning rate to 0.00010826202749106414
Epoch: 6 cost time: 1.3534386157989502
Epoch: 6, Steps: 523 | Train Loss: 0.2925992 Vali Loss: 0.3185147 Best vali loss: 0.2812246
	iters: 100, epoch: 7 | loss: 0.3945531
	speed: 0.0059s/iter; left time: 5.5975s
	iters: 200, epoch: 7 | loss: 0.3845477
	speed: 0.0026s/iter; left time: 2.1834s
	iters: 300, epoch: 7 | loss: 0.2497479
	speed: 0.0025s/iter; left time: 1.8771s
	iters: 400, epoch: 7 | loss: 0.3684340
	speed: 0.0025s/iter; left time: 1.6300s
	iters: 500, epoch: 7 | loss: 0.1599776
	speed: 0.0026s/iter; left time: 1.4126s
Updating learning rate to 2.8136384233410676e-05
Epoch: 7 cost time: 1.3743207454681396
Epoch: 7, Steps: 523 | Train Loss: 0.3114521 Vali Loss: 0.3275298 Best vali loss: 0.2812246
	iters: 100, epoch: 8 | loss: 0.2212942
	speed: 0.0056s/iter; left time: 2.3694s
	iters: 200, epoch: 8 | loss: 0.3889829
	speed: 0.0021s/iter; left time: 0.6821s
	iters: 300, epoch: 8 | loss: 0.1555787
	speed: 0.0021s/iter; left time: 0.4690s
	iters: 400, epoch: 8 | loss: 0.3173900
	speed: 0.0021s/iter; left time: 0.2589s
	iters: 500, epoch: 8 | loss: 0.2658168
	speed: 0.0021s/iter; left time: 0.0500s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1351580619812012
Epoch: 8, Steps: 523 | Train Loss: 0.2698125 Vali Loss: 0.3255562 Best vali loss: 0.2812246

best validation loss 0.2812245812567693

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029844576156, 'e_layers': 3, 'learning_rate': 0.0004724474894, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5196006
	speed: 0.0121s/iter; left time: 11.4898s
Updating learning rate to 0.0004544660275215015
Validation loss decreased (inf --> 0.2698).  Saving model state dict ...
Epoch: 1 cost time: 1.1296756267547607
Epoch: 1, Steps: 131 | Train Loss: 0.5196006 Vali Loss: 0.2698054 Best vali loss: 0.2698054
	iters: 100, epoch: 2 | loss: 0.5357416
	speed: 0.0113s/iter; left time: 9.2124s
Updating learning rate to 0.00040325915645464974
Epoch: 2 cost time: 0.9099447727203369
Epoch: 2, Steps: 131 | Train Loss: 0.5357416 Vali Loss: 0.2715079 Best vali loss: 0.2698054
	iters: 100, epoch: 3 | loss: 0.4986303
	speed: 0.0110s/iter; left time: 7.5354s
Updating learning rate to 0.00032662265812793067
Epoch: 3 cost time: 0.9098680019378662
Epoch: 3, Steps: 131 | Train Loss: 0.4986303 Vali Loss: 0.2817951 Best vali loss: 0.2698054
	iters: 100, epoch: 4 | loss: 0.3007941
	speed: 0.0110s/iter; left time: 6.1161s
Updating learning rate to 0.0002362237447
Epoch: 4 cost time: 0.9111378192901611
Epoch: 4, Steps: 131 | Train Loss: 0.3007941 Vali Loss: 0.2841353 Best vali loss: 0.2698054
	iters: 100, epoch: 5 | loss: 0.2970713
	speed: 0.0111s/iter; left time: 4.7010s
Updating learning rate to 0.00014582483127206932
Epoch: 5 cost time: 0.915447473526001
Epoch: 5, Steps: 131 | Train Loss: 0.2970713 Vali Loss: 0.2858123 Best vali loss: 0.2698054
	iters: 100, epoch: 6 | loss: 0.3166181
	speed: 0.0110s/iter; left time: 3.2269s
Updating learning rate to 6.918833294535025e-05
Epoch: 6 cost time: 0.9199354648590088
Epoch: 6, Steps: 131 | Train Loss: 0.3166181 Vali Loss: 0.2968128 Best vali loss: 0.2698054
	iters: 100, epoch: 7 | loss: 0.3392144
	speed: 0.0111s/iter; left time: 1.8149s
Updating learning rate to 1.798146187849845e-05
Epoch: 7 cost time: 0.9120604991912842
Epoch: 7, Steps: 131 | Train Loss: 0.3392144 Vali Loss: 0.3000715 Best vali loss: 0.2698054
	iters: 100, epoch: 8 | loss: 0.3018661
	speed: 0.0110s/iter; left time: 0.3517s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9141016006469727
Epoch: 8, Steps: 131 | Train Loss: 0.3018661 Vali Loss: 0.3062688 Best vali loss: 0.2698054

best validation loss 0.2698054031485206

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032340421204, 'e_layers': 4, 'learning_rate': 0.0004652783053, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3343649
	speed: 0.0142s/iter; left time: 13.4568s
Updating learning rate to 0.0004475697042441038
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 1.410823106765747
Epoch: 1, Steps: 131 | Train Loss: 0.3343649 Vali Loss: 0.2895231 Best vali loss: 0.2895231
	iters: 100, epoch: 2 | loss: 0.4861352
	speed: 0.0144s/iter; left time: 11.7947s
Updating learning rate to 0.00039713987505830736
Validation loss decreased (0.2895 --> 0.2884).  Saving model state dict ...
Epoch: 2 cost time: 1.1864118576049805
Epoch: 2, Steps: 131 | Train Loss: 0.4861352 Vali Loss: 0.2883828 Best vali loss: 0.2883828
	iters: 100, epoch: 3 | loss: 0.4394073
	speed: 0.0145s/iter; left time: 9.9931s
Updating learning rate to 0.00032166630208860805
Validation loss decreased (0.2884 --> 0.2878).  Saving model state dict ...
Epoch: 3 cost time: 1.180938482284546
Epoch: 3, Steps: 131 | Train Loss: 0.4394073 Vali Loss: 0.2878496 Best vali loss: 0.2878496

best validation loss 0.2878496133514211

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0073089354368, 'e_layers': 3, 'learning_rate': 0.0002683864051, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5809609
	speed: 0.0098s/iter; left time: 39.9258s
	iters: 200, epoch: 1 | loss: 0.4681883
	speed: 0.0044s/iter; left time: 17.6824s
	iters: 300, epoch: 1 | loss: 0.3269838
	speed: 0.0045s/iter; left time: 17.5196s
	iters: 400, epoch: 1 | loss: 0.1767919
	speed: 0.0045s/iter; left time: 16.9006s
	iters: 500, epoch: 1 | loss: 0.7045969
	speed: 0.0045s/iter; left time: 16.4361s
Updating learning rate to 0.0002581715557880864
Validation loss decreased (inf --> 0.2968).  Saving model state dict ...
Epoch: 1 cost time: 2.5923707485198975
Epoch: 1, Steps: 523 | Train Loss: 0.4515044 Vali Loss: 0.2968486 Best vali loss: 0.2968486
	iters: 100, epoch: 2 | loss: 0.6193408
	speed: 0.0097s/iter; left time: 34.3925s
	iters: 200, epoch: 2 | loss: 0.4051353
	speed: 0.0045s/iter; left time: 15.5816s
	iters: 300, epoch: 2 | loss: 0.7250494
	speed: 0.0045s/iter; left time: 15.0378s
	iters: 400, epoch: 2 | loss: 0.2592958
	speed: 0.0043s/iter; left time: 14.0927s
	iters: 500, epoch: 2 | loss: 0.6416984
	speed: 0.0043s/iter; left time: 13.6114s
Updating learning rate to 0.0002290821260622449
Validation loss decreased (0.2968 --> 0.2867).  Saving model state dict ...
Epoch: 2 cost time: 2.3391942977905273
Epoch: 2, Steps: 523 | Train Loss: 0.5301040 Vali Loss: 0.2867080 Best vali loss: 0.2867080
	iters: 100, epoch: 3 | loss: 0.3177767
	speed: 0.0099s/iter; left time: 30.0670s
	iters: 200, epoch: 3 | loss: 0.6656380
	speed: 0.0046s/iter; left time: 13.5642s
	iters: 300, epoch: 3 | loss: 0.2269032
	speed: 0.0046s/iter; left time: 13.1267s
	iters: 400, epoch: 3 | loss: 0.7074500
	speed: 0.0046s/iter; left time: 12.6493s
	iters: 500, epoch: 3 | loss: 0.3312462
	speed: 0.0046s/iter; left time: 12.0939s
Updating learning rate to 0.00018554671790189773
Epoch: 3 cost time: 2.4403860569000244
Epoch: 3, Steps: 523 | Train Loss: 0.4498028 Vali Loss: 0.2960649 Best vali loss: 0.2867080

best validation loss 0.28670795890823003

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0072699732682, 'e_layers': 3, 'learning_rate': 0.0002730139466, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5804541
	speed: 0.0098s/iter; left time: 40.1617s
	iters: 200, epoch: 1 | loss: 0.4685308
	speed: 0.0043s/iter; left time: 16.9469s
	iters: 300, epoch: 1 | loss: 0.3291827
	speed: 0.0043s/iter; left time: 16.5594s
	iters: 400, epoch: 1 | loss: 0.1774235
	speed: 0.0043s/iter; left time: 16.1445s
	iters: 500, epoch: 1 | loss: 0.6477867
	speed: 0.0043s/iter; left time: 15.6774s
Updating learning rate to 0.0002626229719769347
Validation loss decreased (inf --> 0.3021).  Saving model state dict ...
Epoch: 1 cost time: 2.499535322189331
Epoch: 1, Steps: 523 | Train Loss: 0.4406756 Vali Loss: 0.3021134 Best vali loss: 0.3021134
	iters: 100, epoch: 2 | loss: 0.6039532
	speed: 0.0094s/iter; left time: 33.5041s
	iters: 200, epoch: 2 | loss: 0.4136179
	speed: 0.0041s/iter; left time: 14.2874s
	iters: 300, epoch: 2 | loss: 0.7304835
	speed: 0.0042s/iter; left time: 13.9718s
	iters: 400, epoch: 2 | loss: 0.2562918
	speed: 0.0041s/iter; left time: 13.4212s
	iters: 500, epoch: 2 | loss: 0.6370836
	speed: 0.0041s/iter; left time: 13.0363s
Updating learning rate to 0.00023303197979968098
Validation loss decreased (0.3021 --> 0.2941).  Saving model state dict ...
Epoch: 2 cost time: 2.1969640254974365
Epoch: 2, Steps: 523 | Train Loss: 0.5282860 Vali Loss: 0.2941464 Best vali loss: 0.2941464
	iters: 100, epoch: 3 | loss: 0.3189359
	speed: 0.0096s/iter; left time: 29.2289s
	iters: 200, epoch: 3 | loss: 0.6538486
	speed: 0.0042s/iter; left time: 12.4352s
	iters: 300, epoch: 3 | loss: 0.2594709
	speed: 0.0042s/iter; left time: 12.0336s
	iters: 400, epoch: 3 | loss: 0.7001589
	speed: 0.0041s/iter; left time: 11.3510s
	iters: 500, epoch: 3 | loss: 0.3297629
	speed: 0.0041s/iter; left time: 10.8949s
Updating learning rate to 0.00018874593038421366
Epoch: 3 cost time: 2.2315385341644287
Epoch: 3, Steps: 523 | Train Loss: 0.4524355 Vali Loss: 0.2960345 Best vali loss: 0.2941464

best validation loss 0.29414638295054835

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0073089354368, 'e_layers': 3, 'learning_rate': 0.0002683864051, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5211570
	speed: 0.0103s/iter; left time: 25.9916s
	iters: 200, epoch: 4 | loss: 0.4564743
	speed: 0.0045s/iter; left time: 10.8764s
	iters: 300, epoch: 4 | loss: 0.2828607
	speed: 0.0045s/iter; left time: 10.4479s
	iters: 400, epoch: 4 | loss: 0.1655452
	speed: 0.0045s/iter; left time: 10.0323s
	iters: 500, epoch: 4 | loss: 0.5430514
	speed: 0.0045s/iter; left time: 9.4777s
Updating learning rate to 0.00013419320255
Epoch: 4 cost time: 2.625926971435547
Epoch: 4, Steps: 523 | Train Loss: 0.3938177 Vali Loss: 0.2915021 Best vali loss: 0.2867080
	iters: 100, epoch: 5 | loss: 0.5711753
	speed: 0.0094s/iter; left time: 18.7379s
	iters: 200, epoch: 5 | loss: 0.3625955
	speed: 0.0043s/iter; left time: 8.0985s
	iters: 300, epoch: 5 | loss: 0.5106308
	speed: 0.0043s/iter; left time: 7.7058s
	iters: 400, epoch: 5 | loss: 0.2111122
	speed: 0.0043s/iter; left time: 7.2467s
	iters: 500, epoch: 5 | loss: 0.5893531
	speed: 0.0043s/iter; left time: 6.8260s
Updating learning rate to 8.28396871981023e-05
Epoch: 5 cost time: 2.288363456726074
Epoch: 5, Steps: 523 | Train Loss: 0.4489734 Vali Loss: 0.2888745 Best vali loss: 0.2867080
	iters: 100, epoch: 6 | loss: 0.2880360
	speed: 0.0091s/iter; left time: 13.4441s
	iters: 200, epoch: 6 | loss: 0.4324508
	speed: 0.0041s/iter; left time: 5.6722s
	iters: 300, epoch: 6 | loss: 0.2247353
	speed: 0.0041s/iter; left time: 5.2380s
	iters: 400, epoch: 6 | loss: 0.3706075
	speed: 0.0041s/iter; left time: 4.8266s
	iters: 500, epoch: 6 | loss: 0.2814247
	speed: 0.0042s/iter; left time: 4.4456s
Updating learning rate to 3.930427903775511e-05
Epoch: 6 cost time: 2.2220816612243652
Epoch: 6, Steps: 523 | Train Loss: 0.3194509 Vali Loss: 0.2882321 Best vali loss: 0.2867080
	iters: 100, epoch: 7 | loss: 0.4568855
	speed: 0.0093s/iter; left time: 8.8257s
	iters: 200, epoch: 7 | loss: 0.3918563
	speed: 0.0042s/iter; left time: 3.5908s
	iters: 300, epoch: 7 | loss: 0.1919026
	speed: 0.0041s/iter; left time: 3.0862s
	iters: 400, epoch: 7 | loss: 0.3733450
	speed: 0.0041s/iter; left time: 2.6682s
	iters: 500, epoch: 7 | loss: 0.2603833
	speed: 0.0041s/iter; left time: 2.2587s
Updating learning rate to 1.021484931191359e-05
Epoch: 7 cost time: 2.2167320251464844
Epoch: 7, Steps: 523 | Train Loss: 0.3348745 Vali Loss: 0.2891677 Best vali loss: 0.2867080
	iters: 100, epoch: 8 | loss: 0.5570912
	speed: 0.0090s/iter; left time: 3.8297s
	iters: 200, epoch: 8 | loss: 0.3083259
	speed: 0.0041s/iter; left time: 1.3396s
	iters: 300, epoch: 8 | loss: 0.2009465
	speed: 0.0042s/iter; left time: 0.9414s
	iters: 400, epoch: 8 | loss: 0.4839481
	speed: 0.0041s/iter; left time: 0.5110s
	iters: 500, epoch: 8 | loss: 0.2382484
	speed: 0.0042s/iter; left time: 0.0999s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2208516597747803
Epoch: 8, Steps: 523 | Train Loss: 0.3577120 Vali Loss: 0.2916012 Best vali loss: 0.2867080

best validation loss 0.28670795890823003

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.0002339822291, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5596759
	speed: 0.0104s/iter; left time: 9.8909s
Updating learning rate to 0.00022507681076842838
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9307050704956055
Epoch: 1, Steps: 131 | Train Loss: 0.5596759 Vali Loss: 0.2756589 Best vali loss: 0.2756589
	iters: 100, epoch: 2 | loss: 0.3253370
	speed: 0.0089s/iter; left time: 7.2708s
Updating learning rate to 0.00019971632498687715
Validation loss decreased (0.2757 --> 0.2702).  Saving model state dict ...
Epoch: 2 cost time: 0.701462984085083
Epoch: 2, Steps: 131 | Train Loss: 0.3253370 Vali Loss: 0.2702117 Best vali loss: 0.2702117
	iters: 100, epoch: 3 | loss: 0.4614811
	speed: 0.0091s/iter; left time: 6.2388s
Updating learning rate to 0.0001617616758222114
Epoch: 3 cost time: 0.7070317268371582
Epoch: 3, Steps: 131 | Train Loss: 0.4614811 Vali Loss: 0.2835918 Best vali loss: 0.2702117
	iters: 100, epoch: 4 | loss: 0.4720855
	speed: 0.0087s/iter; left time: 4.8176s
Updating learning rate to 0.00011699111455
Epoch: 4 cost time: 0.6997721195220947
Epoch: 4, Steps: 131 | Train Loss: 0.4720855 Vali Loss: 0.2817019 Best vali loss: 0.2702117
	iters: 100, epoch: 5 | loss: 0.3323341
	speed: 0.0089s/iter; left time: 3.7700s
Updating learning rate to 7.222055327778861e-05
Epoch: 5 cost time: 0.7125320434570312
Epoch: 5, Steps: 131 | Train Loss: 0.3323341 Vali Loss: 0.2892706 Best vali loss: 0.2702117
	iters: 100, epoch: 6 | loss: 0.3073782
	speed: 0.0087s/iter; left time: 2.5588s
Updating learning rate to 3.426590411312284e-05
Epoch: 6 cost time: 0.7052688598632812
Epoch: 6, Steps: 131 | Train Loss: 0.3073782 Vali Loss: 0.2992759 Best vali loss: 0.2702117
	iters: 100, epoch: 7 | loss: 0.2877231
	speed: 0.0087s/iter; left time: 1.4186s
Updating learning rate to 8.905418331571603e-06
Epoch: 7 cost time: 0.7047414779663086
Epoch: 7, Steps: 131 | Train Loss: 0.2877231 Vali Loss: 0.2976008 Best vali loss: 0.2702117
	iters: 100, epoch: 8 | loss: 0.3421530
	speed: 0.0087s/iter; left time: 0.2787s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7058060169219971
Epoch: 8, Steps: 131 | Train Loss: 0.3421530 Vali Loss: 0.2996948 Best vali loss: 0.2702117

best validation loss 0.27021165785624573

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002419055106, 'e_layers': 3, 'learning_rate': 0.0004748205933, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004567488105323679
Validation loss decreased (inf --> 0.2780).  Saving model state dict ...
Epoch: 1 cost time: 0.9563090801239014
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2780293 Best vali loss: 0.2780293
Updating learning rate to 0.00040528472733472484
Epoch: 2 cost time: 0.7403271198272705
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2780340 Best vali loss: 0.2780293
Updating learning rate to 0.0003282632838508362
Epoch: 3 cost time: 0.7346844673156738
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2844355 Best vali loss: 0.2780293
Updating learning rate to 0.00023741029665
Epoch: 4 cost time: 0.7369327545166016
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2851084 Best vali loss: 0.2780293
Updating learning rate to 0.00014655730944916384
Epoch: 5 cost time: 0.7339205741882324
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2909573 Best vali loss: 0.2780293
Updating learning rate to 6.953586596527513e-05
Epoch: 6 cost time: 0.7348670959472656
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2876548 Best vali loss: 0.2780293
Updating learning rate to 1.8071782767632095e-05
Epoch: 7 cost time: 0.7520081996917725
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2878850 Best vali loss: 0.2780293
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7375671863555908
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2926906 Best vali loss: 0.2780293

best validation loss 0.2780293006021855

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010424857949, 'e_layers': 3, 'learning_rate': 0.0001003599105, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9087008
	speed: 0.0131s/iter; left time: 12.3967s
Updating learning rate to 9.654018884780729e-05
Validation loss decreased (inf --> 0.2769).  Saving model state dict ...
Epoch: 1 cost time: 1.2738356590270996
Epoch: 1, Steps: 131 | Train Loss: 0.9087008 Vali Loss: 0.2769278 Best vali loss: 0.2769278
	iters: 100, epoch: 2 | loss: 0.4627998
	speed: 0.0130s/iter; left time: 10.6113s
Updating learning rate to 8.566254188691249e-05
Epoch: 2 cost time: 1.0573475360870361
Epoch: 2, Steps: 131 | Train Loss: 0.4627998 Vali Loss: 0.2799083 Best vali loss: 0.2769278
	iters: 100, epoch: 3 | loss: 0.4679086
	speed: 0.0126s/iter; left time: 8.6493s
Updating learning rate to 6.938299276099661e-05
Epoch: 3 cost time: 1.0561888217926025
Epoch: 3, Steps: 131 | Train Loss: 0.4679086 Vali Loss: 0.3017433 Best vali loss: 0.2769278

best validation loss 0.27692776781535583

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0031752061489, 'e_layers': 3, 'learning_rate': 0.0015099973405, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2844289
	speed: 0.0094s/iter; left time: 77.4001s
	iters: 200, epoch: 1 | loss: 0.3355146
	speed: 0.0039s/iter; left time: 31.9354s
	iters: 300, epoch: 1 | loss: 0.1799750
	speed: 0.0039s/iter; left time: 31.6906s
	iters: 400, epoch: 1 | loss: 0.4042405
	speed: 0.0039s/iter; left time: 31.2815s
	iters: 500, epoch: 1 | loss: 0.5933737
	speed: 0.0039s/iter; left time: 30.5862s
	iters: 600, epoch: 1 | loss: 0.3092082
	speed: 0.0039s/iter; left time: 30.1127s
	iters: 700, epoch: 1 | loss: 1.0863333
	speed: 0.0039s/iter; left time: 30.1101s
	iters: 800, epoch: 1 | loss: 0.5069104
	speed: 0.0039s/iter; left time: 29.6788s
	iters: 900, epoch: 1 | loss: 0.4083498
	speed: 0.0039s/iter; left time: 29.0596s
	iters: 1000, epoch: 1 | loss: 0.3410209
	speed: 0.0039s/iter; left time: 28.6597s
Updating learning rate to 0.0015099973405
Validation loss decreased (inf --> 0.2900).  Saving model state dict ...
Epoch: 1 cost time: 4.3449389934539795
Epoch: 1, Steps: 1045 | Train Loss: 0.4449355 Vali Loss: 0.2899669 Best vali loss: 0.2899669
	iters: 100, epoch: 2 | loss: 0.2237652
	speed: 0.0116s/iter; left time: 83.7848s
	iters: 200, epoch: 2 | loss: 0.3525019
	speed: 0.0042s/iter; left time: 29.6696s
	iters: 300, epoch: 2 | loss: 1.2189569
	speed: 0.0042s/iter; left time: 29.1800s
	iters: 400, epoch: 2 | loss: 0.3081105
	speed: 0.0041s/iter; left time: 28.5833s
	iters: 500, epoch: 2 | loss: 0.2618959
	speed: 0.0042s/iter; left time: 28.4713s
	iters: 600, epoch: 2 | loss: 0.3533232
	speed: 0.0041s/iter; left time: 27.3039s
	iters: 700, epoch: 2 | loss: 0.7548252
	speed: 0.0041s/iter; left time: 27.2294s
	iters: 800, epoch: 2 | loss: 0.6209499
	speed: 0.0040s/iter; left time: 26.3328s
	iters: 900, epoch: 2 | loss: 0.3203022
	speed: 0.0041s/iter; left time: 26.2629s
	iters: 1000, epoch: 2 | loss: 0.4559141
	speed: 0.0042s/iter; left time: 26.2849s
Updating learning rate to 0.00075499867025
Validation loss decreased (0.2900 --> 0.2885).  Saving model state dict ...
Epoch: 2 cost time: 4.3377954959869385
Epoch: 2, Steps: 1045 | Train Loss: 0.4870545 Vali Loss: 0.2885345 Best vali loss: 0.2885345
	iters: 100, epoch: 3 | loss: 0.2066609
	speed: 0.0119s/iter; left time: 73.4071s
	iters: 200, epoch: 3 | loss: 0.2967411
	speed: 0.0041s/iter; left time: 24.7886s
	iters: 300, epoch: 3 | loss: 0.1674541
	speed: 0.0041s/iter; left time: 24.1871s
	iters: 400, epoch: 3 | loss: 0.2463440
	speed: 0.0041s/iter; left time: 24.0845s
	iters: 500, epoch: 3 | loss: 0.3734674
	speed: 0.0041s/iter; left time: 23.8380s
	iters: 600, epoch: 3 | loss: 0.3460100
	speed: 0.0041s/iter; left time: 23.3495s
	iters: 700, epoch: 3 | loss: 0.7323415
	speed: 0.0039s/iter; left time: 21.6830s
	iters: 800, epoch: 3 | loss: 0.2070279
	speed: 0.0039s/iter; left time: 21.4421s
	iters: 900, epoch: 3 | loss: 0.3100240
	speed: 0.0039s/iter; left time: 21.1627s
	iters: 1000, epoch: 3 | loss: 0.4900467
	speed: 0.0039s/iter; left time: 20.8134s
Updating learning rate to 0.000377499335125
Epoch: 3 cost time: 4.2454023361206055
Epoch: 3, Steps: 1045 | Train Loss: 0.3376118 Vali Loss: 0.2910506 Best vali loss: 0.2885345

best validation loss 0.2885344599333116

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017595938687, 'e_layers': 4, 'learning_rate': 0.0010218639183, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3137732
	speed: 0.0105s/iter; left time: 42.9372s
	iters: 200, epoch: 1 | loss: 0.8545591
	speed: 0.0049s/iter; left time: 19.6788s
	iters: 300, epoch: 1 | loss: 0.7487941
	speed: 0.0050s/iter; left time: 19.2332s
	iters: 400, epoch: 1 | loss: 0.6383561
	speed: 0.0049s/iter; left time: 18.7352s
	iters: 500, epoch: 1 | loss: 0.9762051
	speed: 0.0050s/iter; left time: 18.3180s
Updating learning rate to 0.0010218639183
Validation loss decreased (inf --> 0.3272).  Saving model state dict ...
Epoch: 1 cost time: 2.8691086769104004
Epoch: 1, Steps: 523 | Train Loss: 0.7063375 Vali Loss: 0.3271879 Best vali loss: 0.3271879
	iters: 100, epoch: 2 | loss: 0.4475466
	speed: 0.0099s/iter; left time: 35.4142s
	iters: 200, epoch: 2 | loss: 0.4784999
	speed: 0.0048s/iter; left time: 16.5485s
	iters: 300, epoch: 2 | loss: 0.3689225
	speed: 0.0047s/iter; left time: 15.9690s
	iters: 400, epoch: 2 | loss: 0.3148872
	speed: 0.0048s/iter; left time: 15.5443s
	iters: 500, epoch: 2 | loss: 0.2599462
	speed: 0.0048s/iter; left time: 15.0853s
Updating learning rate to 0.00051093195915
Validation loss decreased (0.3272 --> 0.3240).  Saving model state dict ...
Epoch: 2 cost time: 2.5262627601623535
Epoch: 2, Steps: 523 | Train Loss: 0.3739605 Vali Loss: 0.3239879 Best vali loss: 0.3239879
	iters: 100, epoch: 3 | loss: 0.8410034
	speed: 0.0104s/iter; left time: 31.6188s
	iters: 200, epoch: 3 | loss: 1.0950176
	speed: 0.0052s/iter; left time: 15.4042s
	iters: 300, epoch: 3 | loss: 0.2753375
	speed: 0.0053s/iter; left time: 14.9327s
	iters: 400, epoch: 3 | loss: 0.8492579
	speed: 0.0053s/iter; left time: 14.4310s
	iters: 500, epoch: 3 | loss: 1.0013958
	speed: 0.0049s/iter; left time: 13.0381s
Updating learning rate to 0.000255465979575
Epoch: 3 cost time: 2.7524898052215576
Epoch: 3, Steps: 523 | Train Loss: 0.8124024 Vali Loss: 0.3250517 Best vali loss: 0.3239879

best validation loss 0.3239878875841745

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010424857949, 'e_layers': 3, 'learning_rate': 0.0001003599105, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7293521
	speed: 0.0134s/iter; left time: 7.4582s
Updating learning rate to 5.017995525e-05
Epoch: 4 cost time: 1.265695571899414
Epoch: 4, Steps: 131 | Train Loss: 0.7293521 Vali Loss: 0.2925759 Best vali loss: 0.2769278
	iters: 100, epoch: 5 | loss: 0.4379107
	speed: 0.0125s/iter; left time: 5.3157s
Updating learning rate to 3.097691773900339e-05
Epoch: 5 cost time: 1.042140245437622
Epoch: 5, Steps: 131 | Train Loss: 0.4379107 Vali Loss: 0.2861804 Best vali loss: 0.2769278
	iters: 100, epoch: 6 | loss: 0.3924158
	speed: 0.0124s/iter; left time: 3.6565s
Updating learning rate to 1.4697368613087506e-05
Epoch: 6 cost time: 1.0452523231506348
Epoch: 6, Steps: 131 | Train Loss: 0.3924158 Vali Loss: 0.2910521 Best vali loss: 0.2769278
	iters: 100, epoch: 7 | loss: 0.4415316
	speed: 0.0125s/iter; left time: 2.0306s
Updating learning rate to 3.819721652192711e-06
Epoch: 7 cost time: 1.0557730197906494
Epoch: 7, Steps: 131 | Train Loss: 0.4415316 Vali Loss: 0.2878252 Best vali loss: 0.2769278
	iters: 100, epoch: 8 | loss: 0.3578502
	speed: 0.0126s/iter; left time: 0.4031s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0510740280151367
Epoch: 8, Steps: 131 | Train Loss: 0.3578502 Vali Loss: 0.2889337 Best vali loss: 0.2769278

best validation loss 0.27692776781535583

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.00210769191, 'e_layers': 4, 'learning_rate': 0.0006822784772, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6328945
	speed: 0.0113s/iter; left time: 10.7195s
Updating learning rate to 0.0006822784772
Validation loss decreased (inf --> 0.2811).  Saving model state dict ...
Epoch: 1 cost time: 1.0268514156341553
Epoch: 1, Steps: 131 | Train Loss: 0.6328945 Vali Loss: 0.2810690 Best vali loss: 0.2810690
	iters: 100, epoch: 2 | loss: 0.5686178
	speed: 0.0095s/iter; left time: 7.7838s
Updating learning rate to 0.0003411392386
Epoch: 2 cost time: 0.7905459403991699
Epoch: 2, Steps: 131 | Train Loss: 0.5686178 Vali Loss: 0.2824624 Best vali loss: 0.2810690
	iters: 100, epoch: 3 | loss: 0.4981466
	speed: 0.0092s/iter; left time: 6.3471s
Updating learning rate to 0.0001705696193
Epoch: 3 cost time: 0.7874069213867188
Epoch: 3, Steps: 131 | Train Loss: 0.4981466 Vali Loss: 0.2820934 Best vali loss: 0.2810690
	iters: 100, epoch: 4 | loss: 0.5179386
	speed: 0.0095s/iter; left time: 5.3015s
Updating learning rate to 8.528480965e-05
Epoch: 4 cost time: 0.802236795425415
Epoch: 4, Steps: 131 | Train Loss: 0.5179386 Vali Loss: 0.2939967 Best vali loss: 0.2810690
	iters: 100, epoch: 5 | loss: 0.3417446
	speed: 0.0086s/iter; left time: 3.6402s
Updating learning rate to 4.2642404825e-05
Epoch: 5 cost time: 0.6728823184967041
Epoch: 5, Steps: 131 | Train Loss: 0.3417446 Vali Loss: 0.2925981 Best vali loss: 0.2810690
	iters: 100, epoch: 6 | loss: 0.3131958
	speed: 0.0084s/iter; left time: 2.4626s
Updating learning rate to 2.13212024125e-05
Epoch: 6 cost time: 0.700108528137207
Epoch: 6, Steps: 131 | Train Loss: 0.3131958 Vali Loss: 0.3007311 Best vali loss: 0.2810690
	iters: 100, epoch: 7 | loss: 0.3571978
	speed: 0.0083s/iter; left time: 1.3542s
Updating learning rate to 1.066060120625e-05
Epoch: 7 cost time: 0.6946015357971191
Epoch: 7, Steps: 131 | Train Loss: 0.3571978 Vali Loss: 0.2988511 Best vali loss: 0.2810690
	iters: 100, epoch: 8 | loss: 0.2727434
	speed: 0.0090s/iter; left time: 0.2873s
Updating learning rate to 5.330300603125e-06
Epoch: 8 cost time: 0.7769062519073486
Epoch: 8, Steps: 131 | Train Loss: 0.2727434 Vali Loss: 0.3003999 Best vali loss: 0.2810690

best validation loss 0.281068991012137

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0021080153345, 'e_layers': 4, 'learning_rate': 0.0005078074871, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005078074871
Validation loss decreased (inf --> 0.3036).  Saving model state dict ...
Epoch: 1 cost time: 0.6783804893493652
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3035542 Best vali loss: 0.3035542
Updating learning rate to 0.00025390374355
Validation loss decreased (0.3036 --> 0.2893).  Saving model state dict ...
Epoch: 2 cost time: 0.44908618927001953
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2893061 Best vali loss: 0.2893061
Updating learning rate to 0.000126951871775
Validation loss decreased (0.2893 --> 0.2864).  Saving model state dict ...
Epoch: 3 cost time: 0.42252373695373535
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2863525 Best vali loss: 0.2863525
Updating learning rate to 6.34759358875e-05
Validation loss decreased (0.2864 --> 0.2853).  Saving model state dict ...
Epoch: 4 cost time: 0.43839097023010254
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2853046 Best vali loss: 0.2853046
Updating learning rate to 3.173796794375e-05
Epoch: 5 cost time: 0.45553159713745117
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2854221 Best vali loss: 0.2853046
Updating learning rate to 1.5868983971875e-05
Epoch: 6 cost time: 0.4212195873260498
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2855341 Best vali loss: 0.2853046
Updating learning rate to 7.9344919859375e-06
Epoch: 7 cost time: 0.4463615417480469
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2856008 Best vali loss: 0.2853046
Updating learning rate to 3.96724599296875e-06
Epoch: 8 cost time: 0.4503819942474365
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2856563 Best vali loss: 0.2853046

best validation loss 0.28530455354910084

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0012527473709, 'e_layers': 4, 'learning_rate': 0.0004792449495, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5885117
	speed: 0.0109s/iter; left time: 10.3798s
Updating learning rate to 0.0004610047747012276
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 1.0763814449310303
Epoch: 1, Steps: 131 | Train Loss: 0.5885117 Vali Loss: 0.2860075 Best vali loss: 0.2860075
	iters: 100, epoch: 2 | loss: 0.4139863
	speed: 0.0100s/iter; left time: 8.1600s
Updating learning rate to 0.0004090611515704272
Epoch: 2 cost time: 0.8227317333221436
Epoch: 2, Steps: 131 | Train Loss: 0.4139863 Vali Loss: 0.2869846 Best vali loss: 0.2860075
	iters: 100, epoch: 3 | loss: 0.4575882
	speed: 0.0098s/iter; left time: 6.7346s
Updating learning rate to 0.00033132202585914707
Epoch: 3 cost time: 0.823735237121582
Epoch: 3, Steps: 131 | Train Loss: 0.4575882 Vali Loss: 0.2968962 Best vali loss: 0.2860075

best validation loss 0.28600751688685194

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0032500340299, 'e_layers': 3, 'learning_rate': 0.0003638238217, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4073513
	speed: 0.0088s/iter; left time: 35.9026s
	iters: 200, epoch: 1 | loss: 0.5139680
	speed: 0.0043s/iter; left time: 17.2639s
	iters: 300, epoch: 1 | loss: 0.3125478
	speed: 0.0044s/iter; left time: 17.0485s
	iters: 400, epoch: 1 | loss: 0.6296317
	speed: 0.0043s/iter; left time: 16.4533s
	iters: 500, epoch: 1 | loss: 0.2182499
	speed: 0.0043s/iter; left time: 15.8587s
Updating learning rate to 0.0003499766020043329
Validation loss decreased (inf --> 0.2818).  Saving model state dict ...
Epoch: 1 cost time: 2.521516799926758
Epoch: 1, Steps: 523 | Train Loss: 0.4163497 Vali Loss: 0.2817579 Best vali loss: 0.2817579
	iters: 100, epoch: 2 | loss: 0.5425816
	speed: 0.0088s/iter; left time: 31.3358s
	iters: 200, epoch: 2 | loss: 0.4556461
	speed: 0.0040s/iter; left time: 13.8867s
	iters: 300, epoch: 2 | loss: 0.6389512
	speed: 0.0040s/iter; left time: 13.4464s
	iters: 400, epoch: 2 | loss: 0.6375747
	speed: 0.0040s/iter; left time: 13.0806s
	iters: 500, epoch: 2 | loss: 0.7636304
	speed: 0.0040s/iter; left time: 12.6482s
Updating learning rate to 0.0003105430565906377
Epoch: 2 cost time: 2.1342554092407227
Epoch: 2, Steps: 523 | Train Loss: 0.6076768 Vali Loss: 0.3159204 Best vali loss: 0.2817579
	iters: 100, epoch: 3 | loss: 0.2744448
	speed: 0.0083s/iter; left time: 25.3740s
	iters: 200, epoch: 3 | loss: 0.6119804
	speed: 0.0040s/iter; left time: 11.7380s
	iters: 300, epoch: 3 | loss: 0.4347786
	speed: 0.0042s/iter; left time: 11.8404s
	iters: 400, epoch: 3 | loss: 0.3435123
	speed: 0.0042s/iter; left time: 11.4039s
	iters: 500, epoch: 3 | loss: 0.5560409
	speed: 0.0041s/iter; left time: 10.7727s
Updating learning rate to 0.00025152658528217024
Epoch: 3 cost time: 2.1731114387512207
Epoch: 3, Steps: 523 | Train Loss: 0.4441514 Vali Loss: 0.2941802 Best vali loss: 0.2817579

best validation loss 0.2817579091770049

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020898343305, 'e_layers': 3, 'learning_rate': 0.0001697199715, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4236559
	speed: 0.0095s/iter; left time: 9.0611s
Updating learning rate to 0.00016326038971362444
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 0.9026963710784912
Epoch: 1, Steps: 131 | Train Loss: 0.4236559 Vali Loss: 0.2835223 Best vali loss: 0.2835223
	iters: 100, epoch: 2 | loss: 0.6192144
	speed: 0.0081s/iter; left time: 6.6536s
Updating learning rate to 0.0001448650571252188
Validation loss decreased (0.2835 --> 0.2814).  Saving model state dict ...
Epoch: 2 cost time: 0.6675097942352295
Epoch: 2, Steps: 131 | Train Loss: 0.6192144 Vali Loss: 0.2814211 Best vali loss: 0.2814211
	iters: 100, epoch: 3 | loss: 0.4945495
	speed: 0.0076s/iter; left time: 5.1951s
Updating learning rate to 0.00011733449636726261
Epoch: 3 cost time: 0.5897808074951172
Epoch: 3, Steps: 131 | Train Loss: 0.4945495 Vali Loss: 0.2832636 Best vali loss: 0.2814211

best validation loss 0.2814211470569186

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020898343305, 'e_layers': 3, 'learning_rate': 0.0001697199715, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4203933
	speed: 0.0095s/iter; left time: 5.2929s
Updating learning rate to 8.485998575e-05
Epoch: 4 cost time: 0.8872246742248535
Epoch: 4, Steps: 131 | Train Loss: 0.4203933 Vali Loss: 0.2864590 Best vali loss: 0.2814211
	iters: 100, epoch: 5 | loss: 0.5118253
	speed: 0.0080s/iter; left time: 3.4109s
Updating learning rate to 5.2385475132737395e-05
Epoch: 5 cost time: 0.6613297462463379
Epoch: 5, Steps: 131 | Train Loss: 0.5118253 Vali Loss: 0.2915581 Best vali loss: 0.2814211
	iters: 100, epoch: 6 | loss: 0.4425675
	speed: 0.0079s/iter; left time: 2.3116s
Updating learning rate to 2.4854914374781213e-05
Epoch: 6 cost time: 0.6369125843048096
Epoch: 6, Steps: 131 | Train Loss: 0.4425675 Vali Loss: 0.3034491 Best vali loss: 0.2814211
	iters: 100, epoch: 7 | loss: 0.5192019
	speed: 0.0077s/iter; left time: 1.2525s
Updating learning rate to 6.459581786375545e-06
Epoch: 7 cost time: 0.6297485828399658
Epoch: 7, Steps: 131 | Train Loss: 0.5192019 Vali Loss: 0.3055645 Best vali loss: 0.2814211
	iters: 100, epoch: 8 | loss: 0.5030501
	speed: 0.0078s/iter; left time: 0.2481s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6324255466461182
Epoch: 8, Steps: 131 | Train Loss: 0.5030501 Vali Loss: 0.3044043 Best vali loss: 0.2814211

best validation loss 0.2814211470569186

[INFO][smbo.py:320] Finished 1450 trials.
{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0046725506202, 'e_layers': 2, 'learning_rate': 0.0002279170249, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002279170249
Validation loss decreased (inf --> 0.2808).  Saving model state dict ...
Epoch: 1 cost time: 0.7472002506256104
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2807605 Best vali loss: 0.2807605
Updating learning rate to 0.00011395851245
Validation loss decreased (0.2808 --> 0.2726).  Saving model state dict ...
Epoch: 2 cost time: 0.5205163955688477
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2725929 Best vali loss: 0.2725929
Updating learning rate to 5.6979256225e-05
Epoch: 3 cost time: 0.5217189788818359
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2804229 Best vali loss: 0.2725929
Updating learning rate to 2.84896281125e-05
Epoch: 4 cost time: 0.5217161178588867
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2768396 Best vali loss: 0.2725929
Updating learning rate to 1.424481405625e-05
Epoch: 5 cost time: 0.5207302570343018
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2877300 Best vali loss: 0.2725929
Updating learning rate to 7.122407028125e-06
Epoch: 6 cost time: 0.5191769599914551
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2851118 Best vali loss: 0.2725929
Updating learning rate to 3.5612035140625e-06
Epoch: 7 cost time: 0.5182552337646484
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2842057 Best vali loss: 0.2725929
Updating learning rate to 1.78060175703125e-06
Epoch: 8 cost time: 0.5212461948394775
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2878682 Best vali loss: 0.2725929

best validation loss 0.2725929400487742

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.002791703104, 'e_layers': 4, 'learning_rate': 0.0031017944766, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6531446
	speed: 0.0096s/iter; left time: 39.0793s
	iters: 200, epoch: 1 | loss: 0.4896491
	speed: 0.0050s/iter; left time: 19.9542s
	iters: 300, epoch: 1 | loss: 1.1308271
	speed: 0.0051s/iter; left time: 19.7243s
	iters: 400, epoch: 1 | loss: 0.4320181
	speed: 0.0051s/iter; left time: 19.2793s
	iters: 500, epoch: 1 | loss: 0.2076630
	speed: 0.0049s/iter; left time: 18.1512s
Updating learning rate to 0.00298373945379365
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 2.8660168647766113
Epoch: 1, Steps: 523 | Train Loss: 0.5826604 Vali Loss: 0.2874192 Best vali loss: 0.2874192
	iters: 100, epoch: 2 | loss: 0.6682282
	speed: 0.0100s/iter; left time: 35.5930s
	iters: 200, epoch: 2 | loss: 0.2308034
	speed: 0.0048s/iter; left time: 16.5787s
	iters: 300, epoch: 2 | loss: 0.3172092
	speed: 0.0048s/iter; left time: 16.2385s
	iters: 400, epoch: 2 | loss: 0.2812347
	speed: 0.0049s/iter; left time: 15.8401s
	iters: 500, epoch: 2 | loss: 0.4605798
	speed: 0.0049s/iter; left time: 15.4018s
Updating learning rate to 0.002647547192425419
Validation loss decreased (0.2874 --> 0.2866).  Saving model state dict ...
Epoch: 2 cost time: 2.591245412826538
Epoch: 2, Steps: 523 | Train Loss: 0.3916111 Vali Loss: 0.2866354 Best vali loss: 0.2866354
	iters: 100, epoch: 3 | loss: 0.7028361
	speed: 0.0094s/iter; left time: 28.4207s
	iters: 200, epoch: 3 | loss: 1.1585714
	speed: 0.0045s/iter; left time: 13.2579s
	iters: 300, epoch: 3 | loss: 0.3118132
	speed: 0.0048s/iter; left time: 13.4977s
	iters: 400, epoch: 3 | loss: 0.4787550
	speed: 0.0047s/iter; left time: 12.8203s
	iters: 500, epoch: 3 | loss: 0.4405134
	speed: 0.0047s/iter; left time: 12.3657s
Updating learning rate to 0.0021443999166981826
Epoch: 3 cost time: 2.452561140060425
Epoch: 3, Steps: 523 | Train Loss: 0.6184978 Vali Loss: 0.2924685 Best vali loss: 0.2866354
	iters: 100, epoch: 4 | loss: 0.7092283
	speed: 0.0098s/iter; left time: 24.7301s
	iters: 200, epoch: 4 | loss: 0.6192424
	speed: 0.0050s/iter; left time: 12.1531s
	iters: 300, epoch: 4 | loss: 0.4084201
	speed: 0.0051s/iter; left time: 11.7897s
	iters: 400, epoch: 4 | loss: 0.3265468
	speed: 0.0051s/iter; left time: 11.2579s
	iters: 500, epoch: 4 | loss: 0.2689402
	speed: 0.0051s/iter; left time: 10.8811s
Updating learning rate to 0.0015508972383
Epoch: 4 cost time: 2.696132183074951
Epoch: 4, Steps: 523 | Train Loss: 0.4664755 Vali Loss: 0.2953991 Best vali loss: 0.2866354
	iters: 100, epoch: 5 | loss: 0.2330784
	speed: 0.0100s/iter; left time: 19.9637s
	iters: 200, epoch: 5 | loss: 0.6244554
	speed: 0.0049s/iter; left time: 9.2812s
	iters: 300, epoch: 5 | loss: 0.5995395
	speed: 0.0049s/iter; left time: 8.7749s
	iters: 400, epoch: 5 | loss: 0.6574991
	speed: 0.0049s/iter; left time: 8.2655s
	iters: 500, epoch: 5 | loss: 0.4178988
	speed: 0.0049s/iter; left time: 7.8015s
Updating learning rate to 0.0009573945599018175
Epoch: 5 cost time: 2.61671781539917
Epoch: 5, Steps: 523 | Train Loss: 0.5064943 Vali Loss: 0.3115066 Best vali loss: 0.2866354
	iters: 100, epoch: 6 | loss: 0.5749447
	speed: 0.0099s/iter; left time: 14.4925s
	iters: 200, epoch: 6 | loss: 0.4745424
	speed: 0.0051s/iter; left time: 6.9437s
	iters: 300, epoch: 6 | loss: 0.2716754
	speed: 0.0051s/iter; left time: 6.4941s
	iters: 400, epoch: 6 | loss: 0.6540312
	speed: 0.0051s/iter; left time: 5.9600s
	iters: 500, epoch: 6 | loss: 0.3639429
	speed: 0.0051s/iter; left time: 5.4554s
Updating learning rate to 0.0004542472841745812
Epoch: 6 cost time: 2.687741756439209
Epoch: 6, Steps: 523 | Train Loss: 0.4678273 Vali Loss: 0.3087240 Best vali loss: 0.2866354
	iters: 100, epoch: 7 | loss: 0.2583935
	speed: 0.0093s/iter; left time: 8.8417s
	iters: 200, epoch: 7 | loss: 0.5746394
	speed: 0.0045s/iter; left time: 3.7967s
	iters: 300, epoch: 7 | loss: 0.4165530
	speed: 0.0045s/iter; left time: 3.3446s
	iters: 400, epoch: 7 | loss: 0.2830223
	speed: 0.0045s/iter; left time: 2.8959s
	iters: 500, epoch: 7 | loss: 0.3363328
	speed: 0.0045s/iter; left time: 2.4635s
Updating learning rate to 0.00011805502280635033
Epoch: 7 cost time: 2.3803634643554688
Epoch: 7, Steps: 523 | Train Loss: 0.3737882 Vali Loss: 0.3040639 Best vali loss: 0.2866354
	iters: 100, epoch: 8 | loss: 0.5585624
	speed: 0.0092s/iter; left time: 3.9048s
	iters: 200, epoch: 8 | loss: 0.2415346
	speed: 0.0044s/iter; left time: 1.4361s
	iters: 300, epoch: 8 | loss: 0.2828618
	speed: 0.0044s/iter; left time: 0.9932s
	iters: 400, epoch: 8 | loss: 0.4173925
	speed: 0.0044s/iter; left time: 0.5491s
	iters: 500, epoch: 8 | loss: 0.4019749
	speed: 0.0044s/iter; left time: 0.1061s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3643269538879395
Epoch: 8, Steps: 523 | Train Loss: 0.3804652 Vali Loss: 0.3104108 Best vali loss: 0.2866354

best validation loss 0.28663538137569267

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0029499395283, 'e_layers': 2, 'learning_rate': 0.0004718886555, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5020669
	speed: 0.0100s/iter; left time: 9.4569s
Updating learning rate to 0.0004718886555
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 0.9541778564453125
Epoch: 1, Steps: 131 | Train Loss: 0.5020669 Vali Loss: 0.2852725 Best vali loss: 0.2852725
	iters: 100, epoch: 2 | loss: 0.4663743
	speed: 0.0091s/iter; left time: 7.4458s
Updating learning rate to 0.00023594432775
Validation loss decreased (0.2853 --> 0.2822).  Saving model state dict ...
Epoch: 2 cost time: 0.7140042781829834
Epoch: 2, Steps: 131 | Train Loss: 0.4663743 Vali Loss: 0.2821594 Best vali loss: 0.2821594
	iters: 100, epoch: 3 | loss: 0.4546427
	speed: 0.0092s/iter; left time: 6.3221s
Updating learning rate to 0.000117972163875
Epoch: 3 cost time: 0.7167022228240967
Epoch: 3, Steps: 131 | Train Loss: 0.4546427 Vali Loss: 0.2931065 Best vali loss: 0.2821594

best validation loss 0.28215938699028226

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021042304833, 'e_layers': 3, 'learning_rate': 0.0004778352961, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5212377
	speed: 0.0121s/iter; left time: 11.5240s
Updating learning rate to 0.0004778352961
Validation loss decreased (inf --> 0.2746).  Saving model state dict ...
Epoch: 1 cost time: 1.1377296447753906
Epoch: 1, Steps: 131 | Train Loss: 0.5212377 Vali Loss: 0.2745913 Best vali loss: 0.2745913
	iters: 100, epoch: 2 | loss: 0.6079168
	speed: 0.0114s/iter; left time: 9.2990s
Updating learning rate to 0.00023891764805
Epoch: 2 cost time: 0.917717695236206
Epoch: 2, Steps: 131 | Train Loss: 0.6079168 Vali Loss: 0.2815245 Best vali loss: 0.2745913
	iters: 100, epoch: 3 | loss: 0.5137171
	speed: 0.0111s/iter; left time: 7.6525s
Updating learning rate to 0.000119458824025
Epoch: 3 cost time: 0.9081451892852783
Epoch: 3, Steps: 131 | Train Loss: 0.5137171 Vali Loss: 0.2927077 Best vali loss: 0.2745913

best validation loss 0.27459132996089575

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020981779202, 'e_layers': 4, 'learning_rate': 0.0005051175325, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005051175325
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 1.1603329181671143
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857523 Best vali loss: 0.2857523
Updating learning rate to 0.00025255876625
Epoch: 2 cost time: 0.9391777515411377
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2905108 Best vali loss: 0.2857523
Updating learning rate to 0.000126279383125
Validation loss decreased (0.2858 --> 0.2820).  Saving model state dict ...
Epoch: 3 cost time: 0.9420206546783447
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2820325 Best vali loss: 0.2820325

best validation loss 0.2820324715117444

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021042304833, 'e_layers': 3, 'learning_rate': 0.0004778352961, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3338402
	speed: 0.0118s/iter; left time: 6.5748s
Updating learning rate to 5.97294120125e-05
Epoch: 4 cost time: 1.149571418762207
Epoch: 4, Steps: 131 | Train Loss: 0.3338402 Vali Loss: 0.2885515 Best vali loss: 0.2745913
	iters: 100, epoch: 5 | loss: 0.3455696
	speed: 0.0111s/iter; left time: 4.7121s
Updating learning rate to 2.986470600625e-05
Epoch: 5 cost time: 0.9156312942504883
Epoch: 5, Steps: 131 | Train Loss: 0.3455696 Vali Loss: 0.2858199 Best vali loss: 0.2745913
	iters: 100, epoch: 6 | loss: 0.3817381
	speed: 0.0109s/iter; left time: 3.2075s
Updating learning rate to 1.4932353003125e-05
Epoch: 6 cost time: 0.9073262214660645
Epoch: 6, Steps: 131 | Train Loss: 0.3817381 Vali Loss: 0.2870991 Best vali loss: 0.2745913
	iters: 100, epoch: 7 | loss: 0.2953113
	speed: 0.0109s/iter; left time: 1.7794s
Updating learning rate to 7.4661765015625e-06
Epoch: 7 cost time: 0.9056870937347412
Epoch: 7, Steps: 131 | Train Loss: 0.2953113 Vali Loss: 0.2875811 Best vali loss: 0.2745913
	iters: 100, epoch: 8 | loss: 0.2917810
	speed: 0.0111s/iter; left time: 0.3548s
Updating learning rate to 3.73308825078125e-06
Epoch: 8 cost time: 0.9131069183349609
Epoch: 8, Steps: 131 | Train Loss: 0.2917810 Vali Loss: 0.2876523 Best vali loss: 0.2745913

best validation loss 0.27459132996089575

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0058558889238, 'e_layers': 1, 'learning_rate': 5.73188539e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6853819
	speed: 0.0078s/iter; left time: 31.8111s
	iters: 200, epoch: 1 | loss: 0.8484535
	speed: 0.0023s/iter; left time: 9.1734s
	iters: 300, epoch: 1 | loss: 0.5305684
	speed: 0.0023s/iter; left time: 8.8793s
	iters: 400, epoch: 1 | loss: 0.4340501
	speed: 0.0023s/iter; left time: 8.6279s
	iters: 500, epoch: 1 | loss: 1.2510058
	speed: 0.0025s/iter; left time: 9.2440s
Updating learning rate to 5.5137284922607376e-05
Validation loss decreased (inf --> 0.3286).  Saving model state dict ...
Epoch: 1 cost time: 1.5005083084106445
Epoch: 1, Steps: 523 | Train Loss: 0.7498919 Vali Loss: 0.3286349 Best vali loss: 0.3286349
	iters: 100, epoch: 2 | loss: 1.2249066
	speed: 0.0057s/iter; left time: 20.3438s
	iters: 200, epoch: 2 | loss: 0.5589176
	speed: 0.0023s/iter; left time: 7.9639s
	iters: 300, epoch: 2 | loss: 0.3238614
	speed: 0.0023s/iter; left time: 7.6720s
	iters: 400, epoch: 2 | loss: 0.6849400
	speed: 0.0024s/iter; left time: 7.6697s
	iters: 500, epoch: 2 | loss: 0.7798896
	speed: 0.0023s/iter; left time: 7.3030s
Updating learning rate to 4.892470209126549e-05
Validation loss decreased (0.3286 --> 0.3099).  Saving model state dict ...
Epoch: 2 cost time: 1.2513670921325684
Epoch: 2, Steps: 523 | Train Loss: 0.7145030 Vali Loss: 0.3098795 Best vali loss: 0.3098795
	iters: 100, epoch: 3 | loss: 0.3622895
	speed: 0.0057s/iter; left time: 17.4452s
	iters: 200, epoch: 3 | loss: 0.4478053
	speed: 0.0025s/iter; left time: 7.2379s
	iters: 300, epoch: 3 | loss: 0.3248333
	speed: 0.0025s/iter; left time: 7.0139s
	iters: 400, epoch: 3 | loss: 0.6638142
	speed: 0.0025s/iter; left time: 6.7395s
	iters: 500, epoch: 3 | loss: 0.3242351
	speed: 0.0024s/iter; left time: 6.4413s
Updating learning rate to 3.962691482484256e-05
Validation loss decreased (0.3099 --> 0.3008).  Saving model state dict ...
Epoch: 3 cost time: 1.3235177993774414
Epoch: 3, Steps: 523 | Train Loss: 0.4245955 Vali Loss: 0.3008007 Best vali loss: 0.3008007
	iters: 100, epoch: 4 | loss: 0.2654393
	speed: 0.0060s/iter; left time: 15.1525s
	iters: 200, epoch: 4 | loss: 0.3398854
	speed: 0.0025s/iter; left time: 6.0690s
	iters: 300, epoch: 4 | loss: 0.4116795
	speed: 0.0025s/iter; left time: 5.7248s
	iters: 400, epoch: 4 | loss: 0.3539491
	speed: 0.0025s/iter; left time: 5.5022s
	iters: 500, epoch: 4 | loss: 0.4504630
	speed: 0.0025s/iter; left time: 5.3515s
Updating learning rate to 2.865942695e-05
Validation loss decreased (0.3008 --> 0.2960).  Saving model state dict ...
Epoch: 4 cost time: 1.3462843894958496
Epoch: 4, Steps: 523 | Train Loss: 0.3642833 Vali Loss: 0.2959698 Best vali loss: 0.2959698
	iters: 100, epoch: 5 | loss: 0.5800080
	speed: 0.0056s/iter; left time: 11.1316s
	iters: 200, epoch: 5 | loss: 0.4942792
	speed: 0.0023s/iter; left time: 4.3060s
	iters: 300, epoch: 5 | loss: 0.2705489
	speed: 0.0023s/iter; left time: 4.0589s
	iters: 400, epoch: 5 | loss: 0.3517856
	speed: 0.0022s/iter; left time: 3.7663s
	iters: 500, epoch: 5 | loss: 0.5736810
	speed: 0.0023s/iter; left time: 3.5895s
Updating learning rate to 1.7691939075157446e-05
Validation loss decreased (0.2960 --> 0.2935).  Saving model state dict ...
Epoch: 5 cost time: 1.2132158279418945
Epoch: 5, Steps: 523 | Train Loss: 0.4540605 Vali Loss: 0.2935072 Best vali loss: 0.2935072
	iters: 100, epoch: 6 | loss: 0.3249308
	speed: 0.0056s/iter; left time: 8.2886s
	iters: 200, epoch: 6 | loss: 0.7256521
	speed: 0.0024s/iter; left time: 3.2754s
	iters: 300, epoch: 6 | loss: 0.3768844
	speed: 0.0024s/iter; left time: 3.0240s
	iters: 400, epoch: 6 | loss: 0.8629436
	speed: 0.0024s/iter; left time: 2.7840s
	iters: 500, epoch: 6 | loss: 0.3540319
	speed: 0.0024s/iter; left time: 2.5446s
Updating learning rate to 8.39415180873451e-06
Validation loss decreased (0.2935 --> 0.2920).  Saving model state dict ...
Epoch: 6 cost time: 1.2920265197753906
Epoch: 6, Steps: 523 | Train Loss: 0.5288886 Vali Loss: 0.2919757 Best vali loss: 0.2919757
	iters: 100, epoch: 7 | loss: 1.7383932
	speed: 0.0054s/iter; left time: 5.1526s
	iters: 200, epoch: 7 | loss: 0.5286279
	speed: 0.0021s/iter; left time: 1.7844s
	iters: 300, epoch: 7 | loss: 0.4579417
	speed: 0.0021s/iter; left time: 1.5590s
	iters: 400, epoch: 7 | loss: 0.3230014
	speed: 0.0021s/iter; left time: 1.3492s
	iters: 500, epoch: 7 | loss: 0.2962010
	speed: 0.0021s/iter; left time: 1.1389s
Updating learning rate to 2.1815689773926277e-06
Validation loss decreased (0.2920 --> 0.2913).  Saving model state dict ...
Epoch: 7 cost time: 1.1331253051757812
Epoch: 7, Steps: 523 | Train Loss: 0.6688330 Vali Loss: 0.2913234 Best vali loss: 0.2913234
	iters: 100, epoch: 8 | loss: 0.5630301
	speed: 0.0054s/iter; left time: 2.2988s
	iters: 200, epoch: 8 | loss: 1.6043648
	speed: 0.0021s/iter; left time: 0.6929s
	iters: 300, epoch: 8 | loss: 0.5832555
	speed: 0.0021s/iter; left time: 0.4772s
	iters: 400, epoch: 8 | loss: 0.5675647
	speed: 0.0021s/iter; left time: 0.2634s
	iters: 500, epoch: 8 | loss: 0.3603782
	speed: 0.0021s/iter; left time: 0.0500s
Updating learning rate to 0.0
Validation loss decreased (0.2913 --> 0.2912).  Saving model state dict ...
Epoch: 8 cost time: 1.1455862522125244
Epoch: 8, Steps: 523 | Train Loss: 0.7357187 Vali Loss: 0.2911714 Best vali loss: 0.2911714

best validation loss 0.29117140143987813

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0014775454905, 'e_layers': 1, 'learning_rate': 0.0043650713634, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3127941
	speed: 0.0080s/iter; left time: 32.6841s
	iters: 200, epoch: 1 | loss: 0.9762285
	speed: 0.0025s/iter; left time: 9.9005s
	iters: 300, epoch: 1 | loss: 0.3126249
	speed: 0.0025s/iter; left time: 9.7126s
	iters: 400, epoch: 1 | loss: 0.2550544
	speed: 0.0025s/iter; left time: 9.5003s
	iters: 500, epoch: 1 | loss: 0.3637215
	speed: 0.0025s/iter; left time: 9.1172s
Updating learning rate to 0.004198935726998199
Validation loss decreased (inf --> 0.3003).  Saving model state dict ...
Epoch: 1 cost time: 1.5687391757965088
Epoch: 1, Steps: 523 | Train Loss: 0.4440847 Vali Loss: 0.3003144 Best vali loss: 0.3003144
	iters: 100, epoch: 2 | loss: 0.9936742
	speed: 0.0055s/iter; left time: 19.7572s
	iters: 200, epoch: 2 | loss: 0.5723605
	speed: 0.0021s/iter; left time: 7.3656s
	iters: 300, epoch: 2 | loss: 0.8122720
	speed: 0.0023s/iter; left time: 7.6812s
	iters: 400, epoch: 2 | loss: 0.7383384
	speed: 0.0024s/iter; left time: 7.7109s
	iters: 500, epoch: 2 | loss: 1.5078990
	speed: 0.0022s/iter; left time: 6.8504s
Updating learning rate to 0.0037258214624116743
Validation loss decreased (0.3003 --> 0.2953).  Saving model state dict ...
Epoch: 2 cost time: 1.1905431747436523
Epoch: 2, Steps: 523 | Train Loss: 0.9249088 Vali Loss: 0.2952894 Best vali loss: 0.2952894
	iters: 100, epoch: 3 | loss: 0.3680304
	speed: 0.0053s/iter; left time: 16.2251s
	iters: 200, epoch: 3 | loss: 0.4096496
	speed: 0.0021s/iter; left time: 6.2277s
	iters: 300, epoch: 3 | loss: 0.4666154
	speed: 0.0021s/iter; left time: 6.0408s
	iters: 400, epoch: 3 | loss: 0.5810808
	speed: 0.0022s/iter; left time: 5.8928s
	iters: 500, epoch: 3 | loss: 0.5617285
	speed: 0.0021s/iter; left time: 5.5547s
Updating learning rate to 0.003017755927632237
Epoch: 3 cost time: 1.1454637050628662
Epoch: 3, Steps: 523 | Train Loss: 0.4774209 Vali Loss: 0.3120310 Best vali loss: 0.2952894
	iters: 100, epoch: 4 | loss: 0.2754878
	speed: 0.0053s/iter; left time: 13.4007s
	iters: 200, epoch: 4 | loss: 0.2975239
	speed: 0.0022s/iter; left time: 5.3038s
	iters: 300, epoch: 4 | loss: 0.5470253
	speed: 0.0021s/iter; left time: 4.9145s
	iters: 400, epoch: 4 | loss: 0.2053394
	speed: 0.0022s/iter; left time: 4.8672s
	iters: 500, epoch: 4 | loss: 0.9597816
	speed: 0.0021s/iter; left time: 4.4646s
Updating learning rate to 0.0021825356817
Validation loss decreased (0.2953 --> 0.2926).  Saving model state dict ...
Epoch: 4 cost time: 1.167311668395996
Epoch: 4, Steps: 523 | Train Loss: 0.4570316 Vali Loss: 0.2926368 Best vali loss: 0.2926368
	iters: 100, epoch: 5 | loss: 0.5252978
	speed: 0.0058s/iter; left time: 11.5691s
	iters: 200, epoch: 5 | loss: 0.8910837
	speed: 0.0025s/iter; left time: 4.6815s
	iters: 300, epoch: 5 | loss: 0.4376343
	speed: 0.0025s/iter; left time: 4.4546s
	iters: 400, epoch: 5 | loss: 0.4118353
	speed: 0.0024s/iter; left time: 4.1311s
	iters: 500, epoch: 5 | loss: 0.4279184
	speed: 0.0025s/iter; left time: 3.9403s
Updating learning rate to 0.001347315435767763
Epoch: 5 cost time: 1.3301565647125244
Epoch: 5, Steps: 523 | Train Loss: 0.5387539 Vali Loss: 0.3485317 Best vali loss: 0.2926368
	iters: 100, epoch: 6 | loss: 0.5982305
	speed: 0.0056s/iter; left time: 8.2316s
	iters: 200, epoch: 6 | loss: 0.1998035
	speed: 0.0021s/iter; left time: 2.9340s
	iters: 300, epoch: 6 | loss: 0.1806224
	speed: 0.0021s/iter; left time: 2.7100s
	iters: 400, epoch: 6 | loss: 0.3322595
	speed: 0.0021s/iter; left time: 2.5079s
	iters: 500, epoch: 6 | loss: 0.6987305
	speed: 0.0022s/iter; left time: 2.3186s
Updating learning rate to 0.0006392499009883259
Epoch: 6 cost time: 1.1670942306518555
Epoch: 6, Steps: 523 | Train Loss: 0.4019293 Vali Loss: 0.3521130 Best vali loss: 0.2926368
	iters: 100, epoch: 7 | loss: 0.4815606
	speed: 0.0055s/iter; left time: 5.2381s
	iters: 200, epoch: 7 | loss: 0.6757874
	speed: 0.0022s/iter; left time: 1.8853s
	iters: 300, epoch: 7 | loss: 0.2516527
	speed: 0.0022s/iter; left time: 1.6659s
	iters: 400, epoch: 7 | loss: 0.3747286
	speed: 0.0022s/iter; left time: 1.4454s
	iters: 500, epoch: 7 | loss: 0.4739771
	speed: 0.0022s/iter; left time: 1.2044s
Updating learning rate to 0.0001661356364018015
Epoch: 7 cost time: 1.1963040828704834
Epoch: 7, Steps: 523 | Train Loss: 0.4515413 Vali Loss: 0.3801901 Best vali loss: 0.2926368
	iters: 100, epoch: 8 | loss: 0.2906596
	speed: 0.0056s/iter; left time: 2.3816s
	iters: 200, epoch: 8 | loss: 0.5179422
	speed: 0.0023s/iter; left time: 0.7368s
	iters: 300, epoch: 8 | loss: 0.3456841
	speed: 0.0023s/iter; left time: 0.5124s
	iters: 400, epoch: 8 | loss: 0.5155549
	speed: 0.0023s/iter; left time: 0.2842s
	iters: 500, epoch: 8 | loss: 0.2451121
	speed: 0.0023s/iter; left time: 0.0562s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2448346614837646
Epoch: 8, Steps: 523 | Train Loss: 0.3829906 Vali Loss: 0.3779085 Best vali loss: 0.2926368

best validation loss 0.2926367679884461

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0013168615201, 'e_layers': 3, 'learning_rate': 0.0042758527854, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5756492
	speed: 0.0111s/iter; left time: 10.5174s
Updating learning rate to 0.004113112828931218
Validation loss decreased (inf --> 0.3361).  Saving model state dict ...
Epoch: 1 cost time: 0.9981908798217773
Epoch: 1, Steps: 131 | Train Loss: 0.5756492 Vali Loss: 0.3360719 Best vali loss: 0.3360719
	iters: 100, epoch: 2 | loss: 0.6114491
	speed: 0.0093s/iter; left time: 7.5831s
Updating learning rate to 0.003649668642655864
Validation loss decreased (0.3361 --> 0.3217).  Saving model state dict ...
Epoch: 2 cost time: 0.7544190883636475
Epoch: 2, Steps: 131 | Train Loss: 0.6114491 Vali Loss: 0.3216899 Best vali loss: 0.3216899
	iters: 100, epoch: 3 | loss: 0.5832423
	speed: 0.0093s/iter; left time: 6.4080s
Updating learning rate to 0.0029560754028023512
Epoch: 3 cost time: 0.7464237213134766
Epoch: 3, Steps: 131 | Train Loss: 0.5832423 Vali Loss: 0.3224942 Best vali loss: 0.3216899

best validation loss 0.3216899297701998

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0040217629745, 'e_layers': 3, 'learning_rate': 0.0001136902273, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6222649
	speed: 0.0096s/iter; left time: 19.2609s
	iters: 200, epoch: 1 | loss: 0.4142383
	speed: 0.0044s/iter; left time: 8.2649s
Updating learning rate to 0.00010936315067451298
Validation loss decreased (inf --> 0.3145).  Saving model state dict ...
Epoch: 1 cost time: 1.3884105682373047
Epoch: 1, Steps: 262 | Train Loss: 0.5182516 Vali Loss: 0.3144968 Best vali loss: 0.3144968
	iters: 100, epoch: 2 | loss: 0.5101200
	speed: 0.0098s/iter; left time: 16.9625s
	iters: 200, epoch: 2 | loss: 0.4733794
	speed: 0.0043s/iter; left time: 7.1014s
Updating learning rate to 9.704067898923497e-05
Validation loss decreased (0.3145 --> 0.2993).  Saving model state dict ...
Epoch: 2 cost time: 1.2032146453857422
Epoch: 2, Steps: 262 | Train Loss: 0.4917497 Vali Loss: 0.2992867 Best vali loss: 0.2992867
	iters: 100, epoch: 3 | loss: 0.6000034
	speed: 0.0090s/iter; left time: 13.2641s
	iters: 200, epoch: 3 | loss: 0.9444996
	speed: 0.0039s/iter; left time: 5.3676s
Updating learning rate to 7.859879685476563e-05
Validation loss decreased (0.2993 --> 0.2923).  Saving model state dict ...
Epoch: 3 cost time: 1.0464508533477783
Epoch: 3, Steps: 262 | Train Loss: 0.7722515 Vali Loss: 0.2923390 Best vali loss: 0.2923390

best validation loss 0.2923389988545815

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270307097, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597159
	speed: 0.0106s/iter; left time: 10.0423s
Updating learning rate to 0.0002345278778
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.942263126373291
Epoch: 1, Steps: 131 | Train Loss: 0.5597159 Vali Loss: 0.2756418 Best vali loss: 0.2756418
	iters: 100, epoch: 2 | loss: 0.3240530
	speed: 0.0088s/iter; left time: 7.1755s
Updating learning rate to 0.0001172639389
Validation loss decreased (0.2756 --> 0.2725).  Saving model state dict ...
Epoch: 2 cost time: 0.6945955753326416
Epoch: 2, Steps: 131 | Train Loss: 0.3240530 Vali Loss: 0.2724546 Best vali loss: 0.2724546
	iters: 100, epoch: 3 | loss: 0.4630087
	speed: 0.0090s/iter; left time: 6.1628s
Updating learning rate to 5.863196945e-05
Epoch: 3 cost time: 0.7020950317382812
Epoch: 3, Steps: 131 | Train Loss: 0.4630087 Vali Loss: 0.2766079 Best vali loss: 0.2724546

best validation loss 0.27245462102577916

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270307097, 'e_layers': 2, 'learning_rate': 0.0002345278778, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4235924
	speed: 0.0110s/iter; left time: 6.1126s
Updating learning rate to 2.9315984725e-05
Epoch: 4 cost time: 0.9220974445343018
Epoch: 4, Steps: 131 | Train Loss: 0.4235924 Vali Loss: 0.2999880 Best vali loss: 0.2724546
	iters: 100, epoch: 5 | loss: 0.2836803
	speed: 0.0087s/iter; left time: 3.6962s
Updating learning rate to 1.46579923625e-05
Epoch: 5 cost time: 0.70479416847229
Epoch: 5, Steps: 131 | Train Loss: 0.2836803 Vali Loss: 0.2997025 Best vali loss: 0.2724546
	iters: 100, epoch: 6 | loss: 0.4334835
	speed: 0.0087s/iter; left time: 2.5449s
Updating learning rate to 7.32899618125e-06
Epoch: 6 cost time: 0.6959719657897949
Epoch: 6, Steps: 131 | Train Loss: 0.4334835 Vali Loss: 0.3003730 Best vali loss: 0.2724546
	iters: 100, epoch: 7 | loss: 0.4659863
	speed: 0.0087s/iter; left time: 1.4238s
Updating learning rate to 3.664498090625e-06
Epoch: 7 cost time: 0.7061784267425537
Epoch: 7, Steps: 131 | Train Loss: 0.4659863 Vali Loss: 0.2983727 Best vali loss: 0.2724546
	iters: 100, epoch: 8 | loss: 0.3289553
	speed: 0.0087s/iter; left time: 0.2776s
Updating learning rate to 1.8322490453125e-06
Epoch: 8 cost time: 0.70013427734375
Epoch: 8, Steps: 131 | Train Loss: 0.3289553 Vali Loss: 0.2978811 Best vali loss: 0.2724546

best validation loss 0.27245462102577916

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0043546769304, 'e_layers': 3, 'learning_rate': 0.0004716383502, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6671197
	speed: 0.0110s/iter; left time: 10.4273s
Updating learning rate to 0.0004716383502
Validation loss decreased (inf --> 0.2970).  Saving model state dict ...
Epoch: 1 cost time: 1.0030992031097412
Epoch: 1, Steps: 131 | Train Loss: 0.6671197 Vali Loss: 0.2969645 Best vali loss: 0.2969645
	iters: 100, epoch: 2 | loss: 0.3774451
	speed: 0.0094s/iter; left time: 7.6808s
Updating learning rate to 0.0002358191751
Validation loss decreased (0.2970 --> 0.2886).  Saving model state dict ...
Epoch: 2 cost time: 0.7677228450775146
Epoch: 2, Steps: 131 | Train Loss: 0.3774451 Vali Loss: 0.2885840 Best vali loss: 0.2885840
	iters: 100, epoch: 3 | loss: 0.4147610
	speed: 0.0096s/iter; left time: 6.5726s
Updating learning rate to 0.00011790958755
Validation loss decreased (0.2886 --> 0.2873).  Saving model state dict ...
Epoch: 3 cost time: 0.7836456298828125
Epoch: 3, Steps: 131 | Train Loss: 0.4147610 Vali Loss: 0.2872604 Best vali loss: 0.2872604
	iters: 100, epoch: 4 | loss: 0.2776288
	speed: 0.0095s/iter; left time: 5.3083s
Updating learning rate to 5.8954793775e-05
Validation loss decreased (0.2873 --> 0.2849).  Saving model state dict ...
Epoch: 4 cost time: 0.7799539566040039
Epoch: 4, Steps: 131 | Train Loss: 0.2776288 Vali Loss: 0.2849069 Best vali loss: 0.2849069
	iters: 100, epoch: 5 | loss: 0.2988766
	speed: 0.0095s/iter; left time: 4.0373s
Updating learning rate to 2.94773968875e-05
Epoch: 5 cost time: 0.7777714729309082
Epoch: 5, Steps: 131 | Train Loss: 0.2988766 Vali Loss: 0.2902593 Best vali loss: 0.2849069
	iters: 100, epoch: 6 | loss: 0.2759736
	speed: 0.0093s/iter; left time: 2.7374s
Updating learning rate to 1.473869844375e-05
Epoch: 6 cost time: 0.7712647914886475
Epoch: 6, Steps: 131 | Train Loss: 0.2759736 Vali Loss: 0.2902314 Best vali loss: 0.2849069
	iters: 100, epoch: 7 | loss: 0.3398244
	speed: 0.0092s/iter; left time: 1.4931s
Updating learning rate to 7.369349221875e-06
Epoch: 7 cost time: 0.7610797882080078
Epoch: 7, Steps: 131 | Train Loss: 0.3398244 Vali Loss: 0.2960209 Best vali loss: 0.2849069
	iters: 100, epoch: 8 | loss: 0.3655932
	speed: 0.0091s/iter; left time: 0.2915s
Updating learning rate to 3.6846746109375e-06
Epoch: 8 cost time: 0.7530884742736816
Epoch: 8, Steps: 131 | Train Loss: 0.3655932 Vali Loss: 0.2943410 Best vali loss: 0.2849069

best validation loss 0.28490690952364334

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0029475119692, 'e_layers': 3, 'learning_rate': 0.0042230528994, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3397880
	speed: 0.0095s/iter; left time: 19.0590s
	iters: 200, epoch: 1 | loss: 0.4355048
	speed: 0.0041s/iter; left time: 7.8433s
Updating learning rate to 0.0042230528994
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 1.3653161525726318
Epoch: 1, Steps: 262 | Train Loss: 0.3876464 Vali Loss: 0.2878946 Best vali loss: 0.2878946
	iters: 100, epoch: 2 | loss: 0.2810941
	speed: 0.0096s/iter; left time: 16.5757s
	iters: 200, epoch: 2 | loss: 0.3115011
	speed: 0.0045s/iter; left time: 7.4161s
Updating learning rate to 0.0021115264497
Validation loss decreased (0.2879 --> 0.2854).  Saving model state dict ...
Epoch: 2 cost time: 1.206925392150879
Epoch: 2, Steps: 262 | Train Loss: 0.2962976 Vali Loss: 0.2854189 Best vali loss: 0.2854189
	iters: 100, epoch: 3 | loss: 0.6801431
	speed: 0.0095s/iter; left time: 14.0663s
	iters: 200, epoch: 3 | loss: 0.2827376
	speed: 0.0045s/iter; left time: 6.1919s
Updating learning rate to 0.00105576322485
Epoch: 3 cost time: 1.1962559223175049
Epoch: 3, Steps: 262 | Train Loss: 0.4814404 Vali Loss: 0.2910450 Best vali loss: 0.2854189
	iters: 100, epoch: 4 | loss: 0.3517850
	speed: 0.0090s/iter; left time: 10.9119s
	iters: 200, epoch: 4 | loss: 0.3607758
	speed: 0.0039s/iter; left time: 4.3500s
Updating learning rate to 0.000527881612425
Epoch: 4 cost time: 1.075303316116333
Epoch: 4, Steps: 262 | Train Loss: 0.3562804 Vali Loss: 0.3004203 Best vali loss: 0.2854189
	iters: 100, epoch: 5 | loss: 0.3831338
	speed: 0.0089s/iter; left time: 8.4604s
	iters: 200, epoch: 5 | loss: 0.3482881
	speed: 0.0039s/iter; left time: 3.3365s
Updating learning rate to 0.0002639408062125
Epoch: 5 cost time: 1.0828189849853516
Epoch: 5, Steps: 262 | Train Loss: 0.3657110 Vali Loss: 0.3001957 Best vali loss: 0.2854189
	iters: 100, epoch: 6 | loss: 0.2195578
	speed: 0.0094s/iter; left time: 6.4561s
	iters: 200, epoch: 6 | loss: 0.5906835
	speed: 0.0046s/iter; left time: 2.7007s
Updating learning rate to 0.00013197040310625
Epoch: 6 cost time: 1.2557525634765625
Epoch: 6, Steps: 262 | Train Loss: 0.4051206 Vali Loss: 0.3019640 Best vali loss: 0.2854189
	iters: 100, epoch: 7 | loss: 0.4260497
	speed: 0.0097s/iter; left time: 4.1191s
	iters: 200, epoch: 7 | loss: 0.2094524
	speed: 0.0040s/iter; left time: 1.3033s
Updating learning rate to 6.5985201553125e-05
Epoch: 7 cost time: 1.1207802295684814
Epoch: 7, Steps: 262 | Train Loss: 0.3177511 Vali Loss: 0.3034667 Best vali loss: 0.2854189
	iters: 100, epoch: 8 | loss: 0.3389618
	speed: 0.0087s/iter; left time: 1.4211s
	iters: 200, epoch: 8 | loss: 0.6255127
	speed: 0.0044s/iter; left time: 0.2752s
Updating learning rate to 3.29926007765625e-05
Epoch: 8 cost time: 1.1523010730743408
Epoch: 8, Steps: 262 | Train Loss: 0.4822372 Vali Loss: 0.3030393 Best vali loss: 0.2854189

best validation loss 0.2854188533826094

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030007471118, 'e_layers': 3, 'learning_rate': 0.0004997905418, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5263134
	speed: 0.0122s/iter; left time: 11.5768s
Updating learning rate to 0.00048076839695587335
Validation loss decreased (inf --> 0.2811).  Saving model state dict ...
Epoch: 1 cost time: 1.1432018280029297
Epoch: 1, Steps: 131 | Train Loss: 0.5263134 Vali Loss: 0.2811057 Best vali loss: 0.2811057
	iters: 100, epoch: 2 | loss: 0.5672817
	speed: 0.0114s/iter; left time: 9.3187s
Updating learning rate to 0.0004265979115398393
Epoch: 2 cost time: 0.9145195484161377
Epoch: 2, Steps: 131 | Train Loss: 0.5672817 Vali Loss: 0.2873412 Best vali loss: 0.2811057
	iters: 100, epoch: 3 | loss: 0.5035735
	speed: 0.0109s/iter; left time: 7.5161s
Updating learning rate to 0.00034552605089981596
Epoch: 3 cost time: 0.9068872928619385
Epoch: 3, Steps: 131 | Train Loss: 0.5035735 Vali Loss: 0.2909727 Best vali loss: 0.2811057

best validation loss 0.28110566336277826

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0041138207427, 'e_layers': 3, 'learning_rate': 0.0004719697669, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6642433
	speed: 0.0112s/iter; left time: 10.6733s
Updating learning rate to 0.00045400648725151644
Validation loss decreased (inf --> 0.2959).  Saving model state dict ...
Epoch: 1 cost time: 1.0186889171600342
Epoch: 1, Steps: 131 | Train Loss: 0.6642433 Vali Loss: 0.2958638 Best vali loss: 0.2958638
	iters: 100, epoch: 2 | loss: 0.3737255
	speed: 0.0096s/iter; left time: 7.8578s
Updating learning rate to 0.000402851394795012
Validation loss decreased (0.2959 --> 0.2865).  Saving model state dict ...
Epoch: 2 cost time: 0.7757112979888916
Epoch: 2, Steps: 131 | Train Loss: 0.3737255 Vali Loss: 0.2864502 Best vali loss: 0.2864502
	iters: 100, epoch: 3 | loss: 0.4453063
	speed: 0.0096s/iter; left time: 6.6209s
Updating learning rate to 0.00032629238863492166
Epoch: 3 cost time: 0.7673594951629639
Epoch: 3, Steps: 131 | Train Loss: 0.4453063 Vali Loss: 0.2910877 Best vali loss: 0.2864502

best validation loss 0.2864502219240122

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029924639406, 'e_layers': 3, 'learning_rate': 0.0004712870404, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5554019
	speed: 0.0111s/iter; left time: 10.5019s
Updating learning rate to 0.00045334974548168997
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 0.9654667377471924
Epoch: 1, Steps: 131 | Train Loss: 0.5554019 Vali Loss: 0.2837900 Best vali loss: 0.2837900
	iters: 100, epoch: 2 | loss: 0.5365707
	speed: 0.0091s/iter; left time: 7.4154s
Updating learning rate to 0.00040226865127608916
Validation loss decreased (0.2838 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 0.7241232395172119
Epoch: 2, Steps: 131 | Train Loss: 0.5365707 Vali Loss: 0.2811684 Best vali loss: 0.2811684
	iters: 100, epoch: 3 | loss: 0.4722852
	speed: 0.0091s/iter; left time: 6.2840s
Updating learning rate to 0.00032582039132472837
Epoch: 3 cost time: 0.7443568706512451
Epoch: 3, Steps: 131 | Train Loss: 0.4722852 Vali Loss: 0.3137793 Best vali loss: 0.2811684

best validation loss 0.281168352043642

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030007471118, 'e_layers': 3, 'learning_rate': 0.0004997905418, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3609076
	speed: 0.0125s/iter; left time: 6.9229s
Updating learning rate to 0.0002498952709
Epoch: 4 cost time: 1.1395082473754883
Epoch: 4, Steps: 131 | Train Loss: 0.3609076 Vali Loss: 0.2847094 Best vali loss: 0.2811057
	iters: 100, epoch: 5 | loss: 0.3162378
	speed: 0.0110s/iter; left time: 4.6764s
Updating learning rate to 0.00015426449090018407
Epoch: 5 cost time: 0.9099502563476562
Epoch: 5, Steps: 131 | Train Loss: 0.3162378 Vali Loss: 0.2831335 Best vali loss: 0.2811057
	iters: 100, epoch: 6 | loss: 0.3397238
	speed: 0.0110s/iter; left time: 3.2311s
Updating learning rate to 7.31926302601607e-05
Epoch: 6 cost time: 0.91182541847229
Epoch: 6, Steps: 131 | Train Loss: 0.3397238 Vali Loss: 0.2966082 Best vali loss: 0.2811057
	iters: 100, epoch: 7 | loss: 0.2346432
	speed: 0.0110s/iter; left time: 1.7949s
Updating learning rate to 1.9022144844126644e-05
Epoch: 7 cost time: 0.9076235294342041
Epoch: 7, Steps: 131 | Train Loss: 0.2346432 Vali Loss: 0.3047603 Best vali loss: 0.2811057
	iters: 100, epoch: 8 | loss: 0.2689424
	speed: 0.0111s/iter; left time: 0.3564s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9255726337432861
Epoch: 8, Steps: 131 | Train Loss: 0.2689424 Vali Loss: 0.3077206 Best vali loss: 0.2811057

best validation loss 0.28110566336277826

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020761073495, 'e_layers': 4, 'learning_rate': 0.0005548549381, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3559107
	speed: 0.0123s/iter; left time: 11.6526s
Updating learning rate to 0.0005337370294617035
Validation loss decreased (inf --> 0.3162).  Saving model state dict ...
Epoch: 1 cost time: 1.168133020401001
Epoch: 1, Steps: 131 | Train Loss: 0.3559107 Vali Loss: 0.3161557 Best vali loss: 0.3161557
	iters: 100, epoch: 2 | loss: 0.6365800
	speed: 0.0113s/iter; left time: 9.2746s
Updating learning rate to 0.0004735983137026761
Validation loss decreased (0.3162 --> 0.2865).  Saving model state dict ...
Epoch: 2 cost time: 0.9176652431488037
Epoch: 2, Steps: 131 | Train Loss: 0.6365800 Vali Loss: 0.2865082 Best vali loss: 0.2865082
	iters: 100, epoch: 3 | loss: 0.3058175
	speed: 0.0115s/iter; left time: 7.9156s
Updating learning rate to 0.00038359436513841377
Validation loss decreased (0.2865 --> 0.2861).  Saving model state dict ...
Epoch: 3 cost time: 0.9336936473846436
Epoch: 3, Steps: 131 | Train Loss: 0.3058175 Vali Loss: 0.2861380 Best vali loss: 0.2861380
	iters: 100, epoch: 4 | loss: 0.4711941
	speed: 0.0115s/iter; left time: 6.3788s
Updating learning rate to 0.00027742746905
Epoch: 4 cost time: 0.9199354648590088
Epoch: 4, Steps: 131 | Train Loss: 0.4711941 Vali Loss: 0.3046487 Best vali loss: 0.2861380
	iters: 100, epoch: 5 | loss: 0.3501718
	speed: 0.0112s/iter; left time: 4.7719s
Updating learning rate to 0.0001712605729615863
Epoch: 5 cost time: 0.9367392063140869
Epoch: 5, Steps: 131 | Train Loss: 0.3501718 Vali Loss: 0.2927951 Best vali loss: 0.2861380
	iters: 100, epoch: 6 | loss: 0.3189687
	speed: 0.0113s/iter; left time: 3.3182s
Updating learning rate to 8.125662439732399e-05
Epoch: 6 cost time: 0.9294798374176025
Epoch: 6, Steps: 131 | Train Loss: 0.3189687 Vali Loss: 0.3028251 Best vali loss: 0.2861380
	iters: 100, epoch: 7 | loss: 0.2959725
	speed: 0.0112s/iter; left time: 1.8251s
Updating learning rate to 2.1117908638296533e-05
Epoch: 7 cost time: 0.9305708408355713
Epoch: 7, Steps: 131 | Train Loss: 0.2959725 Vali Loss: 0.3161887 Best vali loss: 0.2861380
	iters: 100, epoch: 8 | loss: 0.3429803
	speed: 0.0111s/iter; left time: 0.3544s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9231712818145752
Epoch: 8, Steps: 131 | Train Loss: 0.3429803 Vali Loss: 0.3141016 Best vali loss: 0.2861380

best validation loss 0.28613804417633576

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020952336661, 'e_layers': 4, 'learning_rate': 0.000459858988, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004423566474272767
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 1.0566585063934326
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2827876 Best vali loss: 0.2827876
Updating learning rate to 0.0003925141984021916
Epoch: 2 cost time: 0.8187921047210693
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3003092 Best vali loss: 0.2827876
Updating learning rate to 0.00031791970196588836
Epoch: 3 cost time: 0.8041419982910156
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3121113 Best vali loss: 0.2827876
Updating learning rate to 0.000229929494
Epoch: 4 cost time: 0.807370662689209
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2929173 Best vali loss: 0.2827876
Updating learning rate to 0.0001419392860341117
Epoch: 5 cost time: 0.8115181922912598
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3024784 Best vali loss: 0.2827876
Updating learning rate to 6.734478959780843e-05
Epoch: 6 cost time: 0.8115077018737793
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3095102 Best vali loss: 0.2827876
Updating learning rate to 1.7502340572723292e-05
Epoch: 7 cost time: 0.8273687362670898
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3199281 Best vali loss: 0.2827876
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8086612224578857
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3224411 Best vali loss: 0.2827876

best validation loss 0.28278763725793954

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0077610628429, 'e_layers': 1, 'learning_rate': 0.0002573457511, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002573457511
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 0.4898562431335449
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2803390 Best vali loss: 0.2803390
Updating learning rate to 0.00012867287555
Epoch: 2 cost time: 0.25797581672668457
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2841663 Best vali loss: 0.2803390
Updating learning rate to 6.4336437775e-05
Validation loss decreased (0.2803 --> 0.2771).  Saving model state dict ...
Epoch: 3 cost time: 0.2766740322113037
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2770505 Best vali loss: 0.2770505

best validation loss 0.27705050993249425

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011444662604, 'e_layers': 1, 'learning_rate': 0.0002564110071, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3135972
	speed: 0.0077s/iter; left time: 63.5929s
	iters: 200, epoch: 1 | loss: 1.0106469
	speed: 0.0024s/iter; left time: 19.7819s
	iters: 300, epoch: 1 | loss: 0.3657840
	speed: 0.0024s/iter; left time: 19.4440s
	iters: 400, epoch: 1 | loss: 0.4721725
	speed: 0.0024s/iter; left time: 19.2321s
	iters: 500, epoch: 1 | loss: 0.8279759
	speed: 0.0024s/iter; left time: 18.9514s
	iters: 600, epoch: 1 | loss: 1.1324445
	speed: 0.0025s/iter; left time: 19.4619s
	iters: 700, epoch: 1 | loss: 0.4894481
	speed: 0.0025s/iter; left time: 19.0079s
	iters: 800, epoch: 1 | loss: 0.4560294
	speed: 0.0025s/iter; left time: 19.0176s
	iters: 900, epoch: 1 | loss: 0.2413750
	speed: 0.0025s/iter; left time: 18.4650s
	iters: 1000, epoch: 1 | loss: 0.3802982
	speed: 0.0024s/iter; left time: 17.6079s
Updating learning rate to 0.0002466519442351481
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 2.8139262199401855
Epoch: 1, Steps: 1045 | Train Loss: 0.6689772 Vali Loss: 0.2855090 Best vali loss: 0.2855090
	iters: 100, epoch: 2 | loss: 0.9850137
	speed: 0.0081s/iter; left time: 58.4666s
	iters: 200, epoch: 2 | loss: 0.2367307
	speed: 0.0024s/iter; left time: 16.7875s
	iters: 300, epoch: 2 | loss: 0.3627002
	speed: 0.0023s/iter; left time: 16.2926s
	iters: 400, epoch: 2 | loss: 0.5271805
	speed: 0.0022s/iter; left time: 15.4527s
	iters: 500, epoch: 2 | loss: 0.4302895
	speed: 0.0022s/iter; left time: 15.2671s
	iters: 600, epoch: 2 | loss: 0.3429563
	speed: 0.0023s/iter; left time: 15.1977s
	iters: 700, epoch: 2 | loss: 0.5107598
	speed: 0.0023s/iter; left time: 14.9560s
	iters: 800, epoch: 2 | loss: 0.5756423
	speed: 0.0023s/iter; left time: 14.7333s
	iters: 900, epoch: 2 | loss: 0.4373122
	speed: 0.0023s/iter; left time: 14.4948s
	iters: 1000, epoch: 2 | loss: 0.1587500
	speed: 0.0023s/iter; left time: 14.3349s
Updating learning rate to 0.00021886048449564098
Validation loss decreased (0.2855 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 2.4266347885131836
Epoch: 2, Steps: 1045 | Train Loss: 0.4567335 Vali Loss: 0.2827303 Best vali loss: 0.2827303
	iters: 100, epoch: 3 | loss: 0.1967236
	speed: 0.0079s/iter; left time: 48.6836s
	iters: 200, epoch: 3 | loss: 0.3905891
	speed: 0.0021s/iter; left time: 12.5244s
	iters: 300, epoch: 3 | loss: 0.1901935
	speed: 0.0021s/iter; left time: 12.5310s
	iters: 400, epoch: 3 | loss: 0.6471716
	speed: 0.0020s/iter; left time: 11.9809s
	iters: 500, epoch: 3 | loss: 0.4075110
	speed: 0.0021s/iter; left time: 12.0104s
	iters: 600, epoch: 3 | loss: 0.6481224
	speed: 0.0021s/iter; left time: 11.7685s
	iters: 700, epoch: 3 | loss: 0.3357293
	speed: 0.0022s/iter; left time: 12.0014s
	iters: 800, epoch: 3 | loss: 1.4193134
	speed: 0.0022s/iter; left time: 12.0770s
	iters: 900, epoch: 3 | loss: 0.4092159
	speed: 0.0022s/iter; left time: 11.8887s
	iters: 1000, epoch: 3 | loss: 1.5557008
	speed: 0.0022s/iter; left time: 11.7476s
Updating learning rate to 0.00017726762569660872
Epoch: 3 cost time: 2.2707505226135254
Epoch: 3, Steps: 1045 | Train Loss: 0.6200271 Vali Loss: 0.2913152 Best vali loss: 0.2827303

best validation loss 0.28273027954645963

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.002950938541, 'e_layers': 2, 'learning_rate': 0.0001489773302, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5320365
	speed: 0.0093s/iter; left time: 8.8408s
Updating learning rate to 0.0001433072181899778
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 0.7878918647766113
Epoch: 1, Steps: 131 | Train Loss: 0.5320365 Vali Loss: 0.2808590 Best vali loss: 0.2808590
	iters: 100, epoch: 2 | loss: 0.5784662
	speed: 0.0068s/iter; left time: 5.5668s
Updating learning rate to 0.00012716010531374372
Validation loss decreased (0.2809 --> 0.2786).  Saving model state dict ...
Epoch: 2 cost time: 0.5426197052001953
Epoch: 2, Steps: 131 | Train Loss: 0.5784662 Vali Loss: 0.2785762 Best vali loss: 0.2785762
	iters: 100, epoch: 3 | loss: 0.5591650
	speed: 0.0064s/iter; left time: 4.4145s
Updating learning rate to 0.00010299424313276168
Validation loss decreased (0.2786 --> 0.2781).  Saving model state dict ...
Epoch: 3 cost time: 0.4934859275817871
Epoch: 3, Steps: 131 | Train Loss: 0.5591650 Vali Loss: 0.2781287 Best vali loss: 0.2781287

best validation loss 0.2781286836113793

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0077610628429, 'e_layers': 1, 'learning_rate': 0.0002573457511, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.21682188875e-05
Epoch: 4 cost time: 0.48785400390625
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2783134 Best vali loss: 0.2770505
Updating learning rate to 1.608410944375e-05
Epoch: 5 cost time: 0.28583455085754395
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2778124 Best vali loss: 0.2770505
Updating learning rate to 8.042054721875e-06
Epoch: 6 cost time: 0.2627370357513428
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2779940 Best vali loss: 0.2770505
Updating learning rate to 4.0210273609375e-06
Epoch: 7 cost time: 0.25810766220092773
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2780180 Best vali loss: 0.2770505
Updating learning rate to 2.01051368046875e-06
Epoch: 8 cost time: 0.26911020278930664
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2780264 Best vali loss: 0.2770505

best validation loss 0.27705050993249425

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0008954895023, 'e_layers': 2, 'learning_rate': 0.0009986505957, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000960641720598717
Validation loss decreased (inf --> 0.2922).  Saving model state dict ...
Epoch: 1 cost time: 0.6176867485046387
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2921673 Best vali loss: 0.2921673
Updating learning rate to 0.0008524016019777276
Validation loss decreased (0.2922 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 0.3965020179748535
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2836989 Best vali loss: 0.2836989
Updating learning rate to 0.0006904088166979588
Epoch: 3 cost time: 0.3974580764770508
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2840747 Best vali loss: 0.2836989
Updating learning rate to 0.00049932529785
Validation loss decreased (0.2837 --> 0.2823).  Saving model state dict ...
Epoch: 4 cost time: 0.3891255855560303
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2822671 Best vali loss: 0.2822671
Updating learning rate to 0.0003082417790020412
Epoch: 5 cost time: 0.39452195167541504
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2855251 Best vali loss: 0.2822671
Updating learning rate to 0.0001462489937222724
Epoch: 6 cost time: 0.38660287857055664
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2904367 Best vali loss: 0.2822671
Updating learning rate to 3.800887510128299e-05
Epoch: 7 cost time: 0.39182400703430176
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2912433 Best vali loss: 0.2822671
Updating learning rate to 0.0
Epoch: 8 cost time: 0.38646888732910156
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2898306 Best vali loss: 0.2822671

best validation loss 0.2822671015052469

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0087947826932, 'e_layers': 4, 'learning_rate': 0.0040266549543, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2846907
	speed: 0.0104s/iter; left time: 85.8646s
	iters: 200, epoch: 1 | loss: 0.3173160
	speed: 0.0052s/iter; left time: 42.3866s
	iters: 300, epoch: 1 | loss: 0.3480344
	speed: 0.0052s/iter; left time: 41.9209s
	iters: 400, epoch: 1 | loss: 0.7495651
	speed: 0.0051s/iter; left time: 40.9860s
	iters: 500, epoch: 1 | loss: 0.8413153
	speed: 0.0050s/iter; left time: 39.0709s
	iters: 600, epoch: 1 | loss: 1.1426024
	speed: 0.0052s/iter; left time: 40.0582s
	iters: 700, epoch: 1 | loss: 1.0367771
	speed: 0.0052s/iter; left time: 39.6137s
	iters: 800, epoch: 1 | loss: 0.1748721
	speed: 0.0052s/iter; left time: 39.1079s
	iters: 900, epoch: 1 | loss: 0.5774902
	speed: 0.0052s/iter; left time: 39.1609s
	iters: 1000, epoch: 1 | loss: 0.2385695
	speed: 0.0052s/iter; left time: 38.6102s
Updating learning rate to 0.003873399525531471
Validation loss decreased (inf --> 0.3242).  Saving model state dict ...
Epoch: 1 cost time: 5.658725738525391
Epoch: 1, Steps: 1045 | Train Loss: 0.5711233 Vali Loss: 0.3242065 Best vali loss: 0.3242065
	iters: 100, epoch: 2 | loss: 0.5270913
	speed: 0.0138s/iter; left time: 99.2830s
	iters: 200, epoch: 2 | loss: 0.6421716
	speed: 0.0047s/iter; left time: 33.1336s
	iters: 300, epoch: 2 | loss: 0.2943151
	speed: 0.0046s/iter; left time: 32.6233s
	iters: 400, epoch: 2 | loss: 0.5778654
	speed: 0.0046s/iter; left time: 32.0273s
	iters: 500, epoch: 2 | loss: 0.4465812
	speed: 0.0046s/iter; left time: 31.4124s
	iters: 600, epoch: 2 | loss: 0.2064716
	speed: 0.0046s/iter; left time: 31.1631s
	iters: 700, epoch: 2 | loss: 0.2272415
	speed: 0.0047s/iter; left time: 30.8821s
	iters: 800, epoch: 2 | loss: 0.3554565
	speed: 0.0046s/iter; left time: 29.7161s
	iters: 900, epoch: 2 | loss: 0.4607174
	speed: 0.0046s/iter; left time: 29.6043s
	iters: 1000, epoch: 2 | loss: 0.3546800
	speed: 0.0046s/iter; left time: 28.8313s
Updating learning rate to 0.003436964988991969
Validation loss decreased (0.3242 --> 0.3211).  Saving model state dict ...
Epoch: 2 cost time: 4.879289627075195
Epoch: 2, Steps: 1045 | Train Loss: 0.4092592 Vali Loss: 0.3210989 Best vali loss: 0.3210989
	iters: 100, epoch: 3 | loss: 1.3608751
	speed: 0.0142s/iter; left time: 87.5843s
	iters: 200, epoch: 3 | loss: 0.8050646
	speed: 0.0050s/iter; left time: 30.2310s
	iters: 300, epoch: 3 | loss: 0.2828760
	speed: 0.0050s/iter; left time: 29.7368s
	iters: 400, epoch: 3 | loss: 1.5161331
	speed: 0.0050s/iter; left time: 29.2351s
	iters: 500, epoch: 3 | loss: 0.4978735
	speed: 0.0050s/iter; left time: 28.6149s
	iters: 600, epoch: 3 | loss: 0.3758378
	speed: 0.0050s/iter; left time: 28.4129s
	iters: 700, epoch: 3 | loss: 1.4277505
	speed: 0.0050s/iter; left time: 27.6871s
	iters: 800, epoch: 3 | loss: 0.3472157
	speed: 0.0050s/iter; left time: 27.3169s
	iters: 900, epoch: 3 | loss: 0.2763341
	speed: 0.0049s/iter; left time: 26.5179s
	iters: 1000, epoch: 3 | loss: 1.0361792
	speed: 0.0050s/iter; left time: 26.1511s
Updating learning rate to 0.002783794546580709
Epoch: 3 cost time: 5.230258464813232
Epoch: 3, Steps: 1045 | Train Loss: 0.7926140 Vali Loss: 0.3234177 Best vali loss: 0.3210989
	iters: 100, epoch: 4 | loss: 0.9856482
	speed: 0.0140s/iter; left time: 71.7757s
	iters: 200, epoch: 4 | loss: 0.3836271
	speed: 0.0051s/iter; left time: 25.4760s
	iters: 300, epoch: 4 | loss: 0.4499394
	speed: 0.0051s/iter; left time: 25.1370s
	iters: 400, epoch: 4 | loss: 0.5414765
	speed: 0.0051s/iter; left time: 24.6355s
	iters: 500, epoch: 4 | loss: 0.2312357
	speed: 0.0049s/iter; left time: 23.3861s
	iters: 600, epoch: 4 | loss: 0.2671972
	speed: 0.0049s/iter; left time: 22.6157s
	iters: 700, epoch: 4 | loss: 0.5574272
	speed: 0.0048s/iter; left time: 21.8091s
	iters: 800, epoch: 4 | loss: 0.5731205
	speed: 0.0047s/iter; left time: 20.8300s
	iters: 900, epoch: 4 | loss: 0.7420677
	speed: 0.0046s/iter; left time: 19.8120s
	iters: 1000, epoch: 4 | loss: 0.2994133
	speed: 0.0046s/iter; left time: 19.5757s
Updating learning rate to 0.00201332747715
Epoch: 4 cost time: 5.144326448440552
Epoch: 4, Steps: 1045 | Train Loss: 0.5031153 Vali Loss: 0.3211974 Best vali loss: 0.3210989
	iters: 100, epoch: 5 | loss: 0.1307081
	speed: 0.0132s/iter; left time: 53.6852s
	iters: 200, epoch: 5 | loss: 0.6232263
	speed: 0.0046s/iter; left time: 18.1560s
	iters: 300, epoch: 5 | loss: 0.1627568
	speed: 0.0046s/iter; left time: 17.8253s
	iters: 400, epoch: 5 | loss: 0.2941037
	speed: 0.0047s/iter; left time: 17.9108s
	iters: 500, epoch: 5 | loss: 0.9312203
	speed: 0.0048s/iter; left time: 17.7114s
	iters: 600, epoch: 5 | loss: 0.3597752
	speed: 0.0048s/iter; left time: 17.2192s
	iters: 700, epoch: 5 | loss: 0.4569238
	speed: 0.0047s/iter; left time: 16.3786s
	iters: 800, epoch: 5 | loss: 0.2751853
	speed: 0.0045s/iter; left time: 15.1727s
	iters: 900, epoch: 5 | loss: 0.2361556
	speed: 0.0045s/iter; left time: 14.8179s
	iters: 1000, epoch: 5 | loss: 0.2732218
	speed: 0.0045s/iter; left time: 14.3305s
Updating learning rate to 0.0012428604077192914
Epoch: 5 cost time: 4.8540661334991455
Epoch: 5, Steps: 1045 | Train Loss: 0.3743277 Vali Loss: 0.3221949 Best vali loss: 0.3210989
	iters: 100, epoch: 6 | loss: 0.4051883
	speed: 0.0139s/iter; left time: 42.1529s
	iters: 200, epoch: 6 | loss: 0.2339556
	speed: 0.0048s/iter; left time: 14.2358s
	iters: 300, epoch: 6 | loss: 0.3317961
	speed: 0.0048s/iter; left time: 13.6838s
	iters: 400, epoch: 6 | loss: 1.7512778
	speed: 0.0048s/iter; left time: 13.2128s
	iters: 500, epoch: 6 | loss: 1.1287345
	speed: 0.0048s/iter; left time: 12.7309s
	iters: 600, epoch: 6 | loss: 0.2045872
	speed: 0.0048s/iter; left time: 12.2519s
	iters: 700, epoch: 6 | loss: 0.5436622
	speed: 0.0049s/iter; left time: 11.8232s
	iters: 800, epoch: 6 | loss: 1.0837516
	speed: 0.0048s/iter; left time: 11.1648s
	iters: 900, epoch: 6 | loss: 0.5434133
	speed: 0.0048s/iter; left time: 10.7685s
	iters: 1000, epoch: 6 | loss: 1.4345833
	speed: 0.0048s/iter; left time: 10.3253s
Updating learning rate to 0.0005896899653080313
Epoch: 6 cost time: 5.087108135223389
Epoch: 6, Steps: 1045 | Train Loss: 0.7660950 Vali Loss: 0.3231844 Best vali loss: 0.3210989
	iters: 100, epoch: 7 | loss: 0.3775670
	speed: 0.0135s/iter; left time: 26.8279s
	iters: 200, epoch: 7 | loss: 1.2004409
	speed: 0.0049s/iter; left time: 9.2050s
	iters: 300, epoch: 7 | loss: 0.4533810
	speed: 0.0048s/iter; left time: 8.6301s
	iters: 400, epoch: 7 | loss: 0.2850239
	speed: 0.0048s/iter; left time: 8.0659s
	iters: 500, epoch: 7 | loss: 0.3894712
	speed: 0.0048s/iter; left time: 7.6704s
	iters: 600, epoch: 7 | loss: 0.3347971
	speed: 0.0048s/iter; left time: 7.2286s
	iters: 700, epoch: 7 | loss: 0.4000373
	speed: 0.0049s/iter; left time: 6.7844s
	iters: 800, epoch: 7 | loss: 1.7998407
	speed: 0.0049s/iter; left time: 6.3018s
	iters: 900, epoch: 7 | loss: 0.4510243
	speed: 0.0049s/iter; left time: 5.8616s
	iters: 1000, epoch: 7 | loss: 0.2768415
	speed: 0.0048s/iter; left time: 5.2470s
Updating learning rate to 0.00015325542876852967
Epoch: 7 cost time: 5.087031126022339
Epoch: 7, Steps: 1045 | Train Loss: 0.5968425 Vali Loss: 0.3217718 Best vali loss: 0.3210989
	iters: 100, epoch: 8 | loss: 1.1355541
	speed: 0.0134s/iter; left time: 12.6986s
	iters: 200, epoch: 8 | loss: 0.5699041
	speed: 0.0048s/iter; left time: 4.0745s
	iters: 300, epoch: 8 | loss: 0.4245892
	speed: 0.0048s/iter; left time: 3.6168s
	iters: 400, epoch: 8 | loss: 0.4722903
	speed: 0.0048s/iter; left time: 3.1331s
	iters: 500, epoch: 8 | loss: 1.7360240
	speed: 0.0048s/iter; left time: 2.6433s
	iters: 600, epoch: 8 | loss: 0.5179615
	speed: 0.0048s/iter; left time: 2.1497s
	iters: 700, epoch: 8 | loss: 0.5853241
	speed: 0.0049s/iter; left time: 1.6819s
	iters: 800, epoch: 8 | loss: 0.9425938
	speed: 0.0049s/iter; left time: 1.2028s
	iters: 900, epoch: 8 | loss: 0.4061938
	speed: 0.0049s/iter; left time: 0.7114s
	iters: 1000, epoch: 8 | loss: 0.2230360
	speed: 0.0049s/iter; left time: 0.2268s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.102239370346069
Epoch: 8, Steps: 1045 | Train Loss: 0.7013471 Vali Loss: 0.3222299 Best vali loss: 0.3210989

best validation loss 0.32109893650071425

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020928988109, 'e_layers': 3, 'learning_rate': 0.000264517567, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4543695
	speed: 0.0098s/iter; left time: 39.9340s
	iters: 200, epoch: 1 | loss: 0.8823155
	speed: 0.0044s/iter; left time: 17.6812s
	iters: 300, epoch: 1 | loss: 0.4341738
	speed: 0.0044s/iter; left time: 17.2223s
	iters: 400, epoch: 1 | loss: 0.6764573
	speed: 0.0044s/iter; left time: 16.6937s
	iters: 500, epoch: 1 | loss: 0.3656718
	speed: 0.0044s/iter; left time: 16.2603s
Updating learning rate to 0.00025444996657049147
Validation loss decreased (inf --> 0.2774).  Saving model state dict ...
Epoch: 1 cost time: 2.5780975818634033
Epoch: 1, Steps: 523 | Train Loss: 0.5625976 Vali Loss: 0.2773934 Best vali loss: 0.2773934
	iters: 100, epoch: 2 | loss: 0.4850692
	speed: 0.0093s/iter; left time: 33.2236s
	iters: 200, epoch: 2 | loss: 0.2567017
	speed: 0.0045s/iter; left time: 15.4573s
	iters: 300, epoch: 2 | loss: 0.4793781
	speed: 0.0044s/iter; left time: 14.9324s
	iters: 400, epoch: 2 | loss: 0.3057930
	speed: 0.0045s/iter; left time: 14.5885s
	iters: 500, epoch: 2 | loss: 0.4736151
	speed: 0.0044s/iter; left time: 14.0292s
Updating learning rate to 0.00022577986618433344
Epoch: 2 cost time: 2.3728625774383545
Epoch: 2, Steps: 523 | Train Loss: 0.4001114 Vali Loss: 0.2964078 Best vali loss: 0.2773934
	iters: 100, epoch: 3 | loss: 0.1987953
	speed: 0.0088s/iter; left time: 26.8343s
	iters: 200, epoch: 3 | loss: 0.3950395
	speed: 0.0043s/iter; left time: 12.7127s
	iters: 300, epoch: 3 | loss: 0.1997494
	speed: 0.0044s/iter; left time: 12.4014s
	iters: 400, epoch: 3 | loss: 0.3595524
	speed: 0.0043s/iter; left time: 11.8741s
	iters: 500, epoch: 3 | loss: 0.3441978
	speed: 0.0044s/iter; left time: 11.5990s
Updating learning rate to 0.0001828720287302113
Epoch: 3 cost time: 2.314729690551758
Epoch: 3, Steps: 523 | Train Loss: 0.2994669 Vali Loss: 0.2884043 Best vali loss: 0.2773934

best validation loss 0.2773934197624229

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270181439, 'e_layers': 2, 'learning_rate': 0.0002345343479, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5597149
	speed: 0.0105s/iter; left time: 9.9711s
Updating learning rate to 0.0002345343479
Validation loss decreased (inf --> 0.2756).  Saving model state dict ...
Epoch: 1 cost time: 0.9269938468933105
Epoch: 1, Steps: 131 | Train Loss: 0.5597149 Vali Loss: 0.2756418 Best vali loss: 0.2756418
	iters: 100, epoch: 2 | loss: 0.3252136
	speed: 0.0088s/iter; left time: 7.2211s
Updating learning rate to 0.00011726717395
Validation loss decreased (0.2756 --> 0.2723).  Saving model state dict ...
Epoch: 2 cost time: 0.6919834613800049
Epoch: 2, Steps: 131 | Train Loss: 0.3252136 Vali Loss: 0.2723261 Best vali loss: 0.2723261
	iters: 100, epoch: 3 | loss: 0.4637052
	speed: 0.0089s/iter; left time: 6.0858s
Updating learning rate to 5.8633586975e-05
Epoch: 3 cost time: 0.7028214931488037
Epoch: 3, Steps: 131 | Train Loss: 0.4637052 Vali Loss: 0.2751016 Best vali loss: 0.2723261

best validation loss 0.27232613914648635

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0047222108893, 'e_layers': 3, 'learning_rate': 0.0004720554825, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5202304
	speed: 0.0121s/iter; left time: 11.4883s
Updating learning rate to 0.0004720554825
Validation loss decreased (inf --> 0.2709).  Saving model state dict ...
Epoch: 1 cost time: 1.141176462173462
Epoch: 1, Steps: 131 | Train Loss: 0.5202304 Vali Loss: 0.2708796 Best vali loss: 0.2708796
	iters: 100, epoch: 2 | loss: 0.5403935
	speed: 0.0114s/iter; left time: 9.2980s
Updating learning rate to 0.00023602774125
Epoch: 2 cost time: 0.9092981815338135
Epoch: 2, Steps: 131 | Train Loss: 0.5403935 Vali Loss: 0.2799545 Best vali loss: 0.2708796
	iters: 100, epoch: 3 | loss: 0.5010159
	speed: 0.0110s/iter; left time: 7.5690s
Updating learning rate to 0.000118013870625
Epoch: 3 cost time: 0.910855770111084
Epoch: 3, Steps: 131 | Train Loss: 0.5010159 Vali Loss: 0.2854802 Best vali loss: 0.2708796

best validation loss 0.2708795610558991

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0047222108893, 'e_layers': 3, 'learning_rate': 0.0004720554825, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3238866
	speed: 0.0124s/iter; left time: 6.8866s
Updating learning rate to 5.90069353125e-05
Epoch: 4 cost time: 1.1436185836791992
Epoch: 4, Steps: 131 | Train Loss: 0.3238866 Vali Loss: 0.2831505 Best vali loss: 0.2708796
	iters: 100, epoch: 5 | loss: 0.3256371
	speed: 0.0111s/iter; left time: 4.7192s
Updating learning rate to 2.950346765625e-05
Epoch: 5 cost time: 0.9184322357177734
Epoch: 5, Steps: 131 | Train Loss: 0.3256371 Vali Loss: 0.2820610 Best vali loss: 0.2708796
	iters: 100, epoch: 6 | loss: 0.3695572
	speed: 0.0110s/iter; left time: 3.2486s
Updating learning rate to 1.4751733828125e-05
Epoch: 6 cost time: 0.9122974872589111
Epoch: 6, Steps: 131 | Train Loss: 0.3695572 Vali Loss: 0.2847847 Best vali loss: 0.2708796
	iters: 100, epoch: 7 | loss: 0.2813866
	speed: 0.0110s/iter; left time: 1.7889s
Updating learning rate to 7.3758669140625e-06
Epoch: 7 cost time: 0.9095730781555176
Epoch: 7, Steps: 131 | Train Loss: 0.2813866 Vali Loss: 0.2844764 Best vali loss: 0.2708796
	iters: 100, epoch: 8 | loss: 0.2959281
	speed: 0.0110s/iter; left time: 0.3521s
Updating learning rate to 3.68793345703125e-06
Epoch: 8 cost time: 0.9114894866943359
Epoch: 8, Steps: 131 | Train Loss: 0.2959281 Vali Loss: 0.2844371 Best vali loss: 0.2708796

best validation loss 0.2708795610558991

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345269612, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7634003
	speed: 0.0089s/iter; left time: 36.3204s
	iters: 200, epoch: 1 | loss: 0.4921808
	speed: 0.0034s/iter; left time: 13.4091s
	iters: 300, epoch: 1 | loss: 0.7027397
	speed: 0.0033s/iter; left time: 12.7492s
	iters: 400, epoch: 1 | loss: 0.6618288
	speed: 0.0033s/iter; left time: 12.4610s
	iters: 500, epoch: 1 | loss: 0.4262041
	speed: 0.0033s/iter; left time: 12.1511s
Updating learning rate to 0.0002345269612
Validation loss decreased (inf --> 0.3029).  Saving model state dict ...
Epoch: 1 cost time: 2.023240804672241
Epoch: 1, Steps: 523 | Train Loss: 0.6092707 Vali Loss: 0.3029413 Best vali loss: 0.3029413
	iters: 100, epoch: 2 | loss: 0.3342353
	speed: 0.0080s/iter; left time: 28.3755s
	iters: 200, epoch: 2 | loss: 0.5835950
	speed: 0.0034s/iter; left time: 11.8591s
	iters: 300, epoch: 2 | loss: 0.2659121
	speed: 0.0034s/iter; left time: 11.2964s
	iters: 400, epoch: 2 | loss: 0.2959126
	speed: 0.0033s/iter; left time: 10.9110s
	iters: 500, epoch: 2 | loss: 0.4805759
	speed: 0.0034s/iter; left time: 10.6199s
Updating learning rate to 0.0001172634806
Validation loss decreased (0.3029 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 1.8171367645263672
Epoch: 2, Steps: 523 | Train Loss: 0.3920462 Vali Loss: 0.2808326 Best vali loss: 0.2808326
	iters: 100, epoch: 3 | loss: 0.4232666
	speed: 0.0075s/iter; left time: 22.6547s
	iters: 200, epoch: 3 | loss: 0.2470868
	speed: 0.0030s/iter; left time: 8.8421s
	iters: 300, epoch: 3 | loss: 0.2176273
	speed: 0.0030s/iter; left time: 8.5247s
	iters: 400, epoch: 3 | loss: 0.5963046
	speed: 0.0030s/iter; left time: 8.2178s
	iters: 500, epoch: 3 | loss: 0.3955803
	speed: 0.0030s/iter; left time: 7.9461s
Updating learning rate to 5.86317403e-05
Epoch: 3 cost time: 1.6081466674804688
Epoch: 3, Steps: 523 | Train Loss: 0.3759731 Vali Loss: 0.2858096 Best vali loss: 0.2808326
	iters: 100, epoch: 4 | loss: 0.4725237
	speed: 0.0070s/iter; left time: 17.5833s
	iters: 200, epoch: 4 | loss: 0.4349180
	speed: 0.0031s/iter; left time: 7.4913s
	iters: 300, epoch: 4 | loss: 0.5648857
	speed: 0.0031s/iter; left time: 7.2017s
	iters: 400, epoch: 4 | loss: 0.5838951
	speed: 0.0031s/iter; left time: 6.8083s
	iters: 500, epoch: 4 | loss: 0.3686862
	speed: 0.0032s/iter; left time: 6.8600s
Updating learning rate to 2.931587015e-05
Epoch: 4 cost time: 1.6635479927062988
Epoch: 4, Steps: 523 | Train Loss: 0.4849817 Vali Loss: 0.2902966 Best vali loss: 0.2808326
	iters: 100, epoch: 5 | loss: 0.3723856
	speed: 0.0073s/iter; left time: 14.4915s
	iters: 200, epoch: 5 | loss: 0.5148296
	speed: 0.0034s/iter; left time: 6.4451s
	iters: 300, epoch: 5 | loss: 0.3058169
	speed: 0.0034s/iter; left time: 6.0468s
	iters: 400, epoch: 5 | loss: 0.2395094
	speed: 0.0034s/iter; left time: 5.6767s
	iters: 500, epoch: 5 | loss: 0.5624132
	speed: 0.0033s/iter; left time: 5.1971s
Updating learning rate to 1.4657935075e-05
Epoch: 5 cost time: 1.7722387313842773
Epoch: 5, Steps: 523 | Train Loss: 0.3989909 Vali Loss: 0.2852051 Best vali loss: 0.2808326
	iters: 100, epoch: 6 | loss: 0.2389901
	speed: 0.0077s/iter; left time: 11.3267s
	iters: 200, epoch: 6 | loss: 0.3859635
	speed: 0.0035s/iter; left time: 4.8438s
	iters: 300, epoch: 6 | loss: 0.5230473
	speed: 0.0035s/iter; left time: 4.4286s
	iters: 400, epoch: 6 | loss: 0.2052750
	speed: 0.0035s/iter; left time: 4.0804s
	iters: 500, epoch: 6 | loss: 0.3384547
	speed: 0.0035s/iter; left time: 3.7248s
Updating learning rate to 7.3289675375e-06
Epoch: 6 cost time: 1.8733634948730469
Epoch: 6, Steps: 523 | Train Loss: 0.3383461 Vali Loss: 0.2886416 Best vali loss: 0.2808326
	iters: 100, epoch: 7 | loss: 0.6970357
	speed: 0.0076s/iter; left time: 7.2385s
	iters: 200, epoch: 7 | loss: 0.2088422
	speed: 0.0034s/iter; left time: 2.8538s
	iters: 300, epoch: 7 | loss: 0.4322837
	speed: 0.0033s/iter; left time: 2.4845s
	iters: 400, epoch: 7 | loss: 0.3913977
	speed: 0.0033s/iter; left time: 2.1363s
	iters: 500, epoch: 7 | loss: 0.3314859
	speed: 0.0033s/iter; left time: 1.8227s
Updating learning rate to 3.66448376875e-06
Epoch: 7 cost time: 1.7858374118804932
Epoch: 7, Steps: 523 | Train Loss: 0.4122091 Vali Loss: 0.2891214 Best vali loss: 0.2808326
	iters: 100, epoch: 8 | loss: 0.3203849
	speed: 0.0074s/iter; left time: 3.1271s
	iters: 200, epoch: 8 | loss: 0.2770013
	speed: 0.0030s/iter; left time: 0.9754s
	iters: 300, epoch: 8 | loss: 0.3418670
	speed: 0.0033s/iter; left time: 0.7435s
	iters: 400, epoch: 8 | loss: 0.2317609
	speed: 0.0033s/iter; left time: 0.4065s
	iters: 500, epoch: 8 | loss: 0.5699337
	speed: 0.0029s/iter; left time: 0.0707s
Updating learning rate to 1.832241884375e-06
Epoch: 8 cost time: 1.6647005081176758
Epoch: 8, Steps: 523 | Train Loss: 0.3481896 Vali Loss: 0.2927453 Best vali loss: 0.2808326

best validation loss 0.28083262376157536

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008677627478, 'e_layers': 2, 'learning_rate': 0.0005021448673, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5165262
	speed: 0.0086s/iter; left time: 35.1978s
	iters: 200, epoch: 1 | loss: 0.6595216
	speed: 0.0034s/iter; left time: 13.6844s
	iters: 300, epoch: 1 | loss: 0.3490475
	speed: 0.0035s/iter; left time: 13.4886s
	iters: 400, epoch: 1 | loss: 1.1740029
	speed: 0.0035s/iter; left time: 13.2415s
	iters: 500, epoch: 1 | loss: 0.3544645
	speed: 0.0035s/iter; left time: 12.9152s
Updating learning rate to 0.00048303311627703304
Validation loss decreased (inf --> 0.3032).  Saving model state dict ...
Epoch: 1 cost time: 2.055624008178711
Epoch: 1, Steps: 523 | Train Loss: 0.6107125 Vali Loss: 0.3032042 Best vali loss: 0.3032042
	iters: 100, epoch: 2 | loss: 0.3750974
	speed: 0.0079s/iter; left time: 28.0412s
	iters: 200, epoch: 2 | loss: 0.3678662
	speed: 0.0035s/iter; left time: 12.0459s
	iters: 300, epoch: 2 | loss: 0.4678001
	speed: 0.0035s/iter; left time: 11.6085s
	iters: 400, epoch: 2 | loss: 0.7700646
	speed: 0.0035s/iter; left time: 11.2891s
	iters: 500, epoch: 2 | loss: 0.6964511
	speed: 0.0035s/iter; left time: 11.0582s
Updating learning rate to 0.0004286074540529245
Validation loss decreased (0.3032 --> 0.2940).  Saving model state dict ...
Epoch: 2 cost time: 1.8564538955688477
Epoch: 2, Steps: 523 | Train Loss: 0.5354559 Vali Loss: 0.2939779 Best vali loss: 0.2939779
	iters: 100, epoch: 3 | loss: 1.2567147
	speed: 0.0080s/iter; left time: 24.2333s
	iters: 200, epoch: 3 | loss: 0.4253116
	speed: 0.0035s/iter; left time: 10.3026s
	iters: 300, epoch: 3 | loss: 0.4037613
	speed: 0.0035s/iter; left time: 9.8348s
	iters: 400, epoch: 3 | loss: 0.2813283
	speed: 0.0035s/iter; left time: 9.5863s
	iters: 500, epoch: 3 | loss: 0.3705602
	speed: 0.0035s/iter; left time: 9.2341s
Updating learning rate to 0.00034715369433143827
Validation loss decreased (0.2940 --> 0.2883).  Saving model state dict ...
Epoch: 3 cost time: 1.8626728057861328
Epoch: 3, Steps: 523 | Train Loss: 0.5475352 Vali Loss: 0.2883084 Best vali loss: 0.2883084
	iters: 100, epoch: 4 | loss: 0.4075561
	speed: 0.0080s/iter; left time: 20.1207s
	iters: 200, epoch: 4 | loss: 0.4117975
	speed: 0.0035s/iter; left time: 8.4427s
	iters: 300, epoch: 4 | loss: 0.6637008
	speed: 0.0035s/iter; left time: 8.0804s
	iters: 400, epoch: 4 | loss: 0.3898803
	speed: 0.0035s/iter; left time: 7.6916s
	iters: 500, epoch: 4 | loss: 0.2272607
	speed: 0.0034s/iter; left time: 7.1425s
Updating learning rate to 0.00025107243365
Validation loss decreased (0.2883 --> 0.2878).  Saving model state dict ...
Epoch: 4 cost time: 1.8488080501556396
Epoch: 4, Steps: 523 | Train Loss: 0.4200391 Vali Loss: 0.2878473 Best vali loss: 0.2878473
	iters: 100, epoch: 5 | loss: 0.2820901
	speed: 0.0076s/iter; left time: 15.1460s
	iters: 200, epoch: 5 | loss: 0.2221170
	speed: 0.0030s/iter; left time: 5.7563s
	iters: 300, epoch: 5 | loss: 0.3487299
	speed: 0.0030s/iter; left time: 5.4523s
	iters: 400, epoch: 5 | loss: 1.0037501
	speed: 0.0033s/iter; left time: 5.6332s
	iters: 500, epoch: 5 | loss: 0.2561533
	speed: 0.0033s/iter; left time: 5.3138s
Updating learning rate to 0.00015499117296856175
Epoch: 5 cost time: 1.6939406394958496
Epoch: 5, Steps: 523 | Train Loss: 0.4225681 Vali Loss: 0.2982204 Best vali loss: 0.2878473
	iters: 100, epoch: 6 | loss: 0.2245151
	speed: 0.0076s/iter; left time: 11.1498s
	iters: 200, epoch: 6 | loss: 0.2015743
	speed: 0.0033s/iter; left time: 4.5699s
	iters: 300, epoch: 6 | loss: 0.6592283
	speed: 0.0033s/iter; left time: 4.2389s
	iters: 400, epoch: 6 | loss: 0.3745086
	speed: 0.0033s/iter; left time: 3.8995s
	iters: 500, epoch: 6 | loss: 0.5038258
	speed: 0.0033s/iter; left time: 3.5783s
Updating learning rate to 7.353741324707549e-05
Epoch: 6 cost time: 1.7858099937438965
Epoch: 6, Steps: 523 | Train Loss: 0.3927304 Vali Loss: 0.3005211 Best vali loss: 0.2878473
	iters: 100, epoch: 7 | loss: 0.6180816
	speed: 0.0071s/iter; left time: 6.7634s
	iters: 200, epoch: 7 | loss: 0.1785360
	speed: 0.0031s/iter; left time: 2.6371s
	iters: 300, epoch: 7 | loss: 0.2413815
	speed: 0.0031s/iter; left time: 2.3519s
	iters: 400, epoch: 7 | loss: 0.3392442
	speed: 0.0031s/iter; left time: 2.0314s
	iters: 500, epoch: 7 | loss: 0.3204474
	speed: 0.0031s/iter; left time: 1.7066s
Updating learning rate to 1.911175102296694e-05
Epoch: 7 cost time: 1.6702549457550049
Epoch: 7, Steps: 523 | Train Loss: 0.3395382 Vali Loss: 0.3081530 Best vali loss: 0.2878473
	iters: 100, epoch: 8 | loss: 0.1821274
	speed: 0.0076s/iter; left time: 3.2276s
	iters: 200, epoch: 8 | loss: 0.6641302
	speed: 0.0033s/iter; left time: 1.0695s
	iters: 300, epoch: 8 | loss: 0.7545920
	speed: 0.0033s/iter; left time: 0.7406s
	iters: 400, epoch: 8 | loss: 0.4253075
	speed: 0.0033s/iter; left time: 0.4125s
	iters: 500, epoch: 8 | loss: 0.4102322
	speed: 0.0033s/iter; left time: 0.0796s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7765426635742188
Epoch: 8, Steps: 523 | Train Loss: 0.4872778 Vali Loss: 0.3080339 Best vali loss: 0.2878473

best validation loss 0.2878472953037331

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012916055723, 'e_layers': 3, 'learning_rate': 0.0004972665107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6103103
	speed: 0.0097s/iter; left time: 39.6592s
	iters: 200, epoch: 1 | loss: 0.5139299
	speed: 0.0045s/iter; left time: 17.9009s
	iters: 300, epoch: 1 | loss: 0.3632602
	speed: 0.0045s/iter; left time: 17.3761s
	iters: 400, epoch: 1 | loss: 0.2120567
	speed: 0.0045s/iter; left time: 16.9580s
	iters: 500, epoch: 1 | loss: 0.6629137
	speed: 0.0045s/iter; left time: 16.5213s
Updating learning rate to 0.0004783404310695174
Validation loss decreased (inf --> 0.3124).  Saving model state dict ...
Epoch: 1 cost time: 2.605607748031616
Epoch: 1, Steps: 523 | Train Loss: 0.4724942 Vali Loss: 0.3123580 Best vali loss: 0.3123580
	iters: 100, epoch: 2 | loss: 0.6123435
	speed: 0.0096s/iter; left time: 34.3710s
	iters: 200, epoch: 2 | loss: 0.4172230
	speed: 0.0042s/iter; left time: 14.6052s
	iters: 300, epoch: 2 | loss: 0.8219343
	speed: 0.0042s/iter; left time: 14.2802s
	iters: 400, epoch: 2 | loss: 0.2782086
	speed: 0.0043s/iter; left time: 13.8877s
	iters: 500, epoch: 2 | loss: 0.6473418
	speed: 0.0042s/iter; left time: 13.3867s
Updating learning rate to 0.0004244435162364714
Validation loss decreased (0.3124 --> 0.3093).  Saving model state dict ...
Epoch: 2 cost time: 2.2606635093688965
Epoch: 2, Steps: 523 | Train Loss: 0.5554102 Vali Loss: 0.3092706 Best vali loss: 0.3092706
	iters: 100, epoch: 3 | loss: 0.3358275
	speed: 0.0097s/iter; left time: 29.4863s
	iters: 200, epoch: 3 | loss: 0.6760706
	speed: 0.0042s/iter; left time: 12.4887s
	iters: 300, epoch: 3 | loss: 0.2583795
	speed: 0.0042s/iter; left time: 11.9954s
	iters: 400, epoch: 3 | loss: 0.7595082
	speed: 0.0042s/iter; left time: 11.5580s
	iters: 500, epoch: 3 | loss: 0.3425969
	speed: 0.0042s/iter; left time: 11.0833s
Updating learning rate to 0.0003437810829074438
Validation loss decreased (0.3093 --> 0.2972).  Saving model state dict ...
Epoch: 3 cost time: 2.243250846862793
Epoch: 3, Steps: 523 | Train Loss: 0.4744766 Vali Loss: 0.2972457 Best vali loss: 0.2972457

best validation loss 0.297245725496146

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0018358837111, 'e_layers': 2, 'learning_rate': 0.0023547782314, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6205333
	speed: 0.0087s/iter; left time: 17.3488s
	iters: 200, epoch: 1 | loss: 0.4984509
	speed: 0.0032s/iter; left time: 6.1226s
Updating learning rate to 0.0023547782314
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 1.1232292652130127
Epoch: 1, Steps: 262 | Train Loss: 0.5594921 Vali Loss: 0.2853112 Best vali loss: 0.2853112
	iters: 100, epoch: 2 | loss: 0.3143011
	speed: 0.0077s/iter; left time: 13.3898s
	iters: 200, epoch: 2 | loss: 0.6224896
	speed: 0.0035s/iter; left time: 5.6715s
Updating learning rate to 0.0011773891157
Validation loss decreased (0.2853 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 0.9407944679260254
Epoch: 2, Steps: 262 | Train Loss: 0.4683954 Vali Loss: 0.2839488 Best vali loss: 0.2839488
	iters: 100, epoch: 3 | loss: 0.7953506
	speed: 0.0078s/iter; left time: 11.4585s
	iters: 200, epoch: 3 | loss: 0.1997490
	speed: 0.0033s/iter; left time: 4.5536s
Updating learning rate to 0.00058869455785
Epoch: 3 cost time: 0.9210278987884521
Epoch: 3, Steps: 262 | Train Loss: 0.4975498 Vali Loss: 0.2904660 Best vali loss: 0.2839488

best validation loss 0.2839488342581694

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0093370414058, 'e_layers': 2, 'learning_rate': 0.0004835519265, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7962347
	speed: 0.0090s/iter; left time: 36.7678s
	iters: 200, epoch: 1 | loss: 0.5014771
	speed: 0.0035s/iter; left time: 14.0183s
	iters: 300, epoch: 1 | loss: 0.7060577
	speed: 0.0034s/iter; left time: 13.4014s
	iters: 400, epoch: 1 | loss: 0.6915987
	speed: 0.0035s/iter; left time: 13.0754s
	iters: 500, epoch: 1 | loss: 0.4293674
	speed: 0.0035s/iter; left time: 12.9732s
Updating learning rate to 0.00046514782714987606
Validation loss decreased (inf --> 0.3012).  Saving model state dict ...
Epoch: 1 cost time: 2.0987234115600586
Epoch: 1, Steps: 523 | Train Loss: 0.6249471 Vali Loss: 0.3011992 Best vali loss: 0.3011992
	iters: 100, epoch: 2 | loss: 0.3919692
	speed: 0.0077s/iter; left time: 27.2535s
	iters: 200, epoch: 2 | loss: 0.6235882
	speed: 0.0030s/iter; left time: 10.4199s
	iters: 300, epoch: 2 | loss: 0.2958551
	speed: 0.0030s/iter; left time: 10.2044s
	iters: 400, epoch: 2 | loss: 0.4223453
	speed: 0.0030s/iter; left time: 9.8081s
	iters: 500, epoch: 2 | loss: 0.6132372
	speed: 0.0030s/iter; left time: 9.5498s
Updating learning rate to 0.00041273738639198453
Validation loss decreased (0.3012 --> 0.2905).  Saving model state dict ...
Epoch: 2 cost time: 1.6196532249450684
Epoch: 2, Steps: 523 | Train Loss: 0.4693990 Vali Loss: 0.2905448 Best vali loss: 0.2905448
	iters: 100, epoch: 3 | loss: 0.5015500
	speed: 0.0079s/iter; left time: 23.8656s
	iters: 200, epoch: 3 | loss: 0.4450611
	speed: 0.0035s/iter; left time: 10.1561s
	iters: 300, epoch: 3 | loss: 0.2292529
	speed: 0.0035s/iter; left time: 10.0201s
	iters: 400, epoch: 3 | loss: 0.8661745
	speed: 0.0036s/iter; left time: 9.7490s
	iters: 500, epoch: 3 | loss: 0.4969531
	speed: 0.0034s/iter; left time: 8.9307s
Updating learning rate to 0.0003342996187298858
Validation loss decreased (0.2905 --> 0.2864).  Saving model state dict ...
Epoch: 3 cost time: 1.8297696113586426
Epoch: 3, Steps: 523 | Train Loss: 0.5077983 Vali Loss: 0.2864485 Best vali loss: 0.2864485

best validation loss 0.28644853848070406

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0018358837111, 'e_layers': 2, 'learning_rate': 0.0023547782314, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5593317
	speed: 0.0089s/iter; left time: 10.7343s
	iters: 200, epoch: 4 | loss: 0.4216382
	speed: 0.0035s/iter; left time: 3.8773s
Updating learning rate to 0.000294347278925
Epoch: 4 cost time: 1.1688904762268066
Epoch: 4, Steps: 262 | Train Loss: 0.4904849 Vali Loss: 0.2963508 Best vali loss: 0.2839488
	iters: 100, epoch: 5 | loss: 0.3144546
	speed: 0.0079s/iter; left time: 7.5040s
	iters: 200, epoch: 5 | loss: 0.5350842
	speed: 0.0035s/iter; left time: 2.9660s
Updating learning rate to 0.0001471736394625
Epoch: 5 cost time: 0.9666216373443604
Epoch: 5, Steps: 262 | Train Loss: 0.4247694 Vali Loss: 0.2979687 Best vali loss: 0.2839488
	iters: 100, epoch: 6 | loss: 0.6931164
	speed: 0.0080s/iter; left time: 5.4929s
	iters: 200, epoch: 6 | loss: 0.1949213
	speed: 0.0034s/iter; left time: 1.9990s
Updating learning rate to 7.358681973125e-05
Epoch: 6 cost time: 0.9606993198394775
Epoch: 6, Steps: 262 | Train Loss: 0.4440188 Vali Loss: 0.3043943 Best vali loss: 0.2839488
	iters: 100, epoch: 7 | loss: 0.9162700
	speed: 0.0078s/iter; left time: 3.3096s
	iters: 200, epoch: 7 | loss: 0.2818150
	speed: 0.0033s/iter; left time: 1.0795s
Updating learning rate to 3.6793409865625e-05
Epoch: 7 cost time: 0.9151430130004883
Epoch: 7, Steps: 262 | Train Loss: 0.5990425 Vali Loss: 0.3015704 Best vali loss: 0.2839488
	iters: 100, epoch: 8 | loss: 0.3684988
	speed: 0.0076s/iter; left time: 1.2356s
	iters: 200, epoch: 8 | loss: 0.4599521
	speed: 0.0033s/iter; left time: 0.2048s
Updating learning rate to 1.83967049328125e-05
Epoch: 8 cost time: 0.8829443454742432
Epoch: 8, Steps: 262 | Train Loss: 0.4142255 Vali Loss: 0.3023102 Best vali loss: 0.2839488

best validation loss 0.2839488342581694

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0093874033296, 'e_layers': 2, 'learning_rate': 0.0004374442841, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8048466
	speed: 0.0077s/iter; left time: 31.6497s
	iters: 200, epoch: 1 | loss: 0.3638099
	speed: 0.0034s/iter; left time: 13.3729s
	iters: 300, epoch: 1 | loss: 0.7419602
	speed: 0.0034s/iter; left time: 13.0936s
	iters: 400, epoch: 1 | loss: 0.5773844
	speed: 0.0034s/iter; left time: 12.8030s
	iters: 500, epoch: 1 | loss: 0.2259563
	speed: 0.0034s/iter; left time: 12.3750s
Updating learning rate to 0.00042079505239702125
Validation loss decreased (inf --> 0.2904).  Saving model state dict ...
Epoch: 1 cost time: 2.0051827430725098
Epoch: 1, Steps: 523 | Train Loss: 0.5427915 Vali Loss: 0.2904458 Best vali loss: 0.2904458
	iters: 100, epoch: 2 | loss: 0.6830097
	speed: 0.0072s/iter; left time: 25.5220s
	iters: 200, epoch: 2 | loss: 0.2242483
	speed: 0.0035s/iter; left time: 12.0263s
	iters: 300, epoch: 2 | loss: 0.9091490
	speed: 0.0034s/iter; left time: 11.2641s
	iters: 400, epoch: 2 | loss: 0.5157181
	speed: 0.0035s/iter; left time: 11.3038s
	iters: 500, epoch: 2 | loss: 0.4174553
	speed: 0.0034s/iter; left time: 10.8974s
Updating learning rate to 0.00037338205188920226
Validation loss decreased (0.2904 --> 0.2862).  Saving model state dict ...
Epoch: 2 cost time: 1.8193495273590088
Epoch: 2, Steps: 523 | Train Loss: 0.5499161 Vali Loss: 0.2862288 Best vali loss: 0.2862288
	iters: 100, epoch: 3 | loss: 0.3683430
	speed: 0.0077s/iter; left time: 23.5348s
	iters: 200, epoch: 3 | loss: 0.2562368
	speed: 0.0033s/iter; left time: 9.7482s
	iters: 300, epoch: 3 | loss: 0.3412486
	speed: 0.0033s/iter; left time: 9.4060s
	iters: 400, epoch: 3 | loss: 0.4688792
	speed: 0.0033s/iter; left time: 9.0321s
	iters: 500, epoch: 3 | loss: 0.3536764
	speed: 0.0034s/iter; left time: 8.9921s
Updating learning rate to 0.0003024234821039387
Epoch: 3 cost time: 1.7861685752868652
Epoch: 3, Steps: 523 | Train Loss: 0.3576768 Vali Loss: 0.2987928 Best vali loss: 0.2862288
	iters: 100, epoch: 4 | loss: 0.5186799
	speed: 0.0071s/iter; left time: 17.9682s
	iters: 200, epoch: 4 | loss: 0.2673855
	speed: 0.0033s/iter; left time: 7.9186s
	iters: 300, epoch: 4 | loss: 0.3816133
	speed: 0.0032s/iter; left time: 7.4266s
	iters: 400, epoch: 4 | loss: 0.8385091
	speed: 0.0032s/iter; left time: 7.1973s
	iters: 500, epoch: 4 | loss: 0.6854618
	speed: 0.0032s/iter; left time: 6.7078s
Updating learning rate to 0.00021872214205
Epoch: 4 cost time: 1.7233905792236328
Epoch: 4, Steps: 523 | Train Loss: 0.5383299 Vali Loss: 0.2990909 Best vali loss: 0.2862288
	iters: 100, epoch: 5 | loss: 0.3620834
	speed: 0.0071s/iter; left time: 14.2256s
	iters: 200, epoch: 5 | loss: 0.2414292
	speed: 0.0031s/iter; left time: 5.9459s
	iters: 300, epoch: 5 | loss: 0.4241487
	speed: 0.0030s/iter; left time: 5.4121s
	iters: 400, epoch: 5 | loss: 0.3392227
	speed: 0.0030s/iter; left time: 5.1184s
	iters: 500, epoch: 5 | loss: 0.3469837
	speed: 0.0030s/iter; left time: 4.8354s
Updating learning rate to 0.00013502080199606127
Epoch: 5 cost time: 1.6564531326293945
Epoch: 5, Steps: 523 | Train Loss: 0.3427735 Vali Loss: 0.3098289 Best vali loss: 0.2862288
	iters: 100, epoch: 6 | loss: 0.2303710
	speed: 0.0073s/iter; left time: 10.6930s
	iters: 200, epoch: 6 | loss: 0.4758629
	speed: 0.0034s/iter; left time: 4.6463s
	iters: 300, epoch: 6 | loss: 0.2345909
	speed: 0.0034s/iter; left time: 4.2664s
	iters: 400, epoch: 6 | loss: 0.2036391
	speed: 0.0034s/iter; left time: 3.9303s
	iters: 500, epoch: 6 | loss: 0.4607456
	speed: 0.0034s/iter; left time: 3.5953s
Updating learning rate to 6.40622322107977e-05
Epoch: 6 cost time: 1.797224760055542
Epoch: 6, Steps: 523 | Train Loss: 0.3210419 Vali Loss: 0.3070866 Best vali loss: 0.2862288
	iters: 100, epoch: 7 | loss: 0.2168632
	speed: 0.0071s/iter; left time: 6.7502s
	iters: 200, epoch: 7 | loss: 0.2412881
	speed: 0.0031s/iter; left time: 2.6503s
	iters: 300, epoch: 7 | loss: 0.4612388
	speed: 0.0031s/iter; left time: 2.3378s
	iters: 400, epoch: 7 | loss: 0.2717042
	speed: 0.0031s/iter; left time: 1.9968s
	iters: 500, epoch: 7 | loss: 0.1779185
	speed: 0.0030s/iter; left time: 1.6430s
Updating learning rate to 1.6649231702978746e-05
Epoch: 7 cost time: 1.660897970199585
Epoch: 7, Steps: 523 | Train Loss: 0.2738026 Vali Loss: 0.3120536 Best vali loss: 0.2862288
	iters: 100, epoch: 8 | loss: 0.2109937
	speed: 0.0068s/iter; left time: 2.8830s
	iters: 200, epoch: 8 | loss: 0.2407817
	speed: 0.0029s/iter; left time: 0.9547s
	iters: 300, epoch: 8 | loss: 0.2448144
	speed: 0.0031s/iter; left time: 0.6845s
	iters: 400, epoch: 8 | loss: 0.2264150
	speed: 0.0031s/iter; left time: 0.3883s
	iters: 500, epoch: 8 | loss: 0.3841279
	speed: 0.0031s/iter; left time: 0.0751s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6379809379577637
Epoch: 8, Steps: 523 | Train Loss: 0.2614266 Vali Loss: 0.3233099 Best vali loss: 0.2862288

best validation loss 0.28622884854158975

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0030041309598, 'e_layers': 3, 'learning_rate': 0.0004716981698, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5199347
	speed: 0.0113s/iter; left time: 10.7044s
Updating learning rate to 0.0004537452272006268
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 1.1365537643432617
Epoch: 1, Steps: 131 | Train Loss: 0.5199347 Vali Loss: 0.2756924 Best vali loss: 0.2756924
	iters: 100, epoch: 2 | loss: 0.5494792
	speed: 0.0113s/iter; left time: 9.2811s
Updating learning rate to 0.0004026195721694318
Epoch: 2 cost time: 0.9164533615112305
Epoch: 2, Steps: 131 | Train Loss: 0.5494792 Vali Loss: 0.2802567 Best vali loss: 0.2756924
	iters: 100, epoch: 3 | loss: 0.5486814
	speed: 0.0110s/iter; left time: 7.5686s
Updating learning rate to 0.0003261046222296975
Epoch: 3 cost time: 0.9094960689544678
Epoch: 3, Steps: 131 | Train Loss: 0.5486814 Vali Loss: 0.3003324 Best vali loss: 0.2756924
	iters: 100, epoch: 4 | loss: 0.3323706
	speed: 0.0110s/iter; left time: 6.1237s
Updating learning rate to 0.0002358490849
Epoch: 4 cost time: 0.9081401824951172
Epoch: 4, Steps: 131 | Train Loss: 0.3323706 Vali Loss: 0.2855169 Best vali loss: 0.2756924
	iters: 100, epoch: 5 | loss: 0.3148988
	speed: 0.0111s/iter; left time: 4.7138s
Updating learning rate to 0.00014559354757030254
Epoch: 5 cost time: 0.9196505546569824
Epoch: 5, Steps: 131 | Train Loss: 0.3148988 Vali Loss: 0.2933837 Best vali loss: 0.2756924
	iters: 100, epoch: 6 | loss: 0.3241800
	speed: 0.0111s/iter; left time: 3.2687s
Updating learning rate to 6.907859763056825e-05
Epoch: 6 cost time: 0.9240472316741943
Epoch: 6, Steps: 131 | Train Loss: 0.3241800 Vali Loss: 0.3008858 Best vali loss: 0.2756924
	iters: 100, epoch: 7 | loss: 0.3646458
	speed: 0.0111s/iter; left time: 1.8137s
Updating learning rate to 1.7952942599373223e-05
Epoch: 7 cost time: 0.9163246154785156
Epoch: 7, Steps: 131 | Train Loss: 0.3646458 Vali Loss: 0.3071345 Best vali loss: 0.2756924
	iters: 100, epoch: 8 | loss: 0.3154301
	speed: 0.0111s/iter; left time: 0.3551s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.916494607925415
Epoch: 8, Steps: 131 | Train Loss: 0.3154301 Vali Loss: 0.3133425 Best vali loss: 0.2756924

best validation loss 0.27569237861237855

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022253705824, 'e_layers': 4, 'learning_rate': 0.0004750580981, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3338249
	speed: 0.0133s/iter; left time: 12.6592s
Updating learning rate to 0.0004569772758441645
Validation loss decreased (inf --> 0.2893).  Saving model state dict ...
Epoch: 1 cost time: 1.401007890701294
Epoch: 1, Steps: 131 | Train Loss: 0.3338249 Vali Loss: 0.2892770 Best vali loss: 0.2892770
	iters: 100, epoch: 2 | loss: 0.4966803
	speed: 0.0144s/iter; left time: 11.7457s
Updating learning rate to 0.0004054874503620471
Epoch: 2 cost time: 1.1848468780517578
Epoch: 2, Steps: 131 | Train Loss: 0.4966803 Vali Loss: 0.2966138 Best vali loss: 0.2892770
	iters: 100, epoch: 3 | loss: 0.4308710
	speed: 0.0140s/iter; left time: 9.6485s
Updating learning rate to 0.0003284274808268698
Epoch: 3 cost time: 1.1798412799835205
Epoch: 3, Steps: 131 | Train Loss: 0.4308710 Vali Loss: 0.3299447 Best vali loss: 0.2892770

best validation loss 0.28927698870514706

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022212930453, 'e_layers': 2, 'learning_rate': 0.0001819964333, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001819964333
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 0.5480799674987793
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2813846 Best vali loss: 0.2813846
Updating learning rate to 9.099821665e-05
Validation loss decreased (0.2814 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 0.32553672790527344
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2796553 Best vali loss: 0.2796553
Updating learning rate to 4.5499108325e-05
Epoch: 3 cost time: 0.347825288772583
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2824659 Best vali loss: 0.2796553

best validation loss 0.27965525724201584

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0029530912013, 'e_layers': 3, 'learning_rate': 0.0003816855071, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1053675
	speed: 0.0092s/iter; left time: 18.3754s
	iters: 200, epoch: 1 | loss: 0.6841909
	speed: 0.0046s/iter; left time: 8.7346s
Updating learning rate to 0.00036715846748294073
Validation loss decreased (inf --> 0.2747).  Saving model state dict ...
Epoch: 1 cost time: 1.4514224529266357
Epoch: 1, Steps: 262 | Train Loss: 0.8947792 Vali Loss: 0.2746516 Best vali loss: 0.2746516
	iters: 100, epoch: 2 | loss: 0.8035360
	speed: 0.0097s/iter; left time: 16.8148s
	iters: 200, epoch: 2 | loss: 0.4153561
	speed: 0.0046s/iter; left time: 7.5337s
Updating learning rate to 0.00032578895872551806
Validation loss decreased (0.2747 --> 0.2738).  Saving model state dict ...
Epoch: 2 cost time: 1.2169523239135742
Epoch: 2, Steps: 262 | Train Loss: 0.6094460 Vali Loss: 0.2738266 Best vali loss: 0.2738266
	iters: 100, epoch: 3 | loss: 0.4812904
	speed: 0.0098s/iter; left time: 14.5077s
	iters: 200, epoch: 3 | loss: 0.4938523
	speed: 0.0047s/iter; left time: 6.3854s
Updating learning rate to 0.00026387511352051894
Epoch: 3 cost time: 1.237624168395996
Epoch: 3, Steps: 262 | Train Loss: 0.4875714 Vali Loss: 0.2837426 Best vali loss: 0.2738266

best validation loss 0.2738266195637801

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0029530912013, 'e_layers': 3, 'learning_rate': 0.0003816855071, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6072200
	speed: 0.0092s/iter; left time: 11.1556s
	iters: 200, epoch: 4 | loss: 0.4155839
	speed: 0.0044s/iter; left time: 4.8343s
Updating learning rate to 0.00019084275355
Epoch: 4 cost time: 1.3912911415100098
Epoch: 4, Steps: 262 | Train Loss: 0.5114019 Vali Loss: 0.3033211 Best vali loss: 0.2738266
	iters: 100, epoch: 5 | loss: 0.4903253
	speed: 0.0093s/iter; left time: 8.7809s
	iters: 200, epoch: 5 | loss: 0.2865183
	speed: 0.0042s/iter; left time: 3.5270s
Updating learning rate to 0.00011781039357948108
Epoch: 5 cost time: 1.1473045349121094
Epoch: 5, Steps: 262 | Train Loss: 0.3884218 Vali Loss: 0.3258065 Best vali loss: 0.2738266
	iters: 100, epoch: 6 | loss: 0.3773930
	speed: 0.0093s/iter; left time: 6.3930s
	iters: 200, epoch: 6 | loss: 0.3688232
	speed: 0.0041s/iter; left time: 2.3778s
Updating learning rate to 5.589654837448195e-05
Epoch: 6 cost time: 1.1010820865631104
Epoch: 6, Steps: 262 | Train Loss: 0.3731081 Vali Loss: 0.3216037 Best vali loss: 0.2738266
	iters: 100, epoch: 7 | loss: 0.4279223
	speed: 0.0095s/iter; left time: 4.0350s
	iters: 200, epoch: 7 | loss: 0.2209193
	speed: 0.0044s/iter; left time: 1.4406s
Updating learning rate to 1.4527039617059292e-05
Epoch: 7 cost time: 1.2134559154510498
Epoch: 7, Steps: 262 | Train Loss: 0.3244208 Vali Loss: 0.3288977 Best vali loss: 0.2738266
	iters: 100, epoch: 8 | loss: 0.2242931
	speed: 0.0096s/iter; left time: 1.5644s
	iters: 200, epoch: 8 | loss: 0.2042858
	speed: 0.0045s/iter; left time: 0.2836s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.209606647491455
Epoch: 8, Steps: 262 | Train Loss: 0.2142894 Vali Loss: 0.3276449 Best vali loss: 0.2738266

best validation loss 0.2738266195637801

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029865592508, 'e_layers': 3, 'learning_rate': 0.0004748489579, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004748489579
Validation loss decreased (inf --> 0.2794).  Saving model state dict ...
Epoch: 1 cost time: 0.9492702484130859
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2793549 Best vali loss: 0.2793549
Updating learning rate to 0.00023742447895
Epoch: 2 cost time: 0.7343690395355225
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2820127 Best vali loss: 0.2793549
Updating learning rate to 0.000118712239475
Epoch: 3 cost time: 0.724769115447998
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2937738 Best vali loss: 0.2793549
Updating learning rate to 5.93561197375e-05
Epoch: 4 cost time: 0.7300231456756592
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2895500 Best vali loss: 0.2793549
Updating learning rate to 2.967805986875e-05
Epoch: 5 cost time: 0.8137671947479248
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2850015 Best vali loss: 0.2793549
Updating learning rate to 1.4839029934375e-05
Epoch: 6 cost time: 0.8094387054443359
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2979839 Best vali loss: 0.2793549
Updating learning rate to 7.4195149671875e-06
Epoch: 7 cost time: 0.7415940761566162
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2977428 Best vali loss: 0.2793549
Updating learning rate to 3.70975748359375e-06
Epoch: 8 cost time: 0.7266199588775635
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2989757 Best vali loss: 0.2793549

best validation loss 0.27935486891181904

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0030046500553, 'e_layers': 4, 'learning_rate': 0.0004937938828, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4263720
	speed: 0.0151s/iter; left time: 14.3224s
Updating learning rate to 0.0004749999721990985
Validation loss decreased (inf --> 0.2968).  Saving model state dict ...
Epoch: 1 cost time: 1.6315662860870361
Epoch: 1, Steps: 131 | Train Loss: 0.4263720 Vali Loss: 0.2967895 Best vali loss: 0.2967895
	iters: 100, epoch: 2 | loss: 0.6289447
	speed: 0.0168s/iter; left time: 13.7708s
Updating learning rate to 0.0004214794429181576
Validation loss decreased (0.2968 --> 0.2893).  Saving model state dict ...
Epoch: 2 cost time: 1.4127511978149414
Epoch: 2, Steps: 131 | Train Loss: 0.6289447 Vali Loss: 0.2893008 Best vali loss: 0.2893008
	iters: 100, epoch: 3 | loss: 0.3668371
	speed: 0.0172s/iter; left time: 11.7984s
Updating learning rate to 0.0003413803103753944
Validation loss decreased (0.2893 --> 0.2847).  Saving model state dict ...
Epoch: 3 cost time: 1.415780782699585
Epoch: 3, Steps: 131 | Train Loss: 0.3668371 Vali Loss: 0.2846996 Best vali loss: 0.2846996
	iters: 100, epoch: 4 | loss: 0.7445398
	speed: 0.0172s/iter; left time: 9.5909s
Updating learning rate to 0.0002468969414
Epoch: 4 cost time: 1.419438362121582
Epoch: 4, Steps: 131 | Train Loss: 0.7445398 Vali Loss: 0.2855470 Best vali loss: 0.2846996
	iters: 100, epoch: 5 | loss: 0.3700353
	speed: 0.0165s/iter; left time: 7.0111s
Updating learning rate to 0.00015241357242460555
Validation loss decreased (0.2847 --> 0.2840).  Saving model state dict ...
Epoch: 5 cost time: 1.413938045501709
Epoch: 5, Steps: 131 | Train Loss: 0.3700353 Vali Loss: 0.2839666 Best vali loss: 0.2839666
	iters: 100, epoch: 6 | loss: 0.3090516
	speed: 0.0173s/iter; left time: 5.0773s
Updating learning rate to 7.231443988184236e-05
Epoch: 6 cost time: 1.4167585372924805
Epoch: 6, Steps: 131 | Train Loss: 0.3090516 Vali Loss: 0.2979585 Best vali loss: 0.2839666
	iters: 100, epoch: 7 | loss: 0.3717137
	speed: 0.0166s/iter; left time: 2.7018s
Updating learning rate to 1.8793910600901443e-05
Epoch: 7 cost time: 1.4211061000823975
Epoch: 7, Steps: 131 | Train Loss: 0.3717137 Vali Loss: 0.2977432 Best vali loss: 0.2839666
	iters: 100, epoch: 8 | loss: 0.2793246
	speed: 0.0165s/iter; left time: 0.5293s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.414748191833496
Epoch: 8, Steps: 131 | Train Loss: 0.2793246 Vali Loss: 0.2982252 Best vali loss: 0.2839666

best validation loss 0.28396657014500476

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.000234145105, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596910
	speed: 0.0105s/iter; left time: 9.9847s
Updating learning rate to 0.000234145105
Validation loss decreased (inf --> 0.2757).  Saving model state dict ...
Epoch: 1 cost time: 0.9323863983154297
Epoch: 1, Steps: 131 | Train Loss: 0.5596910 Vali Loss: 0.2756759 Best vali loss: 0.2756759
	iters: 100, epoch: 2 | loss: 0.3260863
	speed: 0.0090s/iter; left time: 7.3843s
Updating learning rate to 0.0001170725525
Validation loss decreased (0.2757 --> 0.2705).  Saving model state dict ...
Epoch: 2 cost time: 0.7036359310150146
Epoch: 2, Steps: 131 | Train Loss: 0.3260863 Vali Loss: 0.2704955 Best vali loss: 0.2704955
	iters: 100, epoch: 3 | loss: 0.4622892
	speed: 0.0092s/iter; left time: 6.2947s
Updating learning rate to 5.853627625e-05
Epoch: 3 cost time: 0.7124044895172119
Epoch: 3, Steps: 131 | Train Loss: 0.4622892 Vali Loss: 0.2795314 Best vali loss: 0.2704955

best validation loss 0.2704955277810003

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043418272521, 'e_layers': 4, 'learning_rate': 0.00047530757, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2471507
	speed: 0.0108s/iter; left time: 44.0087s
	iters: 200, epoch: 1 | loss: 0.4866311
	speed: 0.0055s/iter; left time: 22.0703s
	iters: 300, epoch: 1 | loss: 0.5474878
	speed: 0.0056s/iter; left time: 21.6180s
	iters: 400, epoch: 1 | loss: 0.6218922
	speed: 0.0056s/iter; left time: 21.0654s
	iters: 500, epoch: 1 | loss: 1.2996122
	speed: 0.0055s/iter; left time: 20.1341s
Updating learning rate to 0.00045721725278533785
Validation loss decreased (inf --> 0.2995).  Saving model state dict ...
Epoch: 1 cost time: 3.147538185119629
Epoch: 1, Steps: 523 | Train Loss: 0.6405548 Vali Loss: 0.2994721 Best vali loss: 0.2994721
	iters: 100, epoch: 2 | loss: 0.5075428
	speed: 0.0115s/iter; left time: 41.1323s
	iters: 200, epoch: 2 | loss: 0.7501293
	speed: 0.0054s/iter; left time: 18.8088s
	iters: 300, epoch: 2 | loss: 0.3780800
	speed: 0.0054s/iter; left time: 18.2895s
	iters: 400, epoch: 2 | loss: 0.6964440
	speed: 0.0054s/iter; left time: 17.6772s
	iters: 500, epoch: 2 | loss: 0.6896941
	speed: 0.0054s/iter; left time: 17.1647s
Updating learning rate to 0.0004057003879481498
Epoch: 2 cost time: 2.8771920204162598
Epoch: 2, Steps: 523 | Train Loss: 0.6043780 Vali Loss: 0.3086089 Best vali loss: 0.2994721
	iters: 100, epoch: 3 | loss: 0.6827142
	speed: 0.0111s/iter; left time: 33.5886s
	iters: 200, epoch: 3 | loss: 0.9798093
	speed: 0.0053s/iter; left time: 15.6312s
	iters: 300, epoch: 3 | loss: 0.6257669
	speed: 0.0054s/iter; left time: 15.3098s
	iters: 400, epoch: 3 | loss: 0.2443368
	speed: 0.0054s/iter; left time: 14.8916s
	iters: 500, epoch: 3 | loss: 0.5726332
	speed: 0.0054s/iter; left time: 14.2824s
Updating learning rate to 0.0003285999511583551
Epoch: 3 cost time: 2.8484930992126465
Epoch: 3, Steps: 523 | Train Loss: 0.6210521 Vali Loss: 0.3275449 Best vali loss: 0.2994721

best validation loss 0.29947213429019726

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021103141464, 'e_layers': 2, 'learning_rate': 0.0004752122041, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004571255165337831
Validation loss decreased (inf --> 0.2770).  Saving model state dict ...
Epoch: 1 cost time: 0.7812862396240234
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2769565 Best vali loss: 0.2769565
Updating learning rate to 0.0004056189880608578
Epoch: 2 cost time: 0.5601882934570312
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2924030 Best vali loss: 0.2769565
Updating learning rate to 0.0003285340207333838
Epoch: 3 cost time: 0.5528600215911865
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2800361 Best vali loss: 0.2769565

best validation loss 0.27695653275314785

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010269997436, 'e_layers': 2, 'learning_rate': 0.000234145105, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4253707
	speed: 0.0110s/iter; left time: 6.0956s
Updating learning rate to 2.9268138125e-05
Epoch: 4 cost time: 0.9454994201660156
Epoch: 4, Steps: 131 | Train Loss: 0.4253707 Vali Loss: 0.3154481 Best vali loss: 0.2704955
	iters: 100, epoch: 5 | loss: 0.2801464
	speed: 0.0087s/iter; left time: 3.7115s
Updating learning rate to 1.46340690625e-05
Epoch: 5 cost time: 0.7050399780273438
Epoch: 5, Steps: 131 | Train Loss: 0.2801464 Vali Loss: 0.3039991 Best vali loss: 0.2704955
	iters: 100, epoch: 6 | loss: 0.4343596
	speed: 0.0086s/iter; left time: 2.5251s
Updating learning rate to 7.31703453125e-06
Epoch: 6 cost time: 0.6995282173156738
Epoch: 6, Steps: 131 | Train Loss: 0.4343596 Vali Loss: 0.3071420 Best vali loss: 0.2704955
	iters: 100, epoch: 7 | loss: 0.4664222
	speed: 0.0086s/iter; left time: 1.4052s
Updating learning rate to 3.658517265625e-06
Epoch: 7 cost time: 0.701310396194458
Epoch: 7, Steps: 131 | Train Loss: 0.4664222 Vali Loss: 0.3057738 Best vali loss: 0.2704955
	iters: 100, epoch: 8 | loss: 0.3244073
	speed: 0.0088s/iter; left time: 0.2802s
Updating learning rate to 1.8292586328125e-06
Epoch: 8 cost time: 0.7103309631347656
Epoch: 8, Steps: 131 | Train Loss: 0.3244073 Vali Loss: 0.3028289 Best vali loss: 0.2704955

best validation loss 0.2704955277810003

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024187155194, 'e_layers': 2, 'learning_rate': 0.0005052671905, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004860366031262156
Validation loss decreased (inf --> 0.2778).  Saving model state dict ...
Epoch: 1 cost time: 0.7795248031616211
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2777806 Best vali loss: 0.2777806
Updating learning rate to 0.00043127252360681254
Epoch: 2 cost time: 0.5606849193572998
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2948125 Best vali loss: 0.2777806
Updating learning rate to 0.00034931228661100284
Epoch: 3 cost time: 0.5550589561462402
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2802288 Best vali loss: 0.2777806
Updating learning rate to 0.00025263359525
Epoch: 4 cost time: 0.5477027893066406
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3027775 Best vali loss: 0.2777806
Updating learning rate to 0.00015595490388899718
Epoch: 5 cost time: 0.553795337677002
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2853276 Best vali loss: 0.2777806
Updating learning rate to 7.399466689318745e-05
Epoch: 6 cost time: 0.5491898059844971
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2805806 Best vali loss: 0.2777806
Updating learning rate to 1.923058737378437e-05
Epoch: 7 cost time: 0.5562939643859863
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2914173 Best vali loss: 0.2777806
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5505247116088867
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2933778 Best vali loss: 0.2777806

best validation loss 0.27778059995032545

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.001151240906, 'e_layers': 4, 'learning_rate': 0.0010229134969, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5661197
	speed: 0.0106s/iter; left time: 87.6999s
	iters: 200, epoch: 1 | loss: 0.1735638
	speed: 0.0052s/iter; left time: 42.2146s
	iters: 300, epoch: 1 | loss: 0.5797974
	speed: 0.0052s/iter; left time: 41.5298s
	iters: 400, epoch: 1 | loss: 0.6298276
	speed: 0.0051s/iter; left time: 40.8980s
	iters: 500, epoch: 1 | loss: 0.3746888
	speed: 0.0052s/iter; left time: 40.5094s
	iters: 600, epoch: 1 | loss: 0.5037345
	speed: 0.0051s/iter; left time: 39.8076s
	iters: 700, epoch: 1 | loss: 0.2875459
	speed: 0.0049s/iter; left time: 37.5057s
	iters: 800, epoch: 1 | loss: 0.1574486
	speed: 0.0049s/iter; left time: 36.8826s
	iters: 900, epoch: 1 | loss: 0.3049117
	speed: 0.0049s/iter; left time: 36.4911s
	iters: 1000, epoch: 1 | loss: 0.9890494
	speed: 0.0049s/iter; left time: 36.4199s
Updating learning rate to 0.0009839811701077288
Validation loss decreased (inf --> 0.3193).  Saving model state dict ...
Epoch: 1 cost time: 5.5337629318237305
Epoch: 1, Steps: 1045 | Train Loss: 0.4566687 Vali Loss: 0.3193353 Best vali loss: 0.3193353
	iters: 100, epoch: 2 | loss: 0.2802380
	speed: 0.0140s/iter; left time: 100.9476s
	iters: 200, epoch: 2 | loss: 0.4559404
	speed: 0.0051s/iter; left time: 36.6352s
	iters: 300, epoch: 2 | loss: 0.5810909
	speed: 0.0052s/iter; left time: 36.2858s
	iters: 400, epoch: 2 | loss: 1.8724124
	speed: 0.0052s/iter; left time: 35.8663s
	iters: 500, epoch: 2 | loss: 0.6415473
	speed: 0.0052s/iter; left time: 35.4467s
	iters: 600, epoch: 2 | loss: 0.8376278
	speed: 0.0052s/iter; left time: 34.6614s
	iters: 700, epoch: 2 | loss: 1.9338444
	speed: 0.0052s/iter; left time: 34.1475s
	iters: 800, epoch: 2 | loss: 0.4034876
	speed: 0.0052s/iter; left time: 34.0470s
	iters: 900, epoch: 2 | loss: 0.2443141
	speed: 0.0052s/iter; left time: 33.3842s
	iters: 1000, epoch: 2 | loss: 0.9012340
	speed: 0.0051s/iter; left time: 32.2878s
Updating learning rate to 0.0008731112835626172
Epoch: 2 cost time: 5.447787046432495
Epoch: 2, Steps: 1045 | Train Loss: 0.8151737 Vali Loss: 0.3212607 Best vali loss: 0.3193353
	iters: 100, epoch: 3 | loss: 0.6530790
	speed: 0.0144s/iter; left time: 89.0000s
	iters: 200, epoch: 3 | loss: 0.5207034
	speed: 0.0052s/iter; left time: 31.7418s
	iters: 300, epoch: 3 | loss: 0.4229200
	speed: 0.0052s/iter; left time: 31.1492s
	iters: 400, epoch: 3 | loss: 1.3014302
	speed: 0.0052s/iter; left time: 30.5210s
	iters: 500, epoch: 3 | loss: 0.3783442
	speed: 0.0052s/iter; left time: 29.9767s
	iters: 600, epoch: 3 | loss: 0.2217336
	speed: 0.0052s/iter; left time: 29.5371s
	iters: 700, epoch: 3 | loss: 1.6622709
	speed: 0.0052s/iter; left time: 28.7641s
	iters: 800, epoch: 3 | loss: 0.4449941
	speed: 0.0052s/iter; left time: 28.6267s
	iters: 900, epoch: 3 | loss: 1.5285679
	speed: 0.0052s/iter; left time: 27.9713s
	iters: 1000, epoch: 3 | loss: 0.3556560
	speed: 0.0053s/iter; left time: 27.6758s
Updating learning rate to 0.0007071827724531343
Epoch: 3 cost time: 5.4854576587677
Epoch: 3, Steps: 1045 | Train Loss: 0.7489699 Vali Loss: 0.3195695 Best vali loss: 0.3193353
	iters: 100, epoch: 4 | loss: 0.1760692
	speed: 0.0144s/iter; left time: 73.8140s
	iters: 200, epoch: 4 | loss: 0.4675468
	speed: 0.0052s/iter; left time: 26.1598s
	iters: 300, epoch: 4 | loss: 0.9543810
	speed: 0.0052s/iter; left time: 25.4568s
	iters: 400, epoch: 4 | loss: 0.1605729
	speed: 0.0052s/iter; left time: 24.8813s
	iters: 500, epoch: 4 | loss: 0.4895325
	speed: 0.0052s/iter; left time: 24.3567s
	iters: 600, epoch: 4 | loss: 0.4187187
	speed: 0.0052s/iter; left time: 24.0402s
	iters: 700, epoch: 4 | loss: 0.4404657
	speed: 0.0052s/iter; left time: 23.5812s
	iters: 800, epoch: 4 | loss: 1.3639205
	speed: 0.0052s/iter; left time: 23.0754s
	iters: 900, epoch: 4 | loss: 0.5853619
	speed: 0.0052s/iter; left time: 22.5425s
	iters: 1000, epoch: 4 | loss: 0.9039459
	speed: 0.0046s/iter; left time: 19.6008s
Updating learning rate to 0.00051145674845
Validation loss decreased (0.3193 --> 0.3188).  Saving model state dict ...
Epoch: 4 cost time: 5.3752968311309814
Epoch: 4, Steps: 1045 | Train Loss: 0.5960515 Vali Loss: 0.3188050 Best vali loss: 0.3188050
	iters: 100, epoch: 5 | loss: 0.7074889
	speed: 0.0140s/iter; left time: 57.0551s
	iters: 200, epoch: 5 | loss: 0.5144343
	speed: 0.0048s/iter; left time: 19.0832s
	iters: 300, epoch: 5 | loss: 0.4093541
	speed: 0.0048s/iter; left time: 18.5866s
	iters: 400, epoch: 5 | loss: 0.6951090
	speed: 0.0048s/iter; left time: 18.0865s
	iters: 500, epoch: 5 | loss: 0.5973797
	speed: 0.0048s/iter; left time: 17.6756s
	iters: 600, epoch: 5 | loss: 1.7783886
	speed: 0.0048s/iter; left time: 17.0997s
	iters: 700, epoch: 5 | loss: 0.3644192
	speed: 0.0048s/iter; left time: 16.6803s
	iters: 800, epoch: 5 | loss: 0.6977692
	speed: 0.0048s/iter; left time: 16.1903s
	iters: 900, epoch: 5 | loss: 0.8198707
	speed: 0.0048s/iter; left time: 15.7522s
	iters: 1000, epoch: 5 | loss: 0.2168136
	speed: 0.0049s/iter; left time: 15.4926s
Updating learning rate to 0.0003157307244468657
Epoch: 5 cost time: 5.064659833908081
Epoch: 5, Steps: 1045 | Train Loss: 0.6801027 Vali Loss: 0.3194088 Best vali loss: 0.3188050
	iters: 100, epoch: 6 | loss: 0.4919535
	speed: 0.0139s/iter; left time: 42.3035s
	iters: 200, epoch: 6 | loss: 0.2754983
	speed: 0.0048s/iter; left time: 14.2129s
	iters: 300, epoch: 6 | loss: 0.2459147
	speed: 0.0048s/iter; left time: 13.6594s
	iters: 400, epoch: 6 | loss: 0.4149354
	speed: 0.0049s/iter; left time: 13.3541s
	iters: 500, epoch: 6 | loss: 0.2404448
	speed: 0.0049s/iter; left time: 12.8438s
	iters: 600, epoch: 6 | loss: 0.5344161
	speed: 0.0049s/iter; left time: 12.3423s
	iters: 700, epoch: 6 | loss: 1.1679348
	speed: 0.0049s/iter; left time: 12.0127s
	iters: 800, epoch: 6 | loss: 0.5413827
	speed: 0.0048s/iter; left time: 11.2448s
	iters: 900, epoch: 6 | loss: 0.3324833
	speed: 0.0048s/iter; left time: 10.8226s
	iters: 1000, epoch: 6 | loss: 1.0028692
	speed: 0.0048s/iter; left time: 10.2891s
Updating learning rate to 0.0001498022133373828
Epoch: 6 cost time: 5.102949380874634
Epoch: 6, Steps: 1045 | Train Loss: 0.5247833 Vali Loss: 0.3193682 Best vali loss: 0.3188050
	iters: 100, epoch: 7 | loss: 0.2855734
	speed: 0.0139s/iter; left time: 27.6750s
	iters: 200, epoch: 7 | loss: 0.5059351
	speed: 0.0048s/iter; left time: 9.1459s
	iters: 300, epoch: 7 | loss: 0.3962569
	speed: 0.0048s/iter; left time: 8.6210s
	iters: 400, epoch: 7 | loss: 0.6538362
	speed: 0.0049s/iter; left time: 8.3318s
	iters: 500, epoch: 7 | loss: 0.1974119
	speed: 0.0049s/iter; left time: 7.7548s
	iters: 600, epoch: 7 | loss: 0.4260147
	speed: 0.0048s/iter; left time: 7.2298s
	iters: 700, epoch: 7 | loss: 0.7970681
	speed: 0.0048s/iter; left time: 6.6992s
	iters: 800, epoch: 7 | loss: 0.3369820
	speed: 0.0046s/iter; left time: 5.9219s
	iters: 900, epoch: 7 | loss: 0.2894827
	speed: 0.0045s/iter; left time: 5.4146s
	iters: 1000, epoch: 7 | loss: 1.5184225
	speed: 0.0046s/iter; left time: 4.9885s
Updating learning rate to 3.893232679227122e-05
Epoch: 7 cost time: 5.0114781856536865
Epoch: 7, Steps: 1045 | Train Loss: 0.5406984 Vali Loss: 0.3226688 Best vali loss: 0.3188050
	iters: 100, epoch: 8 | loss: 0.4261727
	speed: 0.0141s/iter; left time: 13.3419s
	iters: 200, epoch: 8 | loss: 0.3248833
	speed: 0.0052s/iter; left time: 4.3598s
	iters: 300, epoch: 8 | loss: 0.3398862
	speed: 0.0052s/iter; left time: 3.8457s
	iters: 400, epoch: 8 | loss: 0.9896057
	speed: 0.0052s/iter; left time: 3.3429s
	iters: 500, epoch: 8 | loss: 1.1952716
	speed: 0.0052s/iter; left time: 2.8308s
	iters: 600, epoch: 8 | loss: 0.3046393
	speed: 0.0052s/iter; left time: 2.3247s
	iters: 700, epoch: 8 | loss: 0.4929597
	speed: 0.0052s/iter; left time: 1.7954s
	iters: 800, epoch: 8 | loss: 0.3052320
	speed: 0.0052s/iter; left time: 1.2842s
	iters: 900, epoch: 8 | loss: 0.2390777
	speed: 0.0052s/iter; left time: 0.7621s
	iters: 1000, epoch: 8 | loss: 0.4145542
	speed: 0.0052s/iter; left time: 0.2386s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.45635986328125
Epoch: 8, Steps: 1045 | Train Loss: 0.5032282 Vali Loss: 0.3224417 Best vali loss: 0.3188050

best validation loss 0.3188050053861337

[INFO][smbo.py:320] Finished 1500 trials.
[INFO][smbo.py:328] Configuration budget is exhausted:
[INFO][smbo.py:329] --- Remaining wallclock time: 2585.8357985019684
[INFO][smbo.py:330] --- Remaining cpu time: inf
[INFO][smbo.py:331] --- Remaining trials: 0
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.003098386677, 'e_layers': 1, 'learning_rate': 0.0005, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5937442
	speed: 0.0075s/iter; left time: 61.6305s
	iters: 200, epoch: 1 | loss: 0.3817097
	speed: 0.0022s/iter; left time: 17.5546s
	iters: 300, epoch: 1 | loss: 0.6554315
	speed: 0.0021s/iter; left time: 17.2367s
	iters: 400, epoch: 1 | loss: 0.3212048
	speed: 0.0022s/iter; left time: 17.2934s
	iters: 500, epoch: 1 | loss: 0.3361108
	speed: 0.0022s/iter; left time: 17.0719s
	iters: 600, epoch: 1 | loss: 0.5185102
	speed: 0.0022s/iter; left time: 17.2944s
	iters: 700, epoch: 1 | loss: 0.3716597
	speed: 0.0022s/iter; left time: 16.6955s
	iters: 800, epoch: 1 | loss: 1.2683676
	speed: 0.0022s/iter; left time: 16.4798s
	iters: 900, epoch: 1 | loss: 0.4614779
	speed: 0.0022s/iter; left time: 16.6706s
	iters: 1000, epoch: 1 | loss: 0.3256660
	speed: 0.0024s/iter; left time: 17.3293s
Updating learning rate to 0.0004809698831278217
Validation loss decreased (inf --> 0.2826).  Saving model state dict ...
Epoch: 1 cost time: 2.559880256652832
Epoch: 1, Steps: 1045 | Train Loss: 0.5233882 Vali Loss: 0.2826106 Best vali loss: 0.2826106
	iters: 100, epoch: 2 | loss: 0.5273076
	speed: 0.0080s/iter; left time: 57.8124s
	iters: 200, epoch: 2 | loss: 0.9730043
	speed: 0.0023s/iter; left time: 16.6759s
	iters: 300, epoch: 2 | loss: 0.2456573
	speed: 0.0024s/iter; left time: 16.6398s
	iters: 400, epoch: 2 | loss: 0.2525396
	speed: 0.0024s/iter; left time: 16.3362s
	iters: 500, epoch: 2 | loss: 0.5172208
	speed: 0.0024s/iter; left time: 16.0728s
	iters: 600, epoch: 2 | loss: 0.3085492
	speed: 0.0024s/iter; left time: 16.0147s
	iters: 700, epoch: 2 | loss: 0.3414644
	speed: 0.0024s/iter; left time: 15.6882s
	iters: 800, epoch: 2 | loss: 0.4410809
	speed: 0.0024s/iter; left time: 15.5216s
	iters: 900, epoch: 2 | loss: 0.4771705
	speed: 0.0024s/iter; left time: 15.1827s
	iters: 1000, epoch: 2 | loss: 0.3338618
	speed: 0.0024s/iter; left time: 15.1893s
Updating learning rate to 0.00042677669529663686
Epoch: 2 cost time: 2.5053212642669678
Epoch: 2, Steps: 1045 | Train Loss: 0.4417856 Vali Loss: 0.2831361 Best vali loss: 0.2826106
	iters: 100, epoch: 3 | loss: 0.8348846
	speed: 0.0076s/iter; left time: 46.6848s
	iters: 200, epoch: 3 | loss: 0.2824008
	speed: 0.0020s/iter; left time: 12.1807s
	iters: 300, epoch: 3 | loss: 0.6686269
	speed: 0.0020s/iter; left time: 11.9583s
	iters: 400, epoch: 3 | loss: 1.0816137
	speed: 0.0020s/iter; left time: 11.7457s
	iters: 500, epoch: 3 | loss: 0.7581303
	speed: 0.0020s/iter; left time: 11.5399s
	iters: 600, epoch: 3 | loss: 0.2614855
	speed: 0.0020s/iter; left time: 11.3442s
	iters: 700, epoch: 3 | loss: 0.3589197
	speed: 0.0020s/iter; left time: 11.1411s
	iters: 800, epoch: 3 | loss: 0.3037363
	speed: 0.0021s/iter; left time: 11.3174s
	iters: 900, epoch: 3 | loss: 0.4209145
	speed: 0.0022s/iter; left time: 11.9523s
	iters: 1000, epoch: 3 | loss: 0.6652764
	speed: 0.0022s/iter; left time: 11.7804s
Updating learning rate to 0.0003456708580912725
Epoch: 3 cost time: 2.194409132003784
Epoch: 3, Steps: 1045 | Train Loss: 0.5635989 Vali Loss: 0.2827841 Best vali loss: 0.2826106
	iters: 100, epoch: 4 | loss: 0.2567467
	speed: 0.0075s/iter; left time: 38.3977s
	iters: 200, epoch: 4 | loss: 0.4531777
	speed: 0.0021s/iter; left time: 10.6284s
	iters: 300, epoch: 4 | loss: 1.8263042
	speed: 0.0023s/iter; left time: 11.1342s
	iters: 400, epoch: 4 | loss: 0.4024292
	speed: 0.0023s/iter; left time: 11.0253s
	iters: 500, epoch: 4 | loss: 1.0532186
	speed: 0.0022s/iter; left time: 10.2186s
	iters: 600, epoch: 4 | loss: 0.5830844
	speed: 0.0020s/iter; left time: 9.4691s
	iters: 700, epoch: 4 | loss: 0.3304062
	speed: 0.0022s/iter; left time: 10.0594s
	iters: 800, epoch: 4 | loss: 0.3453764
	speed: 0.0020s/iter; left time: 8.9298s
	iters: 900, epoch: 4 | loss: 0.2444883
	speed: 0.0021s/iter; left time: 8.9881s
	iters: 1000, epoch: 4 | loss: 0.4101499
	speed: 0.0021s/iter; left time: 8.9728s
Updating learning rate to 0.00025
Epoch: 4 cost time: 2.2675628662109375
Epoch: 4, Steps: 1045 | Train Loss: 0.5905382 Vali Loss: 0.2884849 Best vali loss: 0.2826106
	iters: 100, epoch: 5 | loss: 0.2307371
	speed: 0.0077s/iter; left time: 31.2609s
	iters: 200, epoch: 5 | loss: 0.2151408
	speed: 0.0023s/iter; left time: 8.9887s
	iters: 300, epoch: 5 | loss: 0.3629364
	speed: 0.0022s/iter; left time: 8.5421s
	iters: 400, epoch: 5 | loss: 0.3245461
	speed: 0.0022s/iter; left time: 8.2825s
	iters: 500, epoch: 5 | loss: 0.4331363
	speed: 0.0022s/iter; left time: 8.1554s
	iters: 600, epoch: 5 | loss: 0.7399170
	speed: 0.0022s/iter; left time: 7.9006s
	iters: 700, epoch: 5 | loss: 0.1836436
	speed: 0.0022s/iter; left time: 7.6465s
	iters: 800, epoch: 5 | loss: 0.6432620
	speed: 0.0022s/iter; left time: 7.4710s
	iters: 900, epoch: 5 | loss: 0.8184315
	speed: 0.0022s/iter; left time: 7.2691s
	iters: 1000, epoch: 5 | loss: 0.2959554
	speed: 0.0022s/iter; left time: 7.0130s
Updating learning rate to 0.00015432914190872756
Epoch: 5 cost time: 2.363327741622925
Epoch: 5, Steps: 1045 | Train Loss: 0.4247706 Vali Loss: 0.2888603 Best vali loss: 0.2826106
	iters: 100, epoch: 6 | loss: 0.5141073
	speed: 0.0073s/iter; left time: 22.2350s
	iters: 200, epoch: 6 | loss: 0.5453321
	speed: 0.0020s/iter; left time: 5.8988s
	iters: 300, epoch: 6 | loss: 0.5861233
	speed: 0.0020s/iter; left time: 5.6819s
	iters: 400, epoch: 6 | loss: 0.4644388
	speed: 0.0020s/iter; left time: 5.4236s
	iters: 500, epoch: 6 | loss: 0.3541766
	speed: 0.0020s/iter; left time: 5.1802s
	iters: 600, epoch: 6 | loss: 0.2089294
	speed: 0.0020s/iter; left time: 4.9795s
	iters: 700, epoch: 6 | loss: 0.2743029
	speed: 0.0020s/iter; left time: 4.8218s
	iters: 800, epoch: 6 | loss: 0.3992812
	speed: 0.0020s/iter; left time: 4.6607s
	iters: 900, epoch: 6 | loss: 0.3943511
	speed: 0.0020s/iter; left time: 4.4746s
	iters: 1000, epoch: 6 | loss: 0.4647241
	speed: 0.0020s/iter; left time: 4.2373s
Updating learning rate to 7.322330470336314e-05
Epoch: 6 cost time: 2.1196751594543457
Epoch: 6, Steps: 1045 | Train Loss: 0.4205767 Vali Loss: 0.2920613 Best vali loss: 0.2826106
	iters: 100, epoch: 7 | loss: 0.1986386
	speed: 0.0074s/iter; left time: 14.8066s
	iters: 200, epoch: 7 | loss: 0.3464024
	speed: 0.0020s/iter; left time: 3.7808s
	iters: 300, epoch: 7 | loss: 1.3884044
	speed: 0.0020s/iter; left time: 3.5826s
	iters: 400, epoch: 7 | loss: 0.5145800
	speed: 0.0020s/iter; left time: 3.3483s
	iters: 500, epoch: 7 | loss: 1.2516177
	speed: 0.0020s/iter; left time: 3.1185s
	iters: 600, epoch: 7 | loss: 0.3267845
	speed: 0.0020s/iter; left time: 2.9494s
	iters: 700, epoch: 7 | loss: 0.3372619
	speed: 0.0020s/iter; left time: 2.7906s
	iters: 800, epoch: 7 | loss: 0.8908448
	speed: 0.0020s/iter; left time: 2.5762s
	iters: 900, epoch: 7 | loss: 0.4358309
	speed: 0.0020s/iter; left time: 2.3589s
	iters: 1000, epoch: 7 | loss: 0.2723260
	speed: 0.0020s/iter; left time: 2.1739s
Updating learning rate to 1.9030116872178316e-05
Epoch: 7 cost time: 2.111126184463501
Epoch: 7, Steps: 1045 | Train Loss: 0.5962691 Vali Loss: 0.2922355 Best vali loss: 0.2826106
	iters: 100, epoch: 8 | loss: 0.1689367
	speed: 0.0073s/iter; left time: 6.9372s
	iters: 200, epoch: 8 | loss: 0.3608226
	speed: 0.0020s/iter; left time: 1.6866s
	iters: 300, epoch: 8 | loss: 0.4478625
	speed: 0.0020s/iter; left time: 1.4820s
	iters: 400, epoch: 8 | loss: 0.2357202
	speed: 0.0020s/iter; left time: 1.2757s
	iters: 500, epoch: 8 | loss: 0.2947716
	speed: 0.0020s/iter; left time: 1.0860s
	iters: 600, epoch: 8 | loss: 0.2283043
	speed: 0.0020s/iter; left time: 0.9008s
	iters: 700, epoch: 8 | loss: 0.4226407
	speed: 0.0020s/iter; left time: 0.6897s
	iters: 800, epoch: 8 | loss: 1.1847116
	speed: 0.0020s/iter; left time: 0.4865s
	iters: 900, epoch: 8 | loss: 0.1929621
	speed: 0.0020s/iter; left time: 0.2897s
	iters: 1000, epoch: 8 | loss: 1.0116373
	speed: 0.0021s/iter; left time: 0.0974s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1442058086395264
Epoch: 8, Steps: 1045 | Train Loss: 0.4548370 Vali Loss: 0.2931055 Best vali loss: 0.2826106

best validation loss 0.28261058573919673

Default cost: 0.28261058573919673
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010270126829, 'e_layers': 2, 'learning_rate': 0.0002345345781, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8
start_epoch 8
train_epoch 8

best validation loss 0.26787560238364727

Configuration(values={
  'alpha_d_ff': 4,
  'batch_size': 64,
  'd_core': 32,
  'd_model': 512,
  'dropout': 0.0010270126829,
  'e_layers': 2,
  'learning_rate': 0.0002345345781,
  'lradj': 'type1',
})
Incumbent cost: 0.26787560238364727


Time taken (1 parallel trials): 11839 seconds


