horizon=192
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023508577801, 'e_layers': 1, 'learning_rate': 0.0004821026935, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5834060
	speed: 0.0090s/iter; left time: 17.8828s
	iters: 200, epoch: 1 | loss: 0.4136868
	speed: 0.0032s/iter; left time: 6.0959s
Updating learning rate to 0.00046375375229660605
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 1.1299023628234863
Epoch: 1, Steps: 262 | Train Loss: 0.4985464 Vali Loss: 0.2883522 Best vali loss: 0.2883522
	iters: 100, epoch: 2 | loss: 0.7534162
	speed: 0.0079s/iter; left time: 13.6584s
	iters: 200, epoch: 2 | loss: 0.4541170
	speed: 0.0034s/iter; left time: 5.5149s
Updating learning rate to 0.00041150038865107484
Validation loss decreased (0.2884 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.9185032844543457
Epoch: 2, Steps: 262 | Train Loss: 0.6037666 Vali Loss: 0.2826518 Best vali loss: 0.2826518
	iters: 100, epoch: 3 | loss: 0.3558559
	speed: 0.0078s/iter; left time: 11.5585s
	iters: 200, epoch: 3 | loss: 0.2422653
	speed: 0.0037s/iter; left time: 5.0532s
Updating learning rate to 0.0003332977035005174
Validation loss decreased (0.2827 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 0.9580316543579102
Epoch: 3, Steps: 262 | Train Loss: 0.2990606 Vali Loss: 0.2823314 Best vali loss: 0.2823314

best validation loss 0.28233136732079983

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9386364
	speed: 0.0107s/iter; left time: 43.8485s
	iters: 200, epoch: 1 | loss: 0.6114913
	speed: 0.0051s/iter; left time: 20.1751s
	iters: 300, epoch: 1 | loss: 0.7728357
	speed: 0.0072s/iter; left time: 27.9341s
	iters: 400, epoch: 1 | loss: 0.2932993
	speed: 0.0072s/iter; left time: 27.3827s
	iters: 500, epoch: 1 | loss: 0.6511849
	speed: 0.0074s/iter; left time: 27.1525s
Updating learning rate to 0.0015120382784
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 3.633763551712036
Epoch: 1, Steps: 523 | Train Loss: 0.6534895 Vali Loss: 0.2840199 Best vali loss: 0.2840199
	iters: 100, epoch: 2 | loss: 0.4304247
	speed: 0.0150s/iter; left time: 53.5404s
	iters: 200, epoch: 2 | loss: 0.2752168
	speed: 0.0073s/iter; left time: 25.3723s
	iters: 300, epoch: 2 | loss: 0.3249710
	speed: 0.0056s/iter; left time: 18.7670s
	iters: 400, epoch: 2 | loss: 0.4503768
	speed: 0.0046s/iter; left time: 14.9491s
	iters: 500, epoch: 2 | loss: 1.3678914
	speed: 0.0060s/iter; left time: 18.8548s
Updating learning rate to 0.0007560191392
Epoch: 2 cost time: 3.2665014266967773
Epoch: 2, Steps: 523 | Train Loss: 0.5697761 Vali Loss: 0.2955073 Best vali loss: 0.2840199
	iters: 100, epoch: 3 | loss: 0.4413143
	speed: 0.0126s/iter; left time: 38.3420s
	iters: 200, epoch: 3 | loss: 0.4337928
	speed: 0.0049s/iter; left time: 14.3665s
	iters: 300, epoch: 3 | loss: 0.3884105
	speed: 0.0060s/iter; left time: 16.9512s
	iters: 400, epoch: 3 | loss: 0.3835309
	speed: 0.0061s/iter; left time: 16.6395s
	iters: 500, epoch: 3 | loss: 0.2474844
	speed: 0.0060s/iter; left time: 15.9528s
Updating learning rate to 0.0003780095696
Epoch: 3 cost time: 3.1134536266326904
Epoch: 3, Steps: 523 | Train Loss: 0.3789066 Vali Loss: 0.2912091 Best vali loss: 0.2840199

best validation loss 0.28401992631561473

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8074170
	speed: 0.0091s/iter; left time: 8.6261s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.2951).  Saving model state dict ...
Epoch: 1 cost time: 0.7497611045837402
Epoch: 1, Steps: 131 | Train Loss: 0.8074170 Vali Loss: 0.2951197 Best vali loss: 0.2951197
	iters: 100, epoch: 2 | loss: 0.6121553
	speed: 0.0062s/iter; left time: 5.0447s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.2951 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 0.4612903594970703
Epoch: 2, Steps: 131 | Train Loss: 0.6121553 Vali Loss: 0.2836582 Best vali loss: 0.2836582
	iters: 100, epoch: 3 | loss: 0.6417097
	speed: 0.0060s/iter; left time: 4.1307s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.2837 --> 0.2811).  Saving model state dict ...
Epoch: 3 cost time: 0.4578828811645508
Epoch: 3, Steps: 131 | Train Loss: 0.6417097 Vali Loss: 0.2810963 Best vali loss: 0.2810963

best validation loss 0.28109633362882863

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7595142
	speed: 0.0084s/iter; left time: 4.6434s
Updating learning rate to 0.0001298368129
Epoch: 4 cost time: 0.6746819019317627
Epoch: 4, Steps: 131 | Train Loss: 0.7595142 Vali Loss: 0.2820223 Best vali loss: 0.2810963
	iters: 100, epoch: 5 | loss: 0.5689501
	speed: 0.0061s/iter; left time: 2.6087s
Updating learning rate to 8.015041569208405e-05
Epoch: 5 cost time: 0.45026636123657227
Epoch: 5, Steps: 131 | Train Loss: 0.5689501 Vali Loss: 0.2811683 Best vali loss: 0.2810963
	iters: 100, epoch: 6 | loss: 0.6173742
	speed: 0.0060s/iter; left time: 1.7626s
Updating learning rate to 3.8028322050761e-05
Epoch: 6 cost time: 0.4526655673980713
Epoch: 6, Steps: 131 | Train Loss: 0.6173742 Vali Loss: 0.2812745 Best vali loss: 0.2810963
	iters: 100, epoch: 7 | loss: 0.4363810
	speed: 0.0061s/iter; left time: 0.9911s
Updating learning rate to 9.883238895192597e-06
Epoch: 7 cost time: 0.4582810401916504
Epoch: 7, Steps: 131 | Train Loss: 0.4363810 Vali Loss: 0.2811637 Best vali loss: 0.2810963
	iters: 100, epoch: 8 | loss: 0.3696131
	speed: 0.0063s/iter; left time: 0.2017s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.48913049697875977
Epoch: 8, Steps: 131 | Train Loss: 0.3696131 Vali Loss: 0.2812956 Best vali loss: 0.2810963

best validation loss 0.28109633362882863

[INFO][abstract_intensifier.py:516] Added config e98a6b as new incumbent because there are no incumbents yet.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012865813859, 'e_layers': 2, 'learning_rate': 0.0003414993649, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3352718
	speed: 0.0099s/iter; left time: 19.7688s
	iters: 200, epoch: 1 | loss: 0.5555092
	speed: 0.0042s/iter; left time: 8.0068s
Updating learning rate to 0.0003414993649
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.4160542488098145
Epoch: 1, Steps: 262 | Train Loss: 0.4453905 Vali Loss: 0.2856293 Best vali loss: 0.2856293
	iters: 100, epoch: 2 | loss: 0.6429988
	speed: 0.0102s/iter; left time: 17.6427s
	iters: 200, epoch: 2 | loss: 0.6578826
	speed: 0.0044s/iter; left time: 7.1537s
Updating learning rate to 0.00017074968245
Validation loss decreased (0.2856 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 1.2057132720947266
Epoch: 2, Steps: 262 | Train Loss: 0.6504407 Vali Loss: 0.2823917 Best vali loss: 0.2823917
	iters: 100, epoch: 3 | loss: 0.2930568
	speed: 0.0103s/iter; left time: 15.1056s
	iters: 200, epoch: 3 | loss: 0.8542147
	speed: 0.0043s/iter; left time: 5.9487s
Updating learning rate to 8.5374841225e-05
Epoch: 3 cost time: 1.2115094661712646
Epoch: 3, Steps: 262 | Train Loss: 0.5736358 Vali Loss: 0.2981294 Best vali loss: 0.2823917
	iters: 100, epoch: 4 | loss: 0.3411630
	speed: 0.0103s/iter; left time: 12.4471s
	iters: 200, epoch: 4 | loss: 0.4738437
	speed: 0.0042s/iter; left time: 4.6802s
Updating learning rate to 4.26874206125e-05
Epoch: 4 cost time: 1.1724567413330078
Epoch: 4, Steps: 262 | Train Loss: 0.4075034 Vali Loss: 0.2960947 Best vali loss: 0.2823917
	iters: 100, epoch: 5 | loss: 0.2839885
	speed: 0.0101s/iter; left time: 9.5924s
	iters: 200, epoch: 5 | loss: 0.3576979
	speed: 0.0067s/iter; left time: 5.7164s
Updating learning rate to 2.134371030625e-05
Epoch: 5 cost time: 1.645700454711914
Epoch: 5, Steps: 262 | Train Loss: 0.3208432 Vali Loss: 0.3004309 Best vali loss: 0.2823917
	iters: 100, epoch: 6 | loss: 0.3215562
	speed: 0.0129s/iter; left time: 8.8601s
	iters: 200, epoch: 6 | loss: 0.4806418
	speed: 0.0062s/iter; left time: 3.6331s
Updating learning rate to 1.0671855153125e-05
Epoch: 6 cost time: 1.519627571105957
Epoch: 6, Steps: 262 | Train Loss: 0.4010990 Vali Loss: 0.3056654 Best vali loss: 0.2823917
	iters: 100, epoch: 7 | loss: 0.6570817
	speed: 0.0132s/iter; left time: 5.6002s
	iters: 200, epoch: 7 | loss: 0.3752165
	speed: 0.0067s/iter; left time: 2.1771s
Updating learning rate to 5.3359275765625e-06
Epoch: 7 cost time: 1.6587474346160889
Epoch: 7, Steps: 262 | Train Loss: 0.5161491 Vali Loss: 0.2974821 Best vali loss: 0.2823917
	iters: 100, epoch: 8 | loss: 0.3465102
	speed: 0.0132s/iter; left time: 2.1458s
	iters: 200, epoch: 8 | loss: 0.4489002
	speed: 0.0067s/iter; left time: 0.4221s
Updating learning rate to 2.66796378828125e-06
Epoch: 8 cost time: 1.7106201648712158
Epoch: 8, Steps: 262 | Train Loss: 0.3977052 Vali Loss: 0.3024431 Best vali loss: 0.2823917

best validation loss 0.28239172242108046

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0033747601445, 'e_layers': 1, 'learning_rate': 0.0010195596024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5029868
	speed: 0.0133s/iter; left time: 12.6605s
Updating learning rate to 0.0009807549256163528
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 1.2788116931915283
Epoch: 1, Steps: 131 | Train Loss: 0.5029868 Vali Loss: 0.2858818 Best vali loss: 0.2858818
	iters: 100, epoch: 2 | loss: 0.6639416
	speed: 0.0129s/iter; left time: 10.5158s
Updating learning rate to 0.0008702485555404501
Validation loss decreased (0.2859 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 0.983928918838501
Epoch: 2, Steps: 131 | Train Loss: 0.6639416 Vali Loss: 0.2843009 Best vali loss: 0.2843009
	iters: 100, epoch: 3 | loss: 0.5425340
	speed: 0.0133s/iter; left time: 9.1424s
Updating learning rate to 0.0007048640852736092
Epoch: 3 cost time: 1.0168397426605225
Epoch: 3, Steps: 131 | Train Loss: 0.5425340 Vali Loss: 0.3034245 Best vali loss: 0.2843009
	iters: 100, epoch: 4 | loss: 0.4238728
	speed: 0.0129s/iter; left time: 7.1827s
Updating learning rate to 0.0005097798012
Epoch: 4 cost time: 1.0099151134490967
Epoch: 4, Steps: 131 | Train Loss: 0.4238728 Vali Loss: 0.3184402 Best vali loss: 0.2843009
	iters: 100, epoch: 5 | loss: 0.3398249
	speed: 0.0135s/iter; left time: 5.7181s
Updating learning rate to 0.00031469551712639095
Epoch: 5 cost time: 1.0879085063934326
Epoch: 5, Steps: 131 | Train Loss: 0.3398249 Vali Loss: 0.3162117 Best vali loss: 0.2843009
	iters: 100, epoch: 6 | loss: 0.2701750
	speed: 0.0108s/iter; left time: 3.1847s
Updating learning rate to 0.00014931104685954994
Epoch: 6 cost time: 0.6442134380340576
Epoch: 6, Steps: 131 | Train Loss: 0.2701750 Vali Loss: 0.3244301 Best vali loss: 0.2843009
	iters: 100, epoch: 7 | loss: 0.3188292
	speed: 0.0088s/iter; left time: 1.4400s
Updating learning rate to 3.880467678364731e-05
Epoch: 7 cost time: 0.684790849685669
Epoch: 7, Steps: 131 | Train Loss: 0.3188292 Vali Loss: 0.3337255 Best vali loss: 0.2843009
	iters: 100, epoch: 8 | loss: 0.2580643
	speed: 0.0097s/iter; left time: 0.3089s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7380259037017822
Epoch: 8, Steps: 131 | Train Loss: 0.2580643 Vali Loss: 0.3369409 Best vali loss: 0.2843009

best validation loss 0.28430089233155675

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8625314
	speed: 0.0106s/iter; left time: 10.0775s
Updating learning rate to 0.0008036931396
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 0.9352831840515137
Epoch: 1, Steps: 131 | Train Loss: 0.8625314 Vali Loss: 0.2856309 Best vali loss: 0.2856309
	iters: 100, epoch: 2 | loss: 0.4061940
	speed: 0.0092s/iter; left time: 7.5310s
Updating learning rate to 0.0004018465698
Validation loss decreased (0.2856 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.6858892440795898
Epoch: 2, Steps: 131 | Train Loss: 0.4061940 Vali Loss: 0.2792235 Best vali loss: 0.2792235
	iters: 100, epoch: 3 | loss: 0.3649252
	speed: 0.0123s/iter; left time: 8.4495s
Updating learning rate to 0.0002009232849
Epoch: 3 cost time: 1.0317614078521729
Epoch: 3, Steps: 131 | Train Loss: 0.3649252 Vali Loss: 0.2911799 Best vali loss: 0.2792235

best validation loss 0.2792234520385282

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5729324
	speed: 0.0129s/iter; left time: 25.7386s
	iters: 200, epoch: 1 | loss: 0.7571976
	speed: 0.0069s/iter; left time: 13.0991s
Updating learning rate to 0.0006153270642
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 2.0989162921905518
Epoch: 1, Steps: 262 | Train Loss: 0.6650650 Vali Loss: 0.2847307 Best vali loss: 0.2847307
	iters: 100, epoch: 2 | loss: 0.5898519
	speed: 0.0143s/iter; left time: 24.8937s
	iters: 200, epoch: 2 | loss: 0.8020768
	speed: 0.0067s/iter; left time: 11.0080s
Updating learning rate to 0.0003076635321
Epoch: 2 cost time: 1.7862493991851807
Epoch: 2, Steps: 262 | Train Loss: 0.6959644 Vali Loss: 0.2867685 Best vali loss: 0.2847307
	iters: 100, epoch: 3 | loss: 0.4256902
	speed: 0.0144s/iter; left time: 21.2415s
	iters: 200, epoch: 3 | loss: 0.4387180
	speed: 0.0066s/iter; left time: 9.0035s
Updating learning rate to 0.00015383176605
Validation loss decreased (0.2847 --> 0.2843).  Saving model state dict ...
Epoch: 3 cost time: 1.7877917289733887
Epoch: 3, Steps: 262 | Train Loss: 0.4322041 Vali Loss: 0.2842613 Best vali loss: 0.2842613

best validation loss 0.2842612912183625

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0030607900961, 'e_layers': 1, 'learning_rate': 0.0002423804971, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7219207
	speed: 0.0114s/iter; left time: 22.6674s
	iters: 200, epoch: 1 | loss: 0.3849798
	speed: 0.0069s/iter; left time: 13.1484s
Updating learning rate to 0.0002423804971
Validation loss decreased (inf --> 0.2998).  Saving model state dict ...
Epoch: 1 cost time: 1.8876476287841797
Epoch: 1, Steps: 262 | Train Loss: 0.5534502 Vali Loss: 0.2998107 Best vali loss: 0.2998107
	iters: 100, epoch: 2 | loss: 0.4423367
	speed: 0.0093s/iter; left time: 16.0684s
	iters: 200, epoch: 2 | loss: 0.4563342
	speed: 0.0037s/iter; left time: 5.9938s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.2998 --> 0.2858).  Saving model state dict ...
Epoch: 2 cost time: 1.035945177078247
Epoch: 2, Steps: 262 | Train Loss: 0.4493354 Vali Loss: 0.2857640 Best vali loss: 0.2857640
	iters: 100, epoch: 3 | loss: 0.3683655
	speed: 0.0158s/iter; left time: 23.2303s
	iters: 200, epoch: 3 | loss: 0.5228429
	speed: 0.0091s/iter; left time: 12.4445s
Updating learning rate to 6.0595124275e-05
Validation loss decreased (0.2858 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 2.315331220626831
Epoch: 3, Steps: 262 | Train Loss: 0.4456042 Vali Loss: 0.2835065 Best vali loss: 0.2835065

best validation loss 0.2835064501861473

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6086414
	speed: 0.0371s/iter; left time: 20.6201s
Updating learning rate to 0.00010046164245
Epoch: 4 cost time: 4.241794586181641
Epoch: 4, Steps: 131 | Train Loss: 0.6086414 Vali Loss: 0.2986503 Best vali loss: 0.2792235
	iters: 100, epoch: 5 | loss: 0.3467017
	speed: 0.0478s/iter; left time: 20.3285s
Updating learning rate to 5.0230821225e-05
Epoch: 5 cost time: 3.951723575592041
Epoch: 5, Steps: 131 | Train Loss: 0.3467017 Vali Loss: 0.3021963 Best vali loss: 0.2792235
	iters: 100, epoch: 6 | loss: 0.3396227
	speed: 0.0572s/iter; left time: 16.8186s
Updating learning rate to 2.51154106125e-05
Epoch: 6 cost time: 3.7402989864349365
Epoch: 6, Steps: 131 | Train Loss: 0.3396227 Vali Loss: 0.3034355 Best vali loss: 0.2792235
	iters: 100, epoch: 7 | loss: 0.4381928
	speed: 0.0615s/iter; left time: 10.0263s
Updating learning rate to 1.255770530625e-05
Epoch: 7 cost time: 3.6952731609344482
Epoch: 7, Steps: 131 | Train Loss: 0.4381928 Vali Loss: 0.3062444 Best vali loss: 0.2792235
	iters: 100, epoch: 8 | loss: 0.6806064
	speed: 0.0482s/iter; left time: 1.5416s
Updating learning rate to 6.278852653125e-06
Epoch: 8 cost time: 3.5735278129577637
Epoch: 8, Steps: 131 | Train Loss: 0.6806064 Vali Loss: 0.3049975 Best vali loss: 0.2792235

best validation loss 0.2792234520385282

[INFO][abstract_intensifier.py:595] Added config 8f48b8 and rejected config e98a6b as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015028868658, 'e_layers': 3, 'learning_rate': 0.000202867082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8945907
	speed: 0.0167s/iter; left time: 33.3845s
	iters: 200, epoch: 1 | loss: 0.5266863
	speed: 0.0121s/iter; left time: 22.9283s
Updating learning rate to 0.000202867082
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 3.43318510055542
Epoch: 1, Steps: 262 | Train Loss: 0.7106385 Vali Loss: 0.2829164 Best vali loss: 0.2829164
	iters: 100, epoch: 2 | loss: 0.6454085
	speed: 0.0342s/iter; left time: 59.3903s
	iters: 200, epoch: 2 | loss: 0.4705918
	speed: 0.0124s/iter; left time: 20.3217s
Updating learning rate to 0.000101433541
Validation loss decreased (0.2829 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 3.3002820014953613
Epoch: 2, Steps: 262 | Train Loss: 0.5580001 Vali Loss: 0.2808908 Best vali loss: 0.2808908
	iters: 100, epoch: 3 | loss: 0.3446802
	speed: 0.0301s/iter; left time: 44.3633s
	iters: 200, epoch: 3 | loss: 0.4555958
	speed: 0.0123s/iter; left time: 16.9187s
Updating learning rate to 5.07167705e-05
Epoch: 3 cost time: 3.2933483123779297
Epoch: 3, Steps: 262 | Train Loss: 0.4001380 Vali Loss: 0.2827058 Best vali loss: 0.2808908
	iters: 100, epoch: 4 | loss: 0.2932662
	speed: 0.0379s/iter; left time: 45.9422s
	iters: 200, epoch: 4 | loss: 0.3201322
	speed: 0.0125s/iter; left time: 13.9271s
Updating learning rate to 2.535838525e-05
Epoch: 4 cost time: 3.3398046493530273
Epoch: 4, Steps: 262 | Train Loss: 0.3066992 Vali Loss: 0.2828600 Best vali loss: 0.2808908
	iters: 100, epoch: 5 | loss: 0.3899897
	speed: 0.0322s/iter; left time: 30.5553s
	iters: 200, epoch: 5 | loss: 0.3333420
	speed: 0.0122s/iter; left time: 10.3250s
Updating learning rate to 1.2679192625e-05
Epoch: 5 cost time: 3.208552598953247
Epoch: 5, Steps: 262 | Train Loss: 0.3616659 Vali Loss: 0.2889868 Best vali loss: 0.2808908
	iters: 100, epoch: 6 | loss: 0.3238872
	speed: 0.0368s/iter; left time: 25.2513s
	iters: 200, epoch: 6 | loss: 0.4130227
	speed: 0.0088s/iter; left time: 5.1887s
Updating learning rate to 6.3395963125e-06
Epoch: 6 cost time: 2.884364604949951
Epoch: 6, Steps: 262 | Train Loss: 0.3684550 Vali Loss: 0.2885264 Best vali loss: 0.2808908
	iters: 100, epoch: 7 | loss: 0.3356348
	speed: 0.0287s/iter; left time: 12.1859s
	iters: 200, epoch: 7 | loss: 0.3907698
	speed: 0.0123s/iter; left time: 3.9954s
Updating learning rate to 3.16979815625e-06
Epoch: 7 cost time: 3.2836086750030518
Epoch: 7, Steps: 262 | Train Loss: 0.3632023 Vali Loss: 0.2913963 Best vali loss: 0.2808908
	iters: 100, epoch: 8 | loss: 0.4081728
	speed: 0.0326s/iter; left time: 5.3136s
	iters: 200, epoch: 8 | loss: 0.2850698
	speed: 0.0110s/iter; left time: 0.6909s
Updating learning rate to 1.584899078125e-06
Epoch: 8 cost time: 2.9247167110443115
Epoch: 8, Steps: 262 | Train Loss: 0.3466213 Vali Loss: 0.2921788 Best vali loss: 0.2808908

best validation loss 0.280890752088629

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0026114276247, 'e_layers': 2, 'learning_rate': 0.0003412042455, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8260152
	speed: 0.0150s/iter; left time: 29.9955s
	iters: 200, epoch: 1 | loss: 0.7941133
	speed: 0.0092s/iter; left time: 17.4700s
Updating learning rate to 0.0003412042455
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 2.7032177448272705
Epoch: 1, Steps: 262 | Train Loss: 0.8100643 Vali Loss: 0.2868229 Best vali loss: 0.2868229
	iters: 100, epoch: 2 | loss: 0.7916073
	speed: 0.0267s/iter; left time: 46.2597s
	iters: 200, epoch: 2 | loss: 0.7811539
	speed: 0.0125s/iter; left time: 20.4779s
Updating learning rate to 0.00017060212275
Validation loss decreased (0.2868 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 3.222872257232666
Epoch: 2, Steps: 262 | Train Loss: 0.7863806 Vali Loss: 0.2838655 Best vali loss: 0.2838655
	iters: 100, epoch: 3 | loss: 0.5367882
	speed: 0.0541s/iter; left time: 79.7120s
	iters: 200, epoch: 3 | loss: 0.4645723
	speed: 0.0133s/iter; left time: 18.2878s
Updating learning rate to 8.5301061375e-05
Validation loss decreased (0.2839 --> 0.2777).  Saving model state dict ...
Epoch: 3 cost time: 3.694352865219116
Epoch: 3, Steps: 262 | Train Loss: 0.5006803 Vali Loss: 0.2777477 Best vali loss: 0.2777477
	iters: 100, epoch: 4 | loss: 0.4019479
	speed: 0.0495s/iter; left time: 59.9505s
	iters: 200, epoch: 4 | loss: 0.3703892
	speed: 0.0130s/iter; left time: 14.4730s
Updating learning rate to 4.26505306875e-05
Epoch: 4 cost time: 3.570679187774658
Epoch: 4, Steps: 262 | Train Loss: 0.3861685 Vali Loss: 0.2800284 Best vali loss: 0.2777477
	iters: 100, epoch: 5 | loss: 0.2429137
	speed: 0.0533s/iter; left time: 50.5702s
	iters: 200, epoch: 5 | loss: 0.3555116
	speed: 0.0134s/iter; left time: 11.4027s
Updating learning rate to 2.132526534375e-05
Epoch: 5 cost time: 3.6946022510528564
Epoch: 5, Steps: 262 | Train Loss: 0.2992126 Vali Loss: 0.2813424 Best vali loss: 0.2777477
	iters: 100, epoch: 6 | loss: 0.2699639
	speed: 0.0520s/iter; left time: 35.7103s
	iters: 200, epoch: 6 | loss: 0.3800106
	speed: 0.0127s/iter; left time: 7.4836s
Updating learning rate to 1.0662632671875e-05
Epoch: 6 cost time: 3.6802566051483154
Epoch: 6, Steps: 262 | Train Loss: 0.3249873 Vali Loss: 0.2801721 Best vali loss: 0.2777477
	iters: 100, epoch: 7 | loss: 0.4103454
	speed: 0.0399s/iter; left time: 16.9533s
	iters: 200, epoch: 7 | loss: 0.3863005
	speed: 0.0097s/iter; left time: 3.1657s
Updating learning rate to 5.3313163359375e-06
Epoch: 7 cost time: 2.598395824432373
Epoch: 7, Steps: 262 | Train Loss: 0.3983230 Vali Loss: 0.2813097 Best vali loss: 0.2777477
	iters: 100, epoch: 8 | loss: 0.2577383
	speed: 0.0185s/iter; left time: 3.0080s
	iters: 200, epoch: 8 | loss: 0.3203030
	speed: 0.0097s/iter; left time: 0.6092s
Updating learning rate to 2.66565816796875e-06
Epoch: 8 cost time: 2.4080498218536377
Epoch: 8, Steps: 262 | Train Loss: 0.2890206 Vali Loss: 0.2809242 Best vali loss: 0.2777477

best validation loss 0.277747705905754

[INFO][abstract_intensifier.py:595] Added config eb8e22 and rejected config 8f48b8 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4453068
	speed: 0.0253s/iter; left time: 23.9690s
Updating learning rate to 0.0002884157887385461
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 2.68440580368042
Epoch: 1, Steps: 131 | Train Loss: 0.4453068 Vali Loss: 0.2814750 Best vali loss: 0.2814750
	iters: 100, epoch: 2 | loss: 0.2950404
	speed: 0.0204s/iter; left time: 16.6544s
Updating learning rate to 0.00025591859596019184
Validation loss decreased (0.2815 --> 0.2785).  Saving model state dict ...
Epoch: 2 cost time: 1.238647699356079
Epoch: 2, Steps: 131 | Train Loss: 0.2950404 Vali Loss: 0.2784586 Best vali loss: 0.2784586
	iters: 100, epoch: 3 | loss: 0.4354944
	speed: 0.0284s/iter; left time: 19.4815s
Updating learning rate to 0.00020728310997765554
Epoch: 3 cost time: 2.511143684387207
Epoch: 3, Steps: 131 | Train Loss: 0.4354944 Vali Loss: 0.2889354 Best vali loss: 0.2784586

best validation loss 0.2784585914300604

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 1, 'learning_rate': 0.0035418893013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4768091
	speed: 0.0225s/iter; left time: 21.3127s
Updating learning rate to 0.0035418893013
Validation loss decreased (inf --> 0.3499).  Saving model state dict ...
Epoch: 1 cost time: 2.30304217338562
Epoch: 1, Steps: 131 | Train Loss: 0.4768091 Vali Loss: 0.3499358 Best vali loss: 0.3499358
	iters: 100, epoch: 2 | loss: 0.5337266
	speed: 0.0272s/iter; left time: 22.2575s
Updating learning rate to 0.00177094465065
Validation loss decreased (0.3499 --> 0.3000).  Saving model state dict ...
Epoch: 2 cost time: 2.0625226497650146
Epoch: 2, Steps: 131 | Train Loss: 0.5337266 Vali Loss: 0.2999837 Best vali loss: 0.2999837
	iters: 100, epoch: 3 | loss: 0.5343127
	speed: 0.0257s/iter; left time: 17.6895s
Updating learning rate to 0.000885472325325
Epoch: 3 cost time: 1.6384317874908447
Epoch: 3, Steps: 131 | Train Loss: 0.5343127 Vali Loss: 0.3067616 Best vali loss: 0.2999837

best validation loss 0.2999837201139926

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017113089176, 'e_layers': 4, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5229468
	speed: 0.0160s/iter; left time: 132.1265s
	iters: 200, epoch: 1 | loss: 0.4625005
	speed: 0.0089s/iter; left time: 72.3974s
	iters: 300, epoch: 1 | loss: 0.4765468
	speed: 0.0100s/iter; left time: 80.3685s
	iters: 400, epoch: 1 | loss: 0.3093673
	speed: 0.0096s/iter; left time: 76.5277s
	iters: 500, epoch: 1 | loss: 0.7368546
	speed: 0.0093s/iter; left time: 72.8980s
	iters: 600, epoch: 1 | loss: 0.5432246
	speed: 0.0097s/iter; left time: 75.1280s
	iters: 700, epoch: 1 | loss: 0.3249820
	speed: 0.0096s/iter; left time: 73.7702s
	iters: 800, epoch: 1 | loss: 1.6716818
	speed: 0.0081s/iter; left time: 61.1606s
	iters: 900, epoch: 1 | loss: 0.6115894
	speed: 0.0096s/iter; left time: 71.6833s
	iters: 1000, epoch: 1 | loss: 2.0175793
	speed: 0.0093s/iter; left time: 68.6135s
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.3265).  Saving model state dict ...
Epoch: 1 cost time: 10.12001371383667
Epoch: 1, Steps: 1045 | Train Loss: 0.8677273 Vali Loss: 0.3264508 Best vali loss: 0.3264508
	iters: 100, epoch: 2 | loss: 0.4188672
	speed: 0.0253s/iter; left time: 182.4189s
	iters: 200, epoch: 2 | loss: 1.1474540
	speed: 0.0078s/iter; left time: 55.3523s
	iters: 300, epoch: 2 | loss: 0.4312343
	speed: 0.0086s/iter; left time: 60.1836s
	iters: 400, epoch: 2 | loss: 0.7071439
	speed: 0.0089s/iter; left time: 61.4842s
	iters: 500, epoch: 2 | loss: 0.3419435
	speed: 0.0081s/iter; left time: 55.0511s
	iters: 600, epoch: 2 | loss: 0.2313778
	speed: 0.0097s/iter; left time: 64.9529s
	iters: 700, epoch: 2 | loss: 0.5530255
	speed: 0.0103s/iter; left time: 67.9357s
	iters: 800, epoch: 2 | loss: 0.2765701
	speed: 0.0091s/iter; left time: 59.5330s
	iters: 900, epoch: 2 | loss: 0.2506283
	speed: 0.0083s/iter; left time: 53.3976s
	iters: 1000, epoch: 2 | loss: 0.2555360
	speed: 0.0077s/iter; left time: 48.9158s
Updating learning rate to 0.002058451742387382
Validation loss decreased (0.3265 --> 0.3208).  Saving model state dict ...
Epoch: 2 cost time: 9.055055618286133
Epoch: 2, Steps: 1045 | Train Loss: 0.4613781 Vali Loss: 0.3207772 Best vali loss: 0.3207772
	iters: 100, epoch: 3 | loss: 0.4038706
	speed: 0.0232s/iter; left time: 143.2676s
	iters: 200, epoch: 3 | loss: 1.1409243
	speed: 0.0079s/iter; left time: 47.7467s
	iters: 300, epoch: 3 | loss: 0.2118315
	speed: 0.0089s/iter; left time: 52.9792s
	iters: 400, epoch: 3 | loss: 0.3521934
	speed: 0.0090s/iter; left time: 52.8302s
	iters: 500, epoch: 3 | loss: 1.0016714
	speed: 0.0067s/iter; left time: 38.5719s
	iters: 600, epoch: 3 | loss: 0.4279652
	speed: 0.0085s/iter; left time: 48.1865s
	iters: 700, epoch: 3 | loss: 0.6160836
	speed: 0.0102s/iter; left time: 56.6468s
	iters: 800, epoch: 3 | loss: 0.4177378
	speed: 0.0090s/iter; left time: 49.4862s
	iters: 900, epoch: 3 | loss: 1.2434841
	speed: 0.0088s/iter; left time: 47.3918s
	iters: 1000, epoch: 3 | loss: 0.4410214
	speed: 0.0082s/iter; left time: 43.4744s
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 8.810601949691772
Epoch: 3, Steps: 1045 | Train Loss: 0.6256783 Vali Loss: 0.3221064 Best vali loss: 0.3207772

best validation loss 0.32077719731683757

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4233357
	speed: 0.0300s/iter; left time: 16.6827s
Updating learning rate to 0.00014991364265
Epoch: 4 cost time: 3.4444291591644287
Epoch: 4, Steps: 131 | Train Loss: 0.4233357 Vali Loss: 0.2812501 Best vali loss: 0.2784586
	iters: 100, epoch: 5 | loss: 0.2823588
	speed: 0.0598s/iter; left time: 25.4080s
Updating learning rate to 9.254417532234449e-05
Epoch: 5 cost time: 4.187442302703857
Epoch: 5, Steps: 131 | Train Loss: 0.2823588 Vali Loss: 0.2864777 Best vali loss: 0.2784586
	iters: 100, epoch: 6 | loss: 0.3802577
	speed: 0.0601s/iter; left time: 17.6751s
Updating learning rate to 4.3908689339808184e-05
Epoch: 6 cost time: 3.458691120147705
Epoch: 6, Steps: 131 | Train Loss: 0.3802577 Vali Loss: 0.2792585 Best vali loss: 0.2784586
	iters: 100, epoch: 7 | loss: 0.4331086
	speed: 0.0520s/iter; left time: 8.4684s
Updating learning rate to 1.1411496561453903e-05
Epoch: 7 cost time: 3.9620344638824463
Epoch: 7, Steps: 131 | Train Loss: 0.4331086 Vali Loss: 0.2808992 Best vali loss: 0.2784586
	iters: 100, epoch: 8 | loss: 0.3248261
	speed: 0.0563s/iter; left time: 1.8028s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.097308874130249
Epoch: 8, Steps: 131 | Train Loss: 0.3248261 Vali Loss: 0.2796132 Best vali loss: 0.2784586

best validation loss 0.2784585914300604

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002592776834, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3535491
	speed: 0.0131s/iter; left time: 53.5791s
	iters: 200, epoch: 1 | loss: 0.4517962
	speed: 0.0064s/iter; left time: 25.5109s
	iters: 300, epoch: 1 | loss: 0.3421347
	speed: 0.0084s/iter; left time: 32.4417s
	iters: 400, epoch: 1 | loss: 0.5637489
	speed: 0.0076s/iter; left time: 28.7652s
	iters: 500, epoch: 1 | loss: 0.4007724
	speed: 0.0056s/iter; left time: 20.7402s
Updating learning rate to 0.0002592776834
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 3.9086055755615234
Epoch: 1, Steps: 523 | Train Loss: 0.4224003 Vali Loss: 0.2821783 Best vali loss: 0.2821783
	iters: 100, epoch: 2 | loss: 0.4060875
	speed: 0.0140s/iter; left time: 49.8331s
	iters: 200, epoch: 2 | loss: 0.5348472
	speed: 0.0073s/iter; left time: 25.1488s
	iters: 300, epoch: 2 | loss: 0.3155143
	speed: 0.0076s/iter; left time: 25.5696s
	iters: 400, epoch: 2 | loss: 1.5161558
	speed: 0.0058s/iter; left time: 19.0586s
	iters: 500, epoch: 2 | loss: 0.4278414
	speed: 0.0045s/iter; left time: 14.2927s
Updating learning rate to 0.0001296388417
Validation loss decreased (0.2822 --> 0.2805).  Saving model state dict ...
Epoch: 2 cost time: 3.394185781478882
Epoch: 2, Steps: 523 | Train Loss: 0.6400892 Vali Loss: 0.2805056 Best vali loss: 0.2805056
	iters: 100, epoch: 3 | loss: 0.3181176
	speed: 0.0149s/iter; left time: 45.1967s
	iters: 200, epoch: 3 | loss: 0.5222870
	speed: 0.0062s/iter; left time: 18.2591s
	iters: 300, epoch: 3 | loss: 1.0054568
	speed: 0.0056s/iter; left time: 15.8255s
	iters: 400, epoch: 3 | loss: 0.3296415
	speed: 0.0063s/iter; left time: 17.3853s
	iters: 500, epoch: 3 | loss: 0.6583404
	speed: 0.0064s/iter; left time: 17.0173s
Updating learning rate to 6.481942085e-05
Epoch: 3 cost time: 3.3205440044403076
Epoch: 3, Steps: 523 | Train Loss: 0.5667687 Vali Loss: 0.2843950 Best vali loss: 0.2805056
	iters: 100, epoch: 4 | loss: 0.2295031
	speed: 0.0133s/iter; left time: 33.4486s
	iters: 200, epoch: 4 | loss: 0.5181115
	speed: 0.0041s/iter; left time: 9.8906s
	iters: 300, epoch: 4 | loss: 0.3406603
	speed: 0.0055s/iter; left time: 12.7735s
	iters: 400, epoch: 4 | loss: 0.4859101
	speed: 0.0075s/iter; left time: 16.6842s
	iters: 500, epoch: 4 | loss: 0.2805967
	speed: 0.0070s/iter; left time: 14.8290s
Updating learning rate to 3.2409710425e-05
Epoch: 4 cost time: 3.1000449657440186
Epoch: 4, Steps: 523 | Train Loss: 0.3709563 Vali Loss: 0.2843743 Best vali loss: 0.2805056
	iters: 100, epoch: 5 | loss: 0.3383014
	speed: 0.0186s/iter; left time: 37.0765s
	iters: 200, epoch: 5 | loss: 0.3854693
	speed: 0.0087s/iter; left time: 16.4412s
	iters: 300, epoch: 5 | loss: 0.5179198
	speed: 0.0089s/iter; left time: 16.0289s
	iters: 400, epoch: 5 | loss: 0.4676162
	speed: 0.0077s/iter; left time: 13.0045s
	iters: 500, epoch: 5 | loss: 0.3002503
	speed: 0.0053s/iter; left time: 8.3824s
Updating learning rate to 1.62048552125e-05
Epoch: 5 cost time: 4.0956878662109375
Epoch: 5, Steps: 523 | Train Loss: 0.4019114 Vali Loss: 0.2845925 Best vali loss: 0.2805056
	iters: 100, epoch: 6 | loss: 0.8421882
	speed: 0.0156s/iter; left time: 22.9624s
	iters: 200, epoch: 6 | loss: 0.8220012
	speed: 0.0058s/iter; left time: 7.9325s
	iters: 300, epoch: 6 | loss: 0.6564810
	speed: 0.0051s/iter; left time: 6.5350s
	iters: 400, epoch: 6 | loss: 0.3560611
	speed: 0.0060s/iter; left time: 7.0290s
	iters: 500, epoch: 6 | loss: 0.7035559
	speed: 0.0061s/iter; left time: 6.5656s
Updating learning rate to 8.10242760625e-06
Epoch: 6 cost time: 3.214216709136963
Epoch: 6, Steps: 523 | Train Loss: 0.6760575 Vali Loss: 0.2850028 Best vali loss: 0.2805056
	iters: 100, epoch: 7 | loss: 0.6283985
	speed: 0.0135s/iter; left time: 12.7900s
	iters: 200, epoch: 7 | loss: 0.6422334
	speed: 0.0061s/iter; left time: 5.1999s
	iters: 300, epoch: 7 | loss: 0.2607636
	speed: 0.0059s/iter; left time: 4.4367s
	iters: 400, epoch: 7 | loss: 0.3741303
	speed: 0.0059s/iter; left time: 3.8316s
	iters: 500, epoch: 7 | loss: 0.5549540
	speed: 0.0067s/iter; left time: 3.6396s
Updating learning rate to 4.051213803125e-06
Epoch: 7 cost time: 3.144606590270996
Epoch: 7, Steps: 523 | Train Loss: 0.4920960 Vali Loss: 0.2852269 Best vali loss: 0.2805056
	iters: 100, epoch: 8 | loss: 0.4007509
	speed: 0.0150s/iter; left time: 6.3480s
	iters: 200, epoch: 8 | loss: 0.3141728
	speed: 0.0062s/iter; left time: 2.0047s
	iters: 300, epoch: 8 | loss: 0.3935619
	speed: 0.0051s/iter; left time: 1.1414s
	iters: 400, epoch: 8 | loss: 0.4296246
	speed: 0.0060s/iter; left time: 0.7438s
	iters: 500, epoch: 8 | loss: 0.2683153
	speed: 0.0067s/iter; left time: 0.1599s
Updating learning rate to 2.0256069015625e-06
Epoch: 8 cost time: 3.2723875045776367
Epoch: 8, Steps: 523 | Train Loss: 0.3612851 Vali Loss: 0.2854367 Best vali loss: 0.2805056

best validation loss 0.28050558610936

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010733605571, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7258959
	speed: 0.0261s/iter; left time: 24.7455s
Updating learning rate to 6.11157199e-05
Validation loss decreased (inf --> 0.3457).  Saving model state dict ...
Epoch: 1 cost time: 2.938100814819336
Epoch: 1, Steps: 131 | Train Loss: 0.7258959 Vali Loss: 0.3456850 Best vali loss: 0.3456850
	iters: 100, epoch: 2 | loss: 0.5853534
	speed: 0.0363s/iter; left time: 29.6594s
Updating learning rate to 3.055785995e-05
Validation loss decreased (0.3457 --> 0.3288).  Saving model state dict ...
Epoch: 2 cost time: 2.6651647090911865
Epoch: 2, Steps: 131 | Train Loss: 0.5853534 Vali Loss: 0.3287507 Best vali loss: 0.3287507
	iters: 100, epoch: 3 | loss: 0.7210594
	speed: 0.0319s/iter; left time: 21.9120s
Updating learning rate to 1.5278929975e-05
Validation loss decreased (0.3288 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 2.4741899967193604
Epoch: 3, Steps: 131 | Train Loss: 0.7210594 Vali Loss: 0.3226410 Best vali loss: 0.3226410
	iters: 100, epoch: 4 | loss: 0.4366894
	speed: 0.0198s/iter; left time: 10.9833s
Updating learning rate to 7.6394649875e-06
Validation loss decreased (0.3226 --> 0.3200).  Saving model state dict ...
Epoch: 4 cost time: 1.6606757640838623
Epoch: 4, Steps: 131 | Train Loss: 0.4366894 Vali Loss: 0.3200071 Best vali loss: 0.3200071
	iters: 100, epoch: 5 | loss: 0.7852739
	speed: 0.0323s/iter; left time: 13.7258s
Updating learning rate to 3.81973249375e-06
Validation loss decreased (0.3200 --> 0.3188).  Saving model state dict ...
Epoch: 5 cost time: 2.162262439727783
Epoch: 5, Steps: 131 | Train Loss: 0.7852739 Vali Loss: 0.3187795 Best vali loss: 0.3187795
	iters: 100, epoch: 6 | loss: 0.6104639
	speed: 0.0184s/iter; left time: 5.4111s
Updating learning rate to 1.909866246875e-06
Validation loss decreased (0.3188 --> 0.3182).  Saving model state dict ...
Epoch: 6 cost time: 1.686002492904663
Epoch: 6, Steps: 131 | Train Loss: 0.6104639 Vali Loss: 0.3181745 Best vali loss: 0.3181745
	iters: 100, epoch: 7 | loss: 0.5332958
	speed: 0.0323s/iter; left time: 5.2688s
Updating learning rate to 9.549331234375e-07
Validation loss decreased (0.3182 --> 0.3179).  Saving model state dict ...
Epoch: 7 cost time: 2.6894612312316895
Epoch: 7, Steps: 131 | Train Loss: 0.5332958 Vali Loss: 0.3178789 Best vali loss: 0.3178789
	iters: 100, epoch: 8 | loss: 0.4147156
	speed: 0.0328s/iter; left time: 1.0507s
Updating learning rate to 4.7746656171875e-07
Validation loss decreased (0.3179 --> 0.3177).  Saving model state dict ...
Epoch: 8 cost time: 2.3329861164093018
Epoch: 8, Steps: 131 | Train Loss: 0.4147156 Vali Loss: 0.3177332 Best vali loss: 0.3177332

best validation loss 0.3177331801172791

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002189490937942002
Validation loss decreased (inf --> 0.2913).  Saving model state dict ...
Epoch: 1 cost time: 1.5168793201446533
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2912818 Best vali loss: 0.2912818
Updating learning rate to 0.001942790473283107
Validation loss decreased (0.2913 --> 0.2858).  Saving model state dict ...
Epoch: 2 cost time: 1.3917372226715088
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2857525 Best vali loss: 0.2857525
Updating learning rate to 0.0015735771362223516
Epoch: 3 cost time: 1.5629403591156006
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2930736 Best vali loss: 0.2857525

best validation loss 0.2857524576147013

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017721446715, 'e_layers': 4, 'learning_rate': 0.0002378546774, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002378546774
Validation loss decreased (inf --> 0.3267).  Saving model state dict ...
Epoch: 1 cost time: 1.2728521823883057
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3266645 Best vali loss: 0.3266645
Updating learning rate to 0.0001189273387
Validation loss decreased (0.3267 --> 0.3075).  Saving model state dict ...
Epoch: 2 cost time: 0.817746639251709
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3074526 Best vali loss: 0.3074526
Updating learning rate to 5.946366935e-05
Validation loss decreased (0.3075 --> 0.3017).  Saving model state dict ...
Epoch: 3 cost time: 0.8153424263000488
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3017051 Best vali loss: 0.3017051

best validation loss 0.3017051102681513

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 0.9840562343597412
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857509 Best vali loss: 0.2857509
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.2858 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 0.6825151443481445
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2807626 Best vali loss: 0.2807626
Updating learning rate to 0.00043994959105690174
Epoch: 3 cost time: 0.6726112365722656
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2834846 Best vali loss: 0.2807626

best validation loss 0.28076256813835415

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00031818533495
Epoch: 4 cost time: 1.0272276401519775
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2835655 Best vali loss: 0.2807626
Updating learning rate to 0.00019642107884309824
Epoch: 5 cost time: 0.7772130966186523
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2814716 Best vali loss: 0.2807626
Updating learning rate to 9.319432693274203e-05
Epoch: 6 cost time: 0.4327208995819092
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845880 Best vali loss: 0.2807626
Updating learning rate to 2.4220416444446813e-05
Epoch: 7 cost time: 0.4333384037017822
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2854324 Best vali loss: 0.2807626
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6124832630157471
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2862296 Best vali loss: 0.2807626

best validation loss 0.28076256813835415

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0036399733072, 'e_layers': 3, 'learning_rate': 0.0007179148563, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3008503
	speed: 0.0150s/iter; left time: 124.1932s
	iters: 200, epoch: 1 | loss: 0.4673465
	speed: 0.0092s/iter; left time: 74.6742s
	iters: 300, epoch: 1 | loss: 0.2284898
	speed: 0.0100s/iter; left time: 80.4769s
	iters: 400, epoch: 1 | loss: 0.1888378
	speed: 0.0096s/iter; left time: 76.3222s
	iters: 500, epoch: 1 | loss: 0.4075544
	speed: 0.0094s/iter; left time: 73.7451s
	iters: 600, epoch: 1 | loss: 1.5839485
	speed: 0.0091s/iter; left time: 70.2870s
	iters: 700, epoch: 1 | loss: 0.3673723
	speed: 0.0096s/iter; left time: 73.6877s
	iters: 800, epoch: 1 | loss: 1.4146210
	speed: 0.0096s/iter; left time: 72.3236s
	iters: 900, epoch: 1 | loss: 1.1229969
	speed: 0.0097s/iter; left time: 72.6570s
	iters: 1000, epoch: 1 | loss: 0.3379419
	speed: 0.0098s/iter; left time: 72.0183s
Updating learning rate to 0.0006905908490606759
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 10.240644931793213
Epoch: 1, Steps: 1045 | Train Loss: 0.6419960 Vali Loss: 0.2851680 Best vali loss: 0.2851680
	iters: 100, epoch: 2 | loss: 1.3315578
	speed: 0.0311s/iter; left time: 224.1044s
	iters: 200, epoch: 2 | loss: 0.3328304
	speed: 0.0075s/iter; left time: 53.1970s
	iters: 300, epoch: 2 | loss: 0.7494724
	speed: 0.0087s/iter; left time: 60.9806s
	iters: 400, epoch: 2 | loss: 0.4747518
	speed: 0.0112s/iter; left time: 77.6945s
	iters: 500, epoch: 2 | loss: 0.2955503
	speed: 0.0119s/iter; left time: 81.1009s
	iters: 600, epoch: 2 | loss: 0.7618443
	speed: 0.0103s/iter; left time: 68.9720s
	iters: 700, epoch: 2 | loss: 0.7169189
	speed: 0.0088s/iter; left time: 58.5299s
	iters: 800, epoch: 2 | loss: 0.5802765
	speed: 0.0116s/iter; left time: 75.2790s
	iters: 900, epoch: 2 | loss: 1.2892456
	speed: 0.0102s/iter; left time: 65.3664s
	iters: 1000, epoch: 2 | loss: 1.1405072
	speed: 0.0071s/iter; left time: 45.0842s
Updating learning rate to 0.0006127786597521479
Epoch: 2 cost time: 10.053115844726562
Epoch: 2, Steps: 1045 | Train Loss: 0.7672955 Vali Loss: 0.2925485 Best vali loss: 0.2851680
	iters: 100, epoch: 3 | loss: 0.1988411
	speed: 0.0320s/iter; left time: 197.5970s
	iters: 200, epoch: 3 | loss: 0.3199540
	speed: 0.0078s/iter; left time: 47.5127s
	iters: 300, epoch: 3 | loss: 1.2464620
	speed: 0.0091s/iter; left time: 54.1383s
	iters: 400, epoch: 3 | loss: 0.2649912
	speed: 0.0105s/iter; left time: 61.4315s
	iters: 500, epoch: 3 | loss: 0.2409276
	speed: 0.0099s/iter; left time: 56.9929s
	iters: 600, epoch: 3 | loss: 0.3603155
	speed: 0.0110s/iter; left time: 62.1132s
	iters: 700, epoch: 3 | loss: 0.3119589
	speed: 0.0113s/iter; left time: 62.9046s
	iters: 800, epoch: 3 | loss: 0.5936280
	speed: 0.0110s/iter; left time: 60.4161s
	iters: 900, epoch: 3 | loss: 0.3251144
	speed: 0.0075s/iter; left time: 40.4638s
	iters: 1000, epoch: 3 | loss: 1.0459814
	speed: 0.0067s/iter; left time: 35.4876s
Updating learning rate to 0.0004963244888273871
Epoch: 3 cost time: 9.76907229423523
Epoch: 3, Steps: 1045 | Train Loss: 0.4908174 Vali Loss: 0.2923558 Best vali loss: 0.2851680
	iters: 100, epoch: 4 | loss: 0.3279531
	speed: 0.0273s/iter; left time: 140.1938s
	iters: 200, epoch: 4 | loss: 0.4293212
	speed: 0.0084s/iter; left time: 42.1673s
	iters: 300, epoch: 4 | loss: 0.2951524
	speed: 0.0085s/iter; left time: 41.7312s
	iters: 400, epoch: 4 | loss: 0.1702439
	speed: 0.0086s/iter; left time: 41.7336s
	iters: 500, epoch: 4 | loss: 0.5487247
	speed: 0.0086s/iter; left time: 40.4445s
	iters: 600, epoch: 4 | loss: 1.0717922
	speed: 0.0089s/iter; left time: 41.0304s
	iters: 700, epoch: 4 | loss: 0.3603456
	speed: 0.0085s/iter; left time: 38.3730s
	iters: 800, epoch: 4 | loss: 0.2346842
	speed: 0.0080s/iter; left time: 35.4991s
	iters: 900, epoch: 4 | loss: 0.3456912
	speed: 0.0066s/iter; left time: 28.4387s
	iters: 1000, epoch: 4 | loss: 0.8531612
	speed: 0.0074s/iter; left time: 31.2403s
Updating learning rate to 0.00035895742815
Epoch: 4 cost time: 8.56850552558899
Epoch: 4, Steps: 1045 | Train Loss: 0.4637070 Vali Loss: 0.2950551 Best vali loss: 0.2851680
	iters: 100, epoch: 5 | loss: 1.0084525
	speed: 0.0277s/iter; left time: 112.8661s
	iters: 200, epoch: 5 | loss: 0.3964332
	speed: 0.0085s/iter; left time: 33.9342s
	iters: 300, epoch: 5 | loss: 0.2677053
	speed: 0.0086s/iter; left time: 33.2878s
	iters: 400, epoch: 5 | loss: 0.3135517
	speed: 0.0087s/iter; left time: 33.0292s
	iters: 500, epoch: 5 | loss: 0.4450551
	speed: 0.0086s/iter; left time: 31.5606s
	iters: 600, epoch: 5 | loss: 0.1869841
	speed: 0.0088s/iter; left time: 31.5279s
	iters: 700, epoch: 5 | loss: 0.6369977
	speed: 0.0086s/iter; left time: 29.7885s
	iters: 800, epoch: 5 | loss: 0.2849568
	speed: 0.0081s/iter; left time: 27.5478s
	iters: 900, epoch: 5 | loss: 0.2948820
	speed: 0.0068s/iter; left time: 22.2689s
	iters: 1000, epoch: 5 | loss: 0.2425780
	speed: 0.0059s/iter; left time: 18.6983s
Updating learning rate to 0.00022159036747261294
Epoch: 5 cost time: 8.458338975906372
Epoch: 5, Steps: 1045 | Train Loss: 0.4077596 Vali Loss: 0.2958232 Best vali loss: 0.2851680
	iters: 100, epoch: 6 | loss: 0.3992824
	speed: 0.0286s/iter; left time: 86.7151s
	iters: 200, epoch: 6 | loss: 0.2114471
	speed: 0.0082s/iter; left time: 24.1195s
	iters: 300, epoch: 6 | loss: 0.7915499
	speed: 0.0072s/iter; left time: 20.3786s
	iters: 400, epoch: 6 | loss: 0.2700279
	speed: 0.0071s/iter; left time: 19.4854s
	iters: 500, epoch: 6 | loss: 0.2335888
	speed: 0.0096s/iter; left time: 25.3020s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050164002415, 'e_layers': 1, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5955390
	speed: 0.0114s/iter; left time: 94.1900s
	iters: 200, epoch: 1 | loss: 1.2493234
	speed: 0.0041s/iter; left time: 33.6601s
	iters: 300, epoch: 1 | loss: 0.4619548
	speed: 0.0034s/iter; left time: 27.4761s
	iters: 400, epoch: 1 | loss: 0.3804772
	speed: 0.0055s/iter; left time: 43.9906s
	iters: 500, epoch: 1 | loss: 0.2020169
	speed: 0.0066s/iter; left time: 51.5088s
	iters: 600, epoch: 1 | loss: 0.6048420
	speed: 0.0062s/iter; left time: 48.2140s
	iters: 700, epoch: 1 | loss: 0.3395358
	speed: 0.0063s/iter; left time: 48.2950s
	iters: 800, epoch: 1 | loss: 0.3296717
	speed: 0.0054s/iter; left time: 40.7517s
	iters: 900, epoch: 1 | loss: 0.4508386
	speed: 0.0066s/iter; left time: 49.1961s
	iters: 1000, epoch: 1 | loss: 0.3663106
	speed: 0.0049s/iter; left time: 35.8482s
Updating learning rate to 0.0005311094169208142
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 5.91823935508728
Epoch: 1, Steps: 1045 | Train Loss: 0.4980510 Vali Loss: 0.2805102 Best vali loss: 0.2805102
	iters: 100, epoch: 2 | loss: 0.4489152
	speed: 0.0199s/iter; left time: 143.7345s
	iters: 200, epoch: 2 | loss: 0.4930659
	speed: 0.0051s/iter; left time: 36.1567s
	iters: 300, epoch: 2 | loss: 0.2621375
	speed: 0.0048s/iter; left time: 33.8880s
	iters: 400, epoch: 2 | loss: 0.3920352
	speed: 0.0052s/iter; left time: 35.6454s
	iters: 500, epoch: 2 | loss: 0.2441924
	speed: 0.0051s/iter; left time: 34.8230s
	iters: 600, epoch: 2 | loss: 0.2695686
	speed: 0.0053s/iter; left time: 35.6790s
	iters: 700, epoch: 2 | loss: 0.5025924
	speed: 0.0039s/iter; left time: 25.9990s
	iters: 800, epoch: 2 | loss: 0.8067505
	speed: 0.0043s/iter; left time: 28.1193s
	iters: 900, epoch: 2 | loss: 1.3248421
	speed: 0.0042s/iter; left time: 26.7109s
	iters: 1000, epoch: 2 | loss: 0.2929025
	speed: 0.0047s/iter; left time: 29.5401s
Updating learning rate to 0.0004712667668926594
Epoch: 2 cost time: 5.056244373321533
Epoch: 2, Steps: 1045 | Train Loss: 0.5037002 Vali Loss: 0.2928943 Best vali loss: 0.2805102
	iters: 100, epoch: 3 | loss: 0.2307766
	speed: 0.0217s/iter; left time: 133.6762s
	iters: 200, epoch: 3 | loss: 0.3489325
	speed: 0.0046s/iter; left time: 27.9716s
	iters: 300, epoch: 3 | loss: 0.2752008
	speed: 0.0045s/iter; left time: 26.7601s
	iters: 400, epoch: 3 | loss: 0.2483393
	speed: 0.0055s/iter; left time: 32.4286s
	iters: 500, epoch: 3 | loss: 0.4349809
	speed: 0.0052s/iter; left time: 29.7880s
	iters: 600, epoch: 3 | loss: 0.3355306
	speed: 0.0051s/iter; left time: 29.1079s
	iters: 700, epoch: 3 | loss: 0.4301041
	speed: 0.0046s/iter; left time: 25.8869s
	iters: 800, epoch: 3 | loss: 0.1872726
	speed: 0.0051s/iter; left time: 27.8651s
	iters: 900, epoch: 3 | loss: 0.5647487
	speed: 0.0048s/iter; left time: 25.9721s
	iters: 1000, epoch: 3 | loss: 0.5798656
	speed: 0.0067s/iter; left time: 35.3912s
Updating learning rate to 0.00038170591200734896
Epoch: 3 cost time: 5.512332916259766
Epoch: 3, Steps: 1045 | Train Loss: 0.3635752 Vali Loss: 0.2939058 Best vali loss: 0.2805102
	iters: 100, epoch: 4 | loss: 0.5556515
	speed: 0.0186s/iter; left time: 95.4319s
	iters: 200, epoch: 4 | loss: 1.0434092
	speed: 0.0048s/iter; left time: 24.0365s
	iters: 300, epoch: 4 | loss: 0.5901257
	speed: 0.0053s/iter; left time: 26.0308s
	iters: 400, epoch: 4 | loss: 1.0309209
	speed: 0.0051s/iter; left time: 24.5355s
	iters: 500, epoch: 4 | loss: 0.1916978
	speed: 0.0048s/iter; left time: 22.8001s
	iters: 600, epoch: 4 | loss: 0.1954380
	speed: 0.0048s/iter; left time: 22.0872s
	iters: 700, epoch: 4 | loss: 0.4240822
	speed: 0.0046s/iter; left time: 20.6365s
	iters: 800, epoch: 4 | loss: 0.8768047
	speed: 0.0038s/iter; left time: 16.9072s
	iters: 900, epoch: 4 | loss: 0.2955914
	speed: 0.0037s/iter; left time: 15.9509s
	iters: 1000, epoch: 4 | loss: 0.4299369
	speed: 0.0052s/iter; left time: 22.1317s
Updating learning rate to 0.00027606168055
Epoch: 4 cost time: 5.038025379180908
Epoch: 4, Steps: 1045 | Train Loss: 0.5633658 Vali Loss: 0.3089851 Best vali loss: 0.2805102
	iters: 100, epoch: 5 | loss: 0.4836327
	speed: 0.0193s/iter; left time: 78.7024s
	iters: 200, epoch: 5 | loss: 0.4165735
	speed: 0.0049s/iter; left time: 19.5642s
	iters: 300, epoch: 5 | loss: 0.3271364
	speed: 0.0053s/iter; left time: 20.4223s
	iters: 400, epoch: 5 | loss: 0.2924741
	speed: 0.0064s/iter; left time: 24.1285s
	iters: 500, epoch: 5 | loss: 0.7897148
	speed: 0.0052s/iter; left time: 19.1986s
	iters: 600, epoch: 5 | loss: 0.3433342
	speed: 0.0046s/iter; left time: 16.3947s
	iters: 700, epoch: 5 | loss: 0.1626860
	speed: 0.0053s/iter; left time: 18.5026s
	iters: 800, epoch: 5 | loss: 0.2470088
	speed: 0.0047s/iter; left time: 15.9922s
	iters: 900, epoch: 5 | loss: 0.6497730
	speed: 0.0056s/iter; left time: 18.3792s
	iters: 1000, epoch: 5 | loss: 0.2207157
	speed: 0.0066s/iter; left time: 20.9079s
Updating learning rate to 0.00017041744909265108
Epoch: 5 cost time: 5.681601524353027
Epoch: 5, Steps: 1045 | Train Loss: 0.3933049 Vali Loss: 0.3063825 Best vali loss: 0.2805102
	iters: 100, epoch: 6 | loss: 0.6059448
	speed: 0.0207s/iter; left time: 62.7867s
	iters: 200, epoch: 6 | loss: 0.5530023
	speed: 0.0049s/iter; left time: 14.5298s
	iters: 300, epoch: 6 | loss: 0.1853701
	speed: 0.0051s/iter; left time: 14.4837s
	iters: 400, epoch: 6 | loss: 0.2773457
	speed: 0.0032s/iter; left time: 8.6275s
	iters: 500, epoch: 6 | loss: 0.2654372
	speed: 0.0037s/iter; left time: 9.8112s
	iters: 600, epoch: 6 | loss: 0.2739977
	speed: 0.0044s/iter; left time: 11.1487s
	iters: 700, epoch: 6 | loss: 0.3300695
	speed: 0.0043s/iter; left time: 10.4936s
	iters: 800, epoch: 6 | loss: 0.4745009
	speed: 0.0047s/iter; left time: 10.9764s
	iters: 900, epoch: 6 | loss: 0.1723371
	speed: 0.0047s/iter; left time: 10.6181s
	iters: 1000, epoch: 6 | loss: 0.7162731
	speed: 0.0051s/iter; left time: 10.8011s
Updating learning rate to 8.085659420734059e-05
Epoch: 6 cost time: 4.94191575050354
Epoch: 6, Steps: 1045 | Train Loss: 0.3854278 Vali Loss: 0.3067712 Best vali loss: 0.2805102
	iters: 100, epoch: 7 | loss: 0.1704721
	speed: 0.0177s/iter; left time: 35.1922s
	iters: 200, epoch: 7 | loss: 0.1994488
	speed: 0.0044s/iter; left time: 8.3736s
	iters: 300, epoch: 7 | loss: 0.2674559
	speed: 0.0042s/iter; left time: 7.4698s
	iters: 400, epoch: 7 | loss: 0.2432276
	speed: 0.0041s/iter; left time: 6.8810s
	iters: 500, epoch: 7 | loss: 0.5445310
	speed: 0.0043s/iter; left time: 6.8178s
	iters: 600, epoch: 7 | loss: 0.1455295
	speed: 0.0050s/iter; left time: 7.4225s
	iters: 700, epoch: 7 | loss: 0.4886289
	speed: 0.0049s/iter; left time: 6.8845s
	iters: 800, epoch: 7 | loss: 0.2109354
	speed: 0.0045s/iter; left time: 5.8109s
	iters: 900, epoch: 7 | loss: 0.1938667
	speed: 0.0044s/iter; left time: 5.2493s
	iters: 1000, epoch: 7 | loss: 0.1491729
	speed: 0.0039s/iter; left time: 4.2807s
Updating learning rate to 2.101394417918582e-05
Epoch: 7 cost time: 4.7008726596832275
Epoch: 7, Steps: 1045 | Train Loss: 0.2613269 Vali Loss: 0.3070945 Best vali loss: 0.2805102
	iters: 100, epoch: 8 | loss: 0.2775937
	speed: 0.0197s/iter; left time: 18.6281s
	iters: 200, epoch: 8 | loss: 0.6787279
	speed: 0.0053s/iter; left time: 4.4577s
	iters: 300, epoch: 8 | loss: 0.7753209
	speed: 0.0048s/iter; left time: 3.5822s
	iters: 400, epoch: 8 | loss: 0.5153562
	speed: 0.0051s/iter; left time: 3.3027s
	iters: 500, epoch: 8 | loss: 0.4733028
	speed: 0.0047s/iter; left time: 2.5591s
	iters: 600, epoch: 8 | loss: 0.2592551
	speed: 0.0048s/iter; left time: 2.1371s
	iters: 700, epoch: 8 | loss: 0.5004066
	speed: 0.0041s/iter; left time: 1.4242s
	iters: 800, epoch: 8 | loss: 0.3685642
	speed: 0.0050s/iter; left time: 1.2340s
	iters: 900, epoch: 8 | loss: 1.5742015
	speed: 0.0048s/iter; left time: 0.6956s
	iters: 1000, epoch: 8 | loss: 0.1884604
	speed: 0.0041s/iter; left time: 0.1900s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.038666486740112
Epoch: 8, Steps: 1045 | Train Loss: 0.5611189 Vali Loss: 0.3077409 Best vali loss: 0.2805102

best validation loss 0.280510171776857

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3778704
	speed: 0.0096s/iter; left time: 39.1794s
	iters: 200, epoch: 1 | loss: 0.3073449
	speed: 0.0038s/iter; left time: 15.2308s
	iters: 300, epoch: 1 | loss: 0.2819552
	speed: 0.0039s/iter; left time: 15.0714s
	iters: 400, epoch: 1 | loss: 0.2808532
	speed: 0.0063s/iter; left time: 23.8968s
	iters: 500, epoch: 1 | loss: 0.6682372
	speed: 0.0056s/iter; left time: 20.5532s
Updating learning rate to 0.0001961966354
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 2.8118255138397217
Epoch: 1, Steps: 523 | Train Loss: 0.3832522 Vali Loss: 0.2812697 Best vali loss: 0.2812697
	iters: 100, epoch: 2 | loss: 0.9001135
	speed: 0.0133s/iter; left time: 47.4016s
	iters: 200, epoch: 2 | loss: 0.3249314
	speed: 0.0049s/iter; left time: 16.9520s
	iters: 300, epoch: 2 | loss: 0.5733375
	speed: 0.0040s/iter; left time: 13.3096s
	iters: 400, epoch: 2 | loss: 0.4199940
	speed: 0.0035s/iter; left time: 11.3864s
	iters: 500, epoch: 2 | loss: 0.5905147
	speed: 0.0041s/iter; left time: 12.9552s
Updating learning rate to 9.80983177e-05
Epoch: 2 cost time: 2.3205676078796387
Epoch: 2, Steps: 523 | Train Loss: 0.5617782 Vali Loss: 0.2866253 Best vali loss: 0.2812697
	iters: 100, epoch: 3 | loss: 0.4170449
	speed: 0.0117s/iter; left time: 35.4140s
	iters: 200, epoch: 3 | loss: 0.3178885
	speed: 0.0045s/iter; left time: 13.2192s
	iters: 300, epoch: 3 | loss: 0.8094602
	speed: 0.0042s/iter; left time: 12.0207s
	iters: 400, epoch: 3 | loss: 0.6958742
	speed: 0.0045s/iter; left time: 12.3899s
	iters: 500, epoch: 3 | loss: 0.3950246
	speed: 0.0037s/iter; left time: 9.7843s
Updating learning rate to 4.904915885e-05
Epoch: 3 cost time: 2.2741944789886475
Epoch: 3, Steps: 523 | Train Loss: 0.5270585 Vali Loss: 0.2870714 Best vali loss: 0.2812697

best validation loss 0.28126965918120683

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0074951894677, 'e_layers': 4, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8301966
	speed: 0.0161s/iter; left time: 65.8524s
	iters: 200, epoch: 1 | loss: 0.3807535
	speed: 0.0105s/iter; left time: 41.6849s
	iters: 300, epoch: 1 | loss: 0.8608856
	speed: 0.0103s/iter; left time: 39.8337s
	iters: 400, epoch: 1 | loss: 0.3048766
	speed: 0.0080s/iter; left time: 30.3593s
	iters: 500, epoch: 1 | loss: 0.4065636
	speed: 0.0107s/iter; left time: 39.3047s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.3249).  Saving model state dict ...
Epoch: 1 cost time: 5.558250188827515
Epoch: 1, Steps: 523 | Train Loss: 0.5566552 Vali Loss: 0.3248854 Best vali loss: 0.3248854
	iters: 100, epoch: 2 | loss: 0.2653245
	speed: 0.0229s/iter; left time: 81.4649s
	iters: 200, epoch: 2 | loss: 0.7770689
	speed: 0.0101s/iter; left time: 34.9101s
	iters: 300, epoch: 2 | loss: 0.4006187
	speed: 0.0101s/iter; left time: 33.8070s
	iters: 400, epoch: 2 | loss: 0.9715905
	speed: 0.0105s/iter; left time: 34.4035s
	iters: 500, epoch: 2 | loss: 0.4944750
	speed: 0.0087s/iter; left time: 27.4500s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.3249 --> 0.3242).  Saving model state dict ...
Epoch: 2 cost time: 5.321869611740112
Epoch: 2, Steps: 523 | Train Loss: 0.5818155 Vali Loss: 0.3242435 Best vali loss: 0.3242435
	iters: 100, epoch: 3 | loss: 0.3013076
	speed: 0.0169s/iter; left time: 51.4033s
	iters: 200, epoch: 3 | loss: 0.2461619
	speed: 0.0092s/iter; left time: 27.0090s
	iters: 300, epoch: 3 | loss: 0.3361855
	speed: 0.0093s/iter; left time: 26.4395s
	iters: 400, epoch: 3 | loss: 0.3440229
	speed: 0.0081s/iter; left time: 22.2278s
	iters: 500, epoch: 3 | loss: 0.3060798
	speed: 0.0105s/iter; left time: 27.7150s
Updating learning rate to 0.0008955266062
Validation loss decreased (0.3242 --> 0.3225).  Saving model state dict ...
Epoch: 3 cost time: 4.780949592590332
Epoch: 3, Steps: 523 | Train Loss: 0.3067516 Vali Loss: 0.3225196 Best vali loss: 0.3225196

best validation loss 0.3225195609107918

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3430311
	speed: 0.0186s/iter; left time: 17.6040s
Updating learning rate to 0.0006870327933
Validation loss decreased (inf --> 0.2929).  Saving model state dict ...
Epoch: 1 cost time: 1.965639591217041
Epoch: 1, Steps: 131 | Train Loss: 0.3430311 Vali Loss: 0.2928652 Best vali loss: 0.2928652
	iters: 100, epoch: 2 | loss: 0.5595227
	speed: 0.0195s/iter; left time: 15.9723s
Updating learning rate to 0.00034351639665
Epoch: 2 cost time: 1.6530005931854248
Epoch: 2, Steps: 131 | Train Loss: 0.5595227 Vali Loss: 0.2929215 Best vali loss: 0.2928652
	iters: 100, epoch: 3 | loss: 0.4529664
	speed: 0.0216s/iter; left time: 14.8537s
Updating learning rate to 0.000171758198325
Validation loss decreased (0.2929 --> 0.2866).  Saving model state dict ...
Epoch: 3 cost time: 1.6431171894073486
Epoch: 3, Steps: 131 | Train Loss: 0.4529664 Vali Loss: 0.2866388 Best vali loss: 0.2866388

best validation loss 0.28663879284942045

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3532004
	speed: 0.0114s/iter; left time: 28.6582s
	iters: 200, epoch: 4 | loss: 0.3047133
	speed: 0.0044s/iter; left time: 10.5670s
	iters: 300, epoch: 4 | loss: 0.2640197
	speed: 0.0045s/iter; left time: 10.3806s
	iters: 400, epoch: 4 | loss: 0.2841974
	speed: 0.0050s/iter; left time: 11.1428s
	iters: 500, epoch: 4 | loss: 0.6486395
	speed: 0.0044s/iter; left time: 9.3627s
Updating learning rate to 2.4524579425e-05
Epoch: 4 cost time: 2.7541568279266357
Epoch: 4, Steps: 523 | Train Loss: 0.3709541 Vali Loss: 0.2871153 Best vali loss: 0.2812697
	iters: 100, epoch: 5 | loss: 0.8519508
	speed: 0.0125s/iter; left time: 24.9669s
	iters: 200, epoch: 5 | loss: 0.2961620
	speed: 0.0045s/iter; left time: 8.6120s
	iters: 300, epoch: 5 | loss: 0.5657116
	speed: 0.0044s/iter; left time: 7.8688s
	iters: 400, epoch: 5 | loss: 0.3560930
	speed: 0.0044s/iter; left time: 7.4992s
	iters: 500, epoch: 5 | loss: 0.5392116
	speed: 0.0046s/iter; left time: 7.2862s
Updating learning rate to 1.22622897125e-05
Epoch: 5 cost time: 2.413745641708374
Epoch: 5, Steps: 523 | Train Loss: 0.5218258 Vali Loss: 0.2886304 Best vali loss: 0.2812697
	iters: 100, epoch: 6 | loss: 0.3720748
	speed: 0.0129s/iter; left time: 18.9593s
	iters: 200, epoch: 6 | loss: 0.3129399
	speed: 0.0049s/iter; left time: 6.7219s
	iters: 300, epoch: 6 | loss: 0.7831752
	speed: 0.0045s/iter; left time: 5.7232s
	iters: 400, epoch: 6 | loss: 0.6326684
	speed: 0.0044s/iter; left time: 5.1094s
	iters: 500, epoch: 6 | loss: 0.3949308
	speed: 0.0041s/iter; left time: 4.3739s
Updating learning rate to 6.13114485625e-06
Epoch: 6 cost time: 2.4170689582824707
Epoch: 6, Steps: 523 | Train Loss: 0.4991578 Vali Loss: 0.2885307 Best vali loss: 0.2812697
	iters: 100, epoch: 7 | loss: 0.5794953
	speed: 0.0119s/iter; left time: 11.2963s
	iters: 200, epoch: 7 | loss: 0.2399188
	speed: 0.0051s/iter; left time: 4.3107s
	iters: 300, epoch: 7 | loss: 0.3496676
	speed: 0.0049s/iter; left time: 3.6972s
	iters: 400, epoch: 7 | loss: 0.6328322
	speed: 0.0046s/iter; left time: 2.9926s
	iters: 500, epoch: 7 | loss: 0.5261908
	speed: 0.0049s/iter; left time: 2.6837s
Updating learning rate to 3.065572428125e-06
Epoch: 7 cost time: 2.6480631828308105
Epoch: 7, Steps: 523 | Train Loss: 0.4656209 Vali Loss: 0.2877160 Best vali loss: 0.2812697
	iters: 100, epoch: 8 | loss: 0.5700026
	speed: 0.0125s/iter; left time: 5.2902s
	iters: 200, epoch: 8 | loss: 0.6105852
	speed: 0.0047s/iter; left time: 1.5276s
	iters: 300, epoch: 8 | loss: 0.4123925
	speed: 0.0048s/iter; left time: 1.0667s
	iters: 400, epoch: 8 | loss: 0.2783202
	speed: 0.0050s/iter; left time: 0.6169s
	iters: 500, epoch: 8 | loss: 0.3636881
	speed: 0.0043s/iter; left time: 0.1039s
Updating learning rate to 1.5327862140625e-06
Epoch: 8 cost time: 2.4486489295959473
Epoch: 8, Steps: 523 | Train Loss: 0.4469977 Vali Loss: 0.2877675 Best vali loss: 0.2812697

best validation loss 0.28126965918120683

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008116820516, 'e_layers': 1, 'learning_rate': 0.0004109547451, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4667971
	speed: 0.0128s/iter; left time: 12.1550s
Updating learning rate to 0.0003953137114431415
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 1.204817295074463
Epoch: 1, Steps: 131 | Train Loss: 0.4667971 Vali Loss: 0.2861842 Best vali loss: 0.2861842
	iters: 100, epoch: 2 | loss: 0.3544263
	speed: 0.0109s/iter; left time: 8.8801s
Updating learning rate to 0.00035077181606049955
Validation loss decreased (0.2862 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 0.8213212490081787
Epoch: 2, Steps: 131 | Train Loss: 0.3544263 Vali Loss: 0.2811790 Best vali loss: 0.2811790
	iters: 100, epoch: 3 | loss: 0.5671526
	speed: 0.0104s/iter; left time: 7.1780s
Updating learning rate to 0.00028411015875079426
Epoch: 3 cost time: 0.8235113620758057
Epoch: 3, Steps: 131 | Train Loss: 0.5671526 Vali Loss: 0.2823246 Best vali loss: 0.2811790
	iters: 100, epoch: 4 | loss: 0.4970862
	speed: 0.0106s/iter; left time: 5.8850s
Updating learning rate to 0.00020547737255
Epoch: 4 cost time: 0.7951273918151855
Epoch: 4, Steps: 131 | Train Loss: 0.4970862 Vali Loss: 0.2865938 Best vali loss: 0.2811790
	iters: 100, epoch: 5 | loss: 0.7141810
	speed: 0.0103s/iter; left time: 4.3750s
Updating learning rate to 0.00012684458634920571
Epoch: 5 cost time: 0.8195483684539795
Epoch: 5, Steps: 131 | Train Loss: 0.7141810 Vali Loss: 0.2844858 Best vali loss: 0.2811790
	iters: 100, epoch: 6 | loss: 0.3301508
	speed: 0.0159s/iter; left time: 4.6837s
Updating learning rate to 6.0182929039500455e-05
Epoch: 6 cost time: 1.093916893005371
Epoch: 6, Steps: 131 | Train Loss: 0.3301508 Vali Loss: 0.2869775 Best vali loss: 0.2811790
	iters: 100, epoch: 7 | loss: 0.4222477
	speed: 0.0112s/iter; left time: 1.8204s
Updating learning rate to 1.5641033656858497e-05
Epoch: 7 cost time: 0.8663864135742188
Epoch: 7, Steps: 131 | Train Loss: 0.4222477 Vali Loss: 0.2859194 Best vali loss: 0.2811790
	iters: 100, epoch: 8 | loss: 0.5527595
	speed: 0.0111s/iter; left time: 0.3558s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8602266311645508
Epoch: 8, Steps: 131 | Train Loss: 0.5527595 Vali Loss: 0.2861165 Best vali loss: 0.2811790

best validation loss 0.2811789778516655

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.008835229483, 'e_layers': 1, 'learning_rate': 0.0016070226056, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4088912
	speed: 0.0127s/iter; left time: 25.4133s
	iters: 200, epoch: 1 | loss: 0.4991369
	speed: 0.0064s/iter; left time: 12.0672s
Updating learning rate to 0.001545858949598399
Validation loss decreased (inf --> 0.2880).  Saving model state dict ...
Epoch: 1 cost time: 2.04042649269104
Epoch: 1, Steps: 262 | Train Loss: 0.4540140 Vali Loss: 0.2880115 Best vali loss: 0.2880115
	iters: 100, epoch: 2 | loss: 0.9246597
	speed: 0.0142s/iter; left time: 24.6255s
	iters: 200, epoch: 2 | loss: 0.5249713
	speed: 0.0062s/iter; left time: 10.0955s
Updating learning rate to 0.0013716795937699173
Epoch: 2 cost time: 1.6265380382537842
Epoch: 2, Steps: 262 | Train Loss: 0.7248155 Vali Loss: 0.2880451 Best vali loss: 0.2880115
	iters: 100, epoch: 3 | loss: 0.2653010
	speed: 0.0146s/iter; left time: 21.5026s
	iters: 200, epoch: 3 | loss: 0.7778582
	speed: 0.0074s/iter; left time: 10.1288s
Updating learning rate to 0.0011110017660996491
Epoch: 3 cost time: 1.7841813564300537
Epoch: 3, Steps: 262 | Train Loss: 0.5215796 Vali Loss: 0.2942945 Best vali loss: 0.2880115
	iters: 100, epoch: 4 | loss: 0.4815375
	speed: 0.0146s/iter; left time: 17.6270s
	iters: 200, epoch: 4 | loss: 0.6210433
	speed: 0.0060s/iter; left time: 6.7182s
Updating learning rate to 0.0008035113028
Epoch: 4 cost time: 1.6218352317810059
Epoch: 4, Steps: 262 | Train Loss: 0.5512904 Vali Loss: 0.2897222 Best vali loss: 0.2880115
	iters: 100, epoch: 5 | loss: 0.3625810
	speed: 0.0133s/iter; left time: 12.6302s
	iters: 200, epoch: 5 | loss: 0.3643510
	speed: 0.0052s/iter; left time: 4.4247s
Updating learning rate to 0.0004960208395003511
Epoch: 5 cost time: 1.4790561199188232
Epoch: 5, Steps: 262 | Train Loss: 0.3634660 Vali Loss: 0.3148377 Best vali loss: 0.2880115
	iters: 100, epoch: 6 | loss: 0.4441792
	speed: 0.0144s/iter; left time: 9.8728s
	iters: 200, epoch: 6 | loss: 0.2345151
	speed: 0.0051s/iter; left time: 3.0200s
Updating learning rate to 0.00023534301183008273
Epoch: 6 cost time: 1.4552078247070312
Epoch: 6, Steps: 262 | Train Loss: 0.3393472 Vali Loss: 0.3388541 Best vali loss: 0.2880115
	iters: 100, epoch: 7 | loss: 0.3255197
	speed: 0.0103s/iter; left time: 4.3769s
	iters: 200, epoch: 7 | loss: 0.4214921
	speed: 0.0054s/iter; left time: 1.7388s
Updating learning rate to 6.116365600160105e-05
Epoch: 7 cost time: 1.429166555404663
Epoch: 7, Steps: 262 | Train Loss: 0.3735059 Vali Loss: 0.3345555 Best vali loss: 0.2880115
	iters: 100, epoch: 8 | loss: 0.2480320
	speed: 0.0139s/iter; left time: 2.2714s
	iters: 200, epoch: 8 | loss: 0.4025384
	speed: 0.0054s/iter; left time: 0.3395s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5443434715270996
Epoch: 8, Steps: 262 | Train Loss: 0.3252852 Vali Loss: 0.3466099 Best vali loss: 0.2880115

best validation loss 0.2880115481270162

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.003701149266, 'e_layers': 1, 'learning_rate': 0.0002377962535, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4816803
	speed: 0.0137s/iter; left time: 12.9658s
Updating learning rate to 0.0002377962535
Validation loss decreased (inf --> 0.2969).  Saving model state dict ...
Epoch: 1 cost time: 1.359726905822754
Epoch: 1, Steps: 131 | Train Loss: 0.4816803 Vali Loss: 0.2968736 Best vali loss: 0.2968736
	iters: 100, epoch: 2 | loss: 0.3603177
	speed: 0.0167s/iter; left time: 13.6497s
Updating learning rate to 0.00011889812675
Validation loss decreased (0.2969 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 1.4285712242126465
Epoch: 2, Steps: 131 | Train Loss: 0.3603177 Vali Loss: 0.2838065 Best vali loss: 0.2838065
	iters: 100, epoch: 3 | loss: 0.5739965
	speed: 0.0143s/iter; left time: 9.8558s
Updating learning rate to 5.9449063375e-05
Validation loss decreased (0.2838 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 1.0352790355682373
Epoch: 3, Steps: 131 | Train Loss: 0.5739965 Vali Loss: 0.2813295 Best vali loss: 0.2813295

best validation loss 0.28132948957109327

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4354533
	speed: 0.0139s/iter; left time: 27.7017s
	iters: 200, epoch: 1 | loss: 0.5251642
	speed: 0.0073s/iter; left time: 13.9207s
Updating learning rate to 0.000380413518
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 2.2940218448638916
Epoch: 1, Steps: 262 | Train Loss: 0.4803087 Vali Loss: 0.2808519 Best vali loss: 0.2808519
	iters: 100, epoch: 2 | loss: 0.4155241
	speed: 0.0167s/iter; left time: 28.8887s
	iters: 200, epoch: 2 | loss: 0.5928316
	speed: 0.0085s/iter; left time: 13.8726s
Updating learning rate to 0.000190206759
Epoch: 2 cost time: 2.069490909576416
Epoch: 2, Steps: 262 | Train Loss: 0.5041778 Vali Loss: 0.2892207 Best vali loss: 0.2808519
	iters: 100, epoch: 3 | loss: 0.4930892
	speed: 0.0178s/iter; left time: 26.2305s
	iters: 200, epoch: 3 | loss: 0.6422635
	speed: 0.0076s/iter; left time: 10.3677s
Updating learning rate to 9.51033795e-05
Validation loss decreased (0.2809 --> 0.2791).  Saving model state dict ...
Epoch: 3 cost time: 2.000293493270874
Epoch: 3, Steps: 262 | Train Loss: 0.5676764 Vali Loss: 0.2791143 Best vali loss: 0.2791143

best validation loss 0.27911430827832745

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038758267905, 'e_layers': 1, 'learning_rate': 0.0011658864209, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5269793
	speed: 0.0113s/iter; left time: 45.9941s
	iters: 200, epoch: 1 | loss: 0.6852611
	speed: 0.0046s/iter; left time: 18.4795s
	iters: 300, epoch: 1 | loss: 1.0789378
	speed: 0.0041s/iter; left time: 15.9431s
	iters: 400, epoch: 1 | loss: 0.3921595
	speed: 0.0039s/iter; left time: 14.6341s
	iters: 500, epoch: 1 | loss: 0.3690827
	speed: 0.0035s/iter; left time: 12.7761s
Updating learning rate to 0.0011215125112011748
Validation loss decreased (inf --> 0.3065).  Saving model state dict ...
Epoch: 1 cost time: 2.486675500869751
Epoch: 1, Steps: 523 | Train Loss: 0.6104841 Vali Loss: 0.3065450 Best vali loss: 0.3065450
	iters: 100, epoch: 2 | loss: 0.3620297
	speed: 0.0110s/iter; left time: 39.0663s
	iters: 200, epoch: 2 | loss: 0.6777723
	speed: 0.0047s/iter; left time: 16.1913s
	iters: 300, epoch: 2 | loss: 0.5394306
	speed: 0.0046s/iter; left time: 15.6292s
	iters: 400, epoch: 2 | loss: 0.4642608
	speed: 0.0048s/iter; left time: 15.6679s
	iters: 500, epoch: 2 | loss: 0.9129540
	speed: 0.0048s/iter; left time: 15.1066s
Updating learning rate to 0.0009951463076058517
Validation loss decreased (0.3065 --> 0.2935).  Saving model state dict ...
Epoch: 2 cost time: 2.5157086849212646
Epoch: 2, Steps: 523 | Train Loss: 0.5912895 Vali Loss: 0.2934921 Best vali loss: 0.2934921
	iters: 100, epoch: 3 | loss: 0.5994786
	speed: 0.0128s/iter; left time: 38.8587s
	iters: 200, epoch: 3 | loss: 0.5180547
	speed: 0.0047s/iter; left time: 13.7705s
	iters: 300, epoch: 3 | loss: 0.7113864
	speed: 0.0045s/iter; left time: 12.7005s
	iters: 400, epoch: 3 | loss: 0.3089714
	speed: 0.0044s/iter; left time: 11.9518s
	iters: 500, epoch: 3 | loss: 0.3091421
	speed: 0.0040s/iter; left time: 10.6451s
Updating learning rate to 0.0008060259190989309
Epoch: 3 cost time: 2.362534284591675
Epoch: 3, Steps: 523 | Train Loss: 0.4894066 Vali Loss: 0.2940477 Best vali loss: 0.2934921

best validation loss 0.2934920791690347

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3703993
	speed: 0.0157s/iter; left time: 19.0580s
	iters: 200, epoch: 4 | loss: 0.4086363
	speed: 0.0097s/iter; left time: 10.7587s
Updating learning rate to 4.755168975e-05
Epoch: 4 cost time: 2.7578585147857666
Epoch: 4, Steps: 262 | Train Loss: 0.3895178 Vali Loss: 0.2807249 Best vali loss: 0.2791143
	iters: 100, epoch: 5 | loss: 0.3577318
	speed: 0.0362s/iter; left time: 34.3402s
	iters: 200, epoch: 5 | loss: 0.3946989
	speed: 0.0109s/iter; left time: 9.2574s
Updating learning rate to 2.3775844875e-05
Epoch: 5 cost time: 2.869236707687378
Epoch: 5, Steps: 262 | Train Loss: 0.3762154 Vali Loss: 0.2860737 Best vali loss: 0.2791143
	iters: 100, epoch: 6 | loss: 0.4490730
	speed: 0.0311s/iter; left time: 21.3370s
	iters: 200, epoch: 6 | loss: 0.5432210
	speed: 0.0091s/iter; left time: 5.3632s
Updating learning rate to 1.18879224375e-05
Epoch: 6 cost time: 2.595646381378174
Epoch: 6, Steps: 262 | Train Loss: 0.4961470 Vali Loss: 0.2833085 Best vali loss: 0.2791143
	iters: 100, epoch: 7 | loss: 0.6019731
	speed: 0.0354s/iter; left time: 15.0575s
	iters: 200, epoch: 7 | loss: 0.2836428
	speed: 0.0106s/iter; left time: 3.4478s
Updating learning rate to 5.94396121875e-06
Epoch: 7 cost time: 2.6971254348754883
Epoch: 7, Steps: 262 | Train Loss: 0.4428080 Vali Loss: 0.2842516 Best vali loss: 0.2791143
	iters: 100, epoch: 8 | loss: 0.3571777
	speed: 0.0315s/iter; left time: 5.1365s
	iters: 200, epoch: 8 | loss: 0.6187190
	speed: 0.0108s/iter; left time: 0.6830s
Updating learning rate to 2.971980609375e-06
Epoch: 8 cost time: 2.831420660018921
Epoch: 8, Steps: 262 | Train Loss: 0.4879484 Vali Loss: 0.2830184 Best vali loss: 0.2791143

best validation loss 0.27911430827832745

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072680941331, 'e_layers': 3, 'learning_rate': 0.0001290367597, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0349234
	speed: 0.0150s/iter; left time: 61.3236s
	iters: 200, epoch: 1 | loss: 0.6462579
	speed: 0.0084s/iter; left time: 33.3677s
	iters: 300, epoch: 1 | loss: 0.4565448
	speed: 0.0076s/iter; left time: 29.6752s
	iters: 400, epoch: 1 | loss: 0.3922929
	speed: 0.0081s/iter; left time: 30.7311s
	iters: 500, epoch: 1 | loss: 0.4872105
	speed: 0.0084s/iter; left time: 31.0421s
Updating learning rate to 0.0001290367597
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 4.5887062549591064
Epoch: 1, Steps: 523 | Train Loss: 0.6034459 Vali Loss: 0.2787407 Best vali loss: 0.2787407
	iters: 100, epoch: 2 | loss: 0.3735714
	speed: 0.0185s/iter; left time: 65.8410s
	iters: 200, epoch: 2 | loss: 0.5631621
	speed: 0.0086s/iter; left time: 29.7609s
	iters: 300, epoch: 2 | loss: 0.4241213
	speed: 0.0084s/iter; left time: 28.0880s
	iters: 400, epoch: 2 | loss: 0.9138509
	speed: 0.0077s/iter; left time: 25.0835s
	iters: 500, epoch: 2 | loss: 0.7731306
	speed: 0.0074s/iter; left time: 23.3978s
Updating learning rate to 6.451837985e-05
Epoch: 2 cost time: 4.274333715438843
Epoch: 2, Steps: 523 | Train Loss: 0.6095673 Vali Loss: 0.2807484 Best vali loss: 0.2787407
	iters: 100, epoch: 3 | loss: 0.4421602
	speed: 0.0174s/iter; left time: 52.9028s
	iters: 200, epoch: 3 | loss: 1.3320260
	speed: 0.0072s/iter; left time: 21.1233s
	iters: 300, epoch: 3 | loss: 0.6338424
	speed: 0.0083s/iter; left time: 23.5072s
	iters: 400, epoch: 3 | loss: 0.4093571
	speed: 0.0082s/iter; left time: 22.5341s
	iters: 500, epoch: 3 | loss: 0.3723136
	speed: 0.0082s/iter; left time: 21.6940s
Updating learning rate to 3.2259189925e-05
Epoch: 3 cost time: 4.211450099945068
Epoch: 3, Steps: 523 | Train Loss: 0.6379399 Vali Loss: 0.3098010 Best vali loss: 0.2787407
	iters: 100, epoch: 4 | loss: 0.9549112
	speed: 0.0181s/iter; left time: 45.4176s
	iters: 200, epoch: 4 | loss: 0.3047431
	speed: 0.0078s/iter; left time: 18.7516s
	iters: 300, epoch: 4 | loss: 0.5864300
	speed: 0.0063s/iter; left time: 14.6317s
	iters: 400, epoch: 4 | loss: 0.4005164
	speed: 0.0064s/iter; left time: 14.2044s
	iters: 500, epoch: 4 | loss: 0.4414140
	speed: 0.0070s/iter; left time: 14.8814s
Updating learning rate to 1.61295949625e-05
Epoch: 4 cost time: 3.7954070568084717
Epoch: 4, Steps: 523 | Train Loss: 0.5376029 Vali Loss: 0.3080652 Best vali loss: 0.2787407
	iters: 100, epoch: 5 | loss: 0.5752997
	speed: 0.0141s/iter; left time: 28.1289s
	iters: 200, epoch: 5 | loss: 0.6028872
	speed: 0.0072s/iter; left time: 13.7219s
	iters: 300, epoch: 5 | loss: 0.6813126
	speed: 0.0085s/iter; left time: 15.2071s
	iters: 400, epoch: 5 | loss: 0.4055645
	speed: 0.0075s/iter; left time: 12.7543s
	iters: 500, epoch: 5 | loss: 0.3704222
	speed: 0.0079s/iter; left time: 12.5158s
Updating learning rate to 8.06479748125e-06
Epoch: 5 cost time: 4.09485125541687
Epoch: 5, Steps: 523 | Train Loss: 0.5270972 Vali Loss: 0.3086346 Best vali loss: 0.2787407
	iters: 100, epoch: 6 | loss: 0.3758132
	speed: 0.0218s/iter; left time: 32.0784s
	iters: 200, epoch: 6 | loss: 0.5324041
	speed: 0.0108s/iter; left time: 14.8207s
	iters: 300, epoch: 6 | loss: 0.3176889
	speed: 0.0090s/iter; left time: 11.4748s
	iters: 400, epoch: 6 | loss: 0.2107245
	speed: 0.0074s/iter; left time: 8.6613s
	iters: 500, epoch: 6 | loss: 0.3359157
	speed: 0.0114s/iter; left time: 12.1889s
Updating learning rate to 4.032398740625e-06
Epoch: 6 cost time: 5.033918857574463
Epoch: 6, Steps: 523 | Train Loss: 0.3545093 Vali Loss: 0.3136228 Best vali loss: 0.2787407
	iters: 100, epoch: 7 | loss: 0.4290406
	speed: 0.0258s/iter; left time: 24.4473s
	iters: 200, epoch: 7 | loss: 0.2183354
	speed: 0.0095s/iter; left time: 8.0403s
	iters: 300, epoch: 7 | loss: 1.0477083
	speed: 0.0111s/iter; left time: 8.2892s
	iters: 400, epoch: 7 | loss: 0.9073951
	speed: 0.0102s/iter; left time: 6.6102s
	iters: 500, epoch: 7 | loss: 0.2071941
	speed: 0.0117s/iter; left time: 6.3911s
Updating learning rate to 2.0161993703125e-06
Epoch: 7 cost time: 5.800869464874268
Epoch: 7, Steps: 523 | Train Loss: 0.5619347 Vali Loss: 0.3084125 Best vali loss: 0.2787407
	iters: 100, epoch: 8 | loss: 0.3035513
	speed: 0.0234s/iter; left time: 9.9045s
	iters: 200, epoch: 8 | loss: 0.2695390
	speed: 0.0068s/iter; left time: 2.2005s
	iters: 300, epoch: 8 | loss: 0.6821803
	speed: 0.0075s/iter; left time: 1.6881s
	iters: 400, epoch: 8 | loss: 0.4700100
	speed: 0.0082s/iter; left time: 1.0141s
	iters: 500, epoch: 8 | loss: 0.4734686
	speed: 0.0079s/iter; left time: 0.1900s
Updating learning rate to 1.00809968515625e-06
Epoch: 8 cost time: 4.3554182052612305
Epoch: 8, Steps: 523 | Train Loss: 0.4397499 Vali Loss: 0.3130433 Best vali loss: 0.2787407

best validation loss 0.27874072296728475

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0008547466509, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4470685
	speed: 0.0158s/iter; left time: 64.4507s
	iters: 200, epoch: 1 | loss: 0.4499329
	speed: 0.0095s/iter; left time: 38.0096s
	iters: 300, epoch: 1 | loss: 0.7851858
	speed: 0.0085s/iter; left time: 33.1453s
	iters: 400, epoch: 1 | loss: 0.6051029
	speed: 0.0070s/iter; left time: 26.4139s
	iters: 500, epoch: 1 | loss: 0.8876476
	speed: 0.0101s/iter; left time: 37.2238s
Updating learning rate to 0.00082221479357454
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 5.111322641372681
Epoch: 1, Steps: 523 | Train Loss: 0.6349875 Vali Loss: 0.2849619 Best vali loss: 0.2849619
	iters: 100, epoch: 2 | loss: 0.5265828
	speed: 0.0256s/iter; left time: 91.3258s
	iters: 200, epoch: 2 | loss: 0.3480689
	speed: 0.0123s/iter; left time: 42.4242s
	iters: 300, epoch: 2 | loss: 0.2584401
	speed: 0.0117s/iter; left time: 39.4585s
	iters: 400, epoch: 2 | loss: 0.8047039
	speed: 0.0085s/iter; left time: 27.7015s
	iters: 500, epoch: 2 | loss: 0.2539299
	speed: 0.0128s/iter; left time: 40.5009s
Updating learning rate to 0.0007295719019739402
Epoch: 2 cost time: 6.244903087615967
Epoch: 2, Steps: 523 | Train Loss: 0.4383451 Vali Loss: 0.2916164 Best vali loss: 0.2849619
	iters: 100, epoch: 3 | loss: 0.6525633
	speed: 0.0265s/iter; left time: 80.5753s
	iters: 200, epoch: 3 | loss: 0.6791539
	speed: 0.0104s/iter; left time: 30.5735s
	iters: 300, epoch: 3 | loss: 0.2966329
	speed: 0.0130s/iter; left time: 36.9987s
	iters: 400, epoch: 3 | loss: 0.4809003
	speed: 0.0116s/iter; left time: 31.8395s
	iters: 500, epoch: 3 | loss: 0.2454678
	speed: 0.0115s/iter; left time: 30.4729s
Updating learning rate to 0.0005909220165344886
Epoch: 3 cost time: 6.464303731918335
Epoch: 3, Steps: 523 | Train Loss: 0.4709436 Vali Loss: 0.2924467 Best vali loss: 0.2849619
	iters: 100, epoch: 4 | loss: 0.2287080
	speed: 0.0246s/iter; left time: 61.8205s
	iters: 200, epoch: 4 | loss: 0.3689874
	speed: 0.0092s/iter; left time: 22.3145s
	iters: 300, epoch: 4 | loss: 0.7390732
	speed: 0.0084s/iter; left time: 19.5120s
	iters: 400, epoch: 4 | loss: 0.7210026
	speed: 0.0087s/iter; left time: 19.2987s
	iters: 500, epoch: 4 | loss: 0.2555883
	speed: 0.0082s/iter; left time: 17.3784s
Updating learning rate to 0.00042737332545
Epoch: 4 cost time: 4.705398797988892
Epoch: 4, Steps: 523 | Train Loss: 0.4626719 Vali Loss: 0.2898690 Best vali loss: 0.2849619
	iters: 100, epoch: 5 | loss: 0.3052785
	speed: 0.0185s/iter; left time: 36.8343s
	iters: 200, epoch: 5 | loss: 0.5047912
	speed: 0.0081s/iter; left time: 15.3523s
	iters: 300, epoch: 5 | loss: 0.3035390
	speed: 0.0080s/iter; left time: 14.4166s
	iters: 400, epoch: 5 | loss: 0.1920595
	speed: 0.0085s/iter; left time: 14.4572s
	iters: 500, epoch: 5 | loss: 0.7297917
	speed: 0.0076s/iter; left time: 12.0778s
Updating learning rate to 0.00026382463436551147
Validation loss decreased (0.2850 --> 0.2821).  Saving model state dict ...
Epoch: 5 cost time: 4.379901885986328
Epoch: 5, Steps: 523 | Train Loss: 0.4070920 Vali Loss: 0.2820935 Best vali loss: 0.2820935
	iters: 100, epoch: 6 | loss: 0.4030844
	speed: 0.0197s/iter; left time: 28.8883s
	iters: 200, epoch: 6 | loss: 0.9140758
	speed: 0.0088s/iter; left time: 12.0350s
	iters: 300, epoch: 6 | loss: 0.2909457
	speed: 0.0107s/iter; left time: 13.5295s
	iters: 400, epoch: 6 | loss: 0.2618195
	speed: 0.0089s/iter; left time: 10.4485s
	iters: 500, epoch: 6 | loss: 0.6611673
	speed: 0.0094s/iter; left time: 10.0698s
Updating learning rate to 0.0001251747489260597
Epoch: 6 cost time: 5.013302564620972
Epoch: 6, Steps: 523 | Train Loss: 0.5062185 Vali Loss: 0.2872604 Best vali loss: 0.2820935
	iters: 100, epoch: 7 | loss: 0.5762511
	speed: 0.0205s/iter; left time: 19.4325s
	iters: 200, epoch: 7 | loss: 0.1846515
	speed: 0.0084s/iter; left time: 7.0725s
	iters: 300, epoch: 7 | loss: 0.5180939
	speed: 0.0096s/iter; left time: 7.1733s
	iters: 400, epoch: 7 | loss: 0.6746363
	speed: 0.0099s/iter; left time: 6.3864s
	iters: 500, epoch: 7 | loss: 0.5699707
	speed: 0.0101s/iter; left time: 5.5069s
Updating learning rate to 3.253185732546e-05
Validation loss decreased (0.2821 --> 0.2775).  Saving model state dict ...
Epoch: 7 cost time: 5.007598400115967
Epoch: 7, Steps: 523 | Train Loss: 0.5047207 Vali Loss: 0.2774886 Best vali loss: 0.2774886
	iters: 100, epoch: 8 | loss: 0.1761851
	speed: 0.0205s/iter; left time: 8.6868s
	iters: 200, epoch: 8 | loss: 0.6300714
	speed: 0.0095s/iter; left time: 3.0721s
	iters: 300, epoch: 8 | loss: 0.2207819
	speed: 0.0096s/iter; left time: 2.1528s
	iters: 400, epoch: 8 | loss: 0.4873542
	speed: 0.0095s/iter; left time: 1.1770s
	iters: 500, epoch: 8 | loss: 0.2369155
	speed: 0.0087s/iter; left time: 0.2096s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.978355169296265
Epoch: 8, Steps: 523 | Train Loss: 0.3502616 Vali Loss: 0.2792644 Best vali loss: 0.2774886

best validation loss 0.27748857639721664

[INFO][abstract_intensifier.py:595] Added config 1c2cbe and rejected config eb8e22 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0076310052387, 'e_layers': 2, 'learning_rate': 6.80015623e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.80015623e-05
Validation loss decreased (inf --> 0.3533).  Saving model state dict ...
Epoch: 1 cost time: 2.0018768310546875
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3532815 Best vali loss: 0.3532815
Updating learning rate to 3.400078115e-05
Validation loss decreased (0.3533 --> 0.3416).  Saving model state dict ...
Epoch: 2 cost time: 0.8655526638031006
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3416483 Best vali loss: 0.3416483
Updating learning rate to 1.7000390575e-05
Validation loss decreased (0.3416 --> 0.3367).  Saving model state dict ...
Epoch: 3 cost time: 0.4132089614868164
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3367252 Best vali loss: 0.3367252

best validation loss 0.33672516463014796

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3496741
	speed: 0.0151s/iter; left time: 124.4254s
	iters: 200, epoch: 1 | loss: 0.3008027
	speed: 0.0082s/iter; left time: 66.5452s
	iters: 300, epoch: 1 | loss: 0.7657254
	speed: 0.0090s/iter; left time: 72.4186s
	iters: 400, epoch: 1 | loss: 0.3770995
	speed: 0.0076s/iter; left time: 60.7997s
	iters: 500, epoch: 1 | loss: 0.3347172
	speed: 0.0067s/iter; left time: 52.7502s
	iters: 600, epoch: 1 | loss: 0.2303871
	speed: 0.0082s/iter; left time: 63.6477s
	iters: 700, epoch: 1 | loss: 0.4043825
	speed: 0.0092s/iter; left time: 70.7793s
	iters: 800, epoch: 1 | loss: 0.2222951
	speed: 0.0071s/iter; left time: 53.6551s
	iters: 900, epoch: 1 | loss: 0.1386654
	speed: 0.0089s/iter; left time: 66.2365s
	iters: 1000, epoch: 1 | loss: 0.6030316
	speed: 0.0090s/iter; left time: 66.2597s
Updating learning rate to 0.0010132106523
Validation loss decreased (inf --> 0.2965).  Saving model state dict ...
Epoch: 1 cost time: 8.947984457015991
Epoch: 1, Steps: 1045 | Train Loss: 0.3726781 Vali Loss: 0.2965037 Best vali loss: 0.2965037
	iters: 100, epoch: 2 | loss: 0.3050421
	speed: 0.0274s/iter; left time: 197.9579s
	iters: 200, epoch: 2 | loss: 0.3261532
	speed: 0.0069s/iter; left time: 48.9895s
	iters: 300, epoch: 2 | loss: 0.7620289
	speed: 0.0059s/iter; left time: 41.1242s
	iters: 400, epoch: 2 | loss: 0.3032364
	speed: 0.0067s/iter; left time: 46.4769s
	iters: 500, epoch: 2 | loss: 0.3066595
	speed: 0.0083s/iter; left time: 56.4941s
	iters: 600, epoch: 2 | loss: 0.6913276
	speed: 0.0090s/iter; left time: 60.2355s
	iters: 700, epoch: 2 | loss: 1.3359249
	speed: 0.0090s/iter; left time: 59.4859s
	iters: 800, epoch: 2 | loss: 0.3551231
	speed: 0.0088s/iter; left time: 57.1127s
	iters: 900, epoch: 2 | loss: 0.3363487
	speed: 0.0083s/iter; left time: 53.1148s
	iters: 1000, epoch: 2 | loss: 0.3298217
	speed: 0.0076s/iter; left time: 47.8423s
Updating learning rate to 0.00050660532615
Validation loss decreased (0.2965 --> 0.2927).  Saving model state dict ...
Epoch: 2 cost time: 8.357378721237183
Epoch: 2, Steps: 1045 | Train Loss: 0.5051666 Vali Loss: 0.2927101 Best vali loss: 0.2927101
	iters: 100, epoch: 3 | loss: 0.4859693
	speed: 0.0294s/iter; left time: 181.2707s
	iters: 200, epoch: 3 | loss: 0.3245409
	speed: 0.0089s/iter; left time: 53.7614s
	iters: 300, epoch: 3 | loss: 0.4970302
	speed: 0.0089s/iter; left time: 53.3409s
	iters: 400, epoch: 3 | loss: 0.4107123
	speed: 0.0072s/iter; left time: 42.3515s
	iters: 500, epoch: 3 | loss: 0.2780966
	speed: 0.0078s/iter; left time: 45.0510s
	iters: 600, epoch: 3 | loss: 0.4877076
	speed: 0.0074s/iter; left time: 41.7788s
	iters: 700, epoch: 3 | loss: 0.2060602
	speed: 0.0083s/iter; left time: 46.1614s
	iters: 800, epoch: 3 | loss: 1.1999508
	speed: 0.0090s/iter; left time: 49.3728s
	iters: 900, epoch: 3 | loss: 0.1600825
	speed: 0.0089s/iter; left time: 47.7122s
	iters: 1000, epoch: 3 | loss: 0.1703326
	speed: 0.0079s/iter; left time: 41.8986s
Updating learning rate to 0.000253302663075
Validation loss decreased (0.2927 --> 0.2782).  Saving model state dict ...
Epoch: 3 cost time: 8.722254991531372
Epoch: 3, Steps: 1045 | Train Loss: 0.4220483 Vali Loss: 0.2782034 Best vali loss: 0.2782034

best validation loss 0.27820339784519343

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0028298480595, 'e_layers': 3, 'learning_rate': 0.0049106915834, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4292256
	speed: 0.0156s/iter; left time: 128.9222s
	iters: 200, epoch: 1 | loss: 0.2385767
	speed: 0.0086s/iter; left time: 69.9557s
	iters: 300, epoch: 1 | loss: 0.3947983
	speed: 0.0085s/iter; left time: 68.5037s
	iters: 400, epoch: 1 | loss: 0.4385753
	speed: 0.0087s/iter; left time: 68.8660s
	iters: 500, epoch: 1 | loss: 0.4438712
	speed: 0.0084s/iter; left time: 66.4212s
	iters: 600, epoch: 1 | loss: 1.2801937
	speed: 0.0090s/iter; left time: 69.5746s
	iters: 700, epoch: 1 | loss: 0.2825243
	speed: 0.0093s/iter; left time: 71.2295s
	iters: 800, epoch: 1 | loss: 0.2343782
	speed: 0.0081s/iter; left time: 61.5802s
	iters: 900, epoch: 1 | loss: 0.3184907
	speed: 0.0068s/iter; left time: 50.5132s
	iters: 1000, epoch: 1 | loss: 0.2500707
	speed: 0.0094s/iter; left time: 68.9164s
Updating learning rate to 0.004723789513889351
Validation loss decreased (inf --> 0.3177).  Saving model state dict ...
Epoch: 1 cost time: 9.336699485778809
Epoch: 1, Steps: 1045 | Train Loss: 0.4310705 Vali Loss: 0.3176572 Best vali loss: 0.3176572
	iters: 100, epoch: 2 | loss: 0.5273100
	speed: 0.0312s/iter; left time: 225.2550s
	iters: 200, epoch: 2 | loss: 0.5333949
	speed: 0.0077s/iter; left time: 54.5491s
	iters: 300, epoch: 2 | loss: 0.4263383
	speed: 0.0077s/iter; left time: 54.1463s
	iters: 400, epoch: 2 | loss: 0.3324087
	speed: 0.0085s/iter; left time: 58.6437s
	iters: 500, epoch: 2 | loss: 0.4340295
	speed: 0.0083s/iter; left time: 56.4658s
	iters: 600, epoch: 2 | loss: 0.5015984
	speed: 0.0083s/iter; left time: 55.9641s
	iters: 700, epoch: 2 | loss: 1.4566824
	speed: 0.0094s/iter; left time: 62.0352s
	iters: 800, epoch: 2 | loss: 0.4279943
	speed: 0.0088s/iter; left time: 57.0689s
	iters: 900, epoch: 2 | loss: 0.2837510
	speed: 0.0071s/iter; left time: 45.7806s
	iters: 1000, epoch: 2 | loss: 0.3582272
	speed: 0.0082s/iter; left time: 51.8036s
Updating learning rate to 0.004191537451168922
Epoch: 2 cost time: 8.811589241027832
Epoch: 2, Steps: 1045 | Train Loss: 0.5281735 Vali Loss: 0.3330222 Best vali loss: 0.3176572
	iters: 100, epoch: 3 | loss: 0.3823230
	speed: 0.0306s/iter; left time: 189.1259s
	iters: 200, epoch: 3 | loss: 0.9691440
	speed: 0.0084s/iter; left time: 51.0667s
	iters: 300, epoch: 3 | loss: 0.5635122
	speed: 0.0065s/iter; left time: 38.8376s
	iters: 400, epoch: 3 | loss: 0.4752921
	speed: 0.0060s/iter; left time: 35.1013s
	iters: 500, epoch: 3 | loss: 1.2467421
	speed: 0.0073s/iter; left time: 42.2403s
	iters: 600, epoch: 3 | loss: 0.1740913
	speed: 0.0095s/iter; left time: 53.7967s
	iters: 700, epoch: 3 | loss: 0.3803167
	speed: 0.0092s/iter; left time: 51.4805s
	iters: 800, epoch: 3 | loss: 0.4434508
	speed: 0.0092s/iter; left time: 50.5116s
	iters: 900, epoch: 3 | loss: 0.3825041
	speed: 0.0087s/iter; left time: 46.8757s
	iters: 1000, epoch: 3 | loss: 0.2272516
	speed: 0.0090s/iter; left time: 47.4606s
Updating learning rate to 0.003394965946910935
Epoch: 3 cost time: 8.737241983413696
Epoch: 3, Steps: 1045 | Train Loss: 0.5244628 Vali Loss: 0.3225883 Best vali loss: 0.3176572

best validation loss 0.3176571577731984

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3209649
	speed: 0.0163s/iter; left time: 83.4763s
	iters: 200, epoch: 4 | loss: 0.2772931
	speed: 0.0083s/iter; left time: 41.8626s
	iters: 300, epoch: 4 | loss: 0.6703428
	speed: 0.0089s/iter; left time: 43.7284s
	iters: 400, epoch: 4 | loss: 0.3240244
	speed: 0.0084s/iter; left time: 40.4627s
	iters: 500, epoch: 4 | loss: 0.3520300
	speed: 0.0086s/iter; left time: 40.7310s
	iters: 600, epoch: 4 | loss: 0.2230496
	speed: 0.0091s/iter; left time: 42.1806s
	iters: 700, epoch: 4 | loss: 0.4010563
	speed: 0.0093s/iter; left time: 42.0974s
	iters: 800, epoch: 4 | loss: 0.2064179
	speed: 0.0082s/iter; left time: 36.3767s
	iters: 900, epoch: 4 | loss: 0.1252212
	speed: 0.0084s/iter; left time: 36.1384s
	iters: 1000, epoch: 4 | loss: 0.5756907
	speed: 0.0091s/iter; left time: 38.6131s
Updating learning rate to 0.0001266513315375
Epoch: 4 cost time: 9.49673581123352
Epoch: 4, Steps: 1045 | Train Loss: 0.3476091 Vali Loss: 0.2828263 Best vali loss: 0.2782034
	iters: 100, epoch: 5 | loss: 0.2613602
	speed: 0.0284s/iter; left time: 115.8440s
	iters: 200, epoch: 5 | loss: 0.1919616
	speed: 0.0088s/iter; left time: 35.0912s
	iters: 300, epoch: 5 | loss: 0.7142155
	speed: 0.0088s/iter; left time: 33.9753s
	iters: 400, epoch: 5 | loss: 0.2957522
	speed: 0.0093s/iter; left time: 34.9839s
	iters: 500, epoch: 5 | loss: 0.3038287
	speed: 0.0081s/iter; left time: 29.6476s
	iters: 600, epoch: 5 | loss: 0.6153764
	speed: 0.0088s/iter; left time: 31.6420s
	iters: 700, epoch: 5 | loss: 1.0483984
	speed: 0.0091s/iter; left time: 31.7943s
	iters: 800, epoch: 5 | loss: 0.3214259
	speed: 0.0092s/iter; left time: 31.0679s
	iters: 900, epoch: 5 | loss: 0.2401266
	speed: 0.0077s/iter; left time: 25.3098s
	iters: 1000, epoch: 5 | loss: 0.3168614
	speed: 0.0075s/iter; left time: 23.9044s
Updating learning rate to 6.332566576875e-05
Epoch: 5 cost time: 9.06781792640686
Epoch: 5, Steps: 1045 | Train Loss: 0.4309307 Vali Loss: 0.2790942 Best vali loss: 0.2782034
	iters: 100, epoch: 6 | loss: 0.4686811
	speed: 0.0273s/iter; left time: 82.7858s
	iters: 200, epoch: 6 | loss: 0.1848447
	speed: 0.0088s/iter; left time: 25.7369s
	iters: 300, epoch: 6 | loss: 0.5227520
	speed: 0.0091s/iter; left time: 25.6869s
	iters: 400, epoch: 6 | loss: 0.3619308
	speed: 0.0084s/iter; left time: 23.0012s
	iters: 500, epoch: 6 | loss: 0.2210062
	speed: 0.0092s/iter; left time: 24.2569s
	iters: 600, epoch: 6 | loss: 0.5236087
	speed: 0.0094s/iter; left time: 23.8255s
	iters: 700, epoch: 6 | loss: 0.2025881
	speed: 0.0089s/iter; left time: 21.6803s
	iters: 800, epoch: 6 | loss: 1.0301340
	speed: 0.0086s/iter; left time: 20.0524s
	iters: 900, epoch: 6 | loss: 0.1529261
	speed: 0.0087s/iter; left time: 19.3661s
	iters: 1000, epoch: 6 | loss: 0.1773149
	speed: 0.0087s/iter; left time: 18.5350s
Updating learning rate to 3.1662832884375e-05
Validation loss decreased (0.2782 --> 0.2780).  Saving model state dict ...
Epoch: 6 cost time: 9.29397988319397
Epoch: 6, Steps: 1045 | Train Loss: 0.3845787 Vali Loss: 0.2779870 Best vali loss: 0.2779870
	iters: 100, epoch: 7 | loss: 0.1965749
	speed: 0.0281s/iter; left time: 55.9818s
	iters: 200, epoch: 7 | loss: 0.2673168
	speed: 0.0086s/iter; left time: 16.2288s
	iters: 300, epoch: 7 | loss: 0.3047278
	speed: 0.0090s/iter; left time: 16.1396s
	iters: 400, epoch: 7 | loss: 0.2742544
	speed: 0.0087s/iter; left time: 14.6324s
	iters: 500, epoch: 7 | loss: 0.1708339
	speed: 0.0083s/iter; left time: 13.2813s
	iters: 600, epoch: 7 | loss: 0.1714360
	speed: 0.0087s/iter; left time: 12.9857s
	iters: 700, epoch: 7 | loss: 0.3955422
	speed: 0.0085s/iter; left time: 11.8499s
	iters: 800, epoch: 7 | loss: 0.6124374
	speed: 0.0081s/iter; left time: 10.4305s
	iters: 900, epoch: 7 | loss: 0.4155258
	speed: 0.0076s/iter; left time: 9.0350s
	iters: 1000, epoch: 7 | loss: 0.4012628
	speed: 0.0083s/iter; left time: 9.0375s
Updating learning rate to 1.58314164421875e-05
Epoch: 7 cost time: 8.846171617507935
Epoch: 7, Steps: 1045 | Train Loss: 0.3209912 Vali Loss: 0.2808235 Best vali loss: 0.2779870
	iters: 100, epoch: 8 | loss: 0.4068924
	speed: 0.0243s/iter; left time: 22.9621s
	iters: 200, epoch: 8 | loss: 0.2517422
	speed: 0.0079s/iter; left time: 6.6702s
	iters: 300, epoch: 8 | loss: 0.4034875
	speed: 0.0092s/iter; left time: 6.8813s
	iters: 400, epoch: 8 | loss: 0.9594926
	speed: 0.0094s/iter; left time: 6.0412s
	iters: 500, epoch: 8 | loss: 0.9210609
	speed: 0.0088s/iter; left time: 4.8287s
	iters: 600, epoch: 8 | loss: 0.3005628
	speed: 0.0087s/iter; left time: 3.8966s
	iters: 700, epoch: 8 | loss: 0.2296897
	speed: 0.0088s/iter; left time: 3.0323s
	iters: 800, epoch: 8 | loss: 0.4290340
	speed: 0.0092s/iter; left time: 2.2703s
	iters: 900, epoch: 8 | loss: 1.1680990
	speed: 0.0093s/iter; left time: 1.3516s
	iters: 1000, epoch: 8 | loss: 0.5693250
	speed: 0.0094s/iter; left time: 0.4338s
Updating learning rate to 7.91570822109375e-06
Epoch: 8 cost time: 9.24315357208252
Epoch: 8, Steps: 1045 | Train Loss: 0.5639386 Vali Loss: 0.2795195 Best vali loss: 0.2779870

best validation loss 0.27798703137761643

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0049587887577, 'e_layers': 2, 'learning_rate': 0.0017288793159, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6079020
	speed: 0.0136s/iter; left time: 112.3885s
	iters: 200, epoch: 1 | loss: 0.3139328
	speed: 0.0075s/iter; left time: 61.2895s
	iters: 300, epoch: 1 | loss: 0.7579542
	speed: 0.0074s/iter; left time: 59.7408s
	iters: 400, epoch: 1 | loss: 1.8731468
	speed: 0.0063s/iter; left time: 49.8076s
	iters: 500, epoch: 1 | loss: 0.3726796
	speed: 0.0065s/iter; left time: 50.7542s
	iters: 600, epoch: 1 | loss: 1.1785604
	speed: 0.0072s/iter; left time: 55.5679s
	iters: 700, epoch: 1 | loss: 0.9352438
	speed: 0.0072s/iter; left time: 55.1005s
	iters: 800, epoch: 1 | loss: 0.4666054
	speed: 0.0071s/iter; left time: 53.5386s
	iters: 900, epoch: 1 | loss: 1.0795321
	speed: 0.0071s/iter; left time: 53.0120s
	iters: 1000, epoch: 1 | loss: 0.8093486
	speed: 0.0071s/iter; left time: 52.3099s
Updating learning rate to 0.0016630777650210626
Validation loss decreased (inf --> 0.3225).  Saving model state dict ...
Epoch: 1 cost time: 7.708123445510864
Epoch: 1, Steps: 1045 | Train Loss: 0.8394906 Vali Loss: 0.3225092 Best vali loss: 0.3225092
	iters: 100, epoch: 2 | loss: 1.2354181
	speed: 0.0208s/iter; left time: 150.2300s
	iters: 200, epoch: 2 | loss: 0.7597790
	speed: 0.0067s/iter; left time: 47.7267s
	iters: 300, epoch: 2 | loss: 0.9674512
	speed: 0.0069s/iter; left time: 48.2770s
	iters: 400, epoch: 2 | loss: 1.1979828
	speed: 0.0066s/iter; left time: 45.6585s
	iters: 500, epoch: 2 | loss: 0.3660540
	speed: 0.0051s/iter; left time: 35.0020s
	iters: 600, epoch: 2 | loss: 0.1599732
	speed: 0.0057s/iter; left time: 38.1526s
	iters: 700, epoch: 2 | loss: 0.4471901
	speed: 0.0072s/iter; left time: 47.3275s
	iters: 800, epoch: 2 | loss: 0.3409897
	speed: 0.0071s/iter; left time: 46.0271s
	iters: 900, epoch: 2 | loss: 0.3364482
	speed: 0.0071s/iter; left time: 45.3409s
	iters: 1000, epoch: 2 | loss: 1.0356685
	speed: 0.0073s/iter; left time: 45.8176s
Updating learning rate to 0.0014756908020130246
Validation loss decreased (0.3225 --> 0.3206).  Saving model state dict ...
Epoch: 2 cost time: 6.834362506866455
Epoch: 2, Steps: 1045 | Train Loss: 0.6846955 Vali Loss: 0.3206309 Best vali loss: 0.3206309
	iters: 100, epoch: 3 | loss: 0.5714322
	speed: 0.0249s/iter; left time: 153.7639s
	iters: 200, epoch: 3 | loss: 0.3269811
	speed: 0.0067s/iter; left time: 40.5748s
	iters: 300, epoch: 3 | loss: 0.3365600
	speed: 0.0059s/iter; left time: 35.3067s
	iters: 400, epoch: 3 | loss: 0.9636768
	speed: 0.0070s/iter; left time: 41.2459s
	iters: 500, epoch: 3 | loss: 0.8012930
	speed: 0.0070s/iter; left time: 40.4305s
	iters: 600, epoch: 3 | loss: 0.2919654
	speed: 0.0070s/iter; left time: 39.7632s
	iters: 700, epoch: 3 | loss: 1.0280601
	speed: 0.0077s/iter; left time: 42.7638s
	iters: 800, epoch: 3 | loss: 1.4766128
	speed: 0.0078s/iter; left time: 42.4641s
	iters: 900, epoch: 3 | loss: 0.3360822
	speed: 0.0075s/iter; left time: 40.0346s
	iters: 1000, epoch: 3 | loss: 0.5046445
	speed: 0.0076s/iter; left time: 40.1476s
Updating learning rate to 0.0011952463933268102
Validation loss decreased (0.3206 --> 0.3202).  Saving model state dict ...
Epoch: 3 cost time: 7.482760429382324
Epoch: 3, Steps: 1045 | Train Loss: 0.6637308 Vali Loss: 0.3202141 Best vali loss: 0.3202141
	iters: 100, epoch: 4 | loss: 1.1728781
	speed: 0.0244s/iter; left time: 124.8447s
	iters: 200, epoch: 4 | loss: 1.3629930
	speed: 0.0070s/iter; left time: 35.2959s
	iters: 300, epoch: 4 | loss: 0.4089662
	speed: 0.0068s/iter; left time: 33.4213s
	iters: 400, epoch: 4 | loss: 0.9824978
	speed: 0.0069s/iter; left time: 33.5125s
	iters: 500, epoch: 4 | loss: 0.5283947
	speed: 0.0075s/iter; left time: 35.5458s
	iters: 600, epoch: 4 | loss: 0.8715879
	speed: 0.0076s/iter; left time: 35.1436s
	iters: 700, epoch: 4 | loss: 1.4671762
	speed: 0.0072s/iter; left time: 32.6599s
	iters: 800, epoch: 4 | loss: 0.6235158
	speed: 0.0072s/iter; left time: 31.8980s
	iters: 900, epoch: 4 | loss: 0.6008044
	speed: 0.0072s/iter; left time: 31.0398s
	iters: 1000, epoch: 4 | loss: 0.3099758
	speed: 0.0076s/iter; left time: 31.9065s
Updating learning rate to 0.00086443965795
Epoch: 4 cost time: 7.524630546569824
Epoch: 4, Steps: 1045 | Train Loss: 0.8328790 Vali Loss: 0.3209053 Best vali loss: 0.3202141
	iters: 100, epoch: 5 | loss: 0.7262906
	speed: 0.0267s/iter; left time: 108.9197s
	iters: 200, epoch: 5 | loss: 0.9532356
	speed: 0.0071s/iter; left time: 28.3463s
	iters: 300, epoch: 5 | loss: 0.5560182
	speed: 0.0070s/iter; left time: 27.2901s
	iters: 400, epoch: 5 | loss: 1.3999863
	speed: 0.0061s/iter; left time: 23.0477s
	iters: 500, epoch: 5 | loss: 0.8460644
	speed: 0.0055s/iter; left time: 20.2676s
	iters: 600, epoch: 5 | loss: 0.1635833
	speed: 0.0076s/iter; left time: 27.0558s
	iters: 700, epoch: 5 | loss: 2.2665830
	speed: 0.0067s/iter; left time: 23.3764s
	iters: 800, epoch: 5 | loss: 0.3751825
	speed: 0.0062s/iter; left time: 20.8094s
	iters: 900, epoch: 5 | loss: 0.7053617
	speed: 0.0061s/iter; left time: 20.0845s
	iters: 1000, epoch: 5 | loss: 0.9337747
	speed: 0.0079s/iter; left time: 25.0992s
Updating learning rate to 0.0005336329225731899
Epoch: 5 cost time: 7.097862958908081
Epoch: 5, Steps: 1045 | Train Loss: 0.8926080 Vali Loss: 0.3218301 Best vali loss: 0.3202141
	iters: 100, epoch: 6 | loss: 0.7302811
	speed: 0.0268s/iter; left time: 81.2838s
	iters: 200, epoch: 6 | loss: 0.3257068
	speed: 0.0072s/iter; left time: 21.1714s
	iters: 300, epoch: 6 | loss: 0.3262677
	speed: 0.0061s/iter; left time: 17.3937s
	iters: 400, epoch: 6 | loss: 0.1346279
	speed: 0.0065s/iter; left time: 17.8445s
	iters: 500, epoch: 6 | loss: 0.2215641
	speed: 0.0066s/iter; left time: 17.4741s
	iters: 600, epoch: 6 | loss: 1.0546378
	speed: 0.0070s/iter; left time: 17.6887s
	iters: 700, epoch: 6 | loss: 1.9657651
	speed: 0.0066s/iter; left time: 16.1273s
	iters: 800, epoch: 6 | loss: 2.7692070
	speed: 0.0065s/iter; left time: 15.1501s
	iters: 900, epoch: 6 | loss: 0.4859459
	speed: 0.0074s/iter; left time: 16.4984s
	iters: 1000, epoch: 6 | loss: 0.4052176
	speed: 0.0073s/iter; left time: 15.5629s
Updating learning rate to 0.0002531885138869754
Epoch: 6 cost time: 7.265445947647095
Epoch: 6, Steps: 1045 | Train Loss: 0.8419221 Vali Loss: 0.3222931 Best vali loss: 0.3202141
	iters: 100, epoch: 7 | loss: 1.0126595
	speed: 0.0302s/iter; left time: 60.1007s
	iters: 200, epoch: 7 | loss: 0.5383916
	speed: 0.0071s/iter; left time: 13.3782s
	iters: 300, epoch: 7 | loss: 0.2980133
	speed: 0.0064s/iter; left time: 11.3762s
	iters: 400, epoch: 7 | loss: 0.3840810
	speed: 0.0071s/iter; left time: 12.0773s
	iters: 500, epoch: 7 | loss: 0.2924723
	speed: 0.0076s/iter; left time: 12.1151s
	iters: 600, epoch: 7 | loss: 0.5251150
	speed: 0.0076s/iter; left time: 11.3872s
	iters: 700, epoch: 7 | loss: 0.3525255
	speed: 0.0076s/iter; left time: 10.5905s
	iters: 800, epoch: 7 | loss: 0.5953486
	speed: 0.0071s/iter; left time: 9.1970s
	iters: 900, epoch: 7 | loss: 0.9220409
	speed: 0.0068s/iter; left time: 8.0781s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 2, 'learning_rate': 0.0007022928253, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3361700
	speed: 0.0122s/iter; left time: 49.8298s
	iters: 200, epoch: 1 | loss: 0.3991817
	speed: 0.0074s/iter; left time: 29.6327s
	iters: 300, epoch: 1 | loss: 0.5176546
	speed: 0.0073s/iter; left time: 28.4432s
	iters: 400, epoch: 1 | loss: 0.6077105
	speed: 0.0069s/iter; left time: 26.0045s
	iters: 500, epoch: 1 | loss: 0.6108145
	speed: 0.0063s/iter; left time: 23.2228s
Updating learning rate to 0.0007022928253
Validation loss decreased (inf --> 0.2933).  Saving model state dict ...
Epoch: 1 cost time: 3.881615400314331
Epoch: 1, Steps: 523 | Train Loss: 0.4943063 Vali Loss: 0.2933333 Best vali loss: 0.2933333
	iters: 100, epoch: 2 | loss: 0.8235176
	speed: 0.0148s/iter; left time: 52.7107s
	iters: 200, epoch: 2 | loss: 0.2719266
	speed: 0.0071s/iter; left time: 24.6754s
	iters: 300, epoch: 2 | loss: 0.5649039
	speed: 0.0072s/iter; left time: 24.1440s
	iters: 400, epoch: 2 | loss: 0.6402633
	speed: 0.0073s/iter; left time: 23.8043s
	iters: 500, epoch: 2 | loss: 0.3453362
	speed: 0.0069s/iter; left time: 21.7143s
Updating learning rate to 0.00035114641265
Validation loss decreased (0.2933 --> 0.2803).  Saving model state dict ...
Epoch: 2 cost time: 3.7114338874816895
Epoch: 2, Steps: 523 | Train Loss: 0.5291895 Vali Loss: 0.2803196 Best vali loss: 0.2803196
	iters: 100, epoch: 3 | loss: 0.3890936
	speed: 0.0160s/iter; left time: 48.5347s
	iters: 200, epoch: 3 | loss: 0.2760909
	speed: 0.0076s/iter; left time: 22.2076s
	iters: 300, epoch: 3 | loss: 0.5152902
	speed: 0.0076s/iter; left time: 21.5008s
	iters: 400, epoch: 3 | loss: 0.2375663
	speed: 0.0072s/iter; left time: 19.7477s
	iters: 500, epoch: 3 | loss: 0.2398734
	speed: 0.0068s/iter; left time: 17.8199s
Updating learning rate to 0.000175573206325
Validation loss decreased (0.2803 --> 0.2754).  Saving model state dict ...
Epoch: 3 cost time: 3.7708914279937744
Epoch: 3, Steps: 523 | Train Loss: 0.3315829 Vali Loss: 0.2754455 Best vali loss: 0.2754455
	iters: 100, epoch: 4 | loss: 0.2798550
	speed: 0.0157s/iter; left time: 39.4934s
	iters: 200, epoch: 4 | loss: 0.5562106
	speed: 0.0070s/iter; left time: 16.9971s
	iters: 300, epoch: 4 | loss: 0.4382618
	speed: 0.0073s/iter; left time: 16.8510s
	iters: 400, epoch: 4 | loss: 0.2875812
	speed: 0.0074s/iter; left time: 16.4071s
	iters: 500, epoch: 4 | loss: 0.3829687
	speed: 0.0074s/iter; left time: 15.5634s
Updating learning rate to 8.77866031625e-05
Epoch: 4 cost time: 3.7477967739105225
Epoch: 4, Steps: 523 | Train Loss: 0.3889755 Vali Loss: 0.2807506 Best vali loss: 0.2754455
	iters: 100, epoch: 5 | loss: 0.6121233
	speed: 0.0154s/iter; left time: 30.6905s
	iters: 200, epoch: 5 | loss: 0.4688867
	speed: 0.0060s/iter; left time: 11.3470s
	iters: 300, epoch: 5 | loss: 0.3368533
	speed: 0.0070s/iter; left time: 12.6324s
	iters: 400, epoch: 5 | loss: 0.4052981
	speed: 0.0072s/iter; left time: 12.1255s
	iters: 500, epoch: 5 | loss: 0.2544124
	speed: 0.0069s/iter; left time: 10.9154s
Updating learning rate to 4.389330158125e-05
Epoch: 5 cost time: 3.4965288639068604
Epoch: 5, Steps: 523 | Train Loss: 0.4155148 Vali Loss: 0.2821678 Best vali loss: 0.2754455
	iters: 100, epoch: 6 | loss: 0.4300179
	speed: 0.0163s/iter; left time: 23.9279s
	iters: 200, epoch: 6 | loss: 0.2097454
	speed: 0.0065s/iter; left time: 8.9650s
	iters: 300, epoch: 6 | loss: 0.2090877
	speed: 0.0061s/iter; left time: 7.7617s
	iters: 400, epoch: 6 | loss: 0.2841909
	speed: 0.0060s/iter; left time: 7.0696s
	iters: 500, epoch: 6 | loss: 0.5886306
	speed: 0.0069s/iter; left time: 7.3579s
Updating learning rate to 2.1946650790625e-05
Epoch: 6 cost time: 3.438263416290283
Epoch: 6, Steps: 523 | Train Loss: 0.3443345 Vali Loss: 0.2826368 Best vali loss: 0.2754455
	iters: 100, epoch: 7 | loss: 0.3421758
	speed: 0.0157s/iter; left time: 14.8262s
	iters: 200, epoch: 7 | loss: 0.3179814
	speed: 0.0059s/iter; left time: 5.0021s
	iters: 300, epoch: 7 | loss: 0.2630973
	speed: 0.0055s/iter; left time: 4.1446s
	iters: 400, epoch: 7 | loss: 0.2249680
	speed: 0.0058s/iter; left time: 3.7385s
	iters: 500, epoch: 7 | loss: 0.3593309
	speed: 0.0064s/iter; left time: 3.5165s
Updating learning rate to 1.09733253953125e-05
Epoch: 7 cost time: 3.2151145935058594
Epoch: 7, Steps: 523 | Train Loss: 0.3015107 Vali Loss: 0.2828225 Best vali loss: 0.2754455
	iters: 100, epoch: 8 | loss: 0.2784894
	speed: 0.0153s/iter; left time: 6.4716s
	iters: 200, epoch: 8 | loss: 0.2415277
	speed: 0.0061s/iter; left time: 1.9924s
	iters: 300, epoch: 8 | loss: 0.4853172
	speed: 0.0062s/iter; left time: 1.3782s
	iters: 400, epoch: 8 | loss: 0.4484225
	speed: 0.0066s/iter; left time: 0.8151s
	iters: 500, epoch: 8 | loss: 0.3259979
	speed: 0.0065s/iter; left time: 0.1557s
Updating learning rate to 5.48666269765625e-06
Epoch: 8 cost time: 3.381727695465088
Epoch: 8, Steps: 523 | Train Loss: 0.3559510 Vali Loss: 0.2828402 Best vali loss: 0.2754455

best validation loss 0.27544554219054396

[INFO][abstract_intensifier.py:595] Added config f104fd and rejected config 1c2cbe as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096207564637, 'e_layers': 2, 'learning_rate': 0.0003903011818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3608462
	speed: 0.0130s/iter; left time: 53.0565s
	iters: 200, epoch: 1 | loss: 0.3387230
	speed: 0.0069s/iter; left time: 27.6103s
	iters: 300, epoch: 1 | loss: 0.6354194
	speed: 0.0063s/iter; left time: 24.4814s
	iters: 400, epoch: 1 | loss: 0.3497261
	speed: 0.0059s/iter; left time: 22.4342s
	iters: 500, epoch: 1 | loss: 0.5323489
	speed: 0.0054s/iter; left time: 19.8542s
Updating learning rate to 0.0003903011818
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 3.605415105819702
Epoch: 1, Steps: 523 | Train Loss: 0.4434127 Vali Loss: 0.2811711 Best vali loss: 0.2811711
	iters: 100, epoch: 2 | loss: 0.2930171
	speed: 0.0147s/iter; left time: 52.2274s
	iters: 200, epoch: 2 | loss: 0.5561981
	speed: 0.0069s/iter; left time: 23.7601s
	iters: 300, epoch: 2 | loss: 0.4270189
	speed: 0.0067s/iter; left time: 22.6398s
	iters: 400, epoch: 2 | loss: 0.3056159
	speed: 0.0067s/iter; left time: 21.8825s
	iters: 500, epoch: 2 | loss: 0.4051103
	speed: 0.0063s/iter; left time: 20.0574s
Updating learning rate to 0.0001951505909
Epoch: 2 cost time: 3.5406768321990967
Epoch: 2, Steps: 523 | Train Loss: 0.3973920 Vali Loss: 0.2908450 Best vali loss: 0.2811711
	iters: 100, epoch: 3 | loss: 0.3838393
	speed: 0.0154s/iter; left time: 46.8447s
	iters: 200, epoch: 3 | loss: 0.1970884
	speed: 0.0069s/iter; left time: 20.1611s
	iters: 300, epoch: 3 | loss: 0.3569506
	speed: 0.0065s/iter; left time: 18.4447s
	iters: 400, epoch: 3 | loss: 0.5873567
	speed: 0.0059s/iter; left time: 16.0245s
	iters: 500, epoch: 3 | loss: 0.5767660
	speed: 0.0051s/iter; left time: 13.4516s
Updating learning rate to 9.757529545e-05
Epoch: 3 cost time: 3.260406970977783
Epoch: 3, Steps: 523 | Train Loss: 0.4204002 Vali Loss: 0.2820690 Best vali loss: 0.2811711

best validation loss 0.28117111800726835

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 6.03723773e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4320134
	speed: 0.0139s/iter; left time: 13.1812s
Updating learning rate to 5.8074590508259505e-05
Validation loss decreased (inf --> 0.3451).  Saving model state dict ...
Epoch: 1 cost time: 1.364534616470337
Epoch: 1, Steps: 131 | Train Loss: 0.4320134 Vali Loss: 0.3451400 Best vali loss: 0.3451400
	iters: 100, epoch: 2 | loss: 0.6943498
	speed: 0.0137s/iter; left time: 11.1968s
Updating learning rate to 5.153104734259139e-05
Validation loss decreased (0.3451 --> 0.3299).  Saving model state dict ...
Epoch: 2 cost time: 1.0811002254486084
Epoch: 2, Steps: 131 | Train Loss: 0.6943498 Vali Loss: 0.3298644 Best vali loss: 0.3298644
	iters: 100, epoch: 3 | loss: 0.9485378
	speed: 0.0133s/iter; left time: 9.1408s
Updating learning rate to 4.1737942932602113e-05
Validation loss decreased (0.3299 --> 0.3202).  Saving model state dict ...
Epoch: 3 cost time: 1.0816967487335205
Epoch: 3, Steps: 131 | Train Loss: 0.9485378 Vali Loss: 0.3202057 Best vali loss: 0.3202057

best validation loss 0.32020570574395496

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7276980
	speed: 0.0107s/iter; left time: 43.6392s
	iters: 200, epoch: 1 | loss: 0.7011939
	speed: 0.0054s/iter; left time: 21.4397s
	iters: 300, epoch: 1 | loss: 0.3864060
	speed: 0.0068s/iter; left time: 26.5261s
	iters: 400, epoch: 1 | loss: 0.2710159
	speed: 0.0070s/iter; left time: 26.5574s
	iters: 500, epoch: 1 | loss: 0.5340909
	speed: 0.0065s/iter; left time: 24.1143s
Updating learning rate to 0.00019193372885267988
Validation loss decreased (inf --> 0.2754).  Saving model state dict ...
Epoch: 1 cost time: 3.5311429500579834
Epoch: 1, Steps: 523 | Train Loss: 0.5240810 Vali Loss: 0.2753594 Best vali loss: 0.2753594
	iters: 100, epoch: 2 | loss: 0.3212515
	speed: 0.0167s/iter; left time: 59.6437s
	iters: 200, epoch: 2 | loss: 0.5093736
	speed: 0.0070s/iter; left time: 24.1521s
	iters: 300, epoch: 2 | loss: 0.8628918
	speed: 0.0070s/iter; left time: 23.5648s
	iters: 400, epoch: 2 | loss: 0.6030171
	speed: 0.0069s/iter; left time: 22.3749s
	iters: 500, epoch: 2 | loss: 0.6119345
	speed: 0.0068s/iter; left time: 21.6198s
Updating learning rate to 0.00017030763336576413
Epoch: 2 cost time: 3.6614291667938232
Epoch: 2, Steps: 523 | Train Loss: 0.5816937 Vali Loss: 0.2778565 Best vali loss: 0.2753594
	iters: 100, epoch: 3 | loss: 0.3089369
	speed: 0.0144s/iter; left time: 43.7125s
	iters: 200, epoch: 3 | loss: 0.2752380
	speed: 0.0064s/iter; left time: 18.7182s
	iters: 300, epoch: 3 | loss: 0.7028895
	speed: 0.0068s/iter; left time: 19.3000s
	iters: 400, epoch: 3 | loss: 0.8602192
	speed: 0.0069s/iter; left time: 18.7752s
	iters: 500, epoch: 3 | loss: 0.2608246
	speed: 0.0069s/iter; left time: 18.1703s
Updating learning rate to 0.00013794189423609193
Epoch: 3 cost time: 3.4397470951080322
Epoch: 3, Steps: 523 | Train Loss: 0.4816216 Vali Loss: 0.2806266 Best vali loss: 0.2753594

best validation loss 0.2753593903346636

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4286644
	speed: 0.0143s/iter; left time: 36.0521s
	iters: 200, epoch: 4 | loss: 0.3389888
	speed: 0.0071s/iter; left time: 17.1645s
	iters: 300, epoch: 4 | loss: 0.2878295
	speed: 0.0069s/iter; left time: 16.0473s
	iters: 400, epoch: 4 | loss: 0.2615167
	speed: 0.0066s/iter; left time: 14.5919s
	iters: 500, epoch: 4 | loss: 0.3202443
	speed: 0.0057s/iter; left time: 12.0039s
Updating learning rate to 9.976390185e-05
Epoch: 4 cost time: 3.8395447731018066
Epoch: 4, Steps: 523 | Train Loss: 0.3274487 Vali Loss: 0.2807024 Best vali loss: 0.2753594
	iters: 100, epoch: 5 | loss: 0.2559368
	speed: 0.0131s/iter; left time: 26.1384s
	iters: 200, epoch: 5 | loss: 0.4280900
	speed: 0.0070s/iter; left time: 13.3147s
	iters: 300, epoch: 5 | loss: 0.4897342
	speed: 0.0070s/iter; left time: 12.5235s
	iters: 400, epoch: 5 | loss: 0.4676594
	speed: 0.0069s/iter; left time: 11.6361s
	iters: 500, epoch: 5 | loss: 0.4950738
	speed: 0.0068s/iter; left time: 10.8804s
Updating learning rate to 6.158590946390807e-05
Epoch: 5 cost time: 3.634166955947876
Epoch: 5, Steps: 523 | Train Loss: 0.4272988 Vali Loss: 0.3058534 Best vali loss: 0.2753594
	iters: 100, epoch: 6 | loss: 0.1773152
	speed: 0.0164s/iter; left time: 24.1187s
	iters: 200, epoch: 6 | loss: 0.2278584
	speed: 0.0065s/iter; left time: 8.8623s
	iters: 300, epoch: 6 | loss: 0.3531408
	speed: 0.0066s/iter; left time: 8.3466s
	iters: 400, epoch: 6 | loss: 0.5378733
	speed: 0.0067s/iter; left time: 7.8378s
	iters: 500, epoch: 6 | loss: 0.1920164
	speed: 0.0059s/iter; left time: 6.3643s
Updating learning rate to 2.922017033423585e-05
Epoch: 6 cost time: 3.4199471473693848
Epoch: 6, Steps: 523 | Train Loss: 0.2976408 Vali Loss: 0.3144204 Best vali loss: 0.2753594
	iters: 100, epoch: 7 | loss: 0.4489094
	speed: 0.0150s/iter; left time: 14.2303s
	iters: 200, epoch: 7 | loss: 0.2503020
	speed: 0.0067s/iter; left time: 5.7124s
	iters: 300, epoch: 7 | loss: 0.1239594
	speed: 0.0068s/iter; left time: 5.0860s
	iters: 400, epoch: 7 | loss: 0.1633350
	speed: 0.0068s/iter; left time: 4.3685s
	iters: 500, epoch: 7 | loss: 0.1639938
	speed: 0.0068s/iter; left time: 3.7358s
Updating learning rate to 7.594074847320105e-06
Epoch: 7 cost time: 3.5801432132720947
Epoch: 7, Steps: 523 | Train Loss: 0.2300999 Vali Loss: 0.3237055 Best vali loss: 0.2753594
	iters: 100, epoch: 8 | loss: 0.3627416
	speed: 0.0153s/iter; left time: 6.4940s
	iters: 200, epoch: 8 | loss: 0.3240383
	speed: 0.0066s/iter; left time: 2.1406s
	iters: 300, epoch: 8 | loss: 0.3041580
	speed: 0.0062s/iter; left time: 1.3973s
	iters: 400, epoch: 8 | loss: 0.1948284
	speed: 0.0063s/iter; left time: 0.7825s
	iters: 500, epoch: 8 | loss: 0.1591659
	speed: 0.0065s/iter; left time: 0.1564s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.403735399246216
Epoch: 8, Steps: 523 | Train Loss: 0.2689864 Vali Loss: 0.3260837 Best vali loss: 0.2753594

best validation loss 0.2753593903346636

[INFO][abstract_intensifier.py:595] Added config 47e958 and rejected config f104fd as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0031170389496, 'e_layers': 1, 'learning_rate': 0.0003294206574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3620528
	speed: 0.0110s/iter; left time: 45.0036s
	iters: 200, epoch: 1 | loss: 0.3042332
	speed: 0.0049s/iter; left time: 19.5126s
	iters: 300, epoch: 1 | loss: 0.2821472
	speed: 0.0049s/iter; left time: 19.1397s
	iters: 400, epoch: 1 | loss: 0.2802007
	speed: 0.0047s/iter; left time: 17.9192s
	iters: 500, epoch: 1 | loss: 0.7582747
	speed: 0.0047s/iter; left time: 17.3188s
Updating learning rate to 0.0003168828301791364
Validation loss decreased (inf --> 0.2816).  Saving model state dict ...
Epoch: 1 cost time: 2.877199172973633
Epoch: 1, Steps: 523 | Train Loss: 0.3973817 Vali Loss: 0.2816184 Best vali loss: 0.2816184
	iters: 100, epoch: 2 | loss: 0.8944160
	speed: 0.0123s/iter; left time: 43.7078s
	iters: 200, epoch: 2 | loss: 0.3261505
	speed: 0.0040s/iter; left time: 13.7042s
	iters: 300, epoch: 2 | loss: 0.5692585
	speed: 0.0045s/iter; left time: 15.0490s
	iters: 400, epoch: 2 | loss: 0.3540745
	speed: 0.0047s/iter; left time: 15.3673s
	iters: 500, epoch: 2 | loss: 0.5743093
	speed: 0.0049s/iter; left time: 15.3457s
Updating learning rate to 0.0002811781190552352
Epoch: 2 cost time: 2.3966166973114014
Epoch: 2, Steps: 523 | Train Loss: 0.5436417 Vali Loss: 0.2865922 Best vali loss: 0.2816184
	iters: 100, epoch: 3 | loss: 0.3698156
	speed: 0.0114s/iter; left time: 34.7055s
	iters: 200, epoch: 3 | loss: 0.3160769
	speed: 0.0040s/iter; left time: 11.7911s
	iters: 300, epoch: 3 | loss: 0.7767087
	speed: 0.0044s/iter; left time: 12.5684s
	iters: 400, epoch: 3 | loss: 0.7316116
	speed: 0.0051s/iter; left time: 13.9218s
	iters: 500, epoch: 3 | loss: 0.3975469
	speed: 0.0049s/iter; left time: 12.8627s
Updating learning rate to 0.0002277422426328982
Epoch: 3 cost time: 2.4094223976135254
Epoch: 3, Steps: 523 | Train Loss: 0.5183519 Vali Loss: 0.2865080 Best vali loss: 0.2816184
	iters: 100, epoch: 4 | loss: 0.6099504
	speed: 0.0131s/iter; left time: 32.9039s
	iters: 200, epoch: 4 | loss: 0.2258028
	speed: 0.0042s/iter; left time: 10.1925s
	iters: 300, epoch: 4 | loss: 0.3458350
	speed: 0.0044s/iter; left time: 10.2883s
	iters: 400, epoch: 4 | loss: 0.6391314
	speed: 0.0047s/iter; left time: 10.3618s
	iters: 500, epoch: 4 | loss: 0.5033696
	speed: 0.0051s/iter; left time: 10.7842s
Updating learning rate to 0.0001647103287
Epoch: 4 cost time: 2.543174982070923
Epoch: 4, Steps: 523 | Train Loss: 0.4648178 Vali Loss: 0.2888969 Best vali loss: 0.2816184
	iters: 100, epoch: 5 | loss: 0.4788693
	speed: 0.0144s/iter; left time: 28.5998s
	iters: 200, epoch: 5 | loss: 0.6016619
	speed: 0.0051s/iter; left time: 9.7236s
	iters: 300, epoch: 5 | loss: 0.4290253
	speed: 0.0048s/iter; left time: 8.6249s
	iters: 400, epoch: 5 | loss: 0.2697476
	speed: 0.0051s/iter; left time: 8.6604s
	iters: 500, epoch: 5 | loss: 0.3363599
	speed: 0.0057s/iter; left time: 9.1096s
Updating learning rate to 0.00010167841476710186
Epoch: 5 cost time: 2.8134605884552
Epoch: 5, Steps: 523 | Train Loss: 0.4231328 Vali Loss: 0.2941891 Best vali loss: 0.2816184
	iters: 100, epoch: 6 | loss: 0.3995851
	speed: 0.0116s/iter; left time: 17.1254s
	iters: 200, epoch: 6 | loss: 0.3832622
	speed: 0.0049s/iter; left time: 6.6987s
	iters: 300, epoch: 6 | loss: 0.4158944
	speed: 0.0052s/iter; left time: 6.6078s
	iters: 400, epoch: 6 | loss: 0.6131921
	speed: 0.0057s/iter; left time: 6.7101s
	iters: 500, epoch: 6 | loss: 0.6977130
	speed: 0.0047s/iter; left time: 4.9759s
Updating learning rate to 4.824253834476479e-05
Epoch: 6 cost time: 2.66576886177063
Epoch: 6, Steps: 523 | Train Loss: 0.5019293 Vali Loss: 0.2986754 Best vali loss: 0.2816184
	iters: 100, epoch: 7 | loss: 0.3082480
	speed: 0.0119s/iter; left time: 11.2308s
	iters: 200, epoch: 7 | loss: 0.3264087
	speed: 0.0052s/iter; left time: 4.4044s
	iters: 300, epoch: 7 | loss: 0.4628698
	speed: 0.0047s/iter; left time: 3.4823s
	iters: 400, epoch: 7 | loss: 0.2737299
	speed: 0.0053s/iter; left time: 3.4001s
	iters: 500, epoch: 7 | loss: 0.5321501
	speed: 0.0045s/iter; left time: 2.4760s
Updating learning rate to 1.2537827220863625e-05
Epoch: 7 cost time: 2.637255907058716
Epoch: 7, Steps: 523 | Train Loss: 0.3806813 Vali Loss: 0.3039027 Best vali loss: 0.2816184
	iters: 100, epoch: 8 | loss: 0.2861215
	speed: 0.0110s/iter; left time: 4.6842s
	iters: 200, epoch: 8 | loss: 0.2739836
	speed: 0.0055s/iter; left time: 1.7704s
	iters: 300, epoch: 8 | loss: 0.2043432
	speed: 0.0054s/iter; left time: 1.2161s
	iters: 400, epoch: 8 | loss: 0.1749493
	speed: 0.0042s/iter; left time: 0.5182s
	iters: 500, epoch: 8 | loss: 0.2964942
	speed: 0.0044s/iter; left time: 0.1045s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.581002950668335
Epoch: 8, Steps: 523 | Train Loss: 0.2471783 Vali Loss: 0.3000755 Best vali loss: 0.2816184

best validation loss 0.2816184223662437

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018706532697, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0229300
	speed: 0.0196s/iter; left time: 39.0419s
	iters: 200, epoch: 1 | loss: 0.8034917
	speed: 0.0120s/iter; left time: 22.8389s
Updating learning rate to 0.0002779769506
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 3.5340256690979004
Epoch: 1, Steps: 262 | Train Loss: 0.9132109 Vali Loss: 0.2837252 Best vali loss: 0.2837252
	iters: 100, epoch: 2 | loss: 0.8713444
	speed: 0.0302s/iter; left time: 52.4246s
	iters: 200, epoch: 2 | loss: 0.4293079
	speed: 0.0095s/iter; left time: 15.4538s
Updating learning rate to 0.0001389884753
Validation loss decreased (0.2837 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 2.597115993499756
Epoch: 2, Steps: 262 | Train Loss: 0.6503262 Vali Loss: 0.2788092 Best vali loss: 0.2788092
	iters: 100, epoch: 3 | loss: 0.6428289
	speed: 0.0257s/iter; left time: 37.8668s
	iters: 200, epoch: 3 | loss: 0.5945927
	speed: 0.0108s/iter; left time: 14.8130s
Updating learning rate to 6.949423765e-05
Epoch: 3 cost time: 2.6971004009246826
Epoch: 3, Steps: 262 | Train Loss: 0.6187108 Vali Loss: 0.2834238 Best vali loss: 0.2788092
	iters: 100, epoch: 4 | loss: 0.3223612
	speed: 0.0367s/iter; left time: 44.5018s
	iters: 200, epoch: 4 | loss: 1.1411403
	speed: 0.0094s/iter; left time: 10.4125s
Updating learning rate to 3.4747118825e-05
Epoch: 4 cost time: 2.560760259628296
Epoch: 4, Steps: 262 | Train Loss: 0.7317508 Vali Loss: 0.2856599 Best vali loss: 0.2788092
	iters: 100, epoch: 5 | loss: 0.3753218
	speed: 0.0241s/iter; left time: 22.8587s
	iters: 200, epoch: 5 | loss: 0.4375236
	speed: 0.0098s/iter; left time: 8.3088s
Updating learning rate to 1.73735594125e-05
Epoch: 5 cost time: 2.612682580947876
Epoch: 5, Steps: 262 | Train Loss: 0.4064227 Vali Loss: 0.2848608 Best vali loss: 0.2788092
	iters: 100, epoch: 6 | loss: 0.3630330
	speed: 0.0352s/iter; left time: 24.1665s
	iters: 200, epoch: 6 | loss: 0.5365777
	speed: 0.0089s/iter; left time: 5.2156s
Updating learning rate to 8.68677970625e-06
Epoch: 6 cost time: 2.520895004272461
Epoch: 6, Steps: 262 | Train Loss: 0.4498053 Vali Loss: 0.2851171 Best vali loss: 0.2788092
	iters: 100, epoch: 7 | loss: 0.2832803
	speed: 0.0223s/iter; left time: 9.4969s
	iters: 200, epoch: 7 | loss: 0.6647009
	speed: 0.0098s/iter; left time: 3.2010s
Updating learning rate to 4.343389853125e-06
Epoch: 7 cost time: 2.534762144088745
Epoch: 7, Steps: 262 | Train Loss: 0.4739906 Vali Loss: 0.2846607 Best vali loss: 0.2788092
	iters: 100, epoch: 8 | loss: 0.3966956
	speed: 0.0388s/iter; left time: 6.3185s
	iters: 200, epoch: 8 | loss: 0.6460820
	speed: 0.0097s/iter; left time: 0.6113s
Updating learning rate to 2.1716949265625e-06
Epoch: 8 cost time: 2.585698366165161
Epoch: 8, Steps: 262 | Train Loss: 0.5213888 Vali Loss: 0.2848115 Best vali loss: 0.2788092

best validation loss 0.27880923600168467

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.003868950085, 'e_layers': 4, 'learning_rate': 0.0048421309082, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8360452
	speed: 0.0151s/iter; left time: 61.6129s
	iters: 200, epoch: 1 | loss: 0.3780853
	speed: 0.0085s/iter; left time: 33.9760s
	iters: 300, epoch: 1 | loss: 0.8537922
	speed: 0.0088s/iter; left time: 34.2460s
	iters: 400, epoch: 1 | loss: 0.3038052
	speed: 0.0093s/iter; left time: 35.1053s
	iters: 500, epoch: 1 | loss: 0.4066585
	speed: 0.0086s/iter; left time: 31.7891s
Updating learning rate to 0.0048421309082
Validation loss decreased (inf --> 0.3238).  Saving model state dict ...
Epoch: 1 cost time: 4.92657995223999
Epoch: 1, Steps: 523 | Train Loss: 0.5556773 Vali Loss: 0.3238431 Best vali loss: 0.3238431
	iters: 100, epoch: 2 | loss: 0.2649186
	speed: 0.0212s/iter; left time: 75.5904s
	iters: 200, epoch: 2 | loss: 0.7774538
	speed: 0.0104s/iter; left time: 35.8596s
	iters: 300, epoch: 2 | loss: 0.4007126
	speed: 0.0117s/iter; left time: 39.4923s
	iters: 400, epoch: 2 | loss: 0.9693485
	speed: 0.0116s/iter; left time: 37.9834s
	iters: 500, epoch: 2 | loss: 0.4945694
	speed: 0.0114s/iter; left time: 35.9317s
Updating learning rate to 0.0024210654541
Epoch: 2 cost time: 5.750000238418579
Epoch: 2, Steps: 523 | Train Loss: 0.5814006 Vali Loss: 0.3241934 Best vali loss: 0.3238431
	iters: 100, epoch: 3 | loss: 0.3014309
	speed: 0.0231s/iter; left time: 70.0735s
	iters: 200, epoch: 3 | loss: 0.2462479
	speed: 0.0119s/iter; left time: 34.9004s
	iters: 300, epoch: 3 | loss: 0.3361858
	speed: 0.0118s/iter; left time: 33.5396s
	iters: 400, epoch: 3 | loss: 0.3440413
	speed: 0.0117s/iter; left time: 31.9253s
	iters: 500, epoch: 3 | loss: 0.3058682
	speed: 0.0076s/iter; left time: 20.0856s
Updating learning rate to 0.00121053272705
Validation loss decreased (0.3238 --> 0.3224).  Saving model state dict ...
Epoch: 3 cost time: 5.722107410430908
Epoch: 3, Steps: 523 | Train Loss: 0.3067548 Vali Loss: 0.3224330 Best vali loss: 0.3224330

best validation loss 0.32243295029974994

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 1, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.3244).  Saving model state dict ...
Epoch: 1 cost time: 1.3489935398101807
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3243869 Best vali loss: 0.3243869
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.3244 --> 0.3044).  Saving model state dict ...
Epoch: 2 cost time: 0.9745254516601562
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3043548 Best vali loss: 0.3043548
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.3044 --> 0.2985).  Saving model state dict ...
Epoch: 3 cost time: 1.8043818473815918
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2984961 Best vali loss: 0.2984961

best validation loss 0.2984961466791019

[INFO][smbo.py:320] Finished 50 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6593277
	speed: 0.0387s/iter; left time: 36.7366s
Updating learning rate to 0.000280255645
Validation loss decreased (inf --> 0.3069).  Saving model state dict ...
Epoch: 1 cost time: 4.611791133880615
Epoch: 1, Steps: 131 | Train Loss: 0.6593277 Vali Loss: 0.3068873 Best vali loss: 0.3068873
	iters: 100, epoch: 2 | loss: 0.4478238
	speed: 0.0608s/iter; left time: 49.7125s
Updating learning rate to 0.0001401278225
Validation loss decreased (0.3069 --> 0.2916).  Saving model state dict ...
Epoch: 2 cost time: 4.403994560241699
Epoch: 2, Steps: 131 | Train Loss: 0.4478238 Vali Loss: 0.2916223 Best vali loss: 0.2916223
	iters: 100, epoch: 3 | loss: 0.6688806
	speed: 0.0610s/iter; left time: 41.9226s
Updating learning rate to 7.006391125e-05
Validation loss decreased (0.2916 --> 0.2885).  Saving model state dict ...
Epoch: 3 cost time: 2.998899221420288
Epoch: 3, Steps: 131 | Train Loss: 0.6688806 Vali Loss: 0.2884890 Best vali loss: 0.2884890

best validation loss 0.2884890007547128

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6140819
	speed: 0.0237s/iter; left time: 13.1711s
Updating learning rate to 3.5031955625e-05
Validation loss decreased (0.2885 --> 0.2863).  Saving model state dict ...
Epoch: 4 cost time: 2.3904266357421875
Epoch: 4, Steps: 131 | Train Loss: 0.6140819 Vali Loss: 0.2862769 Best vali loss: 0.2862769
	iters: 100, epoch: 5 | loss: 0.4319545
	speed: 0.0322s/iter; left time: 13.6886s
Updating learning rate to 1.75159778125e-05
Validation loss decreased (0.2863 --> 0.2858).  Saving model state dict ...
Epoch: 5 cost time: 2.067293405532837
Epoch: 5, Steps: 131 | Train Loss: 0.4319545 Vali Loss: 0.2857986 Best vali loss: 0.2857986
	iters: 100, epoch: 6 | loss: 0.6632000
	speed: 0.0260s/iter; left time: 7.6468s
Updating learning rate to 8.75798890625e-06
Validation loss decreased (0.2858 --> 0.2855).  Saving model state dict ...
Epoch: 6 cost time: 2.1252646446228027
Epoch: 6, Steps: 131 | Train Loss: 0.6632000 Vali Loss: 0.2855310 Best vali loss: 0.2855310
	iters: 100, epoch: 7 | loss: 0.4742650
	speed: 0.0457s/iter; left time: 7.4482s
Updating learning rate to 4.378994453125e-06
Validation loss decreased (0.2855 --> 0.2854).  Saving model state dict ...
Epoch: 7 cost time: 4.21484112739563
Epoch: 7, Steps: 131 | Train Loss: 0.4742650 Vali Loss: 0.2854296 Best vali loss: 0.2854296
	iters: 100, epoch: 8 | loss: 0.4899097
	speed: 0.0653s/iter; left time: 2.0903s
Updating learning rate to 2.1894972265625e-06
Validation loss decreased (0.2854 --> 0.2854).  Saving model state dict ...
Epoch: 8 cost time: 3.822178363800049
Epoch: 8, Steps: 131 | Train Loss: 0.4899097 Vali Loss: 0.2853875 Best vali loss: 0.2853875

best validation loss 0.28538747370110074

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001339657668, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4125853
	speed: 0.0216s/iter; left time: 43.0991s
	iters: 200, epoch: 1 | loss: 0.3562566
	speed: 0.0154s/iter; left time: 29.3001s
Updating learning rate to 0.0001339657668
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 4.377443552017212
Epoch: 1, Steps: 262 | Train Loss: 0.3844209 Vali Loss: 0.2778911 Best vali loss: 0.2778911
	iters: 100, epoch: 2 | loss: 0.6765474
	speed: 0.0497s/iter; left time: 86.2306s
	iters: 200, epoch: 2 | loss: 1.0276878
	speed: 0.0148s/iter; left time: 24.1926s
Updating learning rate to 6.69828834e-05
Epoch: 2 cost time: 4.020252466201782
Epoch: 2, Steps: 262 | Train Loss: 0.8521176 Vali Loss: 0.2786386 Best vali loss: 0.2778911
	iters: 100, epoch: 3 | loss: 0.3372014
	speed: 0.0381s/iter; left time: 56.0588s
	iters: 200, epoch: 3 | loss: 0.4609301
	speed: 0.0123s/iter; left time: 16.9300s
Updating learning rate to 3.34914417e-05
Epoch: 3 cost time: 3.175177574157715
Epoch: 3, Steps: 262 | Train Loss: 0.3990658 Vali Loss: 0.2820377 Best vali loss: 0.2778911
	iters: 100, epoch: 4 | loss: 0.5451021
	speed: 0.0283s/iter; left time: 34.2834s
	iters: 200, epoch: 4 | loss: 0.3841116
	speed: 0.0110s/iter; left time: 12.2204s
Updating learning rate to 1.674572085e-05
Epoch: 4 cost time: 2.9804978370666504
Epoch: 4, Steps: 262 | Train Loss: 0.4646069 Vali Loss: 0.2833338 Best vali loss: 0.2778911
	iters: 100, epoch: 5 | loss: 0.3046725
	speed: 0.0313s/iter; left time: 29.6853s
	iters: 200, epoch: 5 | loss: 0.3507918
	speed: 0.0118s/iter; left time: 10.0165s
Updating learning rate to 8.372860425e-06
Epoch: 5 cost time: 3.1302196979522705
Epoch: 5, Steps: 262 | Train Loss: 0.3277321 Vali Loss: 0.2845647 Best vali loss: 0.2778911
	iters: 100, epoch: 6 | loss: 0.3829932
	speed: 0.0289s/iter; left time: 19.8220s
	iters: 200, epoch: 6 | loss: 0.4525208
	speed: 0.0111s/iter; left time: 6.4885s
Updating learning rate to 4.1864302125e-06
Epoch: 6 cost time: 2.8792502880096436
Epoch: 6, Steps: 262 | Train Loss: 0.4177570 Vali Loss: 0.2859204 Best vali loss: 0.2778911
	iters: 100, epoch: 7 | loss: 0.3559512
	speed: 0.0362s/iter; left time: 15.3899s
	iters: 200, epoch: 7 | loss: 0.2630753
	speed: 0.0098s/iter; left time: 3.1965s
Updating learning rate to 2.09321510625e-06
Epoch: 7 cost time: 2.5617573261260986
Epoch: 7, Steps: 262 | Train Loss: 0.3095133 Vali Loss: 0.2858425 Best vali loss: 0.2778911
	iters: 100, epoch: 8 | loss: 0.4015946
	speed: 0.0291s/iter; left time: 4.7358s
	iters: 200, epoch: 8 | loss: 0.6211826
	speed: 0.0119s/iter; left time: 0.7524s
Updating learning rate to 1.046607553125e-06
Epoch: 8 cost time: 3.1703150272369385
Epoch: 8, Steps: 262 | Train Loss: 0.5113886 Vali Loss: 0.2862811 Best vali loss: 0.2778911

best validation loss 0.27789110518290944

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7767022
	speed: 0.0166s/iter; left time: 33.1507s
	iters: 200, epoch: 1 | loss: 0.5225638
	speed: 0.0081s/iter; left time: 15.3816s
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.3121).  Saving model state dict ...
Epoch: 1 cost time: 2.680178165435791
Epoch: 1, Steps: 262 | Train Loss: 0.6496330 Vali Loss: 0.3121413 Best vali loss: 0.3121413
	iters: 100, epoch: 2 | loss: 0.5196840
	speed: 0.0209s/iter; left time: 36.3403s
	iters: 200, epoch: 2 | loss: 0.3668865
	speed: 0.0098s/iter; left time: 16.0287s
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.3121 --> 0.2951).  Saving model state dict ...
Epoch: 2 cost time: 2.173109531402588
Epoch: 2, Steps: 262 | Train Loss: 0.4432853 Vali Loss: 0.2951241 Best vali loss: 0.2951241
	iters: 100, epoch: 3 | loss: 0.6012088
	speed: 0.0159s/iter; left time: 23.4202s
	iters: 200, epoch: 3 | loss: 0.9024420
	speed: 0.0075s/iter; left time: 10.2316s
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.2951 --> 0.2900).  Saving model state dict ...
Epoch: 3 cost time: 2.1258301734924316
Epoch: 3, Steps: 262 | Train Loss: 0.7518254 Vali Loss: 0.2900007 Best vali loss: 0.2900007
	iters: 100, epoch: 4 | loss: 0.4751892
	speed: 0.0228s/iter; left time: 27.5851s
	iters: 200, epoch: 4 | loss: 0.5125583
	speed: 0.0086s/iter; left time: 9.5800s
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.2900 --> 0.2880).  Saving model state dict ...
Epoch: 4 cost time: 2.1135690212249756
Epoch: 4, Steps: 262 | Train Loss: 0.4938738 Vali Loss: 0.2880005 Best vali loss: 0.2880005
	iters: 100, epoch: 5 | loss: 0.4601679
	speed: 0.0222s/iter; left time: 21.0681s
	iters: 200, epoch: 5 | loss: 0.4985772
	speed: 0.0079s/iter; left time: 6.7169s
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.2880 --> 0.2872).  Saving model state dict ...
Epoch: 5 cost time: 2.1585607528686523
Epoch: 5, Steps: 262 | Train Loss: 0.4793726 Vali Loss: 0.2871748 Best vali loss: 0.2871748
	iters: 100, epoch: 6 | loss: 0.5880463
	speed: 0.0319s/iter; left time: 21.9352s
	iters: 200, epoch: 6 | loss: 0.5951052
	speed: 0.0076s/iter; left time: 4.4633s
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.2872 --> 0.2868).  Saving model state dict ...
Epoch: 6 cost time: 2.284930944442749
Epoch: 6, Steps: 262 | Train Loss: 0.5915757 Vali Loss: 0.2868098 Best vali loss: 0.2868098
	iters: 100, epoch: 7 | loss: 0.5862943
	speed: 0.0309s/iter; left time: 13.1226s
	iters: 200, epoch: 7 | loss: 0.3297406
	speed: 0.0088s/iter; left time: 2.8569s
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.2868 --> 0.2866).  Saving model state dict ...
Epoch: 7 cost time: 2.1817259788513184
Epoch: 7, Steps: 262 | Train Loss: 0.4580174 Vali Loss: 0.2866223 Best vali loss: 0.2866223
	iters: 100, epoch: 8 | loss: 0.2720267
	speed: 0.0231s/iter; left time: 3.7673s
	iters: 200, epoch: 8 | loss: 0.6749858
	speed: 0.0091s/iter; left time: 0.5738s
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.2866 --> 0.2865).  Saving model state dict ...
Epoch: 8 cost time: 2.433610677719116
Epoch: 8, Steps: 262 | Train Loss: 0.4735063 Vali Loss: 0.2865294 Best vali loss: 0.2865294

best validation loss 0.28652935319671224

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 4, 'learning_rate': 0.0044405212972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0932232
	speed: 0.0187s/iter; left time: 76.3935s
	iters: 200, epoch: 1 | loss: 0.7799341
	speed: 0.0119s/iter; left time: 47.4634s
	iters: 300, epoch: 1 | loss: 0.3466038
	speed: 0.0110s/iter; left time: 42.8015s
	iters: 400, epoch: 1 | loss: 0.3635007
	speed: 0.0095s/iter; left time: 35.8667s
	iters: 500, epoch: 1 | loss: 0.7079662
	speed: 0.0069s/iter; left time: 25.4962s
Updating learning rate to 0.0044405212972
Validation loss decreased (inf --> 0.3304).  Saving model state dict ...
Epoch: 1 cost time: 5.6540162563323975
Epoch: 1, Steps: 523 | Train Loss: 0.6582456 Vali Loss: 0.3304429 Best vali loss: 0.3304429
	iters: 100, epoch: 2 | loss: 0.5703712
	speed: 0.0181s/iter; left time: 64.3508s
	iters: 200, epoch: 2 | loss: 0.2512618
	speed: 0.0087s/iter; left time: 30.0803s
	iters: 300, epoch: 2 | loss: 0.7939686
	speed: 0.0094s/iter; left time: 31.5430s
	iters: 400, epoch: 2 | loss: 0.8855597
	speed: 0.0093s/iter; left time: 30.2181s
	iters: 500, epoch: 2 | loss: 0.6143405
	speed: 0.0094s/iter; left time: 29.5820s
Updating learning rate to 0.0022202606486
Validation loss decreased (0.3304 --> 0.3233).  Saving model state dict ...
Epoch: 2 cost time: 4.829944372177124
Epoch: 2, Steps: 523 | Train Loss: 0.6231004 Vali Loss: 0.3232841 Best vali loss: 0.3232841
	iters: 100, epoch: 3 | loss: 0.6883470
	speed: 0.0194s/iter; left time: 59.0091s
	iters: 200, epoch: 3 | loss: 0.6461840
	speed: 0.0098s/iter; left time: 28.8836s
	iters: 300, epoch: 3 | loss: 0.4288624
	speed: 0.0087s/iter; left time: 24.6328s
	iters: 400, epoch: 3 | loss: 0.7509242
	speed: 0.0091s/iter; left time: 24.7934s
	iters: 500, epoch: 3 | loss: 0.7619556
	speed: 0.0100s/iter; left time: 26.2948s
Updating learning rate to 0.0011101303243
Validation loss decreased (0.3233 --> 0.3219).  Saving model state dict ...
Epoch: 3 cost time: 5.065568447113037
Epoch: 3, Steps: 523 | Train Loss: 0.6552546 Vali Loss: 0.3218780 Best vali loss: 0.3218780

best validation loss 0.32187803862661446

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6505783
	speed: 0.0265s/iter; left time: 25.1521s
Updating learning rate to 0.0011205641286
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 2.8659844398498535
Epoch: 1, Steps: 131 | Train Loss: 0.6505783 Vali Loss: 0.2848924 Best vali loss: 0.2848924
	iters: 100, epoch: 2 | loss: 0.6562496
	speed: 0.0270s/iter; left time: 22.1002s
Updating learning rate to 0.0005602820643
Epoch: 2 cost time: 1.3613996505737305
Epoch: 2, Steps: 131 | Train Loss: 0.6562496 Vali Loss: 0.2890718 Best vali loss: 0.2848924
	iters: 100, epoch: 3 | loss: 0.5539501
	speed: 0.0232s/iter; left time: 15.9545s
Updating learning rate to 0.00028014103215
Validation loss decreased (0.2849 --> 0.2849).  Saving model state dict ...
Epoch: 3 cost time: 1.7754759788513184
Epoch: 3, Steps: 131 | Train Loss: 0.5539501 Vali Loss: 0.2848908 Best vali loss: 0.2848908

best validation loss 0.2848908392280928

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5152154
	speed: 0.0112s/iter; left time: 45.9077s
	iters: 200, epoch: 1 | loss: 0.3359861
	speed: 0.0049s/iter; left time: 19.4717s
	iters: 300, epoch: 1 | loss: 0.7705992
	speed: 0.0039s/iter; left time: 15.3308s
	iters: 400, epoch: 1 | loss: 1.0381320
	speed: 0.0054s/iter; left time: 20.4415s
	iters: 500, epoch: 1 | loss: 0.4800021
	speed: 0.0062s/iter; left time: 22.7070s
Updating learning rate to 0.0012523603238
Validation loss decreased (inf --> 0.2910).  Saving model state dict ...
Epoch: 1 cost time: 2.980738878250122
Epoch: 1, Steps: 523 | Train Loss: 0.6279870 Vali Loss: 0.2910148 Best vali loss: 0.2910148
	iters: 100, epoch: 2 | loss: 0.3853722
	speed: 0.0124s/iter; left time: 44.0778s
	iters: 200, epoch: 2 | loss: 0.4843412
	speed: 0.0049s/iter; left time: 16.9064s
	iters: 300, epoch: 2 | loss: 0.2564674
	speed: 0.0049s/iter; left time: 16.6203s
	iters: 400, epoch: 2 | loss: 0.4275474
	speed: 0.0049s/iter; left time: 15.9599s
	iters: 500, epoch: 2 | loss: 0.3864377
	speed: 0.0042s/iter; left time: 13.2592s
Updating learning rate to 0.0006261801619
Validation loss decreased (0.2910 --> 0.2872).  Saving model state dict ...
Epoch: 2 cost time: 2.5380778312683105
Epoch: 2, Steps: 523 | Train Loss: 0.3880332 Vali Loss: 0.2871634 Best vali loss: 0.2871634
	iters: 100, epoch: 3 | loss: 0.2151814
	speed: 0.0120s/iter; left time: 36.5031s
	iters: 200, epoch: 3 | loss: 0.7205762
	speed: 0.0039s/iter; left time: 11.4270s
	iters: 300, epoch: 3 | loss: 0.2316953
	speed: 0.0045s/iter; left time: 12.8850s
	iters: 400, epoch: 3 | loss: 0.4165618
	speed: 0.0050s/iter; left time: 13.8202s
	iters: 500, epoch: 3 | loss: 0.3045144
	speed: 0.0035s/iter; left time: 9.2360s
Updating learning rate to 0.00031309008095
Epoch: 3 cost time: 2.2640655040740967
Epoch: 3, Steps: 523 | Train Loss: 0.3777058 Vali Loss: 0.2911850 Best vali loss: 0.2871634

best validation loss 0.28716338270434927

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5879520
	speed: 0.0286s/iter; left time: 15.8855s
Updating learning rate to 0.000140070516075
Epoch: 4 cost time: 3.0807478427886963
Epoch: 4, Steps: 131 | Train Loss: 0.5879520 Vali Loss: 0.2868054 Best vali loss: 0.2848908
	iters: 100, epoch: 5 | loss: 0.5655777
	speed: 0.0342s/iter; left time: 14.5367s
Updating learning rate to 7.00352580375e-05
Epoch: 5 cost time: 2.198270559310913
Epoch: 5, Steps: 131 | Train Loss: 0.5655777 Vali Loss: 0.2869661 Best vali loss: 0.2848908
	iters: 100, epoch: 6 | loss: 0.5496529
	speed: 0.0276s/iter; left time: 8.1078s
Updating learning rate to 3.501762901875e-05
Epoch: 6 cost time: 2.267580032348633
Epoch: 6, Steps: 131 | Train Loss: 0.5496529 Vali Loss: 0.2866755 Best vali loss: 0.2848908
	iters: 100, epoch: 7 | loss: 0.4365533
	speed: 0.0291s/iter; left time: 4.7447s
Updating learning rate to 1.7508814509375e-05
Epoch: 7 cost time: 1.5743918418884277
Epoch: 7, Steps: 131 | Train Loss: 0.4365533 Vali Loss: 0.2873289 Best vali loss: 0.2848908
	iters: 100, epoch: 8 | loss: 0.4425633
	speed: 0.0237s/iter; left time: 0.7589s
Updating learning rate to 8.7544072546875e-06
Epoch: 8 cost time: 2.1847176551818848
Epoch: 8, Steps: 131 | Train Loss: 0.4425633 Vali Loss: 0.2868880 Best vali loss: 0.2848908

best validation loss 0.2848908392280928

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0054864235978, 'e_layers': 2, 'learning_rate': 0.0004151106276, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.1164917
	speed: 0.0136s/iter; left time: 112.3424s
	iters: 200, epoch: 1 | loss: 0.4378722
	speed: 0.0071s/iter; left time: 57.7088s
	iters: 300, epoch: 1 | loss: 0.3806042
	speed: 0.0057s/iter; left time: 45.5885s
	iters: 400, epoch: 1 | loss: 1.5030754
	speed: 0.0077s/iter; left time: 61.5219s
	iters: 500, epoch: 1 | loss: 0.3214244
	speed: 0.0075s/iter; left time: 58.9500s
	iters: 600, epoch: 1 | loss: 0.3152193
	speed: 0.0072s/iter; left time: 56.1484s
	iters: 700, epoch: 1 | loss: 0.1606923
	speed: 0.0072s/iter; left time: 54.9582s
	iters: 800, epoch: 1 | loss: 0.4094861
	speed: 0.0073s/iter; left time: 55.1415s
	iters: 900, epoch: 1 | loss: 0.3197676
	speed: 0.0077s/iter; left time: 57.5050s
	iters: 1000, epoch: 1 | loss: 0.5782301
	speed: 0.0073s/iter; left time: 54.0183s
Updating learning rate to 0.0004151106276
Validation loss decreased (inf --> 0.3071).  Saving model state dict ...
Epoch: 1 cost time: 7.785308599472046
Epoch: 1, Steps: 1045 | Train Loss: 0.4542863 Vali Loss: 0.3070690 Best vali loss: 0.3070690
	iters: 100, epoch: 2 | loss: 0.5159362
	speed: 0.0244s/iter; left time: 176.1678s
	iters: 200, epoch: 2 | loss: 0.3689380
	speed: 0.0076s/iter; left time: 54.2183s
	iters: 300, epoch: 2 | loss: 0.1977277
	speed: 0.0074s/iter; left time: 52.2337s
	iters: 400, epoch: 2 | loss: 0.4019873
	speed: 0.0056s/iter; left time: 38.8994s
	iters: 500, epoch: 2 | loss: 0.2710948
	speed: 0.0069s/iter; left time: 46.9854s
	iters: 600, epoch: 2 | loss: 1.1107684
	speed: 0.0079s/iter; left time: 52.8302s
	iters: 700, epoch: 2 | loss: 0.7365414
	speed: 0.0070s/iter; left time: 46.3914s
	iters: 800, epoch: 2 | loss: 0.3580300
	speed: 0.0059s/iter; left time: 38.1584s
	iters: 900, epoch: 2 | loss: 0.4004391
	speed: 0.0051s/iter; left time: 32.6316s
	iters: 1000, epoch: 2 | loss: 0.2234835
	speed: 0.0062s/iter; left time: 39.2631s
Updating learning rate to 0.0002075553138
Validation loss decreased (0.3071 --> 0.2883).  Saving model state dict ...
Epoch: 2 cost time: 7.076958656311035
Epoch: 2, Steps: 1045 | Train Loss: 0.4584946 Vali Loss: 0.2883302 Best vali loss: 0.2883302
	iters: 100, epoch: 3 | loss: 0.4255584
	speed: 0.0265s/iter; left time: 163.5539s
	iters: 200, epoch: 3 | loss: 0.1975017
	speed: 0.0076s/iter; left time: 46.1033s
	iters: 300, epoch: 3 | loss: 0.2436077
	speed: 0.0068s/iter; left time: 40.6051s
	iters: 400, epoch: 3 | loss: 0.9135308
	speed: 0.0071s/iter; left time: 41.7007s
	iters: 500, epoch: 3 | loss: 1.0060821
	speed: 0.0051s/iter; left time: 29.6140s
	iters: 600, epoch: 3 | loss: 0.2290005
	speed: 0.0069s/iter; left time: 39.0770s
	iters: 700, epoch: 3 | loss: 0.3522190
	speed: 0.0092s/iter; left time: 51.0835s
	iters: 800, epoch: 3 | loss: 0.1888125
	speed: 0.0070s/iter; left time: 38.5446s
	iters: 900, epoch: 3 | loss: 0.3526000
	speed: 0.0075s/iter; left time: 40.0997s
	iters: 1000, epoch: 3 | loss: 0.3258595
	speed: 0.0078s/iter; left time: 41.0233s
Updating learning rate to 0.0001037776569
Epoch: 3 cost time: 7.634986162185669
Epoch: 3, Steps: 1045 | Train Loss: 0.4234772 Vali Loss: 0.2927595 Best vali loss: 0.2883302
	iters: 100, epoch: 4 | loss: 0.9190323
	speed: 0.0232s/iter; left time: 119.0119s
	iters: 200, epoch: 4 | loss: 0.1453480
	speed: 0.0078s/iter; left time: 39.1479s
	iters: 300, epoch: 4 | loss: 0.4999866
	speed: 0.0077s/iter; left time: 37.9701s
	iters: 400, epoch: 4 | loss: 0.2728360
	speed: 0.0076s/iter; left time: 36.5827s
	iters: 500, epoch: 4 | loss: 0.5563688
	speed: 0.0073s/iter; left time: 34.5234s
	iters: 600, epoch: 4 | loss: 0.2877133
	speed: 0.0080s/iter; left time: 36.8540s
	iters: 700, epoch: 4 | loss: 0.4004032
	speed: 0.0076s/iter; left time: 34.4524s
	iters: 800, epoch: 4 | loss: 0.3969453
	speed: 0.0067s/iter; left time: 29.7657s
	iters: 900, epoch: 4 | loss: 0.2578673
	speed: 0.0050s/iter; left time: 21.7816s
	iters: 1000, epoch: 4 | loss: 0.3428364
	speed: 0.0075s/iter; left time: 31.7686s
Updating learning rate to 5.188882845e-05
Epoch: 4 cost time: 7.581433057785034
Epoch: 4, Steps: 1045 | Train Loss: 0.4079337 Vali Loss: 0.2997981 Best vali loss: 0.2883302
	iters: 100, epoch: 5 | loss: 0.2384496
	speed: 0.0274s/iter; left time: 111.6843s
	iters: 200, epoch: 5 | loss: 0.3403952
	speed: 0.0078s/iter; left time: 31.0892s
	iters: 300, epoch: 5 | loss: 0.3750699
	speed: 0.0075s/iter; left time: 29.2984s
	iters: 400, epoch: 5 | loss: 0.2698890
	speed: 0.0063s/iter; left time: 23.8766s
	iters: 500, epoch: 5 | loss: 0.2248288
	speed: 0.0060s/iter; left time: 22.0943s
	iters: 600, epoch: 5 | loss: 0.1541166
	speed: 0.0043s/iter; left time: 15.5204s
	iters: 700, epoch: 5 | loss: 0.4825428
	speed: 0.0065s/iter; left time: 22.7464s
	iters: 800, epoch: 5 | loss: 0.2128527
	speed: 0.0074s/iter; left time: 25.0367s
	iters: 900, epoch: 5 | loss: 0.2037361
	speed: 0.0055s/iter; left time: 18.0155s
	iters: 1000, epoch: 5 | loss: 0.2907946
	speed: 0.0046s/iter; left time: 14.7812s
Updating learning rate to 2.5944414225e-05
Epoch: 5 cost time: 6.594468593597412
Epoch: 5, Steps: 1045 | Train Loss: 0.2792675 Vali Loss: 0.3095905 Best vali loss: 0.2883302
	iters: 100, epoch: 6 | loss: 0.3183430
	speed: 0.0234s/iter; left time: 71.1742s
	iters: 200, epoch: 6 | loss: 0.1335594
	speed: 0.0070s/iter; left time: 20.6405s
	iters: 300, epoch: 6 | loss: 0.2605435
	speed: 0.0081s/iter; left time: 22.9533s
	iters: 400, epoch: 6 | loss: 0.1805258
	speed: 0.0075s/iter; left time: 20.5698s
	iters: 500, epoch: 6 | loss: 0.1943340
	speed: 0.0072s/iter; left time: 18.9471s
	iters: 600, epoch: 6 | loss: 0.4598443
	speed: 0.0054s/iter; left time: 13.7383s
	iters: 700, epoch: 6 | loss: 0.2130012
	speed: 0.0064s/iter; left time: 15.5758s
	iters: 800, epoch: 6 | loss: 0.5382491
	speed: 0.0078s/iter; left time: 18.3090s
	iters: 900, epoch: 6 | loss: 0.1351024
	speed: 0.0080s/iter; left time: 17.8007s
	iters: 1000, epoch: 6 | loss: 0.3581587
	speed: 0.0061s/iter; left time: 13.0530s
Updating learning rate to 1.29722071125e-05
Epoch: 6 cost time: 7.482724905014038
Epoch: 6, Steps: 1045 | Train Loss: 0.2791661 Vali Loss: 0.3068701 Best vali loss: 0.2883302
	iters: 100, epoch: 7 | loss: 0.5391535
	speed: 0.0240s/iter; left time: 47.8765s
	iters: 200, epoch: 7 | loss: 0.1817361
	speed: 0.0068s/iter; left time: 12.9089s
	iters: 300, epoch: 7 | loss: 0.3653724
	speed: 0.0082s/iter; left time: 14.7185s
	iters: 400, epoch: 7 | loss: 0.1781102
	speed: 0.0071s/iter; left time: 11.9737s
	iters: 500, epoch: 7 | loss: 0.2340091
	speed: 0.0073s/iter; left time: 11.5764s
	iters: 600, epoch: 7 | loss: 0.1980322
	speed: 0.0070s/iter; left time: 10.3952s
	iters: 700, epoch: 7 | loss: 0.1680070
	speed: 0.0062s/iter; left time: 8.5959s
	iters: 800, epoch: 7 | loss: 0.1662575
	speed: 0.0076s/iter; left time: 9.8015s
	iters: 900, epoch: 7 | loss: 0.4953121
	speed: 0.0076s/iter; left time: 9.0424s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0110950398132, 'e_layers': 2, 'learning_rate': 6.89350093e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4000573
	speed: 0.0138s/iter; left time: 114.3925s
	iters: 200, epoch: 1 | loss: 0.4597061
	speed: 0.0069s/iter; left time: 56.1568s
	iters: 300, epoch: 1 | loss: 0.9791290
	speed: 0.0078s/iter; left time: 63.1010s
	iters: 400, epoch: 1 | loss: 0.7365360
	speed: 0.0065s/iter; left time: 51.4714s
	iters: 500, epoch: 1 | loss: 0.4512241
	speed: 0.0069s/iter; left time: 54.0635s
	iters: 600, epoch: 1 | loss: 0.5997143
	speed: 0.0074s/iter; left time: 57.5292s
	iters: 700, epoch: 1 | loss: 0.2452656
	speed: 0.0060s/iter; left time: 45.9812s
	iters: 800, epoch: 1 | loss: 1.1996512
	speed: 0.0062s/iter; left time: 46.9560s
	iters: 900, epoch: 1 | loss: 0.3412297
	speed: 0.0065s/iter; left time: 48.5599s
	iters: 1000, epoch: 1 | loss: 0.9584038
	speed: 0.0061s/iter; left time: 44.5628s
Updating learning rate to 6.89350093e-05
Validation loss decreased (inf --> 0.3087).  Saving model state dict ...
Epoch: 1 cost time: 7.460322380065918
Epoch: 1, Steps: 1045 | Train Loss: 0.6370917 Vali Loss: 0.3086601 Best vali loss: 0.3086601
	iters: 100, epoch: 2 | loss: 0.4292940
	speed: 0.0235s/iter; left time: 169.4681s
	iters: 200, epoch: 2 | loss: 0.1908421
	speed: 0.0058s/iter; left time: 41.2914s
	iters: 300, epoch: 2 | loss: 0.3238473
	speed: 0.0062s/iter; left time: 43.7134s
	iters: 400, epoch: 2 | loss: 0.2760883
	speed: 0.0069s/iter; left time: 47.8937s
	iters: 500, epoch: 2 | loss: 0.2650540
	speed: 0.0056s/iter; left time: 37.9334s
	iters: 600, epoch: 2 | loss: 1.2604079
	speed: 0.0068s/iter; left time: 45.4922s
	iters: 700, epoch: 2 | loss: 0.2011404
	speed: 0.0069s/iter; left time: 45.9665s
	iters: 800, epoch: 2 | loss: 0.3311498
	speed: 0.0082s/iter; left time: 53.5000s
	iters: 900, epoch: 2 | loss: 0.5369173
	speed: 0.0070s/iter; left time: 45.1841s
	iters: 1000, epoch: 2 | loss: 0.7097751
	speed: 0.0076s/iter; left time: 47.8765s
Updating learning rate to 3.446750465e-05
Validation loss decreased (0.3087 --> 0.2937).  Saving model state dict ...
Epoch: 2 cost time: 7.102467775344849
Epoch: 2, Steps: 1045 | Train Loss: 0.4524516 Vali Loss: 0.2936804 Best vali loss: 0.2936804
	iters: 100, epoch: 3 | loss: 0.2506080
	speed: 0.0232s/iter; left time: 143.0311s
	iters: 200, epoch: 3 | loss: 0.5217054
	speed: 0.0062s/iter; left time: 37.8426s
	iters: 300, epoch: 3 | loss: 0.2779129
	speed: 0.0068s/iter; left time: 40.8947s
	iters: 400, epoch: 3 | loss: 1.5993274
	speed: 0.0068s/iter; left time: 39.7064s
	iters: 500, epoch: 3 | loss: 0.2650789
	speed: 0.0063s/iter; left time: 36.0736s
	iters: 600, epoch: 3 | loss: 0.7201763
	speed: 0.0061s/iter; left time: 34.4326s
	iters: 700, epoch: 3 | loss: 0.7311936
	speed: 0.0052s/iter; left time: 29.2165s
	iters: 800, epoch: 3 | loss: 1.9745934
	speed: 0.0055s/iter; left time: 30.2602s
	iters: 900, epoch: 3 | loss: 1.3054966
	speed: 0.0059s/iter; left time: 31.7656s
	iters: 1000, epoch: 3 | loss: 1.4525946
	speed: 0.0055s/iter; left time: 29.0623s
Updating learning rate to 1.7233752325e-05
Validation loss decreased (0.2937 --> 0.2889).  Saving model state dict ...
Epoch: 3 cost time: 6.515212774276733
Epoch: 3, Steps: 1045 | Train Loss: 0.9098687 Vali Loss: 0.2889015 Best vali loss: 0.2889015
	iters: 100, epoch: 4 | loss: 0.2288366
	speed: 0.0287s/iter; left time: 146.9073s
	iters: 200, epoch: 4 | loss: 1.5993965
	speed: 0.0084s/iter; left time: 42.0217s
	iters: 300, epoch: 4 | loss: 0.3845463
	speed: 0.0081s/iter; left time: 40.0921s
	iters: 400, epoch: 4 | loss: 0.3051461
	speed: 0.0075s/iter; left time: 36.2355s
	iters: 500, epoch: 4 | loss: 0.1653042
	speed: 0.0063s/iter; left time: 29.7920s
	iters: 600, epoch: 4 | loss: 0.6959655
	speed: 0.0081s/iter; left time: 37.4751s
	iters: 700, epoch: 4 | loss: 0.4052864
	speed: 0.0084s/iter; left time: 37.9677s
	iters: 800, epoch: 4 | loss: 0.6077611
	speed: 0.0088s/iter; left time: 38.9102s
	iters: 900, epoch: 4 | loss: 1.0622376
	speed: 0.0080s/iter; left time: 34.6749s
	iters: 1000, epoch: 4 | loss: 0.2868679
	speed: 0.0083s/iter; left time: 35.2832s
Updating learning rate to 8.6168761625e-06
Validation loss decreased (0.2889 --> 0.2872).  Saving model state dict ...
Epoch: 4 cost time: 8.365856170654297
Epoch: 4, Steps: 1045 | Train Loss: 0.5741348 Vali Loss: 0.2871927 Best vali loss: 0.2871927
	iters: 100, epoch: 5 | loss: 0.3475535
	speed: 0.0258s/iter; left time: 105.3138s
	iters: 200, epoch: 5 | loss: 1.2884070
	speed: 0.0086s/iter; left time: 34.0516s
	iters: 300, epoch: 5 | loss: 0.3450675
	speed: 0.0083s/iter; left time: 32.2158s
	iters: 400, epoch: 5 | loss: 0.4017353
	speed: 0.0082s/iter; left time: 31.1424s
	iters: 500, epoch: 5 | loss: 0.3177705
	speed: 0.0078s/iter; left time: 28.8902s
	iters: 600, epoch: 5 | loss: 1.3389176
	speed: 0.0086s/iter; left time: 30.9705s
	iters: 700, epoch: 5 | loss: 0.3431409
	speed: 0.0083s/iter; left time: 28.8323s
	iters: 800, epoch: 5 | loss: 0.5026443
	speed: 0.0074s/iter; left time: 25.1066s
	iters: 900, epoch: 5 | loss: 0.8869382
	speed: 0.0080s/iter; left time: 26.1908s
	iters: 1000, epoch: 5 | loss: 0.2765039
	speed: 0.0078s/iter; left time: 24.6697s
Updating learning rate to 4.30843808125e-06
Validation loss decreased (0.2872 --> 0.2866).  Saving model state dict ...
Epoch: 5 cost time: 8.482237339019775
Epoch: 5, Steps: 1045 | Train Loss: 0.6048679 Vali Loss: 0.2866091 Best vali loss: 0.2866091
	iters: 100, epoch: 6 | loss: 0.3711479
	speed: 0.0256s/iter; left time: 77.7727s
	iters: 200, epoch: 6 | loss: 1.1401740
	speed: 0.0073s/iter; left time: 21.4512s
	iters: 300, epoch: 6 | loss: 0.2995615
	speed: 0.0079s/iter; left time: 22.4942s
	iters: 400, epoch: 6 | loss: 0.2547211
	speed: 0.0081s/iter; left time: 22.0724s
	iters: 500, epoch: 6 | loss: 1.1126478
	speed: 0.0077s/iter; left time: 20.2911s
	iters: 600, epoch: 6 | loss: 0.5783859
	speed: 0.0081s/iter; left time: 20.4359s
	iters: 700, epoch: 6 | loss: 2.0783594
	speed: 0.0083s/iter; left time: 20.3033s
	iters: 800, epoch: 6 | loss: 0.5943475
	speed: 0.0063s/iter; left time: 14.6913s
	iters: 900, epoch: 6 | loss: 0.2616599
	speed: 0.0080s/iter; left time: 17.8801s
	iters: 1000, epoch: 6 | loss: 1.0424521
	speed: 0.0081s/iter; left time: 17.3502s
Updating learning rate to 2.154219040625e-06
Validation loss decreased (0.2866 --> 0.2863).  Saving model state dict ...
Epoch: 6 cost time: 8.147879600524902
Epoch: 6, Steps: 1045 | Train Loss: 0.7733457 Vali Loss: 0.2863165 Best vali loss: 0.2863165
	iters: 100, epoch: 7 | loss: 1.7542998
	speed: 0.0297s/iter; left time: 59.2070s
	iters: 200, epoch: 7 | loss: 0.8290806
	speed: 0.0070s/iter; left time: 13.2034s
	iters: 300, epoch: 7 | loss: 1.2176566
	speed: 0.0061s/iter; left time: 10.8811s
	iters: 400, epoch: 7 | loss: 0.3033091
	speed: 0.0058s/iter; left time: 9.8803s
	iters: 500, epoch: 7 | loss: 0.2633410
	speed: 0.0062s/iter; left time: 9.8088s
	iters: 600, epoch: 7 | loss: 0.3410523
	speed: 0.0059s/iter; left time: 8.8473s
	iters: 700, epoch: 7 | loss: 0.4151676
	speed: 0.0056s/iter; left time: 7.7275s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.010989339883, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7009477
	speed: 0.0254s/iter; left time: 24.0847s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.3305).  Saving model state dict ...
Epoch: 1 cost time: 2.646723508834839
Epoch: 1, Steps: 131 | Train Loss: 0.7009477 Vali Loss: 0.3305046 Best vali loss: 0.3305046
	iters: 100, epoch: 2 | loss: 0.5261423
	speed: 0.0270s/iter; left time: 22.0565s
Updating learning rate to 0.0019699025932
Validation loss decreased (0.3305 --> 0.3220).  Saving model state dict ...
Epoch: 2 cost time: 2.664978265762329
Epoch: 2, Steps: 131 | Train Loss: 0.5261423 Vali Loss: 0.3219596 Best vali loss: 0.3219596
	iters: 100, epoch: 3 | loss: 0.4622701
	speed: 0.0388s/iter; left time: 26.6553s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 3.0796096324920654
Epoch: 3, Steps: 131 | Train Loss: 0.4622701 Vali Loss: 0.3254918 Best vali loss: 0.3219596

best validation loss 0.32195963225663043

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2862135
	speed: 0.0138s/iter; left time: 56.3381s
	iters: 200, epoch: 1 | loss: 0.4139252
	speed: 0.0085s/iter; left time: 33.7595s
	iters: 300, epoch: 1 | loss: 0.8694890
	speed: 0.0072s/iter; left time: 28.1210s
	iters: 400, epoch: 1 | loss: 0.2230014
	speed: 0.0075s/iter; left time: 28.2418s
	iters: 500, epoch: 1 | loss: 0.2949321
	speed: 0.0067s/iter; left time: 24.8692s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.2887).  Saving model state dict ...
Epoch: 1 cost time: 4.233283758163452
Epoch: 1, Steps: 523 | Train Loss: 0.4175122 Vali Loss: 0.2886727 Best vali loss: 0.2886727
	iters: 100, epoch: 2 | loss: 0.5136673
	speed: 0.0178s/iter; left time: 63.4520s
	iters: 200, epoch: 2 | loss: 0.2142774
	speed: 0.0079s/iter; left time: 27.4279s
	iters: 300, epoch: 2 | loss: 0.4590653
	speed: 0.0074s/iter; left time: 24.9264s
	iters: 400, epoch: 2 | loss: 0.7363945
	speed: 0.0070s/iter; left time: 22.8437s
	iters: 500, epoch: 2 | loss: 0.3147019
	speed: 0.0058s/iter; left time: 18.3639s
Updating learning rate to 0.000552421030539641
Epoch: 2 cost time: 3.8613924980163574
Epoch: 2, Steps: 523 | Train Loss: 0.4476213 Vali Loss: 0.2940342 Best vali loss: 0.2886727
	iters: 100, epoch: 3 | loss: 0.5572708
	speed: 0.0156s/iter; left time: 47.3537s
	iters: 200, epoch: 3 | loss: 0.6806183
	speed: 0.0071s/iter; left time: 20.8207s
	iters: 300, epoch: 3 | loss: 0.1883643
	speed: 0.0072s/iter; left time: 20.5827s
	iters: 400, epoch: 3 | loss: 0.4686127
	speed: 0.0069s/iter; left time: 18.8855s
	iters: 500, epoch: 3 | loss: 0.4772726
	speed: 0.0069s/iter; left time: 18.1316s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.2887 --> 0.2855).  Saving model state dict ...
Epoch: 3 cost time: 3.8284077644348145
Epoch: 3, Steps: 523 | Train Loss: 0.4744277 Vali Loss: 0.2855204 Best vali loss: 0.2855204

best validation loss 0.2855203826660647

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2272484
	speed: 0.0102s/iter; left time: 41.5011s
	iters: 200, epoch: 1 | loss: 0.3259809
	speed: 0.0055s/iter; left time: 21.9537s
	iters: 300, epoch: 1 | loss: 0.2671387
	speed: 0.0058s/iter; left time: 22.4028s
	iters: 400, epoch: 1 | loss: 0.6833622
	speed: 0.0057s/iter; left time: 21.5915s
	iters: 500, epoch: 1 | loss: 0.2622539
	speed: 0.0057s/iter; left time: 21.0360s
Updating learning rate to 0.0005012943918
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 3.1243982315063477
Epoch: 1, Steps: 523 | Train Loss: 0.3531969 Vali Loss: 0.2839282 Best vali loss: 0.2839282
	iters: 100, epoch: 2 | loss: 0.2452308
	speed: 0.0159s/iter; left time: 56.7738s
	iters: 200, epoch: 2 | loss: 0.7240334
	speed: 0.0047s/iter; left time: 16.3944s
	iters: 300, epoch: 2 | loss: 1.0427364
	speed: 0.0051s/iter; left time: 17.2514s
	iters: 400, epoch: 2 | loss: 0.6430516
	speed: 0.0050s/iter; left time: 16.2849s
	iters: 500, epoch: 2 | loss: 0.3747051
	speed: 0.0055s/iter; left time: 17.4260s
Updating learning rate to 0.0002506471959
Validation loss decreased (0.2839 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 2.771484613418579
Epoch: 2, Steps: 523 | Train Loss: 0.6059514 Vali Loss: 0.2833778 Best vali loss: 0.2833778
	iters: 100, epoch: 3 | loss: 0.2104755
	speed: 0.0133s/iter; left time: 40.4462s
	iters: 200, epoch: 3 | loss: 0.3104784
	speed: 0.0060s/iter; left time: 17.5210s
	iters: 300, epoch: 3 | loss: 0.9712694
	speed: 0.0059s/iter; left time: 16.8407s
	iters: 400, epoch: 3 | loss: 0.4357942
	speed: 0.0061s/iter; left time: 16.5752s
	iters: 500, epoch: 3 | loss: 0.3783531
	speed: 0.0061s/iter; left time: 16.0794s
Updating learning rate to 0.00012532359795
Epoch: 3 cost time: 3.0738906860351562
Epoch: 3, Steps: 523 | Train Loss: 0.4612741 Vali Loss: 0.2887341 Best vali loss: 0.2833778

best validation loss 0.2833777742343305

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2119393
	speed: 0.0133s/iter; left time: 33.4324s
	iters: 200, epoch: 4 | loss: 0.2920736
	speed: 0.0052s/iter; left time: 12.4735s
	iters: 300, epoch: 4 | loss: 0.2310767
	speed: 0.0051s/iter; left time: 11.7748s
	iters: 400, epoch: 4 | loss: 0.6299760
	speed: 0.0039s/iter; left time: 8.7074s
	iters: 500, epoch: 4 | loss: 0.2496942
	speed: 0.0050s/iter; left time: 10.6083s
Updating learning rate to 6.2661798975e-05
Epoch: 4 cost time: 2.9994165897369385
Epoch: 4, Steps: 523 | Train Loss: 0.3229520 Vali Loss: 0.2882135 Best vali loss: 0.2833778
	iters: 100, epoch: 5 | loss: 0.2483299
	speed: 0.0160s/iter; left time: 31.8492s
	iters: 200, epoch: 5 | loss: 0.6989415
	speed: 0.0060s/iter; left time: 11.3851s
	iters: 300, epoch: 5 | loss: 0.9709345
	speed: 0.0060s/iter; left time: 10.6712s
	iters: 400, epoch: 5 | loss: 0.6289324
	speed: 0.0058s/iter; left time: 9.8422s
	iters: 500, epoch: 5 | loss: 0.3648706
	speed: 0.0059s/iter; left time: 9.4781s
Updating learning rate to 3.13308994875e-05
Epoch: 5 cost time: 3.1530110836029053
Epoch: 5, Steps: 523 | Train Loss: 0.5824018 Vali Loss: 0.2885375 Best vali loss: 0.2833778
	iters: 100, epoch: 6 | loss: 0.1967446
	speed: 0.0169s/iter; left time: 24.7913s
	iters: 200, epoch: 6 | loss: 0.2987567
	speed: 0.0058s/iter; left time: 7.9916s
	iters: 300, epoch: 6 | loss: 0.9548816
	speed: 0.0040s/iter; left time: 5.1227s
	iters: 400, epoch: 6 | loss: 0.4195926
	speed: 0.0041s/iter; left time: 4.8242s
	iters: 500, epoch: 6 | loss: 0.3750362
	speed: 0.0045s/iter; left time: 4.7919s
Updating learning rate to 1.566544974375e-05
Epoch: 6 cost time: 2.6735305786132812
Epoch: 6, Steps: 523 | Train Loss: 0.4490023 Vali Loss: 0.2896017 Best vali loss: 0.2833778
	iters: 100, epoch: 7 | loss: 0.2861147
	speed: 0.0164s/iter; left time: 15.5524s
	iters: 200, epoch: 7 | loss: 0.2876509
	speed: 0.0061s/iter; left time: 5.1335s
	iters: 300, epoch: 7 | loss: 0.1894441
	speed: 0.0060s/iter; left time: 4.5140s
	iters: 400, epoch: 7 | loss: 0.3940210
	speed: 0.0060s/iter; left time: 3.8652s
	iters: 500, epoch: 7 | loss: 1.0532310
	speed: 0.0059s/iter; left time: 3.2168s
Updating learning rate to 7.832724871875e-06
Epoch: 7 cost time: 3.2018964290618896
Epoch: 7, Steps: 523 | Train Loss: 0.4420923 Vali Loss: 0.2899095 Best vali loss: 0.2833778
	iters: 100, epoch: 8 | loss: 0.2544626
	speed: 0.0161s/iter; left time: 6.8328s
	iters: 200, epoch: 8 | loss: 0.4372096
	speed: 0.0053s/iter; left time: 1.7283s
	iters: 300, epoch: 8 | loss: 0.7029629
	speed: 0.0047s/iter; left time: 1.0496s
	iters: 400, epoch: 8 | loss: 1.4191923
	speed: 0.0044s/iter; left time: 0.5456s
	iters: 500, epoch: 8 | loss: 0.4206043
	speed: 0.0052s/iter; left time: 0.1240s
Updating learning rate to 3.9163624359375e-06
Epoch: 8 cost time: 2.7173848152160645
Epoch: 8, Steps: 523 | Train Loss: 0.6468863 Vali Loss: 0.2897693 Best vali loss: 0.2833778

best validation loss 0.2833777742343305

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 3, 'learning_rate': 5.08199726e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3264091
	speed: 0.0169s/iter; left time: 139.3807s
	iters: 200, epoch: 1 | loss: 0.4821685
	speed: 0.0107s/iter; left time: 87.5208s
	iters: 300, epoch: 1 | loss: 0.3277070
	speed: 0.0105s/iter; left time: 84.6795s
	iters: 400, epoch: 1 | loss: 1.2024814
	speed: 0.0095s/iter; left time: 75.6780s
	iters: 500, epoch: 1 | loss: 0.7334218
	speed: 0.0090s/iter; left time: 70.8084s
	iters: 600, epoch: 1 | loss: 0.3456078
	speed: 0.0104s/iter; left time: 80.6673s
	iters: 700, epoch: 1 | loss: 0.3982716
	speed: 0.0091s/iter; left time: 69.5571s
	iters: 800, epoch: 1 | loss: 0.4132996
	speed: 0.0093s/iter; left time: 70.1847s
	iters: 900, epoch: 1 | loss: 0.6786286
	speed: 0.0101s/iter; left time: 75.2452s
	iters: 1000, epoch: 1 | loss: 0.3404434
	speed: 0.0101s/iter; left time: 74.3973s
Updating learning rate to 4.88857525639622e-05
Validation loss decreased (inf --> 0.2966).  Saving model state dict ...
Epoch: 1 cost time: 10.722893953323364
Epoch: 1, Steps: 1045 | Train Loss: 0.5248439 Vali Loss: 0.2966453 Best vali loss: 0.2966453
	iters: 100, epoch: 2 | loss: 2.4092460
	speed: 0.0325s/iter; left time: 234.4239s
	iters: 200, epoch: 2 | loss: 0.2233124
	speed: 0.0102s/iter; left time: 72.7182s
	iters: 300, epoch: 2 | loss: 0.2789056
	speed: 0.0095s/iter; left time: 66.3210s
	iters: 400, epoch: 2 | loss: 0.5216180
	speed: 0.0087s/iter; left time: 60.4009s
	iters: 500, epoch: 2 | loss: 0.2773480
	speed: 0.0082s/iter; left time: 55.7244s
	iters: 600, epoch: 2 | loss: 0.2984760
	speed: 0.0154s/iter; left time: 103.6564s
	iters: 700, epoch: 2 | loss: 0.3772697
	speed: 0.0137s/iter; left time: 90.4896s
	iters: 800, epoch: 2 | loss: 0.2224875
	speed: 0.0101s/iter; left time: 65.6692s
	iters: 900, epoch: 2 | loss: 0.2900697
	speed: 0.0172s/iter; left time: 110.3415s
	iters: 1000, epoch: 2 | loss: 0.3541337
	speed: 0.0143s/iter; left time: 90.2809s
Updating learning rate to 4.337755992258727e-05
Validation loss decreased (0.2966 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 12.410463094711304
Epoch: 2, Steps: 1045 | Train Loss: 0.5252867 Vali Loss: 0.2849530 Best vali loss: 0.2849530
	iters: 100, epoch: 3 | loss: 0.4704484
	speed: 0.0347s/iter; left time: 214.2698s
	iters: 200, epoch: 3 | loss: 0.2047178
	speed: 0.0101s/iter; left time: 61.1375s
	iters: 300, epoch: 3 | loss: 0.1800575
	speed: 0.0072s/iter; left time: 42.9945s
	iters: 400, epoch: 3 | loss: 0.3452436
	speed: 0.0082s/iter; left time: 48.3026s
	iters: 500, epoch: 3 | loss: 0.2044324
	speed: 0.0086s/iter; left time: 49.6193s
	iters: 600, epoch: 3 | loss: 0.2018744
	speed: 0.0087s/iter; left time: 49.3207s
	iters: 700, epoch: 3 | loss: 0.4969274
	speed: 0.0086s/iter; left time: 48.1719s
	iters: 800, epoch: 3 | loss: 0.8701029
	speed: 0.0087s/iter; left time: 47.6742s
	iters: 900, epoch: 3 | loss: 0.3110598
	speed: 0.0086s/iter; left time: 46.4322s
	iters: 1000, epoch: 3 | loss: 0.2595389
	speed: 0.0085s/iter; left time: 44.8848s
Updating learning rate to 3.5133967073633905e-05
Validation loss decreased (0.2850 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 8.902294874191284
Epoch: 3, Steps: 1045 | Train Loss: 0.3544403 Vali Loss: 0.2839179 Best vali loss: 0.2839179
	iters: 100, epoch: 4 | loss: 0.5281827
	speed: 0.0247s/iter; left time: 126.4904s
	iters: 200, epoch: 4 | loss: 0.2173588
	speed: 0.0084s/iter; left time: 42.2144s
	iters: 300, epoch: 4 | loss: 1.4134961
	speed: 0.0083s/iter; left time: 41.1199s
	iters: 400, epoch: 4 | loss: 0.1847998
	speed: 0.0088s/iter; left time: 42.3119s
	iters: 500, epoch: 4 | loss: 0.5988569
	speed: 0.0084s/iter; left time: 39.4767s
	iters: 600, epoch: 4 | loss: 1.3580952
	speed: 0.0074s/iter; left time: 34.3942s
	iters: 700, epoch: 4 | loss: 1.3011650
	speed: 0.0085s/iter; left time: 38.3602s
	iters: 800, epoch: 4 | loss: 0.9816846
	speed: 0.0087s/iter; left time: 38.6345s
	iters: 900, epoch: 4 | loss: 1.1673511
	speed: 0.0087s/iter; left time: 37.8344s
	iters: 1000, epoch: 4 | loss: 0.2733188
	speed: 0.0086s/iter; left time: 36.3126s
Updating learning rate to 2.54099863e-05
Validation loss decreased (0.2839 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 8.891729831695557
Epoch: 4, Steps: 1045 | Train Loss: 0.8024309 Vali Loss: 0.2818471 Best vali loss: 0.2818471
	iters: 100, epoch: 5 | loss: 0.1746556
	speed: 0.0296s/iter; left time: 120.7499s
	iters: 200, epoch: 5 | loss: 0.3455309
	speed: 0.0082s/iter; left time: 32.7650s
	iters: 300, epoch: 5 | loss: 0.2130539
	speed: 0.0079s/iter; left time: 30.7784s
	iters: 400, epoch: 5 | loss: 0.4450661
	speed: 0.0067s/iter; left time: 25.4476s
	iters: 500, epoch: 5 | loss: 0.3000332
	speed: 0.0099s/iter; left time: 36.3114s
	iters: 600, epoch: 5 | loss: 0.4740867
	speed: 0.0098s/iter; left time: 34.9236s
	iters: 700, epoch: 5 | loss: 0.4055993
	speed: 0.0104s/iter; left time: 36.1198s
	iters: 800, epoch: 5 | loss: 0.1900791
	speed: 0.0089s/iter; left time: 30.0559s
	iters: 900, epoch: 5 | loss: 0.2373120
	speed: 0.0101s/iter; left time: 33.0430s
	iters: 1000, epoch: 5 | loss: 0.3624706
	speed: 0.0066s/iter; left time: 20.8450s
Updating learning rate to 1.5686005526366093e-05
Validation loss decreased (0.2818 --> 0.2814).  Saving model state dict ...
Epoch: 5 cost time: 9.052267789840698
Epoch: 5, Steps: 1045 | Train Loss: 0.3147887 Vali Loss: 0.2813613 Best vali loss: 0.2813613
	iters: 100, epoch: 6 | loss: 1.0448496
	speed: 0.0243s/iter; left time: 73.7660s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0089588480994, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2868923
	speed: 0.0157s/iter; left time: 129.8252s
	iters: 200, epoch: 1 | loss: 0.1756683
	speed: 0.0087s/iter; left time: 70.7312s
	iters: 300, epoch: 1 | loss: 0.5089236
	speed: 0.0093s/iter; left time: 75.0620s
	iters: 400, epoch: 1 | loss: 0.3946888
	speed: 0.0084s/iter; left time: 67.0765s
	iters: 500, epoch: 1 | loss: 0.9629364
	speed: 0.0084s/iter; left time: 66.2811s
	iters: 600, epoch: 1 | loss: 0.3291695
	speed: 0.0072s/iter; left time: 55.8046s
	iters: 700, epoch: 1 | loss: 0.3839320
	speed: 0.0071s/iter; left time: 54.2791s
	iters: 800, epoch: 1 | loss: 0.5336905
	speed: 0.0083s/iter; left time: 63.0771s
	iters: 900, epoch: 1 | loss: 0.3938181
	speed: 0.0087s/iter; left time: 65.1748s
	iters: 1000, epoch: 1 | loss: 0.2773806
	speed: 0.0075s/iter; left time: 55.0075s
Updating learning rate to 0.00044044934731141274
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 8.997188806533813
Epoch: 1, Steps: 1045 | Train Loss: 0.4247100 Vali Loss: 0.2832748 Best vali loss: 0.2832748
	iters: 100, epoch: 2 | loss: 0.3263526
	speed: 0.0314s/iter; left time: 226.2494s
	iters: 200, epoch: 2 | loss: 0.3116359
	speed: 0.0094s/iter; left time: 67.1737s
	iters: 300, epoch: 2 | loss: 0.1563466
	speed: 0.0064s/iter; left time: 45.1469s
	iters: 400, epoch: 2 | loss: 1.1342875
	speed: 0.0070s/iter; left time: 48.2334s
	iters: 500, epoch: 2 | loss: 0.2043629
	speed: 0.0082s/iter; left time: 55.8256s
	iters: 600, epoch: 2 | loss: 0.3633290
	speed: 0.0087s/iter; left time: 58.3811s
	iters: 700, epoch: 2 | loss: 0.3166423
	speed: 0.0074s/iter; left time: 48.8145s
	iters: 800, epoch: 2 | loss: 0.1458497
	speed: 0.0076s/iter; left time: 49.5847s
	iters: 900, epoch: 2 | loss: 0.1502339
	speed: 0.0098s/iter; left time: 62.7494s
	iters: 1000, epoch: 2 | loss: 0.3168062
	speed: 0.0096s/iter; left time: 60.9476s
Updating learning rate to 0.0003908218029551133
Epoch: 2 cost time: 8.816519021987915
Epoch: 2, Steps: 1045 | Train Loss: 0.3425847 Vali Loss: 0.2887109 Best vali loss: 0.2832748
	iters: 100, epoch: 3 | loss: 0.4348626
	speed: 0.0297s/iter; left time: 183.4296s
	iters: 200, epoch: 3 | loss: 0.2108227
	speed: 0.0097s/iter; left time: 59.0359s
	iters: 300, epoch: 3 | loss: 0.3580941
	speed: 0.0086s/iter; left time: 51.3207s
	iters: 400, epoch: 3 | loss: 0.3074656
	speed: 0.0071s/iter; left time: 41.4894s
	iters: 500, epoch: 3 | loss: 0.2812484
	speed: 0.0083s/iter; left time: 47.6624s
	iters: 600, epoch: 3 | loss: 0.1408813
	speed: 0.0082s/iter; left time: 46.5566s
	iters: 700, epoch: 3 | loss: 1.0947384
	speed: 0.0069s/iter; left time: 38.5438s
	iters: 800, epoch: 3 | loss: 0.3976372
	speed: 0.0084s/iter; left time: 45.8720s
	iters: 900, epoch: 3 | loss: 0.2439421
	speed: 0.0072s/iter; left time: 38.8281s
	iters: 1000, epoch: 3 | loss: 0.2775768
	speed: 0.0078s/iter; left time: 41.2301s
Updating learning rate to 0.00031654893408453833
Epoch: 3 cost time: 8.39608097076416
Epoch: 3, Steps: 1045 | Train Loss: 0.3747269 Vali Loss: 0.2883890 Best vali loss: 0.2832748
	iters: 100, epoch: 4 | loss: 0.5610599
	speed: 0.0239s/iter; left time: 122.3834s
	iters: 200, epoch: 4 | loss: 0.8454307
	speed: 0.0108s/iter; left time: 54.1791s
	iters: 300, epoch: 4 | loss: 0.7380445
	speed: 0.0085s/iter; left time: 41.9984s
	iters: 400, epoch: 4 | loss: 0.5083454
	speed: 0.0083s/iter; left time: 40.0997s
	iters: 500, epoch: 4 | loss: 0.4348500
	speed: 0.0081s/iter; left time: 38.0674s
	iters: 600, epoch: 4 | loss: 0.1393268
	speed: 0.0075s/iter; left time: 34.4749s
	iters: 700, epoch: 4 | loss: 0.4157915
	speed: 0.0095s/iter; left time: 43.1119s
	iters: 800, epoch: 4 | loss: 0.1960775
	speed: 0.0089s/iter; left time: 39.3618s
	iters: 900, epoch: 4 | loss: 0.2680610
	speed: 0.0097s/iter; left time: 42.1128s
	iters: 1000, epoch: 4 | loss: 0.5710363
	speed: 0.0073s/iter; left time: 30.9228s
Updating learning rate to 0.0002289381117
Epoch: 4 cost time: 9.018922090530396
Epoch: 4, Steps: 1045 | Train Loss: 0.4678024 Vali Loss: 0.2984697 Best vali loss: 0.2832748
	iters: 100, epoch: 5 | loss: 0.1617181
	speed: 0.0294s/iter; left time: 120.1007s
	iters: 200, epoch: 5 | loss: 0.8464981
	speed: 0.0090s/iter; left time: 35.8597s
	iters: 300, epoch: 5 | loss: 0.3043209
	speed: 0.0091s/iter; left time: 35.2762s
	iters: 400, epoch: 5 | loss: 0.3030150
	speed: 0.0079s/iter; left time: 29.8062s
	iters: 500, epoch: 5 | loss: 0.4363246
	speed: 0.0087s/iter; left time: 32.0498s
	iters: 600, epoch: 5 | loss: 0.5547154
	speed: 0.0099s/iter; left time: 35.5145s
	iters: 700, epoch: 5 | loss: 0.2383197
	speed: 0.0080s/iter; left time: 27.9306s
	iters: 800, epoch: 5 | loss: 0.2243114
	speed: 0.0084s/iter; left time: 28.3977s
	iters: 900, epoch: 5 | loss: 0.1739004
	speed: 0.0099s/iter; left time: 32.4800s
	iters: 1000, epoch: 5 | loss: 0.2164410
	speed: 0.0087s/iter; left time: 27.6716s
Updating learning rate to 0.0001413272893154617
Epoch: 5 cost time: 9.369235754013062
Epoch: 5, Steps: 1045 | Train Loss: 0.3459565 Vali Loss: 0.2951688 Best vali loss: 0.2832748
	iters: 100, epoch: 6 | loss: 0.5486749
	speed: 0.0256s/iter; left time: 77.5974s
	iters: 200, epoch: 6 | loss: 0.2858901
	speed: 0.0075s/iter; left time: 21.9519s
	iters: 300, epoch: 6 | loss: 0.4243065
	speed: 0.0065s/iter; left time: 18.4384s
	iters: 400, epoch: 6 | loss: 0.2188127
	speed: 0.0077s/iter; left time: 21.1852s
	iters: 500, epoch: 6 | loss: 0.2979765
	speed: 0.0085s/iter; left time: 22.4637s
	iters: 600, epoch: 6 | loss: 0.2348063
	speed: 0.0072s/iter; left time: 18.2142s
	iters: 700, epoch: 6 | loss: 0.3540194
	speed: 0.0095s/iter; left time: 23.1512s
	iters: 800, epoch: 6 | loss: 0.2480117
	speed: 0.0075s/iter; left time: 17.6073s
	iters: 900, epoch: 6 | loss: 0.7711367
	speed: 0.0074s/iter; left time: 16.5083s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022985164426, 'e_layers': 4, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.3131).  Saving model state dict ...
Epoch: 1 cost time: 2.3256797790527344
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3130886 Best vali loss: 0.3130886
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.3131 --> 0.2972).  Saving model state dict ...
Epoch: 2 cost time: 1.3420920372009277
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2972163 Best vali loss: 0.2972163
Updating learning rate to 8.93085473266162e-05
Validation loss decreased (0.2972 --> 0.2905).  Saving model state dict ...
Epoch: 3 cost time: 1.1539199352264404
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905200 Best vali loss: 0.2905200

best validation loss 0.290519971737147

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4896113
	speed: 0.0224s/iter; left time: 21.2585s
Updating learning rate to 0.00022635856963078432
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 2.4863102436065674
Epoch: 1, Steps: 131 | Train Loss: 0.4896113 Vali Loss: 0.2799706 Best vali loss: 0.2799706
	iters: 100, epoch: 2 | loss: 0.4957182
	speed: 0.0364s/iter; left time: 29.7920s
Updating learning rate to 0.0002008536619192565
Validation loss decreased (0.2800 --> 0.2758).  Saving model state dict ...
Epoch: 2 cost time: 2.9237565994262695
Epoch: 2, Steps: 131 | Train Loss: 0.4957182 Vali Loss: 0.2758062 Best vali loss: 0.2758062
	iters: 100, epoch: 3 | loss: 0.4318376
	speed: 0.0357s/iter; left time: 24.5191s
Updating learning rate to 0.00016268287006193248
Validation loss decreased (0.2758 --> 0.2750).  Saving model state dict ...
Epoch: 3 cost time: 2.5546131134033203
Epoch: 3, Steps: 131 | Train Loss: 0.4318376 Vali Loss: 0.2749960 Best vali loss: 0.2749960

best validation loss 0.2749960359674974

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010602146623, 'e_layers': 4, 'learning_rate': 0.000225512069, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8058677
	speed: 0.0192s/iter; left time: 38.3892s
	iters: 200, epoch: 1 | loss: 0.4476928
	speed: 0.0143s/iter; left time: 27.0967s
Updating learning rate to 0.000225512069
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 3.8035755157470703
Epoch: 1, Steps: 262 | Train Loss: 0.6267803 Vali Loss: 0.2835326 Best vali loss: 0.2835326
	iters: 100, epoch: 2 | loss: 0.3381070
	speed: 0.0315s/iter; left time: 54.6670s
	iters: 200, epoch: 2 | loss: 0.6086090
	speed: 0.0119s/iter; left time: 19.4142s
Updating learning rate to 0.0001127560345
Validation loss decreased (0.2835 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 3.0966298580169678
Epoch: 2, Steps: 262 | Train Loss: 0.4733580 Vali Loss: 0.2794386 Best vali loss: 0.2794386
	iters: 100, epoch: 3 | loss: 0.6099918
	speed: 0.0295s/iter; left time: 43.4722s
	iters: 200, epoch: 3 | loss: 0.6397390
	speed: 0.0138s/iter; left time: 18.9130s
Updating learning rate to 5.637801725e-05
Epoch: 3 cost time: 3.4574971199035645
Epoch: 3, Steps: 262 | Train Loss: 0.6248654 Vali Loss: 0.2817139 Best vali loss: 0.2794386

best validation loss 0.27943861639690293

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4021078
	speed: 0.0258s/iter; left time: 14.3213s
Updating learning rate to 0.0001176573511
Epoch: 4 cost time: 2.683415412902832
Epoch: 4, Steps: 131 | Train Loss: 0.4021078 Vali Loss: 0.2913485 Best vali loss: 0.2749960
	iters: 100, epoch: 5 | loss: 0.3229543
	speed: 0.0345s/iter; left time: 14.6809s
Updating learning rate to 7.263183213806753e-05
Epoch: 5 cost time: 2.90339732170105
Epoch: 5, Steps: 131 | Train Loss: 0.3229543 Vali Loss: 0.2952643 Best vali loss: 0.2749960
	iters: 100, epoch: 6 | loss: 0.3606459
	speed: 0.0320s/iter; left time: 9.3960s
Updating learning rate to 3.446104028074351e-05
Epoch: 6 cost time: 2.347639322280884
Epoch: 6, Steps: 131 | Train Loss: 0.3606459 Vali Loss: 0.3045064 Best vali loss: 0.2749960
	iters: 100, epoch: 7 | loss: 0.3277754
	speed: 0.0244s/iter; left time: 3.9763s
Updating learning rate to 8.956132569215671e-06
Epoch: 7 cost time: 2.0530266761779785
Epoch: 7, Steps: 131 | Train Loss: 0.3277754 Vali Loss: 0.3091476 Best vali loss: 0.2749960
	iters: 100, epoch: 8 | loss: 0.4145193
	speed: 0.0317s/iter; left time: 1.0157s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2226130962371826
Epoch: 8, Steps: 131 | Train Loss: 0.4145193 Vali Loss: 0.3098405 Best vali loss: 0.2749960

best validation loss 0.2749960359674974

[INFO][abstract_intensifier.py:595] Added config 4678dd and rejected config 47e958 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028252887435, 'e_layers': 1, 'learning_rate': 0.0029075166254, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027968558630216732
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 1.0804362297058105
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2876676 Best vali loss: 0.2876676
Updating learning rate to 0.0024817206738164837
Epoch: 2 cost time: 0.5175836086273193
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2972807 Best vali loss: 0.2876676
Updating learning rate to 0.002010087533633318
Epoch: 3 cost time: 1.1391053199768066
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3018529 Best vali loss: 0.2876676
Updating learning rate to 0.0014537583127
Epoch: 4 cost time: 1.2159180641174316
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2995709 Best vali loss: 0.2876676
Updating learning rate to 0.0008974290917666826
Epoch: 5 cost time: 1.6930937767028809
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2982234 Best vali loss: 0.2876676
Updating learning rate to 0.0004257959515835167
Epoch: 6 cost time: 1.079848051071167
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3253710 Best vali loss: 0.2876676
Updating learning rate to 0.000110660762378327
Epoch: 7 cost time: 1.3336501121520996
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3145081 Best vali loss: 0.2876676
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4860270023345947
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3227456 Best vali loss: 0.2876676

best validation loss 0.28766755575737396

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.004626800892, 'e_layers': 2, 'learning_rate': 0.0022058584169, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8312569
	speed: 0.0143s/iter; left time: 13.6064s
Updating learning rate to 0.0022058584169
Validation loss decreased (inf --> 0.2964).  Saving model state dict ...
Epoch: 1 cost time: 1.3772270679473877
Epoch: 1, Steps: 131 | Train Loss: 0.8312569 Vali Loss: 0.2964011 Best vali loss: 0.2964011
	iters: 100, epoch: 2 | loss: 0.5828384
	speed: 0.0128s/iter; left time: 10.4773s
Updating learning rate to 0.00110292920845
Epoch: 2 cost time: 1.0220766067504883
Epoch: 2, Steps: 131 | Train Loss: 0.5828384 Vali Loss: 0.2992290 Best vali loss: 0.2964011
	iters: 100, epoch: 3 | loss: 0.5932889
	speed: 0.0126s/iter; left time: 8.6509s
Updating learning rate to 0.000551464604225
Validation loss decreased (0.2964 --> 0.2935).  Saving model state dict ...
Epoch: 3 cost time: 0.9884474277496338
Epoch: 3, Steps: 131 | Train Loss: 0.5932889 Vali Loss: 0.2935302 Best vali loss: 0.2935302
	iters: 100, epoch: 4 | loss: 0.4060763
	speed: 0.0129s/iter; left time: 7.1981s
Updating learning rate to 0.0002757323021125
Validation loss decreased (0.2935 --> 0.2924).  Saving model state dict ...
Epoch: 4 cost time: 1.0647995471954346
Epoch: 4, Steps: 131 | Train Loss: 0.4060763 Vali Loss: 0.2923642 Best vali loss: 0.2923642
	iters: 100, epoch: 5 | loss: 0.4790852
	speed: 0.0262s/iter; left time: 11.1550s
Updating learning rate to 0.00013786615105625
Epoch: 5 cost time: 2.7815325260162354
Epoch: 5, Steps: 131 | Train Loss: 0.4790852 Vali Loss: 0.2965525 Best vali loss: 0.2923642
	iters: 100, epoch: 6 | loss: 0.6271821
	speed: 0.0366s/iter; left time: 10.7467s
Updating learning rate to 6.8933075528125e-05
Epoch: 6 cost time: 2.2877633571624756
Epoch: 6, Steps: 131 | Train Loss: 0.6271821 Vali Loss: 0.3005619 Best vali loss: 0.2923642
	iters: 100, epoch: 7 | loss: 0.4093759
	speed: 0.0295s/iter; left time: 4.8036s
Updating learning rate to 3.44665377640625e-05
Epoch: 7 cost time: 2.0670478343963623
Epoch: 7, Steps: 131 | Train Loss: 0.4093759 Vali Loss: 0.2980501 Best vali loss: 0.2923642
	iters: 100, epoch: 8 | loss: 0.5201871
	speed: 0.0308s/iter; left time: 0.9855s
Updating learning rate to 1.723326888203125e-05
Epoch: 8 cost time: 2.27119779586792
Epoch: 8, Steps: 131 | Train Loss: 0.5201871 Vali Loss: 0.2980778 Best vali loss: 0.2923642

best validation loss 0.29236419854132206

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3298896
	speed: 0.0120s/iter; left time: 24.0259s
	iters: 200, epoch: 1 | loss: 0.4349111
	speed: 0.0063s/iter; left time: 11.9999s
Updating learning rate to 0.0017284464069435928
Validation loss decreased (inf --> 0.2985).  Saving model state dict ...
Epoch: 1 cost time: 1.9077513217926025
Epoch: 1, Steps: 262 | Train Loss: 0.3824004 Vali Loss: 0.2984536 Best vali loss: 0.2984536
	iters: 100, epoch: 2 | loss: 0.5657018
	speed: 0.0190s/iter; left time: 32.9249s
	iters: 200, epoch: 2 | loss: 0.8084507
	speed: 0.0062s/iter; left time: 10.1910s
Updating learning rate to 0.001533694044948534
Validation loss decreased (0.2985 --> 0.2873).  Saving model state dict ...
Epoch: 2 cost time: 1.6255226135253906
Epoch: 2, Steps: 262 | Train Loss: 0.6870763 Vali Loss: 0.2873173 Best vali loss: 0.2873173
	iters: 100, epoch: 3 | loss: 0.4283633
	speed: 0.0138s/iter; left time: 20.3735s
	iters: 200, epoch: 3 | loss: 0.5530860
	speed: 0.0058s/iter; left time: 7.9781s
Updating learning rate to 0.0012422265376940138
Epoch: 3 cost time: 1.6183412075042725
Epoch: 3, Steps: 262 | Train Loss: 0.4907247 Vali Loss: 0.2966699 Best vali loss: 0.2873173

best validation loss 0.2873173406151601

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039181470431, 'e_layers': 3, 'learning_rate': 0.00012582665, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012103765828973066
Validation loss decreased (inf --> 0.3221).  Saving model state dict ...
Epoch: 1 cost time: 0.9206554889678955
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3220537 Best vali loss: 0.3220537
Updating learning rate to 0.00010739976373449315
Validation loss decreased (0.3221 --> 0.3038).  Saving model state dict ...
Epoch: 2 cost time: 0.631117582321167
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3038350 Best vali loss: 0.3038350
Updating learning rate to 8.698921215250042e-05
Validation loss decreased (0.3038 --> 0.2937).  Saving model state dict ...
Epoch: 3 cost time: 0.6254656314849854
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2936717 Best vali loss: 0.2936717

best validation loss 0.29367169973607754

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6906875
	speed: 0.0165s/iter; left time: 32.9369s
	iters: 200, epoch: 1 | loss: 0.4218192
	speed: 0.0088s/iter; left time: 16.6165s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.3228).  Saving model state dict ...
Epoch: 1 cost time: 2.742763042449951
Epoch: 1, Steps: 262 | Train Loss: 0.5562534 Vali Loss: 0.3227806 Best vali loss: 0.3227806
	iters: 100, epoch: 2 | loss: 0.4368342
	speed: 0.0184s/iter; left time: 32.0025s
	iters: 200, epoch: 2 | loss: 0.6082223
	speed: 0.0088s/iter; left time: 14.3727s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 2.322777032852173
Epoch: 2, Steps: 262 | Train Loss: 0.5225283 Vali Loss: 0.3276022 Best vali loss: 0.3227806
	iters: 100, epoch: 3 | loss: 0.4718234
	speed: 0.0181s/iter; left time: 26.5954s
	iters: 200, epoch: 3 | loss: 0.5947189
	speed: 0.0097s/iter; left time: 13.2975s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 2.3964040279388428
Epoch: 3, Steps: 262 | Train Loss: 0.5332712 Vali Loss: 0.3249309 Best vali loss: 0.3227806

best validation loss 0.32278062744005853

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3035231
	speed: 0.0137s/iter; left time: 16.6205s
	iters: 200, epoch: 4 | loss: 0.4101751
	speed: 0.0097s/iter; left time: 10.7866s
Updating learning rate to 0.000898417171
Epoch: 4 cost time: 2.5733354091644287
Epoch: 4, Steps: 262 | Train Loss: 0.3568491 Vali Loss: 0.2967326 Best vali loss: 0.2873173
	iters: 100, epoch: 5 | loss: 0.4310120
	speed: 0.0229s/iter; left time: 21.7285s
	iters: 200, epoch: 5 | loss: 0.6641536
	speed: 0.0071s/iter; left time: 6.0285s
Updating learning rate to 0.0005546078043059862
Epoch: 5 cost time: 2.0557069778442383
Epoch: 5, Steps: 262 | Train Loss: 0.5475828 Vali Loss: 0.3308066 Best vali loss: 0.2873173
	iters: 100, epoch: 6 | loss: 0.3965822
	speed: 0.0213s/iter; left time: 14.6293s
	iters: 200, epoch: 6 | loss: 0.4093231
	speed: 0.0049s/iter; left time: 2.8824s
Updating learning rate to 0.000263140297051466
Epoch: 6 cost time: 1.5887665748596191
Epoch: 6, Steps: 262 | Train Loss: 0.4029527 Vali Loss: 0.3458055 Best vali loss: 0.2873173
	iters: 100, epoch: 7 | loss: 0.3528026
	speed: 0.0134s/iter; left time: 5.6970s
	iters: 200, epoch: 7 | loss: 0.4301212
	speed: 0.0061s/iter; left time: 1.9947s
Updating learning rate to 6.838793505640724e-05
Epoch: 7 cost time: 1.6352953910827637
Epoch: 7, Steps: 262 | Train Loss: 0.3914619 Vali Loss: 0.3648313 Best vali loss: 0.2873173
	iters: 100, epoch: 8 | loss: 0.3852673
	speed: 0.0150s/iter; left time: 2.4421s
	iters: 200, epoch: 8 | loss: 0.2578292
	speed: 0.0073s/iter; left time: 0.4576s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8272929191589355
Epoch: 8, Steps: 262 | Train Loss: 0.3215483 Vali Loss: 0.3662551 Best vali loss: 0.2873173

best validation loss 0.2873173406151601

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010053990878, 'e_layers': 2, 'learning_rate': 0.0004254413654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0673288
	speed: 0.0144s/iter; left time: 28.6574s
	iters: 200, epoch: 1 | loss: 0.4951391
	speed: 0.0077s/iter; left time: 14.5866s
Updating learning rate to 0.0004254413654
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 2.3939859867095947
Epoch: 1, Steps: 262 | Train Loss: 0.7812340 Vali Loss: 0.2802400 Best vali loss: 0.2802400
	iters: 100, epoch: 2 | loss: 0.7355131
	speed: 0.0173s/iter; left time: 30.0579s
	iters: 200, epoch: 2 | loss: 0.4088578
	speed: 0.0078s/iter; left time: 12.7021s
Updating learning rate to 0.0002127206827
Epoch: 2 cost time: 2.0663528442382812
Epoch: 2, Steps: 262 | Train Loss: 0.5721854 Vali Loss: 0.2845010 Best vali loss: 0.2802400
	iters: 100, epoch: 3 | loss: 0.4450033
	speed: 0.0167s/iter; left time: 24.5651s
	iters: 200, epoch: 3 | loss: 0.3665324
	speed: 0.0078s/iter; left time: 10.7768s
Updating learning rate to 0.00010636034135
Epoch: 3 cost time: 2.210805892944336
Epoch: 3, Steps: 262 | Train Loss: 0.4057679 Vali Loss: 0.2867454 Best vali loss: 0.2802400
	iters: 100, epoch: 4 | loss: 0.6891266
	speed: 0.0193s/iter; left time: 23.4085s
	iters: 200, epoch: 4 | loss: 0.6589614
	speed: 0.0075s/iter; left time: 8.3406s
Updating learning rate to 5.3180170675e-05
Epoch: 4 cost time: 2.0292651653289795
Epoch: 4, Steps: 262 | Train Loss: 0.6740440 Vali Loss: 0.2882012 Best vali loss: 0.2802400
	iters: 100, epoch: 5 | loss: 0.3773437
	speed: 0.0168s/iter; left time: 15.9006s
	iters: 200, epoch: 5 | loss: 0.3152882
	speed: 0.0078s/iter; left time: 6.6085s
Updating learning rate to 2.65900853375e-05
Epoch: 5 cost time: 2.0671651363372803
Epoch: 5, Steps: 262 | Train Loss: 0.3463160 Vali Loss: 0.2882389 Best vali loss: 0.2802400
	iters: 100, epoch: 6 | loss: 0.7348616
	speed: 0.0167s/iter; left time: 11.4395s
	iters: 200, epoch: 6 | loss: 0.3543857
	speed: 0.0077s/iter; left time: 4.5390s
Updating learning rate to 1.329504266875e-05
Epoch: 6 cost time: 2.073117971420288
Epoch: 6, Steps: 262 | Train Loss: 0.5446236 Vali Loss: 0.2884761 Best vali loss: 0.2802400
	iters: 100, epoch: 7 | loss: 0.7919623
	speed: 0.0177s/iter; left time: 7.5030s
	iters: 200, epoch: 7 | loss: 0.4993375
	speed: 0.0088s/iter; left time: 2.8749s
Updating learning rate to 6.647521334375e-06
Epoch: 7 cost time: 2.2049288749694824
Epoch: 7, Steps: 262 | Train Loss: 0.6456499 Vali Loss: 0.2888288 Best vali loss: 0.2802400
	iters: 100, epoch: 8 | loss: 0.4868769
	speed: 0.0170s/iter; left time: 2.7696s
	iters: 200, epoch: 8 | loss: 0.5787588
	speed: 0.0078s/iter; left time: 0.4911s
Updating learning rate to 3.3237606671875e-06
Epoch: 8 cost time: 2.093790054321289
Epoch: 8, Steps: 262 | Train Loss: 0.5328178 Vali Loss: 0.2890192 Best vali loss: 0.2802400

best validation loss 0.28023995348249237

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0113842174153, 'e_layers': 1, 'learning_rate': 0.0018134405744, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2821549
	speed: 0.0115s/iter; left time: 94.6225s
	iters: 200, epoch: 1 | loss: 0.3987502
	speed: 0.0049s/iter; left time: 40.1563s
	iters: 300, epoch: 1 | loss: 0.5324462
	speed: 0.0053s/iter; left time: 42.9816s
	iters: 400, epoch: 1 | loss: 0.5779596
	speed: 0.0052s/iter; left time: 41.1585s
	iters: 500, epoch: 1 | loss: 1.2335888
	speed: 0.0056s/iter; left time: 43.7640s
	iters: 600, epoch: 1 | loss: 0.2063750
	speed: 0.0056s/iter; left time: 43.0971s
	iters: 700, epoch: 1 | loss: 0.3018051
	speed: 0.0051s/iter; left time: 38.9325s
	iters: 800, epoch: 1 | loss: 1.4700868
	speed: 0.0049s/iter; left time: 36.7259s
	iters: 900, epoch: 1 | loss: 0.7508001
	speed: 0.0049s/iter; left time: 36.7586s
	iters: 1000, epoch: 1 | loss: 0.2226608
	speed: 0.0056s/iter; left time: 41.2029s
Updating learning rate to 0.0018134405744
Validation loss decreased (inf --> 0.2906).  Saving model state dict ...
Epoch: 1 cost time: 5.835523843765259
Epoch: 1, Steps: 1045 | Train Loss: 0.5976627 Vali Loss: 0.2906177 Best vali loss: 0.2906177
	iters: 100, epoch: 2 | loss: 0.3665322
	speed: 0.0229s/iter; left time: 165.1947s
	iters: 200, epoch: 2 | loss: 0.2599014
	speed: 0.0044s/iter; left time: 31.1345s
	iters: 300, epoch: 2 | loss: 0.2486255
	speed: 0.0047s/iter; left time: 32.6364s
	iters: 400, epoch: 2 | loss: 0.3289205
	speed: 0.0068s/iter; left time: 46.6907s
	iters: 500, epoch: 2 | loss: 0.6107349
	speed: 0.0067s/iter; left time: 45.7672s
	iters: 600, epoch: 2 | loss: 0.4555877
	speed: 0.0065s/iter; left time: 43.7431s
	iters: 700, epoch: 2 | loss: 0.2472999
	speed: 0.0049s/iter; left time: 32.4993s
	iters: 800, epoch: 2 | loss: 0.3258070
	speed: 0.0041s/iter; left time: 26.4509s
	iters: 900, epoch: 2 | loss: 0.7983393
	speed: 0.0045s/iter; left time: 28.8967s
	iters: 1000, epoch: 2 | loss: 0.3878005
	speed: 0.0053s/iter; left time: 33.5911s
Updating learning rate to 0.0009067202872
Validation loss decreased (0.2906 --> 0.2859).  Saving model state dict ...
Epoch: 2 cost time: 5.556153774261475
Epoch: 2, Steps: 1045 | Train Loss: 0.4029549 Vali Loss: 0.2859000 Best vali loss: 0.2859000
	iters: 100, epoch: 3 | loss: 0.5125707
	speed: 0.0234s/iter; left time: 144.2970s
	iters: 200, epoch: 3 | loss: 2.0228314
	speed: 0.0059s/iter; left time: 35.9377s
	iters: 300, epoch: 3 | loss: 0.3930711
	speed: 0.0055s/iter; left time: 32.6849s
	iters: 400, epoch: 3 | loss: 1.1451533
	speed: 0.0053s/iter; left time: 31.3236s
	iters: 500, epoch: 3 | loss: 0.1840632
	speed: 0.0060s/iter; left time: 34.8240s
	iters: 600, epoch: 3 | loss: 0.4481916
	speed: 0.0060s/iter; left time: 33.8521s
	iters: 700, epoch: 3 | loss: 0.6004989
	speed: 0.0059s/iter; left time: 32.9861s
	iters: 800, epoch: 3 | loss: 0.4149562
	speed: 0.0058s/iter; left time: 31.9191s
	iters: 900, epoch: 3 | loss: 0.1691192
	speed: 0.0058s/iter; left time: 31.3887s
	iters: 1000, epoch: 3 | loss: 0.3861336
	speed: 0.0057s/iter; left time: 30.2820s
Updating learning rate to 0.0004533601436
Epoch: 3 cost time: 6.118255376815796
Epoch: 3, Steps: 1045 | Train Loss: 0.6276589 Vali Loss: 0.2895176 Best vali loss: 0.2859000
	iters: 100, epoch: 4 | loss: 0.5961522
	speed: 0.0214s/iter; left time: 109.5278s
	iters: 200, epoch: 4 | loss: 0.9737016
	speed: 0.0046s/iter; left time: 23.0488s
	iters: 300, epoch: 4 | loss: 1.2920990
	speed: 0.0052s/iter; left time: 25.3783s
	iters: 400, epoch: 4 | loss: 0.2623804
	speed: 0.0058s/iter; left time: 28.2203s
	iters: 500, epoch: 4 | loss: 0.6399102
	speed: 0.0058s/iter; left time: 27.6003s
	iters: 600, epoch: 4 | loss: 0.1795755
	speed: 0.0058s/iter; left time: 27.0278s
	iters: 700, epoch: 4 | loss: 0.3967550
	speed: 0.0057s/iter; left time: 26.0151s
	iters: 800, epoch: 4 | loss: 0.8369756
	speed: 0.0040s/iter; left time: 17.6919s
	iters: 900, epoch: 4 | loss: 0.3025718
	speed: 0.0041s/iter; left time: 17.5746s
	iters: 1000, epoch: 4 | loss: 0.2927606
	speed: 0.0060s/iter; left time: 25.4194s
Updating learning rate to 0.0002266800718
Epoch: 4 cost time: 5.490618705749512
Epoch: 4, Steps: 1045 | Train Loss: 0.5772882 Vali Loss: 0.2943782 Best vali loss: 0.2859000
	iters: 100, epoch: 5 | loss: 0.2369124
	speed: 0.0239s/iter; left time: 97.6068s
	iters: 200, epoch: 5 | loss: 0.7460964
	speed: 0.0046s/iter; left time: 18.2003s
	iters: 300, epoch: 5 | loss: 0.5430900
	speed: 0.0066s/iter; left time: 25.7505s
	iters: 400, epoch: 5 | loss: 0.6728268
	speed: 0.0083s/iter; left time: 31.5302s
	iters: 500, epoch: 5 | loss: 0.2541601
	speed: 0.0081s/iter; left time: 29.7366s
	iters: 600, epoch: 5 | loss: 1.0044008
	speed: 0.0078s/iter; left time: 27.8917s
	iters: 700, epoch: 5 | loss: 0.8743781
	speed: 0.0083s/iter; left time: 28.9920s
	iters: 800, epoch: 5 | loss: 0.1643062
	speed: 0.0094s/iter; left time: 31.7312s
	iters: 900, epoch: 5 | loss: 1.6819364
	speed: 0.0082s/iter; left time: 27.0148s
	iters: 1000, epoch: 5 | loss: 0.4437176
	speed: 0.0097s/iter; left time: 30.7176s
Updating learning rate to 0.0001133400359
Epoch: 5 cost time: 8.105641841888428
Epoch: 5, Steps: 1045 | Train Loss: 0.6621825 Vali Loss: 0.3005827 Best vali loss: 0.2859000
	iters: 100, epoch: 6 | loss: 0.8530199
	speed: 0.0171s/iter; left time: 51.9391s
	iters: 200, epoch: 6 | loss: 0.2435154
	speed: 0.0054s/iter; left time: 15.9679s
	iters: 300, epoch: 6 | loss: 0.2824014
	speed: 0.0096s/iter; left time: 27.1492s
	iters: 400, epoch: 6 | loss: 0.4394563
	speed: 0.0084s/iter; left time: 22.8694s
	iters: 500, epoch: 6 | loss: 0.3633952
	speed: 0.0050s/iter; left time: 13.0754s
	iters: 600, epoch: 6 | loss: 0.3101010
	speed: 0.0060s/iter; left time: 15.2171s
	iters: 700, epoch: 6 | loss: 0.2850866
	speed: 0.0094s/iter; left time: 22.8472s
	iters: 800, epoch: 6 | loss: 0.2476582
	speed: 0.0073s/iter; left time: 16.9624s
	iters: 900, epoch: 6 | loss: 0.7389633
	speed: 0.0073s/iter; left time: 16.2891s
	iters: 1000, epoch: 6 | loss: 0.4755078
	speed: 0.0067s/iter; left time: 14.3315s
Updating learning rate to 5.667001795e-05
Epoch: 6 cost time: 7.205313205718994
Epoch: 6, Steps: 1045 | Train Loss: 0.4239105 Vali Loss: 0.3111826 Best vali loss: 0.2859000
	iters: 100, epoch: 7 | loss: 0.5455347
	speed: 0.0295s/iter; left time: 58.7305s
	iters: 200, epoch: 7 | loss: 0.4699073
	speed: 0.0037s/iter; left time: 6.9022s
	iters: 300, epoch: 7 | loss: 0.4139078
	speed: 0.0047s/iter; left time: 8.4792s
	iters: 400, epoch: 7 | loss: 0.2000512
	speed: 0.0048s/iter; left time: 8.1081s
	iters: 500, epoch: 7 | loss: 0.4702198
	speed: 0.0059s/iter; left time: 9.3257s
	iters: 600, epoch: 7 | loss: 0.4000513
	speed: 0.0057s/iter; left time: 8.4556s
	iters: 700, epoch: 7 | loss: 0.2371430
	speed: 0.0048s/iter; left time: 6.6589s
	iters: 800, epoch: 7 | loss: 0.4830130
	speed: 0.0046s/iter; left time: 5.9352s
	iters: 900, epoch: 7 | loss: 0.5154041
	speed: 0.0052s/iter; left time: 6.2235s
	iters: 1000, epoch: 7 | loss: 0.2051919
	speed: 0.0047s/iter; left time: 5.1813s
Updating learning rate to 2.8335008975e-05
Epoch: 7 cost time: 5.19994854927063
Epoch: 7, Steps: 1045 | Train Loss: 0.3940424 Vali Loss: 0.3137779 Best vali loss: 0.2859000
	iters: 100, epoch: 8 | loss: 0.3172380
	speed: 0.0375s/iter; left time: 35.4729s
	iters: 200, epoch: 8 | loss: 0.7877724
	speed: 0.0095s/iter; left time: 8.0427s
	iters: 300, epoch: 8 | loss: 1.0207702
	speed: 0.0087s/iter; left time: 6.4853s
	iters: 400, epoch: 8 | loss: 0.3226385
	speed: 0.0086s/iter; left time: 5.5330s
	iters: 500, epoch: 8 | loss: 0.2790428
	speed: 0.0101s/iter; left time: 5.5305s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014152615275, 'e_layers': 1, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.3100).  Saving model state dict ...
Epoch: 1 cost time: 1.7949597835540771
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3100417 Best vali loss: 0.3100417
Updating learning rate to 0.0002257411363
Validation loss decreased (0.3100 --> 0.2927).  Saving model state dict ...
Epoch: 2 cost time: 0.5329298973083496
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2926912 Best vali loss: 0.2926912
Updating learning rate to 0.00011287056815
Validation loss decreased (0.2927 --> 0.2881).  Saving model state dict ...
Epoch: 3 cost time: 0.7046470642089844
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2880645 Best vali loss: 0.2880645

best validation loss 0.2880645405740798

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5429620
	speed: 0.0180s/iter; left time: 17.0455s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 1.722052812576294
Epoch: 1, Steps: 131 | Train Loss: 0.5429620 Vali Loss: 0.2829378 Best vali loss: 0.2829378
	iters: 100, epoch: 2 | loss: 0.3978160
	speed: 0.0226s/iter; left time: 18.4687s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.2829 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 1.0228288173675537
Epoch: 2, Steps: 131 | Train Loss: 0.3978160 Vali Loss: 0.2812244 Best vali loss: 0.2812244
	iters: 100, epoch: 3 | loss: 0.7905126
	speed: 0.0238s/iter; left time: 16.3184s
Updating learning rate to 1.70765195e-05
Validation loss decreased (0.2812 --> 0.2795).  Saving model state dict ...
Epoch: 3 cost time: 2.078615427017212
Epoch: 3, Steps: 131 | Train Loss: 0.7905126 Vali Loss: 0.2794930 Best vali loss: 0.2794930

best validation loss 0.2794930044050419

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014438416367, 'e_layers': 1, 'learning_rate': 0.000558760672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4660459
	speed: 0.0174s/iter; left time: 34.8339s
	iters: 200, epoch: 1 | loss: 0.4870508
	speed: 0.0098s/iter; left time: 18.5853s
Updating learning rate to 0.0005374941102165261
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 3.0657882690429688
Epoch: 1, Steps: 262 | Train Loss: 0.4765483 Vali Loss: 0.2837563 Best vali loss: 0.2837563
	iters: 100, epoch: 2 | loss: 0.4836692
	speed: 0.0290s/iter; left time: 50.3231s
	iters: 200, epoch: 2 | loss: 0.7244568
	speed: 0.0098s/iter; left time: 15.9444s
Updating learning rate to 0.00047693206611577606
Epoch: 2 cost time: 2.5800869464874268
Epoch: 2, Steps: 262 | Train Loss: 0.6040630 Vali Loss: 0.2949986 Best vali loss: 0.2837563
	iters: 100, epoch: 3 | loss: 0.3975043
	speed: 0.0282s/iter; left time: 41.5140s
	iters: 200, epoch: 3 | loss: 0.3935789
	speed: 0.0079s/iter; left time: 10.9013s
Updating learning rate to 0.000386294561915792
Epoch: 3 cost time: 2.1956288814544678
Epoch: 3, Steps: 262 | Train Loss: 0.3955416 Vali Loss: 0.2881508 Best vali loss: 0.2837563

best validation loss 0.2837562965344833

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4870154
	speed: 0.0272s/iter; left time: 15.1047s
Updating learning rate to 8.53825975e-06
Validation loss decreased (0.2795 --> 0.2779).  Saving model state dict ...
Epoch: 4 cost time: 2.878041982650757
Epoch: 4, Steps: 131 | Train Loss: 0.4870154 Vali Loss: 0.2778507 Best vali loss: 0.2778507
	iters: 100, epoch: 5 | loss: 0.3749695
	speed: 0.0335s/iter; left time: 14.2524s
Updating learning rate to 4.269129875e-06
Validation loss decreased (0.2779 --> 0.2775).  Saving model state dict ...
Epoch: 5 cost time: 2.3197438716888428
Epoch: 5, Steps: 131 | Train Loss: 0.3749695 Vali Loss: 0.2774547 Best vali loss: 0.2774547
	iters: 100, epoch: 6 | loss: 0.7490925
	speed: 0.0564s/iter; left time: 16.5758s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 3.7909159660339355
Epoch: 6, Steps: 131 | Train Loss: 0.7490925 Vali Loss: 0.2775264 Best vali loss: 0.2774547
	iters: 100, epoch: 7 | loss: 0.5067104
	speed: 0.0597s/iter; left time: 9.7261s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 3.8347508907318115
Epoch: 7, Steps: 131 | Train Loss: 0.5067104 Vali Loss: 0.2775234 Best vali loss: 0.2774547
	iters: 100, epoch: 8 | loss: 0.3697366
	speed: 0.0455s/iter; left time: 1.4574s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 3.4599087238311768
Epoch: 8, Steps: 131 | Train Loss: 0.3697366 Vali Loss: 0.2774910 Best vali loss: 0.2774547

best validation loss 0.2774547010593673

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0079026385404, 'e_layers': 2, 'learning_rate': 0.0022201950658, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6355318
	speed: 0.0201s/iter; left time: 40.1928s
	iters: 200, epoch: 1 | loss: 0.5631440
	speed: 0.0136s/iter; left time: 25.7848s
Updating learning rate to 0.0022201950658
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 3.8351075649261475
Epoch: 1, Steps: 262 | Train Loss: 0.5993379 Vali Loss: 0.2901050 Best vali loss: 0.2901050
	iters: 100, epoch: 2 | loss: 0.4985761
	speed: 0.0438s/iter; left time: 76.0786s
	iters: 200, epoch: 2 | loss: 0.3962153
	speed: 0.0129s/iter; left time: 21.0572s
Updating learning rate to 0.0011100975329
Validation loss decreased (0.2901 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 3.2393147945404053
Epoch: 2, Steps: 262 | Train Loss: 0.4473957 Vali Loss: 0.2867929 Best vali loss: 0.2867929
	iters: 100, epoch: 3 | loss: 0.5953435
	speed: 0.0495s/iter; left time: 72.8540s
	iters: 200, epoch: 3 | loss: 0.7750326
	speed: 0.0131s/iter; left time: 17.9378s
Updating learning rate to 0.00055504876645
Epoch: 3 cost time: 3.5957555770874023
Epoch: 3, Steps: 262 | Train Loss: 0.6851880 Vali Loss: 0.2953836 Best vali loss: 0.2867929
	iters: 100, epoch: 4 | loss: 0.4459012
	speed: 0.0431s/iter; left time: 52.2233s
	iters: 200, epoch: 4 | loss: 0.4734406
	speed: 0.0126s/iter; left time: 14.0218s
Updating learning rate to 0.000277524383225
Epoch: 4 cost time: 3.39896559715271
Epoch: 4, Steps: 262 | Train Loss: 0.4596709 Vali Loss: 0.2955467 Best vali loss: 0.2867929
	iters: 100, epoch: 5 | loss: 0.3067713
	speed: 0.0507s/iter; left time: 48.0795s
	iters: 200, epoch: 5 | loss: 0.4384037
	speed: 0.0121s/iter; left time: 10.2896s
Updating learning rate to 0.0001387621916125
Epoch: 5 cost time: 3.481327772140503
Epoch: 5, Steps: 262 | Train Loss: 0.3725875 Vali Loss: 0.3104807 Best vali loss: 0.2867929
	iters: 100, epoch: 6 | loss: 0.4339473
	speed: 0.0528s/iter; left time: 36.2453s
	iters: 200, epoch: 6 | loss: 0.2600999
	speed: 0.0120s/iter; left time: 7.0428s
Updating learning rate to 6.938109580625e-05
Epoch: 6 cost time: 3.1144254207611084
Epoch: 6, Steps: 262 | Train Loss: 0.3470236 Vali Loss: 0.3038199 Best vali loss: 0.2867929
	iters: 100, epoch: 7 | loss: 0.4545154
	speed: 0.0506s/iter; left time: 21.4926s
	iters: 200, epoch: 7 | loss: 0.2778278
	speed: 0.0134s/iter; left time: 4.3514s
Updating learning rate to 3.4690547903125e-05
Epoch: 7 cost time: 3.3187499046325684
Epoch: 7, Steps: 262 | Train Loss: 0.3661716 Vali Loss: 0.3086475 Best vali loss: 0.2867929
	iters: 100, epoch: 8 | loss: 0.3121894
	speed: 0.0427s/iter; left time: 6.9629s
	iters: 200, epoch: 8 | loss: 0.2214279
	speed: 0.0087s/iter; left time: 0.5480s
Updating learning rate to 1.73452739515625e-05
Epoch: 8 cost time: 2.4872372150421143
Epoch: 8, Steps: 262 | Train Loss: 0.2668087 Vali Loss: 0.3118885 Best vali loss: 0.2867929

best validation loss 0.2867929254401878

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027523638828, 'e_layers': 2, 'learning_rate': 0.0003512624633, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003378933318411835
Validation loss decreased (inf --> 0.3149).  Saving model state dict ...
Epoch: 1 cost time: 2.0717122554779053
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3149453 Best vali loss: 0.3149453
Updating learning rate to 0.0002998212665378604
Validation loss decreased (0.3149 --> 0.2991).  Saving model state dict ...
Epoch: 2 cost time: 1.5089902877807617
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2991469 Best vali loss: 0.2991469
Updating learning rate to 0.0002428423942083302
Validation loss decreased (0.2991 --> 0.2911).  Saving model state dict ...
Epoch: 3 cost time: 1.5745186805725098
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2911379 Best vali loss: 0.2911379
Updating learning rate to 0.00017563123165
Validation loss decreased (0.2911 --> 0.2876).  Saving model state dict ...
Epoch: 4 cost time: 0.6375875473022461
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2876489 Best vali loss: 0.2876489
Updating learning rate to 0.00010842006909166983
Validation loss decreased (0.2876 --> 0.2855).  Saving model state dict ...
Epoch: 5 cost time: 1.3317146301269531
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2854771 Best vali loss: 0.2854771
Updating learning rate to 5.144119676213962e-05
Validation loss decreased (0.2855 --> 0.2845).  Saving model state dict ...
Epoch: 6 cost time: 1.5155911445617676
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845020 Best vali loss: 0.2845020
Updating learning rate to 1.3369131458816492e-05
Validation loss decreased (0.2845 --> 0.2842).  Saving model state dict ...
Epoch: 7 cost time: 0.6151537895202637
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2842018 Best vali loss: 0.2842018
Updating learning rate to 0.0
Validation loss decreased (0.2842 --> 0.2842).  Saving model state dict ...
Epoch: 8 cost time: 0.7174651622772217
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2841666 Best vali loss: 0.2841666

best validation loss 0.28416655216796904

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8340313
	speed: 0.0139s/iter; left time: 56.5843s
	iters: 200, epoch: 1 | loss: 0.3961600
	speed: 0.0075s/iter; left time: 29.9360s
	iters: 300, epoch: 1 | loss: 0.3412137
	speed: 0.0064s/iter; left time: 25.0492s
	iters: 400, epoch: 1 | loss: 0.3631559
	speed: 0.0066s/iter; left time: 24.8426s
	iters: 500, epoch: 1 | loss: 0.1976330
	speed: 0.0074s/iter; left time: 27.3648s
Updating learning rate to 9.34698808e-05
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 4.0513200759887695
Epoch: 1, Steps: 523 | Train Loss: 0.4264388 Vali Loss: 0.2805963 Best vali loss: 0.2805963
	iters: 100, epoch: 2 | loss: 0.4813979
	speed: 0.0167s/iter; left time: 59.5116s
	iters: 200, epoch: 2 | loss: 1.2156699
	speed: 0.0069s/iter; left time: 24.0265s
	iters: 300, epoch: 2 | loss: 0.8839002
	speed: 0.0077s/iter; left time: 25.9856s
	iters: 400, epoch: 2 | loss: 0.3731978
	speed: 0.0075s/iter; left time: 24.3491s
	iters: 500, epoch: 2 | loss: 0.5137824
	speed: 0.0075s/iter; left time: 23.8604s
Updating learning rate to 4.67349404e-05
Validation loss decreased (0.2806 --> 0.2762).  Saving model state dict ...
Epoch: 2 cost time: 3.849984645843506
Epoch: 2, Steps: 523 | Train Loss: 0.6935897 Vali Loss: 0.2761563 Best vali loss: 0.2761563
	iters: 100, epoch: 3 | loss: 0.3240150
	speed: 0.0129s/iter; left time: 39.1791s
	iters: 200, epoch: 3 | loss: 0.4868388
	speed: 0.0064s/iter; left time: 18.8155s
	iters: 300, epoch: 3 | loss: 0.4181248
	speed: 0.0067s/iter; left time: 18.8803s
	iters: 400, epoch: 3 | loss: 0.5650256
	speed: 0.0060s/iter; left time: 16.4951s
	iters: 500, epoch: 3 | loss: 0.2368787
	speed: 0.0070s/iter; left time: 18.4432s
Updating learning rate to 2.33674702e-05
Validation loss decreased (0.2762 --> 0.2758).  Saving model state dict ...
Epoch: 3 cost time: 3.269544839859009
Epoch: 3, Steps: 523 | Train Loss: 0.4061766 Vali Loss: 0.2758127 Best vali loss: 0.2758127

best validation loss 0.2758127155690532

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7193140
	speed: 0.0167s/iter; left time: 68.1108s
	iters: 200, epoch: 1 | loss: 0.6999950
	speed: 0.0081s/iter; left time: 32.3530s
	iters: 300, epoch: 1 | loss: 0.5718579
	speed: 0.0088s/iter; left time: 34.2390s
	iters: 400, epoch: 1 | loss: 0.5889742
	speed: 0.0097s/iter; left time: 36.5457s
	iters: 500, epoch: 1 | loss: 0.3541995
	speed: 0.0102s/iter; left time: 37.5609s
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 5.227409601211548
Epoch: 1, Steps: 523 | Train Loss: 0.5868681 Vali Loss: 0.2800077 Best vali loss: 0.2800077
	iters: 100, epoch: 2 | loss: 0.2801476
	speed: 0.0189s/iter; left time: 67.3692s
	iters: 200, epoch: 2 | loss: 0.3833831
	speed: 0.0087s/iter; left time: 30.1151s
	iters: 300, epoch: 2 | loss: 0.4314804
	speed: 0.0092s/iter; left time: 31.0482s
	iters: 400, epoch: 2 | loss: 0.3165190
	speed: 0.0094s/iter; left time: 30.6143s
	iters: 500, epoch: 2 | loss: 0.3534072
	speed: 0.0090s/iter; left time: 28.3988s
Updating learning rate to 0.00034048964815
Epoch: 2 cost time: 4.772450923919678
Epoch: 2, Steps: 523 | Train Loss: 0.3529875 Vali Loss: 0.2905247 Best vali loss: 0.2800077
	iters: 100, epoch: 3 | loss: 0.4029632
	speed: 0.0198s/iter; left time: 60.3111s
	iters: 200, epoch: 3 | loss: 0.8134559
	speed: 0.0091s/iter; left time: 26.6176s
	iters: 300, epoch: 3 | loss: 0.4942324
	speed: 0.0088s/iter; left time: 24.8607s
	iters: 400, epoch: 3 | loss: 0.6672369
	speed: 0.0088s/iter; left time: 24.2332s
	iters: 500, epoch: 3 | loss: 0.4926667
	speed: 0.0085s/iter; left time: 22.3567s
Updating learning rate to 0.000170244824075
Epoch: 3 cost time: 4.7716381549835205
Epoch: 3, Steps: 523 | Train Loss: 0.5741110 Vali Loss: 0.2870036 Best vali loss: 0.2800077

best validation loss 0.2800076809202973

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0047262361197, 'e_layers': 2, 'learning_rate': 5.5626136e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.5626136e-05
Validation loss decreased (inf --> 0.3064).  Saving model state dict ...
Epoch: 1 cost time: 1.171334981918335
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3063832 Best vali loss: 0.3063832
Updating learning rate to 2.7813068e-05
Validation loss decreased (0.3064 --> 0.2898).  Saving model state dict ...
Epoch: 2 cost time: 1.1862459182739258
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2897515 Best vali loss: 0.2897515
Updating learning rate to 1.3906534e-05
Validation loss decreased (0.2898 --> 0.2857).  Saving model state dict ...
Epoch: 3 cost time: 1.5733811855316162
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2857484 Best vali loss: 0.2857484

best validation loss 0.28574838934001445

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7912202
	speed: 0.0129s/iter; left time: 32.4087s
	iters: 200, epoch: 4 | loss: 0.4178843
	speed: 0.0066s/iter; left time: 15.9482s
	iters: 300, epoch: 4 | loss: 0.3144421
	speed: 0.0069s/iter; left time: 15.9157s
	iters: 400, epoch: 4 | loss: 0.3232890
	speed: 0.0064s/iter; left time: 14.0958s
	iters: 500, epoch: 4 | loss: 0.1947254
	speed: 0.0055s/iter; left time: 11.5862s
Updating learning rate to 1.16837351e-05
Epoch: 4 cost time: 3.6422574520111084
Epoch: 4, Steps: 523 | Train Loss: 0.4083122 Vali Loss: 0.2776025 Best vali loss: 0.2758127
	iters: 100, epoch: 5 | loss: 0.4801016
	speed: 0.0162s/iter; left time: 32.2257s
	iters: 200, epoch: 5 | loss: 1.0820357
	speed: 0.0063s/iter; left time: 11.8783s
	iters: 300, epoch: 5 | loss: 0.8131886
	speed: 0.0056s/iter; left time: 10.0128s
	iters: 400, epoch: 5 | loss: 0.3681617
	speed: 0.0095s/iter; left time: 16.0299s
	iters: 500, epoch: 5 | loss: 0.5184804
	speed: 0.0108s/iter; left time: 17.2743s
Updating learning rate to 5.84186755e-06
Epoch: 5 cost time: 4.2103071212768555
Epoch: 5, Steps: 523 | Train Loss: 0.6523936 Vali Loss: 0.2783567 Best vali loss: 0.2758127
	iters: 100, epoch: 6 | loss: 0.3328106
	speed: 0.0263s/iter; left time: 38.6629s
	iters: 200, epoch: 6 | loss: 0.4752529
	speed: 0.0096s/iter; left time: 13.1365s
	iters: 300, epoch: 6 | loss: 0.3815225
	speed: 0.0119s/iter; left time: 15.1386s
	iters: 400, epoch: 6 | loss: 0.5433298
	speed: 0.0119s/iter; left time: 13.9655s
	iters: 500, epoch: 6 | loss: 0.2332494
	speed: 0.0120s/iter; left time: 12.8475s
Updating learning rate to 2.920933775e-06
Epoch: 6 cost time: 5.927786111831665
Epoch: 6, Steps: 523 | Train Loss: 0.3932330 Vali Loss: 0.2781771 Best vali loss: 0.2758127
	iters: 100, epoch: 7 | loss: 0.7188184
	speed: 0.0267s/iter; left time: 25.2939s
	iters: 200, epoch: 7 | loss: 0.5400223
	speed: 0.0104s/iter; left time: 8.8281s
	iters: 300, epoch: 7 | loss: 1.1294146
	speed: 0.0108s/iter; left time: 8.0698s
	iters: 400, epoch: 7 | loss: 0.3361524
	speed: 0.0118s/iter; left time: 7.6460s
	iters: 500, epoch: 7 | loss: 0.8034984
	speed: 0.0120s/iter; left time: 6.5466s
Updating learning rate to 1.4604668875e-06
Epoch: 7 cost time: 5.965664863586426
Epoch: 7, Steps: 523 | Train Loss: 0.7055812 Vali Loss: 0.2788074 Best vali loss: 0.2758127
	iters: 100, epoch: 8 | loss: 0.8432630
	speed: 0.0283s/iter; left time: 11.9912s
	iters: 200, epoch: 8 | loss: 0.3725201
	speed: 0.0108s/iter; left time: 3.5096s
	iters: 300, epoch: 8 | loss: 0.3645019
	speed: 0.0106s/iter; left time: 2.3774s
	iters: 400, epoch: 8 | loss: 0.3062265
	speed: 0.0110s/iter; left time: 1.3626s
	iters: 500, epoch: 8 | loss: 0.3267033
	speed: 0.0111s/iter; left time: 0.2668s
Updating learning rate to 7.3023344375e-07
Epoch: 8 cost time: 5.887827634811401
Epoch: 8, Steps: 523 | Train Loss: 0.4426429 Vali Loss: 0.2789648 Best vali loss: 0.2758127

best validation loss 0.2758127155690532

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002399800657, 'e_layers': 3, 'learning_rate': 5.41855407e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.41855407e-05
Validation loss decreased (inf --> 0.3533).  Saving model state dict ...
Epoch: 1 cost time: 1.355607032775879
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3533242 Best vali loss: 0.3533242
Updating learning rate to 2.709277035e-05
Validation loss decreased (0.3533 --> 0.3418).  Saving model state dict ...
Epoch: 2 cost time: 0.9696557521820068
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3418423 Best vali loss: 0.3418423
Updating learning rate to 1.3546385175e-05
Validation loss decreased (0.3418 --> 0.3370).  Saving model state dict ...
Epoch: 3 cost time: 1.1274547576904297
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3370456 Best vali loss: 0.3370456
Updating learning rate to 6.7731925875e-06
Validation loss decreased (0.3370 --> 0.3348).  Saving model state dict ...
Epoch: 4 cost time: 1.0530450344085693
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3348358 Best vali loss: 0.3348358
Updating learning rate to 3.38659629375e-06
Validation loss decreased (0.3348 --> 0.3337).  Saving model state dict ...
Epoch: 5 cost time: 1.0033292770385742
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3337330 Best vali loss: 0.3337330
Updating learning rate to 1.693298146875e-06
Validation loss decreased (0.3337 --> 0.3332).  Saving model state dict ...
Epoch: 6 cost time: 0.9545080661773682
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3332061 Best vali loss: 0.3332061
Updating learning rate to 8.466490734375e-07
Validation loss decreased (0.3332 --> 0.3329).  Saving model state dict ...
Epoch: 7 cost time: 0.8915767669677734
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3329456 Best vali loss: 0.3329456
Updating learning rate to 4.2332453671875e-07
Validation loss decreased (0.3329 --> 0.3328).  Saving model state dict ...
Epoch: 8 cost time: 0.9450993537902832
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3328127 Best vali loss: 0.3328127

best validation loss 0.33281273580741244

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016060344052, 'e_layers': 3, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2401924
	speed: 0.0210s/iter; left time: 41.9113s
	iters: 200, epoch: 1 | loss: 0.7111621
	speed: 0.0108s/iter; left time: 20.5822s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 3.41782283782959
Epoch: 1, Steps: 262 | Train Loss: 0.4756773 Vali Loss: 0.2873960 Best vali loss: 0.2873960
	iters: 100, epoch: 2 | loss: 0.3048992
	speed: 0.0194s/iter; left time: 33.6362s
	iters: 200, epoch: 2 | loss: 0.8970234
	speed: 0.0081s/iter; left time: 13.3013s
Updating learning rate to 0.00037646055854993277
Epoch: 2 cost time: 2.24727463722229
Epoch: 2, Steps: 262 | Train Loss: 0.6009613 Vali Loss: 0.2901256 Best vali loss: 0.2873960
	iters: 100, epoch: 3 | loss: 0.4122463
	speed: 0.0195s/iter; left time: 28.6625s
	iters: 200, epoch: 3 | loss: 0.5020506
	speed: 0.0086s/iter; left time: 11.7696s
Updating learning rate to 0.00030491694074585157
Validation loss decreased (0.2874 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 2.3057310581207275
Epoch: 3, Steps: 262 | Train Loss: 0.4571484 Vali Loss: 0.2819146 Best vali loss: 0.2819146
	iters: 100, epoch: 4 | loss: 0.3980431
	speed: 0.0196s/iter; left time: 23.7689s
	iters: 200, epoch: 4 | loss: 0.3538039
	speed: 0.0090s/iter; left time: 9.9702s
Updating learning rate to 0.0002205254895
Epoch: 4 cost time: 2.4125287532806396
Epoch: 4, Steps: 262 | Train Loss: 0.3759235 Vali Loss: 0.2842108 Best vali loss: 0.2819146
	iters: 100, epoch: 5 | loss: 0.4508059
	speed: 0.0174s/iter; left time: 16.5518s
	iters: 200, epoch: 5 | loss: 0.3012054
	speed: 0.0077s/iter; left time: 6.5227s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.9807403087615967
Epoch: 5, Steps: 262 | Train Loss: 0.3760057 Vali Loss: 0.2853221 Best vali loss: 0.2819146
	iters: 100, epoch: 6 | loss: 0.2562079
	speed: 0.0189s/iter; left time: 12.9984s
	iters: 200, epoch: 6 | loss: 0.3228912
	speed: 0.0068s/iter; left time: 4.0103s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 2.0604875087738037
Epoch: 6, Steps: 262 | Train Loss: 0.2895495 Vali Loss: 0.3049965 Best vali loss: 0.2819146
	iters: 100, epoch: 7 | loss: 0.3967261
	speed: 0.0198s/iter; left time: 8.4200s
	iters: 200, epoch: 7 | loss: 0.2379227
	speed: 0.0088s/iter; left time: 2.8483s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 2.3532254695892334
Epoch: 7, Steps: 262 | Train Loss: 0.3173244 Vali Loss: 0.2985742 Best vali loss: 0.2819146
	iters: 100, epoch: 8 | loss: 0.2478009
	speed: 0.0188s/iter; left time: 3.0586s
	iters: 200, epoch: 8 | loss: 0.3059199
	speed: 0.0075s/iter; left time: 0.4698s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.17333722114563
Epoch: 8, Steps: 262 | Train Loss: 0.2768604 Vali Loss: 0.3027226 Best vali loss: 0.2819146

best validation loss 0.2819146122485566

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047364814747, 'e_layers': 3, 'learning_rate': 0.0010075758554, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6271176
	speed: 0.0202s/iter; left time: 40.3432s
	iters: 200, epoch: 1 | loss: 0.9558530
	speed: 0.0099s/iter; left time: 18.7819s
Updating learning rate to 0.000969227282828306
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 3.488189458847046
Epoch: 1, Steps: 262 | Train Loss: 0.7914853 Vali Loss: 0.3201394 Best vali loss: 0.3201394
	iters: 100, epoch: 2 | loss: 0.8076766
	speed: 0.0467s/iter; left time: 81.0131s
	iters: 200, epoch: 2 | loss: 0.6873996
	speed: 0.0153s/iter; left time: 24.9349s
Updating learning rate to 0.0008600197876565881
Validation loss decreased (0.3201 --> 0.3199).  Saving model state dict ...
Epoch: 2 cost time: 4.341808557510376
Epoch: 2, Steps: 262 | Train Loss: 0.7475381 Vali Loss: 0.3198762 Best vali loss: 0.3198762
	iters: 100, epoch: 3 | loss: 0.4289829
	speed: 0.0417s/iter; left time: 61.4458s
	iters: 200, epoch: 3 | loss: 0.4237156
	speed: 0.0162s/iter; left time: 22.2945s
Updating learning rate to 0.0006965792210563318
Validation loss decreased (0.3199 --> 0.3177).  Saving model state dict ...
Epoch: 3 cost time: 4.216768503189087
Epoch: 3, Steps: 262 | Train Loss: 0.4263492 Vali Loss: 0.3176858 Best vali loss: 0.3176858

best validation loss 0.3176857709674066

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 0.0001461940837, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8124551
	speed: 0.0302s/iter; left time: 28.6483s
Updating learning rate to 0.0001461940837
Validation loss decreased (inf --> 0.3001).  Saving model state dict ...
Epoch: 1 cost time: 3.0163023471832275
Epoch: 1, Steps: 131 | Train Loss: 0.8124551 Vali Loss: 0.3000662 Best vali loss: 0.3000662
	iters: 100, epoch: 2 | loss: 0.5348299
	speed: 0.0251s/iter; left time: 20.5555s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.3001 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 2.2610955238342285
Epoch: 2, Steps: 131 | Train Loss: 0.5348299 Vali Loss: 0.2871121 Best vali loss: 0.2871121
	iters: 100, epoch: 3 | loss: 0.4518460
	speed: 0.0232s/iter; left time: 15.9059s
Updating learning rate to 3.6548520925e-05
Validation loss decreased (0.2871 --> 0.2840).  Saving model state dict ...
Epoch: 3 cost time: 2.3124396800994873
Epoch: 3, Steps: 131 | Train Loss: 0.4518460 Vali Loss: 0.2840003 Best vali loss: 0.2840003

best validation loss 0.2840003212529428

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6196154
	speed: 0.0235s/iter; left time: 22.2811s
Updating learning rate to 0.0017032495860327328
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 2.5406694412231445
Epoch: 1, Steps: 131 | Train Loss: 0.6196154 Vali Loss: 0.2816620 Best vali loss: 0.2816620
	iters: 100, epoch: 2 | loss: 0.8622814
	speed: 0.0315s/iter; left time: 25.7899s
Updating learning rate to 0.001511336270922462
Validation loss decreased (0.2817 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 2.221111297607422
Epoch: 2, Steps: 131 | Train Loss: 0.8622814 Vali Loss: 0.2815246 Best vali loss: 0.2815246
	iters: 100, epoch: 3 | loss: 0.5372039
	speed: 0.0157s/iter; left time: 10.7752s
Updating learning rate to 0.0012241176975961933
Epoch: 3 cost time: 1.3439970016479492
Epoch: 3, Steps: 131 | Train Loss: 0.5372039 Vali Loss: 0.2866283 Best vali loss: 0.2815246

best validation loss 0.281524602183847

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6175051
	speed: 0.0263s/iter; left time: 14.6135s
Updating learning rate to 0.0008853202902
Epoch: 4 cost time: 2.940904378890991
Epoch: 4, Steps: 131 | Train Loss: 0.6175051 Vali Loss: 0.2895513 Best vali loss: 0.2815246
	iters: 100, epoch: 5 | loss: 0.6208001
	speed: 0.0289s/iter; left time: 12.2713s
Updating learning rate to 0.0005465228828038066
Epoch: 5 cost time: 1.9874920845031738
Epoch: 5, Steps: 131 | Train Loss: 0.6208001 Vali Loss: 0.2916957 Best vali loss: 0.2815246
	iters: 100, epoch: 6 | loss: 0.4833185
	speed: 0.0327s/iter; left time: 9.6218s
Updating learning rate to 0.0002593043094775379
Epoch: 6 cost time: 2.09655499458313
Epoch: 6, Steps: 131 | Train Loss: 0.4833185 Vali Loss: 0.2927927 Best vali loss: 0.2815246
	iters: 100, epoch: 7 | loss: 0.4833735
	speed: 0.0295s/iter; left time: 4.8109s
Updating learning rate to 6.739099436726728e-05
Epoch: 7 cost time: 2.141903877258301
Epoch: 7, Steps: 131 | Train Loss: 0.4833735 Vali Loss: 0.2943760 Best vali loss: 0.2815246
	iters: 100, epoch: 8 | loss: 0.3231950
	speed: 0.0245s/iter; left time: 0.7826s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8986556529998779
Epoch: 8, Steps: 131 | Train Loss: 0.3231950 Vali Loss: 0.2906765 Best vali loss: 0.2815246

best validation loss 0.281524602183847

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023321783568, 'e_layers': 4, 'learning_rate': 9.29387868e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8979464
	speed: 0.0151s/iter; left time: 125.0961s
	iters: 200, epoch: 1 | loss: 1.8940372
	speed: 0.0092s/iter; left time: 75.2183s
	iters: 300, epoch: 1 | loss: 0.5398338
	speed: 0.0089s/iter; left time: 72.0067s
	iters: 400, epoch: 1 | loss: 1.1776630
	speed: 0.0092s/iter; left time: 73.6159s
	iters: 500, epoch: 1 | loss: 0.3337301
	speed: 0.0094s/iter; left time: 74.0549s
	iters: 600, epoch: 1 | loss: 0.4686851
	speed: 0.0088s/iter; left time: 68.3018s
	iters: 700, epoch: 1 | loss: 0.2983260
	speed: 0.0080s/iter; left time: 61.1445s
	iters: 800, epoch: 1 | loss: 0.4770249
	speed: 0.0095s/iter; left time: 71.7534s
	iters: 900, epoch: 1 | loss: 0.5538925
	speed: 0.0092s/iter; left time: 68.7576s
	iters: 1000, epoch: 1 | loss: 0.3539320
	speed: 0.0087s/iter; left time: 63.8265s
Updating learning rate to 8.940151485047507e-05
Validation loss decreased (inf --> 0.2995).  Saving model state dict ...
Epoch: 1 cost time: 9.75989556312561
Epoch: 1, Steps: 1045 | Train Loss: 0.6995071 Vali Loss: 0.2995277 Best vali loss: 0.2995277
	iters: 100, epoch: 2 | loss: 0.7194347
	speed: 0.0274s/iter; left time: 198.0180s
	iters: 200, epoch: 2 | loss: 0.5186115
	speed: 0.0095s/iter; left time: 67.8832s
	iters: 300, epoch: 2 | loss: 0.2722789
	speed: 0.0089s/iter; left time: 62.1268s
	iters: 400, epoch: 2 | loss: 0.1371274
	speed: 0.0091s/iter; left time: 63.1960s
	iters: 500, epoch: 2 | loss: 0.4892288
	speed: 0.0098s/iter; left time: 66.8300s
	iters: 600, epoch: 2 | loss: 0.2899892
	speed: 0.0104s/iter; left time: 69.6282s
	iters: 700, epoch: 2 | loss: 0.2235754
	speed: 0.0095s/iter; left time: 62.6397s
	iters: 800, epoch: 2 | loss: 0.5295174
	speed: 0.0096s/iter; left time: 62.5507s
	iters: 900, epoch: 2 | loss: 0.2227096
	speed: 0.0068s/iter; left time: 43.6128s
	iters: 1000, epoch: 2 | loss: 0.4860080
	speed: 0.0083s/iter; left time: 52.3713s
Updating learning rate to 7.93282165907654e-05
Validation loss decreased (0.2995 --> 0.2880).  Saving model state dict ...
Epoch: 2 cost time: 9.474636316299438
Epoch: 2, Steps: 1045 | Train Loss: 0.3888481 Vali Loss: 0.2880345 Best vali loss: 0.2880345
	iters: 100, epoch: 3 | loss: 0.2802228
	speed: 0.0291s/iter; left time: 179.7638s
	iters: 200, epoch: 3 | loss: 0.6223162
	speed: 0.0089s/iter; left time: 54.2191s
	iters: 300, epoch: 3 | loss: 0.3477182
	speed: 0.0097s/iter; left time: 57.6219s
	iters: 400, epoch: 3 | loss: 0.2793298
	speed: 0.0095s/iter; left time: 55.7916s
	iters: 500, epoch: 3 | loss: 0.1702289
	speed: 0.0096s/iter; left time: 55.4223s
	iters: 600, epoch: 3 | loss: 0.5040546
	speed: 0.0091s/iter; left time: 51.4558s
	iters: 700, epoch: 3 | loss: 0.2217704
	speed: 0.0089s/iter; left time: 49.5339s
	iters: 800, epoch: 3 | loss: 0.3357880
	speed: 0.0095s/iter; left time: 51.7122s
	iters: 900, epoch: 3 | loss: 0.2156231
	speed: 0.0095s/iter; left time: 50.9766s
	iters: 1000, epoch: 3 | loss: 0.2407504
	speed: 0.0102s/iter; left time: 53.7549s
Updating learning rate to 6.425246036623565e-05
Validation loss decreased (0.2880 --> 0.2847).  Saving model state dict ...
Epoch: 3 cost time: 9.89769983291626
Epoch: 3, Steps: 1045 | Train Loss: 0.3217802 Vali Loss: 0.2847222 Best vali loss: 0.2847222
	iters: 100, epoch: 4 | loss: 0.4889745
	speed: 0.0322s/iter; left time: 164.8889s
	iters: 200, epoch: 4 | loss: 1.0714405
	speed: 0.0104s/iter; left time: 52.0615s
	iters: 300, epoch: 4 | loss: 0.2179647
	speed: 0.0099s/iter; left time: 48.7166s
	iters: 400, epoch: 4 | loss: 0.4634647
	speed: 0.0093s/iter; left time: 44.8334s
	iters: 500, epoch: 4 | loss: 0.3736471
	speed: 0.0104s/iter; left time: 49.3187s
	iters: 600, epoch: 4 | loss: 0.2529553
	speed: 0.0098s/iter; left time: 45.1371s
	iters: 700, epoch: 4 | loss: 0.2214192
	speed: 0.0096s/iter; left time: 43.4607s
	iters: 800, epoch: 4 | loss: 0.2154242
	speed: 0.0094s/iter; left time: 41.4951s
	iters: 900, epoch: 4 | loss: 0.4881549
	speed: 0.0094s/iter; left time: 40.5541s
	iters: 1000, epoch: 4 | loss: 0.3721004
	speed: 0.0086s/iter; left time: 36.4347s
Updating learning rate to 4.64693934e-05
Validation loss decreased (0.2847 --> 0.2816).  Saving model state dict ...
Epoch: 4 cost time: 10.175447940826416
Epoch: 4, Steps: 1045 | Train Loss: 0.4165545 Vali Loss: 0.2816495 Best vali loss: 0.2816495
	iters: 100, epoch: 5 | loss: 1.2554265
	speed: 0.0423s/iter; left time: 172.8002s
	iters: 200, epoch: 5 | loss: 0.3717354
	speed: 0.0143s/iter; left time: 56.7453s
	iters: 300, epoch: 5 | loss: 0.2721963
	speed: 0.0138s/iter; left time: 53.7125s
	iters: 400, epoch: 5 | loss: 0.1808657
	speed: 0.0149s/iter; left time: 56.1725s
	iters: 500, epoch: 5 | loss: 0.3199790
	speed: 0.0145s/iter; left time: 53.4883s
	iters: 600, epoch: 5 | loss: 0.2493406
	speed: 0.0148s/iter; left time: 53.0717s
	iters: 700, epoch: 5 | loss: 0.4137097
	speed: 0.0147s/iter; left time: 51.2023s
	iters: 800, epoch: 5 | loss: 0.2758626
	speed: 0.0154s/iter; left time: 52.0303s
	iters: 900, epoch: 5 | loss: 0.4973119
	speed: 0.0154s/iter; left time: 50.4312s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0028520410111, 'e_layers': 4, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3599511
	speed: 0.0266s/iter; left time: 53.2184s
	iters: 200, epoch: 1 | loss: 0.4241374
	speed: 0.0201s/iter; left time: 38.2149s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 5.6154656410217285
Epoch: 1, Steps: 262 | Train Loss: 0.3920442 Vali Loss: 0.2786011 Best vali loss: 0.2786011
	iters: 100, epoch: 2 | loss: 0.2599248
	speed: 0.0468s/iter; left time: 81.2674s
	iters: 200, epoch: 2 | loss: 0.5675285
	speed: 0.0190s/iter; left time: 31.0261s
Updating learning rate to 5.35870624e-05
Epoch: 2 cost time: 5.302063941955566
Epoch: 2, Steps: 262 | Train Loss: 0.4137267 Vali Loss: 0.2808917 Best vali loss: 0.2786011
	iters: 100, epoch: 3 | loss: 0.5536920
	speed: 0.0461s/iter; left time: 67.9771s
	iters: 200, epoch: 3 | loss: 0.4564309
	speed: 0.0198s/iter; left time: 27.1798s
Updating learning rate to 2.67935312e-05
Validation loss decreased (0.2786 --> 0.2747).  Saving model state dict ...
Epoch: 3 cost time: 5.346628189086914
Epoch: 3, Steps: 262 | Train Loss: 0.5050614 Vali Loss: 0.2746760 Best vali loss: 0.2746760
	iters: 100, epoch: 4 | loss: 0.5383781
	speed: 0.0422s/iter; left time: 51.1371s
	iters: 200, epoch: 4 | loss: 0.5375238
	speed: 0.0153s/iter; left time: 16.9707s
Updating learning rate to 1.33967656e-05
Epoch: 4 cost time: 4.34037446975708
Epoch: 4, Steps: 262 | Train Loss: 0.5379510 Vali Loss: 0.2785351 Best vali loss: 0.2746760
	iters: 100, epoch: 5 | loss: 0.2596246
	speed: 0.0368s/iter; left time: 34.8895s
	iters: 200, epoch: 5 | loss: 0.3873719
	speed: 0.0155s/iter; left time: 13.1624s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 4.194231986999512
Epoch: 5, Steps: 262 | Train Loss: 0.3234983 Vali Loss: 0.2777128 Best vali loss: 0.2746760
	iters: 100, epoch: 6 | loss: 0.2060655
	speed: 0.0394s/iter; left time: 27.1018s
	iters: 200, epoch: 6 | loss: 0.3444842
	speed: 0.0162s/iter; left time: 9.4926s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 4.274402379989624
Epoch: 6, Steps: 262 | Train Loss: 0.2752748 Vali Loss: 0.2814265 Best vali loss: 0.2746760
	iters: 100, epoch: 7 | loss: 0.2653508
	speed: 0.0362s/iter; left time: 15.3844s
	iters: 200, epoch: 7 | loss: 0.4453120
	speed: 0.0158s/iter; left time: 5.1209s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 4.092024087905884
Epoch: 7, Steps: 262 | Train Loss: 0.3553314 Vali Loss: 0.2813696 Best vali loss: 0.2746760
	iters: 100, epoch: 8 | loss: 0.3974079
	speed: 0.0366s/iter; left time: 5.9616s
	iters: 200, epoch: 8 | loss: 0.3776247
	speed: 0.0157s/iter; left time: 0.9890s
Updating learning rate to 8.3729785e-07
Epoch: 8 cost time: 4.1836841106414795
Epoch: 8, Steps: 262 | Train Loss: 0.3875163 Vali Loss: 0.2808320 Best vali loss: 0.2746760

best validation loss 0.27467595328403344

[INFO][abstract_intensifier.py:595] Added config 409f87 and rejected config 4678dd as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3163844
	speed: 0.0138s/iter; left time: 56.4330s
	iters: 200, epoch: 1 | loss: 0.2935281
	speed: 0.0069s/iter; left time: 27.5417s
	iters: 300, epoch: 1 | loss: 1.0396708
	speed: 0.0064s/iter; left time: 24.9428s
	iters: 400, epoch: 1 | loss: 0.6473995
	speed: 0.0044s/iter; left time: 16.7879s
	iters: 500, epoch: 1 | loss: 0.6302872
	speed: 0.0045s/iter; left time: 16.5641s
Updating learning rate to 0.0002999627711
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 3.4194445610046387
Epoch: 1, Steps: 523 | Train Loss: 0.5854540 Vali Loss: 0.2824808 Best vali loss: 0.2824808
	iters: 100, epoch: 2 | loss: 0.3311751
	speed: 0.0161s/iter; left time: 57.3256s
	iters: 200, epoch: 2 | loss: 0.2907819
	speed: 0.0064s/iter; left time: 22.0535s
	iters: 300, epoch: 2 | loss: 0.3621818
	speed: 0.0064s/iter; left time: 21.6232s
	iters: 400, epoch: 2 | loss: 1.0315244
	speed: 0.0075s/iter; left time: 24.5072s
	iters: 500, epoch: 2 | loss: 0.7102177
	speed: 0.0071s/iter; left time: 22.3094s
Updating learning rate to 0.00014998138555
Epoch: 2 cost time: 3.7156994342803955
Epoch: 2, Steps: 523 | Train Loss: 0.5451762 Vali Loss: 0.2843670 Best vali loss: 0.2824808
	iters: 100, epoch: 3 | loss: 0.2972009
	speed: 0.0156s/iter; left time: 47.4178s
	iters: 200, epoch: 3 | loss: 0.7123016
	speed: 0.0074s/iter; left time: 21.6553s
	iters: 300, epoch: 3 | loss: 0.3475549
	speed: 0.0078s/iter; left time: 22.1397s
	iters: 400, epoch: 3 | loss: 0.3650877
	speed: 0.0054s/iter; left time: 14.8971s
	iters: 500, epoch: 3 | loss: 0.2366330
	speed: 0.0064s/iter; left time: 16.9062s
Updating learning rate to 7.4990692775e-05
Epoch: 3 cost time: 3.643341302871704
Epoch: 3, Steps: 523 | Train Loss: 0.3917556 Vali Loss: 0.2864935 Best vali loss: 0.2824808

best validation loss 0.2824808190240431

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5510309
	speed: 0.0173s/iter; left time: 34.5271s
	iters: 200, epoch: 1 | loss: 0.4285284
	speed: 0.0100s/iter; left time: 18.9048s
Updating learning rate to 0.0006619683104416462
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 2.9644148349761963
Epoch: 1, Steps: 262 | Train Loss: 0.4897797 Vali Loss: 0.2851795 Best vali loss: 0.2851795
	iters: 100, epoch: 2 | loss: 0.2619300
	speed: 0.0284s/iter; left time: 49.3465s
	iters: 200, epoch: 2 | loss: 0.3157342
	speed: 0.0098s/iter; left time: 15.9961s
Updating learning rate to 0.0005873811600929365
Validation loss decreased (0.2852 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 2.73486065864563
Epoch: 2, Steps: 262 | Train Loss: 0.2888321 Vali Loss: 0.2828813 Best vali loss: 0.2828813
	iters: 100, epoch: 3 | loss: 0.7749415
	speed: 0.0285s/iter; left time: 42.0504s
	iters: 200, epoch: 3 | loss: 0.4215963
	speed: 0.0093s/iter; left time: 12.7617s
Updating learning rate to 0.0004757536010602603
Epoch: 3 cost time: 2.5723307132720947
Epoch: 3, Steps: 262 | Train Loss: 0.5982689 Vali Loss: 0.2847902 Best vali loss: 0.2828813

best validation loss 0.28288128579159394

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006724544284
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 2.0530779361724854
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2837355 Best vali loss: 0.2837355
Updating learning rate to 0.0003362272142
Epoch: 2 cost time: 1.8085153102874756
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2932293 Best vali loss: 0.2837355
Updating learning rate to 0.0001681136071
Epoch: 3 cost time: 1.6621143817901611
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2935511 Best vali loss: 0.2837355

best validation loss 0.283735543561496

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2863677
	speed: 0.0191s/iter; left time: 48.1009s
	iters: 200, epoch: 4 | loss: 0.2760338
	speed: 0.0122s/iter; left time: 29.4072s
	iters: 300, epoch: 4 | loss: 1.0657313
	speed: 0.0076s/iter; left time: 17.5327s
	iters: 400, epoch: 4 | loss: 0.6088443
	speed: 0.0103s/iter; left time: 22.7629s
	iters: 500, epoch: 4 | loss: 0.6814144
	speed: 0.0121s/iter; left time: 25.5287s
Updating learning rate to 3.74953463875e-05
Epoch: 4 cost time: 6.077983856201172
Epoch: 4, Steps: 523 | Train Loss: 0.5836783 Vali Loss: 0.2872984 Best vali loss: 0.2824808
	iters: 100, epoch: 5 | loss: 0.3307304
	speed: 0.0212s/iter; left time: 42.1965s
	iters: 200, epoch: 5 | loss: 0.2575546
	speed: 0.0110s/iter; left time: 20.8890s
	iters: 300, epoch: 5 | loss: 0.3484088
	speed: 0.0118s/iter; left time: 21.2185s
	iters: 400, epoch: 5 | loss: 0.8984041
	speed: 0.0071s/iter; left time: 11.9691s
	iters: 500, epoch: 5 | loss: 0.6413478
	speed: 0.0045s/iter; left time: 7.2217s
Updating learning rate to 1.874767319375e-05
Epoch: 5 cost time: 4.422665357589722
Epoch: 5, Steps: 523 | Train Loss: 0.4952891 Vali Loss: 0.2873416 Best vali loss: 0.2824808
	iters: 100, epoch: 6 | loss: 0.2836520
	speed: 0.0195s/iter; left time: 28.6135s
	iters: 200, epoch: 6 | loss: 0.6801742
	speed: 0.0107s/iter; left time: 14.6497s
	iters: 300, epoch: 6 | loss: 0.3122089
	speed: 0.0088s/iter; left time: 11.1971s
	iters: 400, epoch: 6 | loss: 0.3554594
	speed: 0.0084s/iter; left time: 9.8647s
	iters: 500, epoch: 6 | loss: 0.2423366
	speed: 0.0095s/iter; left time: 10.2034s
Updating learning rate to 9.373836596875e-06
Epoch: 6 cost time: 5.089194297790527
Epoch: 6, Steps: 523 | Train Loss: 0.3747662 Vali Loss: 0.2872018 Best vali loss: 0.2824808
	iters: 100, epoch: 7 | loss: 0.2312198
	speed: 0.0159s/iter; left time: 15.0208s
	iters: 200, epoch: 7 | loss: 0.7719457
	speed: 0.0097s/iter; left time: 8.2501s
	iters: 300, epoch: 7 | loss: 0.2696880
	speed: 0.0097s/iter; left time: 7.2539s
	iters: 400, epoch: 7 | loss: 0.2475594
	speed: 0.0097s/iter; left time: 6.2903s
	iters: 500, epoch: 7 | loss: 0.9324739
	speed: 0.0063s/iter; left time: 3.4362s
Updating learning rate to 4.6869182984375e-06
Epoch: 7 cost time: 4.194011926651001
Epoch: 7, Steps: 523 | Train Loss: 0.4905773 Vali Loss: 0.2870608 Best vali loss: 0.2824808
	iters: 100, epoch: 8 | loss: 0.5821182
	speed: 0.0124s/iter; left time: 5.2427s
	iters: 200, epoch: 8 | loss: 0.2911490
	speed: 0.0064s/iter; left time: 2.0771s
	iters: 300, epoch: 8 | loss: 0.4852764
	speed: 0.0057s/iter; left time: 1.2788s
	iters: 400, epoch: 8 | loss: 1.2925282
	speed: 0.0062s/iter; left time: 0.7677s
	iters: 500, epoch: 8 | loss: 0.2417354
	speed: 0.0061s/iter; left time: 0.1454s
Updating learning rate to 2.34345914921875e-06
Epoch: 8 cost time: 3.2243294715881348
Epoch: 8, Steps: 523 | Train Loss: 0.5785614 Vali Loss: 0.2871757 Best vali loss: 0.2824808

best validation loss 0.2824808190240431

[INFO][smbo.py:320] Finished 100 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014600474372, 'e_layers': 3, 'learning_rate': 0.0001170962273, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6850834
	speed: 0.0143s/iter; left time: 117.8001s
	iters: 200, epoch: 1 | loss: 0.7761726
	speed: 0.0075s/iter; left time: 60.9552s
	iters: 300, epoch: 1 | loss: 0.4737368
	speed: 0.0069s/iter; left time: 55.6852s
	iters: 400, epoch: 1 | loss: 0.4836672
	speed: 0.0082s/iter; left time: 65.5782s
	iters: 500, epoch: 1 | loss: 0.2347715
	speed: 0.0078s/iter; left time: 61.4941s
	iters: 600, epoch: 1 | loss: 0.4704997
	speed: 0.0071s/iter; left time: 54.9070s
	iters: 700, epoch: 1 | loss: 0.7418414
	speed: 0.0088s/iter; left time: 67.1258s
	iters: 800, epoch: 1 | loss: 0.7980102
	speed: 0.0089s/iter; left time: 67.6008s
	iters: 900, epoch: 1 | loss: 0.4668072
	speed: 0.0086s/iter; left time: 64.4135s
	iters: 1000, epoch: 1 | loss: 0.3876998
	speed: 0.0088s/iter; left time: 64.7081s
Updating learning rate to 0.0001170962273
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 8.824392318725586
Epoch: 1, Steps: 1045 | Train Loss: 0.5518290 Vali Loss: 0.2841872 Best vali loss: 0.2841872
	iters: 100, epoch: 2 | loss: 1.3370929
	speed: 0.0267s/iter; left time: 192.3212s
	iters: 200, epoch: 2 | loss: 1.3955240
	speed: 0.0087s/iter; left time: 61.8027s
	iters: 300, epoch: 2 | loss: 0.3246988
	speed: 0.0093s/iter; left time: 65.2524s
	iters: 400, epoch: 2 | loss: 0.1993626
	speed: 0.0092s/iter; left time: 63.9573s
	iters: 500, epoch: 2 | loss: 0.6414148
	speed: 0.0093s/iter; left time: 63.1605s
	iters: 600, epoch: 2 | loss: 0.3186778
	speed: 0.0096s/iter; left time: 64.6019s
	iters: 700, epoch: 2 | loss: 1.8414154
	speed: 0.0092s/iter; left time: 61.0360s
	iters: 800, epoch: 2 | loss: 0.3659325
	speed: 0.0085s/iter; left time: 55.3084s
	iters: 900, epoch: 2 | loss: 0.9738802
	speed: 0.0082s/iter; left time: 52.4458s
	iters: 1000, epoch: 2 | loss: 0.1983629
	speed: 0.0088s/iter; left time: 55.6373s
Updating learning rate to 5.854811365e-05
Epoch: 2 cost time: 9.272069215774536
Epoch: 2, Steps: 1045 | Train Loss: 0.7596362 Vali Loss: 0.2869334 Best vali loss: 0.2841872
	iters: 100, epoch: 3 | loss: 0.3235160
	speed: 0.0309s/iter; left time: 190.7327s
	iters: 200, epoch: 3 | loss: 0.5158474
	speed: 0.0085s/iter; left time: 51.7004s
	iters: 300, epoch: 3 | loss: 0.5263632
	speed: 0.0090s/iter; left time: 53.8607s
	iters: 400, epoch: 3 | loss: 0.2244494
	speed: 0.0083s/iter; left time: 48.9256s
	iters: 500, epoch: 3 | loss: 0.2531127
	speed: 0.0079s/iter; left time: 45.6327s
	iters: 600, epoch: 3 | loss: 0.7895856
	speed: 0.0070s/iter; left time: 39.9389s
	iters: 700, epoch: 3 | loss: 0.3826118
	speed: 0.0132s/iter; left time: 73.6470s
	iters: 800, epoch: 3 | loss: 0.2547476
	speed: 0.0130s/iter; left time: 70.9442s
	iters: 900, epoch: 3 | loss: 0.2720168
	speed: 0.0129s/iter; left time: 69.5321s
	iters: 1000, epoch: 3 | loss: 0.8496754
	speed: 0.0122s/iter; left time: 64.2369s
Updating learning rate to 2.9274056825e-05
Validation loss decreased (0.2842 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 10.694891452789307
Epoch: 3, Steps: 1045 | Train Loss: 0.4391926 Vali Loss: 0.2835773 Best vali loss: 0.2835773
	iters: 100, epoch: 4 | loss: 0.7034524
	speed: 0.0408s/iter; left time: 209.0462s
	iters: 200, epoch: 4 | loss: 0.3070330
	speed: 0.0091s/iter; left time: 45.5961s
	iters: 300, epoch: 4 | loss: 0.2114633
	speed: 0.0108s/iter; left time: 53.0905s
	iters: 400, epoch: 4 | loss: 0.3105171
	speed: 0.0097s/iter; left time: 46.8828s
	iters: 500, epoch: 4 | loss: 0.6956975
	speed: 0.0080s/iter; left time: 37.6153s
	iters: 600, epoch: 4 | loss: 0.5142904
	speed: 0.0099s/iter; left time: 45.7970s
	iters: 700, epoch: 4 | loss: 0.2519488
	speed: 0.0092s/iter; left time: 41.5586s
	iters: 800, epoch: 4 | loss: 0.3131330
	speed: 0.0096s/iter; left time: 42.5468s
	iters: 900, epoch: 4 | loss: 0.2725502
	speed: 0.0094s/iter; left time: 40.8430s
	iters: 1000, epoch: 4 | loss: 1.3896762
	speed: 0.0096s/iter; left time: 40.5631s
Updating learning rate to 1.46370284125e-05
Epoch: 4 cost time: 10.025141716003418
Epoch: 4, Steps: 1045 | Train Loss: 0.4969762 Vali Loss: 0.2838545 Best vali loss: 0.2835773
	iters: 100, epoch: 5 | loss: 0.2857239
	speed: 0.0289s/iter; left time: 117.9577s
	iters: 200, epoch: 5 | loss: 0.2981578
	speed: 0.0080s/iter; left time: 31.6903s
	iters: 300, epoch: 5 | loss: 0.6192778
	speed: 0.0082s/iter; left time: 31.8482s
	iters: 400, epoch: 5 | loss: 0.2689004
	speed: 0.0083s/iter; left time: 31.5295s
	iters: 500, epoch: 5 | loss: 0.4686071
	speed: 0.0084s/iter; left time: 30.9518s
	iters: 600, epoch: 5 | loss: 0.3897513
	speed: 0.0088s/iter; left time: 31.3586s
	iters: 700, epoch: 5 | loss: 0.5072032
	speed: 0.0089s/iter; left time: 31.0737s
	iters: 800, epoch: 5 | loss: 0.3188064
	speed: 0.0088s/iter; left time: 29.7630s
	iters: 900, epoch: 5 | loss: 0.6209396
	speed: 0.0089s/iter; left time: 29.1897s
	iters: 1000, epoch: 5 | loss: 0.3570322
	speed: 0.0091s/iter; left time: 28.8570s
Updating learning rate to 7.31851420625e-06
Epoch: 5 cost time: 8.917487382888794
Epoch: 5, Steps: 1045 | Train Loss: 0.4134400 Vali Loss: 0.2847284 Best vali loss: 0.2835773
	iters: 100, epoch: 6 | loss: 0.4000738
	speed: 0.0292s/iter; left time: 88.5419s
	iters: 200, epoch: 6 | loss: 0.1890852
	speed: 0.0082s/iter; left time: 24.0284s
	iters: 300, epoch: 6 | loss: 0.3346590
	speed: 0.0080s/iter; left time: 22.8003s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008001774243, 'e_layers': 4, 'learning_rate': 8.14780285e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7518919
	speed: 0.0201s/iter; left time: 40.1176s
	iters: 200, epoch: 1 | loss: 0.4120902
	speed: 0.0136s/iter; left time: 25.7697s
Updating learning rate to 8.14780285e-05
Validation loss decreased (inf --> 0.2778).  Saving model state dict ...
Epoch: 1 cost time: 4.322987079620361
Epoch: 1, Steps: 262 | Train Loss: 0.5819910 Vali Loss: 0.2778358 Best vali loss: 0.2778358
	iters: 100, epoch: 2 | loss: 0.5006580
	speed: 0.0396s/iter; left time: 68.7338s
	iters: 200, epoch: 2 | loss: 0.5219786
	speed: 0.0165s/iter; left time: 27.0411s
Updating learning rate to 4.073901425e-05
Epoch: 2 cost time: 4.798493385314941
Epoch: 2, Steps: 262 | Train Loss: 0.5113183 Vali Loss: 0.2889480 Best vali loss: 0.2778358
	iters: 100, epoch: 3 | loss: 0.7946247
	speed: 0.0394s/iter; left time: 57.9817s
	iters: 200, epoch: 3 | loss: 0.4666939
	speed: 0.0235s/iter; left time: 32.2657s
Updating learning rate to 2.0369507125e-05
Epoch: 3 cost time: 6.092780351638794
Epoch: 3, Steps: 262 | Train Loss: 0.6306593 Vali Loss: 0.2862970 Best vali loss: 0.2778358
	iters: 100, epoch: 4 | loss: 0.2977830
	speed: 0.0496s/iter; left time: 60.0193s
	iters: 200, epoch: 4 | loss: 0.4122534
	speed: 0.0243s/iter; left time: 27.0245s
Updating learning rate to 1.01847535625e-05
Epoch: 4 cost time: 6.375884294509888
Epoch: 4, Steps: 262 | Train Loss: 0.3550182 Vali Loss: 0.2943957 Best vali loss: 0.2778358
	iters: 100, epoch: 5 | loss: 0.4396711
	speed: 0.0491s/iter; left time: 46.6174s
	iters: 200, epoch: 5 | loss: 0.4697715
	speed: 0.0241s/iter; left time: 20.4601s
Updating learning rate to 5.09237678125e-06
Epoch: 5 cost time: 6.314556121826172
Epoch: 5, Steps: 262 | Train Loss: 0.4547213 Vali Loss: 0.3048797 Best vali loss: 0.2778358
	iters: 100, epoch: 6 | loss: 0.5232760
	speed: 0.0476s/iter; left time: 32.7178s
	iters: 200, epoch: 6 | loss: 0.3680574
	speed: 0.0254s/iter; left time: 14.9051s
Updating learning rate to 2.546188390625e-06
Epoch: 6 cost time: 6.392906188964844
Epoch: 6, Steps: 262 | Train Loss: 0.4456667 Vali Loss: 0.2977229 Best vali loss: 0.2778358
	iters: 100, epoch: 7 | loss: 0.4447731
	speed: 0.0465s/iter; left time: 19.7508s
	iters: 200, epoch: 7 | loss: 0.4395992
	speed: 0.0256s/iter; left time: 8.3326s
Updating learning rate to 1.2730941953125e-06
Epoch: 7 cost time: 6.261977195739746
Epoch: 7, Steps: 262 | Train Loss: 0.4421861 Vali Loss: 0.2983321 Best vali loss: 0.2778358
	iters: 100, epoch: 8 | loss: 0.2752408
	speed: 0.0456s/iter; left time: 7.4367s
	iters: 200, epoch: 8 | loss: 0.3186066
	speed: 0.0253s/iter; left time: 1.5941s
Updating learning rate to 6.3654709765625e-07
Epoch: 8 cost time: 6.100586891174316
Epoch: 8, Steps: 262 | Train Loss: 0.2969237 Vali Loss: 0.2997369 Best vali loss: 0.2778358

best validation loss 0.27783576704980095

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0042555642414, 'e_layers': 4, 'learning_rate': 0.0033451766027, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7449472
	speed: 0.0185s/iter; left time: 152.6301s
	iters: 200, epoch: 1 | loss: 1.5295891
	speed: 0.0149s/iter; left time: 121.4194s
	iters: 300, epoch: 1 | loss: 0.5028560
	speed: 0.0147s/iter; left time: 118.3822s
	iters: 400, epoch: 1 | loss: 0.9047253
	speed: 0.0138s/iter; left time: 109.5937s
	iters: 500, epoch: 1 | loss: 0.2789063
	speed: 0.0147s/iter; left time: 115.6595s
	iters: 600, epoch: 1 | loss: 0.4890511
	speed: 0.0147s/iter; left time: 114.2219s
	iters: 700, epoch: 1 | loss: 0.3064982
	speed: 0.0095s/iter; left time: 72.9205s
	iters: 800, epoch: 1 | loss: 0.4714992
	speed: 0.0078s/iter; left time: 59.0393s
	iters: 900, epoch: 1 | loss: 0.5444573
	speed: 0.0083s/iter; left time: 61.9267s
	iters: 1000, epoch: 1 | loss: 0.3358924
	speed: 0.0082s/iter; left time: 60.6397s
Updating learning rate to 0.0032178583992850856
Validation loss decreased (inf --> 0.2984).  Saving model state dict ...
Epoch: 1 cost time: 12.698843479156494
Epoch: 1, Steps: 1045 | Train Loss: 0.6108422 Vali Loss: 0.2983605 Best vali loss: 0.2983605
	iters: 100, epoch: 2 | loss: 0.6962050
	speed: 0.0303s/iter; left time: 218.7997s
	iters: 200, epoch: 2 | loss: 0.5485065
	speed: 0.0099s/iter; left time: 70.6799s
	iters: 300, epoch: 2 | loss: 0.2664203
	speed: 0.0093s/iter; left time: 65.0034s
	iters: 400, epoch: 2 | loss: 0.1195807
	speed: 0.0094s/iter; left time: 65.3069s
	iters: 500, epoch: 2 | loss: 0.4168538
	speed: 0.0103s/iter; left time: 70.1873s
	iters: 600, epoch: 2 | loss: 0.2695056
	speed: 0.0105s/iter; left time: 70.3372s
	iters: 700, epoch: 2 | loss: 0.2051124
	speed: 0.0101s/iter; left time: 66.9174s
	iters: 800, epoch: 2 | loss: 0.5354947
	speed: 0.0096s/iter; left time: 62.6933s
	iters: 900, epoch: 2 | loss: 0.2317867
	speed: 0.0089s/iter; left time: 57.2743s
	iters: 1000, epoch: 2 | loss: 0.5149128
	speed: 0.0088s/iter; left time: 55.5331s
Updating learning rate to 0.0028552868313678737
Validation loss decreased (0.2984 --> 0.2979).  Saving model state dict ...
Epoch: 2 cost time: 10.114746570587158
Epoch: 2, Steps: 1045 | Train Loss: 0.3804379 Vali Loss: 0.2978635 Best vali loss: 0.2978635
	iters: 100, epoch: 3 | loss: 0.2855724
	speed: 0.0316s/iter; left time: 194.9206s
	iters: 200, epoch: 3 | loss: 0.6632040
	speed: 0.0139s/iter; left time: 84.6168s
	iters: 300, epoch: 3 | loss: 0.3389643
	speed: 0.0160s/iter; left time: 95.6022s
	iters: 400, epoch: 3 | loss: 0.2865186
	speed: 0.0096s/iter; left time: 56.4973s
	iters: 500, epoch: 3 | loss: 0.1727473
	speed: 0.0091s/iter; left time: 52.7160s
	iters: 600, epoch: 3 | loss: 0.5018863
	speed: 0.0088s/iter; left time: 50.0596s
	iters: 700, epoch: 3 | loss: 0.2444187
	speed: 0.0090s/iter; left time: 50.1334s
	iters: 800, epoch: 3 | loss: 0.3755827
	speed: 0.0156s/iter; left time: 85.1149s
	iters: 900, epoch: 3 | loss: 0.2036212
	speed: 0.0149s/iter; left time: 79.8453s
	iters: 1000, epoch: 3 | loss: 0.2392573
	speed: 0.0159s/iter; left time: 83.6364s
Updating learning rate to 0.0023126601334443136
Validation loss decreased (0.2979 --> 0.2909).  Saving model state dict ...
Epoch: 3 cost time: 13.240653276443481
Epoch: 3, Steps: 1045 | Train Loss: 0.3311773 Vali Loss: 0.2909072 Best vali loss: 0.2909072

best validation loss 0.290907240126735

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023938699804, 'e_layers': 1, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5238287
	speed: 0.0169s/iter; left time: 33.6959s
	iters: 200, epoch: 1 | loss: 0.5016221
	speed: 0.0086s/iter; left time: 16.3988s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.2927).  Saving model state dict ...
Epoch: 1 cost time: 2.8019137382507324
Epoch: 1, Steps: 262 | Train Loss: 0.5127254 Vali Loss: 0.2926698 Best vali loss: 0.2926698
	iters: 100, epoch: 2 | loss: 0.4060927
	speed: 0.0271s/iter; left time: 47.0515s
	iters: 200, epoch: 2 | loss: 0.3461089
	speed: 0.0072s/iter; left time: 11.7104s
Updating learning rate to 0.0014281993853242025
Epoch: 2 cost time: 2.2234208583831787
Epoch: 2, Steps: 262 | Train Loss: 0.3761008 Vali Loss: 0.2989910 Best vali loss: 0.2926698
	iters: 100, epoch: 3 | loss: 0.5643033
	speed: 0.0234s/iter; left time: 34.4263s
	iters: 200, epoch: 3 | loss: 0.5975348
	speed: 0.0086s/iter; left time: 11.8256s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 2.137876272201538
Epoch: 3, Steps: 262 | Train Loss: 0.5809191 Vali Loss: 0.3164598 Best vali loss: 0.2926698

best validation loss 0.2926697759723167

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5526433
	speed: 0.0106s/iter; left time: 87.8947s
	iters: 200, epoch: 1 | loss: 0.3242701
	speed: 0.0053s/iter; left time: 43.3506s
	iters: 300, epoch: 1 | loss: 0.7173219
	speed: 0.0055s/iter; left time: 44.3525s
	iters: 400, epoch: 1 | loss: 0.2743785
	speed: 0.0054s/iter; left time: 43.2376s
	iters: 500, epoch: 1 | loss: 0.2144217
	speed: 0.0054s/iter; left time: 42.1649s
	iters: 600, epoch: 1 | loss: 0.2736471
	speed: 0.0055s/iter; left time: 42.7260s
	iters: 700, epoch: 1 | loss: 0.2596611
	speed: 0.0055s/iter; left time: 41.7676s
	iters: 800, epoch: 1 | loss: 0.3481595
	speed: 0.0050s/iter; left time: 37.5525s
	iters: 900, epoch: 1 | loss: 0.3696861
	speed: 0.0049s/iter; left time: 36.8716s
	iters: 1000, epoch: 1 | loss: 0.3218402
	speed: 0.0051s/iter; left time: 37.6120s
Updating learning rate to 0.0002485111429
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 5.796833276748657
Epoch: 1, Steps: 1045 | Train Loss: 0.3656030 Vali Loss: 0.2812486 Best vali loss: 0.2812486
	iters: 100, epoch: 2 | loss: 0.4733663
	speed: 0.0226s/iter; left time: 163.3821s
	iters: 200, epoch: 2 | loss: 0.2025662
	speed: 0.0052s/iter; left time: 36.6987s
	iters: 300, epoch: 2 | loss: 0.5354497
	speed: 0.0048s/iter; left time: 33.6843s
	iters: 400, epoch: 2 | loss: 0.4007703
	speed: 0.0047s/iter; left time: 32.3208s
	iters: 500, epoch: 2 | loss: 0.2589484
	speed: 0.0045s/iter; left time: 30.9179s
	iters: 600, epoch: 2 | loss: 0.3440189
	speed: 0.0049s/iter; left time: 33.2223s
	iters: 700, epoch: 2 | loss: 0.1582497
	speed: 0.0053s/iter; left time: 34.8819s
	iters: 800, epoch: 2 | loss: 0.3785646
	speed: 0.0054s/iter; left time: 35.0939s
	iters: 900, epoch: 2 | loss: 0.5147941
	speed: 0.0054s/iter; left time: 34.5628s
	iters: 1000, epoch: 2 | loss: 0.3901884
	speed: 0.0054s/iter; left time: 34.2319s
Updating learning rate to 0.00012425557145
Epoch: 2 cost time: 5.376802682876587
Epoch: 2, Steps: 1045 | Train Loss: 0.3656917 Vali Loss: 0.2913642 Best vali loss: 0.2812486
	iters: 100, epoch: 3 | loss: 0.4461822
	speed: 0.0212s/iter; left time: 130.5425s
	iters: 200, epoch: 3 | loss: 0.2522370
	speed: 0.0053s/iter; left time: 32.4203s
	iters: 300, epoch: 3 | loss: 0.2586259
	speed: 0.0053s/iter; left time: 31.4631s
	iters: 400, epoch: 3 | loss: 0.2902486
	speed: 0.0053s/iter; left time: 31.2214s
	iters: 500, epoch: 3 | loss: 0.9942562
	speed: 0.0054s/iter; left time: 30.9999s
	iters: 600, epoch: 3 | loss: 0.1366129
	speed: 0.0057s/iter; left time: 32.1209s
	iters: 700, epoch: 3 | loss: 0.3385690
	speed: 0.0056s/iter; left time: 31.3702s
	iters: 800, epoch: 3 | loss: 0.3904034
	speed: 0.0055s/iter; left time: 29.9339s
	iters: 900, epoch: 3 | loss: 0.4752820
	speed: 0.0046s/iter; left time: 24.5820s
	iters: 1000, epoch: 3 | loss: 0.5279776
	speed: 0.0047s/iter; left time: 24.5301s
Updating learning rate to 6.2127785725e-05
Epoch: 3 cost time: 5.513124704360962
Epoch: 3, Steps: 1045 | Train Loss: 0.4110395 Vali Loss: 0.2983128 Best vali loss: 0.2812486

best validation loss 0.2812485851655001

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3779100
	speed: 0.0118s/iter; left time: 60.2632s
	iters: 200, epoch: 4 | loss: 0.2604761
	speed: 0.0053s/iter; left time: 26.6852s
	iters: 300, epoch: 4 | loss: 0.6308694
	speed: 0.0054s/iter; left time: 26.4936s
	iters: 400, epoch: 4 | loss: 0.2105141
	speed: 0.0053s/iter; left time: 25.8023s
	iters: 500, epoch: 4 | loss: 0.1920858
	speed: 0.0053s/iter; left time: 25.0597s
	iters: 600, epoch: 4 | loss: 0.2886353
	speed: 0.0053s/iter; left time: 24.6614s
	iters: 700, epoch: 4 | loss: 0.2510408
	speed: 0.0053s/iter; left time: 24.0549s
	iters: 800, epoch: 4 | loss: 0.3432791
	speed: 0.0053s/iter; left time: 23.5854s
	iters: 900, epoch: 4 | loss: 0.3182456
	speed: 0.0053s/iter; left time: 22.8504s
	iters: 1000, epoch: 4 | loss: 0.2738572
	speed: 0.0053s/iter; left time: 22.4611s
Updating learning rate to 3.10638928625e-05
Epoch: 4 cost time: 5.910295724868774
Epoch: 4, Steps: 1045 | Train Loss: 0.3146913 Vali Loss: 0.3040135 Best vali loss: 0.2812486
	iters: 100, epoch: 5 | loss: 0.3725190
	speed: 0.0198s/iter; left time: 80.6558s
	iters: 200, epoch: 5 | loss: 0.1840946
	speed: 0.0050s/iter; left time: 19.9066s
	iters: 300, epoch: 5 | loss: 0.3167195
	speed: 0.0049s/iter; left time: 18.9719s
	iters: 400, epoch: 5 | loss: 0.2865196
	speed: 0.0051s/iter; left time: 19.3366s
	iters: 500, epoch: 5 | loss: 0.1915390
	speed: 0.0052s/iter; left time: 19.1535s
	iters: 600, epoch: 5 | loss: 0.3157845
	speed: 0.0054s/iter; left time: 19.1848s
	iters: 700, epoch: 5 | loss: 0.1422502
	speed: 0.0054s/iter; left time: 18.8172s
	iters: 800, epoch: 5 | loss: 0.3867940
	speed: 0.0054s/iter; left time: 18.3858s
	iters: 900, epoch: 5 | loss: 0.2855714
	speed: 0.0054s/iter; left time: 17.8224s
	iters: 1000, epoch: 5 | loss: 0.2775692
	speed: 0.0055s/iter; left time: 17.4970s
Updating learning rate to 1.553194643125e-05
Epoch: 5 cost time: 5.478010654449463
Epoch: 5, Steps: 1045 | Train Loss: 0.2759361 Vali Loss: 0.3001733 Best vali loss: 0.2812486
	iters: 100, epoch: 6 | loss: 0.4069255
	speed: 0.0219s/iter; left time: 66.4528s
	iters: 200, epoch: 6 | loss: 0.2544116
	speed: 0.0052s/iter; left time: 15.3611s
	iters: 300, epoch: 6 | loss: 0.1834377
	speed: 0.0051s/iter; left time: 14.5438s
	iters: 400, epoch: 6 | loss: 0.2726646
	speed: 0.0050s/iter; left time: 13.7525s
	iters: 500, epoch: 6 | loss: 0.6330619
	speed: 0.0047s/iter; left time: 12.4804s
	iters: 600, epoch: 6 | loss: 0.1271902
	speed: 0.0045s/iter; left time: 11.3877s
	iters: 700, epoch: 6 | loss: 0.3180595
	speed: 0.0044s/iter; left time: 10.6605s
	iters: 800, epoch: 6 | loss: 0.2962448
	speed: 0.0046s/iter; left time: 10.6932s
	iters: 900, epoch: 6 | loss: 0.4395719
	speed: 0.0053s/iter; left time: 11.7424s
	iters: 1000, epoch: 6 | loss: 0.4059103
	speed: 0.0055s/iter; left time: 11.6871s
Updating learning rate to 7.765973215625e-06
Epoch: 6 cost time: 5.239732503890991
Epoch: 6, Steps: 1045 | Train Loss: 0.3337478 Vali Loss: 0.3040984 Best vali loss: 0.2812486
	iters: 100, epoch: 7 | loss: 0.4768782
	speed: 0.0225s/iter; left time: 44.8728s
	iters: 200, epoch: 7 | loss: 0.3925562
	speed: 0.0052s/iter; left time: 9.9211s
	iters: 300, epoch: 7 | loss: 0.4315043
	speed: 0.0054s/iter; left time: 9.6831s
	iters: 400, epoch: 7 | loss: 0.3089429
	speed: 0.0053s/iter; left time: 9.0265s
	iters: 500, epoch: 7 | loss: 0.4078166
	speed: 0.0053s/iter; left time: 8.3551s
	iters: 600, epoch: 7 | loss: 0.2697749
	speed: 0.0052s/iter; left time: 7.8061s
	iters: 700, epoch: 7 | loss: 0.2743538
	speed: 0.0053s/iter; left time: 7.3200s
	iters: 800, epoch: 7 | loss: 0.8286360
	speed: 0.0052s/iter; left time: 6.7530s
	iters: 900, epoch: 7 | loss: 0.2932391
	speed: 0.0049s/iter; left time: 5.8919s
	iters: 1000, epoch: 7 | loss: 0.5251082
	speed: 0.0045s/iter; left time: 4.9399s
Updating learning rate to 3.8829866078125e-06
Epoch: 7 cost time: 5.442737102508545
Epoch: 7, Steps: 1045 | Train Loss: 0.4208810 Vali Loss: 0.3071298 Best vali loss: 0.2812486
	iters: 100, epoch: 8 | loss: 0.3538539
	speed: 0.0174s/iter; left time: 16.4487s
	iters: 200, epoch: 8 | loss: 0.2866681
	speed: 0.0056s/iter; left time: 4.7575s
	iters: 300, epoch: 8 | loss: 0.5575994
	speed: 0.0053s/iter; left time: 3.9429s
	iters: 400, epoch: 8 | loss: 0.3484362
	speed: 0.0057s/iter; left time: 3.6585s
	iters: 500, epoch: 8 | loss: 0.1972264
	speed: 0.0055s/iter; left time: 3.0158s
	iters: 600, epoch: 8 | loss: 0.4180933
	speed: 0.0057s/iter; left time: 2.5575s
	iters: 700, epoch: 8 | loss: 0.1767617
	speed: 0.0056s/iter; left time: 1.9244s
	iters: 800, epoch: 8 | loss: 0.2810000
	speed: 0.0055s/iter; left time: 1.3622s
	iters: 900, epoch: 8 | loss: 0.2449319
	speed: 0.0062s/iter; left time: 0.9032s
	iters: 1000, epoch: 8 | loss: 0.5501878
	speed: 0.0063s/iter; left time: 0.2891s
Updating learning rate to 1.94149330390625e-06
Epoch: 8 cost time: 5.954850196838379
Epoch: 8, Steps: 1045 | Train Loss: 0.3414759 Vali Loss: 0.3069844 Best vali loss: 0.2812486

best validation loss 0.2812485851655001

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010455579744, 'e_layers': 2, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6895390
	speed: 0.0229s/iter; left time: 21.7448s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.3178).  Saving model state dict ...
Epoch: 1 cost time: 2.380342721939087
Epoch: 1, Steps: 131 | Train Loss: 0.6895390 Vali Loss: 0.3177605 Best vali loss: 0.3177605
	iters: 100, epoch: 2 | loss: 0.4182611
	speed: 0.0349s/iter; left time: 28.5632s
Updating learning rate to 0.0026738530511141692
Validation loss decreased (0.3178 --> 0.3092).  Saving model state dict ...
Epoch: 2 cost time: 3.0666708946228027
Epoch: 2, Steps: 131 | Train Loss: 0.4182611 Vali Loss: 0.3092369 Best vali loss: 0.3092369
	iters: 100, epoch: 3 | loss: 0.5982056
	speed: 0.0269s/iter; left time: 18.4765s
Updating learning rate to 0.002165706536403478
Validation loss decreased (0.3092 --> 0.3066).  Saving model state dict ...
Epoch: 3 cost time: 1.8418781757354736
Epoch: 3, Steps: 131 | Train Loss: 0.5982056 Vali Loss: 0.3065596 Best vali loss: 0.3065596
	iters: 100, epoch: 4 | loss: 0.4690255
	speed: 0.0241s/iter; left time: 13.4188s
Updating learning rate to 0.00156630685355
Validation loss decreased (0.3066 --> 0.3049).  Saving model state dict ...
Epoch: 4 cost time: 2.0112855434417725
Epoch: 4, Steps: 131 | Train Loss: 0.4690255 Vali Loss: 0.3048506 Best vali loss: 0.3048506
	iters: 100, epoch: 5 | loss: 0.4509936
	speed: 0.0289s/iter; left time: 12.2785s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 2.0928807258605957
Epoch: 5, Steps: 131 | Train Loss: 0.4509936 Vali Loss: 0.3232615 Best vali loss: 0.3048506
	iters: 100, epoch: 6 | loss: 0.3777263
	speed: 0.0229s/iter; left time: 6.7222s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 1.8483657836914062
Epoch: 6, Steps: 131 | Train Loss: 0.3777263 Vali Loss: 0.3345021 Best vali loss: 0.3048506
	iters: 100, epoch: 7 | loss: 0.3916743
	speed: 0.0244s/iter; left time: 3.9824s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 2.150322675704956
Epoch: 7, Steps: 131 | Train Loss: 0.3916743 Vali Loss: 0.3446973 Best vali loss: 0.3048506
	iters: 100, epoch: 8 | loss: 0.5421095
	speed: 0.0280s/iter; left time: 0.8968s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.0792176723480225
Epoch: 8, Steps: 131 | Train Loss: 0.5421095 Vali Loss: 0.3500532 Best vali loss: 0.3048506

best validation loss 0.3048505516533694

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014539170207, 'e_layers': 1, 'learning_rate': 0.0026890067218, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5842882
	speed: 0.0175s/iter; left time: 16.6379s
Updating learning rate to 0.0025866624974281455
Validation loss decreased (inf --> 0.2971).  Saving model state dict ...
Epoch: 1 cost time: 1.770324945449829
Epoch: 1, Steps: 131 | Train Loss: 0.5842882 Vali Loss: 0.2971261 Best vali loss: 0.2971261
	iters: 100, epoch: 2 | loss: 0.4214816
	speed: 0.0221s/iter; left time: 18.1023s
Updating learning rate to 0.002295210804720494
Validation loss decreased (0.2971 --> 0.2924).  Saving model state dict ...
Epoch: 2 cost time: 1.9293248653411865
Epoch: 2, Steps: 131 | Train Loss: 0.4214816 Vali Loss: 0.2924492 Best vali loss: 0.2924492
	iters: 100, epoch: 3 | loss: 0.6499908
	speed: 0.0217s/iter; left time: 14.9393s
Updating learning rate to 0.001859022521875611
Epoch: 3 cost time: 1.3307280540466309
Epoch: 3, Steps: 131 | Train Loss: 0.6499908 Vali Loss: 0.3001836 Best vali loss: 0.2924492
	iters: 100, epoch: 4 | loss: 0.6018677
	speed: 0.0183s/iter; left time: 10.1732s
Updating learning rate to 0.0013445033609
Epoch: 4 cost time: 1.311241626739502
Epoch: 4, Steps: 131 | Train Loss: 0.6018677 Vali Loss: 0.2971770 Best vali loss: 0.2924492
	iters: 100, epoch: 5 | loss: 0.3372373
	speed: 0.0233s/iter; left time: 9.8884s
Updating learning rate to 0.000829984199924389
Epoch: 5 cost time: 2.1850521564483643
Epoch: 5, Steps: 131 | Train Loss: 0.3372373 Vali Loss: 0.3166022 Best vali loss: 0.2924492
	iters: 100, epoch: 6 | loss: 0.3233844
	speed: 0.0211s/iter; left time: 6.2122s
Updating learning rate to 0.00039379591707950604
Epoch: 6 cost time: 1.3037784099578857
Epoch: 6, Steps: 131 | Train Loss: 0.3233844 Vali Loss: 0.3226285 Best vali loss: 0.2924492
	iters: 100, epoch: 7 | loss: 0.4052654
	speed: 0.0176s/iter; left time: 2.8637s
Updating learning rate to 0.00010234422437185415
Epoch: 7 cost time: 1.3261401653289795
Epoch: 7, Steps: 131 | Train Loss: 0.4052654 Vali Loss: 0.3326438 Best vali loss: 0.2924492
	iters: 100, epoch: 8 | loss: 0.3012086
	speed: 0.0224s/iter; left time: 0.7167s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8487184047698975
Epoch: 8, Steps: 131 | Train Loss: 0.3012086 Vali Loss: 0.3473337 Best vali loss: 0.2924492

best validation loss 0.2924492427211306

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0051563633661, 'e_layers': 4, 'learning_rate': 0.0001081267842, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4358929
	speed: 0.0274s/iter; left time: 111.8863s
	iters: 200, epoch: 1 | loss: 0.3226757
	speed: 0.0170s/iter; left time: 67.5638s
	iters: 300, epoch: 1 | loss: 1.4019547
	speed: 0.0185s/iter; left time: 72.0064s
	iters: 400, epoch: 1 | loss: 0.8311498
	speed: 0.0198s/iter; left time: 74.7970s
	iters: 500, epoch: 1 | loss: 0.3849358
	speed: 0.0177s/iter; left time: 65.2041s
Updating learning rate to 0.00010401145351932239
Validation loss decreased (inf --> 0.3048).  Saving model state dict ...
Epoch: 1 cost time: 10.11489486694336
Epoch: 1, Steps: 523 | Train Loss: 0.6753218 Vali Loss: 0.3048445 Best vali loss: 0.3048445
	iters: 100, epoch: 2 | loss: 0.7715452
	speed: 0.0279s/iter; left time: 99.5151s
	iters: 200, epoch: 2 | loss: 0.2582426
	speed: 0.0093s/iter; left time: 32.1736s
	iters: 300, epoch: 2 | loss: 1.1777514
	speed: 0.0085s/iter; left time: 28.6410s
	iters: 400, epoch: 2 | loss: 0.3298565
	speed: 0.0098s/iter; left time: 32.0531s
	iters: 500, epoch: 2 | loss: 0.4147242
	speed: 0.0101s/iter; left time: 32.0662s
Updating learning rate to 9.229198326785722e-05
Validation loss decreased (0.3048 --> 0.2942).  Saving model state dict ...
Epoch: 2 cost time: 5.383205413818359
Epoch: 2, Steps: 523 | Train Loss: 0.5904240 Vali Loss: 0.2942275 Best vali loss: 0.2942275
	iters: 100, epoch: 3 | loss: 0.4143919
	speed: 0.0196s/iter; left time: 59.6895s
	iters: 200, epoch: 3 | loss: 0.4464267
	speed: 0.0098s/iter; left time: 28.7057s
	iters: 300, epoch: 3 | loss: 0.5595812
	speed: 0.0096s/iter; left time: 27.2244s
	iters: 400, epoch: 3 | loss: 0.7459742
	speed: 0.0093s/iter; left time: 25.3735s
	iters: 500, epoch: 3 | loss: 1.4275142
	speed: 0.0092s/iter; left time: 24.2320s
Updating learning rate to 7.475255655412767e-05
Validation loss decreased (0.2942 --> 0.2888).  Saving model state dict ...
Epoch: 3 cost time: 4.999107122421265
Epoch: 3, Steps: 523 | Train Loss: 0.7187777 Vali Loss: 0.2887922 Best vali loss: 0.2887922

best validation loss 0.2887921775914604

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3678895
	speed: 0.0128s/iter; left time: 105.7901s
	iters: 200, epoch: 1 | loss: 1.5629160
	speed: 0.0068s/iter; left time: 55.3486s
	iters: 300, epoch: 1 | loss: 0.2213631
	speed: 0.0065s/iter; left time: 52.4422s
	iters: 400, epoch: 1 | loss: 0.1894414
	speed: 0.0058s/iter; left time: 46.2478s
	iters: 500, epoch: 1 | loss: 0.9318686
	speed: 0.0054s/iter; left time: 42.5581s
	iters: 600, epoch: 1 | loss: 0.5270708
	speed: 0.0075s/iter; left time: 57.8602s
	iters: 700, epoch: 1 | loss: 0.3532255
	speed: 0.0070s/iter; left time: 53.5403s
	iters: 800, epoch: 1 | loss: 0.8956394
	speed: 0.0074s/iter; left time: 55.7831s
	iters: 900, epoch: 1 | loss: 0.2563230
	speed: 0.0069s/iter; left time: 51.2684s
	iters: 1000, epoch: 1 | loss: 0.4939550
	speed: 0.0061s/iter; left time: 45.2675s
Updating learning rate to 0.0005849557155
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 7.205567836761475
Epoch: 1, Steps: 1045 | Train Loss: 0.5799692 Vali Loss: 0.2852655 Best vali loss: 0.2852655
	iters: 100, epoch: 2 | loss: 0.2634806
	speed: 0.0218s/iter; left time: 157.4743s
	iters: 200, epoch: 2 | loss: 0.1831378
	speed: 0.0071s/iter; left time: 50.5739s
	iters: 300, epoch: 2 | loss: 0.3103816
	speed: 0.0069s/iter; left time: 48.2551s
	iters: 400, epoch: 2 | loss: 1.2050509
	speed: 0.0066s/iter; left time: 45.8801s
	iters: 500, epoch: 2 | loss: 0.8359732
	speed: 0.0068s/iter; left time: 46.1810s
	iters: 600, epoch: 2 | loss: 1.0482446
	speed: 0.0070s/iter; left time: 46.8941s
	iters: 700, epoch: 2 | loss: 0.5779238
	speed: 0.0066s/iter; left time: 43.9804s
	iters: 800, epoch: 2 | loss: 0.4072427
	speed: 0.0069s/iter; left time: 44.8804s
	iters: 900, epoch: 2 | loss: 0.3632905
	speed: 0.0071s/iter; left time: 45.2549s
	iters: 1000, epoch: 2 | loss: 0.2966986
	speed: 0.0071s/iter; left time: 44.7713s
Updating learning rate to 0.00029247785775
Validation loss decreased (0.2853 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 7.219562768936157
Epoch: 2, Steps: 1045 | Train Loss: 0.5491424 Vali Loss: 0.2818517 Best vali loss: 0.2818517
	iters: 100, epoch: 3 | loss: 1.3444511
	speed: 0.0224s/iter; left time: 138.0560s
	iters: 200, epoch: 3 | loss: 0.2877151
	speed: 0.0069s/iter; left time: 41.8817s
	iters: 300, epoch: 3 | loss: 0.8316966
	speed: 0.0070s/iter; left time: 42.0534s
	iters: 400, epoch: 3 | loss: 0.3880877
	speed: 0.0074s/iter; left time: 43.2334s
	iters: 500, epoch: 3 | loss: 0.5955710
	speed: 0.0069s/iter; left time: 39.8730s
	iters: 600, epoch: 3 | loss: 0.4839004
	speed: 0.0075s/iter; left time: 42.4155s
	iters: 700, epoch: 3 | loss: 0.2213751
	speed: 0.0058s/iter; left time: 32.4756s
	iters: 800, epoch: 3 | loss: 0.2494425
	speed: 0.0049s/iter; left time: 26.9904s
	iters: 900, epoch: 3 | loss: 0.3614761
	speed: 0.0049s/iter; left time: 26.2164s
	iters: 1000, epoch: 3 | loss: 0.3954605
	speed: 0.0070s/iter; left time: 37.0251s
Updating learning rate to 0.000146238928875
Epoch: 3 cost time: 6.826211452484131
Epoch: 3, Steps: 1045 | Train Loss: 0.5159176 Vali Loss: 0.2926868 Best vali loss: 0.2818517

best validation loss 0.2818517185811351

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3069940
	speed: 0.0176s/iter; left time: 145.0502s
	iters: 200, epoch: 1 | loss: 0.7160141
	speed: 0.0097s/iter; left time: 79.4212s
	iters: 300, epoch: 1 | loss: 0.3359448
	speed: 0.0095s/iter; left time: 76.7337s
	iters: 400, epoch: 1 | loss: 0.6916814
	speed: 0.0078s/iter; left time: 62.0365s
	iters: 500, epoch: 1 | loss: 0.4834152
	speed: 0.0072s/iter; left time: 56.8974s
	iters: 600, epoch: 1 | loss: 0.2117225
	speed: 0.0097s/iter; left time: 75.3224s
	iters: 700, epoch: 1 | loss: 1.2944843
	speed: 0.0128s/iter; left time: 97.6926s
	iters: 800, epoch: 1 | loss: 0.3726177
	speed: 0.0124s/iter; left time: 93.3894s
	iters: 900, epoch: 1 | loss: 0.4726994
	speed: 0.0111s/iter; left time: 83.0411s
	iters: 1000, epoch: 1 | loss: 0.8029683
	speed: 0.0126s/iter; left time: 92.8278s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.2893).  Saving model state dict ...
Epoch: 1 cost time: 11.245869636535645
Epoch: 1, Steps: 1045 | Train Loss: 0.5688542 Vali Loss: 0.2893076 Best vali loss: 0.2893076
	iters: 100, epoch: 2 | loss: 0.3171771
	speed: 0.0347s/iter; left time: 250.0889s
	iters: 200, epoch: 2 | loss: 0.8270590
	speed: 0.0099s/iter; left time: 70.1250s
	iters: 300, epoch: 2 | loss: 0.8260513
	speed: 0.0110s/iter; left time: 77.1643s
	iters: 400, epoch: 2 | loss: 0.5182074
	speed: 0.0127s/iter; left time: 87.9150s
	iters: 500, epoch: 2 | loss: 0.2265671
	speed: 0.0111s/iter; left time: 75.9103s
	iters: 600, epoch: 2 | loss: 0.4194104
	speed: 0.0118s/iter; left time: 78.9274s
	iters: 700, epoch: 2 | loss: 0.2538637
	speed: 0.0102s/iter; left time: 67.6991s
	iters: 800, epoch: 2 | loss: 1.5482407
	speed: 0.0117s/iter; left time: 76.4785s
	iters: 900, epoch: 2 | loss: 0.3702432
	speed: 0.0125s/iter; left time: 79.9547s
	iters: 1000, epoch: 2 | loss: 0.2178724
	speed: 0.0119s/iter; left time: 75.1955s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.2893 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 11.934691190719604
Epoch: 2, Steps: 1045 | Train Loss: 0.5524692 Vali Loss: 0.2829204 Best vali loss: 0.2829204
	iters: 100, epoch: 3 | loss: 0.9505225
	speed: 0.0318s/iter; left time: 195.9627s
	iters: 200, epoch: 3 | loss: 0.3140688
	speed: 0.0118s/iter; left time: 71.3964s
	iters: 300, epoch: 3 | loss: 0.3219434
	speed: 0.0127s/iter; left time: 75.6121s
	iters: 400, epoch: 3 | loss: 0.5950058
	speed: 0.0117s/iter; left time: 68.7667s
	iters: 500, epoch: 3 | loss: 0.3572009
	speed: 0.0102s/iter; left time: 59.0627s
	iters: 600, epoch: 3 | loss: 0.3118716
	speed: 0.0115s/iter; left time: 65.0889s
	iters: 700, epoch: 3 | loss: 0.3398941
	speed: 0.0128s/iter; left time: 71.4246s
	iters: 800, epoch: 3 | loss: 0.1339739
	speed: 0.0121s/iter; left time: 66.3674s
	iters: 900, epoch: 3 | loss: 0.2822660
	speed: 0.0109s/iter; left time: 58.3541s
	iters: 1000, epoch: 3 | loss: 0.5210187
	speed: 0.0123s/iter; left time: 65.0410s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 12.375454425811768
Epoch: 3, Steps: 1045 | Train Loss: 0.4127766 Vali Loss: 0.2841075 Best vali loss: 0.2829204

best validation loss 0.28292036942054277

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3244047
	speed: 0.0144s/iter; left time: 73.6928s
	iters: 200, epoch: 4 | loss: 1.5307930
	speed: 0.0064s/iter; left time: 32.0847s
	iters: 300, epoch: 4 | loss: 0.1896928
	speed: 0.0054s/iter; left time: 26.3793s
	iters: 400, epoch: 4 | loss: 0.1730139
	speed: 0.0100s/iter; left time: 48.4349s
	iters: 500, epoch: 4 | loss: 0.9195782
	speed: 0.0102s/iter; left time: 48.3038s
	iters: 600, epoch: 4 | loss: 0.4066714
	speed: 0.0099s/iter; left time: 45.7700s
	iters: 700, epoch: 4 | loss: 0.3517250
	speed: 0.0111s/iter; left time: 50.1058s
	iters: 800, epoch: 4 | loss: 0.7036605
	speed: 0.0119s/iter; left time: 52.6351s
	iters: 900, epoch: 4 | loss: 0.2369842
	speed: 0.0116s/iter; left time: 50.0370s
	iters: 1000, epoch: 4 | loss: 0.5200151
	speed: 0.0114s/iter; left time: 47.9771s
Updating learning rate to 7.31194644375e-05
Epoch: 4 cost time: 10.311134576797485
Epoch: 4, Steps: 1045 | Train Loss: 0.5356539 Vali Loss: 0.2933235 Best vali loss: 0.2818517
	iters: 100, epoch: 5 | loss: 0.2585767
	speed: 0.0346s/iter; left time: 141.2866s
	iters: 200, epoch: 5 | loss: 0.1861510
	speed: 0.0063s/iter; left time: 24.9519s
	iters: 300, epoch: 5 | loss: 0.2938263
	speed: 0.0083s/iter; left time: 32.4031s
	iters: 400, epoch: 5 | loss: 0.9798924
	speed: 0.0085s/iter; left time: 32.2282s
	iters: 500, epoch: 5 | loss: 0.7245126
	speed: 0.0082s/iter; left time: 30.3554s
	iters: 600, epoch: 5 | loss: 0.8986454
	speed: 0.0078s/iter; left time: 28.0395s
	iters: 700, epoch: 5 | loss: 0.5620949
	speed: 0.0081s/iter; left time: 28.0512s
	iters: 800, epoch: 5 | loss: 0.4050986
	speed: 0.0079s/iter; left time: 26.5986s
	iters: 900, epoch: 5 | loss: 0.3588828
	speed: 0.0067s/iter; left time: 22.1358s
	iters: 1000, epoch: 5 | loss: 0.2711468
	speed: 0.0057s/iter; left time: 18.0080s
Updating learning rate to 3.655973221875e-05
Epoch: 5 cost time: 7.523963451385498
Epoch: 5, Steps: 1045 | Train Loss: 0.4938828 Vali Loss: 0.2940937 Best vali loss: 0.2818517
	iters: 100, epoch: 6 | loss: 1.2203807
	speed: 0.0236s/iter; left time: 71.5817s
	iters: 200, epoch: 6 | loss: 0.2792512
	speed: 0.0102s/iter; left time: 29.8234s
	iters: 300, epoch: 6 | loss: 0.8949463
	speed: 0.0070s/iter; left time: 19.8103s
	iters: 400, epoch: 6 | loss: 0.3747893
	speed: 0.0118s/iter; left time: 32.2134s
	iters: 500, epoch: 6 | loss: 0.5852917
	speed: 0.0133s/iter; left time: 35.0124s
	iters: 600, epoch: 6 | loss: 0.5047910
	speed: 0.0122s/iter; left time: 30.9922s
	iters: 700, epoch: 6 | loss: 0.2124850
	speed: 0.0114s/iter; left time: 27.8871s
	iters: 800, epoch: 6 | loss: 0.2062447
	speed: 0.0103s/iter; left time: 24.0213s
	iters: 900, epoch: 6 | loss: 0.3612870
	speed: 0.0116s/iter; left time: 26.0338s
	iters: 1000, epoch: 6 | loss: 0.3517829
	speed: 0.0117s/iter; left time: 24.9855s
Updating learning rate to 1.8279866109375e-05
Epoch: 6 cost time: 11.493133306503296
Epoch: 6, Steps: 1045 | Train Loss: 0.4991250 Vali Loss: 0.2953640 Best vali loss: 0.2818517
	iters: 100, epoch: 7 | loss: 0.3446192
	speed: 0.0351s/iter; left time: 69.8848s
	iters: 200, epoch: 7 | loss: 0.1854776
	speed: 0.0101s/iter; left time: 19.0548s
	iters: 300, epoch: 7 | loss: 1.1671848
	speed: 0.0078s/iter; left time: 13.9171s
	iters: 400, epoch: 7 | loss: 0.7886814
	speed: 0.0093s/iter; left time: 15.6796s
	iters: 500, epoch: 7 | loss: 0.2296194
	speed: 0.0085s/iter; left time: 13.5427s
	iters: 600, epoch: 7 | loss: 0.4308701
	speed: 0.0083s/iter; left time: 12.4228s
	iters: 700, epoch: 7 | loss: 1.1821131
	speed: 0.0091s/iter; left time: 12.5916s
	iters: 800, epoch: 7 | loss: 0.7370149
	speed: 0.0095s/iter; left time: 12.2614s
	iters: 900, epoch: 7 | loss: 0.2470572
	speed: 0.0098s/iter; left time: 11.6595s
	iters: 1000, epoch: 7 | loss: 0.2272374
	speed: 0.0098s/iter; left time: 10.7022s
Updating learning rate to 9.1399330546875e-06
Epoch: 7 cost time: 9.56041955947876
Epoch: 7, Steps: 1045 | Train Loss: 0.5539875 Vali Loss: 0.2952575 Best vali loss: 0.2818517
	iters: 100, epoch: 8 | loss: 0.4678749
	speed: 0.0285s/iter; left time: 26.9421s
	iters: 200, epoch: 8 | loss: 0.2949201
	speed: 0.0085s/iter; left time: 7.2279s
	iters: 300, epoch: 8 | loss: 0.3147559
	speed: 0.0085s/iter; left time: 6.3279s
	iters: 400, epoch: 8 | loss: 0.7131637
	speed: 0.0087s/iter; left time: 5.5927s
	iters: 500, epoch: 8 | loss: 0.3845416
	speed: 0.0083s/iter; left time: 4.5511s
	iters: 600, epoch: 8 | loss: 0.3914648
	speed: 0.0091s/iter; left time: 4.0446s
	iters: 700, epoch: 8 | loss: 1.0691088
	speed: 0.0071s/iter; left time: 2.4493s
	iters: 800, epoch: 8 | loss: 1.2215476
	speed: 0.0068s/iter; left time: 1.6695s
	iters: 900, epoch: 8 | loss: 0.6667264
	speed: 0.0072s/iter; left time: 1.0460s
	iters: 1000, epoch: 8 | loss: 0.1994583
	speed: 0.0086s/iter; left time: 0.3940s
Updating learning rate to 4.56996652734375e-06
Epoch: 8 cost time: 8.555130958557129
Epoch: 8, Steps: 1045 | Train Loss: 0.5723562 Vali Loss: 0.2950091 Best vali loss: 0.2818517

best validation loss 0.2818517185811351

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018403809852, 'e_layers': 2, 'learning_rate': 0.0001571149601, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7767588
	speed: 0.0195s/iter; left time: 18.4616s
Updating learning rate to 0.00015113512799385873
Validation loss decreased (inf --> 0.3059).  Saving model state dict ...
Epoch: 1 cost time: 2.2201125621795654
Epoch: 1, Steps: 131 | Train Loss: 0.7767588 Vali Loss: 0.3059375 Best vali loss: 0.3059375
	iters: 100, epoch: 2 | loss: 0.3233068
	speed: 0.0240s/iter; left time: 19.6641s
Updating learning rate to 0.0001341060069062819
Validation loss decreased (0.3059 --> 0.2892).  Saving model state dict ...
Epoch: 2 cost time: 1.4928290843963623
Epoch: 2, Steps: 131 | Train Loss: 0.3233068 Vali Loss: 0.2891615 Best vali loss: 0.2891615
	iters: 100, epoch: 3 | loss: 0.4580484
	speed: 0.0187s/iter; left time: 12.8669s
Updating learning rate to 0.00010862012615348607
Validation loss decreased (0.2892 --> 0.2844).  Saving model state dict ...
Epoch: 3 cost time: 1.50559401512146
Epoch: 3, Steps: 131 | Train Loss: 0.4580484 Vali Loss: 0.2843594 Best vali loss: 0.2843594
	iters: 100, epoch: 4 | loss: 0.5592247
	speed: 0.0287s/iter; left time: 15.9401s
Updating learning rate to 7.855748005e-05
Validation loss decreased (0.2844 --> 0.2820).  Saving model state dict ...
Epoch: 4 cost time: 2.4237751960754395
Epoch: 4, Steps: 131 | Train Loss: 0.5592247 Vali Loss: 0.2819846 Best vali loss: 0.2819846
	iters: 100, epoch: 5 | loss: 0.6377678
	speed: 0.0259s/iter; left time: 11.0144s
Updating learning rate to 4.849483394651394e-05
Validation loss decreased (0.2820 --> 0.2817).  Saving model state dict ...
Epoch: 5 cost time: 2.4953510761260986
Epoch: 5, Steps: 131 | Train Loss: 0.6377678 Vali Loss: 0.2816628 Best vali loss: 0.2816628
	iters: 100, epoch: 6 | loss: 0.7304971
	speed: 0.0182s/iter; left time: 5.3551s
Updating learning rate to 2.3008953193718083e-05
Validation loss decreased (0.2817 --> 0.2816).  Saving model state dict ...
Epoch: 6 cost time: 1.0826959609985352
Epoch: 6, Steps: 131 | Train Loss: 0.7304971 Vali Loss: 0.2816206 Best vali loss: 0.2816206
	iters: 100, epoch: 7 | loss: 0.6871402
	speed: 0.0134s/iter; left time: 2.1845s
Updating learning rate to 5.979832106141266e-06
Validation loss decreased (0.2816 --> 0.2816).  Saving model state dict ...
Epoch: 7 cost time: 1.082857370376587
Epoch: 7, Steps: 131 | Train Loss: 0.6871402 Vali Loss: 0.2816001 Best vali loss: 0.2816001
	iters: 100, epoch: 8 | loss: 0.4701161
	speed: 0.0135s/iter; left time: 0.4317s
Updating learning rate to 0.0
Validation loss decreased (0.2816 --> 0.2816).  Saving model state dict ...
Epoch: 8 cost time: 1.0889644622802734
Epoch: 8, Steps: 131 | Train Loss: 0.4701161 Vali Loss: 0.2815723 Best vali loss: 0.2815723

best validation loss 0.28157232159263096

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0080579476276, 'e_layers': 1, 'learning_rate': 0.000985904912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4530058
	speed: 0.0143s/iter; left time: 28.5222s
	iters: 200, epoch: 1 | loss: 0.2863426
	speed: 0.0073s/iter; left time: 13.8913s
Updating learning rate to 0.000985904912
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 2.1272730827331543
Epoch: 1, Steps: 262 | Train Loss: 0.3696742 Vali Loss: 0.2827511 Best vali loss: 0.2827511
	iters: 100, epoch: 2 | loss: 0.4530943
	speed: 0.0107s/iter; left time: 18.5175s
	iters: 200, epoch: 2 | loss: 0.6210925
	speed: 0.0057s/iter; left time: 9.2642s
Updating learning rate to 0.000492952456
Epoch: 2 cost time: 1.4251248836517334
Epoch: 2, Steps: 262 | Train Loss: 0.5370934 Vali Loss: 0.2912496 Best vali loss: 0.2827511
	iters: 100, epoch: 3 | loss: 0.3213900
	speed: 0.0141s/iter; left time: 20.8033s
	iters: 200, epoch: 3 | loss: 0.9803395
	speed: 0.0060s/iter; left time: 8.2289s
Updating learning rate to 0.000246476228
Epoch: 3 cost time: 1.5929253101348877
Epoch: 3, Steps: 262 | Train Loss: 0.6508648 Vali Loss: 0.2961689 Best vali loss: 0.2827511
	iters: 100, epoch: 4 | loss: 0.3248072
	speed: 0.0137s/iter; left time: 16.6320s
	iters: 200, epoch: 4 | loss: 0.8195405
	speed: 0.0059s/iter; left time: 6.5677s
Updating learning rate to 0.000123238114
Epoch: 4 cost time: 1.5858423709869385
Epoch: 4, Steps: 262 | Train Loss: 0.5721738 Vali Loss: 0.2960160 Best vali loss: 0.2827511
	iters: 100, epoch: 5 | loss: 0.6957957
	speed: 0.0136s/iter; left time: 12.9264s
	iters: 200, epoch: 5 | loss: 0.3980846
	speed: 0.0056s/iter; left time: 4.7731s
Updating learning rate to 6.1619057e-05
Epoch: 5 cost time: 1.4691746234893799
Epoch: 5, Steps: 262 | Train Loss: 0.5469401 Vali Loss: 0.2988372 Best vali loss: 0.2827511
	iters: 100, epoch: 6 | loss: 0.2425754
	speed: 0.0126s/iter; left time: 8.6512s
	iters: 200, epoch: 6 | loss: 0.4446411
	speed: 0.0051s/iter; left time: 3.0129s
Updating learning rate to 3.08095285e-05
Epoch: 6 cost time: 1.4095499515533447
Epoch: 6, Steps: 262 | Train Loss: 0.3436082 Vali Loss: 0.2996590 Best vali loss: 0.2827511
	iters: 100, epoch: 7 | loss: 0.3372402
	speed: 0.0123s/iter; left time: 5.2443s
	iters: 200, epoch: 7 | loss: 0.3353003
	speed: 0.0052s/iter; left time: 1.6854s
Updating learning rate to 1.540476425e-05
Epoch: 7 cost time: 1.4247610569000244
Epoch: 7, Steps: 262 | Train Loss: 0.3362703 Vali Loss: 0.3010734 Best vali loss: 0.2827511
	iters: 100, epoch: 8 | loss: 0.3199435
	speed: 0.0175s/iter; left time: 2.8494s
	iters: 200, epoch: 8 | loss: 0.2895221
	speed: 0.0049s/iter; left time: 0.3100s
Updating learning rate to 7.702382125e-06
Epoch: 8 cost time: 1.6759083271026611
Epoch: 8, Steps: 262 | Train Loss: 0.3047328 Vali Loss: 0.3007916 Best vali loss: 0.2827511

best validation loss 0.28275108392817594

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6476913
	speed: 0.0133s/iter; left time: 54.5003s
	iters: 200, epoch: 1 | loss: 1.0018134
	speed: 0.0054s/iter; left time: 21.5915s
	iters: 300, epoch: 1 | loss: 1.1051071
	speed: 0.0059s/iter; left time: 22.9175s
	iters: 400, epoch: 1 | loss: 0.5436990
	speed: 0.0068s/iter; left time: 25.7207s
	iters: 500, epoch: 1 | loss: 0.5829185
	speed: 0.0063s/iter; left time: 23.2848s
Updating learning rate to 0.0013504261128
Validation loss decreased (inf --> 0.3163).  Saving model state dict ...
Epoch: 1 cost time: 3.6247787475585938
Epoch: 1, Steps: 523 | Train Loss: 0.7762459 Vali Loss: 0.3162654 Best vali loss: 0.3162654
	iters: 100, epoch: 2 | loss: 0.3314176
	speed: 0.0146s/iter; left time: 51.9901s
	iters: 200, epoch: 2 | loss: 0.2363244
	speed: 0.0056s/iter; left time: 19.4789s
	iters: 300, epoch: 2 | loss: 0.7087943
	speed: 0.0072s/iter; left time: 24.0384s
	iters: 400, epoch: 2 | loss: 0.3531640
	speed: 0.0066s/iter; left time: 21.6443s
	iters: 500, epoch: 2 | loss: 1.1796858
	speed: 0.0053s/iter; left time: 16.7158s
Updating learning rate to 0.0006752130564
Validation loss decreased (0.3163 --> 0.2982).  Saving model state dict ...
Epoch: 2 cost time: 3.2025399208068848
Epoch: 2, Steps: 523 | Train Loss: 0.5618772 Vali Loss: 0.2982240 Best vali loss: 0.2982240
	iters: 100, epoch: 3 | loss: 0.2443831
	speed: 0.0156s/iter; left time: 47.3285s
	iters: 200, epoch: 3 | loss: 0.4208975
	speed: 0.0070s/iter; left time: 20.5907s
	iters: 300, epoch: 3 | loss: 0.7987425
	speed: 0.0068s/iter; left time: 19.1739s
	iters: 400, epoch: 3 | loss: 0.3686646
	speed: 0.0068s/iter; left time: 18.6691s
	iters: 500, epoch: 3 | loss: 0.4516321
	speed: 0.0070s/iter; left time: 18.4495s
Updating learning rate to 0.0003376065282
Validation loss decreased (0.2982 --> 0.2918).  Saving model state dict ...
Epoch: 3 cost time: 3.6057114601135254
Epoch: 3, Steps: 523 | Train Loss: 0.4568640 Vali Loss: 0.2918390 Best vali loss: 0.2918390

best validation loss 0.29183897824924027

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4152626
	speed: 0.0136s/iter; left time: 55.5098s
	iters: 200, epoch: 1 | loss: 0.3628592
	speed: 0.0064s/iter; left time: 25.4732s
	iters: 300, epoch: 1 | loss: 0.2360254
	speed: 0.0058s/iter; left time: 22.3397s
	iters: 400, epoch: 1 | loss: 1.1788944
	speed: 0.0068s/iter; left time: 25.5688s
	iters: 500, epoch: 1 | loss: 0.2745637
	speed: 0.0067s/iter; left time: 24.8157s
Updating learning rate to 6.03650536e-05
Validation loss decreased (inf --> 0.2914).  Saving model state dict ...
Epoch: 1 cost time: 3.780702590942383
Epoch: 1, Steps: 523 | Train Loss: 0.4935211 Vali Loss: 0.2913868 Best vali loss: 0.2913868
	iters: 100, epoch: 2 | loss: 0.7309294
	speed: 0.0156s/iter; left time: 55.3905s
	iters: 200, epoch: 2 | loss: 0.3178229
	speed: 0.0055s/iter; left time: 18.9694s
	iters: 300, epoch: 2 | loss: 0.5117784
	speed: 0.0054s/iter; left time: 17.9961s
	iters: 400, epoch: 2 | loss: 1.0606356
	speed: 0.0071s/iter; left time: 23.1752s
	iters: 500, epoch: 2 | loss: 0.2431638
	speed: 0.0068s/iter; left time: 21.6590s
Updating learning rate to 3.01825268e-05
Validation loss decreased (0.2914 --> 0.2820).  Saving model state dict ...
Epoch: 2 cost time: 3.4373037815093994
Epoch: 2, Steps: 523 | Train Loss: 0.5728660 Vali Loss: 0.2819920 Best vali loss: 0.2819920
	iters: 100, epoch: 3 | loss: 0.5567168
	speed: 0.0172s/iter; left time: 52.3375s
	iters: 200, epoch: 3 | loss: 0.5248246
	speed: 0.0072s/iter; left time: 21.1217s
	iters: 300, epoch: 3 | loss: 0.5153393
	speed: 0.0071s/iter; left time: 20.2359s
	iters: 400, epoch: 3 | loss: 0.6770444
	speed: 0.0071s/iter; left time: 19.4253s
	iters: 500, epoch: 3 | loss: 0.3461114
	speed: 0.0071s/iter; left time: 18.8176s
Updating learning rate to 1.50912634e-05
Validation loss decreased (0.2820 --> 0.2798).  Saving model state dict ...
Epoch: 3 cost time: 3.767871379852295
Epoch: 3, Steps: 523 | Train Loss: 0.5240073 Vali Loss: 0.2798229 Best vali loss: 0.2798229

best validation loss 0.2798228788914491

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043939909637, 'e_layers': 2, 'learning_rate': 0.0005385073997, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4599387
	speed: 0.0194s/iter; left time: 18.3923s
Updating learning rate to 0.0005180116821943523
Validation loss decreased (inf --> 0.2943).  Saving model state dict ...
Epoch: 1 cost time: 2.08461332321167
Epoch: 1, Steps: 131 | Train Loss: 0.4599387 Vali Loss: 0.2943333 Best vali loss: 0.2943333
	iters: 100, epoch: 2 | loss: 0.3075444
	speed: 0.0233s/iter; left time: 19.0874s
Updating learning rate to 0.00045964481687350226
Validation loss decreased (0.2943 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 1.6073355674743652
Epoch: 2, Steps: 131 | Train Loss: 0.3075444 Vali Loss: 0.2835376 Best vali loss: 0.2835376
	iters: 100, epoch: 3 | loss: 0.6116894
	speed: 0.0129s/iter; left time: 8.8506s
Updating learning rate to 0.0003722926298855977
Validation loss decreased (0.2835 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 1.0611932277679443
Epoch: 3, Steps: 131 | Train Loss: 0.6116894 Vali Loss: 0.2834512 Best vali loss: 0.2834512

best validation loss 0.2834512033247292

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3756623
	speed: 0.0135s/iter; left time: 34.0412s
	iters: 200, epoch: 4 | loss: 0.2913781
	speed: 0.0071s/iter; left time: 17.1334s
	iters: 300, epoch: 4 | loss: 0.2128133
	speed: 0.0068s/iter; left time: 15.7212s
	iters: 400, epoch: 4 | loss: 1.0646137
	speed: 0.0070s/iter; left time: 15.5785s
	iters: 500, epoch: 4 | loss: 0.2478649
	speed: 0.0073s/iter; left time: 15.4849s
Updating learning rate to 7.5456317e-06
Epoch: 4 cost time: 4.051233291625977
Epoch: 4, Steps: 523 | Train Loss: 0.4384665 Vali Loss: 0.2807661 Best vali loss: 0.2798229
	iters: 100, epoch: 5 | loss: 0.7116269
	speed: 0.0171s/iter; left time: 34.1316s
	iters: 200, epoch: 5 | loss: 0.3107874
	speed: 0.0069s/iter; left time: 13.0565s
	iters: 300, epoch: 5 | loss: 0.4875081
	speed: 0.0066s/iter; left time: 11.8364s
	iters: 400, epoch: 5 | loss: 0.9334201
	speed: 0.0058s/iter; left time: 9.7669s
	iters: 500, epoch: 5 | loss: 0.2374250
	speed: 0.0055s/iter; left time: 8.7847s
Updating learning rate to 3.77281585e-06
Epoch: 5 cost time: 3.400092124938965
Epoch: 5, Steps: 523 | Train Loss: 0.5361535 Vali Loss: 0.2801185 Best vali loss: 0.2798229
	iters: 100, epoch: 6 | loss: 0.4668466
	speed: 0.0160s/iter; left time: 23.5479s
	iters: 200, epoch: 6 | loss: 0.5373880
	speed: 0.0068s/iter; left time: 9.3235s
	iters: 300, epoch: 6 | loss: 0.5153700
	speed: 0.0069s/iter; left time: 8.7005s
	iters: 400, epoch: 6 | loss: 0.6670688
	speed: 0.0066s/iter; left time: 7.7192s
	iters: 500, epoch: 6 | loss: 0.3454822
	speed: 0.0068s/iter; left time: 7.2264s
Updating learning rate to 1.886407925e-06
Validation loss decreased (0.2798 --> 0.2797).  Saving model state dict ...
Epoch: 6 cost time: 3.6072142124176025
Epoch: 6, Steps: 523 | Train Loss: 0.5064311 Vali Loss: 0.2797239 Best vali loss: 0.2797239
	iters: 100, epoch: 7 | loss: 0.3985271
	speed: 0.0155s/iter; left time: 14.6362s
	iters: 200, epoch: 7 | loss: 0.3523991
	speed: 0.0068s/iter; left time: 5.7830s
	iters: 300, epoch: 7 | loss: 0.3233264
	speed: 0.0065s/iter; left time: 4.8866s
	iters: 400, epoch: 7 | loss: 0.6588095
	speed: 0.0065s/iter; left time: 4.2266s
	iters: 500, epoch: 7 | loss: 0.9080848
	speed: 0.0066s/iter; left time: 3.6347s
Updating learning rate to 9.432039625e-07
Validation loss decreased (0.2797 --> 0.2797).  Saving model state dict ...
Epoch: 7 cost time: 3.4775025844573975
Epoch: 7, Steps: 523 | Train Loss: 0.5282294 Vali Loss: 0.2796653 Best vali loss: 0.2796653
	iters: 100, epoch: 8 | loss: 0.2747878
	speed: 0.0164s/iter; left time: 6.9479s
	iters: 200, epoch: 8 | loss: 0.6528044
	speed: 0.0065s/iter; left time: 2.0979s
	iters: 300, epoch: 8 | loss: 0.6178933
	speed: 0.0061s/iter; left time: 1.3750s
	iters: 400, epoch: 8 | loss: 0.3616836
	speed: 0.0065s/iter; left time: 0.8083s
	iters: 500, epoch: 8 | loss: 0.3243044
	speed: 0.0068s/iter; left time: 0.1634s
Updating learning rate to 4.7160198125e-07
Validation loss decreased (0.2797 --> 0.2797).  Saving model state dict ...
Epoch: 8 cost time: 3.5206587314605713
Epoch: 8, Steps: 523 | Train Loss: 0.4462947 Vali Loss: 0.2796514 Best vali loss: 0.2796514

best validation loss 0.2796513971652006

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014453407321, 'e_layers': 1, 'learning_rate': 0.0019242997604, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2041682
	speed: 0.0111s/iter; left time: 91.6584s
	iters: 200, epoch: 1 | loss: 0.3018984
	speed: 0.0053s/iter; left time: 42.8627s
	iters: 300, epoch: 1 | loss: 0.2902188
	speed: 0.0048s/iter; left time: 38.6039s
	iters: 400, epoch: 1 | loss: 0.8372511
	speed: 0.0051s/iter; left time: 40.2567s
	iters: 500, epoch: 1 | loss: 0.3792474
	speed: 0.0055s/iter; left time: 43.0957s
	iters: 600, epoch: 1 | loss: 0.4801300
	speed: 0.0057s/iter; left time: 43.9427s
	iters: 700, epoch: 1 | loss: 0.7096649
	speed: 0.0057s/iter; left time: 43.7374s
	iters: 800, epoch: 1 | loss: 0.2964563
	speed: 0.0052s/iter; left time: 39.3570s
	iters: 900, epoch: 1 | loss: 0.2899633
	speed: 0.0048s/iter; left time: 36.1346s
	iters: 1000, epoch: 1 | loss: 0.4427981
	speed: 0.0050s/iter; left time: 36.5658s
Updating learning rate to 0.0018510604617249667
Validation loss decreased (inf --> 0.2919).  Saving model state dict ...
Epoch: 1 cost time: 5.764051198959351
Epoch: 1, Steps: 1045 | Train Loss: 0.4231796 Vali Loss: 0.2918794 Best vali loss: 0.2918794
	iters: 100, epoch: 2 | loss: 0.2427554
	speed: 0.0224s/iter; left time: 161.6022s
	iters: 200, epoch: 2 | loss: 0.2690833
	speed: 0.0054s/iter; left time: 38.3987s
	iters: 300, epoch: 2 | loss: 0.9075695
	speed: 0.0051s/iter; left time: 36.1027s
	iters: 400, epoch: 2 | loss: 0.3911276
	speed: 0.0050s/iter; left time: 34.7300s
	iters: 500, epoch: 2 | loss: 0.4054437
	speed: 0.0055s/iter; left time: 37.4396s
	iters: 600, epoch: 2 | loss: 0.6621495
	speed: 0.0055s/iter; left time: 36.8353s
	iters: 700, epoch: 2 | loss: 0.3254247
	speed: 0.0056s/iter; left time: 36.9296s
	iters: 800, epoch: 2 | loss: 0.2477472
	speed: 0.0058s/iter; left time: 37.8803s
	iters: 900, epoch: 2 | loss: 0.3666048
	speed: 0.0056s/iter; left time: 36.2451s
	iters: 1000, epoch: 2 | loss: 1.5811973
	speed: 0.0052s/iter; left time: 33.1414s
Updating learning rate to 0.0016424925850072444
Validation loss decreased (0.2919 --> 0.2878).  Saving model state dict ...
Epoch: 2 cost time: 5.6641459465026855
Epoch: 2, Steps: 1045 | Train Loss: 0.5399103 Vali Loss: 0.2878429 Best vali loss: 0.2878429
	iters: 100, epoch: 3 | loss: 0.3018001
	speed: 0.0220s/iter; left time: 135.9241s
	iters: 200, epoch: 3 | loss: 0.4222986
	speed: 0.0043s/iter; left time: 25.8338s
	iters: 300, epoch: 3 | loss: 0.2986836
	speed: 0.0041s/iter; left time: 24.7615s
	iters: 400, epoch: 3 | loss: 0.4830411
	speed: 0.0049s/iter; left time: 28.5768s
	iters: 500, epoch: 3 | loss: 0.2545235
	speed: 0.0047s/iter; left time: 27.1034s
	iters: 600, epoch: 3 | loss: 0.5770487
	speed: 0.0049s/iter; left time: 27.7221s
	iters: 700, epoch: 3 | loss: 0.4305030
	speed: 0.0045s/iter; left time: 24.8293s
	iters: 800, epoch: 3 | loss: 0.4702380
	speed: 0.0046s/iter; left time: 25.2414s
	iters: 900, epoch: 3 | loss: 0.2399778
	speed: 0.0042s/iter; left time: 22.6305s
	iters: 1000, epoch: 3 | loss: 1.1549203
	speed: 0.0040s/iter; left time: 21.0194s
Updating learning rate to 0.001330348698804596
Epoch: 3 cost time: 4.786157131195068
Epoch: 3, Steps: 1045 | Train Loss: 0.4633035 Vali Loss: 0.2883516 Best vali loss: 0.2878429
	iters: 100, epoch: 4 | loss: 0.3504339
	speed: 0.0198s/iter; left time: 101.2776s
	iters: 200, epoch: 4 | loss: 0.3756984
	speed: 0.0051s/iter; left time: 25.5569s
	iters: 300, epoch: 4 | loss: 0.5024887
	speed: 0.0041s/iter; left time: 20.1453s
	iters: 400, epoch: 4 | loss: 0.5647088
	speed: 0.0038s/iter; left time: 18.5002s
	iters: 500, epoch: 4 | loss: 0.6274755
	speed: 0.0041s/iter; left time: 19.3812s
	iters: 600, epoch: 4 | loss: 0.3062673
	speed: 0.0044s/iter; left time: 20.1691s
	iters: 700, epoch: 4 | loss: 0.3180147
	speed: 0.0043s/iter; left time: 19.3886s
	iters: 800, epoch: 4 | loss: 0.1291716
	speed: 0.0041s/iter; left time: 18.0498s
	iters: 900, epoch: 4 | loss: 0.4203750
	speed: 0.0040s/iter; left time: 17.3688s
	iters: 1000, epoch: 4 | loss: 0.4004446
	speed: 0.0044s/iter; left time: 18.6649s
Updating learning rate to 0.0009621498802
Validation loss decreased (0.2878 --> 0.2862).  Saving model state dict ...
Epoch: 4 cost time: 4.549763202667236
Epoch: 4, Steps: 1045 | Train Loss: 0.3995079 Vali Loss: 0.2861838 Best vali loss: 0.2861838
	iters: 100, epoch: 5 | loss: 0.7365704
	speed: 0.0132s/iter; left time: 54.0012s
	iters: 200, epoch: 5 | loss: 1.0012618
	speed: 0.0050s/iter; left time: 20.0358s
	iters: 300, epoch: 5 | loss: 1.3956574
	speed: 0.0049s/iter; left time: 18.8479s
	iters: 400, epoch: 5 | loss: 1.0849445
	speed: 0.0049s/iter; left time: 18.5055s
	iters: 500, epoch: 5 | loss: 0.7528661
	speed: 0.0051s/iter; left time: 18.9222s
	iters: 600, epoch: 5 | loss: 0.1734083
	speed: 0.0047s/iter; left time: 16.6649s
	iters: 700, epoch: 5 | loss: 0.3016486
	speed: 0.0048s/iter; left time: 16.6303s
	iters: 800, epoch: 5 | loss: 0.5844678
	speed: 0.0047s/iter; left time: 15.7672s
	iters: 900, epoch: 5 | loss: 0.5476419
	speed: 0.0051s/iter; left time: 16.7658s
	iters: 1000, epoch: 5 | loss: 0.2056338
	speed: 0.0041s/iter; left time: 13.1841s
Updating learning rate to 0.0005939510615954041
Validation loss decreased (0.2862 --> 0.2832).  Saving model state dict ...
Epoch: 5 cost time: 4.926743030548096
Epoch: 5, Steps: 1045 | Train Loss: 0.6784101 Vali Loss: 0.2832049 Best vali loss: 0.2832049
	iters: 100, epoch: 6 | loss: 0.4822040
	speed: 0.0190s/iter; left time: 57.5601s
	iters: 200, epoch: 6 | loss: 0.5941361
	speed: 0.0053s/iter; left time: 15.4183s
	iters: 300, epoch: 6 | loss: 0.2216107
	speed: 0.0048s/iter; left time: 13.6345s
	iters: 400, epoch: 6 | loss: 0.8540969
	speed: 0.0046s/iter; left time: 12.5570s
	iters: 500, epoch: 6 | loss: 0.2146873
	speed: 0.0047s/iter; left time: 12.3728s
	iters: 600, epoch: 6 | loss: 0.7607507
	speed: 0.0043s/iter; left time: 10.9530s
	iters: 700, epoch: 6 | loss: 0.6004573
	speed: 0.0052s/iter; left time: 12.5712s
	iters: 800, epoch: 6 | loss: 0.2711955
	speed: 0.0046s/iter; left time: 10.8121s
	iters: 900, epoch: 6 | loss: 0.3333835
	speed: 0.0049s/iter; left time: 10.8739s
	iters: 1000, epoch: 6 | loss: 0.2638773
	speed: 0.0050s/iter; left time: 10.6306s
Updating learning rate to 0.0002818071753927558
Epoch: 6 cost time: 5.07037091255188
Epoch: 6, Steps: 1045 | Train Loss: 0.4596399 Vali Loss: 0.2861922 Best vali loss: 0.2832049
	iters: 100, epoch: 7 | loss: 0.5936512
	speed: 0.0175s/iter; left time: 34.7549s
	iters: 200, epoch: 7 | loss: 0.7913257
	speed: 0.0049s/iter; left time: 9.3353s
	iters: 300, epoch: 7 | loss: 0.3550188
	speed: 0.0054s/iter; left time: 9.5875s
	iters: 400, epoch: 7 | loss: 0.1812241
	speed: 0.0045s/iter; left time: 7.6712s
	iters: 500, epoch: 7 | loss: 0.4551007
	speed: 0.0042s/iter; left time: 6.6731s
	iters: 600, epoch: 7 | loss: 0.3943557
	speed: 0.0039s/iter; left time: 5.7798s
	iters: 700, epoch: 7 | loss: 0.2343855
	speed: 0.0045s/iter; left time: 6.2674s
	iters: 800, epoch: 7 | loss: 0.9541851
	speed: 0.0048s/iter; left time: 6.2411s
	iters: 900, epoch: 7 | loss: 0.1769208
	speed: 0.0046s/iter; left time: 5.4903s
	iters: 1000, epoch: 7 | loss: 0.2141084
	speed: 0.0044s/iter; left time: 4.7913s
Updating learning rate to 7.323929867503346e-05
Epoch: 7 cost time: 4.763727426528931
Epoch: 7, Steps: 1045 | Train Loss: 0.4350276 Vali Loss: 0.2887165 Best vali loss: 0.2832049
	iters: 100, epoch: 8 | loss: 0.2043294
	speed: 0.0172s/iter; left time: 16.2962s
	iters: 200, epoch: 8 | loss: 0.2161387
	speed: 0.0051s/iter; left time: 4.3339s
	iters: 300, epoch: 8 | loss: 0.2705985
	speed: 0.0047s/iter; left time: 3.4718s
	iters: 400, epoch: 8 | loss: 0.1233915
	speed: 0.0051s/iter; left time: 3.2707s
	iters: 500, epoch: 8 | loss: 0.3187718
	speed: 0.0052s/iter; left time: 2.8417s
	iters: 600, epoch: 8 | loss: 0.3309042
	speed: 0.0047s/iter; left time: 2.1014s
	iters: 700, epoch: 8 | loss: 0.4672652
	speed: 0.0051s/iter; left time: 1.7801s
	iters: 800, epoch: 8 | loss: 0.3371083
	speed: 0.0054s/iter; left time: 1.3256s
	iters: 900, epoch: 8 | loss: 1.0097922
	speed: 0.0048s/iter; left time: 0.6947s
	iters: 1000, epoch: 8 | loss: 0.3627683
	speed: 0.0044s/iter; left time: 0.2024s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.208146572113037
Epoch: 8, Steps: 1045 | Train Loss: 0.3641068 Vali Loss: 0.2953471 Best vali loss: 0.2832049

best validation loss 0.2832049296974205

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0071113834238, 'e_layers': 4, 'learning_rate': 0.0001530715139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0347353
	speed: 0.0173s/iter; left time: 143.3037s
	iters: 200, epoch: 1 | loss: 1.3778374
	speed: 0.0103s/iter; left time: 83.7806s
	iters: 300, epoch: 1 | loss: 0.4484871
	speed: 0.0102s/iter; left time: 82.2586s
	iters: 400, epoch: 1 | loss: 0.3634848
	speed: 0.0084s/iter; left time: 67.0200s
	iters: 500, epoch: 1 | loss: 0.4991905
	speed: 0.0080s/iter; left time: 63.2358s
	iters: 600, epoch: 1 | loss: 0.6669850
	speed: 0.0092s/iter; left time: 71.3501s
	iters: 700, epoch: 1 | loss: 0.6935655
	speed: 0.0096s/iter; left time: 73.4936s
	iters: 800, epoch: 1 | loss: 0.2154196
	speed: 0.0106s/iter; left time: 79.8176s
	iters: 900, epoch: 1 | loss: 0.4252733
	speed: 0.0094s/iter; left time: 70.1457s
	iters: 1000, epoch: 1 | loss: 0.2043072
	speed: 0.0101s/iter; left time: 74.3634s
Updating learning rate to 0.0001472455763013635
Validation loss decreased (inf --> 0.2957).  Saving model state dict ...
Epoch: 1 cost time: 10.425314903259277
Epoch: 1, Steps: 1045 | Train Loss: 0.5929286 Vali Loss: 0.2956922 Best vali loss: 0.2956922
	iters: 100, epoch: 2 | loss: 0.3188627
	speed: 0.0272s/iter; left time: 196.4240s
	iters: 200, epoch: 2 | loss: 0.2461234
	speed: 0.0093s/iter; left time: 66.2855s
	iters: 300, epoch: 2 | loss: 0.3703886
	speed: 0.0105s/iter; left time: 73.4138s
	iters: 400, epoch: 2 | loss: 0.2261022
	speed: 0.0114s/iter; left time: 78.7161s
	iters: 500, epoch: 2 | loss: 0.2283921
	speed: 0.0113s/iter; left time: 77.2315s
	iters: 600, epoch: 2 | loss: 0.2969496
	speed: 0.0084s/iter; left time: 56.1290s
	iters: 700, epoch: 2 | loss: 0.4288467
	speed: 0.0111s/iter; left time: 73.6617s
	iters: 800, epoch: 2 | loss: 0.2883511
	speed: 0.0116s/iter; left time: 75.5882s
	iters: 900, epoch: 2 | loss: 0.2744459
	speed: 0.0112s/iter; left time: 71.6203s
	iters: 1000, epoch: 2 | loss: 0.4291531
	speed: 0.0105s/iter; left time: 66.1678s
Updating learning rate to 0.00013065470969259043
Validation loss decreased (0.2957 --> 0.2811).  Saving model state dict ...
Epoch: 2 cost time: 10.835283279418945
Epoch: 2, Steps: 1045 | Train Loss: 0.3107615 Vali Loss: 0.2811431 Best vali loss: 0.2811431
	iters: 100, epoch: 3 | loss: 0.3689490
	speed: 0.0286s/iter; left time: 176.2842s
	iters: 200, epoch: 3 | loss: 0.2391075
	speed: 0.0112s/iter; left time: 67.9421s
	iters: 300, epoch: 3 | loss: 0.3018256
	speed: 0.0107s/iter; left time: 63.9206s
	iters: 400, epoch: 3 | loss: 1.0316677
	speed: 0.0095s/iter; left time: 55.7379s
	iters: 500, epoch: 3 | loss: 0.4470127
	speed: 0.0095s/iter; left time: 54.7729s
	iters: 600, epoch: 3 | loss: 1.0246832
	speed: 0.0102s/iter; left time: 58.1097s
	iters: 700, epoch: 3 | loss: 0.3139029
	speed: 0.0109s/iter; left time: 60.7903s
	iters: 800, epoch: 3 | loss: 0.9000440
	speed: 0.0106s/iter; left time: 58.2490s
	iters: 900, epoch: 3 | loss: 0.4055191
	speed: 0.0101s/iter; left time: 54.0072s
	iters: 1000, epoch: 3 | loss: 0.2235647
	speed: 0.0087s/iter; left time: 45.6642s
Updating learning rate to 0.00010582472311828629
Validation loss decreased (0.2811 --> 0.2765).  Saving model state dict ...
Epoch: 3 cost time: 10.719253301620483
Epoch: 3, Steps: 1045 | Train Loss: 0.5256276 Vali Loss: 0.2765180 Best vali loss: 0.2765180
	iters: 100, epoch: 4 | loss: 0.1831831
	speed: 0.0331s/iter; left time: 169.8786s
	iters: 200, epoch: 4 | loss: 0.4658056
	speed: 0.0100s/iter; left time: 50.3308s
	iters: 300, epoch: 4 | loss: 0.5293064
	speed: 0.0096s/iter; left time: 47.3437s
	iters: 400, epoch: 4 | loss: 0.6437727
	speed: 0.0100s/iter; left time: 48.3471s
	iters: 500, epoch: 4 | loss: 0.4856394
	speed: 0.0115s/iter; left time: 54.5798s
	iters: 600, epoch: 4 | loss: 0.2828060
	speed: 0.0105s/iter; left time: 48.4527s
	iters: 700, epoch: 4 | loss: 0.2263026
	speed: 0.0091s/iter; left time: 41.3255s
	iters: 800, epoch: 4 | loss: 0.6758375
	speed: 0.0108s/iter; left time: 47.8913s
	iters: 900, epoch: 4 | loss: 0.4344373
	speed: 0.0087s/iter; left time: 37.7492s
	iters: 1000, epoch: 4 | loss: 0.5477504
	speed: 0.0100s/iter; left time: 42.1811s
Updating learning rate to 7.653575695e-05
Epoch: 4 cost time: 10.628225564956665
Epoch: 4, Steps: 1045 | Train Loss: 0.4474841 Vali Loss: 0.2939563 Best vali loss: 0.2765180
	iters: 100, epoch: 5 | loss: 0.2226240
	speed: 0.0322s/iter; left time: 131.4926s
	iters: 200, epoch: 5 | loss: 0.1802325
	speed: 0.0102s/iter; left time: 40.4639s
	iters: 300, epoch: 5 | loss: 0.4406786
	speed: 0.0107s/iter; left time: 41.6142s
	iters: 400, epoch: 5 | loss: 0.3137782
	speed: 0.0110s/iter; left time: 41.6076s
	iters: 500, epoch: 5 | loss: 0.1495615
	speed: 0.0103s/iter; left time: 38.0917s
	iters: 600, epoch: 5 | loss: 0.4317068
	speed: 0.0107s/iter; left time: 38.1516s
	iters: 700, epoch: 5 | loss: 0.1931317
	speed: 0.0100s/iter; left time: 34.8743s
	iters: 800, epoch: 5 | loss: 0.6588176
	speed: 0.0099s/iter; left time: 33.4331s
	iters: 900, epoch: 5 | loss: 0.2863601
	speed: 0.0112s/iter; left time: 36.7135s
	iters: 1000, epoch: 5 | loss: 0.6296928
	speed: 0.0098s/iter; left time: 31.2757s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3739571
	speed: 0.0166s/iter; left time: 33.0508s
	iters: 200, epoch: 1 | loss: 0.5345845
	speed: 0.0089s/iter; left time: 16.8717s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.3036).  Saving model state dict ...
Epoch: 1 cost time: 2.6807007789611816
Epoch: 1, Steps: 262 | Train Loss: 0.4542708 Vali Loss: 0.3035677 Best vali loss: 0.3035677
	iters: 100, epoch: 2 | loss: 0.5760306
	speed: 0.0220s/iter; left time: 38.1201s
	iters: 200, epoch: 2 | loss: 0.5790677
	speed: 0.0081s/iter; left time: 13.1765s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.3036 --> 0.2888).  Saving model state dict ...
Epoch: 2 cost time: 2.185544490814209
Epoch: 2, Steps: 262 | Train Loss: 0.5775491 Vali Loss: 0.2887877 Best vali loss: 0.2887877
	iters: 100, epoch: 3 | loss: 0.4256815
	speed: 0.0208s/iter; left time: 30.7073s
	iters: 200, epoch: 3 | loss: 0.5596386
	speed: 0.0091s/iter; left time: 12.4855s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.2888 --> 0.2837).  Saving model state dict ...
Epoch: 3 cost time: 2.346383810043335
Epoch: 3, Steps: 262 | Train Loss: 0.4926600 Vali Loss: 0.2837497 Best vali loss: 0.2837497

best validation loss 0.28374974137569015

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020735604228, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.3122).  Saving model state dict ...
Epoch: 1 cost time: 1.425802230834961
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3122029 Best vali loss: 0.3122029
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.3122 --> 0.2934).  Saving model state dict ...
Epoch: 2 cost time: 1.148313283920288
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2933761 Best vali loss: 0.2933761
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.2934 --> 0.2882).  Saving model state dict ...
Epoch: 3 cost time: 1.1602373123168945
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2881821 Best vali loss: 0.2881821

best validation loss 0.2881821264738308

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062923252341, 'e_layers': 4, 'learning_rate': 0.0001977554099, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9038277
	speed: 0.0211s/iter; left time: 19.9822s
Updating learning rate to 0.00019022879277499492
Validation loss decreased (inf --> 0.3110).  Saving model state dict ...
Epoch: 1 cost time: 2.2063121795654297
Epoch: 1, Steps: 131 | Train Loss: 0.9038277 Vali Loss: 0.3109846 Best vali loss: 0.3109846
	iters: 100, epoch: 2 | loss: 0.4492104
	speed: 0.0186s/iter; left time: 15.2288s
Updating learning rate to 0.00016879480062830765
Validation loss decreased (0.3110 --> 0.2955).  Saving model state dict ...
Epoch: 2 cost time: 1.4954063892364502
Epoch: 2, Steps: 131 | Train Loss: 0.4492104 Vali Loss: 0.2955318 Best vali loss: 0.2955318
	iters: 100, epoch: 3 | loss: 0.5763675
	speed: 0.0172s/iter; left time: 11.8212s
Updating learning rate to 0.00013671656446464863
Validation loss decreased (0.2955 --> 0.2899).  Saving model state dict ...
Epoch: 3 cost time: 1.3894927501678467
Epoch: 3, Steps: 131 | Train Loss: 0.5763675 Vali Loss: 0.2898656 Best vali loss: 0.2898656

best validation loss 0.28986555298561056

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3249016
	speed: 0.0140s/iter; left time: 16.9779s
	iters: 200, epoch: 4 | loss: 0.4504876
	speed: 0.0071s/iter; left time: 7.8623s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.2837 --> 0.2815).  Saving model state dict ...
Epoch: 4 cost time: 2.2260146141052246
Epoch: 4, Steps: 262 | Train Loss: 0.3876946 Vali Loss: 0.2815411 Best vali loss: 0.2815411
	iters: 100, epoch: 5 | loss: 0.5324898
	speed: 0.0165s/iter; left time: 15.6468s
	iters: 200, epoch: 5 | loss: 0.5317370
	speed: 0.0063s/iter; left time: 5.3348s
Updating learning rate to 1.7856066821212585e-05
Epoch: 5 cost time: 1.693458080291748
Epoch: 5, Steps: 262 | Train Loss: 0.5321134 Vali Loss: 0.2815493 Best vali loss: 0.2815411
	iters: 100, epoch: 6 | loss: 0.4179174
	speed: 0.0146s/iter; left time: 9.9971s
	iters: 200, epoch: 6 | loss: 0.5491773
	speed: 0.0055s/iter; left time: 3.2554s
Updating learning rate to 8.472024178210777e-06
Validation loss decreased (0.2815 --> 0.2810).  Saving model state dict ...
Epoch: 6 cost time: 1.5321674346923828
Epoch: 6, Steps: 262 | Train Loss: 0.4835473 Vali Loss: 0.2809996 Best vali loss: 0.2809996
	iters: 100, epoch: 7 | loss: 0.2519530
	speed: 0.0151s/iter; left time: 6.4192s
	iters: 200, epoch: 7 | loss: 0.4580619
	speed: 0.0065s/iter; left time: 2.1260s
Updating learning rate to 2.2018073468332077e-06
Validation loss decreased (0.2810 --> 0.2808).  Saving model state dict ...
Epoch: 7 cost time: 1.7844173908233643
Epoch: 7, Steps: 262 | Train Loss: 0.3550074 Vali Loss: 0.2807665 Best vali loss: 0.2807665
	iters: 100, epoch: 8 | loss: 0.5558288
	speed: 0.0192s/iter; left time: 3.1233s
	iters: 200, epoch: 8 | loss: 0.6325939
	speed: 0.0090s/iter; left time: 0.5662s
Updating learning rate to 0.0
Validation loss decreased (0.2808 --> 0.2807).  Saving model state dict ...
Epoch: 8 cost time: 2.2921650409698486
Epoch: 8, Steps: 262 | Train Loss: 0.5942113 Vali Loss: 0.2807379 Best vali loss: 0.2807379

best validation loss 0.28073793152598653

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047327455259, 'e_layers': 4, 'learning_rate': 0.0038245816163, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6223182
	speed: 0.0258s/iter; left time: 24.4965s
Updating learning rate to 0.0038245816163
Validation loss decreased (inf --> 0.2930).  Saving model state dict ...
Epoch: 1 cost time: 3.0991430282592773
Epoch: 1, Steps: 131 | Train Loss: 0.6223182 Vali Loss: 0.2930172 Best vali loss: 0.2930172
	iters: 100, epoch: 2 | loss: 0.3170852
	speed: 0.0357s/iter; left time: 29.1870s
Updating learning rate to 0.00191229080815
Validation loss decreased (0.2930 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 2.0849006175994873
Epoch: 2, Steps: 131 | Train Loss: 0.3170852 Vali Loss: 0.2871253 Best vali loss: 0.2871253
	iters: 100, epoch: 3 | loss: 0.2951165
	speed: 0.0325s/iter; left time: 22.3369s
Updating learning rate to 0.000956145404075
Epoch: 3 cost time: 2.6190412044525146
Epoch: 3, Steps: 131 | Train Loss: 0.2951165 Vali Loss: 0.3128140 Best vali loss: 0.2871253
	iters: 100, epoch: 4 | loss: 0.4828746
	speed: 0.0283s/iter; left time: 15.7363s
Updating learning rate to 0.0004780727020375
Epoch: 4 cost time: 1.9010565280914307
Epoch: 4, Steps: 131 | Train Loss: 0.4828746 Vali Loss: 0.3071511 Best vali loss: 0.2871253
	iters: 100, epoch: 5 | loss: 0.5867450
	speed: 0.0220s/iter; left time: 9.3552s
Updating learning rate to 0.00023903635101875
Epoch: 5 cost time: 1.6444058418273926
Epoch: 5, Steps: 131 | Train Loss: 0.5867450 Vali Loss: 0.3044873 Best vali loss: 0.2871253
	iters: 100, epoch: 6 | loss: 0.3507658
	speed: 0.0169s/iter; left time: 4.9555s
Updating learning rate to 0.000119518175509375
Epoch: 6 cost time: 1.3994371891021729
Epoch: 6, Steps: 131 | Train Loss: 0.3507658 Vali Loss: 0.3101267 Best vali loss: 0.2871253
	iters: 100, epoch: 7 | loss: 0.3706210
	speed: 0.0182s/iter; left time: 2.9695s
Updating learning rate to 5.97590877546875e-05
Epoch: 7 cost time: 1.3452458381652832
Epoch: 7, Steps: 131 | Train Loss: 0.3706210 Vali Loss: 0.3112837 Best vali loss: 0.2871253
	iters: 100, epoch: 8 | loss: 0.4209192
	speed: 0.0154s/iter; left time: 0.4917s
Updating learning rate to 2.987954387734375e-05
Epoch: 8 cost time: 1.3292667865753174
Epoch: 8, Steps: 131 | Train Loss: 0.4209192 Vali Loss: 0.3069898 Best vali loss: 0.2871253

best validation loss 0.2871253385934833

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0036637688578, 'e_layers': 3, 'learning_rate': 0.0032858943573, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3355481
	speed: 0.0148s/iter; left time: 60.5391s
	iters: 200, epoch: 1 | loss: 0.4674268
	speed: 0.0063s/iter; left time: 25.1169s
	iters: 300, epoch: 1 | loss: 1.3434575
	speed: 0.0083s/iter; left time: 32.3442s
	iters: 400, epoch: 1 | loss: 0.2526923
	speed: 0.0103s/iter; left time: 38.9281s
	iters: 500, epoch: 1 | loss: 0.3171979
	speed: 0.0097s/iter; left time: 35.6827s
Updating learning rate to 0.0032858943573
Validation loss decreased (inf --> 0.3208).  Saving model state dict ...
Epoch: 1 cost time: 4.843503952026367
Epoch: 1, Steps: 523 | Train Loss: 0.5432645 Vali Loss: 0.3207556 Best vali loss: 0.3207556
	iters: 100, epoch: 2 | loss: 0.7555569
	speed: 0.0189s/iter; left time: 67.2222s
	iters: 200, epoch: 2 | loss: 0.2644995
	speed: 0.0110s/iter; left time: 38.1751s
	iters: 300, epoch: 2 | loss: 0.4896479
	speed: 0.0124s/iter; left time: 41.8174s
	iters: 400, epoch: 2 | loss: 0.9159812
	speed: 0.0122s/iter; left time: 39.7952s
	iters: 500, epoch: 2 | loss: 0.3872918
	speed: 0.0120s/iter; left time: 37.9044s
Updating learning rate to 0.00164294717865
Epoch: 2 cost time: 5.912186861038208
Epoch: 2, Steps: 523 | Train Loss: 0.5625955 Vali Loss: 0.3254617 Best vali loss: 0.3207556
	iters: 100, epoch: 3 | loss: 0.6281119
	speed: 0.0273s/iter; left time: 82.9589s
	iters: 200, epoch: 3 | loss: 0.8052933
	speed: 0.0113s/iter; left time: 33.3397s
	iters: 300, epoch: 3 | loss: 0.2187016
	speed: 0.0135s/iter; left time: 38.2737s
	iters: 400, epoch: 3 | loss: 0.8033146
	speed: 0.0139s/iter; left time: 38.0240s
	iters: 500, epoch: 3 | loss: 0.5359693
	speed: 0.0139s/iter; left time: 36.7684s
Updating learning rate to 0.000821473589325
Epoch: 3 cost time: 6.800905227661133
Epoch: 3, Steps: 523 | Train Loss: 0.5982781 Vali Loss: 0.3223018 Best vali loss: 0.3207556
	iters: 100, epoch: 4 | loss: 0.6759018
	speed: 0.0299s/iter; left time: 75.1354s
	iters: 200, epoch: 4 | loss: 0.3867966
	speed: 0.0123s/iter; left time: 29.7779s
	iters: 300, epoch: 4 | loss: 0.5852137
	speed: 0.0138s/iter; left time: 32.0268s
	iters: 400, epoch: 4 | loss: 0.5039878
	speed: 0.0132s/iter; left time: 29.2796s
	iters: 500, epoch: 4 | loss: 0.4337751
	speed: 0.0114s/iter; left time: 24.1227s
Updating learning rate to 0.0004107367946625
Epoch: 4 cost time: 6.713181495666504
Epoch: 4, Steps: 523 | Train Loss: 0.5171350 Vali Loss: 0.3223608 Best vali loss: 0.3207556
	iters: 100, epoch: 5 | loss: 0.3775283
	speed: 0.0251s/iter; left time: 49.9699s
	iters: 200, epoch: 5 | loss: 0.4541020
	speed: 0.0100s/iter; left time: 18.9958s
	iters: 300, epoch: 5 | loss: 0.3547497
	speed: 0.0094s/iter; left time: 16.8670s
	iters: 400, epoch: 5 | loss: 0.6388228
	speed: 0.0129s/iter; left time: 21.8933s
	iters: 500, epoch: 5 | loss: 0.8893623
	speed: 0.0130s/iter; left time: 20.6575s
Updating learning rate to 0.00020536839733125
Epoch: 5 cost time: 6.006076097488403
Epoch: 5, Steps: 523 | Train Loss: 0.5429130 Vali Loss: 0.3224618 Best vali loss: 0.3207556
	iters: 100, epoch: 6 | loss: 0.9010585
	speed: 0.0268s/iter; left time: 39.4467s
	iters: 200, epoch: 6 | loss: 0.3992912
	speed: 0.0116s/iter; left time: 15.9453s
	iters: 300, epoch: 6 | loss: 1.9010055
	speed: 0.0123s/iter; left time: 15.6343s
	iters: 400, epoch: 6 | loss: 1.1821926
	speed: 0.0129s/iter; left time: 15.1346s
	iters: 500, epoch: 6 | loss: 0.4615069
	speed: 0.0129s/iter; left time: 13.8498s
Updating learning rate to 0.000102684198665625
Epoch: 6 cost time: 6.543026685714722
Epoch: 6, Steps: 523 | Train Loss: 0.9690109 Vali Loss: 0.3224307 Best vali loss: 0.3207556
	iters: 100, epoch: 7 | loss: 0.8764860
	speed: 0.0263s/iter; left time: 24.9190s
	iters: 200, epoch: 7 | loss: 0.3440327
	speed: 0.0115s/iter; left time: 9.7819s
	iters: 300, epoch: 7 | loss: 0.2258732
	speed: 0.0134s/iter; left time: 9.9736s
	iters: 400, epoch: 7 | loss: 0.4103546
	speed: 0.0133s/iter; left time: 8.6195s
	iters: 500, epoch: 7 | loss: 0.3658803
	speed: 0.0133s/iter; left time: 7.2672s
Updating learning rate to 5.13420993328125e-05
Epoch: 7 cost time: 6.633133172988892
Epoch: 7, Steps: 523 | Train Loss: 0.4445254 Vali Loss: 0.3223717 Best vali loss: 0.3207556
	iters: 100, epoch: 8 | loss: 0.6886709
	speed: 0.0282s/iter; left time: 11.9517s
	iters: 200, epoch: 8 | loss: 0.8249297
	speed: 0.0115s/iter; left time: 3.7233s
	iters: 300, epoch: 8 | loss: 0.7683844
	speed: 0.0119s/iter; left time: 2.6749s
	iters: 400, epoch: 8 | loss: 0.7317517
	speed: 0.0132s/iter; left time: 1.6411s
	iters: 500, epoch: 8 | loss: 0.7375212
	speed: 0.0128s/iter; left time: 0.3073s
Updating learning rate to 2.567104966640625e-05
Epoch: 8 cost time: 6.566157341003418
Epoch: 8, Steps: 523 | Train Loss: 0.7502516 Vali Loss: 0.3223320 Best vali loss: 0.3207556

best validation loss 0.32075559898972644

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029231680578149597
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 1.1220312118530273
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2844891 Best vali loss: 0.2844891
Updating learning rate to 0.0025938006666821026
Epoch: 2 cost time: 0.7542040348052979
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2979211 Best vali loss: 0.2844891
Updating learning rate to 0.0021008675310785706
Epoch: 3 cost time: 0.6261081695556641
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2966625 Best vali loss: 0.2844891

best validation loss 0.284489135919073

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0118662500741, 'e_layers': 3, 'learning_rate': 0.0003750615196, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036078659049551044
Validation loss decreased (inf --> 0.3099).  Saving model state dict ...
Epoch: 1 cost time: 1.2242681980133057
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3098542 Best vali loss: 0.3098542
Updating learning rate to 0.0003201350317356456
Validation loss decreased (0.3099 --> 0.2950).  Saving model state dict ...
Epoch: 2 cost time: 0.8223047256469727
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2949947 Best vali loss: 0.2949947
Updating learning rate to 0.0002592956746342972
Validation loss decreased (0.2950 --> 0.2884).  Saving model state dict ...
Epoch: 3 cost time: 0.7726178169250488
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2883537 Best vali loss: 0.2883537

best validation loss 0.288353663288381

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047627831688, 'e_layers': 3, 'learning_rate': 0.0015982189843, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3456308
	speed: 0.0139s/iter; left time: 114.8666s
	iters: 200, epoch: 1 | loss: 0.6214901
	speed: 0.0059s/iter; left time: 48.3728s
	iters: 300, epoch: 1 | loss: 1.4456466
	speed: 0.0061s/iter; left time: 49.3528s
	iters: 400, epoch: 1 | loss: 0.5187279
	speed: 0.0063s/iter; left time: 50.2020s
	iters: 500, epoch: 1 | loss: 0.3408405
	speed: 0.0081s/iter; left time: 63.7629s
	iters: 600, epoch: 1 | loss: 0.4076458
	speed: 0.0085s/iter; left time: 65.7693s
	iters: 700, epoch: 1 | loss: 0.2697533
	speed: 0.0066s/iter; left time: 50.9073s
	iters: 800, epoch: 1 | loss: 0.2627886
	speed: 0.0089s/iter; left time: 67.2399s
	iters: 900, epoch: 1 | loss: 0.3265430
	speed: 0.0081s/iter; left time: 60.7934s
	iters: 1000, epoch: 1 | loss: 1.5541537
	speed: 0.0093s/iter; left time: 68.1717s
Updating learning rate to 0.0015373903961828739
Validation loss decreased (inf --> 0.3117).  Saving model state dict ...
Epoch: 1 cost time: 8.263074398040771
Epoch: 1, Steps: 1045 | Train Loss: 0.6093220 Vali Loss: 0.3116727 Best vali loss: 0.3116727
	iters: 100, epoch: 2 | loss: 0.3733133
	speed: 0.0228s/iter; left time: 164.4707s
	iters: 200, epoch: 2 | loss: 0.3551012
	speed: 0.0071s/iter; left time: 50.7067s
	iters: 300, epoch: 2 | loss: 0.4488342
	speed: 0.0082s/iter; left time: 57.7606s
	iters: 400, epoch: 2 | loss: 0.2627557
	speed: 0.0096s/iter; left time: 66.1267s
	iters: 500, epoch: 2 | loss: 0.3082530
	speed: 0.0082s/iter; left time: 55.8235s
	iters: 600, epoch: 2 | loss: 0.3689936
	speed: 0.0071s/iter; left time: 47.8200s
	iters: 700, epoch: 2 | loss: 0.2812534
	speed: 0.0117s/iter; left time: 77.4501s
	iters: 800, epoch: 2 | loss: 0.1701334
	speed: 0.0098s/iter; left time: 63.6245s
	iters: 900, epoch: 2 | loss: 0.6361220
	speed: 0.0095s/iter; left time: 61.2042s
	iters: 1000, epoch: 2 | loss: 0.2192302
	speed: 0.0061s/iter; left time: 38.7156s
Updating learning rate to 0.0013641652329598032
Epoch: 2 cost time: 9.101304531097412
Epoch: 2, Steps: 1045 | Train Loss: 0.3423990 Vali Loss: 0.3201124 Best vali loss: 0.3116727
	iters: 100, epoch: 3 | loss: 0.4652928
	speed: 0.0290s/iter; left time: 179.0002s
	iters: 200, epoch: 3 | loss: 0.3455755
	speed: 0.0082s/iter; left time: 49.5250s
	iters: 300, epoch: 3 | loss: 0.7101310
	speed: 0.0080s/iter; left time: 47.5479s
	iters: 400, epoch: 3 | loss: 1.2577052
	speed: 0.0098s/iter; left time: 57.4762s
	iters: 500, epoch: 3 | loss: 0.4900457
	speed: 0.0083s/iter; left time: 48.1521s
	iters: 600, epoch: 3 | loss: 1.6628376
	speed: 0.0097s/iter; left time: 55.1167s
	iters: 700, epoch: 3 | loss: 1.2674706
	speed: 0.0089s/iter; left time: 49.3556s
	iters: 800, epoch: 3 | loss: 0.3130464
	speed: 0.0098s/iter; left time: 53.5735s
	iters: 900, epoch: 3 | loss: 0.3543531
	speed: 0.0073s/iter; left time: 39.0199s
	iters: 1000, epoch: 3 | loss: 0.4041407
	speed: 0.0085s/iter; left time: 44.9409s
Updating learning rate to 0.0011049154554414859
Epoch: 3 cost time: 9.147741317749023
Epoch: 3, Steps: 1045 | Train Loss: 0.7270599 Vali Loss: 0.3259180 Best vali loss: 0.3116727

best validation loss 0.31167274363846

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00151941325245
Epoch: 4 cost time: 3.063828706741333
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2916532 Best vali loss: 0.2844891
Updating learning rate to 0.0009379589738214294
Epoch: 5 cost time: 2.9291865825653076
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2945779 Best vali loss: 0.2844891
Updating learning rate to 0.0004450258382178974
Epoch: 6 cost time: 2.5299251079559326
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3040063 Best vali loss: 0.2844891
Updating learning rate to 0.0001156584470850403
Epoch: 7 cost time: 2.884246826171875
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3011893 Best vali loss: 0.2844891
Updating learning rate to 0.0
Epoch: 8 cost time: 2.358191967010498
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2997112 Best vali loss: 0.2844891

best validation loss 0.284489135919073

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0013602383229, 'e_layers': 1, 'learning_rate': 0.0004227075832, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2927373
	speed: 0.0114s/iter; left time: 94.2523s
	iters: 200, epoch: 1 | loss: 0.2847356
	speed: 0.0067s/iter; left time: 54.5863s
	iters: 300, epoch: 1 | loss: 1.2182968
	speed: 0.0059s/iter; left time: 47.7316s
	iters: 400, epoch: 1 | loss: 0.2678319
	speed: 0.0073s/iter; left time: 58.4166s
	iters: 500, epoch: 1 | loss: 1.5518409
	speed: 0.0063s/iter; left time: 49.4368s
	iters: 600, epoch: 1 | loss: 0.2766273
	speed: 0.0061s/iter; left time: 47.4984s
	iters: 700, epoch: 1 | loss: 0.2707927
	speed: 0.0060s/iter; left time: 46.2471s
	iters: 800, epoch: 1 | loss: 0.2746958
	speed: 0.0067s/iter; left time: 50.9652s
	iters: 900, epoch: 1 | loss: 0.1975908
	speed: 0.0080s/iter; left time: 59.8639s
	iters: 1000, epoch: 1 | loss: 0.5066796
	speed: 0.0043s/iter; left time: 31.9712s
Updating learning rate to 0.0004227075832
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 6.849226713180542
Epoch: 1, Steps: 1045 | Train Loss: 0.5141829 Vali Loss: 0.2813525 Best vali loss: 0.2813525
	iters: 100, epoch: 2 | loss: 1.0725453
	speed: 0.0220s/iter; left time: 159.1113s
	iters: 200, epoch: 2 | loss: 0.4743695
	speed: 0.0044s/iter; left time: 31.3999s
	iters: 300, epoch: 2 | loss: 0.3736897
	speed: 0.0049s/iter; left time: 34.6134s
	iters: 400, epoch: 2 | loss: 0.3027532
	speed: 0.0057s/iter; left time: 39.7544s
	iters: 500, epoch: 2 | loss: 0.2969264
	speed: 0.0042s/iter; left time: 28.8834s
	iters: 600, epoch: 2 | loss: 0.5306447
	speed: 0.0045s/iter; left time: 30.2351s
	iters: 700, epoch: 2 | loss: 0.3464064
	speed: 0.0051s/iter; left time: 33.6273s
	iters: 800, epoch: 2 | loss: 0.2555178
	speed: 0.0040s/iter; left time: 26.3085s
	iters: 900, epoch: 2 | loss: 0.6718009
	speed: 0.0040s/iter; left time: 25.6340s
	iters: 1000, epoch: 2 | loss: 0.2026015
	speed: 0.0054s/iter; left time: 34.3892s
Updating learning rate to 0.0002113537916
Epoch: 2 cost time: 4.960096120834351
Epoch: 2, Steps: 1045 | Train Loss: 0.4527255 Vali Loss: 0.2858851 Best vali loss: 0.2813525
	iters: 100, epoch: 3 | loss: 0.3010548
	speed: 0.0163s/iter; left time: 100.6360s
	iters: 200, epoch: 3 | loss: 0.4308450
	speed: 0.0044s/iter; left time: 26.6238s
	iters: 300, epoch: 3 | loss: 0.4792958
	speed: 0.0053s/iter; left time: 31.4228s
	iters: 400, epoch: 3 | loss: 0.3683090
	speed: 0.0051s/iter; left time: 30.0273s
	iters: 500, epoch: 3 | loss: 0.3309884
	speed: 0.0049s/iter; left time: 28.4576s
	iters: 600, epoch: 3 | loss: 0.6303920
	speed: 0.0054s/iter; left time: 30.4856s
	iters: 700, epoch: 3 | loss: 0.4478395
	speed: 0.0051s/iter; left time: 28.3185s
	iters: 800, epoch: 3 | loss: 1.1700550
	speed: 0.0049s/iter; left time: 26.9164s
	iters: 900, epoch: 3 | loss: 0.3850287
	speed: 0.0044s/iter; left time: 23.8576s
	iters: 1000, epoch: 3 | loss: 0.3027028
	speed: 0.0043s/iter; left time: 22.4519s
Updating learning rate to 0.0001056768958
Epoch: 3 cost time: 5.124794006347656
Epoch: 3, Steps: 1045 | Train Loss: 0.4846511 Vali Loss: 0.2882886 Best vali loss: 0.2813525
	iters: 100, epoch: 4 | loss: 0.4462199
	speed: 0.0229s/iter; left time: 117.6080s
	iters: 200, epoch: 4 | loss: 0.2520882
	speed: 0.0055s/iter; left time: 27.7813s
	iters: 300, epoch: 4 | loss: 0.1532318
	speed: 0.0047s/iter; left time: 23.1390s
	iters: 400, epoch: 4 | loss: 0.1762446
	speed: 0.0037s/iter; left time: 17.6352s
	iters: 500, epoch: 4 | loss: 0.2656897
	speed: 0.0041s/iter; left time: 19.5701s
	iters: 600, epoch: 4 | loss: 0.2886161
	speed: 0.0047s/iter; left time: 21.7062s
	iters: 700, epoch: 4 | loss: 0.3667814
	speed: 0.0051s/iter; left time: 22.9622s
	iters: 800, epoch: 4 | loss: 0.2229310
	speed: 0.0056s/iter; left time: 24.6803s
	iters: 900, epoch: 4 | loss: 0.3994882
	speed: 0.0057s/iter; left time: 24.6082s
	iters: 1000, epoch: 4 | loss: 0.5951764
	speed: 0.0056s/iter; left time: 23.8051s
Updating learning rate to 5.28384479e-05
Epoch: 4 cost time: 5.310236215591431
Epoch: 4, Steps: 1045 | Train Loss: 0.3166467 Vali Loss: 0.2923917 Best vali loss: 0.2813525
	iters: 100, epoch: 5 | loss: 0.2283742
	speed: 0.0231s/iter; left time: 94.0752s
	iters: 200, epoch: 5 | loss: 0.5324989
	speed: 0.0051s/iter; left time: 20.3045s
	iters: 300, epoch: 5 | loss: 0.3947540
	speed: 0.0051s/iter; left time: 19.8213s
	iters: 400, epoch: 5 | loss: 0.6477770
	speed: 0.0056s/iter; left time: 21.2121s
	iters: 500, epoch: 5 | loss: 0.7087433
	speed: 0.0055s/iter; left time: 20.3780s
	iters: 600, epoch: 5 | loss: 0.2546003
	speed: 0.0057s/iter; left time: 20.3566s
	iters: 700, epoch: 5 | loss: 0.1797115
	speed: 0.0056s/iter; left time: 19.4359s
	iters: 800, epoch: 5 | loss: 0.2463692
	speed: 0.0049s/iter; left time: 16.4676s
	iters: 900, epoch: 5 | loss: 0.2885793
	speed: 0.0050s/iter; left time: 16.4473s
	iters: 1000, epoch: 5 | loss: 0.4454895
	speed: 0.0049s/iter; left time: 15.4614s
Updating learning rate to 2.641922395e-05
Epoch: 5 cost time: 5.607351303100586
Epoch: 5, Steps: 1045 | Train Loss: 0.3926897 Vali Loss: 0.2980961 Best vali loss: 0.2813525
	iters: 100, epoch: 6 | loss: 0.1469164
	speed: 0.0214s/iter; left time: 65.0736s
	iters: 200, epoch: 6 | loss: 0.1654114
	speed: 0.0056s/iter; left time: 16.4535s
	iters: 300, epoch: 6 | loss: 0.6616565
	speed: 0.0057s/iter; left time: 16.0452s
	iters: 400, epoch: 6 | loss: 0.4262793
	speed: 0.0055s/iter; left time: 15.1826s
	iters: 500, epoch: 6 | loss: 0.3474383
	speed: 0.0057s/iter; left time: 15.0024s
	iters: 600, epoch: 6 | loss: 0.4548902
	speed: 0.0055s/iter; left time: 13.9982s
	iters: 700, epoch: 6 | loss: 0.3917390
	speed: 0.0052s/iter; left time: 12.6036s
	iters: 800, epoch: 6 | loss: 0.1741660
	speed: 0.0051s/iter; left time: 11.8166s
	iters: 900, epoch: 6 | loss: 0.8160695
	speed: 0.0055s/iter; left time: 12.4066s
	iters: 1000, epoch: 6 | loss: 0.3045810
	speed: 0.0060s/iter; left time: 12.8823s
Updating learning rate to 1.3209611975e-05
Epoch: 6 cost time: 5.870476722717285
Epoch: 6, Steps: 1045 | Train Loss: 0.3889148 Vali Loss: 0.2968076 Best vali loss: 0.2813525
	iters: 100, epoch: 7 | loss: 0.2797472
	speed: 0.0215s/iter; left time: 42.8555s
	iters: 200, epoch: 7 | loss: 0.4080052
	speed: 0.0041s/iter; left time: 7.6860s
	iters: 300, epoch: 7 | loss: 0.2189255
	speed: 0.0046s/iter; left time: 8.2508s
	iters: 400, epoch: 7 | loss: 0.4081308
	speed: 0.0057s/iter; left time: 9.7088s
	iters: 500, epoch: 7 | loss: 0.2779137
	speed: 0.0039s/iter; left time: 6.2689s
	iters: 600, epoch: 7 | loss: 0.2914640
	speed: 0.0045s/iter; left time: 6.6623s
	iters: 700, epoch: 7 | loss: 0.2627251
	speed: 0.0043s/iter; left time: 6.0478s
	iters: 800, epoch: 7 | loss: 0.3133622
	speed: 0.0047s/iter; left time: 6.0976s
	iters: 900, epoch: 7 | loss: 0.8123163
	speed: 0.0059s/iter; left time: 7.0195s
	iters: 1000, epoch: 7 | loss: 0.8017671
	speed: 0.0061s/iter; left time: 6.6683s
Updating learning rate to 6.6048059875e-06
Epoch: 7 cost time: 5.195200204849243
Epoch: 7, Steps: 1045 | Train Loss: 0.4074357 Vali Loss: 0.2997522 Best vali loss: 0.2813525
	iters: 100, epoch: 8 | loss: 0.3460066
	speed: 0.0244s/iter; left time: 23.0466s
	iters: 200, epoch: 8 | loss: 0.2765963
	speed: 0.0045s/iter; left time: 3.8385s
	iters: 300, epoch: 8 | loss: 0.4725455
	speed: 0.0040s/iter; left time: 3.0117s
	iters: 400, epoch: 8 | loss: 0.3384655
	speed: 0.0033s/iter; left time: 2.1529s
	iters: 500, epoch: 8 | loss: 0.3712249
	speed: 0.0039s/iter; left time: 2.1184s
	iters: 600, epoch: 8 | loss: 0.1660957
	speed: 0.0043s/iter; left time: 1.9202s
	iters: 700, epoch: 8 | loss: 0.3885205
	speed: 0.0056s/iter; left time: 1.9540s
	iters: 800, epoch: 8 | loss: 0.1637577
	speed: 0.0052s/iter; left time: 1.2783s
	iters: 900, epoch: 8 | loss: 0.3451452
	speed: 0.0050s/iter; left time: 0.7241s
	iters: 1000, epoch: 8 | loss: 0.2207006
	speed: 0.0077s/iter; left time: 0.3541s
Updating learning rate to 3.30240299375e-06
Epoch: 8 cost time: 5.28677773475647
Epoch: 8, Steps: 1045 | Train Loss: 0.3089059 Vali Loss: 0.2980310 Best vali loss: 0.2813525

best validation loss 0.2813524536015421

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010436703114, 'e_layers': 3, 'learning_rate': 0.0001549877333, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4843147
	speed: 0.0212s/iter; left time: 42.2952s
	iters: 200, epoch: 1 | loss: 0.4015215
	speed: 0.0144s/iter; left time: 27.3628s
Updating learning rate to 0.0001549877333
Validation loss decreased (inf --> 0.2909).  Saving model state dict ...
Epoch: 1 cost time: 4.147290945053101
Epoch: 1, Steps: 262 | Train Loss: 0.4429181 Vali Loss: 0.2908886 Best vali loss: 0.2908886
	iters: 100, epoch: 2 | loss: 0.6826084
	speed: 0.0435s/iter; left time: 75.5405s
	iters: 200, epoch: 2 | loss: 0.3412239
	speed: 0.0134s/iter; left time: 21.8447s
Updating learning rate to 7.749386665e-05
Validation loss decreased (0.2909 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 3.4600417613983154
Epoch: 2, Steps: 262 | Train Loss: 0.5119161 Vali Loss: 0.2828251 Best vali loss: 0.2828251
	iters: 100, epoch: 3 | loss: 0.4750421
	speed: 0.0478s/iter; left time: 70.3559s
	iters: 200, epoch: 3 | loss: 0.3359601
	speed: 0.0157s/iter; left time: 21.4903s
Updating learning rate to 3.8746933325e-05
Validation loss decreased (0.2828 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 4.248079538345337
Epoch: 3, Steps: 262 | Train Loss: 0.4055011 Vali Loss: 0.2818931 Best vali loss: 0.2818931
	iters: 100, epoch: 4 | loss: 0.5651632
	speed: 0.0537s/iter; left time: 65.0443s
	iters: 200, epoch: 4 | loss: 0.3802795
	speed: 0.0122s/iter; left time: 13.6060s
Updating learning rate to 1.93734666625e-05
Validation loss decreased (0.2819 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 3.644700288772583
Epoch: 4, Steps: 262 | Train Loss: 0.4727214 Vali Loss: 0.2818333 Best vali loss: 0.2818333
	iters: 100, epoch: 5 | loss: 0.3651850
	speed: 0.0531s/iter; left time: 50.3797s
	iters: 200, epoch: 5 | loss: 0.6090442
	speed: 0.0129s/iter; left time: 10.9870s
Updating learning rate to 9.68673333125e-06
Validation loss decreased (0.2818 --> 0.2817).  Saving model state dict ...
Epoch: 5 cost time: 3.7721598148345947
Epoch: 5, Steps: 262 | Train Loss: 0.4871146 Vali Loss: 0.2817148 Best vali loss: 0.2817148
	iters: 100, epoch: 6 | loss: 0.2620395
	speed: 0.0428s/iter; left time: 29.3942s
	iters: 200, epoch: 6 | loss: 0.3520226
	speed: 0.0141s/iter; left time: 8.2924s
Updating learning rate to 4.843366665625e-06
Epoch: 6 cost time: 3.159789800643921
Epoch: 6, Steps: 262 | Train Loss: 0.3070310 Vali Loss: 0.2817563 Best vali loss: 0.2817148
	iters: 100, epoch: 7 | loss: 0.5779186
	speed: 0.0437s/iter; left time: 18.5724s
	iters: 200, epoch: 7 | loss: 0.7658541
	speed: 0.0140s/iter; left time: 4.5394s
Updating learning rate to 2.4216833328125e-06
Epoch: 7 cost time: 3.677377700805664
Epoch: 7, Steps: 262 | Train Loss: 0.6718864 Vali Loss: 0.2818362 Best vali loss: 0.2817148
	iters: 100, epoch: 8 | loss: 0.6727694
	speed: 0.0462s/iter; left time: 7.5232s
	iters: 200, epoch: 8 | loss: 0.2921755
	speed: 0.0138s/iter; left time: 0.8674s
Updating learning rate to 1.21084166640625e-06
Epoch: 8 cost time: 3.4853436946868896
Epoch: 8, Steps: 262 | Train Loss: 0.4824724 Vali Loss: 0.2818015 Best vali loss: 0.2817148

best validation loss 0.28171476311690746

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.010984893356, 'e_layers': 2, 'learning_rate': 0.001815341793, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4972275
	speed: 0.0208s/iter; left time: 19.6978s
Updating learning rate to 0.001815341793
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 1.982637882232666
Epoch: 1, Steps: 131 | Train Loss: 0.4972275 Vali Loss: 0.2849166 Best vali loss: 0.2849166
	iters: 100, epoch: 2 | loss: 0.4814841
	speed: 0.0131s/iter; left time: 10.7533s
Updating learning rate to 0.0009076708965
Epoch: 2 cost time: 1.0547754764556885
Epoch: 2, Steps: 131 | Train Loss: 0.4814841 Vali Loss: 0.2951248 Best vali loss: 0.2849166
	iters: 100, epoch: 3 | loss: 0.4139850
	speed: 0.0133s/iter; left time: 9.1677s
Updating learning rate to 0.00045383544825
Epoch: 3 cost time: 1.0831501483917236
Epoch: 3, Steps: 131 | Train Loss: 0.4139850 Vali Loss: 0.2923268 Best vali loss: 0.2849166

best validation loss 0.28491664805590505

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0018477877600639972
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 0.9755859375
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2875234 Best vali loss: 0.2875234
Updating learning rate to 0.0016395886343680123
Validation loss decreased (0.2875 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 0.683002233505249
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2868048 Best vali loss: 0.2868048
Updating learning rate to 0.0013279966230694852
Epoch: 3 cost time: 0.6705756187438965
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3109008 Best vali loss: 0.2868048

best validation loss 0.2868048374528289

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5856238
	speed: 0.0129s/iter; left time: 25.7398s
	iters: 200, epoch: 1 | loss: 0.9246839
	speed: 0.0067s/iter; left time: 12.7703s
Updating learning rate to 0.0006618030633303181
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 2.053290605545044
Epoch: 1, Steps: 262 | Train Loss: 0.7551539 Vali Loss: 0.2821055 Best vali loss: 0.2821055
	iters: 100, epoch: 2 | loss: 0.4246677
	speed: 0.0137s/iter; left time: 23.7674s
	iters: 200, epoch: 2 | loss: 0.4430466
	speed: 0.0065s/iter; left time: 10.5945s
Updating learning rate to 0.0005872345321676674
Validation loss decreased (0.2821 --> 0.2804).  Saving model state dict ...
Epoch: 2 cost time: 1.6336987018585205
Epoch: 2, Steps: 262 | Train Loss: 0.4338571 Vali Loss: 0.2804005 Best vali loss: 0.2804005
	iters: 100, epoch: 3 | loss: 0.4099523
	speed: 0.0135s/iter; left time: 19.9203s
	iters: 200, epoch: 3 | loss: 0.3627608
	speed: 0.0066s/iter; left time: 9.0388s
Updating learning rate to 0.0004756348387161433
Epoch: 3 cost time: 1.701197862625122
Epoch: 3, Steps: 262 | Train Loss: 0.3863566 Vali Loss: 0.2850630 Best vali loss: 0.2804005

best validation loss 0.2804005413460616

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4962224
	speed: 0.0124s/iter; left time: 15.0485s
	iters: 200, epoch: 4 | loss: 0.7136126
	speed: 0.0060s/iter; left time: 6.7018s
Updating learning rate to 0.00034399402465
Epoch: 4 cost time: 1.9259421825408936
Epoch: 4, Steps: 262 | Train Loss: 0.6049175 Vali Loss: 0.2937737 Best vali loss: 0.2804005
	iters: 100, epoch: 5 | loss: 0.4015040
	speed: 0.0139s/iter; left time: 13.1604s
	iters: 200, epoch: 5 | loss: 0.3431883
	speed: 0.0055s/iter; left time: 4.6888s
Updating learning rate to 0.00021235321058385673
Epoch: 5 cost time: 1.5220201015472412
Epoch: 5, Steps: 262 | Train Loss: 0.3723461 Vali Loss: 0.2953155 Best vali loss: 0.2804005
	iters: 100, epoch: 6 | loss: 0.3406821
	speed: 0.0150s/iter; left time: 10.3273s
	iters: 200, epoch: 6 | loss: 0.3465636
	speed: 0.0058s/iter; left time: 3.4304s
Updating learning rate to 0.00010075351713233263
Epoch: 6 cost time: 1.6676099300384521
Epoch: 6, Steps: 262 | Train Loss: 0.3436228 Vali Loss: 0.2983912 Best vali loss: 0.2804005
	iters: 100, epoch: 7 | loss: 0.3566679
	speed: 0.0136s/iter; left time: 5.7863s
	iters: 200, epoch: 7 | loss: 0.4286885
	speed: 0.0065s/iter; left time: 2.0973s
Updating learning rate to 2.6184985969681952e-05
Epoch: 7 cost time: 1.7234923839569092
Epoch: 7, Steps: 262 | Train Loss: 0.3926782 Vali Loss: 0.3002194 Best vali loss: 0.2804005
	iters: 100, epoch: 8 | loss: 0.6750600
	speed: 0.0122s/iter; left time: 1.9810s
	iters: 200, epoch: 8 | loss: 0.3757658
	speed: 0.0035s/iter; left time: 0.2230s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9699554443359375
Epoch: 8, Steps: 262 | Train Loss: 0.5254129 Vali Loss: 0.3016380 Best vali loss: 0.2804005

best validation loss 0.2804005413460616

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032599720922, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.3274).  Saving model state dict ...
Epoch: 1 cost time: 0.8299143314361572
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3273864 Best vali loss: 0.3273864
Updating learning rate to 0.0002152265254906771
Validation loss decreased (0.3274 --> 0.3090).  Saving model state dict ...
Epoch: 2 cost time: 0.5335259437561035
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3089525 Best vali loss: 0.3089525
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.3090 --> 0.2996).  Saving model state dict ...
Epoch: 3 cost time: 2.420848846435547
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2995876 Best vali loss: 0.2995876
Updating learning rate to 0.00012607677965
Validation loss decreased (0.2996 --> 0.2941).  Saving model state dict ...
Epoch: 4 cost time: 2.5852878093719482
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2940694 Best vali loss: 0.2940694
Updating learning rate to 7.782928487200091e-05
Validation loss decreased (0.2941 --> 0.2916).  Saving model state dict ...
Epoch: 5 cost time: 1.4651317596435547
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2915830 Best vali loss: 0.2915830
Updating learning rate to 3.692703380932289e-05
Validation loss decreased (0.2916 --> 0.2905).  Saving model state dict ...
Epoch: 6 cost time: 2.568068027496338
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2904890 Best vali loss: 0.2904890
Updating learning rate to 9.59702340642949e-06
Validation loss decreased (0.2905 --> 0.2899).  Saving model state dict ...
Epoch: 7 cost time: 2.4364748001098633
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2899164 Best vali loss: 0.2899164
Updating learning rate to 0.0
Validation loss decreased (0.2899 --> 0.2897).  Saving model state dict ...
Epoch: 8 cost time: 0.5705351829528809
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2897247 Best vali loss: 0.2897247

best validation loss 0.2897246522990333

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 3, 'learning_rate': 0.0006514874423, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5771227
	speed: 0.0227s/iter; left time: 21.5678s
Updating learning rate to 0.0006514874423
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 2.4561030864715576
Epoch: 1, Steps: 131 | Train Loss: 0.5771227 Vali Loss: 0.2818560 Best vali loss: 0.2818560
	iters: 100, epoch: 2 | loss: 0.8383065
	speed: 0.0271s/iter; left time: 22.1437s
Updating learning rate to 0.00032574372115
Epoch: 2 cost time: 2.1297378540039062
Epoch: 2, Steps: 131 | Train Loss: 0.8383065 Vali Loss: 0.2820807 Best vali loss: 0.2818560
	iters: 100, epoch: 3 | loss: 0.4536718
	speed: 0.0242s/iter; left time: 16.5915s
Updating learning rate to 0.000162871860575
Epoch: 3 cost time: 1.6050207614898682
Epoch: 3, Steps: 131 | Train Loss: 0.4536718 Vali Loss: 0.2923682 Best vali loss: 0.2818560
	iters: 100, epoch: 4 | loss: 0.4008602
	speed: 0.0189s/iter; left time: 10.5127s
Updating learning rate to 8.14359302875e-05
Epoch: 4 cost time: 1.7995738983154297
Epoch: 4, Steps: 131 | Train Loss: 0.4008602 Vali Loss: 0.2912299 Best vali loss: 0.2818560
	iters: 100, epoch: 5 | loss: 0.3450939
	speed: 0.0356s/iter; left time: 15.1505s
Updating learning rate to 4.071796514375e-05
Epoch: 5 cost time: 3.2034475803375244
Epoch: 5, Steps: 131 | Train Loss: 0.3450939 Vali Loss: 0.2875015 Best vali loss: 0.2818560
	iters: 100, epoch: 6 | loss: 0.3709295
	speed: 0.0339s/iter; left time: 9.9754s
Updating learning rate to 2.0358982571875e-05
Epoch: 6 cost time: 2.4724161624908447
Epoch: 6, Steps: 131 | Train Loss: 0.3709295 Vali Loss: 0.2892985 Best vali loss: 0.2818560
	iters: 100, epoch: 7 | loss: 0.3492318
	speed: 0.0297s/iter; left time: 4.8485s
Updating learning rate to 1.01794912859375e-05
Epoch: 7 cost time: 2.2501776218414307
Epoch: 7, Steps: 131 | Train Loss: 0.3492318 Vali Loss: 0.2914742 Best vali loss: 0.2818560
	iters: 100, epoch: 8 | loss: 0.3868380
	speed: 0.0287s/iter; left time: 0.9179s
Updating learning rate to 5.08974564296875e-06
Epoch: 8 cost time: 2.1883347034454346
Epoch: 8, Steps: 131 | Train Loss: 0.3868380 Vali Loss: 0.2909685 Best vali loss: 0.2818560

best validation loss 0.2818559779165269

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0065094553439, 'e_layers': 1, 'learning_rate': 0.0006735335754, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3146007
	speed: 0.0134s/iter; left time: 12.7019s
Updating learning rate to 0.0006478987300856038
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.2653872966766357
Epoch: 1, Steps: 131 | Train Loss: 0.3146007 Vali Loss: 0.2873846 Best vali loss: 0.2873846
	iters: 100, epoch: 2 | loss: 0.4803473
	speed: 0.0142s/iter; left time: 11.5837s
Updating learning rate to 0.0005748968669610804
Validation loss decreased (0.2874 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 1.1162421703338623
Epoch: 2, Steps: 131 | Train Loss: 0.4803473 Vali Loss: 0.2818658 Best vali loss: 0.2818658
	iters: 100, epoch: 3 | loss: 0.4518289
	speed: 0.0144s/iter; left time: 9.9142s
Updating learning rate to 0.00046564185792360155
Epoch: 3 cost time: 1.0133156776428223
Epoch: 3, Steps: 131 | Train Loss: 0.4518289 Vali Loss: 0.2827294 Best vali loss: 0.2818658

best validation loss 0.28186575432788397

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029036262858, 'e_layers': 2, 'learning_rate': 0.0030636692136, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5368747
	speed: 0.0124s/iter; left time: 102.8312s
	iters: 200, epoch: 1 | loss: 0.4281480
	speed: 0.0072s/iter; left time: 59.0264s
	iters: 300, epoch: 1 | loss: 0.2479777
	speed: 0.0071s/iter; left time: 56.8851s
	iters: 400, epoch: 1 | loss: 0.2358195
	speed: 0.0070s/iter; left time: 55.5623s
	iters: 500, epoch: 1 | loss: 0.6513875
	speed: 0.0071s/iter; left time: 55.7348s
	iters: 600, epoch: 1 | loss: 1.3514119
	speed: 0.0069s/iter; left time: 53.7815s
	iters: 700, epoch: 1 | loss: 0.2526913
	speed: 0.0064s/iter; left time: 49.3845s
	iters: 800, epoch: 1 | loss: 0.4556429
	speed: 0.0060s/iter; left time: 45.5475s
	iters: 900, epoch: 1 | loss: 1.0130233
	speed: 0.0062s/iter; left time: 46.3820s
	iters: 1000, epoch: 1 | loss: 0.4087719
	speed: 0.0066s/iter; left time: 48.4510s
Updating learning rate to 0.0030636692136
Validation loss decreased (inf --> 0.3225).  Saving model state dict ...
Epoch: 1 cost time: 7.306041240692139
Epoch: 1, Steps: 1045 | Train Loss: 0.5581749 Vali Loss: 0.3224758 Best vali loss: 0.3224758
	iters: 100, epoch: 2 | loss: 0.2472567
	speed: 0.0254s/iter; left time: 183.0404s
	iters: 200, epoch: 2 | loss: 0.2944811
	speed: 0.0067s/iter; left time: 47.9493s
	iters: 300, epoch: 2 | loss: 0.7412739
	speed: 0.0065s/iter; left time: 45.3167s
	iters: 400, epoch: 2 | loss: 0.7252117
	speed: 0.0069s/iter; left time: 47.8850s
	iters: 500, epoch: 2 | loss: 0.2399079
	speed: 0.0070s/iter; left time: 47.4297s
	iters: 600, epoch: 2 | loss: 0.3908111
	speed: 0.0066s/iter; left time: 44.6017s
	iters: 700, epoch: 2 | loss: 1.0162221
	speed: 0.0066s/iter; left time: 43.8880s
	iters: 800, epoch: 2 | loss: 0.5715377
	speed: 0.0070s/iter; left time: 45.7081s
	iters: 900, epoch: 2 | loss: 0.8911954
	speed: 0.0072s/iter; left time: 46.0458s
	iters: 1000, epoch: 2 | loss: 0.6289154
	speed: 0.0065s/iter; left time: 41.0012s
Updating learning rate to 0.0015318346068
Epoch: 2 cost time: 7.1573803424835205
Epoch: 2, Steps: 1045 | Train Loss: 0.5746813 Vali Loss: 0.3252261 Best vali loss: 0.3224758
	iters: 100, epoch: 3 | loss: 0.3804334
	speed: 0.0244s/iter; left time: 150.5435s
	iters: 200, epoch: 3 | loss: 1.2989817
	speed: 0.0070s/iter; left time: 42.4518s
	iters: 300, epoch: 3 | loss: 0.3363088
	speed: 0.0067s/iter; left time: 39.9009s
	iters: 400, epoch: 3 | loss: 0.4606727
	speed: 0.0056s/iter; left time: 32.6149s
	iters: 500, epoch: 3 | loss: 1.1514143
	speed: 0.0064s/iter; left time: 37.1884s
	iters: 600, epoch: 3 | loss: 0.3316070
	speed: 0.0075s/iter; left time: 42.7933s
	iters: 700, epoch: 3 | loss: 0.2002531
	speed: 0.0076s/iter; left time: 42.2648s
	iters: 800, epoch: 3 | loss: 0.7395659
	speed: 0.0070s/iter; left time: 38.0475s
	iters: 900, epoch: 3 | loss: 0.5406471
	speed: 0.0070s/iter; left time: 37.3416s
	iters: 1000, epoch: 3 | loss: 0.2973544
	speed: 0.0068s/iter; left time: 35.6685s
Updating learning rate to 0.0007659173034
Epoch: 3 cost time: 7.13005805015564
Epoch: 3, Steps: 1045 | Train Loss: 0.5737238 Vali Loss: 0.3245423 Best vali loss: 0.3224758

best validation loss 0.32247583615199127

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001591137315
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 1.8311080932617188
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2805110 Best vali loss: 0.2805110
Updating learning rate to 7.955686575e-05
Validation loss decreased (0.2805 --> 0.2747).  Saving model state dict ...
Epoch: 2 cost time: 1.3548059463500977
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2746703 Best vali loss: 0.2746703
Updating learning rate to 3.9778432875e-05
Validation loss decreased (0.2747 --> 0.2729).  Saving model state dict ...
Epoch: 3 cost time: 1.3156912326812744
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2728557 Best vali loss: 0.2728557

best validation loss 0.2728557020159803

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.98892164375e-05
Epoch: 4 cost time: 1.4948692321777344
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2732735 Best vali loss: 0.2728557
Updating learning rate to 9.94460821875e-06
Epoch: 5 cost time: 1.316178321838379
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2740697 Best vali loss: 0.2728557
Updating learning rate to 4.972304109375e-06
Epoch: 6 cost time: 1.3994567394256592
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2744181 Best vali loss: 0.2728557
Updating learning rate to 2.4861520546875e-06
Epoch: 7 cost time: 1.1976535320281982
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2747114 Best vali loss: 0.2728557
Updating learning rate to 1.24307602734375e-06
Epoch: 8 cost time: 1.3937263488769531
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2751077 Best vali loss: 0.2728557

best validation loss 0.2728557020159803

[INFO][abstract_intensifier.py:595] Added config bd4166 and rejected config 409f87 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.01186370118, 'e_layers': 4, 'learning_rate': 0.0002221655976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002221655976
Validation loss decreased (inf --> 0.2808).  Saving model state dict ...
Epoch: 1 cost time: 1.4362342357635498
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2808245 Best vali loss: 0.2808245
Updating learning rate to 0.0001110827988
Epoch: 2 cost time: 1.458237648010254
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2813825 Best vali loss: 0.2808245
Updating learning rate to 5.55413994e-05
Validation loss decreased (0.2808 --> 0.2772).  Saving model state dict ...
Epoch: 3 cost time: 1.5893809795379639
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2772039 Best vali loss: 0.2772039
Updating learning rate to 2.77706997e-05
Epoch: 4 cost time: 1.1834702491760254
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2794624 Best vali loss: 0.2772039
Updating learning rate to 1.388534985e-05
Epoch: 5 cost time: 1.0772955417633057
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2790977 Best vali loss: 0.2772039
Updating learning rate to 6.942674925e-06
Epoch: 6 cost time: 1.2357738018035889
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2801056 Best vali loss: 0.2772039
Updating learning rate to 3.4713374625e-06
Epoch: 7 cost time: 1.4140923023223877
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2808041 Best vali loss: 0.2772039
Updating learning rate to 1.73566873125e-06
Epoch: 8 cost time: 1.6675283908843994
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2811199 Best vali loss: 0.2772039

best validation loss 0.2772039484029013

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014508988157, 'e_layers': 3, 'learning_rate': 0.0010889710455, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010889710455
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 1.374143362045288
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2883825 Best vali loss: 0.2883825
Updating learning rate to 0.00054448552275
Validation loss decreased (0.2884 --> 0.2795).  Saving model state dict ...
Epoch: 2 cost time: 1.1759121417999268
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2795075 Best vali loss: 0.2795075
Updating learning rate to 0.000272242761375
Epoch: 3 cost time: 0.8761112689971924
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2805352 Best vali loss: 0.2795075
Updating learning rate to 0.0001361213806875
Validation loss decreased (0.2795 --> 0.2785).  Saving model state dict ...
Epoch: 4 cost time: 1.2572705745697021
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2784727 Best vali loss: 0.2784727
Updating learning rate to 6.806069034375e-05
Epoch: 5 cost time: 1.3038275241851807
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2805171 Best vali loss: 0.2784727
Updating learning rate to 3.4030345171875e-05
Epoch: 6 cost time: 0.839108943939209
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2824380 Best vali loss: 0.2784727
Updating learning rate to 1.70151725859375e-05
Epoch: 7 cost time: 1.5103015899658203
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2867794 Best vali loss: 0.2784727
Updating learning rate to 8.50758629296875e-06
Epoch: 8 cost time: 0.9800493717193604
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2868101 Best vali loss: 0.2784727

best validation loss 0.2784727231975868

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005760452490497884
Validation loss decreased (inf --> 0.3034).  Saving model state dict ...
Epoch: 1 cost time: 1.6260161399841309
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3034317 Best vali loss: 0.3034317
Updating learning rate to 0.0005111394628953558
Validation loss decreased (0.3034 --> 0.2882).  Saving model state dict ...
Epoch: 2 cost time: 1.356180191040039
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2881703 Best vali loss: 0.2881703
Updating learning rate to 0.00041400108930629814
Validation loss decreased (0.2882 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 2.6508283615112305
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2839317 Best vali loss: 0.2839317

best validation loss 0.28393165772734363

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 2, 'learning_rate': 0.0015995261445, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3393067
	speed: 0.0132s/iter; left time: 108.7737s
	iters: 200, epoch: 1 | loss: 0.9446703
	speed: 0.0062s/iter; left time: 50.6169s
	iters: 300, epoch: 1 | loss: 0.5503436
	speed: 0.0064s/iter; left time: 51.5370s
	iters: 400, epoch: 1 | loss: 0.6320789
	speed: 0.0061s/iter; left time: 48.4469s
	iters: 500, epoch: 1 | loss: 0.5763656
	speed: 0.0051s/iter; left time: 39.9848s
	iters: 600, epoch: 1 | loss: 1.2186087
	speed: 0.0063s/iter; left time: 48.8335s
	iters: 700, epoch: 1 | loss: 0.4783750
	speed: 0.0059s/iter; left time: 44.9696s
	iters: 800, epoch: 1 | loss: 0.5330713
	speed: 0.0059s/iter; left time: 44.5311s
	iters: 900, epoch: 1 | loss: 1.1889617
	speed: 0.0058s/iter; left time: 43.6061s
	iters: 1000, epoch: 1 | loss: 0.2518961
	speed: 0.0065s/iter; left time: 48.0777s
Updating learning rate to 0.0015386478055601205
Validation loss decreased (inf --> 0.3421).  Saving model state dict ...
Epoch: 1 cost time: 6.734037160873413
Epoch: 1, Steps: 1045 | Train Loss: 0.6713678 Vali Loss: 0.3420713 Best vali loss: 0.3420713
	iters: 100, epoch: 2 | loss: 0.3415400
	speed: 0.0223s/iter; left time: 160.9999s
	iters: 200, epoch: 2 | loss: 0.2091243
	speed: 0.0050s/iter; left time: 35.9067s
	iters: 300, epoch: 2 | loss: 0.9003318
	speed: 0.0048s/iter; left time: 33.9363s
	iters: 400, epoch: 2 | loss: 1.2062389
	speed: 0.0055s/iter; left time: 37.7354s
	iters: 500, epoch: 2 | loss: 0.3738175
	speed: 0.0058s/iter; left time: 39.7276s
	iters: 600, epoch: 2 | loss: 0.2845034
	speed: 0.0061s/iter; left time: 40.8746s
	iters: 700, epoch: 2 | loss: 0.5755222
	speed: 0.0061s/iter; left time: 40.2575s
	iters: 800, epoch: 2 | loss: 1.4012572
	speed: 0.0060s/iter; left time: 39.0478s
	iters: 900, epoch: 2 | loss: 0.8873377
	speed: 0.0063s/iter; left time: 40.2358s
	iters: 1000, epoch: 2 | loss: 1.6018652
	speed: 0.0064s/iter; left time: 40.2064s
Updating learning rate to 0.0013652809639805618
Validation loss decreased (0.3421 --> 0.3288).  Saving model state dict ...
Epoch: 2 cost time: 6.245530128479004
Epoch: 2, Steps: 1045 | Train Loss: 0.7781538 Vali Loss: 0.3287561 Best vali loss: 0.3287561
	iters: 100, epoch: 3 | loss: 0.4493367
	speed: 0.0230s/iter; left time: 141.6503s
	iters: 200, epoch: 3 | loss: 1.3292843
	speed: 0.0060s/iter; left time: 36.3588s
	iters: 300, epoch: 3 | loss: 1.0568991
	speed: 0.0062s/iter; left time: 37.2249s
	iters: 400, epoch: 3 | loss: 0.4282964
	speed: 0.0051s/iter; left time: 30.1641s
	iters: 500, epoch: 3 | loss: 0.3693358
	speed: 0.0042s/iter; left time: 24.5001s
	iters: 600, epoch: 3 | loss: 0.2303149
	speed: 0.0041s/iter; left time: 23.3097s
	iters: 700, epoch: 3 | loss: 0.5829258
	speed: 0.0070s/iter; left time: 38.8137s
	iters: 800, epoch: 3 | loss: 1.6851522
	speed: 0.0079s/iter; left time: 43.2103s
	iters: 900, epoch: 3 | loss: 0.9381122
	speed: 0.0086s/iter; left time: 46.3755s
	iters: 1000, epoch: 3 | loss: 0.5048494
	speed: 0.0077s/iter; left time: 40.4701s
Updating learning rate to 0.0011058191498174795
Validation loss decreased (0.3288 --> 0.3203).  Saving model state dict ...
Epoch: 3 cost time: 6.800676584243774
Epoch: 3, Steps: 1045 | Train Loss: 0.7574507 Vali Loss: 0.3203328 Best vali loss: 0.3203328

best validation loss 0.32033281682724846

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001776105869, 'e_layers': 3, 'learning_rate': 0.0035322605912, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5300411
	speed: 0.0179s/iter; left time: 35.7328s
	iters: 200, epoch: 1 | loss: 0.2942271
	speed: 0.0110s/iter; left time: 20.8926s
Updating learning rate to 0.0033978219274529487
Validation loss decreased (inf --> 0.3200).  Saving model state dict ...
Epoch: 1 cost time: 3.3177335262298584
Epoch: 1, Steps: 262 | Train Loss: 0.4121341 Vali Loss: 0.3200491 Best vali loss: 0.3200491
	iters: 100, epoch: 2 | loss: 0.3063243
	speed: 0.0255s/iter; left time: 44.3250s
	iters: 200, epoch: 2 | loss: 0.7039790
	speed: 0.0120s/iter; left time: 19.6710s
Updating learning rate to 0.003014973004077762
Epoch: 2 cost time: 2.8714120388031006
Epoch: 2, Steps: 262 | Train Loss: 0.5051516 Vali Loss: 0.3244897 Best vali loss: 0.3200491
	iters: 100, epoch: 3 | loss: 0.5264696
	speed: 0.0325s/iter; left time: 47.8209s
	iters: 200, epoch: 3 | loss: 0.7829925
	speed: 0.0112s/iter; left time: 15.3407s
Updating learning rate to 0.0024419990991241787
Epoch: 3 cost time: 2.8939502239227295
Epoch: 3, Steps: 262 | Train Loss: 0.6547311 Vali Loss: 0.3217884 Best vali loss: 0.3200491

best validation loss 0.320049057655416

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002994185651
Validation loss decreased (0.2839 --> 0.2825).  Saving model state dict ...
Epoch: 4 cost time: 1.605879545211792
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2824787 Best vali loss: 0.2824787
Updating learning rate to 0.00018483604089370196
Validation loss decreased (0.2825 --> 0.2821).  Saving model state dict ...
Epoch: 5 cost time: 1.5596511363983154
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2821349 Best vali loss: 0.2821349
Updating learning rate to 8.769766730464429e-05
Epoch: 6 cost time: 1.386622667312622
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2828900 Best vali loss: 0.2821349
Updating learning rate to 2.2791881150211728e-05
Epoch: 7 cost time: 1.00294828414917
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2826378 Best vali loss: 0.2821349
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6531951427459717
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2826733 Best vali loss: 0.2821349

best validation loss 0.2821348801548927

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0111045942676, 'e_layers': 2, 'learning_rate': 0.0002179765149, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002179765149
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 1.5705795288085938
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2785968 Best vali loss: 0.2785968
Updating learning rate to 0.00010898825745
Validation loss decreased (0.2786 --> 0.2774).  Saving model state dict ...
Epoch: 2 cost time: 1.0786888599395752
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2773568 Best vali loss: 0.2773568
Updating learning rate to 5.4494128725e-05
Validation loss decreased (0.2774 --> 0.2755).  Saving model state dict ...
Epoch: 3 cost time: 1.1616668701171875
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2754561 Best vali loss: 0.2754561
Updating learning rate to 2.72470643625e-05
Validation loss decreased (0.2755 --> 0.2749).  Saving model state dict ...
Epoch: 4 cost time: 0.6254665851593018
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2749297 Best vali loss: 0.2749297
Updating learning rate to 1.362353218125e-05
Epoch: 5 cost time: 1.3022184371948242
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2753881 Best vali loss: 0.2749297
Updating learning rate to 6.811766090625e-06
Validation loss decreased (0.2749 --> 0.2747).  Saving model state dict ...
Epoch: 6 cost time: 1.8446104526519775
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2746510 Best vali loss: 0.2746510
Updating learning rate to 3.4058830453125e-06
Epoch: 7 cost time: 1.9108047485351562
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2746513 Best vali loss: 0.2746510
Updating learning rate to 1.70294152265625e-06
Validation loss decreased (0.2747 --> 0.2746).  Saving model state dict ...
Epoch: 8 cost time: 1.3634188175201416
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2745980 Best vali loss: 0.2745980

best validation loss 0.2745980226021577

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017015780889, 'e_layers': 1, 'learning_rate': 0.0028702571024, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0028702571024
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 0.7975614070892334
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2878415 Best vali loss: 0.2878415
Updating learning rate to 0.0014351285512
Epoch: 2 cost time: 0.5695722103118896
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2950076 Best vali loss: 0.2878415
Updating learning rate to 0.0007175642756
Epoch: 3 cost time: 0.5537135601043701
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2898290 Best vali loss: 0.2878415
Updating learning rate to 0.0003587821378
Epoch: 4 cost time: 0.5270495414733887
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3051404 Best vali loss: 0.2878415
Updating learning rate to 0.0001793910689
Epoch: 5 cost time: 0.5497369766235352
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3041385 Best vali loss: 0.2878415
Updating learning rate to 8.969553445e-05
Epoch: 6 cost time: 0.5470249652862549
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3093971 Best vali loss: 0.2878415
Updating learning rate to 4.4847767225e-05
Epoch: 7 cost time: 0.5403332710266113
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3077076 Best vali loss: 0.2878415
Updating learning rate to 2.24238836125e-05
Epoch: 8 cost time: 0.550668478012085
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3127564 Best vali loss: 0.2878415

best validation loss 0.28784149774901263

[INFO][smbo.py:320] Finished 150 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.001707636708, 'e_layers': 2, 'learning_rate': 0.0007419627822, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2910743
	speed: 0.0154s/iter; left time: 127.3753s
	iters: 200, epoch: 1 | loss: 0.1484557
	speed: 0.0079s/iter; left time: 64.7346s
	iters: 300, epoch: 1 | loss: 0.2519150
	speed: 0.0083s/iter; left time: 66.6483s
	iters: 400, epoch: 1 | loss: 0.8528557
	speed: 0.0079s/iter; left time: 62.7188s
	iters: 500, epoch: 1 | loss: 0.3412840
	speed: 0.0087s/iter; left time: 68.1894s
	iters: 600, epoch: 1 | loss: 0.5483041
	speed: 0.0089s/iter; left time: 69.3096s
	iters: 700, epoch: 1 | loss: 0.2986288
	speed: 0.0078s/iter; left time: 59.7334s
	iters: 800, epoch: 1 | loss: 0.3117884
	speed: 0.0078s/iter; left time: 59.1926s
	iters: 900, epoch: 1 | loss: 0.3762615
	speed: 0.0066s/iter; left time: 48.8772s
	iters: 1000, epoch: 1 | loss: 0.4461572
	speed: 0.0044s/iter; left time: 32.7427s
Updating learning rate to 0.0007137235052798548
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 8.328884601593018
Epoch: 1, Steps: 1045 | Train Loss: 0.3866725 Vali Loss: 0.2802011 Best vali loss: 0.2802011
	iters: 100, epoch: 2 | loss: 0.8446575
	speed: 0.0436s/iter; left time: 314.5409s
	iters: 200, epoch: 2 | loss: 0.9645938
	speed: 0.0113s/iter; left time: 80.5572s
	iters: 300, epoch: 2 | loss: 0.1949263
	speed: 0.0141s/iter; left time: 99.2637s
	iters: 400, epoch: 2 | loss: 0.4680966
	speed: 0.0144s/iter; left time: 99.6105s
	iters: 500, epoch: 2 | loss: 0.6788245
	speed: 0.0148s/iter; left time: 101.0547s
	iters: 600, epoch: 2 | loss: 0.2658620
	speed: 0.0123s/iter; left time: 82.6108s
	iters: 700, epoch: 2 | loss: 1.6586372
	speed: 0.0054s/iter; left time: 35.4516s
	iters: 800, epoch: 2 | loss: 0.2275930
	speed: 0.0061s/iter; left time: 39.5417s
	iters: 900, epoch: 2 | loss: 0.6635433
	speed: 0.0110s/iter; left time: 70.6647s
	iters: 1000, epoch: 2 | loss: 0.1962224
	speed: 0.0109s/iter; left time: 69.0420s
Updating learning rate to 0.0006333048484408287
Epoch: 2 cost time: 11.266252040863037
Epoch: 2, Steps: 1045 | Train Loss: 0.6162957 Vali Loss: 0.2824153 Best vali loss: 0.2802011
	iters: 100, epoch: 3 | loss: 0.2488037
	speed: 0.0371s/iter; left time: 228.6626s
	iters: 200, epoch: 3 | loss: 0.2387154
	speed: 0.0097s/iter; left time: 58.6543s
	iters: 300, epoch: 3 | loss: 0.6076110
	speed: 0.0137s/iter; left time: 81.7646s
	iters: 400, epoch: 3 | loss: 0.2854479
	speed: 0.0136s/iter; left time: 79.6362s
	iters: 500, epoch: 3 | loss: 0.4519735
	speed: 0.0110s/iter; left time: 63.3525s
	iters: 600, epoch: 3 | loss: 0.7556679
	speed: 0.0049s/iter; left time: 27.8357s
	iters: 700, epoch: 3 | loss: 1.0310082
	speed: 0.0121s/iter; left time: 67.1334s
	iters: 800, epoch: 3 | loss: 0.1270545
	speed: 0.0151s/iter; left time: 82.4344s
	iters: 900, epoch: 3 | loss: 0.4428890
	speed: 0.0151s/iter; left time: 80.9542s
	iters: 1000, epoch: 3 | loss: 0.1792452
	speed: 0.0149s/iter; left time: 78.5486s
Updating learning rate to 0.0005129498231897238
Epoch: 3 cost time: 12.641096353530884
Epoch: 3, Steps: 1045 | Train Loss: 0.4368416 Vali Loss: 0.2987567 Best vali loss: 0.2802011

best validation loss 0.28020107231316577

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6427208
	speed: 0.0224s/iter; left time: 21.2826s
Updating learning rate to 7.21066019e-05
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 2.329453706741333
Epoch: 1, Steps: 131 | Train Loss: 0.6427208 Vali Loss: 0.2786440 Best vali loss: 0.2786440
	iters: 100, epoch: 2 | loss: 0.3989008
	speed: 0.0287s/iter; left time: 23.4786s
Updating learning rate to 3.605330095e-05
Validation loss decreased (0.2786 --> 0.2763).  Saving model state dict ...
Epoch: 2 cost time: 2.130481243133545
Epoch: 2, Steps: 131 | Train Loss: 0.3989008 Vali Loss: 0.2763457 Best vali loss: 0.2763457
	iters: 100, epoch: 3 | loss: 0.8935989
	speed: 0.0264s/iter; left time: 18.1044s
Updating learning rate to 1.8026650475e-05
Validation loss decreased (0.2763 --> 0.2748).  Saving model state dict ...
Epoch: 3 cost time: 1.8299200534820557
Epoch: 3, Steps: 131 | Train Loss: 0.8935989 Vali Loss: 0.2748160 Best vali loss: 0.2748160

best validation loss 0.27481602203806077

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019248824173, 'e_layers': 4, 'learning_rate': 0.0047849704029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004602853310905798
Validation loss decreased (inf --> 0.3251).  Saving model state dict ...
Epoch: 1 cost time: 2.6335463523864746
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3250591 Best vali loss: 0.3250591
Updating learning rate to 0.004084227711283759
Epoch: 2 cost time: 2.2265148162841797
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3484327 Best vali loss: 0.3250591
Updating learning rate to 0.0033080496502235694
Validation loss decreased (0.3251 --> 0.3211).  Saving model state dict ...
Epoch: 3 cost time: 1.7870104312896729
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3210958 Best vali loss: 0.3210958

best validation loss 0.32109578842121944

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5816060
	speed: 0.0228s/iter; left time: 12.7006s
Updating learning rate to 9.0133252375e-06
Validation loss decreased (0.2748 --> 0.2726).  Saving model state dict ...
Epoch: 4 cost time: 2.3571863174438477
Epoch: 4, Steps: 131 | Train Loss: 0.5816060 Vali Loss: 0.2726180 Best vali loss: 0.2726180
	iters: 100, epoch: 5 | loss: 0.3810364
	speed: 0.0407s/iter; left time: 17.2991s
Updating learning rate to 4.50666261875e-06
Epoch: 5 cost time: 2.6402127742767334
Epoch: 5, Steps: 131 | Train Loss: 0.3810364 Vali Loss: 0.2728840 Best vali loss: 0.2726180
	iters: 100, epoch: 6 | loss: 0.8460804
	speed: 0.0275s/iter; left time: 8.0967s
Updating learning rate to 2.253331309375e-06
Epoch: 6 cost time: 1.9885673522949219
Epoch: 6, Steps: 131 | Train Loss: 0.8460804 Vali Loss: 0.2736417 Best vali loss: 0.2726180
	iters: 100, epoch: 7 | loss: 0.5365073
	speed: 0.0267s/iter; left time: 4.3502s
Updating learning rate to 1.1266656546875e-06
Epoch: 7 cost time: 1.6783998012542725
Epoch: 7, Steps: 131 | Train Loss: 0.5365073 Vali Loss: 0.2739769 Best vali loss: 0.2726180
	iters: 100, epoch: 8 | loss: 0.4580628
	speed: 0.0184s/iter; left time: 0.5874s
Updating learning rate to 5.6333282734375e-07
Epoch: 8 cost time: 1.7392642498016357
Epoch: 8, Steps: 131 | Train Loss: 0.4580628 Vali Loss: 0.2741823 Best vali loss: 0.2726180

best validation loss 0.2726179585664323

[INFO][abstract_intensifier.py:595] Added config 639238 and rejected config bd4166 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0061705426639, 'e_layers': 4, 'learning_rate': 0.001116068428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9658590
	speed: 0.0135s/iter; left time: 55.2778s
	iters: 200, epoch: 1 | loss: 0.3254659
	speed: 0.0069s/iter; left time: 27.4942s
	iters: 300, epoch: 1 | loss: 0.2671602
	speed: 0.0104s/iter; left time: 40.5866s
	iters: 400, epoch: 1 | loss: 0.4295471
	speed: 0.0105s/iter; left time: 39.8882s
	iters: 500, epoch: 1 | loss: 0.3953224
	speed: 0.0107s/iter; left time: 39.4110s
Updating learning rate to 0.001116068428
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 5.149996757507324
Epoch: 1, Steps: 523 | Train Loss: 0.4766709 Vali Loss: 0.2883601 Best vali loss: 0.2883601
	iters: 100, epoch: 2 | loss: 0.4519618
	speed: 0.0223s/iter; left time: 79.6014s
	iters: 200, epoch: 2 | loss: 0.4054348
	speed: 0.0100s/iter; left time: 34.6711s
	iters: 300, epoch: 2 | loss: 0.2835101
	speed: 0.0088s/iter; left time: 29.6014s
	iters: 400, epoch: 2 | loss: 0.3845582
	speed: 0.0089s/iter; left time: 29.1944s
	iters: 500, epoch: 2 | loss: 0.4305468
	speed: 0.0100s/iter; left time: 31.6864s
Updating learning rate to 0.000558034214
Epoch: 2 cost time: 5.168315410614014
Epoch: 2, Steps: 523 | Train Loss: 0.3912023 Vali Loss: 0.2918057 Best vali loss: 0.2883601
	iters: 100, epoch: 3 | loss: 0.3302642
	speed: 0.0228s/iter; left time: 69.1855s
	iters: 200, epoch: 3 | loss: 0.5237817
	speed: 0.0104s/iter; left time: 30.4482s
	iters: 300, epoch: 3 | loss: 0.3220060
	speed: 0.0103s/iter; left time: 29.2377s
	iters: 400, epoch: 3 | loss: 0.3240962
	speed: 0.0096s/iter; left time: 26.2627s
	iters: 500, epoch: 3 | loss: 0.3508953
	speed: 0.0088s/iter; left time: 23.1038s
Updating learning rate to 0.000279017107
Epoch: 3 cost time: 5.27789568901062
Epoch: 3, Steps: 523 | Train Loss: 0.3702087 Vali Loss: 0.3058867 Best vali loss: 0.2883601
	iters: 100, epoch: 4 | loss: 0.7654136
	speed: 0.0190s/iter; left time: 47.9120s
	iters: 200, epoch: 4 | loss: 0.9494616
	speed: 0.0087s/iter; left time: 20.9883s
	iters: 300, epoch: 4 | loss: 0.3767277
	speed: 0.0083s/iter; left time: 19.2218s
	iters: 400, epoch: 4 | loss: 0.2840123
	speed: 0.0134s/iter; left time: 29.6972s
	iters: 500, epoch: 4 | loss: 0.6273544
	speed: 0.0126s/iter; left time: 26.7539s
Updating learning rate to 0.0001395085535
Epoch: 4 cost time: 5.695287704467773
Epoch: 4, Steps: 523 | Train Loss: 0.6005939 Vali Loss: 0.3039961 Best vali loss: 0.2883601
	iters: 100, epoch: 5 | loss: 0.1843332
	speed: 0.0250s/iter; left time: 49.7708s
	iters: 200, epoch: 5 | loss: 0.3799205
	speed: 0.0111s/iter; left time: 20.9545s
	iters: 300, epoch: 5 | loss: 0.7718568
	speed: 0.0079s/iter; left time: 14.1507s
	iters: 400, epoch: 5 | loss: 0.3852225
	speed: 0.0095s/iter; left time: 16.0803s
	iters: 500, epoch: 5 | loss: 0.1515191
	speed: 0.0107s/iter; left time: 17.0611s
Updating learning rate to 6.975427675e-05
Epoch: 5 cost time: 5.299382925033569
Epoch: 5, Steps: 523 | Train Loss: 0.3745704 Vali Loss: 0.3103689 Best vali loss: 0.2883601
	iters: 100, epoch: 6 | loss: 0.4422000
	speed: 0.0192s/iter; left time: 28.2183s
	iters: 200, epoch: 6 | loss: 0.2493413
	speed: 0.0084s/iter; left time: 11.4437s
	iters: 300, epoch: 6 | loss: 0.6903219
	speed: 0.0089s/iter; left time: 11.2575s
	iters: 400, epoch: 6 | loss: 0.8064421
	speed: 0.0088s/iter; left time: 10.3183s
	iters: 500, epoch: 6 | loss: 0.3446958
	speed: 0.0114s/iter; left time: 12.1490s
Updating learning rate to 3.4877138375e-05
Epoch: 6 cost time: 4.914479970932007
Epoch: 6, Steps: 523 | Train Loss: 0.5066002 Vali Loss: 0.3181640 Best vali loss: 0.2883601
	iters: 100, epoch: 7 | loss: 0.6100821
	speed: 0.0213s/iter; left time: 20.2086s
	iters: 200, epoch: 7 | loss: 0.3182512
	speed: 0.0087s/iter; left time: 7.3801s
	iters: 300, epoch: 7 | loss: 0.2348455
	speed: 0.0087s/iter; left time: 6.4666s
	iters: 400, epoch: 7 | loss: 0.8379197
	speed: 0.0073s/iter; left time: 4.6941s
	iters: 500, epoch: 7 | loss: 0.6748977
	speed: 0.0083s/iter; left time: 4.5246s
Updating learning rate to 1.74385691875e-05
Epoch: 7 cost time: 4.646503210067749
Epoch: 7, Steps: 523 | Train Loss: 0.5351993 Vali Loss: 0.3149376 Best vali loss: 0.2883601
	iters: 100, epoch: 8 | loss: 0.2474758
	speed: 0.0191s/iter; left time: 8.0794s
	iters: 200, epoch: 8 | loss: 0.3306624
	speed: 0.0094s/iter; left time: 3.0573s
	iters: 300, epoch: 8 | loss: 0.7267785
	speed: 0.0065s/iter; left time: 1.4658s
	iters: 400, epoch: 8 | loss: 0.6691326
	speed: 0.0051s/iter; left time: 0.6308s
	iters: 500, epoch: 8 | loss: 0.2336544
	speed: 0.0071s/iter; left time: 0.1714s
Updating learning rate to 8.71928459375e-06
Epoch: 8 cost time: 3.954209804534912
Epoch: 8, Steps: 523 | Train Loss: 0.4415408 Vali Loss: 0.3108689 Best vali loss: 0.2883601

best validation loss 0.288360090304946

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 1, 'learning_rate': 0.0009739953589, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3636533
	speed: 0.0107s/iter; left time: 43.8642s
	iters: 200, epoch: 1 | loss: 0.3578200
	speed: 0.0045s/iter; left time: 17.7352s
	iters: 300, epoch: 1 | loss: 0.2387171
	speed: 0.0044s/iter; left time: 16.9036s
	iters: 400, epoch: 1 | loss: 0.5789505
	speed: 0.0043s/iter; left time: 16.2196s
	iters: 500, epoch: 1 | loss: 0.3785156
	speed: 0.0040s/iter; left time: 14.6502s
Updating learning rate to 0.0009369248678743475
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 2.5740649700164795
Epoch: 1, Steps: 523 | Train Loss: 0.3835313 Vali Loss: 0.2848577 Best vali loss: 0.2848577
	iters: 100, epoch: 2 | loss: 0.4025113
	speed: 0.0132s/iter; left time: 47.1959s
	iters: 200, epoch: 2 | loss: 0.4644915
	speed: 0.0059s/iter; left time: 20.5349s
	iters: 300, epoch: 2 | loss: 0.6438734
	speed: 0.0043s/iter; left time: 14.3530s
	iters: 400, epoch: 2 | loss: 0.3229727
	speed: 0.0039s/iter; left time: 12.7816s
	iters: 500, epoch: 2 | loss: 1.1927822
	speed: 0.0049s/iter; left time: 15.5980s
Updating learning rate to 0.0008313570410112075
Epoch: 2 cost time: 2.5583879947662354
Epoch: 2, Steps: 523 | Train Loss: 0.6053262 Vali Loss: 0.2928340 Best vali loss: 0.2848577
	iters: 100, epoch: 3 | loss: 0.4749742
	speed: 0.0160s/iter; left time: 48.5850s
	iters: 200, epoch: 3 | loss: 0.5998265
	speed: 0.0058s/iter; left time: 16.9749s
	iters: 300, epoch: 3 | loss: 0.2502310
	speed: 0.0052s/iter; left time: 14.8880s
	iters: 400, epoch: 3 | loss: 0.5727003
	speed: 0.0063s/iter; left time: 17.3026s
	iters: 500, epoch: 3 | loss: 0.3875963
	speed: 0.0064s/iter; left time: 16.8335s
Updating learning rate to 0.0006733636229757597
Epoch: 3 cost time: 3.224546432495117
Epoch: 3, Steps: 523 | Train Loss: 0.4570656 Vali Loss: 0.2877247 Best vali loss: 0.2848577
	iters: 100, epoch: 4 | loss: 0.2248577
	speed: 0.0111s/iter; left time: 28.0434s
	iters: 200, epoch: 4 | loss: 0.3921389
	speed: 0.0062s/iter; left time: 14.9829s
	iters: 300, epoch: 4 | loss: 0.2697579
	speed: 0.0062s/iter; left time: 14.2671s
	iters: 400, epoch: 4 | loss: 0.3692919
	speed: 0.0053s/iter; left time: 11.6976s
	iters: 500, epoch: 4 | loss: 0.4640865
	speed: 0.0054s/iter; left time: 11.3382s
Updating learning rate to 0.00048699767945
Epoch: 4 cost time: 2.8718676567077637
Epoch: 4, Steps: 523 | Train Loss: 0.3440266 Vali Loss: 0.2882961 Best vali loss: 0.2848577
	iters: 100, epoch: 5 | loss: 0.3773833
	speed: 0.0125s/iter; left time: 24.8349s
	iters: 200, epoch: 5 | loss: 0.3619715
	speed: 0.0063s/iter; left time: 12.0000s
	iters: 300, epoch: 5 | loss: 0.3115727
	speed: 0.0063s/iter; left time: 11.2147s
	iters: 400, epoch: 5 | loss: 0.4663841
	speed: 0.0057s/iter; left time: 9.6627s
	iters: 500, epoch: 5 | loss: 0.1892063
	speed: 0.0057s/iter; left time: 9.0898s
Updating learning rate to 0.00030063173592424026
Epoch: 5 cost time: 3.131660223007202
Epoch: 5, Steps: 523 | Train Loss: 0.3413036 Vali Loss: 0.2932462 Best vali loss: 0.2848577
	iters: 100, epoch: 6 | loss: 0.2435016
	speed: 0.0123s/iter; left time: 18.0679s
	iters: 200, epoch: 6 | loss: 0.9678877
	speed: 0.0039s/iter; left time: 5.3902s
	iters: 300, epoch: 6 | loss: 0.3167164
	speed: 0.0042s/iter; left time: 5.3461s
	iters: 400, epoch: 6 | loss: 0.3155283
	speed: 0.0040s/iter; left time: 4.7111s
	iters: 500, epoch: 6 | loss: 0.2428034
	speed: 0.0040s/iter; left time: 4.2640s
Updating learning rate to 0.00014263831788879246
Epoch: 6 cost time: 2.1600518226623535
Epoch: 6, Steps: 523 | Train Loss: 0.4172875 Vali Loss: 0.2920068 Best vali loss: 0.2848577
	iters: 100, epoch: 7 | loss: 0.3353228
	speed: 0.0117s/iter; left time: 11.0794s
	iters: 200, epoch: 7 | loss: 0.3680242
	speed: 0.0040s/iter; left time: 3.3789s
	iters: 300, epoch: 7 | loss: 0.3625005
	speed: 0.0040s/iter; left time: 2.9526s
	iters: 400, epoch: 7 | loss: 0.3985942
	speed: 0.0036s/iter; left time: 2.3336s
	iters: 500, epoch: 7 | loss: 0.8050196
	speed: 0.0038s/iter; left time: 2.0862s
Updating learning rate to 3.707049102565253e-05
Epoch: 7 cost time: 2.112126111984253
Epoch: 7, Steps: 523 | Train Loss: 0.4538922 Vali Loss: 0.2918147 Best vali loss: 0.2848577
	iters: 100, epoch: 8 | loss: 0.3440419
	speed: 0.0217s/iter; left time: 9.2127s
	iters: 200, epoch: 8 | loss: 0.3290723
	speed: 0.0053s/iter; left time: 1.7249s
	iters: 300, epoch: 8 | loss: 0.2474859
	speed: 0.0074s/iter; left time: 1.6591s
	iters: 400, epoch: 8 | loss: 0.4449703
	speed: 0.0050s/iter; left time: 0.6245s
	iters: 500, epoch: 8 | loss: 0.6256136
	speed: 0.0031s/iter; left time: 0.0742s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.042917251586914
Epoch: 8, Steps: 523 | Train Loss: 0.3982368 Vali Loss: 0.2921740 Best vali loss: 0.2848577

best validation loss 0.28485772438145074

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 2, 'learning_rate': 0.0011324263099, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5272060
	speed: 0.0163s/iter; left time: 15.4841s
Updating learning rate to 0.0011324263099
Validation loss decreased (inf --> 0.3016).  Saving model state dict ...
Epoch: 1 cost time: 1.688981056213379
Epoch: 1, Steps: 131 | Train Loss: 0.5272060 Vali Loss: 0.3016279 Best vali loss: 0.3016279
	iters: 100, epoch: 2 | loss: 0.5263044
	speed: 0.0172s/iter; left time: 14.0778s
Updating learning rate to 0.00056621315495
Validation loss decreased (0.3016 --> 0.2900).  Saving model state dict ...
Epoch: 2 cost time: 1.359856128692627
Epoch: 2, Steps: 131 | Train Loss: 0.5263044 Vali Loss: 0.2900160 Best vali loss: 0.2900160
	iters: 100, epoch: 3 | loss: 0.5035362
	speed: 0.0174s/iter; left time: 11.9879s
Updating learning rate to 0.000283106577475
Validation loss decreased (0.2900 --> 0.2852).  Saving model state dict ...
Epoch: 3 cost time: 1.4144315719604492
Epoch: 3, Steps: 131 | Train Loss: 0.5035362 Vali Loss: 0.2852088 Best vali loss: 0.2852088

best validation loss 0.28520881998889197

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0104119650236, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3021147
	speed: 0.0146s/iter; left time: 59.8265s
	iters: 200, epoch: 1 | loss: 0.2888876
	speed: 0.0061s/iter; left time: 24.3805s
	iters: 300, epoch: 1 | loss: 1.0613573
	speed: 0.0088s/iter; left time: 34.0607s
	iters: 400, epoch: 1 | loss: 0.6340182
	speed: 0.0066s/iter; left time: 25.1103s
	iters: 500, epoch: 1 | loss: 0.6580478
	speed: 0.0093s/iter; left time: 34.1936s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 4.397765874862671
Epoch: 1, Steps: 523 | Train Loss: 0.5888851 Vali Loss: 0.2859710 Best vali loss: 0.2859710
	iters: 100, epoch: 2 | loss: 0.3304413
	speed: 0.0225s/iter; left time: 80.1904s
	iters: 200, epoch: 2 | loss: 0.2775119
	speed: 0.0069s/iter; left time: 23.8062s
	iters: 300, epoch: 2 | loss: 0.3628522
	speed: 0.0051s/iter; left time: 17.0445s
	iters: 400, epoch: 2 | loss: 1.0515497
	speed: 0.0057s/iter; left time: 18.6414s
	iters: 500, epoch: 2 | loss: 0.7029397
	speed: 0.0064s/iter; left time: 20.1580s
Updating learning rate to 0.0006629438250964442
Epoch: 2 cost time: 3.493224859237671
Epoch: 2, Steps: 523 | Train Loss: 0.5450589 Vali Loss: 0.2873625 Best vali loss: 0.2859710
	iters: 100, epoch: 3 | loss: 0.3167331
	speed: 0.0145s/iter; left time: 44.1288s
	iters: 200, epoch: 3 | loss: 0.7210053
	speed: 0.0057s/iter; left time: 16.8673s
	iters: 300, epoch: 3 | loss: 0.3378887
	speed: 0.0057s/iter; left time: 16.2767s
	iters: 400, epoch: 3 | loss: 0.3776026
	speed: 0.0051s/iter; left time: 13.8847s
	iters: 500, epoch: 3 | loss: 0.2511367
	speed: 0.0060s/iter; left time: 15.7901s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 3.0686686038970947
Epoch: 3, Steps: 523 | Train Loss: 0.4008733 Vali Loss: 0.2900688 Best vali loss: 0.2859710

best validation loss 0.285970991652621

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4490179
	speed: 0.0168s/iter; left time: 68.5962s
	iters: 200, epoch: 1 | loss: 0.2287445
	speed: 0.0122s/iter; left time: 48.5195s
	iters: 300, epoch: 1 | loss: 0.3933301
	speed: 0.0068s/iter; left time: 26.4180s
	iters: 400, epoch: 1 | loss: 0.2893254
	speed: 0.0097s/iter; left time: 36.5951s
	iters: 500, epoch: 1 | loss: 0.2972137
	speed: 0.0130s/iter; left time: 47.9550s
Updating learning rate to 0.00024547190550098694
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 5.734843492507935
Epoch: 1, Steps: 523 | Train Loss: 0.3315263 Vali Loss: 0.2815192 Best vali loss: 0.2815192
	iters: 100, epoch: 2 | loss: 0.6809198
	speed: 0.0306s/iter; left time: 108.9195s
	iters: 200, epoch: 2 | loss: 0.2630097
	speed: 0.0106s/iter; left time: 36.6154s
	iters: 300, epoch: 2 | loss: 0.3781468
	speed: 0.0058s/iter; left time: 19.3340s
	iters: 400, epoch: 2 | loss: 0.3621638
	speed: 0.0106s/iter; left time: 34.5830s
	iters: 500, epoch: 2 | loss: 0.7301048
	speed: 0.0110s/iter; left time: 34.8959s
Updating learning rate to 0.00021781340639583926
Epoch: 2 cost time: 5.424482822418213
Epoch: 2, Steps: 523 | Train Loss: 0.4828690 Vali Loss: 0.2828785 Best vali loss: 0.2815192
	iters: 100, epoch: 3 | loss: 0.2464294
	speed: 0.0229s/iter; left time: 69.7344s
	iters: 200, epoch: 3 | loss: 0.2721457
	speed: 0.0111s/iter; left time: 32.6650s
	iters: 300, epoch: 3 | loss: 0.7900245
	speed: 0.0125s/iter; left time: 35.4055s
	iters: 400, epoch: 3 | loss: 0.5177693
	speed: 0.0127s/iter; left time: 34.9004s
	iters: 500, epoch: 3 | loss: 0.3562245
	speed: 0.0079s/iter; left time: 20.7166s
Updating learning rate to 0.000176419537248397
Epoch: 3 cost time: 5.6445229053497314
Epoch: 3, Steps: 523 | Train Loss: 0.4365187 Vali Loss: 0.2879959 Best vali loss: 0.2815192

best validation loss 0.28151918808327325

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3051588
	speed: 0.0151s/iter; left time: 38.0272s
	iters: 200, epoch: 4 | loss: 0.2218831
	speed: 0.0083s/iter; left time: 20.1090s
	iters: 300, epoch: 4 | loss: 0.4016658
	speed: 0.0082s/iter; left time: 18.9950s
	iters: 400, epoch: 4 | loss: 0.2469002
	speed: 0.0074s/iter; left time: 16.3543s
	iters: 500, epoch: 4 | loss: 0.3121797
	speed: 0.0077s/iter; left time: 16.2382s
Updating learning rate to 0.0001275921394
Epoch: 4 cost time: 4.467315673828125
Epoch: 4, Steps: 523 | Train Loss: 0.2975575 Vali Loss: 0.2896613 Best vali loss: 0.2815192
	iters: 100, epoch: 5 | loss: 0.6503955
	speed: 0.0138s/iter; left time: 27.4534s
	iters: 200, epoch: 5 | loss: 0.2942227
	speed: 0.0066s/iter; left time: 12.5064s
	iters: 300, epoch: 5 | loss: 0.3704202
	speed: 0.0062s/iter; left time: 11.1356s
	iters: 400, epoch: 5 | loss: 0.3250077
	speed: 0.0065s/iter; left time: 10.9827s
	iters: 500, epoch: 5 | loss: 0.6630563
	speed: 0.0084s/iter; left time: 13.3869s
Updating learning rate to 7.8764741551603e-05
Epoch: 5 cost time: 3.581296920776367
Epoch: 5, Steps: 523 | Train Loss: 0.4606205 Vali Loss: 0.2886994 Best vali loss: 0.2815192
	iters: 100, epoch: 6 | loss: 0.2224621
	speed: 0.0168s/iter; left time: 24.7092s
	iters: 200, epoch: 6 | loss: 0.2824995
	speed: 0.0072s/iter; left time: 9.8112s
	iters: 300, epoch: 6 | loss: 0.6551967
	speed: 0.0074s/iter; left time: 9.4042s
	iters: 400, epoch: 6 | loss: 0.4587887
	speed: 0.0074s/iter; left time: 8.6574s
	iters: 500, epoch: 6 | loss: 0.3563856
	speed: 0.0073s/iter; left time: 7.8011s
Updating learning rate to 3.7370872404160736e-05
Epoch: 6 cost time: 3.8974833488464355
Epoch: 6, Steps: 523 | Train Loss: 0.3950665 Vali Loss: 0.3004967 Best vali loss: 0.2815192
	iters: 100, epoch: 7 | loss: 0.3854531
	speed: 0.0160s/iter; left time: 15.1599s
	iters: 200, epoch: 7 | loss: 0.3214618
	speed: 0.0053s/iter; left time: 4.4795s
	iters: 300, epoch: 7 | loss: 0.3702722
	speed: 0.0052s/iter; left time: 3.8653s
	iters: 400, epoch: 7 | loss: 0.5555147
	speed: 0.0053s/iter; left time: 3.4413s
	iters: 500, epoch: 7 | loss: 0.3246212
	speed: 0.0066s/iter; left time: 3.6258s
Updating learning rate to 9.71237329901307e-06
Epoch: 7 cost time: 3.2380855083465576
Epoch: 7, Steps: 523 | Train Loss: 0.3914646 Vali Loss: 0.2880514 Best vali loss: 0.2815192
	iters: 100, epoch: 8 | loss: 0.5541704
	speed: 0.0182s/iter; left time: 7.7368s
	iters: 200, epoch: 8 | loss: 0.2018998
	speed: 0.0078s/iter; left time: 2.5231s
	iters: 300, epoch: 8 | loss: 0.2975245
	speed: 0.0076s/iter; left time: 1.7117s
	iters: 400, epoch: 8 | loss: 0.6691319
	speed: 0.0072s/iter; left time: 0.8885s
	iters: 500, epoch: 8 | loss: 0.4479876
	speed: 0.0080s/iter; left time: 0.1919s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.181329965591431
Epoch: 8, Steps: 523 | Train Loss: 0.4341428 Vali Loss: 0.2930956 Best vali loss: 0.2815192

best validation loss 0.28151918808327325

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003922949282, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3854233
	speed: 0.0197s/iter; left time: 39.3152s
	iters: 200, epoch: 1 | loss: 1.0131472
	speed: 0.0126s/iter; left time: 23.9729s
Updating learning rate to 0.0003922949282
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 3.711671829223633
Epoch: 1, Steps: 262 | Train Loss: 0.6992853 Vali Loss: 0.2931876 Best vali loss: 0.2931876
	iters: 100, epoch: 2 | loss: 0.3302132
	speed: 0.0445s/iter; left time: 77.2095s
	iters: 200, epoch: 2 | loss: 0.4385679
	speed: 0.0122s/iter; left time: 19.9274s
Updating learning rate to 0.0001961474641
Validation loss decreased (0.2932 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 3.24755859375
Epoch: 2, Steps: 262 | Train Loss: 0.3843905 Vali Loss: 0.2824766 Best vali loss: 0.2824766
	iters: 100, epoch: 3 | loss: 0.4513506
	speed: 0.0266s/iter; left time: 39.1731s
	iters: 200, epoch: 3 | loss: 0.4565056
	speed: 0.0114s/iter; left time: 15.6533s
Updating learning rate to 9.807373205e-05
Epoch: 3 cost time: 3.099379301071167
Epoch: 3, Steps: 262 | Train Loss: 0.4539281 Vali Loss: 0.2836453 Best vali loss: 0.2824766
	iters: 100, epoch: 4 | loss: 0.5273002
	speed: 0.0455s/iter; left time: 55.0910s
	iters: 200, epoch: 4 | loss: 0.3134957
	speed: 0.0125s/iter; left time: 13.9188s
Updating learning rate to 4.9036866025e-05
Epoch: 4 cost time: 3.3108088970184326
Epoch: 4, Steps: 262 | Train Loss: 0.4203979 Vali Loss: 0.2868841 Best vali loss: 0.2824766
	iters: 100, epoch: 5 | loss: 0.4119805
	speed: 0.0519s/iter; left time: 49.2857s
	iters: 200, epoch: 5 | loss: 0.6100244
	speed: 0.0136s/iter; left time: 11.5753s
Updating learning rate to 2.45184330125e-05
Epoch: 5 cost time: 3.620357036590576
Epoch: 5, Steps: 262 | Train Loss: 0.5110025 Vali Loss: 0.2903312 Best vali loss: 0.2824766
	iters: 100, epoch: 6 | loss: 0.4192125
	speed: 0.0420s/iter; left time: 28.8261s
	iters: 200, epoch: 6 | loss: 0.4791647
	speed: 0.0122s/iter; left time: 7.1874s
Updating learning rate to 1.225921650625e-05
Epoch: 6 cost time: 3.3605141639709473
Epoch: 6, Steps: 262 | Train Loss: 0.4491886 Vali Loss: 0.2879720 Best vali loss: 0.2824766
	iters: 100, epoch: 7 | loss: 0.2850830
	speed: 0.0515s/iter; left time: 21.8673s
	iters: 200, epoch: 7 | loss: 0.5029287
	speed: 0.0105s/iter; left time: 3.4154s
Updating learning rate to 6.129608253125e-06
Epoch: 7 cost time: 3.49292254447937
Epoch: 7, Steps: 262 | Train Loss: 0.3940058 Vali Loss: 0.2870049 Best vali loss: 0.2824766
	iters: 100, epoch: 8 | loss: 0.3949432
	speed: 0.0510s/iter; left time: 8.3070s
	iters: 200, epoch: 8 | loss: 0.3245258
	speed: 0.0124s/iter; left time: 0.7816s
Updating learning rate to 3.0648041265625e-06
Epoch: 8 cost time: 3.482339382171631
Epoch: 8, Steps: 262 | Train Loss: 0.3597345 Vali Loss: 0.2879853 Best vali loss: 0.2824766

best validation loss 0.2824766136326281

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024943532487, 'e_layers': 3, 'learning_rate': 0.0040105616226, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040105616226
Validation loss decreased (inf --> 0.3124).  Saving model state dict ...
Epoch: 1 cost time: 3.010374069213867
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3124450 Best vali loss: 0.3124450
Updating learning rate to 0.0020052808113
Epoch: 2 cost time: 2.6638779640197754
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3162660 Best vali loss: 0.3124450
Updating learning rate to 0.00100264040565
Epoch: 3 cost time: 2.7853167057037354
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3283541 Best vali loss: 0.3124450
Updating learning rate to 0.000501320202825
Epoch: 4 cost time: 1.4841687679290771
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3227541 Best vali loss: 0.3124450
Updating learning rate to 0.0002506601014125
Epoch: 5 cost time: 1.3706028461456299
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3223104 Best vali loss: 0.3124450
Updating learning rate to 0.00012533005070625
Epoch: 6 cost time: 1.8780717849731445
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3201636 Best vali loss: 0.3124450
Updating learning rate to 6.2665025353125e-05
Epoch: 7 cost time: 1.3263700008392334
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3191121 Best vali loss: 0.3124450
Updating learning rate to 3.13325126765625e-05
Epoch: 8 cost time: 1.6162362098693848
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3186393 Best vali loss: 0.3124450

best validation loss 0.312445009495078

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025792385667, 'e_layers': 3, 'learning_rate': 0.0026285535245, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3373491
	speed: 0.0170s/iter; left time: 34.0111s
	iters: 200, epoch: 1 | loss: 0.4412858
	speed: 0.0105s/iter; left time: 19.9411s
Updating learning rate to 0.0026285535245
Validation loss decreased (inf --> 0.2888).  Saving model state dict ...
Epoch: 1 cost time: 3.19543719291687
Epoch: 1, Steps: 262 | Train Loss: 0.3893175 Vali Loss: 0.2888423 Best vali loss: 0.2888423
	iters: 100, epoch: 2 | loss: 0.2823509
	speed: 0.0334s/iter; left time: 57.9834s
	iters: 200, epoch: 2 | loss: 0.3011267
	speed: 0.0106s/iter; left time: 17.3706s
Updating learning rate to 0.00131427676225
Validation loss decreased (0.2888 --> 0.2845).  Saving model state dict ...
Epoch: 2 cost time: 3.0360207557678223
Epoch: 2, Steps: 262 | Train Loss: 0.2917388 Vali Loss: 0.2844888 Best vali loss: 0.2844888
	iters: 100, epoch: 3 | loss: 0.6985266
	speed: 0.0308s/iter; left time: 45.4292s
	iters: 200, epoch: 3 | loss: 0.2732630
	speed: 0.0089s/iter; left time: 12.2335s
Updating learning rate to 0.000657138381125
Epoch: 3 cost time: 2.605811595916748
Epoch: 3, Steps: 262 | Train Loss: 0.4858948 Vali Loss: 0.2987618 Best vali loss: 0.2844888

best validation loss 0.28448883071403247

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037879290128, 'e_layers': 3, 'learning_rate': 0.0044980854811, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3789203
	speed: 0.0144s/iter; left time: 58.9490s
	iters: 200, epoch: 1 | loss: 0.3634589
	speed: 0.0075s/iter; left time: 30.0547s
	iters: 300, epoch: 1 | loss: 0.2934112
	speed: 0.0075s/iter; left time: 28.9439s
	iters: 400, epoch: 1 | loss: 0.9464574
	speed: 0.0075s/iter; left time: 28.5745s
	iters: 500, epoch: 1 | loss: 1.1356184
	speed: 0.0073s/iter; left time: 27.0051s
Updating learning rate to 0.0044980854811
Validation loss decreased (inf --> 0.3216).  Saving model state dict ...
Epoch: 1 cost time: 4.3115763664245605
Epoch: 1, Steps: 523 | Train Loss: 0.6235733 Vali Loss: 0.3216251 Best vali loss: 0.3216251
	iters: 100, epoch: 2 | loss: 0.3725041
	speed: 0.0169s/iter; left time: 60.0538s
	iters: 200, epoch: 2 | loss: 0.4954911
	speed: 0.0068s/iter; left time: 23.5474s
	iters: 300, epoch: 2 | loss: 0.3454778
	speed: 0.0086s/iter; left time: 29.0216s
	iters: 400, epoch: 2 | loss: 0.5830785
	speed: 0.0076s/iter; left time: 24.9494s
	iters: 500, epoch: 2 | loss: 0.7824008
	speed: 0.0079s/iter; left time: 24.8852s
Updating learning rate to 0.00224904274055
Epoch: 2 cost time: 4.09953236579895
Epoch: 2, Steps: 523 | Train Loss: 0.5157905 Vali Loss: 0.3218797 Best vali loss: 0.3216251
	iters: 100, epoch: 3 | loss: 0.4131723
	speed: 0.0185s/iter; left time: 56.3461s
	iters: 200, epoch: 3 | loss: 0.4990520
	speed: 0.0073s/iter; left time: 21.4592s
	iters: 300, epoch: 3 | loss: 0.4702969
	speed: 0.0065s/iter; left time: 18.5659s
	iters: 400, epoch: 3 | loss: 0.2736774
	speed: 0.0078s/iter; left time: 21.2683s
	iters: 500, epoch: 3 | loss: 0.8353714
	speed: 0.0072s/iter; left time: 19.0261s
Updating learning rate to 0.001124521370275
Epoch: 3 cost time: 4.0614378452301025
Epoch: 3, Steps: 523 | Train Loss: 0.4983140 Vali Loss: 0.3241115 Best vali loss: 0.3216251

best validation loss 0.3216250584543571

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3635587
	speed: 0.0127s/iter; left time: 52.0093s
	iters: 200, epoch: 1 | loss: 0.3306994
	speed: 0.0072s/iter; left time: 28.5077s
	iters: 300, epoch: 1 | loss: 0.2190373
	speed: 0.0073s/iter; left time: 28.3075s
	iters: 400, epoch: 1 | loss: 0.6177989
	speed: 0.0062s/iter; left time: 23.6394s
	iters: 500, epoch: 1 | loss: 0.2510086
	speed: 0.0072s/iter; left time: 26.4937s
Updating learning rate to 0.00016522745149179477
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 3.9013795852661133
Epoch: 1, Steps: 523 | Train Loss: 0.3564206 Vali Loss: 0.2799282 Best vali loss: 0.2799282
	iters: 100, epoch: 2 | loss: 0.3994833
	speed: 0.0152s/iter; left time: 54.1815s
	iters: 200, epoch: 2 | loss: 0.3972281
	speed: 0.0060s/iter; left time: 20.7511s
	iters: 300, epoch: 2 | loss: 0.6166841
	speed: 0.0061s/iter; left time: 20.5735s
	iters: 400, epoch: 2 | loss: 0.6795893
	speed: 0.0063s/iter; left time: 20.5617s
	iters: 500, epoch: 2 | loss: 0.3271731
	speed: 0.0064s/iter; left time: 20.2500s
Updating learning rate to 0.00014661048060095176
Validation loss decreased (0.2799 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 3.3565585613250732
Epoch: 2, Steps: 523 | Train Loss: 0.4840316 Vali Loss: 0.2765559 Best vali loss: 0.2765559
	iters: 100, epoch: 3 | loss: 0.4605504
	speed: 0.0159s/iter; left time: 48.3389s
	iters: 200, epoch: 3 | loss: 0.2784579
	speed: 0.0064s/iter; left time: 18.9205s
	iters: 300, epoch: 3 | loss: 0.5593733
	speed: 0.0061s/iter; left time: 17.4544s
	iters: 400, epoch: 3 | loss: 0.3985837
	speed: 0.0059s/iter; left time: 16.1571s
	iters: 500, epoch: 3 | loss: 0.4667594
	speed: 0.0054s/iter; left time: 14.2802s
Updating learning rate to 0.0001187482146823405
Epoch: 3 cost time: 3.2409651279449463
Epoch: 3, Steps: 523 | Train Loss: 0.4327449 Vali Loss: 0.2839651 Best vali loss: 0.2765559

best validation loss 0.2765558929071412

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3260203
	speed: 0.0127s/iter; left time: 31.8642s
	iters: 200, epoch: 4 | loss: 0.3097528
	speed: 0.0065s/iter; left time: 15.7709s
	iters: 300, epoch: 4 | loss: 0.2101338
	speed: 0.0068s/iter; left time: 15.7379s
	iters: 400, epoch: 4 | loss: 0.5125546
	speed: 0.0067s/iter; left time: 14.9236s
	iters: 500, epoch: 4 | loss: 0.2499328
	speed: 0.0059s/iter; left time: 12.5671s
Updating learning rate to 8.588243115e-05
Epoch: 4 cost time: 3.6729557514190674
Epoch: 4, Steps: 523 | Train Loss: 0.3216789 Vali Loss: 0.2781674 Best vali loss: 0.2765559
	iters: 100, epoch: 5 | loss: 0.3636679
	speed: 0.0154s/iter; left time: 30.7111s
	iters: 200, epoch: 5 | loss: 0.3883089
	speed: 0.0064s/iter; left time: 12.0221s
	iters: 300, epoch: 5 | loss: 0.5309802
	speed: 0.0066s/iter; left time: 11.8412s
	iters: 400, epoch: 5 | loss: 0.6002225
	speed: 0.0064s/iter; left time: 10.8619s
	iters: 500, epoch: 5 | loss: 0.3114960
	speed: 0.0066s/iter; left time: 10.5506s
Updating learning rate to 5.30166476176595e-05
Epoch: 5 cost time: 3.42132830619812
Epoch: 5, Steps: 523 | Train Loss: 0.4389351 Vali Loss: 0.2827198 Best vali loss: 0.2765559
	iters: 100, epoch: 6 | loss: 0.4517758
	speed: 0.0139s/iter; left time: 20.4717s
	iters: 200, epoch: 6 | loss: 0.2576323
	speed: 0.0049s/iter; left time: 6.6876s
	iters: 300, epoch: 6 | loss: 0.5037534
	speed: 0.0063s/iter; left time: 7.9625s
	iters: 400, epoch: 6 | loss: 0.3819954
	speed: 0.0068s/iter; left time: 7.9188s
	iters: 500, epoch: 6 | loss: 0.4224348
	speed: 0.0065s/iter; left time: 6.9158s
Updating learning rate to 2.515438169904822e-05
Epoch: 6 cost time: 3.2703285217285156
Epoch: 6, Steps: 523 | Train Loss: 0.4035183 Vali Loss: 0.2874173 Best vali loss: 0.2765559
	iters: 100, epoch: 7 | loss: 0.4514321
	speed: 0.0144s/iter; left time: 13.6290s
	iters: 200, epoch: 7 | loss: 0.7271316
	speed: 0.0064s/iter; left time: 5.3913s
	iters: 300, epoch: 7 | loss: 0.6489282
	speed: 0.0061s/iter; left time: 4.5693s
	iters: 400, epoch: 7 | loss: 0.6788515
	speed: 0.0058s/iter; left time: 3.7622s
	iters: 500, epoch: 7 | loss: 0.3529397
	speed: 0.0077s/iter; left time: 4.2233s
Updating learning rate to 6.53741080820523e-06
Epoch: 7 cost time: 3.5075526237487793
Epoch: 7, Steps: 523 | Train Loss: 0.5718566 Vali Loss: 0.2869789 Best vali loss: 0.2765559
	iters: 100, epoch: 8 | loss: 0.3941749
	speed: 0.0192s/iter; left time: 8.1448s
	iters: 200, epoch: 8 | loss: 0.2665392
	speed: 0.0071s/iter; left time: 2.3029s
	iters: 300, epoch: 8 | loss: 0.1676047
	speed: 0.0110s/iter; left time: 2.4568s
	iters: 400, epoch: 8 | loss: 0.5785202
	speed: 0.0080s/iter; left time: 0.9952s
	iters: 500, epoch: 8 | loss: 0.3803796
	speed: 0.0060s/iter; left time: 0.1429s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.381364107131958
Epoch: 8, Steps: 523 | Train Loss: 0.3574437 Vali Loss: 0.2851662 Best vali loss: 0.2765559

best validation loss 0.2765558929071412

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011023654446, 'e_layers': 1, 'learning_rate': 0.0011214708245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5026022
	speed: 0.0290s/iter; left time: 27.5117s
Updating learning rate to 0.0010787873827820538
Validation loss decreased (inf --> 0.2866).  Saving model state dict ...
Epoch: 1 cost time: 2.912827730178833
Epoch: 1, Steps: 131 | Train Loss: 0.5026022 Vali Loss: 0.2865963 Best vali loss: 0.2865963
	iters: 100, epoch: 2 | loss: 0.6650184
	speed: 0.0273s/iter; left time: 22.3070s
Updating learning rate to 0.0009572352247034093
Epoch: 2 cost time: 1.8225109577178955
Epoch: 2, Steps: 131 | Train Loss: 0.6650184 Vali Loss: 0.2878625 Best vali loss: 0.2865963
	iters: 100, epoch: 3 | loss: 0.5450752
	speed: 0.0215s/iter; left time: 14.7928s
Updating learning rate to 0.0007753195644584837
Epoch: 3 cost time: 1.563713550567627
Epoch: 3, Steps: 131 | Train Loss: 0.5450752 Vali Loss: 0.2916703 Best vali loss: 0.2865963
	iters: 100, epoch: 4 | loss: 0.4715605
	speed: 0.0243s/iter; left time: 13.5080s
Updating learning rate to 0.00056073541225
Epoch: 4 cost time: 1.963172197341919
Epoch: 4, Steps: 131 | Train Loss: 0.4715605 Vali Loss: 0.2983496 Best vali loss: 0.2865963
	iters: 100, epoch: 5 | loss: 0.3371381
	speed: 0.0230s/iter; left time: 9.7873s
Updating learning rate to 0.0003461512600415164
Epoch: 5 cost time: 1.9781434535980225
Epoch: 5, Steps: 131 | Train Loss: 0.3371381 Vali Loss: 0.3001704 Best vali loss: 0.2865963
	iters: 100, epoch: 6 | loss: 0.2788594
	speed: 0.0279s/iter; left time: 8.2093s
Updating learning rate to 0.00016423559979659077
Epoch: 6 cost time: 1.6093018054962158
Epoch: 6, Steps: 131 | Train Loss: 0.2788594 Vali Loss: 0.3138288 Best vali loss: 0.2865963
	iters: 100, epoch: 7 | loss: 0.3406380
	speed: 0.0203s/iter; left time: 3.3025s
Updating learning rate to 4.268344171794636e-05
Epoch: 7 cost time: 1.4973649978637695
Epoch: 7, Steps: 131 | Train Loss: 0.3406380 Vali Loss: 0.3132280 Best vali loss: 0.2865963
	iters: 100, epoch: 8 | loss: 0.2635237
	speed: 0.0244s/iter; left time: 0.7816s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.078826904296875
Epoch: 8, Steps: 131 | Train Loss: 0.2635237 Vali Loss: 0.3183649 Best vali loss: 0.2865963

best validation loss 0.28659631184438383

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0064522030262, 'e_layers': 1, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2574273
	speed: 0.0121s/iter; left time: 100.3309s
	iters: 200, epoch: 1 | loss: 1.2072203
	speed: 0.0056s/iter; left time: 45.4814s
	iters: 300, epoch: 1 | loss: 0.4369274
	speed: 0.0058s/iter; left time: 46.4731s
	iters: 400, epoch: 1 | loss: 0.5986564
	speed: 0.0063s/iter; left time: 50.3534s
	iters: 500, epoch: 1 | loss: 0.2895896
	speed: 0.0061s/iter; left time: 47.7030s
	iters: 600, epoch: 1 | loss: 1.2747291
	speed: 0.0059s/iter; left time: 45.5196s
	iters: 700, epoch: 1 | loss: 0.5266356
	speed: 0.0052s/iter; left time: 40.1325s
	iters: 800, epoch: 1 | loss: 0.2018517
	speed: 0.0041s/iter; left time: 30.7817s
	iters: 900, epoch: 1 | loss: 0.4118254
	speed: 0.0056s/iter; left time: 41.8300s
	iters: 1000, epoch: 1 | loss: 1.7113016
	speed: 0.0069s/iter; left time: 50.7185s
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.3108).  Saving model state dict ...
Epoch: 1 cost time: 6.392738580703735
Epoch: 1, Steps: 1045 | Train Loss: 0.6916164 Vali Loss: 0.3108082 Best vali loss: 0.3108082
	iters: 100, epoch: 2 | loss: 0.6154149
	speed: 0.0234s/iter; left time: 169.0709s
	iters: 200, epoch: 2 | loss: 0.4790758
	speed: 0.0055s/iter; left time: 39.3201s
	iters: 300, epoch: 2 | loss: 0.2779253
	speed: 0.0041s/iter; left time: 28.8794s
	iters: 400, epoch: 2 | loss: 0.3463203
	speed: 0.0033s/iter; left time: 23.0518s
	iters: 500, epoch: 2 | loss: 1.5517259
	speed: 0.0042s/iter; left time: 28.9517s
	iters: 600, epoch: 2 | loss: 1.2405906
	speed: 0.0052s/iter; left time: 34.5928s
	iters: 700, epoch: 2 | loss: 0.3931968
	speed: 0.0048s/iter; left time: 31.9974s
	iters: 800, epoch: 2 | loss: 0.3136251
	speed: 0.0050s/iter; left time: 32.8837s
	iters: 900, epoch: 2 | loss: 0.3939937
	speed: 0.0055s/iter; left time: 35.5578s
	iters: 1000, epoch: 2 | loss: 0.5110040
	speed: 0.0063s/iter; left time: 40.0278s
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.3108 --> 0.2950).  Saving model state dict ...
Epoch: 2 cost time: 5.359472751617432
Epoch: 2, Steps: 1045 | Train Loss: 0.6122872 Vali Loss: 0.2949849 Best vali loss: 0.2949849
	iters: 100, epoch: 3 | loss: 1.2968434
	speed: 0.0221s/iter; left time: 136.1037s
	iters: 200, epoch: 3 | loss: 0.3839830
	speed: 0.0052s/iter; left time: 31.5218s
	iters: 300, epoch: 3 | loss: 0.2310542
	speed: 0.0055s/iter; left time: 32.7994s
	iters: 400, epoch: 3 | loss: 0.4594544
	speed: 0.0057s/iter; left time: 33.6400s
	iters: 500, epoch: 3 | loss: 0.3254491
	speed: 0.0048s/iter; left time: 27.8497s
	iters: 600, epoch: 3 | loss: 0.6181324
	speed: 0.0049s/iter; left time: 28.0181s
	iters: 700, epoch: 3 | loss: 0.2076610
	speed: 0.0055s/iter; left time: 30.4068s
	iters: 800, epoch: 3 | loss: 1.4056751
	speed: 0.0053s/iter; left time: 29.0408s
	iters: 900, epoch: 3 | loss: 0.4353624
	speed: 0.0050s/iter; left time: 26.6503s
	iters: 1000, epoch: 3 | loss: 1.4921107
	speed: 0.0063s/iter; left time: 33.4434s
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.2950 --> 0.2880).  Saving model state dict ...
Epoch: 3 cost time: 5.585393905639648
Epoch: 3, Steps: 1045 | Train Loss: 0.6855726 Vali Loss: 0.2880293 Best vali loss: 0.2880293
	iters: 100, epoch: 4 | loss: 1.3002410
	speed: 0.0199s/iter; left time: 102.0087s
	iters: 200, epoch: 4 | loss: 0.7825229
	speed: 0.0084s/iter; left time: 42.1200s
	iters: 300, epoch: 4 | loss: 0.2390456
	speed: 0.0058s/iter; left time: 28.4895s
	iters: 400, epoch: 4 | loss: 0.4235728
	speed: 0.0071s/iter; left time: 34.1817s
	iters: 500, epoch: 4 | loss: 0.2835509
	speed: 0.0075s/iter; left time: 35.4737s
	iters: 600, epoch: 4 | loss: 0.2359954
	speed: 0.0071s/iter; left time: 32.7271s
	iters: 700, epoch: 4 | loss: 0.5531091
	speed: 0.0072s/iter; left time: 32.7788s
	iters: 800, epoch: 4 | loss: 0.7719905
	speed: 0.0086s/iter; left time: 37.9506s
	iters: 900, epoch: 4 | loss: 0.6498601
	speed: 0.0091s/iter; left time: 39.3871s
	iters: 1000, epoch: 4 | loss: 0.4184025
	speed: 0.0084s/iter; left time: 35.6802s
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.2880 --> 0.2846).  Saving model state dict ...
Epoch: 4 cost time: 7.9761176109313965
Epoch: 4, Steps: 1045 | Train Loss: 0.5658291 Vali Loss: 0.2846455 Best vali loss: 0.2846455
	iters: 100, epoch: 5 | loss: 0.2891217
	speed: 0.0198s/iter; left time: 80.6669s
	iters: 200, epoch: 5 | loss: 0.6555381
	speed: 0.0050s/iter; left time: 19.9889s
	iters: 300, epoch: 5 | loss: 0.2683520
	speed: 0.0040s/iter; left time: 15.5600s
	iters: 400, epoch: 5 | loss: 0.4532433
	speed: 0.0043s/iter; left time: 16.2890s
	iters: 500, epoch: 5 | loss: 0.9222870
	speed: 0.0038s/iter; left time: 13.8533s
	iters: 600, epoch: 5 | loss: 0.2940259
	speed: 0.0059s/iter; left time: 21.0325s
	iters: 700, epoch: 5 | loss: 0.3028597
	speed: 0.0066s/iter; left time: 23.1456s
	iters: 800, epoch: 5 | loss: 0.7738351
	speed: 0.0084s/iter; left time: 28.5089s
	iters: 900, epoch: 5 | loss: 0.2294365
	speed: 0.0080s/iter; left time: 26.0962s
	iters: 1000, epoch: 5 | loss: 1.5773780
	speed: 0.0070s/iter; left time: 22.3674s
Updating learning rate to 2.2430860606471416e-05
Validation loss decreased (0.2846 --> 0.2829).  Saving model state dict ...
Epoch: 5 cost time: 6.301251411437988
Epoch: 5, Steps: 1045 | Train Loss: 0.5766077 Vali Loss: 0.2829109 Best vali loss: 0.2829109
	iters: 100, epoch: 6 | loss: 0.3698475
	speed: 0.0301s/iter; left time: 91.4761s
	iters: 200, epoch: 6 | loss: 0.2384103
	speed: 0.0072s/iter; left time: 21.0325s
	iters: 300, epoch: 6 | loss: 0.2937337
	speed: 0.0065s/iter; left time: 18.5033s
	iters: 400, epoch: 6 | loss: 0.2269532
	speed: 0.0061s/iter; left time: 16.7206s
	iters: 500, epoch: 6 | loss: 0.7061832
	speed: 0.0036s/iter; left time: 9.4106s
	iters: 600, epoch: 6 | loss: 0.5898536
	speed: 0.0038s/iter; left time: 9.6525s
	iters: 700, epoch: 6 | loss: 0.3456791
	speed: 0.0043s/iter; left time: 10.3653s
	iters: 800, epoch: 6 | loss: 0.2860546
	speed: 0.0048s/iter; left time: 11.1535s
	iters: 900, epoch: 6 | loss: 0.3916343
	speed: 0.0058s/iter; left time: 12.9471s
	iters: 1000, epoch: 6 | loss: 0.4156617
	speed: 0.0056s/iter; left time: 11.9447s
Updating learning rate to 1.0642589731482448e-05
Validation loss decreased (0.2829 --> 0.2822).  Saving model state dict ...
Epoch: 6 cost time: 5.735550880432129
Epoch: 6, Steps: 1045 | Train Loss: 0.3864011 Vali Loss: 0.2821992 Best vali loss: 0.2821992
	iters: 100, epoch: 7 | loss: 0.4439602
	speed: 0.0204s/iter; left time: 40.7024s
	iters: 200, epoch: 7 | loss: 0.3912283
	speed: 0.0051s/iter; left time: 9.6082s
	iters: 300, epoch: 7 | loss: 0.1396813
	speed: 0.0056s/iter; left time: 9.9935s
	iters: 400, epoch: 7 | loss: 0.1750623
	speed: 0.0051s/iter; left time: 8.6914s
	iters: 500, epoch: 7 | loss: 0.3531923
	speed: 0.0046s/iter; left time: 7.3599s
	iters: 600, epoch: 7 | loss: 0.2624975
	speed: 0.0041s/iter; left time: 6.1753s
	iters: 700, epoch: 7 | loss: 0.3029902
	speed: 0.0042s/iter; left time: 5.8101s
	iters: 800, epoch: 7 | loss: 0.2271350
	speed: 0.0047s/iter; left time: 6.0718s
	iters: 900, epoch: 7 | loss: 0.2348271
	speed: 0.0049s/iter; left time: 5.8503s
	iters: 1000, epoch: 7 | loss: 1.2479016
	speed: 0.0054s/iter; left time: 5.8596s
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.2822 --> 0.2820).  Saving model state dict ...
Epoch: 7 cost time: 5.190171241760254
Epoch: 7, Steps: 1045 | Train Loss: 0.3778476 Vali Loss: 0.2819669 Best vali loss: 0.2819669
	iters: 100, epoch: 8 | loss: 0.4628459
	speed: 0.0219s/iter; left time: 20.7050s
	iters: 200, epoch: 8 | loss: 0.6237691
	speed: 0.0058s/iter; left time: 4.8739s
	iters: 300, epoch: 8 | loss: 0.2911073
	speed: 0.0046s/iter; left time: 3.4361s
	iters: 400, epoch: 8 | loss: 1.1472392
	speed: 0.0045s/iter; left time: 2.8811s
	iters: 500, epoch: 8 | loss: 0.6674773
	speed: 0.0045s/iter; left time: 2.4641s
	iters: 600, epoch: 8 | loss: 1.0323073
	speed: 0.0044s/iter; left time: 1.9629s
	iters: 700, epoch: 8 | loss: 0.2907352
	speed: 0.0044s/iter; left time: 1.5247s
	iters: 800, epoch: 8 | loss: 0.9756833
	speed: 0.0046s/iter; left time: 1.1400s
	iters: 900, epoch: 8 | loss: 0.8002651
	speed: 0.0051s/iter; left time: 0.7374s
	iters: 1000, epoch: 8 | loss: 0.3139566
	speed: 0.0063s/iter; left time: 0.2897s
Updating learning rate to 0.0
Validation loss decreased (0.2820 --> 0.2819).  Saving model state dict ...
Epoch: 8 cost time: 5.367387533187866
Epoch: 8, Steps: 1045 | Train Loss: 0.6605386 Vali Loss: 0.2819133 Best vali loss: 0.2819133

best validation loss 0.28191330676497295

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3637387
	speed: 0.0114s/iter; left time: 46.3868s
	iters: 200, epoch: 1 | loss: 0.3047040
	speed: 0.0053s/iter; left time: 21.0840s
	iters: 300, epoch: 1 | loss: 0.2813015
	speed: 0.0045s/iter; left time: 17.4711s
	iters: 400, epoch: 1 | loss: 0.2805361
	speed: 0.0050s/iter; left time: 18.8538s
	iters: 500, epoch: 1 | loss: 0.7385253
	speed: 0.0054s/iter; left time: 20.0131s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 3.0112051963806152
Epoch: 1, Steps: 523 | Train Loss: 0.3937611 Vali Loss: 0.2812858 Best vali loss: 0.2812858
	iters: 100, epoch: 2 | loss: 0.8946462
	speed: 0.0142s/iter; left time: 50.4177s
	iters: 200, epoch: 2 | loss: 0.3266925
	speed: 0.0047s/iter; left time: 16.1793s
	iters: 300, epoch: 2 | loss: 0.5716949
	speed: 0.0048s/iter; left time: 16.0540s
	iters: 400, epoch: 2 | loss: 0.3605430
	speed: 0.0048s/iter; left time: 15.6880s
	iters: 500, epoch: 2 | loss: 0.5682382
	speed: 0.0049s/iter; left time: 15.5542s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 2.6265945434570312
Epoch: 2, Steps: 523 | Train Loss: 0.5443630 Vali Loss: 0.2869025 Best vali loss: 0.2812858
	iters: 100, epoch: 3 | loss: 0.3765881
	speed: 0.0122s/iter; left time: 37.1017s
	iters: 200, epoch: 3 | loss: 0.3137808
	speed: 0.0036s/iter; left time: 10.4828s
	iters: 300, epoch: 3 | loss: 0.7778519
	speed: 0.0033s/iter; left time: 9.4633s
	iters: 400, epoch: 3 | loss: 0.7370906
	speed: 0.0037s/iter; left time: 10.0552s
	iters: 500, epoch: 3 | loss: 0.4019978
	speed: 0.0039s/iter; left time: 10.3397s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 2.059785842895508
Epoch: 3, Steps: 523 | Train Loss: 0.5214619 Vali Loss: 0.2867880 Best vali loss: 0.2812858

best validation loss 0.28128575477381984

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002026610841687957
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 3.0224127769470215
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2847874 Best vali loss: 0.2847874
Updating learning rate to 0.001798262860126036
Epoch: 2 cost time: 1.8935964107513428
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2895194 Best vali loss: 0.2847874
Updating learning rate to 0.0014565159550274328
Epoch: 3 cost time: 2.5384387969970703
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2984394 Best vali loss: 0.2847874

best validation loss 0.2847874210132636

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0103950152165, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5113344
	speed: 0.0338s/iter; left time: 32.1046s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.3003).  Saving model state dict ...
Epoch: 1 cost time: 3.974947929382324
Epoch: 1, Steps: 131 | Train Loss: 0.5113344 Vali Loss: 0.3003059 Best vali loss: 0.3003059
	iters: 100, epoch: 2 | loss: 0.5838083
	speed: 0.0617s/iter; left time: 50.4673s
Updating learning rate to 0.00093122262415
Validation loss decreased (0.3003 --> 0.2857).  Saving model state dict ...
Epoch: 2 cost time: 4.056370735168457
Epoch: 2, Steps: 131 | Train Loss: 0.5838083 Vali Loss: 0.2857102 Best vali loss: 0.2857102
	iters: 100, epoch: 3 | loss: 0.4315803
	speed: 0.0537s/iter; left time: 36.8782s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 3.3910140991210938
Epoch: 3, Steps: 131 | Train Loss: 0.4315803 Vali Loss: 0.2925256 Best vali loss: 0.2857102

best validation loss 0.28571022971882704

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3405491
	speed: 0.0112s/iter; left time: 28.2017s
	iters: 200, epoch: 4 | loss: 0.3099043
	speed: 0.0046s/iter; left time: 11.2203s
	iters: 300, epoch: 4 | loss: 0.2600530
	speed: 0.0045s/iter; left time: 10.4121s
	iters: 400, epoch: 4 | loss: 0.2870862
	speed: 0.0043s/iter; left time: 9.4529s
	iters: 500, epoch: 4 | loss: 0.5369928
	speed: 0.0048s/iter; left time: 10.1506s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 2.7613556385040283
Epoch: 4, Steps: 523 | Train Loss: 0.3469171 Vali Loss: 0.2928921 Best vali loss: 0.2812858
	iters: 100, epoch: 5 | loss: 0.7446558
	speed: 0.0119s/iter; left time: 23.7046s
	iters: 200, epoch: 5 | loss: 0.2837905
	speed: 0.0052s/iter; left time: 9.8676s
	iters: 300, epoch: 5 | loss: 0.5681225
	speed: 0.0048s/iter; left time: 8.5263s
	iters: 400, epoch: 5 | loss: 0.2722171
	speed: 0.0047s/iter; left time: 8.0106s
	iters: 500, epoch: 5 | loss: 0.5356306
	speed: 0.0052s/iter; left time: 8.2281s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 2.587651252746582
Epoch: 5, Steps: 523 | Train Loss: 0.4808833 Vali Loss: 0.2949884 Best vali loss: 0.2812858
	iters: 100, epoch: 6 | loss: 0.3044533
	speed: 0.0124s/iter; left time: 18.1873s
	iters: 200, epoch: 6 | loss: 0.3120987
	speed: 0.0033s/iter; left time: 4.5668s
	iters: 300, epoch: 6 | loss: 0.6896074
	speed: 0.0038s/iter; left time: 4.7801s
	iters: 400, epoch: 6 | loss: 0.4861675
	speed: 0.0046s/iter; left time: 5.4014s
	iters: 500, epoch: 6 | loss: 0.4130967
	speed: 0.0048s/iter; left time: 5.1016s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 2.2344934940338135
Epoch: 6, Steps: 523 | Train Loss: 0.4410847 Vali Loss: 0.3022104 Best vali loss: 0.2812858
	iters: 100, epoch: 7 | loss: 0.4941285
	speed: 0.0133s/iter; left time: 12.6145s
	iters: 200, epoch: 7 | loss: 0.2033375
	speed: 0.0048s/iter; left time: 4.0629s
	iters: 300, epoch: 7 | loss: 0.3542907
	speed: 0.0049s/iter; left time: 3.6690s
	iters: 400, epoch: 7 | loss: 0.5396631
	speed: 0.0047s/iter; left time: 3.0692s
	iters: 500, epoch: 7 | loss: 0.4423845
	speed: 0.0042s/iter; left time: 2.3027s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 2.4893431663513184
Epoch: 7, Steps: 523 | Train Loss: 0.4067609 Vali Loss: 0.2976917 Best vali loss: 0.2812858
	iters: 100, epoch: 8 | loss: 0.4104262
	speed: 0.0121s/iter; left time: 5.1313s
	iters: 200, epoch: 8 | loss: 0.4847514
	speed: 0.0048s/iter; left time: 1.5584s
	iters: 300, epoch: 8 | loss: 0.3759456
	speed: 0.0047s/iter; left time: 1.0525s
	iters: 400, epoch: 8 | loss: 0.2711494
	speed: 0.0048s/iter; left time: 0.6011s
	iters: 500, epoch: 8 | loss: 0.3175542
	speed: 0.0046s/iter; left time: 0.1094s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5385804176330566
Epoch: 8, Steps: 523 | Train Loss: 0.3719654 Vali Loss: 0.2988157 Best vali loss: 0.2812858

best validation loss 0.28128575477381984

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015627682118, 'e_layers': 4, 'learning_rate': 7.53636528e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6969698
	speed: 0.0260s/iter; left time: 24.6604s
Updating learning rate to 7.53636528e-05
Validation loss decreased (inf --> 0.3354).  Saving model state dict ...
Epoch: 1 cost time: 2.5576844215393066
Epoch: 1, Steps: 131 | Train Loss: 0.6969698 Vali Loss: 0.3354007 Best vali loss: 0.3354007
	iters: 100, epoch: 2 | loss: 0.6950095
	speed: 0.0238s/iter; left time: 19.4806s
Updating learning rate to 3.76818264e-05
Validation loss decreased (0.3354 --> 0.3193).  Saving model state dict ...
Epoch: 2 cost time: 2.4179141521453857
Epoch: 2, Steps: 131 | Train Loss: 0.6950095 Vali Loss: 0.3193046 Best vali loss: 0.3193046
	iters: 100, epoch: 3 | loss: 0.4995722
	speed: 0.0356s/iter; left time: 24.4351s
Updating learning rate to 1.88409132e-05
Validation loss decreased (0.3193 --> 0.3133).  Saving model state dict ...
Epoch: 3 cost time: 3.1712217330932617
Epoch: 3, Steps: 131 | Train Loss: 0.4995722 Vali Loss: 0.3132720 Best vali loss: 0.3132720
	iters: 100, epoch: 4 | loss: 0.5470237
	speed: 0.0363s/iter; left time: 20.1865s
Updating learning rate to 9.4204566e-06
Validation loss decreased (0.3133 --> 0.3108).  Saving model state dict ...
Epoch: 4 cost time: 2.524582862854004
Epoch: 4, Steps: 131 | Train Loss: 0.5470237 Vali Loss: 0.3108467 Best vali loss: 0.3108467
	iters: 100, epoch: 5 | loss: 0.6394992
	speed: 0.0276s/iter; left time: 11.7485s
Updating learning rate to 4.7102283e-06
Validation loss decreased (0.3108 --> 0.3097).  Saving model state dict ...
Epoch: 5 cost time: 2.254612684249878
Epoch: 5, Steps: 131 | Train Loss: 0.6394992 Vali Loss: 0.3096697 Best vali loss: 0.3096697
	iters: 100, epoch: 6 | loss: 0.3788335
	speed: 0.0547s/iter; left time: 16.0927s
Updating learning rate to 2.35511415e-06
Validation loss decreased (0.3097 --> 0.3091).  Saving model state dict ...
Epoch: 6 cost time: 3.83369779586792
Epoch: 6, Steps: 131 | Train Loss: 0.3788335 Vali Loss: 0.3091236 Best vali loss: 0.3091236
	iters: 100, epoch: 7 | loss: 0.3626446
	speed: 0.0644s/iter; left time: 10.5053s
Updating learning rate to 1.177557075e-06
Validation loss decreased (0.3091 --> 0.3089).  Saving model state dict ...
Epoch: 7 cost time: 4.602856636047363
Epoch: 7, Steps: 131 | Train Loss: 0.3626446 Vali Loss: 0.3088500 Best vali loss: 0.3088500
	iters: 100, epoch: 8 | loss: 0.4084716
	speed: 0.0531s/iter; left time: 1.6982s
Updating learning rate to 5.887785375e-07
Validation loss decreased (0.3089 --> 0.3087).  Saving model state dict ...
Epoch: 8 cost time: 3.889098882675171
Epoch: 8, Steps: 131 | Train Loss: 0.4084716 Vali Loss: 0.3087110 Best vali loss: 0.3087110

best validation loss 0.3087110299355215

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 4, 'learning_rate': 0.0040085882975, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9433817
	speed: 0.0144s/iter; left time: 119.2846s
	iters: 200, epoch: 1 | loss: 0.5935915
	speed: 0.0077s/iter; left time: 62.7858s
	iters: 300, epoch: 1 | loss: 0.7724891
	speed: 0.0067s/iter; left time: 53.7960s
	iters: 400, epoch: 1 | loss: 0.4160764
	speed: 0.0085s/iter; left time: 67.8465s
	iters: 500, epoch: 1 | loss: 0.2720425
	speed: 0.0084s/iter; left time: 66.0787s
	iters: 600, epoch: 1 | loss: 1.2014257
	speed: 0.0085s/iter; left time: 66.1324s
	iters: 700, epoch: 1 | loss: 0.3955585
	speed: 0.0095s/iter; left time: 73.0071s
	iters: 800, epoch: 1 | loss: 0.4085651
	speed: 0.0103s/iter; left time: 78.1645s
	iters: 900, epoch: 1 | loss: 0.3303247
	speed: 0.0095s/iter; left time: 70.6976s
	iters: 1000, epoch: 1 | loss: 0.8710249
	speed: 0.0085s/iter; left time: 62.3122s
Updating learning rate to 0.0038560204899122574
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 9.303139925003052
Epoch: 1, Steps: 1045 | Train Loss: 0.6204480 Vali Loss: 0.2939769 Best vali loss: 0.2939769
	iters: 100, epoch: 2 | loss: 0.4385764
	speed: 0.0293s/iter; left time: 211.1662s
	iters: 200, epoch: 2 | loss: 0.3661505
	speed: 0.0101s/iter; left time: 71.6172s
	iters: 300, epoch: 2 | loss: 0.3525063
	speed: 0.0104s/iter; left time: 72.6398s
	iters: 400, epoch: 2 | loss: 1.1240155
	speed: 0.0095s/iter; left time: 66.0278s
	iters: 500, epoch: 2 | loss: 0.9188031
	speed: 0.0088s/iter; left time: 59.9756s
	iters: 600, epoch: 2 | loss: 0.1950439
	speed: 0.0093s/iter; left time: 62.2197s
	iters: 700, epoch: 2 | loss: 0.3355860
	speed: 0.0101s/iter; left time: 67.1460s
	iters: 800, epoch: 2 | loss: 0.3701719
	speed: 0.0102s/iter; left time: 66.7222s
	iters: 900, epoch: 2 | loss: 0.3810033
	speed: 0.0099s/iter; left time: 63.6254s
	iters: 1000, epoch: 2 | loss: 0.3460379
	speed: 0.0084s/iter; left time: 52.9601s
Updating learning rate to 0.0034215441328236435
Validation loss decreased (0.2940 --> 0.2856).  Saving model state dict ...
Epoch: 2 cost time: 10.014888525009155
Epoch: 2, Steps: 1045 | Train Loss: 0.4827895 Vali Loss: 0.2855510 Best vali loss: 0.2855510
	iters: 100, epoch: 3 | loss: 0.3700943
	speed: 0.0302s/iter; left time: 186.6203s
	iters: 200, epoch: 3 | loss: 0.1417271
	speed: 0.0093s/iter; left time: 56.6502s
	iters: 300, epoch: 3 | loss: 1.1351030
	speed: 0.0073s/iter; left time: 43.7985s
	iters: 400, epoch: 3 | loss: 0.2638942
	speed: 0.0069s/iter; left time: 40.4919s
	iters: 500, epoch: 3 | loss: 0.2409591
	speed: 0.0084s/iter; left time: 48.3298s
	iters: 600, epoch: 3 | loss: 0.5791138
	speed: 0.0101s/iter; left time: 57.4120s
	iters: 700, epoch: 3 | loss: 0.2739435
	speed: 0.0100s/iter; left time: 55.7952s
	iters: 800, epoch: 3 | loss: 1.0809767
	speed: 0.0096s/iter; left time: 52.3310s
	iters: 900, epoch: 3 | loss: 0.5301421
	speed: 0.0094s/iter; left time: 50.2197s
	iters: 1000, epoch: 3 | loss: 0.3062083
	speed: 0.0092s/iter; left time: 48.7168s
Updating learning rate to 0.002771304313062916
Validation loss decreased (0.2856 --> 0.2848).  Saving model state dict ...
Epoch: 3 cost time: 9.45352578163147
Epoch: 3, Steps: 1045 | Train Loss: 0.4922162 Vali Loss: 0.2847540 Best vali loss: 0.2847540
	iters: 100, epoch: 4 | loss: 1.2704142
	speed: 0.0287s/iter; left time: 146.9904s
	iters: 200, epoch: 4 | loss: 0.3204032
	speed: 0.0088s/iter; left time: 44.0643s
	iters: 300, epoch: 4 | loss: 0.2925697
	speed: 0.0099s/iter; left time: 48.5542s
	iters: 400, epoch: 4 | loss: 0.3241333
	speed: 0.0094s/iter; left time: 45.3403s
	iters: 500, epoch: 4 | loss: 1.0272796
	speed: 0.0086s/iter; left time: 40.7192s
	iters: 600, epoch: 4 | loss: 0.2530172
	speed: 0.0097s/iter; left time: 44.8486s
	iters: 700, epoch: 4 | loss: 0.7724935
	speed: 0.0095s/iter; left time: 42.8451s
	iters: 800, epoch: 4 | loss: 0.2941602
	speed: 0.0086s/iter; left time: 37.9845s
	iters: 900, epoch: 4 | loss: 0.3510138
	speed: 0.0102s/iter; left time: 43.9681s
	iters: 1000, epoch: 4 | loss: 0.3979709
	speed: 0.0094s/iter; left time: 39.5716s
Updating learning rate to 0.00200429414875
Epoch: 4 cost time: 9.722385883331299
Epoch: 4, Steps: 1045 | Train Loss: 0.5303456 Vali Loss: 0.2869800 Best vali loss: 0.2847540
	iters: 100, epoch: 5 | loss: 1.2674564
	speed: 0.0291s/iter; left time: 118.5573s
	iters: 200, epoch: 5 | loss: 0.7226645
	speed: 0.0106s/iter; left time: 42.0295s
	iters: 300, epoch: 5 | loss: 0.2667441
	speed: 0.0112s/iter; left time: 43.4456s
	iters: 400, epoch: 5 | loss: 0.4582301
	speed: 0.0091s/iter; left time: 34.4043s
	iters: 500, epoch: 5 | loss: 0.4063487
	speed: 0.0071s/iter; left time: 26.1314s
	iters: 600, epoch: 5 | loss: 0.4657378
	speed: 0.0090s/iter; left time: 32.0798s
	iters: 700, epoch: 5 | loss: 0.5349247
	speed: 0.0089s/iter; left time: 31.1460s
	iters: 800, epoch: 5 | loss: 0.4297818
	speed: 0.0085s/iter; left time: 28.7095s
	iters: 900, epoch: 5 | loss: 0.3068953
	speed: 0.0093s/iter; left time: 30.6300s
	iters: 1000, epoch: 5 | loss: 0.3111647
	speed: 0.0091s/iter; left time: 29.0686s
Updating learning rate to 0.0012372839844370842
Epoch: 5 cost time: 9.69681453704834
Epoch: 5, Steps: 1045 | Train Loss: 0.5169948 Vali Loss: 0.2916789 Best vali loss: 0.2847540
	iters: 100, epoch: 6 | loss: 0.1915994
	speed: 0.0233s/iter; left time: 70.7172s
	iters: 200, epoch: 6 | loss: 0.3827949
	speed: 0.0097s/iter; left time: 28.5857s
	iters: 300, epoch: 6 | loss: 0.3899971
	speed: 0.0091s/iter; left time: 25.7389s
	iters: 400, epoch: 6 | loss: 0.2372272
	speed: 0.0087s/iter; left time: 23.8099s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0042863874146, 'e_layers': 4, 'learning_rate': 5.37539066e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37539066e-05
Validation loss decreased (inf --> 0.3486).  Saving model state dict ...
Epoch: 1 cost time: 2.042942762374878
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3486027 Best vali loss: 0.3486027
Updating learning rate to 2.68769533e-05
Validation loss decreased (0.3486 --> 0.3366).  Saving model state dict ...
Epoch: 2 cost time: 1.7134771347045898
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3366468 Best vali loss: 0.3366468
Updating learning rate to 1.343847665e-05
Validation loss decreased (0.3366 --> 0.3322).  Saving model state dict ...
Epoch: 3 cost time: 2.1073758602142334
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3322154 Best vali loss: 0.3322154

best validation loss 0.332215409433589

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019514269464, 'e_layers': 3, 'learning_rate': 0.0028203081441, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5894333
	speed: 0.0285s/iter; left time: 27.0221s
Updating learning rate to 0.002712966556904441
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 2.9404842853546143
Epoch: 1, Steps: 131 | Train Loss: 0.5894333 Vali Loss: 0.3200833 Best vali loss: 0.3200833
	iters: 100, epoch: 2 | loss: 0.5438456
	speed: 0.0251s/iter; left time: 20.4918s
Updating learning rate to 0.002407283578914378
Epoch: 2 cost time: 2.4856462478637695
Epoch: 2, Steps: 131 | Train Loss: 0.5438456 Vali Loss: 0.3293410 Best vali loss: 0.3200833
	iters: 100, epoch: 3 | loss: 0.4639833
	speed: 0.0379s/iter; left time: 26.0447s
Updating learning rate to 0.0019497966725057021
Epoch: 3 cost time: 2.555975914001465
Epoch: 3, Steps: 131 | Train Loss: 0.4639833 Vali Loss: 0.3256455 Best vali loss: 0.3200833

best validation loss 0.3200832983626447

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4627684
	speed: 0.0201s/iter; left time: 40.2137s
	iters: 200, epoch: 1 | loss: 0.4208206
	speed: 0.0131s/iter; left time: 24.8394s
Updating learning rate to 0.00031785342192023166
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 3.832193374633789
Epoch: 1, Steps: 262 | Train Loss: 0.4417945 Vali Loss: 0.2841347 Best vali loss: 0.2841347
	iters: 100, epoch: 2 | loss: 0.4478254
	speed: 0.0351s/iter; left time: 60.8859s
	iters: 200, epoch: 2 | loss: 0.4573703
	speed: 0.0117s/iter; left time: 19.1646s
Updating learning rate to 0.0002820393495610895
Validation loss decreased (0.2841 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 2.84749436378479
Epoch: 2, Steps: 262 | Train Loss: 0.4525978 Vali Loss: 0.2826234 Best vali loss: 0.2826234
	iters: 100, epoch: 3 | loss: 0.4413480
	speed: 0.0187s/iter; left time: 27.5566s
	iters: 200, epoch: 3 | loss: 0.4024515
	speed: 0.0122s/iter; left time: 16.7795s
Updating learning rate to 0.00022843980248387857
Epoch: 3 cost time: 3.1297767162323
Epoch: 3, Steps: 262 | Train Loss: 0.4218998 Vali Loss: 0.2848096 Best vali loss: 0.2826234

best validation loss 0.2826234357048473

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3870925
	speed: 0.0187s/iter; left time: 22.5880s
	iters: 200, epoch: 4 | loss: 0.4004986
	speed: 0.0100s/iter; left time: 11.1148s
Updating learning rate to 0.00016521482585
Epoch: 4 cost time: 3.0672359466552734
Epoch: 4, Steps: 262 | Train Loss: 0.3937955 Vali Loss: 0.2869956 Best vali loss: 0.2826234
	iters: 100, epoch: 5 | loss: 0.4178544
	speed: 0.0269s/iter; left time: 25.5210s
	iters: 200, epoch: 5 | loss: 0.4650396
	speed: 0.0119s/iter; left time: 10.1098s
Updating learning rate to 0.00010198984921612144
Epoch: 5 cost time: 3.1262710094451904
Epoch: 5, Steps: 262 | Train Loss: 0.4414470 Vali Loss: 0.2957769 Best vali loss: 0.2826234
	iters: 100, epoch: 6 | loss: 0.4450401
	speed: 0.0299s/iter; left time: 20.5163s
	iters: 200, epoch: 6 | loss: 0.2871782
	speed: 0.0115s/iter; left time: 6.7777s
Updating learning rate to 4.8390302138910505e-05
Epoch: 6 cost time: 3.1565258502960205
Epoch: 6, Steps: 262 | Train Loss: 0.3661092 Vali Loss: 0.2957315 Best vali loss: 0.2826234
	iters: 100, epoch: 7 | loss: 0.6128438
	speed: 0.0289s/iter; left time: 12.2790s
	iters: 200, epoch: 7 | loss: 0.3591413
	speed: 0.0120s/iter; left time: 3.9042s
Updating learning rate to 1.2576229779768348e-05
Epoch: 7 cost time: 3.1445090770721436
Epoch: 7, Steps: 262 | Train Loss: 0.4859925 Vali Loss: 0.2965944 Best vali loss: 0.2826234
	iters: 100, epoch: 8 | loss: 0.3473563
	speed: 0.0232s/iter; left time: 3.7820s
	iters: 200, epoch: 8 | loss: 0.3297523
	speed: 0.0110s/iter; left time: 0.6942s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.8211965560913086
Epoch: 8, Steps: 262 | Train Loss: 0.3385543 Vali Loss: 0.2988131 Best vali loss: 0.2826234

best validation loss 0.2826234357048473

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0061161357241, 'e_layers': 2, 'learning_rate': 0.0026491544935, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3993894
	speed: 0.0159s/iter; left time: 31.7997s
	iters: 200, epoch: 1 | loss: 0.3150782
	speed: 0.0097s/iter; left time: 18.3862s
Updating learning rate to 0.0026491544935
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 2.7416720390319824
Epoch: 1, Steps: 262 | Train Loss: 0.3572338 Vali Loss: 0.2813078 Best vali loss: 0.2813078
	iters: 100, epoch: 2 | loss: 0.4453451
	speed: 0.0170s/iter; left time: 29.4811s
	iters: 200, epoch: 2 | loss: 0.3697793
	speed: 0.0080s/iter; left time: 13.1453s
Updating learning rate to 0.00132457724675
Epoch: 2 cost time: 2.1285223960876465
Epoch: 2, Steps: 262 | Train Loss: 0.4075622 Vali Loss: 0.2852282 Best vali loss: 0.2813078
	iters: 100, epoch: 3 | loss: 0.3988144
	speed: 0.0166s/iter; left time: 24.4926s
	iters: 200, epoch: 3 | loss: 0.2168953
	speed: 0.0092s/iter; left time: 12.6172s
Updating learning rate to 0.000662288623375
Epoch: 3 cost time: 2.2194831371307373
Epoch: 3, Steps: 262 | Train Loss: 0.3078549 Vali Loss: 0.2846854 Best vali loss: 0.2813078
	iters: 100, epoch: 4 | loss: 0.4175521
	speed: 0.0175s/iter; left time: 21.1437s
	iters: 200, epoch: 4 | loss: 0.2712150
	speed: 0.0080s/iter; left time: 8.9317s
Updating learning rate to 0.0003311443116875
Epoch: 4 cost time: 2.1492786407470703
Epoch: 4, Steps: 262 | Train Loss: 0.3443836 Vali Loss: 0.2961046 Best vali loss: 0.2813078
	iters: 100, epoch: 5 | loss: 0.3629660
	speed: 0.0165s/iter; left time: 15.6771s
	iters: 200, epoch: 5 | loss: 0.2552904
	speed: 0.0078s/iter; left time: 6.6072s
Updating learning rate to 0.00016557215584375
Epoch: 5 cost time: 2.112783193588257
Epoch: 5, Steps: 262 | Train Loss: 0.3091282 Vali Loss: 0.2950087 Best vali loss: 0.2813078
	iters: 100, epoch: 6 | loss: 0.3414206
	speed: 0.0169s/iter; left time: 11.6053s
	iters: 200, epoch: 6 | loss: 0.4395116
	speed: 0.0075s/iter; left time: 4.4053s
Updating learning rate to 8.2786077921875e-05
Epoch: 6 cost time: 2.0636956691741943
Epoch: 6, Steps: 262 | Train Loss: 0.3904661 Vali Loss: 0.2910741 Best vali loss: 0.2813078
	iters: 100, epoch: 7 | loss: 0.6043049
	speed: 0.0169s/iter; left time: 7.1891s
	iters: 200, epoch: 7 | loss: 0.4081481
	speed: 0.0081s/iter; left time: 2.6383s
Updating learning rate to 4.13930389609375e-05
Epoch: 7 cost time: 2.105816125869751
Epoch: 7, Steps: 262 | Train Loss: 0.5062265 Vali Loss: 0.2962478 Best vali loss: 0.2813078
	iters: 100, epoch: 8 | loss: 0.4435588
	speed: 0.0169s/iter; left time: 2.7565s
	iters: 200, epoch: 8 | loss: 0.3856049
	speed: 0.0080s/iter; left time: 0.5062s
Updating learning rate to 2.069651948046875e-05
Epoch: 8 cost time: 2.06925106048584
Epoch: 8, Steps: 262 | Train Loss: 0.4145819 Vali Loss: 0.2954244 Best vali loss: 0.2813078

best validation loss 0.28130779588541693

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062416843763, 'e_layers': 2, 'learning_rate': 9.67455128e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7228573
	speed: 0.0139s/iter; left time: 27.7004s
	iters: 200, epoch: 1 | loss: 0.6687163
	speed: 0.0081s/iter; left time: 15.2726s
Updating learning rate to 9.306335596911435e-05
Validation loss decreased (inf --> 0.3051).  Saving model state dict ...
Epoch: 1 cost time: 2.3639185428619385
Epoch: 1, Steps: 262 | Train Loss: 0.6957868 Vali Loss: 0.3050674 Best vali loss: 0.3050674
	iters: 100, epoch: 2 | loss: 0.6898043
	speed: 0.0164s/iter; left time: 28.5373s
	iters: 200, epoch: 2 | loss: 0.4270598
	speed: 0.0080s/iter; left time: 13.0108s
Updating learning rate to 8.257746047512496e-05
Validation loss decreased (0.3051 --> 0.2885).  Saving model state dict ...
Epoch: 2 cost time: 2.1270687580108643
Epoch: 2, Steps: 262 | Train Loss: 0.5584320 Vali Loss: 0.2884928 Best vali loss: 0.2884928
	iters: 100, epoch: 3 | loss: 0.6958114
	speed: 0.0169s/iter; left time: 24.8326s
	iters: 200, epoch: 3 | loss: 0.8654882
	speed: 0.0088s/iter; left time: 12.0364s
Updating learning rate to 6.688420885211237e-05
Validation loss decreased (0.2885 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 2.1847574710845947
Epoch: 3, Steps: 262 | Train Loss: 0.7806498 Vali Loss: 0.2838817 Best vali loss: 0.2838817
	iters: 100, epoch: 4 | loss: 0.6545815
	speed: 0.0176s/iter; left time: 21.3572s
	iters: 200, epoch: 4 | loss: 0.5055830
	speed: 0.0080s/iter; left time: 8.9234s
Updating learning rate to 4.83727564e-05
Validation loss decreased (0.2839 --> 0.2819).  Saving model state dict ...
Epoch: 4 cost time: 2.1277048587799072
Epoch: 4, Steps: 262 | Train Loss: 0.5800823 Vali Loss: 0.2818819 Best vali loss: 0.2818819
	iters: 100, epoch: 5 | loss: 0.3311557
	speed: 0.0169s/iter; left time: 16.0770s
	iters: 200, epoch: 5 | loss: 0.4884556
	speed: 0.0077s/iter; left time: 6.5198s
Updating learning rate to 2.986130394788764e-05
Epoch: 5 cost time: 2.0599660873413086
Epoch: 5, Steps: 262 | Train Loss: 0.4098056 Vali Loss: 0.2820011 Best vali loss: 0.2818819
	iters: 100, epoch: 6 | loss: 0.6537849
	speed: 0.0165s/iter; left time: 11.3124s
	iters: 200, epoch: 6 | loss: 0.2843307
	speed: 0.0077s/iter; left time: 4.5088s
Updating learning rate to 1.4168052324875036e-05
Validation loss decreased (0.2819 --> 0.2814).  Saving model state dict ...
Epoch: 6 cost time: 2.042235851287842
Epoch: 6, Steps: 262 | Train Loss: 0.4690578 Vali Loss: 0.2813809 Best vali loss: 0.2813809
	iters: 100, epoch: 7 | loss: 0.5087303
	speed: 0.0170s/iter; left time: 7.2211s
	iters: 200, epoch: 7 | loss: 0.3118905
	speed: 0.0078s/iter; left time: 2.5413s
Updating learning rate to 3.682156830885646e-06
Validation loss decreased (0.2814 --> 0.2814).  Saving model state dict ...
Epoch: 7 cost time: 2.1675639152526855
Epoch: 7, Steps: 262 | Train Loss: 0.4103104 Vali Loss: 0.2813752 Best vali loss: 0.2813752
	iters: 100, epoch: 8 | loss: 0.4070908
	speed: 0.0216s/iter; left time: 3.5284s
	iters: 200, epoch: 8 | loss: 0.3747903
	speed: 0.0080s/iter; left time: 0.5039s
Updating learning rate to 0.0
Validation loss decreased (0.2814 --> 0.2814).  Saving model state dict ...
Epoch: 8 cost time: 2.1711606979370117
Epoch: 8, Steps: 262 | Train Loss: 0.3909405 Vali Loss: 0.2813718 Best vali loss: 0.2813718

best validation loss 0.2813718357064902

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6153992
	speed: 0.0143s/iter; left time: 28.5854s
	iters: 200, epoch: 1 | loss: 0.7840914
	speed: 0.0077s/iter; left time: 14.6611s
Updating learning rate to 0.000288581929876693
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 2.3488316535949707
Epoch: 1, Steps: 262 | Train Loss: 0.6997453 Vali Loss: 0.2806478 Best vali loss: 0.2806478
	iters: 100, epoch: 2 | loss: 0.3516540
	speed: 0.0166s/iter; left time: 28.8557s
	iters: 200, epoch: 2 | loss: 0.6151470
	speed: 0.0076s/iter; left time: 12.4269s
Updating learning rate to 0.00025606601717798207
Epoch: 2 cost time: 2.048466205596924
Epoch: 2, Steps: 262 | Train Loss: 0.4834005 Vali Loss: 0.2833470 Best vali loss: 0.2806478
	iters: 100, epoch: 3 | loss: 0.6335730
	speed: 0.0175s/iter; left time: 25.7566s
	iters: 200, epoch: 3 | loss: 0.3991112
	speed: 0.0076s/iter; left time: 10.3882s
Updating learning rate to 0.00020740251485476345
Validation loss decreased (0.2806 --> 0.2795).  Saving model state dict ...
Epoch: 3 cost time: 2.122573137283325
Epoch: 3, Steps: 262 | Train Loss: 0.5163421 Vali Loss: 0.2794538 Best vali loss: 0.2794538

best validation loss 0.279453784953311

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.003415295389, 'e_layers': 1, 'learning_rate': 0.0001528244414, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5476066
	speed: 0.0144s/iter; left time: 28.7559s
	iters: 200, epoch: 1 | loss: 0.4767633
	speed: 0.0078s/iter; left time: 14.8904s
Updating learning rate to 0.00014700790743846527
Validation loss decreased (inf --> 0.2972).  Saving model state dict ...
Epoch: 1 cost time: 2.3486251831054688
Epoch: 1, Steps: 262 | Train Loss: 0.5121849 Vali Loss: 0.2971521 Best vali loss: 0.2971521
	iters: 100, epoch: 2 | loss: 0.7091787
	speed: 0.0129s/iter; left time: 22.3677s
	iters: 200, epoch: 2 | loss: 0.2662944
	speed: 0.0056s/iter; left time: 9.2177s
Updating learning rate to 0.00013044382012249305
Validation loss decreased (0.2972 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 1.4017479419708252
Epoch: 2, Steps: 262 | Train Loss: 0.4877365 Vali Loss: 0.2836074 Best vali loss: 0.2836074
	iters: 100, epoch: 3 | loss: 0.4037339
	speed: 0.0121s/iter; left time: 17.8333s
	iters: 200, epoch: 3 | loss: 0.4321185
	speed: 0.0065s/iter; left time: 8.8593s
Updating learning rate to 0.00010565391159211477
Validation loss decreased (0.2836 --> 0.2803).  Saving model state dict ...
Epoch: 3 cost time: 1.609555721282959
Epoch: 3, Steps: 262 | Train Loss: 0.4179262 Vali Loss: 0.2802865 Best vali loss: 0.2802865

best validation loss 0.2802864621178995

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0025198955415, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7257760
	speed: 0.0136s/iter; left time: 27.1912s
	iters: 200, epoch: 1 | loss: 0.4565246
	speed: 0.0046s/iter; left time: 8.6752s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 1.7736523151397705
Epoch: 1, Steps: 262 | Train Loss: 0.5911503 Vali Loss: 0.2861489 Best vali loss: 0.2861489
	iters: 100, epoch: 2 | loss: 0.4750738
	speed: 0.0143s/iter; left time: 24.7306s
	iters: 200, epoch: 2 | loss: 0.3832628
	speed: 0.0088s/iter; left time: 14.3834s
Updating learning rate to 0.0002612410192867383
Validation loss decreased (0.2861 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 2.1854171752929688
Epoch: 2, Steps: 262 | Train Loss: 0.4291683 Vali Loss: 0.2832513 Best vali loss: 0.2832513
	iters: 100, epoch: 3 | loss: 0.5605903
	speed: 0.0221s/iter; left time: 32.5315s
	iters: 200, epoch: 3 | loss: 0.8777779
	speed: 0.0104s/iter; left time: 14.2993s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 2.6283109188079834
Epoch: 3, Steps: 262 | Train Loss: 0.7191841 Vali Loss: 0.2849391 Best vali loss: 0.2832513

best validation loss 0.2832512730235901

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4768445
	speed: 0.0127s/iter; left time: 15.3650s
	iters: 200, epoch: 4 | loss: 0.7225666
	speed: 0.0056s/iter; left time: 6.2578s
Updating learning rate to 0.00015
Epoch: 4 cost time: 2.1657814979553223
Epoch: 4, Steps: 262 | Train Loss: 0.5997055 Vali Loss: 0.2823245 Best vali loss: 0.2794538
	iters: 100, epoch: 5 | loss: 0.3349438
	speed: 0.0310s/iter; left time: 29.3826s
	iters: 200, epoch: 5 | loss: 0.5542583
	speed: 0.0137s/iter; left time: 11.6536s
Updating learning rate to 9.259748514523653e-05
Epoch: 5 cost time: 3.421236276626587
Epoch: 5, Steps: 262 | Train Loss: 0.4446011 Vali Loss: 0.2852325 Best vali loss: 0.2794538
	iters: 100, epoch: 6 | loss: 0.6081523
	speed: 0.0334s/iter; left time: 22.9617s
	iters: 200, epoch: 6 | loss: 0.3740434
	speed: 0.0106s/iter; left time: 6.2058s
Updating learning rate to 4.3933982822017876e-05
Epoch: 6 cost time: 2.8154914379119873
Epoch: 6, Steps: 262 | Train Loss: 0.4910979 Vali Loss: 0.2846867 Best vali loss: 0.2794538
	iters: 100, epoch: 7 | loss: 0.3198563
	speed: 0.0222s/iter; left time: 9.4293s
	iters: 200, epoch: 7 | loss: 0.5142543
	speed: 0.0102s/iter; left time: 3.3246s
Updating learning rate to 1.1418070123306989e-05
Epoch: 7 cost time: 2.7142903804779053
Epoch: 7, Steps: 262 | Train Loss: 0.4170553 Vali Loss: 0.2836922 Best vali loss: 0.2794538
	iters: 100, epoch: 8 | loss: 0.3588851
	speed: 0.0253s/iter; left time: 4.1181s
	iters: 200, epoch: 8 | loss: 0.4622282
	speed: 0.0105s/iter; left time: 0.6641s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7130136489868164
Epoch: 8, Steps: 262 | Train Loss: 0.4105567 Vali Loss: 0.2845707 Best vali loss: 0.2794538

best validation loss 0.279453784953311

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0015226276442, 'e_layers': 1, 'learning_rate': 0.0003229925127, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4035746
	speed: 0.0207s/iter; left time: 19.6582s
Updating learning rate to 0.0003229925127
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 2.2494957447052
Epoch: 1, Steps: 131 | Train Loss: 0.4035746 Vali Loss: 0.2831255 Best vali loss: 0.2831255
	iters: 100, epoch: 2 | loss: 0.5596491
	speed: 0.0259s/iter; left time: 21.2021s
Updating learning rate to 0.00016149625635
Epoch: 2 cost time: 1.9861533641815186
Epoch: 2, Steps: 131 | Train Loss: 0.5596491 Vali Loss: 0.2836091 Best vali loss: 0.2831255
	iters: 100, epoch: 3 | loss: 0.4953188
	speed: 0.0218s/iter; left time: 14.9428s
Updating learning rate to 8.0748128175e-05
Validation loss decreased (0.2831 --> 0.2831).  Saving model state dict ...
Epoch: 3 cost time: 1.5886569023132324
Epoch: 3, Steps: 131 | Train Loss: 0.4953188 Vali Loss: 0.2830671 Best vali loss: 0.2830671
	iters: 100, epoch: 4 | loss: 0.5814658
	speed: 0.0207s/iter; left time: 11.5143s
Updating learning rate to 4.03740640875e-05
Validation loss decreased (0.2831 --> 0.2803).  Saving model state dict ...
Epoch: 4 cost time: 1.2679662704467773
Epoch: 4, Steps: 131 | Train Loss: 0.5814658 Vali Loss: 0.2802536 Best vali loss: 0.2802536
	iters: 100, epoch: 5 | loss: 0.4044084
	speed: 0.0180s/iter; left time: 7.6398s
Updating learning rate to 2.018703204375e-05
Validation loss decreased (0.2803 --> 0.2801).  Saving model state dict ...
Epoch: 5 cost time: 1.564378023147583
Epoch: 5, Steps: 131 | Train Loss: 0.4044084 Vali Loss: 0.2801341 Best vali loss: 0.2801341
	iters: 100, epoch: 6 | loss: 0.4730374
	speed: 0.0225s/iter; left time: 6.6167s
Updating learning rate to 1.0093516021875e-05
Validation loss decreased (0.2801 --> 0.2798).  Saving model state dict ...
Epoch: 6 cost time: 1.642164945602417
Epoch: 6, Steps: 131 | Train Loss: 0.4730374 Vali Loss: 0.2798157 Best vali loss: 0.2798157
	iters: 100, epoch: 7 | loss: 0.5351845
	speed: 0.0281s/iter; left time: 4.5771s
Updating learning rate to 5.0467580109375e-06
Epoch: 7 cost time: 2.2761013507843018
Epoch: 7, Steps: 131 | Train Loss: 0.5351845 Vali Loss: 0.2800990 Best vali loss: 0.2798157
	iters: 100, epoch: 8 | loss: 0.6334156
	speed: 0.0194s/iter; left time: 0.6201s
Updating learning rate to 2.52337900546875e-06
Epoch: 8 cost time: 1.4108829498291016
Epoch: 8, Steps: 131 | Train Loss: 0.6334156 Vali Loss: 0.2800394 Best vali loss: 0.2798157

best validation loss 0.2798156785384214

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0067707384255, 'e_layers': 1, 'learning_rate': 0.0002592776834, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4220148
	speed: 0.0172s/iter; left time: 34.2603s
	iters: 200, epoch: 1 | loss: 0.5024104
	speed: 0.0081s/iter; left time: 15.3937s
Updating learning rate to 0.0002494095141651007
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 2.681900978088379
Epoch: 1, Steps: 262 | Train Loss: 0.4622126 Vali Loss: 0.2878685 Best vali loss: 0.2878685
	iters: 100, epoch: 2 | loss: 0.7476799
	speed: 0.0258s/iter; left time: 44.7969s
	iters: 200, epoch: 2 | loss: 0.5270866
	speed: 0.0105s/iter; left time: 17.1473s
Updating learning rate to 0.00022130734577123935
Validation loss decreased (0.2879 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 2.9065396785736084
Epoch: 2, Steps: 262 | Train Loss: 0.6373833 Vali Loss: 0.2810019 Best vali loss: 0.2810019
	iters: 100, epoch: 3 | loss: 0.2803970
	speed: 0.0471s/iter; left time: 69.3643s
	iters: 200, epoch: 3 | loss: 0.4922738
	speed: 0.0116s/iter; left time: 15.9812s
Updating learning rate to 0.00017924947860959052
Validation loss decreased (0.2810 --> 0.2806).  Saving model state dict ...
Epoch: 3 cost time: 2.9964206218719482
Epoch: 3, Steps: 262 | Train Loss: 0.3863354 Vali Loss: 0.2806192 Best vali loss: 0.2806192
	iters: 100, epoch: 4 | loss: 0.9043090
	speed: 0.0440s/iter; left time: 53.3084s
	iters: 200, epoch: 4 | loss: 0.2573621
	speed: 0.0115s/iter; left time: 12.7575s
Updating learning rate to 0.0001296388417
Epoch: 4 cost time: 3.0764129161834717
Epoch: 4, Steps: 262 | Train Loss: 0.5808355 Vali Loss: 0.2829168 Best vali loss: 0.2806192
	iters: 100, epoch: 5 | loss: 0.7317438
	speed: 0.0433s/iter; left time: 41.1306s
	iters: 200, epoch: 5 | loss: 1.1630859
	speed: 0.0100s/iter; left time: 8.4951s
Updating learning rate to 8.002820479040947e-05
Epoch: 5 cost time: 2.988924980163574
Epoch: 5, Steps: 262 | Train Loss: 0.9474149 Vali Loss: 0.2812219 Best vali loss: 0.2806192
	iters: 100, epoch: 6 | loss: 0.5131452
	speed: 0.0452s/iter; left time: 31.0442s
	iters: 200, epoch: 6 | loss: 0.3701709
	speed: 0.0114s/iter; left time: 6.6944s
Updating learning rate to 3.797033762876063e-05
Validation loss decreased (0.2806 --> 0.2802).  Saving model state dict ...
Epoch: 6 cost time: 3.080510139465332
Epoch: 6, Steps: 262 | Train Loss: 0.4416581 Vali Loss: 0.2802462 Best vali loss: 0.2802462
	iters: 100, epoch: 7 | loss: 0.5528337
	speed: 0.0357s/iter; left time: 15.1903s
	iters: 200, epoch: 7 | loss: 0.3890417
	speed: 0.0123s/iter; left time: 4.0083s
Updating learning rate to 9.868169234899294e-06
Epoch: 7 cost time: 3.1196348667144775
Epoch: 7, Steps: 262 | Train Loss: 0.4709377 Vali Loss: 0.2807625 Best vali loss: 0.2802462
	iters: 100, epoch: 8 | loss: 1.0368363
	speed: 0.0492s/iter; left time: 8.0128s
	iters: 200, epoch: 8 | loss: 0.4756691
	speed: 0.0098s/iter; left time: 0.6164s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.963576078414917
Epoch: 8, Steps: 262 | Train Loss: 0.7562527 Vali Loss: 0.2807116 Best vali loss: 0.2802462

best validation loss 0.2802461511852042

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2711982
	speed: 0.0111s/iter; left time: 45.2803s
	iters: 200, epoch: 1 | loss: 0.3217775
	speed: 0.0058s/iter; left time: 23.2882s
	iters: 300, epoch: 1 | loss: 0.2785318
	speed: 0.0070s/iter; left time: 27.0578s
	iters: 400, epoch: 1 | loss: 0.6046037
	speed: 0.0069s/iter; left time: 26.2980s
	iters: 500, epoch: 1 | loss: 0.7593597
	speed: 0.0065s/iter; left time: 23.8273s
Updating learning rate to 0.0004342987517734106
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 3.5703580379486084
Epoch: 1, Steps: 523 | Train Loss: 0.4470942 Vali Loss: 0.2835349 Best vali loss: 0.2835349
	iters: 100, epoch: 2 | loss: 0.2807145
	speed: 0.0146s/iter; left time: 51.9411s
	iters: 200, epoch: 2 | loss: 0.8123380
	speed: 0.0054s/iter; left time: 18.5577s
	iters: 300, epoch: 2 | loss: 0.5117219
	speed: 0.0061s/iter; left time: 20.6251s
	iters: 400, epoch: 2 | loss: 0.9556945
	speed: 0.0056s/iter; left time: 18.3357s
	iters: 500, epoch: 2 | loss: 0.4395756
	speed: 0.0065s/iter; left time: 20.6298s
Updating learning rate to 0.0003853642245704867
Epoch: 2 cost time: 3.214632272720337
Epoch: 2, Steps: 523 | Train Loss: 0.6000089 Vali Loss: 0.2899817 Best vali loss: 0.2835349
	iters: 100, epoch: 3 | loss: 0.4603625
	speed: 0.0159s/iter; left time: 48.3862s
	iters: 200, epoch: 3 | loss: 0.2623306
	speed: 0.0063s/iter; left time: 18.6276s
	iters: 300, epoch: 3 | loss: 0.3443571
	speed: 0.0065s/iter; left time: 18.4816s
	iters: 400, epoch: 3 | loss: 0.6166804
	speed: 0.0069s/iter; left time: 18.8644s
	iters: 500, epoch: 3 | loss: 0.5330824
	speed: 0.0059s/iter; left time: 15.5647s
Updating learning rate to 0.0003121285291652796
Validation loss decreased (0.2835 --> 0.2730).  Saving model state dict ...
Epoch: 3 cost time: 3.389857769012451
Epoch: 3, Steps: 523 | Train Loss: 0.4433626 Vali Loss: 0.2729667 Best vali loss: 0.2729667

best validation loss 0.27296667459863144

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0034938739476, 'e_layers': 4, 'learning_rate': 0.0001269098969, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001220796765595138
Validation loss decreased (inf --> 0.3144).  Saving model state dict ...
Epoch: 1 cost time: 1.733976125717163
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3143592 Best vali loss: 0.3143592
Updating learning rate to 0.0001083243727988378
Validation loss decreased (0.3144 --> 0.2976).  Saving model state dict ...
Epoch: 2 cost time: 1.7597033977508545
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2976296 Best vali loss: 0.2976296
Updating learning rate to 8.773810592339583e-05
Validation loss decreased (0.2976 --> 0.2902).  Saving model state dict ...
Epoch: 3 cost time: 1.6798977851867676
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2902334 Best vali loss: 0.2902334

best validation loss 0.29023336206018013

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0017396805512, 'e_layers': 3, 'learning_rate': 0.0001397169929, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001397169929
Validation loss decreased (inf --> 0.3197).  Saving model state dict ...
Epoch: 1 cost time: 1.8914010524749756
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3196741 Best vali loss: 0.3196741
Updating learning rate to 6.985849645e-05
Validation loss decreased (0.3197 --> 0.2988).  Saving model state dict ...
Epoch: 2 cost time: 0.765437126159668
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2987958 Best vali loss: 0.2987958
Updating learning rate to 3.4929248225e-05
Validation loss decreased (0.2988 --> 0.2939).  Saving model state dict ...
Epoch: 3 cost time: 1.6875038146972656
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2938773 Best vali loss: 0.2938773

best validation loss 0.29387728056419116

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2536435
	speed: 0.0125s/iter; left time: 31.5616s
	iters: 200, epoch: 4 | loss: 0.3343447
	speed: 0.0068s/iter; left time: 16.4922s
	iters: 300, epoch: 4 | loss: 0.2935324
	speed: 0.0073s/iter; left time: 16.9831s
	iters: 400, epoch: 4 | loss: 0.4804516
	speed: 0.0069s/iter; left time: 15.2079s
	iters: 500, epoch: 4 | loss: 0.5450732
	speed: 0.0070s/iter; left time: 14.8788s
Updating learning rate to 0.0002257411363
Epoch: 4 cost time: 3.8905138969421387
Epoch: 4, Steps: 523 | Train Loss: 0.3814091 Vali Loss: 0.2882992 Best vali loss: 0.2729667
	iters: 100, epoch: 5 | loss: 0.2411633
	speed: 0.0167s/iter; left time: 33.3653s
	iters: 200, epoch: 5 | loss: 0.5515279
	speed: 0.0069s/iter; left time: 13.0540s
	iters: 300, epoch: 5 | loss: 0.4154493
	speed: 0.0067s/iter; left time: 12.0848s
	iters: 400, epoch: 5 | loss: 0.6803392
	speed: 0.0071s/iter; left time: 12.0039s
	iters: 500, epoch: 5 | loss: 0.2805083
	speed: 0.0074s/iter; left time: 11.7717s
Updating learning rate to 0.00013935374343472043
Epoch: 5 cost time: 3.7376327514648438
Epoch: 5, Steps: 523 | Train Loss: 0.4337976 Vali Loss: 0.2923086 Best vali loss: 0.2729667
	iters: 100, epoch: 6 | loss: 0.2887785
	speed: 0.0167s/iter; left time: 24.5987s
	iters: 200, epoch: 6 | loss: 0.2432218
	speed: 0.0062s/iter; left time: 8.5296s
	iters: 300, epoch: 6 | loss: 0.2686371
	speed: 0.0058s/iter; left time: 7.3737s
	iters: 400, epoch: 6 | loss: 0.5216416
	speed: 0.0065s/iter; left time: 7.5615s
	iters: 500, epoch: 6 | loss: 0.3279651
	speed: 0.0062s/iter; left time: 6.6043s
Updating learning rate to 6.611804802951332e-05
Epoch: 6 cost time: 3.421773672103882
Epoch: 6, Steps: 523 | Train Loss: 0.3300488 Vali Loss: 0.3159439 Best vali loss: 0.2729667
	iters: 100, epoch: 7 | loss: 0.3712071
	speed: 0.0142s/iter; left time: 13.4563s
	iters: 200, epoch: 7 | loss: 0.2992283
	speed: 0.0071s/iter; left time: 6.0188s
	iters: 300, epoch: 7 | loss: 0.4158975
	speed: 0.0072s/iter; left time: 5.3760s
	iters: 400, epoch: 7 | loss: 0.2746799
	speed: 0.0069s/iter; left time: 4.4579s
	iters: 500, epoch: 7 | loss: 0.2051893
	speed: 0.0066s/iter; left time: 3.5952s
Updating learning rate to 1.718352082658934e-05
Epoch: 7 cost time: 3.6073267459869385
Epoch: 7, Steps: 523 | Train Loss: 0.3132404 Vali Loss: 0.3107637 Best vali loss: 0.2729667
	iters: 100, epoch: 8 | loss: 0.2789465
	speed: 0.0167s/iter; left time: 7.0950s
	iters: 200, epoch: 8 | loss: 0.3198230
	speed: 0.0056s/iter; left time: 1.8048s
	iters: 300, epoch: 8 | loss: 0.3096659
	speed: 0.0059s/iter; left time: 1.3225s
	iters: 400, epoch: 8 | loss: 0.2392016
	speed: 0.0063s/iter; left time: 0.7788s
	iters: 500, epoch: 8 | loss: 0.3919469
	speed: 0.0059s/iter; left time: 0.1424s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2821543216705322
Epoch: 8, Steps: 523 | Train Loss: 0.3079168 Vali Loss: 0.3273241 Best vali loss: 0.2729667

best validation loss 0.27296667459863144

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066334976282, 'e_layers': 4, 'learning_rate': 0.0046791286395, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7351540
	speed: 0.0156s/iter; left time: 63.6021s
	iters: 200, epoch: 1 | loss: 0.9660034
	speed: 0.0098s/iter; left time: 39.1399s
	iters: 300, epoch: 1 | loss: 0.7390677
	speed: 0.0098s/iter; left time: 37.9907s
	iters: 400, epoch: 1 | loss: 0.3055648
	speed: 0.0089s/iter; left time: 33.5754s
	iters: 500, epoch: 1 | loss: 0.4639171
	speed: 0.0097s/iter; left time: 35.7061s
Updating learning rate to 0.0046791286395
Validation loss decreased (inf --> 0.3241).  Saving model state dict ...
Epoch: 1 cost time: 5.306734561920166
Epoch: 1, Steps: 523 | Train Loss: 0.6419414 Vali Loss: 0.3241391 Best vali loss: 0.3241391
	iters: 100, epoch: 2 | loss: 0.7487946
	speed: 0.0179s/iter; left time: 63.7378s
	iters: 200, epoch: 2 | loss: 0.2564849
	speed: 0.0083s/iter; left time: 28.6196s
	iters: 300, epoch: 2 | loss: 1.2455434
	speed: 0.0069s/iter; left time: 23.1906s
	iters: 400, epoch: 2 | loss: 1.1486663
	speed: 0.0074s/iter; left time: 23.9945s
	iters: 500, epoch: 2 | loss: 0.3513776
	speed: 0.0093s/iter; left time: 29.4103s
Updating learning rate to 0.00233956431975
Epoch: 2 cost time: 4.282391309738159
Epoch: 2, Steps: 523 | Train Loss: 0.7501733 Vali Loss: 0.3301483 Best vali loss: 0.3241391
	iters: 100, epoch: 3 | loss: 1.2092865
	speed: 0.0188s/iter; left time: 57.0600s
	iters: 200, epoch: 3 | loss: 1.0656326
	speed: 0.0093s/iter; left time: 27.3263s
	iters: 300, epoch: 3 | loss: 0.6072580
	speed: 0.0082s/iter; left time: 23.3308s
	iters: 400, epoch: 3 | loss: 0.3547704
	speed: 0.0066s/iter; left time: 17.9952s
	iters: 500, epoch: 3 | loss: 0.8393511
	speed: 0.0087s/iter; left time: 22.8893s
Updating learning rate to 0.001169782159875
Validation loss decreased (0.3241 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 4.459015369415283
Epoch: 3, Steps: 523 | Train Loss: 0.8152597 Vali Loss: 0.3226269 Best vali loss: 0.3226269
	iters: 100, epoch: 4 | loss: 0.5046116
	speed: 0.0190s/iter; left time: 47.7452s
	iters: 200, epoch: 4 | loss: 0.8161426
	speed: 0.0066s/iter; left time: 15.9711s
	iters: 300, epoch: 4 | loss: 1.2273005
	speed: 0.0077s/iter; left time: 17.7800s
	iters: 400, epoch: 4 | loss: 0.9484169
	speed: 0.0085s/iter; left time: 18.8580s
	iters: 500, epoch: 4 | loss: 0.9282232
	speed: 0.0077s/iter; left time: 16.2098s
Updating learning rate to 0.0005848910799375
Epoch: 4 cost time: 4.146161317825317
Epoch: 4, Steps: 523 | Train Loss: 0.8849390 Vali Loss: 0.3229525 Best vali loss: 0.3226269
	iters: 100, epoch: 5 | loss: 0.6396975
	speed: 0.0182s/iter; left time: 36.1786s
	iters: 200, epoch: 5 | loss: 0.3994893
	speed: 0.0083s/iter; left time: 15.6716s
	iters: 300, epoch: 5 | loss: 0.6622020
	speed: 0.0065s/iter; left time: 11.7208s
	iters: 400, epoch: 5 | loss: 0.4484952
	speed: 0.0070s/iter; left time: 11.9302s
	iters: 500, epoch: 5 | loss: 0.9324417
	speed: 0.0087s/iter; left time: 13.9365s
Updating learning rate to 0.00029244553996875
Validation loss decreased (0.3226 --> 0.3220).  Saving model state dict ...
Epoch: 5 cost time: 4.193336009979248
Epoch: 5, Steps: 523 | Train Loss: 0.6164651 Vali Loss: 0.3220421 Best vali loss: 0.3220421
	iters: 100, epoch: 6 | loss: 0.3054714
	speed: 0.0177s/iter; left time: 26.0125s
	iters: 200, epoch: 6 | loss: 0.9407610
	speed: 0.0073s/iter; left time: 9.9553s
	iters: 300, epoch: 6 | loss: 0.4397451
	speed: 0.0091s/iter; left time: 11.5094s
	iters: 400, epoch: 6 | loss: 0.4096659
	speed: 0.0101s/iter; left time: 11.8441s
	iters: 500, epoch: 6 | loss: 0.9971840
	speed: 0.0101s/iter; left time: 10.7719s
Updating learning rate to 0.000146222769984375
Validation loss decreased (0.3220 --> 0.3220).  Saving model state dict ...
Epoch: 6 cost time: 4.776490211486816
Epoch: 6, Steps: 523 | Train Loss: 0.6185655 Vali Loss: 0.3220202 Best vali loss: 0.3220202
	iters: 100, epoch: 7 | loss: 0.4988603
	speed: 0.0210s/iter; left time: 19.8525s
	iters: 200, epoch: 7 | loss: 0.4201857
	speed: 0.0091s/iter; left time: 7.7495s
	iters: 300, epoch: 7 | loss: 0.4237264
	speed: 0.0100s/iter; left time: 7.4574s
	iters: 400, epoch: 7 | loss: 0.4999134
	speed: 0.0103s/iter; left time: 6.6328s
	iters: 500, epoch: 7 | loss: 0.7081346
	speed: 0.0101s/iter; left time: 5.5107s
Updating learning rate to 7.31113849921875e-05
Epoch: 7 cost time: 5.25553035736084
Epoch: 7, Steps: 523 | Train Loss: 0.5101641 Vali Loss: 0.3220985 Best vali loss: 0.3220202
	iters: 100, epoch: 8 | loss: 0.5866022
	speed: 0.0194s/iter; left time: 8.2086s
	iters: 200, epoch: 8 | loss: 0.6646704
	speed: 0.0092s/iter; left time: 2.9947s
	iters: 300, epoch: 8 | loss: 0.3758890
	speed: 0.0098s/iter; left time: 2.1876s
	iters: 400, epoch: 8 | loss: 0.2541927
	speed: 0.0093s/iter; left time: 1.1527s
	iters: 500, epoch: 8 | loss: 0.3671851
	speed: 0.0092s/iter; left time: 0.2219s
Updating learning rate to 3.655569249609375e-05
Epoch: 8 cost time: 4.994382381439209
Epoch: 8, Steps: 523 | Train Loss: 0.4497079 Vali Loss: 0.3221080 Best vali loss: 0.3220202

best validation loss 0.3220202064660456

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4664633
	speed: 0.0144s/iter; left time: 118.8855s
	iters: 200, epoch: 1 | loss: 0.2426043
	speed: 0.0081s/iter; left time: 65.7899s
	iters: 300, epoch: 1 | loss: 0.6604134
	speed: 0.0069s/iter; left time: 55.6188s
	iters: 400, epoch: 1 | loss: 0.6121641
	speed: 0.0073s/iter; left time: 58.2322s
	iters: 500, epoch: 1 | loss: 1.3486450
	speed: 0.0074s/iter; left time: 57.9987s
	iters: 600, epoch: 1 | loss: 0.8431113
	speed: 0.0084s/iter; left time: 64.9177s
	iters: 700, epoch: 1 | loss: 0.2815822
	speed: 0.0075s/iter; left time: 57.5968s
	iters: 800, epoch: 1 | loss: 1.3786613
	speed: 0.0078s/iter; left time: 58.9589s
	iters: 900, epoch: 1 | loss: 0.4565828
	speed: 0.0069s/iter; left time: 51.6519s
	iters: 1000, epoch: 1 | loss: 0.1811631
	speed: 0.0081s/iter; left time: 59.3372s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 8.27803921699524
Epoch: 1, Steps: 1045 | Train Loss: 0.6471391 Vali Loss: 0.2831465 Best vali loss: 0.2831465
	iters: 100, epoch: 2 | loss: 1.8640687
	speed: 0.0256s/iter; left time: 184.5513s
	iters: 200, epoch: 2 | loss: 0.6140142
	speed: 0.0077s/iter; left time: 54.9692s
	iters: 300, epoch: 2 | loss: 0.8220453
	speed: 0.0080s/iter; left time: 56.0061s
	iters: 400, epoch: 2 | loss: 0.3580770
	speed: 0.0066s/iter; left time: 45.3744s
	iters: 500, epoch: 2 | loss: 0.3038453
	speed: 0.0075s/iter; left time: 51.4539s
	iters: 600, epoch: 2 | loss: 0.4199553
	speed: 0.0087s/iter; left time: 58.5590s
	iters: 700, epoch: 2 | loss: 0.3379287
	speed: 0.0094s/iter; left time: 62.3289s
	iters: 800, epoch: 2 | loss: 0.2591052
	speed: 0.0089s/iter; left time: 58.1038s
	iters: 900, epoch: 2 | loss: 0.1652180
	speed: 0.0087s/iter; left time: 56.1129s
	iters: 1000, epoch: 2 | loss: 0.2534777
	speed: 0.0076s/iter; left time: 48.1453s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.2831 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 8.458007574081421
Epoch: 2, Steps: 1045 | Train Loss: 0.5397735 Vali Loss: 0.2824894 Best vali loss: 0.2824894
	iters: 100, epoch: 3 | loss: 0.6647894
	speed: 0.0250s/iter; left time: 153.9699s
	iters: 200, epoch: 3 | loss: 0.1642315
	speed: 0.0073s/iter; left time: 44.5291s
	iters: 300, epoch: 3 | loss: 0.3504107
	speed: 0.0066s/iter; left time: 39.4050s
	iters: 400, epoch: 3 | loss: 0.3751440
	speed: 0.0081s/iter; left time: 47.6139s
	iters: 500, epoch: 3 | loss: 0.3684172
	speed: 0.0075s/iter; left time: 43.0357s
	iters: 600, epoch: 3 | loss: 0.3429871
	speed: 0.0084s/iter; left time: 47.6946s
	iters: 700, epoch: 3 | loss: 0.7917328
	speed: 0.0107s/iter; left time: 59.4598s
	iters: 800, epoch: 3 | loss: 0.3325447
	speed: 0.0089s/iter; left time: 48.7574s
	iters: 900, epoch: 3 | loss: 0.3721165
	speed: 0.0076s/iter; left time: 40.5520s
	iters: 1000, epoch: 3 | loss: 0.8085796
	speed: 0.0100s/iter; left time: 52.4834s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 8.726438760757446
Epoch: 3, Steps: 1045 | Train Loss: 0.4570953 Vali Loss: 0.2853185 Best vali loss: 0.2824894
	iters: 100, epoch: 4 | loss: 0.9423918
	speed: 0.0333s/iter; left time: 170.5271s
	iters: 200, epoch: 4 | loss: 0.1978119
	speed: 0.0069s/iter; left time: 34.6136s
	iters: 300, epoch: 4 | loss: 0.4279643
	speed: 0.0073s/iter; left time: 36.1503s
	iters: 400, epoch: 4 | loss: 0.3506528
	speed: 0.0088s/iter; left time: 42.4168s
	iters: 500, epoch: 4 | loss: 0.3406288
	speed: 0.0079s/iter; left time: 37.1503s
	iters: 600, epoch: 4 | loss: 1.4712487
	speed: 0.0086s/iter; left time: 39.7057s
	iters: 700, epoch: 4 | loss: 0.4237588
	speed: 0.0088s/iter; left time: 39.8545s
	iters: 800, epoch: 4 | loss: 0.2194910
	speed: 0.0067s/iter; left time: 29.7782s
	iters: 900, epoch: 4 | loss: 0.4022708
	speed: 0.0052s/iter; left time: 22.2970s
	iters: 1000, epoch: 4 | loss: 0.2600236
	speed: 0.0053s/iter; left time: 22.5826s
Updating learning rate to 0.0001477158077
Epoch: 4 cost time: 7.8123579025268555
Epoch: 4, Steps: 1045 | Train Loss: 0.5036243 Vali Loss: 0.2934688 Best vali loss: 0.2824894
	iters: 100, epoch: 5 | loss: 0.3847499
	speed: 0.0216s/iter; left time: 88.1830s
	iters: 200, epoch: 5 | loss: 1.1839286
	speed: 0.0076s/iter; left time: 30.2933s
	iters: 300, epoch: 5 | loss: 0.9266227
	speed: 0.0087s/iter; left time: 33.6815s
	iters: 400, epoch: 5 | loss: 0.4310620
	speed: 0.0074s/iter; left time: 28.0773s
	iters: 500, epoch: 5 | loss: 0.8037712
	speed: 0.0085s/iter; left time: 31.4430s
	iters: 600, epoch: 5 | loss: 0.2565432
	speed: 0.0072s/iter; left time: 25.8623s
	iters: 700, epoch: 5 | loss: 0.2082201
	speed: 0.0084s/iter; left time: 29.0706s
	iters: 800, epoch: 5 | loss: 0.4316439
	speed: 0.0074s/iter; left time: 24.9408s
	iters: 900, epoch: 5 | loss: 0.2819274
	speed: 0.0056s/iter; left time: 18.4683s
	iters: 1000, epoch: 5 | loss: 0.8534308
	speed: 0.0085s/iter; left time: 26.9631s
Updating learning rate to 9.118741539478246e-05
Epoch: 5 cost time: 8.051833391189575
Epoch: 5, Steps: 1045 | Train Loss: 0.5761900 Vali Loss: 0.2897611 Best vali loss: 0.2824894
	iters: 100, epoch: 6 | loss: 0.3717593
	speed: 0.0229s/iter; left time: 69.5329s
	iters: 200, epoch: 6 | loss: 0.5429903
	speed: 0.0076s/iter; left time: 22.2226s
	iters: 300, epoch: 6 | loss: 0.1914344
	speed: 0.0060s/iter; left time: 16.9966s
	iters: 400, epoch: 6 | loss: 0.2252614
	speed: 0.0063s/iter; left time: 17.3053s
	iters: 500, epoch: 6 | loss: 0.3573795
	speed: 0.0084s/iter; left time: 22.2178s
	iters: 600, epoch: 6 | loss: 0.5703365
	speed: 0.0070s/iter; left time: 17.6746s
	iters: 700, epoch: 6 | loss: 0.2277659
	speed: 0.0104s/iter; left time: 25.2738s
	iters: 800, epoch: 6 | loss: 0.3570552
	speed: 0.0080s/iter; left time: 18.7605s
	iters: 900, epoch: 6 | loss: 0.2831450
	speed: 0.0072s/iter; left time: 16.2107s
	iters: 1000, epoch: 6 | loss: 0.9351826
	speed: 0.0058s/iter; left time: 12.3308s
Updating learning rate to 4.326495838688198e-05
Epoch: 6 cost time: 7.729689121246338
Epoch: 6, Steps: 1045 | Train Loss: 0.4062310 Vali Loss: 0.2906794 Best vali loss: 0.2824894
	iters: 100, epoch: 7 | loss: 0.2842446
	speed: 0.0226s/iter; left time: 45.0390s
	iters: 200, epoch: 7 | loss: 0.2442503
	speed: 0.0063s/iter; left time: 11.9913s
	iters: 300, epoch: 7 | loss: 0.2929033
	speed: 0.0081s/iter; left time: 14.4571s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022460234567, 'e_layers': 3, 'learning_rate': 0.0002238773545, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5415517
	speed: 0.0146s/iter; left time: 120.4662s
	iters: 200, epoch: 1 | loss: 0.3642933
	speed: 0.0083s/iter; left time: 67.4135s
	iters: 300, epoch: 1 | loss: 0.3114869
	speed: 0.0071s/iter; left time: 57.4244s
	iters: 400, epoch: 1 | loss: 0.7067794
	speed: 0.0059s/iter; left time: 47.1448s
	iters: 500, epoch: 1 | loss: 0.2086923
	speed: 0.0069s/iter; left time: 54.2407s
	iters: 600, epoch: 1 | loss: 0.5399655
	speed: 0.0087s/iter; left time: 67.7536s
	iters: 700, epoch: 1 | loss: 0.3132080
	speed: 0.0081s/iter; left time: 61.6836s
	iters: 800, epoch: 1 | loss: 0.5200437
	speed: 0.0079s/iter; left time: 59.8775s
	iters: 900, epoch: 1 | loss: 1.2429274
	speed: 0.0075s/iter; left time: 55.6167s
	iters: 1000, epoch: 1 | loss: 0.8518451
	speed: 0.0087s/iter; left time: 63.8322s
Updating learning rate to 0.0002238773545
Validation loss decreased (inf --> 0.2945).  Saving model state dict ...
Epoch: 1 cost time: 8.42340636253357
Epoch: 1, Steps: 1045 | Train Loss: 0.5600793 Vali Loss: 0.2945299 Best vali loss: 0.2945299
	iters: 100, epoch: 2 | loss: 0.5766421
	speed: 0.0223s/iter; left time: 161.0014s
	iters: 200, epoch: 2 | loss: 0.1809384
	speed: 0.0057s/iter; left time: 40.7351s
	iters: 300, epoch: 2 | loss: 0.2707578
	speed: 0.0073s/iter; left time: 50.9889s
	iters: 400, epoch: 2 | loss: 0.4931445
	speed: 0.0092s/iter; left time: 63.8700s
	iters: 500, epoch: 2 | loss: 0.2204441
	speed: 0.0092s/iter; left time: 62.7834s
	iters: 600, epoch: 2 | loss: 0.5234241
	speed: 0.0072s/iter; left time: 48.4677s
	iters: 700, epoch: 2 | loss: 0.6692897
	speed: 0.0080s/iter; left time: 52.7817s
	iters: 800, epoch: 2 | loss: 0.4392148
	speed: 0.0097s/iter; left time: 63.3371s
	iters: 900, epoch: 2 | loss: 0.3726614
	speed: 0.0083s/iter; left time: 53.3369s
	iters: 1000, epoch: 2 | loss: 0.3935272
	speed: 0.0068s/iter; left time: 42.9720s
Updating learning rate to 0.00011193867725
Validation loss decreased (0.2945 --> 0.2846).  Saving model state dict ...
Epoch: 2 cost time: 8.111559867858887
Epoch: 2, Steps: 1045 | Train Loss: 0.4140044 Vali Loss: 0.2846257 Best vali loss: 0.2846257
	iters: 100, epoch: 3 | loss: 0.3089897
	speed: 0.0240s/iter; left time: 147.9322s
	iters: 200, epoch: 3 | loss: 0.3325503
	speed: 0.0076s/iter; left time: 45.9901s
	iters: 300, epoch: 3 | loss: 0.2358229
	speed: 0.0074s/iter; left time: 43.9330s
	iters: 400, epoch: 3 | loss: 0.3469478
	speed: 0.0060s/iter; left time: 35.3130s
	iters: 500, epoch: 3 | loss: 0.3144854
	speed: 0.0063s/iter; left time: 36.5867s
	iters: 600, epoch: 3 | loss: 0.2690304
	speed: 0.0073s/iter; left time: 41.1337s
	iters: 700, epoch: 3 | loss: 0.1899308
	speed: 0.0087s/iter; left time: 48.6661s
	iters: 800, epoch: 3 | loss: 0.8039011
	speed: 0.0079s/iter; left time: 43.2189s
	iters: 900, epoch: 3 | loss: 1.0187844
	speed: 0.0084s/iter; left time: 44.9091s
	iters: 1000, epoch: 3 | loss: 0.1884385
	speed: 0.0085s/iter; left time: 44.9932s
Updating learning rate to 5.5969338625e-05
Epoch: 3 cost time: 7.988279342651367
Epoch: 3, Steps: 1045 | Train Loss: 0.4008881 Vali Loss: 0.2897945 Best vali loss: 0.2846257

best validation loss 0.28462565864282896

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0053842784557, 'e_layers': 2, 'learning_rate': 0.0021053293838, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0020252000553437097
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 1.6908650398254395
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2876061 Best vali loss: 0.2876061
Updating learning rate to 0.0017970110338581377
Validation loss decreased (0.2876 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 2.749220371246338
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2808660 Best vali loss: 0.2808660
Updating learning rate to 0.0014555020293258317
Epoch: 3 cost time: 1.031569242477417
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2851324 Best vali loss: 0.2808660

best validation loss 0.2808659980347184

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 4, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7084095
	speed: 0.0161s/iter; left time: 65.9228s
	iters: 200, epoch: 1 | loss: 0.4946637
	speed: 0.0105s/iter; left time: 41.7501s
	iters: 300, epoch: 1 | loss: 0.5790353
	speed: 0.0130s/iter; left time: 50.4003s
	iters: 400, epoch: 1 | loss: 0.3053612
	speed: 0.0134s/iter; left time: 50.8349s
	iters: 500, epoch: 1 | loss: 0.4015211
	speed: 0.0117s/iter; left time: 43.0646s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.2766).  Saving model state dict ...
Epoch: 1 cost time: 6.504660367965698
Epoch: 1, Steps: 523 | Train Loss: 0.4977982 Vali Loss: 0.2765698 Best vali loss: 0.2765698
	iters: 100, epoch: 2 | loss: 0.3978709
	speed: 0.0224s/iter; left time: 79.7745s
	iters: 200, epoch: 2 | loss: 0.3610750
	speed: 0.0089s/iter; left time: 30.7926s
	iters: 300, epoch: 2 | loss: 0.3066901
	speed: 0.0092s/iter; left time: 30.8649s
	iters: 400, epoch: 2 | loss: 0.8175888
	speed: 0.0093s/iter; left time: 30.4067s
	iters: 500, epoch: 2 | loss: 0.2858476
	speed: 0.0147s/iter; left time: 46.3989s
Updating learning rate to 4.937857552178923e-05
Epoch: 2 cost time: 5.451241970062256
Epoch: 2, Steps: 523 | Train Loss: 0.4338145 Vali Loss: 0.2784175 Best vali loss: 0.2765698
	iters: 100, epoch: 3 | loss: 0.4673111
	speed: 0.0231s/iter; left time: 70.0554s
	iters: 200, epoch: 3 | loss: 0.2410238
	speed: 0.0123s/iter; left time: 36.0784s
	iters: 300, epoch: 3 | loss: 0.4282428
	speed: 0.0124s/iter; left time: 35.2416s
	iters: 400, epoch: 3 | loss: 0.2216324
	speed: 0.0097s/iter; left time: 26.4843s
	iters: 500, epoch: 3 | loss: 0.2899089
	speed: 0.0118s/iter; left time: 31.0618s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.2766 --> 0.2764).  Saving model state dict ...
Epoch: 3 cost time: 6.174864292144775
Epoch: 3, Steps: 523 | Train Loss: 0.3296238 Vali Loss: 0.2764118 Best vali loss: 0.2764118

best validation loss 0.27641178673641

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 4, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4704272
	speed: 0.0204s/iter; left time: 51.4458s
	iters: 200, epoch: 4 | loss: 0.3740396
	speed: 0.0114s/iter; left time: 27.6090s
	iters: 300, epoch: 4 | loss: 0.4559548
	speed: 0.0112s/iter; left time: 25.9574s
	iters: 400, epoch: 4 | loss: 0.2866904
	speed: 0.0118s/iter; left time: 26.2306s
	iters: 500, epoch: 4 | loss: 0.3820088
	speed: 0.0122s/iter; left time: 25.8162s
Updating learning rate to 2.892529985e-05
Epoch: 4 cost time: 6.534227609634399
Epoch: 4, Steps: 523 | Train Loss: 0.3938242 Vali Loss: 0.2906377 Best vali loss: 0.2764118
	iters: 100, epoch: 5 | loss: 0.3313393
	speed: 0.0229s/iter; left time: 45.6065s
	iters: 200, epoch: 5 | loss: 0.2896271
	speed: 0.0118s/iter; left time: 22.4000s
	iters: 300, epoch: 5 | loss: 0.2655769
	speed: 0.0103s/iter; left time: 18.5428s
	iters: 400, epoch: 5 | loss: 0.6151200
	speed: 0.0114s/iter; left time: 19.2958s
	iters: 500, epoch: 5 | loss: 0.2650425
	speed: 0.0119s/iter; left time: 19.0037s
Updating learning rate to 1.7856066821212585e-05
Epoch: 5 cost time: 6.103412628173828
Epoch: 5, Steps: 523 | Train Loss: 0.3533412 Vali Loss: 0.2901596 Best vali loss: 0.2764118
	iters: 100, epoch: 6 | loss: 0.3761909
	speed: 0.0244s/iter; left time: 35.8580s
	iters: 200, epoch: 6 | loss: 0.2034417
	speed: 0.0116s/iter; left time: 15.9057s
	iters: 300, epoch: 6 | loss: 0.3950489
	speed: 0.0108s/iter; left time: 13.7406s
	iters: 400, epoch: 6 | loss: 0.2282098
	speed: 0.0108s/iter; left time: 12.6333s
	iters: 500, epoch: 6 | loss: 0.2569576
	speed: 0.0120s/iter; left time: 12.8076s
Updating learning rate to 8.472024178210777e-06
Epoch: 6 cost time: 6.115686416625977
Epoch: 6, Steps: 523 | Train Loss: 0.2919698 Vali Loss: 0.2889369 Best vali loss: 0.2764118
	iters: 100, epoch: 7 | loss: 0.3754094
	speed: 0.0216s/iter; left time: 20.4748s
	iters: 200, epoch: 7 | loss: 0.3142646
	speed: 0.0103s/iter; left time: 8.7561s
	iters: 300, epoch: 7 | loss: 0.4334018
	speed: 0.0107s/iter; left time: 8.0220s
	iters: 400, epoch: 7 | loss: 0.3888838
	speed: 0.0106s/iter; left time: 6.8502s
	iters: 500, epoch: 7 | loss: 0.4107868
	speed: 0.0108s/iter; left time: 5.9023s
Updating learning rate to 2.2018073468332077e-06
Epoch: 7 cost time: 5.470640182495117
Epoch: 7, Steps: 523 | Train Loss: 0.3845493 Vali Loss: 0.2977896 Best vali loss: 0.2764118
	iters: 100, epoch: 8 | loss: 0.2933356
	speed: 0.0234s/iter; left time: 9.9257s
	iters: 200, epoch: 8 | loss: 0.3341407
	speed: 0.0115s/iter; left time: 3.7231s
	iters: 300, epoch: 8 | loss: 0.4526656
	speed: 0.0108s/iter; left time: 2.4199s
	iters: 400, epoch: 8 | loss: 0.2528558
	speed: 0.0112s/iter; left time: 1.3898s
	iters: 500, epoch: 8 | loss: 0.3852714
	speed: 0.0105s/iter; left time: 0.2525s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.856386423110962
Epoch: 8, Steps: 523 | Train Loss: 0.3436538 Vali Loss: 0.2957828 Best vali loss: 0.2764118

best validation loss 0.27641178673641

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0039198070782, 'e_layers': 3, 'learning_rate': 9.36341394e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7769576
	speed: 0.0189s/iter; left time: 17.8915s
Updating learning rate to 9.007040216798432e-05
Validation loss decreased (inf --> 0.3344).  Saving model state dict ...
Epoch: 1 cost time: 1.907468318939209
Epoch: 1, Steps: 131 | Train Loss: 0.7769576 Vali Loss: 0.3343676 Best vali loss: 0.3343676
	iters: 100, epoch: 2 | loss: 0.5617485
	speed: 0.0151s/iter; left time: 12.3788s
Updating learning rate to 7.992173716015324e-05
Validation loss decreased (0.3344 --> 0.3169).  Saving model state dict ...
Epoch: 2 cost time: 0.9643971920013428
Epoch: 2, Steps: 131 | Train Loss: 0.5617485 Vali Loss: 0.3168909 Best vali loss: 0.3168909
	iters: 100, epoch: 3 | loss: 0.4026428
	speed: 0.0132s/iter; left time: 9.0442s
Updating learning rate to 6.473318662607164e-05
Validation loss decreased (0.3169 --> 0.3077).  Saving model state dict ...
Epoch: 3 cost time: 1.107224941253662
Epoch: 3, Steps: 131 | Train Loss: 0.4026428 Vali Loss: 0.3076711 Best vali loss: 0.3076711
	iters: 100, epoch: 4 | loss: 0.4556215
	speed: 0.0136s/iter; left time: 7.5641s
Updating learning rate to 4.68170697e-05
Validation loss decreased (0.3077 --> 0.3025).  Saving model state dict ...
Epoch: 4 cost time: 1.119699239730835
Epoch: 4, Steps: 131 | Train Loss: 0.4556215 Vali Loss: 0.3024786 Best vali loss: 0.3024786
	iters: 100, epoch: 5 | loss: 0.5959539
	speed: 0.0137s/iter; left time: 5.8204s
Updating learning rate to 2.8900952773928358e-05
Validation loss decreased (0.3025 --> 0.2992).  Saving model state dict ...
Epoch: 5 cost time: 1.1173081398010254
Epoch: 5, Steps: 131 | Train Loss: 0.5959539 Vali Loss: 0.2991974 Best vali loss: 0.2991974
	iters: 100, epoch: 6 | loss: 0.6140838
	speed: 0.0137s/iter; left time: 4.0288s
Updating learning rate to 1.3712402239846759e-05
Validation loss decreased (0.2992 --> 0.2978).  Saving model state dict ...
Epoch: 6 cost time: 1.1087138652801514
Epoch: 6, Steps: 131 | Train Loss: 0.6140838 Vali Loss: 0.2978369 Best vali loss: 0.2978369
	iters: 100, epoch: 7 | loss: 0.5709082
	speed: 0.0138s/iter; left time: 2.2476s
Updating learning rate to 3.5637372320156725e-06
Validation loss decreased (0.2978 --> 0.2972).  Saving model state dict ...
Epoch: 7 cost time: 1.127504587173462
Epoch: 7, Steps: 131 | Train Loss: 0.5709082 Vali Loss: 0.2972284 Best vali loss: 0.2972284
	iters: 100, epoch: 8 | loss: 0.3080429
	speed: 0.0138s/iter; left time: 0.4419s
Updating learning rate to 0.0
Validation loss decreased (0.2972 --> 0.2971).  Saving model state dict ...
Epoch: 8 cost time: 1.3797376155853271
Epoch: 8, Steps: 131 | Train Loss: 0.3080429 Vali Loss: 0.2971043 Best vali loss: 0.2971043

best validation loss 0.29710429615915024

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.007940080013, 'e_layers': 4, 'learning_rate': 0.0005392900295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4462961
	speed: 0.0149s/iter; left time: 29.6869s
	iters: 200, epoch: 1 | loss: 0.3301474
	speed: 0.0087s/iter; left time: 16.5858s
Updating learning rate to 0.000518764524921229
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 2.6143436431884766
Epoch: 1, Steps: 262 | Train Loss: 0.3882217 Vali Loss: 0.2866729 Best vali loss: 0.2866729
	iters: 100, epoch: 2 | loss: 0.9202887
	speed: 0.0187s/iter; left time: 32.4963s
	iters: 200, epoch: 2 | loss: 0.3126097
	speed: 0.0080s/iter; left time: 13.1102s
Updating learning rate to 0.0004603128331928716
Epoch: 2 cost time: 2.265886068344116
Epoch: 2, Steps: 262 | Train Loss: 0.6164492 Vali Loss: 0.2870448 Best vali loss: 0.2866729
	iters: 100, epoch: 3 | loss: 0.8534275
	speed: 0.0195s/iter; left time: 28.6735s
	iters: 200, epoch: 3 | loss: 0.3956472
	speed: 0.0090s/iter; left time: 12.3856s
Updating learning rate to 0.0003728336945146653
Epoch: 3 cost time: 2.4741322994232178
Epoch: 3, Steps: 262 | Train Loss: 0.6245374 Vali Loss: 0.2927421 Best vali loss: 0.2866729
	iters: 100, epoch: 4 | loss: 0.2891280
	speed: 0.0232s/iter; left time: 28.1081s
	iters: 200, epoch: 4 | loss: 0.4711838
	speed: 0.0087s/iter; left time: 9.7133s
Updating learning rate to 0.00026964501475
Epoch: 4 cost time: 2.4314985275268555
Epoch: 4, Steps: 262 | Train Loss: 0.3801559 Vali Loss: 0.2907577 Best vali loss: 0.2866729
	iters: 100, epoch: 5 | loss: 0.4628078
	speed: 0.0190s/iter; left time: 18.0306s
	iters: 200, epoch: 5 | loss: 0.3930600
	speed: 0.0090s/iter; left time: 7.6736s
Updating learning rate to 0.00016645633498533474
Epoch: 5 cost time: 2.4343760013580322
Epoch: 5, Steps: 262 | Train Loss: 0.4279339 Vali Loss: 0.2916791 Best vali loss: 0.2866729
	iters: 100, epoch: 6 | loss: 0.4234761
	speed: 0.0196s/iter; left time: 13.4710s
	iters: 200, epoch: 6 | loss: 0.2669298
	speed: 0.0089s/iter; left time: 5.2378s
Updating learning rate to 7.897719630712839e-05
Epoch: 6 cost time: 2.400891065597534
Epoch: 6, Steps: 262 | Train Loss: 0.3452030 Vali Loss: 0.2989517 Best vali loss: 0.2866729
	iters: 100, epoch: 7 | loss: 0.4459693
	speed: 0.0203s/iter; left time: 8.6130s
	iters: 200, epoch: 7 | loss: 0.6416417
	speed: 0.0108s/iter; left time: 3.5053s
Updating learning rate to 2.0525504578770982e-05
Epoch: 7 cost time: 2.6338508129119873
Epoch: 7, Steps: 262 | Train Loss: 0.5438055 Vali Loss: 0.2976469 Best vali loss: 0.2866729
	iters: 100, epoch: 8 | loss: 0.3642613
	speed: 0.0188s/iter; left time: 3.0600s
	iters: 200, epoch: 8 | loss: 0.5407600
	speed: 0.0090s/iter; left time: 0.5661s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.420997381210327
Epoch: 8, Steps: 262 | Train Loss: 0.4525106 Vali Loss: 0.2976318 Best vali loss: 0.2866729

best validation loss 0.2866729056804142

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008999589749, 'e_layers': 3, 'learning_rate': 9.85480766e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2293513
	speed: 0.0144s/iter; left time: 119.2790s
	iters: 200, epoch: 1 | loss: 0.4619632
	speed: 0.0106s/iter; left time: 86.6178s
	iters: 300, epoch: 1 | loss: 0.6964834
	speed: 0.0099s/iter; left time: 79.4374s
	iters: 400, epoch: 1 | loss: 1.2415910
	speed: 0.0071s/iter; left time: 56.2255s
	iters: 500, epoch: 1 | loss: 0.2221450
	speed: 0.0074s/iter; left time: 57.8396s
	iters: 600, epoch: 1 | loss: 0.4291615
	speed: 0.0095s/iter; left time: 73.9434s
	iters: 700, epoch: 1 | loss: 0.4677112
	speed: 0.0097s/iter; left time: 74.5682s
	iters: 800, epoch: 1 | loss: 1.1501842
	speed: 0.0094s/iter; left time: 70.7584s
	iters: 900, epoch: 1 | loss: 0.1311926
	speed: 0.0094s/iter; left time: 70.4462s
	iters: 1000, epoch: 1 | loss: 0.5674299
	speed: 0.0071s/iter; left time: 52.5028s
Updating learning rate to 9.479731376954724e-05
Validation loss decreased (inf --> 0.2747).  Saving model state dict ...
Epoch: 1 cost time: 9.542728185653687
Epoch: 1, Steps: 1045 | Train Loss: 0.5597213 Vali Loss: 0.2747037 Best vali loss: 0.2747037
	iters: 100, epoch: 2 | loss: 0.4450684
	speed: 0.0306s/iter; left time: 220.5748s
	iters: 200, epoch: 2 | loss: 0.5520744
	speed: 0.0096s/iter; left time: 68.3739s
	iters: 300, epoch: 2 | loss: 1.2349559
	speed: 0.0090s/iter; left time: 62.9088s
	iters: 400, epoch: 2 | loss: 0.2242772
	speed: 0.0087s/iter; left time: 59.9557s
	iters: 500, epoch: 2 | loss: 0.6904760
	speed: 0.0093s/iter; left time: 63.1014s
	iters: 600, epoch: 2 | loss: 0.4456442
	speed: 0.0091s/iter; left time: 61.3904s
	iters: 700, epoch: 2 | loss: 0.3685963
	speed: 0.0087s/iter; left time: 57.8584s
	iters: 800, epoch: 2 | loss: 0.3562489
	speed: 0.0089s/iter; left time: 57.7323s
	iters: 900, epoch: 2 | loss: 0.1570952
	speed: 0.0094s/iter; left time: 60.1394s
	iters: 1000, epoch: 2 | loss: 0.2780651
	speed: 0.0091s/iter; left time: 57.6964s
Updating learning rate to 8.411604491837567e-05
Epoch: 2 cost time: 9.507018566131592
Epoch: 2, Steps: 1045 | Train Loss: 0.4752502 Vali Loss: 0.2871434 Best vali loss: 0.2747037
	iters: 100, epoch: 3 | loss: 0.5864921
	speed: 0.0295s/iter; left time: 182.2114s
	iters: 200, epoch: 3 | loss: 0.1726541
	speed: 0.0085s/iter; left time: 51.6437s
	iters: 300, epoch: 3 | loss: 0.2269757
	speed: 0.0093s/iter; left time: 55.5622s
	iters: 400, epoch: 3 | loss: 0.5195670
	speed: 0.0087s/iter; left time: 51.1215s
	iters: 500, epoch: 3 | loss: 0.1589501
	speed: 0.0063s/iter; left time: 36.3100s
	iters: 600, epoch: 3 | loss: 0.1660503
	speed: 0.0082s/iter; left time: 46.5779s
	iters: 700, epoch: 3 | loss: 0.3420941
	speed: 0.0104s/iter; left time: 57.8094s
	iters: 800, epoch: 3 | loss: 0.5467117
	speed: 0.0100s/iter; left time: 54.7384s
	iters: 900, epoch: 3 | loss: 0.6362433
	speed: 0.0109s/iter; left time: 58.3903s
	iters: 1000, epoch: 3 | loss: 0.2399971
	speed: 0.0109s/iter; left time: 57.3843s
Updating learning rate to 6.81303964031329e-05
Epoch: 3 cost time: 9.708603620529175
Epoch: 3, Steps: 1045 | Train Loss: 0.3595735 Vali Loss: 0.2810290 Best vali loss: 0.2747037

best validation loss 0.2747036878694252

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012653404301, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6793520
	speed: 0.0177s/iter; left time: 35.3652s
	iters: 200, epoch: 1 | loss: 0.6091012
	speed: 0.0101s/iter; left time: 19.1275s
Updating learning rate to 0.0005385115939239891
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 3.0758275985717773
Epoch: 1, Steps: 262 | Train Loss: 0.6442266 Vali Loss: 0.2822937 Best vali loss: 0.2822937
	iters: 100, epoch: 2 | loss: 0.2540891
	speed: 0.0209s/iter; left time: 36.3009s
	iters: 200, epoch: 2 | loss: 0.6228877
	speed: 0.0098s/iter; left time: 16.0991s
Updating learning rate to 0.0004778349050448276
Epoch: 2 cost time: 2.644763231277466
Epoch: 2, Steps: 262 | Train Loss: 0.4384884 Vali Loss: 0.2885227 Best vali loss: 0.2822937
	iters: 100, epoch: 3 | loss: 0.2888201
	speed: 0.0215s/iter; left time: 31.6533s
	iters: 200, epoch: 3 | loss: 0.7432525
	speed: 0.0098s/iter; left time: 13.4762s
Updating learning rate to 0.0003870258228088137
Epoch: 3 cost time: 2.670489549636841
Epoch: 3, Steps: 262 | Train Loss: 0.5160363 Vali Loss: 0.2907670 Best vali loss: 0.2822937

best validation loss 0.2822936991470017

[INFO][smbo.py:320] Finished 200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004792616286, 'e_layers': 2, 'learning_rate': 0.0015570047911, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4845809
	speed: 0.0187s/iter; left time: 17.7455s
Updating learning rate to 0.0014977448248096508
Validation loss decreased (inf --> 0.3006).  Saving model state dict ...
Epoch: 1 cost time: 2.0826468467712402
Epoch: 1, Steps: 131 | Train Loss: 0.4845809 Vali Loss: 0.3005859 Best vali loss: 0.3005859
	iters: 100, epoch: 2 | loss: 0.6498735
	speed: 0.0163s/iter; left time: 13.2992s
Updating learning rate to 0.0013289867186133768
Validation loss decreased (0.3006 --> 0.2878).  Saving model state dict ...
Epoch: 2 cost time: 1.04567289352417
Epoch: 2, Steps: 131 | Train Loss: 0.6498735 Vali Loss: 0.2878189 Best vali loss: 0.2878189
	iters: 100, epoch: 3 | loss: 0.8074731
	speed: 0.0134s/iter; left time: 9.1800s
Updating learning rate to 0.0010764223643835189
Epoch: 3 cost time: 1.0686626434326172
Epoch: 3, Steps: 131 | Train Loss: 0.8074731 Vali Loss: 0.2974186 Best vali loss: 0.2878189

best validation loss 0.2878188798117478

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008999589749, 'e_layers': 3, 'learning_rate': 9.85480766e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2036591
	speed: 0.0193s/iter; left time: 99.0776s
	iters: 200, epoch: 4 | loss: 0.4360229
	speed: 0.0110s/iter; left time: 55.5214s
	iters: 300, epoch: 4 | loss: 0.5874910
	speed: 0.0106s/iter; left time: 52.2950s
	iters: 400, epoch: 4 | loss: 0.7548021
	speed: 0.0103s/iter; left time: 49.6304s
	iters: 500, epoch: 4 | loss: 0.2103460
	speed: 0.0103s/iter; left time: 48.5352s
	iters: 600, epoch: 4 | loss: 0.3461808
	speed: 0.0087s/iter; left time: 40.4677s
	iters: 700, epoch: 4 | loss: 0.4041660
	speed: 0.0065s/iter; left time: 29.4668s
	iters: 800, epoch: 4 | loss: 0.7066662
	speed: 0.0074s/iter; left time: 32.6913s
	iters: 900, epoch: 4 | loss: 0.1348800
	speed: 0.0086s/iter; left time: 37.1429s
	iters: 1000, epoch: 4 | loss: 0.4676440
	speed: 0.0081s/iter; left time: 34.0976s
Updating learning rate to 4.92740383e-05
Epoch: 4 cost time: 9.991665601730347
Epoch: 4, Steps: 1045 | Train Loss: 0.4251858 Vali Loss: 0.2809427 Best vali loss: 0.2747037
	iters: 100, epoch: 5 | loss: 0.3936037
	speed: 0.0280s/iter; left time: 114.0947s
	iters: 200, epoch: 5 | loss: 0.4209675
	speed: 0.0106s/iter; left time: 42.2755s
	iters: 300, epoch: 5 | loss: 0.8251854
	speed: 0.0127s/iter; left time: 49.3088s
	iters: 400, epoch: 5 | loss: 0.2181636
	speed: 0.0148s/iter; left time: 56.0166s
	iters: 500, epoch: 5 | loss: 0.4069226
	speed: 0.0141s/iter; left time: 52.0396s
	iters: 600, epoch: 5 | loss: 0.2418952
	speed: 0.0116s/iter; left time: 41.4385s
	iters: 700, epoch: 5 | loss: 0.2901525
	speed: 0.0143s/iter; left time: 49.7956s
	iters: 800, epoch: 5 | loss: 0.2913251
	speed: 0.0130s/iter; left time: 44.0566s
	iters: 900, epoch: 5 | loss: 0.1680618
	speed: 0.0121s/iter; left time: 39.6373s
	iters: 1000, epoch: 5 | loss: 0.2390956
	speed: 0.0149s/iter; left time: 47.4162s
Updating learning rate to 3.041768019686711e-05
Epoch: 5 cost time: 13.711636304855347
Epoch: 5, Steps: 1045 | Train Loss: 0.3495373 Vali Loss: 0.3032213 Best vali loss: 0.2747037
	iters: 100, epoch: 6 | loss: 0.4137879
	speed: 0.0467s/iter; left time: 141.6996s
	iters: 200, epoch: 6 | loss: 0.1531757
	speed: 0.0128s/iter; left time: 37.5906s
	iters: 300, epoch: 6 | loss: 0.1635175
	speed: 0.0134s/iter; left time: 38.0693s
	iters: 400, epoch: 6 | loss: 0.3884583
	speed: 0.0150s/iter; left time: 40.9744s
	iters: 500, epoch: 6 | loss: 0.1446105
	speed: 0.0145s/iter; left time: 38.2971s
	iters: 600, epoch: 6 | loss: 0.1335472
	speed: 0.0117s/iter; left time: 29.5810s
	iters: 700, epoch: 6 | loss: 0.3106583
	speed: 0.0102s/iter; left time: 24.8341s
	iters: 800, epoch: 6 | loss: 0.4574736
	speed: 0.0109s/iter; left time: 25.4517s
	iters: 900, epoch: 6 | loss: 0.4378899
	speed: 0.0088s/iter; left time: 19.6031s
	iters: 1000, epoch: 6 | loss: 0.2229602
	speed: 0.0079s/iter; left time: 16.9742s
Updating learning rate to 1.4432031681624341e-05
Epoch: 6 cost time: 12.503204822540283
Epoch: 6, Steps: 1045 | Train Loss: 0.2826079 Vali Loss: 0.3184079 Best vali loss: 0.2747037
	iters: 100, epoch: 7 | loss: 0.2729267
	speed: 0.0346s/iter; left time: 68.8728s
	iters: 200, epoch: 7 | loss: 0.1461862
	speed: 0.0100s/iter; left time: 18.8666s
	iters: 300, epoch: 7 | loss: 0.2256520
	speed: 0.0104s/iter; left time: 18.6497s
	iters: 400, epoch: 7 | loss: 0.1432383
	speed: 0.0097s/iter; left time: 16.4688s
	iters: 500, epoch: 7 | loss: 0.7070280
	speed: 0.0092s/iter; left time: 14.6799s
	iters: 600, epoch: 7 | loss: 0.2130667
	speed: 0.0104s/iter; left time: 15.4686s
	iters: 700, epoch: 7 | loss: 0.4019087
	speed: 0.0099s/iter; left time: 13.7440s
	iters: 800, epoch: 7 | loss: 0.3174301
	speed: 0.0094s/iter; left time: 12.1076s
	iters: 900, epoch: 7 | loss: 0.5740291
	speed: 0.0087s/iter; left time: 10.3484s
	iters: 1000, epoch: 7 | loss: 0.1220581
	speed: 0.0093s/iter; left time: 10.0925s
Updating learning rate to 3.750762830452762e-06
Epoch: 7 cost time: 10.319831371307373
Epoch: 7, Steps: 1045 | Train Loss: 0.3123524 Vali Loss: 0.3264383 Best vali loss: 0.2747037
	iters: 100, epoch: 8 | loss: 0.2698083
	speed: 0.0368s/iter; left time: 34.8442s
	iters: 200, epoch: 8 | loss: 0.2300765
	speed: 0.0090s/iter; left time: 7.5894s
	iters: 300, epoch: 8 | loss: 0.3914431
	speed: 0.0092s/iter; left time: 6.8409s
	iters: 400, epoch: 8 | loss: 0.3101458
	speed: 0.0102s/iter; left time: 6.5879s
	iters: 500, epoch: 8 | loss: 0.1802679
	speed: 0.0107s/iter; left time: 5.8665s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094422831379, 'e_layers': 4, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 0.9755380153656006
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2842836 Best vali loss: 0.2842836
Updating learning rate to 0.0009137180420535848
Validation loss decreased (0.2843 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 0.7531430721282959
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2835057 Best vali loss: 0.2835057
Updating learning rate to 0.0007400725089513316
Epoch: 3 cost time: 0.771162748336792
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2869979 Best vali loss: 0.2835057
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 0.7781777381896973
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2902600 Best vali loss: 0.2835057
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 0.7740809917449951
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2840039 Best vali loss: 0.2835057
Updating learning rate to 0.00015676923164641517
Epoch: 6 cost time: 1.2717325687408447
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2950086 Best vali loss: 0.2835057
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 0.6577675342559814
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2917739 Best vali loss: 0.2835057
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7177293300628662
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2923610 Best vali loss: 0.2835057

best validation loss 0.28350568473250415

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009319745802, 'e_layers': 4, 'learning_rate': 0.0004945924346, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6022323
	speed: 0.0162s/iter; left time: 15.4052s
Updating learning rate to 0.0004945924346
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 1.6382668018341064
Epoch: 1, Steps: 131 | Train Loss: 0.6022323 Vali Loss: 0.2833085 Best vali loss: 0.2833085
	iters: 100, epoch: 2 | loss: 0.3204991
	speed: 0.0149s/iter; left time: 12.2234s
Updating learning rate to 0.0002472962173
Epoch: 2 cost time: 1.2277545928955078
Epoch: 2, Steps: 131 | Train Loss: 0.3204991 Vali Loss: 0.2844125 Best vali loss: 0.2833085
	iters: 100, epoch: 3 | loss: 0.2932191
	speed: 0.0159s/iter; left time: 10.9101s
Updating learning rate to 0.00012364810865
Epoch: 3 cost time: 1.3523950576782227
Epoch: 3, Steps: 131 | Train Loss: 0.2932191 Vali Loss: 0.2861497 Best vali loss: 0.2833085
	iters: 100, epoch: 4 | loss: 0.5223132
	speed: 0.0163s/iter; left time: 9.0656s
Updating learning rate to 6.1824054325e-05
Epoch: 4 cost time: 1.3576149940490723
Epoch: 4, Steps: 131 | Train Loss: 0.5223132 Vali Loss: 0.2844490 Best vali loss: 0.2833085
	iters: 100, epoch: 5 | loss: 0.6535899
	speed: 0.0209s/iter; left time: 8.8682s
Updating learning rate to 3.09120271625e-05
Epoch: 5 cost time: 1.8536376953125
Epoch: 5, Steps: 131 | Train Loss: 0.6535899 Vali Loss: 0.2838984 Best vali loss: 0.2833085
	iters: 100, epoch: 6 | loss: 0.3743334
	speed: 0.0156s/iter; left time: 4.5999s
Updating learning rate to 1.545601358125e-05
Epoch: 6 cost time: 1.279484510421753
Epoch: 6, Steps: 131 | Train Loss: 0.3743334 Vali Loss: 0.2845568 Best vali loss: 0.2833085
	iters: 100, epoch: 7 | loss: 0.4282238
	speed: 0.0157s/iter; left time: 2.5526s
Updating learning rate to 7.728006790625e-06
Epoch: 7 cost time: 1.332869529724121
Epoch: 7, Steps: 131 | Train Loss: 0.4282238 Vali Loss: 0.2850492 Best vali loss: 0.2833085
	iters: 100, epoch: 8 | loss: 0.4872541
	speed: 0.0156s/iter; left time: 0.4994s
Updating learning rate to 3.8640033953125e-06
Epoch: 8 cost time: 1.295546054840088
Epoch: 8, Steps: 131 | Train Loss: 0.4872541 Vali Loss: 0.2849653 Best vali loss: 0.2833085

best validation loss 0.2833085005812682

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4813119
	speed: 0.0140s/iter; left time: 13.2846s
Updating learning rate to 9.547589994094374e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 1.3600053787231445
Epoch: 1, Steps: 131 | Train Loss: 0.4813119 Vali Loss: 0.2798014 Best vali loss: 0.2798014
	iters: 100, epoch: 2 | loss: 0.6199791
	speed: 0.0127s/iter; left time: 10.4262s
Updating learning rate to 8.47181715251795e-05
Validation loss decreased (0.2798 --> 0.2753).  Saving model state dict ...
Epoch: 2 cost time: 1.0165865421295166
Epoch: 2, Steps: 131 | Train Loss: 0.6199791 Vali Loss: 0.2753378 Best vali loss: 0.2753378
	iters: 100, epoch: 3 | loss: 0.6801647
	speed: 0.0128s/iter; left time: 8.8138s
Updating learning rate to 6.861809318495647e-05
Epoch: 3 cost time: 1.1803491115570068
Epoch: 3, Steps: 131 | Train Loss: 0.6801647 Vali Loss: 0.2760139 Best vali loss: 0.2753378

best validation loss 0.27533778014591787

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0004262443426, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2820853
	speed: 0.0098s/iter; left time: 9.2865s
Updating learning rate to 0.0004262443426
Validation loss decreased (inf --> 0.3009).  Saving model state dict ...
Epoch: 1 cost time: 0.7801826000213623
Epoch: 1, Steps: 131 | Train Loss: 0.2820853 Vali Loss: 0.3008655 Best vali loss: 0.3008655
	iters: 100, epoch: 2 | loss: 0.5516838
	speed: 0.0115s/iter; left time: 9.4295s
Updating learning rate to 0.0002131221713
Validation loss decreased (0.3009 --> 0.2863).  Saving model state dict ...
Epoch: 2 cost time: 1.0033094882965088
Epoch: 2, Steps: 131 | Train Loss: 0.5516838 Vali Loss: 0.2862949 Best vali loss: 0.2862949
	iters: 100, epoch: 3 | loss: 0.4779041
	speed: 0.0127s/iter; left time: 8.7381s
Updating learning rate to 0.00010656108565
Validation loss decreased (0.2863 --> 0.2831).  Saving model state dict ...
Epoch: 3 cost time: 0.8920762538909912
Epoch: 3, Steps: 131 | Train Loss: 0.4779041 Vali Loss: 0.2831003 Best vali loss: 0.2831003

best validation loss 0.2831003371114933

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0111145234284, 'e_layers': 2, 'learning_rate': 0.0023180376832, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7654639
	speed: 0.0155s/iter; left time: 14.6931s
Updating learning rate to 0.0023180376832
Validation loss decreased (inf --> 0.2900).  Saving model state dict ...
Epoch: 1 cost time: 1.4792230129241943
Epoch: 1, Steps: 131 | Train Loss: 0.7654639 Vali Loss: 0.2899728 Best vali loss: 0.2899728
	iters: 100, epoch: 2 | loss: 0.4587803
	speed: 0.0232s/iter; left time: 18.9975s
Updating learning rate to 0.0011590188416
Epoch: 2 cost time: 2.1574594974517822
Epoch: 2, Steps: 131 | Train Loss: 0.4587803 Vali Loss: 0.3019663 Best vali loss: 0.2899728
	iters: 100, epoch: 3 | loss: 0.6942660
	speed: 0.0301s/iter; left time: 20.6952s
Updating learning rate to 0.0005795094208
Epoch: 3 cost time: 2.2569339275360107
Epoch: 3, Steps: 131 | Train Loss: 0.6942660 Vali Loss: 0.2985995 Best vali loss: 0.2899728

best validation loss 0.2899728464832001

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4074628
	speed: 0.0234s/iter; left time: 13.0369s
Updating learning rate to 4.96267559e-05
Epoch: 4 cost time: 2.4643301963806152
Epoch: 4, Steps: 131 | Train Loss: 0.4074628 Vali Loss: 0.2850568 Best vali loss: 0.2753378
	iters: 100, epoch: 5 | loss: 0.5245564
	speed: 0.0296s/iter; left time: 12.5762s
Updating learning rate to 3.063541861504353e-05
Epoch: 5 cost time: 2.14862322807312
Epoch: 5, Steps: 131 | Train Loss: 0.5245564 Vali Loss: 0.2834630 Best vali loss: 0.2753378
	iters: 100, epoch: 6 | loss: 0.5648521
	speed: 0.0257s/iter; left time: 7.5460s
Updating learning rate to 1.4535340274820496e-05
Epoch: 6 cost time: 1.6689643859863281
Epoch: 6, Steps: 131 | Train Loss: 0.5648521 Vali Loss: 0.2936884 Best vali loss: 0.2753378
	iters: 100, epoch: 7 | loss: 0.5351101
	speed: 0.0219s/iter; left time: 3.5626s
Updating learning rate to 3.777611859056259e-06
Epoch: 7 cost time: 2.117269277572632
Epoch: 7, Steps: 131 | Train Loss: 0.5351101 Vali Loss: 0.2932227 Best vali loss: 0.2753378
	iters: 100, epoch: 8 | loss: 0.3874512
	speed: 0.0286s/iter; left time: 0.9165s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.319469451904297
Epoch: 8, Steps: 131 | Train Loss: 0.3874512 Vali Loss: 0.2937078 Best vali loss: 0.2753378

best validation loss 0.27533778014591787

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0071897631756, 'e_layers': 1, 'learning_rate': 0.0003622765966, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3773331
	speed: 0.0149s/iter; left time: 29.6855s
	iters: 200, epoch: 1 | loss: 0.4913320
	speed: 0.0054s/iter; left time: 10.2566s
Updating learning rate to 0.0003622765966
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 2.2234532833099365
Epoch: 1, Steps: 262 | Train Loss: 0.4343326 Vali Loss: 0.2875046 Best vali loss: 0.2875046
	iters: 100, epoch: 2 | loss: 0.9384176
	speed: 0.0229s/iter; left time: 39.7535s
	iters: 200, epoch: 2 | loss: 0.4923110
	speed: 0.0072s/iter; left time: 11.7912s
Updating learning rate to 0.0001811382983
Validation loss decreased (0.2875 --> 0.2799).  Saving model state dict ...
Epoch: 2 cost time: 1.9938206672668457
Epoch: 2, Steps: 262 | Train Loss: 0.7153643 Vali Loss: 0.2798902 Best vali loss: 0.2798902
	iters: 100, epoch: 3 | loss: 0.2667873
	speed: 0.0349s/iter; left time: 51.4396s
	iters: 200, epoch: 3 | loss: 0.7040560
	speed: 0.0111s/iter; left time: 15.2234s
Updating learning rate to 9.056914915e-05
Epoch: 3 cost time: 2.9986836910247803
Epoch: 3, Steps: 262 | Train Loss: 0.4854216 Vali Loss: 0.2874685 Best vali loss: 0.2798902
	iters: 100, epoch: 4 | loss: 0.4574476
	speed: 0.0397s/iter; left time: 48.0647s
	iters: 200, epoch: 4 | loss: 0.5272478
	speed: 0.0097s/iter; left time: 10.7808s
Updating learning rate to 4.5284574575e-05
Epoch: 4 cost time: 2.7527334690093994
Epoch: 4, Steps: 262 | Train Loss: 0.4923477 Vali Loss: 0.2912390 Best vali loss: 0.2798902
	iters: 100, epoch: 5 | loss: 0.3923519
	speed: 0.0440s/iter; left time: 41.7875s
	iters: 200, epoch: 5 | loss: 0.4090348
	speed: 0.0099s/iter; left time: 8.4349s
Updating learning rate to 2.26422872875e-05
Epoch: 5 cost time: 2.9251747131347656
Epoch: 5, Steps: 262 | Train Loss: 0.4006934 Vali Loss: 0.2930685 Best vali loss: 0.2798902
	iters: 100, epoch: 6 | loss: 0.5433865
	speed: 0.0401s/iter; left time: 27.5829s
	iters: 200, epoch: 6 | loss: 0.2417718
	speed: 0.0112s/iter; left time: 6.5777s
Updating learning rate to 1.132114364375e-05
Epoch: 6 cost time: 2.8605058193206787
Epoch: 6, Steps: 262 | Train Loss: 0.3925791 Vali Loss: 0.2947537 Best vali loss: 0.2798902
	iters: 100, epoch: 7 | loss: 0.4366139
	speed: 0.0478s/iter; left time: 20.3171s
	iters: 200, epoch: 7 | loss: 0.4662002
	speed: 0.0103s/iter; left time: 3.3610s
Updating learning rate to 5.660571821875e-06
Epoch: 7 cost time: 3.0743567943573
Epoch: 7, Steps: 262 | Train Loss: 0.4514071 Vali Loss: 0.2949317 Best vali loss: 0.2798902
	iters: 100, epoch: 8 | loss: 0.3136611
	speed: 0.0377s/iter; left time: 6.1435s
	iters: 200, epoch: 8 | loss: 0.4656998
	speed: 0.0117s/iter; left time: 0.7375s
Updating learning rate to 2.8302859109375e-06
Epoch: 8 cost time: 2.9351511001586914
Epoch: 8, Steps: 262 | Train Loss: 0.3896804 Vali Loss: 0.2952336 Best vali loss: 0.2798902

best validation loss 0.27989024994496564

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 1, 'learning_rate': 0.0015843837106, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3212476
	speed: 0.0173s/iter; left time: 34.6345s
	iters: 200, epoch: 1 | loss: 0.6608054
	speed: 0.0109s/iter; left time: 20.7305s
Updating learning rate to 0.001524081696233813
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 3.107762575149536
Epoch: 1, Steps: 262 | Train Loss: 0.4910265 Vali Loss: 0.2901309 Best vali loss: 0.2901309
	iters: 100, epoch: 2 | loss: 0.4406987
	speed: 0.0455s/iter; left time: 78.8728s
	iters: 200, epoch: 2 | loss: 0.3786159
	speed: 0.0101s/iter; left time: 16.5098s
Updating learning rate to 0.0013523560881833821
Epoch: 2 cost time: 3.1277542114257812
Epoch: 2, Steps: 262 | Train Loss: 0.4096573 Vali Loss: 0.2971036 Best vali loss: 0.2901309
	iters: 100, epoch: 3 | loss: 0.2563300
	speed: 0.0406s/iter; left time: 59.8072s
	iters: 200, epoch: 3 | loss: 0.5432405
	speed: 0.0108s/iter; left time: 14.8693s
Updating learning rate to 0.0010953505535778727
Epoch: 3 cost time: 2.9718568325042725
Epoch: 3, Steps: 262 | Train Loss: 0.3997853 Vali Loss: 0.3050056 Best vali loss: 0.2901309
	iters: 100, epoch: 4 | loss: 0.3935505
	speed: 0.0349s/iter; left time: 42.2764s
	iters: 200, epoch: 4 | loss: 0.3079359
	speed: 0.0110s/iter; left time: 12.1911s
Updating learning rate to 0.0007921918553
Epoch: 4 cost time: 2.7208633422851562
Epoch: 4, Steps: 262 | Train Loss: 0.3507432 Vali Loss: 0.3035317 Best vali loss: 0.2901309
	iters: 100, epoch: 5 | loss: 0.4863567
	speed: 0.0404s/iter; left time: 38.3251s
	iters: 200, epoch: 5 | loss: 0.2904974
	speed: 0.0120s/iter; left time: 10.1945s
Updating learning rate to 0.0004890331570221276
Epoch: 5 cost time: 2.8455045223236084
Epoch: 5, Steps: 262 | Train Loss: 0.3884270 Vali Loss: 0.3270263 Best vali loss: 0.2901309
	iters: 100, epoch: 6 | loss: 0.2633419
	speed: 0.0268s/iter; left time: 18.4262s
	iters: 200, epoch: 6 | loss: 0.2700472
	speed: 0.0091s/iter; left time: 5.3470s
Updating learning rate to 0.00023202762241661783
Epoch: 6 cost time: 2.3866710662841797
Epoch: 6, Steps: 262 | Train Loss: 0.2666945 Vali Loss: 0.3208604 Best vali loss: 0.2901309
	iters: 100, epoch: 7 | loss: 0.4935030
	speed: 0.0240s/iter; left time: 10.2201s
	iters: 200, epoch: 7 | loss: 0.2958559
	speed: 0.0095s/iter; left time: 3.0863s
Updating learning rate to 6.030201436618709e-05
Epoch: 7 cost time: 2.5316011905670166
Epoch: 7, Steps: 262 | Train Loss: 0.3946795 Vali Loss: 0.3273446 Best vali loss: 0.2901309
	iters: 100, epoch: 8 | loss: 0.2929935
	speed: 0.0331s/iter; left time: 5.3990s
	iters: 200, epoch: 8 | loss: 0.2027628
	speed: 0.0081s/iter; left time: 0.5113s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.451141595840454
Epoch: 8, Steps: 262 | Train Loss: 0.2478782 Vali Loss: 0.3258846 Best vali loss: 0.2901309

best validation loss 0.29013092742173724

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3129573
	speed: 0.0160s/iter; left time: 131.9248s
	iters: 200, epoch: 1 | loss: 0.4218475
	speed: 0.0100s/iter; left time: 81.7689s
	iters: 300, epoch: 1 | loss: 0.1836146
	speed: 0.0095s/iter; left time: 76.2098s
	iters: 400, epoch: 1 | loss: 0.3153516
	speed: 0.0097s/iter; left time: 77.3868s
	iters: 500, epoch: 1 | loss: 0.2058939
	speed: 0.0074s/iter; left time: 58.4357s
	iters: 600, epoch: 1 | loss: 1.8155856
	speed: 0.0078s/iter; left time: 60.6080s
	iters: 700, epoch: 1 | loss: 0.3440349
	speed: 0.0078s/iter; left time: 59.7199s
	iters: 800, epoch: 1 | loss: 0.2650155
	speed: 0.0078s/iter; left time: 59.0083s
	iters: 900, epoch: 1 | loss: 0.2467339
	speed: 0.0084s/iter; left time: 62.3177s
	iters: 1000, epoch: 1 | loss: 0.5345546
	speed: 0.0072s/iter; left time: 53.0247s
Updating learning rate to 0.0003784163294
Validation loss decreased (inf --> 0.2872).  Saving model state dict ...
Epoch: 1 cost time: 9.223625898361206
Epoch: 1, Steps: 1045 | Train Loss: 0.4645589 Vali Loss: 0.2872264 Best vali loss: 0.2872264
	iters: 100, epoch: 2 | loss: 0.4497119
	speed: 0.0311s/iter; left time: 224.4829s
	iters: 200, epoch: 2 | loss: 0.4246326
	speed: 0.0089s/iter; left time: 63.3192s
	iters: 300, epoch: 2 | loss: 0.5596437
	speed: 0.0087s/iter; left time: 60.7631s
	iters: 400, epoch: 2 | loss: 0.5011318
	speed: 0.0093s/iter; left time: 64.6334s
	iters: 500, epoch: 2 | loss: 0.3509818
	speed: 0.0082s/iter; left time: 55.7824s
	iters: 600, epoch: 2 | loss: 0.1959390
	speed: 0.0081s/iter; left time: 54.0739s
	iters: 700, epoch: 2 | loss: 0.3973658
	speed: 0.0068s/iter; left time: 45.1307s
	iters: 800, epoch: 2 | loss: 0.2373156
	speed: 0.0067s/iter; left time: 43.5460s
	iters: 900, epoch: 2 | loss: 0.2372932
	speed: 0.0075s/iter; left time: 47.9112s
	iters: 1000, epoch: 2 | loss: 0.5035517
	speed: 0.0075s/iter; left time: 47.2846s
Updating learning rate to 0.0001892081647
Epoch: 2 cost time: 8.487321615219116
Epoch: 2, Steps: 1045 | Train Loss: 0.3857567 Vali Loss: 0.2941487 Best vali loss: 0.2872264
	iters: 100, epoch: 3 | loss: 0.2328516
	speed: 0.0224s/iter; left time: 138.0143s
	iters: 200, epoch: 3 | loss: 0.1763583
	speed: 0.0076s/iter; left time: 45.8560s
	iters: 300, epoch: 3 | loss: 0.3603660
	speed: 0.0065s/iter; left time: 38.9513s
	iters: 400, epoch: 3 | loss: 0.7491552
	speed: 0.0075s/iter; left time: 44.1279s
	iters: 500, epoch: 3 | loss: 0.2158250
	speed: 0.0062s/iter; left time: 35.7864s
	iters: 600, epoch: 3 | loss: 0.4898120
	speed: 0.0074s/iter; left time: 42.2182s
	iters: 700, epoch: 3 | loss: 0.2604750
	speed: 0.0073s/iter; left time: 40.4315s
	iters: 800, epoch: 3 | loss: 0.3128798
	speed: 0.0045s/iter; left time: 24.4962s
	iters: 900, epoch: 3 | loss: 0.2298692
	speed: 0.0045s/iter; left time: 23.9108s
	iters: 1000, epoch: 3 | loss: 0.4109926
	speed: 0.0096s/iter; left time: 50.5749s
Updating learning rate to 9.460408235e-05
Epoch: 3 cost time: 7.244301080703735
Epoch: 3, Steps: 1045 | Train Loss: 0.3438585 Vali Loss: 0.2898297 Best vali loss: 0.2872264

best validation loss 0.2872263975150526

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020904164085, 'e_layers': 4, 'learning_rate': 0.0011131188943, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6185189
	speed: 0.0149s/iter; left time: 60.8042s
	iters: 200, epoch: 1 | loss: 0.8169447
	speed: 0.0141s/iter; left time: 56.3162s
	iters: 300, epoch: 1 | loss: 0.5168089
	speed: 0.0146s/iter; left time: 56.7640s
	iters: 400, epoch: 1 | loss: 0.4848201
	speed: 0.0132s/iter; left time: 49.9806s
	iters: 500, epoch: 1 | loss: 0.9778598
	speed: 0.0116s/iter; left time: 42.9102s
Updating learning rate to 0.0011131188943
Validation loss decreased (inf --> 0.2965).  Saving model state dict ...
Epoch: 1 cost time: 6.857126235961914
Epoch: 1, Steps: 523 | Train Loss: 0.6829905 Vali Loss: 0.2964743 Best vali loss: 0.2964743
	iters: 100, epoch: 2 | loss: 0.4344526
	speed: 0.0276s/iter; left time: 98.4416s
	iters: 200, epoch: 2 | loss: 0.7227670
	speed: 0.0128s/iter; left time: 44.2028s
	iters: 300, epoch: 2 | loss: 0.6852963
	speed: 0.0119s/iter; left time: 40.0752s
	iters: 400, epoch: 2 | loss: 0.4916916
	speed: 0.0127s/iter; left time: 41.4015s
	iters: 500, epoch: 2 | loss: 0.4396299
	speed: 0.0138s/iter; left time: 43.5801s
Updating learning rate to 0.00055655944715
Validation loss decreased (0.2965 --> 0.2890).  Saving model state dict ...
Epoch: 2 cost time: 6.801562547683716
Epoch: 2, Steps: 523 | Train Loss: 0.5547675 Vali Loss: 0.2889505 Best vali loss: 0.2889505
	iters: 100, epoch: 3 | loss: 0.9167523
	speed: 0.0274s/iter; left time: 83.2250s
	iters: 200, epoch: 3 | loss: 0.4039275
	speed: 0.0121s/iter; left time: 35.5991s
	iters: 300, epoch: 3 | loss: 0.3430758
	speed: 0.0139s/iter; left time: 39.4813s
	iters: 400, epoch: 3 | loss: 0.4072367
	speed: 0.0141s/iter; left time: 38.6118s
	iters: 500, epoch: 3 | loss: 0.3232609
	speed: 0.0123s/iter; left time: 32.3431s
Updating learning rate to 0.000278279723575
Validation loss decreased (0.2890 --> 0.2862).  Saving model state dict ...
Epoch: 3 cost time: 6.829694032669067
Epoch: 3, Steps: 523 | Train Loss: 0.4788506 Vali Loss: 0.2861649 Best vali loss: 0.2861649

best validation loss 0.2861649392483712

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019114256213, 'e_layers': 2, 'learning_rate': 0.0002250367297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00021647177916655239
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 0.9204480648040771
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2814537 Best vali loss: 0.2814537
Updating learning rate to 0.00019208086364345706
Validation loss decreased (0.2815 --> 0.2806).  Saving model state dict ...
Epoch: 2 cost time: 0.5804040431976318
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2805953 Best vali loss: 0.2805953
Updating learning rate to 0.00015557727891490547
Epoch: 3 cost time: 0.565011739730835
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2814217 Best vali loss: 0.2805953

best validation loss 0.2805952676812616

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019114256213, 'e_layers': 2, 'learning_rate': 0.0002250367297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00011251836485
Validation loss decreased (0.2806 --> 0.2796).  Saving model state dict ...
Epoch: 4 cost time: 0.9092988967895508
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2795656 Best vali loss: 0.2795656
Updating learning rate to 6.945945078509453e-05
Epoch: 5 cost time: 0.5877907276153564
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2820978 Best vali loss: 0.2795656
Updating learning rate to 3.295586605654293e-05
Epoch: 6 cost time: 0.5766658782958984
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2809056 Best vali loss: 0.2795656
Updating learning rate to 8.564950533447601e-06
Epoch: 7 cost time: 0.6036853790283203
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2813374 Best vali loss: 0.2795656
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5910072326660156
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2819533 Best vali loss: 0.2795656

best validation loss 0.27956562052876055

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0022899640873, 'e_layers': 4, 'learning_rate': 0.0002423804971, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4944689
	speed: 0.0191s/iter; left time: 38.2032s
	iters: 200, epoch: 1 | loss: 0.3309503
	speed: 0.0115s/iter; left time: 21.8621s
Updating learning rate to 0.00023315543872530064
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 3.4962785243988037
Epoch: 1, Steps: 262 | Train Loss: 0.4127096 Vali Loss: 0.2875731 Best vali loss: 0.2875731
	iters: 100, epoch: 2 | loss: 0.8908041
	speed: 0.0249s/iter; left time: 43.1383s
	iters: 200, epoch: 2 | loss: 0.4554583
	speed: 0.0120s/iter; left time: 19.5463s
Updating learning rate to 0.00020688469511338813
Validation loss decreased (0.2876 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 3.182900905609131
Epoch: 2, Steps: 262 | Train Loss: 0.6731312 Vali Loss: 0.2838072 Best vali loss: 0.2838072
	iters: 100, epoch: 3 | loss: 0.8015401
	speed: 0.0239s/iter; left time: 35.1910s
	iters: 200, epoch: 3 | loss: 0.4620095
	speed: 0.0100s/iter; left time: 13.7080s
Updating learning rate to 0.00016756774883429235
Epoch: 3 cost time: 2.8244762420654297
Epoch: 3, Steps: 262 | Train Loss: 0.6317748 Vali Loss: 0.2843950 Best vali loss: 0.2838072
	iters: 100, epoch: 4 | loss: 0.2570062
	speed: 0.0225s/iter; left time: 27.2765s
	iters: 200, epoch: 4 | loss: 0.4321362
	speed: 0.0138s/iter; left time: 15.3238s
Updating learning rate to 0.00012119024855
Epoch: 4 cost time: 3.261646270751953
Epoch: 4, Steps: 262 | Train Loss: 0.3445712 Vali Loss: 0.2891121 Best vali loss: 0.2838072
	iters: 100, epoch: 5 | loss: 0.4948571
	speed: 0.0242s/iter; left time: 22.9209s
	iters: 200, epoch: 5 | loss: 0.6548369
	speed: 0.0120s/iter; left time: 10.1676s
Updating learning rate to 7.481274826570766e-05
Epoch: 5 cost time: 3.1545281410217285
Epoch: 5, Steps: 262 | Train Loss: 0.5748470 Vali Loss: 0.2853547 Best vali loss: 0.2838072
	iters: 100, epoch: 6 | loss: 0.3643078
	speed: 0.0248s/iter; left time: 17.0100s
	iters: 200, epoch: 6 | loss: 0.6218984
	speed: 0.0116s/iter; left time: 6.8034s
Updating learning rate to 3.549580198661185e-05
Epoch: 6 cost time: 3.101982831954956
Epoch: 6, Steps: 262 | Train Loss: 0.4931031 Vali Loss: 0.2873402 Best vali loss: 0.2838072
	iters: 100, epoch: 7 | loss: 0.4091299
	speed: 0.0218s/iter; left time: 9.2735s
	iters: 200, epoch: 7 | loss: 0.6959127
	speed: 0.0098s/iter; left time: 3.1789s
Updating learning rate to 9.225058374699354e-06
Epoch: 7 cost time: 2.7641987800598145
Epoch: 7, Steps: 262 | Train Loss: 0.5525213 Vali Loss: 0.2865116 Best vali loss: 0.2838072
	iters: 100, epoch: 8 | loss: 0.5900356
	speed: 0.0239s/iter; left time: 3.8954s
	iters: 200, epoch: 8 | loss: 0.2999789
	speed: 0.0081s/iter; left time: 0.5082s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3803067207336426
Epoch: 8, Steps: 262 | Train Loss: 0.4450073 Vali Loss: 0.2873791 Best vali loss: 0.2838072

best validation loss 0.28380719548754196

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0033888467905, 'e_layers': 1, 'learning_rate': 0.0037128733106, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2759395
	speed: 0.0127s/iter; left time: 25.3528s
	iters: 200, epoch: 1 | loss: 0.7870390
	speed: 0.0062s/iter; left time: 11.8143s
Updating learning rate to 0.0037128733106
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 2.0094096660614014
Epoch: 1, Steps: 262 | Train Loss: 0.5314893 Vali Loss: 0.2802792 Best vali loss: 0.2802792
	iters: 100, epoch: 2 | loss: 0.3470424
	speed: 0.0147s/iter; left time: 25.5199s
	iters: 200, epoch: 2 | loss: 0.4686888
	speed: 0.0052s/iter; left time: 8.4480s
Updating learning rate to 0.0018564366553
Epoch: 2 cost time: 1.4686803817749023
Epoch: 2, Steps: 262 | Train Loss: 0.4078656 Vali Loss: 0.2970025 Best vali loss: 0.2802792
	iters: 100, epoch: 3 | loss: 0.3804743
	speed: 0.0132s/iter; left time: 19.3856s
	iters: 200, epoch: 3 | loss: 0.6943249
	speed: 0.0082s/iter; left time: 11.2610s
Updating learning rate to 0.00092821832765
Epoch: 3 cost time: 1.9045777320861816
Epoch: 3, Steps: 262 | Train Loss: 0.5373996 Vali Loss: 0.2892630 Best vali loss: 0.2802792
	iters: 100, epoch: 4 | loss: 0.3008936
	speed: 0.0240s/iter; left time: 29.1115s
	iters: 200, epoch: 4 | loss: 0.3381241
	speed: 0.0066s/iter; left time: 7.3200s
Updating learning rate to 0.000464109163825
Epoch: 4 cost time: 1.9717357158660889
Epoch: 4, Steps: 262 | Train Loss: 0.3195088 Vali Loss: 0.3041865 Best vali loss: 0.2802792
	iters: 100, epoch: 5 | loss: 0.7697006
	speed: 0.0346s/iter; left time: 32.8356s
	iters: 200, epoch: 5 | loss: 0.7045615
	speed: 0.0113s/iter; left time: 9.5528s
Updating learning rate to 0.0002320545819125
Epoch: 5 cost time: 3.0133490562438965
Epoch: 5, Steps: 262 | Train Loss: 0.7371311 Vali Loss: 0.2993369 Best vali loss: 0.2802792
	iters: 100, epoch: 6 | loss: 0.5956388
	speed: 0.0456s/iter; left time: 31.3046s
	iters: 200, epoch: 6 | loss: 0.3628020
	speed: 0.0107s/iter; left time: 6.2725s
Updating learning rate to 0.00011602729095625
Epoch: 6 cost time: 2.9200029373168945
Epoch: 6, Steps: 262 | Train Loss: 0.4792204 Vali Loss: 0.3016831 Best vali loss: 0.2802792
	iters: 100, epoch: 7 | loss: 0.4595065
	speed: 0.0418s/iter; left time: 17.7676s
	iters: 200, epoch: 7 | loss: 0.5254242
	speed: 0.0109s/iter; left time: 3.5500s
Updating learning rate to 5.8013645478125e-05
Epoch: 7 cost time: 2.984236240386963
Epoch: 7, Steps: 262 | Train Loss: 0.4924654 Vali Loss: 0.3020079 Best vali loss: 0.2802792
	iters: 100, epoch: 8 | loss: 0.3571512
	speed: 0.0434s/iter; left time: 7.0819s
	iters: 200, epoch: 8 | loss: 0.5647743
	speed: 0.0117s/iter; left time: 0.7349s
Updating learning rate to 2.90068227390625e-05
Epoch: 8 cost time: 2.958561420440674
Epoch: 8, Steps: 262 | Train Loss: 0.4609627 Vali Loss: 0.3021225 Best vali loss: 0.2802792

best validation loss 0.2802792214779838

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0096712489936, 'e_layers': 4, 'learning_rate': 0.0007900549735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4784412
	speed: 0.0218s/iter; left time: 43.4658s
	iters: 200, epoch: 1 | loss: 0.4320449
	speed: 0.0138s/iter; left time: 26.1371s
Updating learning rate to 0.0007599852965376985
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 4.220849990844727
Epoch: 1, Steps: 262 | Train Loss: 0.4552431 Vali Loss: 0.2848263 Best vali loss: 0.2848263
	iters: 100, epoch: 2 | loss: 0.5247732
	speed: 0.0537s/iter; left time: 93.1751s
	iters: 200, epoch: 2 | loss: 0.5251040
	speed: 0.0139s/iter; left time: 22.7134s
Updating learning rate to 0.000674354101386004
Epoch: 2 cost time: 3.8700850009918213
Epoch: 2, Steps: 262 | Train Loss: 0.5249386 Vali Loss: 0.2912613 Best vali loss: 0.2848263
	iters: 100, epoch: 3 | loss: 0.7690217
	speed: 0.0535s/iter; left time: 78.7470s
	iters: 200, epoch: 3 | loss: 0.4582410
	speed: 0.0134s/iter; left time: 18.3689s
Updating learning rate to 0.0005461979612580451
Validation loss decreased (0.2848 --> 0.2827).  Saving model state dict ...
Epoch: 3 cost time: 3.9501144886016846
Epoch: 3, Steps: 262 | Train Loss: 0.6136314 Vali Loss: 0.2826845 Best vali loss: 0.2826845

best validation loss 0.28268449900096215

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4115252
	speed: 0.0138s/iter; left time: 114.2210s
	iters: 200, epoch: 1 | loss: 0.2935918
	speed: 0.0075s/iter; left time: 60.8006s
	iters: 300, epoch: 1 | loss: 0.7039090
	speed: 0.0085s/iter; left time: 68.1461s
	iters: 400, epoch: 1 | loss: 0.3624870
	speed: 0.0053s/iter; left time: 42.3583s
	iters: 500, epoch: 1 | loss: 0.3321506
	speed: 0.0077s/iter; left time: 60.9210s
	iters: 600, epoch: 1 | loss: 0.2713432
	speed: 0.0080s/iter; left time: 62.1118s
	iters: 700, epoch: 1 | loss: 0.2268407
	speed: 0.0072s/iter; left time: 55.0202s
	iters: 800, epoch: 1 | loss: 0.1915079
	speed: 0.0066s/iter; left time: 49.6497s
	iters: 900, epoch: 1 | loss: 1.3950286
	speed: 0.0066s/iter; left time: 49.0556s
	iters: 1000, epoch: 1 | loss: 0.6714419
	speed: 0.0071s/iter; left time: 52.2628s
Updating learning rate to 0.0001606491471
Validation loss decreased (inf --> 0.2907).  Saving model state dict ...
Epoch: 1 cost time: 7.875910520553589
Epoch: 1, Steps: 1045 | Train Loss: 0.4859826 Vali Loss: 0.2906780 Best vali loss: 0.2906780
	iters: 100, epoch: 2 | loss: 0.5050956
	speed: 0.0224s/iter; left time: 161.4799s
	iters: 200, epoch: 2 | loss: 0.4448963
	speed: 0.0075s/iter; left time: 53.0975s
	iters: 300, epoch: 2 | loss: 1.3684880
	speed: 0.0058s/iter; left time: 40.5390s
	iters: 400, epoch: 2 | loss: 0.2206654
	speed: 0.0057s/iter; left time: 39.5381s
	iters: 500, epoch: 2 | loss: 0.3475917
	speed: 0.0061s/iter; left time: 41.8623s
	iters: 600, epoch: 2 | loss: 0.2891924
	speed: 0.0070s/iter; left time: 46.8267s
	iters: 700, epoch: 2 | loss: 0.2985906
	speed: 0.0078s/iter; left time: 51.7775s
	iters: 800, epoch: 2 | loss: 0.3550837
	speed: 0.0086s/iter; left time: 56.3388s
	iters: 900, epoch: 2 | loss: 0.3671905
	speed: 0.0078s/iter; left time: 50.0290s
	iters: 1000, epoch: 2 | loss: 0.3331625
	speed: 0.0079s/iter; left time: 49.7235s
Updating learning rate to 8.032457355e-05
Validation loss decreased (0.2907 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 7.522006988525391
Epoch: 2, Steps: 1045 | Train Loss: 0.4529956 Vali Loss: 0.2814796 Best vali loss: 0.2814796
	iters: 100, epoch: 3 | loss: 0.3669394
	speed: 0.0222s/iter; left time: 136.7002s
	iters: 200, epoch: 3 | loss: 0.3952629
	speed: 0.0082s/iter; left time: 49.9724s
	iters: 300, epoch: 3 | loss: 0.5455806
	speed: 0.0070s/iter; left time: 41.6250s
	iters: 400, epoch: 3 | loss: 1.6010939
	speed: 0.0062s/iter; left time: 36.4955s
	iters: 500, epoch: 3 | loss: 0.4020435
	speed: 0.0072s/iter; left time: 41.4527s
	iters: 600, epoch: 3 | loss: 0.1950179
	speed: 0.0067s/iter; left time: 38.0354s
	iters: 700, epoch: 3 | loss: 0.3373289
	speed: 0.0065s/iter; left time: 36.0172s
	iters: 800, epoch: 3 | loss: 0.1734656
	speed: 0.0070s/iter; left time: 38.1837s
	iters: 900, epoch: 3 | loss: 0.9079828
	speed: 0.0083s/iter; left time: 44.8219s
	iters: 1000, epoch: 3 | loss: 0.2108055
	speed: 0.0085s/iter; left time: 44.8027s
Updating learning rate to 4.0162286775e-05
Epoch: 3 cost time: 7.761223793029785
Epoch: 3, Steps: 1045 | Train Loss: 0.5135521 Vali Loss: 0.2827906 Best vali loss: 0.2814796

best validation loss 0.281479586341116

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0061686788666, 'e_layers': 2, 'learning_rate': 0.0029971076006, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3975050
	speed: 0.0130s/iter; left time: 52.9337s
	iters: 200, epoch: 1 | loss: 0.6651977
	speed: 0.0049s/iter; left time: 19.4028s
	iters: 300, epoch: 1 | loss: 1.1441920
	speed: 0.0073s/iter; left time: 28.3534s
	iters: 400, epoch: 1 | loss: 0.8443964
	speed: 0.0075s/iter; left time: 28.4262s
	iters: 500, epoch: 1 | loss: 0.9083900
	speed: 0.0085s/iter; left time: 31.4669s
Updating learning rate to 0.0028830369847641763
Validation loss decreased (inf --> 0.3159).  Saving model state dict ...
Epoch: 1 cost time: 4.018555641174316
Epoch: 1, Steps: 523 | Train Loss: 0.7919362 Vali Loss: 0.3159094 Best vali loss: 0.3159094
	iters: 100, epoch: 2 | loss: 0.3521702
	speed: 0.0185s/iter; left time: 66.0317s
	iters: 200, epoch: 2 | loss: 0.4796601
	speed: 0.0061s/iter; left time: 21.1099s
	iters: 300, epoch: 2 | loss: 0.7207479
	speed: 0.0071s/iter; left time: 23.8114s
	iters: 400, epoch: 2 | loss: 0.2004258
	speed: 0.0050s/iter; left time: 16.2620s
	iters: 500, epoch: 2 | loss: 0.6795805
	speed: 0.0070s/iter; left time: 22.1532s
Updating learning rate to 0.002558191354465001
Epoch: 2 cost time: 3.5768563747406006
Epoch: 2, Steps: 523 | Train Loss: 0.4865169 Vali Loss: 0.3252291 Best vali loss: 0.3159094
	iters: 100, epoch: 3 | loss: 0.5295292
	speed: 0.0184s/iter; left time: 56.0139s
	iters: 200, epoch: 3 | loss: 0.3324358
	speed: 0.0063s/iter; left time: 18.6008s
	iters: 300, epoch: 3 | loss: 0.6017327
	speed: 0.0083s/iter; left time: 23.5249s
	iters: 400, epoch: 3 | loss: 0.3622787
	speed: 0.0079s/iter; left time: 21.7613s
	iters: 500, epoch: 3 | loss: 0.7438657
	speed: 0.0079s/iter; left time: 20.8678s
Updating learning rate to 0.0020720255121825532
Epoch: 3 cost time: 4.071072101593018
Epoch: 3, Steps: 523 | Train Loss: 0.5139684 Vali Loss: 0.3225687 Best vali loss: 0.3159094

best validation loss 0.3159093654213363

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2517245
	speed: 0.0154s/iter; left time: 78.6955s
	iters: 200, epoch: 4 | loss: 0.2812743
	speed: 0.0078s/iter; left time: 39.0103s
	iters: 300, epoch: 4 | loss: 0.7105645
	speed: 0.0078s/iter; left time: 38.3793s
	iters: 400, epoch: 4 | loss: 0.3562303
	speed: 0.0078s/iter; left time: 37.8688s
	iters: 500, epoch: 4 | loss: 0.3166489
	speed: 0.0076s/iter; left time: 35.7014s
	iters: 600, epoch: 4 | loss: 0.2748376
	speed: 0.0072s/iter; left time: 33.5038s
	iters: 700, epoch: 4 | loss: 0.2158667
	speed: 0.0085s/iter; left time: 38.4831s
	iters: 800, epoch: 4 | loss: 0.1708518
	speed: 0.0077s/iter; left time: 34.0542s
	iters: 900, epoch: 4 | loss: 1.3146377
	speed: 0.0079s/iter; left time: 34.0550s
	iters: 1000, epoch: 4 | loss: 0.6889572
	speed: 0.0084s/iter; left time: 35.3457s
Updating learning rate to 2.00811433875e-05
Epoch: 4 cost time: 8.611085891723633
Epoch: 4, Steps: 1045 | Train Loss: 0.4581593 Vali Loss: 0.2854634 Best vali loss: 0.2814796
	iters: 100, epoch: 5 | loss: 0.4773491
	speed: 0.0249s/iter; left time: 101.7603s
	iters: 200, epoch: 5 | loss: 0.4261102
	speed: 0.0081s/iter; left time: 32.1695s
	iters: 300, epoch: 5 | loss: 1.3053907
	speed: 0.0078s/iter; left time: 30.1171s
	iters: 400, epoch: 5 | loss: 0.2265607
	speed: 0.0076s/iter; left time: 28.6182s
	iters: 500, epoch: 5 | loss: 0.3425635
	speed: 0.0071s/iter; left time: 26.2060s
	iters: 600, epoch: 5 | loss: 0.2857512
	speed: 0.0073s/iter; left time: 26.2995s
	iters: 700, epoch: 5 | loss: 0.3029562
	speed: 0.0092s/iter; left time: 31.8994s
	iters: 800, epoch: 5 | loss: 0.3497007
	speed: 0.0079s/iter; left time: 26.7085s
	iters: 900, epoch: 5 | loss: 0.3405361
	speed: 0.0079s/iter; left time: 25.8100s
	iters: 1000, epoch: 5 | loss: 0.3153921
	speed: 0.0083s/iter; left time: 26.5550s
Updating learning rate to 1.004057169375e-05
Epoch: 5 cost time: 8.353322505950928
Epoch: 5, Steps: 1045 | Train Loss: 0.4372311 Vali Loss: 0.2832324 Best vali loss: 0.2814796
	iters: 100, epoch: 6 | loss: 0.3743281
	speed: 0.0251s/iter; left time: 76.3309s
	iters: 200, epoch: 6 | loss: 0.4089019
	speed: 0.0072s/iter; left time: 21.0171s
	iters: 300, epoch: 6 | loss: 0.5641286
	speed: 0.0081s/iter; left time: 22.9276s
	iters: 400, epoch: 6 | loss: 1.5988661
	speed: 0.0073s/iter; left time: 19.8366s
	iters: 500, epoch: 6 | loss: 0.4089464
	speed: 0.0080s/iter; left time: 21.0505s
	iters: 600, epoch: 6 | loss: 0.1928850
	speed: 0.0076s/iter; left time: 19.2488s
	iters: 700, epoch: 6 | loss: 0.3437334
	speed: 0.0087s/iter; left time: 21.2822s
	iters: 800, epoch: 6 | loss: 0.1800802
	speed: 0.0085s/iter; left time: 19.7730s
	iters: 900, epoch: 6 | loss: 0.8911897
	speed: 0.0072s/iter; left time: 16.1654s
	iters: 1000, epoch: 6 | loss: 0.2022467
	speed: 0.0077s/iter; left time: 16.4928s
Updating learning rate to 5.020285846875e-06
Epoch: 6 cost time: 8.259338140487671
Epoch: 6, Steps: 1045 | Train Loss: 0.5165306 Vali Loss: 0.2837537 Best vali loss: 0.2814796
	iters: 100, epoch: 7 | loss: 0.9095020
	speed: 0.0229s/iter; left time: 45.6044s
	iters: 200, epoch: 7 | loss: 0.1859531
	speed: 0.0068s/iter; left time: 12.8724s
	iters: 300, epoch: 7 | loss: 1.1383170
	speed: 0.0079s/iter; left time: 14.1872s
	iters: 400, epoch: 7 | loss: 0.1736801
	speed: 0.0073s/iter; left time: 12.3841s
	iters: 500, epoch: 7 | loss: 0.3044780
	speed: 0.0062s/iter; left time: 9.8451s
	iters: 600, epoch: 7 | loss: 0.1966449
	speed: 0.0074s/iter; left time: 10.9990s
	iters: 700, epoch: 7 | loss: 0.2210371
	speed: 0.0078s/iter; left time: 10.8224s
	iters: 800, epoch: 7 | loss: 0.3294097
	speed: 0.0083s/iter; left time: 10.7701s
	iters: 900, epoch: 7 | loss: 0.4943132
	speed: 0.0075s/iter; left time: 8.9282s
	iters: 1000, epoch: 7 | loss: 0.5112523
	speed: 0.0072s/iter; left time: 7.8787s
Updating learning rate to 2.5101429234375e-06
Epoch: 7 cost time: 7.785407304763794
Epoch: 7, Steps: 1045 | Train Loss: 0.4464587 Vali Loss: 0.2837118 Best vali loss: 0.2814796
	iters: 100, epoch: 8 | loss: 0.4827117
	speed: 0.0249s/iter; left time: 23.5677s
	iters: 200, epoch: 8 | loss: 0.2419808
	speed: 0.0063s/iter; left time: 5.3389s
	iters: 300, epoch: 8 | loss: 1.0145053
	speed: 0.0064s/iter; left time: 4.8045s
	iters: 400, epoch: 8 | loss: 0.6822069
	speed: 0.0066s/iter; left time: 4.2446s
	iters: 500, epoch: 8 | loss: 0.7555823
	speed: 0.0075s/iter; left time: 4.0881s
	iters: 600, epoch: 8 | loss: 0.2138248
	speed: 0.0081s/iter; left time: 3.5996s
	iters: 700, epoch: 8 | loss: 0.3211419
	speed: 0.0095s/iter; left time: 3.2762s
	iters: 800, epoch: 8 | loss: 0.3378166
	speed: 0.0087s/iter; left time: 2.1403s
	iters: 900, epoch: 8 | loss: 0.3632925
	speed: 0.0081s/iter; left time: 1.1890s
	iters: 1000, epoch: 8 | loss: 1.9803438
	speed: 0.0074s/iter; left time: 0.3413s
Updating learning rate to 1.25507146171875e-06
Epoch: 8 cost time: 7.937480211257935
Epoch: 8, Steps: 1045 | Train Loss: 0.6393407 Vali Loss: 0.2838094 Best vali loss: 0.2814796

best validation loss 0.281479586341116

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.00487546233, 'e_layers': 4, 'learning_rate': 0.0010291718456, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000990001324593353
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 0.907111644744873
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2932056 Best vali loss: 0.2932056
Updating learning rate to 0.0008784531183150171
Validation loss decreased (0.2932 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 0.6643452644348145
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2850336 Best vali loss: 0.2850336
Updating learning rate to 0.000711509429983861
Epoch: 3 cost time: 0.6729702949523926
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2901140 Best vali loss: 0.2850336
Updating learning rate to 0.0005145859228
Epoch: 4 cost time: 0.6908454895019531
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2912291 Best vali loss: 0.2850336
Updating learning rate to 0.0003176624156161389
Epoch: 5 cost time: 0.6985602378845215
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2890301 Best vali loss: 0.2850336
Updating learning rate to 0.00015071872728498277
Epoch: 6 cost time: 1.0999140739440918
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2885638 Best vali loss: 0.2850336
Updating learning rate to 3.917052100664691e-05
Epoch: 7 cost time: 0.7121396064758301
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2876370 Best vali loss: 0.2850336
Updating learning rate to 0.0
Epoch: 8 cost time: 0.653965950012207
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2886530 Best vali loss: 0.2850336

best validation loss 0.28503360367920727

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010495657123, 'e_layers': 4, 'learning_rate': 0.0016632342935, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8271694
	speed: 0.0199s/iter; left time: 18.8392s
Updating learning rate to 0.0016632342935
Validation loss decreased (inf --> 0.3277).  Saving model state dict ...
Epoch: 1 cost time: 2.1354761123657227
Epoch: 1, Steps: 131 | Train Loss: 0.8271694 Vali Loss: 0.3276720 Best vali loss: 0.3276720
	iters: 100, epoch: 2 | loss: 0.7937784
	speed: 0.0245s/iter; left time: 20.0548s
Updating learning rate to 0.00083161714675
Epoch: 2 cost time: 1.794187068939209
Epoch: 2, Steps: 131 | Train Loss: 0.7937784 Vali Loss: 0.3356193 Best vali loss: 0.3276720
	iters: 100, epoch: 3 | loss: 0.5562307
	speed: 0.0246s/iter; left time: 16.9319s
Updating learning rate to 0.000415808573375
Validation loss decreased (0.3277 --> 0.3186).  Saving model state dict ...
Epoch: 3 cost time: 2.183392286300659
Epoch: 3, Steps: 131 | Train Loss: 0.5562307 Vali Loss: 0.3186356 Best vali loss: 0.3186356
	iters: 100, epoch: 4 | loss: 0.8564814
	speed: 0.0377s/iter; left time: 20.9386s
Updating learning rate to 0.0002079042866875
Validation loss decreased (0.3186 --> 0.3160).  Saving model state dict ...
Epoch: 4 cost time: 2.0723679065704346
Epoch: 4, Steps: 131 | Train Loss: 0.8564814 Vali Loss: 0.3160468 Best vali loss: 0.3160468
	iters: 100, epoch: 5 | loss: 0.5041163
	speed: 0.0263s/iter; left time: 11.1823s
Updating learning rate to 0.00010395214334375
Epoch: 5 cost time: 1.9257621765136719
Epoch: 5, Steps: 131 | Train Loss: 0.5041163 Vali Loss: 0.3196749 Best vali loss: 0.3160468
	iters: 100, epoch: 6 | loss: 0.4896751
	speed: 0.0256s/iter; left time: 7.5133s
Updating learning rate to 5.1976071671875e-05
Epoch: 6 cost time: 1.5998799800872803
Epoch: 6, Steps: 131 | Train Loss: 0.4896751 Vali Loss: 0.3199304 Best vali loss: 0.3160468
	iters: 100, epoch: 7 | loss: 0.2952425
	speed: 0.0226s/iter; left time: 3.6904s
Updating learning rate to 2.59880358359375e-05
Epoch: 7 cost time: 2.1349759101867676
Epoch: 7, Steps: 131 | Train Loss: 0.2952425 Vali Loss: 0.3189211 Best vali loss: 0.3160468
	iters: 100, epoch: 8 | loss: 0.9158698
	speed: 0.0318s/iter; left time: 1.0192s
Updating learning rate to 1.299401791796875e-05
Epoch: 8 cost time: 2.0108516216278076
Epoch: 8, Steps: 131 | Train Loss: 0.9158698 Vali Loss: 0.3187803 Best vali loss: 0.3160468

best validation loss 0.31604683181141424

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0099997540142, 'e_layers': 1, 'learning_rate': 0.0030308631648, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5788425
	speed: 0.0134s/iter; left time: 26.7432s
	iters: 200, epoch: 1 | loss: 1.0384212
	speed: 0.0089s/iter; left time: 16.8863s
Updating learning rate to 0.0029155078043005514
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 2.658205986022949
Epoch: 1, Steps: 262 | Train Loss: 0.8086318 Vali Loss: 0.2838127 Best vali loss: 0.2838127
	iters: 100, epoch: 2 | loss: 0.8554702
	speed: 0.0237s/iter; left time: 41.0889s
	iters: 200, epoch: 2 | loss: 0.3301942
	speed: 0.0085s/iter; left time: 13.9198s
Updating learning rate to 0.0025870035307393
Epoch: 2 cost time: 2.1913681030273438
Epoch: 2, Steps: 262 | Train Loss: 0.5928322 Vali Loss: 0.3064395 Best vali loss: 0.2838127
	iters: 100, epoch: 3 | loss: 0.5876373
	speed: 0.0210s/iter; left time: 30.9041s
	iters: 200, epoch: 3 | loss: 0.3907645
	speed: 0.0069s/iter; left time: 9.5309s
Updating learning rate to 0.0020953621418672913
Epoch: 3 cost time: 1.8583483695983887
Epoch: 3, Steps: 262 | Train Loss: 0.4892009 Vali Loss: 0.3182754 Best vali loss: 0.2838127

best validation loss 0.28381268207403576

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026411680255, 'e_layers': 1, 'learning_rate': 0.0015330488365, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2682743
	speed: 0.0159s/iter; left time: 31.7968s
	iters: 200, epoch: 1 | loss: 0.7787771
	speed: 0.0078s/iter; left time: 14.8424s
Updating learning rate to 0.0014747006394412961
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 2.5694708824157715
Epoch: 1, Steps: 262 | Train Loss: 0.5235257 Vali Loss: 0.2822530 Best vali loss: 0.2822530
	iters: 100, epoch: 2 | loss: 0.3363860
	speed: 0.0221s/iter; left time: 38.4184s
	iters: 200, epoch: 2 | loss: 0.4591668
	speed: 0.0082s/iter; left time: 13.3969s
Updating learning rate to 0.0013085390323396484
Epoch: 2 cost time: 2.088505506515503
Epoch: 2, Steps: 262 | Train Loss: 0.3977764 Vali Loss: 0.2887735 Best vali loss: 0.2822530
	iters: 100, epoch: 3 | loss: 0.3847605
	speed: 0.0149s/iter; left time: 21.9215s
	iters: 200, epoch: 3 | loss: 0.7490980
	speed: 0.0077s/iter; left time: 10.5511s
Updating learning rate to 0.0010598606136175638
Epoch: 3 cost time: 2.0416557788848877
Epoch: 3, Steps: 262 | Train Loss: 0.5669292 Vali Loss: 0.2879607 Best vali loss: 0.2822530

best validation loss 0.28225304600296075

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0074460408096, 'e_layers': 2, 'learning_rate': 0.0027349231343, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4342411
	speed: 0.0139s/iter; left time: 27.8229s
	iters: 200, epoch: 1 | loss: 0.4348978
	speed: 0.0105s/iter; left time: 19.8351s
Updating learning rate to 0.0027349231343
Validation loss decreased (inf --> 0.3006).  Saving model state dict ...
Epoch: 1 cost time: 2.7958991527557373
Epoch: 1, Steps: 262 | Train Loss: 0.4345694 Vali Loss: 0.3006043 Best vali loss: 0.3006043
	iters: 100, epoch: 2 | loss: 0.4074520
	speed: 0.0288s/iter; left time: 49.9771s
	iters: 200, epoch: 2 | loss: 0.5632204
	speed: 0.0076s/iter; left time: 12.4070s
Updating learning rate to 0.00136746156715
Epoch: 2 cost time: 2.3071680068969727
Epoch: 2, Steps: 262 | Train Loss: 0.4853362 Vali Loss: 0.3026317 Best vali loss: 0.3006043
	iters: 100, epoch: 3 | loss: 0.3000556
	speed: 0.0283s/iter; left time: 41.6830s
	iters: 200, epoch: 3 | loss: 0.7299696
	speed: 0.0093s/iter; left time: 12.8184s
Updating learning rate to 0.000683730783575
Validation loss decreased (0.3006 --> 0.2919).  Saving model state dict ...
Epoch: 3 cost time: 2.5299019813537598
Epoch: 3, Steps: 262 | Train Loss: 0.5150126 Vali Loss: 0.2919419 Best vali loss: 0.2919419

best validation loss 0.29194190975191336

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026411680255, 'e_layers': 1, 'learning_rate': 0.0015330488365, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2703618
	speed: 0.0150s/iter; left time: 18.2245s
	iters: 200, epoch: 4 | loss: 0.7107145
	speed: 0.0073s/iter; left time: 8.1474s
Updating learning rate to 0.00076652441825
Epoch: 4 cost time: 2.334730386734009
Epoch: 4, Steps: 262 | Train Loss: 0.4905382 Vali Loss: 0.2932875 Best vali loss: 0.2822530
	iters: 100, epoch: 5 | loss: 0.3456062
	speed: 0.0196s/iter; left time: 18.6308s
	iters: 200, epoch: 5 | loss: 0.4333160
	speed: 0.0071s/iter; left time: 6.0614s
Updating learning rate to 0.0004731882228824364
Epoch: 5 cost time: 1.995368480682373
Epoch: 5, Steps: 262 | Train Loss: 0.3894611 Vali Loss: 0.2976111 Best vali loss: 0.2822530
	iters: 100, epoch: 6 | loss: 0.3799841
	speed: 0.0228s/iter; left time: 15.6530s
	iters: 200, epoch: 6 | loss: 0.6503246
	speed: 0.0099s/iter; left time: 5.8353s
Updating learning rate to 0.00022450980416035169
Epoch: 6 cost time: 2.3901753425598145
Epoch: 6, Steps: 262 | Train Loss: 0.5151544 Vali Loss: 0.2943339 Best vali loss: 0.2822530
	iters: 100, epoch: 7 | loss: 0.2963534
	speed: 0.0223s/iter; left time: 9.4945s
	iters: 200, epoch: 7 | loss: 0.3446701
	speed: 0.0075s/iter; left time: 2.4522s
Updating learning rate to 5.8348197058703974e-05
Epoch: 7 cost time: 2.0396080017089844
Epoch: 7, Steps: 262 | Train Loss: 0.3205118 Vali Loss: 0.3037497 Best vali loss: 0.2822530
	iters: 100, epoch: 8 | loss: 0.7721549
	speed: 0.0221s/iter; left time: 3.5986s
	iters: 200, epoch: 8 | loss: 0.7375949
	speed: 0.0080s/iter; left time: 0.5025s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3545143604278564
Epoch: 8, Steps: 262 | Train Loss: 0.7548749 Vali Loss: 0.3000124 Best vali loss: 0.2822530

best validation loss 0.28225304600296075

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011667363616, 'e_layers': 4, 'learning_rate': 0.0008608226971, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4204379
	speed: 0.0183s/iter; left time: 151.5337s
	iters: 200, epoch: 1 | loss: 1.6165038
	speed: 0.0127s/iter; left time: 103.2675s
	iters: 300, epoch: 1 | loss: 0.5759127
	speed: 0.0127s/iter; left time: 102.3951s
	iters: 400, epoch: 1 | loss: 0.5196199
	speed: 0.0105s/iter; left time: 83.6453s
	iters: 500, epoch: 1 | loss: 0.9733795
	speed: 0.0106s/iter; left time: 83.4116s
	iters: 600, epoch: 1 | loss: 0.1922206
	speed: 0.0097s/iter; left time: 75.5599s
	iters: 700, epoch: 1 | loss: 0.2489069
	speed: 0.0099s/iter; left time: 76.0210s
	iters: 800, epoch: 1 | loss: 0.2785779
	speed: 0.0111s/iter; left time: 83.7722s
	iters: 900, epoch: 1 | loss: 0.9824701
	speed: 0.0114s/iter; left time: 85.4276s
	iters: 1000, epoch: 1 | loss: 1.6472510
	speed: 0.0099s/iter; left time: 72.6477s
Updating learning rate to 0.0008280595840359265
Validation loss decreased (inf --> 0.3261).  Saving model state dict ...
Epoch: 1 cost time: 11.798222780227661
Epoch: 1, Steps: 1045 | Train Loss: 0.8455280 Vali Loss: 0.3261443 Best vali loss: 0.3261443
	iters: 100, epoch: 2 | loss: 0.3278727
	speed: 0.0326s/iter; left time: 235.5980s
	iters: 200, epoch: 2 | loss: 1.5277015
	speed: 0.0100s/iter; left time: 71.1945s
	iters: 300, epoch: 2 | loss: 0.1193230
	speed: 0.0105s/iter; left time: 73.6146s
	iters: 400, epoch: 2 | loss: 0.5819217
	speed: 0.0100s/iter; left time: 69.2087s
	iters: 500, epoch: 2 | loss: 0.7799608
	speed: 0.0087s/iter; left time: 59.1404s
	iters: 600, epoch: 2 | loss: 0.5295278
	speed: 0.0084s/iter; left time: 56.4375s
	iters: 700, epoch: 2 | loss: 1.6241243
	speed: 0.0095s/iter; left time: 62.7463s
	iters: 800, epoch: 2 | loss: 0.3120669
	speed: 0.0090s/iter; left time: 58.5236s
	iters: 900, epoch: 2 | loss: 0.3505582
	speed: 0.0087s/iter; left time: 55.9610s
	iters: 1000, epoch: 2 | loss: 0.5951850
	speed: 0.0095s/iter; left time: 59.8740s
Updating learning rate to 0.0007347581318093517
Validation loss decreased (0.3261 --> 0.3202).  Saving model state dict ...
Epoch: 2 cost time: 9.824502944946289
Epoch: 2, Steps: 1045 | Train Loss: 0.6748242 Vali Loss: 0.3202285 Best vali loss: 0.3202285
	iters: 100, epoch: 3 | loss: 0.2560129
	speed: 0.0273s/iter; left time: 168.5815s
	iters: 200, epoch: 3 | loss: 0.4139653
	speed: 0.0084s/iter; left time: 50.8824s
	iters: 300, epoch: 3 | loss: 1.4191800
	speed: 0.0094s/iter; left time: 56.2920s
	iters: 400, epoch: 3 | loss: 0.1820090
	speed: 0.0089s/iter; left time: 52.2210s
	iters: 500, epoch: 3 | loss: 0.5431535
	speed: 0.0086s/iter; left time: 49.5034s
	iters: 600, epoch: 3 | loss: 0.7404364
	speed: 0.0106s/iter; left time: 59.9797s
	iters: 700, epoch: 3 | loss: 1.0412550
	speed: 0.0086s/iter; left time: 47.9936s
	iters: 800, epoch: 3 | loss: 0.3147919
	speed: 0.0089s/iter; left time: 48.4905s
	iters: 900, epoch: 3 | loss: 0.3147345
	speed: 0.0095s/iter; left time: 50.8936s
	iters: 1000, epoch: 3 | loss: 0.2654954
	speed: 0.0086s/iter; left time: 45.0938s
Updating learning rate to 0.000595122640742001
Epoch: 3 cost time: 9.490404844284058
Epoch: 3, Steps: 1045 | Train Loss: 0.5491034 Vali Loss: 0.3240722 Best vali loss: 0.3202285
	iters: 100, epoch: 4 | loss: 0.5212395
	speed: 0.0299s/iter; left time: 153.3696s
	iters: 200, epoch: 4 | loss: 0.7476990
	speed: 0.0090s/iter; left time: 45.4503s
	iters: 300, epoch: 4 | loss: 0.3047818
	speed: 0.0097s/iter; left time: 47.8585s
	iters: 400, epoch: 4 | loss: 0.1917936
	speed: 0.0114s/iter; left time: 55.1340s
	iters: 500, epoch: 4 | loss: 0.1875219
	speed: 0.0113s/iter; left time: 53.6270s
	iters: 600, epoch: 4 | loss: 0.5259364
	speed: 0.0111s/iter; left time: 51.3964s
	iters: 700, epoch: 4 | loss: 0.3455337
	speed: 0.0107s/iter; left time: 48.2962s
	iters: 800, epoch: 4 | loss: 0.4025966
	speed: 0.0094s/iter; left time: 41.4493s
	iters: 900, epoch: 4 | loss: 0.2697670
	speed: 0.0089s/iter; left time: 38.6048s
	iters: 1000, epoch: 4 | loss: 0.2734786
	speed: 0.0111s/iter; left time: 46.8457s
Updating learning rate to 0.00043041134855
Epoch: 4 cost time: 10.874930143356323
Epoch: 4, Steps: 1045 | Train Loss: 0.3770348 Vali Loss: 0.3229589 Best vali loss: 0.3202285
	iters: 100, epoch: 5 | loss: 1.2585214
	speed: 0.0314s/iter; left time: 128.3445s
	iters: 200, epoch: 5 | loss: 1.0866702
	speed: 0.0105s/iter; left time: 41.9542s
	iters: 300, epoch: 5 | loss: 1.1941332
	speed: 0.0105s/iter; left time: 40.7893s
	iters: 400, epoch: 5 | loss: 0.1413849
	speed: 0.0105s/iter; left time: 39.7236s
	iters: 500, epoch: 5 | loss: 0.9963560
	speed: 0.0104s/iter; left time: 38.3265s
	iters: 600, epoch: 5 | loss: 1.1877832
	speed: 0.0106s/iter; left time: 38.0021s
	iters: 700, epoch: 5 | loss: 1.0239289
	speed: 0.0104s/iter; left time: 36.1110s
	iters: 800, epoch: 5 | loss: 2.1777761
	speed: 0.0103s/iter; left time: 34.9092s
	iters: 900, epoch: 5 | loss: 0.4211812
	speed: 0.0104s/iter; left time: 34.1815s
	iters: 1000, epoch: 5 | loss: 0.2221407
	speed: 0.0101s/iter; left time: 32.0187s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009946628485, 'e_layers': 1, 'learning_rate': 0.0001665995443, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4812997
	speed: 0.0121s/iter; left time: 24.1433s
	iters: 200, epoch: 1 | loss: 0.9337897
	speed: 0.0063s/iter; left time: 11.8976s
Updating learning rate to 0.0001665995443
Validation loss decreased (inf --> 0.3120).  Saving model state dict ...
Epoch: 1 cost time: 1.9086129665374756
Epoch: 1, Steps: 262 | Train Loss: 0.7075447 Vali Loss: 0.3119810 Best vali loss: 0.3119810
	iters: 100, epoch: 2 | loss: 0.4000425
	speed: 0.0185s/iter; left time: 32.1683s
	iters: 200, epoch: 2 | loss: 0.4845377
	speed: 0.0058s/iter; left time: 9.4327s
Updating learning rate to 8.329977215e-05
Validation loss decreased (0.3120 --> 0.2955).  Saving model state dict ...
Epoch: 2 cost time: 1.5753443241119385
Epoch: 2, Steps: 262 | Train Loss: 0.4422901 Vali Loss: 0.2954836 Best vali loss: 0.2954836
	iters: 100, epoch: 3 | loss: 0.6447967
	speed: 0.0134s/iter; left time: 19.7703s
	iters: 200, epoch: 3 | loss: 0.4274731
	speed: 0.0062s/iter; left time: 8.5461s
Updating learning rate to 4.1649886075e-05
Validation loss decreased (0.2955 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 1.585399866104126
Epoch: 3, Steps: 262 | Train Loss: 0.5361349 Vali Loss: 0.2905731 Best vali loss: 0.2905731
	iters: 100, epoch: 4 | loss: 0.4154877
	speed: 0.0138s/iter; left time: 16.6529s
	iters: 200, epoch: 4 | loss: 0.7075770
	speed: 0.0064s/iter; left time: 7.1636s
Updating learning rate to 2.08249430375e-05
Validation loss decreased (0.2906 --> 0.2886).  Saving model state dict ...
Epoch: 4 cost time: 1.699202537536621
Epoch: 4, Steps: 262 | Train Loss: 0.5615324 Vali Loss: 0.2886121 Best vali loss: 0.2886121
	iters: 100, epoch: 5 | loss: 0.5005131
	speed: 0.0144s/iter; left time: 13.6728s
	iters: 200, epoch: 5 | loss: 0.3087515
	speed: 0.0058s/iter; left time: 4.9530s
Updating learning rate to 1.041247151875e-05
Validation loss decreased (0.2886 --> 0.2878).  Saving model state dict ...
Epoch: 5 cost time: 1.575197696685791
Epoch: 5, Steps: 262 | Train Loss: 0.4046323 Vali Loss: 0.2877700 Best vali loss: 0.2877700
	iters: 100, epoch: 6 | loss: 0.6757103
	speed: 0.0141s/iter; left time: 9.6542s
	iters: 200, epoch: 6 | loss: 0.7936056
	speed: 0.0070s/iter; left time: 4.1207s
Updating learning rate to 5.206235759375e-06
Validation loss decreased (0.2878 --> 0.2874).  Saving model state dict ...
Epoch: 6 cost time: 1.7634820938110352
Epoch: 6, Steps: 262 | Train Loss: 0.7346580 Vali Loss: 0.2873786 Best vali loss: 0.2873786
	iters: 100, epoch: 7 | loss: 0.6432685
	speed: 0.0122s/iter; left time: 5.2040s
	iters: 200, epoch: 7 | loss: 0.2313265
	speed: 0.0037s/iter; left time: 1.2148s
Updating learning rate to 2.6031178796875e-06
Validation loss decreased (0.2874 --> 0.2872).  Saving model state dict ...
Epoch: 7 cost time: 1.131826400756836
Epoch: 7, Steps: 262 | Train Loss: 0.4372975 Vali Loss: 0.2871996 Best vali loss: 0.2871996
	iters: 100, epoch: 8 | loss: 0.4078097
	speed: 0.0149s/iter; left time: 2.4256s
	iters: 200, epoch: 8 | loss: 0.4756518
	speed: 0.0059s/iter; left time: 0.3702s
Updating learning rate to 1.30155893984375e-06
Validation loss decreased (0.2872 --> 0.2871).  Saving model state dict ...
Epoch: 8 cost time: 1.6489014625549316
Epoch: 8, Steps: 262 | Train Loss: 0.4417307 Vali Loss: 0.2871160 Best vali loss: 0.2871160

best validation loss 0.287115951482582

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0014121922571, 'e_layers': 2, 'learning_rate': 0.0005012943918, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5316261
	speed: 0.0371s/iter; left time: 35.2002s
Updating learning rate to 0.0004822150100733569
Validation loss decreased (inf --> 0.2925).  Saving model state dict ...
Epoch: 1 cost time: 4.221762657165527
Epoch: 1, Steps: 131 | Train Loss: 0.5316261 Vali Loss: 0.2925091 Best vali loss: 0.2925091
	iters: 100, epoch: 2 | loss: 0.5395475
	speed: 0.0599s/iter; left time: 48.9855s
Updating learning rate to 0.000427881527806283
Validation loss decreased (0.2925 --> 0.2851).  Saving model state dict ...
Epoch: 2 cost time: 3.8406550884246826
Epoch: 2, Steps: 131 | Train Loss: 0.5395475 Vali Loss: 0.2850891 Best vali loss: 0.2850891
	iters: 100, epoch: 3 | loss: 0.8092641
	speed: 0.0450s/iter; left time: 30.8943s
Updating learning rate to 0.00034656572513969705
Validation loss decreased (0.2851 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 2.3045494556427
Epoch: 3, Steps: 131 | Train Loss: 0.8092641 Vali Loss: 0.2838782 Best vali loss: 0.2838782

best validation loss 0.2838782390926619

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0061589744518, 'e_layers': 1, 'learning_rate': 0.003977029424, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4763161
	speed: 0.0255s/iter; left time: 24.2244s
Updating learning rate to 0.003977029424
Validation loss decreased (inf --> 0.2866).  Saving model state dict ...
Epoch: 1 cost time: 2.7419357299804688
Epoch: 1, Steps: 131 | Train Loss: 0.4763161 Vali Loss: 0.2865668 Best vali loss: 0.2865668
	iters: 100, epoch: 2 | loss: 0.7513587
	speed: 0.0235s/iter; left time: 19.2059s
Updating learning rate to 0.001988514712
Epoch: 2 cost time: 1.723156213760376
Epoch: 2, Steps: 131 | Train Loss: 0.7513587 Vali Loss: 0.2945671 Best vali loss: 0.2865668
	iters: 100, epoch: 3 | loss: 0.5780435
	speed: 0.0207s/iter; left time: 14.2430s
Updating learning rate to 0.000994257356
Epoch: 3 cost time: 1.754058837890625
Epoch: 3, Steps: 131 | Train Loss: 0.5780435 Vali Loss: 0.3080456 Best vali loss: 0.2865668

best validation loss 0.2865668249622336

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022668094658243945
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 0.7798452377319336
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2839541 Best vali loss: 0.2839541
Updating learning rate to 0.0020113971511072134
Epoch: 2 cost time: 0.6383349895477295
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2857713 Best vali loss: 0.2839541
Updating learning rate to 0.0016291456090457483
Epoch: 3 cost time: 0.6281845569610596
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2945118 Best vali loss: 0.2839541

best validation loss 0.28395405915999067

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0014121922571, 'e_layers': 2, 'learning_rate': 0.0005012943918, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4822806
	speed: 0.0150s/iter; left time: 8.3408s
Updating learning rate to 0.0002506471959
Epoch: 4 cost time: 1.3892381191253662
Epoch: 4, Steps: 131 | Train Loss: 0.4822806 Vali Loss: 0.2845276 Best vali loss: 0.2838782
	iters: 100, epoch: 5 | loss: 0.4998416
	speed: 0.0134s/iter; left time: 5.7024s
Updating learning rate to 0.00015472866666030294
Epoch: 5 cost time: 1.0848758220672607
Epoch: 5, Steps: 131 | Train Loss: 0.4998416 Vali Loss: 0.2874076 Best vali loss: 0.2838782
	iters: 100, epoch: 6 | loss: 0.7552894
	speed: 0.0133s/iter; left time: 3.8985s
Updating learning rate to 7.3412863993717e-05
Epoch: 6 cost time: 1.079289197921753
Epoch: 6, Steps: 131 | Train Loss: 0.7552894 Vali Loss: 0.2866800 Best vali loss: 0.2838782
	iters: 100, epoch: 7 | loss: 0.5424226
	speed: 0.0132s/iter; left time: 2.1518s
Updating learning rate to 1.9079381726643094e-05
Epoch: 7 cost time: 1.275926113128662
Epoch: 7, Steps: 131 | Train Loss: 0.5424226 Vali Loss: 0.2866192 Best vali loss: 0.2838782
	iters: 100, epoch: 8 | loss: 0.5116939
	speed: 0.0190s/iter; left time: 0.6069s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.252718448638916
Epoch: 8, Steps: 131 | Train Loss: 0.5116939 Vali Loss: 0.2868976 Best vali loss: 0.2838782

best validation loss 0.2838782390926619

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0021061195851, 'e_layers': 4, 'learning_rate': 0.003460388698, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003460388698
Validation loss decreased (inf --> 0.2933).  Saving model state dict ...
Epoch: 1 cost time: 1.0226163864135742
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2932511 Best vali loss: 0.2932511
Updating learning rate to 0.001730194349
Epoch: 2 cost time: 0.7055399417877197
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3039264 Best vali loss: 0.2932511
Updating learning rate to 0.0008650971745
Validation loss decreased (0.2933 --> 0.2917).  Saving model state dict ...
Epoch: 3 cost time: 0.7024393081665039
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2916991 Best vali loss: 0.2916991
Updating learning rate to 0.00043254858725
Epoch: 4 cost time: 0.7386212348937988
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2957412 Best vali loss: 0.2916991
Updating learning rate to 0.000216274293625
Epoch: 5 cost time: 0.7056355476379395
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2965429 Best vali loss: 0.2916991
Updating learning rate to 0.0001081371468125
Epoch: 6 cost time: 0.7151081562042236
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3020157 Best vali loss: 0.2916991
Updating learning rate to 5.406857340625e-05
Epoch: 7 cost time: 0.6971228122711182
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2996957 Best vali loss: 0.2916991
Updating learning rate to 2.7034286703125e-05
Epoch: 8 cost time: 1.082599401473999
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3011533 Best vali loss: 0.2916991

best validation loss 0.29169907484324104

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3636844
	speed: 0.0156s/iter; left time: 63.6708s
	iters: 200, epoch: 1 | loss: 0.8879618
	speed: 0.0082s/iter; left time: 32.8643s
	iters: 300, epoch: 1 | loss: 0.5116999
	speed: 0.0084s/iter; left time: 32.7983s
	iters: 400, epoch: 1 | loss: 0.5042920
	speed: 0.0083s/iter; left time: 31.2917s
	iters: 500, epoch: 1 | loss: 0.4345138
	speed: 0.0080s/iter; left time: 29.4831s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.3107).  Saving model state dict ...
Epoch: 1 cost time: 4.751240253448486
Epoch: 1, Steps: 523 | Train Loss: 0.7404304 Vali Loss: 0.3106593 Best vali loss: 0.3106593
	iters: 100, epoch: 2 | loss: 0.4225475
	speed: 0.0186s/iter; left time: 66.1410s
	iters: 200, epoch: 2 | loss: 0.6663818
	speed: 0.0081s/iter; left time: 27.8733s
	iters: 300, epoch: 2 | loss: 0.3507220
	speed: 0.0083s/iter; left time: 27.9682s
	iters: 400, epoch: 2 | loss: 1.0521784
	speed: 0.0079s/iter; left time: 25.7735s
	iters: 500, epoch: 2 | loss: 1.0567991
	speed: 0.0081s/iter; left time: 25.6364s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 4.317805767059326
Epoch: 2, Steps: 523 | Train Loss: 0.7097257 Vali Loss: 0.3223092 Best vali loss: 0.3106593
	iters: 100, epoch: 3 | loss: 0.3417441
	speed: 0.0174s/iter; left time: 53.0196s
	iters: 200, epoch: 3 | loss: 0.8866845
	speed: 0.0080s/iter; left time: 23.3744s
	iters: 300, epoch: 3 | loss: 0.4169613
	speed: 0.0079s/iter; left time: 22.4985s
	iters: 400, epoch: 3 | loss: 0.7709268
	speed: 0.0082s/iter; left time: 22.4662s
	iters: 500, epoch: 3 | loss: 1.3213515
	speed: 0.0079s/iter; left time: 20.8792s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 4.2354888916015625
Epoch: 3, Steps: 523 | Train Loss: 0.7475337 Vali Loss: 0.3216237 Best vali loss: 0.3106593
	iters: 100, epoch: 4 | loss: 0.5074483
	speed: 0.0173s/iter; left time: 43.4732s
	iters: 200, epoch: 4 | loss: 0.8516012
	speed: 0.0076s/iter; left time: 18.3377s
	iters: 300, epoch: 4 | loss: 0.4076993
	speed: 0.0081s/iter; left time: 18.6615s
	iters: 400, epoch: 4 | loss: 1.0934150
	speed: 0.0079s/iter; left time: 17.6047s
	iters: 500, epoch: 4 | loss: 0.4420324
	speed: 0.0084s/iter; left time: 17.7534s
Updating learning rate to 0.00109417918315
Epoch: 4 cost time: 4.243738412857056
Epoch: 4, Steps: 523 | Train Loss: 0.6604393 Vali Loss: 0.3216503 Best vali loss: 0.3106593
	iters: 100, epoch: 5 | loss: 1.1796877
	speed: 0.0179s/iter; left time: 35.6853s
	iters: 200, epoch: 5 | loss: 0.3416407
	speed: 0.0081s/iter; left time: 15.4176s
	iters: 300, epoch: 5 | loss: 0.3620797
	speed: 0.0077s/iter; left time: 13.8040s
	iters: 400, epoch: 5 | loss: 0.7503703
	speed: 0.0081s/iter; left time: 13.7969s
	iters: 500, epoch: 5 | loss: 0.3740371
	speed: 0.0071s/iter; left time: 11.3524s
Updating learning rate to 0.0006754549377197279
Epoch: 5 cost time: 4.130215167999268
Epoch: 5, Steps: 523 | Train Loss: 0.6015631 Vali Loss: 0.3216324 Best vali loss: 0.3106593
	iters: 100, epoch: 6 | loss: 0.3075515
	speed: 0.0152s/iter; left time: 22.3484s
	iters: 200, epoch: 6 | loss: 0.4150385
	speed: 0.0081s/iter; left time: 11.1318s
	iters: 300, epoch: 6 | loss: 0.4051047
	speed: 0.0076s/iter; left time: 9.6845s
	iters: 400, epoch: 6 | loss: 0.4943815
	speed: 0.0072s/iter; left time: 8.4418s
	iters: 500, epoch: 6 | loss: 0.4146031
	speed: 0.0065s/iter; left time: 6.9450s
Updating learning rate to 0.0003204776629114777
Epoch: 6 cost time: 3.8649837970733643
Epoch: 6, Steps: 523 | Train Loss: 0.4073359 Vali Loss: 0.3213019 Best vali loss: 0.3106593
	iters: 100, epoch: 7 | loss: 0.5997314
	speed: 0.0156s/iter; left time: 14.7949s
	iters: 200, epoch: 7 | loss: 0.4715368
	speed: 0.0087s/iter; left time: 7.3367s
	iters: 300, epoch: 7 | loss: 0.4682501
	speed: 0.0085s/iter; left time: 6.3358s
	iters: 400, epoch: 7 | loss: 0.9703836
	speed: 0.0078s/iter; left time: 5.0397s
	iters: 500, epoch: 7 | loss: 0.3280044
	speed: 0.0071s/iter; left time: 3.8736s
Updating learning rate to 8.32894309377964e-05
Epoch: 7 cost time: 4.3584394454956055
Epoch: 7, Steps: 523 | Train Loss: 0.5675813 Vali Loss: 0.3223175 Best vali loss: 0.3106593
	iters: 100, epoch: 8 | loss: 1.8654433
	speed: 0.0261s/iter; left time: 11.0481s
	iters: 200, epoch: 8 | loss: 0.3020537
	speed: 0.0125s/iter; left time: 4.0487s
	iters: 300, epoch: 8 | loss: 0.4486594
	speed: 0.0110s/iter; left time: 2.4721s
	iters: 400, epoch: 8 | loss: 0.2299681
	speed: 0.0138s/iter; left time: 1.7058s
	iters: 500, epoch: 8 | loss: 0.4716634
	speed: 0.0166s/iter; left time: 0.3976s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.896711349487305
Epoch: 8, Steps: 523 | Train Loss: 0.6635576 Vali Loss: 0.3222531 Best vali loss: 0.3106593

best validation loss 0.31065933185800293

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0008377038747, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5169185
	speed: 0.0267s/iter; left time: 25.3584s
Updating learning rate to 0.0002742177349779177
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 2.9240152835845947
Epoch: 1, Steps: 131 | Train Loss: 0.5169185 Vali Loss: 0.2878796 Best vali loss: 0.2878796
	iters: 100, epoch: 2 | loss: 0.6548113
	speed: 0.0327s/iter; left time: 26.7227s
Updating learning rate to 0.00024332030513956964
Validation loss decreased (0.2879 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 2.560288190841675
Epoch: 2, Steps: 131 | Train Loss: 0.6548113 Vali Loss: 0.2829788 Best vali loss: 0.2829788
	iters: 100, epoch: 3 | loss: 0.5737156
	speed: 0.0305s/iter; left time: 20.9363s
Updating learning rate to 0.00019707903359194527
Epoch: 3 cost time: 2.5587658882141113
Epoch: 3, Steps: 131 | Train Loss: 0.5737156 Vali Loss: 0.2854779 Best vali loss: 0.2829788

best validation loss 0.2829788368833956

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0028867448881, 'e_layers': 4, 'learning_rate': 0.0003383725477, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4427280
	speed: 0.0231s/iter; left time: 21.9303s
Updating learning rate to 0.0003383725477
Validation loss decreased (inf --> 0.2871).  Saving model state dict ...
Epoch: 1 cost time: 2.5280823707580566
Epoch: 1, Steps: 131 | Train Loss: 0.4427280 Vali Loss: 0.2871401 Best vali loss: 0.2871401
	iters: 100, epoch: 2 | loss: 0.3427493
	speed: 0.0339s/iter; left time: 27.7096s
Updating learning rate to 0.00016918627385
Validation loss decreased (0.2871 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 2.8476836681365967
Epoch: 2, Steps: 131 | Train Loss: 0.3427493 Vali Loss: 0.2835761 Best vali loss: 0.2835761
	iters: 100, epoch: 3 | loss: 0.5107854
	speed: 0.0315s/iter; left time: 21.6145s
Updating learning rate to 8.4593136925e-05
Validation loss decreased (0.2836 --> 0.2821).  Saving model state dict ...
Epoch: 3 cost time: 2.030040740966797
Epoch: 3, Steps: 131 | Train Loss: 0.5107854 Vali Loss: 0.2820969 Best vali loss: 0.2820969

best validation loss 0.2820968977599926

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0109034907503, 'e_layers': 3, 'learning_rate': 0.0007693898904, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6679619
	speed: 0.0156s/iter; left time: 31.1927s
	iters: 200, epoch: 1 | loss: 0.5255233
	speed: 0.0118s/iter; left time: 22.4256s
Updating learning rate to 0.0007401067313308311
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 3.1888985633850098
Epoch: 1, Steps: 262 | Train Loss: 0.5967426 Vali Loss: 0.2856254 Best vali loss: 0.2856254
	iters: 100, epoch: 2 | loss: 0.5806597
	speed: 0.0371s/iter; left time: 64.3933s
	iters: 200, epoch: 2 | loss: 0.5543049
	speed: 0.0118s/iter; left time: 19.3502s
Updating learning rate to 0.0006567153496391073
Validation loss decreased (0.2856 --> 0.2852).  Saving model state dict ...
Epoch: 2 cost time: 3.2372968196868896
Epoch: 2, Steps: 262 | Train Loss: 0.5674823 Vali Loss: 0.2852331 Best vali loss: 0.2852331
	iters: 100, epoch: 3 | loss: 0.3482440
	speed: 0.0315s/iter; left time: 46.4705s
	iters: 200, epoch: 3 | loss: 0.3616324
	speed: 0.0116s/iter; left time: 15.9402s
Updating learning rate to 0.0005319113272426361
Validation loss decreased (0.2852 --> 0.2825).  Saving model state dict ...
Epoch: 3 cost time: 2.757596015930176
Epoch: 3, Steps: 262 | Train Loss: 0.3549382 Vali Loss: 0.2825432 Best vali loss: 0.2825432

best validation loss 0.28254319645960385

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0028867448881, 'e_layers': 4, 'learning_rate': 0.0003383725477, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4099264
	speed: 0.0282s/iter; left time: 15.6639s
Updating learning rate to 4.22965684625e-05
Validation loss decreased (0.2821 --> 0.2816).  Saving model state dict ...
Epoch: 4 cost time: 3.0616719722747803
Epoch: 4, Steps: 131 | Train Loss: 0.4099264 Vali Loss: 0.2816403 Best vali loss: 0.2816403
	iters: 100, epoch: 5 | loss: 0.3323388
	speed: 0.0342s/iter; left time: 14.5438s
Updating learning rate to 2.114828423125e-05
Epoch: 5 cost time: 2.8749523162841797
Epoch: 5, Steps: 131 | Train Loss: 0.3323388 Vali Loss: 0.2820901 Best vali loss: 0.2816403
	iters: 100, epoch: 6 | loss: 0.4986898
	speed: 0.0211s/iter; left time: 6.1969s
Updating learning rate to 1.0574142115625e-05
Epoch: 6 cost time: 1.9021093845367432
Epoch: 6, Steps: 131 | Train Loss: 0.4986898 Vali Loss: 0.2820608 Best vali loss: 0.2816403
	iters: 100, epoch: 7 | loss: 0.6418400
	speed: 0.0348s/iter; left time: 5.6715s
Updating learning rate to 5.2870710578125e-06
Epoch: 7 cost time: 2.790163993835449
Epoch: 7, Steps: 131 | Train Loss: 0.6418400 Vali Loss: 0.2822157 Best vali loss: 0.2816403
	iters: 100, epoch: 8 | loss: 0.5050508
	speed: 0.0273s/iter; left time: 0.8746s
Updating learning rate to 2.64353552890625e-06
Epoch: 8 cost time: 1.681823492050171
Epoch: 8, Steps: 131 | Train Loss: 0.5050508 Vali Loss: 0.2822660 Best vali loss: 0.2816403

best validation loss 0.2816403354464432

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009909717048, 'e_layers': 2, 'learning_rate': 0.0008180744789, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5239366
	speed: 0.0134s/iter; left time: 110.4367s
	iters: 200, epoch: 1 | loss: 0.2497412
	speed: 0.0062s/iter; left time: 50.2786s
	iters: 300, epoch: 1 | loss: 0.3893266
	speed: 0.0056s/iter; left time: 45.0379s
	iters: 400, epoch: 1 | loss: 0.3048063
	speed: 0.0048s/iter; left time: 38.4610s
	iters: 500, epoch: 1 | loss: 0.9817538
	speed: 0.0067s/iter; left time: 52.3201s
	iters: 600, epoch: 1 | loss: 0.3671906
	speed: 0.0061s/iter; left time: 47.1783s
	iters: 700, epoch: 1 | loss: 0.4853612
	speed: 0.0055s/iter; left time: 42.3241s
	iters: 800, epoch: 1 | loss: 0.3695754
	speed: 0.0059s/iter; left time: 44.4145s
	iters: 900, epoch: 1 | loss: 0.3511107
	speed: 0.0061s/iter; left time: 45.6421s
	iters: 1000, epoch: 1 | loss: 0.4407529
	speed: 0.0062s/iter; left time: 45.2732s
Updating learning rate to 0.0007869383730127732
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 6.637838363647461
Epoch: 1, Steps: 1045 | Train Loss: 0.4463555 Vali Loss: 0.3217758 Best vali loss: 0.3217758
	iters: 100, epoch: 2 | loss: 0.3369237
	speed: 0.0210s/iter; left time: 151.6940s
	iters: 200, epoch: 2 | loss: 1.4172568
	speed: 0.0058s/iter; left time: 41.3432s
	iters: 300, epoch: 2 | loss: 0.4802921
	speed: 0.0055s/iter; left time: 38.8170s
	iters: 400, epoch: 2 | loss: 1.7415264
	speed: 0.0045s/iter; left time: 31.0184s
	iters: 500, epoch: 2 | loss: 1.0743520
	speed: 0.0040s/iter; left time: 27.2690s
	iters: 600, epoch: 2 | loss: 0.4295209
	speed: 0.0043s/iter; left time: 28.7738s
	iters: 700, epoch: 2 | loss: 0.7950554
	speed: 0.0067s/iter; left time: 44.0713s
	iters: 800, epoch: 2 | loss: 0.2871425
	speed: 0.0075s/iter; left time: 48.6663s
	iters: 900, epoch: 2 | loss: 0.4540197
	speed: 0.0085s/iter; left time: 54.2667s
	iters: 1000, epoch: 2 | loss: 0.3087232
	speed: 0.0077s/iter; left time: 48.7122s
Updating learning rate to 0.0006982702452229205
Epoch: 2 cost time: 6.403953552246094
Epoch: 2, Steps: 1045 | Train Loss: 0.7324813 Vali Loss: 0.3237524 Best vali loss: 0.3217758
	iters: 100, epoch: 3 | loss: 0.2883956
	speed: 0.0272s/iter; left time: 167.5717s
	iters: 200, epoch: 3 | loss: 0.7010618
	speed: 0.0102s/iter; left time: 61.8805s
	iters: 300, epoch: 3 | loss: 1.3434085
	speed: 0.0123s/iter; left time: 73.3840s
	iters: 400, epoch: 3 | loss: 0.5333022
	speed: 0.0109s/iter; left time: 64.1879s
	iters: 500, epoch: 3 | loss: 0.4106344
	speed: 0.0118s/iter; left time: 68.3431s
	iters: 600, epoch: 3 | loss: 0.1977411
	speed: 0.0125s/iter; left time: 70.6940s
	iters: 700, epoch: 3 | loss: 0.6163091
	speed: 0.0099s/iter; left time: 55.1539s
	iters: 800, epoch: 3 | loss: 0.9325908
	speed: 0.0119s/iter; left time: 64.9150s
	iters: 900, epoch: 3 | loss: 0.2437022
	speed: 0.0115s/iter; left time: 61.6196s
	iters: 1000, epoch: 3 | loss: 0.4285694
	speed: 0.0078s/iter; left time: 41.2182s
Updating learning rate to 0.0005655690142078671
Epoch: 3 cost time: 11.089987754821777
Epoch: 3, Steps: 1045 | Train Loss: 0.5695715 Vali Loss: 0.3244882 Best vali loss: 0.3217758
	iters: 100, epoch: 4 | loss: 0.7368025
	speed: 0.0343s/iter; left time: 175.8711s
	iters: 200, epoch: 4 | loss: 1.9481205
	speed: 0.0098s/iter; left time: 49.2156s
	iters: 300, epoch: 4 | loss: 0.9819958
	speed: 0.0081s/iter; left time: 40.0826s
	iters: 400, epoch: 4 | loss: 0.9048133
	speed: 0.0077s/iter; left time: 36.9754s
	iters: 500, epoch: 4 | loss: 0.8425736
	speed: 0.0121s/iter; left time: 57.3725s
	iters: 600, epoch: 4 | loss: 1.3235065
	speed: 0.0120s/iter; left time: 55.6662s
	iters: 700, epoch: 4 | loss: 0.7375494
	speed: 0.0102s/iter; left time: 46.3387s
	iters: 800, epoch: 4 | loss: 0.4022713
	speed: 0.0117s/iter; left time: 51.9752s
	iters: 900, epoch: 4 | loss: 0.2402737
	speed: 0.0105s/iter; left time: 45.5692s
	iters: 1000, epoch: 4 | loss: 0.5482417
	speed: 0.0110s/iter; left time: 46.3525s
Updating learning rate to 0.00040903723945
Epoch: 4 cost time: 10.82044792175293
Epoch: 4, Steps: 1045 | Train Loss: 0.8666148 Vali Loss: 0.3256306 Best vali loss: 0.3217758
	iters: 100, epoch: 5 | loss: 0.1923443
	speed: 0.0444s/iter; left time: 181.2819s
	iters: 200, epoch: 5 | loss: 0.3369325
	speed: 0.0109s/iter; left time: 43.5794s
	iters: 300, epoch: 5 | loss: 0.3932196
	speed: 0.0124s/iter; left time: 47.9911s
	iters: 400, epoch: 5 | loss: 0.4907147
	speed: 0.0104s/iter; left time: 39.1913s
	iters: 500, epoch: 5 | loss: 0.3205655
	speed: 0.0070s/iter; left time: 25.9158s
	iters: 600, epoch: 5 | loss: 0.4837981
	speed: 0.0090s/iter; left time: 32.1660s
	iters: 700, epoch: 5 | loss: 0.3368663
	speed: 0.0103s/iter; left time: 35.9152s
	iters: 800, epoch: 5 | loss: 1.4424685
	speed: 0.0098s/iter; left time: 33.1772s
	iters: 900, epoch: 5 | loss: 0.1703188
	speed: 0.0102s/iter; left time: 33.6191s
	iters: 1000, epoch: 5 | loss: 1.3007166
	speed: 0.0086s/iter; left time: 27.4447s
Updating learning rate to 0.0002525054646921329
Validation loss decreased (0.3218 --> 0.3198).  Saving model state dict ...
Epoch: 5 cost time: 10.516639947891235
Epoch: 5, Steps: 1045 | Train Loss: 0.5467945 Vali Loss: 0.3197506 Best vali loss: 0.3197506
	iters: 100, epoch: 6 | loss: 1.3053918
	speed: 0.0346s/iter; left time: 105.1004s
	iters: 200, epoch: 6 | loss: 1.3821672
	speed: 0.0106s/iter; left time: 31.1730s
	iters: 300, epoch: 6 | loss: 1.9400980
	speed: 0.0098s/iter; left time: 27.6812s
	iters: 400, epoch: 6 | loss: 1.0786895
	speed: 0.0104s/iter; left time: 28.4523s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0030171201133, 'e_layers': 4, 'learning_rate': 0.0002007150185, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4574415
	speed: 0.0206s/iter; left time: 169.9229s
	iters: 200, epoch: 1 | loss: 0.3377347
	speed: 0.0134s/iter; left time: 109.3455s
	iters: 300, epoch: 1 | loss: 0.6313533
	speed: 0.0112s/iter; left time: 90.0234s
	iters: 400, epoch: 1 | loss: 1.0963868
	speed: 0.0122s/iter; left time: 96.9107s
	iters: 500, epoch: 1 | loss: 1.3026899
	speed: 0.0098s/iter; left time: 77.1344s
	iters: 600, epoch: 1 | loss: 0.3986132
	speed: 0.0120s/iter; left time: 92.8905s
	iters: 700, epoch: 1 | loss: 0.2596663
	speed: 0.0122s/iter; left time: 93.5422s
	iters: 800, epoch: 1 | loss: 0.2890077
	speed: 0.0118s/iter; left time: 89.4755s
	iters: 900, epoch: 1 | loss: 0.3942699
	speed: 0.0098s/iter; left time: 73.1463s
	iters: 1000, epoch: 1 | loss: 0.2632210
	speed: 0.0095s/iter; left time: 70.0081s
Updating learning rate to 0.00019307575797988713
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 12.428799390792847
Epoch: 1, Steps: 1045 | Train Loss: 0.5430384 Vali Loss: 0.2857987 Best vali loss: 0.2857987
	iters: 100, epoch: 2 | loss: 1.3350067
	speed: 0.0272s/iter; left time: 196.0766s
	iters: 200, epoch: 2 | loss: 0.2307787
	speed: 0.0070s/iter; left time: 50.0447s
	iters: 300, epoch: 2 | loss: 0.5076993
	speed: 0.0081s/iter; left time: 56.5542s
	iters: 400, epoch: 2 | loss: 0.7363723
	speed: 0.0081s/iter; left time: 55.7197s
	iters: 500, epoch: 2 | loss: 0.3008667
	speed: 0.0072s/iter; left time: 49.1804s
	iters: 600, epoch: 2 | loss: 0.2980440
	speed: 0.0077s/iter; left time: 51.5497s
	iters: 700, epoch: 2 | loss: 0.7973101
	speed: 0.0090s/iter; left time: 59.5882s
	iters: 800, epoch: 2 | loss: 0.4428462
	speed: 0.0105s/iter; left time: 68.4724s
	iters: 900, epoch: 2 | loss: 1.3057168
	speed: 0.0101s/iter; left time: 64.8334s
	iters: 1000, epoch: 2 | loss: 0.4030571
	speed: 0.0097s/iter; left time: 61.1700s
Updating learning rate to 0.00017132098458366666
Epoch: 2 cost time: 8.98134183883667
Epoch: 2, Steps: 1045 | Train Loss: 0.6357698 Vali Loss: 0.2875995 Best vali loss: 0.2857987
	iters: 100, epoch: 3 | loss: 0.6328691
	speed: 0.0288s/iter; left time: 177.6439s
	iters: 200, epoch: 3 | loss: 0.2287580
	speed: 0.0113s/iter; left time: 68.7245s
	iters: 300, epoch: 3 | loss: 0.3768356
	speed: 0.0078s/iter; left time: 46.3209s
	iters: 400, epoch: 3 | loss: 0.3582165
	speed: 0.0063s/iter; left time: 37.1434s
	iters: 500, epoch: 3 | loss: 0.6030306
	speed: 0.0069s/iter; left time: 40.0502s
	iters: 600, epoch: 3 | loss: 0.3476072
	speed: 0.0091s/iter; left time: 51.5687s
	iters: 700, epoch: 3 | loss: 1.4967033
	speed: 0.0079s/iter; left time: 44.1573s
	iters: 800, epoch: 3 | loss: 0.2638755
	speed: 0.0087s/iter; left time: 47.5126s
	iters: 900, epoch: 3 | loss: 1.2470701
	speed: 0.0095s/iter; left time: 50.9771s
	iters: 1000, epoch: 3 | loss: 1.1001066
	speed: 0.0083s/iter; left time: 43.7089s
Updating learning rate to 0.00013876266535340126
Epoch: 3 cost time: 8.962026834487915
Epoch: 3, Steps: 1045 | Train Loss: 0.6655072 Vali Loss: 0.2875050 Best vali loss: 0.2857987
	iters: 100, epoch: 4 | loss: 0.4106882
	speed: 0.0268s/iter; left time: 137.4253s
	iters: 200, epoch: 4 | loss: 1.1070334
	speed: 0.0082s/iter; left time: 41.0747s
	iters: 300, epoch: 4 | loss: 0.3606163
	speed: 0.0083s/iter; left time: 40.9693s
	iters: 400, epoch: 4 | loss: 0.3997857
	speed: 0.0087s/iter; left time: 42.1273s
	iters: 500, epoch: 4 | loss: 0.2848964
	speed: 0.0075s/iter; left time: 35.3069s
	iters: 600, epoch: 4 | loss: 0.2575330
	speed: 0.0075s/iter; left time: 34.5299s
	iters: 700, epoch: 4 | loss: 0.8404949
	speed: 0.0090s/iter; left time: 40.9574s
	iters: 800, epoch: 4 | loss: 0.3508278
	speed: 0.0086s/iter; left time: 38.1730s
	iters: 900, epoch: 4 | loss: 0.3647734
	speed: 0.0083s/iter; left time: 35.7446s
	iters: 1000, epoch: 4 | loss: 1.5478671
	speed: 0.0092s/iter; left time: 38.7933s
Updating learning rate to 0.00010035750925
Epoch: 4 cost time: 8.862422466278076
Epoch: 4, Steps: 1045 | Train Loss: 0.5924516 Vali Loss: 0.2858677 Best vali loss: 0.2857987
	iters: 100, epoch: 5 | loss: 1.5492321
	speed: 0.0262s/iter; left time: 106.7583s
	iters: 200, epoch: 5 | loss: 1.1109611
	speed: 0.0084s/iter; left time: 33.6368s
	iters: 300, epoch: 5 | loss: 1.6241020
	speed: 0.0093s/iter; left time: 36.0679s
	iters: 400, epoch: 5 | loss: 1.1224347
	speed: 0.0088s/iter; left time: 33.3746s
	iters: 500, epoch: 5 | loss: 0.5976706
	speed: 0.0076s/iter; left time: 27.9842s
	iters: 600, epoch: 5 | loss: 0.3825148
	speed: 0.0077s/iter; left time: 27.6063s
	iters: 700, epoch: 5 | loss: 0.3202033
	speed: 0.0098s/iter; left time: 34.2687s
	iters: 800, epoch: 5 | loss: 0.3374241
	speed: 0.0088s/iter; left time: 29.8603s
	iters: 900, epoch: 5 | loss: 0.2170058
	speed: 0.0093s/iter; left time: 30.3652s
	iters: 1000, epoch: 5 | loss: 0.3483492
	speed: 0.0093s/iter; left time: 29.4549s
Updating learning rate to 6.195235314659876e-05
Epoch: 5 cost time: 9.25456166267395
Epoch: 5, Steps: 1045 | Train Loss: 0.7609898 Vali Loss: 0.2878625 Best vali loss: 0.2857987
	iters: 100, epoch: 6 | loss: 0.3350478
	speed: 0.0277s/iter; left time: 84.2189s
	iters: 200, epoch: 6 | loss: 0.1360764
	speed: 0.0092s/iter; left time: 26.9368s
	iters: 300, epoch: 6 | loss: 1.0052695
	speed: 0.0103s/iter; left time: 29.0883s
	iters: 400, epoch: 6 | loss: 0.3744417
	speed: 0.0103s/iter; left time: 28.2989s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4943735
	speed: 0.0192s/iter; left time: 38.2553s
	iters: 200, epoch: 1 | loss: 0.4423126
	speed: 0.0128s/iter; left time: 24.2419s
Updating learning rate to 0.0002850674695
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 3.6609740257263184
Epoch: 1, Steps: 262 | Train Loss: 0.4683430 Vali Loss: 0.2846071 Best vali loss: 0.2846071
	iters: 100, epoch: 2 | loss: 0.5388127
	speed: 0.0316s/iter; left time: 54.8044s
	iters: 200, epoch: 2 | loss: 0.5488969
	speed: 0.0121s/iter; left time: 19.7737s
Updating learning rate to 0.00014253373475
Validation loss decreased (0.2846 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 3.009348154067993
Epoch: 2, Steps: 262 | Train Loss: 0.5438548 Vali Loss: 0.2823538 Best vali loss: 0.2823538
	iters: 100, epoch: 3 | loss: 0.7591466
	speed: 0.0240s/iter; left time: 35.3593s
	iters: 200, epoch: 3 | loss: 0.4600098
	speed: 0.0117s/iter; left time: 16.0053s
Updating learning rate to 7.1266867375e-05
Epoch: 3 cost time: 3.1456165313720703
Epoch: 3, Steps: 262 | Train Loss: 0.6095782 Vali Loss: 0.2859562 Best vali loss: 0.2823538

best validation loss 0.2823537550769627

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008267342166, 'e_layers': 4, 'learning_rate': 5.54518777e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7044293
	speed: 0.0264s/iter; left time: 25.0702s
Updating learning rate to 5.3341366273174527e-05
Validation loss decreased (inf --> 0.3399).  Saving model state dict ...
Epoch: 1 cost time: 2.7967350482940674
Epoch: 1, Steps: 131 | Train Loss: 0.7044293 Vali Loss: 0.3398683 Best vali loss: 0.3398683
	iters: 100, epoch: 2 | loss: 0.7061315
	speed: 0.0256s/iter; left time: 20.9445s
Updating learning rate to 4.733113822559855e-05
Validation loss decreased (0.3399 --> 0.3260).  Saving model state dict ...
Epoch: 2 cost time: 1.8738365173339844
Epoch: 2, Steps: 131 | Train Loss: 0.7061315 Vali Loss: 0.3259867 Best vali loss: 0.3259867
	iters: 100, epoch: 3 | loss: 0.5053038
	speed: 0.0304s/iter; left time: 20.9085s
Updating learning rate to 3.833619629466259e-05
Validation loss decreased (0.3260 --> 0.3170).  Saving model state dict ...
Epoch: 3 cost time: 2.617157459259033
Epoch: 3, Steps: 131 | Train Loss: 0.5053038 Vali Loss: 0.3169948 Best vali loss: 0.3169948

best validation loss 0.3169947526254544

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010382705628, 'e_layers': 3, 'learning_rate': 0.0008045612191, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7731481
	speed: 0.0168s/iter; left time: 33.6434s
	iters: 200, epoch: 1 | loss: 0.8123470
	speed: 0.0101s/iter; left time: 19.2261s
Updating learning rate to 0.0007739394310394095
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 3.041788339614868
Epoch: 1, Steps: 262 | Train Loss: 0.7927476 Vali Loss: 0.2862399 Best vali loss: 0.2862399
	iters: 100, epoch: 2 | loss: 0.4307242
	speed: 0.0293s/iter; left time: 50.8040s
	iters: 200, epoch: 2 | loss: 0.4318284
	speed: 0.0099s/iter; left time: 16.2452s
Updating learning rate to 0.0006867359565026628
Epoch: 2 cost time: 2.8012330532073975
Epoch: 2, Steps: 262 | Train Loss: 0.4312763 Vali Loss: 0.2939464 Best vali loss: 0.2862399
	iters: 100, epoch: 3 | loss: 0.4190494
	speed: 0.0312s/iter; left time: 46.0173s
	iters: 200, epoch: 3 | loss: 0.4626334
	speed: 0.0100s/iter; left time: 13.7223s
Updating learning rate to 0.0005562267339865145
Validation loss decreased (0.2862 --> 0.2831).  Saving model state dict ...
Epoch: 3 cost time: 2.777458429336548
Epoch: 3, Steps: 262 | Train Loss: 0.4408414 Vali Loss: 0.2830970 Best vali loss: 0.2830970

best validation loss 0.2830970341020377

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4594845
	speed: 0.0188s/iter; left time: 22.7388s
	iters: 200, epoch: 4 | loss: 0.4141280
	speed: 0.0125s/iter; left time: 13.9420s
Updating learning rate to 3.56334336875e-05
Epoch: 4 cost time: 3.4152233600616455
Epoch: 4, Steps: 262 | Train Loss: 0.4368063 Vali Loss: 0.2856387 Best vali loss: 0.2823538
	iters: 100, epoch: 5 | loss: 0.5080186
	speed: 0.0265s/iter; left time: 25.1460s
	iters: 200, epoch: 5 | loss: 0.4945623
	speed: 0.0128s/iter; left time: 10.8538s
Updating learning rate to 1.781671684375e-05
Epoch: 5 cost time: 3.2287843227386475
Epoch: 5, Steps: 262 | Train Loss: 0.5012904 Vali Loss: 0.2856995 Best vali loss: 0.2823538
	iters: 100, epoch: 6 | loss: 0.7050098
	speed: 0.0272s/iter; left time: 18.7117s
	iters: 200, epoch: 6 | loss: 0.4607047
	speed: 0.0125s/iter; left time: 7.3092s
Updating learning rate to 8.908358421875e-06
Epoch: 6 cost time: 3.1149914264678955
Epoch: 6, Steps: 262 | Train Loss: 0.5828572 Vali Loss: 0.2864197 Best vali loss: 0.2823538
	iters: 100, epoch: 7 | loss: 0.6400758
	speed: 0.0292s/iter; left time: 12.3888s
	iters: 200, epoch: 7 | loss: 0.2801770
	speed: 0.0111s/iter; left time: 3.5932s
Updating learning rate to 4.4541792109375e-06
Epoch: 7 cost time: 3.226321220397949
Epoch: 7, Steps: 262 | Train Loss: 0.4601264 Vali Loss: 0.2867879 Best vali loss: 0.2823538
	iters: 100, epoch: 8 | loss: 0.6285437
	speed: 0.0275s/iter; left time: 4.4854s
	iters: 200, epoch: 8 | loss: 0.6151941
	speed: 0.0125s/iter; left time: 0.7861s
Updating learning rate to 2.22708960546875e-06
Epoch: 8 cost time: 3.206312417984009
Epoch: 8, Steps: 262 | Train Loss: 0.6218689 Vali Loss: 0.2868430 Best vali loss: 0.2823538

best validation loss 0.2823537550769627

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0102976635799, 'e_layers': 4, 'learning_rate': 9.28932504e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3100918
	speed: 0.0171s/iter; left time: 69.8288s
	iters: 200, epoch: 1 | loss: 0.4728275
	speed: 0.0100s/iter; left time: 39.9253s
	iters: 300, epoch: 1 | loss: 0.6012155
	speed: 0.0099s/iter; left time: 38.3031s
	iters: 400, epoch: 1 | loss: 0.4957663
	speed: 0.0094s/iter; left time: 35.4607s
	iters: 500, epoch: 1 | loss: 0.8233961
	speed: 0.0090s/iter; left time: 33.2536s
Updating learning rate to 8.935771157650295e-05
Validation loss decreased (inf --> 0.2950).  Saving model state dict ...
Epoch: 1 cost time: 5.44718861579895
Epoch: 1, Steps: 523 | Train Loss: 0.5406594 Vali Loss: 0.2950208 Best vali loss: 0.2950208
	iters: 100, epoch: 2 | loss: 0.3183500
	speed: 0.0206s/iter; left time: 73.3366s
	iters: 200, epoch: 2 | loss: 0.9268383
	speed: 0.0091s/iter; left time: 31.4469s
	iters: 300, epoch: 2 | loss: 0.6117721
	speed: 0.0091s/iter; left time: 30.4368s
	iters: 400, epoch: 2 | loss: 0.5262090
	speed: 0.0089s/iter; left time: 28.9428s
	iters: 500, epoch: 2 | loss: 0.9376509
	speed: 0.0083s/iter; left time: 26.3794s
Updating learning rate to 7.928934884214998e-05
Validation loss decreased (0.2950 --> 0.2855).  Saving model state dict ...
Epoch: 2 cost time: 4.854467153549194
Epoch: 2, Steps: 523 | Train Loss: 0.6641640 Vali Loss: 0.2854716 Best vali loss: 0.2854716
	iters: 100, epoch: 3 | loss: 0.2520280
	speed: 0.0223s/iter; left time: 67.7344s
	iters: 200, epoch: 3 | loss: 0.9476264
	speed: 0.0094s/iter; left time: 27.5311s
	iters: 300, epoch: 3 | loss: 0.5494866
	speed: 0.0087s/iter; left time: 24.6143s
	iters: 400, epoch: 3 | loss: 0.4681923
	speed: 0.0094s/iter; left time: 25.7080s
	iters: 500, epoch: 3 | loss: 0.8903409
	speed: 0.0076s/iter; left time: 20.0806s
Updating learning rate to 6.422097915331089e-05
Validation loss decreased (0.2855 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 4.835971832275391
Epoch: 3, Steps: 523 | Train Loss: 0.6215349 Vali Loss: 0.2836297 Best vali loss: 0.2836297
	iters: 100, epoch: 4 | loss: 0.4893864
	speed: 0.0197s/iter; left time: 49.5338s
	iters: 200, epoch: 4 | loss: 1.2055100
	speed: 0.0092s/iter; left time: 22.1938s
	iters: 300, epoch: 4 | loss: 0.7256716
	speed: 0.0100s/iter; left time: 23.0484s
	iters: 400, epoch: 4 | loss: 0.4273544
	speed: 0.0108s/iter; left time: 24.0265s
	iters: 500, epoch: 4 | loss: 0.5695428
	speed: 0.0103s/iter; left time: 21.8964s
Updating learning rate to 4.64466252e-05
Validation loss decreased (0.2836 --> 0.2821).  Saving model state dict ...
Epoch: 4 cost time: 5.221338510513306
Epoch: 4, Steps: 523 | Train Loss: 0.6834930 Vali Loss: 0.2820862 Best vali loss: 0.2820862
	iters: 100, epoch: 5 | loss: 0.4172837
	speed: 0.0242s/iter; left time: 48.1640s
	iters: 200, epoch: 5 | loss: 0.2984576
	speed: 0.0101s/iter; left time: 19.0981s
	iters: 300, epoch: 5 | loss: 0.3889033
	speed: 0.0102s/iter; left time: 18.2420s
	iters: 400, epoch: 5 | loss: 0.2644733
	speed: 0.0097s/iter; left time: 16.4566s
	iters: 500, epoch: 5 | loss: 0.8668458
	speed: 0.0109s/iter; left time: 17.3239s
Updating learning rate to 2.8672271246689127e-05
Epoch: 5 cost time: 5.557949066162109
Epoch: 5, Steps: 523 | Train Loss: 0.4471927 Vali Loss: 0.2829357 Best vali loss: 0.2820862
	iters: 100, epoch: 6 | loss: 0.3896086
	speed: 0.0221s/iter; left time: 32.4705s
	iters: 200, epoch: 6 | loss: 0.3118148
	speed: 0.0101s/iter; left time: 13.8233s
	iters: 300, epoch: 6 | loss: 0.2440961
	speed: 0.0111s/iter; left time: 14.0438s
	iters: 400, epoch: 6 | loss: 0.3645774
	speed: 0.0113s/iter; left time: 13.1716s
	iters: 500, epoch: 6 | loss: 0.4403087
	speed: 0.0109s/iter; left time: 11.6593s
Updating learning rate to 1.3603901557850019e-05
Epoch: 6 cost time: 5.6304051876068115
Epoch: 6, Steps: 523 | Train Loss: 0.3500811 Vali Loss: 0.2830315 Best vali loss: 0.2820862
	iters: 100, epoch: 7 | loss: 0.2329683
	speed: 0.0209s/iter; left time: 19.8258s
	iters: 200, epoch: 7 | loss: 0.9517713
	speed: 0.0090s/iter; left time: 7.6434s
	iters: 300, epoch: 7 | loss: 0.6819836
	speed: 0.0103s/iter; left time: 7.6591s
	iters: 400, epoch: 7 | loss: 0.8244833
	speed: 0.0118s/iter; left time: 7.6324s
	iters: 500, epoch: 7 | loss: 0.4594618
	speed: 0.0125s/iter; left time: 6.8156s
Updating learning rate to 3.53553882349705e-06
Epoch: 7 cost time: 5.805537939071655
Epoch: 7, Steps: 523 | Train Loss: 0.6301337 Vali Loss: 0.2832685 Best vali loss: 0.2820862
	iters: 100, epoch: 8 | loss: 0.3577316
	speed: 0.0251s/iter; left time: 10.6299s
	iters: 200, epoch: 8 | loss: 0.7477762
	speed: 0.0107s/iter; left time: 3.4547s
	iters: 300, epoch: 8 | loss: 0.4249644
	speed: 0.0093s/iter; left time: 2.0834s
	iters: 400, epoch: 8 | loss: 0.6258706
	speed: 0.0101s/iter; left time: 1.2511s
	iters: 500, epoch: 8 | loss: 0.4422227
	speed: 0.0116s/iter; left time: 0.2784s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.782639741897583
Epoch: 8, Steps: 523 | Train Loss: 0.5197131 Vali Loss: 0.2833538 Best vali loss: 0.2820862

best validation loss 0.28208618213492903

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043224728456, 'e_layers': 3, 'learning_rate': 0.0008063623482, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5137183
	speed: 0.0188s/iter; left time: 155.4053s
	iters: 200, epoch: 1 | loss: 0.2123015
	speed: 0.0124s/iter; left time: 101.4270s
	iters: 300, epoch: 1 | loss: 0.9679527
	speed: 0.0122s/iter; left time: 98.1670s
	iters: 400, epoch: 1 | loss: 0.7078985
	speed: 0.0116s/iter; left time: 92.0651s
	iters: 500, epoch: 1 | loss: 0.2712649
	speed: 0.0080s/iter; left time: 62.6564s
	iters: 600, epoch: 1 | loss: 0.2430722
	speed: 0.0093s/iter; left time: 72.2828s
	iters: 700, epoch: 1 | loss: 1.0819147
	speed: 0.0125s/iter; left time: 95.6888s
	iters: 800, epoch: 1 | loss: 0.6433563
	speed: 0.0127s/iter; left time: 96.2810s
	iters: 900, epoch: 1 | loss: 0.3931396
	speed: 0.0127s/iter; left time: 94.7132s
	iters: 1000, epoch: 1 | loss: 0.4238979
	speed: 0.0127s/iter; left time: 93.4180s
Updating learning rate to 0.0008063623482
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 12.584841012954712
Epoch: 1, Steps: 1045 | Train Loss: 0.5458517 Vali Loss: 0.2817276 Best vali loss: 0.2817276
	iters: 100, epoch: 2 | loss: 0.5620527
	speed: 0.0390s/iter; left time: 281.7141s
	iters: 200, epoch: 2 | loss: 0.2203117
	speed: 0.0102s/iter; left time: 72.2392s
	iters: 300, epoch: 2 | loss: 1.2809887
	speed: 0.0111s/iter; left time: 78.1125s
	iters: 400, epoch: 2 | loss: 0.3652850
	speed: 0.0121s/iter; left time: 83.6828s
	iters: 500, epoch: 2 | loss: 0.4075624
	speed: 0.0123s/iter; left time: 83.5326s
	iters: 600, epoch: 2 | loss: 0.2745910
	speed: 0.0116s/iter; left time: 77.7517s
	iters: 700, epoch: 2 | loss: 0.5926090
	speed: 0.0108s/iter; left time: 71.6191s
	iters: 800, epoch: 2 | loss: 0.2722307
	speed: 0.0123s/iter; left time: 80.2814s
	iters: 900, epoch: 2 | loss: 0.1839940
	speed: 0.0123s/iter; left time: 79.0527s
	iters: 1000, epoch: 2 | loss: 0.3593337
	speed: 0.0106s/iter; left time: 67.2040s
Updating learning rate to 0.0004031811741
Epoch: 2 cost time: 12.015216827392578
Epoch: 2, Steps: 1045 | Train Loss: 0.4518959 Vali Loss: 0.2843240 Best vali loss: 0.2817276
	iters: 100, epoch: 3 | loss: 0.8188951
	speed: 0.0347s/iter; left time: 214.1023s
	iters: 200, epoch: 3 | loss: 0.2461328
	speed: 0.0129s/iter; left time: 78.5123s
	iters: 300, epoch: 3 | loss: 0.3848921
	speed: 0.0134s/iter; left time: 79.8034s
	iters: 400, epoch: 3 | loss: 0.3587851
	speed: 0.0140s/iter; left time: 82.1287s
	iters: 500, epoch: 3 | loss: 0.4675743
	speed: 0.0141s/iter; left time: 81.2180s
	iters: 600, epoch: 3 | loss: 1.1196011
	speed: 0.0117s/iter; left time: 66.1699s
	iters: 700, epoch: 3 | loss: 0.7018791
	speed: 0.0091s/iter; left time: 50.5873s
	iters: 800, epoch: 3 | loss: 1.0854682
	speed: 0.0116s/iter; left time: 63.6413s
	iters: 900, epoch: 3 | loss: 0.2626430
	speed: 0.0124s/iter; left time: 66.3512s
	iters: 1000, epoch: 3 | loss: 1.0458689
	speed: 0.0128s/iter; left time: 67.3779s
Updating learning rate to 0.00020159058705
Epoch: 3 cost time: 12.813770055770874
Epoch: 3, Steps: 1045 | Train Loss: 0.6491740 Vali Loss: 0.2866674 Best vali loss: 0.2817276
	iters: 100, epoch: 4 | loss: 0.4785797
	speed: 0.0423s/iter; left time: 216.8981s
	iters: 200, epoch: 4 | loss: 0.3231934
	speed: 0.0095s/iter; left time: 47.6959s
	iters: 300, epoch: 4 | loss: 0.8789680
	speed: 0.0105s/iter; left time: 51.4778s
	iters: 400, epoch: 4 | loss: 0.1684734
	speed: 0.0118s/iter; left time: 57.0305s
	iters: 500, epoch: 4 | loss: 0.8026603
	speed: 0.0098s/iter; left time: 46.3890s
	iters: 600, epoch: 4 | loss: 0.4016794
	speed: 0.0111s/iter; left time: 51.3848s
	iters: 700, epoch: 4 | loss: 0.1533475
	speed: 0.0110s/iter; left time: 49.7986s
	iters: 800, epoch: 4 | loss: 0.3521676
	speed: 0.0099s/iter; left time: 43.7980s
	iters: 900, epoch: 4 | loss: 0.2509950
	speed: 0.0109s/iter; left time: 47.0344s
	iters: 1000, epoch: 4 | loss: 0.3460227
	speed: 0.0102s/iter; left time: 43.0192s
Updating learning rate to 0.000100795293525
Epoch: 4 cost time: 11.1110520362854
Epoch: 4, Steps: 1045 | Train Loss: 0.4156087 Vali Loss: 0.2867399 Best vali loss: 0.2817276
	iters: 100, epoch: 5 | loss: 0.2205003
	speed: 0.0310s/iter; left time: 126.3298s
	iters: 200, epoch: 5 | loss: 0.4859670
	speed: 0.0096s/iter; left time: 38.0333s
	iters: 300, epoch: 5 | loss: 0.3022665
	speed: 0.0081s/iter; left time: 31.6031s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0066694129125, 'e_layers': 1, 'learning_rate': 0.0002333035787, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4752316
	speed: 0.0151s/iter; left time: 30.1819s
	iters: 200, epoch: 1 | loss: 0.8742079
	speed: 0.0086s/iter; left time: 16.2199s
Updating learning rate to 0.0002333035787
Validation loss decreased (inf --> 0.3035).  Saving model state dict ...
Epoch: 1 cost time: 2.5114097595214844
Epoch: 1, Steps: 262 | Train Loss: 0.6747198 Vali Loss: 0.3035391 Best vali loss: 0.3035391
	iters: 100, epoch: 2 | loss: 0.3978321
	speed: 0.0147s/iter; left time: 25.5533s
	iters: 200, epoch: 2 | loss: 0.4516324
	speed: 0.0067s/iter; left time: 10.9219s
Updating learning rate to 0.00011665178935
Validation loss decreased (0.3035 --> 0.2877).  Saving model state dict ...
Epoch: 2 cost time: 1.8196418285369873
Epoch: 2, Steps: 262 | Train Loss: 0.4247322 Vali Loss: 0.2877198 Best vali loss: 0.2877198
	iters: 100, epoch: 3 | loss: 0.6191325
	speed: 0.0198s/iter; left time: 29.2016s
	iters: 200, epoch: 3 | loss: 0.4221166
	speed: 0.0076s/iter; left time: 10.4364s
Updating learning rate to 5.8325894675e-05
Validation loss decreased (0.2877 --> 0.2840).  Saving model state dict ...
Epoch: 3 cost time: 1.9542412757873535
Epoch: 3, Steps: 262 | Train Loss: 0.5206245 Vali Loss: 0.2840429 Best vali loss: 0.2840429

best validation loss 0.2840428951062337

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3157551
	speed: 0.0157s/iter; left time: 31.3429s
	iters: 200, epoch: 1 | loss: 0.5151605
	speed: 0.0093s/iter; left time: 17.7331s
Updating learning rate to 0.00017249420488318464
Validation loss decreased (inf --> 0.2794).  Saving model state dict ...
Epoch: 1 cost time: 2.7738075256347656
Epoch: 1, Steps: 262 | Train Loss: 0.4154578 Vali Loss: 0.2794214 Best vali loss: 0.2794214
	iters: 100, epoch: 2 | loss: 0.3125114
	speed: 0.0197s/iter; left time: 34.1968s
	iters: 200, epoch: 2 | loss: 0.5277994
	speed: 0.0083s/iter; left time: 13.5583s
Updating learning rate to 0.0001530584539703962
Epoch: 2 cost time: 2.3646085262298584
Epoch: 2, Steps: 262 | Train Loss: 0.4201554 Vali Loss: 0.2865235 Best vali loss: 0.2794214
	iters: 100, epoch: 3 | loss: 0.6124095
	speed: 0.0195s/iter; left time: 28.7395s
	iters: 200, epoch: 3 | loss: 0.7303360
	speed: 0.0084s/iter; left time: 11.5042s
Updating learning rate to 0.00012397079715258604
Epoch: 3 cost time: 2.403127431869507
Epoch: 3, Steps: 262 | Train Loss: 0.6713727 Vali Loss: 0.2820569 Best vali loss: 0.2794214

best validation loss 0.2794213706164078

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008069876564, 'e_layers': 3, 'learning_rate': 0.000202447705, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7253969
	speed: 0.0156s/iter; left time: 14.7694s
Updating learning rate to 0.00019474249802669145
Validation loss decreased (inf --> 0.2790).  Saving model state dict ...
Epoch: 1 cost time: 1.5373172760009766
Epoch: 1, Steps: 131 | Train Loss: 0.7253969 Vali Loss: 0.2790051 Best vali loss: 0.2790051
	iters: 100, epoch: 2 | loss: 0.6625828
	speed: 0.0153s/iter; left time: 12.5097s
Updating learning rate to 0.00017279992502057686
Validation loss decreased (0.2790 --> 0.2765).  Saving model state dict ...
Epoch: 2 cost time: 1.2567548751831055
Epoch: 2, Steps: 131 | Train Loss: 0.6625828 Vali Loss: 0.2764684 Best vali loss: 0.2764684
	iters: 100, epoch: 3 | loss: 0.6961792
	speed: 0.0193s/iter; left time: 13.2389s
Updating learning rate to 0.00013996054381191757
Epoch: 3 cost time: 1.789304256439209
Epoch: 3, Steps: 131 | Train Loss: 0.6961792 Vali Loss: 0.2898732 Best vali loss: 0.2764684

best validation loss 0.27646840874392464

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008069876564, 'e_layers': 3, 'learning_rate': 0.000202447705, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5918837
	speed: 0.0151s/iter; left time: 8.4042s
Updating learning rate to 0.0001012238525
Epoch: 4 cost time: 1.428421974182129
Epoch: 4, Steps: 131 | Train Loss: 0.5918837 Vali Loss: 0.2846021 Best vali loss: 0.2764684
	iters: 100, epoch: 5 | loss: 0.5887464
	speed: 0.0140s/iter; left time: 5.9480s
Updating learning rate to 6.248716118808243e-05
Epoch: 5 cost time: 1.1758852005004883
Epoch: 5, Steps: 131 | Train Loss: 0.5887464 Vali Loss: 0.2895545 Best vali loss: 0.2764684
	iters: 100, epoch: 6 | loss: 0.5995074
	speed: 0.0144s/iter; left time: 4.2277s
Updating learning rate to 2.9647779979423143e-05
Epoch: 6 cost time: 1.2298314571380615
Epoch: 6, Steps: 131 | Train Loss: 0.5995074 Vali Loss: 0.2953839 Best vali loss: 0.2764684
	iters: 100, epoch: 7 | loss: 0.3102102
	speed: 0.0146s/iter; left time: 2.3825s
Updating learning rate to 7.705206973308556e-06
Epoch: 7 cost time: 1.2541425228118896
Epoch: 7, Steps: 131 | Train Loss: 0.3102102 Vali Loss: 0.2897637 Best vali loss: 0.2764684
	iters: 100, epoch: 8 | loss: 0.4842296
	speed: 0.0147s/iter; left time: 0.4710s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2076833248138428
Epoch: 8, Steps: 131 | Train Loss: 0.4842296 Vali Loss: 0.2900368 Best vali loss: 0.2764684

best validation loss 0.27646840874392464

[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.001716146484, 'e_layers': 4, 'learning_rate': 9.25739637e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6050991
	speed: 0.0227s/iter; left time: 21.5738s
Updating learning rate to 8.905057700293642e-05
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 2.840879201889038
Epoch: 1, Steps: 131 | Train Loss: 0.6050991 Vali Loss: 0.2812440 Best vali loss: 0.2812440
	iters: 100, epoch: 2 | loss: 0.6717843
	speed: 0.0407s/iter; left time: 33.2601s
Updating learning rate to 7.901682059679364e-05
Validation loss decreased (0.2812 --> 0.2793).  Saving model state dict ...
Epoch: 2 cost time: 2.5560462474823
Epoch: 2, Steps: 131 | Train Loss: 0.6717843 Vali Loss: 0.2793384 Best vali loss: 0.2793384
	iters: 100, epoch: 3 | loss: 0.4692339
	speed: 0.0285s/iter; left time: 19.6037s
Updating learning rate to 6.400024293817862e-05
Epoch: 3 cost time: 2.210689067840576
Epoch: 3, Steps: 131 | Train Loss: 0.4692339 Vali Loss: 0.2796287 Best vali loss: 0.2793384
	iters: 100, epoch: 4 | loss: 0.4379664
	speed: 0.0261s/iter; left time: 14.5208s
Updating learning rate to 4.628698185e-05
Epoch: 4 cost time: 2.109992027282715
Epoch: 4, Steps: 131 | Train Loss: 0.4379664 Vali Loss: 0.2798734 Best vali loss: 0.2793384
	iters: 100, epoch: 5 | loss: 0.4662118
	speed: 0.0173s/iter; left time: 7.3628s
Updating learning rate to 2.857372076182139e-05
Epoch: 5 cost time: 1.3872878551483154
Epoch: 5, Steps: 131 | Train Loss: 0.4662118 Vali Loss: 0.2795156 Best vali loss: 0.2793384
	iters: 100, epoch: 6 | loss: 0.4023687
	speed: 0.0166s/iter; left time: 4.8733s
Updating learning rate to 1.3557143103206357e-05
Epoch: 6 cost time: 1.337735652923584
Epoch: 6, Steps: 131 | Train Loss: 0.4023687 Vali Loss: 0.2798882 Best vali loss: 0.2793384
	iters: 100, epoch: 7 | loss: 0.4957504
	speed: 0.0150s/iter; left time: 2.4424s
Updating learning rate to 3.523386697063586e-06
Epoch: 7 cost time: 1.3449604511260986
Epoch: 7, Steps: 131 | Train Loss: 0.4957504 Vali Loss: 0.2802653 Best vali loss: 0.2793384
	iters: 100, epoch: 8 | loss: 0.5665569
	speed: 0.0177s/iter; left time: 0.5662s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5191798210144043
Epoch: 8, Steps: 131 | Train Loss: 0.5665569 Vali Loss: 0.2808141 Best vali loss: 0.2793384

best validation loss 0.27933844499492255

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0044569176576, 'e_layers': 2, 'learning_rate': 0.0006733362287, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4916422
	speed: 0.0150s/iter; left time: 14.2772s
Updating learning rate to 0.0006477088944471344
Validation loss decreased (inf --> 0.2897).  Saving model state dict ...
Epoch: 1 cost time: 1.4862539768218994
Epoch: 1, Steps: 131 | Train Loss: 0.4916422 Vali Loss: 0.2896997 Best vali loss: 0.2896997
	iters: 100, epoch: 2 | loss: 0.4482511
	speed: 0.0159s/iter; left time: 12.9935s
Updating learning rate to 0.0005747284210161729
Validation loss decreased (0.2897 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 1.3105847835540771
Epoch: 2, Steps: 131 | Train Loss: 0.4482511 Vali Loss: 0.2818383 Best vali loss: 0.2818383
	iters: 100, epoch: 3 | loss: 0.6223840
	speed: 0.0142s/iter; left time: 9.7351s
Updating learning rate to 0.00046550542391734053
Validation loss decreased (0.2818 --> 0.2816).  Saving model state dict ...
Epoch: 3 cost time: 1.170623779296875
Epoch: 3, Steps: 131 | Train Loss: 0.6223840 Vali Loss: 0.2815650 Best vali loss: 0.2815650
	iters: 100, epoch: 4 | loss: 0.5601602
	speed: 0.0232s/iter; left time: 12.8950s
Updating learning rate to 0.00033666811435
Epoch: 4 cost time: 1.844003438949585
Epoch: 4, Steps: 131 | Train Loss: 0.5601602 Vali Loss: 0.2858892 Best vali loss: 0.2815650
	iters: 100, epoch: 5 | loss: 0.3534584
	speed: 0.0206s/iter; left time: 8.7672s
Updating learning rate to 0.00020783080478265948
Epoch: 5 cost time: 2.1240084171295166
Epoch: 5, Steps: 131 | Train Loss: 0.3534584 Vali Loss: 0.2858577 Best vali loss: 0.2815650
	iters: 100, epoch: 6 | loss: 0.6903263
	speed: 0.0282s/iter; left time: 8.2993s
Updating learning rate to 9.8607807683827e-05
Epoch: 6 cost time: 1.9748053550720215
Epoch: 6, Steps: 131 | Train Loss: 0.6903263 Vali Loss: 0.2840963 Best vali loss: 0.2815650
	iters: 100, epoch: 7 | loss: 0.6446592
	speed: 0.0304s/iter; left time: 4.9558s
Updating learning rate to 2.5627334252865573e-05
Epoch: 7 cost time: 2.362483501434326
Epoch: 7, Steps: 131 | Train Loss: 0.6446592 Vali Loss: 0.2849163 Best vali loss: 0.2815650
	iters: 100, epoch: 8 | loss: 0.5652179
	speed: 0.0259s/iter; left time: 0.8293s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6736295223236084
Epoch: 8, Steps: 131 | Train Loss: 0.5652179 Vali Loss: 0.2851293 Best vali loss: 0.2815650

best validation loss 0.28156498250752054

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00031764682727096065
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 1.715332269668579
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2787389 Best vali loss: 0.2787389
Updating learning rate to 0.00028185603292365586
Epoch: 2 cost time: 2.5223023891448975
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2858714 Best vali loss: 0.2787389
Updating learning rate to 0.00022829132385310412
Epoch: 3 cost time: 2.641427993774414
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3015147 Best vali loss: 0.2787389

best validation loss 0.27873894501326474

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009854043892, 'e_layers': 4, 'learning_rate': 0.0004499065077, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7517639
	speed: 0.0154s/iter; left time: 127.1440s
	iters: 200, epoch: 1 | loss: 0.3687649
	speed: 0.0106s/iter; left time: 86.7866s
	iters: 300, epoch: 1 | loss: 0.2609693
	speed: 0.0102s/iter; left time: 82.5599s
	iters: 400, epoch: 1 | loss: 0.2900808
	speed: 0.0105s/iter; left time: 83.4351s
	iters: 500, epoch: 1 | loss: 0.2300720
	speed: 0.0112s/iter; left time: 88.0250s
	iters: 600, epoch: 1 | loss: 0.5733376
	speed: 0.0118s/iter; left time: 91.6289s
	iters: 700, epoch: 1 | loss: 0.2266193
	speed: 0.0108s/iter; left time: 82.6786s
	iters: 800, epoch: 1 | loss: 0.5192175
	speed: 0.0101s/iter; left time: 76.4753s
	iters: 900, epoch: 1 | loss: 0.3109447
	speed: 0.0119s/iter; left time: 88.9792s
	iters: 1000, epoch: 1 | loss: 0.2982573
	speed: 0.0114s/iter; left time: 83.6930s
Updating learning rate to 0.00043278296085383084
Validation loss decreased (inf --> 0.2908).  Saving model state dict ...
Epoch: 1 cost time: 11.584070682525635
Epoch: 1, Steps: 1045 | Train Loss: 0.3830027 Vali Loss: 0.2908046 Best vali loss: 0.2908046
	iters: 100, epoch: 2 | loss: 0.3276304
	speed: 0.0294s/iter; left time: 211.7918s
	iters: 200, epoch: 2 | loss: 0.3264027
	speed: 0.0102s/iter; left time: 72.8964s
	iters: 300, epoch: 2 | loss: 0.2459806
	speed: 0.0107s/iter; left time: 75.0821s
	iters: 400, epoch: 2 | loss: 0.5191776
	speed: 0.0100s/iter; left time: 69.4567s
	iters: 500, epoch: 2 | loss: 0.4765112
	speed: 0.0108s/iter; left time: 73.7238s
	iters: 600, epoch: 2 | loss: 0.4846405
	speed: 0.0109s/iter; left time: 73.2324s
	iters: 700, epoch: 2 | loss: 0.4216597
	speed: 0.0099s/iter; left time: 65.8163s
	iters: 800, epoch: 2 | loss: 0.3281358
	speed: 0.0083s/iter; left time: 54.0244s
	iters: 900, epoch: 2 | loss: 1.2218406
	speed: 0.0105s/iter; left time: 67.2172s
	iters: 1000, epoch: 2 | loss: 1.1174057
	speed: 0.0102s/iter; left time: 64.6804s
Updating learning rate to 0.0003840192250973138
Validation loss decreased (0.2908 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 10.691236972808838
Epoch: 2, Steps: 1045 | Train Loss: 0.5469385 Vali Loss: 0.2835097 Best vali loss: 0.2835097
	iters: 100, epoch: 3 | loss: 0.4528179
	speed: 0.0330s/iter; left time: 203.5601s
	iters: 200, epoch: 3 | loss: 0.3085088
	speed: 0.0091s/iter; left time: 55.2270s
	iters: 300, epoch: 3 | loss: 0.2427720
	speed: 0.0105s/iter; left time: 62.8339s
	iters: 400, epoch: 3 | loss: 0.7124830
	speed: 0.0095s/iter; left time: 55.8382s
	iters: 500, epoch: 3 | loss: 0.1990164
	speed: 0.0099s/iter; left time: 57.3878s
	iters: 600, epoch: 3 | loss: 0.8829032
	speed: 0.0109s/iter; left time: 61.5998s
	iters: 700, epoch: 3 | loss: 0.1417789
	speed: 0.0105s/iter; left time: 58.4686s
	iters: 800, epoch: 3 | loss: 0.6711779
	speed: 0.0099s/iter; left time: 54.2290s
	iters: 900, epoch: 3 | loss: 0.2814843
	speed: 0.0091s/iter; left time: 48.7610s
	iters: 1000, epoch: 3 | loss: 0.2486480
	speed: 0.0083s/iter; left time: 43.9053s
Updating learning rate to 0.00031103913715501335
Validation loss decreased (0.2835 --> 0.2824).  Saving model state dict ...
Epoch: 3 cost time: 10.246596574783325
Epoch: 3, Steps: 1045 | Train Loss: 0.4141590 Vali Loss: 0.2823604 Best vali loss: 0.2823604

best validation loss 0.28236038324535007

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010212612733, 'e_layers': 1, 'learning_rate': 0.001033174495, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5652378
	speed: 0.0142s/iter; left time: 28.3067s
	iters: 200, epoch: 1 | loss: 0.4023685
	speed: 0.0082s/iter; left time: 15.5980s
Updating learning rate to 0.001033174495
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 2.415142059326172
Epoch: 1, Steps: 262 | Train Loss: 0.4838032 Vali Loss: 0.2849887 Best vali loss: 0.2849887
	iters: 100, epoch: 2 | loss: 0.7387972
	speed: 0.0190s/iter; left time: 32.9002s
	iters: 200, epoch: 2 | loss: 0.4085681
	speed: 0.0087s/iter; left time: 14.2704s
Updating learning rate to 0.0005165872475
Validation loss decreased (0.2850 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 2.2180776596069336
Epoch: 2, Steps: 262 | Train Loss: 0.5736827 Vali Loss: 0.2834335 Best vali loss: 0.2834335
	iters: 100, epoch: 3 | loss: 0.3708962
	speed: 0.0205s/iter; left time: 30.2067s
	iters: 200, epoch: 3 | loss: 0.2348684
	speed: 0.0074s/iter; left time: 10.2053s
Updating learning rate to 0.00025829362375
Epoch: 3 cost time: 1.986971139907837
Epoch: 3, Steps: 262 | Train Loss: 0.3028823 Vali Loss: 0.2837186 Best vali loss: 0.2834335

best validation loss 0.2834335262390174

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00016510744145
Epoch: 4 cost time: 1.6222612857818604
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3177042 Best vali loss: 0.2787389
Updating learning rate to 0.00010192355904689593
Epoch: 5 cost time: 1.5603816509246826
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3060311 Best vali loss: 0.2787389
Updating learning rate to 4.835884997634416e-05
Epoch: 6 cost time: 1.3670518398284912
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3048898 Best vali loss: 0.2787389
Updating learning rate to 1.2568055629039355e-05
Epoch: 7 cost time: 1.3161144256591797
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3182860 Best vali loss: 0.2787389
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5375747680664062
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3113165 Best vali loss: 0.2787389

best validation loss 0.27873894501326474

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.005640097632, 'e_layers': 4, 'learning_rate': 0.0001952136558, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4581726
	speed: 0.0177s/iter; left time: 146.1460s
	iters: 200, epoch: 1 | loss: 0.3391896
	speed: 0.0103s/iter; left time: 84.2540s
	iters: 300, epoch: 1 | loss: 0.6310533
	speed: 0.0112s/iter; left time: 90.5707s
	iters: 400, epoch: 1 | loss: 1.0976837
	speed: 0.0096s/iter; left time: 76.6234s
	iters: 500, epoch: 1 | loss: 1.3034574
	speed: 0.0111s/iter; left time: 86.9358s
	iters: 600, epoch: 1 | loss: 0.4001356
	speed: 0.0108s/iter; left time: 84.0018s
	iters: 700, epoch: 1 | loss: 0.2597931
	speed: 0.0109s/iter; left time: 83.2773s
	iters: 800, epoch: 1 | loss: 0.2897810
	speed: 0.0102s/iter; left time: 77.0076s
	iters: 900, epoch: 1 | loss: 0.3953901
	speed: 0.0112s/iter; left time: 83.4167s
	iters: 1000, epoch: 1 | loss: 0.2626114
	speed: 0.0103s/iter; left time: 75.9678s
Updating learning rate to 0.0001952136558
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 11.490808963775635
Epoch: 1, Steps: 1045 | Train Loss: 0.5437268 Vali Loss: 0.2860808 Best vali loss: 0.2860808
	iters: 100, epoch: 2 | loss: 1.3369495
	speed: 0.0341s/iter; left time: 245.9623s
	iters: 200, epoch: 2 | loss: 0.2309592
	speed: 0.0111s/iter; left time: 79.1650s
	iters: 300, epoch: 2 | loss: 0.5068649
	speed: 0.0110s/iter; left time: 77.4770s
	iters: 400, epoch: 2 | loss: 0.7368712
	speed: 0.0093s/iter; left time: 64.5411s
	iters: 500, epoch: 2 | loss: 0.3003365
	speed: 0.0095s/iter; left time: 65.0238s
	iters: 600, epoch: 2 | loss: 0.2974700
	speed: 0.0110s/iter; left time: 73.9276s
	iters: 700, epoch: 2 | loss: 0.7973773
	speed: 0.0102s/iter; left time: 67.6307s
	iters: 800, epoch: 2 | loss: 0.4432149
	speed: 0.0108s/iter; left time: 70.3242s
	iters: 900, epoch: 2 | loss: 1.3071766
	speed: 0.0107s/iter; left time: 68.7465s
	iters: 1000, epoch: 2 | loss: 0.4053818
	speed: 0.0099s/iter; left time: 62.4323s
Updating learning rate to 9.76068279e-05
Epoch: 2 cost time: 11.02086329460144
Epoch: 2, Steps: 1045 | Train Loss: 0.6362602 Vali Loss: 0.2877218 Best vali loss: 0.2860808
	iters: 100, epoch: 3 | loss: 0.6374189
	speed: 0.0319s/iter; left time: 196.7406s
	iters: 200, epoch: 3 | loss: 0.2296118
	speed: 0.0095s/iter; left time: 57.8983s
	iters: 300, epoch: 3 | loss: 0.3729878
	speed: 0.0106s/iter; left time: 63.3775s
	iters: 400, epoch: 3 | loss: 0.3597286
	speed: 0.0098s/iter; left time: 57.7538s
	iters: 500, epoch: 3 | loss: 0.6477681
	speed: 0.0080s/iter; left time: 46.2279s
	iters: 600, epoch: 3 | loss: 0.3477440
	speed: 0.0111s/iter; left time: 62.7196s
	iters: 700, epoch: 3 | loss: 1.5136591
	speed: 0.0117s/iter; left time: 64.9538s
	iters: 800, epoch: 3 | loss: 0.2659079
	speed: 0.0115s/iter; left time: 62.8995s
	iters: 900, epoch: 3 | loss: 1.2049491
	speed: 0.0114s/iter; left time: 61.1834s
	iters: 1000, epoch: 3 | loss: 1.1076884
	speed: 0.0101s/iter; left time: 53.0010s
Updating learning rate to 4.880341395e-05
Epoch: 3 cost time: 10.817089319229126
Epoch: 3, Steps: 1045 | Train Loss: 0.6687464 Vali Loss: 0.2864092 Best vali loss: 0.2860808
	iters: 100, epoch: 4 | loss: 0.4014418
	speed: 0.0348s/iter; left time: 178.2647s
	iters: 200, epoch: 4 | loss: 1.1181611
	speed: 0.0099s/iter; left time: 49.6279s
	iters: 300, epoch: 4 | loss: 0.3392558
	speed: 0.0095s/iter; left time: 46.8242s
	iters: 400, epoch: 4 | loss: 0.4052058
	speed: 0.0113s/iter; left time: 54.4998s
	iters: 500, epoch: 4 | loss: 0.2838332
	speed: 0.0118s/iter; left time: 55.9962s
	iters: 600, epoch: 4 | loss: 0.2648297
	speed: 0.0112s/iter; left time: 51.8754s
	iters: 700, epoch: 4 | loss: 0.8822269
	speed: 0.0111s/iter; left time: 50.0885s
	iters: 800, epoch: 4 | loss: 0.3618660
	speed: 0.0110s/iter; left time: 48.7566s
	iters: 900, epoch: 4 | loss: 0.3638113
	speed: 0.0112s/iter; left time: 48.4105s
	iters: 1000, epoch: 4 | loss: 1.5510551
	speed: 0.0110s/iter; left time: 46.6657s
Updating learning rate to 2.4401706975e-05
Epoch: 4 cost time: 11.503950119018555
Epoch: 4, Steps: 1045 | Train Loss: 0.5971687 Vali Loss: 0.2868080 Best vali loss: 0.2860808
	iters: 100, epoch: 5 | loss: 1.6010565
	speed: 0.0318s/iter; left time: 129.8372s
	iters: 200, epoch: 5 | loss: 1.1123719
	speed: 0.0105s/iter; left time: 41.7068s
	iters: 300, epoch: 5 | loss: 1.6689633
	speed: 0.0107s/iter; left time: 41.7178s
	iters: 400, epoch: 5 | loss: 1.1709936
	speed: 0.0110s/iter; left time: 41.6851s
	iters: 500, epoch: 5 | loss: 0.5730539
	speed: 0.0106s/iter; left time: 38.9778s
	iters: 600, epoch: 5 | loss: 0.3840508
	speed: 0.0111s/iter; left time: 39.8768s
	iters: 700, epoch: 5 | loss: 0.3263827
	speed: 0.0116s/iter; left time: 40.4423s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0036399733072, 'e_layers': 2, 'learning_rate': 0.0011858266081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3830734
	speed: 0.0145s/iter; left time: 119.6785s
	iters: 200, epoch: 1 | loss: 0.4092613
	speed: 0.0079s/iter; left time: 64.3212s
	iters: 300, epoch: 1 | loss: 0.2823402
	speed: 0.0066s/iter; left time: 53.5235s
	iters: 400, epoch: 1 | loss: 0.3589675
	speed: 0.0065s/iter; left time: 51.8440s
	iters: 500, epoch: 1 | loss: 0.6510675
	speed: 0.0070s/iter; left time: 55.1436s
	iters: 600, epoch: 1 | loss: 0.5497465
	speed: 0.0081s/iter; left time: 63.1533s
	iters: 700, epoch: 1 | loss: 0.8633882
	speed: 0.0082s/iter; left time: 62.6541s
	iters: 800, epoch: 1 | loss: 0.4841446
	speed: 0.0081s/iter; left time: 61.1686s
	iters: 900, epoch: 1 | loss: 0.3069241
	speed: 0.0076s/iter; left time: 56.4008s
	iters: 1000, epoch: 1 | loss: 0.3446528
	speed: 0.0076s/iter; left time: 56.1358s
Updating learning rate to 0.0011858266081
Validation loss decreased (inf --> 0.3166).  Saving model state dict ...
Epoch: 1 cost time: 8.262941360473633
Epoch: 1, Steps: 1045 | Train Loss: 0.4633566 Vali Loss: 0.3165552 Best vali loss: 0.3165552
	iters: 100, epoch: 2 | loss: 0.5807300
	speed: 0.0291s/iter; left time: 210.3297s
	iters: 200, epoch: 2 | loss: 0.2933883
	speed: 0.0077s/iter; left time: 54.9761s
	iters: 300, epoch: 2 | loss: 0.3201031
	speed: 0.0077s/iter; left time: 54.1161s
	iters: 400, epoch: 2 | loss: 0.2835167
	speed: 0.0081s/iter; left time: 55.7159s
	iters: 500, epoch: 2 | loss: 0.9424955
	speed: 0.0081s/iter; left time: 55.0433s
	iters: 600, epoch: 2 | loss: 0.4273997
	speed: 0.0071s/iter; left time: 47.8662s
	iters: 700, epoch: 2 | loss: 0.4260769
	speed: 0.0070s/iter; left time: 46.1548s
	iters: 800, epoch: 2 | loss: 1.0897892
	speed: 0.0070s/iter; left time: 45.4640s
	iters: 900, epoch: 2 | loss: 0.3397503
	speed: 0.0080s/iter; left time: 51.4409s
	iters: 1000, epoch: 2 | loss: 0.3908371
	speed: 0.0072s/iter; left time: 45.3995s
Updating learning rate to 0.00059291330405
Epoch: 2 cost time: 7.888774394989014
Epoch: 2, Steps: 1045 | Train Loss: 0.5094087 Vali Loss: 0.3187940 Best vali loss: 0.3165552

horizon=192
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123 \
    --restore_experiment;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][smbo.py:498] Continuing from previous run.
[INFO][abstract_intensifier.py:288] Added existing seed 843828734 from runhistory to the intensifier.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0036399733072, 'e_layers': 2, 'learning_rate': 0.0011858266081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3830734
	speed: 0.0103s/iter; left time: 84.9314s
	iters: 200, epoch: 1 | loss: 0.4092613
	speed: 0.0048s/iter; left time: 39.1342s
	iters: 300, epoch: 1 | loss: 0.2823402
	speed: 0.0048s/iter; left time: 38.6839s
	iters: 400, epoch: 1 | loss: 0.3589675
	speed: 0.0049s/iter; left time: 38.6449s
	iters: 500, epoch: 1 | loss: 0.6510675
	speed: 0.0048s/iter; left time: 38.0702s
	iters: 600, epoch: 1 | loss: 0.5497465
	speed: 0.0048s/iter; left time: 36.9689s
	iters: 700, epoch: 1 | loss: 0.8633882
	speed: 0.0047s/iter; left time: 36.0641s
	iters: 800, epoch: 1 | loss: 0.4841446
	speed: 0.0047s/iter; left time: 35.7183s
	iters: 900, epoch: 1 | loss: 0.3069241
	speed: 0.0047s/iter; left time: 34.9883s
	iters: 1000, epoch: 1 | loss: 0.3446528
	speed: 0.0047s/iter; left time: 34.3097s
Updating learning rate to 0.0011858266081
Validation loss decreased (inf --> 0.3166).  Saving model state dict ...
Epoch: 1 cost time: 5.273587703704834
Epoch: 1, Steps: 1045 | Train Loss: 0.4633566 Vali Loss: 0.3165552 Best vali loss: 0.3165552
	iters: 100, epoch: 2 | loss: 0.5807300
	speed: 0.0150s/iter; left time: 108.1711s
	iters: 200, epoch: 2 | loss: 0.2933883
	speed: 0.0047s/iter; left time: 33.1694s
	iters: 300, epoch: 2 | loss: 0.3201031
	speed: 0.0047s/iter; left time: 32.7859s
	iters: 400, epoch: 2 | loss: 0.2835167
	speed: 0.0047s/iter; left time: 32.5747s
	iters: 500, epoch: 2 | loss: 0.9424955
	speed: 0.0047s/iter; left time: 32.3592s
	iters: 600, epoch: 2 | loss: 0.4273997
	speed: 0.0047s/iter; left time: 31.4863s
	iters: 700, epoch: 2 | loss: 0.4260769
	speed: 0.0047s/iter; left time: 31.3354s
	iters: 800, epoch: 2 | loss: 1.0897892
	speed: 0.0048s/iter; left time: 30.9809s
	iters: 900, epoch: 2 | loss: 0.3397503
	speed: 0.0048s/iter; left time: 30.9936s
	iters: 1000, epoch: 2 | loss: 0.3908371
	speed: 0.0048s/iter; left time: 30.2862s
Updating learning rate to 0.00059291330405
Epoch: 2 cost time: 4.891192436218262
Epoch: 2, Steps: 1045 | Train Loss: 0.5094087 Vali Loss: 0.3187940 Best vali loss: 0.3165552
	iters: 100, epoch: 3 | loss: 1.9173050
	speed: 0.0164s/iter; left time: 101.2859s
	iters: 200, epoch: 3 | loss: 0.5315192
	speed: 0.0050s/iter; left time: 30.2988s
	iters: 300, epoch: 3 | loss: 0.3669146
	speed: 0.0048s/iter; left time: 28.6138s
	iters: 400, epoch: 3 | loss: 0.2179492
	speed: 0.0052s/iter; left time: 30.3616s
	iters: 500, epoch: 3 | loss: 0.6187407
	speed: 0.0044s/iter; left time: 25.5820s
	iters: 600, epoch: 3 | loss: 0.3995865
	speed: 0.0038s/iter; left time: 21.3937s
	iters: 700, epoch: 3 | loss: 0.3690638
	speed: 0.0038s/iter; left time: 21.1822s
	iters: 800, epoch: 3 | loss: 0.4067014
	speed: 0.0040s/iter; left time: 22.0601s
	iters: 900, epoch: 3 | loss: 0.4365993
	speed: 0.0035s/iter; left time: 18.8253s
	iters: 1000, epoch: 3 | loss: 0.3239233
	speed: 0.0032s/iter; left time: 16.9924s
Updating learning rate to 0.000296456652025
Epoch: 3 cost time: 4.419758319854736
Epoch: 3, Steps: 1045 | Train Loss: 0.5588303 Vali Loss: 0.3204699 Best vali loss: 0.3165552
	iters: 100, epoch: 4 | loss: 0.3385572
	speed: 0.0147s/iter; left time: 75.3774s
	iters: 200, epoch: 4 | loss: 0.6536915
	speed: 0.0043s/iter; left time: 21.7943s
	iters: 300, epoch: 4 | loss: 0.5927973
	speed: 0.0045s/iter; left time: 22.2436s
	iters: 400, epoch: 4 | loss: 0.2841181
	speed: 0.0045s/iter; left time: 21.7107s
	iters: 500, epoch: 4 | loss: 0.9753413
	speed: 0.0052s/iter; left time: 24.6009s
	iters: 600, epoch: 4 | loss: 0.8510575
	speed: 0.0075s/iter; left time: 34.6437s
	iters: 700, epoch: 4 | loss: 2.7109895
	speed: 0.0064s/iter; left time: 28.7591s
	iters: 800, epoch: 4 | loss: 0.2564480
	speed: 0.0071s/iter; left time: 31.4512s
	iters: 900, epoch: 4 | loss: 0.4263966
	speed: 0.0070s/iter; left time: 30.4489s
	iters: 1000, epoch: 4 | loss: 0.2473246
	speed: 0.0066s/iter; left time: 27.9591s
Updating learning rate to 0.0001482283260125
Epoch: 4 cost time: 6.020513296127319
Epoch: 4, Steps: 1045 | Train Loss: 0.7336722 Vali Loss: 0.3232566 Best vali loss: 0.3165552
	iters: 100, epoch: 5 | loss: 0.3475523
	speed: 0.0148s/iter; left time: 60.3625s
	iters: 200, epoch: 5 | loss: 0.2406047
	speed: 0.0042s/iter; left time: 16.7717s
	iters: 300, epoch: 5 | loss: 0.3660383
	speed: 0.0039s/iter; left time: 15.1133s
	iters: 400, epoch: 5 | loss: 0.4176363
	speed: 0.0090s/iter; left time: 33.9458s
	iters: 500, epoch: 5 | loss: 0.3222067
	speed: 0.0075s/iter; left time: 27.5551s
	iters: 600, epoch: 5 | loss: 0.3007975
	speed: 0.0075s/iter; left time: 26.9008s
	iters: 700, epoch: 5 | loss: 0.8000610
	speed: 0.0091s/iter; left time: 31.5212s
	iters: 800, epoch: 5 | loss: 1.3980227
	speed: 0.0070s/iter; left time: 23.6567s
	iters: 900, epoch: 5 | loss: 0.3007250
	speed: 0.0076s/iter; left time: 25.0769s
	iters: 1000, epoch: 5 | loss: 0.4461848
	speed: 0.0091s/iter; left time: 28.9056s
Updating learning rate to 7.411416300625e-05
Epoch: 5 cost time: 7.216250896453857
Epoch: 5, Steps: 1045 | Train Loss: 0.4939829 Vali Loss: 0.3230654 Best vali loss: 0.3165552
	iters: 100, epoch: 6 | loss: 0.3264644
	speed: 0.0288s/iter; left time: 87.3279s
	iters: 200, epoch: 6 | loss: 0.3420633
	speed: 0.0073s/iter; left time: 21.5121s
	iters: 300, epoch: 6 | loss: 0.2467855
	speed: 0.0045s/iter; left time: 12.8937s
	iters: 400, epoch: 6 | loss: 0.1422983
	speed: 0.0054s/iter; left time: 14.6921s
	iters: 500, epoch: 6 | loss: 0.2040926
	speed: 0.0059s/iter; left time: 15.5740s
	iters: 600, epoch: 6 | loss: 1.4495963
	speed: 0.0056s/iter; left time: 14.3225s
	iters: 700, epoch: 6 | loss: 0.2641150
	speed: 0.0049s/iter; left time: 11.8711s
	iters: 800, epoch: 6 | loss: 0.5483067
	speed: 0.0053s/iter; left time: 12.3745s
	iters: 900, epoch: 6 | loss: 1.0969259
	speed: 0.0064s/iter; left time: 14.2028s
	iters: 1000, epoch: 6 | loss: 1.3666947
	speed: 0.0062s/iter; left time: 13.2564s
Updating learning rate to 3.7057081503125e-05
Epoch: 6 cost time: 6.195420503616333
Epoch: 6, Steps: 1045 | Train Loss: 0.5987343 Vali Loss: 0.3219684 Best vali loss: 0.3165552
	iters: 100, epoch: 7 | loss: 0.3224543
	speed: 0.0221s/iter; left time: 44.0734s
	iters: 200, epoch: 7 | loss: 0.6136348
	speed: 0.0065s/iter; left time: 12.3768s
	iters: 300, epoch: 7 | loss: 0.5493467
	speed: 0.0067s/iter; left time: 11.9585s
	iters: 400, epoch: 7 | loss: 0.2367489
	speed: 0.0064s/iter; left time: 10.8554s
	iters: 500, epoch: 7 | loss: 0.3714104
	speed: 0.0062s/iter; left time: 9.8620s
	iters: 600, epoch: 7 | loss: 0.3634400
	speed: 0.0067s/iter; left time: 9.9529s
	iters: 700, epoch: 7 | loss: 0.3106663
	speed: 0.0062s/iter; left time: 8.6853s
	iters: 800, epoch: 7 | loss: 0.1880997
	speed: 0.0054s/iter; left time: 6.9542s
	iters: 900, epoch: 7 | loss: 0.3157159
	speed: 0.0059s/iter; left time: 7.0252s
	iters: 1000, epoch: 7 | loss: 0.6076586
	speed: 0.0057s/iter; left time: 6.2171s
Updating learning rate to 1.85285407515625e-05
Epoch: 7 cost time: 6.495656251907349
Epoch: 7, Steps: 1045 | Train Loss: 0.3879176 Vali Loss: 0.3222257 Best vali loss: 0.3165552
	iters: 100, epoch: 8 | loss: 0.4518732
	speed: 0.0239s/iter; left time: 22.5827s
	iters: 200, epoch: 8 | loss: 0.3702239
	speed: 0.0097s/iter; left time: 8.1667s
	iters: 300, epoch: 8 | loss: 0.4832938
	speed: 0.0087s/iter; left time: 6.5067s
	iters: 400, epoch: 8 | loss: 0.3626484
	speed: 0.0089s/iter; left time: 5.7657s
	iters: 500, epoch: 8 | loss: 0.8458453
	speed: 0.0112s/iter; left time: 6.1274s
	iters: 600, epoch: 8 | loss: 1.7886825
	speed: 0.0100s/iter; left time: 4.4759s
	iters: 700, epoch: 8 | loss: 0.9865229
	speed: 0.0083s/iter; left time: 2.8726s
	iters: 800, epoch: 8 | loss: 0.2638513
	speed: 0.0076s/iter; left time: 1.8788s
	iters: 900, epoch: 8 | loss: 1.0798918
	speed: 0.0092s/iter; left time: 1.3468s
	iters: 1000, epoch: 8 | loss: 0.7279023
	speed: 0.0099s/iter; left time: 0.4561s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0099308245732, 'e_layers': 3, 'learning_rate': 0.0001759530142, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4183508
	speed: 0.0155s/iter; left time: 31.0443s
	iters: 200, epoch: 1 | loss: 0.3380326
	speed: 0.0086s/iter; left time: 16.3324s
Updating learning rate to 0.0001759530142
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 2.6789913177490234
Epoch: 1, Steps: 262 | Train Loss: 0.3781917 Vali Loss: 0.2803073 Best vali loss: 0.2803073
	iters: 100, epoch: 2 | loss: 0.4292825
	speed: 0.0209s/iter; left time: 36.2049s
	iters: 200, epoch: 2 | loss: 0.6886848
	speed: 0.0089s/iter; left time: 14.6303s
Updating learning rate to 8.79765071e-05
Validation loss decreased (0.2803 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 2.4753570556640625
Epoch: 2, Steps: 262 | Train Loss: 0.5589837 Vali Loss: 0.2800183 Best vali loss: 0.2800183
	iters: 100, epoch: 3 | loss: 0.7382749
	speed: 0.0201s/iter; left time: 29.6533s
	iters: 200, epoch: 3 | loss: 0.4838661
	speed: 0.0091s/iter; left time: 12.5337s
Updating learning rate to 4.398825355e-05
Epoch: 3 cost time: 2.4125847816467285
Epoch: 3, Steps: 262 | Train Loss: 0.6110705 Vali Loss: 0.2855345 Best vali loss: 0.2800183

best validation loss 0.28001830749859286

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0042364658137, 'e_layers': 1, 'learning_rate': 0.0001617390902, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001555832626213884
Validation loss decreased (inf --> 0.2789).  Saving model state dict ...
Epoch: 1 cost time: 0.9077341556549072
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2788961 Best vali loss: 0.2788961
Updating learning rate to 0.00013805294883168133
Epoch: 2 cost time: 0.5887899398803711
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2809334 Best vali loss: 0.2788961
Updating learning rate to 0.00011181698019267143
Validation loss decreased (0.2789 --> 0.2787).  Saving model state dict ...
Epoch: 3 cost time: 0.6075763702392578
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2786607 Best vali loss: 0.2786607

best validation loss 0.27866065558690306

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0017593741457, 'e_layers': 4, 'learning_rate': 0.0034914690664, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7212727
	speed: 0.0161s/iter; left time: 15.2879s
Updating learning rate to 0.0033585829376216255
Validation loss decreased (inf --> 0.3028).  Saving model state dict ...
Epoch: 1 cost time: 1.6194169521331787
Epoch: 1, Steps: 131 | Train Loss: 0.7212727 Vali Loss: 0.3028073 Best vali loss: 0.3028073
	iters: 100, epoch: 2 | loss: 0.7278909
	speed: 0.0231s/iter; left time: 18.8724s
Updating learning rate to 0.002980155259777252
Validation loss decreased (0.3028 --> 0.2941).  Saving model state dict ...
Epoch: 2 cost time: 2.227440118789673
Epoch: 2, Steps: 131 | Train Loss: 0.7278909 Vali Loss: 0.2940679 Best vali loss: 0.2940679
	iters: 100, epoch: 3 | loss: 0.3300571
	speed: 0.0320s/iter; left time: 22.0146s
Updating learning rate to 0.002413798216363244
Epoch: 3 cost time: 2.52769136428833
Epoch: 3, Steps: 131 | Train Loss: 0.3300571 Vali Loss: 0.3144112 Best vali loss: 0.2940679

best validation loss 0.29406785508344147

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0042364658137, 'e_layers': 1, 'learning_rate': 0.0001617390902, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.08695451e-05
Epoch: 4 cost time: 1.0817193984985352
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2806801 Best vali loss: 0.2786607
Updating learning rate to 4.992211000732857e-05
Epoch: 5 cost time: 0.8675293922424316
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2826093 Best vali loss: 0.2786607
Updating learning rate to 2.368614136831867e-05
Epoch: 6 cost time: 0.5398616790771484
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2868731 Best vali loss: 0.2786607
Updating learning rate to 6.155827578611581e-06
Epoch: 7 cost time: 0.5975584983825684
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2895972 Best vali loss: 0.2786607
Updating learning rate to 0.0
Epoch: 8 cost time: 0.657282829284668
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2879390 Best vali loss: 0.2786607

best validation loss 0.27866065558690306

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0096417762243, 'e_layers': 2, 'learning_rate': 0.0005845191883, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0199006
	speed: 0.0149s/iter; left time: 60.8828s
	iters: 200, epoch: 1 | loss: 0.2414231
	speed: 0.0094s/iter; left time: 37.4766s
	iters: 300, epoch: 1 | loss: 0.3253096
	speed: 0.0092s/iter; left time: 35.6971s
	iters: 400, epoch: 1 | loss: 0.8087943
	speed: 0.0081s/iter; left time: 30.5356s
	iters: 500, epoch: 1 | loss: 0.7402161
	speed: 0.0056s/iter; left time: 20.5306s
Updating learning rate to 0.0005622722513652404
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 4.553884267807007
Epoch: 1, Steps: 523 | Train Loss: 0.6271287 Vali Loss: 0.2861974 Best vali loss: 0.2861974
	iters: 100, epoch: 2 | loss: 0.7575610
	speed: 0.0153s/iter; left time: 54.3777s
	iters: 200, epoch: 2 | loss: 0.5265256
	speed: 0.0067s/iter; left time: 23.1060s
	iters: 300, epoch: 2 | loss: 0.2844371
	speed: 0.0068s/iter; left time: 22.7497s
	iters: 400, epoch: 2 | loss: 0.3220869
	speed: 0.0065s/iter; left time: 21.2027s
	iters: 500, epoch: 2 | loss: 0.7846038
	speed: 0.0066s/iter; left time: 20.9707s
Updating learning rate to 0.0004989183350402932
Validation loss decreased (0.2862 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 3.5421030521392822
Epoch: 2, Steps: 523 | Train Loss: 0.5350429 Vali Loss: 0.2826937 Best vali loss: 0.2826937
	iters: 100, epoch: 3 | loss: 0.3279680
	speed: 0.0153s/iter; left time: 46.3827s
	iters: 200, epoch: 3 | loss: 0.3173469
	speed: 0.0066s/iter; left time: 19.2740s
	iters: 300, epoch: 3 | loss: 0.9762986
	speed: 0.0069s/iter; left time: 19.5836s
	iters: 400, epoch: 3 | loss: 0.5210077
	speed: 0.0070s/iter; left time: 19.3034s
	iters: 500, epoch: 3 | loss: 0.5720159
	speed: 0.0063s/iter; left time: 16.5487s
Updating learning rate to 0.0004041024987809501
Epoch: 3 cost time: 3.525456190109253
Epoch: 3, Steps: 523 | Train Loss: 0.5429274 Vali Loss: 0.2843744 Best vali loss: 0.2826937
	iters: 100, epoch: 4 | loss: 0.2677563
	speed: 0.0133s/iter; left time: 33.4811s
	iters: 200, epoch: 4 | loss: 0.5259838
	speed: 0.0056s/iter; left time: 13.5557s
	iters: 300, epoch: 4 | loss: 0.4011876
	speed: 0.0060s/iter; left time: 13.9519s
	iters: 400, epoch: 4 | loss: 0.3730399
	speed: 0.0056s/iter; left time: 12.4372s
	iters: 500, epoch: 4 | loss: 0.5206120
	speed: 0.0055s/iter; left time: 11.7103s
Updating learning rate to 0.00029225959415
Epoch: 4 cost time: 3.020918846130371
Epoch: 4, Steps: 523 | Train Loss: 0.4177159 Vali Loss: 0.2908212 Best vali loss: 0.2826937
	iters: 100, epoch: 5 | loss: 0.4035480
	speed: 0.0156s/iter; left time: 31.0869s
	iters: 200, epoch: 5 | loss: 0.6647595
	speed: 0.0070s/iter; left time: 13.2587s
	iters: 300, epoch: 5 | loss: 0.4528767
	speed: 0.0064s/iter; left time: 11.4472s
	iters: 400, epoch: 5 | loss: 0.3702742
	speed: 0.0057s/iter; left time: 9.7335s
	iters: 500, epoch: 5 | loss: 0.6151750
	speed: 0.0061s/iter; left time: 9.7005s
Updating learning rate to 0.0001804166895190499
Epoch: 5 cost time: 3.385185718536377
Epoch: 5, Steps: 523 | Train Loss: 0.5013267 Vali Loss: 0.2991990 Best vali loss: 0.2826937
	iters: 100, epoch: 6 | loss: 0.4342676
	speed: 0.0121s/iter; left time: 17.7918s
	iters: 200, epoch: 6 | loss: 0.3587090
	speed: 0.0059s/iter; left time: 8.1317s
	iters: 300, epoch: 6 | loss: 0.4928821
	speed: 0.0068s/iter; left time: 8.6965s
	iters: 400, epoch: 6 | loss: 0.2735473
	speed: 0.0073s/iter; left time: 8.4937s
	iters: 500, epoch: 6 | loss: 0.2889120
	speed: 0.0069s/iter; left time: 7.3551s
Updating learning rate to 8.560085325970678e-05
Epoch: 6 cost time: 3.3833847045898438
Epoch: 6, Steps: 523 | Train Loss: 0.3696636 Vali Loss: 0.2964130 Best vali loss: 0.2826937
	iters: 100, epoch: 7 | loss: 0.5798262
	speed: 0.0160s/iter; left time: 15.1511s
	iters: 200, epoch: 7 | loss: 0.3306885
	speed: 0.0065s/iter; left time: 5.5073s
	iters: 300, epoch: 7 | loss: 0.1935427
	speed: 0.0068s/iter; left time: 5.0545s
	iters: 400, epoch: 7 | loss: 0.4194450
	speed: 0.0063s/iter; left time: 4.0883s
	iters: 500, epoch: 7 | loss: 0.3109718
	speed: 0.0056s/iter; left time: 3.0454s
Updating learning rate to 2.2246936934759608e-05
Epoch: 7 cost time: 3.3962838649749756
Epoch: 7, Steps: 523 | Train Loss: 0.3668949 Vali Loss: 0.2998715 Best vali loss: 0.2826937
	iters: 100, epoch: 8 | loss: 0.2566031
	speed: 0.0147s/iter; left time: 6.2333s
	iters: 200, epoch: 8 | loss: 0.2608289
	speed: 0.0062s/iter; left time: 2.0197s
	iters: 300, epoch: 8 | loss: 0.5072646
	speed: 0.0061s/iter; left time: 1.3607s
	iters: 400, epoch: 8 | loss: 0.4251755
	speed: 0.0063s/iter; left time: 0.7802s
	iters: 500, epoch: 8 | loss: 0.4307168
	speed: 0.0067s/iter; left time: 0.1597s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.362079620361328
Epoch: 8, Steps: 523 | Train Loss: 0.3761178 Vali Loss: 0.2998992 Best vali loss: 0.2826937

best validation loss 0.2826936900748689

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0008267342166, 'e_layers': 2, 'learning_rate': 5.54518777e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5619426
	speed: 0.0150s/iter; left time: 14.2537s
Updating learning rate to 5.54518777e-05
Validation loss decreased (inf --> 0.3105).  Saving model state dict ...
Epoch: 1 cost time: 1.502403974533081
Epoch: 1, Steps: 131 | Train Loss: 0.5619426 Vali Loss: 0.3105101 Best vali loss: 0.3105101
	iters: 100, epoch: 2 | loss: 0.7113006
	speed: 0.0186s/iter; left time: 15.1856s
Updating learning rate to 2.772593885e-05
Validation loss decreased (0.3105 --> 0.2935).  Saving model state dict ...
Epoch: 2 cost time: 1.4446628093719482
Epoch: 2, Steps: 131 | Train Loss: 0.7113006 Vali Loss: 0.2935393 Best vali loss: 0.2935393
	iters: 100, epoch: 3 | loss: 0.4295949
	speed: 0.0087s/iter; left time: 5.9989s
Updating learning rate to 1.3862969425e-05
Validation loss decreased (0.2935 --> 0.2891).  Saving model state dict ...
Epoch: 3 cost time: 0.7739207744598389
Epoch: 3, Steps: 131 | Train Loss: 0.4295949 Vali Loss: 0.2890652 Best vali loss: 0.2890652
	iters: 100, epoch: 4 | loss: 0.7186405
	speed: 0.0146s/iter; left time: 8.1361s
Updating learning rate to 6.9314847125e-06
Validation loss decreased (0.2891 --> 0.2871).  Saving model state dict ...
Epoch: 4 cost time: 1.1676974296569824
Epoch: 4, Steps: 131 | Train Loss: 0.7186405 Vali Loss: 0.2871352 Best vali loss: 0.2871352
	iters: 100, epoch: 5 | loss: 0.6834802
	speed: 0.0144s/iter; left time: 6.1330s
Updating learning rate to 3.46574235625e-06
Validation loss decreased (0.2871 --> 0.2863).  Saving model state dict ...
Epoch: 5 cost time: 1.159790277481079
Epoch: 5, Steps: 131 | Train Loss: 0.6834802 Vali Loss: 0.2863494 Best vali loss: 0.2863494
	iters: 100, epoch: 6 | loss: 0.7971507
	speed: 0.0139s/iter; left time: 4.0720s
Updating learning rate to 1.732871178125e-06
Validation loss decreased (0.2863 --> 0.2860).  Saving model state dict ...
Epoch: 6 cost time: 1.0790319442749023
Epoch: 6, Steps: 131 | Train Loss: 0.7971507 Vali Loss: 0.2859902 Best vali loss: 0.2859902
	iters: 100, epoch: 7 | loss: 0.3483988
	speed: 0.0092s/iter; left time: 1.4961s
Updating learning rate to 8.664355890625e-07
Validation loss decreased (0.2860 --> 0.2858).  Saving model state dict ...
Epoch: 7 cost time: 0.6805310249328613
Epoch: 7, Steps: 131 | Train Loss: 0.3483988 Vali Loss: 0.2858147 Best vali loss: 0.2858147
	iters: 100, epoch: 8 | loss: 0.8066959
	speed: 0.0121s/iter; left time: 0.3875s
Updating learning rate to 4.3321779453125e-07
Validation loss decreased (0.2858 --> 0.2857).  Saving model state dict ...
Epoch: 8 cost time: 1.0656228065490723
Epoch: 8, Steps: 131 | Train Loss: 0.8066959 Vali Loss: 0.2857312 Best vali loss: 0.2857312

best validation loss 0.28573124893162055

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0015226276442, 'e_layers': 2, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3626052
	speed: 0.0148s/iter; left time: 14.0361s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.2784).  Saving model state dict ...
Epoch: 1 cost time: 1.4501771926879883
Epoch: 1, Steps: 131 | Train Loss: 0.3626052 Vali Loss: 0.2784405 Best vali loss: 0.2784405
	iters: 100, epoch: 2 | loss: 0.3248960
	speed: 0.0138s/iter; left time: 11.2986s
Updating learning rate to 0.00037646055854993277
Validation loss decreased (0.2784 --> 0.2767).  Saving model state dict ...
Epoch: 2 cost time: 1.0912694931030273
Epoch: 2, Steps: 131 | Train Loss: 0.3248960 Vali Loss: 0.2766900 Best vali loss: 0.2766900
	iters: 100, epoch: 3 | loss: 0.4052781
	speed: 0.0141s/iter; left time: 9.6569s
Updating learning rate to 0.00030491694074585157
Epoch: 3 cost time: 1.1127967834472656
Epoch: 3, Steps: 131 | Train Loss: 0.4052781 Vali Loss: 0.2824717 Best vali loss: 0.2766900

best validation loss 0.2766900031528494

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0107972216151, 'e_layers': 2, 'learning_rate': 0.000270836222, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7693433
	speed: 0.0125s/iter; left time: 51.1099s
	iters: 200, epoch: 1 | loss: 0.4927179
	speed: 0.0061s/iter; left time: 24.1645s
	iters: 300, epoch: 1 | loss: 0.7027795
	speed: 0.0063s/iter; left time: 24.5538s
	iters: 400, epoch: 1 | loss: 0.6634115
	speed: 0.0071s/iter; left time: 26.9735s
	iters: 500, epoch: 1 | loss: 0.4485373
	speed: 0.0072s/iter; left time: 26.4318s
Updating learning rate to 0.0002605281320842415
Validation loss decreased (inf --> 0.2889).  Saving model state dict ...
Epoch: 1 cost time: 3.800213575363159
Epoch: 1, Steps: 523 | Train Loss: 0.6153579 Vali Loss: 0.2889118 Best vali loss: 0.2889118
	iters: 100, epoch: 2 | loss: 0.3373274
	speed: 0.0175s/iter; left time: 62.3190s
	iters: 200, epoch: 2 | loss: 0.6329601
	speed: 0.0070s/iter; left time: 24.2848s
	iters: 300, epoch: 2 | loss: 0.2768478
	speed: 0.0070s/iter; left time: 23.5518s
	iters: 400, epoch: 2 | loss: 0.3031046
	speed: 0.0067s/iter; left time: 21.9265s
	iters: 500, epoch: 2 | loss: 0.4294567
	speed: 0.0065s/iter; left time: 20.4282s
Updating learning rate to 0.00023117317558357257
Validation loss decreased (0.2889 --> 0.2860).  Saving model state dict ...
Epoch: 2 cost time: 3.617750883102417
Epoch: 2, Steps: 523 | Train Loss: 0.3959393 Vali Loss: 0.2859538 Best vali loss: 0.2859538
	iters: 100, epoch: 3 | loss: 0.4301310
	speed: 0.0163s/iter; left time: 49.5294s
	iters: 200, epoch: 3 | loss: 0.3485517
	speed: 0.0065s/iter; left time: 19.1192s
	iters: 300, epoch: 3 | loss: 0.2234326
	speed: 0.0062s/iter; left time: 17.6192s
	iters: 400, epoch: 3 | loss: 0.6659920
	speed: 0.0060s/iter; left time: 16.3556s
	iters: 500, epoch: 3 | loss: 0.3850853
	speed: 0.0068s/iter; left time: 18.0275s
Updating learning rate to 0.00018724037852187671
Epoch: 3 cost time: 3.4102487564086914
Epoch: 3, Steps: 523 | Train Loss: 0.4106385 Vali Loss: 0.2948972 Best vali loss: 0.2859538

best validation loss 0.2859537935403254

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002937171172, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2096083
	speed: 0.0127s/iter; left time: 104.6309s
	iters: 200, epoch: 1 | loss: 0.1966203
	speed: 0.0063s/iter; left time: 51.1863s
	iters: 300, epoch: 1 | loss: 1.3236731
	speed: 0.0069s/iter; left time: 55.5887s
	iters: 400, epoch: 1 | loss: 0.8183087
	speed: 0.0070s/iter; left time: 55.3954s
	iters: 500, epoch: 1 | loss: 0.5421351
	speed: 0.0070s/iter; left time: 54.8615s
	iters: 600, epoch: 1 | loss: 0.5111005
	speed: 0.0069s/iter; left time: 53.6724s
	iters: 700, epoch: 1 | loss: 0.2671277
	speed: 0.0074s/iter; left time: 56.8174s
	iters: 800, epoch: 1 | loss: 0.5468658
	speed: 0.0073s/iter; left time: 55.5133s
	iters: 900, epoch: 1 | loss: 0.5096073
	speed: 0.0074s/iter; left time: 54.8445s
	iters: 1000, epoch: 1 | loss: 0.5070542
	speed: 0.0069s/iter; left time: 50.5835s
Updating learning rate to 0.0002825381750646494
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 7.591046094894409
Epoch: 1, Steps: 1045 | Train Loss: 0.5432101 Vali Loss: 0.2816629 Best vali loss: 0.2816629
	iters: 100, epoch: 2 | loss: 0.2141997
	speed: 0.0246s/iter; left time: 177.4298s
	iters: 200, epoch: 2 | loss: 0.4861475
	speed: 0.0069s/iter; left time: 48.9309s
	iters: 300, epoch: 2 | loss: 0.5380455
	speed: 0.0068s/iter; left time: 47.9308s
	iters: 400, epoch: 2 | loss: 0.3944125
	speed: 0.0069s/iter; left time: 47.3991s
	iters: 500, epoch: 2 | loss: 0.9021071
	speed: 0.0068s/iter; left time: 46.1194s
	iters: 600, epoch: 2 | loss: 0.1959126
	speed: 0.0070s/iter; left time: 47.2976s
	iters: 700, epoch: 2 | loss: 0.1961891
	speed: 0.0066s/iter; left time: 43.6445s
	iters: 800, epoch: 2 | loss: 1.4491080
	speed: 0.0058s/iter; left time: 37.7523s
	iters: 900, epoch: 2 | loss: 0.2640429
	speed: 0.0053s/iter; left time: 34.2448s
	iters: 1000, epoch: 2 | loss: 0.4866329
	speed: 0.0050s/iter; left time: 31.8800s
Updating learning rate to 0.000250703241261342
Epoch: 2 cost time: 6.74285626411438
Epoch: 2, Steps: 1045 | Train Loss: 0.5126798 Vali Loss: 0.2830919 Best vali loss: 0.2816629
	iters: 100, epoch: 3 | loss: 0.5719151
	speed: 0.0242s/iter; left time: 149.2417s
	iters: 200, epoch: 3 | loss: 0.3306130
	speed: 0.0068s/iter; left time: 41.2455s
	iters: 300, epoch: 3 | loss: 0.2504594
	speed: 0.0068s/iter; left time: 40.4072s
	iters: 400, epoch: 3 | loss: 0.3007863
	speed: 0.0064s/iter; left time: 37.4822s
	iters: 500, epoch: 3 | loss: 0.1915551
	speed: 0.0064s/iter; left time: 37.1735s
	iters: 600, epoch: 3 | loss: 0.7354744
	speed: 0.0065s/iter; left time: 36.8888s
	iters: 700, epoch: 3 | loss: 0.2348298
	speed: 0.0068s/iter; left time: 37.6780s
	iters: 800, epoch: 3 | loss: 0.6078723
	speed: 0.0067s/iter; left time: 36.7613s
	iters: 900, epoch: 3 | loss: 0.3115391
	speed: 0.0069s/iter; left time: 36.9442s
	iters: 1000, epoch: 3 | loss: 0.8289465
	speed: 0.0065s/iter; left time: 34.3796s
Updating learning rate to 0.0002030588958772377
Epoch: 3 cost time: 6.965637445449829
Epoch: 3, Steps: 1045 | Train Loss: 0.4363991 Vali Loss: 0.3100945 Best vali loss: 0.2816629

best validation loss 0.2816629215892073

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0015226276442, 'e_layers': 2, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3144093
	speed: 0.0214s/iter; left time: 11.8988s
Updating learning rate to 0.0002205254895
Epoch: 4 cost time: 2.2626750469207764
Epoch: 4, Steps: 131 | Train Loss: 0.3144093 Vali Loss: 0.2821820 Best vali loss: 0.2766900
	iters: 100, epoch: 5 | loss: 0.2555446
	speed: 0.0256s/iter; left time: 10.8765s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.8762712478637695
Epoch: 5, Steps: 131 | Train Loss: 0.2555446 Vali Loss: 0.2933872 Best vali loss: 0.2766900
	iters: 100, epoch: 6 | loss: 0.3148431
	speed: 0.0236s/iter; left time: 6.9238s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 1.8442425727844238
Epoch: 6, Steps: 131 | Train Loss: 0.3148431 Vali Loss: 0.3014677 Best vali loss: 0.2766900
	iters: 100, epoch: 7 | loss: 0.2934092
	speed: 0.0238s/iter; left time: 3.8792s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 1.7913274765014648
Epoch: 7, Steps: 131 | Train Loss: 0.2934092 Vali Loss: 0.3115078 Best vali loss: 0.2766900
	iters: 100, epoch: 8 | loss: 0.2652242
	speed: 0.0192s/iter; left time: 0.6133s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3329575061798096
Epoch: 8, Steps: 131 | Train Loss: 0.2652242 Vali Loss: 0.3156800 Best vali loss: 0.2766900

best validation loss 0.2766900031528494

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0025131341513, 'e_layers': 3, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5026904
	speed: 0.0157s/iter; left time: 31.3717s
	iters: 200, epoch: 1 | loss: 1.2719322
	speed: 0.0092s/iter; left time: 17.3695s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 2.753769636154175
Epoch: 1, Steps: 262 | Train Loss: 0.8873113 Vali Loss: 0.2875629 Best vali loss: 0.2875629
	iters: 100, epoch: 2 | loss: 0.5031419
	speed: 0.0186s/iter; left time: 32.1944s
	iters: 200, epoch: 2 | loss: 0.3582408
	speed: 0.0086s/iter; left time: 14.0223s
Updating learning rate to 0.0014281993853242025
Validation loss decreased (0.2876 --> 0.2820).  Saving model state dict ...
Epoch: 2 cost time: 2.2678067684173584
Epoch: 2, Steps: 262 | Train Loss: 0.4306914 Vali Loss: 0.2819687 Best vali loss: 0.2819687
	iters: 100, epoch: 3 | loss: 0.4321254
	speed: 0.0181s/iter; left time: 26.7304s
	iters: 200, epoch: 3 | loss: 0.4380085
	speed: 0.0089s/iter; left time: 12.1629s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 2.3338510990142822
Epoch: 3, Steps: 262 | Train Loss: 0.4350670 Vali Loss: 0.2960166 Best vali loss: 0.2819687
	iters: 100, epoch: 4 | loss: 0.3194018
	speed: 0.0186s/iter; left time: 22.4913s
	iters: 200, epoch: 4 | loss: 0.5449356
	speed: 0.0090s/iter; left time: 10.0508s
Updating learning rate to 0.00083661983015
Epoch: 4 cost time: 2.4407455921173096
Epoch: 4, Steps: 262 | Train Loss: 0.4321687 Vali Loss: 0.3146568 Best vali loss: 0.2819687
	iters: 100, epoch: 5 | loss: 0.6125799
	speed: 0.0193s/iter; left time: 18.3614s
	iters: 200, epoch: 5 | loss: 0.3586909
	speed: 0.0085s/iter; left time: 7.2385s
Updating learning rate to 0.0005164592819634996
Epoch: 5 cost time: 2.2930750846862793
Epoch: 5, Steps: 262 | Train Loss: 0.4856354 Vali Loss: 0.3076161 Best vali loss: 0.2819687
	iters: 100, epoch: 6 | loss: 0.4248641
	speed: 0.0185s/iter; left time: 12.7293s
	iters: 200, epoch: 6 | loss: 0.2481812
	speed: 0.0087s/iter; left time: 5.0875s
Updating learning rate to 0.0002450402749757974
Epoch: 6 cost time: 2.320049524307251
Epoch: 6, Steps: 262 | Train Loss: 0.3365227 Vali Loss: 0.2982732 Best vali loss: 0.2819687
	iters: 100, epoch: 7 | loss: 0.3715987
	speed: 0.0183s/iter; left time: 7.7938s
	iters: 200, epoch: 7 | loss: 0.2953710
	speed: 0.0081s/iter; left time: 2.6357s
Updating learning rate to 6.368389258134589e-05
Epoch: 7 cost time: 2.239258050918579
Epoch: 7, Steps: 262 | Train Loss: 0.3334848 Vali Loss: 0.3126006 Best vali loss: 0.2819687
	iters: 100, epoch: 8 | loss: 0.6185458
	speed: 0.0194s/iter; left time: 3.1698s
	iters: 200, epoch: 8 | loss: 0.6743057
	speed: 0.0116s/iter; left time: 0.7277s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7604756355285645
Epoch: 8, Steps: 262 | Train Loss: 0.6464258 Vali Loss: 0.3124737 Best vali loss: 0.2819687

best validation loss 0.281968685143408

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.001172531616, 'e_layers': 1, 'learning_rate': 0.0001665995443, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7765701
	speed: 0.0141s/iter; left time: 28.1124s
	iters: 200, epoch: 1 | loss: 0.6428825
	speed: 0.0081s/iter; left time: 15.2898s
Updating learning rate to 0.0001602587267022387
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 2.4350249767303467
Epoch: 1, Steps: 262 | Train Loss: 0.7097263 Vali Loss: 0.2849153 Best vali loss: 0.2849153
	iters: 100, epoch: 2 | loss: 0.2915963
	speed: 0.0208s/iter; left time: 36.0330s
	iters: 200, epoch: 2 | loss: 0.6195571
	speed: 0.0064s/iter; left time: 10.4904s
Updating learning rate to 0.0001422016059085593
Validation loss decreased (0.2849 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 1.7237613201141357
Epoch: 2, Steps: 262 | Train Loss: 0.4555767 Vali Loss: 0.2793731 Best vali loss: 0.2793731
	iters: 100, epoch: 3 | loss: 0.3872877
	speed: 0.0154s/iter; left time: 22.6148s
	iters: 200, epoch: 3 | loss: 0.6428454
	speed: 0.0078s/iter; left time: 10.7340s
Updating learning rate to 0.00011517721487159193
Epoch: 3 cost time: 2.0336155891418457
Epoch: 3, Steps: 262 | Train Loss: 0.5150665 Vali Loss: 0.2800750 Best vali loss: 0.2793731
	iters: 100, epoch: 4 | loss: 0.5787042
	speed: 0.0213s/iter; left time: 25.7584s
	iters: 200, epoch: 4 | loss: 0.9238030
	speed: 0.0068s/iter; left time: 7.5709s
Updating learning rate to 8.329977215e-05
Epoch: 4 cost time: 2.104994058609009
Epoch: 4, Steps: 262 | Train Loss: 0.7512536 Vali Loss: 0.2872967 Best vali loss: 0.2793731
	iters: 100, epoch: 5 | loss: 0.6431968
	speed: 0.0213s/iter; left time: 20.2128s
	iters: 200, epoch: 5 | loss: 0.4844041
	speed: 0.0036s/iter; left time: 3.0515s
Updating learning rate to 5.142232942840809e-05
Epoch: 5 cost time: 1.145434856414795
Epoch: 5, Steps: 262 | Train Loss: 0.5638004 Vali Loss: 0.2794508 Best vali loss: 0.2793731
	iters: 100, epoch: 6 | loss: 0.2701889
	speed: 0.0123s/iter; left time: 8.4483s
	iters: 200, epoch: 6 | loss: 0.2200296
	speed: 0.0068s/iter; left time: 4.0090s
Updating learning rate to 2.439793839144069e-05
Validation loss decreased (0.2794 --> 0.2786).  Saving model state dict ...
Epoch: 6 cost time: 1.7962145805358887
Epoch: 6, Steps: 262 | Train Loss: 0.2451092 Vali Loss: 0.2786208 Best vali loss: 0.2786208
	iters: 100, epoch: 7 | loss: 0.3002077
	speed: 0.0145s/iter; left time: 6.1506s
	iters: 200, epoch: 7 | loss: 0.4319129
	speed: 0.0070s/iter; left time: 2.2642s
Updating learning rate to 6.340817597761298e-06
Epoch: 7 cost time: 1.7826588153839111
Epoch: 7, Steps: 262 | Train Loss: 0.3660603 Vali Loss: 0.2798211 Best vali loss: 0.2786208
	iters: 100, epoch: 8 | loss: 0.3157223
	speed: 0.0151s/iter; left time: 2.4631s
	iters: 200, epoch: 8 | loss: 0.6327137
	speed: 0.0057s/iter; left time: 0.3614s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6919939517974854
Epoch: 8, Steps: 262 | Train Loss: 0.4742180 Vali Loss: 0.2797156 Best vali loss: 0.2786208

best validation loss 0.2786207917444588

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010689527669, 'e_layers': 3, 'learning_rate': 0.003725679424, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4998440
	speed: 0.0198s/iter; left time: 18.7688s
Updating learning rate to 0.00358387919426602
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 2.162243127822876
Epoch: 1, Steps: 131 | Train Loss: 0.4998440 Vali Loss: 0.3217691 Best vali loss: 0.3217691
	iters: 100, epoch: 2 | loss: 0.9486277
	speed: 0.0233s/iter; left time: 19.0742s
Updating learning rate to 0.003180066304618795
Validation loss decreased (0.3218 --> 0.3198).  Saving model state dict ...
Epoch: 2 cost time: 1.7959487438201904
Epoch: 2, Steps: 131 | Train Loss: 0.9486277 Vali Loss: 0.3198270 Best vali loss: 0.3198270
	iters: 100, epoch: 3 | loss: 0.4259245
	speed: 0.0230s/iter; left time: 15.8057s
Updating learning rate to 0.0025757176069341556
Epoch: 3 cost time: 1.854952335357666
Epoch: 3, Steps: 131 | Train Loss: 0.4259245 Vali Loss: 0.3216271 Best vali loss: 0.3198270

best validation loss 0.3198269822531892

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.000861041225, 'e_layers': 4, 'learning_rate': 0.0032606132148, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0032606132148
Validation loss decreased (inf --> 0.2972).  Saving model state dict ...
Epoch: 1 cost time: 1.070932149887085
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2972364 Best vali loss: 0.2972364
Updating learning rate to 0.0016303066074
Validation loss decreased (0.2972 --> 0.2923).  Saving model state dict ...
Epoch: 2 cost time: 0.7422299385070801
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2923020 Best vali loss: 0.2923020
Updating learning rate to 0.0008151533037
Validation loss decreased (0.2923 --> 0.2914).  Saving model state dict ...
Epoch: 3 cost time: 0.7835290431976318
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2914280 Best vali loss: 0.2914280

best validation loss 0.2914280373230438

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008675956226, 'e_layers': 4, 'learning_rate': 0.000135546809, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5493863
	speed: 0.0199s/iter; left time: 39.6892s
	iters: 200, epoch: 1 | loss: 0.4487521
	speed: 0.0131s/iter; left time: 24.9324s
Updating learning rate to 0.000135546809
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 3.7604877948760986
Epoch: 1, Steps: 262 | Train Loss: 0.4990692 Vali Loss: 0.2776474 Best vali loss: 0.2776474
	iters: 100, epoch: 2 | loss: 0.4668840
	speed: 0.0260s/iter; left time: 45.0314s
	iters: 200, epoch: 2 | loss: 0.6729347
	speed: 0.0133s/iter; left time: 21.7463s
Updating learning rate to 6.77734045e-05
Epoch: 2 cost time: 3.4395875930786133
Epoch: 2, Steps: 262 | Train Loss: 0.5699093 Vali Loss: 0.2824329 Best vali loss: 0.2776474
	iters: 100, epoch: 3 | loss: 0.4454594
	speed: 0.0265s/iter; left time: 39.0280s
	iters: 200, epoch: 3 | loss: 0.3848138
	speed: 0.0134s/iter; left time: 18.3436s
Updating learning rate to 3.388670225e-05
Validation loss decreased (0.2776 --> 0.2767).  Saving model state dict ...
Epoch: 3 cost time: 3.491905927658081
Epoch: 3, Steps: 262 | Train Loss: 0.4151366 Vali Loss: 0.2767398 Best vali loss: 0.2767398

best validation loss 0.2767397757465842

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008675956226, 'e_layers': 4, 'learning_rate': 0.000135546809, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4436023
	speed: 0.0207s/iter; left time: 25.0989s
	iters: 200, epoch: 4 | loss: 0.3198384
	speed: 0.0130s/iter; left time: 14.4480s
Updating learning rate to 1.6943351125e-05
Epoch: 4 cost time: 3.778421401977539
Epoch: 4, Steps: 262 | Train Loss: 0.3817203 Vali Loss: 0.2918974 Best vali loss: 0.2767398
	iters: 100, epoch: 5 | loss: 0.4181743
	speed: 0.0260s/iter; left time: 24.6288s
	iters: 200, epoch: 5 | loss: 0.4781928
	speed: 0.0125s/iter; left time: 10.5708s
Updating learning rate to 8.4716755625e-06
Epoch: 5 cost time: 3.276028633117676
Epoch: 5, Steps: 262 | Train Loss: 0.4481836 Vali Loss: 0.2991317 Best vali loss: 0.2767398
	iters: 100, epoch: 6 | loss: 0.4095501
	speed: 0.0267s/iter; left time: 18.3630s
	iters: 200, epoch: 6 | loss: 0.3732089
	speed: 0.0108s/iter; left time: 6.3471s
Updating learning rate to 4.23583778125e-06
Epoch: 6 cost time: 3.1048049926757812
Epoch: 6, Steps: 262 | Train Loss: 0.3913795 Vali Loss: 0.3015322 Best vali loss: 0.2767398
	iters: 100, epoch: 7 | loss: 0.4130180
	speed: 0.0248s/iter; left time: 10.5458s
	iters: 200, epoch: 7 | loss: 0.3778508
	speed: 0.0124s/iter; left time: 4.0447s
Updating learning rate to 2.117918890625e-06
Epoch: 7 cost time: 3.3062829971313477
Epoch: 7, Steps: 262 | Train Loss: 0.3954344 Vali Loss: 0.2972701 Best vali loss: 0.2767398
	iters: 100, epoch: 8 | loss: 0.3265737
	speed: 0.0271s/iter; left time: 4.4142s
	iters: 200, epoch: 8 | loss: 0.5447309
	speed: 0.0116s/iter; left time: 0.7331s
Updating learning rate to 1.0589594453125e-06
Epoch: 8 cost time: 3.060753345489502
Epoch: 8, Steps: 262 | Train Loss: 0.4356523 Vali Loss: 0.3005696 Best vali loss: 0.2767398

best validation loss 0.2767397757465842

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0102976635799, 'e_layers': 2, 'learning_rate': 9.2029474e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4590671
	speed: 0.0138s/iter; left time: 56.5422s
	iters: 200, epoch: 1 | loss: 0.6967982
	speed: 0.0073s/iter; left time: 29.1818s
	iters: 300, epoch: 1 | loss: 0.4131529
	speed: 0.0079s/iter; left time: 30.5270s
	iters: 400, epoch: 1 | loss: 0.4893560
	speed: 0.0078s/iter; left time: 29.3692s
	iters: 500, epoch: 1 | loss: 1.1897467
	speed: 0.0076s/iter; left time: 27.8923s
Updating learning rate to 8.85268107081898e-05
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 4.313841819763184
Epoch: 1, Steps: 523 | Train Loss: 0.6496242 Vali Loss: 0.2805795 Best vali loss: 0.2805795
	iters: 100, epoch: 2 | loss: 0.6229542
	speed: 0.0162s/iter; left time: 57.6387s
	iters: 200, epoch: 2 | loss: 0.9455403
	speed: 0.0073s/iter; left time: 25.2302s
	iters: 300, epoch: 2 | loss: 0.3943603
	speed: 0.0072s/iter; left time: 24.3206s
	iters: 400, epoch: 2 | loss: 0.7829123
	speed: 0.0059s/iter; left time: 19.3695s
	iters: 500, epoch: 2 | loss: 0.3580084
	speed: 0.0052s/iter; left time: 16.5629s
Updating learning rate to 7.855206956721553e-05
Validation loss decreased (0.2806 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 3.404470443725586
Epoch: 2, Steps: 523 | Train Loss: 0.6207551 Vali Loss: 0.2793547 Best vali loss: 0.2793547
	iters: 100, epoch: 3 | loss: 0.2294637
	speed: 0.0151s/iter; left time: 45.7881s
	iters: 200, epoch: 3 | loss: 0.8595051
	speed: 0.0065s/iter; left time: 19.1484s
	iters: 300, epoch: 3 | loss: 0.6459332
	speed: 0.0068s/iter; left time: 19.2941s
	iters: 400, epoch: 3 | loss: 0.6691911
	speed: 0.0069s/iter; left time: 18.8100s
	iters: 500, epoch: 3 | loss: 0.4521288
	speed: 0.0068s/iter; left time: 17.9252s
Updating learning rate to 6.362381449453689e-05
Epoch: 3 cost time: 3.5649850368499756
Epoch: 3, Steps: 523 | Train Loss: 0.5712444 Vali Loss: 0.2830776 Best vali loss: 0.2793547
	iters: 100, epoch: 4 | loss: 0.5501386
	speed: 0.0163s/iter; left time: 41.1211s
	iters: 200, epoch: 4 | loss: 0.5608150
	speed: 0.0068s/iter; left time: 16.3963s
	iters: 300, epoch: 4 | loss: 0.2325245
	speed: 0.0065s/iter; left time: 15.1623s
	iters: 400, epoch: 4 | loss: 0.2521800
	speed: 0.0070s/iter; left time: 15.4028s
	iters: 500, epoch: 4 | loss: 0.3172866
	speed: 0.0069s/iter; left time: 14.5932s
Updating learning rate to 4.6014737e-05
Validation loss decreased (0.2794 --> 0.2790).  Saving model state dict ...
Epoch: 4 cost time: 3.6222288608551025
Epoch: 4, Steps: 523 | Train Loss: 0.3825889 Vali Loss: 0.2790455 Best vali loss: 0.2790455
	iters: 100, epoch: 5 | loss: 0.3067508
	speed: 0.0127s/iter; left time: 25.3222s
	iters: 200, epoch: 5 | loss: 0.4002886
	speed: 0.0049s/iter; left time: 9.3082s
	iters: 300, epoch: 5 | loss: 0.2691858
	speed: 0.0061s/iter; left time: 10.8995s
	iters: 400, epoch: 5 | loss: 0.4000866
	speed: 0.0060s/iter; left time: 10.1365s
	iters: 500, epoch: 5 | loss: 0.8930128
	speed: 0.0063s/iter; left time: 10.0958s
Updating learning rate to 2.840565950546311e-05
Epoch: 5 cost time: 2.9762468338012695
Epoch: 5, Steps: 523 | Train Loss: 0.4538649 Vali Loss: 0.2825255 Best vali loss: 0.2790455
	iters: 100, epoch: 6 | loss: 0.2882533
	speed: 0.0139s/iter; left time: 20.4207s
	iters: 200, epoch: 6 | loss: 0.2401181
	speed: 0.0061s/iter; left time: 8.2888s
	iters: 300, epoch: 6 | loss: 0.3517196
	speed: 0.0055s/iter; left time: 6.9722s
	iters: 400, epoch: 6 | loss: 0.5399814
	speed: 0.0046s/iter; left time: 5.3574s
	iters: 500, epoch: 6 | loss: 0.4393709
	speed: 0.0053s/iter; left time: 5.6537s
Updating learning rate to 1.3477404432784471e-05
Epoch: 6 cost time: 2.983450174331665
Epoch: 6, Steps: 523 | Train Loss: 0.3718887 Vali Loss: 0.2822705 Best vali loss: 0.2790455
	iters: 100, epoch: 7 | loss: 0.5570124
	speed: 0.0138s/iter; left time: 13.1029s
	iters: 200, epoch: 7 | loss: 0.4034900
	speed: 0.0063s/iter; left time: 5.3579s
	iters: 300, epoch: 7 | loss: 0.4622367
	speed: 0.0062s/iter; left time: 4.6511s
	iters: 400, epoch: 7 | loss: 0.5238332
	speed: 0.0063s/iter; left time: 4.0829s
	iters: 500, epoch: 7 | loss: 0.3645575
	speed: 0.0050s/iter; left time: 2.7077s
Updating learning rate to 3.502663291810191e-06
Epoch: 7 cost time: 3.190898895263672
Epoch: 7, Steps: 523 | Train Loss: 0.4622260 Vali Loss: 0.2813403 Best vali loss: 0.2790455
	iters: 100, epoch: 8 | loss: 0.2204537
	speed: 0.0140s/iter; left time: 5.9424s
	iters: 200, epoch: 8 | loss: 0.2308593
	speed: 0.0068s/iter; left time: 2.2058s
	iters: 300, epoch: 8 | loss: 0.7279381
	speed: 0.0059s/iter; left time: 1.3148s
	iters: 400, epoch: 8 | loss: 0.2151203
	speed: 0.0056s/iter; left time: 0.6921s
	iters: 500, epoch: 8 | loss: 0.2473743
	speed: 0.0068s/iter; left time: 0.1620s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.296598434448242
Epoch: 8, Steps: 523 | Train Loss: 0.3283491 Vali Loss: 0.2815585 Best vali loss: 0.2790455

best validation loss 0.27904546795036766

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0032508724534, 'e_layers': 2, 'learning_rate': 0.0006382649953, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4998882
	speed: 0.0130s/iter; left time: 52.9460s
	iters: 200, epoch: 1 | loss: 0.5860854
	speed: 0.0060s/iter; left time: 23.8429s
	iters: 300, epoch: 1 | loss: 0.2439516
	speed: 0.0056s/iter; left time: 21.8908s
	iters: 400, epoch: 1 | loss: 0.9194503
	speed: 0.0067s/iter; left time: 25.2408s
	iters: 500, epoch: 1 | loss: 0.4764512
	speed: 0.0055s/iter; left time: 20.1860s
Updating learning rate to 0.0006382649953
Validation loss decreased (inf --> 0.2906).  Saving model state dict ...
Epoch: 1 cost time: 3.4812161922454834
Epoch: 1, Steps: 523 | Train Loss: 0.5451654 Vali Loss: 0.2906284 Best vali loss: 0.2906284
	iters: 100, epoch: 2 | loss: 0.2703654
	speed: 0.0133s/iter; left time: 47.2538s
	iters: 200, epoch: 2 | loss: 1.0690222
	speed: 0.0051s/iter; left time: 17.5070s
	iters: 300, epoch: 2 | loss: 1.0848720
	speed: 0.0069s/iter; left time: 23.2365s
	iters: 400, epoch: 2 | loss: 0.2953678
	speed: 0.0067s/iter; left time: 21.8712s
	iters: 500, epoch: 2 | loss: 0.4439861
	speed: 0.0075s/iter; left time: 23.6513s
Updating learning rate to 0.00031913249765
Validation loss decreased (0.2906 --> 0.2882).  Saving model state dict ...
Epoch: 2 cost time: 3.4191606044769287
Epoch: 2, Steps: 523 | Train Loss: 0.6327227 Vali Loss: 0.2882101 Best vali loss: 0.2882101
	iters: 100, epoch: 3 | loss: 0.3752660
	speed: 0.0159s/iter; left time: 48.3849s
	iters: 200, epoch: 3 | loss: 0.5509813
	speed: 0.0071s/iter; left time: 20.8259s
	iters: 300, epoch: 3 | loss: 0.3269380
	speed: 0.0063s/iter; left time: 17.9967s
	iters: 400, epoch: 3 | loss: 0.7861170
	speed: 0.0072s/iter; left time: 19.8438s
	iters: 500, epoch: 3 | loss: 0.2855724
	speed: 0.0061s/iter; left time: 16.1831s
Updating learning rate to 0.000159566248825
Epoch: 3 cost time: 3.542762517929077
Epoch: 3, Steps: 523 | Train Loss: 0.4649749 Vali Loss: 0.2931168 Best vali loss: 0.2882101
	iters: 100, epoch: 4 | loss: 0.5890437
	speed: 0.0160s/iter; left time: 40.3660s
	iters: 200, epoch: 4 | loss: 0.4606004
	speed: 0.0066s/iter; left time: 16.0582s
	iters: 300, epoch: 4 | loss: 0.6088869
	speed: 0.0077s/iter; left time: 17.8960s
	iters: 400, epoch: 4 | loss: 0.2878787
	speed: 0.0058s/iter; left time: 12.7773s
	iters: 500, epoch: 4 | loss: 0.3436438
	speed: 0.0066s/iter; left time: 13.8821s
Updating learning rate to 7.97831244125e-05
Epoch: 4 cost time: 3.6329758167266846
Epoch: 4, Steps: 523 | Train Loss: 0.4580107 Vali Loss: 0.2901803 Best vali loss: 0.2882101
	iters: 100, epoch: 5 | loss: 0.7871194
	speed: 0.0172s/iter; left time: 34.1923s
	iters: 200, epoch: 5 | loss: 0.2381902
	speed: 0.0062s/iter; left time: 11.6986s
	iters: 300, epoch: 5 | loss: 0.2901485
	speed: 0.0072s/iter; left time: 12.8538s
	iters: 400, epoch: 5 | loss: 0.4640068
	speed: 0.0067s/iter; left time: 11.4113s
	iters: 500, epoch: 5 | loss: 0.6007566
	speed: 0.0065s/iter; left time: 10.3053s
Updating learning rate to 3.989156220625e-05
Epoch: 5 cost time: 3.6073687076568604
Epoch: 5, Steps: 523 | Train Loss: 0.4760443 Vali Loss: 0.2953699 Best vali loss: 0.2882101
	iters: 100, epoch: 6 | loss: 0.4407280
	speed: 0.0115s/iter; left time: 16.9245s
	iters: 200, epoch: 6 | loss: 0.3344477
	speed: 0.0047s/iter; left time: 6.4487s
	iters: 300, epoch: 6 | loss: 0.8290641
	speed: 0.0102s/iter; left time: 12.9227s
	iters: 400, epoch: 6 | loss: 0.4427490
	speed: 0.0051s/iter; left time: 5.9512s
	iters: 500, epoch: 6 | loss: 0.2749482
	speed: 0.0070s/iter; left time: 7.4612s
Updating learning rate to 1.9945781103125e-05
Epoch: 6 cost time: 3.3958961963653564
Epoch: 6, Steps: 523 | Train Loss: 0.4643874 Vali Loss: 0.2964214 Best vali loss: 0.2882101
	iters: 100, epoch: 7 | loss: 0.3007822
	speed: 0.0174s/iter; left time: 16.5064s
	iters: 200, epoch: 7 | loss: 0.5455746
	speed: 0.0062s/iter; left time: 5.2396s
	iters: 300, epoch: 7 | loss: 0.3405260
	speed: 0.0099s/iter; left time: 7.3836s
	iters: 400, epoch: 7 | loss: 0.5260512
	speed: 0.0055s/iter; left time: 3.5476s
	iters: 500, epoch: 7 | loss: 0.6012192
	speed: 0.0052s/iter; left time: 2.8394s
Updating learning rate to 9.9728905515625e-06
Epoch: 7 cost time: 3.4454827308654785
Epoch: 7, Steps: 523 | Train Loss: 0.4628307 Vali Loss: 0.2955154 Best vali loss: 0.2882101
	iters: 100, epoch: 8 | loss: 0.4122435
	speed: 0.0135s/iter; left time: 5.7350s
	iters: 200, epoch: 8 | loss: 0.3468623
	speed: 0.0055s/iter; left time: 1.7912s
	iters: 300, epoch: 8 | loss: 0.3148668
	speed: 0.0063s/iter; left time: 1.4030s
	iters: 400, epoch: 8 | loss: 0.3164419
	speed: 0.0056s/iter; left time: 0.6922s
	iters: 500, epoch: 8 | loss: 0.5167544
	speed: 0.0053s/iter; left time: 0.1275s
Updating learning rate to 4.98644527578125e-06
Epoch: 8 cost time: 3.002371072769165
Epoch: 8, Steps: 523 | Train Loss: 0.3814338 Vali Loss: 0.2971502 Best vali loss: 0.2882101

best validation loss 0.288210126071581

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0038606158803, 'e_layers': 1, 'learning_rate': 5.94627591e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.94627591e-05
Validation loss decreased (inf --> 0.3530).  Saving model state dict ...
Epoch: 1 cost time: 0.8195061683654785
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3529670 Best vali loss: 0.3529670
Updating learning rate to 2.973137955e-05
Validation loss decreased (0.3530 --> 0.3433).  Saving model state dict ...
Epoch: 2 cost time: 0.6712117195129395
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3432582 Best vali loss: 0.3432582
Updating learning rate to 1.4865689775e-05
Validation loss decreased (0.3433 --> 0.3391).  Saving model state dict ...
Epoch: 3 cost time: 0.33274292945861816
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3391256 Best vali loss: 0.3391256

best validation loss 0.3391255517571599

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0016988904994, 'e_layers': 1, 'learning_rate': 0.0004657171896, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5445457
	speed: 0.0117s/iter; left time: 97.0383s
	iters: 200, epoch: 1 | loss: 1.2630925
	speed: 0.0060s/iter; left time: 49.1291s
	iters: 300, epoch: 1 | loss: 0.2295873
	speed: 0.0056s/iter; left time: 45.3800s
	iters: 400, epoch: 1 | loss: 0.3354220
	speed: 0.0055s/iter; left time: 43.9711s
	iters: 500, epoch: 1 | loss: 0.8707153
	speed: 0.0053s/iter; left time: 41.7385s
	iters: 600, epoch: 1 | loss: 1.0066726
	speed: 0.0058s/iter; left time: 45.0279s
	iters: 700, epoch: 1 | loss: 0.3640042
	speed: 0.0059s/iter; left time: 44.9179s
	iters: 800, epoch: 1 | loss: 0.2094982
	speed: 0.0056s/iter; left time: 42.0484s
	iters: 900, epoch: 1 | loss: 1.9949802
	speed: 0.0058s/iter; left time: 43.0918s
	iters: 1000, epoch: 1 | loss: 0.4439671
	speed: 0.0073s/iter; left time: 53.4324s
Updating learning rate to 0.00044799188450505916
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 6.489155292510986
Epoch: 1, Steps: 1045 | Train Loss: 0.8262485 Vali Loss: 0.2867869 Best vali loss: 0.2867869
	iters: 100, epoch: 2 | loss: 0.4876322
	speed: 0.0250s/iter; left time: 180.3862s
	iters: 200, epoch: 2 | loss: 0.9927253
	speed: 0.0054s/iter; left time: 38.4463s
	iters: 300, epoch: 2 | loss: 0.6868238
	speed: 0.0068s/iter; left time: 47.7423s
	iters: 400, epoch: 2 | loss: 0.2934195
	speed: 0.0064s/iter; left time: 44.2602s
	iters: 500, epoch: 2 | loss: 0.5162303
	speed: 0.0064s/iter; left time: 43.3963s
	iters: 600, epoch: 2 | loss: 0.4870536
	speed: 0.0065s/iter; left time: 43.5954s
	iters: 700, epoch: 2 | loss: 0.2803550
	speed: 0.0065s/iter; left time: 42.7055s
	iters: 800, epoch: 2 | loss: 0.5084773
	speed: 0.0060s/iter; left time: 38.9916s
	iters: 900, epoch: 2 | loss: 0.4352932
	speed: 0.0057s/iter; left time: 36.4005s
	iters: 1000, epoch: 2 | loss: 0.3599626
	speed: 0.0060s/iter; left time: 37.6794s
Updating learning rate to 0.0003975144862406505
Validation loss decreased (0.2868 --> 0.2860).  Saving model state dict ...
Epoch: 2 cost time: 6.381121635437012
Epoch: 2, Steps: 1045 | Train Loss: 0.5047973 Vali Loss: 0.2859828 Best vali loss: 0.2859828
	iters: 100, epoch: 3 | loss: 0.9605308
	speed: 0.0273s/iter; left time: 168.2592s
	iters: 200, epoch: 3 | loss: 0.4227809
	speed: 0.0053s/iter; left time: 31.9055s
	iters: 300, epoch: 3 | loss: 0.2679482
	speed: 0.0054s/iter; left time: 32.5132s
	iters: 400, epoch: 3 | loss: 0.1566791
	speed: 0.0056s/iter; left time: 32.6916s
	iters: 500, epoch: 3 | loss: 0.2831188
	speed: 0.0074s/iter; left time: 42.8008s
	iters: 600, epoch: 3 | loss: 0.4452371
	speed: 0.0075s/iter; left time: 42.2819s
	iters: 700, epoch: 3 | loss: 0.3319274
	speed: 0.0073s/iter; left time: 40.8267s
	iters: 800, epoch: 3 | loss: 0.3640883
	speed: 0.0075s/iter; left time: 40.8215s
	iters: 900, epoch: 3 | loss: 0.3268117
	speed: 0.0066s/iter; left time: 35.6440s
	iters: 1000, epoch: 3 | loss: 0.7577177
	speed: 0.0056s/iter; left time: 29.2944s
Updating learning rate to 0.0003219697211137757
Epoch: 3 cost time: 6.704596519470215
Epoch: 3, Steps: 1045 | Train Loss: 0.4316840 Vali Loss: 0.2928019 Best vali loss: 0.2859828

best validation loss 0.28598279757830414

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009332884638, 'e_layers': 2, 'learning_rate': 0.0005709822629, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005709822629
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 0.9208476543426514
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2862011 Best vali loss: 0.2862011
Updating learning rate to 0.00028549113145
Validation loss decreased (0.2862 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 0.5924606323242188
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2811686 Best vali loss: 0.2811686
Updating learning rate to 0.000142745565725
Epoch: 3 cost time: 0.6298413276672363
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2817032 Best vali loss: 0.2811686

best validation loss 0.2811686097245626

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009332884638, 'e_layers': 2, 'learning_rate': 0.0005709822629, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 7.13727828625e-05
Epoch: 4 cost time: 0.9480013847351074
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2813978 Best vali loss: 0.2811686
Updating learning rate to 3.568639143125e-05
Epoch: 5 cost time: 0.6337687969207764
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2824171 Best vali loss: 0.2811686
Updating learning rate to 1.7843195715625e-05
Epoch: 6 cost time: 1.0179924964904785
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2826937 Best vali loss: 0.2811686
Updating learning rate to 8.9215978578125e-06
Epoch: 7 cost time: 0.6176717281341553
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2828176 Best vali loss: 0.2811686
Updating learning rate to 4.46079892890625e-06
Epoch: 8 cost time: 0.6037731170654297
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2829395 Best vali loss: 0.2811686

best validation loss 0.2811686097245626

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0048980375142, 'e_layers': 3, 'learning_rate': 0.0016469621721, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6212735
	speed: 0.0151s/iter; left time: 30.2041s
	iters: 200, epoch: 1 | loss: 0.8724972
	speed: 0.0083s/iter; left time: 15.7775s
Updating learning rate to 0.0015842784068617606
Validation loss decreased (inf --> 0.2890).  Saving model state dict ...
Epoch: 1 cost time: 2.588426351547241
Epoch: 1, Steps: 262 | Train Loss: 0.7468854 Vali Loss: 0.2889754 Best vali loss: 0.2889754
	iters: 100, epoch: 2 | loss: 0.6202930
	speed: 0.0190s/iter; left time: 32.8904s
	iters: 200, epoch: 2 | loss: 0.6309585
	speed: 0.0090s/iter; left time: 14.7193s
Updating learning rate to 0.0014057701461748177
Validation loss decreased (0.2890 --> 0.2884).  Saving model state dict ...
Epoch: 2 cost time: 2.4275104999542236
Epoch: 2, Steps: 262 | Train Loss: 0.6256257 Vali Loss: 0.2884134 Best vali loss: 0.2884134
	iters: 100, epoch: 3 | loss: 0.2488445
	speed: 0.0201s/iter; left time: 29.6025s
	iters: 200, epoch: 3 | loss: 0.9396347
	speed: 0.0094s/iter; left time: 12.9501s
Updating learning rate to 0.001138613654547346
Epoch: 3 cost time: 2.5391619205474854
Epoch: 3, Steps: 262 | Train Loss: 0.5942396 Vali Loss: 0.2930892 Best vali loss: 0.2884134
	iters: 100, epoch: 4 | loss: 0.8366138
	speed: 0.0190s/iter; left time: 23.0245s
	iters: 200, epoch: 4 | loss: 0.4032221
	speed: 0.0085s/iter; left time: 9.3951s
Updating learning rate to 0.00082348108605
Validation loss decreased (0.2884 --> 0.2860).  Saving model state dict ...
Epoch: 4 cost time: 2.2650084495544434
Epoch: 4, Steps: 262 | Train Loss: 0.6199180 Vali Loss: 0.2859811 Best vali loss: 0.2859811
	iters: 100, epoch: 5 | loss: 0.4349212
	speed: 0.0178s/iter; left time: 16.8964s
	iters: 200, epoch: 5 | loss: 0.3229860
	speed: 0.0091s/iter; left time: 7.7559s
Updating learning rate to 0.0005083485175526542
Epoch: 5 cost time: 2.3503942489624023
Epoch: 5, Steps: 262 | Train Loss: 0.3789536 Vali Loss: 0.2935867 Best vali loss: 0.2859811
	iters: 100, epoch: 6 | loss: 0.4290998
	speed: 0.0192s/iter; left time: 13.2123s
	iters: 200, epoch: 6 | loss: 0.6288682
	speed: 0.0091s/iter; left time: 5.3591s
Updating learning rate to 0.00024119202592518218
Epoch: 6 cost time: 2.524841070175171
Epoch: 6, Steps: 262 | Train Loss: 0.5289840 Vali Loss: 0.2906308 Best vali loss: 0.2859811
	iters: 100, epoch: 7 | loss: 0.4200435
	speed: 0.0225s/iter; left time: 9.5562s
	iters: 200, epoch: 7 | loss: 0.2725388
	speed: 0.0093s/iter; left time: 3.0295s
Updating learning rate to 6.268376523823931e-05
Epoch: 7 cost time: 2.4788897037506104
Epoch: 7, Steps: 262 | Train Loss: 0.3462912 Vali Loss: 0.2956644 Best vali loss: 0.2859811
	iters: 100, epoch: 8 | loss: 0.4109502
	speed: 0.0180s/iter; left time: 2.9310s
	iters: 200, epoch: 8 | loss: 0.3469108
	speed: 0.0096s/iter; left time: 0.6023s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.477599620819092
Epoch: 8, Steps: 262 | Train Loss: 0.3789305 Vali Loss: 0.2961257 Best vali loss: 0.2859811

best validation loss 0.2859811099788521

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066618302916, 'e_layers': 1, 'learning_rate': 0.0005116958539, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0052075
	speed: 0.0132s/iter; left time: 54.1011s
	iters: 200, epoch: 1 | loss: 0.1931416
	speed: 0.0048s/iter; left time: 19.2791s
	iters: 300, epoch: 1 | loss: 0.1671220
	speed: 0.0042s/iter; left time: 16.3072s
	iters: 400, epoch: 1 | loss: 0.3521411
	speed: 0.0053s/iter; left time: 20.1619s
	iters: 500, epoch: 1 | loss: 0.6318694
	speed: 0.0049s/iter; left time: 17.9263s
Updating learning rate to 0.0005116958539
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 3.0541281700134277
Epoch: 1, Steps: 523 | Train Loss: 0.4698963 Vali Loss: 0.2849157 Best vali loss: 0.2849157
	iters: 100, epoch: 2 | loss: 0.6286533
	speed: 0.0115s/iter; left time: 41.0444s
	iters: 200, epoch: 2 | loss: 0.2227700
	speed: 0.0042s/iter; left time: 14.6644s
	iters: 300, epoch: 2 | loss: 0.2852280
	speed: 0.0041s/iter; left time: 13.8516s
	iters: 400, epoch: 2 | loss: 0.4950976
	speed: 0.0043s/iter; left time: 14.0790s
	iters: 500, epoch: 2 | loss: 0.6940731
	speed: 0.0046s/iter; left time: 14.5720s
Updating learning rate to 0.00025584792695
Validation loss decreased (0.2849 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 2.276919364929199
Epoch: 2, Steps: 523 | Train Loss: 0.4651644 Vali Loss: 0.2836835 Best vali loss: 0.2836835
	iters: 100, epoch: 3 | loss: 0.6242142
	speed: 0.0102s/iter; left time: 31.0128s
	iters: 200, epoch: 3 | loss: 0.1862212
	speed: 0.0032s/iter; left time: 9.4293s
	iters: 300, epoch: 3 | loss: 0.3617945
	speed: 0.0037s/iter; left time: 10.4937s
	iters: 400, epoch: 3 | loss: 0.2756055
	speed: 0.0038s/iter; left time: 10.4852s
	iters: 500, epoch: 3 | loss: 0.3277560
	speed: 0.0074s/iter; left time: 19.6460s
Updating learning rate to 0.000127923963475
Validation loss decreased (0.2837 --> 0.2826).  Saving model state dict ...
Epoch: 3 cost time: 2.4582276344299316
Epoch: 3, Steps: 523 | Train Loss: 0.3551183 Vali Loss: 0.2825990 Best vali loss: 0.2825990
	iters: 100, epoch: 4 | loss: 0.5197549
	speed: 0.0209s/iter; left time: 52.4666s
	iters: 200, epoch: 4 | loss: 0.3567272
	speed: 0.0071s/iter; left time: 17.2493s
	iters: 300, epoch: 4 | loss: 0.4495461
	speed: 0.0080s/iter; left time: 18.5126s
	iters: 400, epoch: 4 | loss: 0.2989810
	speed: 0.0044s/iter; left time: 9.8211s
	iters: 500, epoch: 4 | loss: 0.3806904
	speed: 0.0036s/iter; left time: 7.7218s
Updating learning rate to 6.39619817375e-05
Epoch: 4 cost time: 3.2985987663269043
Epoch: 4, Steps: 523 | Train Loss: 0.4011399 Vali Loss: 0.2843161 Best vali loss: 0.2825990
	iters: 100, epoch: 5 | loss: 0.2705951
	speed: 0.0102s/iter; left time: 20.2606s
	iters: 200, epoch: 5 | loss: 0.2901947
	speed: 0.0047s/iter; left time: 8.8349s
	iters: 300, epoch: 5 | loss: 0.2525149
	speed: 0.0041s/iter; left time: 7.3990s
	iters: 400, epoch: 5 | loss: 0.4198286
	speed: 0.0040s/iter; left time: 6.7274s
	iters: 500, epoch: 5 | loss: 0.3123765
	speed: 0.0042s/iter; left time: 6.7523s
Updating learning rate to 3.198099086875e-05
Epoch: 5 cost time: 2.322948694229126
Epoch: 5, Steps: 523 | Train Loss: 0.3091020 Vali Loss: 0.2842304 Best vali loss: 0.2825990
	iters: 100, epoch: 6 | loss: 0.3650469
	speed: 0.0127s/iter; left time: 18.7313s
	iters: 200, epoch: 6 | loss: 0.7420467
	speed: 0.0037s/iter; left time: 5.0690s
	iters: 300, epoch: 6 | loss: 0.2968410
	speed: 0.0043s/iter; left time: 5.4221s
	iters: 400, epoch: 6 | loss: 0.5245448
	speed: 0.0071s/iter; left time: 8.2629s
	iters: 500, epoch: 6 | loss: 0.3071198
	speed: 0.0075s/iter; left time: 8.0647s
Updating learning rate to 1.5990495434375e-05
Epoch: 6 cost time: 2.9111862182617188
Epoch: 6, Steps: 523 | Train Loss: 0.4471198 Vali Loss: 0.2848317 Best vali loss: 0.2825990
	iters: 100, epoch: 7 | loss: 0.3916478
	speed: 0.0195s/iter; left time: 18.4588s
	iters: 200, epoch: 7 | loss: 0.3640793
	speed: 0.0085s/iter; left time: 7.2129s
	iters: 300, epoch: 7 | loss: 0.2714007
	speed: 0.0052s/iter; left time: 3.8897s
	iters: 400, epoch: 7 | loss: 0.4513669
	speed: 0.0044s/iter; left time: 2.8149s
	iters: 500, epoch: 7 | loss: 0.8066803
	speed: 0.0031s/iter; left time: 1.7010s
Updating learning rate to 7.9952477171875e-06
Epoch: 7 cost time: 2.814424514770508
Epoch: 7, Steps: 523 | Train Loss: 0.4570350 Vali Loss: 0.2845587 Best vali loss: 0.2825990
	iters: 100, epoch: 8 | loss: 0.7798032
	speed: 0.0106s/iter; left time: 4.4755s
	iters: 200, epoch: 8 | loss: 0.2551759
	speed: 0.0038s/iter; left time: 1.2336s
	iters: 300, epoch: 8 | loss: 0.5103844
	speed: 0.0044s/iter; left time: 0.9908s
	iters: 400, epoch: 8 | loss: 0.8981122
	speed: 0.0051s/iter; left time: 0.6385s
	iters: 500, epoch: 8 | loss: 0.8148635
	speed: 0.0051s/iter; left time: 0.1217s
Updating learning rate to 3.99762385859375e-06
Epoch: 8 cost time: 2.425661563873291
Epoch: 8, Steps: 523 | Train Loss: 0.6516678 Vali Loss: 0.2847108 Best vali loss: 0.2825990

best validation loss 0.2825990368239097

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0008550192506, 'e_layers': 3, 'learning_rate': 0.0004416276001, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2875298
	speed: 0.0153s/iter; left time: 126.7823s
	iters: 200, epoch: 1 | loss: 0.1747511
	speed: 0.0090s/iter; left time: 73.4765s
	iters: 300, epoch: 1 | loss: 0.5047758
	speed: 0.0070s/iter; left time: 56.1903s
	iters: 400, epoch: 1 | loss: 0.3931826
	speed: 0.0084s/iter; left time: 66.4811s
	iters: 500, epoch: 1 | loss: 0.9711845
	speed: 0.0088s/iter; left time: 69.3693s
	iters: 600, epoch: 1 | loss: 0.3319995
	speed: 0.0071s/iter; left time: 55.3490s
	iters: 700, epoch: 1 | loss: 0.3887914
	speed: 0.0070s/iter; left time: 53.7146s
	iters: 800, epoch: 1 | loss: 0.5391917
	speed: 0.0080s/iter; left time: 60.5496s
	iters: 900, epoch: 1 | loss: 0.3939302
	speed: 0.0076s/iter; left time: 56.6915s
	iters: 1000, epoch: 1 | loss: 0.2556424
	speed: 0.0084s/iter; left time: 61.7743s
Updating learning rate to 0.0004416276001
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 8.719531297683716
Epoch: 1, Steps: 1045 | Train Loss: 0.4240979 Vali Loss: 0.2833996 Best vali loss: 0.2833996
	iters: 100, epoch: 2 | loss: 0.3727705
	speed: 0.0267s/iter; left time: 192.3571s
	iters: 200, epoch: 2 | loss: 0.3140261
	speed: 0.0087s/iter; left time: 62.0038s
	iters: 300, epoch: 2 | loss: 0.1547116
	speed: 0.0077s/iter; left time: 53.7007s
	iters: 400, epoch: 2 | loss: 1.1127840
	speed: 0.0085s/iter; left time: 58.6280s
	iters: 500, epoch: 2 | loss: 0.1977658
	speed: 0.0087s/iter; left time: 59.3432s
	iters: 600, epoch: 2 | loss: 0.3636867
	speed: 0.0087s/iter; left time: 58.4909s
	iters: 700, epoch: 2 | loss: 0.3006963
	speed: 0.0086s/iter; left time: 57.1964s
	iters: 800, epoch: 2 | loss: 0.1570144
	speed: 0.0088s/iter; left time: 57.5030s
	iters: 900, epoch: 2 | loss: 0.1658939
	speed: 0.0080s/iter; left time: 51.4860s
	iters: 1000, epoch: 2 | loss: 0.3355126
	speed: 0.0086s/iter; left time: 54.1344s
Updating learning rate to 0.00022081380005
Validation loss decreased (0.2834 --> 0.2796).  Saving model state dict ...
Epoch: 2 cost time: 8.897733926773071
Epoch: 2, Steps: 1045 | Train Loss: 0.3474862 Vali Loss: 0.2795532 Best vali loss: 0.2795532
	iters: 100, epoch: 3 | loss: 0.3620642
	speed: 0.0279s/iter; left time: 172.3801s
	iters: 200, epoch: 3 | loss: 0.2032417
	speed: 0.0084s/iter; left time: 50.8817s
	iters: 300, epoch: 3 | loss: 0.3491660
	speed: 0.0072s/iter; left time: 43.0179s
	iters: 400, epoch: 3 | loss: 0.3101204
	speed: 0.0077s/iter; left time: 45.4510s
	iters: 500, epoch: 3 | loss: 0.2795387
	speed: 0.0087s/iter; left time: 50.3990s
	iters: 600, epoch: 3 | loss: 0.1395308
	speed: 0.0087s/iter; left time: 49.4674s
	iters: 700, epoch: 3 | loss: 1.0996836
	speed: 0.0085s/iter; left time: 47.1851s
	iters: 800, epoch: 3 | loss: 0.3871137
	speed: 0.0084s/iter; left time: 46.1987s
	iters: 900, epoch: 3 | loss: 0.2140942
	speed: 0.0085s/iter; left time: 45.8020s
	iters: 1000, epoch: 3 | loss: 0.2756969
	speed: 0.0079s/iter; left time: 41.4275s
Updating learning rate to 0.000110406900025
Epoch: 3 cost time: 8.585621118545532
Epoch: 3, Steps: 1045 | Train Loss: 0.3620250 Vali Loss: 0.2796840 Best vali loss: 0.2795532

best validation loss 0.2795531535157487

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070672586952, 'e_layers': 3, 'learning_rate': 0.0003408111846, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.8104841
	speed: 0.0155s/iter; left time: 127.8565s
	iters: 200, epoch: 1 | loss: 1.2873318
	speed: 0.0083s/iter; left time: 68.1392s
	iters: 300, epoch: 1 | loss: 0.1926880
	speed: 0.0084s/iter; left time: 67.6517s
	iters: 400, epoch: 1 | loss: 0.2141744
	speed: 0.0088s/iter; left time: 70.3610s
	iters: 500, epoch: 1 | loss: 0.5244767
	speed: 0.0088s/iter; left time: 69.5142s
	iters: 600, epoch: 1 | loss: 1.4121959
	speed: 0.0087s/iter; left time: 67.2838s
	iters: 700, epoch: 1 | loss: 0.2665108
	speed: 0.0088s/iter; left time: 67.2765s
	iters: 800, epoch: 1 | loss: 0.4027646
	speed: 0.0083s/iter; left time: 63.0390s
	iters: 900, epoch: 1 | loss: 0.2619054
	speed: 0.0071s/iter; left time: 52.7313s
	iters: 1000, epoch: 1 | loss: 0.2074952
	speed: 0.0068s/iter; left time: 49.7454s
Updating learning rate to 0.00032783983125143294
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 9.060024738311768
Epoch: 1, Steps: 1045 | Train Loss: 0.6580027 Vali Loss: 0.2856559 Best vali loss: 0.2856559
	iters: 100, epoch: 2 | loss: 0.3065690
	speed: 0.0295s/iter; left time: 213.0141s
	iters: 200, epoch: 2 | loss: 0.3508692
	speed: 0.0089s/iter; left time: 63.0836s
	iters: 300, epoch: 2 | loss: 0.5572813
	speed: 0.0091s/iter; left time: 63.8806s
	iters: 400, epoch: 2 | loss: 0.6049322
	speed: 0.0082s/iter; left time: 57.0408s
	iters: 500, epoch: 2 | loss: 0.8662758
	speed: 0.0062s/iter; left time: 42.2973s
	iters: 600, epoch: 2 | loss: 0.4263277
	speed: 0.0080s/iter; left time: 53.6375s
	iters: 700, epoch: 2 | loss: 0.5540422
	speed: 0.0084s/iter; left time: 55.5276s
	iters: 800, epoch: 2 | loss: 0.4273530
	speed: 0.0085s/iter; left time: 55.6462s
	iters: 900, epoch: 2 | loss: 0.3933041
	speed: 0.0088s/iter; left time: 56.6005s
	iters: 1000, epoch: 2 | loss: 0.3024848
	speed: 0.0091s/iter; left time: 57.3127s
Updating learning rate to 0.0002909005421674401
Validation loss decreased (0.2857 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 8.876950979232788
Epoch: 2, Steps: 1045 | Train Loss: 0.4789439 Vali Loss: 0.2837481 Best vali loss: 0.2837481
	iters: 100, epoch: 3 | loss: 0.2339461
	speed: 0.0279s/iter; left time: 171.9808s
	iters: 200, epoch: 3 | loss: 1.0693989
	speed: 0.0092s/iter; left time: 56.0464s
	iters: 300, epoch: 3 | loss: 0.2116075
	speed: 0.0094s/iter; left time: 56.2372s
	iters: 400, epoch: 3 | loss: 0.5024754
	speed: 0.0079s/iter; left time: 46.5749s
	iters: 500, epoch: 3 | loss: 0.4288681
	speed: 0.0077s/iter; left time: 44.4375s
	iters: 600, epoch: 3 | loss: 0.2355104
	speed: 0.0069s/iter; left time: 39.3877s
	iters: 700, epoch: 3 | loss: 0.3026688
	speed: 0.0078s/iter; left time: 43.4569s
	iters: 800, epoch: 3 | loss: 0.2875113
	speed: 0.0089s/iter; left time: 48.5054s
	iters: 900, epoch: 3 | loss: 0.2401298
	speed: 0.0080s/iter; left time: 42.7934s
	iters: 1000, epoch: 3 | loss: 0.5159015
	speed: 0.0084s/iter; left time: 44.3546s
Updating learning rate to 0.00023561698925557014
Epoch: 3 cost time: 8.760805130004883
Epoch: 3, Steps: 1045 | Train Loss: 0.4028018 Vali Loss: 0.3060998 Best vali loss: 0.2837481

best validation loss 0.2837480767015278

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0114836372493, 'e_layers': 1, 'learning_rate': 0.0001759530142, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5227059
	speed: 0.0126s/iter; left time: 25.1892s
	iters: 200, epoch: 1 | loss: 0.6156776
	speed: 0.0069s/iter; left time: 13.1648s
Updating learning rate to 0.0001692562013515239
Validation loss decreased (inf --> 0.2910).  Saving model state dict ...
Epoch: 1 cost time: 2.1178104877471924
Epoch: 1, Steps: 262 | Train Loss: 0.5691918 Vali Loss: 0.2909945 Best vali loss: 0.2909945
	iters: 100, epoch: 2 | loss: 0.2647788
	speed: 0.0169s/iter; left time: 29.2652s
	iters: 200, epoch: 2 | loss: 0.4004667
	speed: 0.0063s/iter; left time: 10.3632s
Updating learning rate to 0.00015018529185551642
Validation loss decreased (0.2910 --> 0.2821).  Saving model state dict ...
Epoch: 2 cost time: 1.6662375926971436
Epoch: 2, Steps: 262 | Train Loss: 0.3326228 Vali Loss: 0.2820868 Best vali loss: 0.2820868
	iters: 100, epoch: 3 | loss: 0.3172562
	speed: 0.0141s/iter; left time: 20.7559s
	iters: 200, epoch: 3 | loss: 0.3949227
	speed: 0.0060s/iter; left time: 8.2366s
Updating learning rate to 0.00012164365880451969
Validation loss decreased (0.2821 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 1.5657312870025635
Epoch: 3, Steps: 262 | Train Loss: 0.3560895 Vali Loss: 0.2819301 Best vali loss: 0.2819301

best validation loss 0.2819301204505841

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0008550192506, 'e_layers': 3, 'learning_rate': 0.0004416276001, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2475376
	speed: 0.0141s/iter; left time: 72.2028s
	iters: 200, epoch: 4 | loss: 0.1621818
	speed: 0.0081s/iter; left time: 40.7270s
	iters: 300, epoch: 4 | loss: 0.4913338
	speed: 0.0083s/iter; left time: 40.9603s
	iters: 400, epoch: 4 | loss: 0.3553458
	speed: 0.0073s/iter; left time: 35.0410s
	iters: 500, epoch: 4 | loss: 0.4336681
	speed: 0.0074s/iter; left time: 34.8478s
	iters: 600, epoch: 4 | loss: 0.3226138
	speed: 0.0085s/iter; left time: 39.1927s
	iters: 700, epoch: 4 | loss: 0.3753812
	speed: 0.0084s/iter; left time: 38.1876s
	iters: 800, epoch: 4 | loss: 0.4269293
	speed: 0.0085s/iter; left time: 37.5495s
	iters: 900, epoch: 4 | loss: 0.3434676
	speed: 0.0085s/iter; left time: 36.6282s
	iters: 1000, epoch: 4 | loss: 0.2385472
	speed: 0.0079s/iter; left time: 33.2687s
Updating learning rate to 5.52034500125e-05
Epoch: 4 cost time: 8.697336673736572
Epoch: 4, Steps: 1045 | Train Loss: 0.3397006 Vali Loss: 0.2857357 Best vali loss: 0.2795532
	iters: 100, epoch: 5 | loss: 0.2364448
	speed: 0.0260s/iter; left time: 106.2665s
	iters: 200, epoch: 5 | loss: 0.3162130
	speed: 0.0085s/iter; left time: 33.8120s
	iters: 300, epoch: 5 | loss: 0.1546762
	speed: 0.0083s/iter; left time: 32.0548s
	iters: 400, epoch: 5 | loss: 0.8533391
	speed: 0.0077s/iter; left time: 29.2536s
	iters: 500, epoch: 5 | loss: 0.2061381
	speed: 0.0079s/iter; left time: 28.9086s
	iters: 600, epoch: 5 | loss: 0.2336157
	speed: 0.0078s/iter; left time: 27.9552s
	iters: 700, epoch: 5 | loss: 0.2882666
	speed: 0.0074s/iter; left time: 25.6612s
	iters: 800, epoch: 5 | loss: 0.1258883
	speed: 0.0068s/iter; left time: 22.9820s
	iters: 900, epoch: 5 | loss: 0.1516175
	speed: 0.0078s/iter; left time: 25.6603s
	iters: 1000, epoch: 5 | loss: 0.2696352
	speed: 0.0074s/iter; left time: 23.4552s
Updating learning rate to 2.760172500625e-05
Epoch: 5 cost time: 8.204806327819824
Epoch: 5, Steps: 1045 | Train Loss: 0.2835835 Vali Loss: 0.2820420 Best vali loss: 0.2795532
	iters: 100, epoch: 6 | loss: 0.3470702
	speed: 0.0228s/iter; left time: 69.1972s
	iters: 200, epoch: 6 | loss: 0.1757265
	speed: 0.0085s/iter; left time: 25.0947s
	iters: 300, epoch: 6 | loss: 0.3038573
	speed: 0.0068s/iter; left time: 19.1899s
	iters: 400, epoch: 6 | loss: 0.2808524
	speed: 0.0095s/iter; left time: 26.0608s
	iters: 500, epoch: 6 | loss: 0.2470060
	speed: 0.0097s/iter; left time: 25.6098s
	iters: 600, epoch: 6 | loss: 0.1615360
	speed: 0.0095s/iter; left time: 24.1845s
	iters: 700, epoch: 6 | loss: 0.8435724
	speed: 0.0062s/iter; left time: 15.1871s
	iters: 800, epoch: 6 | loss: 0.3093948
	speed: 0.0092s/iter; left time: 21.4575s
	iters: 900, epoch: 6 | loss: 0.2153205
	speed: 0.0091s/iter; left time: 20.3798s
	iters: 1000, epoch: 6 | loss: 0.2552795
	speed: 0.0088s/iter; left time: 18.7190s
Updating learning rate to 1.3800862503125e-05
Epoch: 6 cost time: 8.912451982498169
Epoch: 6, Steps: 1045 | Train Loss: 0.3139616 Vali Loss: 0.2840602 Best vali loss: 0.2795532
	iters: 100, epoch: 7 | loss: 0.5505777
	speed: 0.0247s/iter; left time: 49.2187s
	iters: 200, epoch: 7 | loss: 0.7854430
	speed: 0.0079s/iter; left time: 14.8821s
	iters: 300, epoch: 7 | loss: 0.6369331
	speed: 0.0073s/iter; left time: 13.0006s
	iters: 400, epoch: 7 | loss: 0.4930052
	speed: 0.0078s/iter; left time: 13.1520s
	iters: 500, epoch: 7 | loss: 0.4200561
	speed: 0.0073s/iter; left time: 11.6143s
	iters: 600, epoch: 7 | loss: 0.1364149
	speed: 0.0078s/iter; left time: 11.5949s
	iters: 700, epoch: 7 | loss: 0.3123006
	speed: 0.0096s/iter; left time: 13.3425s
	iters: 800, epoch: 7 | loss: 0.1949131
	speed: 0.0089s/iter; left time: 11.4858s
	iters: 900, epoch: 7 | loss: 0.2787029
	speed: 0.0092s/iter; left time: 10.9559s
	iters: 1000, epoch: 7 | loss: 0.5092911
	speed: 0.0103s/iter; left time: 11.2521s
Updating learning rate to 6.9004312515625e-06
Epoch: 7 cost time: 8.852404832839966
Epoch: 7, Steps: 1045 | Train Loss: 0.4317638 Vali Loss: 0.2875790 Best vali loss: 0.2795532
	iters: 100, epoch: 8 | loss: 0.1548135
	speed: 0.0292s/iter; left time: 27.6231s
	iters: 200, epoch: 8 | loss: 0.8249492
	speed: 0.0082s/iter; left time: 6.8965s
	iters: 300, epoch: 8 | loss: 0.2929284
	speed: 0.0098s/iter; left time: 7.3038s
	iters: 400, epoch: 8 | loss: 0.3149166
	speed: 0.0078s/iter; left time: 5.0546s
	iters: 500, epoch: 8 | loss: 0.4174230
	speed: 0.0091s/iter; left time: 4.9935s
	iters: 600, epoch: 8 | loss: 0.5747646
	speed: 0.0087s/iter; left time: 3.8908s
	iters: 700, epoch: 8 | loss: 0.2251090
	speed: 0.0096s/iter; left time: 3.3217s
	iters: 800, epoch: 8 | loss: 0.2158702
	speed: 0.0079s/iter; left time: 1.9378s
	iters: 900, epoch: 8 | loss: 0.1823653
	speed: 0.0097s/iter; left time: 1.4111s
	iters: 1000, epoch: 8 | loss: 0.1885767
	speed: 0.0084s/iter; left time: 0.3866s
Updating learning rate to 3.45021562578125e-06
Epoch: 8 cost time: 9.377378225326538
Epoch: 8, Steps: 1045 | Train Loss: 0.3391717 Vali Loss: 0.2871784 Best vali loss: 0.2795532

best validation loss 0.2795531535157487

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0061485272437, 'e_layers': 2, 'learning_rate': 0.000928155274, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000928155274
Validation loss decreased (inf --> 0.2897).  Saving model state dict ...
Epoch: 1 cost time: 1.1233954429626465
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2896779 Best vali loss: 0.2896779
Updating learning rate to 0.000464077637
Epoch: 2 cost time: 1.0706403255462646
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3015582 Best vali loss: 0.2896779
Updating learning rate to 0.0002320388185
Epoch: 3 cost time: 1.7308878898620605
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2902557 Best vali loss: 0.2896779
Updating learning rate to 0.00011601940925
Epoch: 4 cost time: 1.0267527103424072
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2904125 Best vali loss: 0.2896779
Updating learning rate to 5.8009704625e-05
Validation loss decreased (0.2897 --> 0.2825).  Saving model state dict ...
Epoch: 5 cost time: 1.0187549591064453
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2824535 Best vali loss: 0.2824535
Updating learning rate to 2.90048523125e-05
Epoch: 6 cost time: 1.414994716644287
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2883321 Best vali loss: 0.2824535
Updating learning rate to 1.450242615625e-05
Epoch: 7 cost time: 1.04551100730896
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2899361 Best vali loss: 0.2824535
Updating learning rate to 7.251213078125e-06
Epoch: 8 cost time: 1.517841100692749
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2903768 Best vali loss: 0.2824535

best validation loss 0.2824535153254828

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0064662068206, 'e_layers': 2, 'learning_rate': 0.0003291915652, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4780597
	speed: 0.0129s/iter; left time: 52.7616s
	iters: 200, epoch: 1 | loss: 0.3796090
	speed: 0.0062s/iter; left time: 24.8458s
	iters: 300, epoch: 1 | loss: 1.0857581
	speed: 0.0062s/iter; left time: 24.2200s
	iters: 400, epoch: 1 | loss: 0.7026973
	speed: 0.0062s/iter; left time: 23.3164s
	iters: 500, epoch: 1 | loss: 0.7921255
	speed: 0.0055s/iter; left time: 20.4332s
Updating learning rate to 0.00031666245728181734
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 3.513537645339966
Epoch: 1, Steps: 523 | Train Loss: 0.6876499 Vali Loss: 0.2841161 Best vali loss: 0.2841161
	iters: 100, epoch: 2 | loss: 0.3704999
	speed: 0.0149s/iter; left time: 53.1061s
	iters: 200, epoch: 2 | loss: 0.6823400
	speed: 0.0064s/iter; left time: 22.2191s
	iters: 300, epoch: 2 | loss: 0.5341672
	speed: 0.0061s/iter; left time: 20.4812s
	iters: 400, epoch: 2 | loss: 0.3717777
	speed: 0.0062s/iter; left time: 20.1643s
	iters: 500, epoch: 2 | loss: 0.3833715
	speed: 0.0063s/iter; left time: 19.9618s
Updating learning rate to 0.00028098257663116674
Epoch: 2 cost time: 3.2982723712921143
Epoch: 2, Steps: 523 | Train Loss: 0.4684313 Vali Loss: 0.2873533 Best vali loss: 0.2841161
	iters: 100, epoch: 3 | loss: 0.4229846
	speed: 0.0144s/iter; left time: 43.7047s
	iters: 200, epoch: 3 | loss: 0.7002606
	speed: 0.0065s/iter; left time: 19.0077s
	iters: 300, epoch: 3 | loss: 0.3558673
	speed: 0.0066s/iter; left time: 18.6949s
	iters: 400, epoch: 3 | loss: 0.3807526
	speed: 0.0064s/iter; left time: 17.5942s
	iters: 500, epoch: 3 | loss: 0.3530057
	speed: 0.0064s/iter; left time: 16.8167s
Updating learning rate to 0.00022758386163818613
Epoch: 3 cost time: 3.425215005874634
Epoch: 3, Steps: 523 | Train Loss: 0.4425741 Vali Loss: 0.2874456 Best vali loss: 0.2841161
	iters: 100, epoch: 4 | loss: 0.3642894
	speed: 0.0148s/iter; left time: 37.1458s
	iters: 200, epoch: 4 | loss: 0.6442267
	speed: 0.0061s/iter; left time: 14.7128s
	iters: 300, epoch: 4 | loss: 0.8745637
	speed: 0.0065s/iter; left time: 15.1461s
	iters: 400, epoch: 4 | loss: 0.2779424
	speed: 0.0065s/iter; left time: 14.3733s
	iters: 500, epoch: 4 | loss: 0.2991631
	speed: 0.0062s/iter; left time: 13.0679s
Updating learning rate to 0.0001645957826
Epoch: 4 cost time: 3.334555149078369
Epoch: 4, Steps: 523 | Train Loss: 0.4920371 Vali Loss: 0.2852840 Best vali loss: 0.2841161
	iters: 100, epoch: 5 | loss: 0.7138256
	speed: 0.0146s/iter; left time: 29.1720s
	iters: 200, epoch: 5 | loss: 0.7349796
	speed: 0.0057s/iter; left time: 10.8493s
	iters: 300, epoch: 5 | loss: 0.6861660
	speed: 0.0063s/iter; left time: 11.2558s
	iters: 400, epoch: 5 | loss: 0.8381273
	speed: 0.0062s/iter; left time: 10.4968s
	iters: 500, epoch: 5 | loss: 0.4797888
	speed: 0.0062s/iter; left time: 9.9439s
Updating learning rate to 0.00010160770356181388
Epoch: 5 cost time: 3.2736029624938965
Epoch: 5, Steps: 523 | Train Loss: 0.6905775 Vali Loss: 0.2841330 Best vali loss: 0.2841161
	iters: 100, epoch: 6 | loss: 0.2546633
	speed: 0.0152s/iter; left time: 22.4068s
	iters: 200, epoch: 6 | loss: 0.2735224
	speed: 0.0060s/iter; left time: 8.2675s
	iters: 300, epoch: 6 | loss: 0.4740573
	speed: 0.0060s/iter; left time: 7.6064s
	iters: 400, epoch: 6 | loss: 0.5409612
	speed: 0.0053s/iter; left time: 6.1885s
	iters: 500, epoch: 6 | loss: 0.7465856
	speed: 0.0064s/iter; left time: 6.8725s
Updating learning rate to 4.820898856883326e-05
Validation loss decreased (0.2841 --> 0.2836).  Saving model state dict ...
Epoch: 6 cost time: 3.173626661300659
Epoch: 6, Steps: 523 | Train Loss: 0.4579580 Vali Loss: 0.2835923 Best vali loss: 0.2835923
	iters: 100, epoch: 7 | loss: 0.3761615
	speed: 0.0158s/iter; left time: 14.9501s
	iters: 200, epoch: 7 | loss: 0.2907866
	speed: 0.0061s/iter; left time: 5.1360s
	iters: 300, epoch: 7 | loss: 0.2667001
	speed: 0.0062s/iter; left time: 4.6414s
	iters: 400, epoch: 7 | loss: 0.3307435
	speed: 0.0059s/iter; left time: 3.8122s
	iters: 500, epoch: 7 | loss: 0.3607411
	speed: 0.0065s/iter; left time: 3.5318s
Updating learning rate to 1.2529107918182615e-05
Epoch: 7 cost time: 3.3163716793060303
Epoch: 7, Steps: 523 | Train Loss: 0.3250266 Vali Loss: 0.2848033 Best vali loss: 0.2835923
	iters: 100, epoch: 8 | loss: 0.4839370
	speed: 0.0128s/iter; left time: 5.4371s
	iters: 200, epoch: 8 | loss: 0.2472024
	speed: 0.0051s/iter; left time: 1.6406s
	iters: 300, epoch: 8 | loss: 0.2812809
	speed: 0.0054s/iter; left time: 1.2001s
	iters: 400, epoch: 8 | loss: 0.6171864
	speed: 0.0053s/iter; left time: 0.6554s
	iters: 500, epoch: 8 | loss: 0.4929046
	speed: 0.0050s/iter; left time: 0.1198s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7705516815185547
Epoch: 8, Steps: 523 | Train Loss: 0.4245023 Vali Loss: 0.2844421 Best vali loss: 0.2835923

best validation loss 0.2835922996132912

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0050180427789, 'e_layers': 2, 'learning_rate': 0.0003075357702, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6189176
	speed: 0.0125s/iter; left time: 103.2066s
	iters: 200, epoch: 1 | loss: 0.6310467
	speed: 0.0076s/iter; left time: 62.3489s
	iters: 300, epoch: 1 | loss: 0.9241619
	speed: 0.0070s/iter; left time: 56.0961s
	iters: 400, epoch: 1 | loss: 0.1867513
	speed: 0.0053s/iter; left time: 41.8132s
	iters: 500, epoch: 1 | loss: 0.2643666
	speed: 0.0053s/iter; left time: 41.6125s
	iters: 600, epoch: 1 | loss: 0.3475038
	speed: 0.0080s/iter; left time: 61.7780s
	iters: 700, epoch: 1 | loss: 0.3911122
	speed: 0.0079s/iter; left time: 60.8623s
	iters: 800, epoch: 1 | loss: 0.2726869
	speed: 0.0069s/iter; left time: 52.4504s
	iters: 900, epoch: 1 | loss: 0.7567284
	speed: 0.0095s/iter; left time: 71.0372s
	iters: 1000, epoch: 1 | loss: 0.2853265
	speed: 0.0107s/iter; left time: 78.6010s
Updating learning rate to 0.0002958308869014373
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 8.236543655395508
Epoch: 1, Steps: 1045 | Train Loss: 0.4678602 Vali Loss: 0.2839790 Best vali loss: 0.2839790
	iters: 100, epoch: 2 | loss: 1.2632537
	speed: 0.0342s/iter; left time: 246.8482s
	iters: 200, epoch: 2 | loss: 1.1541820
	speed: 0.0092s/iter; left time: 65.7618s
	iters: 300, epoch: 2 | loss: 0.8374129
	speed: 0.0101s/iter; left time: 70.7894s
	iters: 400, epoch: 2 | loss: 0.4218614
	speed: 0.0107s/iter; left time: 73.8008s
	iters: 500, epoch: 2 | loss: 0.2839723
	speed: 0.0097s/iter; left time: 66.2143s
	iters: 600, epoch: 2 | loss: 0.3842855
	speed: 0.0078s/iter; left time: 52.3109s
	iters: 700, epoch: 2 | loss: 0.2354706
	speed: 0.0101s/iter; left time: 67.0869s
	iters: 800, epoch: 2 | loss: 0.3432331
	speed: 0.0092s/iter; left time: 60.1441s
	iters: 900, epoch: 2 | loss: 0.2701482
	speed: 0.0093s/iter; left time: 59.4694s
	iters: 1000, epoch: 2 | loss: 0.3107053
	speed: 0.0107s/iter; left time: 67.4457s
Updating learning rate to 0.0002624981993829239
Validation loss decreased (0.2840 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 10.270339488983154
Epoch: 2, Steps: 1045 | Train Loss: 0.5504525 Vali Loss: 0.2836688 Best vali loss: 0.2836688
	iters: 100, epoch: 3 | loss: 0.6678156
	speed: 0.0305s/iter; left time: 187.9097s
	iters: 200, epoch: 3 | loss: 0.2574006
	speed: 0.0083s/iter; left time: 50.5560s
	iters: 300, epoch: 3 | loss: 0.6903261
	speed: 0.0048s/iter; left time: 28.8297s
	iters: 400, epoch: 3 | loss: 0.3988269
	speed: 0.0051s/iter; left time: 29.7481s
	iters: 500, epoch: 3 | loss: 0.7954730
	speed: 0.0071s/iter; left time: 40.8582s
	iters: 600, epoch: 3 | loss: 0.3451697
	speed: 0.0074s/iter; left time: 41.9963s
	iters: 700, epoch: 3 | loss: 0.3136812
	speed: 0.0073s/iter; left time: 40.6697s
	iters: 800, epoch: 3 | loss: 0.2086308
	speed: 0.0077s/iter; left time: 42.1804s
	iters: 900, epoch: 3 | loss: 0.3903241
	speed: 0.0069s/iter; left time: 36.8731s
	iters: 1000, epoch: 3 | loss: 0.6606125
	speed: 0.0071s/iter; left time: 37.2120s
Updating learning rate to 0.00021261230715758877
Validation loss decreased (0.2837 --> 0.2826).  Saving model state dict ...
Epoch: 3 cost time: 7.252362489700317
Epoch: 3, Steps: 1045 | Train Loss: 0.4728260 Vali Loss: 0.2826272 Best vali loss: 0.2826272

best validation loss 0.28262720667393776

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0106713451806, 'e_layers': 2, 'learning_rate': 0.0001415547229, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4566960
	speed: 0.0147s/iter; left time: 60.1634s
	iters: 200, epoch: 1 | loss: 0.5695336
	speed: 0.0067s/iter; left time: 26.6097s
	iters: 300, epoch: 1 | loss: 0.3195682
	speed: 0.0074s/iter; left time: 28.7107s
	iters: 400, epoch: 1 | loss: 0.7568037
	speed: 0.0081s/iter; left time: 30.7501s
	iters: 500, epoch: 1 | loss: 0.3613077
	speed: 0.0080s/iter; left time: 29.3287s
Updating learning rate to 0.0001361671170588084
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 4.363329887390137
Epoch: 1, Steps: 523 | Train Loss: 0.4927819 Vali Loss: 0.2864010 Best vali loss: 0.2864010
	iters: 100, epoch: 2 | loss: 0.3623007
	speed: 0.0197s/iter; left time: 70.0451s
	iters: 200, epoch: 2 | loss: 0.3453570
	speed: 0.0078s/iter; left time: 26.9479s
	iters: 300, epoch: 2 | loss: 0.3558035
	speed: 0.0068s/iter; left time: 22.8109s
	iters: 400, epoch: 2 | loss: 0.6653609
	speed: 0.0065s/iter; left time: 21.2113s
	iters: 500, epoch: 2 | loss: 0.6458900
	speed: 0.0072s/iter; left time: 22.6968s
Updating learning rate to 0.00012082451368578634
Validation loss decreased (0.2864 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 3.879657745361328
Epoch: 2, Steps: 523 | Train Loss: 0.4749424 Vali Loss: 0.2814533 Best vali loss: 0.2814533
	iters: 100, epoch: 3 | loss: 1.0600886
	speed: 0.0180s/iter; left time: 54.6654s
	iters: 200, epoch: 3 | loss: 0.3346458
	speed: 0.0068s/iter; left time: 19.9378s
	iters: 300, epoch: 3 | loss: 0.3603001
	speed: 0.0076s/iter; left time: 21.4539s
	iters: 400, epoch: 3 | loss: 0.2428980
	speed: 0.0069s/iter; left time: 18.8935s
	iters: 500, epoch: 3 | loss: 0.2723380
	speed: 0.0071s/iter; left time: 18.8061s
Updating learning rate to 9.78626850634306e-05
Epoch: 3 cost time: 3.7873458862304688
Epoch: 3, Steps: 523 | Train Loss: 0.4540541 Vali Loss: 0.2880368 Best vali loss: 0.2814533

best validation loss 0.28145328597447916

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010878951032, 'e_layers': 4, 'learning_rate': 0.0009739953589, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6243706
	speed: 0.0273s/iter; left time: 25.8941s
Updating learning rate to 0.0009739953589
Validation loss decreased (inf --> 0.2820).  Saving model state dict ...
Epoch: 1 cost time: 2.961409568786621
Epoch: 1, Steps: 131 | Train Loss: 0.6243706 Vali Loss: 0.2819956 Best vali loss: 0.2819956
	iters: 100, epoch: 2 | loss: 0.6550813
	speed: 0.0309s/iter; left time: 25.2936s
Updating learning rate to 0.00048699767945
Epoch: 2 cost time: 2.3790283203125
Epoch: 2, Steps: 131 | Train Loss: 0.6550813 Vali Loss: 0.2850345 Best vali loss: 0.2819956
	iters: 100, epoch: 3 | loss: 0.6435800
	speed: 0.0378s/iter; left time: 25.9367s
Updating learning rate to 0.000243498839725
Epoch: 3 cost time: 3.1051998138427734
Epoch: 3, Steps: 131 | Train Loss: 0.6435800 Vali Loss: 0.2860520 Best vali loss: 0.2819956

best validation loss 0.2819955740421844

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0106713451806, 'e_layers': 2, 'learning_rate': 0.0001415547229, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3448372
	speed: 0.0146s/iter; left time: 36.7326s
	iters: 200, epoch: 4 | loss: 0.4346588
	speed: 0.0077s/iter; left time: 18.6149s
	iters: 300, epoch: 4 | loss: 0.3057829
	speed: 0.0075s/iter; left time: 17.3567s
	iters: 400, epoch: 4 | loss: 0.4103103
	speed: 0.0070s/iter; left time: 15.6166s
	iters: 500, epoch: 4 | loss: 0.3045703
	speed: 0.0063s/iter; left time: 13.2427s
Updating learning rate to 7.077736145e-05
Epoch: 4 cost time: 4.075628042221069
Epoch: 4, Steps: 523 | Train Loss: 0.3600319 Vali Loss: 0.2887930 Best vali loss: 0.2814533
	iters: 100, epoch: 5 | loss: 0.3169230
	speed: 0.0151s/iter; left time: 30.1628s
	iters: 200, epoch: 5 | loss: 0.2134324
	speed: 0.0083s/iter; left time: 15.8036s
	iters: 300, epoch: 5 | loss: 0.2992793
	speed: 0.0080s/iter; left time: 14.3534s
	iters: 400, epoch: 5 | loss: 0.3595898
	speed: 0.0082s/iter; left time: 13.8703s
	iters: 500, epoch: 5 | loss: 0.4919035
	speed: 0.0084s/iter; left time: 13.3662s
Updating learning rate to 4.369203783656942e-05
Epoch: 5 cost time: 4.186697721481323
Epoch: 5, Steps: 523 | Train Loss: 0.3362256 Vali Loss: 0.2914264 Best vali loss: 0.2814533
	iters: 100, epoch: 6 | loss: 0.7426369
	speed: 0.0194s/iter; left time: 28.4740s
	iters: 200, epoch: 6 | loss: 0.2881639
	speed: 0.0086s/iter; left time: 11.7363s
	iters: 300, epoch: 6 | loss: 0.2867469
	speed: 0.0082s/iter; left time: 10.4512s
	iters: 400, epoch: 6 | loss: 0.2110974
	speed: 0.0079s/iter; left time: 9.2946s
	iters: 500, epoch: 6 | loss: 0.2385543
	speed: 0.0081s/iter; left time: 8.6500s
Updating learning rate to 2.073020921421367e-05
Epoch: 6 cost time: 4.392984390258789
Epoch: 6, Steps: 523 | Train Loss: 0.3534399 Vali Loss: 0.3014433 Best vali loss: 0.2814533
	iters: 100, epoch: 7 | loss: 0.3336726
	speed: 0.0201s/iter; left time: 19.0183s
	iters: 200, epoch: 7 | loss: 0.2212099
	speed: 0.0058s/iter; left time: 4.9106s
	iters: 300, epoch: 7 | loss: 0.4816270
	speed: 0.0051s/iter; left time: 3.7935s
	iters: 400, epoch: 7 | loss: 0.2884368
	speed: 0.0071s/iter; left time: 4.5793s
	iters: 500, epoch: 7 | loss: 0.1741947
	speed: 0.0079s/iter; left time: 4.3270s
Updating learning rate to 5.387605841191633e-06
Epoch: 7 cost time: 3.617039918899536
Epoch: 7, Steps: 523 | Train Loss: 0.2998282 Vali Loss: 0.2971667 Best vali loss: 0.2814533
	iters: 100, epoch: 8 | loss: 0.2502040
	speed: 0.0176s/iter; left time: 7.4778s
	iters: 200, epoch: 8 | loss: 0.1603792
	speed: 0.0079s/iter; left time: 2.5499s
	iters: 300, epoch: 8 | loss: 0.2860666
	speed: 0.0082s/iter; left time: 1.8261s
	iters: 400, epoch: 8 | loss: 0.5712292
	speed: 0.0075s/iter; left time: 0.9347s
	iters: 500, epoch: 8 | loss: 0.1489614
	speed: 0.0077s/iter; left time: 0.1846s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.121942520141602
Epoch: 8, Steps: 523 | Train Loss: 0.2833681 Vali Loss: 0.3025722 Best vali loss: 0.2814533

best validation loss 0.28145328597447916

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0023318495337, 'e_layers': 1, 'learning_rate': 0.0001023204346, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2517797
	speed: 0.0110s/iter; left time: 44.8081s
	iters: 200, epoch: 1 | loss: 0.3518163
	speed: 0.0046s/iter; left time: 18.3433s
	iters: 300, epoch: 1 | loss: 0.2726513
	speed: 0.0052s/iter; left time: 20.2721s
	iters: 400, epoch: 1 | loss: 0.7178960
	speed: 0.0049s/iter; left time: 18.3904s
	iters: 500, epoch: 1 | loss: 0.2825764
	speed: 0.0046s/iter; left time: 17.0556s
Updating learning rate to 0.0001023204346
Validation loss decreased (inf --> 0.2961).  Saving model state dict ...
Epoch: 1 cost time: 2.8196849822998047
Epoch: 1, Steps: 523 | Train Loss: 0.3753439 Vali Loss: 0.2960624 Best vali loss: 0.2960624
	iters: 100, epoch: 2 | loss: 0.2868957
	speed: 0.0130s/iter; left time: 46.2318s
	iters: 200, epoch: 2 | loss: 0.7103897
	speed: 0.0049s/iter; left time: 16.8104s
	iters: 300, epoch: 2 | loss: 1.0816901
	speed: 0.0051s/iter; left time: 16.9828s
	iters: 400, epoch: 2 | loss: 0.6397830
	speed: 0.0048s/iter; left time: 15.7450s
	iters: 500, epoch: 2 | loss: 0.3654938
	speed: 0.0042s/iter; left time: 13.2633s
Updating learning rate to 5.11602173e-05
Validation loss decreased (0.2961 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 2.5201284885406494
Epoch: 2, Steps: 523 | Train Loss: 0.6168505 Vali Loss: 0.2839014 Best vali loss: 0.2839014
	iters: 100, epoch: 3 | loss: 0.2386195
	speed: 0.0146s/iter; left time: 44.2241s
	iters: 200, epoch: 3 | loss: 0.3334313
	speed: 0.0058s/iter; left time: 17.0525s
	iters: 300, epoch: 3 | loss: 0.9294845
	speed: 0.0060s/iter; left time: 16.9908s
	iters: 400, epoch: 3 | loss: 0.4510987
	speed: 0.0054s/iter; left time: 14.7145s
	iters: 500, epoch: 3 | loss: 0.6743412
	speed: 0.0043s/iter; left time: 11.4281s
Updating learning rate to 2.558010865e-05
Validation loss decreased (0.2839 --> 0.2824).  Saving model state dict ...
Epoch: 3 cost time: 2.9435322284698486
Epoch: 3, Steps: 523 | Train Loss: 0.5253951 Vali Loss: 0.2824127 Best vali loss: 0.2824127
	iters: 100, epoch: 4 | loss: 0.3440347
	speed: 0.0163s/iter; left time: 40.9126s
	iters: 200, epoch: 4 | loss: 0.3024094
	speed: 0.0057s/iter; left time: 13.8045s
	iters: 300, epoch: 4 | loss: 0.1971451
	speed: 0.0055s/iter; left time: 12.6345s
	iters: 400, epoch: 4 | loss: 0.4257762
	speed: 0.0052s/iter; left time: 11.4891s
	iters: 500, epoch: 4 | loss: 1.1781914
	speed: 0.0060s/iter; left time: 12.7978s
Updating learning rate to 1.2790054325e-05
Validation loss decreased (0.2824 --> 0.2823).  Saving model state dict ...
Epoch: 4 cost time: 3.0109405517578125
Epoch: 4, Steps: 523 | Train Loss: 0.4895114 Vali Loss: 0.2823455 Best vali loss: 0.2823455
	iters: 100, epoch: 5 | loss: 0.2832615
	speed: 0.0161s/iter; left time: 31.9989s
	iters: 200, epoch: 5 | loss: 0.6845262
	speed: 0.0045s/iter; left time: 8.4691s
	iters: 300, epoch: 5 | loss: 0.8226388
	speed: 0.0051s/iter; left time: 9.2094s
	iters: 400, epoch: 5 | loss: 1.6010323
	speed: 0.0057s/iter; left time: 9.5967s
	iters: 500, epoch: 5 | loss: 0.4310017
	speed: 0.0056s/iter; left time: 8.8843s
Updating learning rate to 6.3950271625e-06
Validation loss decreased (0.2823 --> 0.2823).  Saving model state dict ...
Epoch: 5 cost time: 2.8691258430480957
Epoch: 5, Steps: 523 | Train Loss: 0.7644921 Vali Loss: 0.2823064 Best vali loss: 0.2823064
	iters: 100, epoch: 6 | loss: 0.4792427
	speed: 0.0154s/iter; left time: 22.6855s
	iters: 200, epoch: 6 | loss: 0.4225991
	speed: 0.0056s/iter; left time: 7.7248s
	iters: 300, epoch: 6 | loss: 0.2960193
	speed: 0.0059s/iter; left time: 7.4424s
	iters: 400, epoch: 6 | loss: 0.4332097
	speed: 0.0059s/iter; left time: 6.8523s
	iters: 500, epoch: 6 | loss: 0.2482822
	speed: 0.0063s/iter; left time: 6.7157s
Updating learning rate to 3.19751358125e-06
Epoch: 6 cost time: 3.049856424331665
Epoch: 6, Steps: 523 | Train Loss: 0.3758706 Vali Loss: 0.2823163 Best vali loss: 0.2823064
	iters: 100, epoch: 7 | loss: 0.2934917
	speed: 0.0130s/iter; left time: 12.3561s
	iters: 200, epoch: 7 | loss: 0.4815281
	speed: 0.0034s/iter; left time: 2.9148s
	iters: 300, epoch: 7 | loss: 0.4008113
	speed: 0.0050s/iter; left time: 3.7266s
	iters: 400, epoch: 7 | loss: 0.7964621
	speed: 0.0061s/iter; left time: 3.9144s
	iters: 500, epoch: 7 | loss: 0.3590598
	speed: 0.0065s/iter; left time: 3.5474s
Updating learning rate to 1.598756790625e-06
Validation loss decreased (0.2823 --> 0.2823).  Saving model state dict ...
Epoch: 7 cost time: 2.7742390632629395
Epoch: 7, Steps: 523 | Train Loss: 0.4662706 Vali Loss: 0.2822747 Best vali loss: 0.2822747
	iters: 100, epoch: 8 | loss: 0.5893646
	speed: 0.0177s/iter; left time: 7.4987s
	iters: 200, epoch: 8 | loss: 0.5839034
	speed: 0.0061s/iter; left time: 1.9612s
	iters: 300, epoch: 8 | loss: 0.8130222
	speed: 0.0064s/iter; left time: 1.4419s
	iters: 400, epoch: 8 | loss: 0.6177546
	speed: 0.0059s/iter; left time: 0.7283s
	iters: 500, epoch: 8 | loss: 0.5351657
	speed: 0.0061s/iter; left time: 0.1460s
Updating learning rate to 7.993783953125e-07
Validation loss decreased (0.2823 --> 0.2823).  Saving model state dict ...
Epoch: 8 cost time: 3.2408030033111572
Epoch: 8, Steps: 523 | Train Loss: 0.6278421 Vali Loss: 0.2822644 Best vali loss: 0.2822644

best validation loss 0.2822643876818309

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0113367829942, 'e_layers': 4, 'learning_rate': 0.0036198803168, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1462992
	speed: 0.0205s/iter; left time: 83.5736s
	iters: 200, epoch: 1 | loss: 0.4967883
	speed: 0.0122s/iter; left time: 48.4924s
	iters: 300, epoch: 1 | loss: 0.4832620
	speed: 0.0131s/iter; left time: 50.9391s
	iters: 400, epoch: 1 | loss: 0.3255660
	speed: 0.0128s/iter; left time: 48.5169s
	iters: 500, epoch: 1 | loss: 0.9956422
	speed: 0.0122s/iter; left time: 44.9597s
Updating learning rate to 0.0034821068258159963
Validation loss decreased (inf --> 0.3253).  Saving model state dict ...
Epoch: 1 cost time: 7.0509326457977295
Epoch: 1, Steps: 523 | Train Loss: 0.6895115 Vali Loss: 0.3253287 Best vali loss: 0.3253287
	iters: 100, epoch: 2 | loss: 0.9216627
	speed: 0.0244s/iter; left time: 87.0070s
	iters: 200, epoch: 2 | loss: 0.5497683
	speed: 0.0112s/iter; left time: 38.9447s
	iters: 300, epoch: 2 | loss: 0.6994167
	speed: 0.0138s/iter; left time: 46.4820s
	iters: 400, epoch: 2 | loss: 0.3807304
	speed: 0.0140s/iter; left time: 45.5716s
	iters: 500, epoch: 2 | loss: 0.9075472
	speed: 0.0130s/iter; left time: 40.9720s
Updating learning rate to 0.003089761117946494
Validation loss decreased (0.3253 --> 0.3223).  Saving model state dict ...
Epoch: 2 cost time: 6.648218631744385
Epoch: 2, Steps: 523 | Train Loss: 0.6918251 Vali Loss: 0.3222587 Best vali loss: 0.3222587
	iters: 100, epoch: 3 | loss: 0.5869352
	speed: 0.0273s/iter; left time: 82.9303s
	iters: 200, epoch: 3 | loss: 0.2421177
	speed: 0.0137s/iter; left time: 40.2320s
	iters: 300, epoch: 3 | loss: 0.5658692
	speed: 0.0136s/iter; left time: 38.6395s
	iters: 400, epoch: 3 | loss: 0.2826866
	speed: 0.0125s/iter; left time: 34.2018s
	iters: 500, epoch: 3 | loss: 0.2510922
	speed: 0.0106s/iter; left time: 28.0109s
Updating learning rate to 0.0025025742705919265
Epoch: 3 cost time: 6.6714677810668945
Epoch: 3, Steps: 523 | Train Loss: 0.3857402 Vali Loss: 0.3246310 Best vali loss: 0.3222587
	iters: 100, epoch: 4 | loss: 0.4961847
	speed: 0.0272s/iter; left time: 68.3717s
	iters: 200, epoch: 4 | loss: 0.2576745
	speed: 0.0128s/iter; left time: 30.9917s
	iters: 300, epoch: 4 | loss: 0.9274648
	speed: 0.0135s/iter; left time: 31.1619s
	iters: 400, epoch: 4 | loss: 0.3134442
	speed: 0.0120s/iter; left time: 26.5495s
	iters: 500, epoch: 4 | loss: 0.4804832
	speed: 0.0141s/iter; left time: 29.7651s
Updating learning rate to 0.0018099401584
Epoch: 4 cost time: 7.005575895309448
Epoch: 4, Steps: 523 | Train Loss: 0.4950503 Vali Loss: 0.3224461 Best vali loss: 0.3222587
	iters: 100, epoch: 5 | loss: 1.1097354
	speed: 0.0277s/iter; left time: 55.1276s
	iters: 200, epoch: 5 | loss: 0.2460003
	speed: 0.0122s/iter; left time: 23.0076s
	iters: 300, epoch: 5 | loss: 0.7924498
	speed: 0.0135s/iter; left time: 24.2652s
	iters: 400, epoch: 5 | loss: 1.6564654
	speed: 0.0139s/iter; left time: 23.5022s
	iters: 500, epoch: 5 | loss: 0.3760596
	speed: 0.0105s/iter; left time: 16.7477s
Updating learning rate to 0.0011173060462080738
Validation loss decreased (0.3223 --> 0.3213).  Saving model state dict ...
Epoch: 5 cost time: 6.6460607051849365
Epoch: 5, Steps: 523 | Train Loss: 0.8361421 Vali Loss: 0.3212970 Best vali loss: 0.3212970
	iters: 100, epoch: 6 | loss: 0.5055606
	speed: 0.0313s/iter; left time: 45.9439s
	iters: 200, epoch: 6 | loss: 0.2153193
	speed: 0.0217s/iter; left time: 29.6606s
	iters: 300, epoch: 6 | loss: 0.2896743
	speed: 0.0178s/iter; left time: 22.5789s
	iters: 400, epoch: 6 | loss: 0.2973267
	speed: 0.0108s/iter; left time: 12.6932s
	iters: 500, epoch: 6 | loss: 0.9316652
	speed: 0.0117s/iter; left time: 12.5592s
Updating learning rate to 0.0005301191988535062
Epoch: 6 cost time: 8.58229923248291
Epoch: 6, Steps: 523 | Train Loss: 0.4479092 Vali Loss: 0.3220190 Best vali loss: 0.3212970
	iters: 100, epoch: 7 | loss: 1.6089629
	speed: 0.0264s/iter; left time: 25.0428s
	iters: 200, epoch: 7 | loss: 0.2568999
	speed: 0.0122s/iter; left time: 10.3751s
	iters: 300, epoch: 7 | loss: 0.2147050
	speed: 0.0090s/iter; left time: 6.7323s
	iters: 400, epoch: 7 | loss: 1.0802680
	speed: 0.0078s/iter; left time: 5.0628s
	iters: 500, epoch: 7 | loss: 0.7517358
	speed: 0.0108s/iter; left time: 5.8900s
Updating learning rate to 0.00013777349098400372
Epoch: 7 cost time: 5.580394506454468
Epoch: 7, Steps: 523 | Train Loss: 0.7825143 Vali Loss: 0.3222355 Best vali loss: 0.3212970
	iters: 100, epoch: 8 | loss: 0.4748618
	speed: 0.0215s/iter; left time: 9.1102s
	iters: 200, epoch: 8 | loss: 0.6376080
	speed: 0.0098s/iter; left time: 3.1862s
	iters: 300, epoch: 8 | loss: 1.1948797
	speed: 0.0091s/iter; left time: 2.0405s
	iters: 400, epoch: 8 | loss: 0.2170458
	speed: 0.0086s/iter; left time: 1.0622s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0046655666653, 'e_layers': 3, 'learning_rate': 7.57219308e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4248180
	speed: 0.0273s/iter; left time: 25.9396s
Updating learning rate to 7.57219308e-05
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 2.9517507553100586
Epoch: 1, Steps: 131 | Train Loss: 0.4248180 Vali Loss: 0.2840307 Best vali loss: 0.2840307
	iters: 100, epoch: 2 | loss: 0.4119399
	speed: 0.0183s/iter; left time: 14.9436s
Updating learning rate to 3.78609654e-05
Validation loss decreased (0.2840 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 1.1582543849945068
Epoch: 2, Steps: 131 | Train Loss: 0.4119399 Vali Loss: 0.2780716 Best vali loss: 0.2780716
	iters: 100, epoch: 3 | loss: 0.4512617
	speed: 0.0235s/iter; left time: 16.1779s
Updating learning rate to 1.89304827e-05
Epoch: 3 cost time: 2.1880085468292236
Epoch: 3, Steps: 131 | Train Loss: 0.4512617 Vali Loss: 0.2796345 Best vali loss: 0.2780716

best validation loss 0.278071640359287

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0035061395926, 'e_layers': 2, 'learning_rate': 0.0026530275697, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0026530275697
Validation loss decreased (inf --> 0.3061).  Saving model state dict ...
Epoch: 1 cost time: 1.9141626358032227
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3060927 Best vali loss: 0.3060927
Updating learning rate to 0.00132651378485
Validation loss decreased (0.3061 --> 0.2929).  Saving model state dict ...
Epoch: 2 cost time: 0.9772508144378662
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2929293 Best vali loss: 0.2929293
Updating learning rate to 0.000663256892425
Epoch: 3 cost time: 1.1362760066986084
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2961743 Best vali loss: 0.2929293

best validation loss 0.292929330538001

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0026424596683, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0026424596683
Validation loss decreased (inf --> 0.3185).  Saving model state dict ...
Epoch: 1 cost time: 1.2106196880340576
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3185028 Best vali loss: 0.3185028
Updating learning rate to 0.00132122983415
Validation loss decreased (0.3185 --> 0.3061).  Saving model state dict ...
Epoch: 2 cost time: 1.4719550609588623
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3060638 Best vali loss: 0.3060638
Updating learning rate to 0.000660614917075
Epoch: 3 cost time: 1.2640891075134277
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3099942 Best vali loss: 0.3060638

best validation loss 0.3060638199689531

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0046655666653, 'e_layers': 3, 'learning_rate': 7.57219308e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4111664
	speed: 0.0287s/iter; left time: 15.9533s
Updating learning rate to 9.46524135e-06
Epoch: 4 cost time: 2.8004205226898193
Epoch: 4, Steps: 131 | Train Loss: 0.4111664 Vali Loss: 0.2788692 Best vali loss: 0.2780716
	iters: 100, epoch: 5 | loss: 0.4118340
	speed: 0.0301s/iter; left time: 12.7987s
Updating learning rate to 4.732620675e-06
Epoch: 5 cost time: 2.78013277053833
Epoch: 5, Steps: 131 | Train Loss: 0.4118340 Vali Loss: 0.2788928 Best vali loss: 0.2780716
	iters: 100, epoch: 6 | loss: 0.4262844
	speed: 0.0317s/iter; left time: 9.3160s
Updating learning rate to 2.3663103375e-06
Epoch: 6 cost time: 2.5318644046783447
Epoch: 6, Steps: 131 | Train Loss: 0.4262844 Vali Loss: 0.2789137 Best vali loss: 0.2780716
	iters: 100, epoch: 7 | loss: 0.5111682
	speed: 0.0365s/iter; left time: 5.9499s
Updating learning rate to 1.18315516875e-06
Epoch: 7 cost time: 2.409980535507202
Epoch: 7, Steps: 131 | Train Loss: 0.5111682 Vali Loss: 0.2789047 Best vali loss: 0.2780716
	iters: 100, epoch: 8 | loss: 0.4394181
	speed: 0.0178s/iter; left time: 0.5705s
Updating learning rate to 5.91577584375e-07
Epoch: 8 cost time: 1.798628330230713
Epoch: 8, Steps: 131 | Train Loss: 0.4394181 Vali Loss: 0.2789250 Best vali loss: 0.2780716

best validation loss 0.278071640359287

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014959330094, 'e_layers': 3, 'learning_rate': 0.0013609748645, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5739810
	speed: 0.0207s/iter; left time: 41.3981s
	iters: 200, epoch: 1 | loss: 0.9659879
	speed: 0.0147s/iter; left time: 27.9218s
Updating learning rate to 0.0013609748645
Validation loss decreased (inf --> 0.3078).  Saving model state dict ...
Epoch: 1 cost time: 3.994584321975708
Epoch: 1, Steps: 262 | Train Loss: 0.7699845 Vali Loss: 0.3077949 Best vali loss: 0.3077949
	iters: 100, epoch: 2 | loss: 0.7003347
	speed: 0.0348s/iter; left time: 60.3208s
	iters: 200, epoch: 2 | loss: 0.4016627
	speed: 0.0115s/iter; left time: 18.8550s
Updating learning rate to 0.00068048743225
Epoch: 2 cost time: 3.091984510421753
Epoch: 2, Steps: 262 | Train Loss: 0.5509987 Vali Loss: 0.3188274 Best vali loss: 0.3077949
	iters: 100, epoch: 3 | loss: 0.7448091
	speed: 0.0205s/iter; left time: 30.1518s
	iters: 200, epoch: 3 | loss: 0.4647002
	speed: 0.0112s/iter; left time: 15.3246s
Updating learning rate to 0.000340243716125
Epoch: 3 cost time: 2.9240036010742188
Epoch: 3, Steps: 262 | Train Loss: 0.6047546 Vali Loss: 0.3246059 Best vali loss: 0.3077949
	iters: 100, epoch: 4 | loss: 1.0560540
	speed: 0.0298s/iter; left time: 36.1328s
	iters: 200, epoch: 4 | loss: 0.5204733
	speed: 0.0132s/iter; left time: 14.6611s
Updating learning rate to 0.0001701218580625
Epoch: 4 cost time: 3.216890335083008
Epoch: 4, Steps: 262 | Train Loss: 0.7882636 Vali Loss: 0.3221600 Best vali loss: 0.3077949
	iters: 100, epoch: 5 | loss: 0.6829132
	speed: 0.0482s/iter; left time: 45.7392s
	iters: 200, epoch: 5 | loss: 0.3102708
	speed: 0.0132s/iter; left time: 11.2124s
Updating learning rate to 8.506092903125e-05
Epoch: 5 cost time: 3.9417378902435303
Epoch: 5, Steps: 262 | Train Loss: 0.4965920 Vali Loss: 0.3228572 Best vali loss: 0.3077949
	iters: 100, epoch: 6 | loss: 0.5403234
	speed: 0.0531s/iter; left time: 36.4889s
	iters: 200, epoch: 6 | loss: 0.6757079
	speed: 0.0146s/iter; left time: 8.5523s
Updating learning rate to 4.2530464515625e-05
Epoch: 6 cost time: 3.835507869720459
Epoch: 6, Steps: 262 | Train Loss: 0.6080157 Vali Loss: 0.3223528 Best vali loss: 0.3077949
	iters: 100, epoch: 7 | loss: 0.5245593
	speed: 0.0462s/iter; left time: 19.6229s
	iters: 200, epoch: 7 | loss: 0.5339422
	speed: 0.0104s/iter; left time: 3.3726s
Updating learning rate to 2.12652322578125e-05
Epoch: 7 cost time: 3.2245235443115234
Epoch: 7, Steps: 262 | Train Loss: 0.5292507 Vali Loss: 0.3218864 Best vali loss: 0.3077949
	iters: 100, epoch: 8 | loss: 0.4523842
	speed: 0.0358s/iter; left time: 5.8338s
	iters: 200, epoch: 8 | loss: 0.4593682
	speed: 0.0100s/iter; left time: 0.6276s
Updating learning rate to 1.063261612890625e-05
Epoch: 8 cost time: 2.7233784198760986
Epoch: 8, Steps: 262 | Train Loss: 0.4558762 Vali Loss: 0.3220688 Best vali loss: 0.3077949

best validation loss 0.30779487834450214

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0015090895163, 'e_layers': 1, 'learning_rate': 0.0034093170466, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0034093170466
Validation loss decreased (inf --> 0.2922).  Saving model state dict ...
Epoch: 1 cost time: 1.7947208881378174
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2922336 Best vali loss: 0.2922336
Updating learning rate to 0.0017046585233
Validation loss decreased (0.2922 --> 0.2916).  Saving model state dict ...
Epoch: 2 cost time: 1.0921242237091064
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2916098 Best vali loss: 0.2916098
Updating learning rate to 0.00085232926165
Epoch: 3 cost time: 1.0162353515625
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2939533 Best vali loss: 0.2916098
Updating learning rate to 0.000426164630825
Epoch: 4 cost time: 0.9972782135009766
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3041568 Best vali loss: 0.2916098
Updating learning rate to 0.0002130823154125
Epoch: 5 cost time: 0.8819880485534668
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3041803 Best vali loss: 0.2916098
Updating learning rate to 0.00010654115770625
Epoch: 6 cost time: 1.4108679294586182
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3100946 Best vali loss: 0.2916098
Updating learning rate to 5.3270578853125e-05
Epoch: 7 cost time: 1.1560249328613281
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3085406 Best vali loss: 0.2916098
Updating learning rate to 2.66352894265625e-05
Epoch: 8 cost time: 1.2299072742462158
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3111709 Best vali loss: 0.2916098

best validation loss 0.29160977748744593

[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008713839742, 'e_layers': 4, 'learning_rate': 0.0002330475245, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9965563
	speed: 0.0154s/iter; left time: 62.8341s
	iters: 200, epoch: 1 | loss: 0.3571317
	speed: 0.0100s/iter; left time: 39.7542s
	iters: 300, epoch: 1 | loss: 0.7858245
	speed: 0.0101s/iter; left time: 39.2366s
	iters: 400, epoch: 1 | loss: 0.4354409
	speed: 0.0094s/iter; left time: 35.4604s
	iters: 500, epoch: 1 | loss: 0.7990251
	speed: 0.0092s/iter; left time: 33.9544s
Updating learning rate to 0.00022417768124398632
Validation loss decreased (inf --> 0.2818).  Saving model state dict ...
Epoch: 1 cost time: 5.308773994445801
Epoch: 1, Steps: 523 | Train Loss: 0.6747957 Vali Loss: 0.2818162 Best vali loss: 0.2818162
	iters: 100, epoch: 2 | loss: 0.7331802
	speed: 0.0165s/iter; left time: 58.7413s
	iters: 200, epoch: 2 | loss: 0.2734145
	speed: 0.0093s/iter; left time: 32.1798s
	iters: 300, epoch: 2 | loss: 0.3009759
	speed: 0.0097s/iter; left time: 32.5315s
	iters: 400, epoch: 2 | loss: 0.8226431
	speed: 0.0088s/iter; left time: 28.7177s
	iters: 500, epoch: 2 | loss: 0.5621624
	speed: 0.0061s/iter; left time: 19.4064s
Updating learning rate to 0.00019891850470634401
Validation loss decreased (0.2818 --> 0.2798).  Saving model state dict ...
Epoch: 2 cost time: 4.391822576522827
Epoch: 2, Steps: 523 | Train Loss: 0.5384752 Vali Loss: 0.2797784 Best vali loss: 0.2797784
	iters: 100, epoch: 3 | loss: 0.2581965
	speed: 0.0202s/iter; left time: 61.3898s
	iters: 200, epoch: 3 | loss: 0.2392019
	speed: 0.0104s/iter; left time: 30.4579s
	iters: 300, epoch: 3 | loss: 0.4372025
	speed: 0.0098s/iter; left time: 27.8645s
	iters: 400, epoch: 3 | loss: 0.3070542
	speed: 0.0108s/iter; left time: 29.5737s
	iters: 500, epoch: 3 | loss: 0.3277025
	speed: 0.0091s/iter; left time: 23.9185s
Updating learning rate to 0.0001611154755399237
Epoch: 3 cost time: 5.388528823852539
Epoch: 3, Steps: 523 | Train Loss: 0.3138715 Vali Loss: 0.2879468 Best vali loss: 0.2797784

best validation loss 0.2797783785601804

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015048833519, 'e_layers': 3, 'learning_rate': 0.0048925951024, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6319023
	speed: 0.0172s/iter; left time: 70.4027s
	iters: 200, epoch: 1 | loss: 0.3166935
	speed: 0.0076s/iter; left time: 30.4573s
	iters: 300, epoch: 1 | loss: 0.6945153
	speed: 0.0073s/iter; left time: 28.3816s
	iters: 400, epoch: 1 | loss: 0.3576672
	speed: 0.0089s/iter; left time: 33.4977s
	iters: 500, epoch: 1 | loss: 0.6745349
	speed: 0.0083s/iter; left time: 30.5130s
Updating learning rate to 0.0048925951024
Validation loss decreased (inf --> 0.3247).  Saving model state dict ...
Epoch: 1 cost time: 4.770766019821167
Epoch: 1, Steps: 523 | Train Loss: 0.5350627 Vali Loss: 0.3246888 Best vali loss: 0.3246888
	iters: 100, epoch: 2 | loss: 0.4434662
	speed: 0.0209s/iter; left time: 74.5955s
	iters: 200, epoch: 2 | loss: 0.3173268
	speed: 0.0090s/iter; left time: 31.1105s
	iters: 300, epoch: 2 | loss: 0.2091144
	speed: 0.0099s/iter; left time: 33.4400s
	iters: 400, epoch: 2 | loss: 0.4310266
	speed: 0.0103s/iter; left time: 33.7159s
	iters: 500, epoch: 2 | loss: 0.3035313
	speed: 0.0087s/iter; left time: 27.4947s
Updating learning rate to 0.0024462975512
Validation loss decreased (0.3247 --> 0.3212).  Saving model state dict ...
Epoch: 2 cost time: 5.1878111362457275
Epoch: 2, Steps: 523 | Train Loss: 0.3408931 Vali Loss: 0.3211779 Best vali loss: 0.3211779
	iters: 100, epoch: 3 | loss: 1.3798668
	speed: 0.0179s/iter; left time: 54.3917s
	iters: 200, epoch: 3 | loss: 0.3921350
	speed: 0.0069s/iter; left time: 20.1990s
	iters: 300, epoch: 3 | loss: 0.8650593
	speed: 0.0097s/iter; left time: 27.5739s
	iters: 400, epoch: 3 | loss: 0.6004009
	speed: 0.0100s/iter; left time: 27.3652s
	iters: 500, epoch: 3 | loss: 0.7429313
	speed: 0.0093s/iter; left time: 24.4513s
Updating learning rate to 0.0012231487756
Epoch: 3 cost time: 4.468485116958618
Epoch: 3, Steps: 523 | Train Loss: 0.7960787 Vali Loss: 0.3256379 Best vali loss: 0.3211779

best validation loss 0.32117789905059735

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0031777012672, 'e_layers': 1, 'learning_rate': 0.0002535692665, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6817474
	speed: 0.0124s/iter; left time: 102.1421s
	iters: 200, epoch: 1 | loss: 1.7938648
	speed: 0.0061s/iter; left time: 49.3760s
	iters: 300, epoch: 1 | loss: 0.2298191
	speed: 0.0055s/iter; left time: 44.2448s
	iters: 400, epoch: 1 | loss: 0.1807524
	speed: 0.0061s/iter; left time: 48.2778s
	iters: 500, epoch: 1 | loss: 0.7038525
	speed: 0.0064s/iter; left time: 50.1385s
	iters: 600, epoch: 1 | loss: 0.1264306
	speed: 0.0062s/iter; left time: 48.4204s
	iters: 700, epoch: 1 | loss: 0.3212216
	speed: 0.0056s/iter; left time: 42.7414s
	iters: 800, epoch: 1 | loss: 0.4618859
	speed: 0.0050s/iter; left time: 38.1773s
	iters: 900, epoch: 1 | loss: 1.3260325
	speed: 0.0060s/iter; left time: 45.1025s
	iters: 1000, epoch: 1 | loss: 0.7087269
	speed: 0.0038s/iter; left time: 28.1103s
Updating learning rate to 0.00024391836094662494
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 6.185058355331421
Epoch: 1, Steps: 1045 | Train Loss: 0.6534334 Vali Loss: 0.2859926 Best vali loss: 0.2859926
	iters: 100, epoch: 2 | loss: 0.4951622
	speed: 0.0182s/iter; left time: 131.5716s
	iters: 200, epoch: 2 | loss: 0.5634790
	speed: 0.0036s/iter; left time: 25.4617s
	iters: 300, epoch: 2 | loss: 0.2078796
	speed: 0.0032s/iter; left time: 22.7610s
	iters: 400, epoch: 2 | loss: 0.2461037
	speed: 0.0039s/iter; left time: 26.7564s
	iters: 500, epoch: 2 | loss: 1.4163197
	speed: 0.0050s/iter; left time: 33.8650s
	iters: 600, epoch: 2 | loss: 0.1745161
	speed: 0.0045s/iter; left time: 30.5502s
	iters: 700, epoch: 2 | loss: 0.4428549
	speed: 0.0054s/iter; left time: 35.9948s
	iters: 800, epoch: 2 | loss: 0.3201649
	speed: 0.0046s/iter; left time: 29.9995s
	iters: 900, epoch: 2 | loss: 0.2960147
	speed: 0.0043s/iter; left time: 27.2884s
	iters: 1000, epoch: 2 | loss: 0.7561985
	speed: 0.0041s/iter; left time: 25.7511s
Updating learning rate to 0.0002164349071713244
Validation loss decreased (0.2860 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 4.527061700820923
Epoch: 2, Steps: 1045 | Train Loss: 0.4918693 Vali Loss: 0.2829316 Best vali loss: 0.2829316
	iters: 100, epoch: 3 | loss: 0.4209098
	speed: 0.0201s/iter; left time: 124.0437s
	iters: 200, epoch: 3 | loss: 0.2662738
	speed: 0.0047s/iter; left time: 28.4702s
	iters: 300, epoch: 3 | loss: 0.4902034
	speed: 0.0036s/iter; left time: 21.2658s
	iters: 400, epoch: 3 | loss: 0.2676226
	speed: 0.0047s/iter; left time: 27.4062s
	iters: 500, epoch: 3 | loss: 1.1130160
	speed: 0.0046s/iter; left time: 26.5798s
	iters: 600, epoch: 3 | loss: 0.3473993
	speed: 0.0048s/iter; left time: 27.4383s
	iters: 700, epoch: 3 | loss: 1.2079498
	speed: 0.0057s/iter; left time: 31.5442s
	iters: 800, epoch: 3 | loss: 0.2617684
	speed: 0.0059s/iter; left time: 32.1110s
	iters: 900, epoch: 3 | loss: 0.9025227
	speed: 0.0057s/iter; left time: 30.4218s
	iters: 1000, epoch: 3 | loss: 0.3441049
	speed: 0.0062s/iter; left time: 32.6523s
Updating learning rate to 0.0001753030118732591
Validation loss decreased (0.2829 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 5.499721527099609
Epoch: 3, Steps: 1045 | Train Loss: 0.5621771 Vali Loss: 0.2819156 Best vali loss: 0.2819156

best validation loss 0.2819155752658844

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008713839742, 'e_layers': 4, 'learning_rate': 0.0002330475245, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8566800
	speed: 0.0150s/iter; left time: 37.7715s
	iters: 200, epoch: 4 | loss: 0.3066920
	speed: 0.0075s/iter; left time: 18.1427s
	iters: 300, epoch: 4 | loss: 0.6643510
	speed: 0.0082s/iter; left time: 19.0295s
	iters: 400, epoch: 4 | loss: 0.3753020
	speed: 0.0094s/iter; left time: 20.7264s
	iters: 500, epoch: 4 | loss: 0.7193388
	speed: 0.0088s/iter; left time: 18.7023s
Updating learning rate to 0.00011652376225
Epoch: 4 cost time: 4.779870271682739
Epoch: 4, Steps: 523 | Train Loss: 0.5844728 Vali Loss: 0.2857517 Best vali loss: 0.2797784
	iters: 100, epoch: 5 | loss: 0.5160536
	speed: 0.0196s/iter; left time: 39.0390s
	iters: 200, epoch: 5 | loss: 0.2528141
	speed: 0.0087s/iter; left time: 16.3900s
	iters: 300, epoch: 5 | loss: 0.2450327
	speed: 0.0094s/iter; left time: 16.9433s
	iters: 400, epoch: 5 | loss: 0.6878620
	speed: 0.0086s/iter; left time: 14.6273s
	iters: 500, epoch: 5 | loss: 0.5742810
	speed: 0.0100s/iter; left time: 15.9557s
Updating learning rate to 7.193204896007632e-05
Epoch: 5 cost time: 4.911707878112793
Epoch: 5, Steps: 523 | Train Loss: 0.4552087 Vali Loss: 0.2885317 Best vali loss: 0.2797784
	iters: 100, epoch: 6 | loss: 0.2328418
	speed: 0.0235s/iter; left time: 34.5111s
	iters: 200, epoch: 6 | loss: 0.2367322
	speed: 0.0108s/iter; left time: 14.8471s
	iters: 300, epoch: 6 | loss: 0.3412191
	speed: 0.0099s/iter; left time: 12.5378s
	iters: 400, epoch: 6 | loss: 0.2708643
	speed: 0.0104s/iter; left time: 12.1478s
	iters: 500, epoch: 6 | loss: 0.3168523
	speed: 0.0106s/iter; left time: 11.3475s
Updating learning rate to 3.412901979365597e-05
Epoch: 6 cost time: 5.576977491378784
Epoch: 6, Steps: 523 | Train Loss: 0.2797020 Vali Loss: 0.2900407 Best vali loss: 0.2797784
	iters: 100, epoch: 7 | loss: 0.5386750
	speed: 0.0224s/iter; left time: 21.2355s
	iters: 200, epoch: 7 | loss: 0.3515151
	speed: 0.0121s/iter; left time: 10.2258s
	iters: 300, epoch: 7 | loss: 0.2636286
	speed: 0.0118s/iter; left time: 8.8071s
	iters: 400, epoch: 7 | loss: 0.6445448
	speed: 0.0130s/iter; left time: 8.4311s
	iters: 500, epoch: 7 | loss: 0.4287064
	speed: 0.0139s/iter; left time: 7.5939s
Updating learning rate to 8.869843256013679e-06
Epoch: 7 cost time: 6.573157072067261
Epoch: 7, Steps: 523 | Train Loss: 0.4454140 Vali Loss: 0.2878710 Best vali loss: 0.2797784
	iters: 100, epoch: 8 | loss: 0.2688943
	speed: 0.0269s/iter; left time: 11.4064s
	iters: 200, epoch: 8 | loss: 0.3335486
	speed: 0.0117s/iter; left time: 3.8065s
	iters: 300, epoch: 8 | loss: 0.5032319
	speed: 0.0089s/iter; left time: 2.0040s
	iters: 400, epoch: 8 | loss: 0.4344038
	speed: 0.0133s/iter; left time: 1.6505s
	iters: 500, epoch: 8 | loss: 0.5130559
	speed: 0.0078s/iter; left time: 0.1873s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.726572751998901
Epoch: 8, Steps: 523 | Train Loss: 0.4106269 Vali Loss: 0.2883914 Best vali loss: 0.2797784

best validation loss 0.2797783785601804

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024948015239, 'e_layers': 3, 'learning_rate': 0.0020952089841, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4275741
	speed: 0.0169s/iter; left time: 139.7007s
	iters: 200, epoch: 1 | loss: 0.2470007
	speed: 0.0080s/iter; left time: 64.9964s
	iters: 300, epoch: 1 | loss: 0.6556065
	speed: 0.0074s/iter; left time: 59.8513s
	iters: 400, epoch: 1 | loss: 0.6320127
	speed: 0.0119s/iter; left time: 94.9049s
	iters: 500, epoch: 1 | loss: 1.3174608
	speed: 0.0125s/iter; left time: 98.0492s
	iters: 600, epoch: 1 | loss: 1.2001617
	speed: 0.0116s/iter; left time: 90.2599s
	iters: 700, epoch: 1 | loss: 0.3100408
	speed: 0.0112s/iter; left time: 86.0906s
	iters: 800, epoch: 1 | loss: 1.3049618
	speed: 0.0114s/iter; left time: 85.9317s
	iters: 900, epoch: 1 | loss: 0.3350921
	speed: 0.0093s/iter; left time: 69.3083s
	iters: 1000, epoch: 1 | loss: 0.1789822
	speed: 0.0079s/iter; left time: 58.3946s
Updating learning rate to 0.0020952089841
Validation loss decreased (inf --> 0.3175).  Saving model state dict ...
Epoch: 1 cost time: 10.754399061203003
Epoch: 1, Steps: 1045 | Train Loss: 0.6608893 Vali Loss: 0.3174711 Best vali loss: 0.3174711
	iters: 100, epoch: 2 | loss: 1.6404543
	speed: 0.0202s/iter; left time: 145.6283s
	iters: 200, epoch: 2 | loss: 0.5615274
	speed: 0.0081s/iter; left time: 57.8592s
	iters: 300, epoch: 2 | loss: 0.8717382
	speed: 0.0082s/iter; left time: 57.6636s
	iters: 400, epoch: 2 | loss: 0.4441409
	speed: 0.0088s/iter; left time: 60.6448s
	iters: 500, epoch: 2 | loss: 0.3322554
	speed: 0.0072s/iter; left time: 49.0975s
	iters: 600, epoch: 2 | loss: 0.4567665
	speed: 0.0086s/iter; left time: 57.5976s
	iters: 700, epoch: 2 | loss: 0.3650587
	speed: 0.0101s/iter; left time: 66.6340s
	iters: 800, epoch: 2 | loss: 0.2365925
	speed: 0.0090s/iter; left time: 58.9542s
	iters: 900, epoch: 2 | loss: 0.1976802
	speed: 0.0087s/iter; left time: 55.8520s
	iters: 1000, epoch: 2 | loss: 0.3053930
	speed: 0.0076s/iter; left time: 48.1895s
Updating learning rate to 0.00104760449205
Validation loss decreased (0.3175 --> 0.3002).  Saving model state dict ...
Epoch: 2 cost time: 8.69053840637207
Epoch: 2, Steps: 1045 | Train Loss: 0.5411607 Vali Loss: 0.3001971 Best vali loss: 0.3001971
	iters: 100, epoch: 3 | loss: 0.6453540
	speed: 0.0291s/iter; left time: 179.7376s
	iters: 200, epoch: 3 | loss: 0.1681984
	speed: 0.0087s/iter; left time: 52.7588s
	iters: 300, epoch: 3 | loss: 0.3585005
	speed: 0.0071s/iter; left time: 42.0979s
	iters: 400, epoch: 3 | loss: 0.4060265
	speed: 0.0067s/iter; left time: 39.2840s
	iters: 500, epoch: 3 | loss: 0.3538050
	speed: 0.0063s/iter; left time: 36.5153s
	iters: 600, epoch: 3 | loss: 0.4300601
	speed: 0.0069s/iter; left time: 38.9808s
	iters: 700, epoch: 3 | loss: 0.8071581
	speed: 0.0095s/iter; left time: 52.8745s
	iters: 800, epoch: 3 | loss: 0.3258968
	speed: 0.0098s/iter; left time: 53.6588s
	iters: 900, epoch: 3 | loss: 0.3703025
	speed: 0.0076s/iter; left time: 40.7895s
	iters: 1000, epoch: 3 | loss: 0.7990254
	speed: 0.0075s/iter; left time: 39.2875s
Updating learning rate to 0.000523802246025
Validation loss decreased (0.3002 --> 0.2910).  Saving model state dict ...
Epoch: 3 cost time: 8.448074579238892
Epoch: 3, Steps: 1045 | Train Loss: 0.4664327 Vali Loss: 0.2910200 Best vali loss: 0.2910200
	iters: 100, epoch: 4 | loss: 1.0485328
	speed: 0.0287s/iter; left time: 147.0989s
	iters: 200, epoch: 4 | loss: 0.2413987
	speed: 0.0078s/iter; left time: 39.4352s
	iters: 300, epoch: 4 | loss: 0.4216087
	speed: 0.0072s/iter; left time: 35.6821s
	iters: 400, epoch: 4 | loss: 0.4089191
	speed: 0.0079s/iter; left time: 38.0980s
	iters: 500, epoch: 4 | loss: 0.3374970
	speed: 0.0086s/iter; left time: 40.6909s
	iters: 600, epoch: 4 | loss: 1.5086867
	speed: 0.0090s/iter; left time: 41.4387s
	iters: 700, epoch: 4 | loss: 0.3909510
	speed: 0.0086s/iter; left time: 38.9603s
	iters: 800, epoch: 4 | loss: 0.2408391
	speed: 0.0094s/iter; left time: 41.4841s
	iters: 900, epoch: 4 | loss: 0.4184024
	speed: 0.0085s/iter; left time: 36.5974s
	iters: 1000, epoch: 4 | loss: 0.2604142
	speed: 0.0084s/iter; left time: 35.6920s
Updating learning rate to 0.0002619011230125
Epoch: 4 cost time: 8.936503410339355
Epoch: 4, Steps: 1045 | Train Loss: 0.5277250 Vali Loss: 0.2941573 Best vali loss: 0.2910200
	iters: 100, epoch: 5 | loss: 0.4811331
	speed: 0.0270s/iter; left time: 110.0858s
	iters: 200, epoch: 5 | loss: 1.3076684
	speed: 0.0089s/iter; left time: 35.3476s
	iters: 300, epoch: 5 | loss: 0.8635350
	speed: 0.0089s/iter; left time: 34.6874s
	iters: 400, epoch: 5 | loss: 0.4554131
	speed: 0.0083s/iter; left time: 31.4665s
	iters: 500, epoch: 5 | loss: 0.7811140
	speed: 0.0071s/iter; left time: 26.2150s
	iters: 600, epoch: 5 | loss: 0.3397829
	speed: 0.0085s/iter; left time: 30.3826s
	iters: 700, epoch: 5 | loss: 0.2180034
	speed: 0.0084s/iter; left time: 29.1746s
	iters: 800, epoch: 5 | loss: 0.5605801
	speed: 0.0087s/iter; left time: 29.3892s
	iters: 900, epoch: 5 | loss: 0.2889741
	speed: 0.0085s/iter; left time: 27.8261s
	iters: 1000, epoch: 5 | loss: 0.9677587
	speed: 0.0082s/iter; left time: 26.0485s
Updating learning rate to 0.00013095056150625
Epoch: 5 cost time: 8.620227813720703
Epoch: 5, Steps: 1045 | Train Loss: 0.6263963 Vali Loss: 0.2959440 Best vali loss: 0.2910200
	iters: 100, epoch: 6 | loss: 0.3955127
	speed: 0.0258s/iter; left time: 78.2778s
	iters: 200, epoch: 6 | loss: 0.5812614
	speed: 0.0087s/iter; left time: 25.4631s
	iters: 300, epoch: 6 | loss: 0.1996661
	speed: 0.0085s/iter; left time: 24.1554s
	iters: 400, epoch: 6 | loss: 0.2223103
	speed: 0.0082s/iter; left time: 22.4625s
	iters: 500, epoch: 6 | loss: 0.4042884
	speed: 0.0065s/iter; left time: 17.2615s
	iters: 600, epoch: 6 | loss: 0.6011226
	speed: 0.0077s/iter; left time: 19.4492s
	iters: 700, epoch: 6 | loss: 0.2761349
	speed: 0.0083s/iter; left time: 20.2083s
	iters: 800, epoch: 6 | loss: 0.3541800
	speed: 0.0086s/iter; left time: 20.0506s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0062477777408, 'e_layers': 1, 'learning_rate': 0.0016955021486, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3802655
	speed: 0.0140s/iter; left time: 27.9620s
	iters: 200, epoch: 1 | loss: 0.2914327
	speed: 0.0035s/iter; left time: 6.6404s
Updating learning rate to 0.0016955021486
Validation loss decreased (inf --> 0.2870).  Saving model state dict ...
Epoch: 1 cost time: 1.5613596439361572
Epoch: 1, Steps: 262 | Train Loss: 0.3358491 Vali Loss: 0.2869571 Best vali loss: 0.2869571
	iters: 100, epoch: 2 | loss: 0.3707428
	speed: 0.0090s/iter; left time: 15.6872s
	iters: 200, epoch: 2 | loss: 1.0239192
	speed: 0.0062s/iter; left time: 10.0684s
Updating learning rate to 0.0008477510743
Epoch: 2 cost time: 1.4445035457611084
Epoch: 2, Steps: 262 | Train Loss: 0.6973310 Vali Loss: 0.2881703 Best vali loss: 0.2869571
	iters: 100, epoch: 3 | loss: 0.6828717
	speed: 0.0139s/iter; left time: 20.4747s
	iters: 200, epoch: 3 | loss: 0.2779937
	speed: 0.0056s/iter; left time: 7.6689s
Updating learning rate to 0.00042387553715
Epoch: 3 cost time: 1.4967219829559326
Epoch: 3, Steps: 262 | Train Loss: 0.4804327 Vali Loss: 0.2883648 Best vali loss: 0.2869571
	iters: 100, epoch: 4 | loss: 0.3770634
	speed: 0.0093s/iter; left time: 11.3071s
	iters: 200, epoch: 4 | loss: 0.5153570
	speed: 0.0033s/iter; left time: 3.6707s
Updating learning rate to 0.000211937768575
Epoch: 4 cost time: 1.0085980892181396
Epoch: 4, Steps: 262 | Train Loss: 0.4462102 Vali Loss: 0.2927822 Best vali loss: 0.2869571
	iters: 100, epoch: 5 | loss: 0.6454127
	speed: 0.0123s/iter; left time: 11.6842s
	iters: 200, epoch: 5 | loss: 0.5561652
	speed: 0.0052s/iter; left time: 4.3795s
Updating learning rate to 0.0001059688842875
Epoch: 5 cost time: 1.4176583290100098
Epoch: 5, Steps: 262 | Train Loss: 0.6007889 Vali Loss: 0.2949875 Best vali loss: 0.2869571
	iters: 100, epoch: 6 | loss: 0.4539385
	speed: 0.0138s/iter; left time: 9.4613s
	iters: 200, epoch: 6 | loss: 0.5784112
	speed: 0.0054s/iter; left time: 3.1926s
Updating learning rate to 5.298444214375e-05
Epoch: 6 cost time: 1.454906940460205
Epoch: 6, Steps: 262 | Train Loss: 0.5161748 Vali Loss: 0.2954116 Best vali loss: 0.2869571
	iters: 100, epoch: 7 | loss: 0.6310130
	speed: 0.0129s/iter; left time: 5.4813s
	iters: 200, epoch: 7 | loss: 0.2992991
	speed: 0.0054s/iter; left time: 1.7629s
Updating learning rate to 2.6492221071875e-05
Epoch: 7 cost time: 1.4069740772247314
Epoch: 7, Steps: 262 | Train Loss: 0.4651561 Vali Loss: 0.2953293 Best vali loss: 0.2869571
	iters: 100, epoch: 8 | loss: 0.3714265
	speed: 0.0128s/iter; left time: 2.0929s
	iters: 200, epoch: 8 | loss: 0.2784950
	speed: 0.0051s/iter; left time: 0.3208s
Updating learning rate to 1.32461105359375e-05
Epoch: 8 cost time: 1.4145011901855469
Epoch: 8, Steps: 262 | Train Loss: 0.3249608 Vali Loss: 0.2957653 Best vali loss: 0.2869571

best validation loss 0.2869571488435138

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0044455353469, 'e_layers': 2, 'learning_rate': 0.0008199675659, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9503556
	speed: 0.0124s/iter; left time: 50.5527s
	iters: 200, epoch: 1 | loss: 0.4409276
	speed: 0.0060s/iter; left time: 23.8012s
	iters: 300, epoch: 1 | loss: 0.3741728
	speed: 0.0062s/iter; left time: 24.0639s
	iters: 400, epoch: 1 | loss: 0.7278243
	speed: 0.0064s/iter; left time: 24.2729s
	iters: 500, epoch: 1 | loss: 0.6397903
	speed: 0.0064s/iter; left time: 23.6251s
Updating learning rate to 0.0008199675659
Validation loss decreased (inf --> 0.2851).  Saving model state dict ...
Epoch: 1 cost time: 3.5552406311035156
Epoch: 1, Steps: 523 | Train Loss: 0.6266141 Vali Loss: 0.2851121 Best vali loss: 0.2851121
	iters: 100, epoch: 2 | loss: 0.3140951
	speed: 0.0147s/iter; left time: 52.4338s
	iters: 200, epoch: 2 | loss: 1.1426215
	speed: 0.0064s/iter; left time: 22.1550s
	iters: 300, epoch: 2 | loss: 0.6649898
	speed: 0.0064s/iter; left time: 21.4314s
	iters: 400, epoch: 2 | loss: 0.4285672
	speed: 0.0062s/iter; left time: 20.3589s
	iters: 500, epoch: 2 | loss: 0.3311315
	speed: 0.0063s/iter; left time: 19.9833s
Updating learning rate to 0.00040998378295
Validation loss decreased (0.2851 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 3.315363645553589
Epoch: 2, Steps: 523 | Train Loss: 0.5762810 Vali Loss: 0.2838396 Best vali loss: 0.2838396
	iters: 100, epoch: 3 | loss: 0.4475390
	speed: 0.0153s/iter; left time: 46.4915s
	iters: 200, epoch: 3 | loss: 0.3965552
	speed: 0.0062s/iter; left time: 18.0959s
	iters: 300, epoch: 3 | loss: 0.3753813
	speed: 0.0065s/iter; left time: 18.3237s
	iters: 400, epoch: 3 | loss: 0.4673241
	speed: 0.0058s/iter; left time: 15.7987s
	iters: 500, epoch: 3 | loss: 0.4615828
	speed: 0.0063s/iter; left time: 16.5389s
Updating learning rate to 0.000204991891475
Epoch: 3 cost time: 3.2735118865966797
Epoch: 3, Steps: 523 | Train Loss: 0.4296765 Vali Loss: 0.2917446 Best vali loss: 0.2838396

best validation loss 0.2838395534837587

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0014770138295, 'e_layers': 1, 'learning_rate': 0.0034093170466, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.1733968
	speed: 0.0111s/iter; left time: 91.9913s
	iters: 200, epoch: 1 | loss: 0.3040253
	speed: 0.0051s/iter; left time: 41.4759s
	iters: 300, epoch: 1 | loss: 0.7217402
	speed: 0.0052s/iter; left time: 41.5536s
	iters: 400, epoch: 1 | loss: 0.2068382
	speed: 0.0053s/iter; left time: 41.8246s
	iters: 500, epoch: 1 | loss: 0.6073561
	speed: 0.0052s/iter; left time: 41.0999s
	iters: 600, epoch: 1 | loss: 0.2711321
	speed: 0.0051s/iter; left time: 39.7698s
	iters: 700, epoch: 1 | loss: 0.3238471
	speed: 0.0051s/iter; left time: 38.7263s
	iters: 800, epoch: 1 | loss: 0.2874476
	speed: 0.0047s/iter; left time: 35.6724s
	iters: 900, epoch: 1 | loss: 1.1653339
	speed: 0.0049s/iter; left time: 36.1997s
	iters: 1000, epoch: 1 | loss: 0.2001195
	speed: 0.0051s/iter; left time: 37.5363s
Updating learning rate to 0.0034093170466
Validation loss decreased (inf --> 0.3061).  Saving model state dict ...
Epoch: 1 cost time: 5.629743337631226
Epoch: 1, Steps: 1045 | Train Loss: 0.4261237 Vali Loss: 0.3061240 Best vali loss: 0.3061240
	iters: 100, epoch: 2 | loss: 0.3374388
	speed: 0.0197s/iter; left time: 141.9779s
	iters: 200, epoch: 2 | loss: 0.9070556
	speed: 0.0049s/iter; left time: 35.1417s
	iters: 300, epoch: 2 | loss: 0.3172684
	speed: 0.0051s/iter; left time: 35.5768s
	iters: 400, epoch: 2 | loss: 0.2600215
	speed: 0.0050s/iter; left time: 34.6686s
	iters: 500, epoch: 2 | loss: 0.3886408
	speed: 0.0049s/iter; left time: 33.0775s
	iters: 600, epoch: 2 | loss: 0.2515830
	speed: 0.0050s/iter; left time: 33.3427s
	iters: 700, epoch: 2 | loss: 0.3112238
	speed: 0.0053s/iter; left time: 35.1124s
	iters: 800, epoch: 2 | loss: 0.3819755
	speed: 0.0053s/iter; left time: 34.5022s
	iters: 900, epoch: 2 | loss: 0.6559237
	speed: 0.0053s/iter; left time: 34.1475s
	iters: 1000, epoch: 2 | loss: 0.2746497
	speed: 0.0051s/iter; left time: 32.2738s
Updating learning rate to 0.0017046585233
Epoch: 2 cost time: 5.3013646602630615
Epoch: 2, Steps: 1045 | Train Loss: 0.4085781 Vali Loss: 0.3170596 Best vali loss: 0.3061240
	iters: 100, epoch: 3 | loss: 0.3434695
	speed: 0.0206s/iter; left time: 126.9872s
	iters: 200, epoch: 3 | loss: 0.3552463
	speed: 0.0038s/iter; left time: 22.8777s
	iters: 300, epoch: 3 | loss: 0.7045394
	speed: 0.0042s/iter; left time: 25.2861s
	iters: 400, epoch: 3 | loss: 0.4162407
	speed: 0.0053s/iter; left time: 30.9437s
	iters: 500, epoch: 3 | loss: 1.4723696
	speed: 0.0051s/iter; left time: 29.1693s
	iters: 600, epoch: 3 | loss: 0.3004513
	speed: 0.0047s/iter; left time: 26.5936s
	iters: 700, epoch: 3 | loss: 0.1787044
	speed: 0.0048s/iter; left time: 26.4871s
	iters: 800, epoch: 3 | loss: 0.2873986
	speed: 0.0046s/iter; left time: 24.9004s
	iters: 900, epoch: 3 | loss: 1.0484861
	speed: 0.0039s/iter; left time: 21.0012s
	iters: 1000, epoch: 3 | loss: 0.2766289
	speed: 0.0041s/iter; left time: 21.6442s
Updating learning rate to 0.00085232926165
Epoch: 3 cost time: 4.720427751541138
Epoch: 3, Steps: 1045 | Train Loss: 0.5383535 Vali Loss: 0.3274718 Best vali loss: 0.3061240

best validation loss 0.30612399534648926

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0034924799012, 'e_layers': 3, 'learning_rate': 0.0005339338504, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5686989
	speed: 0.0146s/iter; left time: 59.7446s
	iters: 200, epoch: 1 | loss: 0.3724530
	speed: 0.0080s/iter; left time: 31.8313s
	iters: 300, epoch: 1 | loss: 0.3624839
	speed: 0.0082s/iter; left time: 31.8869s
	iters: 400, epoch: 1 | loss: 0.4292305
	speed: 0.0065s/iter; left time: 24.5721s
	iters: 500, epoch: 1 | loss: 0.4300566
	speed: 0.0073s/iter; left time: 26.7202s
Updating learning rate to 0.0005339338504
Validation loss decreased (inf --> 0.3040).  Saving model state dict ...
Epoch: 1 cost time: 4.33449387550354
Epoch: 1, Steps: 523 | Train Loss: 0.4325846 Vali Loss: 0.3039687 Best vali loss: 0.3039687
	iters: 100, epoch: 2 | loss: 0.8444991
	speed: 0.0175s/iter; left time: 62.5050s
	iters: 200, epoch: 2 | loss: 0.8856383
	speed: 0.0065s/iter; left time: 22.6408s
	iters: 300, epoch: 2 | loss: 0.4037329
	speed: 0.0070s/iter; left time: 23.6977s
	iters: 400, epoch: 2 | loss: 0.5052722
	speed: 0.0100s/iter; left time: 32.5652s
	iters: 500, epoch: 2 | loss: 0.5008942
	speed: 0.0103s/iter; left time: 32.5303s
Updating learning rate to 0.0002669669252
Validation loss decreased (0.3040 --> 0.2990).  Saving model state dict ...
Epoch: 2 cost time: 4.3727192878723145
Epoch: 2, Steps: 523 | Train Loss: 0.6280073 Vali Loss: 0.2989521 Best vali loss: 0.2989521
	iters: 100, epoch: 3 | loss: 0.5419431
	speed: 0.0238s/iter; left time: 72.2347s
	iters: 200, epoch: 3 | loss: 0.4632127
	speed: 0.0104s/iter; left time: 30.5259s
	iters: 300, epoch: 3 | loss: 0.3584614
	speed: 0.0103s/iter; left time: 29.2319s
	iters: 400, epoch: 3 | loss: 0.4574817
	speed: 0.0092s/iter; left time: 25.3019s
	iters: 500, epoch: 3 | loss: 0.2802007
	speed: 0.0052s/iter; left time: 13.7395s
Updating learning rate to 0.0001334834626
Validation loss decreased (0.2990 --> 0.2897).  Saving model state dict ...
Epoch: 3 cost time: 4.770129203796387
Epoch: 3, Steps: 523 | Train Loss: 0.4202599 Vali Loss: 0.2897364 Best vali loss: 0.2897364

best validation loss 0.2897364151559828

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0044455353469, 'e_layers': 2, 'learning_rate': 0.0008199675659, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9395829
	speed: 0.0143s/iter; left time: 35.9155s
	iters: 200, epoch: 4 | loss: 0.4119155
	speed: 0.0060s/iter; left time: 14.5348s
	iters: 300, epoch: 4 | loss: 0.3114983
	speed: 0.0054s/iter; left time: 12.5670s
	iters: 400, epoch: 4 | loss: 0.5767873
	speed: 0.0064s/iter; left time: 14.1660s
	iters: 500, epoch: 4 | loss: 0.5423683
	speed: 0.0065s/iter; left time: 13.7019s
Updating learning rate to 0.0001024959457375
Epoch: 4 cost time: 3.6450395584106445
Epoch: 4, Steps: 523 | Train Loss: 0.5564305 Vali Loss: 0.2918459 Best vali loss: 0.2838396
	iters: 100, epoch: 5 | loss: 0.3020130
	speed: 0.0158s/iter; left time: 31.5129s
	iters: 200, epoch: 5 | loss: 0.9538031
	speed: 0.0063s/iter; left time: 11.8836s
	iters: 300, epoch: 5 | loss: 0.5642599
	speed: 0.0067s/iter; left time: 11.9559s
	iters: 400, epoch: 5 | loss: 0.4138686
	speed: 0.0066s/iter; left time: 11.2175s
	iters: 500, epoch: 5 | loss: 0.3240816
	speed: 0.0066s/iter; left time: 10.5469s
Updating learning rate to 5.124797286875e-05
Epoch: 5 cost time: 3.4513025283813477
Epoch: 5, Steps: 523 | Train Loss: 0.5116052 Vali Loss: 0.2932965 Best vali loss: 0.2838396
	iters: 100, epoch: 6 | loss: 0.3775801
	speed: 0.0146s/iter; left time: 21.3971s
	iters: 200, epoch: 6 | loss: 0.3934904
	speed: 0.0057s/iter; left time: 7.8580s
	iters: 300, epoch: 6 | loss: 0.3768418
	speed: 0.0063s/iter; left time: 7.9763s
	iters: 400, epoch: 6 | loss: 0.4450518
	speed: 0.0065s/iter; left time: 7.6410s
	iters: 500, epoch: 6 | loss: 0.4402660
	speed: 0.0064s/iter; left time: 6.8474s
Updating learning rate to 2.5623986434375e-05
Epoch: 6 cost time: 3.2687137126922607
Epoch: 6, Steps: 523 | Train Loss: 0.4066460 Vali Loss: 0.2961295 Best vali loss: 0.2838396
	iters: 100, epoch: 7 | loss: 0.2158842
	speed: 0.0161s/iter; left time: 15.2077s
	iters: 200, epoch: 7 | loss: 0.5431303
	speed: 0.0068s/iter; left time: 5.7738s
	iters: 300, epoch: 7 | loss: 0.4467968
	speed: 0.0066s/iter; left time: 4.9341s
	iters: 400, epoch: 7 | loss: 0.4766293
	speed: 0.0067s/iter; left time: 4.3429s
	iters: 500, epoch: 7 | loss: 0.5293747
	speed: 0.0068s/iter; left time: 3.7205s
Updating learning rate to 1.28119932171875e-05
Epoch: 7 cost time: 3.5923304557800293
Epoch: 7, Steps: 523 | Train Loss: 0.4423630 Vali Loss: 0.2953479 Best vali loss: 0.2838396
	iters: 100, epoch: 8 | loss: 0.5271435
	speed: 0.0156s/iter; left time: 6.6223s
	iters: 200, epoch: 8 | loss: 0.4603342
	speed: 0.0061s/iter; left time: 1.9618s
	iters: 300, epoch: 8 | loss: 0.4941697
	speed: 0.0054s/iter; left time: 1.2086s
	iters: 400, epoch: 8 | loss: 1.3125664
	speed: 0.0060s/iter; left time: 0.7469s
	iters: 500, epoch: 8 | loss: 0.2688277
	speed: 0.0060s/iter; left time: 0.1446s
Updating learning rate to 6.40599660859375e-06
Epoch: 8 cost time: 3.184138298034668
Epoch: 8, Steps: 523 | Train Loss: 0.6126083 Vali Loss: 0.2953298 Best vali loss: 0.2838396

best validation loss 0.2838395534837587

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0045626938152, 'e_layers': 1, 'learning_rate': 6.1643397e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8425537
	speed: 0.0112s/iter; left time: 45.9410s
	iters: 200, epoch: 1 | loss: 0.3807523
	speed: 0.0049s/iter; left time: 19.4836s
	iters: 300, epoch: 1 | loss: 0.4137018
	speed: 0.0050s/iter; left time: 19.2499s
	iters: 400, epoch: 1 | loss: 0.6958982
	speed: 0.0049s/iter; left time: 18.6802s
	iters: 500, epoch: 1 | loss: 0.3073226
	speed: 0.0049s/iter; left time: 18.1655s
Updating learning rate to 6.1643397e-05
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 2.9105072021484375
Epoch: 1, Steps: 523 | Train Loss: 0.5280457 Vali Loss: 0.2819031 Best vali loss: 0.2819031
	iters: 100, epoch: 2 | loss: 0.8994860
	speed: 0.0119s/iter; left time: 42.2302s
	iters: 200, epoch: 2 | loss: 0.5264130
	speed: 0.0044s/iter; left time: 15.0632s
	iters: 300, epoch: 2 | loss: 0.7404317
	speed: 0.0040s/iter; left time: 13.5314s
	iters: 400, epoch: 2 | loss: 0.5901382
	speed: 0.0043s/iter; left time: 14.0362s
	iters: 500, epoch: 2 | loss: 0.6083473
	speed: 0.0053s/iter; left time: 16.7219s
Updating learning rate to 3.08216985e-05
Validation loss decreased (0.2819 --> 0.2780).  Saving model state dict ...
Epoch: 2 cost time: 2.3965468406677246
Epoch: 2, Steps: 523 | Train Loss: 0.6729632 Vali Loss: 0.2779976 Best vali loss: 0.2779976
	iters: 100, epoch: 3 | loss: 0.8165336
	speed: 0.0131s/iter; left time: 39.7346s
	iters: 200, epoch: 3 | loss: 0.3633343
	speed: 0.0046s/iter; left time: 13.5930s
	iters: 300, epoch: 3 | loss: 0.3094151
	speed: 0.0044s/iter; left time: 12.4403s
	iters: 400, epoch: 3 | loss: 0.6686336
	speed: 0.0045s/iter; left time: 12.2313s
	iters: 500, epoch: 3 | loss: 0.3126301
	speed: 0.0047s/iter; left time: 12.5012s
Updating learning rate to 1.541084925e-05
Epoch: 3 cost time: 2.4693753719329834
Epoch: 3, Steps: 523 | Train Loss: 0.4941093 Vali Loss: 0.2790149 Best vali loss: 0.2779976
	iters: 100, epoch: 4 | loss: 0.2721144
	speed: 0.0116s/iter; left time: 29.1510s
	iters: 200, epoch: 4 | loss: 0.5319517
	speed: 0.0037s/iter; left time: 9.0323s
	iters: 300, epoch: 4 | loss: 0.3074318
	speed: 0.0037s/iter; left time: 8.4595s
	iters: 400, epoch: 4 | loss: 0.4684231
	speed: 0.0039s/iter; left time: 8.6475s
	iters: 500, epoch: 4 | loss: 0.5648880
	speed: 0.0053s/iter; left time: 11.3112s
Updating learning rate to 7.705424625e-06
Epoch: 4 cost time: 2.2782087326049805
Epoch: 4, Steps: 523 | Train Loss: 0.4289618 Vali Loss: 0.2786023 Best vali loss: 0.2779976
	iters: 100, epoch: 5 | loss: 0.2732249
	speed: 0.0157s/iter; left time: 31.2539s
	iters: 200, epoch: 5 | loss: 0.6721096
	speed: 0.0052s/iter; left time: 9.8603s
	iters: 300, epoch: 5 | loss: 0.3461098
	speed: 0.0060s/iter; left time: 10.8217s
	iters: 400, epoch: 5 | loss: 0.5974146
	speed: 0.0052s/iter; left time: 8.8197s
	iters: 500, epoch: 5 | loss: 0.3561152
	speed: 0.0061s/iter; left time: 9.6795s
Updating learning rate to 3.8527123125e-06
Epoch: 5 cost time: 3.104829788208008
Epoch: 5, Steps: 523 | Train Loss: 0.4489948 Vali Loss: 0.2789506 Best vali loss: 0.2779976
	iters: 100, epoch: 6 | loss: 0.5026500
	speed: 0.0151s/iter; left time: 22.2059s
	iters: 200, epoch: 6 | loss: 0.9574682
	speed: 0.0055s/iter; left time: 7.5149s
	iters: 300, epoch: 6 | loss: 0.9216988
	speed: 0.0055s/iter; left time: 6.9714s
	iters: 400, epoch: 6 | loss: 0.2521713
	speed: 0.0055s/iter; left time: 6.4806s
	iters: 500, epoch: 6 | loss: 0.6344545
	speed: 0.0057s/iter; left time: 6.0616s
Updating learning rate to 1.92635615625e-06
Epoch: 6 cost time: 2.9806833267211914
Epoch: 6, Steps: 523 | Train Loss: 0.6536885 Vali Loss: 0.2793068 Best vali loss: 0.2779976
	iters: 100, epoch: 7 | loss: 0.2790065
	speed: 0.0112s/iter; left time: 10.5817s
	iters: 200, epoch: 7 | loss: 0.5209681
	speed: 0.0040s/iter; left time: 3.3713s
	iters: 300, epoch: 7 | loss: 0.3181645
	speed: 0.0038s/iter; left time: 2.8694s
	iters: 400, epoch: 7 | loss: 0.5330104
	speed: 0.0034s/iter; left time: 2.2214s
	iters: 500, epoch: 7 | loss: 0.4411236
	speed: 0.0043s/iter; left time: 2.3680s
Updating learning rate to 9.63178078125e-07
Epoch: 7 cost time: 2.1379971504211426
Epoch: 7, Steps: 523 | Train Loss: 0.4184546 Vali Loss: 0.2793187 Best vali loss: 0.2779976
	iters: 100, epoch: 8 | loss: 1.1219016
	speed: 0.0128s/iter; left time: 5.4425s
	iters: 200, epoch: 8 | loss: 0.3676715
	speed: 0.0050s/iter; left time: 1.6067s
	iters: 300, epoch: 8 | loss: 0.3717949
	speed: 0.0052s/iter; left time: 1.1661s
	iters: 400, epoch: 8 | loss: 0.7785305
	speed: 0.0045s/iter; left time: 0.5566s
	iters: 500, epoch: 8 | loss: 0.8408834
	speed: 0.0048s/iter; left time: 0.1145s
Updating learning rate to 4.815890390625e-07
Epoch: 8 cost time: 2.5955443382263184
Epoch: 8, Steps: 523 | Train Loss: 0.6961564 Vali Loss: 0.2793687 Best vali loss: 0.2779976

best validation loss 0.277997578606813

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.000937612673, 'e_layers': 4, 'learning_rate': 8.99704526e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2762706
	speed: 0.0155s/iter; left time: 63.3349s
	iters: 200, epoch: 1 | loss: 0.6024950
	speed: 0.0077s/iter; left time: 30.6700s
	iters: 300, epoch: 1 | loss: 0.6321033
	speed: 0.0084s/iter; left time: 32.7542s
	iters: 400, epoch: 1 | loss: 0.4103204
	speed: 0.0087s/iter; left time: 32.9654s
	iters: 500, epoch: 1 | loss: 0.9927877
	speed: 0.0086s/iter; left time: 31.7330s
Updating learning rate to 8.654615614395843e-05
Validation loss decreased (inf --> 0.3087).  Saving model state dict ...
Epoch: 1 cost time: 4.795406818389893
Epoch: 1, Steps: 523 | Train Loss: 0.5827954 Vali Loss: 0.3087032 Best vali loss: 0.3087032
	iters: 100, epoch: 2 | loss: 0.3117831
	speed: 0.0192s/iter; left time: 68.4065s
	iters: 200, epoch: 2 | loss: 0.8645711
	speed: 0.0088s/iter; left time: 30.3641s
	iters: 300, epoch: 2 | loss: 0.5247123
	speed: 0.0087s/iter; left time: 29.1539s
	iters: 400, epoch: 2 | loss: 0.3920995
	speed: 0.0085s/iter; left time: 27.7254s
	iters: 500, epoch: 2 | loss: 0.2691123
	speed: 0.0083s/iter; left time: 26.3651s
Updating learning rate to 7.679458486994142e-05
Validation loss decreased (0.3087 --> 0.2954).  Saving model state dict ...
Epoch: 2 cost time: 4.554677248001099
Epoch: 2, Steps: 523 | Train Loss: 0.4724557 Vali Loss: 0.2954421 Best vali loss: 0.2954421
	iters: 100, epoch: 3 | loss: 0.6301414
	speed: 0.0162s/iter; left time: 49.1021s
	iters: 200, epoch: 3 | loss: 0.4551247
	speed: 0.0111s/iter; left time: 32.6518s
	iters: 300, epoch: 3 | loss: 0.5796258
	speed: 0.0086s/iter; left time: 24.4206s
	iters: 400, epoch: 3 | loss: 0.4215944
	speed: 0.0090s/iter; left time: 24.5764s
	iters: 500, epoch: 3 | loss: 0.6000230
	speed: 0.0100s/iter; left time: 26.3451s
Updating learning rate to 6.22003271062043e-05
Validation loss decreased (0.2954 --> 0.2889).  Saving model state dict ...
Epoch: 3 cost time: 5.06414532661438
Epoch: 3, Steps: 523 | Train Loss: 0.5373019 Vali Loss: 0.2888682 Best vali loss: 0.2888682
	iters: 100, epoch: 4 | loss: 0.5523473
	speed: 0.0195s/iter; left time: 49.1340s
	iters: 200, epoch: 4 | loss: 0.6731585
	speed: 0.0089s/iter; left time: 21.4667s
	iters: 300, epoch: 4 | loss: 0.2823454
	speed: 0.0088s/iter; left time: 20.3948s
	iters: 400, epoch: 4 | loss: 0.5240182
	speed: 0.0085s/iter; left time: 18.8329s
	iters: 500, epoch: 4 | loss: 0.3809140
	speed: 0.0090s/iter; left time: 19.0742s
Updating learning rate to 4.49852263e-05
Validation loss decreased (0.2889 --> 0.2866).  Saving model state dict ...
Epoch: 4 cost time: 4.698773622512817
Epoch: 4, Steps: 523 | Train Loss: 0.4825567 Vali Loss: 0.2866288 Best vali loss: 0.2866288
	iters: 100, epoch: 5 | loss: 0.6920925
	speed: 0.0203s/iter; left time: 40.4143s
	iters: 200, epoch: 5 | loss: 0.2428758
	speed: 0.0099s/iter; left time: 18.6630s
	iters: 300, epoch: 5 | loss: 0.7853889
	speed: 0.0096s/iter; left time: 17.1356s
	iters: 400, epoch: 5 | loss: 0.4985678
	speed: 0.0088s/iter; left time: 14.8311s
	iters: 500, epoch: 5 | loss: 0.4603028
	speed: 0.0088s/iter; left time: 13.9824s
Updating learning rate to 2.7770125493795694e-05
Validation loss decreased (0.2866 --> 0.2851).  Saving model state dict ...
Epoch: 5 cost time: 4.941473007202148
Epoch: 5, Steps: 523 | Train Loss: 0.5358456 Vali Loss: 0.2851095 Best vali loss: 0.2851095
	iters: 100, epoch: 6 | loss: 0.1937618
	speed: 0.0194s/iter; left time: 28.5445s
	iters: 200, epoch: 6 | loss: 0.3512320
	speed: 0.0099s/iter; left time: 13.6261s
	iters: 300, epoch: 6 | loss: 0.4559964
	speed: 0.0099s/iter; left time: 12.5689s
	iters: 400, epoch: 6 | loss: 0.4862135
	speed: 0.0100s/iter; left time: 11.7040s
	iters: 500, epoch: 6 | loss: 0.5102733
	speed: 0.0099s/iter; left time: 10.6107s
Updating learning rate to 1.3175867730058578e-05
Validation loss decreased (0.2851 --> 0.2843).  Saving model state dict ...
Epoch: 6 cost time: 5.1760077476501465
Epoch: 6, Steps: 523 | Train Loss: 0.3994954 Vali Loss: 0.2842777 Best vali loss: 0.2842777
	iters: 100, epoch: 7 | loss: 0.9349830
	speed: 0.0174s/iter; left time: 16.4420s
	iters: 200, epoch: 7 | loss: 0.6240293
	speed: 0.0101s/iter; left time: 8.5698s
	iters: 300, epoch: 7 | loss: 0.9560907
	speed: 0.0102s/iter; left time: 7.5917s
	iters: 400, epoch: 7 | loss: 0.4037627
	speed: 0.0091s/iter; left time: 5.8953s
	iters: 500, epoch: 7 | loss: 0.4975049
	speed: 0.0088s/iter; left time: 4.8235s
Updating learning rate to 3.4242964560415587e-06
Epoch: 7 cost time: 4.877085208892822
Epoch: 7, Steps: 523 | Train Loss: 0.6832741 Vali Loss: 0.2843244 Best vali loss: 0.2842777
	iters: 100, epoch: 8 | loss: 0.5518485
	speed: 0.0248s/iter; left time: 10.4951s
	iters: 200, epoch: 8 | loss: 0.7047384
	speed: 0.0110s/iter; left time: 3.5648s
	iters: 300, epoch: 8 | loss: 0.8416977
	speed: 0.0118s/iter; left time: 2.6505s
	iters: 400, epoch: 8 | loss: 0.2331031
	speed: 0.0068s/iter; left time: 0.8488s
	iters: 500, epoch: 8 | loss: 0.6044267
	speed: 0.0110s/iter; left time: 0.2632s
Updating learning rate to 0.0
Validation loss decreased (0.2843 --> 0.2842).  Saving model state dict ...
Epoch: 8 cost time: 5.62424111366272
Epoch: 8, Steps: 523 | Train Loss: 0.5871629 Vali Loss: 0.2841875 Best vali loss: 0.2841875

best validation loss 0.28418748672842403

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0085994490675, 'e_layers': 3, 'learning_rate': 0.0001132748289, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4167951
	speed: 0.0187s/iter; left time: 76.2755s
	iters: 200, epoch: 1 | loss: 0.4112105
	speed: 0.0109s/iter; left time: 43.6024s
	iters: 300, epoch: 1 | loss: 0.3253902
	speed: 0.0097s/iter; left time: 37.7793s
	iters: 400, epoch: 1 | loss: 0.6612228
	speed: 0.0102s/iter; left time: 38.4360s
	iters: 500, epoch: 1 | loss: 0.3142603
	speed: 0.0105s/iter; left time: 38.5360s
Updating learning rate to 0.0001132748289
Validation loss decreased (inf --> 0.3072).  Saving model state dict ...
Epoch: 1 cost time: 5.969533681869507
Epoch: 1, Steps: 523 | Train Loss: 0.4257758 Vali Loss: 0.3072409 Best vali loss: 0.3072409
	iters: 100, epoch: 2 | loss: 0.5491842
	speed: 0.0179s/iter; left time: 63.7639s
	iters: 200, epoch: 2 | loss: 0.3893437
	speed: 0.0078s/iter; left time: 27.1591s
	iters: 300, epoch: 2 | loss: 0.4468770
	speed: 0.0078s/iter; left time: 26.2525s
	iters: 400, epoch: 2 | loss: 0.3896953
	speed: 0.0082s/iter; left time: 26.8893s
	iters: 500, epoch: 2 | loss: 0.4196500
	speed: 0.0083s/iter; left time: 26.1191s
Updating learning rate to 5.663741445e-05
Validation loss decreased (0.3072 --> 0.2927).  Saving model state dict ...
Epoch: 2 cost time: 4.171379089355469
Epoch: 2, Steps: 523 | Train Loss: 0.4389500 Vali Loss: 0.2927006 Best vali loss: 0.2927006
	iters: 100, epoch: 3 | loss: 0.7816291
	speed: 0.0185s/iter; left time: 56.3460s
	iters: 200, epoch: 3 | loss: 1.0760424
	speed: 0.0060s/iter; left time: 17.7264s
	iters: 300, epoch: 3 | loss: 0.2963967
	speed: 0.0061s/iter; left time: 17.2901s
	iters: 400, epoch: 3 | loss: 0.2922539
	speed: 0.0072s/iter; left time: 19.6738s
	iters: 500, epoch: 3 | loss: 0.9044475
	speed: 0.0075s/iter; left time: 19.8884s
Updating learning rate to 2.8318707225e-05
Validation loss decreased (0.2927 --> 0.2887).  Saving model state dict ...
Epoch: 3 cost time: 3.6823062896728516
Epoch: 3, Steps: 523 | Train Loss: 0.6701539 Vali Loss: 0.2887399 Best vali loss: 0.2887399

best validation loss 0.28873987914838506

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0084246134311, 'e_layers': 2, 'learning_rate': 0.000337778408, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6847712
	speed: 0.0138s/iter; left time: 13.0887s
Updating learning rate to 0.000337778408
Validation loss decreased (inf --> 0.2789).  Saving model state dict ...
Epoch: 1 cost time: 1.32401442527771
Epoch: 1, Steps: 131 | Train Loss: 0.6847712 Vali Loss: 0.2789320 Best vali loss: 0.2789320
	iters: 100, epoch: 2 | loss: 0.5431635
	speed: 0.0132s/iter; left time: 10.8121s
Updating learning rate to 0.000168889204
Validation loss decreased (0.2789 --> 0.2770).  Saving model state dict ...
Epoch: 2 cost time: 1.0527698993682861
Epoch: 2, Steps: 131 | Train Loss: 0.5431635 Vali Loss: 0.2769813 Best vali loss: 0.2769813
	iters: 100, epoch: 3 | loss: 0.3721887
	speed: 0.0132s/iter; left time: 9.0798s
Updating learning rate to 8.4444602e-05
Epoch: 3 cost time: 1.0307157039642334
Epoch: 3, Steps: 131 | Train Loss: 0.3721887 Vali Loss: 0.2818610 Best vali loss: 0.2769813

best validation loss 0.2769812764554894

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0057911877373, 'e_layers': 2, 'learning_rate': 0.0021970340043, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0021134143765520422
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 1.05655837059021
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2818980 Best vali loss: 0.2818980
Updating learning rate to 0.0018752858236189822
Epoch: 2 cost time: 0.697852373123169
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2859163 Best vali loss: 0.2818980
Updating learning rate to 0.001518901259044171
Epoch: 3 cost time: 0.5805292129516602
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2896292 Best vali loss: 0.2818980

best validation loss 0.28189801373482637

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0084246134311, 'e_layers': 2, 'learning_rate': 0.000337778408, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5447991
	speed: 0.0144s/iter; left time: 7.9911s
Updating learning rate to 4.2222301e-05
Epoch: 4 cost time: 1.3324527740478516
Epoch: 4, Steps: 131 | Train Loss: 0.5447991 Vali Loss: 0.2809567 Best vali loss: 0.2769813
	iters: 100, epoch: 5 | loss: 0.4546426
	speed: 0.0127s/iter; left time: 5.4184s
Updating learning rate to 2.11111505e-05
Epoch: 5 cost time: 1.038245439529419
Epoch: 5, Steps: 131 | Train Loss: 0.4546426 Vali Loss: 0.2851884 Best vali loss: 0.2769813
	iters: 100, epoch: 6 | loss: 0.3212843
	speed: 0.0131s/iter; left time: 3.8651s
Updating learning rate to 1.055557525e-05
Epoch: 6 cost time: 1.0436928272247314
Epoch: 6, Steps: 131 | Train Loss: 0.3212843 Vali Loss: 0.2868656 Best vali loss: 0.2769813
	iters: 100, epoch: 7 | loss: 0.4280444
	speed: 0.0128s/iter; left time: 2.0823s
Updating learning rate to 5.277787625e-06
Epoch: 7 cost time: 1.0363452434539795
Epoch: 7, Steps: 131 | Train Loss: 0.4280444 Vali Loss: 0.2846848 Best vali loss: 0.2769813
	iters: 100, epoch: 8 | loss: 0.3425105
	speed: 0.0130s/iter; left time: 0.4169s
Updating learning rate to 2.6388938125e-06
Epoch: 8 cost time: 1.0275790691375732
Epoch: 8, Steps: 131 | Train Loss: 0.3425105 Vali Loss: 0.2854974 Best vali loss: 0.2769813

best validation loss 0.2769812764554894

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0040645584337, 'e_layers': 4, 'learning_rate': 0.0020996273449, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8010099
	speed: 0.0149s/iter; left time: 29.8072s
	iters: 200, epoch: 1 | loss: 0.4480260
	speed: 0.0088s/iter; left time: 16.7671s
Updating learning rate to 0.002019715037377063
Validation loss decreased (inf --> 0.2968).  Saving model state dict ...
Epoch: 1 cost time: 2.6261045932769775
Epoch: 1, Steps: 262 | Train Loss: 0.6245180 Vali Loss: 0.2968332 Best vali loss: 0.2968332
	iters: 100, epoch: 2 | loss: 0.3591577
	speed: 0.0189s/iter; left time: 32.8766s
	iters: 200, epoch: 2 | loss: 0.6679620
	speed: 0.0082s/iter; left time: 13.4685s
Updating learning rate to 0.0017921440392217479
Epoch: 2 cost time: 2.2324910163879395
Epoch: 2, Steps: 262 | Train Loss: 0.5135598 Vali Loss: 0.2977407 Best vali loss: 0.2968332
	iters: 100, epoch: 3 | loss: 0.6782930
	speed: 0.0230s/iter; left time: 33.8101s
	iters: 200, epoch: 3 | loss: 0.6335775
	speed: 0.0117s/iter; left time: 16.0875s
Updating learning rate to 0.001451559971966966
Epoch: 3 cost time: 3.0667543411254883
Epoch: 3, Steps: 262 | Train Loss: 0.6559353 Vali Loss: 0.2988262 Best vali loss: 0.2968332
	iters: 100, epoch: 4 | loss: 0.4050251
	speed: 0.0384s/iter; left time: 46.5100s
	iters: 200, epoch: 4 | loss: 0.6758274
	speed: 0.0112s/iter; left time: 12.4702s
Updating learning rate to 0.00104981367245
Epoch: 4 cost time: 3.123715400695801
Epoch: 4, Steps: 262 | Train Loss: 0.5404263 Vali Loss: 0.2998876 Best vali loss: 0.2968332
	iters: 100, epoch: 5 | loss: 0.5585445
	speed: 0.0298s/iter; left time: 28.2564s
	iters: 200, epoch: 5 | loss: 0.4369917
	speed: 0.0112s/iter; left time: 9.5478s
Updating learning rate to 0.000648067372933034
Epoch: 5 cost time: 3.0941505432128906
Epoch: 5, Steps: 262 | Train Loss: 0.4977681 Vali Loss: 0.3214798 Best vali loss: 0.2968332
	iters: 100, epoch: 6 | loss: 0.3509627
	speed: 0.0276s/iter; left time: 18.9457s
	iters: 200, epoch: 6 | loss: 0.3488317
	speed: 0.0097s/iter; left time: 5.7100s
Updating learning rate to 0.000307483305678252
Epoch: 6 cost time: 2.6795239448547363
Epoch: 6, Steps: 262 | Train Loss: 0.3498972 Vali Loss: 0.3239849 Best vali loss: 0.2968332
	iters: 100, epoch: 7 | loss: 0.5728012
	speed: 0.0300s/iter; left time: 12.7302s
	iters: 200, epoch: 7 | loss: 0.3196481
	speed: 0.0122s/iter; left time: 3.9602s
Updating learning rate to 7.991230752293689e-05
Epoch: 7 cost time: 3.2879061698913574
Epoch: 7, Steps: 262 | Train Loss: 0.4462247 Vali Loss: 0.3248786 Best vali loss: 0.2968332
	iters: 100, epoch: 8 | loss: 0.2747223
	speed: 0.0278s/iter; left time: 4.5344s
	iters: 200, epoch: 8 | loss: 0.5581066
	speed: 0.0116s/iter; left time: 0.7288s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0765392780303955
Epoch: 8, Steps: 262 | Train Loss: 0.4164144 Vali Loss: 0.3235672 Best vali loss: 0.2968332

best validation loss 0.2968331582486829

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013897291304, 'e_layers': 1, 'learning_rate': 0.0001595711964, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00015349787936614937
Validation loss decreased (inf --> 0.3378).  Saving model state dict ...
Epoch: 1 cost time: 1.3128185272216797
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3377715 Best vali loss: 0.3377715
Updating learning rate to 0.0001362025357282452
Validation loss decreased (0.3378 --> 0.3215).  Saving model state dict ...
Epoch: 2 cost time: 1.2367966175079346
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3215233 Best vali loss: 0.3215233
Updating learning rate to 0.00011031822477247793
Validation loss decreased (0.3215 --> 0.3118).  Saving model state dict ...
Epoch: 3 cost time: 1.2355339527130127
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3117542 Best vali loss: 0.3117542
Updating learning rate to 7.97855982e-05
Validation loss decreased (0.3118 --> 0.3055).  Saving model state dict ...
Epoch: 4 cost time: 2.4512250423431396
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3054586 Best vali loss: 0.3054586
Updating learning rate to 4.9252971627522074e-05
Validation loss decreased (0.3055 --> 0.3021).  Saving model state dict ...
Epoch: 5 cost time: 2.386369228363037
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3020584 Best vali loss: 0.3020584
Updating learning rate to 2.3368660671754806e-05
Validation loss decreased (0.3021 --> 0.3002).  Saving model state dict ...
Epoch: 6 cost time: 2.438868522644043
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3001554 Best vali loss: 0.3001554
Updating learning rate to 6.07331703385064e-06
Validation loss decreased (0.3002 --> 0.2994).  Saving model state dict ...
Epoch: 7 cost time: 2.5190601348876953
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2994358 Best vali loss: 0.2994358
Updating learning rate to 0.0
Validation loss decreased (0.2994 --> 0.2992).  Saving model state dict ...
Epoch: 8 cost time: 1.4181365966796875
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2992234 Best vali loss: 0.2992234

best validation loss 0.29922344707099424

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0086356174519, 'e_layers': 4, 'learning_rate': 0.0025094554303, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3816515
	speed: 0.0253s/iter; left time: 208.8259s
	iters: 200, epoch: 1 | loss: 0.3432583
	speed: 0.0184s/iter; left time: 150.2255s
	iters: 300, epoch: 1 | loss: 0.6097904
	speed: 0.0180s/iter; left time: 144.7040s
	iters: 400, epoch: 1 | loss: 0.3771113
	speed: 0.0183s/iter; left time: 145.3779s
	iters: 500, epoch: 1 | loss: 1.1835924
	speed: 0.0103s/iter; left time: 80.9494s
	iters: 600, epoch: 1 | loss: 0.2507828
	speed: 0.0073s/iter; left time: 56.9607s
	iters: 700, epoch: 1 | loss: 0.4788594
	speed: 0.0077s/iter; left time: 59.1822s
	iters: 800, epoch: 1 | loss: 0.5313077
	speed: 0.0121s/iter; left time: 91.6497s
	iters: 900, epoch: 1 | loss: 0.4140291
	speed: 0.0108s/iter; left time: 80.7251s
	iters: 1000, epoch: 1 | loss: 0.4351386
	speed: 0.0122s/iter; left time: 90.1363s
Updating learning rate to 0.0024139449700517368
Validation loss decreased (inf --> 0.3307).  Saving model state dict ...
Epoch: 1 cost time: 14.395675659179688
Epoch: 1, Steps: 1045 | Train Loss: 0.5005522 Vali Loss: 0.3307135 Best vali loss: 0.3307135
	iters: 100, epoch: 2 | loss: 0.2260642
	speed: 0.0410s/iter; left time: 295.9552s
	iters: 200, epoch: 2 | loss: 0.2101134
	speed: 0.0179s/iter; left time: 127.6952s
	iters: 300, epoch: 2 | loss: 0.3497733
	speed: 0.0164s/iter; left time: 114.9328s
	iters: 400, epoch: 2 | loss: 0.7065888
	speed: 0.0158s/iter; left time: 109.3096s
	iters: 500, epoch: 2 | loss: 0.1831330
	speed: 0.0171s/iter; left time: 116.4114s
	iters: 600, epoch: 2 | loss: 0.2623392
	speed: 0.0086s/iter; left time: 57.7166s
	iters: 700, epoch: 2 | loss: 0.6343610
	speed: 0.0137s/iter; left time: 90.5929s
	iters: 800, epoch: 2 | loss: 1.3125055
	speed: 0.0155s/iter; left time: 101.2974s
	iters: 900, epoch: 2 | loss: 0.6699777
	speed: 0.0173s/iter; left time: 111.2438s
	iters: 1000, epoch: 2 | loss: 0.4079669
	speed: 0.0178s/iter; left time: 112.3087s
Updating learning rate to 0.0021419541910752678
Validation loss decreased (0.3307 --> 0.3223).  Saving model state dict ...
Epoch: 2 cost time: 15.705598592758179
Epoch: 2, Steps: 1045 | Train Loss: 0.4962823 Vali Loss: 0.3223075 Best vali loss: 0.3223075
	iters: 100, epoch: 3 | loss: 0.4709672
	speed: 0.0492s/iter; left time: 303.5804s
	iters: 200, epoch: 3 | loss: 0.3096420
	speed: 0.0098s/iter; left time: 59.4024s
	iters: 300, epoch: 3 | loss: 0.4227311
	speed: 0.0132s/iter; left time: 79.0168s
	iters: 400, epoch: 3 | loss: 0.4237851
	speed: 0.0135s/iter; left time: 79.3800s
	iters: 500, epoch: 3 | loss: 0.5158051
	speed: 0.0122s/iter; left time: 70.6844s
	iters: 600, epoch: 3 | loss: 0.4688845
	speed: 0.0112s/iter; left time: 63.3578s
	iters: 700, epoch: 3 | loss: 1.1806662
	speed: 0.0102s/iter; left time: 56.5464s
	iters: 800, epoch: 3 | loss: 0.7061653
	speed: 0.0099s/iter; left time: 54.2636s
	iters: 900, epoch: 3 | loss: 0.5826153
	speed: 0.0108s/iter; left time: 58.2309s
	iters: 1000, epoch: 3 | loss: 1.2327828
	speed: 0.0112s/iter; left time: 59.1189s
Updating learning rate to 0.0017348912238672087
Validation loss decreased (0.3223 --> 0.3215).  Saving model state dict ...
Epoch: 3 cost time: 12.447411060333252
Epoch: 3, Steps: 1045 | Train Loss: 0.6314045 Vali Loss: 0.3215275 Best vali loss: 0.3215275

best validation loss 0.3215275024472226

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0029375522024, 'e_layers': 1, 'learning_rate': 5.37399905e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37399905e-05
Validation loss decreased (inf --> 0.3496).  Saving model state dict ...
Epoch: 1 cost time: 0.9352996349334717
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3496372 Best vali loss: 0.3496372
Updating learning rate to 2.686999525e-05
Validation loss decreased (0.3496 --> 0.3355).  Saving model state dict ...
Epoch: 2 cost time: 0.5742888450622559
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3355246 Best vali loss: 0.3355246
Updating learning rate to 1.3434997625e-05
Validation loss decreased (0.3355 --> 0.3298).  Saving model state dict ...
Epoch: 3 cost time: 0.6921417713165283
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3297955 Best vali loss: 0.3297955

best validation loss 0.3297954693896569

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.005640097632, 'e_layers': 4, 'learning_rate': 0.0001217481571, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6334364
	speed: 0.0207s/iter; left time: 19.6864s
Updating learning rate to 0.00011711439378282935
Validation loss decreased (inf --> 0.2762).  Saving model state dict ...
Epoch: 1 cost time: 2.2062182426452637
Epoch: 1, Steps: 131 | Train Loss: 0.6334364 Vali Loss: 0.2762473 Best vali loss: 0.2762473
	iters: 100, epoch: 2 | loss: 0.6678207
	speed: 0.0196s/iter; left time: 16.0300s
Updating learning rate to 0.00010391855229118756
Epoch: 2 cost time: 1.4781584739685059
Epoch: 2, Steps: 131 | Train Loss: 0.6678207 Vali Loss: 0.2838479 Best vali loss: 0.2762473
	iters: 100, epoch: 3 | loss: 0.4196008
	speed: 0.0183s/iter; left time: 12.5950s
Updating learning rate to 8.416957987157609e-05
Epoch: 3 cost time: 1.7505559921264648
Epoch: 3, Steps: 131 | Train Loss: 0.4196008 Vali Loss: 0.2826382 Best vali loss: 0.2762473

best validation loss 0.27624734301866766

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.005640097632, 'e_layers': 4, 'learning_rate': 0.0001217481571, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4520800
	speed: 0.0256s/iter; left time: 14.2207s
Updating learning rate to 6.087407855e-05
Epoch: 4 cost time: 2.6178841590881348
Epoch: 4, Steps: 131 | Train Loss: 0.4520800 Vali Loss: 0.2983710 Best vali loss: 0.2762473
	iters: 100, epoch: 5 | loss: 0.5160274
	speed: 0.0299s/iter; left time: 12.6955s
Updating learning rate to 3.757857722842392e-05
Epoch: 5 cost time: 2.420012950897217
Epoch: 5, Steps: 131 | Train Loss: 0.5160274 Vali Loss: 0.2909233 Best vali loss: 0.2762473
	iters: 100, epoch: 6 | loss: 0.3344315
	speed: 0.0298s/iter; left time: 8.7545s
Updating learning rate to 1.782960480881245e-05
Epoch: 6 cost time: 2.3031134605407715
Epoch: 6, Steps: 131 | Train Loss: 0.3344315 Vali Loss: 0.3030494 Best vali loss: 0.2762473
	iters: 100, epoch: 7 | loss: 0.5368517
	speed: 0.0348s/iter; left time: 5.6802s
Updating learning rate to 4.633763317170652e-06
Epoch: 7 cost time: 3.0852322578430176
Epoch: 7, Steps: 131 | Train Loss: 0.5368517 Vali Loss: 0.3038405 Best vali loss: 0.2762473
	iters: 100, epoch: 8 | loss: 0.3158774
	speed: 0.0379s/iter; left time: 1.2119s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.298741340637207
Epoch: 8, Steps: 131 | Train Loss: 0.3158774 Vali Loss: 0.3049127 Best vali loss: 0.2762473

best validation loss 0.27624734301866766

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0029800296176, 'e_layers': 2, 'learning_rate': 0.0001397793585, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2941176
	speed: 0.0126s/iter; left time: 51.5084s
	iters: 200, epoch: 1 | loss: 0.4055845
	speed: 0.0078s/iter; left time: 30.8916s
	iters: 300, epoch: 1 | loss: 0.3842472
	speed: 0.0079s/iter; left time: 30.7167s
	iters: 400, epoch: 1 | loss: 1.0018682
	speed: 0.0070s/iter; left time: 26.4192s
	iters: 500, epoch: 1 | loss: 0.5578771
	speed: 0.0065s/iter; left time: 24.0820s
Updating learning rate to 0.0001397793585
Validation loss decreased (inf --> 0.2863).  Saving model state dict ...
Epoch: 1 cost time: 4.01962423324585
Epoch: 1, Steps: 523 | Train Loss: 0.7287389 Vali Loss: 0.2863139 Best vali loss: 0.2863139
	iters: 100, epoch: 2 | loss: 0.4966565
	speed: 0.0197s/iter; left time: 70.2746s
	iters: 200, epoch: 2 | loss: 0.4455136
	speed: 0.0100s/iter; left time: 34.4970s
	iters: 300, epoch: 2 | loss: 0.2331613
	speed: 0.0063s/iter; left time: 21.3392s
	iters: 400, epoch: 2 | loss: 0.3694385
	speed: 0.0110s/iter; left time: 35.7271s
	iters: 500, epoch: 2 | loss: 0.5577226
	speed: 0.0065s/iter; left time: 20.5656s
Updating learning rate to 6.988967925e-05
Validation loss decreased (0.2863 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 4.444999694824219
Epoch: 2, Steps: 523 | Train Loss: 0.4204985 Vali Loss: 0.2835483 Best vali loss: 0.2835483
	iters: 100, epoch: 3 | loss: 0.2512662
	speed: 0.0216s/iter; left time: 65.6089s
	iters: 200, epoch: 3 | loss: 0.2241536
	speed: 0.0095s/iter; left time: 28.0432s
	iters: 300, epoch: 3 | loss: 0.2659274
	speed: 0.0110s/iter; left time: 31.1737s
	iters: 400, epoch: 3 | loss: 0.4770877
	speed: 0.0094s/iter; left time: 25.6376s
	iters: 500, epoch: 3 | loss: 0.6812731
	speed: 0.0099s/iter; left time: 26.0608s
Updating learning rate to 3.4944839625e-05
Validation loss decreased (0.2835 --> 0.2741).  Saving model state dict ...
Epoch: 3 cost time: 5.378489017486572
Epoch: 3, Steps: 523 | Train Loss: 0.3799416 Vali Loss: 0.2740831 Best vali loss: 0.2740831
	iters: 100, epoch: 4 | loss: 0.4056286
	speed: 0.0237s/iter; left time: 59.5055s
	iters: 200, epoch: 4 | loss: 0.4141151
	speed: 0.0074s/iter; left time: 17.9315s
	iters: 300, epoch: 4 | loss: 0.4059713
	speed: 0.0090s/iter; left time: 20.9290s
	iters: 400, epoch: 4 | loss: 0.4128827
	speed: 0.0098s/iter; left time: 21.7847s
	iters: 500, epoch: 4 | loss: 0.3162560
	speed: 0.0065s/iter; left time: 13.7956s
Updating learning rate to 1.74724198125e-05
Epoch: 4 cost time: 4.224005937576294
Epoch: 4, Steps: 523 | Train Loss: 0.3909707 Vali Loss: 0.2797796 Best vali loss: 0.2740831
	iters: 100, epoch: 5 | loss: 0.4353226
	speed: 0.0185s/iter; left time: 36.8174s
	iters: 200, epoch: 5 | loss: 0.4381552
	speed: 0.0047s/iter; left time: 8.8877s
	iters: 300, epoch: 5 | loss: 0.5253454
	speed: 0.0087s/iter; left time: 15.5186s
	iters: 400, epoch: 5 | loss: 0.4118414
	speed: 0.0098s/iter; left time: 16.5893s
	iters: 500, epoch: 5 | loss: 0.5418707
	speed: 0.0108s/iter; left time: 17.1635s
Updating learning rate to 8.73620990625e-06
Epoch: 5 cost time: 4.430372953414917
Epoch: 5, Steps: 523 | Train Loss: 0.4705070 Vali Loss: 0.2826803 Best vali loss: 0.2740831
	iters: 100, epoch: 6 | loss: 0.4277016
	speed: 0.0208s/iter; left time: 30.5833s
	iters: 200, epoch: 6 | loss: 0.4754555
	speed: 0.0073s/iter; left time: 10.0224s
	iters: 300, epoch: 6 | loss: 0.2428232
	speed: 0.0079s/iter; left time: 9.9796s
	iters: 400, epoch: 6 | loss: 0.3527872
	speed: 0.0072s/iter; left time: 8.4227s
	iters: 500, epoch: 6 | loss: 0.1973628
	speed: 0.0080s/iter; left time: 8.5336s
Updating learning rate to 4.368104953125e-06
Epoch: 6 cost time: 4.08968186378479
Epoch: 6, Steps: 523 | Train Loss: 0.3392261 Vali Loss: 0.2820929 Best vali loss: 0.2740831
	iters: 100, epoch: 7 | loss: 0.3961807
	speed: 0.0158s/iter; left time: 14.9837s
	iters: 200, epoch: 7 | loss: 0.4125200
	speed: 0.0059s/iter; left time: 5.0308s
	iters: 300, epoch: 7 | loss: 0.5274383
	speed: 0.0078s/iter; left time: 5.7983s
	iters: 400, epoch: 7 | loss: 0.2757139
	speed: 0.0057s/iter; left time: 3.7037s
	iters: 500, epoch: 7 | loss: 0.5172969
	speed: 0.0065s/iter; left time: 3.5434s
Updating learning rate to 2.1840524765625e-06
Epoch: 7 cost time: 3.658235549926758
Epoch: 7, Steps: 523 | Train Loss: 0.4258299 Vali Loss: 0.2833458 Best vali loss: 0.2740831
	iters: 100, epoch: 8 | loss: 0.7677168
	speed: 0.0175s/iter; left time: 7.4097s
	iters: 200, epoch: 8 | loss: 0.1801481
	speed: 0.0066s/iter; left time: 2.1263s
	iters: 300, epoch: 8 | loss: 0.2389548
	speed: 0.0062s/iter; left time: 1.3857s
	iters: 400, epoch: 8 | loss: 0.2500720
	speed: 0.0058s/iter; left time: 0.7223s
	iters: 500, epoch: 8 | loss: 0.5530460
	speed: 0.0064s/iter; left time: 0.1548s
Updating learning rate to 1.09202623828125e-06
Epoch: 8 cost time: 3.4879679679870605
Epoch: 8, Steps: 523 | Train Loss: 0.3979876 Vali Loss: 0.2830147 Best vali loss: 0.2740831

best validation loss 0.2740831361600749

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029983037184, 'e_layers': 1, 'learning_rate': 6.32159438e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4400587
	speed: 0.0112s/iter; left time: 92.4419s
	iters: 200, epoch: 1 | loss: 1.4033279
	speed: 0.0048s/iter; left time: 38.9066s
	iters: 300, epoch: 1 | loss: 0.4495767
	speed: 0.0046s/iter; left time: 37.3446s
	iters: 400, epoch: 1 | loss: 0.8416583
	speed: 0.0056s/iter; left time: 44.9157s
	iters: 500, epoch: 1 | loss: 0.2435447
	speed: 0.0059s/iter; left time: 46.4780s
	iters: 600, epoch: 1 | loss: 0.4809364
	speed: 0.0061s/iter; left time: 47.3884s
	iters: 700, epoch: 1 | loss: 0.5319011
	speed: 0.0046s/iter; left time: 35.3518s
	iters: 800, epoch: 1 | loss: 0.2800777
	speed: 0.0049s/iter; left time: 37.4181s
	iters: 900, epoch: 1 | loss: 1.3333309
	speed: 0.0042s/iter; left time: 31.5700s
	iters: 1000, epoch: 1 | loss: 0.3057712
	speed: 0.0056s/iter; left time: 41.4386s
Updating learning rate to 6.080993020260188e-05
Validation loss decreased (inf --> 0.3138).  Saving model state dict ...
Epoch: 1 cost time: 5.704973459243774
Epoch: 1, Steps: 1045 | Train Loss: 0.6310184 Vali Loss: 0.3137551 Best vali loss: 0.3137551
	iters: 100, epoch: 2 | loss: 0.1975921
	speed: 0.0169s/iter; left time: 121.8644s
	iters: 200, epoch: 2 | loss: 1.3283397
	speed: 0.0042s/iter; left time: 29.6051s
	iters: 300, epoch: 2 | loss: 0.2494285
	speed: 0.0040s/iter; left time: 28.2420s
	iters: 400, epoch: 2 | loss: 0.1800950
	speed: 0.0037s/iter; left time: 25.4257s
	iters: 500, epoch: 2 | loss: 0.5236886
	speed: 0.0031s/iter; left time: 21.2669s
	iters: 600, epoch: 2 | loss: 0.4357502
	speed: 0.0035s/iter; left time: 23.2725s
	iters: 700, epoch: 2 | loss: 0.2586161
	speed: 0.0044s/iter; left time: 29.2168s
	iters: 800, epoch: 2 | loss: 0.2847274
	speed: 0.0053s/iter; left time: 34.4046s
	iters: 900, epoch: 2 | loss: 0.8594850
	speed: 0.0049s/iter; left time: 31.5559s
	iters: 1000, epoch: 2 | loss: 0.3483472
	speed: 0.0039s/iter; left time: 24.6041s
Updating learning rate to 5.395818317004384e-05
Validation loss decreased (0.3138 --> 0.2981).  Saving model state dict ...
Epoch: 2 cost time: 4.384152173995972
Epoch: 2, Steps: 1045 | Train Loss: 0.4666070 Vali Loss: 0.2981451 Best vali loss: 0.2981451
	iters: 100, epoch: 3 | loss: 0.6380144
	speed: 0.0163s/iter; left time: 100.2835s
	iters: 200, epoch: 3 | loss: 0.3082270
	speed: 0.0045s/iter; left time: 27.1981s
	iters: 300, epoch: 3 | loss: 1.4715294
	speed: 0.0049s/iter; left time: 29.0932s
	iters: 400, epoch: 3 | loss: 1.0674827
	speed: 0.0044s/iter; left time: 25.5552s
	iters: 500, epoch: 3 | loss: 0.6234268
	speed: 0.0047s/iter; left time: 27.0152s
	iters: 600, epoch: 3 | loss: 0.7448215
	speed: 0.0044s/iter; left time: 25.1832s
	iters: 700, epoch: 3 | loss: 0.6334115
	speed: 0.0048s/iter; left time: 26.4830s
	iters: 800, epoch: 3 | loss: 0.3785937
	speed: 0.0050s/iter; left time: 27.1282s
	iters: 900, epoch: 3 | loss: 0.4375323
	speed: 0.0057s/iter; left time: 30.8651s
	iters: 1000, epoch: 3 | loss: 0.3639193
	speed: 0.0089s/iter; left time: 47.1643s
Updating learning rate to 4.370381907679131e-05
Validation loss decreased (0.2981 --> 0.2910).  Saving model state dict ...
Epoch: 3 cost time: 5.6106884479522705
Epoch: 3, Steps: 1045 | Train Loss: 0.6666959 Vali Loss: 0.2910225 Best vali loss: 0.2910225
	iters: 100, epoch: 4 | loss: 0.1981942
	speed: 0.0222s/iter; left time: 113.8972s
	iters: 200, epoch: 4 | loss: 0.4289279
	speed: 0.0070s/iter; left time: 35.1420s
	iters: 300, epoch: 4 | loss: 1.1208551
	speed: 0.0068s/iter; left time: 33.7184s
	iters: 400, epoch: 4 | loss: 0.5540326
	speed: 0.0054s/iter; left time: 26.0143s
	iters: 500, epoch: 4 | loss: 0.3395090
	speed: 0.0052s/iter; left time: 24.7886s
	iters: 600, epoch: 4 | loss: 0.1665065
	speed: 0.0039s/iter; left time: 17.8478s
	iters: 700, epoch: 4 | loss: 0.9907804
	speed: 0.0066s/iter; left time: 30.0641s
	iters: 800, epoch: 4 | loss: 0.2914194
	speed: 0.0092s/iter; left time: 40.8898s
	iters: 900, epoch: 4 | loss: 0.4862488
	speed: 0.0101s/iter; left time: 43.8216s
	iters: 1000, epoch: 4 | loss: 1.6275399
	speed: 0.0114s/iter; left time: 48.0860s
Updating learning rate to 3.16079719e-05
Validation loss decreased (0.2910 --> 0.2880).  Saving model state dict ...
Epoch: 4 cost time: 7.763723373413086
Epoch: 4, Steps: 1045 | Train Loss: 0.6204014 Vali Loss: 0.2880326 Best vali loss: 0.2880326
	iters: 100, epoch: 5 | loss: 0.3350977
	speed: 0.0431s/iter; left time: 175.9331s
	iters: 200, epoch: 5 | loss: 0.9682040
	speed: 0.0114s/iter; left time: 45.3100s
	iters: 300, epoch: 5 | loss: 1.3239119
	speed: 0.0113s/iter; left time: 43.7774s
	iters: 400, epoch: 5 | loss: 1.0869243
	speed: 0.0096s/iter; left time: 36.4577s
	iters: 500, epoch: 5 | loss: 0.5686293
	speed: 0.0059s/iter; left time: 21.8501s
	iters: 600, epoch: 5 | loss: 0.3660848
	speed: 0.0096s/iter; left time: 34.3995s
	iters: 700, epoch: 5 | loss: 0.1988987
	speed: 0.0066s/iter; left time: 22.9783s
	iters: 800, epoch: 5 | loss: 0.4623079
	speed: 0.0039s/iter; left time: 13.1569s
	iters: 900, epoch: 5 | loss: 0.2016211
	speed: 0.0036s/iter; left time: 11.8433s
	iters: 1000, epoch: 5 | loss: 0.2353708
	speed: 0.0038s/iter; left time: 12.2199s
Updating learning rate to 1.9512124723208692e-05
Validation loss decreased (0.2880 --> 0.2857).  Saving model state dict ...
Epoch: 5 cost time: 7.903145790100098
Epoch: 5, Steps: 1045 | Train Loss: 0.5747050 Vali Loss: 0.2857354 Best vali loss: 0.2857354
	iters: 100, epoch: 6 | loss: 0.3224434
	speed: 0.0220s/iter; left time: 66.8743s
	iters: 200, epoch: 6 | loss: 0.4773711
	speed: 0.0048s/iter; left time: 14.1691s
	iters: 300, epoch: 6 | loss: 0.5317770
	speed: 0.0035s/iter; left time: 9.9786s
	iters: 400, epoch: 6 | loss: 0.3315331
	speed: 0.0037s/iter; left time: 10.1979s
	iters: 500, epoch: 6 | loss: 0.8390345
	speed: 0.0052s/iter; left time: 13.7018s
	iters: 600, epoch: 6 | loss: 0.2413711
	speed: 0.0047s/iter; left time: 11.8416s
	iters: 700, epoch: 6 | loss: 0.4025650
	speed: 0.0052s/iter; left time: 12.6495s
	iters: 800, epoch: 6 | loss: 1.3451209
	speed: 0.0051s/iter; left time: 11.8935s
	iters: 900, epoch: 6 | loss: 0.3227181
	speed: 0.0052s/iter; left time: 11.5939s
	iters: 1000, epoch: 6 | loss: 0.2926863
	speed: 0.0043s/iter; left time: 9.2653s
Updating learning rate to 9.257760629956159e-06
Validation loss decreased (0.2857 --> 0.2851).  Saving model state dict ...
Epoch: 6 cost time: 4.989664077758789
Epoch: 6, Steps: 1045 | Train Loss: 0.5106621 Vali Loss: 0.2850806 Best vali loss: 0.2850806
	iters: 100, epoch: 7 | loss: 0.1763477
	speed: 0.0169s/iter; left time: 33.7413s
	iters: 200, epoch: 7 | loss: 0.2265336
	speed: 0.0041s/iter; left time: 7.7723s
	iters: 300, epoch: 7 | loss: 0.2173960
	speed: 0.0042s/iter; left time: 7.4912s
	iters: 400, epoch: 7 | loss: 0.2712858
	speed: 0.0050s/iter; left time: 8.4201s
	iters: 500, epoch: 7 | loss: 0.9874765
	speed: 0.0058s/iter; left time: 9.1796s
	iters: 600, epoch: 7 | loss: 0.2154710
	speed: 0.0057s/iter; left time: 8.5122s
	iters: 700, epoch: 7 | loss: 0.9468749
	speed: 0.0052s/iter; left time: 7.2816s
	iters: 800, epoch: 7 | loss: 0.9563305
	speed: 0.0050s/iter; left time: 6.3996s
	iters: 900, epoch: 7 | loss: 0.4707813
	speed: 0.0048s/iter; left time: 5.6721s
	iters: 1000, epoch: 7 | loss: 0.3077888
	speed: 0.0055s/iter; left time: 6.0277s
Updating learning rate to 2.4060135973981123e-06
Validation loss decreased (0.2851 --> 0.2849).  Saving model state dict ...
Epoch: 7 cost time: 5.230774402618408
Epoch: 7, Steps: 1045 | Train Loss: 0.4776286 Vali Loss: 0.2849392 Best vali loss: 0.2849392
	iters: 100, epoch: 8 | loss: 0.8317127
	speed: 0.0217s/iter; left time: 20.5718s
	iters: 200, epoch: 8 | loss: 0.4935210
	speed: 0.0057s/iter; left time: 4.7950s
	iters: 300, epoch: 8 | loss: 0.2330657
	speed: 0.0056s/iter; left time: 4.1973s
	iters: 400, epoch: 8 | loss: 0.2012915
	speed: 0.0057s/iter; left time: 3.6525s
	iters: 500, epoch: 8 | loss: 0.2122347
	speed: 0.0055s/iter; left time: 3.0174s
	iters: 600, epoch: 8 | loss: 0.2788370
	speed: 0.0052s/iter; left time: 2.3239s
	iters: 700, epoch: 8 | loss: 0.1630968
	speed: 0.0057s/iter; left time: 1.9600s
	iters: 800, epoch: 8 | loss: 0.2111537
	speed: 0.0057s/iter; left time: 1.4047s
	iters: 900, epoch: 8 | loss: 0.3620638
	speed: 0.0056s/iter; left time: 0.8151s
	iters: 1000, epoch: 8 | loss: 0.7243024
	speed: 0.0049s/iter; left time: 0.2260s
Updating learning rate to 0.0
Validation loss decreased (0.2849 --> 0.2849).  Saving model state dict ...
Epoch: 8 cost time: 5.743478298187256
Epoch: 8, Steps: 1045 | Train Loss: 0.3711279 Vali Loss: 0.2848778 Best vali loss: 0.2848778

best validation loss 0.28487779820173725

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0021094216667, 'e_layers': 3, 'learning_rate': 0.000144089756, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6781698
	speed: 0.0151s/iter; left time: 124.9927s
	iters: 200, epoch: 1 | loss: 0.7728310
	speed: 0.0084s/iter; left time: 68.6051s
	iters: 300, epoch: 1 | loss: 0.4686908
	speed: 0.0086s/iter; left time: 69.4727s
	iters: 400, epoch: 1 | loss: 0.4735854
	speed: 0.0085s/iter; left time: 67.3737s
	iters: 500, epoch: 1 | loss: 0.2331730
	speed: 0.0062s/iter; left time: 49.0697s
	iters: 600, epoch: 1 | loss: 0.4778191
	speed: 0.0070s/iter; left time: 54.0543s
	iters: 700, epoch: 1 | loss: 0.7681683
	speed: 0.0087s/iter; left time: 66.6597s
	iters: 800, epoch: 1 | loss: 0.7948127
	speed: 0.0083s/iter; left time: 62.5381s
	iters: 900, epoch: 1 | loss: 0.4640129
	speed: 0.0073s/iter; left time: 54.5857s
	iters: 1000, epoch: 1 | loss: 0.3857833
	speed: 0.0069s/iter; left time: 50.5308s
Updating learning rate to 0.000144089756
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 8.451639175415039
Epoch: 1, Steps: 1045 | Train Loss: 0.5517046 Vali Loss: 0.2831979 Best vali loss: 0.2831979
	iters: 100, epoch: 2 | loss: 1.3230456
	speed: 0.0214s/iter; left time: 154.0928s
	iters: 200, epoch: 2 | loss: 1.3936111
	speed: 0.0064s/iter; left time: 45.6974s
	iters: 300, epoch: 2 | loss: 0.3229602
	speed: 0.0066s/iter; left time: 46.6551s
	iters: 400, epoch: 2 | loss: 0.1982500
	speed: 0.0063s/iter; left time: 43.8658s
	iters: 500, epoch: 2 | loss: 0.6292347
	speed: 0.0064s/iter; left time: 43.8228s
	iters: 600, epoch: 2 | loss: 0.3190324
	speed: 0.0068s/iter; left time: 45.6722s
	iters: 700, epoch: 2 | loss: 1.8129213
	speed: 0.0076s/iter; left time: 50.3565s
	iters: 800, epoch: 2 | loss: 0.3637486
	speed: 0.0075s/iter; left time: 49.0584s
	iters: 900, epoch: 2 | loss: 0.9687673
	speed: 0.0068s/iter; left time: 43.8835s
	iters: 1000, epoch: 2 | loss: 0.1995337
	speed: 0.0070s/iter; left time: 44.3858s
Updating learning rate to 7.2044878e-05
Epoch: 2 cost time: 7.300757646560669
Epoch: 2, Steps: 1045 | Train Loss: 0.7531105 Vali Loss: 0.2886272 Best vali loss: 0.2831979
	iters: 100, epoch: 3 | loss: 0.3232032
	speed: 0.0219s/iter; left time: 134.8774s
	iters: 200, epoch: 3 | loss: 0.5140114
	speed: 0.0077s/iter; left time: 46.8038s
	iters: 300, epoch: 3 | loss: 0.5279196
	speed: 0.0067s/iter; left time: 40.0798s
	iters: 400, epoch: 3 | loss: 0.2283112
	speed: 0.0068s/iter; left time: 39.8384s
	iters: 500, epoch: 3 | loss: 0.2544092
	speed: 0.0068s/iter; left time: 39.4102s
	iters: 600, epoch: 3 | loss: 0.7927250
	speed: 0.0060s/iter; left time: 34.1554s
	iters: 700, epoch: 3 | loss: 0.3840657
	speed: 0.0070s/iter; left time: 38.7828s
	iters: 800, epoch: 3 | loss: 0.2540141
	speed: 0.0053s/iter; left time: 28.7595s
	iters: 900, epoch: 3 | loss: 0.2699953
	speed: 0.0059s/iter; left time: 31.4257s
	iters: 1000, epoch: 3 | loss: 0.8295568
	speed: 0.0112s/iter; left time: 59.1013s
Updating learning rate to 3.6022439e-05
Epoch: 3 cost time: 7.745742082595825
Epoch: 3, Steps: 1045 | Train Loss: 0.4378211 Vali Loss: 0.2847498 Best vali loss: 0.2831979

best validation loss 0.2831978750366312

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.006123213969, 'e_layers': 1, 'learning_rate': 5.10257484e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.10257484e-05
Validation loss decreased (inf --> 0.3343).  Saving model state dict ...
Epoch: 1 cost time: 1.2904822826385498
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3343061 Best vali loss: 0.3343061
Updating learning rate to 2.55128742e-05
Validation loss decreased (0.3343 --> 0.3172).  Saving model state dict ...
Epoch: 2 cost time: 1.1070053577423096
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3172365 Best vali loss: 0.3172365
Updating learning rate to 1.27564371e-05
Validation loss decreased (0.3172 --> 0.3109).  Saving model state dict ...
Epoch: 3 cost time: 0.8570735454559326
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3108829 Best vali loss: 0.3108829

best validation loss 0.31088291096971044

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0033324907317, 'e_layers': 3, 'learning_rate': 0.000293742894, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4790141
	speed: 0.0209s/iter; left time: 19.8079s
Updating learning rate to 0.0002825629707936162
Validation loss decreased (inf --> 0.2810).  Saving model state dict ...
Epoch: 1 cost time: 2.21697735786438
Epoch: 1, Steps: 131 | Train Loss: 0.4790141 Vali Loss: 0.2810311 Best vali loss: 0.2810311
	iters: 100, epoch: 2 | loss: 0.5208566
	speed: 0.0223s/iter; left time: 18.2581s
Updating learning rate to 0.0002507252431363806
Validation loss decreased (0.2810 --> 0.2790).  Saving model state dict ...
Epoch: 2 cost time: 1.9304864406585693
Epoch: 2, Steps: 131 | Train Loss: 0.5208566 Vali Loss: 0.2789799 Best vali loss: 0.2789799
	iters: 100, epoch: 3 | loss: 0.5357675
	speed: 0.0320s/iter; left time: 21.9593s
Updating learning rate to 0.00020307671645438739
Epoch: 3 cost time: 2.1203067302703857
Epoch: 3, Steps: 131 | Train Loss: 0.5357675 Vali Loss: 0.2804919 Best vali loss: 0.2789799

best validation loss 0.27897994221919264

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0033324907317, 'e_layers': 3, 'learning_rate': 0.000293742894, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4719782
	speed: 0.0238s/iter; left time: 13.2585s
Updating learning rate to 0.000146871447
Validation loss decreased (0.2790 --> 0.2744).  Saving model state dict ...
Epoch: 4 cost time: 2.285839796066284
Epoch: 4, Steps: 131 | Train Loss: 0.4719782 Vali Loss: 0.2744454 Best vali loss: 0.2744454
	iters: 100, epoch: 5 | loss: 0.4847224
	speed: 0.0183s/iter; left time: 7.7885s
Updating learning rate to 9.066617754561264e-05
Epoch: 5 cost time: 1.4804270267486572
Epoch: 5, Steps: 131 | Train Loss: 0.4847224 Vali Loss: 0.2753907 Best vali loss: 0.2744454
	iters: 100, epoch: 6 | loss: 0.5132425
	speed: 0.0170s/iter; left time: 4.9914s
Updating learning rate to 4.30176508636194e-05
Epoch: 6 cost time: 1.3646299839019775
Epoch: 6, Steps: 131 | Train Loss: 0.5132425 Vali Loss: 0.2824741 Best vali loss: 0.2744454
	iters: 100, epoch: 7 | loss: 0.4247020
	speed: 0.0161s/iter; left time: 2.6202s
Updating learning rate to 1.1179923206383773e-05
Epoch: 7 cost time: 1.2396697998046875
Epoch: 7, Steps: 131 | Train Loss: 0.4247020 Vali Loss: 0.2817143 Best vali loss: 0.2744454
	iters: 100, epoch: 8 | loss: 0.4580359
	speed: 0.0156s/iter; left time: 0.4989s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.415348768234253
Epoch: 8, Steps: 131 | Train Loss: 0.4580359 Vali Loss: 0.2813557 Best vali loss: 0.2744454

best validation loss 0.2744453720895275

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0014895726434, 'e_layers': 4, 'learning_rate': 0.0015660273474, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6144607
	speed: 0.0186s/iter; left time: 75.9143s
	iters: 200, epoch: 1 | loss: 0.5447640
	speed: 0.0106s/iter; left time: 42.1897s
	iters: 300, epoch: 1 | loss: 0.3568093
	speed: 0.0110s/iter; left time: 42.8180s
	iters: 400, epoch: 1 | loss: 0.4882903
	speed: 0.0120s/iter; left time: 45.4632s
	iters: 500, epoch: 1 | loss: 0.9896802
	speed: 0.0124s/iter; left time: 45.7221s
Updating learning rate to 0.0015660273474
Validation loss decreased (inf --> 0.3074).  Saving model state dict ...
Epoch: 1 cost time: 6.4674577713012695
Epoch: 1, Steps: 523 | Train Loss: 0.5988009 Vali Loss: 0.3074391 Best vali loss: 0.3074391
	iters: 100, epoch: 2 | loss: 0.2964496
	speed: 0.0232s/iter; left time: 82.7735s
	iters: 200, epoch: 2 | loss: 0.3714330
	speed: 0.0114s/iter; left time: 39.4094s
	iters: 300, epoch: 2 | loss: 0.2267437
	speed: 0.0114s/iter; left time: 38.4898s
	iters: 400, epoch: 2 | loss: 0.4769503
	speed: 0.0116s/iter; left time: 37.9235s
	iters: 500, epoch: 2 | loss: 1.0436234
	speed: 0.0116s/iter; left time: 36.7442s
Updating learning rate to 0.0007830136737
Epoch: 2 cost time: 5.909874200820923
Epoch: 2, Steps: 523 | Train Loss: 0.4830400 Vali Loss: 0.3173501 Best vali loss: 0.3074391
	iters: 100, epoch: 3 | loss: 0.3414354
	speed: 0.0253s/iter; left time: 76.8457s
	iters: 200, epoch: 3 | loss: 0.5571395
	speed: 0.0119s/iter; left time: 34.9237s
	iters: 300, epoch: 3 | loss: 0.2854945
	speed: 0.0097s/iter; left time: 27.4316s
	iters: 400, epoch: 3 | loss: 0.5009990
	speed: 0.0088s/iter; left time: 23.9872s
	iters: 500, epoch: 3 | loss: 0.7299044
	speed: 0.0118s/iter; left time: 31.0821s
Updating learning rate to 0.00039150683685
Epoch: 3 cost time: 5.715745449066162
Epoch: 3, Steps: 523 | Train Loss: 0.4829946 Vali Loss: 0.3289802 Best vali loss: 0.3074391
	iters: 100, epoch: 4 | loss: 0.4943212
	speed: 0.0192s/iter; left time: 48.2106s
	iters: 200, epoch: 4 | loss: 0.5043741
	speed: 0.0118s/iter; left time: 28.4529s
	iters: 300, epoch: 4 | loss: 0.2680633
	speed: 0.0122s/iter; left time: 28.3440s
	iters: 400, epoch: 4 | loss: 1.0695449
	speed: 0.0101s/iter; left time: 22.3753s
	iters: 500, epoch: 4 | loss: 0.9691680
	speed: 0.0117s/iter; left time: 24.7302s
Updating learning rate to 0.000195753418425
Epoch: 4 cost time: 5.661163806915283
Epoch: 4, Steps: 523 | Train Loss: 0.6610943 Vali Loss: 0.3219296 Best vali loss: 0.3074391
	iters: 100, epoch: 5 | loss: 0.3788087
	speed: 0.0224s/iter; left time: 44.6697s
	iters: 200, epoch: 5 | loss: 0.8612861
	speed: 0.0114s/iter; left time: 21.6065s
	iters: 300, epoch: 5 | loss: 0.9106863
	speed: 0.0108s/iter; left time: 19.3287s
	iters: 400, epoch: 5 | loss: 0.3983700
	speed: 0.0101s/iter; left time: 17.1090s
	iters: 500, epoch: 5 | loss: 1.3292643
	speed: 0.0113s/iter; left time: 18.0040s
Updating learning rate to 9.78767092125e-05
Epoch: 5 cost time: 5.665224075317383
Epoch: 5, Steps: 523 | Train Loss: 0.7756831 Vali Loss: 0.3214292 Best vali loss: 0.3074391
	iters: 100, epoch: 6 | loss: 0.4145656
	speed: 0.0241s/iter; left time: 35.3932s
	iters: 200, epoch: 6 | loss: 0.4064896
	speed: 0.0110s/iter; left time: 15.1273s
	iters: 300, epoch: 6 | loss: 0.4123423
	speed: 0.0120s/iter; left time: 15.2456s
	iters: 400, epoch: 6 | loss: 1.0128404
	speed: 0.0121s/iter; left time: 14.1615s
	iters: 500, epoch: 6 | loss: 0.3642647
	speed: 0.0121s/iter; left time: 12.9859s
Updating learning rate to 4.893835460625e-05
Epoch: 6 cost time: 6.161480665206909
Epoch: 6, Steps: 523 | Train Loss: 0.5221005 Vali Loss: 0.3217898 Best vali loss: 0.3074391
	iters: 100, epoch: 7 | loss: 0.7333360
	speed: 0.0234s/iter; left time: 22.1505s
	iters: 200, epoch: 7 | loss: 1.1387634
	speed: 0.0115s/iter; left time: 9.7702s
	iters: 300, epoch: 7 | loss: 0.2628307
	speed: 0.0121s/iter; left time: 9.0712s
	iters: 400, epoch: 7 | loss: 0.6881666
	speed: 0.0121s/iter; left time: 7.8517s
	iters: 500, epoch: 7 | loss: 0.4771425
	speed: 0.0120s/iter; left time: 6.5883s
Updating learning rate to 2.4469177303125e-05
Epoch: 7 cost time: 6.134436368942261
Epoch: 7, Steps: 523 | Train Loss: 0.6600478 Vali Loss: 0.3217669 Best vali loss: 0.3074391
	iters: 100, epoch: 8 | loss: 0.4134823
	speed: 0.0240s/iter; left time: 10.1882s
	iters: 200, epoch: 8 | loss: 1.1219603
	speed: 0.0113s/iter; left time: 3.6451s
	iters: 300, epoch: 8 | loss: 0.5175092
	speed: 0.0111s/iter; left time: 2.4803s
	iters: 400, epoch: 8 | loss: 0.2947002
	speed: 0.0104s/iter; left time: 1.2840s
	iters: 500, epoch: 8 | loss: 0.2792972
	speed: 0.0120s/iter; left time: 0.2878s
Updating learning rate to 1.22345886515625e-05
Epoch: 8 cost time: 5.87389874458313
Epoch: 8, Steps: 523 | Train Loss: 0.5253898 Vali Loss: 0.3219591 Best vali loss: 0.3074391

best validation loss 0.30743911314870664

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0055211270768, 'e_layers': 3, 'learning_rate': 0.0023662935919, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6639746
	speed: 0.0170s/iter; left time: 16.1600s
Updating learning rate to 0.0022762319046845127
Validation loss decreased (inf --> 0.3182).  Saving model state dict ...
Epoch: 1 cost time: 1.8382439613342285
Epoch: 1, Steps: 131 | Train Loss: 0.6639746 Vali Loss: 0.3182455 Best vali loss: 0.3182455
	iters: 100, epoch: 2 | loss: 0.7234488
	speed: 0.0584s/iter; left time: 47.8115s
Updating learning rate to 0.0020197579185053816
Validation loss decreased (0.3182 --> 0.3178).  Saving model state dict ...
Epoch: 2 cost time: 4.67179799079895
Epoch: 2, Steps: 131 | Train Loss: 0.7234488 Vali Loss: 0.3177787 Best vali loss: 0.3177787
	iters: 100, epoch: 3 | loss: 0.5776669
	speed: 0.0624s/iter; left time: 42.8986s
Updating learning rate to 0.0016359174728159047
Epoch: 3 cost time: 4.070851564407349
Epoch: 3, Steps: 131 | Train Loss: 0.5776669 Vali Loss: 0.3267542 Best vali loss: 0.3177787
	iters: 100, epoch: 4 | loss: 0.6403144
	speed: 0.0623s/iter; left time: 34.6505s
Updating learning rate to 0.00118314679595
Epoch: 4 cost time: 3.864323854446411
Epoch: 4, Steps: 131 | Train Loss: 0.6403144 Vali Loss: 0.3258080 Best vali loss: 0.3177787
	iters: 100, epoch: 5 | loss: 0.5191487
	speed: 0.0601s/iter; left time: 25.5474s
Updating learning rate to 0.0007303761190840956
Epoch: 5 cost time: 4.406731605529785
Epoch: 5, Steps: 131 | Train Loss: 0.5191487 Vali Loss: 0.3256752 Best vali loss: 0.3177787
	iters: 100, epoch: 6 | loss: 0.5282509
	speed: 0.0628s/iter; left time: 18.4561s
Updating learning rate to 0.00034653567339461863
Epoch: 6 cost time: 4.153757572174072
Epoch: 6, Steps: 131 | Train Loss: 0.5282509 Vali Loss: 0.3217138 Best vali loss: 0.3177787
	iters: 100, epoch: 7 | loss: 0.6223251
	speed: 0.0541s/iter; left time: 8.8179s
Updating learning rate to 9.006168721548724e-05
Epoch: 7 cost time: 3.7933599948883057
Epoch: 7, Steps: 131 | Train Loss: 0.6223251 Vali Loss: 0.3227677 Best vali loss: 0.3177787
	iters: 100, epoch: 8 | loss: 0.6068376
	speed: 0.0627s/iter; left time: 2.0071s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.617842674255371
Epoch: 8, Steps: 131 | Train Loss: 0.6068376 Vali Loss: 0.3223079 Best vali loss: 0.3177787

best validation loss 0.3177786819240603

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0017593741457, 'e_layers': 1, 'learning_rate': 0.0034914690664, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0034914690664
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 0.6997561454772949
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2825279 Best vali loss: 0.2825279
Updating learning rate to 0.0017457345332
Epoch: 2 cost time: 0.8707778453826904
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2919274 Best vali loss: 0.2825279
Updating learning rate to 0.0008728672666
Epoch: 3 cost time: 0.9565494060516357
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2873918 Best vali loss: 0.2825279

best validation loss 0.2825279043936827

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010826978283, 'e_layers': 3, 'learning_rate': 0.000733585835, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2560453
	speed: 0.0176s/iter; left time: 72.0376s
	iters: 200, epoch: 1 | loss: 0.4743195
	speed: 0.0106s/iter; left time: 42.3420s
	iters: 300, epoch: 1 | loss: 0.2928352
	speed: 0.0088s/iter; left time: 34.0608s
	iters: 400, epoch: 1 | loss: 0.2553221
	speed: 0.0099s/iter; left time: 37.6253s
	iters: 500, epoch: 1 | loss: 0.3896822
	speed: 0.0102s/iter; left time: 37.4900s
Updating learning rate to 0.000733585835
Validation loss decreased (inf --> 0.2870).  Saving model state dict ...
Epoch: 1 cost time: 5.575817823410034
Epoch: 1, Steps: 523 | Train Loss: 0.3336408 Vali Loss: 0.2870438 Best vali loss: 0.2870438
	iters: 100, epoch: 2 | loss: 0.8524279
	speed: 0.0211s/iter; left time: 75.3071s
	iters: 200, epoch: 2 | loss: 0.5964627
	speed: 0.0078s/iter; left time: 26.9328s
	iters: 300, epoch: 2 | loss: 0.5457410
	speed: 0.0082s/iter; left time: 27.4333s
	iters: 400, epoch: 2 | loss: 0.9015564
	speed: 0.0078s/iter; left time: 25.3901s
	iters: 500, epoch: 2 | loss: 0.6343217
	speed: 0.0086s/iter; left time: 27.1886s
Updating learning rate to 0.0003667929175
Epoch: 2 cost time: 4.4323694705963135
Epoch: 2, Steps: 523 | Train Loss: 0.7061019 Vali Loss: 0.2914257 Best vali loss: 0.2870438
	iters: 100, epoch: 3 | loss: 0.6056691
	speed: 0.0181s/iter; left time: 55.0954s
	iters: 200, epoch: 3 | loss: 0.2262620
	speed: 0.0085s/iter; left time: 25.0970s
	iters: 300, epoch: 3 | loss: 0.3167379
	speed: 0.0085s/iter; left time: 24.0364s
	iters: 400, epoch: 3 | loss: 0.2647284
	speed: 0.0073s/iter; left time: 20.0935s
	iters: 500, epoch: 3 | loss: 0.5731737
	speed: 0.0060s/iter; left time: 15.7606s
Updating learning rate to 0.00018339645875
Epoch: 3 cost time: 4.091874122619629
Epoch: 3, Steps: 523 | Train Loss: 0.3973142 Vali Loss: 0.2910106 Best vali loss: 0.2870438

best validation loss 0.2870438175602179

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0004590866284, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6262819
	speed: 0.0174s/iter; left time: 16.5178s
Updating learning rate to 0.0004590866284
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 1.8109946250915527
Epoch: 1, Steps: 131 | Train Loss: 0.6262819 Vali Loss: 0.2800200 Best vali loss: 0.2800200
	iters: 100, epoch: 2 | loss: 0.4030243
	speed: 0.0196s/iter; left time: 16.0277s
Updating learning rate to 0.0002295433142
Epoch: 2 cost time: 1.6948118209838867
Epoch: 2, Steps: 131 | Train Loss: 0.4030243 Vali Loss: 0.2807774 Best vali loss: 0.2800200
	iters: 100, epoch: 3 | loss: 0.4619628
	speed: 0.0281s/iter; left time: 19.3136s
Updating learning rate to 0.0001147716571
Epoch: 3 cost time: 1.7904407978057861
Epoch: 3, Steps: 131 | Train Loss: 0.4619628 Vali Loss: 0.2831709 Best vali loss: 0.2800200

best validation loss 0.2800199683103122

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0004590866284, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5552307
	speed: 0.0177s/iter; left time: 9.8610s
Updating learning rate to 5.738582855e-05
Epoch: 4 cost time: 1.7900166511535645
Epoch: 4, Steps: 131 | Train Loss: 0.5552307 Vali Loss: 0.2884840 Best vali loss: 0.2800200
	iters: 100, epoch: 5 | loss: 0.3708428
	speed: 0.0173s/iter; left time: 7.3565s
Updating learning rate to 2.8692914275e-05
Epoch: 5 cost time: 1.4932498931884766
Epoch: 5, Steps: 131 | Train Loss: 0.3708428 Vali Loss: 0.2905053 Best vali loss: 0.2800200
	iters: 100, epoch: 6 | loss: 0.4376882
	speed: 0.0268s/iter; left time: 7.8695s
Updating learning rate to 1.43464571375e-05
Epoch: 6 cost time: 1.5061967372894287
Epoch: 6, Steps: 131 | Train Loss: 0.4376882 Vali Loss: 0.2910550 Best vali loss: 0.2800200
	iters: 100, epoch: 7 | loss: 0.4092534
	speed: 0.0253s/iter; left time: 4.1187s
Updating learning rate to 7.17322856875e-06
Epoch: 7 cost time: 2.0861451625823975
Epoch: 7, Steps: 131 | Train Loss: 0.4092534 Vali Loss: 0.2914805 Best vali loss: 0.2800200
	iters: 100, epoch: 8 | loss: 0.3762315
	speed: 0.0210s/iter; left time: 0.6727s
Updating learning rate to 3.586614284375e-06
Epoch: 8 cost time: 1.3626086711883545
Epoch: 8, Steps: 131 | Train Loss: 0.3762315 Vali Loss: 0.2918106 Best vali loss: 0.2800200

best validation loss 0.2800199683103122

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010043914615, 'e_layers': 3, 'learning_rate': 0.001195346052, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0826811
	speed: 0.0165s/iter; left time: 67.3767s
	iters: 200, epoch: 1 | loss: 0.6853182
	speed: 0.0090s/iter; left time: 35.9492s
	iters: 300, epoch: 1 | loss: 0.4984336
	speed: 0.0094s/iter; left time: 36.4111s
	iters: 400, epoch: 1 | loss: 0.3537684
	speed: 0.0079s/iter; left time: 29.9961s
	iters: 500, epoch: 1 | loss: 0.5151321
	speed: 0.0064s/iter; left time: 23.5520s
Updating learning rate to 0.001195346052
Validation loss decreased (inf --> 0.3107).  Saving model state dict ...
Epoch: 1 cost time: 4.815291881561279
Epoch: 1, Steps: 523 | Train Loss: 0.6270667 Vali Loss: 0.3106649 Best vali loss: 0.3106649
	iters: 100, epoch: 2 | loss: 0.4252748
	speed: 0.0198s/iter; left time: 70.5928s
	iters: 200, epoch: 2 | loss: 0.7957435
	speed: 0.0078s/iter; left time: 27.1184s
	iters: 300, epoch: 2 | loss: 0.5571596
	speed: 0.0079s/iter; left time: 26.5115s
	iters: 400, epoch: 2 | loss: 1.0404948
	speed: 0.0094s/iter; left time: 30.5767s
	iters: 500, epoch: 2 | loss: 1.1051818
	speed: 0.0090s/iter; left time: 28.5613s
Updating learning rate to 0.000597673026
Epoch: 2 cost time: 4.612654447555542
Epoch: 2, Steps: 523 | Train Loss: 0.7847709 Vali Loss: 0.3268484 Best vali loss: 0.3106649
	iters: 100, epoch: 3 | loss: 0.6495466
	speed: 0.0179s/iter; left time: 54.4487s
	iters: 200, epoch: 3 | loss: 1.6960078
	speed: 0.0092s/iter; left time: 27.1443s
	iters: 300, epoch: 3 | loss: 0.9038914
	speed: 0.0091s/iter; left time: 25.7913s
	iters: 400, epoch: 3 | loss: 0.5281352
	speed: 0.0094s/iter; left time: 25.6642s
	iters: 500, epoch: 3 | loss: 0.3670868
	speed: 0.0088s/iter; left time: 23.1958s
Updating learning rate to 0.000298836513
Epoch: 3 cost time: 4.78043270111084
Epoch: 3, Steps: 523 | Train Loss: 0.8289336 Vali Loss: 0.3269462 Best vali loss: 0.3106649
	iters: 100, epoch: 4 | loss: 1.3081585
	speed: 0.0158s/iter; left time: 39.7890s
	iters: 200, epoch: 4 | loss: 0.3280815
	speed: 0.0090s/iter; left time: 21.6374s
	iters: 300, epoch: 4 | loss: 0.7791427
	speed: 0.0091s/iter; left time: 21.0459s
	iters: 400, epoch: 4 | loss: 0.4833122
	speed: 0.0091s/iter; left time: 20.2225s
	iters: 500, epoch: 4 | loss: 0.4946854
	speed: 0.0093s/iter; left time: 19.6722s
Updating learning rate to 0.0001494182565
Epoch: 4 cost time: 4.6226537227630615
Epoch: 4, Steps: 523 | Train Loss: 0.6786761 Vali Loss: 0.3241404 Best vali loss: 0.3106649
	iters: 100, epoch: 5 | loss: 0.7154716
	speed: 0.0183s/iter; left time: 36.5337s
	iters: 200, epoch: 5 | loss: 0.7606297
	speed: 0.0083s/iter; left time: 15.6757s
	iters: 300, epoch: 5 | loss: 1.1490246
	speed: 0.0092s/iter; left time: 16.5499s
	iters: 400, epoch: 5 | loss: 0.4925891
	speed: 0.0092s/iter; left time: 15.5005s
	iters: 500, epoch: 5 | loss: 0.4287283
	speed: 0.0092s/iter; left time: 14.5949s
Updating learning rate to 7.470912825e-05
Epoch: 5 cost time: 4.639686584472656
Epoch: 5, Steps: 523 | Train Loss: 0.7092887 Vali Loss: 0.3224725 Best vali loss: 0.3106649
	iters: 100, epoch: 6 | loss: 0.4713778
	speed: 0.0189s/iter; left time: 27.7776s
	iters: 200, epoch: 6 | loss: 1.0597440
	speed: 0.0076s/iter; left time: 10.3979s
	iters: 300, epoch: 6 | loss: 0.3974469
	speed: 0.0072s/iter; left time: 9.0895s
	iters: 400, epoch: 6 | loss: 0.2691233
	speed: 0.0082s/iter; left time: 9.5876s
	iters: 500, epoch: 6 | loss: 0.4482805
	speed: 0.0086s/iter; left time: 9.1657s
Updating learning rate to 3.7354564125e-05
Epoch: 6 cost time: 4.248875617980957
Epoch: 6, Steps: 523 | Train Loss: 0.5291945 Vali Loss: 0.3225124 Best vali loss: 0.3106649
	iters: 100, epoch: 7 | loss: 0.5359900
	speed: 0.0175s/iter; left time: 16.5890s
	iters: 200, epoch: 7 | loss: 0.2817014
	speed: 0.0078s/iter; left time: 6.5834s
	iters: 300, epoch: 7 | loss: 1.8242981
	speed: 0.0070s/iter; left time: 5.2277s
	iters: 400, epoch: 7 | loss: 1.1671058
	speed: 0.0069s/iter; left time: 4.4696s
	iters: 500, epoch: 7 | loss: 0.2779586
	speed: 0.0083s/iter; left time: 4.5406s
Updating learning rate to 1.86772820625e-05
Epoch: 7 cost time: 4.027952432632446
Epoch: 7, Steps: 523 | Train Loss: 0.8174108 Vali Loss: 0.3225358 Best vali loss: 0.3106649
	iters: 100, epoch: 8 | loss: 0.4620739
	speed: 0.0204s/iter; left time: 8.6291s
	iters: 200, epoch: 8 | loss: 0.3559220
	speed: 0.0093s/iter; left time: 3.0257s
	iters: 300, epoch: 8 | loss: 0.7354785
	speed: 0.0099s/iter; left time: 2.2141s
	iters: 400, epoch: 8 | loss: 0.5529884
	speed: 0.0105s/iter; left time: 1.3045s
	iters: 500, epoch: 8 | loss: 0.5645379
	speed: 0.0102s/iter; left time: 0.2444s
Updating learning rate to 9.33864103125e-06
Epoch: 8 cost time: 5.265904426574707
Epoch: 8, Steps: 523 | Train Loss: 0.5342001 Vali Loss: 0.3222930 Best vali loss: 0.3106649

best validation loss 0.31066488463801495

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0097583782409, 'e_layers': 4, 'learning_rate': 0.0001196486596, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7807901
	speed: 0.0159s/iter; left time: 64.7759s
	iters: 200, epoch: 1 | loss: 0.3389215
	speed: 0.0112s/iter; left time: 44.7252s
	iters: 300, epoch: 1 | loss: 0.8838532
	speed: 0.0112s/iter; left time: 43.4023s
	iters: 400, epoch: 1 | loss: 0.2795931
	speed: 0.0115s/iter; left time: 43.5681s
	iters: 500, epoch: 1 | loss: 0.3160714
	speed: 0.0118s/iter; left time: 43.5003s
Updating learning rate to 0.00011509480364842505
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 6.161017894744873
Epoch: 1, Steps: 523 | Train Loss: 0.5198459 Vali Loss: 0.2821181 Best vali loss: 0.2821181
	iters: 100, epoch: 2 | loss: 0.2199482
	speed: 0.0190s/iter; left time: 67.5165s
	iters: 200, epoch: 2 | loss: 0.7392978
	speed: 0.0070s/iter; left time: 24.2231s
	iters: 300, epoch: 2 | loss: 0.3810317
	speed: 0.0104s/iter; left time: 34.8954s
	iters: 400, epoch: 2 | loss: 0.9419878
	speed: 0.0112s/iter; left time: 36.6953s
	iters: 500, epoch: 2 | loss: 0.4482872
	speed: 0.0107s/iter; left time: 33.9545s
Updating learning rate to 0.00010212651908152045
Validation loss decreased (0.2821 --> 0.2806).  Saving model state dict ...
Epoch: 2 cost time: 5.073437929153442
Epoch: 2, Steps: 523 | Train Loss: 0.5461105 Vali Loss: 0.2806373 Best vali loss: 0.2806373
	iters: 100, epoch: 3 | loss: 0.2477321
	speed: 0.0221s/iter; left time: 67.1397s
	iters: 200, epoch: 3 | loss: 0.1953928
	speed: 0.0099s/iter; left time: 29.1954s
	iters: 300, epoch: 3 | loss: 0.3043077
	speed: 0.0108s/iter; left time: 30.7280s
	iters: 400, epoch: 3 | loss: 0.2688703
	speed: 0.0107s/iter; left time: 29.3853s
	iters: 500, epoch: 3 | loss: 0.3040661
	speed: 0.0106s/iter; left time: 28.0337s
Updating learning rate to 8.271810966680513e-05
Validation loss decreased (0.2806 --> 0.2804).  Saving model state dict ...
Epoch: 3 cost time: 5.552157640457153
Epoch: 3, Steps: 523 | Train Loss: 0.2640738 Vali Loss: 0.2804201 Best vali loss: 0.2804201
	iters: 100, epoch: 4 | loss: 0.6064600
	speed: 0.0218s/iter; left time: 54.8651s
	iters: 200, epoch: 4 | loss: 0.4148060
	speed: 0.0106s/iter; left time: 25.6413s
	iters: 300, epoch: 4 | loss: 0.4384744
	speed: 0.0108s/iter; left time: 25.1240s
	iters: 400, epoch: 4 | loss: 0.3724888
	speed: 0.0105s/iter; left time: 23.3380s
	iters: 500, epoch: 4 | loss: 0.9253517
	speed: 0.0110s/iter; left time: 23.3720s
Updating learning rate to 5.98243298e-05
Epoch: 4 cost time: 5.638731002807617
Epoch: 4, Steps: 523 | Train Loss: 0.5515162 Vali Loss: 0.2808014 Best vali loss: 0.2804201
	iters: 100, epoch: 5 | loss: 0.3403714
	speed: 0.0212s/iter; left time: 42.3379s
	iters: 200, epoch: 5 | loss: 0.3538917
	speed: 0.0091s/iter; left time: 17.2094s
	iters: 300, epoch: 5 | loss: 0.4046248
	speed: 0.0108s/iter; left time: 19.3446s
	iters: 400, epoch: 5 | loss: 0.2560642
	speed: 0.0109s/iter; left time: 18.4903s
	iters: 500, epoch: 5 | loss: 0.4417868
	speed: 0.0111s/iter; left time: 17.7052s
Updating learning rate to 3.6930549933194876e-05
Validation loss decreased (0.2804 --> 0.2781).  Saving model state dict ...
Epoch: 5 cost time: 5.432351589202881
Epoch: 5, Steps: 523 | Train Loss: 0.3593478 Vali Loss: 0.2780653 Best vali loss: 0.2780653
	iters: 100, epoch: 6 | loss: 0.2580139
	speed: 0.0200s/iter; left time: 29.3689s
	iters: 200, epoch: 6 | loss: 0.3044965
	speed: 0.0099s/iter; left time: 13.5787s
	iters: 300, epoch: 6 | loss: 0.7592564
	speed: 0.0104s/iter; left time: 13.1903s
	iters: 400, epoch: 6 | loss: 0.3802165
	speed: 0.0105s/iter; left time: 12.3285s
	iters: 500, epoch: 6 | loss: 0.3358568
	speed: 0.0104s/iter; left time: 11.1364s
Updating learning rate to 1.752214051847955e-05
Epoch: 6 cost time: 5.375298976898193
Epoch: 6, Steps: 523 | Train Loss: 0.4075680 Vali Loss: 0.2811874 Best vali loss: 0.2780653
	iters: 100, epoch: 7 | loss: 0.7519757
	speed: 0.0217s/iter; left time: 20.5438s
	iters: 200, epoch: 7 | loss: 0.5423170
	speed: 0.0103s/iter; left time: 8.7657s
	iters: 300, epoch: 7 | loss: 0.2648132
	speed: 0.0108s/iter; left time: 8.0914s
	iters: 400, epoch: 7 | loss: 0.3784121
	speed: 0.0105s/iter; left time: 6.7929s
	iters: 500, epoch: 7 | loss: 0.2452568
	speed: 0.0103s/iter; left time: 5.6545s
Updating learning rate to 4.55385595157496e-06
Epoch: 7 cost time: 5.551442861557007
Epoch: 7, Steps: 523 | Train Loss: 0.4365550 Vali Loss: 0.2824536 Best vali loss: 0.2780653
	iters: 100, epoch: 8 | loss: 1.0530183
	speed: 0.0217s/iter; left time: 9.2129s
	iters: 200, epoch: 8 | loss: 0.3041339
	speed: 0.0104s/iter; left time: 3.3827s
	iters: 300, epoch: 8 | loss: 0.6995213
	speed: 0.0110s/iter; left time: 2.4680s
	iters: 400, epoch: 8 | loss: 0.5570479
	speed: 0.0112s/iter; left time: 1.3860s
	iters: 500, epoch: 8 | loss: 0.8800638
	speed: 0.0108s/iter; left time: 0.2587s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.66823935508728
Epoch: 8, Steps: 523 | Train Loss: 0.6987570 Vali Loss: 0.2826642 Best vali loss: 0.2780653

best validation loss 0.27806534800732524

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008249913205, 'e_layers': 1, 'learning_rate': 7.8334403e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1367413
	speed: 0.0119s/iter; left time: 48.7531s
	iters: 200, epoch: 1 | loss: 0.2525867
	speed: 0.0055s/iter; left time: 22.0453s
	iters: 300, epoch: 1 | loss: 0.2056752
	speed: 0.0056s/iter; left time: 21.8015s
	iters: 400, epoch: 1 | loss: 0.3942905
	speed: 0.0056s/iter; left time: 21.1788s
	iters: 500, epoch: 1 | loss: 0.6760872
	speed: 0.0047s/iter; left time: 17.2791s
Updating learning rate to 7.8334403e-05
Validation loss decreased (inf --> 0.3185).  Saving model state dict ...
Epoch: 1 cost time: 3.1574606895446777
Epoch: 1, Steps: 523 | Train Loss: 0.5330762 Vali Loss: 0.3185374 Best vali loss: 0.3185374
	iters: 100, epoch: 2 | loss: 0.7064212
	speed: 0.0130s/iter; left time: 46.3772s
	iters: 200, epoch: 2 | loss: 0.2376696
	speed: 0.0041s/iter; left time: 14.2638s
	iters: 300, epoch: 2 | loss: 0.3197606
	speed: 0.0050s/iter; left time: 16.8121s
	iters: 400, epoch: 2 | loss: 0.6045319
	speed: 0.0048s/iter; left time: 15.7442s
	iters: 500, epoch: 2 | loss: 0.7550402
	speed: 0.0047s/iter; left time: 14.8487s
Updating learning rate to 3.91672015e-05
Validation loss decreased (0.3185 --> 0.3011).  Saving model state dict ...
Epoch: 2 cost time: 2.4840245246887207
Epoch: 2, Steps: 523 | Train Loss: 0.5246847 Vali Loss: 0.3010990 Best vali loss: 0.3010990
	iters: 100, epoch: 3 | loss: 0.7502699
	speed: 0.0153s/iter; left time: 46.5755s
	iters: 200, epoch: 3 | loss: 0.2094654
	speed: 0.0055s/iter; left time: 16.2698s
	iters: 300, epoch: 3 | loss: 0.3742903
	speed: 0.0045s/iter; left time: 12.7876s
	iters: 400, epoch: 3 | loss: 0.3083959
	speed: 0.0060s/iter; left time: 16.4416s
	iters: 500, epoch: 3 | loss: 0.3752792
	speed: 0.0060s/iter; left time: 15.9463s
Updating learning rate to 1.958360075e-05
Validation loss decreased (0.3011 --> 0.2963).  Saving model state dict ...
Epoch: 3 cost time: 2.973536491394043
Epoch: 3, Steps: 523 | Train Loss: 0.4035402 Vali Loss: 0.2962982 Best vali loss: 0.2962982

best validation loss 0.29629816239586815

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5050727
	speed: 0.0163s/iter; left time: 32.5694s
	iters: 200, epoch: 1 | loss: 0.5558906
	speed: 0.0099s/iter; left time: 18.7146s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.3355).  Saving model state dict ...
Epoch: 1 cost time: 2.920908212661743
Epoch: 1, Steps: 262 | Train Loss: 0.5304817 Vali Loss: 0.3354548 Best vali loss: 0.3354548
	iters: 100, epoch: 2 | loss: 0.6314496
	speed: 0.0206s/iter; left time: 35.8153s
	iters: 200, epoch: 2 | loss: 0.6633098
	speed: 0.0092s/iter; left time: 14.9914s
Updating learning rate to 0.00164194791575
Validation loss decreased (0.3355 --> 0.3234).  Saving model state dict ...
Epoch: 2 cost time: 2.4731552600860596
Epoch: 2, Steps: 262 | Train Loss: 0.6473797 Vali Loss: 0.3234482 Best vali loss: 0.3234482
	iters: 100, epoch: 3 | loss: 0.4414787
	speed: 0.0208s/iter; left time: 30.6288s
	iters: 200, epoch: 3 | loss: 0.7161974
	speed: 0.0083s/iter; left time: 11.3804s
Updating learning rate to 0.000820973957875
Validation loss decreased (0.3234 --> 0.3230).  Saving model state dict ...
Epoch: 3 cost time: 2.292201042175293
Epoch: 3, Steps: 262 | Train Loss: 0.5788381 Vali Loss: 0.3229915 Best vali loss: 0.3229915

best validation loss 0.3229915307728763

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0011470244082, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3464106
	speed: 0.0181s/iter; left time: 149.1630s
	iters: 200, epoch: 1 | loss: 0.4629225
	speed: 0.0113s/iter; left time: 92.4572s
	iters: 300, epoch: 1 | loss: 0.4720320
	speed: 0.0109s/iter; left time: 87.6458s
	iters: 400, epoch: 1 | loss: 0.3327611
	speed: 0.0108s/iter; left time: 85.6352s
	iters: 500, epoch: 1 | loss: 0.7305842
	speed: 0.0136s/iter; left time: 107.1818s
	iters: 600, epoch: 1 | loss: 0.5386500
	speed: 0.0140s/iter; left time: 108.5966s
	iters: 700, epoch: 1 | loss: 0.3183437
	speed: 0.0158s/iter; left time: 121.0511s
	iters: 800, epoch: 1 | loss: 1.6758990
	speed: 0.0142s/iter; left time: 107.0014s
	iters: 900, epoch: 1 | loss: 0.6048546
	speed: 0.0160s/iter; left time: 119.1473s
	iters: 1000, epoch: 1 | loss: 2.0185068
	speed: 0.0106s/iter; left time: 77.7004s
Updating learning rate to 0.0011470244082
Validation loss decreased (inf --> 0.3341).  Saving model state dict ...
Epoch: 1 cost time: 13.61583685874939
Epoch: 1, Steps: 1045 | Train Loss: 0.8500965 Vali Loss: 0.3340893 Best vali loss: 0.3340893
	iters: 100, epoch: 2 | loss: 0.4049571
	speed: 0.0329s/iter; left time: 237.1219s
	iters: 200, epoch: 2 | loss: 1.1393195
	speed: 0.0108s/iter; left time: 76.8746s
	iters: 300, epoch: 2 | loss: 0.4153204
	speed: 0.0103s/iter; left time: 72.4200s
	iters: 400, epoch: 2 | loss: 0.7258158
	speed: 0.0100s/iter; left time: 68.9089s
	iters: 500, epoch: 2 | loss: 0.3395408
	speed: 0.0112s/iter; left time: 76.4633s
	iters: 600, epoch: 2 | loss: 0.2307616
	speed: 0.0113s/iter; left time: 75.9109s
	iters: 700, epoch: 2 | loss: 0.5629219
	speed: 0.0112s/iter; left time: 74.2707s
	iters: 800, epoch: 2 | loss: 0.2755463
	speed: 0.0103s/iter; left time: 67.0260s
	iters: 900, epoch: 2 | loss: 0.2404372
	speed: 0.0106s/iter; left time: 67.9094s
	iters: 1000, epoch: 2 | loss: 0.2502271
	speed: 0.0105s/iter; left time: 66.4963s
Updating learning rate to 0.0005735122041
Validation loss decreased (0.3341 --> 0.3201).  Saving model state dict ...
Epoch: 2 cost time: 11.21085238456726
Epoch: 2, Steps: 1045 | Train Loss: 0.4584848 Vali Loss: 0.3200637 Best vali loss: 0.3200637
	iters: 100, epoch: 3 | loss: 0.3889405
	speed: 0.0312s/iter; left time: 192.4685s
	iters: 200, epoch: 3 | loss: 1.1711218
	speed: 0.0099s/iter; left time: 60.0082s
	iters: 300, epoch: 3 | loss: 0.2079834
	speed: 0.0124s/iter; left time: 74.0385s
	iters: 400, epoch: 3 | loss: 0.3512227
	speed: 0.0137s/iter; left time: 80.7200s
	iters: 500, epoch: 3 | loss: 1.0191013
	speed: 0.0150s/iter; left time: 86.8461s
	iters: 600, epoch: 3 | loss: 0.4280257
	speed: 0.0155s/iter; left time: 87.8126s
	iters: 700, epoch: 3 | loss: 0.6170153
	speed: 0.0147s/iter; left time: 82.0907s
	iters: 800, epoch: 3 | loss: 0.4323001
	speed: 0.0138s/iter; left time: 75.6073s
	iters: 900, epoch: 3 | loss: 1.2392983
	speed: 0.0145s/iter; left time: 77.8860s
	iters: 1000, epoch: 3 | loss: 0.4475734
	speed: 0.0156s/iter; left time: 82.1447s
Updating learning rate to 0.00028675610205
Epoch: 3 cost time: 14.241782426834106
Epoch: 3, Steps: 1045 | Train Loss: 0.6302583 Vali Loss: 0.3234332 Best vali loss: 0.3200637

best validation loss 0.3200636589979319

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008249913205, 'e_layers': 1, 'learning_rate': 7.8334403e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9406688
	speed: 0.0111s/iter; left time: 27.9119s
	iters: 200, epoch: 4 | loss: 0.1911871
	speed: 0.0050s/iter; left time: 12.0442s
	iters: 300, epoch: 4 | loss: 0.1711680
	speed: 0.0051s/iter; left time: 11.8076s
	iters: 400, epoch: 4 | loss: 0.3648727
	speed: 0.0056s/iter; left time: 12.2998s
	iters: 500, epoch: 4 | loss: 0.6525204
	speed: 0.0053s/iter; left time: 11.3050s
Updating learning rate to 9.791800375e-06
Validation loss decreased (0.2963 --> 0.2943).  Saving model state dict ...
Epoch: 4 cost time: 3.034137010574341
Epoch: 4, Steps: 523 | Train Loss: 0.4640834 Vali Loss: 0.2942582 Best vali loss: 0.2942582
	iters: 100, epoch: 5 | loss: 0.6377208
	speed: 0.0152s/iter; left time: 30.2556s
	iters: 200, epoch: 5 | loss: 0.2292570
	speed: 0.0044s/iter; left time: 8.3701s
	iters: 300, epoch: 5 | loss: 0.3094637
	speed: 0.0055s/iter; left time: 9.8998s
	iters: 400, epoch: 5 | loss: 0.5668745
	speed: 0.0052s/iter; left time: 8.8772s
	iters: 500, epoch: 5 | loss: 0.7343100
	speed: 0.0054s/iter; left time: 8.5627s
Updating learning rate to 4.8959001875e-06
Validation loss decreased (0.2943 --> 0.2933).  Saving model state dict ...
Epoch: 5 cost time: 2.739253520965576
Epoch: 5, Steps: 523 | Train Loss: 0.4955252 Vali Loss: 0.2933160 Best vali loss: 0.2933160
	iters: 100, epoch: 6 | loss: 0.7235207
	speed: 0.0143s/iter; left time: 20.9682s
	iters: 200, epoch: 6 | loss: 0.2036279
	speed: 0.0051s/iter; left time: 6.9875s
	iters: 300, epoch: 6 | loss: 0.3685630
	speed: 0.0047s/iter; left time: 5.9304s
	iters: 400, epoch: 6 | loss: 0.3004062
	speed: 0.0051s/iter; left time: 5.9652s
	iters: 500, epoch: 6 | loss: 0.3689884
	speed: 0.0054s/iter; left time: 5.7349s
Updating learning rate to 2.44795009375e-06
Validation loss decreased (0.2933 --> 0.2929).  Saving model state dict ...
Epoch: 6 cost time: 2.7146756649017334
Epoch: 6, Steps: 523 | Train Loss: 0.3930212 Vali Loss: 0.2928818 Best vali loss: 0.2928818
	iters: 100, epoch: 7 | loss: 0.5266706
	speed: 0.0129s/iter; left time: 12.2456s
	iters: 200, epoch: 7 | loss: 0.3528667
	speed: 0.0048s/iter; left time: 4.0479s
	iters: 300, epoch: 7 | loss: 0.4423309
	speed: 0.0047s/iter; left time: 3.4964s
	iters: 400, epoch: 7 | loss: 0.3117741
	speed: 0.0051s/iter; left time: 3.2828s
	iters: 500, epoch: 7 | loss: 0.3864233
	speed: 0.0046s/iter; left time: 2.5044s
Updating learning rate to 1.223975046875e-06
Validation loss decreased (0.2929 --> 0.2927).  Saving model state dict ...
Epoch: 7 cost time: 2.5567715167999268
Epoch: 7, Steps: 523 | Train Loss: 0.4040131 Vali Loss: 0.2926701 Best vali loss: 0.2926701
	iters: 100, epoch: 8 | loss: 0.2957285
	speed: 0.0151s/iter; left time: 6.4169s
	iters: 200, epoch: 8 | loss: 0.2961890
	speed: 0.0052s/iter; left time: 1.6966s
	iters: 300, epoch: 8 | loss: 0.2650523
	speed: 0.0055s/iter; left time: 1.2339s
	iters: 400, epoch: 8 | loss: 0.4538971
	speed: 0.0054s/iter; left time: 0.6711s
	iters: 500, epoch: 8 | loss: 0.3268746
	speed: 0.0053s/iter; left time: 0.1264s
Updating learning rate to 6.119875234375e-07
Validation loss decreased (0.2927 --> 0.2926).  Saving model state dict ...
Epoch: 8 cost time: 2.866605758666992
Epoch: 8, Steps: 523 | Train Loss: 0.3275483 Vali Loss: 0.2925715 Best vali loss: 0.2925715

best validation loss 0.29257148375970893

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0101439882161, 'e_layers': 3, 'learning_rate': 0.0003206107934, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6552123
	speed: 0.0189s/iter; left time: 37.7795s
	iters: 200, epoch: 1 | loss: 0.7962465
	speed: 0.0116s/iter; left time: 21.9260s
Updating learning rate to 0.00030840827166223235
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 3.450883626937866
Epoch: 1, Steps: 262 | Train Loss: 0.7257294 Vali Loss: 0.2792313 Best vali loss: 0.2792313
	iters: 100, epoch: 2 | loss: 0.3923552
	speed: 0.0288s/iter; left time: 49.9183s
	iters: 200, epoch: 2 | loss: 0.4152168
	speed: 0.0127s/iter; left time: 20.7923s
Updating learning rate to 0.00027365842976736956
Epoch: 2 cost time: 2.886012554168701
Epoch: 2, Steps: 262 | Train Loss: 0.4037860 Vali Loss: 0.2823432 Best vali loss: 0.2792313
	iters: 100, epoch: 3 | loss: 0.3738021
	speed: 0.0479s/iter; left time: 70.5948s
	iters: 200, epoch: 3 | loss: 0.4017143
	speed: 0.0144s/iter; left time: 19.7971s
Updating learning rate to 0.00022165161613580333
Epoch: 3 cost time: 4.162388563156128
Epoch: 3, Steps: 262 | Train Loss: 0.3877582 Vali Loss: 0.2950453 Best vali loss: 0.2792313
	iters: 100, epoch: 4 | loss: 0.3897167
	speed: 0.0554s/iter; left time: 67.0507s
	iters: 200, epoch: 4 | loss: 0.5023725
	speed: 0.0153s/iter; left time: 16.9653s
Updating learning rate to 0.0001603053967
Epoch: 4 cost time: 3.867584466934204
Epoch: 4, Steps: 262 | Train Loss: 0.4460446 Vali Loss: 0.2894997 Best vali loss: 0.2792313
	iters: 100, epoch: 5 | loss: 0.4973999
	speed: 0.0286s/iter; left time: 27.1656s
	iters: 200, epoch: 5 | loss: 0.2943639
	speed: 0.0094s/iter; left time: 8.0198s
Updating learning rate to 9.895917726419666e-05
Epoch: 5 cost time: 2.497241258621216
Epoch: 5, Steps: 262 | Train Loss: 0.3958819 Vali Loss: 0.2821579 Best vali loss: 0.2792313
	iters: 100, epoch: 6 | loss: 0.3178771
	speed: 0.0267s/iter; left time: 18.3422s
	iters: 200, epoch: 6 | loss: 0.4603088
	speed: 0.0115s/iter; left time: 6.7525s
Updating learning rate to 4.695236363263041e-05
Epoch: 6 cost time: 2.934471368789673
Epoch: 6, Steps: 262 | Train Loss: 0.3890930 Vali Loss: 0.2936168 Best vali loss: 0.2792313
	iters: 100, epoch: 7 | loss: 0.3516372
	speed: 0.0285s/iter; left time: 12.0959s
	iters: 200, epoch: 7 | loss: 0.2563730
	speed: 0.0124s/iter; left time: 4.0149s
Updating learning rate to 1.2202521737767631e-05
Epoch: 7 cost time: 3.149418830871582
Epoch: 7, Steps: 262 | Train Loss: 0.3040051 Vali Loss: 0.2911275 Best vali loss: 0.2792313
	iters: 100, epoch: 8 | loss: 0.3597780
	speed: 0.0303s/iter; left time: 4.9446s
	iters: 200, epoch: 8 | loss: 0.2114590
	speed: 0.0109s/iter; left time: 0.6877s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.906494140625
Epoch: 8, Steps: 262 | Train Loss: 0.2856185 Vali Loss: 0.2929690 Best vali loss: 0.2792313

best validation loss 0.2792312522699683

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0048562527043, 'e_layers': 3, 'learning_rate': 0.000526514715, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3016340
	speed: 0.0148s/iter; left time: 122.3826s
	iters: 200, epoch: 1 | loss: 0.4777496
	speed: 0.0086s/iter; left time: 69.8004s
	iters: 300, epoch: 1 | loss: 0.2285346
	speed: 0.0080s/iter; left time: 64.3754s
	iters: 400, epoch: 1 | loss: 0.1957168
	speed: 0.0083s/iter; left time: 65.8310s
	iters: 500, epoch: 1 | loss: 0.4032924
	speed: 0.0080s/iter; left time: 62.5876s
	iters: 600, epoch: 1 | loss: 1.5699000
	speed: 0.0073s/iter; left time: 56.8244s
	iters: 700, epoch: 1 | loss: 0.3774039
	speed: 0.0075s/iter; left time: 57.2341s
	iters: 800, epoch: 1 | loss: 1.4116915
	speed: 0.0080s/iter; left time: 60.3299s
	iters: 900, epoch: 1 | loss: 1.1203744
	speed: 0.0081s/iter; left time: 60.2079s
	iters: 1000, epoch: 1 | loss: 0.3686099
	speed: 0.0078s/iter; left time: 57.3099s
Updating learning rate to 0.0005064754418772567
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 8.562111854553223
Epoch: 1, Steps: 1045 | Train Loss: 0.6454907 Vali Loss: 0.2866752 Best vali loss: 0.2866752
	iters: 100, epoch: 2 | loss: 1.1729175
	speed: 0.0215s/iter; left time: 155.4118s
	iters: 200, epoch: 2 | loss: 0.3444628
	speed: 0.0077s/iter; left time: 54.5967s
	iters: 300, epoch: 2 | loss: 0.7471246
	speed: 0.0078s/iter; left time: 54.5600s
	iters: 400, epoch: 2 | loss: 0.4872928
	speed: 0.0082s/iter; left time: 56.6975s
	iters: 500, epoch: 2 | loss: 0.3065085
	speed: 0.0077s/iter; left time: 52.5239s
	iters: 600, epoch: 2 | loss: 0.7936300
	speed: 0.0077s/iter; left time: 51.7073s
	iters: 700, epoch: 2 | loss: 0.7037752
	speed: 0.0087s/iter; left time: 57.2920s
	iters: 800, epoch: 2 | loss: 0.5657731
	speed: 0.0074s/iter; left time: 48.1875s
	iters: 900, epoch: 2 | loss: 1.2850437
	speed: 0.0062s/iter; left time: 39.5791s
	iters: 1000, epoch: 2 | loss: 1.1137472
	speed: 0.0079s/iter; left time: 49.7211s
Updating learning rate to 0.00044940842018550124
Epoch: 2 cost time: 7.929553747177124
Epoch: 2, Steps: 1045 | Train Loss: 0.7520275 Vali Loss: 0.2905272 Best vali loss: 0.2866752
	iters: 100, epoch: 3 | loss: 0.1991881
	speed: 0.0391s/iter; left time: 241.4016s
	iters: 200, epoch: 3 | loss: 0.3202873
	speed: 0.0127s/iter; left time: 77.0667s
	iters: 300, epoch: 3 | loss: 1.2366168
	speed: 0.0115s/iter; left time: 68.5028s
	iters: 400, epoch: 3 | loss: 0.2698758
	speed: 0.0106s/iter; left time: 62.3447s
	iters: 500, epoch: 3 | loss: 0.2433339
	speed: 0.0126s/iter; left time: 72.9730s
	iters: 600, epoch: 3 | loss: 0.3853810
	speed: 0.0120s/iter; left time: 68.3299s
	iters: 700, epoch: 3 | loss: 0.2992883
	speed: 0.0117s/iter; left time: 64.9700s
	iters: 800, epoch: 3 | loss: 0.5953818
	speed: 0.0103s/iter; left time: 56.4234s
	iters: 900, epoch: 3 | loss: 0.3539125
	speed: 0.0122s/iter; left time: 65.3098s
	iters: 1000, epoch: 3 | loss: 1.0197772
	speed: 0.0102s/iter; left time: 53.6033s
Updating learning rate to 0.00036400158666346355
Epoch: 3 cost time: 12.085176944732666
Epoch: 3, Steps: 1045 | Train Loss: 0.4923043 Vali Loss: 0.2936751 Best vali loss: 0.2866752
	iters: 100, epoch: 4 | loss: 0.3292417
	speed: 0.0353s/iter; left time: 180.7001s
	iters: 200, epoch: 4 | loss: 0.4589632
	speed: 0.0102s/iter; left time: 51.1138s
	iters: 300, epoch: 4 | loss: 0.2974007
	speed: 0.0105s/iter; left time: 51.6023s
	iters: 400, epoch: 4 | loss: 0.1774624
	speed: 0.0098s/iter; left time: 47.1366s
	iters: 500, epoch: 4 | loss: 0.5178906
	speed: 0.0090s/iter; left time: 42.5466s
	iters: 600, epoch: 4 | loss: 1.1073849
	speed: 0.0101s/iter; left time: 46.5328s
	iters: 700, epoch: 4 | loss: 0.3559414
	speed: 0.0106s/iter; left time: 47.9135s
	iters: 800, epoch: 4 | loss: 0.2226348
	speed: 0.0107s/iter; left time: 47.5231s
	iters: 900, epoch: 4 | loss: 0.3514587
	speed: 0.0102s/iter; left time: 43.9444s
	iters: 1000, epoch: 4 | loss: 0.8285370
	speed: 0.0101s/iter; left time: 42.7187s
Updating learning rate to 0.0002632573575
Epoch: 4 cost time: 10.431037187576294
Epoch: 4, Steps: 1045 | Train Loss: 0.4646915 Vali Loss: 0.2900630 Best vali loss: 0.2866752
	iters: 100, epoch: 5 | loss: 0.9432399
	speed: 0.0319s/iter; left time: 130.2245s
	iters: 200, epoch: 5 | loss: 0.4182068
	speed: 0.0096s/iter; left time: 38.2902s
	iters: 300, epoch: 5 | loss: 0.2669694
	speed: 0.0094s/iter; left time: 36.3775s
	iters: 400, epoch: 5 | loss: 0.3401986
	speed: 0.0102s/iter; left time: 38.6337s
	iters: 500, epoch: 5 | loss: 0.4662918
	speed: 0.0093s/iter; left time: 34.3617s
	iters: 600, epoch: 5 | loss: 0.2038297
	speed: 0.0087s/iter; left time: 31.0176s
	iters: 700, epoch: 5 | loss: 0.6459851
	speed: 0.0097s/iter; left time: 33.8870s
	iters: 800, epoch: 5 | loss: 0.2970814
	speed: 0.0101s/iter; left time: 34.2085s
	iters: 900, epoch: 5 | loss: 0.3123651
	speed: 0.0101s/iter; left time: 33.1435s
	iters: 1000, epoch: 5 | loss: 0.2549919
	speed: 0.0102s/iter; left time: 32.3109s
Updating learning rate to 0.0001625131283365365
Epoch: 5 cost time: 10.212977409362793
Epoch: 5, Steps: 1045 | Train Loss: 0.4149160 Vali Loss: 0.2892127 Best vali loss: 0.2866752
	iters: 100, epoch: 6 | loss: 0.3917903
	speed: 0.0316s/iter; left time: 96.0636s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.002530286228, 'e_layers': 2, 'learning_rate': 0.0027643246753, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0559080
	speed: 0.0146s/iter; left time: 120.5187s
	iters: 200, epoch: 1 | loss: 0.2167332
	speed: 0.0080s/iter; left time: 65.1682s
	iters: 300, epoch: 1 | loss: 1.6447747
	speed: 0.0068s/iter; left time: 55.1054s
	iters: 400, epoch: 1 | loss: 0.4108616
	speed: 0.0074s/iter; left time: 58.7500s
	iters: 500, epoch: 1 | loss: 0.2598012
	speed: 0.0082s/iter; left time: 64.6376s
	iters: 600, epoch: 1 | loss: 0.3422862
	speed: 0.0082s/iter; left time: 63.8507s
	iters: 700, epoch: 1 | loss: 0.4020972
	speed: 0.0078s/iter; left time: 59.9589s
	iters: 800, epoch: 1 | loss: 0.2654150
	speed: 0.0078s/iter; left time: 58.9747s
	iters: 900, epoch: 1 | loss: 0.2530932
	speed: 0.0078s/iter; left time: 58.1356s
	iters: 1000, epoch: 1 | loss: 0.2326648
	speed: 0.0056s/iter; left time: 41.2409s
Updating learning rate to 0.0027643246753
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 8.156491756439209
Epoch: 1, Steps: 1045 | Train Loss: 0.5083635 Vali Loss: 0.2877004 Best vali loss: 0.2877004
	iters: 100, epoch: 2 | loss: 0.2755324
	speed: 0.0228s/iter; left time: 164.4864s
	iters: 200, epoch: 2 | loss: 0.4922103
	speed: 0.0106s/iter; left time: 75.6884s
	iters: 300, epoch: 2 | loss: 1.0044369
	speed: 0.0103s/iter; left time: 72.1786s
	iters: 400, epoch: 2 | loss: 0.3475046
	speed: 0.0107s/iter; left time: 73.6602s
	iters: 500, epoch: 2 | loss: 0.2915848
	speed: 0.0099s/iter; left time: 67.4190s
	iters: 600, epoch: 2 | loss: 0.2772641
	speed: 0.0091s/iter; left time: 60.9604s
	iters: 700, epoch: 2 | loss: 0.5687283
	speed: 0.0098s/iter; left time: 64.7863s
	iters: 800, epoch: 2 | loss: 1.1735408
	speed: 0.0099s/iter; left time: 64.3812s
	iters: 900, epoch: 2 | loss: 0.2978120
	speed: 0.0097s/iter; left time: 62.4624s
	iters: 1000, epoch: 2 | loss: 0.4837833
	speed: 0.0093s/iter; left time: 58.6602s
Updating learning rate to 0.00138216233765
Epoch: 2 cost time: 10.375447273254395
Epoch: 2, Steps: 1045 | Train Loss: 0.5212397 Vali Loss: 0.2972668 Best vali loss: 0.2877004
	iters: 100, epoch: 3 | loss: 0.3791403
	speed: 0.0348s/iter; left time: 214.4549s
	iters: 200, epoch: 3 | loss: 0.5182264
	speed: 0.0099s/iter; left time: 60.0690s
	iters: 300, epoch: 3 | loss: 0.3334342
	speed: 0.0109s/iter; left time: 64.9922s
	iters: 400, epoch: 3 | loss: 0.3514460
	speed: 0.0104s/iter; left time: 61.3078s
	iters: 500, epoch: 3 | loss: 0.5433563
	speed: 0.0100s/iter; left time: 57.8535s
	iters: 600, epoch: 3 | loss: 0.4384714
	speed: 0.0074s/iter; left time: 41.8775s
	iters: 700, epoch: 3 | loss: 0.9160278
	speed: 0.0040s/iter; left time: 22.1645s
	iters: 800, epoch: 3 | loss: 0.1451389
	speed: 0.0038s/iter; left time: 20.6688s
	iters: 900, epoch: 3 | loss: 1.1904404
	speed: 0.0073s/iter; left time: 39.4393s
	iters: 1000, epoch: 3 | loss: 0.3932565
	speed: 0.0060s/iter; left time: 31.8675s
Updating learning rate to 0.000691081168825
Epoch: 3 cost time: 8.533418893814087
Epoch: 3, Steps: 1045 | Train Loss: 0.5208938 Vali Loss: 0.2898586 Best vali loss: 0.2877004

best validation loss 0.2877003924360768

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0093373483469, 'e_layers': 1, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6664757
	speed: 0.0133s/iter; left time: 26.5200s
	iters: 200, epoch: 1 | loss: 0.5768772
	speed: 0.0086s/iter; left time: 16.2990s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.2957).  Saving model state dict ...
Epoch: 1 cost time: 2.3305747509002686
Epoch: 1, Steps: 262 | Train Loss: 0.6216764 Vali Loss: 0.2956948 Best vali loss: 0.2956948
	iters: 100, epoch: 2 | loss: 0.7567350
	speed: 0.0167s/iter; left time: 28.9190s
	iters: 200, epoch: 2 | loss: 0.9954656
	speed: 0.0087s/iter; left time: 14.2719s
Updating learning rate to 0.0019699025932
Epoch: 2 cost time: 2.186522960662842
Epoch: 2, Steps: 262 | Train Loss: 0.8761003 Vali Loss: 0.2961020 Best vali loss: 0.2956948
	iters: 100, epoch: 3 | loss: 0.4465647
	speed: 0.0309s/iter; left time: 45.4789s
	iters: 200, epoch: 3 | loss: 0.4183528
	speed: 0.0100s/iter; left time: 13.6739s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 2.473992109298706
Epoch: 3, Steps: 262 | Train Loss: 0.4324588 Vali Loss: 0.3365932 Best vali loss: 0.2956948

best validation loss 0.29569479616967753

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001268677818, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012203916437006396
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 1.077888011932373
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2833437 Best vali loss: 0.2833437
Updating learning rate to 0.00010828842531243763
Validation loss decreased (0.2833 --> 0.2785).  Saving model state dict ...
Epoch: 2 cost time: 0.629370927810669
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2785483 Best vali loss: 0.2785483
Updating learning rate to 8.770898999788464e-05
Epoch: 3 cost time: 1.0095617771148682
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2813525 Best vali loss: 0.2785483

best validation loss 0.2785483371118668

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001268677818, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.34338909e-05
Epoch: 4 cost time: 1.3154706954956055
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2810878 Best vali loss: 0.2785483
Updating learning rate to 3.915879180211537e-05
Epoch: 5 cost time: 0.9074487686157227
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2807087 Best vali loss: 0.2785483
Updating learning rate to 1.8579356487562376e-05
Epoch: 6 cost time: 0.927365779876709
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2812774 Best vali loss: 0.2785483
Updating learning rate to 4.828617429936034e-06
Epoch: 7 cost time: 0.9688410758972168
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2817945 Best vali loss: 0.2785483
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8798229694366455
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2819890 Best vali loss: 0.2785483

best validation loss 0.2785483371118668

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4685515
	speed: 0.0125s/iter; left time: 24.9448s
	iters: 200, epoch: 1 | loss: 0.6288681
	speed: 0.0036s/iter; left time: 6.8118s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.513965129852295
Epoch: 1, Steps: 262 | Train Loss: 0.5487098 Vali Loss: 0.2812864 Best vali loss: 0.2812864
	iters: 100, epoch: 2 | loss: 0.3859093
	speed: 0.0121s/iter; left time: 20.9094s
	iters: 200, epoch: 2 | loss: 0.6056238
	speed: 0.0063s/iter; left time: 10.2657s
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 1.722306251525879
Epoch: 2, Steps: 262 | Train Loss: 0.4957666 Vali Loss: 0.2835033 Best vali loss: 0.2812864
	iters: 100, epoch: 3 | loss: 0.6014801
	speed: 0.0150s/iter; left time: 22.1123s
	iters: 200, epoch: 3 | loss: 0.4612538
	speed: 0.0090s/iter; left time: 12.3017s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 2.071336030960083
Epoch: 3, Steps: 262 | Train Loss: 0.5313669 Vali Loss: 0.2853745 Best vali loss: 0.2812864
	iters: 100, epoch: 4 | loss: 0.3968066
	speed: 0.0289s/iter; left time: 34.9474s
	iters: 200, epoch: 4 | loss: 0.4811746
	speed: 0.0079s/iter; left time: 8.7797s
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 2.3811099529266357
Epoch: 4, Steps: 262 | Train Loss: 0.4389906 Vali Loss: 0.2970574 Best vali loss: 0.2812864
	iters: 100, epoch: 5 | loss: 0.3920619
	speed: 0.0301s/iter; left time: 28.5810s
	iters: 200, epoch: 5 | loss: 0.2992450
	speed: 0.0103s/iter; left time: 8.7745s
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 2.5845022201538086
Epoch: 5, Steps: 262 | Train Loss: 0.3456535 Vali Loss: 0.2961481 Best vali loss: 0.2812864
	iters: 100, epoch: 6 | loss: 0.4867197
	speed: 0.0337s/iter; left time: 23.1748s
	iters: 200, epoch: 6 | loss: 0.3946985
	speed: 0.0084s/iter; left time: 4.9341s
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 2.471376895904541
Epoch: 6, Steps: 262 | Train Loss: 0.4407091 Vali Loss: 0.3040890 Best vali loss: 0.2812864
	iters: 100, epoch: 7 | loss: 0.4573652
	speed: 0.0281s/iter; left time: 11.9324s
	iters: 200, epoch: 7 | loss: 0.2858271
	speed: 0.0091s/iter; left time: 2.9732s
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 2.46492862701416
Epoch: 7, Steps: 262 | Train Loss: 0.3715962 Vali Loss: 0.3015124 Best vali loss: 0.2812864
	iters: 100, epoch: 8 | loss: 0.3099633
	speed: 0.0177s/iter; left time: 2.8868s
	iters: 200, epoch: 8 | loss: 0.3661200
	speed: 0.0081s/iter; left time: 0.5095s
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 2.015947103500366
Epoch: 8, Steps: 262 | Train Loss: 0.3380416 Vali Loss: 0.3017481 Best vali loss: 0.2812864

best validation loss 0.2812864411803771

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6228932
	speed: 0.0234s/iter; left time: 22.1688s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 2.5514745712280273
Epoch: 1, Steps: 131 | Train Loss: 0.6228932 Vali Loss: 0.2812964 Best vali loss: 0.2812964
	iters: 100, epoch: 2 | loss: 0.4512645
	speed: 0.0242s/iter; left time: 19.7570s
Updating learning rate to 6.252043389458952e-05
Epoch: 2 cost time: 1.9004716873168945
Epoch: 2, Steps: 131 | Train Loss: 0.4512645 Vali Loss: 0.2815182 Best vali loss: 0.2812964
	iters: 100, epoch: 3 | loss: 0.5318508
	speed: 0.0215s/iter; left time: 14.7951s
Updating learning rate to 5.063887571827247e-05
Validation loss decreased (0.2813 --> 0.2801).  Saving model state dict ...
Epoch: 3 cost time: 1.9500913619995117
Epoch: 3, Steps: 131 | Train Loss: 0.5318508 Vali Loss: 0.2800840 Best vali loss: 0.2800840
	iters: 100, epoch: 4 | loss: 0.6210665
	speed: 0.0234s/iter; left time: 13.0199s
Updating learning rate to 3.662362225e-05
Epoch: 4 cost time: 1.9943442344665527
Epoch: 4, Steps: 131 | Train Loss: 0.6210665 Vali Loss: 0.2817625 Best vali loss: 0.2800840
	iters: 100, epoch: 5 | loss: 0.4864333
	speed: 0.0226s/iter; left time: 9.6051s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.2801 --> 0.2792).  Saving model state dict ...
Epoch: 5 cost time: 2.006681442260742
Epoch: 5, Steps: 131 | Train Loss: 0.4864333 Vali Loss: 0.2792378 Best vali loss: 0.2792378
	iters: 100, epoch: 6 | loss: 0.6838748
	speed: 0.0241s/iter; left time: 7.0903s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.2792 --> 0.2775).  Saving model state dict ...
Epoch: 6 cost time: 2.0618321895599365
Epoch: 6, Steps: 131 | Train Loss: 0.6838748 Vali Loss: 0.2774889 Best vali loss: 0.2774889
	iters: 100, epoch: 7 | loss: 0.4988169
	speed: 0.0227s/iter; left time: 3.6926s
Updating learning rate to 2.7878072468000404e-06
Epoch: 7 cost time: 1.9783480167388916
Epoch: 7, Steps: 131 | Train Loss: 0.4988169 Vali Loss: 0.2777498 Best vali loss: 0.2774889
	iters: 100, epoch: 8 | loss: 0.6173629
	speed: 0.0309s/iter; left time: 0.9888s
Updating learning rate to 0.0
Validation loss decreased (0.2775 --> 0.2770).  Saving model state dict ...
Epoch: 8 cost time: 2.4250881671905518
Epoch: 8, Steps: 131 | Train Loss: 0.6173629 Vali Loss: 0.2769806 Best vali loss: 0.2769806

best validation loss 0.2769806071500789

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0050056289839, 'e_layers': 4, 'learning_rate': 0.0011086116092, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4503780
	speed: 0.0247s/iter; left time: 203.7071s
	iters: 200, epoch: 1 | loss: 0.9242168
	speed: 0.0183s/iter; left time: 149.0225s
	iters: 300, epoch: 1 | loss: 0.2445974
	speed: 0.0156s/iter; left time: 125.7814s
	iters: 400, epoch: 1 | loss: 0.4051351
	speed: 0.0170s/iter; left time: 135.7287s
	iters: 500, epoch: 1 | loss: 0.3626256
	speed: 0.0170s/iter; left time: 133.3647s
	iters: 600, epoch: 1 | loss: 0.5606291
	speed: 0.0176s/iter; left time: 136.7438s
	iters: 700, epoch: 1 | loss: 0.4278996
	speed: 0.0124s/iter; left time: 94.6338s
	iters: 800, epoch: 1 | loss: 0.7287169
	speed: 0.0126s/iter; left time: 95.4640s
	iters: 900, epoch: 1 | loss: 0.5145950
	speed: 0.0123s/iter; left time: 92.1385s
	iters: 1000, epoch: 1 | loss: 0.2523944
	speed: 0.0143s/iter; left time: 105.2061s
Updating learning rate to 0.0011086116092
Validation loss decreased (inf --> 0.3210).  Saving model state dict ...
Epoch: 1 cost time: 16.545765161514282
Epoch: 1, Steps: 1045 | Train Loss: 0.4871188 Vali Loss: 0.3209901 Best vali loss: 0.3209901
	iters: 100, epoch: 2 | loss: 0.6320842
	speed: 0.0403s/iter; left time: 290.8097s
	iters: 200, epoch: 2 | loss: 0.7235402
	speed: 0.0092s/iter; left time: 65.1698s
	iters: 300, epoch: 2 | loss: 0.5752006
	speed: 0.0089s/iter; left time: 62.3128s
	iters: 400, epoch: 2 | loss: 0.5934251
	speed: 0.0124s/iter; left time: 85.5928s
	iters: 500, epoch: 2 | loss: 0.7708533
	speed: 0.0119s/iter; left time: 81.2232s
	iters: 600, epoch: 2 | loss: 0.3288726
	speed: 0.0114s/iter; left time: 76.7137s
	iters: 700, epoch: 2 | loss: 2.0893850
	speed: 0.0121s/iter; left time: 80.3151s
	iters: 800, epoch: 2 | loss: 0.2379403
	speed: 0.0095s/iter; left time: 61.8885s
	iters: 900, epoch: 2 | loss: 0.2522309
	speed: 0.0081s/iter; left time: 52.2857s
	iters: 1000, epoch: 2 | loss: 0.3006577
	speed: 0.0144s/iter; left time: 90.7265s
Updating learning rate to 0.0005543058046
Validation loss decreased (0.3210 --> 0.3201).  Saving model state dict ...
Epoch: 2 cost time: 11.554096698760986
Epoch: 2, Steps: 1045 | Train Loss: 0.6504190 Vali Loss: 0.3201128 Best vali loss: 0.3201128
	iters: 100, epoch: 3 | loss: 1.3633063
	speed: 0.0408s/iter; left time: 251.5143s
	iters: 200, epoch: 3 | loss: 0.2385933
	speed: 0.0105s/iter; left time: 63.5215s
	iters: 300, epoch: 3 | loss: 0.3925445
	speed: 0.0143s/iter; left time: 85.2501s
	iters: 400, epoch: 3 | loss: 0.6806839
	speed: 0.0115s/iter; left time: 67.7827s
	iters: 500, epoch: 3 | loss: 0.8892212
	speed: 0.0121s/iter; left time: 69.9997s
	iters: 600, epoch: 3 | loss: 0.5460222
	speed: 0.0146s/iter; left time: 82.8479s
	iters: 700, epoch: 3 | loss: 0.6868059
	speed: 0.0137s/iter; left time: 76.3495s
	iters: 800, epoch: 3 | loss: 0.2612591
	speed: 0.0132s/iter; left time: 72.0537s
	iters: 900, epoch: 3 | loss: 0.8695791
	speed: 0.0128s/iter; left time: 68.5886s
	iters: 1000, epoch: 3 | loss: 0.1669309
	speed: 0.0080s/iter; left time: 42.1816s
Updating learning rate to 0.0002771529023
Epoch: 3 cost time: 12.644353866577148
Epoch: 3, Steps: 1045 | Train Loss: 0.6094946 Vali Loss: 0.3238759 Best vali loss: 0.3201128

best validation loss 0.32011282517148376

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0080024783013, 'e_layers': 1, 'learning_rate': 0.0001635952265, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7703339
	speed: 0.0115s/iter; left time: 46.9319s
	iters: 200, epoch: 1 | loss: 1.0231816
	speed: 0.0044s/iter; left time: 17.4036s
	iters: 300, epoch: 1 | loss: 0.6755049
	speed: 0.0037s/iter; left time: 14.4520s
	iters: 400, epoch: 1 | loss: 0.3068749
	speed: 0.0040s/iter; left time: 15.2140s
	iters: 500, epoch: 1 | loss: 0.6299824
	speed: 0.0055s/iter; left time: 20.2180s
Updating learning rate to 0.0001635952265
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 2.761760950088501
Epoch: 1, Steps: 523 | Train Loss: 0.6811755 Vali Loss: 0.2873970 Best vali loss: 0.2873970
	iters: 100, epoch: 2 | loss: 0.5413071
	speed: 0.0145s/iter; left time: 51.4811s
	iters: 200, epoch: 2 | loss: 0.3953232
	speed: 0.0062s/iter; left time: 21.5770s
	iters: 300, epoch: 2 | loss: 0.7418241
	speed: 0.0052s/iter; left time: 17.4955s
	iters: 400, epoch: 2 | loss: 0.2455981
	speed: 0.0055s/iter; left time: 18.0896s
	iters: 500, epoch: 2 | loss: 0.7844512
	speed: 0.0056s/iter; left time: 17.8403s
Updating learning rate to 8.179761325e-05
Validation loss decreased (0.2874 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 3.019116163253784
Epoch: 2, Steps: 523 | Train Loss: 0.5417008 Vali Loss: 0.2830394 Best vali loss: 0.2830394
	iters: 100, epoch: 3 | loss: 0.4794402
	speed: 0.0133s/iter; left time: 40.5354s
	iters: 200, epoch: 3 | loss: 0.4905029
	speed: 0.0052s/iter; left time: 15.2001s
	iters: 300, epoch: 3 | loss: 0.2122195
	speed: 0.0040s/iter; left time: 11.4398s
	iters: 400, epoch: 3 | loss: 0.7068306
	speed: 0.0037s/iter; left time: 10.0762s
	iters: 500, epoch: 3 | loss: 0.3750535
	speed: 0.0040s/iter; left time: 10.4415s
Updating learning rate to 4.0898806625e-05
Validation loss decreased (0.2830 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 2.426560163497925
Epoch: 3, Steps: 523 | Train Loss: 0.4528093 Vali Loss: 0.2823242 Best vali loss: 0.2823242

best validation loss 0.2823241829827799

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0013811676972, 'e_layers': 2, 'learning_rate': 0.000142989533, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7125177
	speed: 0.0132s/iter; left time: 53.9840s
	iters: 200, epoch: 1 | loss: 0.5071443
	speed: 0.0070s/iter; left time: 28.0422s
	iters: 300, epoch: 1 | loss: 0.3629779
	speed: 0.0067s/iter; left time: 26.1174s
	iters: 400, epoch: 1 | loss: 0.5795326
	speed: 0.0051s/iter; left time: 19.3503s
	iters: 500, epoch: 1 | loss: 0.2873030
	speed: 0.0056s/iter; left time: 20.6848s
Updating learning rate to 0.0001375473179510236
Validation loss decreased (inf --> 0.3035).  Saving model state dict ...
Epoch: 1 cost time: 3.588731527328491
Epoch: 1, Steps: 523 | Train Loss: 0.4898951 Vali Loss: 0.3034567 Best vali loss: 0.3034567
	iters: 100, epoch: 2 | loss: 0.7966159
	speed: 0.0161s/iter; left time: 57.4385s
	iters: 200, epoch: 2 | loss: 0.4009621
	speed: 0.0072s/iter; left time: 24.7899s
	iters: 300, epoch: 2 | loss: 0.3899254
	speed: 0.0073s/iter; left time: 24.4295s
	iters: 400, epoch: 2 | loss: 0.7308893
	speed: 0.0073s/iter; left time: 23.7109s
	iters: 500, epoch: 2 | loss: 0.8051389
	speed: 0.0072s/iter; left time: 22.8473s
Updating learning rate to 0.00012204920071149881
Validation loss decreased (0.3035 --> 0.2897).  Saving model state dict ...
Epoch: 2 cost time: 3.824235439300537
Epoch: 2, Steps: 523 | Train Loss: 0.6247063 Vali Loss: 0.2897185 Best vali loss: 0.2897185
	iters: 100, epoch: 3 | loss: 0.6948404
	speed: 0.0158s/iter; left time: 48.1510s
	iters: 200, epoch: 3 | loss: 0.4604693
	speed: 0.0048s/iter; left time: 14.0189s
	iters: 300, epoch: 3 | loss: 0.3126742
	speed: 0.0059s/iter; left time: 16.7779s
	iters: 400, epoch: 3 | loss: 0.4282343
	speed: 0.0065s/iter; left time: 17.8393s
	iters: 500, epoch: 3 | loss: 0.2992828
	speed: 0.0072s/iter; left time: 18.9895s
Updating learning rate to 9.885462914036064e-05
Validation loss decreased (0.2897 --> 0.2844).  Saving model state dict ...
Epoch: 3 cost time: 3.2658050060272217
Epoch: 3, Steps: 523 | Train Loss: 0.4391002 Vali Loss: 0.2844093 Best vali loss: 0.2844093

best validation loss 0.28440928116701225

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0080024783013, 'e_layers': 1, 'learning_rate': 0.0001635952265, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6755844
	speed: 0.0124s/iter; left time: 31.1894s
	iters: 200, epoch: 4 | loss: 0.8773859
	speed: 0.0047s/iter; left time: 11.3160s
	iters: 300, epoch: 4 | loss: 0.6564382
	speed: 0.0050s/iter; left time: 11.6048s
	iters: 400, epoch: 4 | loss: 0.2968784
	speed: 0.0050s/iter; left time: 11.1798s
	iters: 500, epoch: 4 | loss: 0.5959390
	speed: 0.0051s/iter; left time: 10.7968s
Updating learning rate to 2.04494033125e-05
Validation loss decreased (0.2823 --> 0.2823).  Saving model state dict ...
Epoch: 4 cost time: 2.9458181858062744
Epoch: 4, Steps: 523 | Train Loss: 0.6204452 Vali Loss: 0.2822753 Best vali loss: 0.2822753
	iters: 100, epoch: 5 | loss: 0.5432341
	speed: 0.0145s/iter; left time: 28.8103s
	iters: 200, epoch: 5 | loss: 0.4189237
	speed: 0.0048s/iter; left time: 9.1808s
	iters: 300, epoch: 5 | loss: 0.7365807
	speed: 0.0047s/iter; left time: 8.4160s
	iters: 400, epoch: 5 | loss: 0.2427151
	speed: 0.0048s/iter; left time: 8.1468s
	iters: 500, epoch: 5 | loss: 0.7284817
	speed: 0.0046s/iter; left time: 7.3653s
Updating learning rate to 1.022470165625e-05
Epoch: 5 cost time: 2.554147720336914
Epoch: 5, Steps: 523 | Train Loss: 0.5339871 Vali Loss: 0.2823292 Best vali loss: 0.2822753
	iters: 100, epoch: 6 | loss: 0.4848733
	speed: 0.0133s/iter; left time: 19.6149s
	iters: 200, epoch: 6 | loss: 0.4686389
	speed: 0.0053s/iter; left time: 7.2007s
	iters: 300, epoch: 6 | loss: 0.2184976
	speed: 0.0050s/iter; left time: 6.3896s
	iters: 400, epoch: 6 | loss: 0.6965368
	speed: 0.0052s/iter; left time: 6.0514s
	iters: 500, epoch: 6 | loss: 0.3756991
	speed: 0.0051s/iter; left time: 5.4760s
Updating learning rate to 5.112350828125e-06
Validation loss decreased (0.2823 --> 0.2822).  Saving model state dict ...
Epoch: 6 cost time: 2.7189433574676514
Epoch: 6, Steps: 523 | Train Loss: 0.4488491 Vali Loss: 0.2822206 Best vali loss: 0.2822206
	iters: 100, epoch: 7 | loss: 0.4367340
	speed: 0.0139s/iter; left time: 13.1964s
	iters: 200, epoch: 7 | loss: 0.4484391
	speed: 0.0047s/iter; left time: 3.9826s
	iters: 300, epoch: 7 | loss: 0.2858971
	speed: 0.0042s/iter; left time: 3.1409s
	iters: 400, epoch: 7 | loss: 0.3852075
	speed: 0.0037s/iter; left time: 2.3753s
	iters: 500, epoch: 7 | loss: 0.9887012
	speed: 0.0038s/iter; left time: 2.1049s
Updating learning rate to 2.5561754140625e-06
Validation loss decreased (0.2822 --> 0.2821).  Saving model state dict ...
Epoch: 7 cost time: 2.253194570541382
Epoch: 7, Steps: 523 | Train Loss: 0.5089958 Vali Loss: 0.2821252 Best vali loss: 0.2821252
	iters: 100, epoch: 8 | loss: 0.5999790
	speed: 0.0124s/iter; left time: 5.2673s
	iters: 200, epoch: 8 | loss: 0.5780694
	speed: 0.0048s/iter; left time: 1.5553s
	iters: 300, epoch: 8 | loss: 0.6054348
	speed: 0.0049s/iter; left time: 1.1032s
	iters: 400, epoch: 8 | loss: 0.6709022
	speed: 0.0053s/iter; left time: 0.6574s
	iters: 500, epoch: 8 | loss: 0.3472083
	speed: 0.0052s/iter; left time: 0.1246s
Updating learning rate to 1.27808770703125e-06
Validation loss decreased (0.2821 --> 0.2821).  Saving model state dict ...
Epoch: 8 cost time: 2.6798086166381836
Epoch: 8, Steps: 523 | Train Loss: 0.5603187 Vali Loss: 0.2821212 Best vali loss: 0.2821212

best validation loss 0.2821211557975264

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0104119650236, 'e_layers': 4, 'learning_rate': 0.0007615920846, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8570021
	speed: 0.0177s/iter; left time: 35.3480s
	iters: 200, epoch: 1 | loss: 0.6272777
	speed: 0.0109s/iter; left time: 20.6702s
Updating learning rate to 0.0007615920846
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 3.183410167694092
Epoch: 1, Steps: 262 | Train Loss: 0.7421399 Vali Loss: 0.2876543 Best vali loss: 0.2876543
	iters: 100, epoch: 2 | loss: 0.4167376
	speed: 0.0215s/iter; left time: 37.3764s
	iters: 200, epoch: 2 | loss: 0.6525745
	speed: 0.0102s/iter; left time: 16.7537s
Updating learning rate to 0.0003807960423
Epoch: 2 cost time: 3.012812614440918
Epoch: 2, Steps: 262 | Train Loss: 0.5346561 Vali Loss: 0.2925348 Best vali loss: 0.2876543
	iters: 100, epoch: 3 | loss: 0.6280102
	speed: 0.0330s/iter; left time: 48.5453s
	iters: 200, epoch: 3 | loss: 0.4558007
	speed: 0.0121s/iter; left time: 16.6358s
Updating learning rate to 0.00019039802115
Validation loss decreased (0.2877 --> 0.2869).  Saving model state dict ...
Epoch: 3 cost time: 3.0713253021240234
Epoch: 3, Steps: 262 | Train Loss: 0.5419054 Vali Loss: 0.2869462 Best vali loss: 0.2869462
	iters: 100, epoch: 4 | loss: 0.1953575
	speed: 0.0217s/iter; left time: 26.3391s
	iters: 200, epoch: 4 | loss: 0.2649478
	speed: 0.0111s/iter; left time: 12.3205s
Updating learning rate to 9.5199010575e-05
Epoch: 4 cost time: 2.85148024559021
Epoch: 4, Steps: 262 | Train Loss: 0.2301526 Vali Loss: 0.2879593 Best vali loss: 0.2869462
	iters: 100, epoch: 5 | loss: 0.3689600
	speed: 0.0227s/iter; left time: 21.5477s
	iters: 200, epoch: 5 | loss: 0.2749032
	speed: 0.0108s/iter; left time: 9.1505s
Updating learning rate to 4.75995052875e-05
Epoch: 5 cost time: 2.841728925704956
Epoch: 5, Steps: 262 | Train Loss: 0.3219316 Vali Loss: 0.2918016 Best vali loss: 0.2869462
	iters: 100, epoch: 6 | loss: 0.4015862
	speed: 0.0223s/iter; left time: 15.2861s
	iters: 200, epoch: 6 | loss: 0.3270442
	speed: 0.0107s/iter; left time: 6.2574s
Updating learning rate to 2.379975264375e-05
Epoch: 6 cost time: 2.7656972408294678
Epoch: 6, Steps: 262 | Train Loss: 0.3643152 Vali Loss: 0.2947634 Best vali loss: 0.2869462
	iters: 100, epoch: 7 | loss: 0.5941276
	speed: 0.0223s/iter; left time: 9.4821s
	iters: 200, epoch: 7 | loss: 0.5028116
	speed: 0.0102s/iter; left time: 3.3251s
Updating learning rate to 1.1899876321875e-05
Epoch: 7 cost time: 2.751924514770508
Epoch: 7, Steps: 262 | Train Loss: 0.5484696 Vali Loss: 0.2956123 Best vali loss: 0.2869462
	iters: 100, epoch: 8 | loss: 0.3221456
	speed: 0.0217s/iter; left time: 3.5427s
	iters: 200, epoch: 8 | loss: 0.3269362
	speed: 0.0078s/iter; left time: 0.4911s
Updating learning rate to 5.9499381609375e-06
Epoch: 8 cost time: 2.357732057571411
Epoch: 8, Steps: 262 | Train Loss: 0.3245409 Vali Loss: 0.2954510 Best vali loss: 0.2869462

best validation loss 0.28694621445566093

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0009120181741, 'e_layers': 1, 'learning_rate': 0.0007532995019, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007246287467781785
Validation loss decreased (inf --> 0.2958).  Saving model state dict ...
Epoch: 1 cost time: 0.8409566879272461
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2958206 Best vali loss: 0.2958206
Updating learning rate to 0.0006429813439789693
Validation loss decreased (0.2958 --> 0.2849).  Saving model state dict ...
Epoch: 2 cost time: 0.553229808807373
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2849440 Best vali loss: 0.2849440
Updating learning rate to 0.0005207873704430022
Validation loss decreased (0.2849 --> 0.2822).  Saving model state dict ...
Epoch: 3 cost time: 0.6868698596954346
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2821665 Best vali loss: 0.2821665
Updating learning rate to 0.00037664975095
Epoch: 4 cost time: 0.5464050769805908
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2824639 Best vali loss: 0.2821665
Updating learning rate to 0.00023251213145699778
Epoch: 5 cost time: 0.5423142910003662
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2825779 Best vali loss: 0.2821665
Updating learning rate to 0.00011031815792103075
Epoch: 6 cost time: 0.5125997066497803
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2836710 Best vali loss: 0.2821665
Updating learning rate to 2.867075512182142e-05
Epoch: 7 cost time: 1.296929121017456
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2841164 Best vali loss: 0.2821665
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2540488243103027
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2840267 Best vali loss: 0.2821665

best validation loss 0.2821664772858492

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.001571630337, 'e_layers': 3, 'learning_rate': 0.0007810564457, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3784408
	speed: 0.0138s/iter; left time: 56.5519s
	iters: 200, epoch: 1 | loss: 0.2544827
	speed: 0.0061s/iter; left time: 24.2452s
	iters: 300, epoch: 1 | loss: 0.4115998
	speed: 0.0087s/iter; left time: 33.7572s
	iters: 400, epoch: 1 | loss: 0.6233716
	speed: 0.0091s/iter; left time: 34.5371s
	iters: 500, epoch: 1 | loss: 0.8368652
	speed: 0.0085s/iter; left time: 31.4923s
Updating learning rate to 0.0007513292548091216
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 4.475675344467163
Epoch: 1, Steps: 523 | Train Loss: 0.5009520 Vali Loss: 0.2877003 Best vali loss: 0.2877003
	iters: 100, epoch: 2 | loss: 0.4042363
	speed: 0.0193s/iter; left time: 68.6360s
	iters: 200, epoch: 2 | loss: 0.8245156
	speed: 0.0078s/iter; left time: 27.0594s
	iters: 300, epoch: 2 | loss: 0.3966443
	speed: 0.0073s/iter; left time: 24.6788s
	iters: 400, epoch: 2 | loss: 0.5215048
	speed: 0.0093s/iter; left time: 30.4612s
	iters: 500, epoch: 2 | loss: 0.6762361
	speed: 0.0094s/iter; left time: 29.7219s
Updating learning rate to 0.0006666733774719662
Validation loss decreased (0.2877 --> 0.2846).  Saving model state dict ...
Epoch: 2 cost time: 4.581543922424316
Epoch: 2, Steps: 523 | Train Loss: 0.5646274 Vali Loss: 0.2846335 Best vali loss: 0.2846335
	iters: 100, epoch: 3 | loss: 0.5101161
	speed: 0.0188s/iter; left time: 57.1983s
	iters: 200, epoch: 3 | loss: 0.4797893
	speed: 0.0085s/iter; left time: 25.1056s
	iters: 300, epoch: 3 | loss: 0.2126111
	speed: 0.0066s/iter; left time: 18.6227s
	iters: 400, epoch: 3 | loss: 0.2528455
	speed: 0.0073s/iter; left time: 20.0082s
	iters: 500, epoch: 3 | loss: 0.3858725
	speed: 0.0093s/iter; left time: 24.4654s
Updating learning rate to 0.0005399769036056768
Epoch: 3 cost time: 4.349061489105225
Epoch: 3, Steps: 523 | Train Loss: 0.3682469 Vali Loss: 0.2877326 Best vali loss: 0.2846335

best validation loss 0.2846335169355991

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0109973241365, 'e_layers': 2, 'learning_rate': 0.0006354986796, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3721785
	speed: 0.0169s/iter; left time: 33.7183s
	iters: 200, epoch: 1 | loss: 0.3958827
	speed: 0.0092s/iter; left time: 17.3697s
Updating learning rate to 0.0006113114513101941
Validation loss decreased (inf --> 0.2827).  Saving model state dict ...
Epoch: 1 cost time: 2.896575927734375
Epoch: 1, Steps: 262 | Train Loss: 0.3840306 Vali Loss: 0.2827325 Best vali loss: 0.2827325
	iters: 100, epoch: 2 | loss: 0.4169015
	speed: 0.0319s/iter; left time: 55.3410s
	iters: 200, epoch: 2 | loss: 1.1097251
	speed: 0.0089s/iter; left time: 14.4840s
Updating learning rate to 0.0005424320526901285
Epoch: 2 cost time: 2.2227699756622314
Epoch: 2, Steps: 262 | Train Loss: 0.7633133 Vali Loss: 0.2849131 Best vali loss: 0.2827325
	iters: 100, epoch: 3 | loss: 0.7033011
	speed: 0.0300s/iter; left time: 44.2528s
	iters: 200, epoch: 3 | loss: 0.3254883
	speed: 0.0099s/iter; left time: 13.5765s
Updating learning rate to 0.0004393467477864053
Epoch: 3 cost time: 2.717350721359253
Epoch: 3, Steps: 262 | Train Loss: 0.5143947 Vali Loss: 0.2963713 Best vali loss: 0.2827325

best validation loss 0.2827324728932067

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014995661411, 'e_layers': 1, 'learning_rate': 0.0016681738312, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8469856
	speed: 0.0240s/iter; left time: 22.8030s
Updating learning rate to 0.001604682745258309
Validation loss decreased (inf --> 0.2921).  Saving model state dict ...
Epoch: 1 cost time: 2.5812907218933105
Epoch: 1, Steps: 131 | Train Loss: 0.8469856 Vali Loss: 0.2920779 Best vali loss: 0.2920779
	iters: 100, epoch: 2 | loss: 0.3339264
	speed: 0.0304s/iter; left time: 24.8313s
Updating learning rate to 0.0014238754297197314
Epoch: 2 cost time: 2.26200795173645
Epoch: 2, Steps: 131 | Train Loss: 0.3339264 Vali Loss: 0.3130015 Best vali loss: 0.2920779
	iters: 100, epoch: 3 | loss: 0.4977038
	speed: 0.0287s/iter; left time: 19.7486s
Updating learning rate to 0.001153278159352619
Epoch: 3 cost time: 2.3344295024871826
Epoch: 3, Steps: 131 | Train Loss: 0.4977038 Vali Loss: 0.3048644 Best vali loss: 0.2920779

best validation loss 0.2920779180198675

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0109973241365, 'e_layers': 2, 'learning_rate': 0.0006354986796, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3466364
	speed: 0.0183s/iter; left time: 22.1933s
	iters: 200, epoch: 4 | loss: 0.3428665
	speed: 0.0100s/iter; left time: 11.1238s
Updating learning rate to 0.0003177493398
Epoch: 4 cost time: 3.2595155239105225
Epoch: 4, Steps: 262 | Train Loss: 0.3447515 Vali Loss: 0.2946736 Best vali loss: 0.2827325
	iters: 100, epoch: 5 | loss: 0.3849421
	speed: 0.0267s/iter; left time: 25.3420s
	iters: 200, epoch: 5 | loss: 0.9554620
	speed: 0.0091s/iter; left time: 7.7464s
Updating learning rate to 0.0001961519318135948
Epoch: 5 cost time: 2.4902076721191406
Epoch: 5, Steps: 262 | Train Loss: 0.6702020 Vali Loss: 0.2958875 Best vali loss: 0.2827325
	iters: 100, epoch: 6 | loss: 0.6126707
	speed: 0.0249s/iter; left time: 17.1074s
	iters: 200, epoch: 6 | loss: 0.3212881
	speed: 0.0080s/iter; left time: 4.6822s
Updating learning rate to 9.306662690987149e-05
Epoch: 6 cost time: 2.4272212982177734
Epoch: 6, Steps: 262 | Train Loss: 0.4669794 Vali Loss: 0.3021709 Best vali loss: 0.2827325
	iters: 100, epoch: 7 | loss: 0.5200149
	speed: 0.0244s/iter; left time: 10.3909s
	iters: 200, epoch: 7 | loss: 0.3556578
	speed: 0.0087s/iter; left time: 2.8387s
Updating learning rate to 2.4187228289806005e-05
Epoch: 7 cost time: 2.288083076477051
Epoch: 7, Steps: 262 | Train Loss: 0.4378364 Vali Loss: 0.2981331 Best vali loss: 0.2827325
	iters: 100, epoch: 8 | loss: 0.4720403
	speed: 0.0220s/iter; left time: 3.5827s
	iters: 200, epoch: 8 | loss: 0.5163603
	speed: 0.0083s/iter; left time: 0.5240s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2852158546447754
Epoch: 8, Steps: 262 | Train Loss: 0.4942003 Vali Loss: 0.2996157 Best vali loss: 0.2827325

best validation loss 0.2827324728932067

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6915714
	speed: 0.0193s/iter; left time: 18.3115s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 1.9596176147460938
Epoch: 1, Steps: 131 | Train Loss: 0.6915714 Vali Loss: 0.3218369 Best vali loss: 0.3218369
	iters: 100, epoch: 2 | loss: 0.4748999
	speed: 0.0262s/iter; left time: 21.4042s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.3218 --> 0.3050).  Saving model state dict ...
Epoch: 2 cost time: 2.468810796737671
Epoch: 2, Steps: 131 | Train Loss: 0.4748999 Vali Loss: 0.3050303 Best vali loss: 0.3050303
	iters: 100, epoch: 3 | loss: 0.6866489
	speed: 0.0267s/iter; left time: 18.3118s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.3050 --> 0.2987).  Saving model state dict ...
Epoch: 3 cost time: 2.230198621749878
Epoch: 3, Steps: 131 | Train Loss: 0.6866489 Vali Loss: 0.2987203 Best vali loss: 0.2987203
	iters: 100, epoch: 4 | loss: 0.4876589
	speed: 0.0253s/iter; left time: 14.0848s
Updating learning rate to 7.5835271e-05
Validation loss decreased (0.2987 --> 0.2925).  Saving model state dict ...
Epoch: 4 cost time: 1.602710247039795
Epoch: 4, Steps: 131 | Train Loss: 0.4876589 Vali Loss: 0.2925282 Best vali loss: 0.2925282
	iters: 100, epoch: 5 | loss: 0.4878523
	speed: 0.0194s/iter; left time: 8.2570s
Updating learning rate to 4.681436919938325e-05
Validation loss decreased (0.2925 --> 0.2906).  Saving model state dict ...
Epoch: 5 cost time: 1.5842769145965576
Epoch: 5, Steps: 131 | Train Loss: 0.4878523 Vali Loss: 0.2905559 Best vali loss: 0.2905559
	iters: 100, epoch: 6 | loss: 0.5823268
	speed: 0.0198s/iter; left time: 5.8348s
Updating learning rate to 2.221163662278047e-05
Validation loss decreased (0.2906 --> 0.2894).  Saving model state dict ...
Epoch: 6 cost time: 1.600174903869629
Epoch: 6, Steps: 131 | Train Loss: 0.5823268 Vali Loss: 0.2893925 Best vali loss: 0.2893925
	iters: 100, epoch: 7 | loss: 0.3161128
	speed: 0.0274s/iter; left time: 4.4610s
Updating learning rate to 5.772616280653259e-06
Validation loss decreased (0.2894 --> 0.2885).  Saving model state dict ...
Epoch: 7 cost time: 1.9007575511932373
Epoch: 7, Steps: 131 | Train Loss: 0.3161128 Vali Loss: 0.2885079 Best vali loss: 0.2885079
	iters: 100, epoch: 8 | loss: 0.7024677
	speed: 0.0261s/iter; left time: 0.8349s
Updating learning rate to 0.0
Validation loss decreased (0.2885 --> 0.2883).  Saving model state dict ...
Epoch: 8 cost time: 2.374591588973999
Epoch: 8, Steps: 131 | Train Loss: 0.7024677 Vali Loss: 0.2882879 Best vali loss: 0.2882879

best validation loss 0.28828788678102574

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0075105832011, 'e_layers': 3, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.3356).  Saving model state dict ...
Epoch: 1 cost time: 1.2316415309906006
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3356469 Best vali loss: 0.3356469
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.3356 --> 0.3178).  Saving model state dict ...
Epoch: 2 cost time: 0.9665837287902832
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3177782 Best vali loss: 0.3177782
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.3178 --> 0.3113).  Saving model state dict ...
Epoch: 3 cost time: 0.9824428558349609
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3112985 Best vali loss: 0.3112985
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.3113 --> 0.3085).  Saving model state dict ...
Epoch: 4 cost time: 1.8094666004180908
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3084569 Best vali loss: 0.3084569
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.3085 --> 0.3071).  Saving model state dict ...
Epoch: 5 cost time: 2.297253370285034
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3070857 Best vali loss: 0.3070857
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.3071 --> 0.3065).  Saving model state dict ...
Epoch: 6 cost time: 2.914579391479492
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3064538 Best vali loss: 0.3064538
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.3065 --> 0.3061).  Saving model state dict ...
Epoch: 7 cost time: 2.6332929134368896
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3061393 Best vali loss: 0.3061393
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.3061 --> 0.3060).  Saving model state dict ...
Epoch: 8 cost time: 1.2735273838043213
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3059742 Best vali loss: 0.3059742

best validation loss 0.30597415919993703

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0019553644268, 'e_layers': 3, 'learning_rate': 0.0004248360226, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4695513
	speed: 0.0178s/iter; left time: 35.4519s
	iters: 200, epoch: 1 | loss: 0.6159477
	speed: 0.0109s/iter; left time: 20.6002s
Updating learning rate to 0.00040866666427682123
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 3.208265781402588
Epoch: 1, Steps: 262 | Train Loss: 0.5427495 Vali Loss: 0.2835659 Best vali loss: 0.2835659
	iters: 100, epoch: 2 | loss: 1.3749763
	speed: 0.0288s/iter; left time: 50.0085s
	iters: 200, epoch: 2 | loss: 0.3598563
	speed: 0.0107s/iter; left time: 17.4743s
Updating learning rate to 0.0003626202275363907
Validation loss decreased (0.2836 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 2.7934470176696777
Epoch: 2, Steps: 262 | Train Loss: 0.8674163 Vali Loss: 0.2828690 Best vali loss: 0.2828690
	iters: 100, epoch: 3 | loss: 0.4225743
	speed: 0.0213s/iter; left time: 31.3137s
	iters: 200, epoch: 3 | loss: 0.4849202
	speed: 0.0096s/iter; left time: 13.2416s
Updating learning rate to 0.00029370686496045046
Epoch: 3 cost time: 2.5142173767089844
Epoch: 3, Steps: 262 | Train Loss: 0.4537473 Vali Loss: 0.3055472 Best vali loss: 0.2828690

best validation loss 0.282869034651466

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.005039284044, 'e_layers': 4, 'learning_rate': 0.0005123298181, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3943627
	speed: 0.0168s/iter; left time: 68.6999s
	iters: 200, epoch: 1 | loss: 0.4550783
	speed: 0.0086s/iter; left time: 34.2308s
	iters: 300, epoch: 1 | loss: 0.5110762
	speed: 0.0092s/iter; left time: 35.6703s
	iters: 400, epoch: 1 | loss: 0.5506725
	speed: 0.0096s/iter; left time: 36.5211s
	iters: 500, epoch: 1 | loss: 0.3013551
	speed: 0.0092s/iter; left time: 33.9219s
Updating learning rate to 0.0005123298181
Validation loss decreased (inf --> 0.2911).  Saving model state dict ...
Epoch: 1 cost time: 5.227766275405884
Epoch: 1, Steps: 523 | Train Loss: 0.4425089 Vali Loss: 0.2911159 Best vali loss: 0.2911159
	iters: 100, epoch: 2 | loss: 0.4534132
	speed: 0.0178s/iter; left time: 63.4461s
	iters: 200, epoch: 2 | loss: 0.4011719
	speed: 0.0094s/iter; left time: 32.6062s
	iters: 300, epoch: 2 | loss: 0.3272700
	speed: 0.0071s/iter; left time: 24.0191s
	iters: 400, epoch: 2 | loss: 0.3518642
	speed: 0.0098s/iter; left time: 32.0931s
	iters: 500, epoch: 2 | loss: 0.2608354
	speed: 0.0097s/iter; left time: 30.6401s
Updating learning rate to 0.00025616490905
Validation loss decreased (0.2911 --> 0.2905).  Saving model state dict ...
Epoch: 2 cost time: 4.678386449813843
Epoch: 2, Steps: 523 | Train Loss: 0.3589109 Vali Loss: 0.2905173 Best vali loss: 0.2905173
	iters: 100, epoch: 3 | loss: 0.2850774
	speed: 0.0207s/iter; left time: 62.8585s
	iters: 200, epoch: 3 | loss: 0.4424286
	speed: 0.0093s/iter; left time: 27.2072s
	iters: 300, epoch: 3 | loss: 0.3651179
	speed: 0.0101s/iter; left time: 28.5345s
	iters: 400, epoch: 3 | loss: 0.4615398
	speed: 0.0105s/iter; left time: 28.7934s
	iters: 500, epoch: 3 | loss: 0.7408986
	speed: 0.0115s/iter; left time: 30.2226s
Updating learning rate to 0.000128082454525
Validation loss decreased (0.2905 --> 0.2834).  Saving model state dict ...
Epoch: 3 cost time: 5.382295370101929
Epoch: 3, Steps: 523 | Train Loss: 0.4590125 Vali Loss: 0.2833575 Best vali loss: 0.2833575

best validation loss 0.28335752520210106

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0009527381041, 'e_layers': 3, 'learning_rate': 0.0001210783862, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3812245
	speed: 0.0213s/iter; left time: 42.4690s
	iters: 200, epoch: 1 | loss: 0.4891274
	speed: 0.0147s/iter; left time: 27.8066s
Updating learning rate to 0.0001164701145198385
Validation loss decreased (inf --> 0.3167).  Saving model state dict ...
Epoch: 1 cost time: 4.0997889041900635
Epoch: 1, Steps: 262 | Train Loss: 0.4351760 Vali Loss: 0.3166713 Best vali loss: 0.3166713
	iters: 100, epoch: 2 | loss: 0.3122259
	speed: 0.0528s/iter; left time: 91.5216s
	iters: 200, epoch: 2 | loss: 0.3198680
	speed: 0.0136s/iter; left time: 22.2707s
Updating learning rate to 0.00010334686706857184
Validation loss decreased (0.3167 --> 0.2998).  Saving model state dict ...
Epoch: 2 cost time: 3.775408983230591
Epoch: 2, Steps: 262 | Train Loss: 0.3160470 Vali Loss: 0.2998369 Best vali loss: 0.2998369
	iters: 100, epoch: 3 | loss: 0.7362810
	speed: 0.0477s/iter; left time: 70.2164s
	iters: 200, epoch: 3 | loss: 0.2916817
	speed: 0.0136s/iter; left time: 18.6843s
Updating learning rate to 8.370653930812096e-05
Validation loss decreased (0.2998 --> 0.2927).  Saving model state dict ...
Epoch: 3 cost time: 3.826338529586792
Epoch: 3, Steps: 262 | Train Loss: 0.5139813 Vali Loss: 0.2927312 Best vali loss: 0.2927312

best validation loss 0.29273121726417595

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0019553644268, 'e_layers': 3, 'learning_rate': 0.0004248360226, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4454523
	speed: 0.0185s/iter; left time: 22.4076s
	iters: 200, epoch: 4 | loss: 0.5449791
	speed: 0.0113s/iter; left time: 12.5232s
Updating learning rate to 0.0002124180113
Epoch: 4 cost time: 3.270425796508789
Epoch: 4, Steps: 262 | Train Loss: 0.4952157 Vali Loss: 0.2882249 Best vali loss: 0.2828690
	iters: 100, epoch: 5 | loss: 0.9829389
	speed: 0.0319s/iter; left time: 30.2610s
	iters: 200, epoch: 5 | loss: 0.3111344
	speed: 0.0123s/iter; left time: 10.4043s
Updating learning rate to 0.0001311291576395496
Epoch: 5 cost time: 3.360964298248291
Epoch: 5, Steps: 262 | Train Loss: 0.6470367 Vali Loss: 0.2833508 Best vali loss: 0.2828690
	iters: 100, epoch: 6 | loss: 0.3871637
	speed: 0.0275s/iter; left time: 18.8945s
	iters: 200, epoch: 6 | loss: 0.4026365
	speed: 0.0115s/iter; left time: 6.7286s
Updating learning rate to 6.221579506360934e-05
Epoch: 6 cost time: 3.01979923248291
Epoch: 6, Steps: 262 | Train Loss: 0.3949001 Vali Loss: 0.2897693 Best vali loss: 0.2828690
	iters: 100, epoch: 7 | loss: 0.3428565
	speed: 0.0252s/iter; left time: 10.7062s
	iters: 200, epoch: 7 | loss: 0.3667027
	speed: 0.0089s/iter; left time: 2.8812s
Updating learning rate to 1.6169358323178777e-05
Epoch: 7 cost time: 2.5330288410186768
Epoch: 7, Steps: 262 | Train Loss: 0.3547796 Vali Loss: 0.2909737 Best vali loss: 0.2828690
	iters: 100, epoch: 8 | loss: 0.3407561
	speed: 0.0207s/iter; left time: 3.3818s
	iters: 200, epoch: 8 | loss: 0.3355134
	speed: 0.0098s/iter; left time: 0.6154s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.604973077774048
Epoch: 8, Steps: 262 | Train Loss: 0.3381347 Vali Loss: 0.2895057 Best vali loss: 0.2828690

best validation loss 0.282869034651466

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0021855098256, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7083009
	speed: 0.0148s/iter; left time: 14.0354s
Updating learning rate to 0.0012990285792923491
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 1.4072198867797852
Epoch: 1, Steps: 131 | Train Loss: 0.7083009 Vali Loss: 0.2831307 Best vali loss: 0.2831307
	iters: 100, epoch: 2 | loss: 0.2973070
	speed: 0.0126s/iter; left time: 10.3016s
Updating learning rate to 0.0011526607873261349
Epoch: 2 cost time: 1.0123600959777832
Epoch: 2, Steps: 131 | Train Loss: 0.2973070 Vali Loss: 0.2867588 Best vali loss: 0.2831307
	iters: 100, epoch: 3 | loss: 0.4346795
	speed: 0.0132s/iter; left time: 9.0469s
Updating learning rate to 0.000933605906400875
Epoch: 3 cost time: 1.1021788120269775
Epoch: 3, Steps: 131 | Train Loss: 0.4346795 Vali Loss: 0.2864968 Best vali loss: 0.2831307
	iters: 100, epoch: 4 | loss: 0.4872201
	speed: 0.0132s/iter; left time: 7.3189s
Updating learning rate to 0.0006752130564
Epoch: 4 cost time: 1.0808687210083008
Epoch: 4, Steps: 131 | Train Loss: 0.4872201 Vali Loss: 0.2970131 Best vali loss: 0.2831307
	iters: 100, epoch: 5 | loss: 0.5738229
	speed: 0.0132s/iter; left time: 5.5897s
Updating learning rate to 0.0004168202063991251
Epoch: 5 cost time: 1.096137523651123
Epoch: 5, Steps: 131 | Train Loss: 0.5738229 Vali Loss: 0.2920910 Best vali loss: 0.2831307
	iters: 100, epoch: 6 | loss: 0.5489188
	speed: 0.0132s/iter; left time: 3.8942s
Updating learning rate to 0.00019776532547386528
Epoch: 6 cost time: 1.123382806777954
Epoch: 6, Steps: 131 | Train Loss: 0.5489188 Vali Loss: 0.2950296 Best vali loss: 0.2831307
	iters: 100, epoch: 7 | loss: 0.5620314
	speed: 0.0113s/iter; left time: 1.8466s
Updating learning rate to 5.1397533507650915e-05
Epoch: 7 cost time: 0.7981600761413574
Epoch: 7, Steps: 131 | Train Loss: 0.5620314 Vali Loss: 0.2981691 Best vali loss: 0.2831307
	iters: 100, epoch: 8 | loss: 0.3468452
	speed: 0.0107s/iter; left time: 0.3433s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9778115749359131
Epoch: 8, Steps: 131 | Train Loss: 0.3468452 Vali Loss: 0.2990811 Best vali loss: 0.2831307

best validation loss 0.2831307483145011

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009340825159, 'e_layers': 1, 'learning_rate': 0.0004994906874, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004804799550844266
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 1.0882678031921387
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2795920 Best vali loss: 0.2795920
Updating learning rate to 0.000426341969800035
Validation loss decreased (0.2796 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 1.2407937049865723
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2792407 Best vali loss: 0.2792407
Updating learning rate to 0.0003453187490443151
Epoch: 3 cost time: 1.500760793685913
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2891552 Best vali loss: 0.2792407
Updating learning rate to 0.0002497453437
Epoch: 4 cost time: 1.2504820823669434
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2993534 Best vali loss: 0.2792407
Updating learning rate to 0.00015417193835568497
Epoch: 5 cost time: 1.3890604972839355
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2963211 Best vali loss: 0.2792407
Updating learning rate to 7.3148717599965e-05
Epoch: 6 cost time: 1.5929055213928223
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2984156 Best vali loss: 0.2792407
Updating learning rate to 1.9010732315573368e-05
Epoch: 7 cost time: 0.561887264251709
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3014330 Best vali loss: 0.2792407
Updating learning rate to 0.0
Epoch: 8 cost time: 1.055403709411621
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3007712 Best vali loss: 0.2792407

best validation loss 0.2792406521042114

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022145785394, 'e_layers': 4, 'learning_rate': 6.08043485e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2773649
	speed: 0.0236s/iter; left time: 47.1060s
	iters: 200, epoch: 1 | loss: 0.2524119
	speed: 0.0147s/iter; left time: 27.9337s
Updating learning rate to 6.08043485e-05
Validation loss decreased (inf --> 0.2807).  Saving model state dict ...
Epoch: 1 cost time: 4.510523796081543
Epoch: 1, Steps: 262 | Train Loss: 0.2648884 Vali Loss: 0.2807372 Best vali loss: 0.2807372
	iters: 100, epoch: 2 | loss: 0.5193540
	speed: 0.0562s/iter; left time: 97.4730s
	iters: 200, epoch: 2 | loss: 0.6382422
	speed: 0.0171s/iter; left time: 27.9434s
Updating learning rate to 3.040217425e-05
Validation loss decreased (0.2807 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 4.73041558265686
Epoch: 2, Steps: 262 | Train Loss: 0.5787981 Vali Loss: 0.2781085 Best vali loss: 0.2781085
	iters: 100, epoch: 3 | loss: 0.4331726
	speed: 0.0582s/iter; left time: 85.7537s
	iters: 200, epoch: 3 | loss: 0.5466839
	speed: 0.0158s/iter; left time: 21.6622s
Updating learning rate to 1.5201087125e-05
Validation loss decreased (0.2781 --> 0.2724).  Saving model state dict ...
Epoch: 3 cost time: 4.533339738845825
Epoch: 3, Steps: 262 | Train Loss: 0.4899282 Vali Loss: 0.2723933 Best vali loss: 0.2723933

best validation loss 0.27239329702307097

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0035869875514, 'e_layers': 2, 'learning_rate': 0.0010903523233, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4171262
	speed: 0.0199s/iter; left time: 39.6839s
	iters: 200, epoch: 1 | loss: 0.4498644
	speed: 0.0137s/iter; left time: 26.0814s
Updating learning rate to 0.0010903523233
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 3.7120039463043213
Epoch: 1, Steps: 262 | Train Loss: 0.4334953 Vali Loss: 0.2840348 Best vali loss: 0.2840348
	iters: 100, epoch: 2 | loss: 0.3820410
	speed: 0.0364s/iter; left time: 63.1950s
	iters: 200, epoch: 2 | loss: 0.5897141
	speed: 0.0135s/iter; left time: 22.0575s
Updating learning rate to 0.00054517616165
Epoch: 2 cost time: 3.5834953784942627
Epoch: 2, Steps: 262 | Train Loss: 0.4858775 Vali Loss: 0.2885080 Best vali loss: 0.2840348
	iters: 100, epoch: 3 | loss: 0.8093371
	speed: 0.0527s/iter; left time: 77.5555s
	iters: 200, epoch: 3 | loss: 0.8184620
	speed: 0.0126s/iter; left time: 17.2774s
Updating learning rate to 0.000272588080825
Epoch: 3 cost time: 3.625096559524536
Epoch: 3, Steps: 262 | Train Loss: 0.8138995 Vali Loss: 0.2857598 Best vali loss: 0.2840348

best validation loss 0.2840348040971139

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6356344
	speed: 0.0205s/iter; left time: 40.9301s
	iters: 200, epoch: 1 | loss: 0.5111187
	speed: 0.0138s/iter; left time: 26.1491s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 3.9035754203796387
Epoch: 1, Steps: 262 | Train Loss: 0.5733765 Vali Loss: 0.2878953 Best vali loss: 0.2878953
	iters: 100, epoch: 2 | loss: 0.8056782
	speed: 0.0275s/iter; left time: 47.7203s
	iters: 200, epoch: 2 | loss: 0.4165036
	speed: 0.0110s/iter; left time: 18.0406s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.2879 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 2.7343993186950684
Epoch: 2, Steps: 262 | Train Loss: 0.6110909 Vali Loss: 0.2800095 Best vali loss: 0.2800095
	iters: 100, epoch: 3 | loss: 0.4709608
	speed: 0.0232s/iter; left time: 34.1964s
	iters: 200, epoch: 3 | loss: 0.4061714
	speed: 0.0116s/iter; left time: 15.9611s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 2.8268675804138184
Epoch: 3, Steps: 262 | Train Loss: 0.4385661 Vali Loss: 0.2802370 Best vali loss: 0.2800095

best validation loss 0.28000953231615044

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022145785394, 'e_layers': 4, 'learning_rate': 6.08043485e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2748045
	speed: 0.0184s/iter; left time: 22.3374s
	iters: 200, epoch: 4 | loss: 0.2338536
	speed: 0.0113s/iter; left time: 12.4997s
Updating learning rate to 7.6005435625e-06
Epoch: 4 cost time: 3.3304717540740967
Epoch: 4, Steps: 262 | Train Loss: 0.2543291 Vali Loss: 0.2824276 Best vali loss: 0.2723933
	iters: 100, epoch: 5 | loss: 0.4204869
	speed: 0.0267s/iter; left time: 25.3577s
	iters: 200, epoch: 5 | loss: 0.5825150
	speed: 0.0105s/iter; left time: 8.9367s
Updating learning rate to 3.80027178125e-06
Epoch: 5 cost time: 3.253350019454956
Epoch: 5, Steps: 262 | Train Loss: 0.5015010 Vali Loss: 0.2841825 Best vali loss: 0.2723933
	iters: 100, epoch: 6 | loss: 0.3818473
	speed: 0.0290s/iter; left time: 19.8972s
	iters: 200, epoch: 6 | loss: 0.4798851
	speed: 0.0124s/iter; left time: 7.2866s
Updating learning rate to 1.900135890625e-06
Epoch: 6 cost time: 3.5137054920196533
Epoch: 6, Steps: 262 | Train Loss: 0.4308662 Vali Loss: 0.2837713 Best vali loss: 0.2723933
	iters: 100, epoch: 7 | loss: 0.3251208
	speed: 0.0297s/iter; left time: 12.6045s
	iters: 200, epoch: 7 | loss: 0.4913108
	speed: 0.0131s/iter; left time: 4.2642s
Updating learning rate to 9.500679453125e-07
Epoch: 7 cost time: 3.6235125064849854
Epoch: 7, Steps: 262 | Train Loss: 0.4082158 Vali Loss: 0.2863221 Best vali loss: 0.2723933
	iters: 100, epoch: 8 | loss: 0.2634678
	speed: 0.0302s/iter; left time: 4.9248s
	iters: 200, epoch: 8 | loss: 0.3698874
	speed: 0.0131s/iter; left time: 0.8259s
Updating learning rate to 4.7503397265625e-07
Epoch: 8 cost time: 3.4789319038391113
Epoch: 8, Steps: 262 | Train Loss: 0.3166776 Vali Loss: 0.2853991 Best vali loss: 0.2723933

best validation loss 0.27239329702307097

[INFO][abstract_intensifier.py:595] Added config 1d643a and rejected config 639238 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008984102312, 'e_layers': 3, 'learning_rate': 0.0001246567955, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2893075
	speed: 0.0149s/iter; left time: 123.3106s
	iters: 200, epoch: 1 | loss: 0.5100536
	speed: 0.0077s/iter; left time: 62.4771s
	iters: 300, epoch: 1 | loss: 0.5942686
	speed: 0.0095s/iter; left time: 76.9730s
	iters: 400, epoch: 1 | loss: 0.3295915
	speed: 0.0095s/iter; left time: 75.5012s
	iters: 500, epoch: 1 | loss: 0.4632215
	speed: 0.0089s/iter; left time: 70.2946s
	iters: 600, epoch: 1 | loss: 0.5108418
	speed: 0.0097s/iter; left time: 74.9765s
	iters: 700, epoch: 1 | loss: 0.1884996
	speed: 0.0096s/iter; left time: 73.8180s
	iters: 800, epoch: 1 | loss: 0.6048788
	speed: 0.0085s/iter; left time: 64.5306s
	iters: 900, epoch: 1 | loss: 0.3107610
	speed: 0.0094s/iter; left time: 70.1683s
	iters: 1000, epoch: 1 | loss: 0.1854850
	speed: 0.0094s/iter; left time: 69.2033s
Updating learning rate to 0.00011991232872544754
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 9.818158864974976
Epoch: 1, Steps: 1045 | Train Loss: 0.3986909 Vali Loss: 0.2842735 Best vali loss: 0.2842735
	iters: 100, epoch: 2 | loss: 0.3063870
	speed: 0.0281s/iter; left time: 202.8415s
	iters: 200, epoch: 2 | loss: 0.5582054
	speed: 0.0088s/iter; left time: 62.5603s
	iters: 300, epoch: 2 | loss: 0.2983915
	speed: 0.0095s/iter; left time: 66.5649s
	iters: 400, epoch: 2 | loss: 1.4449883
	speed: 0.0097s/iter; left time: 66.8661s
	iters: 500, epoch: 2 | loss: 1.2051915
	speed: 0.0084s/iter; left time: 57.2805s
	iters: 600, epoch: 2 | loss: 0.2411689
	speed: 0.0073s/iter; left time: 49.0617s
	iters: 700, epoch: 2 | loss: 1.1508629
	speed: 0.0093s/iter; left time: 61.8444s
	iters: 800, epoch: 2 | loss: 0.3708520
	speed: 0.0096s/iter; left time: 62.4807s
	iters: 900, epoch: 2 | loss: 0.3956089
	speed: 0.0092s/iter; left time: 59.0493s
	iters: 1000, epoch: 2 | loss: 1.2361614
	speed: 0.0097s/iter; left time: 61.3439s
Updating learning rate to 0.00010640123045951734
Validation loss decreased (0.2843 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 9.477686166763306
Epoch: 2, Steps: 1045 | Train Loss: 0.7207818 Vali Loss: 0.2799797 Best vali loss: 0.2799797
	iters: 100, epoch: 3 | loss: 0.1868549
	speed: 0.0274s/iter; left time: 169.2146s
	iters: 200, epoch: 3 | loss: 0.1687750
	speed: 0.0094s/iter; left time: 56.7959s
	iters: 300, epoch: 3 | loss: 0.2910346
	speed: 0.0098s/iter; left time: 58.3886s
	iters: 400, epoch: 3 | loss: 0.7167879
	speed: 0.0095s/iter; left time: 55.6958s
	iters: 500, epoch: 3 | loss: 1.2671707
	speed: 0.0090s/iter; left time: 51.9405s
	iters: 600, epoch: 3 | loss: 0.2465627
	speed: 0.0096s/iter; left time: 54.5731s
	iters: 700, epoch: 3 | loss: 2.0161159
	speed: 0.0096s/iter; left time: 53.3396s
	iters: 800, epoch: 3 | loss: 0.2746529
	speed: 0.0095s/iter; left time: 52.1957s
	iters: 900, epoch: 3 | loss: 0.2825151
	speed: 0.0080s/iter; left time: 43.0951s
	iters: 1000, epoch: 3 | loss: 0.3886212
	speed: 0.0075s/iter; left time: 39.4199s
Updating learning rate to 8.618044293478654e-05
Epoch: 3 cost time: 9.387907981872559
Epoch: 3, Steps: 1045 | Train Loss: 0.5839091 Vali Loss: 0.2813513 Best vali loss: 0.2799797
	iters: 100, epoch: 4 | loss: 0.3911228
	speed: 0.0278s/iter; left time: 142.5999s
	iters: 200, epoch: 4 | loss: 0.2076299
	speed: 0.0082s/iter; left time: 41.1908s
	iters: 300, epoch: 4 | loss: 0.2324830
	speed: 0.0079s/iter; left time: 38.8652s
	iters: 400, epoch: 4 | loss: 0.2028892
	speed: 0.0079s/iter; left time: 38.3393s
	iters: 500, epoch: 4 | loss: 0.3133197
	speed: 0.0078s/iter; left time: 36.7995s
	iters: 600, epoch: 4 | loss: 1.2074671
	speed: 0.0093s/iter; left time: 42.8334s
	iters: 700, epoch: 4 | loss: 0.4634506
	speed: 0.0093s/iter; left time: 42.0980s
	iters: 800, epoch: 4 | loss: 0.8175567
	speed: 0.0086s/iter; left time: 38.1382s
	iters: 900, epoch: 4 | loss: 0.5123399
	speed: 0.0102s/iter; left time: 44.2521s
	iters: 1000, epoch: 4 | loss: 0.2369307
	speed: 0.0099s/iter; left time: 41.8525s
Updating learning rate to 6.232839775e-05
Epoch: 4 cost time: 9.18925929069519
Epoch: 4, Steps: 1045 | Train Loss: 0.4585190 Vali Loss: 0.2831427 Best vali loss: 0.2799797
	iters: 100, epoch: 5 | loss: 0.3152269
	speed: 0.0333s/iter; left time: 135.9666s
	iters: 200, epoch: 5 | loss: 0.3524606
	speed: 0.0105s/iter; left time: 41.9463s
	iters: 300, epoch: 5 | loss: 0.1320624
	speed: 0.0106s/iter; left time: 41.2472s
	iters: 400, epoch: 5 | loss: 0.2364227
	speed: 0.0077s/iter; left time: 29.0268s
	iters: 500, epoch: 5 | loss: 0.1967465
	speed: 0.0090s/iter; left time: 33.0402s
	iters: 600, epoch: 5 | loss: 0.4554346
	speed: 0.0089s/iter; left time: 31.8353s
	iters: 700, epoch: 5 | loss: 0.7624523
	speed: 0.0093s/iter; left time: 32.2498s
	iters: 800, epoch: 5 | loss: 0.5090494
	speed: 0.0099s/iter; left time: 33.6194s
	iters: 900, epoch: 5 | loss: 0.4430816
	speed: 0.0104s/iter; left time: 34.0024s
	iters: 1000, epoch: 5 | loss: 0.6892738
	speed: 0.0095s/iter; left time: 30.2567s
Updating learning rate to 3.847635256521346e-05
Epoch: 5 cost time: 9.92585277557373
Epoch: 5, Steps: 1045 | Train Loss: 0.4092211 Vali Loss: 0.2839991 Best vali loss: 0.2799797
	iters: 100, epoch: 6 | loss: 0.2472995
	speed: 0.0410s/iter; left time: 124.4456s
	iters: 200, epoch: 6 | loss: 0.2785142
	speed: 0.0129s/iter; left time: 37.7824s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010020989356, 'e_layers': 1, 'learning_rate': 0.0009420617111, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3240435
	speed: 0.0174s/iter; left time: 34.8459s
	iters: 200, epoch: 1 | loss: 0.4264456
	speed: 0.0109s/iter; left time: 20.6836s
Updating learning rate to 0.0009062066221739254
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 3.030303955078125
Epoch: 1, Steps: 262 | Train Loss: 0.3752446 Vali Loss: 0.2840256 Best vali loss: 0.2840256
	iters: 100, epoch: 2 | loss: 0.5416123
	speed: 0.0205s/iter; left time: 35.5258s
	iters: 200, epoch: 2 | loss: 0.4622247
	speed: 0.0099s/iter; left time: 16.1073s
Updating learning rate to 0.0008040999676575061
Epoch: 2 cost time: 2.539884328842163
Epoch: 2, Steps: 262 | Train Loss: 0.5019185 Vali Loss: 0.2905474 Best vali loss: 0.2840256
	iters: 100, epoch: 3 | loss: 0.4093101
	speed: 0.0284s/iter; left time: 41.8538s
	iters: 200, epoch: 3 | loss: 0.5204759
	speed: 0.0095s/iter; left time: 12.9867s
Updating learning rate to 0.0006512865601017388
Epoch: 3 cost time: 2.57277774810791
Epoch: 3, Steps: 262 | Train Loss: 0.4648930 Vali Loss: 0.2890516 Best vali loss: 0.2840256
	iters: 100, epoch: 4 | loss: 0.2177726
	speed: 0.0257s/iter; left time: 31.1517s
	iters: 200, epoch: 4 | loss: 0.3699282
	speed: 0.0086s/iter; left time: 9.5341s
Updating learning rate to 0.00047103085555
Epoch: 4 cost time: 2.3724465370178223
Epoch: 4, Steps: 262 | Train Loss: 0.2938504 Vali Loss: 0.2951360 Best vali loss: 0.2840256
	iters: 100, epoch: 5 | loss: 0.4527917
	speed: 0.0316s/iter; left time: 29.9643s
	iters: 200, epoch: 5 | loss: 0.4682055
	speed: 0.0125s/iter; left time: 10.6468s
Updating learning rate to 0.0002907751509982612
Epoch: 5 cost time: 3.0557446479797363
Epoch: 5, Steps: 262 | Train Loss: 0.4604986 Vali Loss: 0.3014269 Best vali loss: 0.2840256
	iters: 100, epoch: 6 | loss: 0.3982643
	speed: 0.0255s/iter; left time: 17.5380s
	iters: 200, epoch: 6 | loss: 0.4324051
	speed: 0.0109s/iter; left time: 6.3860s
Updating learning rate to 0.0001379617434424939
Epoch: 6 cost time: 2.6327662467956543
Epoch: 6, Steps: 262 | Train Loss: 0.4153347 Vali Loss: 0.3026985 Best vali loss: 0.2840256
	iters: 100, epoch: 7 | loss: 0.4328220
	speed: 0.0390s/iter; left time: 16.5887s
	iters: 200, epoch: 7 | loss: 0.3685503
	speed: 0.0109s/iter; left time: 3.5580s
Updating learning rate to 3.585508892607457e-05
Epoch: 7 cost time: 2.9668924808502197
Epoch: 7, Steps: 262 | Train Loss: 0.4006861 Vali Loss: 0.3099575 Best vali loss: 0.2840256
	iters: 100, epoch: 8 | loss: 0.2124739
	speed: 0.0390s/iter; left time: 6.3644s
	iters: 200, epoch: 8 | loss: 0.3485198
	speed: 0.0070s/iter; left time: 0.4429s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8723349571228027
Epoch: 8, Steps: 262 | Train Loss: 0.2804968 Vali Loss: 0.3070286 Best vali loss: 0.2840256

best validation loss 0.284025571278898

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0046210525657, 'e_layers': 2, 'learning_rate': 0.0004551293019, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4283065
	speed: 0.0189s/iter; left time: 17.9510s
Updating learning rate to 0.00043780697428578015
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 2.160229444503784
Epoch: 1, Steps: 131 | Train Loss: 0.4283065 Vali Loss: 0.2798781 Best vali loss: 0.2798781
	iters: 100, epoch: 2 | loss: 0.3388442
	speed: 0.0332s/iter; left time: 27.1712s
Updating learning rate to 0.00038847715879509467
Epoch: 2 cost time: 2.553400754928589
Epoch: 2, Steps: 131 | Train Loss: 0.3388442 Vali Loss: 0.2836269 Best vali loss: 0.2798781
	iters: 100, epoch: 3 | loss: 0.3115377
	speed: 0.0390s/iter; left time: 26.7997s
Updating learning rate to 0.00031464987266050957
Epoch: 3 cost time: 2.8704471588134766
Epoch: 3, Steps: 131 | Train Loss: 0.3115377 Vali Loss: 0.2901143 Best vali loss: 0.2798781

best validation loss 0.279878081032759

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020495993871, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2387139
	speed: 0.0181s/iter; left time: 36.1427s
	iters: 200, epoch: 1 | loss: 0.9185858
	speed: 0.0101s/iter; left time: 19.2027s
Updating learning rate to 0.00026739708288462056
Validation loss decreased (inf --> 0.2961).  Saving model state dict ...
Epoch: 1 cost time: 2.9434103965759277
Epoch: 1, Steps: 262 | Train Loss: 0.5786498 Vali Loss: 0.2960535 Best vali loss: 0.2960535
	iters: 100, epoch: 2 | loss: 0.4240574
	speed: 0.0250s/iter; left time: 43.4325s
	iters: 200, epoch: 2 | loss: 0.3212842
	speed: 0.0103s/iter; left time: 16.9055s
Updating learning rate to 0.00023726816869140896
Validation loss decreased (0.2961 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 2.7058498859405518
Epoch: 2, Steps: 262 | Train Loss: 0.3726708 Vali Loss: 0.2819357 Best vali loss: 0.2819357
	iters: 100, epoch: 3 | loss: 0.5041867
	speed: 0.0329s/iter; left time: 48.4424s
	iters: 200, epoch: 3 | loss: 0.2868077
	speed: 0.0076s/iter; left time: 10.4540s
Updating learning rate to 0.0001921770620869945
Epoch: 3 cost time: 2.5638067722320557
Epoch: 3, Steps: 262 | Train Loss: 0.3954972 Vali Loss: 0.2851667 Best vali loss: 0.2819357

best validation loss 0.2819357441953675

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061533629679, 'e_layers': 3, 'learning_rate': 0.0006363706699, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5191902
	speed: 0.0158s/iter; left time: 64.7050s
	iters: 200, epoch: 1 | loss: 0.4846422
	speed: 0.0092s/iter; left time: 36.6066s
	iters: 300, epoch: 1 | loss: 0.9452802
	speed: 0.0074s/iter; left time: 28.7035s
	iters: 400, epoch: 1 | loss: 0.7892662
	speed: 0.0076s/iter; left time: 28.8569s
	iters: 500, epoch: 1 | loss: 0.7206798
	speed: 0.0071s/iter; left time: 26.1373s
Updating learning rate to 0.0006363706699
Validation loss decreased (inf --> 0.2955).  Saving model state dict ...
Epoch: 1 cost time: 4.556777238845825
Epoch: 1, Steps: 523 | Train Loss: 0.6918117 Vali Loss: 0.2955377 Best vali loss: 0.2955377
	iters: 100, epoch: 2 | loss: 0.4854390
	speed: 0.0162s/iter; left time: 57.6406s
	iters: 200, epoch: 2 | loss: 0.7770162
	speed: 0.0077s/iter; left time: 26.5035s
	iters: 300, epoch: 2 | loss: 0.3161784
	speed: 0.0080s/iter; left time: 26.9599s
	iters: 400, epoch: 2 | loss: 0.3458335
	speed: 0.0087s/iter; left time: 28.4265s
	iters: 500, epoch: 2 | loss: 0.4081716
	speed: 0.0086s/iter; left time: 27.2488s
Updating learning rate to 0.00031818533495
Validation loss decreased (0.2955 --> 0.2921).  Saving model state dict ...
Epoch: 2 cost time: 4.289379358291626
Epoch: 2, Steps: 523 | Train Loss: 0.4665277 Vali Loss: 0.2920919 Best vali loss: 0.2920919
	iters: 100, epoch: 3 | loss: 0.4653661
	speed: 0.0184s/iter; left time: 55.7917s
	iters: 200, epoch: 3 | loss: 0.2856506
	speed: 0.0086s/iter; left time: 25.2285s
	iters: 300, epoch: 3 | loss: 0.2406067
	speed: 0.0087s/iter; left time: 24.6781s
	iters: 400, epoch: 3 | loss: 0.1857926
	speed: 0.0087s/iter; left time: 23.9331s
	iters: 500, epoch: 3 | loss: 0.4420754
	speed: 0.0088s/iter; left time: 23.1626s
Updating learning rate to 0.000159092667475
Epoch: 3 cost time: 4.5105979442596436
Epoch: 3, Steps: 523 | Train Loss: 0.3238983 Vali Loss: 0.3054774 Best vali loss: 0.2920919

best validation loss 0.2920918638886196

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0046210525657, 'e_layers': 2, 'learning_rate': 0.0004551293019, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3467670
	speed: 0.0215s/iter; left time: 11.9276s
Updating learning rate to 0.00022756465095
Epoch: 4 cost time: 2.148118495941162
Epoch: 4, Steps: 131 | Train Loss: 0.3467670 Vali Loss: 0.2922347 Best vali loss: 0.2798781
	iters: 100, epoch: 5 | loss: 0.2872778
	speed: 0.0222s/iter; left time: 9.4276s
Updating learning rate to 0.0001404794292394904
Epoch: 5 cost time: 1.6237475872039795
Epoch: 5, Steps: 131 | Train Loss: 0.2872778 Vali Loss: 0.2969504 Best vali loss: 0.2798781
	iters: 100, epoch: 6 | loss: 0.2504089
	speed: 0.0191s/iter; left time: 5.6284s
Updating learning rate to 6.66521431049053e-05
Epoch: 6 cost time: 1.5474090576171875
Epoch: 6, Steps: 131 | Train Loss: 0.2504089 Vali Loss: 0.3079077 Best vali loss: 0.2798781
	iters: 100, epoch: 7 | loss: 0.2451514
	speed: 0.0246s/iter; left time: 4.0163s
Updating learning rate to 1.7322327614219856e-05
Epoch: 7 cost time: 1.6660828590393066
Epoch: 7, Steps: 131 | Train Loss: 0.2451514 Vali Loss: 0.3114165 Best vali loss: 0.2798781
	iters: 100, epoch: 8 | loss: 0.2221822
	speed: 0.0226s/iter; left time: 0.7242s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.591578722000122
Epoch: 8, Steps: 131 | Train Loss: 0.2221822 Vali Loss: 0.3136749 Best vali loss: 0.2798781

best validation loss 0.279878081032759

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 2.4189484119415283
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2829255 Best vali loss: 0.2829255
Updating learning rate to 0.0005975820137081337
Epoch: 2 cost time: 1.2753236293792725
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2939710 Best vali loss: 0.2829255
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.9566104412078857
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2943636 Best vali loss: 0.2829255
Updating learning rate to 0.000350055439
Epoch: 4 cost time: 0.9640116691589355
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2860285 Best vali loss: 0.2829255
Updating learning rate to 0.0002160950220854117
Validation loss decreased (0.2829 --> 0.2773).  Saving model state dict ...
Epoch: 5 cost time: 1.176664113998413
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2773377 Best vali loss: 0.2773377
Updating learning rate to 0.00010252886429186618
Epoch: 6 cost time: 0.9588696956634521
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3054787 Best vali loss: 0.2773377
Updating learning rate to 2.6646383663646746e-05
Epoch: 7 cost time: 0.9482848644256592
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2889122 Best vali loss: 0.2773377
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9625988006591797
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2967863 Best vali loss: 0.2773377

best validation loss 0.27733770989272266

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4277424
	speed: 0.0164s/iter; left time: 135.2792s
	iters: 200, epoch: 1 | loss: 0.2593872
	speed: 0.0098s/iter; left time: 79.7053s
	iters: 300, epoch: 1 | loss: 0.3310376
	speed: 0.0103s/iter; left time: 83.0713s
	iters: 400, epoch: 1 | loss: 0.4147624
	speed: 0.0107s/iter; left time: 85.5801s
	iters: 500, epoch: 1 | loss: 0.2040509
	speed: 0.0107s/iter; left time: 83.7434s
	iters: 600, epoch: 1 | loss: 1.2253639
	speed: 0.0091s/iter; left time: 70.4752s
	iters: 700, epoch: 1 | loss: 1.1520661
	speed: 0.0103s/iter; left time: 79.1896s
	iters: 800, epoch: 1 | loss: 0.2324915
	speed: 0.0108s/iter; left time: 81.8265s
	iters: 900, epoch: 1 | loss: 0.2170449
	speed: 0.0110s/iter; left time: 81.9106s
	iters: 1000, epoch: 1 | loss: 0.3583880
	speed: 0.0106s/iter; left time: 78.0743s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 11.047677516937256
Epoch: 1, Steps: 1045 | Train Loss: 0.4822335 Vali Loss: 0.2868643 Best vali loss: 0.2868643
	iters: 100, epoch: 2 | loss: 0.1763929
	speed: 0.0300s/iter; left time: 216.4239s
	iters: 200, epoch: 2 | loss: 0.2803303
	speed: 0.0112s/iter; left time: 79.4362s
	iters: 300, epoch: 2 | loss: 0.2616337
	speed: 0.0105s/iter; left time: 73.6836s
	iters: 400, epoch: 2 | loss: 0.4828585
	speed: 0.0088s/iter; left time: 60.9923s
	iters: 500, epoch: 2 | loss: 0.5062490
	speed: 0.0085s/iter; left time: 58.1512s
	iters: 600, epoch: 2 | loss: 1.3107723
	speed: 0.0105s/iter; left time: 70.3526s
	iters: 700, epoch: 2 | loss: 0.6903986
	speed: 0.0105s/iter; left time: 69.2287s
	iters: 800, epoch: 2 | loss: 0.2614167
	speed: 0.0100s/iter; left time: 65.0171s
	iters: 900, epoch: 2 | loss: 1.1376568
	speed: 0.0094s/iter; left time: 60.3805s
	iters: 1000, epoch: 2 | loss: 0.4134337
	speed: 0.0095s/iter; left time: 59.7231s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.2869 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 10.44213342666626
Epoch: 2, Steps: 1045 | Train Loss: 0.5521143 Vali Loss: 0.2868210 Best vali loss: 0.2868210
	iters: 100, epoch: 3 | loss: 0.4605928
	speed: 0.0284s/iter; left time: 175.2933s
	iters: 200, epoch: 3 | loss: 0.2269321
	speed: 0.0089s/iter; left time: 53.7420s
	iters: 300, epoch: 3 | loss: 0.8102833
	speed: 0.0085s/iter; left time: 50.8616s
	iters: 400, epoch: 3 | loss: 0.3369110
	speed: 0.0091s/iter; left time: 53.5285s
	iters: 500, epoch: 3 | loss: 0.8283812
	speed: 0.0099s/iter; left time: 56.9766s
	iters: 600, epoch: 3 | loss: 0.2423897
	speed: 0.0098s/iter; left time: 55.6822s
	iters: 700, epoch: 3 | loss: 0.1412322
	speed: 0.0092s/iter; left time: 51.3980s
	iters: 800, epoch: 3 | loss: 1.5074129
	speed: 0.0080s/iter; left time: 43.6501s
	iters: 900, epoch: 3 | loss: 0.2908244
	speed: 0.0082s/iter; left time: 43.8687s
	iters: 1000, epoch: 3 | loss: 0.4889799
	speed: 0.0085s/iter; left time: 44.8426s
Updating learning rate to 0.0004164486617318853
Epoch: 3 cost time: 9.320981979370117
Epoch: 3, Steps: 1045 | Train Loss: 0.5333940 Vali Loss: 0.2935212 Best vali loss: 0.2868210
	iters: 100, epoch: 4 | loss: 0.1421055
	speed: 0.0213s/iter; left time: 109.0717s
	iters: 200, epoch: 4 | loss: 0.6631919
	speed: 0.0072s/iter; left time: 36.1865s
	iters: 300, epoch: 4 | loss: 1.0812093
	speed: 0.0083s/iter; left time: 41.1080s
	iters: 400, epoch: 4 | loss: 0.1905651
	speed: 0.0084s/iter; left time: 40.5293s
	iters: 500, epoch: 4 | loss: 0.4401441
	speed: 0.0082s/iter; left time: 38.8190s
	iters: 600, epoch: 4 | loss: 0.3707706
	speed: 0.0074s/iter; left time: 34.1129s
	iters: 700, epoch: 4 | loss: 0.7085202
	speed: 0.0086s/iter; left time: 38.9341s
	iters: 800, epoch: 4 | loss: 0.3775692
	speed: 0.0085s/iter; left time: 37.4410s
	iters: 900, epoch: 4 | loss: 0.2162700
	speed: 0.0074s/iter; left time: 31.9133s
	iters: 1000, epoch: 4 | loss: 0.9056112
	speed: 0.0079s/iter; left time: 33.1998s
Updating learning rate to 0.0003011887262
Epoch: 4 cost time: 8.29716444015503
Epoch: 4, Steps: 1045 | Train Loss: 0.5095957 Vali Loss: 0.2979448 Best vali loss: 0.2868210
	iters: 100, epoch: 5 | loss: 0.5716396
	speed: 0.0229s/iter; left time: 93.6388s
	iters: 200, epoch: 5 | loss: 0.5676532
	speed: 0.0069s/iter; left time: 27.4488s
	iters: 300, epoch: 5 | loss: 0.2404138
	speed: 0.0076s/iter; left time: 29.5261s
	iters: 400, epoch: 5 | loss: 0.2216989
	speed: 0.0082s/iter; left time: 31.0275s
	iters: 500, epoch: 5 | loss: 0.2054886
	speed: 0.0085s/iter; left time: 31.1508s
	iters: 600, epoch: 5 | loss: 0.5972717
	speed: 0.0082s/iter; left time: 29.2873s
	iters: 700, epoch: 5 | loss: 0.3648386
	speed: 0.0097s/iter; left time: 33.8340s
	iters: 800, epoch: 5 | loss: 0.4278537
	speed: 0.0082s/iter; left time: 27.8702s
	iters: 900, epoch: 5 | loss: 0.8036320
	speed: 0.0074s/iter; left time: 24.4409s
	iters: 1000, epoch: 5 | loss: 0.1442347
	speed: 0.0070s/iter; left time: 22.1590s
Updating learning rate to 0.00018592879066811477
Epoch: 5 cost time: 8.290503978729248
Epoch: 5, Steps: 1045 | Train Loss: 0.4144725 Vali Loss: 0.2872141 Best vali loss: 0.2868210
	iters: 100, epoch: 6 | loss: 0.5359251
	speed: 0.0234s/iter; left time: 71.0023s
	iters: 200, epoch: 6 | loss: 0.3591045
	speed: 0.0075s/iter; left time: 22.0152s
	iters: 300, epoch: 6 | loss: 0.4137720
	speed: 0.0072s/iter; left time: 20.4554s
	iters: 400, epoch: 6 | loss: 0.3504807
	speed: 0.0108s/iter; left time: 29.4678s
	iters: 500, epoch: 6 | loss: 0.6780813
	speed: 0.0115s/iter; left time: 30.4371s
	iters: 600, epoch: 6 | loss: 0.2244362
	speed: 0.0107s/iter; left time: 27.0838s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0008112006135, 'e_layers': 3, 'learning_rate': 0.0011824883542, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0205554
	speed: 0.0148s/iter; left time: 122.6706s
	iters: 200, epoch: 1 | loss: 1.3511711
	speed: 0.0095s/iter; left time: 77.1802s
	iters: 300, epoch: 1 | loss: 0.3958627
	speed: 0.0083s/iter; left time: 66.6721s
	iters: 400, epoch: 1 | loss: 0.4888563
	speed: 0.0091s/iter; left time: 72.4908s
	iters: 500, epoch: 1 | loss: 1.1380637
	speed: 0.0096s/iter; left time: 75.7161s
	iters: 600, epoch: 1 | loss: 0.8054008
	speed: 0.0090s/iter; left time: 69.9993s
	iters: 700, epoch: 1 | loss: 0.3260827
	speed: 0.0068s/iter; left time: 52.0265s
	iters: 800, epoch: 1 | loss: 0.2487925
	speed: 0.0055s/iter; left time: 41.7375s
	iters: 900, epoch: 1 | loss: 0.6731085
	speed: 0.0098s/iter; left time: 73.0880s
	iters: 1000, epoch: 1 | loss: 0.4555067
	speed: 0.0117s/iter; left time: 86.2781s
Updating learning rate to 0.0011374825710391684
Validation loss decreased (inf --> 0.3155).  Saving model state dict ...
Epoch: 1 cost time: 9.601576328277588
Epoch: 1, Steps: 1045 | Train Loss: 0.6903400 Vali Loss: 0.3154809 Best vali loss: 0.3154809
	iters: 100, epoch: 2 | loss: 0.6543091
	speed: 0.0304s/iter; left time: 219.6292s
	iters: 200, epoch: 2 | loss: 0.6376151
	speed: 0.0090s/iter; left time: 64.1411s
	iters: 300, epoch: 2 | loss: 1.2570260
	speed: 0.0088s/iter; left time: 61.9109s
	iters: 400, epoch: 2 | loss: 0.6404921
	speed: 0.0088s/iter; left time: 60.6666s
	iters: 500, epoch: 2 | loss: 1.6676109
	speed: 0.0089s/iter; left time: 60.9912s
	iters: 600, epoch: 2 | loss: 0.3447910
	speed: 0.0091s/iter; left time: 60.7821s
	iters: 700, epoch: 2 | loss: 0.2874038
	speed: 0.0090s/iter; left time: 59.3578s
	iters: 800, epoch: 2 | loss: 0.3738408
	speed: 0.0087s/iter; left time: 56.8376s
	iters: 900, epoch: 2 | loss: 0.6208175
	speed: 0.0088s/iter; left time: 56.3801s
	iters: 1000, epoch: 2 | loss: 0.3837335
	speed: 0.0092s/iter; left time: 58.3693s
Updating learning rate to 0.00100931694406447
Epoch: 2 cost time: 9.392308235168457
Epoch: 2, Steps: 1045 | Train Loss: 0.6867640 Vali Loss: 0.3209852 Best vali loss: 0.3154809
	iters: 100, epoch: 3 | loss: 0.2992513
	speed: 0.0292s/iter; left time: 180.2841s
	iters: 200, epoch: 3 | loss: 1.0037190
	speed: 0.0090s/iter; left time: 54.5727s
	iters: 300, epoch: 3 | loss: 0.5794622
	speed: 0.0091s/iter; left time: 54.5756s
	iters: 400, epoch: 3 | loss: 0.5211595
	speed: 0.0091s/iter; left time: 53.3985s
	iters: 500, epoch: 3 | loss: 0.2431950
	speed: 0.0091s/iter; left time: 52.7832s
	iters: 600, epoch: 3 | loss: 1.2082531
	speed: 0.0092s/iter; left time: 51.9950s
	iters: 700, epoch: 3 | loss: 0.7972037
	speed: 0.0082s/iter; left time: 45.6214s
	iters: 800, epoch: 3 | loss: 0.3961514
	speed: 0.0081s/iter; left time: 44.2829s
	iters: 900, epoch: 3 | loss: 0.2492451
	speed: 0.0084s/iter; left time: 45.1368s
	iters: 1000, epoch: 3 | loss: 0.3811860
	speed: 0.0091s/iter; left time: 47.7112s
Updating learning rate to 0.0008175035281585011
Epoch: 3 cost time: 9.297374248504639
Epoch: 3, Steps: 1045 | Train Loss: 0.5678826 Vali Loss: 0.3222819 Best vali loss: 0.3154809

best validation loss 0.31548093712631325

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0080400609315, 'e_layers': 4, 'learning_rate': 0.0010295150506, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6519474
	speed: 0.0158s/iter; left time: 14.9499s
Updating learning rate to 0.0009903314671308309
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 1.6049914360046387
Epoch: 1, Steps: 131 | Train Loss: 0.6519474 Vali Loss: 0.2864076 Best vali loss: 0.2864076
	iters: 100, epoch: 2 | loss: 0.3658842
	speed: 0.0157s/iter; left time: 12.8227s
Updating learning rate to 0.0008787460621064358
Epoch: 2 cost time: 1.3104584217071533
Epoch: 2, Steps: 131 | Train Loss: 0.3658842 Vali Loss: 0.2865508 Best vali loss: 0.2864076
	iters: 100, epoch: 3 | loss: 0.5991310
	speed: 0.0155s/iter; left time: 10.6232s
Updating learning rate to 0.0007117467019175636
Epoch: 3 cost time: 1.3111634254455566
Epoch: 3, Steps: 131 | Train Loss: 0.5991310 Vali Loss: 0.2874271 Best vali loss: 0.2864076

best validation loss 0.28640759937733956

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056421063169, 'e_layers': 1, 'learning_rate': 0.0002937171172, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3397565
	speed: 0.0113s/iter; left time: 93.5879s
	iters: 200, epoch: 1 | loss: 0.4171744
	speed: 0.0050s/iter; left time: 40.5472s
	iters: 300, epoch: 1 | loss: 0.3182943
	speed: 0.0045s/iter; left time: 35.9818s
	iters: 400, epoch: 1 | loss: 0.5878118
	speed: 0.0046s/iter; left time: 36.6148s
	iters: 500, epoch: 1 | loss: 0.2199846
	speed: 0.0042s/iter; left time: 32.8871s
	iters: 600, epoch: 1 | loss: 0.6222669
	speed: 0.0028s/iter; left time: 22.0167s
	iters: 700, epoch: 1 | loss: 0.6935750
	speed: 0.0030s/iter; left time: 23.0158s
	iters: 800, epoch: 1 | loss: 0.6685083
	speed: 0.0041s/iter; left time: 31.3681s
	iters: 900, epoch: 1 | loss: 0.2469099
	speed: 0.0052s/iter; left time: 39.1318s
	iters: 1000, epoch: 1 | loss: 0.1507189
	speed: 0.0051s/iter; left time: 37.5934s
Updating learning rate to 0.0002937171172
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 4.937959909439087
Epoch: 1, Steps: 1045 | Train Loss: 0.4265001 Vali Loss: 0.2821361 Best vali loss: 0.2821361
	iters: 100, epoch: 2 | loss: 0.3304346
	speed: 0.0218s/iter; left time: 157.6330s
	iters: 200, epoch: 2 | loss: 0.2074272
	speed: 0.0052s/iter; left time: 37.3294s
	iters: 300, epoch: 2 | loss: 0.3722273
	speed: 0.0051s/iter; left time: 35.8703s
	iters: 400, epoch: 2 | loss: 0.3146005
	speed: 0.0050s/iter; left time: 34.4595s
	iters: 500, epoch: 2 | loss: 0.2073581
	speed: 0.0051s/iter; left time: 34.5797s
	iters: 600, epoch: 2 | loss: 0.3975649
	speed: 0.0050s/iter; left time: 33.4351s
	iters: 700, epoch: 2 | loss: 0.2735291
	speed: 0.0051s/iter; left time: 33.7066s
	iters: 800, epoch: 2 | loss: 0.1535363
	speed: 0.0047s/iter; left time: 30.3907s
	iters: 900, epoch: 2 | loss: 0.1088856
	speed: 0.0044s/iter; left time: 28.1492s
	iters: 1000, epoch: 2 | loss: 1.1317835
	speed: 0.0051s/iter; left time: 32.5047s
Updating learning rate to 0.0001468585586
Epoch: 2 cost time: 5.307234525680542
Epoch: 2, Steps: 1045 | Train Loss: 0.3497347 Vali Loss: 0.2840020 Best vali loss: 0.2821361
	iters: 100, epoch: 3 | loss: 0.8354444
	speed: 0.0209s/iter; left time: 129.0762s
	iters: 200, epoch: 3 | loss: 0.2272315
	speed: 0.0054s/iter; left time: 32.7359s
	iters: 300, epoch: 3 | loss: 1.1897027
	speed: 0.0054s/iter; left time: 32.3648s
	iters: 400, epoch: 3 | loss: 0.4252163
	speed: 0.0051s/iter; left time: 30.1817s
	iters: 500, epoch: 3 | loss: 0.5014278
	speed: 0.0051s/iter; left time: 29.7075s
	iters: 600, epoch: 3 | loss: 0.3733715
	speed: 0.0052s/iter; left time: 29.2124s
	iters: 700, epoch: 3 | loss: 0.4268212
	speed: 0.0051s/iter; left time: 28.4956s
	iters: 800, epoch: 3 | loss: 0.3225738
	speed: 0.0052s/iter; left time: 28.2549s
	iters: 900, epoch: 3 | loss: 0.4571692
	speed: 0.0047s/iter; left time: 25.0026s
	iters: 1000, epoch: 3 | loss: 0.2098571
	speed: 0.0050s/iter; left time: 26.5342s
Updating learning rate to 7.34292793e-05
Epoch: 3 cost time: 5.3950889110565186
Epoch: 3, Steps: 1045 | Train Loss: 0.4968816 Vali Loss: 0.2868896 Best vali loss: 0.2821361

best validation loss 0.2821361289486738

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056421063169, 'e_layers': 1, 'learning_rate': 0.0002937171172, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3141481
	speed: 0.0117s/iter; left time: 59.8338s
	iters: 200, epoch: 4 | loss: 0.3832070
	speed: 0.0047s/iter; left time: 23.8419s
	iters: 300, epoch: 4 | loss: 0.2766249
	speed: 0.0042s/iter; left time: 20.7895s
	iters: 400, epoch: 4 | loss: 0.5722004
	speed: 0.0037s/iter; left time: 17.9652s
	iters: 500, epoch: 4 | loss: 0.2235400
	speed: 0.0040s/iter; left time: 18.7822s
	iters: 600, epoch: 4 | loss: 0.4460243
	speed: 0.0049s/iter; left time: 22.7488s
	iters: 700, epoch: 4 | loss: 0.6600658
	speed: 0.0052s/iter; left time: 23.6546s
	iters: 800, epoch: 4 | loss: 0.6211073
	speed: 0.0052s/iter; left time: 23.1184s
	iters: 900, epoch: 4 | loss: 0.2443307
	speed: 0.0053s/iter; left time: 22.8143s
	iters: 1000, epoch: 4 | loss: 0.1726739
	speed: 0.0052s/iter; left time: 22.0745s
Updating learning rate to 3.671463965e-05
Epoch: 4 cost time: 5.350591659545898
Epoch: 4, Steps: 1045 | Train Loss: 0.3913922 Vali Loss: 0.2893244 Best vali loss: 0.2821361
	iters: 100, epoch: 5 | loss: 0.3274290
	speed: 0.0210s/iter; left time: 85.6621s
	iters: 200, epoch: 5 | loss: 0.1679281
	speed: 0.0052s/iter; left time: 20.5990s
	iters: 300, epoch: 5 | loss: 0.3021380
	speed: 0.0043s/iter; left time: 16.5348s
	iters: 400, epoch: 5 | loss: 0.2968160
	speed: 0.0037s/iter; left time: 14.1253s
	iters: 500, epoch: 5 | loss: 0.2072080
	speed: 0.0044s/iter; left time: 16.1946s
	iters: 600, epoch: 5 | loss: 0.4004238
	speed: 0.0058s/iter; left time: 20.8417s
	iters: 700, epoch: 5 | loss: 0.2603337
	speed: 0.0058s/iter; left time: 20.2531s
	iters: 800, epoch: 5 | loss: 0.1697924
	speed: 0.0047s/iter; left time: 15.8717s
	iters: 900, epoch: 5 | loss: 0.1178179
	speed: 0.0044s/iter; left time: 14.5732s
	iters: 1000, epoch: 5 | loss: 1.0361304
	speed: 0.0051s/iter; left time: 16.0790s
Updating learning rate to 1.8357319825e-05
Epoch: 5 cost time: 5.15453577041626
Epoch: 5, Steps: 1045 | Train Loss: 0.3286017 Vali Loss: 0.2882915 Best vali loss: 0.2821361
	iters: 100, epoch: 6 | loss: 0.6936947
	speed: 0.0228s/iter; left time: 69.1667s
	iters: 200, epoch: 6 | loss: 0.2195293
	speed: 0.0052s/iter; left time: 15.3438s
	iters: 300, epoch: 6 | loss: 1.1312770
	speed: 0.0051s/iter; left time: 14.5707s
	iters: 400, epoch: 6 | loss: 0.3202577
	speed: 0.0059s/iter; left time: 16.0359s
	iters: 500, epoch: 6 | loss: 0.4774403
	speed: 0.0059s/iter; left time: 15.5449s
	iters: 600, epoch: 6 | loss: 0.3985267
	speed: 0.0053s/iter; left time: 13.3594s
	iters: 700, epoch: 6 | loss: 0.3922423
	speed: 0.0055s/iter; left time: 13.3275s
	iters: 800, epoch: 6 | loss: 0.3061839
	speed: 0.0062s/iter; left time: 14.5154s
	iters: 900, epoch: 6 | loss: 0.4714499
	speed: 0.0068s/iter; left time: 15.1101s
	iters: 1000, epoch: 6 | loss: 0.2058014
	speed: 0.0061s/iter; left time: 12.9471s
Updating learning rate to 9.1786599125e-06
Epoch: 6 cost time: 6.047767400741577
Epoch: 6, Steps: 1045 | Train Loss: 0.4616403 Vali Loss: 0.2911726 Best vali loss: 0.2821361
	iters: 100, epoch: 7 | loss: 1.0775725
	speed: 0.0215s/iter; left time: 42.7748s
	iters: 200, epoch: 7 | loss: 0.1731693
	speed: 0.0054s/iter; left time: 10.2291s
	iters: 300, epoch: 7 | loss: 0.2585936
	speed: 0.0052s/iter; left time: 9.3070s
	iters: 400, epoch: 7 | loss: 0.8804201
	speed: 0.0059s/iter; left time: 9.9493s
	iters: 500, epoch: 7 | loss: 0.6504334
	speed: 0.0059s/iter; left time: 9.3236s
	iters: 600, epoch: 7 | loss: 0.7698602
	speed: 0.0059s/iter; left time: 8.8219s
	iters: 700, epoch: 7 | loss: 0.3124998
	speed: 0.0052s/iter; left time: 7.2532s
	iters: 800, epoch: 7 | loss: 0.3151777
	speed: 0.0060s/iter; left time: 7.8010s
	iters: 900, epoch: 7 | loss: 0.3111126
	speed: 0.0063s/iter; left time: 7.5214s
	iters: 1000, epoch: 7 | loss: 0.2699273
	speed: 0.0063s/iter; left time: 6.9110s
Updating learning rate to 4.58932995625e-06
Epoch: 7 cost time: 6.148978233337402
Epoch: 7, Steps: 1045 | Train Loss: 0.5018767 Vali Loss: 0.2909200 Best vali loss: 0.2821361
	iters: 100, epoch: 8 | loss: 0.2386586
	speed: 0.0231s/iter; left time: 21.8532s
	iters: 200, epoch: 8 | loss: 0.5281434
	speed: 0.0056s/iter; left time: 4.7593s
	iters: 300, epoch: 8 | loss: 0.9936048
	speed: 0.0043s/iter; left time: 3.2059s
	iters: 400, epoch: 8 | loss: 0.3968027
	speed: 0.0043s/iter; left time: 2.8058s
	iters: 500, epoch: 8 | loss: 1.0937575
	speed: 0.0049s/iter; left time: 2.6899s
	iters: 600, epoch: 8 | loss: 0.1622564
	speed: 0.0046s/iter; left time: 2.0352s
	iters: 700, epoch: 8 | loss: 1.0081521
	speed: 0.0041s/iter; left time: 1.4338s
	iters: 800, epoch: 8 | loss: 0.2927197
	speed: 0.0039s/iter; left time: 0.9544s
	iters: 900, epoch: 8 | loss: 0.4522909
	speed: 0.0044s/iter; left time: 0.6428s
	iters: 1000, epoch: 8 | loss: 0.3583149
	speed: 0.0070s/iter; left time: 0.3207s
Updating learning rate to 2.294664978125e-06
Epoch: 8 cost time: 5.266677379608154
Epoch: 8, Steps: 1045 | Train Loss: 0.5524701 Vali Loss: 0.2907597 Best vali loss: 0.2821361

best validation loss 0.2821361289486738

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009492484957, 'e_layers': 1, 'learning_rate': 0.000414048162, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2454995
	speed: 0.0127s/iter; left time: 51.7112s
	iters: 200, epoch: 1 | loss: 0.5153696
	speed: 0.0058s/iter; left time: 22.9674s
	iters: 300, epoch: 1 | loss: 0.4688452
	speed: 0.0062s/iter; left time: 24.2501s
	iters: 400, epoch: 1 | loss: 0.6993049
	speed: 0.0057s/iter; left time: 21.4410s
	iters: 500, epoch: 1 | loss: 0.5053416
	speed: 0.0079s/iter; left time: 29.0146s
Updating learning rate to 0.000414048162
Validation loss decreased (inf --> 0.2854).  Saving model state dict ...
Epoch: 1 cost time: 3.7033917903900146
Epoch: 1, Steps: 523 | Train Loss: 0.4868722 Vali Loss: 0.2853682 Best vali loss: 0.2853682
	iters: 100, epoch: 2 | loss: 0.2321756
	speed: 0.0212s/iter; left time: 75.5748s
	iters: 200, epoch: 2 | loss: 0.3199373
	speed: 0.0074s/iter; left time: 25.5998s
	iters: 300, epoch: 2 | loss: 0.3630764
	speed: 0.0043s/iter; left time: 14.4509s
	iters: 400, epoch: 2 | loss: 0.4052977
	speed: 0.0036s/iter; left time: 11.6087s
	iters: 500, epoch: 2 | loss: 0.7056803
	speed: 0.0054s/iter; left time: 17.0348s
Updating learning rate to 0.000207024081
Epoch: 2 cost time: 2.9757137298583984
Epoch: 2, Steps: 523 | Train Loss: 0.4052334 Vali Loss: 0.2964044 Best vali loss: 0.2853682
	iters: 100, epoch: 3 | loss: 0.1805500
	speed: 0.0164s/iter; left time: 49.8751s
	iters: 200, epoch: 3 | loss: 0.5842885
	speed: 0.0061s/iter; left time: 18.0676s
	iters: 300, epoch: 3 | loss: 0.4101901
	speed: 0.0063s/iter; left time: 17.9907s
	iters: 400, epoch: 3 | loss: 0.3747517
	speed: 0.0062s/iter; left time: 16.9434s
	iters: 500, epoch: 3 | loss: 0.7214687
	speed: 0.0062s/iter; left time: 16.3354s
Updating learning rate to 0.0001035120405
Epoch: 3 cost time: 3.278573751449585
Epoch: 3, Steps: 523 | Train Loss: 0.4542498 Vali Loss: 0.2940553 Best vali loss: 0.2853682
	iters: 100, epoch: 4 | loss: 0.2500293
	speed: 0.0167s/iter; left time: 41.9294s
	iters: 200, epoch: 4 | loss: 0.2374301
	speed: 0.0060s/iter; left time: 14.5087s
	iters: 300, epoch: 4 | loss: 0.4815779
	speed: 0.0061s/iter; left time: 14.0515s
	iters: 400, epoch: 4 | loss: 0.3583659
	speed: 0.0061s/iter; left time: 13.5464s
	iters: 500, epoch: 4 | loss: 0.5305855
	speed: 0.0063s/iter; left time: 13.3291s
Updating learning rate to 5.175602025e-05
Epoch: 4 cost time: 3.2523748874664307
Epoch: 4, Steps: 523 | Train Loss: 0.3715977 Vali Loss: 0.2947268 Best vali loss: 0.2853682
	iters: 100, epoch: 5 | loss: 0.1857641
	speed: 0.0155s/iter; left time: 30.7957s
	iters: 200, epoch: 5 | loss: 0.3255169
	speed: 0.0041s/iter; left time: 7.7684s
	iters: 300, epoch: 5 | loss: 0.5367480
	speed: 0.0047s/iter; left time: 8.4402s
	iters: 400, epoch: 5 | loss: 0.2766403
	speed: 0.0065s/iter; left time: 10.9305s
	iters: 500, epoch: 5 | loss: 0.4715233
	speed: 0.0098s/iter; left time: 15.5667s
Updating learning rate to 2.5878010125e-05
Epoch: 5 cost time: 3.2613584995269775
Epoch: 5, Steps: 523 | Train Loss: 0.3592385 Vali Loss: 0.2982640 Best vali loss: 0.2853682
	iters: 100, epoch: 6 | loss: 0.3133419
	speed: 0.0240s/iter; left time: 35.2352s
	iters: 200, epoch: 6 | loss: 0.9987032
	speed: 0.0093s/iter; left time: 12.7593s
	iters: 300, epoch: 6 | loss: 0.4099885
	speed: 0.0091s/iter; left time: 11.5762s
	iters: 400, epoch: 6 | loss: 0.5385867
	speed: 0.0095s/iter; left time: 11.1295s
	iters: 500, epoch: 6 | loss: 0.4135184
	speed: 0.0099s/iter; left time: 10.6191s
Updating learning rate to 1.29390050625e-05
Epoch: 6 cost time: 4.970482349395752
Epoch: 6, Steps: 523 | Train Loss: 0.5348277 Vali Loss: 0.2984435 Best vali loss: 0.2853682
	iters: 100, epoch: 7 | loss: 0.3547838
	speed: 0.0237s/iter; left time: 22.4006s
	iters: 200, epoch: 7 | loss: 0.4496416
	speed: 0.0094s/iter; left time: 7.9477s
	iters: 300, epoch: 7 | loss: 0.8965994
	speed: 0.0093s/iter; left time: 6.9117s
	iters: 400, epoch: 7 | loss: 0.5851727
	speed: 0.0100s/iter; left time: 6.4874s
	iters: 500, epoch: 7 | loss: 0.2271707
	speed: 0.0093s/iter; left time: 5.0742s
Updating learning rate to 6.46950253125e-06
Epoch: 7 cost time: 4.911306858062744
Epoch: 7, Steps: 523 | Train Loss: 0.5026736 Vali Loss: 0.2984093 Best vali loss: 0.2853682
	iters: 100, epoch: 8 | loss: 0.3288462
	speed: 0.0209s/iter; left time: 8.8787s
	iters: 200, epoch: 8 | loss: 0.3727694
	speed: 0.0078s/iter; left time: 2.5153s
	iters: 300, epoch: 8 | loss: 0.3293996
	speed: 0.0098s/iter; left time: 2.1940s
	iters: 400, epoch: 8 | loss: 0.2071004
	speed: 0.0093s/iter; left time: 1.1473s
	iters: 500, epoch: 8 | loss: 0.2947925
	speed: 0.0092s/iter; left time: 0.2217s
Updating learning rate to 3.234751265625e-06
Epoch: 8 cost time: 4.729336977005005
Epoch: 8, Steps: 523 | Train Loss: 0.3065816 Vali Loss: 0.2981305 Best vali loss: 0.2853682

best validation loss 0.2853681834026002

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014056124915, 'e_layers': 3, 'learning_rate': 0.0015629277393, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2810642
	speed: 0.0149s/iter; left time: 60.9747s
	iters: 200, epoch: 1 | loss: 0.4166788
	speed: 0.0088s/iter; left time: 35.1470s
	iters: 300, epoch: 1 | loss: 0.2841600
	speed: 0.0126s/iter; left time: 49.0689s
	iters: 400, epoch: 1 | loss: 0.5079507
	speed: 0.0138s/iter; left time: 52.2521s
	iters: 500, epoch: 1 | loss: 0.4427521
	speed: 0.0089s/iter; left time: 32.8813s
Updating learning rate to 0.0015629277393
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 5.821172475814819
Epoch: 1, Steps: 523 | Train Loss: 0.3865212 Vali Loss: 0.2849337 Best vali loss: 0.2849337
	iters: 100, epoch: 2 | loss: 1.6733617
	speed: 0.0262s/iter; left time: 93.4230s
	iters: 200, epoch: 2 | loss: 0.7438133
	speed: 0.0184s/iter; left time: 63.5301s
	iters: 300, epoch: 2 | loss: 0.3307163
	speed: 0.0169s/iter; left time: 56.9016s
	iters: 400, epoch: 2 | loss: 0.4772773
	speed: 0.0117s/iter; left time: 38.2649s
	iters: 500, epoch: 2 | loss: 0.6371682
	speed: 0.0092s/iter; left time: 29.1058s
Updating learning rate to 0.00078146386965
Epoch: 2 cost time: 6.915544748306274
Epoch: 2, Steps: 523 | Train Loss: 0.7724674 Vali Loss: 0.2877255 Best vali loss: 0.2849337
	iters: 100, epoch: 3 | loss: 0.6169015
	speed: 0.0175s/iter; left time: 53.1597s
	iters: 200, epoch: 3 | loss: 0.3874785
	speed: 0.0086s/iter; left time: 25.4202s
	iters: 300, epoch: 3 | loss: 0.3149959
	speed: 0.0075s/iter; left time: 21.2763s
	iters: 400, epoch: 3 | loss: 0.2857893
	speed: 0.0100s/iter; left time: 27.2856s
	iters: 500, epoch: 3 | loss: 0.2999380
	speed: 0.0115s/iter; left time: 30.3225s
Updating learning rate to 0.000390731934825
Epoch: 3 cost time: 4.891635894775391
Epoch: 3, Steps: 523 | Train Loss: 0.3810206 Vali Loss: 0.2865464 Best vali loss: 0.2849337
	iters: 100, epoch: 4 | loss: 0.4847447
	speed: 0.0237s/iter; left time: 59.7041s
	iters: 200, epoch: 4 | loss: 0.6365331
	speed: 0.0119s/iter; left time: 28.6416s
	iters: 300, epoch: 4 | loss: 0.3178841
	speed: 0.0088s/iter; left time: 20.3772s
	iters: 400, epoch: 4 | loss: 0.3070936
	speed: 0.0079s/iter; left time: 17.5677s
	iters: 500, epoch: 4 | loss: 0.4587933
	speed: 0.0114s/iter; left time: 24.1598s
Updating learning rate to 0.0001953659674125
Epoch: 4 cost time: 5.356375455856323
Epoch: 4, Steps: 523 | Train Loss: 0.4410098 Vali Loss: 0.2900956 Best vali loss: 0.2849337
	iters: 100, epoch: 5 | loss: 1.1053843
	speed: 0.0232s/iter; left time: 46.2028s
	iters: 200, epoch: 5 | loss: 0.2913359
	speed: 0.0110s/iter; left time: 20.7328s
	iters: 300, epoch: 5 | loss: 0.4414178
	speed: 0.0109s/iter; left time: 19.6179s
	iters: 400, epoch: 5 | loss: 0.7187369
	speed: 0.0110s/iter; left time: 18.5909s
	iters: 500, epoch: 5 | loss: 0.5152982
	speed: 0.0116s/iter; left time: 18.5417s
Updating learning rate to 9.768298370625e-05
Epoch: 5 cost time: 5.812340974807739
Epoch: 5, Steps: 523 | Train Loss: 0.6144346 Vali Loss: 0.2929612 Best vali loss: 0.2849337
	iters: 100, epoch: 6 | loss: 0.2871305
	speed: 0.0241s/iter; left time: 35.3606s
	iters: 200, epoch: 6 | loss: 0.3236515
	speed: 0.0099s/iter; left time: 13.6241s
	iters: 300, epoch: 6 | loss: 0.4590553
	speed: 0.0086s/iter; left time: 10.8886s
	iters: 400, epoch: 6 | loss: 0.3453333
	speed: 0.0087s/iter; left time: 10.1728s
	iters: 500, epoch: 6 | loss: 0.6280502
	speed: 0.0142s/iter; left time: 15.2075s
Updating learning rate to 4.8841491853125e-05
Epoch: 6 cost time: 5.531444311141968
Epoch: 6, Steps: 523 | Train Loss: 0.4086442 Vali Loss: 0.2951427 Best vali loss: 0.2849337
	iters: 100, epoch: 7 | loss: 0.7675110
	speed: 0.0257s/iter; left time: 24.3641s
	iters: 200, epoch: 7 | loss: 0.3721030
	speed: 0.0079s/iter; left time: 6.6584s
	iters: 300, epoch: 7 | loss: 0.2685328
	speed: 0.0088s/iter; left time: 6.5785s
	iters: 400, epoch: 7 | loss: 0.6962155
	speed: 0.0100s/iter; left time: 6.4969s
	iters: 500, epoch: 7 | loss: 0.6440271
	speed: 0.0106s/iter; left time: 5.8211s
Updating learning rate to 2.44207459265625e-05
Epoch: 7 cost time: 5.067001819610596
Epoch: 7, Steps: 523 | Train Loss: 0.5496779 Vali Loss: 0.2935948 Best vali loss: 0.2849337
	iters: 100, epoch: 8 | loss: 0.2122766
	speed: 0.0218s/iter; left time: 9.2639s
	iters: 200, epoch: 8 | loss: 0.3756041
	speed: 0.0097s/iter; left time: 3.1342s
	iters: 300, epoch: 8 | loss: 0.2082577
	speed: 0.0099s/iter; left time: 2.2109s
	iters: 400, epoch: 8 | loss: 0.6433975
	speed: 0.0101s/iter; left time: 1.2496s
	iters: 500, epoch: 8 | loss: 0.4143041
	speed: 0.0112s/iter; left time: 0.2677s
Updating learning rate to 1.221037296328125e-05
Epoch: 8 cost time: 5.373075485229492
Epoch: 8, Steps: 523 | Train Loss: 0.3707680 Vali Loss: 0.2948526 Best vali loss: 0.2849337

best validation loss 0.28493372723044585

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0082307106256, 'e_layers': 4, 'learning_rate': 0.0001197767682, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5548854
	speed: 0.0219s/iter; left time: 43.8138s
	iters: 200, epoch: 1 | loss: 0.4444077
	speed: 0.0158s/iter; left time: 29.9484s
Updating learning rate to 0.0001197767682
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 4.45598578453064
Epoch: 1, Steps: 262 | Train Loss: 0.4996466 Vali Loss: 0.2775733 Best vali loss: 0.2775733
	iters: 100, epoch: 2 | loss: 0.4707828
	speed: 0.0330s/iter; left time: 57.2696s
	iters: 200, epoch: 2 | loss: 0.6809680
	speed: 0.0159s/iter; left time: 26.0177s
Updating learning rate to 5.98883841e-05
Epoch: 2 cost time: 4.200446128845215
Epoch: 2, Steps: 262 | Train Loss: 0.5758754 Vali Loss: 0.2808309 Best vali loss: 0.2775733
	iters: 100, epoch: 3 | loss: 0.4569976
	speed: 0.0322s/iter; left time: 47.4210s
	iters: 200, epoch: 3 | loss: 0.3848781
	speed: 0.0141s/iter; left time: 19.4040s
Updating learning rate to 2.994419205e-05
Validation loss decreased (0.2776 --> 0.2749).  Saving model state dict ...
Epoch: 3 cost time: 3.880744457244873
Epoch: 3, Steps: 262 | Train Loss: 0.4209378 Vali Loss: 0.2748912 Best vali loss: 0.2748912

best validation loss 0.27489123478747957

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0110607816007, 'e_layers': 1, 'learning_rate': 0.00100171369, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3643027
	speed: 0.0126s/iter; left time: 51.6619s
	iters: 200, epoch: 1 | loss: 1.5756233
	speed: 0.0053s/iter; left time: 21.0065s
	iters: 300, epoch: 1 | loss: 0.7879465
	speed: 0.0050s/iter; left time: 19.4621s
	iters: 400, epoch: 1 | loss: 0.3834379
	speed: 0.0051s/iter; left time: 19.3689s
	iters: 500, epoch: 1 | loss: 0.5801784
	speed: 0.0058s/iter; left time: 21.3608s
Updating learning rate to 0.00100171369
Validation loss decreased (inf --> 0.2905).  Saving model state dict ...
Epoch: 1 cost time: 3.2154672145843506
Epoch: 1, Steps: 523 | Train Loss: 0.7382978 Vali Loss: 0.2904748 Best vali loss: 0.2904748
	iters: 100, epoch: 2 | loss: 0.5729307
	speed: 0.0159s/iter; left time: 56.7752s
	iters: 200, epoch: 2 | loss: 0.3697596
	speed: 0.0060s/iter; left time: 20.6829s
	iters: 300, epoch: 2 | loss: 0.5860412
	speed: 0.0054s/iter; left time: 18.0877s
	iters: 400, epoch: 2 | loss: 0.3898112
	speed: 0.0051s/iter; left time: 16.7871s
	iters: 500, epoch: 2 | loss: 0.8020924
	speed: 0.0061s/iter; left time: 19.1573s
Updating learning rate to 0.000500856845
Validation loss decreased (0.2905 --> 0.2855).  Saving model state dict ...
Epoch: 2 cost time: 3.0433619022369385
Epoch: 2, Steps: 523 | Train Loss: 0.5441270 Vali Loss: 0.2854816 Best vali loss: 0.2854816
	iters: 100, epoch: 3 | loss: 0.5692824
	speed: 0.0182s/iter; left time: 55.3943s
	iters: 200, epoch: 3 | loss: 0.2560313
	speed: 0.0066s/iter; left time: 19.3315s
	iters: 300, epoch: 3 | loss: 0.7520225
	speed: 0.0055s/iter; left time: 15.6393s
	iters: 400, epoch: 3 | loss: 0.4293235
	speed: 0.0051s/iter; left time: 14.1041s
	iters: 500, epoch: 3 | loss: 0.5058253
	speed: 0.0050s/iter; left time: 13.2533s
Updating learning rate to 0.0002504284225
Epoch: 3 cost time: 3.039560317993164
Epoch: 3, Steps: 523 | Train Loss: 0.5024970 Vali Loss: 0.2898122 Best vali loss: 0.2854816

best validation loss 0.28548162030703783

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0087628903501, 'e_layers': 3, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3721640
	speed: 0.0181s/iter; left time: 73.9790s
	iters: 200, epoch: 1 | loss: 0.5176541
	speed: 0.0099s/iter; left time: 39.4285s
	iters: 300, epoch: 1 | loss: 0.8516679
	speed: 0.0080s/iter; left time: 31.2203s
	iters: 400, epoch: 1 | loss: 0.4643083
	speed: 0.0089s/iter; left time: 33.7992s
	iters: 500, epoch: 1 | loss: 0.3170236
	speed: 0.0094s/iter; left time: 34.5939s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.3019).  Saving model state dict ...
Epoch: 1 cost time: 5.306781053543091
Epoch: 1, Steps: 523 | Train Loss: 0.5045636 Vali Loss: 0.3019158 Best vali loss: 0.3019158
	iters: 100, epoch: 2 | loss: 0.2934974
	speed: 0.0181s/iter; left time: 64.3982s
	iters: 200, epoch: 2 | loss: 0.3487303
	speed: 0.0093s/iter; left time: 32.2781s
	iters: 300, epoch: 2 | loss: 0.2305900
	speed: 0.0092s/iter; left time: 30.8120s
	iters: 400, epoch: 2 | loss: 0.8536751
	speed: 0.0080s/iter; left time: 25.9629s
	iters: 500, epoch: 2 | loss: 0.3378555
	speed: 0.0095s/iter; left time: 29.9117s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.3019 --> 0.2840).  Saving model state dict ...
Epoch: 2 cost time: 4.750753164291382
Epoch: 2, Steps: 523 | Train Loss: 0.4128697 Vali Loss: 0.2839971 Best vali loss: 0.2839971
	iters: 100, epoch: 3 | loss: 0.3701063
	speed: 0.0185s/iter; left time: 56.1601s
	iters: 200, epoch: 3 | loss: 0.3272740
	speed: 0.0079s/iter; left time: 23.2544s
	iters: 300, epoch: 3 | loss: 0.7135931
	speed: 0.0090s/iter; left time: 25.4121s
	iters: 400, epoch: 3 | loss: 0.6513050
	speed: 0.0088s/iter; left time: 24.0213s
	iters: 500, epoch: 3 | loss: 0.6619039
	speed: 0.0085s/iter; left time: 22.4995s
Updating learning rate to 0.0008955266062
Epoch: 3 cost time: 4.483199834823608
Epoch: 3, Steps: 523 | Train Loss: 0.5448365 Vali Loss: 0.2937759 Best vali loss: 0.2839971

best validation loss 0.28399707325420753

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0082307106256, 'e_layers': 4, 'learning_rate': 0.0001197767682, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4497970
	speed: 0.0221s/iter; left time: 26.8027s
	iters: 200, epoch: 4 | loss: 0.3252155
	speed: 0.0144s/iter; left time: 15.9540s
Updating learning rate to 1.4972096025e-05
Epoch: 4 cost time: 4.171470403671265
Epoch: 4, Steps: 262 | Train Loss: 0.3875063 Vali Loss: 0.2982814 Best vali loss: 0.2748912
	iters: 100, epoch: 5 | loss: 0.4208195
	speed: 0.0353s/iter; left time: 33.5336s
	iters: 200, epoch: 5 | loss: 0.4897829
	speed: 0.0151s/iter; left time: 12.8039s
Updating learning rate to 7.4860480125e-06
Epoch: 5 cost time: 3.9864072799682617
Epoch: 5, Steps: 262 | Train Loss: 0.4553012 Vali Loss: 0.3054647 Best vali loss: 0.2748912
	iters: 100, epoch: 6 | loss: 0.4202884
	speed: 0.0330s/iter; left time: 22.7047s
	iters: 200, epoch: 6 | loss: 0.3692680
	speed: 0.0164s/iter; left time: 9.6509s
Updating learning rate to 3.74302400625e-06
Epoch: 6 cost time: 4.2095420360565186
Epoch: 6, Steps: 262 | Train Loss: 0.3947782 Vali Loss: 0.3104367 Best vali loss: 0.2748912
	iters: 100, epoch: 7 | loss: 0.4230706
	speed: 0.0397s/iter; left time: 16.8746s
	iters: 200, epoch: 7 | loss: 0.3836343
	speed: 0.0152s/iter; left time: 4.9412s
Updating learning rate to 1.871512003125e-06
Epoch: 7 cost time: 4.088259220123291
Epoch: 7, Steps: 262 | Train Loss: 0.4033525 Vali Loss: 0.3046765 Best vali loss: 0.2748912
	iters: 100, epoch: 8 | loss: 0.3442169
	speed: 0.0330s/iter; left time: 5.3798s
	iters: 200, epoch: 8 | loss: 0.5791783
	speed: 0.0105s/iter; left time: 0.6619s
Updating learning rate to 9.357560015625e-07
Epoch: 8 cost time: 3.467813491821289
Epoch: 8, Steps: 262 | Train Loss: 0.4616976 Vali Loss: 0.3053281 Best vali loss: 0.2748912

best validation loss 0.27489123478747957

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 1.024587631225586
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2823039 Best vali loss: 0.2823039
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 0.8385183811187744
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2877063 Best vali loss: 0.2823039
Updating learning rate to 0.0008072813968307993
Epoch: 3 cost time: 0.8445825576782227
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905602 Best vali loss: 0.2823039
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 1.7914557456970215
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2929555 Best vali loss: 0.2823039
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 1.9308974742889404
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2951934 Best vali loss: 0.2823039
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 2.9802510738372803
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2968102 Best vali loss: 0.2823039
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 2.047839403152466
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2942502 Best vali loss: 0.2823039
Updating learning rate to 0.0
Epoch: 8 cost time: 2.0552995204925537
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2953185 Best vali loss: 0.2823039

best validation loss 0.28230392111637814

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038379895579, 'e_layers': 1, 'learning_rate': 0.0001397793585, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3251513
	speed: 0.0346s/iter; left time: 32.8230s
Updating learning rate to 0.0001344593234428538
Validation loss decreased (inf --> 0.2950).  Saving model state dict ...
Epoch: 1 cost time: 3.8601138591766357
Epoch: 1, Steps: 131 | Train Loss: 0.3251513 Vali Loss: 0.2949690 Best vali loss: 0.2949690
	iters: 100, epoch: 2 | loss: 0.4791688
	speed: 0.0451s/iter; left time: 36.9085s
Updating learning rate to 0.00011930914538262775
Validation loss decreased (0.2950 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 2.973738431930542
Epoch: 2, Steps: 131 | Train Loss: 0.4791688 Vali Loss: 0.2837235 Best vali loss: 0.2837235
	iters: 100, epoch: 3 | loss: 0.4269997
	speed: 0.0331s/iter; left time: 22.7117s
Updating learning rate to 9.66353015922852e-05
Validation loss decreased (0.2837 --> 0.2814).  Saving model state dict ...
Epoch: 3 cost time: 2.6500120162963867
Epoch: 3, Steps: 131 | Train Loss: 0.4269997 Vali Loss: 0.2814391 Best vali loss: 0.2814391
	iters: 100, epoch: 4 | loss: 0.7692505
	speed: 0.0626s/iter; left time: 34.8285s
Updating learning rate to 6.988967925e-05
Validation loss decreased (0.2814 --> 0.2802).  Saving model state dict ...
Epoch: 4 cost time: 3.6770055294036865
Epoch: 4, Steps: 131 | Train Loss: 0.7692505 Vali Loss: 0.2802462 Best vali loss: 0.2802462
	iters: 100, epoch: 5 | loss: 0.3241600
	speed: 0.0478s/iter; left time: 20.3232s
Updating learning rate to 4.314405690771481e-05
Epoch: 5 cost time: 2.772932767868042
Epoch: 5, Steps: 131 | Train Loss: 0.3241600 Vali Loss: 0.2809059 Best vali loss: 0.2802462
	iters: 100, epoch: 6 | loss: 0.5409781
	speed: 0.0319s/iter; left time: 9.3835s
Updating learning rate to 2.0470213117372266e-05
Epoch: 6 cost time: 2.970669746398926
Epoch: 6, Steps: 131 | Train Loss: 0.5409781 Vali Loss: 0.2805542 Best vali loss: 0.2802462
	iters: 100, epoch: 7 | loss: 0.4678471
	speed: 0.0387s/iter; left time: 6.3159s
Updating learning rate to 5.320035057146223e-06
Epoch: 7 cost time: 2.1919965744018555
Epoch: 7, Steps: 131 | Train Loss: 0.4678471 Vali Loss: 0.2809216 Best vali loss: 0.2802462
	iters: 100, epoch: 8 | loss: 0.6834204
	speed: 0.0362s/iter; left time: 1.1593s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0147573947906494
Epoch: 8, Steps: 131 | Train Loss: 0.6834204 Vali Loss: 0.2808573 Best vali loss: 0.2802462

best validation loss 0.2802461643740341

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0086705089208, 'e_layers': 1, 'learning_rate': 0.001895542568, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001823397774789542
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 2.0432751178741455
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2875308 Best vali loss: 0.2875308
Updating learning rate to 0.001617946785930281
Epoch: 2 cost time: 2.184849262237549
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3006581 Best vali loss: 0.2875308
Updating learning rate to 0.0013104676520581883
Epoch: 3 cost time: 1.9978981018066406
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2912977 Best vali loss: 0.2875308

best validation loss 0.2875307617621069

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0099940022847, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5466457
	speed: 0.0113s/iter; left time: 46.1732s
	iters: 200, epoch: 1 | loss: 1.3152670
	speed: 0.0049s/iter; left time: 19.5286s
	iters: 300, epoch: 1 | loss: 0.3335827
	speed: 0.0059s/iter; left time: 23.0369s
	iters: 400, epoch: 1 | loss: 0.6934057
	speed: 0.0070s/iter; left time: 26.4984s
	iters: 500, epoch: 1 | loss: 0.8016296
	speed: 0.0095s/iter; left time: 34.9098s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.2948).  Saving model state dict ...
Epoch: 1 cost time: 3.7235867977142334
Epoch: 1, Steps: 523 | Train Loss: 0.7381061 Vali Loss: 0.2947849 Best vali loss: 0.2947849
	iters: 100, epoch: 2 | loss: 0.3704777
	speed: 0.0179s/iter; left time: 63.7874s
	iters: 200, epoch: 2 | loss: 0.2566240
	speed: 0.0077s/iter; left time: 26.7451s
	iters: 300, epoch: 2 | loss: 0.5106555
	speed: 0.0075s/iter; left time: 25.2810s
	iters: 400, epoch: 2 | loss: 0.6422781
	speed: 0.0083s/iter; left time: 26.9136s
	iters: 500, epoch: 2 | loss: 0.5241716
	speed: 0.0085s/iter; left time: 26.8277s
Updating learning rate to 0.0006629438250964442
Validation loss decreased (0.2948 --> 0.2889).  Saving model state dict ...
Epoch: 2 cost time: 4.172748565673828
Epoch: 2, Steps: 523 | Train Loss: 0.4608414 Vali Loss: 0.2889116 Best vali loss: 0.2889116
	iters: 100, epoch: 3 | loss: 0.6225083
	speed: 0.0141s/iter; left time: 43.0002s
	iters: 200, epoch: 3 | loss: 0.2979498
	speed: 0.0043s/iter; left time: 12.7576s
	iters: 300, epoch: 3 | loss: 0.3136281
	speed: 0.0042s/iter; left time: 11.9871s
	iters: 400, epoch: 3 | loss: 0.6972926
	speed: 0.0050s/iter; left time: 13.6097s
	iters: 500, epoch: 3 | loss: 0.9469702
	speed: 0.0069s/iter; left time: 18.1056s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 2.8660025596618652
Epoch: 3, Steps: 523 | Train Loss: 0.5756698 Vali Loss: 0.2902402 Best vali loss: 0.2889116

best validation loss 0.28891156822188097

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 2, 'learning_rate': 0.0021579133057, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7075046
	speed: 0.0289s/iter; left time: 27.4044s
Updating learning rate to 0.0021579133057
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 3.324821949005127
Epoch: 1, Steps: 131 | Train Loss: 0.7075046 Vali Loss: 0.2860386 Best vali loss: 0.2860386
	iters: 100, epoch: 2 | loss: 0.3027269
	speed: 0.0520s/iter; left time: 42.5574s
Updating learning rate to 0.00107895665285
Epoch: 2 cost time: 4.138957262039185
Epoch: 2, Steps: 131 | Train Loss: 0.3027269 Vali Loss: 0.2881358 Best vali loss: 0.2860386
	iters: 100, epoch: 3 | loss: 0.4403359
	speed: 0.0574s/iter; left time: 39.4638s
Updating learning rate to 0.000539478326425
Epoch: 3 cost time: 2.7780275344848633
Epoch: 3, Steps: 131 | Train Loss: 0.4403359 Vali Loss: 0.2924905 Best vali loss: 0.2860386

best validation loss 0.2860386036904428

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 2, 'learning_rate': 0.0021579133057, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5841264
	speed: 0.0201s/iter; left time: 11.1940s
Updating learning rate to 0.0002697391632125
Epoch: 4 cost time: 2.243670701980591
Epoch: 4, Steps: 131 | Train Loss: 0.5841264 Vali Loss: 0.2989161 Best vali loss: 0.2860386
	iters: 100, epoch: 5 | loss: 0.2899352
	speed: 0.0302s/iter; left time: 12.8144s
Updating learning rate to 0.00013486958160625
Epoch: 5 cost time: 1.4663441181182861
Epoch: 5, Steps: 131 | Train Loss: 0.2899352 Vali Loss: 0.3029822 Best vali loss: 0.2860386
	iters: 100, epoch: 6 | loss: 0.3912718
	speed: 0.0148s/iter; left time: 4.3644s
Updating learning rate to 6.7434790803125e-05
Epoch: 6 cost time: 1.6052207946777344
Epoch: 6, Steps: 131 | Train Loss: 0.3912718 Vali Loss: 0.3038169 Best vali loss: 0.2860386
	iters: 100, epoch: 7 | loss: 0.4729011
	speed: 0.0282s/iter; left time: 4.5909s
Updating learning rate to 3.37173954015625e-05
Epoch: 7 cost time: 2.3284554481506348
Epoch: 7, Steps: 131 | Train Loss: 0.4729011 Vali Loss: 0.3052050 Best vali loss: 0.2860386
	iters: 100, epoch: 8 | loss: 0.5697712
	speed: 0.0288s/iter; left time: 0.9220s
Updating learning rate to 1.685869770078125e-05
Epoch: 8 cost time: 1.9330871105194092
Epoch: 8, Steps: 131 | Train Loss: 0.5697712 Vali Loss: 0.3022673 Best vali loss: 0.2860386

best validation loss 0.2860386036904428

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 3, 'learning_rate': 0.0004993756848, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4549403
	speed: 0.0204s/iter; left time: 40.6990s
	iters: 200, epoch: 1 | loss: 0.3701052
	speed: 0.0133s/iter; left time: 25.2603s
Updating learning rate to 0.0004993756848
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 3.6425669193267822
Epoch: 1, Steps: 262 | Train Loss: 0.4125228 Vali Loss: 0.2827912 Best vali loss: 0.2827912
	iters: 100, epoch: 2 | loss: 0.6754558
	speed: 0.0225s/iter; left time: 38.9509s
	iters: 200, epoch: 2 | loss: 0.3563895
	speed: 0.0095s/iter; left time: 15.5728s
Updating learning rate to 0.0002496878424
Epoch: 2 cost time: 2.4755237102508545
Epoch: 2, Steps: 262 | Train Loss: 0.5159227 Vali Loss: 0.2847284 Best vali loss: 0.2827912
	iters: 100, epoch: 3 | loss: 0.4652225
	speed: 0.0153s/iter; left time: 22.5465s
	iters: 200, epoch: 3 | loss: 0.3446436
	speed: 0.0098s/iter; left time: 13.4750s
Updating learning rate to 0.0001248439212
Epoch: 3 cost time: 2.451336622238159
Epoch: 3, Steps: 262 | Train Loss: 0.4049331 Vali Loss: 0.2842236 Best vali loss: 0.2827912
	iters: 100, epoch: 4 | loss: 0.5487347
	speed: 0.0299s/iter; left time: 36.1814s
	iters: 200, epoch: 4 | loss: 0.3766049
	speed: 0.0108s/iter; left time: 11.9926s
Updating learning rate to 6.24219606e-05
Epoch: 4 cost time: 2.819723606109619
Epoch: 4, Steps: 262 | Train Loss: 0.4626698 Vali Loss: 0.2860326 Best vali loss: 0.2827912
	iters: 100, epoch: 5 | loss: 0.3710603
	speed: 0.0263s/iter; left time: 24.9155s
	iters: 200, epoch: 5 | loss: 0.5234948
	speed: 0.0089s/iter; left time: 7.5448s
Updating learning rate to 3.12109803e-05
Epoch: 5 cost time: 2.588228225708008
Epoch: 5, Steps: 262 | Train Loss: 0.4472775 Vali Loss: 0.2876905 Best vali loss: 0.2827912
	iters: 100, epoch: 6 | loss: 0.2666033
	speed: 0.0192s/iter; left time: 13.1999s
	iters: 200, epoch: 6 | loss: 0.3454021
	speed: 0.0081s/iter; left time: 4.7301s
Updating learning rate to 1.560549015e-05
Epoch: 6 cost time: 2.148524761199951
Epoch: 6, Steps: 262 | Train Loss: 0.3060027 Vali Loss: 0.2880016 Best vali loss: 0.2827912
	iters: 100, epoch: 7 | loss: 0.4881165
	speed: 0.0176s/iter; left time: 7.4870s
	iters: 200, epoch: 7 | loss: 0.6629294
	speed: 0.0079s/iter; left time: 2.5747s
Updating learning rate to 7.802745075e-06
Epoch: 7 cost time: 2.136068344116211
Epoch: 7, Steps: 262 | Train Loss: 0.5755229 Vali Loss: 0.2881700 Best vali loss: 0.2827912
	iters: 100, epoch: 8 | loss: 0.5843940
	speed: 0.0177s/iter; left time: 2.8885s
	iters: 200, epoch: 8 | loss: 0.2970414
	speed: 0.0080s/iter; left time: 0.5049s
Updating learning rate to 3.9013725375e-06
Epoch: 8 cost time: 2.1218457221984863
Epoch: 8, Steps: 262 | Train Loss: 0.4407177 Vali Loss: 0.2887397 Best vali loss: 0.2827912

best validation loss 0.2827912434664035

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5135518
	speed: 0.0163s/iter; left time: 15.4758s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.6317977905273438
Epoch: 1, Steps: 131 | Train Loss: 0.5135518 Vali Loss: 0.2873531 Best vali loss: 0.2873531
	iters: 100, epoch: 2 | loss: 0.3462625
	speed: 0.0160s/iter; left time: 13.0908s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.2874 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 1.271465539932251
Epoch: 2, Steps: 131 | Train Loss: 0.3462625 Vali Loss: 0.2829465 Best vali loss: 0.2829465
	iters: 100, epoch: 3 | loss: 0.4458885
	speed: 0.0158s/iter; left time: 10.8455s
Updating learning rate to 0.000178512795825
Epoch: 3 cost time: 1.293686866760254
Epoch: 3, Steps: 131 | Train Loss: 0.4458885 Vali Loss: 0.2830954 Best vali loss: 0.2829465
	iters: 100, epoch: 4 | loss: 0.4997855
	speed: 0.0151s/iter; left time: 8.3981s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 1.273024559020996
Epoch: 4, Steps: 131 | Train Loss: 0.4997855 Vali Loss: 0.2906327 Best vali loss: 0.2829465
	iters: 100, epoch: 5 | loss: 0.3238942
	speed: 0.0161s/iter; left time: 6.8615s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 1.3674302101135254
Epoch: 5, Steps: 131 | Train Loss: 0.3238942 Vali Loss: 0.2876046 Best vali loss: 0.2829465
	iters: 100, epoch: 6 | loss: 0.5614570
	speed: 0.0219s/iter; left time: 6.4280s
Updating learning rate to 2.2314099478125e-05
Epoch: 6 cost time: 1.5127885341644287
Epoch: 6, Steps: 131 | Train Loss: 0.5614570 Vali Loss: 0.2881716 Best vali loss: 0.2829465
	iters: 100, epoch: 7 | loss: 0.4734257
	speed: 0.0146s/iter; left time: 2.3734s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 1.1498801708221436
Epoch: 7, Steps: 131 | Train Loss: 0.4734257 Vali Loss: 0.2874254 Best vali loss: 0.2829465
	iters: 100, epoch: 8 | loss: 0.2365951
	speed: 0.0155s/iter; left time: 0.4965s
Updating learning rate to 5.57852486953125e-06
Epoch: 8 cost time: 1.3160359859466553
Epoch: 8, Steps: 131 | Train Loss: 0.2365951 Vali Loss: 0.2890414 Best vali loss: 0.2829465

best validation loss 0.28294653935630154

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013811676972, 'e_layers': 3, 'learning_rate': 0.0001462790729, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5813162
	speed: 0.0151s/iter; left time: 61.7506s
	iters: 200, epoch: 1 | loss: 0.3857034
	speed: 0.0086s/iter; left time: 34.2627s
	iters: 300, epoch: 1 | loss: 0.8069265
	speed: 0.0086s/iter; left time: 33.3586s
	iters: 400, epoch: 1 | loss: 0.8717328
	speed: 0.0083s/iter; left time: 31.6000s
	iters: 500, epoch: 1 | loss: 0.5422056
	speed: 0.0090s/iter; left time: 33.0002s
Updating learning rate to 0.0001407116571935182
Validation loss decreased (inf --> 0.3004).  Saving model state dict ...
Epoch: 1 cost time: 4.8844122886657715
Epoch: 1, Steps: 523 | Train Loss: 0.6375769 Vali Loss: 0.3004046 Best vali loss: 0.3004046
	iters: 100, epoch: 2 | loss: 0.3230092
	speed: 0.0196s/iter; left time: 69.8371s
	iters: 200, epoch: 2 | loss: 0.7345992
	speed: 0.0093s/iter; left time: 32.1786s
	iters: 300, epoch: 2 | loss: 0.3573859
	speed: 0.0092s/iter; left time: 30.8533s
	iters: 400, epoch: 2 | loss: 0.3962902
	speed: 0.0088s/iter; left time: 28.7000s
	iters: 500, epoch: 2 | loss: 0.2625223
	speed: 0.0073s/iter; left time: 23.0115s
Updating learning rate to 0.00012485699864663567
Validation loss decreased (0.3004 --> 0.2894).  Saving model state dict ...
Epoch: 2 cost time: 4.5674543380737305
Epoch: 2, Steps: 523 | Train Loss: 0.4147613 Vali Loss: 0.2893552 Best vali loss: 0.2893552
	iters: 100, epoch: 3 | loss: 0.4280881
	speed: 0.0183s/iter; left time: 55.5526s
	iters: 200, epoch: 3 | loss: 0.8986645
	speed: 0.0089s/iter; left time: 26.0793s
	iters: 300, epoch: 3 | loss: 0.6419613
	speed: 0.0089s/iter; left time: 25.2976s
	iters: 400, epoch: 3 | loss: 0.3099361
	speed: 0.0087s/iter; left time: 23.7697s
	iters: 500, epoch: 3 | loss: 0.5296382
	speed: 0.0085s/iter; left time: 22.4952s
Updating learning rate to 0.00010112882530027759
Validation loss decreased (0.2894 --> 0.2883).  Saving model state dict ...
Epoch: 3 cost time: 4.627696752548218
Epoch: 3, Steps: 523 | Train Loss: 0.5616576 Vali Loss: 0.2883487 Best vali loss: 0.2883487

best validation loss 0.28834874216465756

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0086816738717, 'e_layers': 4, 'learning_rate': 0.0022760992484, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4764237
	speed: 0.0253s/iter; left time: 24.0474s
Updating learning rate to 0.0022760992484
Validation loss decreased (inf --> 0.3313).  Saving model state dict ...
Epoch: 1 cost time: 2.8281264305114746
Epoch: 1, Steps: 131 | Train Loss: 0.4764237 Vali Loss: 0.3312928 Best vali loss: 0.3312928
	iters: 100, epoch: 2 | loss: 0.6240935
	speed: 0.0302s/iter; left time: 24.7229s
Updating learning rate to 0.0011380496242
Epoch: 2 cost time: 2.54019832611084
Epoch: 2, Steps: 131 | Train Loss: 0.6240935 Vali Loss: 0.3434435 Best vali loss: 0.3312928
	iters: 100, epoch: 3 | loss: 0.6447335
	speed: 0.0293s/iter; left time: 20.1240s
Updating learning rate to 0.0005690248121
Validation loss decreased (0.3313 --> 0.3195).  Saving model state dict ...
Epoch: 3 cost time: 2.5101828575134277
Epoch: 3, Steps: 131 | Train Loss: 0.6447335 Vali Loss: 0.3195195 Best vali loss: 0.3195195

best validation loss 0.3195195112165442

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0023614640101, 'e_layers': 2, 'learning_rate': 0.0023884990953, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8039168
	speed: 0.0147s/iter; left time: 13.9268s
Updating learning rate to 0.0023884990953
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 1.4357290267944336
Epoch: 1, Steps: 131 | Train Loss: 0.8039168 Vali Loss: 0.2877264 Best vali loss: 0.2877264
	iters: 100, epoch: 2 | loss: 0.3907665
	speed: 0.0152s/iter; left time: 12.4686s
Updating learning rate to 0.00119424954765
Epoch: 2 cost time: 1.3604872226715088
Epoch: 2, Steps: 131 | Train Loss: 0.3907665 Vali Loss: 0.2919609 Best vali loss: 0.2877264
	iters: 100, epoch: 3 | loss: 0.4716012
	speed: 0.0211s/iter; left time: 14.4773s
Updating learning rate to 0.000597124773825
Epoch: 3 cost time: 1.6027522087097168
Epoch: 3, Steps: 131 | Train Loss: 0.4716012 Vali Loss: 0.2981780 Best vali loss: 0.2877264

best validation loss 0.2877263976666244

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0023614640101, 'e_layers': 2, 'learning_rate': 0.0023884990953, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7105156
	speed: 0.0278s/iter; left time: 15.4716s
Updating learning rate to 0.0002985623869125
Epoch: 4 cost time: 3.3708620071411133
Epoch: 4, Steps: 131 | Train Loss: 0.7105156 Vali Loss: 0.3065302 Best vali loss: 0.2877264
	iters: 100, epoch: 5 | loss: 0.3284230
	speed: 0.0594s/iter; left time: 25.2306s
Updating learning rate to 0.00014928119345625
Epoch: 5 cost time: 3.616276264190674
Epoch: 5, Steps: 131 | Train Loss: 0.3284230 Vali Loss: 0.3022399 Best vali loss: 0.2877264
	iters: 100, epoch: 6 | loss: 0.4121144
	speed: 0.0455s/iter; left time: 13.3868s
Updating learning rate to 7.4640596728125e-05
Epoch: 6 cost time: 3.4555633068084717
Epoch: 6, Steps: 131 | Train Loss: 0.4121144 Vali Loss: 0.3092858 Best vali loss: 0.2877264
	iters: 100, epoch: 7 | loss: 0.3881090
	speed: 0.0614s/iter; left time: 10.0085s
Updating learning rate to 3.73202983640625e-05
Epoch: 7 cost time: 4.177386283874512
Epoch: 7, Steps: 131 | Train Loss: 0.3881090 Vali Loss: 0.3103537 Best vali loss: 0.2877264
	iters: 100, epoch: 8 | loss: 0.6673785
	speed: 0.0484s/iter; left time: 1.5481s
Updating learning rate to 1.866014918203125e-05
Epoch: 8 cost time: 3.2302777767181396
Epoch: 8, Steps: 131 | Train Loss: 0.6673785 Vali Loss: 0.3105867 Best vali loss: 0.2877264

best validation loss 0.2877263976666244

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0047585328591, 'e_layers': 2, 'learning_rate': 0.0016469621721, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5770925
	speed: 0.0359s/iter; left time: 34.0740s
Updating learning rate to 0.0015842784068617606
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 4.245961427688599
Epoch: 1, Steps: 131 | Train Loss: 0.5770925 Vali Loss: 0.2847346 Best vali loss: 0.2847346
	iters: 100, epoch: 2 | loss: 0.6336740
	speed: 0.0537s/iter; left time: 43.9565s
Updating learning rate to 0.0014057701461748177
Validation loss decreased (0.2847 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 2.9824986457824707
Epoch: 2, Steps: 131 | Train Loss: 0.6336740 Vali Loss: 0.2818243 Best vali loss: 0.2818243
	iters: 100, epoch: 3 | loss: 0.2929643
	speed: 0.0515s/iter; left time: 35.3695s
Updating learning rate to 0.001138613654547346
Epoch: 3 cost time: 3.7409393787384033
Epoch: 3, Steps: 131 | Train Loss: 0.2929643 Vali Loss: 0.2940651 Best vali loss: 0.2818243
	iters: 100, epoch: 4 | loss: 0.6256769
	speed: 0.0526s/iter; left time: 29.2660s
Updating learning rate to 0.00082348108605
Epoch: 4 cost time: 3.1922154426574707
Epoch: 4, Steps: 131 | Train Loss: 0.6256769 Vali Loss: 0.2889912 Best vali loss: 0.2818243
	iters: 100, epoch: 5 | loss: 0.6591509
	speed: 0.0325s/iter; left time: 13.8151s
Updating learning rate to 0.0005083485175526542
Epoch: 5 cost time: 1.9646153450012207
Epoch: 5, Steps: 131 | Train Loss: 0.6591509 Vali Loss: 0.2911607 Best vali loss: 0.2818243
	iters: 100, epoch: 6 | loss: 0.3780033
	speed: 0.0265s/iter; left time: 7.8010s
Updating learning rate to 0.00024119202592518218
Epoch: 6 cost time: 1.7336149215698242
Epoch: 6, Steps: 131 | Train Loss: 0.3780033 Vali Loss: 0.2947736 Best vali loss: 0.2818243
	iters: 100, epoch: 7 | loss: 0.6058816
	speed: 0.0137s/iter; left time: 2.2272s
Updating learning rate to 6.268376523823931e-05
Epoch: 7 cost time: 0.9266293048858643
Epoch: 7, Steps: 131 | Train Loss: 0.6058816 Vali Loss: 0.2961553 Best vali loss: 0.2818243
	iters: 100, epoch: 8 | loss: 0.5195415
	speed: 0.0140s/iter; left time: 0.4485s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1359193325042725
Epoch: 8, Steps: 131 | Train Loss: 0.5195415 Vali Loss: 0.2990167 Best vali loss: 0.2818243

best validation loss 0.28182427379811464

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0026430019283, 'e_layers': 4, 'learning_rate': 0.0001947032118, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6138128
	speed: 0.0217s/iter; left time: 20.6033s
Updating learning rate to 0.00018729276204811502
Validation loss decreased (inf --> 0.2951).  Saving model state dict ...
Epoch: 1 cost time: 2.3343827724456787
Epoch: 1, Steps: 131 | Train Loss: 0.6138128 Vali Loss: 0.2951437 Best vali loss: 0.2951437
	iters: 100, epoch: 2 | loss: 0.6540369
	speed: 0.0207s/iter; left time: 16.9637s
Updating learning rate to 0.0001661895865912903
Validation loss decreased (0.2951 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 1.380336046218872
Epoch: 2, Steps: 131 | Train Loss: 0.6540369 Vali Loss: 0.2842681 Best vali loss: 0.2842681
	iters: 100, epoch: 3 | loss: 0.5229208
	speed: 0.0180s/iter; left time: 12.3761s
Updating learning rate to 0.00013460645259206553
Validation loss decreased (0.2843 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 1.6495640277862549
Epoch: 3, Steps: 131 | Train Loss: 0.5229208 Vali Loss: 0.2823101 Best vali loss: 0.2823101
	iters: 100, epoch: 4 | loss: 0.4206659
	speed: 0.0233s/iter; left time: 12.9549s
Updating learning rate to 9.73516059e-05
Epoch: 4 cost time: 1.9905221462249756
Epoch: 4, Steps: 131 | Train Loss: 0.4206659 Vali Loss: 0.2826002 Best vali loss: 0.2823101
	iters: 100, epoch: 5 | loss: 0.8143629
	speed: 0.0286s/iter; left time: 12.1739s
Updating learning rate to 6.009675920793448e-05
Validation loss decreased (0.2823 --> 0.2815).  Saving model state dict ...
Epoch: 5 cost time: 2.671532154083252
Epoch: 5, Steps: 131 | Train Loss: 0.8143629 Vali Loss: 0.2815353 Best vali loss: 0.2815353
	iters: 100, epoch: 6 | loss: 0.5324011
	speed: 0.0304s/iter; left time: 8.9440s
Updating learning rate to 2.8513625208709697e-05
Epoch: 6 cost time: 1.7286052703857422
Epoch: 6, Steps: 131 | Train Loss: 0.5324011 Vali Loss: 0.2834115 Best vali loss: 0.2815353
	iters: 100, epoch: 7 | loss: 0.5630283
	speed: 0.0235s/iter; left time: 3.8373s
Updating learning rate to 7.410449751884976e-06
Epoch: 7 cost time: 1.8303391933441162
Epoch: 7, Steps: 131 | Train Loss: 0.5630283 Vali Loss: 0.2829614 Best vali loss: 0.2815353
	iters: 100, epoch: 8 | loss: 0.4041782
	speed: 0.0226s/iter; left time: 0.7245s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8031225204467773
Epoch: 8, Steps: 131 | Train Loss: 0.4041782 Vali Loss: 0.2831886 Best vali loss: 0.2815353

best validation loss 0.28153533408437

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0106385904811, 'e_layers': 4, 'learning_rate': 0.0010806200869, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2406406
	speed: 0.0217s/iter; left time: 88.5534s
	iters: 200, epoch: 1 | loss: 0.4288209
	speed: 0.0084s/iter; left time: 33.2996s
	iters: 300, epoch: 1 | loss: 0.5608952
	speed: 0.0094s/iter; left time: 36.4578s
	iters: 400, epoch: 1 | loss: 0.4522663
	speed: 0.0134s/iter; left time: 50.5370s
	iters: 500, epoch: 1 | loss: 0.7132068
	speed: 0.0130s/iter; left time: 48.0556s
Updating learning rate to 0.001039491433803739
Validation loss decreased (inf --> 0.2894).  Saving model state dict ...
Epoch: 1 cost time: 6.688341379165649
Epoch: 1, Steps: 523 | Train Loss: 0.4791660 Vali Loss: 0.2894088 Best vali loss: 0.2894088
	iters: 100, epoch: 2 | loss: 0.2745424
	speed: 0.0237s/iter; left time: 84.5383s
	iters: 200, epoch: 2 | loss: 0.9480042
	speed: 0.0085s/iter; left time: 29.3373s
	iters: 300, epoch: 2 | loss: 0.6125105
	speed: 0.0091s/iter; left time: 30.5447s
	iters: 400, epoch: 2 | loss: 0.4424109
	speed: 0.0101s/iter; left time: 33.0785s
	iters: 500, epoch: 2 | loss: 0.8602931
	speed: 0.0105s/iter; left time: 33.1055s
Updating learning rate to 0.0009223669391166931
Validation loss decreased (0.2894 --> 0.2893).  Saving model state dict ...
Epoch: 2 cost time: 4.967828273773193
Epoch: 2, Steps: 523 | Train Loss: 0.6275522 Vali Loss: 0.2893478 Best vali loss: 0.2893478
	iters: 100, epoch: 3 | loss: 0.2559655
	speed: 0.0205s/iter; left time: 62.1584s
	iters: 200, epoch: 3 | loss: 0.7659420
	speed: 0.0077s/iter; left time: 22.6604s
	iters: 300, epoch: 3 | loss: 0.5256881
	speed: 0.0086s/iter; left time: 24.3575s
	iters: 400, epoch: 3 | loss: 0.4609388
	speed: 0.0108s/iter; left time: 29.4519s
	iters: 500, epoch: 3 | loss: 0.7603780
	speed: 0.0105s/iter; left time: 27.5855s
Updating learning rate to 0.0007470777454187768
Validation loss decreased (0.2893 --> 0.2845).  Saving model state dict ...
Epoch: 3 cost time: 4.986117124557495
Epoch: 3, Steps: 523 | Train Loss: 0.5537825 Vali Loss: 0.2845253 Best vali loss: 0.2845253

best validation loss 0.28452529850204267

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0016826337275, 'e_layers': 1, 'learning_rate': 0.0003986224328, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6865205
	speed: 0.0100s/iter; left time: 19.9345s
	iters: 200, epoch: 1 | loss: 0.8447506
	speed: 0.0037s/iter; left time: 7.0867s
Updating learning rate to 0.0003986224328
Validation loss decreased (inf --> 0.2830).  Saving model state dict ...
Epoch: 1 cost time: 1.317840814590454
Epoch: 1, Steps: 262 | Train Loss: 0.7656356 Vali Loss: 0.2829800 Best vali loss: 0.2829800
	iters: 100, epoch: 2 | loss: 0.4512437
	speed: 0.0129s/iter; left time: 22.4293s
	iters: 200, epoch: 2 | loss: 0.4368513
	speed: 0.0056s/iter; left time: 9.0822s
Updating learning rate to 0.0001993112164
Epoch: 2 cost time: 1.5659191608428955
Epoch: 2, Steps: 262 | Train Loss: 0.4440475 Vali Loss: 0.2925450 Best vali loss: 0.2829800
	iters: 100, epoch: 3 | loss: 0.3521285
	speed: 0.0150s/iter; left time: 22.0889s
	iters: 200, epoch: 3 | loss: 0.3035199
	speed: 0.0057s/iter; left time: 7.7694s
Updating learning rate to 9.96556082e-05
Epoch: 3 cost time: 1.597034215927124
Epoch: 3, Steps: 262 | Train Loss: 0.3278242 Vali Loss: 0.2976922 Best vali loss: 0.2829800

best validation loss 0.28297998771409466

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.004038866821, 'e_layers': 4, 'learning_rate': 0.0015507932563, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6435103
	speed: 0.0144s/iter; left time: 58.9466s
	iters: 200, epoch: 1 | loss: 0.8079494
	speed: 0.0102s/iter; left time: 40.8350s
	iters: 300, epoch: 1 | loss: 0.5376325
	speed: 0.0103s/iter; left time: 39.8680s
	iters: 400, epoch: 1 | loss: 0.4820450
	speed: 0.0101s/iter; left time: 38.3635s
	iters: 500, epoch: 1 | loss: 1.1871895
	speed: 0.0097s/iter; left time: 35.8015s
Updating learning rate to 0.0015507932563
Validation loss decreased (inf --> 0.3208).  Saving model state dict ...
Epoch: 1 cost time: 5.360185623168945
Epoch: 1, Steps: 523 | Train Loss: 0.7316653 Vali Loss: 0.3207810 Best vali loss: 0.3207810
	iters: 100, epoch: 2 | loss: 0.4924909
	speed: 0.0213s/iter; left time: 75.7266s
	iters: 200, epoch: 2 | loss: 0.7453804
	speed: 0.0110s/iter; left time: 38.1743s
	iters: 300, epoch: 2 | loss: 0.9126471
	speed: 0.0081s/iter; left time: 27.1656s
	iters: 400, epoch: 2 | loss: 0.5447942
	speed: 0.0092s/iter; left time: 30.0701s
	iters: 500, epoch: 2 | loss: 0.4780912
	speed: 0.0087s/iter; left time: 27.6657s
Updating learning rate to 0.00077539662815
Epoch: 2 cost time: 5.023693323135376
Epoch: 2, Steps: 523 | Train Loss: 0.6346808 Vali Loss: 0.3246798 Best vali loss: 0.3207810
	iters: 100, epoch: 3 | loss: 1.0482069
	speed: 0.0192s/iter; left time: 58.4879s
	iters: 200, epoch: 3 | loss: 0.6262128
	speed: 0.0094s/iter; left time: 27.7726s
	iters: 300, epoch: 3 | loss: 0.4557668
	speed: 0.0097s/iter; left time: 27.4908s
	iters: 400, epoch: 3 | loss: 0.4640056
	speed: 0.0088s/iter; left time: 24.0687s
	iters: 500, epoch: 3 | loss: 0.4060219
	speed: 0.0085s/iter; left time: 22.3277s
Updating learning rate to 0.000387698314075
Validation loss decreased (0.3208 --> 0.3176).  Saving model state dict ...
Epoch: 3 cost time: 4.8092873096466064
Epoch: 3, Steps: 523 | Train Loss: 0.6000428 Vali Loss: 0.3175548 Best vali loss: 0.3175548

best validation loss 0.31755478135401893

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0016826337275, 'e_layers': 1, 'learning_rate': 0.0003986224328, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5349055
	speed: 0.0159s/iter; left time: 19.2210s
	iters: 200, epoch: 4 | loss: 0.6497759
	speed: 0.0097s/iter; left time: 10.7910s
Updating learning rate to 4.98278041e-05
Epoch: 4 cost time: 2.7931435108184814
Epoch: 4, Steps: 262 | Train Loss: 0.5923407 Vali Loss: 0.2975616 Best vali loss: 0.2829800
	iters: 100, epoch: 5 | loss: 0.3929873
	speed: 0.0240s/iter; left time: 22.7868s
	iters: 200, epoch: 5 | loss: 0.3449777
	speed: 0.0099s/iter; left time: 8.4355s
Updating learning rate to 2.491390205e-05
Epoch: 5 cost time: 2.514906883239746
Epoch: 5, Steps: 262 | Train Loss: 0.3689825 Vali Loss: 0.2994516 Best vali loss: 0.2829800
	iters: 100, epoch: 6 | loss: 0.3310509
	speed: 0.0242s/iter; left time: 16.6162s
	iters: 200, epoch: 6 | loss: 0.2930453
	speed: 0.0069s/iter; left time: 4.0323s
Updating learning rate to 1.2456951025e-05
Epoch: 6 cost time: 1.6896724700927734
Epoch: 6, Steps: 262 | Train Loss: 0.3120481 Vali Loss: 0.3018979 Best vali loss: 0.2829800
	iters: 100, epoch: 7 | loss: 0.3881766
	speed: 0.0192s/iter; left time: 8.1701s
	iters: 200, epoch: 7 | loss: 0.3997313
	speed: 0.0068s/iter; left time: 2.2103s
Updating learning rate to 6.2284755125e-06
Epoch: 7 cost time: 2.004042863845825
Epoch: 7, Steps: 262 | Train Loss: 0.3939540 Vali Loss: 0.3022015 Best vali loss: 0.2829800
	iters: 100, epoch: 8 | loss: 0.3057742
	speed: 0.0228s/iter; left time: 3.7181s
	iters: 200, epoch: 8 | loss: 0.5958133
	speed: 0.0095s/iter; left time: 0.5969s
Updating learning rate to 3.11423775625e-06
Epoch: 8 cost time: 2.4746456146240234
Epoch: 8, Steps: 262 | Train Loss: 0.4507938 Vali Loss: 0.3022796 Best vali loss: 0.2829800

best validation loss 0.28297998771409466

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0014534062057, 'e_layers': 3, 'learning_rate': 0.0004295111967, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3785230
	speed: 0.0180s/iter; left time: 35.9182s
	iters: 200, epoch: 1 | loss: 1.0210031
	speed: 0.0107s/iter; left time: 20.2239s
Updating learning rate to 0.00041316390015777967
Validation loss decreased (inf --> 0.2891).  Saving model state dict ...
Epoch: 1 cost time: 3.1790926456451416
Epoch: 1, Steps: 262 | Train Loss: 0.6997630 Vali Loss: 0.2891234 Best vali loss: 0.2891234
	iters: 100, epoch: 2 | loss: 0.6897848
	speed: 0.0268s/iter; left time: 46.5110s
	iters: 200, epoch: 2 | loss: 0.4157252
	speed: 0.0134s/iter; left time: 21.8336s
Updating learning rate to 0.00036661073824105955
Validation loss decreased (0.2891 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 3.177105665206909
Epoch: 2, Steps: 262 | Train Loss: 0.5527550 Vali Loss: 0.2868341 Best vali loss: 0.2868341
	iters: 100, epoch: 3 | loss: 0.6387709
	speed: 0.0293s/iter; left time: 43.1078s
	iters: 200, epoch: 3 | loss: 0.4420094
	speed: 0.0109s/iter; left time: 14.9914s
Updating learning rate to 0.00029693900784619664
Epoch: 3 cost time: 2.9401988983154297
Epoch: 3, Steps: 262 | Train Loss: 0.5403902 Vali Loss: 0.2920230 Best vali loss: 0.2868341
	iters: 100, epoch: 4 | loss: 0.8479096
	speed: 0.0260s/iter; left time: 31.4673s
	iters: 200, epoch: 4 | loss: 0.3442162
	speed: 0.0113s/iter; left time: 12.5954s
Updating learning rate to 0.00021475559835
Epoch: 4 cost time: 3.018294095993042
Epoch: 4, Steps: 262 | Train Loss: 0.5960629 Vali Loss: 0.2888532 Best vali loss: 0.2868341
	iters: 100, epoch: 5 | loss: 0.3919218
	speed: 0.0338s/iter; left time: 32.1051s
	iters: 200, epoch: 5 | loss: 0.3486055
	speed: 0.0103s/iter; left time: 8.7204s
Updating learning rate to 0.0001325721888538034
Epoch: 5 cost time: 2.767005681991577
Epoch: 5, Steps: 262 | Train Loss: 0.3702637 Vali Loss: 0.2885478 Best vali loss: 0.2868341
	iters: 100, epoch: 6 | loss: 0.6610013
	speed: 0.0246s/iter; left time: 16.8737s
	iters: 200, epoch: 6 | loss: 0.6092080
	speed: 0.0095s/iter; left time: 5.6020s
Updating learning rate to 6.290045845894049e-05
Epoch: 6 cost time: 2.5759384632110596
Epoch: 6, Steps: 262 | Train Loss: 0.6351047 Vali Loss: 0.2903715 Best vali loss: 0.2868341
	iters: 100, epoch: 7 | loss: 0.4572182
	speed: 0.0325s/iter; left time: 13.8305s
	iters: 200, epoch: 7 | loss: 0.3687469
	speed: 0.0141s/iter; left time: 4.5904s
Updating learning rate to 1.634729654222034e-05
Epoch: 7 cost time: 3.38249135017395
Epoch: 7, Steps: 262 | Train Loss: 0.4129825 Vali Loss: 0.2868906 Best vali loss: 0.2868341
	iters: 100, epoch: 8 | loss: 0.5138329
	speed: 0.0348s/iter; left time: 5.6669s
	iters: 200, epoch: 8 | loss: 0.2198571
	speed: 0.0139s/iter; left time: 0.8765s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4725563526153564
Epoch: 8, Steps: 262 | Train Loss: 0.3668450 Vali Loss: 0.2881493 Best vali loss: 0.2868341

best validation loss 0.28683410076768745

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0098523056482, 'e_layers': 3, 'learning_rate': 0.0005014653261, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4273207
	speed: 0.0138s/iter; left time: 56.4671s
	iters: 200, epoch: 1 | loss: 0.4943895
	speed: 0.0075s/iter; left time: 29.9750s
	iters: 300, epoch: 1 | loss: 0.7576807
	speed: 0.0084s/iter; left time: 32.4594s
	iters: 400, epoch: 1 | loss: 0.3769398
	speed: 0.0073s/iter; left time: 27.6030s
	iters: 500, epoch: 1 | loss: 0.7244923
	speed: 0.0077s/iter; left time: 28.4058s
Updating learning rate to 0.0005014653261
Validation loss decreased (inf --> 0.2942).  Saving model state dict ...
Epoch: 1 cost time: 4.397712230682373
Epoch: 1, Steps: 523 | Train Loss: 0.5561646 Vali Loss: 0.2942131 Best vali loss: 0.2942131
	iters: 100, epoch: 2 | loss: 0.5129918
	speed: 0.0165s/iter; left time: 58.8746s
	iters: 200, epoch: 2 | loss: 0.4324485
	speed: 0.0066s/iter; left time: 22.8556s
	iters: 300, epoch: 2 | loss: 0.6008366
	speed: 0.0092s/iter; left time: 30.9707s
	iters: 400, epoch: 2 | loss: 0.9157813
	speed: 0.0071s/iter; left time: 23.2435s
	iters: 500, epoch: 2 | loss: 0.3987447
	speed: 0.0079s/iter; left time: 24.8504s
Updating learning rate to 0.00025073266305
Validation loss decreased (0.2942 --> 0.2898).  Saving model state dict ...
Epoch: 2 cost time: 4.084445238113403
Epoch: 2, Steps: 523 | Train Loss: 0.5721606 Vali Loss: 0.2898117 Best vali loss: 0.2898117
	iters: 100, epoch: 3 | loss: 0.2995212
	speed: 0.0201s/iter; left time: 61.1667s
	iters: 200, epoch: 3 | loss: 0.5742768
	speed: 0.0083s/iter; left time: 24.3877s
	iters: 300, epoch: 3 | loss: 0.4667184
	speed: 0.0088s/iter; left time: 24.9898s
	iters: 400, epoch: 3 | loss: 0.7905670
	speed: 0.0094s/iter; left time: 25.6806s
	iters: 500, epoch: 3 | loss: 0.3689120
	speed: 0.0092s/iter; left time: 24.1506s
Updating learning rate to 0.000125366331525
Epoch: 3 cost time: 4.779610633850098
Epoch: 3, Steps: 523 | Train Loss: 0.4999991 Vali Loss: 0.2956980 Best vali loss: 0.2898117
	iters: 100, epoch: 4 | loss: 0.1980358
	speed: 0.0167s/iter; left time: 41.9244s
	iters: 200, epoch: 4 | loss: 0.3758163
	speed: 0.0062s/iter; left time: 14.8993s
	iters: 300, epoch: 4 | loss: 0.2393657
	speed: 0.0063s/iter; left time: 14.6530s
	iters: 400, epoch: 4 | loss: 0.4412859
	speed: 0.0084s/iter; left time: 18.6525s
	iters: 500, epoch: 4 | loss: 0.1975652
	speed: 0.0087s/iter; left time: 18.4266s
Updating learning rate to 6.26831657625e-05
Validation loss decreased (0.2898 --> 0.2893).  Saving model state dict ...
Epoch: 4 cost time: 3.9096999168395996
Epoch: 4, Steps: 523 | Train Loss: 0.2904138 Vali Loss: 0.2893264 Best vali loss: 0.2893264
	iters: 100, epoch: 5 | loss: 0.8384328
	speed: 0.0195s/iter; left time: 38.8510s
	iters: 200, epoch: 5 | loss: 0.3894242
	speed: 0.0083s/iter; left time: 15.6804s
	iters: 300, epoch: 5 | loss: 0.3663637
	speed: 0.0089s/iter; left time: 16.0121s
	iters: 400, epoch: 5 | loss: 0.6909015
	speed: 0.0085s/iter; left time: 14.3228s
	iters: 500, epoch: 5 | loss: 0.4015647
	speed: 0.0085s/iter; left time: 13.6105s
Updating learning rate to 3.134158288125e-05
Epoch: 5 cost time: 4.614960193634033
Epoch: 5, Steps: 523 | Train Loss: 0.5373374 Vali Loss: 0.2904613 Best vali loss: 0.2893264
	iters: 100, epoch: 6 | loss: 0.4322694
	speed: 0.0190s/iter; left time: 27.8569s
	iters: 200, epoch: 6 | loss: 0.3908938
	speed: 0.0085s/iter; left time: 11.6178s
	iters: 300, epoch: 6 | loss: 0.5170599
	speed: 0.0074s/iter; left time: 9.4369s
	iters: 400, epoch: 6 | loss: 0.5436119
	speed: 0.0088s/iter; left time: 10.3515s
	iters: 500, epoch: 6 | loss: 0.3687206
	speed: 0.0099s/iter; left time: 10.5707s
Updating learning rate to 1.5670791440625e-05
Epoch: 6 cost time: 4.604186296463013
Epoch: 6, Steps: 523 | Train Loss: 0.4505111 Vali Loss: 0.2927467 Best vali loss: 0.2893264
	iters: 100, epoch: 7 | loss: 0.3189200
	speed: 0.0204s/iter; left time: 19.3656s
	iters: 200, epoch: 7 | loss: 0.4115711
	speed: 0.0103s/iter; left time: 8.7373s
	iters: 300, epoch: 7 | loss: 0.4748017
	speed: 0.0094s/iter; left time: 7.0555s
	iters: 400, epoch: 7 | loss: 0.5431235
	speed: 0.0103s/iter; left time: 6.6820s
	iters: 500, epoch: 7 | loss: 0.2837820
	speed: 0.0096s/iter; left time: 5.2296s
Updating learning rate to 7.8353957203125e-06
Epoch: 7 cost time: 5.127817153930664
Epoch: 7, Steps: 523 | Train Loss: 0.4064397 Vali Loss: 0.2950024 Best vali loss: 0.2893264
	iters: 100, epoch: 8 | loss: 0.3166733
	speed: 0.0222s/iter; left time: 9.3946s
	iters: 200, epoch: 8 | loss: 0.2183529
	speed: 0.0086s/iter; left time: 2.7996s
	iters: 300, epoch: 8 | loss: 0.3381090
	speed: 0.0106s/iter; left time: 2.3799s
	iters: 400, epoch: 8 | loss: 0.2915379
	speed: 0.0105s/iter; left time: 1.2975s
	iters: 500, epoch: 8 | loss: 0.3030201
	speed: 0.0122s/iter; left time: 0.2940s
Updating learning rate to 3.91769786015625e-06
Epoch: 8 cost time: 5.565557956695557
Epoch: 8, Steps: 523 | Train Loss: 0.2935387 Vali Loss: 0.2927443 Best vali loss: 0.2893264

best validation loss 0.28932641572937196

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0045166889404, 'e_layers': 4, 'learning_rate': 0.0001510969331, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3573340
	speed: 0.0183s/iter; left time: 17.3257s
Updating learning rate to 0.0001510969331
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 1.8670604228973389
Epoch: 1, Steps: 131 | Train Loss: 0.3573340 Vali Loss: 0.2828237 Best vali loss: 0.2828237
	iters: 100, epoch: 2 | loss: 0.9148825
	speed: 0.0290s/iter; left time: 23.6953s
Updating learning rate to 7.554846655e-05
Validation loss decreased (0.2828 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 2.5599608421325684
Epoch: 2, Steps: 131 | Train Loss: 0.9148825 Vali Loss: 0.2827865 Best vali loss: 0.2827865
	iters: 100, epoch: 3 | loss: 0.3512388
	speed: 0.0326s/iter; left time: 22.4083s
Updating learning rate to 3.7774233275e-05
Validation loss decreased (0.2828 --> 0.2809).  Saving model state dict ...
Epoch: 3 cost time: 2.363898515701294
Epoch: 3, Steps: 131 | Train Loss: 0.3512388 Vali Loss: 0.2809175 Best vali loss: 0.2809175

best validation loss 0.28091751583760094

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013524388112, 'e_layers': 1, 'learning_rate': 0.0001664609842, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001664609842
Validation loss decreased (inf --> 0.3017).  Saving model state dict ...
Epoch: 1 cost time: 1.5043158531188965
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3016555 Best vali loss: 0.3016555
Updating learning rate to 8.32304921e-05
Validation loss decreased (0.3017 --> 0.2848).  Saving model state dict ...
Epoch: 2 cost time: 0.5926816463470459
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2847606 Best vali loss: 0.2847606
Updating learning rate to 4.161524605e-05
Validation loss decreased (0.2848 --> 0.2820).  Saving model state dict ...
Epoch: 3 cost time: 1.095761775970459
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2819754 Best vali loss: 0.2819754

best validation loss 0.28197536832805725

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0035464357287, 'e_layers': 2, 'learning_rate': 0.0003036080774, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4112620
	speed: 0.0173s/iter; left time: 34.6326s
	iters: 200, epoch: 1 | loss: 0.6342033
	speed: 0.0113s/iter; left time: 21.4374s
Updating learning rate to 0.0002920526830074813
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 3.1648099422454834
Epoch: 1, Steps: 262 | Train Loss: 0.5227327 Vali Loss: 0.2849823 Best vali loss: 0.2849823
	iters: 100, epoch: 2 | loss: 0.8174878
	speed: 0.0256s/iter; left time: 44.4384s
	iters: 200, epoch: 2 | loss: 0.2680716
	speed: 0.0096s/iter; left time: 15.7747s
Updating learning rate to 0.0002591457038762751
Validation loss decreased (0.2850 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 2.3701272010803223
Epoch: 2, Steps: 262 | Train Loss: 0.5427797 Vali Loss: 0.2830442 Best vali loss: 0.2830442
	iters: 100, epoch: 3 | loss: 0.4948866
	speed: 0.0182s/iter; left time: 26.7958s
	iters: 200, epoch: 3 | loss: 0.9109012
	speed: 0.0092s/iter; left time: 12.6599s
Updating learning rate to 0.00020989692927659895
Epoch: 3 cost time: 2.429924726486206
Epoch: 3, Steps: 262 | Train Loss: 0.7028939 Vali Loss: 0.2831064 Best vali loss: 0.2830442

best validation loss 0.28304415397060634

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0045166889404, 'e_layers': 4, 'learning_rate': 0.0001510969331, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3532619
	speed: 0.0255s/iter; left time: 14.1676s
Updating learning rate to 1.88871166375e-05
Validation loss decreased (0.2809 --> 0.2795).  Saving model state dict ...
Epoch: 4 cost time: 2.5850648880004883
Epoch: 4, Steps: 131 | Train Loss: 0.3532619 Vali Loss: 0.2795449 Best vali loss: 0.2795449
	iters: 100, epoch: 5 | loss: 0.8800768
	speed: 0.0272s/iter; left time: 11.5747s
Updating learning rate to 9.44355831875e-06
Epoch: 5 cost time: 2.1722512245178223
Epoch: 5, Steps: 131 | Train Loss: 0.8800768 Vali Loss: 0.2799866 Best vali loss: 0.2795449
	iters: 100, epoch: 6 | loss: 0.3511857
	speed: 0.0313s/iter; left time: 9.2090s
Updating learning rate to 4.721779159375e-06
Epoch: 6 cost time: 2.433199167251587
Epoch: 6, Steps: 131 | Train Loss: 0.3511857 Vali Loss: 0.2798613 Best vali loss: 0.2795449
	iters: 100, epoch: 7 | loss: 0.6465595
	speed: 0.0168s/iter; left time: 2.7343s
Updating learning rate to 2.3608895796875e-06
Epoch: 7 cost time: 1.3401978015899658
Epoch: 7, Steps: 131 | Train Loss: 0.6465595 Vali Loss: 0.2799917 Best vali loss: 0.2795449
	iters: 100, epoch: 8 | loss: 0.5580198
	speed: 0.0255s/iter; left time: 0.8156s
Updating learning rate to 1.18044478984375e-06
Epoch: 8 cost time: 2.4535632133483887
Epoch: 8, Steps: 131 | Train Loss: 0.5580198 Vali Loss: 0.2798309 Best vali loss: 0.2795449

best validation loss 0.27954491895341926

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0015416318895, 'e_layers': 4, 'learning_rate': 0.0026041245788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3731422
	speed: 0.0165s/iter; left time: 136.1361s
	iters: 200, epoch: 1 | loss: 0.3120525
	speed: 0.0092s/iter; left time: 74.8354s
	iters: 300, epoch: 1 | loss: 0.3995604
	speed: 0.0085s/iter; left time: 68.2584s
	iters: 400, epoch: 1 | loss: 0.4778424
	speed: 0.0087s/iter; left time: 69.5999s
	iters: 500, epoch: 1 | loss: 0.3411554
	speed: 0.0094s/iter; left time: 73.8563s
	iters: 600, epoch: 1 | loss: 1.4215043
	speed: 0.0089s/iter; left time: 68.8272s
	iters: 700, epoch: 1 | loss: 0.8817409
	speed: 0.0088s/iter; left time: 67.3209s
	iters: 800, epoch: 1 | loss: 0.3902868
	speed: 0.0096s/iter; left time: 72.7957s
	iters: 900, epoch: 1 | loss: 0.3255383
	speed: 0.0125s/iter; left time: 93.3355s
	iters: 1000, epoch: 1 | loss: 0.5826222
	speed: 0.0103s/iter; left time: 76.0526s
Updating learning rate to 0.0025050109886314478
Validation loss decreased (inf --> 0.3213).  Saving model state dict ...
Epoch: 1 cost time: 10.481173038482666
Epoch: 1, Steps: 1045 | Train Loss: 0.5505445 Vali Loss: 0.3213005 Best vali loss: 0.3213005
	iters: 100, epoch: 2 | loss: 1.0033700
	speed: 0.0346s/iter; left time: 250.0331s
	iters: 200, epoch: 2 | loss: 0.5065585
	speed: 0.0082s/iter; left time: 58.3666s
	iters: 300, epoch: 2 | loss: 1.1093386
	speed: 0.0078s/iter; left time: 54.7339s
	iters: 400, epoch: 2 | loss: 1.1611316
	speed: 0.0077s/iter; left time: 53.4124s
	iters: 500, epoch: 2 | loss: 0.2842843
	speed: 0.0088s/iter; left time: 59.8648s
	iters: 600, epoch: 2 | loss: 0.2400996
	speed: 0.0109s/iter; left time: 73.4505s
	iters: 700, epoch: 2 | loss: 0.2649431
	speed: 0.0087s/iter; left time: 57.3181s
	iters: 800, epoch: 2 | loss: 0.9193014
	speed: 0.0083s/iter; left time: 54.4084s
	iters: 900, epoch: 2 | loss: 0.3132716
	speed: 0.0091s/iter; left time: 58.3915s
	iters: 1000, epoch: 2 | loss: 1.1987742
	speed: 0.0091s/iter; left time: 57.3778s
Updating learning rate to 0.002222759363762021
Epoch: 2 cost time: 9.350815773010254
Epoch: 2, Steps: 1045 | Train Loss: 0.7001073 Vali Loss: 0.3256462 Best vali loss: 0.3213005
	iters: 100, epoch: 3 | loss: 0.2797040
	speed: 0.0267s/iter; left time: 164.8911s
	iters: 200, epoch: 3 | loss: 0.7532955
	speed: 0.0085s/iter; left time: 51.8217s
	iters: 300, epoch: 3 | loss: 0.2654739
	speed: 0.0087s/iter; left time: 51.9151s
	iters: 400, epoch: 3 | loss: 0.6359463
	speed: 0.0089s/iter; left time: 52.2057s
	iters: 500, epoch: 3 | loss: 0.4972955
	speed: 0.0072s/iter; left time: 41.5712s
	iters: 600, epoch: 3 | loss: 0.3170792
	speed: 0.0082s/iter; left time: 46.7690s
	iters: 700, epoch: 3 | loss: 0.7864894
	speed: 0.0085s/iter; left time: 47.4970s
	iters: 800, epoch: 3 | loss: 0.4371296
	speed: 0.0072s/iter; left time: 39.4236s
	iters: 900, epoch: 3 | loss: 0.7525390
	speed: 0.0081s/iter; left time: 43.7521s
	iters: 1000, epoch: 3 | loss: 0.3086144
	speed: 0.0079s/iter; left time: 41.6612s
Updating learning rate to 0.001800339955460739
Epoch: 3 cost time: 8.713451385498047
Epoch: 3, Steps: 1045 | Train Loss: 0.5033567 Vali Loss: 0.3229011 Best vali loss: 0.3213005
	iters: 100, epoch: 4 | loss: 0.7769240
	speed: 0.0273s/iter; left time: 140.1210s
	iters: 200, epoch: 4 | loss: 0.2463236
	speed: 0.0080s/iter; left time: 40.3416s
	iters: 300, epoch: 4 | loss: 1.1864232
	speed: 0.0081s/iter; left time: 40.0802s
	iters: 400, epoch: 4 | loss: 0.3045725
	speed: 0.0096s/iter; left time: 46.4499s
	iters: 500, epoch: 4 | loss: 0.3306419
	speed: 0.0078s/iter; left time: 37.0039s
	iters: 600, epoch: 4 | loss: 1.1960847
	speed: 0.0093s/iter; left time: 42.8176s
	iters: 700, epoch: 4 | loss: 0.2800310
	speed: 0.0092s/iter; left time: 41.6816s
	iters: 800, epoch: 4 | loss: 0.3971401
	speed: 0.0083s/iter; left time: 36.8325s
	iters: 900, epoch: 4 | loss: 0.3083834
	speed: 0.0083s/iter; left time: 35.8949s
	iters: 1000, epoch: 4 | loss: 0.4405510
	speed: 0.0092s/iter; left time: 38.8617s
Updating learning rate to 0.0013020622894
Epoch: 4 cost time: 9.24717378616333
Epoch: 4, Steps: 1045 | Train Loss: 0.5467075 Vali Loss: 0.3228275 Best vali loss: 0.3213005
	iters: 100, epoch: 5 | loss: 0.9120476
	speed: 0.0302s/iter; left time: 123.1381s
	iters: 200, epoch: 5 | loss: 0.4913660
	speed: 0.0078s/iter; left time: 31.2262s
	iters: 300, epoch: 5 | loss: 0.3575499
	speed: 0.0097s/iter; left time: 37.5408s
	iters: 400, epoch: 5 | loss: 0.6839713
	speed: 0.0097s/iter; left time: 36.7126s
	iters: 500, epoch: 5 | loss: 0.4593662
	speed: 0.0097s/iter; left time: 35.6298s
	iters: 600, epoch: 5 | loss: 0.3671266
	speed: 0.0102s/iter; left time: 36.5825s
	iters: 700, epoch: 5 | loss: 0.3570191
	speed: 0.0095s/iter; left time: 33.0269s
	iters: 800, epoch: 5 | loss: 0.4378160
	speed: 0.0090s/iter; left time: 30.3210s
	iters: 900, epoch: 5 | loss: 0.2351640
	speed: 0.0112s/iter; left time: 36.9005s
	iters: 1000, epoch: 5 | loss: 0.1369676
	speed: 0.0093s/iter; left time: 29.4606s
Updating learning rate to 0.0008037846233392612
Epoch: 5 cost time: 10.132794380187988
Epoch: 5, Steps: 1045 | Train Loss: 0.4438394 Vali Loss: 0.3225275 Best vali loss: 0.3213005
	iters: 100, epoch: 6 | loss: 0.6939870
	speed: 0.0318s/iter; left time: 96.5729s
	iters: 200, epoch: 6 | loss: 0.5126231
	speed: 0.0102s/iter; left time: 29.9973s
	iters: 300, epoch: 6 | loss: 0.2664480
	speed: 0.0098s/iter; left time: 27.6937s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0025460163718, 'e_layers': 2, 'learning_rate': 0.0009914225957, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4097378
	speed: 0.0164s/iter; left time: 32.8005s
	iters: 200, epoch: 1 | loss: 0.9602607
	speed: 0.0096s/iter; left time: 18.2255s
Updating learning rate to 0.0009536888199682212
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 2.887913942337036
Epoch: 1, Steps: 262 | Train Loss: 0.6849993 Vali Loss: 0.2867323 Best vali loss: 0.2867323
	iters: 100, epoch: 2 | loss: 0.5301115
	speed: 0.0248s/iter; left time: 43.0918s
	iters: 200, epoch: 2 | loss: 0.4468339
	speed: 0.0119s/iter; left time: 19.4445s
Updating learning rate to 0.0008462321180705194
Epoch: 2 cost time: 2.8123137950897217
Epoch: 2, Steps: 262 | Train Loss: 0.4884727 Vali Loss: 0.2948643 Best vali loss: 0.2867323
	iters: 100, epoch: 3 | loss: 0.3421426
	speed: 0.0199s/iter; left time: 29.2686s
	iters: 200, epoch: 3 | loss: 0.7736795
	speed: 0.0085s/iter; left time: 11.6154s
Updating learning rate to 0.0006854117987733914
Epoch: 3 cost time: 2.1351935863494873
Epoch: 3, Steps: 262 | Train Loss: 0.5579110 Vali Loss: 0.3069704 Best vali loss: 0.2867323
	iters: 100, epoch: 4 | loss: 0.2526372
	speed: 0.0166s/iter; left time: 20.1090s
	iters: 200, epoch: 4 | loss: 0.4182095
	speed: 0.0090s/iter; left time: 9.9940s
Updating learning rate to 0.00049571129785
Epoch: 4 cost time: 2.3312466144561768
Epoch: 4, Steps: 262 | Train Loss: 0.3354234 Vali Loss: 0.2895207 Best vali loss: 0.2867323
	iters: 100, epoch: 5 | loss: 0.2446011
	speed: 0.0265s/iter; left time: 25.1898s
	iters: 200, epoch: 5 | loss: 0.3256381
	speed: 0.0112s/iter; left time: 9.4696s
Updating learning rate to 0.0003060107969266087
Epoch: 5 cost time: 2.7700114250183105
Epoch: 5, Steps: 262 | Train Loss: 0.2851196 Vali Loss: 0.2911316 Best vali loss: 0.2867323
	iters: 100, epoch: 6 | loss: 0.2355070
	speed: 0.0277s/iter; left time: 19.0038s
	iters: 200, epoch: 6 | loss: 0.3421937
	speed: 0.0094s/iter; left time: 5.5239s
Updating learning rate to 0.0001451904776294806
Epoch: 6 cost time: 2.5271191596984863
Epoch: 6, Steps: 262 | Train Loss: 0.2888503 Vali Loss: 0.3035099 Best vali loss: 0.2867323
	iters: 100, epoch: 7 | loss: 0.5133227
	speed: 0.0336s/iter; left time: 14.2926s
	iters: 200, epoch: 7 | loss: 0.2468066
	speed: 0.0089s/iter; left time: 2.8993s
Updating learning rate to 3.773377573177878e-05
Epoch: 7 cost time: 2.418348789215088
Epoch: 7, Steps: 262 | Train Loss: 0.3800646 Vali Loss: 0.3053932 Best vali loss: 0.2867323
	iters: 100, epoch: 8 | loss: 0.3320328
	speed: 0.0259s/iter; left time: 4.2233s
	iters: 200, epoch: 8 | loss: 0.2768275
	speed: 0.0098s/iter; left time: 0.6163s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.600301742553711
Epoch: 8, Steps: 262 | Train Loss: 0.3044302 Vali Loss: 0.3049545 Best vali loss: 0.2867323

best validation loss 0.28673234396860386

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0023438277977, 'e_layers': 4, 'learning_rate': 0.0010338984102, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5522849
	speed: 0.0234s/iter; left time: 22.1661s
Updating learning rate to 0.0009945479950398692
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 2.605713367462158
Epoch: 1, Steps: 131 | Train Loss: 0.5522849 Vali Loss: 0.2833242 Best vali loss: 0.2833242
	iters: 100, epoch: 2 | loss: 0.4307166
	speed: 0.0365s/iter; left time: 29.8540s
Updating learning rate to 0.0008824874935552053
Validation loss decreased (0.2833 --> 0.2817).  Saving model state dict ...
Epoch: 2 cost time: 3.020742177963257
Epoch: 2, Steps: 131 | Train Loss: 0.4307166 Vali Loss: 0.2817426 Best vali loss: 0.2817426
	iters: 100, epoch: 3 | loss: 0.5086923
	speed: 0.0378s/iter; left time: 25.9460s
Updating learning rate to 0.0007147771012660728
Epoch: 3 cost time: 2.7807259559631348
Epoch: 3, Steps: 131 | Train Loss: 0.5086923 Vali Loss: 0.2833358 Best vali loss: 0.2817426

best validation loss 0.28174260961894165

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5457089
	speed: 0.0143s/iter; left time: 58.3388s
	iters: 200, epoch: 1 | loss: 0.3453482
	speed: 0.0072s/iter; left time: 28.7851s
	iters: 300, epoch: 1 | loss: 0.7708580
	speed: 0.0070s/iter; left time: 27.1443s
	iters: 400, epoch: 1 | loss: 0.8175723
	speed: 0.0079s/iter; left time: 30.0261s
	iters: 500, epoch: 1 | loss: 0.5403184
	speed: 0.0075s/iter; left time: 27.7274s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 4.223439455032349
Epoch: 1, Steps: 523 | Train Loss: 0.6039612 Vali Loss: 0.2847145 Best vali loss: 0.2847145
	iters: 100, epoch: 2 | loss: 0.3050781
	speed: 0.0158s/iter; left time: 56.3685s
	iters: 200, epoch: 2 | loss: 0.6690531
	speed: 0.0062s/iter; left time: 21.3007s
	iters: 300, epoch: 2 | loss: 0.3442354
	speed: 0.0074s/iter; left time: 24.8850s
	iters: 400, epoch: 2 | loss: 0.3855413
	speed: 0.0080s/iter; left time: 26.1604s
	iters: 500, epoch: 2 | loss: 0.2462930
	speed: 0.0066s/iter; left time: 20.9760s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 3.778001308441162
Epoch: 2, Steps: 523 | Train Loss: 0.3900402 Vali Loss: 0.2869451 Best vali loss: 0.2847145
	iters: 100, epoch: 3 | loss: 0.4185456
	speed: 0.0179s/iter; left time: 54.3268s
	iters: 200, epoch: 3 | loss: 0.8505863
	speed: 0.0068s/iter; left time: 20.0489s
	iters: 300, epoch: 3 | loss: 0.5458928
	speed: 0.0080s/iter; left time: 22.5779s
	iters: 400, epoch: 3 | loss: 0.2873568
	speed: 0.0096s/iter; left time: 26.3190s
	iters: 500, epoch: 3 | loss: 0.4632634
	speed: 0.0088s/iter; left time: 23.1149s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 4.364147186279297
Epoch: 3, Steps: 523 | Train Loss: 0.5131290 Vali Loss: 0.2923983 Best vali loss: 0.2847145

best validation loss 0.28471446454569327

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0085427316509, 'e_layers': 2, 'learning_rate': 0.0006339156243, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006097886474649422
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 1.1381068229675293
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2798015 Best vali loss: 0.2798015
Updating learning rate to 0.0005410808304713169
Epoch: 2 cost time: 1.0706403255462646
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2816549 Best vali loss: 0.2798015
Updating learning rate to 0.0004382523156184914
Epoch: 3 cost time: 1.3436286449432373
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2800995 Best vali loss: 0.2798015

best validation loss 0.2798014900395311

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0085427316509, 'e_layers': 2, 'learning_rate': 0.0006339156243, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00031695781215
Epoch: 4 cost time: 1.596778392791748
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2874356 Best vali loss: 0.2798015
Updating learning rate to 0.00019566330868150866
Epoch: 5 cost time: 1.3355159759521484
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2903781 Best vali loss: 0.2798015
Updating learning rate to 9.283479382868314e-05
Epoch: 6 cost time: 0.5749189853668213
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2870613 Best vali loss: 0.2798015
Updating learning rate to 2.412697683505776e-05
Epoch: 7 cost time: 0.9755196571350098
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2917699 Best vali loss: 0.2798015
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8895406723022461
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2907664 Best vali loss: 0.2798015

best validation loss 0.2798014900395311

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0021018513701, 'e_layers': 2, 'learning_rate': 0.0005482150459, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7603464
	speed: 0.0264s/iter; left time: 25.0629s
Updating learning rate to 0.0005273498531108727
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 2.6875336170196533
Epoch: 1, Steps: 131 | Train Loss: 0.7603464 Vali Loss: 0.2883117 Best vali loss: 0.2883117
	iters: 100, epoch: 2 | loss: 0.2998043
	speed: 0.0280s/iter; left time: 22.8929s
Updating learning rate to 0.00046793081120219214
Validation loss decreased (0.2883 --> 0.2781).  Saving model state dict ...
Epoch: 2 cost time: 2.4062764644622803
Epoch: 2, Steps: 131 | Train Loss: 0.2998043 Vali Loss: 0.2780734 Best vali loss: 0.2780734
	iters: 100, epoch: 3 | loss: 0.4924601
	speed: 0.0220s/iter; left time: 15.1276s
Updating learning rate to 0.0003790039306695986
Epoch: 3 cost time: 1.6096456050872803
Epoch: 3, Steps: 131 | Train Loss: 0.4924601 Vali Loss: 0.2840771 Best vali loss: 0.2780734
	iters: 100, epoch: 4 | loss: 0.7007942
	speed: 0.0276s/iter; left time: 15.3647s
Updating learning rate to 0.00027410752295
Epoch: 4 cost time: 1.9968478679656982
Epoch: 4, Steps: 131 | Train Loss: 0.7007942 Vali Loss: 0.2823112 Best vali loss: 0.2780734
	iters: 100, epoch: 5 | loss: 0.4333669
	speed: 0.0147s/iter; left time: 6.2431s
Updating learning rate to 0.00016921111523040137
Epoch: 5 cost time: 1.1858737468719482
Epoch: 5, Steps: 131 | Train Loss: 0.4333669 Vali Loss: 0.2818048 Best vali loss: 0.2780734
	iters: 100, epoch: 6 | loss: 0.3610862
	speed: 0.0179s/iter; left time: 5.2541s
Updating learning rate to 8.028423469780781e-05
Epoch: 6 cost time: 1.4166884422302246
Epoch: 6, Steps: 131 | Train Loss: 0.3610862 Vali Loss: 0.2826912 Best vali loss: 0.2780734
	iters: 100, epoch: 7 | loss: 0.4180149
	speed: 0.0147s/iter; left time: 2.3913s
Updating learning rate to 2.0865192789127196e-05
Epoch: 7 cost time: 1.1922094821929932
Epoch: 7, Steps: 131 | Train Loss: 0.4180149 Vali Loss: 0.2890182 Best vali loss: 0.2780734
	iters: 100, epoch: 8 | loss: 0.4441644
	speed: 0.0152s/iter; left time: 0.4870s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2437467575073242
Epoch: 8, Steps: 131 | Train Loss: 0.4441644 Vali Loss: 0.2858097 Best vali loss: 0.2780734

best validation loss 0.27807339958572264

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0015476159007, 'e_layers': 4, 'learning_rate': 0.0009329379852, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0008974301474142989
Validation loss decreased (inf --> 0.2922).  Saving model state dict ...
Epoch: 1 cost time: 1.0472595691680908
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2922171 Best vali loss: 0.2922171
Updating learning rate to 0.0007963123804807174
Validation loss decreased (0.2922 --> 0.2863).  Saving model state dict ...
Epoch: 2 cost time: 0.6507840156555176
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2863275 Best vali loss: 0.2863275
Updating learning rate to 0.0006449789477800537
Validation loss decreased (0.2863 --> 0.2854).  Saving model state dict ...
Epoch: 3 cost time: 0.8190732002258301
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2854389 Best vali loss: 0.2854389
Updating learning rate to 0.0004664689926
Epoch: 4 cost time: 0.8357627391815186
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2954680 Best vali loss: 0.2854389
Updating learning rate to 0.0002879590374199464
Epoch: 5 cost time: 0.9298169612884521
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2973707 Best vali loss: 0.2854389
Updating learning rate to 0.00013662560471928257
Epoch: 6 cost time: 0.8163158893585205
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3008607 Best vali loss: 0.2854389
Updating learning rate to 3.550783778570113e-05
Epoch: 7 cost time: 0.8251292705535889
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2941144 Best vali loss: 0.2854389
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8893506526947021
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2934942 Best vali loss: 0.2854389

best validation loss 0.2854388579061236

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0012011409388, 'e_layers': 2, 'learning_rate': 0.0002053460805, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2605780
	speed: 0.0113s/iter; left time: 22.6359s
	iters: 200, epoch: 1 | loss: 0.4255728
	speed: 0.0049s/iter; left time: 9.3515s
Updating learning rate to 0.0002053460805
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 1.842195987701416
Epoch: 1, Steps: 262 | Train Loss: 0.3430754 Vali Loss: 0.2819379 Best vali loss: 0.2819379
	iters: 100, epoch: 2 | loss: 0.4729617
	speed: 0.0201s/iter; left time: 34.8264s
	iters: 200, epoch: 2 | loss: 0.8618842
	speed: 0.0090s/iter; left time: 14.7634s
Updating learning rate to 0.00010267304025
Validation loss decreased (0.2819 --> 0.2798).  Saving model state dict ...
Epoch: 2 cost time: 2.4277169704437256
Epoch: 2, Steps: 262 | Train Loss: 0.6674229 Vali Loss: 0.2797532 Best vali loss: 0.2797532
	iters: 100, epoch: 3 | loss: 0.3853534
	speed: 0.0213s/iter; left time: 31.4469s
	iters: 200, epoch: 3 | loss: 0.4282571
	speed: 0.0097s/iter; left time: 13.3326s
Updating learning rate to 5.1336520125e-05
Validation loss decreased (0.2798 --> 0.2793).  Saving model state dict ...
Epoch: 3 cost time: 2.5605857372283936
Epoch: 3, Steps: 262 | Train Loss: 0.4068052 Vali Loss: 0.2793246 Best vali loss: 0.2793246

best validation loss 0.2793246393932557

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.006258308639, 'e_layers': 2, 'learning_rate': 0.0015600129814, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0015600129814
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.1752338409423828
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2855853 Best vali loss: 0.2855853
Updating learning rate to 0.0007800064907
Validation loss decreased (0.2856 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.7103276252746582
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2792283 Best vali loss: 0.2792283
Updating learning rate to 0.00039000324535
Epoch: 3 cost time: 0.7602221965789795
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2837672 Best vali loss: 0.2792283

best validation loss 0.27922831454676916

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 1, 'learning_rate': 0.0003597564711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6281415
	speed: 0.0161s/iter; left time: 32.1735s
	iters: 200, epoch: 1 | loss: 0.5811585
	speed: 0.0088s/iter; left time: 16.6138s
Updating learning rate to 0.0003597564711
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 2.709439277648926
Epoch: 1, Steps: 262 | Train Loss: 0.6046500 Vali Loss: 0.2787194 Best vali loss: 0.2787194
	iters: 100, epoch: 2 | loss: 0.7237177
	speed: 0.0157s/iter; left time: 27.2325s
	iters: 200, epoch: 2 | loss: 0.9424499
	speed: 0.0030s/iter; left time: 4.8592s
Updating learning rate to 0.00017987823555
Epoch: 2 cost time: 0.88651442527771
Epoch: 2, Steps: 262 | Train Loss: 0.8330838 Vali Loss: 0.2803996 Best vali loss: 0.2787194
	iters: 100, epoch: 3 | loss: 0.3807485
	speed: 0.0188s/iter; left time: 27.7110s
	iters: 200, epoch: 3 | loss: 0.4020618
	speed: 0.0085s/iter; left time: 11.6057s
Updating learning rate to 8.9939117775e-05
Epoch: 3 cost time: 2.425657272338867
Epoch: 3, Steps: 262 | Train Loss: 0.3914052 Vali Loss: 0.2881781 Best vali loss: 0.2787194

best validation loss 0.2787193969202423

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 1, 'learning_rate': 0.0003597564711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5379377
	speed: 0.0135s/iter; left time: 16.3281s
	iters: 200, epoch: 4 | loss: 0.4662005
	speed: 0.0101s/iter; left time: 11.2459s
Updating learning rate to 4.49695588875e-05
Epoch: 4 cost time: 2.6261463165283203
Epoch: 4, Steps: 262 | Train Loss: 0.5020691 Vali Loss: 0.2893111 Best vali loss: 0.2787194
	iters: 100, epoch: 5 | loss: 0.6313958
	speed: 0.0277s/iter; left time: 26.3203s
	iters: 200, epoch: 5 | loss: 0.7932950
	speed: 0.0079s/iter; left time: 6.7490s
Updating learning rate to 2.248477944375e-05
Epoch: 5 cost time: 2.2746143341064453
Epoch: 5, Steps: 262 | Train Loss: 0.7123454 Vali Loss: 0.2887369 Best vali loss: 0.2787194
	iters: 100, epoch: 6 | loss: 0.3620501
	speed: 0.0270s/iter; left time: 18.5554s
	iters: 200, epoch: 6 | loss: 0.4005907
	speed: 0.0091s/iter; left time: 5.3264s
Updating learning rate to 1.1242389721875e-05
Epoch: 6 cost time: 2.4438893795013428
Epoch: 6, Steps: 262 | Train Loss: 0.3813204 Vali Loss: 0.2903037 Best vali loss: 0.2787194
	iters: 100, epoch: 7 | loss: 0.2672102
	speed: 0.0236s/iter; left time: 10.0207s
	iters: 200, epoch: 7 | loss: 0.4759764
	speed: 0.0065s/iter; left time: 2.1032s
Updating learning rate to 5.6211948609375e-06
Epoch: 7 cost time: 1.8204419612884521
Epoch: 7, Steps: 262 | Train Loss: 0.3715933 Vali Loss: 0.2900688 Best vali loss: 0.2787194
	iters: 100, epoch: 8 | loss: 0.3940524
	speed: 0.0243s/iter; left time: 3.9639s
	iters: 200, epoch: 8 | loss: 0.3920309
	speed: 0.0087s/iter; left time: 0.5455s
Updating learning rate to 2.81059743046875e-06
Epoch: 8 cost time: 2.298720598220825
Epoch: 8, Steps: 262 | Train Loss: 0.3930417 Vali Loss: 0.2909468 Best vali loss: 0.2787194

best validation loss 0.2787193969202423

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0016826337275, 'e_layers': 1, 'learning_rate': 0.0003082016523, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4039387
	speed: 0.0188s/iter; left time: 17.8691s
Updating learning rate to 0.0002964714253730651
Validation loss decreased (inf --> 0.2908).  Saving model state dict ...
Epoch: 1 cost time: 2.0571303367614746
Epoch: 1, Steps: 131 | Train Loss: 0.4039387 Vali Loss: 0.2907529 Best vali loss: 0.2907529
	iters: 100, epoch: 2 | loss: 0.5021112
	speed: 0.0253s/iter; left time: 20.6719s
Updating learning rate to 0.0002630665653071143
Validation loss decreased (0.2908 --> 0.2854).  Saving model state dict ...
Epoch: 2 cost time: 1.85371994972229
Epoch: 2, Steps: 131 | Train Loss: 0.5021112 Vali Loss: 0.2853586 Best vali loss: 0.2853586
	iters: 100, epoch: 3 | loss: 0.4549555
	speed: 0.0242s/iter; left time: 16.6277s
Updating learning rate to 0.000213072659231378
Epoch: 3 cost time: 1.5751452445983887
Epoch: 3, Steps: 131 | Train Loss: 0.4549555 Vali Loss: 0.2915142 Best vali loss: 0.2853586
	iters: 100, epoch: 4 | loss: 0.5590549
	speed: 0.0263s/iter; left time: 14.6205s
Updating learning rate to 0.00015410082615
Epoch: 4 cost time: 2.2911624908447266
Epoch: 4, Steps: 131 | Train Loss: 0.5590549 Vali Loss: 0.2933808 Best vali loss: 0.2853586
	iters: 100, epoch: 5 | loss: 0.4285368
	speed: 0.0305s/iter; left time: 12.9429s
Updating learning rate to 9.512899306862203e-05
Epoch: 5 cost time: 1.9663245677947998
Epoch: 5, Steps: 131 | Train Loss: 0.4285368 Vali Loss: 0.2965382 Best vali loss: 0.2853586
	iters: 100, epoch: 6 | loss: 0.3204660
	speed: 0.0240s/iter; left time: 7.0460s
Updating learning rate to 4.513508699288576e-05
Epoch: 6 cost time: 1.6405434608459473
Epoch: 6, Steps: 131 | Train Loss: 0.3204660 Vali Loss: 0.3009725 Best vali loss: 0.2853586
	iters: 100, epoch: 7 | loss: 0.4221855
	speed: 0.0212s/iter; left time: 3.4604s
Updating learning rate to 1.173022692693493e-05
Epoch: 7 cost time: 1.7420270442962646
Epoch: 7, Steps: 131 | Train Loss: 0.4221855 Vali Loss: 0.3025301 Best vali loss: 0.2853586
	iters: 100, epoch: 8 | loss: 0.3321440
	speed: 0.0244s/iter; left time: 0.7808s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5054726600646973
Epoch: 8, Steps: 131 | Train Loss: 0.3321440 Vali Loss: 0.3050140 Best vali loss: 0.2853586

best validation loss 0.2853585675486227

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.006893795147, 'e_layers': 4, 'learning_rate': 0.0014999585017, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2041886
	speed: 0.0155s/iter; left time: 127.8197s
	iters: 200, epoch: 1 | loss: 0.5380651
	speed: 0.0091s/iter; left time: 74.6232s
	iters: 300, epoch: 1 | loss: 0.2732325
	speed: 0.0094s/iter; left time: 76.1468s
	iters: 400, epoch: 1 | loss: 0.2619412
	speed: 0.0097s/iter; left time: 76.9646s
	iters: 500, epoch: 1 | loss: 0.2023383
	speed: 0.0097s/iter; left time: 76.5743s
	iters: 600, epoch: 1 | loss: 0.7904930
	speed: 0.0090s/iter; left time: 69.7543s
	iters: 700, epoch: 1 | loss: 0.2771855
	speed: 0.0099s/iter; left time: 75.5996s
	iters: 800, epoch: 1 | loss: 0.4048239
	speed: 0.0089s/iter; left time: 67.5394s
	iters: 900, epoch: 1 | loss: 0.2887067
	speed: 0.0097s/iter; left time: 72.0746s
	iters: 1000, epoch: 1 | loss: 0.4146856
	speed: 0.0099s/iter; left time: 72.9639s
Updating learning rate to 0.0014999585017
Validation loss decreased (inf --> 0.2955).  Saving model state dict ...
Epoch: 1 cost time: 10.203980445861816
Epoch: 1, Steps: 1045 | Train Loss: 0.4655660 Vali Loss: 0.2954749 Best vali loss: 0.2954749
	iters: 100, epoch: 2 | loss: 1.2415795
	speed: 0.0272s/iter; left time: 196.1792s
	iters: 200, epoch: 2 | loss: 0.3271493
	speed: 0.0096s/iter; left time: 68.6025s
	iters: 300, epoch: 2 | loss: 0.4226402
	speed: 0.0100s/iter; left time: 70.4147s
	iters: 400, epoch: 2 | loss: 0.3154726
	speed: 0.0098s/iter; left time: 68.1026s
	iters: 500, epoch: 2 | loss: 0.6299329
	speed: 0.0098s/iter; left time: 67.0486s
	iters: 600, epoch: 2 | loss: 1.8579586
	speed: 0.0076s/iter; left time: 50.8043s
	iters: 700, epoch: 2 | loss: 0.2694766
	speed: 0.0082s/iter; left time: 54.5215s
	iters: 800, epoch: 2 | loss: 0.2431940
	speed: 0.0085s/iter; left time: 55.4197s
	iters: 900, epoch: 2 | loss: 0.9360244
	speed: 0.0103s/iter; left time: 65.8559s
	iters: 1000, epoch: 2 | loss: 0.2519873
	speed: 0.0096s/iter; left time: 60.7555s
Updating learning rate to 0.00074997925085
Validation loss decreased (0.2955 --> 0.2856).  Saving model state dict ...
Epoch: 2 cost time: 9.675025463104248
Epoch: 2, Steps: 1045 | Train Loss: 0.6495415 Vali Loss: 0.2855563 Best vali loss: 0.2855563
	iters: 100, epoch: 3 | loss: 0.7726072
	speed: 0.0290s/iter; left time: 179.2311s
	iters: 200, epoch: 3 | loss: 0.5359583
	speed: 0.0091s/iter; left time: 55.0521s
	iters: 300, epoch: 3 | loss: 0.3505662
	speed: 0.0101s/iter; left time: 60.5369s
	iters: 400, epoch: 3 | loss: 0.3501937
	speed: 0.0093s/iter; left time: 54.3752s
	iters: 500, epoch: 3 | loss: 0.3307243
	speed: 0.0085s/iter; left time: 48.9110s
	iters: 600, epoch: 3 | loss: 0.9220185
	speed: 0.0096s/iter; left time: 54.3186s
	iters: 700, epoch: 3 | loss: 2.3297021
	speed: 0.0114s/iter; left time: 63.4969s
	iters: 800, epoch: 3 | loss: 0.3097371
	speed: 0.0121s/iter; left time: 66.4617s
	iters: 900, epoch: 3 | loss: 0.2347665
	speed: 0.0101s/iter; left time: 54.2274s
	iters: 1000, epoch: 3 | loss: 0.3238433
	speed: 0.0094s/iter; left time: 49.5846s
Updating learning rate to 0.000374989625425
Epoch: 3 cost time: 10.490434885025024
Epoch: 3, Steps: 1045 | Train Loss: 0.6460117 Vali Loss: 0.2971344 Best vali loss: 0.2855563
	iters: 100, epoch: 4 | loss: 0.3876479
	speed: 0.0355s/iter; left time: 182.0146s
	iters: 200, epoch: 4 | loss: 0.3345275
	speed: 0.0122s/iter; left time: 61.2614s
	iters: 300, epoch: 4 | loss: 1.0564055
	speed: 0.0117s/iter; left time: 57.6719s
	iters: 400, epoch: 4 | loss: 0.5188931
	speed: 0.0099s/iter; left time: 47.8865s
	iters: 500, epoch: 4 | loss: 0.3496781
	speed: 0.0122s/iter; left time: 57.4411s
	iters: 600, epoch: 4 | loss: 0.4599105
	speed: 0.0118s/iter; left time: 54.7650s
	iters: 700, epoch: 4 | loss: 0.2041001
	speed: 0.0100s/iter; left time: 45.3695s
	iters: 800, epoch: 4 | loss: 0.6052839
	speed: 0.0100s/iter; left time: 44.3003s
	iters: 900, epoch: 4 | loss: 0.2142957
	speed: 0.0085s/iter; left time: 36.5603s
	iters: 1000, epoch: 4 | loss: 0.6403518
	speed: 0.0069s/iter; left time: 29.1520s
Updating learning rate to 0.0001874948127125
Epoch: 4 cost time: 10.855012655258179
Epoch: 4, Steps: 1045 | Train Loss: 0.4771094 Vali Loss: 0.2981323 Best vali loss: 0.2855563
	iters: 100, epoch: 5 | loss: 0.3993427
	speed: 0.0333s/iter; left time: 135.7778s
	iters: 200, epoch: 5 | loss: 0.4293593
	speed: 0.0096s/iter; left time: 38.1681s
	iters: 300, epoch: 5 | loss: 0.2301574
	speed: 0.0098s/iter; left time: 38.0331s
	iters: 400, epoch: 5 | loss: 0.2525485
	speed: 0.0115s/iter; left time: 43.6608s
	iters: 500, epoch: 5 | loss: 0.3495151
	speed: 0.0121s/iter; left time: 44.4895s
	iters: 600, epoch: 5 | loss: 0.2456988
	speed: 0.0095s/iter; left time: 34.1040s
	iters: 700, epoch: 5 | loss: 0.7077716
	speed: 0.0074s/iter; left time: 25.8092s
	iters: 800, epoch: 5 | loss: 0.2295982
	speed: 0.0066s/iter; left time: 22.2944s
	iters: 900, epoch: 5 | loss: 0.3318878
	speed: 0.0065s/iter; left time: 21.2838s
	iters: 1000, epoch: 5 | loss: 0.2074291
	speed: 0.0074s/iter; left time: 23.4202s
Updating learning rate to 9.374740635625e-05
Epoch: 5 cost time: 9.845571517944336
Epoch: 5, Steps: 1045 | Train Loss: 0.3383309 Vali Loss: 0.3034621 Best vali loss: 0.2855563
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0097664278577, 'e_layers': 2, 'learning_rate': 0.0001057270124, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2320820
	speed: 0.0127s/iter; left time: 51.7221s
	iters: 200, epoch: 1 | loss: 0.6318786
	speed: 0.0067s/iter; left time: 26.8386s
	iters: 300, epoch: 1 | loss: 0.4112561
	speed: 0.0100s/iter; left time: 38.8563s
	iters: 400, epoch: 1 | loss: 0.3031784
	speed: 0.0090s/iter; left time: 33.9955s
	iters: 500, epoch: 1 | loss: 0.3487319
	speed: 0.0102s/iter; left time: 37.4782s
Updating learning rate to 0.0001017030175949635
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 4.804107904434204
Epoch: 1, Steps: 523 | Train Loss: 0.3854254 Vali Loss: 0.2800352 Best vali loss: 0.2800352
	iters: 100, epoch: 2 | loss: 0.7522150
	speed: 0.0148s/iter; left time: 52.7452s
	iters: 200, epoch: 2 | loss: 0.5616606
	speed: 0.0088s/iter; left time: 30.3906s
	iters: 300, epoch: 2 | loss: 0.2597323
	speed: 0.0098s/iter; left time: 32.9356s
	iters: 400, epoch: 2 | loss: 0.2960773
	speed: 0.0065s/iter; left time: 21.1573s
	iters: 500, epoch: 2 | loss: 0.3365598
	speed: 0.0080s/iter; left time: 25.3029s
Updating learning rate to 9.024364991131709e-05
Validation loss decreased (0.2800 --> 0.2782).  Saving model state dict ...
Epoch: 2 cost time: 4.062982559204102
Epoch: 2, Steps: 523 | Train Loss: 0.4412490 Vali Loss: 0.2781987 Best vali loss: 0.2781987
	iters: 100, epoch: 3 | loss: 0.4783907
	speed: 0.0153s/iter; left time: 46.5902s
	iters: 200, epoch: 3 | loss: 0.2683486
	speed: 0.0055s/iter; left time: 16.1688s
	iters: 300, epoch: 3 | loss: 0.7303004
	speed: 0.0054s/iter; left time: 15.3531s
	iters: 400, epoch: 3 | loss: 0.2595311
	speed: 0.0097s/iter; left time: 26.5074s
	iters: 500, epoch: 3 | loss: 0.2610680
	speed: 0.0143s/iter; left time: 37.7570s
Updating learning rate to 7.30934941994692e-05
Epoch: 3 cost time: 4.300761461257935
Epoch: 3, Steps: 523 | Train Loss: 0.3995277 Vali Loss: 0.2789315 Best vali loss: 0.2781987

best validation loss 0.2781987445489232

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0062361241479, 'e_layers': 4, 'learning_rate': 0.0001872834497, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.1792919
	speed: 0.0291s/iter; left time: 240.5638s
	iters: 200, epoch: 1 | loss: 0.3451017
	speed: 0.0142s/iter; left time: 116.0585s
	iters: 300, epoch: 1 | loss: 0.4382539
	speed: 0.0101s/iter; left time: 81.6872s
	iters: 400, epoch: 1 | loss: 0.2941424
	speed: 0.0120s/iter; left time: 95.6905s
	iters: 500, epoch: 1 | loss: 0.2892792
	speed: 0.0114s/iter; left time: 89.9703s
	iters: 600, epoch: 1 | loss: 0.6289395
	speed: 0.0114s/iter; left time: 88.3342s
	iters: 700, epoch: 1 | loss: 0.3346727
	speed: 0.0103s/iter; left time: 79.2795s
	iters: 800, epoch: 1 | loss: 0.4194029
	speed: 0.0088s/iter; left time: 66.5294s
	iters: 900, epoch: 1 | loss: 0.2021453
	speed: 0.0081s/iter; left time: 60.6999s
	iters: 1000, epoch: 1 | loss: 0.3017958
	speed: 0.0068s/iter; left time: 50.3150s
Updating learning rate to 0.00018015539782796855
Validation loss decreased (inf --> 0.2904).  Saving model state dict ...
Epoch: 1 cost time: 12.358388185501099
Epoch: 1, Steps: 1045 | Train Loss: 0.3433025 Vali Loss: 0.2903745 Best vali loss: 0.2903745
	iters: 100, epoch: 2 | loss: 0.3272686
	speed: 0.0355s/iter; left time: 256.3887s
	iters: 200, epoch: 2 | loss: 0.5188985
	speed: 0.0112s/iter; left time: 79.3934s
	iters: 300, epoch: 2 | loss: 0.8498086
	speed: 0.0112s/iter; left time: 78.2976s
	iters: 400, epoch: 2 | loss: 1.0061225
	speed: 0.0100s/iter; left time: 69.1641s
	iters: 500, epoch: 2 | loss: 0.3940930
	speed: 0.0112s/iter; left time: 76.3465s
	iters: 600, epoch: 2 | loss: 0.2369861
	speed: 0.0112s/iter; left time: 75.2722s
	iters: 700, epoch: 2 | loss: 0.1586418
	speed: 0.0114s/iter; left time: 75.4277s
	iters: 800, epoch: 2 | loss: 0.7842315
	speed: 0.0112s/iter; left time: 72.8836s
	iters: 900, epoch: 2 | loss: 0.3002132
	speed: 0.0107s/iter; left time: 68.6475s
	iters: 1000, epoch: 2 | loss: 0.2483035
	speed: 0.0079s/iter; left time: 50.1686s
Updating learning rate to 0.00015985642349343983
Epoch: 2 cost time: 11.038948059082031
Epoch: 2, Steps: 1045 | Train Loss: 0.4824567 Vali Loss: 0.2920024 Best vali loss: 0.2903745
	iters: 100, epoch: 3 | loss: 0.8726872
	speed: 0.0317s/iter; left time: 195.6377s
	iters: 200, epoch: 3 | loss: 0.2059466
	speed: 0.0121s/iter; left time: 73.5593s
	iters: 300, epoch: 3 | loss: 0.6633820
	speed: 0.0112s/iter; left time: 67.1235s
	iters: 400, epoch: 3 | loss: 0.3769336
	speed: 0.0115s/iter; left time: 67.3462s
	iters: 500, epoch: 3 | loss: 0.2734849
	speed: 0.0121s/iter; left time: 69.7140s
	iters: 600, epoch: 3 | loss: 0.1947117
	speed: 0.0122s/iter; left time: 69.4563s
	iters: 700, epoch: 3 | loss: 0.2792752
	speed: 0.0121s/iter; left time: 67.1395s
	iters: 800, epoch: 3 | loss: 0.3782304
	speed: 0.0097s/iter; left time: 52.9274s
	iters: 900, epoch: 3 | loss: 0.3641991
	speed: 0.0089s/iter; left time: 47.7767s
	iters: 1000, epoch: 3 | loss: 0.4886238
	speed: 0.0111s/iter; left time: 58.3721s
Updating learning rate to 0.00012947686152818533
Epoch: 3 cost time: 11.85001540184021
Epoch: 3, Steps: 1045 | Train Loss: 0.4097474 Vali Loss: 0.3031448 Best vali loss: 0.2903745

best validation loss 0.2903744540734555

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0014959330094, 'e_layers': 1, 'learning_rate': 0.0010855017485, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7303027
	speed: 0.0118s/iter; left time: 48.3915s
	iters: 200, epoch: 1 | loss: 0.4096775
	speed: 0.0054s/iter; left time: 21.3317s
	iters: 300, epoch: 1 | loss: 0.3763124
	speed: 0.0051s/iter; left time: 19.8485s
	iters: 400, epoch: 1 | loss: 0.4004144
	speed: 0.0051s/iter; left time: 19.4323s
	iters: 500, epoch: 1 | loss: 0.4332480
	speed: 0.0049s/iter; left time: 17.8799s
Updating learning rate to 0.0010855017485
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 3.0440897941589355
Epoch: 1, Steps: 523 | Train Loss: 0.4699910 Vali Loss: 0.2831158 Best vali loss: 0.2831158
	iters: 100, epoch: 2 | loss: 0.2587205
	speed: 0.0138s/iter; left time: 49.1210s
	iters: 200, epoch: 2 | loss: 0.2586649
	speed: 0.0050s/iter; left time: 17.4498s
	iters: 300, epoch: 2 | loss: 0.3375683
	speed: 0.0052s/iter; left time: 17.3978s
	iters: 400, epoch: 2 | loss: 0.3742775
	speed: 0.0049s/iter; left time: 15.9595s
	iters: 500, epoch: 2 | loss: 0.6990330
	speed: 0.0043s/iter; left time: 13.5408s
Updating learning rate to 0.00054275087425
Epoch: 2 cost time: 2.5823137760162354
Epoch: 2, Steps: 523 | Train Loss: 0.3856528 Vali Loss: 0.2896587 Best vali loss: 0.2831158
	iters: 100, epoch: 3 | loss: 0.4605060
	speed: 0.0147s/iter; left time: 44.7109s
	iters: 200, epoch: 3 | loss: 0.6776569
	speed: 0.0049s/iter; left time: 14.2664s
	iters: 300, epoch: 3 | loss: 0.6572070
	speed: 0.0049s/iter; left time: 13.8608s
	iters: 400, epoch: 3 | loss: 0.7630651
	speed: 0.0049s/iter; left time: 13.4525s
	iters: 500, epoch: 3 | loss: 0.7156928
	speed: 0.0045s/iter; left time: 11.9950s
Updating learning rate to 0.000271375437125
Epoch: 3 cost time: 2.57319974899292
Epoch: 3, Steps: 523 | Train Loss: 0.6548256 Vali Loss: 0.2845680 Best vali loss: 0.2831158

best validation loss 0.28311581972275757

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0097664278577, 'e_layers': 2, 'learning_rate': 0.0001057270124, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.1952188
	speed: 0.0145s/iter; left time: 36.5665s
	iters: 200, epoch: 4 | loss: 0.4486547
	speed: 0.0060s/iter; left time: 14.4384s
	iters: 300, epoch: 4 | loss: 0.4041514
	speed: 0.0071s/iter; left time: 16.5575s
	iters: 400, epoch: 4 | loss: 0.2744000
	speed: 0.0067s/iter; left time: 14.8486s
	iters: 500, epoch: 4 | loss: 0.3160717
	speed: 0.0071s/iter; left time: 15.0864s
Updating learning rate to 5.28635062e-05
Epoch: 4 cost time: 3.8732354640960693
Epoch: 4, Steps: 523 | Train Loss: 0.3276993 Vali Loss: 0.2806196 Best vali loss: 0.2781987
	iters: 100, epoch: 5 | loss: 0.4810278
	speed: 0.0135s/iter; left time: 26.8776s
	iters: 200, epoch: 5 | loss: 0.5295527
	speed: 0.0069s/iter; left time: 13.1100s
	iters: 300, epoch: 5 | loss: 0.2504623
	speed: 0.0068s/iter; left time: 12.1030s
	iters: 400, epoch: 5 | loss: 0.3032705
	speed: 0.0066s/iter; left time: 11.2368s
	iters: 500, epoch: 5 | loss: 0.3501272
	speed: 0.0065s/iter; left time: 10.4150s
Updating learning rate to 3.2633518200530796e-05
Epoch: 5 cost time: 3.5148019790649414
Epoch: 5, Steps: 523 | Train Loss: 0.3828881 Vali Loss: 0.2821205 Best vali loss: 0.2781987
	iters: 100, epoch: 6 | loss: 0.4990185
	speed: 0.0162s/iter; left time: 23.8795s
	iters: 200, epoch: 6 | loss: 0.2743635
	speed: 0.0068s/iter; left time: 9.3407s
	iters: 300, epoch: 6 | loss: 0.6739528
	speed: 0.0064s/iter; left time: 8.1105s
	iters: 400, epoch: 6 | loss: 0.2483044
	speed: 0.0069s/iter; left time: 8.1131s
	iters: 500, epoch: 6 | loss: 0.2470346
	speed: 0.0067s/iter; left time: 7.1286s
Updating learning rate to 1.5483362488682904e-05
Epoch: 6 cost time: 3.5872135162353516
Epoch: 6, Steps: 523 | Train Loss: 0.3885348 Vali Loss: 0.2866204 Best vali loss: 0.2781987
	iters: 100, epoch: 7 | loss: 1.0068117
	speed: 0.0165s/iter; left time: 15.5956s
	iters: 200, epoch: 7 | loss: 0.4429970
	speed: 0.0067s/iter; left time: 5.6446s
	iters: 300, epoch: 7 | loss: 1.0008801
	speed: 0.0071s/iter; left time: 5.3209s
	iters: 400, epoch: 7 | loss: 0.2711835
	speed: 0.0066s/iter; left time: 4.3009s
	iters: 500, epoch: 7 | loss: 0.6179596
	speed: 0.0068s/iter; left time: 3.7279s
Updating learning rate to 4.0239948050364915e-06
Epoch: 7 cost time: 3.569218635559082
Epoch: 7, Steps: 523 | Train Loss: 0.6679664 Vali Loss: 0.2885677 Best vali loss: 0.2781987
	iters: 100, epoch: 8 | loss: 0.5422572
	speed: 0.0130s/iter; left time: 5.4965s
	iters: 200, epoch: 8 | loss: 0.2938196
	speed: 0.0065s/iter; left time: 2.0937s
	iters: 300, epoch: 8 | loss: 0.5033472
	speed: 0.0068s/iter; left time: 1.5276s
	iters: 400, epoch: 8 | loss: 0.3604797
	speed: 0.0068s/iter; left time: 0.8454s
	iters: 500, epoch: 8 | loss: 0.2856902
	speed: 0.0069s/iter; left time: 0.1660s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4761815071105957
Epoch: 8, Steps: 523 | Train Loss: 0.3971188 Vali Loss: 0.2883379 Best vali loss: 0.2781987

best validation loss 0.2781987445489232

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0008236849278, 'e_layers': 4, 'learning_rate': 0.0005271398534, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7514964
	speed: 0.0158s/iter; left time: 64.7209s
	iters: 200, epoch: 1 | loss: 0.2913361
	speed: 0.0106s/iter; left time: 42.3242s
	iters: 300, epoch: 1 | loss: 0.3940456
	speed: 0.0104s/iter; left time: 40.2926s
	iters: 400, epoch: 1 | loss: 0.4266094
	speed: 0.0103s/iter; left time: 39.0653s
	iters: 500, epoch: 1 | loss: 0.1808195
	speed: 0.0102s/iter; left time: 37.7031s
Updating learning rate to 0.0005271398534
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 5.6788554191589355
Epoch: 1, Steps: 523 | Train Loss: 0.4088614 Vali Loss: 0.2838033 Best vali loss: 0.2838033
	iters: 100, epoch: 2 | loss: 0.7529258
	speed: 0.0221s/iter; left time: 78.6949s
	iters: 200, epoch: 2 | loss: 0.2496867
	speed: 0.0113s/iter; left time: 39.2497s
	iters: 300, epoch: 2 | loss: 0.8366231
	speed: 0.0112s/iter; left time: 37.7952s
	iters: 400, epoch: 2 | loss: 0.6524369
	speed: 0.0105s/iter; left time: 34.3543s
	iters: 500, epoch: 2 | loss: 1.1654354
	speed: 0.0109s/iter; left time: 34.5541s
Updating learning rate to 0.0002635699267
Epoch: 2 cost time: 5.838483810424805
Epoch: 2, Steps: 523 | Train Loss: 0.7314216 Vali Loss: 0.2859882 Best vali loss: 0.2838033
	iters: 100, epoch: 3 | loss: 0.4900292
	speed: 0.0226s/iter; left time: 68.5579s
	iters: 200, epoch: 3 | loss: 0.2896996
	speed: 0.0110s/iter; left time: 32.2862s
	iters: 300, epoch: 3 | loss: 0.2527470
	speed: 0.0113s/iter; left time: 31.9482s
	iters: 400, epoch: 3 | loss: 0.2454836
	speed: 0.0113s/iter; left time: 31.0300s
	iters: 500, epoch: 3 | loss: 0.4201977
	speed: 0.0107s/iter; left time: 28.2459s
Updating learning rate to 0.00013178496335
Epoch: 3 cost time: 5.785703420639038
Epoch: 3, Steps: 523 | Train Loss: 0.3396314 Vali Loss: 0.2875468 Best vali loss: 0.2838033
	iters: 100, epoch: 4 | loss: 0.2240793
	speed: 0.0211s/iter; left time: 53.0795s
	iters: 200, epoch: 4 | loss: 0.7080548
	speed: 0.0103s/iter; left time: 24.9815s
	iters: 300, epoch: 4 | loss: 0.4221337
	speed: 0.0108s/iter; left time: 24.9948s
	iters: 400, epoch: 4 | loss: 0.3127073
	speed: 0.0110s/iter; left time: 24.3377s
	iters: 500, epoch: 4 | loss: 0.9653718
	speed: 0.0102s/iter; left time: 21.6542s
Updating learning rate to 6.5892481675e-05
Epoch: 4 cost time: 5.529947519302368
Epoch: 4, Steps: 523 | Train Loss: 0.5264694 Vali Loss: 0.2881427 Best vali loss: 0.2838033
	iters: 100, epoch: 5 | loss: 0.3696923
	speed: 0.0247s/iter; left time: 49.2557s
	iters: 200, epoch: 5 | loss: 0.4451503
	speed: 0.0178s/iter; left time: 33.6948s
	iters: 300, epoch: 5 | loss: 0.4193320
	speed: 0.0173s/iter; left time: 30.9494s
	iters: 400, epoch: 5 | loss: 0.2842272
	speed: 0.0109s/iter; left time: 18.4474s
	iters: 500, epoch: 5 | loss: 0.3587483
	speed: 0.0094s/iter; left time: 14.9415s
Updating learning rate to 3.29462408375e-05
Epoch: 5 cost time: 7.177948713302612
Epoch: 5, Steps: 523 | Train Loss: 0.3754300 Vali Loss: 0.2958520 Best vali loss: 0.2838033
	iters: 100, epoch: 6 | loss: 0.9653157
	speed: 0.0213s/iter; left time: 31.3152s
	iters: 200, epoch: 6 | loss: 0.5465244
	speed: 0.0108s/iter; left time: 14.7492s
	iters: 300, epoch: 6 | loss: 0.1907494
	speed: 0.0108s/iter; left time: 13.7229s
	iters: 400, epoch: 6 | loss: 0.2868493
	speed: 0.0109s/iter; left time: 12.7203s
	iters: 500, epoch: 6 | loss: 0.4216710
	speed: 0.0107s/iter; left time: 11.4722s
Updating learning rate to 1.647312041875e-05
Epoch: 6 cost time: 5.6855902671813965
Epoch: 6, Steps: 523 | Train Loss: 0.4822220 Vali Loss: 0.2957733 Best vali loss: 0.2838033
	iters: 100, epoch: 7 | loss: 0.2531952
	speed: 0.0218s/iter; left time: 20.6636s
	iters: 200, epoch: 7 | loss: 0.6078466
	speed: 0.0100s/iter; left time: 8.4693s
	iters: 300, epoch: 7 | loss: 0.4146897
	speed: 0.0106s/iter; left time: 7.9458s
	iters: 400, epoch: 7 | loss: 0.3958439
	speed: 0.0088s/iter; left time: 5.7077s
	iters: 500, epoch: 7 | loss: 0.6976810
	speed: 0.0086s/iter; left time: 4.6975s
Updating learning rate to 8.236560209375e-06
Epoch: 7 cost time: 5.023737907409668
Epoch: 7, Steps: 523 | Train Loss: 0.4738513 Vali Loss: 0.2948713 Best vali loss: 0.2838033
	iters: 100, epoch: 8 | loss: 0.3683234
	speed: 0.0165s/iter; left time: 6.9765s
	iters: 200, epoch: 8 | loss: 0.2089480
	speed: 0.0074s/iter; left time: 2.4090s
	iters: 300, epoch: 8 | loss: 0.3159903
	speed: 0.0072s/iter; left time: 1.6195s
	iters: 400, epoch: 8 | loss: 0.4751346
	speed: 0.0112s/iter; left time: 1.3921s
	iters: 500, epoch: 8 | loss: 0.2656665
	speed: 0.0109s/iter; left time: 0.2604s
Updating learning rate to 4.1182801046875e-06
Epoch: 8 cost time: 4.8347368240356445
Epoch: 8, Steps: 523 | Train Loss: 0.3268126 Vali Loss: 0.2965210 Best vali loss: 0.2838033

best validation loss 0.2838032999061749

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008713839742, 'e_layers': 4, 'learning_rate': 0.0003041288181, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4887718
	speed: 0.0210s/iter; left time: 41.9211s
	iters: 200, epoch: 1 | loss: 0.4356448
	speed: 0.0144s/iter; left time: 27.3478s
Updating learning rate to 0.0002925536041947191
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 4.18802809715271
Epoch: 1, Steps: 262 | Train Loss: 0.4622083 Vali Loss: 0.2843756 Best vali loss: 0.2843756
	iters: 100, epoch: 2 | loss: 0.6514570
	speed: 0.0476s/iter; left time: 82.5569s
	iters: 200, epoch: 2 | loss: 0.4326244
	speed: 0.0106s/iter; left time: 17.3527s
Updating learning rate to 0.00025959018386638
Epoch: 2 cost time: 2.8185179233551025
Epoch: 2, Steps: 262 | Train Loss: 0.5420407 Vali Loss: 0.2905385 Best vali loss: 0.2843756
	iters: 100, epoch: 3 | loss: 0.4035458
	speed: 0.0317s/iter; left time: 46.7294s
	iters: 200, epoch: 3 | loss: 0.5069623
	speed: 0.0089s/iter; left time: 12.2798s
Updating learning rate to 0.00021025693904582304
Epoch: 3 cost time: 2.626910448074341
Epoch: 3, Steps: 262 | Train Loss: 0.4552541 Vali Loss: 0.2996791 Best vali loss: 0.2843756
	iters: 100, epoch: 4 | loss: 0.5863589
	speed: 0.0203s/iter; left time: 24.6162s
	iters: 200, epoch: 4 | loss: 0.4845042
	speed: 0.0091s/iter; left time: 10.1632s
Updating learning rate to 0.00015206440905
Epoch: 4 cost time: 2.457954168319702
Epoch: 4, Steps: 262 | Train Loss: 0.5354315 Vali Loss: 0.2861842 Best vali loss: 0.2843756
	iters: 100, epoch: 5 | loss: 0.1592073
	speed: 0.0181s/iter; left time: 17.1376s
	iters: 200, epoch: 5 | loss: 0.4559035
	speed: 0.0072s/iter; left time: 6.1246s
Updating learning rate to 9.387187905417698e-05
Epoch: 5 cost time: 1.9887750148773193
Epoch: 5, Steps: 262 | Train Loss: 0.3075554 Vali Loss: 0.3086850 Best vali loss: 0.2843756
	iters: 100, epoch: 6 | loss: 0.3431831
	speed: 0.0178s/iter; left time: 12.2573s
	iters: 200, epoch: 6 | loss: 0.4776402
	speed: 0.0099s/iter; left time: 5.7975s
Updating learning rate to 4.453863423362e-05
Epoch: 6 cost time: 2.597846269607544
Epoch: 6, Steps: 262 | Train Loss: 0.4104116 Vali Loss: 0.3295056 Best vali loss: 0.2843756
	iters: 100, epoch: 7 | loss: 0.2702655
	speed: 0.0183s/iter; left time: 7.7633s
	iters: 200, epoch: 7 | loss: 0.3044633
	speed: 0.0097s/iter; left time: 3.1661s
Updating learning rate to 1.1575213905280919e-05
Epoch: 7 cost time: 2.37398099899292
Epoch: 7, Steps: 262 | Train Loss: 0.2873644 Vali Loss: 0.3113477 Best vali loss: 0.2843756
	iters: 100, epoch: 8 | loss: 0.1839748
	speed: 0.0214s/iter; left time: 3.4895s
	iters: 200, epoch: 8 | loss: 0.3695471
	speed: 0.0094s/iter; left time: 0.5917s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5377197265625
Epoch: 8, Steps: 262 | Train Loss: 0.2767609 Vali Loss: 0.3211785 Best vali loss: 0.2843756

best validation loss 0.2843755663338981

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0011698554741, 'e_layers': 2, 'learning_rate': 0.000459370031, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5710513
	speed: 0.0142s/iter; left time: 28.2777s
	iters: 200, epoch: 1 | loss: 0.6276433
	speed: 0.0077s/iter; left time: 14.5639s
Updating learning rate to 0.0004418863002449876
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 2.381943464279175
Epoch: 1, Steps: 262 | Train Loss: 0.5993473 Vali Loss: 0.2867340 Best vali loss: 0.2867340
	iters: 100, epoch: 2 | loss: 0.6588689
	speed: 0.0175s/iter; left time: 30.3684s
	iters: 200, epoch: 2 | loss: 0.5639208
	speed: 0.0076s/iter; left time: 12.3932s
Updating learning rate to 0.0003920968474969873
Validation loss decreased (0.2867 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 2.062804698944092
Epoch: 2, Steps: 262 | Train Loss: 0.6113949 Vali Loss: 0.2843245 Best vali loss: 0.2843245
	iters: 100, epoch: 3 | loss: 0.5616708
	speed: 0.0173s/iter; left time: 25.4406s
	iters: 200, epoch: 3 | loss: 0.9087959
	speed: 0.0078s/iter; left time: 10.7280s
Updating learning rate to 0.00031758166559436884
Epoch: 3 cost time: 2.0606529712677
Epoch: 3, Steps: 262 | Train Loss: 0.7352334 Vali Loss: 0.2874090 Best vali loss: 0.2843245

best validation loss 0.2843245018554824

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0246521
	speed: 0.0123s/iter; left time: 50.3861s
	iters: 200, epoch: 1 | loss: 0.2399259
	speed: 0.0060s/iter; left time: 24.0852s
	iters: 300, epoch: 1 | loss: 0.3208180
	speed: 0.0063s/iter; left time: 24.4040s
	iters: 400, epoch: 1 | loss: 0.8198326
	speed: 0.0062s/iter; left time: 23.6373s
	iters: 500, epoch: 1 | loss: 0.6980167
	speed: 0.0055s/iter; left time: 20.4087s
Updating learning rate to 0.0008497821375614502
Validation loss decreased (inf --> 0.2928).  Saving model state dict ...
Epoch: 1 cost time: 3.4684505462646484
Epoch: 1, Steps: 523 | Train Loss: 0.6206491 Vali Loss: 0.2928238 Best vali loss: 0.2928238
	iters: 100, epoch: 2 | loss: 0.7262076
	speed: 0.0149s/iter; left time: 53.0713s
	iters: 200, epoch: 2 | loss: 0.5265979
	speed: 0.0072s/iter; left time: 24.9200s
	iters: 300, epoch: 2 | loss: 0.2893936
	speed: 0.0070s/iter; left time: 23.6191s
	iters: 400, epoch: 2 | loss: 0.3146605
	speed: 0.0066s/iter; left time: 21.4783s
	iters: 500, epoch: 2 | loss: 0.7289470
	speed: 0.0061s/iter; left time: 19.3655s
Updating learning rate to 0.0007540331008505288
Validation loss decreased (0.2928 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 3.6033482551574707
Epoch: 2, Steps: 523 | Train Loss: 0.5171613 Vali Loss: 0.2838123 Best vali loss: 0.2838123
	iters: 100, epoch: 3 | loss: 0.3225764
	speed: 0.0174s/iter; left time: 52.8324s
	iters: 200, epoch: 3 | loss: 0.3469073
	speed: 0.0069s/iter; left time: 20.2585s
	iters: 300, epoch: 3 | loss: 0.9845026
	speed: 0.0057s/iter; left time: 16.1259s
	iters: 400, epoch: 3 | loss: 0.5150281
	speed: 0.0068s/iter; left time: 18.6521s
	iters: 500, epoch: 3 | loss: 0.5677084
	speed: 0.0074s/iter; left time: 19.5488s
Updating learning rate to 0.0006107345407392943
Epoch: 3 cost time: 3.6048214435577393
Epoch: 3, Steps: 523 | Train Loss: 0.5473445 Vali Loss: 0.2935537 Best vali loss: 0.2838123

best validation loss 0.28381234135890193

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0069076078339, 'e_layers': 2, 'learning_rate': 0.0024055444801, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6484305
	speed: 0.0153s/iter; left time: 14.4835s
Updating learning rate to 0.0023139888949049474
Validation loss decreased (inf --> 0.3186).  Saving model state dict ...
Epoch: 1 cost time: 1.4640824794769287
Epoch: 1, Steps: 131 | Train Loss: 0.6484305 Vali Loss: 0.3186088 Best vali loss: 0.3186088
	iters: 100, epoch: 2 | loss: 0.6346540
	speed: 0.0141s/iter; left time: 11.5693s
Updating learning rate to 0.002053260647212289
Validation loss decreased (0.3186 --> 0.2903).  Saving model state dict ...
Epoch: 2 cost time: 1.1093451976776123
Epoch: 2, Steps: 131 | Train Loss: 0.6346540 Vali Loss: 0.2902757 Best vali loss: 0.2902757
	iters: 100, epoch: 3 | loss: 0.6104856
	speed: 0.0140s/iter; left time: 9.6437s
Updating learning rate to 0.0016630532492257818
Validation loss decreased (0.2903 --> 0.2877).  Saving model state dict ...
Epoch: 3 cost time: 1.1389765739440918
Epoch: 3, Steps: 131 | Train Loss: 0.6104856 Vali Loss: 0.2877409 Best vali loss: 0.2877409

best validation loss 0.2877409151824889

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8917351
	speed: 0.0130s/iter; left time: 32.6579s
	iters: 200, epoch: 4 | loss: 0.2057282
	speed: 0.0073s/iter; left time: 17.6853s
	iters: 300, epoch: 4 | loss: 0.3179026
	speed: 0.0076s/iter; left time: 17.6900s
	iters: 400, epoch: 4 | loss: 0.6882587
	speed: 0.0066s/iter; left time: 14.5213s
	iters: 500, epoch: 4 | loss: 0.4929458
	speed: 0.0054s/iter; left time: 11.5089s
Updating learning rate to 0.000441702364
Epoch: 4 cost time: 3.764163017272949
Epoch: 4, Steps: 523 | Train Loss: 0.5193141 Vali Loss: 0.2990394 Best vali loss: 0.2838123
	iters: 100, epoch: 5 | loss: 0.6574958
	speed: 0.0157s/iter; left time: 31.2822s
	iters: 200, epoch: 5 | loss: 0.4708249
	speed: 0.0068s/iter; left time: 12.9437s
	iters: 300, epoch: 5 | loss: 0.2628331
	speed: 0.0070s/iter; left time: 12.4624s
	iters: 400, epoch: 5 | loss: 0.2635265
	speed: 0.0069s/iter; left time: 11.7279s
	iters: 500, epoch: 5 | loss: 0.4774255
	speed: 0.0068s/iter; left time: 10.8775s
Updating learning rate to 0.0002726701872607057
Epoch: 5 cost time: 3.6245105266571045
Epoch: 5, Steps: 523 | Train Loss: 0.4264212 Vali Loss: 0.3016124 Best vali loss: 0.2838123
	iters: 100, epoch: 6 | loss: 0.3133096
	speed: 0.0159s/iter; left time: 23.3486s
	iters: 200, epoch: 6 | loss: 0.2598295
	speed: 0.0059s/iter; left time: 8.1440s
	iters: 300, epoch: 6 | loss: 0.7345582
	speed: 0.0061s/iter; left time: 7.7752s
	iters: 400, epoch: 6 | loss: 0.3363776
	speed: 0.0062s/iter; left time: 7.2798s
	iters: 500, epoch: 6 | loss: 0.3953646
	speed: 0.0062s/iter; left time: 6.6409s
Updating learning rate to 0.00012937162714947125
Epoch: 6 cost time: 3.2726314067840576
Epoch: 6, Steps: 523 | Train Loss: 0.4078879 Vali Loss: 0.3041428 Best vali loss: 0.2838123
	iters: 100, epoch: 7 | loss: 0.2590068
	speed: 0.0142s/iter; left time: 13.4498s
	iters: 200, epoch: 7 | loss: 0.4602561
	speed: 0.0057s/iter; left time: 4.8048s
	iters: 300, epoch: 7 | loss: 0.3944608
	speed: 0.0056s/iter; left time: 4.1655s
	iters: 400, epoch: 7 | loss: 0.3510754
	speed: 0.0055s/iter; left time: 3.5262s
	iters: 500, epoch: 7 | loss: 0.4908541
	speed: 0.0061s/iter; left time: 3.3179s
Updating learning rate to 3.362259043854979e-05
Epoch: 7 cost time: 3.059731960296631
Epoch: 7, Steps: 523 | Train Loss: 0.3911306 Vali Loss: 0.3060797 Best vali loss: 0.2838123
	iters: 100, epoch: 8 | loss: 0.3621748
	speed: 0.0156s/iter; left time: 6.5975s
	iters: 200, epoch: 8 | loss: 0.5492440
	speed: 0.0071s/iter; left time: 2.2907s
	iters: 300, epoch: 8 | loss: 0.3956331
	speed: 0.0072s/iter; left time: 1.6156s
	iters: 400, epoch: 8 | loss: 0.3554797
	speed: 0.0071s/iter; left time: 0.8839s
	iters: 500, epoch: 8 | loss: 0.5445756
	speed: 0.0070s/iter; left time: 0.1683s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.737590789794922
Epoch: 8, Steps: 523 | Train Loss: 0.4414214 Vali Loss: 0.3099085 Best vali loss: 0.2838123

best validation loss 0.28381234135890193

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0009305903137, 'e_layers': 3, 'learning_rate': 0.0036527249844, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0035137014176898846
Validation loss decreased (inf --> 0.3248).  Saving model state dict ...
Epoch: 1 cost time: 1.0183250904083252
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3248276 Best vali loss: 0.3248276
Updating learning rate to 0.003117795795339383
Validation loss decreased (0.3248 --> 0.3222).  Saving model state dict ...
Epoch: 2 cost time: 0.8831696510314941
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3221561 Best vali loss: 0.3221561
Updating learning rate to 0.0025252811594579554
Validation loss decreased (0.3222 --> 0.3207).  Saving model state dict ...
Epoch: 3 cost time: 0.9225192070007324
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3206780 Best vali loss: 0.3206780
Updating learning rate to 0.0018263624922
Validation loss decreased (0.3207 --> 0.3159).  Saving model state dict ...
Epoch: 4 cost time: 0.7926802635192871
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3159019 Best vali loss: 0.3159019
Updating learning rate to 0.0011274438249420445
Epoch: 5 cost time: 0.7932636737823486
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3242500 Best vali loss: 0.3159019
Updating learning rate to 0.0005349291890606171
Epoch: 6 cost time: 0.8055295944213867
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3268531 Best vali loss: 0.3159019
Updating learning rate to 0.0001390235667101154
Epoch: 7 cost time: 0.7938756942749023
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3212746 Best vali loss: 0.3159019
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7893471717834473
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3219254 Best vali loss: 0.3159019

best validation loss 0.31590194222141527

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0113367829942, 'e_layers': 1, 'learning_rate': 0.0037988505147, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4807253
	speed: 0.0115s/iter; left time: 46.8787s
	iters: 200, epoch: 1 | loss: 0.4849709
	speed: 0.0053s/iter; left time: 20.9579s
	iters: 300, epoch: 1 | loss: 0.2771578
	speed: 0.0051s/iter; left time: 19.7333s
	iters: 400, epoch: 1 | loss: 0.2504719
	speed: 0.0049s/iter; left time: 18.4944s
	iters: 500, epoch: 1 | loss: 0.1790294
	speed: 0.0051s/iter; left time: 18.6778s
Updating learning rate to 0.0036542653761506482
Validation loss decreased (inf --> 0.2915).  Saving model state dict ...
Epoch: 1 cost time: 3.011384963989258
Epoch: 1, Steps: 523 | Train Loss: 0.3344711 Vali Loss: 0.2914581 Best vali loss: 0.2914581
	iters: 100, epoch: 2 | loss: 0.5632986
	speed: 0.0139s/iter; left time: 49.6243s
	iters: 200, epoch: 2 | loss: 0.6601288
	speed: 0.0047s/iter; left time: 16.4244s
	iters: 300, epoch: 2 | loss: 0.4733159
	speed: 0.0046s/iter; left time: 15.5297s
	iters: 400, epoch: 2 | loss: 0.3897522
	speed: 0.0048s/iter; left time: 15.6581s
	iters: 500, epoch: 2 | loss: 0.8066686
	speed: 0.0052s/iter; left time: 16.3119s
Updating learning rate to 0.003242521737179188
Epoch: 2 cost time: 2.5734987258911133
Epoch: 2, Steps: 523 | Train Loss: 0.5786328 Vali Loss: 0.3120222 Best vali loss: 0.2914581
	iters: 100, epoch: 3 | loss: 0.6015651
	speed: 0.0132s/iter; left time: 40.0574s
	iters: 200, epoch: 3 | loss: 0.7228168
	speed: 0.0043s/iter; left time: 12.7627s
	iters: 300, epoch: 3 | loss: 0.3759623
	speed: 0.0051s/iter; left time: 14.4001s
	iters: 400, epoch: 3 | loss: 0.3484267
	speed: 0.0048s/iter; left time: 13.0522s
	iters: 500, epoch: 3 | loss: 0.2243158
	speed: 0.0044s/iter; left time: 11.7305s
Updating learning rate to 0.002626303834353642
Epoch: 3 cost time: 2.4539523124694824
Epoch: 3, Steps: 523 | Train Loss: 0.4546174 Vali Loss: 0.3262957 Best vali loss: 0.2914581
	iters: 100, epoch: 4 | loss: 1.2395799
	speed: 0.0132s/iter; left time: 33.3340s
	iters: 200, epoch: 4 | loss: 0.5225108
	speed: 0.0048s/iter; left time: 11.7022s
	iters: 300, epoch: 4 | loss: 0.4432324
	speed: 0.0050s/iter; left time: 11.6205s
	iters: 400, epoch: 4 | loss: 0.3747940
	speed: 0.0051s/iter; left time: 11.3233s
	iters: 500, epoch: 4 | loss: 1.0842060
	speed: 0.0051s/iter; left time: 10.7220s
Updating learning rate to 0.00189942525735
Epoch: 4 cost time: 2.665677070617676
Epoch: 4, Steps: 523 | Train Loss: 0.7328646 Vali Loss: 0.3429528 Best vali loss: 0.2914581
	iters: 100, epoch: 5 | loss: 0.2290134
	speed: 0.0138s/iter; left time: 27.5082s
	iters: 200, epoch: 5 | loss: 0.4938947
	speed: 0.0048s/iter; left time: 9.1794s
	iters: 300, epoch: 5 | loss: 0.3726035
	speed: 0.0049s/iter; left time: 8.7612s
	iters: 400, epoch: 5 | loss: 0.4052286
	speed: 0.0044s/iter; left time: 7.4737s
	iters: 500, epoch: 5 | loss: 0.6344673
	speed: 0.0042s/iter; left time: 6.7302s
Updating learning rate to 0.001172546680346358
Epoch: 5 cost time: 2.47859787940979
Epoch: 5, Steps: 523 | Train Loss: 0.4270415 Vali Loss: 0.3731808 Best vali loss: 0.2914581
	iters: 100, epoch: 6 | loss: 0.3420298
	speed: 0.0124s/iter; left time: 18.2552s
	iters: 200, epoch: 6 | loss: 0.4798624
	speed: 0.0052s/iter; left time: 7.1090s
	iters: 300, epoch: 6 | loss: 0.4799134
	speed: 0.0053s/iter; left time: 6.6931s
	iters: 400, epoch: 6 | loss: 0.6992389
	speed: 0.0052s/iter; left time: 6.0412s
	iters: 500, epoch: 6 | loss: 0.2595615
	speed: 0.0051s/iter; left time: 5.4349s
Updating learning rate to 0.000556328777520812
Epoch: 6 cost time: 2.7388365268707275
Epoch: 6, Steps: 523 | Train Loss: 0.4521212 Vali Loss: 0.3631974 Best vali loss: 0.2914581
	iters: 100, epoch: 7 | loss: 0.2522964
	speed: 0.0137s/iter; left time: 12.9343s
	iters: 200, epoch: 7 | loss: 0.5479509
	speed: 0.0053s/iter; left time: 4.5213s
	iters: 300, epoch: 7 | loss: 0.4689072
	speed: 0.0049s/iter; left time: 3.6474s
	iters: 400, epoch: 7 | loss: 0.4295502
	speed: 0.0049s/iter; left time: 3.1659s
	iters: 500, epoch: 7 | loss: 0.2986778
	speed: 0.0047s/iter; left time: 2.5916s
Updating learning rate to 0.0001445851385493515
Epoch: 7 cost time: 2.6412620544433594
Epoch: 7, Steps: 523 | Train Loss: 0.3994765 Vali Loss: 0.3866173 Best vali loss: 0.2914581
	iters: 100, epoch: 8 | loss: 0.2236865
	speed: 0.0131s/iter; left time: 5.5753s
	iters: 200, epoch: 8 | loss: 0.2035796
	speed: 0.0051s/iter; left time: 1.6433s
	iters: 300, epoch: 8 | loss: 0.4551616
	speed: 0.0051s/iter; left time: 1.1418s
	iters: 400, epoch: 8 | loss: 0.2924036
	speed: 0.0051s/iter; left time: 0.6343s
	iters: 500, epoch: 8 | loss: 0.3438958
	speed: 0.0052s/iter; left time: 0.1248s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7272613048553467
Epoch: 8, Steps: 523 | Train Loss: 0.3037454 Vali Loss: 0.3843225 Best vali loss: 0.2914581

best validation loss 0.29145812407529414

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0008128676907, 'e_layers': 2, 'learning_rate': 0.0010487700281, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5373954
	speed: 0.0145s/iter; left time: 28.9446s
	iters: 200, epoch: 1 | loss: 0.4257122
	speed: 0.0080s/iter; left time: 15.1399s
Updating learning rate to 0.0010487700281
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 2.369460344314575
Epoch: 1, Steps: 262 | Train Loss: 0.4815538 Vali Loss: 0.2854766 Best vali loss: 0.2854766
	iters: 100, epoch: 2 | loss: 0.2638376
	speed: 0.0270s/iter; left time: 46.8504s
	iters: 200, epoch: 2 | loss: 0.3122439
	speed: 0.0099s/iter; left time: 16.2150s
Updating learning rate to 0.00052438501405
Validation loss decreased (0.2855 --> 0.2849).  Saving model state dict ...
Epoch: 2 cost time: 2.7328684329986572
Epoch: 2, Steps: 262 | Train Loss: 0.2880408 Vali Loss: 0.2849469 Best vali loss: 0.2849469
	iters: 100, epoch: 3 | loss: 0.7676532
	speed: 0.0318s/iter; left time: 46.8181s
	iters: 200, epoch: 3 | loss: 0.4359644
	speed: 0.0100s/iter; left time: 13.7682s
Updating learning rate to 0.000262192507025
Epoch: 3 cost time: 2.747015953063965
Epoch: 3, Steps: 262 | Train Loss: 0.6018088 Vali Loss: 0.2885627 Best vali loss: 0.2849469

best validation loss 0.2849469073657078

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048859156977, 'e_layers': 4, 'learning_rate': 7.7601951e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0060402
	speed: 0.0170s/iter; left time: 69.4225s
	iters: 200, epoch: 1 | loss: 0.4599036
	speed: 0.0099s/iter; left time: 39.3119s
	iters: 300, epoch: 1 | loss: 0.3332570
	speed: 0.0098s/iter; left time: 38.0009s
	iters: 400, epoch: 1 | loss: 0.2965306
	speed: 0.0106s/iter; left time: 40.1225s
	iters: 500, epoch: 1 | loss: 0.6137759
	speed: 0.0099s/iter; left time: 36.5962s
Updating learning rate to 7.464840260592189e-05
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 5.6094810962677
Epoch: 1, Steps: 523 | Train Loss: 0.5419015 Vali Loss: 0.2815212 Best vali loss: 0.2815212
	iters: 100, epoch: 2 | loss: 0.4034317
	speed: 0.0206s/iter; left time: 73.2002s
	iters: 200, epoch: 2 | loss: 0.1978666
	speed: 0.0111s/iter; left time: 38.3919s
	iters: 300, epoch: 2 | loss: 0.4633365
	speed: 0.0118s/iter; left time: 39.6596s
	iters: 400, epoch: 2 | loss: 0.7475917
	speed: 0.0114s/iter; left time: 37.3496s
	iters: 500, epoch: 2 | loss: 0.5212662
	speed: 0.0113s/iter; left time: 35.8223s
Updating learning rate to 6.623740839270309e-05
Validation loss decreased (0.2815 --> 0.2758).  Saving model state dict ...
Epoch: 2 cost time: 5.872920989990234
Epoch: 2, Steps: 523 | Train Loss: 0.4666986 Vali Loss: 0.2757961 Best vali loss: 0.2757961
	iters: 100, epoch: 3 | loss: 0.3631313
	speed: 0.0216s/iter; left time: 65.4975s
	iters: 200, epoch: 3 | loss: 0.5006620
	speed: 0.0116s/iter; left time: 34.1261s
	iters: 300, epoch: 3 | loss: 0.3782410
	speed: 0.0122s/iter; left time: 34.6680s
	iters: 400, epoch: 3 | loss: 0.4088273
	speed: 0.0120s/iter; left time: 32.7999s
	iters: 500, epoch: 3 | loss: 0.4665613
	speed: 0.0114s/iter; left time: 30.0412s
Updating learning rate to 5.3649465983453756e-05
Epoch: 3 cost time: 6.137759447097778
Epoch: 3, Steps: 523 | Train Loss: 0.4234846 Vali Loss: 0.2832626 Best vali loss: 0.2757961

best validation loss 0.27579614638661576

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0073108534083, 'e_layers': 2, 'learning_rate': 0.0003654519075, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000351542722478229
Validation loss decreased (inf --> 0.2981).  Saving model state dict ...
Epoch: 1 cost time: 1.9823918342590332
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2980913 Best vali loss: 0.2980913
Updating learning rate to 0.0003119327147454044
Validation loss decreased (0.2981 --> 0.2845).  Saving model state dict ...
Epoch: 2 cost time: 1.9471945762634277
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2845494 Best vali loss: 0.2845494
Updating learning rate to 0.00025265214891323463
Validation loss decreased (0.2845 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 0.9219255447387695
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2823326 Best vali loss: 0.2823326

best validation loss 0.28233259322254045

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048859156977, 'e_layers': 4, 'learning_rate': 7.7601951e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7145982
	speed: 0.0192s/iter; left time: 48.3511s
	iters: 200, epoch: 4 | loss: 0.3475944
	speed: 0.0100s/iter; left time: 24.1423s
	iters: 300, epoch: 4 | loss: 0.3178532
	speed: 0.0085s/iter; left time: 19.7001s
	iters: 400, epoch: 4 | loss: 0.2453384
	speed: 0.0106s/iter; left time: 23.4051s
	iters: 500, epoch: 4 | loss: 0.3945946
	speed: 0.0119s/iter; left time: 25.1625s
Updating learning rate to 3.88009755e-05
Epoch: 4 cost time: 5.906298398971558
Epoch: 4, Steps: 523 | Train Loss: 0.4039958 Vali Loss: 0.2942207 Best vali loss: 0.2757961
	iters: 100, epoch: 5 | loss: 0.2898614
	speed: 0.0238s/iter; left time: 47.5298s
	iters: 200, epoch: 5 | loss: 0.1698852
	speed: 0.0111s/iter; left time: 20.9621s
	iters: 300, epoch: 5 | loss: 0.4359057
	speed: 0.0119s/iter; left time: 21.2706s
	iters: 400, epoch: 5 | loss: 0.5200825
	speed: 0.0112s/iter; left time: 18.9908s
	iters: 500, epoch: 5 | loss: 0.3590741
	speed: 0.0114s/iter; left time: 18.1259s
Updating learning rate to 2.3952485016546247e-05
Epoch: 5 cost time: 5.972195148468018
Epoch: 5, Steps: 523 | Train Loss: 0.3549618 Vali Loss: 0.3119542 Best vali loss: 0.2757961
	iters: 100, epoch: 6 | loss: 0.3337241
	speed: 0.0233s/iter; left time: 34.2948s
	iters: 200, epoch: 6 | loss: 0.4548099
	speed: 0.0120s/iter; left time: 16.4437s
	iters: 300, epoch: 6 | loss: 0.3284943
	speed: 0.0119s/iter; left time: 15.0681s
	iters: 400, epoch: 6 | loss: 0.3211477
	speed: 0.0112s/iter; left time: 13.1306s
	iters: 500, epoch: 6 | loss: 0.3244166
	speed: 0.0106s/iter; left time: 11.2961s
Updating learning rate to 1.1364542607296912e-05
Epoch: 6 cost time: 6.103912591934204
Epoch: 6, Steps: 523 | Train Loss: 0.3525185 Vali Loss: 0.3046229 Best vali loss: 0.2757961
	iters: 100, epoch: 7 | loss: 0.2486530
	speed: 0.0219s/iter; left time: 20.7109s
	iters: 200, epoch: 7 | loss: 0.1946911
	speed: 0.0099s/iter; left time: 8.3969s
	iters: 300, epoch: 7 | loss: 0.2818771
	speed: 0.0094s/iter; left time: 7.0151s
	iters: 400, epoch: 7 | loss: 0.6157005
	speed: 0.0119s/iter; left time: 7.6946s
	iters: 500, epoch: 7 | loss: 0.2990125
	speed: 0.0119s/iter; left time: 6.4834s
Updating learning rate to 2.9535483940781098e-06
Epoch: 7 cost time: 5.55372166633606
Epoch: 7, Steps: 523 | Train Loss: 0.3279868 Vali Loss: 0.3108725 Best vali loss: 0.2757961
	iters: 100, epoch: 8 | loss: 0.3116225
	speed: 0.0209s/iter; left time: 8.8643s
	iters: 200, epoch: 8 | loss: 0.3289578
	speed: 0.0090s/iter; left time: 2.9148s
	iters: 300, epoch: 8 | loss: 0.6592612
	speed: 0.0101s/iter; left time: 2.2650s
	iters: 400, epoch: 8 | loss: 0.1899263
	speed: 0.0108s/iter; left time: 1.3439s
	iters: 500, epoch: 8 | loss: 0.1530371
	speed: 0.0107s/iter; left time: 0.2568s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.350300073623657
Epoch: 8, Steps: 523 | Train Loss: 0.3285610 Vali Loss: 0.3162079 Best vali loss: 0.2757961

best validation loss 0.27579614638661576

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0035209401986, 'e_layers': 1, 'learning_rate': 0.0014531025636, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5275463
	speed: 0.0116s/iter; left time: 23.2143s
	iters: 200, epoch: 1 | loss: 0.6740762
	speed: 0.0058s/iter; left time: 10.9187s
Updating learning rate to 0.00139779714037486
Validation loss decreased (inf --> 0.2907).  Saving model state dict ...
Epoch: 1 cost time: 1.8232142925262451
Epoch: 1, Steps: 262 | Train Loss: 0.6008113 Vali Loss: 0.2907329 Best vali loss: 0.2907329
	iters: 100, epoch: 2 | loss: 0.7039964
	speed: 0.0137s/iter; left time: 23.7475s
	iters: 200, epoch: 2 | loss: 0.4646421
	speed: 0.0055s/iter; left time: 8.9286s
Updating learning rate to 0.0012403006200405581
Epoch: 2 cost time: 1.4458928108215332
Epoch: 2, Steps: 262 | Train Loss: 0.5843192 Vali Loss: 0.2981689 Best vali loss: 0.2907329
	iters: 100, epoch: 3 | loss: 0.6128871
	speed: 0.0131s/iter; left time: 19.2583s
	iters: 200, epoch: 3 | loss: 0.5057302
	speed: 0.0058s/iter; left time: 8.0233s
Updating learning rate to 0.0010045904201084796
Epoch: 3 cost time: 1.594836711883545
Epoch: 3, Steps: 262 | Train Loss: 0.5593086 Vali Loss: 0.2923125 Best vali loss: 0.2907329
	iters: 100, epoch: 4 | loss: 0.3433630
	speed: 0.0149s/iter; left time: 18.0326s
	iters: 200, epoch: 4 | loss: 0.8935663
	speed: 0.0056s/iter; left time: 6.2671s
Updating learning rate to 0.0007265512818
Epoch: 4 cost time: 1.5161933898925781
Epoch: 4, Steps: 262 | Train Loss: 0.6184646 Vali Loss: 0.3090923 Best vali loss: 0.2907329
	iters: 100, epoch: 5 | loss: 0.6087307
	speed: 0.0141s/iter; left time: 13.3842s
	iters: 200, epoch: 5 | loss: 0.2041025
	speed: 0.0052s/iter; left time: 4.4122s
Updating learning rate to 0.00044851214349152046
Epoch: 5 cost time: 1.413092851638794
Epoch: 5, Steps: 262 | Train Loss: 0.4064166 Vali Loss: 0.3055552 Best vali loss: 0.2907329
	iters: 100, epoch: 6 | loss: 0.4783208
	speed: 0.0125s/iter; left time: 8.6186s
	iters: 200, epoch: 6 | loss: 0.3617950
	speed: 0.0052s/iter; left time: 3.0641s
Updating learning rate to 0.0002128019435594418
Epoch: 6 cost time: 1.4031813144683838
Epoch: 6, Steps: 262 | Train Loss: 0.4200579 Vali Loss: 0.3319008 Best vali loss: 0.2907329
	iters: 100, epoch: 7 | loss: 0.4165913
	speed: 0.0144s/iter; left time: 6.1043s
	iters: 200, epoch: 7 | loss: 0.2962645
	speed: 0.0058s/iter; left time: 1.8984s
Updating learning rate to 5.530542322513984e-05
Epoch: 7 cost time: 1.4713704586029053
Epoch: 7, Steps: 262 | Train Loss: 0.3564279 Vali Loss: 0.3512189 Best vali loss: 0.2907329
	iters: 100, epoch: 8 | loss: 0.3479877
	speed: 0.0093s/iter; left time: 1.5101s
	iters: 200, epoch: 8 | loss: 0.4130286
	speed: 0.0070s/iter; left time: 0.4398s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5022525787353516
Epoch: 8, Steps: 262 | Train Loss: 0.3805081 Vali Loss: 0.3621022 Best vali loss: 0.2907329

best validation loss 0.29073289302744004

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0062416510481, 'e_layers': 3, 'learning_rate': 0.0016295065972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5645156
	speed: 0.0152s/iter; left time: 61.9849s
	iters: 200, epoch: 1 | loss: 0.2483005
	speed: 0.0095s/iter; left time: 37.9092s
	iters: 300, epoch: 1 | loss: 0.8095120
	speed: 0.0082s/iter; left time: 31.7245s
	iters: 400, epoch: 1 | loss: 0.5957250
	speed: 0.0068s/iter; left time: 25.7941s
	iters: 500, epoch: 1 | loss: 1.3568072
	speed: 0.0091s/iter; left time: 33.6286s
Updating learning rate to 0.0016295065972
Validation loss decreased (inf --> 0.3325).  Saving model state dict ...
Epoch: 1 cost time: 4.784260272979736
Epoch: 1, Steps: 523 | Train Loss: 0.9149721 Vali Loss: 0.3325234 Best vali loss: 0.3325234
	iters: 100, epoch: 2 | loss: 0.5016179
	speed: 0.0186s/iter; left time: 66.3822s
	iters: 200, epoch: 2 | loss: 0.5873045
	speed: 0.0090s/iter; left time: 30.9945s
	iters: 300, epoch: 2 | loss: 0.5117971
	speed: 0.0086s/iter; left time: 28.8627s
	iters: 400, epoch: 2 | loss: 0.5558949
	speed: 0.0089s/iter; left time: 28.9127s
	iters: 500, epoch: 2 | loss: 0.3609711
	speed: 0.0082s/iter; left time: 26.0154s
Updating learning rate to 0.0008147532986
Validation loss decreased (0.3325 --> 0.3206).  Saving model state dict ...
Epoch: 2 cost time: 4.604304552078247
Epoch: 2, Steps: 523 | Train Loss: 0.5035171 Vali Loss: 0.3206047 Best vali loss: 0.3206047
	iters: 100, epoch: 3 | loss: 0.2971412
	speed: 0.0187s/iter; left time: 56.8865s
	iters: 200, epoch: 3 | loss: 0.6022301
	speed: 0.0079s/iter; left time: 23.2964s
	iters: 300, epoch: 3 | loss: 0.6086497
	speed: 0.0082s/iter; left time: 23.2111s
	iters: 400, epoch: 3 | loss: 0.8442079
	speed: 0.0074s/iter; left time: 20.3489s
	iters: 500, epoch: 3 | loss: 0.5703243
	speed: 0.0071s/iter; left time: 18.6574s
Updating learning rate to 0.0004073766493
Epoch: 3 cost time: 3.99570894241333
Epoch: 3, Steps: 523 | Train Loss: 0.5845106 Vali Loss: 0.3235312 Best vali loss: 0.3206047
	iters: 100, epoch: 4 | loss: 0.5723670
	speed: 0.0177s/iter; left time: 44.4276s
	iters: 200, epoch: 4 | loss: 0.3869419
	speed: 0.0074s/iter; left time: 17.8949s
	iters: 300, epoch: 4 | loss: 0.4774121
	speed: 0.0080s/iter; left time: 18.4765s
	iters: 400, epoch: 4 | loss: 0.4488301
	speed: 0.0086s/iter; left time: 19.0535s
	iters: 500, epoch: 4 | loss: 0.4234179
	speed: 0.0086s/iter; left time: 18.1564s
Updating learning rate to 0.00020368832465
Epoch: 4 cost time: 4.413254261016846
Epoch: 4, Steps: 523 | Train Loss: 0.4617938 Vali Loss: 0.3232462 Best vali loss: 0.3206047
	iters: 100, epoch: 5 | loss: 0.6873173
	speed: 0.0183s/iter; left time: 36.4378s
	iters: 200, epoch: 5 | loss: 0.2892620
	speed: 0.0084s/iter; left time: 15.9310s
	iters: 300, epoch: 5 | loss: 0.4185721
	speed: 0.0078s/iter; left time: 14.0080s
	iters: 400, epoch: 5 | loss: 0.4159110
	speed: 0.0075s/iter; left time: 12.7547s
	iters: 500, epoch: 5 | loss: 0.3817745
	speed: 0.0075s/iter; left time: 12.0268s
Updating learning rate to 0.000101844162325
Epoch: 5 cost time: 4.145728349685669
Epoch: 5, Steps: 523 | Train Loss: 0.4385674 Vali Loss: 0.3210611 Best vali loss: 0.3206047
	iters: 100, epoch: 6 | loss: 0.4267864
	speed: 0.0169s/iter; left time: 24.8030s
	iters: 200, epoch: 6 | loss: 0.6715027
	speed: 0.0076s/iter; left time: 10.3787s
	iters: 300, epoch: 6 | loss: 0.6226054
	speed: 0.0081s/iter; left time: 10.2347s
	iters: 400, epoch: 6 | loss: 0.3399432
	speed: 0.0078s/iter; left time: 9.1012s
	iters: 500, epoch: 6 | loss: 0.7805914
	speed: 0.0074s/iter; left time: 7.9192s
Updating learning rate to 5.09220811625e-05
Epoch: 6 cost time: 4.1891930103302
Epoch: 6, Steps: 523 | Train Loss: 0.5682858 Vali Loss: 0.3220016 Best vali loss: 0.3206047
	iters: 100, epoch: 7 | loss: 0.5983098
	speed: 0.0162s/iter; left time: 15.3441s
	iters: 200, epoch: 7 | loss: 1.2904152
	speed: 0.0068s/iter; left time: 5.7454s
	iters: 300, epoch: 7 | loss: 0.2765420
	speed: 0.0074s/iter; left time: 5.5523s
	iters: 400, epoch: 7 | loss: 0.2363247
	speed: 0.0078s/iter; left time: 5.0508s
	iters: 500, epoch: 7 | loss: 0.3710802
	speed: 0.0078s/iter; left time: 4.2761s
Updating learning rate to 2.546104058125e-05
Epoch: 7 cost time: 3.981278657913208
Epoch: 7, Steps: 523 | Train Loss: 0.5545344 Vali Loss: 0.3222640 Best vali loss: 0.3206047
	iters: 100, epoch: 8 | loss: 0.5196117
	speed: 0.0167s/iter; left time: 7.0942s
	iters: 200, epoch: 8 | loss: 0.5151457
	speed: 0.0071s/iter; left time: 2.3164s
	iters: 300, epoch: 8 | loss: 0.2882674
	speed: 0.0086s/iter; left time: 1.9372s
	iters: 400, epoch: 8 | loss: 0.2678252
	speed: 0.0078s/iter; left time: 0.9726s
	iters: 500, epoch: 8 | loss: 0.8308558
	speed: 0.0076s/iter; left time: 0.1821s
Updating learning rate to 1.2730520290625e-05
Epoch: 8 cost time: 4.033470630645752
Epoch: 8, Steps: 523 | Train Loss: 0.4843412 Vali Loss: 0.3223997 Best vali loss: 0.3206047

best validation loss 0.3206046562449291

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.008590942054, 'e_layers': 1, 'learning_rate': 0.0002457605762, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4865601
	speed: 0.0138s/iter; left time: 13.0774s
Updating learning rate to 0.00023640687122468025
Validation loss decreased (inf --> 0.2971).  Saving model state dict ...
Epoch: 1 cost time: 1.2616102695465088
Epoch: 1, Steps: 131 | Train Loss: 0.4865601 Vali Loss: 0.2971462 Best vali loss: 0.2971462
	iters: 100, epoch: 2 | loss: 0.2805564
	speed: 0.0121s/iter; left time: 9.8572s
Updating learning rate to 0.00020976977308966661
Validation loss decreased (0.2971 --> 0.2832).  Saving model state dict ...
Epoch: 2 cost time: 0.9149785041809082
Epoch: 2, Steps: 131 | Train Loss: 0.2805564 Vali Loss: 0.2831601 Best vali loss: 0.2831601
	iters: 100, epoch: 3 | loss: 0.3428444
	speed: 0.0122s/iter; left time: 8.4091s
Updating learning rate to 0.00016990453852011911
Validation loss decreased (0.2832 --> 0.2804).  Saving model state dict ...
Epoch: 3 cost time: 0.954439640045166
Epoch: 3, Steps: 131 | Train Loss: 0.3428444 Vali Loss: 0.2804413 Best vali loss: 0.2804413

best validation loss 0.2804413028213782

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0018986584601, 'e_layers': 4, 'learning_rate': 0.0001397169929, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4881676
	speed: 0.0176s/iter; left time: 145.6136s
	iters: 200, epoch: 1 | loss: 0.4491450
	speed: 0.0120s/iter; left time: 97.6612s
	iters: 300, epoch: 1 | loss: 0.2540311
	speed: 0.0123s/iter; left time: 98.9840s
	iters: 400, epoch: 1 | loss: 0.4299487
	speed: 0.0112s/iter; left time: 88.9080s
	iters: 500, epoch: 1 | loss: 0.1862783
	speed: 0.0118s/iter; left time: 92.6401s
	iters: 600, epoch: 1 | loss: 0.2643987
	speed: 0.0114s/iter; left time: 88.3775s
	iters: 700, epoch: 1 | loss: 0.3415037
	speed: 0.0099s/iter; left time: 76.1189s
	iters: 800, epoch: 1 | loss: 0.5040855
	speed: 0.0090s/iter; left time: 67.7981s
	iters: 900, epoch: 1 | loss: 0.2871349
	speed: 0.0107s/iter; left time: 79.6082s
	iters: 1000, epoch: 1 | loss: 0.3195889
	speed: 0.0120s/iter; left time: 88.1683s
Updating learning rate to 0.00013439933149216737
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 11.99340271949768
Epoch: 1, Steps: 1045 | Train Loss: 0.4524282 Vali Loss: 0.2827967 Best vali loss: 0.2827967
	iters: 100, epoch: 2 | loss: 0.5425647
	speed: 0.0368s/iter; left time: 265.4440s
	iters: 200, epoch: 2 | loss: 0.4593748
	speed: 0.0111s/iter; left time: 78.6347s
	iters: 300, epoch: 2 | loss: 0.2010249
	speed: 0.0121s/iter; left time: 84.8852s
	iters: 400, epoch: 2 | loss: 0.1983415
	speed: 0.0121s/iter; left time: 83.8298s
	iters: 500, epoch: 2 | loss: 0.5027881
	speed: 0.0109s/iter; left time: 74.5245s
	iters: 600, epoch: 2 | loss: 0.2062655
	speed: 0.0107s/iter; left time: 71.5428s
	iters: 700, epoch: 2 | loss: 0.4510594
	speed: 0.0114s/iter; left time: 75.3886s
	iters: 800, epoch: 2 | loss: 0.2086087
	speed: 0.0099s/iter; left time: 64.5431s
	iters: 900, epoch: 2 | loss: 0.4313125
	speed: 0.0116s/iter; left time: 74.2874s
	iters: 1000, epoch: 2 | loss: 0.2556585
	speed: 0.0122s/iter; left time: 77.3511s
Updating learning rate to 0.00011925591301329135
Validation loss decreased (0.2828 --> 0.2816).  Saving model state dict ...
Epoch: 2 cost time: 11.912197828292847
Epoch: 2, Steps: 1045 | Train Loss: 0.3456999 Vali Loss: 0.2815833 Best vali loss: 0.2815833
	iters: 100, epoch: 3 | loss: 0.5019722
	speed: 0.0383s/iter; left time: 236.6280s
	iters: 200, epoch: 3 | loss: 0.1978368
	speed: 0.0109s/iter; left time: 66.3503s
	iters: 300, epoch: 3 | loss: 0.7702879
	speed: 0.0120s/iter; left time: 71.5451s
	iters: 400, epoch: 3 | loss: 0.4031685
	speed: 0.0119s/iter; left time: 70.0772s
	iters: 500, epoch: 3 | loss: 0.4271720
	speed: 0.0118s/iter; left time: 68.3299s
	iters: 600, epoch: 3 | loss: 0.2864461
	speed: 0.0130s/iter; left time: 73.4726s
	iters: 700, epoch: 3 | loss: 0.3004042
	speed: 0.0119s/iter; left time: 66.2265s
	iters: 800, epoch: 3 | loss: 0.2269937
	speed: 0.0106s/iter; left time: 58.2511s
	iters: 900, epoch: 3 | loss: 0.1971839
	speed: 0.0097s/iter; left time: 51.9601s
	iters: 1000, epoch: 3 | loss: 1.0346947
	speed: 0.0115s/iter; left time: 60.6509s
Updating learning rate to 9.659218565135044e-05
Epoch: 3 cost time: 12.260265827178955
Epoch: 3, Steps: 1045 | Train Loss: 0.4346160 Vali Loss: 0.2834581 Best vali loss: 0.2815833

best validation loss 0.2815832596184951

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0021623049802, 'e_layers': 1, 'learning_rate': 0.0001689283625, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5031860
	speed: 0.0143s/iter; left time: 118.2785s
	iters: 200, epoch: 1 | loss: 1.0527406
	speed: 0.0074s/iter; left time: 60.2832s
	iters: 300, epoch: 1 | loss: 0.6415743
	speed: 0.0073s/iter; left time: 59.1741s
	iters: 400, epoch: 1 | loss: 0.8056635
	speed: 0.0076s/iter; left time: 60.1909s
	iters: 500, epoch: 1 | loss: 0.4499854
	speed: 0.0059s/iter; left time: 46.3548s
	iters: 600, epoch: 1 | loss: 0.5519363
	speed: 0.0039s/iter; left time: 29.9480s
	iters: 700, epoch: 1 | loss: 1.3960671
	speed: 0.0046s/iter; left time: 35.4108s
	iters: 800, epoch: 1 | loss: 0.3856311
	speed: 0.0061s/iter; left time: 46.4632s
	iters: 900, epoch: 1 | loss: 0.2331072
	speed: 0.0063s/iter; left time: 47.1622s
	iters: 1000, epoch: 1 | loss: 1.1184787
	speed: 0.0065s/iter; left time: 47.5071s
Updating learning rate to 0.0001624989095371986
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 6.962454557418823
Epoch: 1, Steps: 1045 | Train Loss: 0.7138370 Vali Loss: 0.2843572 Best vali loss: 0.2843572
	iters: 100, epoch: 2 | loss: 0.2333255
	speed: 0.0273s/iter; left time: 197.0463s
	iters: 200, epoch: 2 | loss: 0.6004171
	speed: 0.0049s/iter; left time: 34.7967s
	iters: 300, epoch: 2 | loss: 0.5258217
	speed: 0.0044s/iter; left time: 31.1531s
	iters: 400, epoch: 2 | loss: 0.2387718
	speed: 0.0043s/iter; left time: 29.7588s
	iters: 500, epoch: 2 | loss: 0.3066537
	speed: 0.0042s/iter; left time: 28.8107s
	iters: 600, epoch: 2 | loss: 0.2525291
	speed: 0.0047s/iter; left time: 31.3573s
	iters: 700, epoch: 2 | loss: 0.2315742
	speed: 0.0057s/iter; left time: 37.7688s
	iters: 800, epoch: 2 | loss: 0.7139744
	speed: 0.0067s/iter; left time: 43.3372s
	iters: 900, epoch: 2 | loss: 0.4097537
	speed: 0.0067s/iter; left time: 42.6906s
	iters: 1000, epoch: 2 | loss: 1.0207248
	speed: 0.0066s/iter; left time: 41.7094s
Updating learning rate to 0.00014418937657924465
Validation loss decreased (0.2844 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 5.79339861869812
Epoch: 2, Steps: 1045 | Train Loss: 0.4533546 Vali Loss: 0.2838131 Best vali loss: 0.2838131
	iters: 100, epoch: 3 | loss: 0.2712006
	speed: 0.0230s/iter; left time: 142.1032s
	iters: 200, epoch: 3 | loss: 1.2323160
	speed: 0.0046s/iter; left time: 27.8454s
	iters: 300, epoch: 3 | loss: 0.3819730
	speed: 0.0054s/iter; left time: 32.3956s
	iters: 400, epoch: 3 | loss: 0.3732260
	speed: 0.0063s/iter; left time: 36.7191s
	iters: 500, epoch: 3 | loss: 0.2140912
	speed: 0.0069s/iter; left time: 39.5830s
	iters: 600, epoch: 3 | loss: 0.4794585
	speed: 0.0064s/iter; left time: 36.0707s
	iters: 700, epoch: 3 | loss: 0.6304440
	speed: 0.0066s/iter; left time: 36.7759s
	iters: 800, epoch: 3 | loss: 0.3837370
	speed: 0.0065s/iter; left time: 35.7551s
	iters: 900, epoch: 3 | loss: 0.8863716
	speed: 0.0069s/iter; left time: 36.9235s
	iters: 1000, epoch: 3 | loss: 0.7934576
	speed: 0.0076s/iter; left time: 40.2123s
Updating learning rate to 0.00011678722404265707
Epoch: 3 cost time: 6.618203639984131
Epoch: 3, Steps: 1045 | Train Loss: 0.5646275 Vali Loss: 0.2920631 Best vali loss: 0.2838131

best validation loss 0.2838130958985112

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.008590942054, 'e_layers': 1, 'learning_rate': 0.0002457605762, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3976991
	speed: 0.0170s/iter; left time: 9.4741s
Updating learning rate to 0.0001228802881
Epoch: 4 cost time: 1.6560280323028564
Epoch: 4, Steps: 131 | Train Loss: 0.3976991 Vali Loss: 0.2813406 Best vali loss: 0.2804413
	iters: 100, epoch: 5 | loss: 0.2822695
	speed: 0.0165s/iter; left time: 7.0334s
Updating learning rate to 7.585603767988092e-05
Epoch: 5 cost time: 1.2543361186981201
Epoch: 5, Steps: 131 | Train Loss: 0.2822695 Vali Loss: 0.2815253 Best vali loss: 0.2804413
	iters: 100, epoch: 6 | loss: 0.3419160
	speed: 0.0207s/iter; left time: 6.0768s
Updating learning rate to 3.599080311033339e-05
Epoch: 6 cost time: 1.91274094581604
Epoch: 6, Steps: 131 | Train Loss: 0.3419160 Vali Loss: 0.2816500 Best vali loss: 0.2804413
	iters: 100, epoch: 7 | loss: 0.6141753
	speed: 0.0288s/iter; left time: 4.7025s
Updating learning rate to 9.35370497531977e-06
Epoch: 7 cost time: 1.9321441650390625
Epoch: 7, Steps: 131 | Train Loss: 0.6141753 Vali Loss: 0.2821392 Best vali loss: 0.2804413
	iters: 100, epoch: 8 | loss: 0.4078488
	speed: 0.0181s/iter; left time: 0.5780s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3639428615570068
Epoch: 8, Steps: 131 | Train Loss: 0.4078488 Vali Loss: 0.2822080 Best vali loss: 0.2804413

best validation loss 0.2804413028213782

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.007452237056, 'e_layers': 1, 'learning_rate': 9.44051547e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4706257
	speed: 0.0165s/iter; left time: 15.6226s
Updating learning rate to 9.081207244544585e-05
Validation loss decreased (inf --> 0.2990).  Saving model state dict ...
Epoch: 1 cost time: 1.6400303840637207
Epoch: 1, Steps: 131 | Train Loss: 0.4706257 Vali Loss: 0.2989917 Best vali loss: 0.2989917
	iters: 100, epoch: 2 | loss: 0.5595106
	speed: 0.0266s/iter; left time: 21.7760s
Updating learning rate to 8.057983988366754e-05
Validation loss decreased (0.2990 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 1.631829023361206
Epoch: 2, Steps: 131 | Train Loss: 0.5595106 Vali Loss: 0.2850163 Best vali loss: 0.2850163
	iters: 100, epoch: 3 | loss: 0.7874231
	speed: 0.0236s/iter; left time: 16.2213s
Updating learning rate to 6.526622166677664e-05
Validation loss decreased (0.2850 --> 0.2816).  Saving model state dict ...
Epoch: 3 cost time: 1.972761869430542
Epoch: 3, Steps: 131 | Train Loss: 0.7874231 Vali Loss: 0.2816216 Best vali loss: 0.2816216
	iters: 100, epoch: 4 | loss: 0.6047464
	speed: 0.0287s/iter; left time: 15.9319s
Updating learning rate to 4.720257735e-05
Validation loss decreased (0.2816 --> 0.2814).  Saving model state dict ...
Epoch: 4 cost time: 1.990264892578125
Epoch: 4, Steps: 131 | Train Loss: 0.6047464 Vali Loss: 0.2813504 Best vali loss: 0.2813504
	iters: 100, epoch: 5 | loss: 0.6426806
	speed: 0.0271s/iter; left time: 11.5037s
Updating learning rate to 2.913893303322336e-05
Validation loss decreased (0.2814 --> 0.2798).  Saving model state dict ...
Epoch: 5 cost time: 2.189769744873047
Epoch: 5, Steps: 131 | Train Loss: 0.6426806 Vali Loss: 0.2798043 Best vali loss: 0.2798043
	iters: 100, epoch: 6 | loss: 0.4059612
	speed: 0.0279s/iter; left time: 8.2029s
Updating learning rate to 1.382531481633247e-05
Validation loss decreased (0.2798 --> 0.2793).  Saving model state dict ...
Epoch: 6 cost time: 2.3810408115386963
Epoch: 6, Steps: 131 | Train Loss: 0.4059612 Vali Loss: 0.2792626 Best vali loss: 0.2792626
	iters: 100, epoch: 7 | loss: 0.5920418
	speed: 0.0379s/iter; left time: 6.1727s
Updating learning rate to 3.593082254554148e-06
Validation loss decreased (0.2793 --> 0.2792).  Saving model state dict ...
Epoch: 7 cost time: 2.2601566314697266
Epoch: 7, Steps: 131 | Train Loss: 0.5920418 Vali Loss: 0.2791553 Best vali loss: 0.2791553
	iters: 100, epoch: 8 | loss: 0.2889585
	speed: 0.0150s/iter; left time: 0.4802s
Updating learning rate to 0.0
Validation loss decreased (0.2792 --> 0.2792).  Saving model state dict ...
Epoch: 8 cost time: 1.0521974563598633
Epoch: 8, Steps: 131 | Train Loss: 0.2889585 Vali Loss: 0.2791536 Best vali loss: 0.2791536

best validation loss 0.2791535674046078

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008043881686, 'e_layers': 4, 'learning_rate': 0.0004018320868, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6413196
	speed: 0.0203s/iter; left time: 40.6197s
	iters: 200, epoch: 1 | loss: 1.0166612
	speed: 0.0127s/iter; left time: 24.0833s
Updating learning rate to 0.0004018320868
Validation loss decreased (inf --> 0.2854).  Saving model state dict ...
Epoch: 1 cost time: 3.930504322052002
Epoch: 1, Steps: 262 | Train Loss: 0.8289904 Vali Loss: 0.2853784 Best vali loss: 0.2853784
	iters: 100, epoch: 2 | loss: 0.5131112
	speed: 0.0316s/iter; left time: 54.8888s
	iters: 200, epoch: 2 | loss: 0.5431045
	speed: 0.0126s/iter; left time: 20.6224s
Updating learning rate to 0.0002009160434
Validation loss decreased (0.2854 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 3.204594373703003
Epoch: 2, Steps: 262 | Train Loss: 0.5281078 Vali Loss: 0.2787795 Best vali loss: 0.2787795
	iters: 100, epoch: 3 | loss: 0.4127634
	speed: 0.0321s/iter; left time: 47.3209s
	iters: 200, epoch: 3 | loss: 0.4193734
	speed: 0.0125s/iter; left time: 17.2102s
Updating learning rate to 0.0001004580217
Epoch: 3 cost time: 3.3216841220855713
Epoch: 3, Steps: 262 | Train Loss: 0.4160684 Vali Loss: 0.2908077 Best vali loss: 0.2787795
	iters: 100, epoch: 4 | loss: 0.4792311
	speed: 0.0354s/iter; left time: 42.8846s
	iters: 200, epoch: 4 | loss: 0.4477754
	speed: 0.0109s/iter; left time: 12.0819s
Updating learning rate to 5.022901085e-05
Epoch: 4 cost time: 2.992558479309082
Epoch: 4, Steps: 262 | Train Loss: 0.4635032 Vali Loss: 0.2914314 Best vali loss: 0.2787795
	iters: 100, epoch: 5 | loss: 0.5442520
	speed: 0.0295s/iter; left time: 27.9514s
	iters: 200, epoch: 5 | loss: 0.3303135
	speed: 0.0115s/iter; left time: 9.8000s
Updating learning rate to 2.5114505425e-05
Epoch: 5 cost time: 3.188342809677124
Epoch: 5, Steps: 262 | Train Loss: 0.4372827 Vali Loss: 0.2871154 Best vali loss: 0.2787795
	iters: 100, epoch: 6 | loss: 0.4844716
	speed: 0.0321s/iter; left time: 22.0306s
	iters: 200, epoch: 6 | loss: 0.5544199
	speed: 0.0120s/iter; left time: 7.0510s
Updating learning rate to 1.25572527125e-05
Epoch: 6 cost time: 3.292097330093384
Epoch: 6, Steps: 262 | Train Loss: 0.5194457 Vali Loss: 0.2852237 Best vali loss: 0.2787795
	iters: 100, epoch: 7 | loss: 0.5660681
	speed: 0.0322s/iter; left time: 13.6640s
	iters: 200, epoch: 7 | loss: 0.3744530
	speed: 0.0120s/iter; left time: 3.9134s
Updating learning rate to 6.27862635625e-06
Epoch: 7 cost time: 2.95113468170166
Epoch: 7, Steps: 262 | Train Loss: 0.4702605 Vali Loss: 0.2858454 Best vali loss: 0.2787795
	iters: 100, epoch: 8 | loss: 0.4821640
	speed: 0.0176s/iter; left time: 2.8674s
	iters: 200, epoch: 8 | loss: 0.2466285
	speed: 0.0116s/iter; left time: 0.7287s
Updating learning rate to 3.139313178125e-06
Epoch: 8 cost time: 2.940554141998291
Epoch: 8, Steps: 262 | Train Loss: 0.3643962 Vali Loss: 0.2873395 Best vali loss: 0.2787795

best validation loss 0.27877949696351445

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0081646872878, 'e_layers': 4, 'learning_rate': 0.0011712676726, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3637334
	speed: 0.0177s/iter; left time: 72.1673s
	iters: 200, epoch: 1 | loss: 0.2998801
	speed: 0.0111s/iter; left time: 44.2987s
	iters: 300, epoch: 1 | loss: 0.6889943
	speed: 0.0115s/iter; left time: 44.7149s
	iters: 400, epoch: 1 | loss: 0.3738995
	speed: 0.0101s/iter; left time: 38.2338s
	iters: 500, epoch: 1 | loss: 0.6999562
	speed: 0.0100s/iter; left time: 36.9688s
Updating learning rate to 0.0011712676726
Validation loss decreased (inf --> 0.3102).  Saving model state dict ...
Epoch: 1 cost time: 5.928116321563721
Epoch: 1, Steps: 523 | Train Loss: 0.4852927 Vali Loss: 0.3102329 Best vali loss: 0.3102329
	iters: 100, epoch: 2 | loss: 0.3281504
	speed: 0.0226s/iter; left time: 80.6192s
	iters: 200, epoch: 2 | loss: 0.6997099
	speed: 0.0108s/iter; left time: 37.4901s
	iters: 300, epoch: 2 | loss: 0.4326845
	speed: 0.0109s/iter; left time: 36.6269s
	iters: 400, epoch: 2 | loss: 1.2041725
	speed: 0.0097s/iter; left time: 31.7834s
	iters: 500, epoch: 2 | loss: 0.7002130
	speed: 0.0106s/iter; left time: 33.3894s
Updating learning rate to 0.0005856338363
Epoch: 2 cost time: 5.644058465957642
Epoch: 2, Steps: 523 | Train Loss: 0.6729860 Vali Loss: 0.3371440 Best vali loss: 0.3102329
	iters: 100, epoch: 3 | loss: 0.4026356
	speed: 0.0235s/iter; left time: 71.4532s
	iters: 200, epoch: 3 | loss: 0.3590286
	speed: 0.0109s/iter; left time: 31.9534s
	iters: 300, epoch: 3 | loss: 1.1591443
	speed: 0.0100s/iter; left time: 28.3560s
	iters: 400, epoch: 3 | loss: 1.0741917
	speed: 0.0104s/iter; left time: 28.4878s
	iters: 500, epoch: 3 | loss: 0.3824624
	speed: 0.0105s/iter; left time: 27.5921s
Updating learning rate to 0.00029281691815
Epoch: 3 cost time: 5.575010776519775
Epoch: 3, Steps: 523 | Train Loss: 0.6754925 Vali Loss: 0.3195233 Best vali loss: 0.3102329

best validation loss 0.3102328544790836

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019968051542, 'e_layers': 3, 'learning_rate': 8.33399629e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.016802443178e-05
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 1.5737979412078857
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2806087 Best vali loss: 0.2806087
Updating learning rate to 7.113510790521264e-05
Validation loss decreased (0.2806 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 1.331007480621338
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2772074 Best vali loss: 0.2772074
Updating learning rate to 5.761639297787563e-05
Epoch: 3 cost time: 1.5469985008239746
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2782015 Best vali loss: 0.2772074

best validation loss 0.27720737880647917

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018403809852, 'e_layers': 1, 'learning_rate': 0.0002282921443, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3127719
	speed: 0.0119s/iter; left time: 98.2621s
	iters: 200, epoch: 1 | loss: 1.0208625
	speed: 0.0062s/iter; left time: 50.2215s
	iters: 300, epoch: 1 | loss: 0.3661602
	speed: 0.0066s/iter; left time: 53.1853s
	iters: 400, epoch: 1 | loss: 0.4735780
	speed: 0.0065s/iter; left time: 51.5557s
	iters: 500, epoch: 1 | loss: 0.8447340
	speed: 0.0065s/iter; left time: 51.0316s
	iters: 600, epoch: 1 | loss: 1.1271994
	speed: 0.0063s/iter; left time: 49.1576s
	iters: 700, epoch: 1 | loss: 0.4897943
	speed: 0.0066s/iter; left time: 50.5548s
	iters: 800, epoch: 1 | loss: 0.4595622
	speed: 0.0060s/iter; left time: 45.0790s
	iters: 900, epoch: 1 | loss: 0.2435884
	speed: 0.0067s/iter; left time: 49.6387s
	iters: 1000, epoch: 1 | loss: 0.3801698
	speed: 0.0067s/iter; left time: 49.0673s
Updating learning rate to 0.0002196032919259416
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 6.998008489608765
Epoch: 1, Steps: 1045 | Train Loss: 0.6718421 Vali Loss: 0.2847412 Best vali loss: 0.2847412
	iters: 100, epoch: 2 | loss: 0.9907867
	speed: 0.0267s/iter; left time: 192.5177s
	iters: 200, epoch: 2 | loss: 0.2332147
	speed: 0.0045s/iter; left time: 32.1708s
	iters: 300, epoch: 2 | loss: 0.3636051
	speed: 0.0059s/iter; left time: 41.4869s
	iters: 400, epoch: 2 | loss: 0.5266435
	speed: 0.0064s/iter; left time: 44.4880s
	iters: 500, epoch: 2 | loss: 0.4263726
	speed: 0.0058s/iter; left time: 39.3737s
	iters: 600, epoch: 2 | loss: 0.3345586
	speed: 0.0059s/iter; left time: 39.3863s
	iters: 700, epoch: 2 | loss: 0.5312123
	speed: 0.0057s/iter; left time: 37.5452s
	iters: 800, epoch: 2 | loss: 0.6014227
	speed: 0.0058s/iter; left time: 37.4878s
	iters: 900, epoch: 2 | loss: 0.4291444
	speed: 0.0066s/iter; left time: 42.3297s
	iters: 1000, epoch: 2 | loss: 0.1574046
	speed: 0.0067s/iter; left time: 42.0316s
Updating learning rate to 0.00019485953381307393
Epoch: 2 cost time: 6.29552149772644
Epoch: 2, Steps: 1045 | Train Loss: 0.4594365 Vali Loss: 0.2865792 Best vali loss: 0.2847412
	iters: 100, epoch: 3 | loss: 0.1952002
	speed: 0.0187s/iter; left time: 115.4872s
	iters: 200, epoch: 3 | loss: 0.3880822
	speed: 0.0037s/iter; left time: 22.3490s
	iters: 300, epoch: 3 | loss: 0.1890065
	speed: 0.0042s/iter; left time: 25.3584s
	iters: 400, epoch: 3 | loss: 0.6752895
	speed: 0.0043s/iter; left time: 24.9526s
	iters: 500, epoch: 3 | loss: 0.4056532
	speed: 0.0046s/iter; left time: 26.8174s
	iters: 600, epoch: 3 | loss: 0.6373650
	speed: 0.0059s/iter; left time: 33.1879s
	iters: 700, epoch: 3 | loss: 0.3519207
	speed: 0.0058s/iter; left time: 32.5305s
	iters: 800, epoch: 3 | loss: 1.4069065
	speed: 0.0054s/iter; left time: 29.3529s
	iters: 900, epoch: 3 | loss: 0.4081741
	speed: 0.0051s/iter; left time: 27.3479s
	iters: 1000, epoch: 3 | loss: 1.5448292
	speed: 0.0044s/iter; left time: 23.4494s
Updating learning rate to 0.0001578278828313552
Epoch: 3 cost time: 4.9528419971466064
Epoch: 3, Steps: 1045 | Train Loss: 0.6202427 Vali Loss: 0.2948181 Best vali loss: 0.2847412

best validation loss 0.28474119663593184

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019968051542, 'e_layers': 3, 'learning_rate': 8.33399629e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 4.166998145e-05
Validation loss decreased (0.2772 --> 0.2765).  Saving model state dict ...
Epoch: 4 cost time: 2.312697172164917
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2764812 Best vali loss: 0.2764812
Updating learning rate to 2.5723569922124384e-05
Epoch: 5 cost time: 1.9980950355529785
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2809738 Best vali loss: 0.2764812
Updating learning rate to 1.2204854994787358e-05
Epoch: 6 cost time: 1.9047610759735107
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2842448 Best vali loss: 0.2764812
Updating learning rate to 3.17193846822001e-06
Epoch: 7 cost time: 2.528359889984131
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2842017 Best vali loss: 0.2764812
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7401010990142822
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2842644 Best vali loss: 0.2764812

best validation loss 0.276481169291525

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0064598283686, 'e_layers': 3, 'learning_rate': 0.0021970340043, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3920179
	speed: 0.0155s/iter; left time: 128.4309s
	iters: 200, epoch: 1 | loss: 2.0205297
	speed: 0.0083s/iter; left time: 67.9856s
	iters: 300, epoch: 1 | loss: 1.1788684
	speed: 0.0095s/iter; left time: 76.9662s
	iters: 400, epoch: 1 | loss: 0.5328982
	speed: 0.0096s/iter; left time: 76.7983s
	iters: 500, epoch: 1 | loss: 2.0146902
	speed: 0.0096s/iter; left time: 75.7811s
	iters: 600, epoch: 1 | loss: 0.2356021
	speed: 0.0094s/iter; left time: 73.1606s
	iters: 700, epoch: 1 | loss: 0.4910079
	speed: 0.0091s/iter; left time: 69.3560s
	iters: 800, epoch: 1 | loss: 0.2088954
	speed: 0.0090s/iter; left time: 68.0079s
	iters: 900, epoch: 1 | loss: 0.3717977
	speed: 0.0090s/iter; left time: 66.9336s
	iters: 1000, epoch: 1 | loss: 0.4274627
	speed: 0.0095s/iter; left time: 70.0975s
Updating learning rate to 0.0021970340043
Validation loss decreased (inf --> 0.3209).  Saving model state dict ...
Epoch: 1 cost time: 9.924359321594238
Epoch: 1, Steps: 1045 | Train Loss: 0.7873770 Vali Loss: 0.3208689 Best vali loss: 0.3208689
	iters: 100, epoch: 2 | loss: 0.6715235
	speed: 0.0288s/iter; left time: 208.0691s
	iters: 200, epoch: 2 | loss: 0.6307077
	speed: 0.0091s/iter; left time: 64.8989s
	iters: 300, epoch: 2 | loss: 0.1712449
	speed: 0.0092s/iter; left time: 64.8014s
	iters: 400, epoch: 2 | loss: 0.2099513
	speed: 0.0098s/iter; left time: 68.0263s
	iters: 500, epoch: 2 | loss: 1.3040919
	speed: 0.0100s/iter; left time: 68.0304s
	iters: 600, epoch: 2 | loss: 0.1986913
	speed: 0.0094s/iter; left time: 63.0162s
	iters: 700, epoch: 2 | loss: 0.3793296
	speed: 0.0092s/iter; left time: 60.9298s
	iters: 800, epoch: 2 | loss: 0.2666230
	speed: 0.0094s/iter; left time: 61.2366s
	iters: 900, epoch: 2 | loss: 0.3389830
	speed: 0.0082s/iter; left time: 52.4361s
	iters: 1000, epoch: 2 | loss: 1.7224288
	speed: 0.0095s/iter; left time: 59.9559s
Updating learning rate to 0.00109851700215
Epoch: 2 cost time: 9.814980268478394
Epoch: 2, Steps: 1045 | Train Loss: 0.5893575 Vali Loss: 0.3221368 Best vali loss: 0.3208689
	iters: 100, epoch: 3 | loss: 1.9160829
	speed: 0.0304s/iter; left time: 187.3080s
	iters: 200, epoch: 3 | loss: 0.3278244
	speed: 0.0098s/iter; left time: 59.2241s
	iters: 300, epoch: 3 | loss: 0.2437141
	speed: 0.0088s/iter; left time: 52.6957s
	iters: 400, epoch: 3 | loss: 0.5428563
	speed: 0.0079s/iter; left time: 46.1145s
	iters: 500, epoch: 3 | loss: 0.6252822
	speed: 0.0093s/iter; left time: 53.9508s
	iters: 600, epoch: 3 | loss: 0.2949365
	speed: 0.0096s/iter; left time: 54.5631s
	iters: 700, epoch: 3 | loss: 0.5282717
	speed: 0.0080s/iter; left time: 44.7095s
	iters: 800, epoch: 3 | loss: 0.4878617
	speed: 0.0075s/iter; left time: 41.2016s
	iters: 900, epoch: 3 | loss: 1.4274573
	speed: 0.0080s/iter; left time: 42.8008s
	iters: 1000, epoch: 3 | loss: 1.2610266
	speed: 0.0080s/iter; left time: 41.9981s
Updating learning rate to 0.000549258501075
Epoch: 3 cost time: 9.162538051605225
Epoch: 3, Steps: 1045 | Train Loss: 0.7655314 Vali Loss: 0.3222638 Best vali loss: 0.3208689
	iters: 100, epoch: 4 | loss: 0.2835737
	speed: 0.0284s/iter; left time: 145.4100s
	iters: 200, epoch: 4 | loss: 0.4957975
	speed: 0.0075s/iter; left time: 37.9430s
	iters: 300, epoch: 4 | loss: 0.3295398
	speed: 0.0096s/iter; left time: 47.2297s
	iters: 400, epoch: 4 | loss: 1.1239817
	speed: 0.0097s/iter; left time: 46.9091s
	iters: 500, epoch: 4 | loss: 0.5615602
	speed: 0.0093s/iter; left time: 43.8278s
	iters: 600, epoch: 4 | loss: 0.5742106
	speed: 0.0094s/iter; left time: 43.3419s
	iters: 700, epoch: 4 | loss: 0.2574620
	speed: 0.0089s/iter; left time: 40.3452s
	iters: 800, epoch: 4 | loss: 1.8281536
	speed: 0.0080s/iter; left time: 35.5108s
	iters: 900, epoch: 4 | loss: 0.4511144
	speed: 0.0094s/iter; left time: 40.8473s
	iters: 1000, epoch: 4 | loss: 0.4875218
	speed: 0.0097s/iter; left time: 40.9588s
Updating learning rate to 0.0002746292505375
Epoch: 4 cost time: 9.395161390304565
Epoch: 4, Steps: 1045 | Train Loss: 0.6392915 Vali Loss: 0.3220075 Best vali loss: 0.3208689
	iters: 100, epoch: 5 | loss: 0.3084697
	speed: 0.0311s/iter; left time: 126.7559s
	iters: 200, epoch: 5 | loss: 1.2990050
	speed: 0.0083s/iter; left time: 33.2160s
	iters: 300, epoch: 5 | loss: 0.4202012
	speed: 0.0084s/iter; left time: 32.6077s
	iters: 400, epoch: 5 | loss: 0.3560634
	speed: 0.0089s/iter; left time: 33.7029s
	iters: 500, epoch: 5 | loss: 0.2025359
	speed: 0.0072s/iter; left time: 26.4041s
	iters: 600, epoch: 5 | loss: 0.2762587
	speed: 0.0074s/iter; left time: 26.5695s
	iters: 700, epoch: 5 | loss: 0.2945211
	speed: 0.0092s/iter; left time: 32.1173s
	iters: 800, epoch: 5 | loss: 1.0156875
	speed: 0.0087s/iter; left time: 29.5758s
	iters: 900, epoch: 5 | loss: 1.0438536
	speed: 0.0074s/iter; left time: 24.3021s
	iters: 1000, epoch: 5 | loss: 0.5613854
	speed: 0.0088s/iter; left time: 27.8452s
Updating learning rate to 0.00013731462526875
Epoch: 5 cost time: 8.842225551605225
Epoch: 5, Steps: 1045 | Train Loss: 0.5777982 Vali Loss: 0.3220885 Best vali loss: 0.3208689
	iters: 100, epoch: 6 | loss: 0.4935055
	speed: 0.0288s/iter; left time: 87.3491s
	iters: 200, epoch: 6 | loss: 0.3455468
	speed: 0.0090s/iter; left time: 26.5674s
	iters: 300, epoch: 6 | loss: 0.3434862
	speed: 0.0071s/iter; left time: 20.1063s
	iters: 400, epoch: 6 | loss: 0.4677760
	speed: 0.0067s/iter; left time: 18.2445s
	iters: 500, epoch: 6 | loss: 0.9733981
	speed: 0.0093s/iter; left time: 24.5823s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0082333383912, 'e_layers': 4, 'learning_rate': 0.0011165391487, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5700350
	speed: 0.0246s/iter; left time: 23.3410s
Updating learning rate to 0.0011165391487
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 2.7333168983459473
Epoch: 1, Steps: 131 | Train Loss: 0.5700350 Vali Loss: 0.2841089 Best vali loss: 0.2841089
	iters: 100, epoch: 2 | loss: 0.6506590
	speed: 0.0356s/iter; left time: 29.1442s
Updating learning rate to 0.00055826957435
Epoch: 2 cost time: 2.503267765045166
Epoch: 2, Steps: 131 | Train Loss: 0.6506590 Vali Loss: 0.2881441 Best vali loss: 0.2841089
	iters: 100, epoch: 3 | loss: 0.4317370
	speed: 0.0333s/iter; left time: 22.8975s
Updating learning rate to 0.000279134787175
Epoch: 3 cost time: 2.6327216625213623
Epoch: 3, Steps: 131 | Train Loss: 0.4317370 Vali Loss: 0.2955589 Best vali loss: 0.2841089
	iters: 100, epoch: 4 | loss: 0.5425535
	speed: 0.0342s/iter; left time: 19.0363s
Updating learning rate to 0.0001395673935875
Epoch: 4 cost time: 2.6177423000335693
Epoch: 4, Steps: 131 | Train Loss: 0.5425535 Vali Loss: 0.2914740 Best vali loss: 0.2841089
	iters: 100, epoch: 5 | loss: 0.3997181
	speed: 0.0264s/iter; left time: 11.2204s
Updating learning rate to 6.978369679375e-05
Epoch: 5 cost time: 1.6099677085876465
Epoch: 5, Steps: 131 | Train Loss: 0.3997181 Vali Loss: 0.2912107 Best vali loss: 0.2841089
	iters: 100, epoch: 6 | loss: 0.4462934
	speed: 0.0350s/iter; left time: 10.3018s
Updating learning rate to 3.4891848396875e-05
Epoch: 6 cost time: 2.861374855041504
Epoch: 6, Steps: 131 | Train Loss: 0.4462934 Vali Loss: 0.2925725 Best vali loss: 0.2841089
	iters: 100, epoch: 7 | loss: 0.6883126
	speed: 0.0375s/iter; left time: 6.1140s
Updating learning rate to 1.74459241984375e-05
Epoch: 7 cost time: 2.672659158706665
Epoch: 7, Steps: 131 | Train Loss: 0.6883126 Vali Loss: 0.2921576 Best vali loss: 0.2841089
	iters: 100, epoch: 8 | loss: 0.3169967
	speed: 0.0226s/iter; left time: 0.7232s
Updating learning rate to 8.72296209921875e-06
Epoch: 8 cost time: 2.0427191257476807
Epoch: 8, Steps: 131 | Train Loss: 0.3169967 Vali Loss: 0.2928018 Best vali loss: 0.2841089

best validation loss 0.284108894942595

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 2, 'learning_rate': 0.0023217440229, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4142430
	speed: 0.0188s/iter; left time: 37.6289s
	iters: 200, epoch: 1 | loss: 0.7761360
	speed: 0.0109s/iter; left time: 20.5943s
Updating learning rate to 0.002233377902693863
Validation loss decreased (inf --> 0.3276).  Saving model state dict ...
Epoch: 1 cost time: 3.383354425430298
Epoch: 1, Steps: 262 | Train Loss: 0.5951895 Vali Loss: 0.3276084 Best vali loss: 0.3276084
	iters: 100, epoch: 2 | loss: 0.6281412
	speed: 0.0355s/iter; left time: 61.6680s
	iters: 200, epoch: 2 | loss: 0.5174535
	speed: 0.0104s/iter; left time: 16.9745s
Updating learning rate to 0.0019817324828359626
Validation loss decreased (0.3276 --> 0.3265).  Saving model state dict ...
Epoch: 2 cost time: 2.8258116245269775
Epoch: 2, Steps: 262 | Train Loss: 0.5727973 Vali Loss: 0.3264656 Best vali loss: 0.3264656
	iters: 100, epoch: 3 | loss: 0.3882918
	speed: 0.0296s/iter; left time: 43.5532s
	iters: 200, epoch: 3 | loss: 0.4584515
	speed: 0.0092s/iter; left time: 12.5696s
Updating learning rate to 0.001605118497328252
Validation loss decreased (0.3265 --> 0.3171).  Saving model state dict ...
Epoch: 3 cost time: 2.4620447158813477
Epoch: 3, Steps: 262 | Train Loss: 0.4233716 Vali Loss: 0.3170635 Best vali loss: 0.3170635

best validation loss 0.3170635338475067

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0008171713617, 'e_layers': 4, 'learning_rate': 0.0010379067684, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3098101
	speed: 0.0184s/iter; left time: 152.1434s
	iters: 200, epoch: 1 | loss: 0.7789931
	speed: 0.0104s/iter; left time: 84.6276s
	iters: 300, epoch: 1 | loss: 0.5781426
	speed: 0.0110s/iter; left time: 88.6569s
	iters: 400, epoch: 1 | loss: 0.3422828
	speed: 0.0124s/iter; left time: 98.7365s
	iters: 500, epoch: 1 | loss: 0.2465608
	speed: 0.0105s/iter; left time: 82.2090s
	iters: 600, epoch: 1 | loss: 0.2742831
	speed: 0.0114s/iter; left time: 88.6945s
	iters: 700, epoch: 1 | loss: 0.4816278
	speed: 0.0123s/iter; left time: 94.2264s
	iters: 800, epoch: 1 | loss: 0.3712761
	speed: 0.0120s/iter; left time: 90.6840s
	iters: 900, epoch: 1 | loss: 0.9135946
	speed: 0.0124s/iter; left time: 92.7298s
	iters: 1000, epoch: 1 | loss: 0.4357470
	speed: 0.0109s/iter; left time: 79.9031s
Updating learning rate to 0.0010379067684
Validation loss decreased (inf --> 0.2886).  Saving model state dict ...
Epoch: 1 cost time: 12.371315956115723
Epoch: 1, Steps: 1045 | Train Loss: 0.4732318 Vali Loss: 0.2885829 Best vali loss: 0.2885829
	iters: 100, epoch: 2 | loss: 0.9190665
	speed: 0.0352s/iter; left time: 253.7423s
	iters: 200, epoch: 2 | loss: 0.4912281
	speed: 0.0123s/iter; left time: 87.3894s
	iters: 300, epoch: 2 | loss: 1.1909839
	speed: 0.0102s/iter; left time: 71.6892s
	iters: 400, epoch: 2 | loss: 0.2722049
	speed: 0.0107s/iter; left time: 73.7452s
	iters: 500, epoch: 2 | loss: 0.2889562
	speed: 0.0119s/iter; left time: 81.3528s
	iters: 600, epoch: 2 | loss: 0.3302374
	speed: 0.0119s/iter; left time: 80.2486s
	iters: 700, epoch: 2 | loss: 0.4607395
	speed: 0.0128s/iter; left time: 84.8056s
	iters: 800, epoch: 2 | loss: 0.4241543
	speed: 0.0124s/iter; left time: 80.9392s
	iters: 900, epoch: 2 | loss: 0.3213705
	speed: 0.0099s/iter; left time: 63.3034s
	iters: 1000, epoch: 2 | loss: 0.4502222
	speed: 0.0117s/iter; left time: 73.7456s
Updating learning rate to 0.0005189533842
Validation loss decreased (0.2886 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 12.310682535171509
Epoch: 2, Steps: 1045 | Train Loss: 0.5149164 Vali Loss: 0.2834969 Best vali loss: 0.2834969
	iters: 100, epoch: 3 | loss: 0.3615007
	speed: 0.0390s/iter; left time: 240.4920s
	iters: 200, epoch: 3 | loss: 0.4296256
	speed: 0.0097s/iter; left time: 59.0188s
	iters: 300, epoch: 3 | loss: 0.4065821
	speed: 0.0093s/iter; left time: 55.2354s
	iters: 400, epoch: 3 | loss: 0.5885871
	speed: 0.0099s/iter; left time: 58.2687s
	iters: 500, epoch: 3 | loss: 0.3115645
	speed: 0.0123s/iter; left time: 71.0593s
	iters: 600, epoch: 3 | loss: 0.3044885
	speed: 0.0122s/iter; left time: 68.9863s
	iters: 700, epoch: 3 | loss: 0.3624881
	speed: 0.0121s/iter; left time: 67.6471s
	iters: 800, epoch: 3 | loss: 0.1830609
	speed: 0.0108s/iter; left time: 59.0480s
	iters: 900, epoch: 3 | loss: 0.2444953
	speed: 0.0087s/iter; left time: 46.6046s
	iters: 1000, epoch: 3 | loss: 0.5069484
	speed: 0.0083s/iter; left time: 43.9312s
Updating learning rate to 0.0002594766921
Epoch: 3 cost time: 11.009617567062378
Epoch: 3, Steps: 1045 | Train Loss: 0.3699341 Vali Loss: 0.2988392 Best vali loss: 0.2834969

best validation loss 0.2834968816484825

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015206249299, 'e_layers': 4, 'learning_rate': 0.0036651766384, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7493371
	speed: 0.0160s/iter; left time: 65.1692s
	iters: 200, epoch: 1 | loss: 0.8017160
	speed: 0.0097s/iter; left time: 38.8060s
	iters: 300, epoch: 1 | loss: 0.7603450
	speed: 0.0095s/iter; left time: 37.0833s
	iters: 400, epoch: 1 | loss: 0.4359082
	speed: 0.0082s/iter; left time: 30.9206s
	iters: 500, epoch: 1 | loss: 1.5101523
	speed: 0.0092s/iter; left time: 34.0388s
Updating learning rate to 0.0035256791588281406
Validation loss decreased (inf --> 0.3276).  Saving model state dict ...
Epoch: 1 cost time: 5.216834306716919
Epoch: 1, Steps: 523 | Train Loss: 0.8514917 Vali Loss: 0.3276369 Best vali loss: 0.3276369
	iters: 100, epoch: 2 | loss: 0.7848348
	speed: 0.0207s/iter; left time: 73.7297s
	iters: 200, epoch: 2 | loss: 0.3340138
	speed: 0.0102s/iter; left time: 35.1956s
	iters: 300, epoch: 2 | loss: 0.8707082
	speed: 0.0102s/iter; left time: 34.4189s
	iters: 400, epoch: 2 | loss: 0.6328611
	speed: 0.0102s/iter; left time: 33.3545s
	iters: 500, epoch: 2 | loss: 0.5165927
	speed: 0.0092s/iter; left time: 28.9651s
Updating learning rate to 0.0031284239468295774
Validation loss decreased (0.3276 --> 0.3212).  Saving model state dict ...
Epoch: 2 cost time: 5.210010766983032
Epoch: 2, Steps: 523 | Train Loss: 0.6278021 Vali Loss: 0.3211790 Best vali loss: 0.3211790
	iters: 100, epoch: 3 | loss: 0.5157703
	speed: 0.0191s/iter; left time: 58.0033s
	iters: 200, epoch: 3 | loss: 0.3744078
	speed: 0.0082s/iter; left time: 24.2338s
	iters: 300, epoch: 3 | loss: 0.4060458
	speed: 0.0105s/iter; left time: 29.8130s
	iters: 400, epoch: 3 | loss: 0.5135069
	speed: 0.0104s/iter; left time: 28.3680s
	iters: 500, epoch: 3 | loss: 0.4216975
	speed: 0.0103s/iter; left time: 27.1645s
Updating learning rate to 0.0025338895073036267
Validation loss decreased (0.3212 --> 0.3208).  Saving model state dict ...
Epoch: 3 cost time: 5.006704330444336
Epoch: 3, Steps: 523 | Train Loss: 0.4462857 Vali Loss: 0.3207831 Best vali loss: 0.3207831

best validation loss 0.32078305072459024

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0008171713617, 'e_layers': 4, 'learning_rate': 0.0010379067684, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2589627
	speed: 0.0184s/iter; left time: 94.1681s
	iters: 200, epoch: 4 | loss: 0.4436982
	speed: 0.0102s/iter; left time: 51.4067s
	iters: 300, epoch: 4 | loss: 0.4497848
	speed: 0.0108s/iter; left time: 53.4237s
	iters: 400, epoch: 4 | loss: 0.3440765
	speed: 0.0103s/iter; left time: 49.8010s
	iters: 500, epoch: 4 | loss: 0.1998180
	speed: 0.0111s/iter; left time: 52.3926s
	iters: 600, epoch: 4 | loss: 0.2528403
	speed: 0.0113s/iter; left time: 52.4490s
	iters: 700, epoch: 4 | loss: 0.4399685
	speed: 0.0113s/iter; left time: 51.0758s
	iters: 800, epoch: 4 | loss: 0.3845702
	speed: 0.0106s/iter; left time: 46.9872s
	iters: 900, epoch: 4 | loss: 0.7689968
	speed: 0.0093s/iter; left time: 40.2659s
	iters: 1000, epoch: 4 | loss: 0.3627865
	speed: 0.0109s/iter; left time: 45.9500s
Updating learning rate to 0.00012973834605
Epoch: 4 cost time: 11.513906002044678
Epoch: 4, Steps: 1045 | Train Loss: 0.3905502 Vali Loss: 0.2876723 Best vali loss: 0.2834969
	iters: 100, epoch: 5 | loss: 0.7922268
	speed: 0.0351s/iter; left time: 143.0755s
	iters: 200, epoch: 5 | loss: 0.4563230
	speed: 0.0114s/iter; left time: 45.3049s
	iters: 300, epoch: 5 | loss: 0.8215891
	speed: 0.0102s/iter; left time: 39.5143s
	iters: 400, epoch: 5 | loss: 0.2501912
	speed: 0.0092s/iter; left time: 34.6094s
	iters: 500, epoch: 5 | loss: 0.2744224
	speed: 0.0086s/iter; left time: 31.5693s
	iters: 600, epoch: 5 | loss: 0.3237900
	speed: 0.0110s/iter; left time: 39.4088s
	iters: 700, epoch: 5 | loss: 0.3908998
	speed: 0.0091s/iter; left time: 31.8449s
	iters: 800, epoch: 5 | loss: 0.3310524
	speed: 0.0096s/iter; left time: 32.4726s
	iters: 900, epoch: 5 | loss: 0.3142261
	speed: 0.0151s/iter; left time: 49.4546s
	iters: 1000, epoch: 5 | loss: 0.4222828
	speed: 0.0118s/iter; left time: 37.4385s
Updating learning rate to 6.4869173025e-05
Epoch: 5 cost time: 11.637786626815796
Epoch: 5, Steps: 1045 | Train Loss: 0.4377004 Vali Loss: 0.2881063 Best vali loss: 0.2834969
	iters: 100, epoch: 6 | loss: 0.3420748
	speed: 0.0564s/iter; left time: 171.2123s
	iters: 200, epoch: 6 | loss: 0.3640575
	speed: 0.0153s/iter; left time: 45.0560s
	iters: 300, epoch: 6 | loss: 0.3830185
	speed: 0.0168s/iter; left time: 47.6595s
	iters: 400, epoch: 6 | loss: 0.6638696
	speed: 0.0165s/iter; left time: 45.1925s
	iters: 500, epoch: 6 | loss: 0.3058969
	speed: 0.0106s/iter; left time: 27.9134s
	iters: 600, epoch: 6 | loss: 0.2615652
	speed: 0.0129s/iter; left time: 32.8229s
	iters: 700, epoch: 6 | loss: 0.3324209
	speed: 0.0172s/iter; left time: 41.7968s
	iters: 800, epoch: 6 | loss: 0.1577146
	speed: 0.0169s/iter; left time: 39.5585s
	iters: 900, epoch: 6 | loss: 0.2314900
	speed: 0.0197s/iter; left time: 44.0277s
	iters: 1000, epoch: 6 | loss: 0.4996313
	speed: 0.0112s/iter; left time: 23.8979s
Updating learning rate to 3.24345865125e-05
Epoch: 6 cost time: 16.14226198196411
Epoch: 6, Steps: 1045 | Train Loss: 0.3541739 Vali Loss: 0.2889345 Best vali loss: 0.2834969
	iters: 100, epoch: 7 | loss: 0.2404645
	speed: 0.0489s/iter; left time: 97.2790s
	iters: 200, epoch: 7 | loss: 0.3031583
	speed: 0.0128s/iter; left time: 24.1772s
	iters: 300, epoch: 7 | loss: 0.1939045
	speed: 0.0128s/iter; left time: 22.9073s
	iters: 400, epoch: 7 | loss: 1.5396599
	speed: 0.0138s/iter; left time: 23.2912s
	iters: 500, epoch: 7 | loss: 0.1713683
	speed: 0.0080s/iter; left time: 12.7173s
	iters: 600, epoch: 7 | loss: 0.5116738
	speed: 0.0081s/iter; left time: 12.1189s
	iters: 700, epoch: 7 | loss: 0.5124254
	speed: 0.0085s/iter; left time: 11.8491s
	iters: 800, epoch: 7 | loss: 0.2973615
	speed: 0.0092s/iter; left time: 11.9257s
	iters: 900, epoch: 7 | loss: 0.4399500
	speed: 0.0088s/iter; left time: 10.4705s
	iters: 1000, epoch: 7 | loss: 0.9635403
	speed: 0.0093s/iter; left time: 10.1952s
Updating learning rate to 1.621729325625e-05
Epoch: 7 cost time: 11.27782154083252
Epoch: 7, Steps: 1045 | Train Loss: 0.5173506 Vali Loss: 0.2908186 Best vali loss: 0.2834969
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0021613063706, 'e_layers': 1, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.3009).  Saving model state dict ...
Epoch: 1 cost time: 0.8394782543182373
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3008586 Best vali loss: 0.3008586
Updating learning rate to 0.00034048964815
Validation loss decreased (0.3009 --> 0.2865).  Saving model state dict ...
Epoch: 2 cost time: 1.4920268058776855
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2864753 Best vali loss: 0.2864753
Updating learning rate to 0.000170244824075
Validation loss decreased (0.2865 --> 0.2837).  Saving model state dict ...
Epoch: 3 cost time: 1.0585525035858154
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2837073 Best vali loss: 0.2837073
Updating learning rate to 8.51224120375e-05
Validation loss decreased (0.2837 --> 0.2832).  Saving model state dict ...
Epoch: 4 cost time: 0.8369121551513672
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2831899 Best vali loss: 0.2831899
Updating learning rate to 4.256120601875e-05
Epoch: 5 cost time: 1.6008374691009521
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2833507 Best vali loss: 0.2831899
Updating learning rate to 2.1280603009375e-05
Epoch: 6 cost time: 1.0405771732330322
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2834645 Best vali loss: 0.2831899
Updating learning rate to 1.06403015046875e-05
Epoch: 7 cost time: 0.9784293174743652
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2835951 Best vali loss: 0.2831899
Updating learning rate to 5.32015075234375e-06
Epoch: 8 cost time: 1.7681310176849365
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2835595 Best vali loss: 0.2831899

best validation loss 0.2831899146301767

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0075009820982, 'e_layers': 4, 'learning_rate': 0.0018864472069, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3457542
	speed: 0.0177s/iter; left time: 72.3691s
	iters: 200, epoch: 1 | loss: 0.9130294
	speed: 0.0095s/iter; left time: 38.0352s
	iters: 300, epoch: 1 | loss: 0.7448986
	speed: 0.0090s/iter; left time: 34.7833s
	iters: 400, epoch: 1 | loss: 0.6429309
	speed: 0.0080s/iter; left time: 30.2439s
	iters: 500, epoch: 1 | loss: 0.9690768
	speed: 0.0100s/iter; left time: 36.6731s
Updating learning rate to 0.0018864472069
Validation loss decreased (inf --> 0.3263).  Saving model state dict ...
Epoch: 1 cost time: 5.34508204460144
Epoch: 1, Steps: 523 | Train Loss: 0.7231380 Vali Loss: 0.3262986 Best vali loss: 0.3262986
	iters: 100, epoch: 2 | loss: 0.4457995
	speed: 0.0214s/iter; left time: 76.3397s
	iters: 200, epoch: 2 | loss: 0.4668424
	speed: 0.0093s/iter; left time: 32.2296s
	iters: 300, epoch: 2 | loss: 0.3686120
	speed: 0.0112s/iter; left time: 37.6204s
	iters: 400, epoch: 2 | loss: 0.3123637
	speed: 0.0105s/iter; left time: 34.3813s
	iters: 500, epoch: 2 | loss: 0.2596151
	speed: 0.0115s/iter; left time: 36.2736s
Updating learning rate to 0.00094322360345
Validation loss decreased (0.3263 --> 0.3229).  Saving model state dict ...
Epoch: 2 cost time: 5.610886573791504
Epoch: 2, Steps: 523 | Train Loss: 0.3706466 Vali Loss: 0.3229411 Best vali loss: 0.3229411
	iters: 100, epoch: 3 | loss: 0.8314403
	speed: 0.0217s/iter; left time: 65.9139s
	iters: 200, epoch: 3 | loss: 1.0918437
	speed: 0.0106s/iter; left time: 31.2754s
	iters: 300, epoch: 3 | loss: 0.2757600
	speed: 0.0113s/iter; left time: 32.0658s
	iters: 400, epoch: 3 | loss: 0.8397453
	speed: 0.0114s/iter; left time: 31.2634s
	iters: 500, epoch: 3 | loss: 0.9966078
	speed: 0.0111s/iter; left time: 29.2561s
Updating learning rate to 0.000471611801725
Epoch: 3 cost time: 5.698838233947754
Epoch: 3, Steps: 523 | Train Loss: 0.8070794 Vali Loss: 0.3231895 Best vali loss: 0.3229411
	iters: 100, epoch: 4 | loss: 0.9051879
	speed: 0.0212s/iter; left time: 53.3908s
	iters: 200, epoch: 4 | loss: 0.4467163
	speed: 0.0116s/iter; left time: 27.9179s
	iters: 300, epoch: 4 | loss: 0.2335117
	speed: 0.0113s/iter; left time: 26.2254s
	iters: 400, epoch: 4 | loss: 0.3841738
	speed: 0.0113s/iter; left time: 24.9474s
	iters: 500, epoch: 4 | loss: 0.3725055
	speed: 0.0113s/iter; left time: 23.8130s
Updating learning rate to 0.0002358059008625
Validation loss decreased (0.3229 --> 0.3224).  Saving model state dict ...
Epoch: 4 cost time: 5.924103498458862
Epoch: 4, Steps: 523 | Train Loss: 0.4684190 Vali Loss: 0.3223595 Best vali loss: 0.3223595
	iters: 100, epoch: 5 | loss: 0.8866940
	speed: 0.0194s/iter; left time: 38.7132s
	iters: 200, epoch: 5 | loss: 0.2937791
	speed: 0.0117s/iter; left time: 22.1903s
	iters: 300, epoch: 5 | loss: 0.9520560
	speed: 0.0120s/iter; left time: 21.5095s
	iters: 400, epoch: 5 | loss: 0.5142654
	speed: 0.0109s/iter; left time: 18.4945s
	iters: 500, epoch: 5 | loss: 0.9332471
	speed: 0.0119s/iter; left time: 18.9942s
Updating learning rate to 0.00011790295043125
Validation loss decreased (0.3224 --> 0.3220).  Saving model state dict ...
Epoch: 5 cost time: 5.89487361907959
Epoch: 5, Steps: 523 | Train Loss: 0.7160083 Vali Loss: 0.3220190 Best vali loss: 0.3220190
	iters: 100, epoch: 6 | loss: 0.5256255
	speed: 0.0225s/iter; left time: 33.0100s
	iters: 200, epoch: 6 | loss: 0.9514989
	speed: 0.0115s/iter; left time: 15.7328s
	iters: 300, epoch: 6 | loss: 0.3385715
	speed: 0.0118s/iter; left time: 14.9308s
	iters: 400, epoch: 6 | loss: 0.7211425
	speed: 0.0100s/iter; left time: 11.7435s
	iters: 500, epoch: 6 | loss: 1.0910156
	speed: 0.0086s/iter; left time: 9.1956s
Updating learning rate to 5.8951475215625e-05
Epoch: 6 cost time: 5.436834096908569
Epoch: 6, Steps: 523 | Train Loss: 0.7255708 Vali Loss: 0.3221315 Best vali loss: 0.3220190
	iters: 100, epoch: 7 | loss: 0.7865505
	speed: 0.0205s/iter; left time: 19.4292s
	iters: 200, epoch: 7 | loss: 0.4209451
	speed: 0.0112s/iter; left time: 9.4841s
	iters: 300, epoch: 7 | loss: 0.5752604
	speed: 0.0116s/iter; left time: 8.6403s
	iters: 400, epoch: 7 | loss: 1.1248226
	speed: 0.0116s/iter; left time: 7.4782s
	iters: 500, epoch: 7 | loss: 0.6754922
	speed: 0.0119s/iter; left time: 6.5055s
Updating learning rate to 2.94757376078125e-05
Validation loss decreased (0.3220 --> 0.3204).  Saving model state dict ...
Epoch: 7 cost time: 6.0732808113098145
Epoch: 7, Steps: 523 | Train Loss: 0.7166142 Vali Loss: 0.3203861 Best vali loss: 0.3203861
	iters: 100, epoch: 8 | loss: 0.5382819
	speed: 0.0237s/iter; left time: 10.0611s
	iters: 200, epoch: 8 | loss: 0.4731286
	speed: 0.0115s/iter; left time: 3.7204s
	iters: 300, epoch: 8 | loss: 0.3615694
	speed: 0.0112s/iter; left time: 2.5157s
	iters: 400, epoch: 8 | loss: 0.7494298
	speed: 0.0115s/iter; left time: 1.4202s
	iters: 500, epoch: 8 | loss: 0.2101374
	speed: 0.0111s/iter; left time: 0.2653s
Updating learning rate to 1.473786880390625e-05
Epoch: 8 cost time: 6.006313800811768
Epoch: 8, Steps: 523 | Train Loss: 0.4665094 Vali Loss: 0.3212981 Best vali loss: 0.3203861

best validation loss 0.3203860505911088

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0095905974465, 'e_layers': 4, 'learning_rate': 8.39365665e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3172803
	speed: 0.0184s/iter; left time: 17.4797s
Updating learning rate to 8.39365665e-05
Validation loss decreased (inf --> 0.3335).  Saving model state dict ...
Epoch: 1 cost time: 1.8928558826446533
Epoch: 1, Steps: 131 | Train Loss: 0.3172803 Vali Loss: 0.3335482 Best vali loss: 0.3335482
	iters: 100, epoch: 2 | loss: 0.7808357
	speed: 0.0193s/iter; left time: 15.8127s
Updating learning rate to 4.196828325e-05
Validation loss decreased (0.3335 --> 0.3155).  Saving model state dict ...
Epoch: 2 cost time: 1.5813279151916504
Epoch: 2, Steps: 131 | Train Loss: 0.7808357 Vali Loss: 0.3154882 Best vali loss: 0.3154882
	iters: 100, epoch: 3 | loss: 0.3479651
	speed: 0.0227s/iter; left time: 15.5728s
Updating learning rate to 2.0984141625e-05
Validation loss decreased (0.3155 --> 0.3095).  Saving model state dict ...
Epoch: 3 cost time: 2.2479708194732666
Epoch: 3, Steps: 131 | Train Loss: 0.3479651 Vali Loss: 0.3094636 Best vali loss: 0.3094636

best validation loss 0.30946363191726084

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6058316
	speed: 0.0125s/iter; left time: 102.9436s
	iters: 200, epoch: 1 | loss: 0.2699383
	speed: 0.0057s/iter; left time: 46.7430s
	iters: 300, epoch: 1 | loss: 0.7872218
	speed: 0.0071s/iter; left time: 57.4774s
	iters: 400, epoch: 1 | loss: 0.2649958
	speed: 0.0057s/iter; left time: 45.2809s
	iters: 500, epoch: 1 | loss: 1.3114914
	speed: 0.0058s/iter; left time: 45.3694s
	iters: 600, epoch: 1 | loss: 0.2518733
	speed: 0.0059s/iter; left time: 45.4145s
	iters: 700, epoch: 1 | loss: 0.4028114
	speed: 0.0062s/iter; left time: 47.4329s
	iters: 800, epoch: 1 | loss: 0.4955721
	speed: 0.0064s/iter; left time: 48.3001s
	iters: 900, epoch: 1 | loss: 0.2501655
	speed: 0.0057s/iter; left time: 42.3469s
	iters: 1000, epoch: 1 | loss: 0.7284553
	speed: 0.0058s/iter; left time: 42.4401s
Updating learning rate to 0.00022273671327002105
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 6.590254068374634
Epoch: 1, Steps: 1045 | Train Loss: 0.5368357 Vali Loss: 0.2828753 Best vali loss: 0.2828753
	iters: 100, epoch: 2 | loss: 0.2301893
	speed: 0.0247s/iter; left time: 177.9174s
	iters: 200, epoch: 2 | loss: 0.2109537
	speed: 0.0060s/iter; left time: 42.6212s
	iters: 300, epoch: 2 | loss: 0.8560846
	speed: 0.0059s/iter; left time: 41.5379s
	iters: 400, epoch: 2 | loss: 0.4489491
	speed: 0.0053s/iter; left time: 36.5623s
	iters: 500, epoch: 2 | loss: 0.3539886
	speed: 0.0059s/iter; left time: 40.5087s
	iters: 600, epoch: 2 | loss: 0.6387198
	speed: 0.0057s/iter; left time: 38.3618s
	iters: 700, epoch: 2 | loss: 0.2065355
	speed: 0.0058s/iter; left time: 38.3173s
	iters: 800, epoch: 2 | loss: 0.5417969
	speed: 0.0050s/iter; left time: 32.6732s
	iters: 900, epoch: 2 | loss: 0.5886180
	speed: 0.0046s/iter; left time: 29.3321s
	iters: 1000, epoch: 2 | loss: 0.3379960
	speed: 0.0055s/iter; left time: 34.4618s
Updating learning rate to 0.00019763989751797302
Epoch: 2 cost time: 5.8837456703186035
Epoch: 2, Steps: 1045 | Train Loss: 0.4413831 Vali Loss: 0.2874203 Best vali loss: 0.2828753
	iters: 100, epoch: 3 | loss: 0.2245304
	speed: 0.0237s/iter; left time: 146.0166s
	iters: 200, epoch: 3 | loss: 1.0318294
	speed: 0.0053s/iter; left time: 32.3476s
	iters: 300, epoch: 3 | loss: 0.3391297
	speed: 0.0056s/iter; left time: 33.5635s
	iters: 400, epoch: 3 | loss: 0.2218959
	speed: 0.0060s/iter; left time: 35.4428s
	iters: 500, epoch: 3 | loss: 0.8633209
	speed: 0.0062s/iter; left time: 35.6469s
	iters: 600, epoch: 3 | loss: 0.2098404
	speed: 0.0056s/iter; left time: 31.8348s
	iters: 700, epoch: 3 | loss: 0.2630059
	speed: 0.0060s/iter; left time: 33.3772s
	iters: 800, epoch: 3 | loss: 0.2667821
	speed: 0.0061s/iter; left time: 33.5420s
	iters: 900, epoch: 3 | loss: 0.3140731
	speed: 0.0059s/iter; left time: 31.8808s
	iters: 1000, epoch: 3 | loss: 0.5983691
	speed: 0.0050s/iter; left time: 26.3938s
Updating learning rate to 0.00016007985843890398
Epoch: 3 cost time: 6.001651763916016
Epoch: 3, Steps: 1045 | Train Loss: 0.4332777 Vali Loss: 0.2959273 Best vali loss: 0.2828753

best validation loss 0.2828752724000094

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7705776
	speed: 0.0153s/iter; left time: 62.6687s
	iters: 200, epoch: 1 | loss: 0.2257585
	speed: 0.0091s/iter; left time: 36.1290s
	iters: 300, epoch: 1 | loss: 0.8536066
	speed: 0.0092s/iter; left time: 35.6166s
	iters: 400, epoch: 1 | loss: 0.3156607
	speed: 0.0083s/iter; left time: 31.2418s
	iters: 500, epoch: 1 | loss: 0.2896612
	speed: 0.0065s/iter; left time: 23.8712s
Updating learning rate to 0.0005359963767340445
Validation loss decreased (inf --> 0.2851).  Saving model state dict ...
Epoch: 1 cost time: 4.682123899459839
Epoch: 1, Steps: 523 | Train Loss: 0.4910529 Vali Loss: 0.2850976 Best vali loss: 0.2850976
	iters: 100, epoch: 2 | loss: 0.2725548
	speed: 0.0183s/iter; left time: 65.1112s
	iters: 200, epoch: 2 | loss: 0.7207882
	speed: 0.0110s/iter; left time: 37.9715s
	iters: 300, epoch: 2 | loss: 0.3576042
	speed: 0.0113s/iter; left time: 37.9213s
	iters: 400, epoch: 2 | loss: 0.4042794
	speed: 0.0110s/iter; left time: 35.9745s
	iters: 500, epoch: 2 | loss: 0.4496273
	speed: 0.0103s/iter; left time: 32.6313s
Updating learning rate to 0.00047560308946149616
Epoch: 2 cost time: 5.762545108795166
Epoch: 2, Steps: 523 | Train Loss: 0.4409708 Vali Loss: 0.2857726 Best vali loss: 0.2850976
	iters: 100, epoch: 3 | loss: 0.7362032
	speed: 0.0227s/iter; left time: 68.9875s
	iters: 200, epoch: 3 | loss: 0.5025969
	speed: 0.0087s/iter; left time: 25.5203s
	iters: 300, epoch: 3 | loss: 0.4368948
	speed: 0.0069s/iter; left time: 19.5606s
	iters: 400, epoch: 3 | loss: 0.3374017
	speed: 0.0091s/iter; left time: 24.9450s
	iters: 500, epoch: 3 | loss: 0.4007300
	speed: 0.0086s/iter; left time: 22.7764s
Updating learning rate to 0.0003852181477030879
Validation loss decreased (0.2851 --> 0.2845).  Saving model state dict ...
Epoch: 3 cost time: 4.503458261489868
Epoch: 3, Steps: 523 | Train Loss: 0.4827653 Vali Loss: 0.2844521 Best vali loss: 0.2844521

best validation loss 0.28445213382551776

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5677455
	speed: 0.0145s/iter; left time: 74.4323s
	iters: 200, epoch: 4 | loss: 0.3043537
	speed: 0.0063s/iter; left time: 31.8772s
	iters: 300, epoch: 4 | loss: 0.5932760
	speed: 0.0066s/iter; left time: 32.6615s
	iters: 400, epoch: 4 | loss: 0.2649288
	speed: 0.0072s/iter; left time: 34.7535s
	iters: 500, epoch: 4 | loss: 0.8704267
	speed: 0.0072s/iter; left time: 34.1641s
	iters: 600, epoch: 4 | loss: 0.2713517
	speed: 0.0073s/iter; left time: 33.9621s
	iters: 700, epoch: 4 | loss: 0.3440305
	speed: 0.0062s/iter; left time: 28.0604s
	iters: 800, epoch: 4 | loss: 0.4449345
	speed: 0.0071s/iter; left time: 31.6144s
	iters: 900, epoch: 4 | loss: 0.1701426
	speed: 0.0072s/iter; left time: 31.3181s
	iters: 1000, epoch: 4 | loss: 0.5941039
	speed: 0.0071s/iter; left time: 29.8241s
Updating learning rate to 0.0001157747715
Epoch: 4 cost time: 7.672033786773682
Epoch: 4, Steps: 1045 | Train Loss: 0.4425294 Vali Loss: 0.2940686 Best vali loss: 0.2828753
	iters: 100, epoch: 5 | loss: 0.2074218
	speed: 0.0270s/iter; left time: 110.2800s
	iters: 200, epoch: 5 | loss: 0.2043894
	speed: 0.0063s/iter; left time: 25.1510s
	iters: 300, epoch: 5 | loss: 0.7184916
	speed: 0.0065s/iter; left time: 25.1541s
	iters: 400, epoch: 5 | loss: 0.3586248
	speed: 0.0070s/iter; left time: 26.4164s
	iters: 500, epoch: 5 | loss: 0.3578440
	speed: 0.0070s/iter; left time: 25.7873s
	iters: 600, epoch: 5 | loss: 0.3496161
	speed: 0.0057s/iter; left time: 20.5451s
	iters: 700, epoch: 5 | loss: 0.2291552
	speed: 0.0054s/iter; left time: 18.7629s
	iters: 800, epoch: 5 | loss: 0.3743888
	speed: 0.0046s/iter; left time: 15.6143s
	iters: 900, epoch: 5 | loss: 0.3989973
	speed: 0.0050s/iter; left time: 16.3700s
	iters: 1000, epoch: 5 | loss: 0.3356310
	speed: 0.0057s/iter; left time: 18.2595s
Updating learning rate to 7.146968456109603e-05
Epoch: 5 cost time: 6.255389451980591
Epoch: 5, Steps: 1045 | Train Loss: 0.3534560 Vali Loss: 0.2975700 Best vali loss: 0.2828753
	iters: 100, epoch: 6 | loss: 0.2368494
	speed: 0.0201s/iter; left time: 61.0420s
	iters: 200, epoch: 6 | loss: 0.8485305
	speed: 0.0046s/iter; left time: 13.4395s
	iters: 300, epoch: 6 | loss: 0.3056997
	speed: 0.0045s/iter; left time: 12.7692s
	iters: 400, epoch: 6 | loss: 0.2053117
	speed: 0.0047s/iter; left time: 12.7730s
	iters: 500, epoch: 6 | loss: 0.7429128
	speed: 0.0053s/iter; left time: 14.0776s
	iters: 600, epoch: 6 | loss: 0.1810307
	speed: 0.0054s/iter; left time: 13.5993s
	iters: 700, epoch: 6 | loss: 0.2930154
	speed: 0.0053s/iter; left time: 12.8040s
	iters: 800, epoch: 6 | loss: 0.2441661
	speed: 0.0050s/iter; left time: 11.7967s
	iters: 900, epoch: 6 | loss: 0.2762678
	speed: 0.0052s/iter; left time: 11.5806s
	iters: 1000, epoch: 6 | loss: 0.5761631
	speed: 0.0057s/iter; left time: 12.1677s
Updating learning rate to 3.390964548202697e-05
Epoch: 6 cost time: 5.352837562561035
Epoch: 6, Steps: 1045 | Train Loss: 0.3909947 Vali Loss: 0.2995526 Best vali loss: 0.2828753
	iters: 100, epoch: 7 | loss: 0.7050296
	speed: 0.0235s/iter; left time: 46.7170s
	iters: 200, epoch: 7 | loss: 0.1571243
	speed: 0.0053s/iter; left time: 10.0579s
	iters: 300, epoch: 7 | loss: 0.3040208
	speed: 0.0055s/iter; left time: 9.9177s
	iters: 400, epoch: 7 | loss: 0.7469888
	speed: 0.0056s/iter; left time: 9.5012s
	iters: 500, epoch: 7 | loss: 0.2837622
	speed: 0.0057s/iter; left time: 8.9989s
	iters: 600, epoch: 7 | loss: 0.4809709
	speed: 0.0060s/iter; left time: 8.9122s
	iters: 700, epoch: 7 | loss: 0.3212527
	speed: 0.0057s/iter; left time: 7.8962s
	iters: 800, epoch: 7 | loss: 0.4517132
	speed: 0.0058s/iter; left time: 7.4287s
	iters: 900, epoch: 7 | loss: 0.2556840
	speed: 0.0062s/iter; left time: 7.4277s
	iters: 1000, epoch: 7 | loss: 0.1509277
	speed: 0.0063s/iter; left time: 6.9193s
Updating learning rate to 8.812829729978956e-06
Epoch: 7 cost time: 6.099445104598999
Epoch: 7, Steps: 1045 | Train Loss: 0.3857474 Vali Loss: 0.2985023 Best vali loss: 0.2828753
	iters: 100, epoch: 8 | loss: 0.4126963
	speed: 0.0201s/iter; left time: 19.0197s
	iters: 200, epoch: 8 | loss: 0.3121067
	speed: 0.0052s/iter; left time: 4.4131s
	iters: 300, epoch: 8 | loss: 0.2327614
	speed: 0.0045s/iter; left time: 3.3402s
	iters: 400, epoch: 8 | loss: 1.2726102
	speed: 0.0044s/iter; left time: 2.8661s
	iters: 500, epoch: 8 | loss: 0.2754126
	speed: 0.0050s/iter; left time: 2.7388s
	iters: 600, epoch: 8 | loss: 0.4928066
	speed: 0.0063s/iter; left time: 2.7959s
	iters: 700, epoch: 8 | loss: 0.1817027
	speed: 0.0057s/iter; left time: 1.9871s
	iters: 800, epoch: 8 | loss: 0.7564846
	speed: 0.0052s/iter; left time: 1.2730s
	iters: 900, epoch: 8 | loss: 0.4614461
	speed: 0.0056s/iter; left time: 0.8116s
	iters: 1000, epoch: 8 | loss: 0.2254768
	speed: 0.0048s/iter; left time: 0.2219s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.342156171798706
Epoch: 8, Steps: 1045 | Train Loss: 0.4623504 Vali Loss: 0.2993636 Best vali loss: 0.2828753

best validation loss 0.2828752724000094

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021887918326, 'e_layers': 3, 'learning_rate': 0.0046350312805, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4813666
	speed: 0.0207s/iter; left time: 41.2670s
	iters: 200, epoch: 1 | loss: 0.4995256
	speed: 0.0136s/iter; left time: 25.8540s
Updating learning rate to 0.004458620906551766
Validation loss decreased (inf --> 0.3199).  Saving model state dict ...
Epoch: 1 cost time: 3.7072365283966064
Epoch: 1, Steps: 262 | Train Loss: 0.4904461 Vali Loss: 0.3199480 Best vali loss: 0.3199480
	iters: 100, epoch: 2 | loss: 0.8744914
	speed: 0.0323s/iter; left time: 56.0529s
	iters: 200, epoch: 2 | loss: 0.4007213
	speed: 0.0133s/iter; left time: 21.7097s
Updating learning rate to 0.003956246664976659
Epoch: 2 cost time: 3.7044496536254883
Epoch: 2, Steps: 262 | Train Loss: 0.6376063 Vali Loss: 0.3264638 Best vali loss: 0.3199480
	iters: 100, epoch: 3 | loss: 0.4354575
	speed: 0.0519s/iter; left time: 76.4596s
	iters: 200, epoch: 3 | loss: 0.3850846
	speed: 0.0141s/iter; left time: 19.3517s
Updating learning rate to 0.003204390480020649
Epoch: 3 cost time: 4.0333571434021
Epoch: 3, Steps: 262 | Train Loss: 0.4102710 Vali Loss: 0.3228423 Best vali loss: 0.3199480
	iters: 100, epoch: 4 | loss: 0.9457154
	speed: 0.0562s/iter; left time: 68.0202s
	iters: 200, epoch: 4 | loss: 0.9082992
	speed: 0.0153s/iter; left time: 16.9836s
Updating learning rate to 0.00231751564025
Epoch: 4 cost time: 3.8862357139587402
Epoch: 4, Steps: 262 | Train Loss: 0.9270073 Vali Loss: 0.3220915 Best vali loss: 0.3199480
	iters: 100, epoch: 5 | loss: 0.6695344
	speed: 0.0381s/iter; left time: 36.1354s
	iters: 200, epoch: 5 | loss: 0.4035912
	speed: 0.0145s/iter; left time: 12.3182s
Updating learning rate to 0.0014306408004793516
Epoch: 5 cost time: 4.072392225265503
Epoch: 5, Steps: 262 | Train Loss: 0.5365628 Vali Loss: 0.3220635 Best vali loss: 0.3199480
	iters: 100, epoch: 6 | loss: 0.5353507
	speed: 0.0531s/iter; left time: 36.4645s
	iters: 200, epoch: 6 | loss: 0.8404078
	speed: 0.0074s/iter; left time: 4.3523s
Updating learning rate to 0.0006787846155233418
Epoch: 6 cost time: 2.389608860015869
Epoch: 6, Steps: 262 | Train Loss: 0.6878793 Vali Loss: 0.3224012 Best vali loss: 0.3199480
	iters: 100, epoch: 7 | loss: 0.6285198
	speed: 0.0153s/iter; left time: 6.5147s
	iters: 200, epoch: 7 | loss: 0.7559980
	speed: 0.0085s/iter; left time: 2.7753s
Updating learning rate to 0.00017641037394823463
Epoch: 7 cost time: 2.3179731369018555
Epoch: 7, Steps: 262 | Train Loss: 0.6922589 Vali Loss: 0.3222838 Best vali loss: 0.3199480
	iters: 100, epoch: 8 | loss: 0.6371770
	speed: 0.0200s/iter; left time: 3.2550s
	iters: 200, epoch: 8 | loss: 0.6403775
	speed: 0.0086s/iter; left time: 0.5423s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.330169200897217
Epoch: 8, Steps: 262 | Train Loss: 0.6387772 Vali Loss: 0.3222817 Best vali loss: 0.3199480

best validation loss 0.319947969729504

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0017561299879, 'e_layers': 3, 'learning_rate': 0.0038539266204, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0037072452723939777
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 1.100639820098877
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2853488 Best vali loss: 0.2853488
Updating learning rate to 0.003289532133940097
Epoch: 2 cost time: 0.8373575210571289
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2873675 Best vali loss: 0.2853488
Updating learning rate to 0.0026643802437889314
Epoch: 3 cost time: 0.706489086151123
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2994453 Best vali loss: 0.2853488
Updating learning rate to 0.0019269633102
Epoch: 4 cost time: 0.728585958480835
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3028196 Best vali loss: 0.2853488
Updating learning rate to 0.001189546376611069
Epoch: 5 cost time: 0.5237851142883301
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2934900 Best vali loss: 0.2853488
Updating learning rate to 0.0005643944864599035
Epoch: 6 cost time: 0.6819298267364502
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2984450 Best vali loss: 0.2853488
Updating learning rate to 0.0001466813480060224
Epoch: 7 cost time: 0.67081618309021
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2957515 Best vali loss: 0.2853488
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8552861213684082
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2974736 Best vali loss: 0.2853488

best validation loss 0.2853488041293714

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0028466156951, 'e_layers': 3, 'learning_rate': 0.0006683878546, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4516672
	speed: 0.0153s/iter; left time: 30.5634s
	iters: 200, epoch: 1 | loss: 0.3675757
	speed: 0.0085s/iter; left time: 16.0553s
Updating learning rate to 0.000642948856622035
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 2.598071336746216
Epoch: 1, Steps: 262 | Train Loss: 0.4096214 Vali Loss: 0.2840504 Best vali loss: 0.2840504
	iters: 100, epoch: 2 | loss: 0.6851572
	speed: 0.0196s/iter; left time: 34.0411s
	iters: 200, epoch: 2 | loss: 0.3498351
	speed: 0.0085s/iter; left time: 13.8565s
Updating learning rate to 0.0005705047195251941
Epoch: 2 cost time: 2.2754878997802734
Epoch: 2, Steps: 262 | Train Loss: 0.5174961 Vali Loss: 0.2850316 Best vali loss: 0.2840504
	iters: 100, epoch: 3 | loss: 0.4349374
	speed: 0.0200s/iter; left time: 29.4401s
	iters: 200, epoch: 3 | loss: 0.3420008
	speed: 0.0087s/iter; left time: 11.8948s
Updating learning rate to 0.0004620844064747333
Epoch: 3 cost time: 2.303652286529541
Epoch: 3, Steps: 262 | Train Loss: 0.3884691 Vali Loss: 0.2889933 Best vali loss: 0.2840504

best validation loss 0.28405037812137746

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 4, 'learning_rate': 0.0005710106703, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2959026
	speed: 0.0149s/iter; left time: 60.7170s
	iters: 200, epoch: 1 | loss: 1.0033944
	speed: 0.0097s/iter; left time: 38.8104s
	iters: 300, epoch: 1 | loss: 1.3178760
	speed: 0.0105s/iter; left time: 40.6533s
	iters: 400, epoch: 1 | loss: 0.5366495
	speed: 0.0103s/iter; left time: 38.8882s
	iters: 500, epoch: 1 | loss: 1.0535575
	speed: 0.0098s/iter; left time: 36.0464s
Updating learning rate to 0.0005492778707178603
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 5.4467809200286865
Epoch: 1, Steps: 523 | Train Loss: 0.8414760 Vali Loss: 0.2858921 Best vali loss: 0.2858921
	iters: 100, epoch: 2 | loss: 0.2125093
	speed: 0.0198s/iter; left time: 70.6663s
	iters: 200, epoch: 2 | loss: 0.2539622
	speed: 0.0105s/iter; left time: 36.3382s
	iters: 300, epoch: 2 | loss: 1.1400084
	speed: 0.0099s/iter; left time: 33.4042s
	iters: 400, epoch: 2 | loss: 0.3311318
	speed: 0.0103s/iter; left time: 33.6681s
	iters: 500, epoch: 2 | loss: 0.2403726
	speed: 0.0102s/iter; left time: 32.3884s
Updating learning rate to 0.00048738809369950297
Validation loss decreased (0.2859 --> 0.2856).  Saving model state dict ...
Epoch: 2 cost time: 5.375906229019165
Epoch: 2, Steps: 523 | Train Loss: 0.4355969 Vali Loss: 0.2855869 Best vali loss: 0.2855869
	iters: 100, epoch: 3 | loss: 0.6583628
	speed: 0.0195s/iter; left time: 59.2997s
	iters: 200, epoch: 3 | loss: 0.2651006
	speed: 0.0097s/iter; left time: 28.3823s
	iters: 300, epoch: 3 | loss: 0.3265230
	speed: 0.0099s/iter; left time: 28.0556s
	iters: 400, epoch: 3 | loss: 0.9602599
	speed: 0.0098s/iter; left time: 26.8965s
	iters: 500, epoch: 3 | loss: 0.2890986
	speed: 0.0094s/iter; left time: 24.6769s
Updating learning rate to 0.00039476349676374734
Epoch: 3 cost time: 5.072642803192139
Epoch: 3, Steps: 523 | Train Loss: 0.4998690 Vali Loss: 0.3017250 Best vali loss: 0.2855869

best validation loss 0.28558687026747187

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9794468
	speed: 0.0129s/iter; left time: 25.8059s
	iters: 200, epoch: 1 | loss: 0.4898595
	speed: 0.0066s/iter; left time: 12.4422s
Updating learning rate to 0.000185960463
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 2.0778605937957764
Epoch: 1, Steps: 262 | Train Loss: 0.7346531 Vali Loss: 0.2761382 Best vali loss: 0.2761382
	iters: 100, epoch: 2 | loss: 0.7599688
	speed: 0.0155s/iter; left time: 26.8715s
	iters: 200, epoch: 2 | loss: 0.2681506
	speed: 0.0054s/iter; left time: 8.8632s
Updating learning rate to 9.29802315e-05
Epoch: 2 cost time: 1.5050127506256104
Epoch: 2, Steps: 262 | Train Loss: 0.5140597 Vali Loss: 0.2780215 Best vali loss: 0.2761382
	iters: 100, epoch: 3 | loss: 0.2688558
	speed: 0.0161s/iter; left time: 23.7262s
	iters: 200, epoch: 3 | loss: 0.5461835
	speed: 0.0061s/iter; left time: 8.3575s
Updating learning rate to 4.649011575e-05
Epoch: 3 cost time: 1.740807294845581
Epoch: 3, Steps: 262 | Train Loss: 0.4075197 Vali Loss: 0.2803170 Best vali loss: 0.2761382

best validation loss 0.27613815278723675

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7160526
	speed: 0.0131s/iter; left time: 15.8409s
	iters: 200, epoch: 4 | loss: 0.5041794
	speed: 0.0064s/iter; left time: 7.1133s
Updating learning rate to 2.3245057875e-05
Epoch: 4 cost time: 2.0210068225860596
Epoch: 4, Steps: 262 | Train Loss: 0.6101160 Vali Loss: 0.2830880 Best vali loss: 0.2761382
	iters: 100, epoch: 5 | loss: 0.6010026
	speed: 0.0151s/iter; left time: 14.2838s
	iters: 200, epoch: 5 | loss: 0.2575765
	speed: 0.0061s/iter; left time: 5.1737s
Updating learning rate to 1.16225289375e-05
Epoch: 5 cost time: 1.6156277656555176
Epoch: 5, Steps: 262 | Train Loss: 0.4292896 Vali Loss: 0.2838593 Best vali loss: 0.2761382
	iters: 100, epoch: 6 | loss: 0.2543968
	speed: 0.0179s/iter; left time: 12.3272s
	iters: 200, epoch: 6 | loss: 0.4827766
	speed: 0.0063s/iter; left time: 3.7104s
Updating learning rate to 5.81126446875e-06
Epoch: 6 cost time: 1.724984884262085
Epoch: 6, Steps: 262 | Train Loss: 0.3685867 Vali Loss: 0.2843191 Best vali loss: 0.2761382
	iters: 100, epoch: 7 | loss: 0.2391052
	speed: 0.0148s/iter; left time: 6.3015s
	iters: 200, epoch: 7 | loss: 0.5023280
	speed: 0.0060s/iter; left time: 1.9591s
Updating learning rate to 2.905632234375e-06
Epoch: 7 cost time: 1.623328447341919
Epoch: 7, Steps: 262 | Train Loss: 0.3707166 Vali Loss: 0.2868033 Best vali loss: 0.2761382
	iters: 100, epoch: 8 | loss: 0.2655461
	speed: 0.0194s/iter; left time: 3.1675s
	iters: 200, epoch: 8 | loss: 0.3765639
	speed: 0.0074s/iter; left time: 0.4672s
Updating learning rate to 1.4528161171875e-06
Epoch: 8 cost time: 1.928633689880371
Epoch: 8, Steps: 262 | Train Loss: 0.3210550 Vali Loss: 0.2864153 Best vali loss: 0.2761382

best validation loss 0.27613815278723675

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0041151835701, 'e_layers': 4, 'learning_rate': 0.0006660496499, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2221140
	speed: 0.0156s/iter; left time: 129.2365s
	iters: 200, epoch: 1 | loss: 0.4354374
	speed: 0.0095s/iter; left time: 77.3689s
	iters: 300, epoch: 1 | loss: 0.2011418
	speed: 0.0102s/iter; left time: 82.5415s
	iters: 400, epoch: 1 | loss: 1.0948044
	speed: 0.0102s/iter; left time: 81.2789s
	iters: 500, epoch: 1 | loss: 0.3814281
	speed: 0.0098s/iter; left time: 76.9551s
	iters: 600, epoch: 1 | loss: 0.4517559
	speed: 0.0096s/iter; left time: 74.7333s
	iters: 700, epoch: 1 | loss: 1.5538090
	speed: 0.0091s/iter; left time: 69.8164s
	iters: 800, epoch: 1 | loss: 0.5022040
	speed: 0.0098s/iter; left time: 74.4473s
	iters: 900, epoch: 1 | loss: 1.5409099
	speed: 0.0096s/iter; left time: 71.3051s
	iters: 1000, epoch: 1 | loss: 1.1681714
	speed: 0.0103s/iter; left time: 75.6497s
Updating learning rate to 0.0006660496499
Validation loss decreased (inf --> 0.2988).  Saving model state dict ...
Epoch: 1 cost time: 10.443082571029663
Epoch: 1, Steps: 1045 | Train Loss: 0.7551776 Vali Loss: 0.2988238 Best vali loss: 0.2988238
	iters: 100, epoch: 2 | loss: 0.2755826
	speed: 0.0295s/iter; left time: 213.0048s
	iters: 200, epoch: 2 | loss: 0.1830146
	speed: 0.0103s/iter; left time: 73.2786s
	iters: 300, epoch: 2 | loss: 1.3740066
	speed: 0.0103s/iter; left time: 72.5421s
	iters: 400, epoch: 2 | loss: 0.2725096
	speed: 0.0093s/iter; left time: 64.2744s
	iters: 500, epoch: 2 | loss: 0.2194100
	speed: 0.0091s/iter; left time: 61.8585s
	iters: 600, epoch: 2 | loss: 1.0804535
	speed: 0.0097s/iter; left time: 64.9715s
	iters: 700, epoch: 2 | loss: 0.4027346
	speed: 0.0108s/iter; left time: 71.2753s
	iters: 800, epoch: 2 | loss: 0.5189458
	speed: 0.0104s/iter; left time: 67.8621s
	iters: 900, epoch: 2 | loss: 0.5632814
	speed: 0.0099s/iter; left time: 63.6010s
	iters: 1000, epoch: 2 | loss: 0.5845047
	speed: 0.0094s/iter; left time: 59.0605s
Updating learning rate to 0.00033302482495
Validation loss decreased (0.2988 --> 0.2853).  Saving model state dict ...
Epoch: 2 cost time: 10.317370176315308
Epoch: 2, Steps: 1045 | Train Loss: 0.5474443 Vali Loss: 0.2852906 Best vali loss: 0.2852906
	iters: 100, epoch: 3 | loss: 0.9833178
	speed: 0.0299s/iter; left time: 184.4629s
	iters: 200, epoch: 3 | loss: 1.2068954
	speed: 0.0098s/iter; left time: 59.6939s
	iters: 300, epoch: 3 | loss: 0.1639995
	speed: 0.0101s/iter; left time: 60.5917s
	iters: 400, epoch: 3 | loss: 0.5094871
	speed: 0.0087s/iter; left time: 50.8466s
	iters: 500, epoch: 3 | loss: 1.0155983
	speed: 0.0099s/iter; left time: 57.0862s
	iters: 600, epoch: 3 | loss: 0.3244188
	speed: 0.0107s/iter; left time: 60.7262s
	iters: 700, epoch: 3 | loss: 0.3094762
	speed: 0.0102s/iter; left time: 57.0273s
	iters: 800, epoch: 3 | loss: 0.5819090
	speed: 0.0092s/iter; left time: 50.4654s
	iters: 900, epoch: 3 | loss: 0.2732972
	speed: 0.0080s/iter; left time: 43.1628s
	iters: 1000, epoch: 3 | loss: 0.2190070
	speed: 0.0098s/iter; left time: 51.6556s
Updating learning rate to 0.000166512412475
Validation loss decreased (0.2853 --> 0.2827).  Saving model state dict ...
Epoch: 3 cost time: 10.335508108139038
Epoch: 3, Steps: 1045 | Train Loss: 0.5587406 Vali Loss: 0.2827204 Best vali loss: 0.2827204
	iters: 100, epoch: 4 | loss: 0.9305406
	speed: 0.0389s/iter; left time: 199.5167s
	iters: 200, epoch: 4 | loss: 0.3138952
	speed: 0.0117s/iter; left time: 58.5538s
	iters: 300, epoch: 4 | loss: 0.2435133
	speed: 0.0101s/iter; left time: 49.5572s
	iters: 400, epoch: 4 | loss: 0.2532673
	speed: 0.0084s/iter; left time: 40.3492s
	iters: 500, epoch: 4 | loss: 0.3930635
	speed: 0.0081s/iter; left time: 38.4148s
	iters: 600, epoch: 4 | loss: 0.2029561
	speed: 0.0089s/iter; left time: 40.9599s
	iters: 700, epoch: 4 | loss: 0.4069760
	speed: 0.0134s/iter; left time: 60.7468s
	iters: 800, epoch: 4 | loss: 0.3333583
	speed: 0.0119s/iter; left time: 52.4513s
	iters: 900, epoch: 4 | loss: 0.7853712
	speed: 0.0076s/iter; left time: 33.0000s
	iters: 1000, epoch: 4 | loss: 0.5004935
	speed: 0.0121s/iter; left time: 51.1410s
Updating learning rate to 8.32562062375e-05
Epoch: 4 cost time: 10.975598812103271
Epoch: 4, Steps: 1045 | Train Loss: 0.4363435 Vali Loss: 0.3030959 Best vali loss: 0.2827204
	iters: 100, epoch: 5 | loss: 0.1740225
	speed: 0.0360s/iter; left time: 147.0006s
	iters: 200, epoch: 5 | loss: 0.3942236
	speed: 0.0078s/iter; left time: 31.2428s
	iters: 300, epoch: 5 | loss: 0.2276850
	speed: 0.0082s/iter; left time: 31.8768s
	iters: 400, epoch: 5 | loss: 0.3174291
	speed: 0.0084s/iter; left time: 31.6426s
	iters: 500, epoch: 5 | loss: 0.4433618
	speed: 0.0108s/iter; left time: 39.8019s
	iters: 600, epoch: 5 | loss: 0.2472991
	speed: 0.0098s/iter; left time: 34.9993s
	iters: 700, epoch: 5 | loss: 0.2415903
	speed: 0.0083s/iter; left time: 28.8664s
	iters: 800, epoch: 5 | loss: 0.4572800
	speed: 0.0112s/iter; left time: 37.8373s
	iters: 900, epoch: 5 | loss: 0.4191333
	speed: 0.0109s/iter; left time: 35.8311s
	iters: 1000, epoch: 5 | loss: 0.2840932
	speed: 0.0101s/iter; left time: 32.1906s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019713476268, 'e_layers': 3, 'learning_rate': 0.0026698473608, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2970395
	speed: 0.0154s/iter; left time: 62.7956s
	iters: 200, epoch: 1 | loss: 0.3315833
	speed: 0.0090s/iter; left time: 35.9309s
	iters: 300, epoch: 1 | loss: 0.8008289
	speed: 0.0079s/iter; left time: 30.6078s
	iters: 400, epoch: 1 | loss: 0.4936255
	speed: 0.0080s/iter; left time: 30.3267s
	iters: 500, epoch: 1 | loss: 0.3435133
	speed: 0.0084s/iter; left time: 30.8182s
Updating learning rate to 0.0026698473608
Validation loss decreased (inf --> 0.3214).  Saving model state dict ...
Epoch: 1 cost time: 4.767512083053589
Epoch: 1, Steps: 523 | Train Loss: 0.4533181 Vali Loss: 0.3214151 Best vali loss: 0.3214151
	iters: 100, epoch: 2 | loss: 0.6953520
	speed: 0.0192s/iter; left time: 68.5143s
	iters: 200, epoch: 2 | loss: 0.8403292
	speed: 0.0085s/iter; left time: 29.2652s
	iters: 300, epoch: 2 | loss: 0.4673753
	speed: 0.0148s/iter; left time: 49.6929s
	iters: 400, epoch: 2 | loss: 0.4319524
	speed: 0.0146s/iter; left time: 47.7171s
	iters: 500, epoch: 2 | loss: 0.6639891
	speed: 0.0118s/iter; left time: 37.3439s
Updating learning rate to 0.0013349236804
Validation loss decreased (0.3214 --> 0.3204).  Saving model state dict ...
Epoch: 2 cost time: 6.053119659423828
Epoch: 2, Steps: 523 | Train Loss: 0.6197996 Vali Loss: 0.3203917 Best vali loss: 0.3203917
	iters: 100, epoch: 3 | loss: 0.3545266
	speed: 0.0257s/iter; left time: 77.9751s
	iters: 200, epoch: 3 | loss: 0.5337644
	speed: 0.0155s/iter; left time: 45.4761s
	iters: 300, epoch: 3 | loss: 0.4209344
	speed: 0.0139s/iter; left time: 39.5805s
	iters: 400, epoch: 3 | loss: 0.5007791
	speed: 0.0132s/iter; left time: 36.1582s
	iters: 500, epoch: 3 | loss: 1.1121856
	speed: 0.0076s/iter; left time: 20.0653s
Updating learning rate to 0.0006674618402
Epoch: 3 cost time: 6.710156202316284
Epoch: 3, Steps: 523 | Train Loss: 0.5844380 Vali Loss: 0.3228721 Best vali loss: 0.3203917
	iters: 100, epoch: 4 | loss: 1.6957678
	speed: 0.0191s/iter; left time: 48.0438s
	iters: 200, epoch: 4 | loss: 1.4385031
	speed: 0.0092s/iter; left time: 22.1585s
	iters: 300, epoch: 4 | loss: 0.5374704
	speed: 0.0094s/iter; left time: 21.8658s
	iters: 400, epoch: 4 | loss: 0.6333002
	speed: 0.0093s/iter; left time: 20.6093s
	iters: 500, epoch: 4 | loss: 0.6129164
	speed: 0.0094s/iter; left time: 19.8206s
Updating learning rate to 0.0003337309201
Epoch: 4 cost time: 4.945523977279663
Epoch: 4, Steps: 523 | Train Loss: 0.9835916 Vali Loss: 0.3222270 Best vali loss: 0.3203917
	iters: 100, epoch: 5 | loss: 0.4242626
	speed: 0.0204s/iter; left time: 40.5865s
	iters: 200, epoch: 5 | loss: 1.3477769
	speed: 0.0094s/iter; left time: 17.7410s
	iters: 300, epoch: 5 | loss: 0.3064325
	speed: 0.0093s/iter; left time: 16.6148s
	iters: 400, epoch: 5 | loss: 0.5491819
	speed: 0.0095s/iter; left time: 16.0458s
	iters: 500, epoch: 5 | loss: 0.4727691
	speed: 0.0096s/iter; left time: 15.3478s
Updating learning rate to 0.00016686546005
Epoch: 5 cost time: 5.003129482269287
Epoch: 5, Steps: 523 | Train Loss: 0.6200846 Vali Loss: 0.3226867 Best vali loss: 0.3203917
	iters: 100, epoch: 6 | loss: 1.3237643
	speed: 0.0165s/iter; left time: 24.2221s
	iters: 200, epoch: 6 | loss: 0.2701472
	speed: 0.0074s/iter; left time: 10.1751s
	iters: 300, epoch: 6 | loss: 0.2878635
	speed: 0.0099s/iter; left time: 12.5159s
	iters: 400, epoch: 6 | loss: 0.4848738
	speed: 0.0099s/iter; left time: 11.5290s
	iters: 500, epoch: 6 | loss: 1.4434818
	speed: 0.0093s/iter; left time: 10.0007s
Updating learning rate to 8.3432730025e-05
Epoch: 6 cost time: 4.610172748565674
Epoch: 6, Steps: 523 | Train Loss: 0.7620261 Vali Loss: 0.3223184 Best vali loss: 0.3203917
	iters: 100, epoch: 7 | loss: 1.2500277
	speed: 0.0202s/iter; left time: 19.0979s
	iters: 200, epoch: 7 | loss: 0.4132260
	speed: 0.0101s/iter; left time: 8.5882s
	iters: 300, epoch: 7 | loss: 1.3141384
	speed: 0.0098s/iter; left time: 7.2970s
	iters: 400, epoch: 7 | loss: 1.2583410
	speed: 0.0102s/iter; left time: 6.6040s
	iters: 500, epoch: 7 | loss: 0.6505851
	speed: 0.0102s/iter; left time: 5.5804s
Updating learning rate to 4.17163650125e-05
Epoch: 7 cost time: 5.241105318069458
Epoch: 7, Steps: 523 | Train Loss: 0.9772636 Vali Loss: 0.3222243 Best vali loss: 0.3203917
	iters: 100, epoch: 8 | loss: 0.8074272
	speed: 0.0213s/iter; left time: 9.0179s
	iters: 200, epoch: 8 | loss: 1.2981715
	speed: 0.0096s/iter; left time: 3.1100s
	iters: 300, epoch: 8 | loss: 0.4280941
	speed: 0.0084s/iter; left time: 1.8727s
	iters: 400, epoch: 8 | loss: 0.3439309
	speed: 0.0096s/iter; left time: 1.1940s
	iters: 500, epoch: 8 | loss: 0.8136085
	speed: 0.0102s/iter; left time: 0.2450s
Updating learning rate to 2.085818250625e-05
Epoch: 8 cost time: 5.08561897277832
Epoch: 8, Steps: 523 | Train Loss: 0.7382464 Vali Loss: 0.3221683 Best vali loss: 0.3203917

best validation loss 0.320391700877027

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0034499937215, 'e_layers': 4, 'learning_rate': 8.93230697e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4412035
	speed: 0.0179s/iter; left time: 147.4821s
	iters: 200, epoch: 1 | loss: 0.6773059
	speed: 0.0092s/iter; left time: 75.3129s
	iters: 300, epoch: 1 | loss: 0.5071995
	speed: 0.0084s/iter; left time: 67.4078s
	iters: 400, epoch: 1 | loss: 0.8701968
	speed: 0.0100s/iter; left time: 79.9450s
	iters: 500, epoch: 1 | loss: 0.5671158
	speed: 0.0105s/iter; left time: 82.9138s
	iters: 600, epoch: 1 | loss: 0.3849741
	speed: 0.0107s/iter; left time: 82.6757s
	iters: 700, epoch: 1 | loss: 0.3136409
	speed: 0.0099s/iter; left time: 75.5759s
	iters: 800, epoch: 1 | loss: 0.5676847
	speed: 0.0081s/iter; left time: 61.3083s
	iters: 900, epoch: 1 | loss: 0.3083836
	speed: 0.0078s/iter; left time: 58.5261s
	iters: 1000, epoch: 1 | loss: 0.3151169
	speed: 0.0080s/iter; left time: 59.1740s
Updating learning rate to 8.93230697e-05
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 10.152632236480713
Epoch: 1, Steps: 1045 | Train Loss: 0.4952822 Vali Loss: 0.2869498 Best vali loss: 0.2869498
	iters: 100, epoch: 2 | loss: 0.5020767
	speed: 0.0274s/iter; left time: 197.6710s
	iters: 200, epoch: 2 | loss: 0.3702569
	speed: 0.0092s/iter; left time: 65.1893s
	iters: 300, epoch: 2 | loss: 0.4963137
	speed: 0.0085s/iter; left time: 59.6599s
	iters: 400, epoch: 2 | loss: 0.4709966
	speed: 0.0078s/iter; left time: 54.2381s
	iters: 500, epoch: 2 | loss: 0.2846172
	speed: 0.0086s/iter; left time: 58.6010s
	iters: 600, epoch: 2 | loss: 0.7829999
	speed: 0.0101s/iter; left time: 67.5823s
	iters: 700, epoch: 2 | loss: 1.1355799
	speed: 0.0083s/iter; left time: 55.1083s
	iters: 800, epoch: 2 | loss: 0.4961625
	speed: 0.0083s/iter; left time: 53.7734s
	iters: 900, epoch: 2 | loss: 0.2418918
	speed: 0.0086s/iter; left time: 55.3248s
	iters: 1000, epoch: 2 | loss: 0.2121705
	speed: 0.0141s/iter; left time: 89.2534s
Updating learning rate to 4.466153485e-05
Validation loss decreased (0.2869 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 9.842199325561523
Epoch: 2, Steps: 1045 | Train Loss: 0.4993066 Vali Loss: 0.2836076 Best vali loss: 0.2836076
	iters: 100, epoch: 3 | loss: 0.5452661
	speed: 0.0317s/iter; left time: 195.4416s
	iters: 200, epoch: 3 | loss: 0.7277218
	speed: 0.0103s/iter; left time: 62.5162s
	iters: 300, epoch: 3 | loss: 0.3404615
	speed: 0.0094s/iter; left time: 56.3223s
	iters: 400, epoch: 3 | loss: 0.2094651
	speed: 0.0089s/iter; left time: 52.3473s
	iters: 500, epoch: 3 | loss: 0.3904696
	speed: 0.0086s/iter; left time: 49.6914s
	iters: 600, epoch: 3 | loss: 0.3692822
	speed: 0.0109s/iter; left time: 61.8927s
	iters: 700, epoch: 3 | loss: 0.9483304
	speed: 0.0109s/iter; left time: 60.7213s
	iters: 800, epoch: 3 | loss: 0.1859899
	speed: 0.0108s/iter; left time: 59.1324s
	iters: 900, epoch: 3 | loss: 0.2229030
	speed: 0.0108s/iter; left time: 57.9321s
	iters: 1000, epoch: 3 | loss: 0.2180513
	speed: 0.0093s/iter; left time: 48.8488s
Updating learning rate to 2.2330767425e-05
Validation loss decreased (0.2836 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 10.526035785675049
Epoch: 3, Steps: 1045 | Train Loss: 0.4157941 Vali Loss: 0.2819142 Best vali loss: 0.2819142

best validation loss 0.2819142126602593

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017385786266, 'e_layers': 3, 'learning_rate': 0.0027139761097, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3657630
	speed: 0.0148s/iter; left time: 14.0734s
Updating learning rate to 0.0026106815445882184
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 1.4320275783538818
Epoch: 1, Steps: 131 | Train Loss: 0.3657630 Vali Loss: 0.2844758 Best vali loss: 0.2844758
	iters: 100, epoch: 2 | loss: 0.6036608
	speed: 0.0138s/iter; left time: 11.3033s
Updating learning rate to 0.0023165235104235776
Epoch: 2 cost time: 1.1086697578430176
Epoch: 2, Steps: 131 | Train Loss: 0.6036608 Vali Loss: 0.2867111 Best vali loss: 0.2844758
	iters: 100, epoch: 3 | loss: 0.8136618
	speed: 0.0168s/iter; left time: 11.5624s
Updating learning rate to 0.0018762849013584247
Epoch: 3 cost time: 1.563971757888794
Epoch: 3, Steps: 131 | Train Loss: 0.8136618 Vali Loss: 0.2879374 Best vali loss: 0.2844758

best validation loss 0.284475846593599

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0018682829331, 'e_layers': 2, 'learning_rate': 0.0025289717944, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7757419
	speed: 0.0200s/iter; left time: 18.9371s
Updating learning rate to 0.0024327185367722507
Validation loss decreased (inf --> 0.3030).  Saving model state dict ...
Epoch: 1 cost time: 2.093353033065796
Epoch: 1, Steps: 131 | Train Loss: 0.7757419 Vali Loss: 0.3030474 Best vali loss: 0.3030474
	iters: 100, epoch: 2 | loss: 0.7267430
	speed: 0.0357s/iter; left time: 29.1963s
Updating learning rate to 0.0021586124498248756
Validation loss decreased (0.3030 --> 0.2949).  Saving model state dict ...
Epoch: 2 cost time: 3.37617564201355
Epoch: 2, Steps: 131 | Train Loss: 0.7267430 Vali Loss: 0.2948667 Best vali loss: 0.2948667
	iters: 100, epoch: 3 | loss: 0.4971521
	speed: 0.0618s/iter; left time: 42.4492s
Updating learning rate to 0.001748383700517746
Validation loss decreased (0.2949 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 3.987618923187256
Epoch: 3, Steps: 131 | Train Loss: 0.4971521 Vali Loss: 0.2905670 Best vali loss: 0.2905670

best validation loss 0.2905670398892679

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0034499937215, 'e_layers': 4, 'learning_rate': 8.93230697e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3865546
	speed: 0.0159s/iter; left time: 81.6800s
	iters: 200, epoch: 4 | loss: 0.6530132
	speed: 0.0094s/iter; left time: 46.9944s
	iters: 300, epoch: 4 | loss: 0.4992104
	speed: 0.0084s/iter; left time: 41.5716s
	iters: 400, epoch: 4 | loss: 0.6355981
	speed: 0.0079s/iter; left time: 37.9291s
	iters: 500, epoch: 4 | loss: 0.5413655
	speed: 0.0087s/iter; left time: 40.9975s
	iters: 600, epoch: 4 | loss: 0.3879214
	speed: 0.0102s/iter; left time: 47.3819s
	iters: 700, epoch: 4 | loss: 0.2784525
	speed: 0.0073s/iter; left time: 32.8950s
	iters: 800, epoch: 4 | loss: 0.5652561
	speed: 0.0091s/iter; left time: 40.4250s
	iters: 900, epoch: 4 | loss: 0.3071921
	speed: 0.0114s/iter; left time: 49.1352s
	iters: 1000, epoch: 4 | loss: 0.3067266
	speed: 0.0101s/iter; left time: 42.5949s
Updating learning rate to 1.11653837125e-05
Validation loss decreased (0.2819 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 9.882763385772705
Epoch: 4, Steps: 1045 | Train Loss: 0.4561291 Vali Loss: 0.2818059 Best vali loss: 0.2818059
	iters: 100, epoch: 5 | loss: 0.5093373
	speed: 0.0305s/iter; left time: 124.3981s
	iters: 200, epoch: 5 | loss: 0.3724807
	speed: 0.0088s/iter; left time: 34.8945s
	iters: 300, epoch: 5 | loss: 0.4456337
	speed: 0.0109s/iter; left time: 42.2924s
	iters: 400, epoch: 5 | loss: 0.4781136
	speed: 0.0096s/iter; left time: 36.4241s
	iters: 500, epoch: 5 | loss: 0.2843578
	speed: 0.0111s/iter; left time: 40.9689s
	iters: 600, epoch: 5 | loss: 0.8248696
	speed: 0.0097s/iter; left time: 34.5993s
	iters: 700, epoch: 5 | loss: 1.0995717
	speed: 0.0106s/iter; left time: 36.9889s
	iters: 800, epoch: 5 | loss: 0.4822391
	speed: 0.0085s/iter; left time: 28.6027s
	iters: 900, epoch: 5 | loss: 0.2424920
	speed: 0.0089s/iter; left time: 29.1315s
	iters: 1000, epoch: 5 | loss: 0.2102976
	speed: 0.0122s/iter; left time: 38.6516s
Updating learning rate to 5.58269185625e-06
Validation loss decreased (0.2818 --> 0.2818).  Saving model state dict ...
Epoch: 5 cost time: 10.614755153656006
Epoch: 5, Steps: 1045 | Train Loss: 0.4949393 Vali Loss: 0.2817531 Best vali loss: 0.2817531
	iters: 100, epoch: 6 | loss: 0.5455798
	speed: 0.0281s/iter; left time: 85.2445s
	iters: 200, epoch: 6 | loss: 0.7504327
	speed: 0.0105s/iter; left time: 30.6927s
	iters: 300, epoch: 6 | loss: 0.3290313
	speed: 0.0094s/iter; left time: 26.6541s
	iters: 400, epoch: 6 | loss: 0.1889789
	speed: 0.0109s/iter; left time: 29.8088s
	iters: 500, epoch: 6 | loss: 0.3657687
	speed: 0.0086s/iter; left time: 22.6634s
	iters: 600, epoch: 6 | loss: 0.3600205
	speed: 0.0103s/iter; left time: 26.1190s
	iters: 700, epoch: 6 | loss: 0.9677466
	speed: 0.0072s/iter; left time: 17.4912s
	iters: 800, epoch: 6 | loss: 0.1800698
	speed: 0.0066s/iter; left time: 15.4334s
	iters: 900, epoch: 6 | loss: 0.2231145
	speed: 0.0073s/iter; left time: 16.2331s
	iters: 1000, epoch: 6 | loss: 0.2229950
	speed: 0.0088s/iter; left time: 18.7831s
Updating learning rate to 2.791345928125e-06
Epoch: 6 cost time: 9.351690530776978
Epoch: 6, Steps: 1045 | Train Loss: 0.4133738 Vali Loss: 0.2818802 Best vali loss: 0.2817531
	iters: 100, epoch: 7 | loss: 0.2180117
	speed: 0.0294s/iter; left time: 58.5514s
	iters: 200, epoch: 7 | loss: 0.2125887
	speed: 0.0089s/iter; left time: 16.9215s
	iters: 300, epoch: 7 | loss: 0.3155124
	speed: 0.0096s/iter; left time: 17.2776s
	iters: 400, epoch: 7 | loss: 0.3553585
	speed: 0.0084s/iter; left time: 14.1794s
	iters: 500, epoch: 7 | loss: 0.8512648
	speed: 0.0087s/iter; left time: 13.8721s
	iters: 600, epoch: 7 | loss: 0.5490409
	speed: 0.0116s/iter; left time: 17.3634s
	iters: 700, epoch: 7 | loss: 0.2480028
	speed: 0.0101s/iter; left time: 14.1042s
	iters: 800, epoch: 7 | loss: 0.3672119
	speed: 0.0099s/iter; left time: 12.8372s
	iters: 900, epoch: 7 | loss: 0.3155596
	speed: 0.0088s/iter; left time: 10.5031s
	iters: 1000, epoch: 7 | loss: 1.3680395
	speed: 0.0076s/iter; left time: 8.2577s
Updating learning rate to 1.3956729640625e-06
Epoch: 7 cost time: 9.847877740859985
Epoch: 7, Steps: 1045 | Train Loss: 0.4800591 Vali Loss: 0.2818085 Best vali loss: 0.2817531
	iters: 100, epoch: 8 | loss: 0.8375404
	speed: 0.0254s/iter; left time: 24.0688s
	iters: 200, epoch: 8 | loss: 0.3593735
	speed: 0.0125s/iter; left time: 10.6037s
	iters: 300, epoch: 8 | loss: 0.4152420
	speed: 0.0113s/iter; left time: 8.4524s
	iters: 400, epoch: 8 | loss: 0.3434353
	speed: 0.0137s/iter; left time: 8.8250s
	iters: 500, epoch: 8 | loss: 0.2226917
	speed: 0.0113s/iter; left time: 6.1826s
	iters: 600, epoch: 8 | loss: 0.3178666
	speed: 0.0126s/iter; left time: 5.6026s
	iters: 700, epoch: 8 | loss: 0.3888719
	speed: 0.0084s/iter; left time: 2.9017s
	iters: 800, epoch: 8 | loss: 0.2767948
	speed: 0.0094s/iter; left time: 2.3074s
	iters: 900, epoch: 8 | loss: 0.2848833
	speed: 0.0084s/iter; left time: 1.2310s
	iters: 1000, epoch: 8 | loss: 0.4619878
	speed: 0.0094s/iter; left time: 0.4311s
Updating learning rate to 6.9783648203125e-07
Epoch: 8 cost time: 10.980168342590332
Epoch: 8, Steps: 1045 | Train Loss: 0.3908687 Vali Loss: 0.2818258 Best vali loss: 0.2817531

best validation loss 0.28175311661112395

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0015476159007, 'e_layers': 3, 'learning_rate': 0.0012643598392, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0012643598392
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 1.2117433547973633
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2847770 Best vali loss: 0.2847770
Updating learning rate to 0.0006321799196
Epoch: 2 cost time: 0.7349421977996826
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2875636 Best vali loss: 0.2847770
Updating learning rate to 0.0003160899598
Epoch: 3 cost time: 0.7042992115020752
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2865018 Best vali loss: 0.2847770
Updating learning rate to 0.0001580449799
Epoch: 4 cost time: 0.5396780967712402
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2955738 Best vali loss: 0.2847770
Updating learning rate to 7.902248995e-05
Epoch: 5 cost time: 0.5033800601959229
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2865461 Best vali loss: 0.2847770
Updating learning rate to 3.9511244975e-05
Epoch: 6 cost time: 0.7118048667907715
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2912446 Best vali loss: 0.2847770
Updating learning rate to 1.97556224875e-05
Epoch: 7 cost time: 0.6971476078033447
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2894977 Best vali loss: 0.2847770
Updating learning rate to 9.87781124375e-06
Epoch: 8 cost time: 0.7827787399291992
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2904325 Best vali loss: 0.2847770

best validation loss 0.28477696349581805

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.003264547774, 'e_layers': 4, 'learning_rate': 0.0017270885725, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4568889
	speed: 0.0168s/iter; left time: 33.5663s
	iters: 200, epoch: 1 | loss: 0.3384697
	speed: 0.0097s/iter; left time: 18.3897s
Updating learning rate to 0.0016613551777334428
Validation loss decreased (inf --> 0.2937).  Saving model state dict ...
Epoch: 1 cost time: 2.9584643840789795
Epoch: 1, Steps: 262 | Train Loss: 0.3976793 Vali Loss: 0.2937417 Best vali loss: 0.2937417
	iters: 100, epoch: 2 | loss: 0.9062113
	speed: 0.0236s/iter; left time: 40.8621s
	iters: 200, epoch: 2 | loss: 0.4452897
	speed: 0.0097s/iter; left time: 15.8904s
Updating learning rate to 0.001474162306912272
Epoch: 2 cost time: 2.753958225250244
Epoch: 2, Steps: 262 | Train Loss: 0.6757505 Vali Loss: 0.2992843 Best vali loss: 0.2937417
	iters: 100, epoch: 3 | loss: 0.8018154
	speed: 0.0218s/iter; left time: 32.0654s
	iters: 200, epoch: 3 | loss: 0.4634920
	speed: 0.0099s/iter; left time: 13.5626s
Updating learning rate to 0.0011940083777114117
Epoch: 3 cost time: 2.6933469772338867
Epoch: 3, Steps: 262 | Train Loss: 0.6326537 Vali Loss: 0.3085939 Best vali loss: 0.2937417
	iters: 100, epoch: 4 | loss: 0.2572535
	speed: 0.0228s/iter; left time: 27.5994s
	iters: 200, epoch: 4 | loss: 0.4457942
	speed: 0.0087s/iter; left time: 9.6185s
Updating learning rate to 0.00086354428625
Validation loss decreased (0.2937 --> 0.2918).  Saving model state dict ...
Epoch: 4 cost time: 2.4033420085906982
Epoch: 4, Steps: 262 | Train Loss: 0.3515239 Vali Loss: 0.2917507 Best vali loss: 0.2917507
	iters: 100, epoch: 5 | loss: 0.4841352
	speed: 0.0210s/iter; left time: 19.9069s
	iters: 200, epoch: 5 | loss: 0.6479731
	speed: 0.0090s/iter; left time: 7.6620s
Updating learning rate to 0.0005330801947885885
Epoch: 5 cost time: 2.4363865852355957
Epoch: 5, Steps: 262 | Train Loss: 0.5660541 Vali Loss: 0.2984671 Best vali loss: 0.2917507
	iters: 100, epoch: 6 | loss: 0.3873578
	speed: 0.0212s/iter; left time: 14.5612s
	iters: 200, epoch: 6 | loss: 0.5006946
	speed: 0.0098s/iter; left time: 5.7344s
Updating learning rate to 0.00025292626558772797
Epoch: 6 cost time: 2.6091341972351074
Epoch: 6, Steps: 262 | Train Loss: 0.4440262 Vali Loss: 0.3079302 Best vali loss: 0.2917507
	iters: 100, epoch: 7 | loss: 0.3500400
	speed: 0.0220s/iter; left time: 9.3347s
	iters: 200, epoch: 7 | loss: 0.5833756
	speed: 0.0097s/iter; left time: 3.1661s
Updating learning rate to 6.573339476655723e-05
Epoch: 7 cost time: 2.62095308303833
Epoch: 7, Steps: 262 | Train Loss: 0.4667078 Vali Loss: 0.3033375 Best vali loss: 0.2917507
	iters: 100, epoch: 8 | loss: 0.5204348
	speed: 0.0219s/iter; left time: 3.5643s
	iters: 200, epoch: 8 | loss: 0.2882969
	speed: 0.0096s/iter; left time: 0.6075s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.664198875427246
Epoch: 8, Steps: 262 | Train Loss: 0.4043659 Vali Loss: 0.3129955 Best vali loss: 0.2917507

best validation loss 0.29175072062764745

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021027913259, 'e_layers': 4, 'learning_rate': 0.0002728683561, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5489365
	speed: 0.0186s/iter; left time: 17.6188s
Updating learning rate to 0.0002728683561
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 1.8566935062408447
Epoch: 1, Steps: 131 | Train Loss: 0.5489365 Vali Loss: 0.2836573 Best vali loss: 0.2836573
	iters: 100, epoch: 2 | loss: 0.5386113
	speed: 0.0182s/iter; left time: 14.9199s
Updating learning rate to 0.00013643417805
Epoch: 2 cost time: 1.4804470539093018
Epoch: 2, Steps: 131 | Train Loss: 0.5386113 Vali Loss: 0.2885629 Best vali loss: 0.2836573
	iters: 100, epoch: 3 | loss: 0.4054230
	speed: 0.0189s/iter; left time: 12.9588s
Updating learning rate to 6.8217089025e-05
Epoch: 3 cost time: 1.6255574226379395
Epoch: 3, Steps: 131 | Train Loss: 0.4054230 Vali Loss: 0.2871963 Best vali loss: 0.2836573

best validation loss 0.2836573156349807

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0062557943565, 'e_layers': 2, 'learning_rate': 0.0002070863295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5387578
	speed: 0.0181s/iter; left time: 17.1430s
Updating learning rate to 0.00019920457539396915
Validation loss decreased (inf --> 0.3140).  Saving model state dict ...
Epoch: 1 cost time: 2.118250608444214
Epoch: 1, Steps: 131 | Train Loss: 0.5387578 Vali Loss: 0.3140267 Best vali loss: 0.3140267
	iters: 100, epoch: 2 | loss: 0.5087777
	speed: 0.0364s/iter; left time: 29.8017s
Updating learning rate to 0.00017675923869024088
Validation loss decreased (0.3140 --> 0.3000).  Saving model state dict ...
Epoch: 2 cost time: 2.6268110275268555
Epoch: 2, Steps: 131 | Train Loss: 0.5087777 Vali Loss: 0.2999731 Best vali loss: 0.2999731
	iters: 100, epoch: 3 | loss: 0.5342824
	speed: 0.0336s/iter; left time: 23.1038s
Updating learning rate to 0.00014316741843447398
Validation loss decreased (0.3000 --> 0.2936).  Saving model state dict ...
Epoch: 3 cost time: 2.781642198562622
Epoch: 3, Steps: 131 | Train Loss: 0.5342824 Vali Loss: 0.2935628 Best vali loss: 0.2935628

best validation loss 0.2935627913244509

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0113317930616, 'e_layers': 3, 'learning_rate': 0.0002766856234, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000266154903899693
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 2.111694097518921
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2803094 Best vali loss: 0.2803094
Updating learning rate to 0.00023616595198148365
Validation loss decreased (0.2803 --> 0.2787).  Saving model state dict ...
Epoch: 2 cost time: 1.3296558856964111
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2787216 Best vali loss: 0.2787216
Updating learning rate to 0.0001912843137243933
Epoch: 3 cost time: 0.9123823642730713
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2823653 Best vali loss: 0.2787216

best validation loss 0.2787216034308824

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0113317930616, 'e_layers': 3, 'learning_rate': 0.0002766856234, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001383428117
Epoch: 4 cost time: 1.0886094570159912
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2868793 Best vali loss: 0.2787216
Updating learning rate to 8.540130967560671e-05
Epoch: 5 cost time: 1.121666669845581
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2817065 Best vali loss: 0.2787216
Updating learning rate to 4.051967141851636e-05
Epoch: 6 cost time: 1.3385944366455078
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2899640 Best vali loss: 0.2787216
Updating learning rate to 1.0530719500307031e-05
Epoch: 7 cost time: 1.2117440700531006
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2847194 Best vali loss: 0.2787216
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1303796768188477
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2861717 Best vali loss: 0.2787216

best validation loss 0.2787216034308824

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0015454114518, 'e_layers': 2, 'learning_rate': 0.0005838571925, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8060006
	speed: 0.0107s/iter; left time: 88.3985s
	iters: 200, epoch: 1 | loss: 0.8385115
	speed: 0.0087s/iter; left time: 71.3764s
	iters: 300, epoch: 1 | loss: 1.2969853
	speed: 0.0107s/iter; left time: 85.9431s
	iters: 400, epoch: 1 | loss: 0.3589765
	speed: 0.0103s/iter; left time: 81.6411s
	iters: 500, epoch: 1 | loss: 0.2953901
	speed: 0.0106s/iter; left time: 83.0811s
	iters: 600, epoch: 1 | loss: 0.1947281
	speed: 0.0082s/iter; left time: 63.9750s
	iters: 700, epoch: 1 | loss: 0.4488717
	speed: 0.0107s/iter; left time: 82.0423s
	iters: 800, epoch: 1 | loss: 0.2404322
	speed: 0.0073s/iter; left time: 55.5408s
	iters: 900, epoch: 1 | loss: 0.4740178
	speed: 0.0063s/iter; left time: 46.7345s
	iters: 1000, epoch: 1 | loss: 0.3254036
	speed: 0.0071s/iter; left time: 52.6274s
Updating learning rate to 0.0005616354512801262
Validation loss decreased (inf --> 0.3112).  Saving model state dict ...
Epoch: 1 cost time: 9.075511693954468
Epoch: 1, Steps: 1045 | Train Loss: 0.5279317 Vali Loss: 0.3112177 Best vali loss: 0.3112177
	iters: 100, epoch: 2 | loss: 1.6060221
	speed: 0.0228s/iter; left time: 164.5260s
	iters: 200, epoch: 2 | loss: 1.1507469
	speed: 0.0087s/iter; left time: 62.2526s
	iters: 300, epoch: 2 | loss: 0.1651544
	speed: 0.0114s/iter; left time: 79.8561s
	iters: 400, epoch: 2 | loss: 0.2856011
	speed: 0.0081s/iter; left time: 56.2911s
	iters: 500, epoch: 2 | loss: 0.7828638
	speed: 0.0113s/iter; left time: 76.9586s
	iters: 600, epoch: 2 | loss: 0.4072827
	speed: 0.0101s/iter; left time: 67.5434s
	iters: 700, epoch: 2 | loss: 0.4883208
	speed: 0.0111s/iter; left time: 73.4608s
	iters: 800, epoch: 2 | loss: 0.6886467
	speed: 0.0095s/iter; left time: 62.1577s
	iters: 900, epoch: 2 | loss: 0.1434535
	speed: 0.0109s/iter; left time: 70.1796s
	iters: 1000, epoch: 2 | loss: 1.7656375
	speed: 0.0072s/iter; left time: 45.6582s
Updating learning rate to 0.0004983532862806447
Validation loss decreased (0.3112 --> 0.2981).  Saving model state dict ...
Epoch: 2 cost time: 9.997988224029541
Epoch: 2, Steps: 1045 | Train Loss: 0.7483729 Vali Loss: 0.2981276 Best vali loss: 0.2981276
	iters: 100, epoch: 3 | loss: 0.4944940
	speed: 0.0284s/iter; left time: 175.5191s
	iters: 200, epoch: 3 | loss: 1.1725997
	speed: 0.0072s/iter; left time: 43.9153s
	iters: 300, epoch: 3 | loss: 0.4999086
	speed: 0.0075s/iter; left time: 45.0104s
	iters: 400, epoch: 3 | loss: 2.0792129
	speed: 0.0074s/iter; left time: 43.2167s
	iters: 500, epoch: 3 | loss: 0.5556123
	speed: 0.0075s/iter; left time: 43.2527s
	iters: 600, epoch: 3 | loss: 0.3215384
	speed: 0.0076s/iter; left time: 43.3081s
	iters: 700, epoch: 3 | loss: 0.2352884
	speed: 0.0066s/iter; left time: 36.5711s
	iters: 800, epoch: 3 | loss: 0.3057456
	speed: 0.0069s/iter; left time: 37.9322s
	iters: 900, epoch: 3 | loss: 0.8378320
	speed: 0.0072s/iter; left time: 38.4997s
	iters: 1000, epoch: 3 | loss: 0.8201927
	speed: 0.0052s/iter; left time: 27.2612s
Updating learning rate to 0.0004036448334684725
Epoch: 3 cost time: 7.238771915435791
Epoch: 3, Steps: 1045 | Train Loss: 0.7322425 Vali Loss: 0.3064953 Best vali loss: 0.2981276
	iters: 100, epoch: 4 | loss: 0.3475481
	speed: 0.0282s/iter; left time: 144.5935s
	iters: 200, epoch: 4 | loss: 0.3048511
	speed: 0.0081s/iter; left time: 40.5058s
	iters: 300, epoch: 4 | loss: 0.4965572
	speed: 0.0083s/iter; left time: 40.6762s
	iters: 400, epoch: 4 | loss: 0.7118074
	speed: 0.0076s/iter; left time: 36.6185s
	iters: 500, epoch: 4 | loss: 0.9513784
	speed: 0.0069s/iter; left time: 32.5412s
	iters: 600, epoch: 4 | loss: 1.1836797
	speed: 0.0082s/iter; left time: 37.9459s
	iters: 700, epoch: 4 | loss: 0.1804950
	speed: 0.0081s/iter; left time: 36.6497s
	iters: 800, epoch: 4 | loss: 0.1921365
	speed: 0.0081s/iter; left time: 35.8141s
	iters: 900, epoch: 4 | loss: 0.2962206
	speed: 0.0080s/iter; left time: 34.5159s
	iters: 1000, epoch: 4 | loss: 0.2490230
	speed: 0.0076s/iter; left time: 32.1778s
Updating learning rate to 0.00029192859625
Validation loss decreased (0.2981 --> 0.2937).  Saving model state dict ...
Epoch: 4 cost time: 8.306311130523682
Epoch: 4, Steps: 1045 | Train Loss: 0.4913697 Vali Loss: 0.2937302 Best vali loss: 0.2937302
	iters: 100, epoch: 5 | loss: 1.2213080
	speed: 0.0278s/iter; left time: 113.5943s
	iters: 200, epoch: 5 | loss: 0.6197574
	speed: 0.0066s/iter; left time: 26.4330s
	iters: 300, epoch: 5 | loss: 0.2253622
	speed: 0.0077s/iter; left time: 29.7567s
	iters: 400, epoch: 5 | loss: 0.2744843
	speed: 0.0084s/iter; left time: 31.7619s
	iters: 500, epoch: 5 | loss: 1.4442724
	speed: 0.0085s/iter; left time: 31.1248s
	iters: 600, epoch: 5 | loss: 0.3218426
	speed: 0.0080s/iter; left time: 28.6068s
	iters: 700, epoch: 5 | loss: 0.3349838
	speed: 0.0070s/iter; left time: 24.4832s
	iters: 800, epoch: 5 | loss: 0.3883797
	speed: 0.0074s/iter; left time: 24.9146s
	iters: 900, epoch: 5 | loss: 0.2163237
	speed: 0.0082s/iter; left time: 26.8300s
	iters: 1000, epoch: 5 | loss: 0.2873510
	speed: 0.0081s/iter; left time: 25.6623s
Updating learning rate to 0.00018021235903152753
Epoch: 5 cost time: 8.211389780044556
Epoch: 5, Steps: 1045 | Train Loss: 0.5334065 Vali Loss: 0.3000207 Best vali loss: 0.2937302
	iters: 100, epoch: 6 | loss: 0.2217625
	speed: 0.0285s/iter; left time: 86.4744s
	iters: 200, epoch: 6 | loss: 0.2344424
	speed: 0.0079s/iter; left time: 23.2822s
	iters: 300, epoch: 6 | loss: 0.2833345
	speed: 0.0098s/iter; left time: 27.6913s
	iters: 400, epoch: 6 | loss: 1.0760603
	speed: 0.0090s/iter; left time: 24.5564s
	iters: 500, epoch: 6 | loss: 0.3447243
	speed: 0.0085s/iter; left time: 22.2985s
	iters: 600, epoch: 6 | loss: 0.4216126
	speed: 0.0103s/iter; left time: 26.0232s
	iters: 700, epoch: 6 | loss: 0.1895460
	speed: 0.0097s/iter; left time: 23.6141s
	iters: 800, epoch: 6 | loss: 0.3912928
	speed: 0.0108s/iter; left time: 25.1169s
	iters: 900, epoch: 6 | loss: 0.2206967
	speed: 0.0065s/iter; left time: 14.6447s
	iters: 1000, epoch: 6 | loss: 0.5036088
	speed: 0.0052s/iter; left time: 11.1498s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0033696973947, 'e_layers': 1, 'learning_rate': 0.0007261667423, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000698528666350684
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 1.288999319076538
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2861139 Best vali loss: 0.2861139
Updating learning rate to 0.000619822085026237
Validation loss decreased (0.2861 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 1.1007497310638428
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2824229 Best vali loss: 0.2824229
Updating learning rate to 0.0005020293618563698
Validation loss decreased (0.2824 --> 0.2803).  Saving model state dict ...
Epoch: 3 cost time: 1.6721558570861816
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2803338 Best vali loss: 0.2803338
Updating learning rate to 0.00036308337115
Epoch: 4 cost time: 2.629410982131958
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2817762 Best vali loss: 0.2803338
Updating learning rate to 0.0002241373804436302
Epoch: 5 cost time: 2.556567430496216
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2816412 Best vali loss: 0.2803338
Updating learning rate to 0.00010634465727376295
Epoch: 6 cost time: 1.1088526248931885
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2837857 Best vali loss: 0.2803338
Updating learning rate to 2.7638075949315984e-05
Epoch: 7 cost time: 1.0643157958984375
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2830835 Best vali loss: 0.2803338
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9367239475250244
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2836073 Best vali loss: 0.2803338

best validation loss 0.28033379025067395

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.000863609928, 'e_layers': 4, 'learning_rate': 0.0020527463126, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5835319
	speed: 0.0227s/iter; left time: 92.6559s
	iters: 200, epoch: 1 | loss: 0.5842456
	speed: 0.0135s/iter; left time: 53.6847s
	iters: 300, epoch: 1 | loss: 0.3700250
	speed: 0.0097s/iter; left time: 37.5560s
	iters: 400, epoch: 1 | loss: 0.5395042
	speed: 0.0095s/iter; left time: 36.1371s
	iters: 500, epoch: 1 | loss: 1.0176798
	speed: 0.0099s/iter; left time: 36.3957s
Updating learning rate to 0.001974618308124578
Validation loss decreased (inf --> 0.3240).  Saving model state dict ...
Epoch: 1 cost time: 6.434134483337402
Epoch: 1, Steps: 523 | Train Loss: 0.6189973 Vali Loss: 0.3240204 Best vali loss: 0.3240204
	iters: 100, epoch: 2 | loss: 0.3230648
	speed: 0.0200s/iter; left time: 71.4086s
	iters: 200, epoch: 2 | loss: 0.3675663
	speed: 0.0087s/iter; left time: 30.1261s
	iters: 300, epoch: 2 | loss: 0.2264629
	speed: 0.0076s/iter; left time: 25.6295s
	iters: 400, epoch: 2 | loss: 0.5766313
	speed: 0.0110s/iter; left time: 35.7588s
	iters: 500, epoch: 2 | loss: 1.0344007
	speed: 0.0111s/iter; left time: 35.2420s
Updating learning rate to 0.0017521285751475701
Validation loss decreased (0.3240 --> 0.3212).  Saving model state dict ...
Epoch: 2 cost time: 5.06217360496521
Epoch: 2, Steps: 523 | Train Loss: 0.5056252 Vali Loss: 0.3212120 Best vali loss: 0.3212120
	iters: 100, epoch: 3 | loss: 0.3423719
	speed: 0.0213s/iter; left time: 64.6151s
	iters: 200, epoch: 3 | loss: 0.5566175
	speed: 0.0092s/iter; left time: 26.9802s
	iters: 300, epoch: 3 | loss: 0.2852668
	speed: 0.0097s/iter; left time: 27.6592s
	iters: 400, epoch: 3 | loss: 0.5034114
	speed: 0.0104s/iter; left time: 28.4390s
	iters: 500, epoch: 3 | loss: 0.7273299
	speed: 0.0093s/iter; left time: 24.6126s
Updating learning rate to 0.0014191491586402747
Epoch: 3 cost time: 5.206204175949097
Epoch: 3, Steps: 523 | Train Loss: 0.4829995 Vali Loss: 0.3225486 Best vali loss: 0.3212120

best validation loss 0.3212119756123088

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0018583733234, 'e_layers': 2, 'learning_rate': 0.0027139761097, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7063959
	speed: 0.0134s/iter; left time: 54.5968s
	iters: 200, epoch: 1 | loss: 0.2902198
	speed: 0.0054s/iter; left time: 21.6032s
	iters: 300, epoch: 1 | loss: 0.3329774
	speed: 0.0051s/iter; left time: 19.9770s
	iters: 400, epoch: 1 | loss: 0.7891433
	speed: 0.0067s/iter; left time: 25.2918s
	iters: 500, epoch: 1 | loss: 0.8857636
	speed: 0.0068s/iter; left time: 25.0968s
Updating learning rate to 0.0026106815445882184
Validation loss decreased (inf --> 0.3035).  Saving model state dict ...
Epoch: 1 cost time: 3.605329751968384
Epoch: 1, Steps: 523 | Train Loss: 0.6009000 Vali Loss: 0.3035112 Best vali loss: 0.3035112
	iters: 100, epoch: 2 | loss: 0.3972839
	speed: 0.0156s/iter; left time: 55.4917s
	iters: 200, epoch: 2 | loss: 0.7720911
	speed: 0.0060s/iter; left time: 20.6971s
	iters: 300, epoch: 2 | loss: 0.4844010
	speed: 0.0060s/iter; left time: 20.3114s
	iters: 400, epoch: 2 | loss: 0.2429543
	speed: 0.0060s/iter; left time: 19.4567s
	iters: 500, epoch: 2 | loss: 0.2757708
	speed: 0.0048s/iter; left time: 15.0291s
Updating learning rate to 0.0023165235104235776
Validation loss decreased (0.3035 --> 0.2987).  Saving model state dict ...
Epoch: 2 cost time: 3.0588529109954834
Epoch: 2, Steps: 523 | Train Loss: 0.4345002 Vali Loss: 0.2986562 Best vali loss: 0.2986562
	iters: 100, epoch: 3 | loss: 0.6072060
	speed: 0.0145s/iter; left time: 44.0274s
	iters: 200, epoch: 3 | loss: 0.5722451
	speed: 0.0080s/iter; left time: 23.6045s
	iters: 300, epoch: 3 | loss: 0.5858604
	speed: 0.0076s/iter; left time: 21.5044s
	iters: 400, epoch: 3 | loss: 1.1294712
	speed: 0.0090s/iter; left time: 24.7382s
	iters: 500, epoch: 3 | loss: 0.3834235
	speed: 0.0064s/iter; left time: 16.9391s
Updating learning rate to 0.0018762849013584247
Validation loss decreased (0.2987 --> 0.2915).  Saving model state dict ...
Epoch: 3 cost time: 4.039975166320801
Epoch: 3, Steps: 523 | Train Loss: 0.6556412 Vali Loss: 0.2915199 Best vali loss: 0.2915199

best validation loss 0.29151991547240164

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012371274314, 'e_layers': 1, 'learning_rate': 0.0002034425323, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5344614
	speed: 0.0236s/iter; left time: 22.3594s
Updating learning rate to 0.00019569946196711818
Validation loss decreased (inf --> 0.3188).  Saving model state dict ...
Epoch: 1 cost time: 2.5188679695129395
Epoch: 1, Steps: 131 | Train Loss: 0.5344614 Vali Loss: 0.3187847 Best vali loss: 0.3187847
	iters: 100, epoch: 2 | loss: 0.5151717
	speed: 0.0272s/iter; left time: 22.2514s
Updating learning rate to 0.0001736490632355466
Validation loss decreased (0.3188 --> 0.3005).  Saving model state dict ...
Epoch: 2 cost time: 2.180030107498169
Epoch: 2, Steps: 131 | Train Loss: 0.5151717 Vali Loss: 0.3004801 Best vali loss: 0.3004801
	iters: 100, epoch: 3 | loss: 0.4593382
	speed: 0.0282s/iter; left time: 19.4023s
Updating learning rate to 0.00014064830942480482
Validation loss decreased (0.3005 --> 0.2922).  Saving model state dict ...
Epoch: 3 cost time: 2.1130619049072266
Epoch: 3, Steps: 131 | Train Loss: 0.4593382 Vali Loss: 0.2921846 Best vali loss: 0.2921846

best validation loss 0.29218460977986294

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0018583733234, 'e_layers': 2, 'learning_rate': 0.0027139761097, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6469646
	speed: 0.0120s/iter; left time: 30.2829s
	iters: 200, epoch: 4 | loss: 0.2779315
	speed: 0.0064s/iter; left time: 15.4959s
	iters: 300, epoch: 4 | loss: 0.3467503
	speed: 0.0080s/iter; left time: 18.4582s
	iters: 400, epoch: 4 | loss: 0.7192331
	speed: 0.0071s/iter; left time: 15.7605s
	iters: 500, epoch: 4 | loss: 0.7573752
	speed: 0.0075s/iter; left time: 15.8511s
Updating learning rate to 0.00135698805485
Epoch: 4 cost time: 3.928238868713379
Epoch: 4, Steps: 523 | Train Loss: 0.5496509 Vali Loss: 0.2949210 Best vali loss: 0.2915199
	iters: 100, epoch: 5 | loss: 0.3909729
	speed: 0.0161s/iter; left time: 32.0721s
	iters: 200, epoch: 5 | loss: 0.7290323
	speed: 0.0073s/iter; left time: 13.8476s
	iters: 300, epoch: 5 | loss: 0.4534072
	speed: 0.0075s/iter; left time: 13.4405s
	iters: 400, epoch: 5 | loss: 0.2562143
	speed: 0.0059s/iter; left time: 10.0133s
	iters: 500, epoch: 5 | loss: 0.3108800
	speed: 0.0065s/iter; left time: 10.3918s
Updating learning rate to 0.0008376912083415753
Epoch: 5 cost time: 3.6884665489196777
Epoch: 5, Steps: 523 | Train Loss: 0.4281013 Vali Loss: 0.2921047 Best vali loss: 0.2915199
	iters: 100, epoch: 6 | loss: 0.5444618
	speed: 0.0156s/iter; left time: 22.8659s
	iters: 200, epoch: 6 | loss: 0.4167962
	speed: 0.0081s/iter; left time: 11.1567s
	iters: 300, epoch: 6 | loss: 0.5626057
	speed: 0.0078s/iter; left time: 9.8474s
	iters: 400, epoch: 6 | loss: 1.0020765
	speed: 0.0081s/iter; left time: 9.5185s
	iters: 500, epoch: 6 | loss: 0.3436106
	speed: 0.0084s/iter; left time: 8.9935s
Updating learning rate to 0.00039745259927642234
Epoch: 6 cost time: 4.14453387260437
Epoch: 6, Steps: 523 | Train Loss: 0.5739102 Vali Loss: 0.3237819 Best vali loss: 0.2915199
	iters: 100, epoch: 7 | loss: 0.3178498
	speed: 0.0187s/iter; left time: 17.6910s
	iters: 200, epoch: 7 | loss: 0.6357375
	speed: 0.0085s/iter; left time: 7.1666s
	iters: 300, epoch: 7 | loss: 0.2463804
	speed: 0.0081s/iter; left time: 6.0366s
	iters: 400, epoch: 7 | loss: 0.5871481
	speed: 0.0071s/iter; left time: 4.5845s
	iters: 500, epoch: 7 | loss: 0.9876636
	speed: 0.0062s/iter; left time: 3.4158s
Updating learning rate to 0.00010329456511178166
Epoch: 7 cost time: 4.041393518447876
Epoch: 7, Steps: 523 | Train Loss: 0.5549559 Vali Loss: 0.3200362 Best vali loss: 0.2915199
	iters: 100, epoch: 8 | loss: 0.4255006
	speed: 0.0148s/iter; left time: 6.2631s
	iters: 200, epoch: 8 | loss: 0.4248783
	speed: 0.0066s/iter; left time: 2.1436s
	iters: 300, epoch: 8 | loss: 0.3605904
	speed: 0.0066s/iter; left time: 1.4773s
	iters: 400, epoch: 8 | loss: 0.4824296
	speed: 0.0077s/iter; left time: 0.9584s
	iters: 500, epoch: 8 | loss: 0.5966026
	speed: 0.0077s/iter; left time: 0.1837s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.692781448364258
Epoch: 8, Steps: 523 | Train Loss: 0.4580003 Vali Loss: 0.3301667 Best vali loss: 0.2915199

best validation loss 0.29151991547240164

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0079470274746, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5515711
	speed: 0.0163s/iter; left time: 134.7333s
	iters: 200, epoch: 1 | loss: 0.4859821
	speed: 0.0089s/iter; left time: 72.3122s
	iters: 300, epoch: 1 | loss: 0.8628588
	speed: 0.0091s/iter; left time: 73.5063s
	iters: 400, epoch: 1 | loss: 0.4784163
	speed: 0.0092s/iter; left time: 73.2248s
	iters: 500, epoch: 1 | loss: 0.5965165
	speed: 0.0080s/iter; left time: 62.9403s
	iters: 600, epoch: 1 | loss: 0.3973269
	speed: 0.0073s/iter; left time: 56.3317s
	iters: 700, epoch: 1 | loss: 0.2573515
	speed: 0.0089s/iter; left time: 67.8548s
	iters: 800, epoch: 1 | loss: 0.7448589
	speed: 0.0095s/iter; left time: 71.6338s
	iters: 900, epoch: 1 | loss: 0.3599354
	speed: 0.0095s/iter; left time: 70.7886s
	iters: 1000, epoch: 1 | loss: 0.3027008
	speed: 0.0098s/iter; left time: 72.1548s
Updating learning rate to 0.0004578762234
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 9.731840133666992
Epoch: 1, Steps: 1045 | Train Loss: 0.5037518 Vali Loss: 0.2822923 Best vali loss: 0.2822923
	iters: 100, epoch: 2 | loss: 1.2244411
	speed: 0.0302s/iter; left time: 217.9343s
	iters: 200, epoch: 2 | loss: 0.1911462
	speed: 0.0094s/iter; left time: 67.1752s
	iters: 300, epoch: 2 | loss: 0.4646945
	speed: 0.0094s/iter; left time: 65.9502s
	iters: 400, epoch: 2 | loss: 0.3643543
	speed: 0.0083s/iter; left time: 57.1542s
	iters: 500, epoch: 2 | loss: 0.4426285
	speed: 0.0092s/iter; left time: 62.6680s
	iters: 600, epoch: 2 | loss: 0.4389142
	speed: 0.0094s/iter; left time: 63.2453s
	iters: 700, epoch: 2 | loss: 0.3045307
	speed: 0.0097s/iter; left time: 64.3790s
	iters: 800, epoch: 2 | loss: 1.2130113
	speed: 0.0081s/iter; left time: 52.8945s
	iters: 900, epoch: 2 | loss: 0.2711898
	speed: 0.0087s/iter; left time: 56.0378s
	iters: 1000, epoch: 2 | loss: 0.1338468
	speed: 0.0093s/iter; left time: 59.0001s
Updating learning rate to 0.0002289381117
Epoch: 2 cost time: 9.50621747970581
Epoch: 2, Steps: 1045 | Train Loss: 0.5048757 Vali Loss: 0.2864129 Best vali loss: 0.2822923
	iters: 100, epoch: 3 | loss: 0.2646373
	speed: 0.0304s/iter; left time: 187.8832s
	iters: 200, epoch: 3 | loss: 0.2411970
	speed: 0.0092s/iter; left time: 55.7188s
	iters: 300, epoch: 3 | loss: 0.6080184
	speed: 0.0090s/iter; left time: 53.8130s
	iters: 400, epoch: 3 | loss: 0.3163168
	speed: 0.0081s/iter; left time: 47.4026s
	iters: 500, epoch: 3 | loss: 0.7490094
	speed: 0.0078s/iter; left time: 45.1893s
	iters: 600, epoch: 3 | loss: 0.2603512
	speed: 0.0078s/iter; left time: 44.1810s
	iters: 700, epoch: 3 | loss: 0.6922083
	speed: 0.0078s/iter; left time: 43.4031s
	iters: 800, epoch: 3 | loss: 1.1685493
	speed: 0.0083s/iter; left time: 45.6335s
	iters: 900, epoch: 3 | loss: 0.2510562
	speed: 0.0103s/iter; left time: 55.0790s
	iters: 1000, epoch: 3 | loss: 0.7235845
	speed: 0.0086s/iter; left time: 45.4246s
Updating learning rate to 0.00011446905585
Epoch: 3 cost time: 9.13611626625061
Epoch: 3, Steps: 1045 | Train Loss: 0.5274928 Vali Loss: 0.2948110 Best vali loss: 0.2822923
	iters: 100, epoch: 4 | loss: 0.1252715
	speed: 0.0323s/iter; left time: 165.4730s
	iters: 200, epoch: 4 | loss: 0.5692924
	speed: 0.0121s/iter; left time: 60.8520s
	iters: 300, epoch: 4 | loss: 0.3562003
	speed: 0.0132s/iter; left time: 65.2616s
	iters: 400, epoch: 4 | loss: 0.9385954
	speed: 0.0102s/iter; left time: 49.1326s
	iters: 500, epoch: 4 | loss: 0.3983625
	speed: 0.0129s/iter; left time: 61.1986s
	iters: 600, epoch: 4 | loss: 0.1572905
	speed: 0.0134s/iter; left time: 61.8842s
	iters: 700, epoch: 4 | loss: 0.8302860
	speed: 0.0130s/iter; left time: 58.8574s
	iters: 800, epoch: 4 | loss: 0.4113006
	speed: 0.0080s/iter; left time: 35.6110s
	iters: 900, epoch: 4 | loss: 0.5126601
	speed: 0.0077s/iter; left time: 33.4263s
	iters: 1000, epoch: 4 | loss: 0.2544638
	speed: 0.0058s/iter; left time: 24.7142s
Updating learning rate to 5.7234527925e-05
Epoch: 4 cost time: 10.746185302734375
Epoch: 4, Steps: 1045 | Train Loss: 0.4553723 Vali Loss: 0.2908223 Best vali loss: 0.2822923
	iters: 100, epoch: 5 | loss: 0.5725867
	speed: 0.0190s/iter; left time: 77.4420s
	iters: 200, epoch: 5 | loss: 0.3446582
	speed: 0.0060s/iter; left time: 23.8236s
	iters: 300, epoch: 5 | loss: 0.3864539
	speed: 0.0070s/iter; left time: 27.2487s
	iters: 400, epoch: 5 | loss: 0.4300210
	speed: 0.0061s/iter; left time: 23.2057s
	iters: 500, epoch: 5 | loss: 0.1935698
	speed: 0.0057s/iter; left time: 21.1409s
	iters: 600, epoch: 5 | loss: 0.2756808
	speed: 0.0066s/iter; left time: 23.6845s
	iters: 700, epoch: 5 | loss: 1.2020144
	speed: 0.0067s/iter; left time: 23.1687s
	iters: 800, epoch: 5 | loss: 0.2541377
	speed: 0.0081s/iter; left time: 27.4359s
	iters: 900, epoch: 5 | loss: 0.5900120
	speed: 0.0120s/iter; left time: 39.2407s
	iters: 1000, epoch: 5 | loss: 0.3663852
	speed: 0.0092s/iter; left time: 29.2740s
Updating learning rate to 2.86172639625e-05
Epoch: 5 cost time: 7.877692699432373
Epoch: 5, Steps: 1045 | Train Loss: 0.4615520 Vali Loss: 0.2970860 Best vali loss: 0.2822923
	iters: 100, epoch: 6 | loss: 0.3710068
	speed: 0.0287s/iter; left time: 87.1750s
	iters: 200, epoch: 6 | loss: 0.2866820
	speed: 0.0101s/iter; left time: 29.6875s
	iters: 300, epoch: 6 | loss: 0.2727626
	speed: 0.0060s/iter; left time: 16.8898s
	iters: 400, epoch: 6 | loss: 0.4366883
	speed: 0.0076s/iter; left time: 20.7467s
	iters: 500, epoch: 6 | loss: 0.3628154
	speed: 0.0110s/iter; left time: 29.1212s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015261373829, 'e_layers': 4, 'learning_rate': 0.0039093714977, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4524358
	speed: 0.0203s/iter; left time: 40.5381s
	iters: 200, epoch: 1 | loss: 0.3417867
	speed: 0.0142s/iter; left time: 26.8709s
Updating learning rate to 0.0037605799047040127
Validation loss decreased (inf --> 0.2998).  Saving model state dict ...
Epoch: 1 cost time: 3.9173362255096436
Epoch: 1, Steps: 262 | Train Loss: 0.3971112 Vali Loss: 0.2998334 Best vali loss: 0.2998334
	iters: 100, epoch: 2 | loss: 0.9186961
	speed: 0.0237s/iter; left time: 41.1507s
	iters: 200, epoch: 2 | loss: 0.4677766
	speed: 0.0111s/iter; left time: 18.1520s
Updating learning rate to 0.0033368572969505396
Validation loss decreased (0.2998 --> 0.2881).  Saving model state dict ...
Epoch: 2 cost time: 2.67958664894104
Epoch: 2, Steps: 262 | Train Loss: 0.6932364 Vali Loss: 0.2880920 Best vali loss: 0.2880920
	iters: 100, epoch: 3 | loss: 0.7980374
	speed: 0.0283s/iter; left time: 41.7232s
	iters: 200, epoch: 3 | loss: 0.4373443
	speed: 0.0118s/iter; left time: 16.1331s
Updating learning rate to 0.002702711600415044
Validation loss decreased (0.2881 --> 0.2879).  Saving model state dict ...
Epoch: 3 cost time: 3.232187509536743
Epoch: 3, Steps: 262 | Train Loss: 0.6176909 Vali Loss: 0.2878943 Best vali loss: 0.2878943
	iters: 100, epoch: 4 | loss: 0.2783493
	speed: 0.0274s/iter; left time: 33.1479s
	iters: 200, epoch: 4 | loss: 0.4266014
	speed: 0.0116s/iter; left time: 12.9417s
Updating learning rate to 0.00195468574885
Validation loss decreased (0.2879 --> 0.2820).  Saving model state dict ...
Epoch: 4 cost time: 2.8223931789398193
Epoch: 4, Steps: 262 | Train Loss: 0.3524753 Vali Loss: 0.2819961 Best vali loss: 0.2819961
	iters: 100, epoch: 5 | loss: 0.4883753
	speed: 0.0272s/iter; left time: 25.7813s
	iters: 200, epoch: 5 | loss: 0.6944034
	speed: 0.0119s/iter; left time: 10.1131s
Updating learning rate to 0.0012066598972849563
Epoch: 5 cost time: 2.9251492023468018
Epoch: 5, Steps: 262 | Train Loss: 0.5913893 Vali Loss: 0.2897585 Best vali loss: 0.2819961
	iters: 100, epoch: 6 | loss: 0.3737041
	speed: 0.0327s/iter; left time: 22.4484s
	iters: 200, epoch: 6 | loss: 0.5923339
	speed: 0.0120s/iter; left time: 7.0686s
Updating learning rate to 0.0005725142007494604
Epoch: 6 cost time: 3.174633026123047
Epoch: 6, Steps: 262 | Train Loss: 0.4830190 Vali Loss: 0.2896061 Best vali loss: 0.2819961
	iters: 100, epoch: 7 | loss: 0.3419256
	speed: 0.0341s/iter; left time: 14.4963s
	iters: 200, epoch: 7 | loss: 0.6920691
	speed: 0.0128s/iter; left time: 4.1746s
Updating learning rate to 0.00014879159299598758
Epoch: 7 cost time: 3.288923740386963
Epoch: 7, Steps: 262 | Train Loss: 0.5169973 Vali Loss: 0.2935170 Best vali loss: 0.2819961
	iters: 100, epoch: 8 | loss: 0.6181388
	speed: 0.0299s/iter; left time: 4.8667s
	iters: 200, epoch: 8 | loss: 0.2905473
	speed: 0.0117s/iter; left time: 0.7393s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2535557746887207
Epoch: 8, Steps: 262 | Train Loss: 0.4543431 Vali Loss: 0.2956671 Best vali loss: 0.2819961

best validation loss 0.28199605060226635

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5916030
	speed: 0.0167s/iter; left time: 33.2889s
	iters: 200, epoch: 1 | loss: 0.5429766
	speed: 0.0122s/iter; left time: 23.2307s
Updating learning rate to 8.666273256609723e-05
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 3.332223415374756
Epoch: 1, Steps: 262 | Train Loss: 0.5672898 Vali Loss: 0.2873823 Best vali loss: 0.2873823
	iters: 100, epoch: 2 | loss: 0.3824045
	speed: 0.0312s/iter; left time: 54.1243s
	iters: 200, epoch: 2 | loss: 0.9002246
	speed: 0.0127s/iter; left time: 20.7104s
Updating learning rate to 7.689802606643869e-05
Validation loss decreased (0.2874 --> 0.2816).  Saving model state dict ...
Epoch: 2 cost time: 3.394075870513916
Epoch: 2, Steps: 262 | Train Loss: 0.6413146 Vali Loss: 0.2816300 Best vali loss: 0.2816300
	iters: 100, epoch: 3 | loss: 0.6209943
	speed: 0.0323s/iter; left time: 47.6013s
	iters: 200, epoch: 3 | loss: 0.4019143
	speed: 0.0111s/iter; left time: 15.2232s
Updating learning rate to 6.228411004831259e-05
Validation loss decreased (0.2816 --> 0.2796).  Saving model state dict ...
Epoch: 3 cost time: 3.090712308883667
Epoch: 3, Steps: 262 | Train Loss: 0.5114543 Vali Loss: 0.2796410 Best vali loss: 0.2796410

best validation loss 0.2796410447039893

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0066838404905, 'e_layers': 4, 'learning_rate': 0.0002340429054, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7188656
	speed: 0.0413s/iter; left time: 39.2237s
Updating learning rate to 0.00022513517771426765
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 4.7738165855407715
Epoch: 1, Steps: 131 | Train Loss: 0.7188656 Vali Loss: 0.2822611 Best vali loss: 0.2822611
	iters: 100, epoch: 2 | loss: 0.6631294
	speed: 0.0561s/iter; left time: 45.8549s
Updating learning rate to 0.0001997681154484708
Validation loss decreased (0.2823 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 3.7831180095672607
Epoch: 2, Steps: 131 | Train Loss: 0.6631294 Vali Loss: 0.2810084 Best vali loss: 0.2810084
	iters: 100, epoch: 3 | loss: 0.3133417
	speed: 0.0468s/iter; left time: 32.1549s
Updating learning rate to 0.000161803623879585
Validation loss decreased (0.2810 --> 0.2808).  Saving model state dict ...
Epoch: 3 cost time: 4.434036731719971
Epoch: 3, Steps: 131 | Train Loss: 0.3133417 Vali Loss: 0.2808196 Best vali loss: 0.2808196

best validation loss 0.2808196105758423

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0054289535492, 'e_layers': 2, 'learning_rate': 0.000351769056, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003383806435046083
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 2.6864988803863525
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2869006 Best vali loss: 0.2869006
Updating learning rate to 0.00030025367045459516
Validation loss decreased (0.2869 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 2.203984260559082
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2837369 Best vali loss: 0.2837369
Updating learning rate to 0.00024319262287495375
Validation loss decreased (0.2837 --> 0.2826).  Saving model state dict ...
Epoch: 3 cost time: 2.761439800262451
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2825501 Best vali loss: 0.2825501

best validation loss 0.2825501457316674

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4579054
	speed: 0.0188s/iter; left time: 22.7400s
	iters: 200, epoch: 4 | loss: 0.4855635
	speed: 0.0149s/iter; left time: 16.5797s
Updating learning rate to 4.504582075e-05
Validation loss decreased (0.2796 --> 0.2787).  Saving model state dict ...
Epoch: 4 cost time: 3.872208833694458
Epoch: 4, Steps: 262 | Train Loss: 0.4717345 Vali Loss: 0.2786786 Best vali loss: 0.2786786
	iters: 100, epoch: 5 | loss: 0.3684373
	speed: 0.0499s/iter; left time: 47.3997s
	iters: 200, epoch: 5 | loss: 0.8359082
	speed: 0.0148s/iter; left time: 12.5600s
Updating learning rate to 2.780753145168742e-05
Epoch: 5 cost time: 4.0410661697387695
Epoch: 5, Steps: 262 | Train Loss: 0.6021727 Vali Loss: 0.2798461 Best vali loss: 0.2786786
	iters: 100, epoch: 6 | loss: 0.5376793
	speed: 0.0405s/iter; left time: 27.8290s
	iters: 200, epoch: 6 | loss: 0.3707732
	speed: 0.0149s/iter; left time: 8.7518s
Updating learning rate to 1.3193615433561312e-05
Epoch: 6 cost time: 3.834502696990967
Epoch: 6, Steps: 262 | Train Loss: 0.4542262 Vali Loss: 0.2794042 Best vali loss: 0.2786786
	iters: 100, epoch: 7 | loss: 0.6005284
	speed: 0.0523s/iter; left time: 22.2394s
	iters: 200, epoch: 7 | loss: 0.5751258
	speed: 0.0159s/iter; left time: 5.1692s
Updating learning rate to 3.4289089339027804e-06
Epoch: 7 cost time: 4.469229459762573
Epoch: 7, Steps: 262 | Train Loss: 0.5878271 Vali Loss: 0.2797929 Best vali loss: 0.2786786
	iters: 100, epoch: 8 | loss: 0.5737897
	speed: 0.0435s/iter; left time: 7.0873s
	iters: 200, epoch: 8 | loss: 0.4880466
	speed: 0.0151s/iter; left time: 0.9499s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5617682933807373
Epoch: 8, Steps: 262 | Train Loss: 0.5309182 Vali Loss: 0.2800693 Best vali loss: 0.2786786

best validation loss 0.2786786323555254

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0035567750222, 'e_layers': 4, 'learning_rate': 7.84460066e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4251891
	speed: 0.0156s/iter; left time: 63.6060s
	iters: 200, epoch: 1 | loss: 0.3803533
	speed: 0.0063s/iter; left time: 24.9391s
	iters: 300, epoch: 1 | loss: 0.2694768
	speed: 0.0071s/iter; left time: 27.6353s
	iters: 400, epoch: 1 | loss: 0.3027705
	speed: 0.0089s/iter; left time: 33.5346s
	iters: 500, epoch: 1 | loss: 1.0948757
	speed: 0.0091s/iter; left time: 33.6118s
Updating learning rate to 7.546033325249264e-05
Validation loss decreased (inf --> 0.3084).  Saving model state dict ...
Epoch: 1 cost time: 4.535897493362427
Epoch: 1, Steps: 523 | Train Loss: 0.4945331 Vali Loss: 0.3084126 Best vali loss: 0.3084126
	iters: 100, epoch: 2 | loss: 0.8095013
	speed: 0.0182s/iter; left time: 64.8716s
	iters: 200, epoch: 2 | loss: 0.5141287
	speed: 0.0080s/iter; left time: 27.7808s
	iters: 300, epoch: 2 | loss: 0.4621058
	speed: 0.0088s/iter; left time: 29.6598s
	iters: 400, epoch: 2 | loss: 0.2102397
	speed: 0.0092s/iter; left time: 30.0527s
	iters: 500, epoch: 2 | loss: 0.2651621
	speed: 0.0080s/iter; left time: 25.1895s
Updating learning rate to 6.695785491193232e-05
Validation loss decreased (0.3084 --> 0.2942).  Saving model state dict ...
Epoch: 2 cost time: 4.514590501785278
Epoch: 2, Steps: 523 | Train Loss: 0.4522275 Vali Loss: 0.2941745 Best vali loss: 0.2941745
	iters: 100, epoch: 3 | loss: 0.6735749
	speed: 0.0209s/iter; left time: 63.5466s
	iters: 200, epoch: 3 | loss: 0.2417024
	speed: 0.0105s/iter; left time: 30.8036s
	iters: 300, epoch: 3 | loss: 0.5955949
	speed: 0.0099s/iter; left time: 27.9658s
	iters: 400, epoch: 3 | loss: 1.1900711
	speed: 0.0104s/iter; left time: 28.6040s
	iters: 500, epoch: 3 | loss: 0.7571813
	speed: 0.0103s/iter; left time: 27.1788s
Updating learning rate to 5.423299683051124e-05
Validation loss decreased (0.2942 --> 0.2886).  Saving model state dict ...
Epoch: 3 cost time: 5.448625087738037
Epoch: 3, Steps: 523 | Train Loss: 0.6916249 Vali Loss: 0.2885936 Best vali loss: 0.2885936
	iters: 100, epoch: 4 | loss: 0.4263724
	speed: 0.0207s/iter; left time: 52.1163s
	iters: 200, epoch: 4 | loss: 0.8186480
	speed: 0.0102s/iter; left time: 24.6118s
	iters: 300, epoch: 4 | loss: 0.8619478
	speed: 0.0092s/iter; left time: 21.3837s
	iters: 400, epoch: 4 | loss: 0.5842947
	speed: 0.0095s/iter; left time: 21.1515s
	iters: 500, epoch: 4 | loss: 0.4728791
	speed: 0.0088s/iter; left time: 18.5332s
Updating learning rate to 3.92230033e-05
Validation loss decreased (0.2886 --> 0.2853).  Saving model state dict ...
Epoch: 4 cost time: 5.060154676437378
Epoch: 4, Steps: 523 | Train Loss: 0.6328284 Vali Loss: 0.2852870 Best vali loss: 0.2852870
	iters: 100, epoch: 5 | loss: 0.3088595
	speed: 0.0168s/iter; left time: 33.5137s
	iters: 200, epoch: 5 | loss: 0.5898321
	speed: 0.0109s/iter; left time: 20.6647s
	iters: 300, epoch: 5 | loss: 1.2682607
	speed: 0.0107s/iter; left time: 19.2039s
	iters: 400, epoch: 5 | loss: 0.4870218
	speed: 0.0097s/iter; left time: 16.5055s
	iters: 500, epoch: 5 | loss: 1.0076662
	speed: 0.0112s/iter; left time: 17.8263s
Updating learning rate to 2.4213009769488756e-05
Validation loss decreased (0.2853 --> 0.2843).  Saving model state dict ...
Epoch: 5 cost time: 5.3627769947052
Epoch: 5, Steps: 523 | Train Loss: 0.7323281 Vali Loss: 0.2843102 Best vali loss: 0.2843102
	iters: 100, epoch: 6 | loss: 0.6645801
	speed: 0.0199s/iter; left time: 29.2500s
	iters: 200, epoch: 6 | loss: 0.4381965
	speed: 0.0101s/iter; left time: 13.7835s
	iters: 300, epoch: 6 | loss: 0.3030344
	speed: 0.0085s/iter; left time: 10.8020s
	iters: 400, epoch: 6 | loss: 0.3547558
	speed: 0.0090s/iter; left time: 10.5716s
	iters: 500, epoch: 6 | loss: 0.3971637
	speed: 0.0110s/iter; left time: 11.8000s
Updating learning rate to 1.148815168806767e-05
Epoch: 6 cost time: 5.079798460006714
Epoch: 6, Steps: 523 | Train Loss: 0.4315461 Vali Loss: 0.2844976 Best vali loss: 0.2843102
	iters: 100, epoch: 7 | loss: 0.4009340
	speed: 0.0244s/iter; left time: 23.1465s
	iters: 200, epoch: 7 | loss: 0.3990542
	speed: 0.0092s/iter; left time: 7.7629s
	iters: 300, epoch: 7 | loss: 0.4685476
	speed: 0.0128s/iter; left time: 9.5316s
	iters: 400, epoch: 7 | loss: 0.5005321
	speed: 0.0098s/iter; left time: 6.3697s
	iters: 500, epoch: 7 | loss: 0.3206207
	speed: 0.0069s/iter; left time: 3.7744s
Updating learning rate to 2.9856733475073427e-06
Validation loss decreased (0.2843 --> 0.2840).  Saving model state dict ...
Epoch: 7 cost time: 5.340151786804199
Epoch: 7, Steps: 523 | Train Loss: 0.4179377 Vali Loss: 0.2839978 Best vali loss: 0.2839978
	iters: 100, epoch: 8 | loss: 0.7264278
	speed: 0.0217s/iter; left time: 9.2018s
	iters: 200, epoch: 8 | loss: 0.3053968
	speed: 0.0100s/iter; left time: 3.2533s
	iters: 300, epoch: 8 | loss: 0.4261980
	speed: 0.0120s/iter; left time: 2.6813s
	iters: 400, epoch: 8 | loss: 0.3249401
	speed: 0.0090s/iter; left time: 1.1165s
	iters: 500, epoch: 8 | loss: 0.6163904
	speed: 0.0096s/iter; left time: 0.2302s
Updating learning rate to 0.0
Validation loss decreased (0.2840 --> 0.2840).  Saving model state dict ...
Epoch: 8 cost time: 5.381602764129639
Epoch: 8, Steps: 523 | Train Loss: 0.4798706 Vali Loss: 0.2839528 Best vali loss: 0.2839528

best validation loss 0.2839528429503776

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018731932133, 'e_layers': 3, 'learning_rate': 0.0002731010083, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3919564
	speed: 0.0159s/iter; left time: 131.7332s
	iters: 200, epoch: 1 | loss: 0.3694111
	speed: 0.0083s/iter; left time: 67.7109s
	iters: 300, epoch: 1 | loss: 0.4974020
	speed: 0.0090s/iter; left time: 72.8059s
	iters: 400, epoch: 1 | loss: 0.3255952
	speed: 0.0087s/iter; left time: 69.1991s
	iters: 500, epoch: 1 | loss: 1.0926843
	speed: 0.0087s/iter; left time: 68.3505s
	iters: 600, epoch: 1 | loss: 0.2177311
	speed: 0.0071s/iter; left time: 54.7184s
	iters: 700, epoch: 1 | loss: 1.0219598
	speed: 0.0065s/iter; left time: 49.6873s
	iters: 800, epoch: 1 | loss: 0.6828091
	speed: 0.0087s/iter; left time: 66.1546s
	iters: 900, epoch: 1 | loss: 1.1112415
	speed: 0.0086s/iter; left time: 63.8803s
	iters: 1000, epoch: 1 | loss: 0.5017784
	speed: 0.0087s/iter; left time: 63.8848s
Updating learning rate to 0.00026270672008828254
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 9.033094644546509
Epoch: 1, Steps: 1045 | Train Loss: 0.6212569 Vali Loss: 0.2850043 Best vali loss: 0.2850043
	iters: 100, epoch: 2 | loss: 0.4257741
	speed: 0.0295s/iter; left time: 213.2282s
	iters: 200, epoch: 2 | loss: 0.2847207
	speed: 0.0102s/iter; left time: 72.5409s
	iters: 300, epoch: 2 | loss: 0.3182982
	speed: 0.0105s/iter; left time: 73.8982s
	iters: 400, epoch: 2 | loss: 0.2473196
	speed: 0.0110s/iter; left time: 76.0091s
	iters: 500, epoch: 2 | loss: 1.5457611
	speed: 0.0108s/iter; left time: 73.8155s
	iters: 600, epoch: 2 | loss: 1.0980424
	speed: 0.0106s/iter; left time: 71.0671s
	iters: 700, epoch: 2 | loss: 0.3141644
	speed: 0.0092s/iter; left time: 61.1217s
	iters: 800, epoch: 2 | loss: 0.2834865
	speed: 0.0107s/iter; left time: 69.7742s
	iters: 900, epoch: 2 | loss: 0.3093083
	speed: 0.0106s/iter; left time: 68.2632s
	iters: 1000, epoch: 2 | loss: 0.4570392
	speed: 0.0091s/iter; left time: 57.2388s
Updating learning rate to 0.0002331062916089068
Validation loss decreased (0.2850 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 10.675050258636475
Epoch: 2, Steps: 1045 | Train Loss: 0.5283915 Vali Loss: 0.2843437 Best vali loss: 0.2843437
	iters: 100, epoch: 3 | loss: 1.3652595
	speed: 0.0331s/iter; left time: 204.1213s
	iters: 200, epoch: 3 | loss: 0.6143965
	speed: 0.0107s/iter; left time: 64.7611s
	iters: 300, epoch: 3 | loss: 0.4854251
	speed: 0.0107s/iter; left time: 63.9963s
	iters: 400, epoch: 3 | loss: 1.7762488
	speed: 0.0109s/iter; left time: 64.1346s
	iters: 500, epoch: 3 | loss: 0.7417384
	speed: 0.0106s/iter; left time: 61.0826s
	iters: 600, epoch: 3 | loss: 0.3010993
	speed: 0.0101s/iter; left time: 57.0175s
	iters: 700, epoch: 3 | loss: 0.4073035
	speed: 0.0099s/iter; left time: 55.0792s
	iters: 800, epoch: 3 | loss: 1.1601719
	speed: 0.0106s/iter; left time: 57.9758s
	iters: 900, epoch: 3 | loss: 0.1495977
	speed: 0.0097s/iter; left time: 51.8748s
	iters: 1000, epoch: 3 | loss: 0.5274072
	speed: 0.0093s/iter; left time: 48.7600s
Updating learning rate to 0.00018880611976930544
Validation loss decreased (0.2843 --> 0.2814).  Saving model state dict ...
Epoch: 3 cost time: 10.7576265335083
Epoch: 3, Steps: 1045 | Train Loss: 0.7528648 Vali Loss: 0.2814231 Best vali loss: 0.2814231
	iters: 100, epoch: 4 | loss: 0.6814324
	speed: 0.0358s/iter; left time: 183.3774s
	iters: 200, epoch: 4 | loss: 0.3899840
	speed: 0.0096s/iter; left time: 48.2033s
	iters: 300, epoch: 4 | loss: 0.2672730
	speed: 0.0093s/iter; left time: 45.6840s
	iters: 400, epoch: 4 | loss: 0.6682786
	speed: 0.0101s/iter; left time: 48.7245s
	iters: 500, epoch: 4 | loss: 0.7111180
	speed: 0.0106s/iter; left time: 50.0122s
	iters: 600, epoch: 4 | loss: 0.2891898
	speed: 0.0108s/iter; left time: 50.1107s
	iters: 700, epoch: 4 | loss: 0.2864380
	speed: 0.0102s/iter; left time: 46.1298s
	iters: 800, epoch: 4 | loss: 0.2241368
	speed: 0.0085s/iter; left time: 37.5492s
	iters: 900, epoch: 4 | loss: 0.3134258
	speed: 0.0067s/iter; left time: 28.9661s
	iters: 1000, epoch: 4 | loss: 0.3411448
	speed: 0.0068s/iter; left time: 28.8030s
Updating learning rate to 0.00013655050415
Epoch: 4 cost time: 9.577164888381958
Epoch: 4, Steps: 1045 | Train Loss: 0.4172421 Vali Loss: 0.2929777 Best vali loss: 0.2814231
	iters: 100, epoch: 5 | loss: 0.3178311
	speed: 0.0216s/iter; left time: 88.0002s
	iters: 200, epoch: 5 | loss: 0.4567431
	speed: 0.0066s/iter; left time: 26.2197s
	iters: 300, epoch: 5 | loss: 0.2902577
	speed: 0.0063s/iter; left time: 24.2820s
	iters: 400, epoch: 5 | loss: 0.2267116
	speed: 0.0069s/iter; left time: 26.0129s
	iters: 500, epoch: 5 | loss: 1.5805216
	speed: 0.0079s/iter; left time: 29.1654s
	iters: 600, epoch: 5 | loss: 0.2491385
	speed: 0.0067s/iter; left time: 24.1193s
	iters: 700, epoch: 5 | loss: 1.7422352
	speed: 0.0079s/iter; left time: 27.4188s
	iters: 800, epoch: 5 | loss: 0.9762973
	speed: 0.0077s/iter; left time: 26.1740s
	iters: 900, epoch: 5 | loss: 0.3171963
	speed: 0.0092s/iter; left time: 30.1374s
	iters: 1000, epoch: 5 | loss: 0.5714521
	speed: 0.0100s/iter; left time: 31.8562s
Updating learning rate to 8.429488853069457e-05
Epoch: 5 cost time: 8.187889337539673
Epoch: 5, Steps: 1045 | Train Loss: 0.6728385 Vali Loss: 0.3058804 Best vali loss: 0.2814231
	iters: 100, epoch: 6 | loss: 0.2521616
	speed: 0.0260s/iter; left time: 78.9087s
	iters: 200, epoch: 6 | loss: 0.2208651
	speed: 0.0080s/iter; left time: 23.4480s
	iters: 300, epoch: 6 | loss: 1.2769942
	speed: 0.0081s/iter; left time: 23.0716s
	iters: 400, epoch: 6 | loss: 0.2156682
	speed: 0.0093s/iter; left time: 25.4945s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0069305282566, 'e_layers': 3, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.2922).  Saving model state dict ...
Epoch: 1 cost time: 1.3672680854797363
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2922147 Best vali loss: 0.2922147
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.2922 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 1.5747010707855225
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2819376 Best vali loss: 0.2819376
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.2819 --> 0.2803).  Saving model state dict ...
Epoch: 3 cost time: 1.400834083557129
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2802830 Best vali loss: 0.2802830

best validation loss 0.2802830032364238

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0050554635831, 'e_layers': 4, 'learning_rate': 0.0005490826136, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005281844009814218
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 1.4699375629425049
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2835765 Best vali loss: 0.2835765
Updating learning rate to 0.0004686713265540964
Epoch: 2 cost time: 1.5784671306610107
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2873127 Best vali loss: 0.2835765
Updating learning rate to 0.0003796037164122212
Epoch: 3 cost time: 1.2124886512756348
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3056341 Best vali loss: 0.2835765

best validation loss 0.2835765413388571

[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042120649381, 'e_layers': 1, 'learning_rate': 0.0036397684012, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003501237965075005
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 1.947052001953125
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2863987 Best vali loss: 0.2863987
Updating learning rate to 0.003106736659818519
Epoch: 2 cost time: 1.178365707397461
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2899201 Best vali loss: 0.2863987
Updating learning rate to 0.002516323732992606
Epoch: 3 cost time: 1.1751892566680908
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2988269 Best vali loss: 0.2863987

best validation loss 0.28639874821504546

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0069305282566, 'e_layers': 3, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.2803 --> 0.2789).  Saving model state dict ...
Epoch: 4 cost time: 2.5165419578552246
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2789285 Best vali loss: 0.2789285
Updating learning rate to 2.2430860606471416e-05
Epoch: 5 cost time: 1.6434364318847656
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2790347 Best vali loss: 0.2789285
Updating learning rate to 1.0642589731482448e-05
Epoch: 6 cost time: 1.1396245956420898
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2791497 Best vali loss: 0.2789285
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.2789 --> 0.2789).  Saving model state dict ...
Epoch: 7 cost time: 0.9879283905029297
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2788886 Best vali loss: 0.2788886
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1406614780426025
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2789314 Best vali loss: 0.2788886

best validation loss 0.27888855878949476

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015476159007, 'e_layers': 2, 'learning_rate': 0.0012055800526, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7096825
	speed: 0.0190s/iter; left time: 37.9149s
	iters: 200, epoch: 1 | loss: 0.7865185
	speed: 0.0132s/iter; left time: 25.0341s
Updating learning rate to 0.0012055800526
Validation loss decreased (inf --> 0.2890).  Saving model state dict ...
Epoch: 1 cost time: 3.698584794998169
Epoch: 1, Steps: 262 | Train Loss: 0.7481005 Vali Loss: 0.2889705 Best vali loss: 0.2889705
	iters: 100, epoch: 2 | loss: 0.2962369
	speed: 0.0513s/iter; left time: 88.9653s
	iters: 200, epoch: 2 | loss: 0.4546139
	speed: 0.0133s/iter; left time: 21.7077s
Updating learning rate to 0.0006027900263
Epoch: 2 cost time: 3.784013509750366
Epoch: 2, Steps: 262 | Train Loss: 0.3754254 Vali Loss: 0.2904383 Best vali loss: 0.2889705
	iters: 100, epoch: 3 | loss: 0.3183231
	speed: 0.0361s/iter; left time: 53.1357s
	iters: 200, epoch: 3 | loss: 0.7384999
	speed: 0.0092s/iter; left time: 12.6028s
Updating learning rate to 0.00030139501315
Validation loss decreased (0.2890 --> 0.2880).  Saving model state dict ...
Epoch: 3 cost time: 2.5363574028015137
Epoch: 3, Steps: 262 | Train Loss: 0.5284115 Vali Loss: 0.2880495 Best vali loss: 0.2880495
	iters: 100, epoch: 4 | loss: 0.5424570
	speed: 0.0261s/iter; left time: 31.5560s
	iters: 200, epoch: 4 | loss: 0.2641268
	speed: 0.0102s/iter; left time: 11.3590s
Updating learning rate to 0.000150697506575
Epoch: 4 cost time: 2.692443370819092
Epoch: 4, Steps: 262 | Train Loss: 0.4032919 Vali Loss: 0.2895718 Best vali loss: 0.2880495
	iters: 100, epoch: 5 | loss: 0.4722040
	speed: 0.0436s/iter; left time: 41.4140s
	iters: 200, epoch: 5 | loss: 0.8248433
	speed: 0.0126s/iter; left time: 10.6793s
Updating learning rate to 7.53487532875e-05
Epoch: 5 cost time: 3.422283172607422
Epoch: 5, Steps: 262 | Train Loss: 0.6485237 Vali Loss: 0.2893599 Best vali loss: 0.2880495
	iters: 100, epoch: 6 | loss: 0.5672992
	speed: 0.0471s/iter; left time: 32.3475s
	iters: 200, epoch: 6 | loss: 0.3651349
	speed: 0.0129s/iter; left time: 7.5447s
Updating learning rate to 3.767437664375e-05
Epoch: 6 cost time: 3.640087604522705
Epoch: 6, Steps: 262 | Train Loss: 0.4662170 Vali Loss: 0.2901394 Best vali loss: 0.2880495
	iters: 100, epoch: 7 | loss: 0.2850579
	speed: 0.0473s/iter; left time: 20.1159s
	iters: 200, epoch: 7 | loss: 0.4501357
	speed: 0.0123s/iter; left time: 3.9977s
Updating learning rate to 1.8837188321875e-05
Epoch: 7 cost time: 3.4180283546447754
Epoch: 7, Steps: 262 | Train Loss: 0.3675968 Vali Loss: 0.2922123 Best vali loss: 0.2880495
	iters: 100, epoch: 8 | loss: 0.5185707
	speed: 0.0529s/iter; left time: 8.6178s
	iters: 200, epoch: 8 | loss: 0.3868429
	speed: 0.0103s/iter; left time: 0.6503s
Updating learning rate to 9.4185941609375e-06
Epoch: 8 cost time: 2.852052927017212
Epoch: 8, Steps: 262 | Train Loss: 0.4527068 Vali Loss: 0.2917393 Best vali loss: 0.2880495

best validation loss 0.28804952366150816

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0038575717856, 'e_layers': 1, 'learning_rate': 0.0003056122351, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4753957
	speed: 0.0137s/iter; left time: 13.0218s
Updating learning rate to 0.0003056122351
Validation loss decreased (inf --> 0.2915).  Saving model state dict ...
Epoch: 1 cost time: 1.2781167030334473
Epoch: 1, Steps: 131 | Train Loss: 0.4753957 Vali Loss: 0.2914687 Best vali loss: 0.2914687
	iters: 100, epoch: 2 | loss: 0.3571038
	speed: 0.0270s/iter; left time: 22.1080s
Updating learning rate to 0.00015280611755
Validation loss decreased (0.2915 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 1.904799461364746
Epoch: 2, Steps: 131 | Train Loss: 0.3571038 Vali Loss: 0.2819241 Best vali loss: 0.2819241
	iters: 100, epoch: 3 | loss: 0.5727550
	speed: 0.0137s/iter; left time: 9.4332s
Updating learning rate to 7.6403058775e-05
Validation loss decreased (0.2819 --> 0.2807).  Saving model state dict ...
Epoch: 3 cost time: 1.369049310684204
Epoch: 3, Steps: 131 | Train Loss: 0.5727550 Vali Loss: 0.2806861 Best vali loss: 0.2806861
	iters: 100, epoch: 4 | loss: 0.5082588
	speed: 0.0272s/iter; left time: 15.1449s
Updating learning rate to 3.82015293875e-05
Epoch: 4 cost time: 1.8803644180297852
Epoch: 4, Steps: 131 | Train Loss: 0.5082588 Vali Loss: 0.2810987 Best vali loss: 0.2806861
	iters: 100, epoch: 5 | loss: 0.7251993
	speed: 0.0268s/iter; left time: 11.3749s
Updating learning rate to 1.910076469375e-05
Epoch: 5 cost time: 2.437492609024048
Epoch: 5, Steps: 131 | Train Loss: 0.7251993 Vali Loss: 0.2812005 Best vali loss: 0.2806861
	iters: 100, epoch: 6 | loss: 0.3347839
	speed: 0.0278s/iter; left time: 8.1787s
Updating learning rate to 9.550382346875e-06
Epoch: 6 cost time: 1.929213523864746
Epoch: 6, Steps: 131 | Train Loss: 0.3347839 Vali Loss: 0.2812500 Best vali loss: 0.2806861
	iters: 100, epoch: 7 | loss: 0.5491942
	speed: 0.0244s/iter; left time: 3.9785s
Updating learning rate to 4.7751911734375e-06
Epoch: 7 cost time: 1.6667096614837646
Epoch: 7, Steps: 131 | Train Loss: 0.5491942 Vali Loss: 0.2812119 Best vali loss: 0.2806861
	iters: 100, epoch: 8 | loss: 0.6074557
	speed: 0.0213s/iter; left time: 0.6800s
Updating learning rate to 2.38759558671875e-06
Epoch: 8 cost time: 0.8365356922149658
Epoch: 8, Steps: 131 | Train Loss: 0.6074557 Vali Loss: 0.2811965 Best vali loss: 0.2806861

best validation loss 0.280686067688106

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010480885831, 'e_layers': 2, 'learning_rate': 0.0045292011947, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0045292011947
Validation loss decreased (inf --> 0.3016).  Saving model state dict ...
Epoch: 1 cost time: 1.4411447048187256
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3015516 Best vali loss: 0.3015516
Updating learning rate to 0.00226460059735
Epoch: 2 cost time: 1.2249901294708252
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3034565 Best vali loss: 0.3015516
Updating learning rate to 0.001132300298675
Epoch: 3 cost time: 1.5130822658538818
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3020983 Best vali loss: 0.3015516

best validation loss 0.3015515981674992

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009235460562, 'e_layers': 1, 'learning_rate': 0.0008872150318, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4688874
	speed: 0.0199s/iter; left time: 39.7461s
	iters: 200, epoch: 1 | loss: 0.6535788
	speed: 0.0128s/iter; left time: 24.3547s
Updating learning rate to 0.0008872150318
Validation loss decreased (inf --> 0.2881).  Saving model state dict ...
Epoch: 1 cost time: 3.7040035724639893
Epoch: 1, Steps: 262 | Train Loss: 0.5612331 Vali Loss: 0.2881155 Best vali loss: 0.2881155
	iters: 100, epoch: 2 | loss: 0.3725763
	speed: 0.0431s/iter; left time: 74.7179s
	iters: 200, epoch: 2 | loss: 0.6325687
	speed: 0.0103s/iter; left time: 16.8496s
Updating learning rate to 0.0004436075159
Validation loss decreased (0.2881 --> 0.2860).  Saving model state dict ...
Epoch: 2 cost time: 2.855306625366211
Epoch: 2, Steps: 262 | Train Loss: 0.5025725 Vali Loss: 0.2860195 Best vali loss: 0.2860195
	iters: 100, epoch: 3 | loss: 0.6278356
	speed: 0.0476s/iter; left time: 70.0577s
	iters: 200, epoch: 3 | loss: 0.4561095
	speed: 0.0116s/iter; left time: 15.9464s
Updating learning rate to 0.00022180375795
Epoch: 3 cost time: 3.158752679824829
Epoch: 3, Steps: 262 | Train Loss: 0.5419725 Vali Loss: 0.2976467 Best vali loss: 0.2860195

best validation loss 0.2860195097448038

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0040645584337, 'e_layers': 3, 'learning_rate': 0.0029956557615, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5680099
	speed: 0.0138s/iter; left time: 56.4997s
	iters: 200, epoch: 1 | loss: 0.2734998
	speed: 0.0067s/iter; left time: 26.5841s
	iters: 300, epoch: 1 | loss: 0.4480088
	speed: 0.0082s/iter; left time: 31.7754s
	iters: 400, epoch: 1 | loss: 0.3429596
	speed: 0.0068s/iter; left time: 25.8119s
	iters: 500, epoch: 1 | loss: 0.4775463
	speed: 0.0075s/iter; left time: 27.6239s
Updating learning rate to 0.0029956557615
Validation loss decreased (inf --> 0.3260).  Saving model state dict ...
Epoch: 1 cost time: 4.217445135116577
Epoch: 1, Steps: 523 | Train Loss: 0.4220049 Vali Loss: 0.3260333 Best vali loss: 0.3260333
	iters: 100, epoch: 2 | loss: 0.7520017
	speed: 0.0203s/iter; left time: 72.4312s
	iters: 200, epoch: 2 | loss: 0.2883764
	speed: 0.0081s/iter; left time: 28.1023s
	iters: 300, epoch: 2 | loss: 0.4289657
	speed: 0.0087s/iter; left time: 29.2337s
	iters: 400, epoch: 2 | loss: 0.4597463
	speed: 0.0085s/iter; left time: 27.8326s
	iters: 500, epoch: 2 | loss: 0.8610020
	speed: 0.0078s/iter; left time: 24.7674s
Updating learning rate to 0.00149782788075
Validation loss decreased (0.3260 --> 0.3208).  Saving model state dict ...
Epoch: 2 cost time: 4.520704030990601
Epoch: 2, Steps: 523 | Train Loss: 0.5580184 Vali Loss: 0.3207762 Best vali loss: 0.3207762
	iters: 100, epoch: 3 | loss: 0.2800758
	speed: 0.0188s/iter; left time: 57.2826s
	iters: 200, epoch: 3 | loss: 0.3155623
	speed: 0.0078s/iter; left time: 22.7987s
	iters: 300, epoch: 3 | loss: 1.2239430
	speed: 0.0077s/iter; left time: 21.8809s
	iters: 400, epoch: 3 | loss: 0.5837749
	speed: 0.0068s/iter; left time: 18.6877s
	iters: 500, epoch: 3 | loss: 0.4513593
	speed: 0.0069s/iter; left time: 18.2304s
Updating learning rate to 0.000748913940375
Epoch: 3 cost time: 4.028285980224609
Epoch: 3, Steps: 523 | Train Loss: 0.5709431 Vali Loss: 0.3223868 Best vali loss: 0.3207762

best validation loss 0.32077621846183074

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009235460562, 'e_layers': 1, 'learning_rate': 0.0008872150318, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3933238
	speed: 0.0146s/iter; left time: 17.6272s
	iters: 200, epoch: 4 | loss: 0.4439083
	speed: 0.0094s/iter; left time: 10.4683s
Updating learning rate to 0.000110901878975
Epoch: 4 cost time: 2.75689435005188
Epoch: 4, Steps: 262 | Train Loss: 0.4186161 Vali Loss: 0.3023169 Best vali loss: 0.2860195
	iters: 100, epoch: 5 | loss: 0.2606677
	speed: 0.0327s/iter; left time: 31.0213s
	iters: 200, epoch: 5 | loss: 0.4632984
	speed: 0.0080s/iter; left time: 6.8044s
Updating learning rate to 5.54509394875e-05
Epoch: 5 cost time: 2.1714160442352295
Epoch: 5, Steps: 262 | Train Loss: 0.3619830 Vali Loss: 0.3035214 Best vali loss: 0.2860195
	iters: 100, epoch: 6 | loss: 0.4317752
	speed: 0.0233s/iter; left time: 16.0062s
	iters: 200, epoch: 6 | loss: 0.3757882
	speed: 0.0080s/iter; left time: 4.6738s
Updating learning rate to 2.772546974375e-05
Epoch: 6 cost time: 2.18232798576355
Epoch: 6, Steps: 262 | Train Loss: 0.4037817 Vali Loss: 0.3108259 Best vali loss: 0.2860195
	iters: 100, epoch: 7 | loss: 0.3286614
	speed: 0.0263s/iter; left time: 11.1712s
	iters: 200, epoch: 7 | loss: 0.4423035
	speed: 0.0084s/iter; left time: 2.7237s
Updating learning rate to 1.3862734871875e-05
Epoch: 7 cost time: 2.195054769515991
Epoch: 7, Steps: 262 | Train Loss: 0.3854824 Vali Loss: 0.3074756 Best vali loss: 0.2860195
	iters: 100, epoch: 8 | loss: 0.3487462
	speed: 0.0280s/iter; left time: 4.5675s
	iters: 200, epoch: 8 | loss: 0.2974166
	speed: 0.0092s/iter; left time: 0.5777s
Updating learning rate to 6.9313674359375e-06
Epoch: 8 cost time: 2.3262155055999756
Epoch: 8, Steps: 262 | Train Loss: 0.3230814 Vali Loss: 0.3103482 Best vali loss: 0.2860195

best validation loss 0.2860195097448038

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0018004289048, 'e_layers': 2, 'learning_rate': 0.0006780801608, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2668310
	speed: 0.0129s/iter; left time: 52.8933s
	iters: 200, epoch: 1 | loss: 1.1522815
	speed: 0.0054s/iter; left time: 21.6205s
	iters: 300, epoch: 1 | loss: 0.4648925
	speed: 0.0050s/iter; left time: 19.3487s
	iters: 400, epoch: 1 | loss: 0.2955170
	speed: 0.0113s/iter; left time: 42.6838s
	iters: 500, epoch: 1 | loss: 0.4132231
	speed: 0.0097s/iter; left time: 35.7345s
Updating learning rate to 0.0006780801608
Validation loss decreased (inf --> 0.2965).  Saving model state dict ...
Epoch: 1 cost time: 4.392886161804199
Epoch: 1, Steps: 523 | Train Loss: 0.5185490 Vali Loss: 0.2964649 Best vali loss: 0.2964649
	iters: 100, epoch: 2 | loss: 0.3283400
	speed: 0.0172s/iter; left time: 61.3836s
	iters: 200, epoch: 2 | loss: 0.9572248
	speed: 0.0122s/iter; left time: 42.1431s
	iters: 300, epoch: 2 | loss: 0.7198107
	speed: 0.0076s/iter; left time: 25.4889s
	iters: 400, epoch: 2 | loss: 0.3320167
	speed: 0.0063s/iter; left time: 20.7054s
	iters: 500, epoch: 2 | loss: 0.9548910
	speed: 0.0089s/iter; left time: 28.2335s
Updating learning rate to 0.0003390400804
Validation loss decreased (0.2965 --> 0.2885).  Saving model state dict ...
Epoch: 2 cost time: 4.373488903045654
Epoch: 2, Steps: 523 | Train Loss: 0.6584567 Vali Loss: 0.2885228 Best vali loss: 0.2885228
	iters: 100, epoch: 3 | loss: 1.2646906
	speed: 0.0167s/iter; left time: 50.7525s
	iters: 200, epoch: 3 | loss: 0.4166030
	speed: 0.0065s/iter; left time: 19.0800s
	iters: 300, epoch: 3 | loss: 0.2743070
	speed: 0.0077s/iter; left time: 21.8529s
	iters: 400, epoch: 3 | loss: 0.6327847
	speed: 0.0074s/iter; left time: 20.1535s
	iters: 500, epoch: 3 | loss: 0.3215393
	speed: 0.0073s/iter; left time: 19.1641s
Updating learning rate to 0.0001695200402
Epoch: 3 cost time: 3.706840991973877
Epoch: 3, Steps: 523 | Train Loss: 0.5819849 Vali Loss: 0.3092821 Best vali loss: 0.2885228
	iters: 100, epoch: 4 | loss: 0.6205373
	speed: 0.0147s/iter; left time: 37.0464s
	iters: 200, epoch: 4 | loss: 0.4275630
	speed: 0.0078s/iter; left time: 18.9416s
	iters: 300, epoch: 4 | loss: 0.3794514
	speed: 0.0059s/iter; left time: 13.7182s
	iters: 400, epoch: 4 | loss: 0.3528389
	speed: 0.0068s/iter; left time: 15.1267s
	iters: 500, epoch: 4 | loss: 0.2902194
	speed: 0.0076s/iter; left time: 16.0267s
Updating learning rate to 8.47600201e-05
Epoch: 4 cost time: 3.680112361907959
Epoch: 4, Steps: 523 | Train Loss: 0.4141220 Vali Loss: 0.3061006 Best vali loss: 0.2885228
	iters: 100, epoch: 5 | loss: 0.3021176
	speed: 0.0156s/iter; left time: 31.0306s
	iters: 200, epoch: 5 | loss: 0.3003933
	speed: 0.0083s/iter; left time: 15.6226s
	iters: 300, epoch: 5 | loss: 0.3157528
	speed: 0.0083s/iter; left time: 14.9034s
	iters: 400, epoch: 5 | loss: 0.2791113
	speed: 0.0082s/iter; left time: 13.8738s
	iters: 500, epoch: 5 | loss: 0.4592909
	speed: 0.0085s/iter; left time: 13.6187s
Updating learning rate to 4.238001005e-05
Epoch: 5 cost time: 4.248612880706787
Epoch: 5, Steps: 523 | Train Loss: 0.3313332 Vali Loss: 0.3120720 Best vali loss: 0.2885228
	iters: 100, epoch: 6 | loss: 0.5058471
	speed: 0.0187s/iter; left time: 27.4685s
	iters: 200, epoch: 6 | loss: 0.2332968
	speed: 0.0068s/iter; left time: 9.3058s
	iters: 300, epoch: 6 | loss: 0.3590563
	speed: 0.0066s/iter; left time: 8.4400s
	iters: 400, epoch: 6 | loss: 0.4456120
	speed: 0.0072s/iter; left time: 8.4005s
	iters: 500, epoch: 6 | loss: 0.2776969
	speed: 0.0072s/iter; left time: 7.6612s
Updating learning rate to 2.1190005025e-05
Epoch: 6 cost time: 3.662092447280884
Epoch: 6, Steps: 523 | Train Loss: 0.3643018 Vali Loss: 0.3184607 Best vali loss: 0.2885228
	iters: 100, epoch: 7 | loss: 0.6124557
	speed: 0.0192s/iter; left time: 18.1866s
	iters: 200, epoch: 7 | loss: 0.3916493
	speed: 0.0094s/iter; left time: 7.9331s
	iters: 300, epoch: 7 | loss: 0.3537188
	speed: 0.0096s/iter; left time: 7.1698s
	iters: 400, epoch: 7 | loss: 0.4430363
	speed: 0.0078s/iter; left time: 5.0158s
	iters: 500, epoch: 7 | loss: 0.3162358
	speed: 0.0093s/iter; left time: 5.0962s
Updating learning rate to 1.05950025125e-05
Epoch: 7 cost time: 4.881198167800903
Epoch: 7, Steps: 523 | Train Loss: 0.4234192 Vali Loss: 0.3177252 Best vali loss: 0.2885228
	iters: 100, epoch: 8 | loss: 0.2700289
	speed: 0.0218s/iter; left time: 9.2304s
	iters: 200, epoch: 8 | loss: 0.4771157
	speed: 0.0084s/iter; left time: 2.7208s
	iters: 300, epoch: 8 | loss: 0.2437664
	speed: 0.0093s/iter; left time: 2.0908s
	iters: 400, epoch: 8 | loss: 0.3590951
	speed: 0.0080s/iter; left time: 0.9904s
	iters: 500, epoch: 8 | loss: 0.1621093
	speed: 0.0068s/iter; left time: 0.1624s
Updating learning rate to 5.29750125625e-06
Epoch: 8 cost time: 4.405993938446045
Epoch: 8, Steps: 523 | Train Loss: 0.3024231 Vali Loss: 0.3222635 Best vali loss: 0.2885228

best validation loss 0.2885227754861726

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010323609243, 'e_layers': 2, 'learning_rate': 0.0030761511765, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3689680
	speed: 0.0184s/iter; left time: 36.7720s
	iters: 200, epoch: 1 | loss: 0.6128039
	speed: 0.0104s/iter; left time: 19.6625s
Updating learning rate to 0.0030761511765
Validation loss decreased (inf --> 0.3125).  Saving model state dict ...
Epoch: 1 cost time: 3.1415717601776123
Epoch: 1, Steps: 262 | Train Loss: 0.4908860 Vali Loss: 0.3124582 Best vali loss: 0.3124582
	iters: 100, epoch: 2 | loss: 0.7283053
	speed: 0.0233s/iter; left time: 40.3542s
	iters: 200, epoch: 2 | loss: 0.7288157
	speed: 0.0101s/iter; left time: 16.5437s
Updating learning rate to 0.00153807558825
Validation loss decreased (0.3125 --> 0.2973).  Saving model state dict ...
Epoch: 2 cost time: 2.4210574626922607
Epoch: 2, Steps: 262 | Train Loss: 0.7285605 Vali Loss: 0.2972904 Best vali loss: 0.2972904
	iters: 100, epoch: 3 | loss: 0.3290487
	speed: 0.0115s/iter; left time: 16.8743s
	iters: 200, epoch: 3 | loss: 0.9930550
	speed: 0.0081s/iter; left time: 11.0825s
Updating learning rate to 0.000769037794125
Validation loss decreased (0.2973 --> 0.2929).  Saving model state dict ...
Epoch: 3 cost time: 1.8101379871368408
Epoch: 3, Steps: 262 | Train Loss: 0.6610518 Vali Loss: 0.2928811 Best vali loss: 0.2928811
	iters: 100, epoch: 4 | loss: 0.3927729
	speed: 0.0166s/iter; left time: 20.0605s
	iters: 200, epoch: 4 | loss: 0.6484699
	speed: 0.0077s/iter; left time: 8.5771s
Updating learning rate to 0.0003845188970625
Epoch: 4 cost time: 2.0279085636138916
Epoch: 4, Steps: 262 | Train Loss: 0.5206214 Vali Loss: 0.3075030 Best vali loss: 0.2928811
	iters: 100, epoch: 5 | loss: 0.3573651
	speed: 0.0169s/iter; left time: 16.0527s
	iters: 200, epoch: 5 | loss: 0.4271211
	speed: 0.0073s/iter; left time: 6.2125s
Updating learning rate to 0.00019225944853125
Epoch: 5 cost time: 2.0004489421844482
Epoch: 5, Steps: 262 | Train Loss: 0.3922431 Vali Loss: 0.3193696 Best vali loss: 0.2928811
	iters: 100, epoch: 6 | loss: 0.3753819
	speed: 0.0167s/iter; left time: 11.4569s
	iters: 200, epoch: 6 | loss: 0.6009367
	speed: 0.0076s/iter; left time: 4.4331s
Updating learning rate to 9.6129724265625e-05
Epoch: 6 cost time: 2.022404432296753
Epoch: 6, Steps: 262 | Train Loss: 0.4881593 Vali Loss: 0.3192115 Best vali loss: 0.2928811
	iters: 100, epoch: 7 | loss: 0.7867386
	speed: 0.0166s/iter; left time: 7.0708s
	iters: 200, epoch: 7 | loss: 0.4110875
	speed: 0.0075s/iter; left time: 2.4226s
Updating learning rate to 4.80648621328125e-05
Epoch: 7 cost time: 2.043879270553589
Epoch: 7, Steps: 262 | Train Loss: 0.5989131 Vali Loss: 0.3326844 Best vali loss: 0.2928811
	iters: 100, epoch: 8 | loss: 0.3849327
	speed: 0.0177s/iter; left time: 2.8856s
	iters: 200, epoch: 8 | loss: 0.5595791
	speed: 0.0081s/iter; left time: 0.5124s
Updating learning rate to 2.403243106640625e-05
Epoch: 8 cost time: 2.1421117782592773
Epoch: 8, Steps: 262 | Train Loss: 0.4722559 Vali Loss: 0.3254419 Best vali loss: 0.2928811

best validation loss 0.2928811337545309

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0019750197317, 'e_layers': 2, 'learning_rate': 0.0001214761756, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001214761756
Validation loss decreased (inf --> 0.3081).  Saving model state dict ...
Epoch: 1 cost time: 0.907660722732544
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3080788 Best vali loss: 0.3080788
Updating learning rate to 6.07380878e-05
Validation loss decreased (0.3081 --> 0.2905).  Saving model state dict ...
Epoch: 2 cost time: 0.6062173843383789
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2905053 Best vali loss: 0.2905053
Updating learning rate to 3.03690439e-05
Validation loss decreased (0.2905 --> 0.2861).  Saving model state dict ...
Epoch: 3 cost time: 0.598341703414917
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2861248 Best vali loss: 0.2861248

best validation loss 0.28612475841960394

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009751084391, 'e_layers': 3, 'learning_rate': 0.0004086821072, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3966079
	speed: 0.0147s/iter; left time: 29.4497s
	iters: 200, epoch: 1 | loss: 0.7916693
	speed: 0.0080s/iter; left time: 15.0980s
Updating learning rate to 0.0004086821072
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 2.492922782897949
Epoch: 1, Steps: 262 | Train Loss: 0.5941386 Vali Loss: 0.2804973 Best vali loss: 0.2804973
	iters: 100, epoch: 2 | loss: 0.6768941
	speed: 0.0182s/iter; left time: 31.5714s
	iters: 200, epoch: 2 | loss: 0.4409591
	speed: 0.0090s/iter; left time: 14.6578s
Updating learning rate to 0.0002043410536
Epoch: 2 cost time: 2.3735427856445312
Epoch: 2, Steps: 262 | Train Loss: 0.5589266 Vali Loss: 0.2832501 Best vali loss: 0.2804973
	iters: 100, epoch: 3 | loss: 0.2780000
	speed: 0.0185s/iter; left time: 27.1880s
	iters: 200, epoch: 3 | loss: 0.5173690
	speed: 0.0078s/iter; left time: 10.7687s
Updating learning rate to 0.0001021705268
Validation loss decreased (0.2805 --> 0.2737).  Saving model state dict ...
Epoch: 3 cost time: 2.114630937576294
Epoch: 3, Steps: 262 | Train Loss: 0.3976845 Vali Loss: 0.2737460 Best vali loss: 0.2737460

best validation loss 0.27374597347638296

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009225062942, 'e_layers': 1, 'learning_rate': 0.0034509285106, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0033195853648514996
Validation loss decreased (inf --> 0.2882).  Saving model state dict ...
Epoch: 1 cost time: 0.8351576328277588
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2881745 Best vali loss: 0.2881745
Updating learning rate to 0.002945551730917626
Epoch: 2 cost time: 0.5141723155975342
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2912351 Best vali loss: 0.2881745
Updating learning rate to 0.0023857708389414777
Epoch: 3 cost time: 0.5412423610687256
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3002987 Best vali loss: 0.2881745

best validation loss 0.2881745205033264

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009751084391, 'e_layers': 3, 'learning_rate': 0.0004086821072, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3443807
	speed: 0.0157s/iter; left time: 18.9530s
	iters: 200, epoch: 4 | loss: 0.5333063
	speed: 0.0084s/iter; left time: 9.3057s
Updating learning rate to 5.10852634e-05
Epoch: 4 cost time: 2.5032451152801514
Epoch: 4, Steps: 262 | Train Loss: 0.4388435 Vali Loss: 0.2811857 Best vali loss: 0.2737460
	iters: 100, epoch: 5 | loss: 0.5468386
	speed: 0.0212s/iter; left time: 20.0893s
	iters: 200, epoch: 5 | loss: 0.3684103
	speed: 0.0082s/iter; left time: 6.9206s
Updating learning rate to 2.55426317e-05
Epoch: 5 cost time: 2.1906607151031494
Epoch: 5, Steps: 262 | Train Loss: 0.4576245 Vali Loss: 0.2907534 Best vali loss: 0.2737460
	iters: 100, epoch: 6 | loss: 0.2473323
	speed: 0.0176s/iter; left time: 12.0692s
	iters: 200, epoch: 6 | loss: 0.4574664
	speed: 0.0080s/iter; left time: 4.6682s
Updating learning rate to 1.277131585e-05
Epoch: 6 cost time: 2.1669938564300537
Epoch: 6, Steps: 262 | Train Loss: 0.3523994 Vali Loss: 0.2832961 Best vali loss: 0.2737460
	iters: 100, epoch: 7 | loss: 0.3615414
	speed: 0.0167s/iter; left time: 7.1182s
	iters: 200, epoch: 7 | loss: 0.6245102
	speed: 0.0087s/iter; left time: 2.8124s
Updating learning rate to 6.385657925e-06
Epoch: 7 cost time: 2.291186809539795
Epoch: 7, Steps: 262 | Train Loss: 0.4930258 Vali Loss: 0.2880597 Best vali loss: 0.2737460
	iters: 100, epoch: 8 | loss: 0.3046660
	speed: 0.0277s/iter; left time: 4.5162s
	iters: 200, epoch: 8 | loss: 0.3890677
	speed: 0.0106s/iter; left time: 0.6668s
Updating learning rate to 3.1928289625e-06
Epoch: 8 cost time: 2.7783560752868652
Epoch: 8, Steps: 262 | Train Loss: 0.3468669 Vali Loss: 0.2861446 Best vali loss: 0.2737460

best validation loss 0.27374597347638296

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0008879508695, 'e_layers': 2, 'learning_rate': 0.0001199402957, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8700228
	speed: 0.0164s/iter; left time: 32.8061s
	iters: 200, epoch: 1 | loss: 0.7814025
	speed: 0.0100s/iter; left time: 18.8968s
Updating learning rate to 0.00011537534001029075
Validation loss decreased (inf --> 0.2792).  Saving model state dict ...
Epoch: 1 cost time: 2.8986473083496094
Epoch: 1, Steps: 262 | Train Loss: 0.8257127 Vali Loss: 0.2792245 Best vali loss: 0.2792245
	iters: 100, epoch: 2 | loss: 0.7932562
	speed: 0.0236s/iter; left time: 40.9625s
	iters: 200, epoch: 2 | loss: 0.8262981
	speed: 0.0076s/iter; left time: 12.3700s
Updating learning rate to 0.00010237544606349485
Validation loss decreased (0.2792 --> 0.2789).  Saving model state dict ...
Epoch: 2 cost time: 2.1847238540649414
Epoch: 2, Steps: 262 | Train Loss: 0.8097771 Vali Loss: 0.2788657 Best vali loss: 0.2788657
	iters: 100, epoch: 3 | loss: 0.6935408
	speed: 0.0228s/iter; left time: 33.5329s
	iters: 200, epoch: 3 | loss: 0.4898773
	speed: 0.0094s/iter; left time: 12.8823s
Updating learning rate to 8.291972986867991e-05
Epoch: 3 cost time: 2.4369020462036133
Epoch: 3, Steps: 262 | Train Loss: 0.5917090 Vali Loss: 0.2807428 Best vali loss: 0.2788657
	iters: 100, epoch: 4 | loss: 0.4457577
	speed: 0.0225s/iter; left time: 27.2577s
	iters: 200, epoch: 4 | loss: 0.4124048
	speed: 0.0095s/iter; left time: 10.5793s
Updating learning rate to 5.997014785e-05
Epoch: 4 cost time: 2.5852713584899902
Epoch: 4, Steps: 262 | Train Loss: 0.4290812 Vali Loss: 0.2822211 Best vali loss: 0.2788657
	iters: 100, epoch: 5 | loss: 0.2921625
	speed: 0.0173s/iter; left time: 16.4570s
	iters: 200, epoch: 5 | loss: 0.3839825
	speed: 0.0041s/iter; left time: 3.5223s
Updating learning rate to 3.702056583132009e-05
Epoch: 5 cost time: 1.190549373626709
Epoch: 5, Steps: 262 | Train Loss: 0.3380725 Vali Loss: 0.2916018 Best vali loss: 0.2788657
	iters: 100, epoch: 6 | loss: 0.2845418
	speed: 0.0123s/iter; left time: 8.4334s
	iters: 200, epoch: 6 | loss: 0.4021352
	speed: 0.0069s/iter; left time: 4.0312s
Updating learning rate to 1.756484963650515e-05
Epoch: 6 cost time: 1.8328418731689453
Epoch: 6, Steps: 262 | Train Loss: 0.3433385 Vali Loss: 0.2883644 Best vali loss: 0.2788657
	iters: 100, epoch: 7 | loss: 0.4379286
	speed: 0.0180s/iter; left time: 7.6312s
	iters: 200, epoch: 7 | loss: 0.3991660
	speed: 0.0081s/iter; left time: 2.6438s
Updating learning rate to 4.564955689709253e-06
Epoch: 7 cost time: 2.156709909439087
Epoch: 7, Steps: 262 | Train Loss: 0.4185473 Vali Loss: 0.2872624 Best vali loss: 0.2788657
	iters: 100, epoch: 8 | loss: 0.2600795
	speed: 0.0175s/iter; left time: 2.8511s
	iters: 200, epoch: 8 | loss: 0.3294934
	speed: 0.0077s/iter; left time: 0.4849s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.078878164291382
Epoch: 8, Steps: 262 | Train Loss: 0.2947864 Vali Loss: 0.2858931 Best vali loss: 0.2788657

best validation loss 0.27886569668986

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0010919467176, 'e_layers': 2, 'learning_rate': 8.38320316e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6455334
	speed: 0.0170s/iter; left time: 34.0053s
	iters: 200, epoch: 1 | loss: 0.3325463
	speed: 0.0106s/iter; left time: 20.0723s
Updating learning rate to 8.38320316e-05
Validation loss decreased (inf --> 0.2898).  Saving model state dict ...
Epoch: 1 cost time: 3.184041738510132
Epoch: 1, Steps: 262 | Train Loss: 0.4890399 Vali Loss: 0.2898103 Best vali loss: 0.2898103
	iters: 100, epoch: 2 | loss: 0.6785499
	speed: 0.0333s/iter; left time: 57.8329s
	iters: 200, epoch: 2 | loss: 0.4587791
	speed: 0.0094s/iter; left time: 15.2883s
Updating learning rate to 4.19160158e-05
Validation loss decreased (0.2898 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 2.6071834564208984
Epoch: 2, Steps: 262 | Train Loss: 0.5686645 Vali Loss: 0.2808813 Best vali loss: 0.2808813
	iters: 100, epoch: 3 | loss: 0.4416411
	speed: 0.0266s/iter; left time: 39.1536s
	iters: 200, epoch: 3 | loss: 0.9505336
	speed: 0.0097s/iter; left time: 13.2700s
Updating learning rate to 2.09580079e-05
Validation loss decreased (0.2809 --> 0.2792).  Saving model state dict ...
Epoch: 3 cost time: 2.525812864303589
Epoch: 3, Steps: 262 | Train Loss: 0.6960873 Vali Loss: 0.2792431 Best vali loss: 0.2792431
	iters: 100, epoch: 4 | loss: 0.4839962
	speed: 0.0184s/iter; left time: 22.2656s
	iters: 200, epoch: 4 | loss: 0.6245351
	speed: 0.0096s/iter; left time: 10.6380s
Updating learning rate to 1.047900395e-05
Validation loss decreased (0.2792 --> 0.2792).  Saving model state dict ...
Epoch: 4 cost time: 2.3706111907958984
Epoch: 4, Steps: 262 | Train Loss: 0.5542657 Vali Loss: 0.2791792 Best vali loss: 0.2791792
	iters: 100, epoch: 5 | loss: 0.7528257
	speed: 0.0221s/iter; left time: 20.9609s
	iters: 200, epoch: 5 | loss: 0.5864883
	speed: 0.0114s/iter; left time: 9.7183s
Updating learning rate to 5.239501975e-06
Validation loss decreased (0.2792 --> 0.2789).  Saving model state dict ...
Epoch: 5 cost time: 2.818873167037964
Epoch: 5, Steps: 262 | Train Loss: 0.6696570 Vali Loss: 0.2789499 Best vali loss: 0.2789499
	iters: 100, epoch: 6 | loss: 0.3080570
	speed: 0.0523s/iter; left time: 35.9404s
	iters: 200, epoch: 6 | loss: 1.0281348
	speed: 0.0129s/iter; left time: 7.5920s
Updating learning rate to 2.6197509875e-06
Epoch: 6 cost time: 3.7335996627807617
Epoch: 6, Steps: 262 | Train Loss: 0.6680959 Vali Loss: 0.2790656 Best vali loss: 0.2789499
	iters: 100, epoch: 7 | loss: 0.3777721
	speed: 0.0483s/iter; left time: 20.5230s
	iters: 200, epoch: 7 | loss: 0.2993870
	speed: 0.0123s/iter; left time: 3.9889s
Updating learning rate to 1.30987549375e-06
Epoch: 7 cost time: 3.2720577716827393
Epoch: 7, Steps: 262 | Train Loss: 0.3385796 Vali Loss: 0.2790464 Best vali loss: 0.2789499
	iters: 100, epoch: 8 | loss: 0.3931473
	speed: 0.0510s/iter; left time: 8.3207s
	iters: 200, epoch: 8 | loss: 0.4133014
	speed: 0.0140s/iter; left time: 0.8794s
Updating learning rate to 6.54937746875e-07
Epoch: 8 cost time: 3.7081286907196045
Epoch: 8, Steps: 262 | Train Loss: 0.4032243 Vali Loss: 0.2790824 Best vali loss: 0.2789499

best validation loss 0.2789498508619349

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0088883810649, 'e_layers': 2, 'learning_rate': 0.000686764093, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000686764093
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 1.2567429542541504
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2882760 Best vali loss: 0.2882760
Updating learning rate to 0.0003433820465
Validation loss decreased (0.2883 --> 0.2854).  Saving model state dict ...
Epoch: 2 cost time: 2.8095974922180176
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2854421 Best vali loss: 0.2854421
Updating learning rate to 0.00017169102325
Epoch: 3 cost time: 2.1801629066467285
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2876379 Best vali loss: 0.2854421

best validation loss 0.28544210064318065

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 3, 'learning_rate': 0.0017332120876, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4919918
	speed: 0.0215s/iter; left time: 42.8654s
	iters: 200, epoch: 1 | loss: 0.5757270
	speed: 0.0153s/iter; left time: 29.0590s
Updating learning rate to 0.0016672456304173996
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 4.22709059715271
Epoch: 1, Steps: 262 | Train Loss: 0.5338594 Vali Loss: 0.2862478 Best vali loss: 0.2862478
	iters: 100, epoch: 2 | loss: 0.5542030
	speed: 0.0533s/iter; left time: 92.5209s
	iters: 200, epoch: 2 | loss: 0.6212960
	speed: 0.0134s/iter; left time: 21.9689s
Updating learning rate to 0.0014793890539882262
Epoch: 2 cost time: 3.69390606880188
Epoch: 2, Steps: 262 | Train Loss: 0.5877495 Vali Loss: 0.2933505 Best vali loss: 0.2862478
	iters: 100, epoch: 3 | loss: 0.4526182
	speed: 0.0452s/iter; left time: 66.6527s
	iters: 200, epoch: 3 | loss: 0.8560715
	speed: 0.0136s/iter; left time: 18.6591s
Updating learning rate to 0.0011982418191497154
Epoch: 3 cost time: 3.8001840114593506
Epoch: 3, Steps: 262 | Train Loss: 0.6543448 Vali Loss: 0.2950396 Best vali loss: 0.2862478

best validation loss 0.28624781244702835

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.001969041716, 'e_layers': 4, 'learning_rate': 0.002622950511, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1491684
	speed: 0.0145s/iter; left time: 119.9766s
	iters: 200, epoch: 1 | loss: 1.7354593
	speed: 0.0082s/iter; left time: 66.6614s
	iters: 300, epoch: 1 | loss: 0.3025525
	speed: 0.0084s/iter; left time: 67.9728s
	iters: 400, epoch: 1 | loss: 0.6970431
	speed: 0.0080s/iter; left time: 63.6081s
	iters: 500, epoch: 1 | loss: 0.3217794
	speed: 0.0070s/iter; left time: 55.1522s
	iters: 600, epoch: 1 | loss: 0.3194846
	speed: 0.0077s/iter; left time: 59.6375s
	iters: 700, epoch: 1 | loss: 0.2898923
	speed: 0.0086s/iter; left time: 65.8918s
	iters: 800, epoch: 1 | loss: 0.2729954
	speed: 0.0076s/iter; left time: 57.1992s
	iters: 900, epoch: 1 | loss: 1.2343456
	speed: 0.0110s/iter; left time: 82.3782s
	iters: 1000, epoch: 1 | loss: 0.2556643
	speed: 0.0157s/iter; left time: 115.4280s
Updating learning rate to 0.002622950511
Validation loss decreased (inf --> 0.3203).  Saving model state dict ...
Epoch: 1 cost time: 10.103204727172852
Epoch: 1, Steps: 1045 | Train Loss: 0.6578385 Vali Loss: 0.3203496 Best vali loss: 0.3203496
	iters: 100, epoch: 2 | loss: 0.2172222
	speed: 0.0437s/iter; left time: 315.5444s
	iters: 200, epoch: 2 | loss: 0.6252526
	speed: 0.0132s/iter; left time: 93.7594s
	iters: 300, epoch: 2 | loss: 0.3742666
	speed: 0.0148s/iter; left time: 103.8881s
	iters: 400, epoch: 2 | loss: 1.0111176
	speed: 0.0140s/iter; left time: 96.7330s
	iters: 500, epoch: 2 | loss: 0.5626193
	speed: 0.0107s/iter; left time: 73.0481s
	iters: 600, epoch: 2 | loss: 0.3887978
	speed: 0.0121s/iter; left time: 81.2931s
	iters: 700, epoch: 2 | loss: 0.6819391
	speed: 0.0145s/iter; left time: 95.7019s
	iters: 800, epoch: 2 | loss: 0.6109523
	speed: 0.0142s/iter; left time: 92.6538s
	iters: 900, epoch: 2 | loss: 0.2033347
	speed: 0.0107s/iter; left time: 68.5560s
	iters: 1000, epoch: 2 | loss: 0.5589601
	speed: 0.0083s/iter; left time: 52.2098s
Updating learning rate to 0.0013114752555
Epoch: 2 cost time: 12.900173425674438
Epoch: 2, Steps: 1045 | Train Loss: 0.5234462 Vali Loss: 0.3250716 Best vali loss: 0.3203496
	iters: 100, epoch: 3 | loss: 0.5193028
	speed: 0.0347s/iter; left time: 213.8469s
	iters: 200, epoch: 3 | loss: 0.4694948
	speed: 0.0127s/iter; left time: 77.0060s
	iters: 300, epoch: 3 | loss: 0.1416804
	speed: 0.0108s/iter; left time: 64.5703s
	iters: 400, epoch: 3 | loss: 0.4008707
	speed: 0.0106s/iter; left time: 62.1045s
	iters: 500, epoch: 3 | loss: 0.3774335
	speed: 0.0147s/iter; left time: 84.8261s
	iters: 600, epoch: 3 | loss: 0.2749605
	speed: 0.0112s/iter; left time: 63.5886s
	iters: 700, epoch: 3 | loss: 0.3566222
	speed: 0.0128s/iter; left time: 71.2398s
	iters: 800, epoch: 3 | loss: 0.2184450
	speed: 0.0156s/iter; left time: 85.3692s
	iters: 900, epoch: 3 | loss: 0.8728355
	speed: 0.0111s/iter; left time: 59.4321s
	iters: 1000, epoch: 3 | loss: 0.4382883
	speed: 0.0140s/iter; left time: 73.6768s
Updating learning rate to 0.00065573762775
Epoch: 3 cost time: 13.261538028717041
Epoch: 3, Steps: 1045 | Train Loss: 0.4069934 Vali Loss: 0.3220185 Best vali loss: 0.3203496

best validation loss 0.3203496020405033

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0088883810649, 'e_layers': 2, 'learning_rate': 0.000686764093, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.5845511625e-05
Validation loss decreased (0.2854 --> 0.2784).  Saving model state dict ...
Epoch: 4 cost time: 1.667598009109497
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2784324 Best vali loss: 0.2784324
Updating learning rate to 4.29227558125e-05
Validation loss decreased (0.2784 --> 0.2763).  Saving model state dict ...
Epoch: 5 cost time: 1.2473797798156738
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2763150 Best vali loss: 0.2763150
Updating learning rate to 2.146137790625e-05
Epoch: 6 cost time: 1.2951176166534424
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2782562 Best vali loss: 0.2763150
Updating learning rate to 1.0730688953125e-05
Epoch: 7 cost time: 1.3859503269195557
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2782424 Best vali loss: 0.2763150
Updating learning rate to 5.3653444765625e-06
Epoch: 8 cost time: 1.2684752941131592
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2785594 Best vali loss: 0.2763150

best validation loss 0.27631499322651487

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0093052819012, 'e_layers': 1, 'learning_rate': 6.93829762e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5432653
	speed: 0.0260s/iter; left time: 24.6746s
Updating learning rate to 6.674224390794886e-05
Validation loss decreased (inf --> 0.3315).  Saving model state dict ...
Epoch: 1 cost time: 2.8008153438568115
Epoch: 1, Steps: 131 | Train Loss: 0.5432653 Vali Loss: 0.3315008 Best vali loss: 0.3315008
	iters: 100, epoch: 2 | loss: 0.3059451
	speed: 0.0130s/iter; left time: 10.6446s
Updating learning rate to 5.922207458496241e-05
Validation loss decreased (0.3315 --> 0.3119).  Saving model state dict ...
Epoch: 2 cost time: 0.8221399784088135
Epoch: 2, Steps: 131 | Train Loss: 0.3059451 Vali Loss: 0.3118799 Best vali loss: 0.3118799
	iters: 100, epoch: 3 | loss: 0.3674992
	speed: 0.0106s/iter; left time: 7.2987s
Updating learning rate to 4.796734583996066e-05
Validation loss decreased (0.3119 --> 0.3011).  Saving model state dict ...
Epoch: 3 cost time: 0.7799763679504395
Epoch: 3, Steps: 131 | Train Loss: 0.3674992 Vali Loss: 0.3010522 Best vali loss: 0.3010522
	iters: 100, epoch: 4 | loss: 0.6183621
	speed: 0.0111s/iter; left time: 6.1835s
Updating learning rate to 3.46914881e-05
Validation loss decreased (0.3011 --> 0.2952).  Saving model state dict ...
Epoch: 4 cost time: 0.8930263519287109
Epoch: 4, Steps: 131 | Train Loss: 0.6183621 Vali Loss: 0.2951930 Best vali loss: 0.2951930
	iters: 100, epoch: 5 | loss: 0.4424021
	speed: 0.0110s/iter; left time: 4.6657s
Updating learning rate to 2.1415630360039334e-05
Validation loss decreased (0.2952 --> 0.2919).  Saving model state dict ...
Epoch: 5 cost time: 0.8588035106658936
Epoch: 5, Steps: 131 | Train Loss: 0.4424021 Vali Loss: 0.2919239 Best vali loss: 0.2919239
	iters: 100, epoch: 6 | loss: 0.3947150
	speed: 0.0109s/iter; left time: 3.2133s
Updating learning rate to 1.0160901615037585e-05
Validation loss decreased (0.2919 --> 0.2902).  Saving model state dict ...
Epoch: 6 cost time: 0.8493177890777588
Epoch: 6, Steps: 131 | Train Loss: 0.3947150 Vali Loss: 0.2901520 Best vali loss: 0.2901520
	iters: 100, epoch: 7 | loss: 0.5807606
	speed: 0.0115s/iter; left time: 1.8711s
Updating learning rate to 2.6407322920511326e-06
Validation loss decreased (0.2902 --> 0.2894).  Saving model state dict ...
Epoch: 7 cost time: 0.9024226665496826
Epoch: 7, Steps: 131 | Train Loss: 0.5807606 Vali Loss: 0.2894087 Best vali loss: 0.2894087
	iters: 100, epoch: 8 | loss: 0.5883266
	speed: 0.0107s/iter; left time: 0.3430s
Updating learning rate to 0.0
Validation loss decreased (0.2894 --> 0.2892).  Saving model state dict ...
Epoch: 8 cost time: 0.8397364616394043
Epoch: 8, Steps: 131 | Train Loss: 0.5883266 Vali Loss: 0.2892264 Best vali loss: 0.2892264

best validation loss 0.28922644402733433

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0059255007297, 'e_layers': 4, 'learning_rate': 0.0005976076515, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0521700
	speed: 0.0170s/iter; left time: 69.3738s
	iters: 200, epoch: 1 | loss: 0.2965389
	speed: 0.0113s/iter; left time: 44.9994s
	iters: 300, epoch: 1 | loss: 0.6322224
	speed: 0.0111s/iter; left time: 43.2263s
	iters: 400, epoch: 1 | loss: 0.2464052
	speed: 0.0114s/iter; left time: 43.0124s
	iters: 500, epoch: 1 | loss: 0.9271936
	speed: 0.0087s/iter; left time: 31.9626s
Updating learning rate to 0.000574862564596494
Validation loss decreased (inf --> 0.2920).  Saving model state dict ...
Epoch: 1 cost time: 5.838924884796143
Epoch: 1, Steps: 523 | Train Loss: 0.6309060 Vali Loss: 0.2919505 Best vali loss: 0.2919505
	iters: 100, epoch: 2 | loss: 0.4116667
	speed: 0.0230s/iter; left time: 82.0455s
	iters: 200, epoch: 2 | loss: 0.6561241
	speed: 0.0113s/iter; left time: 39.0761s
	iters: 300, epoch: 2 | loss: 0.7352666
	speed: 0.0101s/iter; left time: 33.7901s
	iters: 400, epoch: 2 | loss: 0.3726344
	speed: 0.0099s/iter; left time: 32.3600s
	iters: 500, epoch: 2 | loss: 0.3423165
	speed: 0.0116s/iter; left time: 36.8007s
Updating learning rate to 0.0005100900371823085
Validation loss decreased (0.2920 --> 0.2901).  Saving model state dict ...
Epoch: 2 cost time: 5.747412204742432
Epoch: 2, Steps: 523 | Train Loss: 0.5036017 Vali Loss: 0.2900706 Best vali loss: 0.2900706
	iters: 100, epoch: 3 | loss: 0.3176349
	speed: 0.0211s/iter; left time: 64.1417s
	iters: 200, epoch: 3 | loss: 0.4121847
	speed: 0.0139s/iter; left time: 40.8530s
	iters: 300, epoch: 3 | loss: 0.6249788
	speed: 0.0154s/iter; left time: 43.7385s
	iters: 400, epoch: 3 | loss: 0.6906338
	speed: 0.0151s/iter; left time: 41.3808s
	iters: 500, epoch: 3 | loss: 0.8865409
	speed: 0.0093s/iter; left time: 24.4236s
Updating learning rate to 0.0004131510993918302
Epoch: 3 cost time: 6.630788087844849
Epoch: 3, Steps: 523 | Train Loss: 0.5863946 Vali Loss: 0.2913437 Best vali loss: 0.2900706
	iters: 100, epoch: 4 | loss: 0.3292863
	speed: 0.0189s/iter; left time: 47.6720s
	iters: 200, epoch: 4 | loss: 0.7067035
	speed: 0.0085s/iter; left time: 20.6305s
	iters: 300, epoch: 4 | loss: 0.9088566
	speed: 0.0093s/iter; left time: 21.4703s
	iters: 400, epoch: 4 | loss: 0.3524361
	speed: 0.0097s/iter; left time: 21.5675s
	iters: 500, epoch: 4 | loss: 0.3988183
	speed: 0.0094s/iter; left time: 19.8174s
Updating learning rate to 0.00029880382575
Epoch: 4 cost time: 4.845601320266724
Epoch: 4, Steps: 523 | Train Loss: 0.5392202 Vali Loss: 0.3131424 Best vali loss: 0.2900706
	iters: 100, epoch: 5 | loss: 0.4215759
	speed: 0.0191s/iter; left time: 37.9780s
	iters: 200, epoch: 5 | loss: 0.4625345
	speed: 0.0099s/iter; left time: 18.6536s
	iters: 300, epoch: 5 | loss: 0.3110062
	speed: 0.0098s/iter; left time: 17.5544s
	iters: 400, epoch: 5 | loss: 0.4252338
	speed: 0.0096s/iter; left time: 16.2602s
	iters: 500, epoch: 5 | loss: 0.4759250
	speed: 0.0118s/iter; left time: 18.7189s
Updating learning rate to 0.0001844565521081698
Epoch: 5 cost time: 5.496165037155151
Epoch: 5, Steps: 523 | Train Loss: 0.4192551 Vali Loss: 0.2918330 Best vali loss: 0.2900706
	iters: 100, epoch: 6 | loss: 0.3708058
	speed: 0.0194s/iter; left time: 28.4497s
	iters: 200, epoch: 6 | loss: 0.4494677
	speed: 0.0119s/iter; left time: 16.2991s
	iters: 300, epoch: 6 | loss: 0.5869825
	speed: 0.0108s/iter; left time: 13.6911s
	iters: 400, epoch: 6 | loss: 0.2720427
	speed: 0.0109s/iter; left time: 12.7492s
	iters: 500, epoch: 6 | loss: 0.5704898
	speed: 0.0110s/iter; left time: 11.7881s
Updating learning rate to 8.751761431769149e-05
Epoch: 6 cost time: 5.657244443893433
Epoch: 6, Steps: 523 | Train Loss: 0.4499577 Vali Loss: 0.3002330 Best vali loss: 0.2900706
	iters: 100, epoch: 7 | loss: 0.5286528
	speed: 0.0239s/iter; left time: 22.6526s
	iters: 200, epoch: 7 | loss: 0.2585932
	speed: 0.0104s/iter; left time: 8.8450s
	iters: 300, epoch: 7 | loss: 0.2328667
	speed: 0.0114s/iter; left time: 8.4835s
	iters: 400, epoch: 7 | loss: 0.2500257
	speed: 0.0082s/iter; left time: 5.3367s
	iters: 500, epoch: 7 | loss: 0.3265649
	speed: 0.0091s/iter; left time: 4.9562s
Updating learning rate to 2.2745086903506018e-05
Epoch: 7 cost time: 5.3842244148254395
Epoch: 7, Steps: 523 | Train Loss: 0.3193407 Vali Loss: 0.2982914 Best vali loss: 0.2900706
	iters: 100, epoch: 8 | loss: 0.4980443
	speed: 0.0228s/iter; left time: 9.6578s
	iters: 200, epoch: 8 | loss: 0.4858882
	speed: 0.0110s/iter; left time: 3.5698s
	iters: 300, epoch: 8 | loss: 0.4007152
	speed: 0.0116s/iter; left time: 2.5994s
	iters: 400, epoch: 8 | loss: 0.5638968
	speed: 0.0102s/iter; left time: 1.2602s
	iters: 500, epoch: 8 | loss: 0.2100844
	speed: 0.0090s/iter; left time: 0.2170s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.539756774902344
Epoch: 8, Steps: 523 | Train Loss: 0.4317258 Vali Loss: 0.2970066 Best vali loss: 0.2900706

best validation loss 0.29007063289032675

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.001413634213, 'e_layers': 2, 'learning_rate': 0.0002819224167, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5260377
	speed: 0.0145s/iter; left time: 13.7514s
Updating learning rate to 0.0002711923836226241
Validation loss decreased (inf --> 0.3076).  Saving model state dict ...
Epoch: 1 cost time: 1.34246826171875
Epoch: 1, Steps: 131 | Train Loss: 0.5260377 Vali Loss: 0.3076261 Best vali loss: 0.3076261
	iters: 100, epoch: 2 | loss: 0.4887720
	speed: 0.0130s/iter; left time: 10.6522s
Updating learning rate to 0.00024063583465853478
Validation loss decreased (0.3076 --> 0.2941).  Saving model state dict ...
Epoch: 2 cost time: 1.056692361831665
Epoch: 2, Steps: 131 | Train Loss: 0.4887720 Vali Loss: 0.2940930 Best vali loss: 0.2940930
	iters: 100, epoch: 3 | loss: 0.5147622
	speed: 0.0135s/iter; left time: 9.2459s
Updating learning rate to 0.00019490472739170858
Validation loss decreased (0.2941 --> 0.2887).  Saving model state dict ...
Epoch: 3 cost time: 1.0522618293762207
Epoch: 3, Steps: 131 | Train Loss: 0.5147622 Vali Loss: 0.2886572 Best vali loss: 0.2886572

best validation loss 0.2886571502455019

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.003762804933, 'e_layers': 1, 'learning_rate': 0.0003146953787, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003146953787
Validation loss decreased (inf --> 0.2782).  Saving model state dict ...
Epoch: 1 cost time: 0.8003785610198975
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2781756 Best vali loss: 0.2781756
Updating learning rate to 0.00015734768935
Epoch: 2 cost time: 0.5137300491333008
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2785028 Best vali loss: 0.2781756
Updating learning rate to 7.8673844675e-05
Epoch: 3 cost time: 0.4994971752166748
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2834392 Best vali loss: 0.2781756

best validation loss 0.2781756071130686

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0008826966377, 'e_layers': 3, 'learning_rate': 0.0004499065077, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3842746
	speed: 0.0150s/iter; left time: 61.4309s
	iters: 200, epoch: 1 | loss: 0.2683716
	speed: 0.0090s/iter; left time: 35.6753s
	iters: 300, epoch: 1 | loss: 0.4104872
	speed: 0.0074s/iter; left time: 28.7679s
	iters: 400, epoch: 1 | loss: 0.6452193
	speed: 0.0071s/iter; left time: 26.9869s
	iters: 500, epoch: 1 | loss: 0.8589408
	speed: 0.0083s/iter; left time: 30.7635s
Updating learning rate to 0.00043278296085383084
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 4.581899404525757
Epoch: 1, Steps: 523 | Train Loss: 0.5134587 Vali Loss: 0.2838114 Best vali loss: 0.2838114
	iters: 100, epoch: 2 | loss: 0.4003901
	speed: 0.0198s/iter; left time: 70.6055s
	iters: 200, epoch: 2 | loss: 0.8123986
	speed: 0.0093s/iter; left time: 32.0728s
	iters: 300, epoch: 2 | loss: 0.3661626
	speed: 0.0091s/iter; left time: 30.4901s
	iters: 400, epoch: 2 | loss: 0.5715099
	speed: 0.0087s/iter; left time: 28.4037s
	iters: 500, epoch: 2 | loss: 0.6927958
	speed: 0.0078s/iter; left time: 24.6325s
Updating learning rate to 0.0003840192250973138
Epoch: 2 cost time: 4.626083850860596
Epoch: 2, Steps: 523 | Train Loss: 0.5686514 Vali Loss: 0.2848551 Best vali loss: 0.2838114
	iters: 100, epoch: 3 | loss: 0.4646885
	speed: 0.0176s/iter; left time: 53.5389s
	iters: 200, epoch: 3 | loss: 0.4756067
	speed: 0.0090s/iter; left time: 26.5208s
	iters: 300, epoch: 3 | loss: 0.2075893
	speed: 0.0085s/iter; left time: 24.2589s
	iters: 400, epoch: 3 | loss: 0.2349140
	speed: 0.0087s/iter; left time: 23.6990s
	iters: 500, epoch: 3 | loss: 0.4222670
	speed: 0.0086s/iter; left time: 22.6347s
Updating learning rate to 0.00031103913715501335
Validation loss decreased (0.2838 --> 0.2834).  Saving model state dict ...
Epoch: 3 cost time: 4.583648204803467
Epoch: 3, Steps: 523 | Train Loss: 0.3610131 Vali Loss: 0.2833783 Best vali loss: 0.2833783

best validation loss 0.2833782750773758

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.003762804933, 'e_layers': 1, 'learning_rate': 0.0003146953787, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.93369223375e-05
Epoch: 4 cost time: 1.261498212814331
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2848201 Best vali loss: 0.2781756
Updating learning rate to 1.966846116875e-05
Epoch: 5 cost time: 0.5657944679260254
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2866864 Best vali loss: 0.2781756
Updating learning rate to 9.834230584375e-06
Epoch: 6 cost time: 0.49251365661621094
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2876038 Best vali loss: 0.2781756
Updating learning rate to 4.9171152921875e-06
Epoch: 7 cost time: 0.5223994255065918
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2872595 Best vali loss: 0.2781756
Updating learning rate to 2.45855764609375e-06
Epoch: 8 cost time: 0.5517163276672363
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2880924 Best vali loss: 0.2781756

best validation loss 0.2781756071130686

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.002796377656, 'e_layers': 2, 'learning_rate': 0.000180696177, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3289637
	speed: 0.0158s/iter; left time: 31.5530s
	iters: 200, epoch: 1 | loss: 0.7124329
	speed: 0.0110s/iter; left time: 20.9437s
Updating learning rate to 0.00017381883826666835
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 3.1056108474731445
Epoch: 1, Steps: 262 | Train Loss: 0.5206983 Vali Loss: 0.2836262 Best vali loss: 0.2836262
	iters: 100, epoch: 2 | loss: 0.5112398
	speed: 0.0288s/iter; left time: 50.0151s
	iters: 200, epoch: 2 | loss: 0.3641827
	speed: 0.0102s/iter; left time: 16.6414s
Updating learning rate to 0.0001542338345455923
Validation loss decreased (0.2836 --> 0.2795).  Saving model state dict ...
Epoch: 2 cost time: 2.5825438499450684
Epoch: 2, Steps: 262 | Train Loss: 0.4377112 Vali Loss: 0.2795389 Best vali loss: 0.2795389
	iters: 100, epoch: 3 | loss: 0.3028554
	speed: 0.0318s/iter; left time: 46.8682s
	iters: 200, epoch: 3 | loss: 0.3542611
	speed: 0.0089s/iter; left time: 12.2253s
Updating learning rate to 0.0001249228051148049
Validation loss decreased (0.2795 --> 0.2756).  Saving model state dict ...
Epoch: 3 cost time: 2.51053524017334
Epoch: 3, Steps: 262 | Train Loss: 0.3285582 Vali Loss: 0.2755987 Best vali loss: 0.2755987
	iters: 100, epoch: 4 | loss: 0.3438487
	speed: 0.0238s/iter; left time: 28.7782s
	iters: 200, epoch: 4 | loss: 0.4354759
	speed: 0.0099s/iter; left time: 11.0259s
Updating learning rate to 9.03480885e-05
Epoch: 4 cost time: 2.6803958415985107
Epoch: 4, Steps: 262 | Train Loss: 0.3896623 Vali Loss: 0.2836145 Best vali loss: 0.2755987
	iters: 100, epoch: 5 | loss: 0.4789009
	speed: 0.0268s/iter; left time: 25.4663s
	iters: 200, epoch: 5 | loss: 0.5024898
	speed: 0.0120s/iter; left time: 10.2114s
Updating learning rate to 5.5773371885195106e-05
Epoch: 5 cost time: 3.1171813011169434
Epoch: 5, Steps: 262 | Train Loss: 0.4906954 Vali Loss: 0.2860963 Best vali loss: 0.2755987
	iters: 100, epoch: 6 | loss: 0.5340464
	speed: 0.0445s/iter; left time: 30.5678s
	iters: 200, epoch: 6 | loss: 0.4005444
	speed: 0.0131s/iter; left time: 7.6791s
Updating learning rate to 2.6462342454407674e-05
Epoch: 6 cost time: 3.5989322662353516
Epoch: 6, Steps: 262 | Train Loss: 0.4672954 Vali Loss: 0.2878069 Best vali loss: 0.2755987
	iters: 100, epoch: 7 | loss: 0.3526384
	speed: 0.0565s/iter; left time: 24.0301s
	iters: 200, epoch: 7 | loss: 0.2907533
	speed: 0.0128s/iter; left time: 4.1556s
Updating learning rate to 6.877338733331638e-06
Epoch: 7 cost time: 3.846256971359253
Epoch: 7, Steps: 262 | Train Loss: 0.3216959 Vali Loss: 0.2943496 Best vali loss: 0.2755987
	iters: 100, epoch: 8 | loss: 0.2302119
	speed: 0.0446s/iter; left time: 7.2629s
	iters: 200, epoch: 8 | loss: 0.2472761
	speed: 0.0128s/iter; left time: 0.8069s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5896706581115723
Epoch: 8, Steps: 262 | Train Loss: 0.2387440 Vali Loss: 0.2924714 Best vali loss: 0.2755987

best validation loss 0.2755986511951133

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0013804571049, 'e_layers': 2, 'learning_rate': 0.0001039870979, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6961624
	speed: 0.0161s/iter; left time: 133.2042s
	iters: 200, epoch: 1 | loss: 0.2435313
	speed: 0.0079s/iter; left time: 64.7900s
	iters: 300, epoch: 1 | loss: 0.3905291
	speed: 0.0092s/iter; left time: 74.2141s
	iters: 400, epoch: 1 | loss: 0.2282521
	speed: 0.0086s/iter; left time: 68.3410s
	iters: 500, epoch: 1 | loss: 0.8226168
	speed: 0.0067s/iter; left time: 52.6679s
	iters: 600, epoch: 1 | loss: 0.2545715
	speed: 0.0060s/iter; left time: 46.9333s
	iters: 700, epoch: 1 | loss: 0.6412836
	speed: 0.0074s/iter; left time: 57.0141s
	iters: 800, epoch: 1 | loss: 0.4035866
	speed: 0.0090s/iter; left time: 68.1807s
	iters: 900, epoch: 1 | loss: 0.3369057
	speed: 0.0071s/iter; left time: 53.1463s
	iters: 1000, epoch: 1 | loss: 1.1385771
	speed: 0.0065s/iter; left time: 47.5464s
Updating learning rate to 0.0001039870979
Validation loss decreased (inf --> 0.2795).  Saving model state dict ...
Epoch: 1 cost time: 8.473057508468628
Epoch: 1, Steps: 1045 | Train Loss: 0.5156016 Vali Loss: 0.2795421 Best vali loss: 0.2795421
	iters: 100, epoch: 2 | loss: 0.7411758
	speed: 0.0232s/iter; left time: 167.5180s
	iters: 200, epoch: 2 | loss: 0.2432366
	speed: 0.0078s/iter; left time: 55.3553s
	iters: 300, epoch: 2 | loss: 0.2994992
	speed: 0.0081s/iter; left time: 57.0517s
	iters: 400, epoch: 2 | loss: 0.4483596
	speed: 0.0077s/iter; left time: 53.0332s
	iters: 500, epoch: 2 | loss: 1.3188087
	speed: 0.0069s/iter; left time: 46.8436s
	iters: 600, epoch: 2 | loss: 0.3636438
	speed: 0.0059s/iter; left time: 39.7967s
	iters: 700, epoch: 2 | loss: 0.4559946
	speed: 0.0068s/iter; left time: 45.2921s
	iters: 800, epoch: 2 | loss: 1.1486777
	speed: 0.0067s/iter; left time: 43.5927s
	iters: 900, epoch: 2 | loss: 0.4930332
	speed: 0.0060s/iter; left time: 38.6782s
	iters: 1000, epoch: 2 | loss: 0.6610501
	speed: 0.0057s/iter; left time: 35.7054s
Updating learning rate to 5.199354895e-05
Epoch: 2 cost time: 7.135559320449829
Epoch: 2, Steps: 1045 | Train Loss: 0.6173479 Vali Loss: 0.2826674 Best vali loss: 0.2795421
	iters: 100, epoch: 3 | loss: 0.2512656
	speed: 0.0252s/iter; left time: 155.4931s
	iters: 200, epoch: 3 | loss: 0.8716338
	speed: 0.0070s/iter; left time: 42.4392s
	iters: 300, epoch: 3 | loss: 0.2589965
	speed: 0.0071s/iter; left time: 42.6482s
	iters: 400, epoch: 3 | loss: 0.1670104
	speed: 0.0065s/iter; left time: 38.2788s
	iters: 500, epoch: 3 | loss: 0.6304451
	speed: 0.0069s/iter; left time: 39.5549s
	iters: 600, epoch: 3 | loss: 0.4384370
	speed: 0.0067s/iter; left time: 37.7850s
	iters: 700, epoch: 3 | loss: 0.9239349
	speed: 0.0063s/iter; left time: 34.8347s
	iters: 800, epoch: 3 | loss: 0.4656937
	speed: 0.0066s/iter; left time: 35.9277s
	iters: 900, epoch: 3 | loss: 0.2192893
	speed: 0.0069s/iter; left time: 36.9453s
	iters: 1000, epoch: 3 | loss: 0.5081613
	speed: 0.0070s/iter; left time: 36.6936s
Updating learning rate to 2.5996774475e-05
Validation loss decreased (0.2795 --> 0.2778).  Saving model state dict ...
Epoch: 3 cost time: 7.155300855636597
Epoch: 3, Steps: 1045 | Train Loss: 0.4734868 Vali Loss: 0.2777561 Best vali loss: 0.2777561
	iters: 100, epoch: 4 | loss: 0.8200921
	speed: 0.0248s/iter; left time: 127.0154s
	iters: 200, epoch: 4 | loss: 0.4219256
	speed: 0.0071s/iter; left time: 35.6426s
	iters: 300, epoch: 4 | loss: 0.3646281
	speed: 0.0067s/iter; left time: 33.0069s
	iters: 400, epoch: 4 | loss: 0.4050610
	speed: 0.0059s/iter; left time: 28.2454s
	iters: 500, epoch: 4 | loss: 0.2168767
	speed: 0.0057s/iter; left time: 26.7318s
	iters: 600, epoch: 4 | loss: 0.9267311
	speed: 0.0068s/iter; left time: 31.3494s
	iters: 700, epoch: 4 | loss: 0.2370388
	speed: 0.0060s/iter; left time: 27.3749s
	iters: 800, epoch: 4 | loss: 0.3321316
	speed: 0.0056s/iter; left time: 24.7242s
	iters: 900, epoch: 4 | loss: 0.1941607
	speed: 0.0055s/iter; left time: 23.6137s
	iters: 1000, epoch: 4 | loss: 0.2776129
	speed: 0.0072s/iter; left time: 30.2491s
Updating learning rate to 1.29983872375e-05
Epoch: 4 cost time: 6.642330169677734
Epoch: 4, Steps: 1045 | Train Loss: 0.4196259 Vali Loss: 0.2873240 Best vali loss: 0.2777561
	iters: 100, epoch: 5 | loss: 0.5090567
	speed: 0.0249s/iter; left time: 101.4525s
	iters: 200, epoch: 5 | loss: 0.3897291
	speed: 0.0077s/iter; left time: 30.7775s
	iters: 300, epoch: 5 | loss: 0.6819175
	speed: 0.0075s/iter; left time: 29.2478s
	iters: 400, epoch: 5 | loss: 0.2565289
	speed: 0.0064s/iter; left time: 24.2647s
	iters: 500, epoch: 5 | loss: 0.7104998
	speed: 0.0073s/iter; left time: 26.9470s
	iters: 600, epoch: 5 | loss: 0.5232690
	speed: 0.0079s/iter; left time: 28.3984s
	iters: 700, epoch: 5 | loss: 0.8450515
	speed: 0.0080s/iter; left time: 27.8276s
	iters: 800, epoch: 5 | loss: 0.3189123
	speed: 0.0075s/iter; left time: 25.2311s
	iters: 900, epoch: 5 | loss: 0.3293757
	speed: 0.0066s/iter; left time: 21.4975s
	iters: 1000, epoch: 5 | loss: 0.6411942
	speed: 0.0074s/iter; left time: 23.5326s
Updating learning rate to 6.49919361875e-06
Epoch: 5 cost time: 7.794493198394775
Epoch: 5, Steps: 1045 | Train Loss: 0.5205535 Vali Loss: 0.2881513 Best vali loss: 0.2777561
	iters: 100, epoch: 6 | loss: 0.2346544
	speed: 0.0264s/iter; left time: 80.2076s
	iters: 200, epoch: 6 | loss: 0.7153415
	speed: 0.0054s/iter; left time: 15.7538s
	iters: 300, epoch: 6 | loss: 0.2161984
	speed: 0.0057s/iter; left time: 16.1839s
	iters: 400, epoch: 6 | loss: 0.2641706
	speed: 0.0066s/iter; left time: 17.9655s
	iters: 500, epoch: 6 | loss: 0.3180398
	speed: 0.0063s/iter; left time: 16.5698s
	iters: 600, epoch: 6 | loss: 0.3260753
	speed: 0.0061s/iter; left time: 15.5793s
	iters: 700, epoch: 6 | loss: 0.2533620
	speed: 0.0064s/iter; left time: 15.5787s
	iters: 800, epoch: 6 | loss: 0.5960616
	speed: 0.0069s/iter; left time: 16.1955s
	iters: 900, epoch: 6 | loss: 0.2388094
	speed: 0.0074s/iter; left time: 16.5623s
	iters: 1000, epoch: 6 | loss: 0.3627667
	speed: 0.0070s/iter; left time: 15.0310s
Updating learning rate to 3.249596809375e-06
Epoch: 6 cost time: 6.71757173538208
Epoch: 6, Steps: 1045 | Train Loss: 0.3525480 Vali Loss: 0.2924945 Best vali loss: 0.2777561
	iters: 100, epoch: 7 | loss: 0.5881563
	speed: 0.0213s/iter; left time: 42.4684s
	iters: 200, epoch: 7 | loss: 0.5162233
	speed: 0.0055s/iter; left time: 10.4578s
	iters: 300, epoch: 7 | loss: 0.1996202
	speed: 0.0068s/iter; left time: 12.2333s
	iters: 400, epoch: 7 | loss: 0.2296449
	speed: 0.0066s/iter; left time: 11.0987s
	iters: 500, epoch: 7 | loss: 1.3197545
	speed: 0.0066s/iter; left time: 10.4666s
	iters: 600, epoch: 7 | loss: 0.3585421
	speed: 0.0069s/iter; left time: 10.3530s
	iters: 700, epoch: 7 | loss: 0.3590512
	speed: 0.0070s/iter; left time: 9.7763s
	iters: 800, epoch: 7 | loss: 0.3461884
	speed: 0.0070s/iter; left time: 8.9799s
	iters: 900, epoch: 7 | loss: 0.4519941
	speed: 0.0069s/iter; left time: 8.2144s
	iters: 1000, epoch: 7 | loss: 0.2813558
	speed: 0.0069s/iter; left time: 7.5620s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012374140538, 'e_layers': 2, 'learning_rate': 0.0005328478516, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5984967
	speed: 0.0104s/iter; left time: 9.8481s
Updating learning rate to 0.0005328478516
Validation loss decreased (inf --> 0.2919).  Saving model state dict ...
Epoch: 1 cost time: 0.8557615280151367
Epoch: 1, Steps: 131 | Train Loss: 0.5984967 Vali Loss: 0.2918610 Best vali loss: 0.2918610
	iters: 100, epoch: 2 | loss: 0.4488603
	speed: 0.0108s/iter; left time: 8.8131s
Updating learning rate to 0.0002664239258
Validation loss decreased (0.2919 --> 0.2852).  Saving model state dict ...
Epoch: 2 cost time: 1.0367579460144043
Epoch: 2, Steps: 131 | Train Loss: 0.4488603 Vali Loss: 0.2852314 Best vali loss: 0.2852314
	iters: 100, epoch: 3 | loss: 0.8450987
	speed: 0.0198s/iter; left time: 13.5893s
Updating learning rate to 0.0001332119629
Epoch: 3 cost time: 2.0061230659484863
Epoch: 3, Steps: 131 | Train Loss: 0.8450987 Vali Loss: 0.2853079 Best vali loss: 0.2852314

best validation loss 0.28523138208697835

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0015741066868, 'e_layers': 2, 'learning_rate': 0.0004190340966, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5716001
	speed: 0.0195s/iter; left time: 38.9516s
	iters: 200, epoch: 1 | loss: 0.5061761
	speed: 0.0114s/iter; left time: 21.5334s
Updating learning rate to 0.0004030855609365487
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 3.415675640106201
Epoch: 1, Steps: 262 | Train Loss: 0.5388881 Vali Loss: 0.2900647 Best vali loss: 0.2900647
	iters: 100, epoch: 2 | loss: 0.4464763
	speed: 0.0299s/iter; left time: 51.8944s
	iters: 200, epoch: 2 | loss: 0.4629527
	speed: 0.0110s/iter; left time: 17.9325s
Updating learning rate to 0.0003576679739271194
Validation loss decreased (0.2901 --> 0.2816).  Saving model state dict ...
Epoch: 2 cost time: 2.861285448074341
Epoch: 2, Steps: 262 | Train Loss: 0.4547145 Vali Loss: 0.2816149 Best vali loss: 0.2816149
	iters: 100, epoch: 3 | loss: 0.3375055
	speed: 0.0226s/iter; left time: 33.3320s
	iters: 200, epoch: 3 | loss: 0.3998422
	speed: 0.0057s/iter; left time: 7.7747s
Updating learning rate to 0.00028969575148244634
Validation loss decreased (0.2816 --> 0.2810).  Saving model state dict ...
Epoch: 3 cost time: 1.8502552509307861
Epoch: 3, Steps: 262 | Train Loss: 0.3686738 Vali Loss: 0.2809763 Best vali loss: 0.2809763

best validation loss 0.2809762706451586

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023549867609129905
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 0.9305524826049805
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2830656 Best vali loss: 0.2830656
Updating learning rate to 0.00020896390866591454
Validation loss decreased (0.2831 --> 0.2791).  Saving model state dict ...
Epoch: 2 cost time: 0.6542642116546631
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2791473 Best vali loss: 0.2791473
Updating learning rate to 0.00016925182282609557
Epoch: 3 cost time: 0.6783835887908936
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2808362 Best vali loss: 0.2791473

best validation loss 0.27914733449935736

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00012240822365
Epoch: 4 cost time: 0.956960916519165
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2824065 Best vali loss: 0.2791473
Updating learning rate to 7.556462447390446e-05
Epoch: 5 cost time: 0.6344509124755859
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2822009 Best vali loss: 0.2791473
Updating learning rate to 3.585253863408549e-05
Epoch: 6 cost time: 0.6514668464660645
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2849204 Best vali loss: 0.2791473
Updating learning rate to 9.317771208700968e-06
Epoch: 7 cost time: 0.6708931922912598
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2855159 Best vali loss: 0.2791473
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1195862293243408
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2846872 Best vali loss: 0.2791473

best validation loss 0.27914733449935736

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0045898741473, 'e_layers': 3, 'learning_rate': 8.80328986e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7781264
	speed: 0.0149s/iter; left time: 14.1071s
Updating learning rate to 8.468234590209076e-05
Validation loss decreased (inf --> 0.3357).  Saving model state dict ...
Epoch: 1 cost time: 1.443937063217163
Epoch: 1, Steps: 131 | Train Loss: 0.7781264 Vali Loss: 0.3357086 Best vali loss: 0.3357086
	iters: 100, epoch: 2 | loss: 0.5646057
	speed: 0.0139s/iter; left time: 11.3964s
Updating learning rate to 7.514077908378387e-05
Validation loss decreased (0.3357 --> 0.3185).  Saving model state dict ...
Epoch: 2 cost time: 1.1337535381317139
Epoch: 2, Steps: 131 | Train Loss: 0.5646057 Vali Loss: 0.3185291 Best vali loss: 0.3185291
	iters: 100, epoch: 3 | loss: 0.4051793
	speed: 0.0140s/iter; left time: 9.6045s
Updating learning rate to 6.086081519864796e-05
Validation loss decreased (0.3185 --> 0.3092).  Saving model state dict ...
Epoch: 3 cost time: 1.1068789958953857
Epoch: 3, Steps: 131 | Train Loss: 0.4051793 Vali Loss: 0.3091759 Best vali loss: 0.3091759
	iters: 100, epoch: 4 | loss: 0.4583541
	speed: 0.0137s/iter; left time: 7.6370s
Updating learning rate to 4.40164493e-05
Validation loss decreased (0.3092 --> 0.3038).  Saving model state dict ...
Epoch: 4 cost time: 1.1329867839813232
Epoch: 4, Steps: 131 | Train Loss: 0.4583541 Vali Loss: 0.3037576 Best vali loss: 0.3037576
	iters: 100, epoch: 5 | loss: 0.6021118
	speed: 0.0139s/iter; left time: 5.9254s
Updating learning rate to 2.717208340135205e-05
Validation loss decreased (0.3038 --> 0.3004).  Saving model state dict ...
Epoch: 5 cost time: 1.1584570407867432
Epoch: 5, Steps: 131 | Train Loss: 0.6021118 Vali Loss: 0.3004372 Best vali loss: 0.3004372
	iters: 100, epoch: 6 | loss: 0.6181266
	speed: 0.0198s/iter; left time: 5.8106s
Updating learning rate to 1.289211951621614e-05
Validation loss decreased (0.3004 --> 0.2991).  Saving model state dict ...
Epoch: 6 cost time: 1.7071599960327148
Epoch: 6, Steps: 131 | Train Loss: 0.6181266 Vali Loss: 0.2990654 Best vali loss: 0.2990654
	iters: 100, epoch: 7 | loss: 0.5713655
	speed: 0.0140s/iter; left time: 2.2780s
Updating learning rate to 3.350552697909246e-06
Validation loss decreased (0.2991 --> 0.2985).  Saving model state dict ...
Epoch: 7 cost time: 1.1294713020324707
Epoch: 7, Steps: 131 | Train Loss: 0.5713655 Vali Loss: 0.2984746 Best vali loss: 0.2984746
	iters: 100, epoch: 8 | loss: 0.3105156
	speed: 0.0137s/iter; left time: 0.4378s
Updating learning rate to 0.0
Validation loss decreased (0.2985 --> 0.2983).  Saving model state dict ...
Epoch: 8 cost time: 1.1231162548065186
Epoch: 8, Steps: 131 | Train Loss: 0.3105156 Vali Loss: 0.2983314 Best vali loss: 0.2983314

best validation loss 0.2983313965981403

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0016405367883, 'e_layers': 4, 'learning_rate': 0.0022174372635, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0021330410829377435
Validation loss decreased (inf --> 0.2889).  Saving model state dict ...
Epoch: 1 cost time: 1.0662815570831299
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2889154 Best vali loss: 0.2889154
Updating learning rate to 0.0018927010946882957
Epoch: 2 cost time: 0.7414300441741943
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2933466 Best vali loss: 0.2889154
Updating learning rate to 0.0015330068832752162
Epoch: 3 cost time: 0.7422783374786377
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2948772 Best vali loss: 0.2889154
Updating learning rate to 0.00110871863175
Validation loss decreased (0.2889 --> 0.2847).  Saving model state dict ...
Epoch: 4 cost time: 0.7199037075042725
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2846809 Best vali loss: 0.2846809
Updating learning rate to 0.000684430380224784
Epoch: 5 cost time: 0.8872199058532715
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2879486 Best vali loss: 0.2846809
Updating learning rate to 0.00032473616881170447
Epoch: 6 cost time: 0.9105970859527588
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2925634 Best vali loss: 0.2846809
Updating learning rate to 8.439618056225654e-05
Epoch: 7 cost time: 0.7624523639678955
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2933358 Best vali loss: 0.2846809
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7479093074798584
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2916996 Best vali loss: 0.2846809

best validation loss 0.2846809443364847

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0017817725653, 'e_layers': 3, 'learning_rate': 7.88264833e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5706516
	speed: 0.0147s/iter; left time: 13.9477s
Updating learning rate to 7.88264833e-05
Validation loss decreased (inf --> 0.3360).  Saving model state dict ...
Epoch: 1 cost time: 1.4264864921569824
Epoch: 1, Steps: 131 | Train Loss: 0.5706516 Vali Loss: 0.3360490 Best vali loss: 0.3360490
	iters: 100, epoch: 2 | loss: 0.4751220
	speed: 0.0136s/iter; left time: 11.1443s
Updating learning rate to 3.941324165e-05
Validation loss decreased (0.3360 --> 0.3194).  Saving model state dict ...
Epoch: 2 cost time: 1.1474189758300781
Epoch: 2, Steps: 131 | Train Loss: 0.4751220 Vali Loss: 0.3193570 Best vali loss: 0.3193570
	iters: 100, epoch: 3 | loss: 0.5284786
	speed: 0.0180s/iter; left time: 12.3501s
Updating learning rate to 1.9706620825e-05
Validation loss decreased (0.3194 --> 0.3138).  Saving model state dict ...
Epoch: 3 cost time: 1.4745516777038574
Epoch: 3, Steps: 131 | Train Loss: 0.5284786 Vali Loss: 0.3138451 Best vali loss: 0.3138451

best validation loss 0.3138450615110784

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.001090227289, 'e_layers': 1, 'learning_rate': 7.24352627e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2590468
	speed: 0.0134s/iter; left time: 110.5600s
	iters: 200, epoch: 1 | loss: 0.3783195
	speed: 0.0060s/iter; left time: 48.8867s
	iters: 300, epoch: 1 | loss: 0.4654821
	speed: 0.0060s/iter; left time: 48.6643s
	iters: 400, epoch: 1 | loss: 0.4955912
	speed: 0.0067s/iter; left time: 53.0902s
	iters: 500, epoch: 1 | loss: 1.0634360
	speed: 0.0069s/iter; left time: 54.3688s
	iters: 600, epoch: 1 | loss: 0.1861117
	speed: 0.0060s/iter; left time: 46.7681s
	iters: 700, epoch: 1 | loss: 0.2856914
	speed: 0.0060s/iter; left time: 46.2809s
	iters: 800, epoch: 1 | loss: 1.2586677
	speed: 0.0063s/iter; left time: 47.7841s
	iters: 900, epoch: 1 | loss: 0.7920452
	speed: 0.0065s/iter; left time: 48.6956s
	iters: 1000, epoch: 1 | loss: 0.2024455
	speed: 0.0059s/iter; left time: 43.4060s
Updating learning rate to 7.24352627e-05
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 6.8729939460754395
Epoch: 1, Steps: 1045 | Train Loss: 0.5386837 Vali Loss: 0.2760877 Best vali loss: 0.2760877
	iters: 100, epoch: 2 | loss: 0.3647883
	speed: 0.0242s/iter; left time: 174.6803s
	iters: 200, epoch: 2 | loss: 0.2561255
	speed: 0.0060s/iter; left time: 42.6153s
	iters: 300, epoch: 2 | loss: 0.2577800
	speed: 0.0068s/iter; left time: 47.6016s
	iters: 400, epoch: 2 | loss: 0.3332819
	speed: 0.0070s/iter; left time: 48.6521s
	iters: 500, epoch: 2 | loss: 0.6564231
	speed: 0.0057s/iter; left time: 38.7297s
	iters: 600, epoch: 2 | loss: 0.2884870
	speed: 0.0070s/iter; left time: 46.9877s
	iters: 700, epoch: 2 | loss: 0.2670782
	speed: 0.0066s/iter; left time: 43.9562s
	iters: 800, epoch: 2 | loss: 0.2876830
	speed: 0.0066s/iter; left time: 43.2908s
	iters: 900, epoch: 2 | loss: 0.7669719
	speed: 0.0053s/iter; left time: 33.8841s
	iters: 1000, epoch: 2 | loss: 0.4053861
	speed: 0.0066s/iter; left time: 41.6649s
Updating learning rate to 3.621763135e-05
Epoch: 2 cost time: 6.666819334030151
Epoch: 2, Steps: 1045 | Train Loss: 0.3884005 Vali Loss: 0.2785586 Best vali loss: 0.2760877
	iters: 100, epoch: 3 | loss: 0.4292557
	speed: 0.0248s/iter; left time: 153.2411s
	iters: 200, epoch: 3 | loss: 2.1514776
	speed: 0.0064s/iter; left time: 38.7812s
	iters: 300, epoch: 3 | loss: 0.4241234
	speed: 0.0063s/iter; left time: 37.4973s
	iters: 400, epoch: 3 | loss: 1.2384448
	speed: 0.0046s/iter; left time: 26.9742s
	iters: 500, epoch: 3 | loss: 0.1856607
	speed: 0.0032s/iter; left time: 18.5804s
	iters: 600, epoch: 3 | loss: 0.3887579
	speed: 0.0029s/iter; left time: 16.2196s
	iters: 700, epoch: 3 | loss: 0.5930692
	speed: 0.0039s/iter; left time: 21.8424s
	iters: 800, epoch: 3 | loss: 0.3922653
	speed: 0.0063s/iter; left time: 34.5187s
	iters: 900, epoch: 3 | loss: 0.1421680
	speed: 0.0056s/iter; left time: 29.8154s
	iters: 1000, epoch: 3 | loss: 0.3801470
	speed: 0.0048s/iter; left time: 25.3117s
Updating learning rate to 1.8108815675e-05
Epoch: 3 cost time: 5.240608215332031
Epoch: 3, Steps: 1045 | Train Loss: 0.6325370 Vali Loss: 0.2849321 Best vali loss: 0.2760877

best validation loss 0.27608767504827736

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.004560693568, 'e_layers': 4, 'learning_rate': 0.000570919504, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3876798
	speed: 0.0155s/iter; left time: 63.2883s
	iters: 200, epoch: 1 | loss: 0.2709477
	speed: 0.0082s/iter; left time: 32.4883s
	iters: 300, epoch: 1 | loss: 1.2968495
	speed: 0.0101s/iter; left time: 39.2354s
	iters: 400, epoch: 1 | loss: 0.8058116
	speed: 0.0099s/iter; left time: 37.4774s
	iters: 500, epoch: 1 | loss: 0.3564982
	speed: 0.0084s/iter; left time: 30.8838s
Updating learning rate to 0.0005491901742285478
Validation loss decreased (inf --> 0.2894).  Saving model state dict ...
Epoch: 1 cost time: 5.072921514511108
Epoch: 1, Steps: 523 | Train Loss: 0.6235574 Vali Loss: 0.2893538 Best vali loss: 0.2893538
	iters: 100, epoch: 2 | loss: 0.7407576
	speed: 0.0231s/iter; left time: 82.2177s
	iters: 200, epoch: 2 | loss: 0.2477409
	speed: 0.0134s/iter; left time: 46.3193s
	iters: 300, epoch: 2 | loss: 1.1672771
	speed: 0.0134s/iter; left time: 45.1891s
	iters: 400, epoch: 2 | loss: 0.2939462
	speed: 0.0112s/iter; left time: 36.3798s
	iters: 500, epoch: 2 | loss: 0.4172806
	speed: 0.0085s/iter; left time: 26.7243s
Updating learning rate to 0.0004873102783950301
Validation loss decreased (0.2894 --> 0.2840).  Saving model state dict ...
Epoch: 2 cost time: 5.99105429649353
Epoch: 2, Steps: 523 | Train Loss: 0.5734005 Vali Loss: 0.2839746 Best vali loss: 0.2839746
	iters: 100, epoch: 3 | loss: 0.3978678
	speed: 0.0190s/iter; left time: 57.8692s
	iters: 200, epoch: 3 | loss: 0.3670054
	speed: 0.0089s/iter; left time: 26.2976s
	iters: 300, epoch: 3 | loss: 0.5408067
	speed: 0.0080s/iter; left time: 22.5861s
	iters: 400, epoch: 3 | loss: 0.6864350
	speed: 0.0144s/iter; left time: 39.4268s
	iters: 500, epoch: 3 | loss: 1.3788971
	speed: 0.0143s/iter; left time: 37.8547s
Updating learning rate to 0.0003947004696974473
Epoch: 3 cost time: 5.791620254516602
Epoch: 3, Steps: 523 | Train Loss: 0.6742024 Vali Loss: 0.2922835 Best vali loss: 0.2839746

best validation loss 0.28397462252969413

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.001090227289, 'e_layers': 1, 'learning_rate': 7.24352627e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.1575376
	speed: 0.0140s/iter; left time: 71.8183s
	iters: 200, epoch: 4 | loss: 0.3560985
	speed: 0.0079s/iter; left time: 39.5455s
	iters: 300, epoch: 4 | loss: 0.4874045
	speed: 0.0077s/iter; left time: 38.0773s
	iters: 400, epoch: 4 | loss: 0.4797445
	speed: 0.0083s/iter; left time: 40.2803s
	iters: 500, epoch: 4 | loss: 0.9049526
	speed: 0.0052s/iter; left time: 24.4803s
	iters: 600, epoch: 4 | loss: 0.1769950
	speed: 0.0043s/iter; left time: 19.6770s
	iters: 700, epoch: 4 | loss: 0.2509426
	speed: 0.0044s/iter; left time: 20.0333s
	iters: 800, epoch: 4 | loss: 0.6707358
	speed: 0.0044s/iter; left time: 19.6059s
	iters: 900, epoch: 4 | loss: 0.7933346
	speed: 0.0045s/iter; left time: 19.5444s
	iters: 1000, epoch: 4 | loss: 0.1861300
	speed: 0.0045s/iter; left time: 19.0940s
Updating learning rate to 9.0544078375e-06
Epoch: 4 cost time: 6.408239364624023
Epoch: 4, Steps: 1045 | Train Loss: 0.4463876 Vali Loss: 0.2860131 Best vali loss: 0.2760877
	iters: 100, epoch: 5 | loss: 0.3611075
	speed: 0.0244s/iter; left time: 99.6953s
	iters: 200, epoch: 5 | loss: 0.2622826
	speed: 0.0047s/iter; left time: 18.5865s
	iters: 300, epoch: 5 | loss: 0.2217920
	speed: 0.0056s/iter; left time: 21.8349s
	iters: 400, epoch: 5 | loss: 0.3155957
	speed: 0.0047s/iter; left time: 17.6649s
	iters: 500, epoch: 5 | loss: 0.5933579
	speed: 0.0054s/iter; left time: 19.9629s
	iters: 600, epoch: 5 | loss: 0.2565417
	speed: 0.0048s/iter; left time: 17.3291s
	iters: 700, epoch: 5 | loss: 0.2371110
	speed: 0.0051s/iter; left time: 17.6786s
	iters: 800, epoch: 5 | loss: 0.2938084
	speed: 0.0066s/iter; left time: 22.4043s
	iters: 900, epoch: 5 | loss: 0.7576253
	speed: 0.0061s/iter; left time: 20.0136s
	iters: 1000, epoch: 5 | loss: 0.3152016
	speed: 0.0065s/iter; left time: 20.7505s
Updating learning rate to 4.52720391875e-06
Epoch: 5 cost time: 5.944123029708862
Epoch: 5, Steps: 1045 | Train Loss: 0.3614424 Vali Loss: 0.2865672 Best vali loss: 0.2760877
	iters: 100, epoch: 6 | loss: 0.3606279
	speed: 0.0242s/iter; left time: 73.3380s
	iters: 200, epoch: 6 | loss: 1.7882037
	speed: 0.0064s/iter; left time: 18.6929s
	iters: 300, epoch: 6 | loss: 0.3589585
	speed: 0.0065s/iter; left time: 18.4013s
	iters: 400, epoch: 6 | loss: 1.1514314
	speed: 0.0048s/iter; left time: 13.1656s
	iters: 500, epoch: 6 | loss: 0.1845645
	speed: 0.0054s/iter; left time: 14.1174s
	iters: 600, epoch: 6 | loss: 0.3606448
	speed: 0.0052s/iter; left time: 13.1158s
	iters: 700, epoch: 6 | loss: 0.5492176
	speed: 0.0061s/iter; left time: 14.8920s
	iters: 800, epoch: 6 | loss: 0.3691135
	speed: 0.0049s/iter; left time: 11.3413s
	iters: 900, epoch: 6 | loss: 0.1432379
	speed: 0.0044s/iter; left time: 9.8411s
	iters: 1000, epoch: 6 | loss: 0.3448876
	speed: 0.0053s/iter; left time: 11.3087s
Updating learning rate to 2.263601959375e-06
Epoch: 6 cost time: 5.79588508605957
Epoch: 6, Steps: 1045 | Train Loss: 0.5610887 Vali Loss: 0.2889306 Best vali loss: 0.2760877
	iters: 100, epoch: 7 | loss: 0.5531787
	speed: 0.0275s/iter; left time: 54.7037s
	iters: 200, epoch: 7 | loss: 0.8945447
	speed: 0.0063s/iter; left time: 11.9399s
	iters: 300, epoch: 7 | loss: 1.1841605
	speed: 0.0059s/iter; left time: 10.6433s
	iters: 400, epoch: 7 | loss: 0.2690900
	speed: 0.0056s/iter; left time: 9.5179s
	iters: 500, epoch: 7 | loss: 0.6489453
	speed: 0.0058s/iter; left time: 9.1725s
	iters: 600, epoch: 7 | loss: 0.1838965
	speed: 0.0052s/iter; left time: 7.7241s
	iters: 700, epoch: 7 | loss: 0.3953074
	speed: 0.0043s/iter; left time: 6.0336s
	iters: 800, epoch: 7 | loss: 0.7587552
	speed: 0.0044s/iter; left time: 5.6861s
	iters: 900, epoch: 7 | loss: 0.2983531
	speed: 0.0061s/iter; left time: 7.2112s
	iters: 1000, epoch: 7 | loss: 0.2559262
	speed: 0.0062s/iter; left time: 6.7800s
Updating learning rate to 1.1318009796875e-06
Epoch: 7 cost time: 5.961273431777954
Epoch: 7, Steps: 1045 | Train Loss: 0.5442158 Vali Loss: 0.2902358 Best vali loss: 0.2760877
	iters: 100, epoch: 8 | loss: 0.2542596
	speed: 0.0267s/iter; left time: 25.2740s
	iters: 200, epoch: 8 | loss: 0.7240599
	speed: 0.0059s/iter; left time: 4.9668s
	iters: 300, epoch: 8 | loss: 0.5615747
	speed: 0.0056s/iter; left time: 4.1933s
	iters: 400, epoch: 8 | loss: 0.5847921
	speed: 0.0057s/iter; left time: 3.6958s
	iters: 500, epoch: 8 | loss: 0.2742871
	speed: 0.0041s/iter; left time: 2.2502s
	iters: 600, epoch: 8 | loss: 1.1341411
	speed: 0.0045s/iter; left time: 2.0157s
	iters: 700, epoch: 8 | loss: 0.7875532
	speed: 0.0063s/iter; left time: 2.1763s
	iters: 800, epoch: 8 | loss: 0.1630361
	speed: 0.0066s/iter; left time: 1.6258s
	iters: 900, epoch: 8 | loss: 1.5237703
	speed: 0.0066s/iter; left time: 0.9577s
	iters: 1000, epoch: 8 | loss: 0.3947705
	speed: 0.0065s/iter; left time: 0.3001s
Updating learning rate to 5.6590048984375e-07
Epoch: 8 cost time: 6.133577108383179
Epoch: 8, Steps: 1045 | Train Loss: 0.6402245 Vali Loss: 0.2894566 Best vali loss: 0.2760877

best validation loss 0.27608767504827736

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0100677936462, 'e_layers': 3, 'learning_rate': 0.0045194959856, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6018333
	speed: 0.0204s/iter; left time: 19.3311s
Updating learning rate to 0.0043474829119813825
Validation loss decreased (inf --> 0.3206).  Saving model state dict ...
Epoch: 1 cost time: 2.2100772857666016
Epoch: 1, Steps: 131 | Train Loss: 0.6018333 Vali Loss: 0.3206309 Best vali loss: 0.3206309
	iters: 100, epoch: 2 | loss: 0.5452582
	speed: 0.0247s/iter; left time: 20.2155s
Updating learning rate to 0.0038576311222815697
Epoch: 2 cost time: 2.0110392570495605
Epoch: 2, Steps: 131 | Train Loss: 0.5452582 Vali Loss: 0.3309227 Best vali loss: 0.3206309
	iters: 100, epoch: 3 | loss: 0.4625557
	speed: 0.0237s/iter; left time: 16.2756s
Updating learning rate to 0.0031245161109648262
Epoch: 3 cost time: 1.9200890064239502
Epoch: 3, Steps: 131 | Train Loss: 0.4625557 Vali Loss: 0.3260801 Best vali loss: 0.3206309
	iters: 100, epoch: 4 | loss: 0.6555654
	speed: 0.0247s/iter; left time: 13.7346s
Updating learning rate to 0.0022597479928
Epoch: 4 cost time: 2.0871684551239014
Epoch: 4, Steps: 131 | Train Loss: 0.6555654 Vali Loss: 0.3236621 Best vali loss: 0.3206309
	iters: 100, epoch: 5 | loss: 0.7544315
	speed: 0.0234s/iter; left time: 9.9308s
Updating learning rate to 0.001394979874635174
Epoch: 5 cost time: 1.8846917152404785
Epoch: 5, Steps: 131 | Train Loss: 0.7544315 Vali Loss: 0.3231647 Best vali loss: 0.3206309
	iters: 100, epoch: 6 | loss: 0.6341590
	speed: 0.0238s/iter; left time: 6.9849s
Updating learning rate to 0.0006618648633184306
Epoch: 6 cost time: 2.0222084522247314
Epoch: 6, Steps: 131 | Train Loss: 0.6341590 Vali Loss: 0.3222089 Best vali loss: 0.3206309
	iters: 100, epoch: 7 | loss: 0.5359010
	speed: 0.0241s/iter; left time: 3.9324s
Updating learning rate to 0.00017201307361861746
Epoch: 7 cost time: 2.0261683464050293
Epoch: 7, Steps: 131 | Train Loss: 0.5359010 Vali Loss: 0.3224257 Best vali loss: 0.3206309
	iters: 100, epoch: 8 | loss: 0.2988864
	speed: 0.0271s/iter; left time: 0.8684s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.0315120220184326
Epoch: 8, Steps: 131 | Train Loss: 0.2988864 Vali Loss: 0.3224057 Best vali loss: 0.3206309

best validation loss 0.3206308616852397

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0017015780889, 'e_layers': 4, 'learning_rate': 0.0035662763162, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7469508
	speed: 0.0178s/iter; left time: 35.4929s
	iters: 200, epoch: 1 | loss: 0.3542782
	speed: 0.0114s/iter; left time: 21.6398s
Updating learning rate to 0.003430543006008465
Validation loss decreased (inf --> 0.3275).  Saving model state dict ...
Epoch: 1 cost time: 3.3739588260650635
Epoch: 1, Steps: 262 | Train Loss: 0.5506145 Vali Loss: 0.3274728 Best vali loss: 0.3274728
	iters: 100, epoch: 2 | loss: 0.4143136
	speed: 0.0241s/iter; left time: 41.7601s
	iters: 200, epoch: 2 | loss: 0.3989135
	speed: 0.0120s/iter; left time: 19.5489s
Updating learning rate to 0.003044007241485
Validation loss decreased (0.3275 --> 0.3243).  Saving model state dict ...
Epoch: 2 cost time: 2.831437110900879
Epoch: 2, Steps: 262 | Train Loss: 0.4066136 Vali Loss: 0.3243291 Best vali loss: 0.3243291
	iters: 100, epoch: 3 | loss: 0.3667046
	speed: 0.0239s/iter; left time: 35.2584s
	iters: 200, epoch: 3 | loss: 0.6428176
	speed: 0.0124s/iter; left time: 16.9976s
Updating learning rate to 0.002465515588822872
Validation loss decreased (0.3243 --> 0.3237).  Saving model state dict ...
Epoch: 3 cost time: 3.2442691326141357
Epoch: 3, Steps: 262 | Train Loss: 0.5047611 Vali Loss: 0.3236678 Best vali loss: 0.3236678
	iters: 100, epoch: 4 | loss: 0.4478101
	speed: 0.0258s/iter; left time: 31.2977s
	iters: 200, epoch: 4 | loss: 0.5062203
	speed: 0.0111s/iter; left time: 12.3175s
Updating learning rate to 0.0017831381581
Epoch: 4 cost time: 2.997257947921753
Epoch: 4, Steps: 262 | Train Loss: 0.4770152 Vali Loss: 0.3246698 Best vali loss: 0.3236678
	iters: 100, epoch: 5 | loss: 0.6164062
	speed: 0.0248s/iter; left time: 23.5524s
	iters: 200, epoch: 5 | loss: 0.5441121
	speed: 0.0118s/iter; left time: 10.0526s
Updating learning rate to 0.001100760727377128
Validation loss decreased (0.3237 --> 0.3210).  Saving model state dict ...
Epoch: 5 cost time: 3.217691421508789
Epoch: 5, Steps: 262 | Train Loss: 0.5802592 Vali Loss: 0.3209917 Best vali loss: 0.3209917
	iters: 100, epoch: 6 | loss: 0.5886247
	speed: 0.0255s/iter; left time: 17.5064s
	iters: 200, epoch: 6 | loss: 0.5506513
	speed: 0.0102s/iter; left time: 6.0166s
Updating learning rate to 0.000522269074715
Validation loss decreased (0.3210 --> 0.3204).  Saving model state dict ...
Epoch: 6 cost time: 2.8795242309570312
Epoch: 6, Steps: 262 | Train Loss: 0.5696380 Vali Loss: 0.3204079 Best vali loss: 0.3204079
	iters: 100, epoch: 7 | loss: 0.8481295
	speed: 0.0221s/iter; left time: 9.3753s
	iters: 200, epoch: 7 | loss: 0.6659585
	speed: 0.0095s/iter; left time: 3.0829s
Updating learning rate to 0.0001357333101915351
Epoch: 7 cost time: 2.657703161239624
Epoch: 7, Steps: 262 | Train Loss: 0.7570440 Vali Loss: 0.3221332 Best vali loss: 0.3204079
	iters: 100, epoch: 8 | loss: 0.4058087
	speed: 0.0225s/iter; left time: 3.6729s
	iters: 200, epoch: 8 | loss: 1.1202438
	speed: 0.0098s/iter; left time: 0.6186s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7120118141174316
Epoch: 8, Steps: 262 | Train Loss: 0.7630263 Vali Loss: 0.3221445 Best vali loss: 0.3204079

best validation loss 0.3204079164187232

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000742996568, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007147179449506653
Validation loss decreased (inf --> 0.2836).  Saving model state dict ...
Epoch: 1 cost time: 1.1269114017486572
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2835616 Best vali loss: 0.2835616
Updating learning rate to 0.0006341872398155659
Epoch: 2 cost time: 1.0335321426391602
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2941259 Best vali loss: 0.2835616
Updating learning rate to 0.000513664522438861
Epoch: 3 cost time: 0.9859280586242676
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2968558 Best vali loss: 0.2835616

best validation loss 0.2835616123259577

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070932288252, 'e_layers': 4, 'learning_rate': 0.0005299103803, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7523687
	speed: 0.0137s/iter; left time: 113.3437s
	iters: 200, epoch: 1 | loss: 0.3652265
	speed: 0.0076s/iter; left time: 61.6816s
	iters: 300, epoch: 1 | loss: 0.2632292
	speed: 0.0159s/iter; left time: 128.4805s
	iters: 400, epoch: 1 | loss: 0.2957172
	speed: 0.0202s/iter; left time: 160.4463s
	iters: 500, epoch: 1 | loss: 0.2316618
	speed: 0.0154s/iter; left time: 121.2294s
	iters: 600, epoch: 1 | loss: 0.5706601
	speed: 0.0193s/iter; left time: 149.8427s
	iters: 700, epoch: 1 | loss: 0.2255033
	speed: 0.0147s/iter; left time: 112.4013s
	iters: 800, epoch: 1 | loss: 0.5584672
	speed: 0.0129s/iter; left time: 97.4460s
	iters: 900, epoch: 1 | loss: 0.3041491
	speed: 0.0094s/iter; left time: 70.4076s
	iters: 1000, epoch: 1 | loss: 0.3055564
	speed: 0.0106s/iter; left time: 78.0650s
Updating learning rate to 0.0005299103803
Validation loss decreased (inf --> 0.2907).  Saving model state dict ...
Epoch: 1 cost time: 14.123646974563599
Epoch: 1, Steps: 1045 | Train Loss: 0.3872539 Vali Loss: 0.2907239 Best vali loss: 0.2907239
	iters: 100, epoch: 2 | loss: 0.3414995
	speed: 0.0293s/iter; left time: 211.3782s
	iters: 200, epoch: 2 | loss: 0.3281283
	speed: 0.0084s/iter; left time: 59.4859s
	iters: 300, epoch: 2 | loss: 0.2500272
	speed: 0.0103s/iter; left time: 72.5053s
	iters: 400, epoch: 2 | loss: 0.5271968
	speed: 0.0112s/iter; left time: 77.2591s
	iters: 500, epoch: 2 | loss: 0.4952236
	speed: 0.0103s/iter; left time: 70.4245s
	iters: 600, epoch: 2 | loss: 0.4946300
	speed: 0.0098s/iter; left time: 66.0880s
	iters: 700, epoch: 2 | loss: 0.4336619
	speed: 0.0106s/iter; left time: 70.3536s
	iters: 800, epoch: 2 | loss: 0.3445553
	speed: 0.0114s/iter; left time: 74.0534s
	iters: 900, epoch: 2 | loss: 1.2761039
	speed: 0.0114s/iter; left time: 73.1353s
	iters: 1000, epoch: 2 | loss: 1.2297626
	speed: 0.0101s/iter; left time: 64.0648s
Updating learning rate to 0.00026495519015
Validation loss decreased (0.2907 --> 0.2846).  Saving model state dict ...
Epoch: 2 cost time: 10.717336654663086
Epoch: 2, Steps: 1045 | Train Loss: 0.5720789 Vali Loss: 0.2845667 Best vali loss: 0.2845667
	iters: 100, epoch: 3 | loss: 0.4275343
	speed: 0.0325s/iter; left time: 200.3605s
	iters: 200, epoch: 3 | loss: 0.3202334
	speed: 0.0100s/iter; left time: 60.7164s
	iters: 300, epoch: 3 | loss: 0.2374410
	speed: 0.0089s/iter; left time: 52.8973s
	iters: 400, epoch: 3 | loss: 0.7561886
	speed: 0.0091s/iter; left time: 53.1868s
	iters: 500, epoch: 3 | loss: 0.1911551
	speed: 0.0103s/iter; left time: 59.2787s
	iters: 600, epoch: 3 | loss: 0.8673530
	speed: 0.0103s/iter; left time: 58.3435s
	iters: 700, epoch: 3 | loss: 0.1357827
	speed: 0.0097s/iter; left time: 54.1338s
	iters: 800, epoch: 3 | loss: 0.5839343
	speed: 0.0099s/iter; left time: 53.9339s
	iters: 900, epoch: 3 | loss: 0.3023411
	speed: 0.0086s/iter; left time: 46.0583s
	iters: 1000, epoch: 3 | loss: 0.2911603
	speed: 0.0107s/iter; left time: 56.3816s
Updating learning rate to 0.000132477595075
Epoch: 3 cost time: 10.46674633026123
Epoch: 3, Steps: 1045 | Train Loss: 0.4113124 Vali Loss: 0.2917907 Best vali loss: 0.2845667

best validation loss 0.2845666527127457

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009862436847, 'e_layers': 1, 'learning_rate': 0.0001665995443, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4529540
	speed: 0.0141s/iter; left time: 13.4076s
Updating learning rate to 0.0001602587267022387
Validation loss decreased (inf --> 0.2885).  Saving model state dict ...
Epoch: 1 cost time: 1.3150928020477295
Epoch: 1, Steps: 131 | Train Loss: 0.4529540 Vali Loss: 0.2885440 Best vali loss: 0.2885440
	iters: 100, epoch: 2 | loss: 0.5659561
	speed: 0.0114s/iter; left time: 9.2865s
Updating learning rate to 0.0001422016059085593
Validation loss decreased (0.2885 --> 0.2801).  Saving model state dict ...
Epoch: 2 cost time: 0.8764214515686035
Epoch: 2, Steps: 131 | Train Loss: 0.5659561 Vali Loss: 0.2800599 Best vali loss: 0.2800599
	iters: 100, epoch: 3 | loss: 0.6307477
	speed: 0.0111s/iter; left time: 7.5958s
Updating learning rate to 0.00011517721487159193
Epoch: 3 cost time: 0.8770039081573486
Epoch: 3, Steps: 131 | Train Loss: 0.6307477 Vali Loss: 0.2801397 Best vali loss: 0.2800599

best validation loss 0.280059912626785

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009862436847, 'e_layers': 1, 'learning_rate': 0.0001665995443, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4368044
	speed: 0.0133s/iter; left time: 7.3976s
Updating learning rate to 8.329977215e-05
Epoch: 4 cost time: 1.2421495914459229
Epoch: 4, Steps: 131 | Train Loss: 0.4368044 Vali Loss: 0.2800887 Best vali loss: 0.2800599
	iters: 100, epoch: 5 | loss: 0.5186976
	speed: 0.0114s/iter; left time: 4.8330s
Updating learning rate to 5.142232942840809e-05
Validation loss decreased (0.2801 --> 0.2795).  Saving model state dict ...
Epoch: 5 cost time: 0.8591582775115967
Epoch: 5, Steps: 131 | Train Loss: 0.5186976 Vali Loss: 0.2794733 Best vali loss: 0.2794733
	iters: 100, epoch: 6 | loss: 0.6108970
	speed: 0.0112s/iter; left time: 3.2973s
Updating learning rate to 2.439793839144069e-05
Epoch: 6 cost time: 0.8485321998596191
Epoch: 6, Steps: 131 | Train Loss: 0.6108970 Vali Loss: 0.2806777 Best vali loss: 0.2794733
	iters: 100, epoch: 7 | loss: 0.4068064
	speed: 0.0168s/iter; left time: 2.7427s
Updating learning rate to 6.340817597761298e-06
Epoch: 7 cost time: 1.1477553844451904
Epoch: 7, Steps: 131 | Train Loss: 0.4068064 Vali Loss: 0.2807706 Best vali loss: 0.2794733
	iters: 100, epoch: 8 | loss: 0.3235078
	speed: 0.0071s/iter; left time: 0.2269s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5422561168670654
Epoch: 8, Steps: 131 | Train Loss: 0.3235078 Vali Loss: 0.2808910 Best vali loss: 0.2794733

best validation loss 0.27947325860425504

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009147624054, 'e_layers': 4, 'learning_rate': 0.0034509285106, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4944055
	speed: 0.0166s/iter; left time: 15.7832s
Updating learning rate to 0.0034509285106
Validation loss decreased (inf --> 0.2983).  Saving model state dict ...
Epoch: 1 cost time: 1.6437289714813232
Epoch: 1, Steps: 131 | Train Loss: 0.4944055 Vali Loss: 0.2983193 Best vali loss: 0.2983193
	iters: 100, epoch: 2 | loss: 0.3695527
	speed: 0.0159s/iter; left time: 12.9715s
Updating learning rate to 0.0017254642553
Validation loss decreased (0.2983 --> 0.2930).  Saving model state dict ...
Epoch: 2 cost time: 1.2909629344940186
Epoch: 2, Steps: 131 | Train Loss: 0.3695527 Vali Loss: 0.2929640 Best vali loss: 0.2929640
	iters: 100, epoch: 3 | loss: 0.5009767
	speed: 0.0186s/iter; left time: 12.7587s
Updating learning rate to 0.00086273212765
Validation loss decreased (0.2930 --> 0.2900).  Saving model state dict ...
Epoch: 3 cost time: 1.562011480331421
Epoch: 3, Steps: 131 | Train Loss: 0.5009767 Vali Loss: 0.2900117 Best vali loss: 0.2900117
	iters: 100, epoch: 4 | loss: 0.5876622
	speed: 0.0156s/iter; left time: 8.6749s
Updating learning rate to 0.000431366063825
Epoch: 4 cost time: 1.2586205005645752
Epoch: 4, Steps: 131 | Train Loss: 0.5876622 Vali Loss: 0.2934958 Best vali loss: 0.2900117
	iters: 100, epoch: 5 | loss: 0.4288057
	speed: 0.0149s/iter; left time: 6.3351s
Updating learning rate to 0.0002156830319125
Epoch: 5 cost time: 1.1871259212493896
Epoch: 5, Steps: 131 | Train Loss: 0.4288057 Vali Loss: 0.2956171 Best vali loss: 0.2900117
	iters: 100, epoch: 6 | loss: 0.4810309
	speed: 0.0181s/iter; left time: 5.3219s
Updating learning rate to 0.00010784151595625
Epoch: 6 cost time: 1.5796034336090088
Epoch: 6, Steps: 131 | Train Loss: 0.4810309 Vali Loss: 0.2994764 Best vali loss: 0.2900117
	iters: 100, epoch: 7 | loss: 0.6162645
	speed: 0.0160s/iter; left time: 2.6101s
Updating learning rate to 5.3920757978125e-05
Epoch: 7 cost time: 1.2501578330993652
Epoch: 7, Steps: 131 | Train Loss: 0.6162645 Vali Loss: 0.3005245 Best vali loss: 0.2900117
	iters: 100, epoch: 8 | loss: 0.3993252
	speed: 0.0153s/iter; left time: 0.4886s
Updating learning rate to 2.69603789890625e-05
Epoch: 8 cost time: 1.2468955516815186
Epoch: 8, Steps: 131 | Train Loss: 0.3993252 Vali Loss: 0.3054209 Best vali loss: 0.2900117

best validation loss 0.29001172904899103

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.009633896292, 'e_layers': 2, 'learning_rate': 0.0017048200843, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2791689
	speed: 0.0136s/iter; left time: 27.1576s
	iters: 200, epoch: 1 | loss: 0.9546975
	speed: 0.0051s/iter; left time: 9.7030s
Updating learning rate to 0.0017048200843
Validation loss decreased (inf --> 0.3468).  Saving model state dict ...
Epoch: 1 cost time: 1.8979408740997314
Epoch: 1, Steps: 262 | Train Loss: 0.6169332 Vali Loss: 0.3467597 Best vali loss: 0.3467597
	iters: 100, epoch: 2 | loss: 0.5183357
	speed: 0.0166s/iter; left time: 28.7599s
	iters: 200, epoch: 2 | loss: 0.4425530
	speed: 0.0081s/iter; left time: 13.3168s
Updating learning rate to 0.00085241004215
Validation loss decreased (0.3468 --> 0.3069).  Saving model state dict ...
Epoch: 2 cost time: 2.2361531257629395
Epoch: 2, Steps: 262 | Train Loss: 0.4804444 Vali Loss: 0.3068852 Best vali loss: 0.3068852
	iters: 100, epoch: 3 | loss: 0.7058496
	speed: 0.0189s/iter; left time: 27.8167s
	iters: 200, epoch: 3 | loss: 0.3865055
	speed: 0.0077s/iter; left time: 10.5279s
Updating learning rate to 0.000426205021075
Epoch: 3 cost time: 2.271111249923706
Epoch: 3, Steps: 262 | Train Loss: 0.5461775 Vali Loss: 0.3184116 Best vali loss: 0.3068852
	iters: 100, epoch: 4 | loss: 0.5622283
	speed: 0.0298s/iter; left time: 36.0548s
	iters: 200, epoch: 4 | loss: 0.6855018
	speed: 0.0097s/iter; left time: 10.7787s
Updating learning rate to 0.0002131025105375
Validation loss decreased (0.3069 --> 0.3062).  Saving model state dict ...
Epoch: 4 cost time: 2.5784294605255127
Epoch: 4, Steps: 262 | Train Loss: 0.6238651 Vali Loss: 0.3062402 Best vali loss: 0.3062402
	iters: 100, epoch: 5 | loss: 0.3107817
	speed: 0.0269s/iter; left time: 25.5294s
	iters: 200, epoch: 5 | loss: 0.3403042
	speed: 0.0078s/iter; left time: 6.6513s
Updating learning rate to 0.00010655125526875
Epoch: 5 cost time: 2.3331892490386963
Epoch: 5, Steps: 262 | Train Loss: 0.3255430 Vali Loss: 0.3136984 Best vali loss: 0.3062402
	iters: 100, epoch: 6 | loss: 0.5552717
	speed: 0.0464s/iter; left time: 31.8557s
	iters: 200, epoch: 6 | loss: 0.5215412
	speed: 0.0131s/iter; left time: 7.6898s
Updating learning rate to 5.3275627634375e-05
Epoch: 6 cost time: 3.5078823566436768
Epoch: 6, Steps: 262 | Train Loss: 0.5384065 Vali Loss: 0.3121259 Best vali loss: 0.3062402
	iters: 100, epoch: 7 | loss: 0.3633505
	speed: 0.0507s/iter; left time: 21.5608s
	iters: 200, epoch: 7 | loss: 0.4976885
	speed: 0.0145s/iter; left time: 4.7080s
Updating learning rate to 2.66378138171875e-05
Epoch: 7 cost time: 3.6356537342071533
Epoch: 7, Steps: 262 | Train Loss: 0.4305195 Vali Loss: 0.3163320 Best vali loss: 0.3062402
	iters: 100, epoch: 8 | loss: 0.5024549
	speed: 0.0433s/iter; left time: 7.0614s
	iters: 200, epoch: 8 | loss: 0.3385462
	speed: 0.0122s/iter; left time: 0.7699s
Updating learning rate to 1.331890690859375e-05
Epoch: 8 cost time: 3.267319440841675
Epoch: 8, Steps: 262 | Train Loss: 0.4205006 Vali Loss: 0.3180865 Best vali loss: 0.3062402

best validation loss 0.30624024591600196

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0025086776697, 'e_layers': 2, 'learning_rate': 0.0038401597058, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0038401597058
Validation loss decreased (inf --> 0.2925).  Saving model state dict ...
Epoch: 1 cost time: 2.6364595890045166
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2924900 Best vali loss: 0.2924900
Updating learning rate to 0.0019200798529
Validation loss decreased (0.2925 --> 0.2912).  Saving model state dict ...
Epoch: 2 cost time: 0.9486668109893799
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2911766 Best vali loss: 0.2911766
Updating learning rate to 0.00096003992645
Epoch: 3 cost time: 1.3243739604949951
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3008947 Best vali loss: 0.2911766

best validation loss 0.2911766487433149

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0077731430276, 'e_layers': 4, 'learning_rate': 0.0011129571298, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0011129571298
Validation loss decreased (inf --> 0.2911).  Saving model state dict ...
Epoch: 1 cost time: 2.386606454849243
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2911182 Best vali loss: 0.2911182
Updating learning rate to 0.0005564785649
Epoch: 2 cost time: 1.5628066062927246
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2948070 Best vali loss: 0.2911182
Updating learning rate to 0.00027823928245
Validation loss decreased (0.2911 --> 0.2860).  Saving model state dict ...
Epoch: 3 cost time: 1.4315686225891113
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2860040 Best vali loss: 0.2860040

best validation loss 0.2860039679500506

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.002398746697, 'e_layers': 3, 'learning_rate': 0.0002172766051, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6389936
	speed: 0.0147s/iter; left time: 13.9405s
Updating learning rate to 0.00020900700672271373
Validation loss decreased (inf --> 0.2954).  Saving model state dict ...
Epoch: 1 cost time: 1.4205985069274902
Epoch: 1, Steps: 131 | Train Loss: 0.6389936 Vali Loss: 0.2953626 Best vali loss: 0.2953626
	iters: 100, epoch: 2 | loss: 0.5695380
	speed: 0.0164s/iter; left time: 13.4469s
Updating learning rate to 0.0001854571829797008
Validation loss decreased (0.2954 --> 0.2842).  Saving model state dict ...
Epoch: 2 cost time: 1.3453969955444336
Epoch: 2, Steps: 131 | Train Loss: 0.5695380 Vali Loss: 0.2842370 Best vali loss: 0.2842370
	iters: 100, epoch: 3 | loss: 0.6926094
	speed: 0.0161s/iter; left time: 11.0892s
Updating learning rate to 0.0001502123810561511
Validation loss decreased (0.2842 --> 0.2822).  Saving model state dict ...
Epoch: 3 cost time: 1.3429334163665771
Epoch: 3, Steps: 131 | Train Loss: 0.6926094 Vali Loss: 0.2821553 Best vali loss: 0.2821553

best validation loss 0.2821552590305985

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.002398746697, 'e_layers': 3, 'learning_rate': 0.0002172766051, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6155080
	speed: 0.0175s/iter; left time: 9.7176s
Updating learning rate to 0.00010863830255
Validation loss decreased (0.2822 --> 0.2812).  Saving model state dict ...
Epoch: 4 cost time: 1.528691291809082
Epoch: 4, Steps: 131 | Train Loss: 0.6155080 Vali Loss: 0.2811515 Best vali loss: 0.2811515
	iters: 100, epoch: 5 | loss: 0.5701103
	speed: 0.0155s/iter; left time: 6.5796s
Updating learning rate to 6.706422404384892e-05
Epoch: 5 cost time: 1.2468981742858887
Epoch: 5, Steps: 131 | Train Loss: 0.5701103 Vali Loss: 0.2819568 Best vali loss: 0.2811515
	iters: 100, epoch: 6 | loss: 0.6902136
	speed: 0.0150s/iter; left time: 4.4177s
Updating learning rate to 3.1819422120299206e-05
Epoch: 6 cost time: 1.2214694023132324
Epoch: 6, Steps: 131 | Train Loss: 0.6902136 Vali Loss: 0.2823187 Best vali loss: 0.2811515
	iters: 100, epoch: 7 | loss: 0.4091211
	speed: 0.0152s/iter; left time: 2.4759s
Updating learning rate to 8.26959837728627e-06
Epoch: 7 cost time: 1.2381043434143066
Epoch: 7, Steps: 131 | Train Loss: 0.4091211 Vali Loss: 0.2825556 Best vali loss: 0.2811515
	iters: 100, epoch: 8 | loss: 0.6133936
	speed: 0.0126s/iter; left time: 0.4023s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9602220058441162
Epoch: 8, Steps: 131 | Train Loss: 0.6133936 Vali Loss: 0.2827772 Best vali loss: 0.2811515

best validation loss 0.2811515152221632

[INFO][smbo.py:320] Finished 550 trials.
{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0060593286633, 'e_layers': 3, 'learning_rate': 0.0009361409963, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3737565
	speed: 0.0136s/iter; left time: 55.5971s
	iters: 200, epoch: 1 | loss: 0.2580218
	speed: 0.0065s/iter; left time: 25.9846s
	iters: 300, epoch: 1 | loss: 0.3927838
	speed: 0.0093s/iter; left time: 36.0131s
	iters: 400, epoch: 1 | loss: 0.6193456
	speed: 0.0102s/iter; left time: 38.6856s
	iters: 500, epoch: 1 | loss: 0.8416235
	speed: 0.0092s/iter; left time: 34.0156s
Updating learning rate to 0.0009361409963
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 4.8076207637786865
Epoch: 1, Steps: 523 | Train Loss: 0.4971062 Vali Loss: 0.2861853 Best vali loss: 0.2861853
	iters: 100, epoch: 2 | loss: 0.4207622
	speed: 0.0214s/iter; left time: 76.3873s
	iters: 200, epoch: 2 | loss: 0.8440229
	speed: 0.0103s/iter; left time: 35.7821s
	iters: 300, epoch: 2 | loss: 0.3609269
	speed: 0.0117s/iter; left time: 39.4385s
	iters: 400, epoch: 2 | loss: 0.5675828
	speed: 0.0097s/iter; left time: 31.4848s
	iters: 500, epoch: 2 | loss: 0.7045688
	speed: 0.0109s/iter; left time: 34.5097s
Updating learning rate to 0.00046807049815
Validation loss decreased (0.2862 --> 0.2861).  Saving model state dict ...
Epoch: 2 cost time: 5.645128965377808
Epoch: 2, Steps: 523 | Train Loss: 0.5795727 Vali Loss: 0.2861312 Best vali loss: 0.2861312
	iters: 100, epoch: 3 | loss: 0.4455388
	speed: 0.0168s/iter; left time: 50.9880s
	iters: 200, epoch: 3 | loss: 0.5084697
	speed: 0.0083s/iter; left time: 24.4115s
	iters: 300, epoch: 3 | loss: 0.2052290
	speed: 0.0079s/iter; left time: 22.4425s
	iters: 400, epoch: 3 | loss: 0.2397623
	speed: 0.0080s/iter; left time: 21.9730s
	iters: 500, epoch: 3 | loss: 0.4305949
	speed: 0.0084s/iter; left time: 22.1337s
Updating learning rate to 0.000234035249075
Validation loss decreased (0.2861 --> 0.2856).  Saving model state dict ...
Epoch: 3 cost time: 4.239916563034058
Epoch: 3, Steps: 523 | Train Loss: 0.3659189 Vali Loss: 0.2855879 Best vali loss: 0.2855879
	iters: 100, epoch: 4 | loss: 0.2771100
	speed: 0.0181s/iter; left time: 45.5237s
	iters: 200, epoch: 4 | loss: 0.2854259
	speed: 0.0086s/iter; left time: 20.8359s
	iters: 300, epoch: 4 | loss: 0.7577927
	speed: 0.0087s/iter; left time: 20.1780s
	iters: 400, epoch: 4 | loss: 0.5831640
	speed: 0.0084s/iter; left time: 18.7057s
	iters: 500, epoch: 4 | loss: 0.3982444
	speed: 0.0078s/iter; left time: 16.4855s
Updating learning rate to 0.0001170176245375
Epoch: 4 cost time: 4.451335906982422
Epoch: 4, Steps: 523 | Train Loss: 0.4603474 Vali Loss: 0.2905678 Best vali loss: 0.2855879
	iters: 100, epoch: 5 | loss: 0.3871659
	speed: 0.0171s/iter; left time: 34.0965s
	iters: 200, epoch: 5 | loss: 0.3109533
	speed: 0.0080s/iter; left time: 15.2317s
	iters: 300, epoch: 5 | loss: 0.4332556
	speed: 0.0080s/iter; left time: 14.3266s
	iters: 400, epoch: 5 | loss: 0.4059873
	speed: 0.0076s/iter; left time: 12.9093s
	iters: 500, epoch: 5 | loss: 0.3485228
	speed: 0.0069s/iter; left time: 10.9240s
Updating learning rate to 5.850881226875e-05
Epoch: 5 cost time: 4.078269958496094
Epoch: 5, Steps: 523 | Train Loss: 0.3771770 Vali Loss: 0.2877386 Best vali loss: 0.2855879
	iters: 100, epoch: 6 | loss: 0.2791876
	speed: 0.0185s/iter; left time: 27.1525s
	iters: 200, epoch: 6 | loss: 0.3144018
	speed: 0.0085s/iter; left time: 11.5873s
	iters: 300, epoch: 6 | loss: 0.2610900
	speed: 0.0082s/iter; left time: 10.4460s
	iters: 400, epoch: 6 | loss: 0.7353912
	speed: 0.0072s/iter; left time: 8.4458s
	iters: 500, epoch: 6 | loss: 0.6810932
	speed: 0.0078s/iter; left time: 8.3260s
Updating learning rate to 2.9254406134375e-05
Epoch: 6 cost time: 4.2836432456970215
Epoch: 6, Steps: 523 | Train Loss: 0.4542328 Vali Loss: 0.2923176 Best vali loss: 0.2855879
	iters: 100, epoch: 7 | loss: 0.2304824
	speed: 0.0180s/iter; left time: 17.0554s
	iters: 200, epoch: 7 | loss: 0.4651273
	speed: 0.0081s/iter; left time: 6.8944s
	iters: 300, epoch: 7 | loss: 0.4146049
	speed: 0.0082s/iter; left time: 6.1247s
	iters: 400, epoch: 7 | loss: 0.5059125
	speed: 0.0075s/iter; left time: 4.8835s
	iters: 500, epoch: 7 | loss: 0.4123700
	speed: 0.0073s/iter; left time: 4.0095s
Updating learning rate to 1.46272030671875e-05
Epoch: 7 cost time: 4.1805419921875
Epoch: 7, Steps: 523 | Train Loss: 0.4056994 Vali Loss: 0.2872722 Best vali loss: 0.2855879
	iters: 100, epoch: 8 | loss: 0.4178389
	speed: 0.0177s/iter; left time: 7.5022s
	iters: 200, epoch: 8 | loss: 0.5243213
	speed: 0.0075s/iter; left time: 2.4357s
	iters: 300, epoch: 8 | loss: 0.6042836
	speed: 0.0079s/iter; left time: 1.7684s
	iters: 400, epoch: 8 | loss: 0.3678305
	speed: 0.0080s/iter; left time: 0.9860s
	iters: 500, epoch: 8 | loss: 0.5804252
	speed: 0.0076s/iter; left time: 0.1825s
Updating learning rate to 7.31360153359375e-06
Epoch: 8 cost time: 4.084479093551636
Epoch: 8, Steps: 523 | Train Loss: 0.4989399 Vali Loss: 0.2881735 Best vali loss: 0.2855879

best validation loss 0.28558793767050944

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0044768018449, 'e_layers': 3, 'learning_rate': 0.0020807992704, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5736589
	speed: 0.0150s/iter; left time: 61.1367s
	iters: 200, epoch: 1 | loss: 0.3436910
	speed: 0.0086s/iter; left time: 34.1135s
	iters: 300, epoch: 1 | loss: 0.3418350
	speed: 0.0062s/iter; left time: 24.1508s
	iters: 400, epoch: 1 | loss: 1.0274993
	speed: 0.0068s/iter; left time: 25.8824s
	iters: 500, epoch: 1 | loss: 0.3575542
	speed: 0.0069s/iter; left time: 25.3147s
Updating learning rate to 0.0020807992704
Validation loss decreased (inf --> 0.3016).  Saving model state dict ...
Epoch: 1 cost time: 4.173800706863403
Epoch: 1, Steps: 523 | Train Loss: 0.5288477 Vali Loss: 0.3015543 Best vali loss: 0.3015543
	iters: 100, epoch: 2 | loss: 1.1581084
	speed: 0.0135s/iter; left time: 47.9796s
	iters: 200, epoch: 2 | loss: 0.2742973
	speed: 0.0053s/iter; left time: 18.1915s
	iters: 300, epoch: 2 | loss: 0.4105118
	speed: 0.0079s/iter; left time: 26.6778s
	iters: 400, epoch: 2 | loss: 0.5419851
	speed: 0.0074s/iter; left time: 24.1177s
	iters: 500, epoch: 2 | loss: 0.3446403
	speed: 0.0077s/iter; left time: 24.2384s
Updating learning rate to 0.0010403996352
Epoch: 2 cost time: 3.6662981510162354
Epoch: 2, Steps: 523 | Train Loss: 0.5459086 Vali Loss: 0.3061628 Best vali loss: 0.3015543
	iters: 100, epoch: 3 | loss: 0.5255899
	speed: 0.0184s/iter; left time: 55.8178s
	iters: 200, epoch: 3 | loss: 0.2164115
	speed: 0.0076s/iter; left time: 22.2408s
	iters: 300, epoch: 3 | loss: 0.6194540
	speed: 0.0061s/iter; left time: 17.3822s
	iters: 400, epoch: 3 | loss: 0.3363172
	speed: 0.0080s/iter; left time: 21.8882s
	iters: 500, epoch: 3 | loss: 0.5742728
	speed: 0.0085s/iter; left time: 22.4581s
Updating learning rate to 0.0005201998176
Validation loss decreased (0.3016 --> 0.2886).  Saving model state dict ...
Epoch: 3 cost time: 4.115869760513306
Epoch: 3, Steps: 523 | Train Loss: 0.4544091 Vali Loss: 0.2885856 Best vali loss: 0.2885856
	iters: 100, epoch: 4 | loss: 0.3369420
	speed: 0.0171s/iter; left time: 43.0366s
	iters: 200, epoch: 4 | loss: 0.3401644
	speed: 0.0078s/iter; left time: 18.8653s
	iters: 300, epoch: 4 | loss: 0.5018137
	speed: 0.0083s/iter; left time: 19.2774s
	iters: 400, epoch: 4 | loss: 0.4349800
	speed: 0.0080s/iter; left time: 17.6827s
	iters: 500, epoch: 4 | loss: 0.8961914
	speed: 0.0069s/iter; left time: 14.6879s
Updating learning rate to 0.0002600999088
Validation loss decreased (0.2886 --> 0.2878).  Saving model state dict ...
Epoch: 4 cost time: 4.1328136920928955
Epoch: 4, Steps: 523 | Train Loss: 0.5020183 Vali Loss: 0.2878210 Best vali loss: 0.2878210
	iters: 100, epoch: 5 | loss: 0.2465718
	speed: 0.0181s/iter; left time: 36.1158s
	iters: 200, epoch: 5 | loss: 0.3112783
	speed: 0.0082s/iter; left time: 15.6156s
	iters: 300, epoch: 5 | loss: 0.3709687
	speed: 0.0080s/iter; left time: 14.2854s
	iters: 400, epoch: 5 | loss: 0.2818384
	speed: 0.0084s/iter; left time: 14.2240s
	iters: 500, epoch: 5 | loss: 0.6228060
	speed: 0.0075s/iter; left time: 11.9738s
Updating learning rate to 0.0001300499544
Epoch: 5 cost time: 4.331146717071533
Epoch: 5, Steps: 523 | Train Loss: 0.3666926 Vali Loss: 0.2915932 Best vali loss: 0.2878210
	iters: 100, epoch: 6 | loss: 0.2250389
	speed: 0.0179s/iter; left time: 26.2484s
	iters: 200, epoch: 6 | loss: 0.8150411
	speed: 0.0087s/iter; left time: 11.9049s
	iters: 300, epoch: 6 | loss: 0.4986578
	speed: 0.0080s/iter; left time: 10.1573s
	iters: 400, epoch: 6 | loss: 0.5081929
	speed: 0.0086s/iter; left time: 10.0440s
	iters: 500, epoch: 6 | loss: 0.3652498
	speed: 0.0084s/iter; left time: 9.0206s
Updating learning rate to 6.50249772e-05
Epoch: 6 cost time: 4.497284173965454
Epoch: 6, Steps: 523 | Train Loss: 0.4824361 Vali Loss: 0.2925378 Best vali loss: 0.2878210
	iters: 100, epoch: 7 | loss: 0.2776840
	speed: 0.0185s/iter; left time: 17.5038s
	iters: 200, epoch: 7 | loss: 0.7168090
	speed: 0.0085s/iter; left time: 7.2150s
	iters: 300, epoch: 7 | loss: 0.3745473
	speed: 0.0082s/iter; left time: 6.1544s
	iters: 400, epoch: 7 | loss: 0.3984497
	speed: 0.0066s/iter; left time: 4.2800s
	iters: 500, epoch: 7 | loss: 0.2467348
	speed: 0.0085s/iter; left time: 4.6342s
Updating learning rate to 3.25124886e-05
Epoch: 7 cost time: 4.271026134490967
Epoch: 7, Steps: 523 | Train Loss: 0.4028449 Vali Loss: 0.2935025 Best vali loss: 0.2878210
	iters: 100, epoch: 8 | loss: 0.3675463
	speed: 0.0184s/iter; left time: 7.7955s
	iters: 200, epoch: 8 | loss: 0.4364748
	speed: 0.0079s/iter; left time: 2.5579s
	iters: 300, epoch: 8 | loss: 0.7022981
	speed: 0.0071s/iter; left time: 1.5917s
	iters: 400, epoch: 8 | loss: 0.5010386
	speed: 0.0078s/iter; left time: 0.9711s
	iters: 500, epoch: 8 | loss: 0.2092889
	speed: 0.0081s/iter; left time: 0.1935s
Updating learning rate to 1.62562443e-05
Epoch: 8 cost time: 4.179264783859253
Epoch: 8, Steps: 523 | Train Loss: 0.4433293 Vali Loss: 0.2948124 Best vali loss: 0.2878210

best validation loss 0.287820968249111

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0016072549561, 'e_layers': 4, 'learning_rate': 0.0001805363444, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4017376
	speed: 0.0228s/iter; left time: 21.5968s
Updating learning rate to 0.0001805363444
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 2.3322739601135254
Epoch: 1, Steps: 131 | Train Loss: 0.4017376 Vali Loss: 0.2821281 Best vali loss: 0.2821281
	iters: 100, epoch: 2 | loss: 0.5055539
	speed: 0.0332s/iter; left time: 27.1476s
Updating learning rate to 9.02681722e-05
Validation loss decreased (0.2821 --> 0.2798).  Saving model state dict ...
Epoch: 2 cost time: 2.599686861038208
Epoch: 2, Steps: 131 | Train Loss: 0.5055539 Vali Loss: 0.2797850 Best vali loss: 0.2797850
	iters: 100, epoch: 3 | loss: 0.4483979
	speed: 0.0256s/iter; left time: 17.5547s
Updating learning rate to 4.51340861e-05
Validation loss decreased (0.2798 --> 0.2797).  Saving model state dict ...
Epoch: 3 cost time: 1.6587939262390137
Epoch: 3, Steps: 131 | Train Loss: 0.4483979 Vali Loss: 0.2797371 Best vali loss: 0.2797371

best validation loss 0.27973711926194983

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0013951962987, 'e_layers': 2, 'learning_rate': 0.0008383415485, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6024236
	speed: 0.0183s/iter; left time: 17.3303s
Updating learning rate to 0.0008383415485
Validation loss decreased (inf --> 0.2923).  Saving model state dict ...
Epoch: 1 cost time: 1.7011983394622803
Epoch: 1, Steps: 131 | Train Loss: 0.6024236 Vali Loss: 0.2922675 Best vali loss: 0.2922675
	iters: 100, epoch: 2 | loss: 0.3645311
	speed: 0.0151s/iter; left time: 12.3493s
Updating learning rate to 0.00041917077425
Epoch: 2 cost time: 1.1733410358428955
Epoch: 2, Steps: 131 | Train Loss: 0.3645311 Vali Loss: 0.2927630 Best vali loss: 0.2922675
	iters: 100, epoch: 3 | loss: 0.5641561
	speed: 0.0153s/iter; left time: 10.4895s
Updating learning rate to 0.000209585387125
Epoch: 3 cost time: 1.1954786777496338
Epoch: 3, Steps: 131 | Train Loss: 0.5641561 Vali Loss: 0.2923564 Best vali loss: 0.2922675

best validation loss 0.29226754463352916

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021094216667, 'e_layers': 4, 'learning_rate': 0.0001874988774, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5162053
	speed: 0.0205s/iter; left time: 19.4808s
Updating learning rate to 0.0001874988774
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 2.18955135345459
Epoch: 1, Steps: 131 | Train Loss: 0.5162053 Vali Loss: 0.2802199 Best vali loss: 0.2802199
	iters: 100, epoch: 2 | loss: 0.3236405
	speed: 0.0276s/iter; left time: 22.6061s
Updating learning rate to 9.37494387e-05
Epoch: 2 cost time: 1.9344532489776611
Epoch: 2, Steps: 131 | Train Loss: 0.3236405 Vali Loss: 0.2856716 Best vali loss: 0.2802199
	iters: 100, epoch: 3 | loss: 0.3980173
	speed: 0.0227s/iter; left time: 15.6059s
Updating learning rate to 4.687471935e-05
Epoch: 3 cost time: 1.8371343612670898
Epoch: 3, Steps: 131 | Train Loss: 0.3980173 Vali Loss: 0.2810136 Best vali loss: 0.2802199

best validation loss 0.2802198752012781

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0016072549561, 'e_layers': 4, 'learning_rate': 0.0001805363444, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3501662
	speed: 0.0180s/iter; left time: 10.0044s
Updating learning rate to 2.256704305e-05
Epoch: 4 cost time: 1.8952746391296387
Epoch: 4, Steps: 131 | Train Loss: 0.3501662 Vali Loss: 0.2822218 Best vali loss: 0.2797371
	iters: 100, epoch: 5 | loss: 0.4811106
	speed: 0.0232s/iter; left time: 9.8440s
Updating learning rate to 1.1283521525e-05
Epoch: 5 cost time: 1.7081472873687744
Epoch: 5, Steps: 131 | Train Loss: 0.4811106 Vali Loss: 0.2822141 Best vali loss: 0.2797371
	iters: 100, epoch: 6 | loss: 0.4106253
	speed: 0.0330s/iter; left time: 9.7148s
Updating learning rate to 5.6417607625e-06
Epoch: 6 cost time: 2.2313895225524902
Epoch: 6, Steps: 131 | Train Loss: 0.4106253 Vali Loss: 0.2827290 Best vali loss: 0.2797371
	iters: 100, epoch: 7 | loss: 0.6148012
	speed: 0.0207s/iter; left time: 3.3730s
Updating learning rate to 2.82088038125e-06
Epoch: 7 cost time: 1.3812403678894043
Epoch: 7, Steps: 131 | Train Loss: 0.6148012 Vali Loss: 0.2826850 Best vali loss: 0.2797371
	iters: 100, epoch: 8 | loss: 0.6699691
	speed: 0.0183s/iter; left time: 0.5869s
Updating learning rate to 1.410440190625e-06
Epoch: 8 cost time: 1.5970706939697266
Epoch: 8, Steps: 131 | Train Loss: 0.6699691 Vali Loss: 0.2831022 Best vali loss: 0.2797371

best validation loss 0.27973711926194983

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0023167357829, 'e_layers': 1, 'learning_rate': 6.40107016e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5088043
	speed: 0.0125s/iter; left time: 51.0727s
	iters: 200, epoch: 1 | loss: 0.4347994
	speed: 0.0051s/iter; left time: 20.3924s
	iters: 300, epoch: 1 | loss: 0.2347640
	speed: 0.0045s/iter; left time: 17.4947s
	iters: 400, epoch: 1 | loss: 1.3325775
	speed: 0.0044s/iter; left time: 16.6597s
	iters: 500, epoch: 1 | loss: 0.4449067
	speed: 0.0053s/iter; left time: 19.5061s
Updating learning rate to 6.40107016e-05
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 2.997387409210205
Epoch: 1, Steps: 523 | Train Loss: 0.5911704 Vali Loss: 0.2795792 Best vali loss: 0.2795792
	iters: 100, epoch: 2 | loss: 0.2649134
	speed: 0.0138s/iter; left time: 49.2538s
	iters: 200, epoch: 2 | loss: 0.2471167
	speed: 0.0052s/iter; left time: 17.9983s
	iters: 300, epoch: 2 | loss: 0.4309283
	speed: 0.0056s/iter; left time: 18.7121s
	iters: 400, epoch: 2 | loss: 0.3897954
	speed: 0.0057s/iter; left time: 18.5078s
	iters: 500, epoch: 2 | loss: 0.6294400
	speed: 0.0057s/iter; left time: 17.9450s
Updating learning rate to 3.20053508e-05
Epoch: 2 cost time: 2.899411678314209
Epoch: 2, Steps: 523 | Train Loss: 0.3924388 Vali Loss: 0.2799819 Best vali loss: 0.2795792
	iters: 100, epoch: 3 | loss: 0.3000884
	speed: 0.0127s/iter; left time: 38.5730s
	iters: 200, epoch: 3 | loss: 0.2985608
	speed: 0.0056s/iter; left time: 16.3922s
	iters: 300, epoch: 3 | loss: 0.4141279
	speed: 0.0054s/iter; left time: 15.3837s
	iters: 400, epoch: 3 | loss: 0.3651306
	speed: 0.0055s/iter; left time: 15.1799s
	iters: 500, epoch: 3 | loss: 0.3191816
	speed: 0.0055s/iter; left time: 14.4065s
Updating learning rate to 1.60026754e-05
Validation loss decreased (0.2796 --> 0.2795).  Saving model state dict ...
Epoch: 3 cost time: 2.8759212493896484
Epoch: 3, Steps: 523 | Train Loss: 0.3394179 Vali Loss: 0.2794766 Best vali loss: 0.2794766
	iters: 100, epoch: 4 | loss: 0.7889770
	speed: 0.0150s/iter; left time: 37.6527s
	iters: 200, epoch: 4 | loss: 0.7459099
	speed: 0.0048s/iter; left time: 11.5995s
	iters: 300, epoch: 4 | loss: 0.4098245
	speed: 0.0042s/iter; left time: 9.7381s
	iters: 400, epoch: 4 | loss: 0.4699060
	speed: 0.0043s/iter; left time: 9.5168s
	iters: 500, epoch: 4 | loss: 0.5047682
	speed: 0.0051s/iter; left time: 10.7799s
Updating learning rate to 8.0013377e-06
Epoch: 4 cost time: 2.5726187229156494
Epoch: 4, Steps: 523 | Train Loss: 0.5838771 Vali Loss: 0.2799876 Best vali loss: 0.2794766
	iters: 100, epoch: 5 | loss: 0.1895509
	speed: 0.0143s/iter; left time: 28.4686s
	iters: 200, epoch: 5 | loss: 0.3006458
	speed: 0.0055s/iter; left time: 10.4865s
	iters: 300, epoch: 5 | loss: 0.7387979
	speed: 0.0057s/iter; left time: 10.2162s
	iters: 400, epoch: 5 | loss: 0.9463459
	speed: 0.0056s/iter; left time: 9.5242s
	iters: 500, epoch: 5 | loss: 0.3800087
	speed: 0.0057s/iter; left time: 9.0518s
Updating learning rate to 4.00066885e-06
Epoch: 5 cost time: 2.937596321105957
Epoch: 5, Steps: 523 | Train Loss: 0.5110698 Vali Loss: 0.2805419 Best vali loss: 0.2794766
	iters: 100, epoch: 6 | loss: 0.4383628
	speed: 0.0120s/iter; left time: 17.6436s
	iters: 200, epoch: 6 | loss: 0.4990889
	speed: 0.0040s/iter; left time: 5.5180s
	iters: 300, epoch: 6 | loss: 1.1070163
	speed: 0.0041s/iter; left time: 5.2231s
	iters: 400, epoch: 6 | loss: 0.6612542
	speed: 0.0041s/iter; left time: 4.8488s
	iters: 500, epoch: 6 | loss: 0.4064718
	speed: 0.0041s/iter; left time: 4.4209s
Updating learning rate to 2.000334425e-06
Epoch: 6 cost time: 2.2076520919799805
Epoch: 6, Steps: 523 | Train Loss: 0.6224388 Vali Loss: 0.2801165 Best vali loss: 0.2794766
	iters: 100, epoch: 7 | loss: 0.8602902
	speed: 0.0106s/iter; left time: 10.0019s
	iters: 200, epoch: 7 | loss: 0.8255957
	speed: 0.0042s/iter; left time: 3.5302s
	iters: 300, epoch: 7 | loss: 1.1162459
	speed: 0.0040s/iter; left time: 2.9954s
	iters: 400, epoch: 7 | loss: 0.5147467
	speed: 0.0045s/iter; left time: 2.8800s
	iters: 500, epoch: 7 | loss: 0.4816117
	speed: 0.0046s/iter; left time: 2.5091s
Updating learning rate to 1.0001672125e-06
Epoch: 7 cost time: 2.310460090637207
Epoch: 7, Steps: 523 | Train Loss: 0.7596980 Vali Loss: 0.2802202 Best vali loss: 0.2794766
	iters: 100, epoch: 8 | loss: 0.3889323
	speed: 0.0117s/iter; left time: 4.9431s
	iters: 200, epoch: 8 | loss: 0.4155775
	speed: 0.0047s/iter; left time: 1.5140s
	iters: 300, epoch: 8 | loss: 0.5234318
	speed: 0.0051s/iter; left time: 1.1409s
	iters: 400, epoch: 8 | loss: 0.3188147
	speed: 0.0052s/iter; left time: 0.6422s
	iters: 500, epoch: 8 | loss: 0.5306498
	speed: 0.0051s/iter; left time: 0.1218s
Updating learning rate to 5.0008360625e-07
Epoch: 8 cost time: 2.611419916152954
Epoch: 8, Steps: 523 | Train Loss: 0.4354812 Vali Loss: 0.2802170 Best vali loss: 0.2794766

best validation loss 0.27947663050041005

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0024749637138, 'e_layers': 1, 'learning_rate': 0.0037262232421, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3739299
	speed: 0.0116s/iter; left time: 47.1887s
	iters: 200, epoch: 1 | loss: 0.8647438
	speed: 0.0056s/iter; left time: 22.1450s
	iters: 300, epoch: 1 | loss: 0.5348495
	speed: 0.0039s/iter; left time: 15.2283s
	iters: 400, epoch: 1 | loss: 0.4823696
	speed: 0.0038s/iter; left time: 14.3284s
	iters: 500, epoch: 1 | loss: 0.2491522
	speed: 0.0052s/iter; left time: 19.1203s
Updating learning rate to 0.0037262232421
Validation loss decreased (inf --> 0.2935).  Saving model state dict ...
Epoch: 1 cost time: 2.8208937644958496
Epoch: 1, Steps: 523 | Train Loss: 0.5010090 Vali Loss: 0.2934881 Best vali loss: 0.2934881
	iters: 100, epoch: 2 | loss: 0.3504660
	speed: 0.0141s/iter; left time: 50.2240s
	iters: 200, epoch: 2 | loss: 0.7513702
	speed: 0.0056s/iter; left time: 19.2321s
	iters: 300, epoch: 2 | loss: 0.3063526
	speed: 0.0038s/iter; left time: 12.9429s
	iters: 400, epoch: 2 | loss: 0.5294715
	speed: 0.0031s/iter; left time: 10.1204s
	iters: 500, epoch: 2 | loss: 0.6097861
	speed: 0.0030s/iter; left time: 9.5245s
Updating learning rate to 0.00186311162105
Validation loss decreased (0.2935 --> 0.2927).  Saving model state dict ...
Epoch: 2 cost time: 2.2311058044433594
Epoch: 2, Steps: 523 | Train Loss: 0.5094893 Vali Loss: 0.2926555 Best vali loss: 0.2926555
	iters: 100, epoch: 3 | loss: 0.2946020
	speed: 0.0118s/iter; left time: 35.8599s
	iters: 200, epoch: 3 | loss: 0.4483448
	speed: 0.0048s/iter; left time: 14.0013s
	iters: 300, epoch: 3 | loss: 0.4135760
	speed: 0.0046s/iter; left time: 13.0521s
	iters: 400, epoch: 3 | loss: 0.7669947
	speed: 0.0047s/iter; left time: 12.9956s
	iters: 500, epoch: 3 | loss: 0.5723913
	speed: 0.0042s/iter; left time: 11.0636s
Updating learning rate to 0.000931555810525
Epoch: 3 cost time: 2.4730730056762695
Epoch: 3, Steps: 523 | Train Loss: 0.4991818 Vali Loss: 0.3056191 Best vali loss: 0.2926555
	iters: 100, epoch: 4 | loss: 0.4438822
	speed: 0.0096s/iter; left time: 24.1423s
	iters: 200, epoch: 4 | loss: 0.2909106
	speed: 0.0040s/iter; left time: 9.6360s
	iters: 300, epoch: 4 | loss: 0.4043917
	speed: 0.0036s/iter; left time: 8.4481s
	iters: 400, epoch: 4 | loss: 0.3026813
	speed: 0.0048s/iter; left time: 10.7225s
	iters: 500, epoch: 4 | loss: 0.2835198
	speed: 0.0048s/iter; left time: 10.1337s
Updating learning rate to 0.0004657779052625
Epoch: 4 cost time: 2.225947618484497
Epoch: 4, Steps: 523 | Train Loss: 0.3450771 Vali Loss: 0.3055497 Best vali loss: 0.2926555
	iters: 100, epoch: 5 | loss: 0.5586877
	speed: 0.0132s/iter; left time: 26.3320s
	iters: 200, epoch: 5 | loss: 0.3618923
	speed: 0.0045s/iter; left time: 8.4637s
	iters: 300, epoch: 5 | loss: 0.3317213
	speed: 0.0043s/iter; left time: 7.7784s
	iters: 400, epoch: 5 | loss: 0.5073247
	speed: 0.0033s/iter; left time: 5.6292s
	iters: 500, epoch: 5 | loss: 1.0730549
	speed: 0.0032s/iter; left time: 5.1565s
Updating learning rate to 0.00023288895263125
Epoch: 5 cost time: 2.1941452026367188
Epoch: 5, Steps: 523 | Train Loss: 0.5665362 Vali Loss: 0.3105366 Best vali loss: 0.2926555
	iters: 100, epoch: 6 | loss: 0.5829574
	speed: 0.0121s/iter; left time: 17.8565s
	iters: 200, epoch: 6 | loss: 0.3753757
	speed: 0.0046s/iter; left time: 6.2570s
	iters: 300, epoch: 6 | loss: 0.5739910
	speed: 0.0048s/iter; left time: 6.0606s
	iters: 400, epoch: 6 | loss: 0.3780652
	speed: 0.0047s/iter; left time: 5.5221s
	iters: 500, epoch: 6 | loss: 0.2732185
	speed: 0.0048s/iter; left time: 5.1363s
Updating learning rate to 0.000116444476315625
Epoch: 6 cost time: 2.5453109741210938
Epoch: 6, Steps: 523 | Train Loss: 0.4367216 Vali Loss: 0.3103612 Best vali loss: 0.2926555
	iters: 100, epoch: 7 | loss: 0.4361058
	speed: 0.0129s/iter; left time: 12.2415s
	iters: 200, epoch: 7 | loss: 0.4808229
	speed: 0.0044s/iter; left time: 3.7524s
	iters: 300, epoch: 7 | loss: 0.3698477
	speed: 0.0046s/iter; left time: 3.4664s
	iters: 400, epoch: 7 | loss: 0.3017722
	speed: 0.0043s/iter; left time: 2.7839s
	iters: 500, epoch: 7 | loss: 0.2221137
	speed: 0.0044s/iter; left time: 2.4156s
Updating learning rate to 5.82222381578125e-05
Epoch: 7 cost time: 2.4075446128845215
Epoch: 7, Steps: 523 | Train Loss: 0.3621324 Vali Loss: 0.3119865 Best vali loss: 0.2926555
	iters: 100, epoch: 8 | loss: 0.3088283
	speed: 0.0134s/iter; left time: 5.6637s
	iters: 200, epoch: 8 | loss: 0.2465099
	speed: 0.0045s/iter; left time: 1.4627s
	iters: 300, epoch: 8 | loss: 0.4904789
	speed: 0.0045s/iter; left time: 1.0007s
	iters: 400, epoch: 8 | loss: 0.4841636
	speed: 0.0046s/iter; left time: 0.5708s
	iters: 500, epoch: 8 | loss: 0.4406381
	speed: 0.0047s/iter; left time: 0.1121s
Updating learning rate to 2.911111907890625e-05
Epoch: 8 cost time: 2.4830031394958496
Epoch: 8, Steps: 523 | Train Loss: 0.3941237 Vali Loss: 0.3126384 Best vali loss: 0.2926555

best validation loss 0.29265545801785675

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4425441
	speed: 0.0184s/iter; left time: 36.8303s
	iters: 200, epoch: 1 | loss: 0.4176175
	speed: 0.0123s/iter; left time: 23.2602s
Updating learning rate to 0.0006308326133
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 3.427557945251465
Epoch: 1, Steps: 262 | Train Loss: 0.4300808 Vali Loss: 0.2829036 Best vali loss: 0.2829036
	iters: 100, epoch: 2 | loss: 0.4620624
	speed: 0.0285s/iter; left time: 49.4319s
	iters: 200, epoch: 2 | loss: 0.4505635
	speed: 0.0118s/iter; left time: 19.3581s
Updating learning rate to 0.00031541630665
Epoch: 2 cost time: 3.25197172164917
Epoch: 2, Steps: 262 | Train Loss: 0.4563130 Vali Loss: 0.2857477 Best vali loss: 0.2829036
	iters: 100, epoch: 3 | loss: 0.4251529
	speed: 0.0288s/iter; left time: 42.4281s
	iters: 200, epoch: 3 | loss: 0.3108828
	speed: 0.0114s/iter; left time: 15.7204s
Updating learning rate to 0.000157708153325
Epoch: 3 cost time: 2.9738824367523193
Epoch: 3, Steps: 262 | Train Loss: 0.3680179 Vali Loss: 0.2917437 Best vali loss: 0.2829036

best validation loss 0.2829035971412077

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0012001254164, 'e_layers': 4, 'learning_rate': 0.0023576737954, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4611720
	speed: 0.0194s/iter; left time: 38.8233s
	iters: 200, epoch: 1 | loss: 0.3528663
	speed: 0.0081s/iter; left time: 15.4053s
Updating learning rate to 0.0022679401796541314
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 3.1374094486236572
Epoch: 1, Steps: 262 | Train Loss: 0.4070191 Vali Loss: 0.2939790 Best vali loss: 0.2939790
	iters: 100, epoch: 2 | loss: 0.9157101
	speed: 0.0297s/iter; left time: 51.4547s
	iters: 200, epoch: 2 | loss: 0.4925433
	speed: 0.0124s/iter; left time: 20.2000s
Updating learning rate to 0.0020124004619765825
Epoch: 2 cost time: 3.205538034439087
Epoch: 2, Steps: 262 | Train Loss: 0.7041267 Vali Loss: 0.3007078 Best vali loss: 0.2939790
	iters: 100, epoch: 3 | loss: 0.8223004
	speed: 0.0307s/iter; left time: 45.2225s
	iters: 200, epoch: 3 | loss: 0.4669032
	speed: 0.0117s/iter; left time: 16.0167s
Updating learning rate to 0.0016299582479104503
Validation loss decreased (0.2940 --> 0.2902).  Saving model state dict ...
Epoch: 3 cost time: 3.0603067874908447
Epoch: 3, Steps: 262 | Train Loss: 0.6446018 Vali Loss: 0.2901901 Best vali loss: 0.2901901

best validation loss 0.2901900724080825

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022248985917, 'e_layers': 3, 'learning_rate': 0.0006809792963, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006550610651077546
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 2.2766997814178467
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2864468 Best vali loss: 0.2864468
Updating learning rate to 0.0005812521872806866
Epoch: 2 cost time: 1.5038349628448486
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2872688 Best vali loss: 0.2864468
Updating learning rate to 0.0004707893953888238
Validation loss decreased (0.2864 --> 0.2843).  Saving model state dict ...
Epoch: 3 cost time: 1.3849663734436035
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2842565 Best vali loss: 0.2842565

best validation loss 0.2842565317409284

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3739285
	speed: 0.0212s/iter; left time: 25.6849s
	iters: 200, epoch: 4 | loss: 0.3573359
	speed: 0.0115s/iter; left time: 12.8276s
Updating learning rate to 7.88540766625e-05
Epoch: 4 cost time: 3.4190967082977295
Epoch: 4, Steps: 262 | Train Loss: 0.3656322 Vali Loss: 0.2981737 Best vali loss: 0.2829036
	iters: 100, epoch: 5 | loss: 0.4002992
	speed: 0.0186s/iter; left time: 17.6207s
	iters: 200, epoch: 5 | loss: 0.4602473
	speed: 0.0083s/iter; left time: 7.0329s
Updating learning rate to 3.942703833125e-05
Epoch: 5 cost time: 2.2526633739471436
Epoch: 5, Steps: 262 | Train Loss: 0.4302732 Vali Loss: 0.2983399 Best vali loss: 0.2829036
	iters: 100, epoch: 6 | loss: 0.4157912
	speed: 0.0183s/iter; left time: 12.5768s
	iters: 200, epoch: 6 | loss: 0.2683649
	speed: 0.0081s/iter; left time: 4.7410s
Updating learning rate to 1.9713519165625e-05
Epoch: 6 cost time: 2.2655086517333984
Epoch: 6, Steps: 262 | Train Loss: 0.3420780 Vali Loss: 0.2952186 Best vali loss: 0.2829036
	iters: 100, epoch: 7 | loss: 0.5940109
	speed: 0.0195s/iter; left time: 8.2683s
	iters: 200, epoch: 7 | loss: 0.3611186
	speed: 0.0095s/iter; left time: 3.0741s
Updating learning rate to 9.8567595828125e-06
Epoch: 7 cost time: 2.5094153881073
Epoch: 7, Steps: 262 | Train Loss: 0.4775648 Vali Loss: 0.2988691 Best vali loss: 0.2829036
	iters: 100, epoch: 8 | loss: 0.3479648
	speed: 0.0195s/iter; left time: 3.1832s
	iters: 200, epoch: 8 | loss: 0.3349553
	speed: 0.0094s/iter; left time: 0.5892s
Updating learning rate to 4.92837979140625e-06
Epoch: 8 cost time: 2.4878733158111572
Epoch: 8, Steps: 262 | Train Loss: 0.3414600 Vali Loss: 0.3007086 Best vali loss: 0.2829036

best validation loss 0.2829035971412077

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0046655666653, 'e_layers': 4, 'learning_rate': 7.57219308e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3560472
	speed: 0.0155s/iter; left time: 30.9620s
	iters: 200, epoch: 1 | loss: 0.6225324
	speed: 0.0128s/iter; left time: 24.2127s
Updating learning rate to 7.57219308e-05
Validation loss decreased (inf --> 0.3294).  Saving model state dict ...
Epoch: 1 cost time: 3.2876789569854736
Epoch: 1, Steps: 262 | Train Loss: 0.4892898 Vali Loss: 0.3293550 Best vali loss: 0.3293550
	iters: 100, epoch: 2 | loss: 0.5663179
	speed: 0.0249s/iter; left time: 43.1242s
	iters: 200, epoch: 2 | loss: 0.4182326
	speed: 0.0120s/iter; left time: 19.5741s
Updating learning rate to 3.78609654e-05
Validation loss decreased (0.3294 --> 0.3105).  Saving model state dict ...
Epoch: 2 cost time: 3.181255578994751
Epoch: 2, Steps: 262 | Train Loss: 0.4922753 Vali Loss: 0.3104696 Best vali loss: 0.3104696
	iters: 100, epoch: 3 | loss: 0.7271377
	speed: 0.0226s/iter; left time: 33.2844s
	iters: 200, epoch: 3 | loss: 0.5437003
	speed: 0.0124s/iter; left time: 16.9602s
Updating learning rate to 1.89304827e-05
Validation loss decreased (0.3105 --> 0.3049).  Saving model state dict ...
Epoch: 3 cost time: 3.0912928581237793
Epoch: 3, Steps: 262 | Train Loss: 0.6354190 Vali Loss: 0.3048811 Best vali loss: 0.3048811
	iters: 100, epoch: 4 | loss: 0.3350474
	speed: 0.0255s/iter; left time: 30.8357s
	iters: 200, epoch: 4 | loss: 0.7085831
	speed: 0.0123s/iter; left time: 13.6353s
Updating learning rate to 9.46524135e-06
Validation loss decreased (0.3049 --> 0.3027).  Saving model state dict ...
Epoch: 4 cost time: 3.2572896480560303
Epoch: 4, Steps: 262 | Train Loss: 0.5218152 Vali Loss: 0.3026972 Best vali loss: 0.3026972
	iters: 100, epoch: 5 | loss: 0.7962421
	speed: 0.0267s/iter; left time: 25.3660s
	iters: 200, epoch: 5 | loss: 0.6035411
	speed: 0.0123s/iter; left time: 10.4796s
Updating learning rate to 4.732620675e-06
Validation loss decreased (0.3027 --> 0.3017).  Saving model state dict ...
Epoch: 5 cost time: 3.273395299911499
Epoch: 5, Steps: 262 | Train Loss: 0.6998916 Vali Loss: 0.3016985 Best vali loss: 0.3016985
	iters: 100, epoch: 6 | loss: 0.5367939
	speed: 0.0251s/iter; left time: 17.2561s
	iters: 200, epoch: 6 | loss: 0.3774108
	speed: 0.0122s/iter; left time: 7.1853s
Updating learning rate to 2.3663103375e-06
Validation loss decreased (0.3017 --> 0.3012).  Saving model state dict ...
Epoch: 6 cost time: 3.2509663105010986
Epoch: 6, Steps: 262 | Train Loss: 0.4571024 Vali Loss: 0.3011837 Best vali loss: 0.3011837
	iters: 100, epoch: 7 | loss: 0.7988974
	speed: 0.0232s/iter; left time: 9.8633s
	iters: 200, epoch: 7 | loss: 0.6782048
	speed: 0.0124s/iter; left time: 4.0178s
Updating learning rate to 1.18315516875e-06
Validation loss decreased (0.3012 --> 0.3009).  Saving model state dict ...
Epoch: 7 cost time: 3.1191577911376953
Epoch: 7, Steps: 262 | Train Loss: 0.7385511 Vali Loss: 0.3009360 Best vali loss: 0.3009360
	iters: 100, epoch: 8 | loss: 0.4205047
	speed: 0.0256s/iter; left time: 4.1693s
	iters: 200, epoch: 8 | loss: 0.4132731
	speed: 0.0123s/iter; left time: 0.7754s
Updating learning rate to 5.91577584375e-07
Validation loss decreased (0.3009 --> 0.3008).  Saving model state dict ...
Epoch: 8 cost time: 3.3548355102539062
Epoch: 8, Steps: 262 | Train Loss: 0.4168889 Vali Loss: 0.3008172 Best vali loss: 0.3008172

best validation loss 0.30081717151831233

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061646239199, 'e_layers': 2, 'learning_rate': 6.25759351e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7004843
	speed: 0.0163s/iter; left time: 134.7841s
	iters: 200, epoch: 1 | loss: 0.2506598
	speed: 0.0096s/iter; left time: 78.1367s
	iters: 300, epoch: 1 | loss: 0.3972047
	speed: 0.0092s/iter; left time: 74.0703s
	iters: 400, epoch: 1 | loss: 0.2330400
	speed: 0.0089s/iter; left time: 70.6453s
	iters: 500, epoch: 1 | loss: 0.8910363
	speed: 0.0090s/iter; left time: 70.4411s
	iters: 600, epoch: 1 | loss: 0.2581248
	speed: 0.0091s/iter; left time: 70.6413s
	iters: 700, epoch: 1 | loss: 0.6241414
	speed: 0.0079s/iter; left time: 60.7060s
	iters: 800, epoch: 1 | loss: 0.4063911
	speed: 0.0067s/iter; left time: 50.9088s
	iters: 900, epoch: 1 | loss: 0.3422022
	speed: 0.0093s/iter; left time: 69.2654s
	iters: 1000, epoch: 1 | loss: 1.1716619
	speed: 0.0096s/iter; left time: 70.3386s
Updating learning rate to 6.0194280383322307e-05
Validation loss decreased (inf --> 0.2788).  Saving model state dict ...
Epoch: 1 cost time: 9.676493406295776
Epoch: 1, Steps: 1045 | Train Loss: 0.5274947 Vali Loss: 0.2787644 Best vali loss: 0.2787644
	iters: 100, epoch: 2 | loss: 0.7357600
	speed: 0.0340s/iter; left time: 245.3235s
	iters: 200, epoch: 2 | loss: 0.2678488
	speed: 0.0096s/iter; left time: 68.1051s
	iters: 300, epoch: 2 | loss: 0.2911756
	speed: 0.0075s/iter; left time: 52.3183s
	iters: 400, epoch: 2 | loss: 0.5004764
	speed: 0.0076s/iter; left time: 52.7417s
	iters: 500, epoch: 2 | loss: 1.3501039
	speed: 0.0091s/iter; left time: 61.7991s
	iters: 600, epoch: 2 | loss: 0.3249890
	speed: 0.0093s/iter; left time: 62.2330s
	iters: 700, epoch: 2 | loss: 0.4781653
	speed: 0.0108s/iter; left time: 71.3477s
	iters: 800, epoch: 2 | loss: 1.1670017
	speed: 0.0110s/iter; left time: 71.8635s
	iters: 900, epoch: 2 | loss: 0.4977432
	speed: 0.0107s/iter; left time: 68.6319s
	iters: 1000, epoch: 2 | loss: 0.8517003
	speed: 0.0096s/iter; left time: 60.4274s
Updating learning rate to 5.341190157414965e-05
Epoch: 2 cost time: 9.788285970687866
Epoch: 2, Steps: 1045 | Train Loss: 0.6464964 Vali Loss: 0.2792068 Best vali loss: 0.2787644
	iters: 100, epoch: 3 | loss: 0.2514716
	speed: 0.0389s/iter; left time: 239.9257s
	iters: 200, epoch: 3 | loss: 0.8999191
	speed: 0.0155s/iter; left time: 93.8519s
	iters: 300, epoch: 3 | loss: 0.2555918
	speed: 0.0093s/iter; left time: 55.6443s
	iters: 400, epoch: 3 | loss: 0.1740195
	speed: 0.0094s/iter; left time: 55.1450s
	iters: 500, epoch: 3 | loss: 0.6849605
	speed: 0.0089s/iter; left time: 51.6244s
	iters: 600, epoch: 3 | loss: 0.3837560
	speed: 0.0071s/iter; left time: 40.0868s
	iters: 700, epoch: 3 | loss: 1.1440555
	speed: 0.0043s/iter; left time: 23.9328s
	iters: 800, epoch: 3 | loss: 0.4578439
	speed: 0.0045s/iter; left time: 24.8717s
	iters: 900, epoch: 3 | loss: 0.2205291
	speed: 0.0049s/iter; left time: 26.2142s
	iters: 1000, epoch: 3 | loss: 0.6324286
	speed: 0.0051s/iter; left time: 26.6330s
Updating learning rate to 4.326135436376155e-05
Validation loss decreased (0.2788 --> 0.2766).  Saving model state dict ...
Epoch: 3 cost time: 8.550713777542114
Epoch: 3, Steps: 1045 | Train Loss: 0.5104576 Vali Loss: 0.2765608 Best vali loss: 0.2765608
	iters: 100, epoch: 4 | loss: 0.8395129
	speed: 0.0301s/iter; left time: 154.2093s
	iters: 200, epoch: 4 | loss: 0.4307367
	speed: 0.0056s/iter; left time: 27.9824s
	iters: 300, epoch: 4 | loss: 0.3764888
	speed: 0.0094s/iter; left time: 46.2795s
	iters: 400, epoch: 4 | loss: 0.4242411
	speed: 0.0098s/iter; left time: 47.1704s
	iters: 500, epoch: 4 | loss: 0.2298883
	speed: 0.0099s/iter; left time: 46.7812s
	iters: 600, epoch: 4 | loss: 0.9735155
	speed: 0.0085s/iter; left time: 39.3802s
	iters: 700, epoch: 4 | loss: 0.2320626
	speed: 0.0097s/iter; left time: 44.0374s
	iters: 800, epoch: 4 | loss: 0.3393665
	speed: 0.0104s/iter; left time: 45.8695s
	iters: 900, epoch: 4 | loss: 0.1958760
	speed: 0.0071s/iter; left time: 30.6232s
	iters: 1000, epoch: 4 | loss: 0.3009198
	speed: 0.0050s/iter; left time: 20.9298s
Updating learning rate to 3.128796755e-05
Epoch: 4 cost time: 8.872713804244995
Epoch: 4, Steps: 1045 | Train Loss: 0.4342608 Vali Loss: 0.2768096 Best vali loss: 0.2765608
	iters: 100, epoch: 5 | loss: 0.4955616
	speed: 0.0338s/iter; left time: 137.8334s
	iters: 200, epoch: 5 | loss: 0.5277203
	speed: 0.0103s/iter; left time: 41.1457s
	iters: 300, epoch: 5 | loss: 0.7318547
	speed: 0.0103s/iter; left time: 40.0452s
	iters: 400, epoch: 5 | loss: 0.2647643
	speed: 0.0092s/iter; left time: 34.7653s
	iters: 500, epoch: 5 | loss: 0.7494772
	speed: 0.0097s/iter; left time: 35.8523s
	iters: 600, epoch: 5 | loss: 0.6236795
	speed: 0.0077s/iter; left time: 27.5171s
	iters: 700, epoch: 5 | loss: 0.9605635
	speed: 0.0096s/iter; left time: 33.2801s
	iters: 800, epoch: 5 | loss: 0.3270417
	speed: 0.0085s/iter; left time: 28.7943s
	iters: 900, epoch: 5 | loss: 0.3490005
	speed: 0.0108s/iter; left time: 35.5511s
	iters: 1000, epoch: 5 | loss: 0.6638542
	speed: 0.0115s/iter; left time: 36.5364s
Updating learning rate to 1.931458073623845e-05
Epoch: 5 cost time: 10.242993354797363
Epoch: 5, Steps: 1045 | Train Loss: 0.5693518 Vali Loss: 0.2859903 Best vali loss: 0.2765608
	iters: 100, epoch: 6 | loss: 0.2488563
	speed: 0.0358s/iter; left time: 108.8011s
	iters: 200, epoch: 6 | loss: 0.7346836
	speed: 0.0080s/iter; left time: 23.3477s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.00166646187, 'e_layers': 2, 'learning_rate': 0.0002169203187, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002169203187
Validation loss decreased (inf --> 0.3324).  Saving model state dict ...
Epoch: 1 cost time: 1.5450918674468994
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3323621 Best vali loss: 0.3323621
Updating learning rate to 0.00010846015935
Validation loss decreased (0.3324 --> 0.3134).  Saving model state dict ...
Epoch: 2 cost time: 1.0195622444152832
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3133781 Best vali loss: 0.3133781
Updating learning rate to 5.4230079675e-05
Validation loss decreased (0.3134 --> 0.3066).  Saving model state dict ...
Epoch: 3 cost time: 1.114891767501831
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3066371 Best vali loss: 0.3066371

best validation loss 0.3066370713307362

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0025680704581, 'e_layers': 3, 'learning_rate': 0.0011684292098, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6230488
	speed: 0.0152s/iter; left time: 125.7023s
	iters: 200, epoch: 1 | loss: 0.3485605
	speed: 0.0097s/iter; left time: 79.4903s
	iters: 300, epoch: 1 | loss: 1.3724245
	speed: 0.0100s/iter; left time: 80.4493s
	iters: 400, epoch: 1 | loss: 0.4494724
	speed: 0.0096s/iter; left time: 76.6994s
	iters: 500, epoch: 1 | loss: 0.3055574
	speed: 0.0096s/iter; left time: 75.8296s
	iters: 600, epoch: 1 | loss: 0.7468588
	speed: 0.0091s/iter; left time: 70.5305s
	iters: 700, epoch: 1 | loss: 1.1548412
	speed: 0.0085s/iter; left time: 65.4239s
	iters: 800, epoch: 1 | loss: 0.4058412
	speed: 0.0090s/iter; left time: 67.8661s
	iters: 900, epoch: 1 | loss: 0.4967669
	speed: 0.0095s/iter; left time: 70.9431s
	iters: 1000, epoch: 1 | loss: 0.6014653
	speed: 0.0097s/iter; left time: 71.4130s
Updating learning rate to 0.0011684292098
Validation loss decreased (inf --> 0.3357).  Saving model state dict ...
Epoch: 1 cost time: 10.150683879852295
Epoch: 1, Steps: 1045 | Train Loss: 0.6504837 Vali Loss: 0.3356664 Best vali loss: 0.3356664
	iters: 100, epoch: 2 | loss: 2.1851797
	speed: 0.0310s/iter; left time: 224.0081s
	iters: 200, epoch: 2 | loss: 0.3372814
	speed: 0.0079s/iter; left time: 56.2459s
	iters: 300, epoch: 2 | loss: 1.4810978
	speed: 0.0077s/iter; left time: 54.1741s
	iters: 400, epoch: 2 | loss: 0.4809771
	speed: 0.0092s/iter; left time: 63.8122s
	iters: 500, epoch: 2 | loss: 0.5460383
	speed: 0.0096s/iter; left time: 65.2461s
	iters: 600, epoch: 2 | loss: 0.4602349
	speed: 0.0094s/iter; left time: 63.4114s
	iters: 700, epoch: 2 | loss: 1.3445579
	speed: 0.0097s/iter; left time: 64.4674s
	iters: 800, epoch: 2 | loss: 1.0528952
	speed: 0.0095s/iter; left time: 61.6184s
	iters: 900, epoch: 2 | loss: 0.2773716
	speed: 0.0078s/iter; left time: 50.1787s
	iters: 1000, epoch: 2 | loss: 1.2390653
	speed: 0.0085s/iter; left time: 53.7710s
Updating learning rate to 0.0005842146049
Validation loss decreased (0.3357 --> 0.3228).  Saving model state dict ...
Epoch: 2 cost time: 9.369190454483032
Epoch: 2, Steps: 1045 | Train Loss: 0.9404699 Vali Loss: 0.3227989 Best vali loss: 0.3227989
	iters: 100, epoch: 3 | loss: 0.2022382
	speed: 0.0313s/iter; left time: 193.0201s
	iters: 200, epoch: 3 | loss: 0.3839954
	speed: 0.0099s/iter; left time: 59.8038s
	iters: 300, epoch: 3 | loss: 1.1178466
	speed: 0.0094s/iter; left time: 56.0681s
	iters: 400, epoch: 3 | loss: 0.4711210
	speed: 0.0091s/iter; left time: 53.1973s
	iters: 500, epoch: 3 | loss: 0.2386398
	speed: 0.0091s/iter; left time: 52.2637s
	iters: 600, epoch: 3 | loss: 0.4867734
	speed: 0.0096s/iter; left time: 54.1687s
	iters: 700, epoch: 3 | loss: 0.3901020
	speed: 0.0097s/iter; left time: 53.8092s
	iters: 800, epoch: 3 | loss: 0.3129829
	speed: 0.0094s/iter; left time: 51.6336s
	iters: 900, epoch: 3 | loss: 0.5199486
	speed: 0.0097s/iter; left time: 51.9489s
	iters: 1000, epoch: 3 | loss: 0.5182807
	speed: 0.0091s/iter; left time: 48.1006s
Updating learning rate to 0.00029210730245
Validation loss decreased (0.3228 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 9.883089542388916
Epoch: 3, Steps: 1045 | Train Loss: 0.4641929 Vali Loss: 0.3225674 Best vali loss: 0.3225674

best validation loss 0.3225674262140798

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022180841037, 'e_layers': 4, 'learning_rate': 0.0009753388759, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5158814
	speed: 0.0172s/iter; left time: 34.3753s
	iters: 200, epoch: 1 | loss: 0.4668187
	speed: 0.0107s/iter; left time: 20.2403s
Updating learning rate to 0.0009753388759
Validation loss decreased (inf --> 0.3068).  Saving model state dict ...
Epoch: 1 cost time: 3.1415514945983887
Epoch: 1, Steps: 262 | Train Loss: 0.4913501 Vali Loss: 0.3067785 Best vali loss: 0.3067785
	iters: 100, epoch: 2 | loss: 0.6433064
	speed: 0.0210s/iter; left time: 36.5162s
	iters: 200, epoch: 2 | loss: 0.6605403
	speed: 0.0104s/iter; left time: 16.9648s
Updating learning rate to 0.00048766943795
Validation loss decreased (0.3068 --> 0.2980).  Saving model state dict ...
Epoch: 2 cost time: 2.611299991607666
Epoch: 2, Steps: 262 | Train Loss: 0.6519234 Vali Loss: 0.2980226 Best vali loss: 0.2980226
	iters: 100, epoch: 3 | loss: 0.4165259
	speed: 0.0228s/iter; left time: 33.5251s
	iters: 200, epoch: 3 | loss: 0.6574115
	speed: 0.0121s/iter; left time: 16.5484s
Updating learning rate to 0.000243834718975
Validation loss decreased (0.2980 --> 0.2976).  Saving model state dict ...
Epoch: 3 cost time: 3.0422682762145996
Epoch: 3, Steps: 262 | Train Loss: 0.5369687 Vali Loss: 0.2976417 Best vali loss: 0.2976417

best validation loss 0.29764171756524144

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022180841037, 'e_layers': 4, 'learning_rate': 0.0009753388759, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4957584
	speed: 0.0249s/iter; left time: 30.1320s
	iters: 200, epoch: 4 | loss: 0.4351981
	speed: 0.0125s/iter; left time: 13.9243s
Updating learning rate to 0.0001219173594875
Validation loss decreased (0.2976 --> 0.2951).  Saving model state dict ...
Epoch: 4 cost time: 3.728433609008789
Epoch: 4, Steps: 262 | Train Loss: 0.4654783 Vali Loss: 0.2950542 Best vali loss: 0.2950542
	iters: 100, epoch: 5 | loss: 0.6336606
	speed: 0.0210s/iter; left time: 19.9736s
	iters: 200, epoch: 5 | loss: 0.3669189
	speed: 0.0126s/iter; left time: 10.7223s
Updating learning rate to 6.095867974375e-05
Validation loss decreased (0.2951 --> 0.2902).  Saving model state dict ...
Epoch: 5 cost time: 3.3318488597869873
Epoch: 5, Steps: 262 | Train Loss: 0.5002897 Vali Loss: 0.2902307 Best vali loss: 0.2902307
	iters: 100, epoch: 6 | loss: 0.3956362
	speed: 0.0382s/iter; left time: 26.2284s
	iters: 200, epoch: 6 | loss: 0.5370041
	speed: 0.0149s/iter; left time: 8.7573s
Updating learning rate to 3.0479339871875e-05
Epoch: 6 cost time: 3.820235252380371
Epoch: 6, Steps: 262 | Train Loss: 0.4663201 Vali Loss: 0.2925460 Best vali loss: 0.2902307
	iters: 100, epoch: 7 | loss: 0.6405545
	speed: 0.0516s/iter; left time: 21.9373s
	iters: 200, epoch: 7 | loss: 0.6182775
	speed: 0.0160s/iter; left time: 5.2083s
Updating learning rate to 1.52396699359375e-05
Epoch: 7 cost time: 4.445155143737793
Epoch: 7, Steps: 262 | Train Loss: 0.6294160 Vali Loss: 0.2924491 Best vali loss: 0.2902307
	iters: 100, epoch: 8 | loss: 0.1749109
	speed: 0.0500s/iter; left time: 8.1509s
	iters: 200, epoch: 8 | loss: 0.5297409
	speed: 0.0154s/iter; left time: 0.9717s
Updating learning rate to 7.61983496796875e-06
Epoch: 8 cost time: 4.071498394012451
Epoch: 8, Steps: 262 | Train Loss: 0.3523259 Vali Loss: 0.2923995 Best vali loss: 0.2902307

best validation loss 0.29023072371787856

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0070827402691, 'e_layers': 4, 'learning_rate': 0.0002755954597, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6967306
	speed: 0.0223s/iter; left time: 91.2888s
	iters: 200, epoch: 1 | loss: 0.5444832
	speed: 0.0123s/iter; left time: 48.9657s
	iters: 300, epoch: 1 | loss: 0.5561347
	speed: 0.0115s/iter; left time: 44.7417s
	iters: 400, epoch: 1 | loss: 0.3472570
	speed: 0.0106s/iter; left time: 40.1995s
	iters: 500, epoch: 1 | loss: 0.4493935
	speed: 0.0152s/iter; left time: 56.1133s
Updating learning rate to 0.0002755954597
Validation loss decreased (inf --> 0.2942).  Saving model state dict ...
Epoch: 1 cost time: 7.2311224937438965
Epoch: 1, Steps: 523 | Train Loss: 0.5187998 Vali Loss: 0.2941948 Best vali loss: 0.2941948
	iters: 100, epoch: 2 | loss: 0.3729357
	speed: 0.0210s/iter; left time: 74.9111s
	iters: 200, epoch: 2 | loss: 0.5381960
	speed: 0.0118s/iter; left time: 40.8838s
	iters: 300, epoch: 2 | loss: 0.3069125
	speed: 0.0120s/iter; left time: 40.2003s
	iters: 400, epoch: 2 | loss: 0.8598379
	speed: 0.0103s/iter; left time: 33.5607s
	iters: 500, epoch: 2 | loss: 0.2839968
	speed: 0.0116s/iter; left time: 36.5517s
Updating learning rate to 0.00013779772985
Epoch: 2 cost time: 5.766463994979858
Epoch: 2, Steps: 523 | Train Loss: 0.4723758 Vali Loss: 0.3179466 Best vali loss: 0.2941948
	iters: 100, epoch: 3 | loss: 0.4692777
	speed: 0.0237s/iter; left time: 71.9225s
	iters: 200, epoch: 3 | loss: 0.2724617
	speed: 0.0114s/iter; left time: 33.4156s
	iters: 300, epoch: 3 | loss: 0.4225043
	speed: 0.0098s/iter; left time: 27.9128s
	iters: 400, epoch: 3 | loss: 0.2245514
	speed: 0.0097s/iter; left time: 26.5056s
	iters: 500, epoch: 3 | loss: 0.3370369
	speed: 0.0114s/iter; left time: 30.0933s
Updating learning rate to 6.8898864925e-05
Validation loss decreased (0.2942 --> 0.2859).  Saving model state dict ...
Epoch: 3 cost time: 5.723115682601929
Epoch: 3, Steps: 523 | Train Loss: 0.3451664 Vali Loss: 0.2859042 Best vali loss: 0.2859042
	iters: 100, epoch: 4 | loss: 0.4035909
	speed: 0.0234s/iter; left time: 58.9542s
	iters: 200, epoch: 4 | loss: 0.3418086
	speed: 0.0109s/iter; left time: 26.4525s
	iters: 300, epoch: 4 | loss: 0.5752180
	speed: 0.0112s/iter; left time: 25.8705s
	iters: 400, epoch: 4 | loss: 0.4033207
	speed: 0.0115s/iter; left time: 25.5172s
	iters: 500, epoch: 4 | loss: 0.5064537
	speed: 0.0114s/iter; left time: 24.1695s
Updating learning rate to 3.44494324625e-05
Epoch: 4 cost time: 5.943909406661987
Epoch: 4, Steps: 523 | Train Loss: 0.4460784 Vali Loss: 0.2870731 Best vali loss: 0.2859042
	iters: 100, epoch: 5 | loss: 0.3436904
	speed: 0.0212s/iter; left time: 42.2815s
	iters: 200, epoch: 5 | loss: 0.3492897
	speed: 0.0113s/iter; left time: 21.3940s
	iters: 300, epoch: 5 | loss: 0.5016864
	speed: 0.0117s/iter; left time: 20.9555s
	iters: 400, epoch: 5 | loss: 0.2825885
	speed: 0.0116s/iter; left time: 19.7063s
	iters: 500, epoch: 5 | loss: 0.3789398
	speed: 0.0116s/iter; left time: 18.5046s
Updating learning rate to 1.722471623125e-05
Epoch: 5 cost time: 6.00225043296814
Epoch: 5, Steps: 523 | Train Loss: 0.3712390 Vali Loss: 0.2932727 Best vali loss: 0.2859042
	iters: 100, epoch: 6 | loss: 0.2923233
	speed: 0.0222s/iter; left time: 32.7015s
	iters: 200, epoch: 6 | loss: 0.2129953
	speed: 0.0103s/iter; left time: 14.0455s
	iters: 300, epoch: 6 | loss: 0.2430763
	speed: 0.0103s/iter; left time: 13.0253s
	iters: 400, epoch: 6 | loss: 0.2589019
	speed: 0.0113s/iter; left time: 13.2656s
	iters: 500, epoch: 6 | loss: 0.3177596
	speed: 0.0112s/iter; left time: 12.0033s
Updating learning rate to 8.612358115625e-06
Epoch: 6 cost time: 5.738862037658691
Epoch: 6, Steps: 523 | Train Loss: 0.2650113 Vali Loss: 0.2977101 Best vali loss: 0.2859042
	iters: 100, epoch: 7 | loss: 0.3896178
	speed: 0.0241s/iter; left time: 22.7898s
	iters: 200, epoch: 7 | loss: 0.3792252
	speed: 0.0118s/iter; left time: 9.9737s
	iters: 300, epoch: 7 | loss: 0.3447339
	speed: 0.0109s/iter; left time: 8.1090s
	iters: 400, epoch: 7 | loss: 0.2344509
	speed: 0.0115s/iter; left time: 7.4515s
	iters: 500, epoch: 7 | loss: 0.4582296
	speed: 0.0108s/iter; left time: 5.9303s
Updating learning rate to 4.3061790578125e-06
Epoch: 7 cost time: 5.9775426387786865
Epoch: 7, Steps: 523 | Train Loss: 0.3612515 Vali Loss: 0.2973838 Best vali loss: 0.2859042
	iters: 100, epoch: 8 | loss: 0.2692051
	speed: 0.0231s/iter; left time: 9.7970s
	iters: 200, epoch: 8 | loss: 0.5516803
	speed: 0.0100s/iter; left time: 3.2301s
	iters: 300, epoch: 8 | loss: 0.3969664
	speed: 0.0110s/iter; left time: 2.4694s
	iters: 400, epoch: 8 | loss: 0.4255372
	speed: 0.0106s/iter; left time: 1.3155s
	iters: 500, epoch: 8 | loss: 0.5513906
	speed: 0.0101s/iter; left time: 0.2432s
Updating learning rate to 2.15308952890625e-06
Epoch: 8 cost time: 5.659099340438843
Epoch: 8, Steps: 523 | Train Loss: 0.4389559 Vali Loss: 0.3004384 Best vali loss: 0.2859042

best validation loss 0.2859041679078383

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008566862845, 'e_layers': 1, 'learning_rate': 0.0039000076002, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5519059
	speed: 0.0167s/iter; left time: 33.3588s
	iters: 200, epoch: 1 | loss: 0.5940608
	speed: 0.0101s/iter; left time: 19.1895s
Updating learning rate to 0.0037515723993316206
Validation loss decreased (inf --> 0.3002).  Saving model state dict ...
Epoch: 1 cost time: 2.793527126312256
Epoch: 1, Steps: 262 | Train Loss: 0.5729834 Vali Loss: 0.3001949 Best vali loss: 0.3001949
	iters: 100, epoch: 2 | loss: 0.3083573
	speed: 0.0206s/iter; left time: 35.7548s
	iters: 200, epoch: 2 | loss: 0.4065383
	speed: 0.0073s/iter; left time: 12.0038s
Updating learning rate to 0.003328864710490247
Validation loss decreased (0.3002 --> 0.2999).  Saving model state dict ...
Epoch: 2 cost time: 1.9966633319854736
Epoch: 2, Steps: 262 | Train Loss: 0.3574478 Vali Loss: 0.2998616 Best vali loss: 0.2998616
	iters: 100, epoch: 3 | loss: 0.4345829
	speed: 0.0228s/iter; left time: 33.5470s
	iters: 200, epoch: 3 | loss: 0.3355208
	speed: 0.0053s/iter; left time: 7.2523s
Updating learning rate to 0.0026962379474472363
Epoch: 3 cost time: 1.4701259136199951
Epoch: 3, Steps: 262 | Train Loss: 0.3850519 Vali Loss: 0.3468161 Best vali loss: 0.2998616
	iters: 100, epoch: 4 | loss: 0.5465696
	speed: 0.0142s/iter; left time: 17.1755s
	iters: 200, epoch: 4 | loss: 0.3329396
	speed: 0.0057s/iter; left time: 6.3766s
Updating learning rate to 0.0019500038001
Epoch: 4 cost time: 1.6174626350402832
Epoch: 4, Steps: 262 | Train Loss: 0.4397546 Vali Loss: 0.3264384 Best vali loss: 0.2998616
	iters: 100, epoch: 5 | loss: 0.3510737
	speed: 0.0149s/iter; left time: 14.1687s
	iters: 200, epoch: 5 | loss: 0.3723513
	speed: 0.0063s/iter; left time: 5.3438s
Updating learning rate to 0.0012037696527527637
Epoch: 5 cost time: 1.5882091522216797
Epoch: 5, Steps: 262 | Train Loss: 0.3617125 Vali Loss: 0.3483519 Best vali loss: 0.2998616
	iters: 100, epoch: 6 | loss: 0.2518065
	speed: 0.0096s/iter; left time: 6.5789s
	iters: 200, epoch: 6 | loss: 0.3892342
	speed: 0.0049s/iter; left time: 2.9020s
Updating learning rate to 0.0005711428897097533
Epoch: 6 cost time: 1.3073804378509521
Epoch: 6, Steps: 262 | Train Loss: 0.3205203 Vali Loss: 0.3672088 Best vali loss: 0.2998616
	iters: 100, epoch: 7 | loss: 0.2698334
	speed: 0.0160s/iter; left time: 6.8090s
	iters: 200, epoch: 7 | loss: 0.2968793
	speed: 0.0055s/iter; left time: 1.7771s
Updating learning rate to 0.00014843520086837937
Epoch: 7 cost time: 1.7472386360168457
Epoch: 7, Steps: 262 | Train Loss: 0.2833564 Vali Loss: 0.3962988 Best vali loss: 0.2998616
	iters: 100, epoch: 8 | loss: 0.2315645
	speed: 0.0166s/iter; left time: 2.7085s
	iters: 200, epoch: 8 | loss: 0.2645498
	speed: 0.0056s/iter; left time: 0.3513s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.717430591583252
Epoch: 8, Steps: 262 | Train Loss: 0.2480571 Vali Loss: 0.3848476 Best vali loss: 0.2998616

best validation loss 0.2998616187855762

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010739606287, 'e_layers': 3, 'learning_rate': 0.0028144606202, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0028144606202
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 1.0961298942565918
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2862061 Best vali loss: 0.2862061
Updating learning rate to 0.0014072303101
Epoch: 2 cost time: 0.7434718608856201
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2934631 Best vali loss: 0.2862061
Updating learning rate to 0.00070361515505
Epoch: 3 cost time: 0.4905407428741455
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3029716 Best vali loss: 0.2862061

best validation loss 0.2862061146479107

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0069985648614, 'e_layers': 3, 'learning_rate': 0.0001867300681, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266978
	speed: 0.0125s/iter; left time: 103.5893s
	iters: 200, epoch: 1 | loss: 0.6860912
	speed: 0.0086s/iter; left time: 70.1501s
	iters: 300, epoch: 1 | loss: 0.3525963
	speed: 0.0102s/iter; left time: 81.8990s
	iters: 400, epoch: 1 | loss: 1.0103126
	speed: 0.0087s/iter; left time: 69.4163s
	iters: 500, epoch: 1 | loss: 0.5177860
	speed: 0.0095s/iter; left time: 74.9684s
	iters: 600, epoch: 1 | loss: 0.6123996
	speed: 0.0097s/iter; left time: 75.2977s
	iters: 700, epoch: 1 | loss: 0.3459614
	speed: 0.0087s/iter; left time: 66.7567s
	iters: 800, epoch: 1 | loss: 0.6964756
	speed: 0.0080s/iter; left time: 60.2237s
	iters: 900, epoch: 1 | loss: 0.4384775
	speed: 0.0090s/iter; left time: 67.2982s
	iters: 1000, epoch: 1 | loss: 0.2837508
	speed: 0.0069s/iter; left time: 50.7333s
Updating learning rate to 0.0001867300681
Validation loss decreased (inf --> 0.2755).  Saving model state dict ...
Epoch: 1 cost time: 9.208901643753052
Epoch: 1, Steps: 1045 | Train Loss: 0.5370549 Vali Loss: 0.2754538 Best vali loss: 0.2754538
	iters: 100, epoch: 2 | loss: 0.6264877
	speed: 0.0233s/iter; left time: 168.1074s
	iters: 200, epoch: 2 | loss: 0.4680583
	speed: 0.0071s/iter; left time: 50.5293s
	iters: 300, epoch: 2 | loss: 0.4924152
	speed: 0.0079s/iter; left time: 55.6518s
	iters: 400, epoch: 2 | loss: 0.5925376
	speed: 0.0083s/iter; left time: 57.6641s
	iters: 500, epoch: 2 | loss: 0.2056223
	speed: 0.0084s/iter; left time: 57.0495s
	iters: 600, epoch: 2 | loss: 0.3081243
	speed: 0.0071s/iter; left time: 48.0045s
	iters: 700, epoch: 2 | loss: 0.3698461
	speed: 0.0079s/iter; left time: 52.1959s
	iters: 800, epoch: 2 | loss: 1.4302454
	speed: 0.0080s/iter; left time: 52.1389s
	iters: 900, epoch: 2 | loss: 0.8191465
	speed: 0.0079s/iter; left time: 50.7990s
	iters: 1000, epoch: 2 | loss: 1.1016433
	speed: 0.0084s/iter; left time: 53.3157s
Updating learning rate to 9.336503405e-05
Validation loss decreased (0.2755 --> 0.2712).  Saving model state dict ...
Epoch: 2 cost time: 8.174124956130981
Epoch: 2, Steps: 1045 | Train Loss: 0.6414127 Vali Loss: 0.2712197 Best vali loss: 0.2712197
	iters: 100, epoch: 3 | loss: 1.0070752
	speed: 0.0270s/iter; left time: 166.4456s
	iters: 200, epoch: 3 | loss: 0.3316535
	speed: 0.0091s/iter; left time: 55.1747s
	iters: 300, epoch: 3 | loss: 0.3816976
	speed: 0.0087s/iter; left time: 52.0392s
	iters: 400, epoch: 3 | loss: 1.4950874
	speed: 0.0091s/iter; left time: 53.2376s
	iters: 500, epoch: 3 | loss: 0.5577295
	speed: 0.0096s/iter; left time: 55.2951s
	iters: 600, epoch: 3 | loss: 0.4046474
	speed: 0.0092s/iter; left time: 52.3797s
	iters: 700, epoch: 3 | loss: 0.1787820
	speed: 0.0090s/iter; left time: 50.2582s
	iters: 800, epoch: 3 | loss: 0.2930872
	speed: 0.0093s/iter; left time: 50.8865s
	iters: 900, epoch: 3 | loss: 0.2510266
	speed: 0.0088s/iter; left time: 47.1816s
	iters: 1000, epoch: 3 | loss: 0.1957499
	speed: 0.0088s/iter; left time: 46.2987s
Updating learning rate to 4.6682517025e-05
Epoch: 3 cost time: 9.481237173080444
Epoch: 3, Steps: 1045 | Train Loss: 0.5096536 Vali Loss: 0.3032282 Best vali loss: 0.2712197

best validation loss 0.27121974221943657

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022002628646, 'e_layers': 2, 'learning_rate': 5.31978674e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8417019
	speed: 0.0148s/iter; left time: 14.0256s
Updating learning rate to 5.31978674e-05
Validation loss decreased (inf --> 0.2924).  Saving model state dict ...
Epoch: 1 cost time: 1.4505767822265625
Epoch: 1, Steps: 131 | Train Loss: 0.8417019 Vali Loss: 0.2923999 Best vali loss: 0.2923999
	iters: 100, epoch: 2 | loss: 0.5609548
	speed: 0.0157s/iter; left time: 12.8550s
Updating learning rate to 2.65989337e-05
Validation loss decreased (0.2924 --> 0.2813).  Saving model state dict ...
Epoch: 2 cost time: 1.3202719688415527
Epoch: 2, Steps: 131 | Train Loss: 0.5609548 Vali Loss: 0.2813137 Best vali loss: 0.2813137
	iters: 100, epoch: 3 | loss: 0.6659269
	speed: 0.0141s/iter; left time: 9.6991s
Updating learning rate to 1.329946685e-05
Validation loss decreased (0.2813 --> 0.2803).  Saving model state dict ...
Epoch: 3 cost time: 1.1351540088653564
Epoch: 3, Steps: 131 | Train Loss: 0.6659269 Vali Loss: 0.2802638 Best vali loss: 0.2802638

best validation loss 0.2802638059718186

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0069985648614, 'e_layers': 3, 'learning_rate': 0.0001867300681, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3605824
	speed: 0.0168s/iter; left time: 85.9682s
	iters: 200, epoch: 4 | loss: 0.6640000
	speed: 0.0093s/iter; left time: 46.8465s
	iters: 300, epoch: 4 | loss: 0.2985092
	speed: 0.0093s/iter; left time: 45.7089s
	iters: 400, epoch: 4 | loss: 0.6805120
	speed: 0.0094s/iter; left time: 45.2296s
	iters: 500, epoch: 4 | loss: 0.4251624
	speed: 0.0089s/iter; left time: 42.0561s
	iters: 600, epoch: 4 | loss: 0.5623109
	speed: 0.0078s/iter; left time: 36.2684s
	iters: 700, epoch: 4 | loss: 0.2416485
	speed: 0.0079s/iter; left time: 35.9353s
	iters: 800, epoch: 4 | loss: 0.4167967
	speed: 0.0076s/iter; left time: 33.7688s
	iters: 900, epoch: 4 | loss: 0.3193055
	speed: 0.0064s/iter; left time: 27.8914s
	iters: 1000, epoch: 4 | loss: 0.2895367
	speed: 0.0138s/iter; left time: 58.1083s
Updating learning rate to 2.33412585125e-05
Epoch: 4 cost time: 9.870563507080078
Epoch: 4, Steps: 1045 | Train Loss: 0.4258364 Vali Loss: 0.2868727 Best vali loss: 0.2712197
	iters: 100, epoch: 5 | loss: 0.5706456
	speed: 0.0354s/iter; left time: 144.5929s
	iters: 200, epoch: 5 | loss: 0.2915880
	speed: 0.0063s/iter; left time: 25.0906s
	iters: 300, epoch: 5 | loss: 0.4047787
	speed: 0.0073s/iter; left time: 28.4642s
	iters: 400, epoch: 5 | loss: 0.4742157
	speed: 0.0068s/iter; left time: 25.5275s
	iters: 500, epoch: 5 | loss: 0.1929863
	speed: 0.0067s/iter; left time: 24.6965s
	iters: 600, epoch: 5 | loss: 0.2756858
	speed: 0.0084s/iter; left time: 30.2123s
	iters: 700, epoch: 5 | loss: 0.2880926
	speed: 0.0086s/iter; left time: 30.0452s
	iters: 800, epoch: 5 | loss: 1.1974331
	speed: 0.0109s/iter; left time: 36.9385s
	iters: 900, epoch: 5 | loss: 0.6024999
	speed: 0.0109s/iter; left time: 35.7523s
	iters: 1000, epoch: 5 | loss: 0.8043799
	speed: 0.0082s/iter; left time: 26.2268s
Updating learning rate to 1.167062925625e-05
Epoch: 5 cost time: 8.568995714187622
Epoch: 5, Steps: 1045 | Train Loss: 0.5102306 Vali Loss: 0.2900362 Best vali loss: 0.2712197
	iters: 100, epoch: 6 | loss: 0.8661380
	speed: 0.0337s/iter; left time: 102.3076s
	iters: 200, epoch: 6 | loss: 0.3161562
	speed: 0.0078s/iter; left time: 22.8105s
	iters: 300, epoch: 6 | loss: 0.3889564
	speed: 0.0061s/iter; left time: 17.3449s
	iters: 400, epoch: 6 | loss: 1.2784783
	speed: 0.0077s/iter; left time: 20.9685s
	iters: 500, epoch: 6 | loss: 0.4130984
	speed: 0.0071s/iter; left time: 18.7893s
	iters: 600, epoch: 6 | loss: 0.2832727
	speed: 0.0071s/iter; left time: 17.9750s
	iters: 700, epoch: 6 | loss: 0.1733159
	speed: 0.0075s/iter; left time: 18.2037s
	iters: 800, epoch: 6 | loss: 0.2560427
	speed: 0.0090s/iter; left time: 20.9276s
	iters: 900, epoch: 6 | loss: 0.2278537
	speed: 0.0082s/iter; left time: 18.4295s
	iters: 1000, epoch: 6 | loss: 0.1943234
	speed: 0.0087s/iter; left time: 18.5245s
Updating learning rate to 5.835314628125e-06
Epoch: 6 cost time: 8.445869445800781
Epoch: 6, Steps: 1045 | Train Loss: 0.4397636 Vali Loss: 0.2988665 Best vali loss: 0.2712197
	iters: 100, epoch: 7 | loss: 0.3016377
	speed: 0.0253s/iter; left time: 50.4318s
	iters: 200, epoch: 7 | loss: 1.0700904
	speed: 0.0071s/iter; left time: 13.4255s
	iters: 300, epoch: 7 | loss: 0.6782635
	speed: 0.0101s/iter; left time: 18.1684s
	iters: 400, epoch: 7 | loss: 0.3621902
	speed: 0.0083s/iter; left time: 13.9518s
	iters: 500, epoch: 7 | loss: 0.3137544
	speed: 0.0105s/iter; left time: 16.7153s
	iters: 600, epoch: 7 | loss: 0.2910301
	speed: 0.0125s/iter; left time: 18.6216s
	iters: 700, epoch: 7 | loss: 0.2286309
	speed: 0.0113s/iter; left time: 15.6910s
	iters: 800, epoch: 7 | loss: 0.3711931
	speed: 0.0108s/iter; left time: 13.9953s
	iters: 900, epoch: 7 | loss: 0.3549946
	speed: 0.0110s/iter; left time: 13.1537s
	iters: 1000, epoch: 7 | loss: 0.2433655
	speed: 0.0100s/iter; left time: 10.9073s
Updating learning rate to 2.9176573140625e-06
Epoch: 7 cost time: 10.396413564682007
Epoch: 7, Steps: 1045 | Train Loss: 0.4215150 Vali Loss: 0.3026877 Best vali loss: 0.2712197
	iters: 100, epoch: 8 | loss: 0.1337345
	speed: 0.0240s/iter; left time: 22.7500s
	iters: 200, epoch: 8 | loss: 0.2472853
	speed: 0.0067s/iter; left time: 5.6412s
	iters: 300, epoch: 8 | loss: 0.2117770
	speed: 0.0073s/iter; left time: 5.4706s
	iters: 400, epoch: 8 | loss: 0.4691737
	speed: 0.0092s/iter; left time: 5.9593s
	iters: 500, epoch: 8 | loss: 0.3093068
	speed: 0.0092s/iter; left time: 5.0003s
	iters: 600, epoch: 8 | loss: 0.5895265
	speed: 0.0091s/iter; left time: 4.0786s
	iters: 700, epoch: 8 | loss: 0.6321701
	speed: 0.0092s/iter; left time: 3.1857s
	iters: 800, epoch: 8 | loss: 0.4632877
	speed: 0.0090s/iter; left time: 2.2193s
	iters: 900, epoch: 8 | loss: 0.2885044
	speed: 0.0084s/iter; left time: 1.2268s
	iters: 1000, epoch: 8 | loss: 0.4519154
	speed: 0.0088s/iter; left time: 0.4035s
Updating learning rate to 1.45882865703125e-06
Epoch: 8 cost time: 8.82426118850708
Epoch: 8, Steps: 1045 | Train Loss: 0.3796682 Vali Loss: 0.3022335 Best vali loss: 0.2712197

best validation loss 0.27121974221943657

[INFO][abstract_intensifier.py:595] Added config e80702 and rejected config 1d643a as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0010210561178, 'e_layers': 4, 'learning_rate': 0.0001351636732, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8908041
	speed: 0.0210s/iter; left time: 41.8642s
	iters: 200, epoch: 1 | loss: 0.6138957
	speed: 0.0144s/iter; left time: 27.2916s
Updating learning rate to 0.0001351636732
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 4.118715047836304
Epoch: 1, Steps: 262 | Train Loss: 0.7523499 Vali Loss: 0.2821510 Best vali loss: 0.2821510
	iters: 100, epoch: 2 | loss: 0.4303134
	speed: 0.0223s/iter; left time: 38.7734s
	iters: 200, epoch: 2 | loss: 0.6649473
	speed: 0.0088s/iter; left time: 14.3133s
Updating learning rate to 6.75818366e-05
Epoch: 2 cost time: 2.3430356979370117
Epoch: 2, Steps: 262 | Train Loss: 0.5476304 Vali Loss: 0.2832925 Best vali loss: 0.2821510
	iters: 100, epoch: 3 | loss: 0.6543756
	speed: 0.0330s/iter; left time: 48.5393s
	iters: 200, epoch: 3 | loss: 0.5220708
	speed: 0.0116s/iter; left time: 15.9003s
Updating learning rate to 3.37909183e-05
Epoch: 3 cost time: 3.210315465927124
Epoch: 3, Steps: 262 | Train Loss: 0.5882232 Vali Loss: 0.2826063 Best vali loss: 0.2821510
	iters: 100, epoch: 4 | loss: 0.2067872
	speed: 0.0282s/iter; left time: 34.1993s
	iters: 200, epoch: 4 | loss: 0.3013671
	speed: 0.0119s/iter; left time: 13.2576s
Updating learning rate to 1.689545915e-05
Epoch: 4 cost time: 3.174225091934204
Epoch: 4, Steps: 262 | Train Loss: 0.2540771 Vali Loss: 0.2835418 Best vali loss: 0.2821510
	iters: 100, epoch: 5 | loss: 0.4149397
	speed: 0.0327s/iter; left time: 30.9895s
	iters: 200, epoch: 5 | loss: 0.2954761
	speed: 0.0133s/iter; left time: 11.3288s
Updating learning rate to 8.447729575e-06
Epoch: 5 cost time: 3.470515727996826
Epoch: 5, Steps: 262 | Train Loss: 0.3552079 Vali Loss: 0.2852276 Best vali loss: 0.2821510
	iters: 100, epoch: 6 | loss: 0.5591688
	speed: 0.0292s/iter; left time: 20.0787s
	iters: 200, epoch: 6 | loss: 0.3814264
	speed: 0.0117s/iter; left time: 6.8552s
Updating learning rate to 4.2238647875e-06
Epoch: 6 cost time: 3.166508197784424
Epoch: 6, Steps: 262 | Train Loss: 0.4702976 Vali Loss: 0.2849849 Best vali loss: 0.2821510
	iters: 100, epoch: 7 | loss: 0.7555344
	speed: 0.0316s/iter; left time: 13.4269s
	iters: 200, epoch: 7 | loss: 0.6369663
	speed: 0.0117s/iter; left time: 3.8033s
Updating learning rate to 2.11193239375e-06
Epoch: 7 cost time: 3.1549742221832275
Epoch: 7, Steps: 262 | Train Loss: 0.6962504 Vali Loss: 0.2851013 Best vali loss: 0.2821510
	iters: 100, epoch: 8 | loss: 0.4487919
	speed: 0.0273s/iter; left time: 4.4494s
	iters: 200, epoch: 8 | loss: 0.3718601
	speed: 0.0124s/iter; left time: 0.7796s
Updating learning rate to 1.055966196875e-06
Epoch: 8 cost time: 3.426082134246826
Epoch: 8, Steps: 262 | Train Loss: 0.4103260 Vali Loss: 0.2853497 Best vali loss: 0.2821510

best validation loss 0.28215098159381474

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0009447196394, 'e_layers': 2, 'learning_rate': 0.0016386381017, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4964798
	speed: 0.0161s/iter; left time: 132.8373s
	iters: 200, epoch: 1 | loss: 0.3392358
	speed: 0.0098s/iter; left time: 80.2667s
	iters: 300, epoch: 1 | loss: 0.2696885
	speed: 0.0089s/iter; left time: 71.6116s
	iters: 400, epoch: 1 | loss: 0.2498221
	speed: 0.0070s/iter; left time: 55.6783s
	iters: 500, epoch: 1 | loss: 0.9655699
	speed: 0.0090s/iter; left time: 70.9240s
	iters: 600, epoch: 1 | loss: 0.1906355
	speed: 0.0092s/iter; left time: 71.7285s
	iters: 700, epoch: 1 | loss: 0.8219407
	speed: 0.0094s/iter; left time: 71.7175s
	iters: 800, epoch: 1 | loss: 0.2436580
	speed: 0.0089s/iter; left time: 67.3492s
	iters: 900, epoch: 1 | loss: 0.4234023
	speed: 0.0089s/iter; left time: 66.2659s
	iters: 1000, epoch: 1 | loss: 0.2181977
	speed: 0.0065s/iter; left time: 47.7359s
Updating learning rate to 0.001576271152526889
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 9.361207962036133
Epoch: 1, Steps: 1045 | Train Loss: 0.4218630 Vali Loss: 0.2869093 Best vali loss: 0.2869093
	iters: 100, epoch: 2 | loss: 0.4039810
	speed: 0.0305s/iter; left time: 220.3578s
	iters: 200, epoch: 2 | loss: 1.2271149
	speed: 0.0084s/iter; left time: 59.8175s
	iters: 300, epoch: 2 | loss: 0.8476188
	speed: 0.0054s/iter; left time: 37.7583s
	iters: 400, epoch: 2 | loss: 0.1777514
	speed: 0.0080s/iter; left time: 55.5535s
	iters: 500, epoch: 2 | loss: 0.6165863
	speed: 0.0118s/iter; left time: 80.1448s
	iters: 600, epoch: 2 | loss: 0.2803015
	speed: 0.0128s/iter; left time: 85.9026s
	iters: 700, epoch: 2 | loss: 0.4311913
	speed: 0.0129s/iter; left time: 85.4953s
	iters: 800, epoch: 2 | loss: 0.7438473
	speed: 0.0074s/iter; left time: 48.4459s
	iters: 900, epoch: 2 | loss: 0.3704163
	speed: 0.0067s/iter; left time: 42.9325s
	iters: 1000, epoch: 2 | loss: 0.4081763
	speed: 0.0058s/iter; left time: 36.8599s
Updating learning rate to 0.0013986651076613606
Epoch: 2 cost time: 9.26026725769043
Epoch: 2, Steps: 1045 | Train Loss: 0.5506985 Vali Loss: 0.2905729 Best vali loss: 0.2869093
	iters: 100, epoch: 3 | loss: 0.1773312
	speed: 0.0323s/iter; left time: 199.5512s
	iters: 200, epoch: 3 | loss: 0.5242126
	speed: 0.0089s/iter; left time: 53.8830s
	iters: 300, epoch: 3 | loss: 0.2762989
	speed: 0.0084s/iter; left time: 50.0991s
	iters: 400, epoch: 3 | loss: 1.2978617
	speed: 0.0079s/iter; left time: 46.6293s
	iters: 500, epoch: 3 | loss: 0.3818150
	speed: 0.0089s/iter; left time: 51.6444s
	iters: 600, epoch: 3 | loss: 0.3026498
	speed: 0.0092s/iter; left time: 52.1389s
	iters: 700, epoch: 3 | loss: 0.2508890
	speed: 0.0080s/iter; left time: 44.6365s
	iters: 800, epoch: 3 | loss: 0.1564048
	speed: 0.0070s/iter; left time: 38.1804s
	iters: 900, epoch: 3 | loss: 0.2432946
	speed: 0.0101s/iter; left time: 54.0016s
	iters: 1000, epoch: 3 | loss: 0.9733980
	speed: 0.0071s/iter; left time: 37.4138s
Updating learning rate to 0.0011328588774313856
Epoch: 3 cost time: 9.023070812225342
Epoch: 3, Steps: 1045 | Train Loss: 0.4584156 Vali Loss: 0.3024420 Best vali loss: 0.2869093
	iters: 100, epoch: 4 | loss: 1.4131727
	speed: 0.0365s/iter; left time: 186.9211s
	iters: 200, epoch: 4 | loss: 0.2629300
	speed: 0.0123s/iter; left time: 61.6052s
	iters: 300, epoch: 4 | loss: 0.3158543
	speed: 0.0071s/iter; left time: 35.0706s
	iters: 400, epoch: 4 | loss: 0.4294601
	speed: 0.0064s/iter; left time: 30.8532s
	iters: 500, epoch: 4 | loss: 0.5174958
	speed: 0.0072s/iter; left time: 33.9390s
	iters: 600, epoch: 4 | loss: 0.6174098
	speed: 0.0072s/iter; left time: 33.3866s
	iters: 700, epoch: 4 | loss: 0.2407405
	speed: 0.0076s/iter; left time: 34.2192s
	iters: 800, epoch: 4 | loss: 0.6009007
	speed: 0.0081s/iter; left time: 35.9617s
	iters: 900, epoch: 4 | loss: 0.7373598
	speed: 0.0079s/iter; left time: 34.2724s
	iters: 1000, epoch: 4 | loss: 0.3940503
	speed: 0.0081s/iter; left time: 34.1833s
Updating learning rate to 0.00081931905085
Epoch: 4 cost time: 8.763950824737549
Epoch: 4, Steps: 1045 | Train Loss: 0.5529374 Vali Loss: 0.3208680 Best vali loss: 0.2869093
	iters: 100, epoch: 5 | loss: 0.2665600
	speed: 0.0268s/iter; left time: 109.3441s
	iters: 200, epoch: 5 | loss: 0.3497082
	speed: 0.0082s/iter; left time: 32.5944s
	iters: 300, epoch: 5 | loss: 0.1733658
	speed: 0.0082s/iter; left time: 31.7840s
	iters: 400, epoch: 5 | loss: 0.4159476
	speed: 0.0084s/iter; left time: 31.6626s
	iters: 500, epoch: 5 | loss: 0.8813090
	speed: 0.0076s/iter; left time: 28.1039s
	iters: 600, epoch: 5 | loss: 0.3376666
	speed: 0.0078s/iter; left time: 27.8405s
	iters: 700, epoch: 5 | loss: 0.3982354
	speed: 0.0090s/iter; left time: 31.1695s
	iters: 800, epoch: 5 | loss: 0.2522491
	speed: 0.0103s/iter; left time: 34.8133s
	iters: 900, epoch: 5 | loss: 0.4805434
	speed: 0.0100s/iter; left time: 32.8362s
	iters: 1000, epoch: 5 | loss: 0.1362117
	speed: 0.0121s/iter; left time: 38.5389s
Updating learning rate to 0.0005057792242686145
Epoch: 5 cost time: 9.358000993728638
Epoch: 5, Steps: 1045 | Train Loss: 0.3691797 Vali Loss: 0.3221916 Best vali loss: 0.2869093
	iters: 100, epoch: 6 | loss: 0.3149045
	speed: 0.0267s/iter; left time: 80.9453s
	iters: 200, epoch: 6 | loss: 0.2514991
	speed: 0.0054s/iter; left time: 15.7679s
	iters: 300, epoch: 6 | loss: 0.1964579
	speed: 0.0069s/iter; left time: 19.4734s
	iters: 400, epoch: 6 | loss: 0.1782464
	speed: 0.0064s/iter; left time: 17.4621s
	iters: 500, epoch: 6 | loss: 0.4475753
	speed: 0.0058s/iter; left time: 15.1974s
	iters: 600, epoch: 6 | loss: 0.4304443
	speed: 0.0066s/iter; left time: 16.8439s
	iters: 700, epoch: 6 | loss: 0.4024813
	speed: 0.0065s/iter; left time: 15.9238s
	iters: 800, epoch: 6 | loss: 0.5676793
	speed: 0.0058s/iter; left time: 13.6318s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0114431552414, 'e_layers': 3, 'learning_rate': 0.0007208837323, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9794181
	speed: 0.0131s/iter; left time: 26.2016s
	iters: 200, epoch: 1 | loss: 0.5465061
	speed: 0.0080s/iter; left time: 15.2302s
Updating learning rate to 0.0006934467289461578
Validation loss decreased (inf --> 0.2898).  Saving model state dict ...
Epoch: 1 cost time: 2.3487637042999268
Epoch: 1, Steps: 262 | Train Loss: 0.7629621 Vali Loss: 0.2898483 Best vali loss: 0.2898483
	iters: 100, epoch: 2 | loss: 0.4152164
	speed: 0.0192s/iter; left time: 33.3979s
	iters: 200, epoch: 2 | loss: 0.5077075
	speed: 0.0080s/iter; left time: 13.0986s
Updating learning rate to 0.0006153127539281989
Validation loss decreased (0.2898 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 2.188559055328369
Epoch: 2, Steps: 262 | Train Loss: 0.4614619 Vali Loss: 0.2832645 Best vali loss: 0.2832645
	iters: 100, epoch: 3 | loss: 0.5332047
	speed: 0.0193s/iter; left time: 28.4796s
	iters: 200, epoch: 3 | loss: 0.3688964
	speed: 0.0083s/iter; left time: 11.3379s
Updating learning rate to 0.0004983769966563603
Validation loss decreased (0.2833 --> 0.2779).  Saving model state dict ...
Epoch: 3 cost time: 2.0849077701568604
Epoch: 3, Steps: 262 | Train Loss: 0.4510505 Vali Loss: 0.2779072 Best vali loss: 0.2779072

best validation loss 0.2779072478507788

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008725762932, 'e_layers': 3, 'learning_rate': 0.0004627482233, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5348603
	speed: 0.0190s/iter; left time: 18.0176s
Updating learning rate to 0.0004627482233
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 2.0214173793792725
Epoch: 1, Steps: 131 | Train Loss: 0.5348603 Vali Loss: 0.2852086 Best vali loss: 0.2852086
	iters: 100, epoch: 2 | loss: 0.2864627
	speed: 0.0190s/iter; left time: 15.5293s
Updating learning rate to 0.00023137411165
Epoch: 2 cost time: 1.5556142330169678
Epoch: 2, Steps: 131 | Train Loss: 0.2864627 Vali Loss: 0.2917132 Best vali loss: 0.2852086
	iters: 100, epoch: 3 | loss: 0.4986474
	speed: 0.0184s/iter; left time: 12.6452s
Updating learning rate to 0.000115687055825
Validation loss decreased (0.2852 --> 0.2806).  Saving model state dict ...
Epoch: 3 cost time: 1.5265510082244873
Epoch: 3, Steps: 131 | Train Loss: 0.4986474 Vali Loss: 0.2805856 Best vali loss: 0.2805856

best validation loss 0.2805855886123357

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0068749820528, 'e_layers': 2, 'learning_rate': 5.78505997e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8012940
	speed: 0.0158s/iter; left time: 64.4197s
	iters: 200, epoch: 1 | loss: 0.3466898
	speed: 0.0089s/iter; left time: 35.3374s
	iters: 300, epoch: 1 | loss: 0.3560303
	speed: 0.0090s/iter; left time: 35.0960s
	iters: 400, epoch: 1 | loss: 0.4717826
	speed: 0.0077s/iter; left time: 29.1628s
	iters: 500, epoch: 1 | loss: 1.1029563
	speed: 0.0078s/iter; left time: 28.5993s
Updating learning rate to 5.78505997e-05
Validation loss decreased (inf --> 0.3208).  Saving model state dict ...
Epoch: 1 cost time: 4.757914781570435
Epoch: 1, Steps: 523 | Train Loss: 0.6157506 Vali Loss: 0.3208012 Best vali loss: 0.3208012
	iters: 100, epoch: 2 | loss: 1.2905273
	speed: 0.0098s/iter; left time: 34.8309s
	iters: 200, epoch: 2 | loss: 0.3499354
	speed: 0.0064s/iter; left time: 22.0590s
	iters: 300, epoch: 2 | loss: 0.4158061
	speed: 0.0068s/iter; left time: 22.8730s
	iters: 400, epoch: 2 | loss: 0.4896962
	speed: 0.0071s/iter; left time: 23.0222s
	iters: 500, epoch: 2 | loss: 0.6505312
	speed: 0.0068s/iter; left time: 21.5067s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.3208 --> 0.3055).  Saving model state dict ...
Epoch: 2 cost time: 3.3316097259521484
Epoch: 2, Steps: 523 | Train Loss: 0.6392993 Vali Loss: 0.3055411 Best vali loss: 0.3055411
	iters: 100, epoch: 3 | loss: 0.4129706
	speed: 0.0165s/iter; left time: 50.2828s
	iters: 200, epoch: 3 | loss: 0.5946203
	speed: 0.0067s/iter; left time: 19.6155s
	iters: 300, epoch: 3 | loss: 0.3723161
	speed: 0.0073s/iter; left time: 20.6903s
	iters: 400, epoch: 3 | loss: 1.0660185
	speed: 0.0068s/iter; left time: 18.5620s
	iters: 500, epoch: 3 | loss: 0.7498390
	speed: 0.0060s/iter; left time: 15.7430s
Updating learning rate to 1.4462649925e-05
Validation loss decreased (0.3055 --> 0.3009).  Saving model state dict ...
Epoch: 3 cost time: 3.559701681137085
Epoch: 3, Steps: 523 | Train Loss: 0.6391529 Vali Loss: 0.3008889 Best vali loss: 0.3008889

best validation loss 0.30088892132431744

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0114431552414, 'e_layers': 3, 'learning_rate': 0.0007208837323, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7943162
	speed: 0.0155s/iter; left time: 18.7345s
	iters: 200, epoch: 4 | loss: 0.4876976
	speed: 0.0081s/iter; left time: 8.9911s
Updating learning rate to 0.00036044186615
Epoch: 4 cost time: 2.4817628860473633
Epoch: 4, Steps: 262 | Train Loss: 0.6410069 Vali Loss: 0.3132779 Best vali loss: 0.2779072
	iters: 100, epoch: 5 | loss: 0.3229603
	speed: 0.0180s/iter; left time: 17.1092s
	iters: 200, epoch: 5 | loss: 0.4228705
	speed: 0.0082s/iter; left time: 6.9928s
Updating learning rate to 0.00022250673564363975
Epoch: 5 cost time: 2.1747872829437256
Epoch: 5, Steps: 262 | Train Loss: 0.3729154 Vali Loss: 0.3014242 Best vali loss: 0.2779072
	iters: 100, epoch: 6 | loss: 0.3591126
	speed: 0.0204s/iter; left time: 14.0060s
	iters: 200, epoch: 6 | loss: 0.3144935
	speed: 0.0077s/iter; left time: 4.5459s
Updating learning rate to 0.00010557097837180112
Epoch: 6 cost time: 2.3735198974609375
Epoch: 6, Steps: 262 | Train Loss: 0.3368031 Vali Loss: 0.2993936 Best vali loss: 0.2779072
	iters: 100, epoch: 7 | loss: 0.3317381
	speed: 0.0300s/iter; left time: 12.7482s
	iters: 200, epoch: 7 | loss: 0.1978283
	speed: 0.0104s/iter; left time: 3.3737s
Updating learning rate to 2.7437003353842213e-05
Epoch: 7 cost time: 2.8236656188964844
Epoch: 7, Steps: 262 | Train Loss: 0.2647832 Vali Loss: 0.3048514 Best vali loss: 0.2779072
	iters: 100, epoch: 8 | loss: 0.4915836
	speed: 0.0256s/iter; left time: 4.1654s
	iters: 200, epoch: 8 | loss: 0.3597764
	speed: 0.0110s/iter; left time: 0.6952s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.890472650527954
Epoch: 8, Steps: 262 | Train Loss: 0.4256800 Vali Loss: 0.3048203 Best vali loss: 0.2779072

best validation loss 0.2779072478507788

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0025789008972, 'e_layers': 2, 'learning_rate': 0.0001118721335, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6611168
	speed: 0.0141s/iter; left time: 57.5958s
	iters: 200, epoch: 1 | loss: 0.9686540
	speed: 0.0068s/iter; left time: 27.0923s
	iters: 300, epoch: 1 | loss: 0.9304251
	speed: 0.0055s/iter; left time: 21.5425s
	iters: 400, epoch: 1 | loss: 0.5049367
	speed: 0.0052s/iter; left time: 19.5753s
	iters: 500, epoch: 1 | loss: 0.5616390
	speed: 0.0053s/iter; left time: 19.5792s
Updating learning rate to 0.00010761425394951013
Validation loss decreased (inf --> 0.2796).  Saving model state dict ...
Epoch: 1 cost time: 3.5060112476348877
Epoch: 1, Steps: 523 | Train Loss: 0.7253543 Vali Loss: 0.2795845 Best vali loss: 0.2795845
	iters: 100, epoch: 2 | loss: 0.3234466
	speed: 0.0148s/iter; left time: 52.5793s
	iters: 200, epoch: 2 | loss: 0.2153248
	speed: 0.0079s/iter; left time: 27.4956s
	iters: 300, epoch: 2 | loss: 0.6699642
	speed: 0.0083s/iter; left time: 27.9810s
	iters: 400, epoch: 2 | loss: 0.3476665
	speed: 0.0061s/iter; left time: 19.8114s
	iters: 500, epoch: 2 | loss: 1.1604537
	speed: 0.0059s/iter; left time: 18.5089s
Updating learning rate to 9.548883886182837e-05
Validation loss decreased (0.2796 --> 0.2786).  Saving model state dict ...
Epoch: 2 cost time: 3.7368106842041016
Epoch: 2, Steps: 523 | Train Loss: 0.5433712 Vali Loss: 0.2785751 Best vali loss: 0.2785751
	iters: 100, epoch: 3 | loss: 0.2359816
	speed: 0.0187s/iter; left time: 56.7039s
	iters: 200, epoch: 3 | loss: 0.4009456
	speed: 0.0065s/iter; left time: 19.0357s
	iters: 300, epoch: 3 | loss: 0.7705259
	speed: 0.0078s/iter; left time: 22.1626s
	iters: 400, epoch: 3 | loss: 0.3605711
	speed: 0.0082s/iter; left time: 22.4911s
	iters: 500, epoch: 3 | loss: 0.3546803
	speed: 0.0080s/iter; left time: 21.0505s
Updating learning rate to 7.734187276689278e-05
Epoch: 3 cost time: 4.079421758651733
Epoch: 3, Steps: 523 | Train Loss: 0.4245409 Vali Loss: 0.2898748 Best vali loss: 0.2785751
	iters: 100, epoch: 4 | loss: 0.2115328
	speed: 0.0115s/iter; left time: 28.8666s
	iters: 200, epoch: 4 | loss: 0.6062208
	speed: 0.0050s/iter; left time: 12.0077s
	iters: 300, epoch: 4 | loss: 1.0002856
	speed: 0.0052s/iter; left time: 12.0824s
	iters: 400, epoch: 4 | loss: 0.3996832
	speed: 0.0053s/iter; left time: 11.7500s
	iters: 500, epoch: 4 | loss: 0.4989148
	speed: 0.0054s/iter; left time: 11.3963s
Updating learning rate to 5.593606675e-05
Epoch: 4 cost time: 2.6841208934783936
Epoch: 4, Steps: 523 | Train Loss: 0.5433275 Vali Loss: 0.2801261 Best vali loss: 0.2785751
	iters: 100, epoch: 5 | loss: 0.5731508
	speed: 0.0128s/iter; left time: 25.4986s
	iters: 200, epoch: 5 | loss: 0.4038537
	speed: 0.0058s/iter; left time: 10.9801s
	iters: 300, epoch: 5 | loss: 0.6308517
	speed: 0.0061s/iter; left time: 10.9900s
	iters: 400, epoch: 5 | loss: 0.5361450
	speed: 0.0058s/iter; left time: 9.8787s
	iters: 500, epoch: 5 | loss: 0.3154644
	speed: 0.0060s/iter; left time: 9.6005s
Updating learning rate to 3.453026073310723e-05
Epoch: 5 cost time: 3.126415729522705
Epoch: 5, Steps: 523 | Train Loss: 0.4918931 Vali Loss: 0.2819122 Best vali loss: 0.2785751
	iters: 100, epoch: 6 | loss: 0.2964228
	speed: 0.0133s/iter; left time: 19.5509s
	iters: 200, epoch: 6 | loss: 0.7182268
	speed: 0.0054s/iter; left time: 7.4120s
	iters: 300, epoch: 6 | loss: 0.3579530
	speed: 0.0094s/iter; left time: 11.9786s
	iters: 400, epoch: 6 | loss: 0.2597207
	speed: 0.0077s/iter; left time: 9.0555s
	iters: 500, epoch: 6 | loss: 0.2472528
	speed: 0.0079s/iter; left time: 8.4852s
Updating learning rate to 1.6383294638171637e-05
Epoch: 6 cost time: 3.7726287841796875
Epoch: 6, Steps: 523 | Train Loss: 0.3759152 Vali Loss: 0.2955355 Best vali loss: 0.2785751
	iters: 100, epoch: 7 | loss: 0.3559088
	speed: 0.0171s/iter; left time: 16.2379s
	iters: 200, epoch: 7 | loss: 0.2564636
	speed: 0.0057s/iter; left time: 4.8442s
	iters: 300, epoch: 7 | loss: 0.2718497
	speed: 0.0048s/iter; left time: 3.6162s
	iters: 400, epoch: 7 | loss: 0.7383443
	speed: 0.0047s/iter; left time: 3.0187s
	iters: 500, epoch: 7 | loss: 0.3737395
	speed: 0.0052s/iter; left time: 2.8421s
Updating learning rate to 4.25787955048987e-06
Epoch: 7 cost time: 3.023285150527954
Epoch: 7, Steps: 523 | Train Loss: 0.3992612 Vali Loss: 0.2871054 Best vali loss: 0.2785751
	iters: 100, epoch: 8 | loss: 0.4885296
	speed: 0.0148s/iter; left time: 6.2604s
	iters: 200, epoch: 8 | loss: 0.3827606
	speed: 0.0059s/iter; left time: 1.8989s
	iters: 300, epoch: 8 | loss: 0.3554232
	speed: 0.0056s/iter; left time: 1.2465s
	iters: 400, epoch: 8 | loss: 0.6100792
	speed: 0.0060s/iter; left time: 0.7465s
	iters: 500, epoch: 8 | loss: 0.2237254
	speed: 0.0054s/iter; left time: 0.1304s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0572822093963623
Epoch: 8, Steps: 523 | Train Loss: 0.4121036 Vali Loss: 0.2881337 Best vali loss: 0.2785751

best validation loss 0.2785751352127532

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0035530689642, 'e_layers': 2, 'learning_rate': 5.36744121e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.163155142938308e-05
Validation loss decreased (inf --> 0.3299).  Saving model state dict ...
Epoch: 1 cost time: 0.904428243637085
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3298662 Best vali loss: 0.3298662
Updating learning rate to 4.581397643605564e-05
Validation loss decreased (0.3299 --> 0.3108).  Saving model state dict ...
Epoch: 2 cost time: 0.758103609085083
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3108275 Best vali loss: 0.3108275
Updating learning rate to 3.710736017630315e-05
Validation loss decreased (0.3108 --> 0.2998).  Saving model state dict ...
Epoch: 3 cost time: 0.6256439685821533
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2998221 Best vali loss: 0.2998221
Updating learning rate to 2.683720605e-05
Validation loss decreased (0.2998 --> 0.2938).  Saving model state dict ...
Epoch: 4 cost time: 1.2409532070159912
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2937990 Best vali loss: 0.2937990
Updating learning rate to 1.6567051923696848e-05
Validation loss decreased (0.2938 --> 0.2906).  Saving model state dict ...
Epoch: 5 cost time: 1.7858543395996094
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2905989 Best vali loss: 0.2905989
Updating learning rate to 7.860435663944363e-06
Validation loss decreased (0.2906 --> 0.2890).  Saving model state dict ...
Epoch: 6 cost time: 2.1463329792022705
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2890125 Best vali loss: 0.2890125
Updating learning rate to 2.042860670616924e-06
Validation loss decreased (0.2890 --> 0.2883).  Saving model state dict ...
Epoch: 7 cost time: 2.606440544128418
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2883442 Best vali loss: 0.2883442
Updating learning rate to 0.0
Validation loss decreased (0.2883 --> 0.2882).  Saving model state dict ...
Epoch: 8 cost time: 1.9317247867584229
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2881763 Best vali loss: 0.2881763

best validation loss 0.28817626304700056

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0091512583869, 'e_layers': 4, 'learning_rate': 0.0011123900893, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4156079
	speed: 0.0172s/iter; left time: 142.2605s
	iters: 200, epoch: 1 | loss: 0.4901704
	speed: 0.0088s/iter; left time: 71.9038s
	iters: 300, epoch: 1 | loss: 0.3058850
	speed: 0.0096s/iter; left time: 77.1823s
	iters: 400, epoch: 1 | loss: 0.3150660
	speed: 0.0096s/iter; left time: 76.7343s
	iters: 500, epoch: 1 | loss: 0.2948911
	speed: 0.0088s/iter; left time: 69.4661s
	iters: 600, epoch: 1 | loss: 0.6903535
	speed: 0.0113s/iter; left time: 87.4277s
	iters: 700, epoch: 1 | loss: 1.4028643
	speed: 0.0109s/iter; left time: 83.8465s
	iters: 800, epoch: 1 | loss: 0.2895262
	speed: 0.0100s/iter; left time: 75.2916s
	iters: 900, epoch: 1 | loss: 0.3497573
	speed: 0.0112s/iter; left time: 83.8371s
	iters: 1000, epoch: 1 | loss: 0.9096395
	speed: 0.0111s/iter; left time: 81.9749s
Updating learning rate to 0.0011123900893
Validation loss decreased (inf --> 0.3173).  Saving model state dict ...
Epoch: 1 cost time: 10.964536666870117
Epoch: 1, Steps: 1045 | Train Loss: 0.5463761 Vali Loss: 0.3172798 Best vali loss: 0.3172798
	iters: 100, epoch: 2 | loss: 0.2571473
	speed: 0.0330s/iter; left time: 238.4307s
	iters: 200, epoch: 2 | loss: 0.2895467
	speed: 0.0078s/iter; left time: 55.6679s
	iters: 300, epoch: 2 | loss: 0.3214183
	speed: 0.0072s/iter; left time: 50.4462s
	iters: 400, epoch: 2 | loss: 0.9644823
	speed: 0.0099s/iter; left time: 68.1426s
	iters: 500, epoch: 2 | loss: 0.3858478
	speed: 0.0110s/iter; left time: 75.0080s
	iters: 600, epoch: 2 | loss: 0.3417134
	speed: 0.0099s/iter; left time: 66.7477s
	iters: 700, epoch: 2 | loss: 1.2012314
	speed: 0.0095s/iter; left time: 62.7306s
	iters: 800, epoch: 2 | loss: 0.5049464
	speed: 0.0101s/iter; left time: 66.0875s
	iters: 900, epoch: 2 | loss: 0.6212130
	speed: 0.0103s/iter; left time: 66.1537s
	iters: 1000, epoch: 2 | loss: 1.0965819
	speed: 0.0091s/iter; left time: 57.6116s
Updating learning rate to 0.00055619504465
Epoch: 2 cost time: 10.12575387954712
Epoch: 2, Steps: 1045 | Train Loss: 0.5984128 Vali Loss: 0.3285597 Best vali loss: 0.3172798
	iters: 100, epoch: 3 | loss: 0.8361093
	speed: 0.0307s/iter; left time: 189.7393s
	iters: 200, epoch: 3 | loss: 0.2712342
	speed: 0.0124s/iter; left time: 75.3168s
	iters: 300, epoch: 3 | loss: 0.3934804
	speed: 0.0110s/iter; left time: 65.7316s
	iters: 400, epoch: 3 | loss: 0.3723923
	speed: 0.0096s/iter; left time: 56.1916s
	iters: 500, epoch: 3 | loss: 0.2695178
	speed: 0.0130s/iter; left time: 74.7892s
	iters: 600, epoch: 3 | loss: 1.0403098
	speed: 0.0093s/iter; left time: 53.0039s
	iters: 700, epoch: 3 | loss: 0.2708176
	speed: 0.0130s/iter; left time: 72.1881s
	iters: 800, epoch: 3 | loss: 0.6174909
	speed: 0.0152s/iter; left time: 83.0439s
	iters: 900, epoch: 3 | loss: 0.5758994
	speed: 0.0089s/iter; left time: 47.8456s
	iters: 1000, epoch: 3 | loss: 0.3774481
	speed: 0.0099s/iter; left time: 51.9456s
Updating learning rate to 0.000278097522325
Epoch: 3 cost time: 11.655336380004883
Epoch: 3, Steps: 1045 | Train Loss: 0.5024700 Vali Loss: 0.3207076 Best vali loss: 0.3172798

best validation loss 0.3172798443013472

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001557219609, 'e_layers': 3, 'learning_rate': 0.0033639330518, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3890578
	speed: 0.0152s/iter; left time: 30.4076s
	iters: 200, epoch: 1 | loss: 0.4772156
	speed: 0.0085s/iter; left time: 16.1375s
Updating learning rate to 0.0033639330518
Validation loss decreased (inf --> 0.3499).  Saving model state dict ...
Epoch: 1 cost time: 2.6073062419891357
Epoch: 1, Steps: 262 | Train Loss: 0.4331367 Vali Loss: 0.3498661 Best vali loss: 0.3498661
	iters: 100, epoch: 2 | loss: 0.7761309
	speed: 0.0207s/iter; left time: 35.9206s
	iters: 200, epoch: 2 | loss: 0.4129837
	speed: 0.0087s/iter; left time: 14.2528s
Updating learning rate to 0.0016819665259
Validation loss decreased (0.3499 --> 0.3304).  Saving model state dict ...
Epoch: 2 cost time: 2.45029616355896
Epoch: 2, Steps: 262 | Train Loss: 0.5945573 Vali Loss: 0.3304234 Best vali loss: 0.3304234
	iters: 100, epoch: 3 | loss: 0.9272321
	speed: 0.0196s/iter; left time: 28.8961s
	iters: 200, epoch: 3 | loss: 0.4700813
	speed: 0.0088s/iter; left time: 12.0686s
Updating learning rate to 0.00084098326295
Validation loss decreased (0.3304 --> 0.3217).  Saving model state dict ...
Epoch: 3 cost time: 2.3419806957244873
Epoch: 3, Steps: 262 | Train Loss: 0.6986567 Vali Loss: 0.3216638 Best vali loss: 0.3216638

best validation loss 0.32166376581374667

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010582877837, 'e_layers': 3, 'learning_rate': 0.0004438391428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6498279
	speed: 0.0151s/iter; left time: 30.0669s
	iters: 200, epoch: 1 | loss: 0.4763384
	speed: 0.0082s/iter; left time: 15.5056s
Updating learning rate to 0.0004438391428
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 2.5261008739471436
Epoch: 1, Steps: 262 | Train Loss: 0.5630832 Vali Loss: 0.2849142 Best vali loss: 0.2849142
	iters: 100, epoch: 2 | loss: 0.8093954
	speed: 0.0189s/iter; left time: 32.8019s
	iters: 200, epoch: 2 | loss: 0.4069669
	speed: 0.0087s/iter; left time: 14.1873s
Updating learning rate to 0.0002219195714
Epoch: 2 cost time: 2.3205089569091797
Epoch: 2, Steps: 262 | Train Loss: 0.6081811 Vali Loss: 0.2864116 Best vali loss: 0.2849142
	iters: 100, epoch: 3 | loss: 0.4338636
	speed: 0.0184s/iter; left time: 27.1094s
	iters: 200, epoch: 3 | loss: 0.3842490
	speed: 0.0086s/iter; left time: 11.7831s
Updating learning rate to 0.0001109597857
Epoch: 3 cost time: 2.2875561714172363
Epoch: 3, Steps: 262 | Train Loss: 0.4090563 Vali Loss: 0.2924937 Best vali loss: 0.2849142

best validation loss 0.28491423673880684

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010582877837, 'e_layers': 3, 'learning_rate': 0.0004438391428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5051817
	speed: 0.0149s/iter; left time: 18.0766s
	iters: 200, epoch: 4 | loss: 0.4377069
	speed: 0.0080s/iter; left time: 8.9140s
Updating learning rate to 5.547989285e-05
Epoch: 4 cost time: 2.44826602935791
Epoch: 4, Steps: 262 | Train Loss: 0.4714443 Vali Loss: 0.2975388 Best vali loss: 0.2849142
	iters: 100, epoch: 5 | loss: 0.5918838
	speed: 0.0185s/iter; left time: 17.5285s
	iters: 200, epoch: 5 | loss: 0.3887584
	speed: 0.0091s/iter; left time: 7.7350s
Updating learning rate to 2.7739946425e-05
Epoch: 5 cost time: 2.296921491622925
Epoch: 5, Steps: 262 | Train Loss: 0.4903211 Vali Loss: 0.3039066 Best vali loss: 0.2849142
	iters: 100, epoch: 6 | loss: 0.3871039
	speed: 0.0200s/iter; left time: 13.7544s
	iters: 200, epoch: 6 | loss: 0.3693855
	speed: 0.0112s/iter; left time: 6.5969s
Updating learning rate to 1.38699732125e-05
Epoch: 6 cost time: 2.8641088008880615
Epoch: 6, Steps: 262 | Train Loss: 0.3782447 Vali Loss: 0.3061102 Best vali loss: 0.2849142
	iters: 100, epoch: 7 | loss: 0.5959688
	speed: 0.0281s/iter; left time: 11.9493s
	iters: 200, epoch: 7 | loss: 0.2640400
	speed: 0.0111s/iter; left time: 3.6218s
Updating learning rate to 6.93498660625e-06
Epoch: 7 cost time: 3.0532126426696777
Epoch: 7, Steps: 262 | Train Loss: 0.4300044 Vali Loss: 0.3006631 Best vali loss: 0.2849142
	iters: 100, epoch: 8 | loss: 0.3261068
	speed: 0.0319s/iter; left time: 5.1998s
	iters: 200, epoch: 8 | loss: 0.6077862
	speed: 0.0108s/iter; left time: 0.6794s
Updating learning rate to 3.467493303125e-06
Epoch: 8 cost time: 2.7411091327667236
Epoch: 8, Steps: 262 | Train Loss: 0.4669465 Vali Loss: 0.3017587 Best vali loss: 0.2849142

best validation loss 0.28491423673880684

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0052314821446, 'e_layers': 4, 'learning_rate': 0.000247143109, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5573424
	speed: 0.0203s/iter; left time: 40.5669s
	iters: 200, epoch: 1 | loss: 0.4400773
	speed: 0.0131s/iter; left time: 24.8000s
Updating learning rate to 0.000247143109
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 3.80005145072937
Epoch: 1, Steps: 262 | Train Loss: 0.4987099 Vali Loss: 0.2833476 Best vali loss: 0.2833476
	iters: 100, epoch: 2 | loss: 0.4411708
	speed: 0.0244s/iter; left time: 42.3341s
	iters: 200, epoch: 2 | loss: 0.4123408
	speed: 0.0123s/iter; left time: 20.1112s
Updating learning rate to 0.0001235715545
Epoch: 2 cost time: 2.8923230171203613
Epoch: 2, Steps: 262 | Train Loss: 0.4267558 Vali Loss: 0.2859863 Best vali loss: 0.2833476
	iters: 100, epoch: 3 | loss: 0.4210337
	speed: 0.0252s/iter; left time: 37.0781s
	iters: 200, epoch: 3 | loss: 0.4076783
	speed: 0.0134s/iter; left time: 18.4398s
Updating learning rate to 6.178577725e-05
Epoch: 3 cost time: 3.791450023651123
Epoch: 3, Steps: 262 | Train Loss: 0.4143560 Vali Loss: 0.2924562 Best vali loss: 0.2833476
	iters: 100, epoch: 4 | loss: 0.3625724
	speed: 0.0363s/iter; left time: 43.9814s
	iters: 200, epoch: 4 | loss: 0.4172655
	speed: 0.0151s/iter; left time: 16.7968s
Updating learning rate to 3.0892888625e-05
Epoch: 4 cost time: 3.5755279064178467
Epoch: 4, Steps: 262 | Train Loss: 0.3899190 Vali Loss: 0.2882025 Best vali loss: 0.2833476
	iters: 100, epoch: 5 | loss: 0.6767315
	speed: 0.0214s/iter; left time: 20.3045s
	iters: 200, epoch: 5 | loss: 0.4463132
	speed: 0.0102s/iter; left time: 8.6258s
Updating learning rate to 1.54464443125e-05
Epoch: 5 cost time: 2.592616319656372
Epoch: 5, Steps: 262 | Train Loss: 0.5615223 Vali Loss: 0.2867761 Best vali loss: 0.2833476
	iters: 100, epoch: 6 | loss: 0.3635502
	speed: 0.0211s/iter; left time: 14.5225s
	iters: 200, epoch: 6 | loss: 0.3188265
	speed: 0.0097s/iter; left time: 5.6935s
Updating learning rate to 7.72322215625e-06
Epoch: 6 cost time: 2.5016348361968994
Epoch: 6, Steps: 262 | Train Loss: 0.3411884 Vali Loss: 0.2905960 Best vali loss: 0.2833476
	iters: 100, epoch: 7 | loss: 0.5699947
	speed: 0.0218s/iter; left time: 9.2655s
	iters: 200, epoch: 7 | loss: 0.3152125
	speed: 0.0097s/iter; left time: 3.1652s
Updating learning rate to 3.861611078125e-06
Epoch: 7 cost time: 2.5628418922424316
Epoch: 7, Steps: 262 | Train Loss: 0.4426036 Vali Loss: 0.2876917 Best vali loss: 0.2833476
	iters: 100, epoch: 8 | loss: 0.4179935
	speed: 0.0196s/iter; left time: 3.2021s
	iters: 200, epoch: 8 | loss: 0.2979807
	speed: 0.0088s/iter; left time: 0.5572s
Updating learning rate to 1.9308055390625e-06
Epoch: 8 cost time: 2.3238675594329834
Epoch: 8, Steps: 262 | Train Loss: 0.3579871 Vali Loss: 0.2881514 Best vali loss: 0.2833476

best validation loss 0.28334758817240757

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014592074202, 'e_layers': 3, 'learning_rate': 0.0009039657822, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4517609
	speed: 0.0160s/iter; left time: 65.3787s
	iters: 200, epoch: 1 | loss: 1.1194758
	speed: 0.0087s/iter; left time: 34.5688s
	iters: 300, epoch: 1 | loss: 0.5677136
	speed: 0.0087s/iter; left time: 33.7385s
	iters: 400, epoch: 1 | loss: 0.6214843
	speed: 0.0114s/iter; left time: 43.0531s
	iters: 500, epoch: 1 | loss: 0.3992624
	speed: 0.0106s/iter; left time: 38.9997s
Updating learning rate to 0.0009039657822
Validation loss decreased (inf --> 0.3141).  Saving model state dict ...
Epoch: 1 cost time: 5.521833181381226
Epoch: 1, Steps: 523 | Train Loss: 0.6319394 Vali Loss: 0.3141011 Best vali loss: 0.3141011
	iters: 100, epoch: 2 | loss: 1.2717067
	speed: 0.0255s/iter; left time: 90.8312s
	iters: 200, epoch: 2 | loss: 0.4110602
	speed: 0.0090s/iter; left time: 31.0057s
	iters: 300, epoch: 2 | loss: 0.2018197
	speed: 0.0077s/iter; left time: 25.7372s
	iters: 400, epoch: 2 | loss: 0.3788698
	speed: 0.0102s/iter; left time: 33.4163s
	iters: 500, epoch: 2 | loss: 0.7296883
	speed: 0.0124s/iter; left time: 39.1401s
Updating learning rate to 0.0004519828911
Epoch: 2 cost time: 5.397338628768921
Epoch: 2, Steps: 523 | Train Loss: 0.5986289 Vali Loss: 0.3244157 Best vali loss: 0.3141011
	iters: 100, epoch: 3 | loss: 0.7990080
	speed: 0.0291s/iter; left time: 88.3618s
	iters: 200, epoch: 3 | loss: 0.7348356
	speed: 0.0135s/iter; left time: 39.7537s
	iters: 300, epoch: 3 | loss: 0.2495775
	speed: 0.0128s/iter; left time: 36.2208s
	iters: 400, epoch: 3 | loss: 0.3512092
	speed: 0.0148s/iter; left time: 40.5073s
	iters: 500, epoch: 3 | loss: 0.3364453
	speed: 0.0127s/iter; left time: 33.4755s
Updating learning rate to 0.00022599144555
Epoch: 3 cost time: 6.955889701843262
Epoch: 3, Steps: 523 | Train Loss: 0.4942151 Vali Loss: 0.3209475 Best vali loss: 0.3141011
	iters: 100, epoch: 4 | loss: 0.8114272
	speed: 0.0244s/iter; left time: 61.4057s
	iters: 200, epoch: 4 | loss: 0.6168310
	speed: 0.0065s/iter; left time: 15.7954s
	iters: 300, epoch: 4 | loss: 0.5944002
	speed: 0.0067s/iter; left time: 15.4351s
	iters: 400, epoch: 4 | loss: 0.4579807
	speed: 0.0071s/iter; left time: 15.6579s
	iters: 500, epoch: 4 | loss: 0.7656914
	speed: 0.0090s/iter; left time: 19.0156s
Updating learning rate to 0.000112995722775
Epoch: 4 cost time: 3.970655918121338
Epoch: 4, Steps: 523 | Train Loss: 0.6492661 Vali Loss: 0.3247317 Best vali loss: 0.3141011
	iters: 100, epoch: 5 | loss: 0.3964613
	speed: 0.0200s/iter; left time: 39.8002s
	iters: 200, epoch: 5 | loss: 1.0190165
	speed: 0.0099s/iter; left time: 18.7626s
	iters: 300, epoch: 5 | loss: 0.5431739
	speed: 0.0099s/iter; left time: 17.6696s
	iters: 400, epoch: 5 | loss: 0.3609416
	speed: 0.0095s/iter; left time: 16.0569s
	iters: 500, epoch: 5 | loss: 0.5787263
	speed: 0.0096s/iter; left time: 15.3123s
Updating learning rate to 5.64978613875e-05
Epoch: 5 cost time: 5.075881481170654
Epoch: 5, Steps: 523 | Train Loss: 0.5796639 Vali Loss: 0.3234192 Best vali loss: 0.3141011
	iters: 100, epoch: 6 | loss: 0.3672095
	speed: 0.0218s/iter; left time: 32.0925s
	iters: 200, epoch: 6 | loss: 0.8483127
	speed: 0.0096s/iter; left time: 13.1922s
	iters: 300, epoch: 6 | loss: 0.4956509
	speed: 0.0095s/iter; left time: 12.0363s
	iters: 400, epoch: 6 | loss: 0.7900289
	speed: 0.0081s/iter; left time: 9.4536s
	iters: 500, epoch: 6 | loss: 0.5216178
	speed: 0.0097s/iter; left time: 10.3810s
Updating learning rate to 2.824893069375e-05
Epoch: 6 cost time: 4.96993613243103
Epoch: 6, Steps: 523 | Train Loss: 0.6045640 Vali Loss: 0.3197505 Best vali loss: 0.3141011
	iters: 100, epoch: 7 | loss: 0.3632842
	speed: 0.0222s/iter; left time: 20.9952s
	iters: 200, epoch: 7 | loss: 0.5442361
	speed: 0.0098s/iter; left time: 8.3186s
	iters: 300, epoch: 7 | loss: 0.8057578
	speed: 0.0090s/iter; left time: 6.6911s
	iters: 400, epoch: 7 | loss: 0.4649619
	speed: 0.0075s/iter; left time: 4.8399s
	iters: 500, epoch: 7 | loss: 0.7212560
	speed: 0.0102s/iter; left time: 5.5832s
Updating learning rate to 1.4124465346875e-05
Epoch: 7 cost time: 4.931021690368652
Epoch: 7, Steps: 523 | Train Loss: 0.5798992 Vali Loss: 0.3202170 Best vali loss: 0.3141011
	iters: 100, epoch: 8 | loss: 0.4490769
	speed: 0.0234s/iter; left time: 9.9186s
	iters: 200, epoch: 8 | loss: 0.3537141
	speed: 0.0093s/iter; left time: 3.0146s
	iters: 300, epoch: 8 | loss: 1.0127951
	speed: 0.0086s/iter; left time: 1.9324s
	iters: 400, epoch: 8 | loss: 0.5165100
	speed: 0.0076s/iter; left time: 0.9444s
	iters: 500, epoch: 8 | loss: 0.5586906
	speed: 0.0090s/iter; left time: 0.2168s
Updating learning rate to 7.0622326734375e-06
Epoch: 8 cost time: 4.780940055847168
Epoch: 8, Steps: 523 | Train Loss: 0.5781573 Vali Loss: 0.3186224 Best vali loss: 0.3141011

best validation loss 0.3141011396452768

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013550112799, 'e_layers': 2, 'learning_rate': 0.0005502704673, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4507422
	speed: 0.0145s/iter; left time: 59.3577s
	iters: 200, epoch: 1 | loss: 0.4961523
	speed: 0.0079s/iter; left time: 31.4823s
	iters: 300, epoch: 1 | loss: 0.5108191
	speed: 0.0077s/iter; left time: 29.8121s
	iters: 400, epoch: 1 | loss: 0.8281091
	speed: 0.0076s/iter; left time: 28.8185s
	iters: 500, epoch: 1 | loss: 0.3485368
	speed: 0.0083s/iter; left time: 30.4382s
Updating learning rate to 0.0005502704673
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 4.50371241569519
Epoch: 1, Steps: 523 | Train Loss: 0.5268719 Vali Loss: 0.2840899 Best vali loss: 0.2840899
	iters: 100, epoch: 2 | loss: 0.2927463
	speed: 0.0171s/iter; left time: 60.7521s
	iters: 200, epoch: 2 | loss: 0.2665237
	speed: 0.0064s/iter; left time: 22.1207s
	iters: 300, epoch: 2 | loss: 0.2595438
	speed: 0.0076s/iter; left time: 25.7160s
	iters: 400, epoch: 2 | loss: 0.4140099
	speed: 0.0073s/iter; left time: 23.7578s
	iters: 500, epoch: 2 | loss: 0.2379516
	speed: 0.0048s/iter; left time: 15.1339s
Updating learning rate to 0.00027513523365
Epoch: 2 cost time: 3.4072790145874023
Epoch: 2, Steps: 523 | Train Loss: 0.2941551 Vali Loss: 0.2862708 Best vali loss: 0.2840899
	iters: 100, epoch: 3 | loss: 0.3593991
	speed: 0.0144s/iter; left time: 43.6726s
	iters: 200, epoch: 3 | loss: 0.4010712
	speed: 0.0061s/iter; left time: 17.8982s
	iters: 300, epoch: 3 | loss: 0.2732649
	speed: 0.0068s/iter; left time: 19.3884s
	iters: 400, epoch: 3 | loss: 0.4003181
	speed: 0.0064s/iter; left time: 17.4348s
	iters: 500, epoch: 3 | loss: 0.5594615
	speed: 0.0064s/iter; left time: 16.9586s
Updating learning rate to 0.000137567616825
Epoch: 3 cost time: 3.4778594970703125
Epoch: 3, Steps: 523 | Train Loss: 0.3987029 Vali Loss: 0.2885695 Best vali loss: 0.2840899

best validation loss 0.284089866503325

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0033008172643, 'e_layers': 3, 'learning_rate': 5.7368229e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5280131
	speed: 0.0153s/iter; left time: 126.4896s
	iters: 200, epoch: 1 | loss: 0.2819723
	speed: 0.0086s/iter; left time: 70.2007s
	iters: 300, epoch: 1 | loss: 0.8855032
	speed: 0.0081s/iter; left time: 65.4966s
	iters: 400, epoch: 1 | loss: 0.6217671
	speed: 0.0073s/iter; left time: 57.8934s
	iters: 500, epoch: 1 | loss: 1.3445705
	speed: 0.0058s/iter; left time: 45.4018s
	iters: 600, epoch: 1 | loss: 1.0157806
	speed: 0.0062s/iter; left time: 48.2986s
	iters: 700, epoch: 1 | loss: 0.3208531
	speed: 0.0057s/iter; left time: 43.9923s
	iters: 800, epoch: 1 | loss: 1.2408707
	speed: 0.0067s/iter; left time: 50.3798s
	iters: 900, epoch: 1 | loss: 0.4740392
	speed: 0.0068s/iter; left time: 50.5356s
	iters: 1000, epoch: 1 | loss: 0.1902145
	speed: 0.0102s/iter; left time: 74.7912s
Updating learning rate to 5.7368229e-05
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 8.108878135681152
Epoch: 1, Steps: 1045 | Train Loss: 0.6903584 Vali Loss: 0.2931750 Best vali loss: 0.2931750
	iters: 100, epoch: 2 | loss: 1.7626224
	speed: 0.0243s/iter; left time: 175.0152s
	iters: 200, epoch: 2 | loss: 0.5594243
	speed: 0.0087s/iter; left time: 61.7115s
	iters: 300, epoch: 2 | loss: 1.0256339
	speed: 0.0073s/iter; left time: 51.0564s
	iters: 400, epoch: 2 | loss: 0.4033692
	speed: 0.0064s/iter; left time: 44.3849s
	iters: 500, epoch: 2 | loss: 0.3181785
	speed: 0.0096s/iter; left time: 65.6482s
	iters: 600, epoch: 2 | loss: 0.4668401
	speed: 0.0103s/iter; left time: 69.0782s
	iters: 700, epoch: 2 | loss: 0.3190863
	speed: 0.0094s/iter; left time: 62.4797s
	iters: 800, epoch: 2 | loss: 0.2636259
	speed: 0.0071s/iter; left time: 46.2435s
	iters: 900, epoch: 2 | loss: 0.1780355
	speed: 0.0076s/iter; left time: 48.6009s
	iters: 1000, epoch: 2 | loss: 0.2788675
	speed: 0.0111s/iter; left time: 70.2782s
Updating learning rate to 2.86841145e-05
Validation loss decreased (0.2932 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 8.888504028320312
Epoch: 2, Steps: 1045 | Train Loss: 0.5575684 Vali Loss: 0.2843415 Best vali loss: 0.2843415
	iters: 100, epoch: 3 | loss: 0.6269986
	speed: 0.0260s/iter; left time: 160.4744s
	iters: 200, epoch: 3 | loss: 0.1553994
	speed: 0.0083s/iter; left time: 50.3650s
	iters: 300, epoch: 3 | loss: 0.3644065
	speed: 0.0072s/iter; left time: 42.6974s
	iters: 400, epoch: 3 | loss: 0.3993834
	speed: 0.0076s/iter; left time: 44.6920s
	iters: 500, epoch: 3 | loss: 0.3528233
	speed: 0.0127s/iter; left time: 73.4217s
	iters: 600, epoch: 3 | loss: 0.3586821
	speed: 0.0112s/iter; left time: 63.5881s
	iters: 700, epoch: 3 | loss: 0.8688791
	speed: 0.0150s/iter; left time: 83.6517s
	iters: 800, epoch: 3 | loss: 0.3130797
	speed: 0.0093s/iter; left time: 50.7319s
	iters: 900, epoch: 3 | loss: 0.3185613
	speed: 0.0088s/iter; left time: 47.3077s
	iters: 1000, epoch: 3 | loss: 0.7824342
	speed: 0.0077s/iter; left time: 40.6579s
Updating learning rate to 1.434205725e-05
Validation loss decreased (0.2843 --> 0.2824).  Saving model state dict ...
Epoch: 3 cost time: 9.99268102645874
Epoch: 3, Steps: 1045 | Train Loss: 0.4540648 Vali Loss: 0.2823821 Best vali loss: 0.2823821

best validation loss 0.28238209552838484

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.003778909515, 'e_layers': 2, 'learning_rate': 7.38400575e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8293602
	speed: 0.0165s/iter; left time: 15.6318s
Updating learning rate to 7.38400575e-05
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 2.008509397506714
Epoch: 1, Steps: 131 | Train Loss: 0.8293602 Vali Loss: 0.2847082 Best vali loss: 0.2847082
	iters: 100, epoch: 2 | loss: 0.5347572
	speed: 0.0340s/iter; left time: 27.8023s
Updating learning rate to 3.692002875e-05
Validation loss decreased (0.2847 --> 0.2793).  Saving model state dict ...
Epoch: 2 cost time: 2.4117751121520996
Epoch: 2, Steps: 131 | Train Loss: 0.5347572 Vali Loss: 0.2793168 Best vali loss: 0.2793168
	iters: 100, epoch: 3 | loss: 0.6244172
	speed: 0.0342s/iter; left time: 23.5226s
Updating learning rate to 1.8460014375e-05
Epoch: 3 cost time: 2.5517983436584473
Epoch: 3, Steps: 131 | Train Loss: 0.6244172 Vali Loss: 0.2793339 Best vali loss: 0.2793168

best validation loss 0.27931684642952587

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.003778909515, 'e_layers': 2, 'learning_rate': 7.38400575e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7691339
	speed: 0.0241s/iter; left time: 13.3813s
Updating learning rate to 9.2300071875e-06
Validation loss decreased (0.2793 --> 0.2792).  Saving model state dict ...
Epoch: 4 cost time: 2.5820655822753906
Epoch: 4, Steps: 131 | Train Loss: 0.7691339 Vali Loss: 0.2792132 Best vali loss: 0.2792132
	iters: 100, epoch: 5 | loss: 0.4726518
	speed: 0.0502s/iter; left time: 21.3398s
Updating learning rate to 4.61500359375e-06
Validation loss decreased (0.2792 --> 0.2785).  Saving model state dict ...
Epoch: 5 cost time: 3.8272876739501953
Epoch: 5, Steps: 131 | Train Loss: 0.4726518 Vali Loss: 0.2784975 Best vali loss: 0.2784975
	iters: 100, epoch: 6 | loss: 0.5877504
	speed: 0.0602s/iter; left time: 17.7087s
Updating learning rate to 2.307501796875e-06
Validation loss decreased (0.2785 --> 0.2784).  Saving model state dict ...
Epoch: 6 cost time: 3.9389736652374268
Epoch: 6, Steps: 131 | Train Loss: 0.5877504 Vali Loss: 0.2783573 Best vali loss: 0.2783573
	iters: 100, epoch: 7 | loss: 0.2472601
	speed: 0.0597s/iter; left time: 9.7386s
Updating learning rate to 1.1537508984375e-06
Epoch: 7 cost time: 4.124511957168579
Epoch: 7, Steps: 131 | Train Loss: 0.2472601 Vali Loss: 0.2784028 Best vali loss: 0.2783573
	iters: 100, epoch: 8 | loss: 0.4233961
	speed: 0.0563s/iter; left time: 1.8009s
Updating learning rate to 5.7687544921875e-07
Epoch: 8 cost time: 3.2949812412261963
Epoch: 8, Steps: 131 | Train Loss: 0.4233961 Vali Loss: 0.2783842 Best vali loss: 0.2783573

best validation loss 0.27835728153835754

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0012599336841, 'e_layers': 4, 'learning_rate': 6.44670134e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6497158
	speed: 0.0385s/iter; left time: 36.5310s
Updating learning rate to 6.201338380119543e-05
Validation loss decreased (inf --> 0.2771).  Saving model state dict ...
Epoch: 1 cost time: 4.42828631401062
Epoch: 1, Steps: 131 | Train Loss: 0.6497158 Vali Loss: 0.2771063 Best vali loss: 0.2771063
	iters: 100, epoch: 2 | loss: 0.6839041
	speed: 0.0619s/iter; left time: 50.6194s
Updating learning rate to 5.502603786899201e-05
Epoch: 2 cost time: 4.368266582489014
Epoch: 2, Steps: 131 | Train Loss: 0.6839041 Vali Loss: 0.2786389 Best vali loss: 0.2771063
	iters: 100, epoch: 3 | loss: 0.4701113
	speed: 0.0651s/iter; left time: 44.7069s
Updating learning rate to 4.456873568111912e-05
Validation loss decreased (0.2771 --> 0.2746).  Saving model state dict ...
Epoch: 3 cost time: 4.280652284622192
Epoch: 3, Steps: 131 | Train Loss: 0.4701113 Vali Loss: 0.2746235 Best vali loss: 0.2746235
	iters: 100, epoch: 4 | loss: 0.7147571
	speed: 0.0398s/iter; left time: 22.1315s
Updating learning rate to 3.22335067e-05
Epoch: 4 cost time: 3.0281975269317627
Epoch: 4, Steps: 131 | Train Loss: 0.7147571 Vali Loss: 0.2787256 Best vali loss: 0.2746235
	iters: 100, epoch: 5 | loss: 0.3545581
	speed: 0.0574s/iter; left time: 24.3746s
Updating learning rate to 1.9898277718880883e-05
Epoch: 5 cost time: 4.2142333984375
Epoch: 5, Steps: 131 | Train Loss: 0.3545581 Vali Loss: 0.2839121 Best vali loss: 0.2746235
	iters: 100, epoch: 6 | loss: 0.3565277
	speed: 0.0672s/iter; left time: 19.7551s
Updating learning rate to 9.440975531007989e-06
Epoch: 6 cost time: 4.380854606628418
Epoch: 6, Steps: 131 | Train Loss: 0.3565277 Vali Loss: 0.2883871 Best vali loss: 0.2746235
	iters: 100, epoch: 7 | loss: 0.2341570
	speed: 0.0478s/iter; left time: 7.7852s
Updating learning rate to 2.4536295988045713e-06
Epoch: 7 cost time: 3.5784313678741455
Epoch: 7, Steps: 131 | Train Loss: 0.2341570 Vali Loss: 0.2889666 Best vali loss: 0.2746235
	iters: 100, epoch: 8 | loss: 0.5858195
	speed: 0.0341s/iter; left time: 1.0924s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.884845018386841
Epoch: 8, Steps: 131 | Train Loss: 0.5858195 Vali Loss: 0.2880616 Best vali loss: 0.2746235

best validation loss 0.2746235064389139

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0026909572937, 'e_layers': 2, 'learning_rate': 0.0001893678182, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0568031
	speed: 0.0186s/iter; left time: 37.0778s
	iters: 200, epoch: 1 | loss: 0.8056704
	speed: 0.0111s/iter; left time: 21.1016s
Updating learning rate to 0.0001821604347756492
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 3.4104270935058594
Epoch: 1, Steps: 262 | Train Loss: 0.9312368 Vali Loss: 0.2846296 Best vali loss: 0.2846296
	iters: 100, epoch: 2 | loss: 0.8617585
	speed: 0.0262s/iter; left time: 45.5237s
	iters: 200, epoch: 2 | loss: 0.4372544
	speed: 0.0076s/iter; left time: 12.4505s
Updating learning rate to 0.00016163554329386067
Validation loss decreased (0.2846 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 1.9736077785491943
Epoch: 2, Steps: 262 | Train Loss: 0.6495064 Vali Loss: 0.2818223 Best vali loss: 0.2818223
	iters: 100, epoch: 3 | loss: 0.6548427
	speed: 0.0150s/iter; left time: 22.0525s
	iters: 200, epoch: 3 | loss: 0.5840133
	speed: 0.0083s/iter; left time: 11.4637s
Updating learning rate to 0.00013091787242413218
Epoch: 3 cost time: 1.9105513095855713
Epoch: 3, Steps: 262 | Train Loss: 0.6194280 Vali Loss: 0.2825173 Best vali loss: 0.2818223
	iters: 100, epoch: 4 | loss: 0.3297614
	speed: 0.0273s/iter; left time: 33.0793s
	iters: 200, epoch: 4 | loss: 1.1525960
	speed: 0.0095s/iter; left time: 10.5283s
Updating learning rate to 9.46839091e-05
Epoch: 4 cost time: 2.518158197402954
Epoch: 4, Steps: 262 | Train Loss: 0.7411787 Vali Loss: 0.2855333 Best vali loss: 0.2818223
	iters: 100, epoch: 5 | loss: 0.4009410
	speed: 0.0267s/iter; left time: 25.3452s
	iters: 200, epoch: 5 | loss: 0.4741982
	speed: 0.0097s/iter; left time: 8.2544s
Updating learning rate to 5.844994577586785e-05
Epoch: 5 cost time: 2.487703323364258
Epoch: 5, Steps: 262 | Train Loss: 0.4375696 Vali Loss: 0.2848662 Best vali loss: 0.2818223
	iters: 100, epoch: 6 | loss: 0.3610550
	speed: 0.0138s/iter; left time: 9.4993s
	iters: 200, epoch: 6 | loss: 0.5098259
	speed: 0.0056s/iter; left time: 3.3060s
Updating learning rate to 2.773227490613935e-05
Epoch: 6 cost time: 1.549407958984375
Epoch: 6, Steps: 262 | Train Loss: 0.4354405 Vali Loss: 0.2833536 Best vali loss: 0.2818223
	iters: 100, epoch: 7 | loss: 0.2727670
	speed: 0.0168s/iter; left time: 7.1520s
	iters: 200, epoch: 7 | loss: 0.6538026
	speed: 0.0076s/iter; left time: 2.4575s
Updating learning rate to 7.207383424350832e-06
Epoch: 7 cost time: 1.9789063930511475
Epoch: 7, Steps: 262 | Train Loss: 0.4632848 Vali Loss: 0.2827178 Best vali loss: 0.2818223
	iters: 100, epoch: 8 | loss: 0.4010019
	speed: 0.0174s/iter; left time: 2.8286s
	iters: 200, epoch: 8 | loss: 0.6744832
	speed: 0.0076s/iter; left time: 0.4774s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.091827630996704
Epoch: 8, Steps: 262 | Train Loss: 0.5377426 Vali Loss: 0.2842368 Best vali loss: 0.2818223

best validation loss 0.2818223461647289

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0026805940516, 'e_layers': 4, 'learning_rate': 0.0027816638554, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6339254
	speed: 0.0233s/iter; left time: 22.1187s
Updating learning rate to 0.0026757930788652478
Validation loss decreased (inf --> 0.3091).  Saving model state dict ...
Epoch: 1 cost time: 2.5133795738220215
Epoch: 1, Steps: 131 | Train Loss: 0.6339254 Vali Loss: 0.3090988 Best vali loss: 0.3090988
	iters: 100, epoch: 2 | loss: 0.6172565
	speed: 0.0276s/iter; left time: 22.5608s
Updating learning rate to 0.002374298615267428
Epoch: 2 cost time: 1.7565302848815918
Epoch: 2, Steps: 131 | Train Loss: 0.6172565 Vali Loss: 0.3203987 Best vali loss: 0.3090988
	iters: 100, epoch: 3 | loss: 0.7587872
	speed: 0.0159s/iter; left time: 10.9377s
Updating learning rate to 0.0019230802636351905
Epoch: 3 cost time: 1.451235055923462
Epoch: 3, Steps: 131 | Train Loss: 0.7587872 Vali Loss: 0.3251079 Best vali loss: 0.3090988

best validation loss 0.3090988393608369

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012021665549, 'e_layers': 3, 'learning_rate': 0.0032654744331, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5522031
	speed: 0.0145s/iter; left time: 119.4392s
	iters: 200, epoch: 1 | loss: 0.2248281
	speed: 0.0071s/iter; left time: 57.8312s
	iters: 300, epoch: 1 | loss: 0.3382277
	speed: 0.0074s/iter; left time: 59.4552s
	iters: 400, epoch: 1 | loss: 0.3209665
	speed: 0.0079s/iter; left time: 63.0401s
	iters: 500, epoch: 1 | loss: 0.3803291
	speed: 0.0086s/iter; left time: 67.3464s
	iters: 600, epoch: 1 | loss: 0.2540809
	speed: 0.0081s/iter; left time: 62.7525s
	iters: 700, epoch: 1 | loss: 0.4844159
	speed: 0.0078s/iter; left time: 60.0265s
	iters: 800, epoch: 1 | loss: 0.7126335
	speed: 0.0082s/iter; left time: 62.2017s
	iters: 900, epoch: 1 | loss: 0.2986026
	speed: 0.0068s/iter; left time: 50.6629s
	iters: 1000, epoch: 1 | loss: 0.4469025
	speed: 0.0079s/iter; left time: 57.9657s
Updating learning rate to 0.0032654744331
Validation loss decreased (inf --> 0.2928).  Saving model state dict ...
Epoch: 1 cost time: 8.526990175247192
Epoch: 1, Steps: 1045 | Train Loss: 0.4013190 Vali Loss: 0.2927524 Best vali loss: 0.2927524
	iters: 100, epoch: 2 | loss: 0.4100409
	speed: 0.0272s/iter; left time: 196.3618s
	iters: 200, epoch: 2 | loss: 3.2730672
	speed: 0.0091s/iter; left time: 64.6508s
	iters: 300, epoch: 2 | loss: 0.1865939
	speed: 0.0080s/iter; left time: 56.2464s
	iters: 400, epoch: 2 | loss: 0.9800724
	speed: 0.0089s/iter; left time: 61.8039s
	iters: 500, epoch: 2 | loss: 1.4067444
	speed: 0.0090s/iter; left time: 61.2151s
	iters: 600, epoch: 2 | loss: 0.1693784
	speed: 0.0091s/iter; left time: 61.0557s
	iters: 700, epoch: 2 | loss: 0.4111313
	speed: 0.0082s/iter; left time: 54.5774s
	iters: 800, epoch: 2 | loss: 0.5987713
	speed: 0.0082s/iter; left time: 53.6235s
	iters: 900, epoch: 2 | loss: 0.1351637
	speed: 0.0084s/iter; left time: 53.6310s
	iters: 1000, epoch: 2 | loss: 1.1510502
	speed: 0.0088s/iter; left time: 55.7423s
Updating learning rate to 0.00163273721655
Validation loss decreased (0.2928 --> 0.2865).  Saving model state dict ...
Epoch: 2 cost time: 9.11076307296753
Epoch: 2, Steps: 1045 | Train Loss: 0.8722014 Vali Loss: 0.2864862 Best vali loss: 0.2864862
	iters: 100, epoch: 3 | loss: 0.3208998
	speed: 0.0283s/iter; left time: 174.4666s
	iters: 200, epoch: 3 | loss: 1.0933268
	speed: 0.0066s/iter; left time: 40.1064s
	iters: 300, epoch: 3 | loss: 0.3628066
	speed: 0.0061s/iter; left time: 36.2734s
	iters: 400, epoch: 3 | loss: 0.5018566
	speed: 0.0048s/iter; left time: 28.0487s
	iters: 500, epoch: 3 | loss: 0.5072491
	speed: 0.0066s/iter; left time: 37.9025s
	iters: 600, epoch: 3 | loss: 0.3830178
	speed: 0.0097s/iter; left time: 54.8407s
	iters: 700, epoch: 3 | loss: 1.4411346
	speed: 0.0086s/iter; left time: 47.6371s
	iters: 800, epoch: 3 | loss: 0.2856812
	speed: 0.0082s/iter; left time: 44.9818s
	iters: 900, epoch: 3 | loss: 0.2888669
	speed: 0.0068s/iter; left time: 36.5360s
	iters: 1000, epoch: 3 | loss: 0.1504697
	speed: 0.0088s/iter; left time: 46.2173s
Updating learning rate to 0.000816368608275
Validation loss decreased (0.2865 --> 0.2844).  Saving model state dict ...
Epoch: 3 cost time: 7.932724714279175
Epoch: 3, Steps: 1045 | Train Loss: 0.5335309 Vali Loss: 0.2844019 Best vali loss: 0.2844019

best validation loss 0.2844019405302748

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0092091879374, 'e_layers': 2, 'learning_rate': 0.0001499451109, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3565772
	speed: 0.0130s/iter; left time: 53.1595s
	iters: 200, epoch: 1 | loss: 0.4143160
	speed: 0.0074s/iter; left time: 29.6100s
	iters: 300, epoch: 1 | loss: 0.4387806
	speed: 0.0078s/iter; left time: 30.3075s
	iters: 400, epoch: 1 | loss: 0.6165987
	speed: 0.0067s/iter; left time: 25.2077s
	iters: 500, epoch: 1 | loss: 0.3886943
	speed: 0.0077s/iter; left time: 28.3809s
Updating learning rate to 0.0001499451109
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 4.111858367919922
Epoch: 1, Steps: 523 | Train Loss: 0.4429934 Vali Loss: 0.2861636 Best vali loss: 0.2861636
	iters: 100, epoch: 2 | loss: 0.4791641
	speed: 0.0137s/iter; left time: 48.8353s
	iters: 200, epoch: 2 | loss: 0.5460546
	speed: 0.0045s/iter; left time: 15.5879s
	iters: 300, epoch: 2 | loss: 1.2611988
	speed: 0.0046s/iter; left time: 15.5060s
	iters: 400, epoch: 2 | loss: 0.2540300
	speed: 0.0064s/iter; left time: 20.7743s
	iters: 500, epoch: 2 | loss: 0.2715178
	speed: 0.0060s/iter; left time: 19.0922s
Updating learning rate to 7.497255545e-05
Validation loss decreased (0.2862 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 2.8872222900390625
Epoch: 2, Steps: 523 | Train Loss: 0.5623930 Vali Loss: 0.2812238 Best vali loss: 0.2812238
	iters: 100, epoch: 3 | loss: 0.3472440
	speed: 0.0139s/iter; left time: 42.0976s
	iters: 200, epoch: 3 | loss: 0.8945205
	speed: 0.0064s/iter; left time: 18.7430s
	iters: 300, epoch: 3 | loss: 0.3668721
	speed: 0.0067s/iter; left time: 18.9189s
	iters: 400, epoch: 3 | loss: 0.7664543
	speed: 0.0065s/iter; left time: 17.7434s
	iters: 500, epoch: 3 | loss: 0.4568658
	speed: 0.0046s/iter; left time: 12.0944s
Updating learning rate to 3.7486277725e-05
Epoch: 3 cost time: 3.209289789199829
Epoch: 3, Steps: 523 | Train Loss: 0.5663913 Vali Loss: 0.2818988 Best vali loss: 0.2812238

best validation loss 0.2812238390193459

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0092091879374, 'e_layers': 2, 'learning_rate': 0.0001499451109, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3047425
	speed: 0.0124s/iter; left time: 31.2131s
	iters: 200, epoch: 4 | loss: 0.3707310
	speed: 0.0079s/iter; left time: 19.1266s
	iters: 300, epoch: 4 | loss: 0.4114731
	speed: 0.0067s/iter; left time: 15.6233s
	iters: 400, epoch: 4 | loss: 0.5779672
	speed: 0.0068s/iter; left time: 15.0166s
	iters: 500, epoch: 4 | loss: 0.3680412
	speed: 0.0044s/iter; left time: 9.2781s
Updating learning rate to 1.87431388625e-05
Epoch: 4 cost time: 3.586195945739746
Epoch: 4, Steps: 523 | Train Loss: 0.4065910 Vali Loss: 0.2817760 Best vali loss: 0.2812238
	iters: 100, epoch: 5 | loss: 0.4716339
	speed: 0.0154s/iter; left time: 30.6541s
	iters: 200, epoch: 5 | loss: 0.5338321
	speed: 0.0079s/iter; left time: 14.9082s
	iters: 300, epoch: 5 | loss: 1.2330117
	speed: 0.0080s/iter; left time: 14.3820s
	iters: 400, epoch: 5 | loss: 0.2575419
	speed: 0.0062s/iter; left time: 10.4441s
	iters: 500, epoch: 5 | loss: 0.2664133
	speed: 0.0079s/iter; left time: 12.6220s
Updating learning rate to 9.37156943125e-06
Epoch: 5 cost time: 4.0286805629730225
Epoch: 5, Steps: 523 | Train Loss: 0.5524866 Vali Loss: 0.2818905 Best vali loss: 0.2812238
	iters: 100, epoch: 6 | loss: 0.3419720
	speed: 0.0149s/iter; left time: 21.9546s
	iters: 200, epoch: 6 | loss: 0.8308930
	speed: 0.0085s/iter; left time: 11.6458s
	iters: 300, epoch: 6 | loss: 0.3543738
	speed: 0.0066s/iter; left time: 8.4138s
	iters: 400, epoch: 6 | loss: 0.7526437
	speed: 0.0087s/iter; left time: 10.2340s
	iters: 500, epoch: 6 | loss: 0.4479769
	speed: 0.0093s/iter; left time: 9.9295s
Updating learning rate to 4.685784715625e-06
Epoch: 6 cost time: 4.25891637802124
Epoch: 6, Steps: 523 | Train Loss: 0.5455719 Vali Loss: 0.2820225 Best vali loss: 0.2812238
	iters: 100, epoch: 7 | loss: 0.4521114
	speed: 0.0216s/iter; left time: 20.4976s
	iters: 200, epoch: 7 | loss: 0.7445081
	speed: 0.0063s/iter; left time: 5.3545s
	iters: 300, epoch: 7 | loss: 0.3367119
	speed: 0.0052s/iter; left time: 3.8587s
	iters: 400, epoch: 7 | loss: 0.4904840
	speed: 0.0069s/iter; left time: 4.4629s
	iters: 500, epoch: 7 | loss: 0.3466359
	speed: 0.0065s/iter; left time: 3.5507s
Updating learning rate to 2.3428923578125e-06
Epoch: 7 cost time: 3.530076265335083
Epoch: 7, Steps: 523 | Train Loss: 0.4740903 Vali Loss: 0.2820093 Best vali loss: 0.2812238
	iters: 100, epoch: 8 | loss: 0.5552610
	speed: 0.0160s/iter; left time: 6.7860s
	iters: 200, epoch: 8 | loss: 0.3205975
	speed: 0.0065s/iter; left time: 2.1066s
	iters: 300, epoch: 8 | loss: 0.4050062
	speed: 0.0063s/iter; left time: 1.4164s
	iters: 400, epoch: 8 | loss: 0.4491561
	speed: 0.0053s/iter; left time: 0.6623s
	iters: 500, epoch: 8 | loss: 0.2440719
	speed: 0.0064s/iter; left time: 0.1542s
Updating learning rate to 1.17144617890625e-06
Epoch: 8 cost time: 3.35223650932312
Epoch: 8, Steps: 523 | Train Loss: 0.3948185 Vali Loss: 0.2820318 Best vali loss: 0.2812238

best validation loss 0.2812238390193459

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0039094427311, 'e_layers': 3, 'learning_rate': 0.0005163310293, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0179961
	speed: 0.0205s/iter; left time: 169.1669s
	iters: 200, epoch: 1 | loss: 1.4469898
	speed: 0.0120s/iter; left time: 98.2713s
	iters: 300, epoch: 1 | loss: 0.3209226
	speed: 0.0132s/iter; left time: 106.1062s
	iters: 400, epoch: 1 | loss: 0.4847702
	speed: 0.0086s/iter; left time: 68.3226s
	iters: 500, epoch: 1 | loss: 1.1217031
	speed: 0.0123s/iter; left time: 96.5213s
	iters: 600, epoch: 1 | loss: 0.6288738
	speed: 0.0116s/iter; left time: 90.1736s
	iters: 700, epoch: 1 | loss: 0.3220548
	speed: 0.0145s/iter; left time: 111.4318s
	iters: 800, epoch: 1 | loss: 0.2496103
	speed: 0.0083s/iter; left time: 62.4820s
	iters: 900, epoch: 1 | loss: 0.6812215
	speed: 0.0069s/iter; left time: 51.4252s
	iters: 1000, epoch: 1 | loss: 0.4564358
	speed: 0.0067s/iter; left time: 49.6698s
Updating learning rate to 0.0004966793496353777
Validation loss decreased (inf --> 0.3171).  Saving model state dict ...
Epoch: 1 cost time: 11.428598880767822
Epoch: 1, Steps: 1045 | Train Loss: 0.6730578 Vali Loss: 0.3170756 Best vali loss: 0.3170756
	iters: 100, epoch: 2 | loss: 0.6570560
	speed: 0.0282s/iter; left time: 203.1882s
	iters: 200, epoch: 2 | loss: 0.6506054
	speed: 0.0108s/iter; left time: 76.8829s
	iters: 300, epoch: 2 | loss: 1.2527511
	speed: 0.0101s/iter; left time: 70.9492s
	iters: 400, epoch: 2 | loss: 0.6384631
	speed: 0.0096s/iter; left time: 66.3204s
	iters: 500, epoch: 2 | loss: 1.6640044
	speed: 0.0089s/iter; left time: 60.7417s
	iters: 600, epoch: 2 | loss: 0.3478242
	speed: 0.0105s/iter; left time: 70.6947s
	iters: 700, epoch: 2 | loss: 0.2871482
	speed: 0.0100s/iter; left time: 66.1915s
	iters: 800, epoch: 2 | loss: 0.3723184
	speed: 0.0100s/iter; left time: 64.9228s
	iters: 900, epoch: 2 | loss: 0.6240140
	speed: 0.0108s/iter; left time: 69.1807s
	iters: 1000, epoch: 2 | loss: 0.3766391
	speed: 0.0098s/iter; left time: 62.0356s
Updating learning rate to 0.00044071610072752995
Epoch: 2 cost time: 10.612335205078125
Epoch: 2, Steps: 1045 | Train Loss: 0.6870824 Vali Loss: 0.3201941 Best vali loss: 0.3170756
	iters: 100, epoch: 3 | loss: 0.2984526
	speed: 0.0322s/iter; left time: 198.8911s
	iters: 200, epoch: 3 | loss: 0.9979199
	speed: 0.0076s/iter; left time: 46.3843s
	iters: 300, epoch: 3 | loss: 0.5778751
	speed: 0.0107s/iter; left time: 63.6789s
	iters: 400, epoch: 3 | loss: 0.5222528
	speed: 0.0106s/iter; left time: 62.0631s
	iters: 500, epoch: 3 | loss: 0.2413087
	speed: 0.0100s/iter; left time: 57.5892s
	iters: 600, epoch: 3 | loss: 1.2041582
	speed: 0.0106s/iter; left time: 60.2181s
	iters: 700, epoch: 3 | loss: 0.7978511
	speed: 0.0104s/iter; left time: 57.8875s
	iters: 800, epoch: 3 | loss: 0.3962419
	speed: 0.0112s/iter; left time: 61.0595s
	iters: 900, epoch: 3 | loss: 0.2510901
	speed: 0.0112s/iter; left time: 60.4227s
	iters: 1000, epoch: 3 | loss: 0.3811852
	speed: 0.0112s/iter; left time: 59.0643s
Updating learning rate to 0.0003569611799145619
Epoch: 3 cost time: 10.85232663154602
Epoch: 3, Steps: 1045 | Train Loss: 0.5668336 Vali Loss: 0.3218710 Best vali loss: 0.3170756
	iters: 100, epoch: 4 | loss: 1.2130526
	speed: 0.0341s/iter; left time: 174.6170s
	iters: 200, epoch: 4 | loss: 0.4192518
	speed: 0.0105s/iter; left time: 52.7384s
	iters: 300, epoch: 4 | loss: 0.8716616
	speed: 0.0113s/iter; left time: 55.8238s
	iters: 400, epoch: 4 | loss: 0.8376449
	speed: 0.0109s/iter; left time: 52.4134s
	iters: 500, epoch: 4 | loss: 0.8153350
	speed: 0.0111s/iter; left time: 52.5526s
	iters: 600, epoch: 4 | loss: 0.5390347
	speed: 0.0106s/iter; left time: 48.8679s
	iters: 700, epoch: 4 | loss: 0.2239812
	speed: 0.0107s/iter; left time: 48.5789s
	iters: 800, epoch: 4 | loss: 0.5975753
	speed: 0.0098s/iter; left time: 43.1609s
	iters: 900, epoch: 4 | loss: 0.6653945
	speed: 0.0100s/iter; left time: 43.3274s
	iters: 1000, epoch: 4 | loss: 0.4387935
	speed: 0.0094s/iter; left time: 39.7242s
Updating learning rate to 0.00025816551465
Epoch: 4 cost time: 10.92323899269104
Epoch: 4, Steps: 1045 | Train Loss: 0.6621725 Vali Loss: 0.3223818 Best vali loss: 0.3170756
	iters: 100, epoch: 5 | loss: 0.7814284
	speed: 0.0274s/iter; left time: 111.6199s
	iters: 200, epoch: 5 | loss: 0.3044783
	speed: 0.0070s/iter; left time: 27.7780s
	iters: 300, epoch: 5 | loss: 0.2939529
	speed: 0.0068s/iter; left time: 26.5158s
	iters: 400, epoch: 5 | loss: 1.5720946
	speed: 0.0067s/iter; left time: 25.5086s
	iters: 500, epoch: 5 | loss: 1.5334014
	speed: 0.0065s/iter; left time: 23.8028s
	iters: 600, epoch: 5 | loss: 0.9598562
	speed: 0.0078s/iter; left time: 27.9511s
	iters: 700, epoch: 5 | loss: 1.2186025
	speed: 0.0102s/iter; left time: 35.6405s
	iters: 800, epoch: 5 | loss: 0.3521202
	speed: 0.0110s/iter; left time: 37.3599s
	iters: 900, epoch: 5 | loss: 1.3434286
	speed: 0.0098s/iter; left time: 32.1133s
	iters: 1000, epoch: 5 | loss: 0.2543946
	speed: 0.0090s/iter; left time: 28.6458s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013908133152, 'e_layers': 4, 'learning_rate': 0.0013106598091, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0013106598091
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 1.2377355098724365
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2860243 Best vali loss: 0.2860243
Updating learning rate to 0.00065532990455
Epoch: 2 cost time: 0.9470374584197998
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2860472 Best vali loss: 0.2860243
Updating learning rate to 0.000327664952275
Epoch: 3 cost time: 1.2287085056304932
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2935000 Best vali loss: 0.2860243
Updating learning rate to 0.0001638324761375
Validation loss decreased (0.2860 --> 0.2833).  Saving model state dict ...
Epoch: 4 cost time: 2.2051467895507812
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2832652 Best vali loss: 0.2832652
Updating learning rate to 8.191623806875e-05
Epoch: 5 cost time: 0.9250290393829346
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2840554 Best vali loss: 0.2832652
Updating learning rate to 4.0958119034375e-05
Validation loss decreased (0.2833 --> 0.2823).  Saving model state dict ...
Epoch: 6 cost time: 0.9902269840240479
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2822873 Best vali loss: 0.2822873
Updating learning rate to 2.04790595171875e-05
Epoch: 7 cost time: 1.5389783382415771
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2840648 Best vali loss: 0.2822873
Updating learning rate to 1.023952975859375e-05
Epoch: 8 cost time: 0.9235880374908447
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2842586 Best vali loss: 0.2822873

best validation loss 0.2822873372267329

[INFO][smbo.py:320] Finished 600 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0014830216749, 'e_layers': 4, 'learning_rate': 0.0014975318537, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4971990
	speed: 0.0193s/iter; left time: 18.3172s
Updating learning rate to 0.0014405354413085584
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 2.0281152725219727
Epoch: 1, Steps: 131 | Train Loss: 0.4971990 Vali Loss: 0.2839226 Best vali loss: 0.2839226
	iters: 100, epoch: 2 | loss: 0.6198848
	speed: 0.0269s/iter; left time: 21.9767s
Updating learning rate to 0.0012782233912470653
Epoch: 2 cost time: 2.3169543743133545
Epoch: 2, Steps: 131 | Train Loss: 0.6198848 Vali Loss: 0.2905185 Best vali loss: 0.2839226
	iters: 100, epoch: 3 | loss: 0.2859163
	speed: 0.0320s/iter; left time: 21.9707s
Updating learning rate to 0.0010353062417749858
Validation loss decreased (0.2839 --> 0.2798).  Saving model state dict ...
Epoch: 3 cost time: 2.8507487773895264
Epoch: 3, Steps: 131 | Train Loss: 0.2859163 Vali Loss: 0.2798435 Best vali loss: 0.2798435

best validation loss 0.2798434910986139

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0022543798393, 'e_layers': 2, 'learning_rate': 0.0003588348835, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000345177543958361
Validation loss decreased (inf --> 0.3154).  Saving model state dict ...
Epoch: 1 cost time: 1.5715618133544922
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3153954 Best vali loss: 0.3153954
Updating learning rate to 0.00030628473147456737
Validation loss decreased (0.3154 --> 0.2993).  Saving model state dict ...
Epoch: 2 cost time: 0.9266688823699951
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2992562 Best vali loss: 0.2992562
Updating learning rate to 0.0002480775241850536
Validation loss decreased (0.2993 --> 0.2915).  Saving model state dict ...
Epoch: 3 cost time: 0.5639281272888184
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2915485 Best vali loss: 0.2915485

best validation loss 0.2915484819016788

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0073900411001, 'e_layers': 3, 'learning_rate': 7.32682191e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4691224
	speed: 0.0265s/iter; left time: 25.1146s
Updating learning rate to 7.047961355502127e-05
Validation loss decreased (inf --> 0.3398).  Saving model state dict ...
Epoch: 1 cost time: 2.731710910797119
Epoch: 1, Steps: 131 | Train Loss: 0.4691224 Vali Loss: 0.3397896 Best vali loss: 0.3397896
	iters: 100, epoch: 2 | loss: 0.5425014
	speed: 0.0263s/iter; left time: 21.5123s
Updating learning rate to 6.253833683553585e-05
Validation loss decreased (0.3398 --> 0.3248).  Saving model state dict ...
Epoch: 2 cost time: 2.018545389175415
Epoch: 2, Steps: 131 | Train Loss: 0.5425014 Vali Loss: 0.3247863 Best vali loss: 0.3247863
	iters: 100, epoch: 3 | loss: 0.5048193
	speed: 0.0257s/iter; left time: 17.6496s
Updating learning rate to 5.0653376334232716e-05
Validation loss decreased (0.3248 --> 0.3149).  Saving model state dict ...
Epoch: 3 cost time: 2.3702282905578613
Epoch: 3, Steps: 131 | Train Loss: 0.5048193 Vali Loss: 0.3149235 Best vali loss: 0.3149235

best validation loss 0.31492353086635144

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0014830216749, 'e_layers': 4, 'learning_rate': 0.0014975318537, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3775281
	speed: 0.0279s/iter; left time: 15.5356s
Updating learning rate to 0.00074876592685
Epoch: 4 cost time: 2.8001456260681152
Epoch: 4, Steps: 131 | Train Loss: 0.3775281 Vali Loss: 0.2883309 Best vali loss: 0.2798435
	iters: 100, epoch: 5 | loss: 0.4225043
	speed: 0.0289s/iter; left time: 12.2787s
Updating learning rate to 0.0004622256119250143
Epoch: 5 cost time: 2.455897092819214
Epoch: 5, Steps: 131 | Train Loss: 0.4225043 Vali Loss: 0.2951699 Best vali loss: 0.2798435
	iters: 100, epoch: 6 | loss: 0.2540811
	speed: 0.0230s/iter; left time: 6.7632s
Updating learning rate to 0.00021930846245293465
Epoch: 6 cost time: 1.7807252407073975
Epoch: 6, Steps: 131 | Train Loss: 0.2540811 Vali Loss: 0.3045164 Best vali loss: 0.2798435
	iters: 100, epoch: 7 | loss: 0.3026404
	speed: 0.0235s/iter; left time: 3.8363s
Updating learning rate to 5.699641239144168e-05
Epoch: 7 cost time: 1.897860050201416
Epoch: 7, Steps: 131 | Train Loss: 0.3026404 Vali Loss: 0.3112672 Best vali loss: 0.2798435
	iters: 100, epoch: 8 | loss: 0.3577742
	speed: 0.0289s/iter; left time: 0.9254s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.0110557079315186
Epoch: 8, Steps: 131 | Train Loss: 0.3577742 Vali Loss: 0.3145829 Best vali loss: 0.2798435

best validation loss 0.2798434910986139

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0087820926462, 'e_layers': 1, 'learning_rate': 8.44111982e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4279592
	speed: 0.0114s/iter; left time: 46.6782s
	iters: 200, epoch: 1 | loss: 0.3373882
	speed: 0.0056s/iter; left time: 22.3043s
	iters: 300, epoch: 1 | loss: 0.3184061
	speed: 0.0056s/iter; left time: 21.7060s
	iters: 400, epoch: 1 | loss: 0.2662749
	speed: 0.0060s/iter; left time: 22.8321s
	iters: 500, epoch: 1 | loss: 0.1584287
	speed: 0.0051s/iter; left time: 18.8989s
Updating learning rate to 8.119848826586678e-05
Validation loss decreased (inf --> 0.2789).  Saving model state dict ...
Epoch: 1 cost time: 3.194485664367676
Epoch: 1, Steps: 523 | Train Loss: 0.3016914 Vali Loss: 0.2789486 Best vali loss: 0.2789486
	iters: 100, epoch: 2 | loss: 0.2325879
	speed: 0.0141s/iter; left time: 50.3301s
	iters: 200, epoch: 2 | loss: 1.1685686
	speed: 0.0055s/iter; left time: 18.9176s
	iters: 300, epoch: 2 | loss: 0.6073276
	speed: 0.0050s/iter; left time: 16.8793s
	iters: 400, epoch: 2 | loss: 0.3917907
	speed: 0.0048s/iter; left time: 15.6134s
	iters: 500, epoch: 2 | loss: 0.3909912
	speed: 0.0053s/iter; left time: 16.7617s
Updating learning rate to 7.204946442765084e-05
Epoch: 2 cost time: 2.7208547592163086
Epoch: 2, Steps: 523 | Train Loss: 0.5582532 Vali Loss: 0.2830494 Best vali loss: 0.2789486
	iters: 100, epoch: 3 | loss: 0.3996499
	speed: 0.0121s/iter; left time: 36.6361s
	iters: 200, epoch: 3 | loss: 0.2622217
	speed: 0.0064s/iter; left time: 18.7909s
	iters: 300, epoch: 3 | loss: 0.2667636
	speed: 0.0051s/iter; left time: 14.4625s
	iters: 400, epoch: 3 | loss: 0.3331382
	speed: 0.0053s/iter; left time: 14.3992s
	iters: 500, epoch: 3 | loss: 0.2252127
	speed: 0.0052s/iter; left time: 13.6078s
Updating learning rate to 5.835698262861294e-05
Validation loss decreased (0.2789 --> 0.2783).  Saving model state dict ...
Epoch: 3 cost time: 2.8989648818969727
Epoch: 3, Steps: 523 | Train Loss: 0.2973972 Vali Loss: 0.2782540 Best vali loss: 0.2782540
	iters: 100, epoch: 4 | loss: 0.5360867
	speed: 0.0158s/iter; left time: 39.7009s
	iters: 200, epoch: 4 | loss: 0.2868977
	speed: 0.0047s/iter; left time: 11.3761s
	iters: 300, epoch: 4 | loss: 0.1801420
	speed: 0.0040s/iter; left time: 9.3682s
	iters: 400, epoch: 4 | loss: 0.6562278
	speed: 0.0043s/iter; left time: 9.5295s
	iters: 500, epoch: 4 | loss: 0.4045761
	speed: 0.0048s/iter; left time: 10.2376s
Updating learning rate to 4.22055991e-05
Validation loss decreased (0.2783 --> 0.2776).  Saving model state dict ...
Epoch: 4 cost time: 2.58498477935791
Epoch: 4, Steps: 523 | Train Loss: 0.4127860 Vali Loss: 0.2775576 Best vali loss: 0.2775576
	iters: 100, epoch: 5 | loss: 0.4254713
	speed: 0.0131s/iter; left time: 26.0620s
	iters: 200, epoch: 5 | loss: 0.4775746
	speed: 0.0046s/iter; left time: 8.7589s
	iters: 300, epoch: 5 | loss: 0.7017640
	speed: 0.0057s/iter; left time: 10.1869s
	iters: 400, epoch: 5 | loss: 0.7128300
	speed: 0.0061s/iter; left time: 10.3809s
	iters: 500, epoch: 5 | loss: 0.3126199
	speed: 0.0055s/iter; left time: 8.8321s
Updating learning rate to 2.6054215571387057e-05
Epoch: 5 cost time: 2.8858840465545654
Epoch: 5, Steps: 523 | Train Loss: 0.5260520 Vali Loss: 0.2789571 Best vali loss: 0.2775576
	iters: 100, epoch: 6 | loss: 0.3969635
	speed: 0.0167s/iter; left time: 24.5780s
	iters: 200, epoch: 6 | loss: 0.5225194
	speed: 0.0066s/iter; left time: 9.0085s
	iters: 300, epoch: 6 | loss: 0.3536098
	speed: 0.0057s/iter; left time: 7.2823s
	iters: 400, epoch: 6 | loss: 0.4580012
	speed: 0.0048s/iter; left time: 5.5674s
	iters: 500, epoch: 6 | loss: 0.3176512
	speed: 0.0040s/iter; left time: 4.2480s
Updating learning rate to 1.2361733772349155e-05
Epoch: 6 cost time: 2.875481605529785
Epoch: 6, Steps: 523 | Train Loss: 0.4097490 Vali Loss: 0.2777146 Best vali loss: 0.2775576
	iters: 100, epoch: 7 | loss: 1.0214232
	speed: 0.0126s/iter; left time: 11.9191s
	iters: 200, epoch: 7 | loss: 0.8245176
	speed: 0.0048s/iter; left time: 4.0403s
	iters: 300, epoch: 7 | loss: 0.8680803
	speed: 0.0046s/iter; left time: 3.4707s
	iters: 400, epoch: 7 | loss: 0.2078029
	speed: 0.0050s/iter; left time: 3.2586s
	iters: 500, epoch: 7 | loss: 0.7816814
	speed: 0.0050s/iter; left time: 2.7131s
Updating learning rate to 3.2127099341332154e-06
Epoch: 7 cost time: 2.5968966484069824
Epoch: 7, Steps: 523 | Train Loss: 0.7407011 Vali Loss: 0.2775888 Best vali loss: 0.2775576
	iters: 100, epoch: 8 | loss: 0.3269308
	speed: 0.0139s/iter; left time: 5.9086s
	iters: 200, epoch: 8 | loss: 0.2297642
	speed: 0.0053s/iter; left time: 1.7077s
	iters: 300, epoch: 8 | loss: 0.4643556
	speed: 0.0051s/iter; left time: 1.1429s
	iters: 400, epoch: 8 | loss: 0.4333277
	speed: 0.0050s/iter; left time: 0.6153s
	iters: 500, epoch: 8 | loss: 0.3436480
	speed: 0.0049s/iter; left time: 0.1166s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.708015203475952
Epoch: 8, Steps: 523 | Train Loss: 0.3596053 Vali Loss: 0.2778249 Best vali loss: 0.2775576

best validation loss 0.2775575597491704

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0008445079826, 'e_layers': 3, 'learning_rate': 0.0018400664811, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4851840
	speed: 0.0198s/iter; left time: 39.4886s
	iters: 200, epoch: 1 | loss: 0.3480698
	speed: 0.0119s/iter; left time: 22.5562s
Updating learning rate to 0.0017700331207241781
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 3.4502100944519043
Epoch: 1, Steps: 262 | Train Loss: 0.4166269 Vali Loss: 0.2855165 Best vali loss: 0.2855165
	iters: 100, epoch: 2 | loss: 0.4599251
	speed: 0.0271s/iter; left time: 47.0423s
	iters: 200, epoch: 2 | loss: 0.3888115
	speed: 0.0102s/iter; left time: 16.6556s
Updating learning rate to 0.0015705949838599389
Validation loss decreased (0.2855 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 2.696272373199463
Epoch: 2, Steps: 262 | Train Loss: 0.4243683 Vali Loss: 0.2827901 Best vali loss: 0.2827901
	iters: 100, epoch: 3 | loss: 0.4966952
	speed: 0.0242s/iter; left time: 35.6270s
	iters: 200, epoch: 3 | loss: 0.3294750
	speed: 0.0105s/iter; left time: 14.3952s
Updating learning rate to 0.0012721147189336502
Epoch: 3 cost time: 2.8858723640441895
Epoch: 3, Steps: 262 | Train Loss: 0.4130851 Vali Loss: 0.2970672 Best vali loss: 0.2827901
	iters: 100, epoch: 4 | loss: 0.2720311
	speed: 0.0245s/iter; left time: 29.7170s
	iters: 200, epoch: 4 | loss: 0.4799141
	speed: 0.0120s/iter; left time: 13.2947s
Updating learning rate to 0.00092003324055
Epoch: 4 cost time: 2.8731486797332764
Epoch: 4, Steps: 262 | Train Loss: 0.3759726 Vali Loss: 0.3048042 Best vali loss: 0.2827901
	iters: 100, epoch: 5 | loss: 0.3997911
	speed: 0.0206s/iter; left time: 19.5558s
	iters: 200, epoch: 5 | loss: 0.3656007
	speed: 0.0102s/iter; left time: 8.6970s
Updating learning rate to 0.0005679517621663497
Epoch: 5 cost time: 2.786236047744751
Epoch: 5, Steps: 262 | Train Loss: 0.3826959 Vali Loss: 0.3055145 Best vali loss: 0.2827901
	iters: 100, epoch: 6 | loss: 0.5278869
	speed: 0.0251s/iter; left time: 17.2703s
	iters: 200, epoch: 6 | loss: 0.4459287
	speed: 0.0106s/iter; left time: 6.2186s
Updating learning rate to 0.00026947149724006094
Epoch: 6 cost time: 2.911868095397949
Epoch: 6, Steps: 262 | Train Loss: 0.4869078 Vali Loss: 0.3034129 Best vali loss: 0.2827901
	iters: 100, epoch: 7 | loss: 0.3273709
	speed: 0.0262s/iter; left time: 11.1237s
	iters: 200, epoch: 7 | loss: 0.5104133
	speed: 0.0118s/iter; left time: 3.8401s
Updating learning rate to 7.003336037582178e-05
Epoch: 7 cost time: 2.770740509033203
Epoch: 7, Steps: 262 | Train Loss: 0.4188921 Vali Loss: 0.3028375 Best vali loss: 0.2827901
	iters: 100, epoch: 8 | loss: 0.6818090
	speed: 0.0351s/iter; left time: 5.7174s
	iters: 200, epoch: 8 | loss: 0.3833019
	speed: 0.0125s/iter; left time: 0.7846s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.3280506134033203
Epoch: 8, Steps: 262 | Train Loss: 0.5325555 Vali Loss: 0.2993542 Best vali loss: 0.2827901

best validation loss 0.28279009543971617

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0063474459393, 'e_layers': 4, 'learning_rate': 0.0023919052306, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6719419
	speed: 0.0219s/iter; left time: 20.8057s
Updating learning rate to 0.0023919052306
Validation loss decreased (inf --> 0.2936).  Saving model state dict ...
Epoch: 1 cost time: 2.2838962078094482
Epoch: 1, Steps: 131 | Train Loss: 0.6719419 Vali Loss: 0.2936318 Best vali loss: 0.2936318
	iters: 100, epoch: 2 | loss: 0.4274975
	speed: 0.0255s/iter; left time: 20.8680s
Updating learning rate to 0.0011959526153
Epoch: 2 cost time: 2.0696592330932617
Epoch: 2, Steps: 131 | Train Loss: 0.4274975 Vali Loss: 0.2971624 Best vali loss: 0.2936318
	iters: 100, epoch: 3 | loss: 0.4540596
	speed: 0.0258s/iter; left time: 17.7503s
Updating learning rate to 0.00059797630765
Epoch: 3 cost time: 1.9938321113586426
Epoch: 3, Steps: 131 | Train Loss: 0.4540596 Vali Loss: 0.3039005 Best vali loss: 0.2936318

best validation loss 0.2936318366334269

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0008881107545, 'e_layers': 2, 'learning_rate': 6.15204556e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.917897267980468e-05
Validation loss decreased (inf --> 0.2810).  Saving model state dict ...
Epoch: 1 cost time: 2.0144567489624023
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2810198 Best vali loss: 0.2810198
Updating learning rate to 5.251099346822295e-05
Validation loss decreased (0.2810 --> 0.2775).  Saving model state dict ...
Epoch: 2 cost time: 1.4198668003082275
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2775148 Best vali loss: 0.2775148
Updating learning rate to 4.2531657354836054e-05
Validation loss decreased (0.2775 --> 0.2772).  Saving model state dict ...
Epoch: 3 cost time: 0.9596385955810547
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2771697 Best vali loss: 0.2771697

best validation loss 0.2771696942519326

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.007778673072, 'e_layers': 1, 'learning_rate': 8.14814396e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5093062
	speed: 0.0118s/iter; left time: 48.4000s
	iters: 200, epoch: 1 | loss: 0.3324987
	speed: 0.0055s/iter; left time: 22.1086s
	iters: 300, epoch: 1 | loss: 0.2755831
	speed: 0.0045s/iter; left time: 17.6593s
	iters: 400, epoch: 1 | loss: 0.6716369
	speed: 0.0039s/iter; left time: 14.8608s
	iters: 500, epoch: 1 | loss: 0.6308343
	speed: 0.0042s/iter; left time: 15.5108s
Updating learning rate to 8.14814396e-05
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 2.792328357696533
Epoch: 1, Steps: 523 | Train Loss: 0.4839718 Vali Loss: 0.2819236 Best vali loss: 0.2819236
	iters: 100, epoch: 2 | loss: 0.3080004
	speed: 0.0129s/iter; left time: 46.0931s
	iters: 200, epoch: 2 | loss: 0.3513770
	speed: 0.0043s/iter; left time: 14.8448s
	iters: 300, epoch: 2 | loss: 1.1192222
	speed: 0.0054s/iter; left time: 18.3074s
	iters: 400, epoch: 2 | loss: 0.2931117
	speed: 0.0046s/iter; left time: 15.0286s
	iters: 500, epoch: 2 | loss: 0.2584879
	speed: 0.0045s/iter; left time: 14.3553s
Updating learning rate to 4.07407198e-05
Epoch: 2 cost time: 2.5335214138031006
Epoch: 2, Steps: 523 | Train Loss: 0.4660398 Vali Loss: 0.2834406 Best vali loss: 0.2819236
	iters: 100, epoch: 3 | loss: 0.3863496
	speed: 0.0116s/iter; left time: 35.1465s
	iters: 200, epoch: 3 | loss: 0.6314811
	speed: 0.0051s/iter; left time: 14.9639s
	iters: 300, epoch: 3 | loss: 0.5408144
	speed: 0.0050s/iter; left time: 14.1073s
	iters: 400, epoch: 3 | loss: 0.6321844
	speed: 0.0049s/iter; left time: 13.3776s
	iters: 500, epoch: 3 | loss: 0.5816976
	speed: 0.0046s/iter; left time: 12.0745s
Updating learning rate to 2.03703599e-05
Validation loss decreased (0.2819 --> 0.2804).  Saving model state dict ...
Epoch: 3 cost time: 2.5746397972106934
Epoch: 3, Steps: 523 | Train Loss: 0.5545054 Vali Loss: 0.2804381 Best vali loss: 0.2804381

best validation loss 0.2804380810673062

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0008881107545, 'e_layers': 2, 'learning_rate': 6.15204556e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.07602278e-05
Validation loss decreased (0.2772 --> 0.2771).  Saving model state dict ...
Epoch: 4 cost time: 1.417050838470459
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2771373 Best vali loss: 0.2771373
Updating learning rate to 1.8988798245163947e-05
Validation loss decreased (0.2771 --> 0.2768).  Saving model state dict ...
Epoch: 5 cost time: 1.1304380893707275
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2767935 Best vali loss: 0.2767935
Updating learning rate to 9.009462131777046e-06
Validation loss decreased (0.2768 --> 0.2767).  Saving model state dict ...
Epoch: 6 cost time: 1.0448176860809326
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2767475 Best vali loss: 0.2767475
Updating learning rate to 2.3414829201953138e-06
Epoch: 7 cost time: 1.0396921634674072
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2770881 Best vali loss: 0.2767475
Updating learning rate to 0.0
Validation loss decreased (0.2767 --> 0.2767).  Saving model state dict ...
Epoch: 8 cost time: 1.0125491619110107
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2767388 Best vali loss: 0.2767388

best validation loss 0.27673883398377613

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010628839995, 'e_layers': 3, 'learning_rate': 0.0028203906857, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6905252
	speed: 0.0177s/iter; left time: 35.3808s
	iters: 200, epoch: 1 | loss: 0.5408149
	speed: 0.0128s/iter; left time: 24.3493s
Updating learning rate to 0.0028203906857
Validation loss decreased (inf --> 0.2908).  Saving model state dict ...
Epoch: 1 cost time: 3.475050926208496
Epoch: 1, Steps: 262 | Train Loss: 0.6156701 Vali Loss: 0.2908375 Best vali loss: 0.2908375
	iters: 100, epoch: 2 | loss: 0.6048851
	speed: 0.0305s/iter; left time: 52.8569s
	iters: 200, epoch: 2 | loss: 0.5214204
	speed: 0.0103s/iter; left time: 16.8360s
Updating learning rate to 0.00141019534285
Validation loss decreased (0.2908 --> 0.2882).  Saving model state dict ...
Epoch: 2 cost time: 2.7093119621276855
Epoch: 2, Steps: 262 | Train Loss: 0.5631528 Vali Loss: 0.2881869 Best vali loss: 0.2881869
	iters: 100, epoch: 3 | loss: 0.3500724
	speed: 0.0219s/iter; left time: 32.2518s
	iters: 200, epoch: 3 | loss: 0.3571159
	speed: 0.0114s/iter; left time: 15.6131s
Updating learning rate to 0.000705097671425
Validation loss decreased (0.2882 --> 0.2857).  Saving model state dict ...
Epoch: 3 cost time: 2.670100688934326
Epoch: 3, Steps: 262 | Train Loss: 0.3535941 Vali Loss: 0.2856684 Best vali loss: 0.2856684
	iters: 100, epoch: 4 | loss: 0.3987565
	speed: 0.0282s/iter; left time: 34.1174s
	iters: 200, epoch: 4 | loss: 0.4294148
	speed: 0.0079s/iter; left time: 8.8273s
Updating learning rate to 0.0003525488357125
Epoch: 4 cost time: 2.407151937484741
Epoch: 4, Steps: 262 | Train Loss: 0.4140857 Vali Loss: 0.2949672 Best vali loss: 0.2856684
	iters: 100, epoch: 5 | loss: 0.5004131
	speed: 0.0199s/iter; left time: 18.8897s
	iters: 200, epoch: 5 | loss: 0.3371733
	speed: 0.0121s/iter; left time: 10.2624s
Updating learning rate to 0.00017627441785625
Epoch: 5 cost time: 2.8767929077148438
Epoch: 5, Steps: 262 | Train Loss: 0.4187932 Vali Loss: 0.2952258 Best vali loss: 0.2856684
	iters: 100, epoch: 6 | loss: 0.3644279
	speed: 0.0332s/iter; left time: 22.8129s
	iters: 200, epoch: 6 | loss: 0.5536730
	speed: 0.0116s/iter; left time: 6.8338s
Updating learning rate to 8.8137208928125e-05
Epoch: 6 cost time: 3.1340925693511963
Epoch: 6, Steps: 262 | Train Loss: 0.4590504 Vali Loss: 0.3034184 Best vali loss: 0.2856684
	iters: 100, epoch: 7 | loss: 0.3371093
	speed: 0.0325s/iter; left time: 13.8101s
	iters: 200, epoch: 7 | loss: 0.4505424
	speed: 0.0094s/iter; left time: 3.0650s
Updating learning rate to 4.40686044640625e-05
Epoch: 7 cost time: 2.4703831672668457
Epoch: 7, Steps: 262 | Train Loss: 0.3938259 Vali Loss: 0.2994203 Best vali loss: 0.2856684
	iters: 100, epoch: 8 | loss: 0.3528046
	speed: 0.0208s/iter; left time: 3.3853s
	iters: 200, epoch: 8 | loss: 0.4952680
	speed: 0.0112s/iter; left time: 0.7051s
Updating learning rate to 2.203430223203125e-05
Epoch: 8 cost time: 2.8607017993927
Epoch: 8, Steps: 262 | Train Loss: 0.4240363 Vali Loss: 0.2995678 Best vali loss: 0.2856684

best validation loss 0.28566841731265646

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012534952035, 'e_layers': 3, 'learning_rate': 0.0004733979271, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5341930
	speed: 0.0220s/iter; left time: 181.9024s
	iters: 200, epoch: 1 | loss: 0.2283828
	speed: 0.0122s/iter; left time: 99.8722s
	iters: 300, epoch: 1 | loss: 1.0000774
	speed: 0.0142s/iter; left time: 114.4947s
	iters: 400, epoch: 1 | loss: 0.7153559
	speed: 0.0125s/iter; left time: 99.3212s
	iters: 500, epoch: 1 | loss: 0.2812774
	speed: 0.0128s/iter; left time: 100.3368s
	iters: 600, epoch: 1 | loss: 0.2386608
	speed: 0.0126s/iter; left time: 97.6479s
	iters: 700, epoch: 1 | loss: 1.0784895
	speed: 0.0146s/iter; left time: 111.8147s
	iters: 800, epoch: 1 | loss: 0.6509444
	speed: 0.0133s/iter; left time: 100.4901s
	iters: 900, epoch: 1 | loss: 0.4055188
	speed: 0.0129s/iter; left time: 96.4538s
	iters: 1000, epoch: 1 | loss: 0.4369551
	speed: 0.0148s/iter; left time: 108.7177s
Updating learning rate to 0.0004733979271
Validation loss decreased (inf --> 0.2820).  Saving model state dict ...
Epoch: 1 cost time: 14.350298166275024
Epoch: 1, Steps: 1045 | Train Loss: 0.5569855 Vali Loss: 0.2819616 Best vali loss: 0.2819616
	iters: 100, epoch: 2 | loss: 0.5457544
	speed: 0.0312s/iter; left time: 224.9280s
	iters: 200, epoch: 2 | loss: 0.2190462
	speed: 0.0094s/iter; left time: 66.7122s
	iters: 300, epoch: 2 | loss: 1.2723613
	speed: 0.0069s/iter; left time: 48.1624s
	iters: 400, epoch: 2 | loss: 0.3628515
	speed: 0.0063s/iter; left time: 43.6039s
	iters: 500, epoch: 2 | loss: 0.3988940
	speed: 0.0073s/iter; left time: 49.9894s
	iters: 600, epoch: 2 | loss: 0.2587517
	speed: 0.0056s/iter; left time: 37.3881s
	iters: 700, epoch: 2 | loss: 0.5825346
	speed: 0.0080s/iter; left time: 52.7094s
	iters: 800, epoch: 2 | loss: 0.2570949
	speed: 0.0089s/iter; left time: 58.0944s
	iters: 900, epoch: 2 | loss: 0.1803918
	speed: 0.0092s/iter; left time: 58.9413s
	iters: 1000, epoch: 2 | loss: 0.3439612
	speed: 0.0078s/iter; left time: 49.2222s
Updating learning rate to 0.00023669896355
Epoch: 2 cost time: 8.442224025726318
Epoch: 2, Steps: 1045 | Train Loss: 0.4421641 Vali Loss: 0.2824959 Best vali loss: 0.2819616
	iters: 100, epoch: 3 | loss: 0.8266361
	speed: 0.0271s/iter; left time: 167.2709s
	iters: 200, epoch: 3 | loss: 0.2392516
	speed: 0.0086s/iter; left time: 52.3981s
	iters: 300, epoch: 3 | loss: 0.3781922
	speed: 0.0082s/iter; left time: 49.2288s
	iters: 400, epoch: 3 | loss: 0.3883213
	speed: 0.0076s/iter; left time: 44.6757s
	iters: 500, epoch: 3 | loss: 0.6353917
	speed: 0.0072s/iter; left time: 41.4613s
	iters: 600, epoch: 3 | loss: 1.1563370
	speed: 0.0087s/iter; left time: 49.2574s
	iters: 700, epoch: 3 | loss: 0.6963293
	speed: 0.0088s/iter; left time: 49.3017s
	iters: 800, epoch: 3 | loss: 1.0842600
	speed: 0.0086s/iter; left time: 46.7927s
	iters: 900, epoch: 3 | loss: 0.2600707
	speed: 0.0087s/iter; left time: 46.7327s
	iters: 1000, epoch: 3 | loss: 1.2121447
	speed: 0.0078s/iter; left time: 40.9997s
Updating learning rate to 0.000118349481775
Epoch: 3 cost time: 8.703076124191284
Epoch: 3, Steps: 1045 | Train Loss: 0.6876934 Vali Loss: 0.2856269 Best vali loss: 0.2819616
	iters: 100, epoch: 4 | loss: 0.4818628
	speed: 0.0255s/iter; left time: 130.5631s
	iters: 200, epoch: 4 | loss: 0.3187504
	speed: 0.0082s/iter; left time: 41.0716s
	iters: 300, epoch: 4 | loss: 0.8985000
	speed: 0.0075s/iter; left time: 37.1247s
	iters: 400, epoch: 4 | loss: 0.1687100
	speed: 0.0065s/iter; left time: 31.1744s
	iters: 500, epoch: 4 | loss: 0.8162248
	speed: 0.0070s/iter; left time: 32.8572s
	iters: 600, epoch: 4 | loss: 0.4547840
	speed: 0.0083s/iter; left time: 38.6109s
	iters: 700, epoch: 4 | loss: 0.1536597
	speed: 0.0082s/iter; left time: 37.3121s
	iters: 800, epoch: 4 | loss: 0.3820402
	speed: 0.0085s/iter; left time: 37.7587s
	iters: 900, epoch: 4 | loss: 0.2448808
	speed: 0.0083s/iter; left time: 36.1007s
	iters: 1000, epoch: 4 | loss: 0.3377962
	speed: 0.0079s/iter; left time: 33.4635s
Updating learning rate to 5.91747408875e-05
Epoch: 4 cost time: 8.292466640472412
Epoch: 4, Steps: 1045 | Train Loss: 0.4257209 Vali Loss: 0.2852328 Best vali loss: 0.2819616
	iters: 100, epoch: 5 | loss: 0.2204269
	speed: 0.0275s/iter; left time: 112.0319s
	iters: 200, epoch: 5 | loss: 0.5079498
	speed: 0.0075s/iter; left time: 30.0165s
	iters: 300, epoch: 5 | loss: 0.3080484
	speed: 0.0080s/iter; left time: 30.9172s
	iters: 400, epoch: 5 | loss: 0.3097695
	speed: 0.0072s/iter; left time: 27.2764s
	iters: 500, epoch: 5 | loss: 0.3822113
	speed: 0.0067s/iter; left time: 24.7082s
	iters: 600, epoch: 5 | loss: 0.1975424
	speed: 0.0082s/iter; left time: 29.3357s
	iters: 700, epoch: 5 | loss: 0.4073151
	speed: 0.0086s/iter; left time: 29.8520s
	iters: 800, epoch: 5 | loss: 1.0553030
	speed: 0.0091s/iter; left time: 30.6450s
	iters: 900, epoch: 5 | loss: 0.6883636
	speed: 0.0072s/iter; left time: 23.6871s
	iters: 1000, epoch: 5 | loss: 1.1753219
	speed: 0.0065s/iter; left time: 20.6125s
Updating learning rate to 2.958737044375e-05
Epoch: 5 cost time: 8.087003946304321
Epoch: 5, Steps: 1045 | Train Loss: 0.5252252 Vali Loss: 0.2888338 Best vali loss: 0.2819616
	iters: 100, epoch: 6 | loss: 0.8671972
	speed: 0.0252s/iter; left time: 76.5525s
	iters: 200, epoch: 6 | loss: 0.2501285
	speed: 0.0069s/iter; left time: 20.2943s
	iters: 300, epoch: 6 | loss: 0.5864334
	speed: 0.0060s/iter; left time: 17.0828s
	iters: 400, epoch: 6 | loss: 0.3064156
	speed: 0.0058s/iter; left time: 15.8232s
	iters: 500, epoch: 6 | loss: 0.2490294
	speed: 0.0067s/iter; left time: 17.6964s
	iters: 600, epoch: 6 | loss: 0.2100466
	speed: 0.0066s/iter; left time: 16.7773s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0018015263308, 'e_layers': 4, 'learning_rate': 0.0003828230838, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003828230838
Validation loss decreased (inf --> 0.3120).  Saving model state dict ...
Epoch: 1 cost time: 2.47933030128479
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3119727 Best vali loss: 0.3119727
Updating learning rate to 0.0001914115419
Validation loss decreased (0.3120 --> 0.2962).  Saving model state dict ...
Epoch: 2 cost time: 1.1704256534576416
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2961680 Best vali loss: 0.2961680
Updating learning rate to 9.570577095e-05
Validation loss decreased (0.2962 --> 0.2921).  Saving model state dict ...
Epoch: 3 cost time: 2.0538759231567383
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2921415 Best vali loss: 0.2921415

best validation loss 0.2921415354271013

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012227245979, 'e_layers': 4, 'learning_rate': 0.0010346098134, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6850891
	speed: 0.0172s/iter; left time: 70.4254s
	iters: 200, epoch: 1 | loss: 0.5389928
	speed: 0.0101s/iter; left time: 40.2946s
	iters: 300, epoch: 1 | loss: 0.3684803
	speed: 0.0097s/iter; left time: 37.5189s
	iters: 400, epoch: 1 | loss: 0.4635671
	speed: 0.0098s/iter; left time: 36.9892s
	iters: 500, epoch: 1 | loss: 0.8855157
	speed: 0.0098s/iter; left time: 35.9684s
Updating learning rate to 0.0009952323220677908
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 5.587915658950806
Epoch: 1, Steps: 523 | Train Loss: 0.5883290 Vali Loss: 0.2932162 Best vali loss: 0.2932162
	iters: 100, epoch: 2 | loss: 0.2735863
	speed: 0.0201s/iter; left time: 71.7647s
	iters: 200, epoch: 2 | loss: 0.3290336
	speed: 0.0084s/iter; left time: 28.9637s
	iters: 300, epoch: 2 | loss: 0.2006779
	speed: 0.0100s/iter; left time: 33.7197s
	iters: 400, epoch: 2 | loss: 0.3187794
	speed: 0.0102s/iter; left time: 33.3338s
	iters: 500, epoch: 2 | loss: 0.7866790
	speed: 0.0106s/iter; left time: 33.5348s
Updating learning rate to 0.0008830947141686443
Validation loss decreased (0.2932 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 5.197776794433594
Epoch: 2, Steps: 523 | Train Loss: 0.3817512 Vali Loss: 0.2850457 Best vali loss: 0.2850457
	iters: 100, epoch: 3 | loss: 0.3157713
	speed: 0.0180s/iter; left time: 54.8205s
	iters: 200, epoch: 3 | loss: 0.5652997
	speed: 0.0104s/iter; left time: 30.6874s
	iters: 300, epoch: 3 | loss: 0.2113753
	speed: 0.0114s/iter; left time: 32.3198s
	iters: 400, epoch: 3 | loss: 0.3830772
	speed: 0.0118s/iter; left time: 32.2255s
	iters: 500, epoch: 3 | loss: 0.5055745
	speed: 0.0119s/iter; left time: 31.3662s
Updating learning rate to 0.0007152689239752586
Epoch: 3 cost time: 5.47675895690918
Epoch: 3, Steps: 523 | Train Loss: 0.3962196 Vali Loss: 0.2926847 Best vali loss: 0.2850457

best validation loss 0.28504565799544407

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.006187137934, 'e_layers': 4, 'learning_rate': 0.0012464956852, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0012464956852
Validation loss decreased (inf --> 0.3087).  Saving model state dict ...
Epoch: 1 cost time: 2.276763677597046
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3086949 Best vali loss: 0.3086949
Updating learning rate to 0.0006232478426
Epoch: 2 cost time: 1.8386712074279785
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3099553 Best vali loss: 0.3086949
Updating learning rate to 0.0003116239213
Validation loss decreased (0.3087 --> 0.2910).  Saving model state dict ...
Epoch: 3 cost time: 1.7433457374572754
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2909781 Best vali loss: 0.2909781

best validation loss 0.29097813539353834

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012227245979, 'e_layers': 4, 'learning_rate': 0.0010346098134, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4032498
	speed: 0.0213s/iter; left time: 53.5681s
	iters: 200, epoch: 4 | loss: 0.5174236
	speed: 0.0100s/iter; left time: 24.1695s
	iters: 300, epoch: 4 | loss: 0.3155821
	speed: 0.0091s/iter; left time: 21.0238s
	iters: 400, epoch: 4 | loss: 0.4135716
	speed: 0.0099s/iter; left time: 22.0485s
	iters: 500, epoch: 4 | loss: 0.7410892
	speed: 0.0115s/iter; left time: 24.2367s
Updating learning rate to 0.0005173049067
Epoch: 4 cost time: 5.989687919616699
Epoch: 4, Steps: 523 | Train Loss: 0.4781833 Vali Loss: 0.3015259 Best vali loss: 0.2850457
	iters: 100, epoch: 5 | loss: 0.2719390
	speed: 0.0193s/iter; left time: 38.4478s
	iters: 200, epoch: 5 | loss: 0.2951659
	speed: 0.0106s/iter; left time: 19.9902s
	iters: 300, epoch: 5 | loss: 0.1897712
	speed: 0.0106s/iter; left time: 18.9338s
	iters: 400, epoch: 5 | loss: 0.2554357
	speed: 0.0096s/iter; left time: 16.1976s
	iters: 500, epoch: 5 | loss: 0.5448408
	speed: 0.0107s/iter; left time: 17.1225s
Updating learning rate to 0.00031934088942474153
Epoch: 5 cost time: 5.493732690811157
Epoch: 5, Steps: 523 | Train Loss: 0.3114305 Vali Loss: 0.2966361 Best vali loss: 0.2850457
	iters: 100, epoch: 6 | loss: 0.2441721
	speed: 0.0211s/iter; left time: 31.0714s
	iters: 200, epoch: 6 | loss: 0.4829068
	speed: 0.0099s/iter; left time: 13.6020s
	iters: 300, epoch: 6 | loss: 0.1770410
	speed: 0.0096s/iter; left time: 12.1625s
	iters: 400, epoch: 6 | loss: 0.3111297
	speed: 0.0069s/iter; left time: 8.0823s
	iters: 500, epoch: 6 | loss: 0.2698858
	speed: 0.0106s/iter; left time: 11.3306s
Updating learning rate to 0.00015151509923135576
Epoch: 6 cost time: 5.031749963760376
Epoch: 6, Steps: 523 | Train Loss: 0.2970271 Vali Loss: 0.3182771 Best vali loss: 0.2850457
	iters: 100, epoch: 7 | loss: 0.3864379
	speed: 0.0258s/iter; left time: 24.4154s
	iters: 200, epoch: 7 | loss: 0.3477006
	speed: 0.0106s/iter; left time: 8.9428s
	iters: 300, epoch: 7 | loss: 0.2180197
	speed: 0.0121s/iter; left time: 9.0481s
	iters: 400, epoch: 7 | loss: 0.4156770
	speed: 0.0114s/iter; left time: 7.3788s
	iters: 500, epoch: 7 | loss: 0.5835928
	speed: 0.0124s/iter; left time: 6.8079s
Updating learning rate to 3.93774913322092e-05
Epoch: 7 cost time: 6.251725435256958
Epoch: 7, Steps: 523 | Train Loss: 0.3902856 Vali Loss: 0.3189413 Best vali loss: 0.2850457
	iters: 100, epoch: 8 | loss: 0.2761130
	speed: 0.0210s/iter; left time: 8.9225s
	iters: 200, epoch: 8 | loss: 0.3569936
	speed: 0.0108s/iter; left time: 3.5002s
	iters: 300, epoch: 8 | loss: 0.4305311
	speed: 0.0116s/iter; left time: 2.5980s
	iters: 400, epoch: 8 | loss: 0.2537985
	speed: 0.0099s/iter; left time: 1.2266s
	iters: 500, epoch: 8 | loss: 0.3793520
	speed: 0.0112s/iter; left time: 0.2684s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.6677844524383545
Epoch: 8, Steps: 523 | Train Loss: 0.3393576 Vali Loss: 0.3201176 Best vali loss: 0.2850457

best validation loss 0.28504565799544407

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0016850189265, 'e_layers': 4, 'learning_rate': 0.0006374455458, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0201013
	speed: 0.0191s/iter; left time: 78.0477s
	iters: 200, epoch: 1 | loss: 0.4455082
	speed: 0.0117s/iter; left time: 46.8193s
	iters: 300, epoch: 1 | loss: 0.6505800
	speed: 0.0097s/iter; left time: 37.5232s
	iters: 400, epoch: 1 | loss: 0.2948049
	speed: 0.0116s/iter; left time: 43.8470s
	iters: 500, epoch: 1 | loss: 1.0135649
	speed: 0.0118s/iter; left time: 43.3109s
Updating learning rate to 0.000613184219327553
Validation loss decreased (inf --> 0.3083).  Saving model state dict ...
Epoch: 1 cost time: 6.3657519817352295
Epoch: 1, Steps: 523 | Train Loss: 0.6849119 Vali Loss: 0.3082574 Best vali loss: 0.3082574
	iters: 100, epoch: 2 | loss: 0.8857204
	speed: 0.0244s/iter; left time: 86.7765s
	iters: 200, epoch: 2 | loss: 0.5177528
	speed: 0.0115s/iter; left time: 39.7491s
	iters: 300, epoch: 2 | loss: 0.4816888
	speed: 0.0111s/iter; left time: 37.4847s
	iters: 400, epoch: 2 | loss: 0.3495750
	speed: 0.0112s/iter; left time: 36.6358s
	iters: 500, epoch: 2 | loss: 1.0360315
	speed: 0.0109s/iter; left time: 34.4605s
Updating learning rate to 0.00054409380693617
Epoch: 2 cost time: 5.97304105758667
Epoch: 2, Steps: 523 | Train Loss: 0.6541537 Vali Loss: 0.3298223 Best vali loss: 0.3082574
	iters: 100, epoch: 3 | loss: 0.6063010
	speed: 0.0239s/iter; left time: 72.7635s
	iters: 200, epoch: 3 | loss: 0.2547527
	speed: 0.0111s/iter; left time: 32.6899s
	iters: 300, epoch: 3 | loss: 0.5628391
	speed: 0.0117s/iter; left time: 33.1630s
	iters: 400, epoch: 3 | loss: 0.2857452
	speed: 0.0118s/iter; left time: 32.2665s
	iters: 500, epoch: 3 | loss: 0.2488373
	speed: 0.0118s/iter; left time: 31.2298s
Updating learning rate to 0.000440692697606291
Epoch: 3 cost time: 6.159939527511597
Epoch: 3, Steps: 523 | Train Loss: 0.3916951 Vali Loss: 0.3292616 Best vali loss: 0.3082574
	iters: 100, epoch: 4 | loss: 0.4977869
	speed: 0.0237s/iter; left time: 59.7007s
	iters: 200, epoch: 4 | loss: 0.2583086
	speed: 0.0112s/iter; left time: 26.9979s
	iters: 300, epoch: 4 | loss: 0.9148393
	speed: 0.0111s/iter; left time: 25.6179s
	iters: 400, epoch: 4 | loss: 0.3153579
	speed: 0.0099s/iter; left time: 21.9567s
	iters: 500, epoch: 4 | loss: 0.4800574
	speed: 0.0111s/iter; left time: 23.4511s
Updating learning rate to 0.0003187227729
Epoch: 4 cost time: 5.778625726699829
Epoch: 4, Steps: 523 | Train Loss: 0.4932700 Vali Loss: 0.3238830 Best vali loss: 0.3082574
	iters: 100, epoch: 5 | loss: 1.1116610
	speed: 0.0237s/iter; left time: 47.2220s
	iters: 200, epoch: 5 | loss: 0.2478179
	speed: 0.0116s/iter; left time: 21.9820s
	iters: 300, epoch: 5 | loss: 0.7878708
	speed: 0.0114s/iter; left time: 20.4301s
	iters: 400, epoch: 5 | loss: 1.6363015
	speed: 0.0115s/iter; left time: 19.5531s
	iters: 500, epoch: 5 | loss: 0.3762515
	speed: 0.0117s/iter; left time: 18.5950s
Updating learning rate to 0.000196752848193709
Epoch: 5 cost time: 6.053452730178833
Epoch: 5, Steps: 523 | Train Loss: 0.8319805 Vali Loss: 0.3206822 Best vali loss: 0.3082574
	iters: 100, epoch: 6 | loss: 0.5034167
	speed: 0.0235s/iter; left time: 34.5113s
	iters: 200, epoch: 6 | loss: 0.2176169
	speed: 0.0111s/iter; left time: 15.2262s
	iters: 300, epoch: 6 | loss: 0.2920068
	speed: 0.0096s/iter; left time: 12.2037s
	iters: 400, epoch: 6 | loss: 0.2984996
	speed: 0.0099s/iter; left time: 11.5798s
	iters: 500, epoch: 6 | loss: 0.9224754
	speed: 0.0122s/iter; left time: 13.0675s
Updating learning rate to 9.335173886383003e-05
Epoch: 6 cost time: 5.745041608810425
Epoch: 6, Steps: 523 | Train Loss: 0.4468031 Vali Loss: 0.3217766 Best vali loss: 0.3082574
	iters: 100, epoch: 7 | loss: 1.6125820
	speed: 0.0237s/iter; left time: 22.4459s
	iters: 200, epoch: 7 | loss: 0.2558978
	speed: 0.0152s/iter; left time: 12.9070s
	iters: 300, epoch: 7 | loss: 0.2145276
	speed: 0.0158s/iter; left time: 11.8121s
	iters: 400, epoch: 7 | loss: 1.0748985
	speed: 0.0158s/iter; left time: 10.2283s
	iters: 500, epoch: 7 | loss: 0.7603824
	speed: 0.0159s/iter; left time: 8.7129s
Updating learning rate to 2.4261326472446987e-05
Epoch: 7 cost time: 7.781497240066528
Epoch: 7, Steps: 523 | Train Loss: 0.7836577 Vali Loss: 0.3229127 Best vali loss: 0.3082574
	iters: 100, epoch: 8 | loss: 0.4745088
	speed: 0.0313s/iter; left time: 13.2742s
	iters: 200, epoch: 8 | loss: 0.6429268
	speed: 0.0132s/iter; left time: 4.2741s
	iters: 300, epoch: 8 | loss: 1.1967425
	speed: 0.0139s/iter; left time: 3.1066s
	iters: 400, epoch: 8 | loss: 0.2169611
	speed: 0.0145s/iter; left time: 1.7936s
	iters: 500, epoch: 8 | loss: 0.3885219
	speed: 0.0156s/iter; left time: 0.3751s
Updating learning rate to 0.0
Epoch: 8 cost time: 7.601903438568115
Epoch: 8, Steps: 523 | Train Loss: 0.5839322 Vali Loss: 0.3218745 Best vali loss: 0.3082574

best validation loss 0.3082573891694593

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0019391438008, 'e_layers': 3, 'learning_rate': 0.0004988908191, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4744625
	speed: 0.0162s/iter; left time: 32.2642s
	iters: 200, epoch: 1 | loss: 0.3530190
	speed: 0.0119s/iter; left time: 22.6523s
Updating learning rate to 0.0004988908191
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 3.2920947074890137
Epoch: 1, Steps: 262 | Train Loss: 0.4137408 Vali Loss: 0.2859030 Best vali loss: 0.2859030
	iters: 100, epoch: 2 | loss: 0.5194877
	speed: 0.0251s/iter; left time: 43.4843s
	iters: 200, epoch: 2 | loss: 0.3704250
	speed: 0.0112s/iter; left time: 18.3067s
Updating learning rate to 0.00024944540955
Validation loss decreased (0.2859 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 3.066030502319336
Epoch: 2, Steps: 262 | Train Loss: 0.4449563 Vali Loss: 0.2828290 Best vali loss: 0.2828290
	iters: 100, epoch: 3 | loss: 0.5300691
	speed: 0.0246s/iter; left time: 36.1917s
	iters: 200, epoch: 3 | loss: 0.3243610
	speed: 0.0087s/iter; left time: 11.9545s
Updating learning rate to 0.000124722704775
Epoch: 3 cost time: 2.463585615158081
Epoch: 3, Steps: 262 | Train Loss: 0.4272150 Vali Loss: 0.2883446 Best vali loss: 0.2828290
	iters: 100, epoch: 4 | loss: 0.3018705
	speed: 0.0189s/iter; left time: 22.8578s
	iters: 200, epoch: 4 | loss: 0.5238867
	speed: 0.0089s/iter; left time: 9.9324s
Updating learning rate to 6.23613523875e-05
Epoch: 4 cost time: 2.396620512008667
Epoch: 4, Steps: 262 | Train Loss: 0.4128786 Vali Loss: 0.2874308 Best vali loss: 0.2828290
	iters: 100, epoch: 5 | loss: 0.4151949
	speed: 0.0182s/iter; left time: 17.3160s
	iters: 200, epoch: 5 | loss: 0.3896724
	speed: 0.0062s/iter; left time: 5.2795s
Updating learning rate to 3.118067619375e-05
Epoch: 5 cost time: 1.9134624004364014
Epoch: 5, Steps: 262 | Train Loss: 0.4024336 Vali Loss: 0.2871316 Best vali loss: 0.2828290
	iters: 100, epoch: 6 | loss: 0.6193221
	speed: 0.0182s/iter; left time: 12.5332s
	iters: 200, epoch: 6 | loss: 0.5386091
	speed: 0.0082s/iter; left time: 4.8133s
Updating learning rate to 1.5590338096875e-05
Epoch: 6 cost time: 2.211030960083008
Epoch: 6, Steps: 262 | Train Loss: 0.5789656 Vali Loss: 0.2867855 Best vali loss: 0.2828290
	iters: 100, epoch: 7 | loss: 0.3393063
	speed: 0.0186s/iter; left time: 7.9042s
	iters: 200, epoch: 7 | loss: 0.5756812
	speed: 0.0085s/iter; left time: 2.7755s
Updating learning rate to 7.7951690484375e-06
Epoch: 7 cost time: 2.274362564086914
Epoch: 7, Steps: 262 | Train Loss: 0.4574938 Vali Loss: 0.2872023 Best vali loss: 0.2828290
	iters: 100, epoch: 8 | loss: 0.7494830
	speed: 0.0183s/iter; left time: 2.9807s
	iters: 200, epoch: 8 | loss: 0.4429733
	speed: 0.0082s/iter; left time: 0.5179s
Updating learning rate to 3.89758452421875e-06
Epoch: 8 cost time: 2.21787691116333
Epoch: 8, Steps: 262 | Train Loss: 0.5962282 Vali Loss: 0.2873154 Best vali loss: 0.2828290

best validation loss 0.28282899405930556

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0028083486401, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7432218
	speed: 0.0118s/iter; left time: 48.2463s
	iters: 200, epoch: 1 | loss: 0.9592007
	speed: 0.0049s/iter; left time: 19.5185s
	iters: 300, epoch: 1 | loss: 0.6637232
	speed: 0.0049s/iter; left time: 19.2017s
	iters: 400, epoch: 1 | loss: 0.3005028
	speed: 0.0049s/iter; left time: 18.4176s
	iters: 500, epoch: 1 | loss: 0.6163260
	speed: 0.0050s/iter; left time: 18.3355s
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 2.963188648223877
Epoch: 1, Steps: 523 | Train Loss: 0.6565949 Vali Loss: 0.2842928 Best vali loss: 0.2842928
	iters: 100, epoch: 2 | loss: 0.5374486
	speed: 0.0135s/iter; left time: 47.9532s
	iters: 200, epoch: 2 | loss: 0.4081049
	speed: 0.0044s/iter; left time: 15.2048s
	iters: 300, epoch: 2 | loss: 0.7287409
	speed: 0.0042s/iter; left time: 14.0976s
	iters: 400, epoch: 2 | loss: 0.2440156
	speed: 0.0042s/iter; left time: 13.6206s
	iters: 500, epoch: 2 | loss: 0.7514057
	speed: 0.0040s/iter; left time: 12.6801s
Updating learning rate to 0.0002152265254906771
Epoch: 2 cost time: 2.2986350059509277
Epoch: 2, Steps: 523 | Train Loss: 0.5339431 Vali Loss: 0.2843561 Best vali loss: 0.2842928
	iters: 100, epoch: 3 | loss: 0.4715499
	speed: 0.0085s/iter; left time: 25.9028s
	iters: 200, epoch: 3 | loss: 0.4602439
	speed: 0.0049s/iter; left time: 14.4249s
	iters: 300, epoch: 3 | loss: 0.2291047
	speed: 0.0058s/iter; left time: 16.5980s
	iters: 400, epoch: 3 | loss: 0.6996860
	speed: 0.0048s/iter; left time: 13.0222s
	iters: 500, epoch: 3 | loss: 0.3854297
	speed: 0.0046s/iter; left time: 12.2488s
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.2843 --> 0.2841).  Saving model state dict ...
Epoch: 3 cost time: 2.514827251434326
Epoch: 3, Steps: 523 | Train Loss: 0.4492028 Vali Loss: 0.2840967 Best vali loss: 0.2840967

best validation loss 0.28409669107998914

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0072973966877, 'e_layers': 1, 'learning_rate': 0.0005597310395, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4723181
	speed: 0.0161s/iter; left time: 32.1294s
	iters: 200, epoch: 1 | loss: 0.2849897
	speed: 0.0078s/iter; left time: 14.8830s
Updating learning rate to 0.0005384275453026582
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 2.5611279010772705
Epoch: 1, Steps: 262 | Train Loss: 0.3786539 Vali Loss: 0.2939963 Best vali loss: 0.2939963
	iters: 100, epoch: 2 | loss: 0.3893120
	speed: 0.0151s/iter; left time: 26.1727s
	iters: 200, epoch: 2 | loss: 0.6810095
	speed: 0.0064s/iter; left time: 10.4520s
Updating learning rate to 0.00047776032658552266
Validation loss decreased (0.2940 --> 0.2822).  Saving model state dict ...
Epoch: 2 cost time: 1.6832892894744873
Epoch: 2, Steps: 262 | Train Loss: 0.5351608 Vali Loss: 0.2821874 Best vali loss: 0.2821874
	iters: 100, epoch: 3 | loss: 0.2700810
	speed: 0.0150s/iter; left time: 22.1644s
	iters: 200, epoch: 3 | loss: 0.3059290
	speed: 0.0064s/iter; left time: 8.7976s
Updating learning rate to 0.0003869654174485698
Epoch: 3 cost time: 1.6460225582122803
Epoch: 3, Steps: 262 | Train Loss: 0.2880050 Vali Loss: 0.3164963 Best vali loss: 0.2821874

best validation loss 0.2821873540703627

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0009554640023, 'e_layers': 2, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.990837574005127
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2818758 Best vali loss: 0.2818758
Updating learning rate to 0.00021594413975
Validation loss decreased (0.2819 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 0.7366645336151123
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2772398 Best vali loss: 0.2772398
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.6296699047088623
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2872337 Best vali loss: 0.2772398

best validation loss 0.2772397596226966

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0009554640023, 'e_layers': 2, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.9718501567840576
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2911874 Best vali loss: 0.2772398
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.6689796447753906
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2885988 Best vali loss: 0.2772398
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.6379170417785645
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2870511 Best vali loss: 0.2772398
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.796520471572876
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2881066 Best vali loss: 0.2772398
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.6530699729919434
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2884310 Best vali loss: 0.2772398

best validation loss 0.2772397596226966

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0039456296644, 'e_layers': 2, 'learning_rate': 0.0021272879631, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3602346
	speed: 0.0125s/iter; left time: 51.1235s
	iters: 200, epoch: 1 | loss: 0.6333449
	speed: 0.0064s/iter; left time: 25.4473s
	iters: 300, epoch: 1 | loss: 1.1281703
	speed: 0.0071s/iter; left time: 27.7190s
	iters: 400, epoch: 1 | loss: 0.8422921
	speed: 0.0066s/iter; left time: 25.0336s
	iters: 500, epoch: 1 | loss: 0.9110745
	speed: 0.0070s/iter; left time: 25.7918s
Updating learning rate to 0.0021272879631
Validation loss decreased (inf --> 0.3165).  Saving model state dict ...
Epoch: 1 cost time: 3.807612895965576
Epoch: 1, Steps: 523 | Train Loss: 0.7750233 Vali Loss: 0.3164513 Best vali loss: 0.3164513
	iters: 100, epoch: 2 | loss: 0.3513979
	speed: 0.0156s/iter; left time: 55.7426s
	iters: 200, epoch: 2 | loss: 0.4843746
	speed: 0.0076s/iter; left time: 26.2532s
	iters: 300, epoch: 2 | loss: 0.7295477
	speed: 0.0069s/iter; left time: 23.1865s
	iters: 400, epoch: 2 | loss: 0.2017449
	speed: 0.0063s/iter; left time: 20.6720s
	iters: 500, epoch: 2 | loss: 0.6965216
	speed: 0.0069s/iter; left time: 21.7051s
Updating learning rate to 0.00106364398155
Epoch: 2 cost time: 3.56459379196167
Epoch: 2, Steps: 523 | Train Loss: 0.4927173 Vali Loss: 0.3262231 Best vali loss: 0.3164513
	iters: 100, epoch: 3 | loss: 0.5338546
	speed: 0.0147s/iter; left time: 44.6010s
	iters: 200, epoch: 3 | loss: 0.3303297
	speed: 0.0075s/iter; left time: 21.9185s
	iters: 300, epoch: 3 | loss: 0.6018301
	speed: 0.0075s/iter; left time: 21.2576s
	iters: 400, epoch: 3 | loss: 0.3631412
	speed: 0.0072s/iter; left time: 19.6876s
	iters: 500, epoch: 3 | loss: 0.7428944
	speed: 0.0072s/iter; left time: 19.0099s
Updating learning rate to 0.000531821990775
Epoch: 3 cost time: 3.7378437519073486
Epoch: 3, Steps: 523 | Train Loss: 0.5144100 Vali Loss: 0.3225938 Best vali loss: 0.3164513
	iters: 100, epoch: 4 | loss: 0.8479024
	speed: 0.0173s/iter; left time: 43.4423s
	iters: 200, epoch: 4 | loss: 0.4428505
	speed: 0.0073s/iter; left time: 17.5205s
	iters: 300, epoch: 4 | loss: 0.8573716
	speed: 0.0077s/iter; left time: 17.9479s
	iters: 400, epoch: 4 | loss: 0.6958711
	speed: 0.0069s/iter; left time: 15.1826s
	iters: 500, epoch: 4 | loss: 0.6996118
	speed: 0.0076s/iter; left time: 16.1805s
Updating learning rate to 0.0002659109953875
Epoch: 4 cost time: 3.883805751800537
Epoch: 4, Steps: 523 | Train Loss: 0.7087215 Vali Loss: 0.3215387 Best vali loss: 0.3164513
	iters: 100, epoch: 5 | loss: 0.7653347
	speed: 0.0128s/iter; left time: 25.5003s
	iters: 200, epoch: 5 | loss: 0.4187449
	speed: 0.0058s/iter; left time: 11.0553s
	iters: 300, epoch: 5 | loss: 0.5185096
	speed: 0.0059s/iter; left time: 10.6278s
	iters: 400, epoch: 5 | loss: 0.3924477
	speed: 0.0061s/iter; left time: 10.3269s
	iters: 500, epoch: 5 | loss: 0.4629836
	speed: 0.0081s/iter; left time: 12.9376s
Updating learning rate to 0.00013295549769375
Epoch: 5 cost time: 3.3610973358154297
Epoch: 5, Steps: 523 | Train Loss: 0.5116041 Vali Loss: 0.3212885 Best vali loss: 0.3164513
	iters: 100, epoch: 6 | loss: 0.7606245
	speed: 0.0216s/iter; left time: 31.7419s
	iters: 200, epoch: 6 | loss: 0.8582942
	speed: 0.0098s/iter; left time: 13.4084s
	iters: 300, epoch: 6 | loss: 0.4513797
	speed: 0.0082s/iter; left time: 10.4480s
	iters: 400, epoch: 6 | loss: 0.8916929
	speed: 0.0093s/iter; left time: 10.8284s
	iters: 500, epoch: 6 | loss: 0.8724151
	speed: 0.0075s/iter; left time: 8.0162s
Updating learning rate to 6.6477748846875e-05
Epoch: 6 cost time: 4.521727085113525
Epoch: 6, Steps: 523 | Train Loss: 0.7668813 Vali Loss: 0.3215972 Best vali loss: 0.3164513
	iters: 100, epoch: 7 | loss: 0.9519192
	speed: 0.0142s/iter; left time: 13.4306s
	iters: 200, epoch: 7 | loss: 0.3329573
	speed: 0.0071s/iter; left time: 6.0144s
	iters: 300, epoch: 7 | loss: 1.0200915
	speed: 0.0070s/iter; left time: 5.2515s
	iters: 400, epoch: 7 | loss: 0.4713669
	speed: 0.0069s/iter; left time: 4.4911s
	iters: 500, epoch: 7 | loss: 0.6675007
	speed: 0.0072s/iter; left time: 3.9502s
Updating learning rate to 3.32388744234375e-05
Epoch: 7 cost time: 3.741722345352173
Epoch: 7, Steps: 523 | Train Loss: 0.6887671 Vali Loss: 0.3215256 Best vali loss: 0.3164513
	iters: 100, epoch: 8 | loss: 0.3136965
	speed: 0.0167s/iter; left time: 7.0675s
	iters: 200, epoch: 8 | loss: 1.2419696
	speed: 0.0070s/iter; left time: 2.2799s
	iters: 300, epoch: 8 | loss: 0.4464239
	speed: 0.0072s/iter; left time: 1.6131s
	iters: 400, epoch: 8 | loss: 0.5137515
	speed: 0.0056s/iter; left time: 0.6981s
	iters: 500, epoch: 8 | loss: 1.1560512
	speed: 0.0057s/iter; left time: 0.1358s
Updating learning rate to 1.661943721171875e-05
Epoch: 8 cost time: 3.4631927013397217
Epoch: 8, Steps: 523 | Train Loss: 0.7343785 Vali Loss: 0.3214899 Best vali loss: 0.3164513

best validation loss 0.3164513239677886

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041648636572, 'e_layers': 3, 'learning_rate': 0.0001108380476, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6548907
	speed: 0.0172s/iter; left time: 16.3482s
Updating learning rate to 0.00010661952560057587
Validation loss decreased (inf --> 0.3129).  Saving model state dict ...
Epoch: 1 cost time: 1.63376784324646
Epoch: 1, Steps: 131 | Train Loss: 0.6548907 Vali Loss: 0.3128706 Best vali loss: 0.3128706
	iters: 100, epoch: 2 | loss: 0.5852758
	speed: 0.0157s/iter; left time: 12.8387s
Updating learning rate to 9.460619133571867e-05
Validation loss decreased (0.3129 --> 0.2960).  Saving model state dict ...
Epoch: 2 cost time: 1.2890005111694336
Epoch: 2, Steps: 131 | Train Loss: 0.5852758 Vali Loss: 0.2959937 Best vali loss: 0.2959937
	iters: 100, epoch: 3 | loss: 0.7045111
	speed: 0.0150s/iter; left time: 10.2777s
Updating learning rate to 7.66269660461066e-05
Validation loss decreased (0.2960 --> 0.2887).  Saving model state dict ...
Epoch: 3 cost time: 1.2521719932556152
Epoch: 3, Steps: 131 | Train Loss: 0.7045111 Vali Loss: 0.2886984 Best vali loss: 0.2886984
	iters: 100, epoch: 4 | loss: 0.4280593
	speed: 0.0169s/iter; left time: 9.4145s
Updating learning rate to 5.54190238e-05
Validation loss decreased (0.2887 --> 0.2852).  Saving model state dict ...
Epoch: 4 cost time: 1.4518697261810303
Epoch: 4, Steps: 131 | Train Loss: 0.4280593 Vali Loss: 0.2852023 Best vali loss: 0.2852023
	iters: 100, epoch: 5 | loss: 0.6473235
	speed: 0.0151s/iter; left time: 6.4001s
Updating learning rate to 3.42110815538934e-05
Validation loss decreased (0.2852 --> 0.2842).  Saving model state dict ...
Epoch: 5 cost time: 1.2626979351043701
Epoch: 5, Steps: 131 | Train Loss: 0.6473235 Vali Loss: 0.2841554 Best vali loss: 0.2841554
	iters: 100, epoch: 6 | loss: 0.8565741
	speed: 0.0154s/iter; left time: 4.5196s
Updating learning rate to 1.6231856264281333e-05
Validation loss decreased (0.2842 --> 0.2832).  Saving model state dict ...
Epoch: 6 cost time: 1.2670204639434814
Epoch: 6, Steps: 131 | Train Loss: 0.8565741 Vali Loss: 0.2832411 Best vali loss: 0.2832411
	iters: 100, epoch: 7 | loss: 0.5828121
	speed: 0.0153s/iter; left time: 2.4894s
Updating learning rate to 4.2185219994241266e-06
Validation loss decreased (0.2832 --> 0.2829).  Saving model state dict ...
Epoch: 7 cost time: 1.457094669342041
Epoch: 7, Steps: 131 | Train Loss: 0.5828121 Vali Loss: 0.2829270 Best vali loss: 0.2829270
	iters: 100, epoch: 8 | loss: 0.4764466
	speed: 0.0158s/iter; left time: 0.5052s
Updating learning rate to 0.0
Validation loss decreased (0.2829 --> 0.2829).  Saving model state dict ...
Epoch: 8 cost time: 0.9568967819213867
Epoch: 8, Steps: 131 | Train Loss: 0.4764466 Vali Loss: 0.2828546 Best vali loss: 0.2828546

best validation loss 0.28285458643514455

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0028077786904, 'e_layers': 1, 'learning_rate': 0.0002143791632, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5433575
	speed: 0.0096s/iter; left time: 79.4340s
	iters: 200, epoch: 1 | loss: 1.2781036
	speed: 0.0034s/iter; left time: 28.1207s
	iters: 300, epoch: 1 | loss: 0.2542672
	speed: 0.0035s/iter; left time: 28.2125s
	iters: 400, epoch: 1 | loss: 0.3556996
	speed: 0.0035s/iter; left time: 27.8126s
	iters: 500, epoch: 1 | loss: 0.9427057
	speed: 0.0042s/iter; left time: 32.6871s
	iters: 600, epoch: 1 | loss: 1.0453979
	speed: 0.0055s/iter; left time: 43.0731s
	iters: 700, epoch: 1 | loss: 0.3836075
	speed: 0.0047s/iter; left time: 36.0238s
	iters: 800, epoch: 1 | loss: 0.2070794
	speed: 0.0045s/iter; left time: 33.8554s
	iters: 900, epoch: 1 | loss: 2.0832155
	speed: 0.0059s/iter; left time: 44.3042s
	iters: 1000, epoch: 1 | loss: 0.4329417
	speed: 0.0053s/iter; left time: 39.0536s
Updating learning rate to 0.00020621984213868843
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 5.096080541610718
Epoch: 1, Steps: 1045 | Train Loss: 0.8526375 Vali Loss: 0.2823110 Best vali loss: 0.2823110
	iters: 100, epoch: 2 | loss: 0.4926496
	speed: 0.0199s/iter; left time: 143.3918s
	iters: 200, epoch: 2 | loss: 1.0076027
	speed: 0.0043s/iter; left time: 30.5816s
	iters: 300, epoch: 2 | loss: 0.6813239
	speed: 0.0045s/iter; left time: 31.2219s
	iters: 400, epoch: 2 | loss: 0.3359812
	speed: 0.0052s/iter; left time: 36.2986s
	iters: 500, epoch: 2 | loss: 0.5152423
	speed: 0.0047s/iter; left time: 31.7804s
	iters: 600, epoch: 2 | loss: 0.4982803
	speed: 0.0043s/iter; left time: 29.0379s
	iters: 700, epoch: 2 | loss: 0.2786889
	speed: 0.0044s/iter; left time: 29.2284s
	iters: 800, epoch: 2 | loss: 0.5285631
	speed: 0.0047s/iter; left time: 30.5899s
	iters: 900, epoch: 2 | loss: 0.4510914
	speed: 0.0042s/iter; left time: 27.0293s
	iters: 1000, epoch: 2 | loss: 0.3030165
	speed: 0.0038s/iter; left time: 24.0785s
Updating learning rate to 0.0001829840616219088
Validation loss decreased (0.2823 --> 0.2799).  Saving model state dict ...
Epoch: 2 cost time: 4.744449615478516
Epoch: 2, Steps: 1045 | Train Loss: 0.5092440 Vali Loss: 0.2799235 Best vali loss: 0.2799235
	iters: 100, epoch: 3 | loss: 0.9113279
	speed: 0.0204s/iter; left time: 126.0169s
	iters: 200, epoch: 3 | loss: 0.3926420
	speed: 0.0044s/iter; left time: 26.9666s
	iters: 300, epoch: 3 | loss: 0.2958511
	speed: 0.0038s/iter; left time: 22.9637s
	iters: 400, epoch: 3 | loss: 0.1701921
	speed: 0.0038s/iter; left time: 22.3336s
	iters: 500, epoch: 3 | loss: 0.2844599
	speed: 0.0040s/iter; left time: 23.1826s
	iters: 600, epoch: 3 | loss: 0.5483821
	speed: 0.0076s/iter; left time: 43.2791s
	iters: 700, epoch: 3 | loss: 0.3525392
	speed: 0.0071s/iter; left time: 39.7022s
	iters: 800, epoch: 3 | loss: 0.3746673
	speed: 0.0062s/iter; left time: 33.9988s
	iters: 900, epoch: 3 | loss: 0.3373436
	speed: 0.0080s/iter; left time: 42.8513s
	iters: 1000, epoch: 3 | loss: 0.7393043
	speed: 0.0065s/iter; left time: 34.4250s
Updating learning rate to 0.0001482092586004659
Epoch: 3 cost time: 6.109211683273315
Epoch: 3, Steps: 1045 | Train Loss: 0.4406710 Vali Loss: 0.2882851 Best vali loss: 0.2799235

best validation loss 0.2799235402141286

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0105600933459, 'e_layers': 4, 'learning_rate': 0.003358113273, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0885165
	speed: 0.0157s/iter; left time: 64.2157s
	iters: 200, epoch: 1 | loss: 0.7836607
	speed: 0.0136s/iter; left time: 54.1230s
	iters: 300, epoch: 1 | loss: 0.3461799
	speed: 0.0141s/iter; left time: 54.8454s
	iters: 400, epoch: 1 | loss: 0.3626247
	speed: 0.0137s/iter; left time: 51.9143s
	iters: 500, epoch: 1 | loss: 0.7114183
	speed: 0.0158s/iter; left time: 58.1346s
Updating learning rate to 0.0032303026968895933
Validation loss decreased (inf --> 0.3347).  Saving model state dict ...
Epoch: 1 cost time: 7.301910161972046
Epoch: 1, Steps: 523 | Train Loss: 0.6584800 Vali Loss: 0.3347123 Best vali loss: 0.3347123
	iters: 100, epoch: 2 | loss: 0.5699420
	speed: 0.0273s/iter; left time: 97.1576s
	iters: 200, epoch: 2 | loss: 0.2468291
	speed: 0.0082s/iter; left time: 28.3650s
	iters: 300, epoch: 2 | loss: 0.7950135
	speed: 0.0092s/iter; left time: 31.0663s
	iters: 400, epoch: 2 | loss: 0.8851582
	speed: 0.0094s/iter; left time: 30.7676s
	iters: 500, epoch: 2 | loss: 0.6172059
	speed: 0.0111s/iter; left time: 35.2191s
Updating learning rate to 0.002866328970165426
Validation loss decreased (0.3347 --> 0.3231).  Saving model state dict ...
Epoch: 2 cost time: 5.321161270141602
Epoch: 2, Steps: 523 | Train Loss: 0.6228298 Vali Loss: 0.3231405 Best vali loss: 0.3231405
	iters: 100, epoch: 3 | loss: 0.6939774
	speed: 0.0220s/iter; left time: 66.9128s
	iters: 200, epoch: 3 | loss: 0.6447210
	speed: 0.0092s/iter; left time: 27.0436s
	iters: 300, epoch: 3 | loss: 0.4258036
	speed: 0.0114s/iter; left time: 32.3959s
	iters: 400, epoch: 3 | loss: 0.7465077
	speed: 0.0117s/iter; left time: 32.1632s
	iters: 500, epoch: 3 | loss: 0.7620351
	speed: 0.0117s/iter; left time: 30.9767s
Updating learning rate to 0.002321603793291203
Validation loss decreased (0.3231 --> 0.3217).  Saving model state dict ...
Epoch: 3 cost time: 5.70950722694397
Epoch: 3, Steps: 523 | Train Loss: 0.6546090 Vali Loss: 0.3216722 Best vali loss: 0.3216722

best validation loss 0.32167217380364793

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083191729422, 'e_layers': 3, 'learning_rate': 0.0002637057251, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3642008
	speed: 0.0127s/iter; left time: 51.8036s
	iters: 200, epoch: 1 | loss: 0.6939314
	speed: 0.0079s/iter; left time: 31.5495s
	iters: 300, epoch: 1 | loss: 1.5763732
	speed: 0.0077s/iter; left time: 29.7907s
	iters: 400, epoch: 1 | loss: 0.4414251
	speed: 0.0077s/iter; left time: 29.2156s
	iters: 500, epoch: 1 | loss: 0.9573166
	speed: 0.0078s/iter; left time: 28.7115s
Updating learning rate to 0.00025366902356296895
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 4.269473314285278
Epoch: 1, Steps: 523 | Train Loss: 0.8066494 Vali Loss: 0.2884278 Best vali loss: 0.2884278
	iters: 100, epoch: 2 | loss: 0.2783554
	speed: 0.0168s/iter; left time: 59.8408s
	iters: 200, epoch: 2 | loss: 0.4622431
	speed: 0.0083s/iter; left time: 28.8723s
	iters: 300, epoch: 2 | loss: 0.3891324
	speed: 0.0074s/iter; left time: 24.9555s
	iters: 400, epoch: 2 | loss: 0.5505494
	speed: 0.0062s/iter; left time: 20.2412s
	iters: 500, epoch: 2 | loss: 0.7946596
	speed: 0.0075s/iter; left time: 23.6829s
Updating learning rate to 0.00022508691577796276
Validation loss decreased (0.2884 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 3.9685025215148926
Epoch: 2, Steps: 523 | Train Loss: 0.4949880 Vali Loss: 0.2843013 Best vali loss: 0.2843013
	iters: 100, epoch: 3 | loss: 1.3109548
	speed: 0.0170s/iter; left time: 51.5567s
	iters: 200, epoch: 3 | loss: 0.5785300
	speed: 0.0079s/iter; left time: 23.0818s
	iters: 300, epoch: 3 | loss: 0.8106720
	speed: 0.0079s/iter; left time: 22.4130s
	iters: 400, epoch: 3 | loss: 1.2954222
	speed: 0.0074s/iter; left time: 20.3857s
	iters: 500, epoch: 3 | loss: 0.3233831
	speed: 0.0072s/iter; left time: 19.1164s
Updating learning rate to 0.0001823107685577964
Epoch: 3 cost time: 4.012681722640991
Epoch: 3, Steps: 523 | Train Loss: 0.8637924 Vali Loss: 0.2903523 Best vali loss: 0.2843013

best validation loss 0.2843013339079903

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0028077786904, 'e_layers': 1, 'learning_rate': 0.0002143791632, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9087423
	speed: 0.0117s/iter; left time: 60.1293s
	iters: 200, epoch: 4 | loss: 1.2018055
	speed: 0.0052s/iter; left time: 25.9901s
	iters: 300, epoch: 4 | loss: 0.2050601
	speed: 0.0042s/iter; left time: 20.8654s
	iters: 400, epoch: 4 | loss: 0.3083117
	speed: 0.0048s/iter; left time: 23.1800s
	iters: 500, epoch: 4 | loss: 0.6235574
	speed: 0.0048s/iter; left time: 22.6457s
	iters: 600, epoch: 4 | loss: 0.3779546
	speed: 0.0045s/iter; left time: 20.6494s
	iters: 700, epoch: 4 | loss: 0.3077438
	speed: 0.0039s/iter; left time: 17.5952s
	iters: 800, epoch: 4 | loss: 0.2021978
	speed: 0.0034s/iter; left time: 14.9720s
	iters: 900, epoch: 4 | loss: 1.4939303
	speed: 0.0039s/iter; left time: 16.7697s
	iters: 1000, epoch: 4 | loss: 0.4274384
	speed: 0.0044s/iter; left time: 18.8036s
Updating learning rate to 0.0001071895816
Epoch: 4 cost time: 5.027182102203369
Epoch: 4, Steps: 1045 | Train Loss: 0.6056742 Vali Loss: 0.2931498 Best vali loss: 0.2799235
	iters: 100, epoch: 5 | loss: 0.4800600
	speed: 0.0221s/iter; left time: 90.0066s
	iters: 200, epoch: 5 | loss: 0.8081567
	speed: 0.0048s/iter; left time: 19.0722s
	iters: 300, epoch: 5 | loss: 0.5311655
	speed: 0.0043s/iter; left time: 16.7030s
	iters: 400, epoch: 5 | loss: 0.2864064
	speed: 0.0039s/iter; left time: 14.7241s
	iters: 500, epoch: 5 | loss: 0.5243000
	speed: 0.0044s/iter; left time: 16.1320s
	iters: 600, epoch: 5 | loss: 0.4965540
	speed: 0.0048s/iter; left time: 17.2155s
	iters: 700, epoch: 5 | loss: 0.2791030
	speed: 0.0049s/iter; left time: 17.1401s
	iters: 800, epoch: 5 | loss: 0.4711493
	speed: 0.0052s/iter; left time: 17.6502s
	iters: 900, epoch: 5 | loss: 0.4346734
	speed: 0.0052s/iter; left time: 17.1382s
	iters: 1000, epoch: 5 | loss: 0.3230792
	speed: 0.0052s/iter; left time: 16.5649s
Updating learning rate to 6.616990459953414e-05
Epoch: 5 cost time: 5.044350624084473
Epoch: 5, Steps: 1045 | Train Loss: 0.4634647 Vali Loss: 0.2954768 Best vali loss: 0.2799235
	iters: 100, epoch: 6 | loss: 0.7823907
	speed: 0.0217s/iter; left time: 65.8530s
	iters: 200, epoch: 6 | loss: 0.3587589
	speed: 0.0041s/iter; left time: 12.0435s
	iters: 300, epoch: 6 | loss: 0.2878136
	speed: 0.0040s/iter; left time: 11.4066s
	iters: 400, epoch: 6 | loss: 0.1851901
	speed: 0.0053s/iter; left time: 14.4444s
	iters: 500, epoch: 6 | loss: 0.2729820
	speed: 0.0053s/iter; left time: 14.0723s
	iters: 600, epoch: 6 | loss: 0.4247743
	speed: 0.0054s/iter; left time: 13.6100s
	iters: 700, epoch: 6 | loss: 0.3586920
	speed: 0.0054s/iter; left time: 13.1228s
	iters: 800, epoch: 6 | loss: 0.3739959
	speed: 0.0053s/iter; left time: 12.4414s
	iters: 900, epoch: 6 | loss: 0.3201770
	speed: 0.0054s/iter; left time: 12.0231s
	iters: 1000, epoch: 6 | loss: 0.7345205
	speed: 0.0053s/iter; left time: 11.2954s
Updating learning rate to 3.139510157809123e-05
Epoch: 6 cost time: 5.305908918380737
Epoch: 6, Steps: 1045 | Train Loss: 0.4099295 Vali Loss: 0.2986360 Best vali loss: 0.2799235
	iters: 100, epoch: 7 | loss: 0.2776949
	speed: 0.0205s/iter; left time: 40.8436s
	iters: 200, epoch: 7 | loss: 0.4041654
	speed: 0.0053s/iter; left time: 10.0231s
	iters: 300, epoch: 7 | loss: 0.2157691
	speed: 0.0052s/iter; left time: 9.3309s
	iters: 400, epoch: 7 | loss: 0.3083248
	speed: 0.0053s/iter; left time: 8.9589s
	iters: 500, epoch: 7 | loss: 0.2721269
	speed: 0.0053s/iter; left time: 8.4268s
	iters: 600, epoch: 7 | loss: 0.4971204
	speed: 0.0052s/iter; left time: 7.7270s
	iters: 700, epoch: 7 | loss: 0.4816227
	speed: 0.0050s/iter; left time: 6.9592s
	iters: 800, epoch: 7 | loss: 0.7310957
	speed: 0.0049s/iter; left time: 6.3710s
	iters: 900, epoch: 7 | loss: 0.2277130
	speed: 0.0044s/iter; left time: 5.1963s
	iters: 1000, epoch: 7 | loss: 0.3673083
	speed: 0.0045s/iter; left time: 4.8783s
Updating learning rate to 8.159321061311578e-06
Epoch: 7 cost time: 5.259532928466797
Epoch: 7, Steps: 1045 | Train Loss: 0.3782941 Vali Loss: 0.2962619 Best vali loss: 0.2799235
	iters: 100, epoch: 8 | loss: 0.4930023
	speed: 0.0194s/iter; left time: 18.3862s
	iters: 200, epoch: 8 | loss: 1.0311456
	speed: 0.0044s/iter; left time: 3.7289s
	iters: 300, epoch: 8 | loss: 0.4725730
	speed: 0.0051s/iter; left time: 3.8330s
	iters: 400, epoch: 8 | loss: 0.4791506
	speed: 0.0053s/iter; left time: 3.4400s
	iters: 500, epoch: 8 | loss: 0.2553284
	speed: 0.0049s/iter; left time: 2.6796s
	iters: 600, epoch: 8 | loss: 0.2072715
	speed: 0.0048s/iter; left time: 2.1498s
	iters: 700, epoch: 8 | loss: 0.3381065
	speed: 0.0054s/iter; left time: 1.8653s
	iters: 800, epoch: 8 | loss: 0.4075278
	speed: 0.0053s/iter; left time: 1.3049s
	iters: 900, epoch: 8 | loss: 0.5833152
	speed: 0.0052s/iter; left time: 0.7541s
	iters: 1000, epoch: 8 | loss: 0.7308962
	speed: 0.0052s/iter; left time: 0.2386s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.264936923980713
Epoch: 8, Steps: 1045 | Train Loss: 0.4998317 Vali Loss: 0.2976007 Best vali loss: 0.2799235

best validation loss 0.2799235402141286

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0040279688012, 'e_layers': 1, 'learning_rate': 0.0001305230732, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5811598
	speed: 0.0126s/iter; left time: 11.9751s
Updating learning rate to 0.0001305230732
Validation loss decreased (inf --> 0.3315).  Saving model state dict ...
Epoch: 1 cost time: 1.1481621265411377
Epoch: 1, Steps: 131 | Train Loss: 0.5811598 Vali Loss: 0.3315069 Best vali loss: 0.3315069
	iters: 100, epoch: 2 | loss: 0.5612938
	speed: 0.0111s/iter; left time: 9.0522s
Updating learning rate to 6.52615366e-05
Validation loss decreased (0.3315 --> 0.3122).  Saving model state dict ...
Epoch: 2 cost time: 0.8813676834106445
Epoch: 2, Steps: 131 | Train Loss: 0.5612938 Vali Loss: 0.3121635 Best vali loss: 0.3121635
	iters: 100, epoch: 3 | loss: 0.4351666
	speed: 0.0110s/iter; left time: 7.5860s
Updating learning rate to 3.26307683e-05
Validation loss decreased (0.3122 --> 0.3056).  Saving model state dict ...
Epoch: 3 cost time: 0.854057788848877
Epoch: 3, Steps: 131 | Train Loss: 0.4351666 Vali Loss: 0.3056284 Best vali loss: 0.3056284
	iters: 100, epoch: 4 | loss: 0.4585766
	speed: 0.0104s/iter; left time: 5.7732s
Updating learning rate to 1.631538415e-05
Validation loss decreased (0.3056 --> 0.3031).  Saving model state dict ...
Epoch: 4 cost time: 0.8053297996520996
Epoch: 4, Steps: 131 | Train Loss: 0.4585766 Vali Loss: 0.3030542 Best vali loss: 0.3030542
	iters: 100, epoch: 5 | loss: 0.6827446
	speed: 0.0114s/iter; left time: 4.8646s
Updating learning rate to 8.157692075e-06
Validation loss decreased (0.3031 --> 0.3018).  Saving model state dict ...
Epoch: 5 cost time: 0.8984513282775879
Epoch: 5, Steps: 131 | Train Loss: 0.6827446 Vali Loss: 0.3018096 Best vali loss: 0.3018096
	iters: 100, epoch: 6 | loss: 0.6625425
	speed: 0.0131s/iter; left time: 3.8546s
Updating learning rate to 4.0788460375e-06
Validation loss decreased (0.3018 --> 0.3012).  Saving model state dict ...
Epoch: 6 cost time: 1.092937707901001
Epoch: 6, Steps: 131 | Train Loss: 0.6625425 Vali Loss: 0.3012185 Best vali loss: 0.3012185
	iters: 100, epoch: 7 | loss: 0.5666629
	speed: 0.0103s/iter; left time: 1.6711s
Updating learning rate to 2.03942301875e-06
Validation loss decreased (0.3012 --> 0.3009).  Saving model state dict ...
Epoch: 7 cost time: 0.7912275791168213
Epoch: 7, Steps: 131 | Train Loss: 0.5666629 Vali Loss: 0.3009122 Best vali loss: 0.3009122
	iters: 100, epoch: 8 | loss: 1.0836031
	speed: 0.0108s/iter; left time: 0.3454s
Updating learning rate to 1.019711509375e-06
Validation loss decreased (0.3009 --> 0.3008).  Saving model state dict ...
Epoch: 8 cost time: 0.8258926868438721
Epoch: 8, Steps: 131 | Train Loss: 1.0836031 Vali Loss: 0.3007696 Best vali loss: 0.3007696

best validation loss 0.30076962246155375

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0019750197317, 'e_layers': 1, 'learning_rate': 0.0001556126388, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5798400
	speed: 0.0129s/iter; left time: 12.2852s
Updating learning rate to 0.0001556126388
Validation loss decreased (inf --> 0.2943).  Saving model state dict ...
Epoch: 1 cost time: 1.2271087169647217
Epoch: 1, Steps: 131 | Train Loss: 0.5798400 Vali Loss: 0.2943338 Best vali loss: 0.2943338
	iters: 100, epoch: 2 | loss: 0.4492114
	speed: 0.0145s/iter; left time: 11.8898s
Updating learning rate to 7.78063194e-05
Validation loss decreased (0.2943 --> 0.2820).  Saving model state dict ...
Epoch: 2 cost time: 1.068678379058838
Epoch: 2, Steps: 131 | Train Loss: 0.4492114 Vali Loss: 0.2819625 Best vali loss: 0.2819625
	iters: 100, epoch: 3 | loss: 0.5923045
	speed: 0.0069s/iter; left time: 4.7340s
Updating learning rate to 3.89031597e-05
Validation loss decreased (0.2820 --> 0.2807).  Saving model state dict ...
Epoch: 3 cost time: 0.5159707069396973
Epoch: 3, Steps: 131 | Train Loss: 0.5923045 Vali Loss: 0.2806500 Best vali loss: 0.2806500
	iters: 100, epoch: 4 | loss: 0.5345321
	speed: 0.0114s/iter; left time: 6.3500s
Updating learning rate to 1.945157985e-05
Epoch: 4 cost time: 1.1207282543182373
Epoch: 4, Steps: 131 | Train Loss: 0.5345321 Vali Loss: 0.2806573 Best vali loss: 0.2806500
	iters: 100, epoch: 5 | loss: 0.3588569
	speed: 0.0149s/iter; left time: 6.3136s
Updating learning rate to 9.725789925e-06
Validation loss decreased (0.2807 --> 0.2805).  Saving model state dict ...
Epoch: 5 cost time: 1.1431677341461182
Epoch: 5, Steps: 131 | Train Loss: 0.3588569 Vali Loss: 0.2804727 Best vali loss: 0.2804727
	iters: 100, epoch: 6 | loss: 0.5782706
	speed: 0.0137s/iter; left time: 4.0220s
Updating learning rate to 4.8628949625e-06
Validation loss decreased (0.2805 --> 0.2804).  Saving model state dict ...
Epoch: 6 cost time: 1.0306684970855713
Epoch: 6, Steps: 131 | Train Loss: 0.5782706 Vali Loss: 0.2804226 Best vali loss: 0.2804226
	iters: 100, epoch: 7 | loss: 0.6202203
	speed: 0.0143s/iter; left time: 2.3298s
Updating learning rate to 2.43144748125e-06
Validation loss decreased (0.2804 --> 0.2804).  Saving model state dict ...
Epoch: 7 cost time: 1.1524949073791504
Epoch: 7, Steps: 131 | Train Loss: 0.6202203 Vali Loss: 0.2803780 Best vali loss: 0.2803780
	iters: 100, epoch: 8 | loss: 0.3711982
	speed: 0.0140s/iter; left time: 0.4493s
Updating learning rate to 1.215723740625e-06
Validation loss decreased (0.2804 --> 0.2804).  Saving model state dict ...
Epoch: 8 cost time: 1.0394818782806396
Epoch: 8, Steps: 131 | Train Loss: 0.3711982 Vali Loss: 0.2803713 Best vali loss: 0.2803713

best validation loss 0.28037127140630974

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0097140297665, 'e_layers': 3, 'learning_rate': 0.0029168401753, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9393585
	speed: 0.0201s/iter; left time: 40.0554s
	iters: 200, epoch: 1 | loss: 0.6268100
	speed: 0.0128s/iter; left time: 24.2858s
Updating learning rate to 0.0029168401753
Validation loss decreased (inf --> 0.3369).  Saving model state dict ...
Epoch: 1 cost time: 3.8376364707946777
Epoch: 1, Steps: 262 | Train Loss: 0.7830842 Vali Loss: 0.3368529 Best vali loss: 0.3368529
	iters: 100, epoch: 2 | loss: 0.7564598
	speed: 0.0290s/iter; left time: 50.3876s
	iters: 200, epoch: 2 | loss: 0.4498794
	speed: 0.0116s/iter; left time: 19.0411s
Updating learning rate to 0.00145842008765
Validation loss decreased (0.3369 --> 0.3215).  Saving model state dict ...
Epoch: 2 cost time: 3.376004934310913
Epoch: 2, Steps: 262 | Train Loss: 0.6031696 Vali Loss: 0.3214928 Best vali loss: 0.3214928
	iters: 100, epoch: 3 | loss: 0.6778777
	speed: 0.0335s/iter; left time: 49.3138s
	iters: 200, epoch: 3 | loss: 0.7033575
	speed: 0.0145s/iter; left time: 19.9685s
Updating learning rate to 0.000729210043825
Epoch: 3 cost time: 4.316235780715942
Epoch: 3, Steps: 262 | Train Loss: 0.6906176 Vali Loss: 0.3236001 Best vali loss: 0.3214928

best validation loss 0.32149279843524026

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043376323922, 'e_layers': 3, 'learning_rate': 0.0024929522924, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5140128
	speed: 0.0187s/iter; left time: 154.4776s
	iters: 200, epoch: 1 | loss: 0.2222434
	speed: 0.0146s/iter; left time: 119.3210s
	iters: 300, epoch: 1 | loss: 0.8931270
	speed: 0.0144s/iter; left time: 115.8692s
	iters: 400, epoch: 1 | loss: 0.7743728
	speed: 0.0117s/iter; left time: 93.4257s
	iters: 500, epoch: 1 | loss: 0.2641674
	speed: 0.0086s/iter; left time: 67.3456s
	iters: 600, epoch: 1 | loss: 0.2673415
	speed: 0.0087s/iter; left time: 67.8601s
	iters: 700, epoch: 1 | loss: 1.1014965
	speed: 0.0091s/iter; left time: 69.8997s
	iters: 800, epoch: 1 | loss: 0.6538602
	speed: 0.0104s/iter; left time: 78.4887s
	iters: 900, epoch: 1 | loss: 0.4424592
	speed: 0.0124s/iter; left time: 92.1896s
	iters: 1000, epoch: 1 | loss: 0.4327768
	speed: 0.0082s/iter; left time: 60.5256s
Updating learning rate to 0.0024929522924
Validation loss decreased (inf --> 0.2902).  Saving model state dict ...
Epoch: 1 cost time: 11.664673566818237
Epoch: 1, Steps: 1045 | Train Loss: 0.5565858 Vali Loss: 0.2901590 Best vali loss: 0.2901590
	iters: 100, epoch: 2 | loss: 0.5650119
	speed: 0.0407s/iter; left time: 293.3909s
	iters: 200, epoch: 2 | loss: 0.2232562
	speed: 0.0140s/iter; left time: 99.8130s
	iters: 300, epoch: 2 | loss: 1.2508179
	speed: 0.0152s/iter; left time: 106.7306s
	iters: 400, epoch: 2 | loss: 0.3913909
	speed: 0.0141s/iter; left time: 97.6292s
	iters: 500, epoch: 2 | loss: 0.3812747
	speed: 0.0106s/iter; left time: 71.9226s
	iters: 600, epoch: 2 | loss: 0.2564172
	speed: 0.0195s/iter; left time: 130.6730s
	iters: 700, epoch: 2 | loss: 0.5919918
	speed: 0.0200s/iter; left time: 132.1198s
	iters: 800, epoch: 2 | loss: 0.2623228
	speed: 0.0154s/iter; left time: 100.5607s
	iters: 900, epoch: 2 | loss: 0.1950957
	speed: 0.0104s/iter; left time: 66.9916s
	iters: 1000, epoch: 2 | loss: 0.3240791
	speed: 0.0171s/iter; left time: 107.6902s
Updating learning rate to 0.0012464761462
Validation loss decreased (0.2902 --> 0.2851).  Saving model state dict ...
Epoch: 2 cost time: 15.65563440322876
Epoch: 2, Steps: 1045 | Train Loss: 0.4441658 Vali Loss: 0.2851140 Best vali loss: 0.2851140
	iters: 100, epoch: 3 | loss: 0.8656638
	speed: 0.0533s/iter; left time: 329.1762s
	iters: 200, epoch: 3 | loss: 0.2330342
	speed: 0.0142s/iter; left time: 86.0613s
	iters: 300, epoch: 3 | loss: 0.3689584
	speed: 0.0081s/iter; left time: 48.5077s
	iters: 400, epoch: 3 | loss: 0.3942855
	speed: 0.0091s/iter; left time: 53.6042s
	iters: 500, epoch: 3 | loss: 0.4860988
	speed: 0.0129s/iter; left time: 74.5880s
	iters: 600, epoch: 3 | loss: 1.0848677
	speed: 0.0128s/iter; left time: 72.4615s
	iters: 700, epoch: 3 | loss: 0.5585328
	speed: 0.0127s/iter; left time: 70.8650s
	iters: 800, epoch: 3 | loss: 1.0511963
	speed: 0.0123s/iter; left time: 67.5082s
	iters: 900, epoch: 3 | loss: 0.2545765
	speed: 0.0118s/iter; left time: 63.4361s
	iters: 1000, epoch: 3 | loss: 1.0257926
	speed: 0.0099s/iter; left time: 52.2711s
Updating learning rate to 0.0006232380731
Epoch: 3 cost time: 12.723937511444092
Epoch: 3, Steps: 1045 | Train Loss: 0.6323007 Vali Loss: 0.3002532 Best vali loss: 0.2851140

best validation loss 0.28511395400986433

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0020458138104, 'e_layers': 2, 'learning_rate': 0.0001149814586, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9518911
	speed: 0.0185s/iter; left time: 17.5283s
Updating learning rate to 0.00011060523740941694
Validation loss decreased (inf --> 0.3096).  Saving model state dict ...
Epoch: 1 cost time: 1.8474133014678955
Epoch: 1, Steps: 131 | Train Loss: 0.9518911 Vali Loss: 0.3096124 Best vali loss: 0.3096124
	iters: 100, epoch: 2 | loss: 0.3956848
	speed: 0.0236s/iter; left time: 19.2701s
Updating learning rate to 9.814281384339014e-05
Validation loss decreased (0.3096 --> 0.2932).  Saving model state dict ...
Epoch: 2 cost time: 2.0388755798339844
Epoch: 2, Steps: 131 | Train Loss: 0.3956848 Vali Loss: 0.2932377 Best vali loss: 0.2932377
	iters: 100, epoch: 3 | loss: 0.3785582
	speed: 0.0217s/iter; left time: 14.8767s
Updating learning rate to 7.949147891769625e-05
Validation loss decreased (0.2932 --> 0.2866).  Saving model state dict ...
Epoch: 3 cost time: 2.0606257915496826
Epoch: 3, Steps: 131 | Train Loss: 0.3785582 Vali Loss: 0.2865543 Best vali loss: 0.2865543

best validation loss 0.2865543404934175

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043376323922, 'e_layers': 3, 'learning_rate': 0.0024929522924, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4587383
	speed: 0.0150s/iter; left time: 76.8408s
	iters: 200, epoch: 4 | loss: 0.2128960
	speed: 0.0080s/iter; left time: 39.9986s
	iters: 300, epoch: 4 | loss: 0.7708778
	speed: 0.0094s/iter; left time: 46.5338s
	iters: 400, epoch: 4 | loss: 0.4308075
	speed: 0.0081s/iter; left time: 38.9011s
	iters: 500, epoch: 4 | loss: 0.2875879
	speed: 0.0084s/iter; left time: 39.7897s
	iters: 600, epoch: 4 | loss: 0.2629777
	speed: 0.0137s/iter; left time: 63.3663s
	iters: 700, epoch: 4 | loss: 0.6662025
	speed: 0.0152s/iter; left time: 68.8354s
	iters: 800, epoch: 4 | loss: 0.5506034
	speed: 0.0135s/iter; left time: 59.5642s
	iters: 900, epoch: 4 | loss: 0.3742865
	speed: 0.0126s/iter; left time: 54.6569s
	iters: 1000, epoch: 4 | loss: 0.2691545
	speed: 0.0145s/iter; left time: 61.1092s
Updating learning rate to 0.00031161903655
Epoch: 4 cost time: 12.125257015228271
Epoch: 4, Steps: 1045 | Train Loss: 0.4284132 Vali Loss: 0.3033774 Best vali loss: 0.2851140
	iters: 100, epoch: 5 | loss: 0.4314787
	speed: 0.0480s/iter; left time: 195.7219s
	iters: 200, epoch: 5 | loss: 0.2013068
	speed: 0.0137s/iter; left time: 54.7202s
	iters: 300, epoch: 5 | loss: 1.0466082
	speed: 0.0137s/iter; left time: 53.1314s
	iters: 400, epoch: 5 | loss: 0.2603042
	speed: 0.0131s/iter; left time: 49.4993s
	iters: 500, epoch: 5 | loss: 0.3170894
	speed: 0.0133s/iter; left time: 48.9808s
	iters: 600, epoch: 5 | loss: 0.2497176
	speed: 0.0142s/iter; left time: 50.7271s
	iters: 700, epoch: 5 | loss: 0.5589715
	speed: 0.0146s/iter; left time: 50.9584s
	iters: 800, epoch: 5 | loss: 0.2485003
	speed: 0.0118s/iter; left time: 39.7488s
	iters: 900, epoch: 5 | loss: 0.1456125
	speed: 0.0056s/iter; left time: 18.3288s
	iters: 1000, epoch: 5 | loss: 0.2772608
	speed: 0.0060s/iter; left time: 18.9515s
Updating learning rate to 0.000155809518275
Epoch: 5 cost time: 12.529695510864258
Epoch: 5, Steps: 1045 | Train Loss: 0.3736850 Vali Loss: 0.3057927 Best vali loss: 0.2851140
	iters: 100, epoch: 6 | loss: 0.8148006
	speed: 0.0337s/iter; left time: 102.3592s
	iters: 200, epoch: 6 | loss: 0.2428085
	speed: 0.0100s/iter; left time: 29.4123s
	iters: 300, epoch: 6 | loss: 0.2848450
	speed: 0.0102s/iter; left time: 28.9054s
	iters: 400, epoch: 6 | loss: 0.3607524
	speed: 0.0104s/iter; left time: 28.4572s
	iters: 500, epoch: 6 | loss: 0.3838011
	speed: 0.0110s/iter; left time: 28.9466s
	iters: 600, epoch: 6 | loss: 0.9674937
	speed: 0.0097s/iter; left time: 24.7112s
	iters: 700, epoch: 6 | loss: 0.3747057
	speed: 0.0090s/iter; left time: 21.9761s
	iters: 800, epoch: 6 | loss: 0.8227088
	speed: 0.0095s/iter; left time: 22.2527s
	iters: 900, epoch: 6 | loss: 0.2575667
	speed: 0.0107s/iter; left time: 24.0323s
	iters: 1000, epoch: 6 | loss: 0.8479789
	speed: 0.0115s/iter; left time: 24.6224s
Updating learning rate to 7.79047591375e-05
Epoch: 6 cost time: 10.906047821044922
Epoch: 6, Steps: 1045 | Train Loss: 0.5357461 Vali Loss: 0.3125283 Best vali loss: 0.2851140
	iters: 100, epoch: 7 | loss: 0.4744579
	speed: 0.0364s/iter; left time: 72.4183s
	iters: 200, epoch: 7 | loss: 0.2097256
	speed: 0.0101s/iter; left time: 19.1240s
	iters: 300, epoch: 7 | loss: 0.8440471
	speed: 0.0107s/iter; left time: 19.0761s
	iters: 400, epoch: 7 | loss: 0.1992866
	speed: 0.0109s/iter; left time: 18.4605s
	iters: 500, epoch: 7 | loss: 0.7316769
	speed: 0.0111s/iter; left time: 17.7098s
	iters: 600, epoch: 7 | loss: 0.3297728
	speed: 0.0109s/iter; left time: 16.2082s
	iters: 700, epoch: 7 | loss: 0.1569137
	speed: 0.0104s/iter; left time: 14.4586s
	iters: 800, epoch: 7 | loss: 0.3296504
	speed: 0.0078s/iter; left time: 10.0541s
	iters: 900, epoch: 7 | loss: 0.2326198
	speed: 0.0092s/iter; left time: 10.9202s
	iters: 1000, epoch: 7 | loss: 0.3451283
	speed: 0.0107s/iter; left time: 11.6488s
Updating learning rate to 3.895237956875e-05
Epoch: 7 cost time: 10.587110996246338
Epoch: 7, Steps: 1045 | Train Loss: 0.3853279 Vali Loss: 0.3068095 Best vali loss: 0.2851140
	iters: 100, epoch: 8 | loss: 0.2204106
	speed: 0.0356s/iter; left time: 33.6863s
	iters: 200, epoch: 8 | loss: 0.3726326
	speed: 0.0082s/iter; left time: 6.9649s
	iters: 300, epoch: 8 | loss: 0.2955313
	speed: 0.0088s/iter; left time: 6.5933s
	iters: 400, epoch: 8 | loss: 0.2554381
	speed: 0.0100s/iter; left time: 6.4725s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0034689769419, 'e_layers': 1, 'learning_rate': 0.0001573481183, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4706168
	speed: 0.0159s/iter; left time: 31.6560s
	iters: 200, epoch: 1 | loss: 0.4800836
	speed: 0.0077s/iter; left time: 14.6311s
Updating learning rate to 0.0001573481183
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 2.535238027572632
Epoch: 1, Steps: 262 | Train Loss: 0.4753502 Vali Loss: 0.2816863 Best vali loss: 0.2816863
	iters: 100, epoch: 2 | loss: 0.3233360
	speed: 0.0272s/iter; left time: 47.2129s
	iters: 200, epoch: 2 | loss: 0.4218906
	speed: 0.0077s/iter; left time: 12.6304s
Updating learning rate to 7.867405915e-05
Epoch: 2 cost time: 2.1380577087402344
Epoch: 2, Steps: 262 | Train Loss: 0.3726133 Vali Loss: 0.2820282 Best vali loss: 0.2816863
	iters: 100, epoch: 3 | loss: 0.2921307
	speed: 0.0223s/iter; left time: 32.7780s
	iters: 200, epoch: 3 | loss: 0.5007787
	speed: 0.0085s/iter; left time: 11.6817s
Updating learning rate to 3.9337029575e-05
Validation loss decreased (0.2817 --> 0.2812).  Saving model state dict ...
Epoch: 3 cost time: 2.307830333709717
Epoch: 3, Steps: 262 | Train Loss: 0.3964547 Vali Loss: 0.2812453 Best vali loss: 0.2812453
	iters: 100, epoch: 4 | loss: 0.5895172
	speed: 0.0214s/iter; left time: 25.8821s
	iters: 200, epoch: 4 | loss: 0.4613932
	speed: 0.0087s/iter; left time: 9.6277s
Updating learning rate to 1.96685147875e-05
Epoch: 4 cost time: 2.3371095657348633
Epoch: 4, Steps: 262 | Train Loss: 0.5254552 Vali Loss: 0.2858142 Best vali loss: 0.2812453
	iters: 100, epoch: 5 | loss: 0.5214627
	speed: 0.0241s/iter; left time: 22.8849s
	iters: 200, epoch: 5 | loss: 0.8450308
	speed: 0.0073s/iter; left time: 6.1949s
Updating learning rate to 9.83425739375e-06
Epoch: 5 cost time: 2.054746389389038
Epoch: 5, Steps: 262 | Train Loss: 0.6832468 Vali Loss: 0.2860432 Best vali loss: 0.2812453
	iters: 100, epoch: 6 | loss: 0.7483239
	speed: 0.0203s/iter; left time: 13.9172s
	iters: 200, epoch: 6 | loss: 0.6769394
	speed: 0.0077s/iter; left time: 4.5397s
Updating learning rate to 4.917128696875e-06
Epoch: 6 cost time: 2.0816218852996826
Epoch: 6, Steps: 262 | Train Loss: 0.7126316 Vali Loss: 0.2879539 Best vali loss: 0.2812453
	iters: 100, epoch: 7 | loss: 0.2752550
	speed: 0.0224s/iter; left time: 9.5116s
	iters: 200, epoch: 7 | loss: 0.3228856
	speed: 0.0097s/iter; left time: 3.1519s
Updating learning rate to 2.4585643484375e-06
Epoch: 7 cost time: 2.5257186889648438
Epoch: 7, Steps: 262 | Train Loss: 0.2990703 Vali Loss: 0.2883301 Best vali loss: 0.2812453
	iters: 100, epoch: 8 | loss: 0.3427513
	speed: 0.0330s/iter; left time: 5.3753s
	iters: 200, epoch: 8 | loss: 0.3270560
	speed: 0.0077s/iter; left time: 0.4878s
Updating learning rate to 1.22928217421875e-06
Epoch: 8 cost time: 2.1582462787628174
Epoch: 8, Steps: 262 | Train Loss: 0.3349036 Vali Loss: 0.2885129 Best vali loss: 0.2812453

best validation loss 0.2812453061148286

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0042120649381, 'e_layers': 2, 'learning_rate': 0.0027116687784, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0026084620308568216
Validation loss decreased (inf --> 0.3008).  Saving model state dict ...
Epoch: 1 cost time: 1.2090973854064941
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3008128 Best vali loss: 0.3008128
Updating learning rate to 0.0023145540799692403
Epoch: 2 cost time: 0.9209756851196289
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3038141 Best vali loss: 0.3008128
Updating learning rate to 0.001874689746977681
Epoch: 3 cost time: 1.0616645812988281
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3179789 Best vali loss: 0.3008128
Updating learning rate to 0.0013558343892
Validation loss decreased (0.3008 --> 0.2941).  Saving model state dict ...
Epoch: 4 cost time: 1.3648478984832764
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2940624 Best vali loss: 0.2940624
Updating learning rate to 0.000836979031422319
Validation loss decreased (0.2941 --> 0.2921).  Saving model state dict ...
Epoch: 5 cost time: 0.9488070011138916
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2920555 Best vali loss: 0.2920555
Updating learning rate to 0.00039711469843075936
Epoch: 6 cost time: 0.9180049896240234
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3044639 Best vali loss: 0.2920555
Updating learning rate to 0.000103206747543178
Epoch: 7 cost time: 1.091123342514038
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3098897 Best vali loss: 0.2920555
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3336219787597656
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3118749 Best vali loss: 0.2920555

best validation loss 0.29205553093699993

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009041623556, 'e_layers': 3, 'learning_rate': 8.95236174e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3628424
	speed: 0.0148s/iter; left time: 122.2190s
	iters: 200, epoch: 1 | loss: 1.4369847
	speed: 0.0077s/iter; left time: 63.0859s
	iters: 300, epoch: 1 | loss: 1.2192738
	speed: 0.0081s/iter; left time: 65.1023s
	iters: 400, epoch: 1 | loss: 0.2009634
	speed: 0.0082s/iter; left time: 65.5636s
	iters: 500, epoch: 1 | loss: 2.1197536
	speed: 0.0080s/iter; left time: 63.1220s
	iters: 600, epoch: 1 | loss: 0.2586026
	speed: 0.0074s/iter; left time: 57.0445s
	iters: 700, epoch: 1 | loss: 0.3031407
	speed: 0.0080s/iter; left time: 61.4521s
	iters: 800, epoch: 1 | loss: 0.3951605
	speed: 0.0076s/iter; left time: 57.3696s
	iters: 900, epoch: 1 | loss: 0.3708902
	speed: 0.0075s/iter; left time: 55.9579s
	iters: 1000, epoch: 1 | loss: 0.7344896
	speed: 0.0084s/iter; left time: 62.1790s
Updating learning rate to 8.95236174e-05
Validation loss decreased (inf --> 0.2827).  Saving model state dict ...
Epoch: 1 cost time: 8.625198125839233
Epoch: 1, Steps: 1045 | Train Loss: 0.7402102 Vali Loss: 0.2827223 Best vali loss: 0.2827223
	iters: 100, epoch: 2 | loss: 0.2587841
	speed: 0.0267s/iter; left time: 192.6642s
	iters: 200, epoch: 2 | loss: 0.9805797
	speed: 0.0072s/iter; left time: 50.8917s
	iters: 300, epoch: 2 | loss: 0.2777392
	speed: 0.0073s/iter; left time: 51.1209s
	iters: 400, epoch: 2 | loss: 1.3301399
	speed: 0.0081s/iter; left time: 55.9183s
	iters: 500, epoch: 2 | loss: 0.2777220
	speed: 0.0080s/iter; left time: 54.5965s
	iters: 600, epoch: 2 | loss: 0.5511991
	speed: 0.0081s/iter; left time: 54.2617s
	iters: 700, epoch: 2 | loss: 0.1920156
	speed: 0.0083s/iter; left time: 54.8544s
	iters: 800, epoch: 2 | loss: 0.3452493
	speed: 0.0088s/iter; left time: 57.2934s
	iters: 900, epoch: 2 | loss: 0.6355900
	speed: 0.0076s/iter; left time: 48.8380s
	iters: 1000, epoch: 2 | loss: 0.4155957
	speed: 0.0078s/iter; left time: 49.4968s
Updating learning rate to 4.47618087e-05
Validation loss decreased (0.2827 --> 0.2797).  Saving model state dict ...
Epoch: 2 cost time: 8.29296588897705
Epoch: 2, Steps: 1045 | Train Loss: 0.5264615 Vali Loss: 0.2796774 Best vali loss: 0.2796774
	iters: 100, epoch: 3 | loss: 0.3748508
	speed: 0.0245s/iter; left time: 151.3089s
	iters: 200, epoch: 3 | loss: 1.2260520
	speed: 0.0080s/iter; left time: 48.5785s
	iters: 300, epoch: 3 | loss: 0.6064957
	speed: 0.0077s/iter; left time: 45.8696s
	iters: 400, epoch: 3 | loss: 0.2136217
	speed: 0.0080s/iter; left time: 47.1948s
	iters: 500, epoch: 3 | loss: 0.2034302
	speed: 0.0081s/iter; left time: 46.8966s
	iters: 600, epoch: 3 | loss: 0.6063764
	speed: 0.0078s/iter; left time: 44.3492s
	iters: 700, epoch: 3 | loss: 0.8386089
	speed: 0.0083s/iter; left time: 46.2842s
	iters: 800, epoch: 3 | loss: 0.3626301
	speed: 0.0080s/iter; left time: 43.6793s
	iters: 900, epoch: 3 | loss: 0.3149251
	speed: 0.0076s/iter; left time: 41.0121s
	iters: 1000, epoch: 3 | loss: 0.6281026
	speed: 0.0068s/iter; left time: 35.8299s
Updating learning rate to 2.238090435e-05
Epoch: 3 cost time: 8.215311527252197
Epoch: 3, Steps: 1045 | Train Loss: 0.5375094 Vali Loss: 0.2855930 Best vali loss: 0.2796774

best validation loss 0.2796773672957277

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0009480992592, 'e_layers': 3, 'learning_rate': 6.1855838e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3468790
	speed: 0.0146s/iter; left time: 120.6798s
	iters: 200, epoch: 1 | loss: 0.2730923
	speed: 0.0070s/iter; left time: 57.0533s
	iters: 300, epoch: 1 | loss: 0.2978635
	speed: 0.0061s/iter; left time: 49.0193s
	iters: 400, epoch: 1 | loss: 0.2780506
	speed: 0.0077s/iter; left time: 61.1857s
	iters: 500, epoch: 1 | loss: 0.4512164
	speed: 0.0076s/iter; left time: 59.8300s
	iters: 600, epoch: 1 | loss: 0.4671559
	speed: 0.0076s/iter; left time: 59.2448s
	iters: 700, epoch: 1 | loss: 0.8156142
	speed: 0.0080s/iter; left time: 61.2415s
	iters: 800, epoch: 1 | loss: 0.3392154
	speed: 0.0079s/iter; left time: 59.8133s
	iters: 900, epoch: 1 | loss: 1.0250609
	speed: 0.0079s/iter; left time: 59.2461s
	iters: 1000, epoch: 1 | loss: 0.3401501
	speed: 0.0077s/iter; left time: 56.9866s
Updating learning rate to 6.1855838e-05
Validation loss decreased (inf --> 0.3080).  Saving model state dict ...
Epoch: 1 cost time: 8.233149528503418
Epoch: 1, Steps: 1045 | Train Loss: 0.4634298 Vali Loss: 0.3080179 Best vali loss: 0.3080179
	iters: 100, epoch: 2 | loss: 0.2002304
	speed: 0.0254s/iter; left time: 183.2612s
	iters: 200, epoch: 2 | loss: 0.4583103
	speed: 0.0074s/iter; left time: 52.3084s
	iters: 300, epoch: 2 | loss: 1.2289431
	speed: 0.0075s/iter; left time: 52.8383s
	iters: 400, epoch: 2 | loss: 0.2493069
	speed: 0.0079s/iter; left time: 54.4866s
	iters: 500, epoch: 2 | loss: 0.3470068
	speed: 0.0075s/iter; left time: 51.2155s
	iters: 600, epoch: 2 | loss: 0.1707989
	speed: 0.0067s/iter; left time: 44.8996s
	iters: 700, epoch: 2 | loss: 0.5849761
	speed: 0.0080s/iter; left time: 52.6684s
	iters: 800, epoch: 2 | loss: 0.5565451
	speed: 0.0088s/iter; left time: 57.2414s
	iters: 900, epoch: 2 | loss: 0.3941696
	speed: 0.0082s/iter; left time: 52.4324s
	iters: 1000, epoch: 2 | loss: 0.1549570
	speed: 0.0083s/iter; left time: 52.5864s
Updating learning rate to 3.0927919e-05
Validation loss decreased (0.3080 --> 0.2940).  Saving model state dict ...
Epoch: 2 cost time: 8.262666702270508
Epoch: 2, Steps: 1045 | Train Loss: 0.4345244 Vali Loss: 0.2939757 Best vali loss: 0.2939757
	iters: 100, epoch: 3 | loss: 0.2935578
	speed: 0.0293s/iter; left time: 181.1175s
	iters: 200, epoch: 3 | loss: 0.2440659
	speed: 0.0097s/iter; left time: 58.6781s
	iters: 300, epoch: 3 | loss: 1.6010184
	speed: 0.0093s/iter; left time: 55.5264s
	iters: 400, epoch: 3 | loss: 0.8382785
	speed: 0.0090s/iter; left time: 52.7265s
	iters: 500, epoch: 3 | loss: 1.4586838
	speed: 0.0103s/iter; left time: 59.2062s
	iters: 600, epoch: 3 | loss: 1.3827003
	speed: 0.0101s/iter; left time: 57.1570s
	iters: 700, epoch: 3 | loss: 1.0423533
	speed: 0.0093s/iter; left time: 51.5506s
	iters: 800, epoch: 3 | loss: 0.7880810
	speed: 0.0078s/iter; left time: 42.6184s
	iters: 900, epoch: 3 | loss: 0.6731582
	speed: 0.0087s/iter; left time: 46.7253s
	iters: 1000, epoch: 3 | loss: 0.2010935
	speed: 0.0085s/iter; left time: 44.7151s
Updating learning rate to 1.54639595e-05
Validation loss decreased (0.2940 --> 0.2896).  Saving model state dict ...
Epoch: 3 cost time: 9.495558977127075
Epoch: 3, Steps: 1045 | Train Loss: 0.8522991 Vali Loss: 0.2896246 Best vali loss: 0.2896246

best validation loss 0.28962463160437163

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0019824885131, 'e_layers': 1, 'learning_rate': 0.0001251474931, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4306291
	speed: 0.0145s/iter; left time: 28.9698s
	iters: 200, epoch: 1 | loss: 0.3932638
	speed: 0.0077s/iter; left time: 14.5140s
Updating learning rate to 0.00012038435026009375
Validation loss decreased (inf --> 0.3034).  Saving model state dict ...
Epoch: 1 cost time: 2.460198402404785
Epoch: 1, Steps: 262 | Train Loss: 0.4119464 Vali Loss: 0.3034339 Best vali loss: 0.3034339
	iters: 100, epoch: 2 | loss: 0.6282121
	speed: 0.0193s/iter; left time: 33.4199s
	iters: 200, epoch: 2 | loss: 0.5372818
	speed: 0.0069s/iter; left time: 11.2596s
Updating learning rate to 0.00010682006705975332
Validation loss decreased (0.3034 --> 0.2880).  Saving model state dict ...
Epoch: 2 cost time: 1.7815349102020264
Epoch: 2, Steps: 262 | Train Loss: 0.5827469 Vali Loss: 0.2879501 Best vali loss: 0.2879501
	iters: 100, epoch: 3 | loss: 0.5219439
	speed: 0.0177s/iter; left time: 26.0100s
	iters: 200, epoch: 3 | loss: 0.3210138
	speed: 0.0096s/iter; left time: 13.1633s
Updating learning rate to 8.65196826556972e-05
Validation loss decreased (0.2880 --> 0.2821).  Saving model state dict ...
Epoch: 3 cost time: 2.373413562774658
Epoch: 3, Steps: 262 | Train Loss: 0.4214788 Vali Loss: 0.2820854 Best vali loss: 0.2820854

best validation loss 0.2820853559600239

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009041623556, 'e_layers': 3, 'learning_rate': 8.95236174e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3492617
	speed: 0.0168s/iter; left time: 85.9720s
	iters: 200, epoch: 4 | loss: 0.6814089
	speed: 0.0095s/iter; left time: 47.6312s
	iters: 300, epoch: 4 | loss: 0.8690208
	speed: 0.0097s/iter; left time: 47.8786s
	iters: 400, epoch: 4 | loss: 0.1691082
	speed: 0.0093s/iter; left time: 44.8326s
	iters: 500, epoch: 4 | loss: 1.5223215
	speed: 0.0091s/iter; left time: 42.8012s
	iters: 600, epoch: 4 | loss: 0.2444217
	speed: 0.0097s/iter; left time: 44.6764s
	iters: 700, epoch: 4 | loss: 0.2032442
	speed: 0.0091s/iter; left time: 41.2370s
	iters: 800, epoch: 4 | loss: 0.3939493
	speed: 0.0091s/iter; left time: 40.3547s
	iters: 900, epoch: 4 | loss: 0.3667375
	speed: 0.0088s/iter; left time: 37.8994s
	iters: 1000, epoch: 4 | loss: 0.7263275
	speed: 0.0080s/iter; left time: 33.7857s
Updating learning rate to 1.1190452175e-05
Epoch: 4 cost time: 9.833014249801636
Epoch: 4, Steps: 1045 | Train Loss: 0.5525801 Vali Loss: 0.2830006 Best vali loss: 0.2796774
	iters: 100, epoch: 5 | loss: 0.2534460
	speed: 0.0214s/iter; left time: 87.1583s
	iters: 200, epoch: 5 | loss: 0.6103942
	speed: 0.0051s/iter; left time: 20.4416s
	iters: 300, epoch: 5 | loss: 0.2565512
	speed: 0.0058s/iter; left time: 22.4755s
	iters: 400, epoch: 5 | loss: 0.9115097
	speed: 0.0076s/iter; left time: 28.6028s
	iters: 500, epoch: 5 | loss: 0.2629234
	speed: 0.0088s/iter; left time: 32.5240s
	iters: 600, epoch: 5 | loss: 0.4183871
	speed: 0.0085s/iter; left time: 30.3661s
	iters: 700, epoch: 5 | loss: 0.1839147
	speed: 0.0084s/iter; left time: 29.3250s
	iters: 800, epoch: 5 | loss: 0.3169095
	speed: 0.0090s/iter; left time: 30.4930s
	iters: 900, epoch: 5 | loss: 0.6117033
	speed: 0.0091s/iter; left time: 29.9407s
	iters: 1000, epoch: 5 | loss: 0.4174847
	speed: 0.0083s/iter; left time: 26.2690s
Updating learning rate to 5.5952260875e-06
Epoch: 5 cost time: 8.02555799484253
Epoch: 5, Steps: 1045 | Train Loss: 0.4243224 Vali Loss: 0.2869192 Best vali loss: 0.2796774
	iters: 100, epoch: 6 | loss: 0.3719775
	speed: 0.0253s/iter; left time: 76.8957s
	iters: 200, epoch: 6 | loss: 1.0159966
	speed: 0.0080s/iter; left time: 23.4694s
	iters: 300, epoch: 6 | loss: 0.6260741
	speed: 0.0087s/iter; left time: 24.6666s
	iters: 400, epoch: 6 | loss: 0.1873438
	speed: 0.0086s/iter; left time: 23.4079s
	iters: 500, epoch: 6 | loss: 0.1980903
	speed: 0.0082s/iter; left time: 21.5959s
	iters: 600, epoch: 6 | loss: 0.5053085
	speed: 0.0079s/iter; left time: 19.9838s
	iters: 700, epoch: 6 | loss: 0.8193288
	speed: 0.0087s/iter; left time: 21.1283s
	iters: 800, epoch: 6 | loss: 0.3683745
	speed: 0.0075s/iter; left time: 17.6106s
	iters: 900, epoch: 6 | loss: 0.3035128
	speed: 0.0073s/iter; left time: 16.4244s
	iters: 1000, epoch: 6 | loss: 0.5349914
	speed: 0.0069s/iter; left time: 14.6948s
Updating learning rate to 2.79761304375e-06
Epoch: 6 cost time: 8.331108570098877
Epoch: 6, Steps: 1045 | Train Loss: 0.4930998 Vali Loss: 0.2842785 Best vali loss: 0.2796774
	iters: 100, epoch: 7 | loss: 0.7815029
	speed: 0.0222s/iter; left time: 44.2433s
	iters: 200, epoch: 7 | loss: 0.2152295
	speed: 0.0064s/iter; left time: 12.1170s
	iters: 300, epoch: 7 | loss: 0.1657620
	speed: 0.0076s/iter; left time: 13.5272s
	iters: 400, epoch: 7 | loss: 0.2033424
	speed: 0.0086s/iter; left time: 14.4898s
	iters: 500, epoch: 7 | loss: 0.2439592
	speed: 0.0089s/iter; left time: 14.1839s
	iters: 600, epoch: 7 | loss: 0.5313503
	speed: 0.0073s/iter; left time: 10.9397s
	iters: 700, epoch: 7 | loss: 0.2818564
	speed: 0.0092s/iter; left time: 12.8571s
	iters: 800, epoch: 7 | loss: 0.9837315
	speed: 0.0092s/iter; left time: 11.9032s
	iters: 900, epoch: 7 | loss: 0.3355737
	speed: 0.0078s/iter; left time: 9.2811s
	iters: 1000, epoch: 7 | loss: 0.1749541
	speed: 0.0069s/iter; left time: 7.5763s
Updating learning rate to 1.398806521875e-06
Epoch: 7 cost time: 8.363470554351807
Epoch: 7, Steps: 1045 | Train Loss: 0.3917262 Vali Loss: 0.2857676 Best vali loss: 0.2796774
	iters: 100, epoch: 8 | loss: 0.3396652
	speed: 0.0247s/iter; left time: 23.3236s
	iters: 200, epoch: 8 | loss: 0.1611305
	speed: 0.0068s/iter; left time: 5.7597s
	iters: 300, epoch: 8 | loss: 0.3271429
	speed: 0.0083s/iter; left time: 6.1578s
	iters: 400, epoch: 8 | loss: 0.3794051
	speed: 0.0090s/iter; left time: 5.8108s
	iters: 500, epoch: 8 | loss: 0.1922249
	speed: 0.0089s/iter; left time: 4.8529s
	iters: 600, epoch: 8 | loss: 0.4249143
	speed: 0.0088s/iter; left time: 3.9468s
	iters: 700, epoch: 8 | loss: 1.0320872
	speed: 0.0093s/iter; left time: 3.2089s
	iters: 800, epoch: 8 | loss: 0.2063940
	speed: 0.0096s/iter; left time: 2.3591s
	iters: 900, epoch: 8 | loss: 0.6909265
	speed: 0.0097s/iter; left time: 1.4152s
	iters: 1000, epoch: 8 | loss: 0.3039044
	speed: 0.0097s/iter; left time: 0.4452s
Updating learning rate to 6.994032609375e-07
Epoch: 8 cost time: 9.203149557113647
Epoch: 8, Steps: 1045 | Train Loss: 0.4057795 Vali Loss: 0.2855092 Best vali loss: 0.2796774

best validation loss 0.2796773672957277

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0008167271028, 'e_layers': 2, 'learning_rate': 0.0010834233497, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6906348
	speed: 0.0110s/iter; left time: 22.0227s
	iters: 200, epoch: 1 | loss: 0.6748750
	speed: 0.0089s/iter; left time: 16.8847s
Updating learning rate to 0.0010421880037663242
Validation loss decreased (inf --> 0.2985).  Saving model state dict ...
Epoch: 1 cost time: 2.293613910675049
Epoch: 1, Steps: 262 | Train Loss: 0.6827549 Vali Loss: 0.2985144 Best vali loss: 0.2985144
	iters: 100, epoch: 2 | loss: 0.6599813
	speed: 0.0242s/iter; left time: 41.9650s
	iters: 200, epoch: 2 | loss: 0.5917740
	speed: 0.0095s/iter; left time: 15.5051s
Updating learning rate to 0.0009247596735843572
Validation loss decreased (0.2985 --> 0.2931).  Saving model state dict ...
Epoch: 2 cost time: 2.5507571697235107
Epoch: 2, Steps: 262 | Train Loss: 0.6258776 Vali Loss: 0.2930865 Best vali loss: 0.2930865
	iters: 100, epoch: 3 | loss: 0.5018869
	speed: 0.0238s/iter; left time: 34.9938s
	iters: 200, epoch: 3 | loss: 0.6900424
	speed: 0.0112s/iter; left time: 15.3405s
Updating learning rate to 0.0007490157579338396
Validation loss decreased (0.2931 --> 0.2837).  Saving model state dict ...
Epoch: 3 cost time: 2.7873799800872803
Epoch: 3, Steps: 262 | Train Loss: 0.5959647 Vali Loss: 0.2836776 Best vali loss: 0.2836776
	iters: 100, epoch: 4 | loss: 0.5490361
	speed: 0.0262s/iter; left time: 31.7211s
	iters: 200, epoch: 4 | loss: 0.2712410
	speed: 0.0096s/iter; left time: 10.6487s
Updating learning rate to 0.00054171167485
Epoch: 4 cost time: 2.556185722351074
Epoch: 4, Steps: 262 | Train Loss: 0.4101386 Vali Loss: 0.2954358 Best vali loss: 0.2836776
	iters: 100, epoch: 5 | loss: 0.4800014
	speed: 0.0192s/iter; left time: 18.1908s
	iters: 200, epoch: 5 | loss: 0.3727688
	speed: 0.0090s/iter; left time: 7.6169s
Updating learning rate to 0.0003344075917661606
Epoch: 5 cost time: 2.295280933380127
Epoch: 5, Steps: 262 | Train Loss: 0.4263851 Vali Loss: 0.3016920 Best vali loss: 0.2836776
	iters: 100, epoch: 6 | loss: 0.3397106
	speed: 0.0305s/iter; left time: 20.9304s
	iters: 200, epoch: 6 | loss: 0.2895930
	speed: 0.0090s/iter; left time: 5.2623s
Updating learning rate to 0.0001586636761156429
Epoch: 6 cost time: 2.533116579055786
Epoch: 6, Steps: 262 | Train Loss: 0.3146518 Vali Loss: 0.3061828 Best vali loss: 0.2836776
	iters: 100, epoch: 7 | loss: 0.3091361
	speed: 0.0235s/iter; left time: 9.9777s
	iters: 200, epoch: 7 | loss: 0.4089129
	speed: 0.0090s/iter; left time: 2.9326s
Updating learning rate to 4.123534593367584e-05
Epoch: 7 cost time: 2.4723401069641113
Epoch: 7, Steps: 262 | Train Loss: 0.3590245 Vali Loss: 0.3146298 Best vali loss: 0.2836776
	iters: 100, epoch: 8 | loss: 0.3372655
	speed: 0.0235s/iter; left time: 3.8288s
	iters: 200, epoch: 8 | loss: 0.3309931
	speed: 0.0102s/iter; left time: 0.6438s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7049405574798584
Epoch: 8, Steps: 262 | Train Loss: 0.3341293 Vali Loss: 0.3113697 Best vali loss: 0.2836776

best validation loss 0.2836775703472735

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017414092288, 'e_layers': 4, 'learning_rate': 0.0037118860825, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3473745
	speed: 0.0181s/iter; left time: 74.0304s
	iters: 200, epoch: 1 | loss: 0.5526709
	speed: 0.0119s/iter; left time: 47.2444s
	iters: 300, epoch: 1 | loss: 0.3655983
	speed: 0.0082s/iter; left time: 32.0222s
	iters: 400, epoch: 1 | loss: 0.6096240
	speed: 0.0158s/iter; left time: 59.8550s
	iters: 500, epoch: 1 | loss: 0.3378084
	speed: 0.0108s/iter; left time: 39.7969s
Updating learning rate to 0.0035706108305676256
Validation loss decreased (inf --> 0.3225).  Saving model state dict ...
Epoch: 1 cost time: 6.419299364089966
Epoch: 1, Steps: 523 | Train Loss: 0.4426152 Vali Loss: 0.3224858 Best vali loss: 0.3224858
	iters: 100, epoch: 2 | loss: 0.2545900
	speed: 0.0247s/iter; left time: 87.8283s
	iters: 200, epoch: 2 | loss: 0.7737774
	speed: 0.0146s/iter; left time: 50.6580s
	iters: 300, epoch: 2 | loss: 0.6570892
	speed: 0.0099s/iter; left time: 33.2185s
	iters: 400, epoch: 2 | loss: 0.7814535
	speed: 0.0084s/iter; left time: 27.4293s
	iters: 500, epoch: 2 | loss: 0.7901435
	speed: 0.0128s/iter; left time: 40.3193s
Updating learning rate to 0.003168292951213859
Validation loss decreased (0.3225 --> 0.3197).  Saving model state dict ...
Epoch: 2 cost time: 6.166881322860718
Epoch: 2, Steps: 523 | Train Loss: 0.6514107 Vali Loss: 0.3197498 Best vali loss: 0.3197498
	iters: 100, epoch: 3 | loss: 0.2814564
	speed: 0.0241s/iter; left time: 73.0956s
	iters: 200, epoch: 3 | loss: 0.4916461
	speed: 0.0121s/iter; left time: 35.4231s
	iters: 300, epoch: 3 | loss: 0.5084839
	speed: 0.0106s/iter; left time: 30.0032s
	iters: 400, epoch: 3 | loss: 0.6669943
	speed: 0.0096s/iter; left time: 26.3047s
	iters: 500, epoch: 3 | loss: 1.2450218
	speed: 0.0151s/iter; left time: 39.7496s
Updating learning rate to 0.0025661816945496537
Epoch: 3 cost time: 6.113192319869995
Epoch: 3, Steps: 523 | Train Loss: 0.6387205 Vali Loss: 0.3209282 Best vali loss: 0.3197498
	iters: 100, epoch: 4 | loss: 0.9062536
	speed: 0.0251s/iter; left time: 63.1151s
	iters: 200, epoch: 4 | loss: 0.8397711
	speed: 0.0102s/iter; left time: 24.7378s
	iters: 300, epoch: 4 | loss: 0.3950186
	speed: 0.0079s/iter; left time: 18.3729s
	iters: 400, epoch: 4 | loss: 0.4158140
	speed: 0.0099s/iter; left time: 21.9606s
	iters: 500, epoch: 4 | loss: 0.4233110
	speed: 0.0148s/iter; left time: 31.2833s
Updating learning rate to 0.00185594304125
Epoch: 4 cost time: 5.953506946563721
Epoch: 4, Steps: 523 | Train Loss: 0.5960337 Vali Loss: 0.3273401 Best vali loss: 0.3197498
	iters: 100, epoch: 5 | loss: 1.2684112
	speed: 0.0199s/iter; left time: 39.6804s
	iters: 200, epoch: 5 | loss: 0.9515193
	speed: 0.0113s/iter; left time: 21.4382s
	iters: 300, epoch: 5 | loss: 1.2155862
	speed: 0.0108s/iter; left time: 19.4418s
	iters: 400, epoch: 5 | loss: 1.2363155
	speed: 0.0081s/iter; left time: 13.6601s
	iters: 500, epoch: 5 | loss: 0.9886181
	speed: 0.0097s/iter; left time: 15.5087s
Updating learning rate to 0.0011457043879503468
Epoch: 5 cost time: 5.1879518032073975
Epoch: 5, Steps: 523 | Train Loss: 1.1320900 Vali Loss: 0.3216991 Best vali loss: 0.3197498
	iters: 100, epoch: 6 | loss: 0.5355130
	speed: 0.0247s/iter; left time: 36.3034s
	iters: 200, epoch: 6 | loss: 0.7777699
	speed: 0.0105s/iter; left time: 14.4223s
	iters: 300, epoch: 6 | loss: 0.6706916
	speed: 0.0135s/iter; left time: 17.2015s
	iters: 400, epoch: 6 | loss: 0.9011173
	speed: 0.0131s/iter; left time: 15.3647s
	iters: 500, epoch: 6 | loss: 0.9882579
	speed: 0.0123s/iter; left time: 13.1248s
Updating learning rate to 0.0005435931312861408
Epoch: 6 cost time: 6.4902870655059814
Epoch: 6, Steps: 523 | Train Loss: 0.7746700 Vali Loss: 0.3235090 Best vali loss: 0.3197498
	iters: 100, epoch: 7 | loss: 0.2829961
	speed: 0.0254s/iter; left time: 24.0891s
	iters: 200, epoch: 7 | loss: 0.5326421
	speed: 0.0100s/iter; left time: 8.4752s
	iters: 300, epoch: 7 | loss: 0.6892110
	speed: 0.0094s/iter; left time: 7.0388s
	iters: 400, epoch: 7 | loss: 1.5185084
	speed: 0.0127s/iter; left time: 8.2266s
	iters: 500, epoch: 7 | loss: 0.4769298
	speed: 0.0120s/iter; left time: 6.5625s
Updating learning rate to 0.00014127525193237425
Epoch: 7 cost time: 6.00468897819519
Epoch: 7, Steps: 523 | Train Loss: 0.7000575 Vali Loss: 0.3218679 Best vali loss: 0.3197498
	iters: 100, epoch: 8 | loss: 0.5370653
	speed: 0.0254s/iter; left time: 10.7518s
	iters: 200, epoch: 8 | loss: 0.6532345
	speed: 0.0103s/iter; left time: 3.3222s
	iters: 300, epoch: 8 | loss: 0.8784061
	speed: 0.0095s/iter; left time: 2.1279s
	iters: 400, epoch: 8 | loss: 0.4356677
	speed: 0.0130s/iter; left time: 1.6126s
	iters: 500, epoch: 8 | loss: 0.2742003
	speed: 0.0132s/iter; left time: 0.3176s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.230934381484985
Epoch: 8, Steps: 523 | Train Loss: 0.5557148 Vali Loss: 0.3219860 Best vali loss: 0.3197498

best validation loss 0.31974977261517384

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0011930903227, 'e_layers': 4, 'learning_rate': 5.40218049e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.40218049e-05
Validation loss decreased (inf --> 0.3202).  Saving model state dict ...
Epoch: 1 cost time: 1.2803802490234375
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3201607 Best vali loss: 0.3201607
Updating learning rate to 2.701090245e-05
Validation loss decreased (0.3202 --> 0.3022).  Saving model state dict ...
Epoch: 2 cost time: 0.9515810012817383
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3021605 Best vali loss: 0.3021605
Updating learning rate to 1.3505451225e-05
Validation loss decreased (0.3022 --> 0.2968).  Saving model state dict ...
Epoch: 3 cost time: 1.1740655899047852
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2968050 Best vali loss: 0.2968050

best validation loss 0.2968050306195351

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0064145521333, 'e_layers': 4, 'learning_rate': 6.12299099e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.88994852170601e-05
Validation loss decreased (inf --> 0.3466).  Saving model state dict ...
Epoch: 1 cost time: 2.1174073219299316
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3465644 Best vali loss: 0.3465644
Updating learning rate to 5.226299720086565e-05
Validation loss decreased (0.3466 --> 0.3353).  Saving model state dict ...
Epoch: 2 cost time: 1.2725589275360107
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3353336 Best vali loss: 0.3353336
Updating learning rate to 4.2330790991968596e-05
Validation loss decreased (0.3353 --> 0.3276).  Saving model state dict ...
Epoch: 3 cost time: 0.9813177585601807
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3275973 Best vali loss: 0.3275973

best validation loss 0.3275973378348501

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0011249019077, 'e_layers': 4, 'learning_rate': 0.0031528586887, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0031528586887
Validation loss decreased (inf --> 0.2890).  Saving model state dict ...
Epoch: 1 cost time: 1.2393214702606201
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2890360 Best vali loss: 0.2890360
Updating learning rate to 0.00157642934435
Validation loss decreased (0.2890 --> 0.2880).  Saving model state dict ...
Epoch: 2 cost time: 0.7801082134246826
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2879920 Best vali loss: 0.2879920
Updating learning rate to 0.000788214672175
Epoch: 3 cost time: 1.4690816402435303
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2897628 Best vali loss: 0.2879920

best validation loss 0.28799195065069216

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0011249019077, 'e_layers': 4, 'learning_rate': 0.0031528586887, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0003941073360875
Epoch: 4 cost time: 1.2652084827423096
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2884439 Best vali loss: 0.2879920
Updating learning rate to 0.00019705366804375
Epoch: 5 cost time: 0.9623346328735352
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2927497 Best vali loss: 0.2879920
Updating learning rate to 9.8526834021875e-05
Epoch: 6 cost time: 1.1120495796203613
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2930162 Best vali loss: 0.2879920
Updating learning rate to 4.92634170109375e-05
Epoch: 7 cost time: 1.9760823249816895
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2920473 Best vali loss: 0.2879920
Updating learning rate to 2.463170850546875e-05
Epoch: 8 cost time: 1.013843059539795
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2915059 Best vali loss: 0.2879920

best validation loss 0.28799195065069216

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0098291154407, 'e_layers': 4, 'learning_rate': 0.0008074353009, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.1847925
	speed: 0.0166s/iter; left time: 136.9544s
	iters: 200, epoch: 1 | loss: 0.4141360
	speed: 0.0101s/iter; left time: 82.3096s
	iters: 300, epoch: 1 | loss: 0.3494773
	speed: 0.0097s/iter; left time: 77.9783s
	iters: 400, epoch: 1 | loss: 0.9215997
	speed: 0.0102s/iter; left time: 81.5780s
	iters: 500, epoch: 1 | loss: 0.1508598
	speed: 0.0087s/iter; left time: 68.1207s
	iters: 600, epoch: 1 | loss: 1.2478120
	speed: 0.0097s/iter; left time: 75.5553s
	iters: 700, epoch: 1 | loss: 0.2587383
	speed: 0.0076s/iter; left time: 58.5392s
	iters: 800, epoch: 1 | loss: 0.9770949
	speed: 0.0082s/iter; left time: 61.8197s
	iters: 900, epoch: 1 | loss: 0.3307190
	speed: 0.0086s/iter; left time: 63.9534s
	iters: 1000, epoch: 1 | loss: 0.1739494
	speed: 0.0092s/iter; left time: 67.5791s
Updating learning rate to 0.0008074353009
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 9.870283365249634
Epoch: 1, Steps: 1045 | Train Loss: 0.5009179 Vali Loss: 0.2856611 Best vali loss: 0.2856611
	iters: 100, epoch: 2 | loss: 0.5536292
	speed: 0.0241s/iter; left time: 174.2393s
	iters: 200, epoch: 2 | loss: 0.6063322
	speed: 0.0102s/iter; left time: 72.8842s
	iters: 300, epoch: 2 | loss: 0.3191188
	speed: 0.0113s/iter; left time: 79.4305s
	iters: 400, epoch: 2 | loss: 0.5313047
	speed: 0.0116s/iter; left time: 79.9115s
	iters: 500, epoch: 2 | loss: 0.9484428
	speed: 0.0099s/iter; left time: 67.5427s
	iters: 600, epoch: 2 | loss: 0.4195744
	speed: 0.0091s/iter; left time: 61.3909s
	iters: 700, epoch: 2 | loss: 0.4199924
	speed: 0.0075s/iter; left time: 49.5339s
	iters: 800, epoch: 2 | loss: 0.2439772
	speed: 0.0138s/iter; left time: 90.2292s
	iters: 900, epoch: 2 | loss: 0.2314668
	speed: 0.0154s/iter; left time: 99.1251s
	iters: 1000, epoch: 2 | loss: 0.3961363
	speed: 0.0126s/iter; left time: 79.7993s
Updating learning rate to 0.00040371765045
Epoch: 2 cost time: 11.731518507003784
Epoch: 2, Steps: 1045 | Train Loss: 0.4669975 Vali Loss: 0.2956917 Best vali loss: 0.2856611
	iters: 100, epoch: 3 | loss: 0.5067414
	speed: 0.0406s/iter; left time: 250.6578s
	iters: 200, epoch: 3 | loss: 0.2621522
	speed: 0.0153s/iter; left time: 92.8372s
	iters: 300, epoch: 3 | loss: 0.4101575
	speed: 0.0122s/iter; left time: 72.6075s
	iters: 400, epoch: 3 | loss: 0.3150963
	speed: 0.0152s/iter; left time: 89.1400s
	iters: 500, epoch: 3 | loss: 0.2695555
	speed: 0.0129s/iter; left time: 74.2993s
	iters: 600, epoch: 3 | loss: 1.2053641
	speed: 0.0122s/iter; left time: 69.3346s
	iters: 700, epoch: 3 | loss: 0.3550163
	speed: 0.0155s/iter; left time: 86.4293s
	iters: 800, epoch: 3 | loss: 0.2622372
	speed: 0.0137s/iter; left time: 74.8465s
	iters: 900, epoch: 3 | loss: 0.3031510
	speed: 0.0139s/iter; left time: 74.8384s
	iters: 1000, epoch: 3 | loss: 0.2231446
	speed: 0.0129s/iter; left time: 68.0909s
Updating learning rate to 0.000201858825225
Validation loss decreased (0.2857 --> 0.2811).  Saving model state dict ...
Epoch: 3 cost time: 14.287018537521362
Epoch: 3, Steps: 1045 | Train Loss: 0.4112616 Vali Loss: 0.2811411 Best vali loss: 0.2811411
	iters: 100, epoch: 4 | loss: 0.2228076
	speed: 0.0324s/iter; left time: 166.2733s
	iters: 200, epoch: 4 | loss: 0.2358701
	speed: 0.0105s/iter; left time: 52.9858s
	iters: 300, epoch: 4 | loss: 0.2115289
	speed: 0.0114s/iter; left time: 56.3554s
	iters: 400, epoch: 4 | loss: 0.3073082
	speed: 0.0090s/iter; left time: 43.5160s
	iters: 500, epoch: 4 | loss: 0.5079765
	speed: 0.0077s/iter; left time: 36.2767s
	iters: 600, epoch: 4 | loss: 0.5459162
	speed: 0.0068s/iter; left time: 31.3721s
	iters: 700, epoch: 4 | loss: 0.2978217
	speed: 0.0068s/iter; left time: 30.8247s
	iters: 800, epoch: 4 | loss: 0.1706360
	speed: 0.0105s/iter; left time: 46.5012s
	iters: 900, epoch: 4 | loss: 0.2822363
	speed: 0.0163s/iter; left time: 70.3641s
	iters: 1000, epoch: 4 | loss: 0.5932811
	speed: 0.0140s/iter; left time: 59.1931s
Updating learning rate to 0.0001009294126125
Epoch: 4 cost time: 11.168541193008423
Epoch: 4, Steps: 1045 | Train Loss: 0.3375382 Vali Loss: 0.2958096 Best vali loss: 0.2811411
	iters: 100, epoch: 5 | loss: 1.5622077
	speed: 0.0461s/iter; left time: 188.3000s
	iters: 200, epoch: 5 | loss: 0.2062407
	speed: 0.0112s/iter; left time: 44.7187s
	iters: 300, epoch: 5 | loss: 0.4288046
	speed: 0.0085s/iter; left time: 33.0204s
	iters: 400, epoch: 5 | loss: 0.3877433
	speed: 0.0096s/iter; left time: 36.1205s
	iters: 500, epoch: 5 | loss: 0.2606797
	speed: 0.0078s/iter; left time: 28.6522s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0047956796232, 'e_layers': 1, 'learning_rate': 0.0034849637707, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4968138
	speed: 0.0146s/iter; left time: 59.7235s
	iters: 200, epoch: 1 | loss: 0.5294168
	speed: 0.0073s/iter; left time: 29.1673s
	iters: 300, epoch: 1 | loss: 0.3227093
	speed: 0.0068s/iter; left time: 26.4708s
	iters: 400, epoch: 1 | loss: 0.9489083
	speed: 0.0060s/iter; left time: 22.6823s
	iters: 500, epoch: 1 | loss: 0.3613500
	speed: 0.0066s/iter; left time: 24.2022s
Updating learning rate to 0.0034849637707
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 4.009396553039551
Epoch: 1, Steps: 523 | Train Loss: 0.5318396 Vali Loss: 0.2834067 Best vali loss: 0.2834067
	iters: 100, epoch: 2 | loss: 1.0342629
	speed: 0.0212s/iter; left time: 75.4716s
	iters: 200, epoch: 2 | loss: 0.3586485
	speed: 0.0074s/iter; left time: 25.4692s
	iters: 300, epoch: 2 | loss: 0.4354068
	speed: 0.0059s/iter; left time: 19.8573s
	iters: 400, epoch: 2 | loss: 0.3644491
	speed: 0.0059s/iter; left time: 19.1612s
	iters: 500, epoch: 2 | loss: 0.5440904
	speed: 0.0076s/iter; left time: 23.9963s
Updating learning rate to 0.00174248188535
Epoch: 2 cost time: 3.662663698196411
Epoch: 2, Steps: 523 | Train Loss: 0.5473715 Vali Loss: 0.2954990 Best vali loss: 0.2834067
	iters: 100, epoch: 3 | loss: 0.6776010
	speed: 0.0192s/iter; left time: 58.3583s
	iters: 200, epoch: 3 | loss: 0.4264963
	speed: 0.0065s/iter; left time: 19.1384s
	iters: 300, epoch: 3 | loss: 0.4402160
	speed: 0.0051s/iter; left time: 14.4874s
	iters: 400, epoch: 3 | loss: 0.3186028
	speed: 0.0038s/iter; left time: 10.5302s
	iters: 500, epoch: 3 | loss: 0.8116054
	speed: 0.0038s/iter; left time: 10.1154s
Updating learning rate to 0.000871240942675
Epoch: 3 cost time: 2.800896167755127
Epoch: 3, Steps: 523 | Train Loss: 0.5349043 Vali Loss: 0.3119869 Best vali loss: 0.2834067
	iters: 100, epoch: 4 | loss: 0.3710285
	speed: 0.0151s/iter; left time: 38.0726s
	iters: 200, epoch: 4 | loss: 0.3346733
	speed: 0.0056s/iter; left time: 13.5788s
	iters: 300, epoch: 4 | loss: 0.3933158
	speed: 0.0054s/iter; left time: 12.6158s
	iters: 400, epoch: 4 | loss: 0.4093031
	speed: 0.0056s/iter; left time: 12.5132s
	iters: 500, epoch: 4 | loss: 0.2995224
	speed: 0.0059s/iter; left time: 12.4554s
Updating learning rate to 0.0004356204713375
Epoch: 4 cost time: 3.045074224472046
Epoch: 4, Steps: 523 | Train Loss: 0.3615686 Vali Loss: 0.3192770 Best vali loss: 0.2834067
	iters: 100, epoch: 5 | loss: 0.3382211
	speed: 0.0159s/iter; left time: 31.7449s
	iters: 200, epoch: 5 | loss: 0.2714393
	speed: 0.0056s/iter; left time: 10.6082s
	iters: 300, epoch: 5 | loss: 0.3266543
	speed: 0.0055s/iter; left time: 9.7723s
	iters: 400, epoch: 5 | loss: 0.2393249
	speed: 0.0060s/iter; left time: 10.2102s
	iters: 500, epoch: 5 | loss: 0.4999281
	speed: 0.0060s/iter; left time: 9.4821s
Updating learning rate to 0.00021781023566875
Epoch: 5 cost time: 3.0335500240325928
Epoch: 5, Steps: 523 | Train Loss: 0.3351135 Vali Loss: 0.3282981 Best vali loss: 0.2834067
	iters: 100, epoch: 6 | loss: 0.3369135
	speed: 0.0149s/iter; left time: 21.9639s
	iters: 200, epoch: 6 | loss: 0.4185591
	speed: 0.0055s/iter; left time: 7.5441s
	iters: 300, epoch: 6 | loss: 0.7205905
	speed: 0.0058s/iter; left time: 7.3897s
	iters: 400, epoch: 6 | loss: 0.3737183
	speed: 0.0060s/iter; left time: 7.0579s
	iters: 500, epoch: 6 | loss: 0.6721010
	speed: 0.0059s/iter; left time: 6.3531s
Updating learning rate to 0.000108905117834375
Epoch: 6 cost time: 3.0920097827911377
Epoch: 6, Steps: 523 | Train Loss: 0.5043765 Vali Loss: 0.3504449 Best vali loss: 0.2834067
	iters: 100, epoch: 7 | loss: 0.5186942
	speed: 0.0148s/iter; left time: 13.9901s
	iters: 200, epoch: 7 | loss: 0.2039237
	speed: 0.0057s/iter; left time: 4.8078s
	iters: 300, epoch: 7 | loss: 0.2176237
	speed: 0.0057s/iter; left time: 4.2916s
	iters: 400, epoch: 7 | loss: 0.7788998
	speed: 0.0053s/iter; left time: 3.4170s
	iters: 500, epoch: 7 | loss: 0.3942561
	speed: 0.0046s/iter; left time: 2.5428s
Updating learning rate to 5.44525589171875e-05
Epoch: 7 cost time: 2.861473560333252
Epoch: 7, Steps: 523 | Train Loss: 0.4226795 Vali Loss: 0.3574407 Best vali loss: 0.2834067
	iters: 100, epoch: 8 | loss: 0.4581609
	speed: 0.0140s/iter; left time: 5.9394s
	iters: 200, epoch: 8 | loss: 0.3066358
	speed: 0.0049s/iter; left time: 1.5978s
	iters: 300, epoch: 8 | loss: 0.3513402
	speed: 0.0041s/iter; left time: 0.9141s
	iters: 400, epoch: 8 | loss: 0.2294883
	speed: 0.0060s/iter; left time: 0.7429s
	iters: 500, epoch: 8 | loss: 0.4179026
	speed: 0.0057s/iter; left time: 0.1376s
Updating learning rate to 2.722627945859375e-05
Epoch: 8 cost time: 2.7470452785491943
Epoch: 8, Steps: 523 | Train Loss: 0.3527056 Vali Loss: 0.3626717 Best vali loss: 0.2834067

best validation loss 0.2834067462201276

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5865683
	speed: 0.0188s/iter; left time: 37.5346s
	iters: 200, epoch: 1 | loss: 0.3163627
	speed: 0.0125s/iter; left time: 23.6934s
Updating learning rate to 7.816451100430116e-05
Validation loss decreased (inf --> 0.2969).  Saving model state dict ...
Epoch: 1 cost time: 3.509847402572632
Epoch: 1, Steps: 262 | Train Loss: 0.4514655 Vali Loss: 0.2968861 Best vali loss: 0.2968861
	iters: 100, epoch: 2 | loss: 0.5343412
	speed: 0.0432s/iter; left time: 74.8832s
	iters: 200, epoch: 2 | loss: 0.4522585
	speed: 0.0111s/iter; left time: 18.1553s
Updating learning rate to 6.935733996265185e-05
Validation loss decreased (0.2969 --> 0.2851).  Saving model state dict ...
Epoch: 2 cost time: 3.1588213443756104
Epoch: 2, Steps: 262 | Train Loss: 0.4932999 Vali Loss: 0.2850799 Best vali loss: 0.2850799
	iters: 100, epoch: 3 | loss: 0.2677091
	speed: 0.0367s/iter; left time: 54.0538s
	iters: 200, epoch: 3 | loss: 0.2795342
	speed: 0.0117s/iter; left time: 16.0649s
Updating learning rate to 5.617647702893888e-05
Validation loss decreased (0.2851 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 2.8792495727539062
Epoch: 3, Steps: 262 | Train Loss: 0.2736217 Vali Loss: 0.2819383 Best vali loss: 0.2819383

best validation loss 0.2819383202010524

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020495993871, 'e_layers': 2, 'learning_rate': 0.0003425528357, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2868685
	speed: 0.0151s/iter; left time: 124.5124s
	iters: 200, epoch: 1 | loss: 0.2181867
	speed: 0.0103s/iter; left time: 84.4014s
	iters: 300, epoch: 1 | loss: 0.3266329
	speed: 0.0074s/iter; left time: 59.4695s
	iters: 400, epoch: 1 | loss: 1.7391994
	speed: 0.0049s/iter; left time: 39.3810s
	iters: 500, epoch: 1 | loss: 0.9075779
	speed: 0.0043s/iter; left time: 33.5753s
	iters: 600, epoch: 1 | loss: 0.3639265
	speed: 0.0061s/iter; left time: 47.7009s
	iters: 700, epoch: 1 | loss: 0.2279873
	speed: 0.0072s/iter; left time: 55.2584s
	iters: 800, epoch: 1 | loss: 0.2755124
	speed: 0.0069s/iter; left time: 52.3371s
	iters: 900, epoch: 1 | loss: 1.0498736
	speed: 0.0073s/iter; left time: 54.2604s
	iters: 1000, epoch: 1 | loss: 0.4402784
	speed: 0.0075s/iter; left time: 55.5169s
Updating learning rate to 0.0003295151947034658
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 7.715057849884033
Epoch: 1, Steps: 1045 | Train Loss: 0.5836043 Vali Loss: 0.2838977 Best vali loss: 0.2838977
	iters: 100, epoch: 2 | loss: 0.2652880
	speed: 0.0198s/iter; left time: 143.0127s
	iters: 200, epoch: 2 | loss: 0.3423506
	speed: 0.0051s/iter; left time: 36.2912s
	iters: 300, epoch: 2 | loss: 0.2684734
	speed: 0.0062s/iter; left time: 43.3944s
	iters: 400, epoch: 2 | loss: 0.4186321
	speed: 0.0085s/iter; left time: 58.6727s
	iters: 500, epoch: 2 | loss: 1.0596538
	speed: 0.0090s/iter; left time: 61.4915s
	iters: 600, epoch: 2 | loss: 0.9453465
	speed: 0.0079s/iter; left time: 53.0601s
	iters: 700, epoch: 2 | loss: 0.3103723
	speed: 0.0079s/iter; left time: 52.4233s
	iters: 800, epoch: 2 | loss: 0.3663380
	speed: 0.0087s/iter; left time: 56.6869s
	iters: 900, epoch: 2 | loss: 0.4474918
	speed: 0.0106s/iter; left time: 67.8621s
	iters: 1000, epoch: 2 | loss: 1.1790352
	speed: 0.0105s/iter; left time: 66.2920s
Updating learning rate to 0.0002923871343690756
Epoch: 2 cost time: 8.626768112182617
Epoch: 2, Steps: 1045 | Train Loss: 0.5602982 Vali Loss: 0.2952007 Best vali loss: 0.2838977
	iters: 100, epoch: 3 | loss: 0.3531688
	speed: 0.0363s/iter; left time: 223.8927s
	iters: 200, epoch: 3 | loss: 0.3851864
	speed: 0.0110s/iter; left time: 66.8400s
	iters: 300, epoch: 3 | loss: 0.4505078
	speed: 0.0090s/iter; left time: 53.5051s
	iters: 400, epoch: 3 | loss: 0.3588859
	speed: 0.0108s/iter; left time: 63.3520s
	iters: 500, epoch: 3 | loss: 1.5119385
	speed: 0.0094s/iter; left time: 54.1303s
	iters: 600, epoch: 3 | loss: 0.2666446
	speed: 0.0070s/iter; left time: 39.7707s
	iters: 700, epoch: 3 | loss: 0.9756201
	speed: 0.0110s/iter; left time: 61.3078s
	iters: 800, epoch: 3 | loss: 0.3043457
	speed: 0.0112s/iter; left time: 61.3115s
	iters: 900, epoch: 3 | loss: 1.0492527
	speed: 0.0104s/iter; left time: 55.8513s
	iters: 1000, epoch: 3 | loss: 0.3247916
	speed: 0.0111s/iter; left time: 58.4391s
Updating learning rate to 0.00023682106531603536
Epoch: 3 cost time: 10.690617084503174
Epoch: 3, Steps: 1045 | Train Loss: 0.5980342 Vali Loss: 0.2889036 Best vali loss: 0.2838977

best validation loss 0.2838976673917639

[INFO][smbo.py:320] Finished 650 trials.
{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.004979917171, 'e_layers': 1, 'learning_rate': 0.0008087573775, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4679678
	speed: 0.0168s/iter; left time: 68.5160s
	iters: 200, epoch: 1 | loss: 0.4843745
	speed: 0.0089s/iter; left time: 35.4045s
	iters: 300, epoch: 1 | loss: 0.2957244
	speed: 0.0103s/iter; left time: 40.0417s
	iters: 400, epoch: 1 | loss: 0.9014722
	speed: 0.0100s/iter; left time: 37.6698s
	iters: 500, epoch: 1 | loss: 0.3514265
	speed: 0.0076s/iter; left time: 28.0155s
Updating learning rate to 0.0008087573775
Validation loss decreased (inf --> 0.2771).  Saving model state dict ...
Epoch: 1 cost time: 5.19490647315979
Epoch: 1, Steps: 523 | Train Loss: 0.5001931 Vali Loss: 0.2770615 Best vali loss: 0.2770615
	iters: 100, epoch: 2 | loss: 0.9351708
	speed: 0.0231s/iter; left time: 82.1130s
	iters: 200, epoch: 2 | loss: 0.3897058
	speed: 0.0056s/iter; left time: 19.3077s
	iters: 300, epoch: 2 | loss: 0.4283829
	speed: 0.0054s/iter; left time: 18.1738s
	iters: 400, epoch: 2 | loss: 0.3319372
	speed: 0.0060s/iter; left time: 19.5962s
	iters: 500, epoch: 2 | loss: 0.6101402
	speed: 0.0064s/iter; left time: 20.0935s
Updating learning rate to 0.00040437868875
Epoch: 2 cost time: 3.2962965965270996
Epoch: 2, Steps: 523 | Train Loss: 0.5390674 Vali Loss: 0.2880122 Best vali loss: 0.2770615
	iters: 100, epoch: 3 | loss: 0.5993917
	speed: 0.0180s/iter; left time: 54.6201s
	iters: 200, epoch: 3 | loss: 0.3890486
	speed: 0.0060s/iter; left time: 17.5994s
	iters: 300, epoch: 3 | loss: 0.3452902
	speed: 0.0055s/iter; left time: 15.5680s
	iters: 400, epoch: 3 | loss: 0.3087756
	speed: 0.0053s/iter; left time: 14.5617s
	iters: 500, epoch: 3 | loss: 0.5381555
	speed: 0.0051s/iter; left time: 13.4417s
Updating learning rate to 0.000202189344375
Epoch: 3 cost time: 3.0128631591796875
Epoch: 3, Steps: 523 | Train Loss: 0.4361323 Vali Loss: 0.3085916 Best vali loss: 0.2770615

best validation loss 0.27706151904227255

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.004979917171, 'e_layers': 1, 'learning_rate': 0.0008087573775, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4403657
	speed: 0.0120s/iter; left time: 30.2505s
	iters: 200, epoch: 4 | loss: 0.4489650
	speed: 0.0055s/iter; left time: 13.3035s
	iters: 300, epoch: 4 | loss: 0.2720597
	speed: 0.0061s/iter; left time: 14.2156s
	iters: 400, epoch: 4 | loss: 0.6705085
	speed: 0.0061s/iter; left time: 13.6170s
	iters: 500, epoch: 4 | loss: 0.3301088
	speed: 0.0061s/iter; left time: 12.9415s
Updating learning rate to 0.0001010946721875
Epoch: 4 cost time: 3.4140641689300537
Epoch: 4, Steps: 523 | Train Loss: 0.4324015 Vali Loss: 0.3149124 Best vali loss: 0.2770615
	iters: 100, epoch: 5 | loss: 0.5114999
	speed: 0.0161s/iter; left time: 32.1132s
	iters: 200, epoch: 5 | loss: 0.3605068
	speed: 0.0056s/iter; left time: 10.6708s
	iters: 300, epoch: 5 | loss: 0.3801921
	speed: 0.0050s/iter; left time: 8.8836s
	iters: 400, epoch: 5 | loss: 0.2828133
	speed: 0.0045s/iter; left time: 7.6288s
	iters: 500, epoch: 5 | loss: 0.4938145
	speed: 0.0054s/iter; left time: 8.5502s
Updating learning rate to 5.054733609375e-05
Epoch: 5 cost time: 2.774750232696533
Epoch: 5, Steps: 523 | Train Loss: 0.4057654 Vali Loss: 0.3158005 Best vali loss: 0.2770615
	iters: 100, epoch: 6 | loss: 0.5226723
	speed: 0.0156s/iter; left time: 22.9755s
	iters: 200, epoch: 6 | loss: 0.3089274
	speed: 0.0065s/iter; left time: 8.8456s
	iters: 300, epoch: 6 | loss: 0.2764188
	speed: 0.0064s/iter; left time: 8.0940s
	iters: 400, epoch: 6 | loss: 0.2439094
	speed: 0.0064s/iter; left time: 7.4973s
	iters: 500, epoch: 6 | loss: 0.3316055
	speed: 0.0064s/iter; left time: 6.7966s
Updating learning rate to 2.5273668046875e-05
Epoch: 6 cost time: 3.3764970302581787
Epoch: 6, Steps: 523 | Train Loss: 0.3367067 Vali Loss: 0.3148892 Best vali loss: 0.2770615
	iters: 100, epoch: 7 | loss: 0.3461985
	speed: 0.0172s/iter; left time: 16.2949s
	iters: 200, epoch: 7 | loss: 0.2727782
	speed: 0.0062s/iter; left time: 5.2604s
	iters: 300, epoch: 7 | loss: 0.3348275
	speed: 0.0059s/iter; left time: 4.4122s
	iters: 400, epoch: 7 | loss: 0.3542832
	speed: 0.0063s/iter; left time: 4.1065s
	iters: 500, epoch: 7 | loss: 0.2950340
	speed: 0.0056s/iter; left time: 3.0852s
Updating learning rate to 1.26368340234375e-05
Epoch: 7 cost time: 3.187227725982666
Epoch: 7, Steps: 523 | Train Loss: 0.3206243 Vali Loss: 0.3164400 Best vali loss: 0.2770615
	iters: 100, epoch: 8 | loss: 0.2952005
	speed: 0.0139s/iter; left time: 5.8830s
	iters: 200, epoch: 8 | loss: 0.2352085
	speed: 0.0058s/iter; left time: 1.8836s
	iters: 300, epoch: 8 | loss: 0.2636685
	speed: 0.0057s/iter; left time: 1.2667s
	iters: 400, epoch: 8 | loss: 0.2402900
	speed: 0.0057s/iter; left time: 0.7080s
	iters: 500, epoch: 8 | loss: 0.3770036
	speed: 0.0057s/iter; left time: 0.1364s
Updating learning rate to 6.31841701171875e-06
Epoch: 8 cost time: 2.9585273265838623
Epoch: 8, Steps: 523 | Train Loss: 0.2822742 Vali Loss: 0.3191085 Best vali loss: 0.2770615

best validation loss 0.27706151904227255

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015818759144, 'e_layers': 1, 'learning_rate': 0.0015314213903, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4865724
	speed: 0.0135s/iter; left time: 12.7854s
Updating learning rate to 0.0014731351342240743
Validation loss decreased (inf --> 0.2890).  Saving model state dict ...
Epoch: 1 cost time: 1.2456705570220947
Epoch: 1, Steps: 131 | Train Loss: 0.4865724 Vali Loss: 0.2890356 Best vali loss: 0.2890356
	iters: 100, epoch: 2 | loss: 0.8245159
	speed: 0.0111s/iter; left time: 9.0740s
Updating learning rate to 0.0013071499201176302
Validation loss decreased (0.2890 --> 0.2879).  Saving model state dict ...
Epoch: 2 cost time: 0.8529753684997559
Epoch: 2, Steps: 131 | Train Loss: 0.8245159 Vali Loss: 0.2878505 Best vali loss: 0.2878505
	iters: 100, epoch: 3 | loss: 0.4229427
	speed: 0.0109s/iter; left time: 7.5212s
Updating learning rate to 0.001058735492168661
Epoch: 3 cost time: 0.7324097156524658
Epoch: 3, Steps: 131 | Train Loss: 0.4229427 Vali Loss: 0.2950345 Best vali loss: 0.2878505
	iters: 100, epoch: 4 | loss: 0.5191520
	speed: 0.0067s/iter; left time: 3.7281s
Updating learning rate to 0.00076571069515
Epoch: 4 cost time: 0.5291481018066406
Epoch: 4, Steps: 131 | Train Loss: 0.5191520 Vali Loss: 0.2882566 Best vali loss: 0.2878505
	iters: 100, epoch: 5 | loss: 0.4118310
	speed: 0.0103s/iter; left time: 4.3875s
Updating learning rate to 0.00047268589813133913
Epoch: 5 cost time: 0.8633618354797363
Epoch: 5, Steps: 131 | Train Loss: 0.4118310 Vali Loss: 0.3000260 Best vali loss: 0.2878505
	iters: 100, epoch: 6 | loss: 0.5141200
	speed: 0.0124s/iter; left time: 3.6487s
Updating learning rate to 0.0002242714701823698
Epoch: 6 cost time: 0.9632143974304199
Epoch: 6, Steps: 131 | Train Loss: 0.5141200 Vali Loss: 0.2969689 Best vali loss: 0.2878505
	iters: 100, epoch: 7 | loss: 0.5126334
	speed: 0.0118s/iter; left time: 1.9197s
Updating learning rate to 5.8286256075925605e-05
Epoch: 7 cost time: 0.9483358860015869
Epoch: 7, Steps: 131 | Train Loss: 0.5126334 Vali Loss: 0.2987718 Best vali loss: 0.2878505
	iters: 100, epoch: 8 | loss: 0.4185190
	speed: 0.0132s/iter; left time: 0.4232s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1343121528625488
Epoch: 8, Steps: 131 | Train Loss: 0.4185190 Vali Loss: 0.3001198 Best vali loss: 0.2878505

best validation loss 0.2878505438843284

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0059015306418, 'e_layers': 2, 'learning_rate': 0.0002819700447, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2759651
	speed: 0.0184s/iter; left time: 151.7949s
	iters: 200, epoch: 1 | loss: 0.2981522
	speed: 0.0124s/iter; left time: 101.5536s
	iters: 300, epoch: 1 | loss: 1.3290023
	speed: 0.0105s/iter; left time: 84.6261s
	iters: 400, epoch: 1 | loss: 0.2738416
	speed: 0.0128s/iter; left time: 102.1765s
	iters: 500, epoch: 1 | loss: 0.8735908
	speed: 0.0103s/iter; left time: 80.8520s
	iters: 600, epoch: 1 | loss: 0.9443303
	speed: 0.0124s/iter; left time: 96.0332s
	iters: 700, epoch: 1 | loss: 0.4589722
	speed: 0.0129s/iter; left time: 98.9336s
	iters: 800, epoch: 1 | loss: 0.2036781
	speed: 0.0111s/iter; left time: 84.2499s
	iters: 900, epoch: 1 | loss: 0.4752760
	speed: 0.0119s/iter; left time: 88.9812s
	iters: 1000, epoch: 1 | loss: 0.3536663
	speed: 0.0098s/iter; left time: 72.3844s
Updating learning rate to 0.0002712381988898113
Validation loss decreased (inf --> 0.2886).  Saving model state dict ...
Epoch: 1 cost time: 12.203131675720215
Epoch: 1, Steps: 1045 | Train Loss: 0.5486475 Vali Loss: 0.2886339 Best vali loss: 0.2886339
	iters: 100, epoch: 2 | loss: 0.3346435
	speed: 0.0214s/iter; left time: 154.0858s
	iters: 200, epoch: 2 | loss: 0.2870881
	speed: 0.0066s/iter; left time: 47.1285s
	iters: 300, epoch: 2 | loss: 0.5202646
	speed: 0.0065s/iter; left time: 45.9034s
	iters: 400, epoch: 2 | loss: 0.5170032
	speed: 0.0064s/iter; left time: 44.2205s
	iters: 500, epoch: 2 | loss: 1.2134364
	speed: 0.0069s/iter; left time: 47.0066s
	iters: 600, epoch: 2 | loss: 0.5945612
	speed: 0.0053s/iter; left time: 35.9024s
	iters: 700, epoch: 2 | loss: 0.7489523
	speed: 0.0064s/iter; left time: 42.6640s
	iters: 800, epoch: 2 | loss: 0.4869068
	speed: 0.0058s/iter; left time: 37.8780s
	iters: 900, epoch: 2 | loss: 0.3649584
	speed: 0.0069s/iter; left time: 44.1888s
	iters: 1000, epoch: 2 | loss: 0.9477917
	speed: 0.0083s/iter; left time: 52.3552s
Updating learning rate to 0.00024067648769942194
Epoch: 2 cost time: 6.9574689865112305
Epoch: 2, Steps: 1045 | Train Loss: 0.6015606 Vali Loss: 0.2897825 Best vali loss: 0.2886339
	iters: 100, epoch: 3 | loss: 0.1779283
	speed: 0.0242s/iter; left time: 149.2068s
	iters: 200, epoch: 3 | loss: 0.3961985
	speed: 0.0058s/iter; left time: 35.0268s
	iters: 300, epoch: 3 | loss: 0.1816425
	speed: 0.0068s/iter; left time: 40.4753s
	iters: 400, epoch: 3 | loss: 0.3849679
	speed: 0.0058s/iter; left time: 34.0640s
	iters: 500, epoch: 3 | loss: 0.3334823
	speed: 0.0073s/iter; left time: 42.1697s
	iters: 600, epoch: 3 | loss: 0.4916860
	speed: 0.0070s/iter; left time: 39.8448s
	iters: 700, epoch: 3 | loss: 0.4356751
	speed: 0.0057s/iter; left time: 31.9631s
	iters: 800, epoch: 3 | loss: 1.4159585
	speed: 0.0051s/iter; left time: 27.9508s
	iters: 900, epoch: 3 | loss: 1.1255665
	speed: 0.0052s/iter; left time: 27.9905s
	iters: 1000, epoch: 3 | loss: 0.9369163
	speed: 0.0059s/iter; left time: 31.0811s
Updating learning rate to 0.0001949376546149669
Epoch: 3 cost time: 6.5111565589904785
Epoch: 3, Steps: 1045 | Train Loss: 0.5880022 Vali Loss: 0.2908459 Best vali loss: 0.2886339
	iters: 100, epoch: 4 | loss: 0.2544344
	speed: 0.0238s/iter; left time: 121.8263s
	iters: 200, epoch: 4 | loss: 0.4600208
	speed: 0.0072s/iter; left time: 36.0852s
	iters: 300, epoch: 4 | loss: 1.1194087
	speed: 0.0072s/iter; left time: 35.6576s
	iters: 400, epoch: 4 | loss: 0.9743385
	speed: 0.0073s/iter; left time: 35.1618s
	iters: 500, epoch: 4 | loss: 0.3856458
	speed: 0.0063s/iter; left time: 29.8856s
	iters: 600, epoch: 4 | loss: 0.3328245
	speed: 0.0064s/iter; left time: 29.5103s
	iters: 700, epoch: 4 | loss: 0.2165813
	speed: 0.0067s/iter; left time: 30.3612s
	iters: 800, epoch: 4 | loss: 0.7605839
	speed: 0.0071s/iter; left time: 31.2923s
	iters: 900, epoch: 4 | loss: 0.1628027
	speed: 0.0064s/iter; left time: 27.8650s
	iters: 1000, epoch: 4 | loss: 0.3833359
	speed: 0.0065s/iter; left time: 27.2915s
Updating learning rate to 0.00014098502235
Epoch: 4 cost time: 7.083770036697388
Epoch: 4, Steps: 1045 | Train Loss: 0.5049977 Vali Loss: 0.3014467 Best vali loss: 0.2886339
	iters: 100, epoch: 5 | loss: 0.4306687
	speed: 0.0252s/iter; left time: 102.9366s
	iters: 200, epoch: 5 | loss: 0.9141646
	speed: 0.0071s/iter; left time: 28.1769s
	iters: 300, epoch: 5 | loss: 0.3051512
	speed: 0.0070s/iter; left time: 27.0317s
	iters: 400, epoch: 5 | loss: 0.3711525
	speed: 0.0064s/iter; left time: 24.0582s
	iters: 500, epoch: 5 | loss: 0.2475440
	speed: 0.0050s/iter; left time: 18.4556s
	iters: 600, epoch: 5 | loss: 0.2782895
	speed: 0.0055s/iter; left time: 19.5836s
	iters: 700, epoch: 5 | loss: 0.1914106
	speed: 0.0064s/iter; left time: 22.2642s
	iters: 800, epoch: 5 | loss: 0.1502315
	speed: 0.0063s/iter; left time: 21.2724s
	iters: 900, epoch: 5 | loss: 0.5055643
	speed: 0.0069s/iter; left time: 22.5051s
	iters: 1000, epoch: 5 | loss: 0.2424321
	speed: 0.0069s/iter; left time: 22.0837s
Updating learning rate to 8.703239008503311e-05
Epoch: 5 cost time: 6.819543361663818
Epoch: 5, Steps: 1045 | Train Loss: 0.3636609 Vali Loss: 0.3029509 Best vali loss: 0.2886339
	iters: 100, epoch: 6 | loss: 0.3226714
	speed: 0.0245s/iter; left time: 74.5050s
	iters: 200, epoch: 6 | loss: 0.2207286
	speed: 0.0069s/iter; left time: 20.3135s
	iters: 300, epoch: 6 | loss: 0.2303325
	speed: 0.0064s/iter; left time: 18.2313s
	iters: 400, epoch: 6 | loss: 0.3396293
	speed: 0.0063s/iter; left time: 17.1001s
	iters: 500, epoch: 6 | loss: 0.5772008
	speed: 0.0062s/iter; left time: 16.4100s
	iters: 600, epoch: 6 | loss: 0.3912785
	speed: 0.0059s/iter; left time: 14.8937s
	iters: 700, epoch: 6 | loss: 0.1577954
	speed: 0.0077s/iter; left time: 18.8512s
	iters: 800, epoch: 6 | loss: 0.8177821
	speed: 0.0080s/iter; left time: 18.7000s
	iters: 900, epoch: 6 | loss: 0.2116866
	speed: 0.0080s/iter; left time: 17.9413s
	iters: 1000, epoch: 6 | loss: 0.3601210
	speed: 0.0074s/iter; left time: 15.8140s
Updating learning rate to 4.1293557000578045e-05
Epoch: 6 cost time: 7.272829532623291
Epoch: 6, Steps: 1045 | Train Loss: 0.3629226 Vali Loss: 0.3098110 Best vali loss: 0.2886339
	iters: 100, epoch: 7 | loss: 0.3579047
	speed: 0.0246s/iter; left time: 48.9707s
	iters: 200, epoch: 7 | loss: 0.2034819
	speed: 0.0068s/iter; left time: 12.7906s
	iters: 300, epoch: 7 | loss: 0.2200834
	speed: 0.0066s/iter; left time: 11.8182s
	iters: 400, epoch: 7 | loss: 0.6903522
	speed: 0.0074s/iter; left time: 12.5031s
	iters: 500, epoch: 7 | loss: 0.3009410
	speed: 0.0076s/iter; left time: 12.0508s
	iters: 600, epoch: 7 | loss: 0.2617022
	speed: 0.0071s/iter; left time: 10.6440s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.002494449903, 'e_layers': 1, 'learning_rate': 0.0001324520622, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8279141
	speed: 0.0105s/iter; left time: 42.9104s
	iters: 200, epoch: 1 | loss: 0.3744421
	speed: 0.0038s/iter; left time: 15.1597s
	iters: 300, epoch: 1 | loss: 0.9008714
	speed: 0.0042s/iter; left time: 16.1455s
	iters: 400, epoch: 1 | loss: 0.4014734
	speed: 0.0045s/iter; left time: 16.9939s
	iters: 500, epoch: 1 | loss: 0.3263324
	speed: 0.0045s/iter; left time: 16.5108s
Updating learning rate to 0.00012741090575274595
Validation loss decreased (inf --> 0.2909).  Saving model state dict ...
Epoch: 1 cost time: 2.5394816398620605
Epoch: 1, Steps: 523 | Train Loss: 0.5662067 Vali Loss: 0.2908584 Best vali loss: 0.2908584
	iters: 100, epoch: 2 | loss: 1.0179613
	speed: 0.0127s/iter; left time: 45.2914s
	iters: 200, epoch: 2 | loss: 0.3187214
	speed: 0.0046s/iter; left time: 15.7926s
	iters: 300, epoch: 2 | loss: 0.4096431
	speed: 0.0044s/iter; left time: 14.7272s
	iters: 400, epoch: 2 | loss: 1.3385009
	speed: 0.0044s/iter; left time: 14.3473s
	iters: 500, epoch: 2 | loss: 0.2957196
	speed: 0.0047s/iter; left time: 14.9530s
Updating learning rate to 0.0001130549067818812
Validation loss decreased (0.2909 --> 0.2822).  Saving model state dict ...
Epoch: 2 cost time: 2.439664602279663
Epoch: 2, Steps: 523 | Train Loss: 0.6761092 Vali Loss: 0.2821914 Best vali loss: 0.2821914
	iters: 100, epoch: 3 | loss: 0.7404668
	speed: 0.0128s/iter; left time: 38.8366s
	iters: 200, epoch: 3 | loss: 0.4204253
	speed: 0.0046s/iter; left time: 13.6192s
	iters: 300, epoch: 3 | loss: 1.0292314
	speed: 0.0046s/iter; left time: 13.1922s
	iters: 400, epoch: 3 | loss: 0.7227665
	speed: 0.0047s/iter; left time: 12.8144s
	iters: 500, epoch: 3 | loss: 0.7153265
	speed: 0.0048s/iter; left time: 12.6521s
Updating learning rate to 9.156963599326519e-05
Epoch: 3 cost time: 2.489245653152466
Epoch: 3, Steps: 523 | Train Loss: 0.7256433 Vali Loss: 0.2851221 Best vali loss: 0.2821914

best validation loss 0.2821913650595331

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0038661493844, 'e_layers': 1, 'learning_rate': 0.000881665179, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3826565
	speed: 0.0138s/iter; left time: 13.1098s
Updating learning rate to 0.000881665179
Validation loss decreased (inf --> 0.2795).  Saving model state dict ...
Epoch: 1 cost time: 1.3319110870361328
Epoch: 1, Steps: 131 | Train Loss: 0.3826565 Vali Loss: 0.2795460 Best vali loss: 0.2795460
	iters: 100, epoch: 2 | loss: 0.4918541
	speed: 0.0139s/iter; left time: 11.3814s
Updating learning rate to 0.0004408325895
Epoch: 2 cost time: 1.018087387084961
Epoch: 2, Steps: 131 | Train Loss: 0.4918541 Vali Loss: 0.2816358 Best vali loss: 0.2795460
	iters: 100, epoch: 3 | loss: 0.3720550
	speed: 0.0137s/iter; left time: 9.4148s
Updating learning rate to 0.00022041629475
Epoch: 3 cost time: 1.0298004150390625
Epoch: 3, Steps: 131 | Train Loss: 0.3720550 Vali Loss: 0.2832034 Best vali loss: 0.2795460

best validation loss 0.2795460210297798

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0017509389826, 'e_layers': 2, 'learning_rate': 0.0003051912274, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8147883
	speed: 0.0176s/iter; left time: 16.6784s
Updating learning rate to 0.0003051912274
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 1.7367496490478516
Epoch: 1, Steps: 131 | Train Loss: 0.8147883 Vali Loss: 0.2884355 Best vali loss: 0.2884355
	iters: 100, epoch: 2 | loss: 0.4168797
	speed: 0.0157s/iter; left time: 12.8471s
Updating learning rate to 0.0001525956137
Validation loss decreased (0.2884 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 1.2732784748077393
Epoch: 2, Steps: 131 | Train Loss: 0.4168797 Vali Loss: 0.2810112 Best vali loss: 0.2810112
	iters: 100, epoch: 3 | loss: 0.5278803
	speed: 0.0157s/iter; left time: 10.7791s
Updating learning rate to 7.629780685e-05
Validation loss decreased (0.2810 --> 0.2807).  Saving model state dict ...
Epoch: 3 cost time: 1.2224066257476807
Epoch: 3, Steps: 131 | Train Loss: 0.5278803 Vali Loss: 0.2806620 Best vali loss: 0.2806620

best validation loss 0.280662009699631

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0038661493844, 'e_layers': 1, 'learning_rate': 0.000881665179, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3851761
	speed: 0.0181s/iter; left time: 10.0624s
Updating learning rate to 0.000110208147375
Epoch: 4 cost time: 1.7395250797271729
Epoch: 4, Steps: 131 | Train Loss: 0.3851761 Vali Loss: 0.2840739 Best vali loss: 0.2795460
	iters: 100, epoch: 5 | loss: 0.4894970
	speed: 0.0141s/iter; left time: 6.0120s
Updating learning rate to 5.51040736875e-05
Epoch: 5 cost time: 1.0550928115844727
Epoch: 5, Steps: 131 | Train Loss: 0.4894970 Vali Loss: 0.2846960 Best vali loss: 0.2795460
	iters: 100, epoch: 6 | loss: 0.3580759
	speed: 0.0130s/iter; left time: 3.8275s
Updating learning rate to 2.755203684375e-05
Epoch: 6 cost time: 0.954878568649292
Epoch: 6, Steps: 131 | Train Loss: 0.3580759 Vali Loss: 0.2847525 Best vali loss: 0.2795460
	iters: 100, epoch: 7 | loss: 0.3316639
	speed: 0.0133s/iter; left time: 2.1647s
Updating learning rate to 1.3776018421875e-05
Epoch: 7 cost time: 1.0546627044677734
Epoch: 7, Steps: 131 | Train Loss: 0.3316639 Vali Loss: 0.2849004 Best vali loss: 0.2795460
	iters: 100, epoch: 8 | loss: 0.2512009
	speed: 0.0129s/iter; left time: 0.4112s
Updating learning rate to 6.8880092109375e-06
Epoch: 8 cost time: 1.0308279991149902
Epoch: 8, Steps: 131 | Train Loss: 0.2512009 Vali Loss: 0.2850860 Best vali loss: 0.2795460

best validation loss 0.2795460210297798

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008649634073, 'e_layers': 1, 'learning_rate': 0.0002330475245, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5144249
	speed: 0.0126s/iter; left time: 25.2607s
	iters: 200, epoch: 1 | loss: 0.3120288
	speed: 0.0069s/iter; left time: 13.0073s
Updating learning rate to 0.0002330475245
Validation loss decreased (inf --> 0.3036).  Saving model state dict ...
Epoch: 1 cost time: 1.9448070526123047
Epoch: 1, Steps: 262 | Train Loss: 0.4132269 Vali Loss: 0.3035957 Best vali loss: 0.3035957
	iters: 100, epoch: 2 | loss: 0.5266981
	speed: 0.0161s/iter; left time: 28.0117s
	iters: 200, epoch: 2 | loss: 0.5207147
	speed: 0.0075s/iter; left time: 12.2339s
Updating learning rate to 0.00011652376225
Validation loss decreased (0.3036 --> 0.2883).  Saving model state dict ...
Epoch: 2 cost time: 2.1031579971313477
Epoch: 2, Steps: 262 | Train Loss: 0.5237064 Vali Loss: 0.2882705 Best vali loss: 0.2882705
	iters: 100, epoch: 3 | loss: 0.6613896
	speed: 0.0238s/iter; left time: 35.1304s
	iters: 200, epoch: 3 | loss: 0.6419882
	speed: 0.0085s/iter; left time: 11.6673s
Updating learning rate to 5.8261881125e-05
Validation loss decreased (0.2883 --> 0.2847).  Saving model state dict ...
Epoch: 3 cost time: 2.19097900390625
Epoch: 3, Steps: 262 | Train Loss: 0.6516889 Vali Loss: 0.2847050 Best vali loss: 0.2847050
	iters: 100, epoch: 4 | loss: 0.6550270
	speed: 0.0211s/iter; left time: 25.5282s
	iters: 200, epoch: 4 | loss: 0.8294882
	speed: 0.0072s/iter; left time: 8.0356s
Updating learning rate to 2.91309405625e-05
Validation loss decreased (0.2847 --> 0.2834).  Saving model state dict ...
Epoch: 4 cost time: 2.009019136428833
Epoch: 4, Steps: 262 | Train Loss: 0.7422576 Vali Loss: 0.2834269 Best vali loss: 0.2834269
	iters: 100, epoch: 5 | loss: 0.4230724
	speed: 0.0162s/iter; left time: 15.3425s
	iters: 200, epoch: 5 | loss: 0.5509434
	speed: 0.0045s/iter; left time: 3.8508s
Updating learning rate to 1.456547028125e-05
Validation loss decreased (0.2834 --> 0.2829).  Saving model state dict ...
Epoch: 5 cost time: 1.3310492038726807
Epoch: 5, Steps: 262 | Train Loss: 0.4870079 Vali Loss: 0.2829047 Best vali loss: 0.2829047
	iters: 100, epoch: 6 | loss: 0.3692200
	speed: 0.0123s/iter; left time: 8.4532s
	iters: 200, epoch: 6 | loss: 0.3697570
	speed: 0.0048s/iter; left time: 2.8281s
Updating learning rate to 7.282735140625e-06
Validation loss decreased (0.2829 --> 0.2827).  Saving model state dict ...
Epoch: 6 cost time: 1.335150957107544
Epoch: 6, Steps: 262 | Train Loss: 0.3694885 Vali Loss: 0.2827175 Best vali loss: 0.2827175
	iters: 100, epoch: 7 | loss: 0.2466778
	speed: 0.0172s/iter; left time: 7.2922s
	iters: 200, epoch: 7 | loss: 0.7195819
	speed: 0.0054s/iter; left time: 1.7646s
Updating learning rate to 3.6413675703125e-06
Validation loss decreased (0.2827 --> 0.2826).  Saving model state dict ...
Epoch: 7 cost time: 1.4457435607910156
Epoch: 7, Steps: 262 | Train Loss: 0.4831298 Vali Loss: 0.2826056 Best vali loss: 0.2826056
	iters: 100, epoch: 8 | loss: 0.6435980
	speed: 0.0186s/iter; left time: 3.0262s
	iters: 200, epoch: 8 | loss: 0.5961511
	speed: 0.0065s/iter; left time: 0.4105s
Updating learning rate to 1.82068378515625e-06
Validation loss decreased (0.2826 --> 0.2826).  Saving model state dict ...
Epoch: 8 cost time: 1.7906270027160645
Epoch: 8, Steps: 262 | Train Loss: 0.6198745 Vali Loss: 0.2825545 Best vali loss: 0.2825545

best validation loss 0.2825545043157751

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0017482993331, 'e_layers': 3, 'learning_rate': 0.0003753033906, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4127230
	speed: 0.0180s/iter; left time: 17.0511s
Updating learning rate to 0.0003753033906
Validation loss decreased (inf --> 0.2791).  Saving model state dict ...
Epoch: 1 cost time: 1.834216833114624
Epoch: 1, Steps: 131 | Train Loss: 0.4127230 Vali Loss: 0.2790828 Best vali loss: 0.2790828
	iters: 100, epoch: 2 | loss: 0.4461320
	speed: 0.0276s/iter; left time: 22.6050s
Updating learning rate to 0.0001876516953
Epoch: 2 cost time: 2.5332725048065186
Epoch: 2, Steps: 131 | Train Loss: 0.4461320 Vali Loss: 0.2887420 Best vali loss: 0.2790828
	iters: 100, epoch: 3 | loss: 0.3745068
	speed: 0.0278s/iter; left time: 19.1020s
Updating learning rate to 9.382584765e-05
Epoch: 3 cost time: 1.6005029678344727
Epoch: 3, Steps: 131 | Train Loss: 0.3745068 Vali Loss: 0.2851281 Best vali loss: 0.2790828
	iters: 100, epoch: 4 | loss: 0.4309456
	speed: 0.0221s/iter; left time: 12.2760s
Updating learning rate to 4.6912923825e-05
Epoch: 4 cost time: 1.8488245010375977
Epoch: 4, Steps: 131 | Train Loss: 0.4309456 Vali Loss: 0.2852287 Best vali loss: 0.2790828
	iters: 100, epoch: 5 | loss: 0.2806150
	speed: 0.0208s/iter; left time: 8.8261s
Updating learning rate to 2.34564619125e-05
Epoch: 5 cost time: 1.634037733078003
Epoch: 5, Steps: 131 | Train Loss: 0.2806150 Vali Loss: 0.2871542 Best vali loss: 0.2790828
	iters: 100, epoch: 6 | loss: 0.4790320
	speed: 0.0226s/iter; left time: 6.6372s
Updating learning rate to 1.172823095625e-05
Epoch: 6 cost time: 1.807807445526123
Epoch: 6, Steps: 131 | Train Loss: 0.4790320 Vali Loss: 0.2886976 Best vali loss: 0.2790828
	iters: 100, epoch: 7 | loss: 0.4019017
	speed: 0.0213s/iter; left time: 3.4686s
Updating learning rate to 5.864115478125e-06
Epoch: 7 cost time: 1.4814157485961914
Epoch: 7, Steps: 131 | Train Loss: 0.4019017 Vali Loss: 0.2916724 Best vali loss: 0.2790828
	iters: 100, epoch: 8 | loss: 0.3488711
	speed: 0.0278s/iter; left time: 0.8884s
Updating learning rate to 2.9320577390625e-06
Epoch: 8 cost time: 2.3329968452453613
Epoch: 8, Steps: 131 | Train Loss: 0.3488711 Vali Loss: 0.2922208 Best vali loss: 0.2790828

best validation loss 0.279082814898576

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011451608733, 'e_layers': 1, 'learning_rate': 0.0031528586887, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6551233
	speed: 0.0114s/iter; left time: 93.8477s
	iters: 200, epoch: 1 | loss: 0.3991213
	speed: 0.0040s/iter; left time: 32.6712s
	iters: 300, epoch: 1 | loss: 0.7225344
	speed: 0.0043s/iter; left time: 34.3723s
	iters: 400, epoch: 1 | loss: 0.3662308
	speed: 0.0044s/iter; left time: 34.8701s
	iters: 500, epoch: 1 | loss: 0.2491229
	speed: 0.0040s/iter; left time: 31.8266s
	iters: 600, epoch: 1 | loss: 0.2717302
	speed: 0.0044s/iter; left time: 34.3954s
	iters: 700, epoch: 1 | loss: 0.3061978
	speed: 0.0041s/iter; left time: 31.1504s
	iters: 800, epoch: 1 | loss: 0.4287367
	speed: 0.0035s/iter; left time: 26.6631s
	iters: 900, epoch: 1 | loss: 0.4026351
	speed: 0.0031s/iter; left time: 22.9399s
	iters: 1000, epoch: 1 | loss: 0.3796457
	speed: 0.0028s/iter; left time: 20.8761s
Updating learning rate to 0.003032860150045152
Validation loss decreased (inf --> 0.3188).  Saving model state dict ...
Epoch: 1 cost time: 4.39829683303833
Epoch: 1, Steps: 1045 | Train Loss: 0.4181078 Vali Loss: 0.3187531 Best vali loss: 0.3187531
	iters: 100, epoch: 2 | loss: 0.5248990
	speed: 0.0143s/iter; left time: 103.4893s
	iters: 200, epoch: 2 | loss: 0.2603472
	speed: 0.0063s/iter; left time: 45.1568s
	iters: 300, epoch: 2 | loss: 0.9652975
	speed: 0.0066s/iter; left time: 46.3824s
	iters: 400, epoch: 2 | loss: 0.9459743
	speed: 0.0063s/iter; left time: 43.7112s
	iters: 500, epoch: 2 | loss: 0.2998728
	speed: 0.0069s/iter; left time: 47.2710s
	iters: 600, epoch: 2 | loss: 0.4052663
	speed: 0.0057s/iter; left time: 38.4099s
	iters: 700, epoch: 2 | loss: 0.3376074
	speed: 0.0067s/iter; left time: 44.3626s
	iters: 800, epoch: 2 | loss: 0.4227149
	speed: 0.0044s/iter; left time: 28.8672s
	iters: 900, epoch: 2 | loss: 0.5929533
	speed: 0.0033s/iter; left time: 21.2024s
	iters: 1000, epoch: 2 | loss: 0.5067627
	speed: 0.0068s/iter; left time: 42.8593s
Updating learning rate to 0.0026911332238013477
Validation loss decreased (0.3188 --> 0.3172).  Saving model state dict ...
Epoch: 2 cost time: 5.984996318817139
Epoch: 2, Steps: 1045 | Train Loss: 0.5261695 Vali Loss: 0.3172246 Best vali loss: 0.3172246
	iters: 100, epoch: 3 | loss: 0.5492265
	speed: 0.0235s/iter; left time: 145.0577s
	iters: 200, epoch: 3 | loss: 0.3530563
	speed: 0.0069s/iter; left time: 41.8249s
	iters: 300, epoch: 3 | loss: 0.2869990
	speed: 0.0052s/iter; left time: 31.2460s
	iters: 400, epoch: 3 | loss: 0.3844359
	speed: 0.0034s/iter; left time: 20.0297s
	iters: 500, epoch: 3 | loss: 2.1518047
	speed: 0.0063s/iter; left time: 36.4846s
	iters: 600, epoch: 3 | loss: 0.1910688
	speed: 0.0062s/iter; left time: 35.1927s
	iters: 700, epoch: 3 | loss: 0.4536294
	speed: 0.0044s/iter; left time: 24.4761s
	iters: 800, epoch: 3 | loss: 0.5027884
	speed: 0.0049s/iter; left time: 26.6549s
	iters: 900, epoch: 3 | loss: 0.5807941
	speed: 0.0054s/iter; left time: 29.0384s
	iters: 1000, epoch: 3 | loss: 0.8456436
	speed: 0.0052s/iter; left time: 27.3713s
Updating learning rate to 0.002179702736726906
Epoch: 3 cost time: 5.55443263053894
Epoch: 3, Steps: 1045 | Train Loss: 0.6299447 Vali Loss: 0.3193777 Best vali loss: 0.3172246

best validation loss 0.31722460192856444

[INFO][smbo.py:328] Configuration budget is exhausted:
[INFO][smbo.py:329] --- Remaining wallclock time: -16.394575834274292
[INFO][smbo.py:330] --- Remaining cpu time: inf
[INFO][smbo.py:331] --- Remaining trials: 839
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.003098386677, 'e_layers': 1, 'learning_rate': 0.0005, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5937442
	speed: 0.0106s/iter; left time: 87.5238s
	iters: 200, epoch: 1 | loss: 0.3817097
	speed: 0.0035s/iter; left time: 28.3527s
	iters: 300, epoch: 1 | loss: 0.6554315
	speed: 0.0038s/iter; left time: 30.5451s
	iters: 400, epoch: 1 | loss: 0.3212048
	speed: 0.0039s/iter; left time: 31.1272s
	iters: 500, epoch: 1 | loss: 0.3361108
	speed: 0.0030s/iter; left time: 23.4101s
	iters: 600, epoch: 1 | loss: 0.5185102
	speed: 0.0039s/iter; left time: 30.5246s
	iters: 700, epoch: 1 | loss: 0.3716597
	speed: 0.0042s/iter; left time: 32.1633s
	iters: 800, epoch: 1 | loss: 1.2683676
	speed: 0.0036s/iter; left time: 27.2835s
	iters: 900, epoch: 1 | loss: 0.4614779
	speed: 0.0029s/iter; left time: 21.8148s
	iters: 1000, epoch: 1 | loss: 0.3256660
	speed: 0.0029s/iter; left time: 21.4257s
Updating learning rate to 0.0004809698831278217
Validation loss decreased (inf --> 0.2826).  Saving model state dict ...
Epoch: 1 cost time: 4.0204551219940186
Epoch: 1, Steps: 1045 | Train Loss: 0.5233882 Vali Loss: 0.2826106 Best vali loss: 0.2826106
	iters: 100, epoch: 2 | loss: 0.5273076
	speed: 0.0168s/iter; left time: 120.9136s
	iters: 200, epoch: 2 | loss: 0.9730043
	speed: 0.0040s/iter; left time: 28.2762s
	iters: 300, epoch: 2 | loss: 0.2456573
	speed: 0.0041s/iter; left time: 29.0825s
	iters: 400, epoch: 2 | loss: 0.2525396
	speed: 0.0027s/iter; left time: 18.8589s
	iters: 500, epoch: 2 | loss: 0.5172208
	speed: 0.0039s/iter; left time: 26.7346s
	iters: 600, epoch: 2 | loss: 0.3085492
	speed: 0.0040s/iter; left time: 27.0793s
	iters: 700, epoch: 2 | loss: 0.3414644
	speed: 0.0037s/iter; left time: 24.6419s
	iters: 800, epoch: 2 | loss: 0.4410809
	speed: 0.0037s/iter; left time: 24.0562s
	iters: 900, epoch: 2 | loss: 0.4771705
	speed: 0.0041s/iter; left time: 26.3468s
	iters: 1000, epoch: 2 | loss: 0.3338618
	speed: 0.0040s/iter; left time: 25.3100s
Updating learning rate to 0.00042677669529663686
Epoch: 2 cost time: 4.022505044937134
Epoch: 2, Steps: 1045 | Train Loss: 0.4417856 Vali Loss: 0.2831361 Best vali loss: 0.2826106
	iters: 100, epoch: 3 | loss: 0.8348846
	speed: 0.0159s/iter; left time: 98.3220s
	iters: 200, epoch: 3 | loss: 0.2824008
	speed: 0.0024s/iter; left time: 14.6354s
	iters: 300, epoch: 3 | loss: 0.6686269
	speed: 0.0029s/iter; left time: 17.2273s
	iters: 400, epoch: 3 | loss: 1.0816137
	speed: 0.0047s/iter; left time: 27.4986s
	iters: 500, epoch: 3 | loss: 0.7581303
	speed: 0.0041s/iter; left time: 23.5038s
	iters: 600, epoch: 3 | loss: 0.2614855
	speed: 0.0040s/iter; left time: 22.7451s
	iters: 700, epoch: 3 | loss: 0.3589197
	speed: 0.0049s/iter; left time: 27.0435s
	iters: 800, epoch: 3 | loss: 0.3037363
	speed: 0.0044s/iter; left time: 24.0036s
	iters: 900, epoch: 3 | loss: 0.4209145
	speed: 0.0038s/iter; left time: 20.5677s
	iters: 1000, epoch: 3 | loss: 0.6652764
	speed: 0.0046s/iter; left time: 24.4491s
Updating learning rate to 0.0003456708580912725
Epoch: 3 cost time: 4.105319261550903
Epoch: 3, Steps: 1045 | Train Loss: 0.5635989 Vali Loss: 0.2827841 Best vali loss: 0.2826106
	iters: 100, epoch: 4 | loss: 0.2567467
	speed: 0.0170s/iter; left time: 87.3110s
	iters: 200, epoch: 4 | loss: 0.4531777
	speed: 0.0026s/iter; left time: 12.9324s
	iters: 300, epoch: 4 | loss: 1.8263042
	speed: 0.0027s/iter; left time: 13.2435s
	iters: 400, epoch: 4 | loss: 0.4024292
	speed: 0.0029s/iter; left time: 14.0453s
	iters: 500, epoch: 4 | loss: 1.0532186
	speed: 0.0052s/iter; left time: 24.4060s
	iters: 600, epoch: 4 | loss: 0.5830844
	speed: 0.0043s/iter; left time: 19.8163s
	iters: 700, epoch: 4 | loss: 0.3304062
	speed: 0.0048s/iter; left time: 21.5535s
	iters: 800, epoch: 4 | loss: 0.3453764
	speed: 0.0055s/iter; left time: 24.2902s
	iters: 900, epoch: 4 | loss: 0.2444883
	speed: 0.0054s/iter; left time: 23.2618s
	iters: 1000, epoch: 4 | loss: 0.4101499
	speed: 0.0042s/iter; left time: 17.6115s
Updating learning rate to 0.00025
Epoch: 4 cost time: 4.514033794403076
Epoch: 4, Steps: 1045 | Train Loss: 0.5905382 Vali Loss: 0.2884849 Best vali loss: 0.2826106
	iters: 100, epoch: 5 | loss: 0.2307371
	speed: 0.0207s/iter; left time: 84.6788s
	iters: 200, epoch: 5 | loss: 0.2151408
	speed: 0.0036s/iter; left time: 14.3219s
	iters: 300, epoch: 5 | loss: 0.3629364
	speed: 0.0030s/iter; left time: 11.6252s
	iters: 400, epoch: 5 | loss: 0.3245461
	speed: 0.0030s/iter; left time: 11.3550s
	iters: 500, epoch: 5 | loss: 0.4331363
	speed: 0.0038s/iter; left time: 13.9496s
	iters: 600, epoch: 5 | loss: 0.7399170
	speed: 0.0050s/iter; left time: 17.8851s
	iters: 700, epoch: 5 | loss: 0.1836436
	speed: 0.0040s/iter; left time: 14.0403s
	iters: 800, epoch: 5 | loss: 0.6432620
	speed: 0.0046s/iter; left time: 15.7186s
	iters: 900, epoch: 5 | loss: 0.8184315
	speed: 0.0040s/iter; left time: 13.1909s
	iters: 1000, epoch: 5 | loss: 0.2959554
	speed: 0.0047s/iter; left time: 15.0547s
Updating learning rate to 0.00015432914190872756
Epoch: 5 cost time: 4.245927572250366
Epoch: 5, Steps: 1045 | Train Loss: 0.4247706 Vali Loss: 0.2888603 Best vali loss: 0.2826106
	iters: 100, epoch: 6 | loss: 0.5141073
	speed: 0.0110s/iter; left time: 33.4144s
	iters: 200, epoch: 6 | loss: 0.5453321
	speed: 0.0036s/iter; left time: 10.6470s
	iters: 300, epoch: 6 | loss: 0.5861233
	speed: 0.0038s/iter; left time: 10.6384s
	iters: 400, epoch: 6 | loss: 0.4644388
	speed: 0.0037s/iter; left time: 10.0841s
	iters: 500, epoch: 6 | loss: 0.3541766
	speed: 0.0037s/iter; left time: 9.6695s
	iters: 600, epoch: 6 | loss: 0.2089294
	speed: 0.0037s/iter; left time: 9.3966s
	iters: 700, epoch: 6 | loss: 0.2743029
	speed: 0.0036s/iter; left time: 8.8159s
	iters: 800, epoch: 6 | loss: 0.3992812
	speed: 0.0037s/iter; left time: 8.6274s
	iters: 900, epoch: 6 | loss: 0.3943511
	speed: 0.0037s/iter; left time: 8.3095s
	iters: 1000, epoch: 6 | loss: 0.4647241
	speed: 0.0037s/iter; left time: 7.9942s
Updating learning rate to 7.322330470336314e-05
Epoch: 6 cost time: 3.8269495964050293
Epoch: 6, Steps: 1045 | Train Loss: 0.4205767 Vali Loss: 0.2920613 Best vali loss: 0.2826106
	iters: 100, epoch: 7 | loss: 0.1986386
	speed: 0.0136s/iter; left time: 27.1410s
	iters: 200, epoch: 7 | loss: 0.3464024
	speed: 0.0037s/iter; left time: 6.9855s
	iters: 300, epoch: 7 | loss: 1.3884044
	speed: 0.0036s/iter; left time: 6.3991s
	iters: 400, epoch: 7 | loss: 0.5145800
	speed: 0.0037s/iter; left time: 6.2361s
	iters: 500, epoch: 7 | loss: 1.2516177
	speed: 0.0036s/iter; left time: 5.7625s
	iters: 600, epoch: 7 | loss: 0.3267845
	speed: 0.0036s/iter; left time: 5.4037s
	iters: 700, epoch: 7 | loss: 0.3372619
	speed: 0.0036s/iter; left time: 5.0105s
	iters: 800, epoch: 7 | loss: 0.8908448
	speed: 0.0036s/iter; left time: 4.7072s
	iters: 900, epoch: 7 | loss: 0.4358309
	speed: 0.0035s/iter; left time: 4.2070s
	iters: 1000, epoch: 7 | loss: 0.2723260
	speed: 0.0034s/iter; left time: 3.7076s
Updating learning rate to 1.9030116872178316e-05
Epoch: 7 cost time: 3.802373170852661
Epoch: 7, Steps: 1045 | Train Loss: 0.5962691 Vali Loss: 0.2922355 Best vali loss: 0.2826106
	iters: 100, epoch: 8 | loss: 0.1689367
	speed: 0.0131s/iter; left time: 12.3463s
	iters: 200, epoch: 8 | loss: 0.3608226
	speed: 0.0035s/iter; left time: 3.0003s
	iters: 300, epoch: 8 | loss: 0.4478625
	speed: 0.0030s/iter; left time: 2.2697s
	iters: 400, epoch: 8 | loss: 0.2357202
	speed: 0.0031s/iter; left time: 1.9781s
	iters: 500, epoch: 8 | loss: 0.2947716
	speed: 0.0028s/iter; left time: 1.5557s
	iters: 600, epoch: 8 | loss: 0.2283043
	speed: 0.0028s/iter; left time: 1.2287s
	iters: 700, epoch: 8 | loss: 0.4226407
	speed: 0.0028s/iter; left time: 0.9525s
	iters: 800, epoch: 8 | loss: 1.1847116
	speed: 0.0028s/iter; left time: 0.6779s
	iters: 900, epoch: 8 | loss: 0.1929621
	speed: 0.0028s/iter; left time: 0.4017s
	iters: 1000, epoch: 8 | loss: 1.0116373
	speed: 0.0025s/iter; left time: 0.1154s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.064094066619873
Epoch: 8, Steps: 1045 | Train Loss: 0.4548370 Vali Loss: 0.2931055 Best vali loss: 0.2826106

best validation loss 0.28261058573919673

Default cost: 0.28261058573919673
{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0069985648614, 'e_layers': 3, 'learning_rate': 0.0001867300681, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8
start_epoch 8
train_epoch 8

best validation loss 0.27121974221943657

Configuration(values={
  'alpha_d_ff': 1,
  'batch_size': 8,
  'd_core': 32,
  'd_model': 256,
  'dropout': 0.0069985648614,
  'e_layers': 3,
  'learning_rate': 0.0001867300681,
  'lradj': 'type1',
})
Incumbent cost: 0.27121974221943657


Time taken (1 parallel trials): 8913 seconds


