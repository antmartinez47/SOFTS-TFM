horizon=192
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023508577801, 'e_layers': 1, 'learning_rate': 0.0004821026935, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5834060
	speed: 0.0086s/iter; left time: 17.2554s
	iters: 200, epoch: 1 | loss: 0.4136868
	speed: 0.0024s/iter; left time: 4.5086s
Updating learning rate to 0.00046375375229660605
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 0.9900147914886475
Epoch: 1, Steps: 262 | Train Loss: 0.4985464 Vali Loss: 0.2883522 Best vali loss: 0.2883522
	iters: 100, epoch: 2 | loss: 0.7534162
	speed: 0.0069s/iter; left time: 12.0431s
	iters: 200, epoch: 2 | loss: 0.4541170
	speed: 0.0030s/iter; left time: 4.9407s
Updating learning rate to 0.00041150038865107484
Validation loss decreased (0.2884 --> 0.2827).  Saving model state dict ...
Epoch: 2 cost time: 0.8346209526062012
Epoch: 2, Steps: 262 | Train Loss: 0.6037666 Vali Loss: 0.2826518 Best vali loss: 0.2826518
	iters: 100, epoch: 3 | loss: 0.3558559
	speed: 0.0070s/iter; left time: 10.3796s
	iters: 200, epoch: 3 | loss: 0.2422653
	speed: 0.0028s/iter; left time: 3.8045s
Updating learning rate to 0.0003332977035005174
Validation loss decreased (0.2827 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 0.7644462585449219
Epoch: 3, Steps: 262 | Train Loss: 0.2990606 Vali Loss: 0.2823314 Best vali loss: 0.2823314

best validation loss 0.28233136732079983

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9386364
	speed: 0.0114s/iter; left time: 46.6617s
	iters: 200, epoch: 1 | loss: 0.6114913
	speed: 0.0050s/iter; left time: 20.0954s
	iters: 300, epoch: 1 | loss: 0.7728357
	speed: 0.0044s/iter; left time: 17.1770s
	iters: 400, epoch: 1 | loss: 0.2932993
	speed: 0.0054s/iter; left time: 20.5523s
	iters: 500, epoch: 1 | loss: 0.6511849
	speed: 0.0055s/iter; left time: 20.1171s
Updating learning rate to 0.0015120382784
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 3.0481910705566406
Epoch: 1, Steps: 523 | Train Loss: 0.6534895 Vali Loss: 0.2840199 Best vali loss: 0.2840199
	iters: 100, epoch: 2 | loss: 0.4304247
	speed: 0.0128s/iter; left time: 45.7677s
	iters: 200, epoch: 2 | loss: 0.2752168
	speed: 0.0062s/iter; left time: 21.4267s
	iters: 300, epoch: 2 | loss: 0.3249710
	speed: 0.0053s/iter; left time: 17.8322s
	iters: 400, epoch: 2 | loss: 0.4503768
	speed: 0.0060s/iter; left time: 19.6571s
	iters: 500, epoch: 2 | loss: 1.3678914
	speed: 0.0068s/iter; left time: 21.6499s
Updating learning rate to 0.0007560191392
Epoch: 2 cost time: 3.240565061569214
Epoch: 2, Steps: 523 | Train Loss: 0.5697761 Vali Loss: 0.2955073 Best vali loss: 0.2840199
	iters: 100, epoch: 3 | loss: 0.4413143
	speed: 0.0135s/iter; left time: 41.1698s
	iters: 200, epoch: 3 | loss: 0.4337928
	speed: 0.0063s/iter; left time: 18.6529s
	iters: 300, epoch: 3 | loss: 0.3884105
	speed: 0.0065s/iter; left time: 18.3886s
	iters: 400, epoch: 3 | loss: 0.3835309
	speed: 0.0064s/iter; left time: 17.4689s
	iters: 500, epoch: 3 | loss: 0.2474844
	speed: 0.0066s/iter; left time: 17.2890s
Updating learning rate to 0.0003780095696
Epoch: 3 cost time: 3.4415459632873535
Epoch: 3, Steps: 523 | Train Loss: 0.3789066 Vali Loss: 0.2912091 Best vali loss: 0.2840199

best validation loss 0.28401992631561473

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8074170
	speed: 0.0089s/iter; left time: 8.4455s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.2951).  Saving model state dict ...
Epoch: 1 cost time: 0.721592903137207
Epoch: 1, Steps: 131 | Train Loss: 0.8074170 Vali Loss: 0.2951197 Best vali loss: 0.2951197
	iters: 100, epoch: 2 | loss: 0.6121550
	speed: 0.0063s/iter; left time: 5.1230s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.2951 --> 0.2837).  Saving model state dict ...
Epoch: 2 cost time: 0.5091655254364014
Epoch: 2, Steps: 131 | Train Loss: 0.6121550 Vali Loss: 0.2836582 Best vali loss: 0.2836582
	iters: 100, epoch: 3 | loss: 0.6417099
	speed: 0.0083s/iter; left time: 5.7191s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.2837 --> 0.2811).  Saving model state dict ...
Epoch: 3 cost time: 0.636404275894165
Epoch: 3, Steps: 131 | Train Loss: 0.6417099 Vali Loss: 0.2810963 Best vali loss: 0.2810963

best validation loss 0.28109632547170355

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7595140
	speed: 0.0110s/iter; left time: 6.1352s
Updating learning rate to 0.0001298368129
Epoch: 4 cost time: 0.9955816268920898
Epoch: 4, Steps: 131 | Train Loss: 0.7595140 Vali Loss: 0.2820223 Best vali loss: 0.2810963
	iters: 100, epoch: 5 | loss: 0.5689500
	speed: 0.0081s/iter; left time: 3.4444s
Updating learning rate to 8.015041569208405e-05
Epoch: 5 cost time: 0.5587317943572998
Epoch: 5, Steps: 131 | Train Loss: 0.5689500 Vali Loss: 0.2811683 Best vali loss: 0.2810963
	iters: 100, epoch: 6 | loss: 0.6173746
	speed: 0.0087s/iter; left time: 2.5573s
Updating learning rate to 3.8028322050761e-05
Epoch: 6 cost time: 0.7241852283477783
Epoch: 6, Steps: 131 | Train Loss: 0.6173746 Vali Loss: 0.2812745 Best vali loss: 0.2810963
	iters: 100, epoch: 7 | loss: 0.4363810
	speed: 0.0084s/iter; left time: 1.3681s
Updating learning rate to 9.883238895192597e-06
Epoch: 7 cost time: 0.580003023147583
Epoch: 7, Steps: 131 | Train Loss: 0.4363810 Vali Loss: 0.2811637 Best vali loss: 0.2810963
	iters: 100, epoch: 8 | loss: 0.3696130
	speed: 0.0087s/iter; left time: 0.2781s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7175421714782715
Epoch: 8, Steps: 131 | Train Loss: 0.3696130 Vali Loss: 0.2812957 Best vali loss: 0.2810963

best validation loss 0.28109632547170355

[INFO][abstract_intensifier.py:516] Added config e98a6b as new incumbent because there are no incumbents yet.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012865813859, 'e_layers': 2, 'learning_rate': 0.0003414993649, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3352718
	speed: 0.0127s/iter; left time: 25.3656s
	iters: 200, epoch: 1 | loss: 0.5555092
	speed: 0.0064s/iter; left time: 12.1629s
Updating learning rate to 0.0003414993649
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.9278960227966309
Epoch: 1, Steps: 262 | Train Loss: 0.4453905 Vali Loss: 0.2856293 Best vali loss: 0.2856293
	iters: 100, epoch: 2 | loss: 0.6429988
	speed: 0.0133s/iter; left time: 23.0104s
	iters: 200, epoch: 2 | loss: 0.6578826
	speed: 0.0065s/iter; left time: 10.5733s
Updating learning rate to 0.00017074968245
Validation loss decreased (0.2856 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 1.6681711673736572
Epoch: 2, Steps: 262 | Train Loss: 0.6504407 Vali Loss: 0.2823917 Best vali loss: 0.2823917
	iters: 100, epoch: 3 | loss: 0.2930568
	speed: 0.0136s/iter; left time: 20.0959s
	iters: 200, epoch: 3 | loss: 0.8542147
	speed: 0.0064s/iter; left time: 8.7743s
Updating learning rate to 8.5374841225e-05
Epoch: 3 cost time: 1.69478178024292
Epoch: 3, Steps: 262 | Train Loss: 0.5736358 Vali Loss: 0.2981294 Best vali loss: 0.2823917
	iters: 100, epoch: 4 | loss: 0.3411630
	speed: 0.0136s/iter; left time: 16.4577s
	iters: 200, epoch: 4 | loss: 0.4738437
	speed: 0.0067s/iter; left time: 7.4155s
Updating learning rate to 4.26874206125e-05
Epoch: 4 cost time: 1.7045159339904785
Epoch: 4, Steps: 262 | Train Loss: 0.4075034 Vali Loss: 0.2960947 Best vali loss: 0.2823917
	iters: 100, epoch: 5 | loss: 0.2839885
	speed: 0.0096s/iter; left time: 9.0655s
	iters: 200, epoch: 5 | loss: 0.3576979
	speed: 0.0038s/iter; left time: 3.2370s
Updating learning rate to 2.134371030625e-05
Epoch: 5 cost time: 1.0633091926574707
Epoch: 5, Steps: 262 | Train Loss: 0.3208432 Vali Loss: 0.3004309 Best vali loss: 0.2823917
	iters: 100, epoch: 6 | loss: 0.3215562
	speed: 0.0105s/iter; left time: 7.2096s
	iters: 200, epoch: 6 | loss: 0.4806418
	speed: 0.0043s/iter; left time: 2.5440s
Updating learning rate to 1.0671855153125e-05
Epoch: 6 cost time: 1.2281756401062012
Epoch: 6, Steps: 262 | Train Loss: 0.4010990 Vali Loss: 0.3056654 Best vali loss: 0.2823917
	iters: 100, epoch: 7 | loss: 0.6570817
	speed: 0.0101s/iter; left time: 4.3121s
	iters: 200, epoch: 7 | loss: 0.3752165
	speed: 0.0043s/iter; left time: 1.3899s
Updating learning rate to 5.3359275765625e-06
Epoch: 7 cost time: 1.1905250549316406
Epoch: 7, Steps: 262 | Train Loss: 0.5161491 Vali Loss: 0.2974821 Best vali loss: 0.2823917
	iters: 100, epoch: 8 | loss: 0.3465102
	speed: 0.0103s/iter; left time: 1.6713s
	iters: 200, epoch: 8 | loss: 0.4489002
	speed: 0.0042s/iter; left time: 0.2623s
Updating learning rate to 2.66796378828125e-06
Epoch: 8 cost time: 1.1843247413635254
Epoch: 8, Steps: 262 | Train Loss: 0.3977052 Vali Loss: 0.3024431 Best vali loss: 0.2823917

best validation loss 0.28239172242108046

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0033747601445, 'e_layers': 1, 'learning_rate': 0.0010195596024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5029868
	speed: 0.0097s/iter; left time: 9.1635s
Updating learning rate to 0.0009807549256163528
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 0.7935779094696045
Epoch: 1, Steps: 131 | Train Loss: 0.5029868 Vali Loss: 0.2858818 Best vali loss: 0.2858818
	iters: 100, epoch: 2 | loss: 0.6639416
	speed: 0.0065s/iter; left time: 5.2984s
Updating learning rate to 0.0008702485555404501
Validation loss decreased (0.2859 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 0.4915926456451416
Epoch: 2, Steps: 131 | Train Loss: 0.6639416 Vali Loss: 0.2843009 Best vali loss: 0.2843009
	iters: 100, epoch: 3 | loss: 0.5425340
	speed: 0.0069s/iter; left time: 4.7258s
Updating learning rate to 0.0007048640852736092
Epoch: 3 cost time: 0.4952709674835205
Epoch: 3, Steps: 131 | Train Loss: 0.5425340 Vali Loss: 0.3034245 Best vali loss: 0.2843009
	iters: 100, epoch: 4 | loss: 0.4238728
	speed: 0.0063s/iter; left time: 3.5132s
Updating learning rate to 0.0005097798012
Epoch: 4 cost time: 0.4405181407928467
Epoch: 4, Steps: 131 | Train Loss: 0.4238728 Vali Loss: 0.3184402 Best vali loss: 0.2843009
	iters: 100, epoch: 5 | loss: 0.3398249
	speed: 0.0064s/iter; left time: 2.7016s
Updating learning rate to 0.00031469551712639095
Epoch: 5 cost time: 0.4748830795288086
Epoch: 5, Steps: 131 | Train Loss: 0.3398249 Vali Loss: 0.3162117 Best vali loss: 0.2843009
	iters: 100, epoch: 6 | loss: 0.2701750
	speed: 0.0064s/iter; left time: 1.8779s
Updating learning rate to 0.00014931104685954994
Epoch: 6 cost time: 0.46077537536621094
Epoch: 6, Steps: 131 | Train Loss: 0.2701750 Vali Loss: 0.3244301 Best vali loss: 0.2843009
	iters: 100, epoch: 7 | loss: 0.3188292
	speed: 0.0062s/iter; left time: 1.0184s
Updating learning rate to 3.880467678364731e-05
Epoch: 7 cost time: 0.4610297679901123
Epoch: 7, Steps: 131 | Train Loss: 0.3188292 Vali Loss: 0.3337255 Best vali loss: 0.2843009
	iters: 100, epoch: 8 | loss: 0.2580643
	speed: 0.0064s/iter; left time: 0.2045s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4890282154083252
Epoch: 8, Steps: 131 | Train Loss: 0.2580643 Vali Loss: 0.3369409 Best vali loss: 0.2843009

best validation loss 0.28430089233155675

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8625314
	speed: 0.0096s/iter; left time: 9.1388s
Updating learning rate to 0.0008036931396
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 0.8595681190490723
Epoch: 1, Steps: 131 | Train Loss: 0.8625314 Vali Loss: 0.2856309 Best vali loss: 0.2856309
	iters: 100, epoch: 2 | loss: 0.4061940
	speed: 0.0086s/iter; left time: 7.0670s
Updating learning rate to 0.0004018465698
Validation loss decreased (0.2856 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.6133599281311035
Epoch: 2, Steps: 131 | Train Loss: 0.4061940 Vali Loss: 0.2792235 Best vali loss: 0.2792235
	iters: 100, epoch: 3 | loss: 0.3649252
	speed: 0.0089s/iter; left time: 6.0873s
Updating learning rate to 0.0002009232849
Epoch: 3 cost time: 0.618436336517334
Epoch: 3, Steps: 131 | Train Loss: 0.3649252 Vali Loss: 0.2911799 Best vali loss: 0.2792235

best validation loss 0.2792234520385282

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5729324
	speed: 0.0090s/iter; left time: 18.0309s
	iters: 200, epoch: 1 | loss: 0.7571976
	speed: 0.0056s/iter; left time: 10.6746s
Updating learning rate to 0.0006153270642
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 1.516787052154541
Epoch: 1, Steps: 262 | Train Loss: 0.6650650 Vali Loss: 0.2847307 Best vali loss: 0.2847307
	iters: 100, epoch: 2 | loss: 0.5898519
	speed: 0.0123s/iter; left time: 21.3743s
	iters: 200, epoch: 2 | loss: 0.8020768
	speed: 0.0053s/iter; left time: 8.6488s
Updating learning rate to 0.0003076635321
Epoch: 2 cost time: 1.3720433712005615
Epoch: 2, Steps: 262 | Train Loss: 0.6959644 Vali Loss: 0.2867685 Best vali loss: 0.2847307
	iters: 100, epoch: 3 | loss: 0.4256902
	speed: 0.0087s/iter; left time: 12.8159s
	iters: 200, epoch: 3 | loss: 0.4387180
	speed: 0.0038s/iter; left time: 5.1755s
Updating learning rate to 0.00015383176605
Validation loss decreased (0.2847 --> 0.2843).  Saving model state dict ...
Epoch: 3 cost time: 1.0585863590240479
Epoch: 3, Steps: 262 | Train Loss: 0.4322041 Vali Loss: 0.2842613 Best vali loss: 0.2842613

best validation loss 0.2842612912183625

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0030607900961, 'e_layers': 1, 'learning_rate': 0.0002423804971, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7219207
	speed: 0.0087s/iter; left time: 17.2806s
	iters: 200, epoch: 1 | loss: 0.3849798
	speed: 0.0030s/iter; left time: 5.6954s
Updating learning rate to 0.0002423804971
Validation loss decreased (inf --> 0.2998).  Saving model state dict ...
Epoch: 1 cost time: 1.092759132385254
Epoch: 1, Steps: 262 | Train Loss: 0.5534502 Vali Loss: 0.2998107 Best vali loss: 0.2998107
	iters: 100, epoch: 2 | loss: 0.4423367
	speed: 0.0075s/iter; left time: 12.9766s
	iters: 200, epoch: 2 | loss: 0.4563342
	speed: 0.0030s/iter; left time: 4.9721s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.2998 --> 0.2858).  Saving model state dict ...
Epoch: 2 cost time: 0.8381879329681396
Epoch: 2, Steps: 262 | Train Loss: 0.4493354 Vali Loss: 0.2857640 Best vali loss: 0.2857640
	iters: 100, epoch: 3 | loss: 0.3683655
	speed: 0.0074s/iter; left time: 10.9458s
	iters: 200, epoch: 3 | loss: 0.5228429
	speed: 0.0031s/iter; left time: 4.2392s
Updating learning rate to 6.0595124275e-05
Validation loss decreased (0.2858 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 0.8512136936187744
Epoch: 3, Steps: 262 | Train Loss: 0.4456042 Vali Loss: 0.2835065 Best vali loss: 0.2835065

best validation loss 0.2835064501861473

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6086414
	speed: 0.0092s/iter; left time: 5.1162s
Updating learning rate to 0.00010046164245
Epoch: 4 cost time: 0.7499973773956299
Epoch: 4, Steps: 131 | Train Loss: 0.6086414 Vali Loss: 0.2986503 Best vali loss: 0.2792235
	iters: 100, epoch: 5 | loss: 0.3467017
	speed: 0.0060s/iter; left time: 2.5414s
Updating learning rate to 5.0230821225e-05
Epoch: 5 cost time: 0.4397132396697998
Epoch: 5, Steps: 131 | Train Loss: 0.3467017 Vali Loss: 0.3021963 Best vali loss: 0.2792235
	iters: 100, epoch: 6 | loss: 0.3396227
	speed: 0.0061s/iter; left time: 1.7798s
Updating learning rate to 2.51154106125e-05
Epoch: 6 cost time: 0.4923591613769531
Epoch: 6, Steps: 131 | Train Loss: 0.3396227 Vali Loss: 0.3034355 Best vali loss: 0.2792235
	iters: 100, epoch: 7 | loss: 0.4381928
	speed: 0.0064s/iter; left time: 1.0484s
Updating learning rate to 1.255770530625e-05
Epoch: 7 cost time: 0.47651100158691406
Epoch: 7, Steps: 131 | Train Loss: 0.4381928 Vali Loss: 0.3062444 Best vali loss: 0.2792235
	iters: 100, epoch: 8 | loss: 0.6806064
	speed: 0.0066s/iter; left time: 0.2103s
Updating learning rate to 6.278852653125e-06
Epoch: 8 cost time: 0.5060329437255859
Epoch: 8, Steps: 131 | Train Loss: 0.6806064 Vali Loss: 0.3049975 Best vali loss: 0.2792235

best validation loss 0.2792234520385282

[INFO][abstract_intensifier.py:595] Added config 8f48b8 and rejected config e98a6b as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015028868658, 'e_layers': 3, 'learning_rate': 0.000202867082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8945907
	speed: 0.0122s/iter; left time: 24.4272s
	iters: 200, epoch: 1 | loss: 0.5266863
	speed: 0.0066s/iter; left time: 12.5707s
Updating learning rate to 0.000202867082
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 2.0366859436035156
Epoch: 1, Steps: 262 | Train Loss: 0.7106385 Vali Loss: 0.2829164 Best vali loss: 0.2829164
	iters: 100, epoch: 2 | loss: 0.6454085
	speed: 0.0144s/iter; left time: 24.9764s
	iters: 200, epoch: 2 | loss: 0.4705918
	speed: 0.0065s/iter; left time: 10.6185s
Updating learning rate to 0.000101433541
Validation loss decreased (0.2829 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 1.7779369354248047
Epoch: 2, Steps: 262 | Train Loss: 0.5580001 Vali Loss: 0.2808908 Best vali loss: 0.2808908
	iters: 100, epoch: 3 | loss: 0.3446802
	speed: 0.0144s/iter; left time: 21.1537s
	iters: 200, epoch: 3 | loss: 0.4555958
	speed: 0.0068s/iter; left time: 9.2893s
Updating learning rate to 5.07167705e-05
Epoch: 3 cost time: 1.7929496765136719
Epoch: 3, Steps: 262 | Train Loss: 0.4001380 Vali Loss: 0.2827058 Best vali loss: 0.2808908
	iters: 100, epoch: 4 | loss: 0.2932662
	speed: 0.0136s/iter; left time: 16.4953s
	iters: 200, epoch: 4 | loss: 0.3201322
	speed: 0.0059s/iter; left time: 6.5660s
Updating learning rate to 2.535838525e-05
Epoch: 4 cost time: 1.616396427154541
Epoch: 4, Steps: 262 | Train Loss: 0.3066992 Vali Loss: 0.2828600 Best vali loss: 0.2808908
	iters: 100, epoch: 5 | loss: 0.3899897
	speed: 0.0141s/iter; left time: 13.3518s
	iters: 200, epoch: 5 | loss: 0.3333420
	speed: 0.0065s/iter; left time: 5.4799s
Updating learning rate to 1.2679192625e-05
Epoch: 5 cost time: 1.7777082920074463
Epoch: 5, Steps: 262 | Train Loss: 0.3616659 Vali Loss: 0.2889868 Best vali loss: 0.2808908
	iters: 100, epoch: 6 | loss: 0.3238872
	speed: 0.0142s/iter; left time: 9.7630s
	iters: 200, epoch: 6 | loss: 0.4130227
	speed: 0.0067s/iter; left time: 3.9170s
Updating learning rate to 6.3395963125e-06
Epoch: 6 cost time: 1.7948994636535645
Epoch: 6, Steps: 262 | Train Loss: 0.3684550 Vali Loss: 0.2885264 Best vali loss: 0.2808908
	iters: 100, epoch: 7 | loss: 0.3356348
	speed: 0.0143s/iter; left time: 6.0611s
	iters: 200, epoch: 7 | loss: 0.3907698
	speed: 0.0067s/iter; left time: 2.1749s
Updating learning rate to 3.16979815625e-06
Epoch: 7 cost time: 1.797541856765747
Epoch: 7, Steps: 262 | Train Loss: 0.3632023 Vali Loss: 0.2913963 Best vali loss: 0.2808908
	iters: 100, epoch: 8 | loss: 0.4081728
	speed: 0.0144s/iter; left time: 2.3470s
	iters: 200, epoch: 8 | loss: 0.2850698
	speed: 0.0067s/iter; left time: 0.4199s
Updating learning rate to 1.584899078125e-06
Epoch: 8 cost time: 1.7938170433044434
Epoch: 8, Steps: 262 | Train Loss: 0.3466213 Vali Loss: 0.2921788 Best vali loss: 0.2808908

best validation loss 0.280890752088629

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0026114276247, 'e_layers': 2, 'learning_rate': 0.0003412042455, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8260152
	speed: 0.0091s/iter; left time: 18.2664s
	iters: 200, epoch: 1 | loss: 0.7941133
	speed: 0.0037s/iter; left time: 6.9535s
Updating learning rate to 0.0003412042455
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 1.2456536293029785
Epoch: 1, Steps: 262 | Train Loss: 0.8100643 Vali Loss: 0.2868229 Best vali loss: 0.2868229
	iters: 100, epoch: 2 | loss: 0.7916073
	speed: 0.0084s/iter; left time: 14.5001s
	iters: 200, epoch: 2 | loss: 0.7811539
	speed: 0.0041s/iter; left time: 6.6671s
Updating learning rate to 0.00017060212275
Validation loss decreased (0.2868 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 1.1864161491394043
Epoch: 2, Steps: 262 | Train Loss: 0.7863806 Vali Loss: 0.2838655 Best vali loss: 0.2838655
	iters: 100, epoch: 3 | loss: 0.5367882
	speed: 0.0130s/iter; left time: 19.1387s
	iters: 200, epoch: 3 | loss: 0.4645723
	speed: 0.0053s/iter; left time: 7.2344s
Updating learning rate to 8.5301061375e-05
Validation loss decreased (0.2839 --> 0.2777).  Saving model state dict ...
Epoch: 3 cost time: 1.4190783500671387
Epoch: 3, Steps: 262 | Train Loss: 0.5006803 Vali Loss: 0.2777477 Best vali loss: 0.2777477
	iters: 100, epoch: 4 | loss: 0.4019479
	speed: 0.0127s/iter; left time: 15.3251s
	iters: 200, epoch: 4 | loss: 0.3703892
	speed: 0.0058s/iter; left time: 6.4127s
Updating learning rate to 4.26505306875e-05
Epoch: 4 cost time: 1.5072839260101318
Epoch: 4, Steps: 262 | Train Loss: 0.3861685 Vali Loss: 0.2800284 Best vali loss: 0.2777477
	iters: 100, epoch: 5 | loss: 0.2429137
	speed: 0.0123s/iter; left time: 11.7102s
	iters: 200, epoch: 5 | loss: 0.3555116
	speed: 0.0038s/iter; left time: 3.2034s
Updating learning rate to 2.132526534375e-05
Epoch: 5 cost time: 1.1341264247894287
Epoch: 5, Steps: 262 | Train Loss: 0.2992126 Vali Loss: 0.2813424 Best vali loss: 0.2777477
	iters: 100, epoch: 6 | loss: 0.2699639
	speed: 0.0091s/iter; left time: 6.2366s
	iters: 200, epoch: 6 | loss: 0.3800106
	speed: 0.0043s/iter; left time: 2.5034s
Updating learning rate to 1.0662632671875e-05
Epoch: 6 cost time: 1.1529903411865234
Epoch: 6, Steps: 262 | Train Loss: 0.3249873 Vali Loss: 0.2801721 Best vali loss: 0.2777477
	iters: 100, epoch: 7 | loss: 0.4103454
	speed: 0.0099s/iter; left time: 4.1922s
	iters: 200, epoch: 7 | loss: 0.3863005
	speed: 0.0044s/iter; left time: 1.4290s
Updating learning rate to 5.3313163359375e-06
Epoch: 7 cost time: 1.1704959869384766
Epoch: 7, Steps: 262 | Train Loss: 0.3983230 Vali Loss: 0.2813097 Best vali loss: 0.2777477
	iters: 100, epoch: 8 | loss: 0.2577383
	speed: 0.0094s/iter; left time: 1.5254s
	iters: 200, epoch: 8 | loss: 0.3203030
	speed: 0.0039s/iter; left time: 0.2471s
Updating learning rate to 2.66565816796875e-06
Epoch: 8 cost time: 1.1134629249572754
Epoch: 8, Steps: 262 | Train Loss: 0.2890206 Vali Loss: 0.2809242 Best vali loss: 0.2777477

best validation loss 0.277747705905754

[INFO][abstract_intensifier.py:595] Added config eb8e22 and rejected config 8f48b8 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4453068
	speed: 0.0100s/iter; left time: 9.4954s
Updating learning rate to 0.0002884157887385461
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 0.8733022212982178
Epoch: 1, Steps: 131 | Train Loss: 0.4453068 Vali Loss: 0.2814750 Best vali loss: 0.2814750
	iters: 100, epoch: 2 | loss: 0.2950404
	speed: 0.0084s/iter; left time: 6.8395s
Updating learning rate to 0.00025591859596019184
Validation loss decreased (0.2815 --> 0.2785).  Saving model state dict ...
Epoch: 2 cost time: 0.6735756397247314
Epoch: 2, Steps: 131 | Train Loss: 0.2950404 Vali Loss: 0.2784586 Best vali loss: 0.2784586
	iters: 100, epoch: 3 | loss: 0.4354944
	speed: 0.0087s/iter; left time: 5.9883s
Updating learning rate to 0.00020728310997765554
Epoch: 3 cost time: 0.6892406940460205
Epoch: 3, Steps: 131 | Train Loss: 0.4354944 Vali Loss: 0.2889354 Best vali loss: 0.2784586

best validation loss 0.2784585914300604

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 1, 'learning_rate': 0.0035418893013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4768091
	speed: 0.0092s/iter; left time: 8.7087s
Updating learning rate to 0.0035418893013
Validation loss decreased (inf --> 0.3499).  Saving model state dict ...
Epoch: 1 cost time: 0.7435028553009033
Epoch: 1, Steps: 131 | Train Loss: 0.4768091 Vali Loss: 0.3499358 Best vali loss: 0.3499358
	iters: 100, epoch: 2 | loss: 0.5337266
	speed: 0.0063s/iter; left time: 5.1270s
Updating learning rate to 0.00177094465065
Validation loss decreased (0.3499 --> 0.3000).  Saving model state dict ...
Epoch: 2 cost time: 0.4506418704986572
Epoch: 2, Steps: 131 | Train Loss: 0.5337266 Vali Loss: 0.2999837 Best vali loss: 0.2999837
	iters: 100, epoch: 3 | loss: 0.5343127
	speed: 0.0064s/iter; left time: 4.4299s
Updating learning rate to 0.000885472325325
Epoch: 3 cost time: 0.46819353103637695
Epoch: 3, Steps: 131 | Train Loss: 0.5343127 Vali Loss: 0.3067616 Best vali loss: 0.2999837

best validation loss 0.2999837201139926

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017113089176, 'e_layers': 4, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5229468
	speed: 0.0117s/iter; left time: 96.7870s
	iters: 200, epoch: 1 | loss: 0.4625005
	speed: 0.0065s/iter; left time: 52.8137s
	iters: 300, epoch: 1 | loss: 0.4765468
	speed: 0.0059s/iter; left time: 47.4646s
	iters: 400, epoch: 1 | loss: 0.3093673
	speed: 0.0059s/iter; left time: 46.8617s
	iters: 500, epoch: 1 | loss: 0.7368546
	speed: 0.0058s/iter; left time: 45.7974s
	iters: 600, epoch: 1 | loss: 0.5432246
	speed: 0.0058s/iter; left time: 45.2415s
	iters: 700, epoch: 1 | loss: 0.3249820
	speed: 0.0059s/iter; left time: 44.9217s
	iters: 800, epoch: 1 | loss: 1.6716818
	speed: 0.0058s/iter; left time: 43.8135s
	iters: 900, epoch: 1 | loss: 0.6115894
	speed: 0.0056s/iter; left time: 41.6362s
	iters: 1000, epoch: 1 | loss: 2.0175793
	speed: 0.0062s/iter; left time: 45.3995s
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.3265).  Saving model state dict ...
Epoch: 1 cost time: 6.523707628250122
Epoch: 1, Steps: 1045 | Train Loss: 0.8677273 Vali Loss: 0.3264508 Best vali loss: 0.3264508
	iters: 100, epoch: 2 | loss: 0.4188672
	speed: 0.0192s/iter; left time: 138.4126s
	iters: 200, epoch: 2 | loss: 1.1474540
	speed: 0.0064s/iter; left time: 45.8318s
	iters: 300, epoch: 2 | loss: 0.4312343
	speed: 0.0062s/iter; left time: 43.5476s
	iters: 400, epoch: 2 | loss: 0.7071439
	speed: 0.0068s/iter; left time: 46.9438s
	iters: 500, epoch: 2 | loss: 0.3419435
	speed: 0.0067s/iter; left time: 45.8477s
	iters: 600, epoch: 2 | loss: 0.2313778
	speed: 0.0065s/iter; left time: 43.3740s
	iters: 700, epoch: 2 | loss: 0.5530255
	speed: 0.0054s/iter; left time: 35.4073s
	iters: 800, epoch: 2 | loss: 0.2765701
	speed: 0.0065s/iter; left time: 42.4923s
	iters: 900, epoch: 2 | loss: 0.2506283
	speed: 0.0061s/iter; left time: 38.9430s
	iters: 1000, epoch: 2 | loss: 0.2555360
	speed: 0.0059s/iter; left time: 36.9514s
Updating learning rate to 0.002058451742387382
Validation loss decreased (0.3265 --> 0.3208).  Saving model state dict ...
Epoch: 2 cost time: 6.597027540206909
Epoch: 2, Steps: 1045 | Train Loss: 0.4613781 Vali Loss: 0.3207772 Best vali loss: 0.3207772
	iters: 100, epoch: 3 | loss: 0.4038706
	speed: 0.0190s/iter; left time: 116.9641s
	iters: 200, epoch: 3 | loss: 1.1409243
	speed: 0.0063s/iter; left time: 38.1991s
	iters: 300, epoch: 3 | loss: 0.2118315
	speed: 0.0064s/iter; left time: 38.1561s
	iters: 400, epoch: 3 | loss: 0.3521934
	speed: 0.0063s/iter; left time: 36.9591s
	iters: 500, epoch: 3 | loss: 1.0016714
	speed: 0.0063s/iter; left time: 36.4494s
	iters: 600, epoch: 3 | loss: 0.4279652
	speed: 0.0053s/iter; left time: 30.1981s
	iters: 700, epoch: 3 | loss: 0.6160836
	speed: 0.0057s/iter; left time: 31.4766s
	iters: 800, epoch: 3 | loss: 0.4177378
	speed: 0.0063s/iter; left time: 34.4805s
	iters: 900, epoch: 3 | loss: 1.2434841
	speed: 0.0063s/iter; left time: 33.9188s
	iters: 1000, epoch: 3 | loss: 0.4410214
	speed: 0.0047s/iter; left time: 24.7338s
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 6.3127171993255615
Epoch: 3, Steps: 1045 | Train Loss: 0.6256783 Vali Loss: 0.3221064 Best vali loss: 0.3207772

best validation loss 0.32077719731683757

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4233357
	speed: 0.0096s/iter; left time: 5.3389s
Updating learning rate to 0.00014991364265
Epoch: 4 cost time: 0.7999997138977051
Epoch: 4, Steps: 131 | Train Loss: 0.4233357 Vali Loss: 0.2812501 Best vali loss: 0.2784586
	iters: 100, epoch: 5 | loss: 0.2823588
	speed: 0.0084s/iter; left time: 3.5903s
Updating learning rate to 9.254417532234449e-05
Epoch: 5 cost time: 0.7310543060302734
Epoch: 5, Steps: 131 | Train Loss: 0.2823588 Vali Loss: 0.2864777 Best vali loss: 0.2784586
	iters: 100, epoch: 6 | loss: 0.3802577
	speed: 0.0103s/iter; left time: 3.0335s
Updating learning rate to 4.3908689339808184e-05
Epoch: 6 cost time: 0.8607747554779053
Epoch: 6, Steps: 131 | Train Loss: 0.3802577 Vali Loss: 0.2792585 Best vali loss: 0.2784586
	iters: 100, epoch: 7 | loss: 0.4331086
	speed: 0.0083s/iter; left time: 1.3576s
Updating learning rate to 1.1411496561453903e-05
Epoch: 7 cost time: 0.5328071117401123
Epoch: 7, Steps: 131 | Train Loss: 0.4331086 Vali Loss: 0.2808992 Best vali loss: 0.2784586
	iters: 100, epoch: 8 | loss: 0.3248261
	speed: 0.0083s/iter; left time: 0.2652s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7101259231567383
Epoch: 8, Steps: 131 | Train Loss: 0.3248261 Vali Loss: 0.2796132 Best vali loss: 0.2784586

best validation loss 0.2784585914300604

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002592776834, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3535481
	speed: 0.0093s/iter; left time: 37.9971s
	iters: 200, epoch: 1 | loss: 0.4517956
	speed: 0.0040s/iter; left time: 15.8621s
	iters: 300, epoch: 1 | loss: 0.3421367
	speed: 0.0031s/iter; left time: 12.1368s
	iters: 400, epoch: 1 | loss: 0.5637552
	speed: 0.0030s/iter; left time: 11.4973s
	iters: 500, epoch: 1 | loss: 0.4007841
	speed: 0.0031s/iter; left time: 11.5109s
Updating learning rate to 0.0002592776834
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 2.0814146995544434
Epoch: 1, Steps: 523 | Train Loss: 0.4224040 Vali Loss: 0.2821774 Best vali loss: 0.2821774
	iters: 100, epoch: 2 | loss: 0.4061055
	speed: 0.0090s/iter; left time: 32.1299s
	iters: 200, epoch: 2 | loss: 0.5351144
	speed: 0.0039s/iter; left time: 13.5302s
	iters: 300, epoch: 2 | loss: 0.3154815
	speed: 0.0039s/iter; left time: 13.0967s
	iters: 400, epoch: 2 | loss: 1.5166599
	speed: 0.0039s/iter; left time: 12.8006s
	iters: 500, epoch: 2 | loss: 0.4278784
	speed: 0.0039s/iter; left time: 12.4268s
Updating learning rate to 0.0001296388417
Validation loss decreased (0.2822 --> 0.2805).  Saving model state dict ...
Epoch: 2 cost time: 2.078869104385376
Epoch: 2, Steps: 523 | Train Loss: 0.6402479 Vali Loss: 0.2804914 Best vali loss: 0.2804914
	iters: 100, epoch: 3 | loss: 0.3181352
	speed: 0.0092s/iter; left time: 27.8993s
	iters: 200, epoch: 3 | loss: 0.5222499
	speed: 0.0041s/iter; left time: 12.0640s
	iters: 300, epoch: 3 | loss: 1.0050309
	speed: 0.0040s/iter; left time: 11.4951s
	iters: 400, epoch: 3 | loss: 0.3293058
	speed: 0.0040s/iter; left time: 11.0561s
	iters: 500, epoch: 3 | loss: 0.6581641
	speed: 0.0041s/iter; left time: 10.7414s
Updating learning rate to 6.481942085e-05
Epoch: 3 cost time: 2.151332378387451
Epoch: 3, Steps: 523 | Train Loss: 0.5665772 Vali Loss: 0.2843788 Best vali loss: 0.2804914
	iters: 100, epoch: 4 | loss: 0.2293622
	speed: 0.0085s/iter; left time: 21.4350s
	iters: 200, epoch: 4 | loss: 0.5183796
	speed: 0.0042s/iter; left time: 10.0882s
	iters: 300, epoch: 4 | loss: 0.3408805
	speed: 0.0042s/iter; left time: 9.7441s
	iters: 400, epoch: 4 | loss: 0.4856186
	speed: 0.0043s/iter; left time: 9.5316s
	iters: 500, epoch: 4 | loss: 0.2801456
	speed: 0.0043s/iter; left time: 8.9934s
Updating learning rate to 3.2409710425e-05
Epoch: 4 cost time: 2.1848878860473633
Epoch: 4, Steps: 523 | Train Loss: 0.3708773 Vali Loss: 0.2844052 Best vali loss: 0.2804914
	iters: 100, epoch: 5 | loss: 0.3384635
	speed: 0.0098s/iter; left time: 19.5706s
	iters: 200, epoch: 5 | loss: 0.3861893
	speed: 0.0044s/iter; left time: 8.4122s
	iters: 300, epoch: 5 | loss: 0.5171735
	speed: 0.0042s/iter; left time: 7.5784s
	iters: 400, epoch: 5 | loss: 0.4675606
	speed: 0.0040s/iter; left time: 6.7875s
	iters: 500, epoch: 5 | loss: 0.3005218
	speed: 0.0039s/iter; left time: 6.1954s
Updating learning rate to 1.62048552125e-05
Epoch: 5 cost time: 2.2387564182281494
Epoch: 5, Steps: 523 | Train Loss: 0.4019817 Vali Loss: 0.2846129 Best vali loss: 0.2804914
	iters: 100, epoch: 6 | loss: 0.8438171
	speed: 0.0088s/iter; left time: 12.9330s
	iters: 200, epoch: 6 | loss: 0.8225359
	speed: 0.0037s/iter; left time: 5.1247s
	iters: 300, epoch: 6 | loss: 0.6565593
	speed: 0.0038s/iter; left time: 4.7781s
	iters: 400, epoch: 6 | loss: 0.3563203
	speed: 0.0038s/iter; left time: 4.4896s
	iters: 500, epoch: 6 | loss: 0.7036203
	speed: 0.0040s/iter; left time: 4.2356s
Updating learning rate to 8.10242760625e-06
Epoch: 6 cost time: 2.0411038398742676
Epoch: 6, Steps: 523 | Train Loss: 0.6765706 Vali Loss: 0.2850428 Best vali loss: 0.2804914
	iters: 100, epoch: 7 | loss: 0.6281731
	speed: 0.0094s/iter; left time: 8.8764s
	iters: 200, epoch: 7 | loss: 0.6422939
	speed: 0.0040s/iter; left time: 3.3484s
	iters: 300, epoch: 7 | loss: 0.2609418
	speed: 0.0039s/iter; left time: 2.9489s
	iters: 400, epoch: 7 | loss: 0.3739380
	speed: 0.0041s/iter; left time: 2.6508s
	iters: 500, epoch: 7 | loss: 0.5549423
	speed: 0.0041s/iter; left time: 2.2272s
Updating learning rate to 4.051213803125e-06
Epoch: 7 cost time: 2.135822296142578
Epoch: 7, Steps: 523 | Train Loss: 0.4920578 Vali Loss: 0.2852778 Best vali loss: 0.2804914
	iters: 100, epoch: 8 | loss: 0.4010820
	speed: 0.0093s/iter; left time: 3.9321s
	iters: 200, epoch: 8 | loss: 0.3139064
	speed: 0.0040s/iter; left time: 1.2955s
	iters: 300, epoch: 8 | loss: 0.3936974
	speed: 0.0038s/iter; left time: 0.8541s
	iters: 400, epoch: 8 | loss: 0.4299877
	speed: 0.0037s/iter; left time: 0.4587s
	iters: 500, epoch: 8 | loss: 0.2683442
	speed: 0.0039s/iter; left time: 0.0927s
Updating learning rate to 2.0256069015625e-06
Epoch: 8 cost time: 2.076749324798584
Epoch: 8, Steps: 523 | Train Loss: 0.3614035 Vali Loss: 0.2855019 Best vali loss: 0.2804914

best validation loss 0.2804914242984549

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010733605571, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7258959
	speed: 0.0099s/iter; left time: 9.3955s
Updating learning rate to 6.11157199e-05
Validation loss decreased (inf --> 0.3457).  Saving model state dict ...
Epoch: 1 cost time: 0.8782181739807129
Epoch: 1, Steps: 131 | Train Loss: 0.7258959 Vali Loss: 0.3456850 Best vali loss: 0.3456850
	iters: 100, epoch: 2 | loss: 0.5853534
	speed: 0.0076s/iter; left time: 6.1874s
Updating learning rate to 3.055785995e-05
Validation loss decreased (0.3457 --> 0.3288).  Saving model state dict ...
Epoch: 2 cost time: 0.5954337120056152
Epoch: 2, Steps: 131 | Train Loss: 0.5853534 Vali Loss: 0.3287507 Best vali loss: 0.3287507
	iters: 100, epoch: 3 | loss: 0.7210594
	speed: 0.0076s/iter; left time: 5.2363s
Updating learning rate to 1.5278929975e-05
Validation loss decreased (0.3288 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 0.619081974029541
Epoch: 3, Steps: 131 | Train Loss: 0.7210594 Vali Loss: 0.3226410 Best vali loss: 0.3226410
	iters: 100, epoch: 4 | loss: 0.4366894
	speed: 0.0074s/iter; left time: 4.1330s
Updating learning rate to 7.6394649875e-06
Validation loss decreased (0.3226 --> 0.3200).  Saving model state dict ...
Epoch: 4 cost time: 0.6020233631134033
Epoch: 4, Steps: 131 | Train Loss: 0.4366894 Vali Loss: 0.3200071 Best vali loss: 0.3200071
	iters: 100, epoch: 5 | loss: 0.7852739
	speed: 0.0079s/iter; left time: 3.3379s
Updating learning rate to 3.81973249375e-06
Validation loss decreased (0.3200 --> 0.3188).  Saving model state dict ...
Epoch: 5 cost time: 0.6458804607391357
Epoch: 5, Steps: 131 | Train Loss: 0.7852739 Vali Loss: 0.3187795 Best vali loss: 0.3187795
	iters: 100, epoch: 6 | loss: 0.6104639
	speed: 0.0072s/iter; left time: 2.1309s
Updating learning rate to 1.909866246875e-06
Validation loss decreased (0.3188 --> 0.3182).  Saving model state dict ...
Epoch: 6 cost time: 0.5781404972076416
Epoch: 6, Steps: 131 | Train Loss: 0.6104639 Vali Loss: 0.3181745 Best vali loss: 0.3181745
	iters: 100, epoch: 7 | loss: 0.5332958
	speed: 0.0077s/iter; left time: 1.2537s
Updating learning rate to 9.549331234375e-07
Validation loss decreased (0.3182 --> 0.3179).  Saving model state dict ...
Epoch: 7 cost time: 0.6198029518127441
Epoch: 7, Steps: 131 | Train Loss: 0.5332958 Vali Loss: 0.3178789 Best vali loss: 0.3178789
	iters: 100, epoch: 8 | loss: 0.4147156
	speed: 0.0081s/iter; left time: 0.2580s
Updating learning rate to 4.7746656171875e-07
Validation loss decreased (0.3179 --> 0.3177).  Saving model state dict ...
Epoch: 8 cost time: 0.6352331638336182
Epoch: 8, Steps: 131 | Train Loss: 0.4147156 Vali Loss: 0.3177332 Best vali loss: 0.3177332

best validation loss 0.3177331801172791

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002189490937942002
Validation loss decreased (inf --> 0.2913).  Saving model state dict ...
Epoch: 1 cost time: 0.6129465103149414
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2912818 Best vali loss: 0.2912818
Updating learning rate to 0.001942790473283107
Validation loss decreased (0.2913 --> 0.2858).  Saving model state dict ...
Epoch: 2 cost time: 0.35410284996032715
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2858094 Best vali loss: 0.2858094
Updating learning rate to 0.0015735771362223516
Epoch: 3 cost time: 0.3645145893096924
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2922873 Best vali loss: 0.2858094

best validation loss 0.28580939454709164

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017721446715, 'e_layers': 4, 'learning_rate': 0.0002378546774, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002378546774
Validation loss decreased (inf --> 0.3267).  Saving model state dict ...
Epoch: 1 cost time: 0.6985135078430176
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3266645 Best vali loss: 0.3266645
Updating learning rate to 0.0001189273387
Validation loss decreased (0.3267 --> 0.3075).  Saving model state dict ...
Epoch: 2 cost time: 0.44368767738342285
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3074526 Best vali loss: 0.3074526
Updating learning rate to 5.946366935e-05
Validation loss decreased (0.3075 --> 0.3017).  Saving model state dict ...
Epoch: 3 cost time: 0.4645860195159912
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3017051 Best vali loss: 0.3017051

best validation loss 0.3017051102681513

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 0.6043617725372314
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2857509 Best vali loss: 0.2857509
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.2858 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 0.3586857318878174
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2807626 Best vali loss: 0.2807626
Updating learning rate to 0.00043994959105690174
Epoch: 3 cost time: 0.36241841316223145
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2834848 Best vali loss: 0.2807626

best validation loss 0.28076264835193104

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00031818533495
Epoch: 4 cost time: 0.6311142444610596
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2835558 Best vali loss: 0.2807626
Updating learning rate to 0.00019642107884309824
Epoch: 5 cost time: 0.35713934898376465
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2815171 Best vali loss: 0.2807626
Updating learning rate to 9.319432693274203e-05
Epoch: 6 cost time: 0.34554386138916016
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845267 Best vali loss: 0.2807626
Updating learning rate to 2.4220416444446813e-05
Epoch: 7 cost time: 0.37662196159362793
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2854781 Best vali loss: 0.2807626
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3697381019592285
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2862786 Best vali loss: 0.2807626

best validation loss 0.28076264835193104

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0036399733072, 'e_layers': 3, 'learning_rate': 0.0007179148563, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3008503
	speed: 0.0108s/iter; left time: 89.6203s
	iters: 200, epoch: 1 | loss: 0.4673465
	speed: 0.0052s/iter; left time: 42.7678s
	iters: 300, epoch: 1 | loss: 0.2284898
	speed: 0.0053s/iter; left time: 42.3899s
	iters: 400, epoch: 1 | loss: 0.1888378
	speed: 0.0053s/iter; left time: 41.9160s
	iters: 500, epoch: 1 | loss: 0.4075544
	speed: 0.0053s/iter; left time: 41.6389s
	iters: 600, epoch: 1 | loss: 1.5839485
	speed: 0.0053s/iter; left time: 40.9209s
	iters: 700, epoch: 1 | loss: 0.3673723
	speed: 0.0047s/iter; left time: 36.2365s
	iters: 800, epoch: 1 | loss: 1.4146210
	speed: 0.0047s/iter; left time: 35.6288s
	iters: 900, epoch: 1 | loss: 1.1229969
	speed: 0.0051s/iter; left time: 37.8939s
	iters: 1000, epoch: 1 | loss: 0.3379419
	speed: 0.0052s/iter; left time: 38.3372s
Updating learning rate to 0.0006905908490606759
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 5.66064190864563
Epoch: 1, Steps: 1045 | Train Loss: 0.6419960 Vali Loss: 0.2851680 Best vali loss: 0.2851680
	iters: 100, epoch: 2 | loss: 1.3315578
	speed: 0.0162s/iter; left time: 117.1419s
	iters: 200, epoch: 2 | loss: 0.3328304
	speed: 0.0052s/iter; left time: 36.9202s
	iters: 300, epoch: 2 | loss: 0.7494724
	speed: 0.0052s/iter; left time: 36.3965s
	iters: 400, epoch: 2 | loss: 0.4747518
	speed: 0.0051s/iter; left time: 35.5975s
	iters: 500, epoch: 2 | loss: 0.2955503
	speed: 0.0051s/iter; left time: 34.9480s
	iters: 600, epoch: 2 | loss: 0.7618443
	speed: 0.0052s/iter; left time: 34.7954s
	iters: 700, epoch: 2 | loss: 0.7169189
	speed: 0.0050s/iter; left time: 33.2822s
	iters: 800, epoch: 2 | loss: 0.5802765
	speed: 0.0050s/iter; left time: 32.7424s
	iters: 900, epoch: 2 | loss: 1.2892456
	speed: 0.0041s/iter; left time: 26.3868s
	iters: 1000, epoch: 2 | loss: 1.1405072
	speed: 0.0041s/iter; left time: 25.9292s
Updating learning rate to 0.0006127786597521479
Epoch: 2 cost time: 5.18923282623291
Epoch: 2, Steps: 1045 | Train Loss: 0.7672955 Vali Loss: 0.2925485 Best vali loss: 0.2851680
	iters: 100, epoch: 3 | loss: 0.1988411
	speed: 0.0166s/iter; left time: 102.4136s
	iters: 200, epoch: 3 | loss: 0.3199540
	speed: 0.0055s/iter; left time: 33.1845s
	iters: 300, epoch: 3 | loss: 1.2464620
	speed: 0.0051s/iter; left time: 30.6848s
	iters: 400, epoch: 3 | loss: 0.2649912
	speed: 0.0048s/iter; left time: 28.0868s
	iters: 500, epoch: 3 | loss: 0.2409276
	speed: 0.0048s/iter; left time: 27.5838s
	iters: 600, epoch: 3 | loss: 0.3603155
	speed: 0.0048s/iter; left time: 27.3572s
	iters: 700, epoch: 3 | loss: 0.3119589
	speed: 0.0048s/iter; left time: 26.8560s
	iters: 800, epoch: 3 | loss: 0.5936280
	speed: 0.0048s/iter; left time: 26.3782s
	iters: 900, epoch: 3 | loss: 0.3251144
	speed: 0.0049s/iter; left time: 26.1587s
	iters: 1000, epoch: 3 | loss: 1.0459814
	speed: 0.0049s/iter; left time: 25.6838s
Updating learning rate to 0.0004963244888273871
Epoch: 3 cost time: 5.238323450088501
Epoch: 3, Steps: 1045 | Train Loss: 0.4908174 Vali Loss: 0.2923558 Best vali loss: 0.2851680
	iters: 100, epoch: 4 | loss: 0.3279531
	speed: 0.0149s/iter; left time: 76.5724s
	iters: 200, epoch: 4 | loss: 0.4293212
	speed: 0.0048s/iter; left time: 24.2686s
	iters: 300, epoch: 4 | loss: 0.2951524
	speed: 0.0049s/iter; left time: 24.0277s
	iters: 400, epoch: 4 | loss: 0.1702439
	speed: 0.0050s/iter; left time: 24.0207s
	iters: 500, epoch: 4 | loss: 0.5487247
	speed: 0.0050s/iter; left time: 23.6020s
	iters: 600, epoch: 4 | loss: 1.0717922
	speed: 0.0050s/iter; left time: 22.9718s
	iters: 700, epoch: 4 | loss: 0.3603456
	speed: 0.0050s/iter; left time: 22.5441s
	iters: 800, epoch: 4 | loss: 0.2346842
	speed: 0.0047s/iter; left time: 20.5900s
	iters: 900, epoch: 4 | loss: 0.3456912
	speed: 0.0047s/iter; left time: 20.4017s
	iters: 1000, epoch: 4 | loss: 0.8531612
	speed: 0.0051s/iter; left time: 21.6533s
Updating learning rate to 0.00035895742815
Epoch: 4 cost time: 5.157914400100708
Epoch: 4, Steps: 1045 | Train Loss: 0.4637070 Vali Loss: 0.2950551 Best vali loss: 0.2851680
	iters: 100, epoch: 5 | loss: 1.0084525
	speed: 0.0163s/iter; left time: 66.6480s
	iters: 200, epoch: 5 | loss: 0.3964332
	speed: 0.0051s/iter; left time: 20.2068s
	iters: 300, epoch: 5 | loss: 0.2677053
	speed: 0.0051s/iter; left time: 19.7278s
	iters: 400, epoch: 5 | loss: 0.3135517
	speed: 0.0052s/iter; left time: 19.5786s
	iters: 500, epoch: 5 | loss: 0.4450551
	speed: 0.0054s/iter; left time: 19.6964s
	iters: 600, epoch: 5 | loss: 0.1869841
	speed: 0.0054s/iter; left time: 19.2682s
	iters: 700, epoch: 5 | loss: 0.6369977
	speed: 0.0054s/iter; left time: 18.7941s
	iters: 800, epoch: 5 | loss: 0.2849568
	speed: 0.0054s/iter; left time: 18.2569s
	iters: 900, epoch: 5 | loss: 0.2948820
	speed: 0.0054s/iter; left time: 17.5537s
	iters: 1000, epoch: 5 | loss: 0.2425780
	speed: 0.0051s/iter; left time: 16.2832s
Updating learning rate to 0.00022159036747261294
Epoch: 5 cost time: 5.511138677597046
Epoch: 5, Steps: 1045 | Train Loss: 0.4077596 Vali Loss: 0.2958232 Best vali loss: 0.2851680
	iters: 100, epoch: 6 | loss: 0.3992824
	speed: 0.0155s/iter; left time: 47.0721s
	iters: 200, epoch: 6 | loss: 0.2114471
	speed: 0.0047s/iter; left time: 13.6766s
	iters: 300, epoch: 6 | loss: 0.7915499
	speed: 0.0047s/iter; left time: 13.2452s
	iters: 400, epoch: 6 | loss: 0.2700279
	speed: 0.0047s/iter; left time: 12.9764s
	iters: 500, epoch: 6 | loss: 0.2335888
	speed: 0.0046s/iter; left time: 12.1299s
	iters: 600, epoch: 6 | loss: 1.3563583
	speed: 0.0046s/iter; left time: 11.7076s
	iters: 700, epoch: 6 | loss: 0.2451262
	speed: 0.0047s/iter; left time: 11.3620s
	iters: 800, epoch: 6 | loss: 0.3994727
	speed: 0.0049s/iter; left time: 11.4419s
	iters: 900, epoch: 6 | loss: 0.2454119
	speed: 0.0049s/iter; left time: 10.9617s
	iters: 1000, epoch: 6 | loss: 0.3403476
	speed: 0.0050s/iter; left time: 10.6846s
Updating learning rate to 0.00010513619654785212
Epoch: 6 cost time: 5.030073165893555
Epoch: 6, Steps: 1045 | Train Loss: 0.4492613 Vali Loss: 0.2909694 Best vali loss: 0.2851680
	iters: 100, epoch: 7 | loss: 0.4342895
	speed: 0.0158s/iter; left time: 31.5038s
	iters: 200, epoch: 7 | loss: 0.1758996
	speed: 0.0045s/iter; left time: 8.5242s
	iters: 300, epoch: 7 | loss: 0.1739186
	speed: 0.0054s/iter; left time: 9.7469s
	iters: 400, epoch: 7 | loss: 0.2518333
	speed: 0.0054s/iter; left time: 9.0619s
	iters: 500, epoch: 7 | loss: 0.4393644
	speed: 0.0053s/iter; left time: 8.3982s
	iters: 600, epoch: 7 | loss: 0.9651787
	speed: 0.0053s/iter; left time: 7.8778s
	iters: 700, epoch: 7 | loss: 0.3804995
	speed: 0.0051s/iter; left time: 7.1091s
	iters: 800, epoch: 7 | loss: 0.2353282
	speed: 0.0051s/iter; left time: 6.5765s
	iters: 900, epoch: 7 | loss: 0.3553410
	speed: 0.0049s/iter; left time: 5.8848s
	iters: 1000, epoch: 7 | loss: 0.4330371
	speed: 0.0046s/iter; left time: 5.0666s
Updating learning rate to 2.7324007239324203e-05
Epoch: 7 cost time: 5.247023105621338
Epoch: 7, Steps: 1045 | Train Loss: 0.3844690 Vali Loss: 0.2913252 Best vali loss: 0.2851680
	iters: 100, epoch: 8 | loss: 0.6963199
	speed: 0.0146s/iter; left time: 13.8358s
	iters: 200, epoch: 8 | loss: 0.6473146
	speed: 0.0055s/iter; left time: 4.6659s
	iters: 300, epoch: 8 | loss: 0.6102779
	speed: 0.0051s/iter; left time: 3.7948s
	iters: 400, epoch: 8 | loss: 0.2775857
	speed: 0.0051s/iter; left time: 3.2627s
	iters: 500, epoch: 8 | loss: 0.7950642
	speed: 0.0051s/iter; left time: 2.7799s
	iters: 600, epoch: 8 | loss: 0.2084547
	speed: 0.0051s/iter; left time: 2.2602s
	iters: 700, epoch: 8 | loss: 0.2800789
	speed: 0.0048s/iter; left time: 1.6437s
	iters: 800, epoch: 8 | loss: 0.4878839
	speed: 0.0053s/iter; left time: 1.2995s
	iters: 900, epoch: 8 | loss: 0.3327765
	speed: 0.0053s/iter; left time: 0.7757s
	iters: 1000, epoch: 8 | loss: 0.1715976
	speed: 0.0053s/iter; left time: 0.2433s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.443680047988892
Epoch: 8, Steps: 1045 | Train Loss: 0.4507354 Vali Loss: 0.2927485 Best vali loss: 0.2851680

best validation loss 0.2851680490597334

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050164002415, 'e_layers': 1, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5955390
	speed: 0.0086s/iter; left time: 70.6442s
	iters: 200, epoch: 1 | loss: 1.2493234
	speed: 0.0033s/iter; left time: 26.6448s
	iters: 300, epoch: 1 | loss: 0.4619548
	speed: 0.0032s/iter; left time: 26.1428s
	iters: 400, epoch: 1 | loss: 0.3804772
	speed: 0.0033s/iter; left time: 26.6311s
	iters: 500, epoch: 1 | loss: 0.2020169
	speed: 0.0034s/iter; left time: 26.4015s
	iters: 600, epoch: 1 | loss: 0.6048420
	speed: 0.0033s/iter; left time: 25.8581s
	iters: 700, epoch: 1 | loss: 0.3395358
	speed: 0.0032s/iter; left time: 24.6542s
	iters: 800, epoch: 1 | loss: 0.3296717
	speed: 0.0032s/iter; left time: 24.5539s
	iters: 900, epoch: 1 | loss: 0.4508386
	speed: 0.0032s/iter; left time: 24.0551s
	iters: 1000, epoch: 1 | loss: 0.3663106
	speed: 0.0028s/iter; left time: 20.5802s
Updating learning rate to 0.0005311094169208142
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 3.6279373168945312
Epoch: 1, Steps: 1045 | Train Loss: 0.4980510 Vali Loss: 0.2805102 Best vali loss: 0.2805102
	iters: 100, epoch: 2 | loss: 0.4489152
	speed: 0.0115s/iter; left time: 82.6415s
	iters: 200, epoch: 2 | loss: 0.4930659
	speed: 0.0031s/iter; left time: 21.9039s
	iters: 300, epoch: 2 | loss: 0.2621375
	speed: 0.0031s/iter; left time: 21.6149s
	iters: 400, epoch: 2 | loss: 0.3920352
	speed: 0.0031s/iter; left time: 21.5705s
	iters: 500, epoch: 2 | loss: 0.2441924
	speed: 0.0031s/iter; left time: 21.3373s
	iters: 600, epoch: 2 | loss: 0.2695686
	speed: 0.0031s/iter; left time: 20.8864s
	iters: 700, epoch: 2 | loss: 0.5025924
	speed: 0.0031s/iter; left time: 20.4593s
	iters: 800, epoch: 2 | loss: 0.8067505
	speed: 0.0031s/iter; left time: 19.9848s
	iters: 900, epoch: 2 | loss: 1.3248421
	speed: 0.0030s/iter; left time: 19.2385s
	iters: 1000, epoch: 2 | loss: 0.2929025
	speed: 0.0026s/iter; left time: 16.5338s
Updating learning rate to 0.0004712667668926594
Epoch: 2 cost time: 3.1990602016448975
Epoch: 2, Steps: 1045 | Train Loss: 0.5037002 Vali Loss: 0.2928943 Best vali loss: 0.2805102
	iters: 100, epoch: 3 | loss: 0.2307766
	speed: 0.0113s/iter; left time: 69.8872s
	iters: 200, epoch: 3 | loss: 0.3489325
	speed: 0.0032s/iter; left time: 19.7219s
	iters: 300, epoch: 3 | loss: 0.2752008
	speed: 0.0032s/iter; left time: 19.1346s
	iters: 400, epoch: 3 | loss: 0.2483393
	speed: 0.0033s/iter; left time: 19.0916s
	iters: 500, epoch: 3 | loss: 0.4349809
	speed: 0.0032s/iter; left time: 18.5338s
	iters: 600, epoch: 3 | loss: 0.3355306
	speed: 0.0032s/iter; left time: 18.4164s
	iters: 700, epoch: 3 | loss: 0.4301041
	speed: 0.0032s/iter; left time: 18.0209s
	iters: 800, epoch: 3 | loss: 0.1872726
	speed: 0.0032s/iter; left time: 17.7265s
	iters: 900, epoch: 3 | loss: 0.5647487
	speed: 0.0030s/iter; left time: 16.1271s
	iters: 1000, epoch: 3 | loss: 0.5798656
	speed: 0.0028s/iter; left time: 14.5598s
Updating learning rate to 0.00038170591200734896
Epoch: 3 cost time: 3.323996067047119
Epoch: 3, Steps: 1045 | Train Loss: 0.3635752 Vali Loss: 0.2939058 Best vali loss: 0.2805102
	iters: 100, epoch: 4 | loss: 0.5556515
	speed: 0.0084s/iter; left time: 43.2217s
	iters: 200, epoch: 4 | loss: 1.0434092
	speed: 0.0040s/iter; left time: 19.9998s
	iters: 300, epoch: 4 | loss: 0.5901257
	speed: 0.0062s/iter; left time: 30.3842s
	iters: 400, epoch: 4 | loss: 1.0309209
	speed: 0.0032s/iter; left time: 15.3580s
	iters: 500, epoch: 4 | loss: 0.1916978
	speed: 0.0053s/iter; left time: 25.1905s
	iters: 600, epoch: 4 | loss: 0.1954380
	speed: 0.0054s/iter; left time: 25.1495s
	iters: 700, epoch: 4 | loss: 0.4240822
	speed: 0.0038s/iter; left time: 17.0914s
	iters: 800, epoch: 4 | loss: 0.8768047
	speed: 0.0060s/iter; left time: 26.4063s
	iters: 900, epoch: 4 | loss: 0.2955914
	speed: 0.0040s/iter; left time: 17.3067s
	iters: 1000, epoch: 4 | loss: 0.4299369
	speed: 0.0021s/iter; left time: 9.0261s
Updating learning rate to 0.00027606168055
Epoch: 4 cost time: 4.371314764022827
Epoch: 4, Steps: 1045 | Train Loss: 0.5633658 Vali Loss: 0.3089851 Best vali loss: 0.2805102
	iters: 100, epoch: 5 | loss: 0.4836327
	speed: 0.0090s/iter; left time: 36.7643s
	iters: 200, epoch: 5 | loss: 0.4165735
	speed: 0.0031s/iter; left time: 12.2673s
	iters: 300, epoch: 5 | loss: 0.3271364
	speed: 0.0031s/iter; left time: 11.9992s
	iters: 400, epoch: 5 | loss: 0.2924741
	speed: 0.0031s/iter; left time: 11.6878s
	iters: 500, epoch: 5 | loss: 0.7897148
	speed: 0.0031s/iter; left time: 11.4079s
	iters: 600, epoch: 5 | loss: 0.3433342
	speed: 0.0027s/iter; left time: 9.5669s
	iters: 700, epoch: 5 | loss: 0.1626860
	speed: 0.0026s/iter; left time: 8.8976s
	iters: 800, epoch: 5 | loss: 0.2470088
	speed: 0.0031s/iter; left time: 10.4747s
	iters: 900, epoch: 5 | loss: 0.6497730
	speed: 0.0032s/iter; left time: 10.4444s
	iters: 1000, epoch: 5 | loss: 0.2207157
	speed: 0.0033s/iter; left time: 10.4301s
Updating learning rate to 0.00017041744909265108
Epoch: 5 cost time: 3.2126359939575195
Epoch: 5, Steps: 1045 | Train Loss: 0.3933049 Vali Loss: 0.3063825 Best vali loss: 0.2805102
	iters: 100, epoch: 6 | loss: 0.6059448
	speed: 0.0110s/iter; left time: 33.3756s
	iters: 200, epoch: 6 | loss: 0.5530023
	speed: 0.0033s/iter; left time: 9.7772s
	iters: 300, epoch: 6 | loss: 0.1853701
	speed: 0.0032s/iter; left time: 9.0306s
	iters: 400, epoch: 6 | loss: 0.2773457
	speed: 0.0032s/iter; left time: 8.7144s
	iters: 500, epoch: 6 | loss: 0.2654372
	speed: 0.0032s/iter; left time: 8.5618s
	iters: 600, epoch: 6 | loss: 0.2739977
	speed: 0.0032s/iter; left time: 8.0546s
	iters: 700, epoch: 6 | loss: 0.3300695
	speed: 0.0028s/iter; left time: 6.7873s
	iters: 800, epoch: 6 | loss: 0.4745009
	speed: 0.0029s/iter; left time: 6.6672s
	iters: 900, epoch: 6 | loss: 0.1723371
	speed: 0.0031s/iter; left time: 7.0235s
	iters: 1000, epoch: 6 | loss: 0.7162731
	speed: 0.0031s/iter; left time: 6.6280s
Updating learning rate to 8.085659420734059e-05
Epoch: 6 cost time: 3.243619680404663
Epoch: 6, Steps: 1045 | Train Loss: 0.3854278 Vali Loss: 0.3067712 Best vali loss: 0.2805102
	iters: 100, epoch: 7 | loss: 0.1704721
	speed: 0.0115s/iter; left time: 22.9780s
	iters: 200, epoch: 7 | loss: 0.1994488
	speed: 0.0029s/iter; left time: 5.4653s
	iters: 300, epoch: 7 | loss: 0.2674559
	speed: 0.0031s/iter; left time: 5.6360s
	iters: 400, epoch: 7 | loss: 0.2432276
	speed: 0.0031s/iter; left time: 5.2165s
	iters: 500, epoch: 7 | loss: 0.5445310
	speed: 0.0031s/iter; left time: 4.8953s
	iters: 600, epoch: 7 | loss: 0.1455295
	speed: 0.0031s/iter; left time: 4.6354s
	iters: 700, epoch: 7 | loss: 0.4886289
	speed: 0.0030s/iter; left time: 4.1421s
	iters: 800, epoch: 7 | loss: 0.2109354
	speed: 0.0026s/iter; left time: 3.4140s
	iters: 900, epoch: 7 | loss: 0.1938667
	speed: 0.0023s/iter; left time: 2.7134s
	iters: 1000, epoch: 7 | loss: 0.1491729
	speed: 0.0022s/iter; left time: 2.3880s
Updating learning rate to 2.101394417918582e-05
Epoch: 7 cost time: 2.9450833797454834
Epoch: 7, Steps: 1045 | Train Loss: 0.2613269 Vali Loss: 0.3070945 Best vali loss: 0.2805102
	iters: 100, epoch: 8 | loss: 0.2775937
	speed: 0.0095s/iter; left time: 9.0009s
	iters: 200, epoch: 8 | loss: 0.6787279
	speed: 0.0030s/iter; left time: 2.5001s
	iters: 300, epoch: 8 | loss: 0.7753209
	speed: 0.0029s/iter; left time: 2.1384s
	iters: 400, epoch: 8 | loss: 0.5153562
	speed: 0.0030s/iter; left time: 1.9282s
	iters: 500, epoch: 8 | loss: 0.4733028
	speed: 0.0029s/iter; left time: 1.5603s
	iters: 600, epoch: 8 | loss: 0.2592551
	speed: 0.0029s/iter; left time: 1.2958s
	iters: 700, epoch: 8 | loss: 0.5004066
	speed: 0.0029s/iter; left time: 0.9954s
	iters: 800, epoch: 8 | loss: 0.3685642
	speed: 0.0029s/iter; left time: 0.7075s
	iters: 900, epoch: 8 | loss: 1.5742015
	speed: 0.0029s/iter; left time: 0.4255s
	iters: 1000, epoch: 8 | loss: 0.1884604
	speed: 0.0028s/iter; left time: 0.1298s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0872480869293213
Epoch: 8, Steps: 1045 | Train Loss: 0.5611189 Vali Loss: 0.3077409 Best vali loss: 0.2805102

best validation loss 0.280510171776857

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3778704
	speed: 0.0083s/iter; left time: 34.0727s
	iters: 200, epoch: 1 | loss: 0.3073450
	speed: 0.0025s/iter; left time: 10.0848s
	iters: 300, epoch: 1 | loss: 0.2819551
	speed: 0.0027s/iter; left time: 10.4116s
	iters: 400, epoch: 1 | loss: 0.2808533
	speed: 0.0031s/iter; left time: 11.8255s
	iters: 500, epoch: 1 | loss: 0.6682380
	speed: 0.0031s/iter; left time: 11.6076s
Updating learning rate to 0.0001961966354
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.784764289855957
Epoch: 1, Steps: 523 | Train Loss: 0.3832524 Vali Loss: 0.2812696 Best vali loss: 0.2812696
	iters: 100, epoch: 2 | loss: 0.9001135
	speed: 0.0077s/iter; left time: 27.2816s
	iters: 200, epoch: 2 | loss: 0.3249328
	speed: 0.0028s/iter; left time: 9.7180s
	iters: 300, epoch: 2 | loss: 0.5733476
	speed: 0.0027s/iter; left time: 9.0444s
	iters: 400, epoch: 2 | loss: 0.4199890
	speed: 0.0031s/iter; left time: 10.0987s
	iters: 500, epoch: 2 | loss: 0.5909984
	speed: 0.0031s/iter; left time: 9.6760s
Updating learning rate to 9.80983177e-05
Epoch: 2 cost time: 1.5806810855865479
Epoch: 2, Steps: 523 | Train Loss: 0.5618763 Vali Loss: 0.2866284 Best vali loss: 0.2812696
	iters: 100, epoch: 3 | loss: 0.4164024
	speed: 0.0074s/iter; left time: 22.6134s
	iters: 200, epoch: 3 | loss: 0.3177823
	speed: 0.0029s/iter; left time: 8.5122s
	iters: 300, epoch: 3 | loss: 0.8096623
	speed: 0.0029s/iter; left time: 8.1356s
	iters: 400, epoch: 3 | loss: 0.6959976
	speed: 0.0030s/iter; left time: 8.0941s
	iters: 500, epoch: 3 | loss: 0.3952090
	speed: 0.0030s/iter; left time: 7.9540s
Updating learning rate to 4.904915885e-05
Epoch: 3 cost time: 1.57334566116333
Epoch: 3, Steps: 523 | Train Loss: 0.5270107 Vali Loss: 0.2870364 Best vali loss: 0.2812696

best validation loss 0.28126963298641733

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0074951894677, 'e_layers': 4, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7882240
	speed: 0.0121s/iter; left time: 49.2414s
	iters: 200, epoch: 1 | loss: 0.3628947
	speed: 0.0061s/iter; left time: 24.2349s
	iters: 300, epoch: 1 | loss: 0.8878181
	speed: 0.0063s/iter; left time: 24.5785s
	iters: 400, epoch: 1 | loss: 0.3089517
	speed: 0.0052s/iter; left time: 19.6809s
	iters: 500, epoch: 1 | loss: 0.4072676
	speed: 0.0052s/iter; left time: 19.2793s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.3275).  Saving model state dict ...
Epoch: 1 cost time: 3.3727636337280273
Epoch: 1, Steps: 523 | Train Loss: 0.5510312 Vali Loss: 0.3275361 Best vali loss: 0.3275361
	iters: 100, epoch: 2 | loss: 0.2640913
	speed: 0.0123s/iter; left time: 43.7189s
	iters: 200, epoch: 2 | loss: 0.7694651
	speed: 0.0053s/iter; left time: 18.3577s
	iters: 300, epoch: 2 | loss: 0.4033761
	speed: 0.0049s/iter; left time: 16.3248s
	iters: 400, epoch: 2 | loss: 0.9778463
	speed: 0.0063s/iter; left time: 20.6735s
	iters: 500, epoch: 2 | loss: 0.4950922
	speed: 0.0064s/iter; left time: 20.1460s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.3275 --> 0.3262).  Saving model state dict ...
Epoch: 2 cost time: 3.061281681060791
Epoch: 2, Steps: 523 | Train Loss: 0.5819742 Vali Loss: 0.3261751 Best vali loss: 0.3261751
	iters: 100, epoch: 3 | loss: 0.3014762
	speed: 0.0131s/iter; left time: 39.7089s
	iters: 200, epoch: 3 | loss: 0.2464067
	speed: 0.0064s/iter; left time: 18.8811s
	iters: 300, epoch: 3 | loss: 0.3361730
	speed: 0.0062s/iter; left time: 17.6420s
	iters: 400, epoch: 3 | loss: 0.3443145
	speed: 0.0048s/iter; left time: 13.2062s
	iters: 500, epoch: 3 | loss: 0.3055649
	speed: 0.0050s/iter; left time: 13.2432s
Updating learning rate to 0.0008955266062
Validation loss decreased (0.3262 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 3.048769474029541
Epoch: 3, Steps: 523 | Train Loss: 0.3067870 Vali Loss: 0.3226354 Best vali loss: 0.3226354

best validation loss 0.3226353502314567

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3430311
	speed: 0.0135s/iter; left time: 12.8000s
Updating learning rate to 0.0006870327933
Validation loss decreased (inf --> 0.2929).  Saving model state dict ...
Epoch: 1 cost time: 1.3483715057373047
Epoch: 1, Steps: 131 | Train Loss: 0.3430311 Vali Loss: 0.2928652 Best vali loss: 0.2928652
	iters: 100, epoch: 2 | loss: 0.5595227
	speed: 0.0130s/iter; left time: 10.6728s
Updating learning rate to 0.00034351639665
Epoch: 2 cost time: 1.0929629802703857
Epoch: 2, Steps: 131 | Train Loss: 0.5595227 Vali Loss: 0.2929215 Best vali loss: 0.2928652
	iters: 100, epoch: 3 | loss: 0.4529664
	speed: 0.0121s/iter; left time: 8.3224s
Updating learning rate to 0.000171758198325
Validation loss decreased (0.2929 --> 0.2866).  Saving model state dict ...
Epoch: 3 cost time: 0.9974939823150635
Epoch: 3, Steps: 131 | Train Loss: 0.4529664 Vali Loss: 0.2866388 Best vali loss: 0.2866388

best validation loss 0.28663879284942045

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3531964
	speed: 0.0086s/iter; left time: 21.7325s
	iters: 200, epoch: 4 | loss: 0.3045684
	speed: 0.0028s/iter; left time: 6.7145s
	iters: 300, epoch: 4 | loss: 0.2643724
	speed: 0.0025s/iter; left time: 5.6890s
	iters: 400, epoch: 4 | loss: 0.2842594
	speed: 0.0024s/iter; left time: 5.2392s
	iters: 500, epoch: 4 | loss: 0.6483017
	speed: 0.0025s/iter; left time: 5.2452s
Updating learning rate to 2.4524579425e-05
Epoch: 4 cost time: 1.6609292030334473
Epoch: 4, Steps: 523 | Train Loss: 0.3709396 Vali Loss: 0.2871263 Best vali loss: 0.2812696
	iters: 100, epoch: 5 | loss: 0.8521855
	speed: 0.0085s/iter; left time: 16.9014s
	iters: 200, epoch: 5 | loss: 0.2963808
	speed: 0.0034s/iter; left time: 6.3531s
	iters: 300, epoch: 5 | loss: 0.5657057
	speed: 0.0026s/iter; left time: 4.5769s
	iters: 400, epoch: 5 | loss: 0.3556440
	speed: 0.0030s/iter; left time: 5.0075s
	iters: 500, epoch: 5 | loss: 0.5377394
	speed: 0.0030s/iter; left time: 4.7186s
Updating learning rate to 1.22622897125e-05
Epoch: 5 cost time: 1.6574347019195557
Epoch: 5, Steps: 523 | Train Loss: 0.5215311 Vali Loss: 0.2886262 Best vali loss: 0.2812696
	iters: 100, epoch: 6 | loss: 0.3719516
	speed: 0.0073s/iter; left time: 10.7529s
	iters: 200, epoch: 6 | loss: 0.3130164
	speed: 0.0032s/iter; left time: 4.3867s
	iters: 300, epoch: 6 | loss: 0.7829434
	speed: 0.0034s/iter; left time: 4.2759s
	iters: 400, epoch: 6 | loss: 0.6327751
	speed: 0.0031s/iter; left time: 3.6605s
	iters: 500, epoch: 6 | loss: 0.3946795
	speed: 0.0023s/iter; left time: 2.4845s
Updating learning rate to 6.13114485625e-06
Epoch: 6 cost time: 1.5598163604736328
Epoch: 6, Steps: 523 | Train Loss: 0.4990732 Vali Loss: 0.2885400 Best vali loss: 0.2812696
	iters: 100, epoch: 7 | loss: 0.5814134
	speed: 0.0085s/iter; left time: 8.0899s
	iters: 200, epoch: 7 | loss: 0.2389673
	speed: 0.0031s/iter; left time: 2.6401s
	iters: 300, epoch: 7 | loss: 0.3498231
	speed: 0.0028s/iter; left time: 2.0750s
	iters: 400, epoch: 7 | loss: 0.6328342
	speed: 0.0031s/iter; left time: 1.9851s
	iters: 500, epoch: 7 | loss: 0.5262240
	speed: 0.0031s/iter; left time: 1.6692s
Updating learning rate to 3.065572428125e-06
Epoch: 7 cost time: 1.6793596744537354
Epoch: 7, Steps: 523 | Train Loss: 0.4658524 Vali Loss: 0.2877231 Best vali loss: 0.2812696
	iters: 100, epoch: 8 | loss: 0.5695804
	speed: 0.0069s/iter; left time: 2.9378s
	iters: 200, epoch: 8 | loss: 0.6104807
	speed: 0.0022s/iter; left time: 0.7198s
	iters: 300, epoch: 8 | loss: 0.4124922
	speed: 0.0023s/iter; left time: 0.5088s
	iters: 400, epoch: 8 | loss: 0.2783749
	speed: 0.0024s/iter; left time: 0.3023s
	iters: 500, epoch: 8 | loss: 0.3637864
	speed: 0.0028s/iter; left time: 0.0674s
Updating learning rate to 1.5327862140625e-06
Epoch: 8 cost time: 1.3248238563537598
Epoch: 8, Steps: 523 | Train Loss: 0.4469429 Vali Loss: 0.2877756 Best vali loss: 0.2812696

best validation loss 0.28126963298641733

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008116820516, 'e_layers': 1, 'learning_rate': 0.0004109547451, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4667971
	speed: 0.0090s/iter; left time: 8.5426s
Updating learning rate to 0.0003953137114431415
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 0.7366054058074951
Epoch: 1, Steps: 131 | Train Loss: 0.4667971 Vali Loss: 0.2861842 Best vali loss: 0.2861842
	iters: 100, epoch: 2 | loss: 0.3544263
	speed: 0.0059s/iter; left time: 4.8493s
Updating learning rate to 0.00035077181606049955
Validation loss decreased (0.2862 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 0.43778276443481445
Epoch: 2, Steps: 131 | Train Loss: 0.3544263 Vali Loss: 0.2811790 Best vali loss: 0.2811790
	iters: 100, epoch: 3 | loss: 0.5671523
	speed: 0.0062s/iter; left time: 4.2461s
Updating learning rate to 0.00028411015875079426
Epoch: 3 cost time: 0.49763941764831543
Epoch: 3, Steps: 131 | Train Loss: 0.5671523 Vali Loss: 0.2823246 Best vali loss: 0.2811790
	iters: 100, epoch: 4 | loss: 0.4970837
	speed: 0.0061s/iter; left time: 3.3741s
Updating learning rate to 0.00020547737255
Epoch: 4 cost time: 0.45165371894836426
Epoch: 4, Steps: 131 | Train Loss: 0.4970837 Vali Loss: 0.2865942 Best vali loss: 0.2811790
	iters: 100, epoch: 5 | loss: 0.7141722
	speed: 0.0059s/iter; left time: 2.5102s
Updating learning rate to 0.00012684458634920571
Epoch: 5 cost time: 0.4557931423187256
Epoch: 5, Steps: 131 | Train Loss: 0.7141722 Vali Loss: 0.2844864 Best vali loss: 0.2811790
	iters: 100, epoch: 6 | loss: 0.3301516
	speed: 0.0060s/iter; left time: 1.7561s
Updating learning rate to 6.0182929039500455e-05
Epoch: 6 cost time: 0.4426600933074951
Epoch: 6, Steps: 131 | Train Loss: 0.3301516 Vali Loss: 0.2869786 Best vali loss: 0.2811790
	iters: 100, epoch: 7 | loss: 0.4222495
	speed: 0.0055s/iter; left time: 0.9018s
Updating learning rate to 1.5641033656858497e-05
Epoch: 7 cost time: 0.4265110492706299
Epoch: 7, Steps: 131 | Train Loss: 0.4222495 Vali Loss: 0.2859199 Best vali loss: 0.2811790
	iters: 100, epoch: 8 | loss: 0.5527640
	speed: 0.0056s/iter; left time: 0.1788s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43612098693847656
Epoch: 8, Steps: 131 | Train Loss: 0.5527640 Vali Loss: 0.2861160 Best vali loss: 0.2811790

best validation loss 0.28117895269314125

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.008835229483, 'e_layers': 1, 'learning_rate': 0.0016070226056, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4088912
	speed: 0.0083s/iter; left time: 16.5044s
	iters: 200, epoch: 1 | loss: 0.4991369
	speed: 0.0029s/iter; left time: 5.4408s
Updating learning rate to 0.001545858949598399
Validation loss decreased (inf --> 0.2880).  Saving model state dict ...
Epoch: 1 cost time: 1.0340633392333984
Epoch: 1, Steps: 262 | Train Loss: 0.4540140 Vali Loss: 0.2880115 Best vali loss: 0.2880115
	iters: 100, epoch: 2 | loss: 0.9246597
	speed: 0.0071s/iter; left time: 12.3337s
	iters: 200, epoch: 2 | loss: 0.5249713
	speed: 0.0029s/iter; left time: 4.7420s
Updating learning rate to 0.0013716795937699173
Epoch: 2 cost time: 0.7865924835205078
Epoch: 2, Steps: 262 | Train Loss: 0.7248155 Vali Loss: 0.2880451 Best vali loss: 0.2880115
	iters: 100, epoch: 3 | loss: 0.2653010
	speed: 0.0069s/iter; left time: 10.1782s
	iters: 200, epoch: 3 | loss: 0.7778582
	speed: 0.0029s/iter; left time: 4.0212s
Updating learning rate to 0.0011110017660996491
Epoch: 3 cost time: 0.8025808334350586
Epoch: 3, Steps: 262 | Train Loss: 0.5215796 Vali Loss: 0.2942945 Best vali loss: 0.2880115
	iters: 100, epoch: 4 | loss: 0.4815375
	speed: 0.0073s/iter; left time: 8.8789s
	iters: 200, epoch: 4 | loss: 0.6210433
	speed: 0.0029s/iter; left time: 3.1944s
Updating learning rate to 0.0008035113028
Epoch: 4 cost time: 0.8105742931365967
Epoch: 4, Steps: 262 | Train Loss: 0.5512904 Vali Loss: 0.2897222 Best vali loss: 0.2880115
	iters: 100, epoch: 5 | loss: 0.3625810
	speed: 0.0072s/iter; left time: 6.8466s
	iters: 200, epoch: 5 | loss: 0.3643510
	speed: 0.0029s/iter; left time: 2.4203s
Updating learning rate to 0.0004960208395003511
Epoch: 5 cost time: 0.791754961013794
Epoch: 5, Steps: 262 | Train Loss: 0.3634660 Vali Loss: 0.3148377 Best vali loss: 0.2880115
	iters: 100, epoch: 6 | loss: 0.4441792
	speed: 0.0075s/iter; left time: 5.1183s
	iters: 200, epoch: 6 | loss: 0.2345151
	speed: 0.0030s/iter; left time: 1.7618s
Updating learning rate to 0.00023534301183008273
Epoch: 6 cost time: 0.8371937274932861
Epoch: 6, Steps: 262 | Train Loss: 0.3393472 Vali Loss: 0.3388541 Best vali loss: 0.2880115
	iters: 100, epoch: 7 | loss: 0.3255197
	speed: 0.0073s/iter; left time: 3.0878s
	iters: 200, epoch: 7 | loss: 0.4214921
	speed: 0.0028s/iter; left time: 0.9144s
Updating learning rate to 6.116365600160105e-05
Epoch: 7 cost time: 0.7842388153076172
Epoch: 7, Steps: 262 | Train Loss: 0.3735059 Vali Loss: 0.3345555 Best vali loss: 0.2880115
	iters: 100, epoch: 8 | loss: 0.2480320
	speed: 0.0072s/iter; left time: 1.1763s
	iters: 200, epoch: 8 | loss: 0.4025384
	speed: 0.0029s/iter; left time: 0.1849s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7987697124481201
Epoch: 8, Steps: 262 | Train Loss: 0.3252852 Vali Loss: 0.3466099 Best vali loss: 0.2880115

best validation loss 0.2880115481270162

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.003701149266, 'e_layers': 1, 'learning_rate': 0.0002377962535, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4816803
	speed: 0.0088s/iter; left time: 8.3695s
Updating learning rate to 0.0002377962535
Validation loss decreased (inf --> 0.2969).  Saving model state dict ...
Epoch: 1 cost time: 0.7321908473968506
Epoch: 1, Steps: 131 | Train Loss: 0.4816803 Vali Loss: 0.2968736 Best vali loss: 0.2968736
	iters: 100, epoch: 2 | loss: 0.3603176
	speed: 0.0061s/iter; left time: 5.0156s
Updating learning rate to 0.00011889812675
Validation loss decreased (0.2969 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 0.4609358310699463
Epoch: 2, Steps: 131 | Train Loss: 0.3603176 Vali Loss: 0.2838065 Best vali loss: 0.2838065
	iters: 100, epoch: 3 | loss: 0.5739968
	speed: 0.0061s/iter; left time: 4.2131s
Updating learning rate to 5.9449063375e-05
Validation loss decreased (0.2838 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 0.4776790142059326
Epoch: 3, Steps: 131 | Train Loss: 0.5739968 Vali Loss: 0.2813295 Best vali loss: 0.2813295

best validation loss 0.2813295083956543

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4354533
	speed: 0.0095s/iter; left time: 19.0275s
	iters: 200, epoch: 1 | loss: 0.5251642
	speed: 0.0042s/iter; left time: 8.0000s
Updating learning rate to 0.000380413518
Validation loss decreased (inf --> 0.2809).  Saving model state dict ...
Epoch: 1 cost time: 1.3738226890563965
Epoch: 1, Steps: 262 | Train Loss: 0.4803087 Vali Loss: 0.2808519 Best vali loss: 0.2808519
	iters: 100, epoch: 2 | loss: 0.4155241
	speed: 0.0097s/iter; left time: 16.7965s
	iters: 200, epoch: 2 | loss: 0.5928316
	speed: 0.0042s/iter; left time: 6.9191s
Updating learning rate to 0.000190206759
Epoch: 2 cost time: 1.143585205078125
Epoch: 2, Steps: 262 | Train Loss: 0.5041778 Vali Loss: 0.2892207 Best vali loss: 0.2808519
	iters: 100, epoch: 3 | loss: 0.4930892
	speed: 0.0092s/iter; left time: 13.4932s
	iters: 200, epoch: 3 | loss: 0.6422635
	speed: 0.0038s/iter; left time: 5.1589s
Updating learning rate to 9.51033795e-05
Validation loss decreased (0.2809 --> 0.2791).  Saving model state dict ...
Epoch: 3 cost time: 1.0724480152130127
Epoch: 3, Steps: 262 | Train Loss: 0.5676764 Vali Loss: 0.2791143 Best vali loss: 0.2791143

best validation loss 0.27911430827832745

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038758267905, 'e_layers': 1, 'learning_rate': 0.0011658864209, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5269793
	speed: 0.0084s/iter; left time: 34.4609s
	iters: 200, epoch: 1 | loss: 0.6852611
	speed: 0.0031s/iter; left time: 12.1777s
	iters: 300, epoch: 1 | loss: 1.0789378
	speed: 0.0030s/iter; left time: 11.5924s
	iters: 400, epoch: 1 | loss: 0.3921595
	speed: 0.0030s/iter; left time: 11.4857s
	iters: 500, epoch: 1 | loss: 0.3690827
	speed: 0.0030s/iter; left time: 11.1814s
Updating learning rate to 0.0011215125112011748
Validation loss decreased (inf --> 0.3065).  Saving model state dict ...
Epoch: 1 cost time: 1.8670525550842285
Epoch: 1, Steps: 523 | Train Loss: 0.6104841 Vali Loss: 0.3065450 Best vali loss: 0.3065450
	iters: 100, epoch: 2 | loss: 0.3620297
	speed: 0.0068s/iter; left time: 24.3174s
	iters: 200, epoch: 2 | loss: 0.6777723
	speed: 0.0023s/iter; left time: 8.0521s
	iters: 300, epoch: 2 | loss: 0.5394306
	speed: 0.0024s/iter; left time: 8.1984s
	iters: 400, epoch: 2 | loss: 0.4642608
	speed: 0.0029s/iter; left time: 9.6129s
	iters: 500, epoch: 2 | loss: 0.9129540
	speed: 0.0032s/iter; left time: 10.1052s
Updating learning rate to 0.0009951463076058517
Validation loss decreased (0.3065 --> 0.2935).  Saving model state dict ...
Epoch: 2 cost time: 1.4314513206481934
Epoch: 2, Steps: 523 | Train Loss: 0.5912895 Vali Loss: 0.2934921 Best vali loss: 0.2934921
	iters: 100, epoch: 3 | loss: 0.5994786
	speed: 0.0084s/iter; left time: 25.4111s
	iters: 200, epoch: 3 | loss: 0.5180547
	speed: 0.0032s/iter; left time: 9.3177s
	iters: 300, epoch: 3 | loss: 0.7113864
	speed: 0.0032s/iter; left time: 9.1099s
	iters: 400, epoch: 3 | loss: 0.3089714
	speed: 0.0032s/iter; left time: 8.7130s
	iters: 500, epoch: 3 | loss: 0.3091421
	speed: 0.0031s/iter; left time: 8.2732s
Updating learning rate to 0.0008060259190989309
Epoch: 3 cost time: 1.7096211910247803
Epoch: 3, Steps: 523 | Train Loss: 0.4894066 Vali Loss: 0.2940477 Best vali loss: 0.2934921

best validation loss 0.2934920791690347

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3703993
	speed: 0.0097s/iter; left time: 11.7206s
	iters: 200, epoch: 4 | loss: 0.4086363
	speed: 0.0040s/iter; left time: 4.4501s
Updating learning rate to 4.755168975e-05
Epoch: 4 cost time: 1.3254075050354004
Epoch: 4, Steps: 262 | Train Loss: 0.3895178 Vali Loss: 0.2807249 Best vali loss: 0.2791143
	iters: 100, epoch: 5 | loss: 0.3577318
	speed: 0.0095s/iter; left time: 9.0422s
	iters: 200, epoch: 5 | loss: 0.3946989
	speed: 0.0045s/iter; left time: 3.8161s
Updating learning rate to 2.3775844875e-05
Epoch: 5 cost time: 1.200892686843872
Epoch: 5, Steps: 262 | Train Loss: 0.3762154 Vali Loss: 0.2860737 Best vali loss: 0.2791143
	iters: 100, epoch: 6 | loss: 0.4490730
	speed: 0.0099s/iter; left time: 6.7873s
	iters: 200, epoch: 6 | loss: 0.5432210
	speed: 0.0038s/iter; left time: 2.2342s
Updating learning rate to 1.18879224375e-05
Epoch: 6 cost time: 1.0730929374694824
Epoch: 6, Steps: 262 | Train Loss: 0.4961470 Vali Loss: 0.2833085 Best vali loss: 0.2791143
	iters: 100, epoch: 7 | loss: 0.6019731
	speed: 0.0096s/iter; left time: 4.0864s
	iters: 200, epoch: 7 | loss: 0.2836428
	speed: 0.0043s/iter; left time: 1.4071s
Updating learning rate to 5.94396121875e-06
Epoch: 7 cost time: 1.1970820426940918
Epoch: 7, Steps: 262 | Train Loss: 0.4428080 Vali Loss: 0.2842516 Best vali loss: 0.2791143
	iters: 100, epoch: 8 | loss: 0.3571777
	speed: 0.0101s/iter; left time: 1.6521s
	iters: 200, epoch: 8 | loss: 0.6187190
	speed: 0.0042s/iter; left time: 0.2667s
Updating learning rate to 2.971980609375e-06
Epoch: 8 cost time: 1.178985595703125
Epoch: 8, Steps: 262 | Train Loss: 0.4879484 Vali Loss: 0.2830184 Best vali loss: 0.2791143

best validation loss 0.27911430827832745

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072680941331, 'e_layers': 3, 'learning_rate': 0.0001290367597, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0349234
	speed: 0.0110s/iter; left time: 45.0348s
	iters: 200, epoch: 1 | loss: 0.6462579
	speed: 0.0052s/iter; left time: 20.6768s
	iters: 300, epoch: 1 | loss: 0.4565448
	speed: 0.0049s/iter; left time: 19.1078s
	iters: 400, epoch: 1 | loss: 0.3922929
	speed: 0.0049s/iter; left time: 18.5053s
	iters: 500, epoch: 1 | loss: 0.4872105
	speed: 0.0049s/iter; left time: 18.1734s
Updating learning rate to 0.0001290367597
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 2.9524028301239014
Epoch: 1, Steps: 523 | Train Loss: 0.6034459 Vali Loss: 0.2787407 Best vali loss: 0.2787407
	iters: 100, epoch: 2 | loss: 0.3735714
	speed: 0.0112s/iter; left time: 39.8086s
	iters: 200, epoch: 2 | loss: 0.5631621
	speed: 0.0050s/iter; left time: 17.2750s
	iters: 300, epoch: 2 | loss: 0.4241213
	speed: 0.0053s/iter; left time: 17.6992s
	iters: 400, epoch: 2 | loss: 0.9138509
	speed: 0.0052s/iter; left time: 17.0380s
	iters: 500, epoch: 2 | loss: 0.7731306
	speed: 0.0053s/iter; left time: 16.6504s
Updating learning rate to 6.451837985e-05
Epoch: 2 cost time: 2.724816083908081
Epoch: 2, Steps: 523 | Train Loss: 0.6095673 Vali Loss: 0.2807484 Best vali loss: 0.2787407
	iters: 100, epoch: 3 | loss: 0.4421602
	speed: 0.0118s/iter; left time: 35.8304s
	iters: 200, epoch: 3 | loss: 1.3320260
	speed: 0.0050s/iter; left time: 14.6556s
	iters: 300, epoch: 3 | loss: 0.6338424
	speed: 0.0046s/iter; left time: 13.0183s
	iters: 400, epoch: 3 | loss: 0.4093571
	speed: 0.0052s/iter; left time: 14.1219s
	iters: 500, epoch: 3 | loss: 0.3723136
	speed: 0.0054s/iter; left time: 14.1551s
Updating learning rate to 3.2259189925e-05
Epoch: 3 cost time: 2.7145204544067383
Epoch: 3, Steps: 523 | Train Loss: 0.6379399 Vali Loss: 0.3098010 Best vali loss: 0.2787407
	iters: 100, epoch: 4 | loss: 0.9549112
	speed: 0.0118s/iter; left time: 29.7365s
	iters: 200, epoch: 4 | loss: 0.3047431
	speed: 0.0053s/iter; left time: 12.7320s
	iters: 300, epoch: 4 | loss: 0.5864300
	speed: 0.0051s/iter; left time: 11.8087s
	iters: 400, epoch: 4 | loss: 0.4005164
	speed: 0.0049s/iter; left time: 10.8116s
	iters: 500, epoch: 4 | loss: 0.4414140
	speed: 0.0050s/iter; left time: 10.5147s
Updating learning rate to 1.61295949625e-05
Epoch: 4 cost time: 2.7387661933898926
Epoch: 4, Steps: 523 | Train Loss: 0.5376029 Vali Loss: 0.3080652 Best vali loss: 0.2787407
	iters: 100, epoch: 5 | loss: 0.5752997
	speed: 0.0116s/iter; left time: 23.1003s
	iters: 200, epoch: 5 | loss: 0.6028872
	speed: 0.0050s/iter; left time: 9.4574s
	iters: 300, epoch: 5 | loss: 0.6813126
	speed: 0.0050s/iter; left time: 8.9980s
	iters: 400, epoch: 5 | loss: 0.4055645
	speed: 0.0050s/iter; left time: 8.3817s
	iters: 500, epoch: 5 | loss: 0.3704222
	speed: 0.0048s/iter; left time: 7.6748s
Updating learning rate to 8.06479748125e-06
Epoch: 5 cost time: 2.6578500270843506
Epoch: 5, Steps: 523 | Train Loss: 0.5270972 Vali Loss: 0.3086346 Best vali loss: 0.2787407
	iters: 100, epoch: 6 | loss: 0.3758132
	speed: 0.0119s/iter; left time: 17.4955s
	iters: 200, epoch: 6 | loss: 0.5324041
	speed: 0.0054s/iter; left time: 7.4641s
	iters: 300, epoch: 6 | loss: 0.3176889
	speed: 0.0055s/iter; left time: 6.9395s
	iters: 400, epoch: 6 | loss: 0.2107245
	speed: 0.0055s/iter; left time: 6.4444s
	iters: 500, epoch: 6 | loss: 0.3359157
	speed: 0.0055s/iter; left time: 5.9168s
Updating learning rate to 4.032398740625e-06
Epoch: 6 cost time: 2.9696149826049805
Epoch: 6, Steps: 523 | Train Loss: 0.3545093 Vali Loss: 0.3136228 Best vali loss: 0.2787407
	iters: 100, epoch: 7 | loss: 0.4290406
	speed: 0.0112s/iter; left time: 10.6202s
	iters: 200, epoch: 7 | loss: 0.2183354
	speed: 0.0040s/iter; left time: 3.4076s
	iters: 300, epoch: 7 | loss: 1.0477083
	speed: 0.0042s/iter; left time: 3.1210s
	iters: 400, epoch: 7 | loss: 0.9073951
	speed: 0.0045s/iter; left time: 2.8908s
	iters: 500, epoch: 7 | loss: 0.2071941
	speed: 0.0045s/iter; left time: 2.4736s
Updating learning rate to 2.0161993703125e-06
Epoch: 7 cost time: 2.3672783374786377
Epoch: 7, Steps: 523 | Train Loss: 0.5619347 Vali Loss: 0.3084125 Best vali loss: 0.2787407
	iters: 100, epoch: 8 | loss: 0.3035513
	speed: 0.0098s/iter; left time: 4.1578s
	iters: 200, epoch: 8 | loss: 0.2695390
	speed: 0.0043s/iter; left time: 1.4008s
	iters: 300, epoch: 8 | loss: 0.6821803
	speed: 0.0054s/iter; left time: 1.2136s
	iters: 400, epoch: 8 | loss: 0.4700100
	speed: 0.0054s/iter; left time: 0.6746s
	iters: 500, epoch: 8 | loss: 0.4734686
	speed: 0.0053s/iter; left time: 0.1283s
Updating learning rate to 1.00809968515625e-06
Epoch: 8 cost time: 2.642990827560425
Epoch: 8, Steps: 523 | Train Loss: 0.4397499 Vali Loss: 0.3130433 Best vali loss: 0.2787407

best validation loss 0.27874072296728475

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0008547466509, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4470677
	speed: 0.0116s/iter; left time: 47.5230s
	iters: 200, epoch: 1 | loss: 0.4499299
	speed: 0.0057s/iter; left time: 22.6983s
	iters: 300, epoch: 1 | loss: 0.7848617
	speed: 0.0059s/iter; left time: 22.8401s
	iters: 400, epoch: 1 | loss: 0.6056871
	speed: 0.0059s/iter; left time: 22.2033s
	iters: 500, epoch: 1 | loss: 0.8869489
	speed: 0.0057s/iter; left time: 20.9732s
Updating learning rate to 0.00082221479357454
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 3.337272882461548
Epoch: 1, Steps: 523 | Train Loss: 0.6348991 Vali Loss: 0.2850056 Best vali loss: 0.2850056
	iters: 100, epoch: 2 | loss: 0.5231238
	speed: 0.0134s/iter; left time: 47.7148s
	iters: 200, epoch: 2 | loss: 0.3484983
	speed: 0.0069s/iter; left time: 23.7849s
	iters: 300, epoch: 2 | loss: 0.2605402
	speed: 0.0068s/iter; left time: 22.9705s
	iters: 400, epoch: 2 | loss: 0.8054999
	speed: 0.0065s/iter; left time: 21.2262s
	iters: 500, epoch: 2 | loss: 0.2561323
	speed: 0.0070s/iter; left time: 22.1521s
Updating learning rate to 0.0007295719019739402
Epoch: 2 cost time: 3.593013048171997
Epoch: 2, Steps: 523 | Train Loss: 0.4387589 Vali Loss: 0.2935452 Best vali loss: 0.2850056
	iters: 100, epoch: 3 | loss: 0.6901988
	speed: 0.0132s/iter; left time: 40.1860s
	iters: 200, epoch: 3 | loss: 0.7036310
	speed: 0.0059s/iter; left time: 17.4660s
	iters: 300, epoch: 3 | loss: 0.2988882
	speed: 0.0059s/iter; left time: 16.6286s
	iters: 400, epoch: 3 | loss: 0.4861365
	speed: 0.0060s/iter; left time: 16.4271s
	iters: 500, epoch: 3 | loss: 0.2462440
	speed: 0.0061s/iter; left time: 16.1238s
Updating learning rate to 0.0005909220165344886
Epoch: 3 cost time: 3.236698627471924
Epoch: 3, Steps: 523 | Train Loss: 0.4850197 Vali Loss: 0.2913425 Best vali loss: 0.2850056
	iters: 100, epoch: 4 | loss: 0.2185684
	speed: 0.0131s/iter; left time: 32.9593s
	iters: 200, epoch: 4 | loss: 0.3675894
	speed: 0.0062s/iter; left time: 14.9381s
	iters: 300, epoch: 4 | loss: 0.7462375
	speed: 0.0063s/iter; left time: 14.5510s
	iters: 400, epoch: 4 | loss: 0.6970314
	speed: 0.0062s/iter; left time: 13.7825s
	iters: 500, epoch: 4 | loss: 0.2739102
	speed: 0.0062s/iter; left time: 13.0861s
Updating learning rate to 0.00042737332545
Epoch: 4 cost time: 3.289928436279297
Epoch: 4, Steps: 523 | Train Loss: 0.4606674 Vali Loss: 0.2896997 Best vali loss: 0.2850056
	iters: 100, epoch: 5 | loss: 0.2992735
	speed: 0.0126s/iter; left time: 25.0470s
	iters: 200, epoch: 5 | loss: 0.5029827
	speed: 0.0053s/iter; left time: 9.9706s
	iters: 300, epoch: 5 | loss: 0.3163160
	speed: 0.0064s/iter; left time: 11.5344s
	iters: 400, epoch: 5 | loss: 0.2043661
	speed: 0.0067s/iter; left time: 11.2698s
	iters: 500, epoch: 5 | loss: 0.7772669
	speed: 0.0065s/iter; left time: 10.3028s
Updating learning rate to 0.00026382463436551147
Validation loss decreased (0.2850 --> 0.2839).  Saving model state dict ...
Epoch: 5 cost time: 3.2848286628723145
Epoch: 5, Steps: 523 | Train Loss: 0.4200411 Vali Loss: 0.2838789 Best vali loss: 0.2838789
	iters: 100, epoch: 6 | loss: 0.3629153
	speed: 0.0134s/iter; left time: 19.6999s
	iters: 200, epoch: 6 | loss: 0.8419361
	speed: 0.0062s/iter; left time: 8.4390s
	iters: 300, epoch: 6 | loss: 0.3123992
	speed: 0.0062s/iter; left time: 7.8660s
	iters: 400, epoch: 6 | loss: 0.2621839
	speed: 0.0062s/iter; left time: 7.3061s
	iters: 500, epoch: 6 | loss: 0.6830006
	speed: 0.0061s/iter; left time: 6.5135s
Updating learning rate to 0.0001251747489260597
Epoch: 6 cost time: 3.277996778488159
Epoch: 6, Steps: 523 | Train Loss: 0.4924870 Vali Loss: 0.2881346 Best vali loss: 0.2838789
	iters: 100, epoch: 7 | loss: 0.5632522
	speed: 0.0128s/iter; left time: 12.0812s
	iters: 200, epoch: 7 | loss: 0.1716952
	speed: 0.0064s/iter; left time: 5.4161s
	iters: 300, epoch: 7 | loss: 0.5054187
	speed: 0.0064s/iter; left time: 4.7701s
	iters: 400, epoch: 7 | loss: 0.6873358
	speed: 0.0063s/iter; left time: 4.0585s
	iters: 500, epoch: 7 | loss: 0.5695804
	speed: 0.0063s/iter; left time: 3.4513s
Updating learning rate to 3.253185732546e-05
Epoch: 7 cost time: 3.3483734130859375
Epoch: 7, Steps: 523 | Train Loss: 0.4994565 Vali Loss: 0.2882249 Best vali loss: 0.2838789
	iters: 100, epoch: 8 | loss: 0.1728325
	speed: 0.0134s/iter; left time: 5.6685s
	iters: 200, epoch: 8 | loss: 0.6272928
	speed: 0.0062s/iter; left time: 2.0057s
	iters: 300, epoch: 8 | loss: 0.2121400
	speed: 0.0060s/iter; left time: 1.3364s
	iters: 400, epoch: 8 | loss: 0.4723297
	speed: 0.0059s/iter; left time: 0.7295s
	iters: 500, epoch: 8 | loss: 0.2301974
	speed: 0.0062s/iter; left time: 0.1490s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2499639987945557
Epoch: 8, Steps: 523 | Train Loss: 0.3429585 Vali Loss: 0.2869110 Best vali loss: 0.2838789

best validation loss 0.28387886689204894

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0076310052387, 'e_layers': 2, 'learning_rate': 6.80015623e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.80015623e-05
Validation loss decreased (inf --> 0.3533).  Saving model state dict ...
Epoch: 1 cost time: 0.6727063655853271
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3532815 Best vali loss: 0.3532815
Updating learning rate to 3.400078115e-05
Validation loss decreased (0.3533 --> 0.3416).  Saving model state dict ...
Epoch: 2 cost time: 0.40108418464660645
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3416483 Best vali loss: 0.3416483
Updating learning rate to 1.7000390575e-05
Validation loss decreased (0.3416 --> 0.3367).  Saving model state dict ...
Epoch: 3 cost time: 0.3914296627044678
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3367252 Best vali loss: 0.3367252

best validation loss 0.33672516463014796

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3496683
	speed: 0.0108s/iter; left time: 89.3798s
	iters: 200, epoch: 1 | loss: 0.3007651
	speed: 0.0048s/iter; left time: 39.4193s
	iters: 300, epoch: 1 | loss: 0.7654551
	speed: 0.0040s/iter; left time: 32.3212s
	iters: 400, epoch: 1 | loss: 0.3738531
	speed: 0.0038s/iter; left time: 30.4810s
	iters: 500, epoch: 1 | loss: 0.3378754
	speed: 0.0048s/iter; left time: 37.4650s
	iters: 600, epoch: 1 | loss: 0.2249204
	speed: 0.0054s/iter; left time: 41.6176s
	iters: 700, epoch: 1 | loss: 0.4062102
	speed: 0.0054s/iter; left time: 41.1609s
	iters: 800, epoch: 1 | loss: 0.2216587
	speed: 0.0054s/iter; left time: 40.5786s
	iters: 900, epoch: 1 | loss: 0.1361405
	speed: 0.0053s/iter; left time: 39.8535s
	iters: 1000, epoch: 1 | loss: 0.6112140
	speed: 0.0053s/iter; left time: 39.2477s
Updating learning rate to 0.0010132106523
Validation loss decreased (inf --> 0.2975).  Saving model state dict ...
Epoch: 1 cost time: 5.478903532028198
Epoch: 1, Steps: 1045 | Train Loss: 0.3727761 Vali Loss: 0.2975451 Best vali loss: 0.2975451
	iters: 100, epoch: 2 | loss: 0.3000128
	speed: 0.0174s/iter; left time: 125.5506s
	iters: 200, epoch: 2 | loss: 0.3036449
	speed: 0.0053s/iter; left time: 37.7352s
	iters: 300, epoch: 2 | loss: 0.7115985
	speed: 0.0050s/iter; left time: 34.8476s
	iters: 400, epoch: 2 | loss: 0.3060739
	speed: 0.0049s/iter; left time: 34.0118s
	iters: 500, epoch: 2 | loss: 0.2964771
	speed: 0.0050s/iter; left time: 34.3392s
	iters: 600, epoch: 2 | loss: 0.6750509
	speed: 0.0053s/iter; left time: 35.3916s
	iters: 700, epoch: 2 | loss: 1.3479255
	speed: 0.0052s/iter; left time: 34.6077s
	iters: 800, epoch: 2 | loss: 0.3797433
	speed: 0.0053s/iter; left time: 34.4594s
	iters: 900, epoch: 2 | loss: 0.3573248
	speed: 0.0053s/iter; left time: 33.7334s
	iters: 1000, epoch: 2 | loss: 0.3091319
	speed: 0.0053s/iter; left time: 33.1989s
Updating learning rate to 0.00050660532615
Validation loss decreased (0.2975 --> 0.2919).  Saving model state dict ...
Epoch: 2 cost time: 5.493305921554565
Epoch: 2, Steps: 1045 | Train Loss: 0.4986984 Vali Loss: 0.2919263 Best vali loss: 0.2919263
	iters: 100, epoch: 3 | loss: 0.4882445
	speed: 0.0173s/iter; left time: 106.6628s
	iters: 200, epoch: 3 | loss: 0.2969356
	speed: 0.0052s/iter; left time: 31.5898s
	iters: 300, epoch: 3 | loss: 0.4859598
	speed: 0.0049s/iter; left time: 29.2089s
	iters: 400, epoch: 3 | loss: 0.4129684
	speed: 0.0048s/iter; left time: 28.3514s
	iters: 500, epoch: 3 | loss: 0.2585974
	speed: 0.0051s/iter; left time: 29.4870s
	iters: 600, epoch: 3 | loss: 0.4906202
	speed: 0.0053s/iter; left time: 30.1942s
	iters: 700, epoch: 3 | loss: 0.2116342
	speed: 0.0053s/iter; left time: 29.4264s
	iters: 800, epoch: 3 | loss: 1.1923683
	speed: 0.0052s/iter; left time: 28.4806s
	iters: 900, epoch: 3 | loss: 0.1592493
	speed: 0.0052s/iter; left time: 28.1587s
	iters: 1000, epoch: 3 | loss: 0.1654334
	speed: 0.0053s/iter; left time: 27.9715s
Updating learning rate to 0.000253302663075
Validation loss decreased (0.2919 --> 0.2843).  Saving model state dict ...
Epoch: 3 cost time: 5.471085786819458
Epoch: 3, Steps: 1045 | Train Loss: 0.4162011 Vali Loss: 0.2843336 Best vali loss: 0.2843336

best validation loss 0.28433363580180615

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0028298480595, 'e_layers': 3, 'learning_rate': 0.0049106915834, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4292256
	speed: 0.0110s/iter; left time: 90.7854s
	iters: 200, epoch: 1 | loss: 0.2385767
	speed: 0.0053s/iter; left time: 42.9427s
	iters: 300, epoch: 1 | loss: 0.3947983
	speed: 0.0056s/iter; left time: 45.2208s
	iters: 400, epoch: 1 | loss: 0.4385753
	speed: 0.0058s/iter; left time: 46.1028s
	iters: 500, epoch: 1 | loss: 0.4438712
	speed: 0.0057s/iter; left time: 44.6864s
	iters: 600, epoch: 1 | loss: 1.2801937
	speed: 0.0056s/iter; left time: 43.6717s
	iters: 700, epoch: 1 | loss: 0.2825243
	speed: 0.0054s/iter; left time: 40.9966s
	iters: 800, epoch: 1 | loss: 0.2343782
	speed: 0.0054s/iter; left time: 40.8308s
	iters: 900, epoch: 1 | loss: 0.3184907
	speed: 0.0052s/iter; left time: 39.0859s
	iters: 1000, epoch: 1 | loss: 0.2500707
	speed: 0.0053s/iter; left time: 39.3040s
Updating learning rate to 0.004723789513889351
Validation loss decreased (inf --> 0.3177).  Saving model state dict ...
Epoch: 1 cost time: 6.006412029266357
Epoch: 1, Steps: 1045 | Train Loss: 0.4310705 Vali Loss: 0.3176572 Best vali loss: 0.3176572
	iters: 100, epoch: 2 | loss: 0.5273100
	speed: 0.0166s/iter; left time: 120.0749s
	iters: 200, epoch: 2 | loss: 0.5333949
	speed: 0.0049s/iter; left time: 34.8597s
	iters: 300, epoch: 2 | loss: 0.4263383
	speed: 0.0051s/iter; left time: 35.8439s
	iters: 400, epoch: 2 | loss: 0.3324087
	speed: 0.0054s/iter; left time: 37.6572s
	iters: 500, epoch: 2 | loss: 0.4340295
	speed: 0.0054s/iter; left time: 36.9160s
	iters: 600, epoch: 2 | loss: 0.5015984
	speed: 0.0054s/iter; left time: 36.3694s
	iters: 700, epoch: 2 | loss: 1.4566824
	speed: 0.0054s/iter; left time: 35.8555s
	iters: 800, epoch: 2 | loss: 0.4279943
	speed: 0.0054s/iter; left time: 35.2927s
	iters: 900, epoch: 2 | loss: 0.2837510
	speed: 0.0054s/iter; left time: 34.8025s
	iters: 1000, epoch: 2 | loss: 0.3582272
	speed: 0.0054s/iter; left time: 34.2616s
Updating learning rate to 0.004191537451168922
Epoch: 2 cost time: 5.591161727905273
Epoch: 2, Steps: 1045 | Train Loss: 0.5281735 Vali Loss: 0.3330222 Best vali loss: 0.3176572
	iters: 100, epoch: 3 | loss: 0.3823230
	speed: 0.0165s/iter; left time: 101.5683s
	iters: 200, epoch: 3 | loss: 0.9691440
	speed: 0.0048s/iter; left time: 28.9603s
	iters: 300, epoch: 3 | loss: 0.5635122
	speed: 0.0043s/iter; left time: 25.7025s
	iters: 400, epoch: 3 | loss: 0.4752921
	speed: 0.0040s/iter; left time: 23.5964s
	iters: 500, epoch: 3 | loss: 1.2467421
	speed: 0.0051s/iter; left time: 29.1470s
	iters: 600, epoch: 3 | loss: 0.1740913
	speed: 0.0054s/iter; left time: 30.4114s
	iters: 700, epoch: 3 | loss: 0.3803167
	speed: 0.0054s/iter; left time: 30.0936s
	iters: 800, epoch: 3 | loss: 0.4434508
	speed: 0.0055s/iter; left time: 30.2734s
	iters: 900, epoch: 3 | loss: 0.3825041
	speed: 0.0055s/iter; left time: 29.4867s
	iters: 1000, epoch: 3 | loss: 0.2272516
	speed: 0.0054s/iter; left time: 28.4944s
Updating learning rate to 0.003394965946910935
Epoch: 3 cost time: 5.317378044128418
Epoch: 3, Steps: 1045 | Train Loss: 0.5244628 Vali Loss: 0.3225883 Best vali loss: 0.3176572

best validation loss 0.3176571577731984

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3177724
	speed: 0.0107s/iter; left time: 54.8755s
	iters: 200, epoch: 4 | loss: 0.2744542
	speed: 0.0050s/iter; left time: 25.2920s
	iters: 300, epoch: 4 | loss: 0.7601751
	speed: 0.0051s/iter; left time: 25.2751s
	iters: 400, epoch: 4 | loss: 0.3353289
	speed: 0.0049s/iter; left time: 23.4494s
	iters: 500, epoch: 4 | loss: 0.3465981
	speed: 0.0050s/iter; left time: 23.8444s
	iters: 600, epoch: 4 | loss: 0.2089662
	speed: 0.0051s/iter; left time: 23.3891s
	iters: 700, epoch: 4 | loss: 0.4077975
	speed: 0.0051s/iter; left time: 22.8827s
	iters: 800, epoch: 4 | loss: 0.1918507
	speed: 0.0050s/iter; left time: 22.2275s
	iters: 900, epoch: 4 | loss: 0.1196093
	speed: 0.0050s/iter; left time: 21.7780s
	iters: 1000, epoch: 4 | loss: 0.5897433
	speed: 0.0046s/iter; left time: 19.5233s
Updating learning rate to 0.0001266513315375
Epoch: 4 cost time: 5.500363111495972
Epoch: 4, Steps: 1045 | Train Loss: 0.3552296 Vali Loss: 0.2903436 Best vali loss: 0.2843336
	iters: 100, epoch: 5 | loss: 0.2805319
	speed: 0.0160s/iter; left time: 65.1888s
	iters: 200, epoch: 5 | loss: 0.2231093
	speed: 0.0054s/iter; left time: 21.6819s
	iters: 300, epoch: 5 | loss: 0.5686533
	speed: 0.0054s/iter; left time: 20.8397s
	iters: 400, epoch: 5 | loss: 0.3020761
	speed: 0.0054s/iter; left time: 20.4456s
	iters: 500, epoch: 5 | loss: 0.2842046
	speed: 0.0056s/iter; left time: 20.5800s
	iters: 600, epoch: 5 | loss: 0.5572989
	speed: 0.0058s/iter; left time: 20.6091s
	iters: 700, epoch: 5 | loss: 0.9832455
	speed: 0.0052s/iter; left time: 18.2426s
	iters: 800, epoch: 5 | loss: 0.3272631
	speed: 0.0051s/iter; left time: 17.3758s
	iters: 900, epoch: 5 | loss: 0.2096170
	speed: 0.0050s/iter; left time: 16.3412s
	iters: 1000, epoch: 5 | loss: 0.3274086
	speed: 0.0053s/iter; left time: 16.8459s
Updating learning rate to 6.332566576875e-05
Epoch: 5 cost time: 5.629058361053467
Epoch: 5, Steps: 1045 | Train Loss: 0.4063408 Vali Loss: 0.2996256 Best vali loss: 0.2843336
	iters: 100, epoch: 6 | loss: 0.4666262
	speed: 0.0163s/iter; left time: 49.3712s
	iters: 200, epoch: 6 | loss: 0.2051263
	speed: 0.0054s/iter; left time: 15.8783s
	iters: 300, epoch: 6 | loss: 0.3872964
	speed: 0.0054s/iter; left time: 15.2504s
	iters: 400, epoch: 6 | loss: 0.3764399
	speed: 0.0054s/iter; left time: 14.8514s
	iters: 500, epoch: 6 | loss: 0.2449760
	speed: 0.0054s/iter; left time: 14.2930s
	iters: 600, epoch: 6 | loss: 0.4964378
	speed: 0.0049s/iter; left time: 12.3422s
	iters: 700, epoch: 6 | loss: 0.2113571
	speed: 0.0046s/iter; left time: 11.2771s
	iters: 800, epoch: 6 | loss: 1.0541041
	speed: 0.0054s/iter; left time: 12.5001s
	iters: 900, epoch: 6 | loss: 0.1520041
	speed: 0.0051s/iter; left time: 11.4264s
	iters: 1000, epoch: 6 | loss: 0.1722513
	speed: 0.0048s/iter; left time: 10.3378s
Updating learning rate to 3.1662832884375e-05
Epoch: 6 cost time: 5.432328701019287
Epoch: 6, Steps: 1045 | Train Loss: 0.3766619 Vali Loss: 0.2992492 Best vali loss: 0.2843336
	iters: 100, epoch: 7 | loss: 0.1842343
	speed: 0.0167s/iter; left time: 33.2914s
	iters: 200, epoch: 7 | loss: 0.2761958
	speed: 0.0057s/iter; left time: 10.7474s
	iters: 300, epoch: 7 | loss: 0.3076246
	speed: 0.0056s/iter; left time: 10.1113s
	iters: 400, epoch: 7 | loss: 0.2539979
	speed: 0.0049s/iter; left time: 8.2867s
	iters: 500, epoch: 7 | loss: 0.2026090
	speed: 0.0045s/iter; left time: 7.2356s
	iters: 600, epoch: 7 | loss: 0.1793412
	speed: 0.0048s/iter; left time: 7.2285s
	iters: 700, epoch: 7 | loss: 0.3853985
	speed: 0.0050s/iter; left time: 6.9486s
	iters: 800, epoch: 7 | loss: 0.6003962
	speed: 0.0049s/iter; left time: 6.2795s
	iters: 900, epoch: 7 | loss: 0.4274491
	speed: 0.0049s/iter; left time: 5.7864s
	iters: 1000, epoch: 7 | loss: 0.3832260
	speed: 0.0049s/iter; left time: 5.3342s
Updating learning rate to 1.58314164421875e-05
Epoch: 7 cost time: 5.320797443389893
Epoch: 7, Steps: 1045 | Train Loss: 0.3200473 Vali Loss: 0.3021356 Best vali loss: 0.2843336
	iters: 100, epoch: 8 | loss: 0.4052120
	speed: 0.0160s/iter; left time: 15.1676s
	iters: 200, epoch: 8 | loss: 0.2363168
	speed: 0.0052s/iter; left time: 4.3639s
	iters: 300, epoch: 8 | loss: 0.3954517
	speed: 0.0044s/iter; left time: 3.3192s
	iters: 400, epoch: 8 | loss: 0.8470915
	speed: 0.0045s/iter; left time: 2.9075s
	iters: 500, epoch: 8 | loss: 0.9407081
	speed: 0.0052s/iter; left time: 2.8234s
	iters: 600, epoch: 8 | loss: 0.4064250
	speed: 0.0049s/iter; left time: 2.1637s
	iters: 700, epoch: 8 | loss: 0.2475753
	speed: 0.0049s/iter; left time: 1.6845s
	iters: 800, epoch: 8 | loss: 0.4855309
	speed: 0.0051s/iter; left time: 1.2528s
	iters: 900, epoch: 8 | loss: 1.0256666
	speed: 0.0050s/iter; left time: 0.7308s
	iters: 1000, epoch: 8 | loss: 0.5641983
	speed: 0.0047s/iter; left time: 0.2154s
Updating learning rate to 7.91570822109375e-06
Epoch: 8 cost time: 5.156906604766846
Epoch: 8, Steps: 1045 | Train Loss: 0.5554176 Vali Loss: 0.3034276 Best vali loss: 0.2843336

best validation loss 0.28433363580180615

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0049587887577, 'e_layers': 2, 'learning_rate': 0.0017288793159, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6069652
	speed: 0.0100s/iter; left time: 82.2936s
	iters: 200, epoch: 1 | loss: 0.3248434
	speed: 0.0045s/iter; left time: 36.3289s
	iters: 300, epoch: 1 | loss: 0.6839104
	speed: 0.0044s/iter; left time: 35.8310s
	iters: 400, epoch: 1 | loss: 1.5789624
	speed: 0.0045s/iter; left time: 35.5425s
	iters: 500, epoch: 1 | loss: 0.3643593
	speed: 0.0044s/iter; left time: 34.8899s
	iters: 600, epoch: 1 | loss: 1.2396976
	speed: 0.0043s/iter; left time: 33.3963s
	iters: 700, epoch: 1 | loss: 0.6687092
	speed: 0.0043s/iter; left time: 33.0092s
	iters: 800, epoch: 1 | loss: 0.4421739
	speed: 0.0042s/iter; left time: 31.9374s
	iters: 900, epoch: 1 | loss: 0.8446441
	speed: 0.0042s/iter; left time: 31.2962s
	iters: 1000, epoch: 1 | loss: 0.6629962
	speed: 0.0043s/iter; left time: 31.4625s
Updating learning rate to 0.0016630777650210626
Validation loss decreased (inf --> 0.3144).  Saving model state dict ...
Epoch: 1 cost time: 4.8417510986328125
Epoch: 1, Steps: 1045 | Train Loss: 0.7417262 Vali Loss: 0.3144317 Best vali loss: 0.3144317
	iters: 100, epoch: 2 | loss: 1.0468768
	speed: 0.0126s/iter; left time: 90.5714s
	iters: 200, epoch: 2 | loss: 0.7971045
	speed: 0.0031s/iter; left time: 21.9390s
	iters: 300, epoch: 2 | loss: 0.9697068
	speed: 0.0034s/iter; left time: 23.6517s
	iters: 400, epoch: 2 | loss: 1.2000458
	speed: 0.0044s/iter; left time: 30.4916s
	iters: 500, epoch: 2 | loss: 0.3662265
	speed: 0.0044s/iter; left time: 29.6521s
	iters: 600, epoch: 2 | loss: 0.1623945
	speed: 0.0043s/iter; left time: 28.6963s
	iters: 700, epoch: 2 | loss: 0.4473663
	speed: 0.0043s/iter; left time: 28.2055s
	iters: 800, epoch: 2 | loss: 0.3399127
	speed: 0.0043s/iter; left time: 28.0590s
	iters: 900, epoch: 2 | loss: 0.3368003
	speed: 0.0036s/iter; left time: 23.1610s
	iters: 1000, epoch: 2 | loss: 1.0294042
	speed: 0.0038s/iter; left time: 23.7518s
Updating learning rate to 0.0014756908020130246
Epoch: 2 cost time: 4.101005554199219
Epoch: 2, Steps: 1045 | Train Loss: 0.6695838 Vali Loss: 0.3211313 Best vali loss: 0.3144317
	iters: 100, epoch: 3 | loss: 0.5709740
	speed: 0.0145s/iter; left time: 89.4282s
	iters: 200, epoch: 3 | loss: 0.3269711
	speed: 0.0044s/iter; left time: 26.5350s
	iters: 300, epoch: 3 | loss: 0.3378384
	speed: 0.0040s/iter; left time: 23.5976s
	iters: 400, epoch: 3 | loss: 0.9612574
	speed: 0.0040s/iter; left time: 23.7602s
	iters: 500, epoch: 3 | loss: 0.8008716
	speed: 0.0044s/iter; left time: 25.2000s
	iters: 600, epoch: 3 | loss: 0.2919075
	speed: 0.0043s/iter; left time: 24.6328s
	iters: 700, epoch: 3 | loss: 1.0275385
	speed: 0.0044s/iter; left time: 24.2575s
	iters: 800, epoch: 3 | loss: 1.4786201
	speed: 0.0044s/iter; left time: 23.9775s
	iters: 900, epoch: 3 | loss: 0.3356996
	speed: 0.0042s/iter; left time: 22.3760s
	iters: 1000, epoch: 3 | loss: 0.5057864
	speed: 0.0037s/iter; left time: 19.6612s
Updating learning rate to 0.0011952463933268102
Epoch: 3 cost time: 4.4216461181640625
Epoch: 3, Steps: 1045 | Train Loss: 0.6637465 Vali Loss: 0.3205900 Best vali loss: 0.3144317
	iters: 100, epoch: 4 | loss: 1.1735356
	speed: 0.0143s/iter; left time: 73.4106s
	iters: 200, epoch: 4 | loss: 1.3651938
	speed: 0.0043s/iter; left time: 21.8145s
	iters: 300, epoch: 4 | loss: 0.4093573
	speed: 0.0042s/iter; left time: 20.5373s
	iters: 400, epoch: 4 | loss: 0.9867846
	speed: 0.0036s/iter; left time: 17.3302s
	iters: 500, epoch: 4 | loss: 0.5276799
	speed: 0.0039s/iter; left time: 18.5970s
	iters: 600, epoch: 4 | loss: 0.8717085
	speed: 0.0042s/iter; left time: 19.3936s
	iters: 700, epoch: 4 | loss: 1.4662538
	speed: 0.0042s/iter; left time: 19.1595s
	iters: 800, epoch: 4 | loss: 0.6244312
	speed: 0.0043s/iter; left time: 19.0606s
	iters: 900, epoch: 4 | loss: 0.6012515
	speed: 0.0043s/iter; left time: 18.5917s
	iters: 1000, epoch: 4 | loss: 0.3103333
	speed: 0.0041s/iter; left time: 17.1243s
Updating learning rate to 0.00086443965795
Epoch: 4 cost time: 4.369008302688599
Epoch: 4, Steps: 1045 | Train Loss: 0.8336530 Vali Loss: 0.3211347 Best vali loss: 0.3144317
	iters: 100, epoch: 5 | loss: 0.7260140
	speed: 0.0143s/iter; left time: 58.3620s
	iters: 200, epoch: 5 | loss: 0.9461727
	speed: 0.0042s/iter; left time: 16.7940s
	iters: 300, epoch: 5 | loss: 0.5561588
	speed: 0.0042s/iter; left time: 16.4223s
	iters: 400, epoch: 5 | loss: 1.3987983
	speed: 0.0039s/iter; left time: 14.6547s
	iters: 500, epoch: 5 | loss: 0.8432974
	speed: 0.0037s/iter; left time: 13.6440s
	iters: 600, epoch: 5 | loss: 0.1633961
	speed: 0.0044s/iter; left time: 15.6805s
	iters: 700, epoch: 5 | loss: 2.2659743
	speed: 0.0044s/iter; left time: 15.2268s
	iters: 800, epoch: 5 | loss: 0.3751372
	speed: 0.0043s/iter; left time: 14.6681s
	iters: 900, epoch: 5 | loss: 0.7035380
	speed: 0.0043s/iter; left time: 14.0440s
	iters: 1000, epoch: 5 | loss: 0.9338666
	speed: 0.0043s/iter; left time: 13.6476s
Updating learning rate to 0.0005336329225731899
Epoch: 5 cost time: 4.413667917251587
Epoch: 5, Steps: 1045 | Train Loss: 0.8912353 Vali Loss: 0.3220064 Best vali loss: 0.3144317
	iters: 100, epoch: 6 | loss: 0.7289037
	speed: 0.0142s/iter; left time: 43.2238s
	iters: 200, epoch: 6 | loss: 0.3257999
	speed: 0.0045s/iter; left time: 13.2900s
	iters: 300, epoch: 6 | loss: 0.3265474
	speed: 0.0046s/iter; left time: 13.1107s
	iters: 400, epoch: 6 | loss: 0.1344013
	speed: 0.0045s/iter; left time: 12.4178s
	iters: 500, epoch: 6 | loss: 0.2216251
	speed: 0.0040s/iter; left time: 10.5847s
	iters: 600, epoch: 6 | loss: 1.0528128
	speed: 0.0033s/iter; left time: 8.3643s
	iters: 700, epoch: 6 | loss: 1.9659919
	speed: 0.0033s/iter; left time: 8.1077s
	iters: 800, epoch: 6 | loss: 2.7691472
	speed: 0.0041s/iter; left time: 9.4849s
	iters: 900, epoch: 6 | loss: 0.4861034
	speed: 0.0047s/iter; left time: 10.4128s
	iters: 1000, epoch: 6 | loss: 0.4051372
	speed: 0.0047s/iter; left time: 10.0310s
Updating learning rate to 0.0002531885138869754
Epoch: 6 cost time: 4.487805128097534
Epoch: 6, Steps: 1045 | Train Loss: 0.8416470 Vali Loss: 0.3223388 Best vali loss: 0.3144317
	iters: 100, epoch: 7 | loss: 1.0129396
	speed: 0.0152s/iter; left time: 30.3497s
	iters: 200, epoch: 7 | loss: 0.5384834
	speed: 0.0042s/iter; left time: 7.9606s
	iters: 300, epoch: 7 | loss: 0.2980398
	speed: 0.0046s/iter; left time: 8.1756s
	iters: 400, epoch: 7 | loss: 0.3840595
	speed: 0.0046s/iter; left time: 7.7370s
	iters: 500, epoch: 7 | loss: 0.2926173
	speed: 0.0045s/iter; left time: 7.2307s
	iters: 600, epoch: 7 | loss: 0.5249544
	speed: 0.0046s/iter; left time: 6.7957s
	iters: 700, epoch: 7 | loss: 0.3524875
	speed: 0.0042s/iter; left time: 5.8960s
	iters: 800, epoch: 7 | loss: 0.5953928
	speed: 0.0040s/iter; left time: 5.1491s
	iters: 900, epoch: 7 | loss: 0.9216761
	speed: 0.0045s/iter; left time: 5.3589s
	iters: 1000, epoch: 7 | loss: 1.2729163
	speed: 0.0045s/iter; left time: 4.9343s
Updating learning rate to 6.580155087893739e-05
Epoch: 7 cost time: 4.599913120269775
Epoch: 7, Steps: 1045 | Train Loss: 0.6193567 Vali Loss: 0.3221190 Best vali loss: 0.3144317
	iters: 100, epoch: 8 | loss: 0.3084939
	speed: 0.0156s/iter; left time: 14.7333s
	iters: 200, epoch: 8 | loss: 0.3312324
	speed: 0.0035s/iter; left time: 2.9326s
	iters: 300, epoch: 8 | loss: 0.4138076
	speed: 0.0030s/iter; left time: 2.2406s
	iters: 400, epoch: 8 | loss: 0.3102881
	speed: 0.0034s/iter; left time: 2.1835s
	iters: 500, epoch: 8 | loss: 0.2192352
	speed: 0.0047s/iter; left time: 2.5465s
	iters: 600, epoch: 8 | loss: 0.6335115
	speed: 0.0039s/iter; left time: 1.7217s
	iters: 700, epoch: 8 | loss: 0.8452377
	speed: 0.0047s/iter; left time: 1.6186s
	iters: 800, epoch: 8 | loss: 0.3847907
	speed: 0.0039s/iter; left time: 0.9664s
	iters: 900, epoch: 8 | loss: 1.5349245
	speed: 0.0045s/iter; left time: 0.6628s
	iters: 1000, epoch: 8 | loss: 1.3541712
	speed: 0.0033s/iter; left time: 0.1510s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.0648908615112305
Epoch: 8, Steps: 1045 | Train Loss: 0.6335693 Vali Loss: 0.3221360 Best vali loss: 0.3144317

best validation loss 0.31443169662038295

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 2, 'learning_rate': 0.0007022928253, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3361648
	speed: 0.0104s/iter; left time: 42.4989s
	iters: 200, epoch: 1 | loss: 0.3992487
	speed: 0.0047s/iter; left time: 18.9165s
	iters: 300, epoch: 1 | loss: 0.5175884
	speed: 0.0047s/iter; left time: 18.2669s
	iters: 400, epoch: 1 | loss: 0.6010079
	speed: 0.0045s/iter; left time: 17.0188s
	iters: 500, epoch: 1 | loss: 0.6057256
	speed: 0.0047s/iter; left time: 17.3407s
Updating learning rate to 0.0007022928253
Validation loss decreased (inf --> 0.2904).  Saving model state dict ...
Epoch: 1 cost time: 2.759805917739868
Epoch: 1, Steps: 523 | Train Loss: 0.4919471 Vali Loss: 0.2904005 Best vali loss: 0.2904005
	iters: 100, epoch: 2 | loss: 0.8141741
	speed: 0.0113s/iter; left time: 40.2385s
	iters: 200, epoch: 2 | loss: 0.2774454
	speed: 0.0047s/iter; left time: 16.1640s
	iters: 300, epoch: 2 | loss: 0.5285561
	speed: 0.0043s/iter; left time: 14.2926s
	iters: 400, epoch: 2 | loss: 0.6234115
	speed: 0.0037s/iter; left time: 12.1760s
	iters: 500, epoch: 2 | loss: 0.2901878
	speed: 0.0046s/iter; left time: 14.5188s
Updating learning rate to 0.00035114641265
Epoch: 2 cost time: 2.339076519012451
Epoch: 2, Steps: 523 | Train Loss: 0.5067550 Vali Loss: 0.2906300 Best vali loss: 0.2904005
	iters: 100, epoch: 3 | loss: 0.4134365
	speed: 0.0116s/iter; left time: 35.3559s
	iters: 200, epoch: 3 | loss: 0.2655621
	speed: 0.0049s/iter; left time: 14.3348s
	iters: 300, epoch: 3 | loss: 0.7929537
	speed: 0.0045s/iter; left time: 12.7103s
	iters: 400, epoch: 3 | loss: 0.2560841
	speed: 0.0039s/iter; left time: 10.6286s
	iters: 500, epoch: 3 | loss: 0.2448034
	speed: 0.0030s/iter; left time: 7.9751s
Updating learning rate to 0.000175573206325
Validation loss decreased (0.2904 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 2.2292613983154297
Epoch: 3, Steps: 523 | Train Loss: 0.3945680 Vali Loss: 0.2835955 Best vali loss: 0.2835955
	iters: 100, epoch: 4 | loss: 0.2949661
	speed: 0.0078s/iter; left time: 19.5077s
	iters: 200, epoch: 4 | loss: 0.5790921
	speed: 0.0044s/iter; left time: 10.7042s
	iters: 300, epoch: 4 | loss: 0.4362944
	speed: 0.0044s/iter; left time: 10.2204s
	iters: 400, epoch: 4 | loss: 0.2965691
	speed: 0.0044s/iter; left time: 9.7931s
	iters: 500, epoch: 4 | loss: 0.3938245
	speed: 0.0045s/iter; left time: 9.5876s
Updating learning rate to 8.77866031625e-05
Epoch: 4 cost time: 2.302726984024048
Epoch: 4, Steps: 523 | Train Loss: 0.4001492 Vali Loss: 0.2966025 Best vali loss: 0.2835955
	iters: 100, epoch: 5 | loss: 0.6885891
	speed: 0.0095s/iter; left time: 19.0104s
	iters: 200, epoch: 5 | loss: 0.4716483
	speed: 0.0044s/iter; left time: 8.2877s
	iters: 300, epoch: 5 | loss: 0.3320712
	speed: 0.0044s/iter; left time: 7.8653s
	iters: 400, epoch: 5 | loss: 0.4543034
	speed: 0.0044s/iter; left time: 7.4295s
	iters: 500, epoch: 5 | loss: 0.2381305
	speed: 0.0044s/iter; left time: 6.9406s
Updating learning rate to 4.389330158125e-05
Epoch: 5 cost time: 2.3110883235931396
Epoch: 5, Steps: 523 | Train Loss: 0.4369485 Vali Loss: 0.3013922 Best vali loss: 0.2835955
	iters: 100, epoch: 6 | loss: 0.4399846
	speed: 0.0096s/iter; left time: 14.1175s
	iters: 200, epoch: 6 | loss: 0.2172265
	speed: 0.0044s/iter; left time: 6.0202s
	iters: 300, epoch: 6 | loss: 0.2292589
	speed: 0.0044s/iter; left time: 5.6464s
	iters: 400, epoch: 6 | loss: 0.3208796
	speed: 0.0045s/iter; left time: 5.2695s
	iters: 500, epoch: 6 | loss: 0.6384171
	speed: 0.0045s/iter; left time: 4.8222s
Updating learning rate to 2.1946650790625e-05
Epoch: 6 cost time: 2.3493118286132812
Epoch: 6, Steps: 523 | Train Loss: 0.3691534 Vali Loss: 0.2983879 Best vali loss: 0.2835955
	iters: 100, epoch: 7 | loss: 0.3420021
	speed: 0.0094s/iter; left time: 8.8677s
	iters: 200, epoch: 7 | loss: 0.3413277
	speed: 0.0044s/iter; left time: 3.7451s
	iters: 300, epoch: 7 | loss: 0.2665595
	speed: 0.0044s/iter; left time: 3.3041s
	iters: 400, epoch: 7 | loss: 0.2309317
	speed: 0.0046s/iter; left time: 2.9537s
	iters: 500, epoch: 7 | loss: 0.3519603
	speed: 0.0046s/iter; left time: 2.4890s
Updating learning rate to 1.09733253953125e-05
Epoch: 7 cost time: 2.3340368270874023
Epoch: 7, Steps: 523 | Train Loss: 0.3065562 Vali Loss: 0.2994282 Best vali loss: 0.2835955
	iters: 100, epoch: 8 | loss: 0.2872019
	speed: 0.0095s/iter; left time: 4.0228s
	iters: 200, epoch: 8 | loss: 0.2373581
	speed: 0.0046s/iter; left time: 1.4752s
	iters: 300, epoch: 8 | loss: 0.5213879
	speed: 0.0045s/iter; left time: 1.0160s
	iters: 400, epoch: 8 | loss: 0.4875768
	speed: 0.0046s/iter; left time: 0.5654s
	iters: 500, epoch: 8 | loss: 0.3344261
	speed: 0.0046s/iter; left time: 0.1100s
Updating learning rate to 5.48666269765625e-06
Epoch: 8 cost time: 2.37267804145813
Epoch: 8, Steps: 523 | Train Loss: 0.3735902 Vali Loss: 0.2983462 Best vali loss: 0.2835955

best validation loss 0.283595473671456

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096207564637, 'e_layers': 2, 'learning_rate': 0.0003903011818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3608462
	speed: 0.0093s/iter; left time: 37.9050s
	iters: 200, epoch: 1 | loss: 0.3387230
	speed: 0.0039s/iter; left time: 15.5585s
	iters: 300, epoch: 1 | loss: 0.6354194
	speed: 0.0039s/iter; left time: 15.1745s
	iters: 400, epoch: 1 | loss: 0.3497261
	speed: 0.0039s/iter; left time: 14.6551s
	iters: 500, epoch: 1 | loss: 0.5323489
	speed: 0.0039s/iter; left time: 14.2409s
Updating learning rate to 0.0003903011818
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 2.3063735961914062
Epoch: 1, Steps: 523 | Train Loss: 0.4434127 Vali Loss: 0.2811711 Best vali loss: 0.2811711
	iters: 100, epoch: 2 | loss: 0.2930171
	speed: 0.0086s/iter; left time: 30.4818s
	iters: 200, epoch: 2 | loss: 0.5561981
	speed: 0.0038s/iter; left time: 13.2005s
	iters: 300, epoch: 2 | loss: 0.4270189
	speed: 0.0038s/iter; left time: 12.7978s
	iters: 400, epoch: 2 | loss: 0.3056159
	speed: 0.0039s/iter; left time: 12.8045s
	iters: 500, epoch: 2 | loss: 0.4051103
	speed: 0.0040s/iter; left time: 12.6101s
Updating learning rate to 0.0001951505909
Epoch: 2 cost time: 2.052027702331543
Epoch: 2, Steps: 523 | Train Loss: 0.3973920 Vali Loss: 0.2908450 Best vali loss: 0.2811711
	iters: 100, epoch: 3 | loss: 0.3838393
	speed: 0.0087s/iter; left time: 26.3477s
	iters: 200, epoch: 3 | loss: 0.1970884
	speed: 0.0040s/iter; left time: 11.6740s
	iters: 300, epoch: 3 | loss: 0.3569506
	speed: 0.0040s/iter; left time: 11.2941s
	iters: 400, epoch: 3 | loss: 0.5873567
	speed: 0.0041s/iter; left time: 11.3440s
	iters: 500, epoch: 3 | loss: 0.5767660
	speed: 0.0040s/iter; left time: 10.6222s
Updating learning rate to 9.757529545e-05
Epoch: 3 cost time: 2.1252896785736084
Epoch: 3, Steps: 523 | Train Loss: 0.4204002 Vali Loss: 0.2820690 Best vali loss: 0.2811711

best validation loss 0.28117111800726835

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 6.03723773e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4320134
	speed: 0.0106s/iter; left time: 10.0804s
Updating learning rate to 5.8074590508259505e-05
Validation loss decreased (inf --> 0.3451).  Saving model state dict ...
Epoch: 1 cost time: 0.9660124778747559
Epoch: 1, Steps: 131 | Train Loss: 0.4320134 Vali Loss: 0.3451400 Best vali loss: 0.3451400
	iters: 100, epoch: 2 | loss: 0.6943498
	speed: 0.0086s/iter; left time: 7.0666s
Updating learning rate to 5.153104734259139e-05
Validation loss decreased (0.3451 --> 0.3299).  Saving model state dict ...
Epoch: 2 cost time: 0.7000565528869629
Epoch: 2, Steps: 131 | Train Loss: 0.6943498 Vali Loss: 0.3298644 Best vali loss: 0.3298644
	iters: 100, epoch: 3 | loss: 0.9485378
	speed: 0.0090s/iter; left time: 6.1925s
Updating learning rate to 4.1737942932602113e-05
Validation loss decreased (0.3299 --> 0.3202).  Saving model state dict ...
Epoch: 3 cost time: 0.7649562358856201
Epoch: 3, Steps: 131 | Train Loss: 0.9485378 Vali Loss: 0.3202057 Best vali loss: 0.3202057

best validation loss 0.32020570574395496

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7276980
	speed: 0.0096s/iter; left time: 39.1843s
	iters: 200, epoch: 1 | loss: 0.7011939
	speed: 0.0040s/iter; left time: 16.1347s
	iters: 300, epoch: 1 | loss: 0.3864060
	speed: 0.0040s/iter; left time: 15.4351s
	iters: 400, epoch: 1 | loss: 0.2710159
	speed: 0.0038s/iter; left time: 14.4930s
	iters: 500, epoch: 1 | loss: 0.5340909
	speed: 0.0040s/iter; left time: 14.8807s
Updating learning rate to 0.00019193372885267988
Validation loss decreased (inf --> 0.2754).  Saving model state dict ...
Epoch: 1 cost time: 2.3880369663238525
Epoch: 1, Steps: 523 | Train Loss: 0.5240810 Vali Loss: 0.2753594 Best vali loss: 0.2753594
	iters: 100, epoch: 2 | loss: 0.3212515
	speed: 0.0100s/iter; left time: 35.5594s
	iters: 200, epoch: 2 | loss: 0.5093736
	speed: 0.0042s/iter; left time: 14.4302s
	iters: 300, epoch: 2 | loss: 0.8628918
	speed: 0.0040s/iter; left time: 13.3984s
	iters: 400, epoch: 2 | loss: 0.6030171
	speed: 0.0039s/iter; left time: 12.8787s
	iters: 500, epoch: 2 | loss: 0.6119345
	speed: 0.0043s/iter; left time: 13.5799s
Updating learning rate to 0.00017030763336576413
Epoch: 2 cost time: 2.2013320922851562
Epoch: 2, Steps: 523 | Train Loss: 0.5816937 Vali Loss: 0.2778565 Best vali loss: 0.2753594
	iters: 100, epoch: 3 | loss: 0.3089369
	speed: 0.0097s/iter; left time: 29.3541s
	iters: 200, epoch: 3 | loss: 0.2752380
	speed: 0.0041s/iter; left time: 12.1284s
	iters: 300, epoch: 3 | loss: 0.7028895
	speed: 0.0038s/iter; left time: 10.8155s
	iters: 400, epoch: 3 | loss: 0.8602192
	speed: 0.0035s/iter; left time: 9.6846s
	iters: 500, epoch: 3 | loss: 0.2608246
	speed: 0.0032s/iter; left time: 8.5648s
Updating learning rate to 0.00013794189423609193
Epoch: 3 cost time: 2.0026698112487793
Epoch: 3, Steps: 523 | Train Loss: 0.4816216 Vali Loss: 0.2806266 Best vali loss: 0.2753594

best validation loss 0.2753593903346636

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4286644
	speed: 0.0098s/iter; left time: 24.7563s
	iters: 200, epoch: 4 | loss: 0.3389888
	speed: 0.0045s/iter; left time: 10.8135s
	iters: 300, epoch: 4 | loss: 0.2878295
	speed: 0.0045s/iter; left time: 10.3487s
	iters: 400, epoch: 4 | loss: 0.2615167
	speed: 0.0040s/iter; left time: 8.9573s
	iters: 500, epoch: 4 | loss: 0.3202443
	speed: 0.0048s/iter; left time: 10.2341s
Updating learning rate to 9.976390185e-05
Epoch: 4 cost time: 2.5866522789001465
Epoch: 4, Steps: 523 | Train Loss: 0.3274487 Vali Loss: 0.2807024 Best vali loss: 0.2753594
	iters: 100, epoch: 5 | loss: 0.2559368
	speed: 0.0097s/iter; left time: 19.3651s
	iters: 200, epoch: 5 | loss: 0.4280900
	speed: 0.0044s/iter; left time: 8.2530s
	iters: 300, epoch: 5 | loss: 0.4897342
	speed: 0.0046s/iter; left time: 8.1764s
	iters: 400, epoch: 5 | loss: 0.4676594
	speed: 0.0041s/iter; left time: 6.9366s
	iters: 500, epoch: 5 | loss: 0.4950738
	speed: 0.0042s/iter; left time: 6.6516s
Updating learning rate to 6.158590946390807e-05
Epoch: 5 cost time: 2.255687952041626
Epoch: 5, Steps: 523 | Train Loss: 0.4272988 Vali Loss: 0.3058534 Best vali loss: 0.2753594
	iters: 100, epoch: 6 | loss: 0.1773152
	speed: 0.0101s/iter; left time: 14.8867s
	iters: 200, epoch: 6 | loss: 0.2278584
	speed: 0.0042s/iter; left time: 5.7703s
	iters: 300, epoch: 6 | loss: 0.3531408
	speed: 0.0044s/iter; left time: 5.5535s
	iters: 400, epoch: 6 | loss: 0.5378733
	speed: 0.0044s/iter; left time: 5.1522s
	iters: 500, epoch: 6 | loss: 0.1920164
	speed: 0.0041s/iter; left time: 4.3463s
Updating learning rate to 2.922017033423585e-05
Epoch: 6 cost time: 2.271357297897339
Epoch: 6, Steps: 523 | Train Loss: 0.2976408 Vali Loss: 0.3144204 Best vali loss: 0.2753594
	iters: 100, epoch: 7 | loss: 0.4489094
	speed: 0.0104s/iter; left time: 9.8236s
	iters: 200, epoch: 7 | loss: 0.2503020
	speed: 0.0041s/iter; left time: 3.4378s
	iters: 300, epoch: 7 | loss: 0.1239594
	speed: 0.0045s/iter; left time: 3.3432s
	iters: 400, epoch: 7 | loss: 0.1633350
	speed: 0.0045s/iter; left time: 2.8873s
	iters: 500, epoch: 7 | loss: 0.1639938
	speed: 0.0039s/iter; left time: 2.1266s
Updating learning rate to 7.594074847320105e-06
Epoch: 7 cost time: 2.2503702640533447
Epoch: 7, Steps: 523 | Train Loss: 0.2300999 Vali Loss: 0.3237055 Best vali loss: 0.2753594
	iters: 100, epoch: 8 | loss: 0.3627416
	speed: 0.0073s/iter; left time: 3.1070s
	iters: 200, epoch: 8 | loss: 0.3240383
	speed: 0.0042s/iter; left time: 1.3618s
	iters: 300, epoch: 8 | loss: 0.3041580
	speed: 0.0044s/iter; left time: 0.9942s
	iters: 400, epoch: 8 | loss: 0.1948284
	speed: 0.0044s/iter; left time: 0.5449s
	iters: 500, epoch: 8 | loss: 0.1591659
	speed: 0.0044s/iter; left time: 0.1049s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.221208095550537
Epoch: 8, Steps: 523 | Train Loss: 0.2689864 Vali Loss: 0.3260837 Best vali loss: 0.2753594

best validation loss 0.2753593903346636

[INFO][abstract_intensifier.py:595] Added config 47e958 and rejected config eb8e22 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0031170389496, 'e_layers': 1, 'learning_rate': 0.0003294206574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3620525
	speed: 0.0085s/iter; left time: 34.8053s
	iters: 200, epoch: 1 | loss: 0.3042331
	speed: 0.0028s/iter; left time: 11.1816s
	iters: 300, epoch: 1 | loss: 0.2821470
	speed: 0.0029s/iter; left time: 11.3796s
	iters: 400, epoch: 1 | loss: 0.2802006
	speed: 0.0030s/iter; left time: 11.1756s
	iters: 500, epoch: 1 | loss: 0.7582744
	speed: 0.0030s/iter; left time: 11.0049s
Updating learning rate to 0.0003168828301791364
Validation loss decreased (inf --> 0.2816).  Saving model state dict ...
Epoch: 1 cost time: 1.8259267807006836
Epoch: 1, Steps: 523 | Train Loss: 0.3973815 Vali Loss: 0.2816186 Best vali loss: 0.2816186
	iters: 100, epoch: 2 | loss: 0.8944145
	speed: 0.0080s/iter; left time: 28.4864s
	iters: 200, epoch: 2 | loss: 0.3261749
	speed: 0.0030s/iter; left time: 10.3729s
	iters: 300, epoch: 2 | loss: 0.5692832
	speed: 0.0030s/iter; left time: 10.0874s
	iters: 400, epoch: 2 | loss: 0.3542566
	speed: 0.0030s/iter; left time: 9.7725s
	iters: 500, epoch: 2 | loss: 0.5751472
	speed: 0.0030s/iter; left time: 9.4604s
Updating learning rate to 0.0002811781190552352
Epoch: 2 cost time: 1.6057884693145752
Epoch: 2, Steps: 523 | Train Loss: 0.5438553 Vali Loss: 0.2865567 Best vali loss: 0.2816186
	iters: 100, epoch: 3 | loss: 0.3695785
	speed: 0.0073s/iter; left time: 22.0356s
	iters: 200, epoch: 3 | loss: 0.3163034
	speed: 0.0029s/iter; left time: 8.6624s
	iters: 300, epoch: 3 | loss: 0.7764742
	speed: 0.0032s/iter; left time: 8.9454s
	iters: 400, epoch: 3 | loss: 0.7281970
	speed: 0.0031s/iter; left time: 8.4425s
	iters: 500, epoch: 3 | loss: 0.3978133
	speed: 0.0030s/iter; left time: 7.9289s
Updating learning rate to 0.0002277422426328982
Epoch: 3 cost time: 1.6039478778839111
Epoch: 3, Steps: 523 | Train Loss: 0.5176733 Vali Loss: 0.2867074 Best vali loss: 0.2816186
	iters: 100, epoch: 4 | loss: 0.6181226
	speed: 0.0079s/iter; left time: 19.9389s
	iters: 200, epoch: 4 | loss: 0.2253815
	speed: 0.0031s/iter; left time: 7.3981s
	iters: 300, epoch: 4 | loss: 0.3473104
	speed: 0.0031s/iter; left time: 7.0774s
	iters: 400, epoch: 4 | loss: 0.6403574
	speed: 0.0031s/iter; left time: 6.7730s
	iters: 500, epoch: 4 | loss: 0.4935276
	speed: 0.0031s/iter; left time: 6.4861s
Updating learning rate to 0.0001647103287
Epoch: 4 cost time: 1.6313667297363281
Epoch: 4, Steps: 523 | Train Loss: 0.4649399 Vali Loss: 0.2890383 Best vali loss: 0.2816186
	iters: 100, epoch: 5 | loss: 0.4762142
	speed: 0.0068s/iter; left time: 13.6373s
	iters: 200, epoch: 5 | loss: 0.6076223
	speed: 0.0022s/iter; left time: 4.1731s
	iters: 300, epoch: 5 | loss: 0.4153488
	speed: 0.0024s/iter; left time: 4.2713s
	iters: 400, epoch: 5 | loss: 0.2702974
	speed: 0.0029s/iter; left time: 4.8522s
	iters: 500, epoch: 5 | loss: 0.3374667
	speed: 0.0027s/iter; left time: 4.3579s
Updating learning rate to 0.00010167841476710186
Epoch: 5 cost time: 1.365429162979126
Epoch: 5, Steps: 523 | Train Loss: 0.4213899 Vali Loss: 0.2937560 Best vali loss: 0.2816186
	iters: 100, epoch: 6 | loss: 0.3969876
	speed: 0.0068s/iter; left time: 9.9846s
	iters: 200, epoch: 6 | loss: 0.3812883
	speed: 0.0022s/iter; left time: 3.0418s
	iters: 300, epoch: 6 | loss: 0.4160917
	speed: 0.0022s/iter; left time: 2.7769s
	iters: 400, epoch: 6 | loss: 0.6116717
	speed: 0.0023s/iter; left time: 2.7141s
	iters: 500, epoch: 6 | loss: 0.6980690
	speed: 0.0029s/iter; left time: 3.0930s
Updating learning rate to 4.824253834476479e-05
Epoch: 6 cost time: 1.313453197479248
Epoch: 6, Steps: 523 | Train Loss: 0.5008217 Vali Loss: 0.2982754 Best vali loss: 0.2816186
	iters: 100, epoch: 7 | loss: 0.3068931
	speed: 0.0075s/iter; left time: 7.1081s
	iters: 200, epoch: 7 | loss: 0.3255910
	speed: 0.0034s/iter; left time: 2.8610s
	iters: 300, epoch: 7 | loss: 0.4630764
	speed: 0.0035s/iter; left time: 2.6241s
	iters: 400, epoch: 7 | loss: 0.2759824
	speed: 0.0029s/iter; left time: 1.9063s
	iters: 500, epoch: 7 | loss: 0.5370365
	speed: 0.0028s/iter; left time: 1.5152s
Updating learning rate to 1.2537827220863625e-05
Epoch: 7 cost time: 1.6372954845428467
Epoch: 7, Steps: 523 | Train Loss: 0.3817159 Vali Loss: 0.3035959 Best vali loss: 0.2816186
	iters: 100, epoch: 8 | loss: 0.2834594
	speed: 0.0075s/iter; left time: 3.1943s
	iters: 200, epoch: 8 | loss: 0.2688357
	speed: 0.0023s/iter; left time: 0.7443s
	iters: 300, epoch: 8 | loss: 0.2034845
	speed: 0.0024s/iter; left time: 0.5311s
	iters: 400, epoch: 8 | loss: 0.1746622
	speed: 0.0024s/iter; left time: 0.3015s
	iters: 500, epoch: 8 | loss: 0.2962019
	speed: 0.0028s/iter; left time: 0.0683s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3827660083770752
Epoch: 8, Steps: 523 | Train Loss: 0.2453287 Vali Loss: 0.2994889 Best vali loss: 0.2816186

best validation loss 0.2816185642569958

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018706532697, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0229301
	speed: 0.0107s/iter; left time: 21.3136s
	iters: 200, epoch: 1 | loss: 0.8034928
	speed: 0.0057s/iter; left time: 10.7790s
Updating learning rate to 0.0002779769506
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 1.6698527336120605
Epoch: 1, Steps: 262 | Train Loss: 0.9132115 Vali Loss: 0.2837252 Best vali loss: 0.2837252
	iters: 100, epoch: 2 | loss: 0.8713405
	speed: 0.0123s/iter; left time: 21.2879s
	iters: 200, epoch: 2 | loss: 0.4293229
	speed: 0.0049s/iter; left time: 8.0699s
Updating learning rate to 0.0001389884753
Validation loss decreased (0.2837 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 1.4564409255981445
Epoch: 2, Steps: 262 | Train Loss: 0.6503317 Vali Loss: 0.2788071 Best vali loss: 0.2788071
	iters: 100, epoch: 3 | loss: 0.6427676
	speed: 0.0114s/iter; left time: 16.8171s
	iters: 200, epoch: 3 | loss: 0.5945001
	speed: 0.0032s/iter; left time: 4.4521s
Updating learning rate to 6.949423765e-05
Epoch: 3 cost time: 1.0285816192626953
Epoch: 3, Steps: 262 | Train Loss: 0.6186338 Vali Loss: 0.2834322 Best vali loss: 0.2788071
	iters: 100, epoch: 4 | loss: 0.3223954
	speed: 0.0089s/iter; left time: 10.8281s
	iters: 200, epoch: 4 | loss: 1.1418847
	speed: 0.0045s/iter; left time: 4.9926s
Updating learning rate to 3.4747118825e-05
Epoch: 4 cost time: 1.1902225017547607
Epoch: 4, Steps: 262 | Train Loss: 0.7321400 Vali Loss: 0.2856990 Best vali loss: 0.2788071
	iters: 100, epoch: 5 | loss: 0.3750980
	speed: 0.0100s/iter; left time: 9.4867s
	iters: 200, epoch: 5 | loss: 0.4375610
	speed: 0.0048s/iter; left time: 4.1087s
Updating learning rate to 1.73735594125e-05
Epoch: 5 cost time: 1.2811448574066162
Epoch: 5, Steps: 262 | Train Loss: 0.4063295 Vali Loss: 0.2848680 Best vali loss: 0.2788071
	iters: 100, epoch: 6 | loss: 0.3630307
	speed: 0.0099s/iter; left time: 6.8169s
	iters: 200, epoch: 6 | loss: 0.5365368
	speed: 0.0050s/iter; left time: 2.9128s
Updating learning rate to 8.68677970625e-06
Epoch: 6 cost time: 1.257295846939087
Epoch: 6, Steps: 262 | Train Loss: 0.4497837 Vali Loss: 0.2851573 Best vali loss: 0.2788071
	iters: 100, epoch: 7 | loss: 0.2830574
	speed: 0.0099s/iter; left time: 4.2123s
	iters: 200, epoch: 7 | loss: 0.6645982
	speed: 0.0047s/iter; left time: 1.5248s
Updating learning rate to 4.343389853125e-06
Epoch: 7 cost time: 1.2061092853546143
Epoch: 7, Steps: 262 | Train Loss: 0.4738278 Vali Loss: 0.2846976 Best vali loss: 0.2788071
	iters: 100, epoch: 8 | loss: 0.3968463
	speed: 0.0099s/iter; left time: 1.6097s
	iters: 200, epoch: 8 | loss: 0.6446770
	speed: 0.0045s/iter; left time: 0.2827s
Updating learning rate to 2.1716949265625e-06
Epoch: 8 cost time: 1.1982841491699219
Epoch: 8, Steps: 262 | Train Loss: 0.5207617 Vali Loss: 0.2848529 Best vali loss: 0.2788071

best validation loss 0.27880713492687326

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.003868950085, 'e_layers': 4, 'learning_rate': 0.0048421309082, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8103178
	speed: 0.0124s/iter; left time: 50.6305s
	iters: 200, epoch: 1 | loss: 0.3809848
	speed: 0.0063s/iter; left time: 25.2058s
	iters: 300, epoch: 1 | loss: 0.8550943
	speed: 0.0068s/iter; left time: 26.5989s
	iters: 400, epoch: 1 | loss: 0.3040120
	speed: 0.0064s/iter; left time: 24.3583s
	iters: 500, epoch: 1 | loss: 0.4063949
	speed: 0.0064s/iter; left time: 23.5179s
Updating learning rate to 0.0048421309082
Validation loss decreased (inf --> 0.3239).  Saving model state dict ...
Epoch: 1 cost time: 3.726797342300415
Epoch: 1, Steps: 523 | Train Loss: 0.5513608 Vali Loss: 0.3239346 Best vali loss: 0.3239346
	iters: 100, epoch: 2 | loss: 0.2647178
	speed: 0.0129s/iter; left time: 46.0556s
	iters: 200, epoch: 2 | loss: 0.7846378
	speed: 0.0048s/iter; left time: 16.4470s
	iters: 300, epoch: 2 | loss: 0.4007259
	speed: 0.0061s/iter; left time: 20.4370s
	iters: 400, epoch: 2 | loss: 0.9702228
	speed: 0.0060s/iter; left time: 19.4329s
	iters: 500, epoch: 2 | loss: 0.4945462
	speed: 0.0060s/iter; left time: 18.8905s
Updating learning rate to 0.0024210654541
Epoch: 2 cost time: 2.9708337783813477
Epoch: 2, Steps: 523 | Train Loss: 0.5829701 Vali Loss: 0.3242975 Best vali loss: 0.3239346
	iters: 100, epoch: 3 | loss: 0.3013247
	speed: 0.0118s/iter; left time: 35.9555s
	iters: 200, epoch: 3 | loss: 0.2461488
	speed: 0.0059s/iter; left time: 17.4702s
	iters: 300, epoch: 3 | loss: 0.3363025
	speed: 0.0057s/iter; left time: 16.3011s
	iters: 400, epoch: 3 | loss: 0.3440605
	speed: 0.0058s/iter; left time: 16.0225s
	iters: 500, epoch: 3 | loss: 0.3059778
	speed: 0.0060s/iter; left time: 15.7755s
Updating learning rate to 0.00121053272705
Validation loss decreased (0.3239 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 3.087946891784668
Epoch: 3, Steps: 523 | Train Loss: 0.3067629 Vali Loss: 0.3225722 Best vali loss: 0.3225722

best validation loss 0.3225722069266384

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 1, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.3244).  Saving model state dict ...
Epoch: 1 cost time: 0.550121545791626
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3243869 Best vali loss: 0.3243869
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.3244 --> 0.3044).  Saving model state dict ...
Epoch: 2 cost time: 0.28724169731140137
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3043548 Best vali loss: 0.3043548
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.3044 --> 0.2985).  Saving model state dict ...
Epoch: 3 cost time: 0.27684736251831055
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2984961 Best vali loss: 0.2984961

best validation loss 0.29849614809773234

[INFO][smbo.py:320] Finished 50 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6593277
	speed: 0.0131s/iter; left time: 12.4016s
Updating learning rate to 0.000280255645
Validation loss decreased (inf --> 0.3069).  Saving model state dict ...
Epoch: 1 cost time: 1.2887344360351562
Epoch: 1, Steps: 131 | Train Loss: 0.6593277 Vali Loss: 0.3068873 Best vali loss: 0.3068873
	iters: 100, epoch: 2 | loss: 0.4478238
	speed: 0.0123s/iter; left time: 10.0584s
Updating learning rate to 0.0001401278225
Validation loss decreased (0.3069 --> 0.2916).  Saving model state dict ...
Epoch: 2 cost time: 1.006850004196167
Epoch: 2, Steps: 131 | Train Loss: 0.4478238 Vali Loss: 0.2916223 Best vali loss: 0.2916223
	iters: 100, epoch: 3 | loss: 0.6688806
	speed: 0.0119s/iter; left time: 8.1907s
Updating learning rate to 7.006391125e-05
Validation loss decreased (0.2916 --> 0.2885).  Saving model state dict ...
Epoch: 3 cost time: 0.9831244945526123
Epoch: 3, Steps: 131 | Train Loss: 0.6688806 Vali Loss: 0.2884890 Best vali loss: 0.2884890

best validation loss 0.2884890007547128

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6140819
	speed: 0.0130s/iter; left time: 7.2445s
Updating learning rate to 3.5031955625e-05
Validation loss decreased (0.2885 --> 0.2863).  Saving model state dict ...
Epoch: 4 cost time: 1.226895809173584
Epoch: 4, Steps: 131 | Train Loss: 0.6140819 Vali Loss: 0.2862769 Best vali loss: 0.2862769
	iters: 100, epoch: 5 | loss: 0.4319545
	speed: 0.0118s/iter; left time: 5.0163s
Updating learning rate to 1.75159778125e-05
Validation loss decreased (0.2863 --> 0.2858).  Saving model state dict ...
Epoch: 5 cost time: 0.9954028129577637
Epoch: 5, Steps: 131 | Train Loss: 0.4319545 Vali Loss: 0.2857986 Best vali loss: 0.2857986
	iters: 100, epoch: 6 | loss: 0.6632000
	speed: 0.0112s/iter; left time: 3.2975s
Updating learning rate to 8.75798890625e-06
Validation loss decreased (0.2858 --> 0.2855).  Saving model state dict ...
Epoch: 6 cost time: 0.9088749885559082
Epoch: 6, Steps: 131 | Train Loss: 0.6632000 Vali Loss: 0.2855310 Best vali loss: 0.2855310
	iters: 100, epoch: 7 | loss: 0.4742650
	speed: 0.0117s/iter; left time: 1.9122s
Updating learning rate to 4.378994453125e-06
Validation loss decreased (0.2855 --> 0.2854).  Saving model state dict ...
Epoch: 7 cost time: 1.0099759101867676
Epoch: 7, Steps: 131 | Train Loss: 0.4742650 Vali Loss: 0.2854296 Best vali loss: 0.2854296
	iters: 100, epoch: 8 | loss: 0.4899097
	speed: 0.0120s/iter; left time: 0.3849s
Updating learning rate to 2.1894972265625e-06
Validation loss decreased (0.2854 --> 0.2854).  Saving model state dict ...
Epoch: 8 cost time: 1.0084640979766846
Epoch: 8, Steps: 131 | Train Loss: 0.4899097 Vali Loss: 0.2853875 Best vali loss: 0.2853875

best validation loss 0.28538747370110074

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001339657668, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4125853
	speed: 0.0104s/iter; left time: 20.7101s
	iters: 200, epoch: 1 | loss: 0.3562566
	speed: 0.0044s/iter; left time: 8.3069s
Updating learning rate to 0.0001339657668
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 1.510387659072876
Epoch: 1, Steps: 262 | Train Loss: 0.3844209 Vali Loss: 0.2778911 Best vali loss: 0.2778911
	iters: 100, epoch: 2 | loss: 0.6765474
	speed: 0.0122s/iter; left time: 21.1219s
	iters: 200, epoch: 2 | loss: 1.0276878
	speed: 0.0060s/iter; left time: 9.7745s
Updating learning rate to 6.69828834e-05
Epoch: 2 cost time: 1.623403549194336
Epoch: 2, Steps: 262 | Train Loss: 0.8521176 Vali Loss: 0.2786386 Best vali loss: 0.2778911
	iters: 100, epoch: 3 | loss: 0.3372014
	speed: 0.0123s/iter; left time: 18.1598s
	iters: 200, epoch: 3 | loss: 0.4609301
	speed: 0.0042s/iter; left time: 5.8277s
Updating learning rate to 3.34914417e-05
Epoch: 3 cost time: 1.235330581665039
Epoch: 3, Steps: 262 | Train Loss: 0.3990658 Vali Loss: 0.2820377 Best vali loss: 0.2778911
	iters: 100, epoch: 4 | loss: 0.5451021
	speed: 0.0108s/iter; left time: 13.0493s
	iters: 200, epoch: 4 | loss: 0.3841116
	speed: 0.0051s/iter; left time: 5.6134s
Updating learning rate to 1.674572085e-05
Epoch: 4 cost time: 1.3726346492767334
Epoch: 4, Steps: 262 | Train Loss: 0.4646069 Vali Loss: 0.2833338 Best vali loss: 0.2778911
	iters: 100, epoch: 5 | loss: 0.3046725
	speed: 0.0109s/iter; left time: 10.3360s
	iters: 200, epoch: 5 | loss: 0.3507918
	speed: 0.0049s/iter; left time: 4.1831s
Updating learning rate to 8.372860425e-06
Epoch: 5 cost time: 1.3532929420471191
Epoch: 5, Steps: 262 | Train Loss: 0.3277321 Vali Loss: 0.2845647 Best vali loss: 0.2778911
	iters: 100, epoch: 6 | loss: 0.3829932
	speed: 0.0114s/iter; left time: 7.8276s
	iters: 200, epoch: 6 | loss: 0.4525208
	speed: 0.0050s/iter; left time: 2.9221s
Updating learning rate to 4.1864302125e-06
Epoch: 6 cost time: 1.4180247783660889
Epoch: 6, Steps: 262 | Train Loss: 0.4177570 Vali Loss: 0.2859204 Best vali loss: 0.2778911
	iters: 100, epoch: 7 | loss: 0.3559512
	speed: 0.0110s/iter; left time: 4.6787s
	iters: 200, epoch: 7 | loss: 0.2630753
	speed: 0.0050s/iter; left time: 1.6256s
Updating learning rate to 2.09321510625e-06
Epoch: 7 cost time: 1.3364646434783936
Epoch: 7, Steps: 262 | Train Loss: 0.3095133 Vali Loss: 0.2858425 Best vali loss: 0.2778911
	iters: 100, epoch: 8 | loss: 0.4015946
	speed: 0.0105s/iter; left time: 1.7170s
	iters: 200, epoch: 8 | loss: 0.6211826
	speed: 0.0057s/iter; left time: 0.3614s
Updating learning rate to 1.046607553125e-06
Epoch: 8 cost time: 1.479806661605835
Epoch: 8, Steps: 262 | Train Loss: 0.5113886 Vali Loss: 0.2862811 Best vali loss: 0.2778911

best validation loss 0.27789110518290944

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7767021
	speed: 0.0097s/iter; left time: 19.3660s
	iters: 200, epoch: 1 | loss: 0.5225637
	speed: 0.0034s/iter; left time: 6.4930s
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.3121).  Saving model state dict ...
Epoch: 1 cost time: 1.2645013332366943
Epoch: 1, Steps: 262 | Train Loss: 0.6496329 Vali Loss: 0.3121413 Best vali loss: 0.3121413
	iters: 100, epoch: 2 | loss: 0.5196840
	speed: 0.0085s/iter; left time: 14.8201s
	iters: 200, epoch: 2 | loss: 0.3668866
	speed: 0.0026s/iter; left time: 4.2662s
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.3121 --> 0.2951).  Saving model state dict ...
Epoch: 2 cost time: 0.7573685646057129
Epoch: 2, Steps: 262 | Train Loss: 0.4432853 Vali Loss: 0.2951241 Best vali loss: 0.2951241
	iters: 100, epoch: 3 | loss: 0.6012088
	speed: 0.0071s/iter; left time: 10.5224s
	iters: 200, epoch: 3 | loss: 0.9024420
	speed: 0.0034s/iter; left time: 4.6902s
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.2951 --> 0.2900).  Saving model state dict ...
Epoch: 3 cost time: 0.93778395652771
Epoch: 3, Steps: 262 | Train Loss: 0.7518254 Vali Loss: 0.2900007 Best vali loss: 0.2900007
	iters: 100, epoch: 4 | loss: 0.4751892
	speed: 0.0082s/iter; left time: 9.8805s
	iters: 200, epoch: 4 | loss: 0.5125583
	speed: 0.0034s/iter; left time: 3.8295s
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.2900 --> 0.2880).  Saving model state dict ...
Epoch: 4 cost time: 0.918306827545166
Epoch: 4, Steps: 262 | Train Loss: 0.4938738 Vali Loss: 0.2880005 Best vali loss: 0.2880005
	iters: 100, epoch: 5 | loss: 0.4601679
	speed: 0.0074s/iter; left time: 7.0344s
	iters: 200, epoch: 5 | loss: 0.4985771
	speed: 0.0028s/iter; left time: 2.3430s
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.2880 --> 0.2872).  Saving model state dict ...
Epoch: 5 cost time: 0.7817208766937256
Epoch: 5, Steps: 262 | Train Loss: 0.4793725 Vali Loss: 0.2871748 Best vali loss: 0.2871748
	iters: 100, epoch: 6 | loss: 0.5880464
	speed: 0.0073s/iter; left time: 5.0046s
	iters: 200, epoch: 6 | loss: 0.5951053
	speed: 0.0033s/iter; left time: 1.9258s
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.2872 --> 0.2868).  Saving model state dict ...
Epoch: 6 cost time: 0.8716859817504883
Epoch: 6, Steps: 262 | Train Loss: 0.5915759 Vali Loss: 0.2868098 Best vali loss: 0.2868098
	iters: 100, epoch: 7 | loss: 0.5862941
	speed: 0.0070s/iter; left time: 2.9750s
	iters: 200, epoch: 7 | loss: 0.3297405
	speed: 0.0027s/iter; left time: 0.8831s
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.2868 --> 0.2866).  Saving model state dict ...
Epoch: 7 cost time: 0.7697477340698242
Epoch: 7, Steps: 262 | Train Loss: 0.4580173 Vali Loss: 0.2866223 Best vali loss: 0.2866223
	iters: 100, epoch: 8 | loss: 0.2720267
	speed: 0.0072s/iter; left time: 1.1783s
	iters: 200, epoch: 8 | loss: 0.6749855
	speed: 0.0029s/iter; left time: 0.1834s
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.2866 --> 0.2865).  Saving model state dict ...
Epoch: 8 cost time: 0.8158257007598877
Epoch: 8, Steps: 262 | Train Loss: 0.4735061 Vali Loss: 0.2865294 Best vali loss: 0.2865294

best validation loss 0.28652937020919456

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 4, 'learning_rate': 0.0044405212972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0932232
	speed: 0.0124s/iter; left time: 50.7369s
	iters: 200, epoch: 1 | loss: 0.7799341
	speed: 0.0070s/iter; left time: 27.9628s
	iters: 300, epoch: 1 | loss: 0.3466038
	speed: 0.0069s/iter; left time: 26.7219s
	iters: 400, epoch: 1 | loss: 0.3635007
	speed: 0.0063s/iter; left time: 23.7551s
	iters: 500, epoch: 1 | loss: 0.7079662
	speed: 0.0059s/iter; left time: 21.8836s
Updating learning rate to 0.0044405212972
Validation loss decreased (inf --> 0.3304).  Saving model state dict ...
Epoch: 1 cost time: 3.736983060836792
Epoch: 1, Steps: 523 | Train Loss: 0.6582456 Vali Loss: 0.3304429 Best vali loss: 0.3304429
	iters: 100, epoch: 2 | loss: 0.5703712
	speed: 0.0150s/iter; left time: 53.3571s
	iters: 200, epoch: 2 | loss: 0.2512618
	speed: 0.0071s/iter; left time: 24.5187s
	iters: 300, epoch: 2 | loss: 0.7939686
	speed: 0.0072s/iter; left time: 24.0454s
	iters: 400, epoch: 2 | loss: 0.8855597
	speed: 0.0072s/iter; left time: 23.6356s
	iters: 500, epoch: 2 | loss: 0.6143405
	speed: 0.0072s/iter; left time: 22.8163s
Updating learning rate to 0.0022202606486
Validation loss decreased (0.3304 --> 0.3233).  Saving model state dict ...
Epoch: 2 cost time: 3.810230016708374
Epoch: 2, Steps: 523 | Train Loss: 0.6231004 Vali Loss: 0.3232841 Best vali loss: 0.3232841
	iters: 100, epoch: 3 | loss: 0.6883470
	speed: 0.0152s/iter; left time: 46.2338s
	iters: 200, epoch: 3 | loss: 0.6461840
	speed: 0.0059s/iter; left time: 17.4662s
	iters: 300, epoch: 3 | loss: 0.4288624
	speed: 0.0063s/iter; left time: 17.9261s
	iters: 400, epoch: 3 | loss: 0.7509242
	speed: 0.0071s/iter; left time: 19.5104s
	iters: 500, epoch: 3 | loss: 0.7619556
	speed: 0.0072s/iter; left time: 18.9173s
Updating learning rate to 0.0011101303243
Validation loss decreased (0.3233 --> 0.3219).  Saving model state dict ...
Epoch: 3 cost time: 3.533142566680908
Epoch: 3, Steps: 523 | Train Loss: 0.6552546 Vali Loss: 0.3218780 Best vali loss: 0.3218780

best validation loss 0.32187803862661446

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6505783
	speed: 0.0095s/iter; left time: 9.0589s
Updating learning rate to 0.0011205641286
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 0.8050305843353271
Epoch: 1, Steps: 131 | Train Loss: 0.6505783 Vali Loss: 0.2848924 Best vali loss: 0.2848924
	iters: 100, epoch: 2 | loss: 0.6562496
	speed: 0.0067s/iter; left time: 5.4608s
Updating learning rate to 0.0005602820643
Epoch: 2 cost time: 0.48258328437805176
Epoch: 2, Steps: 131 | Train Loss: 0.6562496 Vali Loss: 0.2890718 Best vali loss: 0.2848924
	iters: 100, epoch: 3 | loss: 0.5539501
	speed: 0.0059s/iter; left time: 4.0616s
Updating learning rate to 0.00028014103215
Validation loss decreased (0.2849 --> 0.2849).  Saving model state dict ...
Epoch: 3 cost time: 0.4713315963745117
Epoch: 3, Steps: 131 | Train Loss: 0.5539501 Vali Loss: 0.2848908 Best vali loss: 0.2848908

best validation loss 0.2848908392280928

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5152154
	speed: 0.0093s/iter; left time: 38.1790s
	iters: 200, epoch: 1 | loss: 0.3359861
	speed: 0.0038s/iter; left time: 15.1895s
	iters: 300, epoch: 1 | loss: 0.7705992
	speed: 0.0038s/iter; left time: 14.7167s
	iters: 400, epoch: 1 | loss: 1.0381320
	speed: 0.0038s/iter; left time: 14.4216s
	iters: 500, epoch: 1 | loss: 0.4800021
	speed: 0.0037s/iter; left time: 13.7080s
Updating learning rate to 0.0012523603238
Validation loss decreased (inf --> 0.2910).  Saving model state dict ...
Epoch: 1 cost time: 2.2641499042510986
Epoch: 1, Steps: 523 | Train Loss: 0.6279870 Vali Loss: 0.2910148 Best vali loss: 0.2910148
	iters: 100, epoch: 2 | loss: 0.3853722
	speed: 0.0089s/iter; left time: 31.5290s
	iters: 200, epoch: 2 | loss: 0.4843412
	speed: 0.0026s/iter; left time: 8.8605s
	iters: 300, epoch: 2 | loss: 0.2564674
	speed: 0.0025s/iter; left time: 8.5129s
	iters: 400, epoch: 2 | loss: 0.4275474
	speed: 0.0030s/iter; left time: 9.6628s
	iters: 500, epoch: 2 | loss: 0.3864377
	speed: 0.0039s/iter; left time: 12.3601s
Updating learning rate to 0.0006261801619
Validation loss decreased (0.2910 --> 0.2872).  Saving model state dict ...
Epoch: 2 cost time: 1.6251845359802246
Epoch: 2, Steps: 523 | Train Loss: 0.3880332 Vali Loss: 0.2871634 Best vali loss: 0.2871634
	iters: 100, epoch: 3 | loss: 0.2151814
	speed: 0.0085s/iter; left time: 25.7430s
	iters: 200, epoch: 3 | loss: 0.7205762
	speed: 0.0035s/iter; left time: 10.3944s
	iters: 300, epoch: 3 | loss: 0.2316953
	speed: 0.0034s/iter; left time: 9.7215s
	iters: 400, epoch: 3 | loss: 0.4165618
	speed: 0.0034s/iter; left time: 9.2594s
	iters: 500, epoch: 3 | loss: 0.3045144
	speed: 0.0034s/iter; left time: 9.1023s
Updating learning rate to 0.00031309008095
Epoch: 3 cost time: 1.8359007835388184
Epoch: 3, Steps: 523 | Train Loss: 0.3777058 Vali Loss: 0.2911850 Best vali loss: 0.2871634

best validation loss 0.28716338270434927

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5879520
	speed: 0.0087s/iter; left time: 4.8382s
Updating learning rate to 0.000140070516075
Epoch: 4 cost time: 0.6918373107910156
Epoch: 4, Steps: 131 | Train Loss: 0.5879520 Vali Loss: 0.2868054 Best vali loss: 0.2848908
	iters: 100, epoch: 5 | loss: 0.5655777
	speed: 0.0061s/iter; left time: 2.6115s
Updating learning rate to 7.00352580375e-05
Epoch: 5 cost time: 0.4977397918701172
Epoch: 5, Steps: 131 | Train Loss: 0.5655777 Vali Loss: 0.2869661 Best vali loss: 0.2848908
	iters: 100, epoch: 6 | loss: 0.5496529
	speed: 0.0064s/iter; left time: 1.8773s
Updating learning rate to 3.501762901875e-05
Epoch: 6 cost time: 0.4938991069793701
Epoch: 6, Steps: 131 | Train Loss: 0.5496529 Vali Loss: 0.2866755 Best vali loss: 0.2848908
	iters: 100, epoch: 7 | loss: 0.4365533
	speed: 0.0067s/iter; left time: 1.0966s
Updating learning rate to 1.7508814509375e-05
Epoch: 7 cost time: 0.5385959148406982
Epoch: 7, Steps: 131 | Train Loss: 0.4365533 Vali Loss: 0.2873289 Best vali loss: 0.2848908
	iters: 100, epoch: 8 | loss: 0.4425633
	speed: 0.0067s/iter; left time: 0.2156s
Updating learning rate to 8.7544072546875e-06
Epoch: 8 cost time: 0.50711989402771
Epoch: 8, Steps: 131 | Train Loss: 0.4425633 Vali Loss: 0.2868880 Best vali loss: 0.2848908

best validation loss 0.2848908392280928

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0054864235978, 'e_layers': 2, 'learning_rate': 0.0004151106276, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.1164917
	speed: 0.0101s/iter; left time: 83.4977s
	iters: 200, epoch: 1 | loss: 0.4378722
	speed: 0.0044s/iter; left time: 35.7504s
	iters: 300, epoch: 1 | loss: 0.3806042
	speed: 0.0042s/iter; left time: 33.5479s
	iters: 400, epoch: 1 | loss: 1.5030754
	speed: 0.0043s/iter; left time: 34.4005s
	iters: 500, epoch: 1 | loss: 0.3214244
	speed: 0.0051s/iter; left time: 39.8815s
	iters: 600, epoch: 1 | loss: 0.3152193
	speed: 0.0051s/iter; left time: 39.4578s
	iters: 700, epoch: 1 | loss: 0.1606923
	speed: 0.0051s/iter; left time: 38.7662s
	iters: 800, epoch: 1 | loss: 0.4094861
	speed: 0.0049s/iter; left time: 37.3684s
	iters: 900, epoch: 1 | loss: 0.3197676
	speed: 0.0048s/iter; left time: 36.0182s
	iters: 1000, epoch: 1 | loss: 0.5782301
	speed: 0.0050s/iter; left time: 36.8057s
Updating learning rate to 0.0004151106276
Validation loss decreased (inf --> 0.3071).  Saving model state dict ...
Epoch: 1 cost time: 5.258896112442017
Epoch: 1, Steps: 1045 | Train Loss: 0.4542863 Vali Loss: 0.3070690 Best vali loss: 0.3070690
	iters: 100, epoch: 2 | loss: 0.5159362
	speed: 0.0177s/iter; left time: 127.3968s
	iters: 200, epoch: 2 | loss: 0.3689380
	speed: 0.0035s/iter; left time: 24.6826s
	iters: 300, epoch: 2 | loss: 0.1977277
	speed: 0.0035s/iter; left time: 24.7711s
	iters: 400, epoch: 2 | loss: 0.4019873
	speed: 0.0032s/iter; left time: 22.3598s
	iters: 500, epoch: 2 | loss: 0.2710948
	speed: 0.0029s/iter; left time: 19.6655s
	iters: 600, epoch: 2 | loss: 1.1107684
	speed: 0.0031s/iter; left time: 20.9044s
	iters: 700, epoch: 2 | loss: 0.7365414
	speed: 0.0033s/iter; left time: 22.0967s
	iters: 800, epoch: 2 | loss: 0.3580300
	speed: 0.0044s/iter; left time: 28.7067s
	iters: 900, epoch: 2 | loss: 0.4004391
	speed: 0.0045s/iter; left time: 28.5814s
	iters: 1000, epoch: 2 | loss: 0.2234835
	speed: 0.0044s/iter; left time: 28.0950s
Updating learning rate to 0.0002075553138
Validation loss decreased (0.3071 --> 0.2883).  Saving model state dict ...
Epoch: 2 cost time: 4.033993244171143
Epoch: 2, Steps: 1045 | Train Loss: 0.4584946 Vali Loss: 0.2883302 Best vali loss: 0.2883302
	iters: 100, epoch: 3 | loss: 0.4255584
	speed: 0.0146s/iter; left time: 90.2869s
	iters: 200, epoch: 3 | loss: 0.1975017
	speed: 0.0044s/iter; left time: 26.7182s
	iters: 300, epoch: 3 | loss: 0.2436077
	speed: 0.0044s/iter; left time: 26.2996s
	iters: 400, epoch: 3 | loss: 0.9135308
	speed: 0.0045s/iter; left time: 26.3068s
	iters: 500, epoch: 3 | loss: 1.0060821
	speed: 0.0043s/iter; left time: 24.9590s
	iters: 600, epoch: 3 | loss: 0.2290005
	speed: 0.0040s/iter; left time: 22.6488s
	iters: 700, epoch: 3 | loss: 0.3522190
	speed: 0.0040s/iter; left time: 22.1952s
	iters: 800, epoch: 3 | loss: 0.1888125
	speed: 0.0042s/iter; left time: 23.1466s
	iters: 900, epoch: 3 | loss: 0.3526000
	speed: 0.0045s/iter; left time: 24.1690s
	iters: 1000, epoch: 3 | loss: 0.3258595
	speed: 0.0045s/iter; left time: 23.7014s
Updating learning rate to 0.0001037776569
Epoch: 3 cost time: 4.5742881298065186
Epoch: 3, Steps: 1045 | Train Loss: 0.4234772 Vali Loss: 0.2927595 Best vali loss: 0.2883302
	iters: 100, epoch: 4 | loss: 0.9190323
	speed: 0.0151s/iter; left time: 77.5553s
	iters: 200, epoch: 4 | loss: 0.1453480
	speed: 0.0045s/iter; left time: 22.5417s
	iters: 300, epoch: 4 | loss: 0.4999866
	speed: 0.0045s/iter; left time: 22.1198s
	iters: 400, epoch: 4 | loss: 0.2728360
	speed: 0.0043s/iter; left time: 20.6935s
	iters: 500, epoch: 4 | loss: 0.5563688
	speed: 0.0042s/iter; left time: 19.9898s
	iters: 600, epoch: 4 | loss: 0.2877133
	speed: 0.0038s/iter; left time: 17.7054s
	iters: 700, epoch: 4 | loss: 0.4004032
	speed: 0.0039s/iter; left time: 17.7561s
	iters: 800, epoch: 4 | loss: 0.3969453
	speed: 0.0039s/iter; left time: 17.4563s
	iters: 900, epoch: 4 | loss: 0.2578673
	speed: 0.0043s/iter; left time: 18.5682s
	iters: 1000, epoch: 4 | loss: 0.3428364
	speed: 0.0045s/iter; left time: 18.8504s
Updating learning rate to 5.188882845e-05
Epoch: 4 cost time: 4.493541955947876
Epoch: 4, Steps: 1045 | Train Loss: 0.4079337 Vali Loss: 0.2997981 Best vali loss: 0.2883302
	iters: 100, epoch: 5 | loss: 0.2384496
	speed: 0.0143s/iter; left time: 58.4779s
	iters: 200, epoch: 5 | loss: 0.3403952
	speed: 0.0042s/iter; left time: 16.8821s
	iters: 300, epoch: 5 | loss: 0.3750699
	speed: 0.0043s/iter; left time: 16.5139s
	iters: 400, epoch: 5 | loss: 0.2698890
	speed: 0.0043s/iter; left time: 16.2720s
	iters: 500, epoch: 5 | loss: 0.2248288
	speed: 0.0043s/iter; left time: 15.7485s
	iters: 600, epoch: 5 | loss: 0.1541166
	speed: 0.0039s/iter; left time: 14.0224s
	iters: 700, epoch: 5 | loss: 0.4825428
	speed: 0.0036s/iter; left time: 12.6287s
	iters: 800, epoch: 5 | loss: 0.2128527
	speed: 0.0036s/iter; left time: 12.2292s
	iters: 900, epoch: 5 | loss: 0.2037361
	speed: 0.0040s/iter; left time: 13.2413s
	iters: 1000, epoch: 5 | loss: 0.2907946
	speed: 0.0041s/iter; left time: 13.1660s
Updating learning rate to 2.5944414225e-05
Epoch: 5 cost time: 4.2979066371917725
Epoch: 5, Steps: 1045 | Train Loss: 0.2792675 Vali Loss: 0.3095905 Best vali loss: 0.2883302
	iters: 100, epoch: 6 | loss: 0.3183430
	speed: 0.0146s/iter; left time: 44.3472s
	iters: 200, epoch: 6 | loss: 0.1335594
	speed: 0.0045s/iter; left time: 13.3154s
	iters: 300, epoch: 6 | loss: 0.2605435
	speed: 0.0043s/iter; left time: 12.3063s
	iters: 400, epoch: 6 | loss: 0.1805258
	speed: 0.0045s/iter; left time: 12.3685s
	iters: 500, epoch: 6 | loss: 0.1943340
	speed: 0.0045s/iter; left time: 11.8856s
	iters: 600, epoch: 6 | loss: 0.4598443
	speed: 0.0045s/iter; left time: 11.3092s
	iters: 700, epoch: 6 | loss: 0.2130012
	speed: 0.0039s/iter; left time: 9.5747s
	iters: 800, epoch: 6 | loss: 0.5382491
	speed: 0.0040s/iter; left time: 9.3700s
	iters: 900, epoch: 6 | loss: 0.1351024
	speed: 0.0044s/iter; left time: 9.7840s
	iters: 1000, epoch: 6 | loss: 0.3581587
	speed: 0.0043s/iter; left time: 9.2339s
Updating learning rate to 1.29722071125e-05
Epoch: 6 cost time: 4.5826661586761475
Epoch: 6, Steps: 1045 | Train Loss: 0.2791661 Vali Loss: 0.3068701 Best vali loss: 0.2883302
	iters: 100, epoch: 7 | loss: 0.5391535
	speed: 0.0148s/iter; left time: 29.4506s
	iters: 200, epoch: 7 | loss: 0.1817361
	speed: 0.0044s/iter; left time: 8.2765s
	iters: 300, epoch: 7 | loss: 0.3653724
	speed: 0.0044s/iter; left time: 7.8554s
	iters: 400, epoch: 7 | loss: 0.1781102
	speed: 0.0044s/iter; left time: 7.3903s
	iters: 500, epoch: 7 | loss: 0.2340091
	speed: 0.0044s/iter; left time: 6.9802s
	iters: 600, epoch: 7 | loss: 0.1980322
	speed: 0.0044s/iter; left time: 6.5303s
	iters: 700, epoch: 7 | loss: 0.1680070
	speed: 0.0037s/iter; left time: 5.0863s
	iters: 800, epoch: 7 | loss: 0.1662575
	speed: 0.0033s/iter; left time: 4.2229s
	iters: 900, epoch: 7 | loss: 0.4953121
	speed: 0.0033s/iter; left time: 3.8852s
	iters: 1000, epoch: 7 | loss: 0.3443415
	speed: 0.0038s/iter; left time: 4.1166s
Updating learning rate to 6.48610355625e-06
Epoch: 7 cost time: 4.26818585395813
Epoch: 7, Steps: 1045 | Train Loss: 0.2870332 Vali Loss: 0.3103699 Best vali loss: 0.2883302
	iters: 100, epoch: 8 | loss: 0.4640198
	speed: 0.0147s/iter; left time: 13.8906s
	iters: 200, epoch: 8 | loss: 0.5102969
	speed: 0.0042s/iter; left time: 3.5397s
	iters: 300, epoch: 8 | loss: 0.1841785
	speed: 0.0041s/iter; left time: 3.0288s
	iters: 400, epoch: 8 | loss: 0.1265084
	speed: 0.0041s/iter; left time: 2.6287s
	iters: 500, epoch: 8 | loss: 0.3737256
	speed: 0.0040s/iter; left time: 2.2050s
	iters: 600, epoch: 8 | loss: 0.2916307
	speed: 0.0041s/iter; left time: 1.8125s
	iters: 700, epoch: 8 | loss: 0.3558784
	speed: 0.0041s/iter; left time: 1.4176s
	iters: 800, epoch: 8 | loss: 0.3820367
	speed: 0.0038s/iter; left time: 0.9227s
	iters: 900, epoch: 8 | loss: 0.1487345
	speed: 0.0032s/iter; left time: 0.4670s
	iters: 1000, epoch: 8 | loss: 0.8545209
	speed: 0.0033s/iter; left time: 0.1496s
Updating learning rate to 3.243051778125e-06
Epoch: 8 cost time: 4.075196981430054
Epoch: 8, Steps: 1045 | Train Loss: 0.3691530 Vali Loss: 0.3114160 Best vali loss: 0.2883302

best validation loss 0.28833016625187485

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0110950398132, 'e_layers': 2, 'learning_rate': 6.89350093e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4000573
	speed: 0.0094s/iter; left time: 77.8253s
	iters: 200, epoch: 1 | loss: 0.4597061
	speed: 0.0039s/iter; left time: 32.0130s
	iters: 300, epoch: 1 | loss: 0.9791290
	speed: 0.0039s/iter; left time: 31.6068s
	iters: 400, epoch: 1 | loss: 0.7365360
	speed: 0.0039s/iter; left time: 31.3253s
	iters: 500, epoch: 1 | loss: 0.4512241
	speed: 0.0040s/iter; left time: 31.4023s
	iters: 600, epoch: 1 | loss: 0.5997143
	speed: 0.0041s/iter; left time: 31.5029s
	iters: 700, epoch: 1 | loss: 0.2452656
	speed: 0.0039s/iter; left time: 29.7731s
	iters: 800, epoch: 1 | loss: 1.1996512
	speed: 0.0037s/iter; left time: 27.8927s
	iters: 900, epoch: 1 | loss: 0.3412297
	speed: 0.0035s/iter; left time: 26.1856s
	iters: 1000, epoch: 1 | loss: 0.9584038
	speed: 0.0040s/iter; left time: 29.1747s
Updating learning rate to 6.89350093e-05
Validation loss decreased (inf --> 0.3087).  Saving model state dict ...
Epoch: 1 cost time: 4.362208843231201
Epoch: 1, Steps: 1045 | Train Loss: 0.6370917 Vali Loss: 0.3086601 Best vali loss: 0.3086601
	iters: 100, epoch: 2 | loss: 0.4292940
	speed: 0.0137s/iter; left time: 98.8087s
	iters: 200, epoch: 2 | loss: 0.1908421
	speed: 0.0041s/iter; left time: 29.1130s
	iters: 300, epoch: 2 | loss: 0.3238473
	speed: 0.0041s/iter; left time: 28.7506s
	iters: 400, epoch: 2 | loss: 0.2760883
	speed: 0.0041s/iter; left time: 28.1745s
	iters: 500, epoch: 2 | loss: 0.2650540
	speed: 0.0041s/iter; left time: 27.7376s
	iters: 600, epoch: 2 | loss: 1.2604079
	speed: 0.0041s/iter; left time: 27.5178s
	iters: 700, epoch: 2 | loss: 0.2011404
	speed: 0.0041s/iter; left time: 27.2602s
	iters: 800, epoch: 2 | loss: 0.3311498
	speed: 0.0036s/iter; left time: 23.5211s
	iters: 900, epoch: 2 | loss: 0.5369173
	speed: 0.0037s/iter; left time: 23.6985s
	iters: 1000, epoch: 2 | loss: 0.7097751
	speed: 0.0030s/iter; left time: 19.0898s
Updating learning rate to 3.446750465e-05
Validation loss decreased (0.3087 --> 0.2937).  Saving model state dict ...
Epoch: 2 cost time: 4.061633586883545
Epoch: 2, Steps: 1045 | Train Loss: 0.4524516 Vali Loss: 0.2936804 Best vali loss: 0.2936804
	iters: 100, epoch: 3 | loss: 0.2506080
	speed: 0.0120s/iter; left time: 73.9408s
	iters: 200, epoch: 3 | loss: 0.5217054
	speed: 0.0037s/iter; left time: 22.2907s
	iters: 300, epoch: 3 | loss: 0.2779129
	speed: 0.0042s/iter; left time: 25.2104s
	iters: 400, epoch: 3 | loss: 1.5993274
	speed: 0.0045s/iter; left time: 26.1927s
	iters: 500, epoch: 3 | loss: 0.2650789
	speed: 0.0038s/iter; left time: 21.9278s
	iters: 600, epoch: 3 | loss: 0.7201763
	speed: 0.0044s/iter; left time: 24.6951s
	iters: 700, epoch: 3 | loss: 0.7311936
	speed: 0.0039s/iter; left time: 21.9172s
	iters: 800, epoch: 3 | loss: 1.9745934
	speed: 0.0030s/iter; left time: 16.1713s
	iters: 900, epoch: 3 | loss: 1.3054966
	speed: 0.0030s/iter; left time: 16.2896s
	iters: 1000, epoch: 3 | loss: 1.4525946
	speed: 0.0032s/iter; left time: 16.9660s
Updating learning rate to 1.7233752325e-05
Validation loss decreased (0.2937 --> 0.2889).  Saving model state dict ...
Epoch: 3 cost time: 4.05951189994812
Epoch: 3, Steps: 1045 | Train Loss: 0.9098687 Vali Loss: 0.2889015 Best vali loss: 0.2889015
	iters: 100, epoch: 4 | loss: 0.2288366
	speed: 0.0144s/iter; left time: 73.7267s
	iters: 200, epoch: 4 | loss: 1.5993965
	speed: 0.0040s/iter; left time: 20.3300s
	iters: 300, epoch: 4 | loss: 0.3845463
	speed: 0.0040s/iter; left time: 19.7296s
	iters: 400, epoch: 4 | loss: 0.3051461
	speed: 0.0040s/iter; left time: 19.1020s
	iters: 500, epoch: 4 | loss: 0.1653042
	speed: 0.0037s/iter; left time: 17.4344s
	iters: 600, epoch: 4 | loss: 0.6959655
	speed: 0.0038s/iter; left time: 17.4248s
	iters: 700, epoch: 4 | loss: 0.4052864
	speed: 0.0040s/iter; left time: 18.2424s
	iters: 800, epoch: 4 | loss: 0.6077611
	speed: 0.0040s/iter; left time: 17.6335s
	iters: 900, epoch: 4 | loss: 1.0622376
	speed: 0.0039s/iter; left time: 16.7102s
	iters: 1000, epoch: 4 | loss: 0.2868679
	speed: 0.0039s/iter; left time: 16.5832s
Updating learning rate to 8.6168761625e-06
Validation loss decreased (0.2889 --> 0.2872).  Saving model state dict ...
Epoch: 4 cost time: 4.144404888153076
Epoch: 4, Steps: 1045 | Train Loss: 0.5741348 Vali Loss: 0.2871927 Best vali loss: 0.2871927
	iters: 100, epoch: 5 | loss: 0.3475535
	speed: 0.0136s/iter; left time: 55.6872s
	iters: 200, epoch: 5 | loss: 1.2884070
	speed: 0.0038s/iter; left time: 15.1781s
	iters: 300, epoch: 5 | loss: 0.3450675
	speed: 0.0041s/iter; left time: 15.8189s
	iters: 400, epoch: 5 | loss: 0.4017353
	speed: 0.0040s/iter; left time: 15.1293s
	iters: 500, epoch: 5 | loss: 0.3177705
	speed: 0.0041s/iter; left time: 15.1084s
	iters: 600, epoch: 5 | loss: 1.3389176
	speed: 0.0042s/iter; left time: 14.9051s
	iters: 700, epoch: 5 | loss: 0.3431409
	speed: 0.0042s/iter; left time: 14.5806s
	iters: 800, epoch: 5 | loss: 0.5026443
	speed: 0.0041s/iter; left time: 13.8461s
	iters: 900, epoch: 5 | loss: 0.8869382
	speed: 0.0037s/iter; left time: 12.1063s
	iters: 1000, epoch: 5 | loss: 0.2765039
	speed: 0.0030s/iter; left time: 9.6885s
Updating learning rate to 4.30843808125e-06
Validation loss decreased (0.2872 --> 0.2866).  Saving model state dict ...
Epoch: 5 cost time: 4.032910108566284
Epoch: 5, Steps: 1045 | Train Loss: 0.6048679 Vali Loss: 0.2866091 Best vali loss: 0.2866091
	iters: 100, epoch: 6 | loss: 0.3711479
	speed: 0.0107s/iter; left time: 32.4651s
	iters: 200, epoch: 6 | loss: 1.1401740
	speed: 0.0038s/iter; left time: 11.0184s
	iters: 300, epoch: 6 | loss: 0.2995615
	speed: 0.0037s/iter; left time: 10.6278s
	iters: 400, epoch: 6 | loss: 0.2547211
	speed: 0.0037s/iter; left time: 10.1660s
	iters: 500, epoch: 6 | loss: 1.1126478
	speed: 0.0037s/iter; left time: 9.8141s
	iters: 600, epoch: 6 | loss: 0.5783859
	speed: 0.0039s/iter; left time: 9.8954s
	iters: 700, epoch: 6 | loss: 2.0783594
	speed: 0.0039s/iter; left time: 9.5670s
	iters: 800, epoch: 6 | loss: 0.5943475
	speed: 0.0035s/iter; left time: 8.2763s
	iters: 900, epoch: 6 | loss: 0.2616599
	speed: 0.0038s/iter; left time: 8.5394s
	iters: 1000, epoch: 6 | loss: 1.0424521
	speed: 0.0037s/iter; left time: 7.8219s
Updating learning rate to 2.154219040625e-06
Validation loss decreased (0.2866 --> 0.2863).  Saving model state dict ...
Epoch: 6 cost time: 3.96000075340271
Epoch: 6, Steps: 1045 | Train Loss: 0.7733457 Vali Loss: 0.2863165 Best vali loss: 0.2863165
	iters: 100, epoch: 7 | loss: 1.7542998
	speed: 0.0126s/iter; left time: 25.0739s
	iters: 200, epoch: 7 | loss: 0.8290806
	speed: 0.0036s/iter; left time: 6.8844s
	iters: 300, epoch: 7 | loss: 1.2176566
	speed: 0.0037s/iter; left time: 6.5812s
	iters: 400, epoch: 7 | loss: 0.3033091
	speed: 0.0034s/iter; left time: 5.8176s
	iters: 500, epoch: 7 | loss: 0.2633410
	speed: 0.0030s/iter; left time: 4.7363s
	iters: 600, epoch: 7 | loss: 0.3410523
	speed: 0.0028s/iter; left time: 4.1561s
	iters: 700, epoch: 7 | loss: 0.4151676
	speed: 0.0029s/iter; left time: 4.0974s
	iters: 800, epoch: 7 | loss: 0.3414343
	speed: 0.0034s/iter; left time: 4.3616s
	iters: 900, epoch: 7 | loss: 0.4109801
	speed: 0.0034s/iter; left time: 4.0522s
	iters: 1000, epoch: 7 | loss: 0.1688303
	speed: 0.0036s/iter; left time: 3.8914s
Updating learning rate to 1.0771095203125e-06
Validation loss decreased (0.2863 --> 0.2862).  Saving model state dict ...
Epoch: 7 cost time: 3.5556278228759766
Epoch: 7, Steps: 1045 | Train Loss: 0.6045152 Vali Loss: 0.2861622 Best vali loss: 0.2861622
	iters: 100, epoch: 8 | loss: 1.4059513
	speed: 0.0127s/iter; left time: 11.9811s
	iters: 200, epoch: 8 | loss: 1.0542643
	speed: 0.0038s/iter; left time: 3.2090s
	iters: 300, epoch: 8 | loss: 0.2864297
	speed: 0.0038s/iter; left time: 2.8559s
	iters: 400, epoch: 8 | loss: 0.3576843
	speed: 0.0038s/iter; left time: 2.4451s
	iters: 500, epoch: 8 | loss: 0.9850366
	speed: 0.0037s/iter; left time: 1.9970s
	iters: 600, epoch: 8 | loss: 0.4024495
	speed: 0.0036s/iter; left time: 1.5901s
	iters: 700, epoch: 8 | loss: 1.2224965
	speed: 0.0035s/iter; left time: 1.2283s
	iters: 800, epoch: 8 | loss: 0.3512469
	speed: 0.0037s/iter; left time: 0.9054s
	iters: 900, epoch: 8 | loss: 0.8472118
	speed: 0.0036s/iter; left time: 0.5228s
	iters: 1000, epoch: 8 | loss: 0.4206036
	speed: 0.0036s/iter; left time: 0.1654s
Updating learning rate to 5.3855476015625e-07
Validation loss decreased (0.2862 --> 0.2861).  Saving model state dict ...
Epoch: 8 cost time: 3.8580641746520996
Epoch: 8, Steps: 1045 | Train Loss: 0.7333375 Vali Loss: 0.2860930 Best vali loss: 0.2860930

best validation loss 0.2860929893711412

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.010989339883, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7009477
	speed: 0.0114s/iter; left time: 10.8300s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.3305).  Saving model state dict ...
Epoch: 1 cost time: 1.0670418739318848
Epoch: 1, Steps: 131 | Train Loss: 0.7009477 Vali Loss: 0.3305046 Best vali loss: 0.3305046
	iters: 100, epoch: 2 | loss: 0.5261424
	speed: 0.0101s/iter; left time: 8.2769s
Updating learning rate to 0.0019699025932
Validation loss decreased (0.3305 --> 0.3220).  Saving model state dict ...
Epoch: 2 cost time: 0.8598446846008301
Epoch: 2, Steps: 131 | Train Loss: 0.5261424 Vali Loss: 0.3219597 Best vali loss: 0.3219597
	iters: 100, epoch: 3 | loss: 0.4622701
	speed: 0.0106s/iter; left time: 7.3079s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 0.8875632286071777
Epoch: 3, Steps: 131 | Train Loss: 0.4622701 Vali Loss: 0.3254917 Best vali loss: 0.3219597

best validation loss 0.3219596691382512

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2862135
	speed: 0.0109s/iter; left time: 44.3308s
	iters: 200, epoch: 1 | loss: 0.4139252
	speed: 0.0053s/iter; left time: 21.0854s
	iters: 300, epoch: 1 | loss: 0.8694890
	speed: 0.0053s/iter; left time: 20.5647s
	iters: 400, epoch: 1 | loss: 0.2230014
	speed: 0.0053s/iter; left time: 20.1260s
	iters: 500, epoch: 1 | loss: 0.2949321
	speed: 0.0054s/iter; left time: 19.7654s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.2887).  Saving model state dict ...
Epoch: 1 cost time: 3.068621873855591
Epoch: 1, Steps: 523 | Train Loss: 0.4175122 Vali Loss: 0.2886727 Best vali loss: 0.2886727
	iters: 100, epoch: 2 | loss: 0.5136673
	speed: 0.0114s/iter; left time: 40.7044s
	iters: 200, epoch: 2 | loss: 0.2142774
	speed: 0.0054s/iter; left time: 18.6594s
	iters: 300, epoch: 2 | loss: 0.4590653
	speed: 0.0053s/iter; left time: 17.8798s
	iters: 400, epoch: 2 | loss: 0.7363945
	speed: 0.0049s/iter; left time: 16.0181s
	iters: 500, epoch: 2 | loss: 0.3147019
	speed: 0.0049s/iter; left time: 15.4680s
Updating learning rate to 0.000552421030539641
Epoch: 2 cost time: 2.7383954524993896
Epoch: 2, Steps: 523 | Train Loss: 0.4476213 Vali Loss: 0.2940342 Best vali loss: 0.2886727
	iters: 100, epoch: 3 | loss: 0.5572708
	speed: 0.0124s/iter; left time: 37.6529s
	iters: 200, epoch: 3 | loss: 0.6806183
	speed: 0.0055s/iter; left time: 16.1895s
	iters: 300, epoch: 3 | loss: 0.1883643
	speed: 0.0055s/iter; left time: 15.6693s
	iters: 400, epoch: 3 | loss: 0.4686127
	speed: 0.0055s/iter; left time: 15.1429s
	iters: 500, epoch: 3 | loss: 0.4772726
	speed: 0.0054s/iter; left time: 14.3216s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.2887 --> 0.2855).  Saving model state dict ...
Epoch: 3 cost time: 2.9835076332092285
Epoch: 3, Steps: 523 | Train Loss: 0.4744277 Vali Loss: 0.2855204 Best vali loss: 0.2855204

best validation loss 0.2855203826660647

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2272485
	speed: 0.0084s/iter; left time: 34.5037s
	iters: 200, epoch: 1 | loss: 0.3259811
	speed: 0.0030s/iter; left time: 11.9851s
	iters: 300, epoch: 1 | loss: 0.2671386
	speed: 0.0029s/iter; left time: 11.4307s
	iters: 400, epoch: 1 | loss: 0.6833614
	speed: 0.0026s/iter; left time: 9.7344s
	iters: 500, epoch: 1 | loss: 0.2622545
	speed: 0.0025s/iter; left time: 9.2016s
Updating learning rate to 0.0005012943918
Validation loss decreased (inf --> 0.2839).  Saving model state dict ...
Epoch: 1 cost time: 1.740598201751709
Epoch: 1, Steps: 523 | Train Loss: 0.3531968 Vali Loss: 0.2839283 Best vali loss: 0.2839283
	iters: 100, epoch: 2 | loss: 0.2452307
	speed: 0.0072s/iter; left time: 25.6685s
	iters: 200, epoch: 2 | loss: 0.7240279
	speed: 0.0029s/iter; left time: 9.9576s
	iters: 300, epoch: 2 | loss: 1.0427322
	speed: 0.0028s/iter; left time: 9.5608s
	iters: 400, epoch: 2 | loss: 0.6430579
	speed: 0.0028s/iter; left time: 9.2026s
	iters: 500, epoch: 2 | loss: 0.3745036
	speed: 0.0028s/iter; left time: 8.7570s
Updating learning rate to 0.0002506471959
Validation loss decreased (0.2839 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 1.528261423110962
Epoch: 2, Steps: 523 | Train Loss: 0.6059105 Vali Loss: 0.2833725 Best vali loss: 0.2833725
	iters: 100, epoch: 3 | loss: 0.2131034
	speed: 0.0075s/iter; left time: 22.8154s
	iters: 200, epoch: 3 | loss: 0.3108063
	speed: 0.0028s/iter; left time: 8.1955s
	iters: 300, epoch: 3 | loss: 0.9754882
	speed: 0.0028s/iter; left time: 7.9178s
	iters: 400, epoch: 3 | loss: 0.4352507
	speed: 0.0028s/iter; left time: 7.6722s
	iters: 500, epoch: 3 | loss: 0.3791479
	speed: 0.0028s/iter; left time: 7.3841s
Updating learning rate to 0.00012532359795
Epoch: 3 cost time: 1.5143640041351318
Epoch: 3, Steps: 523 | Train Loss: 0.4627593 Vali Loss: 0.2884319 Best vali loss: 0.2833725

best validation loss 0.28337253452278327

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2119308
	speed: 0.0083s/iter; left time: 20.8186s
	iters: 200, epoch: 4 | loss: 0.2959808
	speed: 0.0028s/iter; left time: 6.8271s
	iters: 300, epoch: 4 | loss: 0.2317680
	speed: 0.0028s/iter; left time: 6.5706s
	iters: 400, epoch: 4 | loss: 0.6295436
	speed: 0.0028s/iter; left time: 6.1336s
	iters: 500, epoch: 4 | loss: 0.2494654
	speed: 0.0030s/iter; left time: 6.3086s
Updating learning rate to 6.2661798975e-05
Epoch: 4 cost time: 1.7628498077392578
Epoch: 4, Steps: 523 | Train Loss: 0.3237377 Vali Loss: 0.2882612 Best vali loss: 0.2833725
	iters: 100, epoch: 5 | loss: 0.2493926
	speed: 0.0075s/iter; left time: 14.9723s
	iters: 200, epoch: 5 | loss: 0.6991447
	speed: 0.0030s/iter; left time: 5.5910s
	iters: 300, epoch: 5 | loss: 0.9706843
	speed: 0.0030s/iter; left time: 5.4578s
	iters: 400, epoch: 5 | loss: 0.6341590
	speed: 0.0029s/iter; left time: 4.9545s
	iters: 500, epoch: 5 | loss: 0.3634580
	speed: 0.0030s/iter; left time: 4.7238s
Updating learning rate to 3.13308994875e-05
Epoch: 5 cost time: 1.5891051292419434
Epoch: 5, Steps: 523 | Train Loss: 0.5833677 Vali Loss: 0.2886057 Best vali loss: 0.2833725
	iters: 100, epoch: 6 | loss: 0.2001271
	speed: 0.0073s/iter; left time: 10.7161s
	iters: 200, epoch: 6 | loss: 0.2986815
	speed: 0.0027s/iter; left time: 3.7660s
	iters: 300, epoch: 6 | loss: 0.9606007
	speed: 0.0027s/iter; left time: 3.4589s
	iters: 400, epoch: 6 | loss: 0.4207515
	speed: 0.0027s/iter; left time: 3.1777s
	iters: 500, epoch: 6 | loss: 0.3741723
	speed: 0.0027s/iter; left time: 2.8601s
Updating learning rate to 1.566544974375e-05
Epoch: 6 cost time: 1.459704875946045
Epoch: 6, Steps: 523 | Train Loss: 0.4508666 Vali Loss: 0.2896082 Best vali loss: 0.2833725
	iters: 100, epoch: 7 | loss: 0.2883540
	speed: 0.0077s/iter; left time: 7.3005s
	iters: 200, epoch: 7 | loss: 0.2878173
	speed: 0.0029s/iter; left time: 2.4152s
	iters: 300, epoch: 7 | loss: 0.1889171
	speed: 0.0028s/iter; left time: 2.0685s
	iters: 400, epoch: 7 | loss: 0.3979222
	speed: 0.0027s/iter; left time: 1.7669s
	iters: 500, epoch: 7 | loss: 1.0488001
	speed: 0.0026s/iter; left time: 1.4478s
Updating learning rate to 7.832724871875e-06
Epoch: 7 cost time: 1.5115594863891602
Epoch: 7, Steps: 523 | Train Loss: 0.4423621 Vali Loss: 0.2898807 Best vali loss: 0.2833725
	iters: 100, epoch: 8 | loss: 0.2533706
	speed: 0.0072s/iter; left time: 3.0547s
	iters: 200, epoch: 8 | loss: 0.4383691
	speed: 0.0029s/iter; left time: 0.9442s
	iters: 300, epoch: 8 | loss: 0.7028643
	speed: 0.0030s/iter; left time: 0.6818s
	iters: 400, epoch: 8 | loss: 1.4199350
	speed: 0.0030s/iter; left time: 0.3665s
	iters: 500, epoch: 8 | loss: 0.4184122
	speed: 0.0030s/iter; left time: 0.0715s
Updating learning rate to 3.9163624359375e-06
Epoch: 8 cost time: 1.5640366077423096
Epoch: 8, Steps: 523 | Train Loss: 0.6465903 Vali Loss: 0.2898105 Best vali loss: 0.2833725

best validation loss 0.28337253452278327

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 3, 'learning_rate': 5.08199726e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3264090
	speed: 0.0107s/iter; left time: 88.7627s
	iters: 200, epoch: 1 | loss: 0.4821689
	speed: 0.0053s/iter; left time: 43.1278s
	iters: 300, epoch: 1 | loss: 0.3277069
	speed: 0.0052s/iter; left time: 42.2835s
	iters: 400, epoch: 1 | loss: 1.2024817
	speed: 0.0051s/iter; left time: 40.5654s
	iters: 500, epoch: 1 | loss: 0.7334217
	speed: 0.0047s/iter; left time: 37.1013s
	iters: 600, epoch: 1 | loss: 0.3456077
	speed: 0.0047s/iter; left time: 36.3998s
	iters: 700, epoch: 1 | loss: 0.3982716
	speed: 0.0053s/iter; left time: 40.5267s
	iters: 800, epoch: 1 | loss: 0.4132994
	speed: 0.0053s/iter; left time: 39.9844s
	iters: 900, epoch: 1 | loss: 0.6786287
	speed: 0.0053s/iter; left time: 39.5701s
	iters: 1000, epoch: 1 | loss: 0.3404435
	speed: 0.0053s/iter; left time: 38.8580s
Updating learning rate to 4.88857525639622e-05
Validation loss decreased (inf --> 0.2966).  Saving model state dict ...
Epoch: 1 cost time: 5.671105623245239
Epoch: 1, Steps: 1045 | Train Loss: 0.5248439 Vali Loss: 0.2966453 Best vali loss: 0.2966453
	iters: 100, epoch: 2 | loss: 2.4092474
	speed: 0.0166s/iter; left time: 119.6822s
	iters: 200, epoch: 2 | loss: 0.2233125
	speed: 0.0053s/iter; left time: 37.4581s
	iters: 300, epoch: 2 | loss: 0.2789057
	speed: 0.0053s/iter; left time: 37.0176s
	iters: 400, epoch: 2 | loss: 0.5216156
	speed: 0.0052s/iter; left time: 36.1518s
	iters: 500, epoch: 2 | loss: 0.2773477
	speed: 0.0047s/iter; left time: 31.7658s
	iters: 600, epoch: 2 | loss: 0.2984755
	speed: 0.0045s/iter; left time: 30.4062s
	iters: 700, epoch: 2 | loss: 0.3772700
	speed: 0.0051s/iter; left time: 33.8293s
	iters: 800, epoch: 2 | loss: 0.2224875
	speed: 0.0052s/iter; left time: 33.7266s
	iters: 900, epoch: 2 | loss: 0.2900706
	speed: 0.0052s/iter; left time: 33.2236s
	iters: 1000, epoch: 2 | loss: 0.3541348
	speed: 0.0052s/iter; left time: 33.0016s
Updating learning rate to 4.337755992258727e-05
Validation loss decreased (0.2966 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 5.364815711975098
Epoch: 2, Steps: 1045 | Train Loss: 0.5252867 Vali Loss: 0.2849531 Best vali loss: 0.2849531
	iters: 100, epoch: 3 | loss: 0.4704479
	speed: 0.0165s/iter; left time: 101.5241s
	iters: 200, epoch: 3 | loss: 0.2047142
	speed: 0.0052s/iter; left time: 31.5872s
	iters: 300, epoch: 3 | loss: 0.1800560
	speed: 0.0051s/iter; left time: 30.5122s
	iters: 400, epoch: 3 | loss: 0.3452440
	speed: 0.0052s/iter; left time: 30.4862s
	iters: 500, epoch: 3 | loss: 0.2044320
	speed: 0.0049s/iter; left time: 28.5424s
	iters: 600, epoch: 3 | loss: 0.2018724
	speed: 0.0049s/iter; left time: 27.9672s
	iters: 700, epoch: 3 | loss: 0.4969306
	speed: 0.0053s/iter; left time: 29.5337s
	iters: 800, epoch: 3 | loss: 0.8701046
	speed: 0.0055s/iter; left time: 30.2648s
	iters: 900, epoch: 3 | loss: 0.3110629
	speed: 0.0054s/iter; left time: 28.8363s
	iters: 1000, epoch: 3 | loss: 0.2595390
	speed: 0.0055s/iter; left time: 29.1835s
Updating learning rate to 3.5133967073633905e-05
Validation loss decreased (0.2850 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 5.52954888343811
Epoch: 3, Steps: 1045 | Train Loss: 0.3544403 Vali Loss: 0.2839179 Best vali loss: 0.2839179
	iters: 100, epoch: 4 | loss: 0.5281831
	speed: 0.0170s/iter; left time: 87.3978s
	iters: 200, epoch: 4 | loss: 0.2173580
	speed: 0.0055s/iter; left time: 27.4693s
	iters: 300, epoch: 4 | loss: 1.4134909
	speed: 0.0054s/iter; left time: 26.5504s
	iters: 400, epoch: 4 | loss: 0.1847996
	speed: 0.0054s/iter; left time: 25.9980s
	iters: 500, epoch: 4 | loss: 0.5988513
	speed: 0.0048s/iter; left time: 22.8785s
	iters: 600, epoch: 4 | loss: 1.3580874
	speed: 0.0046s/iter; left time: 21.2620s
	iters: 700, epoch: 4 | loss: 1.3011769
	speed: 0.0042s/iter; left time: 18.9961s
	iters: 800, epoch: 4 | loss: 0.9816828
	speed: 0.0040s/iter; left time: 17.7105s
	iters: 900, epoch: 4 | loss: 1.1674392
	speed: 0.0052s/iter; left time: 22.4851s
	iters: 1000, epoch: 4 | loss: 0.2733216
	speed: 0.0056s/iter; left time: 23.6490s
Updating learning rate to 2.54099863e-05
Validation loss decreased (0.2839 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 5.3055644035339355
Epoch: 4, Steps: 1045 | Train Loss: 0.8024391 Vali Loss: 0.2818470 Best vali loss: 0.2818470
	iters: 100, epoch: 5 | loss: 0.1746541
	speed: 0.0169s/iter; left time: 68.9278s
	iters: 200, epoch: 5 | loss: 0.3455310
	speed: 0.0055s/iter; left time: 21.7486s
	iters: 300, epoch: 5 | loss: 0.2130498
	speed: 0.0054s/iter; left time: 20.8587s
	iters: 400, epoch: 5 | loss: 0.4450481
	speed: 0.0052s/iter; left time: 19.8449s
	iters: 500, epoch: 5 | loss: 0.3000317
	speed: 0.0052s/iter; left time: 19.2855s
	iters: 600, epoch: 5 | loss: 0.4740964
	speed: 0.0052s/iter; left time: 18.7121s
	iters: 700, epoch: 5 | loss: 0.4056087
	speed: 0.0049s/iter; left time: 17.1152s
	iters: 800, epoch: 5 | loss: 0.1900796
	speed: 0.0049s/iter; left time: 16.5512s
	iters: 900, epoch: 5 | loss: 0.2373046
	speed: 0.0049s/iter; left time: 16.1878s
	iters: 1000, epoch: 5 | loss: 0.3624729
	speed: 0.0053s/iter; left time: 16.9270s
Updating learning rate to 1.5686005526366093e-05
Validation loss decreased (0.2818 --> 0.2814).  Saving model state dict ...
Epoch: 5 cost time: 5.485662460327148
Epoch: 5, Steps: 1045 | Train Loss: 0.3147877 Vali Loss: 0.2813619 Best vali loss: 0.2813619
	iters: 100, epoch: 6 | loss: 1.0448439
	speed: 0.0165s/iter; left time: 50.0232s
	iters: 200, epoch: 6 | loss: 0.5570598
	speed: 0.0052s/iter; left time: 15.3903s
	iters: 300, epoch: 6 | loss: 0.2240144
	speed: 0.0053s/iter; left time: 14.9119s
	iters: 400, epoch: 6 | loss: 0.3198460
	speed: 0.0053s/iter; left time: 14.5881s
	iters: 500, epoch: 6 | loss: 0.5156037
	speed: 0.0053s/iter; left time: 13.8877s
	iters: 600, epoch: 6 | loss: 0.7726880
	speed: 0.0053s/iter; left time: 13.3547s
	iters: 700, epoch: 6 | loss: 0.4573857
	speed: 0.0053s/iter; left time: 12.8933s
	iters: 800, epoch: 6 | loss: 0.4317467
	speed: 0.0046s/iter; left time: 10.7849s
	iters: 900, epoch: 6 | loss: 0.2592631
	speed: 0.0047s/iter; left time: 10.4385s
	iters: 1000, epoch: 6 | loss: 0.9347196
	speed: 0.0055s/iter; left time: 11.7539s
Updating learning rate to 7.442412677412731e-06
Epoch: 6 cost time: 5.482526779174805
Epoch: 6, Steps: 1045 | Train Loss: 0.5517171 Vali Loss: 0.2818211 Best vali loss: 0.2813619
	iters: 100, epoch: 7 | loss: 0.2771987
	speed: 0.0168s/iter; left time: 33.4862s
	iters: 200, epoch: 7 | loss: 0.1775097
	speed: 0.0053s/iter; left time: 10.0953s
	iters: 300, epoch: 7 | loss: 0.2346979
	speed: 0.0054s/iter; left time: 9.6357s
	iters: 400, epoch: 7 | loss: 0.9900986
	speed: 0.0052s/iter; left time: 8.8724s
	iters: 500, epoch: 7 | loss: 0.5572361
	speed: 0.0053s/iter; left time: 8.3770s
	iters: 600, epoch: 7 | loss: 0.2152490
	speed: 0.0052s/iter; left time: 7.7954s
	iters: 700, epoch: 7 | loss: 1.1378613
	speed: 0.0053s/iter; left time: 7.3294s
	iters: 800, epoch: 7 | loss: 0.3206447
	speed: 0.0050s/iter; left time: 6.4210s
	iters: 900, epoch: 7 | loss: 0.4082500
	speed: 0.0049s/iter; left time: 5.7951s
	iters: 1000, epoch: 7 | loss: 0.5696723
	speed: 0.0050s/iter; left time: 5.4432s
Updating learning rate to 1.934220036037799e-06
Epoch: 7 cost time: 5.459094762802124
Epoch: 7, Steps: 1045 | Train Loss: 0.4888418 Vali Loss: 0.2817834 Best vali loss: 0.2813619
	iters: 100, epoch: 8 | loss: 0.5829825
	speed: 0.0167s/iter; left time: 15.7757s
	iters: 200, epoch: 8 | loss: 0.4175651
	speed: 0.0054s/iter; left time: 4.5269s
	iters: 300, epoch: 8 | loss: 0.4897982
	speed: 0.0054s/iter; left time: 4.0124s
	iters: 400, epoch: 8 | loss: 0.4635363
	speed: 0.0054s/iter; left time: 3.4668s
	iters: 500, epoch: 8 | loss: 0.6839797
	speed: 0.0054s/iter; left time: 2.9260s
	iters: 600, epoch: 8 | loss: 1.2545484
	speed: 0.0053s/iter; left time: 2.3807s
	iters: 700, epoch: 8 | loss: 0.3170609
	speed: 0.0054s/iter; left time: 1.8518s
	iters: 800, epoch: 8 | loss: 0.4530525
	speed: 0.0049s/iter; left time: 1.2132s
	iters: 900, epoch: 8 | loss: 0.2217415
	speed: 0.0047s/iter; left time: 0.6870s
	iters: 1000, epoch: 8 | loss: 0.3404475
	speed: 0.0049s/iter; left time: 0.2259s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.484780788421631
Epoch: 8, Steps: 1045 | Train Loss: 0.5224713 Vali Loss: 0.2818011 Best vali loss: 0.2813619

best validation loss 0.28136191368324687

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0089588480994, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2868927
	speed: 0.0107s/iter; left time: 88.2012s
	iters: 200, epoch: 1 | loss: 0.1756691
	speed: 0.0054s/iter; left time: 43.9891s
	iters: 300, epoch: 1 | loss: 0.5091121
	speed: 0.0054s/iter; left time: 43.2352s
	iters: 400, epoch: 1 | loss: 0.3947333
	speed: 0.0054s/iter; left time: 42.6539s
	iters: 500, epoch: 1 | loss: 0.9476850
	speed: 0.0054s/iter; left time: 42.4858s
	iters: 600, epoch: 1 | loss: 0.3288531
	speed: 0.0052s/iter; left time: 40.0894s
	iters: 700, epoch: 1 | loss: 0.3852428
	speed: 0.0048s/iter; left time: 37.1477s
	iters: 800, epoch: 1 | loss: 0.5372139
	speed: 0.0050s/iter; left time: 37.6504s
	iters: 900, epoch: 1 | loss: 0.3918102
	speed: 0.0056s/iter; left time: 41.8575s
	iters: 1000, epoch: 1 | loss: 0.2590880
	speed: 0.0056s/iter; left time: 41.2130s
Updating learning rate to 0.00044044934731141274
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 5.8350982666015625
Epoch: 1, Steps: 1045 | Train Loss: 0.4216300 Vali Loss: 0.2822262 Best vali loss: 0.2822262
	iters: 100, epoch: 2 | loss: 0.3194170
	speed: 0.0171s/iter; left time: 123.2001s
	iters: 200, epoch: 2 | loss: 0.3057160
	speed: 0.0054s/iter; left time: 38.2131s
	iters: 300, epoch: 2 | loss: 0.1516011
	speed: 0.0054s/iter; left time: 37.7787s
	iters: 400, epoch: 2 | loss: 1.1475095
	speed: 0.0054s/iter; left time: 37.3786s
	iters: 500, epoch: 2 | loss: 0.2000058
	speed: 0.0054s/iter; left time: 36.6023s
	iters: 600, epoch: 2 | loss: 0.3580670
	speed: 0.0054s/iter; left time: 35.9966s
	iters: 700, epoch: 2 | loss: 0.3387341
	speed: 0.0047s/iter; left time: 31.3859s
	iters: 800, epoch: 2 | loss: 0.1497033
	speed: 0.0048s/iter; left time: 30.9695s
	iters: 900, epoch: 2 | loss: 0.1469037
	speed: 0.0054s/iter; left time: 34.3331s
	iters: 1000, epoch: 2 | loss: 0.3262408
	speed: 0.0054s/iter; left time: 34.0811s
Updating learning rate to 0.0003908218029551133
Epoch: 2 cost time: 5.538780212402344
Epoch: 2, Steps: 1045 | Train Loss: 0.3443898 Vali Loss: 0.2921968 Best vali loss: 0.2822262
	iters: 100, epoch: 3 | loss: 0.3826607
	speed: 0.0170s/iter; left time: 105.1520s
	iters: 200, epoch: 3 | loss: 0.2121772
	speed: 0.0054s/iter; left time: 32.8349s
	iters: 300, epoch: 3 | loss: 0.3518530
	speed: 0.0054s/iter; left time: 32.2232s
	iters: 400, epoch: 3 | loss: 0.2814942
	speed: 0.0054s/iter; left time: 31.6410s
	iters: 500, epoch: 3 | loss: 0.2797997
	speed: 0.0054s/iter; left time: 31.0513s
	iters: 600, epoch: 3 | loss: 0.1467556
	speed: 0.0054s/iter; left time: 30.5914s
	iters: 700, epoch: 3 | loss: 1.1349945
	speed: 0.0049s/iter; left time: 27.4571s
	iters: 800, epoch: 3 | loss: 0.4059811
	speed: 0.0049s/iter; left time: 26.5704s
	iters: 900, epoch: 3 | loss: 0.3042463
	speed: 0.0052s/iter; left time: 27.8960s
	iters: 1000, epoch: 3 | loss: 0.2698444
	speed: 0.0054s/iter; left time: 28.3942s
Updating learning rate to 0.00031654893408453833
Validation loss decreased (0.2822 --> 0.2804).  Saving model state dict ...
Epoch: 3 cost time: 5.55729866027832
Epoch: 3, Steps: 1045 | Train Loss: 0.3769807 Vali Loss: 0.2804495 Best vali loss: 0.2804495
	iters: 100, epoch: 4 | loss: 0.5763513
	speed: 0.0170s/iter; left time: 87.2155s
	iters: 200, epoch: 4 | loss: 0.7996274
	speed: 0.0054s/iter; left time: 27.1000s
	iters: 300, epoch: 4 | loss: 0.7692264
	speed: 0.0054s/iter; left time: 26.4477s
	iters: 400, epoch: 4 | loss: 0.5296751
	speed: 0.0054s/iter; left time: 25.8330s
	iters: 500, epoch: 4 | loss: 0.4545894
	speed: 0.0054s/iter; left time: 25.4713s
	iters: 600, epoch: 4 | loss: 0.1364476
	speed: 0.0054s/iter; left time: 24.7629s
	iters: 700, epoch: 4 | loss: 0.3872367
	speed: 0.0049s/iter; left time: 22.4030s
	iters: 800, epoch: 4 | loss: 0.2056389
	speed: 0.0048s/iter; left time: 21.0694s
	iters: 900, epoch: 4 | loss: 0.3006338
	speed: 0.0041s/iter; left time: 17.7409s
	iters: 1000, epoch: 4 | loss: 0.6016735
	speed: 0.0039s/iter; left time: 16.4121s
Updating learning rate to 0.0002289381117
Epoch: 4 cost time: 5.223506927490234
Epoch: 4, Steps: 1045 | Train Loss: 0.4761100 Vali Loss: 0.2989885 Best vali loss: 0.2804495
	iters: 100, epoch: 5 | loss: 0.1684177
	speed: 0.0174s/iter; left time: 70.9064s
	iters: 200, epoch: 5 | loss: 0.8239952
	speed: 0.0044s/iter; left time: 17.4115s
	iters: 300, epoch: 5 | loss: 0.2840060
	speed: 0.0038s/iter; left time: 14.5950s
	iters: 400, epoch: 5 | loss: 0.3015593
	speed: 0.0056s/iter; left time: 21.2024s
	iters: 500, epoch: 5 | loss: 0.4470944
	speed: 0.0110s/iter; left time: 40.6252s
	iters: 600, epoch: 5 | loss: 0.5529189
	speed: 0.0081s/iter; left time: 28.9274s
	iters: 700, epoch: 5 | loss: 0.2319310
	speed: 0.0109s/iter; left time: 37.8826s
	iters: 800, epoch: 5 | loss: 0.2576953
	speed: 0.0092s/iter; left time: 31.0955s
	iters: 900, epoch: 5 | loss: 0.1935344
	speed: 0.0100s/iter; left time: 32.6890s
	iters: 1000, epoch: 5 | loss: 0.2331658
	speed: 0.0044s/iter; left time: 13.9447s
Updating learning rate to 0.0001413272893154617
Epoch: 5 cost time: 7.521145343780518
Epoch: 5, Steps: 1045 | Train Loss: 0.3494318 Vali Loss: 0.2936508 Best vali loss: 0.2804495
	iters: 100, epoch: 6 | loss: 0.5450609
	speed: 0.0151s/iter; left time: 45.9080s
	iters: 200, epoch: 6 | loss: 0.2992876
	speed: 0.0057s/iter; left time: 16.6166s
	iters: 300, epoch: 6 | loss: 0.4482194
	speed: 0.0048s/iter; left time: 13.6917s
	iters: 400, epoch: 6 | loss: 0.2123260
	speed: 0.0055s/iter; left time: 15.0466s
	iters: 500, epoch: 6 | loss: 0.3237861
	speed: 0.0055s/iter; left time: 14.5649s
	iters: 600, epoch: 6 | loss: 0.2247076
	speed: 0.0051s/iter; left time: 12.9473s
	iters: 700, epoch: 6 | loss: 0.3553792
	speed: 0.0049s/iter; left time: 12.0342s
	iters: 800, epoch: 6 | loss: 0.2647127
	speed: 0.0052s/iter; left time: 12.1114s
	iters: 900, epoch: 6 | loss: 0.6283027
	speed: 0.0053s/iter; left time: 11.8570s
	iters: 1000, epoch: 6 | loss: 0.5490552
	speed: 0.0045s/iter; left time: 9.6331s
Updating learning rate to 6.705442044488674e-05
Epoch: 6 cost time: 5.410840034484863
Epoch: 6, Steps: 1045 | Train Loss: 0.3850837 Vali Loss: 0.2928046 Best vali loss: 0.2804495
	iters: 100, epoch: 7 | loss: 0.2555452
	speed: 0.0129s/iter; left time: 25.6697s
	iters: 200, epoch: 7 | loss: 0.2932935
	speed: 0.0051s/iter; left time: 9.7276s
	iters: 300, epoch: 7 | loss: 0.2439361
	speed: 0.0051s/iter; left time: 9.0983s
	iters: 400, epoch: 7 | loss: 0.2445315
	speed: 0.0048s/iter; left time: 8.1480s
	iters: 500, epoch: 7 | loss: 0.2642559
	speed: 0.0055s/iter; left time: 8.7483s
	iters: 600, epoch: 7 | loss: 0.7799620
	speed: 0.0057s/iter; left time: 8.4790s
	iters: 700, epoch: 7 | loss: 0.1958253
	speed: 0.0052s/iter; left time: 7.1828s
	iters: 800, epoch: 7 | loss: 0.7285778
	speed: 0.0053s/iter; left time: 6.7849s
	iters: 900, epoch: 7 | loss: 0.3319921
	speed: 0.0055s/iter; left time: 6.5931s
	iters: 1000, epoch: 7 | loss: 0.2226643
	speed: 0.0056s/iter; left time: 6.1621s
Updating learning rate to 1.7426876088587254e-05
Epoch: 7 cost time: 5.5439772605896
Epoch: 7, Steps: 1045 | Train Loss: 0.3560584 Vali Loss: 0.2947482 Best vali loss: 0.2804495
	iters: 100, epoch: 8 | loss: 0.4870821
	speed: 0.0163s/iter; left time: 15.4449s
	iters: 200, epoch: 8 | loss: 0.3223538
	speed: 0.0049s/iter; left time: 4.1266s
	iters: 300, epoch: 8 | loss: 0.4142899
	speed: 0.0059s/iter; left time: 4.4080s
	iters: 400, epoch: 8 | loss: 0.3293863
	speed: 0.0061s/iter; left time: 3.9537s
	iters: 500, epoch: 8 | loss: 0.4325373
	speed: 0.0058s/iter; left time: 3.1499s
	iters: 600, epoch: 8 | loss: 0.3133628
	speed: 0.0045s/iter; left time: 1.9899s
	iters: 700, epoch: 8 | loss: 0.7518461
	speed: 0.0044s/iter; left time: 1.5072s
	iters: 800, epoch: 8 | loss: 0.9445267
	speed: 0.0067s/iter; left time: 1.6570s
	iters: 900, epoch: 8 | loss: 0.8419409
	speed: 0.0063s/iter; left time: 0.9170s
	iters: 1000, epoch: 8 | loss: 0.2822610
	speed: 0.0068s/iter; left time: 0.3135s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.955942869186401
Epoch: 8, Steps: 1045 | Train Loss: 0.5119587 Vali Loss: 0.2989109 Best vali loss: 0.2804495

best validation loss 0.2804494987925263

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022985164426, 'e_layers': 4, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.3131).  Saving model state dict ...
Epoch: 1 cost time: 0.7974200248718262
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3130886 Best vali loss: 0.3130886
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.3131 --> 0.2972).  Saving model state dict ...
Epoch: 2 cost time: 0.5715897083282471
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2972163 Best vali loss: 0.2972163
Updating learning rate to 8.93085473266162e-05
Validation loss decreased (0.2972 --> 0.2905).  Saving model state dict ...
Epoch: 3 cost time: 0.5225071907043457
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905199 Best vali loss: 0.2905199

best validation loss 0.29051985712732337

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4896113
	speed: 0.0187s/iter; left time: 17.7208s
Updating learning rate to 0.00022635856963078432
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 2.0393142700195312
Epoch: 1, Steps: 131 | Train Loss: 0.4896113 Vali Loss: 0.2799706 Best vali loss: 0.2799706
	iters: 100, epoch: 2 | loss: 0.4957182
	speed: 0.0212s/iter; left time: 17.3119s
Updating learning rate to 0.0002008536619192565
Validation loss decreased (0.2800 --> 0.2758).  Saving model state dict ...
Epoch: 2 cost time: 1.7550690174102783
Epoch: 2, Steps: 131 | Train Loss: 0.4957182 Vali Loss: 0.2758062 Best vali loss: 0.2758062
	iters: 100, epoch: 3 | loss: 0.4318376
	speed: 0.0214s/iter; left time: 14.6833s
Updating learning rate to 0.00016268287006193248
Validation loss decreased (0.2758 --> 0.2750).  Saving model state dict ...
Epoch: 3 cost time: 1.6800057888031006
Epoch: 3, Steps: 131 | Train Loss: 0.4318376 Vali Loss: 0.2749960 Best vali loss: 0.2749960

best validation loss 0.2749960359674974

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010602146623, 'e_layers': 4, 'learning_rate': 0.000225512069, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8058677
	speed: 0.0118s/iter; left time: 23.6293s
	iters: 200, epoch: 1 | loss: 0.4476928
	speed: 0.0069s/iter; left time: 13.1564s
Updating learning rate to 0.000225512069
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 1.9800875186920166
Epoch: 1, Steps: 262 | Train Loss: 0.6267803 Vali Loss: 0.2835326 Best vali loss: 0.2835326
	iters: 100, epoch: 2 | loss: 0.3381070
	speed: 0.0135s/iter; left time: 23.5039s
	iters: 200, epoch: 2 | loss: 0.6086090
	speed: 0.0058s/iter; left time: 9.4341s
Updating learning rate to 0.0001127560345
Validation loss decreased (0.2835 --> 0.2794).  Saving model state dict ...
Epoch: 2 cost time: 1.6809673309326172
Epoch: 2, Steps: 262 | Train Loss: 0.4733580 Vali Loss: 0.2794386 Best vali loss: 0.2794386
	iters: 100, epoch: 3 | loss: 0.6099918
	speed: 0.0147s/iter; left time: 21.6975s
	iters: 200, epoch: 3 | loss: 0.6397390
	speed: 0.0070s/iter; left time: 9.5935s
Updating learning rate to 5.637801725e-05
Epoch: 3 cost time: 1.766270399093628
Epoch: 3, Steps: 262 | Train Loss: 0.6248654 Vali Loss: 0.2817139 Best vali loss: 0.2794386

best validation loss 0.27943861639690293

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4021078
	speed: 0.0185s/iter; left time: 10.2823s
Updating learning rate to 0.0001176573511
Epoch: 4 cost time: 1.860011339187622
Epoch: 4, Steps: 131 | Train Loss: 0.4021078 Vali Loss: 0.2913485 Best vali loss: 0.2749960
	iters: 100, epoch: 5 | loss: 0.3229543
	speed: 0.0192s/iter; left time: 8.1570s
Updating learning rate to 7.263183213806753e-05
Epoch: 5 cost time: 1.6723272800445557
Epoch: 5, Steps: 131 | Train Loss: 0.3229543 Vali Loss: 0.2952643 Best vali loss: 0.2749960
	iters: 100, epoch: 6 | loss: 0.3606459
	speed: 0.0187s/iter; left time: 5.5112s
Updating learning rate to 3.446104028074351e-05
Epoch: 6 cost time: 1.57584547996521
Epoch: 6, Steps: 131 | Train Loss: 0.3606459 Vali Loss: 0.3045064 Best vali loss: 0.2749960
	iters: 100, epoch: 7 | loss: 0.3277754
	speed: 0.0193s/iter; left time: 3.1407s
Updating learning rate to 8.956132569215671e-06
Epoch: 7 cost time: 1.5989224910736084
Epoch: 7, Steps: 131 | Train Loss: 0.3277754 Vali Loss: 0.3091476 Best vali loss: 0.2749960
	iters: 100, epoch: 8 | loss: 0.4145193
	speed: 0.0160s/iter; left time: 0.5128s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.385746955871582
Epoch: 8, Steps: 131 | Train Loss: 0.4145193 Vali Loss: 0.3098405 Best vali loss: 0.2749960

best validation loss 0.2749960359674974

[INFO][abstract_intensifier.py:595] Added config 4678dd and rejected config 47e958 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028252887435, 'e_layers': 1, 'learning_rate': 0.0029075166254, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027968558630216732
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 0.6506664752960205
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2876676 Best vali loss: 0.2876676
Updating learning rate to 0.0024817206738164837
Epoch: 2 cost time: 0.39920687675476074
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2972807 Best vali loss: 0.2876676
Updating learning rate to 0.002010087533633318
Epoch: 3 cost time: 0.40355730056762695
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3018529 Best vali loss: 0.2876676
Updating learning rate to 0.0014537583127
Epoch: 4 cost time: 0.2953791618347168
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2995709 Best vali loss: 0.2876676
Updating learning rate to 0.0008974290917666826
Epoch: 5 cost time: 0.29460859298706055
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2982234 Best vali loss: 0.2876676
Updating learning rate to 0.0004257959515835167
Epoch: 6 cost time: 0.3434488773345947
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3253710 Best vali loss: 0.2876676
Updating learning rate to 0.000110660762378327
Epoch: 7 cost time: 0.34844493865966797
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3145081 Best vali loss: 0.2876676
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3020968437194824
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3227456 Best vali loss: 0.2876676

best validation loss 0.28766755575737396

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.004626800892, 'e_layers': 2, 'learning_rate': 0.0022058584169, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8312569
	speed: 0.0100s/iter; left time: 9.5051s
Updating learning rate to 0.0022058584169
Validation loss decreased (inf --> 0.2964).  Saving model state dict ...
Epoch: 1 cost time: 0.8726916313171387
Epoch: 1, Steps: 131 | Train Loss: 0.8312569 Vali Loss: 0.2964011 Best vali loss: 0.2964011
	iters: 100, epoch: 2 | loss: 0.5828384
	speed: 0.0081s/iter; left time: 6.6635s
Updating learning rate to 0.00110292920845
Epoch: 2 cost time: 0.6942379474639893
Epoch: 2, Steps: 131 | Train Loss: 0.5828384 Vali Loss: 0.2992290 Best vali loss: 0.2964011
	iters: 100, epoch: 3 | loss: 0.5932889
	speed: 0.0081s/iter; left time: 5.5386s
Updating learning rate to 0.000551464604225
Validation loss decreased (0.2964 --> 0.2935).  Saving model state dict ...
Epoch: 3 cost time: 0.6220924854278564
Epoch: 3, Steps: 131 | Train Loss: 0.5932889 Vali Loss: 0.2935302 Best vali loss: 0.2935302
	iters: 100, epoch: 4 | loss: 0.4060763
	speed: 0.0080s/iter; left time: 4.4698s
Updating learning rate to 0.0002757323021125
Validation loss decreased (0.2935 --> 0.2924).  Saving model state dict ...
Epoch: 4 cost time: 0.6360580921173096
Epoch: 4, Steps: 131 | Train Loss: 0.4060763 Vali Loss: 0.2923642 Best vali loss: 0.2923642
	iters: 100, epoch: 5 | loss: 0.4790852
	speed: 0.0084s/iter; left time: 3.5559s
Updating learning rate to 0.00013786615105625
Epoch: 5 cost time: 0.6833066940307617
Epoch: 5, Steps: 131 | Train Loss: 0.4790852 Vali Loss: 0.2965525 Best vali loss: 0.2923642
	iters: 100, epoch: 6 | loss: 0.6271821
	speed: 0.0085s/iter; left time: 2.4990s
Updating learning rate to 6.8933075528125e-05
Epoch: 6 cost time: 0.6801588535308838
Epoch: 6, Steps: 131 | Train Loss: 0.6271821 Vali Loss: 0.3005619 Best vali loss: 0.2923642
	iters: 100, epoch: 7 | loss: 0.4093759
	speed: 0.0077s/iter; left time: 1.2605s
Updating learning rate to 3.44665377640625e-05
Epoch: 7 cost time: 0.6157982349395752
Epoch: 7, Steps: 131 | Train Loss: 0.4093759 Vali Loss: 0.2980501 Best vali loss: 0.2923642
	iters: 100, epoch: 8 | loss: 0.5201871
	speed: 0.0077s/iter; left time: 0.2470s
Updating learning rate to 1.723326888203125e-05
Epoch: 8 cost time: 0.6120107173919678
Epoch: 8, Steps: 131 | Train Loss: 0.5201871 Vali Loss: 0.2980778 Best vali loss: 0.2923642

best validation loss 0.29236419854132206

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3298896
	speed: 0.0087s/iter; left time: 17.4099s
	iters: 200, epoch: 1 | loss: 0.4349111
	speed: 0.0031s/iter; left time: 5.7890s
Updating learning rate to 0.0017284464069435928
Validation loss decreased (inf --> 0.2985).  Saving model state dict ...
Epoch: 1 cost time: 1.0866444110870361
Epoch: 1, Steps: 262 | Train Loss: 0.3824004 Vali Loss: 0.2984536 Best vali loss: 0.2984536
	iters: 100, epoch: 2 | loss: 0.5657018
	speed: 0.0075s/iter; left time: 13.0040s
	iters: 200, epoch: 2 | loss: 0.8084507
	speed: 0.0029s/iter; left time: 4.7884s
Updating learning rate to 0.001533694044948534
Validation loss decreased (0.2985 --> 0.2873).  Saving model state dict ...
Epoch: 2 cost time: 0.8140807151794434
Epoch: 2, Steps: 262 | Train Loss: 0.6870763 Vali Loss: 0.2873173 Best vali loss: 0.2873173
	iters: 100, epoch: 3 | loss: 0.4283633
	speed: 0.0068s/iter; left time: 10.0245s
	iters: 200, epoch: 3 | loss: 0.5530860
	speed: 0.0028s/iter; left time: 3.8538s
Updating learning rate to 0.0012422265376940138
Epoch: 3 cost time: 0.7925779819488525
Epoch: 3, Steps: 262 | Train Loss: 0.4907247 Vali Loss: 0.2966699 Best vali loss: 0.2873173

best validation loss 0.2873173406151601

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039181470431, 'e_layers': 3, 'learning_rate': 0.00012582665, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012103765828973066
Validation loss decreased (inf --> 0.3221).  Saving model state dict ...
Epoch: 1 cost time: 0.6852314472198486
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3220537 Best vali loss: 0.3220537
Updating learning rate to 0.00010739976373449315
Validation loss decreased (0.3221 --> 0.3038).  Saving model state dict ...
Epoch: 2 cost time: 0.45676350593566895
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3038350 Best vali loss: 0.3038350
Updating learning rate to 8.698921215250042e-05
Validation loss decreased (0.3038 --> 0.2937).  Saving model state dict ...
Epoch: 3 cost time: 0.489185094833374
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2936717 Best vali loss: 0.2936717

best validation loss 0.29367169973607754

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6906875
	speed: 0.0115s/iter; left time: 23.0198s
	iters: 200, epoch: 1 | loss: 0.4218192
	speed: 0.0058s/iter; left time: 10.9781s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.3228).  Saving model state dict ...
Epoch: 1 cost time: 1.862980842590332
Epoch: 1, Steps: 262 | Train Loss: 0.5562534 Vali Loss: 0.3227806 Best vali loss: 0.3227806
	iters: 100, epoch: 2 | loss: 0.4368342
	speed: 0.0128s/iter; left time: 22.2106s
	iters: 200, epoch: 2 | loss: 0.6082223
	speed: 0.0057s/iter; left time: 9.3197s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 1.5267441272735596
Epoch: 2, Steps: 262 | Train Loss: 0.5225283 Vali Loss: 0.3276022 Best vali loss: 0.3227806
	iters: 100, epoch: 3 | loss: 0.4718234
	speed: 0.0115s/iter; left time: 16.9502s
	iters: 200, epoch: 3 | loss: 0.5947189
	speed: 0.0055s/iter; left time: 7.5080s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 1.481964349746704
Epoch: 3, Steps: 262 | Train Loss: 0.5332712 Vali Loss: 0.3249309 Best vali loss: 0.3227806

best validation loss 0.32278062744005853

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3035231
	speed: 0.0096s/iter; left time: 11.6307s
	iters: 200, epoch: 4 | loss: 0.4101751
	speed: 0.0036s/iter; left time: 3.9767s
Updating learning rate to 0.000898417171
Epoch: 4 cost time: 1.2109973430633545
Epoch: 4, Steps: 262 | Train Loss: 0.3568491 Vali Loss: 0.2967326 Best vali loss: 0.2873173
	iters: 100, epoch: 5 | loss: 0.4310120
	speed: 0.0078s/iter; left time: 7.3724s
	iters: 200, epoch: 5 | loss: 0.6641536
	speed: 0.0025s/iter; left time: 2.1155s
Updating learning rate to 0.0005546078043059862
Epoch: 5 cost time: 0.7211146354675293
Epoch: 5, Steps: 262 | Train Loss: 0.5475828 Vali Loss: 0.3308066 Best vali loss: 0.2873173
	iters: 100, epoch: 6 | loss: 0.3965822
	speed: 0.0076s/iter; left time: 5.1874s
	iters: 200, epoch: 6 | loss: 0.4093231
	speed: 0.0037s/iter; left time: 2.1540s
Updating learning rate to 0.000263140297051466
Epoch: 6 cost time: 0.9975695610046387
Epoch: 6, Steps: 262 | Train Loss: 0.4029527 Vali Loss: 0.3458055 Best vali loss: 0.2873173
	iters: 100, epoch: 7 | loss: 0.3528026
	speed: 0.0088s/iter; left time: 3.7368s
	iters: 200, epoch: 7 | loss: 0.4301212
	speed: 0.0036s/iter; left time: 1.1797s
Updating learning rate to 6.838793505640724e-05
Epoch: 7 cost time: 0.9852657318115234
Epoch: 7, Steps: 262 | Train Loss: 0.3914619 Vali Loss: 0.3648313 Best vali loss: 0.2873173
	iters: 100, epoch: 8 | loss: 0.3852673
	speed: 0.0085s/iter; left time: 1.3878s
	iters: 200, epoch: 8 | loss: 0.2578292
	speed: 0.0036s/iter; left time: 0.2243s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9659616947174072
Epoch: 8, Steps: 262 | Train Loss: 0.3215483 Vali Loss: 0.3662551 Best vali loss: 0.2873173

best validation loss 0.2873173406151601

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010053990878, 'e_layers': 2, 'learning_rate': 0.0004254413654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0673288
	speed: 0.0096s/iter; left time: 19.0757s
	iters: 200, epoch: 1 | loss: 0.4951391
	speed: 0.0041s/iter; left time: 7.7663s
Updating learning rate to 0.0004254413654
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 1.3601529598236084
Epoch: 1, Steps: 262 | Train Loss: 0.7812340 Vali Loss: 0.2802400 Best vali loss: 0.2802400
	iters: 100, epoch: 2 | loss: 0.7355131
	speed: 0.0094s/iter; left time: 16.3568s
	iters: 200, epoch: 2 | loss: 0.4088578
	speed: 0.0042s/iter; left time: 6.8061s
Updating learning rate to 0.0002127206827
Epoch: 2 cost time: 1.1289300918579102
Epoch: 2, Steps: 262 | Train Loss: 0.5721854 Vali Loss: 0.2845010 Best vali loss: 0.2802400
	iters: 100, epoch: 3 | loss: 0.4450033
	speed: 0.0099s/iter; left time: 14.5120s
	iters: 200, epoch: 3 | loss: 0.3665324
	speed: 0.0042s/iter; left time: 5.7525s
Updating learning rate to 0.00010636034135
Epoch: 3 cost time: 1.177727460861206
Epoch: 3, Steps: 262 | Train Loss: 0.4057679 Vali Loss: 0.2867454 Best vali loss: 0.2802400
	iters: 100, epoch: 4 | loss: 0.6891266
	speed: 0.0105s/iter; left time: 12.7132s
	iters: 200, epoch: 4 | loss: 0.6589614
	speed: 0.0045s/iter; left time: 4.9852s
Updating learning rate to 5.3180170675e-05
Epoch: 4 cost time: 1.2369508743286133
Epoch: 4, Steps: 262 | Train Loss: 0.6740440 Vali Loss: 0.2882012 Best vali loss: 0.2802400
	iters: 100, epoch: 5 | loss: 0.3773437
	speed: 0.0102s/iter; left time: 9.6826s
	iters: 200, epoch: 5 | loss: 0.3152882
	speed: 0.0039s/iter; left time: 3.3269s
Updating learning rate to 2.65900853375e-05
Epoch: 5 cost time: 1.1127164363861084
Epoch: 5, Steps: 262 | Train Loss: 0.3463160 Vali Loss: 0.2882389 Best vali loss: 0.2802400
	iters: 100, epoch: 6 | loss: 0.7348616
	speed: 0.0090s/iter; left time: 6.1937s
	iters: 200, epoch: 6 | loss: 0.3543857
	speed: 0.0047s/iter; left time: 2.7786s
Updating learning rate to 1.329504266875e-05
Epoch: 6 cost time: 1.2452583312988281
Epoch: 6, Steps: 262 | Train Loss: 0.5446236 Vali Loss: 0.2884761 Best vali loss: 0.2802400
	iters: 100, epoch: 7 | loss: 0.7919623
	speed: 0.0104s/iter; left time: 4.4181s
	iters: 200, epoch: 7 | loss: 0.4993375
	speed: 0.0048s/iter; left time: 1.5502s
Updating learning rate to 6.647521334375e-06
Epoch: 7 cost time: 1.2692270278930664
Epoch: 7, Steps: 262 | Train Loss: 0.6456499 Vali Loss: 0.2888288 Best vali loss: 0.2802400
	iters: 100, epoch: 8 | loss: 0.4868769
	speed: 0.0104s/iter; left time: 1.6920s
	iters: 200, epoch: 8 | loss: 0.5787588
	speed: 0.0042s/iter; left time: 0.2677s
Updating learning rate to 3.3237606671875e-06
Epoch: 8 cost time: 1.1974060535430908
Epoch: 8, Steps: 262 | Train Loss: 0.5328178 Vali Loss: 0.2890192 Best vali loss: 0.2802400

best validation loss 0.28023995348249237

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0113842174153, 'e_layers': 1, 'learning_rate': 0.0018134405744, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2821549
	speed: 0.0092s/iter; left time: 75.9902s
	iters: 200, epoch: 1 | loss: 0.3987502
	speed: 0.0038s/iter; left time: 30.6668s
	iters: 300, epoch: 1 | loss: 0.5324462
	speed: 0.0036s/iter; left time: 28.8604s
	iters: 400, epoch: 1 | loss: 0.5779596
	speed: 0.0036s/iter; left time: 28.4417s
	iters: 500, epoch: 1 | loss: 1.2335888
	speed: 0.0034s/iter; left time: 26.9738s
	iters: 600, epoch: 1 | loss: 0.2063750
	speed: 0.0036s/iter; left time: 27.8320s
	iters: 700, epoch: 1 | loss: 0.3018051
	speed: 0.0028s/iter; left time: 21.2338s
	iters: 800, epoch: 1 | loss: 1.4700868
	speed: 0.0026s/iter; left time: 19.6683s
	iters: 900, epoch: 1 | loss: 0.7508001
	speed: 0.0026s/iter; left time: 19.3307s
	iters: 1000, epoch: 1 | loss: 0.2226608
	speed: 0.0027s/iter; left time: 19.9736s
Updating learning rate to 0.0018134405744
Validation loss decreased (inf --> 0.2906).  Saving model state dict ...
Epoch: 1 cost time: 3.616546392440796
Epoch: 1, Steps: 1045 | Train Loss: 0.5976627 Vali Loss: 0.2906177 Best vali loss: 0.2906177
	iters: 100, epoch: 2 | loss: 0.3665322
	speed: 0.0087s/iter; left time: 63.0546s
	iters: 200, epoch: 2 | loss: 0.2599014
	speed: 0.0029s/iter; left time: 20.9403s
	iters: 300, epoch: 2 | loss: 0.2486255
	speed: 0.0033s/iter; left time: 23.3510s
	iters: 400, epoch: 2 | loss: 0.3289205
	speed: 0.0030s/iter; left time: 20.5707s
	iters: 500, epoch: 2 | loss: 0.6107349
	speed: 0.0024s/iter; left time: 16.2619s
	iters: 600, epoch: 2 | loss: 0.4555877
	speed: 0.0024s/iter; left time: 15.9593s
	iters: 700, epoch: 2 | loss: 0.2472999
	speed: 0.0024s/iter; left time: 15.5487s
	iters: 800, epoch: 2 | loss: 0.3258070
	speed: 0.0023s/iter; left time: 14.8446s
	iters: 900, epoch: 2 | loss: 0.7983393
	speed: 0.0043s/iter; left time: 27.2990s
	iters: 1000, epoch: 2 | loss: 0.3878005
	speed: 0.0027s/iter; left time: 17.1832s
Updating learning rate to 0.0009067202872
Validation loss decreased (0.2906 --> 0.2859).  Saving model state dict ...
Epoch: 2 cost time: 3.1010260581970215
Epoch: 2, Steps: 1045 | Train Loss: 0.4029549 Vali Loss: 0.2859000 Best vali loss: 0.2859000
	iters: 100, epoch: 3 | loss: 0.5125707
	speed: 0.0129s/iter; left time: 79.5280s
	iters: 200, epoch: 3 | loss: 2.0228314
	speed: 0.0023s/iter; left time: 14.2270s
	iters: 300, epoch: 3 | loss: 0.3930711
	speed: 0.0023s/iter; left time: 13.6981s
	iters: 400, epoch: 3 | loss: 1.1451533
	speed: 0.0034s/iter; left time: 20.0286s
	iters: 500, epoch: 3 | loss: 0.1840632
	speed: 0.0041s/iter; left time: 23.5664s
	iters: 600, epoch: 3 | loss: 0.4481916
	speed: 0.0033s/iter; left time: 18.8872s
	iters: 700, epoch: 3 | loss: 0.6004989
	speed: 0.0026s/iter; left time: 14.3123s
	iters: 800, epoch: 3 | loss: 0.4149562
	speed: 0.0037s/iter; left time: 20.4642s
	iters: 900, epoch: 3 | loss: 0.1691192
	speed: 0.0040s/iter; left time: 21.3697s
	iters: 1000, epoch: 3 | loss: 0.3861336
	speed: 0.0029s/iter; left time: 15.3856s
Updating learning rate to 0.0004533601436
Epoch: 3 cost time: 3.271446943283081
Epoch: 3, Steps: 1045 | Train Loss: 0.6276589 Vali Loss: 0.2895176 Best vali loss: 0.2859000
	iters: 100, epoch: 4 | loss: 0.5961522
	speed: 0.0122s/iter; left time: 62.4198s
	iters: 200, epoch: 4 | loss: 0.9737016
	speed: 0.0022s/iter; left time: 10.9573s
	iters: 300, epoch: 4 | loss: 1.2920990
	speed: 0.0023s/iter; left time: 11.2003s
	iters: 400, epoch: 4 | loss: 0.2623804
	speed: 0.0029s/iter; left time: 14.1438s
	iters: 500, epoch: 4 | loss: 0.6399102
	speed: 0.0038s/iter; left time: 17.9360s
	iters: 600, epoch: 4 | loss: 0.1795755
	speed: 0.0030s/iter; left time: 13.7307s
	iters: 700, epoch: 4 | loss: 0.3967550
	speed: 0.0039s/iter; left time: 17.4913s
	iters: 800, epoch: 4 | loss: 0.8369756
	speed: 0.0033s/iter; left time: 14.5162s
	iters: 900, epoch: 4 | loss: 0.3025718
	speed: 0.0035s/iter; left time: 15.0976s
	iters: 1000, epoch: 4 | loss: 0.2927606
	speed: 0.0033s/iter; left time: 13.7826s
Updating learning rate to 0.0002266800718
Epoch: 4 cost time: 3.280670404434204
Epoch: 4, Steps: 1045 | Train Loss: 0.5772882 Vali Loss: 0.2943782 Best vali loss: 0.2859000
	iters: 100, epoch: 5 | loss: 0.2369124
	speed: 0.0122s/iter; left time: 49.6528s
	iters: 200, epoch: 5 | loss: 0.7460964
	speed: 0.0024s/iter; left time: 9.4720s
	iters: 300, epoch: 5 | loss: 0.5430900
	speed: 0.0025s/iter; left time: 9.7273s
	iters: 400, epoch: 5 | loss: 0.6728268
	speed: 0.0034s/iter; left time: 12.9338s
	iters: 500, epoch: 5 | loss: 0.2541601
	speed: 0.0035s/iter; left time: 13.0302s
	iters: 600, epoch: 5 | loss: 1.0044008
	speed: 0.0034s/iter; left time: 12.0686s
	iters: 700, epoch: 5 | loss: 0.8743781
	speed: 0.0027s/iter; left time: 9.4910s
	iters: 800, epoch: 5 | loss: 0.1643062
	speed: 0.0033s/iter; left time: 11.1113s
	iters: 900, epoch: 5 | loss: 1.6819364
	speed: 0.0033s/iter; left time: 10.6806s
	iters: 1000, epoch: 5 | loss: 0.4437176
	speed: 0.0032s/iter; left time: 10.1130s
Updating learning rate to 0.0001133400359
Epoch: 5 cost time: 3.1758692264556885
Epoch: 5, Steps: 1045 | Train Loss: 0.6621825 Vali Loss: 0.3005827 Best vali loss: 0.2859000
	iters: 100, epoch: 6 | loss: 0.8530199
	speed: 0.0117s/iter; left time: 35.5310s
	iters: 200, epoch: 6 | loss: 0.2435154
	speed: 0.0028s/iter; left time: 8.1968s
	iters: 300, epoch: 6 | loss: 0.2824014
	speed: 0.0022s/iter; left time: 6.3437s
	iters: 400, epoch: 6 | loss: 0.4394563
	speed: 0.0030s/iter; left time: 8.2365s
	iters: 500, epoch: 6 | loss: 0.3633952
	speed: 0.0030s/iter; left time: 8.0203s
	iters: 600, epoch: 6 | loss: 0.3101010
	speed: 0.0029s/iter; left time: 7.2787s
	iters: 700, epoch: 6 | loss: 0.2850866
	speed: 0.0029s/iter; left time: 7.0519s
	iters: 800, epoch: 6 | loss: 0.2476582
	speed: 0.0026s/iter; left time: 6.0090s
	iters: 900, epoch: 6 | loss: 0.7389633
	speed: 0.0030s/iter; left time: 6.6175s
	iters: 1000, epoch: 6 | loss: 0.4755078
	speed: 0.0031s/iter; left time: 6.5483s
Updating learning rate to 5.667001795e-05
Epoch: 6 cost time: 3.052907705307007
Epoch: 6, Steps: 1045 | Train Loss: 0.4239105 Vali Loss: 0.3111826 Best vali loss: 0.2859000
	iters: 100, epoch: 7 | loss: 0.5455347
	speed: 0.0111s/iter; left time: 22.1445s
	iters: 200, epoch: 7 | loss: 0.4699073
	speed: 0.0028s/iter; left time: 5.3468s
	iters: 300, epoch: 7 | loss: 0.4139078
	speed: 0.0028s/iter; left time: 5.0515s
	iters: 400, epoch: 7 | loss: 0.2000512
	speed: 0.0029s/iter; left time: 4.8386s
	iters: 500, epoch: 7 | loss: 0.4702198
	speed: 0.0025s/iter; left time: 4.0495s
	iters: 600, epoch: 7 | loss: 0.4000513
	speed: 0.0030s/iter; left time: 4.4086s
	iters: 700, epoch: 7 | loss: 0.2371430
	speed: 0.0033s/iter; left time: 4.5439s
	iters: 800, epoch: 7 | loss: 0.4830130
	speed: 0.0033s/iter; left time: 4.3087s
	iters: 900, epoch: 7 | loss: 0.5154041
	speed: 0.0031s/iter; left time: 3.6521s
	iters: 1000, epoch: 7 | loss: 0.2051919
	speed: 0.0028s/iter; left time: 3.0653s
Updating learning rate to 2.8335008975e-05
Epoch: 7 cost time: 3.1112492084503174
Epoch: 7, Steps: 1045 | Train Loss: 0.3940424 Vali Loss: 0.3137779 Best vali loss: 0.2859000
	iters: 100, epoch: 8 | loss: 0.3172380
	speed: 0.0113s/iter; left time: 10.6748s
	iters: 200, epoch: 8 | loss: 0.7877724
	speed: 0.0023s/iter; left time: 1.9629s
	iters: 300, epoch: 8 | loss: 1.0207702
	speed: 0.0023s/iter; left time: 1.7225s
	iters: 400, epoch: 8 | loss: 0.3226385
	speed: 0.0024s/iter; left time: 1.5612s
	iters: 500, epoch: 8 | loss: 0.2790428
	speed: 0.0034s/iter; left time: 1.8304s
	iters: 600, epoch: 8 | loss: 0.2892518
	speed: 0.0027s/iter; left time: 1.2111s
	iters: 700, epoch: 8 | loss: 0.2512546
	speed: 0.0030s/iter; left time: 1.0281s
	iters: 800, epoch: 8 | loss: 0.2881238
	speed: 0.0027s/iter; left time: 0.6690s
	iters: 900, epoch: 8 | loss: 0.3490377
	speed: 0.0027s/iter; left time: 0.4001s
	iters: 1000, epoch: 8 | loss: 0.2458529
	speed: 0.0029s/iter; left time: 0.1323s
Updating learning rate to 1.41675044875e-05
Epoch: 8 cost time: 2.847048044204712
Epoch: 8, Steps: 1045 | Train Loss: 0.4150983 Vali Loss: 0.3158287 Best vali loss: 0.2859000

best validation loss 0.28590000858312203

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014152615275, 'e_layers': 1, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.3100).  Saving model state dict ...
Epoch: 1 cost time: 0.6813945770263672
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3100417 Best vali loss: 0.3100417
Updating learning rate to 0.0002257411363
Validation loss decreased (0.3100 --> 0.2927).  Saving model state dict ...
Epoch: 2 cost time: 0.2853260040283203
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2926912 Best vali loss: 0.2926912
Updating learning rate to 0.00011287056815
Validation loss decreased (0.2927 --> 0.2881).  Saving model state dict ...
Epoch: 3 cost time: 0.2967491149902344
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2880645 Best vali loss: 0.2880645

best validation loss 0.2880645405740798

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5429620
	speed: 0.0092s/iter; left time: 8.7305s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.7520647048950195
Epoch: 1, Steps: 131 | Train Loss: 0.5429620 Vali Loss: 0.2829378 Best vali loss: 0.2829378
	iters: 100, epoch: 2 | loss: 0.3978160
	speed: 0.0062s/iter; left time: 5.0917s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.2829 --> 0.2812).  Saving model state dict ...
Epoch: 2 cost time: 0.4552485942840576
Epoch: 2, Steps: 131 | Train Loss: 0.3978160 Vali Loss: 0.2812244 Best vali loss: 0.2812244
	iters: 100, epoch: 3 | loss: 0.7905126
	speed: 0.0067s/iter; left time: 4.5861s
Updating learning rate to 1.70765195e-05
Validation loss decreased (0.2812 --> 0.2795).  Saving model state dict ...
Epoch: 3 cost time: 0.5080113410949707
Epoch: 3, Steps: 131 | Train Loss: 0.7905126 Vali Loss: 0.2794930 Best vali loss: 0.2794930

best validation loss 0.2794930044050419

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014438416367, 'e_layers': 1, 'learning_rate': 0.000558760672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4660459
	speed: 0.0086s/iter; left time: 17.1649s
	iters: 200, epoch: 1 | loss: 0.4870508
	speed: 0.0031s/iter; left time: 5.9634s
Updating learning rate to 0.0005374941102165261
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 1.0993082523345947
Epoch: 1, Steps: 262 | Train Loss: 0.4765483 Vali Loss: 0.2837563 Best vali loss: 0.2837563
	iters: 100, epoch: 2 | loss: 0.4836692
	speed: 0.0076s/iter; left time: 13.2453s
	iters: 200, epoch: 2 | loss: 0.7244568
	speed: 0.0030s/iter; left time: 4.8748s
Updating learning rate to 0.00047693206611577606
Epoch: 2 cost time: 0.8307161331176758
Epoch: 2, Steps: 262 | Train Loss: 0.6040630 Vali Loss: 0.2949986 Best vali loss: 0.2837563
	iters: 100, epoch: 3 | loss: 0.3975043
	speed: 0.0077s/iter; left time: 11.3609s
	iters: 200, epoch: 3 | loss: 0.3935789
	speed: 0.0031s/iter; left time: 4.2435s
Updating learning rate to 0.000386294561915792
Epoch: 3 cost time: 0.8535928726196289
Epoch: 3, Steps: 262 | Train Loss: 0.3955416 Vali Loss: 0.2881508 Best vali loss: 0.2837563

best validation loss 0.2837562965344833

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4870154
	speed: 0.0089s/iter; left time: 4.9389s
Updating learning rate to 8.53825975e-06
Validation loss decreased (0.2795 --> 0.2779).  Saving model state dict ...
Epoch: 4 cost time: 0.690373420715332
Epoch: 4, Steps: 131 | Train Loss: 0.4870154 Vali Loss: 0.2778507 Best vali loss: 0.2778507
	iters: 100, epoch: 5 | loss: 0.3749695
	speed: 0.0059s/iter; left time: 2.4911s
Updating learning rate to 4.269129875e-06
Validation loss decreased (0.2779 --> 0.2775).  Saving model state dict ...
Epoch: 5 cost time: 0.4169173240661621
Epoch: 5, Steps: 131 | Train Loss: 0.3749695 Vali Loss: 0.2774547 Best vali loss: 0.2774547
	iters: 100, epoch: 6 | loss: 0.7490925
	speed: 0.0061s/iter; left time: 1.7962s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 0.42810845375061035
Epoch: 6, Steps: 131 | Train Loss: 0.7490925 Vali Loss: 0.2775264 Best vali loss: 0.2774547
	iters: 100, epoch: 7 | loss: 0.5067104
	speed: 0.0058s/iter; left time: 0.9492s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 0.4329664707183838
Epoch: 7, Steps: 131 | Train Loss: 0.5067104 Vali Loss: 0.2775234 Best vali loss: 0.2774547
	iters: 100, epoch: 8 | loss: 0.3697366
	speed: 0.0061s/iter; left time: 0.1943s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 0.461925745010376
Epoch: 8, Steps: 131 | Train Loss: 0.3697366 Vali Loss: 0.2774910 Best vali loss: 0.2774547

best validation loss 0.2774547010593673

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0079026385404, 'e_layers': 2, 'learning_rate': 0.0022201950658, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6355318
	speed: 0.0095s/iter; left time: 18.9898s
	iters: 200, epoch: 1 | loss: 0.5631440
	speed: 0.0038s/iter; left time: 7.1724s
Updating learning rate to 0.0022201950658
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 1.3004870414733887
Epoch: 1, Steps: 262 | Train Loss: 0.5993379 Vali Loss: 0.2901050 Best vali loss: 0.2901050
	iters: 100, epoch: 2 | loss: 0.4985761
	speed: 0.0091s/iter; left time: 15.7976s
	iters: 200, epoch: 2 | loss: 0.3962153
	speed: 0.0041s/iter; left time: 6.6916s
Updating learning rate to 0.0011100975329
Validation loss decreased (0.2901 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 1.1170127391815186
Epoch: 2, Steps: 262 | Train Loss: 0.4473957 Vali Loss: 0.2867929 Best vali loss: 0.2867929
	iters: 100, epoch: 3 | loss: 0.5953435
	speed: 0.0093s/iter; left time: 13.7114s
	iters: 200, epoch: 3 | loss: 0.7750326
	speed: 0.0041s/iter; left time: 5.6261s
Updating learning rate to 0.00055504876645
Epoch: 3 cost time: 1.116652488708496
Epoch: 3, Steps: 262 | Train Loss: 0.6851880 Vali Loss: 0.2953836 Best vali loss: 0.2867929
	iters: 100, epoch: 4 | loss: 0.4459012
	speed: 0.0090s/iter; left time: 10.8715s
	iters: 200, epoch: 4 | loss: 0.4734406
	speed: 0.0038s/iter; left time: 4.2582s
Updating learning rate to 0.000277524383225
Epoch: 4 cost time: 1.063450813293457
Epoch: 4, Steps: 262 | Train Loss: 0.4596709 Vali Loss: 0.2955467 Best vali loss: 0.2867929
	iters: 100, epoch: 5 | loss: 0.3067713
	speed: 0.0094s/iter; left time: 8.8767s
	iters: 200, epoch: 5 | loss: 0.4384037
	speed: 0.0041s/iter; left time: 3.4765s
Updating learning rate to 0.0001387621916125
Epoch: 5 cost time: 1.1071562767028809
Epoch: 5, Steps: 262 | Train Loss: 0.3725875 Vali Loss: 0.3104807 Best vali loss: 0.2867929
	iters: 100, epoch: 6 | loss: 0.4339473
	speed: 0.0090s/iter; left time: 6.1670s
	iters: 200, epoch: 6 | loss: 0.2600999
	speed: 0.0039s/iter; left time: 2.2643s
Updating learning rate to 6.938109580625e-05
Epoch: 6 cost time: 1.0532774925231934
Epoch: 6, Steps: 262 | Train Loss: 0.3470236 Vali Loss: 0.3038199 Best vali loss: 0.2867929
	iters: 100, epoch: 7 | loss: 0.4545154
	speed: 0.0090s/iter; left time: 3.8123s
	iters: 200, epoch: 7 | loss: 0.2778278
	speed: 0.0035s/iter; left time: 1.1392s
Updating learning rate to 3.4690547903125e-05
Epoch: 7 cost time: 1.0084612369537354
Epoch: 7, Steps: 262 | Train Loss: 0.3661716 Vali Loss: 0.3086475 Best vali loss: 0.2867929
	iters: 100, epoch: 8 | loss: 0.3121894
	speed: 0.0095s/iter; left time: 1.5543s
	iters: 200, epoch: 8 | loss: 0.2214279
	speed: 0.0048s/iter; left time: 0.3053s
Updating learning rate to 1.73452739515625e-05
Epoch: 8 cost time: 1.304166316986084
Epoch: 8, Steps: 262 | Train Loss: 0.2668087 Vali Loss: 0.3118885 Best vali loss: 0.2867929

best validation loss 0.2867929254401878

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027523638828, 'e_layers': 2, 'learning_rate': 0.0003512624633, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003378933318411835
Validation loss decreased (inf --> 0.3149).  Saving model state dict ...
Epoch: 1 cost time: 0.5728473663330078
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3149453 Best vali loss: 0.3149453
Updating learning rate to 0.0002998212665378604
Validation loss decreased (0.3149 --> 0.2991).  Saving model state dict ...
Epoch: 2 cost time: 0.3420872688293457
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2991469 Best vali loss: 0.2991469
Updating learning rate to 0.0002428423942083302
Validation loss decreased (0.2991 --> 0.2911).  Saving model state dict ...
Epoch: 3 cost time: 0.35063767433166504
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2911379 Best vali loss: 0.2911379
Updating learning rate to 0.00017563123165
Validation loss decreased (0.2911 --> 0.2876).  Saving model state dict ...
Epoch: 4 cost time: 0.38625431060791016
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2876489 Best vali loss: 0.2876489
Updating learning rate to 0.00010842006909166983
Validation loss decreased (0.2876 --> 0.2855).  Saving model state dict ...
Epoch: 5 cost time: 0.3736457824707031
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2854771 Best vali loss: 0.2854771
Updating learning rate to 5.144119676213962e-05
Validation loss decreased (0.2855 --> 0.2845).  Saving model state dict ...
Epoch: 6 cost time: 0.3436133861541748
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845020 Best vali loss: 0.2845020
Updating learning rate to 1.3369131458816492e-05
Validation loss decreased (0.2845 --> 0.2842).  Saving model state dict ...
Epoch: 7 cost time: 0.3679842948913574
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2842018 Best vali loss: 0.2842018
Updating learning rate to 0.0
Validation loss decreased (0.2842 --> 0.2842).  Saving model state dict ...
Epoch: 8 cost time: 0.35121893882751465
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2841666 Best vali loss: 0.2841666

best validation loss 0.28416655216796904

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8340313
	speed: 0.0098s/iter; left time: 39.9729s
	iters: 200, epoch: 1 | loss: 0.3961600
	speed: 0.0041s/iter; left time: 16.5034s
	iters: 300, epoch: 1 | loss: 0.3412137
	speed: 0.0045s/iter; left time: 17.6715s
	iters: 400, epoch: 1 | loss: 0.3631559
	speed: 0.0047s/iter; left time: 17.6025s
	iters: 500, epoch: 1 | loss: 0.1976330
	speed: 0.0045s/iter; left time: 16.5241s
Updating learning rate to 9.34698808e-05
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 2.5998144149780273
Epoch: 1, Steps: 523 | Train Loss: 0.4264388 Vali Loss: 0.2805963 Best vali loss: 0.2805963
	iters: 100, epoch: 2 | loss: 0.4813979
	speed: 0.0101s/iter; left time: 36.1126s
	iters: 200, epoch: 2 | loss: 1.2156699
	speed: 0.0041s/iter; left time: 14.2219s
	iters: 300, epoch: 2 | loss: 0.8839002
	speed: 0.0045s/iter; left time: 15.0489s
	iters: 400, epoch: 2 | loss: 0.3731978
	speed: 0.0045s/iter; left time: 14.5982s
	iters: 500, epoch: 2 | loss: 0.5137824
	speed: 0.0045s/iter; left time: 14.1048s
Updating learning rate to 4.67349404e-05
Validation loss decreased (0.2806 --> 0.2762).  Saving model state dict ...
Epoch: 2 cost time: 2.314758539199829
Epoch: 2, Steps: 523 | Train Loss: 0.6935897 Vali Loss: 0.2761563 Best vali loss: 0.2761563
	iters: 100, epoch: 3 | loss: 0.3240150
	speed: 0.0099s/iter; left time: 30.0021s
	iters: 200, epoch: 3 | loss: 0.4868388
	speed: 0.0040s/iter; left time: 11.6696s
	iters: 300, epoch: 3 | loss: 0.4181248
	speed: 0.0045s/iter; left time: 12.6878s
	iters: 400, epoch: 3 | loss: 0.5650256
	speed: 0.0045s/iter; left time: 12.2927s
	iters: 500, epoch: 3 | loss: 0.2368787
	speed: 0.0044s/iter; left time: 11.6705s
Updating learning rate to 2.33674702e-05
Validation loss decreased (0.2762 --> 0.2758).  Saving model state dict ...
Epoch: 3 cost time: 2.2610836029052734
Epoch: 3, Steps: 523 | Train Loss: 0.4061766 Vali Loss: 0.2758127 Best vali loss: 0.2758127

best validation loss 0.2758127155690532

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7193140
	speed: 0.0107s/iter; left time: 43.5579s
	iters: 200, epoch: 1 | loss: 0.6999950
	speed: 0.0058s/iter; left time: 23.0778s
	iters: 300, epoch: 1 | loss: 0.5718579
	speed: 0.0058s/iter; left time: 22.6322s
	iters: 400, epoch: 1 | loss: 0.5889742
	speed: 0.0057s/iter; left time: 21.4382s
	iters: 500, epoch: 1 | loss: 0.3541995
	speed: 0.0056s/iter; left time: 20.5898s
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 3.2076313495635986
Epoch: 1, Steps: 523 | Train Loss: 0.5868681 Vali Loss: 0.2800077 Best vali loss: 0.2800077
	iters: 100, epoch: 2 | loss: 0.2801476
	speed: 0.0124s/iter; left time: 44.1800s
	iters: 200, epoch: 2 | loss: 0.3833831
	speed: 0.0063s/iter; left time: 21.7005s
	iters: 300, epoch: 2 | loss: 0.4314804
	speed: 0.0048s/iter; left time: 16.1274s
	iters: 400, epoch: 2 | loss: 0.3165190
	speed: 0.0060s/iter; left time: 19.5726s
	iters: 500, epoch: 2 | loss: 0.3534072
	speed: 0.0067s/iter; left time: 21.1616s
Updating learning rate to 0.00034048964815
Epoch: 2 cost time: 3.1825809478759766
Epoch: 2, Steps: 523 | Train Loss: 0.3529875 Vali Loss: 0.2905247 Best vali loss: 0.2800077
	iters: 100, epoch: 3 | loss: 0.4029632
	speed: 0.0140s/iter; left time: 42.4606s
	iters: 200, epoch: 3 | loss: 0.8134559
	speed: 0.0063s/iter; left time: 18.3920s
	iters: 300, epoch: 3 | loss: 0.4942324
	speed: 0.0070s/iter; left time: 19.9134s
	iters: 400, epoch: 3 | loss: 0.6672369
	speed: 0.0069s/iter; left time: 18.8625s
	iters: 500, epoch: 3 | loss: 0.4926667
	speed: 0.0066s/iter; left time: 17.3268s
Updating learning rate to 0.000170244824075
Epoch: 3 cost time: 3.576906442642212
Epoch: 3, Steps: 523 | Train Loss: 0.5741110 Vali Loss: 0.2870036 Best vali loss: 0.2800077

best validation loss 0.2800076809202973

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0047262361197, 'e_layers': 2, 'learning_rate': 5.5626136e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.5626136e-05
Validation loss decreased (inf --> 0.3064).  Saving model state dict ...
Epoch: 1 cost time: 0.6604733467102051
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3063832 Best vali loss: 0.3063832
Updating learning rate to 2.7813068e-05
Validation loss decreased (0.3064 --> 0.2898).  Saving model state dict ...
Epoch: 2 cost time: 0.4283134937286377
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2897515 Best vali loss: 0.2897515
Updating learning rate to 1.3906534e-05
Validation loss decreased (0.2898 --> 0.2857).  Saving model state dict ...
Epoch: 3 cost time: 0.42268991470336914
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2857484 Best vali loss: 0.2857484

best validation loss 0.28574838934001445

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7912202
	speed: 0.0101s/iter; left time: 25.3844s
	iters: 200, epoch: 4 | loss: 0.4178843
	speed: 0.0051s/iter; left time: 12.4242s
	iters: 300, epoch: 4 | loss: 0.3144421
	speed: 0.0051s/iter; left time: 11.9251s
	iters: 400, epoch: 4 | loss: 0.3232890
	speed: 0.0041s/iter; left time: 9.1565s
	iters: 500, epoch: 4 | loss: 0.1947254
	speed: 0.0047s/iter; left time: 9.9793s
Updating learning rate to 1.16837351e-05
Epoch: 4 cost time: 2.7412266731262207
Epoch: 4, Steps: 523 | Train Loss: 0.4083122 Vali Loss: 0.2776025 Best vali loss: 0.2758127
	iters: 100, epoch: 5 | loss: 0.4801016
	speed: 0.0106s/iter; left time: 21.1824s
	iters: 200, epoch: 5 | loss: 1.0820357
	speed: 0.0033s/iter; left time: 6.1885s
	iters: 300, epoch: 5 | loss: 0.8131886
	speed: 0.0032s/iter; left time: 5.7350s
	iters: 400, epoch: 5 | loss: 0.3681617
	speed: 0.0061s/iter; left time: 10.4060s
	iters: 500, epoch: 5 | loss: 0.5184804
	speed: 0.0076s/iter; left time: 12.0924s
Updating learning rate to 5.84186755e-06
Epoch: 5 cost time: 2.6174356937408447
Epoch: 5, Steps: 523 | Train Loss: 0.6523936 Vali Loss: 0.2783567 Best vali loss: 0.2758127
	iters: 100, epoch: 6 | loss: 0.3328106
	speed: 0.0162s/iter; left time: 23.8281s
	iters: 200, epoch: 6 | loss: 0.4752529
	speed: 0.0076s/iter; left time: 10.4313s
	iters: 300, epoch: 6 | loss: 0.3815225
	speed: 0.0072s/iter; left time: 9.0833s
	iters: 400, epoch: 6 | loss: 0.5433298
	speed: 0.0054s/iter; left time: 6.3523s
	iters: 500, epoch: 6 | loss: 0.2332494
	speed: 0.0076s/iter; left time: 8.1251s
Updating learning rate to 2.920933775e-06
Epoch: 6 cost time: 3.6560943126678467
Epoch: 6, Steps: 523 | Train Loss: 0.3932330 Vali Loss: 0.2781771 Best vali loss: 0.2758127
	iters: 100, epoch: 7 | loss: 0.7188184
	speed: 0.0145s/iter; left time: 13.7576s
	iters: 200, epoch: 7 | loss: 0.5400223
	speed: 0.0033s/iter; left time: 2.7936s
	iters: 300, epoch: 7 | loss: 1.1294146
	speed: 0.0035s/iter; left time: 2.5882s
	iters: 400, epoch: 7 | loss: 0.3361524
	speed: 0.0049s/iter; left time: 3.1537s
	iters: 500, epoch: 7 | loss: 0.8034984
	speed: 0.0045s/iter; left time: 2.4576s
Updating learning rate to 1.4604668875e-06
Epoch: 7 cost time: 2.1339986324310303
Epoch: 7, Steps: 523 | Train Loss: 0.7055812 Vali Loss: 0.2788074 Best vali loss: 0.2758127
	iters: 100, epoch: 8 | loss: 0.8432630
	speed: 0.0094s/iter; left time: 3.9908s
	iters: 200, epoch: 8 | loss: 0.3725201
	speed: 0.0043s/iter; left time: 1.3867s
	iters: 300, epoch: 8 | loss: 0.3645019
	speed: 0.0036s/iter; left time: 0.7956s
	iters: 400, epoch: 8 | loss: 0.3062265
	speed: 0.0030s/iter; left time: 0.3659s
	iters: 500, epoch: 8 | loss: 0.3267033
	speed: 0.0031s/iter; left time: 0.0748s
Updating learning rate to 7.3023344375e-07
Epoch: 8 cost time: 1.8979644775390625
Epoch: 8, Steps: 523 | Train Loss: 0.4426429 Vali Loss: 0.2789648 Best vali loss: 0.2758127

best validation loss 0.2758127155690532

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002399800657, 'e_layers': 3, 'learning_rate': 5.41855407e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.41855407e-05
Validation loss decreased (inf --> 0.3533).  Saving model state dict ...
Epoch: 1 cost time: 0.8132047653198242
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3533242 Best vali loss: 0.3533242
Updating learning rate to 2.709277035e-05
Validation loss decreased (0.3533 --> 0.3418).  Saving model state dict ...
Epoch: 2 cost time: 0.3694884777069092
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3418423 Best vali loss: 0.3418423
Updating learning rate to 1.3546385175e-05
Validation loss decreased (0.3418 --> 0.3370).  Saving model state dict ...
Epoch: 3 cost time: 0.4105808734893799
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3370456 Best vali loss: 0.3370456
Updating learning rate to 6.7731925875e-06
Validation loss decreased (0.3370 --> 0.3348).  Saving model state dict ...
Epoch: 4 cost time: 0.5252375602722168
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3348358 Best vali loss: 0.3348358
Updating learning rate to 3.38659629375e-06
Validation loss decreased (0.3348 --> 0.3337).  Saving model state dict ...
Epoch: 5 cost time: 0.5608758926391602
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3337330 Best vali loss: 0.3337330
Updating learning rate to 1.693298146875e-06
Validation loss decreased (0.3337 --> 0.3332).  Saving model state dict ...
Epoch: 6 cost time: 0.5696077346801758
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3332061 Best vali loss: 0.3332061
Updating learning rate to 8.466490734375e-07
Validation loss decreased (0.3332 --> 0.3329).  Saving model state dict ...
Epoch: 7 cost time: 0.5309064388275146
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3329456 Best vali loss: 0.3329456
Updating learning rate to 4.2332453671875e-07
Validation loss decreased (0.3329 --> 0.3328).  Saving model state dict ...
Epoch: 8 cost time: 0.5543103218078613
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3328127 Best vali loss: 0.3328127

best validation loss 0.33281273580741244

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016060344052, 'e_layers': 3, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2401924
	speed: 0.0102s/iter; left time: 20.2731s
	iters: 200, epoch: 1 | loss: 0.7111621
	speed: 0.0050s/iter; left time: 9.4950s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.560685634613037
Epoch: 1, Steps: 262 | Train Loss: 0.4756773 Vali Loss: 0.2873960 Best vali loss: 0.2873960
	iters: 100, epoch: 2 | loss: 0.3048992
	speed: 0.0106s/iter; left time: 18.4607s
	iters: 200, epoch: 2 | loss: 0.8970234
	speed: 0.0047s/iter; left time: 7.6264s
Updating learning rate to 0.00037646055854993277
Epoch: 2 cost time: 1.2657814025878906
Epoch: 2, Steps: 262 | Train Loss: 0.6009613 Vali Loss: 0.2901256 Best vali loss: 0.2873960
	iters: 100, epoch: 3 | loss: 0.4122463
	speed: 0.0105s/iter; left time: 15.5185s
	iters: 200, epoch: 3 | loss: 0.5020506
	speed: 0.0051s/iter; left time: 6.9419s
Updating learning rate to 0.00030491694074585157
Validation loss decreased (0.2874 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 1.3502216339111328
Epoch: 3, Steps: 262 | Train Loss: 0.4571484 Vali Loss: 0.2819146 Best vali loss: 0.2819146
	iters: 100, epoch: 4 | loss: 0.3980431
	speed: 0.0113s/iter; left time: 13.6904s
	iters: 200, epoch: 4 | loss: 0.3538039
	speed: 0.0053s/iter; left time: 5.8805s
Updating learning rate to 0.0002205254895
Epoch: 4 cost time: 1.4253907203674316
Epoch: 4, Steps: 262 | Train Loss: 0.3759235 Vali Loss: 0.2842108 Best vali loss: 0.2819146
	iters: 100, epoch: 5 | loss: 0.4508059
	speed: 0.0111s/iter; left time: 10.5765s
	iters: 200, epoch: 5 | loss: 0.3012054
	speed: 0.0048s/iter; left time: 4.0973s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.3227591514587402
Epoch: 5, Steps: 262 | Train Loss: 0.3760057 Vali Loss: 0.2853221 Best vali loss: 0.2819146
	iters: 100, epoch: 6 | loss: 0.2562079
	speed: 0.0105s/iter; left time: 7.2436s
	iters: 200, epoch: 6 | loss: 0.3228912
	speed: 0.0048s/iter; left time: 2.7930s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 1.2811415195465088
Epoch: 6, Steps: 262 | Train Loss: 0.2895495 Vali Loss: 0.3049965 Best vali loss: 0.2819146
	iters: 100, epoch: 7 | loss: 0.3967261
	speed: 0.0106s/iter; left time: 4.5050s
	iters: 200, epoch: 7 | loss: 0.2379227
	speed: 0.0048s/iter; left time: 1.5581s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 1.3023686408996582
Epoch: 7, Steps: 262 | Train Loss: 0.3173244 Vali Loss: 0.2985742 Best vali loss: 0.2819146
	iters: 100, epoch: 8 | loss: 0.2478009
	speed: 0.0106s/iter; left time: 1.7281s
	iters: 200, epoch: 8 | loss: 0.3059199
	speed: 0.0049s/iter; left time: 0.3118s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.347632884979248
Epoch: 8, Steps: 262 | Train Loss: 0.2768604 Vali Loss: 0.3027226 Best vali loss: 0.2819146

best validation loss 0.2819146122485566

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047364814747, 'e_layers': 3, 'learning_rate': 0.0010075758554, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6271176
	speed: 0.0128s/iter; left time: 25.5204s
	iters: 200, epoch: 1 | loss: 0.9558530
	speed: 0.0072s/iter; left time: 13.6112s
Updating learning rate to 0.000969227282828306
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 2.178727388381958
Epoch: 1, Steps: 262 | Train Loss: 0.7914853 Vali Loss: 0.3201394 Best vali loss: 0.3201394
	iters: 100, epoch: 2 | loss: 0.8076766
	speed: 0.0155s/iter; left time: 26.8462s
	iters: 200, epoch: 2 | loss: 0.6873996
	speed: 0.0070s/iter; left time: 11.3978s
Updating learning rate to 0.0008600197876565881
Validation loss decreased (0.3201 --> 0.3199).  Saving model state dict ...
Epoch: 2 cost time: 1.8837575912475586
Epoch: 2, Steps: 262 | Train Loss: 0.7475381 Vali Loss: 0.3198762 Best vali loss: 0.3198762
	iters: 100, epoch: 3 | loss: 0.4289829
	speed: 0.0152s/iter; left time: 22.3596s
	iters: 200, epoch: 3 | loss: 0.4237156
	speed: 0.0075s/iter; left time: 10.2388s
Updating learning rate to 0.0006965792210563318
Validation loss decreased (0.3199 --> 0.3177).  Saving model state dict ...
Epoch: 3 cost time: 1.9386732578277588
Epoch: 3, Steps: 262 | Train Loss: 0.4263492 Vali Loss: 0.3176858 Best vali loss: 0.3176858

best validation loss 0.3176857709674066

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 0.0001461940837, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8124551
	speed: 0.0115s/iter; left time: 10.8750s
Updating learning rate to 0.0001461940837
Validation loss decreased (inf --> 0.3001).  Saving model state dict ...
Epoch: 1 cost time: 1.070573329925537
Epoch: 1, Steps: 131 | Train Loss: 0.8124551 Vali Loss: 0.3000662 Best vali loss: 0.3000662
	iters: 100, epoch: 2 | loss: 0.5348290
	speed: 0.0091s/iter; left time: 7.4807s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.3001 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 0.7376387119293213
Epoch: 2, Steps: 131 | Train Loss: 0.5348290 Vali Loss: 0.2871121 Best vali loss: 0.2871121
	iters: 100, epoch: 3 | loss: 0.4518459
	speed: 0.0088s/iter; left time: 6.0430s
Updating learning rate to 3.6548520925e-05
Validation loss decreased (0.2871 --> 0.2840).  Saving model state dict ...
Epoch: 3 cost time: 0.7248642444610596
Epoch: 3, Steps: 131 | Train Loss: 0.4518459 Vali Loss: 0.2840003 Best vali loss: 0.2840003

best validation loss 0.28400027291421864

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6196154
	speed: 0.0082s/iter; left time: 7.8216s
Updating learning rate to 0.0017032495860327328
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.6584877967834473
Epoch: 1, Steps: 131 | Train Loss: 0.6196154 Vali Loss: 0.2816620 Best vali loss: 0.2816620
	iters: 100, epoch: 2 | loss: 0.8622814
	speed: 0.0057s/iter; left time: 4.6804s
Updating learning rate to 0.001511336270922462
Validation loss decreased (0.2817 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 0.41642308235168457
Epoch: 2, Steps: 131 | Train Loss: 0.8622814 Vali Loss: 0.2815246 Best vali loss: 0.2815246
	iters: 100, epoch: 3 | loss: 0.5372039
	speed: 0.0057s/iter; left time: 3.9148s
Updating learning rate to 0.0012241176975961933
Epoch: 3 cost time: 0.4312593936920166
Epoch: 3, Steps: 131 | Train Loss: 0.5372039 Vali Loss: 0.2866283 Best vali loss: 0.2815246

best validation loss 0.281524602183847

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6175051
	speed: 0.0087s/iter; left time: 4.8152s
Updating learning rate to 0.0008853202902
Epoch: 4 cost time: 0.671851634979248
Epoch: 4, Steps: 131 | Train Loss: 0.6175051 Vali Loss: 0.2895513 Best vali loss: 0.2815246
	iters: 100, epoch: 5 | loss: 0.6208001
	speed: 0.0058s/iter; left time: 2.4733s
Updating learning rate to 0.0005465228828038066
Epoch: 5 cost time: 0.4456324577331543
Epoch: 5, Steps: 131 | Train Loss: 0.6208001 Vali Loss: 0.2916957 Best vali loss: 0.2815246
	iters: 100, epoch: 6 | loss: 0.4833185
	speed: 0.0058s/iter; left time: 1.7144s
Updating learning rate to 0.0002593043094775379
Epoch: 6 cost time: 0.4404280185699463
Epoch: 6, Steps: 131 | Train Loss: 0.4833185 Vali Loss: 0.2927927 Best vali loss: 0.2815246
	iters: 100, epoch: 7 | loss: 0.4833735
	speed: 0.0060s/iter; left time: 0.9835s
Updating learning rate to 6.739099436726728e-05
Epoch: 7 cost time: 0.4764275550842285
Epoch: 7, Steps: 131 | Train Loss: 0.4833735 Vali Loss: 0.2943760 Best vali loss: 0.2815246
	iters: 100, epoch: 8 | loss: 0.3231950
	speed: 0.0059s/iter; left time: 0.1877s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.442058801651001
Epoch: 8, Steps: 131 | Train Loss: 0.3231950 Vali Loss: 0.2906765 Best vali loss: 0.2815246

best validation loss 0.281524602183847

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023321783568, 'e_layers': 4, 'learning_rate': 9.29387868e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8979464
	speed: 0.0117s/iter; left time: 96.9757s
	iters: 200, epoch: 1 | loss: 1.8940372
	speed: 0.0063s/iter; left time: 51.0683s
	iters: 300, epoch: 1 | loss: 0.5398338
	speed: 0.0054s/iter; left time: 43.6078s
	iters: 400, epoch: 1 | loss: 1.1776630
	speed: 0.0053s/iter; left time: 42.4230s
	iters: 500, epoch: 1 | loss: 0.3337301
	speed: 0.0064s/iter; left time: 50.2859s
	iters: 600, epoch: 1 | loss: 0.4686851
	speed: 0.0065s/iter; left time: 50.5313s
	iters: 700, epoch: 1 | loss: 0.2983260
	speed: 0.0065s/iter; left time: 50.1182s
	iters: 800, epoch: 1 | loss: 0.4770249
	speed: 0.0064s/iter; left time: 48.6651s
	iters: 900, epoch: 1 | loss: 0.5538925
	speed: 0.0065s/iter; left time: 48.7985s
	iters: 1000, epoch: 1 | loss: 0.3539320
	speed: 0.0065s/iter; left time: 47.9650s
Updating learning rate to 8.940151485047507e-05
Validation loss decreased (inf --> 0.2995).  Saving model state dict ...
Epoch: 1 cost time: 6.796497344970703
Epoch: 1, Steps: 1045 | Train Loss: 0.6995071 Vali Loss: 0.2995277 Best vali loss: 0.2995277
	iters: 100, epoch: 2 | loss: 0.7194347
	speed: 0.0188s/iter; left time: 135.7994s
	iters: 200, epoch: 2 | loss: 0.5186115
	speed: 0.0065s/iter; left time: 46.4322s
	iters: 300, epoch: 2 | loss: 0.2722789
	speed: 0.0061s/iter; left time: 42.7674s
	iters: 400, epoch: 2 | loss: 0.1371274
	speed: 0.0054s/iter; left time: 37.1258s
	iters: 500, epoch: 2 | loss: 0.4892288
	speed: 0.0056s/iter; left time: 38.3938s
	iters: 600, epoch: 2 | loss: 0.2899892
	speed: 0.0062s/iter; left time: 41.5110s
	iters: 700, epoch: 2 | loss: 0.2235754
	speed: 0.0062s/iter; left time: 40.9561s
	iters: 800, epoch: 2 | loss: 0.5295174
	speed: 0.0062s/iter; left time: 40.3083s
	iters: 900, epoch: 2 | loss: 0.2227096
	speed: 0.0062s/iter; left time: 39.8061s
	iters: 1000, epoch: 2 | loss: 0.4860080
	speed: 0.0062s/iter; left time: 39.3141s
Updating learning rate to 7.93282165907654e-05
Validation loss decreased (0.2995 --> 0.2880).  Saving model state dict ...
Epoch: 2 cost time: 6.42661714553833
Epoch: 2, Steps: 1045 | Train Loss: 0.3888481 Vali Loss: 0.2880345 Best vali loss: 0.2880345
	iters: 100, epoch: 3 | loss: 0.2802228
	speed: 0.0186s/iter; left time: 114.8239s
	iters: 200, epoch: 3 | loss: 0.6223162
	speed: 0.0062s/iter; left time: 37.5306s
	iters: 300, epoch: 3 | loss: 0.3477182
	speed: 0.0062s/iter; left time: 36.9180s
	iters: 400, epoch: 3 | loss: 0.2793298
	speed: 0.0054s/iter; left time: 31.6949s
	iters: 500, epoch: 3 | loss: 0.1702289
	speed: 0.0053s/iter; left time: 30.7438s
	iters: 600, epoch: 3 | loss: 0.5040546
	speed: 0.0060s/iter; left time: 34.1282s
	iters: 700, epoch: 3 | loss: 0.2217704
	speed: 0.0061s/iter; left time: 33.7815s
	iters: 800, epoch: 3 | loss: 0.3357880
	speed: 0.0062s/iter; left time: 33.8112s
	iters: 900, epoch: 3 | loss: 0.2156231
	speed: 0.0062s/iter; left time: 33.3880s
	iters: 1000, epoch: 3 | loss: 0.2407504
	speed: 0.0062s/iter; left time: 32.7656s
Updating learning rate to 6.425246036623565e-05
Validation loss decreased (0.2880 --> 0.2847).  Saving model state dict ...
Epoch: 3 cost time: 6.312777757644653
Epoch: 3, Steps: 1045 | Train Loss: 0.3217802 Vali Loss: 0.2847222 Best vali loss: 0.2847222
	iters: 100, epoch: 4 | loss: 0.4889745
	speed: 0.0185s/iter; left time: 94.7176s
	iters: 200, epoch: 4 | loss: 1.0714405
	speed: 0.0060s/iter; left time: 30.1715s
	iters: 300, epoch: 4 | loss: 0.2179647
	speed: 0.0060s/iter; left time: 29.6187s
	iters: 400, epoch: 4 | loss: 0.4634647
	speed: 0.0056s/iter; left time: 27.2263s
	iters: 500, epoch: 4 | loss: 0.3736471
	speed: 0.0055s/iter; left time: 26.0526s
	iters: 600, epoch: 4 | loss: 0.2529553
	speed: 0.0059s/iter; left time: 27.1156s
	iters: 700, epoch: 4 | loss: 0.2214192
	speed: 0.0060s/iter; left time: 27.2526s
	iters: 800, epoch: 4 | loss: 0.2154242
	speed: 0.0062s/iter; left time: 27.2237s
	iters: 900, epoch: 4 | loss: 0.4881549
	speed: 0.0062s/iter; left time: 26.9870s
	iters: 1000, epoch: 4 | loss: 0.3721004
	speed: 0.0061s/iter; left time: 25.7904s
Updating learning rate to 4.64693934e-05
Validation loss decreased (0.2847 --> 0.2816).  Saving model state dict ...
Epoch: 4 cost time: 6.2665228843688965
Epoch: 4, Steps: 1045 | Train Loss: 0.4165545 Vali Loss: 0.2816495 Best vali loss: 0.2816495
	iters: 100, epoch: 5 | loss: 1.2554265
	speed: 0.0172s/iter; left time: 70.0595s
	iters: 200, epoch: 5 | loss: 0.3717354
	speed: 0.0128s/iter; left time: 50.7607s
	iters: 300, epoch: 5 | loss: 0.2721963
	speed: 0.0119s/iter; left time: 46.1317s
	iters: 400, epoch: 5 | loss: 0.1808657
	speed: 0.0084s/iter; left time: 31.7785s
	iters: 500, epoch: 5 | loss: 0.3199790
	speed: 0.0106s/iter; left time: 39.0311s
	iters: 600, epoch: 5 | loss: 0.2493406
	speed: 0.0105s/iter; left time: 37.5642s
	iters: 700, epoch: 5 | loss: 0.4137097
	speed: 0.0083s/iter; left time: 28.8544s
	iters: 800, epoch: 5 | loss: 0.2758626
	speed: 0.0121s/iter; left time: 40.8833s
	iters: 900, epoch: 5 | loss: 0.4973119
	speed: 0.0107s/iter; left time: 34.9481s
	iters: 1000, epoch: 5 | loss: 0.3709986
	speed: 0.0090s/iter; left time: 28.7698s
Updating learning rate to 2.8686326433764354e-05
Epoch: 5 cost time: 10.594949722290039
Epoch: 5, Steps: 1045 | Train Loss: 0.4207426 Vali Loss: 0.2826056 Best vali loss: 0.2816495
	iters: 100, epoch: 6 | loss: 0.3050373
	speed: 0.0336s/iter; left time: 102.1099s
	iters: 200, epoch: 6 | loss: 0.4980401
	speed: 0.0107s/iter; left time: 31.3819s
	iters: 300, epoch: 6 | loss: 0.3336873
	speed: 0.0090s/iter; left time: 25.5474s
	iters: 400, epoch: 6 | loss: 0.8691087
	speed: 0.0099s/iter; left time: 27.1521s
	iters: 500, epoch: 6 | loss: 0.2183108
	speed: 0.0113s/iter; left time: 29.8039s
	iters: 600, epoch: 6 | loss: 0.5298879
	speed: 0.0094s/iter; left time: 23.7755s
	iters: 700, epoch: 6 | loss: 1.1443065
	speed: 0.0099s/iter; left time: 24.2181s
	iters: 800, epoch: 6 | loss: 0.2569020
	speed: 0.0107s/iter; left time: 25.0324s
	iters: 900, epoch: 6 | loss: 0.3974850
	speed: 0.0096s/iter; left time: 21.4952s
	iters: 1000, epoch: 6 | loss: 0.2917107
	speed: 0.0092s/iter; left time: 19.5561s
Updating learning rate to 1.3610570209234607e-05
Epoch: 6 cost time: 10.462528467178345
Epoch: 6, Steps: 1045 | Train Loss: 0.4844476 Vali Loss: 0.2820337 Best vali loss: 0.2816495
	iters: 100, epoch: 7 | loss: 0.5734155
	speed: 0.0277s/iter; left time: 55.1272s
	iters: 200, epoch: 7 | loss: 0.2780638
	speed: 0.0047s/iter; left time: 8.9063s
	iters: 300, epoch: 7 | loss: 0.4086720
	speed: 0.0059s/iter; left time: 10.5684s
	iters: 400, epoch: 7 | loss: 0.2931367
	speed: 0.0059s/iter; left time: 9.9710s
	iters: 500, epoch: 7 | loss: 0.7550738
	speed: 0.0059s/iter; left time: 9.3740s
	iters: 600, epoch: 7 | loss: 0.2943918
	speed: 0.0058s/iter; left time: 8.6566s
	iters: 700, epoch: 7 | loss: 0.3018817
	speed: 0.0056s/iter; left time: 7.7549s
	iters: 800, epoch: 7 | loss: 0.1927111
	speed: 0.0057s/iter; left time: 7.3469s
	iters: 900, epoch: 7 | loss: 0.2265831
	speed: 0.0056s/iter; left time: 6.7271s
	iters: 1000, epoch: 7 | loss: 0.3831541
	speed: 0.0057s/iter; left time: 6.2322s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0028520410111, 'e_layers': 4, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3599511
	speed: 0.0151s/iter; left time: 30.0612s
	iters: 200, epoch: 1 | loss: 0.4241374
	speed: 0.0097s/iter; left time: 18.3324s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 2.814948797225952
Epoch: 1, Steps: 262 | Train Loss: 0.3920442 Vali Loss: 0.2786011 Best vali loss: 0.2786011
	iters: 100, epoch: 2 | loss: 0.2599248
	speed: 0.0200s/iter; left time: 34.7188s
	iters: 200, epoch: 2 | loss: 0.5675285
	speed: 0.0083s/iter; left time: 13.5061s
Updating learning rate to 5.35870624e-05
Epoch: 2 cost time: 2.3335676193237305
Epoch: 2, Steps: 262 | Train Loss: 0.4137267 Vali Loss: 0.2808917 Best vali loss: 0.2786011
	iters: 100, epoch: 3 | loss: 0.5536920
	speed: 0.0193s/iter; left time: 28.4679s
	iters: 200, epoch: 3 | loss: 0.4564309
	speed: 0.0096s/iter; left time: 13.1242s
Updating learning rate to 2.67935312e-05
Validation loss decreased (0.2786 --> 0.2747).  Saving model state dict ...
Epoch: 3 cost time: 2.5761849880218506
Epoch: 3, Steps: 262 | Train Loss: 0.5050614 Vali Loss: 0.2746760 Best vali loss: 0.2746760
	iters: 100, epoch: 4 | loss: 0.5383781
	speed: 0.0208s/iter; left time: 25.1682s
	iters: 200, epoch: 4 | loss: 0.5375238
	speed: 0.0099s/iter; left time: 11.0252s
Updating learning rate to 1.33967656e-05
Epoch: 4 cost time: 2.555107593536377
Epoch: 4, Steps: 262 | Train Loss: 0.5379510 Vali Loss: 0.2785351 Best vali loss: 0.2746760
	iters: 100, epoch: 5 | loss: 0.2596246
	speed: 0.0229s/iter; left time: 21.7071s
	iters: 200, epoch: 5 | loss: 0.3873719
	speed: 0.0158s/iter; left time: 13.4396s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 3.907078504562378
Epoch: 5, Steps: 262 | Train Loss: 0.3234983 Vali Loss: 0.2777128 Best vali loss: 0.2746760
	iters: 100, epoch: 6 | loss: 0.2060655
	speed: 0.0273s/iter; left time: 18.7414s
	iters: 200, epoch: 6 | loss: 0.3444842
	speed: 0.0085s/iter; left time: 4.9921s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 2.594163179397583
Epoch: 6, Steps: 262 | Train Loss: 0.2752748 Vali Loss: 0.2814265 Best vali loss: 0.2746760
	iters: 100, epoch: 7 | loss: 0.2653508
	speed: 0.0201s/iter; left time: 8.5419s
	iters: 200, epoch: 7 | loss: 0.4453120
	speed: 0.0097s/iter; left time: 3.1451s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 2.5824975967407227
Epoch: 7, Steps: 262 | Train Loss: 0.3553314 Vali Loss: 0.2813696 Best vali loss: 0.2746760
	iters: 100, epoch: 8 | loss: 0.3974079
	speed: 0.0193s/iter; left time: 3.1454s
	iters: 200, epoch: 8 | loss: 0.3776247
	speed: 0.0096s/iter; left time: 0.6020s
Updating learning rate to 8.3729785e-07
Epoch: 8 cost time: 2.511709213256836
Epoch: 8, Steps: 262 | Train Loss: 0.3875163 Vali Loss: 0.2808320 Best vali loss: 0.2746760

best validation loss 0.27467595328403344

[INFO][abstract_intensifier.py:595] Added config 409f87 and rejected config 4678dd as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3163844
	speed: 0.0093s/iter; left time: 37.9970s
	iters: 200, epoch: 1 | loss: 0.2935284
	speed: 0.0041s/iter; left time: 16.3881s
	iters: 300, epoch: 1 | loss: 1.0396711
	speed: 0.0041s/iter; left time: 16.1173s
	iters: 400, epoch: 1 | loss: 0.6473993
	speed: 0.0041s/iter; left time: 15.6492s
	iters: 500, epoch: 1 | loss: 0.6302880
	speed: 0.0041s/iter; left time: 15.2277s
Updating learning rate to 0.0002999627711
Validation loss decreased (inf --> 0.2825).  Saving model state dict ...
Epoch: 1 cost time: 2.409571886062622
Epoch: 1, Steps: 523 | Train Loss: 0.5854542 Vali Loss: 0.2824807 Best vali loss: 0.2824807
	iters: 100, epoch: 2 | loss: 0.3311760
	speed: 0.0091s/iter; left time: 32.3553s
	iters: 200, epoch: 2 | loss: 0.2907827
	speed: 0.0042s/iter; left time: 14.4380s
	iters: 300, epoch: 2 | loss: 0.3621981
	speed: 0.0044s/iter; left time: 14.6870s
	iters: 400, epoch: 2 | loss: 1.0316111
	speed: 0.0044s/iter; left time: 14.2093s
	iters: 500, epoch: 2 | loss: 0.7101688
	speed: 0.0044s/iter; left time: 13.8959s
Updating learning rate to 0.00014998138555
Epoch: 2 cost time: 2.2569499015808105
Epoch: 2, Steps: 523 | Train Loss: 0.5451873 Vali Loss: 0.2843783 Best vali loss: 0.2824807
	iters: 100, epoch: 3 | loss: 0.2974555
	speed: 0.0089s/iter; left time: 27.1901s
	iters: 200, epoch: 3 | loss: 0.7124223
	speed: 0.0037s/iter; left time: 10.9619s
	iters: 300, epoch: 3 | loss: 0.3465651
	speed: 0.0041s/iter; left time: 11.7532s
	iters: 400, epoch: 3 | loss: 0.3660248
	speed: 0.0042s/iter; left time: 11.5633s
	iters: 500, epoch: 3 | loss: 0.2362963
	speed: 0.0041s/iter; left time: 10.8507s
Updating learning rate to 7.4990692775e-05
Epoch: 3 cost time: 2.130195379257202
Epoch: 3, Steps: 523 | Train Loss: 0.3917528 Vali Loss: 0.2865072 Best vali loss: 0.2824807

best validation loss 0.282480743071899

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5510309
	speed: 0.0088s/iter; left time: 17.6668s
	iters: 200, epoch: 1 | loss: 0.4285284
	speed: 0.0037s/iter; left time: 7.0065s
Updating learning rate to 0.0006619683104416462
Validation loss decreased (inf --> 0.2852).  Saving model state dict ...
Epoch: 1 cost time: 1.2380907535552979
Epoch: 1, Steps: 262 | Train Loss: 0.4897797 Vali Loss: 0.2851795 Best vali loss: 0.2851795
	iters: 100, epoch: 2 | loss: 0.2619300
	speed: 0.0093s/iter; left time: 16.0764s
	iters: 200, epoch: 2 | loss: 0.3157342
	speed: 0.0038s/iter; left time: 6.2001s
Updating learning rate to 0.0005873811600929365
Validation loss decreased (0.2852 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 1.061453104019165
Epoch: 2, Steps: 262 | Train Loss: 0.2888321 Vali Loss: 0.2828813 Best vali loss: 0.2828813
	iters: 100, epoch: 3 | loss: 0.7749415
	speed: 0.0094s/iter; left time: 13.8818s
	iters: 200, epoch: 3 | loss: 0.4215963
	speed: 0.0040s/iter; left time: 5.4704s
Updating learning rate to 0.0004757536010602603
Epoch: 3 cost time: 1.1109488010406494
Epoch: 3, Steps: 262 | Train Loss: 0.5982689 Vali Loss: 0.2847902 Best vali loss: 0.2828813

best validation loss 0.28288128579159394

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006724544284
Validation loss decreased (inf --> 0.2837).  Saving model state dict ...
Epoch: 1 cost time: 1.1948249340057373
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2837355 Best vali loss: 0.2837355
Updating learning rate to 0.0003362272142
Epoch: 2 cost time: 0.9415662288665771
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2932293 Best vali loss: 0.2837355
Updating learning rate to 0.0001681136071
Epoch: 3 cost time: 0.9146790504455566
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2935511 Best vali loss: 0.2837355

best validation loss 0.283735543561496

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2866499
	speed: 0.0104s/iter; left time: 26.0542s
	iters: 200, epoch: 4 | loss: 0.2729240
	speed: 0.0044s/iter; left time: 10.6827s
	iters: 300, epoch: 4 | loss: 1.0656075
	speed: 0.0045s/iter; left time: 10.3488s
	iters: 400, epoch: 4 | loss: 0.6087532
	speed: 0.0043s/iter; left time: 9.5403s
	iters: 500, epoch: 4 | loss: 0.6816617
	speed: 0.0044s/iter; left time: 9.3351s
Updating learning rate to 3.74953463875e-05
Epoch: 4 cost time: 2.621161699295044
Epoch: 4, Steps: 523 | Train Loss: 0.5831193 Vali Loss: 0.2872474 Best vali loss: 0.2824807
	iters: 100, epoch: 5 | loss: 0.3308109
	speed: 0.0103s/iter; left time: 20.4781s
	iters: 200, epoch: 5 | loss: 0.2586294
	speed: 0.0043s/iter; left time: 8.1139s
	iters: 300, epoch: 5 | loss: 0.3486722
	speed: 0.0041s/iter; left time: 7.4189s
	iters: 400, epoch: 5 | loss: 0.8986568
	speed: 0.0036s/iter; left time: 6.0765s
	iters: 500, epoch: 5 | loss: 0.6347668
	speed: 0.0037s/iter; left time: 5.8742s
Updating learning rate to 1.874767319375e-05
Epoch: 5 cost time: 2.1468207836151123
Epoch: 5, Steps: 523 | Train Loss: 0.4943072 Vali Loss: 0.2873012 Best vali loss: 0.2824807
	iters: 100, epoch: 6 | loss: 0.2837047
	speed: 0.0095s/iter; left time: 13.9108s
	iters: 200, epoch: 6 | loss: 0.6801916
	speed: 0.0043s/iter; left time: 5.9095s
	iters: 300, epoch: 6 | loss: 0.3123900
	speed: 0.0042s/iter; left time: 5.3890s
	iters: 400, epoch: 6 | loss: 0.3554769
	speed: 0.0043s/iter; left time: 5.0198s
	iters: 500, epoch: 6 | loss: 0.2422624
	speed: 0.0043s/iter; left time: 4.6216s
Updating learning rate to 9.373836596875e-06
Epoch: 6 cost time: 2.3014941215515137
Epoch: 6, Steps: 523 | Train Loss: 0.3748051 Vali Loss: 0.2871825 Best vali loss: 0.2824807
	iters: 100, epoch: 7 | loss: 0.2306898
	speed: 0.0101s/iter; left time: 9.5353s
	iters: 200, epoch: 7 | loss: 0.7717678
	speed: 0.0042s/iter; left time: 3.5973s
	iters: 300, epoch: 7 | loss: 0.2697254
	speed: 0.0042s/iter; left time: 3.1704s
	iters: 400, epoch: 7 | loss: 0.2475707
	speed: 0.0043s/iter; left time: 2.7701s
	iters: 500, epoch: 7 | loss: 0.9323989
	speed: 0.0039s/iter; left time: 2.1366s
Updating learning rate to 4.6869182984375e-06
Epoch: 7 cost time: 2.244206428527832
Epoch: 7, Steps: 523 | Train Loss: 0.4904305 Vali Loss: 0.2870589 Best vali loss: 0.2824807
	iters: 100, epoch: 8 | loss: 0.5821092
	speed: 0.0091s/iter; left time: 3.8794s
	iters: 200, epoch: 8 | loss: 0.2910891
	speed: 0.0041s/iter; left time: 1.3266s
	iters: 300, epoch: 8 | loss: 0.4851057
	speed: 0.0041s/iter; left time: 0.9173s
	iters: 400, epoch: 8 | loss: 1.2923167
	speed: 0.0041s/iter; left time: 0.5113s
	iters: 500, epoch: 8 | loss: 0.2416554
	speed: 0.0040s/iter; left time: 0.0966s
Updating learning rate to 2.34345914921875e-06
Epoch: 8 cost time: 2.174722194671631
Epoch: 8, Steps: 523 | Train Loss: 0.5784552 Vali Loss: 0.2871584 Best vali loss: 0.2824807

best validation loss 0.282480743071899

[INFO][smbo.py:320] Finished 100 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014600474372, 'e_layers': 3, 'learning_rate': 0.0001170962273, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6850828
	speed: 0.0111s/iter; left time: 91.6412s
	iters: 200, epoch: 1 | loss: 0.7761726
	speed: 0.0053s/iter; left time: 42.8716s
	iters: 300, epoch: 1 | loss: 0.4737367
	speed: 0.0053s/iter; left time: 42.3725s
	iters: 400, epoch: 1 | loss: 0.4836677
	speed: 0.0047s/iter; left time: 37.2693s
	iters: 500, epoch: 1 | loss: 0.2347744
	speed: 0.0049s/iter; left time: 38.3067s
	iters: 600, epoch: 1 | loss: 0.4705018
	speed: 0.0051s/iter; left time: 39.2273s
	iters: 700, epoch: 1 | loss: 0.7418403
	speed: 0.0053s/iter; left time: 40.8343s
	iters: 800, epoch: 1 | loss: 0.7980109
	speed: 0.0052s/iter; left time: 39.2260s
	iters: 900, epoch: 1 | loss: 0.4668117
	speed: 0.0053s/iter; left time: 39.7545s
	iters: 1000, epoch: 1 | loss: 0.3876989
	speed: 0.0053s/iter; left time: 38.8770s
Updating learning rate to 0.0001170962273
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 5.708937644958496
Epoch: 1, Steps: 1045 | Train Loss: 0.5518298 Vali Loss: 0.2841869 Best vali loss: 0.2841869
	iters: 100, epoch: 2 | loss: 1.3371079
	speed: 0.0175s/iter; left time: 126.3029s
	iters: 200, epoch: 2 | loss: 1.3954629
	speed: 0.0055s/iter; left time: 38.9314s
	iters: 300, epoch: 2 | loss: 0.3246965
	speed: 0.0054s/iter; left time: 37.6114s
	iters: 400, epoch: 2 | loss: 0.1993638
	speed: 0.0049s/iter; left time: 33.5650s
	iters: 500, epoch: 2 | loss: 0.6407455
	speed: 0.0049s/iter; left time: 33.6122s
	iters: 600, epoch: 2 | loss: 0.3186742
	speed: 0.0050s/iter; left time: 33.4817s
	iters: 700, epoch: 2 | loss: 1.8413682
	speed: 0.0052s/iter; left time: 34.5139s
	iters: 800, epoch: 2 | loss: 0.3659390
	speed: 0.0052s/iter; left time: 33.8443s
	iters: 900, epoch: 2 | loss: 0.9737491
	speed: 0.0051s/iter; left time: 33.0256s
	iters: 1000, epoch: 2 | loss: 0.1983394
	speed: 0.0054s/iter; left time: 33.9347s
Updating learning rate to 5.854811365e-05
Epoch: 2 cost time: 5.504333734512329
Epoch: 2, Steps: 1045 | Train Loss: 0.7595447 Vali Loss: 0.2869392 Best vali loss: 0.2841869
	iters: 100, epoch: 3 | loss: 0.3235181
	speed: 0.0173s/iter; left time: 106.8331s
	iters: 200, epoch: 3 | loss: 0.5158042
	speed: 0.0053s/iter; left time: 32.2378s
	iters: 300, epoch: 3 | loss: 0.5263327
	speed: 0.0053s/iter; left time: 31.4361s
	iters: 400, epoch: 3 | loss: 0.2244399
	speed: 0.0051s/iter; left time: 30.2298s
	iters: 500, epoch: 3 | loss: 0.2530846
	speed: 0.0053s/iter; left time: 30.4154s
	iters: 600, epoch: 3 | loss: 0.7895761
	speed: 0.0054s/iter; left time: 30.5705s
	iters: 700, epoch: 3 | loss: 0.3827564
	speed: 0.0056s/iter; left time: 31.0820s
	iters: 800, epoch: 3 | loss: 0.2547444
	speed: 0.0056s/iter; left time: 30.5542s
	iters: 900, epoch: 3 | loss: 0.2719837
	speed: 0.0056s/iter; left time: 30.1505s
	iters: 1000, epoch: 3 | loss: 0.8497402
	speed: 0.0056s/iter; left time: 29.4805s
Updating learning rate to 2.9274056825e-05
Validation loss decreased (0.2842 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 5.722321510314941
Epoch: 3, Steps: 1045 | Train Loss: 0.4391980 Vali Loss: 0.2835661 Best vali loss: 0.2835661
	iters: 100, epoch: 4 | loss: 0.7019695
	speed: 0.0174s/iter; left time: 89.0776s
	iters: 200, epoch: 4 | loss: 0.3070444
	speed: 0.0054s/iter; left time: 26.9907s
	iters: 300, epoch: 4 | loss: 0.2115144
	speed: 0.0053s/iter; left time: 26.3346s
	iters: 400, epoch: 4 | loss: 0.3104973
	speed: 0.0051s/iter; left time: 24.6070s
	iters: 500, epoch: 4 | loss: 0.6955999
	speed: 0.0050s/iter; left time: 23.5637s
	iters: 600, epoch: 4 | loss: 0.5142184
	speed: 0.0053s/iter; left time: 24.6430s
	iters: 700, epoch: 4 | loss: 0.2519153
	speed: 0.0053s/iter; left time: 24.0160s
	iters: 800, epoch: 4 | loss: 0.3132548
	speed: 0.0053s/iter; left time: 23.6687s
	iters: 900, epoch: 4 | loss: 0.2725679
	speed: 0.0053s/iter; left time: 23.0960s
	iters: 1000, epoch: 4 | loss: 1.3909489
	speed: 0.0053s/iter; left time: 22.4154s
Updating learning rate to 1.46370284125e-05
Epoch: 4 cost time: 5.5826544761657715
Epoch: 4, Steps: 1045 | Train Loss: 0.4969531 Vali Loss: 0.2838508 Best vali loss: 0.2835661
	iters: 100, epoch: 5 | loss: 0.2857327
	speed: 0.0171s/iter; left time: 69.7882s
	iters: 200, epoch: 5 | loss: 0.2977520
	speed: 0.0052s/iter; left time: 20.8140s
	iters: 300, epoch: 5 | loss: 0.6191291
	speed: 0.0053s/iter; left time: 20.6004s
	iters: 400, epoch: 5 | loss: 0.2688443
	speed: 0.0046s/iter; left time: 17.4644s
	iters: 500, epoch: 5 | loss: 0.4685257
	speed: 0.0047s/iter; left time: 17.1416s
	iters: 600, epoch: 5 | loss: 0.3898518
	speed: 0.0038s/iter; left time: 13.4974s
	iters: 700, epoch: 5 | loss: 0.5069381
	speed: 0.0038s/iter; left time: 13.2842s
	iters: 800, epoch: 5 | loss: 0.3188605
	speed: 0.0084s/iter; left time: 28.2852s
	iters: 900, epoch: 5 | loss: 0.6181863
	speed: 0.0093s/iter; left time: 30.5641s
	iters: 1000, epoch: 5 | loss: 0.3582188
	speed: 0.0084s/iter; left time: 26.8765s
Updating learning rate to 7.31851420625e-06
Epoch: 5 cost time: 6.244760751724243
Epoch: 5, Steps: 1045 | Train Loss: 0.4132039 Vali Loss: 0.2847262 Best vali loss: 0.2835661
	iters: 100, epoch: 6 | loss: 0.4001261
	speed: 0.0303s/iter; left time: 92.1310s
	iters: 200, epoch: 6 | loss: 0.1890776
	speed: 0.0077s/iter; left time: 22.6005s
	iters: 300, epoch: 6 | loss: 0.3346129
	speed: 0.0093s/iter; left time: 26.3732s
	iters: 400, epoch: 6 | loss: 1.4795939
	speed: 0.0090s/iter; left time: 24.7019s
	iters: 500, epoch: 6 | loss: 0.2562520
	speed: 0.0067s/iter; left time: 17.5613s
	iters: 600, epoch: 6 | loss: 0.7864848
	speed: 0.0093s/iter; left time: 23.5670s
	iters: 700, epoch: 6 | loss: 0.3585223
	speed: 0.0093s/iter; left time: 22.6324s
	iters: 800, epoch: 6 | loss: 0.3534032
	speed: 0.0073s/iter; left time: 16.9668s
	iters: 900, epoch: 6 | loss: 1.9065020
	speed: 0.0085s/iter; left time: 18.9852s
	iters: 1000, epoch: 6 | loss: 0.5531200
	speed: 0.0093s/iter; left time: 19.8560s
Updating learning rate to 3.659257103125e-06
Epoch: 6 cost time: 8.8459312915802
Epoch: 6, Steps: 1045 | Train Loss: 0.6617695 Vali Loss: 0.2846700 Best vali loss: 0.2835661
	iters: 100, epoch: 7 | loss: 0.5341186
	speed: 0.0307s/iter; left time: 61.0684s
	iters: 200, epoch: 7 | loss: 0.3290015
	speed: 0.0075s/iter; left time: 14.1296s
	iters: 300, epoch: 7 | loss: 0.4333697
	speed: 0.0084s/iter; left time: 15.0047s
	iters: 400, epoch: 7 | loss: 0.3991627
	speed: 0.0093s/iter; left time: 15.7338s
	iters: 500, epoch: 7 | loss: 0.1566040
	speed: 0.0084s/iter; left time: 13.4429s
	iters: 600, epoch: 7 | loss: 0.5305624
	speed: 0.0073s/iter; left time: 10.9113s
	iters: 700, epoch: 7 | loss: 0.9622497
	speed: 0.0093s/iter; left time: 12.9279s
	iters: 800, epoch: 7 | loss: 0.5923022
	speed: 0.0093s/iter; left time: 12.0385s
	iters: 900, epoch: 7 | loss: 0.4202588
	speed: 0.0066s/iter; left time: 7.8407s
	iters: 1000, epoch: 7 | loss: 0.3534153
	speed: 0.0037s/iter; left time: 3.9857s
Updating learning rate to 1.8296285515625e-06
Epoch: 7 cost time: 8.135903596878052
Epoch: 7, Steps: 1045 | Train Loss: 0.4711045 Vali Loss: 0.2845815 Best vali loss: 0.2835661
	iters: 100, epoch: 8 | loss: 1.3950752
	speed: 0.0152s/iter; left time: 14.4121s
	iters: 200, epoch: 8 | loss: 0.2490104
	speed: 0.0052s/iter; left time: 4.3572s
	iters: 300, epoch: 8 | loss: 0.2884066
	speed: 0.0054s/iter; left time: 4.0330s
	iters: 400, epoch: 8 | loss: 0.8396574
	speed: 0.0053s/iter; left time: 3.4356s
	iters: 500, epoch: 8 | loss: 0.2290189
	speed: 0.0054s/iter; left time: 2.9489s
	iters: 600, epoch: 8 | loss: 0.9395724
	speed: 0.0053s/iter; left time: 2.3494s
	iters: 700, epoch: 8 | loss: 0.6120420
	speed: 0.0053s/iter; left time: 1.8469s
	iters: 800, epoch: 8 | loss: 0.6360536
	speed: 0.0053s/iter; left time: 1.3085s
	iters: 900, epoch: 8 | loss: 0.5199356
	speed: 0.0054s/iter; left time: 0.7946s
	iters: 1000, epoch: 8 | loss: 0.2008465
	speed: 0.0054s/iter; left time: 0.2476s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008001774243, 'e_layers': 4, 'learning_rate': 8.14780285e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7518919
	speed: 0.0154s/iter; left time: 30.7702s
	iters: 200, epoch: 1 | loss: 0.4120902
	speed: 0.0095s/iter; left time: 18.0670s
Updating learning rate to 8.14780285e-05
Validation loss decreased (inf --> 0.2778).  Saving model state dict ...
Epoch: 1 cost time: 2.830770969390869
Epoch: 1, Steps: 262 | Train Loss: 0.5819910 Vali Loss: 0.2778358 Best vali loss: 0.2778358
	iters: 100, epoch: 2 | loss: 0.5006580
	speed: 0.0205s/iter; left time: 35.4990s
	iters: 200, epoch: 2 | loss: 0.5219786
	speed: 0.0095s/iter; left time: 15.5515s
Updating learning rate to 4.073901425e-05
Epoch: 2 cost time: 2.5604395866394043
Epoch: 2, Steps: 262 | Train Loss: 0.5113183 Vali Loss: 0.2889480 Best vali loss: 0.2778358
	iters: 100, epoch: 3 | loss: 0.7946247
	speed: 0.0199s/iter; left time: 29.2918s
	iters: 200, epoch: 3 | loss: 0.4666939
	speed: 0.0094s/iter; left time: 12.9431s
Updating learning rate to 2.0369507125e-05
Epoch: 3 cost time: 2.545454740524292
Epoch: 3, Steps: 262 | Train Loss: 0.6306593 Vali Loss: 0.2862970 Best vali loss: 0.2778358
	iters: 100, epoch: 4 | loss: 0.2977830
	speed: 0.0192s/iter; left time: 23.2825s
	iters: 200, epoch: 4 | loss: 0.4122534
	speed: 0.0088s/iter; left time: 9.7729s
Updating learning rate to 1.01847535625e-05
Epoch: 4 cost time: 2.3614723682403564
Epoch: 4, Steps: 262 | Train Loss: 0.3550182 Vali Loss: 0.2943957 Best vali loss: 0.2778358
	iters: 100, epoch: 5 | loss: 0.4396711
	speed: 0.0196s/iter; left time: 18.5982s
	iters: 200, epoch: 5 | loss: 0.4697715
	speed: 0.0095s/iter; left time: 8.1060s
Updating learning rate to 5.09237678125e-06
Epoch: 5 cost time: 2.593867778778076
Epoch: 5, Steps: 262 | Train Loss: 0.4547213 Vali Loss: 0.3048797 Best vali loss: 0.2778358
	iters: 100, epoch: 6 | loss: 0.5232760
	speed: 0.0202s/iter; left time: 13.8555s
	iters: 200, epoch: 6 | loss: 0.3680574
	speed: 0.0096s/iter; left time: 5.6357s
Updating learning rate to 2.546188390625e-06
Epoch: 6 cost time: 2.5855231285095215
Epoch: 6, Steps: 262 | Train Loss: 0.4456667 Vali Loss: 0.2977229 Best vali loss: 0.2778358
	iters: 100, epoch: 7 | loss: 0.4447731
	speed: 0.0201s/iter; left time: 8.5587s
	iters: 200, epoch: 7 | loss: 0.4395992
	speed: 0.0096s/iter; left time: 3.1201s
Updating learning rate to 1.2730941953125e-06
Epoch: 7 cost time: 2.587331533432007
Epoch: 7, Steps: 262 | Train Loss: 0.4421861 Vali Loss: 0.2983321 Best vali loss: 0.2778358
	iters: 100, epoch: 8 | loss: 0.2752408
	speed: 0.0192s/iter; left time: 3.1216s
	iters: 200, epoch: 8 | loss: 0.3186066
	speed: 0.0088s/iter; left time: 0.5573s
Updating learning rate to 6.3654709765625e-07
Epoch: 8 cost time: 2.3272597789764404
Epoch: 8, Steps: 262 | Train Loss: 0.2969237 Vali Loss: 0.2997369 Best vali loss: 0.2778358

best validation loss 0.27783576704980095

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0042555642414, 'e_layers': 4, 'learning_rate': 0.0033451766027, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7449472
	speed: 0.0122s/iter; left time: 100.7047s
	iters: 200, epoch: 1 | loss: 1.5295891
	speed: 0.0061s/iter; left time: 50.1549s
	iters: 300, epoch: 1 | loss: 0.5028560
	speed: 0.0065s/iter; left time: 52.2489s
	iters: 400, epoch: 1 | loss: 0.9047253
	speed: 0.0046s/iter; left time: 36.7783s
	iters: 500, epoch: 1 | loss: 0.2789063
	speed: 0.0052s/iter; left time: 40.5167s
	iters: 600, epoch: 1 | loss: 0.4890511
	speed: 0.0068s/iter; left time: 52.5822s
	iters: 700, epoch: 1 | loss: 0.3064982
	speed: 0.0067s/iter; left time: 51.3775s
	iters: 800, epoch: 1 | loss: 0.4714992
	speed: 0.0067s/iter; left time: 50.7087s
	iters: 900, epoch: 1 | loss: 0.5444573
	speed: 0.0068s/iter; left time: 50.4032s
	iters: 1000, epoch: 1 | loss: 0.3358924
	speed: 0.0066s/iter; left time: 48.2989s
Updating learning rate to 0.0032178583992850856
Validation loss decreased (inf --> 0.2984).  Saving model state dict ...
Epoch: 1 cost time: 6.808045148849487
Epoch: 1, Steps: 1045 | Train Loss: 0.6108422 Vali Loss: 0.2983605 Best vali loss: 0.2983605
	iters: 100, epoch: 2 | loss: 0.6962050
	speed: 0.0194s/iter; left time: 140.0158s
	iters: 200, epoch: 2 | loss: 0.5485065
	speed: 0.0070s/iter; left time: 49.7575s
	iters: 300, epoch: 2 | loss: 0.2664203
	speed: 0.0069s/iter; left time: 48.4055s
	iters: 400, epoch: 2 | loss: 0.1195807
	speed: 0.0064s/iter; left time: 44.4242s
	iters: 500, epoch: 2 | loss: 0.4168538
	speed: 0.0058s/iter; left time: 39.6209s
	iters: 600, epoch: 2 | loss: 0.2695056
	speed: 0.0063s/iter; left time: 42.6193s
	iters: 700, epoch: 2 | loss: 0.2051124
	speed: 0.0069s/iter; left time: 45.4472s
	iters: 800, epoch: 2 | loss: 0.5354947
	speed: 0.0068s/iter; left time: 44.1877s
	iters: 900, epoch: 2 | loss: 0.2317867
	speed: 0.0070s/iter; left time: 44.6881s
	iters: 1000, epoch: 2 | loss: 0.5149128
	speed: 0.0066s/iter; left time: 41.8130s
Updating learning rate to 0.0028552868313678737
Validation loss decreased (0.2984 --> 0.2979).  Saving model state dict ...
Epoch: 2 cost time: 6.981241703033447
Epoch: 2, Steps: 1045 | Train Loss: 0.3804379 Vali Loss: 0.2978635 Best vali loss: 0.2978635
	iters: 100, epoch: 3 | loss: 0.2855724
	speed: 0.0152s/iter; left time: 93.7996s
	iters: 200, epoch: 3 | loss: 0.6632040
	speed: 0.0066s/iter; left time: 39.9329s
	iters: 300, epoch: 3 | loss: 0.3389643
	speed: 0.0066s/iter; left time: 39.5293s
	iters: 400, epoch: 3 | loss: 0.2865186
	speed: 0.0067s/iter; left time: 39.1712s
	iters: 500, epoch: 3 | loss: 0.1727473
	speed: 0.0067s/iter; left time: 38.6153s
	iters: 600, epoch: 3 | loss: 0.5018863
	speed: 0.0064s/iter; left time: 36.3459s
	iters: 700, epoch: 3 | loss: 0.2444187
	speed: 0.0057s/iter; left time: 32.0159s
	iters: 800, epoch: 3 | loss: 0.3755827
	speed: 0.0060s/iter; left time: 32.6717s
	iters: 900, epoch: 3 | loss: 0.2036212
	speed: 0.0066s/iter; left time: 35.6593s
	iters: 1000, epoch: 3 | loss: 0.2392573
	speed: 0.0067s/iter; left time: 35.1085s
Updating learning rate to 0.0023126601334443136
Validation loss decreased (0.2979 --> 0.2909).  Saving model state dict ...
Epoch: 3 cost time: 6.604946613311768
Epoch: 3, Steps: 1045 | Train Loss: 0.3311773 Vali Loss: 0.2909072 Best vali loss: 0.2909072

best validation loss 0.290907240126735

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023938699804, 'e_layers': 1, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5238287
	speed: 0.0089s/iter; left time: 17.6998s
	iters: 200, epoch: 1 | loss: 0.5016221
	speed: 0.0034s/iter; left time: 6.3722s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.2927).  Saving model state dict ...
Epoch: 1 cost time: 1.1812705993652344
Epoch: 1, Steps: 262 | Train Loss: 0.5127254 Vali Loss: 0.2926698 Best vali loss: 0.2926698
	iters: 100, epoch: 2 | loss: 0.4060927
	speed: 0.0085s/iter; left time: 14.7060s
	iters: 200, epoch: 2 | loss: 0.3461089
	speed: 0.0035s/iter; left time: 5.6487s
Updating learning rate to 0.0014281993853242025
Epoch: 2 cost time: 0.9508204460144043
Epoch: 2, Steps: 262 | Train Loss: 0.3761008 Vali Loss: 0.2989910 Best vali loss: 0.2926698
	iters: 100, epoch: 3 | loss: 0.5643033
	speed: 0.0083s/iter; left time: 12.2416s
	iters: 200, epoch: 3 | loss: 0.5975348
	speed: 0.0034s/iter; left time: 4.6356s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 0.9306197166442871
Epoch: 3, Steps: 262 | Train Loss: 0.5809191 Vali Loss: 0.3164598 Best vali loss: 0.2926698

best validation loss 0.2926697759723167

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5526433
	speed: 0.0094s/iter; left time: 78.0469s
	iters: 200, epoch: 1 | loss: 0.3242701
	speed: 0.0037s/iter; left time: 30.4629s
	iters: 300, epoch: 1 | loss: 0.7173219
	speed: 0.0038s/iter; left time: 30.5739s
	iters: 400, epoch: 1 | loss: 0.2743785
	speed: 0.0038s/iter; left time: 30.0915s
	iters: 500, epoch: 1 | loss: 0.2144217
	speed: 0.0038s/iter; left time: 29.6319s
	iters: 600, epoch: 1 | loss: 0.2736471
	speed: 0.0038s/iter; left time: 29.2265s
	iters: 700, epoch: 1 | loss: 0.2596611
	speed: 0.0034s/iter; left time: 25.9443s
	iters: 800, epoch: 1 | loss: 0.3481595
	speed: 0.0037s/iter; left time: 28.3062s
	iters: 900, epoch: 1 | loss: 0.3696861
	speed: 0.0030s/iter; left time: 22.2204s
	iters: 1000, epoch: 1 | loss: 0.3218402
	speed: 0.0026s/iter; left time: 19.3797s
Updating learning rate to 0.0002485111429
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 3.9537887573242188
Epoch: 1, Steps: 1045 | Train Loss: 0.3656030 Vali Loss: 0.2812486 Best vali loss: 0.2812486
	iters: 100, epoch: 2 | loss: 0.4733663
	speed: 0.0129s/iter; left time: 93.4323s
	iters: 200, epoch: 2 | loss: 0.2025662
	speed: 0.0037s/iter; left time: 26.6516s
	iters: 300, epoch: 2 | loss: 0.5354497
	speed: 0.0037s/iter; left time: 26.0101s
	iters: 400, epoch: 2 | loss: 0.4007703
	speed: 0.0038s/iter; left time: 26.2491s
	iters: 500, epoch: 2 | loss: 0.2589484
	speed: 0.0037s/iter; left time: 25.2667s
	iters: 600, epoch: 2 | loss: 0.3440189
	speed: 0.0038s/iter; left time: 25.5384s
	iters: 700, epoch: 2 | loss: 0.1582497
	speed: 0.0038s/iter; left time: 25.2075s
	iters: 800, epoch: 2 | loss: 0.3785646
	speed: 0.0036s/iter; left time: 23.5329s
	iters: 900, epoch: 2 | loss: 0.5147941
	speed: 0.0032s/iter; left time: 20.6809s
	iters: 1000, epoch: 2 | loss: 0.3901884
	speed: 0.0026s/iter; left time: 16.3558s
Updating learning rate to 0.00012425557145
Epoch: 2 cost time: 3.7280406951904297
Epoch: 2, Steps: 1045 | Train Loss: 0.3656917 Vali Loss: 0.2913642 Best vali loss: 0.2812486
	iters: 100, epoch: 3 | loss: 0.4461822
	speed: 0.0085s/iter; left time: 52.6019s
	iters: 200, epoch: 3 | loss: 0.2522370
	speed: 0.0025s/iter; left time: 14.9720s
	iters: 300, epoch: 3 | loss: 0.2586259
	speed: 0.0042s/iter; left time: 25.0816s
	iters: 400, epoch: 3 | loss: 0.2902486
	speed: 0.0061s/iter; left time: 35.6614s
	iters: 500, epoch: 3 | loss: 0.9942562
	speed: 0.0037s/iter; left time: 21.1828s
	iters: 600, epoch: 3 | loss: 0.1366129
	speed: 0.0065s/iter; left time: 36.6310s
	iters: 700, epoch: 3 | loss: 0.3385690
	speed: 0.0034s/iter; left time: 18.8684s
	iters: 800, epoch: 3 | loss: 0.3904034
	speed: 0.0060s/iter; left time: 33.0475s
	iters: 900, epoch: 3 | loss: 0.4752820
	speed: 0.0045s/iter; left time: 24.0432s
	iters: 1000, epoch: 3 | loss: 0.5279776
	speed: 0.0047s/iter; left time: 24.7245s
Updating learning rate to 6.2127785725e-05
Epoch: 3 cost time: 4.716299057006836
Epoch: 3, Steps: 1045 | Train Loss: 0.4110395 Vali Loss: 0.2983128 Best vali loss: 0.2812486

best validation loss 0.2812485851655001

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3779100
	speed: 0.0126s/iter; left time: 64.8059s
	iters: 200, epoch: 4 | loss: 0.2604761
	speed: 0.0043s/iter; left time: 21.8404s
	iters: 300, epoch: 4 | loss: 0.6308694
	speed: 0.0058s/iter; left time: 28.3253s
	iters: 400, epoch: 4 | loss: 0.2105141
	speed: 0.0047s/iter; left time: 22.8777s
	iters: 500, epoch: 4 | loss: 0.1920858
	speed: 0.0025s/iter; left time: 11.8612s
	iters: 600, epoch: 4 | loss: 0.2886353
	speed: 0.0025s/iter; left time: 11.5400s
	iters: 700, epoch: 4 | loss: 0.2510408
	speed: 0.0024s/iter; left time: 11.0622s
	iters: 800, epoch: 4 | loss: 0.3432791
	speed: 0.0029s/iter; left time: 12.6418s
	iters: 900, epoch: 4 | loss: 0.3182456
	speed: 0.0037s/iter; left time: 16.1145s
	iters: 1000, epoch: 4 | loss: 0.2738572
	speed: 0.0025s/iter; left time: 10.4867s
Updating learning rate to 3.10638928625e-05
Epoch: 4 cost time: 4.2591776847839355
Epoch: 4, Steps: 1045 | Train Loss: 0.3146913 Vali Loss: 0.3040135 Best vali loss: 0.2812486
	iters: 100, epoch: 5 | loss: 0.3725190
	speed: 0.0137s/iter; left time: 55.7449s
	iters: 200, epoch: 5 | loss: 0.1840946
	speed: 0.0036s/iter; left time: 14.4356s
	iters: 300, epoch: 5 | loss: 0.3167195
	speed: 0.0028s/iter; left time: 10.7496s
	iters: 400, epoch: 5 | loss: 0.2865196
	speed: 0.0037s/iter; left time: 13.9392s
	iters: 500, epoch: 5 | loss: 0.1915390
	speed: 0.0029s/iter; left time: 10.5993s
	iters: 600, epoch: 5 | loss: 0.3157845
	speed: 0.0036s/iter; left time: 12.8123s
	iters: 700, epoch: 5 | loss: 0.1422502
	speed: 0.0026s/iter; left time: 9.0601s
	iters: 800, epoch: 5 | loss: 0.3867940
	speed: 0.0039s/iter; left time: 13.0553s
	iters: 900, epoch: 5 | loss: 0.2855714
	speed: 0.0028s/iter; left time: 9.0749s
	iters: 1000, epoch: 5 | loss: 0.2775692
	speed: 0.0038s/iter; left time: 12.0842s
Updating learning rate to 1.553194643125e-05
Epoch: 5 cost time: 3.4066579341888428
Epoch: 5, Steps: 1045 | Train Loss: 0.2759361 Vali Loss: 0.3001733 Best vali loss: 0.2812486
	iters: 100, epoch: 6 | loss: 0.4069255
	speed: 0.0084s/iter; left time: 25.4912s
	iters: 200, epoch: 6 | loss: 0.2544116
	speed: 0.0029s/iter; left time: 8.4566s
	iters: 300, epoch: 6 | loss: 0.1834377
	speed: 0.0034s/iter; left time: 9.6669s
	iters: 400, epoch: 6 | loss: 0.2726646
	speed: 0.0034s/iter; left time: 9.2711s
	iters: 500, epoch: 6 | loss: 0.6330619
	speed: 0.0034s/iter; left time: 8.8541s
	iters: 600, epoch: 6 | loss: 0.1271902
	speed: 0.0033s/iter; left time: 8.4251s
	iters: 700, epoch: 6 | loss: 0.3180595
	speed: 0.0034s/iter; left time: 8.1621s
	iters: 800, epoch: 6 | loss: 0.2962448
	speed: 0.0033s/iter; left time: 7.8245s
	iters: 900, epoch: 6 | loss: 0.4395719
	speed: 0.0033s/iter; left time: 7.4480s
	iters: 1000, epoch: 6 | loss: 0.4059103
	speed: 0.0034s/iter; left time: 7.1730s
Updating learning rate to 7.765973215625e-06
Epoch: 6 cost time: 3.3947532176971436
Epoch: 6, Steps: 1045 | Train Loss: 0.3337478 Vali Loss: 0.3040984 Best vali loss: 0.2812486
	iters: 100, epoch: 7 | loss: 0.4768782
	speed: 0.0116s/iter; left time: 22.9982s
	iters: 200, epoch: 7 | loss: 0.3925562
	speed: 0.0030s/iter; left time: 5.6927s
	iters: 300, epoch: 7 | loss: 0.4315043
	speed: 0.0032s/iter; left time: 5.6476s
	iters: 400, epoch: 7 | loss: 0.3089429
	speed: 0.0032s/iter; left time: 5.4172s
	iters: 500, epoch: 7 | loss: 0.4078166
	speed: 0.0033s/iter; left time: 5.3031s
	iters: 600, epoch: 7 | loss: 0.2697749
	speed: 0.0033s/iter; left time: 4.9520s
	iters: 700, epoch: 7 | loss: 0.2743538
	speed: 0.0033s/iter; left time: 4.5756s
	iters: 800, epoch: 7 | loss: 0.8286360
	speed: 0.0033s/iter; left time: 4.2724s
	iters: 900, epoch: 7 | loss: 0.2932391
	speed: 0.0033s/iter; left time: 3.9535s
	iters: 1000, epoch: 7 | loss: 0.5251082
	speed: 0.0033s/iter; left time: 3.6273s
Updating learning rate to 3.8829866078125e-06
Epoch: 7 cost time: 3.407421112060547
Epoch: 7, Steps: 1045 | Train Loss: 0.4208810 Vali Loss: 0.3071298 Best vali loss: 0.2812486
	iters: 100, epoch: 8 | loss: 0.3538539
	speed: 0.0116s/iter; left time: 10.9970s
	iters: 200, epoch: 8 | loss: 0.2866681
	speed: 0.0035s/iter; left time: 2.9551s
	iters: 300, epoch: 8 | loss: 0.5575994
	speed: 0.0035s/iter; left time: 2.6253s
	iters: 400, epoch: 8 | loss: 0.3484362
	speed: 0.0033s/iter; left time: 2.1027s
	iters: 500, epoch: 8 | loss: 0.1972264
	speed: 0.0033s/iter; left time: 1.8010s
	iters: 600, epoch: 8 | loss: 0.4180933
	speed: 0.0033s/iter; left time: 1.4657s
	iters: 700, epoch: 8 | loss: 0.1767617
	speed: 0.0033s/iter; left time: 1.1341s
	iters: 800, epoch: 8 | loss: 0.2810000
	speed: 0.0033s/iter; left time: 0.8125s
	iters: 900, epoch: 8 | loss: 0.2449319
	speed: 0.0033s/iter; left time: 0.4790s
	iters: 1000, epoch: 8 | loss: 0.5501878
	speed: 0.0033s/iter; left time: 0.1515s
Updating learning rate to 1.94149330390625e-06
Epoch: 8 cost time: 3.4748435020446777
Epoch: 8, Steps: 1045 | Train Loss: 0.3414759 Vali Loss: 0.3069844 Best vali loss: 0.2812486

best validation loss 0.2812485851655001

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010455579744, 'e_layers': 2, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6895390
	speed: 0.0118s/iter; left time: 11.1584s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.3178).  Saving model state dict ...
Epoch: 1 cost time: 1.09810471534729
Epoch: 1, Steps: 131 | Train Loss: 0.6895390 Vali Loss: 0.3177605 Best vali loss: 0.3177605
	iters: 100, epoch: 2 | loss: 0.4182611
	speed: 0.0107s/iter; left time: 8.7260s
Updating learning rate to 0.0026738530511141692
Validation loss decreased (0.3178 --> 0.3092).  Saving model state dict ...
Epoch: 2 cost time: 0.8608975410461426
Epoch: 2, Steps: 131 | Train Loss: 0.4182611 Vali Loss: 0.3092369 Best vali loss: 0.3092369
	iters: 100, epoch: 3 | loss: 0.5982056
	speed: 0.0109s/iter; left time: 7.5072s
Updating learning rate to 0.002165706536403478
Validation loss decreased (0.3092 --> 0.3066).  Saving model state dict ...
Epoch: 3 cost time: 0.8658168315887451
Epoch: 3, Steps: 131 | Train Loss: 0.5982056 Vali Loss: 0.3065596 Best vali loss: 0.3065596
	iters: 100, epoch: 4 | loss: 0.4690255
	speed: 0.0109s/iter; left time: 6.0390s
Updating learning rate to 0.00156630685355
Validation loss decreased (0.3066 --> 0.3049).  Saving model state dict ...
Epoch: 4 cost time: 0.861154317855835
Epoch: 4, Steps: 131 | Train Loss: 0.4690255 Vali Loss: 0.3048506 Best vali loss: 0.3048506
	iters: 100, epoch: 5 | loss: 0.4509936
	speed: 0.0107s/iter; left time: 4.5457s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 0.8452599048614502
Epoch: 5, Steps: 131 | Train Loss: 0.4509936 Vali Loss: 0.3232615 Best vali loss: 0.3048506
	iters: 100, epoch: 6 | loss: 0.3777263
	speed: 0.0101s/iter; left time: 2.9609s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 0.805872917175293
Epoch: 6, Steps: 131 | Train Loss: 0.3777263 Vali Loss: 0.3345021 Best vali loss: 0.3048506
	iters: 100, epoch: 7 | loss: 0.3916743
	speed: 0.0098s/iter; left time: 1.5913s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 0.8039929866790771
Epoch: 7, Steps: 131 | Train Loss: 0.3916743 Vali Loss: 0.3446973 Best vali loss: 0.3048506
	iters: 100, epoch: 8 | loss: 0.5421095
	speed: 0.0102s/iter; left time: 0.3268s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8509705066680908
Epoch: 8, Steps: 131 | Train Loss: 0.5421095 Vali Loss: 0.3500532 Best vali loss: 0.3048506

best validation loss 0.3048505516533694

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014539170207, 'e_layers': 1, 'learning_rate': 0.0026890067218, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5842882
	speed: 0.0090s/iter; left time: 8.5523s
Updating learning rate to 0.0025866624974281455
Validation loss decreased (inf --> 0.2971).  Saving model state dict ...
Epoch: 1 cost time: 0.7335391044616699
Epoch: 1, Steps: 131 | Train Loss: 0.5842882 Vali Loss: 0.2971261 Best vali loss: 0.2971261
	iters: 100, epoch: 2 | loss: 0.4214816
	speed: 0.0062s/iter; left time: 5.0782s
Updating learning rate to 0.002295210804720494
Validation loss decreased (0.2971 --> 0.2924).  Saving model state dict ...
Epoch: 2 cost time: 0.472027063369751
Epoch: 2, Steps: 131 | Train Loss: 0.4214816 Vali Loss: 0.2924492 Best vali loss: 0.2924492
	iters: 100, epoch: 3 | loss: 0.6499908
	speed: 0.0061s/iter; left time: 4.1933s
Updating learning rate to 0.001859022521875611
Epoch: 3 cost time: 0.4603607654571533
Epoch: 3, Steps: 131 | Train Loss: 0.6499908 Vali Loss: 0.3001836 Best vali loss: 0.2924492
	iters: 100, epoch: 4 | loss: 0.6018677
	speed: 0.0059s/iter; left time: 3.2885s
Updating learning rate to 0.0013445033609
Epoch: 4 cost time: 0.4372234344482422
Epoch: 4, Steps: 131 | Train Loss: 0.6018677 Vali Loss: 0.2971770 Best vali loss: 0.2924492
	iters: 100, epoch: 5 | loss: 0.3372373
	speed: 0.0056s/iter; left time: 2.3958s
Updating learning rate to 0.000829984199924389
Epoch: 5 cost time: 0.42773008346557617
Epoch: 5, Steps: 131 | Train Loss: 0.3372373 Vali Loss: 0.3166022 Best vali loss: 0.2924492
	iters: 100, epoch: 6 | loss: 0.3233844
	speed: 0.0060s/iter; left time: 1.7577s
Updating learning rate to 0.00039379591707950604
Epoch: 6 cost time: 0.44890570640563965
Epoch: 6, Steps: 131 | Train Loss: 0.3233844 Vali Loss: 0.3226285 Best vali loss: 0.2924492
	iters: 100, epoch: 7 | loss: 0.4052654
	speed: 0.0062s/iter; left time: 1.0061s
Updating learning rate to 0.00010234422437185415
Epoch: 7 cost time: 0.49570679664611816
Epoch: 7, Steps: 131 | Train Loss: 0.4052654 Vali Loss: 0.3326438 Best vali loss: 0.2924492
	iters: 100, epoch: 8 | loss: 0.3012086
	speed: 0.0065s/iter; left time: 0.2066s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4849534034729004
Epoch: 8, Steps: 131 | Train Loss: 0.3012086 Vali Loss: 0.3473337 Best vali loss: 0.2924492

best validation loss 0.2924492427211306

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0051563633661, 'e_layers': 4, 'learning_rate': 0.0001081267842, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4358929
	speed: 0.0115s/iter; left time: 47.0876s
	iters: 200, epoch: 1 | loss: 0.3226757
	speed: 0.0060s/iter; left time: 23.7871s
	iters: 300, epoch: 1 | loss: 1.4019547
	speed: 0.0056s/iter; left time: 21.7161s
	iters: 400, epoch: 1 | loss: 0.8311498
	speed: 0.0053s/iter; left time: 19.9695s
	iters: 500, epoch: 1 | loss: 0.3849358
	speed: 0.0047s/iter; left time: 17.3386s
Updating learning rate to 0.00010401145351932239
Validation loss decreased (inf --> 0.3048).  Saving model state dict ...
Epoch: 1 cost time: 3.1520161628723145
Epoch: 1, Steps: 523 | Train Loss: 0.6753218 Vali Loss: 0.3048445 Best vali loss: 0.3048445
	iters: 100, epoch: 2 | loss: 0.7715452
	speed: 0.0126s/iter; left time: 44.9149s
	iters: 200, epoch: 2 | loss: 0.2582426
	speed: 0.0062s/iter; left time: 21.5888s
	iters: 300, epoch: 2 | loss: 1.1777514
	speed: 0.0063s/iter; left time: 21.1144s
	iters: 400, epoch: 2 | loss: 0.3298565
	speed: 0.0063s/iter; left time: 20.5014s
	iters: 500, epoch: 2 | loss: 0.4147242
	speed: 0.0063s/iter; left time: 20.0038s
Updating learning rate to 9.229198326785722e-05
Validation loss decreased (0.3048 --> 0.2942).  Saving model state dict ...
Epoch: 2 cost time: 3.3351023197174072
Epoch: 2, Steps: 523 | Train Loss: 0.5904240 Vali Loss: 0.2942275 Best vali loss: 0.2942275
	iters: 100, epoch: 3 | loss: 0.4143919
	speed: 0.0133s/iter; left time: 40.3745s
	iters: 200, epoch: 3 | loss: 0.4464267
	speed: 0.0064s/iter; left time: 18.8546s
	iters: 300, epoch: 3 | loss: 0.5595812
	speed: 0.0064s/iter; left time: 18.2090s
	iters: 400, epoch: 3 | loss: 0.7459742
	speed: 0.0061s/iter; left time: 16.6213s
	iters: 500, epoch: 3 | loss: 1.4275142
	speed: 0.0059s/iter; left time: 15.5771s
Updating learning rate to 7.475255655412767e-05
Validation loss decreased (0.2942 --> 0.2888).  Saving model state dict ...
Epoch: 3 cost time: 3.2911009788513184
Epoch: 3, Steps: 523 | Train Loss: 0.7187777 Vali Loss: 0.2887922 Best vali loss: 0.2887922

best validation loss 0.2887921775914604

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3678895
	speed: 0.0096s/iter; left time: 79.3251s
	iters: 200, epoch: 1 | loss: 1.5629160
	speed: 0.0043s/iter; left time: 34.7233s
	iters: 300, epoch: 1 | loss: 0.2213631
	speed: 0.0041s/iter; left time: 33.1789s
	iters: 400, epoch: 1 | loss: 0.1894414
	speed: 0.0042s/iter; left time: 33.6044s
	iters: 500, epoch: 1 | loss: 0.9318686
	speed: 0.0043s/iter; left time: 33.5665s
	iters: 600, epoch: 1 | loss: 0.5270708
	speed: 0.0043s/iter; left time: 33.2451s
	iters: 700, epoch: 1 | loss: 0.3532255
	speed: 0.0043s/iter; left time: 32.8393s
	iters: 800, epoch: 1 | loss: 0.8956394
	speed: 0.0043s/iter; left time: 32.1618s
	iters: 900, epoch: 1 | loss: 0.2563230
	speed: 0.0042s/iter; left time: 31.4556s
	iters: 1000, epoch: 1 | loss: 0.4939550
	speed: 0.0042s/iter; left time: 30.7635s
Updating learning rate to 0.0005849557155
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 4.7052342891693115
Epoch: 1, Steps: 1045 | Train Loss: 0.5799692 Vali Loss: 0.2852655 Best vali loss: 0.2852655
	iters: 100, epoch: 2 | loss: 0.2634806
	speed: 0.0137s/iter; left time: 98.5298s
	iters: 200, epoch: 2 | loss: 0.1831378
	speed: 0.0036s/iter; left time: 25.8814s
	iters: 300, epoch: 2 | loss: 0.3103816
	speed: 0.0039s/iter; left time: 27.7053s
	iters: 400, epoch: 2 | loss: 1.2050509
	speed: 0.0039s/iter; left time: 26.8300s
	iters: 500, epoch: 2 | loss: 0.8359732
	speed: 0.0039s/iter; left time: 26.3951s
	iters: 600, epoch: 2 | loss: 1.0482446
	speed: 0.0039s/iter; left time: 26.2019s
	iters: 700, epoch: 2 | loss: 0.5779238
	speed: 0.0041s/iter; left time: 27.1093s
	iters: 800, epoch: 2 | loss: 0.4072427
	speed: 0.0041s/iter; left time: 26.4094s
	iters: 900, epoch: 2 | loss: 0.3632905
	speed: 0.0041s/iter; left time: 26.4925s
	iters: 1000, epoch: 2 | loss: 0.2966986
	speed: 0.0041s/iter; left time: 25.9267s
Updating learning rate to 0.00029247785775
Validation loss decreased (0.2853 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 4.156240463256836
Epoch: 2, Steps: 1045 | Train Loss: 0.5491424 Vali Loss: 0.2818517 Best vali loss: 0.2818517
	iters: 100, epoch: 3 | loss: 1.3444511
	speed: 0.0149s/iter; left time: 91.8290s
	iters: 200, epoch: 3 | loss: 0.2877151
	speed: 0.0044s/iter; left time: 26.4292s
	iters: 300, epoch: 3 | loss: 0.8316966
	speed: 0.0042s/iter; left time: 25.3190s
	iters: 400, epoch: 3 | loss: 0.3880877
	speed: 0.0042s/iter; left time: 24.8321s
	iters: 500, epoch: 3 | loss: 0.5955710
	speed: 0.0039s/iter; left time: 22.4898s
	iters: 600, epoch: 3 | loss: 0.4839004
	speed: 0.0040s/iter; left time: 22.5447s
	iters: 700, epoch: 3 | loss: 0.2213751
	speed: 0.0039s/iter; left time: 21.9930s
	iters: 800, epoch: 3 | loss: 0.2494425
	speed: 0.0030s/iter; left time: 16.4090s
	iters: 900, epoch: 3 | loss: 0.3614761
	speed: 0.0030s/iter; left time: 16.3491s
	iters: 1000, epoch: 3 | loss: 0.3954605
	speed: 0.0035s/iter; left time: 18.5351s
Updating learning rate to 0.000146238928875
Epoch: 3 cost time: 4.07725715637207
Epoch: 3, Steps: 1045 | Train Loss: 0.5159176 Vali Loss: 0.2926868 Best vali loss: 0.2818517

best validation loss 0.2818517185811351

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3069940
	speed: 0.0116s/iter; left time: 95.5901s
	iters: 200, epoch: 1 | loss: 0.7160141
	speed: 0.0062s/iter; left time: 50.8482s
	iters: 300, epoch: 1 | loss: 0.3359448
	speed: 0.0063s/iter; left time: 50.6822s
	iters: 400, epoch: 1 | loss: 0.6916814
	speed: 0.0061s/iter; left time: 48.6120s
	iters: 500, epoch: 1 | loss: 0.4834152
	speed: 0.0058s/iter; left time: 45.7128s
	iters: 600, epoch: 1 | loss: 0.2117225
	speed: 0.0061s/iter; left time: 47.4221s
	iters: 700, epoch: 1 | loss: 1.2944843
	speed: 0.0060s/iter; left time: 46.0348s
	iters: 800, epoch: 1 | loss: 0.3726177
	speed: 0.0061s/iter; left time: 45.9799s
	iters: 900, epoch: 1 | loss: 0.4726994
	speed: 0.0060s/iter; left time: 45.1049s
	iters: 1000, epoch: 1 | loss: 0.8029683
	speed: 0.0061s/iter; left time: 45.0741s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.2893).  Saving model state dict ...
Epoch: 1 cost time: 6.659027338027954
Epoch: 1, Steps: 1045 | Train Loss: 0.5688542 Vali Loss: 0.2893076 Best vali loss: 0.2893076
	iters: 100, epoch: 2 | loss: 0.3171771
	speed: 0.0178s/iter; left time: 128.2521s
	iters: 200, epoch: 2 | loss: 0.8270590
	speed: 0.0057s/iter; left time: 40.8788s
	iters: 300, epoch: 2 | loss: 0.8260513
	speed: 0.0061s/iter; left time: 42.5408s
	iters: 400, epoch: 2 | loss: 0.5182074
	speed: 0.0062s/iter; left time: 42.6664s
	iters: 500, epoch: 2 | loss: 0.2265671
	speed: 0.0062s/iter; left time: 41.9487s
	iters: 600, epoch: 2 | loss: 0.4194104
	speed: 0.0061s/iter; left time: 41.2317s
	iters: 700, epoch: 2 | loss: 0.2538637
	speed: 0.0060s/iter; left time: 39.7293s
	iters: 800, epoch: 2 | loss: 1.5482407
	speed: 0.0061s/iter; left time: 39.7390s
	iters: 900, epoch: 2 | loss: 0.3702432
	speed: 0.0058s/iter; left time: 37.4671s
	iters: 1000, epoch: 2 | loss: 0.2178724
	speed: 0.0058s/iter; left time: 36.7325s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.2893 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 6.278711557388306
Epoch: 2, Steps: 1045 | Train Loss: 0.5524692 Vali Loss: 0.2829204 Best vali loss: 0.2829204
	iters: 100, epoch: 3 | loss: 0.9505225
	speed: 0.0182s/iter; left time: 112.5517s
	iters: 200, epoch: 3 | loss: 0.3140688
	speed: 0.0058s/iter; left time: 35.4950s
	iters: 300, epoch: 3 | loss: 0.3219434
	speed: 0.0058s/iter; left time: 34.7871s
	iters: 400, epoch: 3 | loss: 0.5950058
	speed: 0.0057s/iter; left time: 33.6269s
	iters: 500, epoch: 3 | loss: 0.3572009
	speed: 0.0058s/iter; left time: 33.4060s
	iters: 600, epoch: 3 | loss: 0.3118716
	speed: 0.0055s/iter; left time: 31.1409s
	iters: 700, epoch: 3 | loss: 0.3398941
	speed: 0.0052s/iter; left time: 29.0568s
	iters: 800, epoch: 3 | loss: 0.1339739
	speed: 0.0057s/iter; left time: 31.2470s
	iters: 900, epoch: 3 | loss: 0.2822660
	speed: 0.0061s/iter; left time: 32.6406s
	iters: 1000, epoch: 3 | loss: 0.5210187
	speed: 0.0061s/iter; left time: 31.9720s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 6.074275493621826
Epoch: 3, Steps: 1045 | Train Loss: 0.4127766 Vali Loss: 0.2841075 Best vali loss: 0.2829204

best validation loss 0.28292036942054277

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3244047
	speed: 0.0093s/iter; left time: 47.7590s
	iters: 200, epoch: 4 | loss: 1.5307930
	speed: 0.0039s/iter; left time: 19.7553s
	iters: 300, epoch: 4 | loss: 0.1896928
	speed: 0.0036s/iter; left time: 17.9523s
	iters: 400, epoch: 4 | loss: 0.1730139
	speed: 0.0029s/iter; left time: 14.1868s
	iters: 500, epoch: 4 | loss: 0.9195782
	speed: 0.0030s/iter; left time: 14.2502s
	iters: 600, epoch: 4 | loss: 0.4066714
	speed: 0.0037s/iter; left time: 17.2497s
	iters: 700, epoch: 4 | loss: 0.3517250
	speed: 0.0040s/iter; left time: 18.1109s
	iters: 800, epoch: 4 | loss: 0.7036605
	speed: 0.0039s/iter; left time: 17.2819s
	iters: 900, epoch: 4 | loss: 0.2369842
	speed: 0.0041s/iter; left time: 17.8065s
	iters: 1000, epoch: 4 | loss: 0.5200151
	speed: 0.0040s/iter; left time: 16.7186s
Updating learning rate to 7.31194644375e-05
Epoch: 4 cost time: 4.1852734088897705
Epoch: 4, Steps: 1045 | Train Loss: 0.5356539 Vali Loss: 0.2933235 Best vali loss: 0.2818517
	iters: 100, epoch: 5 | loss: 0.2585767
	speed: 0.0135s/iter; left time: 54.8972s
	iters: 200, epoch: 5 | loss: 0.1861510
	speed: 0.0045s/iter; left time: 17.9897s
	iters: 300, epoch: 5 | loss: 0.2938263
	speed: 0.0039s/iter; left time: 15.1680s
	iters: 400, epoch: 5 | loss: 0.9798924
	speed: 0.0043s/iter; left time: 16.2276s
	iters: 500, epoch: 5 | loss: 0.7245126
	speed: 0.0038s/iter; left time: 14.1712s
	iters: 600, epoch: 5 | loss: 0.8986454
	speed: 0.0040s/iter; left time: 14.2112s
	iters: 700, epoch: 5 | loss: 0.5620949
	speed: 0.0042s/iter; left time: 14.5799s
	iters: 800, epoch: 5 | loss: 0.4050986
	speed: 0.0039s/iter; left time: 13.2353s
	iters: 900, epoch: 5 | loss: 0.3588828
	speed: 0.0029s/iter; left time: 9.4973s
	iters: 1000, epoch: 5 | loss: 0.2711468
	speed: 0.0029s/iter; left time: 9.1948s
Updating learning rate to 3.655973221875e-05
Epoch: 5 cost time: 3.998025894165039
Epoch: 5, Steps: 1045 | Train Loss: 0.4938828 Vali Loss: 0.2940937 Best vali loss: 0.2818517
	iters: 100, epoch: 6 | loss: 1.2203807
	speed: 0.0132s/iter; left time: 40.1809s
	iters: 200, epoch: 6 | loss: 0.2792512
	speed: 0.0039s/iter; left time: 11.4288s
	iters: 300, epoch: 6 | loss: 0.8949463
	speed: 0.0036s/iter; left time: 10.2362s
	iters: 400, epoch: 6 | loss: 0.3747893
	speed: 0.0039s/iter; left time: 10.6002s
	iters: 500, epoch: 6 | loss: 0.5852917
	speed: 0.0038s/iter; left time: 9.9466s
	iters: 600, epoch: 6 | loss: 0.5047910
	speed: 0.0039s/iter; left time: 9.8873s
	iters: 700, epoch: 6 | loss: 0.2124850
	speed: 0.0041s/iter; left time: 9.9515s
	iters: 800, epoch: 6 | loss: 0.2062447
	speed: 0.0038s/iter; left time: 8.9531s
	iters: 900, epoch: 6 | loss: 0.3612870
	speed: 0.0037s/iter; left time: 8.1749s
	iters: 1000, epoch: 6 | loss: 0.3517829
	speed: 0.0037s/iter; left time: 7.8006s
Updating learning rate to 1.8279866109375e-05
Epoch: 6 cost time: 3.9895291328430176
Epoch: 6, Steps: 1045 | Train Loss: 0.4991250 Vali Loss: 0.2953640 Best vali loss: 0.2818517
	iters: 100, epoch: 7 | loss: 0.3446192
	speed: 0.0134s/iter; left time: 26.6165s
	iters: 200, epoch: 7 | loss: 0.1854776
	speed: 0.0042s/iter; left time: 7.8529s
	iters: 300, epoch: 7 | loss: 1.1671848
	speed: 0.0037s/iter; left time: 6.7043s
	iters: 400, epoch: 7 | loss: 0.7886814
	speed: 0.0041s/iter; left time: 6.9110s
	iters: 500, epoch: 7 | loss: 0.2296194
	speed: 0.0040s/iter; left time: 6.3814s
	iters: 600, epoch: 7 | loss: 0.4308701
	speed: 0.0033s/iter; left time: 4.9304s
	iters: 700, epoch: 7 | loss: 1.1821131
	speed: 0.0033s/iter; left time: 4.5682s
	iters: 800, epoch: 7 | loss: 0.7370149
	speed: 0.0037s/iter; left time: 4.7483s
	iters: 900, epoch: 7 | loss: 0.2470572
	speed: 0.0043s/iter; left time: 5.1298s
	iters: 1000, epoch: 7 | loss: 0.2272374
	speed: 0.0044s/iter; left time: 4.8161s
Updating learning rate to 9.1399330546875e-06
Epoch: 7 cost time: 4.111542463302612
Epoch: 7, Steps: 1045 | Train Loss: 0.5539875 Vali Loss: 0.2952575 Best vali loss: 0.2818517
	iters: 100, epoch: 8 | loss: 0.4678749
	speed: 0.0145s/iter; left time: 13.6896s
	iters: 200, epoch: 8 | loss: 0.2949201
	speed: 0.0040s/iter; left time: 3.4071s
	iters: 300, epoch: 8 | loss: 0.3147559
	speed: 0.0043s/iter; left time: 3.1752s
	iters: 400, epoch: 8 | loss: 0.7131637
	speed: 0.0043s/iter; left time: 2.7504s
	iters: 500, epoch: 8 | loss: 0.3845416
	speed: 0.0043s/iter; left time: 2.3417s
	iters: 600, epoch: 8 | loss: 0.3914648
	speed: 0.0043s/iter; left time: 1.9305s
	iters: 700, epoch: 8 | loss: 1.0691088
	speed: 0.0041s/iter; left time: 1.4359s
	iters: 800, epoch: 8 | loss: 1.2215476
	speed: 0.0035s/iter; left time: 0.8733s
	iters: 900, epoch: 8 | loss: 0.6667264
	speed: 0.0041s/iter; left time: 0.6051s
	iters: 1000, epoch: 8 | loss: 0.1994583
	speed: 0.0043s/iter; left time: 0.1976s
Updating learning rate to 4.56996652734375e-06
Epoch: 8 cost time: 4.376108169555664
Epoch: 8, Steps: 1045 | Train Loss: 0.5723562 Vali Loss: 0.2950091 Best vali loss: 0.2818517

best validation loss 0.2818517185811351

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018403809852, 'e_layers': 2, 'learning_rate': 0.0001571149601, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7767588
	speed: 0.0090s/iter; left time: 8.5724s
Updating learning rate to 0.00015113512799385873
Validation loss decreased (inf --> 0.3059).  Saving model state dict ...
Epoch: 1 cost time: 0.7509360313415527
Epoch: 1, Steps: 131 | Train Loss: 0.7767588 Vali Loss: 0.3059375 Best vali loss: 0.3059375
	iters: 100, epoch: 2 | loss: 0.3233068
	speed: 0.0071s/iter; left time: 5.8219s
Updating learning rate to 0.0001341060069062819
Validation loss decreased (0.3059 --> 0.2892).  Saving model state dict ...
Epoch: 2 cost time: 0.6043601036071777
Epoch: 2, Steps: 131 | Train Loss: 0.3233068 Vali Loss: 0.2891615 Best vali loss: 0.2891615
	iters: 100, epoch: 3 | loss: 0.4580484
	speed: 0.0076s/iter; left time: 5.1985s
Updating learning rate to 0.00010862012615348607
Validation loss decreased (0.2892 --> 0.2844).  Saving model state dict ...
Epoch: 3 cost time: 0.593235969543457
Epoch: 3, Steps: 131 | Train Loss: 0.4580484 Vali Loss: 0.2843594 Best vali loss: 0.2843594
	iters: 100, epoch: 4 | loss: 0.5592247
	speed: 0.0076s/iter; left time: 4.2330s
Updating learning rate to 7.855748005e-05
Validation loss decreased (0.2844 --> 0.2820).  Saving model state dict ...
Epoch: 4 cost time: 0.6111204624176025
Epoch: 4, Steps: 131 | Train Loss: 0.5592247 Vali Loss: 0.2819846 Best vali loss: 0.2819846
	iters: 100, epoch: 5 | loss: 0.6377678
	speed: 0.0075s/iter; left time: 3.1819s
Updating learning rate to 4.849483394651394e-05
Validation loss decreased (0.2820 --> 0.2817).  Saving model state dict ...
Epoch: 5 cost time: 0.6173207759857178
Epoch: 5, Steps: 131 | Train Loss: 0.6377678 Vali Loss: 0.2816628 Best vali loss: 0.2816628
	iters: 100, epoch: 6 | loss: 0.7304971
	speed: 0.0078s/iter; left time: 2.2907s
Updating learning rate to 2.3008953193718083e-05
Validation loss decreased (0.2817 --> 0.2816).  Saving model state dict ...
Epoch: 6 cost time: 0.630730390548706
Epoch: 6, Steps: 131 | Train Loss: 0.7304971 Vali Loss: 0.2816206 Best vali loss: 0.2816206
	iters: 100, epoch: 7 | loss: 0.6871402
	speed: 0.0079s/iter; left time: 1.2940s
Updating learning rate to 5.979832106141266e-06
Validation loss decreased (0.2816 --> 0.2816).  Saving model state dict ...
Epoch: 7 cost time: 0.6474285125732422
Epoch: 7, Steps: 131 | Train Loss: 0.6871402 Vali Loss: 0.2816001 Best vali loss: 0.2816001
	iters: 100, epoch: 8 | loss: 0.4701161
	speed: 0.0077s/iter; left time: 0.2459s
Updating learning rate to 0.0
Validation loss decreased (0.2816 --> 0.2816).  Saving model state dict ...
Epoch: 8 cost time: 0.6008713245391846
Epoch: 8, Steps: 131 | Train Loss: 0.4701161 Vali Loss: 0.2815723 Best vali loss: 0.2815723

best validation loss 0.28157232159263096

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0080579476276, 'e_layers': 1, 'learning_rate': 0.000985904912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4530058
	speed: 0.0083s/iter; left time: 16.5039s
	iters: 200, epoch: 1 | loss: 0.2863426
	speed: 0.0028s/iter; left time: 5.3714s
Updating learning rate to 0.000985904912
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 1.0227165222167969
Epoch: 1, Steps: 262 | Train Loss: 0.3696742 Vali Loss: 0.2827511 Best vali loss: 0.2827511
	iters: 100, epoch: 2 | loss: 0.4530943
	speed: 0.0069s/iter; left time: 11.9060s
	iters: 200, epoch: 2 | loss: 0.6210925
	speed: 0.0027s/iter; left time: 4.4602s
Updating learning rate to 0.000492952456
Epoch: 2 cost time: 0.7437002658843994
Epoch: 2, Steps: 262 | Train Loss: 0.5370934 Vali Loss: 0.2912496 Best vali loss: 0.2827511
	iters: 100, epoch: 3 | loss: 0.3213900
	speed: 0.0067s/iter; left time: 9.8873s
	iters: 200, epoch: 3 | loss: 0.9803395
	speed: 0.0031s/iter; left time: 4.3160s
Updating learning rate to 0.000246476228
Epoch: 3 cost time: 0.9021039009094238
Epoch: 3, Steps: 262 | Train Loss: 0.6508648 Vali Loss: 0.2961689 Best vali loss: 0.2827511
	iters: 100, epoch: 4 | loss: 0.3248072
	speed: 0.0097s/iter; left time: 11.7429s
	iters: 200, epoch: 4 | loss: 0.8195405
	speed: 0.0037s/iter; left time: 4.1562s
Updating learning rate to 0.000123238114
Epoch: 4 cost time: 1.0322606563568115
Epoch: 4, Steps: 262 | Train Loss: 0.5721738 Vali Loss: 0.2960160 Best vali loss: 0.2827511
	iters: 100, epoch: 5 | loss: 0.6957957
	speed: 0.0094s/iter; left time: 8.9284s
	iters: 200, epoch: 5 | loss: 0.3980846
	speed: 0.0036s/iter; left time: 3.0801s
Updating learning rate to 6.1619057e-05
Epoch: 5 cost time: 0.9715816974639893
Epoch: 5, Steps: 262 | Train Loss: 0.5469401 Vali Loss: 0.2988372 Best vali loss: 0.2827511
	iters: 100, epoch: 6 | loss: 0.2425754
	speed: 0.0066s/iter; left time: 4.5450s
	iters: 200, epoch: 6 | loss: 0.4446411
	speed: 0.0028s/iter; left time: 1.6630s
Updating learning rate to 3.08095285e-05
Epoch: 6 cost time: 0.8086700439453125
Epoch: 6, Steps: 262 | Train Loss: 0.3436082 Vali Loss: 0.2996590 Best vali loss: 0.2827511
	iters: 100, epoch: 7 | loss: 0.3372402
	speed: 0.0075s/iter; left time: 3.1860s
	iters: 200, epoch: 7 | loss: 0.3353003
	speed: 0.0029s/iter; left time: 0.9469s
Updating learning rate to 1.540476425e-05
Epoch: 7 cost time: 0.8228118419647217
Epoch: 7, Steps: 262 | Train Loss: 0.3362703 Vali Loss: 0.3010734 Best vali loss: 0.2827511
	iters: 100, epoch: 8 | loss: 0.3199435
	speed: 0.0072s/iter; left time: 1.1686s
	iters: 200, epoch: 8 | loss: 0.2895221
	speed: 0.0028s/iter; left time: 0.1779s
Updating learning rate to 7.702382125e-06
Epoch: 8 cost time: 0.7953381538391113
Epoch: 8, Steps: 262 | Train Loss: 0.3047328 Vali Loss: 0.3007916 Best vali loss: 0.2827511

best validation loss 0.28275108392817594

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6476913
	speed: 0.0097s/iter; left time: 39.7693s
	iters: 200, epoch: 1 | loss: 1.0018134
	speed: 0.0043s/iter; left time: 17.3008s
	iters: 300, epoch: 1 | loss: 1.1051071
	speed: 0.0038s/iter; left time: 14.8114s
	iters: 400, epoch: 1 | loss: 0.5436990
	speed: 0.0039s/iter; left time: 14.9041s
	iters: 500, epoch: 1 | loss: 0.5829185
	speed: 0.0042s/iter; left time: 15.4897s
Updating learning rate to 0.0013504261128
Validation loss decreased (inf --> 0.3163).  Saving model state dict ...
Epoch: 1 cost time: 2.4388468265533447
Epoch: 1, Steps: 523 | Train Loss: 0.7762459 Vali Loss: 0.3162654 Best vali loss: 0.3162654
	iters: 100, epoch: 2 | loss: 0.3314176
	speed: 0.0095s/iter; left time: 33.9813s
	iters: 200, epoch: 2 | loss: 0.2363244
	speed: 0.0043s/iter; left time: 14.8927s
	iters: 300, epoch: 2 | loss: 0.7087943
	speed: 0.0038s/iter; left time: 12.9341s
	iters: 400, epoch: 2 | loss: 0.3531640
	speed: 0.0034s/iter; left time: 11.0479s
	iters: 500, epoch: 2 | loss: 1.1796858
	speed: 0.0042s/iter; left time: 13.3127s
Updating learning rate to 0.0006752130564
Validation loss decreased (0.3163 --> 0.2982).  Saving model state dict ...
Epoch: 2 cost time: 2.1436257362365723
Epoch: 2, Steps: 523 | Train Loss: 0.5618772 Vali Loss: 0.2982240 Best vali loss: 0.2982240
	iters: 100, epoch: 3 | loss: 0.2443831
	speed: 0.0095s/iter; left time: 29.0179s
	iters: 200, epoch: 3 | loss: 0.4208975
	speed: 0.0043s/iter; left time: 12.4927s
	iters: 300, epoch: 3 | loss: 0.7987425
	speed: 0.0042s/iter; left time: 11.8112s
	iters: 400, epoch: 3 | loss: 0.3686646
	speed: 0.0036s/iter; left time: 9.9292s
	iters: 500, epoch: 3 | loss: 0.4516321
	speed: 0.0038s/iter; left time: 10.1262s
Updating learning rate to 0.0003376065282
Validation loss decreased (0.2982 --> 0.2918).  Saving model state dict ...
Epoch: 3 cost time: 2.1533682346343994
Epoch: 3, Steps: 523 | Train Loss: 0.4568640 Vali Loss: 0.2918390 Best vali loss: 0.2918390

best validation loss 0.29183897824924027

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4152627
	speed: 0.0093s/iter; left time: 38.0189s
	iters: 200, epoch: 1 | loss: 0.3628592
	speed: 0.0036s/iter; left time: 14.3921s
	iters: 300, epoch: 1 | loss: 0.2360256
	speed: 0.0030s/iter; left time: 11.4902s
	iters: 400, epoch: 1 | loss: 1.1788956
	speed: 0.0029s/iter; left time: 11.1456s
	iters: 500, epoch: 1 | loss: 0.2745636
	speed: 0.0033s/iter; left time: 12.0272s
Updating learning rate to 6.03650536e-05
Validation loss decreased (inf --> 0.2914).  Saving model state dict ...
Epoch: 1 cost time: 2.0398268699645996
Epoch: 1, Steps: 523 | Train Loss: 0.4935213 Vali Loss: 0.2913869 Best vali loss: 0.2913869
	iters: 100, epoch: 2 | loss: 0.7309296
	speed: 0.0089s/iter; left time: 31.8367s
	iters: 200, epoch: 2 | loss: 0.3178223
	speed: 0.0036s/iter; left time: 12.6088s
	iters: 300, epoch: 2 | loss: 0.5117921
	speed: 0.0035s/iter; left time: 11.9342s
	iters: 400, epoch: 2 | loss: 1.0607191
	speed: 0.0036s/iter; left time: 11.8498s
	iters: 500, epoch: 2 | loss: 0.2431664
	speed: 0.0036s/iter; left time: 11.4687s
Updating learning rate to 3.01825268e-05
Validation loss decreased (0.2914 --> 0.2820).  Saving model state dict ...
Epoch: 2 cost time: 1.9309887886047363
Epoch: 2, Steps: 523 | Train Loss: 0.5728859 Vali Loss: 0.2819924 Best vali loss: 0.2819924
	iters: 100, epoch: 3 | loss: 0.5566078
	speed: 0.0087s/iter; left time: 26.4089s
	iters: 200, epoch: 3 | loss: 0.5248308
	speed: 0.0035s/iter; left time: 10.2351s
	iters: 300, epoch: 3 | loss: 0.5153539
	speed: 0.0036s/iter; left time: 10.2819s
	iters: 400, epoch: 3 | loss: 0.6770707
	speed: 0.0038s/iter; left time: 10.3424s
	iters: 500, epoch: 3 | loss: 0.3461184
	speed: 0.0039s/iter; left time: 10.2718s
Updating learning rate to 1.50912634e-05
Validation loss decreased (0.2820 --> 0.2798).  Saving model state dict ...
Epoch: 3 cost time: 1.960113763809204
Epoch: 3, Steps: 523 | Train Loss: 0.5239963 Vali Loss: 0.2798226 Best vali loss: 0.2798226

best validation loss 0.27982257989291676

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043939909637, 'e_layers': 2, 'learning_rate': 0.0005385073997, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4599387
	speed: 0.0095s/iter; left time: 8.9793s
Updating learning rate to 0.0005180116821943523
Validation loss decreased (inf --> 0.2943).  Saving model state dict ...
Epoch: 1 cost time: 0.8248441219329834
Epoch: 1, Steps: 131 | Train Loss: 0.4599387 Vali Loss: 0.2943333 Best vali loss: 0.2943333
	iters: 100, epoch: 2 | loss: 0.3075444
	speed: 0.0075s/iter; left time: 6.1072s
Updating learning rate to 0.00045964481687350226
Validation loss decreased (0.2943 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 0.5858938694000244
Epoch: 2, Steps: 131 | Train Loss: 0.3075444 Vali Loss: 0.2835376 Best vali loss: 0.2835376
	iters: 100, epoch: 3 | loss: 0.6116894
	speed: 0.0071s/iter; left time: 4.8627s
Updating learning rate to 0.0003722926298855977
Validation loss decreased (0.2835 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 0.5692124366760254
Epoch: 3, Steps: 131 | Train Loss: 0.6116894 Vali Loss: 0.2834512 Best vali loss: 0.2834512

best validation loss 0.2834512033247292

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3756593
	speed: 0.0095s/iter; left time: 23.8409s
	iters: 200, epoch: 4 | loss: 0.2913838
	speed: 0.0035s/iter; left time: 8.5234s
	iters: 300, epoch: 4 | loss: 0.2128071
	speed: 0.0035s/iter; left time: 7.9970s
	iters: 400, epoch: 4 | loss: 1.0646536
	speed: 0.0036s/iter; left time: 7.9111s
	iters: 500, epoch: 4 | loss: 0.2478221
	speed: 0.0037s/iter; left time: 7.7348s
Updating learning rate to 7.5456317e-06
Epoch: 4 cost time: 2.1710703372955322
Epoch: 4, Steps: 523 | Train Loss: 0.4384652 Vali Loss: 0.2807663 Best vali loss: 0.2798226
	iters: 100, epoch: 5 | loss: 0.7116601
	speed: 0.0084s/iter; left time: 16.8357s
	iters: 200, epoch: 5 | loss: 0.3108072
	speed: 0.0042s/iter; left time: 7.9490s
	iters: 300, epoch: 5 | loss: 0.4874563
	speed: 0.0041s/iter; left time: 7.2767s
	iters: 400, epoch: 5 | loss: 0.9334180
	speed: 0.0039s/iter; left time: 6.5933s
	iters: 500, epoch: 5 | loss: 0.2374309
	speed: 0.0041s/iter; left time: 6.5229s
Updating learning rate to 3.77281585e-06
Epoch: 5 cost time: 2.1551873683929443
Epoch: 5, Steps: 523 | Train Loss: 0.5361545 Vali Loss: 0.2801175 Best vali loss: 0.2798226
	iters: 100, epoch: 6 | loss: 0.4668107
	speed: 0.0092s/iter; left time: 13.5071s
	iters: 200, epoch: 6 | loss: 0.5373698
	speed: 0.0036s/iter; left time: 4.8905s
	iters: 300, epoch: 6 | loss: 0.5153603
	speed: 0.0037s/iter; left time: 4.6373s
	iters: 400, epoch: 6 | loss: 0.6669950
	speed: 0.0036s/iter; left time: 4.2563s
	iters: 500, epoch: 6 | loss: 0.3454905
	speed: 0.0037s/iter; left time: 3.9282s
Updating learning rate to 1.886407925e-06
Validation loss decreased (0.2798 --> 0.2797).  Saving model state dict ...
Epoch: 6 cost time: 1.9662950038909912
Epoch: 6, Steps: 523 | Train Loss: 0.5064053 Vali Loss: 0.2797231 Best vali loss: 0.2797231
	iters: 100, epoch: 7 | loss: 0.3984378
	speed: 0.0094s/iter; left time: 8.8760s
	iters: 200, epoch: 7 | loss: 0.3524087
	speed: 0.0041s/iter; left time: 3.4408s
	iters: 300, epoch: 7 | loss: 0.3233558
	speed: 0.0041s/iter; left time: 3.0377s
	iters: 400, epoch: 7 | loss: 0.6588348
	speed: 0.0040s/iter; left time: 2.6105s
	iters: 500, epoch: 7 | loss: 0.9081966
	speed: 0.0041s/iter; left time: 2.2417s
Updating learning rate to 9.432039625e-07
Validation loss decreased (0.2797 --> 0.2797).  Saving model state dict ...
Epoch: 7 cost time: 2.1712963581085205
Epoch: 7, Steps: 523 | Train Loss: 0.5282467 Vali Loss: 0.2796646 Best vali loss: 0.2796646
	iters: 100, epoch: 8 | loss: 0.2747796
	speed: 0.0094s/iter; left time: 3.9715s
	iters: 200, epoch: 8 | loss: 0.6527760
	speed: 0.0038s/iter; left time: 1.2314s
	iters: 300, epoch: 8 | loss: 0.6178729
	speed: 0.0041s/iter; left time: 0.9129s
	iters: 400, epoch: 8 | loss: 0.3616904
	speed: 0.0041s/iter; left time: 0.5056s
	iters: 500, epoch: 8 | loss: 0.3243010
	speed: 0.0038s/iter; left time: 0.0907s
Updating learning rate to 4.7160198125e-07
Validation loss decreased (0.2797 --> 0.2797).  Saving model state dict ...
Epoch: 8 cost time: 2.092834949493408
Epoch: 8, Steps: 523 | Train Loss: 0.4462840 Vali Loss: 0.2796512 Best vali loss: 0.2796512

best validation loss 0.279651174273975

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014453407321, 'e_layers': 1, 'learning_rate': 0.0019242997604, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2041682
	speed: 0.0086s/iter; left time: 71.2961s
	iters: 200, epoch: 1 | loss: 0.3018984
	speed: 0.0030s/iter; left time: 24.7253s
	iters: 300, epoch: 1 | loss: 0.2902188
	speed: 0.0029s/iter; left time: 23.0905s
	iters: 400, epoch: 1 | loss: 0.8372511
	speed: 0.0029s/iter; left time: 22.8102s
	iters: 500, epoch: 1 | loss: 0.3792474
	speed: 0.0031s/iter; left time: 24.6576s
	iters: 600, epoch: 1 | loss: 0.4801300
	speed: 0.0034s/iter; left time: 26.2254s
	iters: 700, epoch: 1 | loss: 0.7096649
	speed: 0.0034s/iter; left time: 25.7057s
	iters: 800, epoch: 1 | loss: 0.2964563
	speed: 0.0034s/iter; left time: 25.4660s
	iters: 900, epoch: 1 | loss: 0.2899633
	speed: 0.0034s/iter; left time: 25.2025s
	iters: 1000, epoch: 1 | loss: 0.4427981
	speed: 0.0034s/iter; left time: 24.8099s
Updating learning rate to 0.0018510604617249667
Validation loss decreased (inf --> 0.2919).  Saving model state dict ...
Epoch: 1 cost time: 3.6337692737579346
Epoch: 1, Steps: 1045 | Train Loss: 0.4231796 Vali Loss: 0.2918794 Best vali loss: 0.2918794
	iters: 100, epoch: 2 | loss: 0.2427554
	speed: 0.0123s/iter; left time: 88.8395s
	iters: 200, epoch: 2 | loss: 0.2690833
	speed: 0.0028s/iter; left time: 20.2397s
	iters: 300, epoch: 2 | loss: 0.9075695
	speed: 0.0028s/iter; left time: 19.7373s
	iters: 400, epoch: 2 | loss: 0.3911276
	speed: 0.0030s/iter; left time: 20.4998s
	iters: 500, epoch: 2 | loss: 0.4054437
	speed: 0.0031s/iter; left time: 21.0808s
	iters: 600, epoch: 2 | loss: 0.6621495
	speed: 0.0030s/iter; left time: 20.1683s
	iters: 700, epoch: 2 | loss: 0.3254247
	speed: 0.0030s/iter; left time: 19.8478s
	iters: 800, epoch: 2 | loss: 0.2477472
	speed: 0.0031s/iter; left time: 19.9112s
	iters: 900, epoch: 2 | loss: 0.3666048
	speed: 0.0031s/iter; left time: 19.6443s
	iters: 1000, epoch: 2 | loss: 1.5811973
	speed: 0.0031s/iter; left time: 19.4171s
Updating learning rate to 0.0016424925850072444
Validation loss decreased (0.2919 --> 0.2878).  Saving model state dict ...
Epoch: 2 cost time: 3.187286853790283
Epoch: 2, Steps: 1045 | Train Loss: 0.5399103 Vali Loss: 0.2878429 Best vali loss: 0.2878429
	iters: 100, epoch: 3 | loss: 0.3018001
	speed: 0.0122s/iter; left time: 75.1451s
	iters: 200, epoch: 3 | loss: 0.4222986
	speed: 0.0026s/iter; left time: 16.0156s
	iters: 300, epoch: 3 | loss: 0.2986836
	speed: 0.0025s/iter; left time: 14.8607s
	iters: 400, epoch: 3 | loss: 0.4830411
	speed: 0.0025s/iter; left time: 14.5664s
	iters: 500, epoch: 3 | loss: 0.2545235
	speed: 0.0022s/iter; left time: 12.8845s
	iters: 600, epoch: 3 | loss: 0.5770487
	speed: 0.0021s/iter; left time: 11.8493s
	iters: 700, epoch: 3 | loss: 0.4305030
	speed: 0.0021s/iter; left time: 11.6163s
	iters: 800, epoch: 3 | loss: 0.4702380
	speed: 0.0024s/iter; left time: 12.8764s
	iters: 900, epoch: 3 | loss: 0.2399778
	speed: 0.0039s/iter; left time: 20.9290s
	iters: 1000, epoch: 3 | loss: 1.1549203
	speed: 0.0044s/iter; left time: 23.3807s
Updating learning rate to 0.001330348698804596
Epoch: 3 cost time: 3.0072927474975586
Epoch: 3, Steps: 1045 | Train Loss: 0.4633035 Vali Loss: 0.2883516 Best vali loss: 0.2878429
	iters: 100, epoch: 4 | loss: 0.3504339
	speed: 0.0188s/iter; left time: 96.1258s
	iters: 200, epoch: 4 | loss: 0.3756984
	speed: 0.0047s/iter; left time: 23.5930s
	iters: 300, epoch: 4 | loss: 0.5024887
	speed: 0.0047s/iter; left time: 23.1465s
	iters: 400, epoch: 4 | loss: 0.5647088
	speed: 0.0048s/iter; left time: 22.9291s
	iters: 500, epoch: 4 | loss: 0.6274755
	speed: 0.0047s/iter; left time: 22.0247s
	iters: 600, epoch: 4 | loss: 0.3062673
	speed: 0.0047s/iter; left time: 21.7907s
	iters: 700, epoch: 4 | loss: 0.3180147
	speed: 0.0046s/iter; left time: 20.9525s
	iters: 800, epoch: 4 | loss: 0.1291716
	speed: 0.0046s/iter; left time: 20.5464s
	iters: 900, epoch: 4 | loss: 0.4203750
	speed: 0.0048s/iter; left time: 20.6175s
	iters: 1000, epoch: 4 | loss: 0.4004446
	speed: 0.0042s/iter; left time: 17.8028s
Updating learning rate to 0.0009621498802
Validation loss decreased (0.2878 --> 0.2862).  Saving model state dict ...
Epoch: 4 cost time: 4.794029235839844
Epoch: 4, Steps: 1045 | Train Loss: 0.3995079 Vali Loss: 0.2861838 Best vali loss: 0.2861838
	iters: 100, epoch: 5 | loss: 0.7365704
	speed: 0.0132s/iter; left time: 54.0307s
	iters: 200, epoch: 5 | loss: 1.0012618
	speed: 0.0045s/iter; left time: 17.8138s
	iters: 300, epoch: 5 | loss: 1.3956574
	speed: 0.0045s/iter; left time: 17.6075s
	iters: 400, epoch: 5 | loss: 1.0849445
	speed: 0.0045s/iter; left time: 17.0316s
	iters: 500, epoch: 5 | loss: 0.7528661
	speed: 0.0046s/iter; left time: 16.9222s
	iters: 600, epoch: 5 | loss: 0.1734083
	speed: 0.0046s/iter; left time: 16.3928s
	iters: 700, epoch: 5 | loss: 0.3016486
	speed: 0.0045s/iter; left time: 15.6551s
	iters: 800, epoch: 5 | loss: 0.5844678
	speed: 0.0045s/iter; left time: 15.3733s
	iters: 900, epoch: 5 | loss: 0.5476419
	speed: 0.0046s/iter; left time: 14.9614s
	iters: 1000, epoch: 5 | loss: 0.2056338
	speed: 0.0046s/iter; left time: 14.4844s
Updating learning rate to 0.0005939510615954041
Validation loss decreased (0.2862 --> 0.2832).  Saving model state dict ...
Epoch: 5 cost time: 4.785555839538574
Epoch: 5, Steps: 1045 | Train Loss: 0.6784101 Vali Loss: 0.2832049 Best vali loss: 0.2832049
	iters: 100, epoch: 6 | loss: 0.4822040
	speed: 0.0181s/iter; left time: 55.0302s
	iters: 200, epoch: 6 | loss: 0.5941361
	speed: 0.0047s/iter; left time: 13.7773s
	iters: 300, epoch: 6 | loss: 0.2216107
	speed: 0.0029s/iter; left time: 8.2952s
	iters: 400, epoch: 6 | loss: 0.8540969
	speed: 0.0028s/iter; left time: 7.7364s
	iters: 500, epoch: 6 | loss: 0.2146873
	speed: 0.0030s/iter; left time: 7.7811s
	iters: 600, epoch: 6 | loss: 0.7607507
	speed: 0.0026s/iter; left time: 6.7035s
	iters: 700, epoch: 6 | loss: 0.6004573
	speed: 0.0040s/iter; left time: 9.6320s
	iters: 800, epoch: 6 | loss: 0.2711955
	speed: 0.0042s/iter; left time: 9.8933s
	iters: 900, epoch: 6 | loss: 0.3333835
	speed: 0.0043s/iter; left time: 9.5996s
	iters: 1000, epoch: 6 | loss: 0.2638773
	speed: 0.0043s/iter; left time: 9.1969s
Updating learning rate to 0.0002818071753927558
Epoch: 6 cost time: 3.9935154914855957
Epoch: 6, Steps: 1045 | Train Loss: 0.4596399 Vali Loss: 0.2861922 Best vali loss: 0.2832049
	iters: 100, epoch: 7 | loss: 0.5936512
	speed: 0.0177s/iter; left time: 35.3151s
	iters: 200, epoch: 7 | loss: 0.7913257
	speed: 0.0041s/iter; left time: 7.8214s
	iters: 300, epoch: 7 | loss: 0.3550188
	speed: 0.0040s/iter; left time: 7.0982s
	iters: 400, epoch: 7 | loss: 0.1812241
	speed: 0.0040s/iter; left time: 6.6836s
	iters: 500, epoch: 7 | loss: 0.4551007
	speed: 0.0040s/iter; left time: 6.3209s
	iters: 600, epoch: 7 | loss: 0.3943557
	speed: 0.0039s/iter; left time: 5.8755s
	iters: 700, epoch: 7 | loss: 0.2343855
	speed: 0.0040s/iter; left time: 5.5848s
	iters: 800, epoch: 7 | loss: 0.9541851
	speed: 0.0040s/iter; left time: 5.2282s
	iters: 900, epoch: 7 | loss: 0.1769208
	speed: 0.0041s/iter; left time: 4.9237s
	iters: 1000, epoch: 7 | loss: 0.2141084
	speed: 0.0042s/iter; left time: 4.5392s
Updating learning rate to 7.323929867503346e-05
Epoch: 7 cost time: 4.279866695404053
Epoch: 7, Steps: 1045 | Train Loss: 0.4350276 Vali Loss: 0.2887165 Best vali loss: 0.2832049
	iters: 100, epoch: 8 | loss: 0.2043294
	speed: 0.0130s/iter; left time: 12.2621s
	iters: 200, epoch: 8 | loss: 0.2161387
	speed: 0.0042s/iter; left time: 3.5870s
	iters: 300, epoch: 8 | loss: 0.2705985
	speed: 0.0041s/iter; left time: 3.0859s
	iters: 400, epoch: 8 | loss: 0.1233915
	speed: 0.0043s/iter; left time: 2.7496s
	iters: 500, epoch: 8 | loss: 0.3187718
	speed: 0.0043s/iter; left time: 2.3450s
	iters: 600, epoch: 8 | loss: 0.3309042
	speed: 0.0041s/iter; left time: 1.8291s
	iters: 700, epoch: 8 | loss: 0.4672652
	speed: 0.0040s/iter; left time: 1.3748s
	iters: 800, epoch: 8 | loss: 0.3371083
	speed: 0.0040s/iter; left time: 0.9836s
	iters: 900, epoch: 8 | loss: 1.0097922
	speed: 0.0041s/iter; left time: 0.5934s
	iters: 1000, epoch: 8 | loss: 0.3627683
	speed: 0.0042s/iter; left time: 0.1916s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.285049915313721
Epoch: 8, Steps: 1045 | Train Loss: 0.3641068 Vali Loss: 0.2953471 Best vali loss: 0.2832049

best validation loss 0.2832049296974205

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0071113834238, 'e_layers': 4, 'learning_rate': 0.0001530715139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0347353
	speed: 0.0150s/iter; left time: 124.0583s
	iters: 200, epoch: 1 | loss: 1.3778374
	speed: 0.0070s/iter; left time: 56.7364s
	iters: 300, epoch: 1 | loss: 0.4484871
	speed: 0.0070s/iter; left time: 56.4175s
	iters: 400, epoch: 1 | loss: 0.3634848
	speed: 0.0082s/iter; left time: 65.6527s
	iters: 500, epoch: 1 | loss: 0.4991905
	speed: 0.0094s/iter; left time: 74.1441s
	iters: 600, epoch: 1 | loss: 0.6669850
	speed: 0.0094s/iter; left time: 73.2496s
	iters: 700, epoch: 1 | loss: 0.6935655
	speed: 0.0094s/iter; left time: 71.9594s
	iters: 800, epoch: 1 | loss: 0.2154196
	speed: 0.0095s/iter; left time: 71.6775s
	iters: 900, epoch: 1 | loss: 0.4252733
	speed: 0.0094s/iter; left time: 70.1580s
	iters: 1000, epoch: 1 | loss: 0.2043072
	speed: 0.0094s/iter; left time: 69.4436s
Updating learning rate to 0.0001472455763013635
Validation loss decreased (inf --> 0.2957).  Saving model state dict ...
Epoch: 1 cost time: 9.555090188980103
Epoch: 1, Steps: 1045 | Train Loss: 0.5929286 Vali Loss: 0.2956922 Best vali loss: 0.2956922
	iters: 100, epoch: 2 | loss: 0.3188627
	speed: 0.0283s/iter; left time: 204.0443s
	iters: 200, epoch: 2 | loss: 0.2461234
	speed: 0.0078s/iter; left time: 55.4683s
	iters: 300, epoch: 2 | loss: 0.3703886
	speed: 0.0065s/iter; left time: 45.9458s
	iters: 400, epoch: 2 | loss: 0.2261022
	speed: 0.0068s/iter; left time: 46.7084s
	iters: 500, epoch: 2 | loss: 0.2283921
	speed: 0.0094s/iter; left time: 63.7674s
	iters: 600, epoch: 2 | loss: 0.2969496
	speed: 0.0093s/iter; left time: 62.7072s
	iters: 700, epoch: 2 | loss: 0.4288467
	speed: 0.0094s/iter; left time: 61.8639s
	iters: 800, epoch: 2 | loss: 0.2883511
	speed: 0.0094s/iter; left time: 60.9557s
	iters: 900, epoch: 2 | loss: 0.2744459
	speed: 0.0094s/iter; left time: 60.1028s
	iters: 1000, epoch: 2 | loss: 0.4291531
	speed: 0.0094s/iter; left time: 59.2398s
Updating learning rate to 0.00013065470969259043
Validation loss decreased (0.2957 --> 0.2811).  Saving model state dict ...
Epoch: 2 cost time: 9.133506298065186
Epoch: 2, Steps: 1045 | Train Loss: 0.3107615 Vali Loss: 0.2811431 Best vali loss: 0.2811431
	iters: 100, epoch: 3 | loss: 0.3689490
	speed: 0.0286s/iter; left time: 176.4407s
	iters: 200, epoch: 3 | loss: 0.2391075
	speed: 0.0093s/iter; left time: 56.6327s
	iters: 300, epoch: 3 | loss: 0.3018256
	speed: 0.0068s/iter; left time: 40.6631s
	iters: 400, epoch: 3 | loss: 1.0316677
	speed: 0.0069s/iter; left time: 40.6195s
	iters: 500, epoch: 3 | loss: 0.4470127
	speed: 0.0085s/iter; left time: 48.9225s
	iters: 600, epoch: 3 | loss: 1.0246832
	speed: 0.0095s/iter; left time: 53.6944s
	iters: 700, epoch: 3 | loss: 0.3139029
	speed: 0.0095s/iter; left time: 52.7531s
	iters: 800, epoch: 3 | loss: 0.9000440
	speed: 0.0095s/iter; left time: 51.8212s
	iters: 900, epoch: 3 | loss: 0.4055191
	speed: 0.0095s/iter; left time: 50.9113s
	iters: 1000, epoch: 3 | loss: 0.2235647
	speed: 0.0060s/iter; left time: 31.4214s
Updating learning rate to 0.00010582472311828629
Validation loss decreased (0.2811 --> 0.2765).  Saving model state dict ...
Epoch: 3 cost time: 8.752416372299194
Epoch: 3, Steps: 1045 | Train Loss: 0.5256276 Vali Loss: 0.2765180 Best vali loss: 0.2765180
	iters: 100, epoch: 4 | loss: 0.1831831
	speed: 0.0196s/iter; left time: 100.2255s
	iters: 200, epoch: 4 | loss: 0.4658056
	speed: 0.0064s/iter; left time: 32.2379s
	iters: 300, epoch: 4 | loss: 0.5293064
	speed: 0.0067s/iter; left time: 33.1916s
	iters: 400, epoch: 4 | loss: 0.6437727
	speed: 0.0064s/iter; left time: 31.0101s
	iters: 500, epoch: 4 | loss: 0.4856394
	speed: 0.0050s/iter; left time: 23.6427s
	iters: 600, epoch: 4 | loss: 0.2828060
	speed: 0.0063s/iter; left time: 29.2827s
	iters: 700, epoch: 4 | loss: 0.2263026
	speed: 0.0065s/iter; left time: 29.4175s
	iters: 800, epoch: 4 | loss: 0.6758375
	speed: 0.0058s/iter; left time: 25.7805s
	iters: 900, epoch: 4 | loss: 0.4344373
	speed: 0.0051s/iter; left time: 21.9010s
	iters: 1000, epoch: 4 | loss: 0.5477504
	speed: 0.0071s/iter; left time: 29.9115s
Updating learning rate to 7.653575695e-05
Epoch: 4 cost time: 6.57948899269104
Epoch: 4, Steps: 1045 | Train Loss: 0.4474841 Vali Loss: 0.2939563 Best vali loss: 0.2765180
	iters: 100, epoch: 5 | loss: 0.2226240
	speed: 0.0200s/iter; left time: 81.6336s
	iters: 200, epoch: 5 | loss: 0.1802325
	speed: 0.0073s/iter; left time: 29.0045s
	iters: 300, epoch: 5 | loss: 0.4406786
	speed: 0.0055s/iter; left time: 21.2242s
	iters: 400, epoch: 5 | loss: 0.3137782
	speed: 0.0056s/iter; left time: 21.1284s
	iters: 500, epoch: 5 | loss: 0.1495615
	speed: 0.0071s/iter; left time: 26.2560s
	iters: 600, epoch: 5 | loss: 0.4317068
	speed: 0.0066s/iter; left time: 23.4716s
	iters: 700, epoch: 5 | loss: 0.1931317
	speed: 0.0073s/iter; left time: 25.2798s
	iters: 800, epoch: 5 | loss: 0.6588176
	speed: 0.0060s/iter; left time: 20.2491s
	iters: 900, epoch: 5 | loss: 0.2863601
	speed: 0.0067s/iter; left time: 22.1432s
	iters: 1000, epoch: 5 | loss: 0.6296928
	speed: 0.0061s/iter; left time: 19.4279s
Updating learning rate to 4.724679078171373e-05
Epoch: 5 cost time: 6.842655420303345
Epoch: 5, Steps: 1045 | Train Loss: 0.3506584 Vali Loss: 0.3052592 Best vali loss: 0.2765180
	iters: 100, epoch: 6 | loss: 0.2082292
	speed: 0.0201s/iter; left time: 61.1085s
	iters: 200, epoch: 6 | loss: 0.1431679
	speed: 0.0056s/iter; left time: 16.5332s
	iters: 300, epoch: 6 | loss: 0.2139082
	speed: 0.0065s/iter; left time: 18.3275s
	iters: 400, epoch: 6 | loss: 0.1628632
	speed: 0.0079s/iter; left time: 21.5791s
	iters: 500, epoch: 6 | loss: 0.3587361
	speed: 0.0069s/iter; left time: 18.2495s
	iters: 600, epoch: 6 | loss: 0.6502023
	speed: 0.0071s/iter; left time: 18.0294s
	iters: 700, epoch: 6 | loss: 0.4088570
	speed: 0.0074s/iter; left time: 18.0314s
	iters: 800, epoch: 6 | loss: 0.1571002
	speed: 0.0070s/iter; left time: 16.3644s
	iters: 900, epoch: 6 | loss: 0.2240321
	speed: 0.0075s/iter; left time: 16.6992s
	iters: 1000, epoch: 6 | loss: 0.2040600
	speed: 0.0066s/iter; left time: 14.0240s
Updating learning rate to 2.2416804207409573e-05
Epoch: 6 cost time: 7.334637403488159
Epoch: 6, Steps: 1045 | Train Loss: 0.2731156 Vali Loss: 0.3188553 Best vali loss: 0.2765180
	iters: 100, epoch: 7 | loss: 0.2855499
	speed: 0.0205s/iter; left time: 40.7453s
	iters: 200, epoch: 7 | loss: 0.1963649
	speed: 0.0074s/iter; left time: 13.9022s
	iters: 300, epoch: 7 | loss: 0.2757835
	speed: 0.0066s/iter; left time: 11.8459s
	iters: 400, epoch: 7 | loss: 0.4404425
	speed: 0.0073s/iter; left time: 12.3330s
	iters: 500, epoch: 7 | loss: 0.3753559
	speed: 0.0056s/iter; left time: 8.9032s
	iters: 600, epoch: 7 | loss: 0.1748189
	speed: 0.0052s/iter; left time: 7.6794s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3739571
	speed: 0.0082s/iter; left time: 16.4700s
	iters: 200, epoch: 1 | loss: 0.5345844
	speed: 0.0028s/iter; left time: 5.3113s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.3036).  Saving model state dict ...
Epoch: 1 cost time: 1.0215370655059814
Epoch: 1, Steps: 262 | Train Loss: 0.4542708 Vali Loss: 0.3035677 Best vali loss: 0.3035677
	iters: 100, epoch: 2 | loss: 0.5760306
	speed: 0.0070s/iter; left time: 12.0710s
	iters: 200, epoch: 2 | loss: 0.5790677
	speed: 0.0027s/iter; left time: 4.4531s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.3036 --> 0.2888).  Saving model state dict ...
Epoch: 2 cost time: 0.7612671852111816
Epoch: 2, Steps: 262 | Train Loss: 0.5775491 Vali Loss: 0.2887877 Best vali loss: 0.2887877
	iters: 100, epoch: 3 | loss: 0.4256814
	speed: 0.0072s/iter; left time: 10.5348s
	iters: 200, epoch: 3 | loss: 0.5596391
	speed: 0.0028s/iter; left time: 3.8919s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.2888 --> 0.2837).  Saving model state dict ...
Epoch: 3 cost time: 0.8008663654327393
Epoch: 3, Steps: 262 | Train Loss: 0.4926603 Vali Loss: 0.2837497 Best vali loss: 0.2837497

best validation loss 0.2837497321878414

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020735604228, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.3122).  Saving model state dict ...
Epoch: 1 cost time: 0.5347254276275635
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3122029 Best vali loss: 0.3122029
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.3122 --> 0.2934).  Saving model state dict ...
Epoch: 2 cost time: 0.31229567527770996
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2933761 Best vali loss: 0.2933761
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.2934 --> 0.2882).  Saving model state dict ...
Epoch: 3 cost time: 0.3081059455871582
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2881821 Best vali loss: 0.2881821

best validation loss 0.2881821264738308

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062923252341, 'e_layers': 4, 'learning_rate': 0.0001977554099, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9038277
	speed: 0.0117s/iter; left time: 11.1169s
Updating learning rate to 0.00019022879277499492
Validation loss decreased (inf --> 0.3110).  Saving model state dict ...
Epoch: 1 cost time: 1.1132469177246094
Epoch: 1, Steps: 131 | Train Loss: 0.9038277 Vali Loss: 0.3109846 Best vali loss: 0.3109846
	iters: 100, epoch: 2 | loss: 0.4492104
	speed: 0.0102s/iter; left time: 8.3350s
Updating learning rate to 0.00016879480062830765
Validation loss decreased (0.3110 --> 0.2955).  Saving model state dict ...
Epoch: 2 cost time: 0.8351497650146484
Epoch: 2, Steps: 131 | Train Loss: 0.4492104 Vali Loss: 0.2955318 Best vali loss: 0.2955318
	iters: 100, epoch: 3 | loss: 0.5763675
	speed: 0.0104s/iter; left time: 7.1231s
Updating learning rate to 0.00013671656446464863
Validation loss decreased (0.2955 --> 0.2899).  Saving model state dict ...
Epoch: 3 cost time: 0.8849446773529053
Epoch: 3, Steps: 131 | Train Loss: 0.5763675 Vali Loss: 0.2898656 Best vali loss: 0.2898656

best validation loss 0.28986555298561056

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3249016
	speed: 0.0083s/iter; left time: 10.0973s
	iters: 200, epoch: 4 | loss: 0.4504866
	speed: 0.0027s/iter; left time: 3.0113s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.2837 --> 0.2815).  Saving model state dict ...
Epoch: 4 cost time: 0.9994843006134033
Epoch: 4, Steps: 262 | Train Loss: 0.3876941 Vali Loss: 0.2815410 Best vali loss: 0.2815410
	iters: 100, epoch: 5 | loss: 0.5324888
	speed: 0.0071s/iter; left time: 6.7743s
	iters: 200, epoch: 5 | loss: 0.5317364
	speed: 0.0033s/iter; left time: 2.8199s
Updating learning rate to 1.7856066821212585e-05
Epoch: 5 cost time: 0.8648717403411865
Epoch: 5, Steps: 262 | Train Loss: 0.5321126 Vali Loss: 0.2815494 Best vali loss: 0.2815410
	iters: 100, epoch: 6 | loss: 0.4179145
	speed: 0.0074s/iter; left time: 5.0514s
	iters: 200, epoch: 6 | loss: 0.5491818
	speed: 0.0027s/iter; left time: 1.5882s
Updating learning rate to 8.472024178210777e-06
Validation loss decreased (0.2815 --> 0.2810).  Saving model state dict ...
Epoch: 6 cost time: 0.7616348266601562
Epoch: 6, Steps: 262 | Train Loss: 0.4835481 Vali Loss: 0.2810006 Best vali loss: 0.2810006
	iters: 100, epoch: 7 | loss: 0.2519539
	speed: 0.0069s/iter; left time: 2.9291s
	iters: 200, epoch: 7 | loss: 0.4580591
	speed: 0.0027s/iter; left time: 0.8800s
Updating learning rate to 2.2018073468332077e-06
Validation loss decreased (0.2810 --> 0.2808).  Saving model state dict ...
Epoch: 7 cost time: 0.7615180015563965
Epoch: 7, Steps: 262 | Train Loss: 0.3550065 Vali Loss: 0.2807668 Best vali loss: 0.2807668
	iters: 100, epoch: 8 | loss: 0.5558289
	speed: 0.0071s/iter; left time: 1.1498s
	iters: 200, epoch: 8 | loss: 0.6325914
	speed: 0.0030s/iter; left time: 0.1912s
Updating learning rate to 0.0
Validation loss decreased (0.2808 --> 0.2807).  Saving model state dict ...
Epoch: 8 cost time: 0.8212254047393799
Epoch: 8, Steps: 262 | Train Loss: 0.5942101 Vali Loss: 0.2807381 Best vali loss: 0.2807381

best validation loss 0.2807381092704065

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047327455259, 'e_layers': 4, 'learning_rate': 0.0038245816163, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6223182
	speed: 0.0116s/iter; left time: 10.9774s
Updating learning rate to 0.0038245816163
Validation loss decreased (inf --> 0.2930).  Saving model state dict ...
Epoch: 1 cost time: 1.1040012836456299
Epoch: 1, Steps: 131 | Train Loss: 0.6223182 Vali Loss: 0.2930172 Best vali loss: 0.2930172
	iters: 100, epoch: 2 | loss: 0.3170852
	speed: 0.0104s/iter; left time: 8.5060s
Updating learning rate to 0.00191229080815
Validation loss decreased (0.2930 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 0.8601851463317871
Epoch: 2, Steps: 131 | Train Loss: 0.3170852 Vali Loss: 0.2871253 Best vali loss: 0.2871253
	iters: 100, epoch: 3 | loss: 0.2951165
	speed: 0.0101s/iter; left time: 6.9338s
Updating learning rate to 0.000956145404075
Epoch: 3 cost time: 0.8492920398712158
Epoch: 3, Steps: 131 | Train Loss: 0.2951165 Vali Loss: 0.3128140 Best vali loss: 0.2871253
	iters: 100, epoch: 4 | loss: 0.4828746
	speed: 0.0102s/iter; left time: 5.6811s
Updating learning rate to 0.0004780727020375
Epoch: 4 cost time: 0.8465104103088379
Epoch: 4, Steps: 131 | Train Loss: 0.4828746 Vali Loss: 0.3071511 Best vali loss: 0.2871253
	iters: 100, epoch: 5 | loss: 0.5867450
	speed: 0.0101s/iter; left time: 4.2715s
Updating learning rate to 0.00023903635101875
Epoch: 5 cost time: 0.8389439582824707
Epoch: 5, Steps: 131 | Train Loss: 0.5867450 Vali Loss: 0.3044873 Best vali loss: 0.2871253
	iters: 100, epoch: 6 | loss: 0.3507658
	speed: 0.0099s/iter; left time: 2.9071s
Updating learning rate to 0.000119518175509375
Epoch: 6 cost time: 0.8221259117126465
Epoch: 6, Steps: 131 | Train Loss: 0.3507658 Vali Loss: 0.3101267 Best vali loss: 0.2871253
	iters: 100, epoch: 7 | loss: 0.3706210
	speed: 0.0099s/iter; left time: 1.6159s
Updating learning rate to 5.97590877546875e-05
Epoch: 7 cost time: 0.8563332557678223
Epoch: 7, Steps: 131 | Train Loss: 0.3706210 Vali Loss: 0.3112837 Best vali loss: 0.2871253
	iters: 100, epoch: 8 | loss: 0.4209192
	speed: 0.0108s/iter; left time: 0.3468s
Updating learning rate to 2.987954387734375e-05
Epoch: 8 cost time: 0.917055606842041
Epoch: 8, Steps: 131 | Train Loss: 0.4209192 Vali Loss: 0.3069898 Best vali loss: 0.2871253

best validation loss 0.2871253385934833

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0036637688578, 'e_layers': 3, 'learning_rate': 0.0032858943573, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3177709
	speed: 0.0095s/iter; left time: 38.7195s
	iters: 200, epoch: 1 | loss: 0.5100198
	speed: 0.0044s/iter; left time: 17.6393s
	iters: 300, epoch: 1 | loss: 1.2986110
	speed: 0.0053s/iter; left time: 20.4271s
	iters: 400, epoch: 1 | loss: 0.2524706
	speed: 0.0053s/iter; left time: 20.0645s
	iters: 500, epoch: 1 | loss: 0.3169279
	speed: 0.0049s/iter; left time: 18.0664s
Updating learning rate to 0.0032858943573
Validation loss decreased (inf --> 0.3202).  Saving model state dict ...
Epoch: 1 cost time: 2.7676963806152344
Epoch: 1, Steps: 523 | Train Loss: 0.5391601 Vali Loss: 0.3202158 Best vali loss: 0.3202158
	iters: 100, epoch: 2 | loss: 0.7535517
	speed: 0.0094s/iter; left time: 33.3603s
	iters: 200, epoch: 2 | loss: 0.2642680
	speed: 0.0051s/iter; left time: 17.6037s
	iters: 300, epoch: 2 | loss: 0.4897906
	speed: 0.0051s/iter; left time: 17.1735s
	iters: 400, epoch: 2 | loss: 0.9160317
	speed: 0.0046s/iter; left time: 14.9993s
	iters: 500, epoch: 2 | loss: 0.3872905
	speed: 0.0040s/iter; left time: 12.7702s
Updating learning rate to 0.00164294717865
Epoch: 2 cost time: 2.4969263076782227
Epoch: 2, Steps: 523 | Train Loss: 0.5621865 Vali Loss: 0.3248012 Best vali loss: 0.3202158
	iters: 100, epoch: 3 | loss: 0.6282520
	speed: 0.0109s/iter; left time: 33.0952s
	iters: 200, epoch: 3 | loss: 0.8059250
	speed: 0.0054s/iter; left time: 15.8546s
	iters: 300, epoch: 3 | loss: 0.2186769
	speed: 0.0054s/iter; left time: 15.3224s
	iters: 400, epoch: 3 | loss: 0.8030217
	speed: 0.0054s/iter; left time: 14.8433s
	iters: 500, epoch: 3 | loss: 0.5357708
	speed: 0.0054s/iter; left time: 14.2711s
Updating learning rate to 0.000821473589325
Epoch: 3 cost time: 2.8758206367492676
Epoch: 3, Steps: 523 | Train Loss: 0.5983293 Vali Loss: 0.3223144 Best vali loss: 0.3202158
	iters: 100, epoch: 4 | loss: 0.6776704
	speed: 0.0114s/iter; left time: 28.7959s
	iters: 200, epoch: 4 | loss: 0.3867825
	speed: 0.0053s/iter; left time: 12.8915s
	iters: 300, epoch: 4 | loss: 0.5848479
	speed: 0.0052s/iter; left time: 12.1226s
	iters: 400, epoch: 4 | loss: 0.5039039
	speed: 0.0049s/iter; left time: 10.9434s
	iters: 500, epoch: 4 | loss: 0.4337664
	speed: 0.0048s/iter; left time: 10.1804s
Updating learning rate to 0.0004107367946625
Epoch: 4 cost time: 2.720731496810913
Epoch: 4, Steps: 523 | Train Loss: 0.5173942 Vali Loss: 0.3222946 Best vali loss: 0.3202158
	iters: 100, epoch: 5 | loss: 0.3775810
	speed: 0.0111s/iter; left time: 22.0392s
	iters: 200, epoch: 5 | loss: 0.4541596
	speed: 0.0053s/iter; left time: 10.0937s
	iters: 300, epoch: 5 | loss: 0.3548668
	speed: 0.0053s/iter; left time: 9.4778s
	iters: 400, epoch: 5 | loss: 0.6388496
	speed: 0.0053s/iter; left time: 9.0073s
	iters: 500, epoch: 5 | loss: 0.8897340
	speed: 0.0053s/iter; left time: 8.3887s
Updating learning rate to 0.00020536839733125
Epoch: 5 cost time: 2.810763120651245
Epoch: 5, Steps: 523 | Train Loss: 0.5430382 Vali Loss: 0.3223848 Best vali loss: 0.3202158
	iters: 100, epoch: 6 | loss: 0.9012074
	speed: 0.0115s/iter; left time: 16.9251s
	iters: 200, epoch: 6 | loss: 0.3992704
	speed: 0.0057s/iter; left time: 7.7599s
	iters: 300, epoch: 6 | loss: 1.9014735
	speed: 0.0056s/iter; left time: 7.1730s
	iters: 400, epoch: 6 | loss: 1.1818314
	speed: 0.0053s/iter; left time: 6.2591s
	iters: 500, epoch: 6 | loss: 0.4615374
	speed: 0.0052s/iter; left time: 5.6130s
Updating learning rate to 0.000102684198665625
Epoch: 6 cost time: 2.904776096343994
Epoch: 6, Steps: 523 | Train Loss: 0.9690640 Vali Loss: 0.3223813 Best vali loss: 0.3202158
	iters: 100, epoch: 7 | loss: 0.8765633
	speed: 0.0112s/iter; left time: 10.6028s
	iters: 200, epoch: 7 | loss: 0.3440019
	speed: 0.0055s/iter; left time: 4.6180s
	iters: 300, epoch: 7 | loss: 0.2258206
	speed: 0.0055s/iter; left time: 4.0800s
	iters: 400, epoch: 7 | loss: 0.4104117
	speed: 0.0052s/iter; left time: 3.3780s
	iters: 500, epoch: 7 | loss: 0.3659330
	speed: 0.0051s/iter; left time: 2.8133s
Updating learning rate to 5.13420993328125e-05
Epoch: 7 cost time: 2.8313992023468018
Epoch: 7, Steps: 523 | Train Loss: 0.4445461 Vali Loss: 0.3223344 Best vali loss: 0.3202158
	iters: 100, epoch: 8 | loss: 0.6886712
	speed: 0.0113s/iter; left time: 4.7943s
	iters: 200, epoch: 8 | loss: 0.8246976
	speed: 0.0054s/iter; left time: 1.7414s
	iters: 300, epoch: 8 | loss: 0.7682173
	speed: 0.0054s/iter; left time: 1.2022s
	iters: 400, epoch: 8 | loss: 0.7315001
	speed: 0.0050s/iter; left time: 0.6247s
	iters: 500, epoch: 8 | loss: 0.7379228
	speed: 0.0047s/iter; left time: 0.1128s
Updating learning rate to 2.567104966640625e-05
Epoch: 8 cost time: 2.7205605506896973
Epoch: 8, Steps: 523 | Train Loss: 0.7502018 Vali Loss: 0.3222960 Best vali loss: 0.3202158

best validation loss 0.3202158330142077

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029231680578149597
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 0.7701683044433594
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2844891 Best vali loss: 0.2844891
Updating learning rate to 0.0025938006666821026
Epoch: 2 cost time: 0.5268967151641846
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2979211 Best vali loss: 0.2844891
Updating learning rate to 0.0021008675310785706
Epoch: 3 cost time: 0.5164868831634521
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2966625 Best vali loss: 0.2844891

best validation loss 0.284489135919073

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0118662500741, 'e_layers': 3, 'learning_rate': 0.0003750615196, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036078659049551044
Validation loss decreased (inf --> 0.3099).  Saving model state dict ...
Epoch: 1 cost time: 0.6376051902770996
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3098542 Best vali loss: 0.3098542
Updating learning rate to 0.0003201350317356456
Validation loss decreased (0.3099 --> 0.2950).  Saving model state dict ...
Epoch: 2 cost time: 0.41838836669921875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2949947 Best vali loss: 0.2949947
Updating learning rate to 0.0002592956746342972
Validation loss decreased (0.2950 --> 0.2884).  Saving model state dict ...
Epoch: 3 cost time: 0.41925930976867676
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2883537 Best vali loss: 0.2883537

best validation loss 0.288353663288381

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047627831688, 'e_layers': 3, 'learning_rate': 0.0015982189843, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3456314
	speed: 0.0100s/iter; left time: 82.7193s
	iters: 200, epoch: 1 | loss: 0.6194373
	speed: 0.0047s/iter; left time: 38.1413s
	iters: 300, epoch: 1 | loss: 1.4261161
	speed: 0.0048s/iter; left time: 38.5541s
	iters: 400, epoch: 1 | loss: 0.5088022
	speed: 0.0044s/iter; left time: 35.1568s
	iters: 500, epoch: 1 | loss: 0.3765837
	speed: 0.0045s/iter; left time: 35.3511s
	iters: 600, epoch: 1 | loss: 0.3999020
	speed: 0.0051s/iter; left time: 39.4043s
	iters: 700, epoch: 1 | loss: 0.2831392
	speed: 0.0050s/iter; left time: 38.3050s
	iters: 800, epoch: 1 | loss: 0.2828292
	speed: 0.0047s/iter; left time: 35.8861s
	iters: 900, epoch: 1 | loss: 0.3217676
	speed: 0.0048s/iter; left time: 35.6434s
	iters: 1000, epoch: 1 | loss: 1.4525586
	speed: 0.0051s/iter; left time: 37.3716s
Updating learning rate to 0.0015373903961828739
Validation loss decreased (inf --> 0.3097).  Saving model state dict ...
Epoch: 1 cost time: 5.291693210601807
Epoch: 1, Steps: 1045 | Train Loss: 0.6016767 Vali Loss: 0.3097461 Best vali loss: 0.3097461
	iters: 100, epoch: 2 | loss: 0.3757499
	speed: 0.0160s/iter; left time: 115.2632s
	iters: 200, epoch: 2 | loss: 0.4093737
	speed: 0.0053s/iter; left time: 37.9945s
	iters: 300, epoch: 2 | loss: 0.4520491
	speed: 0.0055s/iter; left time: 38.9093s
	iters: 400, epoch: 2 | loss: 0.2616598
	speed: 0.0057s/iter; left time: 39.4911s
	iters: 500, epoch: 2 | loss: 0.3048305
	speed: 0.0054s/iter; left time: 36.9766s
	iters: 600, epoch: 2 | loss: 0.3881748
	speed: 0.0047s/iter; left time: 31.2948s
	iters: 700, epoch: 2 | loss: 0.2896648
	speed: 0.0047s/iter; left time: 30.7884s
	iters: 800, epoch: 2 | loss: 0.1628267
	speed: 0.0047s/iter; left time: 30.3113s
	iters: 900, epoch: 2 | loss: 0.6643897
	speed: 0.0046s/iter; left time: 29.4536s
	iters: 1000, epoch: 2 | loss: 0.2208657
	speed: 0.0046s/iter; left time: 29.1558s
Updating learning rate to 0.0013641652329598032
Epoch: 2 cost time: 5.275823354721069
Epoch: 2, Steps: 1045 | Train Loss: 0.3529585 Vali Loss: 0.3110729 Best vali loss: 0.3097461
	iters: 100, epoch: 3 | loss: 0.4583759
	speed: 0.0164s/iter; left time: 101.1622s
	iters: 200, epoch: 3 | loss: 0.3791716
	speed: 0.0050s/iter; left time: 30.4237s
	iters: 300, epoch: 3 | loss: 0.6724328
	speed: 0.0050s/iter; left time: 29.9256s
	iters: 400, epoch: 3 | loss: 1.4157500
	speed: 0.0047s/iter; left time: 27.8753s
	iters: 500, epoch: 3 | loss: 0.4610542
	speed: 0.0048s/iter; left time: 27.9328s
	iters: 600, epoch: 3 | loss: 1.4844120
	speed: 0.0049s/iter; left time: 27.8826s
	iters: 700, epoch: 3 | loss: 1.2955173
	speed: 0.0050s/iter; left time: 28.0246s
	iters: 800, epoch: 3 | loss: 0.3123829
	speed: 0.0049s/iter; left time: 26.9829s
	iters: 900, epoch: 3 | loss: 0.3285400
	speed: 0.0050s/iter; left time: 26.6211s
	iters: 1000, epoch: 3 | loss: 0.3582954
	speed: 0.0050s/iter; left time: 26.0951s
Updating learning rate to 0.0011049154554414859
Validation loss decreased (0.3097 --> 0.3093).  Saving model state dict ...
Epoch: 3 cost time: 5.214425325393677
Epoch: 3, Steps: 1045 | Train Loss: 0.7165932 Vali Loss: 0.3093359 Best vali loss: 0.3093359

best validation loss 0.3093358526534864

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00151941325245
Epoch: 4 cost time: 0.6389522552490234
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2916532 Best vali loss: 0.2844891
Updating learning rate to 0.0009379589738214294
Epoch: 5 cost time: 0.43271827697753906
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2945779 Best vali loss: 0.2844891
Updating learning rate to 0.0004450258382178974
Epoch: 6 cost time: 0.4947848320007324
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3040063 Best vali loss: 0.2844891
Updating learning rate to 0.0001156584470850403
Epoch: 7 cost time: 0.43303346633911133
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3011893 Best vali loss: 0.2844891
Updating learning rate to 0.0
Epoch: 8 cost time: 0.44130587577819824
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2997112 Best vali loss: 0.2844891

best validation loss 0.284489135919073

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0013602383229, 'e_layers': 1, 'learning_rate': 0.0004227075832, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2927373
	speed: 0.0085s/iter; left time: 70.2675s
	iters: 200, epoch: 1 | loss: 0.2847356
	speed: 0.0031s/iter; left time: 25.5780s
	iters: 300, epoch: 1 | loss: 1.2182968
	speed: 0.0032s/iter; left time: 25.7947s
	iters: 400, epoch: 1 | loss: 0.2678319
	speed: 0.0031s/iter; left time: 24.6272s
	iters: 500, epoch: 1 | loss: 1.5518409
	speed: 0.0031s/iter; left time: 24.0942s
	iters: 600, epoch: 1 | loss: 0.2766273
	speed: 0.0032s/iter; left time: 24.5016s
	iters: 700, epoch: 1 | loss: 0.2707927
	speed: 0.0032s/iter; left time: 24.2806s
	iters: 800, epoch: 1 | loss: 0.2746958
	speed: 0.0029s/iter; left time: 21.5709s
	iters: 900, epoch: 1 | loss: 0.1975908
	speed: 0.0023s/iter; left time: 17.4791s
	iters: 1000, epoch: 1 | loss: 0.5066796
	speed: 0.0024s/iter; left time: 17.5118s
Updating learning rate to 0.0004227075832
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 3.3309648036956787
Epoch: 1, Steps: 1045 | Train Loss: 0.5141829 Vali Loss: 0.2813525 Best vali loss: 0.2813525
	iters: 100, epoch: 2 | loss: 1.0725453
	speed: 0.0113s/iter; left time: 81.7037s
	iters: 200, epoch: 2 | loss: 0.4743695
	speed: 0.0031s/iter; left time: 21.8911s
	iters: 300, epoch: 2 | loss: 0.3736897
	speed: 0.0031s/iter; left time: 21.5886s
	iters: 400, epoch: 2 | loss: 0.3027532
	speed: 0.0030s/iter; left time: 21.0918s
	iters: 500, epoch: 2 | loss: 0.2969264
	speed: 0.0031s/iter; left time: 21.0051s
	iters: 600, epoch: 2 | loss: 0.5306447
	speed: 0.0031s/iter; left time: 20.6438s
	iters: 700, epoch: 2 | loss: 0.3464064
	speed: 0.0030s/iter; left time: 19.9920s
	iters: 800, epoch: 2 | loss: 0.2555178
	speed: 0.0032s/iter; left time: 20.9295s
	iters: 900, epoch: 2 | loss: 0.6718009
	speed: 0.0028s/iter; left time: 18.1419s
	iters: 1000, epoch: 2 | loss: 0.2026015
	speed: 0.0027s/iter; left time: 17.2409s
Updating learning rate to 0.0002113537916
Epoch: 2 cost time: 3.199057102203369
Epoch: 2, Steps: 1045 | Train Loss: 0.4527255 Vali Loss: 0.2858851 Best vali loss: 0.2813525
	iters: 100, epoch: 3 | loss: 0.3010548
	speed: 0.0086s/iter; left time: 52.9761s
	iters: 200, epoch: 3 | loss: 0.4308450
	speed: 0.0024s/iter; left time: 14.7028s
	iters: 300, epoch: 3 | loss: 0.4792958
	speed: 0.0031s/iter; left time: 18.3745s
	iters: 400, epoch: 3 | loss: 0.3683090
	speed: 0.0031s/iter; left time: 17.9700s
	iters: 500, epoch: 3 | loss: 0.3309884
	speed: 0.0033s/iter; left time: 18.7781s
	iters: 600, epoch: 3 | loss: 0.6303920
	speed: 0.0030s/iter; left time: 17.1635s
	iters: 700, epoch: 3 | loss: 0.4478395
	speed: 0.0025s/iter; left time: 13.9718s
	iters: 800, epoch: 3 | loss: 1.1700550
	speed: 0.0032s/iter; left time: 17.3535s
	iters: 900, epoch: 3 | loss: 0.3850287
	speed: 0.0032s/iter; left time: 17.3565s
	iters: 1000, epoch: 3 | loss: 0.3027028
	speed: 0.0032s/iter; left time: 17.0307s
Updating learning rate to 0.0001056768958
Epoch: 3 cost time: 3.1182103157043457
Epoch: 3, Steps: 1045 | Train Loss: 0.4846511 Vali Loss: 0.2882886 Best vali loss: 0.2813525
	iters: 100, epoch: 4 | loss: 0.4462199
	speed: 0.0110s/iter; left time: 56.5953s
	iters: 200, epoch: 4 | loss: 0.2520882
	speed: 0.0033s/iter; left time: 16.5743s
	iters: 300, epoch: 4 | loss: 0.1532318
	speed: 0.0033s/iter; left time: 16.3653s
	iters: 400, epoch: 4 | loss: 0.1762446
	speed: 0.0027s/iter; left time: 13.0795s
	iters: 500, epoch: 4 | loss: 0.2656897
	speed: 0.0032s/iter; left time: 15.0327s
	iters: 600, epoch: 4 | loss: 0.2886161
	speed: 0.0032s/iter; left time: 14.6594s
	iters: 700, epoch: 4 | loss: 0.3667814
	speed: 0.0032s/iter; left time: 14.3507s
	iters: 800, epoch: 4 | loss: 0.2229310
	speed: 0.0032s/iter; left time: 14.0430s
	iters: 900, epoch: 4 | loss: 0.3994882
	speed: 0.0028s/iter; left time: 12.3262s
	iters: 1000, epoch: 4 | loss: 0.5951764
	speed: 0.0029s/iter; left time: 12.2627s
Updating learning rate to 5.28384479e-05
Epoch: 4 cost time: 3.280442476272583
Epoch: 4, Steps: 1045 | Train Loss: 0.3166467 Vali Loss: 0.2923917 Best vali loss: 0.2813525
	iters: 100, epoch: 5 | loss: 0.2283742
	speed: 0.0116s/iter; left time: 47.3976s
	iters: 200, epoch: 5 | loss: 0.5324989
	speed: 0.0030s/iter; left time: 11.7970s
	iters: 300, epoch: 5 | loss: 0.3947540
	speed: 0.0032s/iter; left time: 12.5782s
	iters: 400, epoch: 5 | loss: 0.6477770
	speed: 0.0033s/iter; left time: 12.4671s
	iters: 500, epoch: 5 | loss: 0.7087433
	speed: 0.0033s/iter; left time: 12.0396s
	iters: 600, epoch: 5 | loss: 0.2546003
	speed: 0.0030s/iter; left time: 10.6392s
	iters: 700, epoch: 5 | loss: 0.1797115
	speed: 0.0028s/iter; left time: 9.7095s
	iters: 800, epoch: 5 | loss: 0.2463692
	speed: 0.0028s/iter; left time: 9.4352s
	iters: 900, epoch: 5 | loss: 0.2885793
	speed: 0.0029s/iter; left time: 9.5380s
	iters: 1000, epoch: 5 | loss: 0.4454895
	speed: 0.0028s/iter; left time: 8.9673s
Updating learning rate to 2.641922395e-05
Epoch: 5 cost time: 3.1597976684570312
Epoch: 5, Steps: 1045 | Train Loss: 0.3926897 Vali Loss: 0.2980961 Best vali loss: 0.2813525
	iters: 100, epoch: 6 | loss: 0.1469164
	speed: 0.0112s/iter; left time: 33.9080s
	iters: 200, epoch: 6 | loss: 0.1654114
	speed: 0.0029s/iter; left time: 8.5607s
	iters: 300, epoch: 6 | loss: 0.6616565
	speed: 0.0028s/iter; left time: 8.0731s
	iters: 400, epoch: 6 | loss: 0.4262793
	speed: 0.0025s/iter; left time: 6.9689s
	iters: 500, epoch: 6 | loss: 0.3474383
	speed: 0.0021s/iter; left time: 5.5493s
	iters: 600, epoch: 6 | loss: 0.4548902
	speed: 0.0021s/iter; left time: 5.2813s
	iters: 700, epoch: 6 | loss: 0.3917390
	speed: 0.0022s/iter; left time: 5.3472s
	iters: 800, epoch: 6 | loss: 0.1741660
	speed: 0.0025s/iter; left time: 5.9401s
	iters: 900, epoch: 6 | loss: 0.8160695
	speed: 0.0030s/iter; left time: 6.7138s
	iters: 1000, epoch: 6 | loss: 0.3045810
	speed: 0.0029s/iter; left time: 6.1092s
Updating learning rate to 1.3209611975e-05
Epoch: 6 cost time: 2.7650644779205322
Epoch: 6, Steps: 1045 | Train Loss: 0.3889148 Vali Loss: 0.2968076 Best vali loss: 0.2813525
	iters: 100, epoch: 7 | loss: 0.2797472
	speed: 0.0112s/iter; left time: 22.3405s
	iters: 200, epoch: 7 | loss: 0.4080052
	speed: 0.0028s/iter; left time: 5.3864s
	iters: 300, epoch: 7 | loss: 0.2189255
	speed: 0.0022s/iter; left time: 3.8918s
	iters: 400, epoch: 7 | loss: 0.4081308
	speed: 0.0022s/iter; left time: 3.6762s
	iters: 500, epoch: 7 | loss: 0.2779137
	speed: 0.0022s/iter; left time: 3.4860s
	iters: 600, epoch: 7 | loss: 0.2914640
	speed: 0.0024s/iter; left time: 3.5287s
	iters: 700, epoch: 7 | loss: 0.2627251
	speed: 0.0032s/iter; left time: 4.5060s
	iters: 800, epoch: 7 | loss: 0.3133622
	speed: 0.0028s/iter; left time: 3.5619s
	iters: 900, epoch: 7 | loss: 0.8123163
	speed: 0.0033s/iter; left time: 3.9761s
	iters: 1000, epoch: 7 | loss: 0.8017671
	speed: 0.0029s/iter; left time: 3.1182s
Updating learning rate to 6.6048059875e-06
Epoch: 7 cost time: 2.8890788555145264
Epoch: 7, Steps: 1045 | Train Loss: 0.4074357 Vali Loss: 0.2997522 Best vali loss: 0.2813525
	iters: 100, epoch: 8 | loss: 0.3460066
	speed: 0.0096s/iter; left time: 9.0638s
	iters: 200, epoch: 8 | loss: 0.2765963
	speed: 0.0022s/iter; left time: 1.8994s
	iters: 300, epoch: 8 | loss: 0.4725455
	speed: 0.0025s/iter; left time: 1.8711s
	iters: 400, epoch: 8 | loss: 0.3384655
	speed: 0.0028s/iter; left time: 1.8179s
	iters: 500, epoch: 8 | loss: 0.3712249
	speed: 0.0029s/iter; left time: 1.5599s
	iters: 600, epoch: 8 | loss: 0.1660957
	speed: 0.0026s/iter; left time: 1.1577s
	iters: 700, epoch: 8 | loss: 0.3885205
	speed: 0.0028s/iter; left time: 0.9715s
	iters: 800, epoch: 8 | loss: 0.1637577
	speed: 0.0030s/iter; left time: 0.7382s
	iters: 900, epoch: 8 | loss: 0.3451452
	speed: 0.0029s/iter; left time: 0.4203s
	iters: 1000, epoch: 8 | loss: 0.2207006
	speed: 0.0027s/iter; left time: 0.1253s
Updating learning rate to 3.30240299375e-06
Epoch: 8 cost time: 2.825617551803589
Epoch: 8, Steps: 1045 | Train Loss: 0.3089059 Vali Loss: 0.2980310 Best vali loss: 0.2813525

best validation loss 0.2813524536015421

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010436703114, 'e_layers': 3, 'learning_rate': 0.0001549877333, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4843147
	speed: 0.0098s/iter; left time: 19.6168s
	iters: 200, epoch: 1 | loss: 0.4015215
	speed: 0.0045s/iter; left time: 8.5608s
Updating learning rate to 0.0001549877333
Validation loss decreased (inf --> 0.2909).  Saving model state dict ...
Epoch: 1 cost time: 1.4631257057189941
Epoch: 1, Steps: 262 | Train Loss: 0.4429181 Vali Loss: 0.2908886 Best vali loss: 0.2908886
	iters: 100, epoch: 2 | loss: 0.6826084
	speed: 0.0109s/iter; left time: 18.9750s
	iters: 200, epoch: 2 | loss: 0.3412239
	speed: 0.0052s/iter; left time: 8.5748s
Updating learning rate to 7.749386665e-05
Validation loss decreased (0.2909 --> 0.2828).  Saving model state dict ...
Epoch: 2 cost time: 1.3768501281738281
Epoch: 2, Steps: 262 | Train Loss: 0.5119161 Vali Loss: 0.2828251 Best vali loss: 0.2828251
	iters: 100, epoch: 3 | loss: 0.4750421
	speed: 0.0104s/iter; left time: 15.3505s
	iters: 200, epoch: 3 | loss: 0.3359601
	speed: 0.0046s/iter; left time: 6.3382s
Updating learning rate to 3.8746933325e-05
Validation loss decreased (0.2828 --> 0.2819).  Saving model state dict ...
Epoch: 3 cost time: 1.2783784866333008
Epoch: 3, Steps: 262 | Train Loss: 0.4055011 Vali Loss: 0.2818931 Best vali loss: 0.2818931
	iters: 100, epoch: 4 | loss: 0.5651632
	speed: 0.0104s/iter; left time: 12.5452s
	iters: 200, epoch: 4 | loss: 0.3802795
	speed: 0.0045s/iter; left time: 5.0174s
Updating learning rate to 1.93734666625e-05
Validation loss decreased (0.2819 --> 0.2818).  Saving model state dict ...
Epoch: 4 cost time: 1.3239552974700928
Epoch: 4, Steps: 262 | Train Loss: 0.4727214 Vali Loss: 0.2818333 Best vali loss: 0.2818333
	iters: 100, epoch: 5 | loss: 0.3651850
	speed: 0.0134s/iter; left time: 12.7479s
	iters: 200, epoch: 5 | loss: 0.6090442
	speed: 0.0057s/iter; left time: 4.8712s
Updating learning rate to 9.68673333125e-06
Validation loss decreased (0.2818 --> 0.2817).  Saving model state dict ...
Epoch: 5 cost time: 1.5765762329101562
Epoch: 5, Steps: 262 | Train Loss: 0.4871146 Vali Loss: 0.2817148 Best vali loss: 0.2817148
	iters: 100, epoch: 6 | loss: 0.2620395
	speed: 0.0134s/iter; left time: 9.2395s
	iters: 200, epoch: 6 | loss: 0.3520226
	speed: 0.0056s/iter; left time: 3.2744s
Updating learning rate to 4.843366665625e-06
Epoch: 6 cost time: 1.5604963302612305
Epoch: 6, Steps: 262 | Train Loss: 0.3070310 Vali Loss: 0.2817563 Best vali loss: 0.2817148
	iters: 100, epoch: 7 | loss: 0.5779186
	speed: 0.0105s/iter; left time: 4.4618s
	iters: 200, epoch: 7 | loss: 0.7658541
	speed: 0.0065s/iter; left time: 2.1027s
Updating learning rate to 2.4216833328125e-06
Epoch: 7 cost time: 1.5254156589508057
Epoch: 7, Steps: 262 | Train Loss: 0.6718864 Vali Loss: 0.2818362 Best vali loss: 0.2817148
	iters: 100, epoch: 8 | loss: 0.6727694
	speed: 0.0140s/iter; left time: 2.2877s
	iters: 200, epoch: 8 | loss: 0.2921755
	speed: 0.0064s/iter; left time: 0.4003s
Updating learning rate to 1.21084166640625e-06
Epoch: 8 cost time: 1.7450921535491943
Epoch: 8, Steps: 262 | Train Loss: 0.4824724 Vali Loss: 0.2818015 Best vali loss: 0.2817148

best validation loss 0.28171476311690746

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.010984893356, 'e_layers': 2, 'learning_rate': 0.001815341793, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4972275
	speed: 0.0116s/iter; left time: 11.0491s
Updating learning rate to 0.001815341793
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 1.0720505714416504
Epoch: 1, Steps: 131 | Train Loss: 0.4972275 Vali Loss: 0.2849166 Best vali loss: 0.2849166
	iters: 100, epoch: 2 | loss: 0.4814841
	speed: 0.0103s/iter; left time: 8.4440s
Updating learning rate to 0.0009076708965
Epoch: 2 cost time: 0.8215413093566895
Epoch: 2, Steps: 131 | Train Loss: 0.4814841 Vali Loss: 0.2951248 Best vali loss: 0.2849166
	iters: 100, epoch: 3 | loss: 0.4139850
	speed: 0.0101s/iter; left time: 6.9084s
Updating learning rate to 0.00045383544825
Epoch: 3 cost time: 0.8119411468505859
Epoch: 3, Steps: 131 | Train Loss: 0.4139850 Vali Loss: 0.2923268 Best vali loss: 0.2849166

best validation loss 0.28491664805590505

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0018477877600639972
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 0.775367021560669
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2875125 Best vali loss: 0.2875125
Updating learning rate to 0.0016395886343680123
Validation loss decreased (0.2875 --> 0.2860).  Saving model state dict ...
Epoch: 2 cost time: 0.46626901626586914
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2859536 Best vali loss: 0.2859536
Updating learning rate to 0.0013279966230694852
Epoch: 3 cost time: 0.6341722011566162
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3155336 Best vali loss: 0.2859536

best validation loss 0.2859536367872028

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5856238
	speed: 0.0084s/iter; left time: 16.7126s
	iters: 200, epoch: 1 | loss: 0.9246839
	speed: 0.0025s/iter; left time: 4.7810s
Updating learning rate to 0.0006618030633303181
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 0.9463884830474854
Epoch: 1, Steps: 262 | Train Loss: 0.7551539 Vali Loss: 0.2821055 Best vali loss: 0.2821055
	iters: 100, epoch: 2 | loss: 0.4246677
	speed: 0.0071s/iter; left time: 12.3970s
	iters: 200, epoch: 2 | loss: 0.4430466
	speed: 0.0029s/iter; left time: 4.8028s
Updating learning rate to 0.0005872345321676674
Validation loss decreased (0.2821 --> 0.2804).  Saving model state dict ...
Epoch: 2 cost time: 0.827669620513916
Epoch: 2, Steps: 262 | Train Loss: 0.4338571 Vali Loss: 0.2804005 Best vali loss: 0.2804005
	iters: 100, epoch: 3 | loss: 0.4099523
	speed: 0.0073s/iter; left time: 10.7147s
	iters: 200, epoch: 3 | loss: 0.3627608
	speed: 0.0029s/iter; left time: 3.9320s
Updating learning rate to 0.0004756348387161433
Epoch: 3 cost time: 0.801563024520874
Epoch: 3, Steps: 262 | Train Loss: 0.3863566 Vali Loss: 0.2850630 Best vali loss: 0.2804005

best validation loss 0.2804005413460616

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4962224
	speed: 0.0083s/iter; left time: 10.0701s
	iters: 200, epoch: 4 | loss: 0.7136126
	speed: 0.0029s/iter; left time: 3.2315s
Updating learning rate to 0.00034399402465
Epoch: 4 cost time: 1.0309858322143555
Epoch: 4, Steps: 262 | Train Loss: 0.6049175 Vali Loss: 0.2937737 Best vali loss: 0.2804005
	iters: 100, epoch: 5 | loss: 0.4015040
	speed: 0.0070s/iter; left time: 6.5972s
	iters: 200, epoch: 5 | loss: 0.3431883
	speed: 0.0028s/iter; left time: 2.3387s
Updating learning rate to 0.00021235321058385673
Epoch: 5 cost time: 0.7793161869049072
Epoch: 5, Steps: 262 | Train Loss: 0.3723461 Vali Loss: 0.2953155 Best vali loss: 0.2804005
	iters: 100, epoch: 6 | loss: 0.3406821
	speed: 0.0076s/iter; left time: 5.2292s
	iters: 200, epoch: 6 | loss: 0.3465636
	speed: 0.0034s/iter; left time: 2.0225s
Updating learning rate to 0.00010075351713233263
Epoch: 6 cost time: 0.9590888023376465
Epoch: 6, Steps: 262 | Train Loss: 0.3436228 Vali Loss: 0.2983912 Best vali loss: 0.2804005
	iters: 100, epoch: 7 | loss: 0.3566679
	speed: 0.0076s/iter; left time: 3.2377s
	iters: 200, epoch: 7 | loss: 0.4286885
	speed: 0.0028s/iter; left time: 0.9228s
Updating learning rate to 2.6184985969681952e-05
Epoch: 7 cost time: 0.7867846488952637
Epoch: 7, Steps: 262 | Train Loss: 0.3926782 Vali Loss: 0.3002194 Best vali loss: 0.2804005
	iters: 100, epoch: 8 | loss: 0.6750600
	speed: 0.0073s/iter; left time: 1.1832s
	iters: 200, epoch: 8 | loss: 0.3757658
	speed: 0.0032s/iter; left time: 0.2034s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8837475776672363
Epoch: 8, Steps: 262 | Train Loss: 0.5254129 Vali Loss: 0.3016380 Best vali loss: 0.2804005

best validation loss 0.2804005413460616

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032599720922, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.3274).  Saving model state dict ...
Epoch: 1 cost time: 0.5334150791168213
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3273864 Best vali loss: 0.3273864
Updating learning rate to 0.0002152265254906771
Validation loss decreased (0.3274 --> 0.3090).  Saving model state dict ...
Epoch: 2 cost time: 0.31532835960388184
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3089525 Best vali loss: 0.3089525
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.3090 --> 0.2996).  Saving model state dict ...
Epoch: 3 cost time: 0.3116025924682617
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2995876 Best vali loss: 0.2995876
Updating learning rate to 0.00012607677965
Validation loss decreased (0.2996 --> 0.2941).  Saving model state dict ...
Epoch: 4 cost time: 0.29413914680480957
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2940694 Best vali loss: 0.2940694
Updating learning rate to 7.782928487200091e-05
Validation loss decreased (0.2941 --> 0.2916).  Saving model state dict ...
Epoch: 5 cost time: 0.2971775531768799
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2915830 Best vali loss: 0.2915830
Updating learning rate to 3.692703380932289e-05
Validation loss decreased (0.2916 --> 0.2905).  Saving model state dict ...
Epoch: 6 cost time: 0.3093850612640381
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2904890 Best vali loss: 0.2904890
Updating learning rate to 9.59702340642949e-06
Validation loss decreased (0.2905 --> 0.2899).  Saving model state dict ...
Epoch: 7 cost time: 0.30443859100341797
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2899164 Best vali loss: 0.2899164
Updating learning rate to 0.0
Validation loss decreased (0.2899 --> 0.2897).  Saving model state dict ...
Epoch: 8 cost time: 0.3142812252044678
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2897247 Best vali loss: 0.2897247

best validation loss 0.2897246522990333

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 3, 'learning_rate': 0.0006514874423, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5771227
	speed: 0.0109s/iter; left time: 10.3551s
Updating learning rate to 0.0006514874423
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 0.954138994216919
Epoch: 1, Steps: 131 | Train Loss: 0.5771227 Vali Loss: 0.2818560 Best vali loss: 0.2818560
	iters: 100, epoch: 2 | loss: 0.8383065
	speed: 0.0084s/iter; left time: 6.8430s
Updating learning rate to 0.00032574372115
Epoch: 2 cost time: 0.668262243270874
Epoch: 2, Steps: 131 | Train Loss: 0.8383065 Vali Loss: 0.2820807 Best vali loss: 0.2818560
	iters: 100, epoch: 3 | loss: 0.4536718
	speed: 0.0104s/iter; left time: 7.1218s
Updating learning rate to 0.000162871860575
Epoch: 3 cost time: 1.0467488765716553
Epoch: 3, Steps: 131 | Train Loss: 0.4536718 Vali Loss: 0.2923682 Best vali loss: 0.2818560
	iters: 100, epoch: 4 | loss: 0.4008602
	speed: 0.0146s/iter; left time: 8.1068s
Updating learning rate to 8.14359302875e-05
Epoch: 4 cost time: 1.2535455226898193
Epoch: 4, Steps: 131 | Train Loss: 0.4008602 Vali Loss: 0.2912299 Best vali loss: 0.2818560
	iters: 100, epoch: 5 | loss: 0.3450939
	speed: 0.0118s/iter; left time: 5.0188s
Updating learning rate to 4.071796514375e-05
Epoch: 5 cost time: 0.6897993087768555
Epoch: 5, Steps: 131 | Train Loss: 0.3450939 Vali Loss: 0.2875015 Best vali loss: 0.2818560
	iters: 100, epoch: 6 | loss: 0.3709295
	speed: 0.0101s/iter; left time: 2.9625s
Updating learning rate to 2.0358982571875e-05
Epoch: 6 cost time: 1.0500082969665527
Epoch: 6, Steps: 131 | Train Loss: 0.3709295 Vali Loss: 0.2892985 Best vali loss: 0.2818560
	iters: 100, epoch: 7 | loss: 0.3492318
	speed: 0.0150s/iter; left time: 2.4484s
Updating learning rate to 1.01794912859375e-05
Epoch: 7 cost time: 1.2802343368530273
Epoch: 7, Steps: 131 | Train Loss: 0.3492318 Vali Loss: 0.2914742 Best vali loss: 0.2818560
	iters: 100, epoch: 8 | loss: 0.3868380
	speed: 0.0161s/iter; left time: 0.5144s
Updating learning rate to 5.08974564296875e-06
Epoch: 8 cost time: 1.2270803451538086
Epoch: 8, Steps: 131 | Train Loss: 0.3868380 Vali Loss: 0.2909685 Best vali loss: 0.2818560

best validation loss 0.2818559779165269

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0065094553439, 'e_layers': 1, 'learning_rate': 0.0006735335754, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3146007
	speed: 0.0081s/iter; left time: 7.6558s
Updating learning rate to 0.0006478987300856038
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 0.6256873607635498
Epoch: 1, Steps: 131 | Train Loss: 0.3146007 Vali Loss: 0.2873846 Best vali loss: 0.2873846
	iters: 100, epoch: 2 | loss: 0.4803473
	speed: 0.0099s/iter; left time: 8.1120s
Updating learning rate to 0.0005748968669610804
Validation loss decreased (0.2874 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 0.813706636428833
Epoch: 2, Steps: 131 | Train Loss: 0.4803473 Vali Loss: 0.2818658 Best vali loss: 0.2818658
	iters: 100, epoch: 3 | loss: 0.4518289
	speed: 0.0109s/iter; left time: 7.4707s
Updating learning rate to 0.00046564185792360155
Epoch: 3 cost time: 0.8200664520263672
Epoch: 3, Steps: 131 | Train Loss: 0.4518289 Vali Loss: 0.2827294 Best vali loss: 0.2818658

best validation loss 0.28186575432788397

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029036262858, 'e_layers': 2, 'learning_rate': 0.0030636692136, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5368747
	speed: 0.0143s/iter; left time: 117.7911s
	iters: 200, epoch: 1 | loss: 0.4281480
	speed: 0.0082s/iter; left time: 67.0142s
	iters: 300, epoch: 1 | loss: 0.2479777
	speed: 0.0068s/iter; left time: 55.0430s
	iters: 400, epoch: 1 | loss: 0.2358195
	speed: 0.0066s/iter; left time: 52.2393s
	iters: 500, epoch: 1 | loss: 0.6513875
	speed: 0.0067s/iter; left time: 52.2864s
	iters: 600, epoch: 1 | loss: 1.3514119
	speed: 0.0030s/iter; left time: 23.2941s
	iters: 700, epoch: 1 | loss: 0.2526913
	speed: 0.0031s/iter; left time: 23.7119s
	iters: 800, epoch: 1 | loss: 0.4556429
	speed: 0.0059s/iter; left time: 44.9686s
	iters: 900, epoch: 1 | loss: 1.0130233
	speed: 0.0057s/iter; left time: 42.8970s
	iters: 1000, epoch: 1 | loss: 0.4087719
	speed: 0.0060s/iter; left time: 44.4841s
Updating learning rate to 0.0030636692136
Validation loss decreased (inf --> 0.3225).  Saving model state dict ...
Epoch: 1 cost time: 6.738101243972778
Epoch: 1, Steps: 1045 | Train Loss: 0.5581749 Vali Loss: 0.3224758 Best vali loss: 0.3224758
	iters: 100, epoch: 2 | loss: 0.2472567
	speed: 0.0221s/iter; left time: 159.2361s
	iters: 200, epoch: 2 | loss: 0.2944811
	speed: 0.0059s/iter; left time: 41.8070s
	iters: 300, epoch: 2 | loss: 0.7412739
	speed: 0.0069s/iter; left time: 48.7555s
	iters: 400, epoch: 2 | loss: 0.7252117
	speed: 0.0068s/iter; left time: 47.1498s
	iters: 500, epoch: 2 | loss: 0.2399079
	speed: 0.0032s/iter; left time: 21.9527s
	iters: 600, epoch: 2 | loss: 0.3908111
	speed: 0.0031s/iter; left time: 20.8123s
	iters: 700, epoch: 2 | loss: 1.0162221
	speed: 0.0033s/iter; left time: 22.1284s
	iters: 800, epoch: 2 | loss: 0.5715377
	speed: 0.0037s/iter; left time: 23.8975s
	iters: 900, epoch: 2 | loss: 0.8911954
	speed: 0.0036s/iter; left time: 23.4074s
	iters: 1000, epoch: 2 | loss: 0.6289154
	speed: 0.0036s/iter; left time: 22.8894s
Updating learning rate to 0.0015318346068
Epoch: 2 cost time: 4.80881404876709
Epoch: 2, Steps: 1045 | Train Loss: 0.5746813 Vali Loss: 0.3252261 Best vali loss: 0.3224758
	iters: 100, epoch: 3 | loss: 0.3804334
	speed: 0.0106s/iter; left time: 65.4925s
	iters: 200, epoch: 3 | loss: 1.2989817
	speed: 0.0047s/iter; left time: 28.6530s
	iters: 300, epoch: 3 | loss: 0.3363088
	speed: 0.0047s/iter; left time: 28.1336s
	iters: 400, epoch: 3 | loss: 0.4606727
	speed: 0.0047s/iter; left time: 27.5174s
	iters: 500, epoch: 3 | loss: 1.1514143
	speed: 0.0046s/iter; left time: 26.5752s
	iters: 600, epoch: 3 | loss: 0.3316070
	speed: 0.0046s/iter; left time: 26.0244s
	iters: 700, epoch: 3 | loss: 0.2002531
	speed: 0.0046s/iter; left time: 25.6816s
	iters: 800, epoch: 3 | loss: 0.7395659
	speed: 0.0046s/iter; left time: 25.1797s
	iters: 900, epoch: 3 | loss: 0.5406471
	speed: 0.0046s/iter; left time: 24.6825s
	iters: 1000, epoch: 3 | loss: 0.2973544
	speed: 0.0046s/iter; left time: 24.2384s
Updating learning rate to 0.0007659173034
Epoch: 3 cost time: 4.791782855987549
Epoch: 3, Steps: 1045 | Train Loss: 0.5737238 Vali Loss: 0.3245423 Best vali loss: 0.3224758

best validation loss 0.32247583615199127

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001591137315
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 0.878532886505127
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2805110 Best vali loss: 0.2805110
Updating learning rate to 7.955686575e-05
Validation loss decreased (0.2805 --> 0.2747).  Saving model state dict ...
Epoch: 2 cost time: 0.6528687477111816
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2746703 Best vali loss: 0.2746703
Updating learning rate to 3.9778432875e-05
Validation loss decreased (0.2747 --> 0.2729).  Saving model state dict ...
Epoch: 3 cost time: 0.6423957347869873
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2728557 Best vali loss: 0.2728557

best validation loss 0.2728557020159803

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.98892164375e-05
Epoch: 4 cost time: 0.8762154579162598
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2732735 Best vali loss: 0.2728557
Updating learning rate to 9.94460821875e-06
Epoch: 5 cost time: 0.630122184753418
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2740697 Best vali loss: 0.2728557
Updating learning rate to 4.972304109375e-06
Epoch: 6 cost time: 0.578181266784668
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2744181 Best vali loss: 0.2728557
Updating learning rate to 2.4861520546875e-06
Epoch: 7 cost time: 0.5730655193328857
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2747114 Best vali loss: 0.2728557
Updating learning rate to 1.24307602734375e-06
Epoch: 8 cost time: 0.5902934074401855
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2751077 Best vali loss: 0.2728557

best validation loss 0.2728557020159803

[INFO][abstract_intensifier.py:595] Added config bd4166 and rejected config 409f87 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.01186370118, 'e_layers': 4, 'learning_rate': 0.0002221655976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002221655976
Validation loss decreased (inf --> 0.2808).  Saving model state dict ...
Epoch: 1 cost time: 0.9978737831115723
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2808245 Best vali loss: 0.2808245
Updating learning rate to 0.0001110827988
Epoch: 2 cost time: 0.7547271251678467
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2813825 Best vali loss: 0.2808245
Updating learning rate to 5.55413994e-05
Validation loss decreased (0.2808 --> 0.2772).  Saving model state dict ...
Epoch: 3 cost time: 0.7576210498809814
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2772039 Best vali loss: 0.2772039
Updating learning rate to 2.77706997e-05
Epoch: 4 cost time: 0.7578279972076416
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2794624 Best vali loss: 0.2772039
Updating learning rate to 1.388534985e-05
Epoch: 5 cost time: 0.7547199726104736
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2790977 Best vali loss: 0.2772039
Updating learning rate to 6.942674925e-06
Epoch: 6 cost time: 0.7544989585876465
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2801056 Best vali loss: 0.2772039
Updating learning rate to 3.4713374625e-06
Epoch: 7 cost time: 0.7207419872283936
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2808041 Best vali loss: 0.2772039
Updating learning rate to 1.73566873125e-06
Epoch: 8 cost time: 0.727060079574585
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2811199 Best vali loss: 0.2772039

best validation loss 0.2772039484029013

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014508988157, 'e_layers': 3, 'learning_rate': 0.0010889710455, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010889710455
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 0.8863480091094971
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2883825 Best vali loss: 0.2883825
Updating learning rate to 0.00054448552275
Validation loss decreased (0.2884 --> 0.2795).  Saving model state dict ...
Epoch: 2 cost time: 0.6356804370880127
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2795075 Best vali loss: 0.2795075
Updating learning rate to 0.000272242761375
Epoch: 3 cost time: 0.5786647796630859
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2805352 Best vali loss: 0.2795075
Updating learning rate to 0.0001361213806875
Validation loss decreased (0.2795 --> 0.2785).  Saving model state dict ...
Epoch: 4 cost time: 0.6388149261474609
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2784727 Best vali loss: 0.2784727
Updating learning rate to 6.806069034375e-05
Epoch: 5 cost time: 0.6458940505981445
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2805171 Best vali loss: 0.2784727
Updating learning rate to 3.4030345171875e-05
Epoch: 6 cost time: 0.5974571704864502
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2824380 Best vali loss: 0.2784727
Updating learning rate to 1.70151725859375e-05
Epoch: 7 cost time: 0.6390683650970459
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2867794 Best vali loss: 0.2784727
Updating learning rate to 8.50758629296875e-06
Epoch: 8 cost time: 0.6294353008270264
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2868101 Best vali loss: 0.2784727

best validation loss 0.2784727231975868

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005760452490497884
Validation loss decreased (inf --> 0.3034).  Saving model state dict ...
Epoch: 1 cost time: 0.5663459300994873
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3034317 Best vali loss: 0.3034317
Updating learning rate to 0.0005111394628953558
Validation loss decreased (0.3034 --> 0.2882).  Saving model state dict ...
Epoch: 2 cost time: 0.4191439151763916
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2881703 Best vali loss: 0.2881703
Updating learning rate to 0.00041400108930629814
Validation loss decreased (0.2882 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 0.42992353439331055
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2839317 Best vali loss: 0.2839317

best validation loss 0.28393165772734363

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 2, 'learning_rate': 0.0015995261445, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3393067
	speed: 0.0091s/iter; left time: 74.9473s
	iters: 200, epoch: 1 | loss: 0.9446703
	speed: 0.0032s/iter; left time: 26.3934s
	iters: 300, epoch: 1 | loss: 0.5503436
	speed: 0.0044s/iter; left time: 35.1803s
	iters: 400, epoch: 1 | loss: 0.6320789
	speed: 0.0045s/iter; left time: 36.0536s
	iters: 500, epoch: 1 | loss: 0.5763656
	speed: 0.0047s/iter; left time: 36.5833s
	iters: 600, epoch: 1 | loss: 1.2186087
	speed: 0.0050s/iter; left time: 38.8069s
	iters: 700, epoch: 1 | loss: 0.4783750
	speed: 0.0051s/iter; left time: 38.9810s
	iters: 800, epoch: 1 | loss: 0.5330713
	speed: 0.0050s/iter; left time: 37.9007s
	iters: 900, epoch: 1 | loss: 1.1889617
	speed: 0.0050s/iter; left time: 37.4694s
	iters: 1000, epoch: 1 | loss: 0.2518961
	speed: 0.0049s/iter; left time: 35.9394s
Updating learning rate to 0.0015386478055601205
Validation loss decreased (inf --> 0.3421).  Saving model state dict ...
Epoch: 1 cost time: 5.0119922161102295
Epoch: 1, Steps: 1045 | Train Loss: 0.6713678 Vali Loss: 0.3420713 Best vali loss: 0.3420713
	iters: 100, epoch: 2 | loss: 0.3415400
	speed: 0.0141s/iter; left time: 102.0230s
	iters: 200, epoch: 2 | loss: 0.2091243
	speed: 0.0054s/iter; left time: 38.2977s
	iters: 300, epoch: 2 | loss: 0.9003318
	speed: 0.0053s/iter; left time: 37.3935s
	iters: 400, epoch: 2 | loss: 1.2062389
	speed: 0.0059s/iter; left time: 40.9361s
	iters: 500, epoch: 2 | loss: 0.3738175
	speed: 0.0060s/iter; left time: 40.7074s
	iters: 600, epoch: 2 | loss: 0.2845034
	speed: 0.0062s/iter; left time: 41.6082s
	iters: 700, epoch: 2 | loss: 0.5755222
	speed: 0.0054s/iter; left time: 35.5849s
	iters: 800, epoch: 2 | loss: 1.4012572
	speed: 0.0053s/iter; left time: 34.7565s
	iters: 900, epoch: 2 | loss: 0.8873377
	speed: 0.0030s/iter; left time: 19.5234s
	iters: 1000, epoch: 2 | loss: 1.6018652
	speed: 0.0031s/iter; left time: 19.4231s
Updating learning rate to 0.0013652809639805618
Validation loss decreased (0.3421 --> 0.3288).  Saving model state dict ...
Epoch: 2 cost time: 5.076858758926392
Epoch: 2, Steps: 1045 | Train Loss: 0.7781538 Vali Loss: 0.3287561 Best vali loss: 0.3287561
	iters: 100, epoch: 3 | loss: 0.4493367
	speed: 0.0141s/iter; left time: 86.8497s
	iters: 200, epoch: 3 | loss: 1.3292843
	speed: 0.0045s/iter; left time: 27.4711s
	iters: 300, epoch: 3 | loss: 1.0568991
	speed: 0.0045s/iter; left time: 26.9423s
	iters: 400, epoch: 3 | loss: 0.4282964
	speed: 0.0045s/iter; left time: 26.4730s
	iters: 500, epoch: 3 | loss: 0.3693358
	speed: 0.0045s/iter; left time: 25.6973s
	iters: 600, epoch: 3 | loss: 0.2303149
	speed: 0.0045s/iter; left time: 25.3967s
	iters: 700, epoch: 3 | loss: 0.5829258
	speed: 0.0045s/iter; left time: 24.8775s
	iters: 800, epoch: 3 | loss: 1.6851522
	speed: 0.0045s/iter; left time: 24.5490s
	iters: 900, epoch: 3 | loss: 0.9381122
	speed: 0.0043s/iter; left time: 22.8628s
	iters: 1000, epoch: 3 | loss: 0.5048494
	speed: 0.0041s/iter; left time: 21.4035s
Updating learning rate to 0.0011058191498174795
Validation loss decreased (0.3288 --> 0.3203).  Saving model state dict ...
Epoch: 3 cost time: 4.6267290115356445
Epoch: 3, Steps: 1045 | Train Loss: 0.7574507 Vali Loss: 0.3203328 Best vali loss: 0.3203328

best validation loss 0.32033281682724846

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001776105869, 'e_layers': 3, 'learning_rate': 0.0035322605912, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5367775
	speed: 0.0103s/iter; left time: 20.6484s
	iters: 200, epoch: 1 | loss: 0.3070011
	speed: 0.0048s/iter; left time: 9.1729s
Updating learning rate to 0.0033978219274529487
Validation loss decreased (inf --> 0.3187).  Saving model state dict ...
Epoch: 1 cost time: 1.5596418380737305
Epoch: 1, Steps: 262 | Train Loss: 0.4218893 Vali Loss: 0.3186786 Best vali loss: 0.3186786
	iters: 100, epoch: 2 | loss: 0.3075739
	speed: 0.0106s/iter; left time: 18.3714s
	iters: 200, epoch: 2 | loss: 0.7125627
	speed: 0.0047s/iter; left time: 7.7451s
Updating learning rate to 0.003014973004077762
Epoch: 2 cost time: 1.2953345775604248
Epoch: 2, Steps: 262 | Train Loss: 0.5100683 Vali Loss: 0.3251170 Best vali loss: 0.3186786
	iters: 100, epoch: 3 | loss: 0.5267547
	speed: 0.0110s/iter; left time: 16.2049s
	iters: 200, epoch: 3 | loss: 0.7830071
	speed: 0.0051s/iter; left time: 6.9671s
Updating learning rate to 0.0024419990991241787
Epoch: 3 cost time: 1.4002768993377686
Epoch: 3, Steps: 262 | Train Loss: 0.6548809 Vali Loss: 0.3221548 Best vali loss: 0.3186786

best validation loss 0.31867861599228825

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002994185651
Validation loss decreased (0.2839 --> 0.2825).  Saving model state dict ...
Epoch: 4 cost time: 0.5355830192565918
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2824787 Best vali loss: 0.2824787
Updating learning rate to 0.00018483604089370196
Validation loss decreased (0.2825 --> 0.2821).  Saving model state dict ...
Epoch: 5 cost time: 0.31206536293029785
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2821349 Best vali loss: 0.2821349
Updating learning rate to 8.769766730464429e-05
Epoch: 6 cost time: 0.3087496757507324
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2828900 Best vali loss: 0.2821349
Updating learning rate to 2.2791881150211728e-05
Epoch: 7 cost time: 0.29201531410217285
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2826378 Best vali loss: 0.2821349
Updating learning rate to 0.0
Epoch: 8 cost time: 0.2948038578033447
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2826733 Best vali loss: 0.2821349

best validation loss 0.2821348801548927

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0111045942676, 'e_layers': 2, 'learning_rate': 0.0002179765149, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002179765149
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 0.59944748878479
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2785968 Best vali loss: 0.2785968
Updating learning rate to 0.00010898825745
Validation loss decreased (0.2786 --> 0.2774).  Saving model state dict ...
Epoch: 2 cost time: 0.5596075057983398
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2773568 Best vali loss: 0.2773568
Updating learning rate to 5.4494128725e-05
Validation loss decreased (0.2774 --> 0.2755).  Saving model state dict ...
Epoch: 3 cost time: 0.6142868995666504
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2754561 Best vali loss: 0.2754561
Updating learning rate to 2.72470643625e-05
Validation loss decreased (0.2755 --> 0.2749).  Saving model state dict ...
Epoch: 4 cost time: 0.6839635372161865
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2749297 Best vali loss: 0.2749297
Updating learning rate to 1.362353218125e-05
Epoch: 5 cost time: 0.5375616550445557
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2753881 Best vali loss: 0.2749297
Updating learning rate to 6.811766090625e-06
Validation loss decreased (0.2749 --> 0.2747).  Saving model state dict ...
Epoch: 6 cost time: 0.6689374446868896
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2746510 Best vali loss: 0.2746510
Updating learning rate to 3.4058830453125e-06
Epoch: 7 cost time: 0.47463250160217285
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2746513 Best vali loss: 0.2746510
Updating learning rate to 1.70294152265625e-06
Validation loss decreased (0.2747 --> 0.2746).  Saving model state dict ...
Epoch: 8 cost time: 0.3640289306640625
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2745980 Best vali loss: 0.2745980

best validation loss 0.2745980226021577

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017015780889, 'e_layers': 1, 'learning_rate': 0.0028702571024, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0028702571024
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 0.9822969436645508
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2878415 Best vali loss: 0.2878415
Updating learning rate to 0.0014351285512
Epoch: 2 cost time: 0.5878376960754395
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2950076 Best vali loss: 0.2878415
Updating learning rate to 0.0007175642756
Epoch: 3 cost time: 0.6612563133239746
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2898290 Best vali loss: 0.2878415
Updating learning rate to 0.0003587821378
Epoch: 4 cost time: 0.45104312896728516
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3051404 Best vali loss: 0.2878415
Updating learning rate to 0.0001793910689
Epoch: 5 cost time: 0.6275894641876221
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3041385 Best vali loss: 0.2878415
Updating learning rate to 8.969553445e-05
Epoch: 6 cost time: 0.5699021816253662
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3093971 Best vali loss: 0.2878415
Updating learning rate to 4.4847767225e-05
Epoch: 7 cost time: 0.32266736030578613
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3077076 Best vali loss: 0.2878415
Updating learning rate to 2.24238836125e-05
Epoch: 8 cost time: 0.32630395889282227
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3127564 Best vali loss: 0.2878415

best validation loss 0.28784149774901263

[INFO][smbo.py:320] Finished 150 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.001707636708, 'e_layers': 2, 'learning_rate': 0.0007419627822, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2910743
	speed: 0.0111s/iter; left time: 91.9134s
	iters: 200, epoch: 1 | loss: 0.1484557
	speed: 0.0060s/iter; left time: 48.6876s
	iters: 300, epoch: 1 | loss: 0.2519150
	speed: 0.0057s/iter; left time: 45.5625s
	iters: 400, epoch: 1 | loss: 0.8528557
	speed: 0.0057s/iter; left time: 45.1752s
	iters: 500, epoch: 1 | loss: 0.3412840
	speed: 0.0062s/iter; left time: 48.9466s
	iters: 600, epoch: 1 | loss: 0.5483041
	speed: 0.0056s/iter; left time: 43.0830s
	iters: 700, epoch: 1 | loss: 0.2986288
	speed: 0.0080s/iter; left time: 60.9109s
	iters: 800, epoch: 1 | loss: 0.3117884
	speed: 0.0037s/iter; left time: 27.7410s
	iters: 900, epoch: 1 | loss: 0.3762615
	speed: 0.0032s/iter; left time: 23.8806s
	iters: 1000, epoch: 1 | loss: 0.4461572
	speed: 0.0032s/iter; left time: 23.5895s
Updating learning rate to 0.0007137235052798548
Validation loss decreased (inf --> 0.2802).  Saving model state dict ...
Epoch: 1 cost time: 5.713957786560059
Epoch: 1, Steps: 1045 | Train Loss: 0.3866725 Vali Loss: 0.2802011 Best vali loss: 0.2802011
	iters: 100, epoch: 2 | loss: 0.8446575
	speed: 0.0141s/iter; left time: 101.7906s
	iters: 200, epoch: 2 | loss: 0.9645938
	speed: 0.0043s/iter; left time: 30.3902s
	iters: 300, epoch: 2 | loss: 0.1949263
	speed: 0.0042s/iter; left time: 29.7584s
	iters: 400, epoch: 2 | loss: 0.4680966
	speed: 0.0040s/iter; left time: 27.7943s
	iters: 500, epoch: 2 | loss: 0.6788245
	speed: 0.0039s/iter; left time: 26.7447s
	iters: 600, epoch: 2 | loss: 0.2658620
	speed: 0.0038s/iter; left time: 25.4337s
	iters: 700, epoch: 2 | loss: 1.6586372
	speed: 0.0036s/iter; left time: 24.1270s
	iters: 800, epoch: 2 | loss: 0.2275930
	speed: 0.0037s/iter; left time: 24.2985s
	iters: 900, epoch: 2 | loss: 0.6635433
	speed: 0.0039s/iter; left time: 24.7281s
	iters: 1000, epoch: 2 | loss: 0.1962224
	speed: 0.0039s/iter; left time: 24.3645s
Updating learning rate to 0.0006333048484408287
Epoch: 2 cost time: 4.16353702545166
Epoch: 2, Steps: 1045 | Train Loss: 0.6162957 Vali Loss: 0.2824153 Best vali loss: 0.2802011
	iters: 100, epoch: 3 | loss: 0.2488037
	speed: 0.0144s/iter; left time: 88.9761s
	iters: 200, epoch: 3 | loss: 0.2387154
	speed: 0.0042s/iter; left time: 25.7248s
	iters: 300, epoch: 3 | loss: 0.6076110
	speed: 0.0041s/iter; left time: 24.5876s
	iters: 400, epoch: 3 | loss: 0.2854479
	speed: 0.0039s/iter; left time: 22.9705s
	iters: 500, epoch: 3 | loss: 0.4519735
	speed: 0.0039s/iter; left time: 22.7655s
	iters: 600, epoch: 3 | loss: 0.7556679
	speed: 0.0042s/iter; left time: 23.5524s
	iters: 700, epoch: 3 | loss: 1.0310082
	speed: 0.0042s/iter; left time: 23.3731s
	iters: 800, epoch: 3 | loss: 0.1270545
	speed: 0.0043s/iter; left time: 23.2728s
	iters: 900, epoch: 3 | loss: 0.4428890
	speed: 0.0042s/iter; left time: 22.4114s
	iters: 1000, epoch: 3 | loss: 0.1792452
	speed: 0.0042s/iter; left time: 22.0003s
Updating learning rate to 0.0005129498231897238
Epoch: 3 cost time: 4.3800036907196045
Epoch: 3, Steps: 1045 | Train Loss: 0.4368416 Vali Loss: 0.2987567 Best vali loss: 0.2802011

best validation loss 0.28020107231316577

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6427208
	speed: 0.0121s/iter; left time: 11.4464s
Updating learning rate to 7.21066019e-05
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 1.1364784240722656
Epoch: 1, Steps: 131 | Train Loss: 0.6427208 Vali Loss: 0.2786440 Best vali loss: 0.2786440
	iters: 100, epoch: 2 | loss: 0.3989008
	speed: 0.0111s/iter; left time: 9.0404s
Updating learning rate to 3.605330095e-05
Validation loss decreased (0.2786 --> 0.2763).  Saving model state dict ...
Epoch: 2 cost time: 0.8967809677124023
Epoch: 2, Steps: 131 | Train Loss: 0.3989008 Vali Loss: 0.2763457 Best vali loss: 0.2763457
	iters: 100, epoch: 3 | loss: 0.8935989
	speed: 0.0114s/iter; left time: 7.8051s
Updating learning rate to 1.8026650475e-05
Validation loss decreased (0.2763 --> 0.2748).  Saving model state dict ...
Epoch: 3 cost time: 0.9016053676605225
Epoch: 3, Steps: 131 | Train Loss: 0.8935989 Vali Loss: 0.2748160 Best vali loss: 0.2748160

best validation loss 0.27481602203806077

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019248824173, 'e_layers': 4, 'learning_rate': 0.0047849704029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004602853310905798
Validation loss decreased (inf --> 0.3251).  Saving model state dict ...
Epoch: 1 cost time: 1.5050151348114014
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3250591 Best vali loss: 0.3250591
Updating learning rate to 0.004084227711283759
Epoch: 2 cost time: 1.2648169994354248
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3484327 Best vali loss: 0.3250591
Updating learning rate to 0.0033080496502235694
Validation loss decreased (0.3251 --> 0.3211).  Saving model state dict ...
Epoch: 3 cost time: 1.2700750827789307
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3210958 Best vali loss: 0.3210958

best validation loss 0.32109578842121944

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5816060
	speed: 0.0118s/iter; left time: 6.5514s
Updating learning rate to 9.0133252375e-06
Validation loss decreased (0.2748 --> 0.2726).  Saving model state dict ...
Epoch: 4 cost time: 1.0749809741973877
Epoch: 4, Steps: 131 | Train Loss: 0.5816060 Vali Loss: 0.2726180 Best vali loss: 0.2726180
	iters: 100, epoch: 5 | loss: 0.3810364
	speed: 0.0112s/iter; left time: 4.7793s
Updating learning rate to 4.50666261875e-06
Epoch: 5 cost time: 0.8929619789123535
Epoch: 5, Steps: 131 | Train Loss: 0.3810364 Vali Loss: 0.2728840 Best vali loss: 0.2726180
	iters: 100, epoch: 6 | loss: 0.8460804
	speed: 0.0107s/iter; left time: 3.1456s
Updating learning rate to 2.253331309375e-06
Epoch: 6 cost time: 0.8763859272003174
Epoch: 6, Steps: 131 | Train Loss: 0.8460804 Vali Loss: 0.2736417 Best vali loss: 0.2726180
	iters: 100, epoch: 7 | loss: 0.5365073
	speed: 0.0107s/iter; left time: 1.7415s
Updating learning rate to 1.1266656546875e-06
Epoch: 7 cost time: 0.8937623500823975
Epoch: 7, Steps: 131 | Train Loss: 0.5365073 Vali Loss: 0.2739769 Best vali loss: 0.2726180
	iters: 100, epoch: 8 | loss: 0.4580628
	speed: 0.0110s/iter; left time: 0.3512s
Updating learning rate to 5.6333282734375e-07
Epoch: 8 cost time: 0.8922080993652344
Epoch: 8, Steps: 131 | Train Loss: 0.4580628 Vali Loss: 0.2741823 Best vali loss: 0.2726180

best validation loss 0.2726179585664323

[INFO][abstract_intensifier.py:595] Added config 639238 and rejected config bd4166 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0061705426639, 'e_layers': 4, 'learning_rate': 0.001116068428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9658590
	speed: 0.0118s/iter; left time: 48.2376s
	iters: 200, epoch: 1 | loss: 0.3254659
	speed: 0.0064s/iter; left time: 25.3861s
	iters: 300, epoch: 1 | loss: 0.2671602
	speed: 0.0064s/iter; left time: 24.8732s
	iters: 400, epoch: 1 | loss: 0.4295471
	speed: 0.0063s/iter; left time: 23.9222s
	iters: 500, epoch: 1 | loss: 0.3953224
	speed: 0.0064s/iter; left time: 23.4641s
Updating learning rate to 0.001116068428
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 3.5789856910705566
Epoch: 1, Steps: 523 | Train Loss: 0.4766709 Vali Loss: 0.2883601 Best vali loss: 0.2883601
	iters: 100, epoch: 2 | loss: 0.4519618
	speed: 0.0130s/iter; left time: 46.1595s
	iters: 200, epoch: 2 | loss: 0.4054348
	speed: 0.0064s/iter; left time: 22.0418s
	iters: 300, epoch: 2 | loss: 0.2835101
	speed: 0.0063s/iter; left time: 21.0788s
	iters: 400, epoch: 2 | loss: 0.3845582
	speed: 0.0063s/iter; left time: 20.5752s
	iters: 500, epoch: 2 | loss: 0.4305468
	speed: 0.0063s/iter; left time: 19.8618s
Updating learning rate to 0.000558034214
Epoch: 2 cost time: 3.36118221282959
Epoch: 2, Steps: 523 | Train Loss: 0.3912023 Vali Loss: 0.2918057 Best vali loss: 0.2883601
	iters: 100, epoch: 3 | loss: 0.3302642
	speed: 0.0112s/iter; left time: 34.1574s
	iters: 200, epoch: 3 | loss: 0.5237817
	speed: 0.0050s/iter; left time: 14.7253s
	iters: 300, epoch: 3 | loss: 0.3220060
	speed: 0.0056s/iter; left time: 15.7690s
	iters: 400, epoch: 3 | loss: 0.3240962
	speed: 0.0057s/iter; left time: 15.5003s
	iters: 500, epoch: 3 | loss: 0.3508953
	speed: 0.0054s/iter; left time: 14.2162s
Updating learning rate to 0.000279017107
Epoch: 3 cost time: 2.816028356552124
Epoch: 3, Steps: 523 | Train Loss: 0.3702087 Vali Loss: 0.3058867 Best vali loss: 0.2883601
	iters: 100, epoch: 4 | loss: 0.7654136
	speed: 0.0122s/iter; left time: 30.6294s
	iters: 200, epoch: 4 | loss: 0.9494616
	speed: 0.0056s/iter; left time: 13.4822s
	iters: 300, epoch: 4 | loss: 0.3767277
	speed: 0.0062s/iter; left time: 14.3422s
	iters: 400, epoch: 4 | loss: 0.2840123
	speed: 0.0068s/iter; left time: 15.1549s
	iters: 500, epoch: 4 | loss: 0.6273544
	speed: 0.0062s/iter; left time: 13.1778s
Updating learning rate to 0.0001395085535
Epoch: 4 cost time: 3.230158805847168
Epoch: 4, Steps: 523 | Train Loss: 0.6005939 Vali Loss: 0.3039961 Best vali loss: 0.2883601
	iters: 100, epoch: 5 | loss: 0.1843332
	speed: 0.0121s/iter; left time: 24.1897s
	iters: 200, epoch: 5 | loss: 0.3799205
	speed: 0.0060s/iter; left time: 11.4463s
	iters: 300, epoch: 5 | loss: 0.7718568
	speed: 0.0057s/iter; left time: 10.2410s
	iters: 400, epoch: 5 | loss: 0.3852225
	speed: 0.0059s/iter; left time: 9.9441s
	iters: 500, epoch: 5 | loss: 0.1515191
	speed: 0.0061s/iter; left time: 9.7111s
Updating learning rate to 6.975427675e-05
Epoch: 5 cost time: 3.1769051551818848
Epoch: 5, Steps: 523 | Train Loss: 0.3745704 Vali Loss: 0.3103689 Best vali loss: 0.2883601
	iters: 100, epoch: 6 | loss: 0.4422000
	speed: 0.0123s/iter; left time: 18.0924s
	iters: 200, epoch: 6 | loss: 0.2493413
	speed: 0.0060s/iter; left time: 8.2288s
	iters: 300, epoch: 6 | loss: 0.6903219
	speed: 0.0061s/iter; left time: 7.7158s
	iters: 400, epoch: 6 | loss: 0.8064421
	speed: 0.0058s/iter; left time: 6.7951s
	iters: 500, epoch: 6 | loss: 0.3446958
	speed: 0.0061s/iter; left time: 6.5589s
Updating learning rate to 3.4877138375e-05
Epoch: 6 cost time: 3.171627998352051
Epoch: 6, Steps: 523 | Train Loss: 0.5066002 Vali Loss: 0.3181640 Best vali loss: 0.2883601
	iters: 100, epoch: 7 | loss: 0.6100821
	speed: 0.0124s/iter; left time: 11.7122s
	iters: 200, epoch: 7 | loss: 0.3182512
	speed: 0.0058s/iter; left time: 4.9309s
	iters: 300, epoch: 7 | loss: 0.2348455
	speed: 0.0057s/iter; left time: 4.2396s
	iters: 400, epoch: 7 | loss: 0.8379197
	speed: 0.0059s/iter; left time: 3.8234s
	iters: 500, epoch: 7 | loss: 0.6748977
	speed: 0.0056s/iter; left time: 3.0662s
Updating learning rate to 1.74385691875e-05
Epoch: 7 cost time: 3.0667481422424316
Epoch: 7, Steps: 523 | Train Loss: 0.5351993 Vali Loss: 0.3149376 Best vali loss: 0.2883601
	iters: 100, epoch: 8 | loss: 0.2474758
	speed: 0.0119s/iter; left time: 5.0515s
	iters: 200, epoch: 8 | loss: 0.3306624
	speed: 0.0064s/iter; left time: 2.0640s
	iters: 300, epoch: 8 | loss: 0.7267785
	speed: 0.0066s/iter; left time: 1.4790s
	iters: 400, epoch: 8 | loss: 0.6691326
	speed: 0.0056s/iter; left time: 0.6922s
	iters: 500, epoch: 8 | loss: 0.2336544
	speed: 0.0045s/iter; left time: 0.1088s
Updating learning rate to 8.71928459375e-06
Epoch: 8 cost time: 3.1332054138183594
Epoch: 8, Steps: 523 | Train Loss: 0.4415408 Vali Loss: 0.3108689 Best vali loss: 0.2883601

best validation loss 0.288360090304946

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 1, 'learning_rate': 0.0009739953589, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3636533
	speed: 0.0085s/iter; left time: 34.6975s
	iters: 200, epoch: 1 | loss: 0.3578200
	speed: 0.0031s/iter; left time: 12.1933s
	iters: 300, epoch: 1 | loss: 0.2387171
	speed: 0.0028s/iter; left time: 10.9238s
	iters: 400, epoch: 1 | loss: 0.5789505
	speed: 0.0026s/iter; left time: 9.8833s
	iters: 500, epoch: 1 | loss: 0.3785156
	speed: 0.0028s/iter; left time: 10.1749s
Updating learning rate to 0.0009369248678743475
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 1.77144455909729
Epoch: 1, Steps: 523 | Train Loss: 0.3835313 Vali Loss: 0.2848577 Best vali loss: 0.2848577
	iters: 100, epoch: 2 | loss: 0.4025113
	speed: 0.0078s/iter; left time: 27.9421s
	iters: 200, epoch: 2 | loss: 0.4644915
	speed: 0.0032s/iter; left time: 11.0694s
	iters: 300, epoch: 2 | loss: 0.6438734
	speed: 0.0032s/iter; left time: 10.8194s
	iters: 400, epoch: 2 | loss: 0.3229727
	speed: 0.0032s/iter; left time: 10.4557s
	iters: 500, epoch: 2 | loss: 1.1927822
	speed: 0.0030s/iter; left time: 9.4155s
Updating learning rate to 0.0008313570410112075
Epoch: 2 cost time: 1.6842777729034424
Epoch: 2, Steps: 523 | Train Loss: 0.6053262 Vali Loss: 0.2928340 Best vali loss: 0.2848577
	iters: 100, epoch: 3 | loss: 0.4749742
	speed: 0.0074s/iter; left time: 22.5179s
	iters: 200, epoch: 3 | loss: 0.5998265
	speed: 0.0030s/iter; left time: 8.9570s
	iters: 300, epoch: 3 | loss: 0.2502310
	speed: 0.0030s/iter; left time: 8.5919s
	iters: 400, epoch: 3 | loss: 0.5727003
	speed: 0.0030s/iter; left time: 8.2267s
	iters: 500, epoch: 3 | loss: 0.3875963
	speed: 0.0030s/iter; left time: 7.9182s
Updating learning rate to 0.0006733636229757597
Epoch: 3 cost time: 1.6273787021636963
Epoch: 3, Steps: 523 | Train Loss: 0.4570656 Vali Loss: 0.2877247 Best vali loss: 0.2848577
	iters: 100, epoch: 4 | loss: 0.2248577
	speed: 0.0075s/iter; left time: 18.9119s
	iters: 200, epoch: 4 | loss: 0.3921389
	speed: 0.0026s/iter; left time: 6.3101s
	iters: 300, epoch: 4 | loss: 0.2697579
	speed: 0.0025s/iter; left time: 5.7204s
	iters: 400, epoch: 4 | loss: 0.3692919
	speed: 0.0026s/iter; left time: 5.7279s
	iters: 500, epoch: 4 | loss: 0.4640865
	speed: 0.0027s/iter; left time: 5.6393s
Updating learning rate to 0.00048699767945
Epoch: 4 cost time: 1.4381942749023438
Epoch: 4, Steps: 523 | Train Loss: 0.3440266 Vali Loss: 0.2882961 Best vali loss: 0.2848577
	iters: 100, epoch: 5 | loss: 0.3773833
	speed: 0.0079s/iter; left time: 15.6646s
	iters: 200, epoch: 5 | loss: 0.3619715
	speed: 0.0031s/iter; left time: 5.8616s
	iters: 300, epoch: 5 | loss: 0.3115727
	speed: 0.0032s/iter; left time: 5.6752s
	iters: 400, epoch: 5 | loss: 0.4663841
	speed: 0.0031s/iter; left time: 5.2218s
	iters: 500, epoch: 5 | loss: 0.1892063
	speed: 0.0030s/iter; left time: 4.8188s
Updating learning rate to 0.00030063173592424026
Epoch: 5 cost time: 1.6673572063446045
Epoch: 5, Steps: 523 | Train Loss: 0.3413036 Vali Loss: 0.2932462 Best vali loss: 0.2848577
	iters: 100, epoch: 6 | loss: 0.2435016
	speed: 0.0076s/iter; left time: 11.1364s
	iters: 200, epoch: 6 | loss: 0.9678877
	speed: 0.0026s/iter; left time: 3.5278s
	iters: 300, epoch: 6 | loss: 0.3167164
	speed: 0.0031s/iter; left time: 3.9890s
	iters: 400, epoch: 6 | loss: 0.3155283
	speed: 0.0032s/iter; left time: 3.7674s
	iters: 500, epoch: 6 | loss: 0.2428034
	speed: 0.0032s/iter; left time: 3.4387s
Updating learning rate to 0.00014263831788879246
Epoch: 6 cost time: 1.5978279113769531
Epoch: 6, Steps: 523 | Train Loss: 0.4172875 Vali Loss: 0.2920068 Best vali loss: 0.2848577
	iters: 100, epoch: 7 | loss: 0.3353228
	speed: 0.0076s/iter; left time: 7.2376s
	iters: 200, epoch: 7 | loss: 0.3680242
	speed: 0.0027s/iter; left time: 2.3054s
	iters: 300, epoch: 7 | loss: 0.3625005
	speed: 0.0027s/iter; left time: 1.9986s
	iters: 400, epoch: 7 | loss: 0.3985942
	speed: 0.0027s/iter; left time: 1.7311s
	iters: 500, epoch: 7 | loss: 0.8050196
	speed: 0.0026s/iter; left time: 1.4085s
Updating learning rate to 3.707049102565253e-05
Epoch: 7 cost time: 1.4343481063842773
Epoch: 7, Steps: 523 | Train Loss: 0.4538922 Vali Loss: 0.2918147 Best vali loss: 0.2848577
	iters: 100, epoch: 8 | loss: 0.3440419
	speed: 0.0070s/iter; left time: 2.9602s
	iters: 200, epoch: 8 | loss: 0.3290723
	speed: 0.0027s/iter; left time: 0.8785s
	iters: 300, epoch: 8 | loss: 0.2474859
	speed: 0.0027s/iter; left time: 0.6057s
	iters: 400, epoch: 8 | loss: 0.4449703
	speed: 0.0027s/iter; left time: 0.3353s
	iters: 500, epoch: 8 | loss: 0.6256136
	speed: 0.0028s/iter; left time: 0.0666s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4709498882293701
Epoch: 8, Steps: 523 | Train Loss: 0.3982368 Vali Loss: 0.2921740 Best vali loss: 0.2848577

best validation loss 0.28485772438145074

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 2, 'learning_rate': 0.0011324263099, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5272060
	speed: 0.0095s/iter; left time: 9.0146s
Updating learning rate to 0.0011324263099
Validation loss decreased (inf --> 0.3016).  Saving model state dict ...
Epoch: 1 cost time: 0.8080856800079346
Epoch: 1, Steps: 131 | Train Loss: 0.5272060 Vali Loss: 0.3016279 Best vali loss: 0.3016279
	iters: 100, epoch: 2 | loss: 0.5263044
	speed: 0.0069s/iter; left time: 5.6614s
Updating learning rate to 0.00056621315495
Validation loss decreased (0.3016 --> 0.2900).  Saving model state dict ...
Epoch: 2 cost time: 0.5277488231658936
Epoch: 2, Steps: 131 | Train Loss: 0.5263044 Vali Loss: 0.2900160 Best vali loss: 0.2900160
	iters: 100, epoch: 3 | loss: 0.5035362
	speed: 0.0075s/iter; left time: 5.1503s
Updating learning rate to 0.000283106577475
Validation loss decreased (0.2900 --> 0.2852).  Saving model state dict ...
Epoch: 3 cost time: 0.6015112400054932
Epoch: 3, Steps: 131 | Train Loss: 0.5035362 Vali Loss: 0.2852088 Best vali loss: 0.2852088

best validation loss 0.28520881998889197

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0104119650236, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3021147
	speed: 0.0098s/iter; left time: 40.1686s
	iters: 200, epoch: 1 | loss: 0.2888976
	speed: 0.0042s/iter; left time: 16.5490s
	iters: 300, epoch: 1 | loss: 1.0613569
	speed: 0.0039s/iter; left time: 15.0923s
	iters: 400, epoch: 1 | loss: 0.6338802
	speed: 0.0039s/iter; left time: 14.7107s
	iters: 500, epoch: 1 | loss: 0.6580516
	speed: 0.0041s/iter; left time: 15.1550s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 2.4087026119232178
Epoch: 1, Steps: 523 | Train Loss: 0.5888602 Vali Loss: 0.2856673 Best vali loss: 0.2856673
	iters: 100, epoch: 2 | loss: 0.3295592
	speed: 0.0097s/iter; left time: 34.3965s
	iters: 200, epoch: 2 | loss: 0.2744603
	speed: 0.0041s/iter; left time: 14.3170s
	iters: 300, epoch: 2 | loss: 0.3592760
	speed: 0.0041s/iter; left time: 13.8477s
	iters: 400, epoch: 2 | loss: 1.0626662
	speed: 0.0040s/iter; left time: 13.0379s
	iters: 500, epoch: 2 | loss: 0.7063699
	speed: 0.0040s/iter; left time: 12.5906s
Updating learning rate to 0.0006629438250964442
Epoch: 2 cost time: 2.184194564819336
Epoch: 2, Steps: 523 | Train Loss: 0.5464663 Vali Loss: 0.2896752 Best vali loss: 0.2856673
	iters: 100, epoch: 3 | loss: 0.3142017
	speed: 0.0098s/iter; left time: 29.7870s
	iters: 200, epoch: 3 | loss: 0.7617893
	speed: 0.0041s/iter; left time: 12.1070s
	iters: 300, epoch: 3 | loss: 0.3681077
	speed: 0.0041s/iter; left time: 11.6426s
	iters: 400, epoch: 3 | loss: 0.3936230
	speed: 0.0041s/iter; left time: 11.3498s
	iters: 500, epoch: 3 | loss: 0.2480950
	speed: 0.0042s/iter; left time: 11.1089s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 2.2212862968444824
Epoch: 3, Steps: 523 | Train Loss: 0.4171633 Vali Loss: 0.2935578 Best vali loss: 0.2856673

best validation loss 0.2856672884097725

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4490179
	speed: 0.0109s/iter; left time: 44.7165s
	iters: 200, epoch: 1 | loss: 0.2287445
	speed: 0.0054s/iter; left time: 21.3621s
	iters: 300, epoch: 1 | loss: 0.3933301
	speed: 0.0054s/iter; left time: 20.8575s
	iters: 400, epoch: 1 | loss: 0.2893254
	speed: 0.0049s/iter; left time: 18.6902s
	iters: 500, epoch: 1 | loss: 0.2972137
	speed: 0.0052s/iter; left time: 19.1949s
Updating learning rate to 0.00024547190550098694
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 3.0426294803619385
Epoch: 1, Steps: 523 | Train Loss: 0.3315263 Vali Loss: 0.2815192 Best vali loss: 0.2815192
	iters: 100, epoch: 2 | loss: 0.6809198
	speed: 0.0116s/iter; left time: 41.4833s
	iters: 200, epoch: 2 | loss: 0.2630097
	speed: 0.0053s/iter; left time: 18.3115s
	iters: 300, epoch: 2 | loss: 0.3781468
	speed: 0.0053s/iter; left time: 17.8743s
	iters: 400, epoch: 2 | loss: 0.3621638
	speed: 0.0049s/iter; left time: 16.0784s
	iters: 500, epoch: 2 | loss: 0.7301048
	speed: 0.0042s/iter; left time: 13.3405s
Updating learning rate to 0.00021781340639583926
Epoch: 2 cost time: 2.657557725906372
Epoch: 2, Steps: 523 | Train Loss: 0.4828690 Vali Loss: 0.2828785 Best vali loss: 0.2815192
	iters: 100, epoch: 3 | loss: 0.2464294
	speed: 0.0102s/iter; left time: 31.1291s
	iters: 200, epoch: 3 | loss: 0.2721457
	speed: 0.0054s/iter; left time: 15.8930s
	iters: 300, epoch: 3 | loss: 0.7900245
	speed: 0.0054s/iter; left time: 15.2414s
	iters: 400, epoch: 3 | loss: 0.5177693
	speed: 0.0059s/iter; left time: 16.0852s
	iters: 500, epoch: 3 | loss: 0.3562245
	speed: 0.0052s/iter; left time: 13.7068s
Updating learning rate to 0.000176419537248397
Epoch: 3 cost time: 2.8938465118408203
Epoch: 3, Steps: 523 | Train Loss: 0.4365187 Vali Loss: 0.2879959 Best vali loss: 0.2815192

best validation loss 0.28151918808327325

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3051588
	speed: 0.0111s/iter; left time: 28.0168s
	iters: 200, epoch: 4 | loss: 0.2218831
	speed: 0.0052s/iter; left time: 12.4770s
	iters: 300, epoch: 4 | loss: 0.4016658
	speed: 0.0057s/iter; left time: 13.0906s
	iters: 400, epoch: 4 | loss: 0.2469002
	speed: 0.0049s/iter; left time: 10.7726s
	iters: 500, epoch: 4 | loss: 0.3121797
	speed: 0.0057s/iter; left time: 12.0400s
Updating learning rate to 0.0001275921394
Epoch: 4 cost time: 3.0871803760528564
Epoch: 4, Steps: 523 | Train Loss: 0.2975575 Vali Loss: 0.2896613 Best vali loss: 0.2815192
	iters: 100, epoch: 5 | loss: 0.6503955
	speed: 0.0110s/iter; left time: 21.9575s
	iters: 200, epoch: 5 | loss: 0.2942227
	speed: 0.0051s/iter; left time: 9.6808s
	iters: 300, epoch: 5 | loss: 0.3704202
	speed: 0.0050s/iter; left time: 8.9356s
	iters: 400, epoch: 5 | loss: 0.3250077
	speed: 0.0052s/iter; left time: 8.8123s
	iters: 500, epoch: 5 | loss: 0.6630563
	speed: 0.0047s/iter; left time: 7.5333s
Updating learning rate to 7.8764741551603e-05
Epoch: 5 cost time: 2.6487669944763184
Epoch: 5, Steps: 523 | Train Loss: 0.4606205 Vali Loss: 0.2886994 Best vali loss: 0.2815192
	iters: 100, epoch: 6 | loss: 0.2224621
	speed: 0.0102s/iter; left time: 14.9556s
	iters: 200, epoch: 6 | loss: 0.2824995
	speed: 0.0070s/iter; left time: 9.5240s
	iters: 300, epoch: 6 | loss: 0.6551967
	speed: 0.0071s/iter; left time: 8.9985s
	iters: 400, epoch: 6 | loss: 0.4587887
	speed: 0.0073s/iter; left time: 8.5299s
	iters: 500, epoch: 6 | loss: 0.3563856
	speed: 0.0074s/iter; left time: 7.8826s
Updating learning rate to 3.7370872404160736e-05
Epoch: 6 cost time: 3.5544073581695557
Epoch: 6, Steps: 523 | Train Loss: 0.3950665 Vali Loss: 0.3004967 Best vali loss: 0.2815192
	iters: 100, epoch: 7 | loss: 0.3854531
	speed: 0.0158s/iter; left time: 14.9243s
	iters: 200, epoch: 7 | loss: 0.3214618
	speed: 0.0074s/iter; left time: 6.2909s
	iters: 300, epoch: 7 | loss: 0.3702722
	speed: 0.0076s/iter; left time: 5.6538s
	iters: 400, epoch: 7 | loss: 0.5555147
	speed: 0.0043s/iter; left time: 2.7521s
	iters: 500, epoch: 7 | loss: 0.3246212
	speed: 0.0045s/iter; left time: 2.4344s
Updating learning rate to 9.71237329901307e-06
Epoch: 7 cost time: 3.2365763187408447
Epoch: 7, Steps: 523 | Train Loss: 0.3914646 Vali Loss: 0.2880514 Best vali loss: 0.2815192
	iters: 100, epoch: 8 | loss: 0.5541704
	speed: 0.0107s/iter; left time: 4.5384s
	iters: 200, epoch: 8 | loss: 0.2018998
	speed: 0.0046s/iter; left time: 1.5023s
	iters: 300, epoch: 8 | loss: 0.2975245
	speed: 0.0049s/iter; left time: 1.0916s
	iters: 400, epoch: 8 | loss: 0.6691319
	speed: 0.0051s/iter; left time: 0.6364s
	iters: 500, epoch: 8 | loss: 0.4479876
	speed: 0.0047s/iter; left time: 0.1139s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5806725025177
Epoch: 8, Steps: 523 | Train Loss: 0.4341428 Vali Loss: 0.2930956 Best vali loss: 0.2815192

best validation loss 0.28151918808327325

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003922949282, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3854233
	speed: 0.0093s/iter; left time: 18.5264s
	iters: 200, epoch: 1 | loss: 1.0131472
	speed: 0.0036s/iter; left time: 6.8542s
Updating learning rate to 0.0003922949282
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 1.2264482975006104
Epoch: 1, Steps: 262 | Train Loss: 0.6992853 Vali Loss: 0.2931876 Best vali loss: 0.2931876
	iters: 100, epoch: 2 | loss: 0.3302132
	speed: 0.0093s/iter; left time: 16.1201s
	iters: 200, epoch: 2 | loss: 0.4385679
	speed: 0.0041s/iter; left time: 6.6406s
Updating learning rate to 0.0001961474641
Validation loss decreased (0.2932 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 1.1483755111694336
Epoch: 2, Steps: 262 | Train Loss: 0.3843905 Vali Loss: 0.2824766 Best vali loss: 0.2824766
	iters: 100, epoch: 3 | loss: 0.4513506
	speed: 0.0111s/iter; left time: 16.2861s
	iters: 200, epoch: 3 | loss: 0.4565056
	speed: 0.0047s/iter; left time: 6.3886s
Updating learning rate to 9.807373205e-05
Epoch: 3 cost time: 1.2821223735809326
Epoch: 3, Steps: 262 | Train Loss: 0.4539281 Vali Loss: 0.2836453 Best vali loss: 0.2824766
	iters: 100, epoch: 4 | loss: 0.5273002
	speed: 0.0095s/iter; left time: 11.4494s
	iters: 200, epoch: 4 | loss: 0.3134957
	speed: 0.0042s/iter; left time: 4.7214s
Updating learning rate to 4.9036866025e-05
Epoch: 4 cost time: 1.1325843334197998
Epoch: 4, Steps: 262 | Train Loss: 0.4203979 Vali Loss: 0.2868841 Best vali loss: 0.2824766
	iters: 100, epoch: 5 | loss: 0.4119805
	speed: 0.0099s/iter; left time: 9.3555s
	iters: 200, epoch: 5 | loss: 0.6100244
	speed: 0.0043s/iter; left time: 3.6488s
Updating learning rate to 2.45184330125e-05
Epoch: 5 cost time: 1.1804547309875488
Epoch: 5, Steps: 262 | Train Loss: 0.5110025 Vali Loss: 0.2903312 Best vali loss: 0.2824766
	iters: 100, epoch: 6 | loss: 0.4192125
	speed: 0.0096s/iter; left time: 6.5789s
	iters: 200, epoch: 6 | loss: 0.4791647
	speed: 0.0039s/iter; left time: 2.2957s
Updating learning rate to 1.225921650625e-05
Epoch: 6 cost time: 1.0925462245941162
Epoch: 6, Steps: 262 | Train Loss: 0.4491886 Vali Loss: 0.2879720 Best vali loss: 0.2824766
	iters: 100, epoch: 7 | loss: 0.2850830
	speed: 0.0095s/iter; left time: 4.0305s
	iters: 200, epoch: 7 | loss: 0.5029287
	speed: 0.0041s/iter; left time: 1.3427s
Updating learning rate to 6.129608253125e-06
Epoch: 7 cost time: 1.1246681213378906
Epoch: 7, Steps: 262 | Train Loss: 0.3940058 Vali Loss: 0.2870049 Best vali loss: 0.2824766
	iters: 100, epoch: 8 | loss: 0.3949432
	speed: 0.0096s/iter; left time: 1.5577s
	iters: 200, epoch: 8 | loss: 0.3245258
	speed: 0.0041s/iter; left time: 0.2606s
Updating learning rate to 3.0648041265625e-06
Epoch: 8 cost time: 1.135085105895996
Epoch: 8, Steps: 262 | Train Loss: 0.3597345 Vali Loss: 0.2879853 Best vali loss: 0.2824766

best validation loss 0.2824766136326281

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024943532487, 'e_layers': 3, 'learning_rate': 0.0040105616226, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040105616226
Validation loss decreased (inf --> 0.3124).  Saving model state dict ...
Epoch: 1 cost time: 0.8368117809295654
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3124450 Best vali loss: 0.3124450
Updating learning rate to 0.0020052808113
Epoch: 2 cost time: 0.6289243698120117
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3162660 Best vali loss: 0.3124450
Updating learning rate to 0.00100264040565
Epoch: 3 cost time: 0.6188204288482666
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3283541 Best vali loss: 0.3124450
Updating learning rate to 0.000501320202825
Epoch: 4 cost time: 0.620722770690918
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3227541 Best vali loss: 0.3124450
Updating learning rate to 0.0002506601014125
Epoch: 5 cost time: 0.6255056858062744
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3223104 Best vali loss: 0.3124450
Updating learning rate to 0.00012533005070625
Epoch: 6 cost time: 0.5907936096191406
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3201636 Best vali loss: 0.3124450
Updating learning rate to 6.2665025353125e-05
Epoch: 7 cost time: 0.614006757736206
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3191121 Best vali loss: 0.3124450
Updating learning rate to 3.13325126765625e-05
Epoch: 8 cost time: 0.6346554756164551
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3186393 Best vali loss: 0.3124450

best validation loss 0.312445009495078

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025792385667, 'e_layers': 3, 'learning_rate': 0.0026285535245, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3373491
	speed: 0.0104s/iter; left time: 20.7460s
	iters: 200, epoch: 1 | loss: 0.4412858
	speed: 0.0050s/iter; left time: 9.4618s
Updating learning rate to 0.0026285535245
Validation loss decreased (inf --> 0.2888).  Saving model state dict ...
Epoch: 1 cost time: 1.568582534790039
Epoch: 1, Steps: 262 | Train Loss: 0.3893175 Vali Loss: 0.2888423 Best vali loss: 0.2888423
	iters: 100, epoch: 2 | loss: 0.2823509
	speed: 0.0111s/iter; left time: 19.2246s
	iters: 200, epoch: 2 | loss: 0.3011267
	speed: 0.0052s/iter; left time: 8.4358s
Updating learning rate to 0.00131427676225
Validation loss decreased (0.2888 --> 0.2845).  Saving model state dict ...
Epoch: 2 cost time: 1.3883802890777588
Epoch: 2, Steps: 262 | Train Loss: 0.2917388 Vali Loss: 0.2844888 Best vali loss: 0.2844888
	iters: 100, epoch: 3 | loss: 0.6985266
	speed: 0.0099s/iter; left time: 14.6031s
	iters: 200, epoch: 3 | loss: 0.2732630
	speed: 0.0042s/iter; left time: 5.7212s
Updating learning rate to 0.000657138381125
Epoch: 3 cost time: 1.1721134185791016
Epoch: 3, Steps: 262 | Train Loss: 0.4858948 Vali Loss: 0.2987618 Best vali loss: 0.2844888

best validation loss 0.28448883071403247

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037879290128, 'e_layers': 3, 'learning_rate': 0.0044980854811, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3789203
	speed: 0.0107s/iter; left time: 43.5400s
	iters: 200, epoch: 1 | loss: 0.3634589
	speed: 0.0048s/iter; left time: 19.3051s
	iters: 300, epoch: 1 | loss: 0.2934112
	speed: 0.0049s/iter; left time: 18.9069s
	iters: 400, epoch: 1 | loss: 0.9464574
	speed: 0.0052s/iter; left time: 19.7148s
	iters: 500, epoch: 1 | loss: 1.1356184
	speed: 0.0050s/iter; left time: 18.5259s
Updating learning rate to 0.0044980854811
Validation loss decreased (inf --> 0.3216).  Saving model state dict ...
Epoch: 1 cost time: 2.9234628677368164
Epoch: 1, Steps: 523 | Train Loss: 0.6235733 Vali Loss: 0.3216251 Best vali loss: 0.3216251
	iters: 100, epoch: 2 | loss: 0.3725041
	speed: 0.0117s/iter; left time: 41.5631s
	iters: 200, epoch: 2 | loss: 0.4954911
	speed: 0.0049s/iter; left time: 17.1146s
	iters: 300, epoch: 2 | loss: 0.3454778
	speed: 0.0050s/iter; left time: 16.8983s
	iters: 400, epoch: 2 | loss: 0.5830785
	speed: 0.0051s/iter; left time: 16.6569s
	iters: 500, epoch: 2 | loss: 0.7824008
	speed: 0.0051s/iter; left time: 16.2647s
Updating learning rate to 0.00224904274055
Epoch: 2 cost time: 2.7216098308563232
Epoch: 2, Steps: 523 | Train Loss: 0.5157905 Vali Loss: 0.3218797 Best vali loss: 0.3216251
	iters: 100, epoch: 3 | loss: 0.4131723
	speed: 0.0112s/iter; left time: 33.9965s
	iters: 200, epoch: 3 | loss: 0.4990520
	speed: 0.0050s/iter; left time: 14.6277s
	iters: 300, epoch: 3 | loss: 0.4702969
	speed: 0.0053s/iter; left time: 14.9129s
	iters: 400, epoch: 3 | loss: 0.2736774
	speed: 0.0054s/iter; left time: 14.7896s
	iters: 500, epoch: 3 | loss: 0.8353714
	speed: 0.0052s/iter; left time: 13.6941s
Updating learning rate to 0.001124521370275
Epoch: 3 cost time: 2.754384994506836
Epoch: 3, Steps: 523 | Train Loss: 0.4983140 Vali Loss: 0.3241115 Best vali loss: 0.3216251

best validation loss 0.3216250584543571

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3635587
	speed: 0.0099s/iter; left time: 40.6354s
	iters: 200, epoch: 1 | loss: 0.3306994
	speed: 0.0044s/iter; left time: 17.4572s
	iters: 300, epoch: 1 | loss: 0.2190373
	speed: 0.0044s/iter; left time: 17.0035s
	iters: 400, epoch: 1 | loss: 0.6177989
	speed: 0.0044s/iter; left time: 16.4842s
	iters: 500, epoch: 1 | loss: 0.2510086
	speed: 0.0041s/iter; left time: 15.2641s
Updating learning rate to 0.00016522745149179477
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 2.5418548583984375
Epoch: 1, Steps: 523 | Train Loss: 0.3564206 Vali Loss: 0.2799282 Best vali loss: 0.2799282
	iters: 100, epoch: 2 | loss: 0.3994833
	speed: 0.0078s/iter; left time: 27.6651s
	iters: 200, epoch: 2 | loss: 0.3972281
	speed: 0.0047s/iter; left time: 16.1820s
	iters: 300, epoch: 2 | loss: 0.6166841
	speed: 0.0044s/iter; left time: 14.8066s
	iters: 400, epoch: 2 | loss: 0.6795893
	speed: 0.0044s/iter; left time: 14.3521s
	iters: 500, epoch: 2 | loss: 0.3271731
	speed: 0.0047s/iter; left time: 15.0040s
Updating learning rate to 0.00014661048060095176
Validation loss decreased (0.2799 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 2.275876998901367
Epoch: 2, Steps: 523 | Train Loss: 0.4840316 Vali Loss: 0.2765559 Best vali loss: 0.2765559
	iters: 100, epoch: 3 | loss: 0.4605504
	speed: 0.0117s/iter; left time: 35.4915s
	iters: 200, epoch: 3 | loss: 0.2784579
	speed: 0.0045s/iter; left time: 13.3233s
	iters: 300, epoch: 3 | loss: 0.5593733
	speed: 0.0040s/iter; left time: 11.4218s
	iters: 400, epoch: 3 | loss: 0.3985837
	speed: 0.0045s/iter; left time: 12.3378s
	iters: 500, epoch: 3 | loss: 0.4667594
	speed: 0.0047s/iter; left time: 12.4646s
Updating learning rate to 0.0001187482146823405
Epoch: 3 cost time: 2.4028713703155518
Epoch: 3, Steps: 523 | Train Loss: 0.4327449 Vali Loss: 0.2839651 Best vali loss: 0.2765559

best validation loss 0.2765558929071412

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3260203
	speed: 0.0092s/iter; left time: 23.0276s
	iters: 200, epoch: 4 | loss: 0.3097528
	speed: 0.0039s/iter; left time: 9.3112s
	iters: 300, epoch: 4 | loss: 0.2101338
	speed: 0.0039s/iter; left time: 8.9441s
	iters: 400, epoch: 4 | loss: 0.5125546
	speed: 0.0038s/iter; left time: 8.5131s
	iters: 500, epoch: 4 | loss: 0.2499328
	speed: 0.0039s/iter; left time: 8.1553s
Updating learning rate to 8.588243115e-05
Epoch: 4 cost time: 2.2800369262695312
Epoch: 4, Steps: 523 | Train Loss: 0.3216789 Vali Loss: 0.2781674 Best vali loss: 0.2765559
	iters: 100, epoch: 5 | loss: 0.3636679
	speed: 0.0089s/iter; left time: 17.7821s
	iters: 200, epoch: 5 | loss: 0.3883089
	speed: 0.0034s/iter; left time: 6.4406s
	iters: 300, epoch: 5 | loss: 0.5309802
	speed: 0.0034s/iter; left time: 6.1370s
	iters: 400, epoch: 5 | loss: 0.6002225
	speed: 0.0033s/iter; left time: 5.6617s
	iters: 500, epoch: 5 | loss: 0.3114960
	speed: 0.0036s/iter; left time: 5.7986s
Updating learning rate to 5.30166476176595e-05
Epoch: 5 cost time: 1.8675892353057861
Epoch: 5, Steps: 523 | Train Loss: 0.4389351 Vali Loss: 0.2827198 Best vali loss: 0.2765559
	iters: 100, epoch: 6 | loss: 0.4517758
	speed: 0.0088s/iter; left time: 12.9424s
	iters: 200, epoch: 6 | loss: 0.2576323
	speed: 0.0038s/iter; left time: 5.2328s
	iters: 300, epoch: 6 | loss: 0.5037534
	speed: 0.0039s/iter; left time: 4.9880s
	iters: 400, epoch: 6 | loss: 0.3819954
	speed: 0.0035s/iter; left time: 4.0902s
	iters: 500, epoch: 6 | loss: 0.4224348
	speed: 0.0035s/iter; left time: 3.7298s
Updating learning rate to 2.515438169904822e-05
Epoch: 6 cost time: 1.9709410667419434
Epoch: 6, Steps: 523 | Train Loss: 0.4035183 Vali Loss: 0.2874173 Best vali loss: 0.2765559
	iters: 100, epoch: 7 | loss: 0.4514321
	speed: 0.0084s/iter; left time: 7.9480s
	iters: 200, epoch: 7 | loss: 0.7271316
	speed: 0.0034s/iter; left time: 2.8754s
	iters: 300, epoch: 7 | loss: 0.6489282
	speed: 0.0036s/iter; left time: 2.6985s
	iters: 400, epoch: 7 | loss: 0.6788515
	speed: 0.0038s/iter; left time: 2.4691s
	iters: 500, epoch: 7 | loss: 0.3529397
	speed: 0.0038s/iter; left time: 2.0655s
Updating learning rate to 6.53741080820523e-06
Epoch: 7 cost time: 1.941098690032959
Epoch: 7, Steps: 523 | Train Loss: 0.5718566 Vali Loss: 0.2869789 Best vali loss: 0.2765559
	iters: 100, epoch: 8 | loss: 0.3941749
	speed: 0.0091s/iter; left time: 3.8455s
	iters: 200, epoch: 8 | loss: 0.2665392
	speed: 0.0035s/iter; left time: 1.1273s
	iters: 300, epoch: 8 | loss: 0.1676047
	speed: 0.0035s/iter; left time: 0.7745s
	iters: 400, epoch: 8 | loss: 0.5785202
	speed: 0.0035s/iter; left time: 0.4366s
	iters: 500, epoch: 8 | loss: 0.3803796
	speed: 0.0035s/iter; left time: 0.0839s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9241068363189697
Epoch: 8, Steps: 523 | Train Loss: 0.3574437 Vali Loss: 0.2851662 Best vali loss: 0.2765559

best validation loss 0.2765558929071412

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011023654446, 'e_layers': 1, 'learning_rate': 0.0011214708245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5026022
	speed: 0.0088s/iter; left time: 8.3643s
Updating learning rate to 0.0010787873827820538
Validation loss decreased (inf --> 0.2866).  Saving model state dict ...
Epoch: 1 cost time: 0.7192792892456055
Epoch: 1, Steps: 131 | Train Loss: 0.5026022 Vali Loss: 0.2865963 Best vali loss: 0.2865963
	iters: 100, epoch: 2 | loss: 0.6650184
	speed: 0.0061s/iter; left time: 4.9524s
Updating learning rate to 0.0009572352247034093
Epoch: 2 cost time: 0.44554615020751953
Epoch: 2, Steps: 131 | Train Loss: 0.6650184 Vali Loss: 0.2878625 Best vali loss: 0.2865963
	iters: 100, epoch: 3 | loss: 0.5450752
	speed: 0.0062s/iter; left time: 4.2524s
Updating learning rate to 0.0007753195644584837
Epoch: 3 cost time: 0.5018212795257568
Epoch: 3, Steps: 131 | Train Loss: 0.5450752 Vali Loss: 0.2916703 Best vali loss: 0.2865963
	iters: 100, epoch: 4 | loss: 0.4715605
	speed: 0.0062s/iter; left time: 3.4732s
Updating learning rate to 0.00056073541225
Epoch: 4 cost time: 0.4615345001220703
Epoch: 4, Steps: 131 | Train Loss: 0.4715605 Vali Loss: 0.2983496 Best vali loss: 0.2865963
	iters: 100, epoch: 5 | loss: 0.3371381
	speed: 0.0059s/iter; left time: 2.4906s
Updating learning rate to 0.0003461512600415164
Epoch: 5 cost time: 0.44597482681274414
Epoch: 5, Steps: 131 | Train Loss: 0.3371381 Vali Loss: 0.3001704 Best vali loss: 0.2865963
	iters: 100, epoch: 6 | loss: 0.2788594
	speed: 0.0062s/iter; left time: 1.8326s
Updating learning rate to 0.00016423559979659077
Epoch: 6 cost time: 0.4889976978302002
Epoch: 6, Steps: 131 | Train Loss: 0.2788594 Vali Loss: 0.3138288 Best vali loss: 0.2865963
	iters: 100, epoch: 7 | loss: 0.3406380
	speed: 0.0062s/iter; left time: 1.0067s
Updating learning rate to 4.268344171794636e-05
Epoch: 7 cost time: 0.4706275463104248
Epoch: 7, Steps: 131 | Train Loss: 0.3406380 Vali Loss: 0.3132280 Best vali loss: 0.2865963
	iters: 100, epoch: 8 | loss: 0.2635237
	speed: 0.0063s/iter; left time: 0.2028s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4946436882019043
Epoch: 8, Steps: 131 | Train Loss: 0.2635237 Vali Loss: 0.3183649 Best vali loss: 0.2865963

best validation loss 0.28659631184438383

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0064522030262, 'e_layers': 1, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2574273
	speed: 0.0083s/iter; left time: 68.8489s
	iters: 200, epoch: 1 | loss: 1.2072203
	speed: 0.0028s/iter; left time: 22.6137s
	iters: 300, epoch: 1 | loss: 0.4369274
	speed: 0.0027s/iter; left time: 21.8049s
	iters: 400, epoch: 1 | loss: 0.5986564
	speed: 0.0028s/iter; left time: 22.4758s
	iters: 500, epoch: 1 | loss: 0.2895896
	speed: 0.0030s/iter; left time: 23.7639s
	iters: 600, epoch: 1 | loss: 1.2747291
	speed: 0.0030s/iter; left time: 23.2363s
	iters: 700, epoch: 1 | loss: 0.5266356
	speed: 0.0030s/iter; left time: 22.9501s
	iters: 800, epoch: 1 | loss: 0.2018517
	speed: 0.0030s/iter; left time: 22.7172s
	iters: 900, epoch: 1 | loss: 0.4118254
	speed: 0.0030s/iter; left time: 22.3802s
	iters: 1000, epoch: 1 | loss: 1.7113016
	speed: 0.0030s/iter; left time: 22.0763s
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.3108).  Saving model state dict ...
Epoch: 1 cost time: 3.343149185180664
Epoch: 1, Steps: 1045 | Train Loss: 0.6916164 Vali Loss: 0.3108082 Best vali loss: 0.3108082
	iters: 100, epoch: 2 | loss: 0.6154149
	speed: 0.0114s/iter; left time: 82.1835s
	iters: 200, epoch: 2 | loss: 0.4790758
	speed: 0.0026s/iter; left time: 18.7185s
	iters: 300, epoch: 2 | loss: 0.2779253
	speed: 0.0026s/iter; left time: 18.2992s
	iters: 400, epoch: 2 | loss: 0.3463203
	speed: 0.0028s/iter; left time: 19.2044s
	iters: 500, epoch: 2 | loss: 1.5517259
	speed: 0.0030s/iter; left time: 20.6067s
	iters: 600, epoch: 2 | loss: 1.2405906
	speed: 0.0030s/iter; left time: 19.9482s
	iters: 700, epoch: 2 | loss: 0.3931968
	speed: 0.0030s/iter; left time: 19.7772s
	iters: 800, epoch: 2 | loss: 0.3136251
	speed: 0.0030s/iter; left time: 19.3135s
	iters: 900, epoch: 2 | loss: 0.3939937
	speed: 0.0030s/iter; left time: 19.1316s
	iters: 1000, epoch: 2 | loss: 0.5110040
	speed: 0.0030s/iter; left time: 18.9357s
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.3108 --> 0.2950).  Saving model state dict ...
Epoch: 2 cost time: 3.0526857376098633
Epoch: 2, Steps: 1045 | Train Loss: 0.6122872 Vali Loss: 0.2949849 Best vali loss: 0.2949849
	iters: 100, epoch: 3 | loss: 1.2968434
	speed: 0.0118s/iter; left time: 72.6848s
	iters: 200, epoch: 3 | loss: 0.3839830
	speed: 0.0026s/iter; left time: 15.8459s
	iters: 300, epoch: 3 | loss: 0.2310542
	speed: 0.0025s/iter; left time: 15.0772s
	iters: 400, epoch: 3 | loss: 0.4594544
	speed: 0.0029s/iter; left time: 16.8050s
	iters: 500, epoch: 3 | loss: 0.3254491
	speed: 0.0029s/iter; left time: 16.7632s
	iters: 600, epoch: 3 | loss: 0.6181324
	speed: 0.0029s/iter; left time: 16.6341s
	iters: 700, epoch: 3 | loss: 0.2076610
	speed: 0.0029s/iter; left time: 16.2605s
	iters: 800, epoch: 3 | loss: 1.4056751
	speed: 0.0029s/iter; left time: 15.9946s
	iters: 900, epoch: 3 | loss: 0.4353624
	speed: 0.0029s/iter; left time: 15.7151s
	iters: 1000, epoch: 3 | loss: 1.4921107
	speed: 0.0029s/iter; left time: 15.5113s
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.2950 --> 0.2880).  Saving model state dict ...
Epoch: 3 cost time: 2.9943642616271973
Epoch: 3, Steps: 1045 | Train Loss: 0.6855726 Vali Loss: 0.2880293 Best vali loss: 0.2880293
	iters: 100, epoch: 4 | loss: 1.3002410
	speed: 0.0112s/iter; left time: 57.4903s
	iters: 200, epoch: 4 | loss: 0.7825229
	speed: 0.0026s/iter; left time: 13.1097s
	iters: 300, epoch: 4 | loss: 0.2390456
	speed: 0.0025s/iter; left time: 12.1035s
	iters: 400, epoch: 4 | loss: 0.4235728
	speed: 0.0022s/iter; left time: 10.7744s
	iters: 500, epoch: 4 | loss: 0.2835509
	speed: 0.0022s/iter; left time: 10.3421s
	iters: 600, epoch: 4 | loss: 0.2359954
	speed: 0.0022s/iter; left time: 10.1897s
	iters: 700, epoch: 4 | loss: 0.5531091
	speed: 0.0028s/iter; left time: 12.6056s
	iters: 800, epoch: 4 | loss: 0.7719905
	speed: 0.0030s/iter; left time: 13.2772s
	iters: 900, epoch: 4 | loss: 0.6498601
	speed: 0.0030s/iter; left time: 13.0272s
	iters: 1000, epoch: 4 | loss: 0.4184025
	speed: 0.0030s/iter; left time: 12.7631s
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.2880 --> 0.2846).  Saving model state dict ...
Epoch: 4 cost time: 2.7968826293945312
Epoch: 4, Steps: 1045 | Train Loss: 0.5658291 Vali Loss: 0.2846455 Best vali loss: 0.2846455
	iters: 100, epoch: 5 | loss: 0.2891217
	speed: 0.0107s/iter; left time: 43.5444s
	iters: 200, epoch: 5 | loss: 0.6555381
	speed: 0.0031s/iter; left time: 12.2219s
	iters: 300, epoch: 5 | loss: 0.2683520
	speed: 0.0030s/iter; left time: 11.7396s
	iters: 400, epoch: 5 | loss: 0.4532433
	speed: 0.0031s/iter; left time: 11.5442s
	iters: 500, epoch: 5 | loss: 0.9222870
	speed: 0.0031s/iter; left time: 11.2982s
	iters: 600, epoch: 5 | loss: 0.2940259
	speed: 0.0028s/iter; left time: 10.1859s
	iters: 700, epoch: 5 | loss: 0.3028597
	speed: 0.0026s/iter; left time: 9.0955s
	iters: 800, epoch: 5 | loss: 0.7738351
	speed: 0.0032s/iter; left time: 10.7425s
	iters: 900, epoch: 5 | loss: 0.2294365
	speed: 0.0031s/iter; left time: 10.0122s
	iters: 1000, epoch: 5 | loss: 1.5773780
	speed: 0.0031s/iter; left time: 9.7132s
Updating learning rate to 2.2430860606471416e-05
Validation loss decreased (0.2846 --> 0.2829).  Saving model state dict ...
Epoch: 5 cost time: 3.1608774662017822
Epoch: 5, Steps: 1045 | Train Loss: 0.5766077 Vali Loss: 0.2829109 Best vali loss: 0.2829109
	iters: 100, epoch: 6 | loss: 0.3698475
	speed: 0.0107s/iter; left time: 32.4947s
	iters: 200, epoch: 6 | loss: 0.2384103
	speed: 0.0021s/iter; left time: 6.0245s
	iters: 300, epoch: 6 | loss: 0.2937337
	speed: 0.0020s/iter; left time: 5.6663s
	iters: 400, epoch: 6 | loss: 0.2269532
	speed: 0.0021s/iter; left time: 5.8795s
	iters: 500, epoch: 6 | loss: 0.7061832
	speed: 0.0026s/iter; left time: 6.9075s
	iters: 600, epoch: 6 | loss: 0.5898536
	speed: 0.0028s/iter; left time: 7.0576s
	iters: 700, epoch: 6 | loss: 0.3456791
	speed: 0.0029s/iter; left time: 7.1610s
	iters: 800, epoch: 6 | loss: 0.2860546
	speed: 0.0030s/iter; left time: 7.0388s
	iters: 900, epoch: 6 | loss: 0.3916343
	speed: 0.0024s/iter; left time: 5.2965s
	iters: 1000, epoch: 6 | loss: 0.4156617
	speed: 0.0024s/iter; left time: 5.0825s
Updating learning rate to 1.0642589731482448e-05
Validation loss decreased (0.2829 --> 0.2822).  Saving model state dict ...
Epoch: 6 cost time: 2.608940839767456
Epoch: 6, Steps: 1045 | Train Loss: 0.3864011 Vali Loss: 0.2821992 Best vali loss: 0.2821992
	iters: 100, epoch: 7 | loss: 0.4439602
	speed: 0.0094s/iter; left time: 18.7246s
	iters: 200, epoch: 7 | loss: 0.3912283
	speed: 0.0029s/iter; left time: 5.4218s
	iters: 300, epoch: 7 | loss: 0.1396813
	speed: 0.0027s/iter; left time: 4.8302s
	iters: 400, epoch: 7 | loss: 0.1750623
	speed: 0.0028s/iter; left time: 4.6605s
	iters: 500, epoch: 7 | loss: 0.3531923
	speed: 0.0027s/iter; left time: 4.2813s
	iters: 600, epoch: 7 | loss: 0.2624975
	speed: 0.0020s/iter; left time: 3.0298s
	iters: 700, epoch: 7 | loss: 0.3029902
	speed: 0.0020s/iter; left time: 2.7922s
	iters: 800, epoch: 7 | loss: 0.2271350
	speed: 0.0021s/iter; left time: 2.7475s
	iters: 900, epoch: 7 | loss: 0.2348271
	speed: 0.0022s/iter; left time: 2.6701s
	iters: 1000, epoch: 7 | loss: 1.2479016
	speed: 0.0030s/iter; left time: 3.2509s
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.2822 --> 0.2820).  Saving model state dict ...
Epoch: 7 cost time: 2.663616180419922
Epoch: 7, Steps: 1045 | Train Loss: 0.3778476 Vali Loss: 0.2819669 Best vali loss: 0.2819669
	iters: 100, epoch: 8 | loss: 0.4628459
	speed: 0.0107s/iter; left time: 10.0831s
	iters: 200, epoch: 8 | loss: 0.6237691
	speed: 0.0027s/iter; left time: 2.2952s
	iters: 300, epoch: 8 | loss: 0.2911073
	speed: 0.0027s/iter; left time: 1.9784s
	iters: 400, epoch: 8 | loss: 1.1472392
	speed: 0.0028s/iter; left time: 1.8372s
	iters: 500, epoch: 8 | loss: 0.6674773
	speed: 0.0026s/iter; left time: 1.3962s
	iters: 600, epoch: 8 | loss: 1.0323073
	speed: 0.0028s/iter; left time: 1.2661s
	iters: 700, epoch: 8 | loss: 0.2907352
	speed: 0.0021s/iter; left time: 0.7284s
	iters: 800, epoch: 8 | loss: 0.9756833
	speed: 0.0020s/iter; left time: 0.4971s
	iters: 900, epoch: 8 | loss: 0.8002651
	speed: 0.0020s/iter; left time: 0.2922s
	iters: 1000, epoch: 8 | loss: 0.3139566
	speed: 0.0024s/iter; left time: 0.1086s
Updating learning rate to 0.0
Validation loss decreased (0.2820 --> 0.2819).  Saving model state dict ...
Epoch: 8 cost time: 2.6528589725494385
Epoch: 8, Steps: 1045 | Train Loss: 0.6605386 Vali Loss: 0.2819133 Best vali loss: 0.2819133

best validation loss 0.28191330676497295

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3637384
	speed: 0.0083s/iter; left time: 33.7918s
	iters: 200, epoch: 1 | loss: 0.3047041
	speed: 0.0027s/iter; left time: 10.6222s
	iters: 300, epoch: 1 | loss: 0.2813017
	speed: 0.0029s/iter; left time: 11.1939s
	iters: 400, epoch: 1 | loss: 0.2805527
	speed: 0.0030s/iter; left time: 11.2837s
	iters: 500, epoch: 1 | loss: 0.7388843
	speed: 0.0026s/iter; left time: 9.5322s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.7465498447418213
Epoch: 1, Steps: 523 | Train Loss: 0.3938362 Vali Loss: 0.2812825 Best vali loss: 0.2812825
	iters: 100, epoch: 2 | loss: 0.8950098
	speed: 0.0078s/iter; left time: 27.9206s
	iters: 200, epoch: 2 | loss: 0.3262112
	speed: 0.0030s/iter; left time: 10.2644s
	iters: 300, epoch: 2 | loss: 0.5716108
	speed: 0.0031s/iter; left time: 10.5721s
	iters: 400, epoch: 2 | loss: 0.3595810
	speed: 0.0031s/iter; left time: 9.9957s
	iters: 500, epoch: 2 | loss: 0.5745732
	speed: 0.0027s/iter; left time: 8.6007s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 1.597663402557373
Epoch: 2, Steps: 523 | Train Loss: 0.5453972 Vali Loss: 0.2869916 Best vali loss: 0.2812825
	iters: 100, epoch: 3 | loss: 0.3759086
	speed: 0.0076s/iter; left time: 23.0640s
	iters: 200, epoch: 3 | loss: 0.3141535
	speed: 0.0028s/iter; left time: 8.2756s
	iters: 300, epoch: 3 | loss: 0.7795614
	speed: 0.0030s/iter; left time: 8.5710s
	iters: 400, epoch: 3 | loss: 0.7282409
	speed: 0.0032s/iter; left time: 8.8755s
	iters: 500, epoch: 3 | loss: 0.4003688
	speed: 0.0032s/iter; left time: 8.3535s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.6389517784118652
Epoch: 3, Steps: 523 | Train Loss: 0.5196466 Vali Loss: 0.2869015 Best vali loss: 0.2812825

best validation loss 0.28128246379501537

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002026610841687957
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 0.5179495811462402
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2847874 Best vali loss: 0.2847874
Updating learning rate to 0.001798262860126036
Epoch: 2 cost time: 0.2748246192932129
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2895282 Best vali loss: 0.2847874
Updating learning rate to 0.0014565159550274328
Epoch: 3 cost time: 0.2872335910797119
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2982991 Best vali loss: 0.2847874

best validation loss 0.2847874210132636

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0103950152165, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5113344
	speed: 0.0085s/iter; left time: 8.0751s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.3003).  Saving model state dict ...
Epoch: 1 cost time: 0.6874985694885254
Epoch: 1, Steps: 131 | Train Loss: 0.5113344 Vali Loss: 0.3003059 Best vali loss: 0.3003059
	iters: 100, epoch: 2 | loss: 0.5838083
	speed: 0.0056s/iter; left time: 4.5886s
Updating learning rate to 0.00093122262415
Validation loss decreased (0.3003 --> 0.2857).  Saving model state dict ...
Epoch: 2 cost time: 0.42185401916503906
Epoch: 2, Steps: 131 | Train Loss: 0.5838083 Vali Loss: 0.2857102 Best vali loss: 0.2857102
	iters: 100, epoch: 3 | loss: 0.4315803
	speed: 0.0057s/iter; left time: 3.9218s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.4370849132537842
Epoch: 3, Steps: 131 | Train Loss: 0.4315803 Vali Loss: 0.2925256 Best vali loss: 0.2857102

best validation loss 0.28571022971882704

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3392161
	speed: 0.0086s/iter; left time: 21.6537s
	iters: 200, epoch: 4 | loss: 0.3095435
	speed: 0.0032s/iter; left time: 7.6760s
	iters: 300, epoch: 4 | loss: 0.2608484
	speed: 0.0031s/iter; left time: 7.2553s
	iters: 400, epoch: 4 | loss: 0.2878653
	speed: 0.0032s/iter; left time: 6.9980s
	iters: 500, epoch: 4 | loss: 0.5512971
	speed: 0.0032s/iter; left time: 6.6767s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 1.9362273216247559
Epoch: 4, Steps: 523 | Train Loss: 0.3497541 Vali Loss: 0.2930358 Best vali loss: 0.2812825
	iters: 100, epoch: 5 | loss: 0.7422298
	speed: 0.0075s/iter; left time: 14.8950s
	iters: 200, epoch: 5 | loss: 0.2844787
	speed: 0.0026s/iter; left time: 4.9757s
	iters: 300, epoch: 5 | loss: 0.5703390
	speed: 0.0027s/iter; left time: 4.7545s
	iters: 400, epoch: 5 | loss: 0.2718314
	speed: 0.0027s/iter; left time: 4.5837s
	iters: 500, epoch: 5 | loss: 0.5361663
	speed: 0.0032s/iter; left time: 5.0619s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 1.5042591094970703
Epoch: 5, Steps: 523 | Train Loss: 0.4810090 Vali Loss: 0.2949453 Best vali loss: 0.2812825
	iters: 100, epoch: 6 | loss: 0.3053237
	speed: 0.0079s/iter; left time: 11.5507s
	iters: 200, epoch: 6 | loss: 0.3100645
	speed: 0.0031s/iter; left time: 4.1823s
	iters: 300, epoch: 6 | loss: 0.6893808
	speed: 0.0030s/iter; left time: 3.8451s
	iters: 400, epoch: 6 | loss: 0.4933556
	speed: 0.0030s/iter; left time: 3.5293s
	iters: 500, epoch: 6 | loss: 0.4124988
	speed: 0.0030s/iter; left time: 3.2593s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 1.6403086185455322
Epoch: 6, Steps: 523 | Train Loss: 0.4421247 Vali Loss: 0.3016999 Best vali loss: 0.2812825
	iters: 100, epoch: 7 | loss: 0.4879828
	speed: 0.0078s/iter; left time: 7.3427s
	iters: 200, epoch: 7 | loss: 0.2036105
	speed: 0.0029s/iter; left time: 2.4388s
	iters: 300, epoch: 7 | loss: 0.3561366
	speed: 0.0029s/iter; left time: 2.1835s
	iters: 400, epoch: 7 | loss: 0.5382662
	speed: 0.0029s/iter; left time: 1.8867s
	iters: 500, epoch: 7 | loss: 0.4450734
	speed: 0.0031s/iter; left time: 1.6872s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 1.5952234268188477
Epoch: 7, Steps: 523 | Train Loss: 0.4062139 Vali Loss: 0.2974672 Best vali loss: 0.2812825
	iters: 100, epoch: 8 | loss: 0.4098441
	speed: 0.0077s/iter; left time: 3.2535s
	iters: 200, epoch: 8 | loss: 0.4873098
	speed: 0.0030s/iter; left time: 0.9726s
	iters: 300, epoch: 8 | loss: 0.3777263
	speed: 0.0030s/iter; left time: 0.6714s
	iters: 400, epoch: 8 | loss: 0.2692084
	speed: 0.0030s/iter; left time: 0.3728s
	iters: 500, epoch: 8 | loss: 0.3187605
	speed: 0.0029s/iter; left time: 0.0684s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5851693153381348
Epoch: 8, Steps: 523 | Train Loss: 0.3725698 Vali Loss: 0.2985837 Best vali loss: 0.2812825

best validation loss 0.28128246379501537

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015627682118, 'e_layers': 4, 'learning_rate': 7.53636528e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6969698
	speed: 0.0118s/iter; left time: 11.2075s
Updating learning rate to 7.53636528e-05
Validation loss decreased (inf --> 0.3354).  Saving model state dict ...
Epoch: 1 cost time: 1.1085515022277832
Epoch: 1, Steps: 131 | Train Loss: 0.6969698 Vali Loss: 0.3354007 Best vali loss: 0.3354007
	iters: 100, epoch: 2 | loss: 0.6950095
	speed: 0.0105s/iter; left time: 8.5535s
Updating learning rate to 3.76818264e-05
Validation loss decreased (0.3354 --> 0.3193).  Saving model state dict ...
Epoch: 2 cost time: 0.8886332511901855
Epoch: 2, Steps: 131 | Train Loss: 0.6950095 Vali Loss: 0.3193046 Best vali loss: 0.3193046
	iters: 100, epoch: 3 | loss: 0.4995722
	speed: 0.0106s/iter; left time: 7.2736s
Updating learning rate to 1.88409132e-05
Validation loss decreased (0.3193 --> 0.3133).  Saving model state dict ...
Epoch: 3 cost time: 0.8979527950286865
Epoch: 3, Steps: 131 | Train Loss: 0.4995722 Vali Loss: 0.3132720 Best vali loss: 0.3132720
	iters: 100, epoch: 4 | loss: 0.5470237
	speed: 0.0103s/iter; left time: 5.7530s
Updating learning rate to 9.4204566e-06
Validation loss decreased (0.3133 --> 0.3108).  Saving model state dict ...
Epoch: 4 cost time: 0.8727617263793945
Epoch: 4, Steps: 131 | Train Loss: 0.5470237 Vali Loss: 0.3108467 Best vali loss: 0.3108467
	iters: 100, epoch: 5 | loss: 0.6394992
	speed: 0.0103s/iter; left time: 4.3762s
Updating learning rate to 4.7102283e-06
Validation loss decreased (0.3108 --> 0.3097).  Saving model state dict ...
Epoch: 5 cost time: 0.862462043762207
Epoch: 5, Steps: 131 | Train Loss: 0.6394992 Vali Loss: 0.3096697 Best vali loss: 0.3096697
	iters: 100, epoch: 6 | loss: 0.3788335
	speed: 0.0102s/iter; left time: 3.0070s
Updating learning rate to 2.35511415e-06
Validation loss decreased (0.3097 --> 0.3091).  Saving model state dict ...
Epoch: 6 cost time: 0.8471825122833252
Epoch: 6, Steps: 131 | Train Loss: 0.3788335 Vali Loss: 0.3091236 Best vali loss: 0.3091236
	iters: 100, epoch: 7 | loss: 0.3626446
	speed: 0.0096s/iter; left time: 1.5686s
Updating learning rate to 1.177557075e-06
Validation loss decreased (0.3091 --> 0.3089).  Saving model state dict ...
Epoch: 7 cost time: 0.8181262016296387
Epoch: 7, Steps: 131 | Train Loss: 0.3626446 Vali Loss: 0.3088500 Best vali loss: 0.3088500
	iters: 100, epoch: 8 | loss: 0.4084716
	speed: 0.0103s/iter; left time: 0.3303s
Updating learning rate to 5.887785375e-07
Validation loss decreased (0.3089 --> 0.3087).  Saving model state dict ...
Epoch: 8 cost time: 0.8672521114349365
Epoch: 8, Steps: 131 | Train Loss: 0.4084716 Vali Loss: 0.3087110 Best vali loss: 0.3087110

best validation loss 0.3087110299355215

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 4, 'learning_rate': 0.0040085882975, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9433817
	speed: 0.0114s/iter; left time: 94.5690s
	iters: 200, epoch: 1 | loss: 0.5935915
	speed: 0.0062s/iter; left time: 50.9726s
	iters: 300, epoch: 1 | loss: 0.7724891
	speed: 0.0062s/iter; left time: 50.2167s
	iters: 400, epoch: 1 | loss: 0.4160764
	speed: 0.0062s/iter; left time: 49.4731s
	iters: 500, epoch: 1 | loss: 0.2720425
	speed: 0.0062s/iter; left time: 48.3552s
	iters: 600, epoch: 1 | loss: 1.2014257
	speed: 0.0061s/iter; left time: 47.6732s
	iters: 700, epoch: 1 | loss: 0.3955585
	speed: 0.0059s/iter; left time: 44.8239s
	iters: 800, epoch: 1 | loss: 0.4085651
	speed: 0.0057s/iter; left time: 43.3716s
	iters: 900, epoch: 1 | loss: 0.3303247
	speed: 0.0059s/iter; left time: 43.7054s
	iters: 1000, epoch: 1 | loss: 0.8710249
	speed: 0.0062s/iter; left time: 45.3984s
Updating learning rate to 0.0038560204899122574
Validation loss decreased (inf --> 0.2940).  Saving model state dict ...
Epoch: 1 cost time: 6.6283886432647705
Epoch: 1, Steps: 1045 | Train Loss: 0.6204480 Vali Loss: 0.2939769 Best vali loss: 0.2939769
	iters: 100, epoch: 2 | loss: 0.4385764
	speed: 0.0184s/iter; left time: 133.0734s
	iters: 200, epoch: 2 | loss: 0.3661505
	speed: 0.0062s/iter; left time: 44.3903s
	iters: 300, epoch: 2 | loss: 0.3525063
	speed: 0.0063s/iter; left time: 44.4093s
	iters: 400, epoch: 2 | loss: 1.1240155
	speed: 0.0061s/iter; left time: 42.4731s
	iters: 500, epoch: 2 | loss: 0.9188031
	speed: 0.0060s/iter; left time: 41.1035s
	iters: 600, epoch: 2 | loss: 0.1950439
	speed: 0.0060s/iter; left time: 40.4166s
	iters: 700, epoch: 2 | loss: 0.3355860
	speed: 0.0059s/iter; left time: 39.0408s
	iters: 800, epoch: 2 | loss: 0.3701719
	speed: 0.0057s/iter; left time: 37.4416s
	iters: 900, epoch: 2 | loss: 0.3810033
	speed: 0.0055s/iter; left time: 35.1801s
	iters: 1000, epoch: 2 | loss: 0.3460379
	speed: 0.0062s/iter; left time: 39.1464s
Updating learning rate to 0.0034215441328236435
Validation loss decreased (0.2940 --> 0.2856).  Saving model state dict ...
Epoch: 2 cost time: 6.35128927230835
Epoch: 2, Steps: 1045 | Train Loss: 0.4827895 Vali Loss: 0.2855510 Best vali loss: 0.2855510
	iters: 100, epoch: 3 | loss: 0.3700943
	speed: 0.0183s/iter; left time: 112.7170s
	iters: 200, epoch: 3 | loss: 0.1417271
	speed: 0.0062s/iter; left time: 37.8694s
	iters: 300, epoch: 3 | loss: 1.1351030
	speed: 0.0062s/iter; left time: 36.9390s
	iters: 400, epoch: 3 | loss: 0.2638942
	speed: 0.0063s/iter; left time: 36.7772s
	iters: 500, epoch: 3 | loss: 0.2409591
	speed: 0.0063s/iter; left time: 36.5147s
	iters: 600, epoch: 3 | loss: 0.5791138
	speed: 0.0063s/iter; left time: 35.5684s
	iters: 700, epoch: 3 | loss: 0.2739435
	speed: 0.0063s/iter; left time: 35.0108s
	iters: 800, epoch: 3 | loss: 1.0809767
	speed: 0.0058s/iter; left time: 31.6187s
	iters: 900, epoch: 3 | loss: 0.5301421
	speed: 0.0054s/iter; left time: 29.1256s
	iters: 1000, epoch: 3 | loss: 0.3062083
	speed: 0.0059s/iter; left time: 31.3223s
Updating learning rate to 0.002771304313062916
Validation loss decreased (0.2856 --> 0.2848).  Saving model state dict ...
Epoch: 3 cost time: 6.420608043670654
Epoch: 3, Steps: 1045 | Train Loss: 0.4922162 Vali Loss: 0.2847540 Best vali loss: 0.2847540
	iters: 100, epoch: 4 | loss: 1.2704142
	speed: 0.0185s/iter; left time: 94.6212s
	iters: 200, epoch: 4 | loss: 0.3204032
	speed: 0.0061s/iter; left time: 30.7213s
	iters: 300, epoch: 4 | loss: 0.2925697
	speed: 0.0061s/iter; left time: 30.1734s
	iters: 400, epoch: 4 | loss: 0.3241333
	speed: 0.0061s/iter; left time: 29.3913s
	iters: 500, epoch: 4 | loss: 1.0272796
	speed: 0.0061s/iter; left time: 28.7824s
	iters: 600, epoch: 4 | loss: 0.2530172
	speed: 0.0061s/iter; left time: 28.1752s
	iters: 700, epoch: 4 | loss: 0.7724935
	speed: 0.0061s/iter; left time: 27.8149s
	iters: 800, epoch: 4 | loss: 0.2941602
	speed: 0.0059s/iter; left time: 26.0914s
	iters: 900, epoch: 4 | loss: 0.3510138
	speed: 0.0056s/iter; left time: 24.1841s
	iters: 1000, epoch: 4 | loss: 0.3979709
	speed: 0.0057s/iter; left time: 24.0610s
Updating learning rate to 0.00200429414875
Epoch: 4 cost time: 6.315222978591919
Epoch: 4, Steps: 1045 | Train Loss: 0.5303456 Vali Loss: 0.2869800 Best vali loss: 0.2847540
	iters: 100, epoch: 5 | loss: 1.2674564
	speed: 0.0186s/iter; left time: 75.7074s
	iters: 200, epoch: 5 | loss: 0.7226645
	speed: 0.0063s/iter; left time: 24.9200s
	iters: 300, epoch: 5 | loss: 0.2667441
	speed: 0.0063s/iter; left time: 24.3292s
	iters: 400, epoch: 5 | loss: 0.4582301
	speed: 0.0063s/iter; left time: 23.6704s
	iters: 500, epoch: 5 | loss: 0.4063487
	speed: 0.0063s/iter; left time: 23.0740s
	iters: 600, epoch: 5 | loss: 0.4657378
	speed: 0.0063s/iter; left time: 22.4823s
	iters: 700, epoch: 5 | loss: 0.5349247
	speed: 0.0063s/iter; left time: 21.8065s
	iters: 800, epoch: 5 | loss: 0.4297818
	speed: 0.0063s/iter; left time: 21.2628s
	iters: 900, epoch: 5 | loss: 0.3068953
	speed: 0.0057s/iter; left time: 18.7703s
	iters: 1000, epoch: 5 | loss: 0.3111647
	speed: 0.0055s/iter; left time: 17.4728s
Updating learning rate to 0.0012372839844370842
Epoch: 5 cost time: 6.409341335296631
Epoch: 5, Steps: 1045 | Train Loss: 0.5169948 Vali Loss: 0.2916789 Best vali loss: 0.2847540
	iters: 100, epoch: 6 | loss: 0.1915994
	speed: 0.0159s/iter; left time: 48.2825s
	iters: 200, epoch: 6 | loss: 0.3827949
	speed: 0.0065s/iter; left time: 19.0826s
	iters: 300, epoch: 6 | loss: 0.3899971
	speed: 0.0051s/iter; left time: 14.5706s
	iters: 400, epoch: 6 | loss: 0.2372272
	speed: 0.0043s/iter; left time: 11.8663s
	iters: 500, epoch: 6 | loss: 0.2534129
	speed: 0.0097s/iter; left time: 25.5138s
	iters: 600, epoch: 6 | loss: 0.3337823
	speed: 0.0101s/iter; left time: 25.4982s
	iters: 700, epoch: 6 | loss: 0.4954263
	speed: 0.0117s/iter; left time: 28.5769s
	iters: 800, epoch: 6 | loss: 0.2093746
	speed: 0.0138s/iter; left time: 32.3153s
	iters: 900, epoch: 6 | loss: 0.3066687
	speed: 0.0050s/iter; left time: 11.1972s
	iters: 1000, epoch: 6 | loss: 0.4389338
	speed: 0.0050s/iter; left time: 10.6078s
Updating learning rate to 0.0005870441646763563
Epoch: 6 cost time: 8.060412645339966
Epoch: 6, Steps: 1045 | Train Loss: 0.3239217 Vali Loss: 0.2991705 Best vali loss: 0.2847540
	iters: 100, epoch: 7 | loss: 0.5071208
	speed: 0.0184s/iter; left time: 36.6654s
	iters: 200, epoch: 7 | loss: 0.3781359
	speed: 0.0059s/iter; left time: 11.1247s
	iters: 300, epoch: 7 | loss: 0.6090031
	speed: 0.0058s/iter; left time: 10.4375s
	iters: 400, epoch: 7 | loss: 0.5147130
	speed: 0.0057s/iter; left time: 9.7097s
	iters: 500, epoch: 7 | loss: 0.5062059
	speed: 0.0060s/iter; left time: 9.5193s
	iters: 600, epoch: 7 | loss: 0.2425456
	speed: 0.0060s/iter; left time: 8.9757s
	iters: 700, epoch: 7 | loss: 0.2804282
	speed: 0.0058s/iter; left time: 8.0388s
	iters: 800, epoch: 7 | loss: 0.3022161
	speed: 0.0045s/iter; left time: 5.7739s
	iters: 900, epoch: 7 | loss: 0.2701319
	speed: 0.0052s/iter; left time: 6.1519s
	iters: 1000, epoch: 7 | loss: 0.5391500
	speed: 0.0062s/iter; left time: 6.7126s
Updating learning rate to 0.0001525678075877426
Epoch: 7 cost time: 5.993730306625366
Epoch: 7, Steps: 1045 | Train Loss: 0.4149650 Vali Loss: 0.2969623 Best vali loss: 0.2847540
	iters: 100, epoch: 8 | loss: 0.2465176
	speed: 0.0180s/iter; left time: 17.0175s
	iters: 200, epoch: 8 | loss: 0.2675720
	speed: 0.0059s/iter; left time: 4.9687s
	iters: 300, epoch: 8 | loss: 0.6430027
	speed: 0.0057s/iter; left time: 4.2212s
	iters: 400, epoch: 8 | loss: 0.9025064
	speed: 0.0059s/iter; left time: 3.8008s
	iters: 500, epoch: 8 | loss: 0.1667968
	speed: 0.0059s/iter; left time: 3.2120s
	iters: 600, epoch: 8 | loss: 0.6759377
	speed: 0.0056s/iter; left time: 2.4843s
	iters: 700, epoch: 8 | loss: 0.1925682
	speed: 0.0059s/iter; left time: 2.0482s
	iters: 800, epoch: 8 | loss: 0.2998144
	speed: 0.0060s/iter; left time: 1.4839s
	iters: 900, epoch: 8 | loss: 1.5361770
	speed: 0.0059s/iter; left time: 0.8630s
	iters: 1000, epoch: 8 | loss: 0.3600080
	speed: 0.0060s/iter; left time: 0.2763s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.175773620605469
Epoch: 8, Steps: 1045 | Train Loss: 0.5290901 Vali Loss: 0.3006117 Best vali loss: 0.2847540

best validation loss 0.2847539530938866

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0042863874146, 'e_layers': 4, 'learning_rate': 5.37539066e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37539066e-05
Validation loss decreased (inf --> 0.3486).  Saving model state dict ...
Epoch: 1 cost time: 0.7560310363769531
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3486027 Best vali loss: 0.3486027
Updating learning rate to 2.68769533e-05
Validation loss decreased (0.3486 --> 0.3366).  Saving model state dict ...
Epoch: 2 cost time: 0.4882340431213379
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3366468 Best vali loss: 0.3366468
Updating learning rate to 1.343847665e-05
Validation loss decreased (0.3366 --> 0.3322).  Saving model state dict ...
Epoch: 3 cost time: 0.5096285343170166
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3322154 Best vali loss: 0.3322154

best validation loss 0.332215409433589

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019514269464, 'e_layers': 3, 'learning_rate': 0.0028203081441, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5894333
	speed: 0.0148s/iter; left time: 14.0540s
Updating learning rate to 0.002712966556904441
Validation loss decreased (inf --> 0.3201).  Saving model state dict ...
Epoch: 1 cost time: 1.5002944469451904
Epoch: 1, Steps: 131 | Train Loss: 0.5894333 Vali Loss: 0.3200833 Best vali loss: 0.3200833
	iters: 100, epoch: 2 | loss: 0.5438456
	speed: 0.0152s/iter; left time: 12.4593s
Updating learning rate to 0.002407283578914378
Epoch: 2 cost time: 1.2584726810455322
Epoch: 2, Steps: 131 | Train Loss: 0.5438456 Vali Loss: 0.3293410 Best vali loss: 0.3200833
	iters: 100, epoch: 3 | loss: 0.4639833
	speed: 0.0149s/iter; left time: 10.2069s
Updating learning rate to 0.0019497966725057021
Epoch: 3 cost time: 1.2160601615905762
Epoch: 3, Steps: 131 | Train Loss: 0.4639833 Vali Loss: 0.3256455 Best vali loss: 0.3200833

best validation loss 0.3200832983626447

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4627684
	speed: 0.0122s/iter; left time: 24.2775s
	iters: 200, epoch: 1 | loss: 0.4208206
	speed: 0.0064s/iter; left time: 12.2180s
Updating learning rate to 0.00031785342192023166
Validation loss decreased (inf --> 0.2841).  Saving model state dict ...
Epoch: 1 cost time: 2.0012309551239014
Epoch: 1, Steps: 262 | Train Loss: 0.4417945 Vali Loss: 0.2841347 Best vali loss: 0.2841347
	iters: 100, epoch: 2 | loss: 0.4478254
	speed: 0.0136s/iter; left time: 23.5119s
	iters: 200, epoch: 2 | loss: 0.4573703
	speed: 0.0060s/iter; left time: 9.7483s
Updating learning rate to 0.0002820393495610895
Validation loss decreased (0.2841 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 1.6406865119934082
Epoch: 2, Steps: 262 | Train Loss: 0.4525978 Vali Loss: 0.2826234 Best vali loss: 0.2826234
	iters: 100, epoch: 3 | loss: 0.4413480
	speed: 0.0122s/iter; left time: 18.0384s
	iters: 200, epoch: 3 | loss: 0.4024515
	speed: 0.0057s/iter; left time: 7.7846s
Updating learning rate to 0.00022843980248387857
Epoch: 3 cost time: 1.5428597927093506
Epoch: 3, Steps: 262 | Train Loss: 0.4218998 Vali Loss: 0.2848096 Best vali loss: 0.2826234

best validation loss 0.2826234357048473

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3870925
	speed: 0.0115s/iter; left time: 13.9212s
	iters: 200, epoch: 4 | loss: 0.4004986
	speed: 0.0060s/iter; left time: 6.6300s
Updating learning rate to 0.00016521482585
Epoch: 4 cost time: 1.8198151588439941
Epoch: 4, Steps: 262 | Train Loss: 0.3937955 Vali Loss: 0.2869956 Best vali loss: 0.2826234
	iters: 100, epoch: 5 | loss: 0.4178544
	speed: 0.0126s/iter; left time: 11.9928s
	iters: 200, epoch: 5 | loss: 0.4650396
	speed: 0.0057s/iter; left time: 4.8700s
Updating learning rate to 0.00010198984921612144
Epoch: 5 cost time: 1.5878417491912842
Epoch: 5, Steps: 262 | Train Loss: 0.4414470 Vali Loss: 0.2957769 Best vali loss: 0.2826234
	iters: 100, epoch: 6 | loss: 0.4450401
	speed: 0.0124s/iter; left time: 8.5056s
	iters: 200, epoch: 6 | loss: 0.2871782
	speed: 0.0064s/iter; left time: 3.7571s
Updating learning rate to 4.8390302138910505e-05
Epoch: 6 cost time: 1.6224796772003174
Epoch: 6, Steps: 262 | Train Loss: 0.3661092 Vali Loss: 0.2957315 Best vali loss: 0.2826234
	iters: 100, epoch: 7 | loss: 0.6128438
	speed: 0.0131s/iter; left time: 5.5518s
	iters: 200, epoch: 7 | loss: 0.3591413
	speed: 0.0060s/iter; left time: 1.9645s
Updating learning rate to 1.2576229779768348e-05
Epoch: 7 cost time: 1.6736831665039062
Epoch: 7, Steps: 262 | Train Loss: 0.4859925 Vali Loss: 0.2965944 Best vali loss: 0.2826234
	iters: 100, epoch: 8 | loss: 0.3473563
	speed: 0.0130s/iter; left time: 2.1175s
	iters: 200, epoch: 8 | loss: 0.3297523
	speed: 0.0055s/iter; left time: 0.3478s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5260536670684814
Epoch: 8, Steps: 262 | Train Loss: 0.3385543 Vali Loss: 0.2988131 Best vali loss: 0.2826234

best validation loss 0.2826234357048473

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0061161357241, 'e_layers': 2, 'learning_rate': 0.0026491544935, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3993894
	speed: 0.0092s/iter; left time: 18.4483s
	iters: 200, epoch: 1 | loss: 0.3150782
	speed: 0.0038s/iter; left time: 7.2063s
Updating learning rate to 0.0026491544935
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.2913568019866943
Epoch: 1, Steps: 262 | Train Loss: 0.3572338 Vali Loss: 0.2813078 Best vali loss: 0.2813078
	iters: 100, epoch: 2 | loss: 0.4453451
	speed: 0.0090s/iter; left time: 15.5725s
	iters: 200, epoch: 2 | loss: 0.3697793
	speed: 0.0039s/iter; left time: 6.4041s
Updating learning rate to 0.00132457724675
Epoch: 2 cost time: 1.0837633609771729
Epoch: 2, Steps: 262 | Train Loss: 0.4075622 Vali Loss: 0.2852282 Best vali loss: 0.2813078
	iters: 100, epoch: 3 | loss: 0.3988144
	speed: 0.0090s/iter; left time: 13.2977s
	iters: 200, epoch: 3 | loss: 0.2168953
	speed: 0.0039s/iter; left time: 5.3094s
Updating learning rate to 0.000662288623375
Epoch: 3 cost time: 1.0460901260375977
Epoch: 3, Steps: 262 | Train Loss: 0.3078549 Vali Loss: 0.2846854 Best vali loss: 0.2813078
	iters: 100, epoch: 4 | loss: 0.4175521
	speed: 0.0084s/iter; left time: 10.1580s
	iters: 200, epoch: 4 | loss: 0.2712150
	speed: 0.0040s/iter; left time: 4.3933s
Updating learning rate to 0.0003311443116875
Epoch: 4 cost time: 1.082334041595459
Epoch: 4, Steps: 262 | Train Loss: 0.3443836 Vali Loss: 0.2961046 Best vali loss: 0.2813078
	iters: 100, epoch: 5 | loss: 0.3629660
	speed: 0.0089s/iter; left time: 8.4637s
	iters: 200, epoch: 5 | loss: 0.2552904
	speed: 0.0040s/iter; left time: 3.3630s
Updating learning rate to 0.00016557215584375
Epoch: 5 cost time: 1.0993483066558838
Epoch: 5, Steps: 262 | Train Loss: 0.3091282 Vali Loss: 0.2950087 Best vali loss: 0.2813078
	iters: 100, epoch: 6 | loss: 0.3414206
	speed: 0.0094s/iter; left time: 6.4563s
	iters: 200, epoch: 6 | loss: 0.4395116
	speed: 0.0039s/iter; left time: 2.2906s
Updating learning rate to 8.2786077921875e-05
Epoch: 6 cost time: 1.0815014839172363
Epoch: 6, Steps: 262 | Train Loss: 0.3904661 Vali Loss: 0.2910741 Best vali loss: 0.2813078
	iters: 100, epoch: 7 | loss: 0.6043049
	speed: 0.0089s/iter; left time: 3.7744s
	iters: 200, epoch: 7 | loss: 0.4081481
	speed: 0.0043s/iter; left time: 1.4028s
Updating learning rate to 4.13930389609375e-05
Epoch: 7 cost time: 1.1357247829437256
Epoch: 7, Steps: 262 | Train Loss: 0.5062265 Vali Loss: 0.2962478 Best vali loss: 0.2813078
	iters: 100, epoch: 8 | loss: 0.4435588
	speed: 0.0088s/iter; left time: 1.4338s
	iters: 200, epoch: 8 | loss: 0.3856049
	speed: 0.0038s/iter; left time: 0.2401s
Updating learning rate to 2.069651948046875e-05
Epoch: 8 cost time: 1.0485172271728516
Epoch: 8, Steps: 262 | Train Loss: 0.4145819 Vali Loss: 0.2954244 Best vali loss: 0.2813078

best validation loss 0.28130779588541693

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062416843763, 'e_layers': 2, 'learning_rate': 9.67455128e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7228573
	speed: 0.0092s/iter; left time: 18.3440s
	iters: 200, epoch: 1 | loss: 0.6687163
	speed: 0.0040s/iter; left time: 7.5166s
Updating learning rate to 9.306335596911435e-05
Validation loss decreased (inf --> 0.3051).  Saving model state dict ...
Epoch: 1 cost time: 1.291597843170166
Epoch: 1, Steps: 262 | Train Loss: 0.6957868 Vali Loss: 0.3050674 Best vali loss: 0.3050674
	iters: 100, epoch: 2 | loss: 0.6898043
	speed: 0.0092s/iter; left time: 15.9020s
	iters: 200, epoch: 2 | loss: 0.4270598
	speed: 0.0040s/iter; left time: 6.5426s
Updating learning rate to 8.257746047512496e-05
Validation loss decreased (0.3051 --> 0.2885).  Saving model state dict ...
Epoch: 2 cost time: 1.1117172241210938
Epoch: 2, Steps: 262 | Train Loss: 0.5584320 Vali Loss: 0.2884928 Best vali loss: 0.2884928
	iters: 100, epoch: 3 | loss: 0.6958114
	speed: 0.0091s/iter; left time: 13.4657s
	iters: 200, epoch: 3 | loss: 0.8654882
	speed: 0.0037s/iter; left time: 5.1260s
Updating learning rate to 6.688420885211237e-05
Validation loss decreased (0.2885 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 1.0524814128875732
Epoch: 3, Steps: 262 | Train Loss: 0.7806498 Vali Loss: 0.2838817 Best vali loss: 0.2838817
	iters: 100, epoch: 4 | loss: 0.6545815
	speed: 0.0086s/iter; left time: 10.3906s
	iters: 200, epoch: 4 | loss: 0.5055830
	speed: 0.0040s/iter; left time: 4.3942s
Updating learning rate to 4.83727564e-05
Validation loss decreased (0.2839 --> 0.2819).  Saving model state dict ...
Epoch: 4 cost time: 1.0582575798034668
Epoch: 4, Steps: 262 | Train Loss: 0.5800823 Vali Loss: 0.2818819 Best vali loss: 0.2818819
	iters: 100, epoch: 5 | loss: 0.3311557
	speed: 0.0086s/iter; left time: 8.1721s
	iters: 200, epoch: 5 | loss: 0.4884556
	speed: 0.0036s/iter; left time: 3.0951s
Updating learning rate to 2.986130394788764e-05
Epoch: 5 cost time: 1.0308284759521484
Epoch: 5, Steps: 262 | Train Loss: 0.4098056 Vali Loss: 0.2820011 Best vali loss: 0.2818819
	iters: 100, epoch: 6 | loss: 0.6537849
	speed: 0.0106s/iter; left time: 7.2537s
	iters: 200, epoch: 6 | loss: 0.2843307
	speed: 0.0048s/iter; left time: 2.8137s
Updating learning rate to 1.4168052324875036e-05
Validation loss decreased (0.2819 --> 0.2814).  Saving model state dict ...
Epoch: 6 cost time: 1.2522740364074707
Epoch: 6, Steps: 262 | Train Loss: 0.4690578 Vali Loss: 0.2813809 Best vali loss: 0.2813809
	iters: 100, epoch: 7 | loss: 0.5087303
	speed: 0.0116s/iter; left time: 4.9314s
	iters: 200, epoch: 7 | loss: 0.3118905
	speed: 0.0048s/iter; left time: 1.5545s
Updating learning rate to 3.682156830885646e-06
Validation loss decreased (0.2814 --> 0.2814).  Saving model state dict ...
Epoch: 7 cost time: 1.295395851135254
Epoch: 7, Steps: 262 | Train Loss: 0.4103104 Vali Loss: 0.2813752 Best vali loss: 0.2813752
	iters: 100, epoch: 8 | loss: 0.4070908
	speed: 0.0117s/iter; left time: 1.8992s
	iters: 200, epoch: 8 | loss: 0.3747903
	speed: 0.0047s/iter; left time: 0.2932s
Updating learning rate to 0.0
Validation loss decreased (0.2814 --> 0.2814).  Saving model state dict ...
Epoch: 8 cost time: 1.2614548206329346
Epoch: 8, Steps: 262 | Train Loss: 0.3909405 Vali Loss: 0.2813718 Best vali loss: 0.2813718

best validation loss 0.2813718357064902

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6153992
	speed: 0.0092s/iter; left time: 18.2964s
	iters: 200, epoch: 1 | loss: 0.7840914
	speed: 0.0037s/iter; left time: 7.0705s
Updating learning rate to 0.000288581929876693
Validation loss decreased (inf --> 0.2806).  Saving model state dict ...
Epoch: 1 cost time: 1.262467622756958
Epoch: 1, Steps: 262 | Train Loss: 0.6997453 Vali Loss: 0.2806478 Best vali loss: 0.2806478
	iters: 100, epoch: 2 | loss: 0.3516540
	speed: 0.0094s/iter; left time: 16.3615s
	iters: 200, epoch: 2 | loss: 0.6151470
	speed: 0.0040s/iter; left time: 6.5517s
Updating learning rate to 0.00025606601717798207
Epoch: 2 cost time: 1.141937255859375
Epoch: 2, Steps: 262 | Train Loss: 0.4834005 Vali Loss: 0.2833470 Best vali loss: 0.2806478
	iters: 100, epoch: 3 | loss: 0.6335730
	speed: 0.0092s/iter; left time: 13.5158s
	iters: 200, epoch: 3 | loss: 0.3991112
	speed: 0.0041s/iter; left time: 5.6242s
Updating learning rate to 0.00020740251485476345
Validation loss decreased (0.2806 --> 0.2795).  Saving model state dict ...
Epoch: 3 cost time: 1.1265652179718018
Epoch: 3, Steps: 262 | Train Loss: 0.5163421 Vali Loss: 0.2794538 Best vali loss: 0.2794538

best validation loss 0.279453784953311

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.003415295389, 'e_layers': 1, 'learning_rate': 0.0001528244414, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5476066
	speed: 0.0083s/iter; left time: 16.6334s
	iters: 200, epoch: 1 | loss: 0.4767633
	speed: 0.0028s/iter; left time: 5.2514s
Updating learning rate to 0.00014700790743846527
Validation loss decreased (inf --> 0.2972).  Saving model state dict ...
Epoch: 1 cost time: 1.0107061862945557
Epoch: 1, Steps: 262 | Train Loss: 0.5121849 Vali Loss: 0.2971521 Best vali loss: 0.2971521
	iters: 100, epoch: 2 | loss: 0.7091787
	speed: 0.0070s/iter; left time: 12.1474s
	iters: 200, epoch: 2 | loss: 0.2662944
	speed: 0.0028s/iter; left time: 4.5400s
Updating learning rate to 0.00013044382012249305
Validation loss decreased (0.2972 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 0.781813383102417
Epoch: 2, Steps: 262 | Train Loss: 0.4877365 Vali Loss: 0.2836074 Best vali loss: 0.2836074
	iters: 100, epoch: 3 | loss: 0.4037339
	speed: 0.0071s/iter; left time: 10.4686s
	iters: 200, epoch: 3 | loss: 0.4321185
	speed: 0.0030s/iter; left time: 4.0779s
Updating learning rate to 0.00010565391159211477
Validation loss decreased (0.2836 --> 0.2803).  Saving model state dict ...
Epoch: 3 cost time: 0.8162498474121094
Epoch: 3, Steps: 262 | Train Loss: 0.4179262 Vali Loss: 0.2802865 Best vali loss: 0.2802865

best validation loss 0.2802864621178995

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0025198955415, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7257761
	speed: 0.0081s/iter; left time: 16.2304s
	iters: 200, epoch: 1 | loss: 0.4565246
	speed: 0.0030s/iter; left time: 5.6086s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 1.025688648223877
Epoch: 1, Steps: 262 | Train Loss: 0.5911503 Vali Loss: 0.2861488 Best vali loss: 0.2861488
	iters: 100, epoch: 2 | loss: 0.4750740
	speed: 0.0071s/iter; left time: 12.3849s
	iters: 200, epoch: 2 | loss: 0.3832558
	speed: 0.0030s/iter; left time: 4.8252s
Updating learning rate to 0.0002612410192867383
Validation loss decreased (0.2861 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 0.8012912273406982
Epoch: 2, Steps: 262 | Train Loss: 0.4291649 Vali Loss: 0.2832602 Best vali loss: 0.2832602
	iters: 100, epoch: 3 | loss: 0.5606263
	speed: 0.0073s/iter; left time: 10.7017s
	iters: 200, epoch: 3 | loss: 0.8776649
	speed: 0.0031s/iter; left time: 4.2786s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 0.8641788959503174
Epoch: 3, Steps: 262 | Train Loss: 0.7191456 Vali Loss: 0.2849766 Best vali loss: 0.2832602

best validation loss 0.2832601694546033

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4768445
	speed: 0.0103s/iter; left time: 12.4310s
	iters: 200, epoch: 4 | loss: 0.7225666
	speed: 0.0042s/iter; left time: 4.6815s
Updating learning rate to 0.00015
Epoch: 4 cost time: 1.3881704807281494
Epoch: 4, Steps: 262 | Train Loss: 0.5997055 Vali Loss: 0.2823245 Best vali loss: 0.2794538
	iters: 100, epoch: 5 | loss: 0.3349438
	speed: 0.0096s/iter; left time: 9.1307s
	iters: 200, epoch: 5 | loss: 0.5542583
	speed: 0.0045s/iter; left time: 3.8172s
Updating learning rate to 9.259748514523653e-05
Epoch: 5 cost time: 1.2347266674041748
Epoch: 5, Steps: 262 | Train Loss: 0.4446011 Vali Loss: 0.2852325 Best vali loss: 0.2794538
	iters: 100, epoch: 6 | loss: 0.6081523
	speed: 0.0099s/iter; left time: 6.8327s
	iters: 200, epoch: 6 | loss: 0.3740434
	speed: 0.0042s/iter; left time: 2.4516s
Updating learning rate to 4.3933982822017876e-05
Epoch: 6 cost time: 1.1620454788208008
Epoch: 6, Steps: 262 | Train Loss: 0.4910979 Vali Loss: 0.2846867 Best vali loss: 0.2794538
	iters: 100, epoch: 7 | loss: 0.3198563
	speed: 0.0081s/iter; left time: 3.4490s
	iters: 200, epoch: 7 | loss: 0.5142543
	speed: 0.0035s/iter; left time: 1.1366s
Updating learning rate to 1.1418070123306989e-05
Epoch: 7 cost time: 1.0704700946807861
Epoch: 7, Steps: 262 | Train Loss: 0.4170553 Vali Loss: 0.2836922 Best vali loss: 0.2794538
	iters: 100, epoch: 8 | loss: 0.3588851
	speed: 0.0124s/iter; left time: 2.0237s
	iters: 200, epoch: 8 | loss: 0.4622282
	speed: 0.0054s/iter; left time: 0.3407s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4267356395721436
Epoch: 8, Steps: 262 | Train Loss: 0.4105567 Vali Loss: 0.2845707 Best vali loss: 0.2794538

best validation loss 0.279453784953311

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0015226276442, 'e_layers': 1, 'learning_rate': 0.0003229925127, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4035746
	speed: 0.0098s/iter; left time: 9.3109s
Updating learning rate to 0.0003229925127
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 0.8211967945098877
Epoch: 1, Steps: 131 | Train Loss: 0.4035746 Vali Loss: 0.2831255 Best vali loss: 0.2831255
	iters: 100, epoch: 2 | loss: 0.5596488
	speed: 0.0080s/iter; left time: 6.5192s
Updating learning rate to 0.00016149625635
Epoch: 2 cost time: 0.6115748882293701
Epoch: 2, Steps: 131 | Train Loss: 0.5596488 Vali Loss: 0.2836091 Best vali loss: 0.2831255
	iters: 100, epoch: 3 | loss: 0.4953187
	speed: 0.0076s/iter; left time: 5.2391s
Updating learning rate to 8.0748128175e-05
Validation loss decreased (0.2831 --> 0.2831).  Saving model state dict ...
Epoch: 3 cost time: 0.49118900299072266
Epoch: 3, Steps: 131 | Train Loss: 0.4953187 Vali Loss: 0.2830671 Best vali loss: 0.2830671
	iters: 100, epoch: 4 | loss: 0.5814672
	speed: 0.0055s/iter; left time: 3.0354s
Updating learning rate to 4.03740640875e-05
Validation loss decreased (0.2831 --> 0.2803).  Saving model state dict ...
Epoch: 4 cost time: 0.4106423854827881
Epoch: 4, Steps: 131 | Train Loss: 0.5814672 Vali Loss: 0.2802536 Best vali loss: 0.2802536
	iters: 100, epoch: 5 | loss: 0.4044084
	speed: 0.0060s/iter; left time: 2.5646s
Updating learning rate to 2.018703204375e-05
Validation loss decreased (0.2803 --> 0.2801).  Saving model state dict ...
Epoch: 5 cost time: 0.48484086990356445
Epoch: 5, Steps: 131 | Train Loss: 0.4044084 Vali Loss: 0.2801333 Best vali loss: 0.2801333
	iters: 100, epoch: 6 | loss: 0.4730379
	speed: 0.0060s/iter; left time: 1.7670s
Updating learning rate to 1.0093516021875e-05
Validation loss decreased (0.2801 --> 0.2798).  Saving model state dict ...
Epoch: 6 cost time: 0.4629073143005371
Epoch: 6, Steps: 131 | Train Loss: 0.4730379 Vali Loss: 0.2798155 Best vali loss: 0.2798155
	iters: 100, epoch: 7 | loss: 0.5351862
	speed: 0.0064s/iter; left time: 1.0456s
Updating learning rate to 5.0467580109375e-06
Epoch: 7 cost time: 0.505779504776001
Epoch: 7, Steps: 131 | Train Loss: 0.5351862 Vali Loss: 0.2800987 Best vali loss: 0.2798155
	iters: 100, epoch: 8 | loss: 0.6334159
	speed: 0.0060s/iter; left time: 0.1910s
Updating learning rate to 2.52337900546875e-06
Epoch: 8 cost time: 0.452678918838501
Epoch: 8, Steps: 131 | Train Loss: 0.6334159 Vali Loss: 0.2800391 Best vali loss: 0.2798155

best validation loss 0.2798155186986693

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0067707384255, 'e_layers': 1, 'learning_rate': 0.0002592776834, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4220148
	speed: 0.0083s/iter; left time: 16.5653s
	iters: 200, epoch: 1 | loss: 0.5024098
	speed: 0.0028s/iter; left time: 5.3587s
Updating learning rate to 0.0002494095141651007
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 1.01651930809021
Epoch: 1, Steps: 262 | Train Loss: 0.4622123 Vali Loss: 0.2878685 Best vali loss: 0.2878685
	iters: 100, epoch: 2 | loss: 0.7476797
	speed: 0.0068s/iter; left time: 11.7155s
	iters: 200, epoch: 2 | loss: 0.5270865
	speed: 0.0025s/iter; left time: 4.1692s
Updating learning rate to 0.00022130734577123935
Validation loss decreased (0.2879 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 0.7174344062805176
Epoch: 2, Steps: 262 | Train Loss: 0.6373831 Vali Loss: 0.2810020 Best vali loss: 0.2810020
	iters: 100, epoch: 3 | loss: 0.2803965
	speed: 0.0070s/iter; left time: 10.3359s
	iters: 200, epoch: 3 | loss: 0.4922744
	speed: 0.0032s/iter; left time: 4.3301s
Updating learning rate to 0.00017924947860959052
Validation loss decreased (0.2810 --> 0.2806).  Saving model state dict ...
Epoch: 3 cost time: 0.8546292781829834
Epoch: 3, Steps: 262 | Train Loss: 0.3863355 Vali Loss: 0.2806192 Best vali loss: 0.2806192
	iters: 100, epoch: 4 | loss: 0.9043093
	speed: 0.0075s/iter; left time: 9.1315s
	iters: 200, epoch: 4 | loss: 0.2573621
	speed: 0.0033s/iter; left time: 3.6149s
Updating learning rate to 0.0001296388417
Epoch: 4 cost time: 0.8800287246704102
Epoch: 4, Steps: 262 | Train Loss: 0.5808357 Vali Loss: 0.2829180 Best vali loss: 0.2806192
	iters: 100, epoch: 5 | loss: 0.7317494
	speed: 0.0072s/iter; left time: 6.8539s
	iters: 200, epoch: 5 | loss: 1.1630815
	speed: 0.0031s/iter; left time: 2.6350s
Updating learning rate to 8.002820479040947e-05
Epoch: 5 cost time: 0.8395390510559082
Epoch: 5, Steps: 262 | Train Loss: 0.9474155 Vali Loss: 0.2812221 Best vali loss: 0.2806192
	iters: 100, epoch: 6 | loss: 0.5131217
	speed: 0.0074s/iter; left time: 5.0612s
	iters: 200, epoch: 6 | loss: 0.3701715
	speed: 0.0031s/iter; left time: 1.8311s
Updating learning rate to 3.797033762876063e-05
Validation loss decreased (0.2806 --> 0.2802).  Saving model state dict ...
Epoch: 6 cost time: 0.8409585952758789
Epoch: 6, Steps: 262 | Train Loss: 0.4416466 Vali Loss: 0.2802454 Best vali loss: 0.2802454
	iters: 100, epoch: 7 | loss: 0.5528354
	speed: 0.0073s/iter; left time: 3.1223s
	iters: 200, epoch: 7 | loss: 0.3890525
	speed: 0.0030s/iter; left time: 0.9843s
Updating learning rate to 9.868169234899294e-06
Epoch: 7 cost time: 0.8375043869018555
Epoch: 7, Steps: 262 | Train Loss: 0.4709439 Vali Loss: 0.2807633 Best vali loss: 0.2802454
	iters: 100, epoch: 8 | loss: 1.0368223
	speed: 0.0075s/iter; left time: 1.2279s
	iters: 200, epoch: 8 | loss: 0.4756656
	speed: 0.0029s/iter; left time: 0.1855s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8403797149658203
Epoch: 8, Steps: 262 | Train Loss: 0.7562440 Vali Loss: 0.2807127 Best vali loss: 0.2802454

best validation loss 0.2802453775772068

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2711982
	speed: 0.0089s/iter; left time: 36.3949s
	iters: 200, epoch: 1 | loss: 0.3217775
	speed: 0.0032s/iter; left time: 12.9210s
	iters: 300, epoch: 1 | loss: 0.2785318
	speed: 0.0033s/iter; left time: 12.6275s
	iters: 400, epoch: 1 | loss: 0.6046037
	speed: 0.0033s/iter; left time: 12.4394s
	iters: 500, epoch: 1 | loss: 0.7593597
	speed: 0.0034s/iter; left time: 12.4046s
Updating learning rate to 0.0004342987517734106
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 2.0311617851257324
Epoch: 1, Steps: 523 | Train Loss: 0.4470942 Vali Loss: 0.2835349 Best vali loss: 0.2835349
	iters: 100, epoch: 2 | loss: 0.2807145
	speed: 0.0099s/iter; left time: 35.3536s
	iters: 200, epoch: 2 | loss: 0.8123380
	speed: 0.0044s/iter; left time: 15.1435s
	iters: 300, epoch: 2 | loss: 0.5117219
	speed: 0.0043s/iter; left time: 14.5929s
	iters: 400, epoch: 2 | loss: 0.9556945
	speed: 0.0043s/iter; left time: 14.1225s
	iters: 500, epoch: 2 | loss: 0.4395756
	speed: 0.0043s/iter; left time: 13.5806s
Updating learning rate to 0.0003853642245704867
Epoch: 2 cost time: 2.3028066158294678
Epoch: 2, Steps: 523 | Train Loss: 0.6000089 Vali Loss: 0.2899817 Best vali loss: 0.2835349
	iters: 100, epoch: 3 | loss: 0.4603625
	speed: 0.0090s/iter; left time: 27.2907s
	iters: 200, epoch: 3 | loss: 0.2623306
	speed: 0.0040s/iter; left time: 11.6975s
	iters: 300, epoch: 3 | loss: 0.3443571
	speed: 0.0039s/iter; left time: 11.1997s
	iters: 400, epoch: 3 | loss: 0.6166804
	speed: 0.0040s/iter; left time: 10.8918s
	iters: 500, epoch: 3 | loss: 0.5330824
	speed: 0.0040s/iter; left time: 10.6446s
Updating learning rate to 0.0003121285291652796
Validation loss decreased (0.2835 --> 0.2730).  Saving model state dict ...
Epoch: 3 cost time: 2.0941879749298096
Epoch: 3, Steps: 523 | Train Loss: 0.4433626 Vali Loss: 0.2729667 Best vali loss: 0.2729667

best validation loss 0.27296667459863144

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0034938739476, 'e_layers': 4, 'learning_rate': 0.0001269098969, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001220796765595138
Validation loss decreased (inf --> 0.3144).  Saving model state dict ...
Epoch: 1 cost time: 0.7185359001159668
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3143592 Best vali loss: 0.3143592
Updating learning rate to 0.0001083243727988378
Validation loss decreased (0.3144 --> 0.2976).  Saving model state dict ...
Epoch: 2 cost time: 0.5062799453735352
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2976296 Best vali loss: 0.2976296
Updating learning rate to 8.773810592339583e-05
Validation loss decreased (0.2976 --> 0.2902).  Saving model state dict ...
Epoch: 3 cost time: 0.5079977512359619
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2902334 Best vali loss: 0.2902334

best validation loss 0.29023339100910767

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0017396805512, 'e_layers': 3, 'learning_rate': 0.0001397169929, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001397169929
Validation loss decreased (inf --> 0.3197).  Saving model state dict ...
Epoch: 1 cost time: 0.6981909275054932
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3196741 Best vali loss: 0.3196741
Updating learning rate to 6.985849645e-05
Validation loss decreased (0.3197 --> 0.2988).  Saving model state dict ...
Epoch: 2 cost time: 0.4317355155944824
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2987958 Best vali loss: 0.2987958
Updating learning rate to 3.4929248225e-05
Validation loss decreased (0.2988 --> 0.2939).  Saving model state dict ...
Epoch: 3 cost time: 0.4329061508178711
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2938773 Best vali loss: 0.2938773

best validation loss 0.29387728056419116

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2536435
	speed: 0.0101s/iter; left time: 25.3572s
	iters: 200, epoch: 4 | loss: 0.3343447
	speed: 0.0043s/iter; left time: 10.3847s
	iters: 300, epoch: 4 | loss: 0.2935324
	speed: 0.0045s/iter; left time: 10.4368s
	iters: 400, epoch: 4 | loss: 0.4804516
	speed: 0.0046s/iter; left time: 10.1157s
	iters: 500, epoch: 4 | loss: 0.5450732
	speed: 0.0038s/iter; left time: 8.1239s
Updating learning rate to 0.0002257411363
Epoch: 4 cost time: 2.5200440883636475
Epoch: 4, Steps: 523 | Train Loss: 0.3814091 Vali Loss: 0.2882992 Best vali loss: 0.2729667
	iters: 100, epoch: 5 | loss: 0.2411633
	speed: 0.0093s/iter; left time: 18.5413s
	iters: 200, epoch: 5 | loss: 0.5515279
	speed: 0.0040s/iter; left time: 7.6406s
	iters: 300, epoch: 5 | loss: 0.4154493
	speed: 0.0041s/iter; left time: 7.3946s
	iters: 400, epoch: 5 | loss: 0.6803392
	speed: 0.0042s/iter; left time: 7.1636s
	iters: 500, epoch: 5 | loss: 0.2805083
	speed: 0.0042s/iter; left time: 6.7422s
Updating learning rate to 0.00013935374343472043
Epoch: 5 cost time: 2.206184148788452
Epoch: 5, Steps: 523 | Train Loss: 0.4337976 Vali Loss: 0.2923086 Best vali loss: 0.2729667
	iters: 100, epoch: 6 | loss: 0.2887785
	speed: 0.0094s/iter; left time: 13.7645s
	iters: 200, epoch: 6 | loss: 0.2432218
	speed: 0.0039s/iter; left time: 5.3111s
	iters: 300, epoch: 6 | loss: 0.2686371
	speed: 0.0042s/iter; left time: 5.3722s
	iters: 400, epoch: 6 | loss: 0.5216416
	speed: 0.0042s/iter; left time: 4.9198s
	iters: 500, epoch: 6 | loss: 0.3279651
	speed: 0.0042s/iter; left time: 4.5315s
Updating learning rate to 6.611804802951332e-05
Epoch: 6 cost time: 2.187713623046875
Epoch: 6, Steps: 523 | Train Loss: 0.3300488 Vali Loss: 0.3159439 Best vali loss: 0.2729667
	iters: 100, epoch: 7 | loss: 0.3712071
	speed: 0.0096s/iter; left time: 9.0782s
	iters: 200, epoch: 7 | loss: 0.2992283
	speed: 0.0040s/iter; left time: 3.3880s
	iters: 300, epoch: 7 | loss: 0.4158975
	speed: 0.0041s/iter; left time: 3.0915s
	iters: 400, epoch: 7 | loss: 0.2746799
	speed: 0.0039s/iter; left time: 2.5529s
	iters: 500, epoch: 7 | loss: 0.2051893
	speed: 0.0039s/iter; left time: 2.1501s
Updating learning rate to 1.718352082658934e-05
Epoch: 7 cost time: 2.126939296722412
Epoch: 7, Steps: 523 | Train Loss: 0.3132404 Vali Loss: 0.3107637 Best vali loss: 0.2729667
	iters: 100, epoch: 8 | loss: 0.2789465
	speed: 0.0097s/iter; left time: 4.0932s
	iters: 200, epoch: 8 | loss: 0.3198230
	speed: 0.0042s/iter; left time: 1.3723s
	iters: 300, epoch: 8 | loss: 0.3096659
	speed: 0.0042s/iter; left time: 0.9471s
	iters: 400, epoch: 8 | loss: 0.2392016
	speed: 0.0043s/iter; left time: 0.5276s
	iters: 500, epoch: 8 | loss: 0.3919469
	speed: 0.0043s/iter; left time: 0.1028s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2662878036499023
Epoch: 8, Steps: 523 | Train Loss: 0.3079168 Vali Loss: 0.3273241 Best vali loss: 0.2729667

best validation loss 0.27296667459863144

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066334976282, 'e_layers': 4, 'learning_rate': 0.0046791286395, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7351540
	speed: 0.0118s/iter; left time: 48.1899s
	iters: 200, epoch: 1 | loss: 0.9660034
	speed: 0.0064s/iter; left time: 25.4398s
	iters: 300, epoch: 1 | loss: 0.7390677
	speed: 0.0063s/iter; left time: 24.6468s
	iters: 400, epoch: 1 | loss: 0.3055648
	speed: 0.0055s/iter; left time: 20.9219s
	iters: 500, epoch: 1 | loss: 0.4639171
	speed: 0.0046s/iter; left time: 16.8582s
Updating learning rate to 0.0046791286395
Validation loss decreased (inf --> 0.3241).  Saving model state dict ...
Epoch: 1 cost time: 3.2999918460845947
Epoch: 1, Steps: 523 | Train Loss: 0.6419414 Vali Loss: 0.3241391 Best vali loss: 0.3241391
	iters: 100, epoch: 2 | loss: 0.7487946
	speed: 0.0122s/iter; left time: 43.5942s
	iters: 200, epoch: 2 | loss: 0.2564849
	speed: 0.0061s/iter; left time: 20.9776s
	iters: 300, epoch: 2 | loss: 1.2455434
	speed: 0.0060s/iter; left time: 20.2112s
	iters: 400, epoch: 2 | loss: 1.1486663
	speed: 0.0060s/iter; left time: 19.4755s
	iters: 500, epoch: 2 | loss: 0.3513776
	speed: 0.0060s/iter; left time: 19.0155s
Updating learning rate to 0.00233956431975
Epoch: 2 cost time: 3.2089297771453857
Epoch: 2, Steps: 523 | Train Loss: 0.7501733 Vali Loss: 0.3301483 Best vali loss: 0.3241391
	iters: 100, epoch: 3 | loss: 1.2092865
	speed: 0.0128s/iter; left time: 38.8521s
	iters: 200, epoch: 3 | loss: 1.0656326
	speed: 0.0063s/iter; left time: 18.6433s
	iters: 300, epoch: 3 | loss: 0.6072580
	speed: 0.0064s/iter; left time: 18.2709s
	iters: 400, epoch: 3 | loss: 0.3547704
	speed: 0.0061s/iter; left time: 16.6252s
	iters: 500, epoch: 3 | loss: 0.8393511
	speed: 0.0061s/iter; left time: 16.0258s
Updating learning rate to 0.001169782159875
Validation loss decreased (0.3241 --> 0.3226).  Saving model state dict ...
Epoch: 3 cost time: 3.3151540756225586
Epoch: 3, Steps: 523 | Train Loss: 0.8152597 Vali Loss: 0.3226269 Best vali loss: 0.3226269
	iters: 100, epoch: 4 | loss: 0.5046116
	speed: 0.0128s/iter; left time: 32.1624s
	iters: 200, epoch: 4 | loss: 0.8161426
	speed: 0.0063s/iter; left time: 15.2075s
	iters: 300, epoch: 4 | loss: 1.2273005
	speed: 0.0064s/iter; left time: 14.7393s
	iters: 400, epoch: 4 | loss: 0.9484169
	speed: 0.0064s/iter; left time: 14.1992s
	iters: 500, epoch: 4 | loss: 0.9282232
	speed: 0.0064s/iter; left time: 13.6424s
Updating learning rate to 0.0005848910799375
Epoch: 4 cost time: 3.368651866912842
Epoch: 4, Steps: 523 | Train Loss: 0.8849390 Vali Loss: 0.3229525 Best vali loss: 0.3226269
	iters: 100, epoch: 5 | loss: 0.6396975
	speed: 0.0129s/iter; left time: 25.7113s
	iters: 200, epoch: 5 | loss: 0.3994893
	speed: 0.0062s/iter; left time: 11.7118s
	iters: 300, epoch: 5 | loss: 0.6622020
	speed: 0.0058s/iter; left time: 10.4533s
	iters: 400, epoch: 5 | loss: 0.4484952
	speed: 0.0058s/iter; left time: 9.9003s
	iters: 500, epoch: 5 | loss: 0.9324417
	speed: 0.0059s/iter; left time: 9.3894s
Updating learning rate to 0.00029244553996875
Validation loss decreased (0.3226 --> 0.3220).  Saving model state dict ...
Epoch: 5 cost time: 3.1825902462005615
Epoch: 5, Steps: 523 | Train Loss: 0.6164651 Vali Loss: 0.3220421 Best vali loss: 0.3220421
	iters: 100, epoch: 6 | loss: 0.3054714
	speed: 0.0131s/iter; left time: 19.2166s
	iters: 200, epoch: 6 | loss: 0.9407610
	speed: 0.0062s/iter; left time: 8.5576s
	iters: 300, epoch: 6 | loss: 0.4397451
	speed: 0.0062s/iter; left time: 7.8936s
	iters: 400, epoch: 6 | loss: 0.4096659
	speed: 0.0063s/iter; left time: 7.3986s
	iters: 500, epoch: 6 | loss: 0.9971840
	speed: 0.0063s/iter; left time: 6.7736s
Updating learning rate to 0.000146222769984375
Validation loss decreased (0.3220 --> 0.3220).  Saving model state dict ...
Epoch: 6 cost time: 3.3662211894989014
Epoch: 6, Steps: 523 | Train Loss: 0.6185655 Vali Loss: 0.3220202 Best vali loss: 0.3220202
	iters: 100, epoch: 7 | loss: 0.4988603
	speed: 0.0128s/iter; left time: 12.1135s
	iters: 200, epoch: 7 | loss: 0.4201857
	speed: 0.0062s/iter; left time: 5.2154s
	iters: 300, epoch: 7 | loss: 0.4237264
	speed: 0.0062s/iter; left time: 4.6084s
	iters: 400, epoch: 7 | loss: 0.4999134
	speed: 0.0063s/iter; left time: 4.0455s
	iters: 500, epoch: 7 | loss: 0.7081346
	speed: 0.0062s/iter; left time: 3.3974s
Updating learning rate to 7.31113849921875e-05
Epoch: 7 cost time: 3.279623031616211
Epoch: 7, Steps: 523 | Train Loss: 0.5101641 Vali Loss: 0.3220985 Best vali loss: 0.3220202
	iters: 100, epoch: 8 | loss: 0.5866022
	speed: 0.0127s/iter; left time: 5.3995s
	iters: 200, epoch: 8 | loss: 0.6646704
	speed: 0.0060s/iter; left time: 1.9438s
	iters: 300, epoch: 8 | loss: 0.3758890
	speed: 0.0061s/iter; left time: 1.3744s
	iters: 400, epoch: 8 | loss: 0.2541927
	speed: 0.0061s/iter; left time: 0.7538s
	iters: 500, epoch: 8 | loss: 0.3671851
	speed: 0.0057s/iter; left time: 0.1374s
Updating learning rate to 3.655569249609375e-05
Epoch: 8 cost time: 3.1894757747650146
Epoch: 8, Steps: 523 | Train Loss: 0.4497079 Vali Loss: 0.3221080 Best vali loss: 0.3220202

best validation loss 0.3220202064660456

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4664633
	speed: 0.0108s/iter; left time: 89.5583s
	iters: 200, epoch: 1 | loss: 0.2426042
	speed: 0.0052s/iter; left time: 42.7057s
	iters: 300, epoch: 1 | loss: 0.6604230
	speed: 0.0052s/iter; left time: 42.1953s
	iters: 400, epoch: 1 | loss: 0.6121604
	speed: 0.0052s/iter; left time: 41.6213s
	iters: 500, epoch: 1 | loss: 1.3482970
	speed: 0.0052s/iter; left time: 41.0392s
	iters: 600, epoch: 1 | loss: 0.8430774
	speed: 0.0053s/iter; left time: 41.1576s
	iters: 700, epoch: 1 | loss: 0.2815759
	speed: 0.0053s/iter; left time: 40.9647s
	iters: 800, epoch: 1 | loss: 1.3789401
	speed: 0.0054s/iter; left time: 40.4802s
	iters: 900, epoch: 1 | loss: 0.4565202
	speed: 0.0051s/iter; left time: 37.8606s
	iters: 1000, epoch: 1 | loss: 0.1811435
	speed: 0.0049s/iter; left time: 36.1105s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 5.73194694519043
Epoch: 1, Steps: 1045 | Train Loss: 0.6471205 Vali Loss: 0.2831330 Best vali loss: 0.2831330
	iters: 100, epoch: 2 | loss: 1.8588848
	speed: 0.0164s/iter; left time: 118.5865s
	iters: 200, epoch: 2 | loss: 0.6157766
	speed: 0.0052s/iter; left time: 37.2828s
	iters: 300, epoch: 2 | loss: 0.8126951
	speed: 0.0052s/iter; left time: 36.5964s
	iters: 400, epoch: 2 | loss: 0.3578190
	speed: 0.0052s/iter; left time: 36.1159s
	iters: 500, epoch: 2 | loss: 0.3036864
	speed: 0.0052s/iter; left time: 35.3281s
	iters: 600, epoch: 2 | loss: 0.4197396
	speed: 0.0053s/iter; left time: 35.5110s
	iters: 700, epoch: 2 | loss: 0.3394859
	speed: 0.0053s/iter; left time: 34.9779s
	iters: 800, epoch: 2 | loss: 0.2605848
	speed: 0.0053s/iter; left time: 34.6354s
	iters: 900, epoch: 2 | loss: 0.1651857
	speed: 0.0048s/iter; left time: 30.8183s
	iters: 1000, epoch: 2 | loss: 0.2545809
	speed: 0.0048s/iter; left time: 30.2932s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.2831 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 5.420405864715576
Epoch: 2, Steps: 1045 | Train Loss: 0.5388439 Vali Loss: 0.2824022 Best vali loss: 0.2824022
	iters: 100, epoch: 3 | loss: 0.6617170
	speed: 0.0163s/iter; left time: 100.8723s
	iters: 200, epoch: 3 | loss: 0.1647768
	speed: 0.0053s/iter; left time: 32.1419s
	iters: 300, epoch: 3 | loss: 0.3512443
	speed: 0.0053s/iter; left time: 31.3890s
	iters: 400, epoch: 3 | loss: 0.3759257
	speed: 0.0053s/iter; left time: 30.9685s
	iters: 500, epoch: 3 | loss: 0.3677686
	speed: 0.0053s/iter; left time: 30.5121s
	iters: 600, epoch: 3 | loss: 0.3413825
	speed: 0.0053s/iter; left time: 30.0269s
	iters: 700, epoch: 3 | loss: 0.7935298
	speed: 0.0053s/iter; left time: 29.3215s
	iters: 800, epoch: 3 | loss: 0.3314151
	speed: 0.0053s/iter; left time: 28.8915s
	iters: 900, epoch: 3 | loss: 0.3596529
	speed: 0.0049s/iter; left time: 26.1277s
	iters: 1000, epoch: 3 | loss: 0.8055617
	speed: 0.0048s/iter; left time: 25.0758s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 5.4394567012786865
Epoch: 3, Steps: 1045 | Train Loss: 0.4552974 Vali Loss: 0.2871822 Best vali loss: 0.2824022
	iters: 100, epoch: 4 | loss: 0.9224026
	speed: 0.0166s/iter; left time: 84.8928s
	iters: 200, epoch: 4 | loss: 0.1936159
	speed: 0.0052s/iter; left time: 26.2188s
	iters: 300, epoch: 4 | loss: 0.4259471
	speed: 0.0052s/iter; left time: 25.4989s
	iters: 400, epoch: 4 | loss: 0.3451251
	speed: 0.0052s/iter; left time: 25.3256s
	iters: 500, epoch: 4 | loss: 0.3466416
	speed: 0.0052s/iter; left time: 24.6322s
	iters: 600, epoch: 4 | loss: 1.4559397
	speed: 0.0052s/iter; left time: 24.1333s
	iters: 700, epoch: 4 | loss: 0.4280328
	speed: 0.0052s/iter; left time: 23.5824s
	iters: 800, epoch: 4 | loss: 0.2176440
	speed: 0.0053s/iter; left time: 23.4083s
	iters: 900, epoch: 4 | loss: 0.3921506
	speed: 0.0051s/iter; left time: 22.0696s
	iters: 1000, epoch: 4 | loss: 0.2611422
	speed: 0.0048s/iter; left time: 20.3792s
Updating learning rate to 0.0001477158077
Epoch: 4 cost time: 5.434120416641235
Epoch: 4, Steps: 1045 | Train Loss: 0.4988642 Vali Loss: 0.2939308 Best vali loss: 0.2824022
	iters: 100, epoch: 5 | loss: 0.3886783
	speed: 0.0141s/iter; left time: 57.4344s
	iters: 200, epoch: 5 | loss: 1.1837120
	speed: 0.0059s/iter; left time: 23.3691s
	iters: 300, epoch: 5 | loss: 0.9290766
	speed: 0.0058s/iter; left time: 22.6209s
	iters: 400, epoch: 5 | loss: 0.4304391
	speed: 0.0058s/iter; left time: 22.0806s
	iters: 500, epoch: 5 | loss: 0.7967359
	speed: 0.0058s/iter; left time: 21.5110s
	iters: 600, epoch: 5 | loss: 0.2572556
	speed: 0.0058s/iter; left time: 20.7273s
	iters: 700, epoch: 5 | loss: 0.2073727
	speed: 0.0059s/iter; left time: 20.4237s
	iters: 800, epoch: 5 | loss: 0.4360128
	speed: 0.0059s/iter; left time: 19.8430s
	iters: 900, epoch: 5 | loss: 0.2749531
	speed: 0.0059s/iter; left time: 19.2237s
	iters: 1000, epoch: 5 | loss: 0.7895223
	speed: 0.0058s/iter; left time: 18.6029s
Updating learning rate to 9.118741539478246e-05
Epoch: 5 cost time: 6.115377426147461
Epoch: 5, Steps: 1045 | Train Loss: 0.5693758 Vali Loss: 0.2904219 Best vali loss: 0.2824022
	iters: 100, epoch: 6 | loss: 0.3702544
	speed: 0.0168s/iter; left time: 51.0946s
	iters: 200, epoch: 6 | loss: 0.5436046
	speed: 0.0056s/iter; left time: 16.5579s
	iters: 300, epoch: 6 | loss: 0.1921882
	speed: 0.0055s/iter; left time: 15.5168s
	iters: 400, epoch: 6 | loss: 0.2273324
	speed: 0.0055s/iter; left time: 15.1496s
	iters: 500, epoch: 6 | loss: 0.3619193
	speed: 0.0056s/iter; left time: 14.6918s
	iters: 600, epoch: 6 | loss: 0.5729135
	speed: 0.0056s/iter; left time: 14.0902s
	iters: 700, epoch: 6 | loss: 0.2265392
	speed: 0.0056s/iter; left time: 13.6520s
	iters: 800, epoch: 6 | loss: 0.3614773
	speed: 0.0056s/iter; left time: 13.0637s
	iters: 900, epoch: 6 | loss: 0.2850596
	speed: 0.0055s/iter; left time: 12.3538s
	iters: 1000, epoch: 6 | loss: 0.9975452
	speed: 0.0056s/iter; left time: 11.9082s
Updating learning rate to 4.326495838688198e-05
Epoch: 6 cost time: 5.857923984527588
Epoch: 6, Steps: 1045 | Train Loss: 0.4138834 Vali Loss: 0.2914486 Best vali loss: 0.2824022
	iters: 100, epoch: 7 | loss: 0.2839456
	speed: 0.0165s/iter; left time: 32.8627s
	iters: 200, epoch: 7 | loss: 0.2421601
	speed: 0.0058s/iter; left time: 10.9136s
	iters: 300, epoch: 7 | loss: 0.2943110
	speed: 0.0060s/iter; left time: 10.7227s
	iters: 400, epoch: 7 | loss: 0.2062986
	speed: 0.0061s/iter; left time: 10.3834s
	iters: 500, epoch: 7 | loss: 0.4264734
	speed: 0.0051s/iter; left time: 8.1884s
	iters: 600, epoch: 7 | loss: 0.2548744
	speed: 0.0052s/iter; left time: 7.7829s
	iters: 700, epoch: 7 | loss: 1.0462649
	speed: 0.0051s/iter; left time: 7.1243s
	iters: 800, epoch: 7 | loss: 0.2600684
	speed: 0.0052s/iter; left time: 6.6771s
	iters: 900, epoch: 7 | loss: 0.3285954
	speed: 0.0052s/iter; left time: 6.2068s
	iters: 1000, epoch: 7 | loss: 0.3401796
	speed: 0.0053s/iter; left time: 5.7416s
Updating learning rate to 1.124419633759687e-05
Epoch: 7 cost time: 5.691898822784424
Epoch: 7, Steps: 1045 | Train Loss: 0.3683172 Vali Loss: 0.2878836 Best vali loss: 0.2824022
	iters: 100, epoch: 8 | loss: 0.1460207
	speed: 0.0159s/iter; left time: 15.0053s
	iters: 200, epoch: 8 | loss: 0.7774431
	speed: 0.0040s/iter; left time: 3.4171s
	iters: 300, epoch: 8 | loss: 0.4213293
	speed: 0.0041s/iter; left time: 3.0608s
	iters: 400, epoch: 8 | loss: 0.8783174
	speed: 0.0046s/iter; left time: 2.9539s
	iters: 500, epoch: 8 | loss: 0.6144701
	speed: 0.0049s/iter; left time: 2.6547s
	iters: 600, epoch: 8 | loss: 0.2911572
	speed: 0.0047s/iter; left time: 2.0802s
	iters: 700, epoch: 8 | loss: 0.3546945
	speed: 0.0037s/iter; left time: 1.2749s
	iters: 800, epoch: 8 | loss: 0.5463179
	speed: 0.0042s/iter; left time: 1.0303s
	iters: 900, epoch: 8 | loss: 0.3600924
	speed: 0.0074s/iter; left time: 1.0741s
	iters: 1000, epoch: 8 | loss: 0.1965258
	speed: 0.0074s/iter; left time: 0.3384s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.3062779903411865
Epoch: 8, Steps: 1045 | Train Loss: 0.4586369 Vali Loss: 0.2908562 Best vali loss: 0.2824022

best validation loss 0.2824021992119505

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022460234567, 'e_layers': 3, 'learning_rate': 0.0002238773545, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5415517
	speed: 0.0134s/iter; left time: 110.6590s
	iters: 200, epoch: 1 | loss: 0.3642933
	speed: 0.0080s/iter; left time: 65.5281s
	iters: 300, epoch: 1 | loss: 0.3114869
	speed: 0.0080s/iter; left time: 64.2381s
	iters: 400, epoch: 1 | loss: 0.7067794
	speed: 0.0080s/iter; left time: 63.4567s
	iters: 500, epoch: 1 | loss: 0.2086923
	speed: 0.0081s/iter; left time: 63.3278s
	iters: 600, epoch: 1 | loss: 0.5399655
	speed: 0.0063s/iter; left time: 48.7396s
	iters: 700, epoch: 1 | loss: 0.3132080
	speed: 0.0070s/iter; left time: 53.2529s
	iters: 800, epoch: 1 | loss: 0.5200437
	speed: 0.0080s/iter; left time: 60.2526s
	iters: 900, epoch: 1 | loss: 1.2429274
	speed: 0.0080s/iter; left time: 59.5103s
	iters: 1000, epoch: 1 | loss: 0.8518451
	speed: 0.0080s/iter; left time: 58.5417s
Updating learning rate to 0.0002238773545
Validation loss decreased (inf --> 0.2945).  Saving model state dict ...
Epoch: 1 cost time: 8.34896445274353
Epoch: 1, Steps: 1045 | Train Loss: 0.5600793 Vali Loss: 0.2945299 Best vali loss: 0.2945299
	iters: 100, epoch: 2 | loss: 0.5766421
	speed: 0.0206s/iter; left time: 148.8998s
	iters: 200, epoch: 2 | loss: 0.1809384
	speed: 0.0041s/iter; left time: 28.9623s
	iters: 300, epoch: 2 | loss: 0.2707578
	speed: 0.0055s/iter; left time: 38.4937s
	iters: 400, epoch: 2 | loss: 0.4931445
	speed: 0.0078s/iter; left time: 54.2653s
	iters: 500, epoch: 2 | loss: 0.2204441
	speed: 0.0078s/iter; left time: 53.2951s
	iters: 600, epoch: 2 | loss: 0.5234241
	speed: 0.0078s/iter; left time: 52.4986s
	iters: 700, epoch: 2 | loss: 0.6692897
	speed: 0.0078s/iter; left time: 51.6462s
	iters: 800, epoch: 2 | loss: 0.4392148
	speed: 0.0076s/iter; left time: 49.5870s
	iters: 900, epoch: 2 | loss: 0.3726614
	speed: 0.0062s/iter; left time: 39.8579s
	iters: 1000, epoch: 2 | loss: 0.3935272
	speed: 0.0076s/iter; left time: 47.7534s
Updating learning rate to 0.00011193867725
Validation loss decreased (0.2945 --> 0.2846).  Saving model state dict ...
Epoch: 2 cost time: 7.043353080749512
Epoch: 2, Steps: 1045 | Train Loss: 0.4140044 Vali Loss: 0.2846257 Best vali loss: 0.2846257
	iters: 100, epoch: 3 | loss: 0.3089897
	speed: 0.0263s/iter; left time: 162.2463s
	iters: 200, epoch: 3 | loss: 0.3325503
	speed: 0.0070s/iter; left time: 42.3368s
	iters: 300, epoch: 3 | loss: 0.2358229
	speed: 0.0063s/iter; left time: 37.7967s
	iters: 400, epoch: 3 | loss: 0.3469478
	speed: 0.0078s/iter; left time: 45.9543s
	iters: 500, epoch: 3 | loss: 0.3144854
	speed: 0.0078s/iter; left time: 45.1881s
	iters: 600, epoch: 3 | loss: 0.2690304
	speed: 0.0078s/iter; left time: 44.2861s
	iters: 700, epoch: 3 | loss: 0.1899308
	speed: 0.0078s/iter; left time: 43.4431s
	iters: 800, epoch: 3 | loss: 0.8039011
	speed: 0.0078s/iter; left time: 42.6079s
	iters: 900, epoch: 3 | loss: 1.0187844
	speed: 0.0061s/iter; left time: 32.9360s
	iters: 1000, epoch: 3 | loss: 0.1884385
	speed: 0.0074s/iter; left time: 38.9387s
Updating learning rate to 5.5969338625e-05
Epoch: 3 cost time: 7.764598608016968
Epoch: 3, Steps: 1045 | Train Loss: 0.4008881 Vali Loss: 0.2897945 Best vali loss: 0.2846257

best validation loss 0.28462565864282896

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0053842784557, 'e_layers': 2, 'learning_rate': 0.0021053293838, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0020252000553437097
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 0.6799993515014648
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2876061 Best vali loss: 0.2876061
Updating learning rate to 0.0017970110338581377
Validation loss decreased (0.2876 --> 0.2819).  Saving model state dict ...
Epoch: 2 cost time: 0.4131805896759033
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2819104 Best vali loss: 0.2819104
Updating learning rate to 0.0014555020293258317
Epoch: 3 cost time: 0.4985506534576416
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2851670 Best vali loss: 0.2819104

best validation loss 0.2819103915237414

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 4, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7084095
	speed: 0.0162s/iter; left time: 66.3001s
	iters: 200, epoch: 1 | loss: 0.4946637
	speed: 0.0104s/iter; left time: 41.3798s
	iters: 300, epoch: 1 | loss: 0.5790353
	speed: 0.0081s/iter; left time: 31.4357s
	iters: 400, epoch: 1 | loss: 0.3053612
	speed: 0.0060s/iter; left time: 22.5936s
	iters: 500, epoch: 1 | loss: 0.4015211
	speed: 0.0052s/iter; left time: 19.2403s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.2766).  Saving model state dict ...
Epoch: 1 cost time: 4.443231582641602
Epoch: 1, Steps: 523 | Train Loss: 0.4977982 Vali Loss: 0.2765698 Best vali loss: 0.2765698
	iters: 100, epoch: 2 | loss: 0.3978709
	speed: 0.0145s/iter; left time: 51.6478s
	iters: 200, epoch: 2 | loss: 0.3610750
	speed: 0.0073s/iter; left time: 25.3114s
	iters: 300, epoch: 2 | loss: 0.3066901
	speed: 0.0071s/iter; left time: 24.0153s
	iters: 400, epoch: 2 | loss: 0.8175888
	speed: 0.0071s/iter; left time: 23.0545s
	iters: 500, epoch: 2 | loss: 0.2858476
	speed: 0.0076s/iter; left time: 23.8968s
Updating learning rate to 4.937857552178923e-05
Epoch: 2 cost time: 3.812833070755005
Epoch: 2, Steps: 523 | Train Loss: 0.4338145 Vali Loss: 0.2784175 Best vali loss: 0.2765698
	iters: 100, epoch: 3 | loss: 0.4673111
	speed: 0.0145s/iter; left time: 43.9740s
	iters: 200, epoch: 3 | loss: 0.2410238
	speed: 0.0072s/iter; left time: 21.0757s
	iters: 300, epoch: 3 | loss: 0.4282428
	speed: 0.0069s/iter; left time: 19.5168s
	iters: 400, epoch: 3 | loss: 0.2216324
	speed: 0.0075s/iter; left time: 20.6579s
	iters: 500, epoch: 3 | loss: 0.2899089
	speed: 0.0069s/iter; left time: 18.2140s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.2766 --> 0.2764).  Saving model state dict ...
Epoch: 3 cost time: 3.7846603393554688
Epoch: 3, Steps: 523 | Train Loss: 0.3296238 Vali Loss: 0.2764118 Best vali loss: 0.2764118

best validation loss 0.27641178673641

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 4, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4704272
	speed: 0.0138s/iter; left time: 34.6337s
	iters: 200, epoch: 4 | loss: 0.3740396
	speed: 0.0076s/iter; left time: 18.3833s
	iters: 300, epoch: 4 | loss: 0.4559548
	speed: 0.0069s/iter; left time: 15.8700s
	iters: 400, epoch: 4 | loss: 0.2866904
	speed: 0.0076s/iter; left time: 16.8583s
	iters: 500, epoch: 4 | loss: 0.3820088
	speed: 0.0076s/iter; left time: 16.1439s
Updating learning rate to 2.892529985e-05
Epoch: 4 cost time: 4.187702178955078
Epoch: 4, Steps: 523 | Train Loss: 0.3938242 Vali Loss: 0.2906377 Best vali loss: 0.2764118
	iters: 100, epoch: 5 | loss: 0.3313393
	speed: 0.0147s/iter; left time: 29.2627s
	iters: 200, epoch: 5 | loss: 0.2896271
	speed: 0.0076s/iter; left time: 14.4726s
	iters: 300, epoch: 5 | loss: 0.2655769
	speed: 0.0071s/iter; left time: 12.6695s
	iters: 400, epoch: 5 | loss: 0.6151200
	speed: 0.0074s/iter; left time: 12.4820s
	iters: 500, epoch: 5 | loss: 0.2650425
	speed: 0.0076s/iter; left time: 12.1732s
Updating learning rate to 1.7856066821212585e-05
Epoch: 5 cost time: 3.9531102180480957
Epoch: 5, Steps: 523 | Train Loss: 0.3533412 Vali Loss: 0.2901596 Best vali loss: 0.2764118
	iters: 100, epoch: 6 | loss: 0.3761909
	speed: 0.0146s/iter; left time: 21.4850s
	iters: 200, epoch: 6 | loss: 0.2034417
	speed: 0.0076s/iter; left time: 10.4613s
	iters: 300, epoch: 6 | loss: 0.3950489
	speed: 0.0074s/iter; left time: 9.4101s
	iters: 400, epoch: 6 | loss: 0.2282098
	speed: 0.0071s/iter; left time: 8.2556s
	iters: 500, epoch: 6 | loss: 0.2569576
	speed: 0.0077s/iter; left time: 8.1922s
Updating learning rate to 8.472024178210777e-06
Epoch: 6 cost time: 3.922628164291382
Epoch: 6, Steps: 523 | Train Loss: 0.2919698 Vali Loss: 0.2889369 Best vali loss: 0.2764118
	iters: 100, epoch: 7 | loss: 0.3754094
	speed: 0.0144s/iter; left time: 13.6415s
	iters: 200, epoch: 7 | loss: 0.3142646
	speed: 0.0077s/iter; left time: 6.5438s
	iters: 300, epoch: 7 | loss: 0.4334018
	speed: 0.0077s/iter; left time: 5.7351s
	iters: 400, epoch: 7 | loss: 0.3888838
	speed: 0.0070s/iter; left time: 4.5386s
	iters: 500, epoch: 7 | loss: 0.4107868
	speed: 0.0077s/iter; left time: 4.2025s
Updating learning rate to 2.2018073468332077e-06
Epoch: 7 cost time: 3.924586772918701
Epoch: 7, Steps: 523 | Train Loss: 0.3845493 Vali Loss: 0.2977896 Best vali loss: 0.2764118
	iters: 100, epoch: 8 | loss: 0.2933356
	speed: 0.0148s/iter; left time: 6.2737s
	iters: 200, epoch: 8 | loss: 0.3341407
	speed: 0.0056s/iter; left time: 1.8162s
	iters: 300, epoch: 8 | loss: 0.4526656
	speed: 0.0068s/iter; left time: 1.5135s
	iters: 400, epoch: 8 | loss: 0.2528558
	speed: 0.0082s/iter; left time: 1.0139s
	iters: 500, epoch: 8 | loss: 0.3852714
	speed: 0.0082s/iter; left time: 0.1966s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8053743839263916
Epoch: 8, Steps: 523 | Train Loss: 0.3436538 Vali Loss: 0.2957828 Best vali loss: 0.2764118

best validation loss 0.27641178673641

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0039198070782, 'e_layers': 3, 'learning_rate': 9.36341394e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7769576
	speed: 0.0115s/iter; left time: 10.8777s
Updating learning rate to 9.007040216798432e-05
Validation loss decreased (inf --> 0.3344).  Saving model state dict ...
Epoch: 1 cost time: 1.0507383346557617
Epoch: 1, Steps: 131 | Train Loss: 0.7769576 Vali Loss: 0.3343676 Best vali loss: 0.3343676
	iters: 100, epoch: 2 | loss: 0.5617485
	speed: 0.0100s/iter; left time: 8.1891s
Updating learning rate to 7.992173716015324e-05
Validation loss decreased (0.3344 --> 0.3169).  Saving model state dict ...
Epoch: 2 cost time: 0.807440996170044
Epoch: 2, Steps: 131 | Train Loss: 0.5617485 Vali Loss: 0.3168909 Best vali loss: 0.3168909
	iters: 100, epoch: 3 | loss: 0.4026428
	speed: 0.0094s/iter; left time: 6.4661s
Updating learning rate to 6.473318662607164e-05
Validation loss decreased (0.3169 --> 0.3077).  Saving model state dict ...
Epoch: 3 cost time: 0.7474911212921143
Epoch: 3, Steps: 131 | Train Loss: 0.4026428 Vali Loss: 0.3076711 Best vali loss: 0.3076711
	iters: 100, epoch: 4 | loss: 0.4556215
	speed: 0.0095s/iter; left time: 5.2856s
Updating learning rate to 4.68170697e-05
Validation loss decreased (0.3077 --> 0.3025).  Saving model state dict ...
Epoch: 4 cost time: 0.819286584854126
Epoch: 4, Steps: 131 | Train Loss: 0.4556215 Vali Loss: 0.3024786 Best vali loss: 0.3024786
	iters: 100, epoch: 5 | loss: 0.5959539
	speed: 0.0100s/iter; left time: 4.2643s
Updating learning rate to 2.8900952773928358e-05
Validation loss decreased (0.3025 --> 0.2992).  Saving model state dict ...
Epoch: 5 cost time: 0.8387432098388672
Epoch: 5, Steps: 131 | Train Loss: 0.5959539 Vali Loss: 0.2991974 Best vali loss: 0.2991974
	iters: 100, epoch: 6 | loss: 0.6140838
	speed: 0.0101s/iter; left time: 2.9644s
Updating learning rate to 1.3712402239846759e-05
Validation loss decreased (0.2992 --> 0.2978).  Saving model state dict ...
Epoch: 6 cost time: 0.8237087726593018
Epoch: 6, Steps: 131 | Train Loss: 0.6140838 Vali Loss: 0.2978369 Best vali loss: 0.2978369
	iters: 100, epoch: 7 | loss: 0.5709082
	speed: 0.0101s/iter; left time: 1.6467s
Updating learning rate to 3.5637372320156725e-06
Validation loss decreased (0.2978 --> 0.2972).  Saving model state dict ...
Epoch: 7 cost time: 0.8289601802825928
Epoch: 7, Steps: 131 | Train Loss: 0.5709082 Vali Loss: 0.2972284 Best vali loss: 0.2972284
	iters: 100, epoch: 8 | loss: 0.3080429
	speed: 0.0101s/iter; left time: 0.3240s
Updating learning rate to 0.0
Validation loss decreased (0.2972 --> 0.2971).  Saving model state dict ...
Epoch: 8 cost time: 0.8269646167755127
Epoch: 8, Steps: 131 | Train Loss: 0.3080429 Vali Loss: 0.2971043 Best vali loss: 0.2971043

best validation loss 0.29710429615915024

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.007940080013, 'e_layers': 4, 'learning_rate': 0.0005392900295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4462961
	speed: 0.0123s/iter; left time: 24.5927s
	iters: 200, epoch: 1 | loss: 0.3301474
	speed: 0.0075s/iter; left time: 14.2173s
Updating learning rate to 0.000518764524921229
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 2.163095712661743
Epoch: 1, Steps: 262 | Train Loss: 0.3882217 Vali Loss: 0.2866729 Best vali loss: 0.2866729
	iters: 100, epoch: 2 | loss: 0.9202887
	speed: 0.0146s/iter; left time: 25.3421s
	iters: 200, epoch: 2 | loss: 0.3126097
	speed: 0.0069s/iter; left time: 11.2143s
Updating learning rate to 0.0004603128331928716
Epoch: 2 cost time: 1.8159499168395996
Epoch: 2, Steps: 262 | Train Loss: 0.6164492 Vali Loss: 0.2870448 Best vali loss: 0.2866729
	iters: 100, epoch: 3 | loss: 0.8534275
	speed: 0.0152s/iter; left time: 22.4233s
	iters: 200, epoch: 3 | loss: 0.3956472
	speed: 0.0073s/iter; left time: 10.0717s
Updating learning rate to 0.0003728336945146653
Epoch: 3 cost time: 1.9507789611816406
Epoch: 3, Steps: 262 | Train Loss: 0.6245374 Vali Loss: 0.2927421 Best vali loss: 0.2866729
	iters: 100, epoch: 4 | loss: 0.2891280
	speed: 0.0139s/iter; left time: 16.8611s
	iters: 200, epoch: 4 | loss: 0.4711838
	speed: 0.0059s/iter; left time: 6.5101s
Updating learning rate to 0.00026964501475
Epoch: 4 cost time: 1.6304466724395752
Epoch: 4, Steps: 262 | Train Loss: 0.3801559 Vali Loss: 0.2907577 Best vali loss: 0.2866729
	iters: 100, epoch: 5 | loss: 0.4628078
	speed: 0.0129s/iter; left time: 12.2389s
	iters: 200, epoch: 5 | loss: 0.3930600
	speed: 0.0064s/iter; left time: 5.3977s
Updating learning rate to 0.00016645633498533474
Epoch: 5 cost time: 1.7128989696502686
Epoch: 5, Steps: 262 | Train Loss: 0.4279339 Vali Loss: 0.2916791 Best vali loss: 0.2866729
	iters: 100, epoch: 6 | loss: 0.4234761
	speed: 0.0143s/iter; left time: 9.7979s
	iters: 200, epoch: 6 | loss: 0.2669298
	speed: 0.0073s/iter; left time: 4.2904s
Updating learning rate to 7.897719630712839e-05
Epoch: 6 cost time: 1.8859939575195312
Epoch: 6, Steps: 262 | Train Loss: 0.3452030 Vali Loss: 0.2989517 Best vali loss: 0.2866729
	iters: 100, epoch: 7 | loss: 0.4459693
	speed: 0.0140s/iter; left time: 5.9499s
	iters: 200, epoch: 7 | loss: 0.6416417
	speed: 0.0065s/iter; left time: 2.1086s
Updating learning rate to 2.0525504578770982e-05
Epoch: 7 cost time: 1.6810402870178223
Epoch: 7, Steps: 262 | Train Loss: 0.5438055 Vali Loss: 0.2976469 Best vali loss: 0.2866729
	iters: 100, epoch: 8 | loss: 0.3642613
	speed: 0.0130s/iter; left time: 2.1243s
	iters: 200, epoch: 8 | loss: 0.5407600
	speed: 0.0085s/iter; left time: 0.5350s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.176044464111328
Epoch: 8, Steps: 262 | Train Loss: 0.4525106 Vali Loss: 0.2976318 Best vali loss: 0.2866729

best validation loss 0.2866729056804142

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008999589749, 'e_layers': 3, 'learning_rate': 9.85480766e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2293513
	speed: 0.0097s/iter; left time: 80.2872s
	iters: 200, epoch: 1 | loss: 0.4619632
	speed: 0.0059s/iter; left time: 48.3624s
	iters: 300, epoch: 1 | loss: 0.6964834
	speed: 0.0062s/iter; left time: 49.8556s
	iters: 400, epoch: 1 | loss: 1.2415910
	speed: 0.0062s/iter; left time: 49.4880s
	iters: 500, epoch: 1 | loss: 0.2221450
	speed: 0.0062s/iter; left time: 48.8295s
	iters: 600, epoch: 1 | loss: 0.4291615
	speed: 0.0062s/iter; left time: 48.2845s
	iters: 700, epoch: 1 | loss: 0.4677112
	speed: 0.0062s/iter; left time: 47.6490s
	iters: 800, epoch: 1 | loss: 1.1501842
	speed: 0.0062s/iter; left time: 46.8651s
	iters: 900, epoch: 1 | loss: 0.1311926
	speed: 0.0062s/iter; left time: 46.4700s
	iters: 1000, epoch: 1 | loss: 0.5674299
	speed: 0.0063s/iter; left time: 46.0292s
Updating learning rate to 9.479731376954724e-05
Validation loss decreased (inf --> 0.2747).  Saving model state dict ...
Epoch: 1 cost time: 6.554686546325684
Epoch: 1, Steps: 1045 | Train Loss: 0.5597213 Vali Loss: 0.2747037 Best vali loss: 0.2747037
	iters: 100, epoch: 2 | loss: 0.4450684
	speed: 0.0183s/iter; left time: 132.2111s
	iters: 200, epoch: 2 | loss: 0.5520744
	speed: 0.0060s/iter; left time: 42.3417s
	iters: 300, epoch: 2 | loss: 1.2349559
	speed: 0.0063s/iter; left time: 44.1094s
	iters: 400, epoch: 2 | loss: 0.2242772
	speed: 0.0063s/iter; left time: 43.3993s
	iters: 500, epoch: 2 | loss: 0.6904760
	speed: 0.0063s/iter; left time: 42.8086s
	iters: 600, epoch: 2 | loss: 0.4456442
	speed: 0.0063s/iter; left time: 42.5078s
	iters: 700, epoch: 2 | loss: 0.3685963
	speed: 0.0062s/iter; left time: 41.0940s
	iters: 800, epoch: 2 | loss: 0.3562489
	speed: 0.0061s/iter; left time: 39.9014s
	iters: 900, epoch: 2 | loss: 0.1570952
	speed: 0.0062s/iter; left time: 39.6819s
	iters: 1000, epoch: 2 | loss: 0.2780651
	speed: 0.0063s/iter; left time: 39.8549s
Updating learning rate to 8.411604491837567e-05
Epoch: 2 cost time: 6.483081102371216
Epoch: 2, Steps: 1045 | Train Loss: 0.4752502 Vali Loss: 0.2871434 Best vali loss: 0.2747037
	iters: 100, epoch: 3 | loss: 0.5864921
	speed: 0.0182s/iter; left time: 112.2765s
	iters: 200, epoch: 3 | loss: 0.1726541
	speed: 0.0061s/iter; left time: 37.0861s
	iters: 300, epoch: 3 | loss: 0.2269757
	speed: 0.0063s/iter; left time: 37.3404s
	iters: 400, epoch: 3 | loss: 0.5195670
	speed: 0.0063s/iter; left time: 36.7650s
	iters: 500, epoch: 3 | loss: 0.1589501
	speed: 0.0062s/iter; left time: 36.0228s
	iters: 600, epoch: 3 | loss: 0.1660503
	speed: 0.0063s/iter; left time: 35.4539s
	iters: 700, epoch: 3 | loss: 0.3420941
	speed: 0.0063s/iter; left time: 34.8357s
	iters: 800, epoch: 3 | loss: 0.5467117
	speed: 0.0062s/iter; left time: 34.1518s
	iters: 900, epoch: 3 | loss: 0.6362433
	speed: 0.0063s/iter; left time: 33.6462s
	iters: 1000, epoch: 3 | loss: 0.2399971
	speed: 0.0062s/iter; left time: 32.9252s
Updating learning rate to 6.81303964031329e-05
Epoch: 3 cost time: 6.453723192214966
Epoch: 3, Steps: 1045 | Train Loss: 0.3595735 Vali Loss: 0.2810290 Best vali loss: 0.2747037

best validation loss 0.2747036878694252

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012653404301, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6793509
	speed: 0.0125s/iter; left time: 25.0136s
	iters: 200, epoch: 1 | loss: 0.6088722
	speed: 0.0069s/iter; left time: 13.0809s
Updating learning rate to 0.0005385115939239891
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 2.1031627655029297
Epoch: 1, Steps: 262 | Train Loss: 0.6441115 Vali Loss: 0.2822338 Best vali loss: 0.2822338
	iters: 100, epoch: 2 | loss: 0.2490506
	speed: 0.0147s/iter; left time: 25.5506s
	iters: 200, epoch: 2 | loss: 0.6440583
	speed: 0.0067s/iter; left time: 11.0294s
Updating learning rate to 0.0004778349050448276
Epoch: 2 cost time: 1.8556056022644043
Epoch: 2, Steps: 262 | Train Loss: 0.4465545 Vali Loss: 0.2963662 Best vali loss: 0.2822338
	iters: 100, epoch: 3 | loss: 0.2859102
	speed: 0.0149s/iter; left time: 21.9530s
	iters: 200, epoch: 3 | loss: 0.7736878
	speed: 0.0071s/iter; left time: 9.7927s
Updating learning rate to 0.0003870258228088137
Epoch: 3 cost time: 1.85642409324646
Epoch: 3, Steps: 262 | Train Loss: 0.5297990 Vali Loss: 0.2952713 Best vali loss: 0.2822338

best validation loss 0.28223382654731805

[INFO][smbo.py:320] Finished 200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004792616286, 'e_layers': 2, 'learning_rate': 0.0015570047911, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4845809
	speed: 0.0109s/iter; left time: 10.3570s
Updating learning rate to 0.0014977448248096508
Validation loss decreased (inf --> 0.3006).  Saving model state dict ...
Epoch: 1 cost time: 0.9705884456634521
Epoch: 1, Steps: 131 | Train Loss: 0.4845809 Vali Loss: 0.3005859 Best vali loss: 0.3005859
	iters: 100, epoch: 2 | loss: 0.6498735
	speed: 0.0092s/iter; left time: 7.5267s
Updating learning rate to 0.0013289867186133768
Validation loss decreased (0.3006 --> 0.2878).  Saving model state dict ...
Epoch: 2 cost time: 0.7354748249053955
Epoch: 2, Steps: 131 | Train Loss: 0.6498735 Vali Loss: 0.2878189 Best vali loss: 0.2878189
	iters: 100, epoch: 3 | loss: 0.8074731
	speed: 0.0095s/iter; left time: 6.4924s
Updating learning rate to 0.0010764223643835189
Epoch: 3 cost time: 0.7463333606719971
Epoch: 3, Steps: 131 | Train Loss: 0.8074731 Vali Loss: 0.2974186 Best vali loss: 0.2878189

best validation loss 0.2878188798117478

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008999589749, 'e_layers': 3, 'learning_rate': 9.85480766e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2036591
	speed: 0.0122s/iter; left time: 62.7927s
	iters: 200, epoch: 4 | loss: 0.4360229
	speed: 0.0062s/iter; left time: 30.9390s
	iters: 300, epoch: 4 | loss: 0.5874910
	speed: 0.0062s/iter; left time: 30.4953s
	iters: 400, epoch: 4 | loss: 0.7548021
	speed: 0.0054s/iter; left time: 26.2302s
	iters: 500, epoch: 4 | loss: 0.2103460
	speed: 0.0047s/iter; left time: 22.2904s
	iters: 600, epoch: 4 | loss: 0.3461808
	speed: 0.0046s/iter; left time: 21.3947s
	iters: 700, epoch: 4 | loss: 0.4041660
	speed: 0.0036s/iter; left time: 16.4885s
	iters: 800, epoch: 4 | loss: 0.7066662
	speed: 0.0037s/iter; left time: 16.2403s
	iters: 900, epoch: 4 | loss: 0.1348800
	speed: 0.0037s/iter; left time: 15.9241s
	iters: 1000, epoch: 4 | loss: 0.4676440
	speed: 0.0038s/iter; left time: 15.8796s
Updating learning rate to 4.92740383e-05
Epoch: 4 cost time: 5.30781102180481
Epoch: 4, Steps: 1045 | Train Loss: 0.4251858 Vali Loss: 0.2809427 Best vali loss: 0.2747037
	iters: 100, epoch: 5 | loss: 0.3936037
	speed: 0.0167s/iter; left time: 68.1148s
	iters: 200, epoch: 5 | loss: 0.4209675
	speed: 0.0056s/iter; left time: 22.3540s
	iters: 300, epoch: 5 | loss: 0.8251854
	speed: 0.0053s/iter; left time: 20.6635s
	iters: 400, epoch: 5 | loss: 0.2181636
	speed: 0.0058s/iter; left time: 21.9992s
	iters: 500, epoch: 5 | loss: 0.4069226
	speed: 0.0061s/iter; left time: 22.3726s
	iters: 600, epoch: 5 | loss: 0.2418952
	speed: 0.0053s/iter; left time: 19.0766s
	iters: 700, epoch: 5 | loss: 0.2901525
	speed: 0.0050s/iter; left time: 17.3998s
	iters: 800, epoch: 5 | loss: 0.2913251
	speed: 0.0050s/iter; left time: 17.0098s
	iters: 900, epoch: 5 | loss: 0.1680618
	speed: 0.0041s/iter; left time: 13.2895s
	iters: 1000, epoch: 5 | loss: 0.2390956
	speed: 0.0047s/iter; left time: 15.0095s
Updating learning rate to 3.041768019686711e-05
Epoch: 5 cost time: 5.585865497589111
Epoch: 5, Steps: 1045 | Train Loss: 0.3495373 Vali Loss: 0.3032213 Best vali loss: 0.2747037
	iters: 100, epoch: 6 | loss: 0.4137879
	speed: 0.0175s/iter; left time: 53.0369s
	iters: 200, epoch: 6 | loss: 0.1531757
	speed: 0.0055s/iter; left time: 16.1134s
	iters: 300, epoch: 6 | loss: 0.1635175
	speed: 0.0058s/iter; left time: 16.4796s
	iters: 400, epoch: 6 | loss: 0.3884583
	speed: 0.0050s/iter; left time: 13.7899s
	iters: 500, epoch: 6 | loss: 0.1446105
	speed: 0.0060s/iter; left time: 15.8947s
	iters: 600, epoch: 6 | loss: 0.1335472
	speed: 0.0052s/iter; left time: 13.0636s
	iters: 700, epoch: 6 | loss: 0.3106583
	speed: 0.0055s/iter; left time: 13.4179s
	iters: 800, epoch: 6 | loss: 0.4574736
	speed: 0.0051s/iter; left time: 11.9605s
	iters: 900, epoch: 6 | loss: 0.4378899
	speed: 0.0058s/iter; left time: 12.8975s
	iters: 1000, epoch: 6 | loss: 0.2229602
	speed: 0.0053s/iter; left time: 11.2756s
Updating learning rate to 1.4432031681624341e-05
Epoch: 6 cost time: 5.791501522064209
Epoch: 6, Steps: 1045 | Train Loss: 0.2826079 Vali Loss: 0.3184079 Best vali loss: 0.2747037
	iters: 100, epoch: 7 | loss: 0.2729267
	speed: 0.0175s/iter; left time: 34.7687s
	iters: 200, epoch: 7 | loss: 0.1461862
	speed: 0.0048s/iter; left time: 9.1034s
	iters: 300, epoch: 7 | loss: 0.2256520
	speed: 0.0043s/iter; left time: 7.6478s
	iters: 400, epoch: 7 | loss: 0.1432383
	speed: 0.0072s/iter; left time: 12.2021s
	iters: 500, epoch: 7 | loss: 0.7070280
	speed: 0.0080s/iter; left time: 12.6617s
	iters: 600, epoch: 7 | loss: 0.2130667
	speed: 0.0073s/iter; left time: 10.9334s
	iters: 700, epoch: 7 | loss: 0.4019087
	speed: 0.0075s/iter; left time: 10.4817s
	iters: 800, epoch: 7 | loss: 0.3174301
	speed: 0.0040s/iter; left time: 5.2141s
	iters: 900, epoch: 7 | loss: 0.5740291
	speed: 0.0042s/iter; left time: 4.9496s
	iters: 1000, epoch: 7 | loss: 0.1220581
	speed: 0.0047s/iter; left time: 5.1744s
Updating learning rate to 3.750762830452762e-06
Epoch: 7 cost time: 6.0407843589782715
Epoch: 7, Steps: 1045 | Train Loss: 0.3123524 Vali Loss: 0.3264383 Best vali loss: 0.2747037
	iters: 100, epoch: 8 | loss: 0.2698083
	speed: 0.0147s/iter; left time: 13.8797s
	iters: 200, epoch: 8 | loss: 0.2300765
	speed: 0.0038s/iter; left time: 3.2160s
	iters: 300, epoch: 8 | loss: 0.3914431
	speed: 0.0053s/iter; left time: 3.9288s
	iters: 400, epoch: 8 | loss: 0.3101458
	speed: 0.0050s/iter; left time: 3.2431s
	iters: 500, epoch: 8 | loss: 0.1802679
	speed: 0.0054s/iter; left time: 2.9640s
	iters: 600, epoch: 8 | loss: 0.1560774
	speed: 0.0052s/iter; left time: 2.3064s
	iters: 700, epoch: 8 | loss: 0.3066311
	speed: 0.0049s/iter; left time: 1.6808s
	iters: 800, epoch: 8 | loss: 0.1912566
	speed: 0.0041s/iter; left time: 1.0077s
	iters: 900, epoch: 8 | loss: 0.5134526
	speed: 0.0050s/iter; left time: 0.7292s
	iters: 1000, epoch: 8 | loss: 0.1718306
	speed: 0.0081s/iter; left time: 0.3721s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.577677488327026
Epoch: 8, Steps: 1045 | Train Loss: 0.2720990 Vali Loss: 0.3286960 Best vali loss: 0.2747037

best validation loss 0.2747036878694252

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094422831379, 'e_layers': 4, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 0.6772520542144775
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2842836 Best vali loss: 0.2842836
Updating learning rate to 0.0009137180420535848
Validation loss decreased (0.2843 --> 0.2835).  Saving model state dict ...
Epoch: 2 cost time: 0.5391771793365479
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2835057 Best vali loss: 0.2835057
Updating learning rate to 0.0007400725089513316
Epoch: 3 cost time: 0.4719882011413574
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2869979 Best vali loss: 0.2835057
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 0.5526909828186035
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2902600 Best vali loss: 0.2835057
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 0.5054943561553955
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2840039 Best vali loss: 0.2835057
Updating learning rate to 0.00015676923164641517
Epoch: 6 cost time: 0.49085259437561035
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2950086 Best vali loss: 0.2835057
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 0.5446398258209229
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2917739 Best vali loss: 0.2835057
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4849274158477783
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2923610 Best vali loss: 0.2835057

best validation loss 0.28350568473250415

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009319745802, 'e_layers': 4, 'learning_rate': 0.0004945924346, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6022323
	speed: 0.0119s/iter; left time: 11.2586s
Updating learning rate to 0.0004945924346
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 1.0953636169433594
Epoch: 1, Steps: 131 | Train Loss: 0.6022323 Vali Loss: 0.2833085 Best vali loss: 0.2833085
	iters: 100, epoch: 2 | loss: 0.3204991
	speed: 0.0106s/iter; left time: 8.6662s
Updating learning rate to 0.0002472962173
Epoch: 2 cost time: 0.9003286361694336
Epoch: 2, Steps: 131 | Train Loss: 0.3204991 Vali Loss: 0.2844125 Best vali loss: 0.2833085
	iters: 100, epoch: 3 | loss: 0.2932191
	speed: 0.0102s/iter; left time: 7.0266s
Updating learning rate to 0.00012364810865
Epoch: 3 cost time: 0.8425707817077637
Epoch: 3, Steps: 131 | Train Loss: 0.2932191 Vali Loss: 0.2861497 Best vali loss: 0.2833085
	iters: 100, epoch: 4 | loss: 0.5223132
	speed: 0.0090s/iter; left time: 5.0267s
Updating learning rate to 6.1824054325e-05
Epoch: 4 cost time: 0.7663137912750244
Epoch: 4, Steps: 131 | Train Loss: 0.5223132 Vali Loss: 0.2844490 Best vali loss: 0.2833085
	iters: 100, epoch: 5 | loss: 0.6535899
	speed: 0.0099s/iter; left time: 4.2100s
Updating learning rate to 3.09120271625e-05
Epoch: 5 cost time: 0.8435509204864502
Epoch: 5, Steps: 131 | Train Loss: 0.6535899 Vali Loss: 0.2838984 Best vali loss: 0.2833085
	iters: 100, epoch: 6 | loss: 0.3743334
	speed: 0.0107s/iter; left time: 3.1314s
Updating learning rate to 1.545601358125e-05
Epoch: 6 cost time: 0.9276371002197266
Epoch: 6, Steps: 131 | Train Loss: 0.3743334 Vali Loss: 0.2845568 Best vali loss: 0.2833085
	iters: 100, epoch: 7 | loss: 0.4282238
	speed: 0.0099s/iter; left time: 1.6179s
Updating learning rate to 7.728006790625e-06
Epoch: 7 cost time: 0.8123006820678711
Epoch: 7, Steps: 131 | Train Loss: 0.4282238 Vali Loss: 0.2850492 Best vali loss: 0.2833085
	iters: 100, epoch: 8 | loss: 0.4872541
	speed: 0.0099s/iter; left time: 0.3175s
Updating learning rate to 3.8640033953125e-06
Epoch: 8 cost time: 0.8580911159515381
Epoch: 8, Steps: 131 | Train Loss: 0.4872541 Vali Loss: 0.2849653 Best vali loss: 0.2833085

best validation loss 0.2833085005812682

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4813119
	speed: 0.0105s/iter; left time: 9.9570s
Updating learning rate to 9.547589994094374e-05
Validation loss decreased (inf --> 0.2798).  Saving model state dict ...
Epoch: 1 cost time: 0.917799711227417
Epoch: 1, Steps: 131 | Train Loss: 0.4813119 Vali Loss: 0.2798014 Best vali loss: 0.2798014
	iters: 100, epoch: 2 | loss: 0.6199791
	speed: 0.0084s/iter; left time: 6.8395s
Updating learning rate to 8.47181715251795e-05
Validation loss decreased (0.2798 --> 0.2753).  Saving model state dict ...
Epoch: 2 cost time: 0.6908514499664307
Epoch: 2, Steps: 131 | Train Loss: 0.6199791 Vali Loss: 0.2753378 Best vali loss: 0.2753378
	iters: 100, epoch: 3 | loss: 0.6801647
	speed: 0.0083s/iter; left time: 5.6813s
Updating learning rate to 6.861809318495647e-05
Epoch: 3 cost time: 0.6315724849700928
Epoch: 3, Steps: 131 | Train Loss: 0.6801647 Vali Loss: 0.2760139 Best vali loss: 0.2753378

best validation loss 0.27533778014591787

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0004262443426, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2820853
	speed: 0.0080s/iter; left time: 7.6308s
Updating learning rate to 0.0004262443426
Validation loss decreased (inf --> 0.3009).  Saving model state dict ...
Epoch: 1 cost time: 0.6208829879760742
Epoch: 1, Steps: 131 | Train Loss: 0.2820853 Vali Loss: 0.3008655 Best vali loss: 0.3008655
	iters: 100, epoch: 2 | loss: 0.5516838
	speed: 0.0053s/iter; left time: 4.3625s
Updating learning rate to 0.0002131221713
Validation loss decreased (0.3009 --> 0.2863).  Saving model state dict ...
Epoch: 2 cost time: 0.40228867530822754
Epoch: 2, Steps: 131 | Train Loss: 0.5516838 Vali Loss: 0.2862949 Best vali loss: 0.2862949
	iters: 100, epoch: 3 | loss: 0.4779041
	speed: 0.0053s/iter; left time: 3.6355s
Updating learning rate to 0.00010656108565
Validation loss decreased (0.2863 --> 0.2831).  Saving model state dict ...
Epoch: 3 cost time: 0.39781689643859863
Epoch: 3, Steps: 131 | Train Loss: 0.4779041 Vali Loss: 0.2831003 Best vali loss: 0.2831003

best validation loss 0.2831003371114933

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0111145234284, 'e_layers': 2, 'learning_rate': 0.0023180376832, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7654639
	speed: 0.0100s/iter; left time: 9.4719s
Updating learning rate to 0.0023180376832
Validation loss decreased (inf --> 0.2900).  Saving model state dict ...
Epoch: 1 cost time: 0.8704214096069336
Epoch: 1, Steps: 131 | Train Loss: 0.7654639 Vali Loss: 0.2899728 Best vali loss: 0.2899728
	iters: 100, epoch: 2 | loss: 0.4587803
	speed: 0.0077s/iter; left time: 6.3229s
Updating learning rate to 0.0011590188416
Epoch: 2 cost time: 0.6188442707061768
Epoch: 2, Steps: 131 | Train Loss: 0.4587803 Vali Loss: 0.3019663 Best vali loss: 0.2899728
	iters: 100, epoch: 3 | loss: 0.6942660
	speed: 0.0077s/iter; left time: 5.2690s
Updating learning rate to 0.0005795094208
Epoch: 3 cost time: 0.6311790943145752
Epoch: 3, Steps: 131 | Train Loss: 0.6942660 Vali Loss: 0.2985995 Best vali loss: 0.2899728

best validation loss 0.2899728464832001

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4074628
	speed: 0.0104s/iter; left time: 5.7914s
Updating learning rate to 4.96267559e-05
Epoch: 4 cost time: 0.8819665908813477
Epoch: 4, Steps: 131 | Train Loss: 0.4074628 Vali Loss: 0.2850568 Best vali loss: 0.2753378
	iters: 100, epoch: 5 | loss: 0.5245564
	speed: 0.0079s/iter; left time: 3.3494s
Updating learning rate to 3.063541861504353e-05
Epoch: 5 cost time: 0.6289212703704834
Epoch: 5, Steps: 131 | Train Loss: 0.5245564 Vali Loss: 0.2834630 Best vali loss: 0.2753378
	iters: 100, epoch: 6 | loss: 0.5648521
	speed: 0.0081s/iter; left time: 2.3723s
Updating learning rate to 1.4535340274820496e-05
Epoch: 6 cost time: 0.6670081615447998
Epoch: 6, Steps: 131 | Train Loss: 0.5648521 Vali Loss: 0.2936884 Best vali loss: 0.2753378
	iters: 100, epoch: 7 | loss: 0.5351101
	speed: 0.0082s/iter; left time: 1.3333s
Updating learning rate to 3.777611859056259e-06
Epoch: 7 cost time: 0.6592955589294434
Epoch: 7, Steps: 131 | Train Loss: 0.5351101 Vali Loss: 0.2932227 Best vali loss: 0.2753378
	iters: 100, epoch: 8 | loss: 0.3874512
	speed: 0.0082s/iter; left time: 0.2636s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.665780782699585
Epoch: 8, Steps: 131 | Train Loss: 0.3874512 Vali Loss: 0.2937078 Best vali loss: 0.2753378

best validation loss 0.27533778014591787

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0071897631756, 'e_layers': 1, 'learning_rate': 0.0003622765966, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3773331
	speed: 0.0082s/iter; left time: 16.4352s
	iters: 200, epoch: 1 | loss: 0.4913320
	speed: 0.0029s/iter; left time: 5.4244s
Updating learning rate to 0.0003622765966
Validation loss decreased (inf --> 0.2875).  Saving model state dict ...
Epoch: 1 cost time: 1.0168867111206055
Epoch: 1, Steps: 262 | Train Loss: 0.4343326 Vali Loss: 0.2875046 Best vali loss: 0.2875046
	iters: 100, epoch: 2 | loss: 0.9384176
	speed: 0.0070s/iter; left time: 12.1145s
	iters: 200, epoch: 2 | loss: 0.4923110
	speed: 0.0029s/iter; left time: 4.6749s
Updating learning rate to 0.0001811382983
Validation loss decreased (0.2875 --> 0.2799).  Saving model state dict ...
Epoch: 2 cost time: 0.7711310386657715
Epoch: 2, Steps: 262 | Train Loss: 0.7153643 Vali Loss: 0.2798902 Best vali loss: 0.2798902
	iters: 100, epoch: 3 | loss: 0.2667873
	speed: 0.0069s/iter; left time: 10.1901s
	iters: 200, epoch: 3 | loss: 0.7040560
	speed: 0.0027s/iter; left time: 3.6871s
Updating learning rate to 9.056914915e-05
Epoch: 3 cost time: 0.7555646896362305
Epoch: 3, Steps: 262 | Train Loss: 0.4854216 Vali Loss: 0.2874685 Best vali loss: 0.2798902
	iters: 100, epoch: 4 | loss: 0.4574476
	speed: 0.0074s/iter; left time: 9.0025s
	iters: 200, epoch: 4 | loss: 0.5272478
	speed: 0.0031s/iter; left time: 3.4330s
Updating learning rate to 4.5284574575e-05
Epoch: 4 cost time: 0.8644928932189941
Epoch: 4, Steps: 262 | Train Loss: 0.4923477 Vali Loss: 0.2912390 Best vali loss: 0.2798902
	iters: 100, epoch: 5 | loss: 0.3923519
	speed: 0.0072s/iter; left time: 6.8043s
	iters: 200, epoch: 5 | loss: 0.4090348
	speed: 0.0029s/iter; left time: 2.4234s
Updating learning rate to 2.26422872875e-05
Epoch: 5 cost time: 0.7954070568084717
Epoch: 5, Steps: 262 | Train Loss: 0.4006934 Vali Loss: 0.2930685 Best vali loss: 0.2798902
	iters: 100, epoch: 6 | loss: 0.5433865
	speed: 0.0069s/iter; left time: 4.7722s
	iters: 200, epoch: 6 | loss: 0.2417718
	speed: 0.0028s/iter; left time: 1.6193s
Updating learning rate to 1.132114364375e-05
Epoch: 6 cost time: 0.7646093368530273
Epoch: 6, Steps: 262 | Train Loss: 0.3925791 Vali Loss: 0.2947537 Best vali loss: 0.2798902
	iters: 100, epoch: 7 | loss: 0.4366139
	speed: 0.0069s/iter; left time: 2.9466s
	iters: 200, epoch: 7 | loss: 0.4662002
	speed: 0.0028s/iter; left time: 0.9096s
Updating learning rate to 5.660571821875e-06
Epoch: 7 cost time: 0.7536256313323975
Epoch: 7, Steps: 262 | Train Loss: 0.4514071 Vali Loss: 0.2949317 Best vali loss: 0.2798902
	iters: 100, epoch: 8 | loss: 0.3136611
	speed: 0.0066s/iter; left time: 1.0810s
	iters: 200, epoch: 8 | loss: 0.4656998
	speed: 0.0025s/iter; left time: 0.1596s
Updating learning rate to 2.8302859109375e-06
Epoch: 8 cost time: 0.7126584053039551
Epoch: 8, Steps: 262 | Train Loss: 0.3896804 Vali Loss: 0.2952336 Best vali loss: 0.2798902

best validation loss 0.27989024994496564

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 1, 'learning_rate': 0.0015843837106, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3212476
	speed: 0.0083s/iter; left time: 16.5061s
	iters: 200, epoch: 1 | loss: 0.6608054
	speed: 0.0030s/iter; left time: 5.6290s
Updating learning rate to 0.001524081696233813
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 1.0472996234893799
Epoch: 1, Steps: 262 | Train Loss: 0.4910265 Vali Loss: 0.2901309 Best vali loss: 0.2901309
	iters: 100, epoch: 2 | loss: 0.4406987
	speed: 0.0072s/iter; left time: 12.4490s
	iters: 200, epoch: 2 | loss: 0.3786159
	speed: 0.0029s/iter; left time: 4.7572s
Updating learning rate to 0.0013523560881833821
Epoch: 2 cost time: 0.8269374370574951
Epoch: 2, Steps: 262 | Train Loss: 0.4096573 Vali Loss: 0.2971036 Best vali loss: 0.2901309
	iters: 100, epoch: 3 | loss: 0.2563300
	speed: 0.0073s/iter; left time: 10.6833s
	iters: 200, epoch: 3 | loss: 0.5432405
	speed: 0.0029s/iter; left time: 3.9150s
Updating learning rate to 0.0010953505535778727
Epoch: 3 cost time: 0.7850582599639893
Epoch: 3, Steps: 262 | Train Loss: 0.3997853 Vali Loss: 0.3050056 Best vali loss: 0.2901309
	iters: 100, epoch: 4 | loss: 0.3935505
	speed: 0.0074s/iter; left time: 8.9322s
	iters: 200, epoch: 4 | loss: 0.3079359
	speed: 0.0029s/iter; left time: 3.1741s
Updating learning rate to 0.0007921918553
Epoch: 4 cost time: 0.8330488204956055
Epoch: 4, Steps: 262 | Train Loss: 0.3507432 Vali Loss: 0.3035317 Best vali loss: 0.2901309
	iters: 100, epoch: 5 | loss: 0.4863567
	speed: 0.0074s/iter; left time: 6.9947s
	iters: 200, epoch: 5 | loss: 0.2904974
	speed: 0.0030s/iter; left time: 2.5054s
Updating learning rate to 0.0004890331570221276
Epoch: 5 cost time: 0.8128032684326172
Epoch: 5, Steps: 262 | Train Loss: 0.3884270 Vali Loss: 0.3270263 Best vali loss: 0.2901309
	iters: 100, epoch: 6 | loss: 0.2633419
	speed: 0.0073s/iter; left time: 4.9856s
	iters: 200, epoch: 6 | loss: 0.2700472
	speed: 0.0031s/iter; left time: 1.8161s
Updating learning rate to 0.00023202762241661783
Epoch: 6 cost time: 0.8530418872833252
Epoch: 6, Steps: 262 | Train Loss: 0.2666945 Vali Loss: 0.3208604 Best vali loss: 0.2901309
	iters: 100, epoch: 7 | loss: 0.4935030
	speed: 0.0076s/iter; left time: 3.2453s
	iters: 200, epoch: 7 | loss: 0.2958559
	speed: 0.0031s/iter; left time: 1.0053s
Updating learning rate to 6.030201436618709e-05
Epoch: 7 cost time: 0.8683991432189941
Epoch: 7, Steps: 262 | Train Loss: 0.3946795 Vali Loss: 0.3273446 Best vali loss: 0.2901309
	iters: 100, epoch: 8 | loss: 0.2929935
	speed: 0.0074s/iter; left time: 1.2123s
	iters: 200, epoch: 8 | loss: 0.2027628
	speed: 0.0030s/iter; left time: 0.1915s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8490066528320312
Epoch: 8, Steps: 262 | Train Loss: 0.2478782 Vali Loss: 0.3258846 Best vali loss: 0.2901309

best validation loss 0.29013092742173724

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3129575
	speed: 0.0095s/iter; left time: 78.5956s
	iters: 200, epoch: 1 | loss: 0.4218470
	speed: 0.0033s/iter; left time: 26.9663s
	iters: 300, epoch: 1 | loss: 0.1836146
	speed: 0.0031s/iter; left time: 25.2620s
	iters: 400, epoch: 1 | loss: 0.3153523
	speed: 0.0036s/iter; left time: 28.6197s
	iters: 500, epoch: 1 | loss: 0.2058938
	speed: 0.0041s/iter; left time: 31.9949s
	iters: 600, epoch: 1 | loss: 1.8155807
	speed: 0.0042s/iter; left time: 32.6493s
	iters: 700, epoch: 1 | loss: 0.3440352
	speed: 0.0043s/iter; left time: 33.1983s
	iters: 800, epoch: 1 | loss: 0.2650097
	speed: 0.0032s/iter; left time: 23.9779s
	iters: 900, epoch: 1 | loss: 0.2467010
	speed: 0.0032s/iter; left time: 24.0592s
	iters: 1000, epoch: 1 | loss: 0.5345321
	speed: 0.0035s/iter; left time: 25.7820s
Updating learning rate to 0.0003784163294
Validation loss decreased (inf --> 0.2872).  Saving model state dict ...
Epoch: 1 cost time: 4.126816511154175
Epoch: 1, Steps: 1045 | Train Loss: 0.4645524 Vali Loss: 0.2872261 Best vali loss: 0.2872261
	iters: 100, epoch: 2 | loss: 0.4497437
	speed: 0.0160s/iter; left time: 115.2108s
	iters: 200, epoch: 2 | loss: 0.4246314
	speed: 0.0042s/iter; left time: 30.2127s
	iters: 300, epoch: 2 | loss: 0.5596440
	speed: 0.0033s/iter; left time: 23.2462s
	iters: 400, epoch: 2 | loss: 0.5008355
	speed: 0.0030s/iter; left time: 21.0423s
	iters: 500, epoch: 2 | loss: 0.3512031
	speed: 0.0034s/iter; left time: 23.2716s
	iters: 600, epoch: 2 | loss: 0.1963763
	speed: 0.0046s/iter; left time: 30.6469s
	iters: 700, epoch: 2 | loss: 0.3969435
	speed: 0.0046s/iter; left time: 30.2002s
	iters: 800, epoch: 2 | loss: 0.2357110
	speed: 0.0045s/iter; left time: 29.6175s
	iters: 900, epoch: 2 | loss: 0.2373032
	speed: 0.0041s/iter; left time: 26.3927s
	iters: 1000, epoch: 2 | loss: 0.5042178
	speed: 0.0041s/iter; left time: 25.8270s
Updating learning rate to 0.0001892081647
Epoch: 2 cost time: 4.262551307678223
Epoch: 2, Steps: 1045 | Train Loss: 0.3856609 Vali Loss: 0.2942368 Best vali loss: 0.2872261
	iters: 100, epoch: 3 | loss: 0.2334719
	speed: 0.0143s/iter; left time: 88.2441s
	iters: 200, epoch: 3 | loss: 0.1755000
	speed: 0.0045s/iter; left time: 27.4336s
	iters: 300, epoch: 3 | loss: 0.3606491
	speed: 0.0046s/iter; left time: 27.4612s
	iters: 400, epoch: 3 | loss: 0.7508564
	speed: 0.0043s/iter; left time: 25.1473s
	iters: 500, epoch: 3 | loss: 0.2166792
	speed: 0.0039s/iter; left time: 22.5303s
	iters: 600, epoch: 3 | loss: 0.4887838
	speed: 0.0039s/iter; left time: 21.9843s
	iters: 700, epoch: 3 | loss: 0.2605343
	speed: 0.0043s/iter; left time: 23.9231s
	iters: 800, epoch: 3 | loss: 0.3122334
	speed: 0.0043s/iter; left time: 23.5171s
	iters: 900, epoch: 3 | loss: 0.2327220
	speed: 0.0042s/iter; left time: 22.7427s
	iters: 1000, epoch: 3 | loss: 0.4120882
	speed: 0.0038s/iter; left time: 20.2310s
Updating learning rate to 9.460408235e-05
Epoch: 3 cost time: 4.415992021560669
Epoch: 3, Steps: 1045 | Train Loss: 0.3443518 Vali Loss: 0.2898203 Best vali loss: 0.2872261

best validation loss 0.2872261068842233

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020904164085, 'e_layers': 4, 'learning_rate': 0.0011131188943, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6185189
	speed: 0.0119s/iter; left time: 48.6300s
	iters: 200, epoch: 1 | loss: 0.8169447
	speed: 0.0063s/iter; left time: 25.0141s
	iters: 300, epoch: 1 | loss: 0.5168089
	speed: 0.0062s/iter; left time: 24.2169s
	iters: 400, epoch: 1 | loss: 0.4848201
	speed: 0.0064s/iter; left time: 24.1474s
	iters: 500, epoch: 1 | loss: 0.9778598
	speed: 0.0065s/iter; left time: 23.8280s
Updating learning rate to 0.0011131188943
Validation loss decreased (inf --> 0.2965).  Saving model state dict ...
Epoch: 1 cost time: 3.604186773300171
Epoch: 1, Steps: 523 | Train Loss: 0.6829905 Vali Loss: 0.2964743 Best vali loss: 0.2964743
	iters: 100, epoch: 2 | loss: 0.4344526
	speed: 0.0130s/iter; left time: 46.4565s
	iters: 200, epoch: 2 | loss: 0.7227670
	speed: 0.0062s/iter; left time: 21.4030s
	iters: 300, epoch: 2 | loss: 0.6852963
	speed: 0.0059s/iter; left time: 19.6985s
	iters: 400, epoch: 2 | loss: 0.4916916
	speed: 0.0047s/iter; left time: 15.2128s
	iters: 500, epoch: 2 | loss: 0.4396299
	speed: 0.0053s/iter; left time: 16.9034s
Updating learning rate to 0.00055655944715
Validation loss decreased (0.2965 --> 0.2890).  Saving model state dict ...
Epoch: 2 cost time: 3.0250349044799805
Epoch: 2, Steps: 523 | Train Loss: 0.5547675 Vali Loss: 0.2889505 Best vali loss: 0.2889505
	iters: 100, epoch: 3 | loss: 0.9167523
	speed: 0.0128s/iter; left time: 38.9222s
	iters: 200, epoch: 3 | loss: 0.4039275
	speed: 0.0061s/iter; left time: 18.0495s
	iters: 300, epoch: 3 | loss: 0.3430758
	speed: 0.0062s/iter; left time: 17.6019s
	iters: 400, epoch: 3 | loss: 0.4072367
	speed: 0.0063s/iter; left time: 17.1484s
	iters: 500, epoch: 3 | loss: 0.3232609
	speed: 0.0064s/iter; left time: 16.9037s
Updating learning rate to 0.000278279723575
Validation loss decreased (0.2890 --> 0.2862).  Saving model state dict ...
Epoch: 3 cost time: 3.3203630447387695
Epoch: 3, Steps: 523 | Train Loss: 0.4788506 Vali Loss: 0.2861649 Best vali loss: 0.2861649

best validation loss 0.2861649392483712

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019114256213, 'e_layers': 2, 'learning_rate': 0.0002250367297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00021647177916655239
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 0.5913434028625488
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2814537 Best vali loss: 0.2814537
Updating learning rate to 0.00019208086364345706
Validation loss decreased (0.2815 --> 0.2806).  Saving model state dict ...
Epoch: 2 cost time: 0.3476386070251465
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2805953 Best vali loss: 0.2805953
Updating learning rate to 0.00015557727891490547
Epoch: 3 cost time: 0.3652839660644531
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2814217 Best vali loss: 0.2805953

best validation loss 0.2805952676812616

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019114256213, 'e_layers': 2, 'learning_rate': 0.0002250367297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00011251836485
Validation loss decreased (0.2806 --> 0.2796).  Saving model state dict ...
Epoch: 4 cost time: 0.6115617752075195
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2795656 Best vali loss: 0.2795656
Updating learning rate to 6.945945078509453e-05
Epoch: 5 cost time: 0.33507442474365234
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2820978 Best vali loss: 0.2795656
Updating learning rate to 3.295586605654293e-05
Epoch: 6 cost time: 0.37158656120300293
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2809056 Best vali loss: 0.2795656
Updating learning rate to 8.564950533447601e-06
Epoch: 7 cost time: 0.4001150131225586
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2813374 Best vali loss: 0.2795656
Updating learning rate to 0.0
Epoch: 8 cost time: 0.34902048110961914
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2819533 Best vali loss: 0.2795656

best validation loss 0.27956562052876055

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0022899640873, 'e_layers': 4, 'learning_rate': 0.0002423804971, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4944693
	speed: 0.0119s/iter; left time: 23.7569s
	iters: 200, epoch: 1 | loss: 0.3309509
	speed: 0.0062s/iter; left time: 11.8022s
Updating learning rate to 0.00023315543872530064
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 1.9425129890441895
Epoch: 1, Steps: 262 | Train Loss: 0.4127101 Vali Loss: 0.2875723 Best vali loss: 0.2875723
	iters: 100, epoch: 2 | loss: 0.8907868
	speed: 0.0137s/iter; left time: 23.7281s
	iters: 200, epoch: 2 | loss: 0.4555084
	speed: 0.0060s/iter; left time: 9.8152s
Updating learning rate to 0.00020688469511338813
Validation loss decreased (0.2876 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 1.6047325134277344
Epoch: 2, Steps: 262 | Train Loss: 0.6731476 Vali Loss: 0.2838245 Best vali loss: 0.2838245
	iters: 100, epoch: 3 | loss: 0.8013318
	speed: 0.0119s/iter; left time: 17.5191s
	iters: 200, epoch: 3 | loss: 0.4619624
	speed: 0.0061s/iter; left time: 8.3452s
Updating learning rate to 0.00016756774883429235
Epoch: 3 cost time: 1.5957262516021729
Epoch: 3, Steps: 262 | Train Loss: 0.6316471 Vali Loss: 0.2843981 Best vali loss: 0.2838245
	iters: 100, epoch: 4 | loss: 0.2570897
	speed: 0.0124s/iter; left time: 14.9975s
	iters: 200, epoch: 4 | loss: 0.4320016
	speed: 0.0060s/iter; left time: 6.6497s
Updating learning rate to 0.00012119024855
Epoch: 4 cost time: 1.595776081085205
Epoch: 4, Steps: 262 | Train Loss: 0.3445456 Vali Loss: 0.2891948 Best vali loss: 0.2838245
	iters: 100, epoch: 5 | loss: 0.4945671
	speed: 0.0128s/iter; left time: 12.1620s
	iters: 200, epoch: 5 | loss: 0.6546365
	speed: 0.0059s/iter; left time: 4.9921s
Updating learning rate to 7.481274826570766e-05
Epoch: 5 cost time: 1.5954699516296387
Epoch: 5, Steps: 262 | Train Loss: 0.5746018 Vali Loss: 0.2852896 Best vali loss: 0.2838245
	iters: 100, epoch: 6 | loss: 0.3642395
	speed: 0.0126s/iter; left time: 8.6304s
	iters: 200, epoch: 6 | loss: 0.6215173
	speed: 0.0058s/iter; left time: 3.4177s
Updating learning rate to 3.549580198661185e-05
Epoch: 6 cost time: 1.569190502166748
Epoch: 6, Steps: 262 | Train Loss: 0.4928784 Vali Loss: 0.2873864 Best vali loss: 0.2838245
	iters: 100, epoch: 7 | loss: 0.4089972
	speed: 0.0125s/iter; left time: 5.3207s
	iters: 200, epoch: 7 | loss: 0.6993768
	speed: 0.0065s/iter; left time: 2.1011s
Updating learning rate to 9.225058374699354e-06
Epoch: 7 cost time: 1.6812012195587158
Epoch: 7, Steps: 262 | Train Loss: 0.5541870 Vali Loss: 0.2865217 Best vali loss: 0.2838245
	iters: 100, epoch: 8 | loss: 0.5904523
	speed: 0.0129s/iter; left time: 2.0954s
	iters: 200, epoch: 8 | loss: 0.3000121
	speed: 0.0061s/iter; left time: 0.3828s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6369996070861816
Epoch: 8, Steps: 262 | Train Loss: 0.4452322 Vali Loss: 0.2873850 Best vali loss: 0.2838245

best validation loss 0.28382447595798466

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0033888467905, 'e_layers': 1, 'learning_rate': 0.0037128733106, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2759395
	speed: 0.0083s/iter; left time: 16.4882s
	iters: 200, epoch: 1 | loss: 0.7870390
	speed: 0.0026s/iter; left time: 4.9922s
Updating learning rate to 0.0037128733106
Validation loss decreased (inf --> 0.2803).  Saving model state dict ...
Epoch: 1 cost time: 1.0065991878509521
Epoch: 1, Steps: 262 | Train Loss: 0.5314893 Vali Loss: 0.2802792 Best vali loss: 0.2802792
	iters: 100, epoch: 2 | loss: 0.3470424
	speed: 0.0071s/iter; left time: 12.3855s
	iters: 200, epoch: 2 | loss: 0.4686888
	speed: 0.0030s/iter; left time: 4.8797s
Updating learning rate to 0.0018564366553
Epoch: 2 cost time: 0.8140087127685547
Epoch: 2, Steps: 262 | Train Loss: 0.4078656 Vali Loss: 0.2970025 Best vali loss: 0.2802792
	iters: 100, epoch: 3 | loss: 0.3804743
	speed: 0.0071s/iter; left time: 10.4075s
	iters: 200, epoch: 3 | loss: 0.6943249
	speed: 0.0027s/iter; left time: 3.6396s
Updating learning rate to 0.00092821832765
Epoch: 3 cost time: 0.7485737800598145
Epoch: 3, Steps: 262 | Train Loss: 0.5373996 Vali Loss: 0.2892630 Best vali loss: 0.2802792
	iters: 100, epoch: 4 | loss: 0.3008936
	speed: 0.0071s/iter; left time: 8.5441s
	iters: 200, epoch: 4 | loss: 0.3381241
	speed: 0.0029s/iter; left time: 3.2230s
Updating learning rate to 0.000464109163825
Epoch: 4 cost time: 0.8031291961669922
Epoch: 4, Steps: 262 | Train Loss: 0.3195088 Vali Loss: 0.3041865 Best vali loss: 0.2802792
	iters: 100, epoch: 5 | loss: 0.7697006
	speed: 0.0071s/iter; left time: 6.7780s
	iters: 200, epoch: 5 | loss: 0.7045615
	speed: 0.0029s/iter; left time: 2.4627s
Updating learning rate to 0.0002320545819125
Epoch: 5 cost time: 0.8076074123382568
Epoch: 5, Steps: 262 | Train Loss: 0.7371311 Vali Loss: 0.2993369 Best vali loss: 0.2802792
	iters: 100, epoch: 6 | loss: 0.5956388
	speed: 0.0072s/iter; left time: 4.9360s
	iters: 200, epoch: 6 | loss: 0.3628020
	speed: 0.0029s/iter; left time: 1.6735s
Updating learning rate to 0.00011602729095625
Epoch: 6 cost time: 0.8006563186645508
Epoch: 6, Steps: 262 | Train Loss: 0.4792204 Vali Loss: 0.3016831 Best vali loss: 0.2802792
	iters: 100, epoch: 7 | loss: 0.4595065
	speed: 0.0071s/iter; left time: 3.0382s
	iters: 200, epoch: 7 | loss: 0.5254242
	speed: 0.0029s/iter; left time: 0.9376s
Updating learning rate to 5.8013645478125e-05
Epoch: 7 cost time: 0.7895832061767578
Epoch: 7, Steps: 262 | Train Loss: 0.4924654 Vali Loss: 0.3020079 Best vali loss: 0.2802792
	iters: 100, epoch: 8 | loss: 0.3571512
	speed: 0.0065s/iter; left time: 1.0520s
	iters: 200, epoch: 8 | loss: 0.5647743
	speed: 0.0028s/iter; left time: 0.1760s
Updating learning rate to 2.90068227390625e-05
Epoch: 8 cost time: 0.778080940246582
Epoch: 8, Steps: 262 | Train Loss: 0.4609627 Vali Loss: 0.3021225 Best vali loss: 0.2802792

best validation loss 0.2802792214779838

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0096712489936, 'e_layers': 4, 'learning_rate': 0.0007900549735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4784412
	speed: 0.0117s/iter; left time: 23.3037s
	iters: 200, epoch: 1 | loss: 0.4320449
	speed: 0.0057s/iter; left time: 10.8075s
Updating learning rate to 0.0007599852965376985
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 1.8485865592956543
Epoch: 1, Steps: 262 | Train Loss: 0.4552431 Vali Loss: 0.2848263 Best vali loss: 0.2848263
	iters: 100, epoch: 2 | loss: 0.5247732
	speed: 0.0132s/iter; left time: 22.8706s
	iters: 200, epoch: 2 | loss: 0.5251040
	speed: 0.0061s/iter; left time: 10.0257s
Updating learning rate to 0.000674354101386004
Epoch: 2 cost time: 1.6416740417480469
Epoch: 2, Steps: 262 | Train Loss: 0.5249386 Vali Loss: 0.2912613 Best vali loss: 0.2848263
	iters: 100, epoch: 3 | loss: 0.7690217
	speed: 0.0125s/iter; left time: 18.4186s
	iters: 200, epoch: 3 | loss: 0.4582410
	speed: 0.0062s/iter; left time: 8.4609s
Updating learning rate to 0.0005461979612580451
Validation loss decreased (0.2848 --> 0.2827).  Saving model state dict ...
Epoch: 3 cost time: 1.6629917621612549
Epoch: 3, Steps: 262 | Train Loss: 0.6136314 Vali Loss: 0.2826845 Best vali loss: 0.2826845

best validation loss 0.28268449900096215

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4115252
	speed: 0.0092s/iter; left time: 75.8304s
	iters: 200, epoch: 1 | loss: 0.2935918
	speed: 0.0040s/iter; left time: 32.8080s
	iters: 300, epoch: 1 | loss: 0.7039090
	speed: 0.0052s/iter; left time: 41.6306s
	iters: 400, epoch: 1 | loss: 0.3624870
	speed: 0.0052s/iter; left time: 41.0321s
	iters: 500, epoch: 1 | loss: 0.3321506
	speed: 0.0051s/iter; left time: 40.2786s
	iters: 600, epoch: 1 | loss: 0.2713432
	speed: 0.0052s/iter; left time: 39.9917s
	iters: 700, epoch: 1 | loss: 0.2268407
	speed: 0.0052s/iter; left time: 39.6161s
	iters: 800, epoch: 1 | loss: 0.1915079
	speed: 0.0052s/iter; left time: 39.3703s
	iters: 900, epoch: 1 | loss: 1.3950286
	speed: 0.0052s/iter; left time: 38.8768s
	iters: 1000, epoch: 1 | loss: 0.6714419
	speed: 0.0052s/iter; left time: 38.3267s
Updating learning rate to 0.0001606491471
Validation loss decreased (inf --> 0.2907).  Saving model state dict ...
Epoch: 1 cost time: 5.42629075050354
Epoch: 1, Steps: 1045 | Train Loss: 0.4859826 Vali Loss: 0.2906780 Best vali loss: 0.2906780
	iters: 100, epoch: 2 | loss: 0.5050956
	speed: 0.0159s/iter; left time: 114.8746s
	iters: 200, epoch: 2 | loss: 0.4448963
	speed: 0.0045s/iter; left time: 32.1697s
	iters: 300, epoch: 2 | loss: 1.3684880
	speed: 0.0052s/iter; left time: 36.5305s
	iters: 400, epoch: 2 | loss: 0.2206654
	speed: 0.0052s/iter; left time: 35.7497s
	iters: 500, epoch: 2 | loss: 0.3475917
	speed: 0.0052s/iter; left time: 35.1742s
	iters: 600, epoch: 2 | loss: 0.2891924
	speed: 0.0051s/iter; left time: 34.5849s
	iters: 700, epoch: 2 | loss: 0.2985906
	speed: 0.0052s/iter; left time: 34.2023s
	iters: 800, epoch: 2 | loss: 0.3550837
	speed: 0.0051s/iter; left time: 33.4466s
	iters: 900, epoch: 2 | loss: 0.3671905
	speed: 0.0051s/iter; left time: 32.8506s
	iters: 1000, epoch: 2 | loss: 0.3331625
	speed: 0.0051s/iter; left time: 32.0461s
Updating learning rate to 8.032457355e-05
Validation loss decreased (0.2907 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 5.301908731460571
Epoch: 2, Steps: 1045 | Train Loss: 0.4529956 Vali Loss: 0.2814796 Best vali loss: 0.2814796
	iters: 100, epoch: 3 | loss: 0.3669394
	speed: 0.0156s/iter; left time: 96.3985s
	iters: 200, epoch: 3 | loss: 0.3952629
	speed: 0.0046s/iter; left time: 27.6604s
	iters: 300, epoch: 3 | loss: 0.5455806
	speed: 0.0055s/iter; left time: 32.7476s
	iters: 400, epoch: 3 | loss: 1.6010939
	speed: 0.0052s/iter; left time: 30.3431s
	iters: 500, epoch: 3 | loss: 0.4020435
	speed: 0.0050s/iter; left time: 28.9405s
	iters: 600, epoch: 3 | loss: 0.1950179
	speed: 0.0050s/iter; left time: 28.6300s
	iters: 700, epoch: 3 | loss: 0.3373289
	speed: 0.0052s/iter; left time: 28.8653s
	iters: 800, epoch: 3 | loss: 0.1734656
	speed: 0.0052s/iter; left time: 28.2088s
	iters: 900, epoch: 3 | loss: 0.9079828
	speed: 0.0051s/iter; left time: 27.4497s
	iters: 1000, epoch: 3 | loss: 0.2108055
	speed: 0.0050s/iter; left time: 26.4254s
Updating learning rate to 4.0162286775e-05
Epoch: 3 cost time: 5.2924535274505615
Epoch: 3, Steps: 1045 | Train Loss: 0.5135521 Vali Loss: 0.2827906 Best vali loss: 0.2814796

best validation loss 0.281479586341116

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0061686788666, 'e_layers': 2, 'learning_rate': 0.0029971076006, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3975050
	speed: 0.0093s/iter; left time: 38.1474s
	iters: 200, epoch: 1 | loss: 0.6651977
	speed: 0.0039s/iter; left time: 15.4284s
	iters: 300, epoch: 1 | loss: 1.1441920
	speed: 0.0043s/iter; left time: 16.8463s
	iters: 400, epoch: 1 | loss: 0.8443964
	speed: 0.0044s/iter; left time: 16.7528s
	iters: 500, epoch: 1 | loss: 0.9083900
	speed: 0.0044s/iter; left time: 16.1165s
Updating learning rate to 0.0028830369847641763
Validation loss decreased (inf --> 0.3159).  Saving model state dict ...
Epoch: 1 cost time: 2.460437059402466
Epoch: 1, Steps: 523 | Train Loss: 0.7919362 Vali Loss: 0.3159094 Best vali loss: 0.3159094
	iters: 100, epoch: 2 | loss: 0.3521702
	speed: 0.0097s/iter; left time: 34.5556s
	iters: 200, epoch: 2 | loss: 0.4796601
	speed: 0.0043s/iter; left time: 14.9029s
	iters: 300, epoch: 2 | loss: 0.7207479
	speed: 0.0043s/iter; left time: 14.4961s
	iters: 400, epoch: 2 | loss: 0.2004258
	speed: 0.0041s/iter; left time: 13.3433s
	iters: 500, epoch: 2 | loss: 0.6795805
	speed: 0.0039s/iter; left time: 12.4111s
Updating learning rate to 0.002558191354465001
Epoch: 2 cost time: 2.208178997039795
Epoch: 2, Steps: 523 | Train Loss: 0.4865169 Vali Loss: 0.3252291 Best vali loss: 0.3159094
	iters: 100, epoch: 3 | loss: 0.5295292
	speed: 0.0090s/iter; left time: 27.2404s
	iters: 200, epoch: 3 | loss: 0.3324358
	speed: 0.0036s/iter; left time: 10.5154s
	iters: 300, epoch: 3 | loss: 0.6017327
	speed: 0.0035s/iter; left time: 10.0000s
	iters: 400, epoch: 3 | loss: 0.3622787
	speed: 0.0036s/iter; left time: 9.9744s
	iters: 500, epoch: 3 | loss: 0.7438657
	speed: 0.0044s/iter; left time: 11.6242s
Updating learning rate to 0.0020720255121825532
Epoch: 3 cost time: 2.031316041946411
Epoch: 3, Steps: 523 | Train Loss: 0.5139684 Vali Loss: 0.3225687 Best vali loss: 0.3159094

best validation loss 0.3159093654213363

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2517245
	speed: 0.0107s/iter; left time: 54.7598s
	iters: 200, epoch: 4 | loss: 0.2812743
	speed: 0.0051s/iter; left time: 25.5766s
	iters: 300, epoch: 4 | loss: 0.7105645
	speed: 0.0051s/iter; left time: 25.2243s
	iters: 400, epoch: 4 | loss: 0.3562303
	speed: 0.0050s/iter; left time: 24.3467s
	iters: 500, epoch: 4 | loss: 0.3166489
	speed: 0.0051s/iter; left time: 24.0306s
	iters: 600, epoch: 4 | loss: 0.2748376
	speed: 0.0052s/iter; left time: 23.8280s
	iters: 700, epoch: 4 | loss: 0.2158667
	speed: 0.0047s/iter; left time: 21.4523s
	iters: 800, epoch: 4 | loss: 0.1708518
	speed: 0.0044s/iter; left time: 19.5243s
	iters: 900, epoch: 4 | loss: 1.3146377
	speed: 0.0041s/iter; left time: 17.9397s
	iters: 1000, epoch: 4 | loss: 0.6889572
	speed: 0.0038s/iter; left time: 15.8753s
Updating learning rate to 2.00811433875e-05
Epoch: 4 cost time: 5.188841819763184
Epoch: 4, Steps: 1045 | Train Loss: 0.4581593 Vali Loss: 0.2854634 Best vali loss: 0.2814796
	iters: 100, epoch: 5 | loss: 0.4773491
	speed: 0.0128s/iter; left time: 52.2800s
	iters: 200, epoch: 5 | loss: 0.4261102
	speed: 0.0048s/iter; left time: 19.2378s
	iters: 300, epoch: 5 | loss: 1.3053907
	speed: 0.0049s/iter; left time: 19.0022s
	iters: 400, epoch: 5 | loss: 0.2265607
	speed: 0.0049s/iter; left time: 18.5153s
	iters: 500, epoch: 5 | loss: 0.3425635
	speed: 0.0051s/iter; left time: 18.8552s
	iters: 600, epoch: 5 | loss: 0.2857512
	speed: 0.0053s/iter; left time: 18.9626s
	iters: 700, epoch: 5 | loss: 0.3029562
	speed: 0.0056s/iter; left time: 19.6549s
	iters: 800, epoch: 5 | loss: 0.3497007
	speed: 0.0054s/iter; left time: 18.4048s
	iters: 900, epoch: 5 | loss: 0.3405361
	speed: 0.0051s/iter; left time: 16.6773s
	iters: 1000, epoch: 5 | loss: 0.3153921
	speed: 0.0044s/iter; left time: 13.9411s
Updating learning rate to 1.004057169375e-05
Epoch: 5 cost time: 5.286445617675781
Epoch: 5, Steps: 1045 | Train Loss: 0.4372311 Vali Loss: 0.2832324 Best vali loss: 0.2814796
	iters: 100, epoch: 6 | loss: 0.3743281
	speed: 0.0166s/iter; left time: 50.3784s
	iters: 200, epoch: 6 | loss: 0.4089019
	speed: 0.0063s/iter; left time: 18.5013s
	iters: 300, epoch: 6 | loss: 0.5641286
	speed: 0.0088s/iter; left time: 24.8280s
	iters: 400, epoch: 6 | loss: 1.5988661
	speed: 0.0065s/iter; left time: 17.6950s
	iters: 500, epoch: 6 | loss: 0.4089464
	speed: 0.0088s/iter; left time: 23.2050s
	iters: 600, epoch: 6 | loss: 0.1928850
	speed: 0.0069s/iter; left time: 17.4659s
	iters: 700, epoch: 6 | loss: 0.3437334
	speed: 0.0088s/iter; left time: 21.4292s
	iters: 800, epoch: 6 | loss: 0.1800802
	speed: 0.0077s/iter; left time: 17.9848s
	iters: 900, epoch: 6 | loss: 0.8911897
	speed: 0.0081s/iter; left time: 18.2015s
	iters: 1000, epoch: 6 | loss: 0.2022467
	speed: 0.0081s/iter; left time: 17.3632s
Updating learning rate to 5.020285846875e-06
Epoch: 6 cost time: 8.311995267868042
Epoch: 6, Steps: 1045 | Train Loss: 0.5165306 Vali Loss: 0.2837537 Best vali loss: 0.2814796
	iters: 100, epoch: 7 | loss: 0.9095020
	speed: 0.0274s/iter; left time: 54.4651s
	iters: 200, epoch: 7 | loss: 0.1859531
	speed: 0.0079s/iter; left time: 14.8638s
	iters: 300, epoch: 7 | loss: 1.1383170
	speed: 0.0037s/iter; left time: 6.6726s
	iters: 400, epoch: 7 | loss: 0.1736801
	speed: 0.0037s/iter; left time: 6.3165s
	iters: 500, epoch: 7 | loss: 0.3044780
	speed: 0.0053s/iter; left time: 8.3705s
	iters: 600, epoch: 7 | loss: 0.1966449
	speed: 0.0054s/iter; left time: 8.0695s
	iters: 700, epoch: 7 | loss: 0.2210371
	speed: 0.0056s/iter; left time: 7.7285s
	iters: 800, epoch: 7 | loss: 0.3294097
	speed: 0.0051s/iter; left time: 6.5329s
	iters: 900, epoch: 7 | loss: 0.4943132
	speed: 0.0059s/iter; left time: 6.9929s
	iters: 1000, epoch: 7 | loss: 0.5112523
	speed: 0.0047s/iter; left time: 5.1488s
Updating learning rate to 2.5101429234375e-06
Epoch: 7 cost time: 5.733729600906372
Epoch: 7, Steps: 1045 | Train Loss: 0.4464587 Vali Loss: 0.2837118 Best vali loss: 0.2814796
	iters: 100, epoch: 8 | loss: 0.4827117
	speed: 0.0139s/iter; left time: 13.1311s
	iters: 200, epoch: 8 | loss: 0.2419808
	speed: 0.0045s/iter; left time: 3.8047s
	iters: 300, epoch: 8 | loss: 1.0145053
	speed: 0.0047s/iter; left time: 3.4996s
	iters: 400, epoch: 8 | loss: 0.6822069
	speed: 0.0045s/iter; left time: 2.8997s
	iters: 500, epoch: 8 | loss: 0.7555823
	speed: 0.0048s/iter; left time: 2.6150s
	iters: 600, epoch: 8 | loss: 0.2138248
	speed: 0.0042s/iter; left time: 1.8552s
	iters: 700, epoch: 8 | loss: 0.3211419
	speed: 0.0040s/iter; left time: 1.3813s
	iters: 800, epoch: 8 | loss: 0.3378166
	speed: 0.0041s/iter; left time: 1.0078s
	iters: 900, epoch: 8 | loss: 0.3632925
	speed: 0.0049s/iter; left time: 0.7181s
	iters: 1000, epoch: 8 | loss: 1.9803438
	speed: 0.0049s/iter; left time: 0.2258s
Updating learning rate to 1.25507146171875e-06
Epoch: 8 cost time: 4.8397698402404785
Epoch: 8, Steps: 1045 | Train Loss: 0.6393407 Vali Loss: 0.2838094 Best vali loss: 0.2814796

best validation loss 0.281479586341116

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.00487546233, 'e_layers': 4, 'learning_rate': 0.0010291718456, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000990001324593353
Validation loss decreased (inf --> 0.2932).  Saving model state dict ...
Epoch: 1 cost time: 0.6396918296813965
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2932056 Best vali loss: 0.2932056
Updating learning rate to 0.0008784531183150171
Validation loss decreased (0.2932 --> 0.2850).  Saving model state dict ...
Epoch: 2 cost time: 0.45998120307922363
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2850336 Best vali loss: 0.2850336
Updating learning rate to 0.000711509429983861
Epoch: 3 cost time: 0.4585120677947998
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2901140 Best vali loss: 0.2850336
Updating learning rate to 0.0005145859228
Epoch: 4 cost time: 0.46837329864501953
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2912291 Best vali loss: 0.2850336
Updating learning rate to 0.0003176624156161389
Epoch: 5 cost time: 0.46457815170288086
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2890301 Best vali loss: 0.2850336
Updating learning rate to 0.00015071872728498277
Epoch: 6 cost time: 0.4687964916229248
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2885638 Best vali loss: 0.2850336
Updating learning rate to 3.917052100664691e-05
Epoch: 7 cost time: 0.43267393112182617
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2876370 Best vali loss: 0.2850336
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4617760181427002
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2886530 Best vali loss: 0.2850336

best validation loss 0.28503360367920727

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010495657123, 'e_layers': 4, 'learning_rate': 0.0016632342935, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8271694
	speed: 0.0144s/iter; left time: 13.7123s
Updating learning rate to 0.0016632342935
Validation loss decreased (inf --> 0.3277).  Saving model state dict ...
Epoch: 1 cost time: 1.267141342163086
Epoch: 1, Steps: 131 | Train Loss: 0.8271694 Vali Loss: 0.3276720 Best vali loss: 0.3276720
	iters: 100, epoch: 2 | loss: 0.7937784
	speed: 0.0150s/iter; left time: 12.3094s
Updating learning rate to 0.00083161714675
Epoch: 2 cost time: 1.3551959991455078
Epoch: 2, Steps: 131 | Train Loss: 0.7937784 Vali Loss: 0.3356193 Best vali loss: 0.3276720
	iters: 100, epoch: 3 | loss: 0.5562307
	speed: 0.0160s/iter; left time: 11.0171s
Updating learning rate to 0.000415808573375
Validation loss decreased (0.3277 --> 0.3186).  Saving model state dict ...
Epoch: 3 cost time: 1.3580365180969238
Epoch: 3, Steps: 131 | Train Loss: 0.5562307 Vali Loss: 0.3186356 Best vali loss: 0.3186356
	iters: 100, epoch: 4 | loss: 0.8564814
	speed: 0.0165s/iter; left time: 9.1834s
Updating learning rate to 0.0002079042866875
Validation loss decreased (0.3186 --> 0.3160).  Saving model state dict ...
Epoch: 4 cost time: 1.3841419219970703
Epoch: 4, Steps: 131 | Train Loss: 0.8564814 Vali Loss: 0.3160468 Best vali loss: 0.3160468
	iters: 100, epoch: 5 | loss: 0.5041163
	speed: 0.0166s/iter; left time: 7.0617s
Updating learning rate to 0.00010395214334375
Epoch: 5 cost time: 1.3620851039886475
Epoch: 5, Steps: 131 | Train Loss: 0.5041163 Vali Loss: 0.3196749 Best vali loss: 0.3160468
	iters: 100, epoch: 6 | loss: 0.4896751
	speed: 0.0161s/iter; left time: 4.7251s
Updating learning rate to 5.1976071671875e-05
Epoch: 6 cost time: 1.371168851852417
Epoch: 6, Steps: 131 | Train Loss: 0.4896751 Vali Loss: 0.3199304 Best vali loss: 0.3160468
	iters: 100, epoch: 7 | loss: 0.2952425
	speed: 0.0161s/iter; left time: 2.6220s
Updating learning rate to 2.59880358359375e-05
Epoch: 7 cost time: 1.3731632232666016
Epoch: 7, Steps: 131 | Train Loss: 0.2952425 Vali Loss: 0.3189211 Best vali loss: 0.3160468
	iters: 100, epoch: 8 | loss: 0.9158698
	speed: 0.0149s/iter; left time: 0.4762s
Updating learning rate to 1.299401791796875e-05
Epoch: 8 cost time: 1.2030608654022217
Epoch: 8, Steps: 131 | Train Loss: 0.9158698 Vali Loss: 0.3187803 Best vali loss: 0.3160468

best validation loss 0.31604683181141424

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0099997540142, 'e_layers': 1, 'learning_rate': 0.0030308631648, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5788425
	speed: 0.0091s/iter; left time: 18.1694s
	iters: 200, epoch: 1 | loss: 1.0384212
	speed: 0.0030s/iter; left time: 5.7311s
Updating learning rate to 0.0029155078043005514
Validation loss decreased (inf --> 0.2838).  Saving model state dict ...
Epoch: 1 cost time: 1.0761780738830566
Epoch: 1, Steps: 262 | Train Loss: 0.8086318 Vali Loss: 0.2838127 Best vali loss: 0.2838127
	iters: 100, epoch: 2 | loss: 0.8554702
	speed: 0.0076s/iter; left time: 13.1930s
	iters: 200, epoch: 2 | loss: 0.3301942
	speed: 0.0031s/iter; left time: 5.0879s
Updating learning rate to 0.0025870035307393
Epoch: 2 cost time: 0.8600740432739258
Epoch: 2, Steps: 262 | Train Loss: 0.5928322 Vali Loss: 0.3064395 Best vali loss: 0.2838127
	iters: 100, epoch: 3 | loss: 0.5876373
	speed: 0.0080s/iter; left time: 11.7408s
	iters: 200, epoch: 3 | loss: 0.3907645
	speed: 0.0034s/iter; left time: 4.6410s
Updating learning rate to 0.0020953621418672913
Epoch: 3 cost time: 0.9187676906585693
Epoch: 3, Steps: 262 | Train Loss: 0.4892009 Vali Loss: 0.3182754 Best vali loss: 0.2838127

best validation loss 0.28381268207403576

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026411680255, 'e_layers': 1, 'learning_rate': 0.0015330488365, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2682743
	speed: 0.0095s/iter; left time: 19.0690s
	iters: 200, epoch: 1 | loss: 0.7787771
	speed: 0.0033s/iter; left time: 6.2554s
Updating learning rate to 0.0014747006394412961
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 1.178828477859497
Epoch: 1, Steps: 262 | Train Loss: 0.5235257 Vali Loss: 0.2822530 Best vali loss: 0.2822530
	iters: 100, epoch: 2 | loss: 0.3363860
	speed: 0.0083s/iter; left time: 14.3814s
	iters: 200, epoch: 2 | loss: 0.4591668
	speed: 0.0032s/iter; left time: 5.1651s
Updating learning rate to 0.0013085390323396484
Epoch: 2 cost time: 0.8803589344024658
Epoch: 2, Steps: 262 | Train Loss: 0.3977764 Vali Loss: 0.2887735 Best vali loss: 0.2822530
	iters: 100, epoch: 3 | loss: 0.3847605
	speed: 0.0074s/iter; left time: 10.8276s
	iters: 200, epoch: 3 | loss: 0.7490980
	speed: 0.0027s/iter; left time: 3.7560s
Updating learning rate to 0.0010598606136175638
Epoch: 3 cost time: 0.7655785083770752
Epoch: 3, Steps: 262 | Train Loss: 0.5669292 Vali Loss: 0.2879607 Best vali loss: 0.2822530

best validation loss 0.28225304600296075

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0074460408096, 'e_layers': 2, 'learning_rate': 0.0027349231343, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4318155
	speed: 0.0107s/iter; left time: 21.4215s
	iters: 200, epoch: 1 | loss: 0.4304606
	speed: 0.0044s/iter; left time: 8.2819s
Updating learning rate to 0.0027349231343
Validation loss decreased (inf --> 0.3034).  Saving model state dict ...
Epoch: 1 cost time: 1.4653222560882568
Epoch: 1, Steps: 262 | Train Loss: 0.4311381 Vali Loss: 0.3034100 Best vali loss: 0.3034100
	iters: 100, epoch: 2 | loss: 0.4055443
	speed: 0.0102s/iter; left time: 17.6374s
	iters: 200, epoch: 2 | loss: 0.6133540
	speed: 0.0045s/iter; left time: 7.3007s
Updating learning rate to 0.00136746156715
Validation loss decreased (0.3034 --> 0.2920).  Saving model state dict ...
Epoch: 2 cost time: 1.1987242698669434
Epoch: 2, Steps: 262 | Train Loss: 0.5094491 Vali Loss: 0.2920456 Best vali loss: 0.2920456
	iters: 100, epoch: 3 | loss: 0.2995030
	speed: 0.0104s/iter; left time: 15.2532s
	iters: 200, epoch: 3 | loss: 0.6922441
	speed: 0.0045s/iter; left time: 6.2267s
Updating learning rate to 0.000683730783575
Validation loss decreased (0.2920 --> 0.2899).  Saving model state dict ...
Epoch: 3 cost time: 1.2215566635131836
Epoch: 3, Steps: 262 | Train Loss: 0.4958735 Vali Loss: 0.2899206 Best vali loss: 0.2899206

best validation loss 0.28992060915206436

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026411680255, 'e_layers': 1, 'learning_rate': 0.0015330488365, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2703618
	speed: 0.0092s/iter; left time: 11.1052s
	iters: 200, epoch: 4 | loss: 0.7107145
	speed: 0.0028s/iter; left time: 3.1161s
Updating learning rate to 0.00076652441825
Epoch: 4 cost time: 1.0378410816192627
Epoch: 4, Steps: 262 | Train Loss: 0.4905382 Vali Loss: 0.2932875 Best vali loss: 0.2822530
	iters: 100, epoch: 5 | loss: 0.3456062
	speed: 0.0078s/iter; left time: 7.4279s
	iters: 200, epoch: 5 | loss: 0.4333160
	speed: 0.0031s/iter; left time: 2.6123s
Updating learning rate to 0.0004731882228824364
Epoch: 5 cost time: 0.8632237911224365
Epoch: 5, Steps: 262 | Train Loss: 0.3894611 Vali Loss: 0.2976111 Best vali loss: 0.2822530
	iters: 100, epoch: 6 | loss: 0.3799841
	speed: 0.0076s/iter; left time: 5.2398s
	iters: 200, epoch: 6 | loss: 0.6503246
	speed: 0.0030s/iter; left time: 1.7796s
Updating learning rate to 0.00022450980416035169
Epoch: 6 cost time: 0.8368797302246094
Epoch: 6, Steps: 262 | Train Loss: 0.5151544 Vali Loss: 0.2943339 Best vali loss: 0.2822530
	iters: 100, epoch: 7 | loss: 0.2963534
	speed: 0.0083s/iter; left time: 3.5209s
	iters: 200, epoch: 7 | loss: 0.3446701
	speed: 0.0032s/iter; left time: 1.0560s
Updating learning rate to 5.8348197058703974e-05
Epoch: 7 cost time: 0.9258804321289062
Epoch: 7, Steps: 262 | Train Loss: 0.3205118 Vali Loss: 0.3037497 Best vali loss: 0.2822530
	iters: 100, epoch: 8 | loss: 0.7721549
	speed: 0.0083s/iter; left time: 1.3554s
	iters: 200, epoch: 8 | loss: 0.7375949
	speed: 0.0033s/iter; left time: 0.2054s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9159903526306152
Epoch: 8, Steps: 262 | Train Loss: 0.7548749 Vali Loss: 0.3000124 Best vali loss: 0.2822530

best validation loss 0.28225304600296075

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011667363616, 'e_layers': 4, 'learning_rate': 0.0008608226971, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4204379
	speed: 0.0132s/iter; left time: 108.7783s
	iters: 200, epoch: 1 | loss: 1.6165038
	speed: 0.0064s/iter; left time: 51.9322s
	iters: 300, epoch: 1 | loss: 0.5759127
	speed: 0.0063s/iter; left time: 50.7148s
	iters: 400, epoch: 1 | loss: 0.5196199
	speed: 0.0071s/iter; left time: 56.2988s
	iters: 500, epoch: 1 | loss: 0.9733795
	speed: 0.0071s/iter; left time: 55.9677s
	iters: 600, epoch: 1 | loss: 0.1922206
	speed: 0.0072s/iter; left time: 55.5036s
	iters: 700, epoch: 1 | loss: 0.2489069
	speed: 0.0072s/iter; left time: 55.1408s
	iters: 800, epoch: 1 | loss: 0.2785779
	speed: 0.0071s/iter; left time: 53.3639s
	iters: 900, epoch: 1 | loss: 0.9824701
	speed: 0.0071s/iter; left time: 52.6153s
	iters: 1000, epoch: 1 | loss: 1.6472510
	speed: 0.0070s/iter; left time: 51.8791s
Updating learning rate to 0.0008280595840359265
Validation loss decreased (inf --> 0.3261).  Saving model state dict ...
Epoch: 1 cost time: 7.548940896987915
Epoch: 1, Steps: 1045 | Train Loss: 0.8455280 Vali Loss: 0.3261443 Best vali loss: 0.3261443
	iters: 100, epoch: 2 | loss: 0.3278727
	speed: 0.0225s/iter; left time: 162.2923s
	iters: 200, epoch: 2 | loss: 1.5277015
	speed: 0.0061s/iter; left time: 43.0703s
	iters: 300, epoch: 2 | loss: 0.1193230
	speed: 0.0059s/iter; left time: 41.5447s
	iters: 400, epoch: 2 | loss: 0.5819217
	speed: 0.0069s/iter; left time: 47.7432s
	iters: 500, epoch: 2 | loss: 0.7799608
	speed: 0.0070s/iter; left time: 47.9575s
	iters: 600, epoch: 2 | loss: 0.5295278
	speed: 0.0070s/iter; left time: 47.0309s
	iters: 700, epoch: 2 | loss: 1.6241243
	speed: 0.0071s/iter; left time: 46.7914s
	iters: 800, epoch: 2 | loss: 0.3120669
	speed: 0.0071s/iter; left time: 46.2359s
	iters: 900, epoch: 2 | loss: 0.3505582
	speed: 0.0071s/iter; left time: 45.3411s
	iters: 1000, epoch: 2 | loss: 0.5951850
	speed: 0.0071s/iter; left time: 44.5517s
Updating learning rate to 0.0007347581318093517
Validation loss decreased (0.3261 --> 0.3202).  Saving model state dict ...
Epoch: 2 cost time: 7.210738182067871
Epoch: 2, Steps: 1045 | Train Loss: 0.6748242 Vali Loss: 0.3202285 Best vali loss: 0.3202285
	iters: 100, epoch: 3 | loss: 0.2560129
	speed: 0.0228s/iter; left time: 140.9412s
	iters: 200, epoch: 3 | loss: 0.4139653
	speed: 0.0065s/iter; left time: 39.2291s
	iters: 300, epoch: 3 | loss: 1.4191800
	speed: 0.0064s/iter; left time: 37.9975s
	iters: 400, epoch: 3 | loss: 0.1820090
	speed: 0.0066s/iter; left time: 38.9440s
	iters: 500, epoch: 3 | loss: 0.5431535
	speed: 0.0071s/iter; left time: 41.1627s
	iters: 600, epoch: 3 | loss: 0.7404364
	speed: 0.0071s/iter; left time: 40.5023s
	iters: 700, epoch: 3 | loss: 1.0412550
	speed: 0.0071s/iter; left time: 39.3753s
	iters: 800, epoch: 3 | loss: 0.3147919
	speed: 0.0071s/iter; left time: 38.7756s
	iters: 900, epoch: 3 | loss: 0.3147345
	speed: 0.0071s/iter; left time: 38.0086s
	iters: 1000, epoch: 3 | loss: 0.2654954
	speed: 0.0071s/iter; left time: 37.2095s
Updating learning rate to 0.000595122640742001
Epoch: 3 cost time: 7.30433201789856
Epoch: 3, Steps: 1045 | Train Loss: 0.5491034 Vali Loss: 0.3240722 Best vali loss: 0.3202285
	iters: 100, epoch: 4 | loss: 0.5212395
	speed: 0.0218s/iter; left time: 111.9629s
	iters: 200, epoch: 4 | loss: 0.7476990
	speed: 0.0066s/iter; left time: 33.0601s
	iters: 300, epoch: 4 | loss: 0.3047818
	speed: 0.0064s/iter; left time: 31.5956s
	iters: 400, epoch: 4 | loss: 0.1917936
	speed: 0.0050s/iter; left time: 24.3158s
	iters: 500, epoch: 4 | loss: 0.1875219
	speed: 0.0058s/iter; left time: 27.2403s
	iters: 600, epoch: 4 | loss: 0.5259364
	speed: 0.0061s/iter; left time: 28.3658s
	iters: 700, epoch: 4 | loss: 0.3455337
	speed: 0.0062s/iter; left time: 28.1772s
	iters: 800, epoch: 4 | loss: 0.4025966
	speed: 0.0059s/iter; left time: 26.2983s
	iters: 900, epoch: 4 | loss: 0.2697670
	speed: 0.0064s/iter; left time: 27.6319s
	iters: 1000, epoch: 4 | loss: 0.2734786
	speed: 0.0060s/iter; left time: 25.3866s
Updating learning rate to 0.00043041134855
Epoch: 4 cost time: 6.4982123374938965
Epoch: 4, Steps: 1045 | Train Loss: 0.3770348 Vali Loss: 0.3229589 Best vali loss: 0.3202285
	iters: 100, epoch: 5 | loss: 1.2585214
	speed: 0.0181s/iter; left time: 74.0254s
	iters: 200, epoch: 5 | loss: 1.0866702
	speed: 0.0064s/iter; left time: 25.4822s
	iters: 300, epoch: 5 | loss: 1.1941332
	speed: 0.0059s/iter; left time: 22.8743s
	iters: 400, epoch: 5 | loss: 0.1413849
	speed: 0.0063s/iter; left time: 23.8116s
	iters: 500, epoch: 5 | loss: 0.9963560
	speed: 0.0057s/iter; left time: 21.0260s
	iters: 600, epoch: 5 | loss: 1.1877832
	speed: 0.0061s/iter; left time: 21.7725s
	iters: 700, epoch: 5 | loss: 1.0239289
	speed: 0.0051s/iter; left time: 17.7782s
	iters: 800, epoch: 5 | loss: 2.1777761
	speed: 0.0049s/iter; left time: 16.5523s
	iters: 900, epoch: 5 | loss: 0.4211812
	speed: 0.0047s/iter; left time: 15.4309s
	iters: 1000, epoch: 5 | loss: 0.2221407
	speed: 0.0059s/iter; left time: 18.8767s
Updating learning rate to 0.000265700056357999
Epoch: 5 cost time: 6.048021078109741
Epoch: 5, Steps: 1045 | Train Loss: 0.9709876 Vali Loss: 0.3215678 Best vali loss: 0.3202285
	iters: 100, epoch: 6 | loss: 1.1432196
	speed: 0.0187s/iter; left time: 56.8253s
	iters: 200, epoch: 6 | loss: 0.2906976
	speed: 0.0055s/iter; left time: 16.1588s
	iters: 300, epoch: 6 | loss: 1.0720012
	speed: 0.0049s/iter; left time: 13.8769s
	iters: 400, epoch: 6 | loss: 0.2148914
	speed: 0.0061s/iter; left time: 16.6765s
	iters: 500, epoch: 6 | loss: 0.8660390
	speed: 0.0064s/iter; left time: 16.8191s
	iters: 600, epoch: 6 | loss: 0.3752486
	speed: 0.0060s/iter; left time: 15.1505s
	iters: 700, epoch: 6 | loss: 0.8600082
	speed: 0.0048s/iter; left time: 11.6253s
	iters: 800, epoch: 6 | loss: 0.3551264
	speed: 0.0049s/iter; left time: 11.4745s
	iters: 900, epoch: 6 | loss: 0.5205198
	speed: 0.0063s/iter; left time: 14.1621s
	iters: 1000, epoch: 6 | loss: 0.8398824
	speed: 0.0064s/iter; left time: 13.7202s
Updating learning rate to 0.00012606456529064833
Epoch: 6 cost time: 6.134674072265625
Epoch: 6, Steps: 1045 | Train Loss: 0.6537634 Vali Loss: 0.3219398 Best vali loss: 0.3202285
	iters: 100, epoch: 7 | loss: 0.3434933
	speed: 0.0168s/iter; left time: 33.3782s
	iters: 200, epoch: 7 | loss: 0.8879086
	speed: 0.0063s/iter; left time: 11.9931s
	iters: 300, epoch: 7 | loss: 1.0890571
	speed: 0.0064s/iter; left time: 11.3758s
	iters: 400, epoch: 7 | loss: 0.1992417
	speed: 0.0062s/iter; left time: 10.4548s
	iters: 500, epoch: 7 | loss: 1.2873645
	speed: 0.0062s/iter; left time: 9.9384s
	iters: 600, epoch: 7 | loss: 0.2583036
	speed: 0.0060s/iter; left time: 8.9559s
	iters: 700, epoch: 7 | loss: 0.8403650
	speed: 0.0052s/iter; left time: 7.2333s
	iters: 800, epoch: 7 | loss: 1.1174086
	speed: 0.0044s/iter; left time: 5.7183s
	iters: 900, epoch: 7 | loss: 0.3288665
	speed: 0.0063s/iter; left time: 7.5187s
	iters: 1000, epoch: 7 | loss: 0.2424037
	speed: 0.0069s/iter; left time: 7.5632s
Updating learning rate to 3.276311306407351e-05
Epoch: 7 cost time: 6.355552434921265
Epoch: 7, Steps: 1045 | Train Loss: 0.6594413 Vali Loss: 0.3222806 Best vali loss: 0.3202285
	iters: 100, epoch: 8 | loss: 0.4273354
	speed: 0.0221s/iter; left time: 20.8844s
	iters: 200, epoch: 8 | loss: 0.6495730
	speed: 0.0069s/iter; left time: 5.8625s
	iters: 300, epoch: 8 | loss: 0.2810981
	speed: 0.0069s/iter; left time: 5.1185s
	iters: 400, epoch: 8 | loss: 0.3265213
	speed: 0.0070s/iter; left time: 4.5015s
	iters: 500, epoch: 8 | loss: 0.3727365
	speed: 0.0047s/iter; left time: 2.5870s
	iters: 600, epoch: 8 | loss: 1.0907019
	speed: 0.0048s/iter; left time: 2.1190s
	iters: 700, epoch: 8 | loss: 1.3228214
	speed: 0.0065s/iter; left time: 2.2531s
	iters: 800, epoch: 8 | loss: 0.2166146
	speed: 0.0065s/iter; left time: 1.6047s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009946628485, 'e_layers': 1, 'learning_rate': 0.0001665995443, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4812997
	speed: 0.0092s/iter; left time: 18.4502s
	iters: 200, epoch: 1 | loss: 0.9337897
	speed: 0.0028s/iter; left time: 5.3444s
Updating learning rate to 0.0001665995443
Validation loss decreased (inf --> 0.3120).  Saving model state dict ...
Epoch: 1 cost time: 1.0556540489196777
Epoch: 1, Steps: 262 | Train Loss: 0.7075447 Vali Loss: 0.3119810 Best vali loss: 0.3119810
	iters: 100, epoch: 2 | loss: 0.4000425
	speed: 0.0071s/iter; left time: 12.3669s
	iters: 200, epoch: 2 | loss: 0.4845377
	speed: 0.0026s/iter; left time: 4.1868s
Updating learning rate to 8.329977215e-05
Validation loss decreased (0.3120 --> 0.2955).  Saving model state dict ...
Epoch: 2 cost time: 0.736668586730957
Epoch: 2, Steps: 262 | Train Loss: 0.4422901 Vali Loss: 0.2954836 Best vali loss: 0.2954836
	iters: 100, epoch: 3 | loss: 0.6447967
	speed: 0.0072s/iter; left time: 10.6531s
	iters: 200, epoch: 3 | loss: 0.4274731
	speed: 0.0028s/iter; left time: 3.7825s
Updating learning rate to 4.1649886075e-05
Validation loss decreased (0.2955 --> 0.2906).  Saving model state dict ...
Epoch: 3 cost time: 0.7865571975708008
Epoch: 3, Steps: 262 | Train Loss: 0.5361349 Vali Loss: 0.2905731 Best vali loss: 0.2905731
	iters: 100, epoch: 4 | loss: 0.4154877
	speed: 0.0070s/iter; left time: 8.4868s
	iters: 200, epoch: 4 | loss: 0.7075770
	speed: 0.0026s/iter; left time: 2.8788s
Updating learning rate to 2.08249430375e-05
Validation loss decreased (0.2906 --> 0.2886).  Saving model state dict ...
Epoch: 4 cost time: 0.7514803409576416
Epoch: 4, Steps: 262 | Train Loss: 0.5615324 Vali Loss: 0.2886121 Best vali loss: 0.2886121
	iters: 100, epoch: 5 | loss: 0.5005131
	speed: 0.0072s/iter; left time: 6.8499s
	iters: 200, epoch: 5 | loss: 0.3087515
	speed: 0.0028s/iter; left time: 2.3354s
Updating learning rate to 1.041247151875e-05
Validation loss decreased (0.2886 --> 0.2878).  Saving model state dict ...
Epoch: 5 cost time: 0.7898566722869873
Epoch: 5, Steps: 262 | Train Loss: 0.4046323 Vali Loss: 0.2877700 Best vali loss: 0.2877700
	iters: 100, epoch: 6 | loss: 0.6757103
	speed: 0.0070s/iter; left time: 4.8135s
	iters: 200, epoch: 6 | loss: 0.7936056
	speed: 0.0027s/iter; left time: 1.6008s
Updating learning rate to 5.206235759375e-06
Validation loss decreased (0.2878 --> 0.2874).  Saving model state dict ...
Epoch: 6 cost time: 0.7690708637237549
Epoch: 6, Steps: 262 | Train Loss: 0.7346580 Vali Loss: 0.2873786 Best vali loss: 0.2873786
	iters: 100, epoch: 7 | loss: 0.6432685
	speed: 0.0072s/iter; left time: 3.0466s
	iters: 200, epoch: 7 | loss: 0.2313265
	speed: 0.0026s/iter; left time: 0.8427s
Updating learning rate to 2.6031178796875e-06
Validation loss decreased (0.2874 --> 0.2872).  Saving model state dict ...
Epoch: 7 cost time: 0.74556565284729
Epoch: 7, Steps: 262 | Train Loss: 0.4372975 Vali Loss: 0.2871996 Best vali loss: 0.2871996
	iters: 100, epoch: 8 | loss: 0.4078097
	speed: 0.0073s/iter; left time: 1.1956s
	iters: 200, epoch: 8 | loss: 0.4756518
	speed: 0.0028s/iter; left time: 0.1733s
Updating learning rate to 1.30155893984375e-06
Validation loss decreased (0.2872 --> 0.2871).  Saving model state dict ...
Epoch: 8 cost time: 0.7773008346557617
Epoch: 8, Steps: 262 | Train Loss: 0.4417307 Vali Loss: 0.2871160 Best vali loss: 0.2871160

best validation loss 0.287115951482582

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0014121922571, 'e_layers': 2, 'learning_rate': 0.0005012943918, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5316261
	speed: 0.0105s/iter; left time: 9.9875s
Updating learning rate to 0.0004822150100733569
Validation loss decreased (inf --> 0.2925).  Saving model state dict ...
Epoch: 1 cost time: 0.9003241062164307
Epoch: 1, Steps: 131 | Train Loss: 0.5316261 Vali Loss: 0.2925091 Best vali loss: 0.2925091
	iters: 100, epoch: 2 | loss: 0.5395475
	speed: 0.0086s/iter; left time: 7.0124s
Updating learning rate to 0.000427881527806283
Validation loss decreased (0.2925 --> 0.2851).  Saving model state dict ...
Epoch: 2 cost time: 0.6821849346160889
Epoch: 2, Steps: 131 | Train Loss: 0.5395475 Vali Loss: 0.2850891 Best vali loss: 0.2850891
	iters: 100, epoch: 3 | loss: 0.8092641
	speed: 0.0081s/iter; left time: 5.5566s
Updating learning rate to 0.00034656572513969705
Validation loss decreased (0.2851 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 0.6374821662902832
Epoch: 3, Steps: 131 | Train Loss: 0.8092641 Vali Loss: 0.2838782 Best vali loss: 0.2838782

best validation loss 0.2838782390926619

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0061589744518, 'e_layers': 1, 'learning_rate': 0.003977029424, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4763161
	speed: 0.0090s/iter; left time: 8.5260s
Updating learning rate to 0.003977029424
Validation loss decreased (inf --> 0.2866).  Saving model state dict ...
Epoch: 1 cost time: 0.7227399349212646
Epoch: 1, Steps: 131 | Train Loss: 0.4763161 Vali Loss: 0.2865668 Best vali loss: 0.2865668
	iters: 100, epoch: 2 | loss: 0.7513587
	speed: 0.0065s/iter; left time: 5.3172s
Updating learning rate to 0.001988514712
Epoch: 2 cost time: 0.48454952239990234
Epoch: 2, Steps: 131 | Train Loss: 0.7513587 Vali Loss: 0.2945671 Best vali loss: 0.2865668
	iters: 100, epoch: 3 | loss: 0.5780435
	speed: 0.0063s/iter; left time: 4.3586s
Updating learning rate to 0.000994257356
Epoch: 3 cost time: 0.47261691093444824
Epoch: 3, Steps: 131 | Train Loss: 0.5780435 Vali Loss: 0.3080456 Best vali loss: 0.2865668

best validation loss 0.2865668249622336

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022668094658243945
Validation loss decreased (inf --> 0.2840).  Saving model state dict ...
Epoch: 1 cost time: 0.7028899192810059
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2839541 Best vali loss: 0.2839541
Updating learning rate to 0.0020113971511072134
Epoch: 2 cost time: 0.4455735683441162
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2857713 Best vali loss: 0.2839541
Updating learning rate to 0.0016291456090457483
Epoch: 3 cost time: 0.440479040145874
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2945118 Best vali loss: 0.2839541

best validation loss 0.28395405915999067

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0014121922571, 'e_layers': 2, 'learning_rate': 0.0005012943918, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4822806
	speed: 0.0101s/iter; left time: 5.6089s
Updating learning rate to 0.0002506471959
Epoch: 4 cost time: 0.8688185214996338
Epoch: 4, Steps: 131 | Train Loss: 0.4822806 Vali Loss: 0.2845276 Best vali loss: 0.2838782
	iters: 100, epoch: 5 | loss: 0.4998416
	speed: 0.0075s/iter; left time: 3.2068s
Updating learning rate to 0.00015472866666030294
Epoch: 5 cost time: 0.5908260345458984
Epoch: 5, Steps: 131 | Train Loss: 0.4998416 Vali Loss: 0.2874076 Best vali loss: 0.2838782
	iters: 100, epoch: 6 | loss: 0.7552894
	speed: 0.0076s/iter; left time: 2.2409s
Updating learning rate to 7.3412863993717e-05
Epoch: 6 cost time: 0.6195988655090332
Epoch: 6, Steps: 131 | Train Loss: 0.7552894 Vali Loss: 0.2866800 Best vali loss: 0.2838782
	iters: 100, epoch: 7 | loss: 0.5424226
	speed: 0.0077s/iter; left time: 1.2626s
Updating learning rate to 1.9079381726643094e-05
Epoch: 7 cost time: 0.6247744560241699
Epoch: 7, Steps: 131 | Train Loss: 0.5424226 Vali Loss: 0.2866192 Best vali loss: 0.2838782
	iters: 100, epoch: 8 | loss: 0.5116939
	speed: 0.0070s/iter; left time: 0.2251s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5561549663543701
Epoch: 8, Steps: 131 | Train Loss: 0.5116939 Vali Loss: 0.2868976 Best vali loss: 0.2838782

best validation loss 0.2838782390926619

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0021061195851, 'e_layers': 4, 'learning_rate': 0.003460388698, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003460388698
Validation loss decreased (inf --> 0.2933).  Saving model state dict ...
Epoch: 1 cost time: 0.8942975997924805
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2932511 Best vali loss: 0.2932511
Updating learning rate to 0.001730194349
Epoch: 2 cost time: 0.6177318096160889
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2941735 Best vali loss: 0.2932511
Updating learning rate to 0.0008650971745
Validation loss decreased (0.2933 --> 0.2918).  Saving model state dict ...
Epoch: 3 cost time: 0.6055424213409424
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2917968 Best vali loss: 0.2917968
Updating learning rate to 0.00043254858725
Epoch: 4 cost time: 0.5806810855865479
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2973070 Best vali loss: 0.2917968
Updating learning rate to 0.000216274293625
Epoch: 5 cost time: 0.47919726371765137
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2956498 Best vali loss: 0.2917968
Updating learning rate to 0.0001081371468125
Epoch: 6 cost time: 0.49276065826416016
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2958113 Best vali loss: 0.2917968
Updating learning rate to 5.406857340625e-05
Epoch: 7 cost time: 0.5932321548461914
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2946155 Best vali loss: 0.2917968
Updating learning rate to 2.7034286703125e-05
Epoch: 8 cost time: 0.6037375926971436
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2973492 Best vali loss: 0.2917968

best validation loss 0.2917967563603792

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3740085
	speed: 0.0106s/iter; left time: 43.3643s
	iters: 200, epoch: 1 | loss: 0.8936639
	speed: 0.0040s/iter; left time: 16.0751s
	iters: 300, epoch: 1 | loss: 0.5131343
	speed: 0.0036s/iter; left time: 14.0486s
	iters: 400, epoch: 1 | loss: 0.5498143
	speed: 0.0042s/iter; left time: 15.7710s
	iters: 500, epoch: 1 | loss: 0.4109430
	speed: 0.0049s/iter; left time: 18.1141s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.3084).  Saving model state dict ...
Epoch: 1 cost time: 2.598220109939575
Epoch: 1, Steps: 523 | Train Loss: 0.7483128 Vali Loss: 0.3084096 Best vali loss: 0.3084096
	iters: 100, epoch: 2 | loss: 0.4713037
	speed: 0.0109s/iter; left time: 38.6809s
	iters: 200, epoch: 2 | loss: 0.5659193
	speed: 0.0050s/iter; left time: 17.3351s
	iters: 300, epoch: 2 | loss: 0.3416826
	speed: 0.0051s/iter; left time: 17.0427s
	iters: 400, epoch: 2 | loss: 0.9319513
	speed: 0.0049s/iter; left time: 15.8800s
	iters: 500, epoch: 2 | loss: 1.0042411
	speed: 0.0053s/iter; left time: 16.8599s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 2.66139554977417
Epoch: 2, Steps: 523 | Train Loss: 0.6630196 Vali Loss: 0.3112443 Best vali loss: 0.3084096
	iters: 100, epoch: 3 | loss: 0.3411559
	speed: 0.0104s/iter; left time: 31.6024s
	iters: 200, epoch: 3 | loss: 0.8895549
	speed: 0.0039s/iter; left time: 11.5519s
	iters: 300, epoch: 3 | loss: 0.4169866
	speed: 0.0044s/iter; left time: 12.4991s
	iters: 400, epoch: 3 | loss: 0.7725964
	speed: 0.0058s/iter; left time: 15.9337s
	iters: 500, epoch: 3 | loss: 1.3213465
	speed: 0.0052s/iter; left time: 13.6485s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 2.552243709564209
Epoch: 3, Steps: 523 | Train Loss: 0.7483281 Vali Loss: 0.3215611 Best vali loss: 0.3084096
	iters: 100, epoch: 4 | loss: 0.5074319
	speed: 0.0116s/iter; left time: 29.0895s
	iters: 200, epoch: 4 | loss: 0.8521131
	speed: 0.0056s/iter; left time: 13.4425s
	iters: 300, epoch: 4 | loss: 0.4078037
	speed: 0.0054s/iter; left time: 12.4481s
	iters: 400, epoch: 4 | loss: 1.0929815
	speed: 0.0053s/iter; left time: 11.6738s
	iters: 500, epoch: 4 | loss: 0.4420773
	speed: 0.0055s/iter; left time: 11.6988s
Updating learning rate to 0.00109417918315
Epoch: 4 cost time: 2.870314121246338
Epoch: 4, Steps: 523 | Train Loss: 0.6604815 Vali Loss: 0.3216961 Best vali loss: 0.3084096
	iters: 100, epoch: 5 | loss: 1.1794922
	speed: 0.0095s/iter; left time: 18.9440s
	iters: 200, epoch: 5 | loss: 0.3416355
	speed: 0.0038s/iter; left time: 7.2311s
	iters: 300, epoch: 5 | loss: 0.3620981
	speed: 0.0038s/iter; left time: 6.9009s
	iters: 400, epoch: 5 | loss: 0.7515984
	speed: 0.0041s/iter; left time: 6.9921s
	iters: 500, epoch: 5 | loss: 0.3738469
	speed: 0.0058s/iter; left time: 9.2123s
Updating learning rate to 0.0006754549377197279
Epoch: 5 cost time: 2.323871612548828
Epoch: 5, Steps: 523 | Train Loss: 0.6017342 Vali Loss: 0.3217486 Best vali loss: 0.3084096
	iters: 100, epoch: 6 | loss: 0.3076824
	speed: 0.0133s/iter; left time: 19.5462s
	iters: 200, epoch: 6 | loss: 0.4150350
	speed: 0.0059s/iter; left time: 8.0576s
	iters: 300, epoch: 6 | loss: 0.4049965
	speed: 0.0059s/iter; left time: 7.4483s
	iters: 400, epoch: 6 | loss: 0.4944132
	speed: 0.0059s/iter; left time: 6.9016s
	iters: 500, epoch: 6 | loss: 0.4144086
	speed: 0.0059s/iter; left time: 6.3393s
Updating learning rate to 0.0003204776629114777
Epoch: 6 cost time: 3.101790428161621
Epoch: 6, Steps: 523 | Train Loss: 0.4073071 Vali Loss: 0.3211415 Best vali loss: 0.3084096
	iters: 100, epoch: 7 | loss: 0.5989844
	speed: 0.0109s/iter; left time: 10.2909s
	iters: 200, epoch: 7 | loss: 0.4714168
	speed: 0.0060s/iter; left time: 5.1092s
	iters: 300, epoch: 7 | loss: 0.4680886
	speed: 0.0060s/iter; left time: 4.4555s
	iters: 400, epoch: 7 | loss: 0.9700254
	speed: 0.0059s/iter; left time: 3.8294s
	iters: 500, epoch: 7 | loss: 0.3280134
	speed: 0.0059s/iter; left time: 3.2273s
Updating learning rate to 8.32894309377964e-05
Epoch: 7 cost time: 3.0851879119873047
Epoch: 7, Steps: 523 | Train Loss: 0.5673057 Vali Loss: 0.3223555 Best vali loss: 0.3084096
	iters: 100, epoch: 8 | loss: 1.8657198
	speed: 0.0135s/iter; left time: 5.7203s
	iters: 200, epoch: 8 | loss: 0.3019435
	speed: 0.0053s/iter; left time: 1.7100s
	iters: 300, epoch: 8 | loss: 0.4486599
	speed: 0.0051s/iter; left time: 1.1348s
	iters: 400, epoch: 8 | loss: 0.2299952
	speed: 0.0056s/iter; left time: 0.6924s
	iters: 500, epoch: 8 | loss: 0.4714628
	speed: 0.0058s/iter; left time: 0.1385s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.9391045570373535
Epoch: 8, Steps: 523 | Train Loss: 0.6635562 Vali Loss: 0.3222965 Best vali loss: 0.3084096

best validation loss 0.30840963522002085

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0008377038747, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5169185
	speed: 0.0129s/iter; left time: 12.2043s
Updating learning rate to 0.0002742177349779177
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 1.2356092929840088
Epoch: 1, Steps: 131 | Train Loss: 0.5169185 Vali Loss: 0.2878796 Best vali loss: 0.2878796
	iters: 100, epoch: 2 | loss: 0.6548113
	speed: 0.0113s/iter; left time: 9.2336s
Updating learning rate to 0.00024332030513956964
Validation loss decreased (0.2879 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 0.9128725528717041
Epoch: 2, Steps: 131 | Train Loss: 0.6548113 Vali Loss: 0.2829788 Best vali loss: 0.2829788
	iters: 100, epoch: 3 | loss: 0.5737156
	speed: 0.0110s/iter; left time: 7.5331s
Updating learning rate to 0.00019707903359194527
Epoch: 3 cost time: 0.9487509727478027
Epoch: 3, Steps: 131 | Train Loss: 0.5737156 Vali Loss: 0.2854779 Best vali loss: 0.2829788

best validation loss 0.2829788368833956

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0028867448881, 'e_layers': 4, 'learning_rate': 0.0003383725477, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4427280
	speed: 0.0127s/iter; left time: 12.0677s
Updating learning rate to 0.0003383725477
Validation loss decreased (inf --> 0.2871).  Saving model state dict ...
Epoch: 1 cost time: 1.2311365604400635
Epoch: 1, Steps: 131 | Train Loss: 0.4427280 Vali Loss: 0.2871401 Best vali loss: 0.2871401
	iters: 100, epoch: 2 | loss: 0.3427493
	speed: 0.0117s/iter; left time: 9.5339s
Updating learning rate to 0.00016918627385
Validation loss decreased (0.2871 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 0.9683969020843506
Epoch: 2, Steps: 131 | Train Loss: 0.3427493 Vali Loss: 0.2835761 Best vali loss: 0.2835761
	iters: 100, epoch: 3 | loss: 0.5107854
	speed: 0.0111s/iter; left time: 7.6009s
Updating learning rate to 8.4593136925e-05
Validation loss decreased (0.2836 --> 0.2821).  Saving model state dict ...
Epoch: 3 cost time: 0.8864662647247314
Epoch: 3, Steps: 131 | Train Loss: 0.5107854 Vali Loss: 0.2820969 Best vali loss: 0.2820969

best validation loss 0.2820968977599926

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0109034907503, 'e_layers': 3, 'learning_rate': 0.0007693898904, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6679604
	speed: 0.0112s/iter; left time: 22.4520s
	iters: 200, epoch: 1 | loss: 0.5255135
	speed: 0.0059s/iter; left time: 11.2199s
Updating learning rate to 0.0007401067313308311
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 1.8098158836364746
Epoch: 1, Steps: 262 | Train Loss: 0.5967369 Vali Loss: 0.2856195 Best vali loss: 0.2856195
	iters: 100, epoch: 2 | loss: 0.5801384
	speed: 0.0123s/iter; left time: 21.4243s
	iters: 200, epoch: 2 | loss: 0.5547269
	speed: 0.0054s/iter; left time: 8.8878s
Updating learning rate to 0.0006567153496391073
Validation loss decreased (0.2856 --> 0.2842).  Saving model state dict ...
Epoch: 2 cost time: 1.4651739597320557
Epoch: 2, Steps: 262 | Train Loss: 0.5674327 Vali Loss: 0.2842162 Best vali loss: 0.2842162
	iters: 100, epoch: 3 | loss: 0.3473988
	speed: 0.0108s/iter; left time: 15.8608s
	iters: 200, epoch: 3 | loss: 0.3620107
	speed: 0.0055s/iter; left time: 7.5749s
Updating learning rate to 0.0005319113272426361
Epoch: 3 cost time: 1.41188383102417
Epoch: 3, Steps: 262 | Train Loss: 0.3547048 Vali Loss: 0.2844881 Best vali loss: 0.2842162

best validation loss 0.28421619620940286

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0028867448881, 'e_layers': 4, 'learning_rate': 0.0003383725477, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4099264
	speed: 0.0132s/iter; left time: 7.3610s
Updating learning rate to 4.22965684625e-05
Validation loss decreased (0.2821 --> 0.2816).  Saving model state dict ...
Epoch: 4 cost time: 1.2096688747406006
Epoch: 4, Steps: 131 | Train Loss: 0.4099264 Vali Loss: 0.2816403 Best vali loss: 0.2816403
	iters: 100, epoch: 5 | loss: 0.3323388
	speed: 0.0113s/iter; left time: 4.8028s
Updating learning rate to 2.114828423125e-05
Epoch: 5 cost time: 0.94657301902771
Epoch: 5, Steps: 131 | Train Loss: 0.3323388 Vali Loss: 0.2820901 Best vali loss: 0.2816403
	iters: 100, epoch: 6 | loss: 0.4986898
	speed: 0.0112s/iter; left time: 3.2855s
Updating learning rate to 1.0574142115625e-05
Epoch: 6 cost time: 0.9419598579406738
Epoch: 6, Steps: 131 | Train Loss: 0.4986898 Vali Loss: 0.2820608 Best vali loss: 0.2816403
	iters: 100, epoch: 7 | loss: 0.6418400
	speed: 0.0117s/iter; left time: 1.9105s
Updating learning rate to 5.2870710578125e-06
Epoch: 7 cost time: 0.9936079978942871
Epoch: 7, Steps: 131 | Train Loss: 0.6418400 Vali Loss: 0.2822157 Best vali loss: 0.2816403
	iters: 100, epoch: 8 | loss: 0.5050508
	speed: 0.0119s/iter; left time: 0.3794s
Updating learning rate to 2.64353552890625e-06
Epoch: 8 cost time: 0.9985804557800293
Epoch: 8, Steps: 131 | Train Loss: 0.5050508 Vali Loss: 0.2822660 Best vali loss: 0.2816403

best validation loss 0.2816403354464432

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009909717048, 'e_layers': 2, 'learning_rate': 0.0008180744789, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5239366
	speed: 0.0095s/iter; left time: 78.3169s
	iters: 200, epoch: 1 | loss: 0.2497412
	speed: 0.0047s/iter; left time: 38.2085s
	iters: 300, epoch: 1 | loss: 0.3893266
	speed: 0.0049s/iter; left time: 39.2348s
	iters: 400, epoch: 1 | loss: 0.3048063
	speed: 0.0049s/iter; left time: 38.9440s
	iters: 500, epoch: 1 | loss: 0.9817538
	speed: 0.0049s/iter; left time: 38.2881s
	iters: 600, epoch: 1 | loss: 0.3671906
	speed: 0.0049s/iter; left time: 38.0213s
	iters: 700, epoch: 1 | loss: 0.4853612
	speed: 0.0050s/iter; left time: 37.9247s
	iters: 800, epoch: 1 | loss: 0.3695754
	speed: 0.0049s/iter; left time: 36.8913s
	iters: 900, epoch: 1 | loss: 0.3511107
	speed: 0.0049s/iter; left time: 36.3325s
	iters: 1000, epoch: 1 | loss: 0.4407529
	speed: 0.0049s/iter; left time: 35.7981s
Updating learning rate to 0.0007869383730127732
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 5.28424596786499
Epoch: 1, Steps: 1045 | Train Loss: 0.4463555 Vali Loss: 0.3217758 Best vali loss: 0.3217758
	iters: 100, epoch: 2 | loss: 0.3369237
	speed: 0.0157s/iter; left time: 113.4353s
	iters: 200, epoch: 2 | loss: 1.4172568
	speed: 0.0035s/iter; left time: 24.5968s
	iters: 300, epoch: 2 | loss: 0.4802921
	speed: 0.0032s/iter; left time: 22.3148s
	iters: 400, epoch: 2 | loss: 1.7415264
	speed: 0.0036s/iter; left time: 24.9820s
	iters: 500, epoch: 2 | loss: 1.0743520
	speed: 0.0043s/iter; left time: 29.4031s
	iters: 600, epoch: 2 | loss: 0.4295209
	speed: 0.0045s/iter; left time: 29.9655s
	iters: 700, epoch: 2 | loss: 0.7950554
	speed: 0.0045s/iter; left time: 29.5761s
	iters: 800, epoch: 2 | loss: 0.2871425
	speed: 0.0044s/iter; left time: 28.6795s
	iters: 900, epoch: 2 | loss: 0.4540197
	speed: 0.0044s/iter; left time: 28.1427s
	iters: 1000, epoch: 2 | loss: 0.3087232
	speed: 0.0044s/iter; left time: 27.5911s
Updating learning rate to 0.0006982702452229205
Epoch: 2 cost time: 4.323971748352051
Epoch: 2, Steps: 1045 | Train Loss: 0.7324813 Vali Loss: 0.3237524 Best vali loss: 0.3217758
	iters: 100, epoch: 3 | loss: 0.2883956
	speed: 0.0151s/iter; left time: 93.0962s
	iters: 200, epoch: 3 | loss: 0.7010618
	speed: 0.0043s/iter; left time: 26.2208s
	iters: 300, epoch: 3 | loss: 1.3434085
	speed: 0.0043s/iter; left time: 25.5895s
	iters: 400, epoch: 3 | loss: 0.5333022
	speed: 0.0043s/iter; left time: 25.2251s
	iters: 500, epoch: 3 | loss: 0.4106344
	speed: 0.0043s/iter; left time: 24.8232s
	iters: 600, epoch: 3 | loss: 0.1977411
	speed: 0.0043s/iter; left time: 24.5715s
	iters: 700, epoch: 3 | loss: 0.6163091
	speed: 0.0042s/iter; left time: 23.4861s
	iters: 800, epoch: 3 | loss: 0.9325908
	speed: 0.0041s/iter; left time: 22.1655s
	iters: 900, epoch: 3 | loss: 0.2437022
	speed: 0.0036s/iter; left time: 19.2336s
	iters: 1000, epoch: 3 | loss: 0.4285694
	speed: 0.0036s/iter; left time: 18.8281s
Updating learning rate to 0.0005655690142078671
Epoch: 3 cost time: 4.330155611038208
Epoch: 3, Steps: 1045 | Train Loss: 0.5695715 Vali Loss: 0.3244882 Best vali loss: 0.3217758
	iters: 100, epoch: 4 | loss: 0.7368025
	speed: 0.0138s/iter; left time: 70.9649s
	iters: 200, epoch: 4 | loss: 1.9481205
	speed: 0.0041s/iter; left time: 20.4058s
	iters: 300, epoch: 4 | loss: 0.9819958
	speed: 0.0041s/iter; left time: 20.3207s
	iters: 400, epoch: 4 | loss: 0.9048133
	speed: 0.0042s/iter; left time: 20.1412s
	iters: 500, epoch: 4 | loss: 0.8425736
	speed: 0.0042s/iter; left time: 19.9203s
	iters: 600, epoch: 4 | loss: 1.3235065
	speed: 0.0042s/iter; left time: 19.6370s
	iters: 700, epoch: 4 | loss: 0.7375494
	speed: 0.0042s/iter; left time: 19.0042s
	iters: 800, epoch: 4 | loss: 0.4022713
	speed: 0.0043s/iter; left time: 18.8547s
	iters: 900, epoch: 4 | loss: 0.2402737
	speed: 0.0042s/iter; left time: 18.3308s
	iters: 1000, epoch: 4 | loss: 0.5482417
	speed: 0.0042s/iter; left time: 17.8551s
Updating learning rate to 0.00040903723945
Epoch: 4 cost time: 4.432563781738281
Epoch: 4, Steps: 1045 | Train Loss: 0.8666148 Vali Loss: 0.3256306 Best vali loss: 0.3217758
	iters: 100, epoch: 5 | loss: 0.1923443
	speed: 0.0148s/iter; left time: 60.2808s
	iters: 200, epoch: 5 | loss: 0.3369325
	speed: 0.0043s/iter; left time: 17.2017s
	iters: 300, epoch: 5 | loss: 0.3932196
	speed: 0.0043s/iter; left time: 16.5566s
	iters: 400, epoch: 5 | loss: 0.4907147
	speed: 0.0040s/iter; left time: 15.0056s
	iters: 500, epoch: 5 | loss: 0.3205655
	speed: 0.0038s/iter; left time: 13.8356s
	iters: 600, epoch: 5 | loss: 0.4837981
	speed: 0.0037s/iter; left time: 13.3454s
	iters: 700, epoch: 5 | loss: 0.3368663
	speed: 0.0035s/iter; left time: 12.1727s
	iters: 800, epoch: 5 | loss: 1.4424685
	speed: 0.0039s/iter; left time: 13.1938s
	iters: 900, epoch: 5 | loss: 0.1703188
	speed: 0.0043s/iter; left time: 14.1940s
	iters: 1000, epoch: 5 | loss: 1.3007166
	speed: 0.0043s/iter; left time: 13.6723s
Updating learning rate to 0.0002525054646921329
Validation loss decreased (0.3218 --> 0.3198).  Saving model state dict ...
Epoch: 5 cost time: 4.283369541168213
Epoch: 5, Steps: 1045 | Train Loss: 0.5467945 Vali Loss: 0.3197506 Best vali loss: 0.3197506
	iters: 100, epoch: 6 | loss: 1.3053918
	speed: 0.0152s/iter; left time: 46.2329s
	iters: 200, epoch: 6 | loss: 1.3821672
	speed: 0.0042s/iter; left time: 12.3481s
	iters: 300, epoch: 6 | loss: 1.9400980
	speed: 0.0041s/iter; left time: 11.7029s
	iters: 400, epoch: 6 | loss: 1.0786895
	speed: 0.0043s/iter; left time: 11.8547s
	iters: 500, epoch: 6 | loss: 0.3919323
	speed: 0.0042s/iter; left time: 11.0307s
	iters: 600, epoch: 6 | loss: 0.7248979
	speed: 0.0042s/iter; left time: 10.5586s
	iters: 700, epoch: 6 | loss: 1.0389255
	speed: 0.0042s/iter; left time: 10.1125s
	iters: 800, epoch: 6 | loss: 0.4109605
	speed: 0.0042s/iter; left time: 9.7592s
	iters: 900, epoch: 6 | loss: 0.3937769
	speed: 0.0042s/iter; left time: 9.4171s
	iters: 1000, epoch: 6 | loss: 0.2588644
	speed: 0.0042s/iter; left time: 8.8776s
Updating learning rate to 0.00011980423367707943
Epoch: 6 cost time: 4.4371771812438965
Epoch: 6, Steps: 1045 | Train Loss: 0.8925704 Vali Loss: 0.3204148 Best vali loss: 0.3197506
	iters: 100, epoch: 7 | loss: 0.2986994
	speed: 0.0139s/iter; left time: 27.5830s
	iters: 200, epoch: 7 | loss: 0.3265396
	speed: 0.0035s/iter; left time: 6.5422s
	iters: 300, epoch: 7 | loss: 0.1597504
	speed: 0.0039s/iter; left time: 6.9216s
	iters: 400, epoch: 7 | loss: 0.2402055
	speed: 0.0042s/iter; left time: 7.1379s
	iters: 500, epoch: 7 | loss: 0.6237363
	speed: 0.0041s/iter; left time: 6.5942s
	iters: 600, epoch: 7 | loss: 2.2530859
	speed: 0.0041s/iter; left time: 6.0529s
	iters: 700, epoch: 7 | loss: 0.3772905
	speed: 0.0041s/iter; left time: 5.6869s
	iters: 800, epoch: 7 | loss: 0.4416233
	speed: 0.0040s/iter; left time: 5.2091s
	iters: 900, epoch: 7 | loss: 0.3182434
	speed: 0.0041s/iter; left time: 4.8493s
	iters: 1000, epoch: 7 | loss: 0.6749406
	speed: 0.0041s/iter; left time: 4.4188s
Updating learning rate to 3.113610588722674e-05
Epoch: 7 cost time: 4.175760746002197
Epoch: 7, Steps: 1045 | Train Loss: 0.5714115 Vali Loss: 0.3217558 Best vali loss: 0.3197506
	iters: 100, epoch: 8 | loss: 0.3484050
	speed: 0.0148s/iter; left time: 14.0197s
	iters: 200, epoch: 8 | loss: 0.3258898
	speed: 0.0041s/iter; left time: 3.4938s
	iters: 300, epoch: 8 | loss: 0.2217625
	speed: 0.0041s/iter; left time: 3.0855s
	iters: 400, epoch: 8 | loss: 0.4985473
	speed: 0.0041s/iter; left time: 2.6605s
	iters: 500, epoch: 8 | loss: 0.3352258
	speed: 0.0041s/iter; left time: 2.2584s
	iters: 600, epoch: 8 | loss: 1.2026427
	speed: 0.0041s/iter; left time: 1.8095s
	iters: 700, epoch: 8 | loss: 1.8285575
	speed: 0.0041s/iter; left time: 1.4349s
	iters: 800, epoch: 8 | loss: 1.3635520
	speed: 0.0039s/iter; left time: 0.9651s
	iters: 900, epoch: 8 | loss: 0.4890877
	speed: 0.0037s/iter; left time: 0.5331s
	iters: 1000, epoch: 8 | loss: 0.2597508
	speed: 0.0035s/iter; left time: 0.1599s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.193934440612793
Epoch: 8, Steps: 1045 | Train Loss: 0.6873421 Vali Loss: 0.3220048 Best vali loss: 0.3197506

best validation loss 0.3197505579047063

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0030171201133, 'e_layers': 4, 'learning_rate': 0.0002007150185, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4574415
	speed: 0.0117s/iter; left time: 97.0070s
	iters: 200, epoch: 1 | loss: 0.3377347
	speed: 0.0064s/iter; left time: 52.0546s
	iters: 300, epoch: 1 | loss: 0.6313533
	speed: 0.0064s/iter; left time: 51.3566s
	iters: 400, epoch: 1 | loss: 1.0963868
	speed: 0.0063s/iter; left time: 50.1963s
	iters: 500, epoch: 1 | loss: 1.3026899
	speed: 0.0063s/iter; left time: 49.8154s
	iters: 600, epoch: 1 | loss: 0.3986132
	speed: 0.0063s/iter; left time: 48.8761s
	iters: 700, epoch: 1 | loss: 0.2596663
	speed: 0.0063s/iter; left time: 48.3875s
	iters: 800, epoch: 1 | loss: 0.2890077
	speed: 0.0063s/iter; left time: 47.5284s
	iters: 900, epoch: 1 | loss: 0.3942699
	speed: 0.0059s/iter; left time: 44.1678s
	iters: 1000, epoch: 1 | loss: 0.2632210
	speed: 0.0058s/iter; left time: 42.8501s
Updating learning rate to 0.00019307575797988713
Validation loss decreased (inf --> 0.2858).  Saving model state dict ...
Epoch: 1 cost time: 6.796752214431763
Epoch: 1, Steps: 1045 | Train Loss: 0.5430384 Vali Loss: 0.2857987 Best vali loss: 0.2857987
	iters: 100, epoch: 2 | loss: 1.3350067
	speed: 0.0187s/iter; left time: 134.8029s
	iters: 200, epoch: 2 | loss: 0.2307787
	speed: 0.0064s/iter; left time: 45.5907s
	iters: 300, epoch: 2 | loss: 0.5076993
	speed: 0.0064s/iter; left time: 44.5558s
	iters: 400, epoch: 2 | loss: 0.7363723
	speed: 0.0064s/iter; left time: 44.2982s
	iters: 500, epoch: 2 | loss: 0.3008667
	speed: 0.0064s/iter; left time: 43.6328s
	iters: 600, epoch: 2 | loss: 0.2980440
	speed: 0.0064s/iter; left time: 42.9056s
	iters: 700, epoch: 2 | loss: 0.7973101
	speed: 0.0063s/iter; left time: 41.7245s
	iters: 800, epoch: 2 | loss: 0.4428462
	speed: 0.0062s/iter; left time: 40.5715s
	iters: 900, epoch: 2 | loss: 1.3057168
	speed: 0.0059s/iter; left time: 37.8399s
	iters: 1000, epoch: 2 | loss: 0.4030571
	speed: 0.0059s/iter; left time: 37.4038s
Updating learning rate to 0.00017132098458366666
Epoch: 2 cost time: 6.579326629638672
Epoch: 2, Steps: 1045 | Train Loss: 0.6357698 Vali Loss: 0.2875995 Best vali loss: 0.2857987
	iters: 100, epoch: 3 | loss: 0.6328691
	speed: 0.0186s/iter; left time: 115.0332s
	iters: 200, epoch: 3 | loss: 0.2287580
	speed: 0.0062s/iter; left time: 37.5586s
	iters: 300, epoch: 3 | loss: 0.3768356
	speed: 0.0062s/iter; left time: 37.1719s
	iters: 400, epoch: 3 | loss: 0.3582165
	speed: 0.0063s/iter; left time: 36.8016s
	iters: 500, epoch: 3 | loss: 0.6030306
	speed: 0.0063s/iter; left time: 36.5168s
	iters: 600, epoch: 3 | loss: 0.3476072
	speed: 0.0064s/iter; left time: 36.1049s
	iters: 700, epoch: 3 | loss: 1.4967033
	speed: 0.0064s/iter; left time: 35.6717s
	iters: 800, epoch: 3 | loss: 0.2638755
	speed: 0.0065s/iter; left time: 35.3815s
	iters: 900, epoch: 3 | loss: 1.2470701
	speed: 0.0061s/iter; left time: 32.8198s
	iters: 1000, epoch: 3 | loss: 1.1001066
	speed: 0.0059s/iter; left time: 31.2876s
Updating learning rate to 0.00013876266535340126
Epoch: 3 cost time: 6.558897256851196
Epoch: 3, Steps: 1045 | Train Loss: 0.6655072 Vali Loss: 0.2875050 Best vali loss: 0.2857987
	iters: 100, epoch: 4 | loss: 0.4106882
	speed: 0.0185s/iter; left time: 94.7935s
	iters: 200, epoch: 4 | loss: 1.1070334
	speed: 0.0067s/iter; left time: 33.6323s
	iters: 300, epoch: 4 | loss: 0.3606163
	speed: 0.0056s/iter; left time: 27.6850s
	iters: 400, epoch: 4 | loss: 0.3997857
	speed: 0.0052s/iter; left time: 25.2022s
	iters: 500, epoch: 4 | loss: 0.2848964
	speed: 0.0064s/iter; left time: 30.1440s
	iters: 600, epoch: 4 | loss: 0.2575330
	speed: 0.0062s/iter; left time: 28.8470s
	iters: 700, epoch: 4 | loss: 0.8404949
	speed: 0.0060s/iter; left time: 27.2242s
	iters: 800, epoch: 4 | loss: 0.3508278
	speed: 0.0062s/iter; left time: 27.2522s
	iters: 900, epoch: 4 | loss: 0.3647734
	speed: 0.0063s/iter; left time: 27.3059s
	iters: 1000, epoch: 4 | loss: 1.5478671
	speed: 0.0061s/iter; left time: 25.5845s
Updating learning rate to 0.00010035750925
Epoch: 4 cost time: 6.42259955406189
Epoch: 4, Steps: 1045 | Train Loss: 0.5924516 Vali Loss: 0.2858677 Best vali loss: 0.2857987
	iters: 100, epoch: 5 | loss: 1.5492321
	speed: 0.0184s/iter; left time: 75.2700s
	iters: 200, epoch: 5 | loss: 1.1109611
	speed: 0.0051s/iter; left time: 20.2436s
	iters: 300, epoch: 5 | loss: 1.6241020
	speed: 0.0048s/iter; left time: 18.5474s
	iters: 400, epoch: 5 | loss: 1.1224347
	speed: 0.0064s/iter; left time: 24.1105s
	iters: 500, epoch: 5 | loss: 0.5976706
	speed: 0.0058s/iter; left time: 21.1843s
	iters: 600, epoch: 5 | loss: 0.3825148
	speed: 0.0062s/iter; left time: 22.0392s
	iters: 700, epoch: 5 | loss: 0.3202033
	speed: 0.0062s/iter; left time: 21.6394s
	iters: 800, epoch: 5 | loss: 0.3374241
	speed: 0.0060s/iter; left time: 20.3083s
	iters: 900, epoch: 5 | loss: 0.2170058
	speed: 0.0047s/iter; left time: 15.3574s
	iters: 1000, epoch: 5 | loss: 0.3483492
	speed: 0.0052s/iter; left time: 16.4681s
Updating learning rate to 6.195235314659876e-05
Epoch: 5 cost time: 6.015048027038574
Epoch: 5, Steps: 1045 | Train Loss: 0.7609898 Vali Loss: 0.2878625 Best vali loss: 0.2857987
	iters: 100, epoch: 6 | loss: 0.3350478
	speed: 0.0218s/iter; left time: 66.3302s
	iters: 200, epoch: 6 | loss: 0.1360764
	speed: 0.0071s/iter; left time: 20.8843s
	iters: 300, epoch: 6 | loss: 1.0052695
	speed: 0.0065s/iter; left time: 18.5640s
	iters: 400, epoch: 6 | loss: 0.3744417
	speed: 0.0072s/iter; left time: 19.7832s
	iters: 500, epoch: 6 | loss: 0.5775034
	speed: 0.0058s/iter; left time: 15.2532s
	iters: 600, epoch: 6 | loss: 0.1117911
	speed: 0.0044s/iter; left time: 11.1480s
	iters: 700, epoch: 6 | loss: 0.2002341
	speed: 0.0053s/iter; left time: 12.9380s
	iters: 800, epoch: 6 | loss: 0.2867194
	speed: 0.0064s/iter; left time: 14.8443s
	iters: 900, epoch: 6 | loss: 0.5768245
	speed: 0.0063s/iter; left time: 14.1705s
	iters: 1000, epoch: 6 | loss: 0.3525421
	speed: 0.0060s/iter; left time: 12.8299s
Updating learning rate to 2.9394033916333338e-05
Epoch: 6 cost time: 6.610683441162109
Epoch: 6, Steps: 1045 | Train Loss: 0.3956450 Vali Loss: 0.2892265 Best vali loss: 0.2857987
	iters: 100, epoch: 7 | loss: 0.3728452
	speed: 0.0191s/iter; left time: 38.0581s
	iters: 200, epoch: 7 | loss: 0.3526344
	speed: 0.0063s/iter; left time: 11.9366s
	iters: 300, epoch: 7 | loss: 0.4184563
	speed: 0.0064s/iter; left time: 11.3758s
	iters: 400, epoch: 7 | loss: 0.1901919
	speed: 0.0063s/iter; left time: 10.5751s
	iters: 500, epoch: 7 | loss: 0.3302464
	speed: 0.0062s/iter; left time: 9.9375s
	iters: 600, epoch: 7 | loss: 0.3340015
	speed: 0.0064s/iter; left time: 9.4777s
	iters: 700, epoch: 7 | loss: 0.5018154
	speed: 0.0063s/iter; left time: 8.7354s
	iters: 800, epoch: 7 | loss: 2.0629475
	speed: 0.0061s/iter; left time: 7.9095s
	iters: 900, epoch: 7 | loss: 0.5770592
	speed: 0.0063s/iter; left time: 7.5376s
	iters: 1000, epoch: 7 | loss: 0.3664713
	speed: 0.0061s/iter; left time: 6.6645s
Updating learning rate to 7.639260520112865e-06
Epoch: 7 cost time: 6.527127027511597
Epoch: 7, Steps: 1045 | Train Loss: 0.5506669 Vali Loss: 0.2883221 Best vali loss: 0.2857987
	iters: 100, epoch: 8 | loss: 0.6086001
	speed: 0.0159s/iter; left time: 15.0352s
	iters: 200, epoch: 8 | loss: 0.2823492
	speed: 0.0067s/iter; left time: 5.6938s
	iters: 300, epoch: 8 | loss: 0.4376570
	speed: 0.0069s/iter; left time: 5.1440s
	iters: 400, epoch: 8 | loss: 0.2599210
	speed: 0.0066s/iter; left time: 4.2783s
	iters: 500, epoch: 8 | loss: 0.5591822
	speed: 0.0065s/iter; left time: 3.5665s
	iters: 600, epoch: 8 | loss: 0.2182655
	speed: 0.0060s/iter; left time: 2.6849s
	iters: 700, epoch: 8 | loss: 1.0920475
	speed: 0.0060s/iter; left time: 2.0604s
	iters: 800, epoch: 8 | loss: 0.2807654
	speed: 0.0063s/iter; left time: 1.5483s
	iters: 900, epoch: 8 | loss: 0.3873694
	speed: 0.0063s/iter; left time: 0.9184s
	iters: 1000, epoch: 8 | loss: 0.3412493
	speed: 0.0063s/iter; left time: 0.2882s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.743801832199097
Epoch: 8, Steps: 1045 | Train Loss: 0.4467406 Vali Loss: 0.2874611 Best vali loss: 0.2857987

best validation loss 0.285798654788686

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4943735
	speed: 0.0117s/iter; left time: 23.3368s
	iters: 200, epoch: 1 | loss: 0.4423126
	speed: 0.0062s/iter; left time: 11.8183s
Updating learning rate to 0.0002850674695
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 1.917527198791504
Epoch: 1, Steps: 262 | Train Loss: 0.4683430 Vali Loss: 0.2846071 Best vali loss: 0.2846071
	iters: 100, epoch: 2 | loss: 0.5388127
	speed: 0.0131s/iter; left time: 22.7108s
	iters: 200, epoch: 2 | loss: 0.5488969
	speed: 0.0062s/iter; left time: 10.1347s
Updating learning rate to 0.00014253373475
Validation loss decreased (0.2846 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 1.6878435611724854
Epoch: 2, Steps: 262 | Train Loss: 0.5438548 Vali Loss: 0.2823538 Best vali loss: 0.2823538
	iters: 100, epoch: 3 | loss: 0.7591466
	speed: 0.0132s/iter; left time: 19.4452s
	iters: 200, epoch: 3 | loss: 0.4600098
	speed: 0.0062s/iter; left time: 8.4852s
Updating learning rate to 7.1266867375e-05
Epoch: 3 cost time: 1.6561999320983887
Epoch: 3, Steps: 262 | Train Loss: 0.6095782 Vali Loss: 0.2859562 Best vali loss: 0.2823538

best validation loss 0.2823537550769627

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008267342166, 'e_layers': 4, 'learning_rate': 5.54518777e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7044293
	speed: 0.0121s/iter; left time: 11.5224s
Updating learning rate to 5.3341366273174527e-05
Validation loss decreased (inf --> 0.3399).  Saving model state dict ...
Epoch: 1 cost time: 1.1241123676300049
Epoch: 1, Steps: 131 | Train Loss: 0.7044293 Vali Loss: 0.3398683 Best vali loss: 0.3398683
	iters: 100, epoch: 2 | loss: 0.7061315
	speed: 0.0106s/iter; left time: 8.6769s
Updating learning rate to 4.733113822559855e-05
Validation loss decreased (0.3399 --> 0.3260).  Saving model state dict ...
Epoch: 2 cost time: 0.8758814334869385
Epoch: 2, Steps: 131 | Train Loss: 0.7061315 Vali Loss: 0.3259867 Best vali loss: 0.3259867
	iters: 100, epoch: 3 | loss: 0.5053038
	speed: 0.0104s/iter; left time: 7.1233s
Updating learning rate to 3.833619629466259e-05
Validation loss decreased (0.3260 --> 0.3170).  Saving model state dict ...
Epoch: 3 cost time: 0.8602488040924072
Epoch: 3, Steps: 131 | Train Loss: 0.5053038 Vali Loss: 0.3169948 Best vali loss: 0.3169948

best validation loss 0.3169947526254544

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010382705628, 'e_layers': 3, 'learning_rate': 0.0008045612191, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7731481
	speed: 0.0105s/iter; left time: 20.9757s
	iters: 200, epoch: 1 | loss: 0.8123470
	speed: 0.0051s/iter; left time: 9.6084s
Updating learning rate to 0.0007739394310394095
Validation loss decreased (inf --> 0.2862).  Saving model state dict ...
Epoch: 1 cost time: 1.6111524105072021
Epoch: 1, Steps: 262 | Train Loss: 0.7927476 Vali Loss: 0.2862399 Best vali loss: 0.2862399
	iters: 100, epoch: 2 | loss: 0.4307242
	speed: 0.0118s/iter; left time: 20.4143s
	iters: 200, epoch: 2 | loss: 0.4318284
	speed: 0.0053s/iter; left time: 8.7207s
Updating learning rate to 0.0006867359565026628
Epoch: 2 cost time: 1.4502301216125488
Epoch: 2, Steps: 262 | Train Loss: 0.4312763 Vali Loss: 0.2939464 Best vali loss: 0.2862399
	iters: 100, epoch: 3 | loss: 0.4190494
	speed: 0.0108s/iter; left time: 15.9071s
	iters: 200, epoch: 3 | loss: 0.4626334
	speed: 0.0049s/iter; left time: 6.7172s
Updating learning rate to 0.0005562267339865145
Validation loss decreased (0.2862 --> 0.2831).  Saving model state dict ...
Epoch: 3 cost time: 1.3314452171325684
Epoch: 3, Steps: 262 | Train Loss: 0.4408414 Vali Loss: 0.2830970 Best vali loss: 0.2830970

best validation loss 0.2830970341020377

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4594845
	speed: 0.0125s/iter; left time: 15.0788s
	iters: 200, epoch: 4 | loss: 0.4141280
	speed: 0.0062s/iter; left time: 6.8687s
Updating learning rate to 3.56334336875e-05
Epoch: 4 cost time: 1.9411919116973877
Epoch: 4, Steps: 262 | Train Loss: 0.4368063 Vali Loss: 0.2856387 Best vali loss: 0.2823538
	iters: 100, epoch: 5 | loss: 0.5080186
	speed: 0.0130s/iter; left time: 12.2903s
	iters: 200, epoch: 5 | loss: 0.4945623
	speed: 0.0063s/iter; left time: 5.3787s
Updating learning rate to 1.781671684375e-05
Epoch: 5 cost time: 1.685835838317871
Epoch: 5, Steps: 262 | Train Loss: 0.5012904 Vali Loss: 0.2856995 Best vali loss: 0.2823538
	iters: 100, epoch: 6 | loss: 0.7050098
	speed: 0.0133s/iter; left time: 9.1143s
	iters: 200, epoch: 6 | loss: 0.4607047
	speed: 0.0063s/iter; left time: 3.6728s
Updating learning rate to 8.908358421875e-06
Epoch: 6 cost time: 1.6793570518493652
Epoch: 6, Steps: 262 | Train Loss: 0.5828572 Vali Loss: 0.2864197 Best vali loss: 0.2823538
	iters: 100, epoch: 7 | loss: 0.6400758
	speed: 0.0118s/iter; left time: 5.0065s
	iters: 200, epoch: 7 | loss: 0.2801770
	speed: 0.0055s/iter; left time: 1.7789s
Updating learning rate to 4.4541792109375e-06
Epoch: 7 cost time: 1.4681100845336914
Epoch: 7, Steps: 262 | Train Loss: 0.4601264 Vali Loss: 0.2867879 Best vali loss: 0.2823538
	iters: 100, epoch: 8 | loss: 0.6285437
	speed: 0.0128s/iter; left time: 2.0813s
	iters: 200, epoch: 8 | loss: 0.6151941
	speed: 0.0060s/iter; left time: 0.3755s
Updating learning rate to 2.22708960546875e-06
Epoch: 8 cost time: 1.5987536907196045
Epoch: 8, Steps: 262 | Train Loss: 0.6218689 Vali Loss: 0.2868430 Best vali loss: 0.2823538

best validation loss 0.2823537550769627

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0102976635799, 'e_layers': 4, 'learning_rate': 9.28932504e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3100918
	speed: 0.0118s/iter; left time: 48.2020s
	iters: 200, epoch: 1 | loss: 0.4728275
	speed: 0.0062s/iter; left time: 24.6023s
	iters: 300, epoch: 1 | loss: 0.6012155
	speed: 0.0058s/iter; left time: 22.5918s
	iters: 400, epoch: 1 | loss: 0.4957663
	speed: 0.0058s/iter; left time: 22.0252s
	iters: 500, epoch: 1 | loss: 0.8233961
	speed: 0.0062s/iter; left time: 22.7132s
Updating learning rate to 8.935771157650295e-05
Validation loss decreased (inf --> 0.2950).  Saving model state dict ...
Epoch: 1 cost time: 3.4426004886627197
Epoch: 1, Steps: 523 | Train Loss: 0.5406594 Vali Loss: 0.2950208 Best vali loss: 0.2950208
	iters: 100, epoch: 2 | loss: 0.3183500
	speed: 0.0126s/iter; left time: 45.0123s
	iters: 200, epoch: 2 | loss: 0.9268383
	speed: 0.0061s/iter; left time: 20.9914s
	iters: 300, epoch: 2 | loss: 0.6117721
	speed: 0.0061s/iter; left time: 20.4547s
	iters: 400, epoch: 2 | loss: 0.5262090
	speed: 0.0061s/iter; left time: 19.9149s
	iters: 500, epoch: 2 | loss: 0.9376509
	speed: 0.0061s/iter; left time: 19.1491s
Updating learning rate to 7.928934884214998e-05
Validation loss decreased (0.2950 --> 0.2855).  Saving model state dict ...
Epoch: 2 cost time: 3.211149215698242
Epoch: 2, Steps: 523 | Train Loss: 0.6641640 Vali Loss: 0.2854716 Best vali loss: 0.2854716
	iters: 100, epoch: 3 | loss: 0.2520280
	speed: 0.0122s/iter; left time: 37.1911s
	iters: 200, epoch: 3 | loss: 0.9476264
	speed: 0.0057s/iter; left time: 16.8665s
	iters: 300, epoch: 3 | loss: 0.5494866
	speed: 0.0060s/iter; left time: 16.9053s
	iters: 400, epoch: 3 | loss: 0.4681923
	speed: 0.0060s/iter; left time: 16.4188s
	iters: 500, epoch: 3 | loss: 0.8903409
	speed: 0.0059s/iter; left time: 15.5059s
Updating learning rate to 6.422097915331089e-05
Validation loss decreased (0.2855 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 3.1182713508605957
Epoch: 3, Steps: 523 | Train Loss: 0.6215349 Vali Loss: 0.2836297 Best vali loss: 0.2836297
	iters: 100, epoch: 4 | loss: 0.4893864
	speed: 0.0126s/iter; left time: 31.8164s
	iters: 200, epoch: 4 | loss: 1.2055100
	speed: 0.0061s/iter; left time: 14.6302s
	iters: 300, epoch: 4 | loss: 0.7256716
	speed: 0.0061s/iter; left time: 14.1074s
	iters: 400, epoch: 4 | loss: 0.4273544
	speed: 0.0061s/iter; left time: 13.4607s
	iters: 500, epoch: 4 | loss: 0.5695428
	speed: 0.0059s/iter; left time: 12.5322s
Updating learning rate to 4.64466252e-05
Validation loss decreased (0.2836 --> 0.2821).  Saving model state dict ...
Epoch: 4 cost time: 3.2002832889556885
Epoch: 4, Steps: 523 | Train Loss: 0.6834930 Vali Loss: 0.2820862 Best vali loss: 0.2820862
	iters: 100, epoch: 5 | loss: 0.4172837
	speed: 0.0125s/iter; left time: 24.9283s
	iters: 200, epoch: 5 | loss: 0.2984576
	speed: 0.0063s/iter; left time: 12.0037s
	iters: 300, epoch: 5 | loss: 0.3889033
	speed: 0.0062s/iter; left time: 11.1335s
	iters: 400, epoch: 5 | loss: 0.2644733
	speed: 0.0060s/iter; left time: 10.1260s
	iters: 500, epoch: 5 | loss: 0.8668458
	speed: 0.0059s/iter; left time: 9.4155s
Updating learning rate to 2.8672271246689127e-05
Epoch: 5 cost time: 3.259613037109375
Epoch: 5, Steps: 523 | Train Loss: 0.4471927 Vali Loss: 0.2829357 Best vali loss: 0.2820862
	iters: 100, epoch: 6 | loss: 0.3896086
	speed: 0.0125s/iter; left time: 18.4244s
	iters: 200, epoch: 6 | loss: 0.3118148
	speed: 0.0061s/iter; left time: 8.3130s
	iters: 300, epoch: 6 | loss: 0.2440961
	speed: 0.0060s/iter; left time: 7.6189s
	iters: 400, epoch: 6 | loss: 0.3645774
	speed: 0.0058s/iter; left time: 6.7641s
	iters: 500, epoch: 6 | loss: 0.4403087
	speed: 0.0057s/iter; left time: 6.1196s
Updating learning rate to 1.3603901557850019e-05
Epoch: 6 cost time: 3.1543028354644775
Epoch: 6, Steps: 523 | Train Loss: 0.3500811 Vali Loss: 0.2830315 Best vali loss: 0.2820862
	iters: 100, epoch: 7 | loss: 0.2329683
	speed: 0.0122s/iter; left time: 11.5542s
	iters: 200, epoch: 7 | loss: 0.9517713
	speed: 0.0058s/iter; left time: 4.8942s
	iters: 300, epoch: 7 | loss: 0.6819836
	speed: 0.0057s/iter; left time: 4.2764s
	iters: 400, epoch: 7 | loss: 0.8244833
	speed: 0.0057s/iter; left time: 3.7048s
	iters: 500, epoch: 7 | loss: 0.4594618
	speed: 0.0058s/iter; left time: 3.1746s
Updating learning rate to 3.53553882349705e-06
Epoch: 7 cost time: 3.0570287704467773
Epoch: 7, Steps: 523 | Train Loss: 0.6301337 Vali Loss: 0.2832685 Best vali loss: 0.2820862
	iters: 100, epoch: 8 | loss: 0.3577316
	speed: 0.0127s/iter; left time: 5.3736s
	iters: 200, epoch: 8 | loss: 0.7477762
	speed: 0.0060s/iter; left time: 1.9486s
	iters: 300, epoch: 8 | loss: 0.4249644
	speed: 0.0057s/iter; left time: 1.2797s
	iters: 400, epoch: 8 | loss: 0.6258706
	speed: 0.0058s/iter; left time: 0.7231s
	iters: 500, epoch: 8 | loss: 0.4422227
	speed: 0.0058s/iter; left time: 0.1391s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.149315595626831
Epoch: 8, Steps: 523 | Train Loss: 0.5197131 Vali Loss: 0.2833538 Best vali loss: 0.2820862

best validation loss 0.28208618213492903

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043224728456, 'e_layers': 3, 'learning_rate': 0.0008063623482, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5137183
	speed: 0.0107s/iter; left time: 88.5574s
	iters: 200, epoch: 1 | loss: 0.2123015
	speed: 0.0050s/iter; left time: 40.9091s
	iters: 300, epoch: 1 | loss: 0.9679527
	speed: 0.0050s/iter; left time: 40.5276s
	iters: 400, epoch: 1 | loss: 0.7078985
	speed: 0.0050s/iter; left time: 40.0915s
	iters: 500, epoch: 1 | loss: 0.2712649
	speed: 0.0050s/iter; left time: 39.4733s
	iters: 600, epoch: 1 | loss: 0.2430722
	speed: 0.0050s/iter; left time: 38.8310s
	iters: 700, epoch: 1 | loss: 1.0819147
	speed: 0.0047s/iter; left time: 35.9215s
	iters: 800, epoch: 1 | loss: 0.6433563
	speed: 0.0047s/iter; left time: 35.7670s
	iters: 900, epoch: 1 | loss: 0.3931396
	speed: 0.0051s/iter; left time: 37.9870s
	iters: 1000, epoch: 1 | loss: 0.4238979
	speed: 0.0050s/iter; left time: 37.1161s
Updating learning rate to 0.0008063623482
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 5.47843074798584
Epoch: 1, Steps: 1045 | Train Loss: 0.5458517 Vali Loss: 0.2817276 Best vali loss: 0.2817276
	iters: 100, epoch: 2 | loss: 0.5620527
	speed: 0.0161s/iter; left time: 116.4331s
	iters: 200, epoch: 2 | loss: 0.2203117
	speed: 0.0052s/iter; left time: 37.1438s
	iters: 300, epoch: 2 | loss: 1.2809887
	speed: 0.0052s/iter; left time: 36.5471s
	iters: 400, epoch: 2 | loss: 0.3652850
	speed: 0.0052s/iter; left time: 35.6179s
	iters: 500, epoch: 2 | loss: 0.4075624
	speed: 0.0050s/iter; left time: 34.0812s
	iters: 600, epoch: 2 | loss: 0.2745910
	speed: 0.0049s/iter; left time: 33.1389s
	iters: 700, epoch: 2 | loss: 0.5926090
	speed: 0.0044s/iter; left time: 29.3434s
	iters: 800, epoch: 2 | loss: 0.2722307
	speed: 0.0044s/iter; left time: 28.7504s
	iters: 900, epoch: 2 | loss: 0.1839940
	speed: 0.0049s/iter; left time: 31.5426s
	iters: 1000, epoch: 2 | loss: 0.3593337
	speed: 0.0050s/iter; left time: 31.7544s
Updating learning rate to 0.0004031811741
Epoch: 2 cost time: 5.214550971984863
Epoch: 2, Steps: 1045 | Train Loss: 0.4518959 Vali Loss: 0.2843240 Best vali loss: 0.2817276
	iters: 100, epoch: 3 | loss: 0.8188951
	speed: 0.0159s/iter; left time: 98.2591s
	iters: 200, epoch: 3 | loss: 0.2461328
	speed: 0.0050s/iter; left time: 30.5738s
	iters: 300, epoch: 3 | loss: 0.3848921
	speed: 0.0051s/iter; left time: 30.1868s
	iters: 400, epoch: 3 | loss: 0.3587851
	speed: 0.0051s/iter; left time: 30.2073s
	iters: 500, epoch: 3 | loss: 0.4675743
	speed: 0.0051s/iter; left time: 29.1504s
	iters: 600, epoch: 3 | loss: 1.1196011
	speed: 0.0051s/iter; left time: 28.8108s
	iters: 700, epoch: 3 | loss: 0.7018791
	speed: 0.0049s/iter; left time: 27.0929s
	iters: 800, epoch: 3 | loss: 1.0854682
	speed: 0.0049s/iter; left time: 26.7779s
	iters: 900, epoch: 3 | loss: 0.2626430
	speed: 0.0040s/iter; left time: 21.3523s
	iters: 1000, epoch: 3 | loss: 1.0458689
	speed: 0.0043s/iter; left time: 22.5255s
Updating learning rate to 0.00020159058705
Epoch: 3 cost time: 5.076478719711304
Epoch: 3, Steps: 1045 | Train Loss: 0.6491740 Vali Loss: 0.2866674 Best vali loss: 0.2817276
	iters: 100, epoch: 4 | loss: 0.4785797
	speed: 0.0133s/iter; left time: 68.1452s
	iters: 200, epoch: 4 | loss: 0.3231934
	speed: 0.0046s/iter; left time: 23.3639s
	iters: 300, epoch: 4 | loss: 0.8789680
	speed: 0.0050s/iter; left time: 24.3895s
	iters: 400, epoch: 4 | loss: 0.1684734
	speed: 0.0047s/iter; left time: 22.6711s
	iters: 500, epoch: 4 | loss: 0.8026603
	speed: 0.0050s/iter; left time: 23.6926s
	iters: 600, epoch: 4 | loss: 0.4016794
	speed: 0.0043s/iter; left time: 20.0794s
	iters: 700, epoch: 4 | loss: 0.1533475
	speed: 0.0036s/iter; left time: 16.1200s
	iters: 800, epoch: 4 | loss: 0.3521676
	speed: 0.0040s/iter; left time: 17.8007s
	iters: 900, epoch: 4 | loss: 0.2509950
	speed: 0.0096s/iter; left time: 41.7013s
	iters: 1000, epoch: 4 | loss: 0.3460227
	speed: 0.0058s/iter; left time: 24.3021s
Updating learning rate to 0.000100795293525
Epoch: 4 cost time: 5.656805992126465
Epoch: 4, Steps: 1045 | Train Loss: 0.4156087 Vali Loss: 0.2867399 Best vali loss: 0.2817276
	iters: 100, epoch: 5 | loss: 0.2205003
	speed: 0.0281s/iter; left time: 114.5497s
	iters: 200, epoch: 5 | loss: 0.4859670
	speed: 0.0043s/iter; left time: 17.0860s
	iters: 300, epoch: 5 | loss: 0.3022665
	speed: 0.0034s/iter; left time: 13.3163s
	iters: 400, epoch: 5 | loss: 0.2600349
	speed: 0.0039s/iter; left time: 14.9176s
	iters: 500, epoch: 5 | loss: 0.3598288
	speed: 0.0054s/iter; left time: 19.9966s
	iters: 600, epoch: 5 | loss: 0.1825315
	speed: 0.0048s/iter; left time: 17.2981s
	iters: 700, epoch: 5 | loss: 0.3761612
	speed: 0.0053s/iter; left time: 18.6027s
	iters: 800, epoch: 5 | loss: 1.0056469
	speed: 0.0047s/iter; left time: 15.7535s
	iters: 900, epoch: 5 | loss: 0.6450195
	speed: 0.0051s/iter; left time: 16.6068s
	iters: 1000, epoch: 5 | loss: 1.1555473
	speed: 0.0039s/iter; left time: 12.5542s
Updating learning rate to 5.03976467625e-05
Epoch: 5 cost time: 5.229017019271851
Epoch: 5, Steps: 1045 | Train Loss: 0.4993504 Vali Loss: 0.2928290 Best vali loss: 0.2817276
	iters: 100, epoch: 6 | loss: 0.7835185
	speed: 0.0198s/iter; left time: 60.1923s
	iters: 200, epoch: 6 | loss: 0.2357367
	speed: 0.0082s/iter; left time: 24.1587s
	iters: 300, epoch: 6 | loss: 0.5684074
	speed: 0.0077s/iter; left time: 21.8914s
	iters: 400, epoch: 6 | loss: 0.3018688
	speed: 0.0082s/iter; left time: 22.3183s
	iters: 500, epoch: 6 | loss: 0.2447573
	speed: 0.0079s/iter; left time: 20.8592s
	iters: 600, epoch: 6 | loss: 0.2056195
	speed: 0.0080s/iter; left time: 20.2261s
	iters: 700, epoch: 6 | loss: 0.3960995
	speed: 0.0077s/iter; left time: 18.8183s
	iters: 800, epoch: 6 | loss: 0.2679386
	speed: 0.0078s/iter; left time: 18.2230s
	iters: 900, epoch: 6 | loss: 0.4474380
	speed: 0.0080s/iter; left time: 17.9865s
	iters: 1000, epoch: 6 | loss: 0.5322959
	speed: 0.0038s/iter; left time: 8.1789s
Updating learning rate to 2.519882338125e-05
Epoch: 6 cost time: 7.789502859115601
Epoch: 6, Steps: 1045 | Train Loss: 0.3983680 Vali Loss: 0.2905875 Best vali loss: 0.2817276
	iters: 100, epoch: 7 | loss: 0.6611444
	speed: 0.0151s/iter; left time: 30.1036s
	iters: 200, epoch: 7 | loss: 0.2706831
	speed: 0.0059s/iter; left time: 11.2181s
	iters: 300, epoch: 7 | loss: 0.2972342
	speed: 0.0057s/iter; left time: 10.2026s
	iters: 400, epoch: 7 | loss: 0.3113839
	speed: 0.0063s/iter; left time: 10.6590s
	iters: 500, epoch: 7 | loss: 0.4280039
	speed: 0.0053s/iter; left time: 8.4887s
	iters: 600, epoch: 7 | loss: 0.1982781
	speed: 0.0064s/iter; left time: 9.5497s
	iters: 700, epoch: 7 | loss: 0.5428997
	speed: 0.0053s/iter; left time: 7.3894s
	iters: 800, epoch: 7 | loss: 0.5411841
	speed: 0.0066s/iter; left time: 8.5441s
	iters: 900, epoch: 7 | loss: 0.3333099
	speed: 0.0053s/iter; left time: 6.3428s
	iters: 1000, epoch: 7 | loss: 0.4933129
	speed: 0.0063s/iter; left time: 6.9177s
Updating learning rate to 1.2599411690625e-05
Epoch: 7 cost time: 6.194499492645264
Epoch: 7, Steps: 1045 | Train Loss: 0.4077434 Vali Loss: 0.2906134 Best vali loss: 0.2817276
	iters: 100, epoch: 8 | loss: 0.6411656
	speed: 0.0190s/iter; left time: 17.9856s
	iters: 200, epoch: 8 | loss: 0.2417498
	speed: 0.0048s/iter; left time: 4.0259s
	iters: 300, epoch: 8 | loss: 0.6021799
	speed: 0.0035s/iter; left time: 2.5987s
	iters: 400, epoch: 8 | loss: 0.3551368
	speed: 0.0036s/iter; left time: 2.3047s
	iters: 500, epoch: 8 | loss: 0.3023454
	speed: 0.0044s/iter; left time: 2.3814s
	iters: 600, epoch: 8 | loss: 0.2324992
	speed: 0.0043s/iter; left time: 1.9039s
	iters: 700, epoch: 8 | loss: 0.3188536
	speed: 0.0047s/iter; left time: 1.6117s
	iters: 800, epoch: 8 | loss: 0.4908764
	speed: 0.0042s/iter; left time: 1.0425s
	iters: 900, epoch: 8 | loss: 0.2561454
	speed: 0.0042s/iter; left time: 0.6117s
	iters: 1000, epoch: 8 | loss: 0.2051486
	speed: 0.0042s/iter; left time: 0.1952s
Updating learning rate to 6.2997058453125e-06
Epoch: 8 cost time: 4.680208444595337
Epoch: 8, Steps: 1045 | Train Loss: 0.3646101 Vali Loss: 0.2908003 Best vali loss: 0.2817276

best validation loss 0.28172758610087195

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0066694129125, 'e_layers': 1, 'learning_rate': 0.0002333035787, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4752316
	speed: 0.0097s/iter; left time: 19.4533s
	iters: 200, epoch: 1 | loss: 0.8742079
	speed: 0.0031s/iter; left time: 5.8531s
Updating learning rate to 0.0002333035787
Validation loss decreased (inf --> 0.3035).  Saving model state dict ...
Epoch: 1 cost time: 1.154895305633545
Epoch: 1, Steps: 262 | Train Loss: 0.6747198 Vali Loss: 0.3035391 Best vali loss: 0.3035391
	iters: 100, epoch: 2 | loss: 0.3978321
	speed: 0.0062s/iter; left time: 10.8046s
	iters: 200, epoch: 2 | loss: 0.4516324
	speed: 0.0041s/iter; left time: 6.7770s
Updating learning rate to 0.00011665178935
Validation loss decreased (0.3035 --> 0.2877).  Saving model state dict ...
Epoch: 2 cost time: 1.131932020187378
Epoch: 2, Steps: 262 | Train Loss: 0.4247322 Vali Loss: 0.2877198 Best vali loss: 0.2877198
	iters: 100, epoch: 3 | loss: 0.6191325
	speed: 0.0134s/iter; left time: 19.7993s
	iters: 200, epoch: 3 | loss: 0.4221166
	speed: 0.0055s/iter; left time: 7.5731s
Updating learning rate to 5.8325894675e-05
Validation loss decreased (0.2877 --> 0.2840).  Saving model state dict ...
Epoch: 3 cost time: 1.4285364151000977
Epoch: 3, Steps: 262 | Train Loss: 0.5206245 Vali Loss: 0.2840429 Best vali loss: 0.2840429

best validation loss 0.2840428951062337

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3157551
	speed: 0.0094s/iter; left time: 18.7021s
	iters: 200, epoch: 1 | loss: 0.5151605
	speed: 0.0048s/iter; left time: 9.1123s
Updating learning rate to 0.00017249420488318464
Validation loss decreased (inf --> 0.2794).  Saving model state dict ...
Epoch: 1 cost time: 1.4737329483032227
Epoch: 1, Steps: 262 | Train Loss: 0.4154578 Vali Loss: 0.2794214 Best vali loss: 0.2794214
	iters: 100, epoch: 2 | loss: 0.3125114
	speed: 0.0117s/iter; left time: 20.3788s
	iters: 200, epoch: 2 | loss: 0.5277994
	speed: 0.0052s/iter; left time: 8.4253s
Updating learning rate to 0.0001530584539703962
Epoch: 2 cost time: 1.391826868057251
Epoch: 2, Steps: 262 | Train Loss: 0.4201554 Vali Loss: 0.2865235 Best vali loss: 0.2794214
	iters: 100, epoch: 3 | loss: 0.6124095
	speed: 0.0114s/iter; left time: 16.8239s
	iters: 200, epoch: 3 | loss: 0.7303360
	speed: 0.0052s/iter; left time: 7.1079s
Updating learning rate to 0.00012397079715258604
Epoch: 3 cost time: 1.3926761150360107
Epoch: 3, Steps: 262 | Train Loss: 0.6713727 Vali Loss: 0.2820569 Best vali loss: 0.2794214

best validation loss 0.2794213706164078

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008069876564, 'e_layers': 3, 'learning_rate': 0.000202447705, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7253969
	speed: 0.0107s/iter; left time: 10.1821s
Updating learning rate to 0.00019474249802669145
Validation loss decreased (inf --> 0.2790).  Saving model state dict ...
Epoch: 1 cost time: 0.9756760597229004
Epoch: 1, Steps: 131 | Train Loss: 0.7253969 Vali Loss: 0.2790051 Best vali loss: 0.2790051
	iters: 100, epoch: 2 | loss: 0.6625828
	speed: 0.0090s/iter; left time: 7.3406s
Updating learning rate to 0.00017279992502057686
Validation loss decreased (0.2790 --> 0.2765).  Saving model state dict ...
Epoch: 2 cost time: 0.7256743907928467
Epoch: 2, Steps: 131 | Train Loss: 0.6625828 Vali Loss: 0.2764684 Best vali loss: 0.2764684
	iters: 100, epoch: 3 | loss: 0.6961792
	speed: 0.0090s/iter; left time: 6.1573s
Updating learning rate to 0.00013996054381191757
Epoch: 3 cost time: 0.7209444046020508
Epoch: 3, Steps: 131 | Train Loss: 0.6961792 Vali Loss: 0.2898732 Best vali loss: 0.2764684

best validation loss 0.27646840874392464

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008069876564, 'e_layers': 3, 'learning_rate': 0.000202447705, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5918837
	speed: 0.0113s/iter; left time: 6.2940s
Updating learning rate to 0.0001012238525
Epoch: 4 cost time: 1.0150046348571777
Epoch: 4, Steps: 131 | Train Loss: 0.5918837 Vali Loss: 0.2846021 Best vali loss: 0.2764684
	iters: 100, epoch: 5 | loss: 0.5887464
	speed: 0.0097s/iter; left time: 4.1145s
Updating learning rate to 6.248716118808243e-05
Epoch: 5 cost time: 0.7904849052429199
Epoch: 5, Steps: 131 | Train Loss: 0.5887464 Vali Loss: 0.2895545 Best vali loss: 0.2764684
	iters: 100, epoch: 6 | loss: 0.5995074
	speed: 0.0089s/iter; left time: 2.6088s
Updating learning rate to 2.9647779979423143e-05
Epoch: 6 cost time: 0.7185473442077637
Epoch: 6, Steps: 131 | Train Loss: 0.5995074 Vali Loss: 0.2953839 Best vali loss: 0.2764684
	iters: 100, epoch: 7 | loss: 0.3102102
	speed: 0.0088s/iter; left time: 1.4411s
Updating learning rate to 7.705206973308556e-06
Epoch: 7 cost time: 0.7371673583984375
Epoch: 7, Steps: 131 | Train Loss: 0.3102102 Vali Loss: 0.2897637 Best vali loss: 0.2764684
	iters: 100, epoch: 8 | loss: 0.4842296
	speed: 0.0089s/iter; left time: 0.2864s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7290358543395996
Epoch: 8, Steps: 131 | Train Loss: 0.4842296 Vali Loss: 0.2900368 Best vali loss: 0.2764684

best validation loss 0.27646840874392464

[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.001716146484, 'e_layers': 4, 'learning_rate': 9.25739637e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6050991
	speed: 0.0122s/iter; left time: 11.5431s
Updating learning rate to 8.905057700293642e-05
Validation loss decreased (inf --> 0.2812).  Saving model state dict ...
Epoch: 1 cost time: 1.1581130027770996
Epoch: 1, Steps: 131 | Train Loss: 0.6050991 Vali Loss: 0.2812440 Best vali loss: 0.2812440
	iters: 100, epoch: 2 | loss: 0.6717843
	speed: 0.0106s/iter; left time: 8.6905s
Updating learning rate to 7.901682059679364e-05
Validation loss decreased (0.2812 --> 0.2793).  Saving model state dict ...
Epoch: 2 cost time: 0.8741285800933838
Epoch: 2, Steps: 131 | Train Loss: 0.6717843 Vali Loss: 0.2793384 Best vali loss: 0.2793384
	iters: 100, epoch: 3 | loss: 0.4692339
	speed: 0.0106s/iter; left time: 7.3036s
Updating learning rate to 6.400024293817862e-05
Epoch: 3 cost time: 0.9013142585754395
Epoch: 3, Steps: 131 | Train Loss: 0.4692339 Vali Loss: 0.2796287 Best vali loss: 0.2793384
	iters: 100, epoch: 4 | loss: 0.4379664
	speed: 0.0110s/iter; left time: 6.1122s
Updating learning rate to 4.628698185e-05
Epoch: 4 cost time: 0.9272356033325195
Epoch: 4, Steps: 131 | Train Loss: 0.4379664 Vali Loss: 0.2798734 Best vali loss: 0.2793384
	iters: 100, epoch: 5 | loss: 0.4662118
	speed: 0.0111s/iter; left time: 4.7265s
Updating learning rate to 2.857372076182139e-05
Epoch: 5 cost time: 0.9485137462615967
Epoch: 5, Steps: 131 | Train Loss: 0.4662118 Vali Loss: 0.2795156 Best vali loss: 0.2793384
	iters: 100, epoch: 6 | loss: 0.4023687
	speed: 0.0112s/iter; left time: 3.2920s
Updating learning rate to 1.3557143103206357e-05
Epoch: 6 cost time: 0.9388623237609863
Epoch: 6, Steps: 131 | Train Loss: 0.4023687 Vali Loss: 0.2798882 Best vali loss: 0.2793384
	iters: 100, epoch: 7 | loss: 0.4957504
	speed: 0.0110s/iter; left time: 1.7973s
Updating learning rate to 3.523386697063586e-06
Epoch: 7 cost time: 0.9350459575653076
Epoch: 7, Steps: 131 | Train Loss: 0.4957504 Vali Loss: 0.2802653 Best vali loss: 0.2793384
	iters: 100, epoch: 8 | loss: 0.5665569
	speed: 0.0108s/iter; left time: 0.3461s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9149360656738281
Epoch: 8, Steps: 131 | Train Loss: 0.5665569 Vali Loss: 0.2808141 Best vali loss: 0.2793384

best validation loss 0.27933844499492255

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0044569176576, 'e_layers': 2, 'learning_rate': 0.0006733362287, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4916422
	speed: 0.0097s/iter; left time: 9.2459s
Updating learning rate to 0.0006477088944471344
Validation loss decreased (inf --> 0.2897).  Saving model state dict ...
Epoch: 1 cost time: 0.8170919418334961
Epoch: 1, Steps: 131 | Train Loss: 0.4916422 Vali Loss: 0.2896997 Best vali loss: 0.2896997
	iters: 100, epoch: 2 | loss: 0.4482511
	speed: 0.0067s/iter; left time: 5.4725s
Updating learning rate to 0.0005747284210161729
Validation loss decreased (0.2897 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 0.5321087837219238
Epoch: 2, Steps: 131 | Train Loss: 0.4482511 Vali Loss: 0.2818383 Best vali loss: 0.2818383
	iters: 100, epoch: 3 | loss: 0.6223840
	speed: 0.0071s/iter; left time: 4.8721s
Updating learning rate to 0.00046550542391734053
Validation loss decreased (0.2818 --> 0.2816).  Saving model state dict ...
Epoch: 3 cost time: 0.587449312210083
Epoch: 3, Steps: 131 | Train Loss: 0.6223840 Vali Loss: 0.2815650 Best vali loss: 0.2815650
	iters: 100, epoch: 4 | loss: 0.5601602
	speed: 0.0072s/iter; left time: 4.0087s
Updating learning rate to 0.00033666811435
Epoch: 4 cost time: 0.567676305770874
Epoch: 4, Steps: 131 | Train Loss: 0.5601602 Vali Loss: 0.2858892 Best vali loss: 0.2815650
	iters: 100, epoch: 5 | loss: 0.3534584
	speed: 0.0068s/iter; left time: 2.9096s
Updating learning rate to 0.00020783080478265948
Epoch: 5 cost time: 0.5521984100341797
Epoch: 5, Steps: 131 | Train Loss: 0.3534584 Vali Loss: 0.2858577 Best vali loss: 0.2815650
	iters: 100, epoch: 6 | loss: 0.6903263
	speed: 0.0072s/iter; left time: 2.1223s
Updating learning rate to 9.8607807683827e-05
Epoch: 6 cost time: 0.5723800659179688
Epoch: 6, Steps: 131 | Train Loss: 0.6903263 Vali Loss: 0.2840963 Best vali loss: 0.2815650
	iters: 100, epoch: 7 | loss: 0.6446592
	speed: 0.0068s/iter; left time: 1.1118s
Updating learning rate to 2.5627334252865573e-05
Epoch: 7 cost time: 0.5262565612792969
Epoch: 7, Steps: 131 | Train Loss: 0.6446592 Vali Loss: 0.2849163 Best vali loss: 0.2815650
	iters: 100, epoch: 8 | loss: 0.5652179
	speed: 0.0069s/iter; left time: 0.2208s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.555365800857544
Epoch: 8, Steps: 131 | Train Loss: 0.5652179 Vali Loss: 0.2851293 Best vali loss: 0.2815650

best validation loss 0.28156498250752054

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00031764682727096065
Validation loss decreased (inf --> 0.2787).  Saving model state dict ...
Epoch: 1 cost time: 1.1184959411621094
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2787389 Best vali loss: 0.2787389
Updating learning rate to 0.00028185603292365586
Epoch: 2 cost time: 0.9076128005981445
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2858714 Best vali loss: 0.2787389
Updating learning rate to 0.00022829132385310412
Epoch: 3 cost time: 0.8732097148895264
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3015147 Best vali loss: 0.2787389

best validation loss 0.27873894501326474

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009854043892, 'e_layers': 4, 'learning_rate': 0.0004499065077, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7517648
	speed: 0.0110s/iter; left time: 90.5695s
	iters: 200, epoch: 1 | loss: 0.3687628
	speed: 0.0047s/iter; left time: 38.3219s
	iters: 300, epoch: 1 | loss: 0.2609685
	speed: 0.0052s/iter; left time: 41.5153s
	iters: 400, epoch: 1 | loss: 0.2900932
	speed: 0.0064s/iter; left time: 51.0313s
	iters: 500, epoch: 1 | loss: 0.2300795
	speed: 0.0064s/iter; left time: 50.2519s
	iters: 600, epoch: 1 | loss: 0.5734893
	speed: 0.0064s/iter; left time: 49.6786s
	iters: 700, epoch: 1 | loss: 0.2266578
	speed: 0.0064s/iter; left time: 48.8447s
	iters: 800, epoch: 1 | loss: 0.5193617
	speed: 0.0064s/iter; left time: 48.4604s
	iters: 900, epoch: 1 | loss: 0.3108777
	speed: 0.0064s/iter; left time: 47.7496s
	iters: 1000, epoch: 1 | loss: 0.2984111
	speed: 0.0064s/iter; left time: 47.2059s
Updating learning rate to 0.00043278296085383084
Validation loss decreased (inf --> 0.2909).  Saving model state dict ...
Epoch: 1 cost time: 6.593987941741943
Epoch: 1, Steps: 1045 | Train Loss: 0.3830466 Vali Loss: 0.2908596 Best vali loss: 0.2908596
	iters: 100, epoch: 2 | loss: 0.3287764
	speed: 0.0190s/iter; left time: 137.3259s
	iters: 200, epoch: 2 | loss: 0.3261278
	speed: 0.0060s/iter; left time: 42.5997s
	iters: 300, epoch: 2 | loss: 0.2470608
	speed: 0.0057s/iter; left time: 40.2491s
	iters: 400, epoch: 2 | loss: 0.5182377
	speed: 0.0062s/iter; left time: 42.8470s
	iters: 500, epoch: 2 | loss: 0.4788816
	speed: 0.0064s/iter; left time: 43.5322s
	iters: 600, epoch: 2 | loss: 0.4963796
	speed: 0.0064s/iter; left time: 42.9181s
	iters: 700, epoch: 2 | loss: 0.4220431
	speed: 0.0064s/iter; left time: 42.3029s
	iters: 800, epoch: 2 | loss: 0.3298820
	speed: 0.0064s/iter; left time: 41.7685s
	iters: 900, epoch: 2 | loss: 1.1891745
	speed: 0.0064s/iter; left time: 40.7521s
	iters: 1000, epoch: 2 | loss: 1.1378734
	speed: 0.0063s/iter; left time: 40.1021s
Updating learning rate to 0.0003840192250973138
Validation loss decreased (0.2909 --> 0.2855).  Saving model state dict ...
Epoch: 2 cost time: 6.59126353263855
Epoch: 2, Steps: 1045 | Train Loss: 0.5474437 Vali Loss: 0.2854924 Best vali loss: 0.2854924
	iters: 100, epoch: 3 | loss: 0.4487032
	speed: 0.0187s/iter; left time: 115.6059s
	iters: 200, epoch: 3 | loss: 0.3090872
	speed: 0.0063s/iter; left time: 37.9728s
	iters: 300, epoch: 3 | loss: 0.2399678
	speed: 0.0066s/iter; left time: 39.2258s
	iters: 400, epoch: 3 | loss: 0.7626474
	speed: 0.0065s/iter; left time: 37.9192s
	iters: 500, epoch: 3 | loss: 0.1986511
	speed: 0.0066s/iter; left time: 37.9424s
	iters: 600, epoch: 3 | loss: 0.8696239
	speed: 0.0066s/iter; left time: 37.2423s
	iters: 700, epoch: 3 | loss: 0.1341878
	speed: 0.0066s/iter; left time: 36.9728s
	iters: 800, epoch: 3 | loss: 0.6466027
	speed: 0.0067s/iter; left time: 36.6035s
	iters: 900, epoch: 3 | loss: 0.2907873
	speed: 0.0067s/iter; left time: 36.0116s
	iters: 1000, epoch: 3 | loss: 0.2583362
	speed: 0.0066s/iter; left time: 34.6833s
Updating learning rate to 0.00031103913715501335
Epoch: 3 cost time: 6.874665975570679
Epoch: 3, Steps: 1045 | Train Loss: 0.4158595 Vali Loss: 0.2868193 Best vali loss: 0.2854924

best validation loss 0.2854924225461399

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010212612733, 'e_layers': 1, 'learning_rate': 0.001033174495, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5652378
	speed: 0.0082s/iter; left time: 16.4205s
	iters: 200, epoch: 1 | loss: 0.4023685
	speed: 0.0027s/iter; left time: 5.0865s
Updating learning rate to 0.001033174495
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 0.9967713356018066
Epoch: 1, Steps: 262 | Train Loss: 0.4838032 Vali Loss: 0.2849887 Best vali loss: 0.2849887
	iters: 100, epoch: 2 | loss: 0.7387972
	speed: 0.0069s/iter; left time: 11.9904s
	iters: 200, epoch: 2 | loss: 0.4085681
	speed: 0.0029s/iter; left time: 4.7114s
Updating learning rate to 0.0005165872475
Validation loss decreased (0.2850 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 0.7914724349975586
Epoch: 2, Steps: 262 | Train Loss: 0.5736827 Vali Loss: 0.2834335 Best vali loss: 0.2834335
	iters: 100, epoch: 3 | loss: 0.3708962
	speed: 0.0070s/iter; left time: 10.3683s
	iters: 200, epoch: 3 | loss: 0.2348684
	speed: 0.0031s/iter; left time: 4.3143s
Updating learning rate to 0.00025829362375
Epoch: 3 cost time: 0.8570501804351807
Epoch: 3, Steps: 262 | Train Loss: 0.3028823 Vali Loss: 0.2837186 Best vali loss: 0.2834335

best validation loss 0.2834335262390174

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00016510744145
Epoch: 4 cost time: 1.1863055229187012
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3177042 Best vali loss: 0.2787389
Updating learning rate to 0.00010192355904689593
Epoch: 5 cost time: 0.9455955028533936
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3060311 Best vali loss: 0.2787389
Updating learning rate to 4.835884997634416e-05
Epoch: 6 cost time: 0.9389846324920654
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3048898 Best vali loss: 0.2787389
Updating learning rate to 1.2568055629039355e-05
Epoch: 7 cost time: 0.9454813003540039
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3182860 Best vali loss: 0.2787389
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9458019733428955
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3113165 Best vali loss: 0.2787389

best validation loss 0.27873894501326474

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.005640097632, 'e_layers': 4, 'learning_rate': 0.0001952136558, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4581726
	speed: 0.0116s/iter; left time: 95.8890s
	iters: 200, epoch: 1 | loss: 0.3391896
	speed: 0.0063s/iter; left time: 51.3709s
	iters: 300, epoch: 1 | loss: 0.6310533
	speed: 0.0063s/iter; left time: 50.8149s
	iters: 400, epoch: 1 | loss: 1.0976837
	speed: 0.0063s/iter; left time: 50.2975s
	iters: 500, epoch: 1 | loss: 1.3034574
	speed: 0.0063s/iter; left time: 49.8577s
	iters: 600, epoch: 1 | loss: 0.4001356
	speed: 0.0063s/iter; left time: 48.8664s
	iters: 700, epoch: 1 | loss: 0.2597931
	speed: 0.0062s/iter; left time: 47.5506s
	iters: 800, epoch: 1 | loss: 0.2897810
	speed: 0.0063s/iter; left time: 47.7413s
	iters: 900, epoch: 1 | loss: 0.3953901
	speed: 0.0062s/iter; left time: 46.4686s
	iters: 1000, epoch: 1 | loss: 0.2626114
	speed: 0.0063s/iter; left time: 46.3077s
Updating learning rate to 0.0001952136558
Validation loss decreased (inf --> 0.2861).  Saving model state dict ...
Epoch: 1 cost time: 6.846032619476318
Epoch: 1, Steps: 1045 | Train Loss: 0.5437268 Vali Loss: 0.2860808 Best vali loss: 0.2860808
	iters: 100, epoch: 2 | loss: 1.3369495
	speed: 0.0182s/iter; left time: 131.6180s
	iters: 200, epoch: 2 | loss: 0.2309592
	speed: 0.0063s/iter; left time: 45.1244s
	iters: 300, epoch: 2 | loss: 0.5068649
	speed: 0.0064s/iter; left time: 44.7250s
	iters: 400, epoch: 2 | loss: 0.7368712
	speed: 0.0064s/iter; left time: 44.0988s
	iters: 500, epoch: 2 | loss: 0.3003365
	speed: 0.0064s/iter; left time: 43.3780s
	iters: 600, epoch: 2 | loss: 0.2974700
	speed: 0.0064s/iter; left time: 42.7669s
	iters: 700, epoch: 2 | loss: 0.7973773
	speed: 0.0064s/iter; left time: 42.1523s
	iters: 800, epoch: 2 | loss: 0.4432149
	speed: 0.0064s/iter; left time: 41.4010s
	iters: 900, epoch: 2 | loss: 1.3071766
	speed: 0.0064s/iter; left time: 40.8613s
	iters: 1000, epoch: 2 | loss: 0.4053818
	speed: 0.0063s/iter; left time: 40.1025s
Updating learning rate to 9.76068279e-05
Epoch: 2 cost time: 6.660335063934326
Epoch: 2, Steps: 1045 | Train Loss: 0.6362602 Vali Loss: 0.2877218 Best vali loss: 0.2860808
	iters: 100, epoch: 3 | loss: 0.6374189
	speed: 0.0187s/iter; left time: 115.1079s
	iters: 200, epoch: 3 | loss: 0.2296118
	speed: 0.0067s/iter; left time: 40.7096s
	iters: 300, epoch: 3 | loss: 0.3729878
	speed: 0.0067s/iter; left time: 39.9225s
	iters: 400, epoch: 3 | loss: 0.3597286
	speed: 0.0066s/iter; left time: 38.9061s
	iters: 500, epoch: 3 | loss: 0.6477681
	speed: 0.0066s/iter; left time: 38.1170s
	iters: 600, epoch: 3 | loss: 0.3477440
	speed: 0.0066s/iter; left time: 37.4752s
	iters: 700, epoch: 3 | loss: 1.5136591
	speed: 0.0066s/iter; left time: 36.7033s
	iters: 800, epoch: 3 | loss: 0.2659079
	speed: 0.0066s/iter; left time: 36.2797s
	iters: 900, epoch: 3 | loss: 1.2049491
	speed: 0.0066s/iter; left time: 35.4170s
	iters: 1000, epoch: 3 | loss: 1.1076884
	speed: 0.0066s/iter; left time: 35.0217s
Updating learning rate to 4.880341395e-05
Epoch: 3 cost time: 6.951905250549316
Epoch: 3, Steps: 1045 | Train Loss: 0.6687464 Vali Loss: 0.2864092 Best vali loss: 0.2860808
	iters: 100, epoch: 4 | loss: 0.4014418
	speed: 0.0182s/iter; left time: 93.4464s
	iters: 200, epoch: 4 | loss: 1.1181611
	speed: 0.0066s/iter; left time: 33.0575s
	iters: 300, epoch: 4 | loss: 0.3392558
	speed: 0.0066s/iter; left time: 32.3478s
	iters: 400, epoch: 4 | loss: 0.4052058
	speed: 0.0066s/iter; left time: 31.7107s
	iters: 500, epoch: 4 | loss: 0.2838332
	speed: 0.0066s/iter; left time: 31.2287s
	iters: 600, epoch: 4 | loss: 0.2648297
	speed: 0.0066s/iter; left time: 30.5502s
	iters: 700, epoch: 4 | loss: 0.8822269
	speed: 0.0055s/iter; left time: 24.9233s
	iters: 800, epoch: 4 | loss: 0.3618660
	speed: 0.0048s/iter; left time: 21.4579s
	iters: 900, epoch: 4 | loss: 0.3638113
	speed: 0.0071s/iter; left time: 30.6776s
	iters: 1000, epoch: 4 | loss: 1.5510551
	speed: 0.0077s/iter; left time: 32.5019s
Updating learning rate to 2.4401706975e-05
Epoch: 4 cost time: 6.781474828720093
Epoch: 4, Steps: 1045 | Train Loss: 0.5971687 Vali Loss: 0.2868080 Best vali loss: 0.2860808
	iters: 100, epoch: 5 | loss: 1.6010565
	speed: 0.0242s/iter; left time: 98.7583s
	iters: 200, epoch: 5 | loss: 1.1123719
	speed: 0.0069s/iter; left time: 27.5203s
	iters: 300, epoch: 5 | loss: 1.6689633
	speed: 0.0062s/iter; left time: 24.0220s
	iters: 400, epoch: 5 | loss: 1.1709936
	speed: 0.0071s/iter; left time: 26.9853s
	iters: 500, epoch: 5 | loss: 0.5730539
	speed: 0.0077s/iter; left time: 28.1876s
	iters: 600, epoch: 5 | loss: 0.3840508
	speed: 0.0077s/iter; left time: 27.5167s
	iters: 700, epoch: 5 | loss: 0.3263827
	speed: 0.0076s/iter; left time: 26.5239s
	iters: 800, epoch: 5 | loss: 0.3347887
	speed: 0.0077s/iter; left time: 25.9768s
	iters: 900, epoch: 5 | loss: 0.2104219
	speed: 0.0075s/iter; left time: 24.7300s
	iters: 1000, epoch: 5 | loss: 0.3448007
	speed: 0.0063s/iter; left time: 20.1225s
Updating learning rate to 1.22008534875e-05
Epoch: 5 cost time: 7.570427179336548
Epoch: 5, Steps: 1045 | Train Loss: 0.7726884 Vali Loss: 0.2874331 Best vali loss: 0.2860808
	iters: 100, epoch: 6 | loss: 0.3282353
	speed: 0.0235s/iter; left time: 71.4176s
	iters: 200, epoch: 6 | loss: 0.1362219
	speed: 0.0077s/iter; left time: 22.6388s
	iters: 300, epoch: 6 | loss: 0.9799461
	speed: 0.0082s/iter; left time: 23.3810s
	iters: 400, epoch: 6 | loss: 0.3816955
	speed: 0.0073s/iter; left time: 20.0489s
	iters: 500, epoch: 6 | loss: 0.5839233
	speed: 0.0062s/iter; left time: 16.3649s
	iters: 600, epoch: 6 | loss: 0.1115810
	speed: 0.0072s/iter; left time: 18.1750s
	iters: 700, epoch: 6 | loss: 0.2075094
	speed: 0.0081s/iter; left time: 19.7654s
	iters: 800, epoch: 6 | loss: 0.2964083
	speed: 0.0082s/iter; left time: 19.1667s
	iters: 900, epoch: 6 | loss: 0.5805225
	speed: 0.0081s/iter; left time: 18.2202s
	iters: 1000, epoch: 6 | loss: 0.3078564
	speed: 0.0078s/iter; left time: 16.5858s
Updating learning rate to 6.10042674375e-06
Epoch: 6 cost time: 8.058301210403442
Epoch: 6, Steps: 1045 | Train Loss: 0.3913900 Vali Loss: 0.2879543 Best vali loss: 0.2860808
	iters: 100, epoch: 7 | loss: 0.3875335
	speed: 0.0206s/iter; left time: 40.9223s
	iters: 200, epoch: 7 | loss: 0.4664392
	speed: 0.0077s/iter; left time: 14.5055s
	iters: 300, epoch: 7 | loss: 0.4343884
	speed: 0.0079s/iter; left time: 14.1950s
	iters: 400, epoch: 7 | loss: 0.1937166
	speed: 0.0076s/iter; left time: 12.8475s
	iters: 500, epoch: 7 | loss: 0.3810021
	speed: 0.0077s/iter; left time: 12.2774s
	iters: 600, epoch: 7 | loss: 0.3296832
	speed: 0.0075s/iter; left time: 11.2394s
	iters: 700, epoch: 7 | loss: 0.5151450
	speed: 0.0061s/iter; left time: 8.5253s
	iters: 800, epoch: 7 | loss: 2.3913496
	speed: 0.0066s/iter; left time: 8.4936s
	iters: 900, epoch: 7 | loss: 0.7123417
	speed: 0.0076s/iter; left time: 9.0849s
	iters: 1000, epoch: 7 | loss: 0.3916503
	speed: 0.0074s/iter; left time: 8.0778s
Updating learning rate to 3.050213371875e-06
Epoch: 7 cost time: 7.7563581466674805
Epoch: 7, Steps: 1045 | Train Loss: 0.6203249 Vali Loss: 0.2879295 Best vali loss: 0.2860808
	iters: 100, epoch: 8 | loss: 0.6614851
	speed: 0.0244s/iter; left time: 23.1175s
	iters: 200, epoch: 8 | loss: 0.3077555
	speed: 0.0062s/iter; left time: 5.2419s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0036399733072, 'e_layers': 2, 'learning_rate': 0.0011858266081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3830734
	speed: 0.0108s/iter; left time: 89.4779s
	iters: 200, epoch: 1 | loss: 0.4092613
	speed: 0.0052s/iter; left time: 42.6258s
	iters: 300, epoch: 1 | loss: 0.2823402
	speed: 0.0053s/iter; left time: 42.4853s
	iters: 400, epoch: 1 | loss: 0.3589675
	speed: 0.0053s/iter; left time: 42.0053s
	iters: 500, epoch: 1 | loss: 0.6510675
	speed: 0.0053s/iter; left time: 41.4788s
	iters: 600, epoch: 1 | loss: 0.5497465
	speed: 0.0053s/iter; left time: 40.9311s
	iters: 700, epoch: 1 | loss: 0.8633882
	speed: 0.0053s/iter; left time: 40.4820s
	iters: 800, epoch: 1 | loss: 0.4841446
	speed: 0.0052s/iter; left time: 39.5795s
	iters: 900, epoch: 1 | loss: 0.3069241
	speed: 0.0048s/iter; left time: 35.8787s
	iters: 1000, epoch: 1 | loss: 0.3446528
	speed: 0.0041s/iter; left time: 29.8494s
Updating learning rate to 0.0011858266081
Validation loss decreased (inf --> 0.3166).  Saving model state dict ...
Epoch: 1 cost time: 5.573760032653809
Epoch: 1, Steps: 1045 | Train Loss: 0.4633566 Vali Loss: 0.3165552 Best vali loss: 0.3165552
	iters: 100, epoch: 2 | loss: 0.5807300
	speed: 0.0178s/iter; left time: 128.7480s
	iters: 200, epoch: 2 | loss: 0.2933883
	speed: 0.0053s/iter; left time: 37.5248s
	iters: 300, epoch: 2 | loss: 0.3201031
	speed: 0.0053s/iter; left time: 37.0642s
	iters: 400, epoch: 2 | loss: 0.2835167
	speed: 0.0053s/iter; left time: 36.4698s
	iters: 500, epoch: 2 | loss: 0.9424955
	speed: 0.0053s/iter; left time: 35.8758s
	iters: 600, epoch: 2 | loss: 0.4273997
	speed: 0.0052s/iter; left time: 35.1166s
	iters: 700, epoch: 2 | loss: 0.4260769
	speed: 0.0052s/iter; left time: 34.6738s
	iters: 800, epoch: 2 | loss: 1.0897892
	speed: 0.0052s/iter; left time: 34.0692s
	iters: 900, epoch: 2 | loss: 0.3397503
	speed: 0.0046s/iter; left time: 29.1997s
	iters: 1000, epoch: 2 | loss: 0.3908371
	speed: 0.0040s/iter; left time: 25.4968s
Updating learning rate to 0.00059291330405
Epoch: 2 cost time: 5.315040111541748
Epoch: 2, Steps: 1045 | Train Loss: 0.5094087 Vali Loss: 0.3187940 Best vali loss: 0.3165552
	iters: 100, epoch: 3 | loss: 1.9173050
	speed: 0.0113s/iter; left time: 69.6579s
	iters: 200, epoch: 3 | loss: 0.5315192
	speed: 0.0031s/iter; left time: 18.9291s
	iters: 300, epoch: 3 | loss: 0.3669146
	speed: 0.0030s/iter; left time: 17.9338s
	iters: 400, epoch: 3 | loss: 0.2179492
	speed: 0.0030s/iter; left time: 17.4630s
	iters: 500, epoch: 3 | loss: 0.6187407
	speed: 0.0047s/iter; left time: 27.3219s
	iters: 600, epoch: 3 | loss: 0.3995865
	speed: 0.0063s/iter; left time: 35.6242s
	iters: 700, epoch: 3 | loss: 0.3690638
	speed: 0.0052s/iter; left time: 28.8848s
	iters: 800, epoch: 3 | loss: 0.4067014
	speed: 0.0054s/iter; left time: 29.7948s
	iters: 900, epoch: 3 | loss: 0.4365993
	speed: 0.0063s/iter; left time: 33.8749s
	iters: 1000, epoch: 3 | loss: 0.3239233
	speed: 0.0047s/iter; left time: 24.7309s
Updating learning rate to 0.000296456652025
Epoch: 3 cost time: 4.843483209609985
Epoch: 3, Steps: 1045 | Train Loss: 0.5588303 Vali Loss: 0.3204699 Best vali loss: 0.3165552
	iters: 100, epoch: 4 | loss: 0.3385572
	speed: 0.0165s/iter; left time: 84.8057s
	iters: 200, epoch: 4 | loss: 0.6536915
	speed: 0.0031s/iter; left time: 15.4675s
	iters: 300, epoch: 4 | loss: 0.5927973
	speed: 0.0043s/iter; left time: 21.0937s
	iters: 400, epoch: 4 | loss: 0.2841181
	speed: 0.0052s/iter; left time: 25.2831s
	iters: 500, epoch: 4 | loss: 0.9753413
	speed: 0.0053s/iter; left time: 24.9237s
	iters: 600, epoch: 4 | loss: 0.8510575
	speed: 0.0052s/iter; left time: 24.1589s
	iters: 700, epoch: 4 | loss: 2.7109895
	speed: 0.0053s/iter; left time: 24.1342s
	iters: 800, epoch: 4 | loss: 0.2564480
	speed: 0.0055s/iter; left time: 24.1468s
	iters: 900, epoch: 4 | loss: 0.4263966
	speed: 0.0055s/iter; left time: 23.7121s
	iters: 1000, epoch: 4 | loss: 0.2473246
	speed: 0.0054s/iter; left time: 22.9894s
Updating learning rate to 0.0001482283260125
Epoch: 4 cost time: 5.030436038970947
Epoch: 4, Steps: 1045 | Train Loss: 0.7336722 Vali Loss: 0.3232566 Best vali loss: 0.3165552
	iters: 100, epoch: 5 | loss: 0.3475523
	speed: 0.0170s/iter; left time: 69.4402s
	iters: 200, epoch: 5 | loss: 0.2406047
	speed: 0.0054s/iter; left time: 21.3652s
	iters: 300, epoch: 5 | loss: 0.3660383
	speed: 0.0054s/iter; left time: 20.7941s
	iters: 400, epoch: 5 | loss: 0.4176363
	speed: 0.0054s/iter; left time: 20.2866s
	iters: 500, epoch: 5 | loss: 0.3222067
	speed: 0.0055s/iter; left time: 20.2004s
	iters: 600, epoch: 5 | loss: 0.3007975
	speed: 0.0055s/iter; left time: 19.5200s
	iters: 700, epoch: 5 | loss: 0.8000610
	speed: 0.0045s/iter; left time: 15.5275s
	iters: 800, epoch: 5 | loss: 1.3980227
	speed: 0.0039s/iter; left time: 13.3239s
	iters: 900, epoch: 5 | loss: 0.3007250
	speed: 0.0047s/iter; left time: 15.3319s
	iters: 1000, epoch: 5 | loss: 0.4461848
	speed: 0.0054s/iter; left time: 17.2192s
Updating learning rate to 7.411416300625e-05
Epoch: 5 cost time: 5.376754283905029
Epoch: 5, Steps: 1045 | Train Loss: 0.4939829 Vali Loss: 0.3230654 Best vali loss: 0.3165552
	iters: 100, epoch: 6 | loss: 0.3264644
	speed: 0.0190s/iter; left time: 57.5546s
	iters: 200, epoch: 6 | loss: 0.3420633
	speed: 0.0054s/iter; left time: 15.8226s
	iters: 300, epoch: 6 | loss: 0.2467855
	speed: 0.0056s/iter; left time: 15.8925s
	iters: 400, epoch: 6 | loss: 0.1422983
	speed: 0.0039s/iter; left time: 10.6338s
	iters: 500, epoch: 6 | loss: 0.2040926
	speed: 0.0038s/iter; left time: 10.0561s
	iters: 600, epoch: 6 | loss: 1.4495963
	speed: 0.0032s/iter; left time: 8.0475s
	iters: 700, epoch: 6 | loss: 0.2641150
	speed: 0.0032s/iter; left time: 7.8026s
	iters: 800, epoch: 6 | loss: 0.5483067
	speed: 0.0040s/iter; left time: 9.3766s
	iters: 900, epoch: 6 | loss: 1.0969259
	speed: 0.0042s/iter; left time: 9.4058s
	iters: 1000, epoch: 6 | loss: 1.3666947
	speed: 0.0043s/iter; left time: 9.2460s
Updating learning rate to 3.7057081503125e-05
Epoch: 6 cost time: 4.573132514953613
Epoch: 6, Steps: 1045 | Train Loss: 0.5987343 Vali Loss: 0.3219684 Best vali loss: 0.3165552
	iters: 100, epoch: 7 | loss: 0.3224543
	speed: 0.0114s/iter; left time: 22.6878s
	iters: 200, epoch: 7 | loss: 0.6136348
	speed: 0.0046s/iter; left time: 8.6784s
	iters: 300, epoch: 7 | loss: 0.5493467
	speed: 0.0042s/iter; left time: 7.5052s
	iters: 400, epoch: 7 | loss: 0.2367489
	speed: 0.0044s/iter; left time: 7.3803s
	iters: 500, epoch: 7 | loss: 0.3714104
	speed: 0.0043s/iter; left time: 6.8928s
	iters: 600, epoch: 7 | loss: 0.3634400
	speed: 0.0043s/iter; left time: 6.4332s
	iters: 700, epoch: 7 | loss: 0.3106663
	speed: 0.0043s/iter; left time: 5.9462s
	iters: 800, epoch: 7 | loss: 0.1880997
	speed: 0.0032s/iter; left time: 4.1385s
	iters: 900, epoch: 7 | loss: 0.3157159
	speed: 0.0032s/iter; left time: 3.8633s
	iters: 1000, epoch: 7 | loss: 0.6076586
	speed: 0.0038s/iter; left time: 4.1824s
Updating learning rate to 1.85285407515625e-05
Epoch: 7 cost time: 4.2213294506073
Epoch: 7, Steps: 1045 | Train Loss: 0.3879176 Vali Loss: 0.3222257 Best vali loss: 0.3165552
	iters: 100, epoch: 8 | loss: 0.4518732
	speed: 0.0141s/iter; left time: 13.3450s
	iters: 200, epoch: 8 | loss: 0.3702239
	speed: 0.0041s/iter; left time: 3.4882s
	iters: 300, epoch: 8 | loss: 0.4832938
	speed: 0.0046s/iter; left time: 3.4048s
	iters: 400, epoch: 8 | loss: 0.3626484
	speed: 0.0043s/iter; left time: 2.8024s
	iters: 500, epoch: 8 | loss: 0.8458453
	speed: 0.0037s/iter; left time: 2.0168s
	iters: 600, epoch: 8 | loss: 1.7886825
	speed: 0.0040s/iter; left time: 1.7687s
	iters: 700, epoch: 8 | loss: 0.9865229
	speed: 0.0043s/iter; left time: 1.5006s
	iters: 800, epoch: 8 | loss: 0.2638513
	speed: 0.0042s/iter; left time: 1.0332s
	iters: 900, epoch: 8 | loss: 1.0798918
	speed: 0.0040s/iter; left time: 0.5907s
	iters: 1000, epoch: 8 | loss: 0.7279023
	speed: 0.0040s/iter; left time: 0.1826s
Updating learning rate to 9.26427037578125e-06
Epoch: 8 cost time: 4.3266661167144775
Epoch: 8, Steps: 1045 | Train Loss: 0.7360735 Vali Loss: 0.3221342 Best vali loss: 0.3165552

best validation loss 0.31655518923961967

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0077699148402, 'e_layers': 2, 'learning_rate': 0.0001964127649, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9787529
	speed: 0.0100s/iter; left time: 19.8893s
	iters: 200, epoch: 1 | loss: 0.3135374
	speed: 0.0042s/iter; left time: 7.9619s
Updating learning rate to 0.0001964127649
Validation loss decreased (inf --> 0.2777).  Saving model state dict ...
Epoch: 1 cost time: 1.3964221477508545
Epoch: 1, Steps: 262 | Train Loss: 0.6461451 Vali Loss: 0.2776544 Best vali loss: 0.2776544
	iters: 100, epoch: 2 | loss: 0.7410342
	speed: 0.0096s/iter; left time: 16.7022s
	iters: 200, epoch: 2 | loss: 0.3483999
	speed: 0.0042s/iter; left time: 6.8120s
Updating learning rate to 9.820638245e-05
Epoch: 2 cost time: 1.1417462825775146
Epoch: 2, Steps: 262 | Train Loss: 0.5447171 Vali Loss: 0.2798199 Best vali loss: 0.2776544
	iters: 100, epoch: 3 | loss: 0.4059204
	speed: 0.0095s/iter; left time: 13.9396s
	iters: 200, epoch: 3 | loss: 0.4715366
	speed: 0.0041s/iter; left time: 5.6615s
Updating learning rate to 4.9103191225e-05
Epoch: 3 cost time: 1.1126203536987305
Epoch: 3, Steps: 262 | Train Loss: 0.4387285 Vali Loss: 0.2873060 Best vali loss: 0.2776544

best validation loss 0.27765439602578607

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0046875553557, 'e_layers': 4, 'learning_rate': 0.0008574476385, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0334748
	speed: 0.0106s/iter; left time: 43.4695s
	iters: 200, epoch: 1 | loss: 0.4764056
	speed: 0.0062s/iter; left time: 24.7408s
	iters: 300, epoch: 1 | loss: 0.4660871
	speed: 0.0077s/iter; left time: 29.8550s
	iters: 400, epoch: 1 | loss: 0.3302639
	speed: 0.0087s/iter; left time: 32.8626s
	iters: 500, epoch: 1 | loss: 1.0015115
	speed: 0.0087s/iter; left time: 31.8856s
Updating learning rate to 0.0008248129809551434
Validation loss decreased (inf --> 0.3313).  Saving model state dict ...
Epoch: 1 cost time: 4.045068740844727
Epoch: 1, Steps: 523 | Train Loss: 0.6615486 Vali Loss: 0.3312790 Best vali loss: 0.3312790
	iters: 100, epoch: 2 | loss: 0.9184022
	speed: 0.0140s/iter; left time: 49.8864s
	iters: 200, epoch: 2 | loss: 0.5485198
	speed: 0.0056s/iter; left time: 19.2636s
	iters: 300, epoch: 2 | loss: 0.6965352
	speed: 0.0070s/iter; left time: 23.4015s
	iters: 400, epoch: 2 | loss: 0.3789055
	speed: 0.0072s/iter; left time: 23.6428s
	iters: 500, epoch: 2 | loss: 0.9052517
	speed: 0.0073s/iter; left time: 22.9332s
Updating learning rate to 0.0007318773390978706
Validation loss decreased (0.3313 --> 0.3210).  Saving model state dict ...
Epoch: 2 cost time: 3.5090672969818115
Epoch: 2, Steps: 523 | Train Loss: 0.6895229 Vali Loss: 0.3210113 Best vali loss: 0.3210113
	iters: 100, epoch: 3 | loss: 0.5756637
	speed: 0.0146s/iter; left time: 44.4810s
	iters: 200, epoch: 3 | loss: 0.2511574
	speed: 0.0060s/iter; left time: 17.7708s
	iters: 300, epoch: 3 | loss: 0.5638603
	speed: 0.0071s/iter; left time: 20.2573s
	iters: 400, epoch: 3 | loss: 0.2847272
	speed: 0.0070s/iter; left time: 19.0797s
	iters: 500, epoch: 3 | loss: 0.2496228
	speed: 0.0071s/iter; left time: 18.7805s
Updating learning rate to 0.0005927893219372603
Epoch: 3 cost time: 3.6146657466888428
Epoch: 3, Steps: 523 | Train Loss: 0.3850063 Vali Loss: 0.3284779 Best vali loss: 0.3210113

best validation loss 0.32101129035871684

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0092835703757, 'e_layers': 2, 'learning_rate': 0.0006403068671, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006403068671
Validation loss decreased (inf --> 0.2870).  Saving model state dict ...
Epoch: 1 cost time: 0.6437816619873047
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2870211 Best vali loss: 0.2870211
Updating learning rate to 0.00032015343355
Validation loss decreased (0.2870 --> 0.2823).  Saving model state dict ...
Epoch: 2 cost time: 0.3974759578704834
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2822705 Best vali loss: 0.2822705
Updating learning rate to 0.000160076716775
Validation loss decreased (0.2823 --> 0.2818).  Saving model state dict ...
Epoch: 3 cost time: 0.3792147636413574
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2818022 Best vali loss: 0.2818022

best validation loss 0.2818021935772036

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0077699148402, 'e_layers': 2, 'learning_rate': 0.0001964127649, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5894199
	speed: 0.0102s/iter; left time: 12.3017s
	iters: 200, epoch: 4 | loss: 0.3011490
	speed: 0.0043s/iter; left time: 4.7642s
Updating learning rate to 2.45515956125e-05
Epoch: 4 cost time: 1.3818061351776123
Epoch: 4, Steps: 262 | Train Loss: 0.4452844 Vali Loss: 0.2997782 Best vali loss: 0.2776544
	iters: 100, epoch: 5 | loss: 0.5679265
	speed: 0.0090s/iter; left time: 8.5438s
	iters: 200, epoch: 5 | loss: 0.3020363
	speed: 0.0037s/iter; left time: 3.1752s
Updating learning rate to 1.227579780625e-05
Epoch: 5 cost time: 1.0510430335998535
Epoch: 5, Steps: 262 | Train Loss: 0.4349814 Vali Loss: 0.2964125 Best vali loss: 0.2776544
	iters: 100, epoch: 6 | loss: 0.3708662
	speed: 0.0099s/iter; left time: 6.8346s
	iters: 200, epoch: 6 | loss: 0.3956114
	speed: 0.0047s/iter; left time: 2.7316s
Updating learning rate to 6.137898903125e-06
Epoch: 6 cost time: 1.2680108547210693
Epoch: 6, Steps: 262 | Train Loss: 0.3832388 Vali Loss: 0.2965653 Best vali loss: 0.2776544
	iters: 100, epoch: 7 | loss: 0.4054915
	speed: 0.0095s/iter; left time: 4.0522s
	iters: 200, epoch: 7 | loss: 0.2600996
	speed: 0.0047s/iter; left time: 1.5215s
Updating learning rate to 3.0689494515625e-06
Epoch: 7 cost time: 1.174299716949463
Epoch: 7, Steps: 262 | Train Loss: 0.3327955 Vali Loss: 0.2963497 Best vali loss: 0.2776544
	iters: 100, epoch: 8 | loss: 0.4557107
	speed: 0.0107s/iter; left time: 1.7418s
	iters: 200, epoch: 8 | loss: 0.2484236
	speed: 0.0040s/iter; left time: 0.2534s
Updating learning rate to 1.53447472578125e-06
Epoch: 8 cost time: 1.1603028774261475
Epoch: 8, Steps: 262 | Train Loss: 0.3520672 Vali Loss: 0.2941625 Best vali loss: 0.2776544

best validation loss 0.27765439602578607

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0028852829179, 'e_layers': 3, 'learning_rate': 0.0002361458543, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3562719
	speed: 0.0100s/iter; left time: 19.9090s
	iters: 200, epoch: 1 | loss: 0.3525188
	speed: 0.0042s/iter; left time: 7.9245s
Updating learning rate to 0.0002361458543
Validation loss decreased (inf --> 0.3011).  Saving model state dict ...
Epoch: 1 cost time: 1.3928635120391846
Epoch: 1, Steps: 262 | Train Loss: 0.3543954 Vali Loss: 0.3011474 Best vali loss: 0.3011474
	iters: 100, epoch: 2 | loss: 0.6894765
	speed: 0.0140s/iter; left time: 24.3738s
	iters: 200, epoch: 2 | loss: 0.6803007
	speed: 0.0057s/iter; left time: 9.2993s
Updating learning rate to 0.00011807292715
Validation loss decreased (0.3011 --> 0.2863).  Saving model state dict ...
Epoch: 2 cost time: 1.5942749977111816
Epoch: 2, Steps: 262 | Train Loss: 0.6848886 Vali Loss: 0.2863034 Best vali loss: 0.2863034
	iters: 100, epoch: 3 | loss: 0.3453226
	speed: 0.0098s/iter; left time: 14.4134s
	iters: 200, epoch: 3 | loss: 0.7908413
	speed: 0.0051s/iter; left time: 7.0251s
Updating learning rate to 5.9036463575e-05
Validation loss decreased (0.2863 --> 0.2836).  Saving model state dict ...
Epoch: 3 cost time: 1.3436055183410645
Epoch: 3, Steps: 262 | Train Loss: 0.5680819 Vali Loss: 0.2836013 Best vali loss: 0.2836013
	iters: 100, epoch: 4 | loss: 0.3317394
	speed: 0.0109s/iter; left time: 13.2114s
	iters: 200, epoch: 4 | loss: 0.3007169
	speed: 0.0049s/iter; left time: 5.4304s
Updating learning rate to 2.95182317875e-05
Validation loss decreased (0.2836 --> 0.2833).  Saving model state dict ...
Epoch: 4 cost time: 1.321028232574463
Epoch: 4, Steps: 262 | Train Loss: 0.3162282 Vali Loss: 0.2832706 Best vali loss: 0.2832706
	iters: 100, epoch: 5 | loss: 0.2573570
	speed: 0.0105s/iter; left time: 9.9648s
	iters: 200, epoch: 5 | loss: 0.4252291
	speed: 0.0046s/iter; left time: 3.9052s
Updating learning rate to 1.475911589375e-05
Validation loss decreased (0.2833 --> 0.2831).  Saving model state dict ...
Epoch: 5 cost time: 1.2507374286651611
Epoch: 5, Steps: 262 | Train Loss: 0.3412931 Vali Loss: 0.2830920 Best vali loss: 0.2830920
	iters: 100, epoch: 6 | loss: 0.3213143
	speed: 0.0108s/iter; left time: 7.3996s
	iters: 200, epoch: 6 | loss: 0.4045420
	speed: 0.0050s/iter; left time: 2.9568s
Updating learning rate to 7.379557946875e-06
Validation loss decreased (0.2831 --> 0.2830).  Saving model state dict ...
Epoch: 6 cost time: 1.390275239944458
Epoch: 6, Steps: 262 | Train Loss: 0.3629282 Vali Loss: 0.2829520 Best vali loss: 0.2829520
	iters: 100, epoch: 7 | loss: 0.4712778
	speed: 0.0113s/iter; left time: 4.7957s
	iters: 200, epoch: 7 | loss: 0.8117055
	speed: 0.0049s/iter; left time: 1.6052s
Updating learning rate to 3.6897789734375e-06
Validation loss decreased (0.2830 --> 0.2829).  Saving model state dict ...
Epoch: 7 cost time: 1.3392362594604492
Epoch: 7, Steps: 262 | Train Loss: 0.6414917 Vali Loss: 0.2829157 Best vali loss: 0.2829157
	iters: 100, epoch: 8 | loss: 0.7449555
	speed: 0.0114s/iter; left time: 1.8662s
	iters: 200, epoch: 8 | loss: 0.2860249
	speed: 0.0056s/iter; left time: 0.3549s
Updating learning rate to 1.84488948671875e-06
Validation loss decreased (0.2829 --> 0.2829).  Saving model state dict ...
Epoch: 8 cost time: 1.5402860641479492
Epoch: 8, Steps: 262 | Train Loss: 0.5154902 Vali Loss: 0.2829035 Best vali loss: 0.2829035

best validation loss 0.2829034705616897

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023127490055, 'e_layers': 1, 'learning_rate': 0.0017907228824, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017907228824
Validation loss decreased (inf --> 0.2870).  Saving model state dict ...
Epoch: 1 cost time: 0.5698018074035645
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2870142 Best vali loss: 0.2870142
Updating learning rate to 0.0008953614412
Epoch: 2 cost time: 0.3361966609954834
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2930027 Best vali loss: 0.2870142
Updating learning rate to 0.0004476807206
Epoch: 3 cost time: 0.31557273864746094
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2948994 Best vali loss: 0.2870142
Updating learning rate to 0.0002238403603
Epoch: 4 cost time: 0.32854318618774414
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2986233 Best vali loss: 0.2870142
Updating learning rate to 0.00011192018015
Epoch: 5 cost time: 0.3343374729156494
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3045263 Best vali loss: 0.2870142
Updating learning rate to 5.5960090075e-05
Epoch: 6 cost time: 0.33246421813964844
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3088843 Best vali loss: 0.2870142
Updating learning rate to 2.79800450375e-05
Epoch: 7 cost time: 0.3333115577697754
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3101610 Best vali loss: 0.2870142
Updating learning rate to 1.399002251875e-05
Epoch: 8 cost time: 0.3368837833404541
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3100159 Best vali loss: 0.2870142

best validation loss 0.2870141746010112

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037670265647, 'e_layers': 4, 'learning_rate': 0.0001328666002, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5304810
	speed: 0.0121s/iter; left time: 49.2666s
	iters: 200, epoch: 1 | loss: 0.5077803
	speed: 0.0061s/iter; left time: 24.3933s
	iters: 300, epoch: 1 | loss: 0.4968972
	speed: 0.0066s/iter; left time: 25.5451s
	iters: 400, epoch: 1 | loss: 0.3481416
	speed: 0.0066s/iter; left time: 24.9464s
	iters: 500, epoch: 1 | loss: 0.6342778
	speed: 0.0066s/iter; left time: 24.3058s
Updating learning rate to 0.00012780966633957002
Validation loss decreased (inf --> 0.2833).  Saving model state dict ...
Epoch: 1 cost time: 3.6728827953338623
Epoch: 1, Steps: 523 | Train Loss: 0.5035156 Vali Loss: 0.2833437 Best vali loss: 0.2833437
	iters: 100, epoch: 2 | loss: 0.6043276
	speed: 0.0135s/iter; left time: 48.0039s
	iters: 200, epoch: 2 | loss: 0.4532321
	speed: 0.0056s/iter; left time: 19.4753s
	iters: 300, epoch: 2 | loss: 0.3269376
	speed: 0.0047s/iter; left time: 15.7552s
	iters: 400, epoch: 2 | loss: 1.0424556
	speed: 0.0048s/iter; left time: 15.5388s
	iters: 500, epoch: 2 | loss: 0.2704322
	speed: 0.0049s/iter; left time: 15.5990s
Updating learning rate to 0.00011340873709731094
Epoch: 2 cost time: 2.8086044788360596
Epoch: 2, Steps: 523 | Train Loss: 0.5394770 Vali Loss: 0.2865962 Best vali loss: 0.2833437
	iters: 100, epoch: 3 | loss: 0.3749867
	speed: 0.0137s/iter; left time: 41.6671s
	iters: 200, epoch: 3 | loss: 0.4525475
	speed: 0.0068s/iter; left time: 20.0068s
	iters: 300, epoch: 3 | loss: 1.1900724
	speed: 0.0068s/iter; left time: 19.2274s
	iters: 400, epoch: 3 | loss: 0.2544502
	speed: 0.0068s/iter; left time: 18.5408s
	iters: 500, epoch: 3 | loss: 0.4338135
	speed: 0.0061s/iter; left time: 16.1201s
Updating learning rate to 9.185622340560807e-05
Validation loss decreased (0.2833 --> 0.2784).  Saving model state dict ...
Epoch: 3 cost time: 3.4868545532226562
Epoch: 3, Steps: 523 | Train Loss: 0.5411741 Vali Loss: 0.2784375 Best vali loss: 0.2784375

best validation loss 0.27843745440167095

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5050727
	speed: 0.0112s/iter; left time: 22.4592s
	iters: 200, epoch: 1 | loss: 0.5558906
	speed: 0.0058s/iter; left time: 11.0278s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.3355).  Saving model state dict ...
Epoch: 1 cost time: 1.7723925113677979
Epoch: 1, Steps: 262 | Train Loss: 0.5304817 Vali Loss: 0.3354548 Best vali loss: 0.3354548
	iters: 100, epoch: 2 | loss: 0.6314496
	speed: 0.0120s/iter; left time: 20.7822s
	iters: 200, epoch: 2 | loss: 0.6633098
	speed: 0.0053s/iter; left time: 8.6869s
Updating learning rate to 0.00164194791575
Validation loss decreased (0.3355 --> 0.3234).  Saving model state dict ...
Epoch: 2 cost time: 1.443742275238037
Epoch: 2, Steps: 262 | Train Loss: 0.6473797 Vali Loss: 0.3234482 Best vali loss: 0.3234482
	iters: 100, epoch: 3 | loss: 0.4414787
	speed: 0.0126s/iter; left time: 18.5975s
	iters: 200, epoch: 3 | loss: 0.7161974
	speed: 0.0057s/iter; left time: 7.7614s
Updating learning rate to 0.000820973957875
Validation loss decreased (0.3234 --> 0.3230).  Saving model state dict ...
Epoch: 3 cost time: 1.532590627670288
Epoch: 3, Steps: 262 | Train Loss: 0.5788381 Vali Loss: 0.3229915 Best vali loss: 0.3229915

best validation loss 0.3229915307728763

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 1, 'learning_rate': 5.33657676e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.33657676e-05
Validation loss decreased (inf --> 0.2926).  Saving model state dict ...
Epoch: 1 cost time: 0.5851445198059082
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2925972 Best vali loss: 0.2925972
Updating learning rate to 2.66828838e-05
Validation loss decreased (0.2926 --> 0.2820).  Saving model state dict ...
Epoch: 2 cost time: 0.35057830810546875
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2819726 Best vali loss: 0.2819726
Updating learning rate to 1.33414419e-05
Validation loss decreased (0.2820 --> 0.2800).  Saving model state dict ...
Epoch: 3 cost time: 0.3537924289703369
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2799744 Best vali loss: 0.2799744

best validation loss 0.2799743693993853

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037670265647, 'e_layers': 4, 'learning_rate': 0.0001328666002, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3915016
	speed: 0.0132s/iter; left time: 33.1015s
	iters: 200, epoch: 4 | loss: 0.4790133
	speed: 0.0072s/iter; left time: 17.4367s
	iters: 300, epoch: 4 | loss: 0.4807956
	speed: 0.0062s/iter; left time: 14.4291s
	iters: 400, epoch: 4 | loss: 0.3430120
	speed: 0.0065s/iter; left time: 14.4262s
	iters: 500, epoch: 4 | loss: 0.5946785
	speed: 0.0068s/iter; left time: 14.4336s
Updating learning rate to 6.64333001e-05
Epoch: 4 cost time: 3.836230993270874
Epoch: 4, Steps: 523 | Train Loss: 0.4578002 Vali Loss: 0.2848218 Best vali loss: 0.2784375
	iters: 100, epoch: 5 | loss: 0.4527068
	speed: 0.0141s/iter; left time: 28.1407s
	iters: 200, epoch: 5 | loss: 0.3440166
	speed: 0.0068s/iter; left time: 12.9213s
	iters: 300, epoch: 5 | loss: 0.2593974
	speed: 0.0065s/iter; left time: 11.6845s
	iters: 400, epoch: 5 | loss: 0.9404444
	speed: 0.0068s/iter; left time: 11.5448s
	iters: 500, epoch: 5 | loss: 0.2531824
	speed: 0.0070s/iter; left time: 11.1719s
Updating learning rate to 4.101037679439195e-05
Epoch: 5 cost time: 3.6024951934814453
Epoch: 5, Steps: 523 | Train Loss: 0.4499495 Vali Loss: 0.2946789 Best vali loss: 0.2784375
	iters: 100, epoch: 6 | loss: 0.3929450
	speed: 0.0141s/iter; left time: 20.6830s
	iters: 200, epoch: 6 | loss: 0.4436143
	speed: 0.0065s/iter; left time: 8.9665s
	iters: 300, epoch: 6 | loss: 0.9751810
	speed: 0.0060s/iter; left time: 7.5684s
	iters: 400, epoch: 6 | loss: 0.2915008
	speed: 0.0069s/iter; left time: 8.0230s
	iters: 500, epoch: 6 | loss: 0.4075094
	speed: 0.0073s/iter; left time: 7.7803s
Updating learning rate to 1.945786310268906e-05
Epoch: 6 cost time: 3.543372869491577
Epoch: 6, Steps: 523 | Train Loss: 0.5021501 Vali Loss: 0.2900558 Best vali loss: 0.2784375
	iters: 100, epoch: 7 | loss: 0.2391995
	speed: 0.0141s/iter; left time: 13.3168s
	iters: 200, epoch: 7 | loss: 0.4761539
	speed: 0.0069s/iter; left time: 5.8432s
	iters: 300, epoch: 7 | loss: 1.5048130
	speed: 0.0059s/iter; left time: 4.4051s
	iters: 400, epoch: 7 | loss: 1.1374484
	speed: 0.0067s/iter; left time: 4.3264s
	iters: 500, epoch: 7 | loss: 0.3600318
	speed: 0.0070s/iter; left time: 3.8103s
Updating learning rate to 5.056933860429982e-06
Epoch: 7 cost time: 3.5069494247436523
Epoch: 7, Steps: 523 | Train Loss: 0.7435293 Vali Loss: 0.2862887 Best vali loss: 0.2784375
	iters: 100, epoch: 8 | loss: 0.2664919
	speed: 0.0141s/iter; left time: 5.9737s
	iters: 200, epoch: 8 | loss: 0.2596497
	speed: 0.0069s/iter; left time: 2.2499s
	iters: 300, epoch: 8 | loss: 0.4516872
	speed: 0.0062s/iter; left time: 1.3883s
	iters: 400, epoch: 8 | loss: 0.3100511
	speed: 0.0052s/iter; left time: 0.6440s
	iters: 500, epoch: 8 | loss: 0.2030515
	speed: 0.0051s/iter; left time: 0.1226s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2443902492523193
Epoch: 8, Steps: 523 | Train Loss: 0.2981863 Vali Loss: 0.2933718 Best vali loss: 0.2784375

best validation loss 0.27843745440167095

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0014486999551, 'e_layers': 4, 'learning_rate': 0.000583131487, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3324378
	speed: 0.0134s/iter; left time: 54.7943s
	iters: 200, epoch: 1 | loss: 0.2030899
	speed: 0.0076s/iter; left time: 30.1383s
	iters: 300, epoch: 1 | loss: 0.7361564
	speed: 0.0075s/iter; left time: 29.0390s
	iters: 400, epoch: 1 | loss: 0.3389674
	speed: 0.0071s/iter; left time: 26.9913s
	iters: 500, epoch: 1 | loss: 0.6768438
	speed: 0.0061s/iter; left time: 22.3314s
Updating learning rate to 0.0005609373663010857
Validation loss decreased (inf --> 0.2877).  Saving model state dict ...
Epoch: 1 cost time: 4.025390863418579
Epoch: 1, Steps: 523 | Train Loss: 0.4574990 Vali Loss: 0.2877439 Best vali loss: 0.2877439
	iters: 100, epoch: 2 | loss: 0.3174813
	speed: 0.0136s/iter; left time: 48.2696s
	iters: 200, epoch: 2 | loss: 0.5678340
	speed: 0.0068s/iter; left time: 23.6209s
	iters: 300, epoch: 2 | loss: 0.3344178
	speed: 0.0068s/iter; left time: 22.7233s
	iters: 400, epoch: 2 | loss: 0.8813381
	speed: 0.0069s/iter; left time: 22.5971s
	iters: 500, epoch: 2 | loss: 0.5996321
	speed: 0.0069s/iter; left time: 21.7909s
Updating learning rate to 0.0004977338578905475
Epoch: 2 cost time: 3.617241621017456
Epoch: 2, Steps: 523 | Train Loss: 0.5401406 Vali Loss: 0.2931225 Best vali loss: 0.2877439
	iters: 100, epoch: 3 | loss: 0.3460999
	speed: 0.0144s/iter; left time: 43.8211s
	iters: 200, epoch: 3 | loss: 0.3271755
	speed: 0.0069s/iter; left time: 20.1416s
	iters: 300, epoch: 3 | loss: 1.2201865
	speed: 0.0065s/iter; left time: 18.4045s
	iters: 400, epoch: 3 | loss: 0.8930188
	speed: 0.0060s/iter; left time: 16.3342s
	iters: 500, epoch: 3 | loss: 0.3393368
	speed: 0.0061s/iter; left time: 16.1594s
Updating learning rate to 0.0004031431229826594
Validation loss decreased (0.2877 --> 0.2863).  Saving model state dict ...
Epoch: 3 cost time: 3.4569685459136963
Epoch: 3, Steps: 523 | Train Loss: 0.6251635 Vali Loss: 0.2863193 Best vali loss: 0.2863193
	iters: 100, epoch: 4 | loss: 0.2965872
	speed: 0.0153s/iter; left time: 38.4349s
	iters: 200, epoch: 4 | loss: 0.2384527
	speed: 0.0078s/iter; left time: 18.7312s
	iters: 300, epoch: 4 | loss: 0.5440807
	speed: 0.0076s/iter; left time: 17.7063s
	iters: 400, epoch: 4 | loss: 0.3423190
	speed: 0.0076s/iter; left time: 16.8735s
	iters: 500, epoch: 4 | loss: 0.5317898
	speed: 0.0074s/iter; left time: 15.7229s
Updating learning rate to 0.0002915657435
Epoch: 4 cost time: 4.011286735534668
Epoch: 4, Steps: 523 | Train Loss: 0.3906459 Vali Loss: 0.2880393 Best vali loss: 0.2863193
	iters: 100, epoch: 5 | loss: 0.2575597
	speed: 0.0150s/iter; left time: 29.8690s
	iters: 200, epoch: 5 | loss: 0.4083360
	speed: 0.0067s/iter; left time: 12.7409s
	iters: 300, epoch: 5 | loss: 0.5289878
	speed: 0.0063s/iter; left time: 11.3569s
	iters: 400, epoch: 5 | loss: 0.3515736
	speed: 0.0073s/iter; left time: 12.2775s
	iters: 500, epoch: 5 | loss: 0.6613151
	speed: 0.0076s/iter; left time: 12.1433s
Updating learning rate to 0.00017998836401734064
Epoch: 5 cost time: 3.778326988220215
Epoch: 5, Steps: 523 | Train Loss: 0.4415544 Vali Loss: 0.2986002 Best vali loss: 0.2863193
	iters: 100, epoch: 6 | loss: 0.3414506
	speed: 0.0156s/iter; left time: 22.9002s
	iters: 200, epoch: 6 | loss: 0.3943139
	speed: 0.0073s/iter; left time: 10.0406s
	iters: 300, epoch: 6 | loss: 0.2377049
	speed: 0.0073s/iter; left time: 9.3158s
	iters: 400, epoch: 6 | loss: 0.3045202
	speed: 0.0073s/iter; left time: 8.5870s
	iters: 500, epoch: 6 | loss: 0.2082004
	speed: 0.0073s/iter; left time: 7.8097s
Updating learning rate to 8.539762910945248e-05
Epoch: 6 cost time: 3.892202377319336
Epoch: 6, Steps: 523 | Train Loss: 0.2972380 Vali Loss: 0.3016765 Best vali loss: 0.2863193
	iters: 100, epoch: 7 | loss: 0.1741713
	speed: 0.0128s/iter; left time: 12.1121s
	iters: 200, epoch: 7 | loss: 0.3181073
	speed: 0.0075s/iter; left time: 6.3119s
	iters: 300, epoch: 7 | loss: 0.3054190
	speed: 0.0075s/iter; left time: 5.5957s
	iters: 400, epoch: 7 | loss: 0.1784037
	speed: 0.0075s/iter; left time: 4.8581s
	iters: 500, epoch: 7 | loss: 0.1871502
	speed: 0.0075s/iter; left time: 4.1239s
Updating learning rate to 2.219412069891426e-05
Epoch: 7 cost time: 3.8133015632629395
Epoch: 7, Steps: 523 | Train Loss: 0.2326503 Vali Loss: 0.3058696 Best vali loss: 0.2863193
	iters: 100, epoch: 8 | loss: 0.4525913
	speed: 0.0157s/iter; left time: 6.6733s
	iters: 200, epoch: 8 | loss: 0.3376772
	speed: 0.0075s/iter; left time: 2.4273s
	iters: 300, epoch: 8 | loss: 0.1944120
	speed: 0.0074s/iter; left time: 1.6519s
	iters: 400, epoch: 8 | loss: 0.1191515
	speed: 0.0066s/iter; left time: 0.8151s
	iters: 500, epoch: 8 | loss: 0.2232130
	speed: 0.0062s/iter; left time: 0.1498s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.746962547302246
Epoch: 8, Steps: 523 | Train Loss: 0.2654090 Vali Loss: 0.3102292 Best vali loss: 0.2863193

best validation loss 0.28631926846907635

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.011623072433, 'e_layers': 3, 'learning_rate': 0.0006327740511, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7223424
	speed: 0.0120s/iter; left time: 99.2281s
	iters: 200, epoch: 1 | loss: 0.1649178
	speed: 0.0063s/iter; left time: 51.6892s
	iters: 300, epoch: 1 | loss: 0.3260550
	speed: 0.0063s/iter; left time: 50.9184s
	iters: 400, epoch: 1 | loss: 0.5278106
	speed: 0.0063s/iter; left time: 50.3438s
	iters: 500, epoch: 1 | loss: 0.2368421
	speed: 0.0063s/iter; left time: 49.8455s
	iters: 600, epoch: 1 | loss: 0.4883126
	speed: 0.0063s/iter; left time: 49.1099s
	iters: 700, epoch: 1 | loss: 0.4591462
	speed: 0.0063s/iter; left time: 48.5193s
	iters: 800, epoch: 1 | loss: 0.3006119
	speed: 0.0056s/iter; left time: 42.1138s
	iters: 900, epoch: 1 | loss: 0.4353257
	speed: 0.0056s/iter; left time: 41.6205s
	iters: 1000, epoch: 1 | loss: 1.6995574
	speed: 0.0057s/iter; left time: 41.6505s
Updating learning rate to 0.0006086905228077705
Validation loss decreased (inf --> 0.3236).  Saving model state dict ...
Epoch: 1 cost time: 6.684769868850708
Epoch: 1, Steps: 1045 | Train Loss: 0.5360922 Vali Loss: 0.3236079 Best vali loss: 0.3236079
	iters: 100, epoch: 2 | loss: 1.4619209
	speed: 0.0204s/iter; left time: 147.5073s
	iters: 200, epoch: 2 | loss: 0.3875399
	speed: 0.0062s/iter; left time: 44.0087s
	iters: 300, epoch: 2 | loss: 0.7891307
	speed: 0.0063s/iter; left time: 43.9616s
	iters: 400, epoch: 2 | loss: 0.3222163
	speed: 0.0063s/iter; left time: 43.4014s
	iters: 500, epoch: 2 | loss: 0.3532518
	speed: 0.0063s/iter; left time: 42.6886s
	iters: 600, epoch: 2 | loss: 0.4909748
	speed: 0.0062s/iter; left time: 41.5318s
	iters: 700, epoch: 2 | loss: 0.3960843
	speed: 0.0062s/iter; left time: 40.8847s
	iters: 800, epoch: 2 | loss: 0.7880397
	speed: 0.0053s/iter; left time: 34.8470s
	iters: 900, epoch: 2 | loss: 0.2350413
	speed: 0.0054s/iter; left time: 34.7231s
	iters: 1000, epoch: 2 | loss: 0.3289700
	speed: 0.0061s/iter; left time: 38.5498s
Updating learning rate to 0.0005401064367958465
Validation loss decreased (0.3236 --> 0.3212).  Saving model state dict ...
Epoch: 2 cost time: 6.362520217895508
Epoch: 2, Steps: 1045 | Train Loss: 0.5553170 Vali Loss: 0.3211695 Best vali loss: 0.3211695
	iters: 100, epoch: 3 | loss: 0.4673275
	speed: 0.0206s/iter; left time: 127.1366s
	iters: 200, epoch: 3 | loss: 0.8357317
	speed: 0.0063s/iter; left time: 38.2707s
	iters: 300, epoch: 3 | loss: 1.2023228
	speed: 0.0063s/iter; left time: 37.7499s
	iters: 400, epoch: 3 | loss: 0.5334120
	speed: 0.0063s/iter; left time: 37.1031s
	iters: 500, epoch: 3 | loss: 0.2826115
	speed: 0.0063s/iter; left time: 36.4358s
	iters: 600, epoch: 3 | loss: 0.2637189
	speed: 0.0063s/iter; left time: 35.8348s
	iters: 700, epoch: 3 | loss: 0.2995356
	speed: 0.0061s/iter; left time: 33.9251s
	iters: 800, epoch: 3 | loss: 0.3526329
	speed: 0.0053s/iter; left time: 29.1041s
	iters: 900, epoch: 3 | loss: 0.5028128
	speed: 0.0052s/iter; left time: 27.8970s
	iters: 1000, epoch: 3 | loss: 0.5803228
	speed: 0.0046s/iter; left time: 24.1940s
Updating learning rate to 0.00043746309844325536
Validation loss decreased (0.3212 --> 0.3172).  Saving model state dict ...
Epoch: 3 cost time: 6.144686460494995
Epoch: 3, Steps: 1045 | Train Loss: 0.5320429 Vali Loss: 0.3172039 Best vali loss: 0.3172039
	iters: 100, epoch: 4 | loss: 0.3645914
	speed: 0.0179s/iter; left time: 91.8488s
	iters: 200, epoch: 4 | loss: 0.1481199
	speed: 0.0044s/iter; left time: 22.0636s
	iters: 300, epoch: 4 | loss: 0.2991597
	speed: 0.0050s/iter; left time: 24.4981s
	iters: 400, epoch: 4 | loss: 0.2125968
	speed: 0.0057s/iter; left time: 27.7357s
	iters: 500, epoch: 4 | loss: 0.6834602
	speed: 0.0058s/iter; left time: 27.2784s
	iters: 600, epoch: 4 | loss: 0.3783728
	speed: 0.0058s/iter; left time: 26.6189s
	iters: 700, epoch: 4 | loss: 0.6401788
	speed: 0.0058s/iter; left time: 26.1685s
	iters: 800, epoch: 4 | loss: 0.1815351
	speed: 0.0058s/iter; left time: 25.7865s
	iters: 900, epoch: 4 | loss: 0.2654836
	speed: 0.0058s/iter; left time: 25.1705s
	iters: 1000, epoch: 4 | loss: 0.6937017
	speed: 0.0054s/iter; left time: 22.8226s
Updating learning rate to 0.00031638702555
Epoch: 4 cost time: 5.797900676727295
Epoch: 4, Steps: 1045 | Train Loss: 0.3867200 Vali Loss: 0.3199349 Best vali loss: 0.3172039
	iters: 100, epoch: 5 | loss: 1.1871619
	speed: 0.0172s/iter; left time: 70.0958s
	iters: 200, epoch: 5 | loss: 0.2725976
	speed: 0.0058s/iter; left time: 23.0360s
	iters: 300, epoch: 5 | loss: 0.4726907
	speed: 0.0058s/iter; left time: 22.6297s
	iters: 400, epoch: 5 | loss: 1.4732221
	speed: 0.0058s/iter; left time: 21.8676s
	iters: 500, epoch: 5 | loss: 0.3924008
	speed: 0.0052s/iter; left time: 18.9928s
	iters: 600, epoch: 5 | loss: 0.4535338
	speed: 0.0049s/iter; left time: 17.4374s
	iters: 700, epoch: 5 | loss: 0.4003898
	speed: 0.0054s/iter; left time: 18.7542s
	iters: 800, epoch: 5 | loss: 0.2893388
	speed: 0.0053s/iter; left time: 17.9279s
	iters: 900, epoch: 5 | loss: 0.9914086
	speed: 0.0053s/iter; left time: 17.4062s
	iters: 1000, epoch: 5 | loss: 0.3301351
	speed: 0.0053s/iter; left time: 16.9191s
Updating learning rate to 0.00019531095265674467
Epoch: 5 cost time: 5.738284349441528
Epoch: 5, Steps: 1045 | Train Loss: 0.6262879 Vali Loss: 0.3264249 Best vali loss: 0.3172039
	iters: 100, epoch: 6 | loss: 0.9240358
	speed: 0.0166s/iter; left time: 50.2966s
	iters: 200, epoch: 6 | loss: 1.3226061
	speed: 0.0048s/iter; left time: 14.0324s
	iters: 300, epoch: 6 | loss: 0.5490549
	speed: 0.0039s/iter; left time: 11.0609s
	iters: 400, epoch: 6 | loss: 0.3598462
	speed: 0.0038s/iter; left time: 10.3635s
	iters: 500, epoch: 6 | loss: 0.4565946
	speed: 0.0047s/iter; left time: 12.2728s
	iters: 600, epoch: 6 | loss: 0.3130230
	speed: 0.0055s/iter; left time: 13.8645s
	iters: 700, epoch: 6 | loss: 0.3436859
	speed: 0.0054s/iter; left time: 13.2424s
	iters: 800, epoch: 6 | loss: 0.2897647
	speed: 0.0053s/iter; left time: 12.4684s
	iters: 900, epoch: 6 | loss: 0.4865098
	speed: 0.0054s/iter; left time: 12.1144s
	iters: 1000, epoch: 6 | loss: 0.3924879
	speed: 0.0053s/iter; left time: 11.3966s
Updating learning rate to 9.266761430415355e-05
Epoch: 6 cost time: 5.196892023086548
Epoch: 6, Steps: 1045 | Train Loss: 0.5437609 Vali Loss: 0.3231575 Best vali loss: 0.3172039
	iters: 100, epoch: 7 | loss: 0.2198576
	speed: 0.0169s/iter; left time: 33.5510s
	iters: 200, epoch: 7 | loss: 0.9395180
	speed: 0.0055s/iter; left time: 10.4455s
	iters: 300, epoch: 7 | loss: 0.2049790
	speed: 0.0055s/iter; left time: 9.9077s
	iters: 400, epoch: 7 | loss: 0.2961225
	speed: 0.0055s/iter; left time: 9.3077s
	iters: 500, epoch: 7 | loss: 0.6739258
	speed: 0.0056s/iter; left time: 8.8473s
	iters: 600, epoch: 7 | loss: 0.3039221
	speed: 0.0056s/iter; left time: 8.2948s
	iters: 700, epoch: 7 | loss: 0.4051992
	speed: 0.0055s/iter; left time: 7.7027s
	iters: 800, epoch: 7 | loss: 0.3621324
	speed: 0.0051s/iter; left time: 6.5253s
	iters: 900, epoch: 7 | loss: 0.5254241
	speed: 0.0050s/iter; left time: 5.9615s
	iters: 1000, epoch: 7 | loss: 0.6893334
	speed: 0.0054s/iter; left time: 5.8731s
Updating learning rate to 2.4083528292229468e-05
Epoch: 7 cost time: 5.694912910461426
Epoch: 7, Steps: 1045 | Train Loss: 0.4620414 Vali Loss: 0.3230205 Best vali loss: 0.3172039
	iters: 100, epoch: 8 | loss: 0.3889811
	speed: 0.0175s/iter; left time: 16.5088s
	iters: 200, epoch: 8 | loss: 0.4240208
	speed: 0.0059s/iter; left time: 5.0067s
	iters: 300, epoch: 8 | loss: 0.2123330
	speed: 0.0060s/iter; left time: 4.4534s
	iters: 400, epoch: 8 | loss: 0.6042755
	speed: 0.0048s/iter; left time: 3.1320s
	iters: 500, epoch: 8 | loss: 0.2384625
	speed: 0.0041s/iter; left time: 2.2655s
	iters: 600, epoch: 8 | loss: 1.1927876
	speed: 0.0038s/iter; left time: 1.6921s
	iters: 700, epoch: 8 | loss: 0.3761415
	speed: 0.0045s/iter; left time: 1.5593s
	iters: 800, epoch: 8 | loss: 0.2731064
	speed: 0.0054s/iter; left time: 1.3378s
	iters: 900, epoch: 8 | loss: 0.3628518
	speed: 0.0054s/iter; left time: 0.7921s
	iters: 1000, epoch: 8 | loss: 0.3462715
	speed: 0.0058s/iter; left time: 0.2689s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.4423158168792725
Epoch: 8, Steps: 1045 | Train Loss: 0.4419232 Vali Loss: 0.3227059 Best vali loss: 0.3172039

best validation loss 0.31720387044007026

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005459653869797237
Validation loss decreased (inf --> 0.2832).  Saving model state dict ...
Epoch: 1 cost time: 0.651310920715332
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2832203 Best vali loss: 0.2832203
Updating learning rate to 0.0004844488434208944
Validation loss decreased (0.2832 --> 0.2772).  Saving model state dict ...
Epoch: 2 cost time: 0.3624591827392578
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2771840 Best vali loss: 0.2771840
Updating learning rate to 0.00039238282983148796
Epoch: 3 cost time: 0.4215860366821289
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2872559 Best vali loss: 0.2771840

best validation loss 0.2771839661064446

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008402255115, 'e_layers': 4, 'learning_rate': 0.0005990276297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3810405
	speed: 0.0132s/iter; left time: 54.0420s
	iters: 200, epoch: 1 | loss: 0.2463874
	speed: 0.0079s/iter; left time: 31.5191s
	iters: 300, epoch: 1 | loss: 0.6465948
	speed: 0.0086s/iter; left time: 33.2473s
	iters: 400, epoch: 1 | loss: 0.3780552
	speed: 0.0078s/iter; left time: 29.4652s
	iters: 500, epoch: 1 | loss: 0.2966061
	speed: 0.0079s/iter; left time: 29.0827s
Updating learning rate to 0.00057622849809429
Validation loss decreased (inf --> 0.2919).  Saving model state dict ...
Epoch: 1 cost time: 4.4868385791778564
Epoch: 1, Steps: 523 | Train Loss: 0.3897368 Vali Loss: 0.2919187 Best vali loss: 0.2919187
	iters: 100, epoch: 2 | loss: 0.6645492
	speed: 0.0162s/iter; left time: 57.5938s
	iters: 200, epoch: 2 | loss: 1.5146888
	speed: 0.0050s/iter; left time: 17.2715s
	iters: 300, epoch: 2 | loss: 0.4669957
	speed: 0.0054s/iter; left time: 18.3066s
	iters: 400, epoch: 2 | loss: 0.5343962
	speed: 0.0082s/iter; left time: 26.6424s
	iters: 500, epoch: 2 | loss: 1.1601447
	speed: 0.0072s/iter; left time: 22.6870s
Updating learning rate to 0.000511302064389487
Validation loss decreased (0.2919 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 3.5757625102996826
Epoch: 2, Steps: 523 | Train Loss: 0.8681549 Vali Loss: 0.2833919 Best vali loss: 0.2833919
	iters: 100, epoch: 3 | loss: 0.3346428
	speed: 0.0174s/iter; left time: 52.8715s
	iters: 200, epoch: 3 | loss: 1.0346019
	speed: 0.0070s/iter; left time: 20.6310s
	iters: 300, epoch: 3 | loss: 0.5872782
	speed: 0.0082s/iter; left time: 23.3190s
	iters: 400, epoch: 3 | loss: 0.4259831
	speed: 0.0073s/iter; left time: 20.1239s
	iters: 500, epoch: 3 | loss: 0.3107795
	speed: 0.0078s/iter; left time: 20.4619s
Updating learning rate to 0.00041413278955756
Epoch: 3 cost time: 4.02117919921875
Epoch: 3, Steps: 523 | Train Loss: 0.5386571 Vali Loss: 0.2992097 Best vali loss: 0.2833919

best validation loss 0.28339187850203823

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0055356354333, 'e_layers': 4, 'learning_rate': 0.0007477641146, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3133886
	speed: 0.0136s/iter; left time: 55.5513s
	iters: 200, epoch: 1 | loss: 0.2810241
	speed: 0.0083s/iter; left time: 33.1423s
	iters: 300, epoch: 1 | loss: 0.4743370
	speed: 0.0056s/iter; left time: 21.8174s
	iters: 400, epoch: 1 | loss: 0.6928607
	speed: 0.0046s/iter; left time: 17.5787s
	iters: 500, epoch: 1 | loss: 0.4289139
	speed: 0.0045s/iter; left time: 16.6007s
Updating learning rate to 0.0007477641146
Validation loss decreased (inf --> 0.2851).  Saving model state dict ...
Epoch: 1 cost time: 3.4885241985321045
Epoch: 1, Steps: 523 | Train Loss: 0.4381048 Vali Loss: 0.2851372 Best vali loss: 0.2851372
	iters: 100, epoch: 2 | loss: 0.7499826
	speed: 0.0107s/iter; left time: 38.0903s
	iters: 200, epoch: 2 | loss: 0.3054490
	speed: 0.0057s/iter; left time: 19.7953s
	iters: 300, epoch: 2 | loss: 0.4111134
	speed: 0.0046s/iter; left time: 15.6285s
	iters: 400, epoch: 2 | loss: 0.3953643
	speed: 0.0059s/iter; left time: 19.1810s
	iters: 500, epoch: 2 | loss: 0.9207377
	speed: 0.0089s/iter; left time: 28.1170s
Updating learning rate to 0.0003738820573
Epoch: 2 cost time: 3.3217051029205322
Epoch: 2, Steps: 523 | Train Loss: 0.5565294 Vali Loss: 0.2920170 Best vali loss: 0.2851372
	iters: 100, epoch: 3 | loss: 0.4925419
	speed: 0.0193s/iter; left time: 58.5614s
	iters: 200, epoch: 3 | loss: 0.4401364
	speed: 0.0095s/iter; left time: 27.8545s
	iters: 300, epoch: 3 | loss: 0.5408964
	speed: 0.0090s/iter; left time: 25.5226s
	iters: 400, epoch: 3 | loss: 0.6977554
	speed: 0.0081s/iter; left time: 22.1706s
	iters: 500, epoch: 3 | loss: 0.2444391
	speed: 0.0102s/iter; left time: 26.9074s
Updating learning rate to 0.00018694102865
Epoch: 3 cost time: 4.7450103759765625
Epoch: 3, Steps: 523 | Train Loss: 0.4831538 Vali Loss: 0.2862994 Best vali loss: 0.2851372

best validation loss 0.2851372060527718

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002837835622
Epoch: 4 cost time: 0.5790927410125732
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2862452 Best vali loss: 0.2771840
Updating learning rate to 0.00017518429456851207
Epoch: 5 cost time: 0.3780393600463867
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2887568 Best vali loss: 0.2771840
Updating learning rate to 8.311828097910562e-05
Epoch: 6 cost time: 0.3699314594268799
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2879190 Best vali loss: 0.2771840
Updating learning rate to 2.1601737420276337e-05
Epoch: 7 cost time: 0.3998830318450928
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2879844 Best vali loss: 0.2771840
Updating learning rate to 0.0
Epoch: 8 cost time: 0.36554574966430664
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2835453 Best vali loss: 0.2771840

best validation loss 0.2771839661064446

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4685515
	speed: 0.0087s/iter; left time: 17.4060s
	iters: 200, epoch: 1 | loss: 0.6288681
	speed: 0.0030s/iter; left time: 5.7188s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.0745489597320557
Epoch: 1, Steps: 262 | Train Loss: 0.5487098 Vali Loss: 0.2812864 Best vali loss: 0.2812864
	iters: 100, epoch: 2 | loss: 0.3859093
	speed: 0.0079s/iter; left time: 13.7863s
	iters: 200, epoch: 2 | loss: 0.6056238
	speed: 0.0030s/iter; left time: 4.9502s
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 0.8519823551177979
Epoch: 2, Steps: 262 | Train Loss: 0.4957666 Vali Loss: 0.2835033 Best vali loss: 0.2812864
	iters: 100, epoch: 3 | loss: 0.6014801
	speed: 0.0076s/iter; left time: 11.2105s
	iters: 200, epoch: 3 | loss: 0.4612538
	speed: 0.0030s/iter; left time: 4.1463s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.8370954990386963
Epoch: 3, Steps: 262 | Train Loss: 0.5313669 Vali Loss: 0.2853745 Best vali loss: 0.2812864
	iters: 100, epoch: 4 | loss: 0.3968066
	speed: 0.0078s/iter; left time: 9.4562s
	iters: 200, epoch: 4 | loss: 0.4811746
	speed: 0.0030s/iter; left time: 3.3736s
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.8413426876068115
Epoch: 4, Steps: 262 | Train Loss: 0.4389906 Vali Loss: 0.2970574 Best vali loss: 0.2812864
	iters: 100, epoch: 5 | loss: 0.3920619
	speed: 0.0076s/iter; left time: 7.2255s
	iters: 200, epoch: 5 | loss: 0.2992450
	speed: 0.0031s/iter; left time: 2.6098s
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.8497951030731201
Epoch: 5, Steps: 262 | Train Loss: 0.3456535 Vali Loss: 0.2961481 Best vali loss: 0.2812864
	iters: 100, epoch: 6 | loss: 0.4867197
	speed: 0.0080s/iter; left time: 5.4919s
	iters: 200, epoch: 6 | loss: 0.3946985
	speed: 0.0029s/iter; left time: 1.6948s
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.8064262866973877
Epoch: 6, Steps: 262 | Train Loss: 0.4407091 Vali Loss: 0.3040890 Best vali loss: 0.2812864
	iters: 100, epoch: 7 | loss: 0.4573652
	speed: 0.0074s/iter; left time: 3.1594s
	iters: 200, epoch: 7 | loss: 0.2858271
	speed: 0.0030s/iter; left time: 0.9682s
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.8180632591247559
Epoch: 7, Steps: 262 | Train Loss: 0.3715962 Vali Loss: 0.3015124 Best vali loss: 0.2812864
	iters: 100, epoch: 8 | loss: 0.3099633
	speed: 0.0076s/iter; left time: 1.2407s
	iters: 200, epoch: 8 | loss: 0.3661200
	speed: 0.0028s/iter; left time: 0.1789s
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.7893078327178955
Epoch: 8, Steps: 262 | Train Loss: 0.3380416 Vali Loss: 0.3017481 Best vali loss: 0.2812864

best validation loss 0.2812864411803771

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6228932
	speed: 0.0119s/iter; left time: 11.2468s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 1.105036735534668
Epoch: 1, Steps: 131 | Train Loss: 0.6228932 Vali Loss: 0.2812964 Best vali loss: 0.2812964
	iters: 100, epoch: 2 | loss: 0.4512645
	speed: 0.0162s/iter; left time: 13.2901s
Updating learning rate to 6.252043389458952e-05
Epoch: 2 cost time: 1.6142055988311768
Epoch: 2, Steps: 131 | Train Loss: 0.4512645 Vali Loss: 0.2815182 Best vali loss: 0.2812964
	iters: 100, epoch: 3 | loss: 0.5318508
	speed: 0.0184s/iter; left time: 12.6155s
Updating learning rate to 5.063887571827247e-05
Validation loss decreased (0.2813 --> 0.2801).  Saving model state dict ...
Epoch: 3 cost time: 1.5118002891540527
Epoch: 3, Steps: 131 | Train Loss: 0.5318508 Vali Loss: 0.2800840 Best vali loss: 0.2800840
	iters: 100, epoch: 4 | loss: 0.6210665
	speed: 0.0178s/iter; left time: 9.9167s
Updating learning rate to 3.662362225e-05
Epoch: 4 cost time: 1.6363685131072998
Epoch: 4, Steps: 131 | Train Loss: 0.6210665 Vali Loss: 0.2817625 Best vali loss: 0.2800840
	iters: 100, epoch: 5 | loss: 0.4864333
	speed: 0.0182s/iter; left time: 7.7422s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.2801 --> 0.2792).  Saving model state dict ...
Epoch: 5 cost time: 1.4793651103973389
Epoch: 5, Steps: 131 | Train Loss: 0.4864333 Vali Loss: 0.2792378 Best vali loss: 0.2792378
	iters: 100, epoch: 6 | loss: 0.6838748
	speed: 0.0181s/iter; left time: 5.3217s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.2792 --> 0.2775).  Saving model state dict ...
Epoch: 6 cost time: 1.6186323165893555
Epoch: 6, Steps: 131 | Train Loss: 0.6838748 Vali Loss: 0.2774889 Best vali loss: 0.2774889
	iters: 100, epoch: 7 | loss: 0.4988169
	speed: 0.0181s/iter; left time: 2.9521s
Updating learning rate to 2.7878072468000404e-06
Epoch: 7 cost time: 1.474466323852539
Epoch: 7, Steps: 131 | Train Loss: 0.4988169 Vali Loss: 0.2777498 Best vali loss: 0.2774889
	iters: 100, epoch: 8 | loss: 0.6173629
	speed: 0.0181s/iter; left time: 0.5806s
Updating learning rate to 0.0
Validation loss decreased (0.2775 --> 0.2770).  Saving model state dict ...
Epoch: 8 cost time: 1.62717866897583
Epoch: 8, Steps: 131 | Train Loss: 0.6173629 Vali Loss: 0.2769806 Best vali loss: 0.2769806

best validation loss 0.2769806071500789

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.002861454165, 'e_layers': 1, 'learning_rate': 5.78622565e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.78622565e-05
Validation loss decreased (inf --> 0.3469).  Saving model state dict ...
Epoch: 1 cost time: 0.6930983066558838
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3469298 Best vali loss: 0.3469298
Updating learning rate to 2.893112825e-05
Validation loss decreased (0.3469 --> 0.3319).  Saving model state dict ...
Epoch: 2 cost time: 0.31570863723754883
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3318597 Best vali loss: 0.3318597
Updating learning rate to 1.4465564125e-05
Validation loss decreased (0.3319 --> 0.3256).  Saving model state dict ...
Epoch: 3 cost time: 0.2884857654571533
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3256437 Best vali loss: 0.3256437

best validation loss 0.32564369783320807

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 4, 'learning_rate': 0.0001249829864, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5538408
	speed: 0.0135s/iter; left time: 26.8804s
	iters: 200, epoch: 1 | loss: 0.4459568
	speed: 0.0079s/iter; left time: 14.9733s
Updating learning rate to 0.0001249829864
Validation loss decreased (inf --> 0.2776).  Saving model state dict ...
Epoch: 1 cost time: 2.3398728370666504
Epoch: 1, Steps: 262 | Train Loss: 0.4998988 Vali Loss: 0.2775658 Best vali loss: 0.2775658
	iters: 100, epoch: 2 | loss: 0.4674542
	speed: 0.0174s/iter; left time: 30.2462s
	iters: 200, epoch: 2 | loss: 0.6855592
	speed: 0.0077s/iter; left time: 12.5393s
Updating learning rate to 6.24914932e-05
Epoch: 2 cost time: 2.083055257797241
Epoch: 2, Steps: 262 | Train Loss: 0.5765067 Vali Loss: 0.2796102 Best vali loss: 0.2775658
	iters: 100, epoch: 3 | loss: 0.4533909
	speed: 0.0152s/iter; left time: 22.3862s
	iters: 200, epoch: 3 | loss: 0.3944576
	speed: 0.0082s/iter; left time: 11.3046s
Updating learning rate to 3.12457466e-05
Validation loss decreased (0.2776 --> 0.2737).  Saving model state dict ...
Epoch: 3 cost time: 2.055281162261963
Epoch: 3, Steps: 262 | Train Loss: 0.4239243 Vali Loss: 0.2736911 Best vali loss: 0.2736911

best validation loss 0.27369105922284737

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0029426146637, 'e_layers': 4, 'learning_rate': 0.0001092263501, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1278145
	speed: 0.0112s/iter; left time: 45.8247s
	iters: 200, epoch: 1 | loss: 0.7355625
	speed: 0.0057s/iter; left time: 22.6958s
	iters: 300, epoch: 1 | loss: 0.7925915
	speed: 0.0060s/iter; left time: 23.4573s
	iters: 400, epoch: 1 | loss: 0.3267637
	speed: 0.0060s/iter; left time: 22.7006s
	iters: 500, epoch: 1 | loss: 0.6623672
	speed: 0.0060s/iter; left time: 22.1814s
Updating learning rate to 0.00010506916968415107
Validation loss decreased (inf --> 0.3038).  Saving model state dict ...
Epoch: 1 cost time: 3.373926877975464
Epoch: 1, Steps: 523 | Train Loss: 0.7290199 Vali Loss: 0.3038331 Best vali loss: 0.3038331
	iters: 100, epoch: 2 | loss: 0.4430337
	speed: 0.0123s/iter; left time: 43.9738s
	iters: 200, epoch: 2 | loss: 0.2885084
	speed: 0.0059s/iter; left time: 20.3512s
	iters: 300, epoch: 2 | loss: 0.3600284
	speed: 0.0061s/iter; left time: 20.6023s
	iters: 400, epoch: 2 | loss: 0.4784173
	speed: 0.0059s/iter; left time: 19.2483s
	iters: 500, epoch: 2 | loss: 1.0311530
	speed: 0.0059s/iter; left time: 18.6111s
Updating learning rate to 9.323052146998297e-05
Validation loss decreased (0.3038 --> 0.2917).  Saving model state dict ...
Epoch: 2 cost time: 3.1368510723114014
Epoch: 2, Steps: 523 | Train Loss: 0.5202282 Vali Loss: 0.2917103 Best vali loss: 0.2917103
	iters: 100, epoch: 3 | loss: 0.4530086
	speed: 0.0121s/iter; left time: 36.7417s
	iters: 200, epoch: 3 | loss: 0.4331096
	speed: 0.0058s/iter; left time: 17.1222s
	iters: 300, epoch: 3 | loss: 0.3862438
	speed: 0.0060s/iter; left time: 16.9979s
	iters: 400, epoch: 3 | loss: 0.3934397
	speed: 0.0060s/iter; left time: 16.4893s
	iters: 500, epoch: 3 | loss: 0.2468461
	speed: 0.0061s/iter; left time: 16.0776s
Updating learning rate to 7.55127323304895e-05
Validation loss decreased (0.2917 --> 0.2865).  Saving model state dict ...
Epoch: 3 cost time: 3.135944128036499
Epoch: 3, Steps: 523 | Train Loss: 0.3825296 Vali Loss: 0.2864592 Best vali loss: 0.2864592

best validation loss 0.2864591735874068

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 4, 'learning_rate': 0.0001249829864, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4520640
	speed: 0.0145s/iter; left time: 17.5495s
	iters: 200, epoch: 4 | loss: 0.3386595
	speed: 0.0084s/iter; left time: 9.3090s
Updating learning rate to 1.56228733e-05
Epoch: 4 cost time: 2.4790406227111816
Epoch: 4, Steps: 262 | Train Loss: 0.3953617 Vali Loss: 0.2908692 Best vali loss: 0.2736911
	iters: 100, epoch: 5 | loss: 0.4250780
	speed: 0.0168s/iter; left time: 15.9598s
	iters: 200, epoch: 5 | loss: 0.4993829
	speed: 0.0077s/iter; left time: 6.5245s
Updating learning rate to 7.81143665e-06
Epoch: 5 cost time: 2.1332221031188965
Epoch: 5, Steps: 262 | Train Loss: 0.4622304 Vali Loss: 0.3064852 Best vali loss: 0.2736911
	iters: 100, epoch: 6 | loss: 0.4253081
	speed: 0.0173s/iter; left time: 11.9034s
	iters: 200, epoch: 6 | loss: 0.3772638
	speed: 0.0084s/iter; left time: 4.9301s
Updating learning rate to 3.905718325e-06
Epoch: 6 cost time: 2.247957468032837
Epoch: 6, Steps: 262 | Train Loss: 0.4012859 Vali Loss: 0.3065683 Best vali loss: 0.2736911
	iters: 100, epoch: 7 | loss: 0.4281920
	speed: 0.0171s/iter; left time: 7.2629s
	iters: 200, epoch: 7 | loss: 0.3816702
	speed: 0.0079s/iter; left time: 2.5567s
Updating learning rate to 1.9528591625e-06
Epoch: 7 cost time: 2.1608288288116455
Epoch: 7, Steps: 262 | Train Loss: 0.4049311 Vali Loss: 0.3050657 Best vali loss: 0.2736911
	iters: 100, epoch: 8 | loss: 0.3462031
	speed: 0.0174s/iter; left time: 2.8287s
	iters: 200, epoch: 8 | loss: 0.5732151
	speed: 0.0084s/iter; left time: 0.5305s
Updating learning rate to 9.7642958125e-07
Epoch: 8 cost time: 2.249701499938965
Epoch: 8, Steps: 262 | Train Loss: 0.4597091 Vali Loss: 0.3064253 Best vali loss: 0.2736911

best validation loss 0.27369105922284737

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0044504804088, 'e_layers': 1, 'learning_rate': 0.0002904810984, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00027942531989657855
Validation loss decreased (inf --> 0.3102).  Saving model state dict ...
Epoch: 1 cost time: 0.5184729099273682
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3101783 Best vali loss: 0.3101783
Updating learning rate to 0.00024794112644257836
Validation loss decreased (0.3102 --> 0.2916).  Saving model state dict ...
Epoch: 2 cost time: 0.2980384826660156
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2915943 Best vali loss: 0.2915943
Updating learning rate to 0.0002008217010864467
Validation loss decreased (0.2916 --> 0.2839).  Saving model state dict ...
Epoch: 3 cost time: 0.3019225597381592
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2838783 Best vali loss: 0.2838783
Updating learning rate to 0.0001452405492
Validation loss decreased (0.2839 --> 0.2822).  Saving model state dict ...
Epoch: 4 cost time: 0.29961252212524414
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2821713 Best vali loss: 0.2821713
Updating learning rate to 8.965939731355332e-05
Epoch: 5 cost time: 0.290647029876709
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2828121 Best vali loss: 0.2821713
Updating learning rate to 4.253997195742162e-05
Validation loss decreased (0.2822 --> 0.2819).  Saving model state dict ...
Epoch: 6 cost time: 0.28934359550476074
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2818883 Best vali loss: 0.2818883
Updating learning rate to 1.1055778503421459e-05
Epoch: 7 cost time: 0.26703643798828125
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2818914 Best vali loss: 0.2818883
Updating learning rate to 0.0
Epoch: 8 cost time: 0.26683688163757324
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2819340 Best vali loss: 0.2818883

best validation loss 0.28188826515577947

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0111055611489, 'e_layers': 3, 'learning_rate': 8.17960163e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2955315
	speed: 0.0112s/iter; left time: 45.6867s
	iters: 200, epoch: 1 | loss: 0.6920355
	speed: 0.0056s/iter; left time: 22.3951s
	iters: 300, epoch: 1 | loss: 0.3531290
	speed: 0.0056s/iter; left time: 21.6955s
	iters: 400, epoch: 1 | loss: 0.3266127
	speed: 0.0054s/iter; left time: 20.4194s
	iters: 500, epoch: 1 | loss: 0.4142348
	speed: 0.0051s/iter; left time: 18.9485s
Updating learning rate to 7.86828408002648e-05
Validation loss decreased (inf --> 0.3090).  Saving model state dict ...
Epoch: 1 cost time: 3.1543562412261963
Epoch: 1, Steps: 523 | Train Loss: 0.4163087 Vali Loss: 0.3089987 Best vali loss: 0.3089987
	iters: 100, epoch: 2 | loss: 0.9380378
	speed: 0.0121s/iter; left time: 43.0184s
	iters: 200, epoch: 2 | loss: 0.5853301
	speed: 0.0056s/iter; left time: 19.3547s
	iters: 300, epoch: 2 | loss: 0.6570848
	speed: 0.0056s/iter; left time: 18.8419s
	iters: 400, epoch: 2 | loss: 1.0592703
	speed: 0.0052s/iter; left time: 17.0877s
	iters: 500, epoch: 2 | loss: 0.6593169
	speed: 0.0053s/iter; left time: 16.8597s
Updating learning rate to 6.98172670498877e-05
Validation loss decreased (0.3090 --> 0.2956).  Saving model state dict ...
Epoch: 2 cost time: 2.904933214187622
Epoch: 2, Steps: 523 | Train Loss: 0.7798080 Vali Loss: 0.2955576 Best vali loss: 0.2955576
	iters: 100, epoch: 3 | loss: 0.6511756
	speed: 0.0124s/iter; left time: 37.5482s
	iters: 200, epoch: 3 | loss: 0.2664370
	speed: 0.0059s/iter; left time: 17.2979s
	iters: 300, epoch: 3 | loss: 0.3228919
	speed: 0.0059s/iter; left time: 16.6107s
	iters: 400, epoch: 3 | loss: 0.3064036
	speed: 0.0056s/iter; left time: 15.2614s
	iters: 500, epoch: 3 | loss: 0.5987796
	speed: 0.0049s/iter; left time: 12.9287s
Updating learning rate to 5.654899828573742e-05
Validation loss decreased (0.2956 --> 0.2902).  Saving model state dict ...
Epoch: 3 cost time: 2.951526403427124
Epoch: 3, Steps: 523 | Train Loss: 0.4291375 Vali Loss: 0.2901822 Best vali loss: 0.2901822
	iters: 100, epoch: 4 | loss: 0.7977375
	speed: 0.0093s/iter; left time: 23.3759s
	iters: 200, epoch: 4 | loss: 0.2372352
	speed: 0.0046s/iter; left time: 11.1210s
	iters: 300, epoch: 4 | loss: 0.8314755
	speed: 0.0046s/iter; left time: 10.5579s
	iters: 400, epoch: 4 | loss: 0.3054566
	speed: 0.0046s/iter; left time: 10.2394s
	iters: 500, epoch: 4 | loss: 0.5914386
	speed: 0.0039s/iter; left time: 8.3195s
Updating learning rate to 4.089800815e-05
Validation loss decreased (0.2902 --> 0.2882).  Saving model state dict ...
Epoch: 4 cost time: 2.3526113033294678
Epoch: 4, Steps: 523 | Train Loss: 0.5526687 Vali Loss: 0.2881659 Best vali loss: 0.2881659
	iters: 100, epoch: 5 | loss: 0.5485590
	speed: 0.0139s/iter; left time: 27.7397s
	iters: 200, epoch: 5 | loss: 0.5337623
	speed: 0.0097s/iter; left time: 18.3517s
	iters: 300, epoch: 5 | loss: 0.3704137
	speed: 0.0062s/iter; left time: 11.1331s
	iters: 400, epoch: 5 | loss: 0.4435104
	speed: 0.0075s/iter; left time: 12.7619s
	iters: 500, epoch: 5 | loss: 0.2976233
	speed: 0.0076s/iter; left time: 12.0813s
Updating learning rate to 2.5247018014262588e-05
Validation loss decreased (0.2882 --> 0.2881).  Saving model state dict ...
Epoch: 5 cost time: 4.2583513259887695
Epoch: 5, Steps: 523 | Train Loss: 0.4387737 Vali Loss: 0.2880672 Best vali loss: 0.2880672
	iters: 100, epoch: 6 | loss: 0.3880413
	speed: 0.0173s/iter; left time: 25.4068s
	iters: 200, epoch: 6 | loss: 0.2515279
	speed: 0.0076s/iter; left time: 10.4747s
	iters: 300, epoch: 6 | loss: 0.2798445
	speed: 0.0051s/iter; left time: 6.5042s
	iters: 400, epoch: 6 | loss: 0.3866041
	speed: 0.0040s/iter; left time: 4.7211s
	iters: 500, epoch: 6 | loss: 0.2877601
	speed: 0.0042s/iter; left time: 4.5362s
Updating learning rate to 1.1978749250112316e-05
Validation loss decreased (0.2881 --> 0.2879).  Saving model state dict ...
Epoch: 6 cost time: 3.049926280975342
Epoch: 6, Steps: 523 | Train Loss: 0.3187556 Vali Loss: 0.2879248 Best vali loss: 0.2879248
	iters: 100, epoch: 7 | loss: 0.5007014
	speed: 0.0106s/iter; left time: 10.0552s
	iters: 200, epoch: 7 | loss: 0.5996983
	speed: 0.0048s/iter; left time: 4.0277s
	iters: 300, epoch: 7 | loss: 0.4080873
	speed: 0.0047s/iter; left time: 3.5424s
	iters: 400, epoch: 7 | loss: 0.4829420
	speed: 0.0049s/iter; left time: 3.1708s
	iters: 500, epoch: 7 | loss: 0.3216325
	speed: 0.0042s/iter; left time: 2.2852s
Updating learning rate to 3.1131754997352054e-06
Validation loss decreased (0.2879 --> 0.2874).  Saving model state dict ...
Epoch: 7 cost time: 2.4918596744537354
Epoch: 7, Steps: 523 | Train Loss: 0.4626123 Vali Loss: 0.2873518 Best vali loss: 0.2873518
	iters: 100, epoch: 8 | loss: 0.7264161
	speed: 0.0087s/iter; left time: 3.7001s
	iters: 200, epoch: 8 | loss: 0.1864840
	speed: 0.0040s/iter; left time: 1.3031s
	iters: 300, epoch: 8 | loss: 0.2006152
	speed: 0.0045s/iter; left time: 1.0121s
	iters: 400, epoch: 8 | loss: 0.6687407
	speed: 0.0057s/iter; left time: 0.7078s
	iters: 500, epoch: 8 | loss: 0.4570681
	speed: 0.0050s/iter; left time: 0.1199s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.498056650161743
Epoch: 8, Steps: 523 | Train Loss: 0.4478648 Vali Loss: 0.2873570 Best vali loss: 0.2873518

best validation loss 0.28735182031728645

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0072636125698, 'e_layers': 3, 'learning_rate': 0.0026797239204, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3817847
	speed: 0.0108s/iter; left time: 43.9346s
	iters: 200, epoch: 1 | loss: 0.3654364
	speed: 0.0056s/iter; left time: 22.4249s
	iters: 300, epoch: 1 | loss: 0.2943558
	speed: 0.0053s/iter; left time: 20.4760s
	iters: 400, epoch: 1 | loss: 0.9367584
	speed: 0.0054s/iter; left time: 20.4421s
	iters: 500, epoch: 1 | loss: 1.1369749
	speed: 0.0049s/iter; left time: 18.0934s
Updating learning rate to 0.0026797239204
Validation loss decreased (inf --> 0.3216).  Saving model state dict ...
Epoch: 1 cost time: 3.0498878955841064
Epoch: 1, Steps: 523 | Train Loss: 0.6230621 Vali Loss: 0.3215646 Best vali loss: 0.3215646
	iters: 100, epoch: 2 | loss: 0.3720881
	speed: 0.0129s/iter; left time: 46.1145s
	iters: 200, epoch: 2 | loss: 0.4953024
	speed: 0.0062s/iter; left time: 21.5136s
	iters: 300, epoch: 2 | loss: 0.3457179
	speed: 0.0057s/iter; left time: 19.2494s
	iters: 400, epoch: 2 | loss: 0.5831675
	speed: 0.0054s/iter; left time: 17.5149s
	iters: 500, epoch: 2 | loss: 0.7783653
	speed: 0.0041s/iter; left time: 12.9083s
Updating learning rate to 0.0013398619602
Epoch: 2 cost time: 2.9378902912139893
Epoch: 2, Steps: 523 | Train Loss: 0.5149282 Vali Loss: 0.3216473 Best vali loss: 0.3215646
	iters: 100, epoch: 3 | loss: 0.4131860
	speed: 0.0113s/iter; left time: 34.3687s
	iters: 200, epoch: 3 | loss: 0.4988708
	speed: 0.0061s/iter; left time: 17.8336s
	iters: 300, epoch: 3 | loss: 0.4704248
	speed: 0.0053s/iter; left time: 14.9669s
	iters: 400, epoch: 3 | loss: 0.2736626
	speed: 0.0058s/iter; left time: 15.9151s
	iters: 500, epoch: 3 | loss: 0.8343217
	speed: 0.0059s/iter; left time: 15.5280s
Updating learning rate to 0.0006699309801
Epoch: 3 cost time: 3.1113569736480713
Epoch: 3, Steps: 523 | Train Loss: 0.4980932 Vali Loss: 0.3236149 Best vali loss: 0.3215646

best validation loss 0.3215645785644711

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0011116320123, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3554586
	speed: 0.0086s/iter; left time: 8.1568s
Updating learning rate to 0.0011116320123
Validation loss decreased (inf --> 0.2849).  Saving model state dict ...
Epoch: 1 cost time: 0.6807732582092285
Epoch: 1, Steps: 131 | Train Loss: 0.3554586 Vali Loss: 0.2849060 Best vali loss: 0.2849060
	iters: 100, epoch: 2 | loss: 0.4480499
	speed: 0.0059s/iter; left time: 4.8315s
Updating learning rate to 0.00055581600615
Validation loss decreased (0.2849 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 0.4623532295227051
Epoch: 2, Steps: 131 | Train Loss: 0.4480499 Vali Loss: 0.2823686 Best vali loss: 0.2823686
	iters: 100, epoch: 3 | loss: 0.4543514
	speed: 0.0060s/iter; left time: 4.1397s
Updating learning rate to 0.000277908003075
Validation loss decreased (0.2824 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 0.4537498950958252
Epoch: 3, Steps: 131 | Train Loss: 0.4543514 Vali Loss: 0.2822773 Best vali loss: 0.2822773

best validation loss 0.282277320969854

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0085651972878, 'e_layers': 3, 'learning_rate': 0.0005146719463, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6490957
	speed: 0.0126s/iter; left time: 25.1838s
	iters: 200, epoch: 1 | loss: 0.3041619
	speed: 0.0073s/iter; left time: 13.7916s
Updating learning rate to 0.0004950834117221591
Validation loss decreased (inf --> 0.3071).  Saving model state dict ...
Epoch: 1 cost time: 2.173579692840576
Epoch: 1, Steps: 262 | Train Loss: 0.4766288 Vali Loss: 0.3071021 Best vali loss: 0.3071021
	iters: 100, epoch: 2 | loss: 0.4845192
	speed: 0.0155s/iter; left time: 26.8756s
	iters: 200, epoch: 2 | loss: 0.4289106
	speed: 0.0072s/iter; left time: 11.8404s
Updating learning rate to 0.0004392999848076043
Validation loss decreased (0.3071 --> 0.3002).  Saving model state dict ...
Epoch: 2 cost time: 1.9290869235992432
Epoch: 2, Steps: 262 | Train Loss: 0.4567149 Vali Loss: 0.3001643 Best vali loss: 0.3001643
	iters: 100, epoch: 3 | loss: 0.6001623
	speed: 0.0161s/iter; left time: 23.6752s
	iters: 200, epoch: 3 | loss: 1.1157997
	speed: 0.0069s/iter; left time: 9.4440s
Updating learning rate to 0.0003558141866260526
Validation loss decreased (0.3002 --> 0.2915).  Saving model state dict ...
Epoch: 3 cost time: 1.921675205230713
Epoch: 3, Steps: 262 | Train Loss: 0.8579810 Vali Loss: 0.2915371 Best vali loss: 0.2915371

best validation loss 0.291537141386529

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0011116320123, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3686605
	speed: 0.0088s/iter; left time: 4.8700s
Updating learning rate to 0.0001389540015375
Epoch: 4 cost time: 0.6929938793182373
Epoch: 4, Steps: 131 | Train Loss: 0.3686605 Vali Loss: 0.2834050 Best vali loss: 0.2822773
	iters: 100, epoch: 5 | loss: 0.4280599
	speed: 0.0062s/iter; left time: 2.6413s
Updating learning rate to 6.947700076875e-05
Epoch: 5 cost time: 0.47980165481567383
Epoch: 5, Steps: 131 | Train Loss: 0.4280599 Vali Loss: 0.2827121 Best vali loss: 0.2822773
	iters: 100, epoch: 6 | loss: 0.4491032
	speed: 0.0060s/iter; left time: 1.7510s
Updating learning rate to 3.4738500384375e-05
Epoch: 6 cost time: 0.45380067825317383
Epoch: 6, Steps: 131 | Train Loss: 0.4491032 Vali Loss: 0.2833228 Best vali loss: 0.2822773
	iters: 100, epoch: 7 | loss: 0.6442844
	speed: 0.0057s/iter; left time: 0.9238s
Updating learning rate to 1.73692501921875e-05
Epoch: 7 cost time: 0.4178757667541504
Epoch: 7, Steps: 131 | Train Loss: 0.6442844 Vali Loss: 0.2830271 Best vali loss: 0.2822773
	iters: 100, epoch: 8 | loss: 0.5255653
	speed: 0.0055s/iter; left time: 0.1770s
Updating learning rate to 8.68462509609375e-06
Epoch: 8 cost time: 0.47907423973083496
Epoch: 8, Steps: 131 | Train Loss: 0.5255653 Vali Loss: 0.2829303 Best vali loss: 0.2822773

best validation loss 0.282277320969854

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6915714
	speed: 0.0116s/iter; left time: 10.9985s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 1.0484569072723389
Epoch: 1, Steps: 131 | Train Loss: 0.6915714 Vali Loss: 0.3218369 Best vali loss: 0.3218369
	iters: 100, epoch: 2 | loss: 0.4748999
	speed: 0.0106s/iter; left time: 8.6770s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.3218 --> 0.3050).  Saving model state dict ...
Epoch: 2 cost time: 0.8729944229125977
Epoch: 2, Steps: 131 | Train Loss: 0.4748999 Vali Loss: 0.3050303 Best vali loss: 0.3050303
	iters: 100, epoch: 3 | loss: 0.6866489
	speed: 0.0100s/iter; left time: 6.8449s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.3050 --> 0.2987).  Saving model state dict ...
Epoch: 3 cost time: 0.8327949047088623
Epoch: 3, Steps: 131 | Train Loss: 0.6866489 Vali Loss: 0.2987203 Best vali loss: 0.2987203
	iters: 100, epoch: 4 | loss: 0.4876589
	speed: 0.0102s/iter; left time: 5.6620s
Updating learning rate to 7.5835271e-05
Validation loss decreased (0.2987 --> 0.2925).  Saving model state dict ...
Epoch: 4 cost time: 0.8556692600250244
Epoch: 4, Steps: 131 | Train Loss: 0.4876589 Vali Loss: 0.2925282 Best vali loss: 0.2925282
	iters: 100, epoch: 5 | loss: 0.4878523
	speed: 0.0099s/iter; left time: 4.2007s
Updating learning rate to 4.681436919938325e-05
Validation loss decreased (0.2925 --> 0.2906).  Saving model state dict ...
Epoch: 5 cost time: 0.7947854995727539
Epoch: 5, Steps: 131 | Train Loss: 0.4878523 Vali Loss: 0.2905559 Best vali loss: 0.2905559
	iters: 100, epoch: 6 | loss: 0.5823268
	speed: 0.0109s/iter; left time: 3.2022s
Updating learning rate to 2.221163662278047e-05
Validation loss decreased (0.2906 --> 0.2894).  Saving model state dict ...
Epoch: 6 cost time: 0.9869339466094971
Epoch: 6, Steps: 131 | Train Loss: 0.5823268 Vali Loss: 0.2893925 Best vali loss: 0.2893925
	iters: 100, epoch: 7 | loss: 0.3161128
	speed: 0.0124s/iter; left time: 2.0155s
Updating learning rate to 5.772616280653259e-06
Validation loss decreased (0.2894 --> 0.2885).  Saving model state dict ...
Epoch: 7 cost time: 1.0332298278808594
Epoch: 7, Steps: 131 | Train Loss: 0.3161128 Vali Loss: 0.2885079 Best vali loss: 0.2885079
	iters: 100, epoch: 8 | loss: 0.7024677
	speed: 0.0118s/iter; left time: 0.3768s
Updating learning rate to 0.0
Validation loss decreased (0.2885 --> 0.2883).  Saving model state dict ...
Epoch: 8 cost time: 0.931427001953125
Epoch: 8, Steps: 131 | Train Loss: 0.7024677 Vali Loss: 0.2882879 Best vali loss: 0.2882879

best validation loss 0.28828788678102574

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0011065600884, 'e_layers': 4, 'learning_rate': 0.0011706271719, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4599233
	speed: 0.0137s/iter; left time: 27.4312s
	iters: 200, epoch: 1 | loss: 0.3296367
	speed: 0.0062s/iter; left time: 11.8546s
Updating learning rate to 0.0011260728281099908
Validation loss decreased (inf --> 0.2945).  Saving model state dict ...
Epoch: 1 cost time: 2.215927839279175
Epoch: 1, Steps: 262 | Train Loss: 0.3947800 Vali Loss: 0.2944740 Best vali loss: 0.2944740
	iters: 100, epoch: 2 | loss: 0.8563416
	speed: 0.0171s/iter; left time: 29.7255s
	iters: 200, epoch: 2 | loss: 0.4465864
	speed: 0.0077s/iter; left time: 12.5320s
Updating learning rate to 0.00099919279169586
Validation loss decreased (0.2945 --> 0.2892).  Saving model state dict ...
Epoch: 2 cost time: 2.0308446884155273
Epoch: 2, Steps: 262 | Train Loss: 0.6514640 Vali Loss: 0.2891852 Best vali loss: 0.2891852
	iters: 100, epoch: 3 | loss: 0.7897068
	speed: 0.0122s/iter; left time: 17.9878s
	iters: 200, epoch: 3 | loss: 0.4428190
	speed: 0.0077s/iter; left time: 10.5998s
Updating learning rate to 0.000809303398031265
Validation loss decreased (0.2892 --> 0.2825).  Saving model state dict ...
Epoch: 3 cost time: 1.8422210216522217
Epoch: 3, Steps: 262 | Train Loss: 0.6162629 Vali Loss: 0.2825305 Best vali loss: 0.2825305
	iters: 100, epoch: 4 | loss: 0.2521306
	speed: 0.0168s/iter; left time: 20.3434s
	iters: 200, epoch: 4 | loss: 0.4088394
	speed: 0.0066s/iter; left time: 7.3176s
Updating learning rate to 0.00058531358595
Validation loss decreased (0.2825 --> 0.2781).  Saving model state dict ...
Epoch: 4 cost time: 1.963017463684082
Epoch: 4, Steps: 262 | Train Loss: 0.3304850 Vali Loss: 0.2781017 Best vali loss: 0.2781017
	iters: 100, epoch: 5 | loss: 0.4186838
	speed: 0.0172s/iter; left time: 16.3366s
	iters: 200, epoch: 5 | loss: 0.6006156
	speed: 0.0076s/iter; left time: 6.4578s
Updating learning rate to 0.000361323773868735
Validation loss decreased (0.2781 --> 0.2768).  Saving model state dict ...
Epoch: 5 cost time: 2.074122905731201
Epoch: 5, Steps: 262 | Train Loss: 0.5096497 Vali Loss: 0.2767898 Best vali loss: 0.2767898
	iters: 100, epoch: 6 | loss: 0.3252977
	speed: 0.0166s/iter; left time: 11.4063s
	iters: 200, epoch: 6 | loss: 0.4858924
	speed: 0.0077s/iter; left time: 4.4913s
Updating learning rate to 0.00017143438020413989
Validation loss decreased (0.2768 --> 0.2766).  Saving model state dict ...
Epoch: 6 cost time: 2.0560500621795654
Epoch: 6, Steps: 262 | Train Loss: 0.4055950 Vali Loss: 0.2765599 Best vali loss: 0.2765599
	iters: 100, epoch: 7 | loss: 0.3223365
	speed: 0.0154s/iter; left time: 6.5660s
	iters: 200, epoch: 7 | loss: 0.5218073
	speed: 0.0081s/iter; left time: 2.6274s
Updating learning rate to 4.455434379000915e-05
Epoch: 7 cost time: 2.1458017826080322
Epoch: 7, Steps: 262 | Train Loss: 0.4220719 Vali Loss: 0.2797839 Best vali loss: 0.2765599
	iters: 100, epoch: 8 | loss: 0.4835425
	speed: 0.0168s/iter; left time: 2.7343s
	iters: 200, epoch: 8 | loss: 0.2887866
	speed: 0.0080s/iter; left time: 0.5025s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.079559087753296
Epoch: 8, Steps: 262 | Train Loss: 0.3861645 Vali Loss: 0.2807229 Best vali loss: 0.2765599

best validation loss 0.276559895348509

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013301090585, 'e_layers': 1, 'learning_rate': 0.0017944511294, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4794083
	speed: 0.0084s/iter; left time: 7.9673s
Updating learning rate to 0.0017944511294
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 0.645301342010498
Epoch: 1, Steps: 131 | Train Loss: 0.4794083 Vali Loss: 0.2804975 Best vali loss: 0.2804975
	iters: 100, epoch: 2 | loss: 0.4684646
	speed: 0.0056s/iter; left time: 4.6131s
Updating learning rate to 0.0008972255647
Epoch: 2 cost time: 0.4421994686126709
Epoch: 2, Steps: 131 | Train Loss: 0.4684646 Vali Loss: 0.2898593 Best vali loss: 0.2804975
	iters: 100, epoch: 3 | loss: 0.4436010
	speed: 0.0063s/iter; left time: 4.3340s
Updating learning rate to 0.00044861278235
Epoch: 3 cost time: 0.4912393093109131
Epoch: 3, Steps: 131 | Train Loss: 0.4436010 Vali Loss: 0.2884470 Best vali loss: 0.2804975

best validation loss 0.28049746665559144

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0024236762505, 'e_layers': 2, 'learning_rate': 0.0003084774503, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5773478
	speed: 0.0099s/iter; left time: 19.8325s
	iters: 200, epoch: 1 | loss: 0.4791889
	speed: 0.0043s/iter; left time: 8.2398s
Updating learning rate to 0.0003084774503
Validation loss decreased (inf --> 0.2954).  Saving model state dict ...
Epoch: 1 cost time: 1.4288716316223145
Epoch: 1, Steps: 262 | Train Loss: 0.5282684 Vali Loss: 0.2954281 Best vali loss: 0.2954281
	iters: 100, epoch: 2 | loss: 0.2696115
	speed: 0.0096s/iter; left time: 16.6389s
	iters: 200, epoch: 2 | loss: 0.3239388
	speed: 0.0040s/iter; left time: 6.5938s
Updating learning rate to 0.00015423872515
Validation loss decreased (0.2954 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 1.1067917346954346
Epoch: 2, Steps: 262 | Train Loss: 0.2967752 Vali Loss: 0.2838396 Best vali loss: 0.2838396
	iters: 100, epoch: 3 | loss: 0.7858805
	speed: 0.0091s/iter; left time: 13.4642s
	iters: 200, epoch: 3 | loss: 0.4269251
	speed: 0.0040s/iter; left time: 5.4848s
Updating learning rate to 7.7119362575e-05
Validation loss decreased (0.2838 --> 0.2827).  Saving model state dict ...
Epoch: 3 cost time: 1.093623161315918
Epoch: 3, Steps: 262 | Train Loss: 0.6064028 Vali Loss: 0.2827033 Best vali loss: 0.2827033

best validation loss 0.2827033044409468

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029638074311, 'e_layers': 2, 'learning_rate': 0.0001213169042, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7688884
	speed: 0.0102s/iter; left time: 41.7662s
	iters: 200, epoch: 1 | loss: 0.4937308
	speed: 0.0045s/iter; left time: 18.0948s
	iters: 300, epoch: 1 | loss: 0.6750539
	speed: 0.0045s/iter; left time: 17.5003s
	iters: 400, epoch: 1 | loss: 0.6583415
	speed: 0.0046s/iter; left time: 17.3519s
	iters: 500, epoch: 1 | loss: 0.4079914
	speed: 0.0046s/iter; left time: 17.0257s
Updating learning rate to 0.0001213169042
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 2.6814723014831543
Epoch: 1, Steps: 523 | Train Loss: 0.6008012 Vali Loss: 0.2812571 Best vali loss: 0.2812571
	iters: 100, epoch: 2 | loss: 0.3399843
	speed: 0.0101s/iter; left time: 36.0534s
	iters: 200, epoch: 2 | loss: 0.6086937
	speed: 0.0038s/iter; left time: 13.1699s
	iters: 300, epoch: 2 | loss: 0.2670093
	speed: 0.0038s/iter; left time: 12.8288s
	iters: 400, epoch: 2 | loss: 0.3233234
	speed: 0.0044s/iter; left time: 14.3034s
	iters: 500, epoch: 2 | loss: 0.4667510
	speed: 0.0045s/iter; left time: 14.3449s
Updating learning rate to 6.06584521e-05
Epoch: 2 cost time: 2.1887874603271484
Epoch: 2, Steps: 523 | Train Loss: 0.4011523 Vali Loss: 0.2880504 Best vali loss: 0.2812571
	iters: 100, epoch: 3 | loss: 0.4310133
	speed: 0.0105s/iter; left time: 31.9307s
	iters: 200, epoch: 3 | loss: 0.2647448
	speed: 0.0046s/iter; left time: 13.3808s
	iters: 300, epoch: 3 | loss: 0.2091415
	speed: 0.0045s/iter; left time: 12.9157s
	iters: 400, epoch: 3 | loss: 0.6945328
	speed: 0.0045s/iter; left time: 12.3128s
	iters: 500, epoch: 3 | loss: 0.4386416
	speed: 0.0045s/iter; left time: 11.9089s
Updating learning rate to 3.032922605e-05
Epoch: 3 cost time: 2.406393051147461
Epoch: 3, Steps: 523 | Train Loss: 0.4076148 Vali Loss: 0.3023271 Best vali loss: 0.2812571

best validation loss 0.28125713340586206

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013301090585, 'e_layers': 1, 'learning_rate': 0.0017944511294, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4413680
	speed: 0.0089s/iter; left time: 4.9542s
Updating learning rate to 0.000224306391175
Epoch: 4 cost time: 0.6952998638153076
Epoch: 4, Steps: 131 | Train Loss: 0.4413680 Vali Loss: 0.2925103 Best vali loss: 0.2804975
	iters: 100, epoch: 5 | loss: 0.4234878
	speed: 0.0059s/iter; left time: 2.4909s
Updating learning rate to 0.0001121531955875
Epoch: 5 cost time: 0.44703149795532227
Epoch: 5, Steps: 131 | Train Loss: 0.4234878 Vali Loss: 0.2952725 Best vali loss: 0.2804975
	iters: 100, epoch: 6 | loss: 0.4254375
	speed: 0.0056s/iter; left time: 1.6550s
Updating learning rate to 5.607659779375e-05
Epoch: 6 cost time: 0.4274928569793701
Epoch: 6, Steps: 131 | Train Loss: 0.4254375 Vali Loss: 0.2936750 Best vali loss: 0.2804975
	iters: 100, epoch: 7 | loss: 0.4487765
	speed: 0.0059s/iter; left time: 0.9601s
Updating learning rate to 2.8038298896875e-05
Epoch: 7 cost time: 0.4606494903564453
Epoch: 7, Steps: 131 | Train Loss: 0.4487765 Vali Loss: 0.2945260 Best vali loss: 0.2804975
	iters: 100, epoch: 8 | loss: 0.4969381
	speed: 0.0062s/iter; left time: 0.1986s
Updating learning rate to 1.40191494484375e-05
Epoch: 8 cost time: 0.4899101257324219
Epoch: 8, Steps: 131 | Train Loss: 0.4969381 Vali Loss: 0.2951815 Best vali loss: 0.2804975

best validation loss 0.28049746665559144

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023210420786, 'e_layers': 2, 'learning_rate': 5.47631081e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4000123
	speed: 0.0094s/iter; left time: 77.7902s
	iters: 200, epoch: 1 | loss: 0.3827601
	speed: 0.0039s/iter; left time: 31.8500s
	iters: 300, epoch: 1 | loss: 0.3271278
	speed: 0.0041s/iter; left time: 32.7757s
	iters: 400, epoch: 1 | loss: 0.4119787
	speed: 0.0044s/iter; left time: 34.7600s
	iters: 500, epoch: 1 | loss: 0.2051636
	speed: 0.0045s/iter; left time: 35.2403s
	iters: 600, epoch: 1 | loss: 0.4767568
	speed: 0.0045s/iter; left time: 35.2239s
	iters: 700, epoch: 1 | loss: 0.8283219
	speed: 0.0046s/iter; left time: 35.1866s
	iters: 800, epoch: 1 | loss: 0.3080487
	speed: 0.0046s/iter; left time: 34.5501s
	iters: 900, epoch: 1 | loss: 0.1690524
	speed: 0.0044s/iter; left time: 32.7468s
	iters: 1000, epoch: 1 | loss: 1.1275826
	speed: 0.0044s/iter; left time: 32.3275s
Updating learning rate to 5.47631081e-05
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 4.793186664581299
Epoch: 1, Steps: 1045 | Train Loss: 0.5636805 Vali Loss: 0.2835119 Best vali loss: 0.2835119
	iters: 100, epoch: 2 | loss: 0.3199096
	speed: 0.0145s/iter; left time: 104.4477s
	iters: 200, epoch: 2 | loss: 0.3538570
	speed: 0.0036s/iter; left time: 25.7466s
	iters: 300, epoch: 2 | loss: 0.3652579
	speed: 0.0037s/iter; left time: 26.0190s
	iters: 400, epoch: 2 | loss: 0.1406719
	speed: 0.0045s/iter; left time: 31.3019s
	iters: 500, epoch: 2 | loss: 0.1881551
	speed: 0.0046s/iter; left time: 31.4246s
	iters: 600, epoch: 2 | loss: 0.4611682
	speed: 0.0045s/iter; left time: 30.0720s
	iters: 700, epoch: 2 | loss: 1.6233968
	speed: 0.0044s/iter; left time: 29.3050s
	iters: 800, epoch: 2 | loss: 1.0421997
	speed: 0.0044s/iter; left time: 28.9258s
	iters: 900, epoch: 2 | loss: 0.2448370
	speed: 0.0044s/iter; left time: 28.4297s
	iters: 1000, epoch: 2 | loss: 0.4926113
	speed: 0.0045s/iter; left time: 28.1287s
Updating learning rate to 2.738155405e-05
Validation loss decreased (0.2835 --> 0.2796).  Saving model state dict ...
Epoch: 2 cost time: 4.474553823471069
Epoch: 2, Steps: 1045 | Train Loss: 0.5232064 Vali Loss: 0.2795834 Best vali loss: 0.2795834
	iters: 100, epoch: 3 | loss: 0.3739571
	speed: 0.0145s/iter; left time: 89.6761s
	iters: 200, epoch: 3 | loss: 0.3054783
	speed: 0.0041s/iter; left time: 25.0836s
	iters: 300, epoch: 3 | loss: 0.3998102
	speed: 0.0042s/iter; left time: 25.2049s
	iters: 400, epoch: 3 | loss: 0.3024341
	speed: 0.0044s/iter; left time: 26.0079s
	iters: 500, epoch: 3 | loss: 0.5677314
	speed: 0.0044s/iter; left time: 25.5120s
	iters: 600, epoch: 3 | loss: 0.4462479
	speed: 0.0048s/iter; left time: 27.0999s
	iters: 700, epoch: 3 | loss: 0.3185118
	speed: 0.0049s/iter; left time: 27.1946s
	iters: 800, epoch: 3 | loss: 0.1923482
	speed: 0.0049s/iter; left time: 26.6177s
	iters: 900, epoch: 3 | loss: 0.1988917
	speed: 0.0049s/iter; left time: 26.1443s
	iters: 1000, epoch: 3 | loss: 0.2432702
	speed: 0.0048s/iter; left time: 25.1968s
Updating learning rate to 1.3690777025e-05
Validation loss decreased (0.2796 --> 0.2789).  Saving model state dict ...
Epoch: 3 cost time: 4.8083741664886475
Epoch: 3, Steps: 1045 | Train Loss: 0.3348681 Vali Loss: 0.2789049 Best vali loss: 0.2789049
	iters: 100, epoch: 4 | loss: 0.3875733
	speed: 0.0145s/iter; left time: 74.4158s
	iters: 200, epoch: 4 | loss: 0.2787978
	speed: 0.0036s/iter; left time: 18.0576s
	iters: 300, epoch: 4 | loss: 0.3183050
	speed: 0.0035s/iter; left time: 17.3920s
	iters: 400, epoch: 4 | loss: 0.3011440
	speed: 0.0042s/iter; left time: 20.0823s
	iters: 500, epoch: 4 | loss: 0.4841084
	speed: 0.0042s/iter; left time: 19.7176s
	iters: 600, epoch: 4 | loss: 0.2430917
	speed: 0.0042s/iter; left time: 19.2521s
	iters: 700, epoch: 4 | loss: 0.5473145
	speed: 0.0042s/iter; left time: 18.8865s
	iters: 800, epoch: 4 | loss: 0.3921835
	speed: 0.0042s/iter; left time: 18.3786s
	iters: 900, epoch: 4 | loss: 0.7698343
	speed: 0.0041s/iter; left time: 17.9069s
	iters: 1000, epoch: 4 | loss: 0.3692742
	speed: 0.0042s/iter; left time: 17.5707s
Updating learning rate to 6.8453885125e-06
Epoch: 4 cost time: 4.22813868522644
Epoch: 4, Steps: 1045 | Train Loss: 0.4091627 Vali Loss: 0.2802632 Best vali loss: 0.2789049
	iters: 100, epoch: 5 | loss: 1.3611079
	speed: 0.0144s/iter; left time: 58.6637s
	iters: 200, epoch: 5 | loss: 0.4052458
	speed: 0.0040s/iter; left time: 15.8164s
	iters: 300, epoch: 5 | loss: 0.2037634
	speed: 0.0036s/iter; left time: 14.1405s
	iters: 400, epoch: 5 | loss: 0.8249088
	speed: 0.0030s/iter; left time: 11.2954s
	iters: 500, epoch: 5 | loss: 0.2934471
	speed: 0.0030s/iter; left time: 10.9027s
	iters: 600, epoch: 5 | loss: 0.3223173
	speed: 0.0034s/iter; left time: 12.3167s
	iters: 700, epoch: 5 | loss: 0.3528266
	speed: 0.0040s/iter; left time: 13.8914s
	iters: 800, epoch: 5 | loss: 0.2359317
	speed: 0.0040s/iter; left time: 13.3629s
	iters: 900, epoch: 5 | loss: 0.2925385
	speed: 0.0040s/iter; left time: 13.1372s
	iters: 1000, epoch: 5 | loss: 0.2570345
	speed: 0.0040s/iter; left time: 12.8072s
Updating learning rate to 3.42269425625e-06
Epoch: 5 cost time: 3.919447898864746
Epoch: 5, Steps: 1045 | Train Loss: 0.4549122 Vali Loss: 0.2800466 Best vali loss: 0.2789049
	iters: 100, epoch: 6 | loss: 0.5365754
	speed: 0.0138s/iter; left time: 41.9210s
	iters: 200, epoch: 6 | loss: 0.4427727
	speed: 0.0038s/iter; left time: 11.2752s
	iters: 300, epoch: 6 | loss: 0.7439721
	speed: 0.0043s/iter; left time: 12.2066s
	iters: 400, epoch: 6 | loss: 0.3238456
	speed: 0.0043s/iter; left time: 11.8169s
	iters: 500, epoch: 6 | loss: 0.9441881
	speed: 0.0044s/iter; left time: 11.5178s
	iters: 600, epoch: 6 | loss: 0.2239208
	speed: 0.0043s/iter; left time: 10.9872s
	iters: 700, epoch: 6 | loss: 0.2972459
	speed: 0.0042s/iter; left time: 10.2287s
	iters: 800, epoch: 6 | loss: 0.4504351
	speed: 0.0038s/iter; left time: 8.8282s
	iters: 900, epoch: 6 | loss: 0.6449147
	speed: 0.0037s/iter; left time: 8.2279s
	iters: 1000, epoch: 6 | loss: 1.3265811
	speed: 0.0039s/iter; left time: 8.3982s
Updating learning rate to 1.711347128125e-06
Epoch: 6 cost time: 4.260425806045532
Epoch: 6, Steps: 1045 | Train Loss: 0.5934452 Vali Loss: 0.2800874 Best vali loss: 0.2789049
	iters: 100, epoch: 7 | loss: 0.1949324
	speed: 0.0145s/iter; left time: 28.9112s
	iters: 200, epoch: 7 | loss: 0.3386571
	speed: 0.0043s/iter; left time: 8.2230s
	iters: 300, epoch: 7 | loss: 0.8730919
	speed: 0.0042s/iter; left time: 7.5701s
	iters: 400, epoch: 7 | loss: 0.5001230
	speed: 0.0041s/iter; left time: 6.9137s
	iters: 500, epoch: 7 | loss: 0.6012462
	speed: 0.0047s/iter; left time: 7.4280s
	iters: 600, epoch: 7 | loss: 0.3959501
	speed: 0.0047s/iter; left time: 7.0546s
	iters: 700, epoch: 7 | loss: 0.7770230
	speed: 0.0046s/iter; left time: 6.3950s
	iters: 800, epoch: 7 | loss: 0.3871156
	speed: 0.0046s/iter; left time: 5.9994s
	iters: 900, epoch: 7 | loss: 0.4793761
	speed: 0.0046s/iter; left time: 5.4500s
	iters: 1000, epoch: 7 | loss: 0.6903868
	speed: 0.0043s/iter; left time: 4.7054s
Updating learning rate to 8.556735640625e-07
Epoch: 7 cost time: 4.679649353027344
Epoch: 7, Steps: 1045 | Train Loss: 0.5237902 Vali Loss: 0.2803309 Best vali loss: 0.2789049
	iters: 100, epoch: 8 | loss: 0.2540302
	speed: 0.0145s/iter; left time: 13.7181s
	iters: 200, epoch: 8 | loss: 0.3120351
	speed: 0.0043s/iter; left time: 3.6262s
	iters: 300, epoch: 8 | loss: 0.3669837
	speed: 0.0043s/iter; left time: 3.2422s
	iters: 400, epoch: 8 | loss: 0.2821700
	speed: 0.0045s/iter; left time: 2.9254s
	iters: 500, epoch: 8 | loss: 0.6821014
	speed: 0.0039s/iter; left time: 2.1332s
	iters: 600, epoch: 8 | loss: 0.9436339
	speed: 0.0038s/iter; left time: 1.7012s
	iters: 700, epoch: 8 | loss: 0.1722836
	speed: 0.0042s/iter; left time: 1.4646s
	iters: 800, epoch: 8 | loss: 0.8731610
	speed: 0.0042s/iter; left time: 1.0299s
	iters: 900, epoch: 8 | loss: 1.3093288
	speed: 0.0042s/iter; left time: 0.6073s
	iters: 1000, epoch: 8 | loss: 0.2531998
	speed: 0.0044s/iter; left time: 0.2036s
Updating learning rate to 4.2783678203125e-07
Epoch: 8 cost time: 4.455392360687256
Epoch: 8, Steps: 1045 | Train Loss: 0.5448927 Vali Loss: 0.2803606 Best vali loss: 0.2789049

best validation loss 0.27890489002992425

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 3, 'learning_rate': 6.09485552e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3506260
	speed: 0.0109s/iter; left time: 44.5186s
	iters: 200, epoch: 1 | loss: 0.3503417
	speed: 0.0053s/iter; left time: 20.9922s
	iters: 300, epoch: 1 | loss: 0.2569136
	speed: 0.0052s/iter; left time: 20.2814s
	iters: 400, epoch: 1 | loss: 0.2102203
	speed: 0.0050s/iter; left time: 18.7823s
	iters: 500, epoch: 1 | loss: 0.7578518
	speed: 0.0048s/iter; left time: 17.6571s
Updating learning rate to 6.09485552e-05
Validation loss decreased (inf --> 0.2979).  Saving model state dict ...
Epoch: 1 cost time: 2.9544076919555664
Epoch: 1, Steps: 523 | Train Loss: 0.3851907 Vali Loss: 0.2979219 Best vali loss: 0.2979219
	iters: 100, epoch: 2 | loss: 0.4337209
	speed: 0.0114s/iter; left time: 40.7247s
	iters: 200, epoch: 2 | loss: 0.3428419
	speed: 0.0053s/iter; left time: 18.3731s
	iters: 300, epoch: 2 | loss: 0.4418435
	speed: 0.0053s/iter; left time: 17.8140s
	iters: 400, epoch: 2 | loss: 0.4560680
	speed: 0.0051s/iter; left time: 16.5047s
	iters: 500, epoch: 2 | loss: 1.0438198
	speed: 0.0046s/iter; left time: 14.6909s
Updating learning rate to 3.04742776e-05
Validation loss decreased (0.2979 --> 0.2852).  Saving model state dict ...
Epoch: 2 cost time: 2.688234806060791
Epoch: 2, Steps: 523 | Train Loss: 0.5436588 Vali Loss: 0.2851907 Best vali loss: 0.2851907
	iters: 100, epoch: 3 | loss: 0.3228370
	speed: 0.0090s/iter; left time: 27.4552s
	iters: 200, epoch: 3 | loss: 0.3714283
	speed: 0.0059s/iter; left time: 17.2075s
	iters: 300, epoch: 3 | loss: 0.8043287
	speed: 0.0059s/iter; left time: 16.7071s
	iters: 400, epoch: 3 | loss: 0.7299324
	speed: 0.0059s/iter; left time: 16.1147s
	iters: 500, epoch: 3 | loss: 0.1776365
	speed: 0.0059s/iter; left time: 15.5075s
Updating learning rate to 1.52371388e-05
Validation loss decreased (0.2852 --> 0.2829).  Saving model state dict ...
Epoch: 3 cost time: 2.993346929550171
Epoch: 3, Steps: 523 | Train Loss: 0.4812326 Vali Loss: 0.2828905 Best vali loss: 0.2828905
	iters: 100, epoch: 4 | loss: 0.2903587
	speed: 0.0122s/iter; left time: 30.7479s
	iters: 200, epoch: 4 | loss: 0.3391004
	speed: 0.0056s/iter; left time: 13.4165s
	iters: 300, epoch: 4 | loss: 0.3492667
	speed: 0.0057s/iter; left time: 13.3050s
	iters: 400, epoch: 4 | loss: 0.4409721
	speed: 0.0057s/iter; left time: 12.5207s
	iters: 500, epoch: 4 | loss: 0.3561372
	speed: 0.0056s/iter; left time: 11.8520s
Updating learning rate to 7.6185694e-06
Validation loss decreased (0.2829 --> 0.2823).  Saving model state dict ...
Epoch: 4 cost time: 2.9764161109924316
Epoch: 4, Steps: 523 | Train Loss: 0.3551670 Vali Loss: 0.2822623 Best vali loss: 0.2822623
	iters: 100, epoch: 5 | loss: 0.2958103
	speed: 0.0115s/iter; left time: 23.0142s
	iters: 200, epoch: 5 | loss: 0.6748292
	speed: 0.0059s/iter; left time: 11.1136s
	iters: 300, epoch: 5 | loss: 0.2943746
	speed: 0.0058s/iter; left time: 10.3968s
	iters: 400, epoch: 5 | loss: 0.5306609
	speed: 0.0058s/iter; left time: 9.8381s
	iters: 500, epoch: 5 | loss: 0.5126386
	speed: 0.0058s/iter; left time: 9.2175s
Updating learning rate to 3.8092847e-06
Validation loss decreased (0.2823 --> 0.2819).  Saving model state dict ...
Epoch: 5 cost time: 3.0571110248565674
Epoch: 5, Steps: 523 | Train Loss: 0.4616627 Vali Loss: 0.2819494 Best vali loss: 0.2819494
	iters: 100, epoch: 6 | loss: 0.3076010
	speed: 0.0124s/iter; left time: 18.1898s
	iters: 200, epoch: 6 | loss: 0.9904301
	speed: 0.0059s/iter; left time: 8.0248s
	iters: 300, epoch: 6 | loss: 0.5494726
	speed: 0.0058s/iter; left time: 7.3052s
	iters: 400, epoch: 6 | loss: 0.8034780
	speed: 0.0057s/iter; left time: 6.6800s
	iters: 500, epoch: 6 | loss: 0.8629719
	speed: 0.0055s/iter; left time: 5.8639s
Updating learning rate to 1.90464235e-06
Validation loss decreased (0.2819 --> 0.2819).  Saving model state dict ...
Epoch: 6 cost time: 3.0213327407836914
Epoch: 6, Steps: 523 | Train Loss: 0.7027907 Vali Loss: 0.2818682 Best vali loss: 0.2818682
	iters: 100, epoch: 7 | loss: 0.5172132
	speed: 0.0121s/iter; left time: 11.4322s
	iters: 200, epoch: 7 | loss: 0.3225476
	speed: 0.0060s/iter; left time: 5.0709s
	iters: 300, epoch: 7 | loss: 0.7374808
	speed: 0.0060s/iter; left time: 4.4839s
	iters: 400, epoch: 7 | loss: 0.1897939
	speed: 0.0060s/iter; left time: 3.8850s
	iters: 500, epoch: 7 | loss: 0.8450208
	speed: 0.0060s/iter; left time: 3.2832s
Updating learning rate to 9.52321175e-07
Validation loss decreased (0.2819 --> 0.2818).  Saving model state dict ...
Epoch: 7 cost time: 3.177093982696533
Epoch: 7, Steps: 523 | Train Loss: 0.5224112 Vali Loss: 0.2818491 Best vali loss: 0.2818491
	iters: 100, epoch: 8 | loss: 0.7421528
	speed: 0.0124s/iter; left time: 5.2749s
	iters: 200, epoch: 8 | loss: 0.2852637
	speed: 0.0058s/iter; left time: 1.8830s
	iters: 300, epoch: 8 | loss: 0.7496847
	speed: 0.0058s/iter; left time: 1.2898s
	iters: 400, epoch: 8 | loss: 0.8278291
	speed: 0.0058s/iter; left time: 0.7186s
	iters: 500, epoch: 8 | loss: 0.7451354
	speed: 0.0051s/iter; left time: 0.1236s
Updating learning rate to 4.761605875e-07
Epoch: 8 cost time: 2.9856693744659424
Epoch: 8, Steps: 523 | Train Loss: 0.6700131 Vali Loss: 0.2818553 Best vali loss: 0.2818491

best validation loss 0.28184911490107345

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0044711634464, 'e_layers': 3, 'learning_rate': 0.0004262443426, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2550733
	speed: 0.0143s/iter; left time: 117.9696s
	iters: 200, epoch: 1 | loss: 0.1517486
	speed: 0.0090s/iter; left time: 73.0744s
	iters: 300, epoch: 1 | loss: 0.2180833
	speed: 0.0090s/iter; left time: 72.5716s
	iters: 400, epoch: 1 | loss: 1.9481565
	speed: 0.0090s/iter; left time: 71.8800s
	iters: 500, epoch: 1 | loss: 0.3068153
	speed: 0.0090s/iter; left time: 71.1113s
	iters: 600, epoch: 1 | loss: 0.3645503
	speed: 0.0071s/iter; left time: 55.0310s
	iters: 700, epoch: 1 | loss: 0.6270053
	speed: 0.0068s/iter; left time: 51.9193s
	iters: 800, epoch: 1 | loss: 0.3171549
	speed: 0.0089s/iter; left time: 67.4299s
	iters: 900, epoch: 1 | loss: 0.3375884
	speed: 0.0090s/iter; left time: 66.9138s
	iters: 1000, epoch: 1 | loss: 0.7348981
	speed: 0.0089s/iter; left time: 65.8089s
Updating learning rate to 0.0004100213832884344
Validation loss decreased (inf --> 0.2880).  Saving model state dict ...
Epoch: 1 cost time: 9.229949712753296
Epoch: 1, Steps: 1045 | Train Loss: 0.5261074 Vali Loss: 0.2879821 Best vali loss: 0.2879821
	iters: 100, epoch: 2 | loss: 1.0859996
	speed: 0.0263s/iter; left time: 189.8619s
	iters: 200, epoch: 2 | loss: 0.2184052
	speed: 0.0089s/iter; left time: 63.6030s
	iters: 300, epoch: 2 | loss: 0.2058787
	speed: 0.0090s/iter; left time: 62.9744s
	iters: 400, epoch: 2 | loss: 0.9693623
	speed: 0.0091s/iter; left time: 62.6904s
	iters: 500, epoch: 2 | loss: 0.2403440
	speed: 0.0090s/iter; left time: 61.5118s
	iters: 600, epoch: 2 | loss: 0.4317167
	speed: 0.0078s/iter; left time: 52.6851s
	iters: 700, epoch: 2 | loss: 0.3682327
	speed: 0.0059s/iter; left time: 39.3313s
	iters: 800, epoch: 2 | loss: 0.7535093
	speed: 0.0040s/iter; left time: 25.9808s
	iters: 900, epoch: 2 | loss: 1.4509910
	speed: 0.0040s/iter; left time: 25.5039s
	iters: 1000, epoch: 2 | loss: 0.5106091
	speed: 0.0052s/iter; left time: 33.1483s
Updating learning rate to 0.000363822303847431
Validation loss decreased (0.2880 --> 0.2851).  Saving model state dict ...
Epoch: 2 cost time: 7.35795783996582
Epoch: 2, Steps: 1045 | Train Loss: 0.6235049 Vali Loss: 0.2851349 Best vali loss: 0.2851349
	iters: 100, epoch: 3 | loss: 0.6531619
	speed: 0.0175s/iter; left time: 107.7003s
	iters: 200, epoch: 3 | loss: 0.2291439
	speed: 0.0056s/iter; left time: 33.8645s
	iters: 300, epoch: 3 | loss: 1.2678453
	speed: 0.0054s/iter; left time: 32.0056s
	iters: 400, epoch: 3 | loss: 0.4069021
	speed: 0.0051s/iter; left time: 29.7909s
	iters: 500, epoch: 3 | loss: 0.5076476
	speed: 0.0052s/iter; left time: 30.0405s
	iters: 600, epoch: 3 | loss: 0.4444095
	speed: 0.0052s/iter; left time: 29.5171s
	iters: 700, epoch: 3 | loss: 0.2102734
	speed: 0.0043s/iter; left time: 23.6861s
	iters: 800, epoch: 3 | loss: 0.2671219
	speed: 0.0037s/iter; left time: 20.0827s
	iters: 900, epoch: 3 | loss: 0.5572977
	speed: 0.0040s/iter; left time: 21.4906s
	iters: 1000, epoch: 3 | loss: 1.3087020
	speed: 0.0055s/iter; left time: 29.0429s
Updating learning rate to 0.00029468049532618465
Epoch: 3 cost time: 5.240623474121094
Epoch: 3, Steps: 1045 | Train Loss: 0.5852505 Vali Loss: 0.2869198 Best vali loss: 0.2851349

best validation loss 0.28513493472845325

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.00113692195, 'e_layers': 4, 'learning_rate': 0.0017228387955, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4095227
	speed: 0.0130s/iter; left time: 52.9719s
	iters: 200, epoch: 1 | loss: 0.5025270
	speed: 0.0079s/iter; left time: 31.5125s
	iters: 300, epoch: 1 | loss: 0.4264004
	speed: 0.0081s/iter; left time: 31.5948s
	iters: 400, epoch: 1 | loss: 0.2237468
	speed: 0.0079s/iter; left time: 30.0295s
	iters: 500, epoch: 1 | loss: 0.2524214
	speed: 0.0077s/iter; left time: 28.3834s
Updating learning rate to 0.0016572671482394242
Validation loss decreased (inf --> 0.3252).  Saving model state dict ...
Epoch: 1 cost time: 4.389571189880371
Epoch: 1, Steps: 523 | Train Loss: 0.3629237 Vali Loss: 0.3251695 Best vali loss: 0.3251695
	iters: 100, epoch: 2 | loss: 0.3651453
	speed: 0.0163s/iter; left time: 58.0626s
	iters: 200, epoch: 2 | loss: 0.2308996
	speed: 0.0078s/iter; left time: 27.0397s
	iters: 300, epoch: 2 | loss: 0.5544900
	speed: 0.0082s/iter; left time: 27.4681s
	iters: 400, epoch: 2 | loss: 0.3608786
	speed: 0.0079s/iter; left time: 25.9211s
	iters: 500, epoch: 2 | loss: 0.2961375
	speed: 0.0063s/iter; left time: 20.0489s
Updating learning rate to 0.0014705348953446568
Validation loss decreased (0.3252 --> 0.3221).  Saving model state dict ...
Epoch: 2 cost time: 3.9821622371673584
Epoch: 2, Steps: 523 | Train Loss: 0.3615102 Vali Loss: 0.3220857 Best vali loss: 0.3220857
	iters: 100, epoch: 3 | loss: 0.9711576
	speed: 0.0129s/iter; left time: 39.2203s
	iters: 200, epoch: 3 | loss: 0.6146740
	speed: 0.0073s/iter; left time: 21.5056s
	iters: 300, epoch: 3 | loss: 0.4047046
	speed: 0.0076s/iter; left time: 21.4938s
	iters: 400, epoch: 3 | loss: 1.0081036
	speed: 0.0076s/iter; left time: 20.8343s
	iters: 500, epoch: 3 | loss: 0.2077591
	speed: 0.0076s/iter; left time: 19.9317s
Updating learning rate to 0.0011910703295868385
Epoch: 3 cost time: 3.819444417953491
Epoch: 3, Steps: 523 | Train Loss: 0.6412798 Vali Loss: 0.3222045 Best vali loss: 0.3220857

best validation loss 0.32208568334313475

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6356344
	speed: 0.0102s/iter; left time: 20.3246s
	iters: 200, epoch: 1 | loss: 0.5111187
	speed: 0.0045s/iter; left time: 8.5194s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 1.503631830215454
Epoch: 1, Steps: 262 | Train Loss: 0.5733765 Vali Loss: 0.2878953 Best vali loss: 0.2878953
	iters: 100, epoch: 2 | loss: 0.8056782
	speed: 0.0110s/iter; left time: 19.0355s
	iters: 200, epoch: 2 | loss: 0.4165036
	speed: 0.0049s/iter; left time: 8.0477s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.2879 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 1.3443892002105713
Epoch: 2, Steps: 262 | Train Loss: 0.6110909 Vali Loss: 0.2800095 Best vali loss: 0.2800095
	iters: 100, epoch: 3 | loss: 0.4709608
	speed: 0.0114s/iter; left time: 16.7966s
	iters: 200, epoch: 3 | loss: 0.4061714
	speed: 0.0052s/iter; left time: 7.1232s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 1.413999319076538
Epoch: 3, Steps: 262 | Train Loss: 0.4385661 Vali Loss: 0.2802370 Best vali loss: 0.2800095

best validation loss 0.28000953231615044

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5704061
	speed: 0.0108s/iter; left time: 13.0341s
	iters: 200, epoch: 4 | loss: 0.4775725
	speed: 0.0048s/iter; left time: 5.3733s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 1.5636985301971436
Epoch: 4, Steps: 262 | Train Loss: 0.5239893 Vali Loss: 0.2808890 Best vali loss: 0.2800095
	iters: 100, epoch: 5 | loss: 0.7283890
	speed: 0.0108s/iter; left time: 10.2317s
	iters: 200, epoch: 5 | loss: 0.4210139
	speed: 0.0050s/iter; left time: 4.2333s
Updating learning rate to 3.3224917040731837e-05
Validation loss decreased (0.2800 --> 0.2797).  Saving model state dict ...
Epoch: 5 cost time: 1.3457672595977783
Epoch: 5, Steps: 262 | Train Loss: 0.5747014 Vali Loss: 0.2796829 Best vali loss: 0.2796829
	iters: 100, epoch: 6 | loss: 0.4226656
	speed: 0.0107s/iter; left time: 7.3492s
	iters: 200, epoch: 6 | loss: 0.4005705
	speed: 0.0047s/iter; left time: 2.7447s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 1.275710105895996
Epoch: 6, Steps: 262 | Train Loss: 0.4116180 Vali Loss: 0.2801046 Best vali loss: 0.2796829
	iters: 100, epoch: 7 | loss: 0.6626693
	speed: 0.0101s/iter; left time: 4.2776s
	iters: 200, epoch: 7 | loss: 0.2842230
	speed: 0.0051s/iter; left time: 1.6529s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 1.3200085163116455
Epoch: 7, Steps: 262 | Train Loss: 0.4734461 Vali Loss: 0.2801180 Best vali loss: 0.2796829
	iters: 100, epoch: 8 | loss: 0.3839281
	speed: 0.0110s/iter; left time: 1.7992s
	iters: 200, epoch: 8 | loss: 0.7485521
	speed: 0.0047s/iter; left time: 0.2981s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2881217002868652
Epoch: 8, Steps: 262 | Train Loss: 0.5662401 Vali Loss: 0.2800710 Best vali loss: 0.2796829

best validation loss 0.27968287994401436

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0012309194537, 'e_layers': 1, 'learning_rate': 0.0001461940837, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4303916
	speed: 0.0085s/iter; left time: 34.7029s
	iters: 200, epoch: 1 | loss: 0.3298613
	speed: 0.0030s/iter; left time: 12.0925s
	iters: 300, epoch: 1 | loss: 0.4745366
	speed: 0.0030s/iter; left time: 11.7696s
	iters: 400, epoch: 1 | loss: 0.5028348
	speed: 0.0030s/iter; left time: 11.4335s
	iters: 500, epoch: 1 | loss: 0.7538975
	speed: 0.0031s/iter; left time: 11.2537s
Updating learning rate to 0.00014062990270233595
Validation loss decreased (inf --> 0.3025).  Saving model state dict ...
Epoch: 1 cost time: 1.8770947456359863
Epoch: 1, Steps: 523 | Train Loss: 0.4983044 Vali Loss: 0.3024880 Best vali loss: 0.3024880
	iters: 100, epoch: 2 | loss: 0.3891755
	speed: 0.0073s/iter; left time: 26.0000s
	iters: 200, epoch: 2 | loss: 0.5099269
	speed: 0.0030s/iter; left time: 10.3588s
	iters: 300, epoch: 2 | loss: 0.5218753
	speed: 0.0032s/iter; left time: 10.6344s
	iters: 400, epoch: 2 | loss: 0.5621910
	speed: 0.0032s/iter; left time: 10.3160s
	iters: 500, epoch: 2 | loss: 0.1939622
	speed: 0.0031s/iter; left time: 9.9206s
Updating learning rate to 0.00012478445582681183
Validation loss decreased (0.3025 --> 0.2888).  Saving model state dict ...
Epoch: 2 cost time: 1.649641513824463
Epoch: 2, Steps: 523 | Train Loss: 0.4354262 Vali Loss: 0.2887620 Best vali loss: 0.2887620
	iters: 100, epoch: 3 | loss: 0.5507365
	speed: 0.0078s/iter; left time: 23.8389s
	iters: 200, epoch: 3 | loss: 0.8056478
	speed: 0.0030s/iter; left time: 8.9434s
	iters: 300, epoch: 3 | loss: 0.7051224
	speed: 0.0031s/iter; left time: 8.7259s
	iters: 400, epoch: 3 | loss: 0.7160289
	speed: 0.0031s/iter; left time: 8.3683s
	iters: 500, epoch: 3 | loss: 0.2698358
	speed: 0.0029s/iter; left time: 7.6897s
Updating learning rate to 0.00010107006872089262
Validation loss decreased (0.2888 --> 0.2853).  Saving model state dict ...
Epoch: 3 cost time: 1.6237614154815674
Epoch: 3, Steps: 523 | Train Loss: 0.6094743 Vali Loss: 0.2852900 Best vali loss: 0.2852900
	iters: 100, epoch: 4 | loss: 0.2918994
	speed: 0.0076s/iter; left time: 19.0098s
	iters: 200, epoch: 4 | loss: 1.1870430
	speed: 0.0030s/iter; left time: 7.3465s
	iters: 300, epoch: 4 | loss: 0.4076996
	speed: 0.0031s/iter; left time: 7.1117s
	iters: 400, epoch: 4 | loss: 0.5037564
	speed: 0.0031s/iter; left time: 6.9074s
	iters: 500, epoch: 4 | loss: 0.4362306
	speed: 0.0031s/iter; left time: 6.5691s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.2853 --> 0.2824).  Saving model state dict ...
Epoch: 4 cost time: 1.6539368629455566
Epoch: 4, Steps: 523 | Train Loss: 0.5653258 Vali Loss: 0.2824500 Best vali loss: 0.2824500
	iters: 100, epoch: 5 | loss: 0.2179506
	speed: 0.0077s/iter; left time: 15.3771s
	iters: 200, epoch: 5 | loss: 0.6847587
	speed: 0.0030s/iter; left time: 5.5988s
	iters: 300, epoch: 5 | loss: 0.3394588
	speed: 0.0030s/iter; left time: 5.4329s
	iters: 400, epoch: 5 | loss: 0.4027190
	speed: 0.0030s/iter; left time: 4.9948s
	iters: 500, epoch: 5 | loss: 0.4061834
	speed: 0.0026s/iter; left time: 4.1625s
Updating learning rate to 4.512401497910739e-05
Validation loss decreased (0.2824 --> 0.2819).  Saving model state dict ...
Epoch: 5 cost time: 1.5575969219207764
Epoch: 5, Steps: 523 | Train Loss: 0.4102141 Vali Loss: 0.2819265 Best vali loss: 0.2819265
	iters: 100, epoch: 6 | loss: 0.4523037
	speed: 0.0075s/iter; left time: 11.0545s
	iters: 200, epoch: 6 | loss: 0.3116625
	speed: 0.0031s/iter; left time: 4.2436s
	iters: 300, epoch: 6 | loss: 0.5430866
	speed: 0.0031s/iter; left time: 3.9521s
	iters: 400, epoch: 6 | loss: 0.2954815
	speed: 0.0031s/iter; left time: 3.6611s
	iters: 500, epoch: 6 | loss: 0.7753820
	speed: 0.0031s/iter; left time: 3.3293s
Updating learning rate to 2.1409627873188145e-05
Epoch: 6 cost time: 1.6693005561828613
Epoch: 6, Steps: 523 | Train Loss: 0.4755833 Vali Loss: 0.2823055 Best vali loss: 0.2819265
	iters: 100, epoch: 7 | loss: 0.3778194
	speed: 0.0079s/iter; left time: 7.5245s
	iters: 200, epoch: 7 | loss: 0.3194884
	speed: 0.0033s/iter; left time: 2.7601s
	iters: 300, epoch: 7 | loss: 0.5988691
	speed: 0.0032s/iter; left time: 2.3928s
	iters: 400, epoch: 7 | loss: 0.2180509
	speed: 0.0032s/iter; left time: 2.0458s
	iters: 500, epoch: 7 | loss: 0.2987682
	speed: 0.0028s/iter; left time: 1.5583s
Updating learning rate to 5.564180997664037e-06
Epoch: 7 cost time: 1.6785004138946533
Epoch: 7, Steps: 523 | Train Loss: 0.3625992 Vali Loss: 0.2821767 Best vali loss: 0.2819265
	iters: 100, epoch: 8 | loss: 0.7182438
	speed: 0.0075s/iter; left time: 3.1762s
	iters: 200, epoch: 8 | loss: 0.3413305
	speed: 0.0029s/iter; left time: 0.9468s
	iters: 300, epoch: 8 | loss: 0.3344312
	speed: 0.0029s/iter; left time: 0.6570s
	iters: 400, epoch: 8 | loss: 1.3075932
	speed: 0.0030s/iter; left time: 0.3737s
	iters: 500, epoch: 8 | loss: 1.0866299
	speed: 0.0030s/iter; left time: 0.0722s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5823607444763184
Epoch: 8, Steps: 523 | Train Loss: 0.7576457 Vali Loss: 0.2823036 Best vali loss: 0.2819265

best validation loss 0.28192647131192455

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010359583968, 'e_layers': 4, 'learning_rate': 0.0005252026555, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3834732
	speed: 0.0116s/iter; left time: 47.3048s
	iters: 200, epoch: 1 | loss: 0.2517919
	speed: 0.0066s/iter; left time: 26.2208s
	iters: 300, epoch: 1 | loss: 0.6455364
	speed: 0.0066s/iter; left time: 25.5952s
	iters: 400, epoch: 1 | loss: 0.3774767
	speed: 0.0066s/iter; left time: 24.8271s
	iters: 500, epoch: 1 | loss: 0.2962851
	speed: 0.0066s/iter; left time: 24.3398s
Updating learning rate to 0.0005252026555
Validation loss decreased (inf --> 0.2901).  Saving model state dict ...
Epoch: 1 cost time: 3.684213399887085
Epoch: 1, Steps: 523 | Train Loss: 0.3909126 Vali Loss: 0.2900591 Best vali loss: 0.2900591
	iters: 100, epoch: 2 | loss: 0.6704124
	speed: 0.0125s/iter; left time: 44.5845s
	iters: 200, epoch: 2 | loss: 1.4877794
	speed: 0.0065s/iter; left time: 22.3812s
	iters: 300, epoch: 2 | loss: 0.4506539
	speed: 0.0066s/iter; left time: 22.0853s
	iters: 400, epoch: 2 | loss: 0.5294315
	speed: 0.0066s/iter; left time: 21.5208s
	iters: 500, epoch: 2 | loss: 1.1345724
	speed: 0.0066s/iter; left time: 20.8774s
Updating learning rate to 0.00026260132775
Validation loss decreased (0.2901 --> 0.2842).  Saving model state dict ...
Epoch: 2 cost time: 3.418647050857544
Epoch: 2, Steps: 523 | Train Loss: 0.8545699 Vali Loss: 0.2842136 Best vali loss: 0.2842136
	iters: 100, epoch: 3 | loss: 0.3313772
	speed: 0.0129s/iter; left time: 39.1135s
	iters: 200, epoch: 3 | loss: 1.0422682
	speed: 0.0067s/iter; left time: 19.6031s
	iters: 300, epoch: 3 | loss: 0.5913953
	speed: 0.0065s/iter; left time: 18.5026s
	iters: 400, epoch: 3 | loss: 0.4170041
	speed: 0.0067s/iter; left time: 18.3527s
	iters: 500, epoch: 3 | loss: 0.3131365
	speed: 0.0067s/iter; left time: 17.6698s
Updating learning rate to 0.000131300663875
Epoch: 3 cost time: 3.481452703475952
Epoch: 3, Steps: 523 | Train Loss: 0.5390362 Vali Loss: 0.2906015 Best vali loss: 0.2842136
	iters: 100, epoch: 4 | loss: 0.3498053
	speed: 0.0124s/iter; left time: 31.1421s
	iters: 200, epoch: 4 | loss: 0.2861831
	speed: 0.0049s/iter; left time: 11.8404s
	iters: 300, epoch: 4 | loss: 0.1973673
	speed: 0.0071s/iter; left time: 16.3535s
	iters: 400, epoch: 4 | loss: 0.5284708
	speed: 0.0090s/iter; left time: 19.8478s
	iters: 500, epoch: 4 | loss: 0.3391171
	speed: 0.0082s/iter; left time: 17.2720s
Updating learning rate to 6.56503319375e-05
Epoch: 4 cost time: 3.7479653358459473
Epoch: 4, Steps: 523 | Train Loss: 0.3401887 Vali Loss: 0.2887071 Best vali loss: 0.2842136
	iters: 100, epoch: 5 | loss: 0.4399263
	speed: 0.0189s/iter; left time: 37.7063s
	iters: 200, epoch: 5 | loss: 0.6752301
	speed: 0.0070s/iter; left time: 13.1854s
	iters: 300, epoch: 5 | loss: 0.4224968
	speed: 0.0047s/iter; left time: 8.3608s
	iters: 400, epoch: 5 | loss: 0.9986694
	speed: 0.0061s/iter; left time: 10.3570s
	iters: 500, epoch: 5 | loss: 0.1851438
	speed: 0.0080s/iter; left time: 12.7444s
Updating learning rate to 3.282516596875e-05
Epoch: 5 cost time: 3.7575666904449463
Epoch: 5, Steps: 523 | Train Loss: 0.5442933 Vali Loss: 0.2881220 Best vali loss: 0.2842136
	iters: 100, epoch: 6 | loss: 0.6585975
	speed: 0.0173s/iter; left time: 25.3925s
	iters: 200, epoch: 6 | loss: 0.2869916
	speed: 0.0081s/iter; left time: 11.1343s
	iters: 300, epoch: 6 | loss: 0.2849541
	speed: 0.0077s/iter; left time: 9.7619s
	iters: 400, epoch: 6 | loss: 0.6707747
	speed: 0.0072s/iter; left time: 8.3836s
	iters: 500, epoch: 6 | loss: 0.2310340
	speed: 0.0078s/iter; left time: 8.3531s
Updating learning rate to 1.6412582984375e-05
Epoch: 6 cost time: 4.094044208526611
Epoch: 6, Steps: 523 | Train Loss: 0.4264704 Vali Loss: 0.2892819 Best vali loss: 0.2842136
	iters: 100, epoch: 7 | loss: 0.3845073
	speed: 0.0147s/iter; left time: 13.9119s
	iters: 200, epoch: 7 | loss: 0.4969195
	speed: 0.0046s/iter; left time: 3.9071s
	iters: 300, epoch: 7 | loss: 0.5059229
	speed: 0.0060s/iter; left time: 4.4677s
	iters: 400, epoch: 7 | loss: 0.7689767
	speed: 0.0060s/iter; left time: 3.9114s
	iters: 500, epoch: 7 | loss: 0.2799895
	speed: 0.0061s/iter; left time: 3.3606s
Updating learning rate to 8.2062914921875e-06
Epoch: 7 cost time: 2.9714574813842773
Epoch: 7, Steps: 523 | Train Loss: 0.4872632 Vali Loss: 0.2907946 Best vali loss: 0.2842136
	iters: 100, epoch: 8 | loss: 0.3565408
	speed: 0.0119s/iter; left time: 5.0457s
	iters: 200, epoch: 8 | loss: 0.3408854
	speed: 0.0057s/iter; left time: 1.8559s
	iters: 300, epoch: 8 | loss: 0.4740848
	speed: 0.0059s/iter; left time: 1.3191s
	iters: 400, epoch: 8 | loss: 0.3250960
	speed: 0.0058s/iter; left time: 0.7146s
	iters: 500, epoch: 8 | loss: 0.4356441
	speed: 0.0054s/iter; left time: 0.1307s
Updating learning rate to 4.10314574609375e-06
Epoch: 8 cost time: 3.008758068084717
Epoch: 8, Steps: 523 | Train Loss: 0.3864502 Vali Loss: 0.2901553 Best vali loss: 0.2842136

best validation loss 0.2842135589421571

[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014282327355, 'e_layers': 2, 'learning_rate': 0.0011080068437, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4278503
	speed: 0.0103s/iter; left time: 20.5320s
	iters: 200, epoch: 1 | loss: 0.5877262
	speed: 0.0049s/iter; left time: 9.2565s
Updating learning rate to 0.0011080068437
Validation loss decreased (inf --> 0.2961).  Saving model state dict ...
Epoch: 1 cost time: 1.5232481956481934
Epoch: 1, Steps: 262 | Train Loss: 0.5077882 Vali Loss: 0.2960716 Best vali loss: 0.2960716
	iters: 100, epoch: 2 | loss: 0.5059804
	speed: 0.0096s/iter; left time: 16.6726s
	iters: 200, epoch: 2 | loss: 0.3905535
	speed: 0.0037s/iter; left time: 6.0287s
Updating learning rate to 0.00055400342185
Epoch: 2 cost time: 1.0292088985443115
Epoch: 2, Steps: 262 | Train Loss: 0.4482670 Vali Loss: 0.3008500 Best vali loss: 0.2960716
	iters: 100, epoch: 3 | loss: 0.5526885
	speed: 0.0142s/iter; left time: 20.8493s
	iters: 200, epoch: 3 | loss: 0.5884737
	speed: 0.0062s/iter; left time: 8.5758s
Updating learning rate to 0.000277001710925
Epoch: 3 cost time: 1.7113218307495117
Epoch: 3, Steps: 262 | Train Loss: 0.5705811 Vali Loss: 0.3080718 Best vali loss: 0.2960716

best validation loss 0.2960715794838153

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0082216964171, 'e_layers': 4, 'learning_rate': 0.0011920870975, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6058604
	speed: 0.0177s/iter; left time: 35.4198s
	iters: 200, epoch: 1 | loss: 1.0065475
	speed: 0.0096s/iter; left time: 18.1302s
Updating learning rate to 0.0011467159839255183
Validation loss decreased (inf --> 0.3344).  Saving model state dict ...
Epoch: 1 cost time: 3.197091817855835
Epoch: 1, Steps: 262 | Train Loss: 0.8062039 Vali Loss: 0.3344053 Best vali loss: 0.3344053
	iters: 100, epoch: 2 | loss: 0.4867564
	speed: 0.0223s/iter; left time: 38.7525s
	iters: 200, epoch: 2 | loss: 0.7265010
	speed: 0.0114s/iter; left time: 18.7022s
Updating learning rate to 0.0010175099839536193
Validation loss decreased (0.3344 --> 0.3230).  Saving model state dict ...
Epoch: 2 cost time: 2.677159309387207
Epoch: 2, Steps: 262 | Train Loss: 0.6066287 Vali Loss: 0.3229506 Best vali loss: 0.3229506
	iters: 100, epoch: 3 | loss: 0.5838712
	speed: 0.0147s/iter; left time: 21.6236s
	iters: 200, epoch: 3 | loss: 0.5677584
	speed: 0.0106s/iter; left time: 14.6008s
Updating learning rate to 0.0008241395398247187
Validation loss decreased (0.3230 --> 0.3174).  Saving model state dict ...
Epoch: 3 cost time: 2.4310483932495117
Epoch: 3, Steps: 262 | Train Loss: 0.5758148 Vali Loss: 0.3173826 Best vali loss: 0.3173826

best validation loss 0.317382585984617

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006117524437, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2964663
	speed: 0.0125s/iter; left time: 50.8837s
	iters: 200, epoch: 1 | loss: 0.4946739
	speed: 0.0055s/iter; left time: 21.9570s
	iters: 300, epoch: 1 | loss: 1.2075504
	speed: 0.0064s/iter; left time: 24.8638s
	iters: 400, epoch: 1 | loss: 0.6650919
	speed: 0.0060s/iter; left time: 22.6360s
	iters: 500, epoch: 1 | loss: 0.3274342
	speed: 0.0061s/iter; left time: 22.4869s
Updating learning rate to 0.0005884690026990967
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 3.4438676834106445
Epoch: 1, Steps: 523 | Train Loss: 0.5982433 Vali Loss: 0.2877777 Best vali loss: 0.2877777
	iters: 100, epoch: 2 | loss: 0.8219311
	speed: 0.0075s/iter; left time: 26.7141s
	iters: 200, epoch: 2 | loss: 0.6432165
	speed: 0.0041s/iter; left time: 14.1680s
	iters: 300, epoch: 2 | loss: 0.5604844
	speed: 0.0042s/iter; left time: 14.0806s
	iters: 400, epoch: 2 | loss: 0.3052929
	speed: 0.0042s/iter; left time: 13.6876s
	iters: 500, epoch: 2 | loss: 0.5212346
	speed: 0.0042s/iter; left time: 13.2709s
Updating learning rate to 0.0005221633725238558
Epoch: 2 cost time: 2.1410112380981445
Epoch: 2, Steps: 523 | Train Loss: 0.5704319 Vali Loss: 0.2880613 Best vali loss: 0.2877777
	iters: 100, epoch: 3 | loss: 1.4076152
	speed: 0.0097s/iter; left time: 29.3752s
	iters: 200, epoch: 3 | loss: 0.7298802
	speed: 0.0041s/iter; left time: 12.1882s
	iters: 300, epoch: 3 | loss: 0.8842797
	speed: 0.0041s/iter; left time: 11.7615s
	iters: 400, epoch: 3 | loss: 0.3230309
	speed: 0.0042s/iter; left time: 11.3932s
	iters: 500, epoch: 3 | loss: 0.4206440
	speed: 0.0041s/iter; left time: 10.9348s
Updating learning rate to 0.0004229299843064237
Epoch: 3 cost time: 2.2089216709136963
Epoch: 3, Steps: 523 | Train Loss: 0.7530900 Vali Loss: 0.2908202 Best vali loss: 0.2877777

best validation loss 0.28777768529671727

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006117524437, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2463315
	speed: 0.0097s/iter; left time: 24.3694s
	iters: 200, epoch: 4 | loss: 0.3545405
	speed: 0.0040s/iter; left time: 9.5665s
	iters: 300, epoch: 4 | loss: 0.9164706
	speed: 0.0040s/iter; left time: 9.2558s
	iters: 400, epoch: 4 | loss: 0.3531955
	speed: 0.0040s/iter; left time: 8.8021s
	iters: 500, epoch: 4 | loss: 0.3283954
	speed: 0.0042s/iter; left time: 8.8362s
Updating learning rate to 0.00030587622185
Epoch: 4 cost time: 2.390983819961548
Epoch: 4, Steps: 523 | Train Loss: 0.4397867 Vali Loss: 0.2908527 Best vali loss: 0.2877777
	iters: 100, epoch: 5 | loss: 0.7647246
	speed: 0.0097s/iter; left time: 19.3729s
	iters: 200, epoch: 5 | loss: 0.6014572
	speed: 0.0042s/iter; left time: 7.9375s
	iters: 300, epoch: 5 | loss: 0.5421636
	speed: 0.0042s/iter; left time: 7.4931s
	iters: 400, epoch: 5 | loss: 0.3158630
	speed: 0.0042s/iter; left time: 7.1222s
	iters: 500, epoch: 5 | loss: 0.4399866
	speed: 0.0042s/iter; left time: 6.6439s
Updating learning rate to 0.00018882245939357635
Epoch: 5 cost time: 2.2377912998199463
Epoch: 5, Steps: 523 | Train Loss: 0.5328390 Vali Loss: 0.2933929 Best vali loss: 0.2877777
	iters: 100, epoch: 6 | loss: 1.0574737
	speed: 0.0094s/iter; left time: 13.8490s
	iters: 200, epoch: 6 | loss: 0.6440088
	speed: 0.0038s/iter; left time: 5.1863s
	iters: 300, epoch: 6 | loss: 0.6496390
	speed: 0.0039s/iter; left time: 4.8976s
	iters: 400, epoch: 6 | loss: 0.3235013
	speed: 0.0039s/iter; left time: 4.5494s
	iters: 500, epoch: 6 | loss: 0.3786407
	speed: 0.0038s/iter; left time: 4.1089s
Updating learning rate to 8.958907117614421e-05
Epoch: 6 cost time: 2.076810359954834
Epoch: 6, Steps: 523 | Train Loss: 0.6106527 Vali Loss: 0.2939590 Best vali loss: 0.2877777
	iters: 100, epoch: 7 | loss: 0.5322673
	speed: 0.0092s/iter; left time: 8.7376s
	iters: 200, epoch: 7 | loss: 0.3145395
	speed: 0.0041s/iter; left time: 3.4910s
	iters: 300, epoch: 7 | loss: 0.5055273
	speed: 0.0040s/iter; left time: 3.0193s
	iters: 400, epoch: 7 | loss: 0.8975389
	speed: 0.0042s/iter; left time: 2.7232s
	iters: 500, epoch: 7 | loss: 0.2481727
	speed: 0.0042s/iter; left time: 2.3070s
Updating learning rate to 2.328344100090337e-05
Epoch: 7 cost time: 2.1990396976470947
Epoch: 7, Steps: 523 | Train Loss: 0.4996092 Vali Loss: 0.2920548 Best vali loss: 0.2877777
	iters: 100, epoch: 8 | loss: 0.4809680
	speed: 0.0097s/iter; left time: 4.1137s
	iters: 200, epoch: 8 | loss: 0.2085730
	speed: 0.0041s/iter; left time: 1.3262s
	iters: 300, epoch: 8 | loss: 0.3705042
	speed: 0.0041s/iter; left time: 0.9226s
	iters: 400, epoch: 8 | loss: 0.4268272
	speed: 0.0041s/iter; left time: 0.5070s
	iters: 500, epoch: 8 | loss: 0.4415309
	speed: 0.0041s/iter; left time: 0.0995s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1974196434020996
Epoch: 8, Steps: 523 | Train Loss: 0.3856807 Vali Loss: 0.2941685 Best vali loss: 0.2877777

best validation loss 0.28777768529671727

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.2829).  Saving model state dict ...
Epoch: 1 cost time: 0.8807170391082764
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2829255 Best vali loss: 0.2829255
Updating learning rate to 0.0005975820137081337
Epoch: 2 cost time: 0.5884871482849121
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2939710 Best vali loss: 0.2829255
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.5841994285583496
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2943636 Best vali loss: 0.2829255
Updating learning rate to 0.000350055439
Epoch: 4 cost time: 0.6169228553771973
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2860285 Best vali loss: 0.2829255
Updating learning rate to 0.0002160950220854117
Validation loss decreased (0.2829 --> 0.2773).  Saving model state dict ...
Epoch: 5 cost time: 0.6262624263763428
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2773377 Best vali loss: 0.2773377
Updating learning rate to 0.00010252886429186618
Epoch: 6 cost time: 0.6294093132019043
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3054787 Best vali loss: 0.2773377
Updating learning rate to 2.6646383663646746e-05
Epoch: 7 cost time: 0.6314284801483154
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2889122 Best vali loss: 0.2773377
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6318674087524414
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2967863 Best vali loss: 0.2773377

best validation loss 0.27733770989272266

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4277424
	speed: 0.0120s/iter; left time: 98.9563s
	iters: 200, epoch: 1 | loss: 0.2593872
	speed: 0.0065s/iter; left time: 53.4446s
	iters: 300, epoch: 1 | loss: 0.3310376
	speed: 0.0066s/iter; left time: 53.0475s
	iters: 400, epoch: 1 | loss: 0.4147624
	speed: 0.0063s/iter; left time: 50.0557s
	iters: 500, epoch: 1 | loss: 0.2040509
	speed: 0.0055s/iter; left time: 43.3760s
	iters: 600, epoch: 1 | loss: 1.2253639
	speed: 0.0057s/iter; left time: 44.2999s
	iters: 700, epoch: 1 | loss: 1.1520661
	speed: 0.0067s/iter; left time: 51.2584s
	iters: 800, epoch: 1 | loss: 0.2324915
	speed: 0.0064s/iter; left time: 48.4622s
	iters: 900, epoch: 1 | loss: 0.2170449
	speed: 0.0062s/iter; left time: 46.4195s
	iters: 1000, epoch: 1 | loss: 0.3583880
	speed: 0.0063s/iter; left time: 46.3159s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 6.838367223739624
Epoch: 1, Steps: 1045 | Train Loss: 0.4822335 Vali Loss: 0.2868643 Best vali loss: 0.2868643
	iters: 100, epoch: 2 | loss: 0.1763929
	speed: 0.0190s/iter; left time: 137.1774s
	iters: 200, epoch: 2 | loss: 0.2803303
	speed: 0.0065s/iter; left time: 46.4729s
	iters: 300, epoch: 2 | loss: 0.2616337
	speed: 0.0066s/iter; left time: 45.9785s
	iters: 400, epoch: 2 | loss: 0.4828585
	speed: 0.0066s/iter; left time: 45.3573s
	iters: 500, epoch: 2 | loss: 0.5062490
	speed: 0.0062s/iter; left time: 42.2163s
	iters: 600, epoch: 2 | loss: 1.3107723
	speed: 0.0063s/iter; left time: 42.0377s
	iters: 700, epoch: 2 | loss: 0.6903986
	speed: 0.0065s/iter; left time: 42.7021s
	iters: 800, epoch: 2 | loss: 0.2614167
	speed: 0.0064s/iter; left time: 41.5209s
	iters: 900, epoch: 2 | loss: 1.1376568
	speed: 0.0063s/iter; left time: 40.5979s
	iters: 1000, epoch: 2 | loss: 0.4134337
	speed: 0.0065s/iter; left time: 40.8726s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.2869 --> 0.2868).  Saving model state dict ...
Epoch: 2 cost time: 6.75447416305542
Epoch: 2, Steps: 1045 | Train Loss: 0.5521143 Vali Loss: 0.2868210 Best vali loss: 0.2868210
	iters: 100, epoch: 3 | loss: 0.4605928
	speed: 0.0188s/iter; left time: 115.9411s
	iters: 200, epoch: 3 | loss: 0.2269321
	speed: 0.0063s/iter; left time: 38.0035s
	iters: 300, epoch: 3 | loss: 0.8102833
	speed: 0.0063s/iter; left time: 37.4351s
	iters: 400, epoch: 3 | loss: 0.3369110
	speed: 0.0063s/iter; left time: 36.8432s
	iters: 500, epoch: 3 | loss: 0.8283812
	speed: 0.0054s/iter; left time: 31.2821s
	iters: 600, epoch: 3 | loss: 0.2423897
	speed: 0.0054s/iter; left time: 30.7958s
	iters: 700, epoch: 3 | loss: 0.1412322
	speed: 0.0063s/iter; left time: 35.2560s
	iters: 800, epoch: 3 | loss: 1.5074129
	speed: 0.0063s/iter; left time: 34.5803s
	iters: 900, epoch: 3 | loss: 0.2908244
	speed: 0.0064s/iter; left time: 34.1197s
	iters: 1000, epoch: 3 | loss: 0.4889799
	speed: 0.0063s/iter; left time: 33.3785s
Updating learning rate to 0.0004164486617318853
Epoch: 3 cost time: 6.46833348274231
Epoch: 3, Steps: 1045 | Train Loss: 0.5333940 Vali Loss: 0.2935212 Best vali loss: 0.2868210
	iters: 100, epoch: 4 | loss: 0.1421055
	speed: 0.0187s/iter; left time: 95.6260s
	iters: 200, epoch: 4 | loss: 0.6631919
	speed: 0.0063s/iter; left time: 31.4353s
	iters: 300, epoch: 4 | loss: 1.0812093
	speed: 0.0062s/iter; left time: 30.7111s
	iters: 400, epoch: 4 | loss: 0.1905651
	speed: 0.0062s/iter; left time: 30.1360s
	iters: 500, epoch: 4 | loss: 0.4401441
	speed: 0.0057s/iter; left time: 26.9272s
	iters: 600, epoch: 4 | loss: 0.3707706
	speed: 0.0056s/iter; left time: 25.7927s
	iters: 700, epoch: 4 | loss: 0.7085202
	speed: 0.0058s/iter; left time: 26.3575s
	iters: 800, epoch: 4 | loss: 0.3775692
	speed: 0.0061s/iter; left time: 27.0387s
	iters: 900, epoch: 4 | loss: 0.2162700
	speed: 0.0063s/iter; left time: 27.0611s
	iters: 1000, epoch: 4 | loss: 0.9056112
	speed: 0.0063s/iter; left time: 26.6400s
Updating learning rate to 0.0003011887262
Epoch: 4 cost time: 6.392760276794434
Epoch: 4, Steps: 1045 | Train Loss: 0.5095957 Vali Loss: 0.2979448 Best vali loss: 0.2868210
	iters: 100, epoch: 5 | loss: 0.5716396
	speed: 0.0188s/iter; left time: 76.7603s
	iters: 200, epoch: 5 | loss: 0.5676532
	speed: 0.0063s/iter; left time: 24.9806s
	iters: 300, epoch: 5 | loss: 0.2404138
	speed: 0.0062s/iter; left time: 24.0586s
	iters: 400, epoch: 5 | loss: 0.2216989
	speed: 0.0062s/iter; left time: 23.5175s
	iters: 500, epoch: 5 | loss: 0.2054886
	speed: 0.0060s/iter; left time: 22.1484s
	iters: 600, epoch: 5 | loss: 0.5972717
	speed: 0.0053s/iter; left time: 19.1029s
	iters: 700, epoch: 5 | loss: 0.3648386
	speed: 0.0047s/iter; left time: 16.3411s
	iters: 800, epoch: 5 | loss: 0.4278537
	speed: 0.0046s/iter; left time: 15.6032s
	iters: 900, epoch: 5 | loss: 0.8036320
	speed: 0.0046s/iter; left time: 15.0814s
	iters: 1000, epoch: 5 | loss: 0.1442347
	speed: 0.0056s/iter; left time: 17.9253s
Updating learning rate to 0.00018592879066811477
Epoch: 5 cost time: 5.918753147125244
Epoch: 5, Steps: 1045 | Train Loss: 0.4144725 Vali Loss: 0.2872141 Best vali loss: 0.2868210
	iters: 100, epoch: 6 | loss: 0.5359251
	speed: 0.0185s/iter; left time: 56.0227s
	iters: 200, epoch: 6 | loss: 0.3591045
	speed: 0.0057s/iter; left time: 16.6478s
	iters: 300, epoch: 6 | loss: 0.4137720
	speed: 0.0062s/iter; left time: 17.5382s
	iters: 400, epoch: 6 | loss: 0.3504807
	speed: 0.0054s/iter; left time: 14.6793s
	iters: 500, epoch: 6 | loss: 0.6780813
	speed: 0.0044s/iter; left time: 11.6160s
	iters: 600, epoch: 6 | loss: 0.2244362
	speed: 0.0070s/iter; left time: 17.7011s
	iters: 700, epoch: 6 | loss: 0.5883468
	speed: 0.0093s/iter; left time: 22.6883s
	iters: 800, epoch: 6 | loss: 0.2677948
	speed: 0.0046s/iter; left time: 10.8026s
	iters: 900, epoch: 6 | loss: 0.2437501
	speed: 0.0045s/iter; left time: 10.1002s
	iters: 1000, epoch: 6 | loss: 0.5017488
	speed: 0.0060s/iter; left time: 12.7763s
Updating learning rate to 8.821613548704165e-05
Validation loss decreased (0.2868 --> 0.2868).  Saving model state dict ...
Epoch: 6 cost time: 6.2428224086761475
Epoch: 6, Steps: 1045 | Train Loss: 0.4163440 Vali Loss: 0.2868059 Best vali loss: 0.2868059
	iters: 100, epoch: 7 | loss: 0.3439981
	speed: 0.0185s/iter; left time: 36.7558s
	iters: 200, epoch: 7 | loss: 0.2864533
	speed: 0.0064s/iter; left time: 12.1454s
	iters: 300, epoch: 7 | loss: 0.2690395
	speed: 0.0062s/iter; left time: 11.1582s
	iters: 400, epoch: 7 | loss: 1.1801217
	speed: 0.0064s/iter; left time: 10.8971s
	iters: 500, epoch: 7 | loss: 0.2784476
	speed: 0.0065s/iter; left time: 10.3197s
	iters: 600, epoch: 7 | loss: 0.2150078
	speed: 0.0065s/iter; left time: 9.6487s
	iters: 700, epoch: 7 | loss: 0.7871215
	speed: 0.0049s/iter; left time: 6.8300s
	iters: 800, epoch: 7 | loss: 0.4547010
	speed: 0.0047s/iter; left time: 6.0995s
	iters: 900, epoch: 7 | loss: 0.4704832
	speed: 0.0060s/iter; left time: 7.1670s
	iters: 1000, epoch: 7 | loss: 0.2679348
	speed: 0.0062s/iter; left time: 6.7125s
Updating learning rate to 2.292662664067406e-05
Validation loss decreased (0.2868 --> 0.2858).  Saving model state dict ...
Epoch: 7 cost time: 6.322927474975586
Epoch: 7, Steps: 1045 | Train Loss: 0.4553308 Vali Loss: 0.2858350 Best vali loss: 0.2858350
	iters: 100, epoch: 8 | loss: 0.2136312
	speed: 0.0191s/iter; left time: 18.0642s
	iters: 200, epoch: 8 | loss: 0.2307798
	speed: 0.0063s/iter; left time: 5.3319s
	iters: 300, epoch: 8 | loss: 0.3413632
	speed: 0.0062s/iter; left time: 4.6053s
	iters: 400, epoch: 8 | loss: 0.8109025
	speed: 0.0062s/iter; left time: 4.0042s
	iters: 500, epoch: 8 | loss: 0.6357345
	speed: 0.0059s/iter; left time: 3.2160s
	iters: 600, epoch: 8 | loss: 0.8333454
	speed: 0.0062s/iter; left time: 2.7776s
	iters: 700, epoch: 8 | loss: 0.3666157
	speed: 0.0051s/iter; left time: 1.7536s
	iters: 800, epoch: 8 | loss: 0.9088144
	speed: 0.0050s/iter; left time: 1.2329s
	iters: 900, epoch: 8 | loss: 0.2746673
	speed: 0.0062s/iter; left time: 0.9105s
	iters: 1000, epoch: 8 | loss: 0.3360132
	speed: 0.0063s/iter; left time: 0.2912s
Updating learning rate to 0.0
Validation loss decreased (0.2858 --> 0.2845).  Saving model state dict ...
Epoch: 8 cost time: 6.358233690261841
Epoch: 8, Steps: 1045 | Train Loss: 0.4951867 Vali Loss: 0.2845411 Best vali loss: 0.2845411

best validation loss 0.2845411427560106

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012754803453, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4108851
	speed: 0.0110s/iter; left time: 21.8777s
	iters: 200, epoch: 1 | loss: 0.4227895
	speed: 0.0055s/iter; left time: 10.4682s
Updating learning rate to 0.0005919075723073192
Validation loss decreased (inf --> 0.2881).  Saving model state dict ...
Epoch: 1 cost time: 1.6995551586151123
Epoch: 1, Steps: 262 | Train Loss: 0.4168373 Vali Loss: 0.2880959 Best vali loss: 0.2880959
	iters: 100, epoch: 2 | loss: 0.3883878
	speed: 0.0123s/iter; left time: 21.2788s
	iters: 200, epoch: 2 | loss: 0.5692040
	speed: 0.0046s/iter; left time: 7.5891s
Updating learning rate to 0.0005252145019717149
Epoch: 2 cost time: 1.2608284950256348
Epoch: 2, Steps: 262 | Train Loss: 0.4787959 Vali Loss: 0.2937216 Best vali loss: 0.2880959
	iters: 100, epoch: 3 | loss: 0.2940215
	speed: 0.0081s/iter; left time: 11.9096s
	iters: 200, epoch: 3 | loss: 0.5459059
	speed: 0.0043s/iter; left time: 5.8819s
Updating learning rate to 0.00042540126857759495
Validation loss decreased (0.2881 --> 0.2825).  Saving model state dict ...
Epoch: 3 cost time: 1.1092274188995361
Epoch: 3, Steps: 262 | Train Loss: 0.4199637 Vali Loss: 0.2825131 Best vali loss: 0.2825131

best validation loss 0.2825130765302423

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018094463314, 'e_layers': 1, 'learning_rate': 0.003460388698, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00332868549530779
Validation loss decreased (inf --> 0.2902).  Saving model state dict ...
Epoch: 1 cost time: 0.6595993041992188
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2902368 Best vali loss: 0.2902368
Updating learning rate to 0.002953626505948544
Epoch: 2 cost time: 0.4074277877807617
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2915877 Best vali loss: 0.2902368
Updating learning rate to 0.002392311061134002
Epoch: 3 cost time: 0.409895658493042
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2966495 Best vali loss: 0.2902368

best validation loss 0.2902367911781242

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0076454676045, 'e_layers': 4, 'learning_rate': 6.3831307e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4443120
	speed: 0.0123s/iter; left time: 24.5907s
	iters: 200, epoch: 1 | loss: 0.9305122
	speed: 0.0066s/iter; left time: 12.5631s
Updating learning rate to 6.3831307e-05
Validation loss decreased (inf --> 0.3307).  Saving model state dict ...
Epoch: 1 cost time: 2.0289013385772705
Epoch: 1, Steps: 262 | Train Loss: 0.6874121 Vali Loss: 0.3306536 Best vali loss: 0.3306536
	iters: 100, epoch: 2 | loss: 0.3395746
	speed: 0.0139s/iter; left time: 24.1688s
	iters: 200, epoch: 2 | loss: 0.3436528
	speed: 0.0059s/iter; left time: 9.5921s
Updating learning rate to 3.19156535e-05
Validation loss decreased (0.3307 --> 0.3140).  Saving model state dict ...
Epoch: 2 cost time: 1.674485683441162
Epoch: 2, Steps: 262 | Train Loss: 0.3416137 Vali Loss: 0.3140417 Best vali loss: 0.3140417
	iters: 100, epoch: 3 | loss: 0.3829355
	speed: 0.0138s/iter; left time: 20.3866s
	iters: 200, epoch: 3 | loss: 0.8792162
	speed: 0.0069s/iter; left time: 9.4478s
Updating learning rate to 1.595782675e-05
Validation loss decreased (0.3140 --> 0.3091).  Saving model state dict ...
Epoch: 3 cost time: 1.8591258525848389
Epoch: 3, Steps: 262 | Train Loss: 0.6310759 Vali Loss: 0.3091374 Best vali loss: 0.3091374

best validation loss 0.30913740653072247

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012754803453, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4002943
	speed: 0.0099s/iter; left time: 12.0369s
	iters: 200, epoch: 4 | loss: 0.4152507
	speed: 0.0041s/iter; left time: 4.6024s
Updating learning rate to 0.0003076635321
Epoch: 4 cost time: 1.375255823135376
Epoch: 4, Steps: 262 | Train Loss: 0.4077725 Vali Loss: 0.2854295 Best vali loss: 0.2825131
	iters: 100, epoch: 5 | loss: 0.3228892
	speed: 0.0100s/iter; left time: 9.5067s
	iters: 200, epoch: 5 | loss: 0.4223628
	speed: 0.0044s/iter; left time: 3.7505s
Updating learning rate to 0.00018992579562240503
Epoch: 5 cost time: 1.215928554534912
Epoch: 5, Steps: 262 | Train Loss: 0.3726260 Vali Loss: 0.2857895 Best vali loss: 0.2825131
	iters: 100, epoch: 6 | loss: 0.2601771
	speed: 0.0100s/iter; left time: 6.8544s
	iters: 200, epoch: 6 | loss: 0.4774365
	speed: 0.0043s/iter; left time: 2.5063s
Updating learning rate to 9.011256222828497e-05
Validation loss decreased (0.2825 --> 0.2813).  Saving model state dict ...
Epoch: 6 cost time: 1.1575937271118164
Epoch: 6, Steps: 262 | Train Loss: 0.3688068 Vali Loss: 0.2812552 Best vali loss: 0.2812552
	iters: 100, epoch: 7 | loss: 0.4461840
	speed: 0.0096s/iter; left time: 4.0934s
	iters: 200, epoch: 7 | loss: 0.4617437
	speed: 0.0043s/iter; left time: 1.4006s
Updating learning rate to 2.3419491892680736e-05
Epoch: 7 cost time: 1.167433738708496
Epoch: 7, Steps: 262 | Train Loss: 0.4539638 Vali Loss: 0.2886668 Best vali loss: 0.2812552
	iters: 100, epoch: 8 | loss: 0.3690978
	speed: 0.0100s/iter; left time: 1.6271s
	iters: 200, epoch: 8 | loss: 0.3434693
	speed: 0.0044s/iter; left time: 0.2799s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.210420846939087
Epoch: 8, Steps: 262 | Train Loss: 0.3562835 Vali Loss: 0.2880192 Best vali loss: 0.2812552

best validation loss 0.28125516767172

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0016784352926, 'e_layers': 3, 'learning_rate': 0.0010192948397, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7006621
	speed: 0.0114s/iter; left time: 10.8558s
Updating learning rate to 0.0010192948397
Validation loss decreased (inf --> 0.2870).  Saving model state dict ...
Epoch: 1 cost time: 1.0634489059448242
Epoch: 1, Steps: 131 | Train Loss: 0.7006621 Vali Loss: 0.2870479 Best vali loss: 0.2870479
	iters: 100, epoch: 2 | loss: 0.4989083
	speed: 0.0097s/iter; left time: 7.9184s
Updating learning rate to 0.00050964741985
Validation loss decreased (0.2870 --> 0.2866).  Saving model state dict ...
Epoch: 2 cost time: 0.7844588756561279
Epoch: 2, Steps: 131 | Train Loss: 0.4989083 Vali Loss: 0.2865533 Best vali loss: 0.2865533
	iters: 100, epoch: 3 | loss: 0.3606793
	speed: 0.0094s/iter; left time: 6.4739s
Updating learning rate to 0.000254823709925
Epoch: 3 cost time: 0.7743699550628662
Epoch: 3, Steps: 131 | Train Loss: 0.3606793 Vali Loss: 0.2916193 Best vali loss: 0.2865533
	iters: 100, epoch: 4 | loss: 0.4018955
	speed: 0.0093s/iter; left time: 5.1465s
Updating learning rate to 0.0001274118549625
Epoch: 4 cost time: 0.7478044033050537
Epoch: 4, Steps: 131 | Train Loss: 0.4018955 Vali Loss: 0.2874350 Best vali loss: 0.2865533
	iters: 100, epoch: 5 | loss: 0.4734272
	speed: 0.0096s/iter; left time: 4.0930s
Updating learning rate to 6.370592748125e-05
Epoch: 5 cost time: 0.8401980400085449
Epoch: 5, Steps: 131 | Train Loss: 0.4734272 Vali Loss: 0.2879378 Best vali loss: 0.2865533
	iters: 100, epoch: 6 | loss: 0.5317928
	speed: 0.0104s/iter; left time: 3.0652s
Updating learning rate to 3.1852963740625e-05
Epoch: 6 cost time: 0.8709008693695068
Epoch: 6, Steps: 131 | Train Loss: 0.5317928 Vali Loss: 0.2880103 Best vali loss: 0.2865533
	iters: 100, epoch: 7 | loss: 0.4580884
	speed: 0.0105s/iter; left time: 1.7071s
Updating learning rate to 1.59264818703125e-05
Epoch: 7 cost time: 0.8822023868560791
Epoch: 7, Steps: 131 | Train Loss: 0.4580884 Vali Loss: 0.2873441 Best vali loss: 0.2865533
	iters: 100, epoch: 8 | loss: 0.2664977
	speed: 0.0096s/iter; left time: 0.3073s
Updating learning rate to 7.96324093515625e-06
Epoch: 8 cost time: 0.7486457824707031
Epoch: 8, Steps: 131 | Train Loss: 0.2664977 Vali Loss: 0.2877280 Best vali loss: 0.2865533

best validation loss 0.2865532762047171

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012223560033, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9905292
	speed: 0.0129s/iter; left time: 52.5544s
	iters: 200, epoch: 1 | loss: 0.9213640
	speed: 0.0071s/iter; left time: 28.3694s
	iters: 300, epoch: 1 | loss: 0.6888790
	speed: 0.0071s/iter; left time: 27.7342s
	iters: 400, epoch: 1 | loss: 1.1073896
	speed: 0.0066s/iter; left time: 24.8820s
	iters: 500, epoch: 1 | loss: 0.5284669
	speed: 0.0055s/iter; left time: 20.3239s
Updating learning rate to 0.0005598184136
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 3.7495386600494385
Epoch: 1, Steps: 523 | Train Loss: 0.8473257 Vali Loss: 0.2866532 Best vali loss: 0.2866532
	iters: 100, epoch: 2 | loss: 0.3190963
	speed: 0.0125s/iter; left time: 44.6224s
	iters: 200, epoch: 2 | loss: 0.2686304
	speed: 0.0072s/iter; left time: 25.0769s
	iters: 300, epoch: 2 | loss: 0.4672901
	speed: 0.0071s/iter; left time: 23.8672s
	iters: 400, epoch: 2 | loss: 0.4834195
	speed: 0.0069s/iter; left time: 22.6283s
	iters: 500, epoch: 2 | loss: 0.5338672
	speed: 0.0066s/iter; left time: 20.8684s
Updating learning rate to 0.0002799092068
Epoch: 2 cost time: 3.6878578662872314
Epoch: 2, Steps: 523 | Train Loss: 0.4144607 Vali Loss: 0.3166474 Best vali loss: 0.2866532
	iters: 100, epoch: 3 | loss: 0.4340825
	speed: 0.0138s/iter; left time: 41.8604s
	iters: 200, epoch: 3 | loss: 0.2590496
	speed: 0.0069s/iter; left time: 20.4043s
	iters: 300, epoch: 3 | loss: 0.5428599
	speed: 0.0070s/iter; left time: 20.0063s
	iters: 400, epoch: 3 | loss: 0.2950114
	speed: 0.0068s/iter; left time: 18.4992s
	iters: 500, epoch: 3 | loss: 0.7302641
	speed: 0.0059s/iter; left time: 15.5932s
Updating learning rate to 0.0001399546034
Validation loss decreased (0.2867 --> 0.2860).  Saving model state dict ...
Epoch: 3 cost time: 3.5662360191345215
Epoch: 3, Steps: 523 | Train Loss: 0.4522535 Vali Loss: 0.2859514 Best vali loss: 0.2859514
	iters: 100, epoch: 4 | loss: 0.2270799
	speed: 0.0155s/iter; left time: 39.0956s
	iters: 200, epoch: 4 | loss: 0.5558546
	speed: 0.0072s/iter; left time: 17.4237s
	iters: 300, epoch: 4 | loss: 0.6186507
	speed: 0.0067s/iter; left time: 15.6188s
	iters: 400, epoch: 4 | loss: 0.2832205
	speed: 0.0055s/iter; left time: 12.2200s
	iters: 500, epoch: 4 | loss: 0.3143475
	speed: 0.0051s/iter; left time: 10.7617s
Updating learning rate to 6.99773017e-05
Validation loss decreased (0.2860 --> 0.2781).  Saving model state dict ...
Epoch: 4 cost time: 3.3462114334106445
Epoch: 4, Steps: 523 | Train Loss: 0.3998306 Vali Loss: 0.2780903 Best vali loss: 0.2780903
	iters: 100, epoch: 5 | loss: 0.2785195
	speed: 0.0130s/iter; left time: 25.8272s
	iters: 200, epoch: 5 | loss: 0.2834590
	speed: 0.0054s/iter; left time: 10.1665s
	iters: 300, epoch: 5 | loss: 0.4173747
	speed: 0.0061s/iter; left time: 10.9264s
	iters: 400, epoch: 5 | loss: 0.3700939
	speed: 0.0070s/iter; left time: 11.8794s
	iters: 500, epoch: 5 | loss: 0.2216075
	speed: 0.0063s/iter; left time: 9.9685s
Updating learning rate to 3.498865085e-05
Epoch: 5 cost time: 3.288278102874756
Epoch: 5, Steps: 523 | Train Loss: 0.3142109 Vali Loss: 0.2781454 Best vali loss: 0.2780903
	iters: 100, epoch: 6 | loss: 0.3392279
	speed: 0.0124s/iter; left time: 18.2281s
	iters: 200, epoch: 6 | loss: 0.2991266
	speed: 0.0058s/iter; left time: 7.8999s
	iters: 300, epoch: 6 | loss: 0.4423616
	speed: 0.0058s/iter; left time: 7.3622s
	iters: 400, epoch: 6 | loss: 0.2549581
	speed: 0.0057s/iter; left time: 6.7249s
	iters: 500, epoch: 6 | loss: 0.4448538
	speed: 0.0057s/iter; left time: 6.1423s
Updating learning rate to 1.7494325425e-05
Epoch: 6 cost time: 3.0581164360046387
Epoch: 6, Steps: 523 | Train Loss: 0.3561056 Vali Loss: 0.2805035 Best vali loss: 0.2780903
	iters: 100, epoch: 7 | loss: 0.4024561
	speed: 0.0124s/iter; left time: 11.7505s
	iters: 200, epoch: 7 | loss: 0.2029811
	speed: 0.0062s/iter; left time: 5.2843s
	iters: 300, epoch: 7 | loss: 0.5840413
	speed: 0.0063s/iter; left time: 4.6752s
	iters: 400, epoch: 7 | loss: 0.2482083
	speed: 0.0061s/iter; left time: 3.9672s
	iters: 500, epoch: 7 | loss: 0.3848774
	speed: 0.0060s/iter; left time: 3.3059s
Updating learning rate to 8.7471627125e-06
Epoch: 7 cost time: 3.272397994995117
Epoch: 7, Steps: 523 | Train Loss: 0.3645128 Vali Loss: 0.2831278 Best vali loss: 0.2780903
	iters: 100, epoch: 8 | loss: 0.2700954
	speed: 0.0125s/iter; left time: 5.3191s
	iters: 200, epoch: 8 | loss: 0.2579767
	speed: 0.0058s/iter; left time: 1.8785s
	iters: 300, epoch: 8 | loss: 0.3970370
	speed: 0.0060s/iter; left time: 1.3462s
	iters: 400, epoch: 8 | loss: 0.4352491
	speed: 0.0063s/iter; left time: 0.7755s
	iters: 500, epoch: 8 | loss: 0.3155122
	speed: 0.0063s/iter; left time: 0.1506s
Updating learning rate to 4.37358135625e-06
Epoch: 8 cost time: 3.2187628746032715
Epoch: 8, Steps: 523 | Train Loss: 0.3351741 Vali Loss: 0.2827054 Best vali loss: 0.2780903

best validation loss 0.2780903457830545

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0091231059117, 'e_layers': 3, 'learning_rate': 0.0015501326551, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6023505
	speed: 0.0108s/iter; left time: 44.1977s
	iters: 200, epoch: 1 | loss: 1.3566896
	speed: 0.0052s/iter; left time: 20.6974s
	iters: 300, epoch: 1 | loss: 0.6134641
	speed: 0.0053s/iter; left time: 20.5606s
	iters: 400, epoch: 1 | loss: 0.6143194
	speed: 0.0053s/iter; left time: 20.1238s
	iters: 500, epoch: 1 | loss: 0.4087426
	speed: 0.0044s/iter; left time: 16.3318s
Updating learning rate to 0.0015501326551
Validation loss decreased (inf --> 0.3188).  Saving model state dict ...
Epoch: 1 cost time: 2.917275905609131
Epoch: 1, Steps: 523 | Train Loss: 0.7191132 Vali Loss: 0.3188138 Best vali loss: 0.3188138
	iters: 100, epoch: 2 | loss: 1.2241263
	speed: 0.0096s/iter; left time: 34.3288s
	iters: 200, epoch: 2 | loss: 0.4158815
	speed: 0.0048s/iter; left time: 16.6997s
	iters: 300, epoch: 2 | loss: 0.1970470
	speed: 0.0050s/iter; left time: 16.9779s
	iters: 400, epoch: 2 | loss: 0.3673413
	speed: 0.0052s/iter; left time: 16.9981s
	iters: 500, epoch: 2 | loss: 0.7129728
	speed: 0.0044s/iter; left time: 13.9001s
Updating learning rate to 0.00077506632755
Epoch: 2 cost time: 2.578817367553711
Epoch: 2, Steps: 523 | Train Loss: 0.5834738 Vali Loss: 0.3224403 Best vali loss: 0.3188138
	iters: 100, epoch: 3 | loss: 0.8117376
	speed: 0.0090s/iter; left time: 27.3367s
	iters: 200, epoch: 3 | loss: 0.7354670
	speed: 0.0041s/iter; left time: 12.1907s
	iters: 300, epoch: 3 | loss: 0.2486484
	speed: 0.0042s/iter; left time: 11.9141s
	iters: 400, epoch: 3 | loss: 0.3540953
	speed: 0.0051s/iter; left time: 14.0084s
	iters: 500, epoch: 3 | loss: 0.3348105
	speed: 0.0056s/iter; left time: 14.8989s
Updating learning rate to 0.000387533163775
Epoch: 3 cost time: 2.491370916366577
Epoch: 3, Steps: 523 | Train Loss: 0.4969518 Vali Loss: 0.3219946 Best vali loss: 0.3188138

best validation loss 0.31881380563289446

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0045557689701, 'e_layers': 1, 'learning_rate': 0.0003266375974, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003142056940932609
Validation loss decreased (inf --> 0.2855).  Saving model state dict ...
Epoch: 1 cost time: 0.6628918647766113
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2854645 Best vali loss: 0.2854645
Updating learning rate to 0.00027880262875601067
Validation loss decreased (0.2855 --> 0.2811).  Saving model state dict ...
Epoch: 2 cost time: 0.4210224151611328
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2811364 Best vali loss: 0.2811364
Updating learning rate to 0.00022581819715625914
Epoch: 3 cost time: 0.4165077209472656
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2842627 Best vali loss: 0.2811364

best validation loss 0.2811363965173156

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 2, 'learning_rate': 0.0015124708174, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7443253
	speed: 0.0087s/iter; left time: 72.1354s
	iters: 200, epoch: 1 | loss: 0.8976506
	speed: 0.0031s/iter; left time: 24.9297s
	iters: 300, epoch: 1 | loss: 1.1920187
	speed: 0.0035s/iter; left time: 28.3163s
	iters: 400, epoch: 1 | loss: 0.2593891
	speed: 0.0039s/iter; left time: 31.0046s
	iters: 500, epoch: 1 | loss: 0.3921568
	speed: 0.0045s/iter; left time: 35.3360s
	iters: 600, epoch: 1 | loss: 0.2344186
	speed: 0.0037s/iter; left time: 28.9839s
	iters: 700, epoch: 1 | loss: 0.4501418
	speed: 0.0041s/iter; left time: 31.4898s
	iters: 800, epoch: 1 | loss: 1.4189163
	speed: 0.0042s/iter; left time: 31.9851s
	iters: 900, epoch: 1 | loss: 0.2785369
	speed: 0.0037s/iter; left time: 27.5950s
	iters: 1000, epoch: 1 | loss: 0.2756391
	speed: 0.0040s/iter; left time: 29.7938s
Updating learning rate to 0.0015124708174
Validation loss decreased (inf --> 0.3111).  Saving model state dict ...
Epoch: 1 cost time: 4.243680477142334
Epoch: 1, Steps: 1045 | Train Loss: 0.6143193 Vali Loss: 0.3111111 Best vali loss: 0.3111111
	iters: 100, epoch: 2 | loss: 0.4693164
	speed: 0.0136s/iter; left time: 98.0824s
	iters: 200, epoch: 2 | loss: 0.9326937
	speed: 0.0044s/iter; left time: 30.9680s
	iters: 300, epoch: 2 | loss: 0.3625496
	speed: 0.0030s/iter; left time: 21.1175s
	iters: 400, epoch: 2 | loss: 0.2853360
	speed: 0.0030s/iter; left time: 21.0674s
	iters: 500, epoch: 2 | loss: 1.0038580
	speed: 0.0034s/iter; left time: 23.1461s
	iters: 600, epoch: 2 | loss: 0.3436405
	speed: 0.0041s/iter; left time: 27.8350s
	iters: 700, epoch: 2 | loss: 1.0258023
	speed: 0.0040s/iter; left time: 26.5414s
	iters: 800, epoch: 2 | loss: 0.2377724
	speed: 0.0038s/iter; left time: 24.9025s
	iters: 900, epoch: 2 | loss: 0.2873256
	speed: 0.0043s/iter; left time: 27.8799s
	iters: 1000, epoch: 2 | loss: 0.9444680
	speed: 0.0039s/iter; left time: 24.7286s
Updating learning rate to 0.0007562354087
Validation loss decreased (0.3111 --> 0.2846).  Saving model state dict ...
Epoch: 2 cost time: 4.005789041519165
Epoch: 2, Steps: 1045 | Train Loss: 0.5892762 Vali Loss: 0.2846097 Best vali loss: 0.2846097
	iters: 100, epoch: 3 | loss: 0.2591940
	speed: 0.0130s/iter; left time: 80.2405s
	iters: 200, epoch: 3 | loss: 0.2512234
	speed: 0.0033s/iter; left time: 19.8250s
	iters: 300, epoch: 3 | loss: 0.3584221
	speed: 0.0037s/iter; left time: 21.8741s
	iters: 400, epoch: 3 | loss: 0.3956053
	speed: 0.0042s/iter; left time: 24.4862s
	iters: 500, epoch: 3 | loss: 0.1991688
	speed: 0.0041s/iter; left time: 23.6241s
	iters: 600, epoch: 3 | loss: 0.9386401
	speed: 0.0040s/iter; left time: 22.7839s
	iters: 700, epoch: 3 | loss: 0.2824898
	speed: 0.0039s/iter; left time: 21.6216s
	iters: 800, epoch: 3 | loss: 0.1532895
	speed: 0.0039s/iter; left time: 21.1316s
	iters: 900, epoch: 3 | loss: 0.6519269
	speed: 0.0039s/iter; left time: 20.6987s
	iters: 1000, epoch: 3 | loss: 0.1887999
	speed: 0.0039s/iter; left time: 20.6868s
Updating learning rate to 0.00037811770435
Epoch: 3 cost time: 4.0224127769470215
Epoch: 3, Steps: 1045 | Train Loss: 0.3678760 Vali Loss: 0.2870731 Best vali loss: 0.2846097

best validation loss 0.2846097253587176

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0045557689701, 'e_layers': 1, 'learning_rate': 0.0003266375974, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001633187987
Epoch: 4 cost time: 0.5383481979370117
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2891948 Best vali loss: 0.2811364
Updating learning rate to 0.00010081940024374084
Epoch: 5 cost time: 0.28133130073547363
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2867322 Best vali loss: 0.2811364
Updating learning rate to 4.78349686439893e-05
Epoch: 6 cost time: 0.2877819538116455
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2873771 Best vali loss: 0.2811364
Updating learning rate to 1.2431903306739055e-05
Epoch: 7 cost time: 0.3116872310638428
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2876335 Best vali loss: 0.2811364
Updating learning rate to 0.0
Epoch: 8 cost time: 0.2738056182861328
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2879465 Best vali loss: 0.2811364

best validation loss 0.2811363965173156

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 0.7625033855438232
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2823039 Best vali loss: 0.2823039
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 0.5079631805419922
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2877063 Best vali loss: 0.2823039
Updating learning rate to 0.0008072813968307993
Epoch: 3 cost time: 0.5088539123535156
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2905602 Best vali loss: 0.2823039
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 0.5063996315002441
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2929555 Best vali loss: 0.2823039
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 0.5198960304260254
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2951934 Best vali loss: 0.2823039
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.5276057720184326
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2968102 Best vali loss: 0.2823039
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.5042247772216797
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2942502 Best vali loss: 0.2823039
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4914984703063965
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2953185 Best vali loss: 0.2823039

best validation loss 0.28230392111637814

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008573937177, 'e_layers': 4, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.2813).  Saving model state dict ...
Epoch: 1 cost time: 0.8035471439361572
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2812837 Best vali loss: 0.2812837
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 0.5514039993286133
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2817504 Best vali loss: 0.2812837
Updating learning rate to 0.000107972069875
Validation loss decreased (0.2813 --> 0.2798).  Saving model state dict ...
Epoch: 3 cost time: 0.5151181221008301
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2798452 Best vali loss: 0.2798452
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.5204741954803467
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2802504 Best vali loss: 0.2798452
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.5460946559906006
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2806559 Best vali loss: 0.2798452
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.5075757503509521
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2806313 Best vali loss: 0.2798452
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.5202925205230713
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2809024 Best vali loss: 0.2798452
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.5315752029418945
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2811880 Best vali loss: 0.2798452

best validation loss 0.2798452359032303

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0012223560033, 'e_layers': 4, 'learning_rate': 0.0005594578486, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8438067
	speed: 0.0121s/iter; left time: 11.4776s
Updating learning rate to 0.0005381647521121691
Validation loss decreased (inf --> 0.2904).  Saving model state dict ...
Epoch: 1 cost time: 1.1238315105438232
Epoch: 1, Steps: 131 | Train Loss: 0.8438067 Vali Loss: 0.2903886 Best vali loss: 0.2903886
	iters: 100, epoch: 2 | loss: 0.4389502
	speed: 0.0099s/iter; left time: 8.0589s
Updating learning rate to 0.0004775271435665484
Validation loss decreased (0.2904 --> 0.2821).  Saving model state dict ...
Epoch: 2 cost time: 0.7809445858001709
Epoch: 2, Steps: 131 | Train Loss: 0.4389502 Vali Loss: 0.2821189 Best vali loss: 0.2821189
	iters: 100, epoch: 3 | loss: 0.5629204
	speed: 0.0137s/iter; left time: 9.4377s
Updating learning rate to 0.0003867765491829184
Epoch: 3 cost time: 1.2166950702667236
Epoch: 3, Steps: 131 | Train Loss: 0.5629204 Vali Loss: 0.2831842 Best vali loss: 0.2821189

best validation loss 0.2821189118677375

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0004476854138, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2714490
	speed: 0.0138s/iter; left time: 113.8875s
	iters: 200, epoch: 1 | loss: 0.3387904
	speed: 0.0064s/iter; left time: 51.9417s
	iters: 300, epoch: 1 | loss: 1.4326453
	speed: 0.0045s/iter; left time: 35.9574s
	iters: 400, epoch: 1 | loss: 0.4014607
	speed: 0.0057s/iter; left time: 45.3303s
	iters: 500, epoch: 1 | loss: 1.1483099
	speed: 0.0085s/iter; left time: 66.6883s
	iters: 600, epoch: 1 | loss: 0.2501732
	speed: 0.0074s/iter; left time: 57.6031s
	iters: 700, epoch: 1 | loss: 0.9023198
	speed: 0.0079s/iter; left time: 60.2608s
	iters: 800, epoch: 1 | loss: 0.3256604
	speed: 0.0083s/iter; left time: 62.5170s
	iters: 900, epoch: 1 | loss: 0.3625360
	speed: 0.0078s/iter; left time: 58.1170s
	iters: 1000, epoch: 1 | loss: 0.5372928
	speed: 0.0084s/iter; left time: 61.7155s
Updating learning rate to 0.00043064640230683294
Validation loss decreased (inf --> 0.2883).  Saving model state dict ...
Epoch: 1 cost time: 7.917421579360962
Epoch: 1, Steps: 1045 | Train Loss: 0.6970638 Vali Loss: 0.2883415 Best vali loss: 0.2883415
	iters: 100, epoch: 2 | loss: 0.2615525
	speed: 0.0211s/iter; left time: 152.4265s
	iters: 200, epoch: 2 | loss: 0.3155555
	speed: 0.0060s/iter; left time: 42.5825s
	iters: 300, epoch: 2 | loss: 0.2075208
	speed: 0.0062s/iter; left time: 43.7668s
	iters: 400, epoch: 2 | loss: 0.4681508
	speed: 0.0062s/iter; left time: 42.7858s
	iters: 500, epoch: 2 | loss: 0.4613910
	speed: 0.0063s/iter; left time: 42.7070s
	iters: 600, epoch: 2 | loss: 0.1640916
	speed: 0.0062s/iter; left time: 41.7005s
	iters: 700, epoch: 2 | loss: 0.2422908
	speed: 0.0063s/iter; left time: 41.3941s
	iters: 800, epoch: 2 | loss: 1.1909491
	speed: 0.0063s/iter; left time: 41.3197s
	iters: 900, epoch: 2 | loss: 0.4944732
	speed: 0.0063s/iter; left time: 40.2495s
	iters: 1000, epoch: 2 | loss: 0.3721308
	speed: 0.0063s/iter; left time: 39.4960s
Updating learning rate to 0.00038212340286814276
Epoch: 2 cost time: 6.418963193893433
Epoch: 2, Steps: 1045 | Train Loss: 0.4178106 Vali Loss: 0.2912654 Best vali loss: 0.2883415
	iters: 100, epoch: 3 | loss: 0.2536854
	speed: 0.0188s/iter; left time: 115.8838s
	iters: 200, epoch: 3 | loss: 1.2313405
	speed: 0.0066s/iter; left time: 40.2567s
	iters: 300, epoch: 3 | loss: 0.3496170
	speed: 0.0064s/iter; left time: 38.3705s
	iters: 400, epoch: 3 | loss: 0.3330799
	speed: 0.0062s/iter; left time: 36.3374s
	iters: 500, epoch: 3 | loss: 0.7561665
	speed: 0.0063s/iter; left time: 36.6106s
	iters: 600, epoch: 3 | loss: 1.2481250
	speed: 0.0063s/iter; left time: 35.4672s
	iters: 700, epoch: 3 | loss: 1.0100170
	speed: 0.0060s/iter; left time: 33.6383s
	iters: 800, epoch: 3 | loss: 0.7614735
	speed: 0.0061s/iter; left time: 33.3221s
	iters: 900, epoch: 3 | loss: 0.2919908
	speed: 0.0061s/iter; left time: 32.5798s
	iters: 1000, epoch: 3 | loss: 0.3959658
	speed: 0.0063s/iter; left time: 33.1418s
Updating learning rate to 0.00030950360228638475
Validation loss decreased (0.2883 --> 0.2857).  Saving model state dict ...
Epoch: 3 cost time: 6.647989273071289
Epoch: 3, Steps: 1045 | Train Loss: 0.6631461 Vali Loss: 0.2856606 Best vali loss: 0.2856606

best validation loss 0.2856605886947537

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022649231903, 'e_layers': 4, 'learning_rate': 0.0003541777998, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5055793
	speed: 0.0138s/iter; left time: 13.0902s
Updating learning rate to 0.0003541777998
Validation loss decreased (inf --> 0.2774).  Saving model state dict ...
Epoch: 1 cost time: 1.3404085636138916
Epoch: 1, Steps: 131 | Train Loss: 0.5055793 Vali Loss: 0.2774424 Best vali loss: 0.2774424
	iters: 100, epoch: 2 | loss: 0.6316772
	speed: 0.0129s/iter; left time: 10.5770s
Updating learning rate to 0.0001770888999
Epoch: 2 cost time: 1.084867000579834
Epoch: 2, Steps: 131 | Train Loss: 0.6316772 Vali Loss: 0.2840225 Best vali loss: 0.2774424
	iters: 100, epoch: 3 | loss: 0.2901683
	speed: 0.0126s/iter; left time: 8.6700s
Updating learning rate to 8.854444995e-05
Epoch: 3 cost time: 1.0682365894317627
Epoch: 3, Steps: 131 | Train Loss: 0.2901683 Vali Loss: 0.2917489 Best vali loss: 0.2774424

best validation loss 0.2774424373815387

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022649231903, 'e_layers': 4, 'learning_rate': 0.0003541777998, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4183027
	speed: 0.0144s/iter; left time: 8.0145s
Updating learning rate to 4.4272224975e-05
Epoch: 4 cost time: 1.361863374710083
Epoch: 4, Steps: 131 | Train Loss: 0.4183027 Vali Loss: 0.2953144 Best vali loss: 0.2774424
	iters: 100, epoch: 5 | loss: 0.5420610
	speed: 0.0127s/iter; left time: 5.4086s
Updating learning rate to 2.21361124875e-05
Epoch: 5 cost time: 1.0895583629608154
Epoch: 5, Steps: 131 | Train Loss: 0.5420610 Vali Loss: 0.2990618 Best vali loss: 0.2774424
	iters: 100, epoch: 6 | loss: 0.2700995
	speed: 0.0129s/iter; left time: 3.8007s
Updating learning rate to 1.106805624375e-05
Epoch: 6 cost time: 1.089564323425293
Epoch: 6, Steps: 131 | Train Loss: 0.2700995 Vali Loss: 0.3028471 Best vali loss: 0.2774424
	iters: 100, epoch: 7 | loss: 0.3681267
	speed: 0.0127s/iter; left time: 2.0690s
Updating learning rate to 5.534028121875e-06
Epoch: 7 cost time: 1.0761675834655762
Epoch: 7, Steps: 131 | Train Loss: 0.3681267 Vali Loss: 0.3040297 Best vali loss: 0.2774424
	iters: 100, epoch: 8 | loss: 0.4103022
	speed: 0.0127s/iter; left time: 0.4075s
Updating learning rate to 2.7670140609375e-06
Epoch: 8 cost time: 1.0874831676483154
Epoch: 8, Steps: 131 | Train Loss: 0.4103022 Vali Loss: 0.3015125 Best vali loss: 0.2774424

best validation loss 0.2774424373815387

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0077420980639, 'e_layers': 3, 'learning_rate': 0.0044530631044, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2588111
	speed: 0.0112s/iter; left time: 92.1142s
	iters: 200, epoch: 1 | loss: 0.4865642
	speed: 0.0055s/iter; left time: 45.2141s
	iters: 300, epoch: 1 | loss: 0.6137792
	speed: 0.0055s/iter; left time: 44.5493s
	iters: 400, epoch: 1 | loss: 0.4511302
	speed: 0.0055s/iter; left time: 43.9830s
	iters: 500, epoch: 1 | loss: 0.5142580
	speed: 0.0056s/iter; left time: 43.9082s
	iters: 600, epoch: 1 | loss: 0.8953683
	speed: 0.0056s/iter; left time: 43.2001s
	iters: 700, epoch: 1 | loss: 0.2091399
	speed: 0.0056s/iter; left time: 42.5507s
	iters: 800, epoch: 1 | loss: 1.0117942
	speed: 0.0056s/iter; left time: 42.1060s
	iters: 900, epoch: 1 | loss: 0.3002166
	speed: 0.0056s/iter; left time: 41.5715s
	iters: 1000, epoch: 1 | loss: 0.2483798
	speed: 0.0054s/iter; left time: 39.6247s
Updating learning rate to 0.004283578481768166
Validation loss decreased (inf --> 0.3244).  Saving model state dict ...
Epoch: 1 cost time: 6.046504735946655
Epoch: 1, Steps: 1045 | Train Loss: 0.4989442 Vali Loss: 0.3243738 Best vali loss: 0.3243738
	iters: 100, epoch: 2 | loss: 0.4188201
	speed: 0.0161s/iter; left time: 115.8336s
	iters: 200, epoch: 2 | loss: 0.6180942
	speed: 0.0053s/iter; left time: 37.4972s
	iters: 300, epoch: 2 | loss: 0.3788434
	speed: 0.0054s/iter; left time: 37.7979s
	iters: 400, epoch: 2 | loss: 1.4613330
	speed: 0.0053s/iter; left time: 36.4882s
	iters: 500, epoch: 2 | loss: 1.2108546
	speed: 0.0053s/iter; left time: 35.7889s
	iters: 600, epoch: 2 | loss: 0.2701930
	speed: 0.0053s/iter; left time: 35.4353s
	iters: 700, epoch: 2 | loss: 1.2581753
	speed: 0.0053s/iter; left time: 34.8238s
	iters: 800, epoch: 2 | loss: 0.4031626
	speed: 0.0052s/iter; left time: 34.1406s
	iters: 900, epoch: 2 | loss: 0.4548771
	speed: 0.0052s/iter; left time: 33.3910s
	iters: 1000, epoch: 2 | loss: 1.5594755
	speed: 0.0052s/iter; left time: 33.0370s
Updating learning rate to 0.0038009271112864292
Validation loss decreased (0.3244 --> 0.3171).  Saving model state dict ...
Epoch: 2 cost time: 5.544904470443726
Epoch: 2, Steps: 1045 | Train Loss: 0.8033829 Vali Loss: 0.3170603 Best vali loss: 0.3170603
	iters: 100, epoch: 3 | loss: 0.2170714
	speed: 0.0163s/iter; left time: 100.8035s
	iters: 200, epoch: 3 | loss: 0.2362532
	speed: 0.0053s/iter; left time: 32.1736s
	iters: 300, epoch: 3 | loss: 0.2907425
	speed: 0.0056s/iter; left time: 33.3256s
	iters: 400, epoch: 3 | loss: 0.6673894
	speed: 0.0056s/iter; left time: 32.9814s
	iters: 500, epoch: 3 | loss: 1.6673185
	speed: 0.0056s/iter; left time: 32.2468s
	iters: 600, epoch: 3 | loss: 0.3242110
	speed: 0.0056s/iter; left time: 31.5002s
	iters: 700, epoch: 3 | loss: 2.4716039
	speed: 0.0055s/iter; left time: 30.8609s
	iters: 800, epoch: 3 | loss: 0.3282596
	speed: 0.0053s/iter; left time: 29.0361s
	iters: 900, epoch: 3 | loss: 0.3550657
	speed: 0.0054s/iter; left time: 29.1963s
	iters: 1000, epoch: 3 | loss: 0.4729552
	speed: 0.0052s/iter; left time: 27.3249s
Updating learning rate to 0.0030785882888650674
Epoch: 3 cost time: 5.726022720336914
Epoch: 3, Steps: 1045 | Train Loss: 0.7030870 Vali Loss: 0.3214232 Best vali loss: 0.3170603
	iters: 100, epoch: 4 | loss: 0.4539528
	speed: 0.0162s/iter; left time: 82.8109s
	iters: 200, epoch: 4 | loss: 0.2527443
	speed: 0.0053s/iter; left time: 26.7420s
	iters: 300, epoch: 4 | loss: 0.2552916
	speed: 0.0053s/iter; left time: 26.1582s
	iters: 400, epoch: 4 | loss: 0.3710191
	speed: 0.0053s/iter; left time: 25.6215s
	iters: 500, epoch: 4 | loss: 0.3592989
	speed: 0.0053s/iter; left time: 24.9833s
	iters: 600, epoch: 4 | loss: 1.3513267
	speed: 0.0053s/iter; left time: 24.5079s
	iters: 700, epoch: 4 | loss: 0.5297824
	speed: 0.0053s/iter; left time: 23.9656s
	iters: 800, epoch: 4 | loss: 0.9123701
	speed: 0.0053s/iter; left time: 23.4062s
	iters: 900, epoch: 4 | loss: 0.4850557
	speed: 0.0053s/iter; left time: 23.0457s
	iters: 1000, epoch: 4 | loss: 0.2430052
	speed: 0.0053s/iter; left time: 22.4479s
Updating learning rate to 0.0022265315522
Epoch: 4 cost time: 5.597833633422852
Epoch: 4, Steps: 1045 | Train Loss: 0.5213847 Vali Loss: 0.3214559 Best vali loss: 0.3170603
	iters: 100, epoch: 5 | loss: 0.3551014
	speed: 0.0153s/iter; left time: 62.3509s
	iters: 200, epoch: 5 | loss: 0.9181728
	speed: 0.0041s/iter; left time: 16.1661s
	iters: 300, epoch: 5 | loss: 0.1655183
	speed: 0.0061s/iter; left time: 23.6347s
	iters: 400, epoch: 5 | loss: 0.2589872
	speed: 0.0055s/iter; left time: 20.9727s
	iters: 500, epoch: 5 | loss: 0.2498484
	speed: 0.0064s/iter; left time: 23.4362s
	iters: 600, epoch: 5 | loss: 0.4947373
	speed: 0.0058s/iter; left time: 20.8508s
	iters: 700, epoch: 5 | loss: 1.0480117
	speed: 0.0068s/iter; left time: 23.7642s
	iters: 800, epoch: 5 | loss: 0.5573228
	speed: 0.0056s/iter; left time: 18.9886s
	iters: 900, epoch: 5 | loss: 0.6729369
	speed: 0.0061s/iter; left time: 20.0516s
	iters: 1000, epoch: 5 | loss: 0.8184578
	speed: 0.0061s/iter; left time: 19.5058s
Updating learning rate to 0.001374474815534933
Epoch: 5 cost time: 6.026187419891357
Epoch: 5, Steps: 1045 | Train Loss: 0.5539095 Vali Loss: 0.3210008 Best vali loss: 0.3170603
	iters: 100, epoch: 6 | loss: 0.2468391
	speed: 0.0178s/iter; left time: 54.1586s
	iters: 200, epoch: 6 | loss: 0.5447386
	speed: 0.0067s/iter; left time: 19.5317s
	iters: 300, epoch: 6 | loss: 0.3344199
	speed: 0.0056s/iter; left time: 16.0158s
	iters: 400, epoch: 6 | loss: 0.4151888
	speed: 0.0063s/iter; left time: 17.3539s
	iters: 500, epoch: 6 | loss: 0.3536178
	speed: 0.0044s/iter; left time: 11.5301s
	iters: 600, epoch: 6 | loss: 0.4006708
	speed: 0.0043s/iter; left time: 10.8179s
	iters: 700, epoch: 6 | loss: 1.1770841
	speed: 0.0043s/iter; left time: 10.5268s
	iters: 800, epoch: 6 | loss: 0.7656543
	speed: 0.0043s/iter; left time: 10.0236s
	iters: 900, epoch: 6 | loss: 0.3860889
	speed: 0.0050s/iter; left time: 11.1710s
	iters: 1000, epoch: 6 | loss: 1.3117177
	speed: 0.0053s/iter; left time: 11.3878s
Updating learning rate to 0.0006521359931135707
Epoch: 6 cost time: 5.493215560913086
Epoch: 6, Steps: 1045 | Train Loss: 0.5936020 Vali Loss: 0.3221672 Best vali loss: 0.3170603
	iters: 100, epoch: 7 | loss: 0.4335912
	speed: 0.0145s/iter; left time: 28.8129s
	iters: 200, epoch: 7 | loss: 0.2779662
	speed: 0.0045s/iter; left time: 8.5892s
	iters: 300, epoch: 7 | loss: 0.4125657
	speed: 0.0053s/iter; left time: 9.5313s
	iters: 400, epoch: 7 | loss: 0.7827711
	speed: 0.0052s/iter; left time: 8.7888s
	iters: 500, epoch: 7 | loss: 0.4515322
	speed: 0.0054s/iter; left time: 8.5302s
	iters: 600, epoch: 7 | loss: 0.3222009
	speed: 0.0054s/iter; left time: 8.0897s
	iters: 700, epoch: 7 | loss: 1.1071308
	speed: 0.0054s/iter; left time: 7.4803s
	iters: 800, epoch: 7 | loss: 0.5930426
	speed: 0.0051s/iter; left time: 6.5450s
	iters: 900, epoch: 7 | loss: 1.0515312
	speed: 0.0048s/iter; left time: 5.7383s
	iters: 1000, epoch: 7 | loss: 1.1370034
	speed: 0.0052s/iter; left time: 5.7052s
Updating learning rate to 0.00016948462263183437
Epoch: 7 cost time: 5.3026251792907715
Epoch: 7, Steps: 1045 | Train Loss: 0.6569335 Vali Loss: 0.3221258 Best vali loss: 0.3170603
	iters: 100, epoch: 8 | loss: 0.4461389
	speed: 0.0168s/iter; left time: 15.8961s
	iters: 200, epoch: 8 | loss: 0.5816891
	speed: 0.0053s/iter; left time: 4.4955s
	iters: 300, epoch: 8 | loss: 1.3434606
	speed: 0.0053s/iter; left time: 3.9638s
	iters: 400, epoch: 8 | loss: 0.3328519
	speed: 0.0048s/iter; left time: 3.1104s
	iters: 500, epoch: 8 | loss: 0.4858714
	speed: 0.0051s/iter; left time: 2.7606s
	iters: 600, epoch: 8 | loss: 0.3450357
	speed: 0.0052s/iter; left time: 2.2974s
	iters: 700, epoch: 8 | loss: 0.4197975
	speed: 0.0053s/iter; left time: 1.8209s
	iters: 800, epoch: 8 | loss: 0.4129683
	speed: 0.0054s/iter; left time: 1.3356s
	iters: 900, epoch: 8 | loss: 0.4846729
	speed: 0.0053s/iter; left time: 0.7776s
	iters: 1000, epoch: 8 | loss: 1.3585492
	speed: 0.0053s/iter; left time: 0.2457s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.5066821575164795
Epoch: 8, Steps: 1045 | Train Loss: 0.6211036 Vali Loss: 0.3222066 Best vali loss: 0.3170603

best validation loss 0.31706034639547553

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5135518
	speed: 0.0121s/iter; left time: 11.4886s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.1370203495025635
Epoch: 1, Steps: 131 | Train Loss: 0.5135518 Vali Loss: 0.2873531 Best vali loss: 0.2873531
	iters: 100, epoch: 2 | loss: 0.3462625
	speed: 0.0106s/iter; left time: 8.6670s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.2874 --> 0.2829).  Saving model state dict ...
Epoch: 2 cost time: 0.8929226398468018
Epoch: 2, Steps: 131 | Train Loss: 0.3462625 Vali Loss: 0.2829465 Best vali loss: 0.2829465
	iters: 100, epoch: 3 | loss: 0.4458885
	speed: 0.0108s/iter; left time: 7.4360s
Updating learning rate to 0.000178512795825
Epoch: 3 cost time: 0.9249560832977295
Epoch: 3, Steps: 131 | Train Loss: 0.4458885 Vali Loss: 0.2830954 Best vali loss: 0.2829465
	iters: 100, epoch: 4 | loss: 0.4997855
	speed: 0.0106s/iter; left time: 5.8910s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 0.8941128253936768
Epoch: 4, Steps: 131 | Train Loss: 0.4997855 Vali Loss: 0.2906327 Best vali loss: 0.2829465
	iters: 100, epoch: 5 | loss: 0.3238942
	speed: 0.0105s/iter; left time: 4.4809s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 0.9060509204864502
Epoch: 5, Steps: 131 | Train Loss: 0.3238942 Vali Loss: 0.2876046 Best vali loss: 0.2829465
	iters: 100, epoch: 6 | loss: 0.5614570
	speed: 0.0109s/iter; left time: 3.2190s
Updating learning rate to 2.2314099478125e-05
Epoch: 6 cost time: 0.9019052982330322
Epoch: 6, Steps: 131 | Train Loss: 0.5614570 Vali Loss: 0.2881716 Best vali loss: 0.2829465
	iters: 100, epoch: 7 | loss: 0.4734257
	speed: 0.0105s/iter; left time: 1.7037s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 0.903594970703125
Epoch: 7, Steps: 131 | Train Loss: 0.4734257 Vali Loss: 0.2874254 Best vali loss: 0.2829465
	iters: 100, epoch: 8 | loss: 0.2365951
	speed: 0.0106s/iter; left time: 0.3398s
Updating learning rate to 5.57852486953125e-06
Epoch: 8 cost time: 0.8895623683929443
Epoch: 8, Steps: 131 | Train Loss: 0.2365951 Vali Loss: 0.2890414 Best vali loss: 0.2829465

best validation loss 0.28294653935630154

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008582998373, 'e_layers': 1, 'learning_rate': 0.0002750366042, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6812351
	speed: 0.0086s/iter; left time: 8.1448s
Updating learning rate to 0.0002645686467558939
Validation loss decreased (inf --> 0.2814).  Saving model state dict ...
Epoch: 1 cost time: 0.6971936225891113
Epoch: 1, Steps: 131 | Train Loss: 0.6812351 Vali Loss: 0.2814028 Best vali loss: 0.2814028
	iters: 100, epoch: 2 | loss: 0.3904476
	speed: 0.0057s/iter; left time: 4.6441s
Updating learning rate to 0.00023475842605217025
Validation loss decreased (0.2814 --> 0.2807).  Saving model state dict ...
Epoch: 2 cost time: 0.4065420627593994
Epoch: 2, Steps: 131 | Train Loss: 0.3904476 Vali Loss: 0.2807240 Best vali loss: 0.2807240
	iters: 100, epoch: 3 | loss: 0.5130739
	speed: 0.0056s/iter; left time: 3.8260s
Updating learning rate to 0.00019014427796064737
Validation loss decreased (0.2807 --> 0.2764).  Saving model state dict ...
Epoch: 3 cost time: 0.42195773124694824
Epoch: 3, Steps: 131 | Train Loss: 0.5130739 Vali Loss: 0.2764331 Best vali loss: 0.2764331

best validation loss 0.27643313627120686

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.006740282698, 'e_layers': 4, 'learning_rate': 0.0001043113492, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6056114
	speed: 0.0119s/iter; left time: 48.7182s
	iters: 200, epoch: 1 | loss: 0.9414268
	speed: 0.0063s/iter; left time: 25.0135s
	iters: 300, epoch: 1 | loss: 0.4281795
	speed: 0.0062s/iter; left time: 24.0863s
	iters: 400, epoch: 1 | loss: 0.5431172
	speed: 0.0062s/iter; left time: 23.4034s
	iters: 500, epoch: 1 | loss: 0.2998491
	speed: 0.0064s/iter; left time: 23.4295s
Updating learning rate to 0.0001043113492
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 3.566406726837158
Epoch: 1, Steps: 523 | Train Loss: 0.5636368 Vali Loss: 0.2835063 Best vali loss: 0.2835063
	iters: 100, epoch: 2 | loss: 0.6988955
	speed: 0.0135s/iter; left time: 48.2062s
	iters: 200, epoch: 2 | loss: 0.4013875
	speed: 0.0069s/iter; left time: 23.8849s
	iters: 300, epoch: 2 | loss: 0.4517747
	speed: 0.0065s/iter; left time: 22.0154s
	iters: 400, epoch: 2 | loss: 0.8519531
	speed: 0.0064s/iter; left time: 20.9218s
	iters: 500, epoch: 2 | loss: 0.3519530
	speed: 0.0047s/iter; left time: 14.7246s
Updating learning rate to 5.21556746e-05
Validation loss decreased (0.2835 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 3.2937123775482178
Epoch: 2, Steps: 523 | Train Loss: 0.5511927 Vali Loss: 0.2791871 Best vali loss: 0.2791871
	iters: 100, epoch: 3 | loss: 0.2492960
	speed: 0.0123s/iter; left time: 37.5286s
	iters: 200, epoch: 3 | loss: 0.6642076
	speed: 0.0067s/iter; left time: 19.5525s
	iters: 300, epoch: 3 | loss: 0.8751898
	speed: 0.0066s/iter; left time: 18.8737s
	iters: 400, epoch: 3 | loss: 0.7782615
	speed: 0.0067s/iter; left time: 18.2691s
	iters: 500, epoch: 3 | loss: 0.3333184
	speed: 0.0066s/iter; left time: 17.4036s
Updating learning rate to 2.60778373e-05
Epoch: 3 cost time: 3.515362501144409
Epoch: 3, Steps: 523 | Train Loss: 0.5800547 Vali Loss: 0.2797825 Best vali loss: 0.2791871

best validation loss 0.2791870523780285

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020155805449, 'e_layers': 3, 'learning_rate': 0.0005770289561, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2129702
	speed: 0.0114s/iter; left time: 93.8100s
	iters: 200, epoch: 1 | loss: 0.5226012
	speed: 0.0058s/iter; left time: 47.5147s
	iters: 300, epoch: 1 | loss: 0.3572561
	speed: 0.0058s/iter; left time: 47.1301s
	iters: 400, epoch: 1 | loss: 1.1517445
	speed: 0.0055s/iter; left time: 44.0259s
	iters: 500, epoch: 1 | loss: 0.3915937
	speed: 0.0050s/iter; left time: 39.6610s
	iters: 600, epoch: 1 | loss: 0.2534162
	speed: 0.0061s/iter; left time: 47.2257s
	iters: 700, epoch: 1 | loss: 0.3492389
	speed: 0.0060s/iter; left time: 46.2159s
	iters: 800, epoch: 1 | loss: 0.2645187
	speed: 0.0061s/iter; left time: 46.2215s
	iters: 900, epoch: 1 | loss: 0.8800119
	speed: 0.0059s/iter; left time: 44.2339s
	iters: 1000, epoch: 1 | loss: 0.4407256
	speed: 0.0061s/iter; left time: 44.5582s
Updating learning rate to 0.0005770289561
Validation loss decreased (inf --> 0.2915).  Saving model state dict ...
Epoch: 1 cost time: 6.390876293182373
Epoch: 1, Steps: 1045 | Train Loss: 0.4824077 Vali Loss: 0.2915030 Best vali loss: 0.2915030
	iters: 100, epoch: 2 | loss: 0.6255285
	speed: 0.0170s/iter; left time: 122.4126s
	iters: 200, epoch: 2 | loss: 0.4177127
	speed: 0.0052s/iter; left time: 37.1919s
	iters: 300, epoch: 2 | loss: 0.5216003
	speed: 0.0052s/iter; left time: 36.8127s
	iters: 400, epoch: 2 | loss: 0.2141019
	speed: 0.0052s/iter; left time: 35.7929s
	iters: 500, epoch: 2 | loss: 0.4834369
	speed: 0.0052s/iter; left time: 35.3837s
	iters: 600, epoch: 2 | loss: 0.9517510
	speed: 0.0051s/iter; left time: 34.3616s
	iters: 700, epoch: 2 | loss: 0.9467109
	speed: 0.0047s/iter; left time: 30.9630s
	iters: 800, epoch: 2 | loss: 0.5837417
	speed: 0.0052s/iter; left time: 33.7036s
	iters: 900, epoch: 2 | loss: 0.7017370
	speed: 0.0062s/iter; left time: 39.9876s
	iters: 1000, epoch: 2 | loss: 0.4858883
	speed: 0.0060s/iter; left time: 37.9737s
Updating learning rate to 0.00028851447805
Epoch: 2 cost time: 5.641298532485962
Epoch: 2, Steps: 1045 | Train Loss: 0.5932209 Vali Loss: 0.2925076 Best vali loss: 0.2915030
	iters: 100, epoch: 3 | loss: 1.1059515
	speed: 0.0169s/iter; left time: 104.3532s
	iters: 200, epoch: 3 | loss: 0.2815114
	speed: 0.0052s/iter; left time: 31.2689s
	iters: 300, epoch: 3 | loss: 0.2430543
	speed: 0.0045s/iter; left time: 26.6523s
	iters: 400, epoch: 3 | loss: 0.2596681
	speed: 0.0040s/iter; left time: 23.5798s
	iters: 500, epoch: 3 | loss: 0.3532695
	speed: 0.0059s/iter; left time: 33.9012s
	iters: 600, epoch: 3 | loss: 0.2158323
	speed: 0.0059s/iter; left time: 33.6445s
	iters: 700, epoch: 3 | loss: 0.3110169
	speed: 0.0065s/iter; left time: 36.0971s
	iters: 800, epoch: 3 | loss: 0.2937640
	speed: 0.0059s/iter; left time: 32.2956s
	iters: 900, epoch: 3 | loss: 0.3147951
	speed: 0.0063s/iter; left time: 33.8932s
	iters: 1000, epoch: 3 | loss: 0.3659855
	speed: 0.0058s/iter; left time: 30.7556s
Updating learning rate to 0.000144257239025
Epoch: 3 cost time: 5.800400733947754
Epoch: 3, Steps: 1045 | Train Loss: 0.3744849 Vali Loss: 0.2946188 Best vali loss: 0.2915030

best validation loss 0.29150302934797334

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008582998373, 'e_layers': 1, 'learning_rate': 0.0002750366042, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5703117
	speed: 0.0090s/iter; left time: 5.0118s
Updating learning rate to 0.0001375183021
Epoch: 4 cost time: 0.7188866138458252
Epoch: 4, Steps: 131 | Train Loss: 0.5703117 Vali Loss: 0.2799573 Best vali loss: 0.2764331
	iters: 100, epoch: 5 | loss: 0.3851381
	speed: 0.0061s/iter; left time: 2.6033s
Updating learning rate to 8.489232623935268e-05
Epoch: 5 cost time: 0.4574463367462158
Epoch: 5, Steps: 131 | Train Loss: 0.3851381 Vali Loss: 0.2838090 Best vali loss: 0.2764331
	iters: 100, epoch: 6 | loss: 0.4587527
	speed: 0.0061s/iter; left time: 1.7936s
Updating learning rate to 4.027817814782977e-05
Epoch: 6 cost time: 0.4854893684387207
Epoch: 6, Steps: 131 | Train Loss: 0.4587527 Vali Loss: 0.2862873 Best vali loss: 0.2764331
	iters: 100, epoch: 7 | loss: 0.4374012
	speed: 0.0060s/iter; left time: 0.9782s
Updating learning rate to 1.0467957444106099e-05
Epoch: 7 cost time: 0.45371270179748535
Epoch: 7, Steps: 131 | Train Loss: 0.4374012 Vali Loss: 0.2856608 Best vali loss: 0.2764331
	iters: 100, epoch: 8 | loss: 0.4408653
	speed: 0.0058s/iter; left time: 0.1872s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4495368003845215
Epoch: 8, Steps: 131 | Train Loss: 0.4408653 Vali Loss: 0.2880802 Best vali loss: 0.2764331

best validation loss 0.27643313627120686

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0016263438524, 'e_layers': 1, 'learning_rate': 0.0001009597245, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4688667
	speed: 0.0089s/iter; left time: 8.4826s
Updating learning rate to 0.0001009597245
Validation loss decreased (inf --> 0.2791).  Saving model state dict ...
Epoch: 1 cost time: 0.7317428588867188
Epoch: 1, Steps: 131 | Train Loss: 0.4688667 Vali Loss: 0.2790949 Best vali loss: 0.2790949
	iters: 100, epoch: 2 | loss: 0.4072749
	speed: 0.0063s/iter; left time: 5.1148s
Updating learning rate to 5.047986225e-05
Validation loss decreased (0.2791 --> 0.2788).  Saving model state dict ...
Epoch: 2 cost time: 0.448014497756958
Epoch: 2, Steps: 131 | Train Loss: 0.4072749 Vali Loss: 0.2787716 Best vali loss: 0.2787716
	iters: 100, epoch: 3 | loss: 0.4480033
	speed: 0.0061s/iter; left time: 4.1941s
Updating learning rate to 2.5239931125e-05
Epoch: 3 cost time: 0.43917012214660645
Epoch: 3, Steps: 131 | Train Loss: 0.4480033 Vali Loss: 0.2790640 Best vali loss: 0.2787716
	iters: 100, epoch: 4 | loss: 0.3754105
	speed: 0.0056s/iter; left time: 3.0937s
Updating learning rate to 1.26199655625e-05
Validation loss decreased (0.2788 --> 0.2782).  Saving model state dict ...
Epoch: 4 cost time: 0.41501402854919434
Epoch: 4, Steps: 131 | Train Loss: 0.3754105 Vali Loss: 0.2782166 Best vali loss: 0.2782166
	iters: 100, epoch: 5 | loss: 0.3938771
	speed: 0.0061s/iter; left time: 2.5921s
Updating learning rate to 6.30998278125e-06
Epoch: 5 cost time: 0.44925832748413086
Epoch: 5, Steps: 131 | Train Loss: 0.3938771 Vali Loss: 0.2784972 Best vali loss: 0.2782166
	iters: 100, epoch: 6 | loss: 0.5008253
	speed: 0.0061s/iter; left time: 1.7843s
Updating learning rate to 3.154991390625e-06
Epoch: 6 cost time: 0.45791196823120117
Epoch: 6, Steps: 131 | Train Loss: 0.5008253 Vali Loss: 0.2784467 Best vali loss: 0.2782166
	iters: 100, epoch: 7 | loss: 0.4695401
	speed: 0.0059s/iter; left time: 0.9696s
Updating learning rate to 1.5774956953125e-06
Epoch: 7 cost time: 0.43105125427246094
Epoch: 7, Steps: 131 | Train Loss: 0.4695401 Vali Loss: 0.2784962 Best vali loss: 0.2782166
	iters: 100, epoch: 8 | loss: 0.3967548
	speed: 0.0057s/iter; left time: 0.1837s
Updating learning rate to 7.8874784765625e-07
Epoch: 8 cost time: 0.42902421951293945
Epoch: 8, Steps: 131 | Train Loss: 0.3967548 Vali Loss: 0.2785867 Best vali loss: 0.2782166

best validation loss 0.2782166276823947

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0061170225804, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2227128
	speed: 0.0093s/iter; left time: 76.4231s
	iters: 200, epoch: 1 | loss: 1.1382082
	speed: 0.0038s/iter; left time: 31.2488s
	iters: 300, epoch: 1 | loss: 0.2096956
	speed: 0.0047s/iter; left time: 38.1370s
	iters: 400, epoch: 1 | loss: 0.2639671
	speed: 0.0045s/iter; left time: 35.5310s
	iters: 500, epoch: 1 | loss: 0.2123147
	speed: 0.0044s/iter; left time: 34.3440s
	iters: 600, epoch: 1 | loss: 0.1493997
	speed: 0.0045s/iter; left time: 34.7557s
	iters: 700, epoch: 1 | loss: 1.3840396
	speed: 0.0044s/iter; left time: 33.4874s
	iters: 800, epoch: 1 | loss: 0.2576803
	speed: 0.0043s/iter; left time: 32.2786s
	iters: 900, epoch: 1 | loss: 0.1857863
	speed: 0.0044s/iter; left time: 32.6833s
	iters: 1000, epoch: 1 | loss: 0.2828548
	speed: 0.0044s/iter; left time: 32.3266s
Updating learning rate to 0.0005675671244
Validation loss decreased (inf --> 0.2856).  Saving model state dict ...
Epoch: 1 cost time: 4.7886693477630615
Epoch: 1, Steps: 1045 | Train Loss: 0.4306659 Vali Loss: 0.2855529 Best vali loss: 0.2855529
	iters: 100, epoch: 2 | loss: 0.2541856
	speed: 0.0138s/iter; left time: 99.4578s
	iters: 200, epoch: 2 | loss: 0.9671406
	speed: 0.0041s/iter; left time: 28.9199s
	iters: 300, epoch: 2 | loss: 0.2105291
	speed: 0.0044s/iter; left time: 30.6828s
	iters: 400, epoch: 2 | loss: 0.7236593
	speed: 0.0045s/iter; left time: 30.8137s
	iters: 500, epoch: 2 | loss: 0.2879230
	speed: 0.0044s/iter; left time: 30.0713s
	iters: 600, epoch: 2 | loss: 0.9124554
	speed: 0.0044s/iter; left time: 29.7535s
	iters: 700, epoch: 2 | loss: 0.2987365
	speed: 0.0045s/iter; left time: 29.5034s
	iters: 800, epoch: 2 | loss: 1.3070712
	speed: 0.0044s/iter; left time: 28.9620s
	iters: 900, epoch: 2 | loss: 0.2346189
	speed: 0.0044s/iter; left time: 28.3716s
	iters: 1000, epoch: 2 | loss: 1.0057628
	speed: 0.0045s/iter; left time: 28.3163s
Updating learning rate to 0.0002837835622
Validation loss decreased (0.2856 --> 0.2806).  Saving model state dict ...
Epoch: 2 cost time: 4.602499723434448
Epoch: 2, Steps: 1045 | Train Loss: 0.6202082 Vali Loss: 0.2806375 Best vali loss: 0.2806375
	iters: 100, epoch: 3 | loss: 0.1792196
	speed: 0.0137s/iter; left time: 84.2749s
	iters: 200, epoch: 3 | loss: 0.2851158
	speed: 0.0037s/iter; left time: 22.7241s
	iters: 300, epoch: 3 | loss: 0.7066050
	speed: 0.0040s/iter; left time: 24.1424s
	iters: 400, epoch: 3 | loss: 0.6520718
	speed: 0.0040s/iter; left time: 23.6689s
	iters: 500, epoch: 3 | loss: 1.1604229
	speed: 0.0040s/iter; left time: 23.1857s
	iters: 600, epoch: 3 | loss: 0.2410760
	speed: 0.0040s/iter; left time: 22.8902s
	iters: 700, epoch: 3 | loss: 0.2453733
	speed: 0.0041s/iter; left time: 22.8452s
	iters: 800, epoch: 3 | loss: 0.3418291
	speed: 0.0041s/iter; left time: 22.3468s
	iters: 900, epoch: 3 | loss: 0.4227392
	speed: 0.0041s/iter; left time: 21.7638s
	iters: 1000, epoch: 3 | loss: 0.4872834
	speed: 0.0041s/iter; left time: 21.3949s
Updating learning rate to 0.0001418917811
Epoch: 3 cost time: 4.228266716003418
Epoch: 3, Steps: 1045 | Train Loss: 0.4721736 Vali Loss: 0.2880282 Best vali loss: 0.2806375
	iters: 100, epoch: 4 | loss: 0.4330901
	speed: 0.0143s/iter; left time: 73.3540s
	iters: 200, epoch: 4 | loss: 0.2477431
	speed: 0.0041s/iter; left time: 20.8167s
	iters: 300, epoch: 4 | loss: 0.3009928
	speed: 0.0042s/iter; left time: 20.7020s
	iters: 400, epoch: 4 | loss: 0.2862373
	speed: 0.0043s/iter; left time: 20.5843s
	iters: 500, epoch: 4 | loss: 0.5778181
	speed: 0.0041s/iter; left time: 19.4745s
	iters: 600, epoch: 4 | loss: 0.3693274
	speed: 0.0042s/iter; left time: 19.2160s
	iters: 700, epoch: 4 | loss: 0.2829451
	speed: 0.0041s/iter; left time: 18.7227s
	iters: 800, epoch: 4 | loss: 0.5619330
	speed: 0.0042s/iter; left time: 18.5313s
	iters: 900, epoch: 4 | loss: 0.3164491
	speed: 0.0042s/iter; left time: 18.1830s
	iters: 1000, epoch: 4 | loss: 0.2997310
	speed: 0.0042s/iter; left time: 17.6531s
Updating learning rate to 7.094589055e-05
Epoch: 4 cost time: 4.43426251411438
Epoch: 4, Steps: 1045 | Train Loss: 0.3676267 Vali Loss: 0.2996130 Best vali loss: 0.2806375
	iters: 100, epoch: 5 | loss: 0.2006152
	speed: 0.0140s/iter; left time: 57.1107s
	iters: 200, epoch: 5 | loss: 0.4621347
	speed: 0.0040s/iter; left time: 15.9994s
	iters: 300, epoch: 5 | loss: 0.4886181
	speed: 0.0042s/iter; left time: 16.3706s
	iters: 400, epoch: 5 | loss: 0.2602486
	speed: 0.0043s/iter; left time: 16.0991s
	iters: 500, epoch: 5 | loss: 0.1829972
	speed: 0.0045s/iter; left time: 16.3992s
	iters: 600, epoch: 5 | loss: 0.3737117
	speed: 0.0045s/iter; left time: 16.1158s
	iters: 700, epoch: 5 | loss: 0.2002585
	speed: 0.0043s/iter; left time: 15.0236s
	iters: 800, epoch: 5 | loss: 0.3339636
	speed: 0.0042s/iter; left time: 14.1654s
	iters: 900, epoch: 5 | loss: 0.4732812
	speed: 0.0042s/iter; left time: 13.8994s
	iters: 1000, epoch: 5 | loss: 0.1867588
	speed: 0.0042s/iter; left time: 13.4104s
Updating learning rate to 3.5472945275e-05
Epoch: 5 cost time: 4.47618556022644
Epoch: 5, Steps: 1045 | Train Loss: 0.3162588 Vali Loss: 0.2986667 Best vali loss: 0.2806375
	iters: 100, epoch: 6 | loss: 0.2760548
	speed: 0.0137s/iter; left time: 41.7243s
	iters: 200, epoch: 6 | loss: 0.3296704
	speed: 0.0041s/iter; left time: 11.9765s
	iters: 300, epoch: 6 | loss: 0.3597030
	speed: 0.0045s/iter; left time: 12.7495s
	iters: 400, epoch: 6 | loss: 0.3897403
	speed: 0.0044s/iter; left time: 12.1573s
	iters: 500, epoch: 6 | loss: 0.3429073
	speed: 0.0045s/iter; left time: 11.7699s
	iters: 600, epoch: 6 | loss: 0.1907745
	speed: 0.0044s/iter; left time: 11.2219s
	iters: 700, epoch: 6 | loss: 0.6348456
	speed: 0.0044s/iter; left time: 10.6760s
	iters: 800, epoch: 6 | loss: 0.5817782
	speed: 0.0044s/iter; left time: 10.2391s
	iters: 900, epoch: 6 | loss: 0.8792763
	speed: 0.0044s/iter; left time: 9.7387s
	iters: 1000, epoch: 6 | loss: 0.1937109
	speed: 0.0043s/iter; left time: 9.1776s
Updating learning rate to 1.77364726375e-05
Epoch: 6 cost time: 4.586210012435913
Epoch: 6, Steps: 1045 | Train Loss: 0.4178461 Vali Loss: 0.2983793 Best vali loss: 0.2806375
	iters: 100, epoch: 7 | loss: 0.1662712
	speed: 0.0133s/iter; left time: 26.4276s
	iters: 200, epoch: 7 | loss: 0.3077810
	speed: 0.0036s/iter; left time: 6.7427s
	iters: 300, epoch: 7 | loss: 0.2799728
	speed: 0.0029s/iter; left time: 5.1339s
	iters: 400, epoch: 7 | loss: 0.5566489
	speed: 0.0029s/iter; left time: 4.8196s
	iters: 500, epoch: 7 | loss: 0.3310746
	speed: 0.0035s/iter; left time: 5.5182s
	iters: 600, epoch: 7 | loss: 0.1336927
	speed: 0.0039s/iter; left time: 5.8108s
	iters: 700, epoch: 7 | loss: 0.7256415
	speed: 0.0038s/iter; left time: 5.2992s
	iters: 800, epoch: 7 | loss: 0.1869193
	speed: 0.0039s/iter; left time: 4.9760s
	iters: 900, epoch: 7 | loss: 0.5268049
	speed: 0.0040s/iter; left time: 4.7167s
	iters: 1000, epoch: 7 | loss: 0.1811215
	speed: 0.0038s/iter; left time: 4.1970s
Updating learning rate to 8.86823631875e-06
Epoch: 7 cost time: 3.799838066101074
Epoch: 7, Steps: 1045 | Train Loss: 0.3395928 Vali Loss: 0.2996133 Best vali loss: 0.2806375
	iters: 100, epoch: 8 | loss: 0.2011185
	speed: 0.0143s/iter; left time: 13.5665s
	iters: 200, epoch: 8 | loss: 0.1710007
	speed: 0.0038s/iter; left time: 3.2462s
	iters: 300, epoch: 8 | loss: 0.3582515
	speed: 0.0038s/iter; left time: 2.8641s
	iters: 400, epoch: 8 | loss: 0.1692507
	speed: 0.0038s/iter; left time: 2.4754s
	iters: 500, epoch: 8 | loss: 0.2740660
	speed: 0.0038s/iter; left time: 2.0810s
	iters: 600, epoch: 8 | loss: 0.3228884
	speed: 0.0038s/iter; left time: 1.7027s
	iters: 700, epoch: 8 | loss: 0.6781457
	speed: 0.0038s/iter; left time: 1.3099s
	iters: 800, epoch: 8 | loss: 0.9773649
	speed: 0.0038s/iter; left time: 0.9344s
	iters: 900, epoch: 8 | loss: 0.2809595
	speed: 0.0036s/iter; left time: 0.5293s
	iters: 1000, epoch: 8 | loss: 0.3616581
	speed: 0.0036s/iter; left time: 0.1678s
Updating learning rate to 4.434118159375e-06
Epoch: 8 cost time: 3.9851019382476807
Epoch: 8, Steps: 1045 | Train Loss: 0.3794704 Vali Loss: 0.3040974 Best vali loss: 0.2806375

best validation loss 0.2806375145125274

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.011915499154, 'e_layers': 4, 'learning_rate': 0.0022381340735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3217165
	speed: 0.0120s/iter; left time: 99.1109s
	iters: 200, epoch: 1 | loss: 0.7415507
	speed: 0.0066s/iter; left time: 54.0258s
	iters: 300, epoch: 1 | loss: 1.2744654
	speed: 0.0066s/iter; left time: 53.2518s
	iters: 400, epoch: 1 | loss: 0.4983855
	speed: 0.0065s/iter; left time: 51.4251s
	iters: 500, epoch: 1 | loss: 0.3516955
	speed: 0.0065s/iter; left time: 51.2614s
	iters: 600, epoch: 1 | loss: 0.2458416
	speed: 0.0066s/iter; left time: 50.8775s
	iters: 700, epoch: 1 | loss: 0.3529965
	speed: 0.0065s/iter; left time: 49.4646s
	iters: 800, epoch: 1 | loss: 0.3240359
	speed: 0.0065s/iter; left time: 49.4474s
	iters: 900, epoch: 1 | loss: 0.7582893
	speed: 0.0061s/iter; left time: 45.1799s
	iters: 1000, epoch: 1 | loss: 1.7243713
	speed: 0.0061s/iter; left time: 44.5841s
Updating learning rate to 0.002152950167511381
Validation loss decreased (inf --> 0.3218).  Saving model state dict ...
Epoch: 1 cost time: 7.010799407958984
Epoch: 1, Steps: 1045 | Train Loss: 0.6593348 Vali Loss: 0.3217661 Best vali loss: 0.3217661
	iters: 100, epoch: 2 | loss: 0.4242136
	speed: 0.0189s/iter; left time: 136.4309s
	iters: 200, epoch: 2 | loss: 0.4289894
	speed: 0.0064s/iter; left time: 45.6152s
	iters: 300, epoch: 2 | loss: 1.8832837
	speed: 0.0064s/iter; left time: 45.1569s
	iters: 400, epoch: 2 | loss: 0.4130951
	speed: 0.0066s/iter; left time: 45.7890s
	iters: 500, epoch: 2 | loss: 0.2310832
	speed: 0.0066s/iter; left time: 45.0065s
	iters: 600, epoch: 2 | loss: 0.2081400
	speed: 0.0066s/iter; left time: 44.2195s
	iters: 700, epoch: 2 | loss: 0.2943818
	speed: 0.0065s/iter; left time: 43.1429s
	iters: 800, epoch: 2 | loss: 0.8548322
	speed: 0.0063s/iter; left time: 41.3429s
	iters: 900, epoch: 2 | loss: 0.3770630
	speed: 0.0057s/iter; left time: 36.6485s
	iters: 1000, epoch: 2 | loss: 1.5927529
	speed: 0.0056s/iter; left time: 35.1480s
Updating learning rate to 0.0019103669270382603
Validation loss decreased (0.3218 --> 0.3211).  Saving model state dict ...
Epoch: 2 cost time: 6.551147699356079
Epoch: 2, Steps: 1045 | Train Loss: 0.6707835 Vali Loss: 0.3210853 Best vali loss: 0.3210853
	iters: 100, epoch: 3 | loss: 0.4701676
	speed: 0.0162s/iter; left time: 99.9563s
	iters: 200, epoch: 3 | loss: 0.3289078
	speed: 0.0069s/iter; left time: 41.6890s
	iters: 300, epoch: 3 | loss: 0.2763219
	speed: 0.0070s/iter; left time: 41.5744s
	iters: 400, epoch: 3 | loss: 0.4587496
	speed: 0.0066s/iter; left time: 38.7598s
	iters: 500, epoch: 3 | loss: 1.3913858
	speed: 0.0066s/iter; left time: 38.1060s
	iters: 600, epoch: 3 | loss: 0.1951020
	speed: 0.0059s/iter; left time: 33.2884s
	iters: 700, epoch: 3 | loss: 0.6027567
	speed: 0.0062s/iter; left time: 34.6392s
	iters: 800, epoch: 3 | loss: 0.4137101
	speed: 0.0066s/iter; left time: 36.3623s
	iters: 900, epoch: 3 | loss: 0.2378024
	speed: 0.0067s/iter; left time: 35.7277s
	iters: 1000, epoch: 3 | loss: 0.3695814
	speed: 0.0066s/iter; left time: 34.5908s
Updating learning rate to 0.00154731545142012
Validation loss decreased (0.3211 --> 0.3198).  Saving model state dict ...
Epoch: 3 cost time: 6.920003652572632
Epoch: 3, Steps: 1045 | Train Loss: 0.4744485 Vali Loss: 0.3197593 Best vali loss: 0.3197593

best validation loss 0.31975929332670555

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101561252832, 'e_layers': 1, 'learning_rate': 0.0020442502449, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5601811
	speed: 0.0088s/iter; left time: 72.7926s
	iters: 200, epoch: 1 | loss: 0.3477041
	speed: 0.0033s/iter; left time: 27.3053s
	iters: 300, epoch: 1 | loss: 0.3675546
	speed: 0.0033s/iter; left time: 26.6660s
	iters: 400, epoch: 1 | loss: 1.5560486
	speed: 0.0033s/iter; left time: 26.3262s
	iters: 500, epoch: 1 | loss: 1.6506413
	speed: 0.0034s/iter; left time: 27.0758s
	iters: 600, epoch: 1 | loss: 0.6372808
	speed: 0.0035s/iter; left time: 26.9204s
	iters: 700, epoch: 1 | loss: 0.5946506
	speed: 0.0035s/iter; left time: 26.4657s
	iters: 800, epoch: 1 | loss: 0.7568727
	speed: 0.0033s/iter; left time: 25.3240s
	iters: 900, epoch: 1 | loss: 0.2840815
	speed: 0.0029s/iter; left time: 21.6036s
	iters: 1000, epoch: 1 | loss: 0.3997140
	speed: 0.0023s/iter; left time: 17.2218s
Updating learning rate to 0.0019664456027471476
Validation loss decreased (inf --> 0.2925).  Saving model state dict ...
Epoch: 1 cost time: 3.6135056018829346
Epoch: 1, Steps: 1045 | Train Loss: 0.7154729 Vali Loss: 0.2925174 Best vali loss: 0.2925174
	iters: 100, epoch: 2 | loss: 0.5033786
	speed: 0.0090s/iter; left time: 64.8126s
	iters: 200, epoch: 2 | loss: 0.2223136
	speed: 0.0022s/iter; left time: 15.5845s
	iters: 300, epoch: 2 | loss: 0.2525935
	speed: 0.0028s/iter; left time: 19.4993s
	iters: 400, epoch: 2 | loss: 0.1557822
	speed: 0.0031s/iter; left time: 21.5474s
	iters: 500, epoch: 2 | loss: 1.3903030
	speed: 0.0031s/iter; left time: 21.2850s
	iters: 600, epoch: 2 | loss: 0.2519264
	speed: 0.0031s/iter; left time: 20.5860s
	iters: 700, epoch: 2 | loss: 0.1749225
	speed: 0.0031s/iter; left time: 20.5637s
	iters: 800, epoch: 2 | loss: 0.5384412
	speed: 0.0028s/iter; left time: 18.4214s
	iters: 900, epoch: 2 | loss: 0.3924205
	speed: 0.0023s/iter; left time: 14.4535s
	iters: 1000, epoch: 2 | loss: 0.5041322
	speed: 0.0032s/iter; left time: 20.2373s
Updating learning rate to 0.0017448767277555254
Validation loss decreased (0.2925 --> 0.2889).  Saving model state dict ...
Epoch: 2 cost time: 2.989694833755493
Epoch: 2, Steps: 1045 | Train Loss: 0.4386214 Vali Loss: 0.2888718 Best vali loss: 0.2888718
	iters: 100, epoch: 3 | loss: 2.0379579
	speed: 0.0120s/iter; left time: 74.3595s
	iters: 200, epoch: 3 | loss: 0.2210337
	speed: 0.0026s/iter; left time: 15.9950s
	iters: 300, epoch: 3 | loss: 1.3640296
	speed: 0.0029s/iter; left time: 17.5647s
	iters: 400, epoch: 3 | loss: 1.2979131
	speed: 0.0031s/iter; left time: 18.4392s
	iters: 500, epoch: 3 | loss: 0.6485587
	speed: 0.0032s/iter; left time: 18.6211s
	iters: 600, epoch: 3 | loss: 0.4130866
	speed: 0.0032s/iter; left time: 18.4296s
	iters: 700, epoch: 3 | loss: 0.6236526
	speed: 0.0032s/iter; left time: 17.6928s
	iters: 800, epoch: 3 | loss: 0.9057353
	speed: 0.0030s/iter; left time: 16.5095s
	iters: 900, epoch: 3 | loss: 0.3623668
	speed: 0.0022s/iter; left time: 11.6291s
	iters: 1000, epoch: 3 | loss: 0.3619219
	speed: 0.0023s/iter; left time: 12.0353s
Updating learning rate to 0.001413275472615754
Epoch: 3 cost time: 3.0400009155273438
Epoch: 3, Steps: 1045 | Train Loss: 0.8236256 Vali Loss: 0.2921985 Best vali loss: 0.2888718

best validation loss 0.2888717536491371

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.000987821602, 'e_layers': 4, 'learning_rate': 0.0009965286311, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3921784
	speed: 0.0116s/iter; left time: 23.2325s
	iters: 200, epoch: 1 | loss: 0.8246288
	speed: 0.0059s/iter; left time: 11.2503s
Updating learning rate to 0.0009586005184673902
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 1.8672332763671875
Epoch: 1, Steps: 262 | Train Loss: 0.6084036 Vali Loss: 0.2859330 Best vali loss: 0.2859330
	iters: 100, epoch: 2 | loss: 0.5746366
	speed: 0.0129s/iter; left time: 22.4252s
	iters: 200, epoch: 2 | loss: 0.5320338
	speed: 0.0060s/iter; left time: 9.8030s
Updating learning rate to 0.0008505903918986787
Validation loss decreased (0.2859 --> 0.2859).  Saving model state dict ...
Epoch: 2 cost time: 1.6154937744140625
Epoch: 2, Steps: 262 | Train Loss: 0.5533352 Vali Loss: 0.2858535 Best vali loss: 0.2858535
	iters: 100, epoch: 3 | loss: 0.8546583
	speed: 0.0128s/iter; left time: 18.8289s
	iters: 200, epoch: 3 | loss: 0.8974535
	speed: 0.0060s/iter; left time: 8.2525s
Updating learning rate to 0.0006889418140497162
Epoch: 3 cost time: 1.6109282970428467
Epoch: 3, Steps: 262 | Train Loss: 0.8760559 Vali Loss: 0.2872882 Best vali loss: 0.2858535

best validation loss 0.285853541564569

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.000987821602, 'e_layers': 4, 'learning_rate': 0.0009965286311, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3705614
	speed: 0.0121s/iter; left time: 14.6817s
	iters: 200, epoch: 4 | loss: 0.6881074
	speed: 0.0064s/iter; left time: 7.1502s
Updating learning rate to 0.00049826431555
Epoch: 4 cost time: 1.935331106185913
Epoch: 4, Steps: 262 | Train Loss: 0.5293344 Vali Loss: 0.2881095 Best vali loss: 0.2858535
	iters: 100, epoch: 5 | loss: 0.4430441
	speed: 0.0119s/iter; left time: 11.3119s
	iters: 200, epoch: 5 | loss: 0.4858233
	speed: 0.0052s/iter; left time: 4.4572s
Updating learning rate to 0.0003075868170502838
Epoch: 5 cost time: 1.411407470703125
Epoch: 5, Steps: 262 | Train Loss: 0.4644337 Vali Loss: 0.2908941 Best vali loss: 0.2858535
	iters: 100, epoch: 6 | loss: 0.7198982
	speed: 0.0122s/iter; left time: 8.4075s
	iters: 200, epoch: 6 | loss: 0.6714973
	speed: 0.0060s/iter; left time: 3.5095s
Updating learning rate to 0.0001459382392013213
Epoch: 6 cost time: 1.622530460357666
Epoch: 6, Steps: 262 | Train Loss: 0.6956978 Vali Loss: 0.2951330 Best vali loss: 0.2858535
	iters: 100, epoch: 7 | loss: 0.3739281
	speed: 0.0128s/iter; left time: 5.4309s
	iters: 200, epoch: 7 | loss: 0.3031924
	speed: 0.0060s/iter; left time: 1.9375s
Updating learning rate to 3.792811263260974e-05
Epoch: 7 cost time: 1.6278953552246094
Epoch: 7, Steps: 262 | Train Loss: 0.3385603 Vali Loss: 0.2981954 Best vali loss: 0.2858535
	iters: 100, epoch: 8 | loss: 0.2982303
	speed: 0.0128s/iter; left time: 2.0847s
	iters: 200, epoch: 8 | loss: 0.3760204
	speed: 0.0060s/iter; left time: 0.3790s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6210801601409912
Epoch: 8, Steps: 262 | Train Loss: 0.3371253 Vali Loss: 0.2970294 Best vali loss: 0.2858535

best validation loss 0.285853541564569

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0030625795344, 'e_layers': 3, 'learning_rate': 0.0002327366914, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6702008
	speed: 0.0109s/iter; left time: 21.7680s
	iters: 200, epoch: 1 | loss: 0.8067155
	speed: 0.0054s/iter; left time: 10.3374s
Updating learning rate to 0.0002238786785244278
Validation loss decreased (inf --> 0.2786).  Saving model state dict ...
Epoch: 1 cost time: 1.6981782913208008
Epoch: 1, Steps: 262 | Train Loss: 0.7384581 Vali Loss: 0.2785862 Best vali loss: 0.2785862
	iters: 100, epoch: 2 | loss: 0.3719130
	speed: 0.0119s/iter; left time: 20.6197s
	iters: 200, epoch: 2 | loss: 0.7023256
	speed: 0.0057s/iter; left time: 9.2906s
Updating learning rate to 0.00019865319205993043
Epoch: 2 cost time: 1.4918999671936035
Epoch: 2, Steps: 262 | Train Loss: 0.5371193 Vali Loss: 0.2799247 Best vali loss: 0.2785862
	iters: 100, epoch: 3 | loss: 0.3778305
	speed: 0.0113s/iter; left time: 16.6020s
	iters: 200, epoch: 3 | loss: 0.4763270
	speed: 0.0053s/iter; left time: 7.3441s
Updating learning rate to 0.00016090058365112334
Epoch: 3 cost time: 1.409029483795166
Epoch: 3, Steps: 262 | Train Loss: 0.4270788 Vali Loss: 0.2848798 Best vali loss: 0.2785862
	iters: 100, epoch: 4 | loss: 0.5245814
	speed: 0.0094s/iter; left time: 11.4222s
	iters: 200, epoch: 4 | loss: 0.2856373
	speed: 0.0052s/iter; left time: 5.7655s
Updating learning rate to 0.0001163683457
Epoch: 4 cost time: 1.3676223754882812
Epoch: 4, Steps: 262 | Train Loss: 0.4051093 Vali Loss: 0.2815446 Best vali loss: 0.2785862
	iters: 100, epoch: 5 | loss: 0.5969625
	speed: 0.0142s/iter; left time: 13.4291s
	iters: 200, epoch: 5 | loss: 0.5431998
	speed: 0.0067s/iter; left time: 5.7216s
Updating learning rate to 7.183610774887667e-05
Epoch: 5 cost time: 1.73622727394104
Epoch: 5, Steps: 262 | Train Loss: 0.5700811 Vali Loss: 0.2985285 Best vali loss: 0.2785862
	iters: 100, epoch: 6 | loss: 0.3371740
	speed: 0.0137s/iter; left time: 9.4372s
	iters: 200, epoch: 6 | loss: 0.6588520
	speed: 0.0068s/iter; left time: 3.9852s
Updating learning rate to 3.408349934006959e-05
Epoch: 6 cost time: 1.7400026321411133
Epoch: 6, Steps: 262 | Train Loss: 0.4980130 Vali Loss: 0.2939912 Best vali loss: 0.2785862
	iters: 100, epoch: 7 | loss: 0.3356979
	speed: 0.0141s/iter; left time: 5.9750s
	iters: 200, epoch: 7 | loss: 0.3946274
	speed: 0.0062s/iter; left time: 2.0148s
Updating learning rate to 8.858012875572196e-06
Epoch: 7 cost time: 1.7490978240966797
Epoch: 7, Steps: 262 | Train Loss: 0.3651627 Vali Loss: 0.2886876 Best vali loss: 0.2785862
	iters: 100, epoch: 8 | loss: 0.4045530
	speed: 0.0143s/iter; left time: 2.3324s
	iters: 200, epoch: 8 | loss: 0.4557208
	speed: 0.0063s/iter; left time: 0.3991s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7547776699066162
Epoch: 8, Steps: 262 | Train Loss: 0.4301369 Vali Loss: 0.2891619 Best vali loss: 0.2785862

best validation loss 0.278586249317809

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0099506207971, 'e_layers': 4, 'learning_rate': 0.0041237779005, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5893879
	speed: 0.0117s/iter; left time: 11.1006s
Updating learning rate to 0.0041237779005
Validation loss decreased (inf --> 0.3293).  Saving model state dict ...
Epoch: 1 cost time: 1.1477537155151367
Epoch: 1, Steps: 131 | Train Loss: 0.5893879 Vali Loss: 0.3292586 Best vali loss: 0.3292586
	iters: 100, epoch: 2 | loss: 0.8145667
	speed: 0.0129s/iter; left time: 10.5430s
Updating learning rate to 0.00206188895025
Validation loss decreased (0.3293 --> 0.3249).  Saving model state dict ...
Epoch: 2 cost time: 1.0217323303222656
Epoch: 2, Steps: 131 | Train Loss: 0.8145667 Vali Loss: 0.3249124 Best vali loss: 0.3249124
	iters: 100, epoch: 3 | loss: 0.7073274
	speed: 0.0132s/iter; left time: 9.0550s
Updating learning rate to 0.001030944475125
Validation loss decreased (0.3249 --> 0.3241).  Saving model state dict ...
Epoch: 3 cost time: 1.0527372360229492
Epoch: 3, Steps: 131 | Train Loss: 0.7073274 Vali Loss: 0.3240554 Best vali loss: 0.3240554
	iters: 100, epoch: 4 | loss: 0.5617255
	speed: 0.0114s/iter; left time: 6.3262s
Updating learning rate to 0.0005154722375625
Validation loss decreased (0.3241 --> 0.3223).  Saving model state dict ...
Epoch: 4 cost time: 0.8446073532104492
Epoch: 4, Steps: 131 | Train Loss: 0.5617255 Vali Loss: 0.3223386 Best vali loss: 0.3223386
	iters: 100, epoch: 5 | loss: 0.5106622
	speed: 0.0116s/iter; left time: 4.9509s
Updating learning rate to 0.00025773611878125
Validation loss decreased (0.3223 --> 0.3222).  Saving model state dict ...
Epoch: 5 cost time: 1.0810511112213135
Epoch: 5, Steps: 131 | Train Loss: 0.5106622 Vali Loss: 0.3222117 Best vali loss: 0.3222117
	iters: 100, epoch: 6 | loss: 0.7243729
	speed: 0.0129s/iter; left time: 3.7931s
Updating learning rate to 0.000128868059390625
Validation loss decreased (0.3222 --> 0.3220).  Saving model state dict ...
Epoch: 6 cost time: 1.0286059379577637
Epoch: 6, Steps: 131 | Train Loss: 0.7243729 Vali Loss: 0.3220124 Best vali loss: 0.3220124
	iters: 100, epoch: 7 | loss: 0.6080684
	speed: 0.0097s/iter; left time: 1.5815s
Updating learning rate to 6.44340296953125e-05
Epoch: 7 cost time: 0.8224973678588867
Epoch: 7, Steps: 131 | Train Loss: 0.6080684 Vali Loss: 0.3222877 Best vali loss: 0.3220124
	iters: 100, epoch: 8 | loss: 0.5654618
	speed: 0.0121s/iter; left time: 0.3868s
Updating learning rate to 3.221701484765625e-05
Epoch: 8 cost time: 1.0121734142303467
Epoch: 8, Steps: 131 | Train Loss: 0.5654618 Vali Loss: 0.3222396 Best vali loss: 0.3220124

best validation loss 0.3220123918848261

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0033532746374, 'e_layers': 3, 'learning_rate': 0.0001820777857, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6051667
	speed: 0.0118s/iter; left time: 11.1644s
Updating learning rate to 0.0001820777857
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 1.1227543354034424
Epoch: 1, Steps: 131 | Train Loss: 0.6051667 Vali Loss: 0.2834296 Best vali loss: 0.2834296
	iters: 100, epoch: 2 | loss: 0.4926140
	speed: 0.0120s/iter; left time: 9.8344s
Updating learning rate to 9.103889285e-05
Validation loss decreased (0.2834 --> 0.2818).  Saving model state dict ...
Epoch: 2 cost time: 0.9766390323638916
Epoch: 2, Steps: 131 | Train Loss: 0.4926140 Vali Loss: 0.2818336 Best vali loss: 0.2818336
	iters: 100, epoch: 3 | loss: 0.5234734
	speed: 0.0123s/iter; left time: 8.4569s
Updating learning rate to 4.5519446425e-05
Epoch: 3 cost time: 0.9931631088256836
Epoch: 3, Steps: 131 | Train Loss: 0.5234734 Vali Loss: 0.2839127 Best vali loss: 0.2818336

best validation loss 0.28183361392519474

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038698826022, 'e_layers': 4, 'learning_rate': 0.0004004528328, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004004528328
Validation loss decreased (inf --> 0.2799).  Saving model state dict ...
Epoch: 1 cost time: 0.9364809989929199
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2798813 Best vali loss: 0.2798813
Updating learning rate to 0.0002002264164
Epoch: 2 cost time: 0.5925397872924805
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2818299 Best vali loss: 0.2798813
Updating learning rate to 0.0001001132082
Epoch: 3 cost time: 0.4139406681060791
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2814253 Best vali loss: 0.2798813

best validation loss 0.27988129756117275

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004191723262, 'e_layers': 3, 'learning_rate': 0.0043478566088, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0043478566088
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 0.7704167366027832
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2868655 Best vali loss: 0.2868655
Updating learning rate to 0.0021739283044
Epoch: 2 cost time: 0.5383007526397705
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2951149 Best vali loss: 0.2868655
Updating learning rate to 0.0010869641522
Epoch: 3 cost time: 0.5538535118103027
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2931231 Best vali loss: 0.2868655

best validation loss 0.2868654887531716

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038698826022, 'e_layers': 4, 'learning_rate': 0.0004004528328, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.00566041e-05
Epoch: 4 cost time: 0.7107107639312744
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2804787 Best vali loss: 0.2798813
Updating learning rate to 2.502830205e-05
Epoch: 5 cost time: 0.4230790138244629
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2827419 Best vali loss: 0.2798813
Updating learning rate to 1.2514151025e-05
Epoch: 6 cost time: 0.6051468849182129
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2812016 Best vali loss: 0.2798813
Updating learning rate to 6.2570755125e-06
Epoch: 7 cost time: 0.5740358829498291
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2815841 Best vali loss: 0.2798813
Updating learning rate to 3.12853775625e-06
Epoch: 8 cost time: 0.5966629981994629
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2815538 Best vali loss: 0.2798813

best validation loss 0.27988129756117275

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 1, 'learning_rate': 6.59648622e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.345422412575373e-05
Validation loss decreased (inf --> 0.3471).  Saving model state dict ...
Epoch: 1 cost time: 0.6743278503417969
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3471172 Best vali loss: 0.3471172
Updating learning rate to 5.630453179082808e-05
Validation loss decreased (0.3471 --> 0.3325).  Saving model state dict ...
Epoch: 2 cost time: 0.3043701648712158
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3324780 Best vali loss: 0.3324780
Updating learning rate to 4.5604261041093085e-05
Validation loss decreased (0.3325 --> 0.3224).  Saving model state dict ...
Epoch: 3 cost time: 0.2673783302307129
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3224113 Best vali loss: 0.3224113
Updating learning rate to 3.29824311e-05
Validation loss decreased (0.3224 --> 0.3158).  Saving model state dict ...
Epoch: 4 cost time: 0.27562546730041504
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3158471 Best vali loss: 0.3158471
Updating learning rate to 2.0360601158906917e-05
Validation loss decreased (0.3158 --> 0.3118).  Saving model state dict ...
Epoch: 5 cost time: 0.3011655807495117
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3118375 Best vali loss: 0.3118375
Updating learning rate to 9.660330409171922e-06
Validation loss decreased (0.3118 --> 0.3096).  Saving model state dict ...
Epoch: 6 cost time: 0.30100011825561523
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3095534 Best vali loss: 0.3095534
Updating learning rate to 2.5106380742462752e-06
Validation loss decreased (0.3096 --> 0.3085).  Saving model state dict ...
Epoch: 7 cost time: 0.5542895793914795
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3085365 Best vali loss: 0.3085365
Updating learning rate to 0.0
Validation loss decreased (0.3085 --> 0.3083).  Saving model state dict ...
Epoch: 8 cost time: 0.5323994159698486
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3082777 Best vali loss: 0.3082777

best validation loss 0.30827774713144906

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0021078822862, 'e_layers': 1, 'learning_rate': 0.0019637021813, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019637021813
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 0.520289421081543
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2843185 Best vali loss: 0.2843185
Updating learning rate to 0.00098185109065
Validation loss decreased (0.2843 --> 0.2817).  Saving model state dict ...
Epoch: 2 cost time: 0.2728111743927002
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2817168 Best vali loss: 0.2817168
Updating learning rate to 0.000490925545325
Epoch: 3 cost time: 0.2854325771331787
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2829947 Best vali loss: 0.2817168
Updating learning rate to 0.0002454627726625
Epoch: 4 cost time: 0.28018689155578613
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2830992 Best vali loss: 0.2817168
Updating learning rate to 0.00012273138633125
Epoch: 5 cost time: 0.29605603218078613
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2826452 Best vali loss: 0.2817168
Updating learning rate to 6.1365693165625e-05
Epoch: 6 cost time: 0.2789433002471924
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2834160 Best vali loss: 0.2817168
Updating learning rate to 3.06828465828125e-05
Epoch: 7 cost time: 0.2929844856262207
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2831472 Best vali loss: 0.2817168
Updating learning rate to 1.534142329140625e-05
Epoch: 8 cost time: 0.2885112762451172
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2833509 Best vali loss: 0.2817168

best validation loss 0.28171675045191463

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0070498653705, 'e_layers': 4, 'learning_rate': 6.58625109e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.58625109e-05
Validation loss decreased (inf --> 0.2900).  Saving model state dict ...
Epoch: 1 cost time: 0.8576321601867676
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2899594 Best vali loss: 0.2899594
Updating learning rate to 3.293125545e-05
Validation loss decreased (0.2900 --> 0.2815).  Saving model state dict ...
Epoch: 2 cost time: 0.5726602077484131
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2814660 Best vali loss: 0.2814660
Updating learning rate to 1.6465627725e-05
Validation loss decreased (0.2815 --> 0.2796).  Saving model state dict ...
Epoch: 3 cost time: 0.6095840930938721
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2796166 Best vali loss: 0.2796166

best validation loss 0.27961655432692956

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5457089
	speed: 0.0112s/iter; left time: 45.7828s
	iters: 200, epoch: 1 | loss: 0.3453482
	speed: 0.0056s/iter; left time: 22.2576s
	iters: 300, epoch: 1 | loss: 0.7708580
	speed: 0.0052s/iter; left time: 20.2772s
	iters: 400, epoch: 1 | loss: 0.8175723
	speed: 0.0044s/iter; left time: 16.8331s
	iters: 500, epoch: 1 | loss: 0.5403184
	speed: 0.0042s/iter; left time: 15.3316s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.2847).  Saving model state dict ...
Epoch: 1 cost time: 2.8927040100097656
Epoch: 1, Steps: 523 | Train Loss: 0.6039612 Vali Loss: 0.2847145 Best vali loss: 0.2847145
	iters: 100, epoch: 2 | loss: 0.3050781
	speed: 0.0110s/iter; left time: 39.1503s
	iters: 200, epoch: 2 | loss: 0.6690531
	speed: 0.0052s/iter; left time: 17.9984s
	iters: 300, epoch: 2 | loss: 0.3442354
	speed: 0.0043s/iter; left time: 14.3862s
	iters: 400, epoch: 2 | loss: 0.3855413
	speed: 0.0038s/iter; left time: 12.5418s
	iters: 500, epoch: 2 | loss: 0.2462930
	speed: 0.0048s/iter; left time: 15.0820s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 2.506938934326172
Epoch: 2, Steps: 523 | Train Loss: 0.3900402 Vali Loss: 0.2869451 Best vali loss: 0.2847145
	iters: 100, epoch: 3 | loss: 0.4185456
	speed: 0.0120s/iter; left time: 36.5266s
	iters: 200, epoch: 3 | loss: 0.8505863
	speed: 0.0052s/iter; left time: 15.2655s
	iters: 300, epoch: 3 | loss: 0.5458928
	speed: 0.0053s/iter; left time: 15.1228s
	iters: 400, epoch: 3 | loss: 0.2873568
	speed: 0.0045s/iter; left time: 12.2845s
	iters: 500, epoch: 3 | loss: 0.4632634
	speed: 0.0039s/iter; left time: 10.2567s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 2.5710809230804443
Epoch: 3, Steps: 523 | Train Loss: 0.5131290 Vali Loss: 0.2923983 Best vali loss: 0.2847145

best validation loss 0.28471446454569327

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 0.6515076160430908
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2842064 Best vali loss: 0.2842064
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.2842 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 0.49463915824890137
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2834276 Best vali loss: 0.2834276
Updating learning rate to 0.0002042442000052176
Validation loss decreased (0.2834 --> 0.2791).  Saving model state dict ...
Epoch: 3 cost time: 0.4052927494049072
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2791499 Best vali loss: 0.2791499

best validation loss 0.27914991083199225

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001477158077
Epoch: 4 cost time: 0.6831998825073242
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2821145 Best vali loss: 0.2791499
Updating learning rate to 9.118741539478246e-05
Epoch: 5 cost time: 0.4448549747467041
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2827496 Best vali loss: 0.2791499
Updating learning rate to 4.326495838688198e-05
Epoch: 6 cost time: 0.43390941619873047
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2808908 Best vali loss: 0.2791499
Updating learning rate to 1.124419633759687e-05
Epoch: 7 cost time: 0.42263126373291016
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2808701 Best vali loss: 0.2791499
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43282532691955566
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2816640 Best vali loss: 0.2791499

best validation loss 0.27914991083199225

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012126761903, 'e_layers': 1, 'learning_rate': 0.0006771784349, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3242376
	speed: 0.0083s/iter; left time: 16.5561s
	iters: 200, epoch: 1 | loss: 0.4300282
	speed: 0.0025s/iter; left time: 4.8177s
Updating learning rate to 0.0006514048653810684
Validation loss decreased (inf --> 0.2827).  Saving model state dict ...
Epoch: 1 cost time: 0.9822139739990234
Epoch: 1, Steps: 262 | Train Loss: 0.3771329 Vali Loss: 0.2826773 Best vali loss: 0.2826773
	iters: 100, epoch: 2 | loss: 0.5435954
	speed: 0.0064s/iter; left time: 11.1352s
	iters: 200, epoch: 2 | loss: 0.4561375
	speed: 0.0029s/iter; left time: 4.6600s
Updating learning rate to 0.0005780079491455414
Epoch: 2 cost time: 0.7694106101989746
Epoch: 2, Steps: 262 | Train Loss: 0.4998665 Vali Loss: 0.2904283 Best vali loss: 0.2826773
	iters: 100, epoch: 3 | loss: 0.4057377
	speed: 0.0071s/iter; left time: 10.4964s
	iters: 200, epoch: 3 | loss: 0.5468358
	speed: 0.0028s/iter; left time: 3.7987s
Updating learning rate to 0.0004681617013455758
Epoch: 3 cost time: 0.782747745513916
Epoch: 3, Steps: 262 | Train Loss: 0.4762868 Vali Loss: 0.2896759 Best vali loss: 0.2826773
	iters: 100, epoch: 4 | loss: 0.2304294
	speed: 0.0068s/iter; left time: 8.2800s
	iters: 200, epoch: 4 | loss: 0.4587136
	speed: 0.0027s/iter; left time: 3.0293s
Updating learning rate to 0.00033858921745
Epoch: 4 cost time: 0.7493104934692383
Epoch: 4, Steps: 262 | Train Loss: 0.3445715 Vali Loss: 0.2922879 Best vali loss: 0.2826773
	iters: 100, epoch: 5 | loss: 0.4491403
	speed: 0.0071s/iter; left time: 6.7291s
	iters: 200, epoch: 5 | loss: 0.5133044
	speed: 0.0028s/iter; left time: 2.3492s
Updating learning rate to 0.00020901673355442425
Epoch: 5 cost time: 0.8054001331329346
Epoch: 5, Steps: 262 | Train Loss: 0.4812224 Vali Loss: 0.2937227 Best vali loss: 0.2826773
	iters: 100, epoch: 6 | loss: 0.4135711
	speed: 0.0073s/iter; left time: 5.0119s
	iters: 200, epoch: 6 | loss: 0.4658644
	speed: 0.0030s/iter; left time: 1.7691s
Updating learning rate to 9.917048575445851e-05
Epoch: 6 cost time: 0.8328206539154053
Epoch: 6, Steps: 262 | Train Loss: 0.4397178 Vali Loss: 0.2979915 Best vali loss: 0.2826773
	iters: 100, epoch: 7 | loss: 0.4566557
	speed: 0.0073s/iter; left time: 3.0956s
	iters: 200, epoch: 7 | loss: 0.3629019
	speed: 0.0029s/iter; left time: 0.9439s
Updating learning rate to 2.577356951893159e-05
Epoch: 7 cost time: 0.8088128566741943
Epoch: 7, Steps: 262 | Train Loss: 0.4097788 Vali Loss: 0.3038507 Best vali loss: 0.2826773
	iters: 100, epoch: 8 | loss: 0.2180932
	speed: 0.0071s/iter; left time: 1.1521s
	iters: 200, epoch: 8 | loss: 0.3576305
	speed: 0.0029s/iter; left time: 0.1811s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7942874431610107
Epoch: 8, Steps: 262 | Train Loss: 0.2878618 Vali Loss: 0.3013117 Best vali loss: 0.2826773

best validation loss 0.2826772810037183

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066567632481, 'e_layers': 3, 'learning_rate': 0.002104042691, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3413529
	speed: 0.0103s/iter; left time: 20.5667s
	iters: 200, epoch: 1 | loss: 0.4368739
	speed: 0.0050s/iter; left time: 9.4278s
Updating learning rate to 0.0020239623343724345
Validation loss decreased (inf --> 0.2895).  Saving model state dict ...
Epoch: 1 cost time: 1.5566127300262451
Epoch: 1, Steps: 262 | Train Loss: 0.3891134 Vali Loss: 0.2894573 Best vali loss: 0.2894573
	iters: 100, epoch: 2 | loss: 0.2887424
	speed: 0.0109s/iter; left time: 18.9480s
	iters: 200, epoch: 2 | loss: 0.3136975
	speed: 0.0050s/iter; left time: 8.2445s
Updating learning rate to 0.0017959127728560456
Validation loss decreased (0.2895 --> 0.2875).  Saving model state dict ...
Epoch: 2 cost time: 1.368027925491333
Epoch: 2, Steps: 262 | Train Loss: 0.3012199 Vali Loss: 0.2874712 Best vali loss: 0.2874712
	iters: 100, epoch: 3 | loss: 0.6770529
	speed: 0.0106s/iter; left time: 15.6165s
	iters: 200, epoch: 3 | loss: 0.2810411
	speed: 0.0051s/iter; left time: 6.9677s
Updating learning rate to 0.00145461248491728
Epoch: 3 cost time: 1.3325519561767578
Epoch: 3, Steps: 262 | Train Loss: 0.4790470 Vali Loss: 0.2923779 Best vali loss: 0.2874712
	iters: 100, epoch: 4 | loss: 0.3486361
	speed: 0.0105s/iter; left time: 12.6795s
	iters: 200, epoch: 4 | loss: 0.3644487
	speed: 0.0044s/iter; left time: 4.8389s
Updating learning rate to 0.0010520213455
Epoch: 4 cost time: 1.2194290161132812
Epoch: 4, Steps: 262 | Train Loss: 0.3565424 Vali Loss: 0.2992493 Best vali loss: 0.2874712
	iters: 100, epoch: 5 | loss: 0.4016489
	speed: 0.0120s/iter; left time: 11.4112s
	iters: 200, epoch: 5 | loss: 0.3395855
	speed: 0.0057s/iter; left time: 4.8488s
Updating learning rate to 0.00064943020608272
Epoch: 5 cost time: 1.5015463829040527
Epoch: 5, Steps: 262 | Train Loss: 0.3706172 Vali Loss: 0.2974020 Best vali loss: 0.2874712
	iters: 100, epoch: 6 | loss: 0.2238468
	speed: 0.0126s/iter; left time: 8.6702s
	iters: 200, epoch: 6 | loss: 0.5198579
	speed: 0.0047s/iter; left time: 2.7440s
Updating learning rate to 0.00030812991814395423
Epoch: 6 cost time: 1.35166335105896
Epoch: 6, Steps: 262 | Train Loss: 0.3718524 Vali Loss: 0.2964156 Best vali loss: 0.2874712
	iters: 100, epoch: 7 | loss: 0.4222836
	speed: 0.0121s/iter; left time: 5.1544s
	iters: 200, epoch: 7 | loss: 0.2198834
	speed: 0.0063s/iter; left time: 2.0346s
Updating learning rate to 8.008035662756513e-05
Epoch: 7 cost time: 1.6779778003692627
Epoch: 7, Steps: 262 | Train Loss: 0.3210835 Vali Loss: 0.3034265 Best vali loss: 0.2874712
	iters: 100, epoch: 8 | loss: 0.3302688
	speed: 0.0115s/iter; left time: 1.8722s
	iters: 200, epoch: 8 | loss: 0.5984396
	speed: 0.0054s/iter; left time: 0.3389s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3984522819519043
Epoch: 8, Steps: 262 | Train Loss: 0.4643542 Vali Loss: 0.3023360 Best vali loss: 0.2874712

best validation loss 0.28747122436651024

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0034282770657, 'e_layers': 2, 'learning_rate': 0.0002535480338, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6140903
	speed: 0.0105s/iter; left time: 9.9466s
Updating learning rate to 0.00024389793636814995
Validation loss decreased (inf --> 0.3096).  Saving model state dict ...
Epoch: 1 cost time: 0.9252161979675293
Epoch: 1, Steps: 131 | Train Loss: 0.6140903 Vali Loss: 0.3096392 Best vali loss: 0.3096392
	iters: 100, epoch: 2 | loss: 0.6477506
	speed: 0.0079s/iter; left time: 6.4343s
Updating learning rate to 0.00021641678392824796
Validation loss decreased (0.3096 --> 0.2942).  Saving model state dict ...
Epoch: 2 cost time: 0.6201984882354736
Epoch: 2, Steps: 131 | Train Loss: 0.6477506 Vali Loss: 0.2942318 Best vali loss: 0.2942318
	iters: 100, epoch: 3 | loss: 0.3005054
	speed: 0.0075s/iter; left time: 5.1754s
Updating learning rate to 0.0001752883328220019
Validation loss decreased (0.2942 --> 0.2875).  Saving model state dict ...
Epoch: 3 cost time: 0.6015889644622803
Epoch: 3, Steps: 131 | Train Loss: 0.3005054 Vali Loss: 0.2874777 Best vali loss: 0.2874777

best validation loss 0.2874776718119078

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0046642077899, 'e_layers': 3, 'learning_rate': 0.0046118283421, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0046118283421
Validation loss decreased (inf --> 0.3011).  Saving model state dict ...
Epoch: 1 cost time: 0.6524150371551514
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3010864 Best vali loss: 0.3010864
Updating learning rate to 0.00230591417105
Epoch: 2 cost time: 0.3871595859527588
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3178665 Best vali loss: 0.3010864
Updating learning rate to 0.001152957085525
Validation loss decreased (0.3011 --> 0.2971).  Saving model state dict ...
Epoch: 3 cost time: 0.4674820899963379
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2971273 Best vali loss: 0.2971273

best validation loss 0.29712734135077673

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001706392447, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4763262
	speed: 0.0115s/iter; left time: 23.0044s
	iters: 200, epoch: 1 | loss: 0.4471913
	speed: 0.0061s/iter; left time: 11.6365s
Updating learning rate to 0.00016414467516075753
Validation loss decreased (inf --> 0.2899).  Saving model state dict ...
Epoch: 1 cost time: 1.8729829788208008
Epoch: 1, Steps: 262 | Train Loss: 0.4617588 Vali Loss: 0.2899445 Best vali loss: 0.2899445
	iters: 100, epoch: 2 | loss: 0.6501792
	speed: 0.0129s/iter; left time: 22.3031s
	iters: 200, epoch: 2 | loss: 0.4172344
	speed: 0.0060s/iter; left time: 9.8036s
Updating learning rate to 0.0001456497058819603
Validation loss decreased (0.2899 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 1.622230052947998
Epoch: 2, Steps: 262 | Train Loss: 0.5337068 Vali Loss: 0.2837699 Best vali loss: 0.2837699
	iters: 100, epoch: 3 | loss: 0.7134644
	speed: 0.0128s/iter; left time: 18.9257s
	iters: 200, epoch: 3 | loss: 0.5383838
	speed: 0.0061s/iter; left time: 8.3772s
Updating learning rate to 0.00011797002827899123
Validation loss decreased (0.2838 --> 0.2833).  Saving model state dict ...
Epoch: 3 cost time: 1.6352043151855469
Epoch: 3, Steps: 262 | Train Loss: 0.6259241 Vali Loss: 0.2832625 Best vali loss: 0.2832625

best validation loss 0.2832624824595035

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001706392447, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4165633
	speed: 0.0123s/iter; left time: 14.9330s
	iters: 200, epoch: 4 | loss: 0.4080075
	speed: 0.0059s/iter; left time: 6.5392s
Updating learning rate to 8.531962235e-05
Validation loss decreased (0.2833 --> 0.2824).  Saving model state dict ...
Epoch: 4 cost time: 1.8067688941955566
Epoch: 4, Steps: 262 | Train Loss: 0.4122854 Vali Loss: 0.2824486 Best vali loss: 0.2824486
	iters: 100, epoch: 5 | loss: 0.6149371
	speed: 0.0135s/iter; left time: 12.7922s
	iters: 200, epoch: 5 | loss: 0.3882121
	speed: 0.0082s/iter; left time: 6.9800s
Updating learning rate to 5.266921642100878e-05
Epoch: 5 cost time: 2.168095350265503
Epoch: 5, Steps: 262 | Train Loss: 0.5015746 Vali Loss: 0.2830304 Best vali loss: 0.2824486
	iters: 100, epoch: 6 | loss: 0.6909821
	speed: 0.0172s/iter; left time: 11.8124s
	iters: 200, epoch: 6 | loss: 0.5337504
	speed: 0.0080s/iter; left time: 4.6782s
Updating learning rate to 2.4989538818039686e-05
Epoch: 6 cost time: 2.0362534523010254
Epoch: 6, Steps: 262 | Train Loss: 0.6123662 Vali Loss: 0.2833747 Best vali loss: 0.2824486
	iters: 100, epoch: 7 | loss: 0.9613293
	speed: 0.0167s/iter; left time: 7.1071s
	iters: 200, epoch: 7 | loss: 0.6258038
	speed: 0.0083s/iter; left time: 2.7023s
Updating learning rate to 6.4945695392424685e-06
Epoch: 7 cost time: 2.12216854095459
Epoch: 7, Steps: 262 | Train Loss: 0.7935666 Vali Loss: 0.2826998 Best vali loss: 0.2824486
	iters: 100, epoch: 8 | loss: 0.4152569
	speed: 0.0169s/iter; left time: 2.7608s
	iters: 200, epoch: 8 | loss: 0.4077877
	speed: 0.0086s/iter; left time: 0.5401s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1600747108459473
Epoch: 8, Steps: 262 | Train Loss: 0.4115223 Vali Loss: 0.2829996 Best vali loss: 0.2824486

best validation loss 0.2824486033563589

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0026209986474, 'e_layers': 4, 'learning_rate': 8.46744742e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3545882
	speed: 0.0119s/iter; left time: 11.2662s
Updating learning rate to 8.46744742e-05
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 1.1576097011566162
Epoch: 1, Steps: 131 | Train Loss: 0.3545882 Vali Loss: 0.2822536 Best vali loss: 0.2822536
	iters: 100, epoch: 2 | loss: 0.4317451
	speed: 0.0129s/iter; left time: 10.5653s
Updating learning rate to 4.23372371e-05
Validation loss decreased (0.2823 --> 0.2773).  Saving model state dict ...
Epoch: 2 cost time: 1.057070016860962
Epoch: 2, Steps: 131 | Train Loss: 0.4317451 Vali Loss: 0.2773062 Best vali loss: 0.2773062
	iters: 100, epoch: 3 | loss: 0.4508396
	speed: 0.0136s/iter; left time: 9.3493s
Updating learning rate to 2.116861855e-05
Epoch: 3 cost time: 1.09859037399292
Epoch: 3, Steps: 131 | Train Loss: 0.4508396 Vali Loss: 0.2781429 Best vali loss: 0.2773062
	iters: 100, epoch: 4 | loss: 0.4529350
	speed: 0.0133s/iter; left time: 7.3887s
Updating learning rate to 1.0584309275e-05
Epoch: 4 cost time: 1.089879035949707
Epoch: 4, Steps: 131 | Train Loss: 0.4529350 Vali Loss: 0.2782758 Best vali loss: 0.2773062
	iters: 100, epoch: 5 | loss: 0.4876789
	speed: 0.0130s/iter; left time: 5.5316s
Updating learning rate to 5.2921546375e-06
Epoch: 5 cost time: 1.0775063037872314
Epoch: 5, Steps: 131 | Train Loss: 0.4876789 Vali Loss: 0.2774763 Best vali loss: 0.2773062
	iters: 100, epoch: 6 | loss: 0.6376399
	speed: 0.0135s/iter; left time: 3.9569s
Updating learning rate to 2.64607731875e-06
Epoch: 6 cost time: 1.117279291152954
Epoch: 6, Steps: 131 | Train Loss: 0.6376399 Vali Loss: 0.2778471 Best vali loss: 0.2773062
	iters: 100, epoch: 7 | loss: 0.4323569
	speed: 0.0131s/iter; left time: 2.1430s
Updating learning rate to 1.323038659375e-06
Epoch: 7 cost time: 1.0803883075714111
Epoch: 7, Steps: 131 | Train Loss: 0.4323569 Vali Loss: 0.2780316 Best vali loss: 0.2773062
	iters: 100, epoch: 8 | loss: 0.4732930
	speed: 0.0131s/iter; left time: 0.4199s
Updating learning rate to 6.615193296875e-07
Epoch: 8 cost time: 1.1010966300964355
Epoch: 8, Steps: 131 | Train Loss: 0.4732930 Vali Loss: 0.2780240 Best vali loss: 0.2773062

best validation loss 0.27730618083109065

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0083025866439, 'e_layers': 3, 'learning_rate': 0.0007704396347, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4325820
	speed: 0.0102s/iter; left time: 9.6786s
Updating learning rate to 0.0007704396347
Validation loss decreased (inf --> 0.2879).  Saving model state dict ...
Epoch: 1 cost time: 0.8875222206115723
Epoch: 1, Steps: 131 | Train Loss: 0.4325820 Vali Loss: 0.2879485 Best vali loss: 0.2879485
	iters: 100, epoch: 2 | loss: 0.6912236
	speed: 0.0084s/iter; left time: 6.8429s
Updating learning rate to 0.00038521981735
Validation loss decreased (0.2879 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 0.7029430866241455
Epoch: 2, Steps: 131 | Train Loss: 0.6912236 Vali Loss: 0.2809652 Best vali loss: 0.2809652
	iters: 100, epoch: 3 | loss: 0.4143358
	speed: 0.0096s/iter; left time: 6.6115s
Updating learning rate to 0.000192609908675
Epoch: 3 cost time: 0.7992444038391113
Epoch: 3, Steps: 131 | Train Loss: 0.4143358 Vali Loss: 0.2837696 Best vali loss: 0.2809652
	iters: 100, epoch: 4 | loss: 0.3706073
	speed: 0.0095s/iter; left time: 5.2588s
Updating learning rate to 9.63049543375e-05
Epoch: 4 cost time: 0.7680566310882568
Epoch: 4, Steps: 131 | Train Loss: 0.3706073 Vali Loss: 0.2831656 Best vali loss: 0.2809652
	iters: 100, epoch: 5 | loss: 0.5581821
	speed: 0.0094s/iter; left time: 3.9742s
Updating learning rate to 4.815247716875e-05
Epoch: 5 cost time: 0.785057544708252
Epoch: 5, Steps: 131 | Train Loss: 0.5581821 Vali Loss: 0.2831346 Best vali loss: 0.2809652
	iters: 100, epoch: 6 | loss: 0.4582743
	speed: 0.0093s/iter; left time: 2.7254s
Updating learning rate to 2.4076238584375e-05
Epoch: 6 cost time: 0.770289421081543
Epoch: 6, Steps: 131 | Train Loss: 0.4582743 Vali Loss: 0.2835484 Best vali loss: 0.2809652
	iters: 100, epoch: 7 | loss: 0.7382815
	speed: 0.0094s/iter; left time: 1.5242s
Updating learning rate to 1.20381192921875e-05
Epoch: 7 cost time: 0.7764186859130859
Epoch: 7, Steps: 131 | Train Loss: 0.7382815 Vali Loss: 0.2836448 Best vali loss: 0.2809652
	iters: 100, epoch: 8 | loss: 0.6672295
	speed: 0.0094s/iter; left time: 0.2999s
Updating learning rate to 6.01905964609375e-06
Epoch: 8 cost time: 0.7730233669281006
Epoch: 8, Steps: 131 | Train Loss: 0.6672295 Vali Loss: 0.2834729 Best vali loss: 0.2809652

best validation loss 0.2809651934688266

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0043465477863, 'e_layers': 4, 'learning_rate': 0.0010618747206, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2185104
	speed: 0.0118s/iter; left time: 97.5538s
	iters: 200, epoch: 1 | loss: 0.2863590
	speed: 0.0063s/iter; left time: 51.3239s
	iters: 300, epoch: 1 | loss: 0.3143177
	speed: 0.0063s/iter; left time: 50.7884s
	iters: 400, epoch: 1 | loss: 0.4812644
	speed: 0.0063s/iter; left time: 49.8307s
	iters: 500, epoch: 1 | loss: 0.4533478
	speed: 0.0064s/iter; left time: 50.1923s
	iters: 600, epoch: 1 | loss: 1.9254383
	speed: 0.0064s/iter; left time: 49.2925s
	iters: 700, epoch: 1 | loss: 0.7571397
	speed: 0.0064s/iter; left time: 48.9594s
	iters: 800, epoch: 1 | loss: 0.4300933
	speed: 0.0064s/iter; left time: 48.4437s
	iters: 900, epoch: 1 | loss: 0.4387438
	speed: 0.0057s/iter; left time: 42.5102s
	iters: 1000, epoch: 1 | loss: 0.2560341
	speed: 0.0058s/iter; left time: 42.8686s
Updating learning rate to 0.0010618747206
Validation loss decreased (inf --> 0.3183).  Saving model state dict ...
Epoch: 1 cost time: 6.793374538421631
Epoch: 1, Steps: 1045 | Train Loss: 0.5561248 Vali Loss: 0.3183434 Best vali loss: 0.3183434
	iters: 100, epoch: 2 | loss: 0.2261147
	speed: 0.0202s/iter; left time: 145.5096s
	iters: 200, epoch: 2 | loss: 0.3827854
	speed: 0.0065s/iter; left time: 46.2530s
	iters: 300, epoch: 2 | loss: 0.7835292
	speed: 0.0065s/iter; left time: 45.3992s
	iters: 400, epoch: 2 | loss: 0.8769051
	speed: 0.0065s/iter; left time: 44.9675s
	iters: 500, epoch: 2 | loss: 1.4267838
	speed: 0.0065s/iter; left time: 44.1585s
	iters: 600, epoch: 2 | loss: 1.2501644
	speed: 0.0067s/iter; left time: 45.1888s
	iters: 700, epoch: 2 | loss: 0.9363638
	speed: 0.0068s/iter; left time: 44.7918s
	iters: 800, epoch: 2 | loss: 1.0248524
	speed: 0.0067s/iter; left time: 43.5900s
	iters: 900, epoch: 2 | loss: 0.5710426
	speed: 0.0058s/iter; left time: 37.0179s
	iters: 1000, epoch: 2 | loss: 0.4716132
	speed: 0.0055s/iter; left time: 34.6985s
Updating learning rate to 0.0005309373603
Epoch: 2 cost time: 6.652564287185669
Epoch: 2, Steps: 1045 | Train Loss: 0.7950155 Vali Loss: 0.3202511 Best vali loss: 0.3183434
	iters: 100, epoch: 3 | loss: 0.3316928
	speed: 0.0164s/iter; left time: 100.9645s
	iters: 200, epoch: 3 | loss: 0.7736249
	speed: 0.0064s/iter; left time: 38.9759s
	iters: 300, epoch: 3 | loss: 0.2593554
	speed: 0.0057s/iter; left time: 33.7494s
	iters: 400, epoch: 3 | loss: 1.1548759
	speed: 0.0050s/iter; left time: 29.2944s
	iters: 500, epoch: 3 | loss: 0.2284900
	speed: 0.0066s/iter; left time: 38.2504s
	iters: 600, epoch: 3 | loss: 0.5907047
	speed: 0.0069s/iter; left time: 39.2655s
	iters: 700, epoch: 3 | loss: 0.6833194
	speed: 0.0066s/iter; left time: 36.8105s
	iters: 800, epoch: 3 | loss: 0.3071093
	speed: 0.0062s/iter; left time: 34.0624s
	iters: 900, epoch: 3 | loss: 0.3325403
	speed: 0.0070s/iter; left time: 37.4778s
	iters: 1000, epoch: 3 | loss: 0.2591654
	speed: 0.0070s/iter; left time: 36.7151s
Updating learning rate to 0.00026546868015
Epoch: 3 cost time: 6.695992946624756
Epoch: 3, Steps: 1045 | Train Loss: 0.4920878 Vali Loss: 0.3226086 Best vali loss: 0.3183434

best validation loss 0.31834344162999495

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0047550092177, 'e_layers': 4, 'learning_rate': 0.0009477249465, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009116543135108521
Validation loss decreased (inf --> 0.2911).  Saving model state dict ...
Epoch: 1 cost time: 0.7098264694213867
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2911217 Best vali loss: 0.2911217
Updating learning rate to 0.0008089338414349039
Validation loss decreased (0.2911 --> 0.2876).  Saving model state dict ...
Epoch: 2 cost time: 0.48861098289489746
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2875739 Best vali loss: 0.2875739
Updating learning rate to 0.0006552017909823206
Epoch: 3 cost time: 0.4867589473724365
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2906705 Best vali loss: 0.2875739

best validation loss 0.2875739256105001

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010127908578, 'e_layers': 1, 'learning_rate': 0.0003534066616, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4280683
	speed: 0.0082s/iter; left time: 33.6011s
	iters: 200, epoch: 1 | loss: 0.3767034
	speed: 0.0033s/iter; left time: 13.2249s
	iters: 300, epoch: 1 | loss: 0.7859615
	speed: 0.0034s/iter; left time: 13.0401s
	iters: 400, epoch: 1 | loss: 0.3195221
	speed: 0.0034s/iter; left time: 12.7176s
	iters: 500, epoch: 1 | loss: 0.3580907
	speed: 0.0034s/iter; left time: 12.5310s
Updating learning rate to 0.0003534066616
Validation loss decreased (inf --> 0.2843).  Saving model state dict ...
Epoch: 1 cost time: 1.9695219993591309
Epoch: 1, Steps: 523 | Train Loss: 0.4536692 Vali Loss: 0.2842998 Best vali loss: 0.2842998
	iters: 100, epoch: 2 | loss: 0.5800300
	speed: 0.0072s/iter; left time: 25.4964s
	iters: 200, epoch: 2 | loss: 0.4795678
	speed: 0.0035s/iter; left time: 12.0914s
	iters: 300, epoch: 2 | loss: 0.6013098
	speed: 0.0035s/iter; left time: 11.8146s
	iters: 400, epoch: 2 | loss: 0.2684295
	speed: 0.0035s/iter; left time: 11.3557s
	iters: 500, epoch: 2 | loss: 0.3551244
	speed: 0.0033s/iter; left time: 10.4469s
Updating learning rate to 0.0001767033308
Epoch: 2 cost time: 1.757725715637207
Epoch: 2, Steps: 523 | Train Loss: 0.4568923 Vali Loss: 0.2880659 Best vali loss: 0.2842998
	iters: 100, epoch: 3 | loss: 0.2680596
	speed: 0.0072s/iter; left time: 21.8444s
	iters: 200, epoch: 3 | loss: 1.1075044
	speed: 0.0035s/iter; left time: 10.4200s
	iters: 300, epoch: 3 | loss: 0.4611302
	speed: 0.0035s/iter; left time: 10.0285s
	iters: 400, epoch: 3 | loss: 0.8039120
	speed: 0.0036s/iter; left time: 9.7585s
	iters: 500, epoch: 3 | loss: 0.3301064
	speed: 0.0036s/iter; left time: 9.3848s
Updating learning rate to 8.83516654e-05
Epoch: 3 cost time: 1.7993385791778564
Epoch: 3, Steps: 523 | Train Loss: 0.5941425 Vali Loss: 0.2918949 Best vali loss: 0.2842998

best validation loss 0.2842997539637478

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010127908578, 'e_layers': 1, 'learning_rate': 0.0003534066616, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3852246
	speed: 0.0094s/iter; left time: 23.6285s
	iters: 200, epoch: 4 | loss: 0.3229825
	speed: 0.0036s/iter; left time: 8.7744s
	iters: 300, epoch: 4 | loss: 0.6305301
	speed: 0.0032s/iter; left time: 7.4762s
	iters: 400, epoch: 4 | loss: 0.3076907
	speed: 0.0027s/iter; left time: 6.0395s
	iters: 500, epoch: 4 | loss: 0.2359870
	speed: 0.0026s/iter; left time: 5.4533s
Updating learning rate to 4.41758327e-05
Epoch: 4 cost time: 1.9204628467559814
Epoch: 4, Steps: 523 | Train Loss: 0.3764830 Vali Loss: 0.3012395 Best vali loss: 0.2842998
	iters: 100, epoch: 5 | loss: 0.3635443
	speed: 0.0059s/iter; left time: 11.8290s
	iters: 200, epoch: 5 | loss: 0.4359115
	speed: 0.0028s/iter; left time: 5.3017s
	iters: 300, epoch: 5 | loss: 0.4513176
	speed: 0.0033s/iter; left time: 5.8807s
	iters: 400, epoch: 5 | loss: 0.2525937
	speed: 0.0033s/iter; left time: 5.6161s
	iters: 500, epoch: 5 | loss: 0.3215334
	speed: 0.0033s/iter; left time: 5.2707s
Updating learning rate to 2.208791635e-05
Epoch: 5 cost time: 1.6365509033203125
Epoch: 5, Steps: 523 | Train Loss: 0.3649801 Vali Loss: 0.2982800 Best vali loss: 0.2842998
	iters: 100, epoch: 6 | loss: 0.2579376
	speed: 0.0083s/iter; left time: 12.1650s
	iters: 200, epoch: 6 | loss: 0.7924594
	speed: 0.0032s/iter; left time: 4.3980s
	iters: 300, epoch: 6 | loss: 0.4345275
	speed: 0.0032s/iter; left time: 4.0587s
	iters: 400, epoch: 6 | loss: 0.6998994
	speed: 0.0033s/iter; left time: 3.8063s
	iters: 500, epoch: 6 | loss: 0.2782818
	speed: 0.0033s/iter; left time: 3.5084s
Updating learning rate to 1.1043958175e-05
Epoch: 6 cost time: 1.7420659065246582
Epoch: 6, Steps: 523 | Train Loss: 0.4926211 Vali Loss: 0.3004933 Best vali loss: 0.2842998
	iters: 100, epoch: 7 | loss: 0.3283642
	speed: 0.0076s/iter; left time: 7.2323s
	iters: 200, epoch: 7 | loss: 0.2752932
	speed: 0.0031s/iter; left time: 2.6423s
	iters: 300, epoch: 7 | loss: 0.1712190
	speed: 0.0032s/iter; left time: 2.4137s
	iters: 400, epoch: 7 | loss: 0.2141441
	speed: 0.0033s/iter; left time: 2.1094s
	iters: 500, epoch: 7 | loss: 0.1677333
	speed: 0.0033s/iter; left time: 1.7851s
Updating learning rate to 5.5219790875e-06
Epoch: 7 cost time: 1.7070071697235107
Epoch: 7, Steps: 523 | Train Loss: 0.2313507 Vali Loss: 0.3033170 Best vali loss: 0.2842998
	iters: 100, epoch: 8 | loss: 0.2326128
	speed: 0.0080s/iter; left time: 3.3828s
	iters: 200, epoch: 8 | loss: 0.2371302
	speed: 0.0033s/iter; left time: 1.0553s
	iters: 300, epoch: 8 | loss: 0.6261933
	speed: 0.0031s/iter; left time: 0.7036s
	iters: 400, epoch: 8 | loss: 0.2564071
	speed: 0.0031s/iter; left time: 0.3888s
	iters: 500, epoch: 8 | loss: 0.3493230
	speed: 0.0031s/iter; left time: 0.0754s
Updating learning rate to 2.76098954375e-06
Epoch: 8 cost time: 1.7097346782684326
Epoch: 8, Steps: 523 | Train Loss: 0.3403333 Vali Loss: 0.3028535 Best vali loss: 0.2842998

best validation loss 0.2842997539637478

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.002837852389, 'e_layers': 4, 'learning_rate': 0.000309609584, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7877322
	speed: 0.0117s/iter; left time: 47.8187s
	iters: 200, epoch: 1 | loss: 0.2964433
	speed: 0.0063s/iter; left time: 25.0747s
	iters: 300, epoch: 1 | loss: 0.3928342
	speed: 0.0062s/iter; left time: 24.2802s
	iters: 400, epoch: 1 | loss: 0.4311615
	speed: 0.0063s/iter; left time: 23.8314s
	iters: 500, epoch: 1 | loss: 0.1839791
	speed: 0.0061s/iter; left time: 22.3636s
Updating learning rate to 0.000309609584
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 3.5468192100524902
Epoch: 1, Steps: 523 | Train Loss: 0.4184301 Vali Loss: 0.2828024 Best vali loss: 0.2828024
	iters: 100, epoch: 2 | loss: 0.7636011
	speed: 0.0131s/iter; left time: 46.7948s
	iters: 200, epoch: 2 | loss: 0.2543782
	speed: 0.0063s/iter; left time: 21.7338s
	iters: 300, epoch: 2 | loss: 0.8337907
	speed: 0.0063s/iter; left time: 21.0651s
	iters: 400, epoch: 2 | loss: 0.6477751
	speed: 0.0063s/iter; left time: 20.4364s
	iters: 500, epoch: 2 | loss: 1.2364230
	speed: 0.0060s/iter; left time: 18.8622s
Updating learning rate to 0.000154804792
Epoch: 2 cost time: 3.302184581756592
Epoch: 2, Steps: 523 | Train Loss: 0.7471936 Vali Loss: 0.2857280 Best vali loss: 0.2828024
	iters: 100, epoch: 3 | loss: 0.4649863
	speed: 0.0129s/iter; left time: 39.0661s
	iters: 200, epoch: 3 | loss: 0.2905118
	speed: 0.0063s/iter; left time: 18.5211s
	iters: 300, epoch: 3 | loss: 0.2553993
	speed: 0.0062s/iter; left time: 17.5117s
	iters: 400, epoch: 3 | loss: 0.2351675
	speed: 0.0061s/iter; left time: 16.8414s
	iters: 500, epoch: 3 | loss: 0.4318078
	speed: 0.0058s/iter; left time: 15.2947s
Updating learning rate to 7.7402396e-05
Epoch: 3 cost time: 3.2503695487976074
Epoch: 3, Steps: 523 | Train Loss: 0.3355745 Vali Loss: 0.2848681 Best vali loss: 0.2828024
	iters: 100, epoch: 4 | loss: 0.2203465
	speed: 0.0129s/iter; left time: 32.3466s
	iters: 200, epoch: 4 | loss: 0.7243517
	speed: 0.0063s/iter; left time: 15.2162s
	iters: 300, epoch: 4 | loss: 0.4058879
	speed: 0.0063s/iter; left time: 14.6518s
	iters: 400, epoch: 4 | loss: 0.3357116
	speed: 0.0063s/iter; left time: 13.9745s
	iters: 500, epoch: 4 | loss: 1.0375792
	speed: 0.0061s/iter; left time: 12.8232s
Updating learning rate to 3.8701198e-05
Epoch: 4 cost time: 3.3161962032318115
Epoch: 4, Steps: 523 | Train Loss: 0.5447754 Vali Loss: 0.2879922 Best vali loss: 0.2828024
	iters: 100, epoch: 5 | loss: 0.3569197
	speed: 0.0128s/iter; left time: 25.4663s
	iters: 200, epoch: 5 | loss: 0.4423479
	speed: 0.0062s/iter; left time: 11.7784s
	iters: 300, epoch: 5 | loss: 0.4838424
	speed: 0.0062s/iter; left time: 11.1293s
	iters: 400, epoch: 5 | loss: 0.3097241
	speed: 0.0062s/iter; left time: 10.5401s
	iters: 500, epoch: 5 | loss: 0.3524758
	speed: 0.0057s/iter; left time: 9.1167s
Updating learning rate to 1.9350599e-05
Epoch: 5 cost time: 3.2326102256774902
Epoch: 5, Steps: 523 | Train Loss: 0.3890620 Vali Loss: 0.2882637 Best vali loss: 0.2828024
	iters: 100, epoch: 6 | loss: 1.0709566
	speed: 0.0129s/iter; left time: 18.9291s
	iters: 200, epoch: 6 | loss: 0.5415329
	speed: 0.0063s/iter; left time: 8.6195s
	iters: 300, epoch: 6 | loss: 0.2014521
	speed: 0.0062s/iter; left time: 7.9081s
	iters: 400, epoch: 6 | loss: 0.3437897
	speed: 0.0061s/iter; left time: 7.1786s
	iters: 500, epoch: 6 | loss: 0.4663998
	speed: 0.0057s/iter; left time: 6.1126s
Updating learning rate to 9.6752995e-06
Epoch: 6 cost time: 3.2497899532318115
Epoch: 6, Steps: 523 | Train Loss: 0.5248262 Vali Loss: 0.2887565 Best vali loss: 0.2828024
	iters: 100, epoch: 7 | loss: 0.2648140
	speed: 0.0104s/iter; left time: 9.8944s
	iters: 200, epoch: 7 | loss: 0.6415410
	speed: 0.0061s/iter; left time: 5.1635s
	iters: 300, epoch: 7 | loss: 0.4643204
	speed: 0.0062s/iter; left time: 4.5970s
	iters: 400, epoch: 7 | loss: 0.4296562
	speed: 0.0062s/iter; left time: 4.0187s
	iters: 500, epoch: 7 | loss: 0.7532079
	speed: 0.0062s/iter; left time: 3.4138s
Updating learning rate to 4.83764975e-06
Epoch: 7 cost time: 3.1370935440063477
Epoch: 7, Steps: 523 | Train Loss: 0.5107079 Vali Loss: 0.2883794 Best vali loss: 0.2828024
	iters: 100, epoch: 8 | loss: 0.4031863
	speed: 0.0117s/iter; left time: 4.9765s
	iters: 200, epoch: 8 | loss: 0.2133373
	speed: 0.0057s/iter; left time: 1.8471s
	iters: 300, epoch: 8 | loss: 0.3227027
	speed: 0.0057s/iter; left time: 1.2696s
	iters: 400, epoch: 8 | loss: 0.4894265
	speed: 0.0057s/iter; left time: 0.7021s
	iters: 500, epoch: 8 | loss: 0.2755109
	speed: 0.0057s/iter; left time: 0.1359s
Updating learning rate to 2.418824875e-06
Epoch: 8 cost time: 2.987966299057007
Epoch: 8, Steps: 523 | Train Loss: 0.3408327 Vali Loss: 0.2886569 Best vali loss: 0.2828024

best validation loss 0.28280238312343187

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0027808440321, 'e_layers': 3, 'learning_rate': 0.00233717616, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3940715
	speed: 0.0107s/iter; left time: 43.5575s
	iters: 200, epoch: 1 | loss: 0.2803090
	speed: 0.0053s/iter; left time: 21.1173s
	iters: 300, epoch: 1 | loss: 0.4867945
	speed: 0.0053s/iter; left time: 20.4980s
	iters: 400, epoch: 1 | loss: 0.6784946
	speed: 0.0052s/iter; left time: 19.6040s
	iters: 500, epoch: 1 | loss: 0.8415014
	speed: 0.0048s/iter; left time: 17.6545s
Updating learning rate to 0.002248222689048662
Validation loss decreased (inf --> 0.2916).  Saving model state dict ...
Epoch: 1 cost time: 2.970635414123535
Epoch: 1, Steps: 523 | Train Loss: 0.5362342 Vali Loss: 0.2916427 Best vali loss: 0.2916427
	iters: 100, epoch: 2 | loss: 0.4007736
	speed: 0.0110s/iter; left time: 39.1540s
	iters: 200, epoch: 2 | loss: 0.8730746
	speed: 0.0051s/iter; left time: 17.5919s
	iters: 300, epoch: 2 | loss: 0.3799704
	speed: 0.0050s/iter; left time: 16.9534s
	iters: 400, epoch: 2 | loss: 0.5232818
	speed: 0.0050s/iter; left time: 16.3129s
	iters: 500, epoch: 2 | loss: 0.6895914
	speed: 0.0047s/iter; left time: 14.8730s
Updating learning rate to 0.0019949046357817675
Validation loss decreased (0.2916 --> 0.2894).  Saving model state dict ...
Epoch: 2 cost time: 2.642423152923584
Epoch: 2, Steps: 523 | Train Loss: 0.5733384 Vali Loss: 0.2894403 Best vali loss: 0.2894403
	iters: 100, epoch: 3 | loss: 0.5262866
	speed: 0.0113s/iter; left time: 34.2282s
	iters: 200, epoch: 3 | loss: 0.5049615
	speed: 0.0058s/iter; left time: 16.9737s
	iters: 300, epoch: 3 | loss: 0.2482255
	speed: 0.0060s/iter; left time: 16.9896s
	iters: 400, epoch: 3 | loss: 0.2560334
	speed: 0.0060s/iter; left time: 16.5025s
	iters: 500, epoch: 3 | loss: 0.4003976
	speed: 0.0051s/iter; left time: 13.4533s
Updating learning rate to 0.0016157873774753303
Validation loss decreased (0.2894 --> 0.2888).  Saving model state dict ...
Epoch: 3 cost time: 2.9649085998535156
Epoch: 3, Steps: 523 | Train Loss: 0.3871809 Vali Loss: 0.2887603 Best vali loss: 0.2887603
	iters: 100, epoch: 4 | loss: 0.2911517
	speed: 0.0110s/iter; left time: 27.5745s
	iters: 200, epoch: 4 | loss: 0.4196064
	speed: 0.0052s/iter; left time: 12.6102s
	iters: 300, epoch: 4 | loss: 0.8282269
	speed: 0.0052s/iter; left time: 12.1028s
	iters: 400, epoch: 4 | loss: 0.6340129
	speed: 0.0052s/iter; left time: 11.5042s
	iters: 500, epoch: 4 | loss: 0.4583154
	speed: 0.0049s/iter; left time: 10.4123s
Updating learning rate to 0.00116858808
Epoch: 4 cost time: 2.735729217529297
Epoch: 4, Steps: 523 | Train Loss: 0.5262627 Vali Loss: 0.2925807 Best vali loss: 0.2887603
	iters: 100, epoch: 5 | loss: 0.4803555
	speed: 0.0108s/iter; left time: 21.4606s
	iters: 200, epoch: 5 | loss: 0.3016700
	speed: 0.0052s/iter; left time: 9.8329s
	iters: 300, epoch: 5 | loss: 0.5193880
	speed: 0.0052s/iter; left time: 9.3524s
	iters: 400, epoch: 5 | loss: 0.4811270
	speed: 0.0051s/iter; left time: 8.6734s
	iters: 500, epoch: 5 | loss: 0.5641897
	speed: 0.0049s/iter; left time: 7.8499s
Updating learning rate to 0.00072138878252467
Epoch: 5 cost time: 2.7214200496673584
Epoch: 5, Steps: 523 | Train Loss: 0.4693460 Vali Loss: 0.2925914 Best vali loss: 0.2887603
	iters: 100, epoch: 6 | loss: 0.2677144
	speed: 0.0109s/iter; left time: 15.9967s
	iters: 200, epoch: 6 | loss: 0.3869464
	speed: 0.0054s/iter; left time: 7.3716s
	iters: 300, epoch: 6 | loss: 0.2480596
	speed: 0.0054s/iter; left time: 6.8174s
	iters: 400, epoch: 6 | loss: 0.8661734
	speed: 0.0054s/iter; left time: 6.3116s
	iters: 500, epoch: 6 | loss: 0.8612400
	speed: 0.0053s/iter; left time: 5.6292s
Updating learning rate to 0.0003422715242182324
Epoch: 6 cost time: 2.8337461948394775
Epoch: 6, Steps: 523 | Train Loss: 0.5260268 Vali Loss: 0.3130861 Best vali loss: 0.2887603
	iters: 100, epoch: 7 | loss: 0.2332754
	speed: 0.0095s/iter; left time: 9.0395s
	iters: 200, epoch: 7 | loss: 0.4976551
	speed: 0.0047s/iter; left time: 4.0019s
	iters: 300, epoch: 7 | loss: 0.3956687
	speed: 0.0053s/iter; left time: 3.9599s
	iters: 400, epoch: 7 | loss: 0.5279037
	speed: 0.0053s/iter; left time: 3.4355s
	iters: 500, epoch: 7 | loss: 0.4815910
	speed: 0.0055s/iter; left time: 2.9968s
Updating learning rate to 8.895347095133785e-05
Epoch: 7 cost time: 2.6478188037872314
Epoch: 7, Steps: 523 | Train Loss: 0.4272188 Vali Loss: 0.3114718 Best vali loss: 0.2887603
	iters: 100, epoch: 8 | loss: 0.4319355
	speed: 0.0093s/iter; left time: 3.9412s
	iters: 200, epoch: 8 | loss: 0.5370564
	speed: 0.0053s/iter; left time: 1.7304s
	iters: 300, epoch: 8 | loss: 0.7083846
	speed: 0.0053s/iter; left time: 1.1844s
	iters: 400, epoch: 8 | loss: 0.3511761
	speed: 0.0054s/iter; left time: 0.6660s
	iters: 500, epoch: 8 | loss: 0.5997772
	speed: 0.0051s/iter; left time: 0.1226s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.74194073677063
Epoch: 8, Steps: 523 | Train Loss: 0.5256660 Vali Loss: 0.3157640 Best vali loss: 0.2887603

best validation loss 0.28876026876356664

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010686625021, 'e_layers': 4, 'learning_rate': 0.000475580227, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000475580227
Validation loss decreased (inf --> 0.2881).  Saving model state dict ...
Epoch: 1 cost time: 0.7349789142608643
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2881173 Best vali loss: 0.2881173
Updating learning rate to 0.0002377901135
Validation loss decreased (0.2881 --> 0.2836).  Saving model state dict ...
Epoch: 2 cost time: 0.47952890396118164
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2835656 Best vali loss: 0.2835656
Updating learning rate to 0.00011889505675
Validation loss decreased (0.2836 --> 0.2809).  Saving model state dict ...
Epoch: 3 cost time: 0.47452759742736816
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2809414 Best vali loss: 0.2809414

best validation loss 0.2809414334259941

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0246521
	speed: 0.0098s/iter; left time: 40.1612s
	iters: 200, epoch: 1 | loss: 0.2399259
	speed: 0.0038s/iter; left time: 15.1013s
	iters: 300, epoch: 1 | loss: 0.3208180
	speed: 0.0033s/iter; left time: 12.9900s
	iters: 400, epoch: 1 | loss: 0.8198326
	speed: 0.0032s/iter; left time: 12.1317s
	iters: 500, epoch: 1 | loss: 0.6980167
	speed: 0.0034s/iter; left time: 12.4824s
Updating learning rate to 0.0008497821375614502
Validation loss decreased (inf --> 0.2928).  Saving model state dict ...
Epoch: 1 cost time: 2.189293384552002
Epoch: 1, Steps: 523 | Train Loss: 0.6206491 Vali Loss: 0.2928238 Best vali loss: 0.2928238
	iters: 100, epoch: 2 | loss: 0.7262076
	speed: 0.0098s/iter; left time: 34.9687s
	iters: 200, epoch: 2 | loss: 0.5265979
	speed: 0.0040s/iter; left time: 14.0156s
	iters: 300, epoch: 2 | loss: 0.2893936
	speed: 0.0032s/iter; left time: 10.6200s
	iters: 400, epoch: 2 | loss: 0.3146605
	speed: 0.0033s/iter; left time: 10.7482s
	iters: 500, epoch: 2 | loss: 0.7289470
	speed: 0.0041s/iter; left time: 12.9161s
Updating learning rate to 0.0007540331008505288
Validation loss decreased (0.2928 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 2.0458762645721436
Epoch: 2, Steps: 523 | Train Loss: 0.5171613 Vali Loss: 0.2838123 Best vali loss: 0.2838123
	iters: 100, epoch: 3 | loss: 0.3225764
	speed: 0.0090s/iter; left time: 27.3905s
	iters: 200, epoch: 3 | loss: 0.3469073
	speed: 0.0042s/iter; left time: 12.2392s
	iters: 300, epoch: 3 | loss: 0.9845026
	speed: 0.0036s/iter; left time: 10.2583s
	iters: 400, epoch: 3 | loss: 0.5150281
	speed: 0.0039s/iter; left time: 10.7039s
	iters: 500, epoch: 3 | loss: 0.5677084
	speed: 0.0041s/iter; left time: 10.8646s
Updating learning rate to 0.0006107345407392943
Epoch: 3 cost time: 2.106278657913208
Epoch: 3, Steps: 523 | Train Loss: 0.5473445 Vali Loss: 0.2935537 Best vali loss: 0.2838123

best validation loss 0.28381234135890193

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.000943052393, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.878964131515138e-05
Validation loss decreased (inf --> 0.3190).  Saving model state dict ...
Epoch: 1 cost time: 0.5682415962219238
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3189655 Best vali loss: 0.3189655
Updating learning rate to 5.216552993919382e-05
Validation loss decreased (0.3190 --> 0.3010).  Saving model state dict ...
Epoch: 2 cost time: 0.34412693977355957
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3009716 Best vali loss: 0.3009716
Updating learning rate to 4.2251846681397714e-05
Validation loss decreased (0.3010 --> 0.2920).  Saving model state dict ...
Epoch: 3 cost time: 0.3753635883331299
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2919885 Best vali loss: 0.2919885

best validation loss 0.29198847475017303

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010686625021, 'e_layers': 4, 'learning_rate': 0.000475580227, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.9447528375e-05
Epoch: 4 cost time: 0.7469038963317871
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2816325 Best vali loss: 0.2809414
Updating learning rate to 2.97237641875e-05
Validation loss decreased (0.2809 --> 0.2809).  Saving model state dict ...
Epoch: 5 cost time: 0.5210003852844238
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2808679 Best vali loss: 0.2808679
Updating learning rate to 1.486188209375e-05
Epoch: 6 cost time: 0.4971461296081543
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2809140 Best vali loss: 0.2808679
Updating learning rate to 7.430941046875e-06
Epoch: 7 cost time: 0.49272942543029785
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2808976 Best vali loss: 0.2808679
Updating learning rate to 3.7154705234375e-06
Epoch: 8 cost time: 0.5239717960357666
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2808695 Best vali loss: 0.2808679

best validation loss 0.280867906483344

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0087891353463, 'e_layers': 2, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5176576
	speed: 0.0099s/iter; left time: 81.6498s
	iters: 200, epoch: 1 | loss: 0.3194781
	speed: 0.0041s/iter; left time: 33.5426s
	iters: 300, epoch: 1 | loss: 0.3563254
	speed: 0.0041s/iter; left time: 33.2683s
	iters: 400, epoch: 1 | loss: 0.8357618
	speed: 0.0041s/iter; left time: 32.8221s
	iters: 500, epoch: 1 | loss: 1.7418417
	speed: 0.0038s/iter; left time: 29.6907s
	iters: 600, epoch: 1 | loss: 0.2268207
	speed: 0.0037s/iter; left time: 28.4230s
	iters: 700, epoch: 1 | loss: 0.3347535
	speed: 0.0037s/iter; left time: 28.3243s
	iters: 800, epoch: 1 | loss: 1.4738997
	speed: 0.0041s/iter; left time: 30.9096s
	iters: 900, epoch: 1 | loss: 0.8588902
	speed: 0.0041s/iter; left time: 30.3706s
	iters: 1000, epoch: 1 | loss: 0.7197472
	speed: 0.0041s/iter; left time: 30.2460s
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.2966).  Saving model state dict ...
Epoch: 1 cost time: 4.4645750522613525
Epoch: 1, Steps: 1045 | Train Loss: 0.7385176 Vali Loss: 0.2965516 Best vali loss: 0.2965516
	iters: 100, epoch: 2 | loss: 0.9897768
	speed: 0.0150s/iter; left time: 108.4481s
	iters: 200, epoch: 2 | loss: 0.1512412
	speed: 0.0044s/iter; left time: 31.3456s
	iters: 300, epoch: 2 | loss: 0.5688821
	speed: 0.0044s/iter; left time: 31.0270s
	iters: 400, epoch: 2 | loss: 1.0589350
	speed: 0.0048s/iter; left time: 32.9079s
	iters: 500, epoch: 2 | loss: 0.1216183
	speed: 0.0042s/iter; left time: 28.5704s
	iters: 600, epoch: 2 | loss: 1.9327607
	speed: 0.0043s/iter; left time: 28.8753s
	iters: 700, epoch: 2 | loss: 0.8048339
	speed: 0.0041s/iter; left time: 27.4010s
	iters: 800, epoch: 2 | loss: 0.2990815
	speed: 0.0042s/iter; left time: 27.5248s
	iters: 900, epoch: 2 | loss: 0.2122257
	speed: 0.0042s/iter; left time: 27.0913s
	iters: 1000, epoch: 2 | loss: 0.6999893
	speed: 0.0042s/iter; left time: 26.3726s
Updating learning rate to 0.0009137180420535848
Validation loss decreased (0.2966 --> 0.2871).  Saving model state dict ...
Epoch: 2 cost time: 4.570018529891968
Epoch: 2, Steps: 1045 | Train Loss: 0.6839345 Vali Loss: 0.2871416 Best vali loss: 0.2871416
	iters: 100, epoch: 3 | loss: 0.2280278
	speed: 0.0141s/iter; left time: 87.1917s
	iters: 200, epoch: 3 | loss: 0.3885464
	speed: 0.0041s/iter; left time: 25.0986s
	iters: 300, epoch: 3 | loss: 0.6587240
	speed: 0.0042s/iter; left time: 24.8483s
	iters: 400, epoch: 3 | loss: 0.4981118
	speed: 0.0042s/iter; left time: 24.4441s
	iters: 500, epoch: 3 | loss: 1.0232624
	speed: 0.0038s/iter; left time: 21.9979s
	iters: 600, epoch: 3 | loss: 0.2156097
	speed: 0.0038s/iter; left time: 21.7215s
	iters: 700, epoch: 3 | loss: 0.2250589
	speed: 0.0043s/iter; left time: 24.2123s
	iters: 800, epoch: 3 | loss: 1.2478651
	speed: 0.0048s/iter; left time: 26.2258s
	iters: 900, epoch: 3 | loss: 0.2352375
	speed: 0.0047s/iter; left time: 25.3281s
	iters: 1000, epoch: 3 | loss: 0.3220023
	speed: 0.0041s/iter; left time: 21.7692s
Updating learning rate to 0.0007400725089513316
Validation loss decreased (0.2871 --> 0.2852).  Saving model state dict ...
Epoch: 3 cost time: 4.455282926559448
Epoch: 3, Steps: 1045 | Train Loss: 0.5042446 Vali Loss: 0.2851550 Best vali loss: 0.2851550
	iters: 100, epoch: 4 | loss: 1.1899129
	speed: 0.0147s/iter; left time: 75.5829s
	iters: 200, epoch: 4 | loss: 0.7191080
	speed: 0.0043s/iter; left time: 21.4334s
	iters: 300, epoch: 4 | loss: 0.3010321
	speed: 0.0041s/iter; left time: 20.3535s
	iters: 400, epoch: 4 | loss: 0.3146761
	speed: 0.0041s/iter; left time: 19.7718s
	iters: 500, epoch: 4 | loss: 0.4191155
	speed: 0.0036s/iter; left time: 17.1048s
	iters: 600, epoch: 4 | loss: 0.3792116
	speed: 0.0038s/iter; left time: 17.5398s
	iters: 700, epoch: 4 | loss: 0.2533196
	speed: 0.0040s/iter; left time: 18.1146s
	iters: 800, epoch: 4 | loss: 0.2453045
	speed: 0.0041s/iter; left time: 18.2196s
	iters: 900, epoch: 4 | loss: 0.4206423
	speed: 0.0041s/iter; left time: 17.5682s
	iters: 1000, epoch: 4 | loss: 0.3657688
	speed: 0.0041s/iter; left time: 17.1917s
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 4.266546249389648
Epoch: 4, Steps: 1045 | Train Loss: 0.4608092 Vali Loss: 0.2902024 Best vali loss: 0.2851550
	iters: 100, epoch: 5 | loss: 0.4184939
	speed: 0.0145s/iter; left time: 59.2121s
	iters: 200, epoch: 5 | loss: 0.1750085
	speed: 0.0041s/iter; left time: 16.5006s
	iters: 300, epoch: 5 | loss: 0.5038859
	speed: 0.0042s/iter; left time: 16.3078s
	iters: 400, epoch: 5 | loss: 0.3136498
	speed: 0.0041s/iter; left time: 15.4179s
	iters: 500, epoch: 5 | loss: 0.2415802
	speed: 0.0039s/iter; left time: 14.4500s
	iters: 600, epoch: 5 | loss: 0.3731138
	speed: 0.0039s/iter; left time: 13.9268s
	iters: 700, epoch: 5 | loss: 0.3869866
	speed: 0.0042s/iter; left time: 14.5521s
	iters: 800, epoch: 5 | loss: 0.3349423
	speed: 0.0041s/iter; left time: 14.0134s
	iters: 900, epoch: 5 | loss: 0.2463280
	speed: 0.0042s/iter; left time: 13.7680s
	iters: 1000, epoch: 5 | loss: 0.9549692
	speed: 0.0041s/iter; left time: 13.1153s
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 4.3342180252075195
Epoch: 5, Steps: 1045 | Train Loss: 0.3948958 Vali Loss: 0.2986816 Best vali loss: 0.2851550
	iters: 100, epoch: 6 | loss: 0.2648933
	speed: 0.0141s/iter; left time: 42.7166s
	iters: 200, epoch: 6 | loss: 0.2506563
	speed: 0.0042s/iter; left time: 12.2794s
	iters: 300, epoch: 6 | loss: 0.1844659
	speed: 0.0042s/iter; left time: 11.8496s
	iters: 400, epoch: 6 | loss: 0.2290304
	speed: 0.0041s/iter; left time: 11.2015s
	iters: 500, epoch: 6 | loss: 0.8216924
	speed: 0.0039s/iter; left time: 10.2150s
	iters: 600, epoch: 6 | loss: 0.6677348
	speed: 0.0038s/iter; left time: 9.6206s
	iters: 700, epoch: 6 | loss: 0.2503695
	speed: 0.0043s/iter; left time: 10.4427s
	iters: 800, epoch: 6 | loss: 0.4259817
	speed: 0.0043s/iter; left time: 10.0680s
	iters: 900, epoch: 6 | loss: 0.2851922
	speed: 0.0042s/iter; left time: 9.4666s
	iters: 1000, epoch: 6 | loss: 0.2360562
	speed: 0.0042s/iter; left time: 8.9573s
Updating learning rate to 0.00015676923164641517
Epoch: 6 cost time: 4.362163305282593
Epoch: 6, Steps: 1045 | Train Loss: 0.3616073 Vali Loss: 0.3040337 Best vali loss: 0.2851550
	iters: 100, epoch: 7 | loss: 0.2705774
	speed: 0.0144s/iter; left time: 28.6325s
	iters: 200, epoch: 7 | loss: 0.2029716
	speed: 0.0041s/iter; left time: 7.7117s
	iters: 300, epoch: 7 | loss: 0.5456882
	speed: 0.0041s/iter; left time: 7.3094s
	iters: 400, epoch: 7 | loss: 0.3668683
	speed: 0.0041s/iter; left time: 6.9303s
	iters: 500, epoch: 7 | loss: 0.3664258
	speed: 0.0039s/iter; left time: 6.2213s
	iters: 600, epoch: 7 | loss: 0.3196680
	speed: 0.0037s/iter; left time: 5.4472s
	iters: 700, epoch: 7 | loss: 0.1629134
	speed: 0.0032s/iter; left time: 4.4692s
	iters: 800, epoch: 7 | loss: 0.2103337
	speed: 0.0032s/iter; left time: 4.1806s
	iters: 900, epoch: 7 | loss: 0.8163583
	speed: 0.0041s/iter; left time: 4.9125s
	iters: 1000, epoch: 7 | loss: 0.2968999
	speed: 0.0044s/iter; left time: 4.7645s
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 4.1216206550598145
Epoch: 7, Steps: 1045 | Train Loss: 0.3558705 Vali Loss: 0.3084356 Best vali loss: 0.2851550
	iters: 100, epoch: 8 | loss: 0.2460802
	speed: 0.0142s/iter; left time: 13.4672s
	iters: 200, epoch: 8 | loss: 0.5793744
	speed: 0.0043s/iter; left time: 3.6427s
	iters: 300, epoch: 8 | loss: 0.3134865
	speed: 0.0044s/iter; left time: 3.3143s
	iters: 400, epoch: 8 | loss: 0.4531912
	speed: 0.0042s/iter; left time: 2.7101s
	iters: 500, epoch: 8 | loss: 0.1852126
	speed: 0.0040s/iter; left time: 2.1623s
	iters: 600, epoch: 8 | loss: 0.3069806
	speed: 0.0040s/iter; left time: 1.7653s
	iters: 700, epoch: 8 | loss: 0.8080552
	speed: 0.0041s/iter; left time: 1.4131s
	iters: 800, epoch: 8 | loss: 0.4092627
	speed: 0.0040s/iter; left time: 0.9948s
	iters: 900, epoch: 8 | loss: 0.3420245
	speed: 0.0040s/iter; left time: 0.5885s
	iters: 1000, epoch: 8 | loss: 0.6820283
	speed: 0.0040s/iter; left time: 0.1859s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.370296955108643
Epoch: 8, Steps: 1045 | Train Loss: 0.4325696 Vali Loss: 0.3102078 Best vali loss: 0.2851550

best validation loss 0.28515504392029495

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0052842772816, 'e_layers': 4, 'learning_rate': 9.30573825e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1363633
	speed: 0.0123s/iter; left time: 50.2940s
	iters: 200, epoch: 1 | loss: 0.7446480
	speed: 0.0070s/iter; left time: 28.0478s
	iters: 300, epoch: 1 | loss: 0.7968073
	speed: 0.0069s/iter; left time: 26.9146s
	iters: 400, epoch: 1 | loss: 0.3323457
	speed: 0.0070s/iter; left time: 26.4408s
	iters: 500, epoch: 1 | loss: 0.6701291
	speed: 0.0061s/iter; left time: 22.5342s
Updating learning rate to 8.9515596770412e-05
Validation loss decreased (inf --> 0.3073).  Saving model state dict ...
Epoch: 1 cost time: 3.788433790206909
Epoch: 1, Steps: 523 | Train Loss: 0.7360587 Vali Loss: 0.3072915 Best vali loss: 0.3072915
	iters: 100, epoch: 2 | loss: 0.4510050
	speed: 0.0125s/iter; left time: 44.6569s
	iters: 200, epoch: 2 | loss: 0.2902353
	speed: 0.0063s/iter; left time: 21.8860s
	iters: 300, epoch: 2 | loss: 0.3679302
	speed: 0.0063s/iter; left time: 21.1117s
	iters: 400, epoch: 2 | loss: 0.4805288
	speed: 0.0062s/iter; left time: 20.1920s
	iters: 500, epoch: 2 | loss: 1.0215033
	speed: 0.0060s/iter; left time: 19.1274s
Updating learning rate to 7.942944435261018e-05
Validation loss decreased (0.3073 --> 0.2942).  Saving model state dict ...
Epoch: 2 cost time: 3.281864881515503
Epoch: 2, Steps: 523 | Train Loss: 0.5222405 Vali Loss: 0.2941512 Best vali loss: 0.2941512
	iters: 100, epoch: 3 | loss: 0.4555037
	speed: 0.0124s/iter; left time: 37.6657s
	iters: 200, epoch: 3 | loss: 0.4365682
	speed: 0.0061s/iter; left time: 17.8216s
	iters: 300, epoch: 3 | loss: 0.3896326
	speed: 0.0062s/iter; left time: 17.6299s
	iters: 400, epoch: 3 | loss: 0.3968076
	speed: 0.0062s/iter; left time: 16.9430s
	iters: 500, epoch: 3 | loss: 0.2495794
	speed: 0.0062s/iter; left time: 16.4768s
Updating learning rate to 6.433445052100552e-05
Validation loss decreased (0.2942 --> 0.2881).  Saving model state dict ...
Epoch: 3 cost time: 3.244248628616333
Epoch: 3, Steps: 523 | Train Loss: 0.3856183 Vali Loss: 0.2880627 Best vali loss: 0.2880627
	iters: 100, epoch: 4 | loss: 0.6934201
	speed: 0.0123s/iter; left time: 31.0698s
	iters: 200, epoch: 4 | loss: 0.3678297
	speed: 0.0062s/iter; left time: 14.9786s
	iters: 300, epoch: 4 | loss: 0.4957875
	speed: 0.0061s/iter; left time: 14.1852s
	iters: 400, epoch: 4 | loss: 0.4194477
	speed: 0.0062s/iter; left time: 13.7573s
	iters: 500, epoch: 4 | loss: 0.4535565
	speed: 0.0062s/iter; left time: 13.1001s
Updating learning rate to 4.652869125e-05
Validation loss decreased (0.2881 --> 0.2848).  Saving model state dict ...
Epoch: 4 cost time: 3.274932861328125
Epoch: 4, Steps: 523 | Train Loss: 0.4860083 Vali Loss: 0.2848235 Best vali loss: 0.2848235
	iters: 100, epoch: 5 | loss: 0.3435594
	speed: 0.0126s/iter; left time: 25.1494s
	iters: 200, epoch: 5 | loss: 0.2799518
	speed: 0.0064s/iter; left time: 12.0388s
	iters: 300, epoch: 5 | loss: 0.3029321
	speed: 0.0064s/iter; left time: 11.5629s
	iters: 400, epoch: 5 | loss: 0.7525828
	speed: 0.0064s/iter; left time: 10.8548s
	iters: 500, epoch: 5 | loss: 0.3936595
	speed: 0.0064s/iter; left time: 10.1361s
Updating learning rate to 2.8722931978994484e-05
Validation loss decreased (0.2848 --> 0.2847).  Saving model state dict ...
Epoch: 5 cost time: 3.382161855697632
Epoch: 5, Steps: 523 | Train Loss: 0.4145371 Vali Loss: 0.2846857 Best vali loss: 0.2846857
	iters: 100, epoch: 6 | loss: 0.3992450
	speed: 0.0131s/iter; left time: 19.3096s
	iters: 200, epoch: 6 | loss: 1.0221490
	speed: 0.0066s/iter; left time: 9.0319s
	iters: 300, epoch: 6 | loss: 0.5867488
	speed: 0.0065s/iter; left time: 8.2604s
	iters: 400, epoch: 6 | loss: 0.2657739
	speed: 0.0066s/iter; left time: 7.7323s
	iters: 500, epoch: 6 | loss: 0.3605958
	speed: 0.0065s/iter; left time: 6.9685s
Updating learning rate to 1.3627938147389826e-05
Validation loss decreased (0.2847 --> 0.2839).  Saving model state dict ...
Epoch: 6 cost time: 3.4859230518341064
Epoch: 6, Steps: 523 | Train Loss: 0.5269025 Vali Loss: 0.2838580 Best vali loss: 0.2838580
	iters: 100, epoch: 7 | loss: 0.5627797
	speed: 0.0117s/iter; left time: 11.1171s
	iters: 200, epoch: 7 | loss: 0.4478698
	speed: 0.0063s/iter; left time: 5.3359s
	iters: 300, epoch: 7 | loss: 0.8586108
	speed: 0.0073s/iter; left time: 5.4779s
	iters: 400, epoch: 7 | loss: 0.2504806
	speed: 0.0073s/iter; left time: 4.6960s
	iters: 500, epoch: 7 | loss: 0.8870548
	speed: 0.0072s/iter; left time: 3.9139s
Updating learning rate to 3.541785729588002e-06
Validation loss decreased (0.2839 --> 0.2838).  Saving model state dict ...
Epoch: 7 cost time: 3.5383141040802
Epoch: 7, Steps: 523 | Train Loss: 0.6013591 Vali Loss: 0.2838155 Best vali loss: 0.2838155
	iters: 100, epoch: 8 | loss: 0.2928164
	speed: 0.0150s/iter; left time: 6.3776s
	iters: 200, epoch: 8 | loss: 0.2070917
	speed: 0.0074s/iter; left time: 2.3953s
	iters: 300, epoch: 8 | loss: 0.6060083
	speed: 0.0074s/iter; left time: 1.6615s
	iters: 400, epoch: 8 | loss: 0.3429397
	speed: 0.0073s/iter; left time: 0.9077s
	iters: 500, epoch: 8 | loss: 0.4040661
	speed: 0.0070s/iter; left time: 0.1672s
Updating learning rate to 0.0
Validation loss decreased (0.2838 --> 0.2838).  Saving model state dict ...
Epoch: 8 cost time: 3.7480154037475586
Epoch: 8, Steps: 523 | Train Loss: 0.3705844 Vali Loss: 0.2837919 Best vali loss: 0.2837919

best validation loss 0.2837919409765369

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0094025534782, 'e_layers': 3, 'learning_rate': 7.57956321e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5919806
	speed: 0.0138s/iter; left time: 56.5068s
	iters: 200, epoch: 1 | loss: 1.0446987
	speed: 0.0079s/iter; left time: 31.5495s
	iters: 300, epoch: 1 | loss: 0.4857814
	speed: 0.0070s/iter; left time: 27.1267s
	iters: 400, epoch: 1 | loss: 1.2945942
	speed: 0.0051s/iter; left time: 19.2907s
	iters: 500, epoch: 1 | loss: 0.6794387
	speed: 0.0047s/iter; left time: 17.4470s
Updating learning rate to 7.291083262547274e-05
Validation loss decreased (inf --> 0.2785).  Saving model state dict ...
Epoch: 1 cost time: 3.6992156505584717
Epoch: 1, Steps: 523 | Train Loss: 0.8192987 Vali Loss: 0.2784924 Best vali loss: 0.2784924
	iters: 100, epoch: 2 | loss: 0.8159096
	speed: 0.0103s/iter; left time: 36.8359s
	iters: 200, epoch: 2 | loss: 1.2322553
	speed: 0.0055s/iter; left time: 19.0280s
	iters: 300, epoch: 2 | loss: 0.4423683
	speed: 0.0055s/iter; left time: 18.5206s
	iters: 400, epoch: 2 | loss: 0.2600496
	speed: 0.0055s/iter; left time: 17.9171s
	iters: 500, epoch: 2 | loss: 0.2495840
	speed: 0.0056s/iter; left time: 17.7008s
Updating learning rate to 6.469561877111538e-05
Validation loss decreased (0.2785 --> 0.2776).  Saving model state dict ...
Epoch: 2 cost time: 2.8938944339752197
Epoch: 2, Steps: 523 | Train Loss: 0.6000334 Vali Loss: 0.2776078 Best vali loss: 0.2776078
	iters: 100, epoch: 3 | loss: 0.4491936
	speed: 0.0120s/iter; left time: 36.4072s
	iters: 200, epoch: 3 | loss: 0.3326392
	speed: 0.0056s/iter; left time: 16.4306s
	iters: 300, epoch: 3 | loss: 0.7844753
	speed: 0.0056s/iter; left time: 16.0066s
	iters: 400, epoch: 3 | loss: 0.3284099
	speed: 0.0056s/iter; left time: 15.2048s
	iters: 500, epoch: 3 | loss: 0.6337715
	speed: 0.0056s/iter; left time: 14.6742s
Updating learning rate to 5.2400682375154794e-05
Epoch: 3 cost time: 2.9490091800689697
Epoch: 3, Steps: 523 | Train Loss: 0.5056979 Vali Loss: 0.2830163 Best vali loss: 0.2776078

best validation loss 0.2776078061460784

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0041376749186, 'e_layers': 2, 'learning_rate': 0.0013179784539, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2099098
	speed: 0.0097s/iter; left time: 39.6493s
	iters: 200, epoch: 1 | loss: 0.3767673
	speed: 0.0041s/iter; left time: 16.3185s
	iters: 300, epoch: 1 | loss: 0.1723654
	speed: 0.0041s/iter; left time: 15.7554s
	iters: 400, epoch: 1 | loss: 0.1904557
	speed: 0.0037s/iter; left time: 13.8567s
	iters: 500, epoch: 1 | loss: 0.2541685
	speed: 0.0033s/iter; left time: 12.0456s
Updating learning rate to 0.0012678158858745402
Validation loss decreased (inf --> 0.2859).  Saving model state dict ...
Epoch: 1 cost time: 2.2601711750030518
Epoch: 1, Steps: 523 | Train Loss: 0.2407333 Vali Loss: 0.2859212 Best vali loss: 0.2859212
	iters: 100, epoch: 2 | loss: 0.7432281
	speed: 0.0075s/iter; left time: 26.5618s
	iters: 200, epoch: 2 | loss: 0.4592428
	speed: 0.0034s/iter; left time: 11.9301s
	iters: 300, epoch: 2 | loss: 0.3486603
	speed: 0.0036s/iter; left time: 12.1413s
	iters: 400, epoch: 2 | loss: 0.3520043
	speed: 0.0034s/iter; left time: 11.0190s
	iters: 500, epoch: 2 | loss: 0.3286784
	speed: 0.0029s/iter; left time: 9.3066s
Updating learning rate to 0.0011249649780552258
Validation loss decreased (0.2859 --> 0.2843).  Saving model state dict ...
Epoch: 2 cost time: 1.788527488708496
Epoch: 2, Steps: 523 | Train Loss: 0.4463628 Vali Loss: 0.2842858 Best vali loss: 0.2842858
	iters: 100, epoch: 3 | loss: 0.3815728
	speed: 0.0082s/iter; left time: 25.0131s
	iters: 200, epoch: 3 | loss: 0.7129388
	speed: 0.0059s/iter; left time: 17.1937s
	iters: 300, epoch: 3 | loss: 0.4407510
	speed: 0.0058s/iter; left time: 16.4607s
	iters: 400, epoch: 3 | loss: 0.3105524
	speed: 0.0058s/iter; left time: 15.9076s
	iters: 500, epoch: 3 | loss: 0.6383157
	speed: 0.0058s/iter; left time: 15.3529s
Updating learning rate to 0.0009111734862108432
Epoch: 3 cost time: 2.9261791706085205
Epoch: 3, Steps: 523 | Train Loss: 0.4968261 Vali Loss: 0.3034029 Best vali loss: 0.2842858

best validation loss 0.2842857687834161

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0090051442195, 'e_layers': 1, 'learning_rate': 0.0005778764026, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000555882291641696
Validation loss decreased (inf --> 0.2830).  Saving model state dict ...
Epoch: 1 cost time: 0.6083745956420898
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2830431 Best vali loss: 0.2830431
Updating learning rate to 0.0004932483627830737
Epoch: 2 cost time: 0.3253171443939209
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2848481 Best vali loss: 0.2830431
Updating learning rate to 0.00039951006391487925
Epoch: 3 cost time: 0.3744935989379883
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2884276 Best vali loss: 0.2830431

best validation loss 0.28304312314717645

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0094025534782, 'e_layers': 3, 'learning_rate': 7.57956321e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5086208
	speed: 0.0132s/iter; left time: 33.2677s
	iters: 200, epoch: 4 | loss: 0.8476179
	speed: 0.0079s/iter; left time: 18.9721s
	iters: 300, epoch: 4 | loss: 0.3418665
	speed: 0.0079s/iter; left time: 18.2580s
	iters: 400, epoch: 4 | loss: 0.6485002
	speed: 0.0079s/iter; left time: 17.4769s
	iters: 500, epoch: 4 | loss: 0.3402422
	speed: 0.0079s/iter; left time: 16.6664s
Updating learning rate to 3.789781605e-05
Validation loss decreased (0.2776 --> 0.2772).  Saving model state dict ...
Epoch: 4 cost time: 4.329565763473511
Epoch: 4, Steps: 523 | Train Loss: 0.5373695 Vali Loss: 0.2772049 Best vali loss: 0.2772049
	iters: 100, epoch: 5 | loss: 0.6316157
	speed: 0.0147s/iter; left time: 29.2149s
	iters: 200, epoch: 5 | loss: 0.7428264
	speed: 0.0079s/iter; left time: 15.0394s
	iters: 300, epoch: 5 | loss: 0.3860938
	speed: 0.0080s/iter; left time: 14.3737s
	iters: 400, epoch: 5 | loss: 0.2445310
	speed: 0.0080s/iter; left time: 13.5336s
	iters: 500, epoch: 5 | loss: 0.2209203
	speed: 0.0079s/iter; left time: 12.5766s
Updating learning rate to 2.3394949724845215e-05
Epoch: 5 cost time: 4.1197710037231445
Epoch: 5, Steps: 523 | Train Loss: 0.4451974 Vali Loss: 0.2849906 Best vali loss: 0.2772049
	iters: 100, epoch: 6 | loss: 0.4195023
	speed: 0.0138s/iter; left time: 20.3357s
	iters: 200, epoch: 6 | loss: 0.2995445
	speed: 0.0076s/iter; left time: 10.4568s
	iters: 300, epoch: 6 | loss: 0.5720018
	speed: 0.0075s/iter; left time: 9.5539s
	iters: 400, epoch: 6 | loss: 0.2798260
	speed: 0.0073s/iter; left time: 8.5326s
	iters: 500, epoch: 6 | loss: 0.4742074
	speed: 0.0073s/iter; left time: 7.8411s
Updating learning rate to 1.1100013328884624e-05
Epoch: 6 cost time: 3.813810348510742
Epoch: 6, Steps: 523 | Train Loss: 0.4090164 Vali Loss: 0.2903231 Best vali loss: 0.2772049
	iters: 100, epoch: 7 | loss: 0.2396696
	speed: 0.0139s/iter; left time: 13.1653s
	iters: 200, epoch: 7 | loss: 0.3057646
	speed: 0.0040s/iter; left time: 3.3542s
	iters: 300, epoch: 7 | loss: 0.4673315
	speed: 0.0040s/iter; left time: 2.9582s
	iters: 400, epoch: 7 | loss: 0.2188293
	speed: 0.0047s/iter; left time: 3.0375s
	iters: 500, epoch: 7 | loss: 0.3534105
	speed: 0.0051s/iter; left time: 2.7742s
Updating learning rate to 2.8847994745272605e-06
Epoch: 7 cost time: 2.4722485542297363
Epoch: 7, Steps: 523 | Train Loss: 0.3170011 Vali Loss: 0.2933416 Best vali loss: 0.2772049
	iters: 100, epoch: 8 | loss: 0.4615344
	speed: 0.0117s/iter; left time: 4.9650s
	iters: 200, epoch: 8 | loss: 0.1688914
	speed: 0.0053s/iter; left time: 1.7045s
	iters: 300, epoch: 8 | loss: 0.2642818
	speed: 0.0051s/iter; left time: 1.1448s
	iters: 400, epoch: 8 | loss: 0.2745432
	speed: 0.0052s/iter; left time: 0.6457s
	iters: 500, epoch: 8 | loss: 0.2869707
	speed: 0.0054s/iter; left time: 0.1306s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.782681941986084
Epoch: 8, Steps: 523 | Train Loss: 0.2912443 Vali Loss: 0.2924847 Best vali loss: 0.2772049

best validation loss 0.2772049449797056

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0035713197255, 'e_layers': 2, 'learning_rate': 0.0033793788609, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0032507589115434083
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 0.641261100769043
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2867259 Best vali loss: 0.2867259
Updating learning rate to 0.00288448028482043
Epoch: 2 cost time: 0.4634437561035156
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3065494 Best vali loss: 0.2867259
Updating learning rate to 0.0023363055813256195
Epoch: 3 cost time: 0.41603708267211914
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2900468 Best vali loss: 0.2867259
Updating learning rate to 0.00168968943045
Epoch: 4 cost time: 0.48822021484375
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2952743 Best vali loss: 0.2867259
Updating learning rate to 0.0010430732795743804
Epoch: 5 cost time: 0.44211554527282715
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2942318 Best vali loss: 0.2867259
Updating learning rate to 0.0004948985760795698
Epoch: 6 cost time: 0.48561954498291016
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3018234 Best vali loss: 0.2867259
Updating learning rate to 0.00012861994935659164
Epoch: 7 cost time: 0.40645527839660645
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3054392 Best vali loss: 0.2867259
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4331936836242676
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3021997 Best vali loss: 0.2867259

best validation loss 0.2867259493588781

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.001716146484, 'e_layers': 4, 'learning_rate': 9.46281852e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3191647
	speed: 0.0144s/iter; left time: 118.9430s
	iters: 200, epoch: 1 | loss: 0.2810917
	speed: 0.0078s/iter; left time: 63.3058s
	iters: 300, epoch: 1 | loss: 0.5857177
	speed: 0.0072s/iter; left time: 58.1316s
	iters: 400, epoch: 1 | loss: 0.3197039
	speed: 0.0075s/iter; left time: 59.8726s
	iters: 500, epoch: 1 | loss: 1.1183698
	speed: 0.0091s/iter; left time: 71.1567s
	iters: 600, epoch: 1 | loss: 0.2451861
	speed: 0.0090s/iter; left time: 70.0726s
	iters: 700, epoch: 1 | loss: 0.4196751
	speed: 0.0086s/iter; left time: 66.0061s
	iters: 800, epoch: 1 | loss: 0.6647602
	speed: 0.0086s/iter; left time: 65.2788s
	iters: 900, epoch: 1 | loss: 0.3928972
	speed: 0.0086s/iter; left time: 64.4400s
	iters: 1000, epoch: 1 | loss: 0.3190090
	speed: 0.0086s/iter; left time: 63.6116s
Updating learning rate to 9.46281852e-05
Validation loss decreased (inf --> 0.2779).  Saving model state dict ...
Epoch: 1 cost time: 9.066041707992554
Epoch: 1, Steps: 1045 | Train Loss: 0.4665576 Vali Loss: 0.2778583 Best vali loss: 0.2778583
	iters: 100, epoch: 2 | loss: 0.1673609
	speed: 0.0260s/iter; left time: 187.7900s
	iters: 200, epoch: 2 | loss: 0.1731138
	speed: 0.0080s/iter; left time: 56.6837s
	iters: 300, epoch: 2 | loss: 0.2892720
	speed: 0.0071s/iter; left time: 49.6289s
	iters: 400, epoch: 2 | loss: 0.6121812
	speed: 0.0075s/iter; left time: 51.6836s
	iters: 500, epoch: 2 | loss: 0.1689040
	speed: 0.0089s/iter; left time: 60.3663s
	iters: 600, epoch: 2 | loss: 0.2239888
	speed: 0.0086s/iter; left time: 57.7990s
	iters: 700, epoch: 2 | loss: 0.4446513
	speed: 0.0085s/iter; left time: 56.3671s
	iters: 800, epoch: 2 | loss: 0.7484916
	speed: 0.0085s/iter; left time: 55.5112s
	iters: 900, epoch: 2 | loss: 0.6055122
	speed: 0.0085s/iter; left time: 54.6738s
	iters: 1000, epoch: 2 | loss: 0.3293659
	speed: 0.0085s/iter; left time: 53.7491s
Updating learning rate to 4.73140926e-05
Epoch: 2 cost time: 8.680030822753906
Epoch: 2, Steps: 1045 | Train Loss: 0.3762842 Vali Loss: 0.2937911 Best vali loss: 0.2778583
	iters: 100, epoch: 3 | loss: 0.3113853
	speed: 0.0264s/iter; left time: 162.8072s
	iters: 200, epoch: 3 | loss: 0.2244589
	speed: 0.0081s/iter; left time: 49.1706s
	iters: 300, epoch: 3 | loss: 0.3605503
	speed: 0.0074s/iter; left time: 44.0097s
	iters: 400, epoch: 3 | loss: 0.3923234
	speed: 0.0076s/iter; left time: 44.6792s
	iters: 500, epoch: 3 | loss: 0.3867350
	speed: 0.0086s/iter; left time: 49.8425s
	iters: 600, epoch: 3 | loss: 0.3544063
	speed: 0.0086s/iter; left time: 48.9575s
	iters: 700, epoch: 3 | loss: 0.8657495
	speed: 0.0086s/iter; left time: 48.0707s
	iters: 800, epoch: 3 | loss: 0.5473759
	speed: 0.0086s/iter; left time: 47.0008s
	iters: 900, epoch: 3 | loss: 0.5244265
	speed: 0.0086s/iter; left time: 46.1755s
	iters: 1000, epoch: 3 | loss: 0.8359789
	speed: 0.0086s/iter; left time: 45.2115s
Updating learning rate to 2.36570463e-05
Epoch: 3 cost time: 8.78861665725708
Epoch: 3, Steps: 1045 | Train Loss: 0.4803390 Vali Loss: 0.2788835 Best vali loss: 0.2778583
	iters: 100, epoch: 4 | loss: 0.1654424
	speed: 0.0258s/iter; left time: 132.0433s
	iters: 200, epoch: 4 | loss: 0.5142416
	speed: 0.0086s/iter; left time: 43.2482s
	iters: 300, epoch: 4 | loss: 0.4975388
	speed: 0.0072s/iter; left time: 35.6506s
	iters: 400, epoch: 4 | loss: 0.7399272
	speed: 0.0074s/iter; left time: 35.6150s
	iters: 500, epoch: 4 | loss: 0.4620905
	speed: 0.0085s/iter; left time: 40.3931s
	iters: 600, epoch: 4 | loss: 0.4100360
	speed: 0.0086s/iter; left time: 39.5910s
	iters: 700, epoch: 4 | loss: 0.2373553
	speed: 0.0086s/iter; left time: 38.7141s
	iters: 800, epoch: 4 | loss: 0.1708032
	speed: 0.0085s/iter; left time: 37.8008s
	iters: 900, epoch: 4 | loss: 0.2394954
	speed: 0.0085s/iter; left time: 36.9164s
	iters: 1000, epoch: 4 | loss: 0.2376802
	speed: 0.0085s/iter; left time: 36.0323s
Updating learning rate to 1.182852315e-05
Epoch: 4 cost time: 8.74179744720459
Epoch: 4, Steps: 1045 | Train Loss: 0.3674611 Vali Loss: 0.3033836 Best vali loss: 0.2778583
	iters: 100, epoch: 5 | loss: 0.2270191
	speed: 0.0268s/iter; left time: 109.4612s
	iters: 200, epoch: 5 | loss: 0.5885763
	speed: 0.0080s/iter; left time: 31.7531s
	iters: 300, epoch: 5 | loss: 0.2599748
	speed: 0.0070s/iter; left time: 27.0176s
	iters: 400, epoch: 5 | loss: 0.2379145
	speed: 0.0070s/iter; left time: 26.5963s
	iters: 500, epoch: 5 | loss: 0.4297578
	speed: 0.0086s/iter; left time: 31.5693s
	iters: 600, epoch: 5 | loss: 0.6628355
	speed: 0.0086s/iter; left time: 30.6243s
	iters: 700, epoch: 5 | loss: 0.3525635
	speed: 0.0086s/iter; left time: 29.7639s
	iters: 800, epoch: 5 | loss: 0.3615241
	speed: 0.0086s/iter; left time: 28.9151s
	iters: 900, epoch: 5 | loss: 0.2188241
	speed: 0.0086s/iter; left time: 28.0653s
	iters: 1000, epoch: 5 | loss: 0.4918250
	speed: 0.0085s/iter; left time: 27.1853s
Updating learning rate to 5.914261575e-06
Epoch: 5 cost time: 8.610684633255005
Epoch: 5, Steps: 1045 | Train Loss: 0.3830815 Vali Loss: 0.2979220 Best vali loss: 0.2778583
	iters: 100, epoch: 6 | loss: 0.3237491
	speed: 0.0259s/iter; left time: 78.7553s
	iters: 200, epoch: 6 | loss: 0.2721905
	speed: 0.0082s/iter; left time: 23.9763s
	iters: 300, epoch: 6 | loss: 0.3358154
	speed: 0.0068s/iter; left time: 19.3148s
	iters: 400, epoch: 6 | loss: 0.5688105
	speed: 0.0068s/iter; left time: 18.6123s
	iters: 500, epoch: 6 | loss: 0.1165128
	speed: 0.0069s/iter; left time: 18.1718s
	iters: 600, epoch: 6 | loss: 0.3484166
	speed: 0.0047s/iter; left time: 11.8886s
	iters: 700, epoch: 6 | loss: 0.7386372
	speed: 0.0048s/iter; left time: 11.7613s
	iters: 800, epoch: 6 | loss: 0.4606184
	speed: 0.0048s/iter; left time: 11.1304s
	iters: 900, epoch: 6 | loss: 0.3162197
	speed: 0.0060s/iter; left time: 13.3523s
	iters: 1000, epoch: 6 | loss: 0.1482404
	speed: 0.0073s/iter; left time: 15.5635s
Updating learning rate to 2.9571307875e-06
Epoch: 6 cost time: 6.854557275772095
Epoch: 6, Steps: 1045 | Train Loss: 0.3629211 Vali Loss: 0.3076478 Best vali loss: 0.2778583
	iters: 100, epoch: 7 | loss: 0.2907450
	speed: 0.0217s/iter; left time: 43.2676s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019016322338, 'e_layers': 3, 'learning_rate': 0.0002203212483, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2716539
	speed: 0.0110s/iter; left time: 90.8234s
	iters: 200, epoch: 1 | loss: 0.5333134
	speed: 0.0053s/iter; left time: 42.8614s
	iters: 300, epoch: 1 | loss: 0.3111216
	speed: 0.0054s/iter; left time: 43.1905s
	iters: 400, epoch: 1 | loss: 0.5663164
	speed: 0.0060s/iter; left time: 47.9794s
	iters: 500, epoch: 1 | loss: 0.6127292
	speed: 0.0060s/iter; left time: 46.8953s
	iters: 600, epoch: 1 | loss: 0.3048978
	speed: 0.0058s/iter; left time: 45.1620s
	iters: 700, epoch: 1 | loss: 1.2643360
	speed: 0.0058s/iter; left time: 44.1567s
	iters: 800, epoch: 1 | loss: 0.3611633
	speed: 0.0060s/iter; left time: 45.1943s
	iters: 900, epoch: 1 | loss: 0.2294260
	speed: 0.0060s/iter; left time: 44.7728s
	iters: 1000, epoch: 1 | loss: 0.2196148
	speed: 0.0060s/iter; left time: 44.1687s
Updating learning rate to 0.00021193577009085356
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 6.31214165687561
Epoch: 1, Steps: 1045 | Train Loss: 0.4674572 Vali Loss: 0.2822996 Best vali loss: 0.2822996
	iters: 100, epoch: 2 | loss: 0.2865813
	speed: 0.0187s/iter; left time: 134.8156s
	iters: 200, epoch: 2 | loss: 0.4939444
	speed: 0.0053s/iter; left time: 37.4809s
	iters: 300, epoch: 2 | loss: 0.2676907
	speed: 0.0052s/iter; left time: 36.4641s
	iters: 400, epoch: 2 | loss: 0.4775564
	speed: 0.0062s/iter; left time: 43.0129s
	iters: 500, epoch: 2 | loss: 0.8322837
	speed: 0.0059s/iter; left time: 39.8776s
	iters: 600, epoch: 2 | loss: 0.9479969
	speed: 0.0058s/iter; left time: 39.1593s
	iters: 700, epoch: 2 | loss: 0.6337815
	speed: 0.0059s/iter; left time: 39.0197s
	iters: 800, epoch: 2 | loss: 0.6347401
	speed: 0.0059s/iter; left time: 38.6279s
	iters: 900, epoch: 2 | loss: 0.3994555
	speed: 0.0059s/iter; left time: 37.6743s
	iters: 1000, epoch: 2 | loss: 1.2389594
	speed: 0.0058s/iter; left time: 36.7430s
Updating learning rate to 0.00018805594850620754
Epoch: 2 cost time: 6.083003759384155
Epoch: 2, Steps: 1045 | Train Loss: 0.6212990 Vali Loss: 0.2871596 Best vali loss: 0.2822996
	iters: 100, epoch: 3 | loss: 0.4242859
	speed: 0.0185s/iter; left time: 114.1328s
	iters: 200, epoch: 3 | loss: 0.1210550
	speed: 0.0052s/iter; left time: 31.5595s
	iters: 300, epoch: 3 | loss: 1.1758822
	speed: 0.0049s/iter; left time: 29.3758s
	iters: 400, epoch: 3 | loss: 0.2426370
	speed: 0.0041s/iter; left time: 24.2751s
	iters: 500, epoch: 3 | loss: 1.1735022
	speed: 0.0040s/iter; left time: 22.8624s
	iters: 600, epoch: 3 | loss: 0.3999837
	speed: 0.0061s/iter; left time: 34.8300s
	iters: 700, epoch: 3 | loss: 0.3405623
	speed: 0.0072s/iter; left time: 40.2670s
	iters: 800, epoch: 3 | loss: 0.3459654
	speed: 0.0072s/iter; left time: 39.6088s
	iters: 900, epoch: 3 | loss: 0.1723513
	speed: 0.0072s/iter; left time: 38.8815s
	iters: 1000, epoch: 3 | loss: 0.7269979
	speed: 0.0072s/iter; left time: 38.1001s
Updating learning rate to 0.0001523172699112026
Epoch: 3 cost time: 6.284130096435547
Epoch: 3, Steps: 1045 | Train Loss: 0.5123223 Vali Loss: 0.2986675 Best vali loss: 0.2822996

best validation loss 0.2822995640977513

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011236842427, 'e_layers': 3, 'learning_rate': 0.0014870102392, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6710263
	speed: 0.0148s/iter; left time: 60.4206s
	iters: 200, epoch: 1 | loss: 0.4691266
	speed: 0.0087s/iter; left time: 34.8568s
	iters: 300, epoch: 1 | loss: 0.3659661
	speed: 0.0072s/iter; left time: 27.9873s
	iters: 400, epoch: 1 | loss: 0.2286357
	speed: 0.0059s/iter; left time: 22.5015s
	iters: 500, epoch: 1 | loss: 0.9552001
	speed: 0.0084s/iter; left time: 30.7997s
Updating learning rate to 0.0014304142819157963
Validation loss decreased (inf --> 0.3279).  Saving model state dict ...
Epoch: 1 cost time: 4.436657428741455
Epoch: 1, Steps: 523 | Train Loss: 0.5379910 Vali Loss: 0.3278944 Best vali loss: 0.3278944
	iters: 100, epoch: 2 | loss: 0.6302910
	speed: 0.0192s/iter; left time: 68.4768s
	iters: 200, epoch: 2 | loss: 0.4391760
	speed: 0.0087s/iter; left time: 30.1490s
	iters: 300, epoch: 2 | loss: 1.1338534
	speed: 0.0080s/iter; left time: 26.7287s
	iters: 400, epoch: 2 | loss: 0.2934530
	speed: 0.0064s/iter; left time: 20.7937s
	iters: 500, epoch: 2 | loss: 0.7001110
	speed: 0.0046s/iter; left time: 14.5008s
Updating learning rate to 0.001269242631516075
Validation loss decreased (0.3279 --> 0.3196).  Saving model state dict ...
Epoch: 2 cost time: 3.7695066928863525
Epoch: 2, Steps: 523 | Train Loss: 0.6393769 Vali Loss: 0.3196404 Best vali loss: 0.3196404
	iters: 100, epoch: 3 | loss: 0.3809198
	speed: 0.0113s/iter; left time: 34.4242s
	iters: 200, epoch: 3 | loss: 0.8284867
	speed: 0.0056s/iter; left time: 16.3369s
	iters: 300, epoch: 3 | loss: 0.3788876
	speed: 0.0054s/iter; left time: 15.4096s
	iters: 400, epoch: 3 | loss: 0.8341520
	speed: 0.0053s/iter; left time: 14.5958s
	iters: 500, epoch: 3 | loss: 0.3896581
	speed: 0.0044s/iter; left time: 11.5493s
Updating learning rate to 0.0010280322107495447
Epoch: 3 cost time: 2.789461612701416
Epoch: 3, Steps: 523 | Train Loss: 0.5624208 Vali Loss: 0.3253556 Best vali loss: 0.3196404

best validation loss 0.3196403861777319

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.010197037822, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4449770
	speed: 0.0110s/iter; left time: 10.4265s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.2845).  Saving model state dict ...
Epoch: 1 cost time: 0.9423258304595947
Epoch: 1, Steps: 131 | Train Loss: 0.4449770 Vali Loss: 0.2845249 Best vali loss: 0.2845249
	iters: 100, epoch: 2 | loss: 0.3634977
	speed: 0.0082s/iter; left time: 6.7427s
Updating learning rate to 0.00093122262415
Epoch: 2 cost time: 0.6510226726531982
Epoch: 2, Steps: 131 | Train Loss: 0.3634977 Vali Loss: 0.2862735 Best vali loss: 0.2845249
	iters: 100, epoch: 3 | loss: 0.5460004
	speed: 0.0083s/iter; left time: 5.6845s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.6487131118774414
Epoch: 3, Steps: 131 | Train Loss: 0.5460004 Vali Loss: 0.2973440 Best vali loss: 0.2845249

best validation loss 0.2845248881327082

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019016322338, 'e_layers': 3, 'learning_rate': 0.0002203212483, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2432047
	speed: 0.0109s/iter; left time: 55.7794s
	iters: 200, epoch: 4 | loss: 0.5213784
	speed: 0.0053s/iter; left time: 26.7031s
	iters: 300, epoch: 4 | loss: 0.2324042
	speed: 0.0053s/iter; left time: 26.1885s
	iters: 400, epoch: 4 | loss: 0.3928058
	speed: 0.0052s/iter; left time: 24.8961s
	iters: 500, epoch: 4 | loss: 0.4551960
	speed: 0.0051s/iter; left time: 24.2277s
	iters: 600, epoch: 4 | loss: 0.2214708
	speed: 0.0047s/iter; left time: 21.7147s
	iters: 700, epoch: 4 | loss: 0.8259817
	speed: 0.0050s/iter; left time: 22.4154s
	iters: 800, epoch: 4 | loss: 0.2634040
	speed: 0.0052s/iter; left time: 22.9551s
	iters: 900, epoch: 4 | loss: 0.2021265
	speed: 0.0050s/iter; left time: 21.8279s
	iters: 1000, epoch: 4 | loss: 0.1689512
	speed: 0.0051s/iter; left time: 21.3584s
Updating learning rate to 0.00011016062415
Epoch: 4 cost time: 5.603041172027588
Epoch: 4, Steps: 1045 | Train Loss: 0.3526923 Vali Loss: 0.2875638 Best vali loss: 0.2822996
	iters: 100, epoch: 5 | loss: 0.2564021
	speed: 0.0157s/iter; left time: 64.0387s
	iters: 200, epoch: 5 | loss: 0.2783844
	speed: 0.0052s/iter; left time: 20.5453s
	iters: 300, epoch: 5 | loss: 0.2655070
	speed: 0.0052s/iter; left time: 20.1031s
	iters: 400, epoch: 5 | loss: 0.3142785
	speed: 0.0052s/iter; left time: 19.5099s
	iters: 500, epoch: 5 | loss: 0.3196687
	speed: 0.0051s/iter; left time: 18.8088s
	iters: 600, epoch: 5 | loss: 0.5313463
	speed: 0.0050s/iter; left time: 17.8567s
	iters: 700, epoch: 5 | loss: 0.4139341
	speed: 0.0051s/iter; left time: 17.7856s
	iters: 800, epoch: 5 | loss: 0.2953261
	speed: 0.0052s/iter; left time: 17.7047s
	iters: 900, epoch: 5 | loss: 0.3237424
	speed: 0.0053s/iter; left time: 17.2804s
	iters: 1000, epoch: 5 | loss: 0.6612291
	speed: 0.0053s/iter; left time: 16.7256s
Updating learning rate to 6.800397838879741e-05
Epoch: 5 cost time: 5.433910369873047
Epoch: 5, Steps: 1045 | Train Loss: 0.3659819 Vali Loss: 0.3009408 Best vali loss: 0.2822996
	iters: 100, epoch: 6 | loss: 0.2812940
	speed: 0.0165s/iter; left time: 50.2313s
	iters: 200, epoch: 6 | loss: 0.1322858
	speed: 0.0056s/iter; left time: 16.3117s
	iters: 300, epoch: 6 | loss: 0.6898305
	speed: 0.0056s/iter; left time: 15.9077s
	iters: 400, epoch: 6 | loss: 0.1934573
	speed: 0.0055s/iter; left time: 15.1767s
	iters: 500, epoch: 6 | loss: 0.7257954
	speed: 0.0053s/iter; left time: 14.0888s
	iters: 600, epoch: 6 | loss: 0.3481201
	speed: 0.0051s/iter; left time: 12.9281s
	iters: 700, epoch: 6 | loss: 0.2612646
	speed: 0.0054s/iter; left time: 13.1744s
	iters: 800, epoch: 6 | loss: 0.2294376
	speed: 0.0055s/iter; left time: 12.7825s
	iters: 900, epoch: 6 | loss: 0.1556843
	speed: 0.0056s/iter; left time: 12.4901s
	iters: 1000, epoch: 6 | loss: 0.4826364
	speed: 0.0055s/iter; left time: 11.7782s
Updating learning rate to 3.2265299793792456e-05
Epoch: 6 cost time: 5.745934009552002
Epoch: 6, Steps: 1045 | Train Loss: 0.3499806 Vali Loss: 0.3203971 Best vali loss: 0.2822996
	iters: 100, epoch: 7 | loss: 0.5739464
	speed: 0.0161s/iter; left time: 31.9662s
	iters: 200, epoch: 7 | loss: 0.3179116
	speed: 0.0051s/iter; left time: 9.7291s
	iters: 300, epoch: 7 | loss: 0.1796321
	speed: 0.0052s/iter; left time: 9.3735s
	iters: 400, epoch: 7 | loss: 0.2137216
	speed: 0.0052s/iter; left time: 8.8493s
	iters: 500, epoch: 7 | loss: 0.6681047
	speed: 0.0048s/iter; left time: 7.5938s
	iters: 600, epoch: 7 | loss: 0.1269479
	speed: 0.0048s/iter; left time: 7.2129s
	iters: 700, epoch: 7 | loss: 0.4267514
	speed: 0.0052s/iter; left time: 7.2345s
	iters: 800, epoch: 7 | loss: 0.2331202
	speed: 0.0052s/iter; left time: 6.7417s
	iters: 900, epoch: 7 | loss: 0.2751953
	speed: 0.0052s/iter; left time: 6.2441s
	iters: 1000, epoch: 7 | loss: 0.1381818
	speed: 0.0053s/iter; left time: 5.7303s
Updating learning rate to 8.385478209146436e-06
Epoch: 7 cost time: 5.4085693359375
Epoch: 7, Steps: 1045 | Train Loss: 0.3153513 Vali Loss: 0.3228006 Best vali loss: 0.2822996
	iters: 100, epoch: 8 | loss: 0.2373118
	speed: 0.0135s/iter; left time: 12.8079s
	iters: 200, epoch: 8 | loss: 0.7617954
	speed: 0.0045s/iter; left time: 3.7994s
	iters: 300, epoch: 8 | loss: 0.2534206
	speed: 0.0051s/iter; left time: 3.8243s
	iters: 400, epoch: 8 | loss: 0.1580268
	speed: 0.0055s/iter; left time: 3.5245s
	iters: 500, epoch: 8 | loss: 0.2295996
	speed: 0.0054s/iter; left time: 2.9611s
	iters: 600, epoch: 8 | loss: 0.1901549
	speed: 0.0054s/iter; left time: 2.4153s
	iters: 700, epoch: 8 | loss: 0.2502376
	speed: 0.0054s/iter; left time: 1.8545s
	iters: 800, epoch: 8 | loss: 0.1089721
	speed: 0.0055s/iter; left time: 1.3518s
	iters: 900, epoch: 8 | loss: 0.1181998
	speed: 0.0054s/iter; left time: 0.7846s
	iters: 1000, epoch: 8 | loss: 0.2259611
	speed: 0.0053s/iter; left time: 0.2417s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.4071900844573975
Epoch: 8, Steps: 1045 | Train Loss: 0.2533680 Vali Loss: 0.3278490 Best vali loss: 0.2822996

best validation loss 0.2822995640977513

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0033733476764, 'e_layers': 2, 'learning_rate': 0.0015215628629, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9336885
	speed: 0.0090s/iter; left time: 36.8175s
	iters: 200, epoch: 1 | loss: 0.4371953
	speed: 0.0036s/iter; left time: 14.4809s
	iters: 300, epoch: 1 | loss: 0.3867459
	speed: 0.0034s/iter; left time: 13.2969s
	iters: 400, epoch: 1 | loss: 0.7060689
	speed: 0.0038s/iter; left time: 14.3923s
	iters: 500, epoch: 1 | loss: 0.6080787
	speed: 0.0042s/iter; left time: 15.3583s
Updating learning rate to 0.0015215628629
Validation loss decreased (inf --> 0.2918).  Saving model state dict ...
Epoch: 1 cost time: 2.2399849891662598
Epoch: 1, Steps: 523 | Train Loss: 0.6143555 Vali Loss: 0.2918495 Best vali loss: 0.2918495
	iters: 100, epoch: 2 | loss: 0.3152440
	speed: 0.0093s/iter; left time: 33.2452s
	iters: 200, epoch: 2 | loss: 1.1812148
	speed: 0.0039s/iter; left time: 13.3890s
	iters: 300, epoch: 2 | loss: 0.6574585
	speed: 0.0039s/iter; left time: 12.9636s
	iters: 400, epoch: 2 | loss: 0.4289756
	speed: 0.0040s/iter; left time: 13.0033s
	iters: 500, epoch: 2 | loss: 0.3513132
	speed: 0.0041s/iter; left time: 12.8949s
Updating learning rate to 0.00076078143145
Validation loss decreased (0.2918 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 2.0959603786468506
Epoch: 2, Steps: 523 | Train Loss: 0.5868412 Vali Loss: 0.2824679 Best vali loss: 0.2824679
	iters: 100, epoch: 3 | loss: 0.4260879
	speed: 0.0095s/iter; left time: 28.9221s
	iters: 200, epoch: 3 | loss: 0.3904004
	speed: 0.0044s/iter; left time: 12.9556s
	iters: 300, epoch: 3 | loss: 0.3679632
	speed: 0.0045s/iter; left time: 12.6851s
	iters: 400, epoch: 3 | loss: 0.4711338
	speed: 0.0041s/iter; left time: 11.3657s
	iters: 500, epoch: 3 | loss: 0.4932616
	speed: 0.0038s/iter; left time: 10.0344s
Updating learning rate to 0.000380390715725
Epoch: 3 cost time: 2.2402257919311523
Epoch: 3, Steps: 523 | Train Loss: 0.4297694 Vali Loss: 0.2877560 Best vali loss: 0.2824679
	iters: 100, epoch: 4 | loss: 0.2363085
	speed: 0.0086s/iter; left time: 21.7178s
	iters: 200, epoch: 4 | loss: 0.5260255
	speed: 0.0036s/iter; left time: 8.5813s
	iters: 300, epoch: 4 | loss: 0.4492943
	speed: 0.0041s/iter; left time: 9.4575s
	iters: 400, epoch: 4 | loss: 0.4774942
	speed: 0.0042s/iter; left time: 9.2571s
	iters: 500, epoch: 4 | loss: 0.5141196
	speed: 0.0043s/iter; left time: 9.0097s
Updating learning rate to 0.0001901953578625
Epoch: 4 cost time: 2.0983519554138184
Epoch: 4, Steps: 523 | Train Loss: 0.4406484 Vali Loss: 0.2894592 Best vali loss: 0.2824679
	iters: 100, epoch: 5 | loss: 0.5328165
	speed: 0.0093s/iter; left time: 18.5588s
	iters: 200, epoch: 5 | loss: 0.4852441
	speed: 0.0040s/iter; left time: 7.5247s
	iters: 300, epoch: 5 | loss: 0.4940526
	speed: 0.0040s/iter; left time: 7.1616s
	iters: 400, epoch: 5 | loss: 1.2794731
	speed: 0.0040s/iter; left time: 6.8518s
	iters: 500, epoch: 5 | loss: 0.2668543
	speed: 0.0041s/iter; left time: 6.4771s
Updating learning rate to 9.509767893125e-05
Epoch: 5 cost time: 2.1450929641723633
Epoch: 5, Steps: 523 | Train Loss: 0.6116881 Vali Loss: 0.2906647 Best vali loss: 0.2824679
	iters: 100, epoch: 6 | loss: 0.3163152
	speed: 0.0100s/iter; left time: 14.7065s
	iters: 200, epoch: 6 | loss: 0.5368698
	speed: 0.0043s/iter; left time: 5.9263s
	iters: 300, epoch: 6 | loss: 0.2490730
	speed: 0.0041s/iter; left time: 5.2342s
	iters: 400, epoch: 6 | loss: 0.2614763
	speed: 0.0041s/iter; left time: 4.8064s
	iters: 500, epoch: 6 | loss: 0.2906131
	speed: 0.0042s/iter; left time: 4.4650s
Updating learning rate to 4.7548839465625e-05
Epoch: 6 cost time: 2.263132333755493
Epoch: 6, Steps: 523 | Train Loss: 0.3308695 Vali Loss: 0.2911825 Best vali loss: 0.2824679
	iters: 100, epoch: 7 | loss: 0.4593906
	speed: 0.0090s/iter; left time: 8.5481s
	iters: 200, epoch: 7 | loss: 0.7055877
	speed: 0.0039s/iter; left time: 3.2697s
	iters: 300, epoch: 7 | loss: 0.6520248
	speed: 0.0041s/iter; left time: 3.0928s
	iters: 400, epoch: 7 | loss: 0.7452564
	speed: 0.0042s/iter; left time: 2.7318s
	iters: 500, epoch: 7 | loss: 0.4669657
	speed: 0.0041s/iter; left time: 2.2595s
Updating learning rate to 2.37744197328125e-05
Epoch: 7 cost time: 2.159716844558716
Epoch: 7, Steps: 523 | Train Loss: 0.6058450 Vali Loss: 0.2934045 Best vali loss: 0.2824679
	iters: 100, epoch: 8 | loss: 0.4485883
	speed: 0.0094s/iter; left time: 4.0003s
	iters: 200, epoch: 8 | loss: 0.2575991
	speed: 0.0042s/iter; left time: 1.3568s
	iters: 300, epoch: 8 | loss: 0.2918572
	speed: 0.0041s/iter; left time: 0.9217s
	iters: 400, epoch: 8 | loss: 0.3661059
	speed: 0.0041s/iter; left time: 0.5087s
	iters: 500, epoch: 8 | loss: 0.2527674
	speed: 0.0042s/iter; left time: 0.1005s
Updating learning rate to 1.188720986640625e-05
Epoch: 8 cost time: 2.205359935760498
Epoch: 8, Steps: 523 | Train Loss: 0.3233836 Vali Loss: 0.2929582 Best vali loss: 0.2824679

best validation loss 0.2824679375991541

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0055598166579, 'e_layers': 4, 'learning_rate': 0.0001468646066, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7590264
	speed: 0.0119s/iter; left time: 97.8962s
	iters: 200, epoch: 1 | loss: 0.3385119
	speed: 0.0062s/iter; left time: 50.8786s
	iters: 300, epoch: 1 | loss: 1.0003836
	speed: 0.0059s/iter; left time: 47.4921s
	iters: 400, epoch: 1 | loss: 0.5424988
	speed: 0.0059s/iter; left time: 46.6990s
	iters: 500, epoch: 1 | loss: 1.4068172
	speed: 0.0064s/iter; left time: 50.0541s
	iters: 600, epoch: 1 | loss: 0.4918239
	speed: 0.0064s/iter; left time: 49.5765s
	iters: 700, epoch: 1 | loss: 0.3802584
	speed: 0.0063s/iter; left time: 48.5479s
	iters: 800, epoch: 1 | loss: 0.5600526
	speed: 0.0064s/iter; left time: 48.1624s
	iters: 900, epoch: 1 | loss: 0.2787619
	speed: 0.0063s/iter; left time: 47.2958s
	iters: 1000, epoch: 1 | loss: 1.2418933
	speed: 0.0064s/iter; left time: 46.7963s
Updating learning rate to 0.00014127490534403102
Validation loss decreased (inf --> 0.2842).  Saving model state dict ...
Epoch: 1 cost time: 6.828740119934082
Epoch: 1, Steps: 1045 | Train Loss: 0.7000028 Vali Loss: 0.2842393 Best vali loss: 0.2842393
	iters: 100, epoch: 2 | loss: 0.6528497
	speed: 0.0195s/iter; left time: 140.9273s
	iters: 200, epoch: 2 | loss: 0.3550277
	speed: 0.0064s/iter; left time: 45.5512s
	iters: 300, epoch: 2 | loss: 0.3292221
	speed: 0.0061s/iter; left time: 42.9076s
	iters: 400, epoch: 2 | loss: 0.3455924
	speed: 0.0061s/iter; left time: 41.8957s
	iters: 500, epoch: 2 | loss: 0.2251421
	speed: 0.0064s/iter; left time: 43.6428s
	iters: 600, epoch: 2 | loss: 0.6627288
	speed: 0.0064s/iter; left time: 43.0591s
	iters: 700, epoch: 2 | loss: 0.7065866
	speed: 0.0064s/iter; left time: 42.4743s
	iters: 800, epoch: 2 | loss: 0.7572642
	speed: 0.0063s/iter; left time: 41.2632s
	iters: 900, epoch: 2 | loss: 0.7556049
	speed: 0.0063s/iter; left time: 40.6994s
	iters: 1000, epoch: 2 | loss: 0.4445300
	speed: 0.0065s/iter; left time: 40.9296s
Updating learning rate to 0.00012535678292157728
Validation loss decreased (0.2842 --> 0.2838).  Saving model state dict ...
Epoch: 2 cost time: 6.65327262878418
Epoch: 2, Steps: 1045 | Train Loss: 0.5234549 Vali Loss: 0.2838370 Best vali loss: 0.2838370
	iters: 100, epoch: 3 | loss: 0.2789042
	speed: 0.0192s/iter; left time: 118.5209s
	iters: 200, epoch: 3 | loss: 0.3442324
	speed: 0.0061s/iter; left time: 37.1848s
	iters: 300, epoch: 3 | loss: 0.4701525
	speed: 0.0060s/iter; left time: 35.9743s
	iters: 400, epoch: 3 | loss: 0.4778551
	speed: 0.0062s/iter; left time: 36.5773s
	iters: 500, epoch: 3 | loss: 0.4122415
	speed: 0.0064s/iter; left time: 37.1456s
	iters: 600, epoch: 3 | loss: 0.7672470
	speed: 0.0065s/iter; left time: 36.7132s
	iters: 700, epoch: 3 | loss: 0.2041417
	speed: 0.0065s/iter; left time: 36.0112s
	iters: 800, epoch: 3 | loss: 0.2725192
	speed: 0.0064s/iter; left time: 34.8680s
	iters: 900, epoch: 3 | loss: 0.3910754
	speed: 0.0063s/iter; left time: 34.0045s
	iters: 1000, epoch: 3 | loss: 0.6222666
	speed: 0.0064s/iter; left time: 33.5983s
Updating learning rate to 0.00010153362917331831
Validation loss decreased (0.2838 --> 0.2835).  Saving model state dict ...
Epoch: 3 cost time: 6.642631530761719
Epoch: 3, Steps: 1045 | Train Loss: 0.4240636 Vali Loss: 0.2835130 Best vali loss: 0.2835130
	iters: 100, epoch: 4 | loss: 0.9674717
	speed: 0.0189s/iter; left time: 97.0809s
	iters: 200, epoch: 4 | loss: 0.3130695
	speed: 0.0061s/iter; left time: 30.8562s
	iters: 300, epoch: 4 | loss: 0.3281900
	speed: 0.0060s/iter; left time: 29.3960s
	iters: 400, epoch: 4 | loss: 1.1844606
	speed: 0.0061s/iter; left time: 29.4503s
	iters: 500, epoch: 4 | loss: 0.1760510
	speed: 0.0064s/iter; left time: 30.2450s
	iters: 600, epoch: 4 | loss: 0.8911949
	speed: 0.0064s/iter; left time: 29.8033s
	iters: 700, epoch: 4 | loss: 0.3712125
	speed: 0.0063s/iter; left time: 28.6967s
	iters: 800, epoch: 4 | loss: 0.3744574
	speed: 0.0064s/iter; left time: 28.2895s
	iters: 900, epoch: 4 | loss: 0.2862467
	speed: 0.0064s/iter; left time: 27.6126s
	iters: 1000, epoch: 4 | loss: 0.5779215
	speed: 0.0064s/iter; left time: 27.0112s
Updating learning rate to 7.34323033e-05
Epoch: 4 cost time: 6.626298666000366
Epoch: 4, Steps: 1045 | Train Loss: 0.5470276 Vali Loss: 0.2839480 Best vali loss: 0.2835130
	iters: 100, epoch: 5 | loss: 0.7275424
	speed: 0.0192s/iter; left time: 78.4365s
	iters: 200, epoch: 5 | loss: 0.3988543
	speed: 0.0060s/iter; left time: 23.9373s
	iters: 300, epoch: 5 | loss: 0.3780954
	speed: 0.0048s/iter; left time: 18.7952s
	iters: 400, epoch: 5 | loss: 0.2866997
	speed: 0.0051s/iter; left time: 19.3687s
	iters: 500, epoch: 5 | loss: 0.7203611
	speed: 0.0067s/iter; left time: 24.6233s
	iters: 600, epoch: 5 | loss: 0.2689396
	speed: 0.0067s/iter; left time: 24.0336s
	iters: 700, epoch: 5 | loss: 0.2622576
	speed: 0.0066s/iter; left time: 22.8898s
	iters: 800, epoch: 5 | loss: 0.1587953
	speed: 0.0066s/iter; left time: 22.2246s
	iters: 900, epoch: 5 | loss: 0.5696287
	speed: 0.0059s/iter; left time: 19.4028s
	iters: 1000, epoch: 5 | loss: 0.5638400
	speed: 0.0065s/iter; left time: 20.7661s
Updating learning rate to 4.5330977426681694e-05
Epoch: 5 cost time: 6.464571714401245
Epoch: 5, Steps: 1045 | Train Loss: 0.4335014 Vali Loss: 0.2847630 Best vali loss: 0.2835130
	iters: 100, epoch: 6 | loss: 1.1345870
	speed: 0.0213s/iter; left time: 64.5695s
	iters: 200, epoch: 6 | loss: 0.4009358
	speed: 0.0062s/iter; left time: 18.1095s
	iters: 300, epoch: 6 | loss: 0.5703050
	speed: 0.0071s/iter; left time: 20.0471s
	iters: 400, epoch: 6 | loss: 0.1931043
	speed: 0.0071s/iter; left time: 19.4715s
	iters: 500, epoch: 6 | loss: 0.2859760
	speed: 0.0070s/iter; left time: 18.4252s
	iters: 600, epoch: 6 | loss: 0.3223788
	speed: 0.0065s/iter; left time: 16.3979s
	iters: 700, epoch: 6 | loss: 0.5194692
	speed: 0.0053s/iter; left time: 12.8217s
	iters: 800, epoch: 6 | loss: 0.4510272
	speed: 0.0049s/iter; left time: 11.3895s
	iters: 900, epoch: 6 | loss: 0.4230329
	speed: 0.0064s/iter; left time: 14.3866s
	iters: 1000, epoch: 6 | loss: 0.1800450
	speed: 0.0059s/iter; left time: 12.5611s
Updating learning rate to 2.150782367842271e-05
Epoch: 6 cost time: 6.599138021469116
Epoch: 6, Steps: 1045 | Train Loss: 0.4480861 Vali Loss: 0.2855087 Best vali loss: 0.2835130
	iters: 100, epoch: 7 | loss: 0.2004922
	speed: 0.0180s/iter; left time: 35.9158s
	iters: 200, epoch: 7 | loss: 0.2162317
	speed: 0.0057s/iter; left time: 10.7652s
	iters: 300, epoch: 7 | loss: 0.4671181
	speed: 0.0064s/iter; left time: 11.3840s
	iters: 400, epoch: 7 | loss: 0.7016317
	speed: 0.0063s/iter; left time: 10.5746s
	iters: 500, epoch: 7 | loss: 0.3258602
	speed: 0.0063s/iter; left time: 9.9779s
	iters: 600, epoch: 7 | loss: 0.2375794
	speed: 0.0062s/iter; left time: 9.3148s
	iters: 700, epoch: 7 | loss: 0.2869073
	speed: 0.0063s/iter; left time: 8.6946s
	iters: 800, epoch: 7 | loss: 0.4800262
	speed: 0.0061s/iter; left time: 7.9316s
	iters: 900, epoch: 7 | loss: 0.4347860
	speed: 0.0061s/iter; left time: 7.3004s
	iters: 1000, epoch: 7 | loss: 0.3776238
	speed: 0.0061s/iter; left time: 6.6348s
Updating learning rate to 5.589701255968981e-06
Epoch: 7 cost time: 6.3932719230651855
Epoch: 7, Steps: 1045 | Train Loss: 0.3728257 Vali Loss: 0.2852211 Best vali loss: 0.2835130
	iters: 100, epoch: 8 | loss: 0.1772031
	speed: 0.0175s/iter; left time: 16.5641s
	iters: 200, epoch: 8 | loss: 0.2436201
	speed: 0.0057s/iter; left time: 4.8627s
	iters: 300, epoch: 8 | loss: 0.3078627
	speed: 0.0059s/iter; left time: 4.3853s
	iters: 400, epoch: 8 | loss: 0.4909187
	speed: 0.0061s/iter; left time: 3.9385s
	iters: 500, epoch: 8 | loss: 0.2732911
	speed: 0.0061s/iter; left time: 3.3170s
	iters: 600, epoch: 8 | loss: 0.5440392
	speed: 0.0061s/iter; left time: 2.7357s
	iters: 700, epoch: 8 | loss: 0.2695703
	speed: 0.0061s/iter; left time: 2.1263s
	iters: 800, epoch: 8 | loss: 0.3675120
	speed: 0.0061s/iter; left time: 1.5061s
	iters: 900, epoch: 8 | loss: 0.2456373
	speed: 0.0060s/iter; left time: 0.8728s
	iters: 1000, epoch: 8 | loss: 0.7556825
	speed: 0.0057s/iter; left time: 0.2626s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021747175015, 'e_layers': 3, 'learning_rate': 0.0045316959995, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3984757
	speed: 0.0112s/iter; left time: 45.5970s
	iters: 200, epoch: 1 | loss: 0.5147183
	speed: 0.0056s/iter; left time: 22.2130s
	iters: 300, epoch: 1 | loss: 0.7997823
	speed: 0.0056s/iter; left time: 21.6467s
	iters: 400, epoch: 1 | loss: 0.4620444
	speed: 0.0055s/iter; left time: 21.0022s
	iters: 500, epoch: 1 | loss: 0.7977443
	speed: 0.0056s/iter; left time: 20.6533s
Updating learning rate to 0.004359218590500664
Validation loss decreased (inf --> 0.3215).  Saving model state dict ...
Epoch: 1 cost time: 3.2112743854522705
Epoch: 1, Steps: 523 | Train Loss: 0.5945530 Vali Loss: 0.3214988 Best vali loss: 0.3214988
	iters: 100, epoch: 2 | loss: 0.6413307
	speed: 0.0118s/iter; left time: 42.1391s
	iters: 200, epoch: 2 | loss: 0.4645820
	speed: 0.0054s/iter; left time: 18.8104s
	iters: 300, epoch: 2 | loss: 0.7612797
	speed: 0.0054s/iter; left time: 18.2312s
	iters: 400, epoch: 2 | loss: 0.9067141
	speed: 0.0048s/iter; left time: 15.5837s
	iters: 500, epoch: 2 | loss: 0.4569941
	speed: 0.0047s/iter; left time: 14.9504s
Updating learning rate to 0.003868044485511199
Epoch: 2 cost time: 2.738767623901367
Epoch: 2, Steps: 523 | Train Loss: 0.6461801 Vali Loss: 0.3220588 Best vali loss: 0.3214988
	iters: 100, epoch: 3 | loss: 0.3559409
	speed: 0.0090s/iter; left time: 27.4086s
	iters: 200, epoch: 3 | loss: 0.6325631
	speed: 0.0056s/iter; left time: 16.3344s
	iters: 300, epoch: 3 | loss: 0.5292989
	speed: 0.0053s/iter; left time: 15.0059s
	iters: 400, epoch: 3 | loss: 1.0131565
	speed: 0.0060s/iter; left time: 16.3941s
	iters: 500, epoch: 3 | loss: 0.4275545
	speed: 0.0051s/iter; left time: 13.5702s
Updating learning rate to 0.003132950489511903
Epoch: 3 cost time: 2.7918012142181396
Epoch: 3, Steps: 523 | Train Loss: 0.5917028 Vali Loss: 0.3255525 Best vali loss: 0.3214988

best validation loss 0.3214988354170974

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.001857404995, 'e_layers': 3, 'learning_rate': 0.0002113522207, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5817392
	speed: 0.0126s/iter; left time: 11.9268s
Updating learning rate to 0.0002113522207
Validation loss decreased (inf --> 0.2804).  Saving model state dict ...
Epoch: 1 cost time: 1.1825306415557861
Epoch: 1, Steps: 131 | Train Loss: 0.5817392 Vali Loss: 0.2803684 Best vali loss: 0.2803684
	iters: 100, epoch: 2 | loss: 0.6684077
	speed: 0.0090s/iter; left time: 7.3981s
Updating learning rate to 0.00010567611035
Validation loss decreased (0.2804 --> 0.2792).  Saving model state dict ...
Epoch: 2 cost time: 0.6632852554321289
Epoch: 2, Steps: 131 | Train Loss: 0.6684077 Vali Loss: 0.2791915 Best vali loss: 0.2791915
	iters: 100, epoch: 3 | loss: 0.5601389
	speed: 0.0085s/iter; left time: 5.8508s
Updating learning rate to 5.2838055175e-05
Epoch: 3 cost time: 0.6739065647125244
Epoch: 3, Steps: 131 | Train Loss: 0.5601389 Vali Loss: 0.2801231 Best vali loss: 0.2791915

best validation loss 0.2791915335600684

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0027066824413, 'e_layers': 3, 'learning_rate': 0.0001110346081, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3369862
	speed: 0.0116s/iter; left time: 95.6849s
	iters: 200, epoch: 1 | loss: 0.2649363
	speed: 0.0057s/iter; left time: 46.6044s
	iters: 300, epoch: 1 | loss: 0.2832633
	speed: 0.0058s/iter; left time: 46.9739s
	iters: 400, epoch: 1 | loss: 0.2601721
	speed: 0.0062s/iter; left time: 49.1559s
	iters: 500, epoch: 1 | loss: 0.4330760
	speed: 0.0056s/iter; left time: 43.9722s
	iters: 600, epoch: 1 | loss: 0.4494005
	speed: 0.0062s/iter; left time: 47.9777s
	iters: 700, epoch: 1 | loss: 0.6568909
	speed: 0.0053s/iter; left time: 40.4772s
	iters: 800, epoch: 1 | loss: 0.3197719
	speed: 0.0063s/iter; left time: 47.3049s
	iters: 900, epoch: 1 | loss: 0.9393443
	speed: 0.0053s/iter; left time: 39.2072s
	iters: 1000, epoch: 1 | loss: 0.3203863
	speed: 0.0061s/iter; left time: 44.7145s
Updating learning rate to 0.00010680860496200096
Validation loss decreased (inf --> 0.2958).  Saving model state dict ...
Epoch: 1 cost time: 6.339290380477905
Epoch: 1, Steps: 1045 | Train Loss: 0.4264228 Vali Loss: 0.2958157 Best vali loss: 0.2958157
	iters: 100, epoch: 2 | loss: 0.1948209
	speed: 0.0193s/iter; left time: 139.6206s
	iters: 200, epoch: 2 | loss: 0.4260238
	speed: 0.0043s/iter; left time: 30.9533s
	iters: 300, epoch: 2 | loss: 1.2243041
	speed: 0.0037s/iter; left time: 25.9308s
	iters: 400, epoch: 2 | loss: 0.2369116
	speed: 0.0042s/iter; left time: 28.9380s
	iters: 500, epoch: 2 | loss: 0.3247158
	speed: 0.0047s/iter; left time: 31.9671s
	iters: 600, epoch: 2 | loss: 0.1636222
	speed: 0.0045s/iter; left time: 30.5312s
	iters: 700, epoch: 2 | loss: 0.5555202
	speed: 0.0047s/iter; left time: 31.2600s
	iters: 800, epoch: 2 | loss: 0.5332819
	speed: 0.0049s/iter; left time: 31.8320s
	iters: 900, epoch: 2 | loss: 0.3811239
	speed: 0.0048s/iter; left time: 30.6800s
	iters: 1000, epoch: 2 | loss: 0.1423331
	speed: 0.0047s/iter; left time: 29.8604s
Updating learning rate to 9.477396621695037e-05
Validation loss decreased (0.2958 --> 0.2867).  Saving model state dict ...
Epoch: 2 cost time: 4.963885545730591
Epoch: 2, Steps: 1045 | Train Loss: 0.4182657 Vali Loss: 0.2867255 Best vali loss: 0.2867255
	iters: 100, epoch: 3 | loss: 0.2950543
	speed: 0.0154s/iter; left time: 94.9353s
	iters: 200, epoch: 3 | loss: 0.2256214
	speed: 0.0046s/iter; left time: 27.9386s
	iters: 300, epoch: 3 | loss: 1.5588492
	speed: 0.0051s/iter; left time: 30.4903s
	iters: 400, epoch: 3 | loss: 0.7924531
	speed: 0.0049s/iter; left time: 28.8383s
	iters: 500, epoch: 3 | loss: 1.3193481
	speed: 0.0049s/iter; left time: 28.3431s
	iters: 600, epoch: 3 | loss: 1.3834628
	speed: 0.0051s/iter; left time: 28.9141s
	iters: 700, epoch: 3 | loss: 1.0470014
	speed: 0.0048s/iter; left time: 26.5310s
	iters: 800, epoch: 3 | loss: 0.7745052
	speed: 0.0052s/iter; left time: 28.6992s
	iters: 900, epoch: 3 | loss: 0.6350951
	speed: 0.0050s/iter; left time: 27.0596s
	iters: 1000, epoch: 3 | loss: 0.1940815
	speed: 0.0048s/iter; left time: 25.0390s
Updating learning rate to 7.67628565195103e-05
Validation loss decreased (0.2867 --> 0.2848).  Saving model state dict ...
Epoch: 3 cost time: 5.19724440574646
Epoch: 3, Steps: 1045 | Train Loss: 0.8225472 Vali Loss: 0.2847803 Best vali loss: 0.2847803

best validation loss 0.28478030015341455

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.001857404995, 'e_layers': 3, 'learning_rate': 0.0002113522207, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5211559
	speed: 0.0123s/iter; left time: 6.8287s
Updating learning rate to 2.64190275875e-05
Epoch: 4 cost time: 1.1477165222167969
Epoch: 4, Steps: 131 | Train Loss: 0.5211559 Vali Loss: 0.2793809 Best vali loss: 0.2791915
	iters: 100, epoch: 5 | loss: 0.6523948
	speed: 0.0113s/iter; left time: 4.8072s
Updating learning rate to 1.320951379375e-05
Epoch: 5 cost time: 0.9689185619354248
Epoch: 5, Steps: 131 | Train Loss: 0.6523948 Vali Loss: 0.2797057 Best vali loss: 0.2791915
	iters: 100, epoch: 6 | loss: 0.4932600
	speed: 0.0113s/iter; left time: 3.3299s
Updating learning rate to 6.604756896875e-06
Epoch: 6 cost time: 0.9365158081054688
Epoch: 6, Steps: 131 | Train Loss: 0.4932600 Vali Loss: 0.2799735 Best vali loss: 0.2791915
	iters: 100, epoch: 7 | loss: 0.4381430
	speed: 0.0096s/iter; left time: 1.5677s
Updating learning rate to 3.3023784484375e-06
Epoch: 7 cost time: 0.7882511615753174
Epoch: 7, Steps: 131 | Train Loss: 0.4381430 Vali Loss: 0.2801502 Best vali loss: 0.2791915
	iters: 100, epoch: 8 | loss: 0.5342250
	speed: 0.0112s/iter; left time: 0.3597s
Updating learning rate to 1.65118922421875e-06
Epoch: 8 cost time: 0.9565186500549316
Epoch: 8, Steps: 131 | Train Loss: 0.5342250 Vali Loss: 0.2801457 Best vali loss: 0.2791915

best validation loss 0.2791915335600684

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0014282327355, 'e_layers': 4, 'learning_rate': 0.0011080068437, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5218157
	speed: 0.0147s/iter; left time: 13.9104s
Updating learning rate to 0.0010658358442384311
Validation loss decreased (inf --> 0.2918).  Saving model state dict ...
Epoch: 1 cost time: 1.465118408203125
Epoch: 1, Steps: 131 | Train Loss: 0.5218157 Vali Loss: 0.2918016 Best vali loss: 0.2918016
	iters: 100, epoch: 2 | loss: 0.3461922
	speed: 0.0137s/iter; left time: 11.2331s
Updating learning rate to 0.0009457429982406865
Validation loss decreased (0.2918 --> 0.2825).  Saving model state dict ...
Epoch: 2 cost time: 1.1079223155975342
Epoch: 2, Steps: 131 | Train Loss: 0.3461922 Vali Loss: 0.2825455 Best vali loss: 0.2825455
	iters: 100, epoch: 3 | loss: 0.5257961
	speed: 0.0123s/iter; left time: 8.4701s
Updating learning rate to 0.0007660113528655628
Validation loss decreased (0.2825 --> 0.2801).  Saving model state dict ...
Epoch: 3 cost time: 0.8886091709136963
Epoch: 3, Steps: 131 | Train Loss: 0.5257961 Vali Loss: 0.2801127 Best vali loss: 0.2801127
	iters: 100, epoch: 4 | loss: 0.5230531
	speed: 0.0094s/iter; left time: 5.2212s
Updating learning rate to 0.00055400342185
Epoch: 4 cost time: 0.9124903678894043
Epoch: 4, Steps: 131 | Train Loss: 0.5230531 Vali Loss: 0.3012541 Best vali loss: 0.2801127
	iters: 100, epoch: 5 | loss: 0.3222149
	speed: 0.0151s/iter; left time: 6.4160s
Updating learning rate to 0.00034199549083443727
Epoch: 5 cost time: 1.2289681434631348
Epoch: 5, Steps: 131 | Train Loss: 0.3222149 Vali Loss: 0.2836305 Best vali loss: 0.2801127
	iters: 100, epoch: 6 | loss: 0.4804453
	speed: 0.0150s/iter; left time: 4.4171s
Updating learning rate to 0.0001622638454593135
Epoch: 6 cost time: 1.251579999923706
Epoch: 6, Steps: 131 | Train Loss: 0.4804453 Vali Loss: 0.2926981 Best vali loss: 0.2801127
	iters: 100, epoch: 7 | loss: 0.4372642
	speed: 0.0144s/iter; left time: 2.3437s
Updating learning rate to 4.217099946156882e-05
Epoch: 7 cost time: 1.0513136386871338
Epoch: 7, Steps: 131 | Train Loss: 0.4372642 Vali Loss: 0.2912735 Best vali loss: 0.2801127
	iters: 100, epoch: 8 | loss: 0.2158378
	speed: 0.0097s/iter; left time: 0.3100s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8454024791717529
Epoch: 8, Steps: 131 | Train Loss: 0.2158378 Vali Loss: 0.2920405 Best vali loss: 0.2801127

best validation loss 0.28011271839649005

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0014929082757, 'e_layers': 2, 'learning_rate': 0.0003483819796, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6682772
	speed: 0.0104s/iter; left time: 20.7249s
	iters: 200, epoch: 1 | loss: 0.5880899
	speed: 0.0047s/iter; left time: 8.9831s
Updating learning rate to 0.0003483819796
Validation loss decreased (inf --> 0.2830).  Saving model state dict ...
Epoch: 1 cost time: 1.5174541473388672
Epoch: 1, Steps: 262 | Train Loss: 0.6281835 Vali Loss: 0.2830001 Best vali loss: 0.2830001
	iters: 100, epoch: 2 | loss: 0.6601070
	speed: 0.0101s/iter; left time: 17.4626s
	iters: 200, epoch: 2 | loss: 0.4307588
	speed: 0.0045s/iter; left time: 7.3620s
Updating learning rate to 0.0001741909898
Validation loss decreased (0.2830 --> 0.2810).  Saving model state dict ...
Epoch: 2 cost time: 1.2341151237487793
Epoch: 2, Steps: 262 | Train Loss: 0.5454329 Vali Loss: 0.2810350 Best vali loss: 0.2810350
	iters: 100, epoch: 3 | loss: 0.6189895
	speed: 0.0093s/iter; left time: 13.6641s
	iters: 200, epoch: 3 | loss: 0.8423425
	speed: 0.0038s/iter; left time: 5.2187s
Updating learning rate to 8.70954949e-05
Epoch: 3 cost time: 1.0960979461669922
Epoch: 3, Steps: 262 | Train Loss: 0.7306660 Vali Loss: 0.2834499 Best vali loss: 0.2810350
	iters: 100, epoch: 4 | loss: 0.5388854
	speed: 0.0119s/iter; left time: 14.3528s
	iters: 200, epoch: 4 | loss: 0.4911405
	speed: 0.0056s/iter; left time: 6.2577s
Updating learning rate to 4.354774745e-05
Epoch: 4 cost time: 1.515439510345459
Epoch: 4, Steps: 262 | Train Loss: 0.5150129 Vali Loss: 0.2823799 Best vali loss: 0.2810350
	iters: 100, epoch: 5 | loss: 0.3150605
	speed: 0.0123s/iter; left time: 11.6469s
	iters: 200, epoch: 5 | loss: 0.4802957
	speed: 0.0039s/iter; left time: 3.3183s
Updating learning rate to 2.1773873725e-05
Epoch: 5 cost time: 1.232072353363037
Epoch: 5, Steps: 262 | Train Loss: 0.3976781 Vali Loss: 0.2838502 Best vali loss: 0.2810350
	iters: 100, epoch: 6 | loss: 0.5945650
	speed: 0.0113s/iter; left time: 7.7865s
	iters: 200, epoch: 6 | loss: 0.2761702
	speed: 0.0056s/iter; left time: 3.2604s
Updating learning rate to 1.08869368625e-05
Epoch: 6 cost time: 1.4917349815368652
Epoch: 6, Steps: 262 | Train Loss: 0.4353676 Vali Loss: 0.2839228 Best vali loss: 0.2810350
	iters: 100, epoch: 7 | loss: 0.5000886
	speed: 0.0121s/iter; left time: 5.1338s
	iters: 200, epoch: 7 | loss: 0.2987336
	speed: 0.0044s/iter; left time: 1.4363s
Updating learning rate to 5.44346843125e-06
Epoch: 7 cost time: 1.2951383590698242
Epoch: 7, Steps: 262 | Train Loss: 0.3994111 Vali Loss: 0.2840628 Best vali loss: 0.2810350
	iters: 100, epoch: 8 | loss: 0.3947982
	speed: 0.0115s/iter; left time: 1.8710s
	iters: 200, epoch: 8 | loss: 0.2986033
	speed: 0.0058s/iter; left time: 0.3674s
Updating learning rate to 2.721734215625e-06
Epoch: 8 cost time: 1.5661847591400146
Epoch: 8, Steps: 262 | Train Loss: 0.3467008 Vali Loss: 0.2842392 Best vali loss: 0.2810350

best validation loss 0.28103503956698095

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0034203496068, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5539901
	speed: 0.0121s/iter; left time: 49.4715s
	iters: 200, epoch: 1 | loss: 0.6775738
	speed: 0.0077s/iter; left time: 30.8801s
	iters: 300, epoch: 1 | loss: 0.8031442
	speed: 0.0077s/iter; left time: 30.0643s
	iters: 400, epoch: 1 | loss: 0.5392389
	speed: 0.0077s/iter; left time: 29.0995s
	iters: 500, epoch: 1 | loss: 0.3675340
	speed: 0.0077s/iter; left time: 28.5077s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.2765).  Saving model state dict ...
Epoch: 1 cost time: 4.2122838497161865
Epoch: 1, Steps: 523 | Train Loss: 0.5882962 Vali Loss: 0.2764949 Best vali loss: 0.2764949
	iters: 100, epoch: 2 | loss: 0.4391628
	speed: 0.0152s/iter; left time: 54.1048s
	iters: 200, epoch: 2 | loss: 0.3247953
	speed: 0.0075s/iter; left time: 25.8440s
	iters: 300, epoch: 2 | loss: 0.6039405
	speed: 0.0078s/iter; left time: 26.3909s
	iters: 400, epoch: 2 | loss: 0.2724183
	speed: 0.0078s/iter; left time: 25.4857s
	iters: 500, epoch: 2 | loss: 0.7629495
	speed: 0.0078s/iter; left time: 24.6685s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.2765 --> 0.2765).  Saving model state dict ...
Epoch: 2 cost time: 4.020376920700073
Epoch: 2, Steps: 523 | Train Loss: 0.4806533 Vali Loss: 0.2764722 Best vali loss: 0.2764722
	iters: 100, epoch: 3 | loss: 0.3072401
	speed: 0.0125s/iter; left time: 38.0499s
	iters: 200, epoch: 3 | loss: 1.1927899
	speed: 0.0041s/iter; left time: 12.0272s
	iters: 300, epoch: 3 | loss: 0.3180719
	speed: 0.0045s/iter; left time: 12.7495s
	iters: 400, epoch: 3 | loss: 0.5336592
	speed: 0.0051s/iter; left time: 13.8408s
	iters: 500, epoch: 3 | loss: 0.3351476
	speed: 0.0050s/iter; left time: 13.1085s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 2.4793338775634766
Epoch: 3, Steps: 523 | Train Loss: 0.5373817 Vali Loss: 0.2972604 Best vali loss: 0.2764722

best validation loss 0.2764721527590367

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0016962635724, 'e_layers': 4, 'learning_rate': 0.0031070450739, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6690974
	speed: 0.0138s/iter; left time: 13.0529s
Updating learning rate to 0.0029887902121331143
Validation loss decreased (inf --> 0.3262).  Saving model state dict ...
Epoch: 1 cost time: 1.3047101497650146
Epoch: 1, Steps: 131 | Train Loss: 0.6690974 Vali Loss: 0.3262268 Best vali loss: 0.3262268
	iters: 100, epoch: 2 | loss: 0.6128989
	speed: 0.0133s/iter; left time: 10.9079s
Updating learning rate to 0.002652028857553474
Validation loss decreased (0.3262 --> 0.3158).  Saving model state dict ...
Epoch: 2 cost time: 1.102403163909912
Epoch: 2, Steps: 131 | Train Loss: 0.6128989 Vali Loss: 0.3157543 Best vali loss: 0.3157543
	iters: 100, epoch: 3 | loss: 0.3705240
	speed: 0.0134s/iter; left time: 9.2187s
Updating learning rate to 0.002148029873646548
Epoch: 3 cost time: 1.0696861743927002
Epoch: 3, Steps: 131 | Train Loss: 0.3705240 Vali Loss: 0.3255512 Best vali loss: 0.3157543

best validation loss 0.31575427726105093

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0090271357217, 'e_layers': 3, 'learning_rate': 5.47188441e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7380777
	speed: 0.0136s/iter; left time: 27.2004s
	iters: 200, epoch: 1 | loss: 0.7265670
	speed: 0.0069s/iter; left time: 13.0372s
Updating learning rate to 5.263623210333299e-05
Validation loss decreased (inf --> 0.2957).  Saving model state dict ...
Epoch: 1 cost time: 2.259289264678955
Epoch: 1, Steps: 262 | Train Loss: 0.7323223 Vali Loss: 0.2957263 Best vali loss: 0.2957263
	iters: 100, epoch: 2 | loss: 0.9449599
	speed: 0.0162s/iter; left time: 28.0323s
	iters: 200, epoch: 2 | loss: 0.5387924
	speed: 0.0075s/iter; left time: 12.2073s
Updating learning rate to 4.670545491089975e-05
Validation loss decreased (0.2957 --> 0.2857).  Saving model state dict ...
Epoch: 2 cost time: 1.9490113258361816
Epoch: 2, Steps: 262 | Train Loss: 0.7418762 Vali Loss: 0.2856771 Best vali loss: 0.2856771
	iters: 100, epoch: 3 | loss: 0.8109789
	speed: 0.0159s/iter; left time: 23.4597s
	iters: 200, epoch: 3 | loss: 0.8505798
	speed: 0.0080s/iter; left time: 10.9375s
Updating learning rate to 3.7829419587619125e-05
Validation loss decreased (0.2857 --> 0.2814).  Saving model state dict ...
Epoch: 3 cost time: 1.9421148300170898
Epoch: 3, Steps: 262 | Train Loss: 0.8307794 Vali Loss: 0.2814198 Best vali loss: 0.2814198

best validation loss 0.2814197804613954

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0034203496068, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5117162
	speed: 0.0143s/iter; left time: 36.0064s
	iters: 200, epoch: 4 | loss: 0.4871143
	speed: 0.0080s/iter; left time: 19.4318s
	iters: 300, epoch: 4 | loss: 0.3703336
	speed: 0.0070s/iter; left time: 16.2740s
	iters: 400, epoch: 4 | loss: 0.3791437
	speed: 0.0040s/iter; left time: 8.8635s
	iters: 500, epoch: 4 | loss: 0.3253610
	speed: 0.0041s/iter; left time: 8.6044s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 3.500180721282959
Epoch: 4, Steps: 523 | Train Loss: 0.4147337 Vali Loss: 0.3086558 Best vali loss: 0.2764722
	iters: 100, epoch: 5 | loss: 0.3665554
	speed: 0.0131s/iter; left time: 26.0416s
	iters: 200, epoch: 5 | loss: 0.3034581
	speed: 0.0058s/iter; left time: 11.0078s
	iters: 300, epoch: 5 | loss: 0.4046838
	speed: 0.0057s/iter; left time: 10.3085s
	iters: 400, epoch: 5 | loss: 0.2571124
	speed: 0.0060s/iter; left time: 10.1429s
	iters: 500, epoch: 5 | loss: 0.6071002
	speed: 0.0057s/iter; left time: 9.1420s
Updating learning rate to 3.3224917040731837e-05
Epoch: 5 cost time: 3.132145643234253
Epoch: 5, Steps: 523 | Train Loss: 0.3877820 Vali Loss: 0.3056659 Best vali loss: 0.2764722
	iters: 100, epoch: 6 | loss: 0.2517045
	speed: 0.0126s/iter; left time: 18.5302s
	iters: 200, epoch: 6 | loss: 0.7300348
	speed: 0.0057s/iter; left time: 7.7745s
	iters: 300, epoch: 6 | loss: 0.2464787
	speed: 0.0050s/iter; left time: 6.3242s
	iters: 400, epoch: 6 | loss: 0.4435430
	speed: 0.0045s/iter; left time: 5.2700s
	iters: 500, epoch: 6 | loss: 0.3047070
	speed: 0.0046s/iter; left time: 4.9177s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 2.6872799396514893
Epoch: 6, Steps: 523 | Train Loss: 0.3952936 Vali Loss: 0.3327747 Best vali loss: 0.2764722
	iters: 100, epoch: 7 | loss: 0.3158380
	speed: 0.0120s/iter; left time: 11.3939s
	iters: 200, epoch: 7 | loss: 0.2573996
	speed: 0.0060s/iter; left time: 5.0559s
	iters: 300, epoch: 7 | loss: 0.3490097
	speed: 0.0060s/iter; left time: 4.4666s
	iters: 400, epoch: 7 | loss: 0.5046659
	speed: 0.0058s/iter; left time: 3.7539s
	iters: 500, epoch: 7 | loss: 0.2014093
	speed: 0.0057s/iter; left time: 3.1065s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 3.106511116027832
Epoch: 7, Steps: 523 | Train Loss: 0.3256645 Vali Loss: 0.3330545 Best vali loss: 0.2764722
	iters: 100, epoch: 8 | loss: 0.3553851
	speed: 0.0127s/iter; left time: 5.3892s
	iters: 200, epoch: 8 | loss: 0.1665609
	speed: 0.0057s/iter; left time: 1.8474s
	iters: 300, epoch: 8 | loss: 0.2497430
	speed: 0.0057s/iter; left time: 1.2723s
	iters: 400, epoch: 8 | loss: 0.4941037
	speed: 0.0046s/iter; left time: 0.5645s
	iters: 500, epoch: 8 | loss: 0.4334020
	speed: 0.0045s/iter; left time: 0.1079s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7557337284088135
Epoch: 8, Steps: 523 | Train Loss: 0.3398389 Vali Loss: 0.3361713 Best vali loss: 0.2764722

best validation loss 0.2764721527590367

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0062587438156, 'e_layers': 1, 'learning_rate': 0.0016392436863, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7517919
	speed: 0.0091s/iter; left time: 8.6538s
Updating learning rate to 0.0016392436863
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 0.7247545719146729
Epoch: 1, Steps: 131 | Train Loss: 0.7517919 Vali Loss: 0.2866761 Best vali loss: 0.2866761
	iters: 100, epoch: 2 | loss: 0.5850245
	speed: 0.0062s/iter; left time: 5.0471s
Updating learning rate to 0.00081962184315
Epoch: 2 cost time: 0.4552469253540039
Epoch: 2, Steps: 131 | Train Loss: 0.5850245 Vali Loss: 0.2880505 Best vali loss: 0.2866761
	iters: 100, epoch: 3 | loss: 0.6014979
	speed: 0.0059s/iter; left time: 4.0728s
Updating learning rate to 0.000409810921575
Epoch: 3 cost time: 0.4500579833984375
Epoch: 3, Steps: 131 | Train Loss: 0.6014979 Vali Loss: 0.2906181 Best vali loss: 0.2866761
	iters: 100, epoch: 4 | loss: 0.3636179
	speed: 0.0061s/iter; left time: 3.3880s
Updating learning rate to 0.0002049054607875
Epoch: 4 cost time: 0.4734485149383545
Epoch: 4, Steps: 131 | Train Loss: 0.3636179 Vali Loss: 0.2883344 Best vali loss: 0.2866761
	iters: 100, epoch: 5 | loss: 0.3602240
	speed: 0.0064s/iter; left time: 2.7267s
Updating learning rate to 0.00010245273039375
Epoch: 5 cost time: 0.5019543170928955
Epoch: 5, Steps: 131 | Train Loss: 0.3602240 Vali Loss: 0.2901902 Best vali loss: 0.2866761
	iters: 100, epoch: 6 | loss: 0.6073577
	speed: 0.0058s/iter; left time: 1.7088s
Updating learning rate to 5.1226365196875e-05
Epoch: 6 cost time: 0.4374508857727051
Epoch: 6, Steps: 131 | Train Loss: 0.6073577 Vali Loss: 0.2909845 Best vali loss: 0.2866761
	iters: 100, epoch: 7 | loss: 0.3489454
	speed: 0.0056s/iter; left time: 0.9200s
Updating learning rate to 2.56131825984375e-05
Epoch: 7 cost time: 0.41753554344177246
Epoch: 7, Steps: 131 | Train Loss: 0.3489454 Vali Loss: 0.2910593 Best vali loss: 0.2866761
	iters: 100, epoch: 8 | loss: 0.4769729
	speed: 0.0055s/iter; left time: 0.1759s
Updating learning rate to 1.280659129921875e-05
Epoch: 8 cost time: 0.4286539554595947
Epoch: 8, Steps: 131 | Train Loss: 0.4769729 Vali Loss: 0.2911280 Best vali loss: 0.2866761

best validation loss 0.2866760900679819

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010633276881, 'e_layers': 4, 'learning_rate': 0.0001600989607, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3491799
	speed: 0.0125s/iter; left time: 11.8802s
Updating learning rate to 0.00015400555683352943
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 1.2008492946624756
Epoch: 1, Steps: 131 | Train Loss: 0.3491799 Vali Loss: 0.2833983 Best vali loss: 0.2833983
	iters: 100, epoch: 2 | loss: 0.4272393
	speed: 0.0118s/iter; left time: 9.6334s
Updating learning rate to 0.0001366530107359443
Validation loss decreased (0.2834 --> 0.2766).  Saving model state dict ...
Epoch: 2 cost time: 0.9954466819763184
Epoch: 2, Steps: 131 | Train Loss: 0.4272393 Vali Loss: 0.2765800 Best vali loss: 0.2765800
	iters: 100, epoch: 3 | loss: 0.4549779
	speed: 0.0114s/iter; left time: 7.8516s
Updating learning rate to 0.00011068309024937981
Epoch: 3 cost time: 0.9316952228546143
Epoch: 3, Steps: 131 | Train Loss: 0.4549779 Vali Loss: 0.2798430 Best vali loss: 0.2765800
	iters: 100, epoch: 4 | loss: 0.4289709
	speed: 0.0114s/iter; left time: 6.3600s
Updating learning rate to 8.004948035e-05
Epoch: 4 cost time: 0.9896936416625977
Epoch: 4, Steps: 131 | Train Loss: 0.4289709 Vali Loss: 0.2902758 Best vali loss: 0.2765800
	iters: 100, epoch: 5 | loss: 0.4725513
	speed: 0.0112s/iter; left time: 4.7797s
Updating learning rate to 4.94158704506202e-05
Epoch: 5 cost time: 0.9327700138092041
Epoch: 5, Steps: 131 | Train Loss: 0.4725513 Vali Loss: 0.2933051 Best vali loss: 0.2765800
	iters: 100, epoch: 6 | loss: 0.4866186
	speed: 0.0112s/iter; left time: 3.2912s
Updating learning rate to 2.344594996405572e-05
Epoch: 6 cost time: 0.9436182975769043
Epoch: 6, Steps: 131 | Train Loss: 0.4866186 Vali Loss: 0.3157250 Best vali loss: 0.2765800
	iters: 100, epoch: 7 | loss: 0.3813393
	speed: 0.0110s/iter; left time: 1.7978s
Updating learning rate to 6.093403866470566e-06
Epoch: 7 cost time: 0.9245014190673828
Epoch: 7, Steps: 131 | Train Loss: 0.3813393 Vali Loss: 0.3003706 Best vali loss: 0.2765800
	iters: 100, epoch: 8 | loss: 0.4125957
	speed: 0.0110s/iter; left time: 0.3534s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9196300506591797
Epoch: 8, Steps: 131 | Train Loss: 0.4125957 Vali Loss: 0.2978967 Best vali loss: 0.2765800

best validation loss 0.27658002162210205

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010605591593, 'e_layers': 2, 'learning_rate': 0.0016136112128, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3530624
	speed: 0.0093s/iter; left time: 76.5599s
	iters: 200, epoch: 1 | loss: 0.7535393
	speed: 0.0037s/iter; left time: 30.1821s
	iters: 300, epoch: 1 | loss: 0.4522792
	speed: 0.0038s/iter; left time: 30.8320s
	iters: 400, epoch: 1 | loss: 0.6270263
	speed: 0.0038s/iter; left time: 30.3256s
	iters: 500, epoch: 1 | loss: 0.6743876
	speed: 0.0041s/iter; left time: 32.0198s
	iters: 600, epoch: 1 | loss: 1.2261351
	speed: 0.0040s/iter; left time: 30.6624s
	iters: 700, epoch: 1 | loss: 0.4833153
	speed: 0.0038s/iter; left time: 28.8101s
	iters: 800, epoch: 1 | loss: 0.5405227
	speed: 0.0037s/iter; left time: 27.9615s
	iters: 900, epoch: 1 | loss: 1.1836295
	speed: 0.0039s/iter; left time: 29.4237s
	iters: 1000, epoch: 1 | loss: 0.2555780
	speed: 0.0035s/iter; left time: 25.9123s
Updating learning rate to 0.0015521967928683173
Validation loss decreased (inf --> 0.3434).  Saving model state dict ...
Epoch: 1 cost time: 4.234850168228149
Epoch: 1, Steps: 1045 | Train Loss: 0.6549475 Vali Loss: 0.3434209 Best vali loss: 0.3434209
	iters: 100, epoch: 2 | loss: 0.3485407
	speed: 0.0124s/iter; left time: 89.6957s
	iters: 200, epoch: 2 | loss: 0.2109802
	speed: 0.0043s/iter; left time: 30.8780s
	iters: 300, epoch: 2 | loss: 0.9291794
	speed: 0.0043s/iter; left time: 30.3879s
	iters: 400, epoch: 2 | loss: 1.2047951
	speed: 0.0043s/iter; left time: 29.9270s
	iters: 500, epoch: 2 | loss: 0.3735907
	speed: 0.0042s/iter; left time: 28.4228s
	iters: 600, epoch: 2 | loss: 0.2554418
	speed: 0.0041s/iter; left time: 27.6276s
	iters: 700, epoch: 2 | loss: 0.5799319
	speed: 0.0039s/iter; left time: 26.0119s
	iters: 800, epoch: 2 | loss: 1.4016045
	speed: 0.0041s/iter; left time: 26.4597s
	iters: 900, epoch: 2 | loss: 0.8879380
	speed: 0.0042s/iter; left time: 27.1468s
	iters: 1000, epoch: 2 | loss: 1.6048068
	speed: 0.0042s/iter; left time: 26.5976s
Updating learning rate to 0.0013773033217847647
Epoch: 2 cost time: 4.4332191944122314
Epoch: 2, Steps: 1045 | Train Loss: 0.7796809 Vali Loss: 0.3691462 Best vali loss: 0.3434209
	iters: 100, epoch: 3 | loss: 0.4541260
	speed: 0.0143s/iter; left time: 88.2437s
	iters: 200, epoch: 3 | loss: 1.2836845
	speed: 0.0035s/iter; left time: 21.5114s
	iters: 300, epoch: 3 | loss: 1.0616924
	speed: 0.0036s/iter; left time: 21.5865s
	iters: 400, epoch: 3 | loss: 0.4286617
	speed: 0.0038s/iter; left time: 22.5450s
	iters: 500, epoch: 3 | loss: 0.3678512
	speed: 0.0038s/iter; left time: 22.1171s
	iters: 600, epoch: 3 | loss: 0.2308836
	speed: 0.0038s/iter; left time: 21.3541s
	iters: 700, epoch: 3 | loss: 0.5841252
	speed: 0.0038s/iter; left time: 21.4252s
	iters: 800, epoch: 3 | loss: 1.6870286
	speed: 0.0039s/iter; left time: 21.1900s
	iters: 900, epoch: 3 | loss: 0.9331633
	speed: 0.0038s/iter; left time: 20.4308s
	iters: 1000, epoch: 3 | loss: 0.5047429
	speed: 0.0036s/iter; left time: 19.1585s
Updating learning rate to 0.0011155567451085497
Validation loss decreased (0.3434 --> 0.3195).  Saving model state dict ...
Epoch: 3 cost time: 3.96732759475708
Epoch: 3, Steps: 1045 | Train Loss: 0.7535959 Vali Loss: 0.3194789 Best vali loss: 0.3194789

best validation loss 0.3194789027261131

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6058314
	speed: 0.0086s/iter; left time: 71.0408s
	iters: 200, epoch: 1 | loss: 0.2699382
	speed: 0.0030s/iter; left time: 24.6630s
	iters: 300, epoch: 1 | loss: 0.7872227
	speed: 0.0028s/iter; left time: 22.2962s
	iters: 400, epoch: 1 | loss: 0.2649959
	speed: 0.0027s/iter; left time: 21.2705s
	iters: 500, epoch: 1 | loss: 1.3114928
	speed: 0.0028s/iter; left time: 21.8251s
	iters: 600, epoch: 1 | loss: 0.2518728
	speed: 0.0027s/iter; left time: 20.8115s
	iters: 700, epoch: 1 | loss: 0.4028100
	speed: 0.0028s/iter; left time: 21.3312s
	iters: 800, epoch: 1 | loss: 0.4955551
	speed: 0.0027s/iter; left time: 20.3389s
	iters: 900, epoch: 1 | loss: 0.2500733
	speed: 0.0026s/iter; left time: 19.0298s
	iters: 1000, epoch: 1 | loss: 0.7282495
	speed: 0.0026s/iter; left time: 19.2368s
Updating learning rate to 0.00022273671327002105
Validation loss decreased (inf --> 0.2828).  Saving model state dict ...
Epoch: 1 cost time: 3.1466562747955322
Epoch: 1, Steps: 1045 | Train Loss: 0.5368042 Vali Loss: 0.2828493 Best vali loss: 0.2828493
	iters: 100, epoch: 2 | loss: 0.2308114
	speed: 0.0116s/iter; left time: 83.6879s
	iters: 200, epoch: 2 | loss: 0.2111434
	speed: 0.0031s/iter; left time: 21.7918s
	iters: 300, epoch: 2 | loss: 0.8563131
	speed: 0.0031s/iter; left time: 21.4657s
	iters: 400, epoch: 2 | loss: 0.4487385
	speed: 0.0030s/iter; left time: 20.4484s
	iters: 500, epoch: 2 | loss: 0.3543689
	speed: 0.0030s/iter; left time: 20.4055s
	iters: 600, epoch: 2 | loss: 0.6310326
	speed: 0.0029s/iter; left time: 19.8029s
	iters: 700, epoch: 2 | loss: 0.2066982
	speed: 0.0027s/iter; left time: 17.9987s
	iters: 800, epoch: 2 | loss: 0.5405811
	speed: 0.0030s/iter; left time: 19.4425s
	iters: 900, epoch: 2 | loss: 0.5862730
	speed: 0.0030s/iter; left time: 19.4991s
	iters: 1000, epoch: 2 | loss: 0.3378968
	speed: 0.0033s/iter; left time: 20.5326s
Updating learning rate to 0.00019763989751797302
Epoch: 2 cost time: 3.1842949390411377
Epoch: 2, Steps: 1045 | Train Loss: 0.4403857 Vali Loss: 0.2873092 Best vali loss: 0.2828493
	iters: 100, epoch: 3 | loss: 0.2265766
	speed: 0.0120s/iter; left time: 73.8444s
	iters: 200, epoch: 3 | loss: 1.0312362
	speed: 0.0029s/iter; left time: 17.4898s
	iters: 300, epoch: 3 | loss: 0.3399763
	speed: 0.0030s/iter; left time: 17.7255s
	iters: 400, epoch: 3 | loss: 0.2221666
	speed: 0.0029s/iter; left time: 16.9081s
	iters: 500, epoch: 3 | loss: 0.8658565
	speed: 0.0025s/iter; left time: 14.5049s
	iters: 600, epoch: 3 | loss: 0.2149859
	speed: 0.0025s/iter; left time: 14.2301s
	iters: 700, epoch: 3 | loss: 0.2608482
	speed: 0.0031s/iter; left time: 17.3513s
	iters: 800, epoch: 3 | loss: 0.2667428
	speed: 0.0032s/iter; left time: 17.5378s
	iters: 900, epoch: 3 | loss: 0.3090222
	speed: 0.0032s/iter; left time: 17.3066s
	iters: 1000, epoch: 3 | loss: 0.6039283
	speed: 0.0032s/iter; left time: 17.1107s
Updating learning rate to 0.00016007985843890398
Epoch: 3 cost time: 3.141911029815674
Epoch: 3, Steps: 1045 | Train Loss: 0.4341340 Vali Loss: 0.2963226 Best vali loss: 0.2828493

best validation loss 0.28284926236495955

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7705776
	speed: 0.0106s/iter; left time: 43.3182s
	iters: 200, epoch: 1 | loss: 0.2257585
	speed: 0.0051s/iter; left time: 20.4341s
	iters: 300, epoch: 1 | loss: 0.8536066
	speed: 0.0051s/iter; left time: 19.9656s
	iters: 400, epoch: 1 | loss: 0.3156607
	speed: 0.0051s/iter; left time: 19.3884s
	iters: 500, epoch: 1 | loss: 0.2896612
	speed: 0.0051s/iter; left time: 18.9240s
Updating learning rate to 0.0005359963767340445
Validation loss decreased (inf --> 0.2851).  Saving model state dict ...
Epoch: 1 cost time: 2.945862054824829
Epoch: 1, Steps: 523 | Train Loss: 0.4910529 Vali Loss: 0.2850976 Best vali loss: 0.2850976
	iters: 100, epoch: 2 | loss: 0.2725548
	speed: 0.0091s/iter; left time: 32.4955s
	iters: 200, epoch: 2 | loss: 0.7207882
	speed: 0.0037s/iter; left time: 12.8679s
	iters: 300, epoch: 2 | loss: 0.3576042
	speed: 0.0037s/iter; left time: 12.4571s
	iters: 400, epoch: 2 | loss: 0.4042794
	speed: 0.0040s/iter; left time: 12.9326s
	iters: 500, epoch: 2 | loss: 0.4496273
	speed: 0.0041s/iter; left time: 12.8374s
Updating learning rate to 0.00047560308946149616
Epoch: 2 cost time: 2.0548641681671143
Epoch: 2, Steps: 523 | Train Loss: 0.4409708 Vali Loss: 0.2857726 Best vali loss: 0.2850976
	iters: 100, epoch: 3 | loss: 0.7362032
	speed: 0.0119s/iter; left time: 36.2014s
	iters: 200, epoch: 3 | loss: 0.5025969
	speed: 0.0051s/iter; left time: 14.9953s
	iters: 300, epoch: 3 | loss: 0.4368948
	speed: 0.0052s/iter; left time: 14.6600s
	iters: 400, epoch: 3 | loss: 0.3374017
	speed: 0.0053s/iter; left time: 14.5070s
	iters: 500, epoch: 3 | loss: 0.4007300
	speed: 0.0052s/iter; left time: 13.6645s
Updating learning rate to 0.0003852181477030879
Validation loss decreased (0.2851 --> 0.2845).  Saving model state dict ...
Epoch: 3 cost time: 2.7876458168029785
Epoch: 3, Steps: 523 | Train Loss: 0.4827653 Vali Loss: 0.2844521 Best vali loss: 0.2844521

best validation loss 0.28445213382551776

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5689825
	speed: 0.0080s/iter; left time: 40.7811s
	iters: 200, epoch: 4 | loss: 0.3025610
	speed: 0.0034s/iter; left time: 17.0008s
	iters: 300, epoch: 4 | loss: 0.5945747
	speed: 0.0038s/iter; left time: 18.6734s
	iters: 400, epoch: 4 | loss: 0.2651657
	speed: 0.0034s/iter; left time: 16.3452s
	iters: 500, epoch: 4 | loss: 0.8738327
	speed: 0.0034s/iter; left time: 16.1847s
	iters: 600, epoch: 4 | loss: 0.2742677
	speed: 0.0027s/iter; left time: 12.4756s
	iters: 700, epoch: 4 | loss: 0.3439226
	speed: 0.0035s/iter; left time: 15.7368s
	iters: 800, epoch: 4 | loss: 0.4469693
	speed: 0.0037s/iter; left time: 16.3416s
	iters: 900, epoch: 4 | loss: 0.1675977
	speed: 0.0036s/iter; left time: 15.6793s
	iters: 1000, epoch: 4 | loss: 0.6038358
	speed: 0.0033s/iter; left time: 13.9736s
Updating learning rate to 0.0001157747715
Epoch: 4 cost time: 3.7187936305999756
Epoch: 4, Steps: 1045 | Train Loss: 0.4441710 Vali Loss: 0.2941963 Best vali loss: 0.2828493
	iters: 100, epoch: 5 | loss: 0.2054317
	speed: 0.0132s/iter; left time: 53.9938s
	iters: 200, epoch: 5 | loss: 0.2036205
	speed: 0.0032s/iter; left time: 12.8246s
	iters: 300, epoch: 5 | loss: 0.7314869
	speed: 0.0027s/iter; left time: 10.3416s
	iters: 400, epoch: 5 | loss: 0.3601269
	speed: 0.0034s/iter; left time: 12.9800s
	iters: 500, epoch: 5 | loss: 0.3592805
	speed: 0.0034s/iter; left time: 12.6383s
	iters: 600, epoch: 5 | loss: 0.3465857
	speed: 0.0033s/iter; left time: 11.8785s
	iters: 700, epoch: 5 | loss: 0.2414686
	speed: 0.0031s/iter; left time: 10.6984s
	iters: 800, epoch: 5 | loss: 0.3672695
	speed: 0.0022s/iter; left time: 7.3124s
	iters: 900, epoch: 5 | loss: 0.4064331
	speed: 0.0029s/iter; left time: 9.6597s
	iters: 1000, epoch: 5 | loss: 0.3344092
	speed: 0.0034s/iter; left time: 10.9714s
Updating learning rate to 7.146968456109603e-05
Epoch: 5 cost time: 3.2963812351226807
Epoch: 5, Steps: 1045 | Train Loss: 0.3556113 Vali Loss: 0.2968893 Best vali loss: 0.2828493
	iters: 100, epoch: 6 | loss: 0.2365455
	speed: 0.0115s/iter; left time: 34.9831s
	iters: 200, epoch: 6 | loss: 0.8441221
	speed: 0.0020s/iter; left time: 5.8798s
	iters: 300, epoch: 6 | loss: 0.3076865
	speed: 0.0021s/iter; left time: 6.0065s
	iters: 400, epoch: 6 | loss: 0.2080473
	speed: 0.0026s/iter; left time: 6.9787s
	iters: 500, epoch: 6 | loss: 0.7368736
	speed: 0.0033s/iter; left time: 8.5967s
	iters: 600, epoch: 6 | loss: 0.1799314
	speed: 0.0027s/iter; left time: 6.9560s
	iters: 700, epoch: 6 | loss: 0.2956436
	speed: 0.0032s/iter; left time: 7.7557s
	iters: 800, epoch: 6 | loss: 0.2449589
	speed: 0.0027s/iter; left time: 6.2930s
	iters: 900, epoch: 6 | loss: 0.2716675
	speed: 0.0032s/iter; left time: 7.1136s
	iters: 1000, epoch: 6 | loss: 0.5715543
	speed: 0.0027s/iter; left time: 5.7321s
Updating learning rate to 3.390964548202697e-05
Epoch: 6 cost time: 2.826833963394165
Epoch: 6, Steps: 1045 | Train Loss: 0.3897031 Vali Loss: 0.2999630 Best vali loss: 0.2828493
	iters: 100, epoch: 7 | loss: 0.6997379
	speed: 0.0112s/iter; left time: 22.2390s
	iters: 200, epoch: 7 | loss: 0.1568415
	speed: 0.0030s/iter; left time: 5.7508s
	iters: 300, epoch: 7 | loss: 0.3038977
	speed: 0.0027s/iter; left time: 4.7812s
	iters: 400, epoch: 7 | loss: 0.7420034
	speed: 0.0032s/iter; left time: 5.3541s
	iters: 500, epoch: 7 | loss: 0.2823156
	speed: 0.0027s/iter; left time: 4.3205s
	iters: 600, epoch: 7 | loss: 0.4928532
	speed: 0.0030s/iter; left time: 4.5142s
	iters: 700, epoch: 7 | loss: 0.3249435
	speed: 0.0025s/iter; left time: 3.4211s
	iters: 800, epoch: 7 | loss: 0.4609274
	speed: 0.0022s/iter; left time: 2.8402s
	iters: 900, epoch: 7 | loss: 0.2543657
	speed: 0.0022s/iter; left time: 2.6766s
	iters: 1000, epoch: 7 | loss: 0.1517898
	speed: 0.0023s/iter; left time: 2.5475s
Updating learning rate to 8.812829729978956e-06
Epoch: 7 cost time: 2.829819440841675
Epoch: 7, Steps: 1045 | Train Loss: 0.3869676 Vali Loss: 0.2989053 Best vali loss: 0.2828493
	iters: 100, epoch: 8 | loss: 0.4086607
	speed: 0.0123s/iter; left time: 11.6031s
	iters: 200, epoch: 8 | loss: 0.3126438
	speed: 0.0033s/iter; left time: 2.7906s
	iters: 300, epoch: 8 | loss: 0.2354189
	speed: 0.0033s/iter; left time: 2.4559s
	iters: 400, epoch: 8 | loss: 1.2739475
	speed: 0.0034s/iter; left time: 2.1678s
	iters: 500, epoch: 8 | loss: 0.2782368
	speed: 0.0031s/iter; left time: 1.7093s
	iters: 600, epoch: 8 | loss: 0.4921694
	speed: 0.0030s/iter; left time: 1.3439s
	iters: 700, epoch: 8 | loss: 0.1803290
	speed: 0.0031s/iter; left time: 1.0569s
	iters: 800, epoch: 8 | loss: 0.7551313
	speed: 0.0030s/iter; left time: 0.7390s
	iters: 900, epoch: 8 | loss: 0.4584093
	speed: 0.0030s/iter; left time: 0.4314s
	iters: 1000, epoch: 8 | loss: 0.2262575
	speed: 0.0029s/iter; left time: 0.1333s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.3227341175079346
Epoch: 8, Steps: 1045 | Train Loss: 0.4621204 Vali Loss: 0.2995012 Best vali loss: 0.2828493

best validation loss 0.28284926236495955

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021887918326, 'e_layers': 3, 'learning_rate': 0.0046350312805, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4813666
	speed: 0.0106s/iter; left time: 21.0759s
	iters: 200, epoch: 1 | loss: 0.4995256
	speed: 0.0049s/iter; left time: 9.2242s
Updating learning rate to 0.004458620906551766
Validation loss decreased (inf --> 0.3199).  Saving model state dict ...
Epoch: 1 cost time: 1.576089859008789
Epoch: 1, Steps: 262 | Train Loss: 0.4904461 Vali Loss: 0.3199480 Best vali loss: 0.3199480
	iters: 100, epoch: 2 | loss: 0.8744914
	speed: 0.0108s/iter; left time: 18.7387s
	iters: 200, epoch: 2 | loss: 0.4007213
	speed: 0.0049s/iter; left time: 7.9871s
Updating learning rate to 0.003956246664976659
Epoch: 2 cost time: 1.3287577629089355
Epoch: 2, Steps: 262 | Train Loss: 0.6376063 Vali Loss: 0.3264638 Best vali loss: 0.3199480
	iters: 100, epoch: 3 | loss: 0.4354575
	speed: 0.0110s/iter; left time: 16.2034s
	iters: 200, epoch: 3 | loss: 0.3850846
	speed: 0.0047s/iter; left time: 6.4595s
Updating learning rate to 0.003204390480020649
Epoch: 3 cost time: 1.2845244407653809
Epoch: 3, Steps: 262 | Train Loss: 0.4102710 Vali Loss: 0.3228423 Best vali loss: 0.3199480
	iters: 100, epoch: 4 | loss: 0.9457154
	speed: 0.0101s/iter; left time: 12.2850s
	iters: 200, epoch: 4 | loss: 0.9082992
	speed: 0.0051s/iter; left time: 5.6379s
Updating learning rate to 0.00231751564025
Epoch: 4 cost time: 1.3450567722320557
Epoch: 4, Steps: 262 | Train Loss: 0.9270073 Vali Loss: 0.3220915 Best vali loss: 0.3199480
	iters: 100, epoch: 5 | loss: 0.6695344
	speed: 0.0109s/iter; left time: 10.3214s
	iters: 200, epoch: 5 | loss: 0.4035912
	speed: 0.0049s/iter; left time: 4.1372s
Updating learning rate to 0.0014306408004793516
Epoch: 5 cost time: 1.3421804904937744
Epoch: 5, Steps: 262 | Train Loss: 0.5365628 Vali Loss: 0.3220635 Best vali loss: 0.3199480
	iters: 100, epoch: 6 | loss: 0.5353507
	speed: 0.0110s/iter; left time: 7.5885s
	iters: 200, epoch: 6 | loss: 0.8404078
	speed: 0.0049s/iter; left time: 2.8807s
Updating learning rate to 0.0006787846155233418
Epoch: 6 cost time: 1.3607819080352783
Epoch: 6, Steps: 262 | Train Loss: 0.6878793 Vali Loss: 0.3224012 Best vali loss: 0.3199480
	iters: 100, epoch: 7 | loss: 0.6285198
	speed: 0.0113s/iter; left time: 4.7976s
	iters: 200, epoch: 7 | loss: 0.7559980
	speed: 0.0052s/iter; left time: 1.6767s
Updating learning rate to 0.00017641037394823463
Epoch: 7 cost time: 1.3944504261016846
Epoch: 7, Steps: 262 | Train Loss: 0.6922589 Vali Loss: 0.3222838 Best vali loss: 0.3199480
	iters: 100, epoch: 8 | loss: 0.6371770
	speed: 0.0106s/iter; left time: 1.7262s
	iters: 200, epoch: 8 | loss: 0.6403775
	speed: 0.0044s/iter; left time: 0.2798s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2192001342773438
Epoch: 8, Steps: 262 | Train Loss: 0.6387772 Vali Loss: 0.3222817 Best vali loss: 0.3199480

best validation loss 0.319947969729504

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0011689257956, 'e_layers': 4, 'learning_rate': 0.000133952073, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00012885382579107886
Validation loss decreased (inf --> 0.3170).  Saving model state dict ...
Epoch: 1 cost time: 0.7828149795532227
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3169928 Best vali loss: 0.3169928
Updating learning rate to 0.00011433524608614771
Validation loss decreased (0.3170 --> 0.3002).  Saving model state dict ...
Epoch: 2 cost time: 0.48561859130859375
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3002107 Best vali loss: 0.3002107
Updating learning rate to 9.260665603402952e-05
Validation loss decreased (0.3002 --> 0.2929).  Saving model state dict ...
Epoch: 3 cost time: 0.4902474880218506
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2928618 Best vali loss: 0.2928618
Updating learning rate to 6.69760365e-05
Validation loss decreased (0.2929 --> 0.2884).  Saving model state dict ...
Epoch: 4 cost time: 0.5361514091491699
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2883988 Best vali loss: 0.2883988
Updating learning rate to 4.1345416965970464e-05
Validation loss decreased (0.2884 --> 0.2864).  Saving model state dict ...
Epoch: 5 cost time: 0.5144286155700684
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2864098 Best vali loss: 0.2864098
Updating learning rate to 1.9616826913852282e-05
Validation loss decreased (0.2864 --> 0.2852).  Saving model state dict ...
Epoch: 6 cost time: 0.4591507911682129
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2851957 Best vali loss: 0.2851957
Updating learning rate to 5.098247208921122e-06
Validation loss decreased (0.2852 --> 0.2850).  Saving model state dict ...
Epoch: 7 cost time: 0.5238416194915771
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2849729 Best vali loss: 0.2849729
Updating learning rate to 0.0
Validation loss decreased (0.2850 --> 0.2849).  Saving model state dict ...
Epoch: 8 cost time: 0.6206691265106201
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2848771 Best vali loss: 0.2848771

best validation loss 0.2848770688539014

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0019332419074, 'e_layers': 1, 'learning_rate': 0.0002140554312, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3244525
	speed: 0.0096s/iter; left time: 79.3166s
	iters: 200, epoch: 1 | loss: 0.2485634
	speed: 0.0041s/iter; left time: 33.7052s
	iters: 300, epoch: 1 | loss: 0.4922997
	speed: 0.0025s/iter; left time: 20.3320s
	iters: 400, epoch: 1 | loss: 0.3993104
	speed: 0.0024s/iter; left time: 19.0488s
	iters: 500, epoch: 1 | loss: 0.3471816
	speed: 0.0022s/iter; left time: 17.0104s
	iters: 600, epoch: 1 | loss: 0.2436739
	speed: 0.0023s/iter; left time: 17.8918s
	iters: 700, epoch: 1 | loss: 1.0338460
	speed: 0.0029s/iter; left time: 22.4134s
	iters: 800, epoch: 1 | loss: 0.3026943
	speed: 0.0030s/iter; left time: 22.6190s
	iters: 900, epoch: 1 | loss: 0.5064805
	speed: 0.0030s/iter; left time: 22.1798s
	iters: 1000, epoch: 1 | loss: 0.2451138
	speed: 0.0030s/iter; left time: 21.7386s
Updating learning rate to 0.0002140554312
Validation loss decreased (inf --> 0.2823).  Saving model state dict ...
Epoch: 1 cost time: 3.3553707599639893
Epoch: 1, Steps: 1045 | Train Loss: 0.4143616 Vali Loss: 0.2822945 Best vali loss: 0.2822945
	iters: 100, epoch: 2 | loss: 0.4102099
	speed: 0.0122s/iter; left time: 87.8540s
	iters: 200, epoch: 2 | loss: 0.2336139
	speed: 0.0032s/iter; left time: 22.6999s
	iters: 300, epoch: 2 | loss: 0.3871800
	speed: 0.0032s/iter; left time: 22.2339s
	iters: 400, epoch: 2 | loss: 0.3630621
	speed: 0.0027s/iter; left time: 18.5015s
	iters: 500, epoch: 2 | loss: 0.5656124
	speed: 0.0027s/iter; left time: 18.6183s
	iters: 600, epoch: 2 | loss: 1.6391019
	speed: 0.0027s/iter; left time: 17.9795s
	iters: 700, epoch: 2 | loss: 0.2368035
	speed: 0.0030s/iter; left time: 19.8510s
	iters: 800, epoch: 2 | loss: 0.9607486
	speed: 0.0030s/iter; left time: 19.5416s
	iters: 900, epoch: 2 | loss: 0.3417330
	speed: 0.0030s/iter; left time: 19.2439s
	iters: 1000, epoch: 2 | loss: 0.3818009
	speed: 0.0030s/iter; left time: 18.9492s
Updating learning rate to 0.0001070277156
Validation loss decreased (0.2823 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 3.1320443153381348
Epoch: 2, Steps: 1045 | Train Loss: 0.5519866 Vali Loss: 0.2808603 Best vali loss: 0.2808603
	iters: 100, epoch: 3 | loss: 0.9180199
	speed: 0.0116s/iter; left time: 71.6675s
	iters: 200, epoch: 3 | loss: 0.2234865
	speed: 0.0029s/iter; left time: 17.8067s
	iters: 300, epoch: 3 | loss: 0.6376873
	speed: 0.0030s/iter; left time: 17.6623s
	iters: 400, epoch: 3 | loss: 0.3712967
	speed: 0.0025s/iter; left time: 14.4510s
	iters: 500, epoch: 3 | loss: 0.3175142
	speed: 0.0025s/iter; left time: 14.4833s
	iters: 600, epoch: 3 | loss: 0.9697277
	speed: 0.0026s/iter; left time: 14.5479s
	iters: 700, epoch: 3 | loss: 0.2395209
	speed: 0.0029s/iter; left time: 16.0122s
	iters: 800, epoch: 3 | loss: 0.2422856
	speed: 0.0029s/iter; left time: 16.1184s
	iters: 900, epoch: 3 | loss: 0.3013616
	speed: 0.0029s/iter; left time: 15.7995s
	iters: 1000, epoch: 3 | loss: 0.2578979
	speed: 0.0029s/iter; left time: 15.4129s
Updating learning rate to 5.35138578e-05
Epoch: 3 cost time: 2.98149037361145
Epoch: 3, Steps: 1045 | Train Loss: 0.4478798 Vali Loss: 0.2830522 Best vali loss: 0.2808603

best validation loss 0.2808602600901842

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0041151835701, 'e_layers': 1, 'learning_rate': 0.0005937223211, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3413339
	speed: 0.0083s/iter; left time: 68.7406s
	iters: 200, epoch: 1 | loss: 0.2252380
	speed: 0.0026s/iter; left time: 20.8471s
	iters: 300, epoch: 1 | loss: 0.6865284
	speed: 0.0030s/iter; left time: 24.2621s
	iters: 400, epoch: 1 | loss: 0.2836754
	speed: 0.0030s/iter; left time: 23.7235s
	iters: 500, epoch: 1 | loss: 1.1513903
	speed: 0.0030s/iter; left time: 23.2163s
	iters: 600, epoch: 1 | loss: 0.6725772
	speed: 0.0030s/iter; left time: 23.0077s
	iters: 700, epoch: 1 | loss: 0.2814749
	speed: 0.0030s/iter; left time: 22.7480s
	iters: 800, epoch: 1 | loss: 0.2278253
	speed: 0.0030s/iter; left time: 22.5375s
	iters: 900, epoch: 1 | loss: 1.1182935
	speed: 0.0030s/iter; left time: 22.2270s
	iters: 1000, epoch: 1 | loss: 1.6657745
	speed: 0.0030s/iter; left time: 21.8619s
Updating learning rate to 0.000571125110779692
Validation loss decreased (inf --> 0.2818).  Saving model state dict ...
Epoch: 1 cost time: 3.3351504802703857
Epoch: 1, Steps: 1045 | Train Loss: 0.6654111 Vali Loss: 0.2817548 Best vali loss: 0.2817548
	iters: 100, epoch: 2 | loss: 0.3126029
	speed: 0.0113s/iter; left time: 81.8826s
	iters: 200, epoch: 2 | loss: 0.1897906
	speed: 0.0028s/iter; left time: 19.8073s
	iters: 300, epoch: 2 | loss: 0.7013373
	speed: 0.0031s/iter; left time: 21.3988s
	iters: 400, epoch: 2 | loss: 0.4533313
	speed: 0.0031s/iter; left time: 21.5096s
	iters: 500, epoch: 2 | loss: 0.4533350
	speed: 0.0032s/iter; left time: 21.5759s
	iters: 600, epoch: 2 | loss: 0.6392578
	speed: 0.0031s/iter; left time: 21.0571s
	iters: 700, epoch: 2 | loss: 1.4406418
	speed: 0.0031s/iter; left time: 20.6072s
	iters: 800, epoch: 2 | loss: 0.2035931
	speed: 0.0030s/iter; left time: 19.5397s
	iters: 900, epoch: 2 | loss: 1.1200038
	speed: 0.0030s/iter; left time: 19.3737s
	iters: 1000, epoch: 2 | loss: 0.8728372
	speed: 0.0030s/iter; left time: 19.0240s
Updating learning rate to 0.0005067737002458133
Epoch: 2 cost time: 3.1988601684570312
Epoch: 2, Steps: 1045 | Train Loss: 0.6386731 Vali Loss: 0.2825157 Best vali loss: 0.2817548
	iters: 100, epoch: 3 | loss: 1.1705239
	speed: 0.0113s/iter; left time: 69.5478s
	iters: 200, epoch: 3 | loss: 0.3557279
	speed: 0.0026s/iter; left time: 15.9343s
	iters: 300, epoch: 3 | loss: 0.2204122
	speed: 0.0023s/iter; left time: 13.6423s
	iters: 400, epoch: 3 | loss: 0.2976641
	speed: 0.0023s/iter; left time: 13.3102s
	iters: 500, epoch: 3 | loss: 0.2831289
	speed: 0.0023s/iter; left time: 13.0278s
	iters: 600, epoch: 3 | loss: 0.1117325
	speed: 0.0028s/iter; left time: 16.1069s
	iters: 700, epoch: 3 | loss: 0.3477134
	speed: 0.0028s/iter; left time: 15.8495s
	iters: 800, epoch: 3 | loss: 0.4214406
	speed: 0.0027s/iter; left time: 14.9655s
	iters: 900, epoch: 3 | loss: 0.5541503
	speed: 0.0026s/iter; left time: 14.2033s
	iters: 1000, epoch: 3 | loss: 0.2292319
	speed: 0.0029s/iter; left time: 15.2765s
Updating learning rate to 0.00041046500840515797
Epoch: 3 cost time: 2.7881698608398438
Epoch: 3, Steps: 1045 | Train Loss: 0.3991726 Vali Loss: 0.2824538 Best vali loss: 0.2817548

best validation loss 0.2817547614244601

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9794468
	speed: 0.0085s/iter; left time: 17.0616s
	iters: 200, epoch: 1 | loss: 0.4898595
	speed: 0.0029s/iter; left time: 5.4415s
Updating learning rate to 0.000185960463
Validation loss decreased (inf --> 0.2761).  Saving model state dict ...
Epoch: 1 cost time: 1.0592293739318848
Epoch: 1, Steps: 262 | Train Loss: 0.7346531 Vali Loss: 0.2761382 Best vali loss: 0.2761382
	iters: 100, epoch: 2 | loss: 0.7599688
	speed: 0.0076s/iter; left time: 13.1025s
	iters: 200, epoch: 2 | loss: 0.2681506
	speed: 0.0030s/iter; left time: 4.9759s
Updating learning rate to 9.29802315e-05
Epoch: 2 cost time: 0.8382370471954346
Epoch: 2, Steps: 262 | Train Loss: 0.5140597 Vali Loss: 0.2780215 Best vali loss: 0.2761382
	iters: 100, epoch: 3 | loss: 0.2688558
	speed: 0.0076s/iter; left time: 11.1361s
	iters: 200, epoch: 3 | loss: 0.5461835
	speed: 0.0030s/iter; left time: 4.1170s
Updating learning rate to 4.649011575e-05
Epoch: 3 cost time: 0.8327326774597168
Epoch: 3, Steps: 262 | Train Loss: 0.4075197 Vali Loss: 0.2803170 Best vali loss: 0.2761382

best validation loss 0.27613815278723675

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7160526
	speed: 0.0088s/iter; left time: 10.6542s
	iters: 200, epoch: 4 | loss: 0.5041794
	speed: 0.0031s/iter; left time: 3.3995s
Updating learning rate to 2.3245057875e-05
Epoch: 4 cost time: 1.0893430709838867
Epoch: 4, Steps: 262 | Train Loss: 0.6101160 Vali Loss: 0.2830880 Best vali loss: 0.2761382
	iters: 100, epoch: 5 | loss: 0.6010026
	speed: 0.0073s/iter; left time: 6.8978s
	iters: 200, epoch: 5 | loss: 0.2575765
	speed: 0.0026s/iter; left time: 2.1988s
Updating learning rate to 1.16225289375e-05
Epoch: 5 cost time: 0.772986888885498
Epoch: 5, Steps: 262 | Train Loss: 0.4292896 Vali Loss: 0.2838593 Best vali loss: 0.2761382
	iters: 100, epoch: 6 | loss: 0.2543968
	speed: 0.0088s/iter; left time: 6.0232s
	iters: 200, epoch: 6 | loss: 0.4827766
	speed: 0.0036s/iter; left time: 2.1118s
Updating learning rate to 5.81126446875e-06
Epoch: 6 cost time: 0.9708766937255859
Epoch: 6, Steps: 262 | Train Loss: 0.3685867 Vali Loss: 0.2843191 Best vali loss: 0.2761382
	iters: 100, epoch: 7 | loss: 0.2391052
	speed: 0.0095s/iter; left time: 4.0520s
	iters: 200, epoch: 7 | loss: 0.5023280
	speed: 0.0038s/iter; left time: 1.2203s
Updating learning rate to 2.905632234375e-06
Epoch: 7 cost time: 1.001819133758545
Epoch: 7, Steps: 262 | Train Loss: 0.3707166 Vali Loss: 0.2868033 Best vali loss: 0.2761382
	iters: 100, epoch: 8 | loss: 0.2655461
	speed: 0.0097s/iter; left time: 1.5771s
	iters: 200, epoch: 8 | loss: 0.3765639
	speed: 0.0036s/iter; left time: 0.2257s
Updating learning rate to 1.4528161171875e-06
Epoch: 8 cost time: 1.0654962062835693
Epoch: 8, Steps: 262 | Train Loss: 0.3210550 Vali Loss: 0.2864153 Best vali loss: 0.2761382

best validation loss 0.27613815278723675

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083070963017, 'e_layers': 1, 'learning_rate': 0.0006773932069, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3681406
	speed: 0.0081s/iter; left time: 16.2102s
	iters: 200, epoch: 1 | loss: 0.4484552
	speed: 0.0026s/iter; left time: 4.8970s
Updating learning rate to 0.0006516114631085467
Validation loss decreased (inf --> 0.2863).  Saving model state dict ...
Epoch: 1 cost time: 0.9641473293304443
Epoch: 1, Steps: 262 | Train Loss: 0.4082979 Vali Loss: 0.2863057 Best vali loss: 0.2863057
	iters: 100, epoch: 2 | loss: 0.4169223
	speed: 0.0066s/iter; left time: 11.4739s
	iters: 200, epoch: 2 | loss: 0.4453387
	speed: 0.0026s/iter; left time: 4.3092s
Updating learning rate to 0.000578191268514346
Validation loss decreased (0.2863 --> 0.2844).  Saving model state dict ...
Epoch: 2 cost time: 0.7365694046020508
Epoch: 2, Steps: 262 | Train Loss: 0.4311305 Vali Loss: 0.2843789 Best vali loss: 0.2843789
	iters: 100, epoch: 3 | loss: 0.7077350
	speed: 0.0114s/iter; left time: 16.7949s
	iters: 200, epoch: 3 | loss: 0.5186777
	speed: 0.0064s/iter; left time: 8.7880s
Updating learning rate to 0.0004683101821886438
Epoch: 3 cost time: 1.4005486965179443
Epoch: 3, Steps: 262 | Train Loss: 0.6132063 Vali Loss: 0.2924821 Best vali loss: 0.2843789
	iters: 100, epoch: 4 | loss: 0.8127211
	speed: 0.0108s/iter; left time: 13.0642s
	iters: 200, epoch: 4 | loss: 0.6629570
	speed: 0.0026s/iter; left time: 2.8646s
Updating learning rate to 0.00033869660345
Epoch: 4 cost time: 0.7531101703643799
Epoch: 4, Steps: 262 | Train Loss: 0.7378390 Vali Loss: 0.2886571 Best vali loss: 0.2843789
	iters: 100, epoch: 5 | loss: 0.5963956
	speed: 0.0069s/iter; left time: 6.5796s
	iters: 200, epoch: 5 | loss: 0.4699751
	speed: 0.0030s/iter; left time: 2.5732s
Updating learning rate to 0.00020908302471135632
Epoch: 5 cost time: 0.8317348957061768
Epoch: 5, Steps: 262 | Train Loss: 0.5331853 Vali Loss: 0.2881283 Best vali loss: 0.2843789
	iters: 100, epoch: 6 | loss: 0.2939649
	speed: 0.0075s/iter; left time: 5.1576s
	iters: 200, epoch: 6 | loss: 0.3666129
	speed: 0.0030s/iter; left time: 1.7542s
Updating learning rate to 9.920193838565403e-05
Epoch: 6 cost time: 0.841231107711792
Epoch: 6, Steps: 262 | Train Loss: 0.3302889 Vali Loss: 0.2897625 Best vali loss: 0.2843789
	iters: 100, epoch: 7 | loss: 0.2688872
	speed: 0.0071s/iter; left time: 3.0127s
	iters: 200, epoch: 7 | loss: 0.2826746
	speed: 0.0030s/iter; left time: 0.9823s
Updating learning rate to 2.5781743791453334e-05
Epoch: 7 cost time: 0.8458812236785889
Epoch: 7, Steps: 262 | Train Loss: 0.2757809 Vali Loss: 0.2914476 Best vali loss: 0.2843789
	iters: 100, epoch: 8 | loss: 0.4940513
	speed: 0.0073s/iter; left time: 1.1951s
	iters: 200, epoch: 8 | loss: 0.8033261
	speed: 0.0030s/iter; left time: 0.1906s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8169903755187988
Epoch: 8, Steps: 262 | Train Loss: 0.6486887 Vali Loss: 0.2922084 Best vali loss: 0.2843789

best validation loss 0.2843788897361663

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0029408778774, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 9.673369630655839e-05
Validation loss decreased (inf --> 0.2974).  Saving model state dict ...
Epoch: 1 cost time: 0.5194635391235352
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2973941 Best vali loss: 0.2973941
Updating learning rate to 8.583424593046713e-05
Validation loss decreased (0.2974 --> 0.2848).  Saving model state dict ...
Epoch: 2 cost time: 0.28183627128601074
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2847892 Best vali loss: 0.2847892
Updating learning rate to 6.952206568772242e-05
Validation loss decreased (0.2848 --> 0.2817).  Saving model state dict ...
Epoch: 3 cost time: 0.28368449211120605
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2816925 Best vali loss: 0.2816925
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.2817 --> 0.2801).  Saving model state dict ...
Epoch: 4 cost time: 0.29279565811157227
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2800910 Best vali loss: 0.2800910
Updating learning rate to 3.10390086122776e-05
Validation loss decreased (0.2801 --> 0.2799).  Saving model state dict ...
Epoch: 5 cost time: 0.28678441047668457
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2799277 Best vali loss: 0.2799277
Updating learning rate to 1.472682836953288e-05
Epoch: 6 cost time: 0.30988645553588867
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2801415 Best vali loss: 0.2799277
Updating learning rate to 3.827377993441614e-06
Epoch: 7 cost time: 0.29347872734069824
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2802064 Best vali loss: 0.2799277
Updating learning rate to 0.0
Epoch: 8 cost time: 0.28615450859069824
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2801840 Best vali loss: 0.2799277

best validation loss 0.2799276817283829

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0114311397825, 'e_layers': 2, 'learning_rate': 0.0007346262927, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007346262927
Validation loss decreased (inf --> 0.2906).  Saving model state dict ...
Epoch: 1 cost time: 0.8843655586242676
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2905662 Best vali loss: 0.2905662
Updating learning rate to 0.00036731314635
Validation loss decreased (0.2906 --> 0.2846).  Saving model state dict ...
Epoch: 2 cost time: 0.6272048950195312
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2846304 Best vali loss: 0.2846304
Updating learning rate to 0.000183656573175
Validation loss decreased (0.2846 --> 0.2834).  Saving model state dict ...
Epoch: 3 cost time: 0.6241199970245361
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2833874 Best vali loss: 0.2833874

best validation loss 0.28338739109963634

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0008016835459, 'e_layers': 1, 'learning_rate': 0.0006601321641, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0144461
	speed: 0.0086s/iter; left time: 35.3187s
	iters: 200, epoch: 1 | loss: 0.3977511
	speed: 0.0033s/iter; left time: 13.0715s
	iters: 300, epoch: 1 | loss: 1.0634480
	speed: 0.0031s/iter; left time: 12.1478s
	iters: 400, epoch: 1 | loss: 0.5101697
	speed: 0.0031s/iter; left time: 11.7742s
	iters: 500, epoch: 1 | loss: 0.8350069
	speed: 0.0031s/iter; left time: 11.5712s
Updating learning rate to 0.0006601321641
Validation loss decreased (inf --> 0.2886).  Saving model state dict ...
Epoch: 1 cost time: 1.9227790832519531
Epoch: 1, Steps: 523 | Train Loss: 0.7641644 Vali Loss: 0.2886391 Best vali loss: 0.2886391
	iters: 100, epoch: 2 | loss: 0.2784535
	speed: 0.0073s/iter; left time: 26.0105s
	iters: 200, epoch: 2 | loss: 0.2446280
	speed: 0.0030s/iter; left time: 10.5423s
	iters: 300, epoch: 2 | loss: 0.5199344
	speed: 0.0029s/iter; left time: 9.7174s
	iters: 400, epoch: 2 | loss: 0.6647430
	speed: 0.0029s/iter; left time: 9.5598s
	iters: 500, epoch: 2 | loss: 1.0223925
	speed: 0.0030s/iter; left time: 9.4143s
Updating learning rate to 0.00033006608205
Validation loss decreased (0.2886 --> 0.2839).  Saving model state dict ...
Epoch: 2 cost time: 1.6101140975952148
Epoch: 2, Steps: 523 | Train Loss: 0.5460303 Vali Loss: 0.2838548 Best vali loss: 0.2838548
	iters: 100, epoch: 3 | loss: 0.4297843
	speed: 0.0068s/iter; left time: 20.8152s
	iters: 200, epoch: 3 | loss: 0.2937133
	speed: 0.0030s/iter; left time: 8.8170s
	iters: 300, epoch: 3 | loss: 0.4758385
	speed: 0.0031s/iter; left time: 8.7163s
	iters: 400, epoch: 3 | loss: 0.3156143
	speed: 0.0031s/iter; left time: 8.5146s
	iters: 500, epoch: 3 | loss: 0.4669832
	speed: 0.0031s/iter; left time: 8.1801s
Updating learning rate to 0.000165033041025
Epoch: 3 cost time: 1.6057438850402832
Epoch: 3, Steps: 523 | Train Loss: 0.3963867 Vali Loss: 0.2917751 Best vali loss: 0.2838548

best validation loss 0.2838547622882642

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0019750620614, 'e_layers': 1, 'learning_rate': 0.0043772257118, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6842585
	speed: 0.0083s/iter; left time: 34.0968s
	iters: 200, epoch: 1 | loss: 1.0921344
	speed: 0.0029s/iter; left time: 11.4607s
	iters: 300, epoch: 1 | loss: 0.6721243
	speed: 0.0026s/iter; left time: 10.1371s
	iters: 400, epoch: 1 | loss: 0.2904699
	speed: 0.0025s/iter; left time: 9.2970s
	iters: 500, epoch: 1 | loss: 0.6535326
	speed: 0.0027s/iter; left time: 10.1193s
Updating learning rate to 0.0043772257118
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 1.696143627166748
Epoch: 1, Steps: 523 | Train Loss: 0.6785039 Vali Loss: 0.2864036 Best vali loss: 0.2864036
	iters: 100, epoch: 2 | loss: 0.5302456
	speed: 0.0076s/iter; left time: 27.0494s
	iters: 200, epoch: 2 | loss: 0.3801154
	speed: 0.0029s/iter; left time: 10.0953s
	iters: 300, epoch: 2 | loss: 0.6807789
	speed: 0.0029s/iter; left time: 9.6473s
	iters: 400, epoch: 2 | loss: 0.2543432
	speed: 0.0025s/iter; left time: 8.3036s
	iters: 500, epoch: 2 | loss: 0.7389907
	speed: 0.0025s/iter; left time: 7.7552s
Updating learning rate to 0.0021886128559
Validation loss decreased (0.2864 --> 0.2830).  Saving model state dict ...
Epoch: 2 cost time: 1.4716086387634277
Epoch: 2, Steps: 523 | Train Loss: 0.5168948 Vali Loss: 0.2830032 Best vali loss: 0.2830032
	iters: 100, epoch: 3 | loss: 0.4324061
	speed: 0.0061s/iter; left time: 18.6249s
	iters: 200, epoch: 3 | loss: 0.4610946
	speed: 0.0030s/iter; left time: 8.7815s
	iters: 300, epoch: 3 | loss: 0.2244043
	speed: 0.0032s/iter; left time: 8.9549s
	iters: 400, epoch: 3 | loss: 0.7291557
	speed: 0.0032s/iter; left time: 8.6378s
	iters: 500, epoch: 3 | loss: 0.3774091
	speed: 0.0031s/iter; left time: 8.1456s
Updating learning rate to 0.00109430642795
Validation loss decreased (0.2830 --> 0.2823).  Saving model state dict ...
Epoch: 3 cost time: 1.6106927394866943
Epoch: 3, Steps: 523 | Train Loss: 0.4448940 Vali Loss: 0.2823173 Best vali loss: 0.2823173

best validation loss 0.2823173053293877

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0019750620614, 'e_layers': 1, 'learning_rate': 0.0043772257118, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6098739
	speed: 0.0083s/iter; left time: 20.9366s
	iters: 200, epoch: 4 | loss: 0.7675221
	speed: 0.0028s/iter; left time: 6.6661s
	iters: 300, epoch: 4 | loss: 0.6684827
	speed: 0.0030s/iter; left time: 6.9545s
	iters: 400, epoch: 4 | loss: 0.3022030
	speed: 0.0030s/iter; left time: 6.6778s
	iters: 500, epoch: 4 | loss: 0.5750503
	speed: 0.0030s/iter; left time: 6.3512s
Updating learning rate to 0.000547153213975
Epoch: 4 cost time: 1.7998740673065186
Epoch: 4, Steps: 523 | Train Loss: 0.5846264 Vali Loss: 0.2829627 Best vali loss: 0.2823173
	iters: 100, epoch: 5 | loss: 0.5145454
	speed: 0.0077s/iter; left time: 15.4162s
	iters: 200, epoch: 5 | loss: 0.3723375
	speed: 0.0028s/iter; left time: 5.2972s
	iters: 300, epoch: 5 | loss: 0.6764036
	speed: 0.0029s/iter; left time: 5.2192s
	iters: 400, epoch: 5 | loss: 0.2261025
	speed: 0.0027s/iter; left time: 4.5171s
	iters: 500, epoch: 5 | loss: 0.5852022
	speed: 0.0027s/iter; left time: 4.3343s
Updating learning rate to 0.0002735766069875
Epoch: 5 cost time: 1.4908130168914795
Epoch: 5, Steps: 523 | Train Loss: 0.4749182 Vali Loss: 0.2862775 Best vali loss: 0.2823173
	iters: 100, epoch: 6 | loss: 0.3953879
	speed: 0.0076s/iter; left time: 11.2014s
	iters: 200, epoch: 6 | loss: 0.3939239
	speed: 0.0030s/iter; left time: 4.1499s
	iters: 300, epoch: 6 | loss: 0.2075796
	speed: 0.0031s/iter; left time: 3.9327s
	iters: 400, epoch: 6 | loss: 0.7030435
	speed: 0.0030s/iter; left time: 3.5456s
	iters: 500, epoch: 6 | loss: 0.3747357
	speed: 0.0030s/iter; left time: 3.2129s
Updating learning rate to 0.00013678830349375
Epoch: 6 cost time: 1.6320250034332275
Epoch: 6, Steps: 523 | Train Loss: 0.4149341 Vali Loss: 0.2833754 Best vali loss: 0.2823173
	iters: 100, epoch: 7 | loss: 0.4052512
	speed: 0.0073s/iter; left time: 6.9500s
	iters: 200, epoch: 7 | loss: 0.4298990
	speed: 0.0027s/iter; left time: 2.3128s
	iters: 300, epoch: 7 | loss: 0.2613336
	speed: 0.0029s/iter; left time: 2.1642s
	iters: 400, epoch: 7 | loss: 0.3634375
	speed: 0.0027s/iter; left time: 1.7580s
	iters: 500, epoch: 7 | loss: 0.7904944
	speed: 0.0028s/iter; left time: 1.5052s
Updating learning rate to 6.8394151746875e-05
Epoch: 7 cost time: 1.5010790824890137
Epoch: 7, Steps: 523 | Train Loss: 0.4500832 Vali Loss: 0.2844766 Best vali loss: 0.2823173
	iters: 100, epoch: 8 | loss: 0.5496765
	speed: 0.0075s/iter; left time: 3.1946s
	iters: 200, epoch: 8 | loss: 0.4818623
	speed: 0.0031s/iter; left time: 0.9919s
	iters: 300, epoch: 8 | loss: 0.5586652
	speed: 0.0031s/iter; left time: 0.7014s
	iters: 400, epoch: 8 | loss: 0.5467811
	speed: 0.0029s/iter; left time: 0.3612s
	iters: 500, epoch: 8 | loss: 0.3258886
	speed: 0.0028s/iter; left time: 0.0679s
Updating learning rate to 3.41970758734375e-05
Epoch: 8 cost time: 1.6001503467559814
Epoch: 8, Steps: 523 | Train Loss: 0.4925748 Vali Loss: 0.2847010 Best vali loss: 0.2823173

best validation loss 0.2823173053293877

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0071994713635, 'e_layers': 3, 'learning_rate': 0.000446018847, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4006999
	speed: 0.0108s/iter; left time: 43.9562s
	iters: 200, epoch: 1 | loss: 0.5182685
	speed: 0.0054s/iter; left time: 21.4157s
	iters: 300, epoch: 1 | loss: 0.8248591
	speed: 0.0052s/iter; left time: 20.0093s
	iters: 400, epoch: 1 | loss: 0.4782610
	speed: 0.0051s/iter; left time: 19.4682s
	iters: 500, epoch: 1 | loss: 0.3478740
	speed: 0.0046s/iter; left time: 17.1221s
Updating learning rate to 0.000446018847
Validation loss decreased (inf --> 0.2834).  Saving model state dict ...
Epoch: 1 cost time: 2.9411725997924805
Epoch: 1, Steps: 523 | Train Loss: 0.5139925 Vali Loss: 0.2834056 Best vali loss: 0.2834056
	iters: 100, epoch: 2 | loss: 0.2939953
	speed: 0.0111s/iter; left time: 39.5930s
	iters: 200, epoch: 2 | loss: 0.3437473
	speed: 0.0050s/iter; left time: 17.4216s
	iters: 300, epoch: 2 | loss: 0.2362405
	speed: 0.0051s/iter; left time: 17.0866s
	iters: 400, epoch: 2 | loss: 0.8092239
	speed: 0.0050s/iter; left time: 16.4578s
	iters: 500, epoch: 2 | loss: 0.3280910
	speed: 0.0047s/iter; left time: 14.7435s
Updating learning rate to 0.0002230094235
Validation loss decreased (0.2834 --> 0.2821).  Saving model state dict ...
Epoch: 2 cost time: 2.6464192867279053
Epoch: 2, Steps: 523 | Train Loss: 0.4022596 Vali Loss: 0.2821045 Best vali loss: 0.2821045
	iters: 100, epoch: 3 | loss: 0.3560370
	speed: 0.0110s/iter; left time: 33.5352s
	iters: 200, epoch: 3 | loss: 0.3198207
	speed: 0.0052s/iter; left time: 15.3117s
	iters: 300, epoch: 3 | loss: 0.7525662
	speed: 0.0052s/iter; left time: 14.8331s
	iters: 400, epoch: 3 | loss: 0.6898289
	speed: 0.0052s/iter; left time: 14.2736s
	iters: 500, epoch: 3 | loss: 0.8521971
	speed: 0.0045s/iter; left time: 11.9772s
Updating learning rate to 0.00011150471175
Epoch: 3 cost time: 2.678910255432129
Epoch: 3, Steps: 523 | Train Loss: 0.5940900 Vali Loss: 0.2835749 Best vali loss: 0.2821045
	iters: 100, epoch: 4 | loss: 0.5704032
	speed: 0.0110s/iter; left time: 27.7689s
	iters: 200, epoch: 4 | loss: 0.3777690
	speed: 0.0053s/iter; left time: 12.7797s
	iters: 300, epoch: 4 | loss: 0.4720676
	speed: 0.0053s/iter; left time: 12.2742s
	iters: 400, epoch: 4 | loss: 0.2712078
	speed: 0.0053s/iter; left time: 11.6593s
	iters: 500, epoch: 4 | loss: 0.3148436
	speed: 0.0046s/iter; left time: 9.6539s
Updating learning rate to 5.5752355875e-05
Epoch: 4 cost time: 2.7173044681549072
Epoch: 4, Steps: 523 | Train Loss: 0.4012582 Vali Loss: 0.2828646 Best vali loss: 0.2821045
	iters: 100, epoch: 5 | loss: 0.4094167
	speed: 0.0085s/iter; left time: 16.9439s
	iters: 200, epoch: 5 | loss: 0.2931612
	speed: 0.0054s/iter; left time: 10.2412s
	iters: 300, epoch: 5 | loss: 0.3135646
	speed: 0.0051s/iter; left time: 9.1754s
	iters: 400, epoch: 5 | loss: 0.9708979
	speed: 0.0058s/iter; left time: 9.7966s
	iters: 500, epoch: 5 | loss: 0.8983470
	speed: 0.0050s/iter; left time: 7.9546s
Updating learning rate to 2.78761779375e-05
Epoch: 5 cost time: 2.690091133117676
Epoch: 5, Steps: 523 | Train Loss: 0.5770775 Vali Loss: 0.2851597 Best vali loss: 0.2821045
	iters: 100, epoch: 6 | loss: 0.2137988
	speed: 0.0130s/iter; left time: 19.1266s
	iters: 200, epoch: 6 | loss: 0.3313980
	speed: 0.0055s/iter; left time: 7.4878s
	iters: 300, epoch: 6 | loss: 0.5985197
	speed: 0.0061s/iter; left time: 7.7660s
	iters: 400, epoch: 6 | loss: 0.2800498
	speed: 0.0060s/iter; left time: 6.9622s
	iters: 500, epoch: 6 | loss: 0.5012527
	speed: 0.0054s/iter; left time: 5.7476s
Updating learning rate to 1.393808896875e-05
Epoch: 6 cost time: 3.067826509475708
Epoch: 6, Steps: 523 | Train Loss: 0.3850038 Vali Loss: 0.2838838 Best vali loss: 0.2821045
	iters: 100, epoch: 7 | loss: 0.2738431
	speed: 0.0130s/iter; left time: 12.3020s
	iters: 200, epoch: 7 | loss: 0.7032743
	speed: 0.0045s/iter; left time: 3.8489s
	iters: 300, epoch: 7 | loss: 0.2452950
	speed: 0.0037s/iter; left time: 2.7399s
	iters: 400, epoch: 7 | loss: 0.7003459
	speed: 0.0043s/iter; left time: 2.7606s
	iters: 500, epoch: 7 | loss: 0.4036873
	speed: 0.0073s/iter; left time: 3.9659s
Updating learning rate to 6.969044484375e-06
Epoch: 7 cost time: 2.77175235748291
Epoch: 7, Steps: 523 | Train Loss: 0.4652891 Vali Loss: 0.2839217 Best vali loss: 0.2821045
	iters: 100, epoch: 8 | loss: 0.2957675
	speed: 0.0151s/iter; left time: 6.4147s
	iters: 200, epoch: 8 | loss: 0.7483110
	speed: 0.0073s/iter; left time: 2.3630s
	iters: 300, epoch: 8 | loss: 0.2883750
	speed: 0.0073s/iter; left time: 1.6398s
	iters: 400, epoch: 8 | loss: 0.5456970
	speed: 0.0061s/iter; left time: 0.7588s
	iters: 500, epoch: 8 | loss: 0.2083246
	speed: 0.0069s/iter; left time: 0.1665s
Updating learning rate to 3.4845222421875e-06
Epoch: 8 cost time: 3.5176079273223877
Epoch: 8, Steps: 523 | Train Loss: 0.4172950 Vali Loss: 0.2839952 Best vali loss: 0.2821045

best validation loss 0.28210445334140855

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029631840606, 'e_layers': 3, 'learning_rate': 7.97883763e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3715720
	speed: 0.0109s/iter; left time: 10.3312s
Updating learning rate to 7.675161204793932e-05
Validation loss decreased (inf --> 0.2824).  Saving model state dict ...
Epoch: 1 cost time: 1.0496540069580078
Epoch: 1, Steps: 131 | Train Loss: 0.3715720 Vali Loss: 0.2824298 Best vali loss: 0.2824298
	iters: 100, epoch: 2 | loss: 0.6397701
	speed: 0.0130s/iter; left time: 10.6136s
Updating learning rate to 6.810363912079701e-05
Validation loss decreased (0.2824 --> 0.2800).  Saving model state dict ...
Epoch: 2 cost time: 1.032259225845337
Epoch: 2, Steps: 131 | Train Loss: 0.6397701 Vali Loss: 0.2799870 Best vali loss: 0.2799870
	iters: 100, epoch: 3 | loss: 0.2671913
	speed: 0.0125s/iter; left time: 8.5824s
Updating learning rate to 5.51610330026607e-05
Validation loss decreased (0.2800 --> 0.2779).  Saving model state dict ...
Epoch: 3 cost time: 0.9779069423675537
Epoch: 3, Steps: 131 | Train Loss: 0.2671913 Vali Loss: 0.2778915 Best vali loss: 0.2778915
	iters: 100, epoch: 4 | loss: 0.4145801
	speed: 0.0090s/iter; left time: 5.0208s
Updating learning rate to 3.989418815e-05
Epoch: 4 cost time: 0.6764116287231445
Epoch: 4, Steps: 131 | Train Loss: 0.4145801 Vali Loss: 0.2800496 Best vali loss: 0.2778915
	iters: 100, epoch: 5 | loss: 0.6332209
	speed: 0.0095s/iter; left time: 4.0438s
Updating learning rate to 2.4627343297339313e-05
Epoch: 5 cost time: 0.8278231620788574
Epoch: 5, Steps: 131 | Train Loss: 0.6332209 Vali Loss: 0.2780945 Best vali loss: 0.2778915
	iters: 100, epoch: 6 | loss: 0.3740870
	speed: 0.0101s/iter; left time: 2.9815s
Updating learning rate to 1.1684737179202996e-05
Epoch: 6 cost time: 0.8258545398712158
Epoch: 6, Steps: 131 | Train Loss: 0.3740870 Vali Loss: 0.2790372 Best vali loss: 0.2778915
	iters: 100, epoch: 7 | loss: 0.4291545
	speed: 0.0101s/iter; left time: 1.6475s
Updating learning rate to 3.036764252060685e-06
Epoch: 7 cost time: 0.8303017616271973
Epoch: 7, Steps: 131 | Train Loss: 0.4291545 Vali Loss: 0.2779342 Best vali loss: 0.2778915
	iters: 100, epoch: 8 | loss: 0.5237037
	speed: 0.0102s/iter; left time: 0.3261s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8190097808837891
Epoch: 8, Steps: 131 | Train Loss: 0.5237037 Vali Loss: 0.2783726 Best vali loss: 0.2778915

best validation loss 0.27789149799946294

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047463729232, 'e_layers': 4, 'learning_rate': 9.71227879e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7630566
	speed: 0.0126s/iter; left time: 25.1519s
	iters: 200, epoch: 1 | loss: 0.4988492
	speed: 0.0073s/iter; left time: 13.9090s
Updating learning rate to 9.342627189062243e-05
Validation loss decreased (inf --> 0.2788).  Saving model state dict ...
Epoch: 1 cost time: 2.178224563598633
Epoch: 1, Steps: 262 | Train Loss: 0.6309529 Vali Loss: 0.2787598 Best vali loss: 0.2787598
	iters: 100, epoch: 2 | loss: 0.8156170
	speed: 0.0164s/iter; left time: 28.4690s
	iters: 200, epoch: 2 | loss: 0.3333054
	speed: 0.0077s/iter; left time: 12.5436s
Updating learning rate to 8.289948491591637e-05
Epoch: 2 cost time: 2.0554561614990234
Epoch: 2, Steps: 262 | Train Loss: 0.5744612 Vali Loss: 0.2795040 Best vali loss: 0.2787598
	iters: 100, epoch: 3 | loss: 0.6175528
	speed: 0.0163s/iter; left time: 23.9456s
	iters: 200, epoch: 3 | loss: 0.2877244
	speed: 0.0078s/iter; left time: 10.6728s
Updating learning rate to 6.714503486721931e-05
Epoch: 3 cost time: 2.0732154846191406
Epoch: 3, Steps: 262 | Train Loss: 0.4526386 Vali Loss: 0.2842395 Best vali loss: 0.2787598

best validation loss 0.2787598380261347

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.000356589613, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6053609
	speed: 0.0094s/iter; left time: 8.9243s
Updating learning rate to 0.0003430177289784103
Validation loss decreased (inf --> 0.2822).  Saving model state dict ...
Epoch: 1 cost time: 0.790759801864624
Epoch: 1, Steps: 131 | Train Loss: 0.6053609 Vali Loss: 0.2822339 Best vali loss: 0.2822339
	iters: 100, epoch: 2 | loss: 0.5492461
	speed: 0.0076s/iter; left time: 6.1923s
Updating learning rate to 0.0003043682732264933
Epoch: 2 cost time: 0.5633325576782227
Epoch: 2, Steps: 131 | Train Loss: 0.5492461 Vali Loss: 0.2876413 Best vali loss: 0.2822339
	iters: 100, epoch: 3 | loss: 0.4284714
	speed: 0.0075s/iter; left time: 5.1495s
Updating learning rate to 0.0002465252750242895
Epoch: 3 cost time: 0.5745561122894287
Epoch: 3, Steps: 131 | Train Loss: 0.4284714 Vali Loss: 0.2893296 Best vali loss: 0.2822339

best validation loss 0.2822338616307139

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0090271357217, 'e_layers': 2, 'learning_rate': 9.03274957e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3080674
	speed: 0.0102s/iter; left time: 84.2634s
	iters: 200, epoch: 1 | loss: 0.2172310
	speed: 0.0047s/iter; left time: 38.5863s
	iters: 300, epoch: 1 | loss: 0.3254355
	speed: 0.0046s/iter; left time: 37.2887s
	iters: 400, epoch: 1 | loss: 1.7950619
	speed: 0.0046s/iter; left time: 36.3702s
	iters: 500, epoch: 1 | loss: 0.9429430
	speed: 0.0036s/iter; left time: 28.2373s
	iters: 600, epoch: 1 | loss: 0.3527693
	speed: 0.0038s/iter; left time: 29.4972s
	iters: 700, epoch: 1 | loss: 0.2294330
	speed: 0.0033s/iter; left time: 25.2834s
	iters: 800, epoch: 1 | loss: 0.2667352
	speed: 0.0029s/iter; left time: 22.2840s
	iters: 900, epoch: 1 | loss: 0.7243515
	speed: 0.0030s/iter; left time: 22.3840s
	iters: 1000, epoch: 1 | loss: 0.4398471
	speed: 0.0043s/iter; left time: 31.7339s
Updating learning rate to 9.03274957e-05
Validation loss decreased (inf --> 0.2795).  Saving model state dict ...
Epoch: 1 cost time: 4.5715248584747314
Epoch: 1, Steps: 1045 | Train Loss: 0.5601875 Vali Loss: 0.2794782 Best vali loss: 0.2794782
	iters: 100, epoch: 2 | loss: 0.2408188
	speed: 0.0229s/iter; left time: 165.2609s
	iters: 200, epoch: 2 | loss: 0.3962848
	speed: 0.0074s/iter; left time: 52.3191s
	iters: 300, epoch: 2 | loss: 0.2795640
	speed: 0.0073s/iter; left time: 51.5245s
	iters: 400, epoch: 2 | loss: 0.3479434
	speed: 0.0046s/iter; left time: 31.8944s
	iters: 500, epoch: 2 | loss: 0.9468068
	speed: 0.0065s/iter; left time: 44.0532s
	iters: 600, epoch: 2 | loss: 0.9379749
	speed: 0.0074s/iter; left time: 49.6740s
	iters: 700, epoch: 2 | loss: 0.3541157
	speed: 0.0071s/iter; left time: 47.0290s
	iters: 800, epoch: 2 | loss: 0.3810711
	speed: 0.0034s/iter; left time: 21.9481s
	iters: 900, epoch: 2 | loss: 0.3937421
	speed: 0.0072s/iter; left time: 45.9690s
	iters: 1000, epoch: 2 | loss: 0.9277874
	speed: 0.0074s/iter; left time: 46.6072s
Updating learning rate to 4.516374785e-05
Epoch: 2 cost time: 6.724333763122559
Epoch: 2, Steps: 1045 | Train Loss: 0.5206109 Vali Loss: 0.2806779 Best vali loss: 0.2794782
	iters: 100, epoch: 3 | loss: 0.4429431
	speed: 0.0234s/iter; left time: 144.4077s
	iters: 200, epoch: 3 | loss: 0.3922188
	speed: 0.0056s/iter; left time: 34.1278s
	iters: 300, epoch: 3 | loss: 0.4246268
	speed: 0.0032s/iter; left time: 19.0356s
	iters: 400, epoch: 3 | loss: 0.3702457
	speed: 0.0029s/iter; left time: 17.1082s
	iters: 500, epoch: 3 | loss: 1.0119553
	speed: 0.0028s/iter; left time: 16.2700s
	iters: 600, epoch: 3 | loss: 0.2269091
	speed: 0.0030s/iter; left time: 16.8403s
	iters: 700, epoch: 3 | loss: 0.7914205
	speed: 0.0028s/iter; left time: 15.6591s
	iters: 800, epoch: 3 | loss: 0.2791332
	speed: 0.0028s/iter; left time: 15.4516s
	iters: 900, epoch: 3 | loss: 1.0203757
	speed: 0.0028s/iter; left time: 15.2328s
	iters: 1000, epoch: 3 | loss: 0.3112182
	speed: 0.0030s/iter; left time: 15.8728s
Updating learning rate to 2.2581873925e-05
Epoch: 3 cost time: 3.8551599979400635
Epoch: 3, Steps: 1045 | Train Loss: 0.5271046 Vali Loss: 0.3149319 Best vali loss: 0.2794782

best validation loss 0.27947818249874107

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047463729232, 'e_layers': 4, 'learning_rate': 9.71227879e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5675344
	speed: 0.0139s/iter; left time: 16.7775s
	iters: 200, epoch: 4 | loss: 0.4746862
	speed: 0.0069s/iter; left time: 7.6746s
Updating learning rate to 4.856139395e-05
Epoch: 4 cost time: 2.2486798763275146
Epoch: 4, Steps: 262 | Train Loss: 0.5211103 Vali Loss: 0.2927918 Best vali loss: 0.2787598
	iters: 100, epoch: 5 | loss: 0.6152064
	speed: 0.0157s/iter; left time: 14.8898s
	iters: 200, epoch: 5 | loss: 0.3035879
	speed: 0.0077s/iter; left time: 6.5044s
Updating learning rate to 2.9977753032780698e-05
Epoch: 5 cost time: 1.9944310188293457
Epoch: 5, Steps: 262 | Train Loss: 0.4593972 Vali Loss: 0.2791490 Best vali loss: 0.2787598
	iters: 100, epoch: 6 | loss: 0.4780000
	speed: 0.0150s/iter; left time: 10.2846s
	iters: 200, epoch: 6 | loss: 0.2689971
	speed: 0.0080s/iter; left time: 4.7237s
Updating learning rate to 1.422330298408362e-05
Epoch: 6 cost time: 2.0117785930633545
Epoch: 6, Steps: 262 | Train Loss: 0.3734986 Vali Loss: 0.2802084 Best vali loss: 0.2787598
	iters: 100, epoch: 7 | loss: 0.3480917
	speed: 0.0158s/iter; left time: 6.7224s
	iters: 200, epoch: 7 | loss: 0.4252430
	speed: 0.0061s/iter; left time: 1.9666s
Updating learning rate to 3.6965160093775718e-06
Epoch: 7 cost time: 1.782165765762329
Epoch: 7, Steps: 262 | Train Loss: 0.3866673 Vali Loss: 0.2791577 Best vali loss: 0.2787598
	iters: 100, epoch: 8 | loss: 0.3384531
	speed: 0.0193s/iter; left time: 3.1539s
	iters: 200, epoch: 8 | loss: 0.4429748
	speed: 0.0129s/iter; left time: 0.8157s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5085489749908447
Epoch: 8, Steps: 262 | Train Loss: 0.3907139 Vali Loss: 0.2798503 Best vali loss: 0.2787598

best validation loss 0.2787598380261347

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 1, 'learning_rate': 0.0005423807869, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6114705
	speed: 0.0111s/iter; left time: 22.0948s
	iters: 200, epoch: 1 | loss: 0.4293651
	speed: 0.0069s/iter; left time: 13.0800s
Updating learning rate to 0.0005217376473721379
Validation loss decreased (inf --> 0.2815).  Saving model state dict ...
Epoch: 1 cost time: 1.918440580368042
Epoch: 1, Steps: 262 | Train Loss: 0.5204178 Vali Loss: 0.2814705 Best vali loss: 0.2814705
	iters: 100, epoch: 2 | loss: 0.4567721
	speed: 0.0143s/iter; left time: 24.8568s
	iters: 200, epoch: 2 | loss: 0.4264399
	speed: 0.0025s/iter; left time: 4.0454s
Updating learning rate to 0.00046295095965114284
Epoch: 2 cost time: 1.027329921722412
Epoch: 2, Steps: 262 | Train Loss: 0.4416060 Vali Loss: 0.3019298 Best vali loss: 0.2814705
	iters: 100, epoch: 3 | loss: 0.5111684
	speed: 0.0063s/iter; left time: 9.3183s
	iters: 200, epoch: 3 | loss: 0.4770663
	speed: 0.0028s/iter; left time: 3.8765s
Updating learning rate to 0.00037497046403988515
Epoch: 3 cost time: 0.7736644744873047
Epoch: 3, Steps: 262 | Train Loss: 0.4941173 Vali Loss: 0.2915132 Best vali loss: 0.2814705
	iters: 100, epoch: 4 | loss: 0.6099304
	speed: 0.0078s/iter; left time: 9.4177s
	iters: 200, epoch: 4 | loss: 0.3353385
	speed: 0.0030s/iter; left time: 3.3482s
Updating learning rate to 0.00027119039345
Epoch: 4 cost time: 0.8462960720062256
Epoch: 4, Steps: 262 | Train Loss: 0.4726344 Vali Loss: 0.2947717 Best vali loss: 0.2814705
	iters: 100, epoch: 5 | loss: 0.4062079
	speed: 0.0078s/iter; left time: 7.4277s
	iters: 200, epoch: 5 | loss: 0.3599259
	speed: 0.0034s/iter; left time: 2.8594s
Updating learning rate to 0.00016741032286011486
Epoch: 5 cost time: 0.908003568649292
Epoch: 5, Steps: 262 | Train Loss: 0.3830669 Vali Loss: 0.3067482 Best vali loss: 0.2814705
	iters: 100, epoch: 6 | loss: 0.4844957
	speed: 0.0073s/iter; left time: 5.0210s
	iters: 200, epoch: 6 | loss: 0.4371422
	speed: 0.0027s/iter; left time: 1.5762s
Updating learning rate to 7.942982724885713e-05
Epoch: 6 cost time: 0.763028621673584
Epoch: 6, Steps: 262 | Train Loss: 0.4608190 Vali Loss: 0.3025623 Best vali loss: 0.2814705
	iters: 100, epoch: 7 | loss: 0.4225550
	speed: 0.0074s/iter; left time: 3.1465s
	iters: 200, epoch: 7 | loss: 0.4503040
	speed: 0.0031s/iter; left time: 1.0018s
Updating learning rate to 2.0643139527862082e-05
Epoch: 7 cost time: 0.8558251857757568
Epoch: 7, Steps: 262 | Train Loss: 0.4364295 Vali Loss: 0.3022755 Best vali loss: 0.2814705
	iters: 100, epoch: 8 | loss: 0.2734869
	speed: 0.0076s/iter; left time: 1.2378s
	iters: 200, epoch: 8 | loss: 0.3001591
	speed: 0.0030s/iter; left time: 0.1869s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8331611156463623
Epoch: 8, Steps: 262 | Train Loss: 0.2868230 Vali Loss: 0.3021608 Best vali loss: 0.2814705

best validation loss 0.28147049932596896

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009796137024, 'e_layers': 4, 'learning_rate': 0.0039423373884, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0039423373884
Validation loss decreased (inf --> 0.3238).  Saving model state dict ...
Epoch: 1 cost time: 1.1695377826690674
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3238495 Best vali loss: 0.3238495
Updating learning rate to 0.0019711686942
Validation loss decreased (0.3238 --> 0.3198).  Saving model state dict ...
Epoch: 2 cost time: 0.9342060089111328
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3198285 Best vali loss: 0.3198285
Updating learning rate to 0.0009855843471
Epoch: 3 cost time: 0.9357621669769287
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3301545 Best vali loss: 0.3198285
Updating learning rate to 0.00049279217355
Epoch: 4 cost time: 0.9341461658477783
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3213357 Best vali loss: 0.3198285
Updating learning rate to 0.000246396086775
Epoch: 5 cost time: 0.9364964962005615
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3235562 Best vali loss: 0.3198285
Updating learning rate to 0.0001231980433875
Epoch: 6 cost time: 0.8638126850128174
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3214427 Best vali loss: 0.3198285
Updating learning rate to 6.159902169375e-05
Epoch: 7 cost time: 0.7487626075744629
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3226632 Best vali loss: 0.3198285
Updating learning rate to 3.0799510846875e-05
Epoch: 8 cost time: 0.8862833976745605
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3220487 Best vali loss: 0.3198285

best validation loss 0.3198284670161953

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.002325483877, 'e_layers': 3, 'learning_rate': 0.0029565654282, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3812907
	speed: 0.0104s/iter; left time: 42.3940s
	iters: 200, epoch: 1 | loss: 0.3650198
	speed: 0.0055s/iter; left time: 21.9684s
	iters: 300, epoch: 1 | loss: 0.2934954
	speed: 0.0055s/iter; left time: 21.5558s
	iters: 400, epoch: 1 | loss: 0.9399596
	speed: 0.0055s/iter; left time: 20.9269s
	iters: 500, epoch: 1 | loss: 1.1368060
	speed: 0.0056s/iter; left time: 20.4591s
Updating learning rate to 0.0029565654282
Validation loss decreased (inf --> 0.3215).  Saving model state dict ...
Epoch: 1 cost time: 3.1836321353912354
Epoch: 1, Steps: 523 | Train Loss: 0.6233143 Vali Loss: 0.3215315 Best vali loss: 0.3215315
	iters: 100, epoch: 2 | loss: 0.3719092
	speed: 0.0115s/iter; left time: 41.0467s
	iters: 200, epoch: 2 | loss: 0.4953234
	speed: 0.0050s/iter; left time: 17.3855s
	iters: 300, epoch: 2 | loss: 0.3456595
	speed: 0.0051s/iter; left time: 17.0579s
	iters: 400, epoch: 2 | loss: 0.5829347
	speed: 0.0054s/iter; left time: 17.4914s
	iters: 500, epoch: 2 | loss: 0.7805327
	speed: 0.0056s/iter; left time: 17.6063s
Updating learning rate to 0.0014782827141
Epoch: 2 cost time: 2.789731979370117
Epoch: 2, Steps: 523 | Train Loss: 0.5152719 Vali Loss: 0.3216727 Best vali loss: 0.3215315
	iters: 100, epoch: 3 | loss: 0.4133222
	speed: 0.0117s/iter; left time: 35.6808s
	iters: 200, epoch: 3 | loss: 0.4987619
	speed: 0.0056s/iter; left time: 16.3192s
	iters: 300, epoch: 3 | loss: 0.4703966
	speed: 0.0055s/iter; left time: 15.7378s
	iters: 400, epoch: 3 | loss: 0.2737148
	speed: 0.0056s/iter; left time: 15.2359s
	iters: 500, epoch: 3 | loss: 0.8346490
	speed: 0.0056s/iter; left time: 14.6608s
Updating learning rate to 0.00073914135705
Epoch: 3 cost time: 2.946221351623535
Epoch: 3, Steps: 523 | Train Loss: 0.4981689 Vali Loss: 0.3234160 Best vali loss: 0.3215315

best validation loss 0.3215314937418125

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0084343460894, 'e_layers': 3, 'learning_rate': 0.0011030524514, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7342810
	speed: 0.0108s/iter; left time: 88.8711s
	iters: 200, epoch: 1 | loss: 1.7148899
	speed: 0.0053s/iter; left time: 43.2946s
	iters: 300, epoch: 1 | loss: 0.7966764
	speed: 0.0052s/iter; left time: 41.6552s
	iters: 400, epoch: 1 | loss: 0.1782332
	speed: 0.0052s/iter; left time: 41.1002s
	iters: 500, epoch: 1 | loss: 0.7602877
	speed: 0.0052s/iter; left time: 40.6190s
	iters: 600, epoch: 1 | loss: 0.2598219
	speed: 0.0052s/iter; left time: 40.1603s
	iters: 700, epoch: 1 | loss: 0.6143594
	speed: 0.0052s/iter; left time: 39.6635s
	iters: 800, epoch: 1 | loss: 0.4359770
	speed: 0.0052s/iter; left time: 38.9399s
	iters: 900, epoch: 1 | loss: 0.8015816
	speed: 0.0052s/iter; left time: 38.5306s
	iters: 1000, epoch: 1 | loss: 0.3254117
	speed: 0.0051s/iter; left time: 37.8085s
Updating learning rate to 0.0011030524514
Validation loss decreased (inf --> 0.2938).  Saving model state dict ...
Epoch: 1 cost time: 5.696051836013794
Epoch: 1, Steps: 1045 | Train Loss: 0.6621520 Vali Loss: 0.2937664 Best vali loss: 0.2937664
	iters: 100, epoch: 2 | loss: 1.2376245
	speed: 0.0149s/iter; left time: 107.2841s
	iters: 200, epoch: 2 | loss: 0.2234834
	speed: 0.0037s/iter; left time: 26.5230s
	iters: 300, epoch: 2 | loss: 1.2439628
	speed: 0.0051s/iter; left time: 35.9606s
	iters: 400, epoch: 2 | loss: 0.2857151
	speed: 0.0059s/iter; left time: 40.7402s
	iters: 500, epoch: 2 | loss: 0.2579329
	speed: 0.0056s/iter; left time: 38.0204s
	iters: 600, epoch: 2 | loss: 0.7438455
	speed: 0.0056s/iter; left time: 37.9143s
	iters: 700, epoch: 2 | loss: 0.2689646
	speed: 0.0059s/iter; left time: 39.0090s
	iters: 800, epoch: 2 | loss: 0.4052314
	speed: 0.0052s/iter; left time: 33.9867s
	iters: 900, epoch: 2 | loss: 0.4965064
	speed: 0.0038s/iter; left time: 24.5182s
	iters: 1000, epoch: 2 | loss: 0.5378330
	speed: 0.0041s/iter; left time: 25.6991s
Updating learning rate to 0.0005515262257
Validation loss decreased (0.2938 --> 0.2917).  Saving model state dict ...
Epoch: 2 cost time: 5.18552303314209
Epoch: 2, Steps: 1045 | Train Loss: 0.5701099 Vali Loss: 0.2916713 Best vali loss: 0.2916713
	iters: 100, epoch: 3 | loss: 0.2397375
	speed: 0.0189s/iter; left time: 116.8372s
	iters: 200, epoch: 3 | loss: 0.4729131
	speed: 0.0058s/iter; left time: 34.9299s
	iters: 300, epoch: 3 | loss: 0.3212406
	speed: 0.0062s/iter; left time: 36.8109s
	iters: 400, epoch: 3 | loss: 0.5522769
	speed: 0.0061s/iter; left time: 35.6443s
	iters: 500, epoch: 3 | loss: 0.5349723
	speed: 0.0059s/iter; left time: 34.1104s
	iters: 600, epoch: 3 | loss: 0.3464336
	speed: 0.0062s/iter; left time: 35.3208s
	iters: 700, epoch: 3 | loss: 1.3361251
	speed: 0.0049s/iter; left time: 27.0374s
	iters: 800, epoch: 3 | loss: 0.2757049
	speed: 0.0038s/iter; left time: 20.9948s
	iters: 900, epoch: 3 | loss: 0.2955201
	speed: 0.0048s/iter; left time: 25.6139s
	iters: 1000, epoch: 3 | loss: 0.7611520
	speed: 0.0103s/iter; left time: 54.0857s
Updating learning rate to 0.00027576311285
Validation loss decreased (0.2917 --> 0.2890).  Saving model state dict ...
Epoch: 3 cost time: 6.404033184051514
Epoch: 3, Steps: 1045 | Train Loss: 0.5136076 Vali Loss: 0.2890186 Best vali loss: 0.2890186

best validation loss 0.28901855480764027

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050872293761, 'e_layers': 4, 'learning_rate': 0.0001304544179, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7790206
	speed: 0.0158s/iter; left time: 14.9593s
Updating learning rate to 0.000125489292261742
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 1.5805585384368896
Epoch: 1, Steps: 131 | Train Loss: 0.7790206 Vali Loss: 0.2848353 Best vali loss: 0.2848353
	iters: 100, epoch: 2 | loss: 0.7170758
	speed: 0.0163s/iter; left time: 13.3168s
Updating learning rate to 0.00011134981071641684
Validation loss decreased (0.2848 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 1.2974584102630615
Epoch: 2, Steps: 131 | Train Loss: 0.7170758 Vali Loss: 0.2807689 Best vali loss: 0.2807689
	iters: 100, epoch: 3 | loss: 0.7269552
	speed: 0.0167s/iter; left time: 11.5008s
Updating learning rate to 9.01885811545809e-05
Validation loss decreased (0.2808 --> 0.2797).  Saving model state dict ...
Epoch: 3 cost time: 1.486307144165039
Epoch: 3, Steps: 131 | Train Loss: 0.7269552 Vali Loss: 0.2797349 Best vali loss: 0.2797349

best validation loss 0.279734883045964

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050872293761, 'e_layers': 4, 'learning_rate': 0.0001304544179, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6318748
	speed: 0.0156s/iter; left time: 8.6567s
Updating learning rate to 6.522720895e-05
Validation loss decreased (0.2797 --> 0.2793).  Saving model state dict ...
Epoch: 4 cost time: 1.4973170757293701
Epoch: 4, Steps: 131 | Train Loss: 0.6318748 Vali Loss: 0.2793209 Best vali loss: 0.2793209
	iters: 100, epoch: 5 | loss: 0.6404896
	speed: 0.0164s/iter; left time: 6.9754s
Updating learning rate to 4.0265836745419096e-05
Epoch: 5 cost time: 1.3636841773986816
Epoch: 5, Steps: 131 | Train Loss: 0.6404896 Vali Loss: 0.2800418 Best vali loss: 0.2793209
	iters: 100, epoch: 6 | loss: 0.6874533
	speed: 0.0158s/iter; left time: 4.6335s
Updating learning rate to 1.910460718358314e-05
Validation loss decreased (0.2793 --> 0.2792).  Saving model state dict ...
Epoch: 6 cost time: 1.150815725326538
Epoch: 6, Steps: 131 | Train Loss: 0.6874533 Vali Loss: 0.2791819 Best vali loss: 0.2791819
	iters: 100, epoch: 7 | loss: 0.6087636
	speed: 0.0094s/iter; left time: 1.5264s
Updating learning rate to 4.965125638257981e-06
Epoch: 7 cost time: 0.8057153224945068
Epoch: 7, Steps: 131 | Train Loss: 0.6087636 Vali Loss: 0.2800064 Best vali loss: 0.2791819
	iters: 100, epoch: 8 | loss: 0.4998207
	speed: 0.0120s/iter; left time: 0.3838s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.013131856918335
Epoch: 8, Steps: 131 | Train Loss: 0.4998207 Vali Loss: 0.2802360 Best vali loss: 0.2791819

best validation loss 0.27918189930268583

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0018333163825, 'e_layers': 2, 'learning_rate': 0.0006860415015, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3214754
	speed: 0.0112s/iter; left time: 22.4548s
	iters: 200, epoch: 1 | loss: 0.8015345
	speed: 0.0059s/iter; left time: 11.1015s
Updating learning rate to 0.0006860415015
Validation loss decreased (inf --> 0.3102).  Saving model state dict ...
Epoch: 1 cost time: 1.7995669841766357
Epoch: 1, Steps: 262 | Train Loss: 0.5615049 Vali Loss: 0.3101530 Best vali loss: 0.3101530
	iters: 100, epoch: 2 | loss: 0.5861838
	speed: 0.0110s/iter; left time: 19.0334s
	iters: 200, epoch: 2 | loss: 0.4353943
	speed: 0.0042s/iter; left time: 6.9401s
Updating learning rate to 0.00034302075075
Validation loss decreased (0.3102 --> 0.2964).  Saving model state dict ...
Epoch: 2 cost time: 1.1530754566192627
Epoch: 2, Steps: 262 | Train Loss: 0.5107891 Vali Loss: 0.2963934 Best vali loss: 0.2963934
	iters: 100, epoch: 3 | loss: 0.3045964
	speed: 0.0104s/iter; left time: 15.3903s
	iters: 200, epoch: 3 | loss: 0.4246950
	speed: 0.0054s/iter; left time: 7.4251s
Updating learning rate to 0.000171510375375
Validation loss decreased (0.2964 --> 0.2894).  Saving model state dict ...
Epoch: 3 cost time: 1.3743598461151123
Epoch: 3, Steps: 262 | Train Loss: 0.3646457 Vali Loss: 0.2894185 Best vali loss: 0.2894185
	iters: 100, epoch: 4 | loss: 0.3813488
	speed: 0.0127s/iter; left time: 15.3431s
	iters: 200, epoch: 4 | loss: 0.5342585
	speed: 0.0055s/iter; left time: 6.1365s
Updating learning rate to 8.57551876875e-05
Epoch: 4 cost time: 1.4824883937835693
Epoch: 4, Steps: 262 | Train Loss: 0.4578037 Vali Loss: 0.2990077 Best vali loss: 0.2894185
	iters: 100, epoch: 5 | loss: 0.4886565
	speed: 0.0121s/iter; left time: 11.4994s
	iters: 200, epoch: 5 | loss: 0.6470665
	speed: 0.0056s/iter; left time: 4.7217s
Updating learning rate to 4.287759384375e-05
Epoch: 5 cost time: 1.5010342597961426
Epoch: 5, Steps: 262 | Train Loss: 0.5678615 Vali Loss: 0.3110419 Best vali loss: 0.2894185
	iters: 100, epoch: 6 | loss: 0.6394865
	speed: 0.0121s/iter; left time: 8.3056s
	iters: 200, epoch: 6 | loss: 0.4580924
	speed: 0.0053s/iter; left time: 3.1081s
Updating learning rate to 2.1438796921875e-05
Epoch: 6 cost time: 1.4271864891052246
Epoch: 6, Steps: 262 | Train Loss: 0.5487895 Vali Loss: 0.3067889 Best vali loss: 0.2894185
	iters: 100, epoch: 7 | loss: 0.4187546
	speed: 0.0117s/iter; left time: 4.9721s
	iters: 200, epoch: 7 | loss: 0.3322769
	speed: 0.0055s/iter; left time: 1.7947s
Updating learning rate to 1.07193984609375e-05
Epoch: 7 cost time: 1.4852042198181152
Epoch: 7, Steps: 262 | Train Loss: 0.3755158 Vali Loss: 0.3127946 Best vali loss: 0.2894185
	iters: 100, epoch: 8 | loss: 0.2818717
	speed: 0.0123s/iter; left time: 2.0069s
	iters: 200, epoch: 8 | loss: 0.2736787
	speed: 0.0049s/iter; left time: 0.3111s
Updating learning rate to 5.35969923046875e-06
Epoch: 8 cost time: 1.3527121543884277
Epoch: 8, Steps: 262 | Train Loss: 0.2777752 Vali Loss: 0.3089220 Best vali loss: 0.2894185

best validation loss 0.28941849724162066

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008179554336, 'e_layers': 1, 'learning_rate': 0.0022030201293, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.002119172668235319
Validation loss decreased (inf --> 0.2821).  Saving model state dict ...
Epoch: 1 cost time: 0.5315322875976562
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2820789 Best vali loss: 0.2820789
Updating learning rate to 0.0018803953009092472
Epoch: 2 cost time: 0.27637195587158203
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2856876 Best vali loss: 0.2820789
Updating learning rate to 0.001523039716974954
Epoch: 3 cost time: 0.2860445976257324
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2825614 Best vali loss: 0.2820789
Updating learning rate to 0.00110151006465
Epoch: 4 cost time: 0.2964627742767334
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3005331 Best vali loss: 0.2820789
Updating learning rate to 0.0006799804123250461
Epoch: 5 cost time: 0.294173002243042
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2968444 Best vali loss: 0.2820789
Updating learning rate to 0.0003226248283907527
Epoch: 6 cost time: 0.28728413581848145
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2990626 Best vali loss: 0.2820789
Updating learning rate to 8.384746106468076e-05
Epoch: 7 cost time: 0.26964235305786133
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2976286 Best vali loss: 0.2820789
Updating learning rate to 0.0
Epoch: 8 cost time: 0.30739521980285645
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2984708 Best vali loss: 0.2820789

best validation loss 0.2820788559006155

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5916030
	speed: 0.0115s/iter; left time: 22.9900s
	iters: 200, epoch: 1 | loss: 0.5429766
	speed: 0.0059s/iter; left time: 11.1419s
Updating learning rate to 8.666273256609723e-05
Validation loss decreased (inf --> 0.2874).  Saving model state dict ...
Epoch: 1 cost time: 1.8607406616210938
Epoch: 1, Steps: 262 | Train Loss: 0.5672898 Vali Loss: 0.2873823 Best vali loss: 0.2873823
	iters: 100, epoch: 2 | loss: 0.3824045
	speed: 0.0136s/iter; left time: 23.6677s
	iters: 200, epoch: 2 | loss: 0.9002246
	speed: 0.0067s/iter; left time: 10.8918s
Updating learning rate to 7.689802606643869e-05
Validation loss decreased (0.2874 --> 0.2816).  Saving model state dict ...
Epoch: 2 cost time: 1.7895355224609375
Epoch: 2, Steps: 262 | Train Loss: 0.6413146 Vali Loss: 0.2816300 Best vali loss: 0.2816300
	iters: 100, epoch: 3 | loss: 0.6209943
	speed: 0.0140s/iter; left time: 20.5984s
	iters: 200, epoch: 3 | loss: 0.4019143
	speed: 0.0066s/iter; left time: 9.0205s
Updating learning rate to 6.228411004831259e-05
Validation loss decreased (0.2816 --> 0.2796).  Saving model state dict ...
Epoch: 3 cost time: 1.766613245010376
Epoch: 3, Steps: 262 | Train Loss: 0.5114543 Vali Loss: 0.2796410 Best vali loss: 0.2796410

best validation loss 0.2796410447039893

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061161357241, 'e_layers': 4, 'learning_rate': 0.0038059297724, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4334872
	speed: 0.0125s/iter; left time: 103.2158s
	iters: 200, epoch: 1 | loss: 0.4869584
	speed: 0.0061s/iter; left time: 49.4702s
	iters: 300, epoch: 1 | loss: 0.3076709
	speed: 0.0057s/iter; left time: 45.7340s
	iters: 400, epoch: 1 | loss: 0.3094602
	speed: 0.0065s/iter; left time: 51.4242s
	iters: 500, epoch: 1 | loss: 0.2538171
	speed: 0.0070s/iter; left time: 55.0728s
	iters: 600, epoch: 1 | loss: 0.7045044
	speed: 0.0070s/iter; left time: 54.2703s
	iters: 700, epoch: 1 | loss: 1.6309494
	speed: 0.0070s/iter; left time: 53.7028s
	iters: 800, epoch: 1 | loss: 0.2827421
	speed: 0.0070s/iter; left time: 52.8512s
	iters: 900, epoch: 1 | loss: 0.3577617
	speed: 0.0070s/iter; left time: 52.1615s
	iters: 1000, epoch: 1 | loss: 0.9039681
	speed: 0.0070s/iter; left time: 51.6911s
Updating learning rate to 0.0036610751956478497
Validation loss decreased (inf --> 0.3220).  Saving model state dict ...
Epoch: 1 cost time: 7.294456243515015
Epoch: 1, Steps: 1045 | Train Loss: 0.5671319 Vali Loss: 0.3219879 Best vali loss: 0.3219879
	iters: 100, epoch: 2 | loss: 0.2649090
	speed: 0.0204s/iter; left time: 147.4777s
	iters: 200, epoch: 2 | loss: 0.2875937
	speed: 0.0065s/iter; left time: 46.3331s
	iters: 300, epoch: 2 | loss: 0.3245626
	speed: 0.0060s/iter; left time: 42.0356s
	iters: 400, epoch: 2 | loss: 0.9246067
	speed: 0.0052s/iter; left time: 35.8155s
	iters: 500, epoch: 2 | loss: 0.3848228
	speed: 0.0048s/iter; left time: 32.6363s
	iters: 600, epoch: 2 | loss: 0.3430756
	speed: 0.0063s/iter; left time: 42.2034s
	iters: 700, epoch: 2 | loss: 1.2049747
	speed: 0.0059s/iter; left time: 38.9954s
	iters: 800, epoch: 2 | loss: 0.5086843
	speed: 0.0066s/iter; left time: 42.9848s
	iters: 900, epoch: 2 | loss: 0.6210777
	speed: 0.0061s/iter; left time: 39.3411s
	iters: 1000, epoch: 2 | loss: 1.0943745
	speed: 0.0065s/iter; left time: 41.0225s
Updating learning rate to 0.0032485642615919063
Epoch: 2 cost time: 6.3555686473846436
Epoch: 2, Steps: 1045 | Train Loss: 0.5958681 Vali Loss: 0.3264250 Best vali loss: 0.3219879
	iters: 100, epoch: 3 | loss: 0.8217285
	speed: 0.0159s/iter; left time: 98.2283s
	iters: 200, epoch: 3 | loss: 0.2706266
	speed: 0.0066s/iter; left time: 40.3031s
	iters: 300, epoch: 3 | loss: 0.3934323
	speed: 0.0065s/iter; left time: 38.8851s
	iters: 400, epoch: 3 | loss: 0.3721862
	speed: 0.0067s/iter; left time: 39.1259s
	iters: 500, epoch: 3 | loss: 0.2718974
	speed: 0.0067s/iter; left time: 38.8470s
	iters: 600, epoch: 3 | loss: 1.0433730
	speed: 0.0065s/iter; left time: 36.9822s
	iters: 700, epoch: 3 | loss: 0.2699824
	speed: 0.0063s/iter; left time: 35.0627s
	iters: 800, epoch: 3 | loss: 0.6166437
	speed: 0.0067s/iter; left time: 36.4873s
	iters: 900, epoch: 3 | loss: 0.5766036
	speed: 0.0067s/iter; left time: 36.0415s
	iters: 1000, epoch: 3 | loss: 0.3749925
	speed: 0.0065s/iter; left time: 34.3297s
Updating learning rate to 0.0026311980205212587
Validation loss decreased (0.3220 --> 0.3213).  Saving model state dict ...
Epoch: 3 cost time: 6.930673360824585
Epoch: 3, Steps: 1045 | Train Loss: 0.5011466 Vali Loss: 0.3212578 Best vali loss: 0.3212578

best validation loss 0.3212577604857374

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0092252495316, 'e_layers': 4, 'learning_rate': 0.0006913977983, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5654497
	speed: 0.0125s/iter; left time: 11.8259s
Updating learning rate to 0.0006650830364863684
Validation loss decreased (inf --> 0.2844).  Saving model state dict ...
Epoch: 1 cost time: 1.1767292022705078
Epoch: 1, Steps: 131 | Train Loss: 0.5654497 Vali Loss: 0.2843717 Best vali loss: 0.2843717
	iters: 100, epoch: 2 | loss: 0.6477536
	speed: 0.0099s/iter; left time: 8.0881s
Updating learning rate to 0.0005901449349876894
Epoch: 2 cost time: 0.7654983997344971
Epoch: 2, Steps: 131 | Train Loss: 0.6477536 Vali Loss: 0.2877861 Best vali loss: 0.2843717
	iters: 100, epoch: 3 | loss: 0.4483790
	speed: 0.0120s/iter; left time: 8.2619s
Updating learning rate to 0.000477992140441555
Epoch: 3 cost time: 1.112569808959961
Epoch: 3, Steps: 131 | Train Loss: 0.4483790 Vali Loss: 0.2846489 Best vali loss: 0.2843717

best validation loss 0.2843716757897774

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4579054
	speed: 0.0154s/iter; left time: 18.7044s
	iters: 200, epoch: 4 | loss: 0.4855635
	speed: 0.0089s/iter; left time: 9.9024s
Updating learning rate to 4.504582075e-05
Validation loss decreased (0.2796 --> 0.2787).  Saving model state dict ...
Epoch: 4 cost time: 2.5979645252227783
Epoch: 4, Steps: 262 | Train Loss: 0.4717345 Vali Loss: 0.2786786 Best vali loss: 0.2786786
	iters: 100, epoch: 5 | loss: 0.3684373
	speed: 0.0176s/iter; left time: 16.7269s
	iters: 200, epoch: 5 | loss: 0.8359082
	speed: 0.0051s/iter; left time: 4.3088s
Updating learning rate to 2.780753145168742e-05
Epoch: 5 cost time: 1.7292234897613525
Epoch: 5, Steps: 262 | Train Loss: 0.6021727 Vali Loss: 0.2798461 Best vali loss: 0.2786786
	iters: 100, epoch: 6 | loss: 0.5376793
	speed: 0.0122s/iter; left time: 8.4067s
	iters: 200, epoch: 6 | loss: 0.3707732
	speed: 0.0059s/iter; left time: 3.4800s
Updating learning rate to 1.3193615433561312e-05
Epoch: 6 cost time: 1.5793614387512207
Epoch: 6, Steps: 262 | Train Loss: 0.4542262 Vali Loss: 0.2794042 Best vali loss: 0.2786786
	iters: 100, epoch: 7 | loss: 0.6005284
	speed: 0.0124s/iter; left time: 5.2701s
	iters: 200, epoch: 7 | loss: 0.5751258
	speed: 0.0059s/iter; left time: 1.9228s
Updating learning rate to 3.4289089339027804e-06
Epoch: 7 cost time: 1.5860657691955566
Epoch: 7, Steps: 262 | Train Loss: 0.5878271 Vali Loss: 0.2797929 Best vali loss: 0.2786786
	iters: 100, epoch: 8 | loss: 0.5737897
	speed: 0.0126s/iter; left time: 2.0596s
	iters: 200, epoch: 8 | loss: 0.4880466
	speed: 0.0059s/iter; left time: 0.3703s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5853674411773682
Epoch: 8, Steps: 262 | Train Loss: 0.5309182 Vali Loss: 0.2800693 Best vali loss: 0.2786786

best validation loss 0.2786786323555254

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0065507519564, 'e_layers': 1, 'learning_rate': 0.0001029375142, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6948759
	speed: 0.0089s/iter; left time: 8.4808s
Updating learning rate to 0.0001029375142
Validation loss decreased (inf --> 0.2788).  Saving model state dict ...
Epoch: 1 cost time: 0.7123432159423828
Epoch: 1, Steps: 131 | Train Loss: 0.6948759 Vali Loss: 0.2788461 Best vali loss: 0.2788461
	iters: 100, epoch: 2 | loss: 0.6763046
	speed: 0.0066s/iter; left time: 5.4100s
Updating learning rate to 5.14687571e-05
Validation loss decreased (0.2788 --> 0.2776).  Saving model state dict ...
Epoch: 2 cost time: 0.49190425872802734
Epoch: 2, Steps: 131 | Train Loss: 0.6763046 Vali Loss: 0.2775692 Best vali loss: 0.2775692
	iters: 100, epoch: 3 | loss: 0.4521789
	speed: 0.0065s/iter; left time: 4.4410s
Updating learning rate to 2.573437855e-05
Epoch: 3 cost time: 0.478773832321167
Epoch: 3, Steps: 131 | Train Loss: 0.4521789 Vali Loss: 0.2784630 Best vali loss: 0.2775692
	iters: 100, epoch: 4 | loss: 0.3405258
	speed: 0.0065s/iter; left time: 3.6163s
Updating learning rate to 1.2867189275e-05
Epoch: 4 cost time: 0.4837193489074707
Epoch: 4, Steps: 131 | Train Loss: 0.3405258 Vali Loss: 0.2784521 Best vali loss: 0.2775692
	iters: 100, epoch: 5 | loss: 0.3999605
	speed: 0.0061s/iter; left time: 2.6130s
Updating learning rate to 6.4335946375e-06
Epoch: 5 cost time: 0.4593217372894287
Epoch: 5, Steps: 131 | Train Loss: 0.3999605 Vali Loss: 0.2780086 Best vali loss: 0.2775692
	iters: 100, epoch: 6 | loss: 0.3801908
	speed: 0.0060s/iter; left time: 1.7771s
Updating learning rate to 3.21679731875e-06
Epoch: 6 cost time: 0.4552428722381592
Epoch: 6, Steps: 131 | Train Loss: 0.3801908 Vali Loss: 0.2780708 Best vali loss: 0.2775692
	iters: 100, epoch: 7 | loss: 0.4858060
	speed: 0.0062s/iter; left time: 1.0152s
Updating learning rate to 1.608398659375e-06
Epoch: 7 cost time: 0.4807932376861572
Epoch: 7, Steps: 131 | Train Loss: 0.4858060 Vali Loss: 0.2782860 Best vali loss: 0.2775692
	iters: 100, epoch: 8 | loss: 0.6368965
	speed: 0.0062s/iter; left time: 0.1983s
Updating learning rate to 8.041993296875e-07
Epoch: 8 cost time: 0.4602506160736084
Epoch: 8, Steps: 131 | Train Loss: 0.6368965 Vali Loss: 0.2784136 Best vali loss: 0.2775692

best validation loss 0.27756921617281666

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010787314027, 'e_layers': 1, 'learning_rate': 6.93882705e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2554120
	speed: 0.0086s/iter; left time: 35.0583s
	iters: 200, epoch: 1 | loss: 0.3576990
	speed: 0.0030s/iter; left time: 11.9206s
	iters: 300, epoch: 1 | loss: 0.2798479
	speed: 0.0030s/iter; left time: 11.6553s
	iters: 400, epoch: 1 | loss: 0.7216650
	speed: 0.0030s/iter; left time: 11.3598s
	iters: 500, epoch: 1 | loss: 0.2867064
	speed: 0.0030s/iter; left time: 11.0757s
Updating learning rate to 6.674733670565335e-05
Validation loss decreased (inf --> 0.3043).  Saving model state dict ...
Epoch: 1 cost time: 1.844954252243042
Epoch: 1, Steps: 523 | Train Loss: 0.3802661 Vali Loss: 0.3042501 Best vali loss: 0.3042501
	iters: 100, epoch: 2 | loss: 0.2998632
	speed: 0.0072s/iter; left time: 25.7957s
	iters: 200, epoch: 2 | loss: 0.7202582
	speed: 0.0032s/iter; left time: 11.2418s
	iters: 300, epoch: 2 | loss: 1.1039914
	speed: 0.0031s/iter; left time: 10.5639s
	iters: 400, epoch: 2 | loss: 0.6418809
	speed: 0.0031s/iter; left time: 10.1387s
	iters: 500, epoch: 2 | loss: 0.3728883
	speed: 0.0031s/iter; left time: 9.9123s
Updating learning rate to 5.922659355267823e-05
Validation loss decreased (0.3043 --> 0.2896).  Saving model state dict ...
Epoch: 2 cost time: 1.6985821723937988
Epoch: 2, Steps: 523 | Train Loss: 0.6277764 Vali Loss: 0.2896375 Best vali loss: 0.2896375
	iters: 100, epoch: 3 | loss: 0.2478189
	speed: 0.0067s/iter; left time: 20.4051s
	iters: 200, epoch: 3 | loss: 0.3320625
	speed: 0.0024s/iter; left time: 7.1586s
	iters: 300, epoch: 3 | loss: 0.9223824
	speed: 0.0026s/iter; left time: 7.3555s
	iters: 400, epoch: 3 | loss: 0.4523685
	speed: 0.0029s/iter; left time: 7.9842s
	iters: 500, epoch: 3 | loss: 0.7146160
	speed: 0.0027s/iter; left time: 7.0933s
Updating learning rate to 4.7971006010408654e-05
Validation loss decreased (0.2896 --> 0.2838).  Saving model state dict ...
Epoch: 3 cost time: 1.4116542339324951
Epoch: 3, Steps: 523 | Train Loss: 0.5338496 Vali Loss: 0.2838055 Best vali loss: 0.2838055
	iters: 100, epoch: 4 | loss: 0.3440988
	speed: 0.0077s/iter; left time: 19.3176s
	iters: 200, epoch: 4 | loss: 0.3043976
	speed: 0.0029s/iter; left time: 7.0698s
	iters: 300, epoch: 4 | loss: 0.1973082
	speed: 0.0022s/iter; left time: 5.0994s
	iters: 400, epoch: 4 | loss: 0.4218532
	speed: 0.0021s/iter; left time: 4.6028s
	iters: 500, epoch: 4 | loss: 1.2006409
	speed: 0.0021s/iter; left time: 4.4965s
Updating learning rate to 3.469413525e-05
Validation loss decreased (0.2838 --> 0.2822).  Saving model state dict ...
Epoch: 4 cost time: 1.3044509887695312
Epoch: 4, Steps: 523 | Train Loss: 0.4936598 Vali Loss: 0.2822012 Best vali loss: 0.2822012
	iters: 100, epoch: 5 | loss: 0.2819297
	speed: 0.0075s/iter; left time: 14.9700s
	iters: 200, epoch: 5 | loss: 0.7977297
	speed: 0.0031s/iter; left time: 5.8193s
	iters: 300, epoch: 5 | loss: 0.8202088
	speed: 0.0031s/iter; left time: 5.5530s
	iters: 400, epoch: 5 | loss: 1.5963068
	speed: 0.0028s/iter; left time: 4.6652s
	iters: 500, epoch: 5 | loss: 0.4314504
	speed: 0.0032s/iter; left time: 5.0774s
Updating learning rate to 2.141726448959135e-05
Validation loss decreased (0.2822 --> 0.2811).  Saving model state dict ...
Epoch: 5 cost time: 1.6170334815979004
Epoch: 5, Steps: 523 | Train Loss: 0.7855251 Vali Loss: 0.2811468 Best vali loss: 0.2811468
	iters: 100, epoch: 6 | loss: 0.4735841
	speed: 0.0056s/iter; left time: 8.3045s
	iters: 200, epoch: 6 | loss: 0.4192213
	speed: 0.0023s/iter; left time: 3.2027s
	iters: 300, epoch: 6 | loss: 0.2973033
	speed: 0.0027s/iter; left time: 3.4621s
	iters: 400, epoch: 6 | loss: 0.4353735
	speed: 0.0027s/iter; left time: 3.2121s
	iters: 500, epoch: 6 | loss: 0.2432239
	speed: 0.0029s/iter; left time: 3.1043s
Updating learning rate to 1.0161676947321766e-05
Validation loss decreased (0.2811 --> 0.2810).  Saving model state dict ...
Epoch: 6 cost time: 1.3907382488250732
Epoch: 6, Steps: 523 | Train Loss: 0.3737412 Vali Loss: 0.2810029 Best vali loss: 0.2810029
	iters: 100, epoch: 7 | loss: 0.2915638
	speed: 0.0066s/iter; left time: 6.2099s
	iters: 200, epoch: 7 | loss: 0.4847766
	speed: 0.0021s/iter; left time: 1.7669s
	iters: 300, epoch: 7 | loss: 0.3984319
	speed: 0.0022s/iter; left time: 1.6456s
	iters: 400, epoch: 7 | loss: 0.8171679
	speed: 0.0027s/iter; left time: 1.7308s
	iters: 500, epoch: 7 | loss: 0.3549299
	speed: 0.0033s/iter; left time: 1.8239s
Updating learning rate to 2.6409337943466457e-06
Validation loss decreased (0.2810 --> 0.2808).  Saving model state dict ...
Epoch: 7 cost time: 1.3575263023376465
Epoch: 7, Steps: 523 | Train Loss: 0.4693740 Vali Loss: 0.2808037 Best vali loss: 0.2808037
	iters: 100, epoch: 8 | loss: 0.5947738
	speed: 0.0093s/iter; left time: 3.9571s
	iters: 200, epoch: 8 | loss: 0.5847929
	speed: 0.0033s/iter; left time: 1.0717s
	iters: 300, epoch: 8 | loss: 0.8104593
	speed: 0.0033s/iter; left time: 0.7318s
	iters: 400, epoch: 8 | loss: 0.6004719
	speed: 0.0030s/iter; left time: 0.3756s
	iters: 500, epoch: 8 | loss: 0.5348161
	speed: 0.0032s/iter; left time: 0.0763s
Updating learning rate to 0.0
Validation loss decreased (0.2808 --> 0.2808).  Saving model state dict ...
Epoch: 8 cost time: 1.7486469745635986
Epoch: 8, Steps: 523 | Train Loss: 0.6250628 Vali Loss: 0.2807832 Best vali loss: 0.2807832

best validation loss 0.28078321210954127

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0021613678694, 'e_layers': 3, 'learning_rate': 0.0003089520735, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003089520735
Validation loss decreased (inf --> 0.3183).  Saving model state dict ...
Epoch: 1 cost time: 0.643315315246582
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.3183012 Best vali loss: 0.3183012
Updating learning rate to 0.00015447603675
Validation loss decreased (0.3183 --> 0.3016).  Saving model state dict ...
Epoch: 2 cost time: 0.36638784408569336
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.3016042 Best vali loss: 0.3016042
Updating learning rate to 7.7238018375e-05
Validation loss decreased (0.3016 --> 0.2969).  Saving model state dict ...
Epoch: 3 cost time: 0.4333465099334717
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2968680 Best vali loss: 0.2968680

best validation loss 0.2968680369295388

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0117286521251, 'e_layers': 1, 'learning_rate': 0.0001923981906, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4810720
	speed: 0.0110s/iter; left time: 10.4090s
Updating learning rate to 0.00018507547049377273
Validation loss decreased (inf --> 0.2785).  Saving model state dict ...
Epoch: 1 cost time: 0.8892476558685303
Epoch: 1, Steps: 131 | Train Loss: 0.4810720 Vali Loss: 0.2784653 Best vali loss: 0.2784653
	iters: 100, epoch: 2 | loss: 0.4141625
	speed: 0.0081s/iter; left time: 6.6081s
Updating learning rate to 0.00016422212793064094
Epoch: 2 cost time: 0.6247577667236328
Epoch: 2, Steps: 131 | Train Loss: 0.4141625 Vali Loss: 0.2798258 Best vali loss: 0.2784653
	iters: 100, epoch: 3 | loss: 0.5106964
	speed: 0.0082s/iter; left time: 5.6483s
Updating learning rate to 0.0001330128952798204
Epoch: 3 cost time: 0.6617252826690674
Epoch: 3, Steps: 131 | Train Loss: 0.5106964 Vali Loss: 0.2805597 Best vali loss: 0.2784653

best validation loss 0.2784652981495671

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042120649381, 'e_layers': 1, 'learning_rate': 0.0036397684012, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003501237965075005
Validation loss decreased (inf --> 0.2864).  Saving model state dict ...
Epoch: 1 cost time: 0.6419680118560791
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2863987 Best vali loss: 0.2863987
Updating learning rate to 0.003106736659818519
Epoch: 2 cost time: 0.3975236415863037
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2899663 Best vali loss: 0.2863987
Updating learning rate to 0.002516323732992606
Epoch: 3 cost time: 0.30442261695861816
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2985292 Best vali loss: 0.2863987

best validation loss 0.28639874821504546

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0117286521251, 'e_layers': 1, 'learning_rate': 0.0001923981906, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3895033
	speed: 0.0093s/iter; left time: 5.1763s
Updating learning rate to 9.61990953e-05
Epoch: 4 cost time: 0.7491743564605713
Epoch: 4, Steps: 131 | Train Loss: 0.3895033 Vali Loss: 0.2902714 Best vali loss: 0.2784653
	iters: 100, epoch: 5 | loss: 0.3732735
	speed: 0.0059s/iter; left time: 2.4878s
Updating learning rate to 5.9385295320179635e-05
Epoch: 5 cost time: 0.4336893558502197
Epoch: 5, Steps: 131 | Train Loss: 0.3732735 Vali Loss: 0.2928756 Best vali loss: 0.2784653
	iters: 100, epoch: 6 | loss: 0.4393472
	speed: 0.0058s/iter; left time: 1.7048s
Updating learning rate to 2.8176062669359075e-05
Epoch: 6 cost time: 0.44147706031799316
Epoch: 6, Steps: 131 | Train Loss: 0.4393472 Vali Loss: 0.2945263 Best vali loss: 0.2784653
	iters: 100, epoch: 7 | loss: 0.4250560
	speed: 0.0062s/iter; left time: 1.0060s
Updating learning rate to 7.322720106227279e-06
Epoch: 7 cost time: 0.4722609519958496
Epoch: 7, Steps: 131 | Train Loss: 0.4250560 Vali Loss: 0.2964973 Best vali loss: 0.2784653
	iters: 100, epoch: 8 | loss: 0.5337739
	speed: 0.0061s/iter; left time: 0.1954s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.47078394889831543
Epoch: 8, Steps: 131 | Train Loss: 0.5337739 Vali Loss: 0.2966503 Best vali loss: 0.2784653

best validation loss 0.2784652981495671

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0035319109171, 'e_layers': 1, 'learning_rate': 0.000506690727, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6546862
	speed: 0.0092s/iter; left time: 8.7103s
Updating learning rate to 0.000487405959494282
Validation loss decreased (inf --> 0.2958).  Saving model state dict ...
Epoch: 1 cost time: 0.7304232120513916
Epoch: 1, Steps: 131 | Train Loss: 0.6546862 Vali Loss: 0.2958452 Best vali loss: 0.2958452
	iters: 100, epoch: 2 | loss: 0.5948786
	speed: 0.0062s/iter; left time: 5.0854s
Updating learning rate to 0.0004324875880130208
Validation loss decreased (0.2958 --> 0.2847).  Saving model state dict ...
Epoch: 2 cost time: 0.479320764541626
Epoch: 2, Steps: 131 | Train Loss: 0.5948786 Vali Loss: 0.2847202 Best vali loss: 0.2847202
	iters: 100, epoch: 3 | loss: 0.6514561
	speed: 0.0063s/iter; left time: 4.3307s
Updating learning rate to 0.00035029643677796134
Epoch: 3 cost time: 0.49219465255737305
Epoch: 3, Steps: 131 | Train Loss: 0.6514561 Vali Loss: 0.2886329 Best vali loss: 0.2847202
	iters: 100, epoch: 4 | loss: 0.6519896
	speed: 0.0062s/iter; left time: 3.4500s
Updating learning rate to 0.0002533453635
Validation loss decreased (0.2847 --> 0.2826).  Saving model state dict ...
Epoch: 4 cost time: 0.48412609100341797
Epoch: 4, Steps: 131 | Train Loss: 0.6519896 Vali Loss: 0.2826428 Best vali loss: 0.2826428
	iters: 100, epoch: 5 | loss: 0.3887890
	speed: 0.0062s/iter; left time: 2.6399s
Updating learning rate to 0.00015639429022203867
Epoch: 5 cost time: 0.4725949764251709
Epoch: 5, Steps: 131 | Train Loss: 0.3887890 Vali Loss: 0.2833523 Best vali loss: 0.2826428
	iters: 100, epoch: 6 | loss: 0.5337776
	speed: 0.0061s/iter; left time: 1.8029s
Updating learning rate to 7.420313898697917e-05
Epoch: 6 cost time: 0.49236273765563965
Epoch: 6, Steps: 131 | Train Loss: 0.5337776 Vali Loss: 0.2856249 Best vali loss: 0.2826428
	iters: 100, epoch: 7 | loss: 0.4688012
	speed: 0.0062s/iter; left time: 1.0098s
Updating learning rate to 1.9284767505717994e-05
Epoch: 7 cost time: 0.4597165584564209
Epoch: 7, Steps: 131 | Train Loss: 0.4688012 Vali Loss: 0.2848036 Best vali loss: 0.2826428
	iters: 100, epoch: 8 | loss: 0.8606489
	speed: 0.0054s/iter; left time: 0.1724s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3923361301422119
Epoch: 8, Steps: 131 | Train Loss: 0.8606489 Vali Loss: 0.2849972 Best vali loss: 0.2826428

best validation loss 0.2826428339134676

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0053854283141, 'e_layers': 2, 'learning_rate': 0.0047874674618, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1626668
	speed: 0.0099s/iter; left time: 19.8336s
	iters: 200, epoch: 1 | loss: 0.3609623
	speed: 0.0042s/iter; left time: 7.9093s
Updating learning rate to 0.0047874674618
Validation loss decreased (inf --> 0.2867).  Saving model state dict ...
Epoch: 1 cost time: 1.3877921104431152
Epoch: 1, Steps: 262 | Train Loss: 0.7618145 Vali Loss: 0.2866807 Best vali loss: 0.2866807
	iters: 100, epoch: 2 | loss: 0.5377809
	speed: 0.0094s/iter; left time: 16.3125s
	iters: 200, epoch: 2 | loss: 0.5341246
	speed: 0.0042s/iter; left time: 6.8083s
Updating learning rate to 0.0023937337309
Epoch: 2 cost time: 1.136690378189087
Epoch: 2, Steps: 262 | Train Loss: 0.5359528 Vali Loss: 0.3021705 Best vali loss: 0.2866807
	iters: 100, epoch: 3 | loss: 0.6551576
	speed: 0.0087s/iter; left time: 12.8351s
	iters: 200, epoch: 3 | loss: 0.6654145
	speed: 0.0035s/iter; left time: 4.8146s
Updating learning rate to 0.00119686686545
Epoch: 3 cost time: 0.9762113094329834
Epoch: 3, Steps: 262 | Train Loss: 0.6602860 Vali Loss: 0.2870105 Best vali loss: 0.2866807
	iters: 100, epoch: 4 | loss: 0.3245565
	speed: 0.0084s/iter; left time: 10.2035s
	iters: 200, epoch: 4 | loss: 0.4510638
	speed: 0.0043s/iter; left time: 4.8218s
Updating learning rate to 0.000598433432725
Epoch: 4 cost time: 1.104417085647583
Epoch: 4, Steps: 262 | Train Loss: 0.3878101 Vali Loss: 0.2873030 Best vali loss: 0.2866807
	iters: 100, epoch: 5 | loss: 0.3670145
	speed: 0.0083s/iter; left time: 7.8672s
	iters: 200, epoch: 5 | loss: 0.4429188
	speed: 0.0034s/iter; left time: 2.9056s
Updating learning rate to 0.0002992167163625
Epoch: 5 cost time: 1.0035483837127686
Epoch: 5, Steps: 262 | Train Loss: 0.4049667 Vali Loss: 0.2867372 Best vali loss: 0.2866807
	iters: 100, epoch: 6 | loss: 0.4892379
	speed: 0.0116s/iter; left time: 7.9390s
	iters: 200, epoch: 6 | loss: 0.3750987
	speed: 0.0051s/iter; left time: 2.9748s
Updating learning rate to 0.00014960835818125
Validation loss decreased (0.2867 --> 0.2866).  Saving model state dict ...
Epoch: 6 cost time: 1.3301215171813965
Epoch: 6, Steps: 262 | Train Loss: 0.4321683 Vali Loss: 0.2866220 Best vali loss: 0.2866220
	iters: 100, epoch: 7 | loss: 0.3464066
	speed: 0.0116s/iter; left time: 4.9301s
	iters: 200, epoch: 7 | loss: 0.3017367
	speed: 0.0034s/iter; left time: 1.1090s
Updating learning rate to 7.4804179090625e-05
Epoch: 7 cost time: 1.0899248123168945
Epoch: 7, Steps: 262 | Train Loss: 0.3240717 Vali Loss: 0.2879010 Best vali loss: 0.2866220
	iters: 100, epoch: 8 | loss: 0.3640502
	speed: 0.0092s/iter; left time: 1.4999s
	iters: 200, epoch: 8 | loss: 0.8815567
	speed: 0.0051s/iter; left time: 0.3209s
Updating learning rate to 3.74020895453125e-05
Epoch: 8 cost time: 1.3164184093475342
Epoch: 8, Steps: 262 | Train Loss: 0.6228034 Vali Loss: 0.2882914 Best vali loss: 0.2866220

best validation loss 0.2866219758278111

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0039151845006, 'e_layers': 1, 'learning_rate': 0.0002904722279, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5302906
	speed: 0.0088s/iter; left time: 36.0258s
	iters: 200, epoch: 1 | loss: 0.3691284
	speed: 0.0029s/iter; left time: 11.4876s
	iters: 300, epoch: 1 | loss: 0.8343034
	speed: 0.0023s/iter; left time: 9.1190s
	iters: 400, epoch: 1 | loss: 1.1143138
	speed: 0.0022s/iter; left time: 8.4801s
	iters: 500, epoch: 1 | loss: 0.4696035
	speed: 0.0022s/iter; left time: 8.0577s
Updating learning rate to 0.0002904722279
Validation loss decreased (inf --> 0.2884).  Saving model state dict ...
Epoch: 1 cost time: 1.6275780200958252
Epoch: 1, Steps: 523 | Train Loss: 0.6635280 Vali Loss: 0.2883890 Best vali loss: 0.2883890
	iters: 100, epoch: 2 | loss: 0.3861336
	speed: 0.0069s/iter; left time: 24.5314s
	iters: 200, epoch: 2 | loss: 0.4896787
	speed: 0.0030s/iter; left time: 10.4214s
	iters: 300, epoch: 2 | loss: 0.2576133
	speed: 0.0030s/iter; left time: 10.0864s
	iters: 400, epoch: 2 | loss: 0.4913594
	speed: 0.0030s/iter; left time: 9.7848s
	iters: 500, epoch: 2 | loss: 0.3823531
	speed: 0.0030s/iter; left time: 9.4306s
Updating learning rate to 0.00014523611395
Validation loss decreased (0.2884 --> 0.2809).  Saving model state dict ...
Epoch: 2 cost time: 1.6021158695220947
Epoch: 2, Steps: 523 | Train Loss: 0.4014276 Vali Loss: 0.2809216 Best vali loss: 0.2809216
	iters: 100, epoch: 3 | loss: 0.2269788
	speed: 0.0070s/iter; left time: 21.3972s
	iters: 200, epoch: 3 | loss: 0.7676650
	speed: 0.0031s/iter; left time: 9.1794s
	iters: 300, epoch: 3 | loss: 0.2291948
	speed: 0.0031s/iter; left time: 8.7776s
	iters: 400, epoch: 3 | loss: 0.5131744
	speed: 0.0030s/iter; left time: 8.3242s
	iters: 500, epoch: 3 | loss: 0.2987913
	speed: 0.0030s/iter; left time: 7.9633s
Updating learning rate to 7.2618056975e-05
Epoch: 3 cost time: 1.6339843273162842
Epoch: 3, Steps: 523 | Train Loss: 0.4071609 Vali Loss: 0.2811815 Best vali loss: 0.2809216

best validation loss 0.2809215964394105

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013304591752, 'e_layers': 2, 'learning_rate': 0.0007475733017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3220213
	speed: 0.0098s/iter; left time: 9.3470s
Updating learning rate to 0.0007475733017
Validation loss decreased (inf --> 0.2807).  Saving model state dict ...
Epoch: 1 cost time: 0.8195836544036865
Epoch: 1, Steps: 131 | Train Loss: 0.3220213 Vali Loss: 0.2807140 Best vali loss: 0.2807140
	iters: 100, epoch: 2 | loss: 0.3093480
	speed: 0.0073s/iter; left time: 5.9652s
Updating learning rate to 0.00037378665085
Validation loss decreased (0.2807 --> 0.2780).  Saving model state dict ...
Epoch: 2 cost time: 0.5734288692474365
Epoch: 2, Steps: 131 | Train Loss: 0.3093480 Vali Loss: 0.2779505 Best vali loss: 0.2779505
	iters: 100, epoch: 3 | loss: 0.2603658
	speed: 0.0070s/iter; left time: 4.8390s
Updating learning rate to 0.000186893325425
Epoch: 3 cost time: 0.5574741363525391
Epoch: 3, Steps: 131 | Train Loss: 0.2603658 Vali Loss: 0.2836336 Best vali loss: 0.2779505

best validation loss 0.2779505447955236

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0048175691372, 'e_layers': 4, 'learning_rate': 0.0003697053685, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5805806
	speed: 0.0118s/iter; left time: 11.1837s
Updating learning rate to 0.0003556342957583465
Validation loss decreased (inf --> 0.2857).  Saving model state dict ...
Epoch: 1 cost time: 1.0867302417755127
Epoch: 1, Steps: 131 | Train Loss: 0.5805806 Vali Loss: 0.2856554 Best vali loss: 0.2856554
	iters: 100, epoch: 2 | loss: 0.6308227
	speed: 0.0103s/iter; left time: 8.4525s
Updating learning rate to 0.0003155632708037107
Validation loss decreased (0.2857 --> 0.2823).  Saving model state dict ...
Epoch: 2 cost time: 0.8645470142364502
Epoch: 2, Steps: 131 | Train Loss: 0.6308227 Vali Loss: 0.2822939 Best vali loss: 0.2822939
	iters: 100, epoch: 3 | loss: 0.5222701
	speed: 0.0094s/iter; left time: 6.4484s
Updating learning rate to 0.0002555927439406902
Epoch: 3 cost time: 0.7956521511077881
Epoch: 3, Steps: 131 | Train Loss: 0.5222701 Vali Loss: 0.2865565 Best vali loss: 0.2822939

best validation loss 0.2822939200709858

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013304591752, 'e_layers': 2, 'learning_rate': 0.0007475733017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3057921
	speed: 0.0103s/iter; left time: 5.7500s
Updating learning rate to 9.34466627125e-05
Epoch: 4 cost time: 0.8766345977783203
Epoch: 4, Steps: 131 | Train Loss: 0.3057921 Vali Loss: 0.2941973 Best vali loss: 0.2779505
	iters: 100, epoch: 5 | loss: 0.2838853
	speed: 0.0080s/iter; left time: 3.3910s
Updating learning rate to 4.672333135625e-05
Epoch: 5 cost time: 0.6413261890411377
Epoch: 5, Steps: 131 | Train Loss: 0.2838853 Vali Loss: 0.2827983 Best vali loss: 0.2779505
	iters: 100, epoch: 6 | loss: 0.2445932
	speed: 0.0076s/iter; left time: 2.2343s
Updating learning rate to 2.3361665678125e-05
Epoch: 6 cost time: 0.5986242294311523
Epoch: 6, Steps: 131 | Train Loss: 0.2445932 Vali Loss: 0.2870346 Best vali loss: 0.2779505
	iters: 100, epoch: 7 | loss: 0.3618008
	speed: 0.0079s/iter; left time: 1.2817s
Updating learning rate to 1.16808328390625e-05
Epoch: 7 cost time: 0.6436452865600586
Epoch: 7, Steps: 131 | Train Loss: 0.3618008 Vali Loss: 0.2897873 Best vali loss: 0.2779505
	iters: 100, epoch: 8 | loss: 0.3242747
	speed: 0.0080s/iter; left time: 0.2570s
Updating learning rate to 5.84041641953125e-06
Epoch: 8 cost time: 0.6425457000732422
Epoch: 8, Steps: 131 | Train Loss: 0.3242747 Vali Loss: 0.2886974 Best vali loss: 0.2779505

best validation loss 0.2779505447955236

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0031278255798, 'e_layers': 4, 'learning_rate': 0.0001800603475, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7785112
	speed: 0.0120s/iter; left time: 48.8928s
	iters: 200, epoch: 1 | loss: 0.3113629
	speed: 0.0059s/iter; left time: 23.5423s
	iters: 300, epoch: 1 | loss: 0.8772666
	speed: 0.0065s/iter; left time: 25.0727s
	iters: 400, epoch: 1 | loss: 0.2751004
	speed: 0.0067s/iter; left time: 25.3876s
	iters: 500, epoch: 1 | loss: 0.3141056
	speed: 0.0067s/iter; left time: 24.6909s
Updating learning rate to 0.0001800603475
Validation loss decreased (inf --> 0.2818).  Saving model state dict ...
Epoch: 1 cost time: 3.665590763092041
Epoch: 1, Steps: 523 | Train Loss: 0.5112693 Vali Loss: 0.2818380 Best vali loss: 0.2818380
	iters: 100, epoch: 2 | loss: 0.2135386
	speed: 0.0135s/iter; left time: 48.2295s
	iters: 200, epoch: 2 | loss: 0.7394937
	speed: 0.0065s/iter; left time: 22.4275s
	iters: 300, epoch: 2 | loss: 0.3847338
	speed: 0.0065s/iter; left time: 21.6923s
	iters: 400, epoch: 2 | loss: 0.9575528
	speed: 0.0067s/iter; left time: 21.7429s
	iters: 500, epoch: 2 | loss: 0.4487484
	speed: 0.0066s/iter; left time: 20.8906s
Updating learning rate to 9.003017375e-05
Epoch: 2 cost time: 3.4759631156921387
Epoch: 2, Steps: 523 | Train Loss: 0.5488135 Vali Loss: 0.2820423 Best vali loss: 0.2818380
	iters: 100, epoch: 3 | loss: 0.2459985
	speed: 0.0133s/iter; left time: 40.4129s
	iters: 200, epoch: 3 | loss: 0.1887855
	speed: 0.0063s/iter; left time: 18.4641s
	iters: 300, epoch: 3 | loss: 0.2966991
	speed: 0.0067s/iter; left time: 19.0237s
	iters: 400, epoch: 3 | loss: 0.2633969
	speed: 0.0069s/iter; left time: 18.8474s
	iters: 500, epoch: 3 | loss: 0.3041431
	speed: 0.0068s/iter; left time: 18.0631s
Updating learning rate to 4.5015086875e-05
Validation loss decreased (0.2818 --> 0.2796).  Saving model state dict ...
Epoch: 3 cost time: 3.5343358516693115
Epoch: 3, Steps: 523 | Train Loss: 0.2598046 Vali Loss: 0.2796086 Best vali loss: 0.2796086
	iters: 100, epoch: 4 | loss: 0.5924503
	speed: 0.0136s/iter; left time: 34.2077s
	iters: 200, epoch: 4 | loss: 0.3916587
	speed: 0.0064s/iter; left time: 15.5044s
	iters: 300, epoch: 4 | loss: 0.4442707
	speed: 0.0065s/iter; left time: 14.9446s
	iters: 400, epoch: 4 | loss: 0.3748980
	speed: 0.0066s/iter; left time: 14.5507s
	iters: 500, epoch: 4 | loss: 0.9166962
	speed: 0.0066s/iter; left time: 13.9894s
Updating learning rate to 2.25075434375e-05
Validation loss decreased (0.2796 --> 0.2794).  Saving model state dict ...
Epoch: 4 cost time: 3.4682226181030273
Epoch: 4, Steps: 523 | Train Loss: 0.5439948 Vali Loss: 0.2794015 Best vali loss: 0.2794015
	iters: 100, epoch: 5 | loss: 0.3344567
	speed: 0.0136s/iter; left time: 27.1830s
	iters: 200, epoch: 5 | loss: 0.3476433
	speed: 0.0063s/iter; left time: 11.8586s
	iters: 300, epoch: 5 | loss: 0.3986674
	speed: 0.0063s/iter; left time: 11.2115s
	iters: 400, epoch: 5 | loss: 0.2539951
	speed: 0.0065s/iter; left time: 11.0056s
	iters: 500, epoch: 5 | loss: 0.4386275
	speed: 0.0065s/iter; left time: 10.4314s
Updating learning rate to 1.125377171875e-05
Validation loss decreased (0.2794 --> 0.2774).  Saving model state dict ...
Epoch: 5 cost time: 3.4258480072021484
Epoch: 5, Steps: 523 | Train Loss: 0.3546780 Vali Loss: 0.2774053 Best vali loss: 0.2774053
	iters: 100, epoch: 6 | loss: 0.2599829
	speed: 0.0132s/iter; left time: 19.4143s
	iters: 200, epoch: 6 | loss: 0.3103046
	speed: 0.0059s/iter; left time: 8.1443s
	iters: 300, epoch: 6 | loss: 0.7799808
	speed: 0.0060s/iter; left time: 7.5774s
	iters: 400, epoch: 6 | loss: 0.3798093
	speed: 0.0064s/iter; left time: 7.5265s
	iters: 500, epoch: 6 | loss: 0.3388830
	speed: 0.0064s/iter; left time: 6.8754s
Updating learning rate to 5.626885859375e-06
Epoch: 6 cost time: 3.315653085708618
Epoch: 6, Steps: 523 | Train Loss: 0.4137921 Vali Loss: 0.2785697 Best vali loss: 0.2774053
	iters: 100, epoch: 7 | loss: 0.7404457
	speed: 0.0131s/iter; left time: 12.4487s
	iters: 200, epoch: 7 | loss: 0.5595065
	speed: 0.0060s/iter; left time: 5.0823s
	iters: 300, epoch: 7 | loss: 0.2651410
	speed: 0.0053s/iter; left time: 3.9269s
	iters: 400, epoch: 7 | loss: 0.3821460
	speed: 0.0046s/iter; left time: 2.9653s
	iters: 500, epoch: 7 | loss: 0.2493230
	speed: 0.0058s/iter; left time: 3.1989s
Updating learning rate to 2.8134429296875e-06
Epoch: 7 cost time: 3.006469488143921
Epoch: 7, Steps: 523 | Train Loss: 0.4393124 Vali Loss: 0.2789860 Best vali loss: 0.2774053
	iters: 100, epoch: 8 | loss: 1.0672551
	speed: 0.0133s/iter; left time: 5.6477s
	iters: 200, epoch: 8 | loss: 0.3016960
	speed: 0.0062s/iter; left time: 2.0054s
	iters: 300, epoch: 8 | loss: 0.7214597
	speed: 0.0062s/iter; left time: 1.3849s
	iters: 400, epoch: 8 | loss: 0.5533352
	speed: 0.0063s/iter; left time: 0.7777s
	iters: 500, epoch: 8 | loss: 0.9046476
	speed: 0.0061s/iter; left time: 0.1466s
Updating learning rate to 1.40672146484375e-06
Epoch: 8 cost time: 3.2760605812072754
Epoch: 8, Steps: 523 | Train Loss: 0.7096787 Vali Loss: 0.2789371 Best vali loss: 0.2774053

best validation loss 0.27740529275441445

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0018839111988, 'e_layers': 2, 'learning_rate': 0.003678803465, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5529731
	speed: 0.0105s/iter; left time: 86.7729s
	iters: 200, epoch: 1 | loss: 0.4288166
	speed: 0.0047s/iter; left time: 38.4740s
	iters: 300, epoch: 1 | loss: 0.2507515
	speed: 0.0047s/iter; left time: 38.1154s
	iters: 400, epoch: 1 | loss: 0.2360727
	speed: 0.0047s/iter; left time: 37.6324s
	iters: 500, epoch: 1 | loss: 0.6500467
	speed: 0.0047s/iter; left time: 37.0157s
	iters: 600, epoch: 1 | loss: 1.3566935
	speed: 0.0047s/iter; left time: 36.4111s
	iters: 700, epoch: 1 | loss: 0.2526593
	speed: 0.0047s/iter; left time: 36.0023s
	iters: 800, epoch: 1 | loss: 0.4546993
	speed: 0.0047s/iter; left time: 35.9130s
	iters: 900, epoch: 1 | loss: 1.0149841
	speed: 0.0042s/iter; left time: 31.1335s
	iters: 1000, epoch: 1 | loss: 0.4087888
	speed: 0.0039s/iter; left time: 29.0655s
Updating learning rate to 0.003678803465
Validation loss decreased (inf --> 0.3224).  Saving model state dict ...
Epoch: 1 cost time: 5.060317754745483
Epoch: 1, Steps: 1045 | Train Loss: 0.5606486 Vali Loss: 0.3224009 Best vali loss: 0.3224009
	iters: 100, epoch: 2 | loss: 0.2473858
	speed: 0.0155s/iter; left time: 111.6489s
	iters: 200, epoch: 2 | loss: 0.2952783
	speed: 0.0048s/iter; left time: 33.9886s
	iters: 300, epoch: 2 | loss: 0.7526423
	speed: 0.0048s/iter; left time: 33.6162s
	iters: 400, epoch: 2 | loss: 0.7230994
	speed: 0.0048s/iter; left time: 33.0568s
	iters: 500, epoch: 2 | loss: 0.2402592
	speed: 0.0048s/iter; left time: 32.7778s
	iters: 600, epoch: 2 | loss: 0.3924386
	speed: 0.0048s/iter; left time: 32.2204s
	iters: 700, epoch: 2 | loss: 1.0175915
	speed: 0.0048s/iter; left time: 31.6940s
	iters: 800, epoch: 2 | loss: 0.5745329
	speed: 0.0048s/iter; left time: 31.2172s
	iters: 900, epoch: 2 | loss: 0.8930499
	speed: 0.0044s/iter; left time: 28.3747s
	iters: 1000, epoch: 2 | loss: 0.6289794
	speed: 0.0039s/iter; left time: 24.9365s
Updating learning rate to 0.0018394017325
Epoch: 2 cost time: 4.88800311088562
Epoch: 2, Steps: 1045 | Train Loss: 0.5765257 Vali Loss: 0.3252716 Best vali loss: 0.3224009
	iters: 100, epoch: 3 | loss: 0.3800631
	speed: 0.0153s/iter; left time: 94.2042s
	iters: 200, epoch: 3 | loss: 1.2996376
	speed: 0.0046s/iter; left time: 28.2044s
	iters: 300, epoch: 3 | loss: 0.3364100
	speed: 0.0046s/iter; left time: 27.6765s
	iters: 400, epoch: 3 | loss: 0.4605308
	speed: 0.0045s/iter; left time: 26.5611s
	iters: 500, epoch: 3 | loss: 1.1473863
	speed: 0.0046s/iter; left time: 26.7155s
	iters: 600, epoch: 3 | loss: 0.3309025
	speed: 0.0046s/iter; left time: 26.2611s
	iters: 700, epoch: 3 | loss: 0.2002940
	speed: 0.0047s/iter; left time: 25.9394s
	iters: 800, epoch: 3 | loss: 0.7395418
	speed: 0.0046s/iter; left time: 25.1965s
	iters: 900, epoch: 3 | loss: 0.5406504
	speed: 0.0043s/iter; left time: 22.9290s
	iters: 1000, epoch: 3 | loss: 0.2980214
	speed: 0.0037s/iter; left time: 19.3497s
Updating learning rate to 0.00091970086625
Epoch: 3 cost time: 4.706786632537842
Epoch: 3, Steps: 1045 | Train Loss: 0.5733438 Vali Loss: 0.3242169 Best vali loss: 0.3224009
	iters: 100, epoch: 4 | loss: 0.3539917
	speed: 0.0147s/iter; left time: 75.5870s
	iters: 200, epoch: 4 | loss: 0.5838089
	speed: 0.0047s/iter; left time: 23.7488s
	iters: 300, epoch: 4 | loss: 0.3877246
	speed: 0.0047s/iter; left time: 22.9900s
	iters: 400, epoch: 4 | loss: 0.5112427
	speed: 0.0047s/iter; left time: 22.5152s
	iters: 500, epoch: 4 | loss: 0.9223371
	speed: 0.0047s/iter; left time: 21.9944s
	iters: 600, epoch: 4 | loss: 0.5434446
	speed: 0.0046s/iter; left time: 21.3110s
	iters: 700, epoch: 4 | loss: 0.3643563
	speed: 0.0046s/iter; left time: 20.8915s
	iters: 800, epoch: 4 | loss: 0.3191864
	speed: 0.0046s/iter; left time: 20.3219s
	iters: 900, epoch: 4 | loss: 0.2708747
	speed: 0.0046s/iter; left time: 19.8879s
	iters: 1000, epoch: 4 | loss: 0.4462427
	speed: 0.0040s/iter; left time: 16.8819s
Updating learning rate to 0.000459850433125
Validation loss decreased (0.3224 --> 0.3222).  Saving model state dict ...
Epoch: 4 cost time: 4.811005592346191
Epoch: 4, Steps: 1045 | Train Loss: 0.4703210 Vali Loss: 0.3222250 Best vali loss: 0.3222250
	iters: 100, epoch: 5 | loss: 0.4161204
	speed: 0.0146s/iter; left time: 59.6840s
	iters: 200, epoch: 5 | loss: 0.3542906
	speed: 0.0048s/iter; left time: 19.0063s
	iters: 300, epoch: 5 | loss: 0.2444643
	speed: 0.0051s/iter; left time: 19.6309s
	iters: 400, epoch: 5 | loss: 0.3124285
	speed: 0.0051s/iter; left time: 19.3737s
	iters: 500, epoch: 5 | loss: 0.4304019
	speed: 0.0051s/iter; left time: 18.7099s
	iters: 600, epoch: 5 | loss: 0.4201876
	speed: 0.0050s/iter; left time: 17.7579s
	iters: 700, epoch: 5 | loss: 0.7309620
	speed: 0.0049s/iter; left time: 16.9966s
	iters: 800, epoch: 5 | loss: 0.2437546
	speed: 0.0048s/iter; left time: 16.0936s
	iters: 900, epoch: 5 | loss: 0.5773145
	speed: 0.0048s/iter; left time: 15.7171s
	iters: 1000, epoch: 5 | loss: 0.3383530
	speed: 0.0044s/iter; left time: 14.1327s
Updating learning rate to 0.0002299252165625
Validation loss decreased (0.3222 --> 0.3221).  Saving model state dict ...
Epoch: 5 cost time: 5.090169429779053
Epoch: 5, Steps: 1045 | Train Loss: 0.4068277 Vali Loss: 0.3220962 Best vali loss: 0.3220962
	iters: 100, epoch: 6 | loss: 0.3916800
	speed: 0.0148s/iter; left time: 45.0714s
	iters: 200, epoch: 6 | loss: 1.1385372
	speed: 0.0046s/iter; left time: 13.5807s
	iters: 300, epoch: 6 | loss: 0.2104653
	speed: 0.0046s/iter; left time: 13.1578s
	iters: 400, epoch: 6 | loss: 0.7936491
	speed: 0.0047s/iter; left time: 12.8882s
	iters: 500, epoch: 6 | loss: 0.9222535
	speed: 0.0048s/iter; left time: 12.5266s
	iters: 600, epoch: 6 | loss: 0.4428591
	speed: 0.0048s/iter; left time: 12.0749s
	iters: 700, epoch: 6 | loss: 0.2344639
	speed: 0.0047s/iter; left time: 11.3511s
	iters: 800, epoch: 6 | loss: 0.5120924
	speed: 0.0046s/iter; left time: 10.8623s
	iters: 900, epoch: 6 | loss: 0.4490783
	speed: 0.0047s/iter; left time: 10.5007s
	iters: 1000, epoch: 6 | loss: 0.8571668
	speed: 0.0042s/iter; left time: 9.0262s
Updating learning rate to 0.00011496260828125
Validation loss decreased (0.3221 --> 0.3220).  Saving model state dict ...
Epoch: 6 cost time: 4.8674156665802
Epoch: 6, Steps: 1045 | Train Loss: 0.5952245 Vali Loss: 0.3220319 Best vali loss: 0.3220319
	iters: 100, epoch: 7 | loss: 0.3248764
	speed: 0.0145s/iter; left time: 28.8028s
	iters: 200, epoch: 7 | loss: 1.2016830
	speed: 0.0048s/iter; left time: 8.9932s
	iters: 300, epoch: 7 | loss: 1.3464899
	speed: 0.0046s/iter; left time: 8.3150s
	iters: 400, epoch: 7 | loss: 0.3688315
	speed: 0.0048s/iter; left time: 8.1545s
	iters: 500, epoch: 7 | loss: 2.1165686
	speed: 0.0048s/iter; left time: 7.6425s
	iters: 600, epoch: 7 | loss: 0.7310466
	speed: 0.0047s/iter; left time: 7.0267s
	iters: 700, epoch: 7 | loss: 0.1763046
	speed: 0.0046s/iter; left time: 6.3655s
	iters: 800, epoch: 7 | loss: 0.4342578
	speed: 0.0047s/iter; left time: 6.0631s
	iters: 900, epoch: 7 | loss: 0.6118525
	speed: 0.0046s/iter; left time: 5.4786s
	iters: 1000, epoch: 7 | loss: 0.3111097
	speed: 0.0042s/iter; left time: 4.6229s
Updating learning rate to 5.7481304140625e-05
Epoch: 7 cost time: 4.857117176055908
Epoch: 7, Steps: 1045 | Train Loss: 0.7623021 Vali Loss: 0.3221033 Best vali loss: 0.3220319
	iters: 100, epoch: 8 | loss: 0.4308063
	speed: 0.0120s/iter; left time: 11.3503s
	iters: 200, epoch: 8 | loss: 1.1427264
	speed: 0.0031s/iter; left time: 2.6279s
	iters: 300, epoch: 8 | loss: 1.1810257
	speed: 0.0045s/iter; left time: 3.3396s
	iters: 400, epoch: 8 | loss: 1.6404907
	speed: 0.0043s/iter; left time: 2.7781s
	iters: 500, epoch: 8 | loss: 0.5306213
	speed: 0.0041s/iter; left time: 2.2555s
	iters: 600, epoch: 8 | loss: 0.3650375
	speed: 0.0042s/iter; left time: 1.8647s
	iters: 700, epoch: 8 | loss: 1.1844420
	speed: 0.0041s/iter; left time: 1.4145s
	iters: 800, epoch: 8 | loss: 0.3576334
	speed: 0.0039s/iter; left time: 0.9539s
	iters: 900, epoch: 8 | loss: 0.5185069
	speed: 0.0042s/iter; left time: 0.6175s
	iters: 1000, epoch: 8 | loss: 0.3876207
	speed: 0.0042s/iter; left time: 0.1917s
Updating learning rate to 2.87406520703125e-05
Epoch: 8 cost time: 4.2115960121154785
Epoch: 8, Steps: 1045 | Train Loss: 0.7738911 Vali Loss: 0.3221926 Best vali loss: 0.3220319

best validation loss 0.3220318815175287

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0055905958708, 'e_layers': 1, 'learning_rate': 0.0036280597991, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5381471
	speed: 0.0093s/iter; left time: 37.9466s
	iters: 200, epoch: 1 | loss: 0.6592011
	speed: 0.0036s/iter; left time: 14.5210s
	iters: 300, epoch: 1 | loss: 0.4655191
	speed: 0.0031s/iter; left time: 12.0900s
	iters: 400, epoch: 1 | loss: 0.3233453
	speed: 0.0028s/iter; left time: 10.5481s
	iters: 500, epoch: 1 | loss: 0.3566240
	speed: 0.0025s/iter; left time: 9.2449s
Updating learning rate to 0.0036280597991
Validation loss decreased (inf --> 0.3090).  Saving model state dict ...
Epoch: 1 cost time: 1.914114236831665
Epoch: 1, Steps: 523 | Train Loss: 0.4685673 Vali Loss: 0.3090118 Best vali loss: 0.3090118
	iters: 100, epoch: 2 | loss: 0.2988897
	speed: 0.0061s/iter; left time: 21.6500s
	iters: 200, epoch: 2 | loss: 0.2820962
	speed: 0.0028s/iter; left time: 9.8191s
	iters: 300, epoch: 2 | loss: 0.3782203
	speed: 0.0029s/iter; left time: 9.6294s
	iters: 400, epoch: 2 | loss: 0.5683120
	speed: 0.0029s/iter; left time: 9.5571s
	iters: 500, epoch: 2 | loss: 0.7000726
	speed: 0.0029s/iter; left time: 9.2571s
Updating learning rate to 0.00181402989955
Validation loss decreased (0.3090 --> 0.2995).  Saving model state dict ...
Epoch: 2 cost time: 1.5162277221679688
Epoch: 2, Steps: 523 | Train Loss: 0.4455181 Vali Loss: 0.2994680 Best vali loss: 0.2994680
	iters: 100, epoch: 3 | loss: 0.9107605
	speed: 0.0080s/iter; left time: 24.4527s
	iters: 200, epoch: 3 | loss: 0.2903729
	speed: 0.0028s/iter; left time: 8.1982s
	iters: 300, epoch: 3 | loss: 0.5006464
	speed: 0.0028s/iter; left time: 8.0021s
	iters: 400, epoch: 3 | loss: 0.4011926
	speed: 0.0028s/iter; left time: 7.5520s
	iters: 500, epoch: 3 | loss: 0.3663671
	speed: 0.0027s/iter; left time: 7.0037s
Updating learning rate to 0.000907014949775
Validation loss decreased (0.2995 --> 0.2975).  Saving model state dict ...
Epoch: 3 cost time: 1.49412202835083
Epoch: 3, Steps: 523 | Train Loss: 0.4938679 Vali Loss: 0.2975364 Best vali loss: 0.2975364

best validation loss 0.2975363977261749

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.001012004623, 'e_layers': 3, 'learning_rate': 0.000825808451, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4707107
	speed: 0.0108s/iter; left time: 44.2443s
	iters: 200, epoch: 1 | loss: 0.6946213
	speed: 0.0052s/iter; left time: 20.7315s
	iters: 300, epoch: 1 | loss: 1.0128285
	speed: 0.0050s/iter; left time: 19.5423s
	iters: 400, epoch: 1 | loss: 1.7350466
	speed: 0.0048s/iter; left time: 18.2407s
	iters: 500, epoch: 1 | loss: 0.3233955
	speed: 0.0052s/iter; left time: 19.3408s
Updating learning rate to 0.000825808451
Validation loss decreased (inf --> 0.2878).  Saving model state dict ...
Epoch: 1 cost time: 2.9563896656036377
Epoch: 1, Steps: 523 | Train Loss: 0.8473205 Vali Loss: 0.2878173 Best vali loss: 0.2878173
	iters: 100, epoch: 2 | loss: 0.6082647
	speed: 0.0113s/iter; left time: 40.1207s
	iters: 200, epoch: 2 | loss: 0.3768905
	speed: 0.0051s/iter; left time: 17.8107s
	iters: 300, epoch: 2 | loss: 0.4245058
	speed: 0.0050s/iter; left time: 16.8779s
	iters: 400, epoch: 2 | loss: 0.3507760
	speed: 0.0046s/iter; left time: 15.1415s
	iters: 500, epoch: 2 | loss: 0.3622132
	speed: 0.0040s/iter; left time: 12.6367s
Updating learning rate to 0.0004129042255
Validation loss decreased (0.2878 --> 0.2844).  Saving model state dict ...
Epoch: 2 cost time: 2.5449860095977783
Epoch: 2, Steps: 523 | Train Loss: 0.4245300 Vali Loss: 0.2844073 Best vali loss: 0.2844073
	iters: 100, epoch: 3 | loss: 0.5625732
	speed: 0.0103s/iter; left time: 31.4028s
	iters: 200, epoch: 3 | loss: 0.2993840
	speed: 0.0046s/iter; left time: 13.5172s
	iters: 300, epoch: 3 | loss: 0.5427383
	speed: 0.0040s/iter; left time: 11.2409s
	iters: 400, epoch: 3 | loss: 0.3322605
	speed: 0.0044s/iter; left time: 11.9416s
	iters: 500, epoch: 3 | loss: 1.1593715
	speed: 0.0046s/iter; left time: 12.1338s
Updating learning rate to 0.00020645211275
Epoch: 3 cost time: 2.363980770111084
Epoch: 3, Steps: 523 | Train Loss: 0.5792655 Vali Loss: 0.2905266 Best vali loss: 0.2844073

best validation loss 0.2844072779056617

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009225062942, 'e_layers': 1, 'learning_rate': 0.0034509285106, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0033195853648514996
Validation loss decreased (inf --> 0.2882).  Saving model state dict ...
Epoch: 1 cost time: 0.5499684810638428
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2881745 Best vali loss: 0.2881745
Updating learning rate to 0.002945551730917626
Epoch: 2 cost time: 0.26743459701538086
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2912351 Best vali loss: 0.2881745
Updating learning rate to 0.0023857708389414777
Epoch: 3 cost time: 0.30196285247802734
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.3002987 Best vali loss: 0.2881745

best validation loss 0.2881745205033264

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.001012004623, 'e_layers': 3, 'learning_rate': 0.000825808451, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3056703
	speed: 0.0105s/iter; left time: 26.5130s
	iters: 200, epoch: 4 | loss: 0.6303140
	speed: 0.0047s/iter; left time: 11.4368s
	iters: 300, epoch: 4 | loss: 0.7822865
	speed: 0.0048s/iter; left time: 11.0351s
	iters: 400, epoch: 4 | loss: 1.3220909
	speed: 0.0046s/iter; left time: 10.1177s
	iters: 500, epoch: 4 | loss: 0.2456456
	speed: 0.0048s/iter; left time: 10.0598s
Updating learning rate to 0.000103226056375
Epoch: 4 cost time: 2.7646267414093018
Epoch: 4, Steps: 523 | Train Loss: 0.6572014 Vali Loss: 0.2918392 Best vali loss: 0.2844073
	iters: 100, epoch: 5 | loss: 0.4861993
	speed: 0.0101s/iter; left time: 20.2205s
	iters: 200, epoch: 5 | loss: 0.3647348
	speed: 0.0046s/iter; left time: 8.7356s
	iters: 300, epoch: 5 | loss: 0.4003874
	speed: 0.0050s/iter; left time: 8.9301s
	iters: 400, epoch: 5 | loss: 0.3068690
	speed: 0.0046s/iter; left time: 7.8086s
	iters: 500, epoch: 5 | loss: 0.3604410
	speed: 0.0050s/iter; left time: 7.8988s
Updating learning rate to 5.16130281875e-05
Epoch: 5 cost time: 2.5331523418426514
Epoch: 5, Steps: 523 | Train Loss: 0.3837263 Vali Loss: 0.2946341 Best vali loss: 0.2844073
	iters: 100, epoch: 6 | loss: 0.4907622
	speed: 0.0103s/iter; left time: 15.1442s
	iters: 200, epoch: 6 | loss: 0.2921821
	speed: 0.0051s/iter; left time: 7.0434s
	iters: 300, epoch: 6 | loss: 0.4998675
	speed: 0.0052s/iter; left time: 6.5956s
	iters: 400, epoch: 6 | loss: 0.3033708
	speed: 0.0041s/iter; left time: 4.8502s
	iters: 500, epoch: 6 | loss: 1.0090145
	speed: 0.0042s/iter; left time: 4.4982s
Updating learning rate to 2.580651409375e-05
Epoch: 6 cost time: 2.509751319885254
Epoch: 6, Steps: 523 | Train Loss: 0.5190394 Vali Loss: 0.2951030 Best vali loss: 0.2844073
	iters: 100, epoch: 7 | loss: 0.5248691
	speed: 0.0137s/iter; left time: 12.9661s
	iters: 200, epoch: 7 | loss: 0.3239051
	speed: 0.0054s/iter; left time: 4.5339s
	iters: 300, epoch: 7 | loss: 0.7017692
	speed: 0.0063s/iter; left time: 4.6815s
	iters: 400, epoch: 7 | loss: 0.2323846
	speed: 0.0058s/iter; left time: 3.7580s
	iters: 500, epoch: 7 | loss: 0.2201268
	speed: 0.0055s/iter; left time: 2.9870s
Updating learning rate to 1.2903257046875e-05
Epoch: 7 cost time: 3.074068546295166
Epoch: 7, Steps: 523 | Train Loss: 0.4006110 Vali Loss: 0.2960419 Best vali loss: 0.2844073
	iters: 100, epoch: 8 | loss: 0.6917209
	speed: 0.0117s/iter; left time: 4.9819s
	iters: 200, epoch: 8 | loss: 0.4272004
	speed: 0.0054s/iter; left time: 1.7596s
	iters: 300, epoch: 8 | loss: 0.2401606
	speed: 0.0055s/iter; left time: 1.2338s
	iters: 400, epoch: 8 | loss: 0.3054291
	speed: 0.0052s/iter; left time: 0.6500s
	iters: 500, epoch: 8 | loss: 0.6269851
	speed: 0.0053s/iter; left time: 0.1264s
Updating learning rate to 6.4516285234375e-06
Epoch: 8 cost time: 2.8089873790740967
Epoch: 8, Steps: 523 | Train Loss: 0.4582992 Vali Loss: 0.2967772 Best vali loss: 0.2844073

best validation loss 0.2844072779056617

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0098036929311, 'e_layers': 1, 'learning_rate': 0.000566823774, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5848899
	speed: 0.0092s/iter; left time: 18.3004s
	iters: 200, epoch: 1 | loss: 0.3614042
	speed: 0.0032s/iter; left time: 6.0754s
Updating learning rate to 0.000566823774
Validation loss decreased (inf --> 0.2868).  Saving model state dict ...
Epoch: 1 cost time: 1.1675283908843994
Epoch: 1, Steps: 262 | Train Loss: 0.4731471 Vali Loss: 0.2868201 Best vali loss: 0.2868201
	iters: 100, epoch: 2 | loss: 0.4539952
	speed: 0.0082s/iter; left time: 14.2583s
	iters: 200, epoch: 2 | loss: 0.9559633
	speed: 0.0037s/iter; left time: 6.0082s
Updating learning rate to 0.000283411887
Validation loss decreased (0.2868 --> 0.2852).  Saving model state dict ...
Epoch: 2 cost time: 0.9843032360076904
Epoch: 2, Steps: 262 | Train Loss: 0.7049793 Vali Loss: 0.2852144 Best vali loss: 0.2852144
	iters: 100, epoch: 3 | loss: 0.4040041
	speed: 0.0090s/iter; left time: 13.3305s
	iters: 200, epoch: 3 | loss: 0.4792086
	speed: 0.0028s/iter; left time: 3.8470s
Updating learning rate to 0.0001417059435
Epoch: 3 cost time: 0.8517663478851318
Epoch: 3, Steps: 262 | Train Loss: 0.4416063 Vali Loss: 0.2960803 Best vali loss: 0.2852144
	iters: 100, epoch: 4 | loss: 0.4398022
	speed: 0.0067s/iter; left time: 8.1267s
	iters: 200, epoch: 4 | loss: 0.7512544
	speed: 0.0044s/iter; left time: 4.9274s
Updating learning rate to 7.085297175e-05
Epoch: 4 cost time: 0.9816780090332031
Epoch: 4, Steps: 262 | Train Loss: 0.5955283 Vali Loss: 0.2883398 Best vali loss: 0.2852144
	iters: 100, epoch: 5 | loss: 0.4252404
	speed: 0.0094s/iter; left time: 8.9286s
	iters: 200, epoch: 5 | loss: 0.5171923
	speed: 0.0046s/iter; left time: 3.8636s
Updating learning rate to 3.5426485875e-05
Epoch: 5 cost time: 1.0766558647155762
Epoch: 5, Steps: 262 | Train Loss: 0.4712164 Vali Loss: 0.2896986 Best vali loss: 0.2852144
	iters: 100, epoch: 6 | loss: 0.3732666
	speed: 0.0068s/iter; left time: 4.6711s
	iters: 200, epoch: 6 | loss: 0.5059674
	speed: 0.0025s/iter; left time: 1.4787s
Updating learning rate to 1.77132429375e-05
Epoch: 6 cost time: 0.7410550117492676
Epoch: 6, Steps: 262 | Train Loss: 0.4396170 Vali Loss: 0.2893251 Best vali loss: 0.2852144
	iters: 100, epoch: 7 | loss: 0.3704195
	speed: 0.0090s/iter; left time: 3.8358s
	iters: 200, epoch: 7 | loss: 0.5130497
	speed: 0.0037s/iter; left time: 1.2025s
Updating learning rate to 8.85662146875e-06
Epoch: 7 cost time: 1.0928764343261719
Epoch: 7, Steps: 262 | Train Loss: 0.4417346 Vali Loss: 0.2898367 Best vali loss: 0.2852144
	iters: 100, epoch: 8 | loss: 0.3209943
	speed: 0.0083s/iter; left time: 1.3479s
	iters: 200, epoch: 8 | loss: 0.4787612
	speed: 0.0027s/iter; left time: 0.1713s
Updating learning rate to 4.428310734375e-06
Epoch: 8 cost time: 0.7546496391296387
Epoch: 8, Steps: 262 | Train Loss: 0.3998778 Vali Loss: 0.2897213 Best vali loss: 0.2852144

best validation loss 0.2852144154441893

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0028852829179, 'e_layers': 3, 'learning_rate': 0.0002361458543, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4142794
	speed: 0.0108s/iter; left time: 21.5953s
	iters: 200, epoch: 1 | loss: 0.3341590
	speed: 0.0052s/iter; left time: 9.8342s
Updating learning rate to 0.0002361458543
Validation loss decreased (inf --> 0.2801).  Saving model state dict ...
Epoch: 1 cost time: 1.6480252742767334
Epoch: 1, Steps: 262 | Train Loss: 0.3742192 Vali Loss: 0.2800848 Best vali loss: 0.2800848
	iters: 100, epoch: 2 | loss: 0.4216407
	speed: 0.0113s/iter; left time: 19.5664s
	iters: 200, epoch: 2 | loss: 0.6617285
	speed: 0.0050s/iter; left time: 8.2238s
Updating learning rate to 0.00011807292715
Validation loss decreased (0.2801 --> 0.2784).  Saving model state dict ...
Epoch: 2 cost time: 1.3616130352020264
Epoch: 2, Steps: 262 | Train Loss: 0.5416846 Vali Loss: 0.2783789 Best vali loss: 0.2783789
	iters: 100, epoch: 3 | loss: 0.7024217
	speed: 0.0116s/iter; left time: 17.1202s
	iters: 200, epoch: 3 | loss: 0.4595647
	speed: 0.0053s/iter; left time: 7.2417s
Updating learning rate to 5.9036463575e-05
Epoch: 3 cost time: 1.4451158046722412
Epoch: 3, Steps: 262 | Train Loss: 0.5809932 Vali Loss: 0.2859111 Best vali loss: 0.2783789
	iters: 100, epoch: 4 | loss: 0.5440005
	speed: 0.0115s/iter; left time: 13.9709s
	iters: 200, epoch: 4 | loss: 0.3743720
	speed: 0.0055s/iter; left time: 6.0927s
Updating learning rate to 2.95182317875e-05
Epoch: 4 cost time: 1.4290611743927002
Epoch: 4, Steps: 262 | Train Loss: 0.4591863 Vali Loss: 0.2822184 Best vali loss: 0.2783789
	iters: 100, epoch: 5 | loss: 0.5518355
	speed: 0.0111s/iter; left time: 10.5325s
	iters: 200, epoch: 5 | loss: 0.3202342
	speed: 0.0050s/iter; left time: 4.2268s
Updating learning rate to 1.475911589375e-05
Epoch: 5 cost time: 1.364605188369751
Epoch: 5, Steps: 262 | Train Loss: 0.4360349 Vali Loss: 0.2827592 Best vali loss: 0.2783789
	iters: 100, epoch: 6 | loss: 0.5933636
	speed: 0.0114s/iter; left time: 7.8499s
	iters: 200, epoch: 6 | loss: 0.2891010
	speed: 0.0052s/iter; left time: 3.0627s
Updating learning rate to 7.379557946875e-06
Epoch: 6 cost time: 1.4188826084136963
Epoch: 6, Steps: 262 | Train Loss: 0.4412323 Vali Loss: 0.2876513 Best vali loss: 0.2783789
	iters: 100, epoch: 7 | loss: 0.4064880
	speed: 0.0112s/iter; left time: 4.7409s
	iters: 200, epoch: 7 | loss: 0.4591218
	speed: 0.0051s/iter; left time: 1.6668s
Updating learning rate to 3.6897789734375e-06
Epoch: 7 cost time: 1.364473819732666
Epoch: 7, Steps: 262 | Train Loss: 0.4328049 Vali Loss: 0.2845325 Best vali loss: 0.2783789
	iters: 100, epoch: 8 | loss: 0.3472529
	speed: 0.0104s/iter; left time: 1.7020s
	iters: 200, epoch: 8 | loss: 0.3292884
	speed: 0.0057s/iter; left time: 0.3571s
Updating learning rate to 1.84488948671875e-06
Epoch: 8 cost time: 1.4302594661712646
Epoch: 8, Steps: 262 | Train Loss: 0.3382707 Vali Loss: 0.2839566 Best vali loss: 0.2783789

best validation loss 0.27837885945603147

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0012835601999, 'e_layers': 3, 'learning_rate': 0.0002687323862, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00025850436876654926
Validation loss decreased (inf --> 0.2848).  Saving model state dict ...
Epoch: 1 cost time: 0.7513067722320557
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2847741 Best vali loss: 0.2847741
Updating learning rate to 0.00022937743940323107
Validation loss decreased (0.2848 --> 0.2807).  Saving model state dict ...
Epoch: 2 cost time: 0.3787391185760498
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2806632 Best vali loss: 0.2806632
Updating learning rate to 0.00018578590906933844
Validation loss decreased (0.2807 --> 0.2805).  Saving model state dict ...
Epoch: 3 cost time: 0.39037036895751953
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2804762 Best vali loss: 0.2804762

best validation loss 0.28047615396639547

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 1, 'learning_rate': 0.0005898855996, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005898855996
Validation loss decreased (inf --> 0.2811).  Saving model state dict ...
Epoch: 1 cost time: 0.5508460998535156
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2810909 Best vali loss: 0.2810909
Updating learning rate to 0.0002949427998
Epoch: 2 cost time: 0.30748677253723145
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2812083 Best vali loss: 0.2810909
Updating learning rate to 0.0001474713999
Validation loss decreased (0.2811 --> 0.2797).  Saving model state dict ...
Epoch: 3 cost time: 0.29939985275268555
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2797050 Best vali loss: 0.2797050

best validation loss 0.2797049872047975

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0016289526749, 'e_layers': 4, 'learning_rate': 0.0001397169929, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4418657
	speed: 0.0113s/iter; left time: 46.0246s
	iters: 200, epoch: 1 | loss: 0.4671458
	speed: 0.0060s/iter; left time: 23.9346s
	iters: 300, epoch: 1 | loss: 0.7977628
	speed: 0.0055s/iter; left time: 21.5559s
	iters: 400, epoch: 1 | loss: 0.5938653
	speed: 0.0064s/iter; left time: 24.1508s
	iters: 500, epoch: 1 | loss: 0.8906583
	speed: 0.0061s/iter; left time: 22.4267s
Updating learning rate to 0.0001397169929
Validation loss decreased (inf --> 0.2860).  Saving model state dict ...
Epoch: 1 cost time: 3.415297031402588
Epoch: 1, Steps: 523 | Train Loss: 0.6382596 Vali Loss: 0.2860409 Best vali loss: 0.2860409
	iters: 100, epoch: 2 | loss: 0.5314294
	speed: 0.0128s/iter; left time: 45.5914s
	iters: 200, epoch: 2 | loss: 0.3441490
	speed: 0.0062s/iter; left time: 21.3380s
	iters: 300, epoch: 2 | loss: 0.2457416
	speed: 0.0059s/iter; left time: 19.9119s
	iters: 400, epoch: 2 | loss: 0.8091230
	speed: 0.0063s/iter; left time: 20.5835s
	iters: 500, epoch: 2 | loss: 0.2469048
	speed: 0.0060s/iter; left time: 19.0956s
Updating learning rate to 6.985849645e-05
Validation loss decreased (0.2860 --> 0.2834).  Saving model state dict ...
Epoch: 2 cost time: 3.1878652572631836
Epoch: 2, Steps: 523 | Train Loss: 0.4354696 Vali Loss: 0.2833674 Best vali loss: 0.2833674
	iters: 100, epoch: 3 | loss: 0.7064902
	speed: 0.0109s/iter; left time: 33.2333s
	iters: 200, epoch: 3 | loss: 0.8447778
	speed: 0.0076s/iter; left time: 22.3155s
	iters: 300, epoch: 3 | loss: 0.3084333
	speed: 0.0066s/iter; left time: 18.7602s
	iters: 400, epoch: 3 | loss: 0.5158384
	speed: 0.0073s/iter; left time: 20.0216s
	iters: 500, epoch: 3 | loss: 0.2449679
	speed: 0.0073s/iter; left time: 19.3806s
Updating learning rate to 3.4929248225e-05
Validation loss decreased (0.2834 --> 0.2813).  Saving model state dict ...
Epoch: 3 cost time: 3.6428005695343018
Epoch: 3, Steps: 523 | Train Loss: 0.5241015 Vali Loss: 0.2812542 Best vali loss: 0.2812542

best validation loss 0.281254231697035

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 1, 'learning_rate': 0.0005898855996, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 7.373569995e-05
Validation loss decreased (0.2797 --> 0.2787).  Saving model state dict ...
Epoch: 4 cost time: 0.5697741508483887
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2787295 Best vali loss: 0.2787295
Updating learning rate to 3.6867849975e-05
Epoch: 5 cost time: 0.3211848735809326
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2806028 Best vali loss: 0.2787295
Updating learning rate to 1.84339249875e-05
Epoch: 6 cost time: 0.3154482841491699
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2827499 Best vali loss: 0.2787295
Updating learning rate to 9.21696249375e-06
Epoch: 7 cost time: 0.3264157772064209
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2826984 Best vali loss: 0.2787295
Updating learning rate to 4.608481246875e-06
Epoch: 8 cost time: 0.319674015045166
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2829727 Best vali loss: 0.2787295

best validation loss 0.2787295421644319

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0057222340446, 'e_layers': 2, 'learning_rate': 0.0034968811975, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6243322
	speed: 0.0104s/iter; left time: 20.7613s
	iters: 200, epoch: 1 | loss: 0.5781757
	speed: 0.0053s/iter; left time: 10.0902s
Updating learning rate to 0.0033637890817469042
Validation loss decreased (inf --> 0.3251).  Saving model state dict ...
Epoch: 1 cost time: 1.6350276470184326
Epoch: 1, Steps: 262 | Train Loss: 0.6012540 Vali Loss: 0.3251416 Best vali loss: 0.3251416
	iters: 100, epoch: 2 | loss: 0.6161239
	speed: 0.0112s/iter; left time: 19.4906s
	iters: 200, epoch: 2 | loss: 0.5527443
	speed: 0.0054s/iter; left time: 8.9041s
Updating learning rate to 0.002984774802627992
Validation loss decreased (0.3251 --> 0.3044).  Saving model state dict ...
Epoch: 2 cost time: 1.3917272090911865
Epoch: 2, Steps: 262 | Train Loss: 0.5844341 Vali Loss: 0.3043825 Best vali loss: 0.3043825
	iters: 100, epoch: 3 | loss: 0.4412312
	speed: 0.0113s/iter; left time: 16.7090s
	iters: 200, epoch: 3 | loss: 0.4203250
	speed: 0.0050s/iter; left time: 6.8457s
Updating learning rate to 0.002417539848366123
Validation loss decreased (0.3044 --> 0.3024).  Saving model state dict ...
Epoch: 3 cost time: 1.3343284130096436
Epoch: 3, Steps: 262 | Train Loss: 0.4307781 Vali Loss: 0.3024459 Best vali loss: 0.3024459
	iters: 100, epoch: 4 | loss: 0.9265187
	speed: 0.0109s/iter; left time: 13.1671s
	iters: 200, epoch: 4 | loss: 0.8005319
	speed: 0.0035s/iter; left time: 3.8743s
Updating learning rate to 0.00174844059875
Epoch: 4 cost time: 1.0442805290222168
Epoch: 4, Steps: 262 | Train Loss: 0.8635253 Vali Loss: 0.3036677 Best vali loss: 0.3024459
	iters: 100, epoch: 5 | loss: 0.4072216
	speed: 0.0082s/iter; left time: 7.7941s
	iters: 200, epoch: 5 | loss: 0.6540329
	speed: 0.0033s/iter; left time: 2.8371s
Updating learning rate to 0.0010793413491338773
Epoch: 5 cost time: 0.9358055591583252
Epoch: 5, Steps: 262 | Train Loss: 0.5306273 Vali Loss: 0.3106275 Best vali loss: 0.3024459
	iters: 100, epoch: 6 | loss: 0.3709877
	speed: 0.0092s/iter; left time: 6.2925s
	iters: 200, epoch: 6 | loss: 0.5696226
	speed: 0.0058s/iter; left time: 3.3795s
Updating learning rate to 0.0005121063948720077
Epoch: 6 cost time: 1.3517451286315918
Epoch: 6, Steps: 262 | Train Loss: 0.4703051 Vali Loss: 0.3052598 Best vali loss: 0.3024459
	iters: 100, epoch: 7 | loss: 0.6357229
	speed: 0.0123s/iter; left time: 5.2222s
	iters: 200, epoch: 7 | loss: 0.3289149
	speed: 0.0052s/iter; left time: 1.6802s
Updating learning rate to 0.00013309211575309574
Epoch: 7 cost time: 1.4935200214385986
Epoch: 7, Steps: 262 | Train Loss: 0.4823189 Vali Loss: 0.3054885 Best vali loss: 0.3024459
	iters: 100, epoch: 8 | loss: 0.7598801
	speed: 0.0107s/iter; left time: 1.7489s
	iters: 200, epoch: 8 | loss: 0.3059438
	speed: 0.0033s/iter; left time: 0.2064s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9449760913848877
Epoch: 8, Steps: 262 | Train Loss: 0.5329120 Vali Loss: 0.3113116 Best vali loss: 0.3024459

best validation loss 0.3024458791541096

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0094054645347, 'e_layers': 3, 'learning_rate': 8.14571881e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7091748
	speed: 0.0107s/iter; left time: 21.4029s
	iters: 200, epoch: 1 | loss: 0.7905321
	speed: 0.0056s/iter; left time: 10.5611s
Updating learning rate to 8.14571881e-05
Validation loss decreased (inf --> 0.2800).  Saving model state dict ...
Epoch: 1 cost time: 1.7157938480377197
Epoch: 1, Steps: 262 | Train Loss: 0.7498534 Vali Loss: 0.2800472 Best vali loss: 0.2800472
	iters: 100, epoch: 2 | loss: 0.4194699
	speed: 0.0117s/iter; left time: 20.2472s
	iters: 200, epoch: 2 | loss: 0.4166521
	speed: 0.0055s/iter; left time: 9.0460s
Updating learning rate to 4.072859405e-05
Epoch: 2 cost time: 1.4398503303527832
Epoch: 2, Steps: 262 | Train Loss: 0.4180610 Vali Loss: 0.2846461 Best vali loss: 0.2800472
	iters: 100, epoch: 3 | loss: 0.3907387
	speed: 0.0115s/iter; left time: 16.9086s
	iters: 200, epoch: 3 | loss: 0.4223980
	speed: 0.0045s/iter; left time: 6.2064s
Updating learning rate to 2.0364297025e-05
Validation loss decreased (0.2800 --> 0.2776).  Saving model state dict ...
Epoch: 3 cost time: 1.271549940109253
Epoch: 3, Steps: 262 | Train Loss: 0.4065683 Vali Loss: 0.2775901 Best vali loss: 0.2775901
	iters: 100, epoch: 4 | loss: 0.5053040
	speed: 0.0112s/iter; left time: 13.5375s
	iters: 200, epoch: 4 | loss: 0.6305227
	speed: 0.0053s/iter; left time: 5.8663s
Updating learning rate to 1.01821485125e-05
Epoch: 4 cost time: 1.4417216777801514
Epoch: 4, Steps: 262 | Train Loss: 0.5679133 Vali Loss: 0.2792345 Best vali loss: 0.2775901
	iters: 100, epoch: 5 | loss: 0.7036871
	speed: 0.0119s/iter; left time: 11.2857s
	iters: 200, epoch: 5 | loss: 0.3264669
	speed: 0.0056s/iter; left time: 4.7716s
Updating learning rate to 5.09107425625e-06
Epoch: 5 cost time: 1.5028724670410156
Epoch: 5, Steps: 262 | Train Loss: 0.5150770 Vali Loss: 0.2784536 Best vali loss: 0.2775901
	iters: 100, epoch: 6 | loss: 0.4884107
	speed: 0.0120s/iter; left time: 8.2608s
	iters: 200, epoch: 6 | loss: 0.6371990
	speed: 0.0055s/iter; left time: 3.2234s
Updating learning rate to 2.545537128125e-06
Epoch: 6 cost time: 1.494459867477417
Epoch: 6, Steps: 262 | Train Loss: 0.5628048 Vali Loss: 0.2783276 Best vali loss: 0.2775901
	iters: 100, epoch: 7 | loss: 0.4268785
	speed: 0.0124s/iter; left time: 5.2762s
	iters: 200, epoch: 7 | loss: 0.3711595
	speed: 0.0055s/iter; left time: 1.7772s
Updating learning rate to 1.2727685640625e-06
Epoch: 7 cost time: 1.4577620029449463
Epoch: 7, Steps: 262 | Train Loss: 0.3990190 Vali Loss: 0.2789874 Best vali loss: 0.2775901
	iters: 100, epoch: 8 | loss: 0.4895169
	speed: 0.0106s/iter; left time: 1.7260s
	iters: 200, epoch: 8 | loss: 0.2890953
	speed: 0.0071s/iter; left time: 0.4456s
Updating learning rate to 6.3638428203125e-07
Epoch: 8 cost time: 1.6619062423706055
Epoch: 8, Steps: 262 | Train Loss: 0.3893061 Vali Loss: 0.2790003 Best vali loss: 0.2775901

best validation loss 0.27759006006560744

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041361621611, 'e_layers': 2, 'learning_rate': 7.55918174e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3719026
	speed: 0.0120s/iter; left time: 11.4211s
Updating learning rate to 7.271477516059527e-05
Validation loss decreased (inf --> 0.2820).  Saving model state dict ...
Epoch: 1 cost time: 1.049973726272583
Epoch: 1, Steps: 131 | Train Loss: 0.3719026 Vali Loss: 0.2819635 Best vali loss: 0.2819635
	iters: 100, epoch: 2 | loss: 0.3255461
	speed: 0.0075s/iter; left time: 6.1652s
Updating learning rate to 6.452165204287762e-05
Validation loss decreased (0.2820 --> 0.2780).  Saving model state dict ...
Epoch: 2 cost time: 0.5896639823913574
Epoch: 2, Steps: 131 | Train Loss: 0.3255461 Vali Loss: 0.2780186 Best vali loss: 0.2780186
	iters: 100, epoch: 3 | loss: 0.4008669
	speed: 0.0107s/iter; left time: 7.3212s
Updating learning rate to 5.2259776770673556e-05
Validation loss decreased (0.2780 --> 0.2733).  Saving model state dict ...
Epoch: 3 cost time: 0.9229264259338379
Epoch: 3, Steps: 131 | Train Loss: 0.4008669 Vali Loss: 0.2733425 Best vali loss: 0.2733425

best validation loss 0.2733424915095695

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0048004007546, 'e_layers': 3, 'learning_rate': 0.0014807515313, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6876848
	speed: 0.0122s/iter; left time: 24.4145s
	iters: 200, epoch: 1 | loss: 0.6982886
	speed: 0.0061s/iter; left time: 11.6344s
Updating learning rate to 0.0014807515313
Validation loss decreased (inf --> 0.2917).  Saving model state dict ...
Epoch: 1 cost time: 1.964773416519165
Epoch: 1, Steps: 262 | Train Loss: 0.6929867 Vali Loss: 0.2916972 Best vali loss: 0.2916972
	iters: 100, epoch: 2 | loss: 0.8882697
	speed: 0.0137s/iter; left time: 23.8053s
	iters: 200, epoch: 2 | loss: 0.5068265
	speed: 0.0060s/iter; left time: 9.8839s
Updating learning rate to 0.00074037576565
Epoch: 2 cost time: 1.511845588684082
Epoch: 2, Steps: 262 | Train Loss: 0.6975481 Vali Loss: 0.3009039 Best vali loss: 0.2916972
	iters: 100, epoch: 3 | loss: 0.8133527
	speed: 0.0097s/iter; left time: 14.2777s
	iters: 200, epoch: 3 | loss: 0.8592174
	speed: 0.0056s/iter; left time: 7.6460s
Updating learning rate to 0.000370187882825
Epoch: 3 cost time: 1.4145071506500244
Epoch: 3, Steps: 262 | Train Loss: 0.8362851 Vali Loss: 0.2959469 Best vali loss: 0.2916972

best validation loss 0.29169724282610143

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013851757765, 'e_layers': 4, 'learning_rate': 7.13798299e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8670420
	speed: 0.0136s/iter; left time: 27.1352s
	iters: 200, epoch: 1 | loss: 0.4596303
	speed: 0.0073s/iter; left time: 13.7919s
Updating learning rate to 6.866309688937358e-05
Validation loss decreased (inf --> 0.2925).  Saving model state dict ...
Epoch: 1 cost time: 2.189617872238159
Epoch: 1, Steps: 262 | Train Loss: 0.6633361 Vali Loss: 0.2925259 Best vali loss: 0.2925259
	iters: 100, epoch: 2 | loss: 0.3795021
	speed: 0.0143s/iter; left time: 24.7567s
	iters: 200, epoch: 2 | loss: 0.6279529
	speed: 0.0069s/iter; left time: 11.3621s
Updating learning rate to 6.0926495831116134e-05
Validation loss decreased (0.2925 --> 0.2821).  Saving model state dict ...
Epoch: 2 cost time: 1.861746072769165
Epoch: 2, Steps: 262 | Train Loss: 0.5037275 Vali Loss: 0.2821312 Best vali loss: 0.2821312
	iters: 100, epoch: 3 | loss: 0.6754808
	speed: 0.0145s/iter; left time: 21.3308s
	iters: 200, epoch: 3 | loss: 0.7614603
	speed: 0.0069s/iter; left time: 9.4903s
Updating learning rate to 4.934785410388413e-05
Validation loss decreased (0.2821 --> 0.2801).  Saving model state dict ...
Epoch: 3 cost time: 1.815483570098877
Epoch: 3, Steps: 262 | Train Loss: 0.7184705 Vali Loss: 0.2800686 Best vali loss: 0.2800686

best validation loss 0.28006860418761254

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041361621611, 'e_layers': 2, 'learning_rate': 7.55918174e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3487560
	speed: 0.0114s/iter; left time: 6.3489s
Updating learning rate to 3.77959087e-05
Epoch: 4 cost time: 0.9799754619598389
Epoch: 4, Steps: 131 | Train Loss: 0.3487560 Vali Loss: 0.2770917 Best vali loss: 0.2733425
	iters: 100, epoch: 5 | loss: 0.2988242
	speed: 0.0093s/iter; left time: 3.9723s
Updating learning rate to 2.333204062932644e-05
Epoch: 5 cost time: 0.7777903079986572
Epoch: 5, Steps: 131 | Train Loss: 0.2988242 Vali Loss: 0.2862843 Best vali loss: 0.2733425
	iters: 100, epoch: 6 | loss: 0.3917389
	speed: 0.0098s/iter; left time: 2.8745s
Updating learning rate to 1.1070165357122374e-05
Epoch: 6 cost time: 0.7824211120605469
Epoch: 6, Steps: 131 | Train Loss: 0.3917389 Vali Loss: 0.2886130 Best vali loss: 0.2733425
	iters: 100, epoch: 7 | loss: 0.4537202
	speed: 0.0097s/iter; left time: 1.5800s
Updating learning rate to 2.8770422394047244e-06
Epoch: 7 cost time: 0.7486233711242676
Epoch: 7, Steps: 131 | Train Loss: 0.4537202 Vali Loss: 0.2891119 Best vali loss: 0.2733425
	iters: 100, epoch: 8 | loss: 0.3622631
	speed: 0.0091s/iter; left time: 0.2919s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.763404369354248
Epoch: 8, Steps: 131 | Train Loss: 0.3622631 Vali Loss: 0.2885267 Best vali loss: 0.2733425

best validation loss 0.2733424915095695

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0031194239568, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.2941).  Saving model state dict ...
Epoch: 1 cost time: 0.7885551452636719
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2940954 Best vali loss: 0.2940954
Updating learning rate to 0.00034048964815
Validation loss decreased (0.2941 --> 0.2847).  Saving model state dict ...
Epoch: 2 cost time: 0.5586183071136475
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2846754 Best vali loss: 0.2846754
Updating learning rate to 0.000170244824075
Epoch: 3 cost time: 0.5608978271484375
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2858902 Best vali loss: 0.2846754
Updating learning rate to 8.51224120375e-05
Validation loss decreased (0.2847 --> 0.2842).  Saving model state dict ...
Epoch: 4 cost time: 0.5244572162628174
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2841915 Best vali loss: 0.2841915
Updating learning rate to 4.256120601875e-05
Validation loss decreased (0.2842 --> 0.2839).  Saving model state dict ...
Epoch: 5 cost time: 0.4763143062591553
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2839164 Best vali loss: 0.2839164
Updating learning rate to 2.1280603009375e-05
Epoch: 6 cost time: 0.5106692314147949
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2845271 Best vali loss: 0.2839164
Updating learning rate to 1.06403015046875e-05
Epoch: 7 cost time: 0.5527706146240234
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2846225 Best vali loss: 0.2839164
Updating learning rate to 5.32015075234375e-06
Epoch: 8 cost time: 0.5471508502960205
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2847434 Best vali loss: 0.2839164

best validation loss 0.2839163955745754

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0023685291638, 'e_layers': 1, 'learning_rate': 0.0009803611309, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8220043
	speed: 0.0080s/iter; left time: 32.7717s
	iters: 200, epoch: 1 | loss: 0.5672210
	speed: 0.0024s/iter; left time: 9.5752s
	iters: 300, epoch: 1 | loss: 0.3496604
	speed: 0.0031s/iter; left time: 12.0103s
	iters: 400, epoch: 1 | loss: 0.5942169
	speed: 0.0035s/iter; left time: 13.3630s
	iters: 500, epoch: 1 | loss: 0.2871198
	speed: 0.0034s/iter; left time: 12.6936s
Updating learning rate to 0.0009430483571040641
Validation loss decreased (inf --> 0.2959).  Saving model state dict ...
Epoch: 1 cost time: 1.8557696342468262
Epoch: 1, Steps: 523 | Train Loss: 0.5240445 Vali Loss: 0.2959073 Best vali loss: 0.2959073
	iters: 100, epoch: 2 | loss: 0.2649637
	speed: 0.0089s/iter; left time: 31.6245s
	iters: 200, epoch: 2 | loss: 0.3848686
	speed: 0.0028s/iter; left time: 9.6557s
	iters: 300, epoch: 2 | loss: 0.8977115
	speed: 0.0030s/iter; left time: 9.9768s
	iters: 400, epoch: 2 | loss: 0.3274689
	speed: 0.0036s/iter; left time: 11.7082s
	iters: 500, epoch: 2 | loss: 0.4319892
	speed: 0.0036s/iter; left time: 11.4674s
Updating learning rate to 0.0008367905672855512
Validation loss decreased (0.2959 --> 0.2876).  Saving model state dict ...
Epoch: 2 cost time: 1.720454216003418
Epoch: 2, Steps: 523 | Train Loss: 0.4614004 Vali Loss: 0.2875629 Best vali loss: 0.2875629
	iters: 100, epoch: 3 | loss: 0.6840628
	speed: 0.0092s/iter; left time: 27.9959s
	iters: 200, epoch: 3 | loss: 0.3430277
	speed: 0.0027s/iter; left time: 7.9913s
	iters: 300, epoch: 3 | loss: 0.4572670
	speed: 0.0028s/iter; left time: 8.0269s
	iters: 400, epoch: 3 | loss: 0.3145639
	speed: 0.0038s/iter; left time: 10.2950s
	iters: 500, epoch: 3 | loss: 0.3664166
	speed: 0.0037s/iter; left time: 9.6561s
Updating learning rate to 0.0006777645467150665
Epoch: 3 cost time: 1.7468562126159668
Epoch: 3, Steps: 523 | Train Loss: 0.4330676 Vali Loss: 0.3077475 Best vali loss: 0.2875629
	iters: 100, epoch: 4 | loss: 0.4839902
	speed: 0.0089s/iter; left time: 22.4513s
	iters: 200, epoch: 4 | loss: 0.2920392
	speed: 0.0027s/iter; left time: 6.6273s
	iters: 300, epoch: 4 | loss: 0.3108235
	speed: 0.0026s/iter; left time: 6.0071s
	iters: 400, epoch: 4 | loss: 0.7454143
	speed: 0.0024s/iter; left time: 5.2246s
	iters: 500, epoch: 4 | loss: 0.4110641
	speed: 0.0023s/iter; left time: 4.9024s
Updating learning rate to 0.00049018056545
Epoch: 4 cost time: 1.4178130626678467
Epoch: 4, Steps: 523 | Train Loss: 0.4486662 Vali Loss: 0.3349539 Best vali loss: 0.2875629
	iters: 100, epoch: 5 | loss: 0.4170020
	speed: 0.0080s/iter; left time: 16.0128s
	iters: 200, epoch: 5 | loss: 0.5023174
	speed: 0.0035s/iter; left time: 6.6730s
	iters: 300, epoch: 5 | loss: 0.3130018
	speed: 0.0033s/iter; left time: 5.9222s
	iters: 400, epoch: 5 | loss: 0.3867194
	speed: 0.0040s/iter; left time: 6.7735s
	iters: 500, epoch: 5 | loss: 0.4561618
	speed: 0.0029s/iter; left time: 4.5818s
Updating learning rate to 0.0003025965841849335
Epoch: 5 cost time: 1.8494923114776611
Epoch: 5, Steps: 523 | Train Loss: 0.4150405 Vali Loss: 0.3388157 Best vali loss: 0.2875629
	iters: 100, epoch: 6 | loss: 0.4885745
	speed: 0.0063s/iter; left time: 9.3026s
	iters: 200, epoch: 6 | loss: 0.2494746
	speed: 0.0028s/iter; left time: 3.8336s
	iters: 300, epoch: 6 | loss: 0.3317574
	speed: 0.0034s/iter; left time: 4.2931s
	iters: 400, epoch: 6 | loss: 0.3643584
	speed: 0.0036s/iter; left time: 4.1598s
	iters: 500, epoch: 6 | loss: 0.3339832
	speed: 0.0036s/iter; left time: 3.8340s
Updating learning rate to 0.00014357056361444874
Epoch: 6 cost time: 1.7082223892211914
Epoch: 6, Steps: 523 | Train Loss: 0.3536296 Vali Loss: 0.3582991 Best vali loss: 0.2875629
	iters: 100, epoch: 7 | loss: 0.2306415
	speed: 0.0083s/iter; left time: 7.8622s
	iters: 200, epoch: 7 | loss: 0.5533869
	speed: 0.0028s/iter; left time: 2.3893s
	iters: 300, epoch: 7 | loss: 0.5129240
	speed: 0.0037s/iter; left time: 2.7384s
	iters: 400, epoch: 7 | loss: 0.2111683
	speed: 0.0037s/iter; left time: 2.3853s
	iters: 500, epoch: 7 | loss: 0.2435910
	speed: 0.0037s/iter; left time: 2.0161s
Updating learning rate to 3.7312773795935806e-05
Epoch: 7 cost time: 1.7876331806182861
Epoch: 7, Steps: 523 | Train Loss: 0.3503423 Vali Loss: 0.3599279 Best vali loss: 0.2875629
	iters: 100, epoch: 8 | loss: 0.3544723
	speed: 0.0085s/iter; left time: 3.5885s
	iters: 200, epoch: 8 | loss: 0.4275182
	speed: 0.0026s/iter; left time: 0.8320s
	iters: 300, epoch: 8 | loss: 0.2561761
	speed: 0.0033s/iter; left time: 0.7469s
	iters: 400, epoch: 8 | loss: 0.1607912
	speed: 0.0034s/iter; left time: 0.4171s
	iters: 500, epoch: 8 | loss: 0.2194203
	speed: 0.0034s/iter; left time: 0.0810s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6509363651275635
Epoch: 8, Steps: 523 | Train Loss: 0.2836756 Vali Loss: 0.3677282 Best vali loss: 0.2875629

best validation loss 0.28756292980592374

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012374140538, 'e_layers': 2, 'learning_rate': 0.0005328478516, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5984967
	speed: 0.0103s/iter; left time: 9.7551s
Updating learning rate to 0.0005328478516
Validation loss decreased (inf --> 0.2919).  Saving model state dict ...
Epoch: 1 cost time: 0.9079763889312744
Epoch: 1, Steps: 131 | Train Loss: 0.5984967 Vali Loss: 0.2918610 Best vali loss: 0.2918610
	iters: 100, epoch: 2 | loss: 0.4488603
	speed: 0.0079s/iter; left time: 6.4278s
Updating learning rate to 0.0002664239258
Validation loss decreased (0.2919 --> 0.2852).  Saving model state dict ...
Epoch: 2 cost time: 0.5985050201416016
Epoch: 2, Steps: 131 | Train Loss: 0.4488603 Vali Loss: 0.2852314 Best vali loss: 0.2852314
	iters: 100, epoch: 3 | loss: 0.8450987
	speed: 0.0072s/iter; left time: 4.9443s
Updating learning rate to 0.0001332119629
Epoch: 3 cost time: 0.5618910789489746
Epoch: 3, Steps: 131 | Train Loss: 0.8450987 Vali Loss: 0.2853079 Best vali loss: 0.2852314

best validation loss 0.28523138208697835

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0062416843763, 'e_layers': 1, 'learning_rate': 6.62506528e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6457228
	speed: 0.0081s/iter; left time: 32.9298s
	iters: 200, epoch: 1 | loss: 0.7359396
	speed: 0.0024s/iter; left time: 9.4692s
	iters: 300, epoch: 1 | loss: 0.4699262
	speed: 0.0024s/iter; left time: 9.2059s
	iters: 400, epoch: 1 | loss: 0.2495477
	speed: 0.0024s/iter; left time: 9.1597s
	iters: 500, epoch: 1 | loss: 0.6642177
	speed: 0.0022s/iter; left time: 7.9421s
Updating learning rate to 6.372913746871579e-05
Validation loss decreased (inf --> 0.2805).  Saving model state dict ...
Epoch: 1 cost time: 1.5113754272460938
Epoch: 1, Steps: 523 | Train Loss: 0.5530708 Vali Loss: 0.2805324 Best vali loss: 0.2805324
	iters: 100, epoch: 2 | loss: 0.3165736
	speed: 0.0058s/iter; left time: 20.8018s
	iters: 200, epoch: 2 | loss: 0.4471707
	speed: 0.0024s/iter; left time: 8.2182s
	iters: 300, epoch: 2 | loss: 0.5130196
	speed: 0.0029s/iter; left time: 9.8224s
	iters: 400, epoch: 2 | loss: 0.2875263
	speed: 0.0030s/iter; left time: 9.8776s
	iters: 500, epoch: 2 | loss: 0.4034411
	speed: 0.0032s/iter; left time: 10.0660s
Updating learning rate to 5.654846932645776e-05
Validation loss decreased (0.2805 --> 0.2787).  Saving model state dict ...
Epoch: 2 cost time: 1.4973704814910889
Epoch: 2, Steps: 523 | Train Loss: 0.3935463 Vali Loss: 0.2786646 Best vali loss: 0.2786646
	iters: 100, epoch: 3 | loss: 0.2741065
	speed: 0.0079s/iter; left time: 24.1145s
	iters: 200, epoch: 3 | loss: 0.3931710
	speed: 0.0032s/iter; left time: 9.4792s
	iters: 300, epoch: 3 | loss: 0.3355219
	speed: 0.0031s/iter; left time: 8.9071s
	iters: 400, epoch: 3 | loss: 0.2802212
	speed: 0.0028s/iter; left time: 7.7957s
	iters: 500, epoch: 3 | loss: 0.2000909
	speed: 0.0030s/iter; left time: 7.8954s
Updating learning rate to 4.580184000496592e-05
Validation loss decreased (0.2787 --> 0.2752).  Saving model state dict ...
Epoch: 3 cost time: 1.6746201515197754
Epoch: 3, Steps: 523 | Train Loss: 0.2966223 Vali Loss: 0.2751905 Best vali loss: 0.2751905

best validation loss 0.2751904964757347

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023549867609129905
Validation loss decreased (inf --> 0.2831).  Saving model state dict ...
Epoch: 1 cost time: 0.7051303386688232
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2830656 Best vali loss: 0.2830656
Updating learning rate to 0.00020896390866591454
Validation loss decreased (0.2831 --> 0.2791).  Saving model state dict ...
Epoch: 2 cost time: 0.43973207473754883
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2791474 Best vali loss: 0.2791474
Updating learning rate to 0.00016925182282609557
Epoch: 3 cost time: 0.45374536514282227
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2808405 Best vali loss: 0.2791474

best validation loss 0.279147380322229

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0062416843763, 'e_layers': 1, 'learning_rate': 6.62506528e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5479806
	speed: 0.0088s/iter; left time: 22.0921s
	iters: 200, epoch: 4 | loss: 0.6851869
	speed: 0.0030s/iter; left time: 7.3671s
	iters: 300, epoch: 4 | loss: 0.4345804
	speed: 0.0031s/iter; left time: 7.1989s
	iters: 400, epoch: 4 | loss: 0.2406343
	speed: 0.0031s/iter; left time: 6.9130s
	iters: 500, epoch: 4 | loss: 0.6645081
	speed: 0.0031s/iter; left time: 6.5726s
Updating learning rate to 3.31253264e-05
Epoch: 4 cost time: 1.8944106101989746
Epoch: 4, Steps: 523 | Train Loss: 0.5145781 Vali Loss: 0.2790959 Best vali loss: 0.2751905
	iters: 100, epoch: 5 | loss: 0.3067612
	speed: 0.0085s/iter; left time: 16.8963s
	iters: 200, epoch: 5 | loss: 0.4385084
	speed: 0.0027s/iter; left time: 5.1021s
	iters: 300, epoch: 5 | loss: 0.4531539
	speed: 0.0027s/iter; left time: 4.8567s
	iters: 400, epoch: 5 | loss: 0.2815845
	speed: 0.0032s/iter; left time: 5.4009s
	iters: 500, epoch: 5 | loss: 0.3698053
	speed: 0.0033s/iter; left time: 5.2580s
Updating learning rate to 2.044881279503408e-05
Epoch: 5 cost time: 1.6499390602111816
Epoch: 5, Steps: 523 | Train Loss: 0.3699627 Vali Loss: 0.2818242 Best vali loss: 0.2751905
	iters: 100, epoch: 6 | loss: 0.2498741
	speed: 0.0083s/iter; left time: 12.1979s
	iters: 200, epoch: 6 | loss: 0.3801602
	speed: 0.0033s/iter; left time: 4.5086s
	iters: 300, epoch: 6 | loss: 0.3228599
	speed: 0.0034s/iter; left time: 4.2818s
	iters: 400, epoch: 6 | loss: 0.2610744
	speed: 0.0029s/iter; left time: 3.3892s
	iters: 500, epoch: 6 | loss: 0.1842123
	speed: 0.0026s/iter; left time: 2.7857s
Updating learning rate to 9.702183473542235e-06
Epoch: 6 cost time: 1.6440327167510986
Epoch: 6, Steps: 523 | Train Loss: 0.2796362 Vali Loss: 0.2803457 Best vali loss: 0.2751905
	iters: 100, epoch: 7 | loss: 0.6459595
	speed: 0.0082s/iter; left time: 7.7739s
	iters: 200, epoch: 7 | loss: 0.4822727
	speed: 0.0037s/iter; left time: 3.1757s
	iters: 300, epoch: 7 | loss: 0.2809836
	speed: 0.0035s/iter; left time: 2.6399s
	iters: 400, epoch: 7 | loss: 0.5692988
	speed: 0.0036s/iter; left time: 2.3184s
	iters: 500, epoch: 7 | loss: 0.7802021
	speed: 0.0035s/iter; left time: 1.9267s
Updating learning rate to 2.521515331284215e-06
Epoch: 7 cost time: 1.916736125946045
Epoch: 7, Steps: 523 | Train Loss: 0.5517433 Vali Loss: 0.2817734 Best vali loss: 0.2751905
	iters: 100, epoch: 8 | loss: 0.2786567
	speed: 0.0077s/iter; left time: 3.2717s
	iters: 200, epoch: 8 | loss: 0.3292957
	speed: 0.0032s/iter; left time: 1.0400s
	iters: 300, epoch: 8 | loss: 0.2840721
	speed: 0.0031s/iter; left time: 0.6976s
	iters: 400, epoch: 8 | loss: 0.3321598
	speed: 0.0031s/iter; left time: 0.3783s
	iters: 500, epoch: 8 | loss: 0.5115314
	speed: 0.0032s/iter; left time: 0.0758s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.691373586654663
Epoch: 8, Steps: 523 | Train Loss: 0.3471431 Vali Loss: 0.2820873 Best vali loss: 0.2751905

best validation loss 0.2751904964757347

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0015412585082, 'e_layers': 1, 'learning_rate': 0.0019773820382, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019773820382
Validation loss decreased (inf --> 0.2974).  Saving model state dict ...
Epoch: 1 cost time: 0.5330967903137207
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2973536 Best vali loss: 0.2973536
Updating learning rate to 0.0009886910191
Validation loss decreased (0.2974 --> 0.2849).  Saving model state dict ...
Epoch: 2 cost time: 0.33075833320617676
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2849033 Best vali loss: 0.2849033
Updating learning rate to 0.00049434550955
Epoch: 3 cost time: 0.33118510246276855
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2998702 Best vali loss: 0.2849033
Updating learning rate to 0.000247172754775
Epoch: 4 cost time: 0.32226133346557617
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.3035390 Best vali loss: 0.2849033
Updating learning rate to 0.0001235863773875
Epoch: 5 cost time: 0.3145163059234619
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.3060163 Best vali loss: 0.2849033
Updating learning rate to 6.179318869375e-05
Epoch: 6 cost time: 0.3301668167114258
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.3033895 Best vali loss: 0.2849033
Updating learning rate to 3.0896594346875e-05
Epoch: 7 cost time: 0.3092198371887207
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.3036188 Best vali loss: 0.2849033
Updating learning rate to 1.54482971734375e-05
Epoch: 8 cost time: 0.30420613288879395
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.3042996 Best vali loss: 0.2849033

best validation loss 0.28490328542713605

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0026033575383, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8963167
	speed: 0.0107s/iter; left time: 43.6205s
	iters: 200, epoch: 1 | loss: 0.2426825
	speed: 0.0042s/iter; left time: 16.8235s
	iters: 300, epoch: 1 | loss: 0.8491312
	speed: 0.0037s/iter; left time: 14.4893s
	iters: 400, epoch: 1 | loss: 0.7836680
	speed: 0.0032s/iter; left time: 12.2912s
	iters: 500, epoch: 1 | loss: 0.3084360
	speed: 0.0033s/iter; left time: 12.0854s
Updating learning rate to 0.0001291814818
Validation loss decreased (inf --> 0.2830).  Saving model state dict ...
Epoch: 1 cost time: 2.3095407485961914
Epoch: 1, Steps: 523 | Train Loss: 0.6160469 Vali Loss: 0.2829523 Best vali loss: 0.2829523
	iters: 100, epoch: 2 | loss: 0.2391163
	speed: 0.0102s/iter; left time: 36.3316s
	iters: 200, epoch: 2 | loss: 0.6971176
	speed: 0.0041s/iter; left time: 14.2642s
	iters: 300, epoch: 2 | loss: 0.3415682
	speed: 0.0045s/iter; left time: 15.2509s
	iters: 400, epoch: 2 | loss: 0.3142814
	speed: 0.0040s/iter; left time: 13.1190s
	iters: 500, epoch: 2 | loss: 0.4456763
	speed: 0.0044s/iter; left time: 13.9099s
Updating learning rate to 6.45907409e-05
Validation loss decreased (0.2830 --> 0.2736).  Saving model state dict ...
Epoch: 2 cost time: 2.246420383453369
Epoch: 2, Steps: 523 | Train Loss: 0.4075519 Vali Loss: 0.2736464 Best vali loss: 0.2736464
	iters: 100, epoch: 3 | loss: 0.7225667
	speed: 0.0090s/iter; left time: 27.3155s
	iters: 200, epoch: 3 | loss: 0.2619424
	speed: 0.0033s/iter; left time: 9.5964s
	iters: 300, epoch: 3 | loss: 0.2446243
	speed: 0.0045s/iter; left time: 12.6866s
	iters: 400, epoch: 3 | loss: 0.4212125
	speed: 0.0039s/iter; left time: 10.6370s
	iters: 500, epoch: 3 | loss: 0.2827273
	speed: 0.0040s/iter; left time: 10.6282s
Updating learning rate to 3.229537045e-05
Epoch: 3 cost time: 2.053809642791748
Epoch: 3, Steps: 523 | Train Loss: 0.3866147 Vali Loss: 0.2810850 Best vali loss: 0.2736464
	iters: 100, epoch: 4 | loss: 0.4903724
	speed: 0.0084s/iter; left time: 21.0924s
	iters: 200, epoch: 4 | loss: 0.3983158
	speed: 0.0032s/iter; left time: 7.8302s
	iters: 300, epoch: 4 | loss: 0.4189877
	speed: 0.0041s/iter; left time: 9.4044s
	iters: 400, epoch: 4 | loss: 0.4696760
	speed: 0.0041s/iter; left time: 9.0945s
	iters: 500, epoch: 4 | loss: 0.5504783
	speed: 0.0041s/iter; left time: 8.6807s
Updating learning rate to 1.6147685225e-05
Epoch: 4 cost time: 2.0087692737579346
Epoch: 4, Steps: 523 | Train Loss: 0.4655660 Vali Loss: 0.2873528 Best vali loss: 0.2736464
	iters: 100, epoch: 5 | loss: 0.4126531
	speed: 0.0095s/iter; left time: 19.0311s
	iters: 200, epoch: 5 | loss: 0.4624539
	speed: 0.0041s/iter; left time: 7.6998s
	iters: 300, epoch: 5 | loss: 0.4062097
	speed: 0.0040s/iter; left time: 7.2190s
	iters: 400, epoch: 5 | loss: 0.3064523
	speed: 0.0040s/iter; left time: 6.8273s
	iters: 500, epoch: 5 | loss: 0.2434067
	speed: 0.0041s/iter; left time: 6.4756s
Updating learning rate to 8.0738426125e-06
Epoch: 5 cost time: 2.161949872970581
Epoch: 5, Steps: 523 | Train Loss: 0.3662351 Vali Loss: 0.2831486 Best vali loss: 0.2736464
	iters: 100, epoch: 6 | loss: 0.5701878
	speed: 0.0099s/iter; left time: 14.5335s
	iters: 200, epoch: 6 | loss: 0.4232248
	speed: 0.0043s/iter; left time: 5.9257s
	iters: 300, epoch: 6 | loss: 0.4314902
	speed: 0.0044s/iter; left time: 5.5364s
	iters: 400, epoch: 6 | loss: 0.4871246
	speed: 0.0044s/iter; left time: 5.1026s
	iters: 500, epoch: 6 | loss: 0.4375933
	speed: 0.0040s/iter; left time: 4.2624s
Updating learning rate to 4.03692130625e-06
Epoch: 6 cost time: 2.271822452545166
Epoch: 6, Steps: 523 | Train Loss: 0.4699241 Vali Loss: 0.2857008 Best vali loss: 0.2736464
	iters: 100, epoch: 7 | loss: 0.6397212
	speed: 0.0101s/iter; left time: 9.5391s
	iters: 200, epoch: 7 | loss: 0.3016298
	speed: 0.0046s/iter; left time: 3.9278s
	iters: 300, epoch: 7 | loss: 0.5164739
	speed: 0.0045s/iter; left time: 3.3575s
	iters: 400, epoch: 7 | loss: 0.2834140
	speed: 0.0044s/iter; left time: 2.8590s
	iters: 500, epoch: 7 | loss: 0.3901654
	speed: 0.0043s/iter; left time: 2.3638s
Updating learning rate to 2.018460653125e-06
Epoch: 7 cost time: 2.385798692703247
Epoch: 7, Steps: 523 | Train Loss: 0.4262809 Vali Loss: 0.2855440 Best vali loss: 0.2736464
	iters: 100, epoch: 8 | loss: 0.4506677
	speed: 0.0082s/iter; left time: 3.4794s
	iters: 200, epoch: 8 | loss: 0.5653211
	speed: 0.0036s/iter; left time: 1.1544s
	iters: 300, epoch: 8 | loss: 0.4558042
	speed: 0.0044s/iter; left time: 0.9835s
	iters: 400, epoch: 8 | loss: 0.1822755
	speed: 0.0039s/iter; left time: 0.4874s
	iters: 500, epoch: 8 | loss: 0.2928672
	speed: 0.0041s/iter; left time: 0.0978s
Updating learning rate to 1.0092303265625e-06
Epoch: 8 cost time: 2.0856001377105713
Epoch: 8, Steps: 523 | Train Loss: 0.3893871 Vali Loss: 0.2849376 Best vali loss: 0.2736464

best validation loss 0.2736464164134249

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0038735474901, 'e_layers': 1, 'learning_rate': 0.0014785219913, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6962814
	speed: 0.0090s/iter; left time: 17.9325s
	iters: 200, epoch: 1 | loss: 0.8662052
	speed: 0.0029s/iter; left time: 5.4436s
Updating learning rate to 0.0014785219913
Validation loss decreased (inf --> 0.2876).  Saving model state dict ...
Epoch: 1 cost time: 1.0726711750030518
Epoch: 1, Steps: 262 | Train Loss: 0.7812433 Vali Loss: 0.2875972 Best vali loss: 0.2875972
	iters: 100, epoch: 2 | loss: 0.4058115
	speed: 0.0075s/iter; left time: 13.0991s
	iters: 200, epoch: 2 | loss: 0.4590746
	speed: 0.0030s/iter; left time: 4.9531s
Updating learning rate to 0.00073926099565
Epoch: 2 cost time: 0.8443224430084229
Epoch: 2, Steps: 262 | Train Loss: 0.4324430 Vali Loss: 0.2962566 Best vali loss: 0.2875972
	iters: 100, epoch: 3 | loss: 0.3619849
	speed: 0.0076s/iter; left time: 11.1216s
	iters: 200, epoch: 3 | loss: 0.3174766
	speed: 0.0029s/iter; left time: 4.0039s
Updating learning rate to 0.000369630497825
Epoch: 3 cost time: 0.8696146011352539
Epoch: 3, Steps: 262 | Train Loss: 0.3397308 Vali Loss: 0.2979303 Best vali loss: 0.2875972

best validation loss 0.28759720833406166

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0033964440824, 'e_layers': 3, 'learning_rate': 0.0014790122285, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014227206773725282
Validation loss decreased (inf --> 0.2850).  Saving model state dict ...
Epoch: 1 cost time: 0.7472920417785645
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2849770 Best vali loss: 0.2849770
Updating learning rate to 0.0012624159023650887
Epoch: 2 cost time: 0.4558570384979248
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2877384 Best vali loss: 0.2849770
Updating learning rate to 0.0010225028523061603
Epoch: 3 cost time: 0.49498510360717773
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2914215 Best vali loss: 0.2849770

best validation loss 0.2849770485966921

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010922907516, 'e_layers': 3, 'learning_rate': 8.12568833e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1842192
	speed: 0.0111s/iter; left time: 45.2509s
	iters: 200, epoch: 1 | loss: 0.5245528
	speed: 0.0048s/iter; left time: 19.2273s
	iters: 300, epoch: 1 | loss: 0.5514084
	speed: 0.0052s/iter; left time: 20.3086s
	iters: 400, epoch: 1 | loss: 0.2409474
	speed: 0.0054s/iter; left time: 20.2927s
	iters: 500, epoch: 1 | loss: 0.4254792
	speed: 0.0054s/iter; left time: 19.8098s
Updating learning rate to 8.12568833e-05
Validation loss decreased (inf --> 0.2865).  Saving model state dict ...
Epoch: 1 cost time: 3.008615493774414
Epoch: 1, Steps: 523 | Train Loss: 0.5853214 Vali Loss: 0.2864710 Best vali loss: 0.2864710
	iters: 100, epoch: 2 | loss: 0.3861504
	speed: 0.0114s/iter; left time: 40.6303s
	iters: 200, epoch: 2 | loss: 0.8488082
	speed: 0.0048s/iter; left time: 16.4792s
	iters: 300, epoch: 2 | loss: 0.9408713
	speed: 0.0053s/iter; left time: 17.8259s
	iters: 400, epoch: 2 | loss: 0.2721553
	speed: 0.0055s/iter; left time: 18.0916s
	iters: 500, epoch: 2 | loss: 0.3318661
	speed: 0.0054s/iter; left time: 16.9512s
Updating learning rate to 4.062844165e-05
Validation loss decreased (0.2865 --> 0.2799).  Saving model state dict ...
Epoch: 2 cost time: 2.7863590717315674
Epoch: 2, Steps: 523 | Train Loss: 0.5559703 Vali Loss: 0.2798646 Best vali loss: 0.2798646
	iters: 100, epoch: 3 | loss: 0.3273423
	speed: 0.0113s/iter; left time: 34.4730s
	iters: 200, epoch: 3 | loss: 0.3388056
	speed: 0.0050s/iter; left time: 14.6494s
	iters: 300, epoch: 3 | loss: 0.4271877
	speed: 0.0046s/iter; left time: 13.0181s
	iters: 400, epoch: 3 | loss: 0.4731835
	speed: 0.0043s/iter; left time: 11.8810s
	iters: 500, epoch: 3 | loss: 0.2847786
	speed: 0.0102s/iter; left time: 26.8485s
Updating learning rate to 2.0314220825e-05
Epoch: 3 cost time: 3.2194600105285645
Epoch: 3, Steps: 523 | Train Loss: 0.3702595 Vali Loss: 0.2802197 Best vali loss: 0.2798646

best validation loss 0.27986462684136953

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010922907516, 'e_layers': 3, 'learning_rate': 8.12568833e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9021500
	speed: 0.0179s/iter; left time: 45.1603s
	iters: 200, epoch: 4 | loss: 0.5097138
	speed: 0.0089s/iter; left time: 21.5374s
	iters: 300, epoch: 4 | loss: 0.4419023
	speed: 0.0106s/iter; left time: 24.5771s
	iters: 400, epoch: 4 | loss: 0.2260599
	speed: 0.0086s/iter; left time: 19.0850s
	iters: 500, epoch: 4 | loss: 0.3831615
	speed: 0.0098s/iter; left time: 20.8255s
Updating learning rate to 1.01571104125e-05
Validation loss decreased (0.2799 --> 0.2796).  Saving model state dict ...
Epoch: 4 cost time: 5.3394410610198975
Epoch: 4, Steps: 523 | Train Loss: 0.4925975 Vali Loss: 0.2795636 Best vali loss: 0.2795636
	iters: 100, epoch: 5 | loss: 0.3651238
	speed: 0.0187s/iter; left time: 37.2177s
	iters: 200, epoch: 5 | loss: 0.8172998
	speed: 0.0107s/iter; left time: 20.2541s
	iters: 300, epoch: 5 | loss: 0.9361979
	speed: 0.0085s/iter; left time: 15.2115s
	iters: 400, epoch: 5 | loss: 0.2739205
	speed: 0.0102s/iter; left time: 17.2362s
	iters: 500, epoch: 5 | loss: 0.3362269
	speed: 0.0057s/iter; left time: 9.0671s
Updating learning rate to 5.07855520625e-06
Validation loss decreased (0.2796 --> 0.2790).  Saving model state dict ...
Epoch: 5 cost time: 4.429627895355225
Epoch: 5, Steps: 523 | Train Loss: 0.5457538 Vali Loss: 0.2789823 Best vali loss: 0.2789823
	iters: 100, epoch: 6 | loss: 0.3156717
	speed: 0.0103s/iter; left time: 15.1236s
	iters: 200, epoch: 6 | loss: 0.3271290
	speed: 0.0065s/iter; left time: 8.9448s
	iters: 300, epoch: 6 | loss: 0.4252848
	speed: 0.0067s/iter; left time: 8.5290s
	iters: 400, epoch: 6 | loss: 0.4712790
	speed: 0.0061s/iter; left time: 7.1667s
	iters: 500, epoch: 6 | loss: 0.2826791
	speed: 0.0066s/iter; left time: 7.0122s
Updating learning rate to 2.539277603125e-06
Epoch: 6 cost time: 3.3082475662231445
Epoch: 6, Steps: 523 | Train Loss: 0.3644087 Vali Loss: 0.2790977 Best vali loss: 0.2789823
	iters: 100, epoch: 7 | loss: 0.2523500
	speed: 0.0134s/iter; left time: 12.6836s
	iters: 200, epoch: 7 | loss: 0.6441766
	speed: 0.0073s/iter; left time: 6.1657s
	iters: 300, epoch: 7 | loss: 0.1996764
	speed: 0.0062s/iter; left time: 4.6220s
	iters: 400, epoch: 7 | loss: 0.2063210
	speed: 0.0065s/iter; left time: 4.1898s
	iters: 500, epoch: 7 | loss: 0.5081239
	speed: 0.0072s/iter; left time: 3.9615s
Updating learning rate to 1.2696388015625e-06
Epoch: 7 cost time: 3.505470037460327
Epoch: 7, Steps: 523 | Train Loss: 0.3621296 Vali Loss: 0.2790365 Best vali loss: 0.2789823
	iters: 100, epoch: 8 | loss: 0.2709434
	speed: 0.0135s/iter; left time: 5.7095s
	iters: 200, epoch: 8 | loss: 0.6138290
	speed: 0.0043s/iter; left time: 1.3821s
	iters: 300, epoch: 8 | loss: 0.2600777
	speed: 0.0041s/iter; left time: 0.9252s
	iters: 400, epoch: 8 | loss: 0.7422161
	speed: 0.0042s/iter; left time: 0.5166s
	iters: 500, epoch: 8 | loss: 1.8003352
	speed: 0.0042s/iter; left time: 0.0999s
Updating learning rate to 6.3481940078125e-07
Epoch: 8 cost time: 2.4288299083709717
Epoch: 8, Steps: 523 | Train Loss: 0.7374803 Vali Loss: 0.2790061 Best vali loss: 0.2789823

best validation loss 0.2789822703967887

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0097884354818, 'e_layers': 4, 'learning_rate': 0.0002505982255, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4050603
	speed: 0.0163s/iter; left time: 15.4227s
Updating learning rate to 0.00024106039846154902
Validation loss decreased (inf --> 0.2846).  Saving model state dict ...
Epoch: 1 cost time: 1.5841758251190186
Epoch: 1, Steps: 131 | Train Loss: 0.4050603 Vali Loss: 0.2846263 Best vali loss: 0.2846263
	iters: 100, epoch: 2 | loss: 0.4558085
	speed: 0.0149s/iter; left time: 12.1579s
Updating learning rate to 0.0002138989650521828
Validation loss decreased (0.2846 --> 0.2816).  Saving model state dict ...
Epoch: 2 cost time: 1.3093080520629883
Epoch: 2, Steps: 131 | Train Loss: 0.4558085 Vali Loss: 0.2815570 Best vali loss: 0.2815570
	iters: 100, epoch: 3 | loss: 0.3420377
	speed: 0.0170s/iter; left time: 11.6571s
Updating learning rate to 0.0001732490072894704
Epoch: 3 cost time: 1.4034030437469482
Epoch: 3, Steps: 131 | Train Loss: 0.3420377 Vali Loss: 0.2923087 Best vali loss: 0.2815570
	iters: 100, epoch: 4 | loss: 0.4138361
	speed: 0.0164s/iter; left time: 9.1017s
Updating learning rate to 0.00012529911275
Epoch: 4 cost time: 1.4078302383422852
Epoch: 4, Steps: 131 | Train Loss: 0.4138361 Vali Loss: 0.2830676 Best vali loss: 0.2815570
	iters: 100, epoch: 5 | loss: 0.3129083
	speed: 0.0164s/iter; left time: 6.9807s
Updating learning rate to 7.734921821052962e-05
Epoch: 5 cost time: 1.4014174938201904
Epoch: 5, Steps: 131 | Train Loss: 0.3129083 Vali Loss: 0.2963951 Best vali loss: 0.2815570
	iters: 100, epoch: 6 | loss: 0.2838410
	speed: 0.0169s/iter; left time: 4.9637s
Updating learning rate to 3.669926044781721e-05
Epoch: 6 cost time: 1.4331278800964355
Epoch: 6, Steps: 131 | Train Loss: 0.2838410 Vali Loss: 0.3048835 Best vali loss: 0.2815570
	iters: 100, epoch: 7 | loss: 0.3050148
	speed: 0.0166s/iter; left time: 2.7137s
Updating learning rate to 9.537827038450992e-06
Epoch: 7 cost time: 1.4265196323394775
Epoch: 7, Steps: 131 | Train Loss: 0.3050148 Vali Loss: 0.3099998 Best vali loss: 0.2815570
	iters: 100, epoch: 8 | loss: 0.2386388
	speed: 0.0168s/iter; left time: 0.5362s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4198682308197021
Epoch: 8, Steps: 131 | Train Loss: 0.2386388 Vali Loss: 0.3107934 Best vali loss: 0.2815570

best validation loss 0.2815570171663379

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045607678964, 'e_layers': 1, 'learning_rate': 9.30573825e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4667259
	speed: 0.0088s/iter; left time: 17.5552s
	iters: 200, epoch: 1 | loss: 0.5042077
	speed: 0.0030s/iter; left time: 5.7538s
Updating learning rate to 8.9515596770412e-05
Validation loss decreased (inf --> 0.2783).  Saving model state dict ...
Epoch: 1 cost time: 1.086756706237793
Epoch: 1, Steps: 262 | Train Loss: 0.4854668 Vali Loss: 0.2783087 Best vali loss: 0.2783087
	iters: 100, epoch: 2 | loss: 0.5100963
	speed: 0.0080s/iter; left time: 13.9396s
	iters: 200, epoch: 2 | loss: 0.7343745
	speed: 0.0030s/iter; left time: 4.9432s
Updating learning rate to 7.942944435261018e-05
Validation loss decreased (0.2783 --> 0.2775).  Saving model state dict ...
Epoch: 2 cost time: 0.8765339851379395
Epoch: 2, Steps: 262 | Train Loss: 0.6222354 Vali Loss: 0.2775413 Best vali loss: 0.2775413
	iters: 100, epoch: 3 | loss: 0.4406430
	speed: 0.0080s/iter; left time: 11.7819s
	iters: 200, epoch: 3 | loss: 0.4135408
	speed: 0.0030s/iter; left time: 4.1765s
Updating learning rate to 6.433445052100552e-05
Epoch: 3 cost time: 0.8434288501739502
Epoch: 3, Steps: 262 | Train Loss: 0.4270919 Vali Loss: 0.2793474 Best vali loss: 0.2775413
	iters: 100, epoch: 4 | loss: 0.4110748
	speed: 0.0077s/iter; left time: 9.3676s
	iters: 200, epoch: 4 | loss: 0.2897998
	speed: 0.0032s/iter; left time: 3.5135s
Updating learning rate to 4.652869125e-05
Epoch: 4 cost time: 0.8687996864318848
Epoch: 4, Steps: 262 | Train Loss: 0.3504373 Vali Loss: 0.2820895 Best vali loss: 0.2775413
	iters: 100, epoch: 5 | loss: 0.2565104
	speed: 0.0079s/iter; left time: 7.5167s
	iters: 200, epoch: 5 | loss: 0.3099909
	speed: 0.0031s/iter; left time: 2.5910s
Updating learning rate to 2.8722931978994484e-05
Epoch: 5 cost time: 0.8664703369140625
Epoch: 5, Steps: 262 | Train Loss: 0.2832507 Vali Loss: 0.2830178 Best vali loss: 0.2775413
	iters: 100, epoch: 6 | loss: 0.2826082
	speed: 0.0077s/iter; left time: 5.3204s
	iters: 200, epoch: 6 | loss: 0.2819715
	speed: 0.0030s/iter; left time: 1.7878s
Updating learning rate to 1.3627938147389826e-05
Epoch: 6 cost time: 0.8552112579345703
Epoch: 6, Steps: 262 | Train Loss: 0.2822899 Vali Loss: 0.2852968 Best vali loss: 0.2775413
	iters: 100, epoch: 7 | loss: 0.5641160
	speed: 0.0075s/iter; left time: 3.1727s
	iters: 200, epoch: 7 | loss: 0.4487825
	speed: 0.0031s/iter; left time: 1.0021s
Updating learning rate to 3.541785729588002e-06
Epoch: 7 cost time: 0.8343405723571777
Epoch: 7, Steps: 262 | Train Loss: 0.5064492 Vali Loss: 0.2847629 Best vali loss: 0.2775413
	iters: 100, epoch: 8 | loss: 0.2253582
	speed: 0.0072s/iter; left time: 1.1765s
	iters: 200, epoch: 8 | loss: 0.4318272
	speed: 0.0030s/iter; left time: 0.1890s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8101215362548828
Epoch: 8, Steps: 262 | Train Loss: 0.3285927 Vali Loss: 0.2844006 Best vali loss: 0.2775413

best validation loss 0.2775413043749913

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0038819458795, 'e_layers': 2, 'learning_rate': 0.0002544908897, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002544908897
Validation loss decreased (inf --> 0.2904).  Saving model state dict ...
Epoch: 1 cost time: 0.6236824989318848
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2903777 Best vali loss: 0.2903777
Updating learning rate to 0.00012724544485
Validation loss decreased (0.2904 --> 0.2826).  Saving model state dict ...
Epoch: 2 cost time: 0.4133784770965576
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2826459 Best vali loss: 0.2826459
Updating learning rate to 6.3622722425e-05
Validation loss decreased (0.2826 --> 0.2808).  Saving model state dict ...
Epoch: 3 cost time: 0.35741257667541504
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2807841 Best vali loss: 0.2807841

best validation loss 0.2807841131615346

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070932288252, 'e_layers': 4, 'learning_rate': 0.0005299103803, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7523693
	speed: 0.0121s/iter; left time: 100.0144s
	iters: 200, epoch: 1 | loss: 0.3652277
	speed: 0.0064s/iter; left time: 52.3662s
	iters: 300, epoch: 1 | loss: 0.2632250
	speed: 0.0059s/iter; left time: 47.5804s
	iters: 400, epoch: 1 | loss: 0.2957163
	speed: 0.0055s/iter; left time: 43.4928s
	iters: 500, epoch: 1 | loss: 0.2317247
	speed: 0.0048s/iter; left time: 37.9620s
	iters: 600, epoch: 1 | loss: 0.5707176
	speed: 0.0064s/iter; left time: 49.4266s
	iters: 700, epoch: 1 | loss: 0.2255848
	speed: 0.0075s/iter; left time: 57.2208s
	iters: 800, epoch: 1 | loss: 0.5550108
	speed: 0.0078s/iter; left time: 58.7274s
	iters: 900, epoch: 1 | loss: 0.3038132
	speed: 0.0069s/iter; left time: 51.6433s
	iters: 1000, epoch: 1 | loss: 0.3058462
	speed: 0.0069s/iter; left time: 50.7927s
Updating learning rate to 0.0005299103803
Validation loss decreased (inf --> 0.2911).  Saving model state dict ...
Epoch: 1 cost time: 7.067528009414673
Epoch: 1, Steps: 1045 | Train Loss: 0.3869235 Vali Loss: 0.2910915 Best vali loss: 0.2910915
	iters: 100, epoch: 2 | loss: 0.3409355
	speed: 0.0225s/iter; left time: 162.4505s
	iters: 200, epoch: 2 | loss: 0.3268159
	speed: 0.0072s/iter; left time: 51.5731s
	iters: 300, epoch: 2 | loss: 0.2490591
	speed: 0.0072s/iter; left time: 50.6862s
	iters: 400, epoch: 2 | loss: 0.5177065
	speed: 0.0075s/iter; left time: 51.6194s
	iters: 500, epoch: 2 | loss: 0.4859876
	speed: 0.0057s/iter; left time: 38.9533s
	iters: 600, epoch: 2 | loss: 0.4933617
	speed: 0.0045s/iter; left time: 30.4185s
	iters: 700, epoch: 2 | loss: 0.4227189
	speed: 0.0054s/iter; left time: 35.4825s
	iters: 800, epoch: 2 | loss: 0.3503026
	speed: 0.0059s/iter; left time: 38.5584s
	iters: 900, epoch: 2 | loss: 1.2831770
	speed: 0.0058s/iter; left time: 37.2031s
	iters: 1000, epoch: 2 | loss: 1.1773390
	speed: 0.0060s/iter; left time: 37.7652s
Updating learning rate to 0.00026495519015
Validation loss decreased (0.2911 --> 0.2840).  Saving model state dict ...
Epoch: 2 cost time: 6.514459133148193
Epoch: 2, Steps: 1045 | Train Loss: 0.5647404 Vali Loss: 0.2839861 Best vali loss: 0.2839861
	iters: 100, epoch: 3 | loss: 0.4275594
	speed: 0.0163s/iter; left time: 100.5363s
	iters: 200, epoch: 3 | loss: 0.3090993
	speed: 0.0065s/iter; left time: 39.6964s
	iters: 300, epoch: 3 | loss: 0.2383306
	speed: 0.0062s/iter; left time: 37.2908s
	iters: 400, epoch: 3 | loss: 0.7490873
	speed: 0.0063s/iter; left time: 36.7933s
	iters: 500, epoch: 3 | loss: 0.1960234
	speed: 0.0065s/iter; left time: 37.3531s
	iters: 600, epoch: 3 | loss: 0.8675938
	speed: 0.0063s/iter; left time: 35.6173s
	iters: 700, epoch: 3 | loss: 0.1363654
	speed: 0.0062s/iter; left time: 34.5770s
	iters: 800, epoch: 3 | loss: 0.6127114
	speed: 0.0067s/iter; left time: 36.8721s
	iters: 900, epoch: 3 | loss: 0.2995038
	speed: 0.0057s/iter; left time: 30.4292s
	iters: 1000, epoch: 3 | loss: 0.2924861
	speed: 0.0052s/iter; left time: 27.3354s
Updating learning rate to 0.000132477595075
Epoch: 3 cost time: 6.517136812210083
Epoch: 3, Steps: 1045 | Train Loss: 0.4128760 Vali Loss: 0.2938129 Best vali loss: 0.2839861

best validation loss 0.2839861375197641

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0113244039716, 'e_layers': 2, 'learning_rate': 0.0001157249236, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5599740
	speed: 0.0097s/iter; left time: 39.7625s
	iters: 200, epoch: 1 | loss: 0.2938167
	speed: 0.0041s/iter; left time: 16.3575s
	iters: 300, epoch: 1 | loss: 0.3455842
	speed: 0.0038s/iter; left time: 14.7106s
	iters: 400, epoch: 1 | loss: 1.1077482
	speed: 0.0035s/iter; left time: 13.1066s
	iters: 500, epoch: 1 | loss: 0.8413914
	speed: 0.0034s/iter; left time: 12.5102s
Updating learning rate to 0.0001157249236
Validation loss decreased (inf --> 0.2835).  Saving model state dict ...
Epoch: 1 cost time: 2.2601356506347656
Epoch: 1, Steps: 523 | Train Loss: 0.6297029 Vali Loss: 0.2834587 Best vali loss: 0.2834587
	iters: 100, epoch: 2 | loss: 0.5484523
	speed: 0.0099s/iter; left time: 35.1349s
	iters: 200, epoch: 2 | loss: 0.5344042
	speed: 0.0042s/iter; left time: 14.6505s
	iters: 300, epoch: 2 | loss: 0.4079134
	speed: 0.0042s/iter; left time: 14.2711s
	iters: 400, epoch: 2 | loss: 0.3019573
	speed: 0.0042s/iter; left time: 13.8546s
	iters: 500, epoch: 2 | loss: 0.2937258
	speed: 0.0041s/iter; left time: 13.0653s
Updating learning rate to 5.78624618e-05
Epoch: 2 cost time: 2.2433998584747314
Epoch: 2, Steps: 523 | Train Loss: 0.4172906 Vali Loss: 0.2840091 Best vali loss: 0.2834587
	iters: 100, epoch: 3 | loss: 0.3652376
	speed: 0.0096s/iter; left time: 29.1819s
	iters: 200, epoch: 3 | loss: 0.4429292
	speed: 0.0040s/iter; left time: 11.6203s
	iters: 300, epoch: 3 | loss: 0.4364437
	speed: 0.0035s/iter; left time: 9.9567s
	iters: 400, epoch: 3 | loss: 0.3321924
	speed: 0.0034s/iter; left time: 9.1976s
	iters: 500, epoch: 3 | loss: 0.2784832
	speed: 0.0034s/iter; left time: 9.0326s
Updating learning rate to 2.89312309e-05
Validation loss decreased (0.2835 --> 0.2814).  Saving model state dict ...
Epoch: 3 cost time: 1.9500188827514648
Epoch: 3, Steps: 523 | Train Loss: 0.3710572 Vali Loss: 0.2814075 Best vali loss: 0.2814075

best validation loss 0.28140746283681917

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0038819458795, 'e_layers': 2, 'learning_rate': 0.0002544908897, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.18113612125e-05
Epoch: 4 cost time: 0.5981078147888184
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2830610 Best vali loss: 0.2807841
Updating learning rate to 1.590568060625e-05
Epoch: 5 cost time: 0.32889294624328613
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2819762 Best vali loss: 0.2807841
Updating learning rate to 7.952840303125e-06
Epoch: 6 cost time: 0.3826329708099365
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2811979 Best vali loss: 0.2807841
Updating learning rate to 3.9764201515625e-06
Epoch: 7 cost time: 0.34609365463256836
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2812839 Best vali loss: 0.2807841
Updating learning rate to 1.98821007578125e-06
Epoch: 8 cost time: 0.3846256732940674
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2813497 Best vali loss: 0.2807841

best validation loss 0.2807841131615346

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0052619006335, 'e_layers': 4, 'learning_rate': 0.0005447529536, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005447529536
Validation loss decreased (inf --> 0.2869).  Saving model state dict ...
Epoch: 1 cost time: 0.7561876773834229
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2868556 Best vali loss: 0.2868556
Updating learning rate to 0.0002723764768
Validation loss decreased (0.2869 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 0.49967026710510254
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2833016 Best vali loss: 0.2833016
Updating learning rate to 0.0001361882384
Epoch: 3 cost time: 0.4956345558166504
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2838308 Best vali loss: 0.2833016
Updating learning rate to 6.80941192e-05
Epoch: 4 cost time: 0.4738454818725586
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2866988 Best vali loss: 0.2833016
Updating learning rate to 3.40470596e-05
Epoch: 5 cost time: 0.48154401779174805
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2854102 Best vali loss: 0.2833016
Updating learning rate to 1.70235298e-05
Epoch: 6 cost time: 0.48729705810546875
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2860065 Best vali loss: 0.2833016
Updating learning rate to 8.5117649e-06
Epoch: 7 cost time: 0.4965341091156006
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2860875 Best vali loss: 0.2833016
Updating learning rate to 4.25588245e-06
Epoch: 8 cost time: 0.5549588203430176
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2862082 Best vali loss: 0.2833016

best validation loss 0.28330157064635675

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010477009495, 'e_layers': 1, 'learning_rate': 0.0002179153135, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4738473
	speed: 0.0090s/iter; left time: 74.2066s
	iters: 200, epoch: 1 | loss: 0.4244297
	speed: 0.0027s/iter; left time: 22.0733s
	iters: 300, epoch: 1 | loss: 0.5155510
	speed: 0.0029s/iter; left time: 23.6279s
	iters: 400, epoch: 1 | loss: 0.2916744
	speed: 0.0029s/iter; left time: 23.0099s
	iters: 500, epoch: 1 | loss: 0.8795400
	speed: 0.0032s/iter; left time: 24.9835s
	iters: 600, epoch: 1 | loss: 1.6338011
	speed: 0.0033s/iter; left time: 25.5593s
	iters: 700, epoch: 1 | loss: 0.2565923
	speed: 0.0033s/iter; left time: 25.2508s
	iters: 800, epoch: 1 | loss: 0.2904989
	speed: 0.0032s/iter; left time: 23.9715s
	iters: 900, epoch: 1 | loss: 0.5406504
	speed: 0.0032s/iter; left time: 23.7234s
	iters: 1000, epoch: 1 | loss: 0.3043570
	speed: 0.0033s/iter; left time: 24.4293s
Updating learning rate to 0.00020962140573171524
Validation loss decreased (inf --> 0.2853).  Saving model state dict ...
Epoch: 1 cost time: 3.554896116256714
Epoch: 1, Steps: 1045 | Train Loss: 0.5610942 Vali Loss: 0.2853037 Best vali loss: 0.2853037
	iters: 100, epoch: 2 | loss: 0.3453978
	speed: 0.0125s/iter; left time: 90.3033s
	iters: 200, epoch: 2 | loss: 0.1762783
	speed: 0.0025s/iter; left time: 18.0903s
	iters: 300, epoch: 2 | loss: 1.3656880
	speed: 0.0026s/iter; left time: 18.3223s
	iters: 400, epoch: 2 | loss: 0.3485766
	speed: 0.0026s/iter; left time: 18.2151s
	iters: 500, epoch: 2 | loss: 0.3666281
	speed: 0.0032s/iter; left time: 21.8404s
	iters: 600, epoch: 2 | loss: 0.5877686
	speed: 0.0031s/iter; left time: 20.6351s
	iters: 700, epoch: 2 | loss: 0.2477106
	speed: 0.0031s/iter; left time: 20.2623s
	iters: 800, epoch: 2 | loss: 0.4747366
	speed: 0.0031s/iter; left time: 19.9781s
	iters: 900, epoch: 2 | loss: 0.2170548
	speed: 0.0030s/iter; left time: 19.5588s
	iters: 1000, epoch: 2 | loss: 0.9452308
	speed: 0.0030s/iter; left time: 19.0624s
Updating learning rate to 0.0001860023547001212
Validation loss decreased (0.2853 --> 0.2833).  Saving model state dict ...
Epoch: 2 cost time: 3.1221158504486084
Epoch: 2, Steps: 1045 | Train Loss: 0.5075070 Vali Loss: 0.2832714 Best vali loss: 0.2832714
	iters: 100, epoch: 3 | loss: 0.8239328
	speed: 0.0123s/iter; left time: 76.1361s
	iters: 200, epoch: 3 | loss: 0.5478213
	speed: 0.0027s/iter; left time: 16.6601s
	iters: 300, epoch: 3 | loss: 0.2908273
	speed: 0.0028s/iter; left time: 16.6468s
	iters: 400, epoch: 3 | loss: 0.3672372
	speed: 0.0028s/iter; left time: 16.7229s
	iters: 500, epoch: 3 | loss: 0.8763230
	speed: 0.0034s/iter; left time: 19.3512s
	iters: 600, epoch: 3 | loss: 0.4239593
	speed: 0.0032s/iter; left time: 18.3764s
	iters: 700, epoch: 3 | loss: 0.3253198
	speed: 0.0034s/iter; left time: 18.8493s
	iters: 800, epoch: 3 | loss: 0.4005431
	speed: 0.0033s/iter; left time: 18.1569s
	iters: 900, epoch: 3 | loss: 0.1505795
	speed: 0.0033s/iter; left time: 17.7830s
	iters: 1000, epoch: 3 | loss: 0.3044558
	speed: 0.0033s/iter; left time: 17.2301s
Updating learning rate to 0.0001506539468175473
Epoch: 3 cost time: 3.340243101119995
Epoch: 3, Steps: 1045 | Train Loss: 0.4510999 Vali Loss: 0.2853317 Best vali loss: 0.2832714
	iters: 100, epoch: 4 | loss: 0.8134391
	speed: 0.0119s/iter; left time: 61.1127s
	iters: 200, epoch: 4 | loss: 0.3568157
	speed: 0.0029s/iter; left time: 14.5421s
	iters: 300, epoch: 4 | loss: 0.2958384
	speed: 0.0026s/iter; left time: 12.5839s
	iters: 400, epoch: 4 | loss: 0.6108672
	speed: 0.0027s/iter; left time: 12.9729s
	iters: 500, epoch: 4 | loss: 0.2685318
	speed: 0.0025s/iter; left time: 11.5909s
	iters: 600, epoch: 4 | loss: 0.4814652
	speed: 0.0023s/iter; left time: 10.6295s
	iters: 700, epoch: 4 | loss: 0.3143360
	speed: 0.0023s/iter; left time: 10.5881s
	iters: 800, epoch: 4 | loss: 0.5399060
	speed: 0.0027s/iter; left time: 11.8228s
	iters: 900, epoch: 4 | loss: 0.1988332
	speed: 0.0033s/iter; left time: 14.3666s
	iters: 1000, epoch: 4 | loss: 0.5475740
	speed: 0.0033s/iter; left time: 13.8926s
Updating learning rate to 0.00010895765675
Epoch: 4 cost time: 2.963507652282715
Epoch: 4, Steps: 1045 | Train Loss: 0.4427607 Vali Loss: 0.2919768 Best vali loss: 0.2832714
	iters: 100, epoch: 5 | loss: 0.7601651
	speed: 0.0142s/iter; left time: 58.1222s
	iters: 200, epoch: 5 | loss: 0.6203395
	speed: 0.0035s/iter; left time: 14.1237s
	iters: 300, epoch: 5 | loss: 0.5245886
	speed: 0.0036s/iter; left time: 13.9764s
	iters: 400, epoch: 5 | loss: 0.7755979
	speed: 0.0035s/iter; left time: 13.2342s
	iters: 500, epoch: 5 | loss: 0.4590207
	speed: 0.0030s/iter; left time: 11.0373s
	iters: 600, epoch: 5 | loss: 0.6488885
	speed: 0.0028s/iter; left time: 10.0838s
	iters: 700, epoch: 5 | loss: 0.3849558
	speed: 0.0034s/iter; left time: 11.9441s
	iters: 800, epoch: 5 | loss: 0.3982091
	speed: 0.0034s/iter; left time: 11.4868s
	iters: 900, epoch: 5 | loss: 0.4988565
	speed: 0.0035s/iter; left time: 11.3704s
	iters: 1000, epoch: 5 | loss: 0.7691706
	speed: 0.0034s/iter; left time: 10.9714s
Updating learning rate to 6.726136668245272e-05
Epoch: 5 cost time: 3.5723721981048584
Epoch: 5, Steps: 1045 | Train Loss: 0.5839792 Vali Loss: 0.2963469 Best vali loss: 0.2832714
	iters: 100, epoch: 6 | loss: 0.2682590
	speed: 0.0138s/iter; left time: 41.7944s
	iters: 200, epoch: 6 | loss: 0.7740872
	speed: 0.0032s/iter; left time: 9.4274s
	iters: 300, epoch: 6 | loss: 0.2486164
	speed: 0.0028s/iter; left time: 7.9775s
	iters: 400, epoch: 6 | loss: 0.3203702
	speed: 0.0026s/iter; left time: 7.0992s
	iters: 500, epoch: 6 | loss: 0.8643364
	speed: 0.0031s/iter; left time: 8.2169s
	iters: 600, epoch: 6 | loss: 0.1629850
	speed: 0.0033s/iter; left time: 8.4458s
	iters: 700, epoch: 6 | loss: 0.2438419
	speed: 0.0036s/iter; left time: 8.8382s
	iters: 800, epoch: 6 | loss: 0.5372545
	speed: 0.0035s/iter; left time: 8.1510s
	iters: 900, epoch: 6 | loss: 0.5637538
	speed: 0.0034s/iter; left time: 7.6054s
	iters: 1000, epoch: 6 | loss: 0.2317051
	speed: 0.0035s/iter; left time: 7.4483s
Updating learning rate to 3.19129587998788e-05
Epoch: 6 cost time: 3.4269609451293945
Epoch: 6, Steps: 1045 | Train Loss: 0.4215209 Vali Loss: 0.2974737 Best vali loss: 0.2832714
	iters: 100, epoch: 7 | loss: 0.4504510
	speed: 0.0135s/iter; left time: 26.8627s
	iters: 200, epoch: 7 | loss: 0.3446694
	speed: 0.0033s/iter; left time: 6.2426s
	iters: 300, epoch: 7 | loss: 0.1566401
	speed: 0.0027s/iter; left time: 4.8875s
	iters: 400, epoch: 7 | loss: 0.5790402
	speed: 0.0026s/iter; left time: 4.4404s
	iters: 500, epoch: 7 | loss: 0.2766176
	speed: 0.0023s/iter; left time: 3.6667s
	iters: 600, epoch: 7 | loss: 0.4299806
	speed: 0.0023s/iter; left time: 3.4332s
	iters: 700, epoch: 7 | loss: 0.4535048
	speed: 0.0023s/iter; left time: 3.1718s
	iters: 800, epoch: 7 | loss: 0.3496978
	speed: 0.0027s/iter; left time: 3.4896s
	iters: 900, epoch: 7 | loss: 0.6056102
	speed: 0.0030s/iter; left time: 3.5339s
	iters: 1000, epoch: 7 | loss: 0.2309906
	speed: 0.0030s/iter; left time: 3.2777s
Updating learning rate to 8.293907768284754e-06
Epoch: 7 cost time: 2.9424471855163574
Epoch: 7, Steps: 1045 | Train Loss: 0.3877202 Vali Loss: 0.2996717 Best vali loss: 0.2832714
	iters: 100, epoch: 8 | loss: 0.2617420
	speed: 0.0118s/iter; left time: 11.1761s
	iters: 200, epoch: 8 | loss: 0.8886335
	speed: 0.0031s/iter; left time: 2.6398s
	iters: 300, epoch: 8 | loss: 0.2871272
	speed: 0.0031s/iter; left time: 2.3339s
	iters: 400, epoch: 8 | loss: 0.2908420
	speed: 0.0032s/iter; left time: 2.0380s
	iters: 500, epoch: 8 | loss: 0.2382171
	speed: 0.0032s/iter; left time: 1.7294s
	iters: 600, epoch: 8 | loss: 0.4714478
	speed: 0.0031s/iter; left time: 1.3992s
	iters: 700, epoch: 8 | loss: 0.4848531
	speed: 0.0032s/iter; left time: 1.0994s
	iters: 800, epoch: 8 | loss: 0.4368119
	speed: 0.0031s/iter; left time: 0.7669s
	iters: 900, epoch: 8 | loss: 0.4177788
	speed: 0.0032s/iter; left time: 0.4602s
	iters: 1000, epoch: 8 | loss: 0.2119737
	speed: 0.0032s/iter; left time: 0.1449s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.3097915649414062
Epoch: 8, Steps: 1045 | Train Loss: 0.3989427 Vali Loss: 0.3002578 Best vali loss: 0.2832714

best validation loss 0.28327142220861895

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.011102994395, 'e_layers': 4, 'learning_rate': 0.0002339721939, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3867601
	speed: 0.0118s/iter; left time: 48.4064s
	iters: 200, epoch: 1 | loss: 0.2425963
	speed: 0.0062s/iter; left time: 24.6385s
	iters: 300, epoch: 1 | loss: 0.4069103
	speed: 0.0062s/iter; left time: 24.0290s
	iters: 400, epoch: 1 | loss: 1.3081356
	speed: 0.0062s/iter; left time: 23.3071s
	iters: 500, epoch: 1 | loss: 1.0149204
	speed: 0.0061s/iter; left time: 22.4313s
Updating learning rate to 0.0002339721939
Validation loss decreased (inf --> 0.2885).  Saving model state dict ...
Epoch: 1 cost time: 3.511044502258301
Epoch: 1, Steps: 523 | Train Loss: 0.6718645 Vali Loss: 0.2885205 Best vali loss: 0.2885205
	iters: 100, epoch: 2 | loss: 0.9749969
	speed: 0.0132s/iter; left time: 46.9558s
	iters: 200, epoch: 2 | loss: 0.7016139
	speed: 0.0062s/iter; left time: 21.3011s
	iters: 300, epoch: 2 | loss: 0.6237267
	speed: 0.0059s/iter; left time: 19.8942s
	iters: 400, epoch: 2 | loss: 0.2456036
	speed: 0.0058s/iter; left time: 19.0024s
	iters: 500, epoch: 2 | loss: 0.2585185
	speed: 0.0059s/iter; left time: 18.5403s
Updating learning rate to 0.00011698609695
Validation loss decreased (0.2885 --> 0.2824).  Saving model state dict ...
Epoch: 2 cost time: 3.1977927684783936
Epoch: 2, Steps: 523 | Train Loss: 0.5608919 Vali Loss: 0.2823847 Best vali loss: 0.2823847
	iters: 100, epoch: 3 | loss: 0.5396841
	speed: 0.0129s/iter; left time: 39.1359s
	iters: 200, epoch: 3 | loss: 0.4041235
	speed: 0.0061s/iter; left time: 17.9285s
	iters: 300, epoch: 3 | loss: 0.2809986
	speed: 0.0061s/iter; left time: 17.2661s
	iters: 400, epoch: 3 | loss: 0.3035687
	speed: 0.0062s/iter; left time: 16.9530s
	iters: 500, epoch: 3 | loss: 0.3000057
	speed: 0.0062s/iter; left time: 16.4598s
Updating learning rate to 5.8493048475e-05
Validation loss decreased (0.2824 --> 0.2781).  Saving model state dict ...
Epoch: 3 cost time: 3.257399320602417
Epoch: 3, Steps: 523 | Train Loss: 0.3656761 Vali Loss: 0.2781093 Best vali loss: 0.2781093

best validation loss 0.27810926573034467

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0020735604228, 'e_layers': 3, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3198852
	speed: 0.0106s/iter; left time: 87.3124s
	iters: 200, epoch: 1 | loss: 2.3360276
	speed: 0.0047s/iter; left time: 38.3873s
	iters: 300, epoch: 1 | loss: 0.9092858
	speed: 0.0040s/iter; left time: 32.1854s
	iters: 400, epoch: 1 | loss: 1.2361578
	speed: 0.0039s/iter; left time: 31.3848s
	iters: 500, epoch: 1 | loss: 0.3326966
	speed: 0.0068s/iter; left time: 53.7434s
	iters: 600, epoch: 1 | loss: 0.5168852
	speed: 0.0067s/iter; left time: 51.7380s
	iters: 700, epoch: 1 | loss: 1.1539090
	speed: 0.0077s/iter; left time: 58.9397s
	iters: 800, epoch: 1 | loss: 0.3564436
	speed: 0.0062s/iter; left time: 46.6471s
	iters: 900, epoch: 1 | loss: 0.3461186
	speed: 0.0043s/iter; left time: 31.7453s
	iters: 1000, epoch: 1 | loss: 0.2890269
	speed: 0.0058s/iter; left time: 42.5471s
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.2963).  Saving model state dict ...
Epoch: 1 cost time: 6.18680739402771
Epoch: 1, Steps: 1045 | Train Loss: 0.7796436 Vali Loss: 0.2963173 Best vali loss: 0.2963173
	iters: 100, epoch: 2 | loss: 0.5109796
	speed: 0.0252s/iter; left time: 182.1627s
	iters: 200, epoch: 2 | loss: 0.3016464
	speed: 0.0068s/iter; left time: 48.6231s
	iters: 300, epoch: 2 | loss: 0.5811883
	speed: 0.0057s/iter; left time: 39.9867s
	iters: 400, epoch: 2 | loss: 0.6555320
	speed: 0.0038s/iter; left time: 26.1004s
	iters: 500, epoch: 2 | loss: 0.6236416
	speed: 0.0038s/iter; left time: 25.6075s
	iters: 600, epoch: 2 | loss: 0.2746972
	speed: 0.0037s/iter; left time: 25.0503s
	iters: 700, epoch: 2 | loss: 0.2838328
	speed: 0.0036s/iter; left time: 23.9388s
	iters: 800, epoch: 2 | loss: 0.9988495
	speed: 0.0037s/iter; left time: 24.2359s
	iters: 900, epoch: 2 | loss: 1.1394533
	speed: 0.0037s/iter; left time: 23.8165s
	iters: 1000, epoch: 2 | loss: 0.4666091
	speed: 0.0062s/iter; left time: 39.0309s
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.2963 --> 0.2852).  Saving model state dict ...
Epoch: 2 cost time: 5.078804969787598
Epoch: 2, Steps: 1045 | Train Loss: 0.5836430 Vali Loss: 0.2851921 Best vali loss: 0.2851921
	iters: 100, epoch: 3 | loss: 0.2827462
	speed: 0.0203s/iter; left time: 125.5191s
	iters: 200, epoch: 3 | loss: 0.2674043
	speed: 0.0062s/iter; left time: 37.5742s
	iters: 300, epoch: 3 | loss: 1.3724856
	speed: 0.0061s/iter; left time: 36.3968s
	iters: 400, epoch: 3 | loss: 0.3077049
	speed: 0.0064s/iter; left time: 37.3372s
	iters: 500, epoch: 3 | loss: 0.2721516
	speed: 0.0063s/iter; left time: 36.3745s
	iters: 600, epoch: 3 | loss: 0.2925568
	speed: 0.0048s/iter; left time: 27.3283s
	iters: 700, epoch: 3 | loss: 0.2273539
	speed: 0.0044s/iter; left time: 24.4194s
	iters: 800, epoch: 3 | loss: 0.2972274
	speed: 0.0068s/iter; left time: 37.0530s
	iters: 900, epoch: 3 | loss: 0.5834790
	speed: 0.0068s/iter; left time: 36.4960s
	iters: 1000, epoch: 3 | loss: 0.2885418
	speed: 0.0076s/iter; left time: 40.0846s
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.2852 --> 0.2840).  Saving model state dict ...
Epoch: 3 cost time: 6.577622413635254
Epoch: 3, Steps: 1045 | Train Loss: 0.4191652 Vali Loss: 0.2839629 Best vali loss: 0.2839629

best validation loss 0.2839629379190801

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0053943522932, 'e_layers': 4, 'learning_rate': 0.0002804459926, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002697721525689759
Validation loss decreased (inf --> 0.2830).  Saving model state dict ...
Epoch: 1 cost time: 1.1598315238952637
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2830320 Best vali loss: 0.2830320
Updating learning rate to 0.00023937562786202615
Epoch: 2 cost time: 0.5404391288757324
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2830973 Best vali loss: 0.2830320
Updating learning rate to 0.0001938840138206013
Epoch: 3 cost time: 0.8301670551300049
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2832595 Best vali loss: 0.2830320

best validation loss 0.2830320408948073

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.011102994395, 'e_layers': 4, 'learning_rate': 0.0002339721939, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3713110
	speed: 0.0194s/iter; left time: 48.7679s
	iters: 200, epoch: 4 | loss: 0.2033213
	speed: 0.0111s/iter; left time: 26.7698s
	iters: 300, epoch: 4 | loss: 0.3553167
	speed: 0.0131s/iter; left time: 30.4172s
	iters: 400, epoch: 4 | loss: 0.6140150
	speed: 0.0077s/iter; left time: 17.1472s
	iters: 500, epoch: 4 | loss: 0.6721368
	speed: 0.0046s/iter; left time: 9.7580s
Updating learning rate to 2.92465242375e-05
Epoch: 4 cost time: 5.310037136077881
Epoch: 4, Steps: 523 | Train Loss: 0.4432202 Vali Loss: 0.2861838 Best vali loss: 0.2781093
	iters: 100, epoch: 5 | loss: 0.5649563
	speed: 0.0106s/iter; left time: 21.1539s
	iters: 200, epoch: 5 | loss: 0.6035633
	speed: 0.0053s/iter; left time: 10.0283s
	iters: 300, epoch: 5 | loss: 0.5200781
	speed: 0.0053s/iter; left time: 9.5477s
	iters: 400, epoch: 5 | loss: 0.2288700
	speed: 0.0054s/iter; left time: 9.0643s
	iters: 500, epoch: 5 | loss: 0.2145732
	speed: 0.0054s/iter; left time: 8.5761s
Updating learning rate to 1.462326211875e-05
Validation loss decreased (0.2781 --> 0.2780).  Saving model state dict ...
Epoch: 5 cost time: 2.8297815322875977
Epoch: 5, Steps: 523 | Train Loss: 0.4264082 Vali Loss: 0.2780318 Best vali loss: 0.2780318
	iters: 100, epoch: 6 | loss: 0.4925317
	speed: 0.0100s/iter; left time: 14.6367s
	iters: 200, epoch: 6 | loss: 0.2871591
	speed: 0.0046s/iter; left time: 6.3307s
	iters: 300, epoch: 6 | loss: 0.2510186
	speed: 0.0046s/iter; left time: 5.8886s
	iters: 400, epoch: 6 | loss: 0.2731106
	speed: 0.0046s/iter; left time: 5.4129s
	iters: 500, epoch: 6 | loss: 0.2907808
	speed: 0.0046s/iter; left time: 4.9601s
Updating learning rate to 7.311631059375e-06
Validation loss decreased (0.2780 --> 0.2770).  Saving model state dict ...
Epoch: 6 cost time: 2.4722118377685547
Epoch: 6, Steps: 523 | Train Loss: 0.3189201 Vali Loss: 0.2770002 Best vali loss: 0.2770002
	iters: 100, epoch: 7 | loss: 0.4636992
	speed: 0.0108s/iter; left time: 10.1847s
	iters: 200, epoch: 7 | loss: 0.2682224
	speed: 0.0054s/iter; left time: 4.5713s
	iters: 300, epoch: 7 | loss: 0.6550351
	speed: 0.0053s/iter; left time: 3.9695s
	iters: 400, epoch: 7 | loss: 0.5838316
	speed: 0.0054s/iter; left time: 3.4865s
	iters: 500, epoch: 7 | loss: 0.4576727
	speed: 0.0053s/iter; left time: 2.9200s
Updating learning rate to 3.6558155296875e-06
Epoch: 7 cost time: 2.848820686340332
Epoch: 7, Steps: 523 | Train Loss: 0.4856922 Vali Loss: 0.2800968 Best vali loss: 0.2770002
	iters: 100, epoch: 8 | loss: 0.3368632
	speed: 0.0099s/iter; left time: 4.1959s
	iters: 200, epoch: 8 | loss: 0.1850938
	speed: 0.0046s/iter; left time: 1.4866s
	iters: 300, epoch: 8 | loss: 0.4062778
	speed: 0.0046s/iter; left time: 1.0267s
	iters: 400, epoch: 8 | loss: 0.3471821
	speed: 0.0046s/iter; left time: 0.5657s
	iters: 500, epoch: 8 | loss: 0.5724241
	speed: 0.0046s/iter; left time: 0.1106s
Updating learning rate to 1.82790776484375e-06
Epoch: 8 cost time: 2.454746723175049
Epoch: 8, Steps: 523 | Train Loss: 0.3695682 Vali Loss: 0.2815365 Best vali loss: 0.2770002

best validation loss 0.2770002308766077

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019713488614, 'e_layers': 4, 'learning_rate': 8.81054616e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.81054616e-05
Validation loss decreased (inf --> 0.2881).  Saving model state dict ...
Epoch: 1 cost time: 0.6771266460418701
Epoch: 1, Steps: 66 | Train Loss: nan Vali Loss: 0.2881410 Best vali loss: 0.2881410
Updating learning rate to 4.40527308e-05
Validation loss decreased (0.2881 --> 0.2808).  Saving model state dict ...
Epoch: 2 cost time: 0.45888638496398926
Epoch: 2, Steps: 66 | Train Loss: nan Vali Loss: 0.2808445 Best vali loss: 0.2808445
Updating learning rate to 2.20263654e-05
Validation loss decreased (0.2808 --> 0.2794).  Saving model state dict ...
Epoch: 3 cost time: 0.45703959465026855
Epoch: 3, Steps: 66 | Train Loss: nan Vali Loss: 0.2793989 Best vali loss: 0.2793989
Updating learning rate to 1.10131827e-05
Epoch: 4 cost time: 0.4606750011444092
Epoch: 4, Steps: 66 | Train Loss: nan Vali Loss: 0.2796008 Best vali loss: 0.2793989
Updating learning rate to 5.50659135e-06
Validation loss decreased (0.2794 --> 0.2793).  Saving model state dict ...
Epoch: 5 cost time: 0.4610457420349121
Epoch: 5, Steps: 66 | Train Loss: nan Vali Loss: 0.2792593 Best vali loss: 0.2792593
Updating learning rate to 2.753295675e-06
Validation loss decreased (0.2793 --> 0.2791).  Saving model state dict ...
Epoch: 6 cost time: 0.46211814880371094
Epoch: 6, Steps: 66 | Train Loss: nan Vali Loss: 0.2791348 Best vali loss: 0.2791348
Updating learning rate to 1.3766478375e-06
Validation loss decreased (0.2791 --> 0.2790).  Saving model state dict ...
Epoch: 7 cost time: 0.42757463455200195
Epoch: 7, Steps: 66 | Train Loss: nan Vali Loss: 0.2790006 Best vali loss: 0.2790006
Updating learning rate to 6.8832391875e-07
Validation loss decreased (0.2790 --> 0.2789).  Saving model state dict ...
Epoch: 8 cost time: 0.4134376049041748
Epoch: 8, Steps: 66 | Train Loss: nan Vali Loss: 0.2789360 Best vali loss: 0.2789360

best validation loss 0.2789359889694553

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045395061906, 'e_layers': 1, 'learning_rate': 7.97839266e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4037318
	speed: 0.0088s/iter; left time: 8.3107s
Updating learning rate to 7.97839266e-05
Validation loss decreased (inf --> 0.2817).  Saving model state dict ...
Epoch: 1 cost time: 0.6817071437835693
Epoch: 1, Steps: 131 | Train Loss: 0.4037318 Vali Loss: 0.2817091 Best vali loss: 0.2817091
	iters: 100, epoch: 2 | loss: 0.5434175
	speed: 0.0056s/iter; left time: 4.5616s
Updating learning rate to 3.98919633e-05
Validation loss decreased (0.2817 --> 0.2780).  Saving model state dict ...
Epoch: 2 cost time: 0.4037299156188965
Epoch: 2, Steps: 131 | Train Loss: 0.5434175 Vali Loss: 0.2779951 Best vali loss: 0.2779951
	iters: 100, epoch: 3 | loss: 0.4467848
	speed: 0.0057s/iter; left time: 3.8864s
Updating learning rate to 1.994598165e-05
Validation loss decreased (0.2780 --> 0.2778).  Saving model state dict ...
Epoch: 3 cost time: 0.40156126022338867
Epoch: 3, Steps: 131 | Train Loss: 0.4467848 Vali Loss: 0.2777994 Best vali loss: 0.2777994
	iters: 100, epoch: 4 | loss: 0.5717798
	speed: 0.0055s/iter; left time: 3.0622s
Updating learning rate to 9.972990825e-06
Validation loss decreased (0.2778 --> 0.2769).  Saving model state dict ...
Epoch: 4 cost time: 0.400402307510376
Epoch: 4, Steps: 131 | Train Loss: 0.5717798 Vali Loss: 0.2769480 Best vali loss: 0.2769480
	iters: 100, epoch: 5 | loss: 0.5425058
	speed: 0.0055s/iter; left time: 2.3383s
Updating learning rate to 4.9864954125e-06
Epoch: 5 cost time: 0.40092015266418457
Epoch: 5, Steps: 131 | Train Loss: 0.5425058 Vali Loss: 0.2773904 Best vali loss: 0.2769480
	iters: 100, epoch: 6 | loss: 0.4068766
	speed: 0.0052s/iter; left time: 1.5249s
Updating learning rate to 2.49324770625e-06
Epoch: 6 cost time: 0.3911879062652588
Epoch: 6, Steps: 131 | Train Loss: 0.4068766 Vali Loss: 0.2776002 Best vali loss: 0.2769480
	iters: 100, epoch: 7 | loss: 0.4390622
	speed: 0.0054s/iter; left time: 0.8878s
Updating learning rate to 1.246623853125e-06
Epoch: 7 cost time: 0.4088606834411621
Epoch: 7, Steps: 131 | Train Loss: 0.4390622 Vali Loss: 0.2774588 Best vali loss: 0.2769480
	iters: 100, epoch: 8 | loss: 0.6419964
	speed: 0.0054s/iter; left time: 0.1743s
Updating learning rate to 6.233119265625e-07
Epoch: 8 cost time: 0.4235193729400635
Epoch: 8, Steps: 131 | Train Loss: 0.6419964 Vali Loss: 0.2773991 Best vali loss: 0.2769480

best validation loss 0.2769479527487636

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001366266417, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6752638
	speed: 0.0154s/iter; left time: 14.6305s
Updating learning rate to 0.00013142659978119153
Validation loss decreased (inf --> 0.2819).  Saving model state dict ...
Epoch: 1 cost time: 1.5661132335662842
Epoch: 1, Steps: 131 | Train Loss: 0.6752638 Vali Loss: 0.2819057 Best vali loss: 0.2819057
	iters: 100, epoch: 2 | loss: 0.4029430
	speed: 0.0159s/iter; left time: 12.9714s
Updating learning rate to 0.00011661813326840736
Validation loss decreased (0.2819 --> 0.2753).  Saving model state dict ...
Epoch: 2 cost time: 1.3076038360595703
Epoch: 2, Steps: 131 | Train Loss: 0.4029430 Vali Loss: 0.2753401 Best vali loss: 0.2753401
	iters: 100, epoch: 3 | loss: 0.3722905
	speed: 0.0159s/iter; left time: 10.9560s
Updating learning rate to 9.445569694913567e-05
Epoch: 3 cost time: 1.3111827373504639
Epoch: 3, Steps: 131 | Train Loss: 0.3722905 Vali Loss: 0.2801920 Best vali loss: 0.2753401

best validation loss 0.2753401283949181

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023881242916, 'e_layers': 3, 'learning_rate': 0.0003852241358, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 145, in _serve
    send(conn, destination_pid)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 50, in send
    reduction.send_handle(conn, new_fd, pid)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 183, in send_handle
    with socket.fromfd(conn.fileno(), socket.AF_UNIX, socket.SOCK_STREAM) as s:
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/socket.py", line 545, in fromfd
    nfd = dup(fd)
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1293, in _get_data
    success, data = self._try_get_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 496, in rebuild_storage_fd
    fd = df.detach()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 189, in recv_handle
    return recvfds(s, 1)[0]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 159, in recvfds
    raise EOFError
EOFError


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception EOFError - 


{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0029512536949, 'e_layers': 3, 'learning_rate': 8.61514415e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001366266417, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8353
val 2689
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0066302201562, 'e_layers': 1, 'learning_rate': 0.0005581450259, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 53, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 76, in register
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 126, in _start
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 448, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 584, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/socket.py", line 232, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0028704942058, 'e_layers': 1, 'learning_rate': 0.0001232468964, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 53, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 76, in register
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 126, in _start
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 448, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 584, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/socket.py", line 232, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
    return self._process_data(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3082886_2653214904_3> in read-write mode: Too many open files (24)



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3082886_2653214904_3> in read-write mode: Too many open files (24)



{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0056007514956, 'e_layers': 2, 'learning_rate': 0.0033265458685, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
    return self._process_data(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3082924_2881184218_1> in read-write mode: Too many open files (24)



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3082924_2881184218_1> in read-write mode: Too many open files (24)



{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0035662121138, 'e_layers': 2, 'learning_rate': 0.001522687034, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
    child_r, parent_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1020, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 43, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 68, in Lock
    return Lock(ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 162, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 57, in __init__
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x71e9ae5a9120>
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1477, in __del__
    self._shutdown_workers()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1408, in _shutdown_workers
    if not self._shutdown:
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_shutdown'
{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0060846577031, 'e_layers': 4, 'learning_rate': 0.0023894564118, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1011, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 43, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 68, in Lock
    return Lock(ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 162, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 57, in __init__
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0054087995747, 'e_layers': 2, 'learning_rate': 0.000320277044, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 221, in train
    _, train_loader = _get_data(args, flag='train')
  File "/home/antonio/Documents/tfm/SOFTS/NEW/tfm_utils/train_utils.py", line 40, in _get_data
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_factory.py", line 38, in data_provider
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_loader.py", line 44, in __init__
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_loader.py", line 48, in __read_data__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/common.py", line 873, in get_handle
OSError: [Errno 24] Too many open files: './dataset/ETT-small/ETTh2.csv'


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files: './dataset/ETT-small/ETTh2.csv'


{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 1, 'learning_rate': 0.0044405212972, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011380106664, 'e_layers': 2, 'learning_rate': 0.0014785421787, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022180841037, 'e_layers': 4, 'learning_rate': 0.0009753388759, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 1, 'learning_rate': 0.0044405212972, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 4, 'learning_rate': 5.49249532e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0090081835366, 'e_layers': 1, 'learning_rate': 0.0022095915955, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0022057538806, 'e_layers': 3, 'learning_rate': 0.0020632911339, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0012644689267, 'e_layers': 3, 'learning_rate': 5.87850584e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0026375387316, 'e_layers': 2, 'learning_rate': 0.0003869507914, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0022057538806, 'e_layers': 3, 'learning_rate': 0.0020632911339, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0027868200264, 'e_layers': 4, 'learning_rate': 0.0001369508687, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0091523064195, 'e_layers': 3, 'learning_rate': 7.3618282e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0050164002415, 'e_layers': 4, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
    w.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
    child_r, parent_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0059416893406, 'e_layers': 3, 'learning_rate': 8.06031958e-05, 'lradj': 'cosine', 'd_ff': 768}
Use CPU
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
    w.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 64, in _launch
    parent_r, child_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0020327141074, 'e_layers': 2, 'learning_rate': 0.0005663536047, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 8353
val 2689
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1020, in __init__
    index_queue = multiprocessing_context.Queue()  # type: ignore[var-annotated]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 42, in __init__
    self._reader, self._writer = connection.Pipe(duplex=False)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 527, in Pipe
    fd1, fd2 = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x71e9ae5a9120>
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1477, in __del__
    self._shutdown_workers()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1408, in _shutdown_workers
    if not self._shutdown:
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_shutdown'
{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0050164002415, 'e_layers': 4, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 8353
val 2689
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1011, in __init__
    self._worker_result_queue = multiprocessing_context.Queue()  # type: ignore[var-annotated]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 42, in __init__
    self._reader, self._writer = connection.Pipe(duplex=False)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 527, in Pipe
    fd1, fd2 = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 379, in __call__
    subprocess.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
OSError: [Errno 24] Too many open files


Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/facade/abstract_facade.py", line 322, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 310, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 431, in _add_results
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 229, in tell
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 417, in save
OSError: [Errno 24] Too many open files: 'checkpoints/hptunning/smac/ETTh2_96_192/123/optimization.json'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 478, in <module>
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/facade/abstract_facade.py", line 324, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 417, in save
OSError: [Errno 24] Too many open files: 'checkpoints/hptunning/smac/ETTh2_96_192/123/optimization.json'


Time taken (1 parallel trials): 6134 seconds


