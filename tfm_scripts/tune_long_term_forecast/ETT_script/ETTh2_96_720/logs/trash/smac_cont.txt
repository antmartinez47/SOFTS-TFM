horizon=720
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123 \
    --restore_experiment;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][smbo.py:498] Continuing from previous run.
[INFO][abstract_intensifier.py:288] Added existing seed 843828734 from runhistory to the intensifier.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 246, in train
    checkpoint = torch.load(checkpoint_path)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/serialization.py", line 1114, in load
    return _legacy_load(
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/serialization.py", line 1338, in _legacy_load
    magic_number = pickle_module.load(f, **pickle_load_args)
EOFError: Ran out of input


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception EOFError - Ran out of input


[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0016623644096, 'e_layers': 2, 'learning_rate': 0.0022181710066, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0358944
	speed: 0.0162s/iter; left time: 14.3611s
Updating learning rate to 0.0022181710066
Validation loss decreased (inf --> 0.6195).  Saving model state dict ...
Epoch: 1 cost time: 1.547163963317871
Epoch: 1, Steps: 123 | Train Loss: 1.0358944 Vali Loss: 0.6195110 Best vali loss: 0.6195110
	iters: 100, epoch: 2 | loss: 0.9535790
	speed: 0.0170s/iter; left time: 12.9754s
Updating learning rate to 0.0011090855033
Validation loss decreased (0.6195 --> 0.6184).  Saving model state dict ...
Epoch: 2 cost time: 1.4000310897827148
Epoch: 2, Steps: 123 | Train Loss: 0.9535790 Vali Loss: 0.6184262 Best vali loss: 0.6184262
	iters: 100, epoch: 3 | loss: 0.8379927
	speed: 0.0157s/iter; left time: 10.0411s
Updating learning rate to 0.00055454275165
Validation loss decreased (0.6184 --> 0.6117).  Saving model state dict ...
Epoch: 3 cost time: 1.218644380569458
Epoch: 3, Steps: 123 | Train Loss: 0.8379927 Vali Loss: 0.6116520 Best vali loss: 0.6116520
	iters: 100, epoch: 4 | loss: 0.6479751
	speed: 0.0167s/iter; left time: 8.6184s
Updating learning rate to 0.000277271375825
Epoch: 4 cost time: 1.333550214767456
Epoch: 4, Steps: 123 | Train Loss: 0.6479751 Vali Loss: 0.6130509 Best vali loss: 0.6116520
	iters: 100, epoch: 5 | loss: 0.8992561
	speed: 0.0132s/iter; left time: 5.1692s
Updating learning rate to 0.0001386356879125
Validation loss decreased (0.6117 --> 0.6080).  Saving model state dict ...
Epoch: 5 cost time: 1.0313196182250977
Epoch: 5, Steps: 123 | Train Loss: 0.8992561 Vali Loss: 0.6079587 Best vali loss: 0.6079587
	iters: 100, epoch: 6 | loss: 0.5306364
	speed: 0.0131s/iter; left time: 3.5403s
Updating learning rate to 6.931784395625e-05
Epoch: 6 cost time: 1.065213680267334
Epoch: 6, Steps: 123 | Train Loss: 0.5306364 Vali Loss: 0.6163616 Best vali loss: 0.6079587
	iters: 100, epoch: 7 | loss: 0.6112621
	speed: 0.0123s/iter; left time: 1.8129s
Updating learning rate to 3.4658921978125e-05
Epoch: 7 cost time: 1.0092980861663818
Epoch: 7, Steps: 123 | Train Loss: 0.6112621 Vali Loss: 0.6460063 Best vali loss: 0.6079587
	iters: 100, epoch: 8 | loss: 0.7215107
	speed: 0.0118s/iter; left time: 0.2820s
Updating learning rate to 1.73294609890625e-05
Epoch: 8 cost time: 0.9451131820678711
Epoch: 8, Steps: 123 | Train Loss: 0.7215107 Vali Loss: 0.6360710 Best vali loss: 0.6079587

best validation loss 0.6079586621844509

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0026286092899, 'e_layers': 3, 'learning_rate': 0.0009450298731, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9197561
	speed: 0.0116s/iter; left time: 21.6151s
	iters: 200, epoch: 1 | loss: 0.9359885
	speed: 0.0081s/iter; left time: 14.2697s
Updating learning rate to 0.0009450298731
Validation loss decreased (inf --> 0.6037).  Saving model state dict ...
Epoch: 1 cost time: 2.111849069595337
Epoch: 1, Steps: 245 | Train Loss: 0.9278723 Vali Loss: 0.6037499 Best vali loss: 0.6037499
	iters: 100, epoch: 2 | loss: 0.9552355
	speed: 0.0177s/iter; left time: 28.5341s
	iters: 200, epoch: 2 | loss: 1.0183997
	speed: 0.0106s/iter; left time: 16.0184s
Updating learning rate to 0.00047251493655
Epoch: 2 cost time: 2.419752359390259
Epoch: 2, Steps: 245 | Train Loss: 0.9868176 Vali Loss: 0.6178555 Best vali loss: 0.6037499
	iters: 100, epoch: 3 | loss: 0.7156444
	speed: 0.0182s/iter; left time: 24.9687s
	iters: 200, epoch: 3 | loss: 0.7516440
	speed: 0.0101s/iter; left time: 12.8411s
Updating learning rate to 0.000236257468275
Validation loss decreased (0.6037 --> 0.5635).  Saving model state dict ...
Epoch: 3 cost time: 2.3966755867004395
Epoch: 3, Steps: 245 | Train Loss: 0.7336442 Vali Loss: 0.5635498 Best vali loss: 0.5635498
	iters: 100, epoch: 4 | loss: 0.6273495
	speed: 0.0184s/iter; left time: 20.6935s
	iters: 200, epoch: 4 | loss: 0.6198862
	speed: 0.0090s/iter; left time: 9.2606s
Updating learning rate to 0.0001181287341375
Validation loss decreased (0.5635 --> 0.5558).  Saving model state dict ...
Epoch: 4 cost time: 2.159897804260254
Epoch: 4, Steps: 245 | Train Loss: 0.6236179 Vali Loss: 0.5558499 Best vali loss: 0.5558499
	iters: 100, epoch: 5 | loss: 0.6418001
	speed: 0.0186s/iter; left time: 16.3830s
	iters: 200, epoch: 5 | loss: 0.8387876
	speed: 0.0118s/iter; left time: 9.2221s
Updating learning rate to 5.906436706875e-05
Validation loss decreased (0.5558 --> 0.5452).  Saving model state dict ...
Epoch: 5 cost time: 2.750507354736328
Epoch: 5, Steps: 245 | Train Loss: 0.7402938 Vali Loss: 0.5452008 Best vali loss: 0.5452008
	iters: 100, epoch: 6 | loss: 0.5152622
	speed: 0.0144s/iter; left time: 9.1751s
	iters: 200, epoch: 6 | loss: 1.2318344
	speed: 0.0094s/iter; left time: 5.0384s
Updating learning rate to 2.9532183534375e-05
Epoch: 6 cost time: 2.235443592071533
Epoch: 6, Steps: 245 | Train Loss: 0.8735483 Vali Loss: 0.5506665 Best vali loss: 0.5452008
	iters: 100, epoch: 7 | loss: 0.6881141
	speed: 0.0286s/iter; left time: 11.1854s
	iters: 200, epoch: 7 | loss: 0.7067966
	speed: 0.0155s/iter; left time: 4.4996s
Updating learning rate to 1.47660917671875e-05
Epoch: 7 cost time: 3.7493879795074463
Epoch: 7, Steps: 245 | Train Loss: 0.6974553 Vali Loss: 0.5503232 Best vali loss: 0.5452008
	iters: 100, epoch: 8 | loss: 0.5049188
	speed: 0.0211s/iter; left time: 3.0849s
	iters: 200, epoch: 8 | loss: 0.6388733
	speed: 0.0120s/iter; left time: 0.5531s
Updating learning rate to 7.38304588359375e-06
Epoch: 8 cost time: 2.5867412090301514
Epoch: 8, Steps: 245 | Train Loss: 0.5718960 Vali Loss: 0.5500372 Best vali loss: 0.5452008

best validation loss 0.5452007697390936

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0109152090083, 'e_layers': 2, 'learning_rate': 0.0001568907823, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7719260
	speed: 0.0198s/iter; left time: 152.9283s
	iters: 200, epoch: 1 | loss: 1.2919842
	speed: 0.0085s/iter; left time: 64.6227s
	iters: 300, epoch: 1 | loss: 0.9718008
	speed: 0.0078s/iter; left time: 58.4616s
	iters: 400, epoch: 1 | loss: 1.5581622
	speed: 0.0076s/iter; left time: 56.7710s
	iters: 500, epoch: 1 | loss: 1.1416557
	speed: 0.0084s/iter; left time: 61.7769s
	iters: 600, epoch: 1 | loss: 0.6728701
	speed: 0.0085s/iter; left time: 61.7930s
	iters: 700, epoch: 1 | loss: 1.3414164
	speed: 0.0071s/iter; left time: 50.6648s
	iters: 800, epoch: 1 | loss: 0.9574351
	speed: 0.0048s/iter; left time: 34.0853s
	iters: 900, epoch: 1 | loss: 1.5789686
	speed: 0.0049s/iter; left time: 34.2143s
Updating learning rate to 0.00015091948245332703
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 7.916691064834595
Epoch: 1, Steps: 979 | Train Loss: 1.1429132 Vali Loss: 0.6040865 Best vali loss: 0.6040865
	iters: 100, epoch: 2 | loss: 0.6678838
	speed: 0.0211s/iter; left time: 142.3770s
	iters: 200, epoch: 2 | loss: 0.3854306
	speed: 0.0060s/iter; left time: 39.8547s
	iters: 300, epoch: 2 | loss: 0.8145146
	speed: 0.0061s/iter; left time: 39.7707s
	iters: 400, epoch: 2 | loss: 1.5104917
	speed: 0.0058s/iter; left time: 37.7526s
	iters: 500, epoch: 2 | loss: 0.5952054
	speed: 0.0055s/iter; left time: 34.8544s
	iters: 600, epoch: 2 | loss: 0.6051473
	speed: 0.0056s/iter; left time: 35.2639s
	iters: 700, epoch: 2 | loss: 0.6854397
	speed: 0.0057s/iter; left time: 35.1265s
	iters: 800, epoch: 2 | loss: 0.7822571
	speed: 0.0061s/iter; left time: 36.8345s
	iters: 900, epoch: 2 | loss: 1.0872276
	speed: 0.0060s/iter; left time: 35.9102s
Updating learning rate to 0.00013391465918499617
Validation loss decreased (0.6041 --> 0.6015).  Saving model state dict ...
Epoch: 2 cost time: 5.812952518463135
Epoch: 2, Steps: 979 | Train Loss: 0.7926220 Vali Loss: 0.6014796 Best vali loss: 0.6014796
	iters: 100, epoch: 3 | loss: 1.0330876
	speed: 0.0206s/iter; left time: 118.8917s
	iters: 200, epoch: 3 | loss: 0.5205286
	speed: 0.0053s/iter; left time: 29.9256s
	iters: 300, epoch: 3 | loss: 0.5836504
	speed: 0.0055s/iter; left time: 30.6416s
	iters: 400, epoch: 3 | loss: 1.0584846
	speed: 0.0055s/iter; left time: 30.1615s
	iters: 500, epoch: 3 | loss: 0.9555596
	speed: 0.0053s/iter; left time: 28.2654s
	iters: 600, epoch: 3 | loss: 1.1070321
	speed: 0.0058s/iter; left time: 30.5228s
	iters: 700, epoch: 3 | loss: 0.5816875
	speed: 0.0080s/iter; left time: 41.6016s
	iters: 800, epoch: 3 | loss: 0.3554400
	speed: 0.0077s/iter; left time: 39.1832s
	iters: 900, epoch: 3 | loss: 0.9741670
	speed: 0.0078s/iter; left time: 38.6555s
Updating learning rate to 0.00010846514268850405
Epoch: 3 cost time: 6.259655714035034
Epoch: 3, Steps: 979 | Train Loss: 0.7966264 Vali Loss: 0.6049418 Best vali loss: 0.6014796

best validation loss 0.6014795910837694

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0005522653273, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6303989
	speed: 0.0102s/iter; left time: 78.5515s
	iters: 200, epoch: 1 | loss: 0.9689055
	speed: 0.0041s/iter; left time: 31.1760s
	iters: 300, epoch: 1 | loss: 0.7021176
	speed: 0.0042s/iter; left time: 31.6023s
	iters: 400, epoch: 1 | loss: 0.5167416
	speed: 0.0045s/iter; left time: 33.3206s
	iters: 500, epoch: 1 | loss: 0.6683044
	speed: 0.0042s/iter; left time: 30.9413s
	iters: 600, epoch: 1 | loss: 0.7103538
	speed: 0.0042s/iter; left time: 30.6835s
	iters: 700, epoch: 1 | loss: 0.9911730
	speed: 0.0042s/iter; left time: 29.9032s
	iters: 800, epoch: 1 | loss: 0.8087977
	speed: 0.0038s/iter; left time: 26.5936s
	iters: 900, epoch: 1 | loss: 0.8167060
	speed: 0.0044s/iter; left time: 30.1993s
Updating learning rate to 0.0005312459798540583
Validation loss decreased (inf --> 0.6270).  Saving model state dict ...
Epoch: 1 cost time: 4.443182945251465
Epoch: 1, Steps: 979 | Train Loss: 0.7570554 Vali Loss: 0.6270096 Best vali loss: 0.6270096
	iters: 100, epoch: 2 | loss: 1.1831163
	speed: 0.0179s/iter; left time: 120.6476s
	iters: 200, epoch: 2 | loss: 0.4994153
	speed: 0.0038s/iter; left time: 25.3940s
	iters: 300, epoch: 2 | loss: 0.6306950
	speed: 0.0035s/iter; left time: 22.8740s
	iters: 400, epoch: 2 | loss: 1.3440436
	speed: 0.0032s/iter; left time: 20.8446s
	iters: 500, epoch: 2 | loss: 0.3187992
	speed: 0.0033s/iter; left time: 20.6843s
	iters: 600, epoch: 2 | loss: 0.9422976
	speed: 0.0035s/iter; left time: 21.7924s
	iters: 700, epoch: 2 | loss: 0.4382016
	speed: 0.0037s/iter; left time: 22.4787s
	iters: 800, epoch: 2 | loss: 1.2706485
	speed: 0.0042s/iter; left time: 25.6214s
	iters: 900, epoch: 2 | loss: 1.2037648
	speed: 0.0042s/iter; left time: 24.7471s
Updating learning rate to 0.000471387942624019
Validation loss decreased (0.6270 --> 0.6190).  Saving model state dict ...
Epoch: 2 cost time: 3.7461907863616943
Epoch: 2, Steps: 979 | Train Loss: 0.8701091 Vali Loss: 0.6190318 Best vali loss: 0.6190318
	iters: 100, epoch: 3 | loss: 1.0350660
	speed: 0.0167s/iter; left time: 96.6460s
	iters: 200, epoch: 3 | loss: 0.8443741
	speed: 0.0041s/iter; left time: 23.4687s
	iters: 300, epoch: 3 | loss: 1.0802562
	speed: 0.0043s/iter; left time: 23.7955s
	iters: 400, epoch: 3 | loss: 1.3128240
	speed: 0.0041s/iter; left time: 22.3469s
	iters: 500, epoch: 3 | loss: 0.5536879
	speed: 0.0039s/iter; left time: 20.8241s
	iters: 600, epoch: 3 | loss: 1.1493731
	speed: 0.0039s/iter; left time: 20.4035s
	iters: 700, epoch: 3 | loss: 1.0799259
	speed: 0.0038s/iter; left time: 19.4691s
	iters: 800, epoch: 3 | loss: 0.8150414
	speed: 0.0056s/iter; left time: 28.5849s
	iters: 900, epoch: 3 | loss: 1.1902710
	speed: 0.0063s/iter; left time: 31.1632s
Updating learning rate to 0.00038180405916369686
Epoch: 3 cost time: 4.56293249130249
Epoch: 3, Steps: 979 | Train Loss: 1.0067577 Vali Loss: 0.6362125 Best vali loss: 0.6190318

best validation loss 0.619031753709944

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0034268099749, 'e_layers': 2, 'learning_rate': 0.0001980131493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8896998
	speed: 0.0165s/iter; left time: 14.5802s
Updating learning rate to 0.0001904767225531858
Validation loss decreased (inf --> 0.6564).  Saving model state dict ...
Epoch: 1 cost time: 1.5414364337921143
Epoch: 1, Steps: 123 | Train Loss: 0.8896998 Vali Loss: 0.6563854 Best vali loss: 0.6563854
	iters: 100, epoch: 2 | loss: 1.1797117
	speed: 0.0146s/iter; left time: 11.1447s
Updating learning rate to 0.00016901479496706713
Validation loss decreased (0.6564 --> 0.6361).  Saving model state dict ...
Epoch: 2 cost time: 1.138869047164917
Epoch: 2, Steps: 123 | Train Loss: 1.1797117 Vali Loss: 0.6360503 Best vali loss: 0.6360503
	iters: 100, epoch: 3 | loss: 0.8873987
	speed: 0.0143s/iter; left time: 9.1135s
Updating learning rate to 0.00013689475046377249
Validation loss decreased (0.6361 --> 0.6217).  Saving model state dict ...
Epoch: 3 cost time: 1.1364834308624268
Epoch: 3, Steps: 123 | Train Loss: 0.8873987 Vali Loss: 0.6216830 Best vali loss: 0.6216830

best validation loss 0.6216830263144437

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0109152090083, 'e_layers': 2, 'learning_rate': 0.0001568907823, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6408269
	speed: 0.0146s/iter; left time: 69.8799s
	iters: 200, epoch: 4 | loss: 1.2249930
	speed: 0.0076s/iter; left time: 35.7197s
	iters: 300, epoch: 4 | loss: 0.9249944
	speed: 0.0051s/iter; left time: 23.5109s
	iters: 400, epoch: 4 | loss: 1.4652529
	speed: 0.0056s/iter; left time: 25.3072s
	iters: 500, epoch: 4 | loss: 1.1421812
	speed: 0.0084s/iter; left time: 37.0891s
	iters: 600, epoch: 4 | loss: 0.6579333
	speed: 0.0079s/iter; left time: 33.8126s
	iters: 700, epoch: 4 | loss: 1.3561271
	speed: 0.0086s/iter; left time: 36.0683s
	iters: 800, epoch: 4 | loss: 0.9172927
	speed: 0.0081s/iter; left time: 33.2343s
	iters: 900, epoch: 4 | loss: 1.5622845
	speed: 0.0077s/iter; left time: 30.8617s
Updating learning rate to 7.844539115e-05
Validation loss decreased (0.6015 --> 0.5961).  Saving model state dict ...
Epoch: 4 cost time: 7.41976261138916
Epoch: 4, Steps: 979 | Train Loss: 1.0990984 Vali Loss: 0.5961046 Best vali loss: 0.5961046
	iters: 100, epoch: 5 | loss: 0.6631390
	speed: 0.0195s/iter; left time: 74.4644s
	iters: 200, epoch: 5 | loss: 0.3524662
	speed: 0.0060s/iter; left time: 22.4125s
	iters: 300, epoch: 5 | loss: 0.8040115
	speed: 0.0071s/iter; left time: 25.8575s
	iters: 400, epoch: 5 | loss: 1.3954257
	speed: 0.0071s/iter; left time: 24.8695s
	iters: 500, epoch: 5 | loss: 0.6006413
	speed: 0.0062s/iter; left time: 21.0583s
	iters: 600, epoch: 5 | loss: 0.5811235
	speed: 0.0054s/iter; left time: 17.7542s
	iters: 700, epoch: 5 | loss: 0.6810237
	speed: 0.0067s/iter; left time: 21.4987s
	iters: 800, epoch: 5 | loss: 0.7779226
	speed: 0.0070s/iter; left time: 21.8209s
	iters: 900, epoch: 5 | loss: 1.0643543
	speed: 0.0070s/iter; left time: 21.0499s
Updating learning rate to 4.842563961149597e-05
Epoch: 5 cost time: 6.448350667953491
Epoch: 5, Steps: 979 | Train Loss: 0.7689009 Vali Loss: 0.6078878 Best vali loss: 0.5961046
	iters: 100, epoch: 6 | loss: 0.9930091
	speed: 0.0235s/iter; left time: 66.5976s
	iters: 200, epoch: 6 | loss: 0.5036691
	speed: 0.0061s/iter; left time: 16.7765s
	iters: 300, epoch: 6 | loss: 0.5328556
	speed: 0.0065s/iter; left time: 17.1725s
	iters: 400, epoch: 6 | loss: 1.0205830
	speed: 0.0062s/iter; left time: 15.8159s
	iters: 500, epoch: 6 | loss: 0.8941987
	speed: 0.0060s/iter; left time: 14.6317s
	iters: 600, epoch: 6 | loss: 1.1282161
	speed: 0.0066s/iter; left time: 15.4260s
	iters: 700, epoch: 6 | loss: 0.5719214
	speed: 0.0061s/iter; left time: 13.6805s
	iters: 800, epoch: 6 | loss: 0.3515523
	speed: 0.0054s/iter; left time: 11.4602s
	iters: 900, epoch: 6 | loss: 0.9195365
	speed: 0.0047s/iter; left time: 9.5555s
Updating learning rate to 2.2976123115003823e-05
Epoch: 6 cost time: 5.731945037841797
Epoch: 6, Steps: 979 | Train Loss: 0.7683935 Vali Loss: 0.6072477 Best vali loss: 0.5961046
	iters: 100, epoch: 7 | loss: 0.7782094
	speed: 0.0198s/iter; left time: 36.7632s
	iters: 200, epoch: 7 | loss: 1.0362027
	speed: 0.0056s/iter; left time: 9.9200s
	iters: 300, epoch: 7 | loss: 0.6993909
	speed: 0.0058s/iter; left time: 9.6775s
	iters: 400, epoch: 7 | loss: 1.1028409
	speed: 0.0058s/iter; left time: 9.0469s
	iters: 500, epoch: 7 | loss: 1.2616698
	speed: 0.0058s/iter; left time: 8.4976s
	iters: 600, epoch: 7 | loss: 0.4467296
	speed: 0.0057s/iter; left time: 7.7011s
	iters: 700, epoch: 7 | loss: 0.5103883
	speed: 0.0057s/iter; left time: 7.1399s
	iters: 800, epoch: 7 | loss: 1.2356176
	speed: 0.0057s/iter; left time: 6.6114s
	iters: 900, epoch: 7 | loss: 0.3824500
	speed: 0.0058s/iter; left time: 6.0926s
Updating learning rate to 5.97129984667297e-06
Epoch: 7 cost time: 5.64682674407959
Epoch: 7, Steps: 979 | Train Loss: 0.8281666 Vali Loss: 0.6100197 Best vali loss: 0.5961046
	iters: 100, epoch: 8 | loss: 0.5937517
	speed: 0.0200s/iter; left time: 17.6243s
	iters: 200, epoch: 8 | loss: 0.4103353
	speed: 0.0053s/iter; left time: 4.1187s
	iters: 300, epoch: 8 | loss: 2.0665538
	speed: 0.0061s/iter; left time: 4.1163s
	iters: 400, epoch: 8 | loss: 0.5640507
	speed: 0.0060s/iter; left time: 3.4721s
	iters: 500, epoch: 8 | loss: 0.6070151
	speed: 0.0061s/iter; left time: 2.9404s
	iters: 600, epoch: 8 | loss: 0.5991734
	speed: 0.0063s/iter; left time: 2.4010s
	iters: 700, epoch: 8 | loss: 1.1636328
	speed: 0.0063s/iter; left time: 1.7572s
	iters: 800, epoch: 8 | loss: 0.4340132
	speed: 0.0061s/iter; left time: 1.1052s
	iters: 900, epoch: 8 | loss: 0.7319378
	speed: 0.0060s/iter; left time: 0.4839s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.883181095123291
Epoch: 8, Steps: 979 | Train Loss: 0.7967182 Vali Loss: 0.6106823 Best vali loss: 0.5961046

best validation loss 0.5961046165087222

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0041929184328, 'e_layers': 4, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4421893
	speed: 0.0147s/iter; left time: 113.8015s
	iters: 200, epoch: 1 | loss: 0.7237400
	speed: 0.0091s/iter; left time: 69.4091s
	iters: 300, epoch: 1 | loss: 0.8612878
	speed: 0.0093s/iter; left time: 69.9833s
	iters: 400, epoch: 1 | loss: 0.3893943
	speed: 0.0094s/iter; left time: 69.7965s
	iters: 500, epoch: 1 | loss: 0.6020312
	speed: 0.0089s/iter; left time: 65.3102s
	iters: 600, epoch: 1 | loss: 1.0008038
	speed: 0.0092s/iter; left time: 66.5852s
	iters: 700, epoch: 1 | loss: 1.3100833
	speed: 0.0094s/iter; left time: 67.2514s
	iters: 800, epoch: 1 | loss: 1.1129149
	speed: 0.0095s/iter; left time: 66.5430s
	iters: 900, epoch: 1 | loss: 0.7435367
	speed: 0.0087s/iter; left time: 60.2688s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.6080).  Saving model state dict ...
Epoch: 1 cost time: 9.128678560256958
Epoch: 1, Steps: 979 | Train Loss: 0.7984424 Vali Loss: 0.6079786 Best vali loss: 0.6079786
	iters: 100, epoch: 2 | loss: 0.4904000
	speed: 0.0425s/iter; left time: 287.1320s
	iters: 200, epoch: 2 | loss: 0.5517378
	speed: 0.0157s/iter; left time: 104.5552s
	iters: 300, epoch: 2 | loss: 0.9077224
	speed: 0.0176s/iter; left time: 115.0376s
	iters: 400, epoch: 2 | loss: 1.3669575
	speed: 0.0188s/iter; left time: 121.2078s
	iters: 500, epoch: 2 | loss: 1.6689808
	speed: 0.0158s/iter; left time: 100.6080s
	iters: 600, epoch: 2 | loss: 0.9659236
	speed: 0.0167s/iter; left time: 104.2225s
	iters: 700, epoch: 2 | loss: 0.7689061
	speed: 0.0103s/iter; left time: 63.5127s
	iters: 800, epoch: 2 | loss: 0.6416777
	speed: 0.0076s/iter; left time: 45.7231s
	iters: 900, epoch: 2 | loss: 0.2430631
	speed: 0.0069s/iter; left time: 41.0850s
Updating learning rate to 0.0018678807033885223
Validation loss decreased (0.6080 --> 0.6064).  Saving model state dict ...
Epoch: 2 cost time: 13.170480489730835
Epoch: 2, Steps: 979 | Train Loss: 0.8450410 Vali Loss: 0.6064248 Best vali loss: 0.6064248
	iters: 100, epoch: 3 | loss: 0.7722005
	speed: 0.0261s/iter; left time: 150.5090s
	iters: 200, epoch: 3 | loss: 0.3594632
	speed: 0.0091s/iter; left time: 51.6972s
	iters: 300, epoch: 3 | loss: 0.9231637
	speed: 0.0090s/iter; left time: 50.4286s
	iters: 400, epoch: 3 | loss: 0.4393805
	speed: 0.0088s/iter; left time: 48.1195s
	iters: 500, epoch: 3 | loss: 1.0995575
	speed: 0.0085s/iter; left time: 45.6151s
	iters: 600, epoch: 3 | loss: 0.9036044
	speed: 0.0091s/iter; left time: 48.1828s
	iters: 700, epoch: 3 | loss: 0.5818686
	speed: 0.0094s/iter; left time: 48.6128s
	iters: 800, epoch: 3 | loss: 0.7436973
	speed: 0.0091s/iter; left time: 46.0330s
	iters: 900, epoch: 3 | loss: 0.4231429
	speed: 0.0092s/iter; left time: 45.5800s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 8.896586656570435
Epoch: 3, Steps: 979 | Train Loss: 0.6940087 Vali Loss: 0.6189879 Best vali loss: 0.6064248
	iters: 100, epoch: 4 | loss: 1.5269109
	speed: 0.0291s/iter; left time: 139.3817s
	iters: 200, epoch: 4 | loss: 1.3229902
	speed: 0.0085s/iter; left time: 39.9195s
	iters: 300, epoch: 4 | loss: 0.9641067
	speed: 0.0091s/iter; left time: 42.0020s
	iters: 400, epoch: 4 | loss: 1.5929389
	speed: 0.0091s/iter; left time: 40.7386s
	iters: 500, epoch: 4 | loss: 1.1895609
	speed: 0.0088s/iter; left time: 38.6733s
	iters: 600, epoch: 4 | loss: 0.4572235
	speed: 0.0090s/iter; left time: 38.8411s
	iters: 700, epoch: 4 | loss: 1.0062261
	speed: 0.0090s/iter; left time: 37.5731s
	iters: 800, epoch: 4 | loss: 0.4519280
	speed: 0.0079s/iter; left time: 32.5563s
	iters: 900, epoch: 4 | loss: 0.5853304
	speed: 0.0094s/iter; left time: 37.6455s
Updating learning rate to 0.00109417918315
Epoch: 4 cost time: 8.733128070831299
Epoch: 4, Steps: 979 | Train Loss: 1.0108017 Vali Loss: 0.6303163 Best vali loss: 0.6064248
	iters: 100, epoch: 5 | loss: 0.2730095
	speed: 0.0371s/iter; left time: 141.6505s
	iters: 200, epoch: 5 | loss: 0.5522280
	speed: 0.0090s/iter; left time: 33.3507s
	iters: 300, epoch: 5 | loss: 0.5723266
	speed: 0.0123s/iter; left time: 44.4312s
	iters: 400, epoch: 5 | loss: 0.8593518
	speed: 0.0128s/iter; left time: 45.0922s
	iters: 500, epoch: 5 | loss: 0.8782454
	speed: 0.0121s/iter; left time: 41.5125s
	iters: 600, epoch: 5 | loss: 0.2451235
	speed: 0.0115s/iter; left time: 38.1222s
	iters: 700, epoch: 5 | loss: 1.1578108
	speed: 0.0115s/iter; left time: 37.1440s
	iters: 800, epoch: 5 | loss: 0.8411841
	speed: 0.0123s/iter; left time: 38.3845s
	iters: 900, epoch: 5 | loss: 0.8186859
	speed: 0.0121s/iter; left time: 36.4690s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017396805512, 'e_layers': 3, 'learning_rate': 0.0001422302375, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7073637
	speed: 0.0154s/iter; left time: 119.0295s
	iters: 200, epoch: 1 | loss: 0.7193060
	speed: 0.0085s/iter; left time: 65.1831s
	iters: 300, epoch: 1 | loss: 0.6508489
	speed: 0.0091s/iter; left time: 68.6911s
	iters: 400, epoch: 1 | loss: 1.4147989
	speed: 0.0084s/iter; left time: 62.5699s
	iters: 500, epoch: 1 | loss: 0.8571193
	speed: 0.0087s/iter; left time: 63.6844s
	iters: 600, epoch: 1 | loss: 1.4464300
	speed: 0.0083s/iter; left time: 60.0884s
	iters: 700, epoch: 1 | loss: 1.6798197
	speed: 0.0087s/iter; left time: 62.1168s
	iters: 800, epoch: 1 | loss: 0.5807402
	speed: 0.0079s/iter; left time: 55.4690s
	iters: 900, epoch: 1 | loss: 0.8723263
	speed: 0.0071s/iter; left time: 49.0112s
Updating learning rate to 0.00013681692141523464
Validation loss decreased (inf --> 0.5766).  Saving model state dict ...
Epoch: 1 cost time: 8.892963647842407
Epoch: 1, Steps: 979 | Train Loss: 0.9920836 Vali Loss: 0.5765643 Best vali loss: 0.5765643
	iters: 100, epoch: 2 | loss: 0.3043659
	speed: 0.0429s/iter; left time: 289.4798s
	iters: 200, epoch: 2 | loss: 0.5982829
	speed: 0.0119s/iter; left time: 79.1493s
	iters: 300, epoch: 2 | loss: 0.6517115
	speed: 0.0124s/iter; left time: 81.1109s
	iters: 400, epoch: 2 | loss: 0.5530021
	speed: 0.0071s/iter; left time: 45.9657s
	iters: 500, epoch: 2 | loss: 0.4523143
	speed: 0.0084s/iter; left time: 53.2748s
	iters: 600, epoch: 2 | loss: 1.1946384
	speed: 0.0100s/iter; left time: 62.6279s
	iters: 700, epoch: 2 | loss: 0.7964962
	speed: 0.0101s/iter; left time: 62.2178s
	iters: 800, epoch: 2 | loss: 0.8576803
	speed: 0.0081s/iter; left time: 48.7585s
	iters: 900, epoch: 2 | loss: 0.6565928
	speed: 0.0074s/iter; left time: 44.3085s
Updating learning rate to 0.00012140110146301159
Validation loss decreased (0.5766 --> 0.5581).  Saving model state dict ...
Epoch: 2 cost time: 9.857372999191284
Epoch: 2, Steps: 979 | Train Loss: 0.6738983 Vali Loss: 0.5581413 Best vali loss: 0.5581413
	iters: 100, epoch: 3 | loss: 0.4388098
	speed: 0.0388s/iter; left time: 224.3324s
	iters: 200, epoch: 3 | loss: 0.6739236
	speed: 0.0126s/iter; left time: 71.7565s
	iters: 300, epoch: 3 | loss: 0.5278632
	speed: 0.0133s/iter; left time: 74.1182s
	iters: 400, epoch: 3 | loss: 0.9636967
	speed: 0.0120s/iter; left time: 65.4455s
	iters: 500, epoch: 3 | loss: 0.7923733
	speed: 0.0124s/iter; left time: 66.7898s
	iters: 600, epoch: 3 | loss: 0.7585356
	speed: 0.0133s/iter; left time: 70.3231s
	iters: 700, epoch: 3 | loss: 1.2700936
	speed: 0.0126s/iter; left time: 65.3347s
	iters: 800, epoch: 3 | loss: 0.9239523
	speed: 0.0079s/iter; left time: 39.8625s
	iters: 900, epoch: 3 | loss: 0.2946699
	speed: 0.0069s/iter; left time: 34.2270s
Updating learning rate to 9.832969648630095e-05
Validation loss decreased (0.5581 --> 0.5494).  Saving model state dict ...
Epoch: 3 cost time: 11.147238731384277
Epoch: 3, Steps: 979 | Train Loss: 0.7382131 Vali Loss: 0.5494458 Best vali loss: 0.5494458
	iters: 100, epoch: 4 | loss: 0.3391047
	speed: 0.0398s/iter; left time: 190.9095s
	iters: 200, epoch: 4 | loss: 0.5354141
	speed: 0.0113s/iter; left time: 53.0473s
	iters: 300, epoch: 4 | loss: 0.2065427
	speed: 0.0123s/iter; left time: 56.5281s
	iters: 400, epoch: 4 | loss: 0.4084382
	speed: 0.0125s/iter; left time: 56.1681s
	iters: 500, epoch: 4 | loss: 0.8205066
	speed: 0.0125s/iter; left time: 54.9119s
	iters: 600, epoch: 4 | loss: 0.7609317
	speed: 0.0110s/iter; left time: 47.1388s
	iters: 700, epoch: 4 | loss: 1.1606662
	speed: 0.0107s/iter; left time: 44.8947s
	iters: 800, epoch: 4 | loss: 0.4998640
	speed: 0.0117s/iter; left time: 47.7861s
	iters: 900, epoch: 4 | loss: 0.3996373
	speed: 0.0122s/iter; left time: 48.7653s
Updating learning rate to 7.111511875e-05
Epoch: 4 cost time: 11.671279668807983
Epoch: 4, Steps: 979 | Train Loss: 0.5701228 Vali Loss: 0.5813503 Best vali loss: 0.5494458
	iters: 100, epoch: 5 | loss: 0.8621994
	speed: 0.0399s/iter; left time: 152.3648s
	iters: 200, epoch: 5 | loss: 0.7409053
	speed: 0.0111s/iter; left time: 41.2151s
	iters: 300, epoch: 5 | loss: 0.4093410
	speed: 0.0089s/iter; left time: 32.3431s
	iters: 400, epoch: 5 | loss: 0.4516144
	speed: 0.0064s/iter; left time: 22.3558s
	iters: 500, epoch: 5 | loss: 1.0488815
	speed: 0.0069s/iter; left time: 23.5856s
	iters: 600, epoch: 5 | loss: 0.5455918
	speed: 0.0073s/iter; left time: 24.2366s
	iters: 700, epoch: 5 | loss: 0.6465598
	speed: 0.0079s/iter; left time: 25.3540s
	iters: 800, epoch: 5 | loss: 0.4116512
	speed: 0.0080s/iter; left time: 24.8405s
	iters: 900, epoch: 5 | loss: 1.0316418
	speed: 0.0075s/iter; left time: 22.5411s
Updating learning rate to 4.3900541013699053e-05
Epoch: 5 cost time: 8.24359679222107
Epoch: 5, Steps: 979 | Train Loss: 0.6831540 Vali Loss: 0.5691728 Best vali loss: 0.5494458
	iters: 100, epoch: 6 | loss: 0.4509529
	speed: 0.0253s/iter; left time: 71.9203s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.00111869257, 'e_layers': 2, 'learning_rate': 0.001620968523, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4642349
	speed: 0.0121s/iter; left time: 93.4405s
	iters: 200, epoch: 1 | loss: 1.5590904
	speed: 0.0057s/iter; left time: 43.8523s
	iters: 300, epoch: 1 | loss: 0.7527155
	speed: 0.0061s/iter; left time: 45.6087s
	iters: 400, epoch: 1 | loss: 0.6108036
	speed: 0.0061s/iter; left time: 45.4965s
	iters: 500, epoch: 1 | loss: 0.5443854
	speed: 0.0063s/iter; left time: 46.3688s
	iters: 600, epoch: 1 | loss: 0.7535650
	speed: 0.0060s/iter; left time: 43.6074s
	iters: 700, epoch: 1 | loss: 0.4564261
	speed: 0.0055s/iter; left time: 39.5042s
	iters: 800, epoch: 1 | loss: 1.3322303
	speed: 0.0054s/iter; left time: 37.9828s
	iters: 900, epoch: 1 | loss: 0.3455624
	speed: 0.0063s/iter; left time: 43.9351s
Updating learning rate to 0.001620968523
Validation loss decreased (inf --> 0.6091).  Saving model state dict ...
Epoch: 1 cost time: 6.145108222961426
Epoch: 1, Steps: 979 | Train Loss: 0.7576682 Vali Loss: 0.6091429 Best vali loss: 0.6091429
	iters: 100, epoch: 2 | loss: 0.9434246
	speed: 0.0216s/iter; left time: 146.0785s
	iters: 200, epoch: 2 | loss: 1.1291730
	speed: 0.0062s/iter; left time: 41.2458s
	iters: 300, epoch: 2 | loss: 0.9232733
	speed: 0.0051s/iter; left time: 33.3827s
	iters: 400, epoch: 2 | loss: 0.8635595
	speed: 0.0044s/iter; left time: 28.6645s
	iters: 500, epoch: 2 | loss: 0.8905420
	speed: 0.0045s/iter; left time: 28.5391s
	iters: 600, epoch: 2 | loss: 0.7834598
	speed: 0.0065s/iter; left time: 40.4386s
	iters: 700, epoch: 2 | loss: 0.8796152
	speed: 0.0113s/iter; left time: 69.2964s
	iters: 800, epoch: 2 | loss: 0.4663590
	speed: 0.0103s/iter; left time: 62.5335s
	iters: 900, epoch: 2 | loss: 1.1017768
	speed: 0.0110s/iter; left time: 65.2745s
Updating learning rate to 0.0008104842615
Epoch: 2 cost time: 7.460214138031006
Epoch: 2, Steps: 979 | Train Loss: 0.8867981 Vali Loss: 0.6158115 Best vali loss: 0.6091429
	iters: 100, epoch: 3 | loss: 1.7167181
	speed: 0.0553s/iter; left time: 319.4453s
	iters: 200, epoch: 3 | loss: 1.0705156
	speed: 0.0096s/iter; left time: 54.3093s
	iters: 300, epoch: 3 | loss: 0.9808363
	speed: 0.0100s/iter; left time: 55.6886s
	iters: 400, epoch: 3 | loss: 0.8096525
	speed: 0.0099s/iter; left time: 54.2446s
	iters: 500, epoch: 3 | loss: 0.6416594
	speed: 0.0114s/iter; left time: 61.2068s
	iters: 600, epoch: 3 | loss: 0.9229225
	speed: 0.0076s/iter; left time: 40.0242s
	iters: 700, epoch: 3 | loss: 1.3742902
	speed: 0.0036s/iter; left time: 18.6424s
	iters: 800, epoch: 3 | loss: 0.4197519
	speed: 0.0045s/iter; left time: 22.6560s
	iters: 900, epoch: 3 | loss: 0.9998136
	speed: 0.0075s/iter; left time: 37.5160s
Updating learning rate to 0.00040524213075
Validation loss decreased (0.6091 --> 0.6072).  Saving model state dict ...
Epoch: 3 cost time: 8.033994436264038
Epoch: 3, Steps: 979 | Train Loss: 0.9929067 Vali Loss: 0.6072285 Best vali loss: 0.6072285

best validation loss 0.6072285343711434

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0028630346006, 'e_layers': 2, 'learning_rate': 0.002038872325, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0067073
	speed: 0.0154s/iter; left time: 28.7041s
	iters: 200, epoch: 1 | loss: 1.2004594
	speed: 0.0087s/iter; left time: 15.3559s
Updating learning rate to 0.0019612723677356002
Validation loss decreased (inf --> 0.5926).  Saving model state dict ...
Epoch: 1 cost time: 2.465003490447998
Epoch: 1, Steps: 245 | Train Loss: 1.1035833 Vali Loss: 0.5926037 Best vali loss: 0.5926037
	iters: 100, epoch: 2 | loss: 1.0107807
	speed: 0.0173s/iter; left time: 27.9454s
	iters: 200, epoch: 2 | loss: 0.9499908
	speed: 0.0082s/iter; left time: 12.4340s
Updating learning rate to 0.0017402863859905414
Epoch: 2 cost time: 1.9931902885437012
Epoch: 2, Steps: 245 | Train Loss: 0.9803858 Vali Loss: 0.5986118 Best vali loss: 0.5926037
	iters: 100, epoch: 3 | loss: 0.6634876
	speed: 0.0148s/iter; left time: 20.2839s
	iters: 200, epoch: 3 | loss: 0.6534187
	speed: 0.0085s/iter; left time: 10.7567s
Updating learning rate to 0.0014095574922425955
Epoch: 3 cost time: 2.1303186416625977
Epoch: 3, Steps: 245 | Train Loss: 0.6584531 Vali Loss: 0.6346963 Best vali loss: 0.5926037

best validation loss 0.5926036641367163

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0025880614769, 'e_layers': 2, 'learning_rate': 0.0008050296962, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7348447
	speed: 0.0159s/iter; left time: 29.6047s
	iters: 200, epoch: 1 | loss: 0.7617022
	speed: 0.0092s/iter; left time: 16.2587s
Updating learning rate to 0.0008050296962
Validation loss decreased (inf --> 0.5985).  Saving model state dict ...
Epoch: 1 cost time: 2.5677051544189453
Epoch: 1, Steps: 245 | Train Loss: 0.7482735 Vali Loss: 0.5985421 Best vali loss: 0.5985421
	iters: 100, epoch: 2 | loss: 0.6102588
	speed: 0.0173s/iter; left time: 27.9323s
	iters: 200, epoch: 2 | loss: 1.1164814
	speed: 0.0097s/iter; left time: 14.7796s
Updating learning rate to 0.0004025148481
Epoch: 2 cost time: 2.249999523162842
Epoch: 2, Steps: 245 | Train Loss: 0.8633701 Vali Loss: 0.6096238 Best vali loss: 0.5985421
	iters: 100, epoch: 3 | loss: 0.8521258
	speed: 0.0175s/iter; left time: 24.0052s
	iters: 200, epoch: 3 | loss: 1.0045522
	speed: 0.0099s/iter; left time: 12.6385s
Updating learning rate to 0.00020125742405
Epoch: 3 cost time: 2.275195837020874
Epoch: 3, Steps: 245 | Train Loss: 0.9283390 Vali Loss: 0.6084265 Best vali loss: 0.5985421

best validation loss 0.5985420714203598

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0028630346006, 'e_layers': 2, 'learning_rate': 0.002038872325, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9732242
	speed: 0.0194s/iter; left time: 21.8649s
	iters: 200, epoch: 4 | loss: 1.1645248
	speed: 0.0158s/iter; left time: 16.1615s
Updating learning rate to 0.0010194361625
Epoch: 4 cost time: 3.8920605182647705
Epoch: 4, Steps: 245 | Train Loss: 1.0688745 Vali Loss: 0.6541470 Best vali loss: 0.5926037
	iters: 100, epoch: 5 | loss: 0.9084996
	speed: 0.0359s/iter; left time: 31.6340s
	iters: 200, epoch: 5 | loss: 0.8843403
	speed: 0.0085s/iter; left time: 6.6493s
Updating learning rate to 0.0006293148327574047
Epoch: 5 cost time: 2.821722984313965
Epoch: 5, Steps: 245 | Train Loss: 0.8964200 Vali Loss: 0.6723826 Best vali loss: 0.5926037
	iters: 100, epoch: 6 | loss: 0.5552880
	speed: 0.0186s/iter; left time: 11.8413s
	iters: 200, epoch: 6 | loss: 0.5126321
	speed: 0.0086s/iter; left time: 4.5908s
Updating learning rate to 0.00029858593900945887
Epoch: 6 cost time: 2.137904405593872
Epoch: 6, Steps: 245 | Train Loss: 0.5339600 Vali Loss: 0.6641622 Best vali loss: 0.5926037
	iters: 100, epoch: 7 | loss: 0.6539649
	speed: 0.0113s/iter; left time: 4.4174s
	iters: 200, epoch: 7 | loss: 0.7890752
	speed: 0.0050s/iter; left time: 1.4428s
Updating learning rate to 7.759995726439987e-05
Epoch: 7 cost time: 1.282012701034546
Epoch: 7, Steps: 245 | Train Loss: 0.7215200 Vali Loss: 0.6656959 Best vali loss: 0.5926037
	iters: 100, epoch: 8 | loss: 0.5834923
	speed: 0.0106s/iter; left time: 1.5537s
	iters: 200, epoch: 8 | loss: 0.6848614
	speed: 0.0064s/iter; left time: 0.2939s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6184141635894775
Epoch: 8, Steps: 245 | Train Loss: 0.6341769 Vali Loss: 0.6749058 Best vali loss: 0.5926037

best validation loss 0.5926036641367163

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041129782689, 'e_layers': 1, 'learning_rate': 6.6769528e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.422826415731963e-05
Validation loss decreased (inf --> 0.6989).  Saving model state dict ...
Epoch: 1 cost time: 0.6951076984405518
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6988811 Best vali loss: 0.6988811
Updating learning rate to 5.699135701271253e-05
Validation loss decreased (0.6989 --> 0.6851).  Saving model state dict ...
Epoch: 2 cost time: 0.4561936855316162
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6850927 Best vali loss: 0.6850927
Updating learning rate to 4.616056007621849e-05
Validation loss decreased (0.6851 --> 0.6739).  Saving model state dict ...
Epoch: 3 cost time: 0.44235801696777344
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6739166 Best vali loss: 0.6739166
Updating learning rate to 3.3384764e-05
Validation loss decreased (0.6739 --> 0.6659).  Saving model state dict ...
Epoch: 4 cost time: 0.4555637836456299
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6658609 Best vali loss: 0.6658609
Updating learning rate to 2.0608967923781517e-05
Validation loss decreased (0.6659 --> 0.6607).  Saving model state dict ...
Epoch: 5 cost time: 0.43576908111572266
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6607185 Best vali loss: 0.6607185
Updating learning rate to 9.778170987287473e-06
Validation loss decreased (0.6607 --> 0.6577).  Saving model state dict ...
Epoch: 6 cost time: 0.45487070083618164
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6576824 Best vali loss: 0.6576824
Updating learning rate to 2.541263842680365e-06
Validation loss decreased (0.6577 --> 0.6563).  Saving model state dict ...
Epoch: 7 cost time: 0.468822717666626
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6563378 Best vali loss: 0.6563378
Updating learning rate to 0.0
Validation loss decreased (0.6563 --> 0.6560).  Saving model state dict ...
Epoch: 8 cost time: 0.43555545806884766
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6559886 Best vali loss: 0.6559886

best validation loss 0.6559886088088838

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0081331261032, 'e_layers': 3, 'learning_rate': 0.0002596282648, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5629752
	speed: 0.0140s/iter; left time: 107.9024s
	iters: 200, epoch: 1 | loss: 0.4349467
	speed: 0.0078s/iter; left time: 59.2727s
	iters: 300, epoch: 1 | loss: 0.3651178
	speed: 0.0073s/iter; left time: 54.7951s
	iters: 400, epoch: 1 | loss: 0.5677869
	speed: 0.0072s/iter; left time: 53.5854s
	iters: 500, epoch: 1 | loss: 0.5449129
	speed: 0.0079s/iter; left time: 58.1962s
	iters: 600, epoch: 1 | loss: 0.7479922
	speed: 0.0084s/iter; left time: 60.9677s
	iters: 700, epoch: 1 | loss: 1.2493683
	speed: 0.0088s/iter; left time: 63.0627s
	iters: 800, epoch: 1 | loss: 1.3384602
	speed: 0.0086s/iter; left time: 60.7281s
	iters: 900, epoch: 1 | loss: 0.7463752
	speed: 0.0075s/iter; left time: 52.1561s
Updating learning rate to 0.0002497467523550703
Validation loss decreased (inf --> 0.6124).  Saving model state dict ...
Epoch: 1 cost time: 8.14853549003601
Epoch: 1, Steps: 979 | Train Loss: 0.7286595 Vali Loss: 0.6124370 Best vali loss: 0.6124370
	iters: 100, epoch: 2 | loss: 0.6008587
	speed: 0.0261s/iter; left time: 176.2082s
	iters: 200, epoch: 2 | loss: 0.3280748
	speed: 0.0073s/iter; left time: 48.5513s
	iters: 300, epoch: 2 | loss: 0.8383136
	speed: 0.0075s/iter; left time: 49.4574s
	iters: 400, epoch: 2 | loss: 0.7031470
	speed: 0.0071s/iter; left time: 45.9450s
	iters: 500, epoch: 2 | loss: 0.6794009
	speed: 0.0071s/iter; left time: 45.1406s
	iters: 600, epoch: 2 | loss: 1.7771289
	speed: 0.0073s/iter; left time: 45.6111s
	iters: 700, epoch: 2 | loss: 0.9267877
	speed: 0.0074s/iter; left time: 45.6614s
	iters: 800, epoch: 2 | loss: 0.2831467
	speed: 0.0075s/iter; left time: 45.3208s
	iters: 900, epoch: 2 | loss: 0.6976315
	speed: 0.0076s/iter; left time: 45.0357s
Updating learning rate to 0.00022160658571388828
Validation loss decreased (0.6124 --> 0.6051).  Saving model state dict ...
Epoch: 2 cost time: 7.260601997375488
Epoch: 2, Steps: 979 | Train Loss: 0.7593878 Vali Loss: 0.6051313 Best vali loss: 0.6051313
	iters: 100, epoch: 3 | loss: 0.8840520
	speed: 0.0253s/iter; left time: 146.0856s
	iters: 200, epoch: 3 | loss: 0.4213055
	speed: 0.0068s/iter; left time: 38.7355s
	iters: 300, epoch: 3 | loss: 0.3100034
	speed: 0.0070s/iter; left time: 38.9097s
	iters: 400, epoch: 3 | loss: 1.2831912
	speed: 0.0065s/iter; left time: 35.3989s
	iters: 500, epoch: 3 | loss: 0.7695669
	speed: 0.0078s/iter; left time: 41.7182s
	iters: 600, epoch: 3 | loss: 0.9279611
	speed: 0.0087s/iter; left time: 45.6508s
	iters: 700, epoch: 3 | loss: 0.4489478
	speed: 0.0086s/iter; left time: 44.5501s
	iters: 800, epoch: 3 | loss: 0.3018947
	speed: 0.0072s/iter; left time: 36.7894s
	iters: 900, epoch: 3 | loss: 1.0905108
	speed: 0.0084s/iter; left time: 41.9537s
Updating learning rate to 0.00017949185015632822
Validation loss decreased (0.6051 --> 0.5803).  Saving model state dict ...
Epoch: 3 cost time: 7.555613994598389
Epoch: 3, Steps: 979 | Train Loss: 0.7152704 Vali Loss: 0.5803253 Best vali loss: 0.5803253
	iters: 100, epoch: 4 | loss: 1.7403719
	speed: 0.0309s/iter; left time: 148.0315s
	iters: 200, epoch: 4 | loss: 0.5640885
	speed: 0.0086s/iter; left time: 40.2675s
	iters: 300, epoch: 4 | loss: 0.3216784
	speed: 0.0070s/iter; left time: 32.1504s
	iters: 400, epoch: 4 | loss: 1.0983125
	speed: 0.0080s/iter; left time: 35.7497s
	iters: 500, epoch: 4 | loss: 1.0438095
	speed: 0.0084s/iter; left time: 36.8007s
	iters: 600, epoch: 4 | loss: 1.7065980
	speed: 0.0084s/iter; left time: 36.2003s
	iters: 700, epoch: 4 | loss: 0.5384262
	speed: 0.0094s/iter; left time: 39.3084s
	iters: 800, epoch: 4 | loss: 0.4628912
	speed: 0.0091s/iter; left time: 37.3801s
	iters: 900, epoch: 4 | loss: 0.6628066
	speed: 0.0090s/iter; left time: 35.9154s
Updating learning rate to 0.0001298141324
Validation loss decreased (0.5803 --> 0.5564).  Saving model state dict ...
Epoch: 4 cost time: 8.485458374023438
Epoch: 4, Steps: 979 | Train Loss: 0.9043314 Vali Loss: 0.5564277 Best vali loss: 0.5564277
	iters: 100, epoch: 5 | loss: 0.6361793
	speed: 0.0299s/iter; left time: 114.0917s
	iters: 200, epoch: 5 | loss: 0.4484556
	speed: 0.0091s/iter; left time: 33.9992s
	iters: 300, epoch: 5 | loss: 0.9498782
	speed: 0.0086s/iter; left time: 30.9999s
	iters: 400, epoch: 5 | loss: 0.8707805
	speed: 0.0083s/iter; left time: 29.2765s
	iters: 500, epoch: 5 | loss: 0.8952029
	speed: 0.0084s/iter; left time: 28.5565s
	iters: 600, epoch: 5 | loss: 0.6715119
	speed: 0.0086s/iter; left time: 28.5568s
	iters: 700, epoch: 5 | loss: 1.1256853
	speed: 0.0092s/iter; left time: 29.4761s
	iters: 800, epoch: 5 | loss: 0.6904204
	speed: 0.0094s/iter; left time: 29.1791s
	iters: 900, epoch: 5 | loss: 0.2797624
	speed: 0.0090s/iter; left time: 27.0199s
Updating learning rate to 8.01364146436718e-05
Epoch: 5 cost time: 8.717000484466553
Epoch: 5, Steps: 979 | Train Loss: 0.7297641 Vali Loss: 0.5578727 Best vali loss: 0.5564277
	iters: 100, epoch: 6 | loss: 0.5418316
	speed: 0.0321s/iter; left time: 91.0174s
	iters: 200, epoch: 6 | loss: 1.0325310
	speed: 0.0092s/iter; left time: 25.2181s
	iters: 300, epoch: 6 | loss: 0.7492287
	speed: 0.0091s/iter; left time: 24.0581s
	iters: 400, epoch: 6 | loss: 0.4026026
	speed: 0.0076s/iter; left time: 19.3719s
	iters: 500, epoch: 6 | loss: 0.4626156
	speed: 0.0107s/iter; left time: 26.1801s
	iters: 600, epoch: 6 | loss: 0.6063296
	speed: 0.0129s/iter; left time: 30.1393s
	iters: 700, epoch: 6 | loss: 1.2295094
	speed: 0.0097s/iter; left time: 21.7147s
	iters: 800, epoch: 6 | loss: 0.5904880
	speed: 0.0097s/iter; left time: 20.7074s
	iters: 900, epoch: 6 | loss: 0.4185765
	speed: 0.0085s/iter; left time: 17.3070s
Updating learning rate to 3.80216790861117e-05
Validation loss decreased (0.5564 --> 0.5557).  Saving model state dict ...
Epoch: 6 cost time: 9.399603366851807
Epoch: 6, Steps: 979 | Train Loss: 0.6704125 Vali Loss: 0.5557307 Best vali loss: 0.5557307
	iters: 100, epoch: 7 | loss: 0.5429915
	speed: 0.0278s/iter; left time: 51.6187s
	iters: 200, epoch: 7 | loss: 1.2945709
	speed: 0.0070s/iter; left time: 12.3542s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020104155457, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3300363
	speed: 0.0104s/iter; left time: 19.3995s
	iters: 200, epoch: 1 | loss: 0.9196182
	speed: 0.0038s/iter; left time: 6.6436s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.6344).  Saving model state dict ...
Epoch: 1 cost time: 1.3612143993377686
Epoch: 1, Steps: 245 | Train Loss: 1.1248273 Vali Loss: 0.6343527 Best vali loss: 0.6343527
	iters: 100, epoch: 2 | loss: 0.8715005
	speed: 0.0160s/iter; left time: 25.9018s
	iters: 200, epoch: 2 | loss: 0.7228904
	speed: 0.0092s/iter; left time: 13.9617s
Updating learning rate to 0.0002612410192867383
Validation loss decreased (0.6344 --> 0.6139).  Saving model state dict ...
Epoch: 2 cost time: 2.084336280822754
Epoch: 2, Steps: 245 | Train Loss: 0.7971954 Vali Loss: 0.6139050 Best vali loss: 0.6139050
	iters: 100, epoch: 3 | loss: 0.6959416
	speed: 0.0178s/iter; left time: 24.3614s
	iters: 200, epoch: 3 | loss: 0.4362039
	speed: 0.0052s/iter; left time: 6.5961s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.619091510772705
Epoch: 3, Steps: 245 | Train Loss: 0.5660728 Vali Loss: 0.6283658 Best vali loss: 0.6139050

best validation loss 0.6139050069532699

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0009333650974, 'e_layers': 1, 'learning_rate': 0.0001326193565, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001326193565
Validation loss decreased (inf --> 0.6964).  Saving model state dict ...
Epoch: 1 cost time: 0.9900026321411133
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6964103 Best vali loss: 0.6964103
Updating learning rate to 6.630967825e-05
Validation loss decreased (0.6964 --> 0.6796).  Saving model state dict ...
Epoch: 2 cost time: 0.7736773490905762
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6795980 Best vali loss: 0.6795980
Updating learning rate to 3.3154839125e-05
Validation loss decreased (0.6796 --> 0.6721).  Saving model state dict ...
Epoch: 3 cost time: 0.8231720924377441
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6720631 Best vali loss: 0.6720631

best validation loss 0.6720631139965755

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016936034194, 'e_layers': 3, 'learning_rate': 0.0035832659824, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0034468860415416544
Validation loss decreased (inf --> 0.6892).  Saving model state dict ...
Epoch: 1 cost time: 1.4958949089050293
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6891506 Best vali loss: 0.6891506
Updating learning rate to 0.003058508828675058
Validation loss decreased (0.6892 --> 0.6417).  Saving model state dict ...
Epoch: 2 cost time: 1.1933467388153076
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6417487 Best vali loss: 0.6417487
Updating learning rate to 0.0024772612538109485
Epoch: 3 cost time: 1.1796491146087646
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6523322 Best vali loss: 0.6417487

best validation loss 0.6417487497023

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020104155457, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0143801
	speed: 0.0102s/iter; left time: 11.4969s
	iters: 200, epoch: 4 | loss: 0.7255830
	speed: 0.0037s/iter; left time: 3.8340s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 1.2392451763153076
Epoch: 4, Steps: 245 | Train Loss: 0.8699815 Vali Loss: 0.6686655 Best vali loss: 0.6139050
	iters: 100, epoch: 5 | loss: 0.7680368
	speed: 0.0090s/iter; left time: 7.8905s
	iters: 200, epoch: 5 | loss: 0.5323614
	speed: 0.0059s/iter; left time: 4.5716s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 1.32334303855896
Epoch: 5, Steps: 245 | Train Loss: 0.6501991 Vali Loss: 0.6515782 Best vali loss: 0.6139050
	iters: 100, epoch: 6 | loss: 0.6436436
	speed: 0.0126s/iter; left time: 8.0296s
	iters: 200, epoch: 6 | loss: 0.4020689
	speed: 0.0054s/iter; left time: 2.8768s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 1.4352693557739258
Epoch: 6, Steps: 245 | Train Loss: 0.5228563 Vali Loss: 0.6672041 Best vali loss: 0.6139050
	iters: 100, epoch: 7 | loss: 0.7575468
	speed: 0.0125s/iter; left time: 4.9002s
	iters: 200, epoch: 7 | loss: 0.5516111
	speed: 0.0065s/iter; left time: 1.8980s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 1.5674304962158203
Epoch: 7, Steps: 245 | Train Loss: 0.6545790 Vali Loss: 0.6578614 Best vali loss: 0.6139050
	iters: 100, epoch: 8 | loss: 0.5792292
	speed: 0.0161s/iter; left time: 2.3540s
	iters: 200, epoch: 8 | loss: 0.8648267
	speed: 0.0062s/iter; left time: 0.2830s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.831254482269287
Epoch: 8, Steps: 245 | Train Loss: 0.7220280 Vali Loss: 0.6558558 Best vali loss: 0.6139050

best validation loss 0.6139050069532699

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0074460408096, 'e_layers': 3, 'learning_rate': 0.0027349231343, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3855955
	speed: 0.0151s/iter; left time: 57.7597s
	iters: 200, epoch: 1 | loss: 1.3329471
	speed: 0.0099s/iter; left time: 36.6743s
	iters: 300, epoch: 1 | loss: 0.8909491
	speed: 0.0083s/iter; left time: 30.0280s
	iters: 400, epoch: 1 | loss: 0.9306673
	speed: 0.0080s/iter; left time: 28.2505s
Updating learning rate to 0.0027349231343
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 4.60661768913269
Epoch: 1, Steps: 490 | Train Loss: 0.8850397 Vali Loss: 0.6041443 Best vali loss: 0.6041443
	iters: 100, epoch: 2 | loss: 0.8619640
	speed: 0.0237s/iter; left time: 78.7953s
	iters: 200, epoch: 2 | loss: 0.4142091
	speed: 0.0102s/iter; left time: 33.1084s
	iters: 300, epoch: 2 | loss: 0.9826623
	speed: 0.0084s/iter; left time: 26.2147s
	iters: 400, epoch: 2 | loss: 0.8513453
	speed: 0.0084s/iter; left time: 25.4957s
Updating learning rate to 0.00136746156715
Epoch: 2 cost time: 4.380544900894165
Epoch: 2, Steps: 490 | Train Loss: 0.7775452 Vali Loss: 0.6352425 Best vali loss: 0.6041443
	iters: 100, epoch: 3 | loss: 0.9652545
	speed: 0.0227s/iter; left time: 64.6281s
	iters: 200, epoch: 3 | loss: 0.6053535
	speed: 0.0108s/iter; left time: 29.5701s
	iters: 300, epoch: 3 | loss: 0.7619984
	speed: 0.0086s/iter; left time: 22.6513s
	iters: 400, epoch: 3 | loss: 0.8558789
	speed: 0.0082s/iter; left time: 20.9429s
Updating learning rate to 0.000683730783575
Epoch: 3 cost time: 4.390817642211914
Epoch: 3, Steps: 490 | Train Loss: 0.7971213 Vali Loss: 0.6146899 Best vali loss: 0.6041443
	iters: 100, epoch: 4 | loss: 1.1130079
	speed: 0.0233s/iter; left time: 54.6723s
	iters: 200, epoch: 4 | loss: 0.9300572
	speed: 0.0108s/iter; left time: 24.2629s
	iters: 300, epoch: 4 | loss: 1.5698489
	speed: 0.0083s/iter; left time: 17.8976s
	iters: 400, epoch: 4 | loss: 0.7546852
	speed: 0.0084s/iter; left time: 17.1886s
Updating learning rate to 0.0003418653917875
Epoch: 4 cost time: 4.399289131164551
Epoch: 4, Steps: 490 | Train Loss: 1.0918998 Vali Loss: 0.6164935 Best vali loss: 0.6041443
	iters: 100, epoch: 5 | loss: 0.4525098
	speed: 0.0229s/iter; left time: 42.6210s
	iters: 200, epoch: 5 | loss: 0.3339342
	speed: 0.0095s/iter; left time: 16.7768s
	iters: 300, epoch: 5 | loss: 0.5362804
	speed: 0.0090s/iter; left time: 14.8766s
	iters: 400, epoch: 5 | loss: 1.0520589
	speed: 0.0081s/iter; left time: 12.7031s
Updating learning rate to 0.00017093269589375
Epoch: 5 cost time: 4.27032208442688
Epoch: 5, Steps: 490 | Train Loss: 0.5936958 Vali Loss: 0.6393099 Best vali loss: 0.6041443
	iters: 100, epoch: 6 | loss: 1.1574844
	speed: 0.0224s/iter; left time: 30.6963s
	iters: 200, epoch: 6 | loss: 0.3393291
	speed: 0.0097s/iter; left time: 12.3436s
	iters: 300, epoch: 6 | loss: 0.3156851
	speed: 0.0098s/iter; left time: 11.4541s
	iters: 400, epoch: 6 | loss: 0.5386156
	speed: 0.0087s/iter; left time: 9.3043s
Updating learning rate to 8.5466347946875e-05
Epoch: 6 cost time: 4.514930725097656
Epoch: 6, Steps: 490 | Train Loss: 0.5877786 Vali Loss: 0.6377664 Best vali loss: 0.6041443
	iters: 100, epoch: 7 | loss: 0.9545217
	speed: 0.0238s/iter; left time: 20.9455s
	iters: 200, epoch: 7 | loss: 0.5077130
	speed: 0.0085s/iter; left time: 6.6455s
	iters: 300, epoch: 7 | loss: 0.7675433
	speed: 0.0099s/iter; left time: 6.7479s
	iters: 400, epoch: 7 | loss: 1.0264447
	speed: 0.0061s/iter; left time: 3.5417s
Updating learning rate to 4.27331739734375e-05
Epoch: 7 cost time: 4.044904708862305
Epoch: 7, Steps: 490 | Train Loss: 0.8140557 Vali Loss: 0.6468217 Best vali loss: 0.6041443
	iters: 100, epoch: 8 | loss: 0.4651281
	speed: 0.0203s/iter; left time: 7.9527s
	iters: 200, epoch: 8 | loss: 0.8686743
	speed: 0.0080s/iter; left time: 2.3402s
	iters: 300, epoch: 8 | loss: 0.8985470
	speed: 0.0078s/iter; left time: 1.4862s
	iters: 400, epoch: 8 | loss: 0.5296168
	speed: 0.0077s/iter; left time: 0.6981s
Updating learning rate to 2.136658698671875e-05
Epoch: 8 cost time: 3.74532413482666
Epoch: 8, Steps: 490 | Train Loss: 0.6904915 Vali Loss: 0.6446881 Best vali loss: 0.6041443

best validation loss 0.6041442922616876

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0010150710951, 'e_layers': 1, 'learning_rate': 0.0009798333945, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1010854
	speed: 0.0101s/iter; left time: 77.9164s
	iters: 200, epoch: 1 | loss: 0.3410835
	speed: 0.0041s/iter; left time: 31.2543s
	iters: 300, epoch: 1 | loss: 1.1221195
	speed: 0.0042s/iter; left time: 31.6236s
	iters: 400, epoch: 1 | loss: 0.2702256
	speed: 0.0043s/iter; left time: 31.7381s
	iters: 500, epoch: 1 | loss: 0.7971541
	speed: 0.0042s/iter; left time: 30.4730s
	iters: 600, epoch: 1 | loss: 1.1262829
	speed: 0.0042s/iter; left time: 30.1224s
	iters: 700, epoch: 1 | loss: 1.3738430
	speed: 0.0041s/iter; left time: 29.5716s
	iters: 800, epoch: 1 | loss: 0.9631140
	speed: 0.0043s/iter; left time: 30.0752s
	iters: 900, epoch: 1 | loss: 0.3410685
	speed: 0.0042s/iter; left time: 29.2138s
Updating learning rate to 0.0009425407064748036
Validation loss decreased (inf --> 0.6125).  Saving model state dict ...
Epoch: 1 cost time: 4.417670726776123
Epoch: 1, Steps: 979 | Train Loss: 0.8262196 Vali Loss: 0.6124650 Best vali loss: 0.6124650
	iters: 100, epoch: 2 | loss: 1.2539164
	speed: 0.0160s/iter; left time: 107.9994s
	iters: 200, epoch: 2 | loss: 1.3836695
	speed: 0.0040s/iter; left time: 26.8248s
	iters: 300, epoch: 2 | loss: 0.9471478
	speed: 0.0042s/iter; left time: 27.2273s
	iters: 400, epoch: 2 | loss: 0.6295440
	speed: 0.0043s/iter; left time: 27.8228s
	iters: 500, epoch: 2 | loss: 0.3403127
	speed: 0.0045s/iter; left time: 28.4149s
	iters: 600, epoch: 2 | loss: 1.1895490
	speed: 0.0044s/iter; left time: 27.6860s
	iters: 700, epoch: 2 | loss: 0.8841466
	speed: 0.0043s/iter; left time: 26.3064s
	iters: 800, epoch: 2 | loss: 0.6786212
	speed: 0.0042s/iter; left time: 25.3172s
	iters: 900, epoch: 2 | loss: 0.4996022
	speed: 0.0042s/iter; left time: 24.9736s
Updating learning rate to 0.0008363401160919918
Validation loss decreased (0.6125 --> 0.6063).  Saving model state dict ...
Epoch: 2 cost time: 4.177303791046143
Epoch: 2, Steps: 979 | Train Loss: 0.8673899 Vali Loss: 0.6063022 Best vali loss: 0.6063022
	iters: 100, epoch: 3 | loss: 0.2916524
	speed: 0.0156s/iter; left time: 90.0528s
	iters: 200, epoch: 3 | loss: 0.9599007
	speed: 0.0035s/iter; left time: 19.5825s
	iters: 300, epoch: 3 | loss: 1.2295705
	speed: 0.0033s/iter; left time: 18.4267s
	iters: 400, epoch: 3 | loss: 0.5075657
	speed: 0.0040s/iter; left time: 22.0590s
	iters: 500, epoch: 3 | loss: 0.9841698
	speed: 0.0066s/iter; left time: 35.2972s
	iters: 600, epoch: 3 | loss: 1.0676200
	speed: 0.0057s/iter; left time: 30.1003s
	iters: 700, epoch: 3 | loss: 0.4463425
	speed: 0.0059s/iter; left time: 30.7409s
	iters: 800, epoch: 3 | loss: 0.4531344
	speed: 0.0066s/iter; left time: 33.6814s
	iters: 900, epoch: 3 | loss: 0.6452869
	speed: 0.0066s/iter; left time: 32.8534s
Updating learning rate to 0.0006773997005265986
Epoch: 3 cost time: 5.144605398178101
Epoch: 3, Steps: 979 | Train Loss: 0.7316937 Vali Loss: 0.6265007 Best vali loss: 0.6063022
	iters: 100, epoch: 4 | loss: 0.5962615
	speed: 0.0217s/iter; left time: 103.8693s
	iters: 200, epoch: 4 | loss: 0.5079047
	speed: 0.0044s/iter; left time: 20.6028s
	iters: 300, epoch: 4 | loss: 0.4578993
	speed: 0.0056s/iter; left time: 25.8670s
	iters: 400, epoch: 4 | loss: 0.5874620
	speed: 0.0054s/iter; left time: 24.2827s
	iters: 500, epoch: 4 | loss: 0.3349554
	speed: 0.0048s/iter; left time: 21.2572s
	iters: 600, epoch: 4 | loss: 0.5849440
	speed: 0.0055s/iter; left time: 23.5678s
	iters: 700, epoch: 4 | loss: 0.7577046
	speed: 0.0057s/iter; left time: 23.9558s
	iters: 800, epoch: 4 | loss: 0.2988587
	speed: 0.0060s/iter; left time: 24.6948s
	iters: 900, epoch: 4 | loss: 0.2871374
	speed: 0.0063s/iter; left time: 25.1832s
Updating learning rate to 0.00048991669725
Epoch: 4 cost time: 5.466833114624023
Epoch: 4, Steps: 979 | Train Loss: 0.4903475 Vali Loss: 0.6650501 Best vali loss: 0.6063022
	iters: 100, epoch: 5 | loss: 1.0418304
	speed: 0.0242s/iter; left time: 92.2504s
	iters: 200, epoch: 5 | loss: 0.4198085
	speed: 0.0036s/iter; left time: 13.3089s
	iters: 300, epoch: 5 | loss: 0.5227141
	speed: 0.0036s/iter; left time: 13.1671s
	iters: 400, epoch: 5 | loss: 0.7304930
	speed: 0.0039s/iter; left time: 13.7226s
	iters: 500, epoch: 5 | loss: 0.3476588
	speed: 0.0041s/iter; left time: 14.0409s
	iters: 600, epoch: 5 | loss: 0.8084116
	speed: 0.0040s/iter; left time: 13.2547s
	iters: 700, epoch: 5 | loss: 0.2895043
	speed: 0.0042s/iter; left time: 13.4010s
	iters: 800, epoch: 5 | loss: 0.7174766
	speed: 0.0042s/iter; left time: 13.1831s
	iters: 900, epoch: 5 | loss: 1.0963126
	speed: 0.0042s/iter; left time: 12.7999s
Updating learning rate to 0.0003024336939734015
Epoch: 5 cost time: 4.070448398590088
Epoch: 5, Steps: 979 | Train Loss: 0.6638011 Vali Loss: 0.6949079 Best vali loss: 0.6063022
	iters: 100, epoch: 6 | loss: 0.4754814
	speed: 0.0158s/iter; left time: 44.9424s
	iters: 200, epoch: 6 | loss: 0.3819851
	speed: 0.0042s/iter; left time: 11.5340s
	iters: 300, epoch: 6 | loss: 0.3514441
	speed: 0.0041s/iter; left time: 10.8528s
	iters: 400, epoch: 6 | loss: 1.0228047
	speed: 0.0042s/iter; left time: 10.5441s
	iters: 500, epoch: 6 | loss: 0.5023163
	speed: 0.0041s/iter; left time: 10.0201s
	iters: 600, epoch: 6 | loss: 0.5429889
	speed: 0.0041s/iter; left time: 9.6831s
	iters: 700, epoch: 6 | loss: 0.8361067
	speed: 0.0043s/iter; left time: 9.5938s
	iters: 800, epoch: 6 | loss: 1.1778053
	speed: 0.0042s/iter; left time: 8.9058s
	iters: 900, epoch: 6 | loss: 0.5779117
	speed: 0.0042s/iter; left time: 8.5368s
Updating learning rate to 0.00014349327840800823
Epoch: 6 cost time: 4.125063419342041
Epoch: 6, Steps: 979 | Train Loss: 0.6520938 Vali Loss: 0.6804792 Best vali loss: 0.6063022
	iters: 100, epoch: 7 | loss: 0.8936606
	speed: 0.0158s/iter; left time: 29.3956s
	iters: 200, epoch: 7 | loss: 1.9753550
	speed: 0.0035s/iter; left time: 6.2322s
	iters: 300, epoch: 7 | loss: 0.3859624
	speed: 0.0037s/iter; left time: 6.0974s
	iters: 400, epoch: 7 | loss: 0.2603719
	speed: 0.0038s/iter; left time: 5.9616s
	iters: 500, epoch: 7 | loss: 0.3612645
	speed: 0.0041s/iter; left time: 5.9611s
	iters: 600, epoch: 7 | loss: 0.3953598
	speed: 0.0040s/iter; left time: 5.4856s
	iters: 700, epoch: 7 | loss: 0.2438345
	speed: 0.0044s/iter; left time: 5.5677s
	iters: 800, epoch: 7 | loss: 1.1492680
	speed: 0.0045s/iter; left time: 5.2003s
	iters: 900, epoch: 7 | loss: 0.6890742
	speed: 0.0042s/iter; left time: 4.4540s
Updating learning rate to 3.72926880251964e-05
Epoch: 7 cost time: 3.959254026412964
Epoch: 7, Steps: 979 | Train Loss: 0.7060168 Vali Loss: 0.7030163 Best vali loss: 0.6063022
	iters: 100, epoch: 8 | loss: 0.3522415
	speed: 0.0170s/iter; left time: 14.9412s
	iters: 200, epoch: 8 | loss: 0.8515702
	speed: 0.0041s/iter; left time: 3.1957s
	iters: 300, epoch: 8 | loss: 1.3450729
	speed: 0.0040s/iter; left time: 2.7376s
	iters: 400, epoch: 8 | loss: 0.2478384
	speed: 0.0038s/iter; left time: 2.2268s
	iters: 500, epoch: 8 | loss: 0.2242688
	speed: 0.0037s/iter; left time: 1.7956s
	iters: 600, epoch: 8 | loss: 0.4812345
	speed: 0.0036s/iter; left time: 1.3523s
	iters: 700, epoch: 8 | loss: 1.0447867
	speed: 0.0038s/iter; left time: 1.0521s
	iters: 800, epoch: 8 | loss: 0.6483580
	speed: 0.0061s/iter; left time: 1.0971s
	iters: 900, epoch: 8 | loss: 0.6588792
	speed: 0.0059s/iter; left time: 0.4754s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.485269069671631
Epoch: 8, Steps: 979 | Train Loss: 0.6504722 Vali Loss: 0.6986433 Best vali loss: 0.6063022

best validation loss 0.6063021815440987

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0099942109668, 'e_layers': 3, 'learning_rate': 0.000143598518, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9369248
	speed: 0.0164s/iter; left time: 14.4778s
Updating learning rate to 0.0001381331248395768
Validation loss decreased (inf --> 0.6473).  Saving model state dict ...
Epoch: 1 cost time: 1.5023114681243896
Epoch: 1, Steps: 123 | Train Loss: 0.9369248 Vali Loss: 0.6472806 Best vali loss: 0.6472806
	iters: 100, epoch: 2 | loss: 0.8802975
	speed: 0.0122s/iter; left time: 9.2966s
Updating learning rate to 0.00012256900192306926
Validation loss decreased (0.6473 --> 0.6217).  Saving model state dict ...
Epoch: 2 cost time: 1.1163392066955566
Epoch: 2, Steps: 123 | Train Loss: 0.8802975 Vali Loss: 0.6217445 Best vali loss: 0.6217445
	iters: 100, epoch: 3 | loss: 0.8654547
	speed: 0.0167s/iter; left time: 10.6883s
Updating learning rate to 9.927564587539008e-05
Validation loss decreased (0.6217 --> 0.6158).  Saving model state dict ...
Epoch: 3 cost time: 1.4074122905731201
Epoch: 3, Steps: 123 | Train Loss: 0.8654547 Vali Loss: 0.6158203 Best vali loss: 0.6158203

best validation loss 0.6158202801353123

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0028532417254, 'e_layers': 4, 'learning_rate': 0.0002361700896, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002361700896
Validation loss decreased (inf --> 0.6169).  Saving model state dict ...
Epoch: 1 cost time: 0.992509126663208
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6168622 Best vali loss: 0.6168622
Updating learning rate to 0.0001180850448
Validation loss decreased (0.6169 --> 0.6121).  Saving model state dict ...
Epoch: 2 cost time: 0.8002631664276123
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6120727 Best vali loss: 0.6120727
Updating learning rate to 5.90425224e-05
Validation loss decreased (0.6121 --> 0.6019).  Saving model state dict ...
Epoch: 3 cost time: 0.9065401554107666
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6018611 Best vali loss: 0.6018611

best validation loss 0.6018611187738492

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0047944010131, 'e_layers': 1, 'learning_rate': 0.0014991040224, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7362238
	speed: 0.0110s/iter; left time: 9.7222s
Updating learning rate to 0.0014420477729003508
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 0.896643877029419
Epoch: 1, Steps: 123 | Train Loss: 0.7362238 Vali Loss: 0.6170977 Best vali loss: 0.6170977
	iters: 100, epoch: 2 | loss: 1.0633677
	speed: 0.0129s/iter; left time: 9.8659s
Updating learning rate to 0.001279565321171535
Validation loss decreased (0.6171 --> 0.6149).  Saving model state dict ...
Epoch: 2 cost time: 1.0829081535339355
Epoch: 2, Steps: 123 | Train Loss: 1.0633677 Vali Loss: 0.6148993 Best vali loss: 0.6148993
	iters: 100, epoch: 3 | loss: 0.8164967
	speed: 0.0146s/iter; left time: 9.3461s
Updating learning rate to 0.0010363931475821722
Epoch: 3 cost time: 1.1111626625061035
Epoch: 3, Steps: 123 | Train Loss: 0.8164967 Vali Loss: 0.6205032 Best vali loss: 0.6148993

best validation loss 0.6148993480762692

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0028532417254, 'e_layers': 4, 'learning_rate': 0.0002361700896, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.95212612e-05
Epoch: 4 cost time: 1.0249323844909668
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6032315 Best vali loss: 0.6018611
Updating learning rate to 1.47606306e-05
Validation loss decreased (0.6019 --> 0.6010).  Saving model state dict ...
Epoch: 5 cost time: 0.8074569702148438
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6009598 Best vali loss: 0.6009598
Updating learning rate to 7.3803153e-06
Validation loss decreased (0.6010 --> 0.6007).  Saving model state dict ...
Epoch: 6 cost time: 0.722698450088501
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6007348 Best vali loss: 0.6007348
Updating learning rate to 3.69015765e-06
Validation loss decreased (0.6007 --> 0.6004).  Saving model state dict ...
Epoch: 7 cost time: 0.8186385631561279
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6004440 Best vali loss: 0.6004440
Updating learning rate to 1.845078825e-06
Epoch: 8 cost time: 0.827556848526001
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6005003 Best vali loss: 0.6004440

best validation loss 0.6004439922241853

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0061868976715, 'e_layers': 4, 'learning_rate': 0.0013459980288, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7533715
	speed: 0.0167s/iter; left time: 14.7902s
Updating learning rate to 0.0012947690292044289
Validation loss decreased (inf --> 0.6196).  Saving model state dict ...
Epoch: 1 cost time: 1.7248671054840088
Epoch: 1, Steps: 123 | Train Loss: 0.7533715 Vali Loss: 0.6196168 Best vali loss: 0.6196168
	iters: 100, epoch: 2 | loss: 0.9029307
	speed: 0.0170s/iter; left time: 12.9461s
Updating learning rate to 0.001148881181214103
Validation loss decreased (0.6196 --> 0.6045).  Saving model state dict ...
Epoch: 2 cost time: 1.3709094524383545
Epoch: 2, Steps: 123 | Train Loss: 0.9029307 Vali Loss: 0.6044940 Best vali loss: 0.6044940
	iters: 100, epoch: 3 | loss: 0.7210543
	speed: 0.0158s/iter; left time: 10.1234s
Updating learning rate to 0.0009305445872089146
Validation loss decreased (0.6045 --> 0.6045).  Saving model state dict ...
Epoch: 3 cost time: 1.2589004039764404
Epoch: 3, Steps: 123 | Train Loss: 0.7210543 Vali Loss: 0.6044781 Best vali loss: 0.6044781
	iters: 100, epoch: 4 | loss: 0.7336950
	speed: 0.0160s/iter; left time: 8.2673s
Updating learning rate to 0.0006729990144
Epoch: 4 cost time: 1.3101506233215332
Epoch: 4, Steps: 123 | Train Loss: 0.7336950 Vali Loss: 0.6121189 Best vali loss: 0.6044781
	iters: 100, epoch: 5 | loss: 0.9570217
	speed: 0.0172s/iter; left time: 6.7416s
Updating learning rate to 0.00041545344159108557
Epoch: 5 cost time: 1.3095190525054932
Epoch: 5, Steps: 123 | Train Loss: 0.9570217 Vali Loss: 0.6231000 Best vali loss: 0.6044781
	iters: 100, epoch: 6 | loss: 0.8548056
	speed: 0.0166s/iter; left time: 4.4940s
Updating learning rate to 0.0001971168475858971
Epoch: 6 cost time: 1.2889580726623535
Epoch: 6, Steps: 123 | Train Loss: 0.8548056 Vali Loss: 0.6125892 Best vali loss: 0.6044781
	iters: 100, epoch: 7 | loss: 0.5130988
	speed: 0.0141s/iter; left time: 2.0743s
Updating learning rate to 5.122899959557127e-05
Epoch: 7 cost time: 1.051567554473877
Epoch: 7, Steps: 123 | Train Loss: 0.5130988 Vali Loss: 0.6140193 Best vali loss: 0.6044781
	iters: 100, epoch: 8 | loss: 0.9704092
	speed: 0.0135s/iter; left time: 0.3249s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1069765090942383
Epoch: 8, Steps: 123 | Train Loss: 0.9704092 Vali Loss: 0.6135644 Best vali loss: 0.6044781

best validation loss 0.6044780860781284

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0068963321244, 'e_layers': 2, 'learning_rate': 0.0002633971008, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1246666
	speed: 0.0221s/iter; left time: 84.4253s
	iters: 200, epoch: 1 | loss: 1.0873442
	speed: 0.0170s/iter; left time: 63.4093s
	iters: 300, epoch: 1 | loss: 0.5852649
	speed: 0.0161s/iter; left time: 58.3145s
	iters: 400, epoch: 1 | loss: 0.8786559
	speed: 0.0132s/iter; left time: 46.6191s
Updating learning rate to 0.0002633971008
Validation loss decreased (inf --> 0.6002).  Saving model state dict ...
Epoch: 1 cost time: 7.67698335647583
Epoch: 1, Steps: 490 | Train Loss: 0.9189829 Vali Loss: 0.6002245 Best vali loss: 0.6002245
	iters: 100, epoch: 2 | loss: 0.7134300
	speed: 0.0460s/iter; left time: 153.0704s
	iters: 200, epoch: 2 | loss: 1.0601655
	speed: 0.0172s/iter; left time: 55.6907s
	iters: 300, epoch: 2 | loss: 0.5437722
	speed: 0.0108s/iter; left time: 33.7246s
	iters: 400, epoch: 2 | loss: 1.2778810
	speed: 0.0078s/iter; left time: 23.6681s
Updating learning rate to 0.0001316985504
Epoch: 2 cost time: 5.810813665390015
Epoch: 2, Steps: 490 | Train Loss: 0.8988122 Vali Loss: 0.6020286 Best vali loss: 0.6002245
	iters: 100, epoch: 3 | loss: 0.5925726
	speed: 0.0216s/iter; left time: 61.2467s
	iters: 200, epoch: 3 | loss: 0.7669361
	speed: 0.0102s/iter; left time: 28.0562s
	iters: 300, epoch: 3 | loss: 0.9202278
	speed: 0.0078s/iter; left time: 20.6479s
	iters: 400, epoch: 3 | loss: 0.3040269
	speed: 0.0077s/iter; left time: 19.5854s
Updating learning rate to 6.58492752e-05
Epoch: 3 cost time: 4.071876525878906
Epoch: 3, Steps: 490 | Train Loss: 0.6459409 Vali Loss: 0.6045989 Best vali loss: 0.6002245
	iters: 100, epoch: 4 | loss: 1.1187057
	speed: 0.0217s/iter; left time: 51.1262s
	iters: 200, epoch: 4 | loss: 0.7767028
	speed: 0.0100s/iter; left time: 22.4694s
	iters: 300, epoch: 4 | loss: 0.5161132
	speed: 0.0080s/iter; left time: 17.2163s
	iters: 400, epoch: 4 | loss: 1.0375018
	speed: 0.0078s/iter; left time: 15.9031s
Updating learning rate to 3.29246376e-05
Epoch: 4 cost time: 4.087257623672485
Epoch: 4, Steps: 490 | Train Loss: 0.8622559 Vali Loss: 0.6208806 Best vali loss: 0.6002245
	iters: 100, epoch: 5 | loss: 0.3607906
	speed: 0.0219s/iter; left time: 40.8089s
	iters: 200, epoch: 5 | loss: 0.5561116
	speed: 0.0095s/iter; left time: 16.7573s
	iters: 300, epoch: 5 | loss: 0.9416990
	speed: 0.0078s/iter; left time: 12.9415s
	iters: 400, epoch: 5 | loss: 0.5141565
	speed: 0.0077s/iter; left time: 12.0630s
Updating learning rate to 1.64623188e-05
Epoch: 5 cost time: 4.018781661987305
Epoch: 5, Steps: 490 | Train Loss: 0.5931894 Vali Loss: 0.6281666 Best vali loss: 0.6002245
	iters: 100, epoch: 6 | loss: 0.7461891
	speed: 0.0217s/iter; left time: 29.7224s
	iters: 200, epoch: 6 | loss: 0.8451584
	speed: 0.0100s/iter; left time: 12.7537s
	iters: 300, epoch: 6 | loss: 0.5019822
	speed: 0.0079s/iter; left time: 9.2007s
	iters: 400, epoch: 6 | loss: 0.9881005
	speed: 0.0077s/iter; left time: 8.2962s
Updating learning rate to 8.2311594e-06
Epoch: 6 cost time: 4.099133014678955
Epoch: 6, Steps: 490 | Train Loss: 0.7703575 Vali Loss: 0.6310596 Best vali loss: 0.6002245
	iters: 100, epoch: 7 | loss: 0.7378305
	speed: 0.0219s/iter; left time: 19.3059s
	iters: 200, epoch: 7 | loss: 0.8053893
	speed: 0.0096s/iter; left time: 7.4925s
	iters: 300, epoch: 7 | loss: 1.0530167
	speed: 0.0077s/iter; left time: 5.2634s
	iters: 400, epoch: 7 | loss: 0.6884992
	speed: 0.0079s/iter; left time: 4.5617s
Updating learning rate to 4.1155797e-06
Epoch: 7 cost time: 4.024904727935791
Epoch: 7, Steps: 490 | Train Loss: 0.8211839 Vali Loss: 0.6340925 Best vali loss: 0.6002245
	iters: 100, epoch: 8 | loss: 0.5905834
	speed: 0.0220s/iter; left time: 8.6180s
	iters: 200, epoch: 8 | loss: 1.3463914
	speed: 0.0095s/iter; left time: 2.7645s
	iters: 300, epoch: 8 | loss: 0.4168994
	speed: 0.0054s/iter; left time: 1.0409s
	iters: 400, epoch: 8 | loss: 1.1234133
	speed: 0.0049s/iter; left time: 0.4466s
Updating learning rate to 2.05778985e-06
Epoch: 8 cost time: 3.268057107925415
Epoch: 8, Steps: 490 | Train Loss: 0.8693219 Vali Loss: 0.6370038 Best vali loss: 0.6002245

best validation loss 0.6002245328041317

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0003874306649, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9422132
	speed: 0.0130s/iter; left time: 24.1055s
	iters: 200, epoch: 1 | loss: 0.7765918
	speed: 0.0069s/iter; left time: 12.1602s
Updating learning rate to 0.00037268496323417447
Validation loss decreased (inf --> 0.6258).  Saving model state dict ...
Epoch: 1 cost time: 2.0597949028015137
Epoch: 1, Steps: 245 | Train Loss: 0.8594025 Vali Loss: 0.6258323 Best vali loss: 0.6258323
	iters: 100, epoch: 2 | loss: 0.7972810
	speed: 0.0160s/iter; left time: 25.9164s
	iters: 200, epoch: 2 | loss: 0.6532380
	speed: 0.0064s/iter; left time: 9.6466s
Updating learning rate to 0.00033069275764520146
Validation loss decreased (0.6258 --> 0.6077).  Saving model state dict ...
Epoch: 2 cost time: 1.5975596904754639
Epoch: 2, Steps: 245 | Train Loss: 0.7252595 Vali Loss: 0.6076852 Best vali loss: 0.6076852
	iters: 100, epoch: 3 | loss: 0.9179286
	speed: 0.0083s/iter; left time: 11.4207s
	iters: 200, epoch: 3 | loss: 1.0562835
	speed: 0.0071s/iter; left time: 9.0502s
Updating learning rate to 0.0002678469807737105
Validation loss decreased (0.6077 --> 0.6003).  Saving model state dict ...
Epoch: 3 cost time: 1.4760918617248535
Epoch: 3, Steps: 245 | Train Loss: 0.9871061 Vali Loss: 0.6003435 Best vali loss: 0.6003435

best validation loss 0.6003435104051049

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010380139511, 'e_layers': 3, 'learning_rate': 0.0006489795465, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1970016
	speed: 0.0172s/iter; left time: 65.8198s
	iters: 200, epoch: 1 | loss: 0.8156287
	speed: 0.0107s/iter; left time: 39.6631s
	iters: 300, epoch: 1 | loss: 1.7461293
	speed: 0.0119s/iter; left time: 42.9527s
	iters: 400, epoch: 1 | loss: 0.5746446
	speed: 0.0101s/iter; left time: 35.6036s
Updating learning rate to 0.0006242792332649034
Validation loss decreased (inf --> 0.6588).  Saving model state dict ...
Epoch: 1 cost time: 5.666742563247681
Epoch: 1, Steps: 490 | Train Loss: 1.0833510 Vali Loss: 0.6588458 Best vali loss: 0.6588458
	iters: 100, epoch: 2 | loss: 0.8274181
	speed: 0.0300s/iter; left time: 99.9257s
	iters: 200, epoch: 2 | loss: 0.6156647
	speed: 0.0106s/iter; left time: 34.2769s
	iters: 300, epoch: 2 | loss: 1.2474978
	speed: 0.0126s/iter; left time: 39.3625s
	iters: 400, epoch: 2 | loss: 1.8420398
	speed: 0.0099s/iter; left time: 29.9970s
Updating learning rate to 0.0005539386923407602
Validation loss decreased (0.6588 --> 0.6287).  Saving model state dict ...
Epoch: 2 cost time: 5.3401038646698
Epoch: 2, Steps: 490 | Train Loss: 1.1331551 Vali Loss: 0.6286740 Best vali loss: 0.6286740
	iters: 100, epoch: 3 | loss: 0.8549991
	speed: 0.0294s/iter; left time: 83.6271s
	iters: 200, epoch: 3 | loss: 0.4761985
	speed: 0.0105s/iter; left time: 28.7664s
	iters: 300, epoch: 3 | loss: 1.0234146
	speed: 0.0120s/iter; left time: 31.5701s
	iters: 400, epoch: 3 | loss: 0.6166058
	speed: 0.0072s/iter; left time: 18.2191s
Updating learning rate to 0.00044866663344467976
Epoch: 3 cost time: 4.839855194091797
Epoch: 3, Steps: 490 | Train Loss: 0.7428045 Vali Loss: 0.6296372 Best vali loss: 0.6286740

best validation loss 0.6286739842420593

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020081810667, 'e_layers': 3, 'learning_rate': 9.68867655e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7635512
	speed: 0.0163s/iter; left time: 62.4245s
	iters: 200, epoch: 1 | loss: 1.0412828
	speed: 0.0096s/iter; left time: 35.6978s
	iters: 300, epoch: 1 | loss: 0.9075622
	speed: 0.0116s/iter; left time: 41.9087s
	iters: 400, epoch: 1 | loss: 1.4584546
	speed: 0.0086s/iter; left time: 30.3053s
Updating learning rate to 9.68867655e-05
Validation loss decreased (inf --> 0.6087).  Saving model state dict ...
Epoch: 1 cost time: 5.090304374694824
Epoch: 1, Steps: 490 | Train Loss: 1.0427127 Vali Loss: 0.6086649 Best vali loss: 0.6086649
	iters: 100, epoch: 2 | loss: 1.4932022
	speed: 0.0245s/iter; left time: 81.5338s
	iters: 200, epoch: 2 | loss: 1.1926247
	speed: 0.0090s/iter; left time: 29.0966s
	iters: 300, epoch: 2 | loss: 0.6320836
	speed: 0.0126s/iter; left time: 39.5722s
	iters: 400, epoch: 2 | loss: 0.9319113
	speed: 0.0107s/iter; left time: 32.3162s
Updating learning rate to 4.844338275e-05
Validation loss decreased (0.6087 --> 0.6046).  Saving model state dict ...
Epoch: 2 cost time: 5.179455518722534
Epoch: 2, Steps: 490 | Train Loss: 1.0624555 Vali Loss: 0.6045827 Best vali loss: 0.6045827
	iters: 100, epoch: 3 | loss: 0.8275267
	speed: 0.0290s/iter; left time: 82.2833s
	iters: 200, epoch: 3 | loss: 0.7782833
	speed: 0.0111s/iter; left time: 30.3893s
	iters: 300, epoch: 3 | loss: 0.7221334
	speed: 0.0116s/iter; left time: 30.7315s
	iters: 400, epoch: 3 | loss: 0.6663255
	speed: 0.0101s/iter; left time: 25.7642s
Updating learning rate to 2.4221691375e-05
Validation loss decreased (0.6046 --> 0.6030).  Saving model state dict ...
Epoch: 3 cost time: 5.104193449020386
Epoch: 3, Steps: 490 | Train Loss: 0.7485672 Vali Loss: 0.6030005 Best vali loss: 0.6030005

best validation loss 0.6030004996494363

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0003874306649, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8799756
	speed: 0.0146s/iter; left time: 16.4445s
	iters: 200, epoch: 4 | loss: 0.7239000
	speed: 0.0073s/iter; left time: 7.4394s
Updating learning rate to 0.00019371533245
Validation loss decreased (0.6003 --> 0.5992).  Saving model state dict ...
Epoch: 4 cost time: 2.1553053855895996
Epoch: 4, Steps: 245 | Train Loss: 0.8019378 Vali Loss: 0.5992386 Best vali loss: 0.5992386
	iters: 100, epoch: 5 | loss: 0.7731131
	speed: 0.0142s/iter; left time: 12.4814s
	iters: 200, epoch: 5 | loss: 0.6570795
	speed: 0.0072s/iter; left time: 5.5968s
Updating learning rate to 0.00011958368412628955
Epoch: 5 cost time: 1.8811626434326172
Epoch: 5, Steps: 245 | Train Loss: 0.7150963 Vali Loss: 0.6018500 Best vali loss: 0.5992386
	iters: 100, epoch: 6 | loss: 0.7875314
	speed: 0.0243s/iter; left time: 15.4270s
	iters: 200, epoch: 6 | loss: 1.0422524
	speed: 0.0117s/iter; left time: 6.2932s
Updating learning rate to 5.673790725479855e-05
Epoch: 6 cost time: 2.75610613822937
Epoch: 6, Steps: 245 | Train Loss: 0.9148919 Vali Loss: 0.5998369 Best vali loss: 0.5992386
	iters: 100, epoch: 7 | loss: 1.1322609
	speed: 0.0232s/iter; left time: 9.0894s
	iters: 200, epoch: 7 | loss: 0.8287520
	speed: 0.0107s/iter; left time: 3.1184s
Updating learning rate to 1.4745701665825506e-05
Epoch: 7 cost time: 2.8819358348846436
Epoch: 7, Steps: 245 | Train Loss: 0.9805065 Vali Loss: 0.6005226 Best vali loss: 0.5992386
	iters: 100, epoch: 8 | loss: 0.8978899
	speed: 0.0324s/iter; left time: 4.7347s
	iters: 200, epoch: 8 | loss: 0.6738330
	speed: 0.0085s/iter; left time: 0.3910s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.412875175476074
Epoch: 8, Steps: 245 | Train Loss: 0.7858614 Vali Loss: 0.6006550 Best vali loss: 0.5992386

best validation loss 0.5992386172569113

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009624923866, 'e_layers': 3, 'learning_rate': 0.0001266733621, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0165522
	speed: 0.0173s/iter; left time: 66.0890s
	iters: 200, epoch: 1 | loss: 0.7221238
	speed: 0.0120s/iter; left time: 44.5182s
	iters: 300, epoch: 1 | loss: 0.7085708
	speed: 0.0086s/iter; left time: 31.1134s
	iters: 400, epoch: 1 | loss: 0.6888263
	speed: 0.0099s/iter; left time: 34.6856s
Updating learning rate to 0.00012185214432929046
Validation loss decreased (inf --> 0.6073).  Saving model state dict ...
Epoch: 1 cost time: 5.5594422817230225
Epoch: 1, Steps: 490 | Train Loss: 0.7840183 Vali Loss: 0.6073210 Best vali loss: 0.6073210
	iters: 100, epoch: 2 | loss: 1.1093795
	speed: 0.0313s/iter; left time: 104.4108s
	iters: 200, epoch: 2 | loss: 1.3481464
	speed: 0.0124s/iter; left time: 40.1971s
	iters: 300, epoch: 2 | loss: 0.5128006
	speed: 0.0116s/iter; left time: 36.1700s
	iters: 400, epoch: 2 | loss: 0.5509238
	speed: 0.0115s/iter; left time: 34.9074s
Updating learning rate to 0.0001081224777183045
Validation loss decreased (0.6073 --> 0.5529).  Saving model state dict ...
Epoch: 2 cost time: 5.731788873672485
Epoch: 2, Steps: 490 | Train Loss: 0.8803126 Vali Loss: 0.5529391 Best vali loss: 0.5529391
	iters: 100, epoch: 3 | loss: 0.7132369
	speed: 0.0299s/iter; left time: 84.9598s
	iters: 200, epoch: 3 | loss: 0.7523706
	speed: 0.0130s/iter; left time: 35.4969s
	iters: 300, epoch: 3 | loss: 0.5941253
	speed: 0.0075s/iter; left time: 19.7541s
	iters: 400, epoch: 3 | loss: 0.7752000
	speed: 0.0101s/iter; left time: 25.6388s
Updating learning rate to 8.757457954882694e-05
Epoch: 3 cost time: 5.00509786605835
Epoch: 3, Steps: 490 | Train Loss: 0.7087332 Vali Loss: 0.5615769 Best vali loss: 0.5529391
	iters: 100, epoch: 4 | loss: 0.7747163
	speed: 0.0278s/iter; left time: 65.3246s
	iters: 200, epoch: 4 | loss: 0.3495440
	speed: 0.0110s/iter; left time: 24.8497s
	iters: 300, epoch: 4 | loss: 0.5596664
	speed: 0.0114s/iter; left time: 24.5784s
	iters: 400, epoch: 4 | loss: 0.8143935
	speed: 0.0108s/iter; left time: 22.0815s
Updating learning rate to 6.333668105e-05
Epoch: 4 cost time: 5.177361488342285
Epoch: 4, Steps: 490 | Train Loss: 0.6245800 Vali Loss: 0.5704978 Best vali loss: 0.5529391
	iters: 100, epoch: 5 | loss: 0.9237698
	speed: 0.0227s/iter; left time: 42.2939s
	iters: 200, epoch: 5 | loss: 0.6592872
	speed: 0.0084s/iter; left time: 14.8182s
	iters: 300, epoch: 5 | loss: 0.7131996
	speed: 0.0093s/iter; left time: 15.4078s
	iters: 400, epoch: 5 | loss: 1.4452932
	speed: 0.0100s/iter; left time: 15.5437s
Updating learning rate to 3.909878255117306e-05
Epoch: 5 cost time: 4.419968605041504
Epoch: 5, Steps: 490 | Train Loss: 0.9353874 Vali Loss: 0.5690521 Best vali loss: 0.5529391
	iters: 100, epoch: 6 | loss: 0.4336326
	speed: 0.0224s/iter; left time: 30.6774s
	iters: 200, epoch: 6 | loss: 0.6573084
	speed: 0.0097s/iter; left time: 12.3399s
	iters: 300, epoch: 6 | loss: 0.4768431
	speed: 0.0098s/iter; left time: 11.5303s
	iters: 400, epoch: 6 | loss: 0.4949667
	speed: 0.0114s/iter; left time: 12.2511s
Updating learning rate to 1.85508843816955e-05
Epoch: 6 cost time: 4.803248882293701
Epoch: 6, Steps: 490 | Train Loss: 0.5156877 Vali Loss: 0.5633435 Best vali loss: 0.5529391
	iters: 100, epoch: 7 | loss: 0.4104525
	speed: 0.0263s/iter; left time: 23.1505s
	iters: 200, epoch: 7 | loss: 0.6474151
	speed: 0.0093s/iter; left time: 7.2695s
	iters: 300, epoch: 7 | loss: 0.5153267
	speed: 0.0094s/iter; left time: 6.4153s
	iters: 400, epoch: 7 | loss: 0.5998732
	speed: 0.0116s/iter; left time: 6.7156s
Updating learning rate to 4.821217770709526e-06
Epoch: 7 cost time: 4.898841381072998
Epoch: 7, Steps: 490 | Train Loss: 0.5432669 Vali Loss: 0.5620391 Best vali loss: 0.5529391
	iters: 100, epoch: 8 | loss: 0.4922034
	speed: 0.0254s/iter; left time: 9.9275s
	iters: 200, epoch: 8 | loss: 1.3346208
	speed: 0.0090s/iter; left time: 2.6260s
	iters: 300, epoch: 8 | loss: 0.6394796
	speed: 0.0097s/iter; left time: 1.8612s
	iters: 400, epoch: 8 | loss: 0.5130248
	speed: 0.0122s/iter; left time: 1.1081s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.87659764289856
Epoch: 8, Steps: 490 | Train Loss: 0.7448321 Vali Loss: 0.5577184 Best vali loss: 0.5529391

best validation loss 0.5529390515027803

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.003058511047, 'e_layers': 2, 'learning_rate': 0.0003064791207, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8190261
	speed: 0.0153s/iter; left time: 58.3611s
	iters: 200, epoch: 1 | loss: 0.6788058
	speed: 0.0081s/iter; left time: 30.1589s
	iters: 300, epoch: 1 | loss: 0.3953524
	speed: 0.0093s/iter; left time: 33.6977s
	iters: 400, epoch: 1 | loss: 0.8314868
	speed: 0.0104s/iter; left time: 36.5601s
Updating learning rate to 0.0003064791207
Validation loss decreased (inf --> 0.6052).  Saving model state dict ...
Epoch: 1 cost time: 4.766731023788452
Epoch: 1, Steps: 490 | Train Loss: 0.6811678 Vali Loss: 0.6052099 Best vali loss: 0.6052099
	iters: 100, epoch: 2 | loss: 0.6405663
	speed: 0.0239s/iter; left time: 79.4730s
	iters: 200, epoch: 2 | loss: 0.8910708
	speed: 0.0083s/iter; left time: 26.9241s
	iters: 300, epoch: 2 | loss: 0.8379608
	speed: 0.0086s/iter; left time: 26.9844s
	iters: 400, epoch: 2 | loss: 1.3023753
	speed: 0.0095s/iter; left time: 28.8089s
Updating learning rate to 0.00015323956035
Epoch: 2 cost time: 4.619629144668579
Epoch: 2, Steps: 490 | Train Loss: 0.9179933 Vali Loss: 0.6171533 Best vali loss: 0.6052099
	iters: 100, epoch: 3 | loss: 0.8850098
	speed: 0.0294s/iter; left time: 83.5029s
	iters: 200, epoch: 3 | loss: 0.6007337
	speed: 0.0091s/iter; left time: 25.0752s
	iters: 300, epoch: 3 | loss: 1.3688495
	speed: 0.0088s/iter; left time: 23.2064s
	iters: 400, epoch: 3 | loss: 1.0321587
	speed: 0.0085s/iter; left time: 21.5620s
Updating learning rate to 7.6619780175e-05
Epoch: 3 cost time: 4.424832820892334
Epoch: 3, Steps: 490 | Train Loss: 0.9716879 Vali Loss: 0.6239687 Best vali loss: 0.6052099
	iters: 100, epoch: 4 | loss: 0.7741320
	speed: 0.0293s/iter; left time: 68.9931s
	iters: 200, epoch: 4 | loss: 0.9794776
	speed: 0.0087s/iter; left time: 19.6022s
	iters: 300, epoch: 4 | loss: 0.4886757
	speed: 0.0099s/iter; left time: 21.2550s
	iters: 400, epoch: 4 | loss: 0.3635700
	speed: 0.0099s/iter; left time: 20.3306s
Updating learning rate to 3.83098900875e-05
Validation loss decreased (0.6052 --> 0.5899).  Saving model state dict ...
Epoch: 4 cost time: 4.553531885147095
Epoch: 4, Steps: 490 | Train Loss: 0.6514638 Vali Loss: 0.5899209 Best vali loss: 0.5899209
	iters: 100, epoch: 5 | loss: 0.3438024
	speed: 0.0272s/iter; left time: 50.6391s
	iters: 200, epoch: 5 | loss: 0.7468305
	speed: 0.0110s/iter; left time: 19.3476s
	iters: 300, epoch: 5 | loss: 0.8200077
	speed: 0.0098s/iter; left time: 16.2458s
	iters: 400, epoch: 5 | loss: 0.6855286
	speed: 0.0098s/iter; left time: 15.3634s
Updating learning rate to 1.915494504375e-05
Validation loss decreased (0.5899 --> 0.5790).  Saving model state dict ...
Epoch: 5 cost time: 4.955258369445801
Epoch: 5, Steps: 490 | Train Loss: 0.6490423 Vali Loss: 0.5790258 Best vali loss: 0.5790258
	iters: 100, epoch: 6 | loss: 0.7243328
	speed: 0.0264s/iter; left time: 36.2196s
	iters: 200, epoch: 6 | loss: 0.3510775
	speed: 0.0114s/iter; left time: 14.4585s
	iters: 300, epoch: 6 | loss: 0.9153633
	speed: 0.0085s/iter; left time: 9.9513s
	iters: 400, epoch: 6 | loss: 0.8897186
	speed: 0.0097s/iter; left time: 10.4415s
Updating learning rate to 9.577472521875e-06
Validation loss decreased (0.5790 --> 0.5759).  Saving model state dict ...
Epoch: 6 cost time: 4.756472587585449
Epoch: 6, Steps: 490 | Train Loss: 0.7201230 Vali Loss: 0.5758584 Best vali loss: 0.5758584
	iters: 100, epoch: 7 | loss: 0.5245537
	speed: 0.0278s/iter; left time: 24.4920s
	iters: 200, epoch: 7 | loss: 0.6754414
	speed: 0.0119s/iter; left time: 9.3008s
	iters: 300, epoch: 7 | loss: 0.5188326
	speed: 0.0096s/iter; left time: 6.5283s
	iters: 400, epoch: 7 | loss: 0.6283558
	speed: 0.0096s/iter; left time: 5.5933s
Updating learning rate to 4.7887362609375e-06
Validation loss decreased (0.5759 --> 0.5747).  Saving model state dict ...
Epoch: 7 cost time: 4.943238019943237
Epoch: 7, Steps: 490 | Train Loss: 0.5867959 Vali Loss: 0.5746590 Best vali loss: 0.5746590
	iters: 100, epoch: 8 | loss: 0.6254933
	speed: 0.0269s/iter; left time: 10.5167s
	iters: 200, epoch: 8 | loss: 0.9207319
	speed: 0.0115s/iter; left time: 3.3394s
	iters: 300, epoch: 8 | loss: 0.8429282
	speed: 0.0105s/iter; left time: 1.9965s
	iters: 400, epoch: 8 | loss: 0.7910134
	speed: 0.0096s/iter; left time: 0.8713s
Updating learning rate to 2.39436813046875e-06
Epoch: 8 cost time: 5.082287311553955
Epoch: 8, Steps: 490 | Train Loss: 0.7950417 Vali Loss: 0.5763690 Best vali loss: 0.5746590

best validation loss 0.5746590092964384

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0049649181558, 'e_layers': 4, 'learning_rate': 0.0002370731574, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002370731574
Validation loss decreased (inf --> 0.6003).  Saving model state dict ...
Epoch: 1 cost time: 1.933492660522461
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6003036 Best vali loss: 0.6003036
Updating learning rate to 0.0001185365787
Validation loss decreased (0.6003 --> 0.5891).  Saving model state dict ...
Epoch: 2 cost time: 1.6167795658111572
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5890872 Best vali loss: 0.5890872
Updating learning rate to 5.926828935e-05
Validation loss decreased (0.5891 --> 0.5609).  Saving model state dict ...
Epoch: 3 cost time: 1.625364065170288
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5609040 Best vali loss: 0.5609040

best validation loss 0.5609039968773482

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0017158468584, 'e_layers': 1, 'learning_rate': 0.0001815841717, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4481019
	speed: 0.0166s/iter; left time: 63.3479s
	iters: 200, epoch: 1 | loss: 0.4825151
	speed: 0.0079s/iter; left time: 29.2492s
	iters: 300, epoch: 1 | loss: 1.0152034
	speed: 0.0076s/iter; left time: 27.6119s
	iters: 400, epoch: 1 | loss: 0.8795015
	speed: 0.0083s/iter; left time: 29.0519s
Updating learning rate to 0.0001815841717
Validation loss decreased (inf --> 0.6362).  Saving model state dict ...
Epoch: 1 cost time: 4.459560394287109
Epoch: 1, Steps: 490 | Train Loss: 0.9563305 Vali Loss: 0.6362020 Best vali loss: 0.6362020
	iters: 100, epoch: 2 | loss: 1.1859269
	speed: 0.0235s/iter; left time: 78.3201s
	iters: 200, epoch: 2 | loss: 1.1993117
	speed: 0.0086s/iter; left time: 27.6932s
	iters: 300, epoch: 2 | loss: 1.4843339
	speed: 0.0070s/iter; left time: 22.0332s
	iters: 400, epoch: 2 | loss: 0.3312107
	speed: 0.0065s/iter; left time: 19.7657s
Updating learning rate to 9.079208585e-05
Validation loss decreased (0.6362 --> 0.6163).  Saving model state dict ...
Epoch: 2 cost time: 3.693535089492798
Epoch: 2, Steps: 490 | Train Loss: 1.0501958 Vali Loss: 0.6162843 Best vali loss: 0.6162843
	iters: 100, epoch: 3 | loss: 0.7274610
	speed: 0.0212s/iter; left time: 60.1497s
	iters: 200, epoch: 3 | loss: 0.7953848
	speed: 0.0072s/iter; left time: 19.7215s
	iters: 300, epoch: 3 | loss: 1.2734270
	speed: 0.0078s/iter; left time: 20.5929s
	iters: 400, epoch: 3 | loss: 0.5173437
	speed: 0.0070s/iter; left time: 17.7029s
Updating learning rate to 4.5396042925e-05
Validation loss decreased (0.6163 --> 0.6098).  Saving model state dict ...
Epoch: 3 cost time: 3.335463047027588
Epoch: 3, Steps: 490 | Train Loss: 0.8284041 Vali Loss: 0.6098065 Best vali loss: 0.6098065

best validation loss 0.6098064535583185

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0049912964393, 'e_layers': 1, 'learning_rate': 0.0001181631268, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8202553
	speed: 0.0148s/iter; left time: 13.1045s
Updating learning rate to 0.0001181631268
Validation loss decreased (inf --> 0.6879).  Saving model state dict ...
Epoch: 1 cost time: 1.3822901248931885
Epoch: 1, Steps: 123 | Train Loss: 0.8202553 Vali Loss: 0.6878730 Best vali loss: 0.6878730
	iters: 100, epoch: 2 | loss: 1.1487138
	speed: 0.0157s/iter; left time: 11.9557s
Updating learning rate to 5.90815634e-05
Validation loss decreased (0.6879 --> 0.6657).  Saving model state dict ...
Epoch: 2 cost time: 1.3258309364318848
Epoch: 2, Steps: 123 | Train Loss: 1.1487138 Vali Loss: 0.6657121 Best vali loss: 0.6657121
	iters: 100, epoch: 3 | loss: 0.7826535
	speed: 0.0227s/iter; left time: 14.4910s
Updating learning rate to 2.95407817e-05
Validation loss decreased (0.6657 --> 0.6567).  Saving model state dict ...
Epoch: 3 cost time: 1.5620362758636475
Epoch: 3, Steps: 123 | Train Loss: 0.7826535 Vali Loss: 0.6567477 Best vali loss: 0.6567477

best validation loss 0.6567477038313757

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0049649181558, 'e_layers': 4, 'learning_rate': 0.0002370731574, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.9634144675e-05
Validation loss decreased (0.5609 --> 0.5515).  Saving model state dict ...
Epoch: 4 cost time: 1.8861918449401855
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5515453 Best vali loss: 0.5515453
Updating learning rate to 1.48170723375e-05
Epoch: 5 cost time: 1.3846452236175537
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5527080 Best vali loss: 0.5515453
Updating learning rate to 7.40853616875e-06
Validation loss decreased (0.5515 --> 0.5466).  Saving model state dict ...
Epoch: 6 cost time: 1.8814024925231934
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5465525 Best vali loss: 0.5465525
Updating learning rate to 3.704268084375e-06
Validation loss decreased (0.5466 --> 0.5450).  Saving model state dict ...
Epoch: 7 cost time: 1.74381685256958
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5450313 Best vali loss: 0.5450313
Updating learning rate to 1.8521340421875e-06
Epoch: 8 cost time: 1.2469093799591064
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5462740 Best vali loss: 0.5450313

best validation loss 0.5450313185884246

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009181308581, 'e_layers': 2, 'learning_rate': 0.0006089978534, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8568513
	speed: 0.0241s/iter; left time: 91.8986s
	iters: 200, epoch: 1 | loss: 0.9411594
	speed: 0.0149s/iter; left time: 55.5277s
	iters: 300, epoch: 1 | loss: 0.4388566
	speed: 0.0108s/iter; left time: 39.0080s
	iters: 400, epoch: 1 | loss: 1.3241073
	speed: 0.0125s/iter; left time: 43.8638s
Updating learning rate to 0.0005858192527497845
Validation loss decreased (inf --> 0.6082).  Saving model state dict ...
Epoch: 1 cost time: 7.2647199630737305
Epoch: 1, Steps: 490 | Train Loss: 0.8902437 Vali Loss: 0.6081960 Best vali loss: 0.6081960
	iters: 100, epoch: 2 | loss: 1.0392852
	speed: 0.0341s/iter; left time: 113.6423s
	iters: 200, epoch: 2 | loss: 1.2981988
	speed: 0.0152s/iter; left time: 49.0504s
	iters: 300, epoch: 2 | loss: 1.2977930
	speed: 0.0155s/iter; left time: 48.4320s
	iters: 400, epoch: 2 | loss: 0.4679880
	speed: 0.0149s/iter; left time: 45.3116s
Updating learning rate to 0.0005198121826335955
Validation loss decreased (0.6082 --> 0.5948).  Saving model state dict ...
Epoch: 2 cost time: 7.382387638092041
Epoch: 2, Steps: 490 | Train Loss: 1.0258163 Vali Loss: 0.5947917 Best vali loss: 0.5947917
	iters: 100, epoch: 3 | loss: 1.4913179
	speed: 0.0417s/iter; left time: 118.5560s
	iters: 200, epoch: 3 | loss: 0.7183006
	speed: 0.0141s/iter; left time: 38.6194s
	iters: 300, epoch: 3 | loss: 1.0378724
	speed: 0.0101s/iter; left time: 26.7892s
	iters: 400, epoch: 3 | loss: 0.7349496
	speed: 0.0125s/iter; left time: 31.8529s
Updating learning rate to 0.00042102562112104186
Epoch: 3 cost time: 5.829879999160767
Epoch: 3, Steps: 490 | Train Loss: 0.9956101 Vali Loss: 0.6040842 Best vali loss: 0.5947917
	iters: 100, epoch: 4 | loss: 0.5495907
	speed: 0.0448s/iter; left time: 105.3212s
	iters: 200, epoch: 4 | loss: 0.3513923
	speed: 0.0138s/iter; left time: 30.9628s
	iters: 300, epoch: 4 | loss: 1.5549092
	speed: 0.0109s/iter; left time: 23.4228s
	iters: 400, epoch: 4 | loss: 0.5820485
	speed: 0.0095s/iter; left time: 19.4808s
Updating learning rate to 0.0003044989267
Epoch: 4 cost time: 6.197047233581543
Epoch: 4, Steps: 490 | Train Loss: 0.7594852 Vali Loss: 0.6141211 Best vali loss: 0.5947917
	iters: 100, epoch: 5 | loss: 0.7918593
	speed: 0.0396s/iter; left time: 73.6869s
	iters: 200, epoch: 5 | loss: 1.0076370
	speed: 0.0112s/iter; left time: 19.7090s
	iters: 300, epoch: 5 | loss: 0.7010451
	speed: 0.0204s/iter; left time: 33.9379s
	iters: 400, epoch: 5 | loss: 0.6669949
	speed: 0.0247s/iter; left time: 38.5268s
Updating learning rate to 0.00018797223227895812
Validation loss decreased (0.5948 --> 0.5743).  Saving model state dict ...
Epoch: 5 cost time: 8.902349472045898
Epoch: 5, Steps: 490 | Train Loss: 0.7918841 Vali Loss: 0.5743425 Best vali loss: 0.5743425
	iters: 100, epoch: 6 | loss: 0.8239765
	speed: 0.0782s/iter; left time: 107.2757s
	iters: 200, epoch: 6 | loss: 0.9465578
	speed: 0.0221s/iter; left time: 28.1316s
	iters: 300, epoch: 6 | loss: 0.8170722
	speed: 0.0205s/iter; left time: 23.9793s
	iters: 400, epoch: 6 | loss: 0.4765786
	speed: 0.0200s/iter; left time: 21.4611s
Updating learning rate to 8.918567076640455e-05
Epoch: 6 cost time: 9.64700984954834
Epoch: 6, Steps: 490 | Train Loss: 0.7660463 Vali Loss: 0.5787463 Best vali loss: 0.5743425
	iters: 100, epoch: 7 | loss: 0.6589933
	speed: 0.0420s/iter; left time: 37.0009s
	iters: 200, epoch: 7 | loss: 0.4004406
	speed: 0.0124s/iter; left time: 9.6775s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0114792280081, 'e_layers': 4, 'learning_rate': 0.0045159486331, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9317365
	speed: 0.0162s/iter; left time: 14.3781s
Updating learning rate to 0.0043440705725467064
Validation loss decreased (inf --> 0.6204).  Saving model state dict ...
Epoch: 1 cost time: 1.9197711944580078
Epoch: 1, Steps: 123 | Train Loss: 0.9317365 Vali Loss: 0.6203524 Best vali loss: 0.6203524
	iters: 100, epoch: 2 | loss: 0.8275861
	speed: 0.0401s/iter; left time: 30.5255s
Updating learning rate to 0.003854603267527565
Validation loss decreased (0.6204 --> 0.5961).  Saving model state dict ...
Epoch: 2 cost time: 2.4955925941467285
Epoch: 2, Steps: 123 | Train Loss: 0.8275861 Vali Loss: 0.5961098 Best vali loss: 0.5961098
	iters: 100, epoch: 3 | loss: 1.0159357
	speed: 0.0308s/iter; left time: 19.6930s
Updating learning rate to 0.003122063678199572
Epoch: 3 cost time: 2.4108164310455322
Epoch: 3, Steps: 123 | Train Loss: 1.0159357 Vali Loss: 0.6187721 Best vali loss: 0.5961098
	iters: 100, epoch: 4 | loss: 0.5934521
	speed: 0.0404s/iter; left time: 20.8649s
Updating learning rate to 0.00225797431655
Epoch: 4 cost time: 2.7160913944244385
Epoch: 4, Steps: 123 | Train Loss: 0.5934521 Vali Loss: 0.6041338 Best vali loss: 0.5961098
	iters: 100, epoch: 5 | loss: 0.7042866
	speed: 0.0247s/iter; left time: 9.7063s
Updating learning rate to 0.0013938849549004284
Validation loss decreased (0.5961 --> 0.5898).  Saving model state dict ...
Epoch: 5 cost time: 1.6358752250671387
Epoch: 5, Steps: 123 | Train Loss: 0.7042866 Vali Loss: 0.5898418 Best vali loss: 0.5898418
	iters: 100, epoch: 6 | loss: 0.7833774
	speed: 0.0180s/iter; left time: 4.8661s
Updating learning rate to 0.0006613453655724351
Validation loss decreased (0.5898 --> 0.5867).  Saving model state dict ...
Epoch: 6 cost time: 1.5509796142578125
Epoch: 6, Steps: 123 | Train Loss: 0.7833774 Vali Loss: 0.5866781 Best vali loss: 0.5866781
	iters: 100, epoch: 7 | loss: 0.8041783
	speed: 0.0157s/iter; left time: 2.3099s
Updating learning rate to 0.00017187806055329383
Validation loss decreased (0.5867 --> 0.5843).  Saving model state dict ...
Epoch: 7 cost time: 1.3039085865020752
Epoch: 7, Steps: 123 | Train Loss: 0.8041783 Vali Loss: 0.5842608 Best vali loss: 0.5842608
	iters: 100, epoch: 8 | loss: 0.6640138
	speed: 0.0153s/iter; left time: 0.3660s
Updating learning rate to 0.0
Validation loss decreased (0.5843 --> 0.5836).  Saving model state dict ...
Epoch: 8 cost time: 1.2150554656982422
Epoch: 8, Steps: 123 | Train Loss: 0.6640138 Vali Loss: 0.5836065 Best vali loss: 0.5836065

best validation loss 0.5836065245524208

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0015756290456, 'e_layers': 1, 'learning_rate': 0.0033110827246, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003185062142154823
Validation loss decreased (inf --> 0.6114).  Saving model state dict ...
Epoch: 1 cost time: 0.8766539096832275
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6113783 Best vali loss: 0.6113783
Updating learning rate to 0.002826185886117145
Validation loss decreased (0.6114 --> 0.5883).  Saving model state dict ...
Epoch: 2 cost time: 0.5801253318786621
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5882912 Best vali loss: 0.5882912
Updating learning rate to 0.0022890896132473407
Epoch: 3 cost time: 0.6423671245574951
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6231977 Best vali loss: 0.5882912

best validation loss 0.588291192898757

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0029043411772, 'e_layers': 4, 'learning_rate': 0.0013039113529, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4928070
	speed: 0.0171s/iter; left time: 31.7413s
	iters: 200, epoch: 1 | loss: 0.7415432
	speed: 0.0110s/iter; left time: 19.3389s
Updating learning rate to 0.0013039113529
Validation loss decreased (inf --> 0.5984).  Saving model state dict ...
Epoch: 1 cost time: 2.9038197994232178
Epoch: 1, Steps: 245 | Train Loss: 0.6171751 Vali Loss: 0.5984336 Best vali loss: 0.5984336
	iters: 100, epoch: 2 | loss: 0.9668449
	speed: 0.0204s/iter; left time: 32.8890s
	iters: 200, epoch: 2 | loss: 1.0293021
	speed: 0.0107s/iter; left time: 16.2505s
Updating learning rate to 0.00065195567645
Epoch: 2 cost time: 2.6623315811157227
Epoch: 2, Steps: 245 | Train Loss: 0.9980735 Vali Loss: 0.6092516 Best vali loss: 0.5984336
	iters: 100, epoch: 3 | loss: 0.5150963
	speed: 0.0185s/iter; left time: 25.3588s
	iters: 200, epoch: 3 | loss: 0.8372945
	speed: 0.0151s/iter; left time: 19.1698s
Updating learning rate to 0.000325977838225
Epoch: 3 cost time: 3.2856385707855225
Epoch: 3, Steps: 245 | Train Loss: 0.6761954 Vali Loss: 0.6114483 Best vali loss: 0.5984336

best validation loss 0.5984335838231374

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0104773939528, 'e_layers': 3, 'learning_rate': 7.61018272e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8190612
	speed: 0.0239s/iter; left time: 91.4310s
	iters: 200, epoch: 1 | loss: 0.7033491
	speed: 0.0154s/iter; left time: 57.2356s
	iters: 300, epoch: 1 | loss: 0.6460393
	speed: 0.0143s/iter; left time: 51.8537s
	iters: 400, epoch: 1 | loss: 0.7453125
	speed: 0.0155s/iter; left time: 54.5110s
Updating learning rate to 7.61018272e-05
Validation loss decreased (inf --> 0.6013).  Saving model state dict ...
Epoch: 1 cost time: 7.573912143707275
Epoch: 1, Steps: 490 | Train Loss: 0.7284405 Vali Loss: 0.6012729 Best vali loss: 0.6012729
	iters: 100, epoch: 2 | loss: 0.8326684
	speed: 0.0282s/iter; left time: 93.9990s
	iters: 200, epoch: 2 | loss: 0.8120869
	speed: 0.0112s/iter; left time: 36.1461s
	iters: 300, epoch: 2 | loss: 0.4254277
	speed: 0.0109s/iter; left time: 34.2751s
	iters: 400, epoch: 2 | loss: 1.3227619
	speed: 0.0084s/iter; left time: 25.4911s
Updating learning rate to 3.80509136e-05
Epoch: 2 cost time: 4.761752128601074
Epoch: 2, Steps: 490 | Train Loss: 0.8482362 Vali Loss: 0.6104033 Best vali loss: 0.6012729
	iters: 100, epoch: 3 | loss: 0.7377590
	speed: 0.0247s/iter; left time: 70.0768s
	iters: 200, epoch: 3 | loss: 0.8212513
	speed: 0.0100s/iter; left time: 27.3540s
	iters: 300, epoch: 3 | loss: 0.7280427
	speed: 0.0093s/iter; left time: 24.5160s
	iters: 400, epoch: 3 | loss: 1.0028424
	speed: 0.0092s/iter; left time: 23.3032s
Updating learning rate to 1.90254568e-05
Validation loss decreased (0.6013 --> 0.5947).  Saving model state dict ...
Epoch: 3 cost time: 4.740940570831299
Epoch: 3, Steps: 490 | Train Loss: 0.8224738 Vali Loss: 0.5946966 Best vali loss: 0.5946966

best validation loss 0.5946965534231388

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0015756290456, 'e_layers': 1, 'learning_rate': 0.0033110827246, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0016555413623
Epoch: 4 cost time: 0.9097943305969238
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6385591 Best vali loss: 0.5882912
Updating learning rate to 0.0010219931113526594
Epoch: 5 cost time: 0.6512296199798584
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6488400 Best vali loss: 0.5882912
Updating learning rate to 0.0004848968384828552
Epoch: 6 cost time: 0.44480323791503906
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6497366 Best vali loss: 0.5882912
Updating learning rate to 0.00012602058244517723
Epoch: 7 cost time: 0.5997464656829834
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6585720 Best vali loss: 0.5882912
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5916063785552979
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6606784 Best vali loss: 0.5882912

best validation loss 0.588291192898757

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0074509676079, 'e_layers': 3, 'learning_rate': 0.0002732562098, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9448782
	speed: 0.0157s/iter; left time: 29.1755s
	iters: 200, epoch: 1 | loss: 0.6014507
	speed: 0.0165s/iter; left time: 29.1127s
Updating learning rate to 0.00026285601458291507
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 3.6570041179656982
Epoch: 1, Steps: 245 | Train Loss: 0.7731645 Vali Loss: 0.6029039 Best vali loss: 0.6029039
	iters: 100, epoch: 2 | loss: 1.0901979
	speed: 0.0305s/iter; left time: 49.2669s
	iters: 200, epoch: 2 | loss: 0.6295819
	speed: 0.0129s/iter; left time: 19.5052s
Updating learning rate to 0.00023323876437545695
Validation loss decreased (0.6029 --> 0.5880).  Saving model state dict ...
Epoch: 2 cost time: 3.272073268890381
Epoch: 2, Steps: 245 | Train Loss: 0.8598899 Vali Loss: 0.5879887 Best vali loss: 0.5879887
	iters: 100, epoch: 3 | loss: 1.2033783
	speed: 0.0311s/iter; left time: 42.6676s
	iters: 200, epoch: 3 | loss: 0.7291101
	speed: 0.0159s/iter; left time: 20.2691s
Updating learning rate to 0.00018891341704066955
Validation loss decreased (0.5880 --> 0.5824).  Saving model state dict ...
Epoch: 3 cost time: 3.7709648609161377
Epoch: 3, Steps: 245 | Train Loss: 0.9662442 Vali Loss: 0.5823598 Best vali loss: 0.5823598
	iters: 100, epoch: 4 | loss: 0.7394348
	speed: 0.0302s/iter; left time: 33.9505s
	iters: 200, epoch: 4 | loss: 0.4509565
	speed: 0.0083s/iter; left time: 8.4831s
Updating learning rate to 0.0001366281049
Validation loss decreased (0.5824 --> 0.5592).  Saving model state dict ...
Epoch: 4 cost time: 2.560586452484131
Epoch: 4, Steps: 245 | Train Loss: 0.5951957 Vali Loss: 0.5591705 Best vali loss: 0.5591705
	iters: 100, epoch: 5 | loss: 1.0897424
	speed: 0.0192s/iter; left time: 16.9551s
	iters: 200, epoch: 5 | loss: 0.6511332
	speed: 0.0068s/iter; left time: 5.2804s
Updating learning rate to 8.434279275933047e-05
Validation loss decreased (0.5592 --> 0.5559).  Saving model state dict ...
Epoch: 5 cost time: 2.19006609916687
Epoch: 5, Steps: 245 | Train Loss: 0.8704378 Vali Loss: 0.5558717 Best vali loss: 0.5558717
	iters: 100, epoch: 6 | loss: 0.9205046
	speed: 0.0174s/iter; left time: 11.0644s
	iters: 200, epoch: 6 | loss: 0.8449865
	speed: 0.0089s/iter; left time: 4.7777s
Updating learning rate to 4.001744542454305e-05
Validation loss decreased (0.5559 --> 0.5549).  Saving model state dict ...
Epoch: 6 cost time: 2.259459972381592
Epoch: 6, Steps: 245 | Train Loss: 0.8827456 Vali Loss: 0.5549498 Best vali loss: 0.5549498
	iters: 100, epoch: 7 | loss: 0.6177738
	speed: 0.0177s/iter; left time: 6.9290s
	iters: 200, epoch: 7 | loss: 0.5049423
	speed: 0.0117s/iter; left time: 3.4051s
Updating learning rate to 1.0400195217084955e-05
Validation loss decreased (0.5549 --> 0.5533).  Saving model state dict ...
Epoch: 7 cost time: 2.556220531463623
Epoch: 7, Steps: 245 | Train Loss: 0.5613580 Vali Loss: 0.5533283 Best vali loss: 0.5533283
	iters: 100, epoch: 8 | loss: 0.5775005
	speed: 0.0181s/iter; left time: 2.6479s
	iters: 200, epoch: 8 | loss: 0.4083335
	speed: 0.0084s/iter; left time: 0.3885s
Updating learning rate to 0.0
Validation loss decreased (0.5533 --> 0.5518).  Saving model state dict ...
Epoch: 8 cost time: 2.2239668369293213
Epoch: 8, Steps: 245 | Train Loss: 0.4929170 Vali Loss: 0.5517959 Best vali loss: 0.5517959

best validation loss 0.55179585652294

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0074701995035, 'e_layers': 3, 'learning_rate': 0.0001169716147, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4496495
	speed: 0.0188s/iter; left time: 145.6536s
	iters: 200, epoch: 1 | loss: 0.5178635
	speed: 0.0105s/iter; left time: 80.4777s
	iters: 300, epoch: 1 | loss: 0.3206264
	speed: 0.0111s/iter; left time: 83.7291s
	iters: 400, epoch: 1 | loss: 0.7304597
	speed: 0.0113s/iter; left time: 84.0101s
	iters: 500, epoch: 1 | loss: 0.7690915
	speed: 0.0098s/iter; left time: 71.6959s
	iters: 600, epoch: 1 | loss: 0.4387395
	speed: 0.0110s/iter; left time: 79.8511s
	iters: 700, epoch: 1 | loss: 1.0597342
	speed: 0.0111s/iter; left time: 78.9369s
	iters: 800, epoch: 1 | loss: 0.8947568
	speed: 0.0103s/iter; left time: 72.7807s
	iters: 900, epoch: 1 | loss: 0.4467267
	speed: 0.0078s/iter; left time: 54.0339s
Updating learning rate to 0.00011251964770306318
Validation loss decreased (inf --> 0.6363).  Saving model state dict ...
Epoch: 1 cost time: 10.794336795806885
Epoch: 1, Steps: 979 | Train Loss: 0.6252942 Vali Loss: 0.6363478 Best vali loss: 0.6363478
	iters: 100, epoch: 2 | loss: 0.5591299
	speed: 0.0508s/iter; left time: 343.1941s
	iters: 200, epoch: 2 | loss: 0.2544644
	speed: 0.0110s/iter; left time: 73.1124s
	iters: 300, epoch: 2 | loss: 0.5792701
	speed: 0.0079s/iter; left time: 51.5626s
	iters: 400, epoch: 2 | loss: 1.0591210
	speed: 0.0125s/iter; left time: 80.8779s
	iters: 500, epoch: 2 | loss: 0.8565616
	speed: 0.0137s/iter; left time: 87.2710s
	iters: 600, epoch: 2 | loss: 0.9604140
	speed: 0.0130s/iter; left time: 81.3831s
	iters: 700, epoch: 2 | loss: 0.4355579
	speed: 0.0131s/iter; left time: 80.9044s
	iters: 800, epoch: 2 | loss: 0.7959560
	speed: 0.0125s/iter; left time: 75.5838s
	iters: 900, epoch: 2 | loss: 0.6825788
	speed: 0.0098s/iter; left time: 58.3887s
Updating learning rate to 9.984151833035502e-05
Validation loss decreased (0.6363 --> 0.6194).  Saving model state dict ...
Epoch: 2 cost time: 11.057414054870605
Epoch: 2, Steps: 979 | Train Loss: 0.6870060 Vali Loss: 0.6194128 Best vali loss: 0.6194128
	iters: 100, epoch: 3 | loss: 0.2698056
	speed: 0.0357s/iter; left time: 206.0653s
	iters: 200, epoch: 3 | loss: 0.8183733
	speed: 0.0106s/iter; left time: 59.9804s
	iters: 300, epoch: 3 | loss: 0.5849078
	speed: 0.0113s/iter; left time: 63.0950s
	iters: 400, epoch: 3 | loss: 0.2651008
	speed: 0.0118s/iter; left time: 64.4962s
	iters: 500, epoch: 3 | loss: 0.9931968
	speed: 0.0113s/iter; left time: 60.5228s
	iters: 600, epoch: 3 | loss: 0.2727563
	speed: 0.0130s/iter; left time: 68.3809s
	iters: 700, epoch: 3 | loss: 1.3729061
	speed: 0.0111s/iter; left time: 57.5062s
	iters: 800, epoch: 3 | loss: 1.0470023
	speed: 0.0106s/iter; left time: 53.8787s
	iters: 900, epoch: 3 | loss: 0.6408966
	speed: 0.0108s/iter; left time: 53.5336s
Updating learning rate to 8.08673568513414e-05
Validation loss decreased (0.6194 --> 0.6161).  Saving model state dict ...
Epoch: 3 cost time: 11.096165418624878
Epoch: 3, Steps: 979 | Train Loss: 0.6961051 Vali Loss: 0.6161308 Best vali loss: 0.6161308
	iters: 100, epoch: 4 | loss: 1.2204722
	speed: 0.0505s/iter; left time: 242.3221s
	iters: 200, epoch: 4 | loss: 0.6053497
	speed: 0.0109s/iter; left time: 51.3461s
	iters: 300, epoch: 4 | loss: 1.4063872
	speed: 0.0125s/iter; left time: 57.5280s
	iters: 400, epoch: 4 | loss: 0.6848963
	speed: 0.0121s/iter; left time: 54.5079s
	iters: 500, epoch: 4 | loss: 1.0408560
	speed: 0.0115s/iter; left time: 50.6554s
	iters: 600, epoch: 4 | loss: 1.0661803
	speed: 0.0105s/iter; left time: 45.1631s
	iters: 700, epoch: 4 | loss: 0.5193830
	speed: 0.0077s/iter; left time: 32.4690s
	iters: 800, epoch: 4 | loss: 0.3106314
	speed: 0.0085s/iter; left time: 34.6763s
	iters: 900, epoch: 4 | loss: 1.1553695
	speed: 0.0085s/iter; left time: 33.9706s
Updating learning rate to 5.848580735e-05
Validation loss decreased (0.6161 --> 0.6120).  Saving model state dict ...
Epoch: 4 cost time: 9.927024841308594
Epoch: 4, Steps: 979 | Train Loss: 0.8899473 Vali Loss: 0.6119736 Best vali loss: 0.6119736
	iters: 100, epoch: 5 | loss: 1.5657449
	speed: 0.0287s/iter; left time: 109.3938s
	iters: 200, epoch: 5 | loss: 0.7003998
	speed: 0.0087s/iter; left time: 32.4721s
	iters: 300, epoch: 5 | loss: 0.6740505
	speed: 0.0083s/iter; left time: 29.9761s
	iters: 400, epoch: 5 | loss: 0.9366199
	speed: 0.0082s/iter; left time: 28.9222s
	iters: 500, epoch: 5 | loss: 1.2781892
	speed: 0.0077s/iter; left time: 26.4751s
	iters: 600, epoch: 5 | loss: 0.9708930
	speed: 0.0063s/iter; left time: 20.7388s
	iters: 700, epoch: 5 | loss: 1.2080154
	speed: 0.0073s/iter; left time: 23.3326s
	iters: 800, epoch: 5 | loss: 0.5095700
	speed: 0.0073s/iter; left time: 22.7571s
	iters: 900, epoch: 5 | loss: 0.4715986
	speed: 0.0074s/iter; left time: 22.3379s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0031777012672, 'e_layers': 1, 'learning_rate': 0.0002535692665, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4637512
	speed: 0.0110s/iter; left time: 85.3059s
	iters: 200, epoch: 1 | loss: 1.4987774
	speed: 0.0042s/iter; left time: 31.9835s
	iters: 300, epoch: 1 | loss: 0.8157039
	speed: 0.0040s/iter; left time: 30.3985s
	iters: 400, epoch: 1 | loss: 0.6184980
	speed: 0.0041s/iter; left time: 30.1354s
	iters: 500, epoch: 1 | loss: 0.9266303
	speed: 0.0042s/iter; left time: 30.5895s
	iters: 600, epoch: 1 | loss: 0.9784693
	speed: 0.0041s/iter; left time: 30.0154s
	iters: 700, epoch: 1 | loss: 1.1783732
	speed: 0.0042s/iter; left time: 29.7041s
	iters: 800, epoch: 1 | loss: 1.5405200
	speed: 0.0042s/iter; left time: 29.6195s
	iters: 900, epoch: 1 | loss: 0.5592083
	speed: 0.0042s/iter; left time: 29.0677s
Updating learning rate to 0.00024391836094662494
Validation loss decreased (inf --> 0.6176).  Saving model state dict ...
Epoch: 1 cost time: 4.364978551864624
Epoch: 1, Steps: 979 | Train Loss: 1.0644368 Vali Loss: 0.6176097 Best vali loss: 0.6176097
	iters: 100, epoch: 2 | loss: 0.4633977
	speed: 0.0156s/iter; left time: 105.2728s
	iters: 200, epoch: 2 | loss: 2.0945194
	speed: 0.0039s/iter; left time: 26.0793s
	iters: 300, epoch: 2 | loss: 1.3500890
	speed: 0.0039s/iter; left time: 25.6922s
	iters: 400, epoch: 2 | loss: 0.3173559
	speed: 0.0039s/iter; left time: 25.0258s
	iters: 500, epoch: 2 | loss: 0.5435368
	speed: 0.0041s/iter; left time: 26.0485s
	iters: 600, epoch: 2 | loss: 0.8776764
	speed: 0.0042s/iter; left time: 26.1435s
	iters: 700, epoch: 2 | loss: 0.7942965
	speed: 0.0040s/iter; left time: 24.7817s
	iters: 800, epoch: 2 | loss: 0.7155602
	speed: 0.0041s/iter; left time: 25.1029s
	iters: 900, epoch: 2 | loss: 0.5889574
	speed: 0.0042s/iter; left time: 24.9709s
Updating learning rate to 0.0002164349071713244
Validation loss decreased (0.6176 --> 0.6096).  Saving model state dict ...
Epoch: 2 cost time: 4.00822901725769
Epoch: 2, Steps: 979 | Train Loss: 0.8605988 Vali Loss: 0.6096455 Best vali loss: 0.6096455
	iters: 100, epoch: 3 | loss: 0.9863644
	speed: 0.0147s/iter; left time: 84.6723s
	iters: 200, epoch: 3 | loss: 1.0869750
	speed: 0.0039s/iter; left time: 22.3256s
	iters: 300, epoch: 3 | loss: 0.5155455
	speed: 0.0040s/iter; left time: 22.4370s
	iters: 400, epoch: 3 | loss: 0.5601241
	speed: 0.0040s/iter; left time: 22.1464s
	iters: 500, epoch: 3 | loss: 0.8431994
	speed: 0.0040s/iter; left time: 21.7220s
	iters: 600, epoch: 3 | loss: 1.1306001
	speed: 0.0042s/iter; left time: 22.1955s
	iters: 700, epoch: 3 | loss: 0.3635170
	speed: 0.0040s/iter; left time: 20.4844s
	iters: 800, epoch: 3 | loss: 0.4348795
	speed: 0.0039s/iter; left time: 19.6289s
	iters: 900, epoch: 3 | loss: 1.0974160
	speed: 0.0035s/iter; left time: 17.4257s
Updating learning rate to 0.0001753030118732591
Validation loss decreased (0.6096 --> 0.6018).  Saving model state dict ...
Epoch: 3 cost time: 3.8805525302886963
Epoch: 3, Steps: 979 | Train Loss: 0.7798468 Vali Loss: 0.6017810 Best vali loss: 0.6017810

best validation loss 0.6017810084556662

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.002287398968, 'e_layers': 3, 'learning_rate': 0.0011131188943, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010707533289976822
Validation loss decreased (inf --> 0.6061).  Saving model state dict ...
Epoch: 1 cost time: 0.9935367107391357
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6061112 Best vali loss: 0.6061112
Updating learning rate to 0.0009501064063632008
Epoch: 2 cost time: 0.8415639400482178
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6071272 Best vali loss: 0.6061112
Updating learning rate to 0.0007695455267005787
Epoch: 3 cost time: 0.8137006759643555
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6167576 Best vali loss: 0.6061112

best validation loss 0.6061112176263184

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026787077049, 'e_layers': 2, 'learning_rate': 0.0003369998911, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1131690
	speed: 0.0147s/iter; left time: 113.5376s
	iters: 200, epoch: 1 | loss: 0.9185708
	speed: 0.0080s/iter; left time: 61.0352s
	iters: 300, epoch: 1 | loss: 1.2518452
	speed: 0.0075s/iter; left time: 56.4415s
	iters: 400, epoch: 1 | loss: 0.5669622
	speed: 0.0074s/iter; left time: 54.7359s
	iters: 500, epoch: 1 | loss: 1.2973988
	speed: 0.0075s/iter; left time: 55.0790s
	iters: 600, epoch: 1 | loss: 0.9220692
	speed: 0.0073s/iter; left time: 52.9683s
	iters: 700, epoch: 1 | loss: 0.9673719
	speed: 0.0077s/iter; left time: 55.2670s
	iters: 800, epoch: 1 | loss: 1.1695966
	speed: 0.0075s/iter; left time: 52.5158s
	iters: 900, epoch: 1 | loss: 1.2624270
	speed: 0.0078s/iter; left time: 53.8056s
Updating learning rate to 0.00032417359647291124
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 7.775333881378174
Epoch: 1, Steps: 979 | Train Loss: 1.0521567 Vali Loss: 0.6075226 Best vali loss: 0.6075226
	iters: 100, epoch: 2 | loss: 0.5144122
	speed: 0.0216s/iter; left time: 145.7953s
	iters: 200, epoch: 2 | loss: 0.5382158
	speed: 0.0042s/iter; left time: 27.9618s
	iters: 300, epoch: 2 | loss: 0.6390420
	speed: 0.0045s/iter; left time: 29.4675s
	iters: 400, epoch: 2 | loss: 1.0430415
	speed: 0.0055s/iter; left time: 35.3964s
	iters: 500, epoch: 2 | loss: 1.3308446
	speed: 0.0057s/iter; left time: 36.4043s
	iters: 600, epoch: 2 | loss: 0.8854985
	speed: 0.0054s/iter; left time: 33.7276s
	iters: 700, epoch: 2 | loss: 0.4652701
	speed: 0.0057s/iter; left time: 35.3413s
	iters: 800, epoch: 2 | loss: 0.7521684
	speed: 0.0058s/iter; left time: 35.0518s
	iters: 900, epoch: 2 | loss: 0.8814245
	speed: 0.0057s/iter; left time: 33.7555s
Updating learning rate to 0.000287647399677969
Validation loss decreased (0.6075 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 5.19614577293396
Epoch: 2, Steps: 979 | Train Loss: 0.7833242 Vali Loss: 0.6035581 Best vali loss: 0.6035581
	iters: 100, epoch: 3 | loss: 0.6192918
	speed: 0.0201s/iter; left time: 115.8673s
	iters: 200, epoch: 3 | loss: 1.1544596
	speed: 0.0058s/iter; left time: 32.6612s
	iters: 300, epoch: 3 | loss: 0.4336859
	speed: 0.0059s/iter; left time: 32.9289s
	iters: 400, epoch: 3 | loss: 0.9714919
	speed: 0.0058s/iter; left time: 31.5530s
	iters: 500, epoch: 3 | loss: 0.9751322
	speed: 0.0056s/iter; left time: 29.9437s
	iters: 600, epoch: 3 | loss: 0.4454175
	speed: 0.0054s/iter; left time: 28.2527s
	iters: 700, epoch: 3 | loss: 0.4994785
	speed: 0.0058s/iter; left time: 29.8639s
	iters: 800, epoch: 3 | loss: 0.5711718
	speed: 0.0057s/iter; left time: 28.9662s
	iters: 900, epoch: 3 | loss: 0.6167511
	speed: 0.0056s/iter; left time: 28.0347s
Updating learning rate to 0.00023298208306640473
Epoch: 3 cost time: 5.5740580558776855
Epoch: 3, Steps: 979 | Train Loss: 0.6985423 Vali Loss: 0.6164599 Best vali loss: 0.6035581

best validation loss 0.6035580609833295

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0031777012672, 'e_layers': 1, 'learning_rate': 0.0002535692665, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.4160713
	speed: 0.0106s/iter; left time: 50.6473s
	iters: 200, epoch: 4 | loss: 1.3474774
	speed: 0.0038s/iter; left time: 17.9607s
	iters: 300, epoch: 4 | loss: 0.7822312
	speed: 0.0042s/iter; left time: 19.3596s
	iters: 400, epoch: 4 | loss: 0.6021442
	speed: 0.0043s/iter; left time: 19.5284s
	iters: 500, epoch: 4 | loss: 0.9276098
	speed: 0.0042s/iter; left time: 18.6567s
	iters: 600, epoch: 4 | loss: 0.9784457
	speed: 0.0042s/iter; left time: 18.1686s
	iters: 700, epoch: 4 | loss: 1.1561922
	speed: 0.0040s/iter; left time: 16.8522s
	iters: 800, epoch: 4 | loss: 1.4868050
	speed: 0.0041s/iter; left time: 16.9507s
	iters: 900, epoch: 4 | loss: 0.5072670
	speed: 0.0043s/iter; left time: 17.0682s
Updating learning rate to 0.00012678463325
Epoch: 4 cost time: 4.344845294952393
Epoch: 4, Steps: 979 | Train Loss: 1.0226937 Vali Loss: 0.6043944 Best vali loss: 0.6017810
	iters: 100, epoch: 5 | loss: 0.4564976
	speed: 0.0169s/iter; left time: 64.4480s
	iters: 200, epoch: 5 | loss: 2.0179696
	speed: 0.0043s/iter; left time: 16.0114s
	iters: 300, epoch: 5 | loss: 1.2760659
	speed: 0.0040s/iter; left time: 14.2947s
	iters: 400, epoch: 5 | loss: 0.2862987
	speed: 0.0039s/iter; left time: 13.5649s
	iters: 500, epoch: 5 | loss: 0.5418527
	speed: 0.0038s/iter; left time: 12.9249s
	iters: 600, epoch: 5 | loss: 0.8436379
	speed: 0.0036s/iter; left time: 11.9391s
	iters: 700, epoch: 5 | loss: 0.7615330
	speed: 0.0039s/iter; left time: 12.3884s
	iters: 800, epoch: 5 | loss: 0.7023672
	speed: 0.0041s/iter; left time: 12.8213s
	iters: 900, epoch: 5 | loss: 0.5963616
	speed: 0.0041s/iter; left time: 12.4052s
Updating learning rate to 7.826625462674092e-05
Epoch: 5 cost time: 3.95062255859375
Epoch: 5, Steps: 979 | Train Loss: 0.8313983 Vali Loss: 0.6058788 Best vali loss: 0.6017810
	iters: 100, epoch: 6 | loss: 0.9523690
	speed: 0.0169s/iter; left time: 48.0255s
	iters: 200, epoch: 6 | loss: 1.0609930
	speed: 0.0042s/iter; left time: 11.5528s
	iters: 300, epoch: 6 | loss: 0.4976138
	speed: 0.0042s/iter; left time: 11.1064s
	iters: 400, epoch: 6 | loss: 0.5687271
	speed: 0.0042s/iter; left time: 10.6408s
	iters: 500, epoch: 6 | loss: 0.8672577
	speed: 0.0042s/iter; left time: 10.3061s
	iters: 600, epoch: 6 | loss: 1.0286317
	speed: 0.0043s/iter; left time: 9.9455s
	iters: 700, epoch: 6 | loss: 0.3591630
	speed: 0.0040s/iter; left time: 9.0072s
	iters: 800, epoch: 6 | loss: 0.4102896
	speed: 0.0039s/iter; left time: 8.4315s
	iters: 900, epoch: 6 | loss: 1.1001774
	speed: 0.0039s/iter; left time: 8.0258s
Updating learning rate to 3.713435932867558e-05
Validation loss decreased (0.6018 --> 0.6007).  Saving model state dict ...
Epoch: 6 cost time: 4.077243328094482
Epoch: 6, Steps: 979 | Train Loss: 0.7605802 Vali Loss: 0.6006946 Best vali loss: 0.6006946
	iters: 100, epoch: 7 | loss: 0.9955695
	speed: 0.0153s/iter; left time: 28.4188s
	iters: 200, epoch: 7 | loss: 0.8665068
	speed: 0.0042s/iter; left time: 7.3099s
	iters: 300, epoch: 7 | loss: 0.5616201
	speed: 0.0041s/iter; left time: 6.7305s
	iters: 400, epoch: 7 | loss: 0.6995060
	speed: 0.0041s/iter; left time: 6.3872s
	iters: 500, epoch: 7 | loss: 1.2857925
	speed: 0.0043s/iter; left time: 6.2422s
	iters: 600, epoch: 7 | loss: 0.6480921
	speed: 0.0043s/iter; left time: 5.8586s
	iters: 700, epoch: 7 | loss: 0.1881103
	speed: 0.0041s/iter; left time: 5.1467s
	iters: 800, epoch: 7 | loss: 0.7148147
	speed: 0.0037s/iter; left time: 4.2316s
	iters: 900, epoch: 7 | loss: 0.5970620
	speed: 0.0037s/iter; left time: 3.9073s
Updating learning rate to 9.650905553375059e-06
Epoch: 7 cost time: 4.084941625595093
Epoch: 7, Steps: 979 | Train Loss: 0.7285638 Vali Loss: 0.6014651 Best vali loss: 0.6006946
	iters: 100, epoch: 8 | loss: 0.6776139
	speed: 0.0193s/iter; left time: 16.9896s
	iters: 200, epoch: 8 | loss: 0.2831956
	speed: 0.0058s/iter; left time: 4.4953s
	iters: 300, epoch: 8 | loss: 0.6964161
	speed: 0.0064s/iter; left time: 4.3246s
	iters: 400, epoch: 8 | loss: 1.7830435
	speed: 0.0066s/iter; left time: 3.8140s
	iters: 500, epoch: 8 | loss: 0.2596325
	speed: 0.0066s/iter; left time: 3.1798s
	iters: 600, epoch: 8 | loss: 0.3715198
	speed: 0.0055s/iter; left time: 2.0923s
	iters: 700, epoch: 8 | loss: 0.6129910
	speed: 0.0040s/iter; left time: 1.1209s
	iters: 800, epoch: 8 | loss: 0.9316199
	speed: 0.0042s/iter; left time: 0.7632s
	iters: 900, epoch: 8 | loss: 0.4386126
	speed: 0.0046s/iter; left time: 0.3713s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.231737852096558
Epoch: 8, Steps: 979 | Train Loss: 0.6727383 Vali Loss: 0.6013362 Best vali loss: 0.6006946

best validation loss 0.6006946251837537

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0034070980994, 'e_layers': 1, 'learning_rate': 6.92167917e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4658359
	speed: 0.0111s/iter; left time: 9.8130s
Updating learning rate to 6.658238442886356e-05
Validation loss decreased (inf --> 0.6170).  Saving model state dict ...
Epoch: 1 cost time: 0.9354248046875
Epoch: 1, Steps: 123 | Train Loss: 0.4658359 Vali Loss: 0.6170353 Best vali loss: 0.6170353
	iters: 100, epoch: 2 | loss: 0.9532725
	speed: 0.0087s/iter; left time: 6.6282s
Updating learning rate to 5.9080227241523365e-05
Validation loss decreased (0.6170 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 0.6753478050231934
Epoch: 2, Steps: 123 | Train Loss: 0.9532725 Vali Loss: 0.6038143 Best vali loss: 0.6038143
	iters: 100, epoch: 3 | loss: 1.2336383
	speed: 0.0086s/iter; left time: 5.4949s
Updating learning rate to 4.785245556252773e-05
Epoch: 3 cost time: 0.613375186920166
Epoch: 3, Steps: 123 | Train Loss: 1.2336383 Vali Loss: 0.6106843 Best vali loss: 0.6038143
	iters: 100, epoch: 4 | loss: 0.9046030
	speed: 0.0078s/iter; left time: 4.0377s
Updating learning rate to 3.460839585e-05
Epoch: 4 cost time: 0.6071457862854004
Epoch: 4, Steps: 123 | Train Loss: 0.9046030 Vali Loss: 0.6096153 Best vali loss: 0.6038143
	iters: 100, epoch: 5 | loss: 0.7178670
	speed: 0.0086s/iter; left time: 3.3643s
Updating learning rate to 2.1364336137472275e-05
Validation loss decreased (0.6038 --> 0.6036).  Saving model state dict ...
Epoch: 5 cost time: 0.660578727722168
Epoch: 5, Steps: 123 | Train Loss: 0.7178670 Vali Loss: 0.6035547 Best vali loss: 0.6035547
	iters: 100, epoch: 6 | loss: 0.7698925
	speed: 0.0092s/iter; left time: 2.4960s
Updating learning rate to 1.0136564458476632e-05
Epoch: 6 cost time: 0.6982192993164062
Epoch: 6, Steps: 123 | Train Loss: 0.7698925 Vali Loss: 0.6055492 Best vali loss: 0.6035547
	iters: 100, epoch: 7 | loss: 0.7569105
	speed: 0.0085s/iter; left time: 1.2548s
Updating learning rate to 2.634407271136444e-06
Epoch: 7 cost time: 0.6341440677642822
Epoch: 7, Steps: 123 | Train Loss: 0.7569105 Vali Loss: 0.6064517 Best vali loss: 0.6035547
	iters: 100, epoch: 8 | loss: 0.5678090
	speed: 0.0082s/iter; left time: 0.1977s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6309604644775391
Epoch: 8, Steps: 123 | Train Loss: 0.5678090 Vali Loss: 0.6052591 Best vali loss: 0.6035547

best validation loss 0.603554684632578

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0009923553162, 'e_layers': 2, 'learning_rate': 0.0015677066798, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7892211
	speed: 0.0113s/iter; left time: 87.3815s
	iters: 200, epoch: 1 | loss: 1.9411356
	speed: 0.0073s/iter; left time: 55.5366s
	iters: 300, epoch: 1 | loss: 0.9728239
	speed: 0.0073s/iter; left time: 55.1777s
	iters: 400, epoch: 1 | loss: 0.5564964
	speed: 0.0079s/iter; left time: 58.5731s
	iters: 500, epoch: 1 | loss: 0.6221367
	speed: 0.0052s/iter; left time: 38.2827s
	iters: 600, epoch: 1 | loss: 0.4386466
	speed: 0.0055s/iter; left time: 39.5671s
	iters: 700, epoch: 1 | loss: 0.3772035
	speed: 0.0057s/iter; left time: 40.9377s
	iters: 800, epoch: 1 | loss: 0.5739004
	speed: 0.0057s/iter; left time: 39.8815s
	iters: 900, epoch: 1 | loss: 0.9945663
	speed: 0.0054s/iter; left time: 37.3287s
Updating learning rate to 0.0015677066798
Validation loss decreased (inf --> 0.6199).  Saving model state dict ...
Epoch: 1 cost time: 6.293205261230469
Epoch: 1, Steps: 979 | Train Loss: 0.8073478 Vali Loss: 0.6198742 Best vali loss: 0.6198742
	iters: 100, epoch: 2 | loss: 1.2539117
	speed: 0.0201s/iter; left time: 135.7557s
	iters: 200, epoch: 2 | loss: 1.0409813
	speed: 0.0058s/iter; left time: 38.4207s
	iters: 300, epoch: 2 | loss: 0.7245371
	speed: 0.0058s/iter; left time: 37.8283s
	iters: 400, epoch: 2 | loss: 0.3045473
	speed: 0.0056s/iter; left time: 36.0938s
	iters: 500, epoch: 2 | loss: 0.6529813
	speed: 0.0052s/iter; left time: 32.8444s
	iters: 600, epoch: 2 | loss: 0.8292298
	speed: 0.0051s/iter; left time: 31.6265s
	iters: 700, epoch: 2 | loss: 0.4622081
	speed: 0.0059s/iter; left time: 36.1352s
	iters: 800, epoch: 2 | loss: 0.5428317
	speed: 0.0054s/iter; left time: 32.6699s
	iters: 900, epoch: 2 | loss: 1.0010695
	speed: 0.0056s/iter; left time: 33.5358s
Updating learning rate to 0.0007838533399
Epoch: 2 cost time: 5.507762432098389
Epoch: 2, Steps: 979 | Train Loss: 0.7569220 Vali Loss: 0.6346015 Best vali loss: 0.6198742
	iters: 100, epoch: 3 | loss: 0.8521056
	speed: 0.0203s/iter; left time: 117.0645s
	iters: 200, epoch: 3 | loss: 0.2649220
	speed: 0.0059s/iter; left time: 33.3783s
	iters: 300, epoch: 3 | loss: 1.6196595
	speed: 0.0058s/iter; left time: 32.4616s
	iters: 400, epoch: 3 | loss: 0.4818948
	speed: 0.0061s/iter; left time: 33.2566s
	iters: 500, epoch: 3 | loss: 0.4929591
	speed: 0.0058s/iter; left time: 31.4207s
	iters: 600, epoch: 3 | loss: 0.3599364
	speed: 0.0057s/iter; left time: 30.3200s
	iters: 700, epoch: 3 | loss: 0.7734274
	speed: 0.0059s/iter; left time: 30.2960s
	iters: 800, epoch: 3 | loss: 0.7049401
	speed: 0.0059s/iter; left time: 29.8861s
	iters: 900, epoch: 3 | loss: 0.7503872
	speed: 0.0056s/iter; left time: 27.8067s
Updating learning rate to 0.00039192666995
Validation loss decreased (0.6199 --> 0.6170).  Saving model state dict ...
Epoch: 3 cost time: 5.705176591873169
Epoch: 3, Steps: 979 | Train Loss: 0.7000258 Vali Loss: 0.6169520 Best vali loss: 0.6169520
	iters: 100, epoch: 4 | loss: 0.5712490
	speed: 0.0197s/iter; left time: 94.3790s
	iters: 200, epoch: 4 | loss: 0.7295619
	speed: 0.0053s/iter; left time: 24.8552s
	iters: 300, epoch: 4 | loss: 0.6182771
	speed: 0.0054s/iter; left time: 25.0010s
	iters: 400, epoch: 4 | loss: 0.6878309
	speed: 0.0055s/iter; left time: 24.6914s
	iters: 500, epoch: 4 | loss: 0.3499394
	speed: 0.0053s/iter; left time: 23.1852s
	iters: 600, epoch: 4 | loss: 0.7954267
	speed: 0.0057s/iter; left time: 24.4965s
	iters: 700, epoch: 4 | loss: 1.5550917
	speed: 0.0059s/iter; left time: 24.9355s
	iters: 800, epoch: 4 | loss: 1.0150568
	speed: 0.0058s/iter; left time: 23.9197s
	iters: 900, epoch: 4 | loss: 0.6316132
	speed: 0.0058s/iter; left time: 23.2752s
Updating learning rate to 0.000195963334975
Epoch: 4 cost time: 5.524815797805786
Epoch: 4, Steps: 979 | Train Loss: 0.7726719 Vali Loss: 0.6177274 Best vali loss: 0.6169520
	iters: 100, epoch: 5 | loss: 0.3163279
	speed: 0.0195s/iter; left time: 74.4524s
	iters: 200, epoch: 5 | loss: 0.5020072
	speed: 0.0053s/iter; left time: 19.6622s
	iters: 300, epoch: 5 | loss: 0.7788724
	speed: 0.0056s/iter; left time: 20.2885s
	iters: 400, epoch: 5 | loss: 1.5287004
	speed: 0.0079s/iter; left time: 27.9463s
	iters: 500, epoch: 5 | loss: 1.0054024
	speed: 0.0081s/iter; left time: 27.5851s
	iters: 600, epoch: 5 | loss: 1.1222479
	speed: 0.0079s/iter; left time: 26.0910s
	iters: 700, epoch: 5 | loss: 0.9394563
	speed: 0.0077s/iter; left time: 24.7022s
	iters: 800, epoch: 5 | loss: 0.3961506
	speed: 0.0080s/iter; left time: 24.9962s
	iters: 900, epoch: 5 | loss: 0.3026494
	speed: 0.0052s/iter; left time: 15.5977s
Updating learning rate to 9.79816674875e-05
Epoch: 5 cost time: 6.597323894500732
Epoch: 5, Steps: 979 | Train Loss: 0.7657572 Vali Loss: 0.6425984 Best vali loss: 0.6169520
	iters: 100, epoch: 6 | loss: 1.2559965
	speed: 0.0214s/iter; left time: 60.8678s
	iters: 200, epoch: 6 | loss: 1.5184186
	speed: 0.0085s/iter; left time: 23.3654s
	iters: 300, epoch: 6 | loss: 0.4224930
	speed: 0.0085s/iter; left time: 22.3638s
	iters: 400, epoch: 6 | loss: 0.8454326
	speed: 0.0086s/iter; left time: 21.9017s
	iters: 500, epoch: 6 | loss: 1.0415901
	speed: 0.0082s/iter; left time: 20.0562s
	iters: 600, epoch: 6 | loss: 1.1636764
	speed: 0.0077s/iter; left time: 18.0196s
	iters: 700, epoch: 6 | loss: 1.3108513
	speed: 0.0086s/iter; left time: 19.3257s
	iters: 800, epoch: 6 | loss: 1.3549947
	speed: 0.0084s/iter; left time: 18.0008s
	iters: 900, epoch: 6 | loss: 0.3527873
	speed: 0.0082s/iter; left time: 16.6751s
Updating learning rate to 4.899083374375e-05
Epoch: 6 cost time: 8.144623756408691
Epoch: 6, Steps: 979 | Train Loss: 1.0295823 Vali Loss: 0.6496026 Best vali loss: 0.6169520
	iters: 100, epoch: 7 | loss: 0.8264823
	speed: 0.0263s/iter; left time: 48.8845s
	iters: 200, epoch: 7 | loss: 0.8845591
	speed: 0.0059s/iter; left time: 10.3145s
	iters: 300, epoch: 7 | loss: 0.4331143
	speed: 0.0073s/iter; left time: 12.0910s
	iters: 400, epoch: 7 | loss: 0.2862962
	speed: 0.0074s/iter; left time: 11.5571s
	iters: 500, epoch: 7 | loss: 0.4235308
	speed: 0.0075s/iter; left time: 10.9160s
	iters: 600, epoch: 7 | loss: 0.8124648
	speed: 0.0075s/iter; left time: 10.1335s
	iters: 700, epoch: 7 | loss: 0.2837961
	speed: 0.0075s/iter; left time: 9.4328s
	iters: 800, epoch: 7 | loss: 0.4142117
	speed: 0.0073s/iter; left time: 8.4235s
	iters: 900, epoch: 7 | loss: 0.7947466
	speed: 0.0071s/iter; left time: 7.5482s
Updating learning rate to 2.4495416871875e-05
Epoch: 7 cost time: 6.90228009223938
Epoch: 7, Steps: 979 | Train Loss: 0.5732447 Vali Loss: 0.6547504 Best vali loss: 0.6169520
	iters: 100, epoch: 8 | loss: 0.7634891
	speed: 0.0217s/iter; left time: 19.1236s
	iters: 200, epoch: 8 | loss: 0.6386004
	speed: 0.0080s/iter; left time: 6.2594s
	iters: 300, epoch: 8 | loss: 0.4692628
	speed: 0.0079s/iter; left time: 5.3844s
	iters: 400, epoch: 8 | loss: 0.3775330
	speed: 0.0077s/iter; left time: 4.4421s
	iters: 500, epoch: 8 | loss: 0.9928663
	speed: 0.0080s/iter; left time: 3.8532s
	iters: 600, epoch: 8 | loss: 0.9107159
	speed: 0.0077s/iter; left time: 2.9320s
	iters: 700, epoch: 8 | loss: 1.1867328
	speed: 0.0081s/iter; left time: 2.2556s
	iters: 800, epoch: 8 | loss: 0.9305837
	speed: 0.0083s/iter; left time: 1.4888s
	iters: 900, epoch: 8 | loss: 0.4391609
	speed: 0.0079s/iter; left time: 0.6280s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0012951973113, 'e_layers': 1, 'learning_rate': 0.0019297602429, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9732397
	speed: 0.0106s/iter; left time: 9.3596s
Updating learning rate to 0.0019297602429
Validation loss decreased (inf --> 0.6247).  Saving model state dict ...
Epoch: 1 cost time: 0.8897309303283691
Epoch: 1, Steps: 123 | Train Loss: 0.9732397 Vali Loss: 0.6247426 Best vali loss: 0.6247426
	iters: 100, epoch: 2 | loss: 0.9498615
	speed: 0.0080s/iter; left time: 6.0936s
Updating learning rate to 0.00096488012145
Epoch: 2 cost time: 0.6133313179016113
Epoch: 2, Steps: 123 | Train Loss: 0.9498615 Vali Loss: 0.6287864 Best vali loss: 0.6247426
	iters: 100, epoch: 3 | loss: 0.5985942
	speed: 0.0074s/iter; left time: 4.7277s
Updating learning rate to 0.000482440060725
Epoch: 3 cost time: 0.594261646270752
Epoch: 3, Steps: 123 | Train Loss: 0.5985942 Vali Loss: 0.6387476 Best vali loss: 0.6247426

best validation loss 0.6247426089949213

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0023270275026, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0448555
	speed: 0.0116s/iter; left time: 89.8886s
	iters: 200, epoch: 1 | loss: 0.9519132
	speed: 0.0057s/iter; left time: 43.3443s
	iters: 300, epoch: 1 | loss: 0.7549336
	speed: 0.0058s/iter; left time: 43.3697s
	iters: 400, epoch: 1 | loss: 0.6275471
	speed: 0.0056s/iter; left time: 41.5777s
	iters: 500, epoch: 1 | loss: 0.8029863
	speed: 0.0058s/iter; left time: 42.3496s
	iters: 600, epoch: 1 | loss: 1.2287084
	speed: 0.0058s/iter; left time: 42.2978s
	iters: 700, epoch: 1 | loss: 0.5407096
	speed: 0.0055s/iter; left time: 38.9885s
	iters: 800, epoch: 1 | loss: 1.2510470
	speed: 0.0057s/iter; left time: 39.8844s
	iters: 900, epoch: 1 | loss: 1.0076871
	speed: 0.0055s/iter; left time: 38.3364s
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.6111).  Saving model state dict ...
Epoch: 1 cost time: 5.8681640625
Epoch: 1, Steps: 979 | Train Loss: 0.9122653 Vali Loss: 0.6111085 Best vali loss: 0.6111085
	iters: 100, epoch: 2 | loss: 0.5033165
	speed: 0.0201s/iter; left time: 135.5251s
	iters: 200, epoch: 2 | loss: 0.3129072
	speed: 0.0055s/iter; left time: 36.3518s
	iters: 300, epoch: 2 | loss: 1.1677308
	speed: 0.0055s/iter; left time: 35.8579s
	iters: 400, epoch: 2 | loss: 0.2895341
	speed: 0.0057s/iter; left time: 36.9514s
	iters: 500, epoch: 2 | loss: 0.5056721
	speed: 0.0057s/iter; left time: 36.1375s
	iters: 600, epoch: 2 | loss: 0.3533875
	speed: 0.0058s/iter; left time: 36.1492s
	iters: 700, epoch: 2 | loss: 1.8172716
	speed: 0.0060s/iter; left time: 36.7519s
	iters: 800, epoch: 2 | loss: 0.9625448
	speed: 0.0060s/iter; left time: 36.0332s
	iters: 900, epoch: 2 | loss: 0.8844130
	speed: 0.0057s/iter; left time: 33.6579s
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.6111 --> 0.6070).  Saving model state dict ...
Epoch: 2 cost time: 5.6400134563446045
Epoch: 2, Steps: 979 | Train Loss: 0.7551975 Vali Loss: 0.6069723 Best vali loss: 0.6069723
	iters: 100, epoch: 3 | loss: 0.6208032
	speed: 0.0195s/iter; left time: 112.7455s
	iters: 200, epoch: 3 | loss: 0.8466195
	speed: 0.0052s/iter; left time: 29.3174s
	iters: 300, epoch: 3 | loss: 1.2692046
	speed: 0.0053s/iter; left time: 29.7276s
	iters: 400, epoch: 3 | loss: 0.9929823
	speed: 0.0056s/iter; left time: 30.9017s
	iters: 500, epoch: 3 | loss: 0.6460913
	speed: 0.0060s/iter; left time: 32.0115s
	iters: 600, epoch: 3 | loss: 0.2890691
	speed: 0.0061s/iter; left time: 32.2453s
	iters: 700, epoch: 3 | loss: 0.6174474
	speed: 0.0060s/iter; left time: 31.0897s
	iters: 800, epoch: 3 | loss: 1.5120049
	speed: 0.0059s/iter; left time: 30.1028s
	iters: 900, epoch: 3 | loss: 1.0750866
	speed: 0.0059s/iter; left time: 29.4816s
Updating learning rate to 8.93085473266162e-05
Epoch: 3 cost time: 5.636761903762817
Epoch: 3, Steps: 979 | Train Loss: 0.8743677 Vali Loss: 0.6135199 Best vali loss: 0.6069723

best validation loss 0.6069722884730684

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0067140529486, 'e_layers': 4, 'learning_rate': 0.0011984411391, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3626113
	speed: 0.0152s/iter; left time: 28.3225s
	iters: 200, epoch: 1 | loss: 0.6887907
	speed: 0.0089s/iter; left time: 15.6909s
Updating learning rate to 0.0011528281892170008
Validation loss decreased (inf --> 0.6098).  Saving model state dict ...
Epoch: 1 cost time: 2.527250289916992
Epoch: 1, Steps: 245 | Train Loss: 1.0257010 Vali Loss: 0.6097892 Best vali loss: 0.6097892
	iters: 100, epoch: 2 | loss: 1.1744630
	speed: 0.0161s/iter; left time: 26.0323s
	iters: 200, epoch: 2 | loss: 0.6235276
	speed: 0.0091s/iter; left time: 13.8566s
Updating learning rate to 0.0010229334977052702
Validation loss decreased (0.6098 --> 0.6093).  Saving model state dict ...
Epoch: 2 cost time: 2.3822755813598633
Epoch: 2, Steps: 245 | Train Loss: 0.8989953 Vali Loss: 0.6093119 Best vali loss: 0.6093119
	iters: 100, epoch: 3 | loss: 0.5714369
	speed: 0.0220s/iter; left time: 30.1927s
	iters: 200, epoch: 3 | loss: 0.6577621
	speed: 0.0109s/iter; left time: 13.8128s
Updating learning rate to 0.000828532353849158
Validation loss decreased (0.6093 --> 0.6017).  Saving model state dict ...
Epoch: 3 cost time: 2.9064981937408447
Epoch: 3, Steps: 245 | Train Loss: 0.6145995 Vali Loss: 0.6017374 Best vali loss: 0.6017374

best validation loss 0.6017374058169163

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0067140529486, 'e_layers': 4, 'learning_rate': 0.0011984411391, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.3005782
	speed: 0.0203s/iter; left time: 22.8894s
	iters: 200, epoch: 4 | loss: 0.6336496
	speed: 0.0125s/iter; left time: 12.8371s
Updating learning rate to 0.00059922056955
Epoch: 4 cost time: 3.3569159507751465
Epoch: 4, Steps: 245 | Train Loss: 0.9671139 Vali Loss: 0.6104592 Best vali loss: 0.6017374
	iters: 100, epoch: 5 | loss: 1.0862112
	speed: 0.0221s/iter; left time: 19.4903s
	iters: 200, epoch: 5 | loss: 0.5631432
	speed: 0.0129s/iter; left time: 10.0936s
Updating learning rate to 0.000369908785250842
Epoch: 5 cost time: 3.3051741123199463
Epoch: 5, Steps: 245 | Train Loss: 0.8246772 Vali Loss: 0.6317443 Best vali loss: 0.6017374
	iters: 100, epoch: 6 | loss: 0.5458285
	speed: 0.0235s/iter; left time: 14.9407s
	iters: 200, epoch: 6 | loss: 0.6281722
	speed: 0.0099s/iter; left time: 5.2881s
Updating learning rate to 0.0001755076413947298
Epoch: 6 cost time: 2.7015435695648193
Epoch: 6, Steps: 245 | Train Loss: 0.5870003 Vali Loss: 0.6424500 Best vali loss: 0.6017374
	iters: 100, epoch: 7 | loss: 0.6756073
	speed: 0.0154s/iter; left time: 6.0108s
	iters: 200, epoch: 7 | loss: 0.6387495
	speed: 0.0082s/iter; left time: 2.3781s
Updating learning rate to 4.5612949882999016e-05
Epoch: 7 cost time: 2.211716890335083
Epoch: 7, Steps: 245 | Train Loss: 0.6571784 Vali Loss: 0.6350404 Best vali loss: 0.6017374
	iters: 100, epoch: 8 | loss: 0.4944420
	speed: 0.0227s/iter; left time: 3.3118s
	iters: 200, epoch: 8 | loss: 0.7451345
	speed: 0.0115s/iter; left time: 0.5305s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.7218565940856934
Epoch: 8, Steps: 245 | Train Loss: 0.6197882 Vali Loss: 0.6281986 Best vali loss: 0.6017374

best validation loss 0.6017374058169163

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0011495782693, 'e_layers': 3, 'learning_rate': 0.0004088541863, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4814735
	speed: 0.0131s/iter; left time: 101.3990s
	iters: 200, epoch: 1 | loss: 1.1249282
	speed: 0.0070s/iter; left time: 53.3006s
	iters: 300, epoch: 1 | loss: 0.9365882
	speed: 0.0072s/iter; left time: 53.9348s
	iters: 400, epoch: 1 | loss: 1.1047199
	speed: 0.0065s/iter; left time: 48.1474s
	iters: 500, epoch: 1 | loss: 1.0687039
	speed: 0.0095s/iter; left time: 69.3363s
	iters: 600, epoch: 1 | loss: 0.8416727
	speed: 0.0113s/iter; left time: 81.7775s
	iters: 700, epoch: 1 | loss: 0.5890750
	speed: 0.0111s/iter; left time: 78.9743s
	iters: 800, epoch: 1 | loss: 1.4097631
	speed: 0.0108s/iter; left time: 75.7785s
	iters: 900, epoch: 1 | loss: 0.8832507
	speed: 0.0057s/iter; left time: 39.6040s
Updating learning rate to 0.00039329310040206325
Validation loss decreased (inf --> 0.6145).  Saving model state dict ...
Epoch: 1 cost time: 8.481303453445435
Epoch: 1, Steps: 979 | Train Loss: 0.9377972 Vali Loss: 0.6145315 Best vali loss: 0.6145315
	iters: 100, epoch: 2 | loss: 0.9318553
	speed: 0.0265s/iter; left time: 178.7967s
	iters: 200, epoch: 2 | loss: 1.0236603
	speed: 0.0071s/iter; left time: 47.1993s
	iters: 300, epoch: 2 | loss: 1.1083130
	speed: 0.0060s/iter; left time: 39.4298s
	iters: 400, epoch: 2 | loss: 0.5327184
	speed: 0.0110s/iter; left time: 70.8664s
	iters: 500, epoch: 2 | loss: 0.4897251
	speed: 0.0113s/iter; left time: 72.0606s
	iters: 600, epoch: 2 | loss: 0.5014045
	speed: 0.0106s/iter; left time: 66.2001s
	iters: 700, epoch: 2 | loss: 0.6055385
	speed: 0.0111s/iter; left time: 68.0106s
	iters: 800, epoch: 2 | loss: 1.3546045
	speed: 0.0109s/iter; left time: 66.0738s
	iters: 900, epoch: 2 | loss: 0.8004825
	speed: 0.0112s/iter; left time: 66.4912s
Updating learning rate to 0.000348978876974619
Epoch: 2 cost time: 9.27332854270935
Epoch: 2, Steps: 979 | Train Loss: 0.8164780 Vali Loss: 0.6174863 Best vali loss: 0.6145315
	iters: 100, epoch: 3 | loss: 1.0909312
	speed: 0.0199s/iter; left time: 115.1919s
	iters: 200, epoch: 3 | loss: 0.8023847
	speed: 0.0082s/iter; left time: 46.7990s
	iters: 300, epoch: 3 | loss: 0.3551778
	speed: 0.0088s/iter; left time: 48.8424s
	iters: 400, epoch: 3 | loss: 0.7615591
	speed: 0.0088s/iter; left time: 48.4191s
	iters: 500, epoch: 3 | loss: 1.4559828
	speed: 0.0083s/iter; left time: 44.8117s
	iters: 600, epoch: 3 | loss: 1.6301242
	speed: 0.0083s/iter; left time: 43.7406s
	iters: 700, epoch: 3 | loss: 1.4298570
	speed: 0.0083s/iter; left time: 42.7522s
	iters: 800, epoch: 3 | loss: 0.8979238
	speed: 0.0121s/iter; left time: 61.5062s
	iters: 900, epoch: 3 | loss: 1.1190654
	speed: 0.0102s/iter; left time: 50.8600s
Updating learning rate to 0.00028265795482505996
Validation loss decreased (0.6145 --> 0.6071).  Saving model state dict ...
Epoch: 3 cost time: 8.765738487243652
Epoch: 3, Steps: 979 | Train Loss: 1.0603340 Vali Loss: 0.6070674 Best vali loss: 0.6070674
	iters: 100, epoch: 4 | loss: 0.6754409
	speed: 0.0522s/iter; left time: 250.1221s
	iters: 200, epoch: 4 | loss: 0.3460606
	speed: 0.0099s/iter; left time: 46.4627s
	iters: 300, epoch: 4 | loss: 0.6080959
	speed: 0.0118s/iter; left time: 54.2950s
	iters: 400, epoch: 4 | loss: 0.8353515
	speed: 0.0104s/iter; left time: 46.5930s
	iters: 500, epoch: 4 | loss: 0.6753492
	speed: 0.0105s/iter; left time: 46.2071s
	iters: 600, epoch: 4 | loss: 0.8023561
	speed: 0.0102s/iter; left time: 43.9244s
	iters: 700, epoch: 4 | loss: 0.4945295
	speed: 0.0125s/iter; left time: 52.5986s
	iters: 800, epoch: 4 | loss: 0.5892906
	speed: 0.0084s/iter; left time: 34.3805s
	iters: 900, epoch: 4 | loss: 0.6945258
	speed: 0.0094s/iter; left time: 37.6177s
Updating learning rate to 0.00020442709315
Epoch: 4 cost time: 10.236961841583252
Epoch: 4, Steps: 979 | Train Loss: 0.6356667 Vali Loss: 0.6321612 Best vali loss: 0.6070674
	iters: 100, epoch: 5 | loss: 0.9093977
	speed: 0.0454s/iter; left time: 173.1509s
	iters: 200, epoch: 5 | loss: 1.0047994
	speed: 0.0113s/iter; left time: 41.9855s
	iters: 300, epoch: 5 | loss: 0.4254967
	speed: 0.0104s/iter; left time: 37.6063s
	iters: 400, epoch: 5 | loss: 0.3056152
	speed: 0.0106s/iter; left time: 37.2456s
	iters: 500, epoch: 5 | loss: 0.4313432
	speed: 0.0115s/iter; left time: 39.2680s
	iters: 600, epoch: 5 | loss: 0.1949323
	speed: 0.0113s/iter; left time: 37.5334s
	iters: 700, epoch: 5 | loss: 1.0383227
	speed: 0.0090s/iter; left time: 28.8149s
	iters: 800, epoch: 5 | loss: 0.6211115
	speed: 0.0108s/iter; left time: 33.6663s
	iters: 900, epoch: 5 | loss: 0.3883362
	speed: 0.0123s/iter; left time: 37.1450s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0084246134311, 'e_layers': 2, 'learning_rate': 0.000337778408, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9280258
	speed: 0.0375s/iter; left time: 33.1937s
Updating learning rate to 0.000337778408
Validation loss decreased (inf --> 0.6102).  Saving model state dict ...
Epoch: 1 cost time: 4.119843244552612
Epoch: 1, Steps: 123 | Train Loss: 0.9280258 Vali Loss: 0.6101787 Best vali loss: 0.6101787
	iters: 100, epoch: 2 | loss: 0.7765865
	speed: 0.0521s/iter; left time: 39.7214s
Updating learning rate to 0.000168889204
Validation loss decreased (0.6102 --> 0.5599).  Saving model state dict ...
Epoch: 2 cost time: 3.8102729320526123
Epoch: 2, Steps: 123 | Train Loss: 0.7765865 Vali Loss: 0.5599027 Best vali loss: 0.5599027
	iters: 100, epoch: 3 | loss: 0.9108470
	speed: 0.0512s/iter; left time: 32.7337s
Updating learning rate to 8.4444602e-05
Validation loss decreased (0.5599 --> 0.5462).  Saving model state dict ...
Epoch: 3 cost time: 2.4488470554351807
Epoch: 3, Steps: 123 | Train Loss: 0.9108470 Vali Loss: 0.5462446 Best vali loss: 0.5462446
	iters: 100, epoch: 4 | loss: 0.8502885
	speed: 0.0169s/iter; left time: 8.7163s
Updating learning rate to 4.2222301e-05
Epoch: 4 cost time: 1.4039952754974365
Epoch: 4, Steps: 123 | Train Loss: 0.8502885 Vali Loss: 0.5545031 Best vali loss: 0.5462446
	iters: 100, epoch: 5 | loss: 0.5932252
	speed: 0.0174s/iter; left time: 6.8482s
Updating learning rate to 2.11111505e-05
Epoch: 5 cost time: 1.3770346641540527
Epoch: 5, Steps: 123 | Train Loss: 0.5932252 Vali Loss: 0.5517973 Best vali loss: 0.5462446
	iters: 100, epoch: 6 | loss: 0.5508294
	speed: 0.0177s/iter; left time: 4.7690s
Updating learning rate to 1.055557525e-05
Epoch: 6 cost time: 1.4524869918823242
Epoch: 6, Steps: 123 | Train Loss: 0.5508294 Vali Loss: 0.5527964 Best vali loss: 0.5462446
	iters: 100, epoch: 7 | loss: 0.8146097
	speed: 0.0174s/iter; left time: 2.5576s
Updating learning rate to 5.277787625e-06
Epoch: 7 cost time: 1.393707513809204
Epoch: 7, Steps: 123 | Train Loss: 0.8146097 Vali Loss: 0.5530085 Best vali loss: 0.5462446
	iters: 100, epoch: 8 | loss: 0.6809878
	speed: 0.0169s/iter; left time: 0.4052s
Updating learning rate to 2.6388938125e-06
Epoch: 8 cost time: 1.2755961418151855
Epoch: 8, Steps: 123 | Train Loss: 0.6809878 Vali Loss: 0.5516277 Best vali loss: 0.5462446

best validation loss 0.5462445864959868

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0042142753194, 'e_layers': 1, 'learning_rate': 0.0005493796823, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005493796823
Validation loss decreased (inf --> 0.6054).  Saving model state dict ...
Epoch: 1 cost time: 0.7784874439239502
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6053588 Best vali loss: 0.6053588
Updating learning rate to 0.00027468984115
Validation loss decreased (0.6054 --> 0.6031).  Saving model state dict ...
Epoch: 2 cost time: 0.460235595703125
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6030813 Best vali loss: 0.6030813
Updating learning rate to 0.000137344920575
Epoch: 3 cost time: 0.47382545471191406
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6053193 Best vali loss: 0.6030813

best validation loss 0.6030813182520127

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011869092877, 'e_layers': 4, 'learning_rate': 0.0006116296897, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005883509207450297
Validation loss decreased (inf --> 0.6167).  Saving model state dict ...
Epoch: 1 cost time: 1.3984606266021729
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6166687 Best vali loss: 0.6166687
Updating learning rate to 0.0005220585954309469
Epoch: 2 cost time: 0.9907166957855225
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6175159 Best vali loss: 0.6166687
Updating learning rate to 0.00042284511934539536
Validation loss decreased (0.6167 --> 0.5972).  Saving model state dict ...
Epoch: 3 cost time: 0.9975388050079346
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5972067 Best vali loss: 0.5972067

best validation loss 0.5972066752229891

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0024158334153, 'e_layers': 4, 'learning_rate': 5.15091965e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8633272
	speed: 0.0225s/iter; left time: 19.8820s
Updating learning rate to 4.9548744441226004e-05
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 2.342393636703491
Epoch: 1, Steps: 123 | Train Loss: 0.8633272 Vali Loss: 0.6076806 Best vali loss: 0.6076806
	iters: 100, epoch: 2 | loss: 0.7074473
	speed: 0.0229s/iter; left time: 17.4203s
Updating learning rate to 4.396584931931019e-05
Validation loss decreased (0.6077 --> 0.5941).  Saving model state dict ...
Epoch: 2 cost time: 2.0164105892181396
Epoch: 2, Steps: 123 | Train Loss: 0.7074473 Vali Loss: 0.5941347 Best vali loss: 0.5941347
	iters: 100, epoch: 3 | loss: 0.8427143
	speed: 0.0234s/iter; left time: 14.9208s
Updating learning rate to 3.561045630749393e-05
Epoch: 3 cost time: 2.0150797367095947
Epoch: 3, Steps: 123 | Train Loss: 0.8427143 Vali Loss: 0.5957731 Best vali loss: 0.5941347

best validation loss 0.5941346779238124

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0024158334153, 'e_layers': 4, 'learning_rate': 5.15091965e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8026389
	speed: 0.0224s/iter; left time: 11.5642s
Updating learning rate to 2.575459825e-05
Validation loss decreased (0.5941 --> 0.5761).  Saving model state dict ...
Epoch: 4 cost time: 2.185763120651245
Epoch: 4, Steps: 123 | Train Loss: 0.8026389 Vali Loss: 0.5760591 Best vali loss: 0.5760591
	iters: 100, epoch: 5 | loss: 0.6492743
	speed: 0.0230s/iter; left time: 9.0460s
Updating learning rate to 1.5898740192506066e-05
Epoch: 5 cost time: 2.014766216278076
Epoch: 5, Steps: 123 | Train Loss: 0.6492743 Vali Loss: 0.5772460 Best vali loss: 0.5760591
	iters: 100, epoch: 6 | loss: 0.7675569
	speed: 0.0225s/iter; left time: 6.0789s
Updating learning rate to 7.543347180689812e-06
Validation loss decreased (0.5761 --> 0.5727).  Saving model state dict ...
Epoch: 6 cost time: 2.007333755493164
Epoch: 6, Steps: 123 | Train Loss: 0.7675569 Vali Loss: 0.5727451 Best vali loss: 0.5727451
	iters: 100, epoch: 7 | loss: 1.0023082
	speed: 0.0217s/iter; left time: 3.1876s
Updating learning rate to 1.9604520587739963e-06
Validation loss decreased (0.5727 --> 0.5604).  Saving model state dict ...
Epoch: 7 cost time: 1.8600516319274902
Epoch: 7, Steps: 123 | Train Loss: 1.0023082 Vali Loss: 0.5604230 Best vali loss: 0.5604230
	iters: 100, epoch: 8 | loss: 0.7322457
	speed: 0.0221s/iter; left time: 0.5306s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9643471240997314
Epoch: 8, Steps: 123 | Train Loss: 0.7322457 Vali Loss: 0.5635445 Best vali loss: 0.5604230

best validation loss 0.5604229682521211

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003920399489, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003920399489
Validation loss decreased (inf --> 0.6025).  Saving model state dict ...
Epoch: 1 cost time: 0.8648777008056641
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6025057 Best vali loss: 0.6025057
Updating learning rate to 0.00019601997445
Validation loss decreased (0.6025 --> 0.5999).  Saving model state dict ...
Epoch: 2 cost time: 0.5329196453094482
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5999124 Best vali loss: 0.5999124
Updating learning rate to 9.8009987225e-05
Validation loss decreased (0.5999 --> 0.5673).  Saving model state dict ...
Epoch: 3 cost time: 0.5472543239593506
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5673185 Best vali loss: 0.5673185
Updating learning rate to 4.90049936125e-05
Epoch: 4 cost time: 0.5527243614196777
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5752570 Best vali loss: 0.5673185
Updating learning rate to 2.450249680625e-05
Validation loss decreased (0.5673 --> 0.5558).  Saving model state dict ...
Epoch: 5 cost time: 0.5362911224365234
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5557875 Best vali loss: 0.5557875
Updating learning rate to 1.2251248403125e-05
Epoch: 6 cost time: 0.5460724830627441
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5572604 Best vali loss: 0.5557875
Updating learning rate to 6.1256242015625e-06
Epoch: 7 cost time: 0.525184154510498
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5570070 Best vali loss: 0.5557875
Updating learning rate to 3.06281210078125e-06
Epoch: 8 cost time: 0.5425510406494141
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5613369 Best vali loss: 0.5557875

best validation loss 0.555787460829361

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0009370256828, 'e_layers': 1, 'learning_rate': 5.98025299e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.7526431633502125e-05
Validation loss decreased (inf --> 0.7064).  Saving model state dict ...
Epoch: 1 cost time: 0.7356810569763184
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7063797 Best vali loss: 0.7063797
Updating learning rate to 5.104465216220063e-05
Validation loss decreased (0.7064 --> 0.6983).  Saving model state dict ...
Epoch: 2 cost time: 0.4558374881744385
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6983411 Best vali loss: 0.6983411
Updating learning rate to 4.1343983653123954e-05
Validation loss decreased (0.6983 --> 0.6915).  Saving model state dict ...
Epoch: 3 cost time: 0.4593627452850342
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6915279 Best vali loss: 0.6915279
Updating learning rate to 2.990126495e-05
Validation loss decreased (0.6915 --> 0.6862).  Saving model state dict ...
Epoch: 4 cost time: 0.4505579471588135
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6862141 Best vali loss: 0.6862141
Updating learning rate to 1.8458546246876045e-05
Validation loss decreased (0.6862 --> 0.6826).  Saving model state dict ...
Epoch: 5 cost time: 0.4551713466644287
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6825692 Best vali loss: 0.6825692
Updating learning rate to 8.757877737799368e-06
Validation loss decreased (0.6826 --> 0.6804).  Saving model state dict ...
Epoch: 6 cost time: 0.45848536491394043
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6803515 Best vali loss: 0.6803515
Updating learning rate to 2.276098266497876e-06
Validation loss decreased (0.6804 --> 0.6793).  Saving model state dict ...
Epoch: 7 cost time: 0.4188075065612793
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6793229 Best vali loss: 0.6793229
Updating learning rate to 0.0
Validation loss decreased (0.6793 --> 0.6791).  Saving model state dict ...
Epoch: 8 cost time: 0.4712390899658203
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6790527 Best vali loss: 0.6790527

best validation loss 0.6790526909775229

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032174734801, 'e_layers': 1, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0938269
	speed: 0.0125s/iter; left time: 23.2525s
	iters: 200, epoch: 1 | loss: 1.1463264
	speed: 0.0077s/iter; left time: 13.5207s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.6382).  Saving model state dict ...
Epoch: 1 cost time: 2.056056261062622
Epoch: 1, Steps: 245 | Train Loss: 1.1200767 Vali Loss: 0.6382357 Best vali loss: 0.6382357
	iters: 100, epoch: 2 | loss: 0.6179609
	speed: 0.0139s/iter; left time: 22.4040s
	iters: 200, epoch: 2 | loss: 0.9576403
	speed: 0.0041s/iter; left time: 6.2663s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.6382 --> 0.6170).  Saving model state dict ...
Epoch: 2 cost time: 1.171044111251831
Epoch: 2, Steps: 245 | Train Loss: 0.7878006 Vali Loss: 0.6169839 Best vali loss: 0.6169839
	iters: 100, epoch: 3 | loss: 0.7196979
	speed: 0.0132s/iter; left time: 18.1564s
	iters: 200, epoch: 3 | loss: 0.8734216
	speed: 0.0083s/iter; left time: 10.5460s
Updating learning rate to 0.0002042442000052176
Validation loss decreased (0.6170 --> 0.6039).  Saving model state dict ...
Epoch: 3 cost time: 2.0808494091033936
Epoch: 3, Steps: 245 | Train Loss: 0.7965598 Vali Loss: 0.6038812 Best vali loss: 0.6038812

best validation loss 0.6038811621926329

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0048029309342, 'e_layers': 3, 'learning_rate': 0.0041360832156, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5543238
	speed: 0.0172s/iter; left time: 133.2625s
	iters: 200, epoch: 1 | loss: 0.4596183
	speed: 0.0136s/iter; left time: 103.7916s
	iters: 300, epoch: 1 | loss: 0.4722757
	speed: 0.0102s/iter; left time: 77.0097s
	iters: 400, epoch: 1 | loss: 0.6318227
	speed: 0.0122s/iter; left time: 90.6811s
	iters: 500, epoch: 1 | loss: 0.7303660
	speed: 0.0147s/iter; left time: 108.0913s
	iters: 600, epoch: 1 | loss: 0.7171180
	speed: 0.0130s/iter; left time: 93.8200s
	iters: 700, epoch: 1 | loss: 1.2581824
	speed: 0.0162s/iter; left time: 115.3078s
	iters: 800, epoch: 1 | loss: 1.6662737
	speed: 0.0135s/iter; left time: 95.0735s
	iters: 900, epoch: 1 | loss: 0.7604917
	speed: 0.0150s/iter; left time: 103.9638s
Updating learning rate to 0.0041360832156
Validation loss decreased (inf --> 0.6463).  Saving model state dict ...
Epoch: 1 cost time: 13.431726455688477
Epoch: 1, Steps: 979 | Train Loss: 0.8056080 Vali Loss: 0.6463189 Best vali loss: 0.6463189
	iters: 100, epoch: 2 | loss: 0.6495874
	speed: 0.0650s/iter; left time: 439.1449s
	iters: 200, epoch: 2 | loss: 0.3570006
	speed: 0.0149s/iter; left time: 99.3737s
	iters: 300, epoch: 2 | loss: 0.8851853
	speed: 0.0078s/iter; left time: 50.8216s
	iters: 400, epoch: 2 | loss: 0.7482335
	speed: 0.0052s/iter; left time: 33.2927s
	iters: 500, epoch: 2 | loss: 0.6906522
	speed: 0.0064s/iter; left time: 40.8020s
	iters: 600, epoch: 2 | loss: 1.5804597
	speed: 0.0095s/iter; left time: 59.4412s
	iters: 700, epoch: 2 | loss: 0.9191482
	speed: 0.0106s/iter; left time: 65.1060s
	iters: 800, epoch: 2 | loss: 0.3389423
	speed: 0.0096s/iter; left time: 58.0352s
	iters: 900, epoch: 2 | loss: 0.8186520
	speed: 0.0074s/iter; left time: 44.0237s
Updating learning rate to 0.0020680416078
Epoch: 2 cost time: 9.534800291061401
Epoch: 2, Steps: 979 | Train Loss: 0.7764290 Vali Loss: 0.6492671 Best vali loss: 0.6463189
	iters: 100, epoch: 3 | loss: 1.0479653
	speed: 0.0435s/iter; left time: 251.3610s
	iters: 200, epoch: 3 | loss: 0.4304697
	speed: 0.0076s/iter; left time: 43.1313s
	iters: 300, epoch: 3 | loss: 0.4743392
	speed: 0.0124s/iter; left time: 69.2121s
	iters: 400, epoch: 3 | loss: 1.3285728
	speed: 0.0136s/iter; left time: 74.2326s
	iters: 500, epoch: 3 | loss: 0.8676824
	speed: 0.0140s/iter; left time: 75.4074s
	iters: 600, epoch: 3 | loss: 1.3573635
	speed: 0.0125s/iter; left time: 66.1987s
	iters: 700, epoch: 3 | loss: 0.4610989
	speed: 0.0158s/iter; left time: 81.8098s
	iters: 800, epoch: 3 | loss: 0.3771045
	speed: 0.0133s/iter; left time: 67.6380s
	iters: 900, epoch: 3 | loss: 1.0129086
	speed: 0.0111s/iter; left time: 55.0652s
Updating learning rate to 0.0010340208039
Epoch: 3 cost time: 12.635608911514282
Epoch: 3, Steps: 979 | Train Loss: 0.8175005 Vali Loss: 0.6493764 Best vali loss: 0.6463189

best validation loss 0.6463188613967066

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0018123888695, 'e_layers': 4, 'learning_rate': 0.0001970993665, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8070239
	speed: 0.0270s/iter; left time: 23.9023s
Updating learning rate to 0.0001970993665
Validation loss decreased (inf --> 0.6526).  Saving model state dict ...
Epoch: 1 cost time: 2.7761011123657227
Epoch: 1, Steps: 123 | Train Loss: 0.8070239 Vali Loss: 0.6526296 Best vali loss: 0.6526296
	iters: 100, epoch: 2 | loss: 0.6273813
	speed: 0.0256s/iter; left time: 19.5249s
Updating learning rate to 9.854968325e-05
Validation loss decreased (0.6526 --> 0.6336).  Saving model state dict ...
Epoch: 2 cost time: 1.84120774269104
Epoch: 2, Steps: 123 | Train Loss: 0.6273813 Vali Loss: 0.6335797 Best vali loss: 0.6335797
	iters: 100, epoch: 3 | loss: 0.8589304
	speed: 0.0310s/iter; left time: 19.7993s
Updating learning rate to 4.9274841625e-05
Validation loss decreased (0.6336 --> 0.6274).  Saving model state dict ...
Epoch: 3 cost time: 2.4672770500183105
Epoch: 3, Steps: 123 | Train Loss: 0.8589304 Vali Loss: 0.6273543 Best vali loss: 0.6273543

best validation loss 0.6273542509372452

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032174734801, 'e_layers': 1, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0287418
	speed: 0.0192s/iter; left time: 21.6425s
	iters: 200, epoch: 4 | loss: 1.1328321
	speed: 0.0120s/iter; left time: 12.3299s
Updating learning rate to 0.0001477158077
Epoch: 4 cost time: 3.368610382080078
Epoch: 4, Steps: 245 | Train Loss: 1.0807869 Vali Loss: 0.6130302 Best vali loss: 0.6038812
	iters: 100, epoch: 5 | loss: 0.6001053
	speed: 0.0267s/iter; left time: 23.5214s
	iters: 200, epoch: 5 | loss: 0.9219628
	speed: 0.0115s/iter; left time: 8.9519s
Updating learning rate to 9.118741539478246e-05
Validation loss decreased (0.6039 --> 0.6031).  Saving model state dict ...
Epoch: 5 cost time: 2.5540757179260254
Epoch: 5, Steps: 245 | Train Loss: 0.7610341 Vali Loss: 0.6030973 Best vali loss: 0.6030973
	iters: 100, epoch: 6 | loss: 0.7144994
	speed: 0.0265s/iter; left time: 16.8692s
	iters: 200, epoch: 6 | loss: 0.8463815
	speed: 0.0092s/iter; left time: 4.9547s
Updating learning rate to 4.326495838688198e-05
Validation loss decreased (0.6031 --> 0.6012).  Saving model state dict ...
Epoch: 6 cost time: 2.1565773487091064
Epoch: 6, Steps: 245 | Train Loss: 0.7804404 Vali Loss: 0.6012017 Best vali loss: 0.6012017
	iters: 100, epoch: 7 | loss: 0.4631358
	speed: 0.0319s/iter; left time: 12.4711s
	iters: 200, epoch: 7 | loss: 0.6313472
	speed: 0.0124s/iter; left time: 3.6153s
Updating learning rate to 1.124419633759687e-05
Validation loss decreased (0.6012 --> 0.6010).  Saving model state dict ...
Epoch: 7 cost time: 3.1832759380340576
Epoch: 7, Steps: 245 | Train Loss: 0.5472415 Vali Loss: 0.6009510 Best vali loss: 0.6009510
	iters: 100, epoch: 8 | loss: 0.7229078
	speed: 0.0314s/iter; left time: 4.5792s
	iters: 200, epoch: 8 | loss: 0.6125765
	speed: 0.0142s/iter; left time: 0.6546s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.312652349472046
Epoch: 8, Steps: 245 | Train Loss: 0.6677422 Vali Loss: 0.6016610 Best vali loss: 0.6009510

best validation loss 0.6009509604543185

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0013503779473, 'e_layers': 3, 'learning_rate': 0.0001206404714, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9328830
	speed: 0.0209s/iter; left time: 18.4985s
Updating learning rate to 0.00011604886685948663
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 2.056497573852539
Epoch: 1, Steps: 123 | Train Loss: 0.9328830 Vali Loss: 0.6020252 Best vali loss: 0.6020252
	iters: 100, epoch: 2 | loss: 0.8960365
	speed: 0.0328s/iter; left time: 25.0121s
Updating learning rate to 0.00010297308340624088
Validation loss decreased (0.6020 --> 0.5484).  Saving model state dict ...
Epoch: 2 cost time: 2.7095935344696045
Epoch: 2, Steps: 123 | Train Loss: 0.8960365 Vali Loss: 0.5484400 Best vali loss: 0.5484400
	iters: 100, epoch: 3 | loss: 0.7233018
	speed: 0.0285s/iter; left time: 18.2386s
Updating learning rate to 8.340379053874723e-05
Validation loss decreased (0.5484 --> 0.5467).  Saving model state dict ...
Epoch: 3 cost time: 1.6397638320922852
Epoch: 3, Steps: 123 | Train Loss: 0.7233018 Vali Loss: 0.5467149 Best vali loss: 0.5467149
	iters: 100, epoch: 4 | loss: 0.8687727
	speed: 0.0261s/iter; left time: 13.4596s
Updating learning rate to 6.03202357e-05
Epoch: 4 cost time: 2.1263234615325928
Epoch: 4, Steps: 123 | Train Loss: 0.8687727 Vali Loss: 0.5579047 Best vali loss: 0.5467149
	iters: 100, epoch: 5 | loss: 0.8291793
	speed: 0.0239s/iter; left time: 9.3811s
Updating learning rate to 3.723668086125278e-05
Epoch: 5 cost time: 1.946660041809082
Epoch: 5, Steps: 123 | Train Loss: 0.8291793 Vali Loss: 0.5498446 Best vali loss: 0.5467149
	iters: 100, epoch: 6 | loss: 0.9208543
	speed: 0.0226s/iter; left time: 6.1025s
Updating learning rate to 1.7667387993759133e-05
Validation loss decreased (0.5467 --> 0.5448).  Saving model state dict ...
Epoch: 6 cost time: 1.9688200950622559
Epoch: 6, Steps: 123 | Train Loss: 0.9208543 Vali Loss: 0.5447831 Best vali loss: 0.5447831
	iters: 100, epoch: 7 | loss: 0.6440729
	speed: 0.0240s/iter; left time: 3.5310s
Updating learning rate to 4.591604540513372e-06
Validation loss decreased (0.5448 --> 0.5446).  Saving model state dict ...
Epoch: 7 cost time: 1.9814410209655762
Epoch: 7, Steps: 123 | Train Loss: 0.6440729 Vali Loss: 0.5446036 Best vali loss: 0.5446036
	iters: 100, epoch: 8 | loss: 0.9153636
	speed: 0.0187s/iter; left time: 0.4486s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5241780281066895
Epoch: 8, Steps: 123 | Train Loss: 0.9153636 Vali Loss: 0.5451688 Best vali loss: 0.5446036

best validation loss 0.5446036271009661

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.001776105869, 'e_layers': 2, 'learning_rate': 0.0032448267506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3355362
	speed: 0.0111s/iter; left time: 85.9892s
	iters: 200, epoch: 1 | loss: 0.6073617
	speed: 0.0065s/iter; left time: 49.5852s
	iters: 300, epoch: 1 | loss: 1.2509074
	speed: 0.0073s/iter; left time: 55.2458s
	iters: 400, epoch: 1 | loss: 0.3252491
	speed: 0.0074s/iter; left time: 55.2598s
	iters: 500, epoch: 1 | loss: 1.9091460
	speed: 0.0053s/iter; left time: 38.7213s
	iters: 600, epoch: 1 | loss: 1.7808346
	speed: 0.0046s/iter; left time: 33.5495s
	iters: 700, epoch: 1 | loss: 0.3650955
	speed: 0.0071s/iter; left time: 50.3187s
	iters: 800, epoch: 1 | loss: 0.7197506
	speed: 0.0072s/iter; left time: 50.9238s
	iters: 900, epoch: 1 | loss: 1.2265056
	speed: 0.0072s/iter; left time: 49.7073s
Updating learning rate to 0.0032448267506
Validation loss decreased (inf --> 0.6542).  Saving model state dict ...
Epoch: 1 cost time: 6.698767185211182
Epoch: 1, Steps: 979 | Train Loss: 1.0578207 Vali Loss: 0.6541950 Best vali loss: 0.6541950
	iters: 100, epoch: 2 | loss: 1.1832731
	speed: 0.0243s/iter; left time: 163.9064s
	iters: 200, epoch: 2 | loss: 0.3931371
	speed: 0.0049s/iter; left time: 32.2952s
	iters: 300, epoch: 2 | loss: 0.8697286
	speed: 0.0049s/iter; left time: 32.0704s
	iters: 400, epoch: 2 | loss: 0.6991639
	speed: 0.0052s/iter; left time: 33.6976s
	iters: 500, epoch: 2 | loss: 1.4108068
	speed: 0.0058s/iter; left time: 37.0561s
	iters: 600, epoch: 2 | loss: 1.4945667
	speed: 0.0057s/iter; left time: 35.8799s
	iters: 700, epoch: 2 | loss: 1.7532704
	speed: 0.0055s/iter; left time: 33.6303s
	iters: 800, epoch: 2 | loss: 0.8119065
	speed: 0.0057s/iter; left time: 34.3440s
	iters: 900, epoch: 2 | loss: 1.1284779
	speed: 0.0056s/iter; left time: 33.6213s
Updating learning rate to 0.0016224133753
Validation loss decreased (0.6542 --> 0.6425).  Saving model state dict ...
Epoch: 2 cost time: 5.327996492385864
Epoch: 2, Steps: 979 | Train Loss: 1.0827034 Vali Loss: 0.6425273 Best vali loss: 0.6425273
	iters: 100, epoch: 3 | loss: 0.6165776
	speed: 0.0195s/iter; left time: 112.8594s
	iters: 200, epoch: 3 | loss: 1.2564114
	speed: 0.0055s/iter; left time: 31.1845s
	iters: 300, epoch: 3 | loss: 0.4274906
	speed: 0.0057s/iter; left time: 31.6356s
	iters: 400, epoch: 3 | loss: 0.5862353
	speed: 0.0057s/iter; left time: 31.4749s
	iters: 500, epoch: 3 | loss: 0.7744154
	speed: 0.0057s/iter; left time: 30.7567s
	iters: 600, epoch: 3 | loss: 0.7524611
	speed: 0.0055s/iter; left time: 29.1136s
	iters: 700, epoch: 3 | loss: 0.4196993
	speed: 0.0055s/iter; left time: 28.3212s
	iters: 800, epoch: 3 | loss: 0.9369432
	speed: 0.0057s/iter; left time: 28.8661s
	iters: 900, epoch: 3 | loss: 0.3263833
	speed: 0.0057s/iter; left time: 28.1563s
Updating learning rate to 0.00081120668765
Epoch: 3 cost time: 5.521042346954346
Epoch: 3, Steps: 979 | Train Loss: 0.6774019 Vali Loss: 0.6529786 Best vali loss: 0.6425273
	iters: 100, epoch: 4 | loss: 0.6957268
	speed: 0.0200s/iter; left time: 95.9973s
	iters: 200, epoch: 4 | loss: 1.0546658
	speed: 0.0052s/iter; left time: 24.6376s
	iters: 300, epoch: 4 | loss: 1.5092057
	speed: 0.0044s/iter; left time: 20.0211s
	iters: 400, epoch: 4 | loss: 0.9932113
	speed: 0.0043s/iter; left time: 19.2417s
	iters: 500, epoch: 4 | loss: 0.2903802
	speed: 0.0050s/iter; left time: 22.1681s
	iters: 600, epoch: 4 | loss: 0.3964148
	speed: 0.0080s/iter; left time: 34.2319s
	iters: 700, epoch: 4 | loss: 1.4278440
	speed: 0.0079s/iter; left time: 33.2559s
	iters: 800, epoch: 4 | loss: 1.1401536
	speed: 0.0081s/iter; left time: 33.0926s
	iters: 900, epoch: 4 | loss: 0.6394504
	speed: 0.0080s/iter; left time: 31.8565s
Updating learning rate to 0.000405603343825
Epoch: 4 cost time: 6.307622194290161
Epoch: 4, Steps: 979 | Train Loss: 0.9052281 Vali Loss: 0.6447246 Best vali loss: 0.6425273
	iters: 100, epoch: 5 | loss: 0.6187332
	speed: 0.0229s/iter; left time: 87.3112s
	iters: 200, epoch: 5 | loss: 1.4180732
	speed: 0.0086s/iter; left time: 31.9318s
	iters: 300, epoch: 5 | loss: 0.9073198
	speed: 0.0084s/iter; left time: 30.4582s
	iters: 400, epoch: 5 | loss: 0.8659527
	speed: 0.0078s/iter; left time: 27.5994s
	iters: 500, epoch: 5 | loss: 0.6546414
	speed: 0.0079s/iter; left time: 27.1292s
	iters: 600, epoch: 5 | loss: 1.3210213
	speed: 0.0132s/iter; left time: 43.6951s
	iters: 700, epoch: 5 | loss: 0.7420566
	speed: 0.0127s/iter; left time: 40.7586s
	iters: 800, epoch: 5 | loss: 0.5335599
	speed: 0.0122s/iter; left time: 37.9232s
	iters: 900, epoch: 5 | loss: 2.0974374
	speed: 0.0101s/iter; left time: 30.4127s
Updating learning rate to 0.0002028016719125
Epoch: 5 cost time: 9.486134767532349
Epoch: 5, Steps: 979 | Train Loss: 1.0176439 Vali Loss: 0.6440400 Best vali loss: 0.6425273
	iters: 100, epoch: 6 | loss: 0.4340942
	speed: 0.0598s/iter; left time: 169.6632s
	iters: 200, epoch: 6 | loss: 0.6787029
	speed: 0.0098s/iter; left time: 26.9287s
	iters: 300, epoch: 6 | loss: 0.8549406
	speed: 0.0104s/iter; left time: 27.4297s
	iters: 400, epoch: 6 | loss: 0.6247714
	speed: 0.0115s/iter; left time: 29.2045s
	iters: 500, epoch: 6 | loss: 0.3828419
	speed: 0.0056s/iter; left time: 13.7072s
	iters: 600, epoch: 6 | loss: 1.6185519
	speed: 0.0044s/iter; left time: 10.1877s
	iters: 700, epoch: 6 | loss: 0.3972732
	speed: 0.0049s/iter; left time: 10.9960s
	iters: 800, epoch: 6 | loss: 1.0557508
	speed: 0.0069s/iter; left time: 14.7299s
	iters: 900, epoch: 6 | loss: 0.7755051
	speed: 0.0118s/iter; left time: 24.0339s
Updating learning rate to 0.00010140083595625
Epoch: 6 cost time: 8.305790901184082
Epoch: 6, Steps: 979 | Train Loss: 0.7580480 Vali Loss: 0.6437205 Best vali loss: 0.6425273
	iters: 100, epoch: 7 | loss: 0.8139780
	speed: 0.0376s/iter; left time: 69.8678s
	iters: 200, epoch: 7 | loss: 0.4074616
	speed: 0.0124s/iter; left time: 21.8082s
	iters: 300, epoch: 7 | loss: 0.4427616
	speed: 0.0110s/iter; left time: 18.3187s
	iters: 400, epoch: 7 | loss: 1.4118236
	speed: 0.0131s/iter; left time: 20.4229s
	iters: 500, epoch: 7 | loss: 0.5249181
	speed: 0.0093s/iter; left time: 13.5736s
	iters: 600, epoch: 7 | loss: 0.7714903
	speed: 0.0135s/iter; left time: 18.2960s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0039792071051, 'e_layers': 4, 'learning_rate': 0.0015522577592, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014931784660533567
Validation loss decreased (inf --> 0.6271).  Saving model state dict ...
Epoch: 1 cost time: 1.5344932079315186
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6270525 Best vali loss: 0.6270525
Updating learning rate to 0.0013249348734398773
Validation loss decreased (0.6271 --> 0.6090).  Saving model state dict ...
Epoch: 2 cost time: 1.1572835445404053
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6090095 Best vali loss: 0.6090095
Updating learning rate to 0.0010731405432029995
Validation loss decreased (0.6090 --> 0.5989).  Saving model state dict ...
Epoch: 3 cost time: 1.455793857574463
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5988654 Best vali loss: 0.5988654

best validation loss 0.5988653847212485

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.001507338874, 'e_layers': 4, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0032988
	speed: 0.0237s/iter; left time: 20.9468s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.6150).  Saving model state dict ...
Epoch: 1 cost time: 2.364166021347046
Epoch: 1, Steps: 123 | Train Loss: 1.0032988 Vali Loss: 0.6150237 Best vali loss: 0.6150237
	iters: 100, epoch: 2 | loss: 0.7392440
	speed: 0.0187s/iter; left time: 14.2291s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.6150 --> 0.6067).  Saving model state dict ...
Epoch: 2 cost time: 1.5498754978179932
Epoch: 2, Steps: 123 | Train Loss: 0.7392440 Vali Loss: 0.6067115 Best vali loss: 0.6067115
	iters: 100, epoch: 3 | loss: 0.8592805
	speed: 0.0165s/iter; left time: 10.5339s
Updating learning rate to 1.70765195e-05
Validation loss decreased (0.6067 --> 0.6001).  Saving model state dict ...
Epoch: 3 cost time: 1.363999605178833
Epoch: 3, Steps: 123 | Train Loss: 0.8592805 Vali Loss: 0.6000805 Best vali loss: 0.6000805

best validation loss 0.6000804776452526

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0011651101235, 'e_layers': 4, 'learning_rate': 0.0001196858658, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9641019
	speed: 0.0196s/iter; left time: 36.5621s
	iters: 200, epoch: 1 | loss: 0.9157865
	speed: 0.0112s/iter; left time: 19.7040s
Updating learning rate to 0.00011513059377175631
Validation loss decreased (inf --> 0.6191).  Saving model state dict ...
Epoch: 1 cost time: 3.259244680404663
Epoch: 1, Steps: 245 | Train Loss: 0.9399442 Vali Loss: 0.6191305 Best vali loss: 0.6191305
	iters: 100, epoch: 2 | loss: 0.8858449
	speed: 0.0211s/iter; left time: 34.0788s
	iters: 200, epoch: 2 | loss: 0.9271880
	speed: 0.0100s/iter; left time: 15.1494s
Updating learning rate to 0.00010215827655968155
Validation loss decreased (0.6191 --> 0.6041).  Saving model state dict ...
Epoch: 2 cost time: 2.777204751968384
Epoch: 2, Steps: 245 | Train Loss: 0.9065164 Vali Loss: 0.6040968 Best vali loss: 0.6040968
	iters: 100, epoch: 3 | loss: 0.6862885
	speed: 0.0226s/iter; left time: 30.9728s
	iters: 200, epoch: 3 | loss: 0.6576015
	speed: 0.0123s/iter; left time: 15.5825s
Updating learning rate to 8.274383186496576e-05
Validation loss decreased (0.6041 --> 0.5850).  Saving model state dict ...
Epoch: 3 cost time: 3.0337228775024414
Epoch: 3, Steps: 245 | Train Loss: 0.6719450 Vali Loss: 0.5849636 Best vali loss: 0.5849636

best validation loss 0.584963583135318

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0011651101235, 'e_layers': 4, 'learning_rate': 0.0001196858658, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7911862
	speed: 0.0189s/iter; left time: 21.3014s
	iters: 200, epoch: 4 | loss: 0.8595651
	speed: 0.0116s/iter; left time: 11.8813s
Updating learning rate to 5.98429329e-05
Validation loss decreased (0.5850 --> 0.5697).  Saving model state dict ...
Epoch: 4 cost time: 3.1893439292907715
Epoch: 4, Steps: 245 | Train Loss: 0.8253756 Vali Loss: 0.5696994 Best vali loss: 0.5696994
	iters: 100, epoch: 5 | loss: 0.7145959
	speed: 0.0218s/iter; left time: 19.1969s
	iters: 200, epoch: 5 | loss: 0.8191491
	speed: 0.0116s/iter; left time: 9.0455s
Updating learning rate to 3.6942033935034246e-05
Validation loss decreased (0.5697 --> 0.5567).  Saving model state dict ...
Epoch: 5 cost time: 2.9202516078948975
Epoch: 5, Steps: 245 | Train Loss: 0.7668725 Vali Loss: 0.5566501 Best vali loss: 0.5566501
	iters: 100, epoch: 6 | loss: 0.6441895
	speed: 0.0221s/iter; left time: 14.0406s
	iters: 200, epoch: 6 | loss: 0.5318049
	speed: 0.0105s/iter; left time: 5.6428s
Updating learning rate to 1.7527589240318458e-05
Validation loss decreased (0.5567 --> 0.5514).  Saving model state dict ...
Epoch: 6 cost time: 2.6782078742980957
Epoch: 6, Steps: 245 | Train Loss: 0.5879972 Vali Loss: 0.5514159 Best vali loss: 0.5514159
	iters: 100, epoch: 7 | loss: 0.7761611
	speed: 0.0182s/iter; left time: 7.1072s
	iters: 200, epoch: 7 | loss: 0.7159700
	speed: 0.0114s/iter; left time: 3.3147s
Updating learning rate to 4.555272028243699e-06
Epoch: 7 cost time: 2.6961865425109863
Epoch: 7, Steps: 245 | Train Loss: 0.7460655 Vali Loss: 0.5543997 Best vali loss: 0.5514159
	iters: 100, epoch: 8 | loss: 0.9176841
	speed: 0.0174s/iter; left time: 2.5437s
	iters: 200, epoch: 8 | loss: 0.6904765
	speed: 0.0123s/iter; left time: 0.5676s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.788613796234131
Epoch: 8, Steps: 245 | Train Loss: 0.8040803 Vali Loss: 0.5539363 Best vali loss: 0.5514159

best validation loss 0.5514158783053866

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0014886121307, 'e_layers': 1, 'learning_rate': 8.87995762e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.87995762e-05
Validation loss decreased (inf --> 0.6724).  Saving model state dict ...
Epoch: 1 cost time: 0.7981259822845459
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6723708 Best vali loss: 0.6723708
Updating learning rate to 4.43997881e-05
Validation loss decreased (0.6724 --> 0.6445).  Saving model state dict ...
Epoch: 2 cost time: 0.4554903507232666
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6445155 Best vali loss: 0.6445155
Updating learning rate to 2.219989405e-05
Validation loss decreased (0.6445 --> 0.6344).  Saving model state dict ...
Epoch: 3 cost time: 0.44969916343688965
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6344098 Best vali loss: 0.6344098
Updating learning rate to 1.1099947025e-05
Validation loss decreased (0.6344 --> 0.6300).  Saving model state dict ...
Epoch: 4 cost time: 0.4541506767272949
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6299706 Best vali loss: 0.6299706
Updating learning rate to 5.5499735125e-06
Validation loss decreased (0.6300 --> 0.6282).  Saving model state dict ...
Epoch: 5 cost time: 0.44753479957580566
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6281731 Best vali loss: 0.6281731
Updating learning rate to 2.77498675625e-06
Validation loss decreased (0.6282 --> 0.6273).  Saving model state dict ...
Epoch: 6 cost time: 0.46688055992126465
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6272662 Best vali loss: 0.6272662
Updating learning rate to 1.387493378125e-06
Validation loss decreased (0.6273 --> 0.6268).  Saving model state dict ...
Epoch: 7 cost time: 0.47563672065734863
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6267920 Best vali loss: 0.6267920
Updating learning rate to 6.937466890625e-07
Validation loss decreased (0.6268 --> 0.6266).  Saving model state dict ...
Epoch: 8 cost time: 0.46123385429382324
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6265518 Best vali loss: 0.6265518

best validation loss 0.6265517588789294

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010826978283, 'e_layers': 3, 'learning_rate': 0.000733585835, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4620650
	speed: 0.0170s/iter; left time: 64.9407s
	iters: 200, epoch: 1 | loss: 0.7978627
	speed: 0.0098s/iter; left time: 36.6350s
	iters: 300, epoch: 1 | loss: 0.8089733
	speed: 0.0094s/iter; left time: 34.0559s
	iters: 400, epoch: 1 | loss: 0.9908828
	speed: 0.0088s/iter; left time: 30.9969s
Updating learning rate to 0.000733585835
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 5.016011953353882
Epoch: 1, Steps: 490 | Train Loss: 0.7649459 Vali Loss: 0.6073560 Best vali loss: 0.6073560
	iters: 100, epoch: 2 | loss: 0.6977006
	speed: 0.0255s/iter; left time: 84.7834s
	iters: 200, epoch: 2 | loss: 0.7612135
	speed: 0.0100s/iter; left time: 32.1589s
	iters: 300, epoch: 2 | loss: 0.7007305
	speed: 0.0098s/iter; left time: 30.7622s
	iters: 400, epoch: 2 | loss: 1.0189060
	speed: 0.0099s/iter; left time: 29.9700s
Updating learning rate to 0.0003667929175
Epoch: 2 cost time: 4.887829542160034
Epoch: 2, Steps: 490 | Train Loss: 0.7946377 Vali Loss: 0.6264266 Best vali loss: 0.6073560
	iters: 100, epoch: 3 | loss: 1.0418710
	speed: 0.0242s/iter; left time: 68.6308s
	iters: 200, epoch: 3 | loss: 1.3147402
	speed: 0.0097s/iter; left time: 26.6264s
	iters: 300, epoch: 3 | loss: 1.7187787
	speed: 0.0100s/iter; left time: 26.2782s
	iters: 400, epoch: 3 | loss: 0.9921757
	speed: 0.0098s/iter; left time: 24.9962s
Updating learning rate to 0.00018339645875
Epoch: 3 cost time: 4.7495105266571045
Epoch: 3, Steps: 490 | Train Loss: 1.2668914 Vali Loss: 0.6107662 Best vali loss: 0.6073560
	iters: 100, epoch: 4 | loss: 0.6526775
	speed: 0.0262s/iter; left time: 61.6203s
	iters: 200, epoch: 4 | loss: 0.8468891
	speed: 0.0094s/iter; left time: 21.2208s
	iters: 300, epoch: 4 | loss: 0.6153428
	speed: 0.0097s/iter; left time: 20.9389s
	iters: 400, epoch: 4 | loss: 0.9683319
	speed: 0.0109s/iter; left time: 22.2923s
Updating learning rate to 9.1698229375e-05
Epoch: 4 cost time: 4.945716619491577
Epoch: 4, Steps: 490 | Train Loss: 0.7708103 Vali Loss: 0.6147262 Best vali loss: 0.6073560
	iters: 100, epoch: 5 | loss: 0.4888034
	speed: 0.0270s/iter; left time: 50.3168s
	iters: 200, epoch: 5 | loss: 1.4185559
	speed: 0.0112s/iter; left time: 19.7513s
	iters: 300, epoch: 5 | loss: 0.6125001
	speed: 0.0093s/iter; left time: 15.4974s
	iters: 400, epoch: 5 | loss: 0.8833632
	speed: 0.0112s/iter; left time: 17.5451s
Updating learning rate to 4.58491146875e-05
Epoch: 5 cost time: 6.335805654525757
Epoch: 5, Steps: 490 | Train Loss: 0.8508056 Vali Loss: 0.6131047 Best vali loss: 0.6073560
	iters: 100, epoch: 6 | loss: 0.9993359
	speed: 0.0966s/iter; left time: 132.4896s
	iters: 200, epoch: 6 | loss: 0.6193799
	speed: 0.0259s/iter; left time: 32.8958s
	iters: 300, epoch: 6 | loss: 0.5498961
	speed: 0.0236s/iter; left time: 27.6912s
	iters: 400, epoch: 6 | loss: 0.6894331
	speed: 0.0227s/iter; left time: 24.3172s
Updating learning rate to 2.292455734375e-05
Epoch: 6 cost time: 11.469856262207031
Epoch: 6, Steps: 490 | Train Loss: 0.7145112 Vali Loss: 0.6211727 Best vali loss: 0.6073560
	iters: 100, epoch: 7 | loss: 0.8958690
	speed: 0.0944s/iter; left time: 83.1375s
	iters: 200, epoch: 7 | loss: 0.3999996
	speed: 0.0251s/iter; left time: 19.5830s
	iters: 300, epoch: 7 | loss: 1.1415160
	speed: 0.0214s/iter; left time: 14.5571s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0051497513565, 'e_layers': 1, 'learning_rate': 0.0002849508877, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002849508877
Validation loss decreased (inf --> 0.6263).  Saving model state dict ...
Epoch: 1 cost time: 2.6870014667510986
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6263138 Best vali loss: 0.6263138
Updating learning rate to 0.00014247544385
Validation loss decreased (0.6263 --> 0.6079).  Saving model state dict ...
Epoch: 2 cost time: 2.6222410202026367
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6078508 Best vali loss: 0.6078508
Updating learning rate to 7.1237721925e-05
Validation loss decreased (0.6079 --> 0.6046).  Saving model state dict ...
Epoch: 3 cost time: 1.67803955078125
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6045995 Best vali loss: 0.6045995

best validation loss 0.6045995322657316

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0031640813448, 'e_layers': 4, 'learning_rate': 0.002125626793, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8875023
	speed: 0.0185s/iter; left time: 70.7519s
	iters: 200, epoch: 1 | loss: 0.6890411
	speed: 0.0160s/iter; left time: 59.7014s
	iters: 300, epoch: 1 | loss: 0.9189879
	speed: 0.0119s/iter; left time: 42.9151s
	iters: 400, epoch: 1 | loss: 1.0607276
	speed: 0.0121s/iter; left time: 42.5836s
Updating learning rate to 0.002044724940405153
Validation loss decreased (inf --> 0.6264).  Saving model state dict ...
Epoch: 1 cost time: 6.621440410614014
Epoch: 1, Steps: 490 | Train Loss: 0.8890647 Vali Loss: 0.6264426 Best vali loss: 0.6264426
	iters: 100, epoch: 2 | loss: 1.4541738
	speed: 0.0328s/iter; left time: 109.3155s
	iters: 200, epoch: 2 | loss: 1.0943919
	speed: 0.0121s/iter; left time: 39.0850s
	iters: 300, epoch: 2 | loss: 0.7993333
	speed: 0.0121s/iter; left time: 37.9898s
	iters: 400, epoch: 2 | loss: 0.6555306
	speed: 0.0083s/iter; left time: 25.0570s
Updating learning rate to 0.0018143359563010568
Epoch: 2 cost time: 5.350867033004761
Epoch: 2, Steps: 490 | Train Loss: 1.0008574 Vali Loss: 0.6444987 Best vali loss: 0.6264426
	iters: 100, epoch: 3 | loss: 1.2652615
	speed: 0.0275s/iter; left time: 78.1054s
	iters: 200, epoch: 3 | loss: 1.1734046
	speed: 0.0094s/iter; left time: 25.8432s
	iters: 300, epoch: 3 | loss: 0.4982130
	speed: 0.0102s/iter; left time: 27.0596s
	iters: 400, epoch: 3 | loss: 0.5724301
	speed: 0.0103s/iter; left time: 26.1965s
Updating learning rate to 0.0014695344750362193
Epoch: 3 cost time: 4.981503963470459
Epoch: 3, Steps: 490 | Train Loss: 0.8773273 Vali Loss: 0.6407395 Best vali loss: 0.6264426

best validation loss 0.6264426184163938

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0097583782409, 'e_layers': 4, 'learning_rate': 0.0001196486596, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5246416
	speed: 0.0144s/iter; left time: 55.2086s
	iters: 200, epoch: 1 | loss: 0.9454793
	speed: 0.0126s/iter; left time: 46.9319s
	iters: 300, epoch: 1 | loss: 0.5371502
	speed: 0.0151s/iter; left time: 54.8567s
	iters: 400, epoch: 1 | loss: 0.9604310
	speed: 0.0173s/iter; left time: 60.8818s
Updating learning rate to 0.00011509480364842505
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 7.255418062210083
Epoch: 1, Steps: 490 | Train Loss: 0.7419255 Vali Loss: 0.6064981 Best vali loss: 0.6064981
	iters: 100, epoch: 2 | loss: 1.2654772
	speed: 0.0416s/iter; left time: 138.6388s
	iters: 200, epoch: 2 | loss: 1.6144109
	speed: 0.0142s/iter; left time: 45.8688s
	iters: 300, epoch: 2 | loss: 1.0568619
	speed: 0.0180s/iter; left time: 56.3227s
	iters: 400, epoch: 2 | loss: 0.9045376
	speed: 0.0196s/iter; left time: 59.3903s
Updating learning rate to 0.00010212651908152045
Validation loss decreased (0.6065 --> 0.5999).  Saving model state dict ...
Epoch: 2 cost time: 7.542514324188232
Epoch: 2, Steps: 490 | Train Loss: 1.2103219 Vali Loss: 0.5998511 Best vali loss: 0.5998511
	iters: 100, epoch: 3 | loss: 0.7468984
	speed: 0.0475s/iter; left time: 135.0558s
	iters: 200, epoch: 3 | loss: 0.6036636
	speed: 0.0126s/iter; left time: 34.5875s
	iters: 300, epoch: 3 | loss: 0.8737684
	speed: 0.0109s/iter; left time: 28.8444s
	iters: 400, epoch: 3 | loss: 0.5088425
	speed: 0.0101s/iter; left time: 25.7656s
Updating learning rate to 8.271810966680513e-05
Validation loss decreased (0.5999 --> 0.5914).  Saving model state dict ...
Epoch: 3 cost time: 5.9200263023376465
Epoch: 3, Steps: 490 | Train Loss: 0.6832932 Vali Loss: 0.5913531 Best vali loss: 0.5913531

best validation loss 0.5913531337276425

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0097583782409, 'e_layers': 4, 'learning_rate': 0.0001196486596, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4307035
	speed: 0.0202s/iter; left time: 47.5216s
	iters: 200, epoch: 4 | loss: 0.9698119
	speed: 0.0101s/iter; left time: 22.7965s
	iters: 300, epoch: 4 | loss: 0.5476906
	speed: 0.0086s/iter; left time: 18.4911s
	iters: 400, epoch: 4 | loss: 0.9002141
	speed: 0.0098s/iter; left time: 20.0852s
Updating learning rate to 5.98243298e-05
Validation loss decreased (0.5914 --> 0.5875).  Saving model state dict ...
Epoch: 4 cost time: 5.369829416275024
Epoch: 4, Steps: 490 | Train Loss: 0.7121050 Vali Loss: 0.5874932 Best vali loss: 0.5874932
	iters: 100, epoch: 5 | loss: 1.1317160
	speed: 0.0298s/iter; left time: 55.4924s
	iters: 200, epoch: 5 | loss: 1.1537890
	speed: 0.0101s/iter; left time: 17.7387s
	iters: 300, epoch: 5 | loss: 1.0825511
	speed: 0.0101s/iter; left time: 16.8579s
	iters: 400, epoch: 5 | loss: 0.7546099
	speed: 0.0103s/iter; left time: 16.1515s
Updating learning rate to 3.6930549933194876e-05
Validation loss decreased (0.5875 --> 0.5543).  Saving model state dict ...
Epoch: 5 cost time: 5.262438058853149
Epoch: 5, Steps: 490 | Train Loss: 1.0306665 Vali Loss: 0.5543417 Best vali loss: 0.5543417
	iters: 100, epoch: 6 | loss: 0.6359169
	speed: 0.0283s/iter; left time: 38.7982s
	iters: 200, epoch: 6 | loss: 0.5175519
	speed: 0.0098s/iter; left time: 12.4360s
	iters: 300, epoch: 6 | loss: 0.5704822
	speed: 0.0098s/iter; left time: 11.4228s
	iters: 400, epoch: 6 | loss: 0.4803299
	speed: 0.0099s/iter; left time: 10.5810s
Updating learning rate to 1.752214051847955e-05
Epoch: 6 cost time: 4.978221654891968
Epoch: 6, Steps: 490 | Train Loss: 0.5510702 Vali Loss: 0.5546335 Best vali loss: 0.5543417
	iters: 100, epoch: 7 | loss: 0.4920603
	speed: 0.0282s/iter; left time: 24.8262s
	iters: 200, epoch: 7 | loss: 0.6913972
	speed: 0.0099s/iter; left time: 7.7505s
	iters: 300, epoch: 7 | loss: 0.3577714
	speed: 0.0098s/iter; left time: 6.6961s
	iters: 400, epoch: 7 | loss: 1.1145202
	speed: 0.0099s/iter; left time: 5.7297s
Updating learning rate to 4.55385595157496e-06
Validation loss decreased (0.5543 --> 0.5529).  Saving model state dict ...
Epoch: 7 cost time: 5.076807260513306
Epoch: 7, Steps: 490 | Train Loss: 0.6639373 Vali Loss: 0.5528818 Best vali loss: 0.5528818
	iters: 100, epoch: 8 | loss: 1.0201679
	speed: 0.0264s/iter; left time: 10.3196s
	iters: 200, epoch: 8 | loss: 0.7236663
	speed: 0.0089s/iter; left time: 2.5961s
	iters: 300, epoch: 8 | loss: 0.6021501
	speed: 0.0108s/iter; left time: 2.0662s
	iters: 400, epoch: 8 | loss: 0.8341874
	speed: 0.0094s/iter; left time: 0.8544s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.742246627807617
Epoch: 8, Steps: 490 | Train Loss: 0.7950429 Vali Loss: 0.5552170 Best vali loss: 0.5528818

best validation loss 0.5528818000485531

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 7.41197855e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9582288
	speed: 0.0150s/iter; left time: 116.3011s
	iters: 200, epoch: 1 | loss: 1.2033995
	speed: 0.0088s/iter; left time: 66.8290s
	iters: 300, epoch: 1 | loss: 0.9368088
	speed: 0.0108s/iter; left time: 81.4330s
	iters: 400, epoch: 1 | loss: 0.3381588
	speed: 0.0099s/iter; left time: 73.8743s
	iters: 500, epoch: 1 | loss: 0.7248168
	speed: 0.0101s/iter; left time: 74.0930s
	iters: 600, epoch: 1 | loss: 1.5098139
	speed: 0.0105s/iter; left time: 75.6306s
	iters: 700, epoch: 1 | loss: 1.0371836
	speed: 0.0098s/iter; left time: 69.8093s
	iters: 800, epoch: 1 | loss: 1.4672545
	speed: 0.0096s/iter; left time: 67.2175s
	iters: 900, epoch: 1 | loss: 0.9304608
	speed: 0.0085s/iter; left time: 58.8904s
Updating learning rate to 7.129876913878843e-05
Validation loss decreased (inf --> 0.6105).  Saving model state dict ...
Epoch: 1 cost time: 9.836825132369995
Epoch: 1, Steps: 979 | Train Loss: 1.0117917 Vali Loss: 0.6104657 Best vali loss: 0.6104657
	iters: 100, epoch: 2 | loss: 0.3184938
	speed: 0.0318s/iter; left time: 214.8412s
	iters: 200, epoch: 2 | loss: 0.4625955
	speed: 0.0100s/iter; left time: 66.6165s
	iters: 300, epoch: 2 | loss: 1.3319793
	speed: 0.0100s/iter; left time: 65.4381s
	iters: 400, epoch: 2 | loss: 2.3524778
	speed: 0.0098s/iter; left time: 63.0522s
	iters: 500, epoch: 2 | loss: 0.4454388
	speed: 0.0091s/iter; left time: 57.6205s
	iters: 600, epoch: 2 | loss: 0.4424286
	speed: 0.0061s/iter; left time: 38.3315s
	iters: 700, epoch: 2 | loss: 0.2891754
	speed: 0.0063s/iter; left time: 38.5315s
	iters: 800, epoch: 2 | loss: 0.5498705
	speed: 0.0093s/iter; left time: 56.1725s
	iters: 900, epoch: 2 | loss: 0.6151317
	speed: 0.0093s/iter; left time: 55.2581s
Updating learning rate to 6.326519422357117e-05
Validation loss decreased (0.6105 --> 0.5715).  Saving model state dict ...
Epoch: 2 cost time: 8.762421607971191
Epoch: 2, Steps: 979 | Train Loss: 0.7563990 Vali Loss: 0.5715381 Best vali loss: 0.5715381
	iters: 100, epoch: 3 | loss: 1.1493354
	speed: 0.0292s/iter; left time: 168.7036s
	iters: 200, epoch: 3 | loss: 1.3123575
	speed: 0.0098s/iter; left time: 55.7549s
	iters: 300, epoch: 3 | loss: 1.1958834
	speed: 0.0091s/iter; left time: 50.7912s
	iters: 400, epoch: 3 | loss: 1.2900220
	speed: 0.0096s/iter; left time: 52.3084s
	iters: 500, epoch: 3 | loss: 0.3227955
	speed: 0.0094s/iter; left time: 50.4104s
	iters: 600, epoch: 3 | loss: 0.5720249
	speed: 0.0096s/iter; left time: 50.4592s
	iters: 700, epoch: 3 | loss: 0.3241936
	speed: 0.0091s/iter; left time: 47.0034s
	iters: 800, epoch: 3 | loss: 0.2796291
	speed: 0.0089s/iter; left time: 45.1118s
	iters: 900, epoch: 3 | loss: 0.5263506
	speed: 0.0093s/iter; left time: 46.5154s
Updating learning rate to 5.124209971065211e-05
Epoch: 3 cost time: 9.220186233520508
Epoch: 3, Steps: 979 | Train Loss: 0.7747324 Vali Loss: 0.5737878 Best vali loss: 0.5715381
	iters: 100, epoch: 4 | loss: 0.7804540
	speed: 0.0290s/iter; left time: 138.9473s
	iters: 200, epoch: 4 | loss: 0.3233370
	speed: 0.0097s/iter; left time: 45.6664s
	iters: 300, epoch: 4 | loss: 0.5589380
	speed: 0.0089s/iter; left time: 40.9564s
	iters: 400, epoch: 4 | loss: 0.3632726
	speed: 0.0096s/iter; left time: 42.9391s
	iters: 500, epoch: 4 | loss: 1.0355612
	speed: 0.0067s/iter; left time: 29.4724s
	iters: 600, epoch: 4 | loss: 0.2832866
	speed: 0.0073s/iter; left time: 31.2968s
	iters: 700, epoch: 4 | loss: 0.6121269
	speed: 0.0094s/iter; left time: 39.2431s
	iters: 800, epoch: 4 | loss: 0.7802162
	speed: 0.0094s/iter; left time: 38.3172s
	iters: 900, epoch: 4 | loss: 1.2206652
	speed: 0.0090s/iter; left time: 36.0785s
Updating learning rate to 3.705989275e-05
Validation loss decreased (0.5715 --> 0.5582).  Saving model state dict ...
Epoch: 4 cost time: 8.73033857345581
Epoch: 4, Steps: 979 | Train Loss: 0.6619842 Vali Loss: 0.5581590 Best vali loss: 0.5581590
	iters: 100, epoch: 5 | loss: 1.0650767
	speed: 0.0302s/iter; left time: 115.3220s
	iters: 200, epoch: 5 | loss: 0.5782095
	speed: 0.0089s/iter; left time: 33.2135s
	iters: 300, epoch: 5 | loss: 1.0550940
	speed: 0.0095s/iter; left time: 34.5162s
	iters: 400, epoch: 5 | loss: 1.4006552
	speed: 0.0096s/iter; left time: 33.6585s
	iters: 500, epoch: 5 | loss: 0.3948494
	speed: 0.0089s/iter; left time: 30.5654s
	iters: 600, epoch: 5 | loss: 0.4258423
	speed: 0.0090s/iter; left time: 29.7518s
	iters: 700, epoch: 5 | loss: 0.8546118
	speed: 0.0095s/iter; left time: 30.6105s
	iters: 800, epoch: 5 | loss: 1.3784690
	speed: 0.0096s/iter; left time: 29.8783s
	iters: 900, epoch: 5 | loss: 0.5232417
	speed: 0.0097s/iter; left time: 29.1529s
Updating learning rate to 2.2877685789347898e-05
Epoch: 5 cost time: 9.264734506607056
Epoch: 5, Steps: 979 | Train Loss: 0.8528944 Vali Loss: 0.5618744 Best vali loss: 0.5581590
	iters: 100, epoch: 6 | loss: 0.8310077
	speed: 0.0287s/iter; left time: 81.3587s
	iters: 200, epoch: 6 | loss: 1.1800101
	speed: 0.0091s/iter; left time: 24.8764s
	iters: 300, epoch: 6 | loss: 0.4587071
	speed: 0.0102s/iter; left time: 26.9976s
	iters: 400, epoch: 6 | loss: 1.2496161
	speed: 0.0093s/iter; left time: 23.5497s
	iters: 500, epoch: 6 | loss: 0.9447582
	speed: 0.0096s/iter; left time: 23.4894s
	iters: 600, epoch: 6 | loss: 0.4606754
	speed: 0.0094s/iter; left time: 22.0054s
	iters: 700, epoch: 6 | loss: 0.7942605
	speed: 0.0090s/iter; left time: 20.1549s
	iters: 800, epoch: 6 | loss: 0.6669279
	speed: 0.0090s/iter; left time: 19.1396s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5807309
	speed: 0.0150s/iter; left time: 27.9362s
	iters: 200, epoch: 1 | loss: 0.7409284
	speed: 0.0094s/iter; left time: 16.5277s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.6367).  Saving model state dict ...
Epoch: 1 cost time: 2.564378261566162
Epoch: 1, Steps: 245 | Train Loss: 0.6608296 Vali Loss: 0.6367342 Best vali loss: 0.6367342
	iters: 100, epoch: 2 | loss: 1.0173423
	speed: 0.0177s/iter; left time: 28.5225s
	iters: 200, epoch: 2 | loss: 0.8443964
	speed: 0.0090s/iter; left time: 13.6740s
Updating learning rate to 0.00164194791575
Epoch: 2 cost time: 2.4896647930145264
Epoch: 2, Steps: 245 | Train Loss: 0.9308694 Vali Loss: 0.6379378 Best vali loss: 0.6367342
	iters: 100, epoch: 3 | loss: 0.6295751
	speed: 0.0161s/iter; left time: 22.1204s
	iters: 200, epoch: 3 | loss: 1.1159779
	speed: 0.0067s/iter; left time: 8.5489s
Updating learning rate to 0.000820973957875
Epoch: 3 cost time: 1.7006075382232666
Epoch: 3, Steps: 245 | Train Loss: 0.8727765 Vali Loss: 0.6442756 Best vali loss: 0.6367342
	iters: 100, epoch: 4 | loss: 1.1392618
	speed: 0.0144s/iter; left time: 16.2647s
	iters: 200, epoch: 4 | loss: 1.1666669
	speed: 0.0077s/iter; left time: 7.9185s
Updating learning rate to 0.0004104869789375
Epoch: 4 cost time: 1.9553203582763672
Epoch: 4, Steps: 245 | Train Loss: 1.1529644 Vali Loss: 0.6435607 Best vali loss: 0.6367342
	iters: 100, epoch: 5 | loss: 0.6841407
	speed: 0.0148s/iter; left time: 13.0641s
	iters: 200, epoch: 5 | loss: 0.7173479
	speed: 0.0078s/iter; left time: 6.0626s
Updating learning rate to 0.00020524348946875
Epoch: 5 cost time: 1.9468307495117188
Epoch: 5, Steps: 245 | Train Loss: 0.7007443 Vali Loss: 0.6429859 Best vali loss: 0.6367342
	iters: 100, epoch: 6 | loss: 0.8599054
	speed: 0.0141s/iter; left time: 8.9715s
	iters: 200, epoch: 6 | loss: 0.6570252
	speed: 0.0094s/iter; left time: 5.0566s
Updating learning rate to 0.000102621744734375
Epoch: 6 cost time: 2.141505718231201
Epoch: 6, Steps: 245 | Train Loss: 0.7584653 Vali Loss: 0.6432502 Best vali loss: 0.6367342
	iters: 100, epoch: 7 | loss: 1.1242317
	speed: 0.0186s/iter; left time: 7.2608s
	iters: 200, epoch: 7 | loss: 0.8582292
	speed: 0.0106s/iter; left time: 3.0949s
Updating learning rate to 5.13108723671875e-05
Epoch: 7 cost time: 2.4874749183654785
Epoch: 7, Steps: 245 | Train Loss: 0.9912305 Vali Loss: 0.6430929 Best vali loss: 0.6367342
	iters: 100, epoch: 8 | loss: 0.5004261
	speed: 0.0176s/iter; left time: 2.5664s
	iters: 200, epoch: 8 | loss: 1.2834983
	speed: 0.0106s/iter; left time: 0.4891s
Updating learning rate to 2.565543618359375e-05
Epoch: 8 cost time: 2.4750173091888428
Epoch: 8, Steps: 245 | Train Loss: 0.8919622 Vali Loss: 0.6431831 Best vali loss: 0.6367342

best validation loss 0.6367341952983674

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0010217492465, 'e_layers': 4, 'learning_rate': 8.45510235e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7880318
	speed: 0.0160s/iter; left time: 14.1746s
Updating learning rate to 8.45510235e-05
Validation loss decreased (inf --> 0.6865).  Saving model state dict ...
Epoch: 1 cost time: 1.4819443225860596
Epoch: 1, Steps: 123 | Train Loss: 0.7880318 Vali Loss: 0.6865141 Best vali loss: 0.6865141
	iters: 100, epoch: 2 | loss: 1.0193381
	speed: 0.0144s/iter; left time: 10.9791s
Updating learning rate to 4.227551175e-05
Validation loss decreased (0.6865 --> 0.6655).  Saving model state dict ...
Epoch: 2 cost time: 1.2868194580078125
Epoch: 2, Steps: 123 | Train Loss: 1.0193381 Vali Loss: 0.6655110 Best vali loss: 0.6655110
	iters: 100, epoch: 3 | loss: 0.8680488
	speed: 0.0158s/iter; left time: 10.0691s
Updating learning rate to 2.1137755875e-05
Validation loss decreased (0.6655 --> 0.6573).  Saving model state dict ...
Epoch: 3 cost time: 1.3942091464996338
Epoch: 3, Steps: 123 | Train Loss: 0.8680488 Vali Loss: 0.6573230 Best vali loss: 0.6573230

best validation loss 0.6573229832596273

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0056984617756, 'e_layers': 3, 'learning_rate': 0.0002260913018, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1150126
	speed: 0.0150s/iter; left time: 27.9406s
	iters: 200, epoch: 1 | loss: 0.7282239
	speed: 0.0083s/iter; left time: 14.6860s
Updating learning rate to 0.0002260913018
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 2.4481382369995117
Epoch: 1, Steps: 245 | Train Loss: 0.9216183 Vali Loss: 0.6094329 Best vali loss: 0.6094329
	iters: 100, epoch: 2 | loss: 0.5124984
	speed: 0.0178s/iter; left time: 28.6875s
	iters: 200, epoch: 2 | loss: 0.6400250
	speed: 0.0098s/iter; left time: 14.7986s
Updating learning rate to 0.0001130456509
Validation loss decreased (0.6094 --> 0.5968).  Saving model state dict ...
Epoch: 2 cost time: 2.442843198776245
Epoch: 2, Steps: 245 | Train Loss: 0.5762617 Vali Loss: 0.5967511 Best vali loss: 0.5967511
	iters: 100, epoch: 3 | loss: 0.7517316
	speed: 0.0184s/iter; left time: 25.2592s
	iters: 200, epoch: 3 | loss: 0.8690529
	speed: 0.0098s/iter; left time: 12.4362s
Updating learning rate to 5.652282545e-05
Validation loss decreased (0.5968 --> 0.5450).  Saving model state dict ...
Epoch: 3 cost time: 2.4453158378601074
Epoch: 3, Steps: 245 | Train Loss: 0.8103922 Vali Loss: 0.5449602 Best vali loss: 0.5449602

best validation loss 0.5449601948426753

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.010989339883, 'e_layers': 1, 'learning_rate': 0.0033337143242, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9414197
	speed: 0.0105s/iter; left time: 81.4857s
	iters: 200, epoch: 1 | loss: 0.9959245
	speed: 0.0043s/iter; left time: 32.9967s
	iters: 300, epoch: 1 | loss: 0.4078384
	speed: 0.0044s/iter; left time: 32.9519s
	iters: 400, epoch: 1 | loss: 0.4486901
	speed: 0.0042s/iter; left time: 31.4903s
	iters: 500, epoch: 1 | loss: 0.6880912
	speed: 0.0044s/iter; left time: 32.3156s
	iters: 600, epoch: 1 | loss: 1.1560444
	speed: 0.0043s/iter; left time: 30.7746s
	iters: 700, epoch: 1 | loss: 0.7345747
	speed: 0.0043s/iter; left time: 30.6860s
	iters: 800, epoch: 1 | loss: 2.0982559
	speed: 0.0044s/iter; left time: 30.7783s
	iters: 900, epoch: 1 | loss: 0.9860906
	speed: 0.0043s/iter; left time: 29.8854s
Updating learning rate to 0.003206832377784038
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 4.585126161575317
Epoch: 1, Steps: 979 | Train Loss: 0.9396588 Vali Loss: 0.6048137 Best vali loss: 0.6048137
	iters: 100, epoch: 2 | loss: 0.4028029
	speed: 0.0184s/iter; left time: 124.1068s
	iters: 200, epoch: 2 | loss: 0.9411949
	speed: 0.0046s/iter; left time: 30.9011s
	iters: 300, epoch: 2 | loss: 1.3694718
	speed: 0.0047s/iter; left time: 30.7590s
	iters: 400, epoch: 2 | loss: 0.6875460
	speed: 0.0045s/iter; left time: 29.0756s
	iters: 500, epoch: 2 | loss: 1.1821283
	speed: 0.0048s/iter; left time: 30.8000s
	iters: 600, epoch: 2 | loss: 1.1063023
	speed: 0.0046s/iter; left time: 28.5463s
	iters: 700, epoch: 2 | loss: 1.3033922
	speed: 0.0045s/iter; left time: 27.8505s
	iters: 800, epoch: 2 | loss: 1.1436688
	speed: 0.0045s/iter; left time: 27.5445s
	iters: 900, epoch: 2 | loss: 1.7679902
	speed: 0.0046s/iter; left time: 27.3731s
Updating learning rate to 0.002845503164690274
Validation loss decreased (0.6048 --> 0.6011).  Saving model state dict ...
Epoch: 2 cost time: 4.546428203582764
Epoch: 2, Steps: 979 | Train Loss: 1.1004997 Vali Loss: 0.6010579 Best vali loss: 0.6010579
	iters: 100, epoch: 3 | loss: 0.7068972
	speed: 0.0184s/iter; left time: 106.0751s
	iters: 200, epoch: 3 | loss: 0.8742851
	speed: 0.0044s/iter; left time: 24.6890s
	iters: 300, epoch: 3 | loss: 0.7795047
	speed: 0.0043s/iter; left time: 24.0183s
	iters: 400, epoch: 3 | loss: 0.5321370
	speed: 0.0044s/iter; left time: 23.9595s
	iters: 500, epoch: 3 | loss: 1.0353582
	speed: 0.0042s/iter; left time: 22.7901s
	iters: 600, epoch: 3 | loss: 1.1143689
	speed: 0.0041s/iter; left time: 21.8696s
	iters: 700, epoch: 3 | loss: 0.4032551
	speed: 0.0043s/iter; left time: 22.2358s
	iters: 800, epoch: 3 | loss: 0.8933541
	speed: 0.0041s/iter; left time: 20.7881s
	iters: 900, epoch: 3 | loss: 0.9915959
	speed: 0.0044s/iter; left time: 21.6842s
Updating learning rate to 0.0023047357821547607
Epoch: 3 cost time: 4.271970510482788
Epoch: 3, Steps: 979 | Train Loss: 0.8145285 Vali Loss: 0.6177089 Best vali loss: 0.6010579

best validation loss 0.601057943868615

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0056984617756, 'e_layers': 3, 'learning_rate': 0.0002260913018, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9413526
	speed: 0.0164s/iter; left time: 18.4319s
	iters: 200, epoch: 4 | loss: 0.6864229
	speed: 0.0088s/iter; left time: 8.9835s
Updating learning rate to 2.8261412725e-05
Validation loss decreased (0.5450 --> 0.5377).  Saving model state dict ...
Epoch: 4 cost time: 2.5628573894500732
Epoch: 4, Steps: 245 | Train Loss: 0.8138878 Vali Loss: 0.5377205 Best vali loss: 0.5377205
	iters: 100, epoch: 5 | loss: 0.4794216
	speed: 0.0190s/iter; left time: 16.7014s
	iters: 200, epoch: 5 | loss: 0.5927920
	speed: 0.0105s/iter; left time: 8.1877s
Updating learning rate to 1.41307063625e-05
Epoch: 5 cost time: 2.5990772247314453
Epoch: 5, Steps: 245 | Train Loss: 0.5361068 Vali Loss: 0.5429886 Best vali loss: 0.5377205
	iters: 100, epoch: 6 | loss: 0.6896213
	speed: 0.0192s/iter; left time: 12.2371s
	iters: 200, epoch: 6 | loss: 0.8076189
	speed: 0.0096s/iter; left time: 5.1258s
Updating learning rate to 7.06535318125e-06
Validation loss decreased (0.5377 --> 0.5367).  Saving model state dict ...
Epoch: 6 cost time: 2.476924419403076
Epoch: 6, Steps: 245 | Train Loss: 0.7486201 Vali Loss: 0.5366619 Best vali loss: 0.5366619
	iters: 100, epoch: 7 | loss: 0.5147647
	speed: 0.0189s/iter; left time: 7.3804s
	iters: 200, epoch: 7 | loss: 0.6537149
	speed: 0.0103s/iter; left time: 3.0096s
Updating learning rate to 3.532676590625e-06
Epoch: 7 cost time: 2.581279754638672
Epoch: 7, Steps: 245 | Train Loss: 0.5842398 Vali Loss: 0.5391185 Best vali loss: 0.5366619
	iters: 100, epoch: 8 | loss: 0.5025575
	speed: 0.0189s/iter; left time: 2.7524s
	iters: 200, epoch: 8 | loss: 0.8058179
	speed: 0.0097s/iter; left time: 0.4478s
Updating learning rate to 1.7663382953125e-06
Epoch: 8 cost time: 2.399184465408325
Epoch: 8, Steps: 245 | Train Loss: 0.6541877 Vali Loss: 0.5369035 Best vali loss: 0.5366619

best validation loss 0.5366619427631101

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.002530286228, 'e_layers': 2, 'learning_rate': 0.0027643246753, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8929163
	speed: 0.0140s/iter; left time: 108.2465s
	iters: 200, epoch: 1 | loss: 0.8342454
	speed: 0.0083s/iter; left time: 63.1102s
	iters: 300, epoch: 1 | loss: 0.6931741
	speed: 0.0081s/iter; left time: 61.1431s
	iters: 400, epoch: 1 | loss: 1.0652506
	speed: 0.0082s/iter; left time: 60.7564s
	iters: 500, epoch: 1 | loss: 0.4035670
	speed: 0.0080s/iter; left time: 58.5171s
	iters: 600, epoch: 1 | loss: 0.4479082
	speed: 0.0082s/iter; left time: 59.0893s
	iters: 700, epoch: 1 | loss: 1.0162952
	speed: 0.0083s/iter; left time: 59.5330s
	iters: 800, epoch: 1 | loss: 1.2444736
	speed: 0.0082s/iter; left time: 57.6273s
	iters: 900, epoch: 1 | loss: 0.8402857
	speed: 0.0080s/iter; left time: 55.2810s
Updating learning rate to 0.0027643246753
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 8.308602333068848
Epoch: 1, Steps: 979 | Train Loss: 0.8264573 Vali Loss: 0.6139773 Best vali loss: 0.6139773
	iters: 100, epoch: 2 | loss: 0.7619723
	speed: 0.0283s/iter; left time: 190.9895s
	iters: 200, epoch: 2 | loss: 0.5460059
	speed: 0.0081s/iter; left time: 53.6593s
	iters: 300, epoch: 2 | loss: 0.6490685
	speed: 0.0080s/iter; left time: 52.4787s
	iters: 400, epoch: 2 | loss: 2.2135618
	speed: 0.0082s/iter; left time: 52.8406s
	iters: 500, epoch: 2 | loss: 0.3880211
	speed: 0.0082s/iter; left time: 51.8394s
	iters: 600, epoch: 2 | loss: 1.5678502
	speed: 0.0082s/iter; left time: 51.4385s
	iters: 700, epoch: 2 | loss: 0.8964580
	speed: 0.0080s/iter; left time: 49.4052s
	iters: 800, epoch: 2 | loss: 0.5546103
	speed: 0.0082s/iter; left time: 49.8793s
	iters: 900, epoch: 2 | loss: 1.4017895
	speed: 0.0082s/iter; left time: 49.1203s
Updating learning rate to 0.00138216233765
Validation loss decreased (0.6140 --> 0.6004).  Saving model state dict ...
Epoch: 2 cost time: 8.040663957595825
Epoch: 2, Steps: 979 | Train Loss: 0.9977042 Vali Loss: 0.6004441 Best vali loss: 0.6004441
	iters: 100, epoch: 3 | loss: 0.5896218
	speed: 0.0313s/iter; left time: 180.5272s
	iters: 200, epoch: 3 | loss: 1.3979430
	speed: 0.0095s/iter; left time: 54.1060s
	iters: 300, epoch: 3 | loss: 1.1068726
	speed: 0.0095s/iter; left time: 53.2119s
	iters: 400, epoch: 3 | loss: 1.1568415
	speed: 0.0111s/iter; left time: 61.0363s
	iters: 500, epoch: 3 | loss: 0.8473175
	speed: 0.0072s/iter; left time: 38.7898s
	iters: 600, epoch: 3 | loss: 1.0842086
	speed: 0.0145s/iter; left time: 76.2435s
	iters: 700, epoch: 3 | loss: 1.3972950
	speed: 0.0141s/iter; left time: 72.8449s
	iters: 800, epoch: 3 | loss: 0.2813862
	speed: 0.0128s/iter; left time: 64.9453s
	iters: 900, epoch: 3 | loss: 0.3156185
	speed: 0.0136s/iter; left time: 67.6005s
Updating learning rate to 0.000691081168825
Epoch: 3 cost time: 11.330039262771606
Epoch: 3, Steps: 979 | Train Loss: 0.9085672 Vali Loss: 0.6154737 Best vali loss: 0.6004441
	iters: 100, epoch: 4 | loss: 1.1753650
	speed: 0.1021s/iter; left time: 489.6432s
	iters: 200, epoch: 4 | loss: 0.8290723
	speed: 0.0105s/iter; left time: 49.0794s
	iters: 300, epoch: 4 | loss: 0.6455569
	speed: 0.0079s/iter; left time: 36.1619s
	iters: 400, epoch: 4 | loss: 0.3196508
	speed: 0.0093s/iter; left time: 41.7610s
	iters: 500, epoch: 4 | loss: 1.7111148
	speed: 0.0114s/iter; left time: 49.9864s
	iters: 600, epoch: 4 | loss: 0.8602832
	speed: 0.0110s/iter; left time: 47.1699s
	iters: 700, epoch: 4 | loss: 1.2738992
	speed: 0.0103s/iter; left time: 43.2411s
	iters: 800, epoch: 4 | loss: 0.7265632
	speed: 0.0098s/iter; left time: 40.2770s
	iters: 900, epoch: 4 | loss: 0.7492607
	speed: 0.0109s/iter; left time: 43.5884s
Updating learning rate to 0.0003455405844125
Epoch: 4 cost time: 9.922589302062988
Epoch: 4, Steps: 979 | Train Loss: 0.9211962 Vali Loss: 0.6395211 Best vali loss: 0.6004441
	iters: 100, epoch: 5 | loss: 0.5073131
	speed: 0.0515s/iter; left time: 196.5306s
	iters: 200, epoch: 5 | loss: 0.9218656
	speed: 0.0101s/iter; left time: 37.3913s
	iters: 300, epoch: 5 | loss: 0.3333024
	speed: 0.0106s/iter; left time: 38.5005s
	iters: 400, epoch: 5 | loss: 0.9106703
	speed: 0.0099s/iter; left time: 34.7878s
	iters: 500, epoch: 5 | loss: 0.2618489
	speed: 0.0045s/iter; left time: 15.5444s
	iters: 600, epoch: 5 | loss: 0.5092240
	speed: 0.0045s/iter; left time: 14.7936s
	iters: 700, epoch: 5 | loss: 0.7295012
	speed: 0.0050s/iter; left time: 16.2201s
	iters: 800, epoch: 5 | loss: 0.7925325
	speed: 0.0050s/iter; left time: 15.4645s
	iters: 900, epoch: 5 | loss: 1.2857674
	speed: 0.0049s/iter; left time: 14.8403s
Updating learning rate to 0.00017277029220625
Epoch: 5 cost time: 6.972093343734741
Epoch: 5, Steps: 979 | Train Loss: 0.6946695 Vali Loss: 0.6403425 Best vali loss: 0.6004441
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 138, in _serve
    with self._listener.accept() as conn:
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 465, in accept
    deliver_challenge(c, self._authkey)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 740, in deliver_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 3, 'learning_rate': 0.0006184251923, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0814103
	speed: 0.0128s/iter; left time: 99.0982s
	iters: 200, epoch: 1 | loss: 0.7153878
	speed: 0.0063s/iter; left time: 48.4308s
	iters: 300, epoch: 1 | loss: 1.6472831
	speed: 0.0077s/iter; left time: 57.7423s
	iters: 400, epoch: 1 | loss: 1.4845028
	speed: 0.0085s/iter; left time: 63.4143s
	iters: 500, epoch: 1 | loss: 0.3335432
	speed: 0.0089s/iter; left time: 65.2577s
	iters: 600, epoch: 1 | loss: 1.3566439
	speed: 0.0085s/iter; left time: 61.1671s
	iters: 700, epoch: 1 | loss: 1.8747059
	speed: 0.0085s/iter; left time: 60.5221s
	iters: 800, epoch: 1 | loss: 0.9958537
	speed: 0.0088s/iter; left time: 62.0127s
	iters: 900, epoch: 1 | loss: 1.3041174
	speed: 0.0071s/iter; left time: 49.1213s
Updating learning rate to 0.0005948877849276632
Validation loss decreased (inf --> 0.6188).  Saving model state dict ...
Epoch: 1 cost time: 7.908836126327515
Epoch: 1, Steps: 979 | Train Loss: 1.1992720 Vali Loss: 0.6187574 Best vali loss: 0.6187574
	iters: 100, epoch: 2 | loss: 0.5913749
	speed: 0.0255s/iter; left time: 172.4620s
	iters: 200, epoch: 2 | loss: 1.0629520
	speed: 0.0104s/iter; left time: 69.2277s
	iters: 300, epoch: 2 | loss: 1.2020500
	speed: 0.0108s/iter; left time: 70.5700s
	iters: 400, epoch: 2 | loss: 0.7825780
	speed: 0.0110s/iter; left time: 71.1746s
	iters: 500, epoch: 2 | loss: 1.0330529
	speed: 0.0107s/iter; left time: 67.8119s
	iters: 600, epoch: 2 | loss: 0.3769118
	speed: 0.0098s/iter; left time: 61.2737s
	iters: 700, epoch: 2 | loss: 1.2607695
	speed: 0.0107s/iter; left time: 65.5840s
	iters: 800, epoch: 2 | loss: 1.3325802
	speed: 0.0109s/iter; left time: 65.7957s
	iters: 900, epoch: 2 | loss: 0.4011751
	speed: 0.0108s/iter; left time: 64.0992s
Updating learning rate to 0.0005278589197159623
Epoch: 2 cost time: 10.366743326187134
Epoch: 2, Steps: 979 | Train Loss: 0.8937160 Vali Loss: 0.6223325 Best vali loss: 0.6187574
	iters: 100, epoch: 3 | loss: 0.5445696
	speed: 0.0371s/iter; left time: 214.1781s
	iters: 200, epoch: 3 | loss: 0.3891937
	speed: 0.0098s/iter; left time: 55.5404s
	iters: 300, epoch: 3 | loss: 0.7392647
	speed: 0.0102s/iter; left time: 56.9043s
	iters: 400, epoch: 3 | loss: 0.6463764
	speed: 0.0105s/iter; left time: 57.2690s
	iters: 500, epoch: 3 | loss: 0.7546166
	speed: 0.0082s/iter; left time: 44.3070s
	iters: 600, epoch: 3 | loss: 1.2403605
	speed: 0.0078s/iter; left time: 41.0543s
	iters: 700, epoch: 3 | loss: 1.3095071
	speed: 0.0084s/iter; left time: 43.6920s
	iters: 800, epoch: 3 | loss: 0.6593227
	speed: 0.0085s/iter; left time: 43.0007s
	iters: 900, epoch: 3 | loss: 0.8963819
	speed: 0.0082s/iter; left time: 40.9357s
Updating learning rate to 0.00042754313377520235
Epoch: 3 cost time: 8.862854957580566
Epoch: 3, Steps: 979 | Train Loss: 0.7977326 Vali Loss: 0.6189580 Best vali loss: 0.6187574
	iters: 100, epoch: 4 | loss: 0.2947154
	speed: 0.0274s/iter; left time: 131.3014s
	iters: 200, epoch: 4 | loss: 0.4475124
	speed: 0.0089s/iter; left time: 41.8229s
	iters: 300, epoch: 4 | loss: 0.7243049
	speed: 0.0088s/iter; left time: 40.5028s
	iters: 400, epoch: 4 | loss: 0.7653173
	speed: 0.0083s/iter; left time: 37.2801s
	iters: 500, epoch: 4 | loss: 1.0380009
	speed: 0.0084s/iter; left time: 37.1359s
	iters: 600, epoch: 4 | loss: 0.6867199
	speed: 0.0074s/iter; left time: 31.9092s
	iters: 700, epoch: 4 | loss: 0.4791477
	speed: 0.0077s/iter; left time: 32.2808s
	iters: 800, epoch: 4 | loss: 0.7798462
	speed: 0.0080s/iter; left time: 32.7563s
	iters: 900, epoch: 4 | loss: 0.9249606
	speed: 0.0085s/iter; left time: 33.8163s
Updating learning rate to 0.00030921259615
Validation loss decreased (0.6188 --> 0.6034).  Saving model state dict ...
Epoch: 4 cost time: 8.274497509002686
Epoch: 4, Steps: 979 | Train Loss: 0.6822806 Vali Loss: 0.6033916 Best vali loss: 0.6033916
	iters: 100, epoch: 5 | loss: 0.5835833
	speed: 0.0269s/iter; left time: 102.5759s
	iters: 200, epoch: 5 | loss: 0.6014846
	speed: 0.0084s/iter; left time: 31.3550s
	iters: 300, epoch: 5 | loss: 0.7865568
	speed: 0.0071s/iter; left time: 25.8407s
	iters: 400, epoch: 5 | loss: 1.0999894
	speed: 0.0079s/iter; left time: 27.8765s
	iters: 500, epoch: 5 | loss: 0.9465261
	speed: 0.0084s/iter; left time: 28.6734s
	iters: 600, epoch: 5 | loss: 0.5034137
	speed: 0.0084s/iter; left time: 28.0186s
	iters: 700, epoch: 5 | loss: 0.8059074
	speed: 0.0084s/iter; left time: 27.0892s
	iters: 800, epoch: 5 | loss: 0.4145350
	speed: 0.0085s/iter; left time: 26.5365s
	iters: 900, epoch: 5 | loss: 0.9608982
	speed: 0.0086s/iter; left time: 25.8948s
Updating learning rate to 0.00019088205852479766
Validation loss decreased (0.6034 --> 0.5983).  Saving model state dict ...
Epoch: 5 cost time: 8.110026597976685
Epoch: 5, Steps: 979 | Train Loss: 0.7447660 Vali Loss: 0.5983215 Best vali loss: 0.5983215
	iters: 100, epoch: 6 | loss: 1.2569221
	speed: 0.0259s/iter; left time: 73.5402s
	iters: 200, epoch: 6 | loss: 0.3074888
	speed: 0.0079s/iter; left time: 21.6199s
	iters: 300, epoch: 6 | loss: 0.2719644
	speed: 0.0070s/iter; left time: 18.3916s
	iters: 400, epoch: 6 | loss: 0.3778230
	speed: 0.0076s/iter; left time: 19.3669s
	iters: 500, epoch: 6 | loss: 0.5043925
	speed: 0.0085s/iter; left time: 20.6292s
	iters: 600, epoch: 6 | loss: 1.1428238
	speed: 0.0088s/iter; left time: 20.6060s
	iters: 700, epoch: 6 | loss: 0.4357067
	speed: 0.0075s/iter; left time: 16.6897s
	iters: 800, epoch: 6 | loss: 1.1547929
	speed: 0.0082s/iter; left time: 17.5119s
	iters: 900, epoch: 6 | loss: 0.8690709
	speed: 0.0094s/iter; left time: 19.1444s
Updating learning rate to 9.056627258403767e-05
Validation loss decreased (0.5983 --> 0.5953).  Saving model state dict ...
Epoch: 6 cost time: 8.14382553100586
Epoch: 6, Steps: 979 | Train Loss: 0.7023317 Vali Loss: 0.5953117 Best vali loss: 0.5953117
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0012503605036, 'e_layers': 4, 'learning_rate': 0.0037162746313, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8149219
	speed: 0.0148s/iter; left time: 56.5032s
	iters: 200, epoch: 1 | loss: 0.6056386
	speed: 0.0115s/iter; left time: 42.9339s
	iters: 300, epoch: 1 | loss: 0.8033510
	speed: 0.0107s/iter; left time: 38.8851s
	iters: 400, epoch: 1 | loss: 0.9406796
	speed: 0.0117s/iter; left time: 41.2082s
Updating learning rate to 0.0037162746313
Validation loss decreased (inf --> 0.6528).  Saving model state dict ...
Epoch: 1 cost time: 5.598601818084717
Epoch: 1, Steps: 490 | Train Loss: 0.7911478 Vali Loss: 0.6527934 Best vali loss: 0.6527934
	iters: 100, epoch: 2 | loss: 0.5817282
	speed: 0.0289s/iter; left time: 96.1173s
	iters: 200, epoch: 2 | loss: 0.9442739
	speed: 0.0110s/iter; left time: 35.6687s
	iters: 300, epoch: 2 | loss: 0.4673324
	speed: 0.0107s/iter; left time: 33.3780s
	iters: 400, epoch: 2 | loss: 1.4375534
	speed: 0.0108s/iter; left time: 32.8403s
Updating learning rate to 0.00185813731565
Validation loss decreased (0.6528 --> 0.6425).  Saving model state dict ...
Epoch: 2 cost time: 5.4339680671691895
Epoch: 2, Steps: 490 | Train Loss: 0.8577220 Vali Loss: 0.6424685 Best vali loss: 0.6424685
	iters: 100, epoch: 3 | loss: 1.2621784
	speed: 0.0286s/iter; left time: 81.2147s
	iters: 200, epoch: 3 | loss: 0.5322032
	speed: 0.0109s/iter; left time: 29.8278s
	iters: 300, epoch: 3 | loss: 0.5535533
	speed: 0.0114s/iter; left time: 30.0989s
	iters: 400, epoch: 3 | loss: 1.0273736
	speed: 0.0107s/iter; left time: 27.2073s
Updating learning rate to 0.000929068657825
Epoch: 3 cost time: 5.538768768310547
Epoch: 3, Steps: 490 | Train Loss: 0.8438271 Vali Loss: 0.6486102 Best vali loss: 0.6424685

best validation loss 0.6424684869862441

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7197578
	speed: 0.0098s/iter; left time: 18.1808s
	iters: 200, epoch: 1 | loss: 0.9926225
	speed: 0.0037s/iter; left time: 6.5815s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 1.224799633026123
Epoch: 1, Steps: 245 | Train Loss: 0.8561901 Vali Loss: 0.6077624 Best vali loss: 0.6077624
	iters: 100, epoch: 2 | loss: 0.9781685
	speed: 0.0119s/iter; left time: 19.2986s
	iters: 200, epoch: 2 | loss: 0.8433773
	speed: 0.0073s/iter; left time: 11.0923s
Updating learning rate to 0.00021594413975
Validation loss decreased (0.6078 --> 0.6070).  Saving model state dict ...
Epoch: 2 cost time: 1.8144447803497314
Epoch: 2, Steps: 245 | Train Loss: 0.9107729 Vali Loss: 0.6070031 Best vali loss: 0.6070031
	iters: 100, epoch: 3 | loss: 1.1971464
	speed: 0.0165s/iter; left time: 22.6290s
	iters: 200, epoch: 3 | loss: 0.6087537
	speed: 0.0069s/iter; left time: 8.7846s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 1.827540397644043
Epoch: 3, Steps: 245 | Train Loss: 0.9029500 Vali Loss: 0.6315957 Best vali loss: 0.6070031

best validation loss 0.6070031016747856

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7025761
	speed: 0.0242s/iter; left time: 21.4264s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 2.5757410526275635
Epoch: 1, Steps: 123 | Train Loss: 0.7025761 Vali Loss: 0.6100594 Best vali loss: 0.6100594
	iters: 100, epoch: 2 | loss: 1.0044965
	speed: 0.0359s/iter; left time: 27.3649s
Updating learning rate to 6.252043389458952e-05
Validation loss decreased (0.6101 --> 0.6064).  Saving model state dict ...
Epoch: 2 cost time: 2.41416597366333
Epoch: 2, Steps: 123 | Train Loss: 1.0044965 Vali Loss: 0.6063891 Best vali loss: 0.6063891
	iters: 100, epoch: 3 | loss: 0.7285230
	speed: 0.0189s/iter; left time: 12.0784s
Updating learning rate to 5.063887571827247e-05
Validation loss decreased (0.6064 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 1.131256103515625
Epoch: 3, Steps: 123 | Train Loss: 0.7285230 Vali Loss: 0.6030534 Best vali loss: 0.6030534

best validation loss 0.6030534057637047

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6656463
	speed: 0.0219s/iter; left time: 11.3031s
Updating learning rate to 3.662362225e-05
Validation loss decreased (0.6031 --> 0.5958).  Saving model state dict ...
Epoch: 4 cost time: 1.9713075160980225
Epoch: 4, Steps: 123 | Train Loss: 0.6656463 Vali Loss: 0.5958354 Best vali loss: 0.5958354
	iters: 100, epoch: 5 | loss: 0.9610946
	speed: 0.0171s/iter; left time: 6.7158s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.5958 --> 0.5731).  Saving model state dict ...
Epoch: 5 cost time: 1.5833220481872559
Epoch: 5, Steps: 123 | Train Loss: 0.9610946 Vali Loss: 0.5731447 Best vali loss: 0.5731447
	iters: 100, epoch: 6 | loss: 0.6904069
	speed: 0.0215s/iter; left time: 5.8063s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.5731 --> 0.5568).  Saving model state dict ...
Epoch: 6 cost time: 1.8779840469360352
Epoch: 6, Steps: 123 | Train Loss: 0.6904069 Vali Loss: 0.5568462 Best vali loss: 0.5568462
	iters: 100, epoch: 7 | loss: 0.7206687
	speed: 0.0221s/iter; left time: 3.2461s
Updating learning rate to 2.7878072468000404e-06
Epoch: 7 cost time: 1.8480629920959473
Epoch: 7, Steps: 123 | Train Loss: 0.7206687 Vali Loss: 0.5585830 Best vali loss: 0.5568462
	iters: 100, epoch: 8 | loss: 0.9396763
	speed: 0.0170s/iter; left time: 0.4079s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2926318645477295
Epoch: 8, Steps: 123 | Train Loss: 0.9396763 Vali Loss: 0.5586280 Best vali loss: 0.5568462

best validation loss 0.5568461753548654

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0015532343716, 'e_layers': 1, 'learning_rate': 0.0005105690972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9185262
	speed: 0.0136s/iter; left time: 25.3201s
	iters: 200, epoch: 1 | loss: 0.5130152
	speed: 0.0082s/iter; left time: 14.4068s
Updating learning rate to 0.0005105690972
Validation loss decreased (inf --> 0.6218).  Saving model state dict ...
Epoch: 1 cost time: 2.2205770015716553
Epoch: 1, Steps: 245 | Train Loss: 0.7157707 Vali Loss: 0.6217722 Best vali loss: 0.6217722
	iters: 100, epoch: 2 | loss: 0.8736636
	speed: 0.0201s/iter; left time: 32.5404s
	iters: 200, epoch: 2 | loss: 1.0311112
	speed: 0.0134s/iter; left time: 20.3264s
Updating learning rate to 0.0002552845486
Validation loss decreased (0.6218 --> 0.6055).  Saving model state dict ...
Epoch: 2 cost time: 3.206246852874756
Epoch: 2, Steps: 245 | Train Loss: 0.9523874 Vali Loss: 0.6054973 Best vali loss: 0.6054973
	iters: 100, epoch: 3 | loss: 0.7919028
	speed: 0.0331s/iter; left time: 45.3525s
	iters: 200, epoch: 3 | loss: 0.5578851
	speed: 0.0136s/iter; left time: 17.3071s
Updating learning rate to 0.0001276422743
Epoch: 3 cost time: 3.3627097606658936
Epoch: 3, Steps: 245 | Train Loss: 0.6748939 Vali Loss: 0.6467293 Best vali loss: 0.6054973
	iters: 100, epoch: 4 | loss: 0.4195971
	speed: 0.0356s/iter; left time: 40.0584s
	iters: 200, epoch: 4 | loss: 0.6949099
	speed: 0.0134s/iter; left time: 13.7825s
Updating learning rate to 6.382113715e-05
Epoch: 4 cost time: 3.439134359359741
Epoch: 4, Steps: 245 | Train Loss: 0.5572535 Vali Loss: 0.6651999 Best vali loss: 0.6054973
	iters: 100, epoch: 5 | loss: 0.6129685
	speed: 0.0352s/iter; left time: 30.9788s
	iters: 200, epoch: 5 | loss: 0.5069993
	speed: 0.0137s/iter; left time: 10.6915s
Updating learning rate to 3.1910568575e-05
Epoch: 5 cost time: 3.5608274936676025
Epoch: 5, Steps: 245 | Train Loss: 0.5599839 Vali Loss: 0.6380161 Best vali loss: 0.6054973
	iters: 100, epoch: 6 | loss: 0.8600414
	speed: 0.0194s/iter; left time: 12.3625s
	iters: 200, epoch: 6 | loss: 0.8322750
	speed: 0.0081s/iter; left time: 4.3645s
Updating learning rate to 1.59552842875e-05
Epoch: 6 cost time: 1.986764669418335
Epoch: 6, Steps: 245 | Train Loss: 0.8461582 Vali Loss: 0.6554498 Best vali loss: 0.6054973
	iters: 100, epoch: 7 | loss: 0.6021652
	speed: 0.0160s/iter; left time: 6.2445s
	iters: 200, epoch: 7 | loss: 0.5904626
	speed: 0.0049s/iter; left time: 1.4361s
Updating learning rate to 7.97764214375e-06
Epoch: 7 cost time: 1.3934106826782227
Epoch: 7, Steps: 245 | Train Loss: 0.5963139 Vali Loss: 0.6555872 Best vali loss: 0.6054973
	iters: 100, epoch: 8 | loss: 0.6363239
	speed: 0.0176s/iter; left time: 2.5702s
	iters: 200, epoch: 8 | loss: 0.4771582
	speed: 0.0086s/iter; left time: 0.3941s
Updating learning rate to 3.988821071875e-06
Epoch: 8 cost time: 2.1541755199432373
Epoch: 8, Steps: 245 | Train Loss: 0.5567410 Vali Loss: 0.6567368 Best vali loss: 0.6054973

best validation loss 0.6054972679677908

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0031492887959, 'e_layers': 2, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0925218
	speed: 0.0173s/iter; left time: 133.6379s
	iters: 200, epoch: 1 | loss: 1.0724314
	speed: 0.0107s/iter; left time: 81.6528s
	iters: 300, epoch: 1 | loss: 0.7359673
	speed: 0.0108s/iter; left time: 81.3205s
	iters: 400, epoch: 1 | loss: 0.7355292
	speed: 0.0110s/iter; left time: 81.5775s
	iters: 500, epoch: 1 | loss: 0.5279818
	speed: 0.0100s/iter; left time: 73.4709s
	iters: 600, epoch: 1 | loss: 0.4896438
	speed: 0.0118s/iter; left time: 85.5826s
	iters: 700, epoch: 1 | loss: 0.2626080
	speed: 0.0105s/iter; left time: 74.8088s
	iters: 800, epoch: 1 | loss: 0.5684162
	speed: 0.0103s/iter; left time: 72.5188s
	iters: 900, epoch: 1 | loss: 0.3182157
	speed: 0.0100s/iter; left time: 69.5047s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.6061).  Saving model state dict ...
Epoch: 1 cost time: 10.709636688232422
Epoch: 1, Steps: 979 | Train Loss: 0.6448128 Vali Loss: 0.6060652 Best vali loss: 0.6060652
	iters: 100, epoch: 2 | loss: 0.2796588
	speed: 0.0395s/iter; left time: 266.5349s
	iters: 200, epoch: 2 | loss: 0.6215213
	speed: 0.0127s/iter; left time: 84.6770s
	iters: 300, epoch: 2 | loss: 0.6468039
	speed: 0.0113s/iter; left time: 73.9652s
	iters: 400, epoch: 2 | loss: 0.4511636
	speed: 0.0101s/iter; left time: 65.1898s
	iters: 500, epoch: 2 | loss: 1.7060473
	speed: 0.0096s/iter; left time: 60.7545s
	iters: 600, epoch: 2 | loss: 1.2230966
	speed: 0.0102s/iter; left time: 64.0358s
	iters: 700, epoch: 2 | loss: 0.9422832
	speed: 0.0102s/iter; left time: 62.9070s
	iters: 800, epoch: 2 | loss: 0.5863528
	speed: 0.0115s/iter; left time: 69.5073s
	iters: 900, epoch: 2 | loss: 0.4536670
	speed: 0.0099s/iter; left time: 58.6503s
Updating learning rate to 5.35870624e-05
Validation loss decreased (0.6061 --> 0.5563).  Saving model state dict ...
Epoch: 2 cost time: 10.528366565704346
Epoch: 2, Steps: 979 | Train Loss: 0.7678439 Vali Loss: 0.5563126 Best vali loss: 0.5563126
	iters: 100, epoch: 3 | loss: 0.7566891
	speed: 0.0367s/iter; left time: 211.7692s
	iters: 200, epoch: 3 | loss: 0.5634237
	speed: 0.0089s/iter; left time: 50.5767s
	iters: 300, epoch: 3 | loss: 1.2337375
	speed: 0.0084s/iter; left time: 46.7882s
	iters: 400, epoch: 3 | loss: 0.7706324
	speed: 0.0082s/iter; left time: 45.0861s
	iters: 500, epoch: 3 | loss: 0.6704391
	speed: 0.0086s/iter; left time: 46.3552s
	iters: 600, epoch: 3 | loss: 0.6787206
	speed: 0.0086s/iter; left time: 45.5207s
	iters: 700, epoch: 3 | loss: 0.3689696
	speed: 0.0083s/iter; left time: 42.8345s
	iters: 800, epoch: 3 | loss: 0.7567073
	speed: 0.0083s/iter; left time: 41.8941s
	iters: 900, epoch: 3 | loss: 1.0618382
	speed: 0.0087s/iter; left time: 43.4629s
Updating learning rate to 2.67935312e-05
Epoch: 3 cost time: 8.523289680480957
Epoch: 3, Steps: 979 | Train Loss: 0.7623508 Vali Loss: 0.5750668 Best vali loss: 0.5563126
	iters: 100, epoch: 4 | loss: 0.3336124
	speed: 0.0311s/iter; left time: 149.1039s
	iters: 200, epoch: 4 | loss: 1.3143902
	speed: 0.0081s/iter; left time: 38.1887s
	iters: 300, epoch: 4 | loss: 0.8770319
	speed: 0.0049s/iter; left time: 22.3756s
	iters: 400, epoch: 4 | loss: 0.7768539
	speed: 0.0063s/iter; left time: 28.4853s
	iters: 500, epoch: 4 | loss: 0.6013205
	speed: 0.0098s/iter; left time: 42.9719s
	iters: 600, epoch: 4 | loss: 0.7511361
	speed: 0.0087s/iter; left time: 37.5839s
	iters: 700, epoch: 4 | loss: 1.0027075
	speed: 0.0093s/iter; left time: 39.1252s
	iters: 800, epoch: 4 | loss: 0.6256522
	speed: 0.0094s/iter; left time: 38.4399s
	iters: 900, epoch: 4 | loss: 0.2732608
	speed: 0.0097s/iter; left time: 38.6334s
Updating learning rate to 1.33967656e-05
Validation loss decreased (0.5563 --> 0.5547).  Saving model state dict ...
Epoch: 4 cost time: 8.176897048950195
Epoch: 4, Steps: 979 | Train Loss: 0.7284406 Vali Loss: 0.5546780 Best vali loss: 0.5546780
	iters: 100, epoch: 5 | loss: 0.8964286
	speed: 0.0242s/iter; left time: 92.3223s
	iters: 200, epoch: 5 | loss: 0.6255053
	speed: 0.0095s/iter; left time: 35.1968s
	iters: 300, epoch: 5 | loss: 0.6145077
	speed: 0.0096s/iter; left time: 34.6284s
	iters: 400, epoch: 5 | loss: 0.9705342
	speed: 0.0091s/iter; left time: 31.9301s
	iters: 500, epoch: 5 | loss: 0.4458009
	speed: 0.0093s/iter; left time: 31.7736s
	iters: 600, epoch: 5 | loss: 0.8394762
	speed: 0.0089s/iter; left time: 29.4432s
	iters: 700, epoch: 5 | loss: 0.8142844
	speed: 0.0050s/iter; left time: 16.2263s
	iters: 800, epoch: 5 | loss: 0.3398591
	speed: 0.0052s/iter; left time: 16.2908s
	iters: 900, epoch: 5 | loss: 0.5782472
	speed: 0.0094s/iter; left time: 28.4206s
Updating learning rate to 6.6983828e-06
Validation loss decreased (0.5547 --> 0.5528).  Saving model state dict ...
Epoch: 5 cost time: 8.19812822341919
Epoch: 5, Steps: 979 | Train Loss: 0.6805160 Vali Loss: 0.5528414 Best vali loss: 0.5528414
	iters: 100, epoch: 6 | loss: 0.5666686
	speed: 0.0320s/iter; left time: 90.7468s
	iters: 200, epoch: 6 | loss: 0.9492701
	speed: 0.0098s/iter; left time: 26.7329s
	iters: 300, epoch: 6 | loss: 0.5087217
	speed: 0.0085s/iter; left time: 22.4534s
	iters: 400, epoch: 6 | loss: 1.1551811
	speed: 0.0093s/iter; left time: 23.6884s
	iters: 500, epoch: 6 | loss: 0.3541592
	speed: 0.0089s/iter; left time: 21.7878s
	iters: 600, epoch: 6 | loss: 0.4637015
	speed: 0.0096s/iter; left time: 22.5374s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0042539720696, 'e_layers': 2, 'learning_rate': 0.0002408411284, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1149104
	speed: 0.0118s/iter; left time: 10.4644s
Updating learning rate to 0.00023167465875784137
Validation loss decreased (inf --> 0.6369).  Saving model state dict ...
Epoch: 1 cost time: 1.0184352397918701
Epoch: 1, Steps: 123 | Train Loss: 1.1149104 Vali Loss: 0.6369335 Best vali loss: 0.6369335
	iters: 100, epoch: 2 | loss: 0.8153124
	speed: 0.0149s/iter; left time: 11.3571s
Updating learning rate to 0.00020557076174012998
Validation loss decreased (0.6369 --> 0.6113).  Saving model state dict ...
Epoch: 2 cost time: 1.2443430423736572
Epoch: 2, Steps: 123 | Train Loss: 0.8153124 Vali Loss: 0.6112650 Best vali loss: 0.6112650
	iters: 100, epoch: 3 | loss: 0.9689630
	speed: 0.0180s/iter; left time: 11.4755s
Updating learning rate to 0.00016650351903539664
Validation loss decreased (0.6113 --> 0.6077).  Saving model state dict ...
Epoch: 3 cost time: 1.3701190948486328
Epoch: 3, Steps: 123 | Train Loss: 0.9689630 Vali Loss: 0.6076742 Best vali loss: 0.6076742

best validation loss 0.6076741604438705

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0034190960824, 'e_layers': 4, 'learning_rate': 8.10959522e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8356748
	speed: 0.0186s/iter; left time: 70.9330s
	iters: 200, epoch: 1 | loss: 0.7803597
	speed: 0.0117s/iter; left time: 43.5080s
	iters: 300, epoch: 1 | loss: 1.1350311
	speed: 0.0120s/iter; left time: 43.2983s
	iters: 400, epoch: 1 | loss: 1.1323051
	speed: 0.0117s/iter; left time: 41.0626s
Updating learning rate to 7.800942130354682e-05
Validation loss decreased (inf --> 0.5977).  Saving model state dict ...
Epoch: 1 cost time: 6.187094688415527
Epoch: 1, Steps: 490 | Train Loss: 0.9708427 Vali Loss: 0.5976934 Best vali loss: 0.5976934
	iters: 100, epoch: 2 | loss: 1.0455424
	speed: 0.0326s/iter; left time: 108.5706s
	iters: 200, epoch: 2 | loss: 0.4922290
	speed: 0.0114s/iter; left time: 36.9629s
	iters: 300, epoch: 2 | loss: 1.2827312
	speed: 0.0119s/iter; left time: 37.2206s
	iters: 400, epoch: 2 | loss: 0.5147954
	speed: 0.0095s/iter; left time: 28.7651s
Updating learning rate to 6.921972496370005e-05
Epoch: 2 cost time: 5.080949068069458
Epoch: 2, Steps: 490 | Train Loss: 0.8338245 Vali Loss: 0.6030283 Best vali loss: 0.5976934
	iters: 100, epoch: 3 | loss: 0.9496647
	speed: 0.0221s/iter; left time: 62.9009s
	iters: 200, epoch: 3 | loss: 0.4485792
	speed: 0.0096s/iter; left time: 26.3398s
	iters: 300, epoch: 3 | loss: 1.0987811
	speed: 0.0096s/iter; left time: 25.3186s
	iters: 400, epoch: 3 | loss: 0.9011806
	speed: 0.0097s/iter; left time: 24.5629s
Updating learning rate to 5.606501476940563e-05
Validation loss decreased (0.5977 --> 0.5706).  Saving model state dict ...
Epoch: 3 cost time: 4.651091814041138
Epoch: 3, Steps: 490 | Train Loss: 0.8495514 Vali Loss: 0.5706476 Best vali loss: 0.5706476

best validation loss 0.570647636093182

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009709004671, 'e_layers': 1, 'learning_rate': 0.0002959396638, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5220599
	speed: 0.0098s/iter; left time: 75.8531s
	iters: 200, epoch: 1 | loss: 0.7537485
	speed: 0.0039s/iter; left time: 29.7331s
	iters: 300, epoch: 1 | loss: 0.7448101
	speed: 0.0042s/iter; left time: 31.8242s
	iters: 400, epoch: 1 | loss: 0.8206603
	speed: 0.0043s/iter; left time: 32.0597s
	iters: 500, epoch: 1 | loss: 0.6429421
	speed: 0.0043s/iter; left time: 31.1836s
	iters: 600, epoch: 1 | loss: 1.1100844
	speed: 0.0040s/iter; left time: 29.0720s
	iters: 700, epoch: 1 | loss: 1.3729070
	speed: 0.0035s/iter; left time: 25.0928s
	iters: 800, epoch: 1 | loss: 0.7521737
	speed: 0.0030s/iter; left time: 20.8887s
	iters: 900, epoch: 1 | loss: 0.7098319
	speed: 0.0032s/iter; left time: 22.4962s
Updating learning rate to 0.0002846761310215457
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 4.053635358810425
Epoch: 1, Steps: 979 | Train Loss: 0.9365798 Vali Loss: 0.6101161 Best vali loss: 0.6101161
	iters: 100, epoch: 2 | loss: 1.0456681
	speed: 0.0172s/iter; left time: 116.3842s
	iters: 200, epoch: 2 | loss: 0.3319122
	speed: 0.0045s/iter; left time: 29.8477s
	iters: 300, epoch: 2 | loss: 1.2497889
	speed: 0.0045s/iter; left time: 29.3385s
	iters: 400, epoch: 2 | loss: 0.5975987
	speed: 0.0043s/iter; left time: 28.0076s
	iters: 500, epoch: 2 | loss: 0.3355736
	speed: 0.0043s/iter; left time: 27.1130s
	iters: 600, epoch: 2 | loss: 0.6395113
	speed: 0.0042s/iter; left time: 26.3854s
	iters: 700, epoch: 2 | loss: 0.9640313
	speed: 0.0042s/iter; left time: 25.8887s
	iters: 800, epoch: 2 | loss: 0.9620159
	speed: 0.0042s/iter; left time: 25.3572s
	iters: 900, epoch: 2 | loss: 0.3167198
	speed: 0.0042s/iter; left time: 24.8604s
Updating learning rate to 0.0002526003034475235
Epoch: 2 cost time: 4.271391868591309
Epoch: 2, Steps: 979 | Train Loss: 0.7158689 Vali Loss: 0.6103610 Best vali loss: 0.6101161
	iters: 100, epoch: 3 | loss: 1.2342641
	speed: 0.0164s/iter; left time: 94.5493s
	iters: 200, epoch: 3 | loss: 0.7636186
	speed: 0.0041s/iter; left time: 23.0807s
	iters: 300, epoch: 3 | loss: 0.4050040
	speed: 0.0042s/iter; left time: 23.3408s
	iters: 400, epoch: 3 | loss: 1.0810943
	speed: 0.0043s/iter; left time: 23.6805s
	iters: 500, epoch: 3 | loss: 1.0225780
	speed: 0.0043s/iter; left time: 23.2490s
	iters: 600, epoch: 3 | loss: 1.3581065
	speed: 0.0044s/iter; left time: 23.1328s
	iters: 700, epoch: 3 | loss: 0.5519181
	speed: 0.0044s/iter; left time: 22.5708s
	iters: 800, epoch: 3 | loss: 0.8134807
	speed: 0.0042s/iter; left time: 21.3692s
	iters: 900, epoch: 3 | loss: 1.6326959
	speed: 0.0042s/iter; left time: 20.9874s
Updating learning rate to 0.00020459543505797737
Epoch: 3 cost time: 4.200605154037476
Epoch: 3, Steps: 979 | Train Loss: 0.9847511 Vali Loss: 0.6429575 Best vali loss: 0.6101161

best validation loss 0.6101161463014619

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0034190960824, 'e_layers': 4, 'learning_rate': 8.10959522e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7328925
	speed: 0.0152s/iter; left time: 35.7200s
	iters: 200, epoch: 4 | loss: 0.6562481
	speed: 0.0090s/iter; left time: 20.2615s
	iters: 300, epoch: 4 | loss: 0.9744475
	speed: 0.0096s/iter; left time: 20.6389s
	iters: 400, epoch: 4 | loss: 0.9353533
	speed: 0.0096s/iter; left time: 19.7075s
Updating learning rate to 4.05479761e-05
Validation loss decreased (0.5706 --> 0.5666).  Saving model state dict ...
Epoch: 4 cost time: 4.7804856300354
Epoch: 4, Steps: 490 | Train Loss: 0.8247353 Vali Loss: 0.5665975 Best vali loss: 0.5665975
	iters: 100, epoch: 5 | loss: 0.9753268
	speed: 0.0250s/iter; left time: 46.5239s
	iters: 200, epoch: 5 | loss: 0.4570480
	speed: 0.0109s/iter; left time: 19.2383s
	iters: 300, epoch: 5 | loss: 1.2472637
	speed: 0.0108s/iter; left time: 17.9975s
	iters: 400, epoch: 5 | loss: 0.5074542
	speed: 0.0098s/iter; left time: 15.3134s
Updating learning rate to 2.5030937430594375e-05
Validation loss decreased (0.5666 --> 0.5601).  Saving model state dict ...
Epoch: 5 cost time: 5.140887498855591
Epoch: 5, Steps: 490 | Train Loss: 0.7967732 Vali Loss: 0.5600926 Best vali loss: 0.5600926
	iters: 100, epoch: 6 | loss: 0.9417698
	speed: 0.0386s/iter; left time: 52.9416s
	iters: 200, epoch: 6 | loss: 0.3887676
	speed: 0.0126s/iter; left time: 16.0672s
	iters: 300, epoch: 6 | loss: 1.0376987
	speed: 0.0110s/iter; left time: 12.9062s
	iters: 400, epoch: 6 | loss: 0.8729901
	speed: 0.0107s/iter; left time: 11.5015s
Updating learning rate to 1.1876227236299943e-05
Epoch: 6 cost time: 6.01030969619751
Epoch: 6, Steps: 490 | Train Loss: 0.8103066 Vali Loss: 0.5602175 Best vali loss: 0.5600926
	iters: 100, epoch: 7 | loss: 0.4848540
	speed: 0.0288s/iter; left time: 25.3559s
	iters: 200, epoch: 7 | loss: 1.3616029
	speed: 0.0103s/iter; left time: 8.0346s
	iters: 300, epoch: 7 | loss: 0.4014319
	speed: 0.0108s/iter; left time: 7.3466s
	iters: 400, epoch: 7 | loss: 0.4770361
	speed: 0.0113s/iter; left time: 6.5727s
Updating learning rate to 3.0865308964531722e-06
Validation loss decreased (0.5601 --> 0.5592).  Saving model state dict ...
Epoch: 7 cost time: 5.417348384857178
Epoch: 7, Steps: 490 | Train Loss: 0.6812312 Vali Loss: 0.5592466 Best vali loss: 0.5592466
	iters: 100, epoch: 8 | loss: 0.7433956
	speed: 0.0271s/iter; left time: 10.5975s
	iters: 200, epoch: 8 | loss: 0.4236684
	speed: 0.0113s/iter; left time: 3.2933s
	iters: 300, epoch: 8 | loss: 1.1577914
	speed: 0.0106s/iter; left time: 2.0230s
	iters: 400, epoch: 8 | loss: 0.8650991
	speed: 0.0099s/iter; left time: 0.9036s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.26917290687561
Epoch: 8, Steps: 490 | Train Loss: 0.7974886 Vali Loss: 0.5593287 Best vali loss: 0.5592466

best validation loss 0.5592466387027174

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0051001719473, 'e_layers': 3, 'learning_rate': 8.73188916e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2501030
	speed: 0.0128s/iter; left time: 23.8124s
	iters: 200, epoch: 1 | loss: 1.2196380
	speed: 0.0092s/iter; left time: 16.1744s
Updating learning rate to 8.73188916e-05
Validation loss decreased (inf --> 0.6787).  Saving model state dict ...
Epoch: 1 cost time: 2.3313775062561035
Epoch: 1, Steps: 245 | Train Loss: 1.2348705 Vali Loss: 0.6786652 Best vali loss: 0.6786652
	iters: 100, epoch: 2 | loss: 0.6921951
	speed: 0.0188s/iter; left time: 30.3579s
	iters: 200, epoch: 2 | loss: 1.0128306
	speed: 0.0092s/iter; left time: 13.8970s
Updating learning rate to 4.36594458e-05
Validation loss decreased (0.6787 --> 0.6524).  Saving model state dict ...
Epoch: 2 cost time: 2.3300511837005615
Epoch: 2, Steps: 245 | Train Loss: 0.8525128 Vali Loss: 0.6523781 Best vali loss: 0.6523781
	iters: 100, epoch: 3 | loss: 1.1342120
	speed: 0.0311s/iter; left time: 42.6032s
	iters: 200, epoch: 3 | loss: 0.6255870
	speed: 0.0137s/iter; left time: 17.3939s
Updating learning rate to 2.18297229e-05
Validation loss decreased (0.6524 --> 0.6429).  Saving model state dict ...
Epoch: 3 cost time: 3.436938524246216
Epoch: 3, Steps: 245 | Train Loss: 0.8798995 Vali Loss: 0.6428816 Best vali loss: 0.6428816
	iters: 100, epoch: 4 | loss: 0.9170218
	speed: 0.0171s/iter; left time: 19.2967s
	iters: 200, epoch: 4 | loss: 0.8739594
	speed: 0.0082s/iter; left time: 8.4635s
Updating learning rate to 1.091486145e-05
Validation loss decreased (0.6429 --> 0.6392).  Saving model state dict ...
Epoch: 4 cost time: 2.020777702331543
Epoch: 4, Steps: 245 | Train Loss: 0.8954906 Vali Loss: 0.6392391 Best vali loss: 0.6392391
	iters: 100, epoch: 5 | loss: 0.9357648
	speed: 0.0157s/iter; left time: 13.8111s
	iters: 200, epoch: 5 | loss: 1.2526439
	speed: 0.0092s/iter; left time: 7.2000s
Updating learning rate to 5.457430725e-06
Validation loss decreased (0.6392 --> 0.6379).  Saving model state dict ...
Epoch: 5 cost time: 2.2886815071105957
Epoch: 5, Steps: 245 | Train Loss: 1.0942044 Vali Loss: 0.6379005 Best vali loss: 0.6379005
	iters: 100, epoch: 6 | loss: 1.1378331
	speed: 0.0174s/iter; left time: 11.0563s
	iters: 200, epoch: 6 | loss: 0.6025311
	speed: 0.0093s/iter; left time: 4.9880s
Updating learning rate to 2.7287153625e-06
Validation loss decreased (0.6379 --> 0.6372).  Saving model state dict ...
Epoch: 6 cost time: 2.2820894718170166
Epoch: 6, Steps: 245 | Train Loss: 0.8701821 Vali Loss: 0.6371929 Best vali loss: 0.6371929
	iters: 100, epoch: 7 | loss: 1.1221107
	speed: 0.0219s/iter; left time: 8.5706s
	iters: 200, epoch: 7 | loss: 0.8881459
	speed: 0.0095s/iter; left time: 2.7621s
Updating learning rate to 1.36435768125e-06
Validation loss decreased (0.6372 --> 0.6368).  Saving model state dict ...
Epoch: 7 cost time: 2.3825714588165283
Epoch: 7, Steps: 245 | Train Loss: 1.0051283 Vali Loss: 0.6368468 Best vali loss: 0.6368468
	iters: 100, epoch: 8 | loss: 0.8204228
	speed: 0.0180s/iter; left time: 2.6242s
	iters: 200, epoch: 8 | loss: 0.5052611
	speed: 0.0088s/iter; left time: 0.4031s
Updating learning rate to 6.82178840625e-07
Validation loss decreased (0.6368 --> 0.6367).  Saving model state dict ...
Epoch: 8 cost time: 2.2850093841552734
Epoch: 8, Steps: 245 | Train Loss: 0.6628419 Vali Loss: 0.6366565 Best vali loss: 0.6366565

best validation loss 0.6366564801642873

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019719493758, 'e_layers': 2, 'learning_rate': 0.000382679163, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9816780
	speed: 0.0139s/iter; left time: 25.9319s
	iters: 200, epoch: 1 | loss: 1.2170963
	speed: 0.0078s/iter; left time: 13.8160s
Updating learning rate to 0.0003681143046071253
Validation loss decreased (inf --> 0.6514).  Saving model state dict ...
Epoch: 1 cost time: 2.2350614070892334
Epoch: 1, Steps: 245 | Train Loss: 1.0993872 Vali Loss: 0.6513930 Best vali loss: 0.6513930
	iters: 100, epoch: 2 | loss: 0.5423076
	speed: 0.0177s/iter; left time: 28.6279s
	iters: 200, epoch: 2 | loss: 0.9211631
	speed: 0.0100s/iter; left time: 15.1274s
Updating learning rate to 0.0003266370970880461
Validation loss decreased (0.6514 --> 0.5973).  Saving model state dict ...
Epoch: 2 cost time: 2.4463436603546143
Epoch: 2, Steps: 245 | Train Loss: 0.7317354 Vali Loss: 0.5972632 Best vali loss: 0.5972632
	iters: 100, epoch: 3 | loss: 0.8383830
	speed: 0.0330s/iter; left time: 45.2973s
	iters: 200, epoch: 3 | loss: 0.8535598
	speed: 0.0101s/iter; left time: 12.8457s
Updating learning rate to 0.00026456206929571986
Validation loss decreased (0.5973 --> 0.5589).  Saving model state dict ...
Epoch: 3 cost time: 2.6120970249176025
Epoch: 3, Steps: 245 | Train Loss: 0.8459714 Vali Loss: 0.5589008 Best vali loss: 0.5589008
	iters: 100, epoch: 4 | loss: 0.6783053
	speed: 0.0337s/iter; left time: 37.9229s
	iters: 200, epoch: 4 | loss: 0.6213875
	speed: 0.0128s/iter; left time: 13.1459s
Updating learning rate to 0.0001913395815
Epoch: 4 cost time: 3.395756244659424
Epoch: 4, Steps: 245 | Train Loss: 0.6498464 Vali Loss: 0.5713381 Best vali loss: 0.5589008
	iters: 100, epoch: 5 | loss: 0.6595256
	speed: 0.0275s/iter; left time: 24.2126s
	iters: 200, epoch: 5 | loss: 0.3291729
	speed: 0.0167s/iter; left time: 13.0702s
Updating learning rate to 0.00011811709370428018
Validation loss decreased (0.5589 --> 0.5567).  Saving model state dict ...
Epoch: 5 cost time: 3.542489528656006
Epoch: 5, Steps: 245 | Train Loss: 0.4943493 Vali Loss: 0.5567484 Best vali loss: 0.5567484
	iters: 100, epoch: 6 | loss: 0.6229359
	speed: 0.0393s/iter; left time: 25.0011s
	iters: 200, epoch: 6 | loss: 0.4737250
	speed: 0.0159s/iter; left time: 8.4997s
Updating learning rate to 5.604206591195394e-05
Epoch: 6 cost time: 4.008675575256348
Epoch: 6, Steps: 245 | Train Loss: 0.5483304 Vali Loss: 0.5962171 Best vali loss: 0.5567484
	iters: 100, epoch: 7 | loss: 0.5111198
	speed: 0.0258s/iter; left time: 10.0833s
	iters: 200, epoch: 7 | loss: 0.3472767
	speed: 0.0148s/iter; left time: 4.2967s
Updating learning rate to 1.4564858392874752e-05
Epoch: 7 cost time: 3.2851805686950684
Epoch: 7, Steps: 245 | Train Loss: 0.4291983 Vali Loss: 0.5844429 Best vali loss: 0.5567484
	iters: 100, epoch: 8 | loss: 0.5609109
	speed: 0.0304s/iter; left time: 4.4376s
	iters: 200, epoch: 8 | loss: 0.4608828
	speed: 0.0105s/iter; left time: 0.4839s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.716008424758911
Epoch: 8, Steps: 245 | Train Loss: 0.5108969 Vali Loss: 0.5931602 Best vali loss: 0.5567484

best validation loss 0.5567484412519869

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.010890309514, 'e_layers': 4, 'learning_rate': 7.09981557e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.8065668
	speed: 0.0204s/iter; left time: 157.5611s
	iters: 200, epoch: 1 | loss: 0.6976092
	speed: 0.0117s/iter; left time: 89.4248s
	iters: 300, epoch: 1 | loss: 0.5042892
	speed: 0.0114s/iter; left time: 85.6020s
	iters: 400, epoch: 1 | loss: 0.2871116
	speed: 0.0119s/iter; left time: 88.7849s
	iters: 500, epoch: 1 | loss: 0.9477870
	speed: 0.0116s/iter; left time: 84.9479s
	iters: 600, epoch: 1 | loss: 0.4296622
	speed: 0.0116s/iter; left time: 84.2363s
	iters: 700, epoch: 1 | loss: 1.0654855
	speed: 0.0113s/iter; left time: 80.3213s
	iters: 800, epoch: 1 | loss: 0.6371211
	speed: 0.0103s/iter; left time: 72.4386s
	iters: 900, epoch: 1 | loss: 0.5703784
	speed: 0.0113s/iter; left time: 78.4028s
Updating learning rate to 6.829594929863977e-05
Validation loss decreased (inf --> 0.6028).  Saving model state dict ...
Epoch: 1 cost time: 11.821542024612427
Epoch: 1, Steps: 979 | Train Loss: 0.7717790 Vali Loss: 0.6028283 Best vali loss: 0.6028283
	iters: 100, epoch: 2 | loss: 0.5728496
	speed: 0.0467s/iter; left time: 315.4002s
	iters: 200, epoch: 2 | loss: 0.6136965
	speed: 0.0136s/iter; left time: 90.3266s
	iters: 300, epoch: 2 | loss: 0.7399938
	speed: 0.0115s/iter; left time: 75.5670s
	iters: 400, epoch: 2 | loss: 0.2918652
	speed: 0.0120s/iter; left time: 77.1376s
	iters: 500, epoch: 2 | loss: 0.8013695
	speed: 0.0117s/iter; left time: 74.3549s
	iters: 600, epoch: 2 | loss: 0.3760522
	speed: 0.0117s/iter; left time: 73.0221s
	iters: 700, epoch: 2 | loss: 0.5118450
	speed: 0.0113s/iter; left time: 69.7976s
	iters: 800, epoch: 2 | loss: 1.4656487
	speed: 0.0144s/iter; left time: 87.4744s
	iters: 900, epoch: 2 | loss: 0.7705036
	speed: 0.0115s/iter; left time: 68.6711s
Updating learning rate to 6.0600716523604165e-05
Validation loss decreased (0.6028 --> 0.5805).  Saving model state dict ...
Epoch: 2 cost time: 11.930989742279053
Epoch: 2, Steps: 979 | Train Loss: 0.6826471 Vali Loss: 0.5804984 Best vali loss: 0.5804984
	iters: 100, epoch: 3 | loss: 0.9431508
	speed: 0.0440s/iter; left time: 254.2125s
	iters: 200, epoch: 3 | loss: 0.6232007
	speed: 0.0120s/iter; left time: 68.0804s
	iters: 300, epoch: 3 | loss: 0.7225767
	speed: 0.0122s/iter; left time: 67.8941s
	iters: 400, epoch: 3 | loss: 0.9944332
	speed: 0.0117s/iter; left time: 64.1178s
	iters: 500, epoch: 3 | loss: 0.9358393
	speed: 0.0145s/iter; left time: 77.8916s
	iters: 600, epoch: 3 | loss: 1.0873094
	speed: 0.0153s/iter; left time: 80.5764s
	iters: 700, epoch: 3 | loss: 0.7521042
	speed: 0.0143s/iter; left time: 73.9831s
	iters: 800, epoch: 3 | loss: 0.6934181
	speed: 0.0131s/iter; left time: 66.6701s
	iters: 900, epoch: 3 | loss: 0.9501691
	speed: 0.0151s/iter; left time: 75.2246s
Updating learning rate to 4.9083986807433535e-05
Epoch: 3 cost time: 13.009046077728271
Epoch: 3, Steps: 979 | Train Loss: 0.8558002 Vali Loss: 0.6054561 Best vali loss: 0.5804984

best validation loss 0.5804984265734122

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8481805
	speed: 0.0161s/iter; left time: 14.2487s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.6699).  Saving model state dict ...
Epoch: 1 cost time: 1.705862045288086
Epoch: 1, Steps: 123 | Train Loss: 0.8481805 Vali Loss: 0.6699286 Best vali loss: 0.6699286
	iters: 100, epoch: 2 | loss: 0.6296231
	speed: 0.0275s/iter; left time: 20.9785s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.6699 --> 0.6448).  Saving model state dict ...
Epoch: 2 cost time: 2.498565912246704
Epoch: 2, Steps: 123 | Train Loss: 0.6296231 Vali Loss: 0.6447909 Best vali loss: 0.6447909
	iters: 100, epoch: 3 | loss: 0.9809685
	speed: 0.0287s/iter; left time: 18.3655s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.6448 --> 0.6316).  Saving model state dict ...
Epoch: 3 cost time: 2.2459700107574463
Epoch: 3, Steps: 123 | Train Loss: 0.9809685 Vali Loss: 0.6316080 Best vali loss: 0.6316080

best validation loss 0.6316079751643137

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0045499900215, 'e_layers': 3, 'learning_rate': 0.0001562179321, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8556624
	speed: 0.0217s/iter; left time: 40.4495s
	iters: 200, epoch: 1 | loss: 0.8912011
	speed: 0.0162s/iter; left time: 28.5467s
Updating learning rate to 0.00015027224108921395
Validation loss decreased (inf --> 0.6248).  Saving model state dict ...
Epoch: 1 cost time: 3.8161470890045166
Epoch: 1, Steps: 245 | Train Loss: 0.8734317 Vali Loss: 0.6247540 Best vali loss: 0.6247540
	iters: 100, epoch: 2 | loss: 0.7155370
	speed: 0.0180s/iter; left time: 29.1009s
	iters: 200, epoch: 2 | loss: 0.9628841
	speed: 0.0102s/iter; left time: 15.4418s
Updating learning rate to 0.0001333403456154248
Validation loss decreased (0.6248 --> 0.6194).  Saving model state dict ...
Epoch: 2 cost time: 2.4199020862579346
Epoch: 2, Steps: 245 | Train Loss: 0.8392105 Vali Loss: 0.6194399 Best vali loss: 0.6194399
	iters: 100, epoch: 3 | loss: 0.9098001
	speed: 0.0190s/iter; left time: 26.0678s
	iters: 200, epoch: 3 | loss: 1.0774230
	speed: 0.0100s/iter; left time: 12.6777s
Updating learning rate to 0.00010799997327650227
Validation loss decreased (0.6194 --> 0.6025).  Saving model state dict ...
Epoch: 3 cost time: 2.375488042831421
Epoch: 3, Steps: 245 | Train Loss: 0.9936115 Vali Loss: 0.6024731 Best vali loss: 0.6024731

best validation loss 0.6024730887086455

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.010890309514, 'e_layers': 4, 'learning_rate': 7.09981557e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1705421
	speed: 0.0167s/iter; left time: 80.2859s
	iters: 200, epoch: 4 | loss: 0.6889908
	speed: 0.0081s/iter; left time: 38.0694s
	iters: 300, epoch: 4 | loss: 0.3329936
	speed: 0.0138s/iter; left time: 63.5629s
	iters: 400, epoch: 4 | loss: 0.2642502
	speed: 0.0137s/iter; left time: 61.6970s
	iters: 500, epoch: 4 | loss: 0.9022143
	speed: 0.0140s/iter; left time: 61.4397s
	iters: 600, epoch: 4 | loss: 0.4360850
	speed: 0.0137s/iter; left time: 58.7505s
	iters: 700, epoch: 4 | loss: 0.9330162
	speed: 0.0141s/iter; left time: 59.1332s
	iters: 800, epoch: 4 | loss: 0.6248659
	speed: 0.0137s/iter; left time: 55.9548s
	iters: 900, epoch: 4 | loss: 0.6182532
	speed: 0.0114s/iter; left time: 45.4826s
Updating learning rate to 3.549907785e-05
Validation loss decreased (0.5805 --> 0.5720).  Saving model state dict ...
Epoch: 4 cost time: 12.69119930267334
Epoch: 4, Steps: 979 | Train Loss: 0.6634679 Vali Loss: 0.5719694 Best vali loss: 0.5719694
	iters: 100, epoch: 5 | loss: 0.4392901
	speed: 0.1146s/iter; left time: 437.5315s
	iters: 200, epoch: 5 | loss: 0.6164382
	speed: 0.0168s/iter; left time: 62.2861s
	iters: 300, epoch: 5 | loss: 0.6547029
	speed: 0.0172s/iter; left time: 62.0562s
	iters: 400, epoch: 5 | loss: 0.2850198
	speed: 0.0157s/iter; left time: 55.0924s
	iters: 500, epoch: 5 | loss: 0.6610873
	speed: 0.0144s/iter; left time: 49.3373s
	iters: 600, epoch: 5 | loss: 0.3801124
	speed: 0.0114s/iter; left time: 37.7548s
	iters: 700, epoch: 5 | loss: 0.4627856
	speed: 0.0098s/iter; left time: 31.6574s
	iters: 800, epoch: 5 | loss: 1.2780784
	speed: 0.0123s/iter; left time: 38.3735s
	iters: 900, epoch: 5 | loss: 0.5835744
	speed: 0.0127s/iter; left time: 38.1806s
Updating learning rate to 2.191416889256647e-05
Validation loss decreased (0.5720 --> 0.5623).  Saving model state dict ...
Epoch: 5 cost time: 13.739844560623169
Epoch: 5, Steps: 979 | Train Loss: 0.5956766 Vali Loss: 0.5622522 Best vali loss: 0.5622522
	iters: 100, epoch: 6 | loss: 0.8743355
	speed: 0.0560s/iter; left time: 158.9845s
	iters: 200, epoch: 6 | loss: 0.6070958
	speed: 0.0129s/iter; left time: 35.3999s
	iters: 300, epoch: 6 | loss: 0.7147403
	speed: 0.0135s/iter; left time: 35.6286s
	iters: 400, epoch: 6 | loss: 0.9802066
	speed: 0.0146s/iter; left time: 37.0804s
	iters: 500, epoch: 6 | loss: 0.7702646
	speed: 0.0084s/iter; left time: 20.5961s
	iters: 600, epoch: 6 | loss: 1.0903940
	speed: 0.0097s/iter; left time: 22.5832s
	iters: 700, epoch: 6 | loss: 0.4259678
	speed: 0.0103s/iter; left time: 22.9608s
	iters: 800, epoch: 6 | loss: 0.6789252
	speed: 0.0101s/iter; left time: 21.6653s
	iters: 900, epoch: 6 | loss: 0.9395626
	speed: 0.0100s/iter; left time: 20.2816s
Updating learning rate to 1.0397439176395836e-05
Validation loss decreased (0.5623 --> 0.5582).  Saving model state dict ...
Epoch: 6 cost time: 11.169506788253784
Epoch: 6, Steps: 979 | Train Loss: 0.7868325 Vali Loss: 0.5582298 Best vali loss: 0.5582298
	iters: 100, epoch: 7 | loss: 0.4750187
	speed: 0.0281s/iter; left time: 52.2400s
	iters: 200, epoch: 7 | loss: 0.7715189
	speed: 0.0099s/iter; left time: 17.4203s
	iters: 300, epoch: 7 | loss: 0.8865870
	speed: 0.0108s/iter; left time: 17.8560s
	iters: 400, epoch: 7 | loss: 0.3575153
	speed: 0.0107s/iter; left time: 16.7578s
	iters: 500, epoch: 7 | loss: 0.9663256
	speed: 0.0089s/iter; left time: 13.0077s
	iters: 600, epoch: 7 | loss: 0.9490632
	speed: 0.0081s/iter; left time: 10.9796s
	iters: 700, epoch: 7 | loss: 0.3217986
	speed: 0.0087s/iter; left time: 10.9491s
	iters: 800, epoch: 7 | loss: 0.2901943
	speed: 0.0096s/iter; left time: 11.1387s
	iters: 900, epoch: 7 | loss: 0.8127302
	speed: 0.0090s/iter; left time: 9.5690s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0042539720696, 'e_layers': 2, 'learning_rate': 0.0003142995314, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4487171
	speed: 0.0148s/iter; left time: 27.5854s
	iters: 200, epoch: 1 | loss: 0.7713091
	speed: 0.0061s/iter; left time: 10.7583s
Updating learning rate to 0.0003142995314
Validation loss decreased (inf --> 0.6153).  Saving model state dict ...
Epoch: 1 cost time: 2.0220859050750732
Epoch: 1, Steps: 245 | Train Loss: 0.6100131 Vali Loss: 0.6152843 Best vali loss: 0.6152843
	iters: 100, epoch: 2 | loss: 0.6443071
	speed: 0.0194s/iter; left time: 31.2800s
	iters: 200, epoch: 2 | loss: 0.7880453
	speed: 0.0141s/iter; left time: 21.4264s
Updating learning rate to 0.0001571497657
Validation loss decreased (0.6153 --> 0.6061).  Saving model state dict ...
Epoch: 2 cost time: 3.6285674571990967
Epoch: 2, Steps: 245 | Train Loss: 0.7161762 Vali Loss: 0.6060592 Best vali loss: 0.6060592
	iters: 100, epoch: 3 | loss: 0.8719859
	speed: 0.0385s/iter; left time: 52.7684s
	iters: 200, epoch: 3 | loss: 0.7989833
	speed: 0.0153s/iter; left time: 19.5062s
Updating learning rate to 7.857488285e-05
Epoch: 3 cost time: 3.776271343231201
Epoch: 3, Steps: 245 | Train Loss: 0.8354846 Vali Loss: 0.6113746 Best vali loss: 0.6060592
	iters: 100, epoch: 4 | loss: 0.8437419
	speed: 0.0323s/iter; left time: 36.3343s
	iters: 200, epoch: 4 | loss: 0.8309227
	speed: 0.0124s/iter; left time: 12.6952s
Updating learning rate to 3.9287441425e-05
Validation loss decreased (0.6061 --> 0.6040).  Saving model state dict ...
Epoch: 4 cost time: 3.360051155090332
Epoch: 4, Steps: 245 | Train Loss: 0.8373323 Vali Loss: 0.6040226 Best vali loss: 0.6040226
	iters: 100, epoch: 5 | loss: 0.8554363
	speed: 0.0235s/iter; left time: 20.6697s
	iters: 200, epoch: 5 | loss: 0.9898651
	speed: 0.0183s/iter; left time: 14.3048s
Updating learning rate to 1.96437207125e-05
Epoch: 5 cost time: 3.537454605102539
Epoch: 5, Steps: 245 | Train Loss: 0.9226507 Vali Loss: 0.6052390 Best vali loss: 0.6040226
	iters: 100, epoch: 6 | loss: 0.7433139
	speed: 0.0370s/iter; left time: 23.5537s
	iters: 200, epoch: 6 | loss: 0.8662471
	speed: 0.0208s/iter; left time: 11.1659s
Updating learning rate to 9.82186035625e-06
Epoch: 6 cost time: 5.365562677383423
Epoch: 6, Steps: 245 | Train Loss: 0.8047805 Vali Loss: 0.6051786 Best vali loss: 0.6040226
	iters: 100, epoch: 7 | loss: 1.0209767
	speed: 0.0568s/iter; left time: 22.2248s
	iters: 200, epoch: 7 | loss: 0.5784706
	speed: 0.0209s/iter; left time: 6.0812s
Updating learning rate to 4.910930178125e-06
Epoch: 7 cost time: 5.403140068054199
Epoch: 7, Steps: 245 | Train Loss: 0.7997237 Vali Loss: 0.6056819 Best vali loss: 0.6040226
	iters: 100, epoch: 8 | loss: 0.5613192
	speed: 0.0390s/iter; left time: 5.6929s
	iters: 200, epoch: 8 | loss: 0.8408928
	speed: 0.0161s/iter; left time: 0.7410s
Updating learning rate to 2.4554650890625e-06
Epoch: 8 cost time: 4.288746118545532
Epoch: 8, Steps: 245 | Train Loss: 0.7011060 Vali Loss: 0.6058530 Best vali loss: 0.6040226

best validation loss 0.6040225598835273

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0013296661499, 'e_layers': 3, 'learning_rate': 0.0001100824216, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9269144
	speed: 0.0373s/iter; left time: 32.9814s
Updating learning rate to 0.00010589265890275919
Validation loss decreased (inf --> 0.5988).  Saving model state dict ...
Epoch: 1 cost time: 4.01263427734375
Epoch: 1, Steps: 123 | Train Loss: 0.9269144 Vali Loss: 0.5988352 Best vali loss: 0.5988352
	iters: 100, epoch: 2 | loss: 0.8560573
	speed: 0.0575s/iter; left time: 43.7800s
Updating learning rate to 9.396122420139823e-05
Validation loss decreased (0.5988 --> 0.5952).  Saving model state dict ...
Epoch: 2 cost time: 4.299180746078491
Epoch: 2, Steps: 123 | Train Loss: 0.8560573 Vali Loss: 0.5952213 Best vali loss: 0.5952213
	iters: 100, epoch: 3 | loss: 0.7145843
	speed: 0.0518s/iter; left time: 33.0791s
Updating learning rate to 7.610457027047445e-05
Validation loss decreased (0.5952 --> 0.5663).  Saving model state dict ...
Epoch: 3 cost time: 3.3059909343719482
Epoch: 3, Steps: 123 | Train Loss: 0.7145843 Vali Loss: 0.5663377 Best vali loss: 0.5663377
	iters: 100, epoch: 4 | loss: 0.8170657
	speed: 0.0489s/iter; left time: 25.2155s
Updating learning rate to 5.50412108e-05
Epoch: 4 cost time: 2.7703959941864014
Epoch: 4, Steps: 123 | Train Loss: 0.8170657 Vali Loss: 0.5666927 Best vali loss: 0.5663377
	iters: 100, epoch: 5 | loss: 0.6359921
	speed: 0.0170s/iter; left time: 6.6989s
Updating learning rate to 3.3977851329525555e-05
Validation loss decreased (0.5663 --> 0.5506).  Saving model state dict ...
Epoch: 5 cost time: 1.4060308933258057
Epoch: 5, Steps: 123 | Train Loss: 0.6359921 Vali Loss: 0.5506229 Best vali loss: 0.5506229
	iters: 100, epoch: 6 | loss: 0.9544035
	speed: 0.0189s/iter; left time: 5.1065s
Updating learning rate to 1.6121197398601768e-05
Validation loss decreased (0.5506 --> 0.5445).  Saving model state dict ...
Epoch: 6 cost time: 1.5534274578094482
Epoch: 6, Steps: 123 | Train Loss: 0.9544035 Vali Loss: 0.5444845 Best vali loss: 0.5444845
	iters: 100, epoch: 7 | loss: 0.8875378
	speed: 0.0178s/iter; left time: 2.6213s
Updating learning rate to 4.189762697240813e-06
Epoch: 7 cost time: 1.454801321029663
Epoch: 7, Steps: 123 | Train Loss: 0.8875378 Vali Loss: 0.5456639 Best vali loss: 0.5444845
	iters: 100, epoch: 8 | loss: 0.7174491
	speed: 0.0179s/iter; left time: 0.4302s
Updating learning rate to 0.0
Validation loss decreased (0.5445 --> 0.5439).  Saving model state dict ...
Epoch: 8 cost time: 1.4142498970031738
Epoch: 8, Steps: 123 | Train Loss: 0.7174491 Vali Loss: 0.5438900 Best vali loss: 0.5438900

best validation loss 0.5438900080228062

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047346959752, 'e_layers': 2, 'learning_rate': 6.2121158e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.2121158e-05
Validation loss decreased (inf --> 0.7048).  Saving model state dict ...
Epoch: 1 cost time: 1.0369303226470947
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7048476 Best vali loss: 0.7048476
Updating learning rate to 3.1060579e-05
Validation loss decreased (0.7048 --> 0.6941).  Saving model state dict ...
Epoch: 2 cost time: 0.9069168567657471
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6941222 Best vali loss: 0.6941222
Updating learning rate to 1.55302895e-05
Validation loss decreased (0.6941 --> 0.6889).  Saving model state dict ...
Epoch: 3 cost time: 0.7218146324157715
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6889013 Best vali loss: 0.6889013

best validation loss 0.6889012967861675

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0037119342294, 'e_layers': 1, 'learning_rate': 0.001111853217, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010695358236715651
Validation loss decreased (inf --> 0.6100).  Saving model state dict ...
Epoch: 1 cost time: 0.9686408042907715
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6100318 Best vali loss: 0.6100318
Updating learning rate to 0.0009490260832123891
Epoch: 2 cost time: 0.6964206695556641
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6201984 Best vali loss: 0.6100318
Updating learning rate to 0.0007686705111838636
Epoch: 3 cost time: 0.636955738067627
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6464272 Best vali loss: 0.6100318

best validation loss 0.6100318078253347

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012054035715, 'e_layers': 1, 'learning_rate': 0.000380413518, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5954379
	speed: 0.0145s/iter; left time: 55.4349s
	iters: 200, epoch: 1 | loss: 0.8273300
	speed: 0.0077s/iter; left time: 28.6135s
	iters: 300, epoch: 1 | loss: 1.0617968
	speed: 0.0086s/iter; left time: 31.0726s
	iters: 400, epoch: 1 | loss: 0.5369465
	speed: 0.0080s/iter; left time: 28.2699s
Updating learning rate to 0.000365934890585407
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 4.302465200424194
Epoch: 1, Steps: 490 | Train Loss: 0.7553778 Vali Loss: 0.6040244 Best vali loss: 0.6040244
	iters: 100, epoch: 2 | loss: 0.3751926
	speed: 0.0234s/iter; left time: 78.0117s
	iters: 200, epoch: 2 | loss: 0.7672252
	speed: 0.0085s/iter; left time: 27.4614s
	iters: 300, epoch: 2 | loss: 0.7252058
	speed: 0.0070s/iter; left time: 21.8251s
	iters: 400, epoch: 2 | loss: 0.9848455
	speed: 0.0074s/iter; left time: 22.5323s
Updating learning rate to 0.00032470324811641535
Epoch: 2 cost time: 3.7307305335998535
Epoch: 2, Steps: 490 | Train Loss: 0.7131173 Vali Loss: 0.6122118 Best vali loss: 0.6040244
	iters: 100, epoch: 3 | loss: 0.9642005
	speed: 0.0239s/iter; left time: 67.8343s
	iters: 200, epoch: 3 | loss: 0.9900445
	speed: 0.0065s/iter; left time: 17.7640s
	iters: 300, epoch: 3 | loss: 1.0836223
	speed: 0.0038s/iter; left time: 10.0880s
	iters: 400, epoch: 3 | loss: 1.0334016
	speed: 0.0038s/iter; left time: 9.6821s
Updating learning rate to 0.00026299573439315943
Epoch: 3 cost time: 2.6080689430236816
Epoch: 3, Steps: 490 | Train Loss: 1.0178172 Vali Loss: 0.6366810 Best vali loss: 0.6040244

best validation loss 0.6040243682335615

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012054035715, 'e_layers': 1, 'learning_rate': 0.000380413518, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4851357
	speed: 0.0113s/iter; left time: 26.4569s
	iters: 200, epoch: 4 | loss: 0.6853324
	speed: 0.0046s/iter; left time: 10.2474s
	iters: 300, epoch: 4 | loss: 1.0256383
	speed: 0.0047s/iter; left time: 10.1342s
	iters: 400, epoch: 4 | loss: 0.5529301
	speed: 0.0045s/iter; left time: 9.3083s
Updating learning rate to 0.000190206759
Epoch: 4 cost time: 2.600393772125244
Epoch: 4, Steps: 490 | Train Loss: 0.6872591 Vali Loss: 0.6153152 Best vali loss: 0.6040244
	iters: 100, epoch: 5 | loss: 0.3523545
	speed: 0.0141s/iter; left time: 26.2560s
	iters: 200, epoch: 5 | loss: 0.7633306
	speed: 0.0045s/iter; left time: 7.9530s
	iters: 300, epoch: 5 | loss: 0.6318688
	speed: 0.0044s/iter; left time: 7.2522s
	iters: 400, epoch: 5 | loss: 0.9337146
	speed: 0.0046s/iter; left time: 7.1283s
Updating learning rate to 0.00011741778360684058
Epoch: 5 cost time: 2.266702651977539
Epoch: 5, Steps: 490 | Train Loss: 0.6703171 Vali Loss: 0.6615042 Best vali loss: 0.6040244
	iters: 100, epoch: 6 | loss: 0.8841233
	speed: 0.0143s/iter; left time: 19.6642s
	iters: 200, epoch: 6 | loss: 0.8615069
	speed: 0.0045s/iter; left time: 5.7826s
	iters: 300, epoch: 6 | loss: 0.9181629
	speed: 0.0046s/iter; left time: 5.3570s
	iters: 400, epoch: 6 | loss: 0.8726557
	speed: 0.0047s/iter; left time: 5.0446s
Updating learning rate to 5.571026988358463e-05
Epoch: 6 cost time: 2.30147385597229
Epoch: 6, Steps: 490 | Train Loss: 0.8841122 Vali Loss: 0.6560076 Best vali loss: 0.6040244
	iters: 100, epoch: 7 | loss: 0.7175339
	speed: 0.0135s/iter; left time: 11.8757s
	iters: 200, epoch: 7 | loss: 0.5243124
	speed: 0.0041s/iter; left time: 3.2336s
	iters: 300, epoch: 7 | loss: 0.2505681
	speed: 0.0044s/iter; left time: 2.9954s
	iters: 400, epoch: 7 | loss: 0.6541034
	speed: 0.0046s/iter; left time: 2.6462s
Updating learning rate to 1.4478627414593018e-05
Epoch: 7 cost time: 2.1690900325775146
Epoch: 7, Steps: 490 | Train Loss: 0.5366295 Vali Loss: 0.6599859 Best vali loss: 0.6040244
	iters: 100, epoch: 8 | loss: 0.5072812
	speed: 0.0139s/iter; left time: 5.4324s
	iters: 200, epoch: 8 | loss: 1.1199725
	speed: 0.0045s/iter; left time: 1.3132s
	iters: 300, epoch: 8 | loss: 0.9380128
	speed: 0.0047s/iter; left time: 0.8949s
	iters: 400, epoch: 8 | loss: 0.5507645
	speed: 0.0046s/iter; left time: 0.4155s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.283284902572632
Epoch: 8, Steps: 490 | Train Loss: 0.7790077 Vali Loss: 0.6590239 Best vali loss: 0.6040244

best validation loss 0.6040243682335615

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0082598314051, 'e_layers': 2, 'learning_rate': 0.0001301574132, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0001252035916300472
Validation loss decreased (inf --> 0.6446).  Saving model state dict ...
Epoch: 1 cost time: 0.7883608341217041
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6445544 Best vali loss: 0.6445544
Updating learning rate to 0.00011109630134770973
Validation loss decreased (0.6446 --> 0.6182).  Saving model state dict ...
Epoch: 2 cost time: 0.51651930809021
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6182194 Best vali loss: 0.6182194
Updating learning rate to 8.998324941556862e-05
Validation loss decreased (0.6182 --> 0.6076).  Saving model state dict ...
Epoch: 3 cost time: 0.5206031799316406
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6076282 Best vali loss: 0.6076282
Updating learning rate to 6.50787066e-05
Validation loss decreased (0.6076 --> 0.6060).  Saving model state dict ...
Epoch: 4 cost time: 0.5067324638366699
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6059546 Best vali loss: 0.6059546
Updating learning rate to 4.017416378443138e-05
Validation loss decreased (0.6060 --> 0.6036).  Saving model state dict ...
Epoch: 5 cost time: 0.5016889572143555
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6035833 Best vali loss: 0.6035833
Updating learning rate to 1.906111185229028e-05
Validation loss decreased (0.6036 --> 0.6021).  Saving model state dict ...
Epoch: 6 cost time: 0.5403218269348145
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6020851 Best vali loss: 0.6020851
Updating learning rate to 4.953821569952809e-06
Epoch: 7 cost time: 0.5092034339904785
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6025500 Best vali loss: 0.6020851
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4894289970397949
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6022928 Best vali loss: 0.6020851

best validation loss 0.6020850835437854

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0038481438487, 'e_layers': 2, 'learning_rate': 0.0029619392807, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4292969
	speed: 0.0118s/iter; left time: 45.0576s
	iters: 200, epoch: 1 | loss: 0.7408636
	speed: 0.0057s/iter; left time: 21.0528s
	iters: 300, epoch: 1 | loss: 0.7453933
	speed: 0.0060s/iter; left time: 21.8993s
	iters: 400, epoch: 1 | loss: 0.5184173
	speed: 0.0062s/iter; left time: 21.7126s
Updating learning rate to 0.0029619392807
Validation loss decreased (inf --> 0.6513).  Saving model state dict ...
Epoch: 1 cost time: 3.2466065883636475
Epoch: 1, Steps: 490 | Train Loss: 0.8584928 Vali Loss: 0.6512998 Best vali loss: 0.6512998
	iters: 100, epoch: 2 | loss: 1.0861690
	speed: 0.0182s/iter; left time: 60.5606s
	iters: 200, epoch: 2 | loss: 0.6935664
	speed: 0.0064s/iter; left time: 20.6476s
	iters: 300, epoch: 2 | loss: 1.8008258
	speed: 0.0065s/iter; left time: 20.2719s
	iters: 400, epoch: 2 | loss: 1.1451280
	speed: 0.0067s/iter; left time: 20.2480s
Updating learning rate to 0.00148096964035
Validation loss decreased (0.6513 --> 0.6312).  Saving model state dict ...
Epoch: 2 cost time: 3.221787214279175
Epoch: 2, Steps: 490 | Train Loss: 1.1814223 Vali Loss: 0.6312441 Best vali loss: 0.6312441
	iters: 100, epoch: 3 | loss: 0.5234709
	speed: 0.0173s/iter; left time: 49.0953s
	iters: 200, epoch: 3 | loss: 0.6524029
	speed: 0.0054s/iter; left time: 14.6701s
	iters: 300, epoch: 3 | loss: 0.7886267
	speed: 0.0084s/iter; left time: 22.3126s
	iters: 400, epoch: 3 | loss: 1.7832977
	speed: 0.0082s/iter; left time: 20.8193s
Updating learning rate to 0.000740484820175
Epoch: 3 cost time: 3.5941147804260254
Epoch: 3, Steps: 490 | Train Loss: 0.9369496 Vali Loss: 0.6489624 Best vali loss: 0.6312441
	iters: 100, epoch: 4 | loss: 1.1659341
	speed: 0.0240s/iter; left time: 56.3414s
	iters: 200, epoch: 4 | loss: 0.8400741
	speed: 0.0082s/iter; left time: 18.5208s
	iters: 300, epoch: 4 | loss: 1.1864703
	speed: 0.0083s/iter; left time: 17.9410s
	iters: 400, epoch: 4 | loss: 0.8301800
	speed: 0.0081s/iter; left time: 16.6088s
Updating learning rate to 0.0003702424100875
Epoch: 4 cost time: 4.150909662246704
Epoch: 4, Steps: 490 | Train Loss: 1.0056646 Vali Loss: 0.6447516 Best vali loss: 0.6312441
	iters: 100, epoch: 5 | loss: 0.7869145
	speed: 0.0275s/iter; left time: 51.2468s
	iters: 200, epoch: 5 | loss: 0.8503591
	speed: 0.0091s/iter; left time: 16.0112s
	iters: 300, epoch: 5 | loss: 0.8774567
	speed: 0.0100s/iter; left time: 16.6368s
	iters: 400, epoch: 5 | loss: 0.6813115
	speed: 0.0088s/iter; left time: 13.7919s
Updating learning rate to 0.00018512120504375
Epoch: 5 cost time: 4.543689966201782
Epoch: 5, Steps: 490 | Train Loss: 0.7990105 Vali Loss: 0.6443946 Best vali loss: 0.6312441
	iters: 100, epoch: 6 | loss: 1.2557667
	speed: 0.0263s/iter; left time: 36.1069s
	iters: 200, epoch: 6 | loss: 1.2449124
	speed: 0.0090s/iter; left time: 11.4855s
	iters: 300, epoch: 6 | loss: 1.0446359
	speed: 0.0087s/iter; left time: 10.1430s
	iters: 400, epoch: 6 | loss: 0.9805680
	speed: 0.0095s/iter; left time: 10.1347s
Updating learning rate to 9.2560602521875e-05
Epoch: 6 cost time: 4.477567434310913
Epoch: 6, Steps: 490 | Train Loss: 1.1314708 Vali Loss: 0.6441388 Best vali loss: 0.6312441
	iters: 100, epoch: 7 | loss: 0.7720386
	speed: 0.0261s/iter; left time: 22.9792s
	iters: 200, epoch: 7 | loss: 0.4995414
	speed: 0.0088s/iter; left time: 6.8930s
	iters: 300, epoch: 7 | loss: 0.5757568
	speed: 0.0090s/iter; left time: 6.1339s
	iters: 400, epoch: 7 | loss: 0.6224881
	speed: 0.0097s/iter; left time: 5.6152s
Updating learning rate to 4.62803012609375e-05
Epoch: 7 cost time: 4.380227327346802
Epoch: 7, Steps: 490 | Train Loss: 0.6174562 Vali Loss: 0.6438429 Best vali loss: 0.6312441
	iters: 100, epoch: 8 | loss: 0.5868284
	speed: 0.0257s/iter; left time: 10.0563s
	iters: 200, epoch: 8 | loss: 0.7780734
	speed: 0.0109s/iter; left time: 3.1836s
	iters: 300, epoch: 8 | loss: 0.9499307
	speed: 0.0117s/iter; left time: 2.2370s
	iters: 400, epoch: 8 | loss: 0.7330348
	speed: 0.0107s/iter; left time: 0.9748s
Updating learning rate to 2.314015063046875e-05
Epoch: 8 cost time: 5.699383735656738
Epoch: 8, Steps: 490 | Train Loss: 0.7619668 Vali Loss: 0.6439741 Best vali loss: 0.6312441

best validation loss 0.6312441053640395

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9379280
	speed: 0.0226s/iter; left time: 42.0061s
	iters: 200, epoch: 1 | loss: 0.8380154
	speed: 0.0175s/iter; left time: 30.8860s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.6161).  Saving model state dict ...
Epoch: 1 cost time: 4.418174505233765
Epoch: 1, Steps: 245 | Train Loss: 0.8879717 Vali Loss: 0.6161222 Best vali loss: 0.6161222
	iters: 100, epoch: 2 | loss: 1.0010203
	speed: 0.0357s/iter; left time: 57.7348s
	iters: 200, epoch: 2 | loss: 0.7101033
	speed: 0.0163s/iter; left time: 24.6886s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.6161 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 4.311998605728149
Epoch: 2, Steps: 245 | Train Loss: 0.8555618 Vali Loss: 0.6038301 Best vali loss: 0.6038301
	iters: 100, epoch: 3 | loss: 1.1486980
	speed: 0.0479s/iter; left time: 65.6188s
	iters: 200, epoch: 3 | loss: 0.9286205
	speed: 0.0186s/iter; left time: 23.6883s
Updating learning rate to 7.441812635926816e-05
Validation loss decreased (0.6038 --> 0.6012).  Saving model state dict ...
Epoch: 3 cost time: 5.034475088119507
Epoch: 3, Steps: 245 | Train Loss: 1.0386592 Vali Loss: 0.6012048 Best vali loss: 0.6012048

best validation loss 0.6012047670440286

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.003384061485, 'e_layers': 3, 'learning_rate': 9.19244501e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9652390
	speed: 0.0409s/iter; left time: 36.1670s
Updating learning rate to 8.842578404237255e-05
Validation loss decreased (inf --> 0.6907).  Saving model state dict ...
Epoch: 1 cost time: 4.604060649871826
Epoch: 1, Steps: 123 | Train Loss: 0.9652390 Vali Loss: 0.6907096 Best vali loss: 0.6907096
	iters: 100, epoch: 2 | loss: 0.9127964
	speed: 0.0375s/iter; left time: 28.6083s
Updating learning rate to 7.846242606127721e-05
Validation loss decreased (0.6907 --> 0.6685).  Saving model state dict ...
Epoch: 2 cost time: 1.8420207500457764
Epoch: 2, Steps: 123 | Train Loss: 0.9127964 Vali Loss: 0.6685213 Best vali loss: 0.6685213
	iters: 100, epoch: 3 | loss: 0.7885354
	speed: 0.0244s/iter; left time: 15.5670s
Updating learning rate to 6.355120709127072e-05
Validation loss decreased (0.6685 --> 0.6514).  Saving model state dict ...
Epoch: 3 cost time: 1.437246561050415
Epoch: 3, Steps: 123 | Train Loss: 0.7885354 Vali Loss: 0.6513617 Best vali loss: 0.6513617

best validation loss 0.6513617353437124

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010602146623, 'e_layers': 1, 'learning_rate': 0.000796404306, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8765768
	speed: 0.0160s/iter; left time: 29.6965s
	iters: 200, epoch: 1 | loss: 0.5412790
	speed: 0.0131s/iter; left time: 23.1384s
Updating learning rate to 0.0007660929719586279
Validation loss decreased (inf --> 0.6159).  Saving model state dict ...
Epoch: 1 cost time: 3.1770575046539307
Epoch: 1, Steps: 245 | Train Loss: 0.7089279 Vali Loss: 0.6159418 Best vali loss: 0.6159418
	iters: 100, epoch: 2 | loss: 0.6446077
	speed: 0.0289s/iter; left time: 46.7266s
	iters: 200, epoch: 2 | loss: 0.8551831
	speed: 0.0159s/iter; left time: 24.1187s
Updating learning rate to 0.0006797735956693831
Validation loss decreased (0.6159 --> 0.6093).  Saving model state dict ...
Epoch: 2 cost time: 3.5490615367889404
Epoch: 2, Steps: 245 | Train Loss: 0.7498954 Vali Loss: 0.6092567 Best vali loss: 0.6092567
	iters: 100, epoch: 3 | loss: 1.1339173
	speed: 0.0319s/iter; left time: 43.7152s
	iters: 200, epoch: 3 | loss: 0.8571572
	speed: 0.0078s/iter; left time: 9.9630s
Updating learning rate to 0.0005505875196852087
Validation loss decreased (0.6093 --> 0.6009).  Saving model state dict ...
Epoch: 3 cost time: 2.6763412952423096
Epoch: 3, Steps: 245 | Train Loss: 0.9955373 Vali Loss: 0.6008978 Best vali loss: 0.6008978

best validation loss 0.6008977781479583

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010602146623, 'e_layers': 1, 'learning_rate': 0.000796404306, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8395718
	speed: 0.0211s/iter; left time: 23.7972s
	iters: 200, epoch: 4 | loss: 0.5179729
	speed: 0.0119s/iter; left time: 12.2183s
Updating learning rate to 0.000398202153
Epoch: 4 cost time: 3.369137763977051
Epoch: 4, Steps: 245 | Train Loss: 0.6787724 Vali Loss: 0.6303464 Best vali loss: 0.6008978
	iters: 100, epoch: 5 | loss: 0.6861760
	speed: 0.0299s/iter; left time: 26.2992s
	iters: 200, epoch: 5 | loss: 0.8399066
	speed: 0.0088s/iter; left time: 6.8492s
Updating learning rate to 0.0002458167863147914
Epoch: 5 cost time: 2.8300297260284424
Epoch: 5, Steps: 245 | Train Loss: 0.7630413 Vali Loss: 0.6299766 Best vali loss: 0.6008978
	iters: 100, epoch: 6 | loss: 1.0159353
	speed: 0.0232s/iter; left time: 14.7719s
	iters: 200, epoch: 6 | loss: 0.8008489
	speed: 0.0069s/iter; left time: 3.7061s
Updating learning rate to 0.0001166307103306169
Epoch: 6 cost time: 2.397535800933838
Epoch: 6, Steps: 245 | Train Loss: 0.9083921 Vali Loss: 0.6175882 Best vali loss: 0.6008978
	iters: 100, epoch: 7 | loss: 0.6229705
	speed: 0.0162s/iter; left time: 6.3262s
	iters: 200, epoch: 7 | loss: 0.7388011
	speed: 0.0072s/iter; left time: 2.0965s
Updating learning rate to 3.0311334041372124e-05
Epoch: 7 cost time: 1.8825318813323975
Epoch: 7, Steps: 245 | Train Loss: 0.6808858 Vali Loss: 0.6260639 Best vali loss: 0.6008978
	iters: 100, epoch: 8 | loss: 0.8413687
	speed: 0.0139s/iter; left time: 2.0365s
	iters: 200, epoch: 8 | loss: 0.8553295
	speed: 0.0040s/iter; left time: 0.1859s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1702473163604736
Epoch: 8, Steps: 245 | Train Loss: 0.8483491 Vali Loss: 0.6248953 Best vali loss: 0.6008978

best validation loss 0.6008977781479583

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0026888458224, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9219682
	speed: 0.0158s/iter; left time: 122.5423s
	iters: 200, epoch: 1 | loss: 1.6192183
	speed: 0.0092s/iter; left time: 69.8934s
	iters: 300, epoch: 1 | loss: 0.5635890
	speed: 0.0090s/iter; left time: 67.8843s
	iters: 400, epoch: 1 | loss: 1.4052771
	speed: 0.0085s/iter; left time: 62.9793s
	iters: 500, epoch: 1 | loss: 1.3352990
	speed: 0.0070s/iter; left time: 51.2376s
	iters: 600, epoch: 1 | loss: 1.4506655
	speed: 0.0086s/iter; left time: 62.1391s
	iters: 700, epoch: 1 | loss: 0.7082982
	speed: 0.0083s/iter; left time: 59.5501s
	iters: 800, epoch: 1 | loss: 0.7452798
	speed: 0.0084s/iter; left time: 59.2877s
	iters: 900, epoch: 1 | loss: 0.2740855
	speed: 0.0083s/iter; left time: 57.8772s
Updating learning rate to 0.0002954316154
Validation loss decreased (inf --> 0.6136).  Saving model state dict ...
Epoch: 1 cost time: 8.61439561843872
Epoch: 1, Steps: 979 | Train Loss: 1.0026312 Vali Loss: 0.6136292 Best vali loss: 0.6136292
	iters: 100, epoch: 2 | loss: 1.2519044
	speed: 0.0402s/iter; left time: 271.6108s
	iters: 200, epoch: 2 | loss: 1.1464590
	speed: 0.0121s/iter; left time: 80.8403s
	iters: 300, epoch: 2 | loss: 0.4250893
	speed: 0.0123s/iter; left time: 80.7075s
	iters: 400, epoch: 2 | loss: 0.3719777
	speed: 0.0146s/iter; left time: 94.1037s
	iters: 500, epoch: 2 | loss: 1.4964920
	speed: 0.0146s/iter; left time: 92.7916s
	iters: 600, epoch: 2 | loss: 1.1120981
	speed: 0.0120s/iter; left time: 74.9466s
	iters: 700, epoch: 2 | loss: 1.1062579
	speed: 0.0124s/iter; left time: 76.5293s
	iters: 800, epoch: 2 | loss: 1.1150278
	speed: 0.0124s/iter; left time: 75.2831s
	iters: 900, epoch: 2 | loss: 0.9584543
	speed: 0.0077s/iter; left time: 45.8483s
Updating learning rate to 0.0001477158077
Validation loss decreased (0.6136 --> 0.6125).  Saving model state dict ...
Epoch: 2 cost time: 11.926607847213745
Epoch: 2, Steps: 979 | Train Loss: 0.9981956 Vali Loss: 0.6125481 Best vali loss: 0.6125481
	iters: 100, epoch: 3 | loss: 1.0474811
	speed: 0.0533s/iter; left time: 307.6082s
	iters: 200, epoch: 3 | loss: 0.6256619
	speed: 0.0117s/iter; left time: 66.3847s
	iters: 300, epoch: 3 | loss: 0.6078113
	speed: 0.0113s/iter; left time: 63.0172s
	iters: 400, epoch: 3 | loss: 0.7858851
	speed: 0.0139s/iter; left time: 76.2271s
	iters: 500, epoch: 3 | loss: 0.5852380
	speed: 0.0128s/iter; left time: 68.7122s
	iters: 600, epoch: 3 | loss: 0.2829724
	speed: 0.0122s/iter; left time: 64.2454s
	iters: 700, epoch: 3 | loss: 0.6583391
	speed: 0.0122s/iter; left time: 62.9908s
	iters: 800, epoch: 3 | loss: 0.3277057
	speed: 0.0090s/iter; left time: 45.4990s
	iters: 900, epoch: 3 | loss: 0.3597100
	speed: 0.0076s/iter; left time: 37.8523s
Updating learning rate to 7.385790385e-05
Epoch: 3 cost time: 10.998093366622925
Epoch: 3, Steps: 979 | Train Loss: 0.5867561 Vali Loss: 0.6203556 Best vali loss: 0.6125481
	iters: 100, epoch: 4 | loss: 0.6314585
	speed: 0.0283s/iter; left time: 135.7693s
	iters: 200, epoch: 4 | loss: 0.2766428
	speed: 0.0081s/iter; left time: 37.8154s
	iters: 300, epoch: 4 | loss: 1.2338500
	speed: 0.0079s/iter; left time: 36.4212s
	iters: 400, epoch: 4 | loss: 0.4605210
	speed: 0.0083s/iter; left time: 37.5156s
	iters: 500, epoch: 4 | loss: 0.3488661
	speed: 0.0088s/iter; left time: 38.7745s
	iters: 600, epoch: 4 | loss: 1.0899734
	speed: 0.0080s/iter; left time: 34.5218s
	iters: 700, epoch: 4 | loss: 0.6749026
	speed: 0.0079s/iter; left time: 33.0518s
	iters: 800, epoch: 4 | loss: 1.6197089
	speed: 0.0081s/iter; left time: 33.0305s
	iters: 900, epoch: 4 | loss: 0.3511992
	speed: 0.0079s/iter; left time: 31.4083s
Updating learning rate to 3.6928951925e-05
Epoch: 4 cost time: 8.000356674194336
Epoch: 4, Steps: 979 | Train Loss: 0.7430136 Vali Loss: 0.6187788 Best vali loss: 0.6125481
	iters: 100, epoch: 5 | loss: 0.6338575
	speed: 0.0297s/iter; left time: 113.5227s
	iters: 200, epoch: 5 | loss: 0.2472237
	speed: 0.0079s/iter; left time: 29.5485s
	iters: 300, epoch: 5 | loss: 0.4698291
	speed: 0.0080s/iter; left time: 28.9118s
	iters: 400, epoch: 5 | loss: 0.5492485
	speed: 0.0080s/iter; left time: 28.2611s
	iters: 500, epoch: 5 | loss: 0.9296683
	speed: 0.0091s/iter; left time: 30.9765s
	iters: 600, epoch: 5 | loss: 1.0517378
	speed: 0.0061s/iter; left time: 20.3943s
	iters: 700, epoch: 5 | loss: 0.4447767
	speed: 0.0066s/iter; left time: 21.1997s
	iters: 800, epoch: 5 | loss: 1.3001705
	speed: 0.0084s/iter; left time: 26.2411s
	iters: 900, epoch: 5 | loss: 1.2525225
	speed: 0.0083s/iter; left time: 24.9464s
Updating learning rate to 1.84644759625e-05
Epoch: 5 cost time: 7.803096294403076
Epoch: 5, Steps: 979 | Train Loss: 0.7643372 Vali Loss: 0.6139619 Best vali loss: 0.6125481
	iters: 100, epoch: 6 | loss: 0.4019476
	speed: 0.0284s/iter; left time: 80.5185s
	iters: 200, epoch: 6 | loss: 0.4006391
	speed: 0.0087s/iter; left time: 23.7767s
	iters: 300, epoch: 6 | loss: 1.3467194
	speed: 0.0083s/iter; left time: 21.8462s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069459756953, 'e_layers': 2, 'learning_rate': 0.0031567606928, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7737556
	speed: 0.0141s/iter; left time: 26.2514s
	iters: 200, epoch: 1 | loss: 0.7252374
	speed: 0.0052s/iter; left time: 9.1635s
Updating learning rate to 0.003036613642957035
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 1.9104125499725342
Epoch: 1, Steps: 245 | Train Loss: 0.7494965 Vali Loss: 0.6164595 Best vali loss: 0.6164595
	iters: 100, epoch: 2 | loss: 0.9426442
	speed: 0.0163s/iter; left time: 26.2973s
	iters: 200, epoch: 2 | loss: 0.8644367
	speed: 0.0087s/iter; left time: 13.1273s
Updating learning rate to 0.002694463792631012
Epoch: 2 cost time: 2.1868834495544434
Epoch: 2, Steps: 245 | Train Loss: 0.9035405 Vali Loss: 0.6185313 Best vali loss: 0.6164595
	iters: 100, epoch: 3 | loss: 0.8364511
	speed: 0.0175s/iter; left time: 24.0290s
	iters: 200, epoch: 3 | loss: 1.1983433
	speed: 0.0075s/iter; left time: 9.4691s
Updating learning rate to 0.0021824003549379516
Validation loss decreased (0.6165 --> 0.6139).  Saving model state dict ...
Epoch: 3 cost time: 1.8703606128692627
Epoch: 3, Steps: 245 | Train Loss: 1.0173972 Vali Loss: 0.6139058 Best vali loss: 0.6139058
	iters: 100, epoch: 4 | loss: 0.7880021
	speed: 0.0133s/iter; left time: 14.9612s
	iters: 200, epoch: 4 | loss: 0.7619853
	speed: 0.0106s/iter; left time: 10.9012s
Updating learning rate to 0.0015783803464
Epoch: 4 cost time: 2.478055000305176
Epoch: 4, Steps: 245 | Train Loss: 0.7749937 Vali Loss: 0.6284097 Best vali loss: 0.6139058
	iters: 100, epoch: 5 | loss: 0.7830827
	speed: 0.0381s/iter; left time: 33.5362s
	iters: 200, epoch: 5 | loss: 0.6034768
	speed: 0.0166s/iter; left time: 12.9436s
Updating learning rate to 0.0009743603378620486
Epoch: 5 cost time: 4.1641809940338135
Epoch: 5, Steps: 245 | Train Loss: 0.6932797 Vali Loss: 0.6154364 Best vali loss: 0.6139058
	iters: 100, epoch: 6 | loss: 0.5820755
	speed: 0.0430s/iter; left time: 27.3175s
	iters: 200, epoch: 6 | loss: 0.4707069
	speed: 0.0169s/iter; left time: 9.0828s
Updating learning rate to 0.0004622969001689882
Epoch: 6 cost time: 3.9292378425598145
Epoch: 6, Steps: 245 | Train Loss: 0.5263912 Vali Loss: 0.6151419 Best vali loss: 0.6139058
	iters: 100, epoch: 7 | loss: 0.7648009
	speed: 0.0260s/iter; left time: 10.1804s
	iters: 200, epoch: 7 | loss: 0.9112168
	speed: 0.0152s/iter; left time: 4.4355s
Updating learning rate to 0.00012014704984296518
Validation loss decreased (0.6139 --> 0.6134).  Saving model state dict ...
Epoch: 7 cost time: 3.8170762062072754
Epoch: 7, Steps: 245 | Train Loss: 0.8380089 Vali Loss: 0.6134231 Best vali loss: 0.6134231
	iters: 100, epoch: 8 | loss: 1.0476096
	speed: 0.0367s/iter; left time: 5.3588s
	iters: 200, epoch: 8 | loss: 0.7489138
	speed: 0.0144s/iter; left time: 0.6640s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8880765438079834
Epoch: 8, Steps: 245 | Train Loss: 0.8982617 Vali Loss: 0.6146336 Best vali loss: 0.6134231

best validation loss 0.6134231213147526

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 3, 'learning_rate': 0.0013544172464, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8774869
	speed: 0.0209s/iter; left time: 38.9816s
	iters: 200, epoch: 1 | loss: 0.9995357
	speed: 0.0151s/iter; left time: 26.5509s
Updating learning rate to 0.0013544172464
Validation loss decreased (inf --> 0.6055).  Saving model state dict ...
Epoch: 1 cost time: 4.108731269836426
Epoch: 1, Steps: 245 | Train Loss: 0.9385113 Vali Loss: 0.6055369 Best vali loss: 0.6055369
	iters: 100, epoch: 2 | loss: 0.6508825
	speed: 0.0242s/iter; left time: 39.0704s
	iters: 200, epoch: 2 | loss: 0.7277433
	speed: 0.0095s/iter; left time: 14.3925s
Updating learning rate to 0.0006772086232
Epoch: 2 cost time: 2.461428165435791
Epoch: 2, Steps: 245 | Train Loss: 0.6893129 Vali Loss: 0.6232414 Best vali loss: 0.6055369
	iters: 100, epoch: 3 | loss: 0.7807615
	speed: 0.0200s/iter; left time: 27.4650s
	iters: 200, epoch: 3 | loss: 0.8617287
	speed: 0.0096s/iter; left time: 12.2508s
Updating learning rate to 0.0003386043116
Validation loss decreased (0.6055 --> 0.5955).  Saving model state dict ...
Epoch: 3 cost time: 2.4372940063476562
Epoch: 3, Steps: 245 | Train Loss: 0.8212451 Vali Loss: 0.5954868 Best vali loss: 0.5954868

best validation loss 0.5954867588706946

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.6042).  Saving model state dict ...
Epoch: 1 cost time: 1.1392695903778076
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6042384 Best vali loss: 0.6042384
Updating learning rate to 0.0005975820137081337
Epoch: 2 cost time: 0.9368846416473389
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6099734 Best vali loss: 0.6042384
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.8951590061187744
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6121767 Best vali loss: 0.6042384

best validation loss 0.6042384127674694

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 2.3358383
	speed: 0.0160s/iter; left time: 123.7378s
	iters: 200, epoch: 1 | loss: 1.2123019
	speed: 0.0097s/iter; left time: 73.8193s
	iters: 300, epoch: 1 | loss: 1.1163514
	speed: 0.0091s/iter; left time: 68.5019s
	iters: 400, epoch: 1 | loss: 0.3345290
	speed: 0.0090s/iter; left time: 67.0977s
	iters: 500, epoch: 1 | loss: 0.7807001
	speed: 0.0095s/iter; left time: 69.6165s
	iters: 600, epoch: 1 | loss: 1.4049903
	speed: 0.0092s/iter; left time: 66.4859s
	iters: 700, epoch: 1 | loss: 1.0068423
	speed: 0.0091s/iter; left time: 64.6558s
	iters: 800, epoch: 1 | loss: 0.8660811
	speed: 0.0087s/iter; left time: 61.4642s
	iters: 900, epoch: 1 | loss: 1.3942084
	speed: 0.0092s/iter; left time: 63.7128s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.6066).  Saving model state dict ...
Epoch: 1 cost time: 9.401922702789307
Epoch: 1, Steps: 979 | Train Loss: 1.1613159 Vali Loss: 0.6065905 Best vali loss: 0.6065905
	iters: 100, epoch: 2 | loss: 0.2503504
	speed: 0.0286s/iter; left time: 192.8721s
	iters: 200, epoch: 2 | loss: 0.2390729
	speed: 0.0096s/iter; left time: 64.0698s
	iters: 300, epoch: 2 | loss: 1.4310956
	speed: 0.0098s/iter; left time: 63.9271s
	iters: 400, epoch: 2 | loss: 1.0047297
	speed: 0.0093s/iter; left time: 59.9302s
	iters: 500, epoch: 2 | loss: 1.4901714
	speed: 0.0096s/iter; left time: 61.0908s
	iters: 600, epoch: 2 | loss: 1.0131340
	speed: 0.0093s/iter; left time: 58.2696s
	iters: 700, epoch: 2 | loss: 0.5593860
	speed: 0.0096s/iter; left time: 58.9550s
	iters: 800, epoch: 2 | loss: 1.2332467
	speed: 0.0087s/iter; left time: 52.4501s
	iters: 900, epoch: 2 | loss: 1.1524289
	speed: 0.0084s/iter; left time: 49.8891s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.6066 --> 0.5988).  Saving model state dict ...
Epoch: 2 cost time: 9.178295612335205
Epoch: 2, Steps: 979 | Train Loss: 0.9304017 Vali Loss: 0.5987726 Best vali loss: 0.5987726
	iters: 100, epoch: 3 | loss: 0.2479328
	speed: 0.0288s/iter; left time: 166.1491s
	iters: 200, epoch: 3 | loss: 1.2457858
	speed: 0.0079s/iter; left time: 44.9888s
	iters: 300, epoch: 3 | loss: 1.1723920
	speed: 0.0086s/iter; left time: 47.7385s
	iters: 400, epoch: 3 | loss: 0.4425430
	speed: 0.0097s/iter; left time: 53.0629s
	iters: 500, epoch: 3 | loss: 0.9554387
	speed: 0.0096s/iter; left time: 51.7627s
	iters: 600, epoch: 3 | loss: 1.2925987
	speed: 0.0097s/iter; left time: 51.2935s
	iters: 700, epoch: 3 | loss: 0.6577125
	speed: 0.0096s/iter; left time: 49.7288s
	iters: 800, epoch: 3 | loss: 0.7982015
	speed: 0.0082s/iter; left time: 41.4235s
	iters: 900, epoch: 3 | loss: 0.5916257
	speed: 0.0078s/iter; left time: 38.7767s
Updating learning rate to 0.0004164486617318853
Validation loss decreased (0.5988 --> 0.5796).  Saving model state dict ...
Epoch: 3 cost time: 8.76379132270813
Epoch: 3, Steps: 979 | Train Loss: 0.8226923 Vali Loss: 0.5796386 Best vali loss: 0.5796386

best validation loss 0.5796385643963238

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 2.2172174
	speed: 0.0152s/iter; left time: 72.8769s
	iters: 200, epoch: 4 | loss: 0.8107597
	speed: 0.0093s/iter; left time: 43.4762s
	iters: 300, epoch: 4 | loss: 1.0411210
	speed: 0.0083s/iter; left time: 37.9392s
	iters: 400, epoch: 4 | loss: 0.2979462
	speed: 0.0090s/iter; left time: 40.3490s
	iters: 500, epoch: 4 | loss: 0.6257177
	speed: 0.0090s/iter; left time: 39.6538s
	iters: 600, epoch: 4 | loss: 1.2177163
	speed: 0.0083s/iter; left time: 35.6340s
	iters: 700, epoch: 4 | loss: 0.9535141
	speed: 0.0084s/iter; left time: 35.0840s
	iters: 800, epoch: 4 | loss: 0.8189420
	speed: 0.0088s/iter; left time: 35.8940s
	iters: 900, epoch: 4 | loss: 1.2619904
	speed: 0.0079s/iter; left time: 31.5584s
Updating learning rate to 0.0003011887262
Validation loss decreased (0.5796 --> 0.5585).  Saving model state dict ...
Epoch: 4 cost time: 8.743077039718628
Epoch: 4, Steps: 979 | Train Loss: 1.0272139 Vali Loss: 0.5584592 Best vali loss: 0.5584592
	iters: 100, epoch: 5 | loss: 0.2360836
	speed: 0.0266s/iter; left time: 101.3498s
	iters: 200, epoch: 5 | loss: 0.2741564
	speed: 0.0088s/iter; left time: 32.8109s
	iters: 300, epoch: 5 | loss: 1.2600360
	speed: 0.0084s/iter; left time: 30.4939s
	iters: 400, epoch: 5 | loss: 0.9363818
	speed: 0.0091s/iter; left time: 32.1592s
	iters: 500, epoch: 5 | loss: 1.3992754
	speed: 0.0087s/iter; left time: 29.8396s
	iters: 600, epoch: 5 | loss: 0.9824296
	speed: 0.0082s/iter; left time: 27.3253s
	iters: 700, epoch: 5 | loss: 0.5268033
	speed: 0.0080s/iter; left time: 25.7324s
	iters: 800, epoch: 5 | loss: 0.7191881
	speed: 0.0080s/iter; left time: 24.7991s
	iters: 900, epoch: 5 | loss: 1.0226446
	speed: 0.0076s/iter; left time: 22.8646s
Updating learning rate to 0.00018592879066811477
Validation loss decreased (0.5585 --> 0.5578).  Saving model state dict ...
Epoch: 5 cost time: 8.333284854888916
Epoch: 5, Steps: 979 | Train Loss: 0.8174443 Vali Loss: 0.5577547 Best vali loss: 0.5577547
	iters: 100, epoch: 6 | loss: 0.2143106
	speed: 0.0254s/iter; left time: 72.1543s
	iters: 200, epoch: 6 | loss: 1.2003400
	speed: 0.0088s/iter; left time: 24.1635s
	iters: 300, epoch: 6 | loss: 1.0418482
	speed: 0.0089s/iter; left time: 23.3586s
	iters: 400, epoch: 6 | loss: 0.4115711
	speed: 0.0088s/iter; left time: 22.2456s
	iters: 500, epoch: 6 | loss: 0.9207062
	speed: 0.0080s/iter; left time: 19.5866s
	iters: 600, epoch: 6 | loss: 1.0055586
	speed: 0.0080s/iter; left time: 18.7034s
	iters: 700, epoch: 6 | loss: 0.6328517
	speed: 0.0088s/iter; left time: 19.6759s
	iters: 800, epoch: 6 | loss: 0.7742430
	speed: 0.0072s/iter; left time: 15.3964s
	iters: 900, epoch: 6 | loss: 0.4868251
	speed: 0.0083s/iter; left time: 16.9803s
Updating learning rate to 8.821613548704165e-05
Validation loss decreased (0.5578 --> 0.5518).  Saving model state dict ...
Epoch: 6 cost time: 8.170752763748169
Epoch: 6, Steps: 979 | Train Loss: 0.7431394 Vali Loss: 0.5518011 Best vali loss: 0.5518011
	iters: 100, epoch: 7 | loss: 0.5039209
	speed: 0.0291s/iter; left time: 54.0236s
	iters: 200, epoch: 7 | loss: 0.8283248
	speed: 0.0083s/iter; left time: 14.6622s
	iters: 300, epoch: 7 | loss: 1.2757547
	speed: 0.0091s/iter; left time: 15.0214s
	iters: 400, epoch: 7 | loss: 0.8623710
	speed: 0.0087s/iter; left time: 13.5604s
	iters: 500, epoch: 7 | loss: 0.7578024
	speed: 0.0085s/iter; left time: 12.4635s
	iters: 600, epoch: 7 | loss: 0.6979091
	speed: 0.0092s/iter; left time: 12.5703s
	iters: 700, epoch: 7 | loss: 0.7930930
	speed: 0.0086s/iter; left time: 10.8593s
	iters: 800, epoch: 7 | loss: 0.5785179
	speed: 0.0089s/iter; left time: 10.3437s
	iters: 900, epoch: 7 | loss: 0.7724645
	speed: 0.0094s/iter; left time: 9.9645s
Updating learning rate to 2.292662664067406e-05
Epoch: 7 cost time: 8.675615787506104
Epoch: 7, Steps: 979 | Train Loss: 0.7855731 Vali Loss: 0.5640249 Best vali loss: 0.5518011
	iters: 100, epoch: 8 | loss: 0.5669504
	speed: 0.0299s/iter; left time: 26.3468s
	iters: 200, epoch: 8 | loss: 0.8224297
	speed: 0.0087s/iter; left time: 6.7852s
	iters: 300, epoch: 8 | loss: 0.8501430
	speed: 0.0091s/iter; left time: 6.1976s
	iters: 400, epoch: 8 | loss: 0.4755155
	speed: 0.0093s/iter; left time: 5.3750s
	iters: 500, epoch: 8 | loss: 0.6480430
	speed: 0.0084s/iter; left time: 4.0489s
	iters: 600, epoch: 8 | loss: 1.1547629
	speed: 0.0094s/iter; left time: 3.5573s
	iters: 700, epoch: 8 | loss: 0.8622396
	speed: 0.0086s/iter; left time: 2.4122s
	iters: 800, epoch: 8 | loss: 0.3111107
	speed: 0.0089s/iter; left time: 1.5940s
	iters: 900, epoch: 8 | loss: 0.5131550
	speed: 0.0090s/iter; left time: 0.7195s
Updating learning rate to 0.0
Epoch: 8 cost time: 8.736140251159668
Epoch: 8, Steps: 979 | Train Loss: 0.6893722 Vali Loss: 0.5571776 Best vali loss: 0.5518011

best validation loss 0.5518010570764652

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008068994639, 'e_layers': 4, 'learning_rate': 0.001591082265, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2573649
	speed: 0.0169s/iter; left time: 131.0551s
	iters: 200, epoch: 1 | loss: 1.0662838
	speed: 0.0097s/iter; left time: 74.0824s
	iters: 300, epoch: 1 | loss: 1.1304408
	speed: 0.0096s/iter; left time: 72.0753s
	iters: 400, epoch: 1 | loss: 0.6487145
	speed: 0.0094s/iter; left time: 69.9053s
	iters: 500, epoch: 1 | loss: 1.9847075
	speed: 0.0092s/iter; left time: 67.3865s
	iters: 600, epoch: 1 | loss: 1.4035765
	speed: 0.0098s/iter; left time: 71.0170s
	iters: 700, epoch: 1 | loss: 0.8283187
	speed: 0.0096s/iter; left time: 68.6903s
	iters: 800, epoch: 1 | loss: 1.4103839
	speed: 0.0104s/iter; left time: 73.4236s
	iters: 900, epoch: 1 | loss: 1.8239632
	speed: 0.0135s/iter; left time: 93.5106s
Updating learning rate to 0.0015305253020875995
Validation loss decreased (inf --> 0.6210).  Saving model state dict ...
Epoch: 1 cost time: 10.520725011825562
Epoch: 1, Steps: 979 | Train Loss: 1.2837504 Vali Loss: 0.6209860 Best vali loss: 0.6209860
	iters: 100, epoch: 2 | loss: 0.2928611
	speed: 0.0352s/iter; left time: 237.7694s
	iters: 200, epoch: 2 | loss: 0.2728797
	speed: 0.0094s/iter; left time: 62.3501s
	iters: 300, epoch: 2 | loss: 0.8147530
	speed: 0.0102s/iter; left time: 67.0363s
	iters: 400, epoch: 2 | loss: 0.5897508
	speed: 0.0104s/iter; left time: 67.0108s
	iters: 500, epoch: 2 | loss: 0.8291252
	speed: 0.0102s/iter; left time: 64.5537s
	iters: 600, epoch: 2 | loss: 1.1128395
	speed: 0.0097s/iter; left time: 60.7146s
	iters: 700, epoch: 2 | loss: 1.2947236
	speed: 0.0106s/iter; left time: 65.3241s
	iters: 800, epoch: 2 | loss: 0.8467900
	speed: 0.0105s/iter; left time: 63.7884s
	iters: 900, epoch: 2 | loss: 0.8527832
	speed: 0.0105s/iter; left time: 62.2643s
Updating learning rate to 0.0013580736620035757
Epoch: 2 cost time: 9.84596872329712
Epoch: 2, Steps: 979 | Train Loss: 0.7673896 Vali Loss: 0.6475026 Best vali loss: 0.6209860
	iters: 100, epoch: 3 | loss: 1.2513391
	speed: 0.0280s/iter; left time: 161.9072s
	iters: 200, epoch: 3 | loss: 0.5506976
	speed: 0.0166s/iter; left time: 94.0459s
	iters: 300, epoch: 3 | loss: 0.7137854
	speed: 0.0122s/iter; left time: 68.2879s
	iters: 400, epoch: 3 | loss: 0.3618218
	speed: 0.0166s/iter; left time: 91.1161s
	iters: 500, epoch: 3 | loss: 0.3450181
	speed: 0.0145s/iter; left time: 77.7834s
	iters: 600, epoch: 3 | loss: 1.8831332
	speed: 0.0159s/iter; left time: 83.6698s
	iters: 700, epoch: 3 | loss: 1.0715926
	speed: 0.0137s/iter; left time: 71.1513s
	iters: 800, epoch: 3 | loss: 0.4368600
	speed: 0.0157s/iter; left time: 79.5188s
	iters: 900, epoch: 3 | loss: 0.6367617
	speed: 0.0161s/iter; left time: 80.2152s
Updating learning rate to 0.0010999815436727107
Epoch: 3 cost time: 14.285570859909058
Epoch: 3, Steps: 979 | Train Loss: 0.8056677 Vali Loss: 0.6449973 Best vali loss: 0.6209860
	iters: 100, epoch: 4 | loss: 0.8273021
	speed: 0.0506s/iter; left time: 242.8024s
	iters: 200, epoch: 4 | loss: 1.6119651
	speed: 0.0141s/iter; left time: 66.0722s
	iters: 300, epoch: 4 | loss: 1.6232355
	speed: 0.0164s/iter; left time: 75.5774s
	iters: 400, epoch: 4 | loss: 0.4149354
	speed: 0.0109s/iter; left time: 49.0684s
	iters: 500, epoch: 4 | loss: 1.9535714
	speed: 0.0080s/iter; left time: 35.3405s
	iters: 600, epoch: 4 | loss: 0.9776714
	speed: 0.0089s/iter; left time: 38.3399s
	iters: 700, epoch: 4 | loss: 1.9290644
	speed: 0.0119s/iter; left time: 49.8647s
	iters: 800, epoch: 4 | loss: 0.7706328
	speed: 0.0141s/iter; left time: 57.8281s
	iters: 900, epoch: 4 | loss: 0.3433757
	speed: 0.0105s/iter; left time: 42.0233s
Updating learning rate to 0.0007955411325
Epoch: 4 cost time: 12.065564155578613
Epoch: 4, Steps: 979 | Train Loss: 1.1613060 Vali Loss: 0.6305183 Best vali loss: 0.6209860
	iters: 100, epoch: 5 | loss: 0.8453460
	speed: 0.0481s/iter; left time: 183.4410s
	iters: 200, epoch: 5 | loss: 0.4325890
	speed: 0.0188s/iter; left time: 70.0516s
	iters: 300, epoch: 5 | loss: 0.8096597
	speed: 0.0103s/iter; left time: 37.1061s
	iters: 400, epoch: 5 | loss: 0.5011024
	speed: 0.0096s/iter; left time: 33.7902s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0082075118519, 'e_layers': 4, 'learning_rate': 0.0021560363745, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2023737
	speed: 0.0154s/iter; left time: 28.7220s
	iters: 200, epoch: 1 | loss: 0.7567883
	speed: 0.0090s/iter; left time: 15.8968s
Updating learning rate to 0.0021560363745
Validation loss decreased (inf --> 0.6277).  Saving model state dict ...
Epoch: 1 cost time: 2.555954694747925
Epoch: 1, Steps: 245 | Train Loss: 0.9795810 Vali Loss: 0.6276834 Best vali loss: 0.6276834
	iters: 100, epoch: 2 | loss: 0.6608594
	speed: 0.0218s/iter; left time: 35.2412s
	iters: 200, epoch: 2 | loss: 0.7693605
	speed: 0.0129s/iter; left time: 19.5260s
Updating learning rate to 0.00107801818725
Validation loss decreased (0.6277 --> 0.6140).  Saving model state dict ...
Epoch: 2 cost time: 3.2513108253479004
Epoch: 2, Steps: 245 | Train Loss: 0.7151100 Vali Loss: 0.6140034 Best vali loss: 0.6140034
	iters: 100, epoch: 3 | loss: 0.6613525
	speed: 0.0255s/iter; left time: 34.9091s
	iters: 200, epoch: 3 | loss: 0.5855443
	speed: 0.0102s/iter; left time: 12.9390s
Updating learning rate to 0.000539009093625
Validation loss decreased (0.6140 --> 0.6121).  Saving model state dict ...
Epoch: 3 cost time: 2.839179039001465
Epoch: 3, Steps: 245 | Train Loss: 0.6234484 Vali Loss: 0.6121399 Best vali loss: 0.6121399
	iters: 100, epoch: 4 | loss: 0.6300742
	speed: 0.0195s/iter; left time: 21.9190s
	iters: 200, epoch: 4 | loss: 0.5752729
	speed: 0.0108s/iter; left time: 11.1085s
Updating learning rate to 0.0002695045468125
Epoch: 4 cost time: 2.814542055130005
Epoch: 4, Steps: 245 | Train Loss: 0.6026735 Vali Loss: 0.6341077 Best vali loss: 0.6121399
	iters: 100, epoch: 5 | loss: 0.6259996
	speed: 0.0210s/iter; left time: 18.4999s
	iters: 200, epoch: 5 | loss: 0.9384236
	speed: 0.0121s/iter; left time: 9.4137s
Updating learning rate to 0.00013475227340625
Epoch: 5 cost time: 2.9875028133392334
Epoch: 5, Steps: 245 | Train Loss: 0.7822116 Vali Loss: 0.6340693 Best vali loss: 0.6121399
	iters: 100, epoch: 6 | loss: 0.6310812
	speed: 0.0218s/iter; left time: 13.8750s
	iters: 200, epoch: 6 | loss: 0.8456919
	speed: 0.0115s/iter; left time: 6.1843s
Updating learning rate to 6.7376136703125e-05
Epoch: 6 cost time: 2.9086787700653076
Epoch: 6, Steps: 245 | Train Loss: 0.7383865 Vali Loss: 0.6414959 Best vali loss: 0.6121399
	iters: 100, epoch: 7 | loss: 0.9316460
	speed: 0.0200s/iter; left time: 7.8279s
	iters: 200, epoch: 7 | loss: 0.7030563
	speed: 0.0090s/iter; left time: 2.6050s
Updating learning rate to 3.36880683515625e-05
Epoch: 7 cost time: 2.6948680877685547
Epoch: 7, Steps: 245 | Train Loss: 0.8173512 Vali Loss: 0.6491012 Best vali loss: 0.6121399
	iters: 100, epoch: 8 | loss: 0.8554220
	speed: 0.0281s/iter; left time: 4.1031s
	iters: 200, epoch: 8 | loss: 0.5956255
	speed: 0.0149s/iter; left time: 0.6837s
Updating learning rate to 1.684403417578125e-05
Epoch: 8 cost time: 3.628858804702759
Epoch: 8, Steps: 245 | Train Loss: 0.7255237 Vali Loss: 0.6479850 Best vali loss: 0.6121399

best validation loss 0.6121399303047483

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0046664203288, 'e_layers': 2, 'learning_rate': 0.0005146186858, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7766079
	speed: 0.0137s/iter; left time: 12.1207s
Updating learning rate to 0.0004950321783292384
Validation loss decreased (inf --> 0.6120).  Saving model state dict ...
Epoch: 1 cost time: 1.2550969123840332
Epoch: 1, Steps: 123 | Train Loss: 0.7766079 Vali Loss: 0.6119823 Best vali loss: 0.6119823
	iters: 100, epoch: 2 | loss: 0.7796664
	speed: 0.0115s/iter; left time: 8.7435s
Updating learning rate to 0.0004392545241272446
Validation loss decreased (0.6120 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.9352500438690186
Epoch: 2, Steps: 123 | Train Loss: 0.7796664 Vali Loss: 0.5994885 Best vali loss: 0.5994885
	iters: 100, epoch: 3 | loss: 0.6205891
	speed: 0.0118s/iter; left time: 7.5685s
Updating learning rate to 0.00035577736542057785
Validation loss decreased (0.5995 --> 0.5919).  Saving model state dict ...
Epoch: 3 cost time: 0.977602481842041
Epoch: 3, Steps: 123 | Train Loss: 0.6205891 Vali Loss: 0.5918865 Best vali loss: 0.5918865

best validation loss 0.5918865350593521

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.003384061485, 'e_layers': 4, 'learning_rate': 7.01601196e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8298998
	speed: 0.0172s/iter; left time: 65.6676s
	iters: 200, epoch: 1 | loss: 0.8084203
	speed: 0.0100s/iter; left time: 37.3132s
	iters: 300, epoch: 1 | loss: 0.4264660
	speed: 0.0122s/iter; left time: 44.1498s
	iters: 400, epoch: 1 | loss: 0.9166330
	speed: 0.0118s/iter; left time: 41.4161s
Updating learning rate to 6.748980904849198e-05
Validation loss decreased (inf --> 0.6032).  Saving model state dict ...
Epoch: 1 cost time: 5.759840726852417
Epoch: 1, Steps: 490 | Train Loss: 0.7453547 Vali Loss: 0.6032420 Best vali loss: 0.6032420
	iters: 100, epoch: 2 | loss: 0.7770697
	speed: 0.0335s/iter; left time: 111.6484s
	iters: 200, epoch: 2 | loss: 1.4631034
	speed: 0.0158s/iter; left time: 51.1146s
	iters: 300, epoch: 2 | loss: 0.9102377
	speed: 0.0146s/iter; left time: 45.7889s
	iters: 400, epoch: 2 | loss: 0.8145220
	speed: 0.0158s/iter; left time: 47.9998s
Updating learning rate to 5.9885407969009595e-05
Epoch: 2 cost time: 7.671616315841675
Epoch: 2, Steps: 490 | Train Loss: 0.9912332 Vali Loss: 0.6132635 Best vali loss: 0.6032420
	iters: 100, epoch: 3 | loss: 0.8564670
	speed: 0.0395s/iter; left time: 112.1039s
	iters: 200, epoch: 3 | loss: 0.6071849
	speed: 0.0146s/iter; left time: 40.0653s
	iters: 300, epoch: 3 | loss: 0.9364095
	speed: 0.0140s/iter; left time: 37.0386s
	iters: 400, epoch: 3 | loss: 0.4687316
	speed: 0.0123s/iter; left time: 31.1526s
Updating learning rate to 4.85046174918366e-05
Validation loss decreased (0.6032 --> 0.5816).  Saving model state dict ...
Epoch: 3 cost time: 6.687149286270142
Epoch: 3, Steps: 490 | Train Loss: 0.7171982 Vali Loss: 0.5816403 Best vali loss: 0.5816403

best validation loss 0.5816402605069781

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0090342263642, 'e_layers': 4, 'learning_rate': 7.09981557e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.09981557e-05
Validation loss decreased (inf --> 0.7029).  Saving model state dict ...
Epoch: 1 cost time: 1.0784168243408203
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7029031 Best vali loss: 0.7029031
Updating learning rate to 3.549907785e-05
Validation loss decreased (0.7029 --> 0.6903).  Saving model state dict ...
Epoch: 2 cost time: 0.7585656642913818
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6903005 Best vali loss: 0.6903005
Updating learning rate to 1.7749538925e-05
Validation loss decreased (0.6903 --> 0.6844).  Saving model state dict ...
Epoch: 3 cost time: 0.8014698028564453
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6844136 Best vali loss: 0.6844136

best validation loss 0.6844136385606538

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.003384061485, 'e_layers': 4, 'learning_rate': 7.01601196e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6917747
	speed: 0.0192s/iter; left time: 45.0371s
	iters: 200, epoch: 4 | loss: 0.7843490
	speed: 0.0116s/iter; left time: 26.1578s
	iters: 300, epoch: 4 | loss: 0.3993403
	speed: 0.0116s/iter; left time: 24.9215s
	iters: 400, epoch: 4 | loss: 0.9700506
	speed: 0.0101s/iter; left time: 20.8080s
Updating learning rate to 3.50800598e-05
Validation loss decreased (0.5816 --> 0.5639).  Saving model state dict ...
Epoch: 4 cost time: 5.761516332626343
Epoch: 4, Steps: 490 | Train Loss: 0.7113786 Vali Loss: 0.5638773 Best vali loss: 0.5638773
	iters: 100, epoch: 5 | loss: 0.7273227
	speed: 0.0279s/iter; left time: 51.9030s
	iters: 200, epoch: 5 | loss: 0.9715548
	speed: 0.0115s/iter; left time: 20.2114s
	iters: 300, epoch: 5 | loss: 0.8665153
	speed: 0.0078s/iter; left time: 12.9055s
	iters: 400, epoch: 5 | loss: 0.7753572
	speed: 0.0101s/iter; left time: 15.7865s
Updating learning rate to 2.1655502108163395e-05
Validation loss decreased (0.5639 --> 0.5571).  Saving model state dict ...
Epoch: 5 cost time: 5.067022085189819
Epoch: 5, Steps: 490 | Train Loss: 0.8351875 Vali Loss: 0.5571352 Best vali loss: 0.5571352
	iters: 100, epoch: 6 | loss: 0.7976637
	speed: 0.0295s/iter; left time: 40.3935s
	iters: 200, epoch: 6 | loss: 0.5781217
	speed: 0.0103s/iter; left time: 13.1198s
	iters: 300, epoch: 6 | loss: 0.8636789
	speed: 0.0104s/iter; left time: 12.2101s
	iters: 400, epoch: 6 | loss: 0.4385579
	speed: 0.0118s/iter; left time: 12.6275s
Updating learning rate to 1.02747116309904e-05
Epoch: 6 cost time: 5.363158464431763
Epoch: 6, Steps: 490 | Train Loss: 0.6695056 Vali Loss: 0.5618583 Best vali loss: 0.5571352
	iters: 100, epoch: 7 | loss: 1.0647223
	speed: 0.0296s/iter; left time: 26.0433s
	iters: 200, epoch: 7 | loss: 1.0855517
	speed: 0.0100s/iter; left time: 7.7797s
	iters: 300, epoch: 7 | loss: 0.8301444
	speed: 0.0100s/iter; left time: 6.7842s
	iters: 400, epoch: 7 | loss: 0.4340051
	speed: 0.0112s/iter; left time: 6.5086s
Updating learning rate to 2.670310551508017e-06
Epoch: 7 cost time: 5.177147388458252
Epoch: 7, Steps: 490 | Train Loss: 0.8536059 Vali Loss: 0.5580476 Best vali loss: 0.5571352
	iters: 100, epoch: 8 | loss: 1.1666400
	speed: 0.0316s/iter; left time: 12.3572s
	iters: 200, epoch: 8 | loss: 0.9605426
	speed: 0.0137s/iter; left time: 3.9848s
	iters: 300, epoch: 8 | loss: 0.4505180
	speed: 0.0168s/iter; left time: 3.2043s
	iters: 400, epoch: 8 | loss: 0.6260642
	speed: 0.0172s/iter; left time: 1.5611s
Updating learning rate to 0.0
Epoch: 8 cost time: 7.782491207122803
Epoch: 8, Steps: 490 | Train Loss: 0.8009412 Vali Loss: 0.5616939 Best vali loss: 0.5571352

best validation loss 0.55713515367733

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0075551485169, 'e_layers': 2, 'learning_rate': 0.0001043150747, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00010034481857385798
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 1.678464651107788
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6086235 Best vali loss: 0.6086235
Updating learning rate to 8.903848570017563e-05
Validation loss decreased (0.6086 --> 0.6002).  Saving model state dict ...
Epoch: 2 cost time: 1.0084998607635498
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6002051 Best vali loss: 0.6002051
Updating learning rate to 7.211736276680837e-05
Validation loss decreased (0.6002 --> 0.5963).  Saving model state dict ...
Epoch: 3 cost time: 1.1744647026062012
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5962919 Best vali loss: 0.5962919
Updating learning rate to 5.215753735e-05
Epoch: 4 cost time: 1.0458745956420898
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5979025 Best vali loss: 0.5962919
Updating learning rate to 3.2197711933191636e-05
Validation loss decreased (0.5963 --> 0.5913).  Saving model state dict ...
Epoch: 5 cost time: 1.2352557182312012
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5913394 Best vali loss: 0.5913394
Updating learning rate to 1.5276588999824375e-05
Epoch: 6 cost time: 0.9057395458221436
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6009169 Best vali loss: 0.5913394
Updating learning rate to 3.970256126142023e-06
Validation loss decreased (0.5913 --> 0.5794).  Saving model state dict ...
Epoch: 7 cost time: 1.0286006927490234
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5793606 Best vali loss: 0.5793606
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9603672027587891
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5815194 Best vali loss: 0.5793606

best validation loss 0.5793606305993966

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0020876072005, 'e_layers': 4, 'learning_rate': 0.0038416036996, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8899748
	speed: 0.0210s/iter; left time: 162.0227s
	iters: 200, epoch: 1 | loss: 0.2787089
	speed: 0.0097s/iter; left time: 73.8109s
	iters: 300, epoch: 1 | loss: 0.8263707
	speed: 0.0091s/iter; left time: 68.7591s
	iters: 400, epoch: 1 | loss: 1.0878569
	speed: 0.0105s/iter; left time: 77.8114s
	iters: 500, epoch: 1 | loss: 0.7611515
	speed: 0.0118s/iter; left time: 86.5010s
	iters: 600, epoch: 1 | loss: 0.5917209
	speed: 0.0132s/iter; left time: 95.1669s
	iters: 700, epoch: 1 | loss: 1.4001986
	speed: 0.0147s/iter; left time: 104.8688s
	iters: 800, epoch: 1 | loss: 0.4640934
	speed: 0.0146s/iter; left time: 102.5293s
	iters: 900, epoch: 1 | loss: 0.8395127
	speed: 0.0134s/iter; left time: 93.2360s
Updating learning rate to 0.0038416036996
Validation loss decreased (inf --> 0.6552).  Saving model state dict ...
Epoch: 1 cost time: 12.707281589508057
Epoch: 1, Steps: 979 | Train Loss: 0.7932876 Vali Loss: 0.6551983 Best vali loss: 0.6551983
	iters: 100, epoch: 2 | loss: 0.6380885
	speed: 0.0943s/iter; left time: 636.9504s
	iters: 200, epoch: 2 | loss: 0.9533262
	speed: 0.0151s/iter; left time: 100.3339s
	iters: 300, epoch: 2 | loss: 0.6174415
	speed: 0.0141s/iter; left time: 92.3511s
	iters: 400, epoch: 2 | loss: 1.2229885
	speed: 0.0166s/iter; left time: 106.8884s
	iters: 500, epoch: 2 | loss: 0.2554925
	speed: 0.0151s/iter; left time: 95.9172s
	iters: 600, epoch: 2 | loss: 1.4948610
	speed: 0.0146s/iter; left time: 91.1994s
	iters: 700, epoch: 2 | loss: 0.8934262
	speed: 0.0142s/iter; left time: 87.5066s
	iters: 800, epoch: 2 | loss: 1.0170617
	speed: 0.0141s/iter; left time: 85.5747s
	iters: 900, epoch: 2 | loss: 0.6604159
	speed: 0.0140s/iter; left time: 83.1335s
Updating learning rate to 0.0019208018498
Validation loss decreased (0.6552 --> 0.6418).  Saving model state dict ...
Epoch: 2 cost time: 14.138259172439575
Epoch: 2, Steps: 979 | Train Loss: 0.8614558 Vali Loss: 0.6417720 Best vali loss: 0.6417720
	iters: 100, epoch: 3 | loss: 1.4135394
	speed: 0.1092s/iter; left time: 630.3768s
	iters: 200, epoch: 3 | loss: 1.2812163
	speed: 0.0154s/iter; left time: 87.1312s
	iters: 300, epoch: 3 | loss: 0.4564419
	speed: 0.0139s/iter; left time: 77.5285s
	iters: 400, epoch: 3 | loss: 0.7264404
	speed: 0.0143s/iter; left time: 78.5168s
	iters: 500, epoch: 3 | loss: 0.6734365
	speed: 0.0145s/iter; left time: 77.7444s
	iters: 600, epoch: 3 | loss: 0.7145188
	speed: 0.0144s/iter; left time: 76.0724s
	iters: 700, epoch: 3 | loss: 0.6030397
	speed: 0.0143s/iter; left time: 74.0650s
	iters: 800, epoch: 3 | loss: 0.6698356
	speed: 0.0137s/iter; left time: 69.4957s
	iters: 900, epoch: 3 | loss: 0.7178802
	speed: 0.0152s/iter; left time: 75.4980s
Exception ignored in: <function _TemporaryFileCloser.__del__ at 0x732184155ab0>
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/tempfile.py", line 466, in __del__
    self.close()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/tempfile.py", line 462, in close
    unlink(self.name)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 200588) is killed by signal: Terminated. 
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019541931717, 'e_layers': 4, 'learning_rate': 0.0008380425529, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1098530
	speed: 0.0220s/iter; left time: 83.9437s
	iters: 200, epoch: 1 | loss: 0.6642357
	speed: 0.0220s/iter; left time: 81.8912s
	iters: 300, epoch: 1 | loss: 0.9436632
	speed: 0.0224s/iter; left time: 81.0359s
	iters: 400, epoch: 1 | loss: 0.7375927
	speed: 0.0228s/iter; left time: 80.2087s
Updating learning rate to 0.0008380425529
Validation loss decreased (inf --> 0.6369).  Saving model state dict ...
Epoch: 1 cost time: 10.627459526062012
Epoch: 1, Steps: 490 | Train Loss: 0.8638362 Vali Loss: 0.6368978 Best vali loss: 0.6368978
	iters: 100, epoch: 2 | loss: 1.2928382
	speed: 0.0627s/iter; left time: 208.6989s
	iters: 200, epoch: 2 | loss: 1.0979158
	speed: 0.0147s/iter; left time: 47.4642s
	iters: 300, epoch: 2 | loss: 1.2962315
	speed: 0.0133s/iter; left time: 41.7716s
	iters: 400, epoch: 2 | loss: 0.6335575
	speed: 0.0124s/iter; left time: 37.6916s
Updating learning rate to 0.00041902127645
Epoch: 2 cost time: 7.292741060256958
Epoch: 2, Steps: 490 | Train Loss: 1.0801357 Vali Loss: 0.6736748 Best vali loss: 0.6368978
	iters: 100, epoch: 3 | loss: 0.7384700
	speed: 0.0511s/iter; left time: 145.1853s
	iters: 200, epoch: 3 | loss: 0.5397844
	speed: 0.0158s/iter; left time: 43.2044s
	iters: 300, epoch: 3 | loss: 0.5773786
	speed: 0.0219s/iter; left time: 57.7835s
	iters: 400, epoch: 3 | loss: 0.6055701
	speed: 0.0241s/iter; left time: 61.1711s
Updating learning rate to 0.000209510638225
Epoch: 3 cost time: 9.84155797958374
Epoch: 3, Steps: 490 | Train Loss: 0.6153008 Vali Loss: 0.6439103 Best vali loss: 0.6368978

best validation loss 0.6368978168610233

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.6051).  Saving model state dict ...
Epoch: 1 cost time: 0.9503247737884521
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6050603 Best vali loss: 0.6050603
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 1.319688320159912
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6211952 Best vali loss: 0.6050603
Updating learning rate to 0.0008072813968307993
Validation loss decreased (0.6051 --> 0.6050).  Saving model state dict ...
Epoch: 3 cost time: 1.9454774856567383
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6049728 Best vali loss: 0.6049728

best validation loss 0.6049728142558728

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0010650567536, 'e_layers': 4, 'learning_rate': 6.7384655e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.7384655e-05
Validation loss decreased (inf --> 0.6880).  Saving model state dict ...
Epoch: 1 cost time: 1.909085988998413
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6880358 Best vali loss: 0.6880358
Updating learning rate to 3.36923275e-05
Validation loss decreased (0.6880 --> 0.6682).  Saving model state dict ...
Epoch: 2 cost time: 1.454115390777588
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6681814 Best vali loss: 0.6681814
Updating learning rate to 1.684616375e-05
Validation loss decreased (0.6682 --> 0.6599).  Saving model state dict ...
Epoch: 3 cost time: 1.5988740921020508
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6599329 Best vali loss: 0.6599329

best validation loss 0.6599329322204166

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 1.491886854171753
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6173292 Best vali loss: 0.6049728
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 1.259361982345581
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6191599 Best vali loss: 0.6049728
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.8785998821258545
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6396414 Best vali loss: 0.6049728
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.9205424785614014
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6285435 Best vali loss: 0.6049728
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8472118377685547
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6294826 Best vali loss: 0.6049728

best validation loss 0.6049728142558728

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.010282756286, 'e_layers': 2, 'learning_rate': 0.0001844439031, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5713578
	speed: 0.0133s/iter; left time: 102.5855s
	iters: 200, epoch: 1 | loss: 0.8523711
	speed: 0.0083s/iter; left time: 63.0899s
	iters: 300, epoch: 1 | loss: 0.7150561
	speed: 0.0090s/iter; left time: 67.4748s
	iters: 400, epoch: 1 | loss: 1.0155565
	speed: 0.0102s/iter; left time: 75.8341s
	iters: 500, epoch: 1 | loss: 0.7093329
	speed: 0.0088s/iter; left time: 64.3201s
	iters: 600, epoch: 1 | loss: 1.0010278
	speed: 0.0089s/iter; left time: 64.5542s
	iters: 700, epoch: 1 | loss: 1.0959969
	speed: 0.0098s/iter; left time: 69.5475s
	iters: 800, epoch: 1 | loss: 0.7072324
	speed: 0.0110s/iter; left time: 77.2674s
	iters: 900, epoch: 1 | loss: 1.5012575
	speed: 0.0096s/iter; left time: 66.4183s
Updating learning rate to 0.00017742392503529254
Validation loss decreased (inf --> 0.6071).  Saving model state dict ...
Epoch: 1 cost time: 9.36021614074707
Epoch: 1, Steps: 979 | Train Loss: 0.9076877 Vali Loss: 0.6070517 Best vali loss: 0.6070517
	iters: 100, epoch: 2 | loss: 0.7542255
	speed: 0.0276s/iter; left time: 186.6970s
	iters: 200, epoch: 2 | loss: 0.7349609
	speed: 0.0079s/iter; left time: 52.7655s
	iters: 300, epoch: 2 | loss: 0.8980948
	speed: 0.0079s/iter; left time: 51.7645s
	iters: 400, epoch: 2 | loss: 1.0258964
	speed: 0.0077s/iter; left time: 49.3746s
	iters: 500, epoch: 2 | loss: 0.4609099
	speed: 0.0079s/iter; left time: 50.1985s
	iters: 600, epoch: 2 | loss: 0.7441668
	speed: 0.0077s/iter; left time: 48.1746s
	iters: 700, epoch: 2 | loss: 0.3380663
	speed: 0.0080s/iter; left time: 49.3697s
	iters: 800, epoch: 2 | loss: 0.5930146
	speed: 0.0076s/iter; left time: 46.1070s
	iters: 900, epoch: 2 | loss: 1.2606181
	speed: 0.0079s/iter; left time: 46.7578s
Updating learning rate to 0.00015743271886526223
Validation loss decreased (0.6071 --> 0.6067).  Saving model state dict ...
Epoch: 2 cost time: 7.7302515506744385
Epoch: 2, Steps: 979 | Train Loss: 0.7566615 Vali Loss: 0.6066579 Best vali loss: 0.6066579
	iters: 100, epoch: 3 | loss: 0.7113842
	speed: 0.0248s/iter; left time: 143.1507s
	iters: 200, epoch: 3 | loss: 0.8853772
	speed: 0.0083s/iter; left time: 47.3319s
	iters: 300, epoch: 3 | loss: 0.5137653
	speed: 0.0079s/iter; left time: 43.8388s
	iters: 400, epoch: 3 | loss: 1.1449488
	speed: 0.0085s/iter; left time: 46.6526s
	iters: 500, epoch: 3 | loss: 0.4817424
	speed: 0.0076s/iter; left time: 40.9157s
	iters: 600, epoch: 3 | loss: 0.4666178
	speed: 0.0086s/iter; left time: 45.2763s
	iters: 700, epoch: 3 | loss: 0.9309140
	speed: 0.0082s/iter; left time: 42.4209s
	iters: 800, epoch: 3 | loss: 1.8040888
	speed: 0.0082s/iter; left time: 41.5062s
	iters: 900, epoch: 3 | loss: 1.0531923
	speed: 0.0081s/iter; left time: 40.1988s
Updating learning rate to 0.00012751376450856103
Validation loss decreased (0.6067 --> 0.5801).  Saving model state dict ...
Epoch: 3 cost time: 7.875320672988892
Epoch: 3, Steps: 979 | Train Loss: 0.8880034 Vali Loss: 0.5801223 Best vali loss: 0.5801223
	iters: 100, epoch: 4 | loss: 1.4512275
	speed: 0.0293s/iter; left time: 140.5808s
	iters: 200, epoch: 4 | loss: 0.5453833
	speed: 0.0076s/iter; left time: 35.8268s
	iters: 300, epoch: 4 | loss: 0.7387374
	speed: 0.0080s/iter; left time: 36.8621s
	iters: 400, epoch: 4 | loss: 0.9205266
	speed: 0.0077s/iter; left time: 34.5716s
	iters: 500, epoch: 4 | loss: 0.9821569
	speed: 0.0084s/iter; left time: 37.0720s
	iters: 600, epoch: 4 | loss: 0.5917676
	speed: 0.0055s/iter; left time: 23.8294s
	iters: 700, epoch: 4 | loss: 0.4832918
	speed: 0.0054s/iter; left time: 22.6912s
	iters: 800, epoch: 4 | loss: 0.8388243
	speed: 0.0061s/iter; left time: 25.0198s
	iters: 900, epoch: 4 | loss: 0.6041018
	speed: 0.0061s/iter; left time: 24.4813s
Updating learning rate to 9.222195155e-05
Validation loss decreased (0.5801 --> 0.5745).  Saving model state dict ...
Epoch: 4 cost time: 6.851807117462158
Epoch: 4, Steps: 979 | Train Loss: 0.7951130 Vali Loss: 0.5745029 Best vali loss: 0.5745029
	iters: 100, epoch: 5 | loss: 0.8867976
	speed: 0.0214s/iter; left time: 81.4952s
	iters: 200, epoch: 5 | loss: 0.8502762
	speed: 0.0060s/iter; left time: 22.3384s
	iters: 300, epoch: 5 | loss: 0.6899586
	speed: 0.0062s/iter; left time: 22.4550s
	iters: 400, epoch: 5 | loss: 0.8398955
	speed: 0.0059s/iter; left time: 20.8842s
	iters: 500, epoch: 5 | loss: 1.0568986
	speed: 0.0062s/iter; left time: 21.1905s
	iters: 600, epoch: 5 | loss: 0.5355844
	speed: 0.0062s/iter; left time: 20.6055s
	iters: 700, epoch: 5 | loss: 0.3045257
	speed: 0.0061s/iter; left time: 19.5590s
	iters: 800, epoch: 5 | loss: 1.0178707
	speed: 0.0062s/iter; left time: 19.3776s
	iters: 900, epoch: 5 | loss: 0.7609119
	speed: 0.0063s/iter; left time: 19.0992s
Updating learning rate to 5.6930138591438997e-05
Validation loss decreased (0.5745 --> 0.5684).  Saving model state dict ...
Epoch: 5 cost time: 6.019636154174805
Epoch: 5, Steps: 979 | Train Loss: 0.7714133 Vali Loss: 0.5683600 Best vali loss: 0.5683600
	iters: 100, epoch: 6 | loss: 0.8352686
	speed: 0.0208s/iter; left time: 59.0631s
	iters: 200, epoch: 6 | loss: 0.3077204
	speed: 0.0057s/iter; left time: 15.7319s
	iters: 300, epoch: 6 | loss: 0.3973520
	speed: 0.0060s/iter; left time: 15.7372s
	iters: 400, epoch: 6 | loss: 0.9852442
	speed: 0.0059s/iter; left time: 15.0054s
	iters: 500, epoch: 6 | loss: 0.8268550
	speed: 0.0060s/iter; left time: 14.6493s
	iters: 600, epoch: 6 | loss: 0.3778032
	speed: 0.0060s/iter; left time: 14.0670s
	iters: 700, epoch: 6 | loss: 0.7769408
	speed: 0.0061s/iter; left time: 13.6889s
	iters: 800, epoch: 6 | loss: 1.0102748
	speed: 0.0062s/iter; left time: 13.3443s
	iters: 900, epoch: 6 | loss: 0.3613023
	speed: 0.0062s/iter; left time: 12.5604s
Updating learning rate to 2.701118423473777e-05
Epoch: 6 cost time: 5.872251033782959
Epoch: 6, Steps: 979 | Train Loss: 0.6531957 Vali Loss: 0.5732607 Best vali loss: 0.5683600
	iters: 100, epoch: 7 | loss: 0.9767621
	speed: 0.0195s/iter; left time: 36.2692s
	iters: 200, epoch: 7 | loss: 0.5841041
	speed: 0.0095s/iter; left time: 16.7499s
	iters: 300, epoch: 7 | loss: 1.0574791
	speed: 0.0095s/iter; left time: 15.6784s
	iters: 400, epoch: 7 | loss: 0.6431589
	speed: 0.0088s/iter; left time: 13.7278s
	iters: 500, epoch: 7 | loss: 0.3791731
	speed: 0.0095s/iter; left time: 13.8415s
	iters: 600, epoch: 7 | loss: 0.2512543
	speed: 0.0096s/iter; left time: 13.1034s
	iters: 700, epoch: 7 | loss: 0.9518881
	speed: 0.0090s/iter; left time: 11.3219s
	iters: 800, epoch: 7 | loss: 0.6650584
	speed: 0.0092s/iter; left time: 10.6904s
	iters: 900, epoch: 7 | loss: 0.7998638
	speed: 0.0096s/iter; left time: 10.1826s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013224837754, 'e_layers': 4, 'learning_rate': 0.0001941136611, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0158027
	speed: 0.0156s/iter; left time: 59.6094s
	iters: 200, epoch: 1 | loss: 0.4788968
	speed: 0.0099s/iter; left time: 36.7438s
	iters: 300, epoch: 1 | loss: 0.6550128
	speed: 0.0127s/iter; left time: 46.0449s
	iters: 400, epoch: 1 | loss: 0.8200889
	speed: 0.0149s/iter; left time: 52.4040s
Updating learning rate to 0.0001941136611
Validation loss decreased (inf --> 0.6179).  Saving model state dict ...
Epoch: 1 cost time: 6.328754901885986
Epoch: 1, Steps: 490 | Train Loss: 0.7424503 Vali Loss: 0.6179497 Best vali loss: 0.6179497
	iters: 100, epoch: 2 | loss: 0.7164565
	speed: 0.0447s/iter; left time: 148.9301s
	iters: 200, epoch: 2 | loss: 0.8450182
	speed: 0.0237s/iter; left time: 76.4821s
	iters: 300, epoch: 2 | loss: 0.6020282
	speed: 0.0263s/iter; left time: 82.2159s
	iters: 400, epoch: 2 | loss: 0.8627456
	speed: 0.0206s/iter; left time: 62.3097s
Updating learning rate to 9.705683055e-05
Validation loss decreased (0.6179 --> 0.6096).  Saving model state dict ...
Epoch: 2 cost time: 11.286444187164307
Epoch: 2, Steps: 490 | Train Loss: 0.7565621 Vali Loss: 0.6095895 Best vali loss: 0.6095895
	iters: 100, epoch: 3 | loss: 0.4833308
	speed: 0.0941s/iter; left time: 267.2862s
	iters: 200, epoch: 3 | loss: 0.8728851
	speed: 0.0244s/iter; left time: 66.7523s
	iters: 300, epoch: 3 | loss: 0.5009274
	speed: 0.0208s/iter; left time: 54.8162s
	iters: 400, epoch: 3 | loss: 1.2791749
	speed: 0.0228s/iter; left time: 57.9231s
Updating learning rate to 4.8528415275e-05
Validation loss decreased (0.6096 --> 0.6049).  Saving model state dict ...
Epoch: 3 cost time: 10.87020492553711
Epoch: 3, Steps: 490 | Train Loss: 0.7840796 Vali Loss: 0.6049431 Best vali loss: 0.6049431
	iters: 100, epoch: 4 | loss: 0.8636655
	speed: 0.0942s/iter; left time: 221.3523s
	iters: 200, epoch: 4 | loss: 0.5410485
	speed: 0.0259s/iter; left time: 58.2170s
	iters: 300, epoch: 4 | loss: 0.7280663
	speed: 0.0238s/iter; left time: 51.1502s
	iters: 400, epoch: 4 | loss: 0.5535935
	speed: 0.0244s/iter; left time: 50.0070s
Updating learning rate to 2.42642076375e-05
Epoch: 4 cost time: 11.47195816040039
Epoch: 4, Steps: 490 | Train Loss: 0.6715935 Vali Loss: 0.6099297 Best vali loss: 0.6049431
	iters: 100, epoch: 5 | loss: 0.5527948
	speed: 0.0645s/iter; left time: 120.0579s
	iters: 200, epoch: 5 | loss: 0.9134376
	speed: 0.0172s/iter; left time: 30.2381s
	iters: 300, epoch: 5 | loss: 0.5753437
	speed: 0.0151s/iter; left time: 25.0100s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0083677237872, 'e_layers': 4, 'learning_rate': 0.0003890233416, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0300695
	speed: 0.0170s/iter; left time: 131.6063s
	iters: 200, epoch: 1 | loss: 0.7778392
	speed: 0.0131s/iter; left time: 99.8633s
	iters: 300, epoch: 1 | loss: 0.2277415
	speed: 0.0131s/iter; left time: 98.7398s
	iters: 400, epoch: 1 | loss: 0.7606955
	speed: 0.0096s/iter; left time: 71.6397s
	iters: 500, epoch: 1 | loss: 0.8505199
	speed: 0.0092s/iter; left time: 67.6456s
	iters: 600, epoch: 1 | loss: 0.9449906
	speed: 0.0121s/iter; left time: 87.2185s
	iters: 700, epoch: 1 | loss: 0.9205166
	speed: 0.0120s/iter; left time: 85.8501s
	iters: 800, epoch: 1 | loss: 0.7853048
	speed: 0.0122s/iter; left time: 85.5285s
	iters: 900, epoch: 1 | loss: 1.5355479
	speed: 0.0121s/iter; left time: 84.2040s
Updating learning rate to 0.0003890233416
Validation loss decreased (inf --> 0.6152).  Saving model state dict ...
Epoch: 1 cost time: 11.600029468536377
Epoch: 1, Steps: 979 | Train Loss: 0.8703584 Vali Loss: 0.6151547 Best vali loss: 0.6151547
	iters: 100, epoch: 2 | loss: 1.3643979
	speed: 0.0467s/iter; left time: 315.4952s
	iters: 200, epoch: 2 | loss: 0.5576655
	speed: 0.0121s/iter; left time: 80.6045s
	iters: 300, epoch: 2 | loss: 1.2408339
	speed: 0.0114s/iter; left time: 74.8684s
	iters: 400, epoch: 2 | loss: 1.0833255
	speed: 0.0129s/iter; left time: 83.3901s
	iters: 500, epoch: 2 | loss: 0.4445945
	speed: 0.0121s/iter; left time: 77.1345s
	iters: 600, epoch: 2 | loss: 2.6471488
	speed: 0.0087s/iter; left time: 54.3363s
	iters: 700, epoch: 2 | loss: 1.6856042
	speed: 0.0070s/iter; left time: 42.9752s
	iters: 800, epoch: 2 | loss: 1.0639775
	speed: 0.0115s/iter; left time: 69.8617s
	iters: 900, epoch: 2 | loss: 0.6152453
	speed: 0.0147s/iter; left time: 87.4440s
Updating learning rate to 0.0001945116708
Epoch: 2 cost time: 10.825048685073853
Epoch: 2, Steps: 979 | Train Loss: 1.1891992 Vali Loss: 0.6249285 Best vali loss: 0.6151547
	iters: 100, epoch: 3 | loss: 0.8783064
	speed: 0.0336s/iter; left time: 193.9097s
	iters: 200, epoch: 3 | loss: 0.4887914
	speed: 0.0147s/iter; left time: 83.4120s
	iters: 300, epoch: 3 | loss: 0.7397059
	speed: 0.0120s/iter; left time: 66.9321s
	iters: 400, epoch: 3 | loss: 0.7290543
	speed: 0.0076s/iter; left time: 41.4330s
	iters: 500, epoch: 3 | loss: 0.5692142
	speed: 0.0077s/iter; left time: 41.4924s
	iters: 600, epoch: 3 | loss: 0.4333291
	speed: 0.0087s/iter; left time: 45.8832s
	iters: 700, epoch: 3 | loss: 1.0780141
	speed: 0.0094s/iter; left time: 48.6686s
	iters: 800, epoch: 3 | loss: 0.5304583
	speed: 0.0094s/iter; left time: 47.6527s
	iters: 900, epoch: 3 | loss: 0.9254926
	speed: 0.0091s/iter; left time: 45.2280s
Updating learning rate to 9.72558354e-05
Validation loss decreased (0.6152 --> 0.6099).  Saving model state dict ...
Epoch: 3 cost time: 9.916817903518677
Epoch: 3, Steps: 979 | Train Loss: 0.7080407 Vali Loss: 0.6098873 Best vali loss: 0.6098873

best validation loss 0.6098872682442548

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011940536002, 'e_layers': 4, 'learning_rate': 7.41197855e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7295645
	speed: 0.0159s/iter; left time: 14.1061s
Updating learning rate to 7.129876913878843e-05
Validation loss decreased (inf --> 0.6381).  Saving model state dict ...
Epoch: 1 cost time: 1.5429191589355469
Epoch: 1, Steps: 123 | Train Loss: 0.7295645 Vali Loss: 0.6381126 Best vali loss: 0.6381126
	iters: 100, epoch: 2 | loss: 0.7233928
	speed: 0.0153s/iter; left time: 11.6212s
Updating learning rate to 6.326519422357117e-05
Validation loss decreased (0.6381 --> 0.6103).  Saving model state dict ...
Epoch: 2 cost time: 1.2920129299163818
Epoch: 2, Steps: 123 | Train Loss: 0.7233928 Vali Loss: 0.6103195 Best vali loss: 0.6103195
	iters: 100, epoch: 3 | loss: 0.9701711
	speed: 0.0142s/iter; left time: 9.0843s
Updating learning rate to 5.124209971065211e-05
Validation loss decreased (0.6103 --> 0.6102).  Saving model state dict ...
Epoch: 3 cost time: 1.174952745437622
Epoch: 3, Steps: 123 | Train Loss: 0.9701711 Vali Loss: 0.6101883 Best vali loss: 0.6101883

best validation loss 0.6101883314705071

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0437458
	speed: 0.0193s/iter; left time: 17.0525s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.5863).  Saving model state dict ...
Epoch: 1 cost time: 1.8923375606536865
Epoch: 1, Steps: 123 | Train Loss: 1.0437458 Vali Loss: 0.5862605 Best vali loss: 0.5862605
	iters: 100, epoch: 2 | loss: 0.7110209
	speed: 0.0189s/iter; left time: 14.4026s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.5863 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 1.5550129413604736
Epoch: 2, Steps: 123 | Train Loss: 0.7110209 Vali Loss: 0.5611274 Best vali loss: 0.5611274
	iters: 100, epoch: 3 | loss: 0.8771235
	speed: 0.0174s/iter; left time: 11.1223s
Updating learning rate to 0.000178512795825
Validation loss decreased (0.5611 --> 0.5591).  Saving model state dict ...
Epoch: 3 cost time: 1.2818679809570312
Epoch: 3, Steps: 123 | Train Loss: 0.8771235 Vali Loss: 0.5590721 Best vali loss: 0.5590721

best validation loss 0.5590721203297832

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8967108
	speed: 0.0173s/iter; left time: 8.9072s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 1.5616474151611328
Epoch: 4, Steps: 123 | Train Loss: 0.8967108 Vali Loss: 0.5620284 Best vali loss: 0.5590721
	iters: 100, epoch: 5 | loss: 0.6506597
	speed: 0.0146s/iter; left time: 5.7338s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 1.2528228759765625
Epoch: 5, Steps: 123 | Train Loss: 0.6506597 Vali Loss: 0.5654871 Best vali loss: 0.5590721
	iters: 100, epoch: 6 | loss: 0.8243981
	speed: 0.0138s/iter; left time: 3.7160s
Updating learning rate to 2.2314099478125e-05
Validation loss decreased (0.5591 --> 0.5575).  Saving model state dict ...
Epoch: 6 cost time: 1.1580896377563477
Epoch: 6, Steps: 123 | Train Loss: 0.8243981 Vali Loss: 0.5574657 Best vali loss: 0.5574657
	iters: 100, epoch: 7 | loss: 0.6909148
	speed: 0.0143s/iter; left time: 2.1024s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 1.2242605686187744
Epoch: 7, Steps: 123 | Train Loss: 0.6909148 Vali Loss: 0.5602466 Best vali loss: 0.5574657
	iters: 100, epoch: 8 | loss: 0.7994239
	speed: 0.0161s/iter; left time: 0.3872s
Updating learning rate to 5.57852486953125e-06
Epoch: 8 cost time: 1.431708574295044
Epoch: 8, Steps: 123 | Train Loss: 0.7994239 Vali Loss: 0.5607332 Best vali loss: 0.5574657

best validation loss 0.5574656543440424

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0086816738717, 'e_layers': 1, 'learning_rate': 0.00271128889, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8519121
	speed: 0.0107s/iter; left time: 19.9004s
	iters: 200, epoch: 1 | loss: 0.8679558
	speed: 0.0044s/iter; left time: 7.7330s
Updating learning rate to 0.002608096601098123
Validation loss decreased (inf --> 0.5985).  Saving model state dict ...
Epoch: 1 cost time: 1.4134132862091064
Epoch: 1, Steps: 245 | Train Loss: 0.8599339 Vali Loss: 0.5985036 Best vali loss: 0.5985036
	iters: 100, epoch: 2 | loss: 0.8790565
	speed: 0.0098s/iter; left time: 15.8546s
	iters: 200, epoch: 2 | loss: 0.8370239
	speed: 0.0044s/iter; left time: 6.7106s
Updating learning rate to 0.0023142298249373737
Epoch: 2 cost time: 1.1177833080291748
Epoch: 2, Steps: 245 | Train Loss: 0.8580402 Vali Loss: 0.6271164 Best vali loss: 0.5985036
	iters: 100, epoch: 3 | loss: 0.7828338
	speed: 0.0092s/iter; left time: 12.5603s
	iters: 200, epoch: 3 | loss: 0.7779070
	speed: 0.0041s/iter; left time: 5.1797s
Updating learning rate to 0.0018744271142792672
Epoch: 3 cost time: 1.0626239776611328
Epoch: 3, Steps: 245 | Train Loss: 0.7803704 Vali Loss: 0.6343242 Best vali loss: 0.5985036
	iters: 100, epoch: 4 | loss: 0.6856872
	speed: 0.0096s/iter; left time: 10.7703s
	iters: 200, epoch: 4 | loss: 0.5909650
	speed: 0.0045s/iter; left time: 4.5794s
Updating learning rate to 0.001355644445
Epoch: 4 cost time: 1.1308228969573975
Epoch: 4, Steps: 245 | Train Loss: 0.6383261 Vali Loss: 0.6435099 Best vali loss: 0.5985036
	iters: 100, epoch: 5 | loss: 0.7561525
	speed: 0.0094s/iter; left time: 8.2418s
	iters: 200, epoch: 5 | loss: 0.5586643
	speed: 0.0038s/iter; left time: 2.9292s
Updating learning rate to 0.0008368617757207329
Epoch: 5 cost time: 1.0174760818481445
Epoch: 5, Steps: 245 | Train Loss: 0.6574084 Vali Loss: 0.6354861 Best vali loss: 0.5985036
	iters: 100, epoch: 6 | loss: 0.8148643
	speed: 0.0098s/iter; left time: 6.2618s
	iters: 200, epoch: 6 | loss: 1.2537751
	speed: 0.0058s/iter; left time: 3.1222s
Updating learning rate to 0.0003970590650626264
Epoch: 6 cost time: 1.4299423694610596
Epoch: 6, Steps: 245 | Train Loss: 1.0343197 Vali Loss: 0.6666501 Best vali loss: 0.5985036
	iters: 100, epoch: 7 | loss: 1.1567531
	speed: 0.0131s/iter; left time: 5.1140s
	iters: 200, epoch: 7 | loss: 0.6866255
	speed: 0.0098s/iter; left time: 2.8639s
Updating learning rate to 0.00010319228890187723
Epoch: 7 cost time: 2.119338274002075
Epoch: 7, Steps: 245 | Train Loss: 0.9216893 Vali Loss: 0.6675112 Best vali loss: 0.5985036
	iters: 100, epoch: 8 | loss: 0.6688234
	speed: 0.0253s/iter; left time: 3.6938s
	iters: 200, epoch: 8 | loss: 0.7037164
	speed: 0.0150s/iter; left time: 0.6900s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4607009887695312
Epoch: 8, Steps: 245 | Train Loss: 0.6862699 Vali Loss: 0.6789649 Best vali loss: 0.5985036

best validation loss 0.5985036402982123

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0103941528642, 'e_layers': 1, 'learning_rate': 5.42209019e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7042859
	speed: 0.0201s/iter; left time: 37.3587s
	iters: 200, epoch: 1 | loss: 1.2126250
	speed: 0.0106s/iter; left time: 18.5992s
Updating learning rate to 5.215724169985617e-05
Validation loss decreased (inf --> 0.6938).  Saving model state dict ...
Epoch: 1 cost time: 3.2373745441436768
Epoch: 1, Steps: 245 | Train Loss: 0.9584555 Vali Loss: 0.6937550 Best vali loss: 0.6937550
	iters: 100, epoch: 2 | loss: 0.6939722
	speed: 0.0233s/iter; left time: 37.6865s
	iters: 200, epoch: 2 | loss: 0.9010698
	speed: 0.0162s/iter; left time: 24.5732s
Updating learning rate to 4.628043465777028e-05
Validation loss decreased (0.6938 --> 0.6764).  Saving model state dict ...
Epoch: 2 cost time: 3.6109936237335205
Epoch: 2, Steps: 245 | Train Loss: 0.7975210 Vali Loss: 0.6764346 Best vali loss: 0.6764346
	iters: 100, epoch: 3 | loss: 0.7342051
	speed: 0.0229s/iter; left time: 31.4223s
	iters: 200, epoch: 3 | loss: 0.9897061
	speed: 0.0075s/iter; left time: 9.4934s
Updating learning rate to 3.7485171372511415e-05
Validation loss decreased (0.6764 --> 0.6635).  Saving model state dict ...
Epoch: 3 cost time: 1.8604326248168945
Epoch: 3, Steps: 245 | Train Loss: 0.8619556 Vali Loss: 0.6635193 Best vali loss: 0.6635193
	iters: 100, epoch: 4 | loss: 0.5984392
	speed: 0.0194s/iter; left time: 21.8837s
	iters: 200, epoch: 4 | loss: 1.0963631
	speed: 0.0107s/iter; left time: 10.9432s
Updating learning rate to 2.711045095e-05
Validation loss decreased (0.6635 --> 0.6544).  Saving model state dict ...
Epoch: 4 cost time: 2.461312770843506
Epoch: 4, Steps: 245 | Train Loss: 0.8474011 Vali Loss: 0.6544253 Best vali loss: 0.6544253
	iters: 100, epoch: 5 | loss: 1.1025751
	speed: 0.0282s/iter; left time: 24.8640s
	iters: 200, epoch: 5 | loss: 1.0809596
	speed: 0.0122s/iter; left time: 9.5012s
Updating learning rate to 1.6735730527488594e-05
Validation loss decreased (0.6544 --> 0.6489).  Saving model state dict ...
Epoch: 5 cost time: 3.294490337371826
Epoch: 5, Steps: 245 | Train Loss: 1.0917673 Vali Loss: 0.6489500 Best vali loss: 0.6489500
	iters: 100, epoch: 6 | loss: 1.2041910
	speed: 0.0233s/iter; left time: 14.8444s
	iters: 200, epoch: 6 | loss: 1.3576511
	speed: 0.0085s/iter; left time: 4.5627s
Updating learning rate to 7.940467242229723e-06
Validation loss decreased (0.6489 --> 0.6458).  Saving model state dict ...
Epoch: 6 cost time: 2.2309508323669434
Epoch: 6, Steps: 245 | Train Loss: 1.2809210 Vali Loss: 0.6457820 Best vali loss: 0.6457820
	iters: 100, epoch: 7 | loss: 0.6899841
	speed: 0.0218s/iter; left time: 8.5090s
	iters: 200, epoch: 7 | loss: 0.9985096
	speed: 0.0117s/iter; left time: 3.4031s
Updating learning rate to 2.0636602001438307e-06
Validation loss decreased (0.6458 --> 0.6444).  Saving model state dict ...
Epoch: 7 cost time: 2.795792818069458
Epoch: 7, Steps: 245 | Train Loss: 0.8442469 Vali Loss: 0.6444074 Best vali loss: 0.6444074
	iters: 100, epoch: 8 | loss: 1.0183089
	speed: 0.0329s/iter; left time: 4.8074s
	iters: 200, epoch: 8 | loss: 0.9040146
	speed: 0.0105s/iter; left time: 0.4808s
Updating learning rate to 0.0
Validation loss decreased (0.6444 --> 0.6441).  Saving model state dict ...
Epoch: 8 cost time: 2.562854766845703
Epoch: 8, Steps: 245 | Train Loss: 0.9611617 Vali Loss: 0.6440587 Best vali loss: 0.6440587

best validation loss 0.6440586767942472

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0015946653779, 'e_layers': 2, 'learning_rate': 5.11411667e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.919472194143889e-05
Validation loss decreased (inf --> 0.6852).  Saving model state dict ...
Epoch: 1 cost time: 1.258397102355957
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6852078 Best vali loss: 0.6852078
Updating learning rate to 4.3651716235680824e-05
Validation loss decreased (0.6852 --> 0.6625).  Saving model state dict ...
Epoch: 2 cost time: 1.671130895614624
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6625007 Best vali loss: 0.6625007
Updating learning rate to 3.535602195395562e-05
Validation loss decreased (0.6625 --> 0.6468).  Saving model state dict ...
Epoch: 3 cost time: 2.193977117538452
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6467862 Best vali loss: 0.6467862

best validation loss 0.6467862005368364

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.010223158032, 'e_layers': 2, 'learning_rate': 0.0002911151304, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0202192
	speed: 0.0356s/iter; left time: 31.4672s
Updating learning rate to 0.0002911151304
Validation loss decreased (inf --> 0.6537).  Saving model state dict ...
Epoch: 1 cost time: 3.960707187652588
Epoch: 1, Steps: 123 | Train Loss: 1.0202192 Vali Loss: 0.6537308 Best vali loss: 0.6537308
	iters: 100, epoch: 2 | loss: 0.7867990
	speed: 0.0495s/iter; left time: 37.7122s
Updating learning rate to 0.0001455575652
Validation loss decreased (0.6537 --> 0.6259).  Saving model state dict ...
Epoch: 2 cost time: 2.6881394386291504
Epoch: 2, Steps: 123 | Train Loss: 0.7867990 Vali Loss: 0.6259164 Best vali loss: 0.6259164
	iters: 100, epoch: 3 | loss: 0.9116594
	speed: 0.0161s/iter; left time: 10.2951s
Updating learning rate to 7.27787826e-05
Validation loss decreased (0.6259 --> 0.6186).  Saving model state dict ...
Epoch: 3 cost time: 1.0767731666564941
Epoch: 3, Steps: 123 | Train Loss: 0.9116594 Vali Loss: 0.6186262 Best vali loss: 0.6186262

best validation loss 0.6186262441420655

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001057774261, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7243581
	speed: 0.0151s/iter; left time: 13.3868s
Updating learning rate to 0.00010175151253775759
Validation loss decreased (inf --> 0.6294).  Saving model state dict ...
Epoch: 1 cost time: 1.3840937614440918
Epoch: 1, Steps: 123 | Train Loss: 0.7243581 Vali Loss: 0.6294488 Best vali loss: 0.6294488
	iters: 100, epoch: 2 | loss: 0.6860791
	speed: 0.0118s/iter; left time: 9.0087s
Updating learning rate to 9.028668069588445e-05
Validation loss decreased (0.6294 --> 0.6164).  Saving model state dict ...
Epoch: 2 cost time: 0.9910268783569336
Epoch: 2, Steps: 123 | Train Loss: 0.6860791 Vali Loss: 0.6164366 Best vali loss: 0.6164366
	iters: 100, epoch: 3 | loss: 0.8735157
	speed: 0.0124s/iter; left time: 7.9281s
Updating learning rate to 7.312834729334631e-05
Validation loss decreased (0.6164 --> 0.6069).  Saving model state dict ...
Epoch: 3 cost time: 1.0453112125396729
Epoch: 3, Steps: 123 | Train Loss: 0.8735157 Vali Loss: 0.6069274 Best vali loss: 0.6069274

best validation loss 0.6069274002454282

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001057774261, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6947796
	speed: 0.0150s/iter; left time: 7.7650s
Updating learning rate to 5.288871305e-05
Validation loss decreased (0.6069 --> 0.5998).  Saving model state dict ...
Epoch: 4 cost time: 1.3262288570404053
Epoch: 4, Steps: 123 | Train Loss: 0.6947796 Vali Loss: 0.5997889 Best vali loss: 0.5997889
	iters: 100, epoch: 5 | loss: 0.6758593
	speed: 0.0134s/iter; left time: 5.2699s
Updating learning rate to 3.2649078806653686e-05
Epoch: 5 cost time: 1.1619744300842285
Epoch: 5, Steps: 123 | Train Loss: 0.6758593 Vali Loss: 0.6089258 Best vali loss: 0.5997889
	iters: 100, epoch: 6 | loss: 0.8639321
	speed: 0.0130s/iter; left time: 3.5055s
Updating learning rate to 1.5490745404115554e-05
Epoch: 6 cost time: 1.0762770175933838
Epoch: 6, Steps: 123 | Train Loss: 0.8639321 Vali Loss: 0.6050162 Best vali loss: 0.5997889
	iters: 100, epoch: 7 | loss: 0.6039042
	speed: 0.0129s/iter; left time: 1.8953s
Updating learning rate to 4.0259135622424095e-06
Epoch: 7 cost time: 1.1037876605987549
Epoch: 7, Steps: 123 | Train Loss: 0.6039042 Vali Loss: 0.6045798 Best vali loss: 0.5997889
	iters: 100, epoch: 8 | loss: 0.6729706
	speed: 0.0127s/iter; left time: 0.3053s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.05806565284729
Epoch: 8, Steps: 123 | Train Loss: 0.6729706 Vali Loss: 0.6035026 Best vali loss: 0.5997889

best validation loss 0.5997889184499438

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042447183801, 'e_layers': 3, 'learning_rate': 0.0001220593649, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8112958
	speed: 0.0131s/iter; left time: 24.4257s
	iters: 200, epoch: 1 | loss: 1.1040483
	speed: 0.0086s/iter; left time: 15.1433s
Updating learning rate to 0.0001220593649
Validation loss decreased (inf --> 0.6367).  Saving model state dict ...
Epoch: 1 cost time: 2.3194258213043213
Epoch: 1, Steps: 245 | Train Loss: 0.9576720 Vali Loss: 0.6367473 Best vali loss: 0.6367473
	iters: 100, epoch: 2 | loss: 1.0772287
	speed: 0.0156s/iter; left time: 25.1597s
	iters: 200, epoch: 2 | loss: 0.9857345
	speed: 0.0092s/iter; left time: 13.9164s
Updating learning rate to 6.102968245e-05
Validation loss decreased (0.6367 --> 0.6153).  Saving model state dict ...
Epoch: 2 cost time: 2.094059944152832
Epoch: 2, Steps: 245 | Train Loss: 1.0314816 Vali Loss: 0.6152973 Best vali loss: 0.6152973
	iters: 100, epoch: 3 | loss: 0.6526843
	speed: 0.0158s/iter; left time: 21.6829s
	iters: 200, epoch: 3 | loss: 1.1560404
	speed: 0.0084s/iter; left time: 10.7018s
Updating learning rate to 3.0514841225e-05
Validation loss decreased (0.6153 --> 0.6111).  Saving model state dict ...
Epoch: 3 cost time: 2.1370794773101807
Epoch: 3, Steps: 245 | Train Loss: 0.9043624 Vali Loss: 0.6110813 Best vali loss: 0.6110813
	iters: 100, epoch: 4 | loss: 0.9832567
	speed: 0.0154s/iter; left time: 17.3315s
	iters: 200, epoch: 4 | loss: 1.0985385
	speed: 0.0077s/iter; left time: 7.9296s
Updating learning rate to 1.52574206125e-05
Validation loss decreased (0.6111 --> 0.6100).  Saving model state dict ...
Epoch: 4 cost time: 1.9832634925842285
Epoch: 4, Steps: 245 | Train Loss: 1.0408976 Vali Loss: 0.6100449 Best vali loss: 0.6100449
	iters: 100, epoch: 5 | loss: 0.9990640
	speed: 0.0161s/iter; left time: 14.2101s
	iters: 200, epoch: 5 | loss: 0.5500462
	speed: 0.0073s/iter; left time: 5.7114s
Updating learning rate to 7.62871030625e-06
Validation loss decreased (0.6100 --> 0.6073).  Saving model state dict ...
Epoch: 5 cost time: 2.0535268783569336
Epoch: 5, Steps: 245 | Train Loss: 0.7745551 Vali Loss: 0.6072913 Best vali loss: 0.6072913
	iters: 100, epoch: 6 | loss: 0.9088884
	speed: 0.0200s/iter; left time: 12.7220s
	iters: 200, epoch: 6 | loss: 0.6911829
	speed: 0.0096s/iter; left time: 5.1244s
Updating learning rate to 3.814355153125e-06
Epoch: 6 cost time: 2.487097978591919
Epoch: 6, Steps: 245 | Train Loss: 0.8000356 Vali Loss: 0.6077843 Best vali loss: 0.6072913
	iters: 100, epoch: 7 | loss: 0.6807059
	speed: 0.0209s/iter; left time: 8.1605s
	iters: 200, epoch: 7 | loss: 0.8758860
	speed: 0.0111s/iter; left time: 3.2310s
Updating learning rate to 1.9071775765625e-06
Epoch: 7 cost time: 2.7340173721313477
Epoch: 7, Steps: 245 | Train Loss: 0.7782959 Vali Loss: 0.6079615 Best vali loss: 0.6072913
	iters: 100, epoch: 8 | loss: 0.8966024
	speed: 0.0207s/iter; left time: 3.0233s
	iters: 200, epoch: 8 | loss: 0.9185224
	speed: 0.0104s/iter; left time: 0.4786s
Updating learning rate to 9.5358878828125e-07
Epoch: 8 cost time: 2.6540024280548096
Epoch: 8, Steps: 245 | Train Loss: 0.9075624 Vali Loss: 0.6079638 Best vali loss: 0.6072913

best validation loss 0.6072912822989941

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0044408584486, 'e_layers': 1, 'learning_rate': 0.000472789623, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5178436
	speed: 0.0150s/iter; left time: 13.2804s
Updating learning rate to 0.000472789623
Validation loss decreased (inf --> 0.6180).  Saving model state dict ...
Epoch: 1 cost time: 1.366875410079956
Epoch: 1, Steps: 123 | Train Loss: 0.5178436 Vali Loss: 0.6180042 Best vali loss: 0.6180042
	iters: 100, epoch: 2 | loss: 0.7705439
	speed: 0.0143s/iter; left time: 10.9132s
Updating learning rate to 0.0002363948115
Validation loss decreased (0.6180 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 1.1120729446411133
Epoch: 2, Steps: 123 | Train Loss: 0.7705439 Vali Loss: 0.6035904 Best vali loss: 0.6035904
	iters: 100, epoch: 3 | loss: 0.8741356
	speed: 0.0131s/iter; left time: 8.3489s
Updating learning rate to 0.00011819740575
Epoch: 3 cost time: 1.0699219703674316
Epoch: 3, Steps: 123 | Train Loss: 0.8741356 Vali Loss: 0.6345141 Best vali loss: 0.6035904
	iters: 100, epoch: 4 | loss: 0.5441191
	speed: 0.0094s/iter; left time: 4.8340s
Updating learning rate to 5.9098702875e-05
Epoch: 4 cost time: 0.5699689388275146
Epoch: 4, Steps: 123 | Train Loss: 0.5441191 Vali Loss: 0.6255248 Best vali loss: 0.6035904
	iters: 100, epoch: 5 | loss: 0.7723380
	speed: 0.0093s/iter; left time: 3.6501s
Updating learning rate to 2.95493514375e-05
Epoch: 5 cost time: 0.8282756805419922
Epoch: 5, Steps: 123 | Train Loss: 0.7723380 Vali Loss: 0.6407873 Best vali loss: 0.6035904
	iters: 100, epoch: 6 | loss: 0.9290917
	speed: 0.0142s/iter; left time: 3.8327s
Updating learning rate to 1.477467571875e-05
Epoch: 6 cost time: 1.3341820240020752
Epoch: 6, Steps: 123 | Train Loss: 0.9290917 Vali Loss: 0.6418676 Best vali loss: 0.6035904
	iters: 100, epoch: 7 | loss: 0.7286696
	speed: 0.0227s/iter; left time: 3.3365s
Updating learning rate to 7.387337859375e-06
Epoch: 7 cost time: 1.511359691619873
Epoch: 7, Steps: 123 | Train Loss: 0.7286696 Vali Loss: 0.6417073 Best vali loss: 0.6035904
	iters: 100, epoch: 8 | loss: 0.6801283
	speed: 0.0281s/iter; left time: 0.6748s
Updating learning rate to 3.6936689296875e-06
Epoch: 8 cost time: 1.680600643157959
Epoch: 8, Steps: 123 | Train Loss: 0.6801283 Vali Loss: 0.6396574 Best vali loss: 0.6035904

best validation loss 0.6035904300428

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0119807838687, 'e_layers': 3, 'learning_rate': 0.0004563359081, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744480
	speed: 0.0197s/iter; left time: 75.2563s
	iters: 200, epoch: 1 | loss: 1.2977660
	speed: 0.0098s/iter; left time: 36.4288s
	iters: 300, epoch: 1 | loss: 1.0293056
	speed: 0.0135s/iter; left time: 48.9243s
	iters: 400, epoch: 1 | loss: 0.6778580
	speed: 0.0111s/iter; left time: 38.9333s
Updating learning rate to 0.00043896765677177077
Validation loss decreased (inf --> 0.6125).  Saving model state dict ...
Epoch: 1 cost time: 6.0988218784332275
Epoch: 1, Steps: 490 | Train Loss: 0.9448444 Vali Loss: 0.6125072 Best vali loss: 0.6125072
	iters: 100, epoch: 2 | loss: 0.6478937
	speed: 0.0423s/iter; left time: 140.7926s
	iters: 200, epoch: 2 | loss: 1.3919365
	speed: 0.0135s/iter; left time: 43.6714s
	iters: 300, epoch: 2 | loss: 0.3396368
	speed: 0.0105s/iter; left time: 32.8877s
	iters: 400, epoch: 2 | loss: 0.9095663
	speed: 0.0117s/iter; left time: 35.3294s
Updating learning rate to 0.0003895070616082156
Validation loss decreased (0.6125 --> 0.5643).  Saving model state dict ...
Epoch: 2 cost time: 6.484006881713867
Epoch: 2, Steps: 490 | Train Loss: 0.8222583 Vali Loss: 0.5642950 Best vali loss: 0.5642950
	iters: 100, epoch: 3 | loss: 0.8107532
	speed: 0.0433s/iter; left time: 123.0143s
	iters: 200, epoch: 3 | loss: 0.7458813
	speed: 0.0143s/iter; left time: 39.1864s
	iters: 300, epoch: 3 | loss: 0.8599432
	speed: 0.0142s/iter; left time: 37.4780s
	iters: 400, epoch: 3 | loss: 0.7603539
	speed: 0.0145s/iter; left time: 36.7423s
Updating learning rate to 0.0003154840498615741
Validation loss decreased (0.5643 --> 0.5566).  Saving model state dict ...
Epoch: 3 cost time: 6.492393732070923
Epoch: 3, Steps: 490 | Train Loss: 0.7942329 Vali Loss: 0.5565940 Best vali loss: 0.5565940

best validation loss 0.5565939670577749

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2081215
	speed: 0.0159s/iter; left time: 122.7567s
	iters: 200, epoch: 1 | loss: 0.8015472
	speed: 0.0109s/iter; left time: 83.0741s
	iters: 300, epoch: 1 | loss: 0.7942922
	speed: 0.0111s/iter; left time: 83.4605s
	iters: 400, epoch: 1 | loss: 1.0678725
	speed: 0.0105s/iter; left time: 78.0135s
	iters: 500, epoch: 1 | loss: 0.8077009
	speed: 0.0107s/iter; left time: 78.3274s
	iters: 600, epoch: 1 | loss: 1.0494208
	speed: 0.0083s/iter; left time: 60.0602s
	iters: 700, epoch: 1 | loss: 0.7122958
	speed: 0.0082s/iter; left time: 58.5606s
	iters: 800, epoch: 1 | loss: 1.4664660
	speed: 0.0084s/iter; left time: 59.0681s
	iters: 900, epoch: 1 | loss: 0.7213167
	speed: 0.0088s/iter; left time: 60.8257s
Updating learning rate to 9.547589994094374e-05
Validation loss decreased (inf --> 0.6411).  Saving model state dict ...
Epoch: 1 cost time: 9.682305574417114
Epoch: 1, Steps: 979 | Train Loss: 0.9587815 Vali Loss: 0.6410698 Best vali loss: 0.6410698
	iters: 100, epoch: 2 | loss: 1.4822729
	speed: 0.0311s/iter; left time: 210.1782s
	iters: 200, epoch: 2 | loss: 0.3889965
	speed: 0.0090s/iter; left time: 60.0272s
	iters: 300, epoch: 2 | loss: 0.8564777
	speed: 0.0086s/iter; left time: 56.1263s
	iters: 400, epoch: 2 | loss: 0.4341428
	speed: 0.0091s/iter; left time: 58.4679s
	iters: 500, epoch: 2 | loss: 0.7087295
	speed: 0.0107s/iter; left time: 67.6917s
	iters: 600, epoch: 2 | loss: 0.4464386
	speed: 0.0102s/iter; left time: 63.4781s
	iters: 700, epoch: 2 | loss: 0.8036382
	speed: 0.0104s/iter; left time: 64.2618s
	iters: 800, epoch: 2 | loss: 0.4784617
	speed: 0.0099s/iter; left time: 59.9359s
	iters: 900, epoch: 2 | loss: 0.4591318
	speed: 0.0087s/iter; left time: 51.5477s
Updating learning rate to 8.47181715251795e-05
Validation loss decreased (0.6411 --> 0.6174).  Saving model state dict ...
Epoch: 2 cost time: 9.335616111755371
Epoch: 2, Steps: 979 | Train Loss: 0.6731433 Vali Loss: 0.6173503 Best vali loss: 0.6173503
	iters: 100, epoch: 3 | loss: 2.0133262
	speed: 0.0336s/iter; left time: 193.9076s
	iters: 200, epoch: 3 | loss: 1.0417416
	speed: 0.0114s/iter; left time: 64.9421s
	iters: 300, epoch: 3 | loss: 0.3965363
	speed: 0.0116s/iter; left time: 64.5242s
	iters: 400, epoch: 3 | loss: 0.9839981
	speed: 0.0129s/iter; left time: 70.4077s
	iters: 500, epoch: 3 | loss: 1.0229021
	speed: 0.0117s/iter; left time: 62.7405s
	iters: 600, epoch: 3 | loss: 1.2562624
	speed: 0.0121s/iter; left time: 64.0449s
	iters: 700, epoch: 3 | loss: 0.2962181
	speed: 0.0108s/iter; left time: 55.9225s
	iters: 800, epoch: 3 | loss: 1.1115406
	speed: 0.0111s/iter; left time: 56.5862s
	iters: 900, epoch: 3 | loss: 0.9595988
	speed: 0.0086s/iter; left time: 42.6566s
Updating learning rate to 6.861809318495647e-05
Validation loss decreased (0.6174 --> 0.6115).  Saving model state dict ...
Epoch: 3 cost time: 11.14396357536316
Epoch: 3, Steps: 979 | Train Loss: 1.0091249 Vali Loss: 0.6115284 Best vali loss: 0.6115284

best validation loss 0.6115283990612409

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014152615275, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.6050).  Saving model state dict ...
Epoch: 1 cost time: 1.828108549118042
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6049528 Best vali loss: 0.6049528
Updating learning rate to 0.0002257411363
Validation loss decreased (0.6050 --> 0.6047).  Saving model state dict ...
Epoch: 2 cost time: 1.466179609298706
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6046708 Best vali loss: 0.6046708
Updating learning rate to 0.00011287056815
Epoch: 3 cost time: 1.4918851852416992
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6170827 Best vali loss: 0.6046708

best validation loss 0.6046707904873927

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0119807838687, 'e_layers': 3, 'learning_rate': 0.0004563359081, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6309717
	speed: 0.0242s/iter; left time: 56.9192s
	iters: 200, epoch: 4 | loss: 0.9276627
	speed: 0.0102s/iter; left time: 22.9315s
	iters: 300, epoch: 4 | loss: 0.7349830
	speed: 0.0079s/iter; left time: 17.0014s
	iters: 400, epoch: 4 | loss: 0.6533256
	speed: 0.0076s/iter; left time: 15.4872s
Updating learning rate to 0.00022816795405
Validation loss decreased (0.5566 --> 0.5542).  Saving model state dict ...
Epoch: 4 cost time: 5.438645839691162
Epoch: 4, Steps: 490 | Train Loss: 0.7367357 Vali Loss: 0.5541656 Best vali loss: 0.5541656
	iters: 100, epoch: 5 | loss: 0.6314011
	speed: 0.0250s/iter; left time: 46.6180s
	iters: 200, epoch: 5 | loss: 1.3455435
	speed: 0.0061s/iter; left time: 10.7781s
	iters: 300, epoch: 5 | loss: 0.3172723
	speed: 0.0075s/iter; left time: 12.4580s
	iters: 400, epoch: 5 | loss: 0.7809712
	speed: 0.0093s/iter; left time: 14.4901s
Updating learning rate to 0.00014085185823842593
Validation loss decreased (0.5542 --> 0.5415).  Saving model state dict ...
Epoch: 5 cost time: 3.99527907371521
Epoch: 5, Steps: 490 | Train Loss: 0.7687970 Vali Loss: 0.5414909 Best vali loss: 0.5414909
	iters: 100, epoch: 6 | loss: 0.7036826
	speed: 0.0238s/iter; left time: 32.6384s
	iters: 200, epoch: 6 | loss: 0.7076862
	speed: 0.0085s/iter; left time: 10.8530s
	iters: 300, epoch: 6 | loss: 0.8248343
	speed: 0.0060s/iter; left time: 7.0242s
	iters: 400, epoch: 6 | loss: 0.7071598
	speed: 0.0087s/iter; left time: 9.3085s
Updating learning rate to 6.682884649178444e-05
Epoch: 6 cost time: 4.141130685806274
Epoch: 6, Steps: 490 | Train Loss: 0.7358407 Vali Loss: 0.5449571 Best vali loss: 0.5414909
	iters: 100, epoch: 7 | loss: 0.7080467
	speed: 0.0270s/iter; left time: 23.8287s
	iters: 200, epoch: 7 | loss: 0.7808688
	speed: 0.0090s/iter; left time: 7.0147s
	iters: 300, epoch: 7 | loss: 0.7560161
	speed: 0.0085s/iter; left time: 5.7652s
	iters: 400, epoch: 7 | loss: 0.5984582
	speed: 0.0069s/iter; left time: 4.0200s
Updating learning rate to 1.736825132822925e-05
Epoch: 7 cost time: 4.272810220718384
Epoch: 7, Steps: 490 | Train Loss: 0.7108474 Vali Loss: 0.5454017 Best vali loss: 0.5414909
	iters: 100, epoch: 8 | loss: 0.5019283
	speed: 0.0266s/iter; left time: 10.3862s
	iters: 200, epoch: 8 | loss: 0.6794213
	speed: 0.0093s/iter; left time: 2.7117s
	iters: 300, epoch: 8 | loss: 0.5376524
	speed: 0.0145s/iter; left time: 2.7610s
	iters: 400, epoch: 8 | loss: 0.5685096
	speed: 0.0153s/iter; left time: 1.3954s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.192285060882568
Epoch: 8, Steps: 490 | Train Loss: 0.5718779 Vali Loss: 0.5476406 Best vali loss: 0.5414909

best validation loss 0.5414908523914826

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0015757048477, 'e_layers': 3, 'learning_rate': 0.0011631691937, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8820179
	speed: 0.0185s/iter; left time: 16.3833s
Updating learning rate to 0.0011631691937
Validation loss decreased (inf --> 0.6177).  Saving model state dict ...
Epoch: 1 cost time: 1.725484848022461
Epoch: 1, Steps: 123 | Train Loss: 0.8820179 Vali Loss: 0.6176787 Best vali loss: 0.6176787
	iters: 100, epoch: 2 | loss: 0.8464225
	speed: 0.0148s/iter; left time: 11.2815s
Updating learning rate to 0.00058158459685
Validation loss decreased (0.6177 --> 0.6044).  Saving model state dict ...
Epoch: 2 cost time: 1.2207353115081787
Epoch: 2, Steps: 123 | Train Loss: 0.8464225 Vali Loss: 0.6043804 Best vali loss: 0.6043804
	iters: 100, epoch: 3 | loss: 0.6868144
	speed: 0.0282s/iter; left time: 18.0489s
Updating learning rate to 0.000290792298425
Epoch: 3 cost time: 2.306527853012085
Epoch: 3, Steps: 123 | Train Loss: 0.6868144 Vali Loss: 0.6110891 Best vali loss: 0.6043804
	iters: 100, epoch: 4 | loss: 1.0285321
	speed: 0.0317s/iter; left time: 16.3659s
Updating learning rate to 0.0001453961492125
Epoch: 4 cost time: 2.72758150100708
Epoch: 4, Steps: 123 | Train Loss: 1.0285321 Vali Loss: 0.6118825 Best vali loss: 0.6043804
	iters: 100, epoch: 5 | loss: 0.6936337
	speed: 0.0290s/iter; left time: 11.3819s
Updating learning rate to 7.269807460625e-05
Epoch: 5 cost time: 1.999295711517334
Epoch: 5, Steps: 123 | Train Loss: 0.6936337 Vali Loss: 0.6124355 Best vali loss: 0.6043804
	iters: 100, epoch: 6 | loss: 0.8420418
	speed: 0.0354s/iter; left time: 9.5488s
Updating learning rate to 3.6349037303125e-05
Epoch: 6 cost time: 2.0541622638702393
Epoch: 6, Steps: 123 | Train Loss: 0.8420418 Vali Loss: 0.6114853 Best vali loss: 0.6043804
	iters: 100, epoch: 7 | loss: 0.7525032
	speed: 0.0283s/iter; left time: 4.1662s
Updating learning rate to 1.81745186515625e-05
Epoch: 7 cost time: 2.399807929992676
Epoch: 7, Steps: 123 | Train Loss: 0.7525032 Vali Loss: 0.6114261 Best vali loss: 0.6043804
	iters: 100, epoch: 8 | loss: 0.6740505
	speed: 0.0293s/iter; left time: 0.7033s
Updating learning rate to 9.08725932578125e-06
Epoch: 8 cost time: 2.124403953552246
Epoch: 8, Steps: 123 | Train Loss: 0.6740505 Vali Loss: 0.6111031 Best vali loss: 0.6043804

best validation loss 0.604380404987803

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0069097083138, 'e_layers': 1, 'learning_rate': 0.0025717436101, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7294326
	speed: 0.0175s/iter; left time: 32.4859s
	iters: 200, epoch: 1 | loss: 0.6862880
	speed: 0.0121s/iter; left time: 21.2262s
Updating learning rate to 0.0025717436101
Validation loss decreased (inf --> 0.6436).  Saving model state dict ...
Epoch: 1 cost time: 3.1779708862304688
Epoch: 1, Steps: 245 | Train Loss: 0.7078603 Vali Loss: 0.6436067 Best vali loss: 0.6436067
	iters: 100, epoch: 2 | loss: 0.8641860
	speed: 0.0271s/iter; left time: 43.7657s
	iters: 200, epoch: 2 | loss: 1.0074136
	speed: 0.0111s/iter; left time: 16.8781s
Updating learning rate to 0.00128587180505
Epoch: 2 cost time: 2.9291486740112305
Epoch: 2, Steps: 245 | Train Loss: 0.9357998 Vali Loss: 0.6582055 Best vali loss: 0.6436067
	iters: 100, epoch: 3 | loss: 1.1094218
	speed: 0.0259s/iter; left time: 35.4457s
	iters: 200, epoch: 3 | loss: 1.0977774
	speed: 0.0136s/iter; left time: 17.3439s
Updating learning rate to 0.000642935902525
Epoch: 3 cost time: 2.897900342941284
Epoch: 3, Steps: 245 | Train Loss: 1.1035996 Vali Loss: 0.6492340 Best vali loss: 0.6436067
	iters: 100, epoch: 4 | loss: 0.6412063
	speed: 0.0150s/iter; left time: 16.8568s
	iters: 200, epoch: 4 | loss: 0.6413837
	speed: 0.0069s/iter; left time: 7.0956s
Updating learning rate to 0.0003214679512625
Epoch: 4 cost time: 1.7012364864349365
Epoch: 4, Steps: 245 | Train Loss: 0.6412950 Vali Loss: 0.6745291 Best vali loss: 0.6436067
	iters: 100, epoch: 5 | loss: 0.9117222
	speed: 0.0152s/iter; left time: 13.4031s
	iters: 200, epoch: 5 | loss: 0.5613479
	speed: 0.0070s/iter; left time: 5.4406s
Updating learning rate to 0.00016073397563125
Epoch: 5 cost time: 1.8196399211883545
Epoch: 5, Steps: 245 | Train Loss: 0.7365351 Vali Loss: 0.6920294 Best vali loss: 0.6436067
	iters: 100, epoch: 6 | loss: 0.7185050
	speed: 0.0142s/iter; left time: 9.0344s
	iters: 200, epoch: 6 | loss: 0.7730922
	speed: 0.0074s/iter; left time: 3.9909s
Updating learning rate to 8.0366987815625e-05
Epoch: 6 cost time: 1.6475236415863037
Epoch: 6, Steps: 245 | Train Loss: 0.7457986 Vali Loss: 0.6972854 Best vali loss: 0.6436067
	iters: 100, epoch: 7 | loss: 0.9783767
	speed: 0.0088s/iter; left time: 3.4509s
	iters: 200, epoch: 7 | loss: 0.8958663
	speed: 0.0078s/iter; left time: 2.2665s
Updating learning rate to 4.01834939078125e-05
Epoch: 7 cost time: 1.5552587509155273
Epoch: 7, Steps: 245 | Train Loss: 0.9371215 Vali Loss: 0.7133788 Best vali loss: 0.6436067
	iters: 100, epoch: 8 | loss: 0.7771823
	speed: 0.0172s/iter; left time: 2.5104s
	iters: 200, epoch: 8 | loss: 0.4419845
	speed: 0.0075s/iter; left time: 0.3470s
Updating learning rate to 2.009174695390625e-05
Epoch: 8 cost time: 2.0477993488311768
Epoch: 8, Steps: 245 | Train Loss: 0.6095834 Vali Loss: 0.7017717 Best vali loss: 0.6436067

best validation loss 0.6436067408348112

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0035464357287, 'e_layers': 2, 'learning_rate': 0.0003036080774, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8133616
	speed: 0.0162s/iter; left time: 30.1201s
	iters: 200, epoch: 1 | loss: 0.7339144
	speed: 0.0091s/iter; left time: 16.1040s
Updating learning rate to 0.0002920526830074813
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 2.6818442344665527
Epoch: 1, Steps: 245 | Train Loss: 0.7736380 Vali Loss: 0.6058242 Best vali loss: 0.6058242
	iters: 100, epoch: 2 | loss: 0.8960698
	speed: 0.0189s/iter; left time: 30.5680s
	iters: 200, epoch: 2 | loss: 0.9002523
	speed: 0.0132s/iter; left time: 20.0743s
Updating learning rate to 0.0002591457038762751
Epoch: 2 cost time: 2.7614455223083496
Epoch: 2, Steps: 245 | Train Loss: 0.8981611 Vali Loss: 0.6086207 Best vali loss: 0.6058242
	iters: 100, epoch: 3 | loss: 0.7741293
	speed: 0.0256s/iter; left time: 35.1065s
	iters: 200, epoch: 3 | loss: 1.1553745
	speed: 0.0108s/iter; left time: 13.6963s
Updating learning rate to 0.00020989692927659895
Epoch: 3 cost time: 2.5567216873168945
Epoch: 3, Steps: 245 | Train Loss: 0.9647519 Vali Loss: 0.6180395 Best vali loss: 0.6058242

best validation loss 0.6058241643325315

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0059927497786, 'e_layers': 4, 'learning_rate': 0.003057829033, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9490837
	speed: 0.0209s/iter; left time: 79.7172s
	iters: 200, epoch: 1 | loss: 1.1997569
	speed: 0.0138s/iter; left time: 51.3344s
	iters: 300, epoch: 1 | loss: 0.5563854
	speed: 0.0085s/iter; left time: 30.6158s
	iters: 400, epoch: 1 | loss: 0.8253600
	speed: 0.0181s/iter; left time: 63.6018s
Updating learning rate to 0.003057829033
Validation loss decreased (inf --> 0.6431).  Saving model state dict ...
Epoch: 1 cost time: 7.154671907424927
Epoch: 1, Steps: 490 | Train Loss: 0.8826465 Vali Loss: 0.6431258 Best vali loss: 0.6431258
	iters: 100, epoch: 2 | loss: 1.3780766
	speed: 0.0474s/iter; left time: 157.8625s
	iters: 200, epoch: 2 | loss: 0.8226448
	speed: 0.0160s/iter; left time: 51.7962s
	iters: 300, epoch: 2 | loss: 0.6732241
	speed: 0.0173s/iter; left time: 54.3181s
	iters: 400, epoch: 2 | loss: 0.9220474
	speed: 0.0094s/iter; left time: 28.5911s
Updating learning rate to 0.0015289145165
Epoch: 2 cost time: 6.605445384979248
Epoch: 2, Steps: 490 | Train Loss: 0.9489982 Vali Loss: 0.6495109 Best vali loss: 0.6431258
	iters: 100, epoch: 3 | loss: 0.7545910
	speed: 0.0276s/iter; left time: 78.4317s
	iters: 200, epoch: 3 | loss: 0.6267471
	speed: 0.0100s/iter; left time: 27.4480s
	iters: 300, epoch: 3 | loss: 0.9159924
	speed: 0.0101s/iter; left time: 26.7103s
	iters: 400, epoch: 3 | loss: 1.1780438
	speed: 0.0101s/iter; left time: 25.5870s
Updating learning rate to 0.00076445725825
Epoch: 3 cost time: 4.793107986450195
Epoch: 3, Steps: 490 | Train Loss: 0.8688436 Vali Loss: 0.6500932 Best vali loss: 0.6431258

best validation loss 0.643125805036716

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0030171201133, 'e_layers': 3, 'learning_rate': 0.0001768704453, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7840320
	speed: 0.0180s/iter; left time: 33.5769s
	iters: 200, epoch: 1 | loss: 0.8834903
	speed: 0.0113s/iter; left time: 19.9006s
Updating learning rate to 0.00017013871480941355
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 3.1631782054901123
Epoch: 1, Steps: 245 | Train Loss: 0.8337612 Vali Loss: 0.6064365 Best vali loss: 0.6064365
	iters: 100, epoch: 2 | loss: 0.8513041
	speed: 0.0222s/iter; left time: 35.8052s
	iters: 200, epoch: 2 | loss: 0.8429205
	speed: 0.0109s/iter; left time: 16.5934s
Updating learning rate to 0.00015096836828155716
Epoch: 2 cost time: 2.8046021461486816
Epoch: 2, Steps: 245 | Train Loss: 0.8471123 Vali Loss: 0.6379777 Best vali loss: 0.6064365
	iters: 100, epoch: 3 | loss: 0.9784688
	speed: 0.0200s/iter; left time: 27.4605s
	iters: 200, epoch: 3 | loss: 0.7011738
	speed: 0.0089s/iter; left time: 11.3093s
Updating learning rate to 0.00012227791719567294
Validation loss decreased (0.6064 --> 0.5392).  Saving model state dict ...
Epoch: 3 cost time: 2.2816765308380127
Epoch: 3, Steps: 245 | Train Loss: 0.8398213 Vali Loss: 0.5392445 Best vali loss: 0.5392445

best validation loss 0.539244481586075

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0030171201133, 'e_layers': 3, 'learning_rate': 0.0001768704453, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5736104
	speed: 0.0180s/iter; left time: 20.2509s
	iters: 200, epoch: 4 | loss: 0.8038389
	speed: 0.0096s/iter; left time: 9.8130s
Updating learning rate to 8.843522265e-05
Validation loss decreased (0.5392 --> 0.5383).  Saving model state dict ...
Epoch: 4 cost time: 2.816854476928711
Epoch: 4, Steps: 245 | Train Loss: 0.6887246 Vali Loss: 0.5382736 Best vali loss: 0.5382736
	iters: 100, epoch: 5 | loss: 0.7167093
	speed: 0.0201s/iter; left time: 17.7173s
	iters: 200, epoch: 5 | loss: 0.7044415
	speed: 0.0099s/iter; left time: 7.7087s
Updating learning rate to 5.4592528104327076e-05
Epoch: 5 cost time: 2.5694286823272705
Epoch: 5, Steps: 245 | Train Loss: 0.7105754 Vali Loss: 0.5649683 Best vali loss: 0.5382736
	iters: 100, epoch: 6 | loss: 0.8219771
	speed: 0.0199s/iter; left time: 12.6378s
	iters: 200, epoch: 6 | loss: 0.6289107
	speed: 0.0083s/iter; left time: 4.4320s
Updating learning rate to 2.5902077018442846e-05
Epoch: 6 cost time: 2.3718912601470947
Epoch: 6, Steps: 245 | Train Loss: 0.7254439 Vali Loss: 0.5629385 Best vali loss: 0.5382736
	iters: 100, epoch: 7 | loss: 0.7291887
	speed: 0.0193s/iter; left time: 7.5551s
	iters: 200, epoch: 7 | loss: 0.7542090
	speed: 0.0106s/iter; left time: 3.0833s
Updating learning rate to 6.731730490586444e-06
Epoch: 7 cost time: 2.5749475955963135
Epoch: 7, Steps: 245 | Train Loss: 0.7416989 Vali Loss: 0.5746579 Best vali loss: 0.5382736
	iters: 100, epoch: 8 | loss: 0.6811817
	speed: 0.0189s/iter; left time: 2.7575s
	iters: 200, epoch: 8 | loss: 0.6854938
	speed: 0.0106s/iter; left time: 0.4890s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.620433807373047
Epoch: 8, Steps: 245 | Train Loss: 0.6833377 Vali Loss: 0.5863989 Best vali loss: 0.5382736

best validation loss 0.5382736310921351

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0030808718104, 'e_layers': 2, 'learning_rate': 0.004541253833, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0505172
	speed: 0.0253s/iter; left time: 22.4298s
Updating learning rate to 0.004368412650623565
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 2.60447359085083
Epoch: 1, Steps: 123 | Train Loss: 1.0505172 Vali Loss: 0.6099292 Best vali loss: 0.6099292
	iters: 100, epoch: 2 | loss: 0.7525940
	speed: 0.0262s/iter; left time: 19.9445s
Updating learning rate to 0.0038762026067018507
Validation loss decreased (0.6099 --> 0.6032).  Saving model state dict ...
Epoch: 2 cost time: 1.823136568069458
Epoch: 2, Steps: 123 | Train Loss: 0.7525940 Vali Loss: 0.6032436 Best vali loss: 0.6032436
	iters: 100, epoch: 3 | loss: 0.9453494
	speed: 0.0149s/iter; left time: 9.5451s
Updating learning rate to 0.00313955821852678
Epoch: 3 cost time: 1.4937422275543213
Epoch: 3, Steps: 123 | Train Loss: 0.9453494 Vali Loss: 0.6733923 Best vali loss: 0.6032436
	iters: 100, epoch: 4 | loss: 0.8431402
	speed: 0.0299s/iter; left time: 15.4406s
Updating learning rate to 0.0022706269165
Epoch: 4 cost time: 2.465207576751709
Epoch: 4, Steps: 123 | Train Loss: 0.8431402 Vali Loss: 0.6305601 Best vali loss: 0.6032436
	iters: 100, epoch: 5 | loss: 0.6872312
	speed: 0.0335s/iter; left time: 13.1635s
Updating learning rate to 0.00140169561447322
Epoch: 5 cost time: 2.468482255935669
Epoch: 5, Steps: 123 | Train Loss: 0.6872312 Vali Loss: 0.6716669 Best vali loss: 0.6032436
	iters: 100, epoch: 6 | loss: 0.6987065
	speed: 0.0326s/iter; left time: 8.8038s
Updating learning rate to 0.0006650512262981495
Epoch: 6 cost time: 2.2693841457366943
Epoch: 6, Steps: 123 | Train Loss: 0.6987065 Vali Loss: 0.6558039 Best vali loss: 0.6032436
	iters: 100, epoch: 7 | loss: 0.7877151
	speed: 0.0198s/iter; left time: 2.9116s
Updating learning rate to 0.00017284118237643548
Epoch: 7 cost time: 2.0176918506622314
Epoch: 7, Steps: 123 | Train Loss: 0.7877151 Vali Loss: 0.6829096 Best vali loss: 0.6032436
	iters: 100, epoch: 8 | loss: 0.6226692
	speed: 0.0319s/iter; left time: 0.7649s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.51250958442688
Epoch: 8, Steps: 123 | Train Loss: 0.6226692 Vali Loss: 0.6813849 Best vali loss: 0.6032436

best validation loss 0.6032435742035777

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3083493
	speed: 0.0224s/iter; left time: 85.6051s
	iters: 200, epoch: 1 | loss: 0.9386579
	speed: 0.0150s/iter; left time: 55.7988s
	iters: 300, epoch: 1 | loss: 1.2741475
	speed: 0.0164s/iter; left time: 59.4834s
	iters: 400, epoch: 1 | loss: 0.9382687
	speed: 0.0167s/iter; left time: 58.6322s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 8.246269702911377
Epoch: 1, Steps: 490 | Train Loss: 1.1148558 Vali Loss: 0.6069639 Best vali loss: 0.6069639
	iters: 100, epoch: 2 | loss: 0.7811506
	speed: 0.0587s/iter; left time: 195.4076s
	iters: 200, epoch: 2 | loss: 0.5249420
	speed: 0.0175s/iter; left time: 56.6203s
	iters: 300, epoch: 2 | loss: 0.5953794
	speed: 0.0173s/iter; left time: 54.1808s
	iters: 400, epoch: 2 | loss: 0.8552725
	speed: 0.0163s/iter; left time: 49.3407s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 8.439502954483032
Epoch: 2, Steps: 490 | Train Loss: 0.6891861 Vali Loss: 0.6137047 Best vali loss: 0.6069639
	iters: 100, epoch: 3 | loss: 0.7396813
	speed: 0.0333s/iter; left time: 94.6200s
	iters: 200, epoch: 3 | loss: 1.6044713
	speed: 0.0097s/iter; left time: 26.5228s
	iters: 300, epoch: 3 | loss: 0.7234709
	speed: 0.0101s/iter; left time: 26.7422s
	iters: 400, epoch: 3 | loss: 0.9004278
	speed: 0.0109s/iter; left time: 27.6030s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 4.980988264083862
Epoch: 3, Steps: 490 | Train Loss: 0.9920128 Vali Loss: 0.6121731 Best vali loss: 0.6069639
	iters: 100, epoch: 4 | loss: 0.9348945
	speed: 0.0285s/iter; left time: 67.1105s
	iters: 200, epoch: 4 | loss: 1.1566141
	speed: 0.0104s/iter; left time: 23.3583s
	iters: 300, epoch: 4 | loss: 0.7829069
	speed: 0.0104s/iter; left time: 22.2667s
	iters: 400, epoch: 4 | loss: 0.5165976
	speed: 0.0105s/iter; left time: 21.6232s
Updating learning rate to 7.69341037125e-05
Epoch: 4 cost time: 5.1815245151519775
Epoch: 4, Steps: 490 | Train Loss: 0.8477533 Vali Loss: 0.6124356 Best vali loss: 0.6069639
	iters: 100, epoch: 5 | loss: 1.4185590
	speed: 0.0296s/iter; left time: 55.1266s
	iters: 200, epoch: 5 | loss: 0.4351969
	speed: 0.0105s/iter; left time: 18.5386s
	iters: 300, epoch: 5 | loss: 0.9235888
	speed: 0.0100s/iter; left time: 16.6026s
	iters: 400, epoch: 5 | loss: 1.3939936
	speed: 0.0099s/iter; left time: 15.4150s
Updating learning rate to 3.846705185625e-05
Epoch: 5 cost time: 5.097354888916016
Epoch: 5, Steps: 490 | Train Loss: 1.0428346 Vali Loss: 0.6178094 Best vali loss: 0.6069639
	iters: 100, epoch: 6 | loss: 0.4266329
	speed: 0.0209s/iter; left time: 28.6937s
	iters: 200, epoch: 6 | loss: 0.7621500
	speed: 0.0063s/iter; left time: 8.0374s
	iters: 300, epoch: 6 | loss: 0.5801201
	speed: 0.0070s/iter; left time: 8.1915s
	iters: 400, epoch: 6 | loss: 0.7441651
	speed: 0.0086s/iter; left time: 9.2401s
Updating learning rate to 1.9233525928125e-05
Epoch: 6 cost time: 3.63394832611084
Epoch: 6, Steps: 490 | Train Loss: 0.6282670 Vali Loss: 0.6155588 Best vali loss: 0.6069639
	iters: 100, epoch: 7 | loss: 1.0631993
	speed: 0.0251s/iter; left time: 22.1488s
	iters: 200, epoch: 7 | loss: 0.9241002
	speed: 0.0086s/iter; left time: 6.7125s
	iters: 300, epoch: 7 | loss: 0.9015205
	speed: 0.0096s/iter; left time: 6.5369s
	iters: 400, epoch: 7 | loss: 0.6288211
	speed: 0.0084s/iter; left time: 4.8610s
Updating learning rate to 9.6167629640625e-06
Epoch: 7 cost time: 4.305123329162598
Epoch: 7, Steps: 490 | Train Loss: 0.8794103 Vali Loss: 0.6145250 Best vali loss: 0.6069639
	iters: 100, epoch: 8 | loss: 1.3969067
	speed: 0.0238s/iter; left time: 9.3046s
	iters: 200, epoch: 8 | loss: 0.5845680
	speed: 0.0070s/iter; left time: 2.0490s
	iters: 300, epoch: 8 | loss: 0.7029114
	speed: 0.0100s/iter; left time: 1.9100s
	iters: 400, epoch: 8 | loss: 0.8579170
	speed: 0.0097s/iter; left time: 0.8794s
Updating learning rate to 4.80838148203125e-06
Epoch: 8 cost time: 4.346452474594116
Epoch: 8, Steps: 490 | Train Loss: 0.8855758 Vali Loss: 0.6155517 Best vali loss: 0.6069639

best validation loss 0.6069639357412816

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013187747098, 'e_layers': 3, 'learning_rate': 0.0024705248404, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5751363
	speed: 0.0169s/iter; left time: 130.8923s
	iters: 200, epoch: 1 | loss: 1.3736312
	speed: 0.0089s/iter; left time: 67.5652s
	iters: 300, epoch: 1 | loss: 0.8772637
	speed: 0.0092s/iter; left time: 69.4274s
	iters: 400, epoch: 1 | loss: 2.1622071
	speed: 0.0093s/iter; left time: 68.7926s
	iters: 500, epoch: 1 | loss: 0.5962084
	speed: 0.0094s/iter; left time: 68.7818s
	iters: 600, epoch: 1 | loss: 0.3056312
	speed: 0.0096s/iter; left time: 69.5971s
	iters: 700, epoch: 1 | loss: 0.7879902
	speed: 0.0102s/iter; left time: 72.7362s
	iters: 800, epoch: 1 | loss: 0.6059381
	speed: 0.0090s/iter; left time: 63.3851s
	iters: 900, epoch: 1 | loss: 0.6521591
	speed: 0.0093s/iter; left time: 64.3439s
Updating learning rate to 0.0024705248404
Validation loss decreased (inf --> 0.6324).  Saving model state dict ...
Epoch: 1 cost time: 9.600330591201782
Epoch: 1, Steps: 979 | Train Loss: 0.8817961 Vali Loss: 0.6323746 Best vali loss: 0.6323746
	iters: 100, epoch: 2 | loss: 0.9593529
	speed: 0.0292s/iter; left time: 197.2815s
	iters: 200, epoch: 2 | loss: 0.5550696
	speed: 0.0089s/iter; left time: 59.2563s
	iters: 300, epoch: 2 | loss: 1.3510709
	speed: 0.0060s/iter; left time: 39.1388s
	iters: 400, epoch: 2 | loss: 0.6342456
	speed: 0.0051s/iter; left time: 33.1550s
	iters: 500, epoch: 2 | loss: 2.0507567
	speed: 0.0129s/iter; left time: 82.1460s
	iters: 600, epoch: 2 | loss: 0.4480879
	speed: 0.0123s/iter; left time: 76.6136s
	iters: 700, epoch: 2 | loss: 0.7863149
	speed: 0.0135s/iter; left time: 83.0568s
	iters: 800, epoch: 2 | loss: 0.3317961
	speed: 0.0117s/iter; left time: 71.1139s
	iters: 900, epoch: 2 | loss: 0.2619694
	speed: 0.0120s/iter; left time: 71.4451s
Updating learning rate to 0.0012352624202
Epoch: 2 cost time: 10.072059154510498
Epoch: 2, Steps: 979 | Train Loss: 0.8198516 Vali Loss: 0.6403639 Best vali loss: 0.6323746
	iters: 100, epoch: 3 | loss: 0.4994168
	speed: 0.0586s/iter; left time: 338.2402s
	iters: 200, epoch: 3 | loss: 0.3382098
	speed: 0.0096s/iter; left time: 54.2670s
	iters: 300, epoch: 3 | loss: 0.7948406
	speed: 0.0125s/iter; left time: 69.4091s
	iters: 400, epoch: 3 | loss: 0.4559043
	speed: 0.0091s/iter; left time: 49.6938s
	iters: 500, epoch: 3 | loss: 0.7009697
	speed: 0.0102s/iter; left time: 54.6604s
	iters: 600, epoch: 3 | loss: 1.1022915
	speed: 0.0120s/iter; left time: 63.3665s
	iters: 700, epoch: 3 | loss: 0.3433073
	speed: 0.0128s/iter; left time: 66.4953s
	iters: 800, epoch: 3 | loss: 0.9424646
	speed: 0.0127s/iter; left time: 64.5148s
	iters: 900, epoch: 3 | loss: 0.6303127
	speed: 0.0120s/iter; left time: 59.9252s
Updating learning rate to 0.0006176312101
Validation loss decreased (0.6324 --> 0.6036).  Saving model state dict ...
Epoch: 3 cost time: 11.302875757217407
Epoch: 3, Steps: 979 | Train Loss: 0.6453019 Vali Loss: 0.6036007 Best vali loss: 0.6036007

best validation loss 0.6036006776561675

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002683587556, 'e_layers': 4, 'learning_rate': 0.0008020893783, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008020893783
Validation loss decreased (inf --> 0.6188).  Saving model state dict ...
Epoch: 1 cost time: 2.1021294593811035
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6187761 Best vali loss: 0.6187761
Updating learning rate to 0.00040104468915
Epoch: 2 cost time: 1.6994731426239014
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6236145 Best vali loss: 0.6187761
Updating learning rate to 0.000200522344575
Epoch: 3 cost time: 1.84080171585083
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6220509 Best vali loss: 0.6187761

best validation loss 0.6187761084231332

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0099152799004, 'e_layers': 4, 'learning_rate': 0.0012333067614, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9779400
	speed: 0.0223s/iter; left time: 85.0190s
	iters: 200, epoch: 1 | loss: 0.4403276
	speed: 0.0175s/iter; left time: 64.9397s
	iters: 300, epoch: 1 | loss: 0.9130402
	speed: 0.0169s/iter; left time: 61.2894s
	iters: 400, epoch: 1 | loss: 1.2439166
	speed: 0.0198s/iter; left time: 69.5648s
Updating learning rate to 0.0012333067614
Validation loss decreased (inf --> 0.6108).  Saving model state dict ...
Epoch: 1 cost time: 8.110342025756836
Epoch: 1, Steps: 490 | Train Loss: 0.8938061 Vali Loss: 0.6107853 Best vali loss: 0.6107853
	iters: 100, epoch: 2 | loss: 0.5027436
	speed: 0.0243s/iter; left time: 81.0670s
	iters: 200, epoch: 2 | loss: 0.8523990
	speed: 0.0107s/iter; left time: 34.4371s
	iters: 300, epoch: 2 | loss: 0.3933935
	speed: 0.0116s/iter; left time: 36.3134s
	iters: 400, epoch: 2 | loss: 1.2306756
	speed: 0.0122s/iter; left time: 37.0132s
Updating learning rate to 0.0006166533807
Epoch: 2 cost time: 5.473717927932739
Epoch: 2, Steps: 490 | Train Loss: 0.7448029 Vali Loss: 0.6278574 Best vali loss: 0.6107853
	iters: 100, epoch: 3 | loss: 1.0827788
	speed: 0.0317s/iter; left time: 90.0876s
	iters: 200, epoch: 3 | loss: 0.7822719
	speed: 0.0115s/iter; left time: 31.6244s
	iters: 300, epoch: 3 | loss: 0.4681792
	speed: 0.0126s/iter; left time: 33.3127s
	iters: 400, epoch: 3 | loss: 1.1144530
	speed: 0.0116s/iter; left time: 29.5403s
Updating learning rate to 0.00030832669035
Epoch: 3 cost time: 5.878402948379517
Epoch: 3, Steps: 490 | Train Loss: 0.8619207 Vali Loss: 0.6185610 Best vali loss: 0.6107853

best validation loss 0.6107852613964548

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013187747098, 'e_layers': 3, 'learning_rate': 0.0024705248404, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5666293
	speed: 0.0163s/iter; left time: 77.9539s
	iters: 200, epoch: 4 | loss: 1.3593923
	speed: 0.0095s/iter; left time: 44.8296s
	iters: 300, epoch: 4 | loss: 0.8702214
	speed: 0.0098s/iter; left time: 44.8131s
	iters: 400, epoch: 4 | loss: 2.0309978
	speed: 0.0097s/iter; left time: 43.5072s
	iters: 500, epoch: 4 | loss: 0.5887449
	speed: 0.0108s/iter; left time: 47.3002s
	iters: 600, epoch: 4 | loss: 0.2752120
	speed: 0.0098s/iter; left time: 42.0129s
	iters: 700, epoch: 4 | loss: 0.7104880
	speed: 0.0097s/iter; left time: 40.7815s
	iters: 800, epoch: 4 | loss: 0.5328602
	speed: 0.0097s/iter; left time: 39.7378s
	iters: 900, epoch: 4 | loss: 0.6280531
	speed: 0.0099s/iter; left time: 39.5249s
Updating learning rate to 0.00030881560505
Epoch: 4 cost time: 9.852724552154541
Epoch: 4, Steps: 979 | Train Loss: 0.8402888 Vali Loss: 0.6049109 Best vali loss: 0.6036007
	iters: 100, epoch: 5 | loss: 0.8294351
	speed: 0.0367s/iter; left time: 140.2333s
	iters: 200, epoch: 5 | loss: 0.5178154
	speed: 0.0084s/iter; left time: 31.0942s
	iters: 300, epoch: 5 | loss: 1.2642004
	speed: 0.0082s/iter; left time: 29.5847s
	iters: 400, epoch: 5 | loss: 0.5297472
	speed: 0.0083s/iter; left time: 29.1424s
	iters: 500, epoch: 5 | loss: 1.7903212
	speed: 0.0078s/iter; left time: 26.6874s
	iters: 600, epoch: 5 | loss: 0.3752048
	speed: 0.0091s/iter; left time: 30.2646s
	iters: 700, epoch: 5 | loss: 0.7656392
	speed: 0.0082s/iter; left time: 26.3870s
	iters: 800, epoch: 5 | loss: 0.2930171
	speed: 0.0082s/iter; left time: 25.6693s
	iters: 900, epoch: 5 | loss: 0.2617290
	speed: 0.0080s/iter; left time: 24.1989s
Updating learning rate to 0.000154407802525
Epoch: 5 cost time: 8.278470516204834
Epoch: 5, Steps: 979 | Train Loss: 0.7363455 Vali Loss: 0.6070090 Best vali loss: 0.6036007
	iters: 100, epoch: 6 | loss: 0.3951563
	speed: 0.0301s/iter; left time: 85.4745s
	iters: 200, epoch: 6 | loss: 0.3323159
	speed: 0.0080s/iter; left time: 21.9990s
	iters: 300, epoch: 6 | loss: 0.7818958
	speed: 0.0081s/iter; left time: 21.4936s
	iters: 400, epoch: 6 | loss: 0.4256961
	speed: 0.0081s/iter; left time: 20.6549s
	iters: 500, epoch: 6 | loss: 0.6543826
	speed: 0.0079s/iter; left time: 19.2139s
	iters: 600, epoch: 6 | loss: 1.0987589
	speed: 0.0081s/iter; left time: 18.8477s
	iters: 700, epoch: 6 | loss: 0.3439220
	speed: 0.0079s/iter; left time: 17.5970s
	iters: 800, epoch: 6 | loss: 0.8364094
	speed: 0.0112s/iter; left time: 23.9120s
	iters: 900, epoch: 6 | loss: 0.5506989
	speed: 0.0110s/iter; left time: 22.3527s
Updating learning rate to 7.72039012625e-05
Epoch: 6 cost time: 8.812061548233032
Epoch: 6, Steps: 979 | Train Loss: 0.6021373 Vali Loss: 0.6095929 Best vali loss: 0.6036007
	iters: 100, epoch: 7 | loss: 0.5213861
	speed: 0.0336s/iter; left time: 62.4657s
	iters: 200, epoch: 7 | loss: 0.4559214
	speed: 0.0085s/iter; left time: 14.9098s
	iters: 300, epoch: 7 | loss: 0.7664300
	speed: 0.0086s/iter; left time: 14.2088s
	iters: 400, epoch: 7 | loss: 0.6498789
	speed: 0.0083s/iter; left time: 12.8977s
	iters: 500, epoch: 7 | loss: 0.4474524
	speed: 0.0086s/iter; left time: 12.4989s
	iters: 600, epoch: 7 | loss: 0.3979555
	speed: 0.0083s/iter; left time: 11.2826s
	iters: 700, epoch: 7 | loss: 0.3162234
	speed: 0.0097s/iter; left time: 12.1617s
	iters: 800, epoch: 7 | loss: 0.6843173
	speed: 0.0086s/iter; left time: 10.0001s
	iters: 900, epoch: 7 | loss: 0.5664675
	speed: 0.0082s/iter; left time: 8.6609s
Updating learning rate to 3.860195063125e-05
Epoch: 7 cost time: 8.523869276046753
Epoch: 7, Steps: 979 | Train Loss: 0.5340036 Vali Loss: 0.6219538 Best vali loss: 0.6036007
	iters: 100, epoch: 8 | loss: 1.2343940
	speed: 0.0281s/iter; left time: 24.7394s
	iters: 200, epoch: 8 | loss: 0.3955508
	speed: 0.0087s/iter; left time: 6.7614s
	iters: 300, epoch: 8 | loss: 1.0165695
	speed: 0.0054s/iter; left time: 3.7008s
	iters: 400, epoch: 8 | loss: 0.7879172
	speed: 0.0067s/iter; left time: 3.8651s
	iters: 500, epoch: 8 | loss: 1.1629580
	speed: 0.0075s/iter; left time: 3.6145s
	iters: 600, epoch: 8 | loss: 0.3996878
	speed: 0.0076s/iter; left time: 2.8869s
	iters: 700, epoch: 8 | loss: 0.9401222
	speed: 0.0077s/iter; left time: 2.1425s
	iters: 800, epoch: 8 | loss: 0.5846729
	speed: 0.0074s/iter; left time: 1.3350s
	iters: 900, epoch: 8 | loss: 0.6864334
	speed: 0.0067s/iter; left time: 0.5385s
Updating learning rate to 1.9300975315625e-05
Epoch: 8 cost time: 7.153109312057495
Epoch: 8, Steps: 979 | Train Loss: 0.8009229 Vali Loss: 0.6252282 Best vali loss: 0.6036007

best validation loss 0.6036006776561675

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0012158342535, 'e_layers': 4, 'learning_rate': 0.0001583628596, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6173239
	speed: 0.0167s/iter; left time: 128.8374s
	iters: 200, epoch: 1 | loss: 0.9064729
	speed: 0.0096s/iter; left time: 73.2585s
	iters: 300, epoch: 1 | loss: 0.5690529
	speed: 0.0093s/iter; left time: 69.7931s
	iters: 400, epoch: 1 | loss: 0.8858222
	speed: 0.0096s/iter; left time: 71.4140s
	iters: 500, epoch: 1 | loss: 0.4036836
	speed: 0.0095s/iter; left time: 69.8766s
	iters: 600, epoch: 1 | loss: 0.9373807
	speed: 0.0092s/iter; left time: 66.7111s
	iters: 700, epoch: 1 | loss: 0.4605613
	speed: 0.0088s/iter; left time: 63.0902s
	iters: 800, epoch: 1 | loss: 0.4850352
	speed: 0.0094s/iter; left time: 66.1393s
	iters: 900, epoch: 1 | loss: 1.3414350
	speed: 0.0098s/iter; left time: 67.9149s
Updating learning rate to 0.00015233553214719927
Validation loss decreased (inf --> 0.6193).  Saving model state dict ...
Epoch: 1 cost time: 9.63575553894043
Epoch: 1, Steps: 979 | Train Loss: 0.7340853 Vali Loss: 0.6192677 Best vali loss: 0.6192677
	iters: 100, epoch: 2 | loss: 1.0518632
	speed: 0.0291s/iter; left time: 196.4538s
	iters: 200, epoch: 2 | loss: 0.6547586
	speed: 0.0094s/iter; left time: 62.5639s
	iters: 300, epoch: 2 | loss: 0.9675857
	speed: 0.0090s/iter; left time: 59.2537s
	iters: 400, epoch: 2 | loss: 0.9148569
	speed: 0.0091s/iter; left time: 58.7242s
	iters: 500, epoch: 2 | loss: 1.1643642
	speed: 0.0095s/iter; left time: 60.5315s
	iters: 600, epoch: 2 | loss: 0.4401191
	speed: 0.0097s/iter; left time: 60.4416s
	iters: 700, epoch: 2 | loss: 0.7765241
	speed: 0.0096s/iter; left time: 59.3855s
	iters: 800, epoch: 2 | loss: 1.0369827
	speed: 0.0097s/iter; left time: 58.6697s
	iters: 900, epoch: 2 | loss: 0.7885426
	speed: 0.0086s/iter; left time: 51.2267s
Updating learning rate to 0.0001351711557556266
Validation loss decreased (0.6193 --> 0.5806).  Saving model state dict ...
Epoch: 2 cost time: 9.157942056655884
Epoch: 2, Steps: 979 | Train Loss: 0.8661775 Vali Loss: 0.5806083 Best vali loss: 0.5806083
	iters: 100, epoch: 3 | loss: 0.6487158
	speed: 0.0288s/iter; left time: 166.5931s
	iters: 200, epoch: 3 | loss: 1.4059237
	speed: 0.0097s/iter; left time: 55.0848s
	iters: 300, epoch: 3 | loss: 0.8844683
	speed: 0.0099s/iter; left time: 55.1519s
	iters: 400, epoch: 3 | loss: 1.2756515
	speed: 0.0093s/iter; left time: 51.0671s
	iters: 500, epoch: 3 | loss: 0.9864598
	speed: 0.0083s/iter; left time: 44.4684s
	iters: 600, epoch: 3 | loss: 0.7151528
	speed: 0.0105s/iter; left time: 55.2779s
	iters: 700, epoch: 3 | loss: 0.2494931
	speed: 0.0174s/iter; left time: 89.9045s
	iters: 800, epoch: 3 | loss: 1.1807139
	speed: 0.0167s/iter; left time: 84.6382s
	iters: 900, epoch: 3 | loss: 0.8147073
	speed: 0.0131s/iter; left time: 65.0769s
Updating learning rate to 0.00010948285113543942
Validation loss decreased (0.5806 --> 0.5765).  Saving model state dict ...
Epoch: 3 cost time: 11.225806713104248
Epoch: 3, Steps: 979 | Train Loss: 0.9068096 Vali Loss: 0.5765312 Best vali loss: 0.5765312
	iters: 100, epoch: 4 | loss: 1.2381983
	speed: 0.0299s/iter; left time: 143.3922s
	iters: 200, epoch: 4 | loss: 0.5229662
	speed: 0.0102s/iter; left time: 47.8213s
	iters: 300, epoch: 4 | loss: 1.8197892
	speed: 0.0107s/iter; left time: 49.1884s
	iters: 400, epoch: 4 | loss: 0.3464122
	speed: 0.0107s/iter; left time: 48.2040s
	iters: 500, epoch: 4 | loss: 0.2928058
	speed: 0.0113s/iter; left time: 49.7083s
	iters: 600, epoch: 4 | loss: 0.3575861
	speed: 0.0105s/iter; left time: 45.0480s
	iters: 700, epoch: 4 | loss: 0.5718015
	speed: 0.0102s/iter; left time: 42.7464s
	iters: 800, epoch: 4 | loss: 1.0488677
	speed: 0.0088s/iter; left time: 35.9097s
	iters: 900, epoch: 4 | loss: 1.0655913
	speed: 0.0116s/iter; left time: 46.4100s
Updating learning rate to 7.91814298e-05
Validation loss decreased (0.5765 --> 0.5733).  Saving model state dict ...
Epoch: 4 cost time: 10.380043506622314
Epoch: 4, Steps: 979 | Train Loss: 0.8071132 Vali Loss: 0.5732994 Best vali loss: 0.5732994
	iters: 100, epoch: 5 | loss: 0.7179425
	speed: 0.0648s/iter; left time: 247.2108s
	iters: 200, epoch: 5 | loss: 0.7291920
	speed: 0.0118s/iter; left time: 43.7126s
	iters: 300, epoch: 5 | loss: 0.5684281
	speed: 0.0122s/iter; left time: 44.0587s
	iters: 400, epoch: 5 | loss: 0.6412507
	speed: 0.0131s/iter; left time: 45.9245s
	iters: 500, epoch: 5 | loss: 0.4344238
	speed: 0.0151s/iter; left time: 51.7173s
	iters: 600, epoch: 5 | loss: 0.8633777
	speed: 0.0148s/iter; left time: 49.0024s
	iters: 700, epoch: 5 | loss: 0.8324459
	speed: 0.0157s/iter; left time: 50.6009s
	iters: 800, epoch: 5 | loss: 0.5981238
	speed: 0.0154s/iter; left time: 48.0797s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.006258308639, 'e_layers': 2, 'learning_rate': 0.0015600129814, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0015600129814
Validation loss decreased (inf --> 0.6085).  Saving model state dict ...
Epoch: 1 cost time: 1.6104865074157715
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6084534 Best vali loss: 0.6084534
Updating learning rate to 0.0007800064907
Validation loss decreased (0.6085 --> 0.6007).  Saving model state dict ...
Epoch: 2 cost time: 1.4734807014465332
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6007016 Best vali loss: 0.6007016
Updating learning rate to 0.00039000324535
Epoch: 3 cost time: 0.6075365543365479
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6099342 Best vali loss: 0.6007016
Updating learning rate to 0.000195001622675
Epoch: 4 cost time: 0.6532866954803467
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6084104 Best vali loss: 0.6007016
Updating learning rate to 9.75008113375e-05
Epoch: 5 cost time: 0.7853078842163086
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6034840 Best vali loss: 0.6007016
Updating learning rate to 4.875040566875e-05
Epoch: 6 cost time: 0.6564266681671143
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6041527 Best vali loss: 0.6007016
Updating learning rate to 2.4375202834375e-05
Epoch: 7 cost time: 0.6460912227630615
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6044604 Best vali loss: 0.6007016
Updating learning rate to 1.21876014171875e-05
Epoch: 8 cost time: 0.8100337982177734
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6045354 Best vali loss: 0.6007016

best validation loss 0.6007016442650615

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0100243466185, 'e_layers': 3, 'learning_rate': 0.0003146234386, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00030264879698543076
Validation loss decreased (inf --> 0.6703).  Saving model state dict ...
Epoch: 1 cost time: 0.9797401428222656
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6702709 Best vali loss: 0.6702709
Updating learning rate to 0.00026854790277714465
Validation loss decreased (0.6703 --> 0.6418).  Saving model state dict ...
Epoch: 2 cost time: 0.7003741264343262
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6417751 Best vali loss: 0.6417751
Updating learning rate to 0.00021751230799297756
Validation loss decreased (0.6418 --> 0.6297).  Saving model state dict ...
Epoch: 3 cost time: 0.688396692276001
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6296917 Best vali loss: 0.6296917

best validation loss 0.62969169512991

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0016190983282, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4542705
	speed: 0.0158s/iter; left time: 60.3750s
	iters: 200, epoch: 1 | loss: 0.8792653
	speed: 0.0094s/iter; left time: 34.9095s
	iters: 300, epoch: 1 | loss: 0.6849563
	speed: 0.0090s/iter; left time: 32.6445s
	iters: 400, epoch: 1 | loss: 0.9480975
	speed: 0.0088s/iter; left time: 31.0401s
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.6096).  Saving model state dict ...
Epoch: 1 cost time: 4.773110389709473
Epoch: 1, Steps: 490 | Train Loss: 0.7416474 Vali Loss: 0.6095544 Best vali loss: 0.6095544
	iters: 100, epoch: 2 | loss: 0.7801319
	speed: 0.0218s/iter; left time: 72.4980s
	iters: 200, epoch: 2 | loss: 0.9190478
	speed: 0.0057s/iter; left time: 18.3042s
	iters: 300, epoch: 2 | loss: 0.3886370
	speed: 0.0076s/iter; left time: 23.9040s
	iters: 400, epoch: 2 | loss: 0.9157554
	speed: 0.0077s/iter; left time: 23.3244s
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.6096 --> 0.5455).  Saving model state dict ...
Epoch: 2 cost time: 3.4892377853393555
Epoch: 2, Steps: 490 | Train Loss: 0.7508930 Vali Loss: 0.5454765 Best vali loss: 0.5454765
	iters: 100, epoch: 3 | loss: 0.9531857
	speed: 0.0230s/iter; left time: 65.2763s
	iters: 200, epoch: 3 | loss: 0.6800097
	speed: 0.0076s/iter; left time: 20.9180s
	iters: 300, epoch: 3 | loss: 0.7598118
	speed: 0.0084s/iter; left time: 22.2317s
	iters: 400, epoch: 3 | loss: 0.5728632
	speed: 0.0077s/iter; left time: 19.4759s
Updating learning rate to 8.93085473266162e-05
Epoch: 3 cost time: 3.893068790435791
Epoch: 3, Steps: 490 | Train Loss: 0.7414676 Vali Loss: 0.5616263 Best vali loss: 0.5454765

best validation loss 0.5454764792843033

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.003746361081, 'e_layers': 4, 'learning_rate': 0.0017176414911, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0016522676544597288
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 0.9767894744873047
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6101490 Best vali loss: 0.6101490
Updating learning rate to 0.0014660987185520914
Epoch: 2 cost time: 0.6908731460571289
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6169945 Best vali loss: 0.6101490
Updating learning rate to 0.0011874772162434196
Epoch: 3 cost time: 0.6396968364715576
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6113363 Best vali loss: 0.6101490

best validation loss 0.6101490173114775

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0016190983282, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4254262
	speed: 0.0120s/iter; left time: 28.3251s
	iters: 200, epoch: 4 | loss: 0.8201140
	speed: 0.0059s/iter; left time: 13.2417s
	iters: 300, epoch: 4 | loss: 0.6426926
	speed: 0.0060s/iter; left time: 12.9053s
	iters: 400, epoch: 4 | loss: 0.8885617
	speed: 0.0062s/iter; left time: 12.6946s
Updating learning rate to 6.45907409e-05
Epoch: 4 cost time: 3.2429747581481934
Epoch: 4, Steps: 490 | Train Loss: 0.6941986 Vali Loss: 0.5508790 Best vali loss: 0.5454765
	iters: 100, epoch: 5 | loss: 0.7260007
	speed: 0.0166s/iter; left time: 30.9396s
	iters: 200, epoch: 5 | loss: 0.7784280
	speed: 0.0052s/iter; left time: 9.1448s
	iters: 300, epoch: 5 | loss: 0.3783984
	speed: 0.0055s/iter; left time: 9.1937s
	iters: 400, epoch: 5 | loss: 0.8395888
	speed: 0.0055s/iter; left time: 8.5703s
Updating learning rate to 3.987293447338382e-05
Validation loss decreased (0.5455 --> 0.5397).  Saving model state dict ...
Epoch: 5 cost time: 2.7265100479125977
Epoch: 5, Steps: 490 | Train Loss: 0.6806040 Vali Loss: 0.5397099 Best vali loss: 0.5397099
	iters: 100, epoch: 6 | loss: 0.7462362
	speed: 0.0165s/iter; left time: 22.5964s
	iters: 200, epoch: 6 | loss: 0.6383380
	speed: 0.0059s/iter; left time: 7.5018s
	iters: 300, epoch: 6 | loss: 0.7158771
	speed: 0.0057s/iter; left time: 6.6575s
	iters: 400, epoch: 6 | loss: 0.5206378
	speed: 0.0055s/iter; left time: 5.9343s
Updating learning rate to 1.891819000774672e-05
Epoch: 6 cost time: 2.794062852859497
Epoch: 6, Steps: 490 | Train Loss: 0.6552723 Vali Loss: 0.5537364 Best vali loss: 0.5397099
	iters: 100, epoch: 7 | loss: 0.4562885
	speed: 0.0181s/iter; left time: 15.9176s
	iters: 200, epoch: 7 | loss: 0.6412148
	speed: 0.0083s/iter; left time: 6.4751s
	iters: 300, epoch: 7 | loss: 0.3189920
	speed: 0.0084s/iter; left time: 5.7004s
	iters: 400, epoch: 7 | loss: 1.0680009
	speed: 0.0079s/iter; left time: 4.5913s
Updating learning rate to 4.916677392750353e-06
Epoch: 7 cost time: 4.0654144287109375
Epoch: 7, Steps: 490 | Train Loss: 0.6211240 Vali Loss: 0.5480672 Best vali loss: 0.5397099
	iters: 100, epoch: 8 | loss: 0.4609463
	speed: 0.0190s/iter; left time: 7.4394s
	iters: 200, epoch: 8 | loss: 0.4658425
	speed: 0.0051s/iter; left time: 1.4796s
	iters: 300, epoch: 8 | loss: 0.9389939
	speed: 0.0056s/iter; left time: 1.0665s
	iters: 400, epoch: 8 | loss: 0.8140719
	speed: 0.0065s/iter; left time: 0.5887s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.8133177757263184
Epoch: 8, Steps: 490 | Train Loss: 0.6699637 Vali Loss: 0.5471105 Best vali loss: 0.5397099

best validation loss 0.5397099360844317

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0031811048754, 'e_layers': 2, 'learning_rate': 8.85696577e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9254255
	speed: 0.0116s/iter; left time: 89.7459s
	iters: 200, epoch: 1 | loss: 0.8738506
	speed: 0.0059s/iter; left time: 44.9683s
	iters: 300, epoch: 1 | loss: 1.6689488
	speed: 0.0058s/iter; left time: 43.9027s
	iters: 400, epoch: 1 | loss: 0.7852917
	speed: 0.0057s/iter; left time: 42.4465s
	iters: 500, epoch: 1 | loss: 0.4926561
	speed: 0.0059s/iter; left time: 42.9636s
	iters: 600, epoch: 1 | loss: 1.2024044
	speed: 0.0060s/iter; left time: 43.3353s
	iters: 700, epoch: 1 | loss: 0.2785119
	speed: 0.0059s/iter; left time: 42.2569s
	iters: 800, epoch: 1 | loss: 1.0485865
	speed: 0.0057s/iter; left time: 40.1608s
	iters: 900, epoch: 1 | loss: 1.0725801
	speed: 0.0059s/iter; left time: 40.7943s
Updating learning rate to 8.519867582528033e-05
Validation loss decreased (inf --> 0.6049).  Saving model state dict ...
Epoch: 1 cost time: 6.0523295402526855
Epoch: 1, Steps: 979 | Train Loss: 0.9275839 Vali Loss: 0.6049196 Best vali loss: 0.6049196
	iters: 100, epoch: 2 | loss: 0.8433549
	speed: 0.0210s/iter; left time: 141.7953s
	iters: 200, epoch: 2 | loss: 0.6763777
	speed: 0.0053s/iter; left time: 35.4109s
	iters: 300, epoch: 2 | loss: 1.1648422
	speed: 0.0052s/iter; left time: 34.1663s
	iters: 400, epoch: 2 | loss: 1.3719759
	speed: 0.0056s/iter; left time: 36.1833s
	iters: 500, epoch: 2 | loss: 0.8932992
	speed: 0.0060s/iter; left time: 38.3204s
	iters: 600, epoch: 2 | loss: 1.2280328
	speed: 0.0054s/iter; left time: 33.8370s
	iters: 700, epoch: 2 | loss: 1.0966437
	speed: 0.0052s/iter; left time: 32.2450s
	iters: 800, epoch: 2 | loss: 0.6508482
	speed: 0.0054s/iter; left time: 32.7615s
	iters: 900, epoch: 2 | loss: 0.7357929
	speed: 0.0055s/iter; left time: 32.6072s
Updating learning rate to 7.559893163352066e-05
Epoch: 2 cost time: 5.387005567550659
Epoch: 2, Steps: 979 | Train Loss: 0.9623520 Vali Loss: 0.6255044 Best vali loss: 0.6049196
	iters: 100, epoch: 3 | loss: 0.9462780
	speed: 0.0204s/iter; left time: 117.5293s
	iters: 200, epoch: 3 | loss: 0.3267084
	speed: 0.0061s/iter; left time: 34.7173s
	iters: 300, epoch: 3 | loss: 0.5925431
	speed: 0.0061s/iter; left time: 33.8234s
	iters: 400, epoch: 3 | loss: 0.7966005
	speed: 0.0062s/iter; left time: 33.9205s
	iters: 500, epoch: 3 | loss: 0.6919537
	speed: 0.0068s/iter; left time: 36.6896s
	iters: 600, epoch: 3 | loss: 0.5959752
	speed: 0.0061s/iter; left time: 32.0584s
	iters: 700, epoch: 3 | loss: 0.2702833
	speed: 0.0057s/iter; left time: 29.4373s
	iters: 800, epoch: 3 | loss: 0.2745838
	speed: 0.0052s/iter; left time: 26.5659s
	iters: 900, epoch: 3 | loss: 0.6810669
	speed: 0.0083s/iter; left time: 41.1341s
Updating learning rate to 6.123189915601855e-05
Validation loss decreased (0.6049 --> 0.5579).  Saving model state dict ...
Epoch: 3 cost time: 6.3733484745025635
Epoch: 3, Steps: 979 | Train Loss: 0.5751103 Vali Loss: 0.5579182 Best vali loss: 0.5579182
	iters: 100, epoch: 4 | loss: 0.3202810
	speed: 0.0329s/iter; left time: 157.6303s
	iters: 200, epoch: 4 | loss: 0.3436999
	speed: 0.0100s/iter; left time: 46.7656s
	iters: 300, epoch: 4 | loss: 0.7465953
	speed: 0.0099s/iter; left time: 45.6357s
	iters: 400, epoch: 4 | loss: 0.2938167
	speed: 0.0099s/iter; left time: 44.5179s
	iters: 500, epoch: 4 | loss: 0.3338745
	speed: 0.0101s/iter; left time: 44.2976s
	iters: 600, epoch: 4 | loss: 0.7625844
	speed: 0.0075s/iter; left time: 32.3018s
	iters: 700, epoch: 4 | loss: 0.8673354
	speed: 0.0050s/iter; left time: 21.0432s
	iters: 800, epoch: 4 | loss: 1.3486311
	speed: 0.0058s/iter; left time: 23.7029s
	iters: 900, epoch: 4 | loss: 1.1971554
	speed: 0.0063s/iter; left time: 24.9906s
Updating learning rate to 4.428482885e-05
Epoch: 4 cost time: 7.9955103397369385
Epoch: 4, Steps: 979 | Train Loss: 0.6904415 Vali Loss: 0.5659651 Best vali loss: 0.5579182
	iters: 100, epoch: 5 | loss: 0.8067688
	speed: 0.0214s/iter; left time: 81.5592s
	iters: 200, epoch: 5 | loss: 0.6422586
	speed: 0.0060s/iter; left time: 22.3479s
	iters: 300, epoch: 5 | loss: 0.4575840
	speed: 0.0061s/iter; left time: 21.9236s
	iters: 400, epoch: 5 | loss: 0.5281846
	speed: 0.0060s/iter; left time: 21.0249s
	iters: 500, epoch: 5 | loss: 0.7944102
	speed: 0.0063s/iter; left time: 21.5870s
	iters: 600, epoch: 5 | loss: 0.9195378
	speed: 0.0061s/iter; left time: 20.1506s
	iters: 700, epoch: 5 | loss: 0.7473770
	speed: 0.0055s/iter; left time: 17.6999s
	iters: 800, epoch: 5 | loss: 1.4194086
	speed: 0.0055s/iter; left time: 17.2875s
	iters: 900, epoch: 5 | loss: 0.8085467
	speed: 0.0058s/iter; left time: 17.6421s
Updating learning rate to 2.733775854398145e-05
Epoch: 5 cost time: 5.850671052932739
Epoch: 5, Steps: 979 | Train Loss: 0.7915640 Vali Loss: 0.5699911 Best vali loss: 0.5579182
	iters: 100, epoch: 6 | loss: 0.9860745
	speed: 0.0216s/iter; left time: 61.4028s
	iters: 200, epoch: 6 | loss: 0.9828814
	speed: 0.0063s/iter; left time: 17.3601s
	iters: 300, epoch: 6 | loss: 0.6524968
	speed: 0.0062s/iter; left time: 16.4595s
	iters: 400, epoch: 6 | loss: 0.8587366
	speed: 0.0062s/iter; left time: 15.8211s
	iters: 500, epoch: 6 | loss: 0.3678392
	speed: 0.0062s/iter; left time: 15.1742s
	iters: 600, epoch: 6 | loss: 0.2508314
	speed: 0.0057s/iter; left time: 13.4044s
	iters: 700, epoch: 6 | loss: 0.9528547
	speed: 0.0061s/iter; left time: 13.5413s
	iters: 800, epoch: 6 | loss: 0.8573631
	speed: 0.0060s/iter; left time: 12.8231s
	iters: 900, epoch: 6 | loss: 0.9083759
	speed: 0.0062s/iter; left time: 12.6026s
Updating learning rate to 1.2970726066479346e-05
Epoch: 6 cost time: 5.974170684814453
Epoch: 6, Steps: 979 | Train Loss: 0.7574948 Vali Loss: 0.5762534 Best vali loss: 0.5579182
	iters: 100, epoch: 7 | loss: 1.7296344
	speed: 0.0198s/iter; left time: 36.8347s
	iters: 200, epoch: 7 | loss: 0.4276216
	speed: 0.0061s/iter; left time: 10.6584s
	iters: 300, epoch: 7 | loss: 0.6714047
	speed: 0.0060s/iter; left time: 9.9339s
	iters: 400, epoch: 7 | loss: 1.2008299
	speed: 0.0060s/iter; left time: 9.3420s
	iters: 500, epoch: 7 | loss: 0.7730278
	speed: 0.0062s/iter; left time: 9.0314s
	iters: 600, epoch: 7 | loss: 1.0563015
	speed: 0.0058s/iter; left time: 7.8761s
	iters: 700, epoch: 7 | loss: 0.2887574
	speed: 0.0061s/iter; left time: 7.7396s
	iters: 800, epoch: 7 | loss: 1.5417142
	speed: 0.0060s/iter; left time: 6.9154s
	iters: 900, epoch: 7 | loss: 0.6829062
	speed: 0.0060s/iter; left time: 6.3923s
Updating learning rate to 3.370981874719656e-06
Epoch: 7 cost time: 5.949017763137817
Epoch: 7, Steps: 979 | Train Loss: 0.9302442 Vali Loss: 0.5694673 Best vali loss: 0.5579182
	iters: 100, epoch: 8 | loss: 1.3223276
	speed: 0.0213s/iter; left time: 18.7290s
	iters: 200, epoch: 8 | loss: 1.1910009
	speed: 0.0065s/iter; left time: 5.0753s
	iters: 300, epoch: 8 | loss: 0.8151014
	speed: 0.0063s/iter; left time: 4.2696s
	iters: 400, epoch: 8 | loss: 1.1662617
	speed: 0.0063s/iter; left time: 3.6425s
	iters: 500, epoch: 8 | loss: 0.6522835
	speed: 0.0056s/iter; left time: 2.6656s
	iters: 600, epoch: 8 | loss: 0.3519001
	speed: 0.0049s/iter; left time: 1.8776s
	iters: 700, epoch: 8 | loss: 0.4908226
	speed: 0.0048s/iter; left time: 1.3416s
	iters: 800, epoch: 8 | loss: 0.3562561
	speed: 0.0052s/iter; left time: 0.9380s
	iters: 900, epoch: 8 | loss: 0.8920714
	speed: 0.0053s/iter; left time: 0.4234s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.566304683685303
Epoch: 8, Steps: 979 | Train Loss: 0.8042250 Vali Loss: 0.5734769 Best vali loss: 0.5579182

best validation loss 0.557918165663446

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0024993553018, 'e_layers': 1, 'learning_rate': 0.0003469645636, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1072199
	speed: 0.0157s/iter; left time: 121.1358s
	iters: 200, epoch: 1 | loss: 1.2222881
	speed: 0.0083s/iter; left time: 63.1737s
	iters: 300, epoch: 1 | loss: 0.4547120
	speed: 0.0076s/iter; left time: 57.1851s
	iters: 400, epoch: 1 | loss: 0.3126747
	speed: 0.0075s/iter; left time: 55.8048s
	iters: 500, epoch: 1 | loss: 0.3037303
	speed: 0.0066s/iter; left time: 48.6110s
	iters: 600, epoch: 1 | loss: 0.3428738
	speed: 0.0083s/iter; left time: 59.8214s
	iters: 700, epoch: 1 | loss: 1.0644912
	speed: 0.0079s/iter; left time: 56.0399s
	iters: 800, epoch: 1 | loss: 0.8143256
	speed: 0.0076s/iter; left time: 53.3739s
	iters: 900, epoch: 1 | loss: 0.9634934
	speed: 0.0078s/iter; left time: 53.7578s
Updating learning rate to 0.0003337590112083753
Validation loss decreased (inf --> 0.6105).  Saving model state dict ...
Epoch: 1 cost time: 8.036271572113037
Epoch: 1, Steps: 979 | Train Loss: 0.7317566 Vali Loss: 0.6104816 Best vali loss: 0.6104816
	iters: 100, epoch: 2 | loss: 0.7170810
	speed: 0.0403s/iter; left time: 271.9361s
	iters: 200, epoch: 2 | loss: 0.6210443
	speed: 0.0067s/iter; left time: 44.8307s
	iters: 300, epoch: 2 | loss: 0.4447806
	speed: 0.0052s/iter; left time: 34.0090s
	iters: 400, epoch: 2 | loss: 1.2290803
	speed: 0.0041s/iter; left time: 26.7098s
	iters: 500, epoch: 2 | loss: 0.3976858
	speed: 0.0039s/iter; left time: 25.0594s
	iters: 600, epoch: 2 | loss: 0.4666249
	speed: 0.0042s/iter; left time: 26.4294s
	iters: 700, epoch: 2 | loss: 0.5452647
	speed: 0.0043s/iter; left time: 26.5225s
	iters: 800, epoch: 2 | loss: 0.3820686
	speed: 0.0054s/iter; left time: 32.8667s
	iters: 900, epoch: 2 | loss: 0.6507133
	speed: 0.0070s/iter; left time: 41.4571s
Updating learning rate to 0.00029615277967649556
Validation loss decreased (0.6105 --> 0.6014).  Saving model state dict ...
Epoch: 2 cost time: 5.2300214767456055
Epoch: 2, Steps: 979 | Train Loss: 0.6060382 Vali Loss: 0.6014301 Best vali loss: 0.6014301
	iters: 100, epoch: 3 | loss: 1.2566605
	speed: 0.0253s/iter; left time: 145.9525s
	iters: 200, epoch: 3 | loss: 0.6354092
	speed: 0.0041s/iter; left time: 23.5452s
	iters: 300, epoch: 3 | loss: 1.6378387
	speed: 0.0049s/iter; left time: 27.1244s
	iters: 400, epoch: 3 | loss: 0.5216611
	speed: 0.0068s/iter; left time: 37.4687s
	iters: 500, epoch: 3 | loss: 0.7067617
	speed: 0.0068s/iter; left time: 36.8182s
	iters: 600, epoch: 3 | loss: 1.2235155
	speed: 0.0070s/iter; left time: 37.0997s
	iters: 700, epoch: 3 | loss: 0.4856442
	speed: 0.0074s/iter; left time: 38.1734s
	iters: 800, epoch: 3 | loss: 0.8037555
	speed: 0.0072s/iter; left time: 36.6047s
	iters: 900, epoch: 3 | loss: 0.2691500
	speed: 0.0074s/iter; left time: 36.6238s
Updating learning rate to 0.00023987107685375175
Epoch: 3 cost time: 6.3514084815979
Epoch: 3, Steps: 979 | Train Loss: 0.8378218 Vali Loss: 0.6644172 Best vali loss: 0.6014301
	iters: 100, epoch: 4 | loss: 0.5874483
	speed: 0.0289s/iter; left time: 138.6267s
	iters: 200, epoch: 4 | loss: 0.7383277
	speed: 0.0069s/iter; left time: 32.5225s
	iters: 300, epoch: 4 | loss: 0.6691188
	speed: 0.0072s/iter; left time: 32.9295s
	iters: 400, epoch: 4 | loss: 0.7487171
	speed: 0.0071s/iter; left time: 31.9866s
	iters: 500, epoch: 4 | loss: 0.9604994
	speed: 0.0069s/iter; left time: 30.5379s
	iters: 600, epoch: 4 | loss: 0.8669519
	speed: 0.0080s/iter; left time: 34.2329s
	iters: 700, epoch: 4 | loss: 0.4096554
	speed: 0.0072s/iter; left time: 30.1318s
	iters: 800, epoch: 4 | loss: 0.3546613
	speed: 0.0073s/iter; left time: 30.0833s
	iters: 900, epoch: 4 | loss: 0.4317429
	speed: 0.0062s/iter; left time: 24.6122s
Updating learning rate to 0.0001734822818
Epoch: 4 cost time: 6.987762451171875
Epoch: 4, Steps: 979 | Train Loss: 0.6407914 Vali Loss: 0.6672765 Best vali loss: 0.6014301
	iters: 100, epoch: 5 | loss: 0.2454187
	speed: 0.0475s/iter; left time: 181.4797s
	iters: 200, epoch: 5 | loss: 0.5026290
	speed: 0.0069s/iter; left time: 25.5902s
	iters: 300, epoch: 5 | loss: 0.3858897
	speed: 0.0049s/iter; left time: 17.8057s
	iters: 400, epoch: 5 | loss: 1.2355369
	speed: 0.0057s/iter; left time: 20.1371s
	iters: 500, epoch: 5 | loss: 0.4520363
	speed: 0.0063s/iter; left time: 21.4679s
	iters: 600, epoch: 5 | loss: 0.9512166
	speed: 0.0068s/iter; left time: 22.6476s
	iters: 700, epoch: 5 | loss: 0.5385602
	speed: 0.0066s/iter; left time: 21.2570s
	iters: 800, epoch: 5 | loss: 0.8602763
	speed: 0.0068s/iter; left time: 21.2851s
	iters: 900, epoch: 5 | loss: 0.7248861
	speed: 0.0054s/iter; left time: 16.3780s
Updating learning rate to 0.00010709348674624827
Epoch: 5 cost time: 6.212320804595947
Epoch: 5, Steps: 979 | Train Loss: 0.6551611 Vali Loss: 0.6788329 Best vali loss: 0.6014301
	iters: 100, epoch: 6 | loss: 0.3373499
	speed: 0.0235s/iter; left time: 66.7969s
	iters: 200, epoch: 6 | loss: 0.3483184
	speed: 0.0072s/iter; left time: 19.7822s
	iters: 300, epoch: 6 | loss: 0.3144940
	speed: 0.0068s/iter; left time: 17.9901s
	iters: 400, epoch: 6 | loss: 0.4186087
	speed: 0.0073s/iter; left time: 18.5731s
	iters: 500, epoch: 6 | loss: 0.8878970
	speed: 0.0072s/iter; left time: 17.5792s
	iters: 600, epoch: 6 | loss: 0.9249399
	speed: 0.0081s/iter; left time: 18.9671s
	iters: 700, epoch: 6 | loss: 0.3046405
	speed: 0.0072s/iter; left time: 16.1475s
	iters: 800, epoch: 6 | loss: 0.3803576
	speed: 0.0075s/iter; left time: 15.9290s
	iters: 900, epoch: 6 | loss: 1.0107797
	speed: 0.0075s/iter; left time: 15.2957s
Updating learning rate to 5.081178392350444e-05
Epoch: 6 cost time: 7.265228986740112
Epoch: 6, Steps: 979 | Train Loss: 0.5474873 Vali Loss: 0.6810864 Best vali loss: 0.6014301
	iters: 100, epoch: 7 | loss: 0.3777304
	speed: 0.0271s/iter; left time: 50.3873s
	iters: 200, epoch: 7 | loss: 1.0022974
	speed: 0.0070s/iter; left time: 12.3639s
	iters: 300, epoch: 7 | loss: 0.3767360
	speed: 0.0071s/iter; left time: 11.8498s
	iters: 400, epoch: 7 | loss: 0.2144818
	speed: 0.0069s/iter; left time: 10.7617s
	iters: 500, epoch: 7 | loss: 0.7219571
	speed: 0.0073s/iter; left time: 10.6215s
	iters: 600, epoch: 7 | loss: 0.4638157
	speed: 0.0074s/iter; left time: 10.0319s
	iters: 700, epoch: 7 | loss: 1.0354137
	speed: 0.0073s/iter; left time: 9.2070s
	iters: 800, epoch: 7 | loss: 0.3918816
	speed: 0.0073s/iter; left time: 8.4370s
	iters: 900, epoch: 7 | loss: 0.4720470
	speed: 0.0078s/iter; left time: 8.2864s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.010056622218, 'e_layers': 4, 'learning_rate': 0.0005903490783, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005903490783
Validation loss decreased (inf --> 0.6418).  Saving model state dict ...
Epoch: 1 cost time: 1.4456169605255127
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6418333 Best vali loss: 0.6418333
Updating learning rate to 0.00029517453915
Validation loss decreased (0.6418 --> 0.6187).  Saving model state dict ...
Epoch: 2 cost time: 0.8574798107147217
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6186666 Best vali loss: 0.6186666
Updating learning rate to 0.000147587269575
Validation loss decreased (0.6187 --> 0.6100).  Saving model state dict ...
Epoch: 3 cost time: 0.8102965354919434
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6099958 Best vali loss: 0.6099958

best validation loss 0.6099957550140179

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0008236849278, 'e_layers': 4, 'learning_rate': 0.0005271398534, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4621518
	speed: 0.0203s/iter; left time: 77.4924s
	iters: 200, epoch: 1 | loss: 1.2502326
	speed: 0.0090s/iter; left time: 33.3949s
	iters: 300, epoch: 1 | loss: 0.3338449
	speed: 0.0110s/iter; left time: 39.7584s
	iters: 400, epoch: 1 | loss: 0.7990481
	speed: 0.0107s/iter; left time: 37.6733s
Updating learning rate to 0.0005271398534
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 5.690399408340454
Epoch: 1, Steps: 490 | Train Loss: 0.7113193 Vali Loss: 0.6073582 Best vali loss: 0.6073582
	iters: 100, epoch: 2 | loss: 1.1873174
	speed: 0.0222s/iter; left time: 73.9923s
	iters: 200, epoch: 2 | loss: 0.7475232
	speed: 0.0101s/iter; left time: 32.4896s
	iters: 300, epoch: 2 | loss: 1.1511314
	speed: 0.0122s/iter; left time: 38.2920s
	iters: 400, epoch: 2 | loss: 0.5384033
	speed: 0.0131s/iter; left time: 39.6943s
Updating learning rate to 0.0002635699267
Epoch: 2 cost time: 5.342793941497803
Epoch: 2, Steps: 490 | Train Loss: 0.9060938 Vali Loss: 0.6099828 Best vali loss: 0.6073582
	iters: 100, epoch: 3 | loss: 0.7969070
	speed: 0.0345s/iter; left time: 97.9707s
	iters: 200, epoch: 3 | loss: 0.3314344
	speed: 0.0123s/iter; left time: 33.6573s
	iters: 300, epoch: 3 | loss: 0.6000684
	speed: 0.0137s/iter; left time: 36.0827s
	iters: 400, epoch: 3 | loss: 1.0802017
	speed: 0.0130s/iter; left time: 33.1543s
Updating learning rate to 0.00013178496335
Validation loss decreased (0.6074 --> 0.6008).  Saving model state dict ...
Epoch: 3 cost time: 6.310780048370361
Epoch: 3, Steps: 490 | Train Loss: 0.7021529 Vali Loss: 0.6007667 Best vali loss: 0.6007667

best validation loss 0.6007667093682985

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.008580376438, 'e_layers': 1, 'learning_rate': 0.0001718521032, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7896100
	speed: 0.0153s/iter; left time: 28.4983s
	iters: 200, epoch: 1 | loss: 0.6121411
	speed: 0.0085s/iter; left time: 15.0022s
Updating learning rate to 0.0001653113719827487
Validation loss decreased (inf --> 0.6087).  Saving model state dict ...
Epoch: 1 cost time: 2.2324445247650146
Epoch: 1, Steps: 245 | Train Loss: 0.7008756 Vali Loss: 0.6086521 Best vali loss: 0.6086521
	iters: 100, epoch: 2 | loss: 0.5930449
	speed: 0.0084s/iter; left time: 13.5780s
	iters: 200, epoch: 2 | loss: 0.9571344
	speed: 0.0043s/iter; left time: 6.5307s
Updating learning rate to 0.0001466849453669452
Validation loss decreased (0.6087 --> 0.5987).  Saving model state dict ...
Epoch: 2 cost time: 1.0718908309936523
Epoch: 2, Steps: 245 | Train Loss: 0.7750896 Vali Loss: 0.5986558 Best vali loss: 0.5986558
	iters: 100, epoch: 3 | loss: 0.5812853
	speed: 0.0105s/iter; left time: 14.3822s
	iters: 200, epoch: 3 | loss: 1.0911326
	speed: 0.0050s/iter; left time: 6.3939s
Updating learning rate to 0.00011880852795586783
Epoch: 3 cost time: 1.256654977798462
Epoch: 3, Steps: 245 | Train Loss: 0.8362090 Vali Loss: 0.6041459 Best vali loss: 0.5986558

best validation loss 0.5986558316152221

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.008580376438, 'e_layers': 1, 'learning_rate': 0.0001718521032, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7379542
	speed: 0.0112s/iter; left time: 12.5555s
	iters: 200, epoch: 4 | loss: 0.5741775
	speed: 0.0046s/iter; left time: 4.7664s
Updating learning rate to 8.59260516e-05
Epoch: 4 cost time: 1.4944963455200195
Epoch: 4, Steps: 245 | Train Loss: 0.6560659 Vali Loss: 0.6130227 Best vali loss: 0.5986558
	iters: 100, epoch: 5 | loss: 0.6193830
	speed: 0.0098s/iter; left time: 8.6694s
	iters: 200, epoch: 5 | loss: 0.8440422
	speed: 0.0044s/iter; left time: 3.4645s
Updating learning rate to 5.3043575244132195e-05
Epoch: 5 cost time: 1.1366095542907715
Epoch: 5, Steps: 245 | Train Loss: 0.7317126 Vali Loss: 0.6135727 Best vali loss: 0.5986558
	iters: 100, epoch: 6 | loss: 0.5686639
	speed: 0.0108s/iter; left time: 6.8589s
	iters: 200, epoch: 6 | loss: 1.0441023
	speed: 0.0049s/iter; left time: 2.6369s
Updating learning rate to 2.5167157833054814e-05
Epoch: 6 cost time: 1.247558355331421
Epoch: 6, Steps: 245 | Train Loss: 0.8063831 Vali Loss: 0.6121380 Best vali loss: 0.5986558
	iters: 100, epoch: 7 | loss: 0.9522299
	speed: 0.0104s/iter; left time: 4.0830s
	iters: 200, epoch: 7 | loss: 0.5918015
	speed: 0.0049s/iter; left time: 1.4313s
Updating learning rate to 6.5407312172512985e-06
Epoch: 7 cost time: 1.2388429641723633
Epoch: 7, Steps: 245 | Train Loss: 0.7720157 Vali Loss: 0.6269573 Best vali loss: 0.5986558
	iters: 100, epoch: 8 | loss: 0.6977779
	speed: 0.0104s/iter; left time: 1.5250s
	iters: 200, epoch: 8 | loss: 0.6548810
	speed: 0.0047s/iter; left time: 0.2150s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1790695190429688
Epoch: 8, Steps: 245 | Train Loss: 0.6763295 Vali Loss: 0.6223552 Best vali loss: 0.5986558

best validation loss 0.5986558316152221

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0011159986324, 'e_layers': 1, 'learning_rate': 0.0012468667758, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0012468667758
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 0.7199356555938721
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6141570 Best vali loss: 0.6141570
Updating learning rate to 0.0006234333879
Validation loss decreased (0.6142 --> 0.6117).  Saving model state dict ...
Epoch: 2 cost time: 0.4238095283508301
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6117287 Best vali loss: 0.6117287
Updating learning rate to 0.00031171669395
Epoch: 3 cost time: 0.43669581413269043
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6197829 Best vali loss: 0.6117287
Updating learning rate to 0.000155858346975
Epoch: 4 cost time: 0.4391138553619385
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6212443 Best vali loss: 0.6117287
Updating learning rate to 7.79291734875e-05
Epoch: 5 cost time: 0.44973182678222656
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6164505 Best vali loss: 0.6117287
Updating learning rate to 3.896458674375e-05
Epoch: 6 cost time: 0.44372129440307617
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6200003 Best vali loss: 0.6117287
Updating learning rate to 1.9482293371875e-05
Epoch: 7 cost time: 0.4592397212982178
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6209590 Best vali loss: 0.6117287
Updating learning rate to 9.7411466859375e-06
Epoch: 8 cost time: 0.4430501461029053
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6202727 Best vali loss: 0.6117287

best validation loss 0.6117287245076986

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7267132
	speed: 0.0128s/iter; left time: 49.0096s
	iters: 200, epoch: 1 | loss: 1.3396878
	speed: 0.0067s/iter; left time: 24.8132s
	iters: 300, epoch: 1 | loss: 0.7094692
	speed: 0.0068s/iter; left time: 24.7624s
	iters: 400, epoch: 1 | loss: 0.6259186
	speed: 0.0063s/iter; left time: 22.3063s
Updating learning rate to 0.0008497821375614502
Validation loss decreased (inf --> 0.6124).  Saving model state dict ...
Epoch: 1 cost time: 3.5466928482055664
Epoch: 1, Steps: 490 | Train Loss: 0.8504472 Vali Loss: 0.6124183 Best vali loss: 0.6124183
	iters: 100, epoch: 2 | loss: 0.5533640
	speed: 0.0194s/iter; left time: 64.7042s
	iters: 200, epoch: 2 | loss: 0.7033187
	speed: 0.0071s/iter; left time: 23.0765s
	iters: 300, epoch: 2 | loss: 0.8354540
	speed: 0.0069s/iter; left time: 21.6344s
	iters: 400, epoch: 2 | loss: 0.3300948
	speed: 0.0065s/iter; left time: 19.6968s
Updating learning rate to 0.0007540331008505288
Validation loss decreased (0.6124 --> 0.6091).  Saving model state dict ...
Epoch: 2 cost time: 3.403825521469116
Epoch: 2, Steps: 490 | Train Loss: 0.6055579 Vali Loss: 0.6090606 Best vali loss: 0.6090606
	iters: 100, epoch: 3 | loss: 0.8599861
	speed: 0.0203s/iter; left time: 57.6095s
	iters: 200, epoch: 3 | loss: 0.8973127
	speed: 0.0092s/iter; left time: 25.1915s
	iters: 300, epoch: 3 | loss: 0.9897144
	speed: 0.0093s/iter; left time: 24.4456s
	iters: 400, epoch: 3 | loss: 0.3011785
	speed: 0.0097s/iter; left time: 24.7472s
Updating learning rate to 0.0006107345407392943
Epoch: 3 cost time: 4.655786752700806
Epoch: 3, Steps: 490 | Train Loss: 0.7620479 Vali Loss: 0.6215496 Best vali loss: 0.6090606
	iters: 100, epoch: 4 | loss: 0.6829970
	speed: 0.0269s/iter; left time: 63.1575s
	iters: 200, epoch: 4 | loss: 0.6805123
	speed: 0.0095s/iter; left time: 21.3643s
	iters: 300, epoch: 4 | loss: 1.1474377
	speed: 0.0100s/iter; left time: 21.5021s
	iters: 400, epoch: 4 | loss: 0.5737834
	speed: 0.0096s/iter; left time: 19.6474s
Updating learning rate to 0.000441702364
Epoch: 4 cost time: 4.689666509628296
Epoch: 4, Steps: 490 | Train Loss: 0.7711826 Vali Loss: 0.6335820 Best vali loss: 0.6090606
	iters: 100, epoch: 5 | loss: 0.6554415
	speed: 0.0214s/iter; left time: 39.8633s
	iters: 200, epoch: 5 | loss: 0.6978765
	speed: 0.0088s/iter; left time: 15.5792s
	iters: 300, epoch: 5 | loss: 0.7340907
	speed: 0.0083s/iter; left time: 13.8404s
	iters: 400, epoch: 5 | loss: 0.6878805
	speed: 0.0085s/iter; left time: 13.3049s
Updating learning rate to 0.0002726701872607057
Epoch: 5 cost time: 4.114954233169556
Epoch: 5, Steps: 490 | Train Loss: 0.6938223 Vali Loss: 0.6368542 Best vali loss: 0.6090606
	iters: 100, epoch: 6 | loss: 0.5845200
	speed: 0.0224s/iter; left time: 30.7296s
	iters: 200, epoch: 6 | loss: 1.1949916
	speed: 0.0086s/iter; left time: 10.9887s
	iters: 300, epoch: 6 | loss: 0.7781600
	speed: 0.0088s/iter; left time: 10.3371s
	iters: 400, epoch: 6 | loss: 0.5693004
	speed: 0.0094s/iter; left time: 10.0238s
Updating learning rate to 0.00012937162714947125
Epoch: 6 cost time: 4.117490768432617
Epoch: 6, Steps: 490 | Train Loss: 0.7817430 Vali Loss: 0.6455819 Best vali loss: 0.6090606
	iters: 100, epoch: 7 | loss: 0.9321927
	speed: 0.0177s/iter; left time: 15.5657s
	iters: 200, epoch: 7 | loss: 0.7357872
	speed: 0.0072s/iter; left time: 5.5924s
	iters: 300, epoch: 7 | loss: 0.2860990
	speed: 0.0072s/iter; left time: 4.9138s
	iters: 400, epoch: 7 | loss: 0.4078192
	speed: 0.0069s/iter; left time: 4.0000s
Updating learning rate to 3.362259043854979e-05
Epoch: 7 cost time: 3.4777989387512207
Epoch: 7, Steps: 490 | Train Loss: 0.5904745 Vali Loss: 0.6456898 Best vali loss: 0.6090606
	iters: 100, epoch: 8 | loss: 0.4115046
	speed: 0.0212s/iter; left time: 8.2928s
	iters: 200, epoch: 8 | loss: 0.4647523
	speed: 0.0074s/iter; left time: 2.1601s
	iters: 300, epoch: 8 | loss: 0.4175208
	speed: 0.0073s/iter; left time: 1.4003s
	iters: 400, epoch: 8 | loss: 0.4034842
	speed: 0.0070s/iter; left time: 0.6375s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5822911262512207
Epoch: 8, Steps: 490 | Train Loss: 0.4243155 Vali Loss: 0.6579867 Best vali loss: 0.6090606

best validation loss 0.6090606275613194

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011419754009, 'e_layers': 4, 'learning_rate': 0.0041132147357, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6594847
	speed: 0.0181s/iter; left time: 33.7468s
	iters: 200, epoch: 1 | loss: 0.5312942
	speed: 0.0120s/iter; left time: 21.1153s
Updating learning rate to 0.0041132147357
Validation loss decreased (inf --> 0.6154).  Saving model state dict ...
Epoch: 1 cost time: 3.224864959716797
Epoch: 1, Steps: 245 | Train Loss: 0.5953894 Vali Loss: 0.6153649 Best vali loss: 0.6153649
	iters: 100, epoch: 2 | loss: 1.0967664
	speed: 0.0205s/iter; left time: 33.1075s
	iters: 200, epoch: 2 | loss: 0.8405746
	speed: 0.0108s/iter; left time: 16.3537s
Updating learning rate to 0.00205660736785
Validation loss decreased (0.6154 --> 0.6135).  Saving model state dict ...
Epoch: 2 cost time: 2.7283365726470947
Epoch: 2, Steps: 245 | Train Loss: 0.9686705 Vali Loss: 0.6134660 Best vali loss: 0.6134660
	iters: 100, epoch: 3 | loss: 1.1242111
	speed: 0.0213s/iter; left time: 29.2514s
	iters: 200, epoch: 3 | loss: 0.7214118
	speed: 0.0120s/iter; left time: 15.2659s
Updating learning rate to 0.001028303683925
Validation loss decreased (0.6135 --> 0.6051).  Saving model state dict ...
Epoch: 3 cost time: 2.9909322261810303
Epoch: 3, Steps: 245 | Train Loss: 0.9228114 Vali Loss: 0.6050951 Best vali loss: 0.6050951

best validation loss 0.6050951481968757

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012820365822, 'e_layers': 4, 'learning_rate': 0.000140448495, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8793531
	speed: 0.0186s/iter; left time: 71.1764s
	iters: 200, epoch: 1 | loss: 0.5117215
	speed: 0.0097s/iter; left time: 36.2370s
	iters: 300, epoch: 1 | loss: 1.2298149
	speed: 0.0101s/iter; left time: 36.6484s
	iters: 400, epoch: 1 | loss: 1.1174989
	speed: 0.0120s/iter; left time: 42.2320s
Updating learning rate to 0.0001351029924512569
Validation loss decreased (inf --> 0.5961).  Saving model state dict ...
Epoch: 1 cost time: 5.873378038406372
Epoch: 1, Steps: 490 | Train Loss: 0.9345971 Vali Loss: 0.5960954 Best vali loss: 0.5960954
	iters: 100, epoch: 2 | loss: 1.0132083
	speed: 0.0304s/iter; left time: 101.1296s
	iters: 200, epoch: 2 | loss: 0.9164218
	speed: 0.0118s/iter; left time: 37.9684s
	iters: 300, epoch: 2 | loss: 0.9401848
	speed: 0.0109s/iter; left time: 34.1590s
	iters: 400, epoch: 2 | loss: 0.5024928
	speed: 0.0116s/iter; left time: 35.0822s
Updating learning rate to 0.00011988028911097245
Validation loss decreased (0.5961 --> 0.5897).  Saving model state dict ...
Epoch: 2 cost time: 5.717992782592773
Epoch: 2, Steps: 490 | Train Loss: 0.8430769 Vali Loss: 0.5896524 Best vali loss: 0.5896524
	iters: 100, epoch: 3 | loss: 0.7387195
	speed: 0.0314s/iter; left time: 89.1634s
	iters: 200, epoch: 3 | loss: 0.4739174
	speed: 0.0122s/iter; left time: 33.3675s
	iters: 300, epoch: 3 | loss: 0.8469326
	speed: 0.0107s/iter; left time: 28.2059s
	iters: 400, epoch: 3 | loss: 0.8717508
	speed: 0.0094s/iter; left time: 23.7624s
Updating learning rate to 9.709790356855557e-05
Validation loss decreased (0.5897 --> 0.5558).  Saving model state dict ...
Epoch: 3 cost time: 5.218677520751953
Epoch: 3, Steps: 490 | Train Loss: 0.7328301 Vali Loss: 0.5558478 Best vali loss: 0.5558478

best validation loss 0.5558478489814672

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0040861671799, 'e_layers': 4, 'learning_rate': 0.000304682777, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7973279
	speed: 0.0205s/iter; left time: 78.4046s
	iters: 200, epoch: 1 | loss: 0.7627755
	speed: 0.0079s/iter; left time: 29.3663s
	iters: 300, epoch: 1 | loss: 1.0621648
	speed: 0.0129s/iter; left time: 46.6954s
	iters: 400, epoch: 1 | loss: 0.5017407
	speed: 0.0136s/iter; left time: 47.7563s
Updating learning rate to 0.0002930864792895003
Validation loss decreased (inf --> 0.6052).  Saving model state dict ...
Epoch: 1 cost time: 6.529297113418579
Epoch: 1, Steps: 490 | Train Loss: 0.7810022 Vali Loss: 0.6051883 Best vali loss: 0.6051883
	iters: 100, epoch: 2 | loss: 0.5872678
	speed: 0.0306s/iter; left time: 101.8033s
	iters: 200, epoch: 2 | loss: 1.0960368
	speed: 0.0119s/iter; left time: 38.3756s
	iters: 300, epoch: 2 | loss: 0.8909400
	speed: 0.0113s/iter; left time: 35.4662s
	iters: 400, epoch: 2 | loss: 1.0103530
	speed: 0.0100s/iter; left time: 30.4545s
Updating learning rate to 0.00026006301736372433
Validation loss decreased (0.6052 --> 0.5997).  Saving model state dict ...
Epoch: 2 cost time: 5.227337121963501
Epoch: 2, Steps: 490 | Train Loss: 0.8961494 Vali Loss: 0.5997347 Best vali loss: 0.5997347
	iters: 100, epoch: 3 | loss: 0.7794178
	speed: 0.0248s/iter; left time: 70.3688s
	iters: 200, epoch: 3 | loss: 0.9780597
	speed: 0.0094s/iter; left time: 25.6643s
	iters: 300, epoch: 3 | loss: 0.6789728
	speed: 0.0116s/iter; left time: 30.5211s
	iters: 400, epoch: 3 | loss: 0.5164711
	speed: 0.0121s/iter; left time: 30.8474s
Updating learning rate to 0.00021063991394244363
Validation loss decreased (0.5997 --> 0.5758).  Saving model state dict ...
Epoch: 3 cost time: 5.1610987186431885
Epoch: 3, Steps: 490 | Train Loss: 0.7382303 Vali Loss: 0.5757883 Best vali loss: 0.5757883

best validation loss 0.5757882606095045

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012820365822, 'e_layers': 4, 'learning_rate': 0.000140448495, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7837462
	speed: 0.0181s/iter; left time: 42.5459s
	iters: 200, epoch: 4 | loss: 0.5202567
	speed: 0.0116s/iter; left time: 26.2200s
	iters: 300, epoch: 4 | loss: 1.1874689
	speed: 0.0116s/iter; left time: 25.0365s
	iters: 400, epoch: 4 | loss: 1.0882453
	speed: 0.0115s/iter; left time: 23.5578s
Updating learning rate to 7.02242475e-05
Epoch: 4 cost time: 6.105142593383789
Epoch: 4, Steps: 490 | Train Loss: 0.8949293 Vali Loss: 0.5579713 Best vali loss: 0.5558478
	iters: 100, epoch: 5 | loss: 0.9443894
	speed: 0.0289s/iter; left time: 53.7005s
	iters: 200, epoch: 5 | loss: 0.8324566
	speed: 0.0116s/iter; left time: 20.3423s
	iters: 300, epoch: 5 | loss: 0.8830857
	speed: 0.0150s/iter; left time: 24.9620s
	iters: 400, epoch: 5 | loss: 0.4299081
	speed: 0.0156s/iter; left time: 24.3398s
Updating learning rate to 4.3350591431444424e-05
Epoch: 5 cost time: 7.012807607650757
Epoch: 5, Steps: 490 | Train Loss: 0.7724599 Vali Loss: 0.5690238 Best vali loss: 0.5558478
	iters: 100, epoch: 6 | loss: 0.7428144
	speed: 0.0556s/iter; left time: 76.2543s
	iters: 200, epoch: 6 | loss: 0.4846253
	speed: 0.0137s/iter; left time: 17.3900s
	iters: 300, epoch: 6 | loss: 0.8465404
	speed: 0.0104s/iter; left time: 12.2239s
	iters: 400, epoch: 6 | loss: 0.8521541
	speed: 0.0153s/iter; left time: 16.3756s
Updating learning rate to 2.0568205889027548e-05
Epoch: 6 cost time: 7.443572759628296
Epoch: 6, Steps: 490 | Train Loss: 0.7315335 Vali Loss: 0.5582798 Best vali loss: 0.5558478
	iters: 100, epoch: 7 | loss: 0.5787852
	speed: 0.0461s/iter; left time: 40.6217s
	iters: 200, epoch: 7 | loss: 1.1247586
	speed: 0.0192s/iter; left time: 14.9847s
	iters: 300, epoch: 7 | loss: 0.7875810
	speed: 0.0217s/iter; left time: 14.7749s
	iters: 400, epoch: 7 | loss: 0.6227584
	speed: 0.0196s/iter; left time: 11.4054s
Updating learning rate to 5.345502548743103e-06
Epoch: 7 cost time: 9.797145366668701
Epoch: 7, Steps: 490 | Train Loss: 0.7784708 Vali Loss: 0.5637667 Best vali loss: 0.5558478
	iters: 100, epoch: 8 | loss: 0.6174321
	speed: 0.0648s/iter; left time: 25.3182s
	iters: 200, epoch: 8 | loss: 0.7518775
	speed: 0.0129s/iter; left time: 3.7677s
	iters: 300, epoch: 8 | loss: 1.1035473
	speed: 0.0121s/iter; left time: 2.3030s
	iters: 400, epoch: 8 | loss: 0.8079639
	speed: 0.0137s/iter; left time: 1.2436s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.949478626251221
Epoch: 8, Steps: 490 | Train Loss: 0.8202052 Vali Loss: 0.5663298 Best vali loss: 0.5558478

best validation loss 0.5558478489814672

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011400086869, 'e_layers': 3, 'learning_rate': 0.0005612978124, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9262955
	speed: 0.0249s/iter; left time: 22.0760s
Updating learning rate to 0.0005612978124
Validation loss decreased (inf --> 0.6207).  Saving model state dict ...
Epoch: 1 cost time: 2.6667890548706055
Epoch: 1, Steps: 123 | Train Loss: 0.9262955 Vali Loss: 0.6206583 Best vali loss: 0.6206583
	iters: 100, epoch: 2 | loss: 0.8378784
	speed: 0.0337s/iter; left time: 25.6777s
Updating learning rate to 0.0002806489062
Validation loss decreased (0.6207 --> 0.6021).  Saving model state dict ...
Epoch: 2 cost time: 2.4559011459350586
Epoch: 2, Steps: 123 | Train Loss: 0.8378784 Vali Loss: 0.6021246 Best vali loss: 0.6021246
	iters: 100, epoch: 3 | loss: 0.8442132
	speed: 0.0345s/iter; left time: 22.0608s
Updating learning rate to 0.0001403244531
Epoch: 3 cost time: 2.6705925464630127
Epoch: 3, Steps: 123 | Train Loss: 0.8442132 Vali Loss: 0.6139779 Best vali loss: 0.6021246
	iters: 100, epoch: 4 | loss: 0.9001800
	speed: 0.0244s/iter; left time: 12.6082s
Updating learning rate to 7.016222655e-05
Validation loss decreased (0.6021 --> 0.6015).  Saving model state dict ...
Epoch: 4 cost time: 1.5594284534454346
Epoch: 4, Steps: 123 | Train Loss: 0.9001800 Vali Loss: 0.6014844 Best vali loss: 0.6014844
	iters: 100, epoch: 5 | loss: 0.5933090
	speed: 0.0247s/iter; left time: 9.7201s
Updating learning rate to 3.5081113275e-05
Epoch: 5 cost time: 2.4138524532318115
Epoch: 5, Steps: 123 | Train Loss: 0.5933090 Vali Loss: 0.6045921 Best vali loss: 0.6014844
	iters: 100, epoch: 6 | loss: 0.7369278
	speed: 0.0272s/iter; left time: 7.3534s
Updating learning rate to 1.75405566375e-05
Validation loss decreased (0.6015 --> 0.5992).  Saving model state dict ...
Epoch: 6 cost time: 2.3739771842956543
Epoch: 6, Steps: 123 | Train Loss: 0.7369278 Vali Loss: 0.5992248 Best vali loss: 0.5992248
	iters: 100, epoch: 7 | loss: 0.6968253
	speed: 0.0304s/iter; left time: 4.4659s
Updating learning rate to 8.77027831875e-06
Validation loss decreased (0.5992 --> 0.5988).  Saving model state dict ...
Epoch: 7 cost time: 2.257659912109375
Epoch: 7, Steps: 123 | Train Loss: 0.6968253 Vali Loss: 0.5988249 Best vali loss: 0.5988249
	iters: 100, epoch: 8 | loss: 0.7183584
	speed: 0.0313s/iter; left time: 0.7524s
Updating learning rate to 4.385139159375e-06
Validation loss decreased (0.5988 --> 0.5960).  Saving model state dict ...
Epoch: 8 cost time: 2.402933120727539
Epoch: 8, Steps: 123 | Train Loss: 0.7183584 Vali Loss: 0.5959928 Best vali loss: 0.5959928

best validation loss 0.5959927729024539

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048859156977, 'e_layers': 4, 'learning_rate': 7.7601951e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4488580
	speed: 0.0167s/iter; left time: 63.6240s
	iters: 200, epoch: 1 | loss: 1.0155113
	speed: 0.0125s/iter; left time: 46.3601s
	iters: 300, epoch: 1 | loss: 1.1276838
	speed: 0.0154s/iter; left time: 55.7096s
	iters: 400, epoch: 1 | loss: 0.4916812
	speed: 0.0083s/iter; left time: 29.3732s
Updating learning rate to 7.464840260592189e-05
Validation loss decreased (inf --> 0.5877).  Saving model state dict ...
Epoch: 1 cost time: 5.913721323013306
Epoch: 1, Steps: 490 | Train Loss: 0.7709336 Vali Loss: 0.5876838 Best vali loss: 0.5876838
	iters: 100, epoch: 2 | loss: 1.0814559
	speed: 0.0279s/iter; left time: 93.0737s
	iters: 200, epoch: 2 | loss: 0.7068046
	speed: 0.0103s/iter; left time: 33.1271s
	iters: 300, epoch: 2 | loss: 1.1761651
	speed: 0.0102s/iter; left time: 32.0427s
	iters: 400, epoch: 2 | loss: 0.9413446
	speed: 0.0096s/iter; left time: 29.2434s
Updating learning rate to 6.623740839270309e-05
Validation loss decreased (0.5877 --> 0.5791).  Saving model state dict ...
Epoch: 2 cost time: 5.262563467025757
Epoch: 2, Steps: 490 | Train Loss: 0.9764426 Vali Loss: 0.5790685 Best vali loss: 0.5790685
	iters: 100, epoch: 3 | loss: 0.8701695
	speed: 0.0290s/iter; left time: 82.5250s
	iters: 200, epoch: 3 | loss: 1.0203592
	speed: 0.0102s/iter; left time: 27.9883s
	iters: 300, epoch: 3 | loss: 0.5881769
	speed: 0.0101s/iter; left time: 26.7035s
	iters: 400, epoch: 3 | loss: 0.6276909
	speed: 0.0108s/iter; left time: 27.3186s
Updating learning rate to 5.3649465983453756e-05
Validation loss decreased (0.5791 --> 0.5664).  Saving model state dict ...
Epoch: 3 cost time: 5.201264381408691
Epoch: 3, Steps: 490 | Train Loss: 0.7765991 Vali Loss: 0.5664227 Best vali loss: 0.5664227
	iters: 100, epoch: 4 | loss: 0.8382286
	speed: 0.0275s/iter; left time: 64.5493s
	iters: 200, epoch: 4 | loss: 0.4073841
	speed: 0.0102s/iter; left time: 23.0677s
	iters: 300, epoch: 4 | loss: 0.7058836
	speed: 0.0103s/iter; left time: 22.1127s
	iters: 400, epoch: 4 | loss: 1.2397077
	speed: 0.0112s/iter; left time: 22.9347s
Updating learning rate to 3.88009755e-05
Validation loss decreased (0.5664 --> 0.5553).  Saving model state dict ...
Epoch: 4 cost time: 5.116908311843872
Epoch: 4, Steps: 490 | Train Loss: 0.7978010 Vali Loss: 0.5553475 Best vali loss: 0.5553475
	iters: 100, epoch: 5 | loss: 0.6447420
	speed: 0.0277s/iter; left time: 51.5589s
	iters: 200, epoch: 5 | loss: 0.2646545
	speed: 0.0089s/iter; left time: 15.7234s
	iters: 300, epoch: 5 | loss: 0.5908538
	speed: 0.0089s/iter; left time: 14.7632s
	iters: 400, epoch: 5 | loss: 1.0833747
	speed: 0.0196s/iter; left time: 30.5328s
Updating learning rate to 2.3952485016546247e-05
Validation loss decreased (0.5553 --> 0.5452).  Saving model state dict ...
Epoch: 5 cost time: 6.296696186065674
Epoch: 5, Steps: 490 | Train Loss: 0.6459062 Vali Loss: 0.5452476 Best vali loss: 0.5452476
	iters: 100, epoch: 6 | loss: 0.5523108
	speed: 0.0462s/iter; left time: 63.3569s
	iters: 200, epoch: 6 | loss: 0.8280132
	speed: 0.0088s/iter; left time: 11.2114s
	iters: 300, epoch: 6 | loss: 0.8101568
	speed: 0.0112s/iter; left time: 13.1139s
	iters: 400, epoch: 6 | loss: 0.6761662
	speed: 0.0094s/iter; left time: 10.0305s
Updating learning rate to 1.1364542607296912e-05
Validation loss decreased (0.5452 --> 0.5391).  Saving model state dict ...
Epoch: 6 cost time: 4.659246206283569
Epoch: 6, Steps: 490 | Train Loss: 0.7166617 Vali Loss: 0.5390935 Best vali loss: 0.5390935
	iters: 100, epoch: 7 | loss: 0.8140519
	speed: 0.0249s/iter; left time: 21.9744s
	iters: 200, epoch: 7 | loss: 0.3843006
	speed: 0.0110s/iter; left time: 8.5689s
	iters: 300, epoch: 7 | loss: 0.7054542
	speed: 0.0092s/iter; left time: 6.2398s
	iters: 400, epoch: 7 | loss: 0.9204084
	speed: 0.0086s/iter; left time: 4.9713s
Updating learning rate to 2.9535483940781098e-06
Validation loss decreased (0.5391 --> 0.5345).  Saving model state dict ...
Epoch: 7 cost time: 4.606297492980957
Epoch: 7, Steps: 490 | Train Loss: 0.7060538 Vali Loss: 0.5344931 Best vali loss: 0.5344931
	iters: 100, epoch: 8 | loss: 0.5261292
	speed: 0.0252s/iter; left time: 9.8399s
	iters: 200, epoch: 8 | loss: 0.7865842
	speed: 0.0115s/iter; left time: 3.3329s
	iters: 300, epoch: 8 | loss: 0.4147151
	speed: 0.0075s/iter; left time: 1.4238s
	iters: 400, epoch: 8 | loss: 0.4155843
	speed: 0.0100s/iter; left time: 0.9065s
Updating learning rate to 0.0
Validation loss decreased (0.5345 --> 0.5332).  Saving model state dict ...
Epoch: 8 cost time: 4.865516662597656
Epoch: 8, Steps: 490 | Train Loss: 0.5357532 Vali Loss: 0.5332479 Best vali loss: 0.5332479

best validation loss 0.5332478830683072

[INFO][abstract_intensifier.py:595] Added config e9c222 and rejected config 9ae47e as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022899640873, 'e_layers': 3, 'learning_rate': 0.0002283220047, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9142466
	speed: 0.0166s/iter; left time: 30.8630s
	iters: 200, epoch: 1 | loss: 0.5077115
	speed: 0.0093s/iter; left time: 16.4439s
Updating learning rate to 0.0002283220047
Validation loss decreased (inf --> 0.6105).  Saving model state dict ...
Epoch: 1 cost time: 2.7038140296936035
Epoch: 1, Steps: 245 | Train Loss: 0.7109790 Vali Loss: 0.6105304 Best vali loss: 0.6105304
	iters: 100, epoch: 2 | loss: 0.6898822
	speed: 0.0223s/iter; left time: 36.0032s
	iters: 200, epoch: 2 | loss: 0.7256665
	speed: 0.0091s/iter; left time: 13.7535s
Updating learning rate to 0.00011416100235
Validation loss decreased (0.6105 --> 0.5624).  Saving model state dict ...
Epoch: 2 cost time: 3.199443817138672
Epoch: 2, Steps: 245 | Train Loss: 0.7077744 Vali Loss: 0.5624466 Best vali loss: 0.5624466
	iters: 100, epoch: 3 | loss: 0.9018958
	speed: 0.0547s/iter; left time: 74.9642s
	iters: 200, epoch: 3 | loss: 0.9370894
	speed: 0.0222s/iter; left time: 28.1539s
Updating learning rate to 5.7080501175e-05
Validation loss decreased (0.5624 --> 0.5563).  Saving model state dict ...
Epoch: 3 cost time: 5.367804527282715
Epoch: 3, Steps: 245 | Train Loss: 0.9194926 Vali Loss: 0.5563259 Best vali loss: 0.5563259

best validation loss 0.5563258973055005

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0022567395576, 'e_layers': 4, 'learning_rate': 0.0017978874786, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8962033
	speed: 0.0223s/iter; left time: 172.5423s
	iters: 200, epoch: 1 | loss: 0.7368859
	speed: 0.0145s/iter; left time: 110.5766s
	iters: 300, epoch: 1 | loss: 0.7613056
	speed: 0.0109s/iter; left time: 82.1664s
	iters: 400, epoch: 1 | loss: 0.5203843
	speed: 0.0106s/iter; left time: 78.6553s
	iters: 500, epoch: 1 | loss: 0.6722224
	speed: 0.0089s/iter; left time: 65.1467s
	iters: 600, epoch: 1 | loss: 2.3100257
	speed: 0.0111s/iter; left time: 80.5071s
	iters: 700, epoch: 1 | loss: 1.4341978
	speed: 0.0101s/iter; left time: 72.1717s
	iters: 800, epoch: 1 | loss: 0.5767666
	speed: 0.0101s/iter; left time: 71.1604s
	iters: 900, epoch: 1 | loss: 1.0635555
	speed: 0.0106s/iter; left time: 73.7393s
Updating learning rate to 0.0017294594609184321
Validation loss decreased (inf --> 0.6389).  Saving model state dict ...
Epoch: 1 cost time: 11.481679916381836
Epoch: 1, Steps: 979 | Train Loss: 0.9968386 Vali Loss: 0.6389199 Best vali loss: 0.6389199
	iters: 100, epoch: 2 | loss: 1.9851253
	speed: 0.0333s/iter; left time: 225.2103s
	iters: 200, epoch: 2 | loss: 0.9557716
	speed: 0.0074s/iter; left time: 49.0328s
	iters: 300, epoch: 2 | loss: 1.2853316
	speed: 0.0091s/iter; left time: 59.7945s
	iters: 400, epoch: 2 | loss: 0.9043331
	speed: 0.0103s/iter; left time: 66.2145s
	iters: 500, epoch: 2 | loss: 0.6289094
	speed: 0.0101s/iter; left time: 64.2140s
	iters: 600, epoch: 2 | loss: 0.6845400
	speed: 0.0103s/iter; left time: 64.3086s
	iters: 700, epoch: 2 | loss: 0.7897752
	speed: 0.0101s/iter; left time: 62.0289s
	iters: 800, epoch: 2 | loss: 0.3168631
	speed: 0.0107s/iter; left time: 64.7125s
	iters: 900, epoch: 2 | loss: 0.5830747
	speed: 0.0104s/iter; left time: 61.8683s
Updating learning rate to 0.0015345929532642219
Epoch: 2 cost time: 9.886063575744629
Epoch: 2, Steps: 979 | Train Loss: 0.9037471 Vali Loss: 0.6491314 Best vali loss: 0.6389199
	iters: 100, epoch: 3 | loss: 0.3850983
	speed: 0.0312s/iter; left time: 180.2834s
	iters: 200, epoch: 3 | loss: 0.9000179
	speed: 0.0099s/iter; left time: 56.2382s
	iters: 300, epoch: 3 | loss: 0.9291537
	speed: 0.0107s/iter; left time: 59.8522s
	iters: 400, epoch: 3 | loss: 1.0092330
	speed: 0.0103s/iter; left time: 56.3372s
	iters: 500, epoch: 3 | loss: 0.6354221
	speed: 0.0103s/iter; left time: 55.6082s
	iters: 600, epoch: 3 | loss: 0.4493718
	speed: 0.0091s/iter; left time: 47.9622s
	iters: 700, epoch: 3 | loss: 1.6505151
	speed: 0.0089s/iter; left time: 46.0119s
	iters: 800, epoch: 3 | loss: 0.5399094
	speed: 0.0100s/iter; left time: 50.5931s
	iters: 900, epoch: 3 | loss: 0.6561112
	speed: 0.0105s/iter; left time: 52.0135s
Updating learning rate to 0.0012429546149584326
Epoch: 3 cost time: 9.658862352371216
Epoch: 3, Steps: 979 | Train Loss: 0.7949814 Vali Loss: 0.6415413 Best vali loss: 0.6389199

best validation loss 0.6389199037454791

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0022985164426, 'e_layers': 1, 'learning_rate': 0.0001341069248, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012900278389537515
Validation loss decreased (inf --> 0.6209).  Saving model state dict ...
Epoch: 1 cost time: 0.8927121162414551
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6209051 Best vali loss: 0.6209051
Updating learning rate to 0.00011446742036507719
Validation loss decreased (0.6209 --> 0.6019).  Saving model state dict ...
Epoch: 2 cost time: 0.5872189998626709
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6019079 Best vali loss: 0.6019079
Updating learning rate to 9.271371154319549e-05
Epoch: 3 cost time: 0.5817346572875977
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6042772 Best vali loss: 0.6019079

best validation loss 0.601907919783771

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022899640873, 'e_layers': 3, 'learning_rate': 0.0002283220047, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8485304
	speed: 0.0179s/iter; left time: 20.1110s
	iters: 200, epoch: 4 | loss: 0.4830459
	speed: 0.0096s/iter; left time: 9.8065s
Updating learning rate to 2.85402505875e-05
Epoch: 4 cost time: 2.821000099182129
Epoch: 4, Steps: 245 | Train Loss: 0.6657882 Vali Loss: 0.5588129 Best vali loss: 0.5563259
	iters: 100, epoch: 5 | loss: 0.5801194
	speed: 0.0178s/iter; left time: 15.6458s
	iters: 200, epoch: 5 | loss: 0.6582111
	speed: 0.0094s/iter; left time: 7.3154s
Updating learning rate to 1.427012529375e-05
Validation loss decreased (0.5563 --> 0.5500).  Saving model state dict ...
Epoch: 5 cost time: 2.3208563327789307
Epoch: 5, Steps: 245 | Train Loss: 0.6191652 Vali Loss: 0.5500270 Best vali loss: 0.5500270
	iters: 100, epoch: 6 | loss: 0.8590325
	speed: 0.0194s/iter; left time: 12.3400s
	iters: 200, epoch: 6 | loss: 0.8478150
	speed: 0.0095s/iter; left time: 5.1088s
Updating learning rate to 7.135062646875e-06
Validation loss decreased (0.5500 --> 0.5479).  Saving model state dict ...
Epoch: 6 cost time: 2.53985857963562
Epoch: 6, Steps: 245 | Train Loss: 0.8534237 Vali Loss: 0.5478915 Best vali loss: 0.5478915
	iters: 100, epoch: 7 | loss: 0.4756685
	speed: 0.0179s/iter; left time: 6.9863s
	iters: 200, epoch: 7 | loss: 0.7095057
	speed: 0.0094s/iter; left time: 2.7358s
Updating learning rate to 3.5675313234375e-06
Epoch: 7 cost time: 2.3725199699401855
Epoch: 7, Steps: 245 | Train Loss: 0.5925871 Vali Loss: 0.5483821 Best vali loss: 0.5478915
	iters: 100, epoch: 8 | loss: 0.6937764
	speed: 0.0194s/iter; left time: 2.8328s
	iters: 200, epoch: 8 | loss: 0.7823424
	speed: 0.0091s/iter; left time: 0.4188s
Updating learning rate to 1.78376566171875e-06
Epoch: 8 cost time: 2.458052396774292
Epoch: 8, Steps: 245 | Train Loss: 0.7380594 Vali Loss: 0.5485824 Best vali loss: 0.5478915

best validation loss 0.5478914852276934

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0033642149727, 'e_layers': 1, 'learning_rate': 0.0023507902628, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0070070
	speed: 0.0132s/iter; left time: 11.7153s
Updating learning rate to 0.0023507902628
Validation loss decreased (inf --> 0.6014).  Saving model state dict ...
Epoch: 1 cost time: 1.188323736190796
Epoch: 1, Steps: 123 | Train Loss: 1.0070070 Vali Loss: 0.6013944 Best vali loss: 0.6013944
	iters: 100, epoch: 2 | loss: 0.9481836
	speed: 0.0118s/iter; left time: 8.9570s
Updating learning rate to 0.0011753951314
Epoch: 2 cost time: 0.9356861114501953
Epoch: 2, Steps: 123 | Train Loss: 0.9481836 Vali Loss: 0.6229483 Best vali loss: 0.6013944
	iters: 100, epoch: 3 | loss: 0.6054356
	speed: 0.0162s/iter; left time: 10.3241s
Updating learning rate to 0.0005876975657
Epoch: 3 cost time: 1.0775761604309082
Epoch: 3, Steps: 123 | Train Loss: 0.6054356 Vali Loss: 0.6235054 Best vali loss: 0.6013944
	iters: 100, epoch: 4 | loss: 0.7761340
	speed: 0.0121s/iter; left time: 6.2555s
Updating learning rate to 0.00029384878285
Epoch: 4 cost time: 1.0002882480621338
Epoch: 4, Steps: 123 | Train Loss: 0.7761340 Vali Loss: 0.6243731 Best vali loss: 0.6013944
	iters: 100, epoch: 5 | loss: 0.8667738
	speed: 0.0117s/iter; left time: 4.6075s
Updating learning rate to 0.000146924391425
Epoch: 5 cost time: 0.9238770008087158
Epoch: 5, Steps: 123 | Train Loss: 0.8667738 Vali Loss: 0.6307934 Best vali loss: 0.6013944
	iters: 100, epoch: 6 | loss: 0.7797348
	speed: 0.0116s/iter; left time: 3.1383s
Updating learning rate to 7.34621957125e-05
Epoch: 6 cost time: 0.905465841293335
Epoch: 6, Steps: 123 | Train Loss: 0.7797348 Vali Loss: 0.6281949 Best vali loss: 0.6013944
	iters: 100, epoch: 7 | loss: 0.8599960
	speed: 0.0148s/iter; left time: 2.1710s
Updating learning rate to 3.673109785625e-05
Epoch: 7 cost time: 1.2916395664215088
Epoch: 7, Steps: 123 | Train Loss: 0.8599960 Vali Loss: 0.6359643 Best vali loss: 0.6013944
	iters: 100, epoch: 8 | loss: 0.6176778
	speed: 0.0088s/iter; left time: 0.2118s
Updating learning rate to 1.8365548928125e-05
Epoch: 8 cost time: 0.6037251949310303
Epoch: 8, Steps: 123 | Train Loss: 0.6176778 Vali Loss: 0.6369582 Best vali loss: 0.6013944

best validation loss 0.6013943717359448

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0065648019707, 'e_layers': 1, 'learning_rate': 8.73005964e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.397791529499427e-05
Validation loss decreased (inf --> 0.6938).  Saving model state dict ...
Epoch: 1 cost time: 1.4294958114624023
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6937770 Best vali loss: 0.6937770
Updating learning rate to 7.451572005803495e-05
Validation loss decreased (0.6938 --> 0.6773).  Saving model state dict ...
Epoch: 2 cost time: 1.1833112239837646
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6773070 Best vali loss: 0.6773070
Updating learning rate to 6.0354544138935704e-05
Validation loss decreased (0.6773 --> 0.6649).  Saving model state dict ...
Epoch: 3 cost time: 1.1835026741027832
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6649327 Best vali loss: 0.6649327
Updating learning rate to 4.36502982e-05
Validation loss decreased (0.6649 --> 0.6567).  Saving model state dict ...
Epoch: 4 cost time: 1.2325048446655273
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6566762 Best vali loss: 0.6566762
Updating learning rate to 2.6946052261064304e-05
Validation loss decreased (0.6567 --> 0.6508).  Saving model state dict ...
Epoch: 5 cost time: 1.2220277786254883
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6508135 Best vali loss: 0.6508135
Updating learning rate to 1.2784876341965054e-05
Validation loss decreased (0.6508 --> 0.6479).  Saving model state dict ...
Epoch: 6 cost time: 1.6195242404937744
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6479344 Best vali loss: 0.6479344
Updating learning rate to 3.322681105005739e-06
Validation loss decreased (0.6479 --> 0.6466).  Saving model state dict ...
Epoch: 7 cost time: 1.1757864952087402
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6465795 Best vali loss: 0.6465795
Updating learning rate to 0.0
Validation loss decreased (0.6466 --> 0.6462).  Saving model state dict ...
Epoch: 8 cost time: 1.6396021842956543
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6462203 Best vali loss: 0.6462203

best validation loss 0.6462203143151587

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0056386129354, 'e_layers': 1, 'learning_rate': 0.003057829033, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8374144
	speed: 0.0189s/iter; left time: 72.4048s
	iters: 200, epoch: 1 | loss: 0.5717550
	speed: 0.0107s/iter; left time: 39.9333s
	iters: 300, epoch: 1 | loss: 0.6680307
	speed: 0.0119s/iter; left time: 43.1553s
	iters: 400, epoch: 1 | loss: 1.1159018
	speed: 0.0119s/iter; left time: 41.9347s
Updating learning rate to 0.003057829033
Validation loss decreased (inf --> 0.6189).  Saving model state dict ...
Epoch: 1 cost time: 6.058085203170776
Epoch: 1, Steps: 490 | Train Loss: 0.7982755 Vali Loss: 0.6188553 Best vali loss: 0.6188553
	iters: 100, epoch: 2 | loss: 1.5216843
	speed: 0.0328s/iter; left time: 109.1829s
	iters: 200, epoch: 2 | loss: 0.3765874
	speed: 0.0097s/iter; left time: 31.4064s
	iters: 300, epoch: 2 | loss: 0.8156407
	speed: 0.0104s/iter; left time: 32.5970s
	iters: 400, epoch: 2 | loss: 0.9040628
	speed: 0.0092s/iter; left time: 27.8247s
Updating learning rate to 0.0015289145165
Epoch: 2 cost time: 4.182052850723267
Epoch: 2, Steps: 490 | Train Loss: 0.9044938 Vali Loss: 0.6211619 Best vali loss: 0.6188553
	iters: 100, epoch: 3 | loss: 0.7096825
	speed: 0.0309s/iter; left time: 87.6911s
	iters: 200, epoch: 3 | loss: 0.5353608
	speed: 0.0135s/iter; left time: 37.0366s
	iters: 300, epoch: 3 | loss: 0.7159995
	speed: 0.0151s/iter; left time: 39.8871s
	iters: 400, epoch: 3 | loss: 0.9253044
	speed: 0.0109s/iter; left time: 27.5761s
Updating learning rate to 0.00076445725825
Validation loss decreased (0.6189 --> 0.6136).  Saving model state dict ...
Epoch: 3 cost time: 6.081329345703125
Epoch: 3, Steps: 490 | Train Loss: 0.7215868 Vali Loss: 0.6136174 Best vali loss: 0.6136174

best validation loss 0.6136173500073061

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0009977413627, 'e_layers': 2, 'learning_rate': 0.000139137703, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7833057
	speed: 0.0197s/iter; left time: 17.4422s
Updating learning rate to 0.000139137703
Validation loss decreased (inf --> 0.6766).  Saving model state dict ...
Epoch: 1 cost time: 2.073589324951172
Epoch: 1, Steps: 123 | Train Loss: 0.7833057 Vali Loss: 0.6766231 Best vali loss: 0.6766231
	iters: 100, epoch: 2 | loss: 0.7332551
	speed: 0.0234s/iter; left time: 17.8022s
Updating learning rate to 6.95688515e-05
Validation loss decreased (0.6766 --> 0.6494).  Saving model state dict ...
Epoch: 2 cost time: 1.4782121181488037
Epoch: 2, Steps: 123 | Train Loss: 0.7332551 Vali Loss: 0.6494039 Best vali loss: 0.6494039
	iters: 100, epoch: 3 | loss: 0.7646577
	speed: 0.0144s/iter; left time: 9.1945s
Updating learning rate to 3.478442575e-05
Validation loss decreased (0.6494 --> 0.6404).  Saving model state dict ...
Epoch: 3 cost time: 1.1658689975738525
Epoch: 3, Steps: 123 | Train Loss: 0.7646577 Vali Loss: 0.6403940 Best vali loss: 0.6403940

best validation loss 0.6403939655013572

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008043881686, 'e_layers': 4, 'learning_rate': 0.0004018320868, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1760567
	speed: 0.0178s/iter; left time: 33.1741s
	iters: 200, epoch: 1 | loss: 0.9543494
	speed: 0.0132s/iter; left time: 23.1721s
Updating learning rate to 0.0004018320868
Validation loss decreased (inf --> 0.6138).  Saving model state dict ...
Epoch: 1 cost time: 3.299757719039917
Epoch: 1, Steps: 245 | Train Loss: 1.0652031 Vali Loss: 0.6137740 Best vali loss: 0.6137740
	iters: 100, epoch: 2 | loss: 0.8858824
	speed: 0.0209s/iter; left time: 33.7398s
	iters: 200, epoch: 2 | loss: 0.9120172
	speed: 0.0107s/iter; left time: 16.2202s
Updating learning rate to 0.0002009160434
Validation loss decreased (0.6138 --> 0.5907).  Saving model state dict ...
Epoch: 2 cost time: 2.69964861869812
Epoch: 2, Steps: 245 | Train Loss: 0.8989498 Vali Loss: 0.5907409 Best vali loss: 0.5907409
	iters: 100, epoch: 3 | loss: 0.5204762
	speed: 0.0207s/iter; left time: 28.3559s
	iters: 200, epoch: 3 | loss: 1.2347366
	speed: 0.0133s/iter; left time: 16.8575s
Updating learning rate to 0.0001004580217
Validation loss decreased (0.5907 --> 0.5566).  Saving model state dict ...
Epoch: 3 cost time: 2.977700710296631
Epoch: 3, Steps: 245 | Train Loss: 0.8776064 Vali Loss: 0.5566230 Best vali loss: 0.5566230

best validation loss 0.556622987775988

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008043881686, 'e_layers': 4, 'learning_rate': 0.0004018320868, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0158596
	speed: 0.0187s/iter; left time: 21.0349s
	iters: 200, epoch: 4 | loss: 0.8882843
	speed: 0.0111s/iter; left time: 11.4380s
Updating learning rate to 5.022901085e-05
Validation loss decreased (0.5566 --> 0.5546).  Saving model state dict ...
Epoch: 4 cost time: 3.0926103591918945
Epoch: 4, Steps: 245 | Train Loss: 0.9520719 Vali Loss: 0.5546212 Best vali loss: 0.5546212
	iters: 100, epoch: 5 | loss: 0.7631137
	speed: 0.0228s/iter; left time: 20.0877s
	iters: 200, epoch: 5 | loss: 0.8283949
	speed: 0.0110s/iter; left time: 8.5950s
Updating learning rate to 2.5114505425e-05
Validation loss decreased (0.5546 --> 0.5529).  Saving model state dict ...
Epoch: 5 cost time: 2.964604139328003
Epoch: 5, Steps: 245 | Train Loss: 0.7957543 Vali Loss: 0.5528574 Best vali loss: 0.5528574
	iters: 100, epoch: 6 | loss: 0.5094048
	speed: 0.0214s/iter; left time: 13.6084s
	iters: 200, epoch: 6 | loss: 1.2021691
	speed: 0.0112s/iter; left time: 6.0205s
Updating learning rate to 1.25572527125e-05
Validation loss decreased (0.5529 --> 0.5526).  Saving model state dict ...
Epoch: 6 cost time: 2.779548406600952
Epoch: 6, Steps: 245 | Train Loss: 0.8557869 Vali Loss: 0.5526360 Best vali loss: 0.5526360
	iters: 100, epoch: 7 | loss: 0.6570323
	speed: 0.0220s/iter; left time: 8.6167s
	iters: 200, epoch: 7 | loss: 0.6111801
	speed: 0.0110s/iter; left time: 3.1994s
Updating learning rate to 6.27862635625e-06
Epoch: 7 cost time: 2.881646156311035
Epoch: 7, Steps: 245 | Train Loss: 0.6341062 Vali Loss: 0.5546291 Best vali loss: 0.5526360
	iters: 100, epoch: 8 | loss: 0.7675915
	speed: 0.0202s/iter; left time: 2.9491s
	iters: 200, epoch: 8 | loss: 0.6683332
	speed: 0.0108s/iter; left time: 0.4977s
Updating learning rate to 3.139313178125e-06
Validation loss decreased (0.5526 --> 0.5522).  Saving model state dict ...
Epoch: 8 cost time: 2.695789098739624
Epoch: 8, Steps: 245 | Train Loss: 0.7179624 Vali Loss: 0.5521818 Best vali loss: 0.5521818

best validation loss 0.5521817755941879

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0052896376836, 'e_layers': 4, 'learning_rate': 6.64499544e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8892382
	speed: 0.0175s/iter; left time: 66.8538s
	iters: 200, epoch: 1 | loss: 1.0522693
	speed: 0.0110s/iter; left time: 40.9598s
	iters: 300, epoch: 1 | loss: 0.8826413
	speed: 0.0109s/iter; left time: 39.5594s
	iters: 400, epoch: 1 | loss: 1.2275170
	speed: 0.0112s/iter; left time: 39.4994s
Updating learning rate to 6.392085360323417e-05
Validation loss decreased (inf --> 0.6153).  Saving model state dict ...
Epoch: 1 cost time: 5.4515979290008545
Epoch: 1, Steps: 490 | Train Loss: 1.0129165 Vali Loss: 0.6153002 Best vali loss: 0.6153002
	iters: 100, epoch: 2 | loss: 1.1409233
	speed: 0.0199s/iter; left time: 66.1385s
	iters: 200, epoch: 2 | loss: 0.5075496
	speed: 0.0085s/iter; left time: 27.4711s
	iters: 300, epoch: 2 | loss: 0.4792507
	speed: 0.0110s/iter; left time: 34.3253s
	iters: 400, epoch: 2 | loss: 1.4342483
	speed: 0.0166s/iter; left time: 50.3773s
Updating learning rate to 5.671858388288843e-05
Validation loss decreased (0.6153 --> 0.6039).  Saving model state dict ...
Epoch: 2 cost time: 5.82495641708374
Epoch: 2, Steps: 490 | Train Loss: 0.8904930 Vali Loss: 0.6038720 Best vali loss: 0.6038720
	iters: 100, epoch: 3 | loss: 0.7582516
	speed: 0.0494s/iter; left time: 140.3520s
	iters: 200, epoch: 3 | loss: 1.0615860
	speed: 0.0168s/iter; left time: 45.9228s
	iters: 300, epoch: 3 | loss: 0.6466808
	speed: 0.0165s/iter; left time: 43.4792s
	iters: 400, epoch: 3 | loss: 0.8975656
	speed: 0.0142s/iter; left time: 36.1956s
Updating learning rate to 4.593962551514785e-05
Validation loss decreased (0.6039 --> 0.5844).  Saving model state dict ...
Epoch: 3 cost time: 7.639106035232544
Epoch: 3, Steps: 490 | Train Loss: 0.8410210 Vali Loss: 0.5843901 Best vali loss: 0.5843901
	iters: 100, epoch: 4 | loss: 1.0301520
	speed: 0.0288s/iter; left time: 67.6321s
	iters: 200, epoch: 4 | loss: 0.8535246
	speed: 0.0096s/iter; left time: 21.5915s
	iters: 300, epoch: 4 | loss: 0.8921013
	speed: 0.0097s/iter; left time: 20.8352s
	iters: 400, epoch: 4 | loss: 0.7705687
	speed: 0.0096s/iter; left time: 19.7636s
Updating learning rate to 3.32249772e-05
Validation loss decreased (0.5844 --> 0.5657).  Saving model state dict ...
Epoch: 4 cost time: 4.59682822227478
Epoch: 4, Steps: 490 | Train Loss: 0.8865866 Vali Loss: 0.5657413 Best vali loss: 0.5657413
	iters: 100, epoch: 5 | loss: 0.8882663
	speed: 0.0233s/iter; left time: 43.4044s
	iters: 200, epoch: 5 | loss: 0.9160939
	speed: 0.0091s/iter; left time: 15.9565s
	iters: 300, epoch: 5 | loss: 1.3074319
	speed: 0.0088s/iter; left time: 14.6807s
	iters: 400, epoch: 5 | loss: 0.7075620
	speed: 0.0089s/iter; left time: 13.8874s
Updating learning rate to 2.0510328884852154e-05
Validation loss decreased (0.5657 --> 0.5482).  Saving model state dict ...
Epoch: 5 cost time: 4.41119122505188
Epoch: 5, Steps: 490 | Train Loss: 0.9548386 Vali Loss: 0.5481585 Best vali loss: 0.5481585
	iters: 100, epoch: 6 | loss: 0.3600365
	speed: 0.0248s/iter; left time: 33.9883s
	iters: 200, epoch: 6 | loss: 0.5128850
	speed: 0.0092s/iter; left time: 11.6646s
	iters: 300, epoch: 6 | loss: 1.4901683
	speed: 0.0096s/iter; left time: 11.2119s
	iters: 400, epoch: 6 | loss: 0.5559522
	speed: 0.0093s/iter; left time: 10.0045s
Updating learning rate to 9.731370517111572e-06
Validation loss decreased (0.5482 --> 0.5419).  Saving model state dict ...
Epoch: 6 cost time: 4.5609753131866455
Epoch: 6, Steps: 490 | Train Loss: 0.7297605 Vali Loss: 0.5419461 Best vali loss: 0.5419461
	iters: 100, epoch: 7 | loss: 0.9262405
	speed: 0.0237s/iter; left time: 20.8674s
	iters: 200, epoch: 7 | loss: 0.7457500
	speed: 0.0095s/iter; left time: 7.4254s
	iters: 300, epoch: 7 | loss: 0.6342685
	speed: 0.0093s/iter; left time: 6.3546s
	iters: 400, epoch: 7 | loss: 0.4936065
	speed: 0.0095s/iter; left time: 5.5244s
Updating learning rate to 2.5291007967658393e-06
Epoch: 7 cost time: 4.710428476333618
Epoch: 7, Steps: 490 | Train Loss: 0.6999664 Vali Loss: 0.5468456 Best vali loss: 0.5419461
	iters: 100, epoch: 8 | loss: 0.6138064
	speed: 0.0251s/iter; left time: 9.8274s
	iters: 200, epoch: 8 | loss: 0.7484193
	speed: 0.0085s/iter; left time: 2.4693s
	iters: 300, epoch: 8 | loss: 1.0022850
	speed: 0.0081s/iter; left time: 1.5564s
	iters: 400, epoch: 8 | loss: 0.7295259
	speed: 0.0082s/iter; left time: 0.7468s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.396839380264282
Epoch: 8, Steps: 490 | Train Loss: 0.7735091 Vali Loss: 0.5456483 Best vali loss: 0.5419461

best validation loss 0.5419460947399942

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0089874597665, 'e_layers': 2, 'learning_rate': 0.0007900549735, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007900549735
Validation loss decreased (inf --> 0.6118).  Saving model state dict ...
Epoch: 1 cost time: 1.0328454971313477
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6118024 Best vali loss: 0.6118024
Updating learning rate to 0.00039502748675
Validation loss decreased (0.6118 --> 0.6092).  Saving model state dict ...
Epoch: 2 cost time: 0.7778704166412354
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6091801 Best vali loss: 0.6091801
Updating learning rate to 0.000197513743375
Epoch: 3 cost time: 0.6818361282348633
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6139012 Best vali loss: 0.6091801
Updating learning rate to 9.87568716875e-05
Validation loss decreased (0.6092 --> 0.6003).  Saving model state dict ...
Epoch: 4 cost time: 0.7378139495849609
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6002605 Best vali loss: 0.6002605
Updating learning rate to 4.937843584375e-05
Epoch: 5 cost time: 0.8536293506622314
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6077222 Best vali loss: 0.6002605
Updating learning rate to 2.4689217921875e-05
Validation loss decreased (0.6003 --> 0.5991).  Saving model state dict ...
Epoch: 6 cost time: 0.8509044647216797
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5990746 Best vali loss: 0.5990746
Updating learning rate to 1.23446089609375e-05
Epoch: 7 cost time: 0.8470005989074707
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6016114 Best vali loss: 0.5990746
Updating learning rate to 6.17230448046875e-06
Epoch: 8 cost time: 0.8215806484222412
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6027357 Best vali loss: 0.5990746

best validation loss 0.5990746132426106

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0045415750231, 'e_layers': 3, 'learning_rate': 0.001151732196, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8674408
	speed: 0.0177s/iter; left time: 67.8106s
	iters: 200, epoch: 1 | loss: 0.9007712
	speed: 0.0099s/iter; left time: 36.8074s
	iters: 300, epoch: 1 | loss: 0.6305192
	speed: 0.0110s/iter; left time: 39.8898s
	iters: 400, epoch: 1 | loss: 0.8537941
	speed: 0.0101s/iter; left time: 35.4932s
Updating learning rate to 0.001151732196
Validation loss decreased (inf --> 0.6641).  Saving model state dict ...
Epoch: 1 cost time: 5.619637966156006
Epoch: 1, Steps: 490 | Train Loss: 0.8131313 Vali Loss: 0.6640790 Best vali loss: 0.6640790
	iters: 100, epoch: 2 | loss: 0.9938129
	speed: 0.0316s/iter; left time: 105.1319s
	iters: 200, epoch: 2 | loss: 1.4769207
	speed: 0.0102s/iter; left time: 32.9009s
	iters: 300, epoch: 2 | loss: 1.7184625
	speed: 0.0142s/iter; left time: 44.5124s
	iters: 400, epoch: 2 | loss: 1.1064193
	speed: 0.0135s/iter; left time: 40.9151s
Updating learning rate to 0.000575866098
Validation loss decreased (0.6641 --> 0.6395).  Saving model state dict ...
Epoch: 2 cost time: 6.367678642272949
Epoch: 2, Steps: 490 | Train Loss: 1.3239039 Vali Loss: 0.6394696 Best vali loss: 0.6394696
	iters: 100, epoch: 3 | loss: 0.9208605
	speed: 0.0317s/iter; left time: 90.0012s
	iters: 200, epoch: 3 | loss: 1.4789943
	speed: 0.0115s/iter; left time: 31.6273s
	iters: 300, epoch: 3 | loss: 0.5687938
	speed: 0.0106s/iter; left time: 28.0065s
	iters: 400, epoch: 3 | loss: 0.8734835
	speed: 0.0124s/iter; left time: 31.5819s
Updating learning rate to 0.000287933049
Epoch: 3 cost time: 5.7123777866363525
Epoch: 3, Steps: 490 | Train Loss: 0.9605330 Vali Loss: 0.6473484 Best vali loss: 0.6394696

best validation loss 0.6394696060304341

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0101347050857, 'e_layers': 3, 'learning_rate': 0.0034379020615, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5945871
	speed: 0.0184s/iter; left time: 70.3078s
	iters: 200, epoch: 1 | loss: 0.9365539
	speed: 0.0093s/iter; left time: 34.7578s
	iters: 300, epoch: 1 | loss: 1.0700232
	speed: 0.0090s/iter; left time: 32.4728s
	iters: 400, epoch: 1 | loss: 0.6450465
	speed: 0.0063s/iter; left time: 22.2665s
Updating learning rate to 0.0033070547054491043
Validation loss decreased (inf --> 0.6110).  Saving model state dict ...
Epoch: 1 cost time: 4.7005696296691895
Epoch: 1, Steps: 490 | Train Loss: 0.8115527 Vali Loss: 0.6110151 Best vali loss: 0.6110151
	iters: 100, epoch: 2 | loss: 0.6668001
	speed: 0.0246s/iter; left time: 81.8360s
	iters: 200, epoch: 2 | loss: 0.6808900
	speed: 0.0089s/iter; left time: 28.8718s
	iters: 300, epoch: 2 | loss: 0.5159534
	speed: 0.0090s/iter; left time: 28.2117s
	iters: 400, epoch: 2 | loss: 0.9997579
	speed: 0.0086s/iter; left time: 26.0280s
Updating learning rate to 0.0029344329611209305
Epoch: 2 cost time: 4.380614995956421
Epoch: 2, Steps: 490 | Train Loss: 0.7158503 Vali Loss: 0.6263981 Best vali loss: 0.6110151
	iters: 100, epoch: 3 | loss: 0.5080775
	speed: 0.0234s/iter; left time: 66.4644s
	iters: 200, epoch: 3 | loss: 0.4580478
	speed: 0.0133s/iter; left time: 36.5598s
	iters: 300, epoch: 3 | loss: 0.4522837
	speed: 0.0162s/iter; left time: 42.7227s
	iters: 400, epoch: 3 | loss: 0.6428576
	speed: 0.0150s/iter; left time: 38.0511s
Updating learning rate to 0.002376765111264919
Epoch: 3 cost time: 6.714124917984009
Epoch: 3, Steps: 490 | Train Loss: 0.5153167 Vali Loss: 0.6213590 Best vali loss: 0.6110151

best validation loss 0.6110151146074403

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0086057487695, 'e_layers': 4, 'learning_rate': 0.0011712676726, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6374474
	speed: 0.0322s/iter; left time: 28.5029s
Updating learning rate to 0.0011266889512036354
Validation loss decreased (inf --> 0.6025).  Saving model state dict ...
Epoch: 1 cost time: 3.4028232097625732
Epoch: 1, Steps: 123 | Train Loss: 0.6374474 Vali Loss: 0.6025438 Best vali loss: 0.6025438
	iters: 100, epoch: 2 | loss: 1.0189800
	speed: 0.0230s/iter; left time: 17.5502s
Updating learning rate to 0.0009997394932400223
Epoch: 2 cost time: 1.5901360511779785
Epoch: 2, Steps: 123 | Train Loss: 1.0189800 Vali Loss: 0.6055419 Best vali loss: 0.6025438
	iters: 100, epoch: 3 | loss: 0.7344124
	speed: 0.0201s/iter; left time: 12.8456s
Updating learning rate to 0.0008097462028844191
Validation loss decreased (0.6025 --> 0.5762).  Saving model state dict ...
Epoch: 3 cost time: 1.594264268875122
Epoch: 3, Steps: 123 | Train Loss: 0.7344124 Vali Loss: 0.5762257 Best vali loss: 0.5762257

best validation loss 0.5762256712948818

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0086057487695, 'e_layers': 4, 'learning_rate': 0.0011712676726, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4987489
	speed: 0.0186s/iter; left time: 9.5951s
Updating learning rate to 0.0005856338363
Validation loss decreased (0.5762 --> 0.5622).  Saving model state dict ...
Epoch: 4 cost time: 1.743873119354248
Epoch: 4, Steps: 123 | Train Loss: 0.4987489 Vali Loss: 0.5622228 Best vali loss: 0.5622228
	iters: 100, epoch: 5 | loss: 0.9490154
	speed: 0.0181s/iter; left time: 7.1212s
Updating learning rate to 0.0003615214697155809
Epoch: 5 cost time: 1.4010121822357178
Epoch: 5, Steps: 123 | Train Loss: 0.9490154 Vali Loss: 0.5674624 Best vali loss: 0.5622228
	iters: 100, epoch: 6 | loss: 0.6412783
	speed: 0.0159s/iter; left time: 4.3030s
Updating learning rate to 0.00017152817935997753
Validation loss decreased (0.5622 --> 0.5522).  Saving model state dict ...
Epoch: 6 cost time: 1.4400315284729004
Epoch: 6, Steps: 123 | Train Loss: 0.6412783 Vali Loss: 0.5521694 Best vali loss: 0.5521694
	iters: 100, epoch: 7 | loss: 0.6130332
	speed: 0.0176s/iter; left time: 2.5929s
Updating learning rate to 4.457872139636457e-05
Epoch: 7 cost time: 1.4631330966949463
Epoch: 7, Steps: 123 | Train Loss: 0.6130332 Vali Loss: 0.5555848 Best vali loss: 0.5521694
	iters: 100, epoch: 8 | loss: 0.7365064
	speed: 0.0183s/iter; left time: 0.4386s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5410864353179932
Epoch: 8, Steps: 123 | Train Loss: 0.7365064 Vali Loss: 0.5554162 Best vali loss: 0.5521694

best validation loss 0.5521693869852898

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0038403732863, 'e_layers': 4, 'learning_rate': 8.59328316e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4803217
	speed: 0.0180s/iter; left time: 138.9093s
	iters: 200, epoch: 1 | loss: 0.5911762
	speed: 0.0116s/iter; left time: 88.2625s
	iters: 300, epoch: 1 | loss: 0.4948386
	speed: 0.0112s/iter; left time: 84.3711s
	iters: 400, epoch: 1 | loss: 0.8610443
	speed: 0.0106s/iter; left time: 78.6779s
	iters: 500, epoch: 1 | loss: 0.2938699
	speed: 0.0087s/iter; left time: 64.0881s
	iters: 600, epoch: 1 | loss: 1.2576277
	speed: 0.0114s/iter; left time: 82.5377s
	iters: 700, epoch: 1 | loss: 1.3044759
	speed: 0.0115s/iter; left time: 81.6894s
	iters: 800, epoch: 1 | loss: 1.9021355
	speed: 0.0115s/iter; left time: 80.6906s
	iters: 900, epoch: 1 | loss: 1.7496823
	speed: 0.0113s/iter; left time: 78.1961s
Updating learning rate to 8.59328316e-05
Validation loss decreased (inf --> 0.6010).  Saving model state dict ...
Epoch: 1 cost time: 11.142433643341064
Epoch: 1, Steps: 979 | Train Loss: 0.9927969 Vali Loss: 0.6009855 Best vali loss: 0.6009855
	iters: 100, epoch: 2 | loss: 0.8500955
	speed: 0.0354s/iter; left time: 239.2586s
	iters: 200, epoch: 2 | loss: 0.6475112
	speed: 0.0115s/iter; left time: 76.2664s
	iters: 300, epoch: 2 | loss: 0.8900086
	speed: 0.0111s/iter; left time: 72.9167s
	iters: 400, epoch: 2 | loss: 0.5547284
	speed: 0.0116s/iter; left time: 74.9581s
	iters: 500, epoch: 2 | loss: 0.6340066
	speed: 0.0110s/iter; left time: 69.8544s
	iters: 600, epoch: 2 | loss: 1.4175208
	speed: 0.0107s/iter; left time: 66.9456s
	iters: 700, epoch: 2 | loss: 0.8500060
	speed: 0.0111s/iter; left time: 68.1781s
	iters: 800, epoch: 2 | loss: 0.6655797
	speed: 0.0114s/iter; left time: 68.9065s
	iters: 900, epoch: 2 | loss: 0.4898191
	speed: 0.0119s/iter; left time: 71.0534s
Updating learning rate to 4.29664158e-05
Validation loss decreased (0.6010 --> 0.5825).  Saving model state dict ...
Epoch: 2 cost time: 10.982339143753052
Epoch: 2, Steps: 979 | Train Loss: 0.7776973 Vali Loss: 0.5824918 Best vali loss: 0.5824918
	iters: 100, epoch: 3 | loss: 0.4360699
	speed: 0.0281s/iter; left time: 162.0140s
	iters: 200, epoch: 3 | loss: 1.2634395
	speed: 0.0111s/iter; left time: 63.0827s
	iters: 300, epoch: 3 | loss: 1.3564560
	speed: 0.0113s/iter; left time: 62.7354s
	iters: 400, epoch: 3 | loss: 0.3247212
	speed: 0.0116s/iter; left time: 63.2835s
	iters: 500, epoch: 3 | loss: 0.9913305
	speed: 0.0115s/iter; left time: 61.7142s
	iters: 600, epoch: 3 | loss: 0.9007778
	speed: 0.0115s/iter; left time: 60.7349s
	iters: 700, epoch: 3 | loss: 0.8501521
	speed: 0.0116s/iter; left time: 59.8987s
	iters: 800, epoch: 3 | loss: 0.9905556
	speed: 0.0116s/iter; left time: 59.0911s
	iters: 900, epoch: 3 | loss: 0.7894459
	speed: 0.0110s/iter; left time: 54.7998s
Updating learning rate to 2.14832079e-05
Validation loss decreased (0.5825 --> 0.5630).  Saving model state dict ...
Epoch: 3 cost time: 10.996886014938354
Epoch: 3, Steps: 979 | Train Loss: 0.8781054 Vali Loss: 0.5629596 Best vali loss: 0.5629596
	iters: 100, epoch: 4 | loss: 1.0577282
	speed: 0.0344s/iter; left time: 165.1687s
	iters: 200, epoch: 4 | loss: 0.5543116
	speed: 0.0103s/iter; left time: 48.2859s
	iters: 300, epoch: 4 | loss: 1.3464023
	speed: 0.0098s/iter; left time: 45.2361s
	iters: 400, epoch: 4 | loss: 0.9677775
	speed: 0.0118s/iter; left time: 53.2374s
	iters: 500, epoch: 4 | loss: 0.6782358
	speed: 0.0119s/iter; left time: 52.4537s
	iters: 600, epoch: 4 | loss: 0.5051818
	speed: 0.0119s/iter; left time: 50.9516s
	iters: 700, epoch: 4 | loss: 0.5096741
	speed: 0.0126s/iter; left time: 53.0713s
	iters: 800, epoch: 4 | loss: 0.2562742
	speed: 0.0128s/iter; left time: 52.6111s
	iters: 900, epoch: 4 | loss: 0.5137453
	speed: 0.0097s/iter; left time: 38.6690s
Updating learning rate to 1.074160395e-05
Validation loss decreased (0.5630 --> 0.5561).  Saving model state dict ...
Epoch: 4 cost time: 11.072845697402954
Epoch: 4, Steps: 979 | Train Loss: 0.7099256 Vali Loss: 0.5561181 Best vali loss: 0.5561181
	iters: 100, epoch: 5 | loss: 1.3130745
	speed: 0.0314s/iter; left time: 120.0303s
	iters: 200, epoch: 5 | loss: 0.5760518
	speed: 0.0101s/iter; left time: 37.3683s
	iters: 300, epoch: 5 | loss: 1.2228273
	speed: 0.0110s/iter; left time: 39.9523s
	iters: 400, epoch: 5 | loss: 0.5123233
	speed: 0.0103s/iter; left time: 36.2107s
	iters: 500, epoch: 5 | loss: 0.8132021
	speed: 0.0097s/iter; left time: 33.0745s
	iters: 600, epoch: 5 | loss: 0.7524784
	speed: 0.0094s/iter; left time: 31.2920s
	iters: 700, epoch: 5 | loss: 0.4015077
	speed: 0.0100s/iter; left time: 32.0222s
	iters: 800, epoch: 5 | loss: 0.6068936
	speed: 0.0104s/iter; left time: 32.4166s
	iters: 900, epoch: 5 | loss: 0.8616951
	speed: 0.0109s/iter; left time: 32.8143s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0062483566964, 'e_layers': 3, 'learning_rate': 0.0001625782347, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9634225
	speed: 0.0153s/iter; left time: 58.4617s
	iters: 200, epoch: 1 | loss: 0.8582481
	speed: 0.0090s/iter; left time: 33.3036s
	iters: 300, epoch: 1 | loss: 0.5565069
	speed: 0.0120s/iter; left time: 43.5552s
	iters: 400, epoch: 1 | loss: 0.8886847
	speed: 0.0096s/iter; left time: 33.6887s
Updating learning rate to 0.00015639046908557313
Validation loss decreased (inf --> 0.6121).  Saving model state dict ...
Epoch: 1 cost time: 5.135482549667358
Epoch: 1, Steps: 490 | Train Loss: 0.8167156 Vali Loss: 0.6120908 Best vali loss: 0.6120908
	iters: 100, epoch: 2 | loss: 0.7072954
	speed: 0.0252s/iter; left time: 83.8821s
	iters: 200, epoch: 2 | loss: 0.4275913
	speed: 0.0089s/iter; left time: 28.7120s
	iters: 300, epoch: 2 | loss: 0.7880281
	speed: 0.0090s/iter; left time: 28.0660s
	iters: 400, epoch: 2 | loss: 1.1987082
	speed: 0.0100s/iter; left time: 30.2134s
Updating learning rate to 0.00013876920346485403
Validation loss decreased (0.6121 --> 0.6066).  Saving model state dict ...
Epoch: 2 cost time: 4.475768089294434
Epoch: 2, Steps: 490 | Train Loss: 0.7804058 Vali Loss: 0.6066421 Best vali loss: 0.6066421
	iters: 100, epoch: 3 | loss: 0.6756836
	speed: 0.0238s/iter; left time: 67.6397s
	iters: 200, epoch: 3 | loss: 0.9971864
	speed: 0.0093s/iter; left time: 25.4567s
	iters: 300, epoch: 3 | loss: 1.1626072
	speed: 0.0092s/iter; left time: 24.2311s
	iters: 400, epoch: 3 | loss: 0.8798282
	speed: 0.0106s/iter; left time: 26.9145s
Updating learning rate to 0.00011239711579142658
Validation loss decreased (0.6066 --> 0.5797).  Saving model state dict ...
Epoch: 3 cost time: 4.477931976318359
Epoch: 3, Steps: 490 | Train Loss: 0.9288263 Vali Loss: 0.5797483 Best vali loss: 0.5797483
	iters: 100, epoch: 4 | loss: 0.3713219
	speed: 0.0273s/iter; left time: 64.0731s
	iters: 200, epoch: 4 | loss: 0.5814337
	speed: 0.0112s/iter; left time: 25.1448s
	iters: 300, epoch: 4 | loss: 0.7404590
	speed: 0.0118s/iter; left time: 25.4529s
	iters: 400, epoch: 4 | loss: 0.8915358
	speed: 0.0118s/iter; left time: 24.1183s
Updating learning rate to 8.128911735e-05
Validation loss decreased (0.5797 --> 0.5630).  Saving model state dict ...
Epoch: 4 cost time: 5.761563539505005
Epoch: 4, Steps: 490 | Train Loss: 0.6461876 Vali Loss: 0.5629821 Best vali loss: 0.5629821
	iters: 100, epoch: 5 | loss: 0.6831475
	speed: 0.0306s/iter; left time: 57.0058s
	iters: 200, epoch: 5 | loss: 0.3819023
	speed: 0.0066s/iter; left time: 11.6033s
	iters: 300, epoch: 5 | loss: 0.4520128
	speed: 0.0090s/iter; left time: 14.9479s
	iters: 400, epoch: 5 | loss: 0.6705241
	speed: 0.0087s/iter; left time: 13.5344s
Updating learning rate to 5.018111890857343e-05
Validation loss decreased (0.5630 --> 0.5508).  Saving model state dict ...
Epoch: 5 cost time: 4.253634691238403
Epoch: 5, Steps: 490 | Train Loss: 0.5468967 Vali Loss: 0.5508124 Best vali loss: 0.5508124
	iters: 100, epoch: 6 | loss: 0.3406699
	speed: 0.0252s/iter; left time: 34.5672s
	iters: 200, epoch: 6 | loss: 0.8366202
	speed: 0.0117s/iter; left time: 14.8630s
	iters: 300, epoch: 6 | loss: 0.4351358
	speed: 0.0097s/iter; left time: 11.3965s
	iters: 400, epoch: 6 | loss: 0.5468491
	speed: 0.0098s/iter; left time: 10.5448s
Updating learning rate to 2.3809031235145972e-05
Epoch: 6 cost time: 5.010052919387817
Epoch: 6, Steps: 490 | Train Loss: 0.5398187 Vali Loss: 0.5559305 Best vali loss: 0.5508124
	iters: 100, epoch: 7 | loss: 0.5278218
	speed: 0.0272s/iter; left time: 23.9888s
	iters: 200, epoch: 7 | loss: 1.1118000
	speed: 0.0114s/iter; left time: 8.9221s
	iters: 300, epoch: 7 | loss: 0.7236664
	speed: 0.0098s/iter; left time: 6.6916s
	iters: 400, epoch: 7 | loss: 0.3870443
	speed: 0.0093s/iter; left time: 5.4205s
Updating learning rate to 6.187765614426872e-06
Epoch: 7 cost time: 4.950972318649292
Epoch: 7, Steps: 490 | Train Loss: 0.6875831 Vali Loss: 0.5590725 Best vali loss: 0.5508124
	iters: 100, epoch: 8 | loss: 0.6468380
	speed: 0.0261s/iter; left time: 10.1986s
	iters: 200, epoch: 8 | loss: 0.4838679
	speed: 0.0111s/iter; left time: 3.2211s
	iters: 300, epoch: 8 | loss: 0.3967670
	speed: 0.0087s/iter; left time: 1.6697s
	iters: 400, epoch: 8 | loss: 0.4899313
	speed: 0.0071s/iter; left time: 0.6472s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.514830589294434
Epoch: 8, Steps: 490 | Train Loss: 0.5043511 Vali Loss: 0.5580008 Best vali loss: 0.5508124

best validation loss 0.5508123751193602

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015206249299, 'e_layers': 4, 'learning_rate': 0.0036651766384, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7730466
	speed: 0.0187s/iter; left time: 71.3647s
	iters: 200, epoch: 1 | loss: 0.9082387
	speed: 0.0091s/iter; left time: 33.8139s
	iters: 300, epoch: 1 | loss: 0.8506308
	speed: 0.0091s/iter; left time: 32.9924s
	iters: 400, epoch: 1 | loss: 0.7768091
	speed: 0.0093s/iter; left time: 32.8758s
Updating learning rate to 0.0035256791588281406
Validation loss decreased (inf --> 0.6423).  Saving model state dict ...
Epoch: 1 cost time: 5.15253210067749
Epoch: 1, Steps: 490 | Train Loss: 0.8271813 Vali Loss: 0.6423101 Best vali loss: 0.6423101
	iters: 100, epoch: 2 | loss: 0.7839007
	speed: 0.0281s/iter; left time: 93.5158s
	iters: 200, epoch: 2 | loss: 0.8058933
	speed: 0.0095s/iter; left time: 30.5742s
	iters: 300, epoch: 2 | loss: 1.1974150
	speed: 0.0092s/iter; left time: 28.7934s
	iters: 400, epoch: 2 | loss: 0.7579511
	speed: 0.0097s/iter; left time: 29.3729s
Updating learning rate to 0.0031284239468295774
Epoch: 2 cost time: 4.975252389907837
Epoch: 2, Steps: 490 | Train Loss: 0.8862900 Vali Loss: 0.6545225 Best vali loss: 0.6423101
	iters: 100, epoch: 3 | loss: 1.3387145
	speed: 0.0269s/iter; left time: 76.4444s
	iters: 200, epoch: 3 | loss: 1.2093301
	speed: 0.0078s/iter; left time: 21.3306s
	iters: 300, epoch: 3 | loss: 1.2133429
	speed: 0.0094s/iter; left time: 24.8159s
	iters: 400, epoch: 3 | loss: 1.1941642
	speed: 0.0142s/iter; left time: 36.2015s
Updating learning rate to 0.0025338895073036267
Epoch: 3 cost time: 5.747162342071533
Epoch: 3, Steps: 490 | Train Loss: 1.2388879 Vali Loss: 0.6474429 Best vali loss: 0.6423101

best validation loss 0.6423100747757629

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0022191591884, 'e_layers': 1, 'learning_rate': 0.0008050296962, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0444487
	speed: 0.0262s/iter; left time: 48.8229s
	iters: 200, epoch: 1 | loss: 0.6974460
	speed: 0.0087s/iter; left time: 15.3165s
Updating learning rate to 0.0007743900777914795
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 4.022878885269165
Epoch: 1, Steps: 245 | Train Loss: 0.8709474 Vali Loss: 0.6047934 Best vali loss: 0.6047934
	iters: 100, epoch: 2 | loss: 0.6463873
	speed: 0.0544s/iter; left time: 87.9330s
	iters: 200, epoch: 2 | loss: 1.0441703
	speed: 0.0223s/iter; left time: 33.7598s
Updating learning rate to 0.0006871358267197831
Validation loss decreased (0.6048 --> 0.5997).  Saving model state dict ...
Epoch: 2 cost time: 5.344214916229248
Epoch: 2, Steps: 245 | Train Loss: 0.8452788 Vali Loss: 0.5996503 Best vali loss: 0.5996503
	iters: 100, epoch: 3 | loss: 1.0847038
	speed: 0.0579s/iter; left time: 79.3496s
	iters: 200, epoch: 3 | loss: 0.5821793
	speed: 0.0194s/iter; left time: 24.6490s
Updating learning rate to 0.0005565506117488207
Validation loss decreased (0.5997 --> 0.5966).  Saving model state dict ...
Epoch: 3 cost time: 4.940428972244263
Epoch: 3, Steps: 245 | Train Loss: 0.8334416 Vali Loss: 0.5966023 Best vali loss: 0.5966023

best validation loss 0.5966023126447273

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0099469591313, 'e_layers': 2, 'learning_rate': 6.1204951e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.1204951e-05
Validation loss decreased (inf --> 0.6148).  Saving model state dict ...
Epoch: 1 cost time: 2.476985454559326
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6147729 Best vali loss: 0.6147729
Updating learning rate to 3.06024755e-05
Validation loss decreased (0.6148 --> 0.6042).  Saving model state dict ...
Epoch: 2 cost time: 2.805513620376587
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6042468 Best vali loss: 0.6042468
Updating learning rate to 1.530123775e-05
Validation loss decreased (0.6042 --> 0.5976).  Saving model state dict ...
Epoch: 3 cost time: 1.007166862487793
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5976336 Best vali loss: 0.5976336

best validation loss 0.5976335642956738

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0022191591884, 'e_layers': 1, 'learning_rate': 0.0008050296962, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9996760
	speed: 0.0138s/iter; left time: 15.5121s
	iters: 200, epoch: 4 | loss: 0.6739888
	speed: 0.0080s/iter; left time: 8.2366s
Updating learning rate to 0.0004025148481
Validation loss decreased (0.5966 --> 0.5941).  Saving model state dict ...
Epoch: 4 cost time: 2.161547899246216
Epoch: 4, Steps: 245 | Train Loss: 0.8368324 Vali Loss: 0.5941318 Best vali loss: 0.5941318
	iters: 100, epoch: 5 | loss: 0.5906171
	speed: 0.0155s/iter; left time: 13.6962s
	iters: 200, epoch: 5 | loss: 0.9826065
	speed: 0.0068s/iter; left time: 5.3425s
Updating learning rate to 0.00024847908445117925
Epoch: 5 cost time: 1.8659648895263672
Epoch: 5, Steps: 245 | Train Loss: 0.7866118 Vali Loss: 0.6056811 Best vali loss: 0.5941318
	iters: 100, epoch: 6 | loss: 1.0466884
	speed: 0.0148s/iter; left time: 9.4331s
	iters: 200, epoch: 6 | loss: 0.5532243
	speed: 0.0069s/iter; left time: 3.6772s
Updating learning rate to 0.0001178938694802169
Epoch: 6 cost time: 1.5975680351257324
Epoch: 6, Steps: 245 | Train Loss: 0.7999564 Vali Loss: 0.6098653 Best vali loss: 0.5941318
	iters: 100, epoch: 7 | loss: 0.7613735
	speed: 0.0090s/iter; left time: 3.5242s
	iters: 200, epoch: 7 | loss: 0.8541849
	speed: 0.0072s/iter; left time: 2.0911s
Updating learning rate to 3.0639618408520406e-05
Epoch: 7 cost time: 1.464811086654663
Epoch: 7, Steps: 245 | Train Loss: 0.8077792 Vali Loss: 0.6182708 Best vali loss: 0.5941318
	iters: 100, epoch: 8 | loss: 0.8390405
	speed: 0.0139s/iter; left time: 2.0288s
	iters: 200, epoch: 8 | loss: 0.6975670
	speed: 0.0070s/iter; left time: 0.3216s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7437028884887695
Epoch: 8, Steps: 245 | Train Loss: 0.7683038 Vali Loss: 0.6159525 Best vali loss: 0.5941318

best validation loss 0.5941317974831538

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013022659604, 'e_layers': 1, 'learning_rate': 0.0001882118338, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9337672
	speed: 0.0138s/iter; left time: 25.7305s
	iters: 200, epoch: 1 | loss: 1.2590703
	speed: 0.0076s/iter; left time: 13.3037s
Updating learning rate to 0.000181048447412118
Validation loss decreased (inf --> 0.6228).  Saving model state dict ...
Epoch: 1 cost time: 2.1957647800445557
Epoch: 1, Steps: 245 | Train Loss: 1.0964187 Vali Loss: 0.6227514 Best vali loss: 0.6227514
	iters: 100, epoch: 2 | loss: 1.0857379
	speed: 0.0149s/iter; left time: 24.1317s
	iters: 200, epoch: 2 | loss: 0.6088936
	speed: 0.0042s/iter; left time: 6.3573s
Updating learning rate to 0.00016064884888976772
Validation loss decreased (0.6228 --> 0.6059).  Saving model state dict ...
Epoch: 2 cost time: 1.3225176334381104
Epoch: 2, Steps: 245 | Train Loss: 0.8473158 Vali Loss: 0.6058946 Best vali loss: 0.6058946
	iters: 100, epoch: 3 | loss: 1.1832798
	speed: 0.0089s/iter; left time: 12.1648s
	iters: 200, epoch: 3 | loss: 0.8129983
	speed: 0.0040s/iter; left time: 5.0258s
Updating learning rate to 0.0001301186921851559
Validation loss decreased (0.6059 --> 0.6027).  Saving model state dict ...
Epoch: 3 cost time: 1.020263910293579
Epoch: 3, Steps: 245 | Train Loss: 0.9981390 Vali Loss: 0.6027342 Best vali loss: 0.6027342
	iters: 100, epoch: 4 | loss: 0.7965230
	speed: 0.0094s/iter; left time: 10.6066s
	iters: 200, epoch: 4 | loss: 0.6452454
	speed: 0.0070s/iter; left time: 7.1981s
Updating learning rate to 9.41059169e-05
Epoch: 4 cost time: 1.5489778518676758
Epoch: 4, Steps: 245 | Train Loss: 0.7208842 Vali Loss: 0.6033851 Best vali loss: 0.6027342
	iters: 100, epoch: 5 | loss: 0.6134653
	speed: 0.0149s/iter; left time: 13.1430s
	iters: 200, epoch: 5 | loss: 0.8595316
	speed: 0.0073s/iter; left time: 5.6635s
Updating learning rate to 5.809314161484409e-05
Validation loss decreased (0.6027 --> 0.5977).  Saving model state dict ...
Epoch: 5 cost time: 1.796750545501709
Epoch: 5, Steps: 245 | Train Loss: 0.7364985 Vali Loss: 0.5977284 Best vali loss: 0.5977284
	iters: 100, epoch: 6 | loss: 0.6863623
	speed: 0.0140s/iter; left time: 8.8905s
	iters: 200, epoch: 6 | loss: 1.0474666
	speed: 0.0071s/iter; left time: 3.8111s
Updating learning rate to 2.756298491023228e-05
Epoch: 6 cost time: 1.8008828163146973
Epoch: 6, Steps: 245 | Train Loss: 0.8669145 Vali Loss: 0.5982000 Best vali loss: 0.5977284
	iters: 100, epoch: 7 | loss: 0.6315368
	speed: 0.0149s/iter; left time: 5.8403s
	iters: 200, epoch: 7 | loss: 0.5241143
	speed: 0.0067s/iter; left time: 1.9386s
Updating learning rate to 7.163386387882002e-06
Epoch: 7 cost time: 1.7339026927947998
Epoch: 7, Steps: 245 | Train Loss: 0.5778255 Vali Loss: 0.5985613 Best vali loss: 0.5977284
	iters: 100, epoch: 8 | loss: 0.7722555
	speed: 0.0131s/iter; left time: 1.9180s
	iters: 200, epoch: 8 | loss: 0.7512953
	speed: 0.0041s/iter; left time: 0.1887s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0846176147460938
Epoch: 8, Steps: 245 | Train Loss: 0.7617754 Vali Loss: 0.5986518 Best vali loss: 0.5977284

best validation loss 0.5977284153651882

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1083905
	speed: 0.0107s/iter; left time: 82.5350s
	iters: 200, epoch: 1 | loss: 0.3494157
	speed: 0.0045s/iter; left time: 34.6468s
	iters: 300, epoch: 1 | loss: 1.1818764
	speed: 0.0050s/iter; left time: 37.6684s
	iters: 400, epoch: 1 | loss: 0.2713904
	speed: 0.0050s/iter; left time: 37.4328s
	iters: 500, epoch: 1 | loss: 0.7680331
	speed: 0.0045s/iter; left time: 32.8532s
	iters: 600, epoch: 1 | loss: 1.0849718
	speed: 0.0047s/iter; left time: 34.1058s
	iters: 700, epoch: 1 | loss: 1.3649000
	speed: 0.0042s/iter; left time: 30.2105s
	iters: 800, epoch: 1 | loss: 0.9630911
	speed: 0.0042s/iter; left time: 29.5309s
	iters: 900, epoch: 1 | loss: 0.3378339
	speed: 0.0038s/iter; left time: 26.6074s
Updating learning rate to 0.00022273671327002105
Validation loss decreased (inf --> 0.6038).  Saving model state dict ...
Epoch: 1 cost time: 4.6862952709198
Epoch: 1, Steps: 979 | Train Loss: 0.8255448 Vali Loss: 0.6037970 Best vali loss: 0.6037970
	iters: 100, epoch: 2 | loss: 1.2605649
	speed: 0.0169s/iter; left time: 114.2414s
	iters: 200, epoch: 2 | loss: 1.3668095
	speed: 0.0045s/iter; left time: 29.9923s
	iters: 300, epoch: 2 | loss: 0.9117743
	speed: 0.0045s/iter; left time: 29.5847s
	iters: 400, epoch: 2 | loss: 0.6384427
	speed: 0.0043s/iter; left time: 27.9056s
	iters: 500, epoch: 2 | loss: 0.3486196
	speed: 0.0044s/iter; left time: 28.1895s
	iters: 600, epoch: 2 | loss: 1.2048638
	speed: 0.0044s/iter; left time: 27.6349s
	iters: 700, epoch: 2 | loss: 0.8795097
	speed: 0.0045s/iter; left time: 27.7895s
	iters: 800, epoch: 2 | loss: 0.6216857
	speed: 0.0045s/iter; left time: 27.4373s
	iters: 900, epoch: 2 | loss: 0.5188810
	speed: 0.0043s/iter; left time: 25.7783s
Updating learning rate to 0.00019763989751797302
Epoch: 2 cost time: 4.417949914932251
Epoch: 2, Steps: 979 | Train Loss: 0.8612390 Vali Loss: 0.6050524 Best vali loss: 0.6037970
	iters: 100, epoch: 3 | loss: 0.3247709
	speed: 0.0172s/iter; left time: 99.3386s
	iters: 200, epoch: 3 | loss: 0.9518443
	speed: 0.0044s/iter; left time: 24.9432s
	iters: 300, epoch: 3 | loss: 1.1379594
	speed: 0.0044s/iter; left time: 24.6692s
	iters: 400, epoch: 3 | loss: 0.4969085
	speed: 0.0046s/iter; left time: 25.2133s
	iters: 500, epoch: 3 | loss: 0.9873067
	speed: 0.0046s/iter; left time: 24.9787s
	iters: 600, epoch: 3 | loss: 1.0423096
	speed: 0.0047s/iter; left time: 24.9110s
	iters: 700, epoch: 3 | loss: 0.4822017
	speed: 0.0047s/iter; left time: 24.4481s
	iters: 800, epoch: 3 | loss: 0.5732671
	speed: 0.0045s/iter; left time: 22.8293s
	iters: 900, epoch: 3 | loss: 0.6426853
	speed: 0.0044s/iter; left time: 21.9397s
Updating learning rate to 0.00016007985843890398
Validation loss decreased (0.6038 --> 0.6037).  Saving model state dict ...
Epoch: 3 cost time: 4.458284854888916
Epoch: 3, Steps: 979 | Train Loss: 0.7376948 Vali Loss: 0.6037165 Best vali loss: 0.6037165
	iters: 100, epoch: 4 | loss: 0.5533454
	speed: 0.0171s/iter; left time: 81.8723s
	iters: 200, epoch: 4 | loss: 0.5845584
	speed: 0.0042s/iter; left time: 19.8661s
	iters: 300, epoch: 4 | loss: 0.5407821
	speed: 0.0040s/iter; left time: 18.5286s
	iters: 400, epoch: 4 | loss: 0.5957260
	speed: 0.0039s/iter; left time: 17.3486s
	iters: 500, epoch: 4 | loss: 0.3529230
	speed: 0.0066s/iter; left time: 28.8301s
	iters: 600, epoch: 4 | loss: 0.6084920
	speed: 0.0066s/iter; left time: 28.1838s
	iters: 700, epoch: 4 | loss: 0.7328591
	speed: 0.0061s/iter; left time: 25.7456s
	iters: 800, epoch: 4 | loss: 0.2716782
	speed: 0.0068s/iter; left time: 27.8005s
	iters: 900, epoch: 4 | loss: 0.2933393
	speed: 0.0079s/iter; left time: 31.6336s
Updating learning rate to 0.0001157747715
Epoch: 4 cost time: 5.615710258483887
Epoch: 4, Steps: 979 | Train Loss: 0.5037448 Vali Loss: 0.6198649 Best vali loss: 0.6037165
	iters: 100, epoch: 5 | loss: 1.0782242
	speed: 0.0265s/iter; left time: 101.1464s
	iters: 200, epoch: 5 | loss: 0.4242962
	speed: 0.0057s/iter; left time: 21.1500s
	iters: 300, epoch: 5 | loss: 0.5247847
	speed: 0.0040s/iter; left time: 14.4569s
	iters: 400, epoch: 5 | loss: 0.7315601
	speed: 0.0039s/iter; left time: 13.8765s
	iters: 500, epoch: 5 | loss: 0.3241123
	speed: 0.0059s/iter; left time: 20.1929s
	iters: 600, epoch: 5 | loss: 0.8246649
	speed: 0.0060s/iter; left time: 20.0308s
	iters: 700, epoch: 5 | loss: 0.3205568
	speed: 0.0053s/iter; left time: 17.0821s
	iters: 800, epoch: 5 | loss: 0.8400027
	speed: 0.0060s/iter; left time: 18.6444s
	iters: 900, epoch: 5 | loss: 1.1335601
	speed: 0.0076s/iter; left time: 22.7809s
Updating learning rate to 7.146968456109603e-05
Epoch: 5 cost time: 5.713691234588623
Epoch: 5, Steps: 979 | Train Loss: 0.6890846 Vali Loss: 0.6235668 Best vali loss: 0.6037165
	iters: 100, epoch: 6 | loss: 0.5758744
	speed: 0.0276s/iter; left time: 78.2996s
	iters: 200, epoch: 6 | loss: 0.4123290
	speed: 0.0065s/iter; left time: 17.8857s
	iters: 300, epoch: 6 | loss: 0.4333268
	speed: 0.0066s/iter; left time: 17.5158s
	iters: 400, epoch: 6 | loss: 1.1186632
	speed: 0.0062s/iter; left time: 15.7150s
	iters: 500, epoch: 6 | loss: 0.5064611
	speed: 0.0068s/iter; left time: 16.5817s
	iters: 600, epoch: 6 | loss: 0.5899368
	speed: 0.0093s/iter; left time: 21.8530s
	iters: 700, epoch: 6 | loss: 0.8861929
	speed: 0.0083s/iter; left time: 18.4857s
	iters: 800, epoch: 6 | loss: 1.2208540
	speed: 0.0091s/iter; left time: 19.5298s
	iters: 900, epoch: 6 | loss: 0.6404296
	speed: 0.0093s/iter; left time: 19.0355s
Updating learning rate to 3.390964548202697e-05
Epoch: 6 cost time: 7.4892418384552
Epoch: 6, Steps: 979 | Train Loss: 0.7093409 Vali Loss: 0.6433231 Best vali loss: 0.6037165
	iters: 100, epoch: 7 | loss: 0.9205502
	speed: 0.0234s/iter; left time: 43.5594s
	iters: 200, epoch: 7 | loss: 2.0932376
	speed: 0.0062s/iter; left time: 10.8607s
	iters: 300, epoch: 7 | loss: 0.4439651
	speed: 0.0064s/iter; left time: 10.5841s
	iters: 400, epoch: 7 | loss: 0.2795321
	speed: 0.0069s/iter; left time: 10.7483s
	iters: 500, epoch: 7 | loss: 0.4014851
	speed: 0.0068s/iter; left time: 9.8570s
	iters: 600, epoch: 7 | loss: 0.5542235
	speed: 0.0067s/iter; left time: 9.1137s
	iters: 700, epoch: 7 | loss: 0.2900786
	speed: 0.0068s/iter; left time: 8.5498s
	iters: 800, epoch: 7 | loss: 1.2082078
	speed: 0.0069s/iter; left time: 7.9441s
	iters: 900, epoch: 7 | loss: 0.7255853
	speed: 0.0065s/iter; left time: 6.9241s
Updating learning rate to 8.812829729978956e-06
Epoch: 7 cost time: 6.622751951217651
Epoch: 7, Steps: 979 | Train Loss: 0.7685406 Vali Loss: 0.6411517 Best vali loss: 0.6037165
	iters: 100, epoch: 8 | loss: 0.3841569
	speed: 0.0238s/iter; left time: 20.9256s
	iters: 200, epoch: 8 | loss: 0.9128035
	speed: 0.0063s/iter; left time: 4.9006s
	iters: 300, epoch: 8 | loss: 1.4281565
	speed: 0.0062s/iter; left time: 4.2014s
	iters: 400, epoch: 8 | loss: 0.2970155
	speed: 0.0061s/iter; left time: 3.5647s
	iters: 500, epoch: 8 | loss: 0.2646286
	speed: 0.0060s/iter; left time: 2.8700s
	iters: 600, epoch: 8 | loss: 0.6719857
	speed: 0.0063s/iter; left time: 2.3997s
	iters: 700, epoch: 8 | loss: 1.1480585
	speed: 0.0070s/iter; left time: 1.9500s
	iters: 800, epoch: 8 | loss: 0.7527139
	speed: 0.0067s/iter; left time: 1.2084s
	iters: 900, epoch: 8 | loss: 0.7074898
	speed: 0.0072s/iter; left time: 0.5746s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.428406000137329
Epoch: 8, Steps: 979 | Train Loss: 0.7296677 Vali Loss: 0.6442587 Best vali loss: 0.6037165

best validation loss 0.6037164615266359

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9445573
	speed: 0.0154s/iter; left time: 58.8061s
	iters: 200, epoch: 1 | loss: 1.0688475
	speed: 0.0085s/iter; left time: 31.7515s
	iters: 300, epoch: 1 | loss: 0.7976415
	speed: 0.0085s/iter; left time: 30.9128s
	iters: 400, epoch: 1 | loss: 1.1371851
	speed: 0.0085s/iter; left time: 29.7920s
Updating learning rate to 0.0005359963767340445
Validation loss decreased (inf --> 0.6120).  Saving model state dict ...
Epoch: 1 cost time: 4.531777381896973
Epoch: 1, Steps: 490 | Train Loss: 0.9870579 Vali Loss: 0.6120056 Best vali loss: 0.6120056
	iters: 100, epoch: 2 | loss: 0.8344916
	speed: 0.0277s/iter; left time: 92.3840s
	iters: 200, epoch: 2 | loss: 1.3885373
	speed: 0.0086s/iter; left time: 27.7860s
	iters: 300, epoch: 2 | loss: 0.9699014
	speed: 0.0085s/iter; left time: 26.6043s
	iters: 400, epoch: 2 | loss: 0.4591025
	speed: 0.0087s/iter; left time: 26.4232s
Updating learning rate to 0.00047560308946149616
Validation loss decreased (0.6120 --> 0.5830).  Saving model state dict ...
Epoch: 2 cost time: 4.284941673278809
Epoch: 2, Steps: 490 | Train Loss: 0.9130082 Vali Loss: 0.5829679 Best vali loss: 0.5829679
	iters: 100, epoch: 3 | loss: 0.6223609
	speed: 0.0265s/iter; left time: 75.1729s
	iters: 200, epoch: 3 | loss: 0.7112370
	speed: 0.0085s/iter; left time: 23.2060s
	iters: 300, epoch: 3 | loss: 0.8949140
	speed: 0.0084s/iter; left time: 22.2076s
	iters: 400, epoch: 3 | loss: 0.9010475
	speed: 0.0086s/iter; left time: 21.8538s
Updating learning rate to 0.0003852181477030879
Validation loss decreased (0.5830 --> 0.5747).  Saving model state dict ...
Epoch: 3 cost time: 4.314278841018677
Epoch: 3, Steps: 490 | Train Loss: 0.7823898 Vali Loss: 0.5747153 Best vali loss: 0.5747153

best validation loss 0.5747152695717607

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021887918326, 'e_layers': 3, 'learning_rate': 0.0046350312805, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6007995
	speed: 0.0160s/iter; left time: 29.7947s
	iters: 200, epoch: 1 | loss: 0.5387203
	speed: 0.0092s/iter; left time: 16.1879s
Updating learning rate to 0.004458620906551766
Validation loss decreased (inf --> 0.6456).  Saving model state dict ...
Epoch: 1 cost time: 2.6371755599975586
Epoch: 1, Steps: 245 | Train Loss: 0.5697599 Vali Loss: 0.6456231 Best vali loss: 0.6456231
	iters: 100, epoch: 2 | loss: 0.8721285
	speed: 0.0183s/iter; left time: 29.6200s
	iters: 200, epoch: 2 | loss: 0.8915265
	speed: 0.0107s/iter; left time: 16.1619s
Updating learning rate to 0.003956246664976659
Validation loss decreased (0.6456 --> 0.6375).  Saving model state dict ...
Epoch: 2 cost time: 2.590071201324463
Epoch: 2, Steps: 245 | Train Loss: 0.8818275 Vali Loss: 0.6375169 Best vali loss: 0.6375169
	iters: 100, epoch: 3 | loss: 0.8526794
	speed: 0.0157s/iter; left time: 21.5351s
	iters: 200, epoch: 3 | loss: 0.4973808
	speed: 0.0063s/iter; left time: 7.9983s
Updating learning rate to 0.003204390480020649
Epoch: 3 cost time: 1.6364662647247314
Epoch: 3, Steps: 245 | Train Loss: 0.6750301 Vali Loss: 0.6383558 Best vali loss: 0.6375169

best validation loss 0.6375168661782169

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008416951448, 'e_layers': 2, 'learning_rate': 0.0004829801385, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004645978015348082
Validation loss decreased (inf --> 0.5987).  Saving model state dict ...
Epoch: 1 cost time: 0.9089837074279785
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5987387 Best vali loss: 0.5987387
Updating learning rate to 0.0004122493348058839
Epoch: 2 cost time: 0.6353585720062256
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6144961 Best vali loss: 0.5987387
Updating learning rate to 0.0003339043178326732
Validation loss decreased (0.5987 --> 0.5461).  Saving model state dict ...
Epoch: 3 cost time: 0.6284058094024658
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5461336 Best vali loss: 0.5461336

best validation loss 0.5461335959174135

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008416951448, 'e_layers': 2, 'learning_rate': 0.0004829801385, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00024149006925
Epoch: 4 cost time: 0.9168717861175537
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5495029 Best vali loss: 0.5461336
Updating learning rate to 0.00014907582066732677
Epoch: 5 cost time: 1.023486852645874
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5569505 Best vali loss: 0.5461336
Updating learning rate to 7.073080369411606e-05
Epoch: 6 cost time: 0.6500811576843262
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5578513 Best vali loss: 0.5461336
Updating learning rate to 1.838233696519174e-05
Epoch: 7 cost time: 0.6278519630432129
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5554648 Best vali loss: 0.5461336
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6458249092102051
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5517254 Best vali loss: 0.5461336

best validation loss 0.5461335959174135

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010061079077, 'e_layers': 4, 'learning_rate': 0.0003121493614, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2497331
	speed: 0.0170s/iter; left time: 131.3487s
	iters: 200, epoch: 1 | loss: 0.2871686
	speed: 0.0093s/iter; left time: 70.9997s
	iters: 300, epoch: 1 | loss: 1.0586649
	speed: 0.0085s/iter; left time: 64.4031s
	iters: 400, epoch: 1 | loss: 0.7047011
	speed: 0.0099s/iter; left time: 73.3670s
	iters: 500, epoch: 1 | loss: 0.5711073
	speed: 0.0100s/iter; left time: 73.5104s
	iters: 600, epoch: 1 | loss: 0.2490260
	speed: 0.0109s/iter; left time: 78.5757s
	iters: 700, epoch: 1 | loss: 0.7633997
	speed: 0.0085s/iter; left time: 60.7085s
	iters: 800, epoch: 1 | loss: 1.3983742
	speed: 0.0085s/iter; left time: 59.4734s
	iters: 900, epoch: 1 | loss: 1.1156579
	speed: 0.0104s/iter; left time: 72.2468s
Updating learning rate to 0.00030026888374196434
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 9.916686058044434
Epoch: 1, Steps: 979 | Train Loss: 0.8219814 Vali Loss: 0.6089959 Best vali loss: 0.6089959
	iters: 100, epoch: 2 | loss: 0.5132892
	speed: 0.0409s/iter; left time: 276.4499s
	iters: 200, epoch: 2 | loss: 0.9633321
	speed: 0.0118s/iter; left time: 78.4728s
	iters: 300, epoch: 2 | loss: 0.5099658
	speed: 0.0095s/iter; left time: 61.9992s
	iters: 400, epoch: 2 | loss: 0.3257458
	speed: 0.0162s/iter; left time: 104.7929s
	iters: 500, epoch: 2 | loss: 0.6810436
	speed: 0.0163s/iter; left time: 103.8276s
	iters: 600, epoch: 2 | loss: 1.0935773
	speed: 0.0119s/iter; left time: 74.6028s
	iters: 700, epoch: 2 | loss: 1.2278854
	speed: 0.0111s/iter; left time: 68.2966s
	iters: 800, epoch: 2 | loss: 0.4883349
	speed: 0.0166s/iter; left time: 100.7937s
	iters: 900, epoch: 2 | loss: 0.5397077
	speed: 0.0178s/iter; left time: 105.7641s
Updating learning rate to 0.0002664361457944952
Validation loss decreased (0.6090 --> 0.6023).  Saving model state dict ...
Epoch: 2 cost time: 13.715810775756836
Epoch: 2, Steps: 979 | Train Loss: 0.7047646 Vali Loss: 0.6022656 Best vali loss: 0.6022656
	iters: 100, epoch: 3 | loss: 0.3400446
	speed: 0.0427s/iter; left time: 246.4201s
	iters: 200, epoch: 3 | loss: 0.7847927
	speed: 0.0119s/iter; left time: 67.5416s
	iters: 300, epoch: 3 | loss: 0.3123362
	speed: 0.0112s/iter; left time: 62.6202s
	iters: 400, epoch: 3 | loss: 0.3798814
	speed: 0.0116s/iter; left time: 63.2930s
	iters: 500, epoch: 3 | loss: 1.0594692
	speed: 0.0123s/iter; left time: 65.9290s
	iters: 600, epoch: 3 | loss: 0.8351071
	speed: 0.0113s/iter; left time: 59.8528s
	iters: 700, epoch: 3 | loss: 1.1330571
	speed: 0.0131s/iter; left time: 67.7323s
	iters: 800, epoch: 3 | loss: 0.8758114
	speed: 0.0121s/iter; left time: 61.3315s
	iters: 900, epoch: 3 | loss: 1.0444903
	speed: 0.0122s/iter; left time: 60.5532s
Updating learning rate to 0.00021580187521556143
Validation loss decreased (0.6023 --> 0.5838).  Saving model state dict ...
Epoch: 3 cost time: 11.64001989364624
Epoch: 3, Steps: 979 | Train Loss: 0.7516656 Vali Loss: 0.5838376 Best vali loss: 0.5838376
	iters: 100, epoch: 4 | loss: 1.8269637
	speed: 0.0377s/iter; left time: 180.6626s
	iters: 200, epoch: 4 | loss: 0.7695656
	speed: 0.0127s/iter; left time: 59.5806s
	iters: 300, epoch: 4 | loss: 0.6017421
	speed: 0.0123s/iter; left time: 56.3156s
	iters: 400, epoch: 4 | loss: 0.6101014
	speed: 0.0111s/iter; left time: 49.7774s
	iters: 500, epoch: 4 | loss: 1.1257966
	speed: 0.0102s/iter; left time: 44.8600s
	iters: 600, epoch: 4 | loss: 1.3415372
	speed: 0.0106s/iter; left time: 45.5429s
	iters: 700, epoch: 4 | loss: 0.8984666
	speed: 0.0126s/iter; left time: 52.7300s
	iters: 800, epoch: 4 | loss: 0.3409428
	speed: 0.0123s/iter; left time: 50.5821s
	iters: 900, epoch: 4 | loss: 0.8606290
	speed: 0.0098s/iter; left time: 39.0170s
Updating learning rate to 0.0001560746807
Validation loss decreased (0.5838 --> 0.5775).  Saving model state dict ...
Epoch: 4 cost time: 11.426759243011475
Epoch: 4, Steps: 979 | Train Loss: 0.9306383 Vali Loss: 0.5774522 Best vali loss: 0.5774522
	iters: 100, epoch: 5 | loss: 0.7513679
	speed: 0.0369s/iter; left time: 140.9503s
	iters: 200, epoch: 5 | loss: 0.4370838
	speed: 0.0125s/iter; left time: 46.4093s
	iters: 300, epoch: 5 | loss: 0.9309713
	speed: 0.0094s/iter; left time: 33.8738s
	iters: 400, epoch: 5 | loss: 0.4056344
	speed: 0.0085s/iter; left time: 29.9060s
	iters: 500, epoch: 5 | loss: 1.1069304
	speed: 0.0091s/iter; left time: 31.1803s
	iters: 600, epoch: 5 | loss: 0.3152560
	speed: 0.0089s/iter; left time: 29.6450s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 0.0001452060165, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5971446
	speed: 0.0113s/iter; left time: 87.3336s
	iters: 200, epoch: 1 | loss: 1.2489493
	speed: 0.0057s/iter; left time: 43.3318s
	iters: 300, epoch: 1 | loss: 0.3278099
	speed: 0.0057s/iter; left time: 43.2442s
	iters: 400, epoch: 1 | loss: 0.8643901
	speed: 0.0064s/iter; left time: 47.3648s
	iters: 500, epoch: 1 | loss: 0.7161645
	speed: 0.0061s/iter; left time: 44.6208s
	iters: 600, epoch: 1 | loss: 0.7012292
	speed: 0.0062s/iter; left time: 44.5258s
	iters: 700, epoch: 1 | loss: 0.5238981
	speed: 0.0059s/iter; left time: 41.8841s
	iters: 800, epoch: 1 | loss: 0.9215864
	speed: 0.0050s/iter; left time: 35.2977s
	iters: 900, epoch: 1 | loss: 1.0044450
	speed: 0.0050s/iter; left time: 34.4150s
Updating learning rate to 0.0001396794415709231
Validation loss decreased (inf --> 0.6284).  Saving model state dict ...
Epoch: 1 cost time: 6.027345895767212
Epoch: 1, Steps: 979 | Train Loss: 0.8784019 Vali Loss: 0.6283942 Best vali loss: 0.6283942
	iters: 100, epoch: 2 | loss: 1.0124058
	speed: 0.0251s/iter; left time: 169.7119s
	iters: 200, epoch: 2 | loss: 1.0988797
	speed: 0.0076s/iter; left time: 50.2723s
	iters: 300, epoch: 2 | loss: 0.7156408
	speed: 0.0073s/iter; left time: 48.0385s
	iters: 400, epoch: 2 | loss: 0.5783046
	speed: 0.0080s/iter; left time: 51.5525s
	iters: 500, epoch: 2 | loss: 0.7712055
	speed: 0.0080s/iter; left time: 50.5473s
	iters: 600, epoch: 2 | loss: 0.7313526
	speed: 0.0075s/iter; left time: 46.7066s
	iters: 700, epoch: 2 | loss: 1.0597537
	speed: 0.0078s/iter; left time: 48.0821s
	iters: 800, epoch: 2 | loss: 0.3250721
	speed: 0.0078s/iter; left time: 47.3093s
	iters: 900, epoch: 2 | loss: 0.5043613
	speed: 0.0077s/iter; left time: 46.0438s
Updating learning rate to 0.00012394108771811787
Validation loss decreased (0.6284 --> 0.6147).  Saving model state dict ...
Epoch: 2 cost time: 7.548119306564331
Epoch: 2, Steps: 979 | Train Loss: 0.7552196 Vali Loss: 0.6147391 Best vali loss: 0.6147391
	iters: 100, epoch: 3 | loss: 0.5995910
	speed: 0.0181s/iter; left time: 104.7708s
	iters: 200, epoch: 3 | loss: 0.9057344
	speed: 0.0047s/iter; left time: 26.5785s
	iters: 300, epoch: 3 | loss: 0.8702074
	speed: 0.0057s/iter; left time: 31.7159s
	iters: 400, epoch: 3 | loss: 0.4645822
	speed: 0.0092s/iter; left time: 50.1468s
	iters: 500, epoch: 3 | loss: 0.5721841
	speed: 0.0096s/iter; left time: 51.3335s
	iters: 600, epoch: 3 | loss: 0.4921054
	speed: 0.0072s/iter; left time: 37.7546s
	iters: 700, epoch: 3 | loss: 1.3935664
	speed: 0.0046s/iter; left time: 23.8143s
	iters: 800, epoch: 3 | loss: 1.1066412
	speed: 0.0062s/iter; left time: 31.4994s
	iters: 900, epoch: 3 | loss: 0.4991539
	speed: 0.0084s/iter; left time: 41.8672s
Updating learning rate to 0.00010038697664714094
Validation loss decreased (0.6147 --> 0.6106).  Saving model state dict ...
Epoch: 3 cost time: 6.7885355949401855
Epoch: 3, Steps: 979 | Train Loss: 0.7670851 Vali Loss: 0.6106293 Best vali loss: 0.6106293
	iters: 100, epoch: 4 | loss: 0.8257771
	speed: 0.0279s/iter; left time: 133.9715s
	iters: 200, epoch: 4 | loss: 0.4322809
	speed: 0.0042s/iter; left time: 19.8854s
	iters: 300, epoch: 4 | loss: 1.4666779
	speed: 0.0052s/iter; left time: 23.8184s
	iters: 400, epoch: 4 | loss: 1.3110152
	speed: 0.0061s/iter; left time: 27.5424s
	iters: 500, epoch: 4 | loss: 0.5073924
	speed: 0.0063s/iter; left time: 27.5364s
	iters: 600, epoch: 4 | loss: 1.0490360
	speed: 0.0061s/iter; left time: 26.2710s
	iters: 700, epoch: 4 | loss: 0.7375339
	speed: 0.0061s/iter; left time: 25.7870s
	iters: 800, epoch: 4 | loss: 0.3956851
	speed: 0.0062s/iter; left time: 25.3649s
	iters: 900, epoch: 4 | loss: 1.0203848
	speed: 0.0061s/iter; left time: 24.5742s
Updating learning rate to 7.260300825e-05
Validation loss decreased (0.6106 --> 0.6027).  Saving model state dict ...
Epoch: 4 cost time: 5.767096281051636
Epoch: 4, Steps: 979 | Train Loss: 0.8606426 Vali Loss: 0.6027011 Best vali loss: 0.6027011
	iters: 100, epoch: 5 | loss: 1.1305538
	speed: 0.0200s/iter; left time: 76.3136s
	iters: 200, epoch: 5 | loss: 1.7176293
	speed: 0.0057s/iter; left time: 21.0192s
	iters: 300, epoch: 5 | loss: 0.8033262
	speed: 0.0059s/iter; left time: 21.2907s
	iters: 400, epoch: 5 | loss: 1.3096043
	speed: 0.0058s/iter; left time: 20.3793s
	iters: 500, epoch: 5 | loss: 1.5050386
	speed: 0.0055s/iter; left time: 18.8792s
	iters: 600, epoch: 5 | loss: 0.8937424
	speed: 0.0065s/iter; left time: 21.4764s
	iters: 700, epoch: 5 | loss: 0.5919043
	speed: 0.0079s/iter; left time: 25.4530s
	iters: 800, epoch: 5 | loss: 1.7926351
	speed: 0.0077s/iter; left time: 23.8593s
	iters: 900, epoch: 5 | loss: 0.9157085
	speed: 0.0077s/iter; left time: 23.1542s
Updating learning rate to 4.4819039852859076e-05
Epoch: 5 cost time: 6.4626524448394775
Epoch: 5, Steps: 979 | Train Loss: 1.1844603 Vali Loss: 0.6042334 Best vali loss: 0.6027011
	iters: 100, epoch: 6 | loss: 1.1549169
	speed: 0.0243s/iter; left time: 68.8822s
	iters: 200, epoch: 6 | loss: 0.6331125
	speed: 0.0081s/iter; left time: 22.2650s
	iters: 300, epoch: 6 | loss: 0.8426681
	speed: 0.0093s/iter; left time: 24.6082s
	iters: 400, epoch: 6 | loss: 1.2692511
	speed: 0.0093s/iter; left time: 23.6032s
	iters: 500, epoch: 6 | loss: 0.3183655
	speed: 0.0125s/iter; left time: 30.4100s
	iters: 600, epoch: 6 | loss: 0.9141359
	speed: 0.0144s/iter; left time: 33.6087s
	iters: 700, epoch: 6 | loss: 0.4853301
	speed: 0.0162s/iter; left time: 36.3110s
	iters: 800, epoch: 6 | loss: 0.3816759
	speed: 0.0130s/iter; left time: 27.8866s
	iters: 900, epoch: 6 | loss: 0.6978476
	speed: 0.0131s/iter; left time: 26.7524s
Updating learning rate to 2.126492878188215e-05
Epoch: 6 cost time: 11.2880117893219
Epoch: 6, Steps: 979 | Train Loss: 0.7441449 Vali Loss: 0.6062801 Best vali loss: 0.6027011
	iters: 100, epoch: 7 | loss: 0.7376493
	speed: 0.0772s/iter; left time: 143.5520s
	iters: 200, epoch: 7 | loss: 0.9684273
	speed: 0.0108s/iter; left time: 19.0560s
	iters: 300, epoch: 7 | loss: 0.3807064
	speed: 0.0116s/iter; left time: 19.2660s
	iters: 400, epoch: 7 | loss: 0.4528811
	speed: 0.0123s/iter; left time: 19.1960s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7149158
	speed: 0.0118s/iter; left time: 22.0477s
	iters: 200, epoch: 1 | loss: 1.0118437
	speed: 0.0054s/iter; left time: 9.4370s
Updating learning rate to 0.000185960463
Validation loss decreased (inf --> 0.6013).  Saving model state dict ...
Epoch: 1 cost time: 1.6412475109100342
Epoch: 1, Steps: 245 | Train Loss: 0.8633797 Vali Loss: 0.6013132 Best vali loss: 0.6013132
	iters: 100, epoch: 2 | loss: 0.8344008
	speed: 0.0123s/iter; left time: 19.8834s
	iters: 200, epoch: 2 | loss: 0.8120346
	speed: 0.0086s/iter; left time: 12.9756s
Updating learning rate to 9.29802315e-05
Validation loss decreased (0.6013 --> 0.5970).  Saving model state dict ...
Epoch: 2 cost time: 1.7724690437316895
Epoch: 2, Steps: 245 | Train Loss: 0.8232177 Vali Loss: 0.5970204 Best vali loss: 0.5970204
	iters: 100, epoch: 3 | loss: 0.7326443
	speed: 0.0103s/iter; left time: 14.1291s
	iters: 200, epoch: 3 | loss: 0.6625831
	speed: 0.0058s/iter; left time: 7.3307s
Updating learning rate to 4.649011575e-05
Epoch: 3 cost time: 1.3406639099121094
Epoch: 3, Steps: 245 | Train Loss: 0.6976137 Vali Loss: 0.6088645 Best vali loss: 0.5970204

best validation loss 0.5970204342079074

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0021821256011, 'e_layers': 4, 'learning_rate': 0.0002214516301, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0247662
	speed: 0.0182s/iter; left time: 16.0967s
Updating learning rate to 0.0002214516301
Validation loss decreased (inf --> 0.6268).  Saving model state dict ...
Epoch: 1 cost time: 1.7420642375946045
Epoch: 1, Steps: 123 | Train Loss: 1.0247662 Vali Loss: 0.6267936 Best vali loss: 0.6267936
	iters: 100, epoch: 2 | loss: 1.0690581
	speed: 0.0161s/iter; left time: 12.2737s
Updating learning rate to 0.00011072581505
Validation loss decreased (0.6268 --> 0.6182).  Saving model state dict ...
Epoch: 2 cost time: 1.2821640968322754
Epoch: 2, Steps: 123 | Train Loss: 1.0690581 Vali Loss: 0.6181600 Best vali loss: 0.6181600
	iters: 100, epoch: 3 | loss: 0.8879364
	speed: 0.0181s/iter; left time: 11.5754s
Updating learning rate to 5.5362907525e-05
Validation loss decreased (0.6182 --> 0.6053).  Saving model state dict ...
Epoch: 3 cost time: 1.3281166553497314
Epoch: 3, Steps: 123 | Train Loss: 0.8879364 Vali Loss: 0.6052694 Best vali loss: 0.6052694

best validation loss 0.6052694179734827

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001453621946, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4482405
	speed: 0.0124s/iter; left time: 96.0532s
	iters: 200, epoch: 1 | loss: 0.5158455
	speed: 0.0080s/iter; left time: 61.0869s
	iters: 300, epoch: 1 | loss: 0.3196407
	speed: 0.0100s/iter; left time: 75.5071s
	iters: 400, epoch: 1 | loss: 0.7335285
	speed: 0.0099s/iter; left time: 73.4438s
	iters: 500, epoch: 1 | loss: 0.7606302
	speed: 0.0053s/iter; left time: 38.6864s
	iters: 600, epoch: 1 | loss: 0.4355136
	speed: 0.0062s/iter; left time: 45.0802s
	iters: 700, epoch: 1 | loss: 1.0606869
	speed: 0.0109s/iter; left time: 77.9025s
	iters: 800, epoch: 1 | loss: 0.8954718
	speed: 0.0102s/iter; left time: 71.8549s
	iters: 900, epoch: 1 | loss: 0.4473966
	speed: 0.0099s/iter; left time: 68.8780s
Updating learning rate to 0.0001453621946
Validation loss decreased (inf --> 0.6302).  Saving model state dict ...
Epoch: 1 cost time: 8.845830202102661
Epoch: 1, Steps: 979 | Train Loss: 0.6241060 Vali Loss: 0.6302419 Best vali loss: 0.6302419
	iters: 100, epoch: 2 | loss: 0.5635750
	speed: 0.0572s/iter; left time: 386.2813s
	iters: 200, epoch: 2 | loss: 0.2500840
	speed: 0.0105s/iter; left time: 69.5370s
	iters: 300, epoch: 2 | loss: 0.6015297
	speed: 0.0103s/iter; left time: 67.7814s
	iters: 400, epoch: 2 | loss: 1.0541211
	speed: 0.0105s/iter; left time: 67.9540s
	iters: 500, epoch: 2 | loss: 0.8547583
	speed: 0.0109s/iter; left time: 68.9823s
	iters: 600, epoch: 2 | loss: 0.9561706
	speed: 0.0115s/iter; left time: 72.1300s
	iters: 700, epoch: 2 | loss: 0.4383152
	speed: 0.0108s/iter; left time: 66.2290s
	iters: 800, epoch: 2 | loss: 0.7933509
	speed: 0.0098s/iter; left time: 59.5796s
	iters: 900, epoch: 2 | loss: 0.6707631
	speed: 0.0105s/iter; left time: 62.4651s
Updating learning rate to 7.26810973e-05
Validation loss decreased (0.6302 --> 0.6122).  Saving model state dict ...
Epoch: 2 cost time: 10.377705574035645
Epoch: 2, Steps: 979 | Train Loss: 0.6869631 Vali Loss: 0.6122298 Best vali loss: 0.6122298
	iters: 100, epoch: 3 | loss: 0.2704547
	speed: 0.0362s/iter; left time: 209.0440s
	iters: 200, epoch: 3 | loss: 0.8196154
	speed: 0.0082s/iter; left time: 46.5068s
	iters: 300, epoch: 3 | loss: 0.5790510
	speed: 0.0078s/iter; left time: 43.7069s
	iters: 400, epoch: 3 | loss: 0.2566136
	speed: 0.0104s/iter; left time: 56.9530s
	iters: 500, epoch: 3 | loss: 0.9316894
	speed: 0.0091s/iter; left time: 49.0608s
	iters: 600, epoch: 3 | loss: 0.2638752
	speed: 0.0099s/iter; left time: 52.4332s
	iters: 700, epoch: 3 | loss: 1.3013628
	speed: 0.0097s/iter; left time: 50.2560s
	iters: 800, epoch: 3 | loss: 1.0486430
	speed: 0.0107s/iter; left time: 54.3991s
	iters: 900, epoch: 3 | loss: 0.6291572
	speed: 0.0095s/iter; left time: 47.4638s
Updating learning rate to 3.634054865e-05
Validation loss decreased (0.6122 --> 0.6116).  Saving model state dict ...
Epoch: 3 cost time: 8.98032546043396
Epoch: 3, Steps: 979 | Train Loss: 0.6778292 Vali Loss: 0.6116047 Best vali loss: 0.6116047

best validation loss 0.6116047021499776

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6644415
	speed: 0.0138s/iter; left time: 15.5834s
	iters: 200, epoch: 4 | loss: 0.9076516
	speed: 0.0061s/iter; left time: 6.2401s
Updating learning rate to 2.3245057875e-05
Epoch: 4 cost time: 1.8507061004638672
Epoch: 4, Steps: 245 | Train Loss: 0.7860465 Vali Loss: 0.6052562 Best vali loss: 0.5970204
	iters: 100, epoch: 5 | loss: 0.8024256
	speed: 0.0088s/iter; left time: 7.7513s
	iters: 200, epoch: 5 | loss: 0.7728352
	speed: 0.0041s/iter; left time: 3.2232s
Updating learning rate to 1.16225289375e-05
Epoch: 5 cost time: 1.0279669761657715
Epoch: 5, Steps: 245 | Train Loss: 0.7876304 Vali Loss: 0.6129998 Best vali loss: 0.5970204
	iters: 100, epoch: 6 | loss: 0.7298154
	speed: 0.0082s/iter; left time: 5.2203s
	iters: 200, epoch: 6 | loss: 0.6316715
	speed: 0.0038s/iter; left time: 2.0130s
Updating learning rate to 5.81126446875e-06
Epoch: 6 cost time: 0.9468719959259033
Epoch: 6, Steps: 245 | Train Loss: 0.6807434 Vali Loss: 0.6157868 Best vali loss: 0.5970204
	iters: 100, epoch: 7 | loss: 1.1194861
	speed: 0.0085s/iter; left time: 3.3265s
	iters: 200, epoch: 7 | loss: 0.5759954
	speed: 0.0041s/iter; left time: 1.1995s
Updating learning rate to 2.905632234375e-06
Epoch: 7 cost time: 1.208235740661621
Epoch: 7, Steps: 245 | Train Loss: 0.8477408 Vali Loss: 0.6188918 Best vali loss: 0.5970204
	iters: 100, epoch: 8 | loss: 0.5645849
	speed: 0.0156s/iter; left time: 2.2721s
	iters: 200, epoch: 8 | loss: 0.5482436
	speed: 0.0075s/iter; left time: 0.3437s
Updating learning rate to 1.4528161171875e-06
Epoch: 8 cost time: 1.8957581520080566
Epoch: 8, Steps: 245 | Train Loss: 0.5564142 Vali Loss: 0.6179307 Best vali loss: 0.5970204

best validation loss 0.5970204342079074

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0014517716849, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0252378
	speed: 0.0141s/iter; left time: 26.2288s
	iters: 200, epoch: 1 | loss: 0.9727320
	speed: 0.0075s/iter; left time: 13.1498s
Updating learning rate to 0.0003060628921
Validation loss decreased (inf --> 0.6370).  Saving model state dict ...
Epoch: 1 cost time: 2.202500820159912
Epoch: 1, Steps: 245 | Train Loss: 0.9989849 Vali Loss: 0.6370011 Best vali loss: 0.6370011
	iters: 100, epoch: 2 | loss: 0.8572987
	speed: 0.0166s/iter; left time: 26.8936s
	iters: 200, epoch: 2 | loss: 0.8569043
	speed: 0.0043s/iter; left time: 6.4555s
Updating learning rate to 0.00015303144605
Validation loss decreased (0.6370 --> 0.6126).  Saving model state dict ...
Epoch: 2 cost time: 1.3930914402008057
Epoch: 2, Steps: 245 | Train Loss: 0.8571015 Vali Loss: 0.6126390 Best vali loss: 0.6126390
	iters: 100, epoch: 3 | loss: 0.8445984
	speed: 0.0100s/iter; left time: 13.7316s
	iters: 200, epoch: 3 | loss: 0.8577282
	speed: 0.0060s/iter; left time: 7.6746s
Updating learning rate to 7.6515723025e-05
Validation loss decreased (0.6126 --> 0.6080).  Saving model state dict ...
Epoch: 3 cost time: 1.4725606441497803
Epoch: 3, Steps: 245 | Train Loss: 0.8511633 Vali Loss: 0.6080359 Best vali loss: 0.6080359
	iters: 100, epoch: 4 | loss: 0.7299879
	speed: 0.0130s/iter; left time: 14.6097s
	iters: 200, epoch: 4 | loss: 0.6178132
	speed: 0.0073s/iter; left time: 7.4503s
Updating learning rate to 3.82578615125e-05
Validation loss decreased (0.6080 --> 0.6048).  Saving model state dict ...
Epoch: 4 cost time: 1.7051799297332764
Epoch: 4, Steps: 245 | Train Loss: 0.6739005 Vali Loss: 0.6047624 Best vali loss: 0.6047624
	iters: 100, epoch: 5 | loss: 0.9742836
	speed: 0.0125s/iter; left time: 11.0311s
	iters: 200, epoch: 5 | loss: 0.6715726
	speed: 0.0057s/iter; left time: 4.4749s
Updating learning rate to 1.912893075625e-05
Validation loss decreased (0.6048 --> 0.6046).  Saving model state dict ...
Epoch: 5 cost time: 1.508345603942871
Epoch: 5, Steps: 245 | Train Loss: 0.8229281 Vali Loss: 0.6046102 Best vali loss: 0.6046102
	iters: 100, epoch: 6 | loss: 0.9701077
	speed: 0.0125s/iter; left time: 7.9380s
	iters: 200, epoch: 6 | loss: 1.2943709
	speed: 0.0070s/iter; left time: 3.7691s
Updating learning rate to 9.564465378125e-06
Validation loss decreased (0.6046 --> 0.6042).  Saving model state dict ...
Epoch: 6 cost time: 1.5762379169464111
Epoch: 6, Steps: 245 | Train Loss: 1.1322393 Vali Loss: 0.6042272 Best vali loss: 0.6042272
	iters: 100, epoch: 7 | loss: 1.2104410
	speed: 0.0132s/iter; left time: 5.1489s
	iters: 200, epoch: 7 | loss: 0.7223233
	speed: 0.0059s/iter; left time: 1.7085s
Updating learning rate to 4.7822326890625e-06
Validation loss decreased (0.6042 --> 0.6042).  Saving model state dict ...
Epoch: 7 cost time: 1.499617099761963
Epoch: 7, Steps: 245 | Train Loss: 0.9663821 Vali Loss: 0.6041655 Best vali loss: 0.6041655
	iters: 100, epoch: 8 | loss: 0.8199639
	speed: 0.0133s/iter; left time: 1.9400s
	iters: 200, epoch: 8 | loss: 0.7312413
	speed: 0.0062s/iter; left time: 0.2868s
Updating learning rate to 2.39111634453125e-06
Validation loss decreased (0.6042 --> 0.6041).  Saving model state dict ...
Epoch: 8 cost time: 1.6183795928955078
Epoch: 8, Steps: 245 | Train Loss: 0.7756026 Vali Loss: 0.6040563 Best vali loss: 0.6040563

best validation loss 0.6040562519951035

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0025777605036, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9306211
	speed: 0.0132s/iter; left time: 50.3394s
	iters: 200, epoch: 1 | loss: 0.3914903
	speed: 0.0069s/iter; left time: 25.5778s
	iters: 300, epoch: 1 | loss: 0.8123834
	speed: 0.0062s/iter; left time: 22.4314s
	iters: 400, epoch: 1 | loss: 1.7468200
	speed: 0.0070s/iter; left time: 24.6010s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.6143).  Saving model state dict ...
Epoch: 1 cost time: 3.6479578018188477
Epoch: 1, Steps: 490 | Train Loss: 0.9703287 Vali Loss: 0.6142960 Best vali loss: 0.6142960
	iters: 100, epoch: 2 | loss: 1.1006674
	speed: 0.0182s/iter; left time: 60.5599s
	iters: 200, epoch: 2 | loss: 0.8883334
	speed: 0.0053s/iter; left time: 17.2258s
	iters: 300, epoch: 2 | loss: 1.0108651
	speed: 0.0051s/iter; left time: 15.9200s
	iters: 400, epoch: 2 | loss: 0.6975377
	speed: 0.0056s/iter; left time: 16.8704s
Updating learning rate to 0.0002612410192867383
Validation loss decreased (0.6143 --> 0.6094).  Saving model state dict ...
Epoch: 2 cost time: 2.8273777961730957
Epoch: 2, Steps: 490 | Train Loss: 0.9243509 Vali Loss: 0.6093730 Best vali loss: 0.6093730
	iters: 100, epoch: 3 | loss: 0.9257385
	speed: 0.0186s/iter; left time: 52.9357s
	iters: 200, epoch: 3 | loss: 0.5040709
	speed: 0.0055s/iter; left time: 15.1981s
	iters: 300, epoch: 3 | loss: 0.7641860
	speed: 0.0060s/iter; left time: 15.7511s
	iters: 400, epoch: 3 | loss: 0.8367875
	speed: 0.0072s/iter; left time: 18.4037s
Updating learning rate to 0.00021159404508420707
Validation loss decreased (0.6094 --> 0.5919).  Saving model state dict ...
Epoch: 3 cost time: 3.062610626220703
Epoch: 3, Steps: 490 | Train Loss: 0.7576957 Vali Loss: 0.5919401 Best vali loss: 0.5919401
	iters: 100, epoch: 4 | loss: 0.7907580
	speed: 0.0174s/iter; left time: 40.9109s
	iters: 200, epoch: 4 | loss: 0.3401031
	speed: 0.0060s/iter; left time: 13.5021s
	iters: 300, epoch: 4 | loss: 1.1459450
	speed: 0.0068s/iter; left time: 14.6029s
	iters: 400, epoch: 4 | loss: 0.7979451
	speed: 0.0045s/iter; left time: 9.1679s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 2.658243417739868
Epoch: 4, Steps: 490 | Train Loss: 0.7686878 Vali Loss: 0.6043666 Best vali loss: 0.5919401
	iters: 100, epoch: 5 | loss: 0.5825393
	speed: 0.0152s/iter; left time: 28.3794s
	iters: 200, epoch: 5 | loss: 0.7169592
	speed: 0.0068s/iter; left time: 12.0214s
	iters: 300, epoch: 5 | loss: 0.8934290
	speed: 0.0063s/iter; left time: 10.5386s
	iters: 400, epoch: 5 | loss: 1.4119660
	speed: 0.0078s/iter; left time: 12.2381s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 3.545252561569214
Epoch: 5, Steps: 490 | Train Loss: 0.9012234 Vali Loss: 0.6007402 Best vali loss: 0.5919401
	iters: 100, epoch: 6 | loss: 1.0475721
	speed: 0.0231s/iter; left time: 31.6681s
	iters: 200, epoch: 6 | loss: 0.6664857
	speed: 0.0058s/iter; left time: 7.4164s
	iters: 300, epoch: 6 | loss: 0.6782901
	speed: 0.0036s/iter; left time: 4.1781s
	iters: 400, epoch: 6 | loss: 0.8193074
	speed: 0.0038s/iter; left time: 4.0275s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 2.626417398452759
Epoch: 6, Steps: 490 | Train Loss: 0.8029138 Vali Loss: 0.5981513 Best vali loss: 0.5919401
	iters: 100, epoch: 7 | loss: 0.4336418
	speed: 0.0279s/iter; left time: 24.6227s
	iters: 200, epoch: 7 | loss: 0.6550739
	speed: 0.0125s/iter; left time: 9.7889s
	iters: 300, epoch: 7 | loss: 0.7317547
	speed: 0.0124s/iter; left time: 8.4164s
	iters: 400, epoch: 7 | loss: 0.6473011
	speed: 0.0123s/iter; left time: 7.1612s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 6.380265951156616
Epoch: 7, Steps: 490 | Train Loss: 0.6169429 Vali Loss: 0.6017114 Best vali loss: 0.5919401
	iters: 100, epoch: 8 | loss: 0.7422267
	speed: 0.0410s/iter; left time: 16.0400s
	iters: 200, epoch: 8 | loss: 0.6832657
	speed: 0.0088s/iter; left time: 2.5610s
	iters: 300, epoch: 8 | loss: 0.5054520
	speed: 0.0117s/iter; left time: 2.2396s
	iters: 400, epoch: 8 | loss: 0.5675756
	speed: 0.0136s/iter; left time: 1.2342s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.335473299026489
Epoch: 8, Steps: 490 | Train Loss: 0.6246300 Vali Loss: 0.6014635 Best vali loss: 0.5919401

best validation loss 0.5919400929977142

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0018682829331, 'e_layers': 2, 'learning_rate': 0.0025289717944, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0781926
	speed: 0.0214s/iter; left time: 18.9132s
Updating learning rate to 0.0024327185367722507
Validation loss decreased (inf --> 0.6378).  Saving model state dict ...
Epoch: 1 cost time: 2.220118284225464
Epoch: 1, Steps: 123 | Train Loss: 1.0781926 Vali Loss: 0.6377966 Best vali loss: 0.6377966
	iters: 100, epoch: 2 | loss: 0.6607174
	speed: 0.0279s/iter; left time: 21.2623s
Updating learning rate to 0.0021586124498248756
Validation loss decreased (0.6378 --> 0.6088).  Saving model state dict ...
Epoch: 2 cost time: 1.9993269443511963
Epoch: 2, Steps: 123 | Train Loss: 0.6607174 Vali Loss: 0.6088157 Best vali loss: 0.6088157
	iters: 100, epoch: 3 | loss: 0.8422846
	speed: 0.0239s/iter; left time: 15.2904s
Updating learning rate to 0.001748383700517746
Epoch: 3 cost time: 1.6758198738098145
Epoch: 3, Steps: 123 | Train Loss: 0.8422846 Vali Loss: 0.6099513 Best vali loss: 0.6088157

best validation loss 0.6088157012638037

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020076739651, 'e_layers': 4, 'learning_rate': 6.71965198e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0353899
	speed: 0.0195s/iter; left time: 17.2960s
Updating learning rate to 6.71965198e-05
Validation loss decreased (inf --> 0.6028).  Saving model state dict ...
Epoch: 1 cost time: 1.957859992980957
Epoch: 1, Steps: 123 | Train Loss: 1.0353899 Vali Loss: 0.6028022 Best vali loss: 0.6028022
	iters: 100, epoch: 2 | loss: 0.5755152
	speed: 0.0210s/iter; left time: 16.0295s
Updating learning rate to 3.35982599e-05
Epoch: 2 cost time: 1.7544293403625488
Epoch: 2, Steps: 123 | Train Loss: 0.5755152 Vali Loss: 0.6108244 Best vali loss: 0.6028022
	iters: 100, epoch: 3 | loss: 0.8371191
	speed: 0.0212s/iter; left time: 13.5452s
Updating learning rate to 1.679912995e-05
Validation loss decreased (0.6028 --> 0.6007).  Saving model state dict ...
Epoch: 3 cost time: 1.6793675422668457
Epoch: 3, Steps: 123 | Train Loss: 0.8371191 Vali Loss: 0.6006971 Best vali loss: 0.6006971

best validation loss 0.600697081461928

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0031711086512, 'e_layers': 1, 'learning_rate': 0.0006694630353, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8584793
	speed: 0.0108s/iter; left time: 9.5750s
Updating learning rate to 0.0006439831156932756
Validation loss decreased (inf --> 0.6281).  Saving model state dict ...
Epoch: 1 cost time: 0.9181349277496338
Epoch: 1, Steps: 123 | Train Loss: 0.8584793 Vali Loss: 0.6280505 Best vali loss: 0.6280505
	iters: 100, epoch: 2 | loss: 0.8689236
	speed: 0.0078s/iter; left time: 5.9150s
Updating learning rate to 0.0005714224436571795
Validation loss decreased (0.6281 --> 0.6057).  Saving model state dict ...
Epoch: 2 cost time: 0.5874786376953125
Epoch: 2, Steps: 123 | Train Loss: 0.8689236 Vali Loss: 0.6056899 Best vali loss: 0.6056899
	iters: 100, epoch: 3 | loss: 0.9105161
	speed: 0.0075s/iter; left time: 4.8045s
Updating learning rate to 0.00046282772374507767
Validation loss decreased (0.6057 --> 0.6020).  Saving model state dict ...
Epoch: 3 cost time: 0.572528600692749
Epoch: 3, Steps: 123 | Train Loss: 0.9105161 Vali Loss: 0.6020413 Best vali loss: 0.6020413

best validation loss 0.6020412911755352

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020076739651, 'e_layers': 4, 'learning_rate': 6.71965198e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9754265
	speed: 0.0220s/iter; left time: 11.3440s
Updating learning rate to 8.399564975e-06
Validation loss decreased (0.6007 --> 0.5879).  Saving model state dict ...
Epoch: 4 cost time: 2.1282546520233154
Epoch: 4, Steps: 123 | Train Loss: 0.9754265 Vali Loss: 0.5878871 Best vali loss: 0.5878871
	iters: 100, epoch: 5 | loss: 0.5422433
	speed: 0.0213s/iter; left time: 8.3661s
Updating learning rate to 4.1997824875e-06
Epoch: 5 cost time: 1.8130390644073486
Epoch: 5, Steps: 123 | Train Loss: 0.5422433 Vali Loss: 0.5891252 Best vali loss: 0.5878871
	iters: 100, epoch: 6 | loss: 0.7867174
	speed: 0.0215s/iter; left time: 5.7943s
Updating learning rate to 2.09989124375e-06
Validation loss decreased (0.5879 --> 0.5869).  Saving model state dict ...
Epoch: 6 cost time: 1.8556485176086426
Epoch: 6, Steps: 123 | Train Loss: 0.7867174 Vali Loss: 0.5869000 Best vali loss: 0.5869000
	iters: 100, epoch: 7 | loss: 0.7964213
	speed: 0.0209s/iter; left time: 3.0726s
Updating learning rate to 1.049945621875e-06
Validation loss decreased (0.5869 --> 0.5845).  Saving model state dict ...
Epoch: 7 cost time: 1.7190017700195312
Epoch: 7, Steps: 123 | Train Loss: 0.7964213 Vali Loss: 0.5845185 Best vali loss: 0.5845185
	iters: 100, epoch: 8 | loss: 0.7498487
	speed: 0.0187s/iter; left time: 0.4490s
Updating learning rate to 5.249728109375e-07
Epoch: 8 cost time: 1.5306649208068848
Epoch: 8, Steps: 123 | Train Loss: 0.7498487 Vali Loss: 0.5849051 Best vali loss: 0.5845185

best validation loss 0.5845185271681927

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0092090029171, 'e_layers': 2, 'learning_rate': 0.0003368909719, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003240688227631225
Validation loss decreased (inf --> 0.6095).  Saving model state dict ...
Epoch: 1 cost time: 0.8632116317749023
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6094561 Best vali loss: 0.6094561
Updating learning rate to 0.0002875544313255083
Validation loss decreased (0.6095 --> 0.6046).  Saving model state dict ...
Epoch: 2 cost time: 0.5513842105865479
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6045733 Best vali loss: 0.6045733
Updating learning rate to 0.0002329067826797515
Validation loss decreased (0.6046 --> 0.6012).  Saving model state dict ...
Epoch: 3 cost time: 0.573871374130249
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6011617 Best vali loss: 0.6011617
Updating learning rate to 0.00016844548595
Validation loss decreased (0.6012 --> 0.5756).  Saving model state dict ...
Epoch: 4 cost time: 0.5602028369903564
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5755710 Best vali loss: 0.5755710
Updating learning rate to 0.0001039841892202485
Validation loss decreased (0.5756 --> 0.5664).  Saving model state dict ...
Epoch: 5 cost time: 0.5572810173034668
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5663658 Best vali loss: 0.5663658
Updating learning rate to 4.9336540574491694e-05
Epoch: 6 cost time: 0.536003828048706
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5709965 Best vali loss: 0.5663658
Updating learning rate to 1.2822149136877481e-05
Epoch: 7 cost time: 0.5405573844909668
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5743360 Best vali loss: 0.5663658
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5741221904754639
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5723407 Best vali loss: 0.5663658

best validation loss 0.5663658253631345

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0064272911927, 'e_layers': 4, 'learning_rate': 0.0020657769463, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8796163
	speed: 0.0149s/iter; left time: 56.9579s
	iters: 200, epoch: 1 | loss: 1.0295522
	speed: 0.0097s/iter; left time: 36.1259s
	iters: 300, epoch: 1 | loss: 0.6570588
	speed: 0.0104s/iter; left time: 37.6411s
	iters: 400, epoch: 1 | loss: 1.2523599
	speed: 0.0103s/iter; left time: 36.3610s
Updating learning rate to 0.0019871529928601186
Validation loss decreased (inf --> 0.6332).  Saving model state dict ...
Epoch: 1 cost time: 5.162928581237793
Epoch: 1, Steps: 490 | Train Loss: 0.9546468 Vali Loss: 0.6331689 Best vali loss: 0.6331689
	iters: 100, epoch: 2 | loss: 0.5915365
	speed: 0.0263s/iter; left time: 87.5536s
	iters: 200, epoch: 2 | loss: 1.0649956
	speed: 0.0108s/iter; left time: 34.8200s
	iters: 300, epoch: 2 | loss: 0.7192478
	speed: 0.0104s/iter; left time: 32.5413s
	iters: 400, epoch: 2 | loss: 0.8571497
	speed: 0.0099s/iter; left time: 29.9403s
Updating learning rate to 0.001763250916723784
Epoch: 2 cost time: 4.98578667640686
Epoch: 2, Steps: 490 | Train Loss: 0.8082324 Vali Loss: 0.6480971 Best vali loss: 0.6331689
	iters: 100, epoch: 3 | loss: 1.0431302
	speed: 0.0240s/iter; left time: 68.1398s
	iters: 200, epoch: 3 | loss: 0.7437834
	speed: 0.0090s/iter; left time: 24.7869s
	iters: 300, epoch: 3 | loss: 1.4482390
	speed: 0.0100s/iter; left time: 26.3883s
	iters: 400, epoch: 3 | loss: 0.7410908
	speed: 0.0107s/iter; left time: 27.2379s
Updating learning rate to 0.001428157779305379
Epoch: 3 cost time: 4.920142650604248
Epoch: 3, Steps: 490 | Train Loss: 0.9940608 Vali Loss: 0.6451915 Best vali loss: 0.6331689
	iters: 100, epoch: 4 | loss: 0.5825524
	speed: 0.0269s/iter; left time: 63.2885s
	iters: 200, epoch: 4 | loss: 0.9675736
	speed: 0.0102s/iter; left time: 22.9358s
	iters: 300, epoch: 4 | loss: 1.3026931
	speed: 0.0104s/iter; left time: 22.3022s
	iters: 400, epoch: 4 | loss: 0.6164025
	speed: 0.0097s/iter; left time: 19.9110s
Updating learning rate to 0.00103288847315
Epoch: 4 cost time: 4.842077970504761
Epoch: 4, Steps: 490 | Train Loss: 0.8673054 Vali Loss: 0.6440901 Best vali loss: 0.6331689
	iters: 100, epoch: 5 | loss: 1.0416654
	speed: 0.0257s/iter; left time: 47.7793s
	iters: 200, epoch: 5 | loss: 0.4081464
	speed: 0.0138s/iter; left time: 24.2424s
	iters: 300, epoch: 5 | loss: 0.8118002
	speed: 0.0128s/iter; left time: 21.2622s
	iters: 400, epoch: 5 | loss: 1.6037798
	speed: 0.0140s/iter; left time: 21.8895s
Updating learning rate to 0.0006376191669946211
Epoch: 5 cost time: 6.62004828453064
Epoch: 5, Steps: 490 | Train Loss: 0.9663480 Vali Loss: 0.6416670 Best vali loss: 0.6331689
	iters: 100, epoch: 6 | loss: 0.8997440
	speed: 0.0319s/iter; left time: 43.6907s
	iters: 200, epoch: 6 | loss: 0.7900822
	speed: 0.0120s/iter; left time: 15.2918s
	iters: 300, epoch: 6 | loss: 0.6279992
	speed: 0.0174s/iter; left time: 20.3188s
	iters: 400, epoch: 6 | loss: 0.8237702
	speed: 0.0199s/iter; left time: 21.2803s
Updating learning rate to 0.00030252602957621584
Epoch: 6 cost time: 8.067281007766724
Epoch: 6, Steps: 490 | Train Loss: 0.7853989 Vali Loss: 0.6430246 Best vali loss: 0.6331689
	iters: 100, epoch: 7 | loss: 0.7289472
	speed: 0.0963s/iter; left time: 84.8760s
	iters: 200, epoch: 7 | loss: 0.6683261
	speed: 0.0187s/iter; left time: 14.6290s
	iters: 300, epoch: 7 | loss: 0.7212979
	speed: 0.0173s/iter; left time: 11.8054s
	iters: 400, epoch: 7 | loss: 1.3105006
	speed: 0.0148s/iter; left time: 8.5762s
Updating learning rate to 7.862395343988125e-05
Epoch: 7 cost time: 8.690186262130737
Epoch: 7, Steps: 490 | Train Loss: 0.8572679 Vali Loss: 0.6415400 Best vali loss: 0.6331689
	iters: 100, epoch: 8 | loss: 0.5842812
	speed: 0.0349s/iter; left time: 13.6305s
	iters: 200, epoch: 8 | loss: 1.0231037
	speed: 0.0083s/iter; left time: 2.4183s
	iters: 300, epoch: 8 | loss: 0.8780702
	speed: 0.0111s/iter; left time: 2.1166s
	iters: 400, epoch: 8 | loss: 0.8594983
	speed: 0.0112s/iter; left time: 1.0206s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.290601968765259
Epoch: 8, Steps: 490 | Train Loss: 0.8362384 Vali Loss: 0.6424189 Best vali loss: 0.6331689

best validation loss 0.6331689441055128

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.002062493602, 'e_layers': 3, 'learning_rate': 0.000390124485, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8030908
	speed: 0.0165s/iter; left time: 30.6735s
	iters: 200, epoch: 1 | loss: 0.4913897
	speed: 0.0096s/iter; left time: 16.9336s
Updating learning rate to 0.000390124485
Validation loss decreased (inf --> 0.6153).  Saving model state dict ...
Epoch: 1 cost time: 2.694140911102295
Epoch: 1, Steps: 245 | Train Loss: 0.6472403 Vali Loss: 0.6152660 Best vali loss: 0.6152660
	iters: 100, epoch: 2 | loss: 1.2631123
	speed: 0.0197s/iter; left time: 31.8314s
	iters: 200, epoch: 2 | loss: 0.8761674
	speed: 0.0076s/iter; left time: 11.5291s
Updating learning rate to 0.0001950622425
Epoch: 2 cost time: 2.0765633583068848
Epoch: 2, Steps: 245 | Train Loss: 1.0696399 Vali Loss: 0.6158722 Best vali loss: 0.6152660
	iters: 100, epoch: 3 | loss: 0.6134219
	speed: 0.0139s/iter; left time: 19.0471s
	iters: 200, epoch: 3 | loss: 0.7754405
	speed: 0.0070s/iter; left time: 8.9193s
Updating learning rate to 9.753112125e-05
Validation loss decreased (0.6153 --> 0.5778).  Saving model state dict ...
Epoch: 3 cost time: 1.8654568195343018
Epoch: 3, Steps: 245 | Train Loss: 0.6944312 Vali Loss: 0.5777513 Best vali loss: 0.5777513

best validation loss 0.5777512825870338

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0061589744518, 'e_layers': 3, 'learning_rate': 0.0035362361435, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0035362361435
Validation loss decreased (inf --> 0.6088).  Saving model state dict ...
Epoch: 1 cost time: 0.8413918018341064
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6088073 Best vali loss: 0.6088073
Updating learning rate to 0.00176811807175
Epoch: 2 cost time: 0.5781428813934326
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6114715 Best vali loss: 0.6088073
Updating learning rate to 0.000884059035875
Epoch: 3 cost time: 0.6251757144927979
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6252517 Best vali loss: 0.6088073

best validation loss 0.6088073103034016

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0092493039249, 'e_layers': 4, 'learning_rate': 0.0002196370677, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7824479
	speed: 0.0153s/iter; left time: 58.5460s
	iters: 200, epoch: 1 | loss: 0.9508635
	speed: 0.0091s/iter; left time: 34.0029s
	iters: 300, epoch: 1 | loss: 0.7326716
	speed: 0.0090s/iter; left time: 32.4431s
	iters: 400, epoch: 1 | loss: 0.7340809
	speed: 0.0091s/iter; left time: 32.1234s
Updating learning rate to 0.0002196370677
Validation loss decreased (inf --> 0.6143).  Saving model state dict ...
Epoch: 1 cost time: 4.801396131515503
Epoch: 1, Steps: 490 | Train Loss: 0.8000160 Vali Loss: 0.6143061 Best vali loss: 0.6143061
	iters: 100, epoch: 2 | loss: 0.7882882
	speed: 0.0230s/iter; left time: 76.6046s
	iters: 200, epoch: 2 | loss: 0.7687347
	speed: 0.0122s/iter; left time: 39.3597s
	iters: 300, epoch: 2 | loss: 1.1297239
	speed: 0.0141s/iter; left time: 44.0651s
	iters: 400, epoch: 2 | loss: 0.7564054
	speed: 0.0129s/iter; left time: 39.1670s
Updating learning rate to 0.00010981853385
Validation loss decreased (0.6143 --> 0.6074).  Saving model state dict ...
Epoch: 2 cost time: 5.97532057762146
Epoch: 2, Steps: 490 | Train Loss: 0.8607880 Vali Loss: 0.6073551 Best vali loss: 0.6073551
	iters: 100, epoch: 3 | loss: 1.2639562
	speed: 0.0416s/iter; left time: 118.2661s
	iters: 200, epoch: 3 | loss: 1.1558443
	speed: 0.0177s/iter; left time: 48.6347s
	iters: 300, epoch: 3 | loss: 0.9067902
	speed: 0.0201s/iter; left time: 52.9629s
	iters: 400, epoch: 3 | loss: 1.1265852
	speed: 0.0200s/iter; left time: 50.7112s
Updating learning rate to 5.4909266925e-05
Epoch: 3 cost time: 8.867294788360596
Epoch: 3, Steps: 490 | Train Loss: 1.1132940 Vali Loss: 0.6094107 Best vali loss: 0.6073551

best validation loss 0.6073551141018672

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.002062493602, 'e_layers': 3, 'learning_rate': 0.000390124485, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7185007
	speed: 0.0177s/iter; left time: 19.9268s
	iters: 200, epoch: 4 | loss: 0.4034141
	speed: 0.0099s/iter; left time: 10.1427s
Updating learning rate to 4.8765560625e-05
Validation loss decreased (0.5778 --> 0.5743).  Saving model state dict ...
Epoch: 4 cost time: 2.848733425140381
Epoch: 4, Steps: 245 | Train Loss: 0.5609574 Vali Loss: 0.5742636 Best vali loss: 0.5742636
	iters: 100, epoch: 5 | loss: 1.1447203
	speed: 0.0217s/iter; left time: 19.1271s
	iters: 200, epoch: 5 | loss: 0.6087329
	speed: 0.0101s/iter; left time: 7.8599s
Updating learning rate to 2.43827803125e-05
Validation loss decreased (0.5743 --> 0.5728).  Saving model state dict ...
Epoch: 5 cost time: 2.6037867069244385
Epoch: 5, Steps: 245 | Train Loss: 0.8767266 Vali Loss: 0.5727983 Best vali loss: 0.5727983
	iters: 100, epoch: 6 | loss: 0.6014186
	speed: 0.0215s/iter; left time: 13.6501s
	iters: 200, epoch: 6 | loss: 0.7304755
	speed: 0.0109s/iter; left time: 5.8270s
Updating learning rate to 1.219139015625e-05
Validation loss decreased (0.5728 --> 0.5691).  Saving model state dict ...
Epoch: 6 cost time: 2.593501329421997
Epoch: 6, Steps: 245 | Train Loss: 0.6659471 Vali Loss: 0.5691473 Best vali loss: 0.5691473
	iters: 100, epoch: 7 | loss: 0.8724197
	speed: 0.0233s/iter; left time: 9.1121s
	iters: 200, epoch: 7 | loss: 0.6199483
	speed: 0.0104s/iter; left time: 3.0175s
Updating learning rate to 6.095695078125e-06
Epoch: 7 cost time: 2.7108304500579834
Epoch: 7, Steps: 245 | Train Loss: 0.7461840 Vali Loss: 0.5702803 Best vali loss: 0.5691473
	iters: 100, epoch: 8 | loss: 0.5805210
	speed: 0.0211s/iter; left time: 3.0819s
	iters: 200, epoch: 8 | loss: 0.4015622
	speed: 0.0107s/iter; left time: 0.4936s
Updating learning rate to 3.0478475390625e-06
Epoch: 8 cost time: 2.7139317989349365
Epoch: 8, Steps: 245 | Train Loss: 0.4910416 Vali Loss: 0.5712027 Best vali loss: 0.5691473

best validation loss 0.5691472573282541

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.000863609928, 'e_layers': 4, 'learning_rate': 0.0020527463126, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0436730
	speed: 0.0148s/iter; left time: 56.3847s
	iters: 200, epoch: 1 | loss: 1.6012042
	speed: 0.0101s/iter; left time: 37.4957s
	iters: 300, epoch: 1 | loss: 1.5438050
	speed: 0.0108s/iter; left time: 39.1428s
	iters: 400, epoch: 1 | loss: 1.1464868
	speed: 0.0116s/iter; left time: 40.9804s
Updating learning rate to 0.001974618308124578
Validation loss decreased (inf --> 0.6533).  Saving model state dict ...
Epoch: 1 cost time: 5.557787895202637
Epoch: 1, Steps: 490 | Train Loss: 1.3337922 Vali Loss: 0.6533309 Best vali loss: 0.6533309
	iters: 100, epoch: 2 | loss: 0.7094288
	speed: 0.0303s/iter; left time: 100.7797s
	iters: 200, epoch: 2 | loss: 0.8142415
	speed: 0.0108s/iter; left time: 34.8516s
	iters: 300, epoch: 2 | loss: 0.7081133
	speed: 0.0130s/iter; left time: 40.6460s
	iters: 400, epoch: 2 | loss: 0.8305048
	speed: 0.0114s/iter; left time: 34.4495s
Updating learning rate to 0.0017521285751475701
Validation loss decreased (0.6533 --> 0.6347).  Saving model state dict ...
Epoch: 2 cost time: 5.682537078857422
Epoch: 2, Steps: 490 | Train Loss: 0.7655721 Vali Loss: 0.6346713 Best vali loss: 0.6346713
	iters: 100, epoch: 3 | loss: 1.1734194
	speed: 0.0328s/iter; left time: 93.1289s
	iters: 200, epoch: 3 | loss: 0.6036785
	speed: 0.0118s/iter; left time: 32.4382s
	iters: 300, epoch: 3 | loss: 0.6924220
	speed: 0.0111s/iter; left time: 29.2763s
	iters: 400, epoch: 3 | loss: 1.4763035
	speed: 0.0123s/iter; left time: 31.2456s
Updating learning rate to 0.0014191491586402747
Epoch: 3 cost time: 5.844533681869507
Epoch: 3, Steps: 490 | Train Loss: 0.9864558 Vali Loss: 0.6552934 Best vali loss: 0.6346713
	iters: 100, epoch: 4 | loss: 0.8709729
	speed: 0.0301s/iter; left time: 70.7901s
	iters: 200, epoch: 4 | loss: 0.9746042
	speed: 0.0130s/iter; left time: 29.2860s
	iters: 300, epoch: 4 | loss: 0.8302161
	speed: 0.0101s/iter; left time: 21.8065s
	iters: 400, epoch: 4 | loss: 1.0109941
	speed: 0.0119s/iter; left time: 24.4352s
Updating learning rate to 0.0010263731563
Epoch: 4 cost time: 5.835521459579468
Epoch: 4, Steps: 490 | Train Loss: 0.9216968 Vali Loss: 0.6394332 Best vali loss: 0.6346713
	iters: 100, epoch: 5 | loss: 1.5123491
	speed: 0.0319s/iter; left time: 59.3473s
	iters: 200, epoch: 5 | loss: 1.0751847
	speed: 0.0107s/iter; left time: 18.8905s
	iters: 300, epoch: 5 | loss: 1.2540022
	speed: 0.0124s/iter; left time: 20.5663s
	iters: 400, epoch: 5 | loss: 0.4955789
	speed: 0.0120s/iter; left time: 18.7709s
Updating learning rate to 0.0006335971539597252
Epoch: 5 cost time: 5.702018737792969
Epoch: 5, Steps: 490 | Train Loss: 1.0842787 Vali Loss: 0.6424164 Best vali loss: 0.6346713
	iters: 100, epoch: 6 | loss: 1.0957832
	speed: 0.0315s/iter; left time: 43.1807s
	iters: 200, epoch: 6 | loss: 1.3880419
	speed: 0.0078s/iter; left time: 9.8981s
	iters: 300, epoch: 6 | loss: 0.7392837
	speed: 0.0079s/iter; left time: 9.2021s
	iters: 400, epoch: 6 | loss: 0.8250744
	speed: 0.0091s/iter; left time: 9.7770s
Updating learning rate to 0.00030061773745242984
Epoch: 6 cost time: 4.770181655883789
Epoch: 6, Steps: 490 | Train Loss: 1.0120458 Vali Loss: 0.6453264 Best vali loss: 0.6346713
	iters: 100, epoch: 7 | loss: 0.9199928
	speed: 0.0314s/iter; left time: 27.6385s
	iters: 200, epoch: 7 | loss: 1.1086512
	speed: 0.0111s/iter; left time: 8.6913s
	iters: 300, epoch: 7 | loss: 1.0978134
	speed: 0.0089s/iter; left time: 6.0448s
	iters: 400, epoch: 7 | loss: 0.9516615
	speed: 0.0126s/iter; left time: 7.3416s
Updating learning rate to 7.812800447542216e-05
Epoch: 7 cost time: 5.781169891357422
Epoch: 7, Steps: 490 | Train Loss: 1.0195297 Vali Loss: 0.6419839 Best vali loss: 0.6346713
	iters: 100, epoch: 8 | loss: 0.8744164
	speed: 0.0372s/iter; left time: 14.5389s
	iters: 200, epoch: 8 | loss: 1.2405083
	speed: 0.0144s/iter; left time: 4.1843s
	iters: 300, epoch: 8 | loss: 0.5981159
	speed: 0.0123s/iter; left time: 2.3543s
	iters: 400, epoch: 8 | loss: 1.0486113
	speed: 0.0082s/iter; left time: 0.7480s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.789773225784302
Epoch: 8, Steps: 490 | Train Loss: 0.9404130 Vali Loss: 0.6428881 Best vali loss: 0.6346713

best validation loss 0.63467128803089

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.001884033354, 'e_layers': 1, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.6344).  Saving model state dict ...
Epoch: 1 cost time: 1.7938530445098877
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6343842 Best vali loss: 0.6343842
Updating learning rate to 0.002058451742387382
Validation loss decreased (0.6344 --> 0.6291).  Saving model state dict ...
Epoch: 2 cost time: 1.1173150539398193
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6290560 Best vali loss: 0.6290560
Updating learning rate to 0.0016672578141502105
Validation loss decreased (0.6291 --> 0.6234).  Saving model state dict ...
Epoch: 3 cost time: 0.6265580654144287
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6233688 Best vali loss: 0.6233688
Updating learning rate to 0.0012058131132
Epoch: 4 cost time: 1.168851375579834
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6404479 Best vali loss: 0.6233688
Updating learning rate to 0.0007443684122497895
Epoch: 5 cost time: 1.3799066543579102
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6519156 Best vali loss: 0.6233688
Updating learning rate to 0.000353174484012618
Epoch: 6 cost time: 1.1903586387634277
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6495394 Best vali loss: 0.6233688
Updating learning rate to 9.178705788080472e-05
Epoch: 7 cost time: 1.3409698009490967
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6530311 Best vali loss: 0.6233688
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6070818901062012
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6537996 Best vali loss: 0.6233688

best validation loss 0.6233688402595149

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012371274314, 'e_layers': 1, 'learning_rate': 0.0002034425323, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1402166
	speed: 0.0183s/iter; left time: 16.1952s
Updating learning rate to 0.00019569946196711818
Validation loss decreased (inf --> 0.6691).  Saving model state dict ...
Epoch: 1 cost time: 1.7332360744476318
Epoch: 1, Steps: 123 | Train Loss: 1.1402166 Vali Loss: 0.6690870 Best vali loss: 0.6690870
	iters: 100, epoch: 2 | loss: 0.9871756
	speed: 0.0202s/iter; left time: 15.3677s
Updating learning rate to 0.0001736490632355466
Validation loss decreased (0.6691 --> 0.6394).  Saving model state dict ...
Epoch: 2 cost time: 1.5334913730621338
Epoch: 2, Steps: 123 | Train Loss: 0.9871756 Vali Loss: 0.6393553 Best vali loss: 0.6393553
	iters: 100, epoch: 3 | loss: 0.6523701
	speed: 0.0157s/iter; left time: 10.0401s
Updating learning rate to 0.00014064830942480482
Validation loss decreased (0.6394 --> 0.6237).  Saving model state dict ...
Epoch: 3 cost time: 1.3592123985290527
Epoch: 3, Steps: 123 | Train Loss: 0.6523701 Vali Loss: 0.6237475 Best vali loss: 0.6237475

best validation loss 0.6237474562171873

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0018458136979, 'e_layers': 1, 'learning_rate': 0.0001207189802, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001207189802
Validation loss decreased (inf --> 0.6331).  Saving model state dict ...
Epoch: 1 cost time: 1.715177297592163
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6330748 Best vali loss: 0.6330748
Updating learning rate to 6.03594901e-05
Validation loss decreased (0.6331 --> 0.6044).  Saving model state dict ...
Epoch: 2 cost time: 1.1915388107299805
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6043884 Best vali loss: 0.6043884
Updating learning rate to 3.017974505e-05
Validation loss decreased (0.6044 --> 0.6042).  Saving model state dict ...
Epoch: 3 cost time: 1.1233558654785156
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6041535 Best vali loss: 0.6041535

best validation loss 0.6041534608130872

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0015367993764, 'e_layers': 2, 'learning_rate': 0.0002427959433, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6663807
	speed: 0.0201s/iter; left time: 76.9290s
	iters: 200, epoch: 1 | loss: 0.9524866
	speed: 0.0133s/iter; left time: 49.4144s
	iters: 300, epoch: 1 | loss: 0.5459664
	speed: 0.0085s/iter; left time: 30.6457s
	iters: 400, epoch: 1 | loss: 0.7693126
	speed: 0.0098s/iter; left time: 34.4798s
Updating learning rate to 0.00023355507294582045
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 5.744448184967041
Epoch: 1, Steps: 490 | Train Loss: 0.7335366 Vali Loss: 0.6040783 Best vali loss: 0.6040783
	iters: 100, epoch: 2 | loss: 0.7604194
	speed: 0.0370s/iter; left time: 123.4060s
	iters: 200, epoch: 2 | loss: 0.5510468
	speed: 0.0105s/iter; left time: 34.0791s
	iters: 300, epoch: 2 | loss: 0.9225034
	speed: 0.0111s/iter; left time: 34.7096s
	iters: 400, epoch: 2 | loss: 0.9463521
	speed: 0.0187s/iter; left time: 56.7563s
Updating learning rate to 0.00020723930062600725
Epoch: 2 cost time: 6.144554853439331
Epoch: 2, Steps: 490 | Train Loss: 0.7950804 Vali Loss: 0.6052564 Best vali loss: 0.6040783
	iters: 100, epoch: 3 | loss: 1.0031095
	speed: 0.0353s/iter; left time: 100.2154s
	iters: 200, epoch: 3 | loss: 0.8074498
	speed: 0.0107s/iter; left time: 29.4535s
	iters: 300, epoch: 3 | loss: 0.3426543
	speed: 0.0101s/iter; left time: 26.6820s
	iters: 400, epoch: 3 | loss: 0.3533029
	speed: 0.0120s/iter; left time: 30.4041s
Updating learning rate to 0.00016785496412318187
Validation loss decreased (0.6041 --> 0.5478).  Saving model state dict ...
Epoch: 3 cost time: 6.096288204193115
Epoch: 3, Steps: 490 | Train Loss: 0.6266291 Vali Loss: 0.5478494 Best vali loss: 0.5478494

best validation loss 0.5478493986597

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0015367993764, 'e_layers': 2, 'learning_rate': 0.0002427959433, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6473147
	speed: 0.0179s/iter; left time: 42.0506s
	iters: 200, epoch: 4 | loss: 0.8945009
	speed: 0.0100s/iter; left time: 22.5259s
	iters: 300, epoch: 4 | loss: 0.6099946
	speed: 0.0129s/iter; left time: 27.8238s
	iters: 400, epoch: 4 | loss: 0.4873168
	speed: 0.0120s/iter; left time: 24.6087s
Updating learning rate to 0.00012139797165
Epoch: 4 cost time: 6.172734260559082
Epoch: 4, Steps: 490 | Train Loss: 0.6597818 Vali Loss: 0.5508441 Best vali loss: 0.5478494
	iters: 100, epoch: 5 | loss: 0.6602865
	speed: 0.0387s/iter; left time: 72.0836s
	iters: 200, epoch: 5 | loss: 0.5251448
	speed: 0.0102s/iter; left time: 17.9519s
	iters: 300, epoch: 5 | loss: 0.9057181
	speed: 0.0110s/iter; left time: 18.3228s
	iters: 400, epoch: 5 | loss: 0.8229781
	speed: 0.0121s/iter; left time: 18.9642s
Updating learning rate to 7.494097917681814e-05
Validation loss decreased (0.5478 --> 0.5355).  Saving model state dict ...
Epoch: 5 cost time: 5.791849374771118
Epoch: 5, Steps: 490 | Train Loss: 0.7285319 Vali Loss: 0.5355113 Best vali loss: 0.5355113
	iters: 100, epoch: 6 | loss: 0.9073751
	speed: 0.0868s/iter; left time: 118.9644s
	iters: 200, epoch: 6 | loss: 0.6887713
	speed: 0.0201s/iter; left time: 25.5626s
	iters: 300, epoch: 6 | loss: 0.3138101
	speed: 0.0170s/iter; left time: 19.9139s
	iters: 400, epoch: 6 | loss: 0.3141215
	speed: 0.0205s/iter; left time: 21.9022s
Updating learning rate to 3.555664267399276e-05
Epoch: 6 cost time: 9.800168514251709
Epoch: 6, Steps: 490 | Train Loss: 0.5560195 Vali Loss: 0.5402351 Best vali loss: 0.5355113
	iters: 100, epoch: 7 | loss: 0.5755476
	speed: 0.0691s/iter; left time: 60.8762s
	iters: 200, epoch: 7 | loss: 0.5760701
	speed: 0.0226s/iter; left time: 17.6880s
	iters: 300, epoch: 7 | loss: 0.8839770
	speed: 0.0232s/iter; left time: 15.7744s
	iters: 400, epoch: 7 | loss: 0.4644176
	speed: 0.0232s/iter; left time: 13.4564s
Updating learning rate to 9.240870354179559e-06
Epoch: 7 cost time: 10.11249852180481
Epoch: 7, Steps: 490 | Train Loss: 0.6250031 Vali Loss: 0.5481539 Best vali loss: 0.5355113
	iters: 100, epoch: 8 | loss: 0.8379562
	speed: 0.0185s/iter; left time: 7.2210s
	iters: 200, epoch: 8 | loss: 0.4228174
	speed: 0.0112s/iter; left time: 3.2688s
	iters: 300, epoch: 8 | loss: 0.6851294
	speed: 0.0184s/iter; left time: 3.5116s
	iters: 400, epoch: 8 | loss: 0.5634847
	speed: 0.0218s/iter; left time: 1.9841s
Updating learning rate to 0.0
Epoch: 8 cost time: 7.661352157592773
Epoch: 8, Steps: 490 | Train Loss: 0.6273469 Vali Loss: 0.5452294 Best vali loss: 0.5355113

best validation loss 0.535511303394826

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1303405
	speed: 0.0289s/iter; left time: 53.8223s
	iters: 200, epoch: 1 | loss: 0.7854033
	speed: 0.0241s/iter; left time: 42.4053s
Updating learning rate to 8.666273256609723e-05
Validation loss decreased (inf --> 0.6249).  Saving model state dict ...
Epoch: 1 cost time: 6.126445293426514
Epoch: 1, Steps: 245 | Train Loss: 0.9578719 Vali Loss: 0.6249427 Best vali loss: 0.6249427
	iters: 100, epoch: 2 | loss: 0.6049244
	speed: 0.0575s/iter; left time: 92.9757s
	iters: 200, epoch: 2 | loss: 0.7866678
	speed: 0.0222s/iter; left time: 33.6485s
Updating learning rate to 7.689802606643869e-05
Validation loss decreased (0.6249 --> 0.6092).  Saving model state dict ...
Epoch: 2 cost time: 5.41267728805542
Epoch: 2, Steps: 245 | Train Loss: 0.6957961 Vali Loss: 0.6091963 Best vali loss: 0.6091963
	iters: 100, epoch: 3 | loss: 1.4417483
	speed: 0.0490s/iter; left time: 67.1403s
	iters: 200, epoch: 3 | loss: 0.6485838
	speed: 0.0186s/iter; left time: 23.6409s
Updating learning rate to 6.228411004831259e-05
Validation loss decreased (0.6092 --> 0.6011).  Saving model state dict ...
Epoch: 3 cost time: 4.649977684020996
Epoch: 3, Steps: 245 | Train Loss: 1.0451660 Vali Loss: 0.6011249 Best vali loss: 0.6011249
	iters: 100, epoch: 4 | loss: 0.7553868
	speed: 0.0297s/iter; left time: 33.4161s
	iters: 200, epoch: 4 | loss: 0.9672124
	speed: 0.0151s/iter; left time: 15.4670s
Updating learning rate to 4.504582075e-05
Validation loss decreased (0.6011 --> 0.5991).  Saving model state dict ...
Epoch: 4 cost time: 3.5655949115753174
Epoch: 4, Steps: 245 | Train Loss: 0.8612996 Vali Loss: 0.5991453 Best vali loss: 0.5991453
	iters: 100, epoch: 5 | loss: 0.7178583
	speed: 0.0331s/iter; left time: 29.1882s
	iters: 200, epoch: 5 | loss: 0.5786403
	speed: 0.0106s/iter; left time: 8.3068s
Updating learning rate to 2.780753145168742e-05
Epoch: 5 cost time: 3.2194230556488037
Epoch: 5, Steps: 245 | Train Loss: 0.6482493 Vali Loss: 0.5997391 Best vali loss: 0.5991453
	iters: 100, epoch: 6 | loss: 0.9032499
	speed: 0.0203s/iter; left time: 12.9196s
	iters: 200, epoch: 6 | loss: 0.9218872
	speed: 0.0104s/iter; left time: 5.5954s
Updating learning rate to 1.3193615433561312e-05
Epoch: 6 cost time: 2.5867056846618652
Epoch: 6, Steps: 245 | Train Loss: 0.9125686 Vali Loss: 0.6055357 Best vali loss: 0.5991453
	iters: 100, epoch: 7 | loss: 0.9408236
	speed: 0.0190s/iter; left time: 7.4111s
	iters: 200, epoch: 7 | loss: 0.6919460
	speed: 0.0104s/iter; left time: 3.0388s
Updating learning rate to 3.4289089339027804e-06
Epoch: 7 cost time: 2.7343459129333496
Epoch: 7, Steps: 245 | Train Loss: 0.8163848 Vali Loss: 0.6076907 Best vali loss: 0.5991453
	iters: 100, epoch: 8 | loss: 0.7226175
	speed: 0.0205s/iter; left time: 2.9968s
	iters: 200, epoch: 8 | loss: 0.6010436
	speed: 0.0101s/iter; left time: 0.4646s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5173606872558594
Epoch: 8, Steps: 245 | Train Loss: 0.6618306 Vali Loss: 0.6085181 Best vali loss: 0.5991453

best validation loss 0.5991453318505418

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0098657068511, 'e_layers': 1, 'learning_rate': 0.0032183063091, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2756273
	speed: 0.0125s/iter; left time: 47.7257s
	iters: 200, epoch: 1 | loss: 0.4271458
	speed: 0.0077s/iter; left time: 28.5431s
	iters: 300, epoch: 1 | loss: 0.8801709
	speed: 0.0055s/iter; left time: 19.8643s
	iters: 400, epoch: 1 | loss: 0.8133596
	speed: 0.0032s/iter; left time: 11.1285s
Updating learning rate to 0.0030958168187147166
Validation loss decreased (inf --> 0.6102).  Saving model state dict ...
Epoch: 1 cost time: 2.935291290283203
Epoch: 1, Steps: 490 | Train Loss: 0.8490759 Vali Loss: 0.6102463 Best vali loss: 0.6102463
	iters: 100, epoch: 2 | loss: 0.7209511
	speed: 0.0193s/iter; left time: 64.2468s
	iters: 200, epoch: 2 | loss: 1.0967958
	speed: 0.0077s/iter; left time: 25.0098s
	iters: 300, epoch: 2 | loss: 0.6760232
	speed: 0.0073s/iter; left time: 22.8140s
	iters: 400, epoch: 2 | loss: 1.3413534
	speed: 0.0069s/iter; left time: 20.9390s
Updating learning rate to 0.0027469962621000294
Epoch: 2 cost time: 3.6969821453094482
Epoch: 2, Steps: 490 | Train Loss: 0.9587809 Vali Loss: 0.6385189 Best vali loss: 0.6102463
	iters: 100, epoch: 3 | loss: 0.8266019
	speed: 0.0215s/iter; left time: 61.1296s
	iters: 200, epoch: 3 | loss: 0.7740030
	speed: 0.0077s/iter; left time: 21.1521s
	iters: 300, epoch: 3 | loss: 0.8347104
	speed: 0.0071s/iter; left time: 18.7269s
	iters: 400, epoch: 3 | loss: 0.5893352
	speed: 0.0069s/iter; left time: 17.5339s
Updating learning rate to 0.002224949406934306
Validation loss decreased (0.6102 --> 0.6089).  Saving model state dict ...
Epoch: 3 cost time: 3.4190542697906494
Epoch: 3, Steps: 490 | Train Loss: 0.7561626 Vali Loss: 0.6089370 Best vali loss: 0.6089370
	iters: 100, epoch: 4 | loss: 0.7592716
	speed: 0.0204s/iter; left time: 48.0778s
	iters: 200, epoch: 4 | loss: 0.9293434
	speed: 0.0070s/iter; left time: 15.7378s
	iters: 300, epoch: 4 | loss: 0.7750801
	speed: 0.0073s/iter; left time: 15.7308s
	iters: 400, epoch: 4 | loss: 0.5827610
	speed: 0.0082s/iter; left time: 16.8235s
Updating learning rate to 0.00160915315455
Validation loss decreased (0.6089 --> 0.6006).  Saving model state dict ...
Epoch: 4 cost time: 3.8574938774108887
Epoch: 4, Steps: 490 | Train Loss: 0.7616140 Vali Loss: 0.6005621 Best vali loss: 0.6005621
	iters: 100, epoch: 5 | loss: 1.0454941
	speed: 0.0250s/iter; left time: 46.5492s
	iters: 200, epoch: 5 | loss: 0.5584958
	speed: 0.0083s/iter; left time: 14.5494s
	iters: 300, epoch: 5 | loss: 0.6437043
	speed: 0.0076s/iter; left time: 12.6077s
	iters: 400, epoch: 5 | loss: 0.8411117
	speed: 0.0035s/iter; left time: 5.4388s
Updating learning rate to 0.0009933569021656943
Validation loss decreased (0.6006 --> 0.5905).  Saving model state dict ...
Epoch: 5 cost time: 3.2505674362182617
Epoch: 5, Steps: 490 | Train Loss: 0.7722015 Vali Loss: 0.5905270 Best vali loss: 0.5905270
	iters: 100, epoch: 6 | loss: 0.4828119
	speed: 0.0275s/iter; left time: 37.7583s
	iters: 200, epoch: 6 | loss: 0.7205468
	speed: 0.0109s/iter; left time: 13.7975s
	iters: 300, epoch: 6 | loss: 0.4577058
	speed: 0.0107s/iter; left time: 12.5364s
	iters: 400, epoch: 6 | loss: 0.3933904
	speed: 0.0052s/iter; left time: 5.5499s
Updating learning rate to 0.0004713100469999706
Epoch: 6 cost time: 4.330570697784424
Epoch: 6, Steps: 490 | Train Loss: 0.5136137 Vali Loss: 0.6070940 Best vali loss: 0.5905270
	iters: 100, epoch: 7 | loss: 0.5714964
	speed: 0.0179s/iter; left time: 15.7319s
	iters: 200, epoch: 7 | loss: 0.8146748
	speed: 0.0059s/iter; left time: 4.6156s
	iters: 300, epoch: 7 | loss: 0.3959359
	speed: 0.0054s/iter; left time: 3.6846s
	iters: 400, epoch: 7 | loss: 0.9200549
	speed: 0.0059s/iter; left time: 3.4320s
Updating learning rate to 0.00012248949038528366
Epoch: 7 cost time: 2.878995180130005
Epoch: 7, Steps: 490 | Train Loss: 0.6755405 Vali Loss: 0.6029003 Best vali loss: 0.5905270
	iters: 100, epoch: 8 | loss: 0.5782736
	speed: 0.0164s/iter; left time: 6.4073s
	iters: 200, epoch: 8 | loss: 1.2248616
	speed: 0.0053s/iter; left time: 1.5431s
	iters: 300, epoch: 8 | loss: 0.3386090
	speed: 0.0053s/iter; left time: 1.0070s
	iters: 400, epoch: 8 | loss: 0.5847605
	speed: 0.0054s/iter; left time: 0.4945s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.698157548904419
Epoch: 8, Steps: 490 | Train Loss: 0.6816262 Vali Loss: 0.6108088 Best vali loss: 0.5905270

best validation loss 0.5905270145922444

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0054289535492, 'e_layers': 2, 'learning_rate': 0.000351769056, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003383806435046083
Validation loss decreased (inf --> 0.6130).  Saving model state dict ...
Epoch: 1 cost time: 0.9582529067993164
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6129555 Best vali loss: 0.6129555
Updating learning rate to 0.00030025367045459516
Validation loss decreased (0.6130 --> 0.6066).  Saving model state dict ...
Epoch: 2 cost time: 0.6449451446533203
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6066109 Best vali loss: 0.6066109
Updating learning rate to 0.00024319262287495375
Epoch: 3 cost time: 0.6276636123657227
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6133198 Best vali loss: 0.6066109

best validation loss 0.6066109036913849

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0107187533809, 'e_layers': 4, 'learning_rate': 0.000413644762, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4749180
	speed: 0.0168s/iter; left time: 130.2954s
	iters: 200, epoch: 1 | loss: 0.2533140
	speed: 0.0106s/iter; left time: 80.8665s
	iters: 300, epoch: 1 | loss: 1.1664267
	speed: 0.0106s/iter; left time: 79.9278s
	iters: 400, epoch: 1 | loss: 0.7001854
	speed: 0.0111s/iter; left time: 82.3690s
	iters: 500, epoch: 1 | loss: 2.5426166
	speed: 0.0111s/iter; left time: 81.1164s
	iters: 600, epoch: 1 | loss: 0.4319469
	speed: 0.0107s/iter; left time: 77.6382s
	iters: 700, epoch: 1 | loss: 0.9002489
	speed: 0.0110s/iter; left time: 78.2642s
	iters: 800, epoch: 1 | loss: 0.5885843
	speed: 0.0108s/iter; left time: 75.6867s
	iters: 900, epoch: 1 | loss: 1.2787995
	speed: 0.0108s/iter; left time: 74.6480s
Updating learning rate to 0.00039790134567115125
Validation loss decreased (inf --> 0.6349).  Saving model state dict ...
Epoch: 1 cost time: 10.879510402679443
Epoch: 1, Steps: 979 | Train Loss: 0.9263378 Vali Loss: 0.6348602 Best vali loss: 0.6348602
	iters: 100, epoch: 2 | loss: 1.1198392
	speed: 0.0320s/iter; left time: 216.0365s
	iters: 200, epoch: 2 | loss: 1.0120394
	speed: 0.0106s/iter; left time: 70.5497s
	iters: 300, epoch: 2 | loss: 1.1932465
	speed: 0.0107s/iter; left time: 70.2898s
	iters: 400, epoch: 2 | loss: 0.8926367
	speed: 0.0108s/iter; left time: 69.7921s
	iters: 500, epoch: 2 | loss: 0.4052016
	speed: 0.0108s/iter; left time: 68.9017s
	iters: 600, epoch: 2 | loss: 1.3421565
	speed: 0.0109s/iter; left time: 68.0573s
	iters: 700, epoch: 2 | loss: 0.2497553
	speed: 0.0104s/iter; left time: 63.8725s
	iters: 800, epoch: 2 | loss: 0.3904932
	speed: 0.0103s/iter; left time: 62.5905s
	iters: 900, epoch: 2 | loss: 0.8575856
	speed: 0.0112s/iter; left time: 66.5280s
Updating learning rate to 0.00035306788910624776
Epoch: 2 cost time: 10.53138518333435
Epoch: 2, Steps: 979 | Train Loss: 0.8292171 Vali Loss: 0.6435809 Best vali loss: 0.6348602
	iters: 100, epoch: 3 | loss: 0.2744617
	speed: 0.0321s/iter; left time: 185.5431s
	iters: 200, epoch: 3 | loss: 0.6124639
	speed: 0.0104s/iter; left time: 58.8497s
	iters: 300, epoch: 3 | loss: 1.0127863
	speed: 0.0104s/iter; left time: 58.2232s
	iters: 400, epoch: 3 | loss: 1.6103017
	speed: 0.0105s/iter; left time: 57.3967s
	iters: 500, epoch: 3 | loss: 0.6568171
	speed: 0.0099s/iter; left time: 53.3016s
	iters: 600, epoch: 3 | loss: 0.7112322
	speed: 0.0103s/iter; left time: 54.2906s
	iters: 700, epoch: 3 | loss: 0.9900130
	speed: 0.0122s/iter; left time: 63.0246s
	iters: 800, epoch: 3 | loss: 1.2669531
	speed: 0.0119s/iter; left time: 60.4716s
	iters: 900, epoch: 3 | loss: 0.5055107
	speed: 0.0117s/iter; left time: 58.3838s
Updating learning rate to 0.00028596987965100033
Epoch: 3 cost time: 10.91730260848999
Epoch: 3, Steps: 979 | Train Loss: 0.8489489 Vali Loss: 0.6397205 Best vali loss: 0.6348602

best validation loss 0.6348602133236346

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0032137232287, 'e_layers': 1, 'learning_rate': 0.0001600716477, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4225386
	speed: 0.0160s/iter; left time: 123.9656s
	iters: 200, epoch: 1 | loss: 0.8854720
	speed: 0.0091s/iter; left time: 69.1535s
	iters: 300, epoch: 1 | loss: 1.0712017
	speed: 0.0075s/iter; left time: 56.7264s
	iters: 400, epoch: 1 | loss: 2.1302476
	speed: 0.0073s/iter; left time: 53.9621s
	iters: 500, epoch: 1 | loss: 0.9515305
	speed: 0.0081s/iter; left time: 59.4312s
	iters: 600, epoch: 1 | loss: 0.5623329
	speed: 0.0054s/iter; left time: 39.3416s
	iters: 700, epoch: 1 | loss: 0.9868054
	speed: 0.0055s/iter; left time: 39.1771s
	iters: 800, epoch: 1 | loss: 1.0601308
	speed: 0.0075s/iter; left time: 52.4625s
	iters: 900, epoch: 1 | loss: 0.3413467
	speed: 0.0073s/iter; left time: 50.4924s
Updating learning rate to 0.0001539792833726937
Validation loss decreased (inf --> 0.6063).  Saving model state dict ...
Epoch: 1 cost time: 7.593569993972778
Epoch: 1, Steps: 979 | Train Loss: 1.0457340 Vali Loss: 0.6062578 Best vali loss: 0.6062578
	iters: 100, epoch: 2 | loss: 1.1437666
	speed: 0.0195s/iter; left time: 131.3858s
	iters: 200, epoch: 2 | loss: 0.9071506
	speed: 0.0044s/iter; left time: 29.5236s
	iters: 300, epoch: 2 | loss: 1.4899246
	speed: 0.0045s/iter; left time: 29.3415s
	iters: 400, epoch: 2 | loss: 1.0218267
	speed: 0.0047s/iter; left time: 30.1951s
	iters: 500, epoch: 2 | loss: 0.8385131
	speed: 0.0047s/iter; left time: 29.6843s
	iters: 600, epoch: 2 | loss: 1.1991092
	speed: 0.0068s/iter; left time: 42.5647s
	iters: 700, epoch: 2 | loss: 0.7517601
	speed: 0.0069s/iter; left time: 42.5249s
	iters: 800, epoch: 2 | loss: 0.4667027
	speed: 0.0072s/iter; left time: 43.4426s
	iters: 900, epoch: 2 | loss: 0.9661896
	speed: 0.0069s/iter; left time: 41.2733s
Updating learning rate to 0.000136629697632187
Epoch: 2 cost time: 5.628716707229614
Epoch: 2, Steps: 979 | Train Loss: 0.9761048 Vali Loss: 0.6076277 Best vali loss: 0.6062578
	iters: 100, epoch: 3 | loss: 0.8645938
	speed: 0.0296s/iter; left time: 170.9609s
	iters: 200, epoch: 3 | loss: 1.6422168
	speed: 0.0090s/iter; left time: 51.2734s
	iters: 300, epoch: 3 | loss: 0.6490458
	speed: 0.0096s/iter; left time: 53.2736s
	iters: 400, epoch: 3 | loss: 0.7839043
	speed: 0.0086s/iter; left time: 47.2327s
	iters: 500, epoch: 3 | loss: 0.5402599
	speed: 0.0101s/iter; left time: 54.1182s
	iters: 600, epoch: 3 | loss: 0.2834640
	speed: 0.0068s/iter; left time: 35.7385s
	iters: 700, epoch: 3 | loss: 1.3168043
	speed: 0.0035s/iter; left time: 17.8571s
	iters: 800, epoch: 3 | loss: 0.4750115
	speed: 0.0031s/iter; left time: 15.6647s
	iters: 900, epoch: 3 | loss: 0.6704927
	speed: 0.0068s/iter; left time: 33.6092s
Updating learning rate to 0.00011066420763308572
Validation loss decreased (0.6063 --> 0.6016).  Saving model state dict ...
Epoch: 3 cost time: 7.485808372497559
Epoch: 3, Steps: 979 | Train Loss: 0.8028659 Vali Loss: 0.6015838 Best vali loss: 0.6015838

best validation loss 0.6015838329464349

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0032137232287, 'e_layers': 1, 'learning_rate': 0.0001600716477, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.3452568
	speed: 0.0140s/iter; left time: 67.0573s
	iters: 200, epoch: 4 | loss: 0.8766792
	speed: 0.0086s/iter; left time: 40.5469s
	iters: 300, epoch: 4 | loss: 0.9971236
	speed: 0.0083s/iter; left time: 38.2215s
	iters: 400, epoch: 4 | loss: 1.5842468
	speed: 0.0087s/iter; left time: 39.1929s
	iters: 500, epoch: 4 | loss: 0.9966830
	speed: 0.0084s/iter; left time: 36.8804s
	iters: 600, epoch: 4 | loss: 0.5242033
	speed: 0.0076s/iter; left time: 32.7922s
	iters: 700, epoch: 4 | loss: 0.8338836
	speed: 0.0089s/iter; left time: 37.1651s
	iters: 800, epoch: 4 | loss: 1.0444030
	speed: 0.0069s/iter; left time: 28.4623s
	iters: 900, epoch: 4 | loss: 0.3525652
	speed: 0.0058s/iter; left time: 23.0983s
Updating learning rate to 8.003582385e-05
Validation loss decreased (0.6016 --> 0.5992).  Saving model state dict ...
Epoch: 4 cost time: 7.885481357574463
Epoch: 4, Steps: 979 | Train Loss: 0.9505605 Vali Loss: 0.5991889 Best vali loss: 0.5991889
	iters: 100, epoch: 5 | loss: 1.1215553
	speed: 0.0521s/iter; left time: 198.8231s
	iters: 200, epoch: 5 | loss: 0.8383107
	speed: 0.0084s/iter; left time: 31.3228s
	iters: 300, epoch: 5 | loss: 1.4660074
	speed: 0.0073s/iter; left time: 26.4934s
	iters: 400, epoch: 5 | loss: 0.9986354
	speed: 0.0087s/iter; left time: 30.4538s
	iters: 500, epoch: 5 | loss: 0.7826391
	speed: 0.0081s/iter; left time: 27.5491s
	iters: 600, epoch: 5 | loss: 1.1815044
	speed: 0.0103s/iter; left time: 34.2016s
	iters: 700, epoch: 5 | loss: 0.7409172
	speed: 0.0088s/iter; left time: 28.3351s
	iters: 800, epoch: 5 | loss: 0.4489819
	speed: 0.0029s/iter; left time: 9.0355s
	iters: 900, epoch: 5 | loss: 0.9349910
	speed: 0.0067s/iter; left time: 20.0960s
Updating learning rate to 4.940744006691429e-05
Epoch: 5 cost time: 7.710194826126099
Epoch: 5, Steps: 979 | Train Loss: 0.9459492 Vali Loss: 0.6117322 Best vali loss: 0.5991889
	iters: 100, epoch: 6 | loss: 0.7796511
	speed: 0.1004s/iter; left time: 285.0251s
	iters: 200, epoch: 6 | loss: 1.5611514
	speed: 0.0102s/iter; left time: 27.9155s
	iters: 300, epoch: 6 | loss: 0.5895708
	speed: 0.0079s/iter; left time: 20.9591s
	iters: 400, epoch: 6 | loss: 0.7415932
	speed: 0.0081s/iter; left time: 20.4457s
	iters: 500, epoch: 6 | loss: 0.5314233
	speed: 0.0075s/iter; left time: 18.2242s
	iters: 600, epoch: 6 | loss: 0.2858606
	speed: 0.0087s/iter; left time: 20.3610s
	iters: 700, epoch: 6 | loss: 1.2988554
	speed: 0.0077s/iter; left time: 17.2430s
	iters: 800, epoch: 6 | loss: 0.4606401
	speed: 0.0071s/iter; left time: 15.1344s
	iters: 900, epoch: 6 | loss: 0.5932979
	speed: 0.0067s/iter; left time: 13.6459s
Updating learning rate to 2.344195006781299e-05
Epoch: 6 cost time: 8.250138759613037
Epoch: 6, Steps: 979 | Train Loss: 0.7602271 Vali Loss: 0.6070198 Best vali loss: 0.5991889
	iters: 100, epoch: 7 | loss: 0.4952338
	speed: 0.0740s/iter; left time: 137.5387s
	iters: 200, epoch: 7 | loss: 0.7522993
	speed: 0.0115s/iter; left time: 20.1759s
	iters: 300, epoch: 7 | loss: 0.7409499
	speed: 0.0123s/iter; left time: 20.4357s
	iters: 400, epoch: 7 | loss: 1.0400620
	speed: 0.0123s/iter; left time: 19.2238s
	iters: 500, epoch: 7 | loss: 0.4559354
	speed: 0.0137s/iter; left time: 19.9267s
	iters: 600, epoch: 7 | loss: 1.5277973
	speed: 0.0106s/iter; left time: 14.3992s
	iters: 700, epoch: 7 | loss: 0.9617786
	speed: 0.0120s/iter; left time: 15.1149s
	iters: 800, epoch: 7 | loss: 1.4993544
	speed: 0.0108s/iter; left time: 12.5376s
	iters: 900, epoch: 7 | loss: 0.4017691
	speed: 0.0109s/iter; left time: 11.5351s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0057599163564, 'e_layers': 1, 'learning_rate': 0.0040096099014, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003857003211329029
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 2.0544357299804688
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6090389 Best vali loss: 0.6090389
Updating learning rate to 0.0034224161262963316
Epoch: 2 cost time: 0.7448372840881348
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6110197 Best vali loss: 0.6090389
Updating learning rate to 0.0027720105904564005
Validation loss decreased (0.6090 --> 0.6076).  Saving model state dict ...
Epoch: 3 cost time: 1.5026562213897705
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6075527 Best vali loss: 0.6075527
Updating learning rate to 0.0020048049507
Epoch: 4 cost time: 1.5646281242370605
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6402525 Best vali loss: 0.6075527
Updating learning rate to 0.0012375993109435995
Epoch: 5 cost time: 1.7570929527282715
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6355559 Best vali loss: 0.6075527
Updating learning rate to 0.000587193775103668
Epoch: 6 cost time: 1.6076371669769287
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6337072 Best vali loss: 0.6075527
Updating learning rate to 0.00015260669007097073
Epoch: 7 cost time: 1.5268442630767822
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6446067 Best vali loss: 0.6075527
Updating learning rate to 0.0
Epoch: 8 cost time: 1.506998062133789
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6455579 Best vali loss: 0.6075527

best validation loss 0.6075526875293349

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0013909605867, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7132255
	speed: 0.0159s/iter; left time: 60.7764s
	iters: 200, epoch: 1 | loss: 1.0257215
	speed: 0.0136s/iter; left time: 50.5357s
	iters: 300, epoch: 1 | loss: 0.9209579
	speed: 0.0168s/iter; left time: 60.8232s
	iters: 400, epoch: 1 | loss: 1.4684632
	speed: 0.0165s/iter; left time: 58.0357s
Updating learning rate to 0.0006472014951
Validation loss decreased (inf --> 0.6044).  Saving model state dict ...
Epoch: 1 cost time: 7.829708099365234
Epoch: 1, Steps: 490 | Train Loss: 1.0320920 Vali Loss: 0.6044352 Best vali loss: 0.6044352
	iters: 100, epoch: 2 | loss: 1.5994210
	speed: 0.0855s/iter; left time: 284.9078s
	iters: 200, epoch: 2 | loss: 1.2060709
	speed: 0.0241s/iter; left time: 77.8411s
	iters: 300, epoch: 2 | loss: 0.6893452
	speed: 0.0223s/iter; left time: 69.7548s
	iters: 400, epoch: 2 | loss: 0.8793296
	speed: 0.0246s/iter; left time: 74.5802s
Updating learning rate to 0.00032360074755
Epoch: 2 cost time: 11.362048864364624
Epoch: 2, Steps: 490 | Train Loss: 1.0935417 Vali Loss: 0.6080762 Best vali loss: 0.6044352
	iters: 100, epoch: 3 | loss: 0.8255037
	speed: 0.0735s/iter; left time: 208.8120s
	iters: 200, epoch: 3 | loss: 0.5211544
	speed: 0.0123s/iter; left time: 33.6939s
	iters: 300, epoch: 3 | loss: 0.7191862
	speed: 0.0090s/iter; left time: 23.7305s
	iters: 400, epoch: 3 | loss: 0.6553151
	speed: 0.0107s/iter; left time: 27.1822s
Updating learning rate to 0.000161800373775
Validation loss decreased (0.6044 --> 0.5716).  Saving model state dict ...
Epoch: 3 cost time: 5.977268218994141
Epoch: 3, Steps: 490 | Train Loss: 0.6802899 Vali Loss: 0.5715633 Best vali loss: 0.5715633
	iters: 100, epoch: 4 | loss: 0.5712584
	speed: 0.0281s/iter; left time: 65.9465s
	iters: 200, epoch: 4 | loss: 0.5136958
	speed: 0.0087s/iter; left time: 19.6103s
	iters: 300, epoch: 4 | loss: 0.5711082
	speed: 0.0082s/iter; left time: 17.5974s
	iters: 400, epoch: 4 | loss: 0.4200563
	speed: 0.0089s/iter; left time: 18.2967s
Updating learning rate to 8.09001868875e-05
Validation loss decreased (0.5716 --> 0.5569).  Saving model state dict ...
Epoch: 4 cost time: 4.472706079483032
Epoch: 4, Steps: 490 | Train Loss: 0.5190297 Vali Loss: 0.5568923 Best vali loss: 0.5568923
	iters: 100, epoch: 5 | loss: 0.3621274
	speed: 0.0247s/iter; left time: 45.8878s
	iters: 200, epoch: 5 | loss: 0.7330784
	speed: 0.0105s/iter; left time: 18.5056s
	iters: 300, epoch: 5 | loss: 1.1200054
	speed: 0.0086s/iter; left time: 14.3534s
	iters: 400, epoch: 5 | loss: 1.2077121
	speed: 0.0106s/iter; left time: 16.5241s
Updating learning rate to 4.045009344375e-05
Epoch: 5 cost time: 5.296885251998901
Epoch: 5, Steps: 490 | Train Loss: 0.8557308 Vali Loss: 0.5595534 Best vali loss: 0.5568923
	iters: 100, epoch: 6 | loss: 0.6863446
	speed: 0.0589s/iter; left time: 80.7629s
	iters: 200, epoch: 6 | loss: 0.3371496
	speed: 0.0172s/iter; left time: 21.8569s
	iters: 300, epoch: 6 | loss: 0.8924366
	speed: 0.0188s/iter; left time: 21.9650s
	iters: 400, epoch: 6 | loss: 1.2984768
	speed: 0.0179s/iter; left time: 19.1887s
Updating learning rate to 2.0225046721875e-05
Epoch: 6 cost time: 8.403757095336914
Epoch: 6, Steps: 490 | Train Loss: 0.8036019 Vali Loss: 0.5584145 Best vali loss: 0.5568923
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042120649381, 'e_layers': 1, 'learning_rate': 0.0036397684012, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003501237965075005
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 1.1574232578277588
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6077859 Best vali loss: 0.6077859
Updating learning rate to 0.003106736659818519
Validation loss decreased (0.6078 --> 0.6053).  Saving model state dict ...
Epoch: 2 cost time: 0.9645681381225586
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6053103 Best vali loss: 0.6053103
Updating learning rate to 0.002516323732992606
Epoch: 3 cost time: 0.7226448059082031
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6336237 Best vali loss: 0.6053103

best validation loss 0.6053102752336028

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0030317673518, 'e_layers': 4, 'learning_rate': 0.0007179148563, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9725404
	speed: 0.0298s/iter; left time: 26.3336s
Updating learning rate to 0.0007179148563
Validation loss decreased (inf --> 0.5977).  Saving model state dict ...
Epoch: 1 cost time: 3.1382436752319336
Epoch: 1, Steps: 123 | Train Loss: 0.9725404 Vali Loss: 0.5976788 Best vali loss: 0.5976788
	iters: 100, epoch: 2 | loss: 0.7202715
	speed: 0.0308s/iter; left time: 23.4932s
Updating learning rate to 0.00035895742815
Epoch: 2 cost time: 2.09333872795105
Epoch: 2, Steps: 123 | Train Loss: 0.7202715 Vali Loss: 0.6160327 Best vali loss: 0.5976788
	iters: 100, epoch: 3 | loss: 0.8041940
	speed: 0.0180s/iter; left time: 11.5324s
Updating learning rate to 0.000179478714075
Validation loss decreased (0.5977 --> 0.5903).  Saving model state dict ...
Epoch: 3 cost time: 1.5441479682922363
Epoch: 3, Steps: 123 | Train Loss: 0.8041940 Vali Loss: 0.5902839 Best vali loss: 0.5902839

best validation loss 0.5902838786130479

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 3, 'learning_rate': 0.0042134401242, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9634174
	speed: 0.0168s/iter; left time: 64.1597s
	iters: 200, epoch: 1 | loss: 1.4256932
	speed: 0.0100s/iter; left time: 37.3920s
	iters: 300, epoch: 1 | loss: 0.9197079
	speed: 0.0118s/iter; left time: 42.6375s
	iters: 400, epoch: 1 | loss: 1.0405616
	speed: 0.0072s/iter; left time: 25.3562s
Updating learning rate to 0.0042134401242
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 5.0467002391815186
Epoch: 1, Steps: 490 | Train Loss: 1.0873450 Vali Loss: 0.6171283 Best vali loss: 0.6171283
	iters: 100, epoch: 2 | loss: 0.8140189
	speed: 0.0274s/iter; left time: 91.3315s
	iters: 200, epoch: 2 | loss: 0.6377918
	speed: 0.0085s/iter; left time: 27.6215s
	iters: 300, epoch: 2 | loss: 0.4316896
	speed: 0.0075s/iter; left time: 23.3511s
	iters: 400, epoch: 2 | loss: 0.3837505
	speed: 0.0105s/iter; left time: 31.8636s
Updating learning rate to 0.0021067200621
Validation loss decreased (0.6171 --> 0.6033).  Saving model state dict ...
Epoch: 2 cost time: 4.680976390838623
Epoch: 2, Steps: 490 | Train Loss: 0.5668127 Vali Loss: 0.6032652 Best vali loss: 0.6032652
	iters: 100, epoch: 3 | loss: 0.9951885
	speed: 0.0284s/iter; left time: 80.6092s
	iters: 200, epoch: 3 | loss: 1.0182949
	speed: 0.0094s/iter; left time: 25.7659s
	iters: 300, epoch: 3 | loss: 0.9449029
	speed: 0.0089s/iter; left time: 23.4050s
	iters: 400, epoch: 3 | loss: 1.0409333
	speed: 0.0089s/iter; left time: 22.4978s
Updating learning rate to 0.00105336003105
Epoch: 3 cost time: 4.5633087158203125
Epoch: 3, Steps: 490 | Train Loss: 0.9998299 Vali Loss: 0.6040921 Best vali loss: 0.6032652

best validation loss 0.6032651922648729

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0030317673518, 'e_layers': 4, 'learning_rate': 0.0007179148563, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8999829
	speed: 0.0203s/iter; left time: 10.5000s
Updating learning rate to 8.97393570375e-05
Validation loss decreased (0.5903 --> 0.5578).  Saving model state dict ...
Epoch: 4 cost time: 1.9161813259124756
Epoch: 4, Steps: 123 | Train Loss: 0.8999829 Vali Loss: 0.5578146 Best vali loss: 0.5578146
	iters: 100, epoch: 5 | loss: 0.6716240
	speed: 0.0177s/iter; left time: 6.9527s
Updating learning rate to 4.486967851875e-05
Validation loss decreased (0.5578 --> 0.5512).  Saving model state dict ...
Epoch: 5 cost time: 1.4926424026489258
Epoch: 5, Steps: 123 | Train Loss: 0.6716240 Vali Loss: 0.5511897 Best vali loss: 0.5511897
	iters: 100, epoch: 6 | loss: 0.7426214
	speed: 0.0172s/iter; left time: 4.6487s
Updating learning rate to 2.2434839259375e-05
Epoch: 6 cost time: 1.481438398361206
Epoch: 6, Steps: 123 | Train Loss: 0.7426214 Vali Loss: 0.5535866 Best vali loss: 0.5511897
	iters: 100, epoch: 7 | loss: 0.5751498
	speed: 0.0182s/iter; left time: 2.6827s
Updating learning rate to 1.12174196296875e-05
Epoch: 7 cost time: 1.6155290603637695
Epoch: 7, Steps: 123 | Train Loss: 0.5751498 Vali Loss: 0.5516938 Best vali loss: 0.5511897
	iters: 100, epoch: 8 | loss: 0.7532477
	speed: 0.0187s/iter; left time: 0.4485s
Updating learning rate to 5.60870981484375e-06
Validation loss decreased (0.5512 --> 0.5507).  Saving model state dict ...
Epoch: 8 cost time: 1.6430282592773438
Epoch: 8, Steps: 123 | Train Loss: 0.7532477 Vali Loss: 0.5506813 Best vali loss: 0.5506813

best validation loss 0.5506812716071002

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010480885831, 'e_layers': 2, 'learning_rate': 0.0045292011947, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0045292011947
Validation loss decreased (inf --> 0.6272).  Saving model state dict ...
Epoch: 1 cost time: 1.0840325355529785
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6271502 Best vali loss: 0.6271502
Updating learning rate to 0.00226460059735
Validation loss decreased (0.6272 --> 0.6137).  Saving model state dict ...
Epoch: 2 cost time: 0.7252659797668457
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6136788 Best vali loss: 0.6136788
Updating learning rate to 0.001132300298675
Epoch: 3 cost time: 0.7144861221313477
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6504959 Best vali loss: 0.6136788
Updating learning rate to 0.0005661501493375
Epoch: 4 cost time: 0.8200461864471436
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6203348 Best vali loss: 0.6136788
Updating learning rate to 0.00028307507466875
Epoch: 5 cost time: 0.7976365089416504
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6323351 Best vali loss: 0.6136788
Updating learning rate to 0.000141537537334375
Epoch: 6 cost time: 0.8783562183380127
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6305060 Best vali loss: 0.6136788
Updating learning rate to 7.07687686671875e-05
Epoch: 7 cost time: 0.7993919849395752
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6366356 Best vali loss: 0.6136788
Updating learning rate to 3.538438433359375e-05
Epoch: 8 cost time: 0.7824966907501221
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6451995 Best vali loss: 0.6136788

best validation loss 0.6136788424933636

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0021336555001, 'e_layers': 4, 'learning_rate': 0.0005331966574, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5969496
	speed: 0.0180s/iter; left time: 138.9622s
	iters: 200, epoch: 1 | loss: 1.4482504
	speed: 0.0126s/iter; left time: 96.0018s
	iters: 300, epoch: 1 | loss: 0.5590757
	speed: 0.0124s/iter; left time: 93.4314s
	iters: 400, epoch: 1 | loss: 1.1304210
	speed: 0.0122s/iter; left time: 90.4601s
	iters: 500, epoch: 1 | loss: 0.8739864
	speed: 0.0123s/iter; left time: 90.3533s
	iters: 600, epoch: 1 | loss: 0.5035361
	speed: 0.0119s/iter; left time: 86.4208s
	iters: 700, epoch: 1 | loss: 0.5741209
	speed: 0.0117s/iter; left time: 83.2492s
	iters: 800, epoch: 1 | loss: 0.9214501
	speed: 0.0116s/iter; left time: 81.3439s
	iters: 900, epoch: 1 | loss: 0.6784675
	speed: 0.0126s/iter; left time: 87.6570s
Updating learning rate to 0.0005331966574
Validation loss decreased (inf --> 0.6198).  Saving model state dict ...
Epoch: 1 cost time: 12.029354095458984
Epoch: 1, Steps: 979 | Train Loss: 0.9206953 Vali Loss: 0.6197974 Best vali loss: 0.6197974
	iters: 100, epoch: 2 | loss: 0.8524877
	speed: 0.0305s/iter; left time: 206.2203s
	iters: 200, epoch: 2 | loss: 0.3454740
	speed: 0.0076s/iter; left time: 50.4554s
	iters: 300, epoch: 2 | loss: 1.0108677
	speed: 0.0079s/iter; left time: 52.0248s
	iters: 400, epoch: 2 | loss: 0.8961343
	speed: 0.0084s/iter; left time: 54.2715s
	iters: 500, epoch: 2 | loss: 0.4739158
	speed: 0.0085s/iter; left time: 53.9752s
	iters: 600, epoch: 2 | loss: 1.3177139
	speed: 0.0075s/iter; left time: 46.7549s
	iters: 700, epoch: 2 | loss: 0.5065715
	speed: 0.0091s/iter; left time: 56.0821s
	iters: 800, epoch: 2 | loss: 0.7894011
	speed: 0.0105s/iter; left time: 63.7068s
	iters: 900, epoch: 2 | loss: 0.8208025
	speed: 0.0102s/iter; left time: 60.5423s
Updating learning rate to 0.0002665983287
Validation loss decreased (0.6198 --> 0.6128).  Saving model state dict ...
Epoch: 2 cost time: 8.718221187591553
Epoch: 2, Steps: 979 | Train Loss: 0.7792632 Vali Loss: 0.6128037 Best vali loss: 0.6128037
	iters: 100, epoch: 3 | loss: 0.3175880
	speed: 0.0336s/iter; left time: 194.1709s
	iters: 200, epoch: 3 | loss: 0.5763096
	speed: 0.0117s/iter; left time: 66.5597s
	iters: 300, epoch: 3 | loss: 0.7984168
	speed: 0.0090s/iter; left time: 50.4100s
	iters: 400, epoch: 3 | loss: 1.0235189
	speed: 0.0068s/iter; left time: 37.0388s
	iters: 500, epoch: 3 | loss: 0.6439548
	speed: 0.0089s/iter; left time: 47.7708s
	iters: 600, epoch: 3 | loss: 0.8683658
	speed: 0.0088s/iter; left time: 46.6010s
	iters: 700, epoch: 3 | loss: 1.0647430
	speed: 0.0078s/iter; left time: 40.3126s
	iters: 800, epoch: 3 | loss: 0.9276667
	speed: 0.0073s/iter; left time: 37.2177s
	iters: 900, epoch: 3 | loss: 0.7144132
	speed: 0.0101s/iter; left time: 50.2699s
Updating learning rate to 0.00013329916435
Epoch: 3 cost time: 8.95947813987732
Epoch: 3, Steps: 979 | Train Loss: 0.7705530 Vali Loss: 0.6346030 Best vali loss: 0.6128037
	iters: 100, epoch: 4 | loss: 0.9232967
	speed: 0.0336s/iter; left time: 161.0340s
	iters: 200, epoch: 4 | loss: 0.8104034
	speed: 0.0105s/iter; left time: 49.4017s
	iters: 300, epoch: 4 | loss: 0.9461408
	speed: 0.0108s/iter; left time: 49.4383s
	iters: 400, epoch: 4 | loss: 0.7379624
	speed: 0.0108s/iter; left time: 48.5490s
	iters: 500, epoch: 4 | loss: 0.2796174
	speed: 0.0101s/iter; left time: 44.2330s
	iters: 600, epoch: 4 | loss: 0.4361469
	speed: 0.0101s/iter; left time: 43.3033s
	iters: 700, epoch: 4 | loss: 0.9989297
	speed: 0.0123s/iter; left time: 51.5852s
	iters: 800, epoch: 4 | loss: 0.7223134
	speed: 0.0123s/iter; left time: 50.5603s
	iters: 900, epoch: 4 | loss: 0.6926059
	speed: 0.0117s/iter; left time: 46.9435s
Updating learning rate to 6.6649582175e-05
Validation loss decreased (0.6128 --> 0.5962).  Saving model state dict ...
Epoch: 4 cost time: 10.976775407791138
Epoch: 4, Steps: 979 | Train Loss: 0.7274907 Vali Loss: 0.5962107 Best vali loss: 0.5962107
	iters: 100, epoch: 5 | loss: 0.3237208
	speed: 0.0428s/iter; left time: 163.2989s
	iters: 200, epoch: 5 | loss: 1.0266576
	speed: 0.0111s/iter; left time: 41.4372s
	iters: 300, epoch: 5 | loss: 0.2794870
	speed: 0.0124s/iter; left time: 44.8129s
	iters: 400, epoch: 5 | loss: 0.7634466
	speed: 0.0106s/iter; left time: 37.3279s
	iters: 500, epoch: 5 | loss: 0.5884567
	speed: 0.0082s/iter; left time: 28.1855s
	iters: 600, epoch: 5 | loss: 0.2490914
	speed: 0.0120s/iter; left time: 39.7196s
	iters: 700, epoch: 5 | loss: 0.3378762
	speed: 0.0115s/iter; left time: 36.9678s
	iters: 800, epoch: 5 | loss: 0.2880433
	speed: 0.0112s/iter; left time: 34.8217s
	iters: 900, epoch: 5 | loss: 0.2903663
	speed: 0.0124s/iter; left time: 37.2875s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000998120144, 'e_layers': 3, 'learning_rate': 0.0005882178132, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0359160
	speed: 0.0161s/iter; left time: 124.8865s
	iters: 200, epoch: 1 | loss: 0.8476144
	speed: 0.0093s/iter; left time: 70.7027s
	iters: 300, epoch: 1 | loss: 1.2022767
	speed: 0.0087s/iter; left time: 65.7250s
	iters: 400, epoch: 1 | loss: 1.0073093
	speed: 0.0087s/iter; left time: 64.7396s
	iters: 500, epoch: 1 | loss: 1.2892177
	speed: 0.0080s/iter; left time: 58.8845s
	iters: 600, epoch: 1 | loss: 0.8332979
	speed: 0.0079s/iter; left time: 56.8006s
	iters: 700, epoch: 1 | loss: 0.5187353
	speed: 0.0080s/iter; left time: 57.1264s
	iters: 800, epoch: 1 | loss: 0.7892166
	speed: 0.0101s/iter; left time: 70.9530s
	iters: 900, epoch: 1 | loss: 0.8310404
	speed: 0.0071s/iter; left time: 49.1301s
Updating learning rate to 0.0005882178132
Validation loss decreased (inf --> 0.6239).  Saving model state dict ...
Epoch: 1 cost time: 8.936649084091187
Epoch: 1, Steps: 979 | Train Loss: 0.9282916 Vali Loss: 0.6239337 Best vali loss: 0.6239337
	iters: 100, epoch: 2 | loss: 1.0503602
	speed: 0.0589s/iter; left time: 397.8707s
	iters: 200, epoch: 2 | loss: 0.5660975
	speed: 0.0113s/iter; left time: 74.9363s
	iters: 300, epoch: 2 | loss: 0.9717771
	speed: 0.0132s/iter; left time: 86.2206s
	iters: 400, epoch: 2 | loss: 0.4748431
	speed: 0.0115s/iter; left time: 74.3015s
	iters: 500, epoch: 2 | loss: 0.9876996
	speed: 0.0118s/iter; left time: 75.2225s
	iters: 600, epoch: 2 | loss: 0.5974750
	speed: 0.0087s/iter; left time: 54.5476s
	iters: 700, epoch: 2 | loss: 0.8179885
	speed: 0.0101s/iter; left time: 62.0187s
	iters: 800, epoch: 2 | loss: 0.6151434
	speed: 0.0109s/iter; left time: 65.7716s
	iters: 900, epoch: 2 | loss: 1.9103694
	speed: 0.0107s/iter; left time: 63.9291s
Updating learning rate to 0.0002941089066
Validation loss decreased (0.6239 --> 0.6017).  Saving model state dict ...
Epoch: 2 cost time: 10.726857900619507
Epoch: 2, Steps: 979 | Train Loss: 0.8879726 Vali Loss: 0.6016733 Best vali loss: 0.6016733
	iters: 100, epoch: 3 | loss: 0.5445704
	speed: 0.1112s/iter; left time: 641.9313s
	iters: 200, epoch: 3 | loss: 0.4793683
	speed: 0.0139s/iter; left time: 78.6215s
	iters: 300, epoch: 3 | loss: 1.2090087
	speed: 0.0144s/iter; left time: 80.4771s
	iters: 400, epoch: 3 | loss: 0.5536427
	speed: 0.0132s/iter; left time: 72.1429s
	iters: 500, epoch: 3 | loss: 0.3061417
	speed: 0.0137s/iter; left time: 73.3692s
	iters: 600, epoch: 3 | loss: 0.5238783
	speed: 0.0131s/iter; left time: 69.2043s
	iters: 700, epoch: 3 | loss: 0.6701104
	speed: 0.0144s/iter; left time: 74.4680s
	iters: 800, epoch: 3 | loss: 1.0365412
	speed: 0.0128s/iter; left time: 65.0085s
	iters: 900, epoch: 3 | loss: 1.0668180
	speed: 0.0143s/iter; left time: 71.1271s
Updating learning rate to 0.0001470544533
Epoch: 3 cost time: 13.611672163009644
Epoch: 3, Steps: 979 | Train Loss: 0.7100089 Vali Loss: 0.6132407 Best vali loss: 0.6016733

best validation loss 0.6016732547526997

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0054436866271, 'e_layers': 3, 'learning_rate': 0.0031278905454, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5305134
	speed: 0.0315s/iter; left time: 120.4405s
	iters: 200, epoch: 1 | loss: 0.8641204
	speed: 0.0235s/iter; left time: 87.3026s
	iters: 300, epoch: 1 | loss: 1.3739649
	speed: 0.0223s/iter; left time: 80.6062s
	iters: 400, epoch: 1 | loss: 1.0982025
	speed: 0.0213s/iter; left time: 75.1637s
Updating learning rate to 0.0031278905454
Validation loss decreased (inf --> 0.6267).  Saving model state dict ...
Epoch: 1 cost time: 10.814955472946167
Epoch: 1, Steps: 490 | Train Loss: 0.9667003 Vali Loss: 0.6267367 Best vali loss: 0.6267367
	iters: 100, epoch: 2 | loss: 0.5423244
	speed: 0.0891s/iter; left time: 296.7557s
	iters: 200, epoch: 2 | loss: 1.0459396
	speed: 0.0188s/iter; left time: 60.8389s
	iters: 300, epoch: 2 | loss: 0.3657004
	speed: 0.0217s/iter; left time: 68.0378s
	iters: 400, epoch: 2 | loss: 0.9259151
	speed: 0.0209s/iter; left time: 63.3843s
Updating learning rate to 0.0015639452727
Validation loss decreased (0.6267 --> 0.6258).  Saving model state dict ...
Epoch: 2 cost time: 10.460743427276611
Epoch: 2, Steps: 490 | Train Loss: 0.7199699 Vali Loss: 0.6258030 Best vali loss: 0.6258030
	iters: 100, epoch: 3 | loss: 0.8811698
	speed: 0.0546s/iter; left time: 155.1647s
	iters: 200, epoch: 3 | loss: 0.2804590
	speed: 0.0155s/iter; left time: 42.4947s
	iters: 300, epoch: 3 | loss: 0.5000049
	speed: 0.0166s/iter; left time: 43.8399s
	iters: 400, epoch: 3 | loss: 0.5023980
	speed: 0.0155s/iter; left time: 39.3486s
Updating learning rate to 0.00078197263635
Validation loss decreased (0.6258 --> 0.6132).  Saving model state dict ...
Epoch: 3 cost time: 6.465884208679199
Epoch: 3, Steps: 490 | Train Loss: 0.5410079 Vali Loss: 0.6131766 Best vali loss: 0.6131766

best validation loss 0.6131766297126577

[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0059022887684, 'e_layers': 3, 'learning_rate': 0.0024672810386, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7741050
	speed: 0.0197s/iter; left time: 75.1064s
	iters: 200, epoch: 1 | loss: 0.7674741
	speed: 0.0128s/iter; left time: 47.8036s
	iters: 300, epoch: 1 | loss: 1.0839475
	speed: 0.0129s/iter; left time: 46.5621s
	iters: 400, epoch: 1 | loss: 1.1914703
	speed: 0.0081s/iter; left time: 28.4815s
Updating learning rate to 0.002373375745557865
Validation loss decreased (inf --> 0.6568).  Saving model state dict ...
Epoch: 1 cost time: 5.751748085021973
Epoch: 1, Steps: 490 | Train Loss: 0.9542492 Vali Loss: 0.6567650 Best vali loss: 0.6567650
	iters: 100, epoch: 2 | loss: 1.0886624
	speed: 0.0259s/iter; left time: 86.1407s
	iters: 200, epoch: 2 | loss: 1.5482506
	speed: 0.0104s/iter; left time: 33.4522s
	iters: 300, epoch: 2 | loss: 0.5852461
	speed: 0.0106s/iter; left time: 33.1513s
	iters: 400, epoch: 2 | loss: 0.7313723
	speed: 0.0094s/iter; left time: 28.5959s
Updating learning rate to 0.002105956096043524
Validation loss decreased (0.6568 --> 0.6505).  Saving model state dict ...
Epoch: 2 cost time: 5.298665523529053
Epoch: 2, Steps: 490 | Train Loss: 0.9883828 Vali Loss: 0.6504930 Best vali loss: 0.6504930
	iters: 100, epoch: 3 | loss: 1.1169797
	speed: 0.0303s/iter; left time: 86.2032s
	iters: 200, epoch: 3 | loss: 1.2673916
	speed: 0.0107s/iter; left time: 29.4452s
	iters: 300, epoch: 3 | loss: 0.9555911
	speed: 0.0098s/iter; left time: 25.8865s
	iters: 400, epoch: 3 | loss: 0.4432685
	speed: 0.0087s/iter; left time: 22.0645s
Updating learning rate to 0.0017057343075303757
Validation loss decreased (0.6505 --> 0.6495).  Saving model state dict ...
Epoch: 3 cost time: 4.995982646942139
Epoch: 3, Steps: 490 | Train Loss: 0.9458077 Vali Loss: 0.6494941 Best vali loss: 0.6494941

best validation loss 0.6494940779292986

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000998120144, 'e_layers': 3, 'learning_rate': 0.0005882178132, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9682640
	speed: 0.0163s/iter; left time: 78.1847s
	iters: 200, epoch: 4 | loss: 0.8365220
	speed: 0.0094s/iter; left time: 43.9565s
	iters: 300, epoch: 4 | loss: 0.7984024
	speed: 0.0096s/iter; left time: 43.9608s
	iters: 400, epoch: 4 | loss: 0.9973410
	speed: 0.0102s/iter; left time: 45.7916s
	iters: 500, epoch: 4 | loss: 1.2832738
	speed: 0.0079s/iter; left time: 34.8811s
	iters: 600, epoch: 4 | loss: 0.7908607
	speed: 0.0111s/iter; left time: 47.8809s
	iters: 700, epoch: 4 | loss: 0.5256376
	speed: 0.0105s/iter; left time: 44.1404s
	iters: 800, epoch: 4 | loss: 0.7322445
	speed: 0.0098s/iter; left time: 40.2407s
	iters: 900, epoch: 4 | loss: 0.7962319
	speed: 0.0115s/iter; left time: 46.0192s
Updating learning rate to 7.352722665e-05
Epoch: 4 cost time: 10.244808912277222
Epoch: 4, Steps: 979 | Train Loss: 0.8587531 Vali Loss: 0.6307979 Best vali loss: 0.6016733
	iters: 100, epoch: 5 | loss: 0.8272281
	speed: 0.0408s/iter; left time: 155.8429s
	iters: 200, epoch: 5 | loss: 0.5470185
	speed: 0.0119s/iter; left time: 44.3593s
	iters: 300, epoch: 5 | loss: 0.8141991
	speed: 0.0077s/iter; left time: 27.8163s
	iters: 400, epoch: 5 | loss: 0.4536214
	speed: 0.0076s/iter; left time: 26.6929s
	iters: 500, epoch: 5 | loss: 0.9506567
	speed: 0.0159s/iter; left time: 54.3281s
	iters: 600, epoch: 5 | loss: 0.5815268
	speed: 0.0183s/iter; left time: 60.6383s
	iters: 700, epoch: 5 | loss: 0.8193665
	speed: 0.0170s/iter; left time: 54.8211s
	iters: 800, epoch: 5 | loss: 0.5849484
	speed: 0.0169s/iter; left time: 52.6064s
	iters: 900, epoch: 5 | loss: 1.8582039
	speed: 0.0167s/iter; left time: 50.3586s
Updating learning rate to 3.6763613325e-05
Epoch: 5 cost time: 13.482849836349487
Epoch: 5, Steps: 979 | Train Loss: 0.8263077 Vali Loss: 0.6233008 Best vali loss: 0.6016733
	iters: 100, epoch: 6 | loss: 0.5573845
	speed: 0.0487s/iter; left time: 138.1770s
	iters: 200, epoch: 6 | loss: 0.4909251
	speed: 0.0082s/iter; left time: 22.3575s
	iters: 300, epoch: 6 | loss: 1.2169157
	speed: 0.0098s/iter; left time: 25.7463s
	iters: 400, epoch: 6 | loss: 0.5595449
	speed: 0.0092s/iter; left time: 23.4731s
	iters: 500, epoch: 6 | loss: 0.2777009
	speed: 0.0092s/iter; left time: 22.5381s
	iters: 600, epoch: 6 | loss: 0.4817447
	speed: 0.0092s/iter; left time: 21.5570s
	iters: 700, epoch: 6 | loss: 0.6839321
	speed: 0.0090s/iter; left time: 20.0363s
	iters: 800, epoch: 6 | loss: 0.8216084
	speed: 0.0092s/iter; left time: 19.6522s
	iters: 900, epoch: 6 | loss: 0.9808155
	speed: 0.0086s/iter; left time: 17.6192s
Updating learning rate to 1.83818066625e-05
Epoch: 6 cost time: 8.595629453659058
Epoch: 6, Steps: 979 | Train Loss: 0.6745080 Vali Loss: 0.6280356 Best vali loss: 0.6016733
	iters: 100, epoch: 7 | loss: 0.9947051
	speed: 0.0253s/iter; left time: 47.0745s
	iters: 200, epoch: 7 | loss: 1.2164677
	speed: 0.0083s/iter; left time: 14.6773s
	iters: 300, epoch: 7 | loss: 1.3656425
	speed: 0.0074s/iter; left time: 12.3175s
	iters: 400, epoch: 7 | loss: 0.7654814
	speed: 0.0087s/iter; left time: 13.5671s
	iters: 500, epoch: 7 | loss: 0.7732875
	speed: 0.0071s/iter; left time: 10.3769s
	iters: 600, epoch: 7 | loss: 0.6782129
	speed: 0.0066s/iter; left time: 8.9739s
	iters: 700, epoch: 7 | loss: 0.6778632
	speed: 0.0095s/iter; left time: 11.9460s
	iters: 800, epoch: 7 | loss: 0.2286637
	speed: 0.0095s/iter; left time: 10.9891s
	iters: 900, epoch: 7 | loss: 0.7158476
	speed: 0.0096s/iter; left time: 10.2078s
Updating learning rate to 9.19090333125e-06
Epoch: 7 cost time: 8.311259269714355
Epoch: 7, Steps: 979 | Train Loss: 0.8240191 Vali Loss: 0.6279528 Best vali loss: 0.6016733
	iters: 100, epoch: 8 | loss: 0.3472265
	speed: 0.0315s/iter; left time: 27.6867s
	iters: 200, epoch: 8 | loss: 0.2415986
	speed: 0.0091s/iter; left time: 7.0973s
	iters: 300, epoch: 8 | loss: 0.4375607
	speed: 0.0070s/iter; left time: 4.7389s
	iters: 400, epoch: 8 | loss: 1.2939162
	speed: 0.0076s/iter; left time: 4.4000s
	iters: 500, epoch: 8 | loss: 1.1026253
	speed: 0.0125s/iter; left time: 5.9903s
	iters: 600, epoch: 8 | loss: 0.4669266
	speed: 0.0121s/iter; left time: 4.5970s
	iters: 700, epoch: 8 | loss: 0.9895421
	speed: 0.0117s/iter; left time: 3.2652s
	iters: 800, epoch: 8 | loss: 0.5305787
	speed: 0.0126s/iter; left time: 2.2666s
	iters: 900, epoch: 8 | loss: 0.2882451
	speed: 0.0067s/iter; left time: 0.5358s
Updating learning rate to 4.595451665625e-06
Epoch: 8 cost time: 9.454345464706421
Epoch: 8, Steps: 979 | Train Loss: 0.6331355 Vali Loss: 0.6281866 Best vali loss: 0.6016733

best validation loss 0.6016732547526997

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002924796084, 'e_layers': 2, 'learning_rate': 0.0023564983436, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0023564983436
Validation loss decreased (inf --> 0.6210).  Saving model state dict ...
Epoch: 1 cost time: 0.9416577816009521
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6210103 Best vali loss: 0.6210103
Updating learning rate to 0.0011782491718
Validation loss decreased (0.6210 --> 0.6037).  Saving model state dict ...
Epoch: 2 cost time: 0.6714315414428711
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6036959 Best vali loss: 0.6036959
Updating learning rate to 0.0005891245859
Validation loss decreased (0.6037 --> 0.6026).  Saving model state dict ...
Epoch: 3 cost time: 0.6098074913024902
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6025703 Best vali loss: 0.6025703
Updating learning rate to 0.00029456229295
Epoch: 4 cost time: 0.501312255859375
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6127263 Best vali loss: 0.6025703
Updating learning rate to 0.000147281146475
Epoch: 5 cost time: 0.5141253471374512
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6166272 Best vali loss: 0.6025703
Updating learning rate to 7.36405732375e-05
Epoch: 6 cost time: 0.5150947570800781
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6165591 Best vali loss: 0.6025703
Updating learning rate to 3.682028661875e-05
Epoch: 7 cost time: 0.5374114513397217
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6172895 Best vali loss: 0.6025703
Updating learning rate to 1.8410143309375e-05
Epoch: 8 cost time: 0.501013994216919
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6159213 Best vali loss: 0.6025703

best validation loss 0.6025703278805911

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0032277578285, 'e_layers': 2, 'learning_rate': 0.0001802980817, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3411056
	speed: 0.0125s/iter; left time: 96.6971s
	iters: 200, epoch: 1 | loss: 0.5096098
	speed: 0.0068s/iter; left time: 51.5336s
	iters: 300, epoch: 1 | loss: 1.4507288
	speed: 0.0069s/iter; left time: 51.9144s
	iters: 400, epoch: 1 | loss: 0.4104503
	speed: 0.0056s/iter; left time: 41.4240s
	iters: 500, epoch: 1 | loss: 0.6801961
	speed: 0.0050s/iter; left time: 36.7491s
	iters: 600, epoch: 1 | loss: 0.5520831
	speed: 0.0056s/iter; left time: 40.2304s
	iters: 700, epoch: 1 | loss: 1.9151511
	speed: 0.0067s/iter; left time: 47.9389s
	iters: 800, epoch: 1 | loss: 1.0380119
	speed: 0.0065s/iter; left time: 45.8282s
	iters: 900, epoch: 1 | loss: 0.3966980
	speed: 0.0064s/iter; left time: 44.3102s
Updating learning rate to 0.0001734358945668389
Validation loss decreased (inf --> 0.6275).  Saving model state dict ...
Epoch: 1 cost time: 6.422209024429321
Epoch: 1, Steps: 979 | Train Loss: 0.8104483 Vali Loss: 0.6275260 Best vali loss: 0.6275260
	iters: 100, epoch: 2 | loss: 1.4604359
	speed: 0.0237s/iter; left time: 160.0744s
	iters: 200, epoch: 2 | loss: 1.0404150
	speed: 0.0060s/iter; left time: 39.8371s
	iters: 300, epoch: 2 | loss: 1.1271173
	speed: 0.0056s/iter; left time: 36.8040s
	iters: 400, epoch: 2 | loss: 0.6122279
	speed: 0.0061s/iter; left time: 39.4297s
	iters: 500, epoch: 2 | loss: 0.5441117
	speed: 0.0067s/iter; left time: 42.8309s
	iters: 600, epoch: 2 | loss: 0.8380690
	speed: 0.0057s/iter; left time: 35.9050s
	iters: 700, epoch: 2 | loss: 0.3995269
	speed: 0.0056s/iter; left time: 34.1706s
	iters: 800, epoch: 2 | loss: 1.1214131
	speed: 0.0057s/iter; left time: 34.7338s
	iters: 900, epoch: 2 | loss: 1.5155234
	speed: 0.0062s/iter; left time: 36.7800s
Updating learning rate to 0.0001538940389524981
Validation loss decreased (0.6275 --> 0.6095).  Saving model state dict ...
Epoch: 2 cost time: 5.876879692077637
Epoch: 2, Steps: 979 | Train Loss: 0.9620933 Vali Loss: 0.6095105 Best vali loss: 0.6095105
	iters: 100, epoch: 3 | loss: 0.8695787
	speed: 0.0186s/iter; left time: 107.2666s
	iters: 200, epoch: 3 | loss: 0.9836428
	speed: 0.0055s/iter; left time: 31.1402s
	iters: 300, epoch: 3 | loss: 0.9331667
	speed: 0.0054s/iter; left time: 29.9714s
	iters: 400, epoch: 3 | loss: 0.8858702
	speed: 0.0057s/iter; left time: 30.9550s
	iters: 500, epoch: 3 | loss: 0.8845100
	speed: 0.0060s/iter; left time: 32.0894s
	iters: 600, epoch: 3 | loss: 1.0423656
	speed: 0.0061s/iter; left time: 32.0534s
	iters: 700, epoch: 3 | loss: 0.7018665
	speed: 0.0057s/iter; left time: 29.5220s
	iters: 800, epoch: 3 | loss: 0.2753119
	speed: 0.0061s/iter; left time: 30.9926s
	iters: 900, epoch: 3 | loss: 0.3681563
	speed: 0.0062s/iter; left time: 30.7823s
Updating learning rate to 0.00012464758522689868
Validation loss decreased (0.6095 --> 0.6032).  Saving model state dict ...
Epoch: 3 cost time: 5.742212533950806
Epoch: 3, Steps: 979 | Train Loss: 0.7716076 Vali Loss: 0.6031824 Best vali loss: 0.6031824
	iters: 100, epoch: 4 | loss: 1.2651116
	speed: 0.0202s/iter; left time: 96.7686s
	iters: 200, epoch: 4 | loss: 0.7472754
	speed: 0.0053s/iter; left time: 24.8704s
	iters: 300, epoch: 4 | loss: 0.4670266
	speed: 0.0045s/iter; left time: 20.6370s
	iters: 400, epoch: 4 | loss: 0.3731582
	speed: 0.0046s/iter; left time: 20.6657s
	iters: 500, epoch: 4 | loss: 0.9062527
	speed: 0.0058s/iter; left time: 25.6263s
	iters: 600, epoch: 4 | loss: 0.5120163
	speed: 0.0073s/iter; left time: 31.4001s
	iters: 700, epoch: 4 | loss: 1.2657890
	speed: 0.0079s/iter; left time: 32.9785s
	iters: 800, epoch: 4 | loss: 1.1521826
	speed: 0.0078s/iter; left time: 31.7893s
	iters: 900, epoch: 4 | loss: 0.7121454
	speed: 0.0076s/iter; left time: 30.5403s
Updating learning rate to 9.014904085e-05
Epoch: 4 cost time: 6.223159551620483
Epoch: 4, Steps: 979 | Train Loss: 0.8223286 Vali Loss: 0.6109650 Best vali loss: 0.6031824
	iters: 100, epoch: 5 | loss: 0.3468402
	speed: 0.0247s/iter; left time: 94.1575s
	iters: 200, epoch: 5 | loss: 1.1077895
	speed: 0.0092s/iter; left time: 34.0196s
	iters: 300, epoch: 5 | loss: 1.3484130
	speed: 0.0060s/iter; left time: 21.7740s
	iters: 400, epoch: 5 | loss: 0.7005846
	speed: 0.0050s/iter; left time: 17.6892s
	iters: 500, epoch: 5 | loss: 1.0722466
	speed: 0.0057s/iter; left time: 19.6170s
	iters: 600, epoch: 5 | loss: 1.5365297
	speed: 0.0055s/iter; left time: 18.2569s
	iters: 700, epoch: 5 | loss: 0.9857255
	speed: 0.0059s/iter; left time: 18.8572s
	iters: 800, epoch: 5 | loss: 0.8700361
	speed: 0.0052s/iter; left time: 16.1814s
	iters: 900, epoch: 5 | loss: 1.4287180
	speed: 0.0051s/iter; left time: 15.4823s
Updating learning rate to 5.5650496473101316e-05
Epoch: 5 cost time: 6.1647422313690186
Epoch: 5, Steps: 979 | Train Loss: 1.0440981 Vali Loss: 0.6110231 Best vali loss: 0.6031824
	iters: 100, epoch: 6 | loss: 0.9088867
	speed: 0.0208s/iter; left time: 59.1605s
	iters: 200, epoch: 6 | loss: 1.8734567
	speed: 0.0060s/iter; left time: 16.3060s
	iters: 300, epoch: 6 | loss: 0.9237451
	speed: 0.0060s/iter; left time: 15.8803s
	iters: 400, epoch: 6 | loss: 1.5071735
	speed: 0.0060s/iter; left time: 15.2677s
	iters: 500, epoch: 6 | loss: 0.7208729
	speed: 0.0060s/iter; left time: 14.7032s
	iters: 600, epoch: 6 | loss: 1.5016065
	speed: 0.0061s/iter; left time: 14.3484s
	iters: 700, epoch: 6 | loss: 0.3052230
	speed: 0.0064s/iter; left time: 14.4151s
	iters: 800, epoch: 6 | loss: 0.7848487
	speed: 0.0059s/iter; left time: 12.5421s
	iters: 900, epoch: 6 | loss: 0.5017799
	speed: 0.0053s/iter; left time: 10.8344s
Updating learning rate to 2.6404042747501922e-05
Epoch: 6 cost time: 5.825721740722656
Epoch: 6, Steps: 979 | Train Loss: 1.0030659 Vali Loss: 0.6226432 Best vali loss: 0.6031824
	iters: 100, epoch: 7 | loss: 0.7576662
	speed: 0.0208s/iter; left time: 38.6614s
	iters: 200, epoch: 7 | loss: 0.4795485
	speed: 0.0058s/iter; left time: 10.2813s
	iters: 300, epoch: 7 | loss: 1.4182842
	speed: 0.0061s/iter; left time: 10.1964s
	iters: 400, epoch: 7 | loss: 1.1233287
	speed: 0.0060s/iter; left time: 9.2778s
	iters: 500, epoch: 7 | loss: 0.7430021
	speed: 0.0058s/iter; left time: 8.4511s
	iters: 600, epoch: 7 | loss: 0.9269462
	speed: 0.0060s/iter; left time: 8.1956s
	iters: 700, epoch: 7 | loss: 0.3583465
	speed: 0.0059s/iter; left time: 7.4598s
	iters: 800, epoch: 7 | loss: 1.0650547
	speed: 0.0057s/iter; left time: 6.5571s
	iters: 900, epoch: 7 | loss: 0.8088657
	speed: 0.0051s/iter; left time: 5.3505s
Updating learning rate to 6.862187133161109e-06
Epoch: 7 cost time: 5.664321184158325
Epoch: 7, Steps: 979 | Train Loss: 0.8534492 Vali Loss: 0.6181678 Best vali loss: 0.6031824
	iters: 100, epoch: 8 | loss: 0.4215273
	speed: 0.0279s/iter; left time: 24.5520s
	iters: 200, epoch: 8 | loss: 1.0759540
	speed: 0.0093s/iter; left time: 7.2868s
	iters: 300, epoch: 8 | loss: 0.6468780
	speed: 0.0083s/iter; left time: 5.6571s
	iters: 400, epoch: 8 | loss: 0.8787840
	speed: 0.0055s/iter; left time: 3.1993s
	iters: 500, epoch: 8 | loss: 0.4655702
	speed: 0.0051s/iter; left time: 2.4241s
	iters: 600, epoch: 8 | loss: 0.4679137
	speed: 0.0048s/iter; left time: 1.8216s
	iters: 700, epoch: 8 | loss: 1.6036391
	speed: 0.0044s/iter; left time: 1.2284s
	iters: 800, epoch: 8 | loss: 0.3147840
	speed: 0.0041s/iter; left time: 0.7386s
	iters: 900, epoch: 8 | loss: 0.3741220
	speed: 0.0057s/iter; left time: 0.4592s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.436554431915283
Epoch: 8, Steps: 979 | Train Loss: 0.6943525 Vali Loss: 0.6177784 Best vali loss: 0.6031824

best validation loss 0.6031823508279404

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009225062942, 'e_layers': 1, 'learning_rate': 0.0034509285106, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0033195853648514996
Validation loss decreased (inf --> 0.6217).  Saving model state dict ...
Epoch: 1 cost time: 1.1763863563537598
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6217085 Best vali loss: 0.6217085
Updating learning rate to 0.002945551730917626
Validation loss decreased (0.6217 --> 0.6134).  Saving model state dict ...
Epoch: 2 cost time: 1.2221715450286865
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6133645 Best vali loss: 0.6133645
Updating learning rate to 0.0023857708389414777
Epoch: 3 cost time: 1.0411205291748047
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6579207 Best vali loss: 0.6133645

best validation loss 0.6133644618904188

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0025546905279, 'e_layers': 3, 'learning_rate': 0.0006512109997, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5276172
	speed: 0.0187s/iter; left time: 144.4722s
	iters: 200, epoch: 1 | loss: 0.2586296
	speed: 0.0112s/iter; left time: 85.7544s
	iters: 300, epoch: 1 | loss: 0.6342909
	speed: 0.0115s/iter; left time: 86.9170s
	iters: 400, epoch: 1 | loss: 0.3984633
	speed: 0.0127s/iter; left time: 94.2241s
	iters: 500, epoch: 1 | loss: 0.4811081
	speed: 0.0112s/iter; left time: 82.1234s
	iters: 600, epoch: 1 | loss: 1.4130312
	speed: 0.0142s/iter; left time: 102.7647s
	iters: 700, epoch: 1 | loss: 0.2860362
	speed: 0.0143s/iter; left time: 101.8007s
	iters: 800, epoch: 1 | loss: 1.1347990
	speed: 0.0136s/iter; left time: 95.6466s
	iters: 900, epoch: 1 | loss: 1.1965127
	speed: 0.0141s/iter; left time: 97.6563s
Updating learning rate to 0.0006512109997
Validation loss decreased (inf --> 0.6128).  Saving model state dict ...
Epoch: 1 cost time: 12.95160698890686
Epoch: 1, Steps: 979 | Train Loss: 0.7033876 Vali Loss: 0.6127863 Best vali loss: 0.6127863
	iters: 100, epoch: 2 | loss: 0.6982561
	speed: 0.0973s/iter; left time: 656.9126s
	iters: 200, epoch: 2 | loss: 0.4663674
	speed: 0.0145s/iter; left time: 96.3052s
	iters: 300, epoch: 2 | loss: 0.5855133
	speed: 0.0159s/iter; left time: 104.2853s
	iters: 400, epoch: 2 | loss: 0.6629428
	speed: 0.0156s/iter; left time: 100.6489s
	iters: 500, epoch: 2 | loss: 0.7340462
	speed: 0.0140s/iter; left time: 89.1283s
	iters: 600, epoch: 2 | loss: 0.4901544
	speed: 0.0146s/iter; left time: 91.3261s
	iters: 700, epoch: 2 | loss: 1.4714102
	speed: 0.0122s/iter; left time: 74.9674s
	iters: 800, epoch: 2 | loss: 0.7589628
	speed: 0.0117s/iter; left time: 70.7729s
	iters: 900, epoch: 2 | loss: 0.6469253
	speed: 0.0112s/iter; left time: 66.5618s
Updating learning rate to 0.00032560549985
Validation loss decreased (0.6128 --> 0.6094).  Saving model state dict ...
Epoch: 2 cost time: 13.356557846069336
Epoch: 2, Steps: 979 | Train Loss: 0.7238420 Vali Loss: 0.6094419 Best vali loss: 0.6094419
	iters: 100, epoch: 3 | loss: 0.8986960
	speed: 0.0473s/iter; left time: 273.1934s
	iters: 200, epoch: 3 | loss: 1.2394402
	speed: 0.0102s/iter; left time: 57.7224s
	iters: 300, epoch: 3 | loss: 0.9028962
	speed: 0.0077s/iter; left time: 42.9056s
	iters: 400, epoch: 3 | loss: 0.3203130
	speed: 0.0078s/iter; left time: 42.9672s
	iters: 500, epoch: 3 | loss: 0.8993819
	speed: 0.0079s/iter; left time: 42.6105s
	iters: 600, epoch: 3 | loss: 0.5773201
	speed: 0.0087s/iter; left time: 45.7175s
	iters: 700, epoch: 3 | loss: 0.8484966
	speed: 0.0088s/iter; left time: 45.2982s
	iters: 800, epoch: 3 | loss: 0.7262342
	speed: 0.0094s/iter; left time: 47.5121s
	iters: 900, epoch: 3 | loss: 0.8765032
	speed: 0.0065s/iter; left time: 32.3097s
Updating learning rate to 0.000162802749925
Validation loss decreased (0.6094 --> 0.6072).  Saving model state dict ...
Epoch: 3 cost time: 8.468470096588135
Epoch: 3, Steps: 979 | Train Loss: 0.8099202 Vali Loss: 0.6071747 Best vali loss: 0.6071747

best validation loss 0.6071747418756785

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0011857304294, 'e_layers': 1, 'learning_rate': 0.0027601008743, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3099086
	speed: 0.0103s/iter; left time: 79.8607s
	iters: 200, epoch: 1 | loss: 0.6487764
	speed: 0.0041s/iter; left time: 31.5541s
	iters: 300, epoch: 1 | loss: 1.1872170
	speed: 0.0041s/iter; left time: 30.9897s
	iters: 400, epoch: 1 | loss: 0.8887507
	speed: 0.0040s/iter; left time: 29.5112s
	iters: 500, epoch: 1 | loss: 0.6670707
	speed: 0.0042s/iter; left time: 30.6175s
	iters: 600, epoch: 1 | loss: 0.3741193
	speed: 0.0043s/iter; left time: 30.8666s
	iters: 700, epoch: 1 | loss: 0.2828431
	speed: 0.0043s/iter; left time: 30.7805s
	iters: 800, epoch: 1 | loss: 0.5867642
	speed: 0.0043s/iter; left time: 30.4321s
	iters: 900, epoch: 1 | loss: 0.8841805
	speed: 0.0042s/iter; left time: 29.0798s
Updating learning rate to 0.0027601008743
Validation loss decreased (inf --> 0.6129).  Saving model state dict ...
Epoch: 1 cost time: 4.422533750534058
Epoch: 1, Steps: 979 | Train Loss: 0.6477367 Vali Loss: 0.6129249 Best vali loss: 0.6129249
	iters: 100, epoch: 2 | loss: 0.9227938
	speed: 0.0170s/iter; left time: 114.6212s
	iters: 200, epoch: 2 | loss: 0.2942386
	speed: 0.0041s/iter; left time: 27.0797s
	iters: 300, epoch: 2 | loss: 0.8131210
	speed: 0.0040s/iter; left time: 26.4984s
	iters: 400, epoch: 2 | loss: 0.7947079
	speed: 0.0039s/iter; left time: 25.3496s
	iters: 500, epoch: 2 | loss: 0.3534455
	speed: 0.0041s/iter; left time: 26.0707s
	iters: 600, epoch: 2 | loss: 0.6554757
	speed: 0.0042s/iter; left time: 26.0169s
	iters: 700, epoch: 2 | loss: 0.5583699
	speed: 0.0044s/iter; left time: 26.8228s
	iters: 800, epoch: 2 | loss: 1.4797542
	speed: 0.0044s/iter; left time: 26.3502s
	iters: 900, epoch: 2 | loss: 0.8611905
	speed: 0.0044s/iter; left time: 26.3425s
Updating learning rate to 0.00138005043715
Validation loss decreased (0.6129 --> 0.5962).  Saving model state dict ...
Epoch: 2 cost time: 4.141436815261841
Epoch: 2, Steps: 979 | Train Loss: 0.7481219 Vali Loss: 0.5961989 Best vali loss: 0.5961989
	iters: 100, epoch: 3 | loss: 0.2794066
	speed: 0.0169s/iter; left time: 97.6285s
	iters: 200, epoch: 3 | loss: 0.7347931
	speed: 0.0043s/iter; left time: 24.3471s
	iters: 300, epoch: 3 | loss: 1.1894776
	speed: 0.0043s/iter; left time: 23.8965s
	iters: 400, epoch: 3 | loss: 1.4055250
	speed: 0.0043s/iter; left time: 23.4523s
	iters: 500, epoch: 3 | loss: 1.1514878
	speed: 0.0040s/iter; left time: 21.5896s
	iters: 600, epoch: 3 | loss: 0.3069641
	speed: 0.0042s/iter; left time: 22.1455s
	iters: 700, epoch: 3 | loss: 1.5762545
	speed: 0.0038s/iter; left time: 19.6987s
	iters: 800, epoch: 3 | loss: 0.3646489
	speed: 0.0036s/iter; left time: 18.3556s
	iters: 900, epoch: 3 | loss: 0.7480419
	speed: 0.0039s/iter; left time: 19.6046s
Updating learning rate to 0.000690025218575
Epoch: 3 cost time: 4.216132879257202
Epoch: 3, Steps: 979 | Train Loss: 0.8618444 Vali Loss: 0.6048150 Best vali loss: 0.5961989

best validation loss 0.5961988746485518

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0011857304294, 'e_layers': 1, 'learning_rate': 0.0027601008743, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2984552
	speed: 0.0118s/iter; left time: 56.7320s
	iters: 200, epoch: 4 | loss: 0.6105648
	speed: 0.0037s/iter; left time: 17.2434s
	iters: 300, epoch: 4 | loss: 1.1367913
	speed: 0.0035s/iter; left time: 15.9607s
	iters: 400, epoch: 4 | loss: 0.8386496
	speed: 0.0044s/iter; left time: 19.8767s
	iters: 500, epoch: 4 | loss: 0.6349385
	speed: 0.0047s/iter; left time: 20.6447s
	iters: 600, epoch: 4 | loss: 0.3965665
	speed: 0.0047s/iter; left time: 20.3667s
	iters: 700, epoch: 4 | loss: 0.2544239
	speed: 0.0047s/iter; left time: 19.7305s
	iters: 800, epoch: 4 | loss: 0.5966117
	speed: 0.0049s/iter; left time: 20.1251s
	iters: 900, epoch: 4 | loss: 0.8444497
	speed: 0.0049s/iter; left time: 19.4002s
Updating learning rate to 0.0003450126092875
Epoch: 4 cost time: 4.7621471881866455
Epoch: 4, Steps: 979 | Train Loss: 0.6234946 Vali Loss: 0.6283335 Best vali loss: 0.5961989
	iters: 100, epoch: 5 | loss: 0.9282078
	speed: 0.0178s/iter; left time: 68.0951s
	iters: 200, epoch: 5 | loss: 0.2850590
	speed: 0.0046s/iter; left time: 16.9174s
	iters: 300, epoch: 5 | loss: 0.7783011
	speed: 0.0046s/iter; left time: 16.7597s
	iters: 400, epoch: 5 | loss: 0.8176613
	speed: 0.0045s/iter; left time: 15.9482s
	iters: 500, epoch: 5 | loss: 0.3830279
	speed: 0.0046s/iter; left time: 15.5899s
	iters: 600, epoch: 5 | loss: 0.6374418
	speed: 0.0043s/iter; left time: 14.1320s
	iters: 700, epoch: 5 | loss: 0.4800565
	speed: 0.0038s/iter; left time: 12.2244s
	iters: 800, epoch: 5 | loss: 1.1307343
	speed: 0.0039s/iter; left time: 12.2260s
	iters: 900, epoch: 5 | loss: 0.7380055
	speed: 0.0046s/iter; left time: 13.8396s
Updating learning rate to 0.00017250630464375
Epoch: 5 cost time: 4.367568254470825
Epoch: 5, Steps: 979 | Train Loss: 0.6864995 Vali Loss: 0.6238804 Best vali loss: 0.5961989
	iters: 100, epoch: 6 | loss: 0.2802873
	speed: 0.0180s/iter; left time: 51.1854s
	iters: 200, epoch: 6 | loss: 0.7035707
	speed: 0.0041s/iter; left time: 11.2884s
	iters: 300, epoch: 6 | loss: 1.1916425
	speed: 0.0043s/iter; left time: 11.3719s
	iters: 400, epoch: 6 | loss: 0.8144684
	speed: 0.0038s/iter; left time: 9.6246s
	iters: 500, epoch: 6 | loss: 0.5833874
	speed: 0.0036s/iter; left time: 8.6623s
	iters: 600, epoch: 6 | loss: 0.2840887
	speed: 0.0043s/iter; left time: 9.9938s
	iters: 700, epoch: 6 | loss: 1.5106232
	speed: 0.0060s/iter; left time: 13.4584s
	iters: 800, epoch: 6 | loss: 0.3644921
	speed: 0.0055s/iter; left time: 11.7761s
	iters: 900, epoch: 6 | loss: 0.7520292
	speed: 0.0060s/iter; left time: 12.1930s
Updating learning rate to 8.6253152321875e-05
Epoch: 6 cost time: 4.747638702392578
Epoch: 6, Steps: 979 | Train Loss: 0.7205099 Vali Loss: 0.6301266 Best vali loss: 0.5961989
	iters: 100, epoch: 7 | loss: 0.9014555
	speed: 0.0235s/iter; left time: 43.7371s
	iters: 200, epoch: 7 | loss: 0.9630383
	speed: 0.0055s/iter; left time: 9.7293s
	iters: 300, epoch: 7 | loss: 0.7867717
	speed: 0.0057s/iter; left time: 9.4661s
	iters: 400, epoch: 7 | loss: 0.3126120
	speed: 0.0056s/iter; left time: 8.7870s
	iters: 500, epoch: 7 | loss: 1.4600307
	speed: 0.0058s/iter; left time: 8.4787s
	iters: 600, epoch: 7 | loss: 0.5020870
	speed: 0.0044s/iter; left time: 5.9799s
	iters: 700, epoch: 7 | loss: 1.3812686
	speed: 0.0036s/iter; left time: 4.4824s
	iters: 800, epoch: 7 | loss: 1.1514069
	speed: 0.0039s/iter; left time: 4.5330s
	iters: 900, epoch: 7 | loss: 0.6411282
	speed: 0.0042s/iter; left time: 4.4224s
Updating learning rate to 4.31265761609375e-05
Epoch: 7 cost time: 4.803699493408203
Epoch: 7, Steps: 979 | Train Loss: 0.8999776 Vali Loss: 0.6313027 Best vali loss: 0.5961989
	iters: 100, epoch: 8 | loss: 1.0738850
	speed: 0.0168s/iter; left time: 14.7475s
	iters: 200, epoch: 8 | loss: 1.0149162
	speed: 0.0042s/iter; left time: 3.3039s
	iters: 300, epoch: 8 | loss: 0.4473388
	speed: 0.0041s/iter; left time: 2.7889s
	iters: 400, epoch: 8 | loss: 0.8482519
	speed: 0.0042s/iter; left time: 2.4281s
	iters: 500, epoch: 8 | loss: 0.3253019
	speed: 0.0044s/iter; left time: 2.1147s
	iters: 600, epoch: 8 | loss: 0.9901009
	speed: 0.0045s/iter; left time: 1.6919s
	iters: 700, epoch: 8 | loss: 1.0911542
	speed: 0.0043s/iter; left time: 1.1914s
	iters: 800, epoch: 8 | loss: 1.0461574
	speed: 0.0042s/iter; left time: 0.7611s
	iters: 900, epoch: 8 | loss: 0.7764237
	speed: 0.0042s/iter; left time: 0.3396s
Updating learning rate to 2.156328808046875e-05
Epoch: 8 cost time: 4.200310945510864
Epoch: 8, Steps: 979 | Train Loss: 0.8459478 Vali Loss: 0.6345645 Best vali loss: 0.5961989

best validation loss 0.5961988746485518

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0088883810649, 'e_layers': 2, 'learning_rate': 0.000686764093, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000686764093
Validation loss decreased (inf --> 0.6027).  Saving model state dict ...
Epoch: 1 cost time: 1.6542446613311768
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6027355 Best vali loss: 0.6027355
Updating learning rate to 0.0003433820465
Epoch: 2 cost time: 1.0231132507324219
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6207837 Best vali loss: 0.6027355
Updating learning rate to 0.00017169102325
Epoch: 3 cost time: 0.9959301948547363
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6108857 Best vali loss: 0.6027355
Updating learning rate to 8.5845511625e-05
Validation loss decreased (0.6027 --> 0.5792).  Saving model state dict ...
Epoch: 4 cost time: 1.1893422603607178
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5791641 Best vali loss: 0.5791641
Updating learning rate to 4.29227558125e-05
Validation loss decreased (0.5792 --> 0.5610).  Saving model state dict ...
Epoch: 5 cost time: 1.5917901992797852
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5610265 Best vali loss: 0.5610265
Updating learning rate to 2.146137790625e-05
Epoch: 6 cost time: 1.1844921112060547
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5645247 Best vali loss: 0.5610265
Updating learning rate to 1.0730688953125e-05
Validation loss decreased (0.5610 --> 0.5589).  Saving model state dict ...
Epoch: 7 cost time: 1.0744261741638184
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5589305 Best vali loss: 0.5589305
Updating learning rate to 5.3653444765625e-06
Validation loss decreased (0.5589 --> 0.5566).  Saving model state dict ...
Epoch: 8 cost time: 0.8286314010620117
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5565688 Best vali loss: 0.5565688

best validation loss 0.5565688493680976

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013113448531, 'e_layers': 3, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9753560
	speed: 0.0127s/iter; left time: 98.3107s
	iters: 200, epoch: 1 | loss: 0.9935954
	speed: 0.0078s/iter; left time: 59.4594s
	iters: 300, epoch: 1 | loss: 0.6572344
	speed: 0.0087s/iter; left time: 65.1684s
	iters: 400, epoch: 1 | loss: 0.5480204
	speed: 0.0090s/iter; left time: 66.9975s
	iters: 500, epoch: 1 | loss: 0.6747357
	speed: 0.0067s/iter; left time: 49.0242s
	iters: 600, epoch: 1 | loss: 1.2516658
	speed: 0.0068s/iter; left time: 48.8463s
	iters: 700, epoch: 1 | loss: 0.4585420
	speed: 0.0086s/iter; left time: 61.0003s
	iters: 800, epoch: 1 | loss: 0.7862787
	speed: 0.0087s/iter; left time: 61.4430s
	iters: 900, epoch: 1 | loss: 0.9938114
	speed: 0.0089s/iter; left time: 61.8772s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.6160).  Saving model state dict ...
Epoch: 1 cost time: 8.186464071273804
Epoch: 1, Steps: 979 | Train Loss: 0.8154711 Vali Loss: 0.6160380 Best vali loss: 0.6160380
	iters: 100, epoch: 2 | loss: 1.0697951
	speed: 0.0269s/iter; left time: 181.7475s
	iters: 200, epoch: 2 | loss: 0.6608327
	speed: 0.0076s/iter; left time: 50.5680s
	iters: 300, epoch: 2 | loss: 0.6896815
	speed: 0.0084s/iter; left time: 55.2493s
	iters: 400, epoch: 2 | loss: 0.4859021
	speed: 0.0082s/iter; left time: 52.7894s
	iters: 500, epoch: 2 | loss: 0.7550482
	speed: 0.0084s/iter; left time: 53.1215s
	iters: 600, epoch: 2 | loss: 0.8171133
	speed: 0.0081s/iter; left time: 50.3912s
	iters: 700, epoch: 2 | loss: 0.6844849
	speed: 0.0084s/iter; left time: 51.4888s
	iters: 800, epoch: 2 | loss: 1.2594061
	speed: 0.0083s/iter; left time: 50.3917s
	iters: 900, epoch: 2 | loss: 1.3675396
	speed: 0.0083s/iter; left time: 49.4772s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.6160 --> 0.6106).  Saving model state dict ...
Epoch: 2 cost time: 7.874987363815308
Epoch: 2, Steps: 979 | Train Loss: 0.8655337 Vali Loss: 0.6105627 Best vali loss: 0.6105627
	iters: 100, epoch: 3 | loss: 0.7431177
	speed: 0.0279s/iter; left time: 161.2868s
	iters: 200, epoch: 3 | loss: 0.9380739
	speed: 0.0082s/iter; left time: 46.2528s
	iters: 300, epoch: 3 | loss: 1.2613331
	speed: 0.0082s/iter; left time: 45.8263s
	iters: 400, epoch: 3 | loss: 2.0463374
	speed: 0.0082s/iter; left time: 45.0483s
	iters: 500, epoch: 3 | loss: 1.0720342
	speed: 0.0060s/iter; left time: 31.9817s
	iters: 600, epoch: 3 | loss: 1.0775214
	speed: 0.0074s/iter; left time: 39.0236s
	iters: 700, epoch: 3 | loss: 1.0700279
	speed: 0.0098s/iter; left time: 50.5504s
	iters: 800, epoch: 3 | loss: 0.3948089
	speed: 0.0098s/iter; left time: 49.6794s
	iters: 900, epoch: 3 | loss: 0.5798636
	speed: 0.0095s/iter; left time: 47.4431s
Updating learning rate to 0.000179523210107916
Epoch: 3 cost time: 8.297493934631348
Epoch: 3, Steps: 979 | Train Loss: 1.0203465 Vali Loss: 0.6176966 Best vali loss: 0.6105627
	iters: 100, epoch: 4 | loss: 0.8708237
	speed: 0.0321s/iter; left time: 153.9064s
	iters: 200, epoch: 4 | loss: 0.7256829
	speed: 0.0100s/iter; left time: 47.0190s
	iters: 300, epoch: 4 | loss: 0.2996774
	speed: 0.0076s/iter; left time: 34.7648s
	iters: 400, epoch: 4 | loss: 1.5776520
	speed: 0.0061s/iter; left time: 27.2684s
	iters: 500, epoch: 4 | loss: 0.5644488
	speed: 0.0062s/iter; left time: 27.3607s
	iters: 600, epoch: 4 | loss: 0.5139846
	speed: 0.0061s/iter; left time: 26.3223s
	iters: 700, epoch: 4 | loss: 1.0266180
	speed: 0.0067s/iter; left time: 27.9090s
	iters: 800, epoch: 4 | loss: 0.3630972
	speed: 0.0084s/iter; left time: 34.5596s
	iters: 900, epoch: 4 | loss: 1.4544832
	speed: 0.0082s/iter; left time: 32.9490s
Updating learning rate to 0.0001298368129
Epoch: 4 cost time: 7.630500555038452
Epoch: 4, Steps: 979 | Train Loss: 0.8218297 Vali Loss: 0.6132337 Best vali loss: 0.6105627
	iters: 100, epoch: 5 | loss: 0.7980747
	speed: 0.0263s/iter; left time: 100.5272s
	iters: 200, epoch: 5 | loss: 1.0167813
	speed: 0.0061s/iter; left time: 22.5115s
	iters: 300, epoch: 5 | loss: 1.1894214
	speed: 0.0075s/iter; left time: 27.0180s
	iters: 400, epoch: 5 | loss: 0.5451312
	speed: 0.0084s/iter; left time: 29.6908s
	iters: 500, epoch: 5 | loss: 0.6242609
	speed: 0.0083s/iter; left time: 28.2760s
	iters: 600, epoch: 5 | loss: 1.3165338
	speed: 0.0081s/iter; left time: 27.0252s
	iters: 700, epoch: 5 | loss: 0.8227378
	speed: 0.0086s/iter; left time: 27.5803s
	iters: 800, epoch: 5 | loss: 0.7659896
	speed: 0.0092s/iter; left time: 28.7617s
	iters: 900, epoch: 5 | loss: 1.3045102
	speed: 0.0092s/iter; left time: 27.7539s
Updating learning rate to 8.015041569208405e-05
Epoch: 5 cost time: 8.032469034194946
Epoch: 5, Steps: 979 | Train Loss: 0.9314934 Vali Loss: 0.6268671 Best vali loss: 0.6105627
	iters: 100, epoch: 6 | loss: 0.9590570
	speed: 0.0255s/iter; left time: 72.4761s
	iters: 200, epoch: 6 | loss: 0.3081811
	speed: 0.0074s/iter; left time: 20.2231s
	iters: 300, epoch: 6 | loss: 1.1194474
	speed: 0.0086s/iter; left time: 22.7563s
	iters: 400, epoch: 6 | loss: 1.0737855
	speed: 0.0084s/iter; left time: 21.4336s
	iters: 500, epoch: 6 | loss: 0.6953661
	speed: 0.0080s/iter; left time: 19.5232s
	iters: 600, epoch: 6 | loss: 0.8581218
	speed: 0.0085s/iter; left time: 19.8400s
	iters: 700, epoch: 6 | loss: 0.9590133
	speed: 0.0083s/iter; left time: 18.5563s
	iters: 800, epoch: 6 | loss: 0.3826024
	speed: 0.0086s/iter; left time: 18.4028s
	iters: 900, epoch: 6 | loss: 0.3256876
	speed: 0.0087s/iter; left time: 17.6770s
Updating learning rate to 3.8028322050761e-05
Epoch: 6 cost time: 7.966786623001099
Epoch: 6, Steps: 979 | Train Loss: 0.7423625 Vali Loss: 0.6109046 Best vali loss: 0.6105627
	iters: 100, epoch: 7 | loss: 0.3463230
	speed: 0.0250s/iter; left time: 46.5630s
	iters: 200, epoch: 7 | loss: 1.1017443
	speed: 0.0080s/iter; left time: 14.0299s
	iters: 300, epoch: 7 | loss: 0.6163120
	speed: 0.0071s/iter; left time: 11.7808s
	iters: 400, epoch: 7 | loss: 1.2259246
	speed: 0.0056s/iter; left time: 8.7905s
	iters: 500, epoch: 7 | loss: 1.1496074
	speed: 0.0075s/iter; left time: 10.9703s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 4, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.6580).  Saving model state dict ...
Epoch: 1 cost time: 0.9869637489318848
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6579828 Best vali loss: 0.6579828
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.6580 --> 0.6356).  Saving model state dict ...
Epoch: 2 cost time: 0.7315826416015625
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6356178 Best vali loss: 0.6356178
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.6356 --> 0.6282).  Saving model state dict ...
Epoch: 3 cost time: 0.7260358333587646
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6281693 Best vali loss: 0.6281693

best validation loss 0.628169287856339

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0080338200163, 'e_layers': 4, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9834635
	speed: 0.0157s/iter; left time: 60.0316s
	iters: 200, epoch: 1 | loss: 0.5034055
	speed: 0.0095s/iter; left time: 35.2774s
	iters: 300, epoch: 1 | loss: 0.6448553
	speed: 0.0087s/iter; left time: 31.4366s
	iters: 400, epoch: 1 | loss: 0.8080251
	speed: 0.0076s/iter; left time: 26.8380s
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 5.12382960319519
Epoch: 1, Steps: 490 | Train Loss: 0.7349373 Vali Loss: 0.6058469 Best vali loss: 0.6058469
	iters: 100, epoch: 2 | loss: 0.7089676
	speed: 0.0374s/iter; left time: 124.4513s
	iters: 200, epoch: 2 | loss: 0.8324823
	speed: 0.0154s/iter; left time: 49.6634s
	iters: 300, epoch: 2 | loss: 0.5893640
	speed: 0.0077s/iter; left time: 24.1988s
	iters: 400, epoch: 2 | loss: 0.8625544
	speed: 0.0087s/iter; left time: 26.2888s
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.6058 --> 0.6015).  Saving model state dict ...
Epoch: 2 cost time: 5.572364091873169
Epoch: 2, Steps: 490 | Train Loss: 0.7483421 Vali Loss: 0.6015116 Best vali loss: 0.6015116
	iters: 100, epoch: 3 | loss: 0.4950162
	speed: 0.0255s/iter; left time: 72.4155s
	iters: 200, epoch: 3 | loss: 0.8321363
	speed: 0.0090s/iter; left time: 24.5476s
	iters: 300, epoch: 3 | loss: 0.4403584
	speed: 0.0148s/iter; left time: 39.1851s
	iters: 400, epoch: 3 | loss: 1.2441077
	speed: 0.0150s/iter; left time: 38.1826s
Updating learning rate to 0.00043994959105690174
Validation loss decreased (0.6015 --> 0.5657).  Saving model state dict ...
Epoch: 3 cost time: 6.08136510848999
Epoch: 3, Steps: 490 | Train Loss: 0.7529047 Vali Loss: 0.5656770 Best vali loss: 0.5656770

best validation loss 0.5656770332054869

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.001305182651, 'e_layers': 2, 'learning_rate': 6.28915805e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9948916
	speed: 0.0166s/iter; left time: 128.3513s
	iters: 200, epoch: 1 | loss: 0.8687478
	speed: 0.0102s/iter; left time: 78.0071s
	iters: 300, epoch: 1 | loss: 0.4344442
	speed: 0.0063s/iter; left time: 47.1573s
	iters: 400, epoch: 1 | loss: 0.2745926
	speed: 0.0053s/iter; left time: 39.7118s
	iters: 500, epoch: 1 | loss: 1.5067480
	speed: 0.0055s/iter; left time: 40.3657s
	iters: 600, epoch: 1 | loss: 0.5863907
	speed: 0.0053s/iter; left time: 38.6076s
	iters: 700, epoch: 1 | loss: 1.0806340
	speed: 0.0052s/iter; left time: 36.7374s
	iters: 800, epoch: 1 | loss: 0.9063335
	speed: 0.0070s/iter; left time: 49.2747s
	iters: 900, epoch: 1 | loss: 0.3634787
	speed: 0.0079s/iter; left time: 54.8315s
Updating learning rate to 6.049791224561798e-05
Validation loss decreased (inf --> 0.6170).  Saving model state dict ...
Epoch: 1 cost time: 7.274502992630005
Epoch: 1, Steps: 979 | Train Loss: 0.7795846 Vali Loss: 0.6169988 Best vali loss: 0.6169988
	iters: 100, epoch: 2 | loss: 0.7021326
	speed: 0.0290s/iter; left time: 195.7601s
	iters: 200, epoch: 2 | loss: 1.5713083
	speed: 0.0079s/iter; left time: 52.8636s
	iters: 300, epoch: 2 | loss: 0.2642700
	speed: 0.0084s/iter; left time: 54.8093s
	iters: 400, epoch: 2 | loss: 0.9640267
	speed: 0.0080s/iter; left time: 51.6726s
	iters: 500, epoch: 2 | loss: 0.6561095
	speed: 0.0078s/iter; left time: 49.6454s
	iters: 600, epoch: 2 | loss: 0.8929614
	speed: 0.0074s/iter; left time: 46.4717s
	iters: 700, epoch: 2 | loss: 0.5883429
	speed: 0.0080s/iter; left time: 49.2132s
	iters: 800, epoch: 2 | loss: 1.2822305
	speed: 0.0079s/iter; left time: 48.0201s
	iters: 900, epoch: 2 | loss: 1.0912189
	speed: 0.0085s/iter; left time: 50.6681s
Updating learning rate to 5.368132177554482e-05
Validation loss decreased (0.6170 --> 0.6015).  Saving model state dict ...
Epoch: 2 cost time: 7.86762261390686
Epoch: 2, Steps: 979 | Train Loss: 0.8902890 Vali Loss: 0.6015131 Best vali loss: 0.6015131
	iters: 100, epoch: 3 | loss: 0.6651332
	speed: 0.0272s/iter; left time: 157.1951s
	iters: 200, epoch: 3 | loss: 0.6789544
	speed: 0.0052s/iter; left time: 29.6534s
	iters: 300, epoch: 3 | loss: 0.9581652
	speed: 0.0057s/iter; left time: 31.9975s
	iters: 400, epoch: 3 | loss: 0.7588904
	speed: 0.0066s/iter; left time: 35.9735s
	iters: 500, epoch: 3 | loss: 0.4478643
	speed: 0.0065s/iter; left time: 35.0551s
	iters: 600, epoch: 3 | loss: 0.3935746
	speed: 0.0063s/iter; left time: 33.3933s
	iters: 700, epoch: 3 | loss: 0.2768775
	speed: 0.0067s/iter; left time: 34.7085s
	iters: 800, epoch: 3 | loss: 0.8970838
	speed: 0.0068s/iter; left time: 34.3960s
	iters: 900, epoch: 3 | loss: 1.1034157
	speed: 0.0064s/iter; left time: 31.7062s
Updating learning rate to 4.347957319630268e-05
Epoch: 3 cost time: 6.410917043685913
Epoch: 3, Steps: 979 | Train Loss: 0.6866621 Vali Loss: 0.6027125 Best vali loss: 0.6015131

best validation loss 0.6015131080773957

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0080338200163, 'e_layers': 4, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8952550
	speed: 0.0196s/iter; left time: 45.9969s
	iters: 200, epoch: 4 | loss: 0.4311683
	speed: 0.0104s/iter; left time: 23.3004s
	iters: 300, epoch: 4 | loss: 0.5852785
	speed: 0.0103s/iter; left time: 22.1563s
	iters: 400, epoch: 4 | loss: 0.7972485
	speed: 0.0112s/iter; left time: 22.8954s
Updating learning rate to 0.00031818533495
Epoch: 4 cost time: 5.708040475845337
Epoch: 4, Steps: 490 | Train Loss: 0.6772376 Vali Loss: 0.6045110 Best vali loss: 0.5656770
	iters: 100, epoch: 5 | loss: 0.6840646
	speed: 0.0269s/iter; left time: 50.0504s
	iters: 200, epoch: 5 | loss: 0.7261207
	speed: 0.0118s/iter; left time: 20.7403s
	iters: 300, epoch: 5 | loss: 0.5049951
	speed: 0.0115s/iter; left time: 19.1094s
	iters: 400, epoch: 5 | loss: 0.8387000
	speed: 0.0102s/iter; left time: 15.9620s
Updating learning rate to 0.00019642107884309824
Validation loss decreased (0.5657 --> 0.5469).  Saving model state dict ...
Epoch: 5 cost time: 5.349945306777954
Epoch: 5, Steps: 490 | Train Loss: 0.6884701 Vali Loss: 0.5468800 Best vali loss: 0.5468800
	iters: 100, epoch: 6 | loss: 0.4377569
	speed: 0.0308s/iter; left time: 42.1975s
	iters: 200, epoch: 6 | loss: 0.7496451
	speed: 0.0141s/iter; left time: 17.9698s
	iters: 300, epoch: 6 | loss: 0.3914453
	speed: 0.0157s/iter; left time: 18.3464s
	iters: 400, epoch: 6 | loss: 1.2122284
	speed: 0.0161s/iter; left time: 17.2603s
Updating learning rate to 9.319432693274203e-05
Epoch: 6 cost time: 7.4584057331085205
Epoch: 6, Steps: 490 | Train Loss: 0.6977689 Vali Loss: 0.5473527 Best vali loss: 0.5468800
	iters: 100, epoch: 7 | loss: 0.7624047
	speed: 0.0397s/iter; left time: 34.9999s
	iters: 200, epoch: 7 | loss: 0.3553634
	speed: 0.0156s/iter; left time: 12.1567s
	iters: 300, epoch: 7 | loss: 0.5836888
	speed: 0.0151s/iter; left time: 10.2809s
	iters: 400, epoch: 7 | loss: 0.5066683
	speed: 0.0154s/iter; left time: 8.9428s
Updating learning rate to 2.4220416444446813e-05
Validation loss decreased (0.5469 --> 0.5439).  Saving model state dict ...
Epoch: 7 cost time: 7.722092151641846
Epoch: 7, Steps: 490 | Train Loss: 0.5520313 Vali Loss: 0.5439005 Best vali loss: 0.5439005
	iters: 100, epoch: 8 | loss: 0.5475415
	speed: 0.0434s/iter; left time: 16.9867s
	iters: 200, epoch: 8 | loss: 0.8793604
	speed: 0.0099s/iter; left time: 2.8763s
	iters: 300, epoch: 8 | loss: 0.5595914
	speed: 0.0093s/iter; left time: 1.7724s
	iters: 400, epoch: 8 | loss: 0.6423224
	speed: 0.0114s/iter; left time: 1.0340s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.87614893913269
Epoch: 8, Steps: 490 | Train Loss: 0.6572039 Vali Loss: 0.5439199 Best vali loss: 0.5439005

best validation loss 0.5439005494393556

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.005307590091, 'e_layers': 1, 'learning_rate': 0.0014772868529, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5870726
	speed: 0.0128s/iter; left time: 48.9348s
	iters: 200, epoch: 1 | loss: 0.9045678
	speed: 0.0065s/iter; left time: 24.2862s
	iters: 300, epoch: 1 | loss: 0.8054852
	speed: 0.0064s/iter; left time: 23.1999s
	iters: 400, epoch: 1 | loss: 0.8162594
	speed: 0.0083s/iter; left time: 29.3906s
Updating learning rate to 0.001421060969971161
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 3.707843065261841
Epoch: 1, Steps: 490 | Train Loss: 0.7783463 Vali Loss: 0.6102830 Best vali loss: 0.6102830
	iters: 100, epoch: 2 | loss: 0.6680871
	speed: 0.0196s/iter; left time: 65.1512s
	iters: 200, epoch: 2 | loss: 0.6689309
	speed: 0.0063s/iter; left time: 20.4143s
	iters: 300, epoch: 2 | loss: 0.6975630
	speed: 0.0084s/iter; left time: 26.2362s
	iters: 400, epoch: 2 | loss: 0.9072245
	speed: 0.0059s/iter; left time: 17.7710s
Updating learning rate to 0.0012609432021716618
Epoch: 2 cost time: 3.329096555709839
Epoch: 2, Steps: 490 | Train Loss: 0.7354514 Vali Loss: 0.6313234 Best vali loss: 0.6102830
	iters: 100, epoch: 3 | loss: 0.3581547
	speed: 0.0190s/iter; left time: 53.9708s
	iters: 200, epoch: 3 | loss: 1.2885720
	speed: 0.0062s/iter; left time: 17.0588s
	iters: 300, epoch: 3 | loss: 1.5513042
	speed: 0.0085s/iter; left time: 22.5196s
	iters: 400, epoch: 3 | loss: 1.2472106
	speed: 0.0061s/iter; left time: 15.5062s
Updating learning rate to 0.0010213100281777968
Epoch: 3 cost time: 3.3142244815826416
Epoch: 3, Steps: 490 | Train Loss: 1.1113104 Vali Loss: 0.6152949 Best vali loss: 0.6102830
	iters: 100, epoch: 4 | loss: 0.9832908
	speed: 0.0194s/iter; left time: 45.7033s
	iters: 200, epoch: 4 | loss: 0.6320736
	speed: 0.0081s/iter; left time: 18.1705s
	iters: 300, epoch: 4 | loss: 0.6542719
	speed: 0.0059s/iter; left time: 12.6480s
	iters: 400, epoch: 4 | loss: 0.5442513
	speed: 0.0061s/iter; left time: 12.5261s
Updating learning rate to 0.00073864342645
Epoch: 4 cost time: 3.2881712913513184
Epoch: 4, Steps: 490 | Train Loss: 0.7034719 Vali Loss: 0.6281759 Best vali loss: 0.6102830
	iters: 100, epoch: 5 | loss: 0.7185597
	speed: 0.0190s/iter; left time: 35.3061s
	iters: 200, epoch: 5 | loss: 1.0863740
	speed: 0.0067s/iter; left time: 11.7947s
	iters: 300, epoch: 5 | loss: 0.4704828
	speed: 0.0054s/iter; left time: 9.0271s
	iters: 400, epoch: 5 | loss: 0.4858833
	speed: 0.0053s/iter; left time: 8.2654s
Updating learning rate to 0.00045597682472220326
Epoch: 5 cost time: 2.988826036453247
Epoch: 5, Steps: 490 | Train Loss: 0.6903250 Vali Loss: 0.6674571 Best vali loss: 0.6102830
	iters: 100, epoch: 6 | loss: 0.6838723
	speed: 0.0189s/iter; left time: 25.8949s
	iters: 200, epoch: 6 | loss: 0.8181793
	speed: 0.0059s/iter; left time: 7.4434s
	iters: 300, epoch: 6 | loss: 0.6112104
	speed: 0.0059s/iter; left time: 6.9495s
	iters: 400, epoch: 6 | loss: 0.6633237
	speed: 0.0056s/iter; left time: 6.0010s
Updating learning rate to 0.00021634365072833818
Epoch: 6 cost time: 2.9893555641174316
Epoch: 6, Steps: 490 | Train Loss: 0.6941464 Vali Loss: 0.6407398 Best vali loss: 0.6102830
	iters: 100, epoch: 7 | loss: 0.5584840
	speed: 0.0170s/iter; left time: 14.9447s
	iters: 200, epoch: 7 | loss: 0.9530324
	speed: 0.0035s/iter; left time: 2.7153s
	iters: 300, epoch: 7 | loss: 0.7054811
	speed: 0.0035s/iter; left time: 2.4109s
	iters: 400, epoch: 7 | loss: 0.7961508
	speed: 0.0076s/iter; left time: 4.4122s
Updating learning rate to 5.622588292883899e-05
Epoch: 7 cost time: 2.6044721603393555
Epoch: 7, Steps: 490 | Train Loss: 0.7532871 Vali Loss: 0.6327186 Best vali loss: 0.6102830
	iters: 100, epoch: 8 | loss: 0.4945460
	speed: 0.0212s/iter; left time: 8.3039s
	iters: 200, epoch: 8 | loss: 0.5835541
	speed: 0.0074s/iter; left time: 2.1404s
	iters: 300, epoch: 8 | loss: 0.4207256
	speed: 0.0039s/iter; left time: 0.7541s
	iters: 400, epoch: 8 | loss: 0.2923905
	speed: 0.0033s/iter; left time: 0.2961s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.467088460922241
Epoch: 8, Steps: 490 | Train Loss: 0.4478041 Vali Loss: 0.6256377 Best vali loss: 0.6102830

best validation loss 0.6102829672351362

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.003762804933, 'e_layers': 1, 'learning_rate': 0.0003146953787, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003146953787
Validation loss decreased (inf --> 0.5989).  Saving model state dict ...
Epoch: 1 cost time: 0.7173976898193359
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5989437 Best vali loss: 0.5989437
Updating learning rate to 0.00015734768935
Epoch: 2 cost time: 0.7338781356811523
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6022881 Best vali loss: 0.5989437
Updating learning rate to 7.8673844675e-05
Epoch: 3 cost time: 0.6854763031005859
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6162057 Best vali loss: 0.5989437
Updating learning rate to 3.93369223375e-05
Epoch: 4 cost time: 0.7085483074188232
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6105572 Best vali loss: 0.5989437
Updating learning rate to 1.966846116875e-05
Epoch: 5 cost time: 0.7381861209869385
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6109194 Best vali loss: 0.5989437
Updating learning rate to 9.834230584375e-06
Epoch: 6 cost time: 0.7289376258850098
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6095607 Best vali loss: 0.5989437
Updating learning rate to 4.9171152921875e-06
Epoch: 7 cost time: 0.6800878047943115
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6106029 Best vali loss: 0.5989437
Updating learning rate to 2.45855764609375e-06
Epoch: 8 cost time: 0.6696782112121582
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6107072 Best vali loss: 0.5989437

best validation loss 0.5989436767598867

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0032434751379, 'e_layers': 1, 'learning_rate': 0.0013849881566, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9492590
	speed: 0.0100s/iter; left time: 77.1343s
	iters: 200, epoch: 1 | loss: 0.7044674
	speed: 0.0037s/iter; left time: 28.3275s
	iters: 300, epoch: 1 | loss: 0.4196127
	speed: 0.0040s/iter; left time: 30.2078s
	iters: 400, epoch: 1 | loss: 0.8329435
	speed: 0.0043s/iter; left time: 31.6488s
	iters: 500, epoch: 1 | loss: 0.6202261
	speed: 0.0041s/iter; left time: 29.8682s
	iters: 600, epoch: 1 | loss: 0.7259272
	speed: 0.0042s/iter; left time: 30.0882s
	iters: 700, epoch: 1 | loss: 0.7330112
	speed: 0.0043s/iter; left time: 30.9620s
	iters: 800, epoch: 1 | loss: 1.7032112
	speed: 0.0040s/iter; left time: 28.1281s
	iters: 900, epoch: 1 | loss: 0.5320366
	speed: 0.0040s/iter; left time: 28.0668s
Updating learning rate to 0.0013322751836266384
Validation loss decreased (inf --> 0.6225).  Saving model state dict ...
Epoch: 1 cost time: 4.27460241317749
Epoch: 1, Steps: 979 | Train Loss: 0.8022994 Vali Loss: 0.6225182 Best vali loss: 0.6225182
	iters: 100, epoch: 2 | loss: 1.2635690
	speed: 0.0158s/iter; left time: 106.6449s
	iters: 200, epoch: 2 | loss: 0.5905976
	speed: 0.0037s/iter; left time: 24.9382s
	iters: 300, epoch: 2 | loss: 1.3406022
	speed: 0.0035s/iter; left time: 23.2072s
	iters: 400, epoch: 2 | loss: 0.7471084
	speed: 0.0035s/iter; left time: 22.7462s
	iters: 500, epoch: 2 | loss: 0.9556181
	speed: 0.0041s/iter; left time: 26.0680s
	iters: 600, epoch: 2 | loss: 1.1993245
	speed: 0.0043s/iter; left time: 26.7807s
	iters: 700, epoch: 2 | loss: 0.8847744
	speed: 0.0042s/iter; left time: 25.9829s
	iters: 800, epoch: 2 | loss: 0.2321610
	speed: 0.0045s/iter; left time: 27.5455s
	iters: 900, epoch: 2 | loss: 0.4560946
	speed: 0.0046s/iter; left time: 27.2950s
Updating learning rate to 0.001182161336997458
Validation loss decreased (0.6225 --> 0.6144).  Saving model state dict ...
Epoch: 2 cost time: 4.053393840789795
Epoch: 2, Steps: 979 | Train Loss: 0.8522055 Vali Loss: 0.6144459 Best vali loss: 0.6144459
	iters: 100, epoch: 3 | loss: 0.9880893
	speed: 0.0171s/iter; left time: 98.8535s
	iters: 200, epoch: 3 | loss: 0.4339840
	speed: 0.0042s/iter; left time: 23.9696s
	iters: 300, epoch: 3 | loss: 0.9238196
	speed: 0.0043s/iter; left time: 24.0069s
	iters: 400, epoch: 3 | loss: 1.4084584
	speed: 0.0044s/iter; left time: 24.0727s
	iters: 500, epoch: 3 | loss: 1.0834210
	speed: 0.0043s/iter; left time: 23.2726s
	iters: 600, epoch: 3 | loss: 0.3922770
	speed: 0.0044s/iter; left time: 22.9967s
	iters: 700, epoch: 3 | loss: 0.5291419
	speed: 0.0043s/iter; left time: 22.5033s
	iters: 800, epoch: 3 | loss: 0.3492177
	speed: 0.0045s/iter; left time: 22.7745s
	iters: 900, epoch: 3 | loss: 0.9251681
	speed: 0.0045s/iter; left time: 22.2830s
Updating learning rate to 0.0009575000890763433
Epoch: 3 cost time: 4.300083875656128
Epoch: 3, Steps: 979 | Train Loss: 0.7815085 Vali Loss: 0.6389864 Best vali loss: 0.6144459

best validation loss 0.6144459086510387

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0112758696693, 'e_layers': 2, 'learning_rate': 0.0028457949504, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7860533
	speed: 0.0121s/iter; left time: 93.5750s
	iters: 200, epoch: 1 | loss: 1.2139657
	speed: 0.0060s/iter; left time: 45.5623s
	iters: 300, epoch: 1 | loss: 0.9748229
	speed: 0.0062s/iter; left time: 46.4753s
	iters: 400, epoch: 1 | loss: 1.5062314
	speed: 0.0061s/iter; left time: 45.0982s
	iters: 500, epoch: 1 | loss: 1.3471202
	speed: 0.0058s/iter; left time: 42.3661s
	iters: 600, epoch: 1 | loss: 0.6721514
	speed: 0.0054s/iter; left time: 38.8139s
	iters: 700, epoch: 1 | loss: 1.3802452
	speed: 0.0051s/iter; left time: 36.0410s
	iters: 800, epoch: 1 | loss: 1.0364957
	speed: 0.0049s/iter; left time: 34.6535s
	iters: 900, epoch: 1 | loss: 1.6189390
	speed: 0.0076s/iter; left time: 52.6823s
Updating learning rate to 0.0027374833293992663
Validation loss decreased (inf --> 0.6256).  Saving model state dict ...
Epoch: 1 cost time: 6.237748622894287
Epoch: 1, Steps: 979 | Train Loss: 1.1706694 Vali Loss: 0.6255707 Best vali loss: 0.6255707
	iters: 100, epoch: 2 | loss: 0.6905295
	speed: 0.0261s/iter; left time: 176.3046s
	iters: 200, epoch: 2 | loss: 0.4169345
	speed: 0.0078s/iter; left time: 51.6173s
	iters: 300, epoch: 2 | loss: 0.8156618
	speed: 0.0064s/iter; left time: 41.6906s
	iters: 400, epoch: 2 | loss: 1.4678574
	speed: 0.0049s/iter; left time: 31.5462s
	iters: 500, epoch: 2 | loss: 0.6233222
	speed: 0.0058s/iter; left time: 36.5754s
	iters: 600, epoch: 2 | loss: 0.6493017
	speed: 0.0064s/iter; left time: 40.1431s
	iters: 700, epoch: 2 | loss: 0.6915538
	speed: 0.0061s/iter; left time: 37.7078s
	iters: 800, epoch: 2 | loss: 0.7893242
	speed: 0.0058s/iter; left time: 34.9880s
	iters: 900, epoch: 2 | loss: 1.3123496
	speed: 0.0057s/iter; left time: 33.8011s
Updating learning rate to 0.0024290379288471374
Validation loss decreased (0.6256 --> 0.6093).  Saving model state dict ...
Epoch: 2 cost time: 6.111776351928711
Epoch: 2, Steps: 979 | Train Loss: 0.8285372 Vali Loss: 0.6093202 Best vali loss: 0.6093202
	iters: 100, epoch: 3 | loss: 1.0562447
	speed: 0.0218s/iter; left time: 125.8960s
	iters: 200, epoch: 3 | loss: 0.5405281
	speed: 0.0083s/iter; left time: 47.0022s
	iters: 300, epoch: 3 | loss: 0.5445215
	speed: 0.0078s/iter; left time: 43.6474s
	iters: 400, epoch: 3 | loss: 1.0217375
	speed: 0.0080s/iter; left time: 43.5311s
	iters: 500, epoch: 3 | loss: 1.1839656
	speed: 0.0055s/iter; left time: 29.4863s
	iters: 600, epoch: 3 | loss: 1.1170292
	speed: 0.0051s/iter; left time: 26.7580s
	iters: 700, epoch: 3 | loss: 0.6156008
	speed: 0.0081s/iter; left time: 42.0366s
	iters: 800, epoch: 3 | loss: 0.4222572
	speed: 0.0081s/iter; left time: 41.1224s
	iters: 900, epoch: 3 | loss: 1.0876247
	speed: 0.0080s/iter; left time: 39.6820s
Updating learning rate to 0.0019674167649131563
Epoch: 3 cost time: 7.34501838684082
Epoch: 3, Steps: 979 | Train Loss: 0.8432788 Vali Loss: 0.6180818 Best vali loss: 0.6093202

best validation loss 0.6093201526250623

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0026755699187, 'e_layers': 3, 'learning_rate': 0.0002913656694, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5493743
	speed: 0.0136s/iter; left time: 51.8394s
	iters: 200, epoch: 1 | loss: 0.6496698
	speed: 0.0079s/iter; left time: 29.3093s
	iters: 300, epoch: 1 | loss: 0.4271964
	speed: 0.0093s/iter; left time: 33.7554s
	iters: 400, epoch: 1 | loss: 0.7723637
	speed: 0.0097s/iter; left time: 33.9840s
Updating learning rate to 0.00028027622391755506
Validation loss decreased (inf --> 0.6224).  Saving model state dict ...
Epoch: 1 cost time: 4.6206583976745605
Epoch: 1, Steps: 490 | Train Loss: 0.5996511 Vali Loss: 0.6224070 Best vali loss: 0.6224070
	iters: 100, epoch: 2 | loss: 0.6537216
	speed: 0.0278s/iter; left time: 92.6370s
	iters: 200, epoch: 2 | loss: 0.6146972
	speed: 0.0092s/iter; left time: 29.7770s
	iters: 300, epoch: 2 | loss: 0.9204823
	speed: 0.0087s/iter; left time: 27.2668s
	iters: 400, epoch: 2 | loss: 1.1040564
	speed: 0.0087s/iter; left time: 26.4974s
Updating learning rate to 0.00024869615501884885
Validation loss decreased (0.6224 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 4.564219951629639
Epoch: 2, Steps: 490 | Train Loss: 0.8232393 Vali Loss: 0.6035850 Best vali loss: 0.6035850
	iters: 100, epoch: 3 | loss: 0.8227798
	speed: 0.0265s/iter; left time: 75.4145s
	iters: 200, epoch: 3 | loss: 0.9298267
	speed: 0.0093s/iter; left time: 25.3953s
	iters: 300, epoch: 3 | loss: 0.9186105
	speed: 0.0093s/iter; left time: 24.5465s
	iters: 400, epoch: 3 | loss: 0.7175863
	speed: 0.0090s/iter; left time: 22.9616s
Updating learning rate to 0.000201433241919672
Epoch: 3 cost time: 4.334173679351807
Epoch: 3, Steps: 490 | Train Loss: 0.8472008 Vali Loss: 0.6133084 Best vali loss: 0.6035850

best validation loss 0.6035850262997714

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0026755699187, 'e_layers': 3, 'learning_rate': 0.0002913656694, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4206730
	speed: 0.0184s/iter; left time: 43.1710s
	iters: 200, epoch: 4 | loss: 0.6363977
	speed: 0.0097s/iter; left time: 21.9150s
	iters: 300, epoch: 4 | loss: 0.3937057
	speed: 0.0102s/iter; left time: 21.9479s
	iters: 400, epoch: 4 | loss: 0.7537626
	speed: 0.0091s/iter; left time: 18.5754s
Updating learning rate to 0.0001456828347
Epoch: 4 cost time: 5.142355918884277
Epoch: 4, Steps: 490 | Train Loss: 0.5511348 Vali Loss: 0.6064894 Best vali loss: 0.6035850
	iters: 100, epoch: 5 | loss: 0.6263429
	speed: 0.0420s/iter; left time: 78.1175s
	iters: 200, epoch: 5 | loss: 0.5686009
	speed: 0.0139s/iter; left time: 24.5106s
	iters: 300, epoch: 5 | loss: 0.9187696
	speed: 0.0156s/iter; left time: 25.9655s
	iters: 400, epoch: 5 | loss: 1.0894241
	speed: 0.0086s/iter; left time: 13.4549s
Updating learning rate to 8.9932427480328e-05
Validation loss decreased (0.6036 --> 0.6011).  Saving model state dict ...
Epoch: 5 cost time: 6.8799729347229
Epoch: 5, Steps: 490 | Train Loss: 0.8007844 Vali Loss: 0.6010667 Best vali loss: 0.6010667
	iters: 100, epoch: 6 | loss: 0.8041945
	speed: 0.0849s/iter; left time: 116.3577s
	iters: 200, epoch: 6 | loss: 0.8579602
	speed: 0.0259s/iter; left time: 32.9099s
	iters: 300, epoch: 6 | loss: 0.9327594
	speed: 0.0209s/iter; left time: 24.4797s
	iters: 400, epoch: 6 | loss: 0.7056392
	speed: 0.0223s/iter; left time: 23.8636s
Updating learning rate to 4.266951438115113e-05
Epoch: 6 cost time: 11.0230233669281
Epoch: 6, Steps: 490 | Train Loss: 0.8251383 Vali Loss: 0.6120148 Best vali loss: 0.6010667
	iters: 100, epoch: 7 | loss: 0.8199035
	speed: 0.0807s/iter; left time: 71.0588s
	iters: 200, epoch: 7 | loss: 0.6461013
	speed: 0.0161s/iter; left time: 12.6074s
	iters: 300, epoch: 7 | loss: 0.8346155
	speed: 0.0209s/iter; left time: 14.2534s
	iters: 400, epoch: 7 | loss: 0.3733582
	speed: 0.0162s/iter; left time: 9.3845s
Updating learning rate to 1.1089445482444938e-05
Epoch: 7 cost time: 8.330600261688232
Epoch: 7, Steps: 490 | Train Loss: 0.6684946 Vali Loss: 0.6108168 Best vali loss: 0.6010667
	iters: 100, epoch: 8 | loss: 0.9405484
	speed: 0.0622s/iter; left time: 24.3242s
	iters: 200, epoch: 8 | loss: 0.7842962
	speed: 0.0177s/iter; left time: 5.1549s
	iters: 300, epoch: 8 | loss: 0.6070883
	speed: 0.0174s/iter; left time: 3.3213s
	iters: 400, epoch: 8 | loss: 0.4490527
	speed: 0.0172s/iter; left time: 1.5620s
Updating learning rate to 0.0
Epoch: 8 cost time: 7.834536790847778
Epoch: 8, Steps: 490 | Train Loss: 0.6952464 Vali Loss: 0.6077873 Best vali loss: 0.6010667

best validation loss 0.601066723514188

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012374140538, 'e_layers': 2, 'learning_rate': 0.0005328478516, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7809259
	speed: 0.0160s/iter; left time: 14.1613s
Updating learning rate to 0.0005328478516
Validation loss decreased (inf --> 0.6266).  Saving model state dict ...
Epoch: 1 cost time: 1.4919018745422363
Epoch: 1, Steps: 123 | Train Loss: 0.7809259 Vali Loss: 0.6266021 Best vali loss: 0.6266021
	iters: 100, epoch: 2 | loss: 0.7349592
	speed: 0.0153s/iter; left time: 11.6488s
Updating learning rate to 0.0002664239258
Validation loss decreased (0.6266 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 1.2611637115478516
Epoch: 2, Steps: 123 | Train Loss: 0.7349592 Vali Loss: 0.6065002 Best vali loss: 0.6065002
	iters: 100, epoch: 3 | loss: 0.9341732
	speed: 0.0149s/iter; left time: 9.4940s
Updating learning rate to 0.0001332119629
Validation loss decreased (0.6065 --> 0.6061).  Saving model state dict ...
Epoch: 3 cost time: 1.1576106548309326
Epoch: 3, Steps: 123 | Train Loss: 0.9341732 Vali Loss: 0.6061472 Best vali loss: 0.6061472
	iters: 100, epoch: 4 | loss: 0.8214069
	speed: 0.0104s/iter; left time: 5.3720s
Updating learning rate to 6.660598145e-05
Validation loss decreased (0.6061 --> 0.6037).  Saving model state dict ...
Epoch: 4 cost time: 0.8696351051330566
Epoch: 4, Steps: 123 | Train Loss: 0.8214069 Vali Loss: 0.6037371 Best vali loss: 0.6037371
	iters: 100, epoch: 5 | loss: 0.9383276
	speed: 0.0143s/iter; left time: 5.6207s
Updating learning rate to 3.3302990725e-05
Validation loss decreased (0.6037 --> 0.6033).  Saving model state dict ...
Epoch: 5 cost time: 1.114905595779419
Epoch: 5, Steps: 123 | Train Loss: 0.9383276 Vali Loss: 0.6032595 Best vali loss: 0.6032595
	iters: 100, epoch: 6 | loss: 0.6910478
	speed: 0.0133s/iter; left time: 3.6035s
Updating learning rate to 1.66514953625e-05
Epoch: 6 cost time: 1.1065893173217773
Epoch: 6, Steps: 123 | Train Loss: 0.6910478 Vali Loss: 0.6034259 Best vali loss: 0.6032595
	iters: 100, epoch: 7 | loss: 0.7116017
	speed: 0.0139s/iter; left time: 2.0433s
Updating learning rate to 8.32574768125e-06
Validation loss decreased (0.6033 --> 0.6022).  Saving model state dict ...
Epoch: 7 cost time: 1.1592535972595215
Epoch: 7, Steps: 123 | Train Loss: 0.7116017 Vali Loss: 0.6022347 Best vali loss: 0.6022347
	iters: 100, epoch: 8 | loss: 0.7860125
	speed: 0.0143s/iter; left time: 0.3441s
Updating learning rate to 4.162873840625e-06
Validation loss decreased (0.6022 --> 0.6019).  Saving model state dict ...
Epoch: 8 cost time: 1.1280910968780518
Epoch: 8, Steps: 123 | Train Loss: 0.7860125 Vali Loss: 0.6019390 Best vali loss: 0.6019390

best validation loss 0.6019389615848847

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0015252855344, 'e_layers': 1, 'learning_rate': 0.0001006740407, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4965210
	speed: 0.0104s/iter; left time: 80.6201s
	iters: 200, epoch: 1 | loss: 1.0273497
	speed: 0.0038s/iter; left time: 29.1616s
	iters: 300, epoch: 1 | loss: 0.8432115
	speed: 0.0041s/iter; left time: 31.1894s
	iters: 400, epoch: 1 | loss: 1.2535294
	speed: 0.0042s/iter; left time: 31.0510s
	iters: 500, epoch: 1 | loss: 0.5072067
	speed: 0.0036s/iter; left time: 26.6293s
	iters: 600, epoch: 1 | loss: 0.9993932
	speed: 0.0034s/iter; left time: 24.7730s
	iters: 700, epoch: 1 | loss: 1.2600998
	speed: 0.0040s/iter; left time: 28.3662s
	iters: 800, epoch: 1 | loss: 0.7888408
	speed: 0.0059s/iter; left time: 41.3678s
	iters: 900, epoch: 1 | loss: 1.1859853
	speed: 0.0057s/iter; left time: 39.7390s
Updating learning rate to 9.684236317896914e-05
Validation loss decreased (inf --> 0.6215).  Saving model state dict ...
Epoch: 1 cost time: 4.591333866119385
Epoch: 1, Steps: 979 | Train Loss: 0.9291264 Vali Loss: 0.6214797 Best vali loss: 0.6214797
	iters: 100, epoch: 2 | loss: 0.5202071
	speed: 0.0203s/iter; left time: 136.9892s
	iters: 200, epoch: 2 | loss: 1.0261288
	speed: 0.0032s/iter; left time: 21.1414s
	iters: 300, epoch: 2 | loss: 1.1980975
	speed: 0.0057s/iter; left time: 37.0640s
	iters: 400, epoch: 2 | loss: 1.5534955
	speed: 0.0054s/iter; left time: 35.1180s
	iters: 500, epoch: 2 | loss: 0.6004169
	speed: 0.0054s/iter; left time: 34.5673s
	iters: 600, epoch: 2 | loss: 0.8697962
	speed: 0.0047s/iter; left time: 29.6535s
	iters: 700, epoch: 2 | loss: 0.3077996
	speed: 0.0058s/iter; left time: 35.8664s
	iters: 800, epoch: 2 | loss: 0.5477108
	speed: 0.0059s/iter; left time: 35.6805s
	iters: 900, epoch: 2 | loss: 1.5670955
	speed: 0.0049s/iter; left time: 29.1271s
Updating learning rate to 8.593066878421023e-05
Validation loss decreased (0.6215 --> 0.6067).  Saving model state dict ...
Epoch: 2 cost time: 4.985007047653198
Epoch: 2, Steps: 979 | Train Loss: 0.9100831 Vali Loss: 0.6067100 Best vali loss: 0.6067100
	iters: 100, epoch: 3 | loss: 0.5059435
	speed: 0.0207s/iter; left time: 119.6822s
	iters: 200, epoch: 3 | loss: 0.4191950
	speed: 0.0033s/iter; left time: 18.7071s
	iters: 300, epoch: 3 | loss: 0.9499871
	speed: 0.0033s/iter; left time: 18.1188s
	iters: 400, epoch: 3 | loss: 0.6207554
	speed: 0.0038s/iter; left time: 21.0291s
	iters: 500, epoch: 3 | loss: 0.7179261
	speed: 0.0044s/iter; left time: 23.6151s
	iters: 600, epoch: 3 | loss: 0.4685750
	speed: 0.0042s/iter; left time: 22.3909s
	iters: 700, epoch: 3 | loss: 1.2782134
	speed: 0.0041s/iter; left time: 21.2377s
	iters: 800, epoch: 3 | loss: 1.3845280
	speed: 0.0043s/iter; left time: 22.0753s
	iters: 900, epoch: 3 | loss: 0.6127213
	speed: 0.0042s/iter; left time: 20.7636s
Updating learning rate to 6.960016407256937e-05
Validation loss decreased (0.6067 --> 0.6036).  Saving model state dict ...
Epoch: 3 cost time: 3.940797805786133
Epoch: 3, Steps: 979 | Train Loss: 0.7730939 Vali Loss: 0.6036490 Best vali loss: 0.6036490
	iters: 100, epoch: 4 | loss: 0.7490259
	speed: 0.0166s/iter; left time: 79.4177s
	iters: 200, epoch: 4 | loss: 0.8229255
	speed: 0.0039s/iter; left time: 18.3762s
	iters: 300, epoch: 4 | loss: 0.3582459
	speed: 0.0040s/iter; left time: 18.2745s
	iters: 400, epoch: 4 | loss: 0.5403165
	speed: 0.0042s/iter; left time: 18.7092s
	iters: 500, epoch: 4 | loss: 0.8156634
	speed: 0.0042s/iter; left time: 18.5453s
	iters: 600, epoch: 4 | loss: 0.5228134
	speed: 0.0042s/iter; left time: 17.8900s
	iters: 700, epoch: 4 | loss: 0.6419549
	speed: 0.0043s/iter; left time: 17.9372s
	iters: 800, epoch: 4 | loss: 0.4393143
	speed: 0.0041s/iter; left time: 16.9091s
	iters: 900, epoch: 4 | loss: 1.0213071
	speed: 0.0041s/iter; left time: 16.3073s
Updating learning rate to 5.033702035e-05
Validation loss decreased (0.6036 --> 0.6021).  Saving model state dict ...
Epoch: 4 cost time: 4.076104640960693
Epoch: 4, Steps: 979 | Train Loss: 0.6568408 Vali Loss: 0.6020950 Best vali loss: 0.6020950
	iters: 100, epoch: 5 | loss: 0.9557328
	speed: 0.0165s/iter; left time: 62.8442s
	iters: 200, epoch: 5 | loss: 0.5747393
	speed: 0.0036s/iter; left time: 13.4910s
	iters: 300, epoch: 5 | loss: 0.4957066
	speed: 0.0038s/iter; left time: 13.6096s
	iters: 400, epoch: 5 | loss: 0.9865265
	speed: 0.0041s/iter; left time: 14.3828s
	iters: 500, epoch: 5 | loss: 0.6505919
	speed: 0.0042s/iter; left time: 14.2195s
	iters: 600, epoch: 5 | loss: 0.9115945
	speed: 0.0042s/iter; left time: 14.0326s
	iters: 700, epoch: 5 | loss: 0.4377656
	speed: 0.0041s/iter; left time: 13.2760s
	iters: 800, epoch: 5 | loss: 0.4547819
	speed: 0.0042s/iter; left time: 12.9467s
	iters: 900, epoch: 5 | loss: 1.1190197
	speed: 0.0042s/iter; left time: 12.6796s
Updating learning rate to 3.107387662743063e-05
Validation loss decreased (0.6021 --> 0.6013).  Saving model state dict ...
Epoch: 5 cost time: 3.978862762451172
Epoch: 5, Steps: 979 | Train Loss: 0.7318288 Vali Loss: 0.6012788 Best vali loss: 0.6012788
	iters: 100, epoch: 6 | loss: 0.8805703
	speed: 0.0168s/iter; left time: 47.7549s
	iters: 200, epoch: 6 | loss: 0.3588026
	speed: 0.0040s/iter; left time: 10.9609s
	iters: 300, epoch: 6 | loss: 0.2951933
	speed: 0.0042s/iter; left time: 11.2038s
	iters: 400, epoch: 6 | loss: 0.4099744
	speed: 0.0042s/iter; left time: 10.7516s
	iters: 500, epoch: 6 | loss: 0.2978097
	speed: 0.0043s/iter; left time: 10.5631s
	iters: 600, epoch: 6 | loss: 1.3175917
	speed: 0.0042s/iter; left time: 9.8595s
	iters: 700, epoch: 6 | loss: 0.3290267
	speed: 0.0043s/iter; left time: 9.5806s
	iters: 800, epoch: 6 | loss: 0.8242382
	speed: 0.0042s/iter; left time: 8.9805s
	iters: 900, epoch: 6 | loss: 0.8393402
	speed: 0.0041s/iter; left time: 8.3366s
Updating learning rate to 1.4743371915789763e-05
Epoch: 6 cost time: 4.131754398345947
Epoch: 6, Steps: 979 | Train Loss: 0.6169497 Vali Loss: 0.6022569 Best vali loss: 0.6012788
	iters: 100, epoch: 7 | loss: 0.9549893
	speed: 0.0158s/iter; left time: 29.4510s
	iters: 200, epoch: 7 | loss: 0.4876398
	speed: 0.0040s/iter; left time: 7.0968s
	iters: 300, epoch: 7 | loss: 0.6139461
	speed: 0.0042s/iter; left time: 6.9980s
	iters: 400, epoch: 7 | loss: 0.9803942
	speed: 0.0042s/iter; left time: 6.5452s
	iters: 500, epoch: 7 | loss: 0.8452910
	speed: 0.0043s/iter; left time: 6.2406s
	iters: 600, epoch: 7 | loss: 0.7627378
	speed: 0.0043s/iter; left time: 5.8079s
	iters: 700, epoch: 7 | loss: 0.9543122
	speed: 0.0042s/iter; left time: 5.2481s
	iters: 800, epoch: 7 | loss: 0.7236363
	speed: 0.0043s/iter; left time: 4.9657s
	iters: 900, epoch: 7 | loss: 1.4256754
	speed: 0.0042s/iter; left time: 4.4031s
Updating learning rate to 3.831677521030873e-06
Epoch: 7 cost time: 4.156745195388794
Epoch: 7, Steps: 979 | Train Loss: 0.8609580 Vali Loss: 0.6022696 Best vali loss: 0.6012788
	iters: 100, epoch: 8 | loss: 0.5978069
	speed: 0.0173s/iter; left time: 15.2458s
	iters: 200, epoch: 8 | loss: 0.5977336
	speed: 0.0042s/iter; left time: 3.3019s
	iters: 300, epoch: 8 | loss: 0.3705148
	speed: 0.0039s/iter; left time: 2.6535s
	iters: 400, epoch: 8 | loss: 0.5122159
	speed: 0.0041s/iter; left time: 2.3509s
	iters: 500, epoch: 8 | loss: 0.3128681
	speed: 0.0041s/iter; left time: 1.9905s
	iters: 600, epoch: 8 | loss: 0.6697516
	speed: 0.0042s/iter; left time: 1.5874s
	iters: 700, epoch: 8 | loss: 1.0910378
	speed: 0.0041s/iter; left time: 1.1356s
	iters: 800, epoch: 8 | loss: 0.6258128
	speed: 0.0041s/iter; left time: 0.7422s
	iters: 900, epoch: 8 | loss: 1.2358662
	speed: 0.0042s/iter; left time: 0.3347s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.083867073059082
Epoch: 8, Steps: 979 | Train Loss: 0.6681786 Vali Loss: 0.6024886 Best vali loss: 0.6012788

best validation loss 0.6012787775053353

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023549867609129905
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 0.8802614212036133
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6208343 Best vali loss: 0.6208343
Updating learning rate to 0.00020896390866591454
Validation loss decreased (0.6208 --> 0.6042).  Saving model state dict ...
Epoch: 2 cost time: 0.6332850456237793
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6042041 Best vali loss: 0.6042041
Updating learning rate to 0.00016925182282609557
Validation loss decreased (0.6042 --> 0.5999).  Saving model state dict ...
Epoch: 3 cost time: 0.6524333953857422
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5999282 Best vali loss: 0.5999282

best validation loss 0.5999282293163036

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.003902434905, 'e_layers': 2, 'learning_rate': 0.0003142995314, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003142995314
Validation loss decreased (inf --> 0.6701).  Saving model state dict ...
Epoch: 1 cost time: 0.7928528785705566
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6700850 Best vali loss: 0.6700850
Updating learning rate to 0.0001571497657
Validation loss decreased (0.6701 --> 0.6393).  Saving model state dict ...
Epoch: 2 cost time: 0.5051617622375488
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6393409 Best vali loss: 0.6393409
Updating learning rate to 7.857488285e-05
Validation loss decreased (0.6393 --> 0.6312).  Saving model state dict ...
Epoch: 3 cost time: 0.5458228588104248
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6312378 Best vali loss: 0.6312378

best validation loss 0.6312378010833666

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0096207564637, 'e_layers': 3, 'learning_rate': 0.0006050851787, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8702592
	speed: 0.0160s/iter; left time: 14.1777s
Updating learning rate to 0.0005820554953634322
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 1.4861061573028564
Epoch: 1, Steps: 123 | Train Loss: 0.8702592 Vali Loss: 0.6077642 Best vali loss: 0.6077642
	iters: 100, epoch: 2 | loss: 0.8885266
	speed: 0.0174s/iter; left time: 13.2762s
Updating learning rate to 0.0005164725058771219
Epoch: 2 cost time: 1.260584831237793
Epoch: 2, Steps: 123 | Train Loss: 0.8885266 Vali Loss: 0.6104869 Best vali loss: 0.6077642
	iters: 100, epoch: 3 | loss: 0.8451636
	speed: 0.0159s/iter; left time: 10.1345s
Updating learning rate to 0.00041832062587907987
Validation loss decreased (0.6078 --> 0.6014).  Saving model state dict ...
Epoch: 3 cost time: 1.2257649898529053
Epoch: 3, Steps: 123 | Train Loss: 0.8451636 Vali Loss: 0.6013582 Best vali loss: 0.6013582

best validation loss 0.6013581894824264

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00012240822365
Epoch: 4 cost time: 1.0774815082550049
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6010284 Best vali loss: 0.5999282
Updating learning rate to 7.556462447390446e-05
Validation loss decreased (0.5999 --> 0.5810).  Saving model state dict ...
Epoch: 5 cost time: 0.71305251121521
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5810395 Best vali loss: 0.5810395
Updating learning rate to 3.585253863408549e-05
Validation loss decreased (0.5810 --> 0.5782).  Saving model state dict ...
Epoch: 6 cost time: 0.7543118000030518
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5782269 Best vali loss: 0.5782269
Updating learning rate to 9.317771208700968e-06
Epoch: 7 cost time: 0.8741304874420166
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5878268 Best vali loss: 0.5782269
Updating learning rate to 0.0
Validation loss decreased (0.5782 --> 0.5754).  Saving model state dict ...
Epoch: 8 cost time: 0.7305855751037598
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5753511 Best vali loss: 0.5753511

best validation loss 0.5753511277849285

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0084606518785, 'e_layers': 3, 'learning_rate': 0.0001316855185, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8647662
	speed: 0.0174s/iter; left time: 32.4165s
	iters: 200, epoch: 1 | loss: 0.6703829
	speed: 0.0084s/iter; left time: 14.8607s
Updating learning rate to 0.0001316855185
Validation loss decreased (inf --> 0.5991).  Saving model state dict ...
Epoch: 1 cost time: 2.673145294189453
Epoch: 1, Steps: 245 | Train Loss: 0.7675745 Vali Loss: 0.5991029 Best vali loss: 0.5991029
	iters: 100, epoch: 2 | loss: 0.6643362
	speed: 0.0173s/iter; left time: 27.9190s
	iters: 200, epoch: 2 | loss: 0.6088311
	speed: 0.0087s/iter; left time: 13.2185s
Updating learning rate to 6.584275925e-05
Validation loss decreased (0.5991 --> 0.5945).  Saving model state dict ...
Epoch: 2 cost time: 2.4115922451019287
Epoch: 2, Steps: 245 | Train Loss: 0.6365837 Vali Loss: 0.5944582 Best vali loss: 0.5944582
	iters: 100, epoch: 3 | loss: 0.6410286
	speed: 0.0204s/iter; left time: 27.9640s
	iters: 200, epoch: 3 | loss: 0.8096058
	speed: 0.0090s/iter; left time: 11.4646s
Updating learning rate to 3.2921379625e-05
Validation loss decreased (0.5945 --> 0.5689).  Saving model state dict ...
Epoch: 3 cost time: 2.2042076587677
Epoch: 3, Steps: 245 | Train Loss: 0.7253172 Vali Loss: 0.5688679 Best vali loss: 0.5688679
	iters: 100, epoch: 4 | loss: 0.8367994
	speed: 0.0209s/iter; left time: 23.5741s
	iters: 200, epoch: 4 | loss: 0.9661611
	speed: 0.0087s/iter; left time: 8.9316s
Updating learning rate to 1.64606898125e-05
Validation loss decreased (0.5689 --> 0.5657).  Saving model state dict ...
Epoch: 4 cost time: 2.4526541233062744
Epoch: 4, Steps: 245 | Train Loss: 0.9014803 Vali Loss: 0.5657470 Best vali loss: 0.5657470
	iters: 100, epoch: 5 | loss: 0.8611001
	speed: 0.0188s/iter; left time: 16.5860s
	iters: 200, epoch: 5 | loss: 0.5579104
	speed: 0.0093s/iter; left time: 7.2927s
Updating learning rate to 8.23034490625e-06
Validation loss decreased (0.5657 --> 0.5609).  Saving model state dict ...
Epoch: 5 cost time: 2.4312448501586914
Epoch: 5, Steps: 245 | Train Loss: 0.7095053 Vali Loss: 0.5609363 Best vali loss: 0.5609363
	iters: 100, epoch: 6 | loss: 0.6426893
	speed: 0.0196s/iter; left time: 12.4620s
	iters: 200, epoch: 6 | loss: 0.7506387
	speed: 0.0085s/iter; left time: 4.5708s
Updating learning rate to 4.115172453125e-06
Validation loss decreased (0.5609 --> 0.5560).  Saving model state dict ...
Epoch: 6 cost time: 2.1986780166625977
Epoch: 6, Steps: 245 | Train Loss: 0.6966640 Vali Loss: 0.5560432 Best vali loss: 0.5560432
	iters: 100, epoch: 7 | loss: 0.6707356
	speed: 0.0207s/iter; left time: 8.1111s
	iters: 200, epoch: 7 | loss: 0.7087883
	speed: 0.0069s/iter; left time: 2.0116s
Updating learning rate to 2.0575862265625e-06
Epoch: 7 cost time: 2.2126474380493164
Epoch: 7, Steps: 245 | Train Loss: 0.6897620 Vali Loss: 0.5584753 Best vali loss: 0.5560432
	iters: 100, epoch: 8 | loss: 1.2521340
	speed: 0.0190s/iter; left time: 2.7728s
	iters: 200, epoch: 8 | loss: 0.7566367
	speed: 0.0096s/iter; left time: 0.4396s
Updating learning rate to 1.02879311328125e-06
Epoch: 8 cost time: 2.4158928394317627
Epoch: 8, Steps: 245 | Train Loss: 1.0043854 Vali Loss: 0.5567396 Best vali loss: 0.5560432

best validation loss 0.5560431571704048

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.001090227289, 'e_layers': 1, 'learning_rate': 7.24352627e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5594537
	speed: 0.0164s/iter; left time: 126.8596s
	iters: 200, epoch: 1 | loss: 1.0733546
	speed: 0.0089s/iter; left time: 67.7407s
	iters: 300, epoch: 1 | loss: 1.2470649
	speed: 0.0086s/iter; left time: 64.4073s
	iters: 400, epoch: 1 | loss: 0.6871268
	speed: 0.0096s/iter; left time: 71.4499s
	iters: 500, epoch: 1 | loss: 0.7265349
	speed: 0.0093s/iter; left time: 68.5584s
	iters: 600, epoch: 1 | loss: 0.8505865
	speed: 0.0072s/iter; left time: 51.8675s
	iters: 700, epoch: 1 | loss: 0.9421042
	speed: 0.0064s/iter; left time: 45.6427s
	iters: 800, epoch: 1 | loss: 1.4113153
	speed: 0.0041s/iter; left time: 28.8635s
	iters: 900, epoch: 1 | loss: 0.9676146
	speed: 0.0031s/iter; left time: 21.2893s
Updating learning rate to 7.24352627e-05
Validation loss decreased (inf --> 0.6087).  Saving model state dict ...
Epoch: 1 cost time: 7.290576457977295
Epoch: 1, Steps: 979 | Train Loss: 0.9405728 Vali Loss: 0.6086551 Best vali loss: 0.6086551
	iters: 100, epoch: 2 | loss: 0.5852739
	speed: 0.0220s/iter; left time: 148.8702s
	iters: 200, epoch: 2 | loss: 0.8829954
	speed: 0.0076s/iter; left time: 50.8418s
	iters: 300, epoch: 2 | loss: 0.6288917
	speed: 0.0075s/iter; left time: 48.9553s
	iters: 400, epoch: 2 | loss: 0.6420857
	speed: 0.0077s/iter; left time: 49.8517s
	iters: 500, epoch: 2 | loss: 1.2255625
	speed: 0.0079s/iter; left time: 49.9665s
	iters: 600, epoch: 2 | loss: 0.8054052
	speed: 0.0038s/iter; left time: 23.9010s
	iters: 700, epoch: 2 | loss: 0.2747797
	speed: 0.0039s/iter; left time: 24.0244s
	iters: 800, epoch: 2 | loss: 1.0422047
	speed: 0.0049s/iter; left time: 29.4275s
	iters: 900, epoch: 2 | loss: 1.1560783
	speed: 0.0082s/iter; left time: 48.7846s
Updating learning rate to 3.621763135e-05
Validation loss decreased (0.6087 --> 0.5990).  Saving model state dict ...
Epoch: 2 cost time: 6.617472171783447
Epoch: 2, Steps: 979 | Train Loss: 0.8048086 Vali Loss: 0.5989683 Best vali loss: 0.5989683
	iters: 100, epoch: 3 | loss: 0.6027346
	speed: 0.0285s/iter; left time: 164.7991s
	iters: 200, epoch: 3 | loss: 1.0910928
	speed: 0.0074s/iter; left time: 42.1751s
	iters: 300, epoch: 3 | loss: 0.5603274
	speed: 0.0065s/iter; left time: 36.2036s
	iters: 400, epoch: 3 | loss: 1.1572422
	speed: 0.0076s/iter; left time: 41.5241s
	iters: 500, epoch: 3 | loss: 0.5548602
	speed: 0.0076s/iter; left time: 40.7170s
	iters: 600, epoch: 3 | loss: 0.7735438
	speed: 0.0053s/iter; left time: 28.0484s
	iters: 700, epoch: 3 | loss: 1.8754654
	speed: 0.0037s/iter; left time: 19.0490s
	iters: 800, epoch: 3 | loss: 0.7610450
	speed: 0.0039s/iter; left time: 19.7690s
	iters: 900, epoch: 3 | loss: 1.0851871
	speed: 0.0050s/iter; left time: 25.0017s
Updating learning rate to 1.8108815675e-05
Epoch: 3 cost time: 6.08644700050354
Epoch: 3, Steps: 979 | Train Loss: 0.9401665 Vali Loss: 0.6132962 Best vali loss: 0.5989683
	iters: 100, epoch: 4 | loss: 0.5221973
	speed: 0.0245s/iter; left time: 117.5792s
	iters: 200, epoch: 4 | loss: 1.2640055
	speed: 0.0076s/iter; left time: 35.8920s
	iters: 300, epoch: 4 | loss: 0.2528357
	speed: 0.0075s/iter; left time: 34.4697s
	iters: 400, epoch: 4 | loss: 0.3533496
	speed: 0.0086s/iter; left time: 38.6991s
	iters: 500, epoch: 4 | loss: 0.7876926
	speed: 0.0079s/iter; left time: 34.7151s
	iters: 600, epoch: 4 | loss: 0.3963964
	speed: 0.0092s/iter; left time: 39.5212s
	iters: 700, epoch: 4 | loss: 0.4749228
	speed: 0.0094s/iter; left time: 39.6472s
	iters: 800, epoch: 4 | loss: 0.8152822
	speed: 0.0078s/iter; left time: 31.8292s
	iters: 900, epoch: 4 | loss: 0.9916555
	speed: 0.0067s/iter; left time: 26.6776s
Updating learning rate to 9.0544078375e-06
Epoch: 4 cost time: 7.739929437637329
Epoch: 4, Steps: 979 | Train Loss: 0.6509264 Vali Loss: 0.6128319 Best vali loss: 0.5989683
	iters: 100, epoch: 5 | loss: 0.8615767
	speed: 0.0232s/iter; left time: 88.4815s
	iters: 200, epoch: 5 | loss: 1.1374489
	speed: 0.0037s/iter; left time: 13.7813s
	iters: 300, epoch: 5 | loss: 0.3540166
	speed: 0.0036s/iter; left time: 13.1057s
	iters: 400, epoch: 5 | loss: 1.1377519
	speed: 0.0035s/iter; left time: 12.4743s
	iters: 500, epoch: 5 | loss: 0.9863777
	speed: 0.0036s/iter; left time: 12.2058s
	iters: 600, epoch: 5 | loss: 1.0100116
	speed: 0.0036s/iter; left time: 12.0689s
	iters: 700, epoch: 5 | loss: 1.3342760
	speed: 0.0037s/iter; left time: 11.9582s
	iters: 800, epoch: 5 | loss: 0.9974003
	speed: 0.0040s/iter; left time: 12.5738s
	iters: 900, epoch: 5 | loss: 0.8348252
	speed: 0.0045s/iter; left time: 13.6905s
Updating learning rate to 4.52720391875e-06
Epoch: 5 cost time: 3.872866153717041
Epoch: 5, Steps: 979 | Train Loss: 0.9615205 Vali Loss: 0.6104013 Best vali loss: 0.5989683
	iters: 100, epoch: 6 | loss: 0.7018005
	speed: 0.0184s/iter; left time: 52.0875s
	iters: 200, epoch: 6 | loss: 1.0739361
	speed: 0.0042s/iter; left time: 11.4761s
	iters: 300, epoch: 6 | loss: 0.2753462
	speed: 0.0038s/iter; left time: 9.9667s
	iters: 400, epoch: 6 | loss: 0.7063092
	speed: 0.0040s/iter; left time: 10.1387s
	iters: 500, epoch: 6 | loss: 0.5800451
	speed: 0.0044s/iter; left time: 10.7795s
	iters: 600, epoch: 6 | loss: 0.4907448
	speed: 0.0044s/iter; left time: 10.3969s
	iters: 700, epoch: 6 | loss: 0.8495141
	speed: 0.0045s/iter; left time: 9.9852s
	iters: 800, epoch: 6 | loss: 1.1727530
	speed: 0.0044s/iter; left time: 9.5061s
	iters: 900, epoch: 6 | loss: 0.6455241
	speed: 0.0046s/iter; left time: 9.2836s
Updating learning rate to 2.263601959375e-06
Epoch: 6 cost time: 4.2851457595825195
Epoch: 6, Steps: 979 | Train Loss: 0.7217748 Vali Loss: 0.6115996 Best vali loss: 0.5989683
	iters: 100, epoch: 7 | loss: 1.0505804
	speed: 0.0167s/iter; left time: 31.0364s
	iters: 200, epoch: 7 | loss: 0.2624805
	speed: 0.0045s/iter; left time: 7.8479s
	iters: 300, epoch: 7 | loss: 0.7637246
	speed: 0.0044s/iter; left time: 7.3043s
	iters: 400, epoch: 7 | loss: 0.5392195
	speed: 0.0044s/iter; left time: 6.9049s
	iters: 500, epoch: 7 | loss: 1.8426198
	speed: 0.0046s/iter; left time: 6.6388s
	iters: 600, epoch: 7 | loss: 0.5468704
	speed: 0.0048s/iter; left time: 6.4853s
	iters: 700, epoch: 7 | loss: 0.6974806
	speed: 0.0043s/iter; left time: 5.3577s
	iters: 800, epoch: 7 | loss: 1.0661877
	speed: 0.0040s/iter; left time: 4.6685s
	iters: 900, epoch: 7 | loss: 1.2302862
	speed: 0.0044s/iter; left time: 4.7094s
Updating learning rate to 1.1318009796875e-06
Epoch: 7 cost time: 4.372368335723877
Epoch: 7, Steps: 979 | Train Loss: 0.8888277 Vali Loss: 0.6140380 Best vali loss: 0.5989683
	iters: 100, epoch: 8 | loss: 0.4280763
	speed: 0.0174s/iter; left time: 15.3082s
	iters: 200, epoch: 8 | loss: 0.6878428
	speed: 0.0041s/iter; left time: 3.1721s
	iters: 300, epoch: 8 | loss: 0.9039609
	speed: 0.0040s/iter; left time: 2.7155s
	iters: 400, epoch: 8 | loss: 0.3428062
	speed: 0.0040s/iter; left time: 2.3460s
	iters: 500, epoch: 8 | loss: 0.6547005
	speed: 0.0041s/iter; left time: 1.9748s
	iters: 600, epoch: 8 | loss: 1.1190503
	speed: 0.0046s/iter; left time: 1.7513s
	iters: 700, epoch: 8 | loss: 0.8241785
	speed: 0.0046s/iter; left time: 1.2763s
	iters: 800, epoch: 8 | loss: 0.4241528
	speed: 0.0046s/iter; left time: 0.8307s
	iters: 900, epoch: 8 | loss: 1.0572140
	speed: 0.0046s/iter; left time: 0.3651s
Updating learning rate to 5.6590048984375e-07
Epoch: 8 cost time: 4.297461748123169
Epoch: 8, Steps: 979 | Train Loss: 0.7157758 Vali Loss: 0.6123780 Best vali loss: 0.5989683

best validation loss 0.5989683087034283

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0091131903544, 'e_layers': 4, 'learning_rate': 0.0029173918615, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5542381
	speed: 0.0151s/iter; left time: 28.0756s
	iters: 200, epoch: 1 | loss: 0.6126880
	speed: 0.0084s/iter; left time: 14.7955s
Updating learning rate to 0.0029173918615
Validation loss decreased (inf --> 0.6121).  Saving model state dict ...
Epoch: 1 cost time: 2.4863483905792236
Epoch: 1, Steps: 245 | Train Loss: 0.5834630 Vali Loss: 0.6121363 Best vali loss: 0.6121363
	iters: 100, epoch: 2 | loss: 0.6903867
	speed: 0.0172s/iter; left time: 27.8036s
	iters: 200, epoch: 2 | loss: 0.7978336
	speed: 0.0095s/iter; left time: 14.4512s
Updating learning rate to 0.00145869593075
Epoch: 2 cost time: 2.2806179523468018
Epoch: 2, Steps: 245 | Train Loss: 0.7441102 Vali Loss: 0.6344962 Best vali loss: 0.6121363
	iters: 100, epoch: 3 | loss: 1.0909489
	speed: 0.0189s/iter; left time: 25.8918s
	iters: 200, epoch: 3 | loss: 1.2488267
	speed: 0.0105s/iter; left time: 13.3302s
Updating learning rate to 0.000729347965375
Epoch: 3 cost time: 2.51446795463562
Epoch: 3, Steps: 245 | Train Loss: 1.1698878 Vali Loss: 0.6166178 Best vali loss: 0.6121363

best validation loss 0.6121363463720642

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010763178867, 'e_layers': 2, 'learning_rate': 0.0039079010684, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0039079010684
Validation loss decreased (inf --> 0.5997).  Saving model state dict ...
Epoch: 1 cost time: 0.902315616607666
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5996677 Best vali loss: 0.5996677
Updating learning rate to 0.0019539505342
Epoch: 2 cost time: 0.6254422664642334
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6243475 Best vali loss: 0.5996677
Updating learning rate to 0.0009769752671
Epoch: 3 cost time: 0.9119539260864258
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6252008 Best vali loss: 0.5996677

best validation loss 0.5996676607851296

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0101968430676, 'e_layers': 3, 'learning_rate': 0.0018502346986, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0017798143334893648
Validation loss decreased (inf --> 0.5955).  Saving model state dict ...
Epoch: 1 cost time: 0.9066646099090576
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5955341 Best vali loss: 0.5955341
Updating learning rate to 0.0015792741003833538
Epoch: 2 cost time: 0.6321732997894287
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6160174 Best vali loss: 0.5955341
Updating learning rate to 0.0012791444318706177
Validation loss decreased (0.5955 --> 0.5497).  Saving model state dict ...
Epoch: 3 cost time: 0.6330363750457764
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5497006 Best vali loss: 0.5497006

best validation loss 0.5497006056541538

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0101968430676, 'e_layers': 3, 'learning_rate': 0.0018502346986, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0009251173493
Validation loss decreased (0.5497 --> 0.5473).  Saving model state dict ...
Epoch: 4 cost time: 0.9075887203216553
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5472699 Best vali loss: 0.5472699
Updating learning rate to 0.0005710902667293824
Epoch: 5 cost time: 0.6368095874786377
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5567600 Best vali loss: 0.5472699
Updating learning rate to 0.0002709605982166461
Validation loss decreased (0.5473 --> 0.5435).  Saving model state dict ...
Epoch: 6 cost time: 0.6296877861022949
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5434793 Best vali loss: 0.5434793
Updating learning rate to 7.042036511063524e-05
Epoch: 7 cost time: 0.6327641010284424
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5522217 Best vali loss: 0.5434793
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6219689846038818
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5490589 Best vali loss: 0.5434793

best validation loss 0.5434793119957909

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038051638661, 'e_layers': 2, 'learning_rate': 0.0004113783415, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3267840
	speed: 0.0168s/iter; left time: 64.2341s
	iters: 200, epoch: 1 | loss: 0.9286007
	speed: 0.0080s/iter; left time: 29.8035s
	iters: 300, epoch: 1 | loss: 0.6288876
	speed: 0.0080s/iter; left time: 28.8967s
	iters: 400, epoch: 1 | loss: 0.5461948
	speed: 0.0081s/iter; left time: 28.3529s
Updating learning rate to 0.0004113783415
Validation loss decreased (inf --> 0.6051).  Saving model state dict ...
Epoch: 1 cost time: 4.501554012298584
Epoch: 1, Steps: 490 | Train Loss: 0.8576168 Vali Loss: 0.6051237 Best vali loss: 0.6051237
	iters: 100, epoch: 2 | loss: 0.9743749
	speed: 0.0241s/iter; left time: 80.1962s
	iters: 200, epoch: 2 | loss: 0.4145457
	speed: 0.0080s/iter; left time: 25.8004s
	iters: 300, epoch: 2 | loss: 0.8244762
	speed: 0.0080s/iter; left time: 24.9268s
	iters: 400, epoch: 2 | loss: 0.4902116
	speed: 0.0079s/iter; left time: 24.0959s
Updating learning rate to 0.00020568917075
Epoch: 2 cost time: 4.1516265869140625
Epoch: 2, Steps: 490 | Train Loss: 0.6759021 Vali Loss: 0.6054765 Best vali loss: 0.6051237
	iters: 100, epoch: 3 | loss: 0.2715024
	speed: 0.0221s/iter; left time: 62.6921s
	iters: 200, epoch: 3 | loss: 0.8474159
	speed: 0.0108s/iter; left time: 29.6492s
	iters: 300, epoch: 3 | loss: 0.6777058
	speed: 0.0108s/iter; left time: 28.6516s
	iters: 400, epoch: 3 | loss: 0.6792294
	speed: 0.0100s/iter; left time: 25.4515s
Updating learning rate to 0.000102844585375
Validation loss decreased (0.6051 --> 0.6040).  Saving model state dict ...
Epoch: 3 cost time: 5.276852130889893
Epoch: 3, Steps: 490 | Train Loss: 0.6189634 Vali Loss: 0.6039536 Best vali loss: 0.6039536
	iters: 100, epoch: 4 | loss: 0.6233287
	speed: 0.0380s/iter; left time: 89.2755s
	iters: 200, epoch: 4 | loss: 0.6504352
	speed: 0.0164s/iter; left time: 36.8275s
	iters: 300, epoch: 4 | loss: 1.1197289
	speed: 0.0111s/iter; left time: 23.8515s
	iters: 400, epoch: 4 | loss: 1.2940097
	speed: 0.0108s/iter; left time: 22.0716s
Updating learning rate to 5.14222926875e-05
Validation loss decreased (0.6040 --> 0.5979).  Saving model state dict ...
Epoch: 4 cost time: 6.218480825424194
Epoch: 4, Steps: 490 | Train Loss: 0.9218756 Vali Loss: 0.5978988 Best vali loss: 0.5978988
	iters: 100, epoch: 5 | loss: 0.4718604
	speed: 0.0318s/iter; left time: 59.1766s
	iters: 200, epoch: 5 | loss: 0.9548696
	speed: 0.0119s/iter; left time: 20.9304s
	iters: 300, epoch: 5 | loss: 0.8744742
	speed: 0.0086s/iter; left time: 14.2498s
	iters: 400, epoch: 5 | loss: 0.4708668
	speed: 0.0161s/iter; left time: 25.1893s
Updating learning rate to 2.571114634375e-05
Validation loss decreased (0.5979 --> 0.5947).  Saving model state dict ...
Epoch: 5 cost time: 5.8764612674713135
Epoch: 5, Steps: 490 | Train Loss: 0.6930177 Vali Loss: 0.5946697 Best vali loss: 0.5946697
	iters: 100, epoch: 6 | loss: 1.0472749
	speed: 0.0412s/iter; left time: 56.4563s
	iters: 200, epoch: 6 | loss: 0.6737267
	speed: 0.0126s/iter; left time: 16.0118s
	iters: 300, epoch: 6 | loss: 0.8767099
	speed: 0.0135s/iter; left time: 15.7934s
	iters: 400, epoch: 6 | loss: 0.8690217
	speed: 0.0146s/iter; left time: 15.6491s
Updating learning rate to 1.2855573171875e-05
Validation loss decreased (0.5947 --> 0.5903).  Saving model state dict ...
Epoch: 6 cost time: 6.378368377685547
Epoch: 6, Steps: 490 | Train Loss: 0.8666833 Vali Loss: 0.5902728 Best vali loss: 0.5902728
	iters: 100, epoch: 7 | loss: 1.0091122
	speed: 0.0404s/iter; left time: 35.5726s
	iters: 200, epoch: 7 | loss: 0.4146238
	speed: 0.0139s/iter; left time: 10.8621s
	iters: 300, epoch: 7 | loss: 0.8561172
	speed: 0.0142s/iter; left time: 9.6497s
	iters: 400, epoch: 7 | loss: 0.7665845
	speed: 0.0107s/iter; left time: 6.2023s
Updating learning rate to 6.4277865859375e-06
Epoch: 7 cost time: 6.102273941040039
Epoch: 7, Steps: 490 | Train Loss: 0.7616094 Vali Loss: 0.5929893 Best vali loss: 0.5902728
	iters: 100, epoch: 8 | loss: 0.5053620
	speed: 0.0338s/iter; left time: 13.2119s
	iters: 200, epoch: 8 | loss: 0.8865237
	speed: 0.0087s/iter; left time: 2.5242s
	iters: 300, epoch: 8 | loss: 0.7396771
	speed: 0.0079s/iter; left time: 1.5121s
	iters: 400, epoch: 8 | loss: 0.8257251
	speed: 0.0078s/iter; left time: 0.7138s
Updating learning rate to 3.21389329296875e-06
Epoch: 8 cost time: 4.366637706756592
Epoch: 8, Steps: 490 | Train Loss: 0.7393220 Vali Loss: 0.5918456 Best vali loss: 0.5902728

best validation loss 0.5902727801371702

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070932288252, 'e_layers': 4, 'learning_rate': 0.0005299103803, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8093131
	speed: 0.0154s/iter; left time: 119.1785s
	iters: 200, epoch: 1 | loss: 0.6741544
	speed: 0.0095s/iter; left time: 72.8475s
	iters: 300, epoch: 1 | loss: 0.4522876
	speed: 0.0094s/iter; left time: 71.1203s
	iters: 400, epoch: 1 | loss: 0.6466581
	speed: 0.0095s/iter; left time: 70.2470s
	iters: 500, epoch: 1 | loss: 0.9164764
	speed: 0.0097s/iter; left time: 71.0581s
	iters: 600, epoch: 1 | loss: 1.7294636
	speed: 0.0094s/iter; left time: 67.8119s
	iters: 700, epoch: 1 | loss: 0.5429952
	speed: 0.0093s/iter; left time: 66.4475s
	iters: 800, epoch: 1 | loss: 0.4192351
	speed: 0.0083s/iter; left time: 58.4212s
	iters: 900, epoch: 1 | loss: 0.3877233
	speed: 0.0066s/iter; left time: 45.7314s
Updating learning rate to 0.0005299103803
Validation loss decreased (inf --> 0.6147).  Saving model state dict ...
Epoch: 1 cost time: 9.102138996124268
Epoch: 1, Steps: 979 | Train Loss: 0.7309230 Vali Loss: 0.6146993 Best vali loss: 0.6146993
	iters: 100, epoch: 2 | loss: 1.9180715
	speed: 0.0345s/iter; left time: 233.2230s
	iters: 200, epoch: 2 | loss: 0.7528650
	speed: 0.0124s/iter; left time: 82.7976s
	iters: 300, epoch: 2 | loss: 1.3209916
	speed: 0.0119s/iter; left time: 78.2275s
	iters: 400, epoch: 2 | loss: 0.8568367
	speed: 0.0116s/iter; left time: 75.0350s
	iters: 500, epoch: 2 | loss: 1.4588768
	speed: 0.0103s/iter; left time: 65.1773s
	iters: 600, epoch: 2 | loss: 0.9717753
	speed: 0.0124s/iter; left time: 77.6210s
	iters: 700, epoch: 2 | loss: 0.7233230
	speed: 0.0126s/iter; left time: 77.6038s
	iters: 800, epoch: 2 | loss: 0.8828422
	speed: 0.0123s/iter; left time: 74.4844s
	iters: 900, epoch: 2 | loss: 0.7548117
	speed: 0.0125s/iter; left time: 74.1504s
Updating learning rate to 0.00026495519015
Validation loss decreased (0.6147 --> 0.6135).  Saving model state dict ...
Epoch: 2 cost time: 11.848743438720703
Epoch: 2, Steps: 979 | Train Loss: 1.0711549 Vali Loss: 0.6134727 Best vali loss: 0.6134727
	iters: 100, epoch: 3 | loss: 0.4282309
	speed: 0.0382s/iter; left time: 220.5616s
	iters: 200, epoch: 3 | loss: 0.6446939
	speed: 0.0127s/iter; left time: 71.9467s
	iters: 300, epoch: 3 | loss: 1.1949034
	speed: 0.0121s/iter; left time: 67.6724s
	iters: 400, epoch: 3 | loss: 1.0216454
	speed: 0.0123s/iter; left time: 67.5013s
	iters: 500, epoch: 3 | loss: 0.8500068
	speed: 0.0120s/iter; left time: 64.3124s
	iters: 600, epoch: 3 | loss: 0.4896894
	speed: 0.0105s/iter; left time: 55.2675s
	iters: 700, epoch: 3 | loss: 0.3023989
	speed: 0.0125s/iter; left time: 64.4530s
	iters: 800, epoch: 3 | loss: 0.7798766
	speed: 0.0123s/iter; left time: 62.4293s
	iters: 900, epoch: 3 | loss: 0.4640274
	speed: 0.0126s/iter; left time: 62.9322s
Updating learning rate to 0.000132477595075
Validation loss decreased (0.6135 --> 0.5995).  Saving model state dict ...
Epoch: 3 cost time: 11.97307014465332
Epoch: 3, Steps: 979 | Train Loss: 0.6861636 Vali Loss: 0.5995493 Best vali loss: 0.5995493
	iters: 100, epoch: 4 | loss: 0.7458030
	speed: 0.0352s/iter; left time: 168.7801s
	iters: 200, epoch: 4 | loss: 1.1351501
	speed: 0.0115s/iter; left time: 54.2090s
	iters: 300, epoch: 4 | loss: 0.2701416
	speed: 0.0125s/iter; left time: 57.4038s
	iters: 400, epoch: 4 | loss: 0.9368219
	speed: 0.0120s/iter; left time: 54.1691s
	iters: 500, epoch: 4 | loss: 0.7995278
	speed: 0.0120s/iter; left time: 52.6310s
	iters: 600, epoch: 4 | loss: 1.1322497
	speed: 0.0124s/iter; left time: 53.3965s
	iters: 700, epoch: 4 | loss: 0.4284526
	speed: 0.0109s/iter; left time: 45.6710s
	iters: 800, epoch: 4 | loss: 0.6988175
	speed: 0.0113s/iter; left time: 46.4735s
	iters: 900, epoch: 4 | loss: 0.7221901
	speed: 0.0125s/iter; left time: 50.1188s
Updating learning rate to 6.62387975375e-05
Validation loss decreased (0.5995 --> 0.5777).  Saving model state dict ...
Epoch: 4 cost time: 11.433778762817383
Epoch: 4, Steps: 979 | Train Loss: 0.7632394 Vali Loss: 0.5777351 Best vali loss: 0.5777351
	iters: 100, epoch: 5 | loss: 0.5848789
	speed: 0.0365s/iter; left time: 139.3277s
	iters: 200, epoch: 5 | loss: 0.9223738
	speed: 0.0112s/iter; left time: 41.6091s
	iters: 300, epoch: 5 | loss: 0.8823186
	speed: 0.0113s/iter; left time: 40.8787s
	iters: 400, epoch: 5 | loss: 0.7372539
	speed: 0.0115s/iter; left time: 40.5268s
	iters: 500, epoch: 5 | loss: 0.3502185
	speed: 0.0130s/iter; left time: 44.3997s
	iters: 600, epoch: 5 | loss: 0.4960356
	speed: 0.0139s/iter; left time: 46.0017s
	iters: 700, epoch: 5 | loss: 0.8394464
	speed: 0.0122s/iter; left time: 39.2975s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0094053072029, 'e_layers': 3, 'learning_rate': 0.0019799505799, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0019799505799
Validation loss decreased (inf --> 0.6919).  Saving model state dict ...
Epoch: 1 cost time: 1.702958345413208
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6918604 Best vali loss: 0.6918604
Updating learning rate to 0.00098997528995
Validation loss decreased (0.6919 --> 0.6575).  Saving model state dict ...
Epoch: 2 cost time: 1.284752607345581
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6575123 Best vali loss: 0.6575123
Updating learning rate to 0.000494987644975
Validation loss decreased (0.6575 --> 0.6404).  Saving model state dict ...
Epoch: 3 cost time: 1.3405964374542236
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6404360 Best vali loss: 0.6404360

best validation loss 0.6404360026631406

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0015770726247, 'e_layers': 1, 'learning_rate': 0.0002662824309, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8862504
	speed: 0.0146s/iter; left time: 12.8999s
Updating learning rate to 0.0002662824309
Validation loss decreased (inf --> 0.6555).  Saving model state dict ...
Epoch: 1 cost time: 1.3470821380615234
Epoch: 1, Steps: 123 | Train Loss: 0.8862504 Vali Loss: 0.6554525 Best vali loss: 0.6554525
	iters: 100, epoch: 2 | loss: 1.0105048
	speed: 0.0127s/iter; left time: 9.6986s
Updating learning rate to 0.00013314121545
Validation loss decreased (0.6555 --> 0.6285).  Saving model state dict ...
Epoch: 2 cost time: 0.9966957569122314
Epoch: 2, Steps: 123 | Train Loss: 1.0105048 Vali Loss: 0.6285155 Best vali loss: 0.6285155
	iters: 100, epoch: 3 | loss: 0.6326348
	speed: 0.0086s/iter; left time: 5.5250s
Updating learning rate to 6.6570607725e-05
Validation loss decreased (0.6285 --> 0.6214).  Saving model state dict ...
Epoch: 3 cost time: 0.6034455299377441
Epoch: 3, Steps: 123 | Train Loss: 0.6326348 Vali Loss: 0.6214109 Best vali loss: 0.6214109

best validation loss 0.6214108556191825

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.002107290471, 'e_layers': 2, 'learning_rate': 0.0013961478844, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0013961478844
Validation loss decreased (inf --> 0.6123).  Saving model state dict ...
Epoch: 1 cost time: 0.912003755569458
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6122806 Best vali loss: 0.6122806
Updating learning rate to 0.0006980739422
Validation loss decreased (0.6123 --> 0.5938).  Saving model state dict ...
Epoch: 2 cost time: 0.7436830997467041
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5937953 Best vali loss: 0.5937953
Updating learning rate to 0.0003490369711
Validation loss decreased (0.5938 --> 0.5662).  Saving model state dict ...
Epoch: 3 cost time: 0.7683286666870117
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5662285 Best vali loss: 0.5662285

best validation loss 0.5662285386826472

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.002107290471, 'e_layers': 2, 'learning_rate': 0.0013961478844, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00017451848555
Validation loss decreased (0.5662 --> 0.5552).  Saving model state dict ...
Epoch: 4 cost time: 1.131040334701538
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5552428 Best vali loss: 0.5552428
Updating learning rate to 8.7259242775e-05
Validation loss decreased (0.5552 --> 0.5544).  Saving model state dict ...
Epoch: 5 cost time: 0.7576172351837158
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5544151 Best vali loss: 0.5544151
Updating learning rate to 4.36296213875e-05
Validation loss decreased (0.5544 --> 0.5503).  Saving model state dict ...
Epoch: 6 cost time: 0.7586851119995117
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5502542 Best vali loss: 0.5502542
Updating learning rate to 2.181481069375e-05
Validation loss decreased (0.5503 --> 0.5495).  Saving model state dict ...
Epoch: 7 cost time: 0.6512508392333984
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5494667 Best vali loss: 0.5494667
Updating learning rate to 1.0907405346875e-05
Epoch: 8 cost time: 0.8036675453186035
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5495397 Best vali loss: 0.5494667

best validation loss 0.5494666863017367

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0025086776697, 'e_layers': 2, 'learning_rate': 0.0038401597058, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0038401597058
Validation loss decreased (inf --> 0.6249).  Saving model state dict ...
Epoch: 1 cost time: 1.0443074703216553
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6249357 Best vali loss: 0.6249357
Updating learning rate to 0.0019200798529
Epoch: 2 cost time: 0.8605136871337891
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6251036 Best vali loss: 0.6249357
Updating learning rate to 0.00096003992645
Validation loss decreased (0.6249 --> 0.6179).  Saving model state dict ...
Epoch: 3 cost time: 0.7563066482543945
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6179494 Best vali loss: 0.6179494
Updating learning rate to 0.000480019963225
Epoch: 4 cost time: 0.7300987243652344
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6477147 Best vali loss: 0.6179494
Updating learning rate to 0.0002400099816125
Epoch: 5 cost time: 0.673736572265625
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6547602 Best vali loss: 0.6179494
Updating learning rate to 0.00012000499080625
Epoch: 6 cost time: 0.8980426788330078
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6770158 Best vali loss: 0.6179494
Updating learning rate to 6.0002495403125e-05
Epoch: 7 cost time: 0.6752152442932129
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6627851 Best vali loss: 0.6179494
Updating learning rate to 3.00012477015625e-05
Epoch: 8 cost time: 0.701073408126831
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6666713 Best vali loss: 0.6179494

best validation loss 0.6179493763059557

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0015460420617, 'e_layers': 4, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1765653
	speed: 0.0207s/iter; left time: 79.2282s
	iters: 200, epoch: 1 | loss: 0.9289320
	speed: 0.0135s/iter; left time: 50.3262s
	iters: 300, epoch: 1 | loss: 0.7720191
	speed: 0.0133s/iter; left time: 48.3127s
	iters: 400, epoch: 1 | loss: 0.5902950
	speed: 0.0123s/iter; left time: 43.4089s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.6068).  Saving model state dict ...
Epoch: 1 cost time: 6.67392897605896
Epoch: 1, Steps: 490 | Train Loss: 0.8669528 Vali Loss: 0.6067896 Best vali loss: 0.6067896
	iters: 100, epoch: 2 | loss: 0.9335743
	speed: 0.0341s/iter; left time: 113.5886s
	iters: 200, epoch: 2 | loss: 1.1128629
	speed: 0.0113s/iter; left time: 36.6683s
	iters: 300, epoch: 2 | loss: 0.5668111
	speed: 0.0171s/iter; left time: 53.3884s
	iters: 400, epoch: 2 | loss: 1.0047385
	speed: 0.0168s/iter; left time: 50.9032s
Updating learning rate to 0.000552421030539641
Validation loss decreased (0.6068 --> 0.6008).  Saving model state dict ...
Epoch: 2 cost time: 7.127238512039185
Epoch: 2, Steps: 490 | Train Loss: 0.9044967 Vali Loss: 0.6008109 Best vali loss: 0.6008109
	iters: 100, epoch: 3 | loss: 0.4724721
	speed: 0.0304s/iter; left time: 86.2511s
	iters: 200, epoch: 3 | loss: 0.5972348
	speed: 0.0109s/iter; left time: 29.9472s
	iters: 300, epoch: 3 | loss: 0.5998135
	speed: 0.0103s/iter; left time: 27.2307s
	iters: 400, epoch: 3 | loss: 0.4660180
	speed: 0.0105s/iter; left time: 26.7500s
Updating learning rate to 0.00044743739233834293
Epoch: 3 cost time: 5.103424072265625
Epoch: 3, Steps: 490 | Train Loss: 0.5338846 Vali Loss: 0.6152265 Best vali loss: 0.6008109
	iters: 100, epoch: 4 | loss: 0.6148606
	speed: 0.0258s/iter; left time: 60.7326s
	iters: 200, epoch: 4 | loss: 0.9478562
	speed: 0.0089s/iter; left time: 20.0763s
	iters: 300, epoch: 4 | loss: 0.4447782
	speed: 0.0099s/iter; left time: 21.3137s
	iters: 400, epoch: 4 | loss: 0.4681266
	speed: 0.0099s/iter; left time: 20.3837s
Updating learning rate to 0.00032360074755
Epoch: 4 cost time: 4.688552141189575
Epoch: 4, Steps: 490 | Train Loss: 0.6189054 Vali Loss: 0.6121244 Best vali loss: 0.6008109
	iters: 100, epoch: 5 | loss: 1.2329092
	speed: 0.0256s/iter; left time: 47.6895s
	iters: 200, epoch: 5 | loss: 1.0616205
	speed: 0.0089s/iter; left time: 15.6937s
	iters: 300, epoch: 5 | loss: 0.9200010
	speed: 0.0086s/iter; left time: 14.2692s
	iters: 400, epoch: 5 | loss: 0.7860320
	speed: 0.0093s/iter; left time: 14.5308s
Updating learning rate to 0.0001997641027616571
Epoch: 5 cost time: 4.647470951080322
Epoch: 5, Steps: 490 | Train Loss: 1.0001407 Vali Loss: 0.6109659 Best vali loss: 0.6008109
	iters: 100, epoch: 6 | loss: 0.8181459
	speed: 0.0273s/iter; left time: 37.3785s
	iters: 200, epoch: 6 | loss: 0.4759181
	speed: 0.0101s/iter; left time: 12.7833s
	iters: 300, epoch: 6 | loss: 0.9722409
	speed: 0.0090s/iter; left time: 10.5617s
	iters: 400, epoch: 6 | loss: 0.6736568
	speed: 0.0087s/iter; left time: 9.3186s
Updating learning rate to 9.478046456035896e-05
Validation loss decreased (0.6008 --> 0.5986).  Saving model state dict ...
Epoch: 6 cost time: 4.805286407470703
Epoch: 6, Steps: 490 | Train Loss: 0.7349904 Vali Loss: 0.5986487 Best vali loss: 0.5986487
	iters: 100, epoch: 7 | loss: 0.8117900
	speed: 0.0264s/iter; left time: 23.2266s
	iters: 200, epoch: 7 | loss: 0.7494351
	speed: 0.0104s/iter; left time: 8.1207s
	iters: 300, epoch: 7 | loss: 0.6709090
	speed: 0.0104s/iter; left time: 7.1019s
	iters: 400, epoch: 7 | loss: 1.2768972
	speed: 0.0094s/iter; left time: 5.4679s
Updating learning rate to 2.463264018320308e-05
Validation loss decreased (0.5986 --> 0.5935).  Saving model state dict ...
Epoch: 7 cost time: 4.928173303604126
Epoch: 7, Steps: 490 | Train Loss: 0.8772578 Vali Loss: 0.5934951 Best vali loss: 0.5934951
	iters: 100, epoch: 8 | loss: 0.4150326
	speed: 0.0264s/iter; left time: 10.3045s
	iters: 200, epoch: 8 | loss: 0.5850157
	speed: 0.0102s/iter; left time: 2.9746s
	iters: 300, epoch: 8 | loss: 0.8284984
	speed: 0.0103s/iter; left time: 1.9720s
	iters: 400, epoch: 8 | loss: 0.4301625
	speed: 0.0108s/iter; left time: 0.9802s
Updating learning rate to 0.0
Validation loss decreased (0.5935 --> 0.5909).  Saving model state dict ...
Epoch: 8 cost time: 5.062915802001953
Epoch: 8, Steps: 490 | Train Loss: 0.5646773 Vali Loss: 0.5909066 Best vali loss: 0.5909066

best validation loss 0.5909066410844716

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0011650416776, 'e_layers': 3, 'learning_rate': 0.0006284742465, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9099146
	speed: 0.0133s/iter; left time: 24.7469s
	iters: 200, epoch: 1 | loss: 0.6654773
	speed: 0.0095s/iter; left time: 16.7351s
Updating learning rate to 0.0006284742465
Validation loss decreased (inf --> 0.6026).  Saving model state dict ...
Epoch: 1 cost time: 2.448307752609253
Epoch: 1, Steps: 245 | Train Loss: 0.7876959 Vali Loss: 0.6026386 Best vali loss: 0.6026386
	iters: 100, epoch: 2 | loss: 0.7554643
	speed: 0.0202s/iter; left time: 32.6057s
	iters: 200, epoch: 2 | loss: 0.7331809
	speed: 0.0103s/iter; left time: 15.6034s
Updating learning rate to 0.00031423712325
Epoch: 2 cost time: 2.549426555633545
Epoch: 2, Steps: 245 | Train Loss: 0.7443226 Vali Loss: 0.6090878 Best vali loss: 0.6026386
	iters: 100, epoch: 3 | loss: 0.8199268
	speed: 0.0185s/iter; left time: 25.3937s
	iters: 200, epoch: 3 | loss: 1.0833269
	speed: 0.0114s/iter; left time: 14.5451s
Updating learning rate to 0.000157118561625
Epoch: 3 cost time: 2.843709707260132
Epoch: 3, Steps: 245 | Train Loss: 0.9516269 Vali Loss: 0.6233545 Best vali loss: 0.6026386

best validation loss 0.6026385893484113

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0028185381011, 'e_layers': 4, 'learning_rate': 0.0001995278037, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001995278037
Validation loss decreased (inf --> 0.6017).  Saving model state dict ...
Epoch: 1 cost time: 2.0491905212402344
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6017230 Best vali loss: 0.6017230
Updating learning rate to 9.976390185e-05
Validation loss decreased (0.6017 --> 0.6006).  Saving model state dict ...
Epoch: 2 cost time: 1.1092607975006104
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6005845 Best vali loss: 0.6005845
Updating learning rate to 4.9881950925e-05
Validation loss decreased (0.6006 --> 0.5911).  Saving model state dict ...
Epoch: 3 cost time: 1.2647383213043213
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5911098 Best vali loss: 0.5911098

best validation loss 0.5911097723485584

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0035369297299, 'e_layers': 3, 'learning_rate': 0.0015538017858, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7155268
	speed: 0.0192s/iter; left time: 35.7415s
	iters: 200, epoch: 1 | loss: 1.2442911
	speed: 0.0138s/iter; left time: 24.3555s
Updating learning rate to 0.0015538017858
Validation loss decreased (inf --> 0.6279).  Saving model state dict ...
Epoch: 1 cost time: 3.6026573181152344
Epoch: 1, Steps: 245 | Train Loss: 0.9799089 Vali Loss: 0.6279256 Best vali loss: 0.6279256
	iters: 100, epoch: 2 | loss: 1.2211952
	speed: 0.0436s/iter; left time: 70.4108s
	iters: 200, epoch: 2 | loss: 0.7410768
	speed: 0.0214s/iter; left time: 32.3961s
Updating learning rate to 0.0007769008929
Validation loss decreased (0.6279 --> 0.6057).  Saving model state dict ...
Epoch: 2 cost time: 5.343131065368652
Epoch: 2, Steps: 245 | Train Loss: 0.9811360 Vali Loss: 0.6057273 Best vali loss: 0.6057273
	iters: 100, epoch: 3 | loss: 0.5244499
	speed: 0.0633s/iter; left time: 86.7898s
	iters: 200, epoch: 3 | loss: 0.8465647
	speed: 0.0263s/iter; left time: 33.4427s
Updating learning rate to 0.00038845044645
Epoch: 3 cost time: 5.773287773132324
Epoch: 3, Steps: 245 | Train Loss: 0.6855073 Vali Loss: 0.6340951 Best vali loss: 0.6057273

best validation loss 0.6057273207412501

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0028185381011, 'e_layers': 4, 'learning_rate': 0.0001995278037, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.49409754625e-05
Validation loss decreased (0.5911 --> 0.5875).  Saving model state dict ...
Epoch: 4 cost time: 2.0811803340911865
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5874784 Best vali loss: 0.5874784
Updating learning rate to 1.247048773125e-05
Validation loss decreased (0.5875 --> 0.5704).  Saving model state dict ...
Epoch: 5 cost time: 1.4151175022125244
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5704185 Best vali loss: 0.5704185
Updating learning rate to 6.235243865625e-06
Epoch: 6 cost time: 1.8068835735321045
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5722758 Best vali loss: 0.5704185
Updating learning rate to 3.1176219328125e-06
Epoch: 7 cost time: 1.0001511573791504
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5718447 Best vali loss: 0.5704185
Updating learning rate to 1.55881096640625e-06
Validation loss decreased (0.5704 --> 0.5694).  Saving model state dict ...
Epoch: 8 cost time: 1.2150459289550781
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5693675 Best vali loss: 0.5693675

best validation loss 0.5693674546212634

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018136847288, 'e_layers': 2, 'learning_rate': 0.0002984833543, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4904987
	speed: 0.0146s/iter; left time: 112.9129s
	iters: 200, epoch: 1 | loss: 1.5206153
	speed: 0.0086s/iter; left time: 65.6222s
	iters: 300, epoch: 1 | loss: 0.7394667
	speed: 0.0090s/iter; left time: 67.7176s
	iters: 400, epoch: 1 | loss: 0.6190772
	speed: 0.0087s/iter; left time: 64.5939s
	iters: 500, epoch: 1 | loss: 0.5256062
	speed: 0.0072s/iter; left time: 52.9152s
	iters: 600, epoch: 1 | loss: 0.7088754
	speed: 0.0082s/iter; left time: 59.0195s
	iters: 700, epoch: 1 | loss: 0.4525136
	speed: 0.0083s/iter; left time: 58.8574s
	iters: 800, epoch: 1 | loss: 1.3636996
	speed: 0.0086s/iter; left time: 60.3663s
	iters: 900, epoch: 1 | loss: 0.3507168
	speed: 0.0089s/iter; left time: 61.9866s
Updating learning rate to 0.0002984833543
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 8.598171949386597
Epoch: 1, Steps: 979 | Train Loss: 0.7523411 Vali Loss: 0.6019550 Best vali loss: 0.6019550
	iters: 100, epoch: 2 | loss: 0.9199397
	speed: 0.0307s/iter; left time: 207.1332s
	iters: 200, epoch: 2 | loss: 1.1863971
	speed: 0.0082s/iter; left time: 54.4683s
	iters: 300, epoch: 2 | loss: 0.8872107
	speed: 0.0080s/iter; left time: 52.6866s
	iters: 400, epoch: 2 | loss: 0.8606494
	speed: 0.0075s/iter; left time: 48.6335s
	iters: 500, epoch: 2 | loss: 0.8282114
	speed: 0.0082s/iter; left time: 52.1637s
	iters: 600, epoch: 2 | loss: 0.7345314
	speed: 0.0086s/iter; left time: 53.7517s
	iters: 700, epoch: 2 | loss: 0.8702340
	speed: 0.0096s/iter; left time: 59.2335s
	iters: 800, epoch: 2 | loss: 0.4257031
	speed: 0.0088s/iter; left time: 53.0778s
	iters: 900, epoch: 2 | loss: 1.0869943
	speed: 0.0085s/iter; left time: 50.6885s
Updating learning rate to 0.00014924167715
Epoch: 2 cost time: 8.217302083969116
Epoch: 2, Steps: 979 | Train Loss: 0.8666523 Vali Loss: 0.6092430 Best vali loss: 0.6019550
	iters: 100, epoch: 3 | loss: 1.7074594
	speed: 0.0305s/iter; left time: 176.2296s
	iters: 200, epoch: 3 | loss: 0.8291715
	speed: 0.0089s/iter; left time: 50.3765s
	iters: 300, epoch: 3 | loss: 0.6612512
	speed: 0.0085s/iter; left time: 47.1104s
	iters: 400, epoch: 3 | loss: 0.7976982
	speed: 0.0083s/iter; left time: 45.6877s
	iters: 500, epoch: 3 | loss: 0.6043773
	speed: 0.0085s/iter; left time: 45.7889s
	iters: 600, epoch: 3 | loss: 0.9798652
	speed: 0.0085s/iter; left time: 44.8968s
	iters: 700, epoch: 3 | loss: 1.3312558
	speed: 0.0090s/iter; left time: 46.3717s
	iters: 800, epoch: 3 | loss: 0.4174733
	speed: 0.0085s/iter; left time: 43.2508s
	iters: 900, epoch: 3 | loss: 1.0029870
	speed: 0.0082s/iter; left time: 40.6511s
Updating learning rate to 7.4620838575e-05
Epoch: 3 cost time: 8.469005107879639
Epoch: 3, Steps: 979 | Train Loss: 0.9257266 Vali Loss: 0.6159477 Best vali loss: 0.6019550
	iters: 100, epoch: 4 | loss: 0.9442901
	speed: 0.0300s/iter; left time: 143.7905s
	iters: 200, epoch: 4 | loss: 0.6955911
	speed: 0.0094s/iter; left time: 43.9506s
	iters: 300, epoch: 4 | loss: 1.5836017
	speed: 0.0087s/iter; left time: 39.9660s
	iters: 400, epoch: 4 | loss: 0.8384164
	speed: 0.0078s/iter; left time: 34.9882s
	iters: 500, epoch: 4 | loss: 1.2423398
	speed: 0.0082s/iter; left time: 35.9611s
	iters: 600, epoch: 4 | loss: 0.4466508
	speed: 0.0083s/iter; left time: 35.7407s
	iters: 700, epoch: 4 | loss: 0.6129290
	speed: 0.0084s/iter; left time: 35.4246s
	iters: 800, epoch: 4 | loss: 1.0001760
	speed: 0.0098s/iter; left time: 40.0640s
	iters: 900, epoch: 4 | loss: 1.3564682
	speed: 0.0088s/iter; left time: 35.0909s
Updating learning rate to 3.73104192875e-05
Epoch: 4 cost time: 8.493354797363281
Epoch: 4, Steps: 979 | Train Loss: 0.9689403 Vali Loss: 0.6189565 Best vali loss: 0.6019550
	iters: 100, epoch: 5 | loss: 0.9953362
	speed: 0.0289s/iter; left time: 110.4623s
	iters: 200, epoch: 5 | loss: 0.9214141
	speed: 0.0084s/iter; left time: 31.3015s
	iters: 300, epoch: 5 | loss: 0.8176641
	speed: 0.0098s/iter; left time: 35.5791s
	iters: 400, epoch: 5 | loss: 0.7486050
	speed: 0.0083s/iter; left time: 29.0553s
	iters: 500, epoch: 5 | loss: 0.4012519
	speed: 0.0082s/iter; left time: 28.0573s
	iters: 600, epoch: 5 | loss: 0.8176242
	speed: 0.0080s/iter; left time: 26.4982s
	iters: 700, epoch: 5 | loss: 0.2345472
	speed: 0.0080s/iter; left time: 25.6404s
	iters: 800, epoch: 5 | loss: 0.5439380
	speed: 0.0079s/iter; left time: 24.6639s
	iters: 900, epoch: 5 | loss: 0.8649670
	speed: 0.0081s/iter; left time: 24.3325s
Updating learning rate to 1.865520964375e-05
Epoch: 5 cost time: 8.05795931816101
Epoch: 5, Steps: 979 | Train Loss: 0.7050386 Vali Loss: 0.6138170 Best vali loss: 0.6019550
	iters: 100, epoch: 6 | loss: 0.4282351
	speed: 0.0406s/iter; left time: 115.3546s
	iters: 200, epoch: 6 | loss: 0.2804110
	speed: 0.0099s/iter; left time: 27.0397s
	iters: 300, epoch: 6 | loss: 0.4066710
	speed: 0.0100s/iter; left time: 26.2923s
	iters: 400, epoch: 6 | loss: 0.6838847
	speed: 0.0119s/iter; left time: 30.1441s
	iters: 500, epoch: 6 | loss: 1.0329574
	speed: 0.0077s/iter; left time: 18.6855s
	iters: 600, epoch: 6 | loss: 0.7969134
	speed: 0.0081s/iter; left time: 18.9307s
	iters: 700, epoch: 6 | loss: 1.0838836
	speed: 0.0080s/iter; left time: 17.9725s
	iters: 800, epoch: 6 | loss: 0.3188227
	speed: 0.0080s/iter; left time: 17.0269s
	iters: 900, epoch: 6 | loss: 0.4306331
	speed: 0.0074s/iter; left time: 15.1444s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0030982356889, 'e_layers': 4, 'learning_rate': 0.0030793595896, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.002962158443836898
Validation loss decreased (inf --> 0.6431).  Saving model state dict ...
Epoch: 1 cost time: 1.2348973751068115
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6430602 Best vali loss: 0.6430602
Updating learning rate to 0.002628397818558992
Validation loss decreased (0.6431 --> 0.6304).  Saving model state dict ...
Epoch: 2 cost time: 0.7741222381591797
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6303552 Best vali loss: 0.6303552
Updating learning rate to 0.0021288897434172415
Validation loss decreased (0.6304 --> 0.6221).  Saving model state dict ...
Epoch: 3 cost time: 0.8781604766845703
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6221431 Best vali loss: 0.6221431
Updating learning rate to 0.0015396797948
Validation loss decreased (0.6221 --> 0.6218).  Saving model state dict ...
Epoch: 4 cost time: 0.7619590759277344
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6218139 Best vali loss: 0.6218139
Updating learning rate to 0.0009504698461827591
Validation loss decreased (0.6218 --> 0.6182).  Saving model state dict ...
Epoch: 5 cost time: 0.9250953197479248
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6182316 Best vali loss: 0.6182316
Updating learning rate to 0.0004509617710410081
Epoch: 6 cost time: 0.657637357711792
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6664237 Best vali loss: 0.6182316
Updating learning rate to 0.00011720114576310211
Epoch: 7 cost time: 0.7618598937988281
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6440736 Best vali loss: 0.6182316
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7734131813049316
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6443299 Best vali loss: 0.6182316

best validation loss 0.61823155556162

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0013703913795, 'e_layers': 3, 'learning_rate': 0.0008383415485, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7606614
	speed: 0.0141s/iter; left time: 26.1680s
	iters: 200, epoch: 1 | loss: 0.6893566
	speed: 0.0081s/iter; left time: 14.2979s
Updating learning rate to 0.0008064340732064841
Validation loss decreased (inf --> 0.6493).  Saving model state dict ...
Epoch: 1 cost time: 2.317532539367676
Epoch: 1, Steps: 245 | Train Loss: 0.7250090 Vali Loss: 0.6493221 Best vali loss: 0.6493221
	iters: 100, epoch: 2 | loss: 0.9720421
	speed: 0.0160s/iter; left time: 25.7772s
	iters: 200, epoch: 2 | loss: 1.0251384
	speed: 0.0079s/iter; left time: 11.9036s
Updating learning rate to 0.0007155692711973905
Validation loss decreased (0.6493 --> 0.6188).  Saving model state dict ...
Epoch: 2 cost time: 2.005033493041992
Epoch: 2, Steps: 245 | Train Loss: 0.9985903 Vali Loss: 0.6187666 Best vali loss: 0.6187666
	iters: 100, epoch: 3 | loss: 1.0089972
	speed: 0.0145s/iter; left time: 19.9057s
	iters: 200, epoch: 3 | loss: 0.9273067
	speed: 0.0072s/iter; left time: 9.2030s
Updating learning rate to 0.0005795804848871222
Epoch: 3 cost time: 1.9491310119628906
Epoch: 3, Steps: 245 | Train Loss: 0.9681519 Vali Loss: 0.6382602 Best vali loss: 0.6187666

best validation loss 0.6187665539999242

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0032013986518, 'e_layers': 1, 'learning_rate': 5.0701814e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.8772091107897105e-05
Validation loss decreased (inf --> 0.7101).  Saving model state dict ...
Epoch: 1 cost time: 0.8708884716033936
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7100596 Best vali loss: 0.7100596
Updating learning rate to 4.327670524892952e-05
Validation loss decreased (0.7101 --> 0.7035).  Saving model state dict ...
Epoch: 2 cost time: 0.4516162872314453
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.7035010 Best vali loss: 0.7035010
Updating learning rate to 3.5052279104328187e-05
Validation loss decreased (0.7035 --> 0.6981).  Saving model state dict ...
Epoch: 3 cost time: 0.46158814430236816
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6980578 Best vali loss: 0.6980578

best validation loss 0.6980577955804231

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012202100866, 'e_layers': 1, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8235579
	speed: 0.0107s/iter; left time: 9.4365s
Updating learning rate to 0.0005385115939239891
Validation loss decreased (inf --> 0.6271).  Saving model state dict ...
Epoch: 1 cost time: 0.8870449066162109
Epoch: 1, Steps: 123 | Train Loss: 0.8235579 Vali Loss: 0.6270555 Best vali loss: 0.6270555
	iters: 100, epoch: 2 | loss: 0.6905685
	speed: 0.0079s/iter; left time: 6.0138s
Updating learning rate to 0.0004778349050448276
Validation loss decreased (0.6271 --> 0.6071).  Saving model state dict ...
Epoch: 2 cost time: 0.619734525680542
Epoch: 2, Steps: 123 | Train Loss: 0.6905685 Vali Loss: 0.6070836 Best vali loss: 0.6070836
	iters: 100, epoch: 3 | loss: 0.8815676
	speed: 0.0080s/iter; left time: 5.0995s
Updating learning rate to 0.0003870258228088137
Validation loss decreased (0.6071 --> 0.6028).  Saving model state dict ...
Epoch: 3 cost time: 0.6176910400390625
Epoch: 3, Steps: 123 | Train Loss: 0.8815676 Vali Loss: 0.6027644 Best vali loss: 0.6027644

best validation loss 0.602764393018937

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012202100866, 'e_layers': 1, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7605984
	speed: 0.0111s/iter; left time: 5.7144s
Updating learning rate to 0.0002799092068
Validation loss decreased (0.6028 --> 0.6012).  Saving model state dict ...
Epoch: 4 cost time: 0.8978922367095947
Epoch: 4, Steps: 123 | Train Loss: 0.7605984 Vali Loss: 0.6012069 Best vali loss: 0.6012069
	iters: 100, epoch: 5 | loss: 0.6756630
	speed: 0.0081s/iter; left time: 3.2017s
Updating learning rate to 0.00017279259079118627
Validation loss decreased (0.6012 --> 0.6012).  Saving model state dict ...
Epoch: 5 cost time: 0.6470990180969238
Epoch: 5, Steps: 123 | Train Loss: 0.6756630 Vali Loss: 0.6012062 Best vali loss: 0.6012062
	iters: 100, epoch: 6 | loss: 0.8744135
	speed: 0.0082s/iter; left time: 2.2184s
Updating learning rate to 8.198350855517233e-05
Epoch: 6 cost time: 0.6188855171203613
Epoch: 6, Steps: 123 | Train Loss: 0.8744135 Vali Loss: 0.6026199 Best vali loss: 0.6012062
	iters: 100, epoch: 7 | loss: 0.8311304
	speed: 0.0079s/iter; left time: 1.1558s
Updating learning rate to 2.1306819676010916e-05
Epoch: 7 cost time: 0.5999503135681152
Epoch: 7, Steps: 123 | Train Loss: 0.8311304 Vali Loss: 0.6021824 Best vali loss: 0.6012062
	iters: 100, epoch: 8 | loss: 0.8826947
	speed: 0.0083s/iter; left time: 0.1989s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6369130611419678
Epoch: 8, Steps: 123 | Train Loss: 0.8826947 Vali Loss: 0.6022837 Best vali loss: 0.6012062

best validation loss 0.6012062262131737

[INFO][smbo.py:320] Finished 550 trials.
{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9704503
	speed: 0.0156s/iter; left time: 28.9828s
	iters: 200, epoch: 1 | loss: 0.9669419
	speed: 0.0091s/iter; left time: 15.9939s
Updating learning rate to 0.0006308326133
Validation loss decreased (inf --> 0.6055).  Saving model state dict ...
Epoch: 1 cost time: 2.607567310333252
Epoch: 1, Steps: 245 | Train Loss: 0.9686961 Vali Loss: 0.6054692 Best vali loss: 0.6054692
	iters: 100, epoch: 2 | loss: 0.8718266
	speed: 0.0174s/iter; left time: 28.0995s
	iters: 200, epoch: 2 | loss: 0.4535897
	speed: 0.0096s/iter; left time: 14.4907s
Updating learning rate to 0.00031541630665
Validation loss decreased (0.6055 --> 0.5987).  Saving model state dict ...
Epoch: 2 cost time: 2.3956642150878906
Epoch: 2, Steps: 245 | Train Loss: 0.6627081 Vali Loss: 0.5986905 Best vali loss: 0.5986905
	iters: 100, epoch: 3 | loss: 0.5335373
	speed: 0.0175s/iter; left time: 23.9269s
	iters: 200, epoch: 3 | loss: 0.9925751
	speed: 0.0093s/iter; left time: 11.7997s
Updating learning rate to 0.000157708153325
Epoch: 3 cost time: 2.346217393875122
Epoch: 3, Steps: 245 | Train Loss: 0.7630562 Vali Loss: 0.6033782 Best vali loss: 0.5986905
	iters: 100, epoch: 4 | loss: 0.5815644
	speed: 0.0178s/iter; left time: 20.0414s
	iters: 200, epoch: 4 | loss: 0.9651663
	speed: 0.0094s/iter; left time: 9.6644s
Updating learning rate to 7.88540766625e-05
Validation loss decreased (0.5987 --> 0.5773).  Saving model state dict ...
Epoch: 4 cost time: 2.413058042526245
Epoch: 4, Steps: 245 | Train Loss: 0.7733653 Vali Loss: 0.5773280 Best vali loss: 0.5773280
	iters: 100, epoch: 5 | loss: 0.4927733
	speed: 0.0166s/iter; left time: 14.5959s
	iters: 200, epoch: 5 | loss: 0.8053880
	speed: 0.0113s/iter; left time: 8.8265s
Updating learning rate to 3.942703833125e-05
Validation loss decreased (0.5773 --> 0.5661).  Saving model state dict ...
Epoch: 5 cost time: 2.5530264377593994
Epoch: 5, Steps: 245 | Train Loss: 0.6490806 Vali Loss: 0.5661457 Best vali loss: 0.5661457
	iters: 100, epoch: 6 | loss: 1.1498003
	speed: 0.0213s/iter; left time: 13.5563s
	iters: 200, epoch: 6 | loss: 0.5936978
	speed: 0.0112s/iter; left time: 5.9863s
Updating learning rate to 1.9713519165625e-05
Epoch: 6 cost time: 2.648253917694092
Epoch: 6, Steps: 245 | Train Loss: 0.8717490 Vali Loss: 0.5666879 Best vali loss: 0.5661457
	iters: 100, epoch: 7 | loss: 0.6563405
	speed: 0.0162s/iter; left time: 6.3470s
	iters: 200, epoch: 7 | loss: 0.6563124
	speed: 0.0094s/iter; left time: 2.7224s
Updating learning rate to 9.8567595828125e-06
Validation loss decreased (0.5661 --> 0.5645).  Saving model state dict ...
Epoch: 7 cost time: 2.286724090576172
Epoch: 7, Steps: 245 | Train Loss: 0.6563264 Vali Loss: 0.5645052 Best vali loss: 0.5645052
	iters: 100, epoch: 8 | loss: 0.7455512
	speed: 0.0179s/iter; left time: 2.6127s
	iters: 200, epoch: 8 | loss: 0.7683547
	speed: 0.0090s/iter; left time: 0.4161s
Updating learning rate to 4.92837979140625e-06
Validation loss decreased (0.5645 --> 0.5621).  Saving model state dict ...
Epoch: 8 cost time: 2.3567192554473877
Epoch: 8, Steps: 245 | Train Loss: 0.7569530 Vali Loss: 0.5621285 Best vali loss: 0.5621285

best validation loss 0.5621285200780985

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0084698317464, 'e_layers': 1, 'learning_rate': 0.0005923265018, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6567152
	speed: 0.0110s/iter; left time: 9.7421s
Updating learning rate to 0.0005923265018
Validation loss decreased (inf --> 0.6107).  Saving model state dict ...
Epoch: 1 cost time: 0.9295127391815186
Epoch: 1, Steps: 123 | Train Loss: 0.6567152 Vali Loss: 0.6107163 Best vali loss: 0.6107163
	iters: 100, epoch: 2 | loss: 0.6863008
	speed: 0.0079s/iter; left time: 5.9830s
Updating learning rate to 0.0002961632509
Validation loss decreased (0.6107 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 0.5816748142242432
Epoch: 2, Steps: 123 | Train Loss: 0.6863008 Vali Loss: 0.6036184 Best vali loss: 0.6036184
	iters: 100, epoch: 3 | loss: 0.7322829
	speed: 0.0086s/iter; left time: 5.5142s
Updating learning rate to 0.00014808162545
Validation loss decreased (0.6036 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 0.8060286045074463
Epoch: 3, Steps: 123 | Train Loss: 0.7322829 Vali Loss: 0.6031113 Best vali loss: 0.6031113
	iters: 100, epoch: 4 | loss: 0.8527554
	speed: 0.0137s/iter; left time: 7.0731s
Updating learning rate to 7.4040812725e-05
Validation loss decreased (0.6031 --> 0.6006).  Saving model state dict ...
Epoch: 4 cost time: 1.032810926437378
Epoch: 4, Steps: 123 | Train Loss: 0.8527554 Vali Loss: 0.6006216 Best vali loss: 0.6006216
	iters: 100, epoch: 5 | loss: 0.8693578
	speed: 0.0144s/iter; left time: 5.6755s
Updating learning rate to 3.70204063625e-05
Epoch: 5 cost time: 1.0122294425964355
Epoch: 5, Steps: 123 | Train Loss: 0.8693578 Vali Loss: 0.6036444 Best vali loss: 0.6006216
	iters: 100, epoch: 6 | loss: 0.8615746
	speed: 0.0134s/iter; left time: 3.6151s
Updating learning rate to 1.851020318125e-05
Epoch: 6 cost time: 1.0713214874267578
Epoch: 6, Steps: 123 | Train Loss: 0.8615746 Vali Loss: 0.6050165 Best vali loss: 0.6006216
	iters: 100, epoch: 7 | loss: 0.7726928
	speed: 0.0084s/iter; left time: 1.2355s
Updating learning rate to 9.255101590625e-06
Epoch: 7 cost time: 0.5979006290435791
Epoch: 7, Steps: 123 | Train Loss: 0.7726928 Vali Loss: 0.6058598 Best vali loss: 0.6006216
	iters: 100, epoch: 8 | loss: 0.6971503
	speed: 0.0130s/iter; left time: 0.3120s
Updating learning rate to 4.6275507953125e-06
Epoch: 8 cost time: 1.2260091304779053
Epoch: 8, Steps: 123 | Train Loss: 0.6971503 Vali Loss: 0.6059369 Best vali loss: 0.6006216

best validation loss 0.600621563011383

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023296914435, 'e_layers': 2, 'learning_rate': 0.004671208744, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7973856
	speed: 0.0153s/iter; left time: 13.5183s
Updating learning rate to 0.004671208744
Validation loss decreased (inf --> 0.6897).  Saving model state dict ...
Epoch: 1 cost time: 1.3511404991149902
Epoch: 1, Steps: 123 | Train Loss: 0.7973856 Vali Loss: 0.6896994 Best vali loss: 0.6896994
	iters: 100, epoch: 2 | loss: 0.9276663
	speed: 0.0118s/iter; left time: 8.9960s
Updating learning rate to 0.002335604372
Validation loss decreased (0.6897 --> 0.6239).  Saving model state dict ...
Epoch: 2 cost time: 1.029611587524414
Epoch: 2, Steps: 123 | Train Loss: 0.9276663 Vali Loss: 0.6238798 Best vali loss: 0.6238798
	iters: 100, epoch: 3 | loss: 1.1219716
	speed: 0.0146s/iter; left time: 9.3577s
Updating learning rate to 0.001167802186
Epoch: 3 cost time: 1.175934076309204
Epoch: 3, Steps: 123 | Train Loss: 1.1219716 Vali Loss: 0.6280205 Best vali loss: 0.6238798

best validation loss 0.623879848862621

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036401371545035456
Validation loss decreased (inf --> 0.6128).  Saving model state dict ...
Epoch: 1 cost time: 1.0243141651153564
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6127796 Best vali loss: 0.6127796
Updating learning rate to 0.00032299854101523116
Epoch: 2 cost time: 0.7788002490997314
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6286024 Best vali loss: 0.6127796
Updating learning rate to 0.00026161499459889523
Validation loss decreased (0.6128 --> 0.5622).  Saving model state dict ...
Epoch: 3 cost time: 0.7802309989929199
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5622271 Best vali loss: 0.5622271

best validation loss 0.562227088508094

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061646239199, 'e_layers': 2, 'learning_rate': 6.25759351e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3461450
	speed: 0.0121s/iter; left time: 93.6671s
	iters: 200, epoch: 1 | loss: 0.9590311
	speed: 0.0050s/iter; left time: 38.1790s
	iters: 300, epoch: 1 | loss: 0.8766127
	speed: 0.0049s/iter; left time: 36.7856s
	iters: 400, epoch: 1 | loss: 0.7459332
	speed: 0.0050s/iter; left time: 37.4067s
	iters: 500, epoch: 1 | loss: 0.5223416
	speed: 0.0051s/iter; left time: 37.6227s
	iters: 600, epoch: 1 | loss: 0.2486126
	speed: 0.0072s/iter; left time: 51.8897s
	iters: 700, epoch: 1 | loss: 0.9762930
	speed: 0.0077s/iter; left time: 54.9953s
	iters: 800, epoch: 1 | loss: 0.5000110
	speed: 0.0075s/iter; left time: 53.0679s
	iters: 900, epoch: 1 | loss: 0.3694907
	speed: 0.0076s/iter; left time: 52.7602s
Updating learning rate to 6.0194280383322307e-05
Validation loss decreased (inf --> 0.6051).  Saving model state dict ...
Epoch: 1 cost time: 6.5274364948272705
Epoch: 1, Steps: 979 | Train Loss: 0.6160523 Vali Loss: 0.6051417 Best vali loss: 0.6051417
	iters: 100, epoch: 2 | loss: 0.4167515
	speed: 0.0252s/iter; left time: 170.2649s
	iters: 200, epoch: 2 | loss: 0.6166466
	speed: 0.0072s/iter; left time: 47.7332s
	iters: 300, epoch: 2 | loss: 0.9027162
	speed: 0.0112s/iter; left time: 73.3317s
	iters: 400, epoch: 2 | loss: 0.6517369
	speed: 0.0092s/iter; left time: 59.2956s
	iters: 500, epoch: 2 | loss: 0.5070903
	speed: 0.0097s/iter; left time: 61.8192s
	iters: 600, epoch: 2 | loss: 0.9550265
	speed: 0.0109s/iter; left time: 68.1254s
	iters: 700, epoch: 2 | loss: 1.0352145
	speed: 0.0106s/iter; left time: 64.9867s
	iters: 800, epoch: 2 | loss: 0.8859813
	speed: 0.0106s/iter; left time: 64.2020s
	iters: 900, epoch: 2 | loss: 0.7048634
	speed: 0.0104s/iter; left time: 61.8243s
Updating learning rate to 5.341190157414965e-05
Validation loss decreased (0.6051 --> 0.5986).  Saving model state dict ...
Epoch: 2 cost time: 9.629197359085083
Epoch: 2, Steps: 979 | Train Loss: 0.7417808 Vali Loss: 0.5985838 Best vali loss: 0.5985838
	iters: 100, epoch: 3 | loss: 0.4775443
	speed: 0.0493s/iter; left time: 284.8069s
	iters: 200, epoch: 3 | loss: 0.6754708
	speed: 0.0075s/iter; left time: 42.3142s
	iters: 300, epoch: 3 | loss: 0.6799974
	speed: 0.0076s/iter; left time: 42.3070s
	iters: 400, epoch: 3 | loss: 1.1951375
	speed: 0.0075s/iter; left time: 40.8583s
	iters: 500, epoch: 3 | loss: 0.3672308
	speed: 0.0077s/iter; left time: 41.6291s
	iters: 600, epoch: 3 | loss: 0.6397506
	speed: 0.0079s/iter; left time: 41.6561s
	iters: 700, epoch: 3 | loss: 1.3150907
	speed: 0.0074s/iter; left time: 38.3781s
	iters: 800, epoch: 3 | loss: 0.6415100
	speed: 0.0086s/iter; left time: 43.6781s
	iters: 900, epoch: 3 | loss: 0.6547037
	speed: 0.0082s/iter; left time: 40.8216s
Updating learning rate to 4.326135436376155e-05
Validation loss decreased (0.5986 --> 0.5847).  Saving model state dict ...
Epoch: 3 cost time: 7.652557373046875
Epoch: 3, Steps: 979 | Train Loss: 0.7384929 Vali Loss: 0.5847345 Best vali loss: 0.5847345

best validation loss 0.584734504005524

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001892081647
Epoch: 4 cost time: 0.9768245220184326
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5630374 Best vali loss: 0.5622271
Updating learning rate to 0.0001168013348011048
Validation loss decreased (0.5622 --> 0.5553).  Saving model state dict ...
Epoch: 5 cost time: 0.7869875431060791
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5552766 Best vali loss: 0.5552766
Updating learning rate to 5.541778838476887e-05
Epoch: 6 cost time: 0.9613714218139648
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5562622 Best vali loss: 0.5552766
Updating learning rate to 1.4402613949645455e-05
Epoch: 7 cost time: 0.9104046821594238
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5579338 Best vali loss: 0.5552766
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8642377853393555
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5561886 Best vali loss: 0.5552766

best validation loss 0.5552766468998239

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0018990416299, 'e_layers': 3, 'learning_rate': 0.000236713365, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1213568
	speed: 0.0200s/iter; left time: 154.5771s
	iters: 200, epoch: 1 | loss: 0.4916130
	speed: 0.0113s/iter; left time: 85.9588s
	iters: 300, epoch: 1 | loss: 0.5312343
	speed: 0.0107s/iter; left time: 80.3146s
	iters: 400, epoch: 1 | loss: 0.6390701
	speed: 0.0105s/iter; left time: 77.9043s
	iters: 500, epoch: 1 | loss: 0.2973438
	speed: 0.0106s/iter; left time: 78.0084s
	iters: 600, epoch: 1 | loss: 0.3453605
	speed: 0.0109s/iter; left time: 78.5917s
	iters: 700, epoch: 1 | loss: 0.3308619
	speed: 0.0110s/iter; left time: 78.5913s
	iters: 800, epoch: 1 | loss: 0.7312157
	speed: 0.0117s/iter; left time: 82.2582s
	iters: 900, epoch: 1 | loss: 0.9717808
	speed: 0.0122s/iter; left time: 84.8914s
Updating learning rate to 0.000236713365
Validation loss decreased (inf --> 0.6098).  Saving model state dict ...
Epoch: 1 cost time: 11.473525285720825
Epoch: 1, Steps: 979 | Train Loss: 0.6066486 Vali Loss: 0.6097890 Best vali loss: 0.6097890
	iters: 100, epoch: 2 | loss: 0.2559350
	speed: 0.0431s/iter; left time: 290.7693s
	iters: 200, epoch: 2 | loss: 0.3299792
	speed: 0.0107s/iter; left time: 71.1326s
	iters: 300, epoch: 2 | loss: 1.4531677
	speed: 0.0105s/iter; left time: 68.9838s
	iters: 400, epoch: 2 | loss: 1.2708386
	speed: 0.0131s/iter; left time: 84.6844s
	iters: 500, epoch: 2 | loss: 0.8155023
	speed: 0.0123s/iter; left time: 78.3816s
	iters: 600, epoch: 2 | loss: 1.1643236
	speed: 0.0108s/iter; left time: 67.2653s
	iters: 700, epoch: 2 | loss: 2.5721049
	speed: 0.0113s/iter; left time: 69.5672s
	iters: 800, epoch: 2 | loss: 0.3185461
	speed: 0.0112s/iter; left time: 67.8698s
	iters: 900, epoch: 2 | loss: 0.7909412
	speed: 0.0102s/iter; left time: 60.6081s
Updating learning rate to 0.0001183566825
Epoch: 2 cost time: 11.054430723190308
Epoch: 2, Steps: 979 | Train Loss: 0.9968154 Vali Loss: 0.6147206 Best vali loss: 0.6097890
	iters: 100, epoch: 3 | loss: 0.6739864
	speed: 0.0538s/iter; left time: 310.5921s
	iters: 200, epoch: 3 | loss: 1.7503271
	speed: 0.0095s/iter; left time: 53.7220s
	iters: 300, epoch: 3 | loss: 0.8017583
	speed: 0.0099s/iter; left time: 55.1885s
	iters: 400, epoch: 3 | loss: 0.8525134
	speed: 0.0094s/iter; left time: 51.6602s
	iters: 500, epoch: 3 | loss: 0.5481639
	speed: 0.0070s/iter; left time: 37.4138s
	iters: 600, epoch: 3 | loss: 0.7556369
	speed: 0.0088s/iter; left time: 46.2606s
	iters: 700, epoch: 3 | loss: 1.0337021
	speed: 0.0094s/iter; left time: 48.4118s
	iters: 800, epoch: 3 | loss: 1.2305176
	speed: 0.0092s/iter; left time: 46.7941s
	iters: 900, epoch: 3 | loss: 0.7782789
	speed: 0.0096s/iter; left time: 47.8669s
Updating learning rate to 5.917834125e-05
Epoch: 3 cost time: 8.926234483718872
Epoch: 3, Steps: 979 | Train Loss: 0.9360983 Vali Loss: 0.6111978 Best vali loss: 0.6097890
	iters: 100, epoch: 4 | loss: 1.8631315
	speed: 0.0291s/iter; left time: 139.3423s
	iters: 200, epoch: 4 | loss: 0.8472730
	speed: 0.0091s/iter; left time: 42.5296s
	iters: 300, epoch: 4 | loss: 0.6324338
	speed: 0.0093s/iter; left time: 42.9123s
	iters: 400, epoch: 4 | loss: 0.7530650
	speed: 0.0084s/iter; left time: 37.5458s
	iters: 500, epoch: 4 | loss: 0.7508559
	speed: 0.0055s/iter; left time: 24.0957s
	iters: 600, epoch: 4 | loss: 0.5530591
	speed: 0.0102s/iter; left time: 44.0253s
	iters: 700, epoch: 4 | loss: 0.5680776
	speed: 0.0126s/iter; left time: 52.7440s
	iters: 800, epoch: 4 | loss: 0.5887511
	speed: 0.0127s/iter; left time: 52.1328s
	iters: 900, epoch: 4 | loss: 1.1927121
	speed: 0.0117s/iter; left time: 46.9472s
Updating learning rate to 2.9589170625e-05
Epoch: 4 cost time: 9.411602258682251
Epoch: 4, Steps: 979 | Train Loss: 0.8610399 Vali Loss: 0.6164433 Best vali loss: 0.6097890
	iters: 100, epoch: 5 | loss: 1.1251018
	speed: 0.0265s/iter; left time: 101.0863s
	iters: 200, epoch: 5 | loss: 1.3923750
	speed: 0.0089s/iter; left time: 33.2654s
	iters: 300, epoch: 5 | loss: 0.8289136
	speed: 0.0093s/iter; left time: 33.7994s
	iters: 400, epoch: 5 | loss: 0.8702120
	speed: 0.0094s/iter; left time: 33.0457s
	iters: 500, epoch: 5 | loss: 0.8623634
	speed: 0.0096s/iter; left time: 32.6737s
	iters: 600, epoch: 5 | loss: 1.1815194
	speed: 0.0089s/iter; left time: 29.4582s
	iters: 700, epoch: 5 | loss: 0.8084816
	speed: 0.0092s/iter; left time: 29.7442s
	iters: 800, epoch: 5 | loss: 0.8072944
	speed: 0.0094s/iter; left time: 29.2241s
	iters: 900, epoch: 5 | loss: 1.0727630
	speed: 0.0091s/iter; left time: 27.3912s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0047486145421, 'e_layers': 3, 'learning_rate': 0.0019208975706, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9881678
	speed: 0.0195s/iter; left time: 17.2989s
Updating learning rate to 0.0019208975706
Validation loss decreased (inf --> 0.6084).  Saving model state dict ...
Epoch: 1 cost time: 1.91709566116333
Epoch: 1, Steps: 123 | Train Loss: 0.9881678 Vali Loss: 0.6084448 Best vali loss: 0.6084448
	iters: 100, epoch: 2 | loss: 1.0429188
	speed: 0.0187s/iter; left time: 14.2779s
Updating learning rate to 0.0009604487853
Epoch: 2 cost time: 1.632751703262329
Epoch: 2, Steps: 123 | Train Loss: 1.0429188 Vali Loss: 0.6104810 Best vali loss: 0.6084448
	iters: 100, epoch: 3 | loss: 0.8195575
	speed: 0.0169s/iter; left time: 10.7818s
Updating learning rate to 0.00048022439265
Epoch: 3 cost time: 1.2520315647125244
Epoch: 3, Steps: 123 | Train Loss: 0.8195575 Vali Loss: 0.6309007 Best vali loss: 0.6084448
	iters: 100, epoch: 4 | loss: 0.9299233
	speed: 0.0126s/iter; left time: 6.5141s
Updating learning rate to 0.000240112196325
Epoch: 4 cost time: 1.0005812644958496
Epoch: 4, Steps: 123 | Train Loss: 0.9299233 Vali Loss: 0.6225261 Best vali loss: 0.6084448
	iters: 100, epoch: 5 | loss: 0.6584260
	speed: 0.0124s/iter; left time: 4.8873s
Updating learning rate to 0.0001200560981625
Epoch: 5 cost time: 1.0655546188354492
Epoch: 5, Steps: 123 | Train Loss: 0.6584260 Vali Loss: 0.6211720 Best vali loss: 0.6084448
	iters: 100, epoch: 6 | loss: 0.7166344
	speed: 0.0130s/iter; left time: 3.5188s
Updating learning rate to 6.002804908125e-05
Epoch: 6 cost time: 1.0721771717071533
Epoch: 6, Steps: 123 | Train Loss: 0.7166344 Vali Loss: 0.6249526 Best vali loss: 0.6084448
	iters: 100, epoch: 7 | loss: 0.7194945
	speed: 0.0127s/iter; left time: 1.8657s
Updating learning rate to 3.0014024540625e-05
Epoch: 7 cost time: 1.0853891372680664
Epoch: 7, Steps: 123 | Train Loss: 0.7194945 Vali Loss: 0.6279591 Best vali loss: 0.6084448
	iters: 100, epoch: 8 | loss: 0.8281803
	speed: 0.0119s/iter; left time: 0.2859s
Updating learning rate to 1.50070122703125e-05
Epoch: 8 cost time: 0.9823634624481201
Epoch: 8, Steps: 123 | Train Loss: 0.8281803 Vali Loss: 0.6290907 Best vali loss: 0.6084448

best validation loss 0.6084448298002382

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022180841037, 'e_layers': 4, 'learning_rate': 0.0009753388759, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8382940
	speed: 0.0178s/iter; left time: 33.1836s
	iters: 200, epoch: 1 | loss: 0.9290875
	speed: 0.0110s/iter; left time: 19.4244s
Updating learning rate to 0.0009753388759
Validation loss decreased (inf --> 0.6213).  Saving model state dict ...
Epoch: 1 cost time: 3.1061477661132812
Epoch: 1, Steps: 245 | Train Loss: 0.8836908 Vali Loss: 0.6213219 Best vali loss: 0.6213219
	iters: 100, epoch: 2 | loss: 1.2940006
	speed: 0.0184s/iter; left time: 29.7288s
	iters: 200, epoch: 2 | loss: 0.9502219
	speed: 0.0080s/iter; left time: 12.1975s
Updating learning rate to 0.00048766943795
Epoch: 2 cost time: 2.2794029712677
Epoch: 2, Steps: 245 | Train Loss: 1.1221113 Vali Loss: 0.6324442 Best vali loss: 0.6213219
	iters: 100, epoch: 3 | loss: 0.8312263
	speed: 0.0241s/iter; left time: 33.1006s
	iters: 200, epoch: 3 | loss: 0.8277075
	speed: 0.0131s/iter; left time: 16.7033s
Updating learning rate to 0.000243834718975
Epoch: 3 cost time: 3.191246271133423
Epoch: 3, Steps: 245 | Train Loss: 0.8294669 Vali Loss: 0.6596005 Best vali loss: 0.6213219

best validation loss 0.6213219075057309

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0011769656897, 'e_layers': 3, 'learning_rate': 8.6782891e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.347991388352898e-05
Validation loss decreased (inf --> 0.7002).  Saving model state dict ...
Epoch: 1 cost time: 0.8035340309143066
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7002419 Best vali loss: 0.7002419
Updating learning rate to 7.40738308585365e-05
Validation loss decreased (0.7002 --> 0.6874).  Saving model state dict ...
Epoch: 2 cost time: 0.5803489685058594
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6874030 Best vali loss: 0.6874030
Updating learning rate to 5.999663279922273e-05
Validation loss decreased (0.6874 --> 0.6771).  Saving model state dict ...
Epoch: 3 cost time: 0.5912332534790039
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6770725 Best vali loss: 0.6770725

best validation loss 0.6770724870716185

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.006224374191, 'e_layers': 1, 'learning_rate': 0.0004730775791, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8649619
	speed: 0.0107s/iter; left time: 9.4548s
Updating learning rate to 0.00045507213586023967
Validation loss decreased (inf --> 0.6295).  Saving model state dict ...
Epoch: 1 cost time: 0.885845422744751
Epoch: 1, Steps: 123 | Train Loss: 0.8649619 Vali Loss: 0.6294627 Best vali loss: 0.6294627
	iters: 100, epoch: 2 | loss: 0.9806986
	speed: 0.0081s/iter; left time: 6.1587s
Updating learning rate to 0.00040379697165446267
Validation loss decreased (0.6295 --> 0.6128).  Saving model state dict ...
Epoch: 2 cost time: 0.6297886371612549
Epoch: 2, Steps: 123 | Train Loss: 0.9806986 Vali Loss: 0.6128108 Best vali loss: 0.6128108
	iters: 100, epoch: 3 | loss: 0.6239246
	speed: 0.0079s/iter; left time: 5.0653s
Updating learning rate to 0.00032705826542247764
Validation loss decreased (0.6128 --> 0.6075).  Saving model state dict ...
Epoch: 3 cost time: 0.609379768371582
Epoch: 3, Steps: 123 | Train Loss: 0.6239246 Vali Loss: 0.6074634 Best vali loss: 0.6074634

best validation loss 0.6074634395998311

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.006224374191, 'e_layers': 1, 'learning_rate': 0.0004730775791, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8277127
	speed: 0.0146s/iter; left time: 7.5555s
Updating learning rate to 0.00023653878955
Validation loss decreased (0.6075 --> 0.5984).  Saving model state dict ...
Epoch: 4 cost time: 1.317403793334961
Epoch: 4, Steps: 123 | Train Loss: 0.8277127 Vali Loss: 0.5983988 Best vali loss: 0.5983988
	iters: 100, epoch: 5 | loss: 0.9407951
	speed: 0.0138s/iter; left time: 5.4381s
Updating learning rate to 0.00014601931367752238
Epoch: 5 cost time: 1.1406035423278809
Epoch: 5, Steps: 123 | Train Loss: 0.9407951 Vali Loss: 0.5990176 Best vali loss: 0.5983988
	iters: 100, epoch: 6 | loss: 0.6363447
	speed: 0.0131s/iter; left time: 3.5411s
Updating learning rate to 6.928060744553735e-05
Epoch: 6 cost time: 1.040572166442871
Epoch: 6, Steps: 123 | Train Loss: 0.6363447 Vali Loss: 0.6015899 Best vali loss: 0.5983988
	iters: 100, epoch: 7 | loss: 0.8321757
	speed: 0.0136s/iter; left time: 2.0065s
Updating learning rate to 1.8005443239760363e-05
Validation loss decreased (0.5984 --> 0.5975).  Saving model state dict ...
Epoch: 7 cost time: 1.0633625984191895
Epoch: 7, Steps: 123 | Train Loss: 0.8321757 Vali Loss: 0.5975496 Best vali loss: 0.5975496
	iters: 100, epoch: 8 | loss: 0.7941796
	speed: 0.0121s/iter; left time: 0.2902s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0031452178955078
Epoch: 8, Steps: 123 | Train Loss: 0.7941796 Vali Loss: 0.5985459 Best vali loss: 0.5975496

best validation loss 0.597549573324831

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.004626087804, 'e_layers': 2, 'learning_rate': 0.0002001097151, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7243567
	speed: 0.0142s/iter; left time: 12.5408s
Updating learning rate to 0.0002001097151
Validation loss decreased (inf --> 0.5927).  Saving model state dict ...
Epoch: 1 cost time: 1.348280429840088
Epoch: 1, Steps: 123 | Train Loss: 0.7243567 Vali Loss: 0.5927232 Best vali loss: 0.5927232
	iters: 100, epoch: 2 | loss: 0.7729511
	speed: 0.0175s/iter; left time: 13.3550s
Updating learning rate to 0.00010005485755
Validation loss decreased (0.5927 --> 0.5837).  Saving model state dict ...
Epoch: 2 cost time: 1.375781774520874
Epoch: 2, Steps: 123 | Train Loss: 0.7729511 Vali Loss: 0.5836562 Best vali loss: 0.5836562
	iters: 100, epoch: 3 | loss: 0.7364401
	speed: 0.0188s/iter; left time: 12.0440s
Updating learning rate to 5.0027428775e-05
Validation loss decreased (0.5837 --> 0.5612).  Saving model state dict ...
Epoch: 3 cost time: 1.5077741146087646
Epoch: 3, Steps: 123 | Train Loss: 0.7364401 Vali Loss: 0.5611609 Best vali loss: 0.5611609
	iters: 100, epoch: 4 | loss: 0.6591179
	speed: 0.0189s/iter; left time: 9.7545s
Updating learning rate to 2.50137143875e-05
Validation loss decreased (0.5612 --> 0.5573).  Saving model state dict ...
Epoch: 4 cost time: 1.4204835891723633
Epoch: 4, Steps: 123 | Train Loss: 0.6591179 Vali Loss: 0.5572635 Best vali loss: 0.5572635
	iters: 100, epoch: 5 | loss: 0.7175481
	speed: 0.0125s/iter; left time: 4.9058s
Updating learning rate to 1.250685719375e-05
Epoch: 5 cost time: 0.9707455635070801
Epoch: 5, Steps: 123 | Train Loss: 0.7175481 Vali Loss: 0.5580389 Best vali loss: 0.5572635
	iters: 100, epoch: 6 | loss: 0.6903996
	speed: 0.0125s/iter; left time: 3.3695s
Updating learning rate to 6.253428596875e-06
Epoch: 6 cost time: 1.0347821712493896
Epoch: 6, Steps: 123 | Train Loss: 0.6903996 Vali Loss: 0.5573115 Best vali loss: 0.5572635
	iters: 100, epoch: 7 | loss: 0.7128534
	speed: 0.0125s/iter; left time: 1.8331s
Updating learning rate to 3.1267142984375e-06
Validation loss decreased (0.5573 --> 0.5565).  Saving model state dict ...
Epoch: 7 cost time: 1.0384423732757568
Epoch: 7, Steps: 123 | Train Loss: 0.7128534 Vali Loss: 0.5565111 Best vali loss: 0.5565111
	iters: 100, epoch: 8 | loss: 0.6795420
	speed: 0.0126s/iter; left time: 0.3015s
Updating learning rate to 1.56335714921875e-06
Validation loss decreased (0.5565 --> 0.5556).  Saving model state dict ...
Epoch: 8 cost time: 1.0189039707183838
Epoch: 8, Steps: 123 | Train Loss: 0.6795420 Vali Loss: 0.5555805 Best vali loss: 0.5555805

best validation loss 0.5555805342719269

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0033708130675, 'e_layers': 2, 'learning_rate': 8.41453631e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4938914
	speed: 0.0122s/iter; left time: 94.2987s
	iters: 200, epoch: 1 | loss: 1.0037655
	speed: 0.0064s/iter; left time: 48.7740s
	iters: 300, epoch: 1 | loss: 0.8399034
	speed: 0.0060s/iter; left time: 45.0530s
	iters: 400, epoch: 1 | loss: 0.8119612
	speed: 0.0057s/iter; left time: 42.0786s
	iters: 500, epoch: 1 | loss: 0.2740498
	speed: 0.0062s/iter; left time: 45.2418s
	iters: 600, epoch: 1 | loss: 0.9033332
	speed: 0.0058s/iter; left time: 42.2538s
	iters: 700, epoch: 1 | loss: 0.7732428
	speed: 0.0066s/iter; left time: 46.8017s
	iters: 800, epoch: 1 | loss: 0.9983373
	speed: 0.0058s/iter; left time: 40.9666s
	iters: 900, epoch: 1 | loss: 0.5864546
	speed: 0.0065s/iter; left time: 44.9463s
Updating learning rate to 8.094277091191025e-05
Validation loss decreased (inf --> 0.6266).  Saving model state dict ...
Epoch: 1 cost time: 6.3144824504852295
Epoch: 1, Steps: 979 | Train Loss: 0.7427710 Vali Loss: 0.6265632 Best vali loss: 0.6265632
	iters: 100, epoch: 2 | loss: 0.7308750
	speed: 0.0206s/iter; left time: 139.2095s
	iters: 200, epoch: 2 | loss: 0.9290938
	speed: 0.0051s/iter; left time: 34.1339s
	iters: 300, epoch: 2 | loss: 0.9998075
	speed: 0.0054s/iter; left time: 35.0770s
	iters: 400, epoch: 2 | loss: 1.1268464
	speed: 0.0062s/iter; left time: 39.8051s
	iters: 500, epoch: 2 | loss: 1.3941623
	speed: 0.0079s/iter; left time: 50.2558s
	iters: 600, epoch: 2 | loss: 1.6018453
	speed: 0.0081s/iter; left time: 50.5885s
	iters: 700, epoch: 2 | loss: 0.4289862
	speed: 0.0078s/iter; left time: 48.2760s
	iters: 800, epoch: 2 | loss: 1.0151896
	speed: 0.0079s/iter; left time: 48.1243s
	iters: 900, epoch: 2 | loss: 0.3030755
	speed: 0.0079s/iter; left time: 46.9542s
Updating learning rate to 7.182255997670715e-05
Validation loss decreased (0.6266 --> 0.6096).  Saving model state dict ...
Epoch: 2 cost time: 6.8484063148498535
Epoch: 2, Steps: 979 | Train Loss: 0.9477646 Vali Loss: 0.6095876 Best vali loss: 0.6095876
	iters: 100, epoch: 3 | loss: 0.7372100
	speed: 0.0268s/iter; left time: 154.8723s
	iters: 200, epoch: 3 | loss: 1.0290109
	speed: 0.0091s/iter; left time: 51.7732s
	iters: 300, epoch: 3 | loss: 0.6782888
	speed: 0.0104s/iter; left time: 58.0843s
	iters: 400, epoch: 3 | loss: 0.5951928
	speed: 0.0091s/iter; left time: 49.7932s
	iters: 500, epoch: 3 | loss: 0.9405988
	speed: 0.0095s/iter; left time: 50.9524s
	iters: 600, epoch: 3 | loss: 0.4126744
	speed: 0.0099s/iter; left time: 52.2672s
	iters: 700, epoch: 3 | loss: 0.7296830
	speed: 0.0111s/iter; left time: 57.5046s
	iters: 800, epoch: 3 | loss: 0.6419308
	speed: 0.0094s/iter; left time: 47.8350s
	iters: 900, epoch: 3 | loss: 0.5509579
	speed: 0.0094s/iter; left time: 46.9498s
Updating learning rate to 5.817319973435739e-05
Validation loss decreased (0.6096 --> 0.5982).  Saving model state dict ...
Epoch: 3 cost time: 9.385751008987427
Epoch: 3, Steps: 979 | Train Loss: 0.7017275 Vali Loss: 0.5981861 Best vali loss: 0.5981861
	iters: 100, epoch: 4 | loss: 0.5561426
	speed: 0.0382s/iter; left time: 183.1137s
	iters: 200, epoch: 4 | loss: 0.8363665
	speed: 0.0079s/iter; left time: 37.1730s
	iters: 300, epoch: 4 | loss: 1.9395047
	speed: 0.0055s/iter; left time: 25.3376s
	iters: 400, epoch: 4 | loss: 0.2680117
	speed: 0.0052s/iter; left time: 23.5384s
	iters: 500, epoch: 4 | loss: 1.2526026
	speed: 0.0055s/iter; left time: 24.0203s
	iters: 600, epoch: 4 | loss: 1.0537717
	speed: 0.0050s/iter; left time: 21.6377s
	iters: 700, epoch: 4 | loss: 1.0003856
	speed: 0.0052s/iter; left time: 21.8979s
	iters: 800, epoch: 4 | loss: 1.0160789
	speed: 0.0083s/iter; left time: 33.8038s
	iters: 900, epoch: 4 | loss: 1.8271446
	speed: 0.0084s/iter; left time: 33.5932s
Updating learning rate to 4.207268155e-05
Epoch: 4 cost time: 6.587680101394653
Epoch: 4, Steps: 979 | Train Loss: 1.0833343 Vali Loss: 0.5997205 Best vali loss: 0.5981861
	iters: 100, epoch: 5 | loss: 1.1390157
	speed: 0.0285s/iter; left time: 108.8073s
	iters: 200, epoch: 5 | loss: 1.6410201
	speed: 0.0084s/iter; left time: 31.3742s
	iters: 300, epoch: 5 | loss: 0.5817462
	speed: 0.0080s/iter; left time: 29.0564s
	iters: 400, epoch: 5 | loss: 0.4115508
	speed: 0.0085s/iter; left time: 30.0643s
	iters: 500, epoch: 5 | loss: 1.4377476
	speed: 0.0084s/iter; left time: 28.8433s
	iters: 600, epoch: 5 | loss: 0.9300805
	speed: 0.0080s/iter; left time: 26.6492s
	iters: 700, epoch: 5 | loss: 1.2292731
	speed: 0.0045s/iter; left time: 14.3550s
	iters: 800, epoch: 5 | loss: 0.9286843
	speed: 0.0047s/iter; left time: 14.5476s
	iters: 900, epoch: 5 | loss: 0.6198748
	speed: 0.0070s/iter; left time: 21.2585s
Updating learning rate to 2.597216336564262e-05
Epoch: 5 cost time: 7.2736921310424805
Epoch: 5, Steps: 979 | Train Loss: 0.9909992 Vali Loss: 0.6050876 Best vali loss: 0.5981861
	iters: 100, epoch: 6 | loss: 0.5682245
	speed: 0.0243s/iter; left time: 69.0121s
	iters: 200, epoch: 6 | loss: 0.6324483
	speed: 0.0052s/iter; left time: 14.2225s
	iters: 300, epoch: 6 | loss: 0.4736212
	speed: 0.0078s/iter; left time: 20.4673s
	iters: 400, epoch: 6 | loss: 0.9049942
	speed: 0.0071s/iter; left time: 17.9380s
	iters: 500, epoch: 6 | loss: 0.8648976
	speed: 0.0078s/iter; left time: 19.0515s
	iters: 600, epoch: 6 | loss: 0.5285839
	speed: 0.0080s/iter; left time: 18.6433s
	iters: 700, epoch: 6 | loss: 0.5471887
	speed: 0.0068s/iter; left time: 15.2717s
	iters: 800, epoch: 6 | loss: 1.1069689
	speed: 0.0112s/iter; left time: 23.9157s
	iters: 900, epoch: 6 | loss: 0.4573956
	speed: 0.0123s/iter; left time: 25.1234s
Updating learning rate to 1.2322803123292859e-05
Epoch: 6 cost time: 8.113359928131104
Epoch: 6, Steps: 979 | Train Loss: 0.6760359 Vali Loss: 0.6062534 Best vali loss: 0.5981861
	iters: 100, epoch: 7 | loss: 1.4637219
	speed: 0.0452s/iter; left time: 84.0686s
	iters: 200, epoch: 7 | loss: 0.6317280
	speed: 0.0077s/iter; left time: 13.5216s
	iters: 300, epoch: 7 | loss: 0.4399893
	speed: 0.0076s/iter; left time: 12.6449s
	iters: 400, epoch: 7 | loss: 0.7721331
	speed: 0.0082s/iter; left time: 12.7882s
	iters: 500, epoch: 7 | loss: 0.7861864
	speed: 0.0061s/iter; left time: 8.8796s
	iters: 600, epoch: 7 | loss: 0.6385385
	speed: 0.0049s/iter; left time: 6.6737s
	iters: 700, epoch: 7 | loss: 0.3016494
	speed: 0.0068s/iter; left time: 8.6211s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022002628646, 'e_layers': 2, 'learning_rate': 5.31978674e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9751216
	speed: 0.0242s/iter; left time: 21.4598s
Updating learning rate to 5.31978674e-05
Validation loss decreased (inf --> 0.6327).  Saving model state dict ...
Epoch: 1 cost time: 2.399232864379883
Epoch: 1, Steps: 123 | Train Loss: 0.9751216 Vali Loss: 0.6326550 Best vali loss: 0.6326550
	iters: 100, epoch: 2 | loss: 1.0401968
	speed: 0.0322s/iter; left time: 24.5443s
Updating learning rate to 2.65989337e-05
Validation loss decreased (0.6327 --> 0.6086).  Saving model state dict ...
Epoch: 2 cost time: 2.6272354125976562
Epoch: 2, Steps: 123 | Train Loss: 1.0401968 Vali Loss: 0.6086437 Best vali loss: 0.6086437
	iters: 100, epoch: 3 | loss: 0.7707512
	speed: 0.0537s/iter; left time: 34.3295s
Updating learning rate to 1.329946685e-05
Validation loss decreased (0.6086 --> 0.6067).  Saving model state dict ...
Epoch: 3 cost time: 3.7863121032714844
Epoch: 3, Steps: 123 | Train Loss: 0.7707512 Vali Loss: 0.6067350 Best vali loss: 0.6067350

best validation loss 0.6067350441689074

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083508181889, 'e_layers': 2, 'learning_rate': 0.001131171897, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6868578
	speed: 0.0237s/iter; left time: 20.9952s
Updating learning rate to 0.001131171897
Validation loss decreased (inf --> 0.6379).  Saving model state dict ...
Epoch: 1 cost time: 2.340496301651001
Epoch: 1, Steps: 123 | Train Loss: 0.6868578 Vali Loss: 0.6378532 Best vali loss: 0.6378532
	iters: 100, epoch: 2 | loss: 0.7658126
	speed: 0.0283s/iter; left time: 21.5754s
Updating learning rate to 0.0005655859485
Epoch: 2 cost time: 2.2060744762420654
Epoch: 2, Steps: 123 | Train Loss: 0.7658126 Vali Loss: 0.6526140 Best vali loss: 0.6378532
	iters: 100, epoch: 3 | loss: 1.1527548
	speed: 0.0147s/iter; left time: 9.3983s
Updating learning rate to 0.00028279297425
Validation loss decreased (0.6379 --> 0.6314).  Saving model state dict ...
Epoch: 3 cost time: 1.1951243877410889
Epoch: 3, Steps: 123 | Train Loss: 1.1527548 Vali Loss: 0.6314330 Best vali loss: 0.6314330

best validation loss 0.6314330169416478

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020630177486, 'e_layers': 4, 'learning_rate': 9.2920321e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6978076
	speed: 0.0178s/iter; left time: 33.2047s
	iters: 200, epoch: 1 | loss: 1.2515975
	speed: 0.0104s/iter; left time: 18.2854s
Updating learning rate to 9.2920321e-05
Validation loss decreased (inf --> 0.6139).  Saving model state dict ...
Epoch: 1 cost time: 3.084057331085205
Epoch: 1, Steps: 245 | Train Loss: 0.9747026 Vali Loss: 0.6139267 Best vali loss: 0.6139267
	iters: 100, epoch: 2 | loss: 0.8733317
	speed: 0.0215s/iter; left time: 34.7971s
	iters: 200, epoch: 2 | loss: 0.7795740
	speed: 0.0106s/iter; left time: 16.0348s
Updating learning rate to 4.64601605e-05
Validation loss decreased (0.6139 --> 0.6077).  Saving model state dict ...
Epoch: 2 cost time: 2.7418928146362305
Epoch: 2, Steps: 245 | Train Loss: 0.8264529 Vali Loss: 0.6076908 Best vali loss: 0.6076908
	iters: 100, epoch: 3 | loss: 0.6057789
	speed: 0.0212s/iter; left time: 29.0355s
	iters: 200, epoch: 3 | loss: 0.8243568
	speed: 0.0104s/iter; left time: 13.2355s
Updating learning rate to 2.323008025e-05
Validation loss decreased (0.6077 --> 0.5974).  Saving model state dict ...
Epoch: 3 cost time: 2.592113494873047
Epoch: 3, Steps: 245 | Train Loss: 0.7150679 Vali Loss: 0.5973801 Best vali loss: 0.5973801

best validation loss 0.5973800663206655

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020630177486, 'e_layers': 4, 'learning_rate': 9.2920321e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6340066
	speed: 0.0190s/iter; left time: 21.3684s
	iters: 200, epoch: 4 | loss: 1.1605457
	speed: 0.0109s/iter; left time: 11.1401s
Updating learning rate to 1.1615040125e-05
Epoch: 4 cost time: 3.031726360321045
Epoch: 4, Steps: 245 | Train Loss: 0.8972761 Vali Loss: 0.5974480 Best vali loss: 0.5973801
	iters: 100, epoch: 5 | loss: 0.8219199
	speed: 0.0228s/iter; left time: 20.0681s
	iters: 200, epoch: 5 | loss: 0.7753543
	speed: 0.0112s/iter; left time: 8.7339s
Updating learning rate to 5.8075200625e-06
Epoch: 5 cost time: 2.8602776527404785
Epoch: 5, Steps: 245 | Train Loss: 0.7986371 Vali Loss: 0.6008259 Best vali loss: 0.5973801
	iters: 100, epoch: 6 | loss: 0.5895507
	speed: 0.0227s/iter; left time: 14.4264s
	iters: 200, epoch: 6 | loss: 0.7719189
	speed: 0.0103s/iter; left time: 5.5008s
Updating learning rate to 2.90376003125e-06
Epoch: 6 cost time: 2.704738140106201
Epoch: 6, Steps: 245 | Train Loss: 0.6807348 Vali Loss: 0.5984706 Best vali loss: 0.5973801
	iters: 100, epoch: 7 | loss: 0.8476827
	speed: 0.0180s/iter; left time: 7.0221s
	iters: 200, epoch: 7 | loss: 0.7986912
	speed: 0.0122s/iter; left time: 3.5613s
Updating learning rate to 1.451880015625e-06
Epoch: 7 cost time: 2.832162618637085
Epoch: 7, Steps: 245 | Train Loss: 0.8231870 Vali Loss: 0.5988134 Best vali loss: 0.5973801
	iters: 100, epoch: 8 | loss: 0.7988211
	speed: 0.0237s/iter; left time: 3.4537s
	iters: 200, epoch: 8 | loss: 0.8402766
	speed: 0.0099s/iter; left time: 0.4558s
Updating learning rate to 7.259400078125e-07
Epoch: 8 cost time: 2.8063862323760986
Epoch: 8, Steps: 245 | Train Loss: 0.8195488 Vali Loss: 0.5992251 Best vali loss: 0.5973801

best validation loss 0.5973800663206655

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008576659619, 'e_layers': 3, 'learning_rate': 0.0013959247767, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9380174
	speed: 0.0185s/iter; left time: 70.8572s
	iters: 200, epoch: 1 | loss: 0.6757004
	speed: 0.0063s/iter; left time: 23.5566s
	iters: 300, epoch: 1 | loss: 1.2380401
	speed: 0.0076s/iter; left time: 27.5541s
	iters: 400, epoch: 1 | loss: 0.5418757
	speed: 0.0080s/iter; left time: 28.0222s
Updating learning rate to 0.0013427955534092593
Validation loss decreased (inf --> 0.6138).  Saving model state dict ...
Epoch: 1 cost time: 4.3406572341918945
Epoch: 1, Steps: 490 | Train Loss: 0.8484084 Vali Loss: 0.6137538 Best vali loss: 0.6137538
	iters: 100, epoch: 2 | loss: 0.4504336
	speed: 0.0200s/iter; left time: 66.5154s
	iters: 200, epoch: 2 | loss: 1.4764578
	speed: 0.0069s/iter; left time: 22.3985s
	iters: 300, epoch: 2 | loss: 0.4629953
	speed: 0.0087s/iter; left time: 27.3438s
	iters: 400, epoch: 2 | loss: 0.3394316
	speed: 0.0085s/iter; left time: 25.8820s
Updating learning rate to 0.0011914963261654436
Epoch: 2 cost time: 4.024800539016724
Epoch: 2, Steps: 490 | Train Loss: 0.6823296 Vali Loss: 0.6297194 Best vali loss: 0.6137538
	iters: 100, epoch: 3 | loss: 0.9869840
	speed: 0.0251s/iter; left time: 71.2273s
	iters: 200, epoch: 3 | loss: 0.7599436
	speed: 0.0087s/iter; left time: 23.8801s
	iters: 300, epoch: 3 | loss: 0.5901660
	speed: 0.0098s/iter; left time: 25.9707s
	iters: 400, epoch: 3 | loss: 0.9607158
	speed: 0.0088s/iter; left time: 22.3403s
Updating learning rate to 0.0009650610307855138
Epoch: 3 cost time: 4.454462051391602
Epoch: 3, Steps: 490 | Train Loss: 0.8244523 Vali Loss: 0.6330514 Best vali loss: 0.6137538
	iters: 100, epoch: 4 | loss: 1.1067141
	speed: 0.0238s/iter; left time: 55.8885s
	iters: 200, epoch: 4 | loss: 0.6370794
	speed: 0.0080s/iter; left time: 18.0618s
	iters: 300, epoch: 4 | loss: 0.3889022
	speed: 0.0084s/iter; left time: 17.9959s
	iters: 400, epoch: 4 | loss: 0.8306821
	speed: 0.0086s/iter; left time: 17.6707s
Updating learning rate to 0.00069796238835
Epoch: 4 cost time: 4.081047534942627
Epoch: 4, Steps: 490 | Train Loss: 0.7408445 Vali Loss: 0.6420085 Best vali loss: 0.6137538
	iters: 100, epoch: 5 | loss: 0.8302014
	speed: 0.0247s/iter; left time: 46.0324s
	iters: 200, epoch: 5 | loss: 1.3959856
	speed: 0.0097s/iter; left time: 17.1483s
	iters: 300, epoch: 5 | loss: 0.9955743
	speed: 0.0085s/iter; left time: 14.1978s
	iters: 400, epoch: 5 | loss: 0.9300479
	speed: 0.0086s/iter; left time: 13.4064s
Updating learning rate to 0.0004308637459144863
Validation loss decreased (0.6138 --> 0.6115).  Saving model state dict ...
Epoch: 5 cost time: 4.416714191436768
Epoch: 5, Steps: 490 | Train Loss: 1.0379523 Vali Loss: 0.6115230 Best vali loss: 0.6115230
	iters: 100, epoch: 6 | loss: 0.5448573
	speed: 0.0211s/iter; left time: 28.9476s
	iters: 200, epoch: 6 | loss: 0.8264945
	speed: 0.0080s/iter; left time: 10.1202s
	iters: 300, epoch: 6 | loss: 1.0531995
	speed: 0.0083s/iter; left time: 9.6816s
	iters: 400, epoch: 6 | loss: 0.3725388
	speed: 0.0096s/iter; left time: 10.2732s
Updating learning rate to 0.0002044284505345565
Validation loss decreased (0.6115 --> 0.6046).  Saving model state dict ...
Epoch: 6 cost time: 4.151912450790405
Epoch: 6, Steps: 490 | Train Loss: 0.6992725 Vali Loss: 0.6045739 Best vali loss: 0.6045739
	iters: 100, epoch: 7 | loss: 1.0996274
	speed: 0.0246s/iter; left time: 21.6308s
	iters: 200, epoch: 7 | loss: 0.8971810
	speed: 0.0139s/iter; left time: 10.8546s
	iters: 300, epoch: 7 | loss: 0.5891268
	speed: 0.0140s/iter; left time: 9.5028s
	iters: 400, epoch: 7 | loss: 0.6133122
	speed: 0.0161s/iter; left time: 9.3539s
Updating learning rate to 5.3129223290740836e-05
Epoch: 7 cost time: 6.765594720840454
Epoch: 7, Steps: 490 | Train Loss: 0.7998118 Vali Loss: 0.6165007 Best vali loss: 0.6045739
	iters: 100, epoch: 8 | loss: 1.0572026
	speed: 0.0496s/iter; left time: 19.4131s
	iters: 200, epoch: 8 | loss: 1.0989761
	speed: 0.0140s/iter; left time: 4.0658s
	iters: 300, epoch: 8 | loss: 0.8369024
	speed: 0.0146s/iter; left time: 2.7925s
	iters: 400, epoch: 8 | loss: 0.8787679
	speed: 0.0099s/iter; left time: 0.9042s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.464295864105225
Epoch: 8, Steps: 490 | Train Loss: 0.9679623 Vali Loss: 0.6047224 Best vali loss: 0.6045739

best validation loss 0.604573861805723

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0017160125398, 'e_layers': 2, 'learning_rate': 0.0005326320428, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0031434
	speed: 0.0216s/iter; left time: 82.6979s
	iters: 200, epoch: 1 | loss: 0.7990463
	speed: 0.0106s/iter; left time: 39.5705s
	iters: 300, epoch: 1 | loss: 0.4280332
	speed: 0.0099s/iter; left time: 35.8901s
	iters: 400, epoch: 1 | loss: 1.3627434
	speed: 0.0123s/iter; left time: 43.3609s
Updating learning rate to 0.0005326320428
Validation loss decreased (inf --> 0.6102).  Saving model state dict ...
Epoch: 1 cost time: 6.283441543579102
Epoch: 1, Steps: 490 | Train Loss: 0.8982416 Vali Loss: 0.6101652 Best vali loss: 0.6101652
	iters: 100, epoch: 2 | loss: 0.7511033
	speed: 0.0421s/iter; left time: 140.1162s
	iters: 200, epoch: 2 | loss: 0.6248572
	speed: 0.0114s/iter; left time: 36.6849s
	iters: 300, epoch: 2 | loss: 0.7692314
	speed: 0.0125s/iter; left time: 39.0312s
	iters: 400, epoch: 2 | loss: 0.9642119
	speed: 0.0097s/iter; left time: 29.3784s
Updating learning rate to 0.0002663160214
Epoch: 2 cost time: 5.549427270889282
Epoch: 2, Steps: 490 | Train Loss: 0.7773510 Vali Loss: 0.6399832 Best vali loss: 0.6101652
	iters: 100, epoch: 3 | loss: 0.8926985
	speed: 0.0227s/iter; left time: 64.4715s
	iters: 200, epoch: 3 | loss: 1.1901371
	speed: 0.0093s/iter; left time: 25.4008s
	iters: 300, epoch: 3 | loss: 0.7190658
	speed: 0.0082s/iter; left time: 21.6364s
	iters: 400, epoch: 3 | loss: 0.5634925
	speed: 0.0078s/iter; left time: 19.7969s
Updating learning rate to 0.0001331580107
Epoch: 3 cost time: 4.11315655708313
Epoch: 3, Steps: 490 | Train Loss: 0.8413485 Vali Loss: 0.6223313 Best vali loss: 0.6101652
	iters: 100, epoch: 4 | loss: 0.3979220
	speed: 0.0243s/iter; left time: 57.1838s
	iters: 200, epoch: 4 | loss: 1.1346560
	speed: 0.0080s/iter; left time: 18.0518s
	iters: 300, epoch: 4 | loss: 0.5776941
	speed: 0.0081s/iter; left time: 17.4557s
	iters: 400, epoch: 4 | loss: 0.6829588
	speed: 0.0092s/iter; left time: 18.9475s
Updating learning rate to 6.657900535e-05
Epoch: 4 cost time: 4.103200912475586
Epoch: 4, Steps: 490 | Train Loss: 0.6983077 Vali Loss: 0.6139473 Best vali loss: 0.6101652
	iters: 100, epoch: 5 | loss: 0.5841951
	speed: 0.0232s/iter; left time: 43.1062s
	iters: 200, epoch: 5 | loss: 1.2708759
	speed: 0.0057s/iter; left time: 10.1016s
	iters: 300, epoch: 5 | loss: 0.4958108
	speed: 0.0069s/iter; left time: 11.4437s
	iters: 400, epoch: 5 | loss: 0.7685689
	speed: 0.0078s/iter; left time: 12.2519s
Updating learning rate to 3.3289502675e-05
Epoch: 5 cost time: 3.678316593170166
Epoch: 5, Steps: 490 | Train Loss: 0.7798627 Vali Loss: 0.6260496 Best vali loss: 0.6101652
	iters: 100, epoch: 6 | loss: 1.3211451
	speed: 0.0250s/iter; left time: 34.3431s
	iters: 200, epoch: 6 | loss: 0.4376575
	speed: 0.0105s/iter; left time: 13.3950s
	iters: 300, epoch: 6 | loss: 0.5381669
	speed: 0.0101s/iter; left time: 11.7963s
	iters: 400, epoch: 6 | loss: 0.8070311
	speed: 0.0102s/iter; left time: 10.9487s
Updating learning rate to 1.66447513375e-05
Epoch: 6 cost time: 5.153712272644043
Epoch: 6, Steps: 490 | Train Loss: 0.7760001 Vali Loss: 0.6239270 Best vali loss: 0.6101652
	iters: 100, epoch: 7 | loss: 1.0014641
	speed: 0.0255s/iter; left time: 22.4834s
	iters: 200, epoch: 7 | loss: 0.7229626
	speed: 0.0108s/iter; left time: 8.4012s
	iters: 300, epoch: 7 | loss: 0.8003951
	speed: 0.0120s/iter; left time: 8.1948s
	iters: 400, epoch: 7 | loss: 0.6397778
	speed: 0.0124s/iter; left time: 7.1905s
Updating learning rate to 8.32237566875e-06
Epoch: 7 cost time: 5.413830280303955
Epoch: 7, Steps: 490 | Train Loss: 0.7911499 Vali Loss: 0.6230682 Best vali loss: 0.6101652
	iters: 100, epoch: 8 | loss: 1.0463334
	speed: 0.0368s/iter; left time: 14.3918s
	iters: 200, epoch: 8 | loss: 0.6425455
	speed: 0.0135s/iter; left time: 3.9337s
	iters: 300, epoch: 8 | loss: 0.6788197
	speed: 0.0123s/iter; left time: 2.3462s
	iters: 400, epoch: 8 | loss: 0.5792551
	speed: 0.0129s/iter; left time: 1.1762s
Updating learning rate to 4.161187834375e-06
Epoch: 8 cost time: 6.181024551391602
Epoch: 8, Steps: 490 | Train Loss: 0.7367384 Vali Loss: 0.6243229 Best vali loss: 0.6101652

best validation loss 0.6101652128395246

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0081740353862, 'e_layers': 2, 'learning_rate': 0.0001352780012, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001352780012
Validation loss decreased (inf --> 0.6725).  Saving model state dict ...
Epoch: 1 cost time: 0.8331537246704102
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6725235 Best vali loss: 0.6725235
Updating learning rate to 6.76390006e-05
Validation loss decreased (0.6725 --> 0.6438).  Saving model state dict ...
Epoch: 2 cost time: 0.5694713592529297
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6437572 Best vali loss: 0.6437572
Updating learning rate to 3.38195003e-05
Validation loss decreased (0.6438 --> 0.6345).  Saving model state dict ...
Epoch: 3 cost time: 0.6589827537536621
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6345412 Best vali loss: 0.6345412

best validation loss 0.6345412312752116

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0025789008972, 'e_layers': 2, 'learning_rate': 0.0001118721335, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2772138
	speed: 0.0159s/iter; left time: 60.6467s
	iters: 200, epoch: 1 | loss: 0.5072109
	speed: 0.0089s/iter; left time: 33.2474s
	iters: 300, epoch: 1 | loss: 0.9555076
	speed: 0.0085s/iter; left time: 30.8191s
	iters: 400, epoch: 1 | loss: 0.9891129
	speed: 0.0081s/iter; left time: 28.6602s
Updating learning rate to 0.00010761425394951013
Validation loss decreased (inf --> 0.5925).  Saving model state dict ...
Epoch: 1 cost time: 4.62800407409668
Epoch: 1, Steps: 490 | Train Loss: 0.9322613 Vali Loss: 0.5925316 Best vali loss: 0.5925316
	iters: 100, epoch: 2 | loss: 1.6678404
	speed: 0.0218s/iter; left time: 72.4852s
	iters: 200, epoch: 2 | loss: 1.3752837
	speed: 0.0084s/iter; left time: 27.1620s
	iters: 300, epoch: 2 | loss: 0.7151361
	speed: 0.0087s/iter; left time: 27.2171s
	iters: 400, epoch: 2 | loss: 0.5227666
	speed: 0.0063s/iter; left time: 19.1794s
Updating learning rate to 9.548883886182837e-05
Epoch: 2 cost time: 3.6665735244750977
Epoch: 2, Steps: 490 | Train Loss: 1.0702567 Vali Loss: 0.6133811 Best vali loss: 0.5925316
	iters: 100, epoch: 3 | loss: 0.9083272
	speed: 0.0220s/iter; left time: 62.4057s
	iters: 200, epoch: 3 | loss: 1.3058915
	speed: 0.0082s/iter; left time: 22.4631s
	iters: 300, epoch: 3 | loss: 0.7306764
	speed: 0.0074s/iter; left time: 19.6049s
	iters: 400, epoch: 3 | loss: 1.2601663
	speed: 0.0097s/iter; left time: 24.6682s
Updating learning rate to 7.734187276689278e-05
Epoch: 3 cost time: 4.329200744628906
Epoch: 3, Steps: 490 | Train Loss: 1.0512654 Vali Loss: 0.6228007 Best vali loss: 0.5925316

best validation loss 0.59253162164922

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0022960309029, 'e_layers': 4, 'learning_rate': 0.004814200159, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0318650
	speed: 0.0184s/iter; left time: 16.2454s
Updating learning rate to 0.004630970575656341
Validation loss decreased (inf --> 0.6669).  Saving model state dict ...
Epoch: 1 cost time: 1.7530853748321533
Epoch: 1, Steps: 123 | Train Loss: 1.0318650 Vali Loss: 0.6668596 Best vali loss: 0.6668596
	iters: 100, epoch: 2 | loss: 0.7580326
	speed: 0.0166s/iter; left time: 12.6639s
Updating learning rate to 0.004109176868709127
Validation loss decreased (0.6669 --> 0.6584).  Saving model state dict ...
Epoch: 2 cost time: 1.459092140197754
Epoch: 2, Steps: 123 | Train Loss: 0.7580326 Vali Loss: 0.6584090 Best vali loss: 0.6584090
	iters: 100, epoch: 3 | loss: 1.0737251
	speed: 0.0165s/iter; left time: 10.5246s
Updating learning rate to 0.0033282573999693405
Validation loss decreased (0.6584 --> 0.6408).  Saving model state dict ...
Epoch: 3 cost time: 1.391922950744629
Epoch: 3, Steps: 123 | Train Loss: 1.0737251 Vali Loss: 0.6408390 Best vali loss: 0.6408390

best validation loss 0.6408389706349052

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0025789008972, 'e_layers': 2, 'learning_rate': 0.0001118721335, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.2255893
	speed: 0.0162s/iter; left time: 38.1652s
	iters: 200, epoch: 4 | loss: 0.4822478
	speed: 0.0073s/iter; left time: 16.3560s
	iters: 300, epoch: 4 | loss: 0.9285319
	speed: 0.0065s/iter; left time: 13.9502s
	iters: 400, epoch: 4 | loss: 0.8936392
	speed: 0.0065s/iter; left time: 13.3954s
Updating learning rate to 5.593606675e-05
Validation loss decreased (0.5925 --> 0.5822).  Saving model state dict ...
Epoch: 4 cost time: 3.8713326454162598
Epoch: 4, Steps: 490 | Train Loss: 0.8825020 Vali Loss: 0.5822234 Best vali loss: 0.5822234
	iters: 100, epoch: 5 | loss: 1.5185199
	speed: 0.0202s/iter; left time: 37.6091s
	iters: 200, epoch: 5 | loss: 1.2654124
	speed: 0.0066s/iter; left time: 11.6958s
	iters: 300, epoch: 5 | loss: 0.6259648
	speed: 0.0070s/iter; left time: 11.5561s
	iters: 400, epoch: 5 | loss: 0.4885987
	speed: 0.0070s/iter; left time: 10.8804s
Updating learning rate to 3.453026073310723e-05
Epoch: 5 cost time: 3.40631103515625
Epoch: 5, Steps: 490 | Train Loss: 0.9746240 Vali Loss: 0.5837006 Best vali loss: 0.5822234
	iters: 100, epoch: 6 | loss: 0.8872058
	speed: 0.0181s/iter; left time: 24.7750s
	iters: 200, epoch: 6 | loss: 1.2012707
	speed: 0.0060s/iter; left time: 7.5868s
	iters: 300, epoch: 6 | loss: 0.7105310
	speed: 0.0069s/iter; left time: 8.0382s
	iters: 400, epoch: 6 | loss: 1.2496134
	speed: 0.0065s/iter; left time: 6.9106s
Updating learning rate to 1.6383294638171637e-05
Validation loss decreased (0.5822 --> 0.5799).  Saving model state dict ...
Epoch: 6 cost time: 2.9927990436553955
Epoch: 6, Steps: 490 | Train Loss: 1.0121552 Vali Loss: 0.5799355 Best vali loss: 0.5799355
	iters: 100, epoch: 7 | loss: 0.9671166
	speed: 0.0175s/iter; left time: 15.4560s
	iters: 200, epoch: 7 | loss: 0.8305100
	speed: 0.0085s/iter; left time: 6.6535s
	iters: 300, epoch: 7 | loss: 0.6224638
	speed: 0.0082s/iter; left time: 5.5590s
	iters: 400, epoch: 7 | loss: 0.5693058
	speed: 0.0084s/iter; left time: 4.9075s
Updating learning rate to 4.25787955048987e-06
Validation loss decreased (0.5799 --> 0.5720).  Saving model state dict ...
Epoch: 7 cost time: 4.107166528701782
Epoch: 7, Steps: 490 | Train Loss: 0.7473490 Vali Loss: 0.5719568 Best vali loss: 0.5719568
	iters: 100, epoch: 8 | loss: 0.6712759
	speed: 0.0224s/iter; left time: 8.7758s
	iters: 200, epoch: 8 | loss: 0.5794103
	speed: 0.0083s/iter; left time: 2.4242s
	iters: 300, epoch: 8 | loss: 0.8931341
	speed: 0.0082s/iter; left time: 1.5679s
	iters: 400, epoch: 8 | loss: 0.9408789
	speed: 0.0084s/iter; left time: 0.7671s
Updating learning rate to 0.0
Validation loss decreased (0.5720 --> 0.5711).  Saving model state dict ...
Epoch: 8 cost time: 4.161114931106567
Epoch: 8, Steps: 490 | Train Loss: 0.7711748 Vali Loss: 0.5710752 Best vali loss: 0.5710752

best validation loss 0.5710751517731412

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0035888960285, 'e_layers': 3, 'learning_rate': 8.306939e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7818203
	speed: 0.0276s/iter; left time: 24.4666s
Updating learning rate to 7.990774959959888e-05
Validation loss decreased (inf --> 0.6126).  Saving model state dict ...
Epoch: 1 cost time: 2.919912099838257
Epoch: 1, Steps: 123 | Train Loss: 0.7818203 Vali Loss: 0.6126377 Best vali loss: 0.6126377
	iters: 100, epoch: 2 | loss: 0.7873795
	speed: 0.0221s/iter; left time: 16.8284s
Updating learning rate to 7.090415948901498e-05
Validation loss decreased (0.6126 --> 0.6094).  Saving model state dict ...
Epoch: 2 cost time: 1.5702874660491943
Epoch: 2, Steps: 123 | Train Loss: 0.7873795 Vali Loss: 0.6093824 Best vali loss: 0.6093824
	iters: 100, epoch: 3 | loss: 1.0272013
	speed: 0.0322s/iter; left time: 20.5548s
Updating learning rate to 5.742933464483714e-05
Validation loss decreased (0.6094 --> 0.6011).  Saving model state dict ...
Epoch: 3 cost time: 2.3330414295196533
Epoch: 3, Steps: 123 | Train Loss: 1.0272013 Vali Loss: 0.6011373 Best vali loss: 0.6011373
	iters: 100, epoch: 4 | loss: 0.7069471
	speed: 0.0345s/iter; left time: 17.7916s
Updating learning rate to 4.1534695e-05
Validation loss decreased (0.6011 --> 0.6002).  Saving model state dict ...
Epoch: 4 cost time: 2.6877825260162354
Epoch: 4, Steps: 123 | Train Loss: 0.7069471 Vali Loss: 0.6002200 Best vali loss: 0.6002200
	iters: 100, epoch: 5 | loss: 0.7204180
	speed: 0.0333s/iter; left time: 13.1060s
Updating learning rate to 2.564005535516287e-05
Epoch: 5 cost time: 2.5034797191619873
Epoch: 5, Steps: 123 | Train Loss: 0.7204180 Vali Loss: 0.6013948 Best vali loss: 0.6002200
	iters: 100, epoch: 6 | loss: 0.9452366
	speed: 0.0272s/iter; left time: 7.3401s
Updating learning rate to 1.2165230510985013e-05
Epoch: 6 cost time: 1.564729928970337
Epoch: 6, Steps: 123 | Train Loss: 0.9452366 Vali Loss: 0.6044926 Best vali loss: 0.6002200
	iters: 100, epoch: 7 | loss: 0.8228965
	speed: 0.0292s/iter; left time: 4.2969s
Updating learning rate to 3.1616404004011213e-06
Validation loss decreased (0.6002 --> 0.5883).  Saving model state dict ...
Epoch: 7 cost time: 2.159323215484619
Epoch: 7, Steps: 123 | Train Loss: 0.8228965 Vali Loss: 0.5882894 Best vali loss: 0.5882894
	iters: 100, epoch: 8 | loss: 0.9579225
	speed: 0.0266s/iter; left time: 0.6374s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2697818279266357
Epoch: 8, Steps: 123 | Train Loss: 0.9579225 Vali Loss: 0.5889919 Best vali loss: 0.5882894

best validation loss 0.5882894421054058

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001557219609, 'e_layers': 3, 'learning_rate': 0.0033639330518, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5332940
	speed: 0.0160s/iter; left time: 29.7767s
	iters: 200, epoch: 1 | loss: 0.9733490
	speed: 0.0085s/iter; left time: 15.0352s
Updating learning rate to 0.0033639330518
Validation loss decreased (inf --> 0.6485).  Saving model state dict ...
Epoch: 1 cost time: 2.5657570362091064
Epoch: 1, Steps: 245 | Train Loss: 0.7533215 Vali Loss: 0.6484989 Best vali loss: 0.6484989
	iters: 100, epoch: 2 | loss: 0.9451649
	speed: 0.0338s/iter; left time: 54.5771s
	iters: 200, epoch: 2 | loss: 1.1431992
	speed: 0.0173s/iter; left time: 26.2168s
Updating learning rate to 0.0016819665259
Validation loss decreased (0.6485 --> 0.6352).  Saving model state dict ...
Epoch: 2 cost time: 4.280215740203857
Epoch: 2, Steps: 245 | Train Loss: 1.0441820 Vali Loss: 0.6351659 Best vali loss: 0.6351659
	iters: 100, epoch: 3 | loss: 1.2199193
	speed: 0.0368s/iter; left time: 50.4237s
	iters: 200, epoch: 3 | loss: 0.9274101
	speed: 0.0071s/iter; left time: 9.0693s
Updating learning rate to 0.00084098326295
Epoch: 3 cost time: 2.795740842819214
Epoch: 3, Steps: 245 | Train Loss: 1.0736647 Vali Loss: 0.6420046 Best vali loss: 0.6351659
	iters: 100, epoch: 4 | loss: 0.5273059
	speed: 0.0415s/iter; left time: 46.7223s
	iters: 200, epoch: 4 | loss: 1.2787598
	speed: 0.0244s/iter; left time: 25.0135s
Updating learning rate to 0.000420491631475
Epoch: 4 cost time: 5.890307664871216
Epoch: 4, Steps: 245 | Train Loss: 0.9030329 Vali Loss: 0.6400259 Best vali loss: 0.6351659
	iters: 100, epoch: 5 | loss: 1.0065047
	speed: 0.0690s/iter; left time: 60.7903s
	iters: 200, epoch: 5 | loss: 0.7607194
	speed: 0.0241s/iter; left time: 18.8169s
Updating learning rate to 0.0002102458157375
Epoch: 5 cost time: 5.959110498428345
Epoch: 5, Steps: 245 | Train Loss: 0.8836120 Vali Loss: 0.6395662 Best vali loss: 0.6351659
	iters: 100, epoch: 6 | loss: 0.6964545
	speed: 0.0637s/iter; left time: 40.4857s
	iters: 200, epoch: 6 | loss: 0.7820709
	speed: 0.0196s/iter; left time: 10.5009s
Updating learning rate to 0.00010512290786875
Epoch: 6 cost time: 5.275298833847046
Epoch: 6, Steps: 245 | Train Loss: 0.7392627 Vali Loss: 0.6394151 Best vali loss: 0.6351659
	iters: 100, epoch: 7 | loss: 0.6696232
	speed: 0.0475s/iter; left time: 18.5674s
	iters: 200, epoch: 7 | loss: 0.9390607
	speed: 0.0233s/iter; left time: 6.7750s
Updating learning rate to 5.2561453934375e-05
Epoch: 7 cost time: 5.494216203689575
Epoch: 7, Steps: 245 | Train Loss: 0.8043420 Vali Loss: 0.6397916 Best vali loss: 0.6351659
	iters: 100, epoch: 8 | loss: 0.6662470
	speed: 0.0636s/iter; left time: 9.2853s
	iters: 200, epoch: 8 | loss: 0.6669526
	speed: 0.0249s/iter; left time: 1.1471s
Updating learning rate to 2.62807269671875e-05
Epoch: 8 cost time: 6.128602027893066
Epoch: 8, Steps: 245 | Train Loss: 0.6665998 Vali Loss: 0.6399214 Best vali loss: 0.6351659

best validation loss 0.6351658611151975

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0019185554037, 'e_layers': 1, 'learning_rate': 0.0008261633471, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8774643
	speed: 0.0360s/iter; left time: 31.8758s
Updating learning rate to 0.0007947193769983539
Validation loss decreased (inf --> 0.5926).  Saving model state dict ...
Epoch: 1 cost time: 3.6922056674957275
Epoch: 1, Steps: 123 | Train Loss: 0.8774643 Vali Loss: 0.5925725 Best vali loss: 0.5925725
	iters: 100, epoch: 2 | loss: 0.9054167
	speed: 0.0397s/iter; left time: 30.2674s
Updating learning rate to 0.0007051745261010926
Epoch: 2 cost time: 3.1506807804107666
Epoch: 2, Steps: 123 | Train Loss: 0.9054167 Vali Loss: 0.6093936 Best vali loss: 0.5925725
	iters: 100, epoch: 3 | loss: 0.9620976
	speed: 0.0495s/iter; left time: 31.6045s
Updating learning rate to 0.0005711611862312295
Epoch: 3 cost time: 3.3725993633270264
Epoch: 3, Steps: 123 | Train Loss: 0.9620976 Vali Loss: 0.6349532 Best vali loss: 0.5925725

best validation loss 0.592572477116512

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 0.000109720172, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2203991
	speed: 0.0335s/iter; left time: 62.4153s
	iters: 200, epoch: 1 | loss: 0.8613383
	speed: 0.0215s/iter; left time: 37.8951s
Updating learning rate to 0.00010554419660720899
Validation loss decreased (inf --> 0.6555).  Saving model state dict ...
Epoch: 1 cost time: 6.141846656799316
Epoch: 1, Steps: 245 | Train Loss: 1.0408687 Vali Loss: 0.6554741 Best vali loss: 0.6554741
	iters: 100, epoch: 2 | loss: 0.9131428
	speed: 0.0369s/iter; left time: 59.5685s
	iters: 200, epoch: 2 | loss: 0.5874564
	speed: 0.0200s/iter; left time: 30.3200s
Updating learning rate to 9.365202482707718e-05
Validation loss decreased (0.6555 --> 0.6378).  Saving model state dict ...
Epoch: 2 cost time: 4.809189319610596
Epoch: 2, Steps: 245 | Train Loss: 0.7502996 Vali Loss: 0.6377582 Best vali loss: 0.6377582
	iters: 100, epoch: 3 | loss: 0.7866412
	speed: 0.0314s/iter; left time: 43.0884s
	iters: 200, epoch: 3 | loss: 0.7191644
	speed: 0.0081s/iter; left time: 10.3102s
Updating learning rate to 7.585413201032401e-05
Validation loss decreased (0.6378 --> 0.6278).  Saving model state dict ...
Epoch: 3 cost time: 2.0353894233703613
Epoch: 3, Steps: 245 | Train Loss: 0.7529028 Vali Loss: 0.6277539 Best vali loss: 0.6277539

best validation loss 0.6277539281589132

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0008018849014, 'e_layers': 4, 'learning_rate': 0.0005221113879, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6266143
	speed: 0.0258s/iter; left time: 22.8565s
Updating learning rate to 0.0005022397064359356
Validation loss decreased (inf --> 0.6084).  Saving model state dict ...
Epoch: 1 cost time: 2.705768346786499
Epoch: 1, Steps: 123 | Train Loss: 0.6266143 Vali Loss: 0.6083607 Best vali loss: 0.6083607
	iters: 100, epoch: 2 | loss: 1.0290231
	speed: 0.0277s/iter; left time: 21.0820s
Updating learning rate to 0.00044564994540940495
Validation loss decreased (0.6084 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 2.220792293548584
Epoch: 2, Steps: 123 | Train Loss: 1.0290231 Vali Loss: 0.5994896 Best vali loss: 0.5994896
	iters: 100, epoch: 3 | loss: 0.7071679
	speed: 0.0312s/iter; left time: 19.9129s
Updating learning rate to 0.0003609573829492364
Validation loss decreased (0.5995 --> 0.5695).  Saving model state dict ...
Epoch: 3 cost time: 2.175858974456787
Epoch: 3, Steps: 123 | Train Loss: 0.7071679 Vali Loss: 0.5694977 Best vali loss: 0.5694977

best validation loss 0.5694977133321519

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0008018849014, 'e_layers': 4, 'learning_rate': 0.0005221113879, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5078037
	speed: 0.0184s/iter; left time: 9.4797s
Updating learning rate to 0.00026105569395
Epoch: 4 cost time: 1.6312837600708008
Epoch: 4, Steps: 123 | Train Loss: 0.5078037 Vali Loss: 0.5753943 Best vali loss: 0.5694977
	iters: 100, epoch: 5 | loss: 0.9578428
	speed: 0.0153s/iter; left time: 6.0295s
Updating learning rate to 0.00016115400495076362
Epoch: 5 cost time: 1.2815775871276855
Epoch: 5, Steps: 123 | Train Loss: 0.9578428 Vali Loss: 0.5968405 Best vali loss: 0.5694977
	iters: 100, epoch: 6 | loss: 0.6677057
	speed: 0.0167s/iter; left time: 4.4997s
Updating learning rate to 7.646144249059505e-05
Epoch: 6 cost time: 1.4142210483551025
Epoch: 6, Steps: 123 | Train Loss: 0.6677057 Vali Loss: 0.5887561 Best vali loss: 0.5694977
	iters: 100, epoch: 7 | loss: 0.6338051
	speed: 0.0161s/iter; left time: 2.3651s
Updating learning rate to 1.9871681464064455e-05
Epoch: 7 cost time: 1.3500218391418457
Epoch: 7, Steps: 123 | Train Loss: 0.6338051 Vali Loss: 0.5808421 Best vali loss: 0.5694977
	iters: 100, epoch: 8 | loss: 0.7679282
	speed: 0.0151s/iter; left time: 0.3620s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2335224151611328
Epoch: 8, Steps: 123 | Train Loss: 0.7679282 Vali Loss: 0.5809888 Best vali loss: 0.5694977

best validation loss 0.5694977133321519

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013550112799, 'e_layers': 2, 'learning_rate': 0.0005502704673, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5599027
	speed: 0.0206s/iter; left time: 78.6333s
	iters: 200, epoch: 1 | loss: 0.6061110
	speed: 0.0138s/iter; left time: 51.4358s
	iters: 300, epoch: 1 | loss: 0.6395516
	speed: 0.0129s/iter; left time: 46.7711s
	iters: 400, epoch: 1 | loss: 0.4208728
	speed: 0.0083s/iter; left time: 29.1407s
Updating learning rate to 0.0005502704673
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 6.042410135269165
Epoch: 1, Steps: 490 | Train Loss: 0.5566095 Vali Loss: 0.6078379 Best vali loss: 0.6078379
	iters: 100, epoch: 2 | loss: 0.7111299
	speed: 0.0216s/iter; left time: 71.9444s
	iters: 200, epoch: 2 | loss: 1.0869085
	speed: 0.0053s/iter; left time: 17.2115s
	iters: 300, epoch: 2 | loss: 1.4851785
	speed: 0.0060s/iter; left time: 18.8053s
	iters: 400, epoch: 2 | loss: 0.6817919
	speed: 0.0056s/iter; left time: 16.9826s
Updating learning rate to 0.00027513523365
Validation loss decreased (0.6078 --> 0.5971).  Saving model state dict ...
Epoch: 2 cost time: 2.8248822689056396
Epoch: 2, Steps: 490 | Train Loss: 0.9912522 Vali Loss: 0.5970736 Best vali loss: 0.5970736
	iters: 100, epoch: 3 | loss: 0.5508768
	speed: 0.0166s/iter; left time: 47.2377s
	iters: 200, epoch: 3 | loss: 0.5726724
	speed: 0.0057s/iter; left time: 15.6260s
	iters: 300, epoch: 3 | loss: 1.2111187
	speed: 0.0058s/iter; left time: 15.3299s
	iters: 400, epoch: 3 | loss: 1.0269146
	speed: 0.0056s/iter; left time: 14.1760s
Updating learning rate to 0.000137567616825
Epoch: 3 cost time: 2.8585166931152344
Epoch: 3, Steps: 490 | Train Loss: 0.8403956 Vali Loss: 0.6064507 Best vali loss: 0.5970736
	iters: 100, epoch: 4 | loss: 0.4690578
	speed: 0.0167s/iter; left time: 39.2433s
	iters: 200, epoch: 4 | loss: 0.5878283
	speed: 0.0052s/iter; left time: 11.7333s
	iters: 300, epoch: 4 | loss: 0.7913712
	speed: 0.0051s/iter; left time: 10.9476s
	iters: 400, epoch: 4 | loss: 1.6205547
	speed: 0.0058s/iter; left time: 11.8683s
Updating learning rate to 6.87838084125e-05
Epoch: 4 cost time: 2.7557594776153564
Epoch: 4, Steps: 490 | Train Loss: 0.8672030 Vali Loss: 0.6061638 Best vali loss: 0.5970736
	iters: 100, epoch: 5 | loss: 0.6761851
	speed: 0.0162s/iter; left time: 30.1374s
	iters: 200, epoch: 5 | loss: 0.8495542
	speed: 0.0059s/iter; left time: 10.3228s
	iters: 300, epoch: 5 | loss: 0.9524045
	speed: 0.0061s/iter; left time: 10.0685s
	iters: 400, epoch: 5 | loss: 0.6345938
	speed: 0.0060s/iter; left time: 9.4207s
Updating learning rate to 3.439190420625e-05
Epoch: 5 cost time: 2.911935329437256
Epoch: 5, Steps: 490 | Train Loss: 0.7781844 Vali Loss: 0.6145609 Best vali loss: 0.5970736
	iters: 100, epoch: 6 | loss: 0.9122661
	speed: 0.0169s/iter; left time: 23.1838s
	iters: 200, epoch: 6 | loss: 0.8177764
	speed: 0.0058s/iter; left time: 7.3872s
	iters: 300, epoch: 6 | loss: 0.7932794
	speed: 0.0056s/iter; left time: 6.5933s
	iters: 400, epoch: 6 | loss: 0.8348119
	speed: 0.0058s/iter; left time: 6.1980s
Updating learning rate to 1.7195952103125e-05
Epoch: 6 cost time: 2.8741555213928223
Epoch: 6, Steps: 490 | Train Loss: 0.8395335 Vali Loss: 0.6186960 Best vali loss: 0.5970736
	iters: 100, epoch: 7 | loss: 0.5445331
	speed: 0.0165s/iter; left time: 14.5544s
	iters: 200, epoch: 7 | loss: 0.6059362
	speed: 0.0055s/iter; left time: 4.3190s
	iters: 300, epoch: 7 | loss: 0.8297350
	speed: 0.0056s/iter; left time: 3.8264s
	iters: 400, epoch: 7 | loss: 0.5338162
	speed: 0.0058s/iter; left time: 3.3645s
Updating learning rate to 8.5979760515625e-06
Epoch: 7 cost time: 2.8127787113189697
Epoch: 7, Steps: 490 | Train Loss: 0.6285051 Vali Loss: 0.6203550 Best vali loss: 0.5970736
	iters: 100, epoch: 8 | loss: 0.5098864
	speed: 0.0162s/iter; left time: 6.3303s
	iters: 200, epoch: 8 | loss: 1.4648012
	speed: 0.0055s/iter; left time: 1.6093s
	iters: 300, epoch: 8 | loss: 0.6203951
	speed: 0.0057s/iter; left time: 1.0855s
	iters: 400, epoch: 8 | loss: 0.4249627
	speed: 0.0056s/iter; left time: 0.5130s
Updating learning rate to 4.29898802578125e-06
Epoch: 8 cost time: 2.742068290710449
Epoch: 8, Steps: 490 | Train Loss: 0.7550113 Vali Loss: 0.6184816 Best vali loss: 0.5970736

best validation loss 0.5970735843536866

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0052851717933, 'e_layers': 3, 'learning_rate': 0.0003752147486, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9659452
	speed: 0.0141s/iter; left time: 12.4513s
Updating learning rate to 0.000360933987563954
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 1.315974235534668
Epoch: 1, Steps: 123 | Train Loss: 0.9659452 Vali Loss: 0.6040548 Best vali loss: 0.6040548
	iters: 100, epoch: 2 | loss: 0.8384813
	speed: 0.0150s/iter; left time: 11.4563s
Updating learning rate to 0.00032026582086813277
Validation loss decreased (0.6041 --> 0.6012).  Saving model state dict ...
Epoch: 2 cost time: 1.1892600059509277
Epoch: 2, Steps: 123 | Train Loss: 0.8384813 Vali Loss: 0.6011732 Best vali loss: 0.6011732
	iters: 100, epoch: 3 | loss: 0.9142911
	speed: 0.0275s/iter; left time: 17.6002s
Updating learning rate to 0.00025940160823412613
Validation loss decreased (0.6012 --> 0.5601).  Saving model state dict ...
Epoch: 3 cost time: 2.704524040222168
Epoch: 3, Steps: 123 | Train Loss: 0.9142911 Vali Loss: 0.5601207 Best vali loss: 0.5601207
	iters: 100, epoch: 4 | loss: 0.7757652
	speed: 0.0310s/iter; left time: 15.9814s
Updating learning rate to 0.0001876073743
Validation loss decreased (0.5601 --> 0.5475).  Saving model state dict ...
Epoch: 4 cost time: 1.940812349319458
Epoch: 4, Steps: 123 | Train Loss: 0.7757652 Vali Loss: 0.5475096 Best vali loss: 0.5475096
	iters: 100, epoch: 5 | loss: 0.6913560
	speed: 0.0330s/iter; left time: 12.9578s
Updating learning rate to 0.00011581314036587387
Epoch: 5 cost time: 2.6982955932617188
Epoch: 5, Steps: 123 | Train Loss: 0.6913560 Vali Loss: 0.5539884 Best vali loss: 0.5475096
	iters: 100, epoch: 6 | loss: 0.6949005
	speed: 0.0365s/iter; left time: 9.8631s
Updating learning rate to 5.494892773186719e-05
Epoch: 6 cost time: 2.720038414001465
Epoch: 6, Steps: 123 | Train Loss: 0.6949005 Vali Loss: 0.5534492 Best vali loss: 0.5475096
	iters: 100, epoch: 7 | loss: 0.7759106
	speed: 0.0358s/iter; left time: 5.2601s
Updating learning rate to 1.428076103604601e-05
Epoch: 7 cost time: 2.512507200241089
Epoch: 7, Steps: 123 | Train Loss: 0.7759106 Vali Loss: 0.5564541 Best vali loss: 0.5475096
	iters: 100, epoch: 8 | loss: 0.8301616
	speed: 0.0233s/iter; left time: 0.5585s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1886041164398193
Epoch: 8, Steps: 123 | Train Loss: 0.8301616 Vali Loss: 0.5555404 Best vali loss: 0.5475096

best validation loss 0.547509627919239

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.003778909515, 'e_layers': 2, 'learning_rate': 7.38400575e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9456567
	speed: 0.0156s/iter; left time: 13.8224s
Updating learning rate to 7.38400575e-05
Validation loss decreased (inf --> 0.6175).  Saving model state dict ...
Epoch: 1 cost time: 1.486450433731079
Epoch: 1, Steps: 123 | Train Loss: 0.9456567 Vali Loss: 0.6174999 Best vali loss: 0.6174999
	iters: 100, epoch: 2 | loss: 1.0317100
	speed: 0.0146s/iter; left time: 11.1168s
Updating learning rate to 3.692002875e-05
Validation loss decreased (0.6175 --> 0.6049).  Saving model state dict ...
Epoch: 2 cost time: 1.165822982788086
Epoch: 2, Steps: 123 | Train Loss: 1.0317100 Vali Loss: 0.6048558 Best vali loss: 0.6048558
	iters: 100, epoch: 3 | loss: 0.7636430
	speed: 0.0151s/iter; left time: 9.6239s
Updating learning rate to 1.8460014375e-05
Validation loss decreased (0.6049 --> 0.6036).  Saving model state dict ...
Epoch: 3 cost time: 1.2460765838623047
Epoch: 3, Steps: 123 | Train Loss: 0.7636430 Vali Loss: 0.6035608 Best vali loss: 0.6035608

best validation loss 0.6035608397706247

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0012599336841, 'e_layers': 4, 'learning_rate': 6.44670134e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5615743
	speed: 0.0196s/iter; left time: 17.3772s
Updating learning rate to 6.201338380119543e-05
Validation loss decreased (inf --> 0.6047).  Saving model state dict ...
Epoch: 1 cost time: 1.9131126403808594
Epoch: 1, Steps: 123 | Train Loss: 0.5615743 Vali Loss: 0.6046977 Best vali loss: 0.6046977
	iters: 100, epoch: 2 | loss: 0.9256446
	speed: 0.0191s/iter; left time: 14.5483s
Updating learning rate to 5.502603786899201e-05
Validation loss decreased (0.6047 --> 0.5973).  Saving model state dict ...
Epoch: 2 cost time: 1.7005102634429932
Epoch: 2, Steps: 123 | Train Loss: 0.9256446 Vali Loss: 0.5972531 Best vali loss: 0.5972531
	iters: 100, epoch: 3 | loss: 0.6427069
	speed: 0.0214s/iter; left time: 13.6536s
Updating learning rate to 4.456873568111912e-05
Validation loss decreased (0.5973 --> 0.5902).  Saving model state dict ...
Epoch: 3 cost time: 1.732372522354126
Epoch: 3, Steps: 123 | Train Loss: 0.6427069 Vali Loss: 0.5902172 Best vali loss: 0.5902172

best validation loss 0.5902172085423538

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0065094553439, 'e_layers': 2, 'learning_rate': 0.0006446265408, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7969882
	speed: 0.0152s/iter; left time: 13.4596s
Updating learning rate to 0.000620091903979336
Validation loss decreased (inf --> 0.5954).  Saving model state dict ...
Epoch: 1 cost time: 1.5143985748291016
Epoch: 1, Steps: 123 | Train Loss: 0.7969882 Vali Loss: 0.5954034 Best vali loss: 0.5954034
	iters: 100, epoch: 2 | loss: 0.8251290
	speed: 0.0153s/iter; left time: 11.6602s
Updating learning rate to 0.0005502231695662533
Epoch: 2 cost time: 1.1627378463745117
Epoch: 2, Steps: 123 | Train Loss: 0.8251290 Vali Loss: 0.6197720 Best vali loss: 0.5954034
	iters: 100, epoch: 3 | loss: 0.7579629
	speed: 0.0144s/iter; left time: 9.1874s
Updating learning rate to 0.0004456572190134893
Epoch: 3 cost time: 1.228713035583496
Epoch: 3, Steps: 123 | Train Loss: 0.7579629 Vali Loss: 0.6407660 Best vali loss: 0.5954034

best validation loss 0.5954033618224875

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0012599336841, 'e_layers': 4, 'learning_rate': 6.44670134e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5165677
	speed: 0.0208s/iter; left time: 10.7214s
Updating learning rate to 3.22335067e-05
Validation loss decreased (0.5902 --> 0.5613).  Saving model state dict ...
Epoch: 4 cost time: 1.994960069656372
Epoch: 4, Steps: 123 | Train Loss: 0.5165677 Vali Loss: 0.5613438 Best vali loss: 0.5613438
	iters: 100, epoch: 5 | loss: 0.8355044
	speed: 0.0233s/iter; left time: 9.1542s
Updating learning rate to 1.9898277718880883e-05
Validation loss decreased (0.5613 --> 0.5557).  Saving model state dict ...
Epoch: 5 cost time: 1.9216833114624023
Epoch: 5, Steps: 123 | Train Loss: 0.8355044 Vali Loss: 0.5556601 Best vali loss: 0.5556601
	iters: 100, epoch: 6 | loss: 0.5687376
	speed: 0.0238s/iter; left time: 6.4254s
Updating learning rate to 9.440975531007989e-06
Validation loss decreased (0.5557 --> 0.5532).  Saving model state dict ...
Epoch: 6 cost time: 1.8632335662841797
Epoch: 6, Steps: 123 | Train Loss: 0.5687376 Vali Loss: 0.5532153 Best vali loss: 0.5532153
	iters: 100, epoch: 7 | loss: 0.7622212
	speed: 0.0194s/iter; left time: 2.8560s
Updating learning rate to 2.4536295988045713e-06
Validation loss decreased (0.5532 --> 0.5413).  Saving model state dict ...
Epoch: 7 cost time: 1.6615567207336426
Epoch: 7, Steps: 123 | Train Loss: 0.7622212 Vali Loss: 0.5412873 Best vali loss: 0.5412873
	iters: 100, epoch: 8 | loss: 0.7027279
	speed: 0.0226s/iter; left time: 0.5419s
Updating learning rate to 0.0
Validation loss decreased (0.5413 --> 0.5413).  Saving model state dict ...
Epoch: 8 cost time: 1.8402180671691895
Epoch: 8, Steps: 123 | Train Loss: 0.7027279 Vali Loss: 0.5412587 Best vali loss: 0.5412587

best validation loss 0.5412587316595587

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0026805940516, 'e_layers': 4, 'learning_rate': 0.0027816638554, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8286273
	speed: 0.0168s/iter; left time: 14.9027s
Updating learning rate to 0.0026757930788652478
Validation loss decreased (inf --> 0.6586).  Saving model state dict ...
Epoch: 1 cost time: 1.645444631576538
Epoch: 1, Steps: 123 | Train Loss: 0.8286273 Vali Loss: 0.6586129 Best vali loss: 0.6586129
	iters: 100, epoch: 2 | loss: 0.8461195
	speed: 0.0169s/iter; left time: 12.8835s
Updating learning rate to 0.002374298615267428
Validation loss decreased (0.6586 --> 0.6462).  Saving model state dict ...
Epoch: 2 cost time: 1.4280903339385986
Epoch: 2, Steps: 123 | Train Loss: 0.8461195 Vali Loss: 0.6461545 Best vali loss: 0.6461545
	iters: 100, epoch: 3 | loss: 0.9031234
	speed: 0.0185s/iter; left time: 11.8318s
Updating learning rate to 0.0019230802636351905
Epoch: 3 cost time: 1.7286772727966309
Epoch: 3, Steps: 123 | Train Loss: 0.9031234 Vali Loss: 0.6549429 Best vali loss: 0.6461545
	iters: 100, epoch: 4 | loss: 0.8876938
	speed: 0.0179s/iter; left time: 9.2125s
Updating learning rate to 0.0013908319277
Validation loss decreased (0.6462 --> 0.6415).  Saving model state dict ...
Epoch: 4 cost time: 1.356062650680542
Epoch: 4, Steps: 123 | Train Loss: 0.8876938 Vali Loss: 0.6414615 Best vali loss: 0.6414615
	iters: 100, epoch: 5 | loss: 0.6208767
	speed: 0.0165s/iter; left time: 6.5019s
Updating learning rate to 0.0008585835917648097
Epoch: 5 cost time: 1.3935863971710205
Epoch: 5, Steps: 123 | Train Loss: 0.6208767 Vali Loss: 0.6423499 Best vali loss: 0.6414615
	iters: 100, epoch: 6 | loss: 0.6934780
	speed: 0.0166s/iter; left time: 4.4920s
Updating learning rate to 0.0004073652401325721
Epoch: 6 cost time: 1.4073584079742432
Epoch: 6, Steps: 123 | Train Loss: 0.6934780 Vali Loss: 0.6423992 Best vali loss: 0.6414615
	iters: 100, epoch: 7 | loss: 0.7414562
	speed: 0.0192s/iter; left time: 2.8167s
Updating learning rate to 0.00010587077653475225
Epoch: 7 cost time: 1.6338539123535156
Epoch: 7, Steps: 123 | Train Loss: 0.7414562 Vali Loss: 0.6432016 Best vali loss: 0.6414615
	iters: 100, epoch: 8 | loss: 0.9963606
	speed: 0.0159s/iter; left time: 0.3817s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3392019271850586
Epoch: 8, Steps: 123 | Train Loss: 0.9963606 Vali Loss: 0.6433190 Best vali loss: 0.6414615

best validation loss 0.6414614907573186

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043671913006, 'e_layers': 4, 'learning_rate': 0.0001190548855, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4160932
	speed: 0.0179s/iter; left time: 138.5398s
	iters: 200, epoch: 1 | loss: 1.1741896
	speed: 0.0104s/iter; left time: 79.6971s
	iters: 300, epoch: 1 | loss: 0.4190616
	speed: 0.0115s/iter; left time: 86.6401s
	iters: 400, epoch: 1 | loss: 0.5633268
	speed: 0.0107s/iter; left time: 79.7429s
	iters: 500, epoch: 1 | loss: 0.8592492
	speed: 0.0111s/iter; left time: 81.7404s
	iters: 600, epoch: 1 | loss: 0.9287536
	speed: 0.0114s/iter; left time: 82.3904s
	iters: 700, epoch: 1 | loss: 0.8603289
	speed: 0.0112s/iter; left time: 80.1886s
	iters: 800, epoch: 1 | loss: 0.7517294
	speed: 0.0116s/iter; left time: 81.3696s
	iters: 900, epoch: 1 | loss: 0.8439222
	speed: 0.0104s/iter; left time: 72.0547s
Updating learning rate to 0.0001190548855
Validation loss decreased (inf --> 0.6137).  Saving model state dict ...
Epoch: 1 cost time: 11.118581533432007
Epoch: 1, Steps: 979 | Train Loss: 0.7574060 Vali Loss: 0.6136855 Best vali loss: 0.6136855
	iters: 100, epoch: 2 | loss: 0.3181627
	speed: 0.0334s/iter; left time: 225.5976s
	iters: 200, epoch: 2 | loss: 1.7162772
	speed: 0.0116s/iter; left time: 77.0481s
	iters: 300, epoch: 2 | loss: 0.8730729
	speed: 0.0119s/iter; left time: 77.6993s
	iters: 400, epoch: 2 | loss: 0.4795048
	speed: 0.0110s/iter; left time: 71.1323s
	iters: 500, epoch: 2 | loss: 0.5681931
	speed: 0.0107s/iter; left time: 68.2697s
	iters: 600, epoch: 2 | loss: 1.6461833
	speed: 0.0105s/iter; left time: 65.6654s
	iters: 700, epoch: 2 | loss: 0.3116154
	speed: 0.0109s/iter; left time: 67.2286s
	iters: 800, epoch: 2 | loss: 0.3615916
	speed: 0.0133s/iter; left time: 80.2671s
	iters: 900, epoch: 2 | loss: 0.4837853
	speed: 0.0132s/iter; left time: 78.3628s
Updating learning rate to 5.952744275e-05
Epoch: 2 cost time: 11.604359865188599
Epoch: 2, Steps: 979 | Train Loss: 0.7509318 Vali Loss: 0.6295431 Best vali loss: 0.6136855
	iters: 100, epoch: 3 | loss: 0.5706865
	speed: 0.0564s/iter; left time: 325.7911s
	iters: 200, epoch: 3 | loss: 0.5746168
	speed: 0.0111s/iter; left time: 62.7206s
	iters: 300, epoch: 3 | loss: 0.9136745
	speed: 0.0109s/iter; left time: 60.5811s
	iters: 400, epoch: 3 | loss: 0.4780867
	speed: 0.0103s/iter; left time: 56.3491s
	iters: 500, epoch: 3 | loss: 0.6262116
	speed: 0.0095s/iter; left time: 50.9135s
	iters: 600, epoch: 3 | loss: 0.2446809
	speed: 0.0080s/iter; left time: 42.4169s
	iters: 700, epoch: 3 | loss: 0.3811621
	speed: 0.0111s/iter; left time: 57.2440s
	iters: 800, epoch: 3 | loss: 0.5380313
	speed: 0.0123s/iter; left time: 62.4608s
	iters: 900, epoch: 3 | loss: 0.5049160
	speed: 0.0127s/iter; left time: 63.0058s
Updating learning rate to 2.9763721375e-05
Epoch: 3 cost time: 10.722806692123413
Epoch: 3, Steps: 979 | Train Loss: 0.5368963 Vali Loss: 0.6265825 Best vali loss: 0.6136855
	iters: 100, epoch: 4 | loss: 0.4102056
	speed: 0.0516s/iter; left time: 247.3854s
	iters: 200, epoch: 4 | loss: 0.3657824
	speed: 0.0117s/iter; left time: 55.0851s
	iters: 300, epoch: 4 | loss: 1.1701795
	speed: 0.0143s/iter; left time: 65.6123s
	iters: 400, epoch: 4 | loss: 0.5359754
	speed: 0.0128s/iter; left time: 57.6813s
	iters: 500, epoch: 4 | loss: 0.4859429
	speed: 0.0096s/iter; left time: 42.1935s
	iters: 600, epoch: 4 | loss: 0.6610137
	speed: 0.0092s/iter; left time: 39.5954s
	iters: 700, epoch: 4 | loss: 0.4777263
	speed: 0.0113s/iter; left time: 47.4627s
	iters: 800, epoch: 4 | loss: 0.5506133
	speed: 0.0120s/iter; left time: 49.0198s
	iters: 900, epoch: 4 | loss: 0.9580975
	speed: 0.0121s/iter; left time: 48.2191s
Updating learning rate to 1.48818606875e-05
Validation loss decreased (0.6137 --> 0.5741).  Saving model state dict ...
Epoch: 4 cost time: 11.50682520866394
Epoch: 4, Steps: 979 | Train Loss: 0.6239485 Vali Loss: 0.5740950 Best vali loss: 0.5740950
	iters: 100, epoch: 5 | loss: 0.6780312
	speed: 0.0460s/iter; left time: 175.6369s
	iters: 200, epoch: 5 | loss: 0.2151877
	speed: 0.0114s/iter; left time: 42.3863s
	iters: 300, epoch: 5 | loss: 0.8964558
	speed: 0.0116s/iter; left time: 41.9085s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0019798308604, 'e_layers': 3, 'learning_rate': 0.0003451809696, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1657153
	speed: 0.0142s/iter; left time: 109.6158s
	iters: 200, epoch: 1 | loss: 1.1389841
	speed: 0.0117s/iter; left time: 89.2727s
	iters: 300, epoch: 1 | loss: 1.4603086
	speed: 0.0105s/iter; left time: 79.3000s
	iters: 400, epoch: 1 | loss: 1.3573467
	speed: 0.0100s/iter; left time: 74.0893s
	iters: 500, epoch: 1 | loss: 1.0299987
	speed: 0.0101s/iter; left time: 74.2180s
	iters: 600, epoch: 1 | loss: 0.5015808
	speed: 0.0102s/iter; left time: 73.7868s
	iters: 700, epoch: 1 | loss: 0.4898244
	speed: 0.0095s/iter; left time: 67.5574s
	iters: 800, epoch: 1 | loss: 1.1067208
	speed: 0.0109s/iter; left time: 76.6311s
	iters: 900, epoch: 1 | loss: 1.7362834
	speed: 0.0119s/iter; left time: 82.3276s
Updating learning rate to 0.00033204330121292035
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 10.146918058395386
Epoch: 1, Steps: 979 | Train Loss: 1.1096403 Vali Loss: 0.6098663 Best vali loss: 0.6098663
	iters: 100, epoch: 2 | loss: 0.7659853
	speed: 0.0389s/iter; left time: 263.0027s
	iters: 200, epoch: 2 | loss: 1.2532072
	speed: 0.0103s/iter; left time: 68.4313s
	iters: 300, epoch: 2 | loss: 0.5927947
	speed: 0.0112s/iter; left time: 73.3024s
	iters: 400, epoch: 2 | loss: 1.4264005
	speed: 0.0115s/iter; left time: 74.3587s
	iters: 500, epoch: 2 | loss: 0.8178843
	speed: 0.0112s/iter; left time: 71.1394s
	iters: 600, epoch: 2 | loss: 1.2912992
	speed: 0.0116s/iter; left time: 72.3581s
	iters: 700, epoch: 2 | loss: 1.1650797
	speed: 0.0104s/iter; left time: 64.2865s
	iters: 800, epoch: 2 | loss: 0.3287370
	speed: 0.0104s/iter; left time: 62.7781s
	iters: 900, epoch: 2 | loss: 0.8386843
	speed: 0.0123s/iter; left time: 73.4951s
Updating learning rate to 0.00029463038697035375
Validation loss decreased (0.6099 --> 0.5984).  Saving model state dict ...
Epoch: 2 cost time: 10.65265965461731
Epoch: 2, Steps: 979 | Train Loss: 0.9422302 Vali Loss: 0.5984250 Best vali loss: 0.5984250
	iters: 100, epoch: 3 | loss: 1.0481869
	speed: 0.0353s/iter; left time: 203.6601s
	iters: 200, epoch: 3 | loss: 0.2334806
	speed: 0.0079s/iter; left time: 44.5522s
	iters: 300, epoch: 3 | loss: 0.7435219
	speed: 0.0058s/iter; left time: 32.4811s
	iters: 400, epoch: 3 | loss: 0.4977869
	speed: 0.0056s/iter; left time: 30.5064s
	iters: 500, epoch: 3 | loss: 0.5667987
	speed: 0.0081s/iter; left time: 43.3311s
	iters: 600, epoch: 3 | loss: 1.2704040
	speed: 0.0080s/iter; left time: 42.0746s
	iters: 700, epoch: 3 | loss: 2.5234821
	speed: 0.0078s/iter; left time: 40.3693s
	iters: 800, epoch: 3 | loss: 0.8016639
	speed: 0.0079s/iter; left time: 40.0744s
	iters: 900, epoch: 3 | loss: 1.0137322
	speed: 0.0080s/iter; left time: 39.9063s
Updating learning rate to 0.00023863800391681886
Validation loss decreased (0.5984 --> 0.5578).  Saving model state dict ...
Epoch: 3 cost time: 7.461934566497803
Epoch: 3, Steps: 979 | Train Loss: 0.9665619 Vali Loss: 0.5577859 Best vali loss: 0.5577859

best validation loss 0.5577858691963539

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0027202557372, 'e_layers': 2, 'learning_rate': 0.0002478228464, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8922732
	speed: 0.0154s/iter; left time: 13.6484s
Updating learning rate to 0.0002383906509388242
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 1.423377513885498
Epoch: 1, Steps: 123 | Train Loss: 0.8922732 Vali Loss: 0.6064282 Best vali loss: 0.6064282
	iters: 100, epoch: 2 | loss: 0.9517326
	speed: 0.0169s/iter; left time: 12.8591s
Updating learning rate to 0.00021153003081119604
Epoch: 2 cost time: 1.4042630195617676
Epoch: 2, Steps: 123 | Train Loss: 0.9517326 Vali Loss: 0.6193519 Best vali loss: 0.6064282
	iters: 100, epoch: 3 | loss: 0.7262213
	speed: 0.0135s/iter; left time: 8.6314s
Updating learning rate to 0.0001713302719394192
Validation loss decreased (0.6064 --> 0.5801).  Saving model state dict ...
Epoch: 3 cost time: 1.0859606266021729
Epoch: 3, Steps: 123 | Train Loss: 0.7262213 Vali Loss: 0.5801393 Best vali loss: 0.5801393

best validation loss 0.5801393381151432

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014883629299, 'e_layers': 2, 'learning_rate': 0.0001179211019, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3951053
	speed: 0.0142s/iter; left time: 109.5928s
	iters: 200, epoch: 1 | loss: 0.8972219
	speed: 0.0079s/iter; left time: 60.6176s
	iters: 300, epoch: 1 | loss: 0.9782903
	speed: 0.0054s/iter; left time: 41.0247s
	iters: 400, epoch: 1 | loss: 1.0313838
	speed: 0.0058s/iter; left time: 43.1457s
	iters: 500, epoch: 1 | loss: 0.6997905
	speed: 0.0082s/iter; left time: 60.3200s
	iters: 600, epoch: 1 | loss: 0.3273711
	speed: 0.0081s/iter; left time: 58.4724s
	iters: 700, epoch: 1 | loss: 1.9071710
	speed: 0.0084s/iter; left time: 59.7056s
	iters: 800, epoch: 1 | loss: 0.8325492
	speed: 0.0077s/iter; left time: 54.3479s
	iters: 900, epoch: 1 | loss: 1.2429849
	speed: 0.0085s/iter; left time: 58.7969s
Updating learning rate to 0.0001134329971982939
Validation loss decreased (inf --> 0.5616).  Saving model state dict ...
Epoch: 1 cost time: 7.6089794635772705
Epoch: 1, Steps: 979 | Train Loss: 0.9235409 Vali Loss: 0.5616143 Best vali loss: 0.5616143
	iters: 100, epoch: 2 | loss: 1.7212298
	speed: 0.0225s/iter; left time: 151.7239s
	iters: 200, epoch: 2 | loss: 0.7535381
	speed: 0.0077s/iter; left time: 51.1555s
	iters: 300, epoch: 2 | loss: 0.5504019
	speed: 0.0077s/iter; left time: 50.2388s
	iters: 400, epoch: 2 | loss: 0.8561823
	speed: 0.0077s/iter; left time: 49.6600s
	iters: 500, epoch: 2 | loss: 0.7025285
	speed: 0.0077s/iter; left time: 48.7321s
	iters: 600, epoch: 2 | loss: 0.5396388
	speed: 0.0081s/iter; left time: 50.3511s
	iters: 700, epoch: 2 | loss: 0.8297687
	speed: 0.0077s/iter; left time: 47.4141s
	iters: 800, epoch: 2 | loss: 0.3352858
	speed: 0.0078s/iter; left time: 47.0224s
	iters: 900, epoch: 2 | loss: 1.5490928
	speed: 0.0076s/iter; left time: 45.4185s
Updating learning rate to 0.00010065195634923994
Epoch: 2 cost time: 7.56222939491272
Epoch: 2, Steps: 979 | Train Loss: 0.8708518 Vali Loss: 0.5616489 Best vali loss: 0.5616143
	iters: 100, epoch: 3 | loss: 0.4996524
	speed: 0.0344s/iter; left time: 198.7021s
	iters: 200, epoch: 3 | loss: 0.3376467
	speed: 0.0094s/iter; left time: 53.4079s
	iters: 300, epoch: 3 | loss: 0.4841664
	speed: 0.0092s/iter; left time: 51.2573s
	iters: 400, epoch: 3 | loss: 0.4833498
	speed: 0.0093s/iter; left time: 50.9949s
	iters: 500, epoch: 3 | loss: 0.5840633
	speed: 0.0093s/iter; left time: 49.8238s
	iters: 600, epoch: 3 | loss: 0.2880362
	speed: 0.0101s/iter; left time: 53.4988s
	iters: 700, epoch: 3 | loss: 1.0586414
	speed: 0.0113s/iter; left time: 58.6657s
	iters: 800, epoch: 3 | loss: 1.0788330
	speed: 0.0105s/iter; left time: 53.2661s
	iters: 900, epoch: 3 | loss: 0.5375650
	speed: 0.0090s/iter; left time: 44.6938s
Updating learning rate to 8.152377696168276e-05
Epoch: 3 cost time: 9.727389335632324
Epoch: 3, Steps: 979 | Train Loss: 0.5946616 Vali Loss: 0.5640653 Best vali loss: 0.5616143

best validation loss 0.5616143322388147

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0019798308604, 'e_layers': 3, 'learning_rate': 0.0003451809696, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0773493
	speed: 0.0179s/iter; left time: 86.0608s
	iters: 200, epoch: 4 | loss: 0.9667417
	speed: 0.0101s/iter; left time: 47.5281s
	iters: 300, epoch: 4 | loss: 1.3431882
	speed: 0.0114s/iter; left time: 52.4756s
	iters: 400, epoch: 4 | loss: 1.3369223
	speed: 0.0108s/iter; left time: 48.6794s
	iters: 500, epoch: 4 | loss: 0.9478086
	speed: 0.0107s/iter; left time: 47.2491s
	iters: 600, epoch: 4 | loss: 0.4908370
	speed: 0.0114s/iter; left time: 48.9156s
	iters: 700, epoch: 4 | loss: 0.4209180
	speed: 0.0105s/iter; left time: 44.2083s
	iters: 800, epoch: 4 | loss: 0.4935340
	speed: 0.0082s/iter; left time: 33.3860s
	iters: 900, epoch: 4 | loss: 1.5533302
	speed: 0.0123s/iter; left time: 49.0821s
Updating learning rate to 0.0001725904848
Validation loss decreased (0.5578 --> 0.5446).  Saving model state dict ...
Epoch: 4 cost time: 10.950861692428589
Epoch: 4, Steps: 979 | Train Loss: 0.9589588 Vali Loss: 0.5445715 Best vali loss: 0.5445715
	iters: 100, epoch: 5 | loss: 0.7340306
	speed: 0.0581s/iter; left time: 221.7705s
	iters: 200, epoch: 5 | loss: 1.1156356
	speed: 0.0108s/iter; left time: 40.2738s
	iters: 300, epoch: 5 | loss: 0.5270466
	speed: 0.0122s/iter; left time: 44.2795s
	iters: 400, epoch: 5 | loss: 1.4183650
	speed: 0.0129s/iter; left time: 45.3356s
	iters: 500, epoch: 5 | loss: 0.7943817
	speed: 0.0130s/iter; left time: 44.4914s
	iters: 600, epoch: 5 | loss: 1.1370708
	speed: 0.0114s/iter; left time: 37.7468s
	iters: 700, epoch: 5 | loss: 1.0066323
	speed: 0.0119s/iter; left time: 38.2239s
	iters: 800, epoch: 5 | loss: 0.2962920
	speed: 0.0114s/iter; left time: 35.6342s
	iters: 900, epoch: 5 | loss: 0.7687081
	speed: 0.0115s/iter; left time: 34.5791s
Updating learning rate to 0.00010654296568318115
Epoch: 5 cost time: 11.459553241729736
Epoch: 5, Steps: 979 | Train Loss: 0.8664625 Vali Loss: 0.5640915 Best vali loss: 0.5445715
	iters: 100, epoch: 6 | loss: 0.9248794
	speed: 0.0546s/iter; left time: 154.9292s
	iters: 200, epoch: 6 | loss: 0.2285986
	speed: 0.0115s/iter; left time: 31.5426s
	iters: 300, epoch: 6 | loss: 0.6819286
	speed: 0.0107s/iter; left time: 28.3021s
	iters: 400, epoch: 6 | loss: 0.4596777
	speed: 0.0122s/iter; left time: 30.9674s
	iters: 500, epoch: 6 | loss: 0.4974906
	speed: 0.0133s/iter; left time: 32.4839s
	iters: 600, epoch: 6 | loss: 1.1118062
	speed: 0.0110s/iter; left time: 25.6054s
	iters: 700, epoch: 6 | loss: 1.9035966
	speed: 0.0113s/iter; left time: 25.3823s
	iters: 800, epoch: 6 | loss: 0.7880471
	speed: 0.0096s/iter; left time: 20.4913s
	iters: 900, epoch: 6 | loss: 0.7604928
	speed: 0.0082s/iter; left time: 16.7898s
Updating learning rate to 5.055058262964625e-05
Epoch: 6 cost time: 10.576743125915527
Epoch: 6, Steps: 979 | Train Loss: 0.8173908 Vali Loss: 0.5564766 Best vali loss: 0.5445715
	iters: 100, epoch: 7 | loss: 0.1840837
	speed: 0.0294s/iter; left time: 54.6985s
	iters: 200, epoch: 7 | loss: 0.3911058
	speed: 0.0082s/iter; left time: 14.3553s
	iters: 300, epoch: 7 | loss: 0.3075047
	speed: 0.0126s/iter; left time: 20.9798s
	iters: 400, epoch: 7 | loss: 0.5151361
	speed: 0.0141s/iter; left time: 22.0216s
	iters: 500, epoch: 7 | loss: 0.6943889
	speed: 0.0149s/iter; left time: 21.6821s
	iters: 600, epoch: 7 | loss: 0.6731254
	speed: 0.0139s/iter; left time: 18.8712s
	iters: 700, epoch: 7 | loss: 0.8809043
	speed: 0.0140s/iter; left time: 17.5670s
	iters: 800, epoch: 7 | loss: 0.4995520
	speed: 0.0105s/iter; left time: 12.1747s
	iters: 900, epoch: 7 | loss: 0.6644036
	speed: 0.0081s/iter; left time: 8.6089s
Updating learning rate to 1.3137668387079661e-05
Epoch: 7 cost time: 11.347095012664795
Epoch: 7, Steps: 979 | Train Loss: 0.5344672 Vali Loss: 0.5623417 Best vali loss: 0.5445715
	iters: 100, epoch: 8 | loss: 0.2793956
	speed: 0.0537s/iter; left time: 47.2579s
	iters: 200, epoch: 8 | loss: 0.2246248
	speed: 0.0095s/iter; left time: 7.4114s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010775968472, 'e_layers': 1, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8694467
	speed: 0.0197s/iter; left time: 17.4113s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.6662).  Saving model state dict ...
Epoch: 1 cost time: 1.979109287261963
Epoch: 1, Steps: 123 | Train Loss: 0.8694467 Vali Loss: 0.6662103 Best vali loss: 0.6662103
	iters: 100, epoch: 2 | loss: 1.4546868
	speed: 0.0252s/iter; left time: 19.2162s
Updating learning rate to 0.0026738530511141692
Validation loss decreased (0.6662 --> 0.6040).  Saving model state dict ...
Epoch: 2 cost time: 1.8990967273712158
Epoch: 2, Steps: 123 | Train Loss: 1.4546868 Vali Loss: 0.6039566 Best vali loss: 0.6039566
	iters: 100, epoch: 3 | loss: 1.0937930
	speed: 0.0122s/iter; left time: 7.7711s
Updating learning rate to 0.002165706536403478
Epoch: 3 cost time: 0.9887983798980713
Epoch: 3, Steps: 123 | Train Loss: 1.0937930 Vali Loss: 0.6680119 Best vali loss: 0.6039566
	iters: 100, epoch: 4 | loss: 0.7022797
	speed: 0.0136s/iter; left time: 6.9990s
Updating learning rate to 0.00156630685355
Epoch: 4 cost time: 1.074986219406128
Epoch: 4, Steps: 123 | Train Loss: 0.7022797 Vali Loss: 0.6298466 Best vali loss: 0.6039566
	iters: 100, epoch: 5 | loss: 0.8690345
	speed: 0.0261s/iter; left time: 10.2618s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 2.1445295810699463
Epoch: 5, Steps: 123 | Train Loss: 0.8690345 Vali Loss: 0.6213239 Best vali loss: 0.6039566
	iters: 100, epoch: 6 | loss: 0.5983612
	speed: 0.0327s/iter; left time: 8.8289s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 2.2190308570861816
Epoch: 6, Steps: 123 | Train Loss: 0.5983612 Vali Loss: 0.6081454 Best vali loss: 0.6039566
	iters: 100, epoch: 7 | loss: 0.7587295
	speed: 0.0310s/iter; left time: 4.5596s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 2.1377384662628174
Epoch: 7, Steps: 123 | Train Loss: 0.7587295 Vali Loss: 0.6084531 Best vali loss: 0.6039566
	iters: 100, epoch: 8 | loss: 0.8518889
	speed: 0.0148s/iter; left time: 0.3541s
Updating learning rate to 0.0
Validation loss decreased (0.6040 --> 0.6029).  Saving model state dict ...
Epoch: 8 cost time: 1.3714873790740967
Epoch: 8, Steps: 123 | Train Loss: 0.8518889 Vali Loss: 0.6029422 Best vali loss: 0.6029422

best validation loss 0.6029421646856479

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0031024789255, 'e_layers': 4, 'learning_rate': 0.0016584511036, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2695146
	speed: 0.0247s/iter; left time: 21.8368s
Updating learning rate to 0.0015953300669433977
Validation loss decreased (inf --> 0.6447).  Saving model state dict ...
Epoch: 1 cost time: 2.511603355407715
Epoch: 1, Steps: 123 | Train Loss: 1.2695146 Vali Loss: 0.6447190 Best vali loss: 0.6447190
	iters: 100, epoch: 2 | loss: 0.7854859
	speed: 0.0271s/iter; left time: 20.6220s
Updating learning rate to 0.0014155765626109366
Validation loss decreased (0.6447 --> 0.6352).  Saving model state dict ...
Epoch: 2 cost time: 1.7524309158325195
Epoch: 2, Steps: 123 | Train Loss: 0.7854859 Vali Loss: 0.6352499 Best vali loss: 0.6352499
	iters: 100, epoch: 3 | loss: 0.7526687
	speed: 0.0224s/iter; left time: 14.2918s
Updating learning rate to 0.0011465564321676595
Epoch: 3 cost time: 1.8578453063964844
Epoch: 3, Steps: 123 | Train Loss: 0.7526687 Vali Loss: 0.6377416 Best vali loss: 0.6352499
	iters: 100, epoch: 4 | loss: 0.8316380
	speed: 0.0221s/iter; left time: 11.3956s
Updating learning rate to 0.0008292255518
Validation loss decreased (0.6352 --> 0.6287).  Saving model state dict ...
Epoch: 4 cost time: 1.9638397693634033
Epoch: 4, Steps: 123 | Train Loss: 0.8316380 Vali Loss: 0.6286582 Best vali loss: 0.6286582
	iters: 100, epoch: 5 | loss: 0.9863913
	speed: 0.0222s/iter; left time: 8.7076s
Updating learning rate to 0.0005118946714323404
Validation loss decreased (0.6287 --> 0.6188).  Saving model state dict ...
Epoch: 5 cost time: 1.8303554058074951
Epoch: 5, Steps: 123 | Train Loss: 0.9863913 Vali Loss: 0.6187658 Best vali loss: 0.6187658
	iters: 100, epoch: 6 | loss: 1.0835481
	speed: 0.0204s/iter; left time: 5.5066s
Updating learning rate to 0.0002428745409890633
Epoch: 6 cost time: 1.8338353633880615
Epoch: 6, Steps: 123 | Train Loss: 1.0835481 Vali Loss: 0.6280797 Best vali loss: 0.6187658
	iters: 100, epoch: 7 | loss: 1.0668951
	speed: 0.0225s/iter; left time: 3.3014s
Updating learning rate to 6.312103665660221e-05
Validation loss decreased (0.6188 --> 0.6149).  Saving model state dict ...
Epoch: 7 cost time: 1.8623781204223633
Epoch: 7, Steps: 123 | Train Loss: 1.0668951 Vali Loss: 0.6148812 Best vali loss: 0.6148812
	iters: 100, epoch: 8 | loss: 0.9532161
	speed: 0.0231s/iter; left time: 0.5545s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8744959831237793
Epoch: 8, Steps: 123 | Train Loss: 0.9532161 Vali Loss: 0.6193432 Best vali loss: 0.6148812

best validation loss 0.6148811569648559

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.003513619288, 'e_layers': 2, 'learning_rate': 0.0014602270359, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014602270359
Validation loss decreased (inf --> 0.5959).  Saving model state dict ...
Epoch: 1 cost time: 1.0674471855163574
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5959123 Best vali loss: 0.5959123
Updating learning rate to 0.00073011351795
Epoch: 2 cost time: 0.601259708404541
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6098650 Best vali loss: 0.5959123
Updating learning rate to 0.000365056758975
Epoch: 3 cost time: 0.6114969253540039
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6193797 Best vali loss: 0.5959123

best validation loss 0.5959123189611493

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0033855970976, 'e_layers': 3, 'learning_rate': 0.0001366613199, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0573692
	speed: 0.0152s/iter; left time: 117.8558s
	iters: 200, epoch: 1 | loss: 1.2592039
	speed: 0.0093s/iter; left time: 70.8891s
	iters: 300, epoch: 1 | loss: 0.3585528
	speed: 0.0084s/iter; left time: 63.0749s
	iters: 400, epoch: 1 | loss: 1.8451940
	speed: 0.0063s/iter; left time: 46.5387s
	iters: 500, epoch: 1 | loss: 0.8263859
	speed: 0.0072s/iter; left time: 52.8573s
	iters: 600, epoch: 1 | loss: 1.0966245
	speed: 0.0076s/iter; left time: 55.1988s
	iters: 700, epoch: 1 | loss: 0.5356387
	speed: 0.0079s/iter; left time: 56.1504s
	iters: 800, epoch: 1 | loss: 0.7855014
	speed: 0.0078s/iter; left time: 55.1791s
	iters: 900, epoch: 1 | loss: 1.7802846
	speed: 0.0078s/iter; left time: 54.0581s
Updating learning rate to 0.0001366613199
Validation loss decreased (inf --> 0.6083).  Saving model state dict ...
Epoch: 1 cost time: 8.11610221862793
Epoch: 1, Steps: 979 | Train Loss: 1.0605283 Vali Loss: 0.6082749 Best vali loss: 0.6082749
	iters: 100, epoch: 2 | loss: 0.9741771
	speed: 0.0293s/iter; left time: 198.1903s
	iters: 200, epoch: 2 | loss: 0.8612521
	speed: 0.0080s/iter; left time: 52.9980s
	iters: 300, epoch: 2 | loss: 0.9943617
	speed: 0.0079s/iter; left time: 51.7933s
	iters: 400, epoch: 2 | loss: 0.6924479
	speed: 0.0080s/iter; left time: 51.8653s
	iters: 500, epoch: 2 | loss: 1.7127360
	speed: 0.0090s/iter; left time: 56.9840s
	iters: 600, epoch: 2 | loss: 1.6977179
	speed: 0.0076s/iter; left time: 47.3214s
	iters: 700, epoch: 2 | loss: 0.6335155
	speed: 0.0077s/iter; left time: 47.5345s
	iters: 800, epoch: 2 | loss: 0.3963865
	speed: 0.0078s/iter; left time: 47.4961s
	iters: 900, epoch: 2 | loss: 1.2775813
	speed: 0.0080s/iter; left time: 47.5467s
Updating learning rate to 6.833065995e-05
Epoch: 2 cost time: 7.849411487579346
Epoch: 2, Steps: 979 | Train Loss: 1.0266862 Vali Loss: 0.6091036 Best vali loss: 0.6082749
	iters: 100, epoch: 3 | loss: 0.7386587
	speed: 0.0300s/iter; left time: 173.1093s
	iters: 200, epoch: 3 | loss: 0.3735102
	speed: 0.0077s/iter; left time: 43.5433s
	iters: 300, epoch: 3 | loss: 1.3360983
	speed: 0.0079s/iter; left time: 43.8462s
	iters: 400, epoch: 3 | loss: 0.7986051
	speed: 0.0078s/iter; left time: 42.8905s
	iters: 500, epoch: 3 | loss: 0.5952860
	speed: 0.0084s/iter; left time: 44.8949s
	iters: 600, epoch: 3 | loss: 0.2872780
	speed: 0.0084s/iter; left time: 44.5339s
	iters: 700, epoch: 3 | loss: 1.6057256
	speed: 0.0078s/iter; left time: 40.3479s
	iters: 800, epoch: 3 | loss: 1.4603547
	speed: 0.0077s/iter; left time: 38.9871s
	iters: 900, epoch: 3 | loss: 0.6527810
	speed: 0.0078s/iter; left time: 38.5902s
Updating learning rate to 3.4165329975e-05
Epoch: 3 cost time: 7.780651092529297
Epoch: 3, Steps: 979 | Train Loss: 0.8720331 Vali Loss: 0.6098534 Best vali loss: 0.6082749

best validation loss 0.6082749335316804

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0017120270946, 'e_layers': 1, 'learning_rate': 0.0042858100912, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1591889
	speed: 0.0125s/iter; left time: 96.8855s
	iters: 200, epoch: 1 | loss: 0.3662097
	speed: 0.0060s/iter; left time: 45.4614s
	iters: 300, epoch: 1 | loss: 1.3311250
	speed: 0.0059s/iter; left time: 44.4833s
	iters: 400, epoch: 1 | loss: 0.2975560
	speed: 0.0056s/iter; left time: 41.8660s
	iters: 500, epoch: 1 | loss: 0.7936353
	speed: 0.0068s/iter; left time: 49.8320s
	iters: 600, epoch: 1 | loss: 1.0891370
	speed: 0.0056s/iter; left time: 40.4637s
	iters: 700, epoch: 1 | loss: 1.4136713
	speed: 0.0073s/iter; left time: 52.3552s
	iters: 800, epoch: 1 | loss: 0.9963557
	speed: 0.0089s/iter; left time: 62.5862s
	iters: 900, epoch: 1 | loss: 0.3859343
	speed: 0.0084s/iter; left time: 58.3853s
Updating learning rate to 0.0041226911573450055
Validation loss decreased (inf --> 0.6469).  Saving model state dict ...
Epoch: 1 cost time: 7.056894540786743
Epoch: 1, Steps: 979 | Train Loss: 0.8703126 Vali Loss: 0.6468648 Best vali loss: 0.6468648
	iters: 100, epoch: 2 | loss: 1.3117620
	speed: 0.0443s/iter; left time: 299.1387s
	iters: 200, epoch: 2 | loss: 1.4246749
	speed: 0.0077s/iter; left time: 51.1827s
	iters: 300, epoch: 2 | loss: 1.0802064
	speed: 0.0073s/iter; left time: 48.0306s
	iters: 400, epoch: 2 | loss: 0.7142659
	speed: 0.0078s/iter; left time: 50.4962s
	iters: 500, epoch: 2 | loss: 0.3553051
	speed: 0.0138s/iter; left time: 87.4587s
	iters: 600, epoch: 2 | loss: 1.1770252
	speed: 0.0119s/iter; left time: 74.5069s
	iters: 700, epoch: 2 | loss: 0.9035712
	speed: 0.0080s/iter; left time: 49.2151s
	iters: 800, epoch: 2 | loss: 0.6259103
	speed: 0.0074s/iter; left time: 45.0947s
	iters: 900, epoch: 2 | loss: 0.4804480
	speed: 0.0079s/iter; left time: 46.7795s
Updating learning rate to 0.0036581677347826275
Validation loss decreased (0.6469 --> 0.6414).  Saving model state dict ...
Epoch: 2 cost time: 8.784970045089722
Epoch: 2, Steps: 979 | Train Loss: 0.8970188 Vali Loss: 0.6413567 Best vali loss: 0.6413567
	iters: 100, epoch: 3 | loss: 0.4566951
	speed: 0.0268s/iter; left time: 155.0116s
	iters: 200, epoch: 3 | loss: 1.0309179
	speed: 0.0044s/iter; left time: 24.8825s
	iters: 300, epoch: 3 | loss: 1.1067526
	speed: 0.0065s/iter; left time: 36.4290s
	iters: 400, epoch: 3 | loss: 0.5900660
	speed: 0.0063s/iter; left time: 34.7197s
	iters: 500, epoch: 3 | loss: 1.0886151
	speed: 0.0066s/iter; left time: 35.7366s
	iters: 600, epoch: 3 | loss: 1.1541474
	speed: 0.0074s/iter; left time: 38.8759s
	iters: 700, epoch: 3 | loss: 0.4326778
	speed: 0.0069s/iter; left time: 35.5248s
	iters: 800, epoch: 3 | loss: 0.5728953
	speed: 0.0069s/iter; left time: 34.7879s
	iters: 900, epoch: 3 | loss: 0.6666409
	speed: 0.0071s/iter; left time: 35.1343s
Updating learning rate to 0.0029629593036826773
Validation loss decreased (0.6414 --> 0.6385).  Saving model state dict ...
Epoch: 3 cost time: 6.145910978317261
Epoch: 3, Steps: 979 | Train Loss: 0.7888231 Vali Loss: 0.6384601 Best vali loss: 0.6384601

best validation loss 0.6384600604065918

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.003513619288, 'e_layers': 2, 'learning_rate': 0.0014602270359, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001825283794875
Epoch: 4 cost time: 0.9408049583435059
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6196831 Best vali loss: 0.5959123
Updating learning rate to 9.126418974375e-05
Epoch: 5 cost time: 0.7024838924407959
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6121681 Best vali loss: 0.5959123
Updating learning rate to 4.5632094871875e-05
Epoch: 6 cost time: 0.6286592483520508
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6259845 Best vali loss: 0.5959123
Updating learning rate to 2.28160474359375e-05
Epoch: 7 cost time: 0.6908309459686279
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6171656 Best vali loss: 0.5959123
Updating learning rate to 1.140802371796875e-05
Epoch: 8 cost time: 0.6069202423095703
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6080120 Best vali loss: 0.5959123

best validation loss 0.5959123189611493

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0063474459393, 'e_layers': 4, 'learning_rate': 0.0023919052306, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0180242
	speed: 0.0185s/iter; left time: 16.3449s
Updating learning rate to 0.0023919052306
Validation loss decreased (inf --> 0.6571).  Saving model state dict ...
Epoch: 1 cost time: 1.853203296661377
Epoch: 1, Steps: 123 | Train Loss: 1.0180242 Vali Loss: 0.6571281 Best vali loss: 0.6571281
	iters: 100, epoch: 2 | loss: 0.9608348
	speed: 0.0195s/iter; left time: 14.8250s
Updating learning rate to 0.0011959526153
Validation loss decreased (0.6571 --> 0.6129).  Saving model state dict ...
Epoch: 2 cost time: 1.5710899829864502
Epoch: 2, Steps: 123 | Train Loss: 0.9608348 Vali Loss: 0.6129131 Best vali loss: 0.6129131
	iters: 100, epoch: 3 | loss: 1.2424935
	speed: 0.0160s/iter; left time: 10.2032s
Updating learning rate to 0.00059797630765
Epoch: 3 cost time: 1.1900148391723633
Epoch: 3, Steps: 123 | Train Loss: 1.2424935 Vali Loss: 0.6381397 Best vali loss: 0.6129131
	iters: 100, epoch: 4 | loss: 0.7694445
	speed: 0.0200s/iter; left time: 10.3142s
Updating learning rate to 0.000298988153825
Validation loss decreased (0.6129 --> 0.6105).  Saving model state dict ...
Epoch: 4 cost time: 2.195956230163574
Epoch: 4, Steps: 123 | Train Loss: 0.7694445 Vali Loss: 0.6104681 Best vali loss: 0.6104681
	iters: 100, epoch: 5 | loss: 0.7581502
	speed: 0.0331s/iter; left time: 12.9904s
Updating learning rate to 0.0001494940769125
Epoch: 5 cost time: 2.8161494731903076
Epoch: 5, Steps: 123 | Train Loss: 0.7581502 Vali Loss: 0.6162587 Best vali loss: 0.6104681
	iters: 100, epoch: 6 | loss: 0.7496352
	speed: 0.0304s/iter; left time: 8.2190s
Updating learning rate to 7.474703845625e-05
Epoch: 6 cost time: 2.326666831970215
Epoch: 6, Steps: 123 | Train Loss: 0.7496352 Vali Loss: 0.6217123 Best vali loss: 0.6104681
	iters: 100, epoch: 7 | loss: 0.7662303
	speed: 0.0199s/iter; left time: 2.9250s
Updating learning rate to 3.7373519228125e-05
Epoch: 7 cost time: 1.5283408164978027
Epoch: 7, Steps: 123 | Train Loss: 0.7662303 Vali Loss: 0.6179367 Best vali loss: 0.6104681
	iters: 100, epoch: 8 | loss: 0.8344336
	speed: 0.0141s/iter; left time: 0.3377s
Updating learning rate to 1.86867596140625e-05
Epoch: 8 cost time: 1.199794054031372
Epoch: 8, Steps: 123 | Train Loss: 0.8344336 Vali Loss: 0.6240217 Best vali loss: 0.6104681

best validation loss 0.6104681349804643

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0023490767589, 'e_layers': 3, 'learning_rate': 0.0046788824728, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.004500803112222859
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 1.0639748573303223
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6018967 Best vali loss: 0.6018967
Updating learning rate to 0.003993675998845881
Epoch: 2 cost time: 0.7308642864227295
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6230646 Best vali loss: 0.6018967
Updating learning rate to 0.003234706638561982
Epoch: 3 cost time: 0.5901563167572021
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6189727 Best vali loss: 0.6018967
Updating learning rate to 0.0023394412364
Epoch: 4 cost time: 0.6563177108764648
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6256993 Best vali loss: 0.6018967
Updating learning rate to 0.0014441758342380187
Epoch: 5 cost time: 0.7454681396484375
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6151621 Best vali loss: 0.6018967
Updating learning rate to 0.0006852064739541192
Epoch: 6 cost time: 0.659512996673584
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6445797 Best vali loss: 0.6018967
Updating learning rate to 0.00017807936057714137
Epoch: 7 cost time: 0.7764794826507568
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6419401 Best vali loss: 0.6018967
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6469686031341553
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6390543 Best vali loss: 0.6018967

best validation loss 0.6018967137933605

[INFO][smbo.py:320] Finished 600 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0046723325665, 'e_layers': 2, 'learning_rate': 0.0013135305907, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9342756
	speed: 0.0155s/iter; left time: 13.6856s
Updating learning rate to 0.0013135305907
Validation loss decreased (inf --> 0.6134).  Saving model state dict ...
Epoch: 1 cost time: 1.4523427486419678
Epoch: 1, Steps: 123 | Train Loss: 0.9342756 Vali Loss: 0.6134396 Best vali loss: 0.6134396
	iters: 100, epoch: 2 | loss: 1.0770760
	speed: 0.0121s/iter; left time: 9.2044s
Updating learning rate to 0.00065676529535
Epoch: 2 cost time: 0.8718652725219727
Epoch: 2, Steps: 123 | Train Loss: 1.0770760 Vali Loss: 0.6404289 Best vali loss: 0.6134396
	iters: 100, epoch: 3 | loss: 0.6906430
	speed: 0.0093s/iter; left time: 5.9438s
Updating learning rate to 0.000328382647675
Epoch: 3 cost time: 0.7545943260192871
Epoch: 3, Steps: 123 | Train Loss: 0.6906430 Vali Loss: 0.6213611 Best vali loss: 0.6134396

best validation loss 0.6134396110183384

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0041191772107, 'e_layers': 4, 'learning_rate': 0.0002544936624, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3818399
	speed: 0.0174s/iter; left time: 66.5470s
	iters: 200, epoch: 1 | loss: 0.3064724
	speed: 0.0118s/iter; left time: 43.7846s
	iters: 300, epoch: 1 | loss: 1.4498062
	speed: 0.0119s/iter; left time: 43.1689s
	iters: 400, epoch: 1 | loss: 0.4152468
	speed: 0.0113s/iter; left time: 39.7155s
Updating learning rate to 0.00024480757412259857
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 6.084242820739746
Epoch: 1, Steps: 490 | Train Loss: 0.6383413 Vali Loss: 0.6033482 Best vali loss: 0.6033482
	iters: 100, epoch: 2 | loss: 0.5928801
	speed: 0.0328s/iter; left time: 109.2520s
	iters: 200, epoch: 2 | loss: 0.9740095
	speed: 0.0105s/iter; left time: 33.9924s
	iters: 300, epoch: 2 | loss: 0.6697187
	speed: 0.0106s/iter; left time: 33.2359s
	iters: 400, epoch: 2 | loss: 0.3232423
	speed: 0.0116s/iter; left time: 35.0972s
Updating learning rate to 0.00021722392842601993
Validation loss decreased (0.6033 --> 0.5696).  Saving model state dict ...
Epoch: 2 cost time: 5.501882791519165
Epoch: 2, Steps: 490 | Train Loss: 0.6399627 Vali Loss: 0.5695855 Best vali loss: 0.5695855
	iters: 100, epoch: 3 | loss: 0.7857319
	speed: 0.0295s/iter; left time: 83.7553s
	iters: 200, epoch: 3 | loss: 0.6854661
	speed: 0.0098s/iter; left time: 26.9235s
	iters: 300, epoch: 3 | loss: 0.7790146
	speed: 0.0072s/iter; left time: 19.0828s
	iters: 400, epoch: 3 | loss: 0.8236875
	speed: 0.0106s/iter; left time: 27.0367s
Updating learning rate to 0.0001759420853211972
Validation loss decreased (0.5696 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 5.01862096786499
Epoch: 3, Steps: 490 | Train Loss: 0.7684750 Vali Loss: 0.5537762 Best vali loss: 0.5537762

best validation loss 0.5537761866301643

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012534952035, 'e_layers': 3, 'learning_rate': 0.0004733979271, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5373241
	speed: 0.0166s/iter; left time: 128.6051s
	iters: 200, epoch: 1 | loss: 0.2638959
	speed: 0.0103s/iter; left time: 78.4750s
	iters: 300, epoch: 1 | loss: 0.6381463
	speed: 0.0097s/iter; left time: 73.1130s
	iters: 400, epoch: 1 | loss: 0.4008002
	speed: 0.0091s/iter; left time: 67.6660s
	iters: 500, epoch: 1 | loss: 0.4726175
	speed: 0.0102s/iter; left time: 74.8299s
	iters: 600, epoch: 1 | loss: 1.5405686
	speed: 0.0105s/iter; left time: 75.7171s
	iters: 700, epoch: 1 | loss: 0.2807026
	speed: 0.0102s/iter; left time: 72.8283s
	iters: 800, epoch: 1 | loss: 1.1197413
	speed: 0.0095s/iter; left time: 67.1525s
	iters: 900, epoch: 1 | loss: 1.2047210
	speed: 0.0086s/iter; left time: 59.7241s
Updating learning rate to 0.0004733979271
Validation loss decreased (inf --> 0.6109).  Saving model state dict ...
Epoch: 1 cost time: 9.899715185165405
Epoch: 1, Steps: 979 | Train Loss: 0.7176131 Vali Loss: 0.6109179 Best vali loss: 0.6109179
	iters: 100, epoch: 2 | loss: 0.6975893
	speed: 0.0302s/iter; left time: 203.8472s
	iters: 200, epoch: 2 | loss: 0.4651168
	speed: 0.0101s/iter; left time: 67.2635s
	iters: 300, epoch: 2 | loss: 0.5857972
	speed: 0.0104s/iter; left time: 68.2747s
	iters: 400, epoch: 2 | loss: 0.6494108
	speed: 0.0102s/iter; left time: 66.1109s
	iters: 500, epoch: 2 | loss: 0.7338052
	speed: 0.0103s/iter; left time: 65.2309s
	iters: 600, epoch: 2 | loss: 0.4915046
	speed: 0.0096s/iter; left time: 60.1255s
	iters: 700, epoch: 2 | loss: 1.4523386
	speed: 0.0091s/iter; left time: 56.1750s
	iters: 800, epoch: 2 | loss: 0.7989810
	speed: 0.0105s/iter; left time: 63.2698s
	iters: 900, epoch: 2 | loss: 0.6431936
	speed: 0.0110s/iter; left time: 65.5039s
Updating learning rate to 0.00023669896355
Epoch: 2 cost time: 10.092896223068237
Epoch: 2, Steps: 979 | Train Loss: 0.7241930 Vali Loss: 0.6193695 Best vali loss: 0.6109179
	iters: 100, epoch: 3 | loss: 0.8964981
	speed: 0.0322s/iter; left time: 185.7082s
	iters: 200, epoch: 3 | loss: 1.2397467
	speed: 0.0093s/iter; left time: 52.7367s
	iters: 300, epoch: 3 | loss: 1.0736755
	speed: 0.0099s/iter; left time: 55.0226s
	iters: 400, epoch: 3 | loss: 0.3223322
	speed: 0.0103s/iter; left time: 56.6634s
	iters: 500, epoch: 3 | loss: 0.8966556
	speed: 0.0113s/iter; left time: 60.9167s
	iters: 600, epoch: 3 | loss: 0.5906203
	speed: 0.0108s/iter; left time: 57.1458s
	iters: 700, epoch: 3 | loss: 0.7701553
	speed: 0.0106s/iter; left time: 54.8507s
	iters: 800, epoch: 3 | loss: 0.7025491
	speed: 0.0105s/iter; left time: 53.0643s
	iters: 900, epoch: 3 | loss: 0.8929804
	speed: 0.0094s/iter; left time: 46.8275s
Updating learning rate to 0.000118349481775
Validation loss decreased (0.6109 --> 0.6065).  Saving model state dict ...
Epoch: 3 cost time: 10.025208234786987
Epoch: 3, Steps: 979 | Train Loss: 0.8205792 Vali Loss: 0.6065234 Best vali loss: 0.6065234

best validation loss 0.6065234103753356

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0041191772107, 'e_layers': 4, 'learning_rate': 0.0002544936624, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3055434
	speed: 0.0179s/iter; left time: 42.0438s
	iters: 200, epoch: 4 | loss: 0.2525865
	speed: 0.0123s/iter; left time: 27.7136s
	iters: 300, epoch: 4 | loss: 1.2688186
	speed: 0.0103s/iter; left time: 22.1218s
	iters: 400, epoch: 4 | loss: 0.4026045
	speed: 0.0109s/iter; left time: 22.3825s
Updating learning rate to 0.0001272468312
Validation loss decreased (0.5538 --> 0.5401).  Saving model state dict ...
Epoch: 4 cost time: 6.1100335121154785
Epoch: 4, Steps: 490 | Train Loss: 0.5573882 Vali Loss: 0.5400919 Best vali loss: 0.5400919
	iters: 100, epoch: 5 | loss: 0.4758312
	speed: 0.0382s/iter; left time: 71.1241s
	iters: 200, epoch: 5 | loss: 0.8074169
	speed: 0.0152s/iter; left time: 26.7360s
	iters: 300, epoch: 5 | loss: 0.5826551
	speed: 0.0155s/iter; left time: 25.8167s
	iters: 400, epoch: 5 | loss: 0.2916340
	speed: 0.0147s/iter; left time: 23.0047s
Updating learning rate to 7.855157707880281e-05
Validation loss decreased (0.5401 --> 0.5382).  Saving model state dict ...
Epoch: 5 cost time: 7.429625034332275
Epoch: 5, Steps: 490 | Train Loss: 0.5393843 Vali Loss: 0.5382235 Best vali loss: 0.5382235
	iters: 100, epoch: 6 | loss: 0.7392826
	speed: 0.0363s/iter; left time: 49.8199s
	iters: 200, epoch: 6 | loss: 0.6550896
	speed: 0.0142s/iter; left time: 18.1035s
	iters: 300, epoch: 6 | loss: 0.6884281
	speed: 0.0155s/iter; left time: 18.1342s
	iters: 400, epoch: 6 | loss: 0.7674496
	speed: 0.0140s/iter; left time: 15.0417s
Updating learning rate to 3.7269733973980056e-05
Epoch: 6 cost time: 6.67126727104187
Epoch: 6, Steps: 490 | Train Loss: 0.7125625 Vali Loss: 0.5481715 Best vali loss: 0.5382235
	iters: 100, epoch: 7 | loss: 0.8830829
	speed: 0.0280s/iter; left time: 24.6866s
	iters: 200, epoch: 7 | loss: 1.0291717
	speed: 0.0123s/iter; left time: 9.6212s
	iters: 300, epoch: 7 | loss: 0.4894868
	speed: 0.0133s/iter; left time: 9.0526s
	iters: 400, epoch: 7 | loss: 0.8262193
	speed: 0.0130s/iter; left time: 7.5436s
Updating learning rate to 9.686088277401384e-06
Epoch: 7 cost time: 6.178532838821411
Epoch: 7, Steps: 490 | Train Loss: 0.8069902 Vali Loss: 0.5453196 Best vali loss: 0.5382235
	iters: 100, epoch: 8 | loss: 0.6253916
	speed: 0.0328s/iter; left time: 12.8066s
	iters: 200, epoch: 8 | loss: 1.0198238
	speed: 0.0086s/iter; left time: 2.5103s
	iters: 300, epoch: 8 | loss: 0.6369060
	speed: 0.0101s/iter; left time: 1.9341s
	iters: 400, epoch: 8 | loss: 1.0753694
	speed: 0.0090s/iter; left time: 0.8171s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.677116394042969
Epoch: 8, Steps: 490 | Train Loss: 0.8393727 Vali Loss: 0.5447272 Best vali loss: 0.5382235

best validation loss 0.5382234637575092

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0037946543573, 'e_layers': 3, 'learning_rate': 0.000597159767, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7764881
	speed: 0.0161s/iter; left time: 61.5350s
	iters: 200, epoch: 1 | loss: 0.8747441
	speed: 0.0079s/iter; left time: 29.5268s
	iters: 300, epoch: 1 | loss: 0.7130085
	speed: 0.0083s/iter; left time: 29.9959s
	iters: 400, epoch: 1 | loss: 0.9791493
	speed: 0.0093s/iter; left time: 32.5935s
Updating learning rate to 0.000597159767
Validation loss decreased (inf --> 0.6084).  Saving model state dict ...
Epoch: 1 cost time: 4.647332191467285
Epoch: 1, Steps: 490 | Train Loss: 0.8358475 Vali Loss: 0.6083926 Best vali loss: 0.6083926
	iters: 100, epoch: 2 | loss: 0.5786219
	speed: 0.0235s/iter; left time: 78.4081s
	iters: 200, epoch: 2 | loss: 0.6015411
	speed: 0.0095s/iter; left time: 30.8495s
	iters: 300, epoch: 2 | loss: 0.8920360
	speed: 0.0085s/iter; left time: 26.6010s
	iters: 400, epoch: 2 | loss: 1.0374485
	speed: 0.0082s/iter; left time: 24.7500s
Updating learning rate to 0.0002985798835
Epoch: 2 cost time: 4.303014039993286
Epoch: 2, Steps: 490 | Train Loss: 0.7774119 Vali Loss: 0.6091153 Best vali loss: 0.6083926
	iters: 100, epoch: 3 | loss: 1.0091807
	speed: 0.0201s/iter; left time: 57.2185s
	iters: 200, epoch: 3 | loss: 0.7840288
	speed: 0.0071s/iter; left time: 19.5790s
	iters: 300, epoch: 3 | loss: 0.8172812
	speed: 0.0071s/iter; left time: 18.8714s
	iters: 400, epoch: 3 | loss: 0.8954301
	speed: 0.0071s/iter; left time: 18.0736s
Updating learning rate to 0.00014928994175
Epoch: 3 cost time: 3.554682731628418
Epoch: 3, Steps: 490 | Train Loss: 0.8764802 Vali Loss: 0.6095515 Best vali loss: 0.6083926
	iters: 100, epoch: 4 | loss: 1.2173966
	speed: 0.0195s/iter; left time: 45.7820s
	iters: 200, epoch: 4 | loss: 1.0566766
	speed: 0.0068s/iter; left time: 15.3316s
	iters: 300, epoch: 4 | loss: 0.6715301
	speed: 0.0059s/iter; left time: 12.7563s
	iters: 400, epoch: 4 | loss: 0.5258307
	speed: 0.0055s/iter; left time: 11.2393s
Updating learning rate to 7.4644970875e-05
Validation loss decreased (0.6084 --> 0.6074).  Saving model state dict ...
Epoch: 4 cost time: 3.3513760566711426
Epoch: 4, Steps: 490 | Train Loss: 0.8678585 Vali Loss: 0.6073874 Best vali loss: 0.6073874
	iters: 100, epoch: 5 | loss: 0.6542623
	speed: 0.0270s/iter; left time: 50.3122s
	iters: 200, epoch: 5 | loss: 0.7968115
	speed: 0.0091s/iter; left time: 16.0336s
	iters: 300, epoch: 5 | loss: 1.0025635
	speed: 0.0133s/iter; left time: 22.0402s
	iters: 400, epoch: 5 | loss: 0.9632720
	speed: 0.0142s/iter; left time: 22.2362s
Updating learning rate to 3.73224854375e-05
Validation loss decreased (0.6074 --> 0.6038).  Saving model state dict ...
Epoch: 5 cost time: 5.615602016448975
Epoch: 5, Steps: 490 | Train Loss: 0.8542273 Vali Loss: 0.6038358 Best vali loss: 0.6038358
	iters: 100, epoch: 6 | loss: 0.5173158
	speed: 0.0296s/iter; left time: 40.5185s
	iters: 200, epoch: 6 | loss: 0.8924965
	speed: 0.0107s/iter; left time: 13.6256s
	iters: 300, epoch: 6 | loss: 1.0545192
	speed: 0.0079s/iter; left time: 9.2944s
	iters: 400, epoch: 6 | loss: 0.5910468
	speed: 0.0086s/iter; left time: 9.2475s
Updating learning rate to 1.866124271875e-05
Validation loss decreased (0.6038 --> 0.6031).  Saving model state dict ...
Epoch: 6 cost time: 4.7762956619262695
Epoch: 6, Steps: 490 | Train Loss: 0.7638445 Vali Loss: 0.6030882 Best vali loss: 0.6030882
	iters: 100, epoch: 7 | loss: 0.5099263
	speed: 0.0252s/iter; left time: 22.1612s
	iters: 200, epoch: 7 | loss: 0.5548422
	speed: 0.0051s/iter; left time: 4.0097s
	iters: 300, epoch: 7 | loss: 1.2021779
	speed: 0.0078s/iter; left time: 5.3395s
	iters: 400, epoch: 7 | loss: 0.5005742
	speed: 0.0093s/iter; left time: 5.4072s
Updating learning rate to 9.330621359375e-06
Validation loss decreased (0.6031 --> 0.6011).  Saving model state dict ...
Epoch: 7 cost time: 3.9447360038757324
Epoch: 7, Steps: 490 | Train Loss: 0.6918802 Vali Loss: 0.6011237 Best vali loss: 0.6011237
	iters: 100, epoch: 8 | loss: 1.2759842
	speed: 0.0269s/iter; left time: 10.5325s
	iters: 200, epoch: 8 | loss: 1.6928632
	speed: 0.0079s/iter; left time: 2.3073s
	iters: 300, epoch: 8 | loss: 0.5630809
	speed: 0.0064s/iter; left time: 1.2235s
	iters: 400, epoch: 8 | loss: 0.9980792
	speed: 0.0068s/iter; left time: 0.6161s
Updating learning rate to 4.6653106796875e-06
Epoch: 8 cost time: 3.634941816329956
Epoch: 8, Steps: 490 | Train Loss: 1.1325019 Vali Loss: 0.6019595 Best vali loss: 0.6011237

best validation loss 0.6011237391632279

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012227245979, 'e_layers': 4, 'learning_rate': 0.0010346098134, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0160940
	speed: 0.0167s/iter; left time: 63.9137s
	iters: 200, epoch: 1 | loss: 1.5430775
	speed: 0.0107s/iter; left time: 39.9988s
	iters: 300, epoch: 1 | loss: 1.4475847
	speed: 0.0098s/iter; left time: 35.5283s
	iters: 400, epoch: 1 | loss: 1.1423737
	speed: 0.0089s/iter; left time: 31.3752s
Updating learning rate to 0.0009952323220677908
Validation loss decreased (inf --> 0.6312).  Saving model state dict ...
Epoch: 1 cost time: 5.436168193817139
Epoch: 1, Steps: 490 | Train Loss: 1.2872825 Vali Loss: 0.6311875 Best vali loss: 0.6311875
	iters: 100, epoch: 2 | loss: 0.7638083
	speed: 0.0293s/iter; left time: 97.5419s
	iters: 200, epoch: 2 | loss: 0.8101817
	speed: 0.0076s/iter; left time: 24.6367s
	iters: 300, epoch: 2 | loss: 0.7247355
	speed: 0.0096s/iter; left time: 30.1249s
	iters: 400, epoch: 2 | loss: 0.7766494
	speed: 0.0113s/iter; left time: 34.3137s
Updating learning rate to 0.0008830947141686443
Validation loss decreased (0.6312 --> 0.6126).  Saving model state dict ...
Epoch: 2 cost time: 4.958316087722778
Epoch: 2, Steps: 490 | Train Loss: 0.7688437 Vali Loss: 0.6126108 Best vali loss: 0.6126108
	iters: 100, epoch: 3 | loss: 1.2733736
	speed: 0.0281s/iter; left time: 79.8081s
	iters: 200, epoch: 3 | loss: 0.5704971
	speed: 0.0113s/iter; left time: 30.9876s
	iters: 300, epoch: 3 | loss: 0.6742755
	speed: 0.0113s/iter; left time: 29.8482s
	iters: 400, epoch: 3 | loss: 1.4715248
	speed: 0.0112s/iter; left time: 28.3660s
Updating learning rate to 0.0007152689239752586
Epoch: 3 cost time: 5.113102197647095
Epoch: 3, Steps: 490 | Train Loss: 0.9974178 Vali Loss: 0.6330875 Best vali loss: 0.6126108
	iters: 100, epoch: 4 | loss: 0.8766532
	speed: 0.0223s/iter; left time: 52.3722s
	iters: 200, epoch: 4 | loss: 0.8776290
	speed: 0.0100s/iter; left time: 22.5284s
	iters: 300, epoch: 4 | loss: 0.7440821
	speed: 0.0134s/iter; left time: 28.8160s
	iters: 400, epoch: 4 | loss: 0.8362992
	speed: 0.0131s/iter; left time: 26.7904s
Updating learning rate to 0.0005173049067
Validation loss decreased (0.6126 --> 0.6046).  Saving model state dict ...
Epoch: 4 cost time: 5.962002754211426
Epoch: 4, Steps: 490 | Train Loss: 0.8336659 Vali Loss: 0.6045516 Best vali loss: 0.6045516
	iters: 100, epoch: 5 | loss: 1.2326949
	speed: 0.0364s/iter; left time: 67.6718s
	iters: 200, epoch: 5 | loss: 1.0304893
	speed: 0.0072s/iter; left time: 12.6336s
	iters: 300, epoch: 5 | loss: 1.1955200
	speed: 0.0108s/iter; left time: 17.9980s
	iters: 400, epoch: 5 | loss: 0.4810349
	speed: 0.0111s/iter; left time: 17.3609s
Updating learning rate to 0.00031934088942474153
Epoch: 5 cost time: 5.23424506187439
Epoch: 5, Steps: 490 | Train Loss: 0.9849348 Vali Loss: 0.6141834 Best vali loss: 0.6045516
	iters: 100, epoch: 6 | loss: 1.0207863
	speed: 0.0267s/iter; left time: 36.6067s
	iters: 200, epoch: 6 | loss: 1.0640342
	speed: 0.0111s/iter; left time: 14.1300s
	iters: 300, epoch: 6 | loss: 0.6078355
	speed: 0.0099s/iter; left time: 11.6466s
	iters: 400, epoch: 6 | loss: 0.7585723
	speed: 0.0089s/iter; left time: 9.4872s
Updating learning rate to 0.00015151509923135576
Epoch: 6 cost time: 4.805066823959351
Epoch: 6, Steps: 490 | Train Loss: 0.8628071 Vali Loss: 0.6207520 Best vali loss: 0.6045516
	iters: 100, epoch: 7 | loss: 0.8391377
	speed: 0.0231s/iter; left time: 20.3508s
	iters: 200, epoch: 7 | loss: 1.0756894
	speed: 0.0108s/iter; left time: 8.4115s
	iters: 300, epoch: 7 | loss: 1.0828887
	speed: 0.0100s/iter; left time: 6.8354s
	iters: 400, epoch: 7 | loss: 0.9801930
	speed: 0.0102s/iter; left time: 5.9048s
Updating learning rate to 3.93774913322092e-05
Epoch: 7 cost time: 4.953684568405151
Epoch: 7, Steps: 490 | Train Loss: 0.9944772 Vali Loss: 0.6179400 Best vali loss: 0.6045516
	iters: 100, epoch: 8 | loss: 0.8528452
	speed: 0.0266s/iter; left time: 10.4014s
	iters: 200, epoch: 8 | loss: 0.7753243
	speed: 0.0093s/iter; left time: 2.7102s
	iters: 300, epoch: 8 | loss: 0.5502340
	speed: 0.0103s/iter; left time: 1.9682s
	iters: 400, epoch: 8 | loss: 0.7802718
	speed: 0.0101s/iter; left time: 0.9179s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.898799657821655
Epoch: 8, Steps: 490 | Train Loss: 0.7396688 Vali Loss: 0.6322213 Best vali loss: 0.6045516

best validation loss 0.6045515960645257

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0018973779905, 'e_layers': 1, 'learning_rate': 0.0007567722941, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7773635
	speed: 0.0091s/iter; left time: 70.5394s
	iters: 200, epoch: 1 | loss: 1.1521302
	speed: 0.0033s/iter; left time: 25.3233s
	iters: 300, epoch: 1 | loss: 0.6901738
	speed: 0.0034s/iter; left time: 25.9718s
	iters: 400, epoch: 1 | loss: 0.5955684
	speed: 0.0061s/iter; left time: 45.7053s
	iters: 500, epoch: 1 | loss: 0.9382253
	speed: 0.0064s/iter; left time: 46.8859s
	iters: 600, epoch: 1 | loss: 0.9163034
	speed: 0.0056s/iter; left time: 40.4724s
	iters: 700, epoch: 1 | loss: 0.8394572
	speed: 0.0056s/iter; left time: 40.1976s
	iters: 800, epoch: 1 | loss: 0.5500822
	speed: 0.0058s/iter; left time: 41.0182s
	iters: 900, epoch: 1 | loss: 1.7883371
	speed: 0.0061s/iter; left time: 42.0285s
Updating learning rate to 0.0007567722941
Validation loss decreased (inf --> 0.6119).  Saving model state dict ...
Epoch: 1 cost time: 5.421014308929443
Epoch: 1, Steps: 979 | Train Loss: 0.9164046 Vali Loss: 0.6118929 Best vali loss: 0.6118929
	iters: 100, epoch: 2 | loss: 0.8637356
	speed: 0.0236s/iter; left time: 159.7236s
	iters: 200, epoch: 2 | loss: 1.1032232
	speed: 0.0053s/iter; left time: 35.5277s
	iters: 300, epoch: 2 | loss: 0.3588336
	speed: 0.0056s/iter; left time: 36.5818s
	iters: 400, epoch: 2 | loss: 0.2847727
	speed: 0.0056s/iter; left time: 35.8849s
	iters: 500, epoch: 2 | loss: 0.4807349
	speed: 0.0054s/iter; left time: 34.5754s
	iters: 600, epoch: 2 | loss: 0.6403779
	speed: 0.0044s/iter; left time: 27.3180s
	iters: 700, epoch: 2 | loss: 0.7115896
	speed: 0.0058s/iter; left time: 35.7400s
	iters: 800, epoch: 2 | loss: 0.3312283
	speed: 0.0057s/iter; left time: 34.8099s
	iters: 900, epoch: 2 | loss: 0.5480898
	speed: 0.0061s/iter; left time: 36.4046s
Updating learning rate to 0.00037838614705
Epoch: 2 cost time: 5.442211151123047
Epoch: 2, Steps: 979 | Train Loss: 0.5913984 Vali Loss: 0.6253291 Best vali loss: 0.6118929
	iters: 100, epoch: 3 | loss: 0.3358904
	speed: 0.0184s/iter; left time: 106.2360s
	iters: 200, epoch: 3 | loss: 0.7279829
	speed: 0.0035s/iter; left time: 20.0971s
	iters: 300, epoch: 3 | loss: 0.7310312
	speed: 0.0073s/iter; left time: 40.6241s
	iters: 400, epoch: 3 | loss: 0.3545497
	speed: 0.0073s/iter; left time: 39.9353s
	iters: 500, epoch: 3 | loss: 1.1639857
	speed: 0.0069s/iter; left time: 36.9743s
	iters: 600, epoch: 3 | loss: 0.3647510
	speed: 0.0076s/iter; left time: 40.2701s
	iters: 700, epoch: 3 | loss: 1.5176599
	speed: 0.0060s/iter; left time: 30.8924s
	iters: 800, epoch: 3 | loss: 1.0291597
	speed: 0.0079s/iter; left time: 39.8484s
	iters: 900, epoch: 3 | loss: 0.6809550
	speed: 0.0067s/iter; left time: 33.5774s
Updating learning rate to 0.000189193073525
Epoch: 3 cost time: 6.218418121337891
Epoch: 3, Steps: 979 | Train Loss: 0.7673295 Vali Loss: 0.6420362 Best vali loss: 0.6118929

best validation loss 0.6118929287878135

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0016850189265, 'e_layers': 4, 'learning_rate': 0.0006374455458, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5160219
	speed: 0.0221s/iter; left time: 84.5872s
	iters: 200, epoch: 1 | loss: 0.8281074
	speed: 0.0150s/iter; left time: 55.7064s
	iters: 300, epoch: 1 | loss: 0.9420641
	speed: 0.0154s/iter; left time: 55.6666s
	iters: 400, epoch: 1 | loss: 0.9804372
	speed: 0.0142s/iter; left time: 49.9548s
Updating learning rate to 0.000613184219327553
Validation loss decreased (inf --> 0.6432).  Saving model state dict ...
Epoch: 1 cost time: 7.70745062828064
Epoch: 1, Steps: 490 | Train Loss: 0.8166576 Vali Loss: 0.6431911 Best vali loss: 0.6431911
	iters: 100, epoch: 2 | loss: 1.0057217
	speed: 0.0318s/iter; left time: 106.0053s
	iters: 200, epoch: 2 | loss: 1.4328840
	speed: 0.0092s/iter; left time: 29.8838s
	iters: 300, epoch: 2 | loss: 0.7520022
	speed: 0.0101s/iter; left time: 31.7684s
	iters: 400, epoch: 2 | loss: 1.2944747
	speed: 0.0111s/iter; left time: 33.7703s
Updating learning rate to 0.00054409380693617
Epoch: 2 cost time: 4.996170997619629
Epoch: 2, Steps: 490 | Train Loss: 1.1212706 Vali Loss: 0.6538693 Best vali loss: 0.6431911
	iters: 100, epoch: 3 | loss: 1.2746640
	speed: 0.0286s/iter; left time: 81.1662s
	iters: 200, epoch: 3 | loss: 0.5555130
	speed: 0.0115s/iter; left time: 31.4958s
	iters: 300, epoch: 3 | loss: 1.1360084
	speed: 0.0115s/iter; left time: 30.4675s
	iters: 400, epoch: 3 | loss: 0.7981819
	speed: 0.0116s/iter; left time: 29.5655s
Updating learning rate to 0.000440692697606291
Validation loss decreased (0.6432 --> 0.6387).  Saving model state dict ...
Epoch: 3 cost time: 5.43071722984314
Epoch: 3, Steps: 490 | Train Loss: 0.9410918 Vali Loss: 0.6387419 Best vali loss: 0.6387419

best validation loss 0.6387418935774433

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0019391438008, 'e_layers': 3, 'learning_rate': 0.0004988908191, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7642784
	speed: 0.0134s/iter; left time: 24.9889s
	iters: 200, epoch: 1 | loss: 0.7187639
	speed: 0.0074s/iter; left time: 13.0160s
Updating learning rate to 0.0004988908191
Validation loss decreased (inf --> 0.6245).  Saving model state dict ...
Epoch: 1 cost time: 2.1100964546203613
Epoch: 1, Steps: 245 | Train Loss: 0.7415211 Vali Loss: 0.6244802 Best vali loss: 0.6244802
	iters: 100, epoch: 2 | loss: 0.6397359
	speed: 0.0139s/iter; left time: 22.4891s
	iters: 200, epoch: 2 | loss: 0.8146539
	speed: 0.0069s/iter; left time: 10.4768s
Updating learning rate to 0.00024944540955
Validation loss decreased (0.6245 --> 0.6025).  Saving model state dict ...
Epoch: 2 cost time: 1.767829179763794
Epoch: 2, Steps: 245 | Train Loss: 0.7271949 Vali Loss: 0.6024819 Best vali loss: 0.6024819
	iters: 100, epoch: 3 | loss: 0.7001536
	speed: 0.0138s/iter; left time: 18.8679s
	iters: 200, epoch: 3 | loss: 0.9945735
	speed: 0.0074s/iter; left time: 9.4662s
Updating learning rate to 0.000124722704775
Epoch: 3 cost time: 1.8665614128112793
Epoch: 3, Steps: 245 | Train Loss: 0.8473636 Vali Loss: 0.6113091 Best vali loss: 0.6024819

best validation loss 0.60248185412192

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0019391438008, 'e_layers': 3, 'learning_rate': 0.0004988908191, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7422150
	speed: 0.0140s/iter; left time: 15.7508s
	iters: 200, epoch: 4 | loss: 0.6896094
	speed: 0.0075s/iter; left time: 7.6448s
Updating learning rate to 6.23613523875e-05
Epoch: 4 cost time: 2.156320810317993
Epoch: 4, Steps: 245 | Train Loss: 0.7159122 Vali Loss: 0.6122226 Best vali loss: 0.6024819
	iters: 100, epoch: 5 | loss: 0.6208954
	speed: 0.0146s/iter; left time: 12.8208s
	iters: 200, epoch: 5 | loss: 0.7966903
	speed: 0.0079s/iter; left time: 6.1995s
Updating learning rate to 3.118067619375e-05
Epoch: 5 cost time: 1.9767017364501953
Epoch: 5, Steps: 245 | Train Loss: 0.7087928 Vali Loss: 0.6056440 Best vali loss: 0.6024819
	iters: 100, epoch: 6 | loss: 0.6489694
	speed: 0.0143s/iter; left time: 9.0941s
	iters: 200, epoch: 6 | loss: 0.9441028
	speed: 0.0069s/iter; left time: 3.7212s
Updating learning rate to 1.5590338096875e-05
Epoch: 6 cost time: 1.783400297164917
Epoch: 6, Steps: 245 | Train Loss: 0.7965361 Vali Loss: 0.6087092 Best vali loss: 0.6024819
	iters: 100, epoch: 7 | loss: 0.7403779
	speed: 0.0132s/iter; left time: 5.1717s
	iters: 200, epoch: 7 | loss: 0.5801950
	speed: 0.0074s/iter; left time: 2.1670s
Updating learning rate to 7.7951690484375e-06
Epoch: 7 cost time: 1.8123407363891602
Epoch: 7, Steps: 245 | Train Loss: 0.6602864 Vali Loss: 0.6060599 Best vali loss: 0.6024819
	iters: 100, epoch: 8 | loss: 0.7882126
	speed: 0.0140s/iter; left time: 2.0390s
	iters: 200, epoch: 8 | loss: 0.6589895
	speed: 0.0071s/iter; left time: 0.3265s
Updating learning rate to 3.89758452421875e-06
Epoch: 8 cost time: 1.7420544624328613
Epoch: 8, Steps: 245 | Train Loss: 0.7236011 Vali Loss: 0.6060875 Best vali loss: 0.6024819

best validation loss 0.60248185412192

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0014853479781, 'e_layers': 4, 'learning_rate': 0.0003925017025, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0221703
	speed: 0.0146s/iter; left time: 55.6753s
	iters: 200, epoch: 1 | loss: 1.3954725
	speed: 0.0083s/iter; left time: 30.9855s
	iters: 300, epoch: 1 | loss: 1.4198316
	speed: 0.0083s/iter; left time: 30.1319s
	iters: 400, epoch: 1 | loss: 1.1350933
	speed: 0.0080s/iter; left time: 28.0961s
Updating learning rate to 0.0003925017025
Validation loss decreased (inf --> 0.6148).  Saving model state dict ...
Epoch: 1 cost time: 4.336931228637695
Epoch: 1, Steps: 490 | Train Loss: 1.2431419 Vali Loss: 0.6148115 Best vali loss: 0.6148115
	iters: 100, epoch: 2 | loss: 0.5182829
	speed: 0.0222s/iter; left time: 73.8334s
	iters: 200, epoch: 2 | loss: 0.8542703
	speed: 0.0088s/iter; left time: 28.4651s
	iters: 300, epoch: 2 | loss: 0.6744816
	speed: 0.0089s/iter; left time: 28.0044s
	iters: 400, epoch: 2 | loss: 0.6777079
	speed: 0.0087s/iter; left time: 26.4956s
Updating learning rate to 0.00019625085125
Validation loss decreased (0.6148 --> 0.5764).  Saving model state dict ...
Epoch: 2 cost time: 4.350336790084839
Epoch: 2, Steps: 490 | Train Loss: 0.6811857 Vali Loss: 0.5763905 Best vali loss: 0.5763905
	iters: 100, epoch: 3 | loss: 0.9567104
	speed: 0.0225s/iter; left time: 63.9588s
	iters: 200, epoch: 3 | loss: 0.5305679
	speed: 0.0089s/iter; left time: 24.4985s
	iters: 300, epoch: 3 | loss: 0.6450469
	speed: 0.0092s/iter; left time: 24.1949s
	iters: 400, epoch: 3 | loss: 1.0947046
	speed: 0.0090s/iter; left time: 22.8256s
Updating learning rate to 9.8125425625e-05
Validation loss decreased (0.5764 --> 0.5518).  Saving model state dict ...
Epoch: 3 cost time: 4.4703240394592285
Epoch: 3, Steps: 490 | Train Loss: 0.8067575 Vali Loss: 0.5517841 Best vali loss: 0.5517841
	iters: 100, epoch: 4 | loss: 0.8115520
	speed: 0.0222s/iter; left time: 52.1959s
	iters: 200, epoch: 4 | loss: 0.5669621
	speed: 0.0093s/iter; left time: 20.9906s
	iters: 300, epoch: 4 | loss: 0.5235258
	speed: 0.0093s/iter; left time: 19.9756s
	iters: 400, epoch: 4 | loss: 0.6638157
	speed: 0.0094s/iter; left time: 19.2725s
Updating learning rate to 4.90627128125e-05
Validation loss decreased (0.5518 --> 0.5510).  Saving model state dict ...
Epoch: 4 cost time: 4.433181285858154
Epoch: 4, Steps: 490 | Train Loss: 0.6414639 Vali Loss: 0.5509950 Best vali loss: 0.5509950
	iters: 100, epoch: 5 | loss: 1.0993831
	speed: 0.0225s/iter; left time: 41.8690s
	iters: 200, epoch: 5 | loss: 0.9977630
	speed: 0.0076s/iter; left time: 13.3982s
	iters: 300, epoch: 5 | loss: 1.1148468
	speed: 0.0073s/iter; left time: 12.1544s
	iters: 400, epoch: 5 | loss: 0.3768339
	speed: 0.0087s/iter; left time: 13.6171s
Updating learning rate to 2.453135640625e-05
Epoch: 5 cost time: 4.055628776550293
Epoch: 5, Steps: 490 | Train Loss: 0.8972067 Vali Loss: 0.5513690 Best vali loss: 0.5509950
	iters: 100, epoch: 6 | loss: 0.9819379
	speed: 0.0231s/iter; left time: 31.6489s
	iters: 200, epoch: 6 | loss: 0.8357443
	speed: 0.0090s/iter; left time: 11.4653s
	iters: 300, epoch: 6 | loss: 0.3784926
	speed: 0.0088s/iter; left time: 10.3408s
	iters: 400, epoch: 6 | loss: 0.7347003
	speed: 0.0085s/iter; left time: 9.1518s
Updating learning rate to 1.2265678203125e-05
Epoch: 6 cost time: 4.259093284606934
Epoch: 6, Steps: 490 | Train Loss: 0.7327188 Vali Loss: 0.5522147 Best vali loss: 0.5509950
	iters: 100, epoch: 7 | loss: 0.7522072
	speed: 0.0233s/iter; left time: 20.5464s
	iters: 200, epoch: 7 | loss: 0.9744005
	speed: 0.0108s/iter; left time: 8.4309s
	iters: 300, epoch: 7 | loss: 0.9898073
	speed: 0.0108s/iter; left time: 7.3491s
	iters: 400, epoch: 7 | loss: 0.7901585
	speed: 0.0112s/iter; left time: 6.5249s
Updating learning rate to 6.1328391015625e-06
Epoch: 7 cost time: 5.402453899383545
Epoch: 7, Steps: 490 | Train Loss: 0.8766434 Vali Loss: 0.5529060 Best vali loss: 0.5509950
	iters: 100, epoch: 8 | loss: 0.8416144
	speed: 0.0293s/iter; left time: 11.4454s
	iters: 200, epoch: 8 | loss: 0.5795075
	speed: 0.0101s/iter; left time: 2.9411s
	iters: 300, epoch: 8 | loss: 0.4901247
	speed: 0.0095s/iter; left time: 1.8137s
	iters: 400, epoch: 8 | loss: 0.6969453
	speed: 0.0086s/iter; left time: 0.7794s
Updating learning rate to 3.06641955078125e-06
Epoch: 8 cost time: 4.858325719833374
Epoch: 8, Steps: 490 | Train Loss: 0.6520480 Vali Loss: 0.5516682 Best vali loss: 0.5509950

best validation loss 0.5509949520692291

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0081135440107, 'e_layers': 3, 'learning_rate': 0.0005801859378, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6854964
	speed: 0.0175s/iter; left time: 32.4815s
	iters: 200, epoch: 1 | loss: 0.7875945
	speed: 0.0109s/iter; left time: 19.1559s
Updating learning rate to 0.0005581039253921432
Validation loss decreased (inf --> 0.6396).  Saving model state dict ...
Epoch: 1 cost time: 3.0136303901672363
Epoch: 1, Steps: 245 | Train Loss: 0.7365454 Vali Loss: 0.6396000 Best vali loss: 0.6396000
	iters: 100, epoch: 2 | loss: 0.9598041
	speed: 0.0214s/iter; left time: 34.5505s
	iters: 200, epoch: 2 | loss: 0.8697703
	speed: 0.0105s/iter; left time: 15.9624s
Updating learning rate to 0.0004952196743837282
Validation loss decreased (0.6396 --> 0.6378).  Saving model state dict ...
Epoch: 2 cost time: 2.654716730117798
Epoch: 2, Steps: 245 | Train Loss: 0.9147872 Vali Loss: 0.6378250 Best vali loss: 0.6378250
	iters: 100, epoch: 3 | loss: 0.8411422
	speed: 0.0217s/iter; left time: 29.8051s
	iters: 200, epoch: 3 | loss: 0.9954562
	speed: 0.0094s/iter; left time: 12.0018s
Updating learning rate to 0.00040110674194363124
Epoch: 3 cost time: 2.445150136947632
Epoch: 3, Steps: 245 | Train Loss: 0.9182992 Vali Loss: 0.6627409 Best vali loss: 0.6378250
	iters: 100, epoch: 4 | loss: 0.7601042
	speed: 0.0166s/iter; left time: 18.6468s
	iters: 200, epoch: 4 | loss: 1.0540626
	speed: 0.0132s/iter; left time: 13.5834s
Updating learning rate to 0.0002900929689
Epoch: 4 cost time: 2.867371082305908
Epoch: 4, Steps: 245 | Train Loss: 0.9070834 Vali Loss: 0.6447302 Best vali loss: 0.6378250
	iters: 100, epoch: 5 | loss: 0.8849145
	speed: 0.0258s/iter; left time: 22.7102s
	iters: 200, epoch: 5 | loss: 0.4728814
	speed: 0.0135s/iter; left time: 10.5120s
Updating learning rate to 0.00017907919585636876
Epoch: 5 cost time: 3.4150636196136475
Epoch: 5, Steps: 245 | Train Loss: 0.6788979 Vali Loss: 0.6481353 Best vali loss: 0.6378250
	iters: 100, epoch: 6 | loss: 0.9195127
	speed: 0.0271s/iter; left time: 17.2443s
	iters: 200, epoch: 6 | loss: 0.7312045
	speed: 0.0174s/iter; left time: 9.3301s
Updating learning rate to 8.496626341627177e-05
Epoch: 6 cost time: 3.9435410499572754
Epoch: 6, Steps: 245 | Train Loss: 0.8253586 Vali Loss: 0.6396974 Best vali loss: 0.6378250
	iters: 100, epoch: 7 | loss: 1.1945525
	speed: 0.0348s/iter; left time: 13.6115s
	iters: 200, epoch: 7 | loss: 0.7211083
	speed: 0.0133s/iter; left time: 3.8647s
Updating learning rate to 2.2082012407856755e-05
Epoch: 7 cost time: 3.795280933380127
Epoch: 7, Steps: 245 | Train Loss: 0.9578304 Vali Loss: 0.6383142 Best vali loss: 0.6378250
	iters: 100, epoch: 8 | loss: 0.6958115
	speed: 0.0265s/iter; left time: 3.8651s
	iters: 200, epoch: 8 | loss: 0.8899121
	speed: 0.0130s/iter; left time: 0.5990s
Updating learning rate to 0.0
Validation loss decreased (0.6378 --> 0.6322).  Saving model state dict ...
Epoch: 8 cost time: 3.4533865451812744
Epoch: 8, Steps: 245 | Train Loss: 0.7928618 Vali Loss: 0.6321965 Best vali loss: 0.6321965

best validation loss 0.6321965205564591

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0099703810531, 'e_layers': 4, 'learning_rate': 0.0005870167071, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5250787
	speed: 0.0200s/iter; left time: 37.2245s
	iters: 200, epoch: 1 | loss: 1.0889288
	speed: 0.0120s/iter; left time: 21.1275s
Updating learning rate to 0.0005646747140159315
Validation loss decreased (inf --> 0.5963).  Saving model state dict ...
Epoch: 1 cost time: 3.2021353244781494
Epoch: 1, Steps: 245 | Train Loss: 0.8070038 Vali Loss: 0.5963269 Best vali loss: 0.5963269
	iters: 100, epoch: 2 | loss: 0.8273519
	speed: 0.0191s/iter; left time: 30.8498s
	iters: 200, epoch: 2 | loss: 0.5117127
	speed: 0.0136s/iter; left time: 20.6208s
Updating learning rate to 0.0005010501006801036
Epoch: 2 cost time: 3.198545217514038
Epoch: 2, Steps: 245 | Train Loss: 0.6695323 Vali Loss: 0.6258865 Best vali loss: 0.5963269
	iters: 100, epoch: 3 | loss: 0.7750377
	speed: 0.0248s/iter; left time: 33.9788s
	iters: 200, epoch: 3 | loss: 0.4917098
	speed: 0.0159s/iter; left time: 20.2322s
Updating learning rate to 0.0004058291377143403
Validation loss decreased (0.5963 --> 0.5576).  Saving model state dict ...
Epoch: 3 cost time: 3.7736594676971436
Epoch: 3, Steps: 245 | Train Loss: 0.6333738 Vali Loss: 0.5576237 Best vali loss: 0.5576237

best validation loss 0.5576237300406557

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019010008109, 'e_layers': 4, 'learning_rate': 0.0006987665261, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6692222
	speed: 0.0286s/iter; left time: 53.1867s
	iters: 200, epoch: 1 | loss: 0.9299248
	speed: 0.0206s/iter; left time: 36.2934s
Updating learning rate to 0.0006987665261
Validation loss decreased (inf --> 0.6239).  Saving model state dict ...
Epoch: 1 cost time: 5.472474813461304
Epoch: 1, Steps: 245 | Train Loss: 0.7995735 Vali Loss: 0.6238754 Best vali loss: 0.6238754
	iters: 100, epoch: 2 | loss: 0.6182538
	speed: 0.0305s/iter; left time: 49.2174s
	iters: 200, epoch: 2 | loss: 0.6475224
	speed: 0.0183s/iter; left time: 27.6931s
Updating learning rate to 0.00034938326305
Epoch: 2 cost time: 4.073185920715332
Epoch: 2, Steps: 245 | Train Loss: 0.6328881 Vali Loss: 0.6470247 Best vali loss: 0.6238754
	iters: 100, epoch: 3 | loss: 0.7798307
	speed: 0.0318s/iter; left time: 43.5656s
	iters: 200, epoch: 3 | loss: 1.2360337
	speed: 0.0179s/iter; left time: 22.7849s
Updating learning rate to 0.000174691631525
Epoch: 3 cost time: 4.285745859146118
Epoch: 3, Steps: 245 | Train Loss: 1.0079322 Vali Loss: 0.6372750 Best vali loss: 0.6238754

best validation loss 0.6238754491792791

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0029036262858, 'e_layers': 4, 'learning_rate': 0.002942121309, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9226785
	speed: 0.0198s/iter; left time: 75.8134s
	iters: 200, epoch: 1 | loss: 1.2435737
	speed: 0.0129s/iter; left time: 48.0987s
	iters: 300, epoch: 1 | loss: 1.2983279
	speed: 0.0132s/iter; left time: 47.9647s
	iters: 400, epoch: 1 | loss: 1.3463475
	speed: 0.0131s/iter; left time: 46.0811s
Updating learning rate to 0.002942121309
Validation loss decreased (inf --> 0.6637).  Saving model state dict ...
Epoch: 1 cost time: 6.754863739013672
Epoch: 1, Steps: 490 | Train Loss: 1.2027319 Vali Loss: 0.6636864 Best vali loss: 0.6636864
	iters: 100, epoch: 2 | loss: 0.7397671
	speed: 0.0308s/iter; left time: 102.6512s
	iters: 200, epoch: 2 | loss: 0.7607548
	speed: 0.0126s/iter; left time: 40.6584s
	iters: 300, epoch: 2 | loss: 1.1652483
	speed: 0.0128s/iter; left time: 40.1075s
	iters: 400, epoch: 2 | loss: 0.8302957
	speed: 0.0139s/iter; left time: 42.0420s
Updating learning rate to 0.0014710606545
Validation loss decreased (0.6637 --> 0.6496).  Saving model state dict ...
Epoch: 2 cost time: 6.148918628692627
Epoch: 2, Steps: 490 | Train Loss: 0.8740165 Vali Loss: 0.6495895 Best vali loss: 0.6495895
	iters: 100, epoch: 3 | loss: 0.7351581
	speed: 0.0420s/iter; left time: 119.3795s
	iters: 200, epoch: 3 | loss: 0.8122919
	speed: 0.0172s/iter; left time: 47.0565s
	iters: 300, epoch: 3 | loss: 0.6879826
	speed: 0.0184s/iter; left time: 48.5160s
	iters: 400, epoch: 3 | loss: 0.6253311
	speed: 0.0190s/iter; left time: 48.3511s
Updating learning rate to 0.00073553032725
Validation loss decreased (0.6496 --> 0.6404).  Saving model state dict ...
Epoch: 3 cost time: 8.209954023361206
Epoch: 3, Steps: 490 | Train Loss: 0.7151909 Vali Loss: 0.6403792 Best vali loss: 0.6403792

best validation loss 0.6403791554710039

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0099703810531, 'e_layers': 4, 'learning_rate': 0.0005870167071, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4124620
	speed: 0.0243s/iter; left time: 27.3309s
	iters: 200, epoch: 4 | loss: 0.9638005
	speed: 0.0148s/iter; left time: 15.1769s
Updating learning rate to 0.00029350835355
Epoch: 4 cost time: 4.0432517528533936
Epoch: 4, Steps: 245 | Train Loss: 0.6881313 Vali Loss: 0.5672154 Best vali loss: 0.5576237
	iters: 100, epoch: 5 | loss: 0.6921541
	speed: 0.0296s/iter; left time: 26.0903s
	iters: 200, epoch: 5 | loss: 0.4006817
	speed: 0.0140s/iter; left time: 10.8998s
Updating learning rate to 0.0001811875693856597
Epoch: 5 cost time: 3.638566017150879
Epoch: 5, Steps: 245 | Train Loss: 0.5464179 Vali Loss: 0.5641756 Best vali loss: 0.5576237
	iters: 100, epoch: 6 | loss: 0.5920367
	speed: 0.0268s/iter; left time: 17.0515s
	iters: 200, epoch: 6 | loss: 0.4297519
	speed: 0.0149s/iter; left time: 7.9823s
Updating learning rate to 8.596660641989634e-05
Epoch: 6 cost time: 3.6810173988342285
Epoch: 6, Steps: 245 | Train Loss: 0.5108943 Vali Loss: 0.5895516 Best vali loss: 0.5576237
	iters: 100, epoch: 7 | loss: 0.5781363
	speed: 0.0274s/iter; left time: 10.7159s
	iters: 200, epoch: 7 | loss: 0.6894184
	speed: 0.0132s/iter; left time: 3.8418s
Updating learning rate to 2.234199308406853e-05
Epoch: 7 cost time: 3.519235849380493
Epoch: 7, Steps: 245 | Train Loss: 0.6337774 Vali Loss: 0.5963426 Best vali loss: 0.5576237
	iters: 100, epoch: 8 | loss: 0.9519821
	speed: 0.0252s/iter; left time: 3.6787s
	iters: 200, epoch: 8 | loss: 0.8309995
	speed: 0.0145s/iter; left time: 0.6666s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5481879711151123
Epoch: 8, Steps: 245 | Train Loss: 0.8914908 Vali Loss: 0.6044523 Best vali loss: 0.5576237

best validation loss 0.5576237300406557

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0013377786543, 'e_layers': 2, 'learning_rate': 0.0002030902852, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2008069
	speed: 0.0118s/iter; left time: 91.3468s
	iters: 200, epoch: 1 | loss: 1.2522255
	speed: 0.0050s/iter; left time: 38.0800s
	iters: 300, epoch: 1 | loss: 0.8241364
	speed: 0.0051s/iter; left time: 38.1051s
	iters: 400, epoch: 1 | loss: 1.1364199
	speed: 0.0075s/iter; left time: 55.8057s
	iters: 500, epoch: 1 | loss: 0.9094948
	speed: 0.0094s/iter; left time: 68.7756s
	iters: 600, epoch: 1 | loss: 0.8178157
	speed: 0.0093s/iter; left time: 66.9386s
	iters: 700, epoch: 1 | loss: 1.1682813
	speed: 0.0091s/iter; left time: 65.0211s
	iters: 800, epoch: 1 | loss: 0.7679818
	speed: 0.0090s/iter; left time: 63.6462s
	iters: 900, epoch: 1 | loss: 1.1746559
	speed: 0.0094s/iter; left time: 65.3356s
Updating learning rate to 0.00019536062147407993
Validation loss decreased (inf --> 0.5898).  Saving model state dict ...
Epoch: 1 cost time: 7.973565101623535
Epoch: 1, Steps: 979 | Train Loss: 1.0279798 Vali Loss: 0.5897930 Best vali loss: 0.5897930
	iters: 100, epoch: 2 | loss: 0.9489161
	speed: 0.0318s/iter; left time: 215.1011s
	iters: 200, epoch: 2 | loss: 0.9507530
	speed: 0.0052s/iter; left time: 34.4741s
	iters: 300, epoch: 2 | loss: 0.3895024
	speed: 0.0056s/iter; left time: 36.9691s
	iters: 400, epoch: 2 | loss: 0.5875965
	speed: 0.0063s/iter; left time: 40.9808s
	iters: 500, epoch: 2 | loss: 1.0651118
	speed: 0.0064s/iter; left time: 40.4693s
	iters: 600, epoch: 2 | loss: 0.4694862
	speed: 0.0067s/iter; left time: 42.1775s
	iters: 700, epoch: 2 | loss: 1.1779968
	speed: 0.0063s/iter; left time: 38.8301s
	iters: 800, epoch: 2 | loss: 1.2724435
	speed: 0.0066s/iter; left time: 39.9135s
	iters: 900, epoch: 2 | loss: 0.8208317
	speed: 0.0064s/iter; left time: 38.2230s
Updating learning rate to 0.00017334840152901496
Epoch: 2 cost time: 6.410343647003174
Epoch: 2, Steps: 979 | Train Loss: 0.8536264 Vali Loss: 0.6146920 Best vali loss: 0.5897930
	iters: 100, epoch: 3 | loss: 0.9788681
	speed: 0.0218s/iter; left time: 125.7443s
	iters: 200, epoch: 3 | loss: 0.4726079
	speed: 0.0067s/iter; left time: 37.7605s
	iters: 300, epoch: 3 | loss: 0.4711813
	speed: 0.0066s/iter; left time: 36.7458s
	iters: 400, epoch: 3 | loss: 0.3571162
	speed: 0.0063s/iter; left time: 34.3848s
	iters: 500, epoch: 3 | loss: 1.0533652
	speed: 0.0064s/iter; left time: 34.2391s
	iters: 600, epoch: 3 | loss: 0.6440464
	speed: 0.0066s/iter; left time: 34.8724s
	iters: 700, epoch: 3 | loss: 0.5249908
	speed: 0.0065s/iter; left time: 33.7477s
	iters: 800, epoch: 3 | loss: 0.5543369
	speed: 0.0067s/iter; left time: 33.9787s
	iters: 900, epoch: 3 | loss: 0.9187427
	speed: 0.0061s/iter; left time: 30.5349s
Updating learning rate to 0.0001404047863101705
Epoch: 3 cost time: 6.323096036911011
Epoch: 3, Steps: 979 | Train Loss: 0.6639173 Vali Loss: 0.6144751 Best vali loss: 0.5897930
	iters: 100, epoch: 4 | loss: 1.2133650
	speed: 0.0203s/iter; left time: 97.2134s
	iters: 200, epoch: 4 | loss: 0.5414094
	speed: 0.0067s/iter; left time: 31.2546s
	iters: 300, epoch: 4 | loss: 0.3547840
	speed: 0.0067s/iter; left time: 30.9514s
	iters: 400, epoch: 4 | loss: 1.4790068
	speed: 0.0060s/iter; left time: 26.9587s
	iters: 500, epoch: 4 | loss: 0.9364094
	speed: 0.0059s/iter; left time: 25.9819s
	iters: 600, epoch: 4 | loss: 0.3890825
	speed: 0.0057s/iter; left time: 24.6149s
	iters: 700, epoch: 4 | loss: 0.7327308
	speed: 0.0054s/iter; left time: 22.4575s
	iters: 800, epoch: 4 | loss: 0.4314653
	speed: 0.0055s/iter; left time: 22.5040s
	iters: 900, epoch: 4 | loss: 1.0281994
	speed: 0.0054s/iter; left time: 21.6803s
Updating learning rate to 0.0001015451426
Epoch: 4 cost time: 5.802701473236084
Epoch: 4, Steps: 979 | Train Loss: 0.7896058 Vali Loss: 0.6296960 Best vali loss: 0.5897930
	iters: 100, epoch: 5 | loss: 0.7857619
	speed: 0.0224s/iter; left time: 85.4699s
	iters: 200, epoch: 5 | loss: 0.5579179
	speed: 0.0080s/iter; left time: 29.9197s
	iters: 300, epoch: 5 | loss: 0.6462430
	speed: 0.0079s/iter; left time: 28.6530s
	iters: 400, epoch: 5 | loss: 0.6453526
	speed: 0.0081s/iter; left time: 28.4648s
	iters: 500, epoch: 5 | loss: 0.5068405
	speed: 0.0095s/iter; left time: 32.3716s
	iters: 600, epoch: 5 | loss: 0.8402273
	speed: 0.0100s/iter; left time: 33.1833s
	iters: 700, epoch: 5 | loss: 0.6241121
	speed: 0.0135s/iter; left time: 43.5778s
	iters: 800, epoch: 5 | loss: 0.6149413
	speed: 0.0109s/iter; left time: 34.0892s
	iters: 900, epoch: 5 | loss: 0.3269420
	speed: 0.0100s/iter; left time: 30.0808s
Updating learning rate to 6.26854988898295e-05
Epoch: 5 cost time: 9.46811032295227
Epoch: 5, Steps: 979 | Train Loss: 0.6164821 Vali Loss: 0.6446401 Best vali loss: 0.5897930
	iters: 100, epoch: 6 | loss: 1.3135171
	speed: 0.0406s/iter; left time: 115.1995s
	iters: 200, epoch: 6 | loss: 1.0728060
	speed: 0.0093s/iter; left time: 25.4370s
	iters: 300, epoch: 6 | loss: 0.7931609
	speed: 0.0104s/iter; left time: 27.5002s
	iters: 400, epoch: 6 | loss: 0.4494131
	speed: 0.0121s/iter; left time: 30.6991s
	iters: 500, epoch: 6 | loss: 1.2773128
	speed: 0.0102s/iter; left time: 24.9733s
	iters: 600, epoch: 6 | loss: 0.4241355
	speed: 0.0102s/iter; left time: 23.7583s
	iters: 700, epoch: 6 | loss: 0.2527738
	speed: 0.0112s/iter; left time: 25.1624s
	iters: 800, epoch: 6 | loss: 0.8479919
	speed: 0.0094s/iter; left time: 20.1635s
	iters: 900, epoch: 6 | loss: 1.2101041
	speed: 0.0096s/iter; left time: 19.4772s
Updating learning rate to 2.974188367098504e-05
Epoch: 6 cost time: 10.127532720565796
Epoch: 6, Steps: 979 | Train Loss: 0.8490239 Vali Loss: 0.6591087 Best vali loss: 0.5897930
	iters: 100, epoch: 7 | loss: 0.8971587
	speed: 0.0599s/iter; left time: 111.3130s
	iters: 200, epoch: 7 | loss: 1.0407935
	speed: 0.0100s/iter; left time: 17.5238s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0037046253889, 'e_layers': 1, 'learning_rate': 0.0002729698754, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3867456
	speed: 0.0168s/iter; left time: 130.1246s
	iters: 200, epoch: 1 | loss: 1.0310055
	speed: 0.0095s/iter; left time: 72.4518s
	iters: 300, epoch: 1 | loss: 1.1604124
	speed: 0.0096s/iter; left time: 72.3228s
	iters: 400, epoch: 1 | loss: 0.5968741
	speed: 0.0113s/iter; left time: 83.9474s
	iters: 500, epoch: 1 | loss: 1.0913262
	speed: 0.0100s/iter; left time: 73.4259s
	iters: 600, epoch: 1 | loss: 0.7010925
	speed: 0.0091s/iter; left time: 66.1429s
	iters: 700, epoch: 1 | loss: 0.3782802
	speed: 0.0090s/iter; left time: 64.0595s
	iters: 800, epoch: 1 | loss: 0.9499581
	speed: 0.0089s/iter; left time: 62.3671s
	iters: 900, epoch: 1 | loss: 0.8927293
	speed: 0.0096s/iter; left time: 66.8512s
Updating learning rate to 0.0002625805781371081
Validation loss decreased (inf --> 0.6013).  Saving model state dict ...
Epoch: 1 cost time: 9.779316425323486
Epoch: 1, Steps: 979 | Train Loss: 0.9098249 Vali Loss: 0.6012660 Best vali loss: 0.6012660
	iters: 100, epoch: 2 | loss: 1.6114280
	speed: 0.0396s/iter; left time: 267.7661s
	iters: 200, epoch: 2 | loss: 0.4588143
	speed: 0.0050s/iter; left time: 33.1654s
	iters: 300, epoch: 2 | loss: 0.7411131
	speed: 0.0058s/iter; left time: 37.8879s
	iters: 400, epoch: 2 | loss: 0.4996121
	speed: 0.0040s/iter; left time: 25.6601s
	iters: 500, epoch: 2 | loss: 0.5577023
	speed: 0.0040s/iter; left time: 25.1227s
	iters: 600, epoch: 2 | loss: 0.3556147
	speed: 0.0049s/iter; left time: 30.6949s
	iters: 700, epoch: 2 | loss: 0.6480593
	speed: 0.0069s/iter; left time: 42.3734s
	iters: 800, epoch: 2 | loss: 0.4975514
	speed: 0.0064s/iter; left time: 39.0228s
	iters: 900, epoch: 2 | loss: 0.9790295
	speed: 0.0072s/iter; left time: 43.0598s
Updating learning rate to 0.00023299436267749346
Epoch: 2 cost time: 5.56552791595459
Epoch: 2, Steps: 979 | Train Loss: 0.7054361 Vali Loss: 0.6075372 Best vali loss: 0.6012660
	iters: 100, epoch: 3 | loss: 1.4126073
	speed: 0.0224s/iter; left time: 129.1429s
	iters: 200, epoch: 3 | loss: 0.4849053
	speed: 0.0074s/iter; left time: 41.7769s
	iters: 300, epoch: 3 | loss: 1.1294125
	speed: 0.0065s/iter; left time: 36.0018s
	iters: 400, epoch: 3 | loss: 0.5347940
	speed: 0.0062s/iter; left time: 34.1513s
	iters: 500, epoch: 3 | loss: 1.1560464
	speed: 0.0063s/iter; left time: 33.6352s
	iters: 600, epoch: 3 | loss: 0.6446442
	speed: 0.0063s/iter; left time: 33.2447s
	iters: 700, epoch: 3 | loss: 0.3806828
	speed: 0.0069s/iter; left time: 35.7073s
	iters: 800, epoch: 3 | loss: 0.3401054
	speed: 0.0068s/iter; left time: 34.5442s
	iters: 900, epoch: 3 | loss: 0.7059002
	speed: 0.0062s/iter; left time: 30.8349s
Updating learning rate to 0.00018871546212517146
Epoch: 3 cost time: 6.471796035766602
Epoch: 3, Steps: 979 | Train Loss: 0.7543443 Vali Loss: 0.6284461 Best vali loss: 0.6012660
	iters: 100, epoch: 4 | loss: 0.6690645
	speed: 0.0241s/iter; left time: 115.6294s
	iters: 200, epoch: 4 | loss: 0.6817849
	speed: 0.0072s/iter; left time: 33.7440s
	iters: 300, epoch: 4 | loss: 0.4237143
	speed: 0.0065s/iter; left time: 30.0462s
	iters: 400, epoch: 4 | loss: 1.2977830
	speed: 0.0067s/iter; left time: 30.0690s
	iters: 500, epoch: 4 | loss: 0.7323811
	speed: 0.0060s/iter; left time: 26.4637s
	iters: 600, epoch: 4 | loss: 0.8869656
	speed: 0.0064s/iter; left time: 27.4390s
	iters: 700, epoch: 4 | loss: 0.2779357
	speed: 0.0064s/iter; left time: 26.9598s
	iters: 800, epoch: 4 | loss: 0.3948217
	speed: 0.0066s/iter; left time: 26.9014s
	iters: 900, epoch: 4 | loss: 0.9199588
	speed: 0.0061s/iter; left time: 24.1850s
Updating learning rate to 0.0001364849377
Epoch: 4 cost time: 6.365894556045532
Epoch: 4, Steps: 979 | Train Loss: 0.6982677 Vali Loss: 0.6382366 Best vali loss: 0.6012660
	iters: 100, epoch: 5 | loss: 0.7389345
	speed: 0.0220s/iter; left time: 83.9802s
	iters: 200, epoch: 5 | loss: 0.4751462
	speed: 0.0059s/iter; left time: 22.1120s
	iters: 300, epoch: 5 | loss: 0.8694165
	speed: 0.0058s/iter; left time: 21.1127s
	iters: 400, epoch: 5 | loss: 0.6294190
	speed: 0.0054s/iter; left time: 19.1294s
	iters: 500, epoch: 5 | loss: 0.6219098
	speed: 0.0059s/iter; left time: 20.2710s
	iters: 600, epoch: 5 | loss: 0.7037760
	speed: 0.0063s/iter; left time: 20.9513s
	iters: 700, epoch: 5 | loss: 0.9956686
	speed: 0.0069s/iter; left time: 22.2426s
	iters: 800, epoch: 5 | loss: 0.9682603
	speed: 0.0069s/iter; left time: 21.5651s
	iters: 900, epoch: 5 | loss: 0.7618210
	speed: 0.0070s/iter; left time: 20.9924s
Updating learning rate to 8.425441327482857e-05
Epoch: 5 cost time: 6.270784378051758
Epoch: 5, Steps: 979 | Train Loss: 0.7515947 Vali Loss: 0.6180801 Best vali loss: 0.6012660
	iters: 100, epoch: 6 | loss: 0.3984275
	speed: 0.0242s/iter; left time: 68.6979s
	iters: 200, epoch: 6 | loss: 0.3238164
	speed: 0.0058s/iter; left time: 15.9112s
	iters: 300, epoch: 6 | loss: 1.0686574
	speed: 0.0048s/iter; left time: 12.5907s
	iters: 400, epoch: 6 | loss: 0.5599190
	speed: 0.0051s/iter; left time: 12.8511s
	iters: 500, epoch: 6 | loss: 0.3026463
	speed: 0.0058s/iter; left time: 14.0545s
	iters: 600, epoch: 6 | loss: 0.8018075
	speed: 0.0054s/iter; left time: 12.5231s
	iters: 700, epoch: 6 | loss: 1.5388689
	speed: 0.0060s/iter; left time: 13.4903s
	iters: 800, epoch: 6 | loss: 0.4246505
	speed: 0.0053s/iter; left time: 11.3572s
	iters: 900, epoch: 6 | loss: 0.2301442
	speed: 0.0057s/iter; left time: 11.6689s
Updating learning rate to 3.997551272250654e-05
Epoch: 6 cost time: 5.521834850311279
Epoch: 6, Steps: 979 | Train Loss: 0.6276597 Vali Loss: 0.6445348 Best vali loss: 0.6012660
	iters: 100, epoch: 7 | loss: 0.7988284
	speed: 0.0220s/iter; left time: 40.9031s
	iters: 200, epoch: 7 | loss: 0.5402473
	speed: 0.0061s/iter; left time: 10.7517s
	iters: 300, epoch: 7 | loss: 0.5106359
	speed: 0.0054s/iter; left time: 8.9587s
	iters: 400, epoch: 7 | loss: 0.7528151
	speed: 0.0052s/iter; left time: 8.0314s
	iters: 500, epoch: 7 | loss: 0.4284819
	speed: 0.0057s/iter; left time: 8.3672s
	iters: 600, epoch: 7 | loss: 1.2424858
	speed: 0.0062s/iter; left time: 8.4843s
	iters: 700, epoch: 7 | loss: 0.5043559
	speed: 0.0061s/iter; left time: 7.6829s
	iters: 800, epoch: 7 | loss: 0.6915185
	speed: 0.0066s/iter; left time: 7.5944s
	iters: 900, epoch: 7 | loss: 0.2592073
	speed: 0.0064s/iter; left time: 6.7723s
Updating learning rate to 1.0389297262891906e-05
Epoch: 7 cost time: 5.957568883895874
Epoch: 7, Steps: 979 | Train Loss: 0.6365084 Vali Loss: 0.6389778 Best vali loss: 0.6012660
	iters: 100, epoch: 8 | loss: 0.3464716
	speed: 0.0232s/iter; left time: 20.3748s
	iters: 200, epoch: 8 | loss: 0.6269495
	speed: 0.0067s/iter; left time: 5.1882s
	iters: 300, epoch: 8 | loss: 0.4683897
	speed: 0.0045s/iter; left time: 3.0579s
	iters: 400, epoch: 8 | loss: 1.2329273
	speed: 0.0034s/iter; left time: 1.9676s
	iters: 500, epoch: 8 | loss: 0.8667142
	speed: 0.0034s/iter; left time: 1.6256s
	iters: 600, epoch: 8 | loss: 0.6356012
	speed: 0.0051s/iter; left time: 1.9443s
	iters: 700, epoch: 8 | loss: 1.3072686
	speed: 0.0046s/iter; left time: 1.2862s
	iters: 800, epoch: 8 | loss: 0.4559912
	speed: 0.0054s/iter; left time: 0.9728s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0032174734801, 'e_layers': 4, 'learning_rate': 0.0003812607109, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6291031
	speed: 0.0172s/iter; left time: 31.9188s
	iters: 200, epoch: 1 | loss: 0.9166316
	speed: 0.0105s/iter; left time: 18.5118s
Updating learning rate to 0.00036674983912560644
Validation loss decreased (inf --> 0.6032).  Saving model state dict ...
Epoch: 1 cost time: 3.0821220874786377
Epoch: 1, Steps: 245 | Train Loss: 0.7728673 Vali Loss: 0.6031629 Best vali loss: 0.6031629
	iters: 100, epoch: 2 | loss: 0.7111269
	speed: 0.0214s/iter; left time: 34.5962s
	iters: 200, epoch: 2 | loss: 0.6562740
	speed: 0.0097s/iter; left time: 14.7230s
Updating learning rate to 0.0003254263724886969
Epoch: 2 cost time: 2.4828267097473145
Epoch: 2, Steps: 245 | Train Loss: 0.6837004 Vali Loss: 0.6106005 Best vali loss: 0.6031629
	iters: 100, epoch: 3 | loss: 0.7325187
	speed: 0.0188s/iter; left time: 25.7454s
	iters: 200, epoch: 3 | loss: 0.7503088
	speed: 0.0104s/iter; left time: 13.2304s
Updating learning rate to 0.0002635814341865831
Validation loss decreased (0.6032 --> 0.5607).  Saving model state dict ...
Epoch: 3 cost time: 2.7676198482513428
Epoch: 3, Steps: 245 | Train Loss: 0.7414137 Vali Loss: 0.5606892 Best vali loss: 0.5606892

best validation loss 0.5606891562518341

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0009424504792, 'e_layers': 4, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0190284
	speed: 0.0168s/iter; left time: 130.2476s
	iters: 200, epoch: 1 | loss: 0.7738374
	speed: 0.0093s/iter; left time: 71.2240s
	iters: 300, epoch: 1 | loss: 0.2354439
	speed: 0.0092s/iter; left time: 69.0897s
	iters: 400, epoch: 1 | loss: 1.0077348
	speed: 0.0094s/iter; left time: 69.8120s
	iters: 500, epoch: 1 | loss: 0.8536078
	speed: 0.0107s/iter; left time: 78.1885s
	iters: 600, epoch: 1 | loss: 0.9385762
	speed: 0.0112s/iter; left time: 80.8861s
	iters: 700, epoch: 1 | loss: 0.9238851
	speed: 0.0114s/iter; left time: 81.2428s
	iters: 800, epoch: 1 | loss: 0.8388309
	speed: 0.0107s/iter; left time: 75.2865s
	iters: 900, epoch: 1 | loss: 1.5558754
	speed: 0.0113s/iter; left time: 78.6161s
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.6352).  Saving model state dict ...
Epoch: 1 cost time: 10.56676173210144
Epoch: 1, Steps: 979 | Train Loss: 0.9052022 Vali Loss: 0.6352406 Best vali loss: 0.6352406
	iters: 100, epoch: 2 | loss: 1.4334803
	speed: 0.0611s/iter; left time: 412.5963s
	iters: 200, epoch: 2 | loss: 0.5429059
	speed: 0.0102s/iter; left time: 67.9004s
	iters: 300, epoch: 2 | loss: 1.1853838
	speed: 0.0102s/iter; left time: 66.5370s
	iters: 400, epoch: 2 | loss: 1.1112080
	speed: 0.0105s/iter; left time: 67.6686s
	iters: 500, epoch: 2 | loss: 0.4421767
	speed: 0.0105s/iter; left time: 66.4933s
	iters: 600, epoch: 2 | loss: 2.3345010
	speed: 0.0106s/iter; left time: 66.0207s
	iters: 700, epoch: 2 | loss: 1.6788733
	speed: 0.0100s/iter; left time: 61.2532s
	iters: 800, epoch: 2 | loss: 1.0539967
	speed: 0.0095s/iter; left time: 57.3811s
	iters: 900, epoch: 2 | loss: 0.6142398
	speed: 0.0093s/iter; left time: 55.1158s
Updating learning rate to 0.0002257411363
Validation loss decreased (0.6352 --> 0.6348).  Saving model state dict ...
Epoch: 2 cost time: 9.67638611793518
Epoch: 2, Steps: 979 | Train Loss: 1.1551962 Vali Loss: 0.6347915 Best vali loss: 0.6347915
	iters: 100, epoch: 3 | loss: 0.9360226
	speed: 0.0524s/iter; left time: 302.3771s
	iters: 200, epoch: 3 | loss: 0.5081465
	speed: 0.0115s/iter; left time: 65.5393s
	iters: 300, epoch: 3 | loss: 0.7207610
	speed: 0.0114s/iter; left time: 63.5209s
	iters: 400, epoch: 3 | loss: 0.7285528
	speed: 0.0138s/iter; left time: 75.5456s
	iters: 500, epoch: 3 | loss: 0.6223153
	speed: 0.0127s/iter; left time: 68.2809s
	iters: 600, epoch: 3 | loss: 0.4531011
	speed: 0.0123s/iter; left time: 64.8066s
	iters: 700, epoch: 3 | loss: 1.0780064
	speed: 0.0135s/iter; left time: 69.9606s
	iters: 800, epoch: 3 | loss: 0.5794510
	speed: 0.0116s/iter; left time: 58.9564s
	iters: 900, epoch: 3 | loss: 0.8839133
	speed: 0.0115s/iter; left time: 57.1482s
Updating learning rate to 0.00011287056815
Validation loss decreased (0.6348 --> 0.6107).  Saving model state dict ...
Epoch: 3 cost time: 12.158400058746338
Epoch: 3, Steps: 979 | Train Loss: 0.7233633 Vali Loss: 0.6106661 Best vali loss: 0.6106661

best validation loss 0.6106661025267517

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.00216155938, 'e_layers': 4, 'learning_rate': 0.001084813014, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4942671
	speed: 0.0257s/iter; left time: 47.7573s
	iters: 200, epoch: 1 | loss: 0.7607124
	speed: 0.0087s/iter; left time: 15.3103s
Updating learning rate to 0.001084813014
Validation loss decreased (inf --> 0.6553).  Saving model state dict ...
Epoch: 1 cost time: 3.5254578590393066
Epoch: 1, Steps: 245 | Train Loss: 0.6274897 Vali Loss: 0.6552877 Best vali loss: 0.6552877
	iters: 100, epoch: 2 | loss: 1.1515000
	speed: 0.0193s/iter; left time: 31.2657s
	iters: 200, epoch: 2 | loss: 0.5102965
	speed: 0.0098s/iter; left time: 14.8439s
Updating learning rate to 0.000542406507
Validation loss decreased (0.6553 --> 0.6187).  Saving model state dict ...
Epoch: 2 cost time: 2.4120781421661377
Epoch: 2, Steps: 245 | Train Loss: 0.8308982 Vali Loss: 0.6186885 Best vali loss: 0.6186885
	iters: 100, epoch: 3 | loss: 0.6999469
	speed: 0.0196s/iter; left time: 26.9164s
	iters: 200, epoch: 3 | loss: 0.9446030
	speed: 0.0098s/iter; left time: 12.4128s
Updating learning rate to 0.0002712032535
Epoch: 3 cost time: 2.480933666229248
Epoch: 3, Steps: 245 | Train Loss: 0.8222750 Vali Loss: 0.6238469 Best vali loss: 0.6186885

best validation loss 0.6186885045447431

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0032174734801, 'e_layers': 4, 'learning_rate': 0.0003812607109, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5396412
	speed: 0.0168s/iter; left time: 18.9468s
	iters: 200, epoch: 4 | loss: 0.7571474
	speed: 0.0086s/iter; left time: 8.7913s
Updating learning rate to 0.00019063035545
Validation loss decreased (0.5607 --> 0.5567).  Saving model state dict ...
Epoch: 4 cost time: 2.5108211040496826
Epoch: 4, Steps: 245 | Train Loss: 0.6483943 Vali Loss: 0.5566513 Best vali loss: 0.5566513
	iters: 100, epoch: 5 | loss: 0.6715659
	speed: 0.0166s/iter; left time: 14.6212s
	iters: 200, epoch: 5 | loss: 0.5985202
	speed: 0.0089s/iter; left time: 6.9221s
Updating learning rate to 0.00011767927671341692
Epoch: 5 cost time: 2.208296298980713
Epoch: 5, Steps: 245 | Train Loss: 0.6350431 Vali Loss: 0.5571045 Best vali loss: 0.5566513
	iters: 100, epoch: 6 | loss: 0.6355671
	speed: 0.0165s/iter; left time: 10.5018s
	iters: 200, epoch: 6 | loss: 0.6731313
	speed: 0.0085s/iter; left time: 4.5689s
Updating learning rate to 5.5834338411303084e-05
Validation loss decreased (0.5567 --> 0.5505).  Saving model state dict ...
Epoch: 6 cost time: 2.2093822956085205
Epoch: 6, Steps: 245 | Train Loss: 0.6543492 Vali Loss: 0.5505158 Best vali loss: 0.5505158
	iters: 100, epoch: 7 | loss: 0.5724099
	speed: 0.0176s/iter; left time: 6.9011s
	iters: 200, epoch: 7 | loss: 1.2274928
	speed: 0.0094s/iter; left time: 2.7258s
Updating learning rate to 1.4510871774393578e-05
Epoch: 7 cost time: 2.3424196243286133
Epoch: 7, Steps: 245 | Train Loss: 0.8999513 Vali Loss: 0.5508228 Best vali loss: 0.5505158
	iters: 100, epoch: 8 | loss: 0.8563080
	speed: 0.0168s/iter; left time: 2.4511s
	iters: 200, epoch: 8 | loss: 0.4448496
	speed: 0.0087s/iter; left time: 0.4010s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1409687995910645
Epoch: 8, Steps: 245 | Train Loss: 0.6505788 Vali Loss: 0.5517462 Best vali loss: 0.5505158

best validation loss 0.550515785944346

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0088784982474, 'e_layers': 3, 'learning_rate': 0.0002391486573, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002391486573
Validation loss decreased (inf --> 0.6532).  Saving model state dict ...
Epoch: 1 cost time: 1.0880239009857178
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6531535 Best vali loss: 0.6531535
Updating learning rate to 0.00011957432865
Validation loss decreased (0.6532 --> 0.6231).  Saving model state dict ...
Epoch: 2 cost time: 1.2374272346496582
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6231242 Best vali loss: 0.6231242
Updating learning rate to 5.9787164325e-05
Validation loss decreased (0.6231 --> 0.6164).  Saving model state dict ...
Epoch: 3 cost time: 0.9689743518829346
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6163992 Best vali loss: 0.6163992
Updating learning rate to 2.98935821625e-05
Validation loss decreased (0.6164 --> 0.6147).  Saving model state dict ...
Epoch: 4 cost time: 0.9818742275238037
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6147111 Best vali loss: 0.6147111
Updating learning rate to 1.494679108125e-05
Validation loss decreased (0.6147 --> 0.6130).  Saving model state dict ...
Epoch: 5 cost time: 1.1108267307281494
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6129576 Best vali loss: 0.6129576
Updating learning rate to 7.473395540625e-06
Validation loss decreased (0.6130 --> 0.6125).  Saving model state dict ...
Epoch: 6 cost time: 1.8643944263458252
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6124974 Best vali loss: 0.6124974
Updating learning rate to 3.7366977703125e-06
Validation loss decreased (0.6125 --> 0.6122).  Saving model state dict ...
Epoch: 7 cost time: 0.9613261222839355
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6122130 Best vali loss: 0.6122130
Updating learning rate to 1.86834888515625e-06
Validation loss decreased (0.6122 --> 0.6121).  Saving model state dict ...
Epoch: 8 cost time: 0.9728896617889404
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6120822 Best vali loss: 0.6120822

best validation loss 0.6120821782583884

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0043376323922, 'e_layers': 4, 'learning_rate': 0.0025598871637, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2159952
	speed: 0.0210s/iter; left time: 18.6115s
Updating learning rate to 0.0024624572598904
Validation loss decreased (inf --> 0.6422).  Saving model state dict ...
Epoch: 1 cost time: 2.0553791522979736
Epoch: 1, Steps: 123 | Train Loss: 1.2159952 Vali Loss: 0.6421680 Best vali loss: 0.6421680
	iters: 100, epoch: 2 | loss: 0.7897562
	speed: 0.0359s/iter; left time: 27.3574s
Updating learning rate to 0.002185000368112334
Epoch: 2 cost time: 2.1536505222320557
Epoch: 2, Steps: 123 | Train Loss: 0.7897562 Vali Loss: 0.6540904 Best vali loss: 0.6421680
	iters: 100, epoch: 3 | loss: 1.0174371
	speed: 0.0237s/iter; left time: 15.1460s
Updating learning rate to 0.0017697567849860253
Validation loss decreased (0.6422 --> 0.6326).  Saving model state dict ...
Epoch: 3 cost time: 1.9265878200531006
Epoch: 3, Steps: 123 | Train Loss: 1.0174371 Vali Loss: 0.6325830 Best vali loss: 0.6325830
	iters: 100, epoch: 4 | loss: 0.6802732
	speed: 0.0248s/iter; left time: 12.7743s
Updating learning rate to 0.00127994358185
Epoch: 4 cost time: 1.9879424571990967
Epoch: 4, Steps: 123 | Train Loss: 0.6802732 Vali Loss: 0.6419639 Best vali loss: 0.6325830
	iters: 100, epoch: 5 | loss: 1.0331471
	speed: 0.0322s/iter; left time: 12.6559s
Updating learning rate to 0.0007901303787139749
Validation loss decreased (0.6326 --> 0.6248).  Saving model state dict ...
Epoch: 5 cost time: 2.704331159591675
Epoch: 5, Steps: 123 | Train Loss: 1.0331471 Vali Loss: 0.6247811 Best vali loss: 0.6247811
	iters: 100, epoch: 6 | loss: 0.9085878
	speed: 0.0144s/iter; left time: 3.8813s
Updating learning rate to 0.0003748867955876662
Validation loss decreased (0.6248 --> 0.6037).  Saving model state dict ...
Epoch: 6 cost time: 1.2339863777160645
Epoch: 6, Steps: 123 | Train Loss: 0.9085878 Vali Loss: 0.6037113 Best vali loss: 0.6037113
	iters: 100, epoch: 7 | loss: 0.7913435
	speed: 0.0186s/iter; left time: 2.7278s
Updating learning rate to 9.742990380960012e-05
Validation loss decreased (0.6037 --> 0.6004).  Saving model state dict ...
Epoch: 7 cost time: 1.5129218101501465
Epoch: 7, Steps: 123 | Train Loss: 0.7913435 Vali Loss: 0.6004079 Best vali loss: 0.6004079
	iters: 100, epoch: 8 | loss: 0.7394691
	speed: 0.0217s/iter; left time: 0.5217s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9689042568206787
Epoch: 8, Steps: 123 | Train Loss: 0.7394691 Vali Loss: 0.6063817 Best vali loss: 0.6004079

best validation loss 0.6004079321036456

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023452380083, 'e_layers': 2, 'learning_rate': 0.0034610704721, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7240568
	speed: 0.0217s/iter; left time: 83.0147s
	iters: 200, epoch: 1 | loss: 1.1375169
	speed: 0.0129s/iter; left time: 47.8479s
	iters: 300, epoch: 1 | loss: 0.7034258
	speed: 0.0056s/iter; left time: 20.3519s
	iters: 400, epoch: 1 | loss: 1.0379064
	speed: 0.0111s/iter; left time: 38.9664s
Updating learning rate to 0.0034610704721
Validation loss decreased (inf --> 0.6471).  Saving model state dict ...
Epoch: 1 cost time: 5.988231897354126
Epoch: 1, Steps: 490 | Train Loss: 0.9007265 Vali Loss: 0.6470755 Best vali loss: 0.6470755
	iters: 100, epoch: 2 | loss: 0.9964497
	speed: 0.0467s/iter; left time: 155.6896s
	iters: 200, epoch: 2 | loss: 1.1439428
	speed: 0.0150s/iter; left time: 48.5963s
	iters: 300, epoch: 2 | loss: 0.7774369
	speed: 0.0141s/iter; left time: 44.0771s
	iters: 400, epoch: 2 | loss: 0.5773354
	speed: 0.0151s/iter; left time: 45.6903s
Updating learning rate to 0.00173053523605
Validation loss decreased (0.6471 --> 0.6413).  Saving model state dict ...
Epoch: 2 cost time: 7.577873229980469
Epoch: 2, Steps: 490 | Train Loss: 0.8737912 Vali Loss: 0.6412735 Best vali loss: 0.6412735
	iters: 100, epoch: 3 | loss: 1.2529792
	speed: 0.0501s/iter; left time: 142.3108s
	iters: 200, epoch: 3 | loss: 1.5501021
	speed: 0.0121s/iter; left time: 33.1847s
	iters: 300, epoch: 3 | loss: 0.6456156
	speed: 0.0093s/iter; left time: 24.5375s
	iters: 400, epoch: 3 | loss: 1.1350957
	speed: 0.0089s/iter; left time: 22.5880s
Updating learning rate to 0.000865267618025
Epoch: 3 cost time: 5.259782075881958
Epoch: 3, Steps: 490 | Train Loss: 1.1459481 Vali Loss: 0.6482997 Best vali loss: 0.6412735

best validation loss 0.6412734884677359

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0085244746351, 'e_layers': 4, 'learning_rate': 0.0002432460896, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8536671
	speed: 0.0176s/iter; left time: 32.6907s
	iters: 200, epoch: 1 | loss: 0.8983971
	speed: 0.0127s/iter; left time: 22.3948s
Updating learning rate to 0.00023398808657242327
Validation loss decreased (inf --> 0.5962).  Saving model state dict ...
Epoch: 1 cost time: 3.2306175231933594
Epoch: 1, Steps: 245 | Train Loss: 0.8760321 Vali Loss: 0.5961758 Best vali loss: 0.5961758
	iters: 100, epoch: 2 | loss: 0.6202453
	speed: 0.0222s/iter; left time: 35.8488s
	iters: 200, epoch: 2 | loss: 1.0717698
	speed: 0.0131s/iter; left time: 19.8775s
Updating learning rate to 0.00020762352452663525
Validation loss decreased (0.5962 --> 0.5752).  Saving model state dict ...
Epoch: 2 cost time: 3.240473985671997
Epoch: 2, Steps: 245 | Train Loss: 0.8460076 Vali Loss: 0.5751649 Best vali loss: 0.5751649
	iters: 100, epoch: 3 | loss: 0.6219512
	speed: 0.0230s/iter; left time: 31.5468s
	iters: 200, epoch: 3 | loss: 0.8908219
	speed: 0.0120s/iter; left time: 15.2052s
Updating learning rate to 0.0001681661690387571
Validation loss decreased (0.5752 --> 0.5468).  Saving model state dict ...
Epoch: 3 cost time: 3.0640945434570312
Epoch: 3, Steps: 245 | Train Loss: 0.7563865 Vali Loss: 0.5468329 Best vali loss: 0.5468329

best validation loss 0.546832854110077

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0116104680396, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0043008
	speed: 0.0197s/iter; left time: 17.4615s
Updating learning rate to 0.003789855280098387
Validation loss decreased (inf --> 0.6603).  Saving model state dict ...
Epoch: 1 cost time: 1.9689412117004395
Epoch: 1, Steps: 123 | Train Loss: 1.0043008 Vali Loss: 0.6603131 Best vali loss: 0.6603131
	iters: 100, epoch: 2 | loss: 0.9668269
	speed: 0.0185s/iter; left time: 14.1251s
Updating learning rate to 0.003362834075128685
Validation loss decreased (0.6603 --> 0.6255).  Saving model state dict ...
Epoch: 2 cost time: 1.5074326992034912
Epoch: 2, Steps: 123 | Train Loss: 0.9668269 Vali Loss: 0.6254851 Best vali loss: 0.6254851
	iters: 100, epoch: 3 | loss: 1.3061041
	speed: 0.0187s/iter; left time: 11.9541s
Updating learning rate to 0.002723751678990667
Epoch: 3 cost time: 1.6563010215759277
Epoch: 3, Steps: 123 | Train Loss: 1.3061041 Vali Loss: 0.6698143 Best vali loss: 0.6254851

best validation loss 0.6254850820168915

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0085244746351, 'e_layers': 4, 'learning_rate': 0.0002432460896, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6680846
	speed: 0.0211s/iter; left time: 23.7751s
	iters: 200, epoch: 4 | loss: 0.7973290
	speed: 0.0130s/iter; left time: 13.3591s
Updating learning rate to 0.0001216230448
Epoch: 4 cost time: 3.5334630012512207
Epoch: 4, Steps: 245 | Train Loss: 0.7327068 Vali Loss: 0.5670691 Best vali loss: 0.5468329
	iters: 100, epoch: 5 | loss: 0.5570312
	speed: 0.0191s/iter; left time: 16.8029s
	iters: 200, epoch: 5 | loss: 1.0207192
	speed: 0.0119s/iter; left time: 9.2687s
Updating learning rate to 7.507992056124292e-05
Epoch: 5 cost time: 2.6474552154541016
Epoch: 5, Steps: 245 | Train Loss: 0.7888752 Vali Loss: 0.5559127 Best vali loss: 0.5468329
	iters: 100, epoch: 6 | loss: 0.5667155
	speed: 0.0211s/iter; left time: 13.3915s
	iters: 200, epoch: 6 | loss: 0.7968767
	speed: 0.0129s/iter; left time: 6.9401s
Updating learning rate to 3.562256507336474e-05
Epoch: 6 cost time: 3.136291980743408
Epoch: 6, Steps: 245 | Train Loss: 0.6817961 Vali Loss: 0.5518633 Best vali loss: 0.5468329
	iters: 100, epoch: 7 | loss: 0.6338535
	speed: 0.0239s/iter; left time: 9.3613s
	iters: 200, epoch: 7 | loss: 0.4958812
	speed: 0.0166s/iter; left time: 4.8254s
Updating learning rate to 9.258003027576716e-06
Epoch: 7 cost time: 3.4863719940185547
Epoch: 7, Steps: 245 | Train Loss: 0.5648673 Vali Loss: 0.5589862 Best vali loss: 0.5468329
	iters: 100, epoch: 8 | loss: 0.6097738
	speed: 0.0287s/iter; left time: 4.1887s
	iters: 200, epoch: 8 | loss: 0.7483001
	speed: 0.0121s/iter; left time: 0.5545s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.038661241531372
Epoch: 8, Steps: 245 | Train Loss: 0.6790369 Vali Loss: 0.5629191 Best vali loss: 0.5468329

best validation loss 0.546832854110077

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0089535382196, 'e_layers': 3, 'learning_rate': 0.0006340530307, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3583994
	speed: 0.0228s/iter; left time: 87.1568s
	iters: 200, epoch: 1 | loss: 1.5326533
	speed: 0.0139s/iter; left time: 51.6007s
	iters: 300, epoch: 1 | loss: 0.9207801
	speed: 0.0083s/iter; left time: 29.8913s
	iters: 400, epoch: 1 | loss: 0.9629396
	speed: 0.0109s/iter; left time: 38.5019s
Updating learning rate to 0.0006099208241452403
Validation loss decreased (inf --> 0.6111).  Saving model state dict ...
Epoch: 1 cost time: 6.402161359786987
Epoch: 1, Steps: 490 | Train Loss: 0.9436931 Vali Loss: 0.6111382 Best vali loss: 0.6111382
	iters: 100, epoch: 2 | loss: 0.5810447
	speed: 0.0374s/iter; left time: 124.6023s
	iters: 200, epoch: 2 | loss: 0.9588910
	speed: 0.0173s/iter; left time: 55.9895s
	iters: 300, epoch: 2 | loss: 0.5628597
	speed: 0.0111s/iter; left time: 34.7905s
	iters: 400, epoch: 2 | loss: 0.4009055
	speed: 0.0093s/iter; left time: 28.1883s
Updating learning rate to 0.0005411981141699261
Validation loss decreased (0.6111 --> 0.6073).  Saving model state dict ...
Epoch: 2 cost time: 5.994530439376831
Epoch: 2, Steps: 490 | Train Loss: 0.6259252 Vali Loss: 0.6073078 Best vali loss: 0.6073078
	iters: 100, epoch: 3 | loss: 0.4933106
	speed: 0.0241s/iter; left time: 68.4732s
	iters: 200, epoch: 3 | loss: 1.0477219
	speed: 0.0110s/iter; left time: 30.1217s
	iters: 300, epoch: 3 | loss: 0.6237901
	speed: 0.0092s/iter; left time: 24.2500s
	iters: 400, epoch: 3 | loss: 0.6989009
	speed: 0.0084s/iter; left time: 21.2191s
Updating learning rate to 0.00043834731039488184
Epoch: 3 cost time: 4.897216081619263
Epoch: 3, Steps: 490 | Train Loss: 0.7159309 Vali Loss: 0.6260444 Best vali loss: 0.6073078
	iters: 100, epoch: 4 | loss: 1.3479517
	speed: 0.0395s/iter; left time: 92.8836s
	iters: 200, epoch: 4 | loss: 0.9965379
	speed: 0.0194s/iter; left time: 43.6943s
	iters: 300, epoch: 4 | loss: 1.4488398
	speed: 0.0085s/iter; left time: 18.3863s
	iters: 400, epoch: 4 | loss: 0.6054835
	speed: 0.0134s/iter; left time: 27.5440s
Updating learning rate to 0.00031702651535
Validation loss decreased (0.6073 --> 0.5879).  Saving model state dict ...
Epoch: 4 cost time: 6.852835655212402
Epoch: 4, Steps: 490 | Train Loss: 1.0997032 Vali Loss: 0.5878808 Best vali loss: 0.5878808
	iters: 100, epoch: 5 | loss: 0.5401019
	speed: 0.0558s/iter; left time: 103.8400s
	iters: 200, epoch: 5 | loss: 0.9648232
	speed: 0.0115s/iter; left time: 20.3185s
	iters: 300, epoch: 5 | loss: 0.5473192
	speed: 0.0122s/iter; left time: 20.2506s
	iters: 400, epoch: 5 | loss: 0.7530239
	speed: 0.0109s/iter; left time: 16.9580s
Updating learning rate to 0.00019570572030511822
Validation loss decreased (0.5879 --> 0.5872).  Saving model state dict ...
Epoch: 5 cost time: 5.668800592422485
Epoch: 5, Steps: 490 | Train Loss: 0.7013171 Vali Loss: 0.5872449 Best vali loss: 0.5872449
	iters: 100, epoch: 6 | loss: 0.8910964
	speed: 0.0315s/iter; left time: 43.1691s
	iters: 200, epoch: 6 | loss: 0.4652725
	speed: 0.0118s/iter; left time: 15.0202s
	iters: 300, epoch: 6 | loss: 1.0510424
	speed: 0.0116s/iter; left time: 13.5827s
	iters: 400, epoch: 6 | loss: 0.9663931
	speed: 0.0115s/iter; left time: 12.3112s
Updating learning rate to 9.285491653007392e-05
Validation loss decreased (0.5872 --> 0.5795).  Saving model state dict ...
Epoch: 6 cost time: 5.704884052276611
Epoch: 6, Steps: 490 | Train Loss: 0.8434511 Vali Loss: 0.5794796 Best vali loss: 0.5794796
	iters: 100, epoch: 7 | loss: 1.3115866
	speed: 0.0332s/iter; left time: 29.2809s
	iters: 200, epoch: 7 | loss: 0.3246924
	speed: 0.0116s/iter; left time: 9.0213s
	iters: 300, epoch: 7 | loss: 0.6339185
	speed: 0.0116s/iter; left time: 7.8920s
	iters: 400, epoch: 7 | loss: 0.7238310
	speed: 0.0118s/iter; left time: 6.8430s
Updating learning rate to 2.413220655475973e-05
Epoch: 7 cost time: 5.667145252227783
Epoch: 7, Steps: 490 | Train Loss: 0.7485071 Vali Loss: 0.5806564 Best vali loss: 0.5794796
	iters: 100, epoch: 8 | loss: 0.7937874
	speed: 0.0310s/iter; left time: 12.1355s
	iters: 200, epoch: 8 | loss: 0.5245807
	speed: 0.0153s/iter; left time: 4.4468s
	iters: 300, epoch: 8 | loss: 0.5853137
	speed: 0.0146s/iter; left time: 2.7839s
	iters: 400, epoch: 8 | loss: 0.7206912
	speed: 0.0154s/iter; left time: 1.4036s
Updating learning rate to 0.0
Validation loss decreased (0.5795 --> 0.5777).  Saving model state dict ...
Epoch: 8 cost time: 7.256316184997559
Epoch: 8, Steps: 490 | Train Loss: 0.6560933 Vali Loss: 0.5777169 Best vali loss: 0.5777169

best validation loss 0.5777169384031261

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0009480992592, 'e_layers': 3, 'learning_rate': 6.1855838e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3861855
	speed: 0.0117s/iter; left time: 90.1699s
	iters: 200, epoch: 1 | loss: 1.4823347
	speed: 0.0072s/iter; left time: 54.8735s
	iters: 300, epoch: 1 | loss: 1.1689490
	speed: 0.0119s/iter; left time: 89.9516s
	iters: 400, epoch: 1 | loss: 0.5160320
	speed: 0.0113s/iter; left time: 84.2486s
	iters: 500, epoch: 1 | loss: 0.4034784
	speed: 0.0119s/iter; left time: 87.4073s
	iters: 600, epoch: 1 | loss: 1.8922082
	speed: 0.0118s/iter; left time: 85.5004s
	iters: 700, epoch: 1 | loss: 1.1508782
	speed: 0.0108s/iter; left time: 76.7099s
	iters: 800, epoch: 1 | loss: 0.5136508
	speed: 0.0121s/iter; left time: 84.7479s
	iters: 900, epoch: 1 | loss: 1.5100439
	speed: 0.0115s/iter; left time: 79.9459s
Updating learning rate to 6.1855838e-05
Validation loss decreased (inf --> 0.6497).  Saving model state dict ...
Epoch: 1 cost time: 10.428846836090088
Epoch: 1, Steps: 979 | Train Loss: 1.0026401 Vali Loss: 0.6497468 Best vali loss: 0.6497468
	iters: 100, epoch: 2 | loss: 0.3444147
	speed: 0.0280s/iter; left time: 188.8115s
	iters: 200, epoch: 2 | loss: 0.3295741
	speed: 0.0066s/iter; left time: 44.1449s
	iters: 300, epoch: 2 | loss: 0.6645577
	speed: 0.0121s/iter; left time: 79.6245s
	iters: 400, epoch: 2 | loss: 1.9376614
	speed: 0.0132s/iter; left time: 85.2822s
	iters: 500, epoch: 2 | loss: 1.1062294
	speed: 0.0124s/iter; left time: 78.4866s
	iters: 600, epoch: 2 | loss: 0.4527843
	speed: 0.0122s/iter; left time: 76.1030s
	iters: 700, epoch: 2 | loss: 0.8223728
	speed: 0.0130s/iter; left time: 79.8157s
	iters: 800, epoch: 2 | loss: 0.3362015
	speed: 0.0129s/iter; left time: 78.3842s
	iters: 900, epoch: 2 | loss: 0.6159492
	speed: 0.0118s/iter; left time: 70.3387s
Updating learning rate to 3.0927919e-05
Validation loss decreased (0.6497 --> 0.6247).  Saving model state dict ...
Epoch: 2 cost time: 11.241405248641968
Epoch: 2, Steps: 979 | Train Loss: 0.7344161 Vali Loss: 0.6247041 Best vali loss: 0.6247041
	iters: 100, epoch: 3 | loss: 1.4459889
	speed: 0.0379s/iter; left time: 218.7923s
	iters: 200, epoch: 3 | loss: 1.2943584
	speed: 0.0065s/iter; left time: 36.7911s
	iters: 300, epoch: 3 | loss: 1.1726660
	speed: 0.0094s/iter; left time: 52.1493s
	iters: 400, epoch: 3 | loss: 0.6286269
	speed: 0.0100s/iter; left time: 54.5049s
	iters: 500, epoch: 3 | loss: 1.3090698
	speed: 0.0099s/iter; left time: 53.1777s
	iters: 600, epoch: 3 | loss: 0.3634275
	speed: 0.0099s/iter; left time: 52.4323s
	iters: 700, epoch: 3 | loss: 0.3266560
	speed: 0.0094s/iter; left time: 48.6730s
	iters: 800, epoch: 3 | loss: 1.3868598
	speed: 0.0099s/iter; left time: 50.3298s
	iters: 900, epoch: 3 | loss: 0.7313467
	speed: 0.0096s/iter; left time: 47.9883s
Updating learning rate to 1.54639595e-05
Validation loss decreased (0.6247 --> 0.6185).  Saving model state dict ...
Epoch: 3 cost time: 9.157914161682129
Epoch: 3, Steps: 979 | Train Loss: 0.9621111 Vali Loss: 0.6185120 Best vali loss: 0.6185120
	iters: 100, epoch: 4 | loss: 0.3127586
	speed: 0.0343s/iter; left time: 164.4709s
	iters: 200, epoch: 4 | loss: 1.1311045
	speed: 0.0098s/iter; left time: 45.7974s
	iters: 300, epoch: 4 | loss: 1.3317605
	speed: 0.0098s/iter; left time: 44.9379s
	iters: 400, epoch: 4 | loss: 0.6215885
	speed: 0.0102s/iter; left time: 45.7966s
	iters: 500, epoch: 4 | loss: 0.9773868
	speed: 0.0097s/iter; left time: 42.4839s
	iters: 600, epoch: 4 | loss: 0.3884751
	speed: 0.0090s/iter; left time: 38.7967s
	iters: 700, epoch: 4 | loss: 0.9091179
	speed: 0.0085s/iter; left time: 35.8393s
	iters: 800, epoch: 4 | loss: 0.8032428
	speed: 0.0090s/iter; left time: 36.6788s
	iters: 900, epoch: 4 | loss: 0.6733886
	speed: 0.0113s/iter; left time: 45.3155s
Updating learning rate to 7.73197975e-06
Validation loss decreased (0.6185 --> 0.6170).  Saving model state dict ...
Epoch: 4 cost time: 9.546209573745728
Epoch: 4, Steps: 979 | Train Loss: 0.7943137 Vali Loss: 0.6169891 Best vali loss: 0.6169891
	iters: 100, epoch: 5 | loss: 0.8616827
	speed: 0.0705s/iter; left time: 269.2578s
	iters: 200, epoch: 5 | loss: 0.7723970
	speed: 0.0145s/iter; left time: 54.0407s
	iters: 300, epoch: 5 | loss: 0.7257312
	speed: 0.0170s/iter; left time: 61.4744s
	iters: 400, epoch: 5 | loss: 1.9990191
	speed: 0.0144s/iter; left time: 50.6720s
	iters: 500, epoch: 5 | loss: 0.9089205
	speed: 0.0138s/iter; left time: 47.2169s
	iters: 600, epoch: 5 | loss: 1.8376577
	speed: 0.0134s/iter; left time: 44.5989s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0008465868612, 'e_layers': 1, 'learning_rate': 0.0010598675085, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010598675085
Validation loss decreased (inf --> 0.6217).  Saving model state dict ...
Epoch: 1 cost time: 2.632453203201294
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6216678 Best vali loss: 0.6216678
Updating learning rate to 0.00052993375425
Validation loss decreased (0.6217 --> 0.6096).  Saving model state dict ...
Epoch: 2 cost time: 1.083540678024292
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6095859 Best vali loss: 0.6095859
Updating learning rate to 0.000264966877125
Validation loss decreased (0.6096 --> 0.6077).  Saving model state dict ...
Epoch: 3 cost time: 0.7762024402618408
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6077438 Best vali loss: 0.6077438

best validation loss 0.607743780820362

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0020166857281, 'e_layers': 2, 'learning_rate': 0.0001283445719, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012345974749366663
Validation loss decreased (inf --> 0.6573).  Saving model state dict ...
Epoch: 1 cost time: 1.4738490581512451
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6573416 Best vali loss: 0.6573416
Updating learning rate to 0.00010954894450948721
Validation loss decreased (0.6573 --> 0.6225).  Saving model state dict ...
Epoch: 2 cost time: 1.3209881782531738
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6224950 Best vali loss: 0.6224950
Updating learning rate to 8.872995660006003e-05
Validation loss decreased (0.6225 --> 0.6090).  Saving model state dict ...
Epoch: 3 cost time: 1.7523345947265625
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6089951 Best vali loss: 0.6089951

best validation loss 0.608995059914525

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017414092288, 'e_layers': 4, 'learning_rate': 0.0037118860825, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3820311
	speed: 0.0216s/iter; left time: 82.5474s
	iters: 200, epoch: 1 | loss: 0.7130939
	speed: 0.0154s/iter; left time: 57.2056s
	iters: 300, epoch: 1 | loss: 0.5164706
	speed: 0.0104s/iter; left time: 37.4945s
	iters: 400, epoch: 1 | loss: 0.5795542
	speed: 0.0128s/iter; left time: 45.1078s
Updating learning rate to 0.0035706108305676256
Validation loss decreased (inf --> 0.6411).  Saving model state dict ...
Epoch: 1 cost time: 6.866442918777466
Epoch: 1, Steps: 490 | Train Loss: 0.5477874 Vali Loss: 0.6411185 Best vali loss: 0.6411185
	iters: 100, epoch: 2 | loss: 1.2877730
	speed: 0.0333s/iter; left time: 110.9950s
	iters: 200, epoch: 2 | loss: 1.0970227
	speed: 0.0131s/iter; left time: 42.4836s
	iters: 300, epoch: 2 | loss: 1.4133950
	speed: 0.0123s/iter; left time: 38.6509s
	iters: 400, epoch: 2 | loss: 0.3258515
	speed: 0.0127s/iter; left time: 38.5483s
Updating learning rate to 0.003168292951213859
Epoch: 2 cost time: 6.108889579772949
Epoch: 2, Steps: 490 | Train Loss: 1.0310106 Vali Loss: 0.6451211 Best vali loss: 0.6411185
	iters: 100, epoch: 3 | loss: 0.9869276
	speed: 0.0306s/iter; left time: 86.8285s
	iters: 200, epoch: 3 | loss: 1.2086962
	speed: 0.0129s/iter; left time: 35.4282s
	iters: 300, epoch: 3 | loss: 0.5968894
	speed: 0.0133s/iter; left time: 35.1032s
	iters: 400, epoch: 3 | loss: 0.8339370
	speed: 0.0129s/iter; left time: 32.7423s
Updating learning rate to 0.0025661816945496537
Validation loss decreased (0.6411 --> 0.6180).  Saving model state dict ...
Epoch: 3 cost time: 6.189085483551025
Epoch: 3, Steps: 490 | Train Loss: 0.9066126 Vali Loss: 0.6180225 Best vali loss: 0.6180225

best validation loss 0.6180224735281192

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0008465868612, 'e_layers': 1, 'learning_rate': 0.0010598675085, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001324834385625
Epoch: 4 cost time: 1.0660207271575928
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6202003 Best vali loss: 0.6077438
Updating learning rate to 6.624171928125e-05
Epoch: 5 cost time: 0.6567318439483643
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6378512 Best vali loss: 0.6077438
Updating learning rate to 3.3120859640625e-05
Epoch: 6 cost time: 0.6453640460968018
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6313008 Best vali loss: 0.6077438
Updating learning rate to 1.65604298203125e-05
Epoch: 7 cost time: 0.6701335906982422
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6314101 Best vali loss: 0.6077438
Updating learning rate to 8.28021491015625e-06
Epoch: 8 cost time: 0.7063663005828857
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6349422 Best vali loss: 0.6077438

best validation loss 0.607743780820362

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0011930903227, 'e_layers': 4, 'learning_rate': 5.40218049e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.40218049e-05
Validation loss decreased (inf --> 0.6759).  Saving model state dict ...
Epoch: 1 cost time: 1.0655474662780762
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6759137 Best vali loss: 0.6759137
Updating learning rate to 2.701090245e-05
Validation loss decreased (0.6759 --> 0.6500).  Saving model state dict ...
Epoch: 2 cost time: 0.8686392307281494
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6499627 Best vali loss: 0.6499627
Updating learning rate to 1.3505451225e-05
Validation loss decreased (0.6500 --> 0.6413).  Saving model state dict ...
Epoch: 3 cost time: 0.8817236423492432
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6412717 Best vali loss: 0.6412717
Updating learning rate to 6.7527256125e-06
Validation loss decreased (0.6413 --> 0.6377).  Saving model state dict ...
Epoch: 4 cost time: 0.8735198974609375
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6377178 Best vali loss: 0.6377178
Updating learning rate to 3.37636280625e-06
Validation loss decreased (0.6377 --> 0.6359).  Saving model state dict ...
Epoch: 5 cost time: 0.8111627101898193
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6359303 Best vali loss: 0.6359303
Updating learning rate to 1.688181403125e-06
Validation loss decreased (0.6359 --> 0.6352).  Saving model state dict ...
Epoch: 6 cost time: 0.7554378509521484
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6351756 Best vali loss: 0.6351756
Updating learning rate to 8.440907015625e-07
Validation loss decreased (0.6352 --> 0.6348).  Saving model state dict ...
Epoch: 7 cost time: 0.8373992443084717
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6347645 Best vali loss: 0.6347645
Updating learning rate to 4.2204535078125e-07
Validation loss decreased (0.6348 --> 0.6346).  Saving model state dict ...
Epoch: 8 cost time: 0.781177282333374
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6345881 Best vali loss: 0.6345881

best validation loss 0.6345881320767136

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0052896376836, 'e_layers': 4, 'learning_rate': 6.54358408e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2475144
	speed: 0.0182s/iter; left time: 33.8056s
	iters: 200, epoch: 1 | loss: 0.8293325
	speed: 0.0115s/iter; left time: 20.2836s
Updating learning rate to 6.29453374038935e-05
Validation loss decreased (inf --> 0.6744).  Saving model state dict ...
Epoch: 1 cost time: 3.219435453414917
Epoch: 1, Steps: 245 | Train Loss: 1.0384234 Vali Loss: 0.6743735 Best vali loss: 0.6743735
	iters: 100, epoch: 2 | loss: 0.6818669
	speed: 0.0206s/iter; left time: 33.2410s
	iters: 200, epoch: 2 | loss: 0.8171048
	speed: 0.0095s/iter; left time: 14.4118s
Updating learning rate to 5.585298378116168e-05
Validation loss decreased (0.6744 --> 0.6504).  Saving model state dict ...
Epoch: 2 cost time: 2.5357959270477295
Epoch: 2, Steps: 245 | Train Loss: 0.7494859 Vali Loss: 0.6503850 Best vali loss: 0.6503850
	iters: 100, epoch: 3 | loss: 0.7218480
	speed: 0.0190s/iter; left time: 26.0173s
	iters: 200, epoch: 3 | loss: 0.6242388
	speed: 0.0114s/iter; left time: 14.5362s
Updating learning rate to 4.523852647851979e-05
Validation loss decreased (0.6504 --> 0.6373).  Saving model state dict ...
Epoch: 3 cost time: 2.7626025676727295
Epoch: 3, Steps: 245 | Train Loss: 0.6730434 Vali Loss: 0.6373042 Best vali loss: 0.6373042
	iters: 100, epoch: 4 | loss: 0.6727817
	speed: 0.0199s/iter; left time: 22.4244s
	iters: 200, epoch: 4 | loss: 0.6628127
	speed: 0.0108s/iter; left time: 11.1014s
Updating learning rate to 3.27179204e-05
Validation loss decreased (0.6373 --> 0.6326).  Saving model state dict ...
Epoch: 4 cost time: 2.7109432220458984
Epoch: 4, Steps: 245 | Train Loss: 0.6677972 Vali Loss: 0.6326380 Best vali loss: 0.6326380
	iters: 100, epoch: 5 | loss: 0.7468160
	speed: 0.0203s/iter; left time: 17.8755s
	iters: 200, epoch: 5 | loss: 0.9994493
	speed: 0.0093s/iter; left time: 7.2412s
Updating learning rate to 2.019731432148021e-05
Validation loss decreased (0.6326 --> 0.6296).  Saving model state dict ...
Epoch: 5 cost time: 2.474022388458252
Epoch: 5, Steps: 245 | Train Loss: 0.8731326 Vali Loss: 0.6295559 Best vali loss: 0.6295559
	iters: 100, epoch: 6 | loss: 0.8027444
	speed: 0.0181s/iter; left time: 11.5048s
	iters: 200, epoch: 6 | loss: 1.1245855
	speed: 0.0102s/iter; left time: 5.4801s
Updating learning rate to 9.582857018838323e-06
Validation loss decreased (0.6296 --> 0.6264).  Saving model state dict ...
Epoch: 6 cost time: 2.5808067321777344
Epoch: 6, Steps: 245 | Train Loss: 0.9636649 Vali Loss: 0.6263527 Best vali loss: 0.6263527
	iters: 100, epoch: 7 | loss: 1.0330586
	speed: 0.0184s/iter; left time: 7.1769s
	iters: 200, epoch: 7 | loss: 0.7974212
	speed: 0.0096s/iter; left time: 2.8059s
Updating learning rate to 2.4905033961065086e-06
Validation loss decreased (0.6264 --> 0.6254).  Saving model state dict ...
Epoch: 7 cost time: 2.420768976211548
Epoch: 7, Steps: 245 | Train Loss: 0.9152399 Vali Loss: 0.6254305 Best vali loss: 0.6254305
	iters: 100, epoch: 8 | loss: 1.0243696
	speed: 0.0188s/iter; left time: 2.7499s
	iters: 200, epoch: 8 | loss: 0.7337335
	speed: 0.0113s/iter; left time: 0.5212s
Updating learning rate to 0.0
Validation loss decreased (0.6254 --> 0.6252).  Saving model state dict ...
Epoch: 8 cost time: 2.8125998973846436
Epoch: 8, Steps: 245 | Train Loss: 0.8790516 Vali Loss: 0.6252319 Best vali loss: 0.6252319

best validation loss 0.6252318743697365

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0057213447335, 'e_layers': 4, 'learning_rate': 0.0001640904142, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1443840
	speed: 0.0185s/iter; left time: 16.4089s
Updating learning rate to 0.0001578450946803397
Validation loss decreased (inf --> 0.6392).  Saving model state dict ...
Epoch: 1 cost time: 1.8403995037078857
Epoch: 1, Steps: 123 | Train Loss: 1.1443840 Vali Loss: 0.6391719 Best vali loss: 0.6391719
	iters: 100, epoch: 2 | loss: 1.0147531
	speed: 0.0189s/iter; left time: 14.4335s
Updating learning rate to 0.00014005992940426467
Validation loss decreased (0.6392 --> 0.6238).  Saving model state dict ...
Epoch: 2 cost time: 1.5073096752166748
Epoch: 2, Steps: 123 | Train Loss: 1.0147531 Vali Loss: 0.6238255 Best vali loss: 0.6238255
	iters: 100, epoch: 3 | loss: 0.7693520
	speed: 0.0233s/iter; left time: 14.9009s
Updating learning rate to 0.00011344254856213264
Validation loss decreased (0.6238 --> 0.6103).  Saving model state dict ...
Epoch: 3 cost time: 2.1060171127319336
Epoch: 3, Steps: 123 | Train Loss: 0.7693520 Vali Loss: 0.6103281 Best vali loss: 0.6103281

best validation loss 0.61032812874497

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012364726522, 'e_layers': 4, 'learning_rate': 0.0007587705096, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0823983
	speed: 0.0253s/iter; left time: 47.0873s
	iters: 200, epoch: 1 | loss: 0.4819104
	speed: 0.0148s/iter; left time: 25.9994s
Updating learning rate to 0.0007587705096
Validation loss decreased (inf --> 0.6170).  Saving model state dict ...
Epoch: 1 cost time: 4.506934404373169
Epoch: 1, Steps: 245 | Train Loss: 0.7821544 Vali Loss: 0.6169811 Best vali loss: 0.6169811
	iters: 100, epoch: 2 | loss: 0.8999553
	speed: 0.0299s/iter; left time: 48.3560s
	iters: 200, epoch: 2 | loss: 0.9852628
	speed: 0.0166s/iter; left time: 25.2093s
Updating learning rate to 0.0003793852548
Validation loss decreased (0.6170 --> 0.6013).  Saving model state dict ...
Epoch: 2 cost time: 3.9706969261169434
Epoch: 2, Steps: 245 | Train Loss: 0.9426091 Vali Loss: 0.6012672 Best vali loss: 0.6012672
	iters: 100, epoch: 3 | loss: 0.7219294
	speed: 0.0286s/iter; left time: 39.2473s
	iters: 200, epoch: 3 | loss: 0.7166719
	speed: 0.0077s/iter; left time: 9.8136s
Updating learning rate to 0.0001896926274
Epoch: 3 cost time: 2.7282886505126953
Epoch: 3, Steps: 245 | Train Loss: 0.7193007 Vali Loss: 0.6080869 Best vali loss: 0.6012672

best validation loss 0.6012672385315496

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0047956796232, 'e_layers': 1, 'learning_rate': 0.0034849637707, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9127083
	speed: 0.0140s/iter; left time: 53.5256s
	iters: 200, epoch: 1 | loss: 1.0738789
	speed: 0.0076s/iter; left time: 28.2046s
	iters: 300, epoch: 1 | loss: 0.8112542
	speed: 0.0066s/iter; left time: 23.9443s
	iters: 400, epoch: 1 | loss: 0.6555588
	speed: 0.0076s/iter; left time: 26.7632s
Updating learning rate to 0.0034849637707
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 3.965636730194092
Epoch: 1, Steps: 490 | Train Loss: 0.8633500 Vali Loss: 0.6173127 Best vali loss: 0.6173127
	iters: 100, epoch: 2 | loss: 0.7343562
	speed: 0.0227s/iter; left time: 75.7108s
	iters: 200, epoch: 2 | loss: 0.4029593
	speed: 0.0063s/iter; left time: 20.4974s
	iters: 300, epoch: 2 | loss: 0.7959583
	speed: 0.0061s/iter; left time: 19.0759s
	iters: 400, epoch: 2 | loss: 1.1929336
	speed: 0.0062s/iter; left time: 18.7278s
Updating learning rate to 0.00174248188535
Epoch: 2 cost time: 3.2015151977539062
Epoch: 2, Steps: 490 | Train Loss: 0.7815519 Vali Loss: 0.6248461 Best vali loss: 0.6173127
	iters: 100, epoch: 3 | loss: 0.9015625
	speed: 0.0215s/iter; left time: 61.0104s
	iters: 200, epoch: 3 | loss: 0.9554996
	speed: 0.0068s/iter; left time: 18.6926s
	iters: 300, epoch: 3 | loss: 0.6672860
	speed: 0.0072s/iter; left time: 18.9880s
	iters: 400, epoch: 3 | loss: 0.6901428
	speed: 0.0068s/iter; left time: 17.1815s
Updating learning rate to 0.000871240942675
Epoch: 3 cost time: 3.3300085067749023
Epoch: 3, Steps: 490 | Train Loss: 0.8036227 Vali Loss: 0.6546323 Best vali loss: 0.6173127

best validation loss 0.6173126890338279

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012364726522, 'e_layers': 4, 'learning_rate': 0.0007587705096, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8845736
	speed: 0.0168s/iter; left time: 18.9287s
	iters: 200, epoch: 4 | loss: 0.4654337
	speed: 0.0084s/iter; left time: 8.6161s
Updating learning rate to 9.48463137e-05
Epoch: 4 cost time: 2.507622241973877
Epoch: 4, Steps: 245 | Train Loss: 0.6750037 Vali Loss: 0.6139651 Best vali loss: 0.6012672
	iters: 100, epoch: 5 | loss: 0.8329130
	speed: 0.0181s/iter; left time: 15.9715s
	iters: 200, epoch: 5 | loss: 0.9516503
	speed: 0.0101s/iter; left time: 7.8715s
Updating learning rate to 4.742315685e-05
Epoch: 5 cost time: 2.4910194873809814
Epoch: 5, Steps: 245 | Train Loss: 0.8922816 Vali Loss: 0.6115720 Best vali loss: 0.6012672
	iters: 100, epoch: 6 | loss: 0.7082326
	speed: 0.0172s/iter; left time: 10.9306s
	iters: 200, epoch: 6 | loss: 0.6634297
	speed: 0.0094s/iter; left time: 5.0136s
Updating learning rate to 2.3711578425e-05
Epoch: 6 cost time: 2.338533878326416
Epoch: 6, Steps: 245 | Train Loss: 0.6858312 Vali Loss: 0.6105455 Best vali loss: 0.6012672
	iters: 100, epoch: 7 | loss: 0.5992435
	speed: 0.0169s/iter; left time: 6.5901s
	iters: 200, epoch: 7 | loss: 0.5375591
	speed: 0.0084s/iter; left time: 2.4542s
Updating learning rate to 1.18557892125e-05
Epoch: 7 cost time: 2.1615099906921387
Epoch: 7, Steps: 245 | Train Loss: 0.5684013 Vali Loss: 0.6100099 Best vali loss: 0.6012672
	iters: 100, epoch: 8 | loss: 1.3348742
	speed: 0.0168s/iter; left time: 2.4468s
	iters: 200, epoch: 8 | loss: 1.2167394
	speed: 0.0094s/iter; left time: 0.4343s
Updating learning rate to 5.92789460625e-06
Epoch: 8 cost time: 2.3490710258483887
Epoch: 8, Steps: 245 | Train Loss: 1.2758068 Vali Loss: 0.6100368 Best vali loss: 0.6012672

best validation loss 0.6012672385315496

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.008185356593, 'e_layers': 1, 'learning_rate': 7.05467169e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9932190
	speed: 0.0103s/iter; left time: 79.6620s
	iters: 200, epoch: 1 | loss: 1.3375388
	speed: 0.0043s/iter; left time: 32.8575s
	iters: 300, epoch: 1 | loss: 1.2658809
	speed: 0.0043s/iter; left time: 32.7679s
	iters: 400, epoch: 1 | loss: 1.1324819
	speed: 0.0045s/iter; left time: 33.6409s
	iters: 500, epoch: 1 | loss: 0.5870472
	speed: 0.0045s/iter; left time: 33.2595s
	iters: 600, epoch: 1 | loss: 1.4034300
	speed: 0.0044s/iter; left time: 31.8767s
	iters: 700, epoch: 1 | loss: 0.3985705
	speed: 0.0046s/iter; left time: 32.7554s
	iters: 800, epoch: 1 | loss: 0.7698573
	speed: 0.0042s/iter; left time: 29.4512s
	iters: 900, epoch: 1 | loss: 0.6395025
	speed: 0.0042s/iter; left time: 29.2538s
Updating learning rate to 7.05467169e-05
Validation loss decreased (inf --> 0.6186).  Saving model state dict ...
Epoch: 1 cost time: 4.595026731491089
Epoch: 1, Steps: 979 | Train Loss: 0.9475031 Vali Loss: 0.6185553 Best vali loss: 0.6185553
	iters: 100, epoch: 2 | loss: 0.4545780
	speed: 0.0172s/iter; left time: 115.9872s
	iters: 200, epoch: 2 | loss: 1.0635891
	speed: 0.0043s/iter; left time: 28.8974s
	iters: 300, epoch: 2 | loss: 0.5194209
	speed: 0.0042s/iter; left time: 27.3219s
	iters: 400, epoch: 2 | loss: 0.9312938
	speed: 0.0042s/iter; left time: 26.9216s
	iters: 500, epoch: 2 | loss: 0.6726969
	speed: 0.0042s/iter; left time: 26.4038s
	iters: 600, epoch: 2 | loss: 0.6805292
	speed: 0.0040s/iter; left time: 24.8721s
	iters: 700, epoch: 2 | loss: 0.4532405
	speed: 0.0038s/iter; left time: 23.1878s
	iters: 800, epoch: 2 | loss: 1.3939351
	speed: 0.0040s/iter; left time: 24.0229s
	iters: 900, epoch: 2 | loss: 0.6170142
	speed: 0.0061s/iter; left time: 36.3437s
Updating learning rate to 3.527335845e-05
Validation loss decreased (0.6186 --> 0.6084).  Saving model state dict ...
Epoch: 2 cost time: 4.489207029342651
Epoch: 2, Steps: 979 | Train Loss: 0.7540331 Vali Loss: 0.6083996 Best vali loss: 0.6083996
	iters: 100, epoch: 3 | loss: 0.8777848
	speed: 0.0243s/iter; left time: 140.3352s
	iters: 200, epoch: 3 | loss: 0.5499874
	speed: 0.0062s/iter; left time: 34.9791s
	iters: 300, epoch: 3 | loss: 0.7602691
	speed: 0.0056s/iter; left time: 31.3988s
	iters: 400, epoch: 3 | loss: 0.7059261
	speed: 0.0059s/iter; left time: 32.0434s
	iters: 500, epoch: 3 | loss: 0.2810223
	speed: 0.0066s/iter; left time: 35.7076s
	iters: 600, epoch: 3 | loss: 0.6538738
	speed: 0.0067s/iter; left time: 35.2832s
	iters: 700, epoch: 3 | loss: 0.7333580
	speed: 0.0068s/iter; left time: 35.3497s
	iters: 800, epoch: 3 | loss: 0.7982733
	speed: 0.0069s/iter; left time: 35.1484s
	iters: 900, epoch: 3 | loss: 0.6491916
	speed: 0.0069s/iter; left time: 34.4269s
Updating learning rate to 1.7636679225e-05
Validation loss decreased (0.6084 --> 0.6026).  Saving model state dict ...
Epoch: 3 cost time: 6.401432275772095
Epoch: 3, Steps: 979 | Train Loss: 0.6677429 Vali Loss: 0.6025588 Best vali loss: 0.6025588
	iters: 100, epoch: 4 | loss: 0.5407814
	speed: 0.0214s/iter; left time: 102.4840s
	iters: 200, epoch: 4 | loss: 0.7247197
	speed: 0.0038s/iter; left time: 17.8510s
	iters: 300, epoch: 4 | loss: 0.2956133
	speed: 0.0038s/iter; left time: 17.2998s
	iters: 400, epoch: 4 | loss: 0.8230363
	speed: 0.0040s/iter; left time: 17.9921s
	iters: 500, epoch: 4 | loss: 0.8840978
	speed: 0.0040s/iter; left time: 17.7565s
	iters: 600, epoch: 4 | loss: 1.6413987
	speed: 0.0044s/iter; left time: 18.7025s
	iters: 700, epoch: 4 | loss: 1.2855500
	speed: 0.0039s/iter; left time: 16.3618s
	iters: 800, epoch: 4 | loss: 0.5685282
	speed: 0.0038s/iter; left time: 15.5846s
	iters: 900, epoch: 4 | loss: 0.9859974
	speed: 0.0041s/iter; left time: 16.2800s
Updating learning rate to 8.8183396125e-06
Epoch: 4 cost time: 4.003814935684204
Epoch: 4, Steps: 979 | Train Loss: 0.8610803 Vali Loss: 0.6031734 Best vali loss: 0.6025588
	iters: 100, epoch: 5 | loss: 1.1174865
	speed: 0.0160s/iter; left time: 60.9352s
	iters: 200, epoch: 5 | loss: 0.4598222
	speed: 0.0041s/iter; left time: 15.2791s
	iters: 300, epoch: 5 | loss: 0.5657655
	speed: 0.0037s/iter; left time: 13.2433s
	iters: 400, epoch: 5 | loss: 1.0506063
	speed: 0.0040s/iter; left time: 13.9270s
	iters: 500, epoch: 5 | loss: 1.3890991
	speed: 0.0045s/iter; left time: 15.3108s
	iters: 600, epoch: 5 | loss: 0.8532095
	speed: 0.0044s/iter; left time: 14.5258s
	iters: 700, epoch: 5 | loss: 0.6736550
	speed: 0.0044s/iter; left time: 14.1237s
	iters: 800, epoch: 5 | loss: 0.5583761
	speed: 0.0045s/iter; left time: 13.9146s
	iters: 900, epoch: 5 | loss: 0.4964036
	speed: 0.0040s/iter; left time: 12.0485s
Updating learning rate to 4.40916980625e-06
Epoch: 5 cost time: 4.106269836425781
Epoch: 5, Steps: 979 | Train Loss: 0.7960471 Vali Loss: 0.6038837 Best vali loss: 0.6025588
	iters: 100, epoch: 6 | loss: 0.8184171
	speed: 0.0147s/iter; left time: 41.5791s
	iters: 200, epoch: 6 | loss: 0.5870934
	speed: 0.0051s/iter; left time: 14.0875s
	iters: 300, epoch: 6 | loss: 0.8018555
	speed: 0.0058s/iter; left time: 15.2336s
	iters: 400, epoch: 6 | loss: 0.3398995
	speed: 0.0054s/iter; left time: 13.6102s
	iters: 500, epoch: 6 | loss: 0.7663047
	speed: 0.0064s/iter; left time: 15.5007s
	iters: 600, epoch: 6 | loss: 0.9114576
	speed: 0.0058s/iter; left time: 13.4611s
	iters: 700, epoch: 6 | loss: 1.1319416
	speed: 0.0055s/iter; left time: 12.2627s
	iters: 800, epoch: 6 | loss: 1.0532347
	speed: 0.0058s/iter; left time: 12.4013s
	iters: 900, epoch: 6 | loss: 0.3974829
	speed: 0.0047s/iter; left time: 9.5050s
Updating learning rate to 2.204584903125e-06
Epoch: 6 cost time: 5.132239580154419
Epoch: 6, Steps: 979 | Train Loss: 0.7564097 Vali Loss: 0.6038346 Best vali loss: 0.6025588
	iters: 100, epoch: 7 | loss: 0.7693343
	speed: 0.0171s/iter; left time: 31.7364s
	iters: 200, epoch: 7 | loss: 0.3865603
	speed: 0.0052s/iter; left time: 9.1331s
	iters: 300, epoch: 7 | loss: 0.4791116
	speed: 0.0057s/iter; left time: 9.5097s
	iters: 400, epoch: 7 | loss: 0.5029460
	speed: 0.0060s/iter; left time: 9.2873s
	iters: 500, epoch: 7 | loss: 0.9119648
	speed: 0.0063s/iter; left time: 9.1604s
	iters: 600, epoch: 7 | loss: 0.3689149
	speed: 0.0056s/iter; left time: 7.6624s
	iters: 700, epoch: 7 | loss: 0.7009668
	speed: 0.0063s/iter; left time: 7.9118s
	iters: 800, epoch: 7 | loss: 1.3353944
	speed: 0.0049s/iter; left time: 5.7137s
	iters: 900, epoch: 7 | loss: 0.3230608
	speed: 0.0034s/iter; left time: 3.6130s
Updating learning rate to 1.1022924515625e-06
Epoch: 7 cost time: 5.209481716156006
Epoch: 7, Steps: 979 | Train Loss: 0.6420282 Vali Loss: 0.6037486 Best vali loss: 0.6025588
	iters: 100, epoch: 8 | loss: 0.4424989
	speed: 0.0198s/iter; left time: 17.4436s
	iters: 200, epoch: 8 | loss: 1.1193902
	speed: 0.0055s/iter; left time: 4.2861s
	iters: 300, epoch: 8 | loss: 1.0569493
	speed: 0.0047s/iter; left time: 3.1870s
	iters: 400, epoch: 8 | loss: 0.3565292
	speed: 0.0048s/iter; left time: 2.7627s
	iters: 500, epoch: 8 | loss: 1.0230469
	speed: 0.0046s/iter; left time: 2.1978s
	iters: 600, epoch: 8 | loss: 1.1992683
	speed: 0.0047s/iter; left time: 1.8047s
	iters: 700, epoch: 8 | loss: 0.3435419
	speed: 0.0042s/iter; left time: 1.1675s
	iters: 800, epoch: 8 | loss: 0.3258145
	speed: 0.0049s/iter; left time: 0.8818s
	iters: 900, epoch: 8 | loss: 0.7487850
	speed: 0.0047s/iter; left time: 0.3777s
Updating learning rate to 5.5114622578125e-07
Epoch: 8 cost time: 4.700964450836182
Epoch: 8, Steps: 979 | Train Loss: 0.7350916 Vali Loss: 0.6037399 Best vali loss: 0.6025588

best validation loss 0.602558840305813

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0088339346878, 'e_layers': 2, 'learning_rate': 0.0034280523943, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0034280523943
Validation loss decreased (inf --> 0.6244).  Saving model state dict ...
Epoch: 1 cost time: 0.8203780651092529
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6244129 Best vali loss: 0.6244129
Updating learning rate to 0.00171402619715
Validation loss decreased (0.6244 --> 0.6052).  Saving model state dict ...
Epoch: 2 cost time: 0.5951809883117676
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6052319 Best vali loss: 0.6052319
Updating learning rate to 0.000857013098575
Epoch: 3 cost time: 0.754741907119751
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6119923 Best vali loss: 0.6052319
Updating learning rate to 0.0004285065492875
Epoch: 4 cost time: 1.0305190086364746
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6140813 Best vali loss: 0.6052319
Updating learning rate to 0.00021425327464375
Epoch: 5 cost time: 1.2573509216308594
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6235130 Best vali loss: 0.6052319
Updating learning rate to 0.000107126637321875
Epoch: 6 cost time: 1.3718640804290771
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6210085 Best vali loss: 0.6052319
Updating learning rate to 5.35633186609375e-05
Epoch: 7 cost time: 1.2970516681671143
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6252568 Best vali loss: 0.6052319
Updating learning rate to 2.678165933046875e-05
Epoch: 8 cost time: 1.1179115772247314
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6264502 Best vali loss: 0.6052319

best validation loss 0.6052319149571621

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0015070952364, 'e_layers': 3, 'learning_rate': 0.0004594115305, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5216258
	speed: 0.0162s/iter; left time: 125.5195s
	iters: 200, epoch: 1 | loss: 0.7089579
	speed: 0.0070s/iter; left time: 53.0729s
	iters: 300, epoch: 1 | loss: 1.2847602
	speed: 0.0099s/iter; left time: 74.4605s
	iters: 400, epoch: 1 | loss: 0.4478228
	speed: 0.0094s/iter; left time: 69.6045s
	iters: 500, epoch: 1 | loss: 2.0552075
	speed: 0.0094s/iter; left time: 69.2493s
	iters: 600, epoch: 1 | loss: 0.7756231
	speed: 0.0098s/iter; left time: 70.5311s
	iters: 700, epoch: 1 | loss: 0.9213171
	speed: 0.0069s/iter; left time: 48.9114s
	iters: 800, epoch: 1 | loss: 0.4381455
	speed: 0.0092s/iter; left time: 64.4339s
	iters: 900, epoch: 1 | loss: 0.5473586
	speed: 0.0106s/iter; left time: 73.4539s
Updating learning rate to 0.0004419262202643174
Validation loss decreased (inf --> 0.6053).  Saving model state dict ...
Epoch: 1 cost time: 9.350626468658447
Epoch: 1, Steps: 979 | Train Loss: 0.8556465 Vali Loss: 0.6052532 Best vali loss: 0.6052532
	iters: 100, epoch: 2 | loss: 0.5284281
	speed: 0.0495s/iter; left time: 334.1830s
	iters: 200, epoch: 2 | loss: 0.9322417
	speed: 0.0102s/iter; left time: 67.9059s
	iters: 300, epoch: 2 | loss: 0.3943368
	speed: 0.0112s/iter; left time: 73.0965s
	iters: 400, epoch: 2 | loss: 0.8160405
	speed: 0.0111s/iter; left time: 71.4160s
	iters: 500, epoch: 2 | loss: 0.8354520
	speed: 0.0111s/iter; left time: 70.6383s
	iters: 600, epoch: 2 | loss: 0.6624199
	speed: 0.0111s/iter; left time: 69.2555s
	iters: 700, epoch: 2 | loss: 0.4643517
	speed: 0.0109s/iter; left time: 66.7897s
	iters: 800, epoch: 2 | loss: 1.1214342
	speed: 0.0099s/iter; left time: 60.1460s
	iters: 900, epoch: 2 | loss: 1.2427931
	speed: 0.0112s/iter; left time: 66.6506s
Updating learning rate to 0.0003921322695359202
Epoch: 2 cost time: 10.602391958236694
Epoch: 2, Steps: 979 | Train Loss: 0.7774998 Vali Loss: 0.6126467 Best vali loss: 0.6052532
	iters: 100, epoch: 3 | loss: 0.3859439
	speed: 0.0385s/iter; left time: 222.5646s
	iters: 200, epoch: 3 | loss: 0.6375208
	speed: 0.0070s/iter; left time: 39.6634s
	iters: 300, epoch: 3 | loss: 0.7994290
	speed: 0.0072s/iter; left time: 40.2685s
	iters: 400, epoch: 3 | loss: 1.0404992
	speed: 0.0069s/iter; left time: 37.6737s
	iters: 500, epoch: 3 | loss: 0.8813338
	speed: 0.0070s/iter; left time: 37.4129s
	iters: 600, epoch: 3 | loss: 0.7783653
	speed: 0.0078s/iter; left time: 41.0871s
	iters: 700, epoch: 3 | loss: 0.5951113
	speed: 0.0075s/iter; left time: 38.8546s
	iters: 800, epoch: 3 | loss: 0.5158303
	speed: 0.0077s/iter; left time: 38.9680s
	iters: 900, epoch: 3 | loss: 0.9153314
	speed: 0.0076s/iter; left time: 37.8675s
Updating learning rate to 0.00031761035592991956
Epoch: 3 cost time: 6.97934365272522
Epoch: 3, Steps: 979 | Train Loss: 0.7277072 Vali Loss: 0.6089756 Best vali loss: 0.6052532

best validation loss 0.6052532190528527

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0030064349367, 'e_layers': 2, 'learning_rate': 0.0015376417237, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6792575
	speed: 0.0146s/iter; left time: 55.9017s
	iters: 200, epoch: 1 | loss: 0.7450584
	speed: 0.0073s/iter; left time: 27.0747s
	iters: 300, epoch: 1 | loss: 1.1127906
	speed: 0.0082s/iter; left time: 29.7204s
	iters: 400, epoch: 1 | loss: 0.4248999
	speed: 0.0079s/iter; left time: 27.6528s
Updating learning rate to 0.0015376417237
Validation loss decreased (inf --> 0.6882).  Saving model state dict ...
Epoch: 1 cost time: 4.24779200553894
Epoch: 1, Steps: 490 | Train Loss: 0.7405016 Vali Loss: 0.6882301 Best vali loss: 0.6882301
	iters: 100, epoch: 2 | loss: 0.9789497
	speed: 0.0226s/iter; left time: 75.2272s
	iters: 200, epoch: 2 | loss: 1.2375088
	speed: 0.0074s/iter; left time: 24.0494s
	iters: 300, epoch: 2 | loss: 0.8567100
	speed: 0.0082s/iter; left time: 25.7680s
	iters: 400, epoch: 2 | loss: 1.6360855
	speed: 0.0077s/iter; left time: 23.3122s
Updating learning rate to 0.00076882086185
Validation loss decreased (0.6882 --> 0.6457).  Saving model state dict ...
Epoch: 2 cost time: 3.9215662479400635
Epoch: 2, Steps: 490 | Train Loss: 1.1773135 Vali Loss: 0.6456565 Best vali loss: 0.6456565
	iters: 100, epoch: 3 | loss: 0.5721691
	speed: 0.0228s/iter; left time: 64.8769s
	iters: 200, epoch: 3 | loss: 0.9505590
	speed: 0.0072s/iter; left time: 19.7492s
	iters: 300, epoch: 3 | loss: 0.6402383
	speed: 0.0049s/iter; left time: 12.9408s
	iters: 400, epoch: 3 | loss: 1.2718297
	speed: 0.0054s/iter; left time: 13.6167s
Updating learning rate to 0.000384410430925
Epoch: 3 cost time: 3.15972900390625
Epoch: 3, Steps: 490 | Train Loss: 0.8586990 Vali Loss: 0.6497519 Best vali loss: 0.6456565

best validation loss 0.6456564866740745

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0081911491825, 'e_layers': 1, 'learning_rate': 0.0002260913018, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0605402
	speed: 0.0094s/iter; left time: 17.4542s
	iters: 200, epoch: 1 | loss: 0.8220100
	speed: 0.0036s/iter; left time: 6.3903s
Updating learning rate to 0.0002260913018
Validation loss decreased (inf --> 0.6044).  Saving model state dict ...
Epoch: 1 cost time: 1.2116906642913818
Epoch: 1, Steps: 245 | Train Loss: 0.9412751 Vali Loss: 0.6044433 Best vali loss: 0.6044433
	iters: 100, epoch: 2 | loss: 0.7981781
	speed: 0.0086s/iter; left time: 13.8674s
	iters: 200, epoch: 2 | loss: 0.6138135
	speed: 0.0039s/iter; left time: 5.9615s
Updating learning rate to 0.0001130456509
Epoch: 2 cost time: 0.9747626781463623
Epoch: 2, Steps: 245 | Train Loss: 0.7059958 Vali Loss: 0.6280242 Best vali loss: 0.6044433
	iters: 100, epoch: 3 | loss: 0.7849678
	speed: 0.0084s/iter; left time: 11.4587s
	iters: 200, epoch: 3 | loss: 0.3409836
	speed: 0.0036s/iter; left time: 4.6066s
Updating learning rate to 5.652282545e-05
Epoch: 3 cost time: 0.9752793312072754
Epoch: 3, Steps: 245 | Train Loss: 0.5629757 Vali Loss: 0.6267943 Best vali loss: 0.6044433

best validation loss 0.60444325768578

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0081911491825, 'e_layers': 1, 'learning_rate': 0.0002260913018, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9184850
	speed: 0.0098s/iter; left time: 11.0472s
	iters: 200, epoch: 4 | loss: 0.6244255
	speed: 0.0036s/iter; left time: 3.7030s
Updating learning rate to 2.8261412725e-05
Epoch: 4 cost time: 1.193922996520996
Epoch: 4, Steps: 245 | Train Loss: 0.7714553 Vali Loss: 0.6247027 Best vali loss: 0.6044433
	iters: 100, epoch: 5 | loss: 0.6763908
	speed: 0.0085s/iter; left time: 7.4586s
	iters: 200, epoch: 5 | loss: 0.5728092
	speed: 0.0039s/iter; left time: 3.0758s
Updating learning rate to 1.41307063625e-05
Epoch: 5 cost time: 1.0432181358337402
Epoch: 5, Steps: 245 | Train Loss: 0.6246000 Vali Loss: 0.6417517 Best vali loss: 0.6044433
	iters: 100, epoch: 6 | loss: 0.7208581
	speed: 0.0090s/iter; left time: 5.7019s
	iters: 200, epoch: 6 | loss: 0.3222653
	speed: 0.0040s/iter; left time: 2.1496s
Updating learning rate to 7.06535318125e-06
Epoch: 6 cost time: 1.0432660579681396
Epoch: 6, Steps: 245 | Train Loss: 0.5215617 Vali Loss: 0.6447139 Best vali loss: 0.6044433
	iters: 100, epoch: 7 | loss: 0.7917498
	speed: 0.0087s/iter; left time: 3.4123s
	iters: 200, epoch: 7 | loss: 1.0123078
	speed: 0.0041s/iter; left time: 1.2028s
Updating learning rate to 3.532676590625e-06
Epoch: 7 cost time: 1.0532703399658203
Epoch: 7, Steps: 245 | Train Loss: 0.9020288 Vali Loss: 0.6396499 Best vali loss: 0.6044433
	iters: 100, epoch: 8 | loss: 0.7863129
	speed: 0.0083s/iter; left time: 1.2151s
	iters: 200, epoch: 8 | loss: 0.8509873
	speed: 0.0035s/iter; left time: 0.1599s
Updating learning rate to 1.7663382953125e-06
Epoch: 8 cost time: 0.9003713130950928
Epoch: 8, Steps: 245 | Train Loss: 0.8186501 Vali Loss: 0.6423693 Best vali loss: 0.6044433

best validation loss 0.60444325768578

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0029993136567, 'e_layers': 1, 'learning_rate': 0.0013574189505, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0013574189505
Validation loss decreased (inf --> 0.6211).  Saving model state dict ...
Epoch: 1 cost time: 0.6593494415283203
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6210629 Best vali loss: 0.6210629
Updating learning rate to 0.00067870947525
Validation loss decreased (0.6211 --> 0.6168).  Saving model state dict ...
Epoch: 2 cost time: 0.45905423164367676
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6167843 Best vali loss: 0.6167843
Updating learning rate to 0.000339354737625
Validation loss decreased (0.6168 --> 0.6104).  Saving model state dict ...
Epoch: 3 cost time: 0.4311487674713135
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6103862 Best vali loss: 0.6103862
Updating learning rate to 0.0001696773688125
Epoch: 4 cost time: 0.4574747085571289
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6419986 Best vali loss: 0.6103862
Updating learning rate to 8.483868440625e-05
Epoch: 5 cost time: 0.40720534324645996
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6527094 Best vali loss: 0.6103862
Updating learning rate to 4.2419342203125e-05
Epoch: 6 cost time: 0.4334526062011719
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6564848 Best vali loss: 0.6103862
Updating learning rate to 2.12096711015625e-05
Epoch: 7 cost time: 0.4257655143737793
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6612448 Best vali loss: 0.6103862
Updating learning rate to 1.060483555078125e-05
Epoch: 8 cost time: 0.43240785598754883
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6559323 Best vali loss: 0.6103862

best validation loss 0.6103862179809564

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0062406611289, 'e_layers': 2, 'learning_rate': 0.0028394982108, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027314262451802697
Validation loss decreased (inf --> 0.6011).  Saving model state dict ...
Epoch: 1 cost time: 0.7319457530975342
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6011144 Best vali loss: 0.6011144
Updating learning rate to 0.0024236633254118745
Epoch: 2 cost time: 0.48398828506469727
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6163319 Best vali loss: 0.6011144
Updating learning rate to 0.0019630635661517376
Epoch: 3 cost time: 0.49180006980895996
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6200906 Best vali loss: 0.6011144
Updating learning rate to 0.0014197491054
Epoch: 4 cost time: 0.48368167877197266
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6179643 Best vali loss: 0.6011144
Updating learning rate to 0.0008764346446482624
Epoch: 5 cost time: 0.4799954891204834
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6107896 Best vali loss: 0.6011144
Updating learning rate to 0.0004158348853881257
Epoch: 6 cost time: 0.4715871810913086
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6309947 Best vali loss: 0.6011144
Updating learning rate to 0.00010807196561973045
Epoch: 7 cost time: 0.47183728218078613
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6565240 Best vali loss: 0.6011144
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4596390724182129
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6539654 Best vali loss: 0.6011144

best validation loss 0.6011143763933618

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022985164426, 'e_layers': 2, 'learning_rate': 0.0001464215762, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0060148
	speed: 0.0111s/iter; left time: 9.8458s
Updating learning rate to 0.00014084873678461086
Validation loss decreased (inf --> 0.6061).  Saving model state dict ...
Epoch: 1 cost time: 0.9632747173309326
Epoch: 1, Steps: 123 | Train Loss: 1.0060148 Vali Loss: 0.6060996 Best vali loss: 0.6060996
	iters: 100, epoch: 2 | loss: 0.9756962
	speed: 0.0087s/iter; left time: 6.6044s
Updating learning rate to 0.0001249786328215214
Validation loss decreased (0.6061 --> 0.5954).  Saving model state dict ...
Epoch: 2 cost time: 0.6891021728515625
Epoch: 2, Steps: 123 | Train Loss: 0.9756962 Vali Loss: 0.5954390 Best vali loss: 0.5954390
	iters: 100, epoch: 3 | loss: 0.8810237
	speed: 0.0091s/iter; left time: 5.8112s
Updating learning rate to 0.00010122734377626127
Epoch: 3 cost time: 0.7178068161010742
Epoch: 3, Steps: 123 | Train Loss: 0.8810237 Vali Loss: 0.5961940 Best vali loss: 0.5954390

best validation loss 0.5954390231076903

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0017694456231, 'e_layers': 1, 'learning_rate': 0.0025768183233, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9901937
	speed: 0.0094s/iter; left time: 72.8156s
	iters: 200, epoch: 1 | loss: 0.6361622
	speed: 0.0036s/iter; left time: 27.4346s
	iters: 300, epoch: 1 | loss: 1.5865277
	speed: 0.0035s/iter; left time: 26.6339s
	iters: 400, epoch: 1 | loss: 0.6276742
	speed: 0.0036s/iter; left time: 26.4122s
	iters: 500, epoch: 1 | loss: 0.3299171
	speed: 0.0035s/iter; left time: 25.8177s
	iters: 600, epoch: 1 | loss: 1.0261939
	speed: 0.0035s/iter; left time: 25.5479s
	iters: 700, epoch: 1 | loss: 0.7600471
	speed: 0.0035s/iter; left time: 24.8409s
	iters: 800, epoch: 1 | loss: 0.7943003
	speed: 0.0035s/iter; left time: 24.8829s
	iters: 900, epoch: 1 | loss: 0.7706314
	speed: 0.0036s/iter; left time: 24.9238s
Updating learning rate to 0.0025768183233
Validation loss decreased (inf --> 0.6247).  Saving model state dict ...
Epoch: 1 cost time: 3.7757186889648438
Epoch: 1, Steps: 979 | Train Loss: 0.8357386 Vali Loss: 0.6247017 Best vali loss: 0.6247017
	iters: 100, epoch: 2 | loss: 0.3669070
	speed: 0.0122s/iter; left time: 82.6548s
	iters: 200, epoch: 2 | loss: 0.6719514
	speed: 0.0035s/iter; left time: 23.4889s
	iters: 300, epoch: 2 | loss: 0.9449362
	speed: 0.0036s/iter; left time: 23.8025s
	iters: 400, epoch: 2 | loss: 0.2898586
	speed: 0.0036s/iter; left time: 23.2506s
	iters: 500, epoch: 2 | loss: 0.5531486
	speed: 0.0037s/iter; left time: 23.2325s
	iters: 600, epoch: 2 | loss: 0.8385593
	speed: 0.0036s/iter; left time: 22.6320s
	iters: 700, epoch: 2 | loss: 1.0269119
	speed: 0.0036s/iter; left time: 22.3054s
	iters: 800, epoch: 2 | loss: 0.9441344
	speed: 0.0036s/iter; left time: 21.6094s
	iters: 900, epoch: 2 | loss: 0.5918270
	speed: 0.0036s/iter; left time: 21.4895s
Updating learning rate to 0.00128840916165
Validation loss decreased (0.6247 --> 0.6151).  Saving model state dict ...
Epoch: 2 cost time: 3.532804489135742
Epoch: 2, Steps: 979 | Train Loss: 0.6920260 Vali Loss: 0.6151039 Best vali loss: 0.6151039
	iters: 100, epoch: 3 | loss: 1.1018913
	speed: 0.0128s/iter; left time: 73.7206s
	iters: 200, epoch: 3 | loss: 0.7132094
	speed: 0.0030s/iter; left time: 16.7486s
	iters: 300, epoch: 3 | loss: 0.8509760
	speed: 0.0032s/iter; left time: 17.7270s
	iters: 400, epoch: 3 | loss: 0.9227173
	speed: 0.0034s/iter; left time: 18.8034s
	iters: 500, epoch: 3 | loss: 0.4301026
	speed: 0.0032s/iter; left time: 17.0145s
	iters: 600, epoch: 3 | loss: 0.8566852
	speed: 0.0031s/iter; left time: 16.0996s
	iters: 700, epoch: 3 | loss: 0.5699254
	speed: 0.0030s/iter; left time: 15.3309s
	iters: 800, epoch: 3 | loss: 0.6283301
	speed: 0.0027s/iter; left time: 13.9486s
	iters: 900, epoch: 3 | loss: 0.8727539
	speed: 0.0028s/iter; left time: 13.6881s
Updating learning rate to 0.000644204580825
Epoch: 3 cost time: 2.99928879737854
Epoch: 3, Steps: 979 | Train Loss: 0.7718435 Vali Loss: 0.6339044 Best vali loss: 0.6151039

best validation loss 0.6151038562048922

[INFO][smbo.py:320] Finished 650 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0035618586948, 'e_layers': 3, 'learning_rate': 0.002751542471, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7573448
	speed: 0.0101s/iter; left time: 38.6964s
	iters: 200, epoch: 1 | loss: 1.0652605
	speed: 0.0044s/iter; left time: 16.4080s
	iters: 300, epoch: 1 | loss: 0.9079086
	speed: 0.0045s/iter; left time: 16.1570s
	iters: 400, epoch: 1 | loss: 1.4692211
	speed: 0.0045s/iter; left time: 15.8412s
Updating learning rate to 0.002646818121396215
Validation loss decreased (inf --> 0.6313).  Saving model state dict ...
Epoch: 1 cost time: 2.4718310832977295
Epoch: 1, Steps: 490 | Train Loss: 1.0499338 Vali Loss: 0.6313172 Best vali loss: 0.6313172
	iters: 100, epoch: 2 | loss: 1.7461982
	speed: 0.0119s/iter; left time: 39.6645s
	iters: 200, epoch: 2 | loss: 1.3321594
	speed: 0.0045s/iter; left time: 14.5553s
	iters: 300, epoch: 2 | loss: 0.7691926
	speed: 0.0044s/iter; left time: 13.7643s
	iters: 400, epoch: 2 | loss: 0.9785693
	speed: 0.0044s/iter; left time: 13.4719s
Updating learning rate to 0.0023485884054834445
Epoch: 2 cost time: 2.2293834686279297
Epoch: 2, Steps: 490 | Train Loss: 1.2065299 Vali Loss: 0.6542627 Best vali loss: 0.6313172
	iters: 100, epoch: 3 | loss: 0.8497073
	speed: 0.0121s/iter; left time: 34.3372s
	iters: 200, epoch: 3 | loss: 0.7345048
	speed: 0.0045s/iter; left time: 12.3942s
	iters: 300, epoch: 3 | loss: 0.7595235
	speed: 0.0046s/iter; left time: 12.0594s
	iters: 400, epoch: 3 | loss: 0.6954381
	speed: 0.0045s/iter; left time: 11.4056s
Updating learning rate to 0.0019022560940503003
Epoch: 3 cost time: 2.2531254291534424
Epoch: 3, Steps: 490 | Train Loss: 0.7597934 Vali Loss: 0.6435157 Best vali loss: 0.6313172

best validation loss 0.6313171617441958

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022985164426, 'e_layers': 2, 'learning_rate': 0.0001464215762, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9434532
	speed: 0.0102s/iter; left time: 5.2520s
Updating learning rate to 7.32107881e-05
Validation loss decreased (0.5954 --> 0.5912).  Saving model state dict ...
Epoch: 4 cost time: 0.8402299880981445
Epoch: 4, Steps: 123 | Train Loss: 0.9434532 Vali Loss: 0.5911615 Best vali loss: 0.5911615
	iters: 100, epoch: 5 | loss: 0.8867244
	speed: 0.0075s/iter; left time: 2.9585s
Updating learning rate to 4.519423242373873e-05
Validation loss decreased (0.5912 --> 0.5801).  Saving model state dict ...
Epoch: 5 cost time: 0.5808806419372559
Epoch: 5, Steps: 123 | Train Loss: 0.8867244 Vali Loss: 0.5801191 Best vali loss: 0.5801191
	iters: 100, epoch: 6 | loss: 0.7674915
	speed: 0.0079s/iter; left time: 2.1348s
Updating learning rate to 2.1442943378478606e-05
Validation loss decreased (0.5801 --> 0.5772).  Saving model state dict ...
Epoch: 6 cost time: 0.5983424186706543
Epoch: 6, Steps: 123 | Train Loss: 0.7674915 Vali Loss: 0.5771923 Best vali loss: 0.5771923
	iters: 100, epoch: 7 | loss: 0.7741234
	speed: 0.0076s/iter; left time: 1.1209s
Updating learning rate to 5.572839415389126e-06
Validation loss decreased (0.5772 --> 0.5708).  Saving model state dict ...
Epoch: 7 cost time: 0.5898468494415283
Epoch: 7, Steps: 123 | Train Loss: 0.7741234 Vali Loss: 0.5708068 Best vali loss: 0.5708068
	iters: 100, epoch: 8 | loss: 0.8238056
	speed: 0.0078s/iter; left time: 0.1864s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5921175479888916
Epoch: 8, Steps: 123 | Train Loss: 0.8238056 Vali Loss: 0.5747295 Best vali loss: 0.5708068

best validation loss 0.5708067539332918

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0044707114332, 'e_layers': 4, 'learning_rate': 0.0001647237984, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7715296
	speed: 0.0120s/iter; left time: 10.6225s
Updating learning rate to 0.0001647237984
Validation loss decreased (inf --> 0.6684).  Saving model state dict ...
Epoch: 1 cost time: 1.0656044483184814
Epoch: 1, Steps: 123 | Train Loss: 0.7715296 Vali Loss: 0.6683672 Best vali loss: 0.6683672
	iters: 100, epoch: 2 | loss: 0.9941792
	speed: 0.0094s/iter; left time: 7.1807s
Updating learning rate to 8.23618992e-05
Validation loss decreased (0.6684 --> 0.6469).  Saving model state dict ...
Epoch: 2 cost time: 0.7651655673980713
Epoch: 2, Steps: 123 | Train Loss: 0.9941792 Vali Loss: 0.6468828 Best vali loss: 0.6468828
	iters: 100, epoch: 3 | loss: 0.8388385
	speed: 0.0092s/iter; left time: 5.8979s
Updating learning rate to 4.11809496e-05
Validation loss decreased (0.6469 --> 0.6390).  Saving model state dict ...
Epoch: 3 cost time: 0.7573738098144531
Epoch: 3, Steps: 123 | Train Loss: 0.8388385 Vali Loss: 0.6390102 Best vali loss: 0.6390102
	iters: 100, epoch: 4 | loss: 0.7958066
	speed: 0.0099s/iter; left time: 5.1075s
Updating learning rate to 2.05904748e-05
Validation loss decreased (0.6390 --> 0.6350).  Saving model state dict ...
Epoch: 4 cost time: 0.832568883895874
Epoch: 4, Steps: 123 | Train Loss: 0.7958066 Vali Loss: 0.6349546 Best vali loss: 0.6349546
	iters: 100, epoch: 5 | loss: 1.0079364
	speed: 0.0101s/iter; left time: 3.9684s
Updating learning rate to 1.02952374e-05
Validation loss decreased (0.6350 --> 0.6327).  Saving model state dict ...
Epoch: 5 cost time: 0.8369846343994141
Epoch: 5, Steps: 123 | Train Loss: 1.0079364 Vali Loss: 0.6327007 Best vali loss: 0.6327007
	iters: 100, epoch: 6 | loss: 1.0052270
	speed: 0.0095s/iter; left time: 2.5589s
Updating learning rate to 5.1476187e-06
Validation loss decreased (0.6327 --> 0.6321).  Saving model state dict ...
Epoch: 6 cost time: 0.7608866691589355
Epoch: 6, Steps: 123 | Train Loss: 1.0052270 Vali Loss: 0.6320739 Best vali loss: 0.6320739
	iters: 100, epoch: 7 | loss: 0.6500683
	speed: 0.0092s/iter; left time: 1.3542s
Updating learning rate to 2.57380935e-06
Validation loss decreased (0.6321 --> 0.6316).  Saving model state dict ...
Epoch: 7 cost time: 0.7486414909362793
Epoch: 7, Steps: 123 | Train Loss: 0.6500683 Vali Loss: 0.6315788 Best vali loss: 0.6315788
	iters: 100, epoch: 8 | loss: 1.0929124
	speed: 0.0097s/iter; left time: 0.2336s
Updating learning rate to 1.286904675e-06
Validation loss decreased (0.6316 --> 0.6314).  Saving model state dict ...
Epoch: 8 cost time: 0.8313441276550293
Epoch: 8, Steps: 123 | Train Loss: 1.0929124 Vali Loss: 0.6313602 Best vali loss: 0.6313602

best validation loss 0.6313601568141286

[INFO][smbo.py:328] Configuration budget is exhausted:
[INFO][smbo.py:329] --- Remaining wallclock time: -8.94020938873291
[INFO][smbo.py:330] --- Remaining cpu time: inf
[INFO][smbo.py:331] --- Remaining trials: 847
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.003098386677, 'e_layers': 1, 'learning_rate': 0.0005, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.6932025
	speed: 0.0080s/iter; left time: 61.6114s
	iters: 200, epoch: 1 | loss: 1.1826427
	speed: 0.0023s/iter; left time: 17.8746s
	iters: 300, epoch: 1 | loss: 0.6562573
	speed: 0.0022s/iter; left time: 16.9406s
	iters: 400, epoch: 1 | loss: 0.6125045
	speed: 0.0022s/iter; left time: 16.5388s
	iters: 500, epoch: 1 | loss: 0.2237864
	speed: 0.0023s/iter; left time: 16.5623s
	iters: 600, epoch: 1 | loss: 0.3614544
	speed: 0.0023s/iter; left time: 16.6055s
	iters: 700, epoch: 1 | loss: 1.0201732
	speed: 0.0022s/iter; left time: 15.8291s
	iters: 800, epoch: 1 | loss: 0.7468050
	speed: 0.0023s/iter; left time: 15.9679s
	iters: 900, epoch: 1 | loss: 0.4166328
	speed: 0.0022s/iter; left time: 15.4574s
Updating learning rate to 0.0004809698831278217
Validation loss decreased (inf --> 0.6046).  Saving model state dict ...
Epoch: 1 cost time: 2.5016655921936035
Epoch: 1, Steps: 979 | Train Loss: 0.7681621 Vali Loss: 0.6046193 Best vali loss: 0.6046193
	iters: 100, epoch: 2 | loss: 0.4754962
	speed: 0.0083s/iter; left time: 55.9121s
	iters: 200, epoch: 2 | loss: 0.5397698
	speed: 0.0022s/iter; left time: 14.7559s
	iters: 300, epoch: 2 | loss: 0.8707422
	speed: 0.0023s/iter; left time: 15.0041s
	iters: 400, epoch: 2 | loss: 0.2844884
	speed: 0.0023s/iter; left time: 14.9679s
	iters: 500, epoch: 2 | loss: 0.4917646
	speed: 0.0023s/iter; left time: 14.4776s
	iters: 600, epoch: 2 | loss: 0.5666843
	speed: 0.0023s/iter; left time: 14.1848s
	iters: 700, epoch: 2 | loss: 0.6423477
	speed: 0.0023s/iter; left time: 14.0324s
	iters: 800, epoch: 2 | loss: 0.4583572
	speed: 0.0023s/iter; left time: 13.6552s
	iters: 900, epoch: 2 | loss: 0.3208607
	speed: 0.0022s/iter; left time: 13.1021s
Updating learning rate to 0.00042677669529663686
Validation loss decreased (0.6046 --> 0.5966).  Saving model state dict ...
Epoch: 2 cost time: 2.252194404602051
Epoch: 2, Steps: 979 | Train Loss: 0.5167235 Vali Loss: 0.5966380 Best vali loss: 0.5966380
	iters: 100, epoch: 3 | loss: 1.1110678
	speed: 0.0083s/iter; left time: 47.6988s
	iters: 200, epoch: 3 | loss: 1.1850760
	speed: 0.0023s/iter; left time: 12.7779s
	iters: 300, epoch: 3 | loss: 0.7500632
	speed: 0.0023s/iter; left time: 12.7171s
	iters: 400, epoch: 3 | loss: 0.2602142
	speed: 0.0023s/iter; left time: 12.4924s
	iters: 500, epoch: 3 | loss: 0.8566214
	speed: 0.0023s/iter; left time: 12.1388s
	iters: 600, epoch: 3 | loss: 0.8807521
	speed: 0.0022s/iter; left time: 11.6104s
	iters: 700, epoch: 3 | loss: 0.4199367
	speed: 0.0022s/iter; left time: 11.2345s
	iters: 800, epoch: 3 | loss: 1.0137552
	speed: 0.0022s/iter; left time: 11.1641s
	iters: 900, epoch: 3 | loss: 1.5133862
	speed: 0.0022s/iter; left time: 11.0871s
Updating learning rate to 0.0003456708580912725
Validation loss decreased (0.5966 --> 0.5942).  Saving model state dict ...
Epoch: 3 cost time: 2.2263994216918945
Epoch: 3, Steps: 979 | Train Loss: 0.8878748 Vali Loss: 0.5942415 Best vali loss: 0.5942415
	iters: 100, epoch: 4 | loss: 0.7928634
	speed: 0.0083s/iter; left time: 39.8940s
	iters: 200, epoch: 4 | loss: 0.2695327
	speed: 0.0023s/iter; left time: 10.7365s
	iters: 300, epoch: 4 | loss: 0.9707843
	speed: 0.0023s/iter; left time: 10.7765s
	iters: 400, epoch: 4 | loss: 0.5814623
	speed: 0.0023s/iter; left time: 10.2191s
	iters: 500, epoch: 4 | loss: 0.2918782
	speed: 0.0022s/iter; left time: 9.6736s
	iters: 600, epoch: 4 | loss: 0.9052215
	speed: 0.0022s/iter; left time: 9.5284s
	iters: 700, epoch: 4 | loss: 0.4730926
	speed: 0.0023s/iter; left time: 9.4585s
	iters: 800, epoch: 4 | loss: 0.4084242
	speed: 0.0022s/iter; left time: 9.0944s
	iters: 900, epoch: 4 | loss: 0.9386229
	speed: 0.0022s/iter; left time: 8.7787s
Updating learning rate to 0.00025
Epoch: 4 cost time: 2.2368335723876953
Epoch: 4, Steps: 979 | Train Loss: 0.6257647 Vali Loss: 0.6070068 Best vali loss: 0.5942415
	iters: 100, epoch: 5 | loss: 1.4928423
	speed: 0.0082s/iter; left time: 31.1699s
	iters: 200, epoch: 5 | loss: 0.6816980
	speed: 0.0023s/iter; left time: 8.5742s
	iters: 300, epoch: 5 | loss: 1.1066626
	speed: 0.0022s/iter; left time: 7.9798s
	iters: 400, epoch: 5 | loss: 1.0221993
	speed: 0.0022s/iter; left time: 7.7776s
	iters: 500, epoch: 5 | loss: 0.5639660
	speed: 0.0022s/iter; left time: 7.4520s
	iters: 600, epoch: 5 | loss: 1.3649781
	speed: 0.0022s/iter; left time: 7.2776s
	iters: 700, epoch: 5 | loss: 0.6201059
	speed: 0.0022s/iter; left time: 7.1950s
	iters: 800, epoch: 5 | loss: 0.6139653
	speed: 0.0022s/iter; left time: 6.9285s
	iters: 900, epoch: 5 | loss: 0.7006000
	speed: 0.0022s/iter; left time: 6.7225s
Updating learning rate to 0.00015432914190872756
Epoch: 5 cost time: 2.217676877975464
Epoch: 5, Steps: 979 | Train Loss: 0.9074464 Vali Loss: 0.6060077 Best vali loss: 0.5942415
	iters: 100, epoch: 6 | loss: 0.2866562
	speed: 0.0083s/iter; left time: 23.5791s
	iters: 200, epoch: 6 | loss: 0.5380631
	speed: 0.0024s/iter; left time: 6.5044s
	iters: 300, epoch: 6 | loss: 0.3134550
	speed: 0.0024s/iter; left time: 6.2798s
	iters: 400, epoch: 6 | loss: 0.2912357
	speed: 0.0024s/iter; left time: 6.1277s
	iters: 500, epoch: 6 | loss: 0.6589854
	speed: 0.0024s/iter; left time: 5.8055s
	iters: 600, epoch: 6 | loss: 0.3364688
	speed: 0.0024s/iter; left time: 5.5518s
	iters: 700, epoch: 6 | loss: 0.3281430
	speed: 0.0024s/iter; left time: 5.2750s
	iters: 800, epoch: 6 | loss: 1.5262594
	speed: 0.0023s/iter; left time: 4.9682s
	iters: 900, epoch: 6 | loss: 0.5836078
	speed: 0.0022s/iter; left time: 4.4938s
Updating learning rate to 7.322330470336314e-05
Epoch: 6 cost time: 2.3243520259857178
Epoch: 6, Steps: 979 | Train Loss: 0.5403194 Vali Loss: 0.6117581 Best vali loss: 0.5942415
	iters: 100, epoch: 7 | loss: 0.9585966
	speed: 0.0083s/iter; left time: 15.4821s
	iters: 200, epoch: 7 | loss: 0.7775886
	speed: 0.0022s/iter; left time: 3.8589s
	iters: 300, epoch: 7 | loss: 0.3088143
	speed: 0.0022s/iter; left time: 3.7251s
	iters: 400, epoch: 7 | loss: 0.5747431
	speed: 0.0022s/iter; left time: 3.4080s
	iters: 500, epoch: 7 | loss: 0.5646695
	speed: 0.0022s/iter; left time: 3.1967s
	iters: 600, epoch: 7 | loss: 1.2244619
	speed: 0.0022s/iter; left time: 3.0512s
	iters: 700, epoch: 7 | loss: 0.6447598
	speed: 0.0022s/iter; left time: 2.8041s
	iters: 800, epoch: 7 | loss: 0.7640409
	speed: 0.0022s/iter; left time: 2.5167s
	iters: 900, epoch: 7 | loss: 1.1650797
	speed: 0.0022s/iter; left time: 2.3066s
Updating learning rate to 1.9030116872178316e-05
Epoch: 7 cost time: 2.199873447418213
Epoch: 7, Steps: 979 | Train Loss: 0.7758616 Vali Loss: 0.6103524 Best vali loss: 0.5942415
	iters: 100, epoch: 8 | loss: 1.3900323
	speed: 0.0081s/iter; left time: 7.1225s
	iters: 200, epoch: 8 | loss: 1.0549514
	speed: 0.0023s/iter; left time: 1.7614s
	iters: 300, epoch: 8 | loss: 0.6484250
	speed: 0.0022s/iter; left time: 1.5072s
	iters: 400, epoch: 8 | loss: 0.2673837
	speed: 0.0023s/iter; left time: 1.3150s
	iters: 500, epoch: 8 | loss: 0.8932598
	speed: 0.0022s/iter; left time: 1.0599s
	iters: 600, epoch: 8 | loss: 0.8052257
	speed: 0.0022s/iter; left time: 0.8337s
	iters: 700, epoch: 8 | loss: 0.9005907
	speed: 0.0022s/iter; left time: 0.6189s
	iters: 800, epoch: 8 | loss: 2.2312887
	speed: 0.0022s/iter; left time: 0.3989s
	iters: 900, epoch: 8 | loss: 1.5645596
	speed: 0.0022s/iter; left time: 0.1749s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.201320171356201
Epoch: 8, Steps: 979 | Train Loss: 1.0839685 Vali Loss: 0.6115294 Best vali loss: 0.5942415

best validation loss 0.5942415152226042

Default cost: 0.5942415152226042
{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048859156977, 'e_layers': 4, 'learning_rate': 7.7601951e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8
start_epoch 8
train_epoch 8

best validation loss 0.5332478830683072

Configuration(values={
  'alpha_d_ff': 1,
  'batch_size': 16,
  'd_core': 64,
  'd_model': 512,
  'dropout': 0.0048859156977,
  'e_layers': 4,
  'learning_rate': 7.7601951e-05,
  'lradj': 'cosine',
})
Incumbent cost: 0.5332478830683072
Traceback (most recent call last):
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 516, in <module>
    metrics_df = pd.read_csv(metrics_path)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file


Time taken (1 parallel trials): 8910 seconds


