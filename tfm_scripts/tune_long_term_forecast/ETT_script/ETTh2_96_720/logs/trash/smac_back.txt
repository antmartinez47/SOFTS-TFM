horizon=720
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023508577801, 'e_layers': 1, 'learning_rate': 0.0004821026935, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6444463
	speed: 0.0101s/iter; left time: 18.8209s
	iters: 200, epoch: 1 | loss: 1.1232940
	speed: 0.0051s/iter; left time: 9.0293s
Updating learning rate to 0.00046375375229660605
Validation loss decreased (inf --> 0.6201).  Saving model state dict ...
Epoch: 1 cost time: 1.4562323093414307
Epoch: 1, Steps: 245 | Train Loss: 0.8838702 Vali Loss: 0.6200978 Best vali loss: 0.6200978
	iters: 100, epoch: 2 | loss: 0.6054546
	speed: 0.0107s/iter; left time: 17.2266s
	iters: 200, epoch: 2 | loss: 0.8407548
	speed: 0.0053s/iter; left time: 7.9763s
Updating learning rate to 0.00041150038865107484
Validation loss decreased (0.6201 --> 0.6097).  Saving model state dict ...
Epoch: 2 cost time: 1.2208926677703857
Epoch: 2, Steps: 245 | Train Loss: 0.7231047 Vali Loss: 0.6097484 Best vali loss: 0.6097484
	iters: 100, epoch: 3 | loss: 0.7110860
	speed: 0.0101s/iter; left time: 13.7918s
	iters: 200, epoch: 3 | loss: 0.9352169
	speed: 0.0043s/iter; left time: 5.4746s
Updating learning rate to 0.0003332977035005174
Validation loss decreased (0.6097 --> 0.6030).  Saving model state dict ...
Epoch: 3 cost time: 1.2174293994903564
Epoch: 3, Steps: 245 | Train Loss: 0.8231514 Vali Loss: 0.6029878 Best vali loss: 0.6029878

best validation loss 0.6029878110865761

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7173828
	speed: 0.0128s/iter; left time: 48.7239s
	iters: 200, epoch: 1 | loss: 1.0096015
	speed: 0.0071s/iter; left time: 26.2755s
	iters: 300, epoch: 1 | loss: 1.1857265
	speed: 0.0067s/iter; left time: 24.0967s
	iters: 400, epoch: 1 | loss: 0.7146049
	speed: 0.0066s/iter; left time: 23.1947s
Updating learning rate to 0.0015120382784
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 3.5173685550689697
Epoch: 1, Steps: 490 | Train Loss: 0.9068289 Vali Loss: 0.6028578 Best vali loss: 0.6028578
	iters: 100, epoch: 2 | loss: 0.5630472
	speed: 0.0164s/iter; left time: 54.6900s
	iters: 200, epoch: 2 | loss: 1.1823506
	speed: 0.0062s/iter; left time: 19.9985s
	iters: 300, epoch: 2 | loss: 1.0664259
	speed: 0.0065s/iter; left time: 20.2276s
	iters: 400, epoch: 2 | loss: 0.5732167
	speed: 0.0063s/iter; left time: 19.0972s
Updating learning rate to 0.0007560191392
Epoch: 2 cost time: 3.1680924892425537
Epoch: 2, Steps: 490 | Train Loss: 0.8462601 Vali Loss: 0.6076957 Best vali loss: 0.6028578
	iters: 100, epoch: 3 | loss: 0.5035796
	speed: 0.0187s/iter; left time: 53.0093s
	iters: 200, epoch: 3 | loss: 0.7063930
	speed: 0.0063s/iter; left time: 17.2439s
	iters: 300, epoch: 3 | loss: 0.6522663
	speed: 0.0053s/iter; left time: 14.1199s
	iters: 400, epoch: 3 | loss: 0.6365426
	speed: 0.0062s/iter; left time: 15.7884s
Updating learning rate to 0.0003780095696
Epoch: 3 cost time: 3.102473497390747
Epoch: 3, Steps: 490 | Train Loss: 0.6246954 Vali Loss: 0.6051217 Best vali loss: 0.6028578

best validation loss 0.602857762274506

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8099596
	speed: 0.0118s/iter; left time: 10.4130s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.6370).  Saving model state dict ...
Epoch: 1 cost time: 1.0597870349884033
Epoch: 1, Steps: 123 | Train Loss: 0.8099596 Vali Loss: 0.6370162 Best vali loss: 0.6370162
	iters: 100, epoch: 2 | loss: 0.7674240
	speed: 0.0089s/iter; left time: 6.7539s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.6370 --> 0.6112).  Saving model state dict ...
Epoch: 2 cost time: 0.5708773136138916
Epoch: 2, Steps: 123 | Train Loss: 0.7674240 Vali Loss: 0.6111633 Best vali loss: 0.6111633
	iters: 100, epoch: 3 | loss: 0.7244929
	speed: 0.0084s/iter; left time: 5.3936s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.6112 --> 0.6070).  Saving model state dict ...
Epoch: 3 cost time: 0.7008416652679443
Epoch: 3, Steps: 123 | Train Loss: 0.7244929 Vali Loss: 0.6070447 Best vali loss: 0.6070447

best validation loss 0.6070446528697775

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6990818
	speed: 0.0124s/iter; left time: 29.2547s
	iters: 200, epoch: 4 | loss: 0.9412104
	speed: 0.0061s/iter; left time: 13.6843s
	iters: 300, epoch: 4 | loss: 0.9955041
	speed: 0.0065s/iter; left time: 13.9272s
	iters: 400, epoch: 4 | loss: 0.7154804
	speed: 0.0062s/iter; left time: 12.6257s
Updating learning rate to 0.0001890047848
Epoch: 4 cost time: 3.3671693801879883
Epoch: 4, Steps: 490 | Train Loss: 0.8378192 Vali Loss: 0.6158962 Best vali loss: 0.6028578
	iters: 100, epoch: 5 | loss: 0.5547534
	speed: 0.0178s/iter; left time: 33.1282s
	iters: 200, epoch: 5 | loss: 1.1516224
	speed: 0.0063s/iter; left time: 11.0308s
	iters: 300, epoch: 5 | loss: 1.0393096
	speed: 0.0063s/iter; left time: 10.4083s
	iters: 400, epoch: 5 | loss: 0.5763509
	speed: 0.0061s/iter; left time: 9.4532s
Updating learning rate to 9.45023924e-05
Epoch: 5 cost time: 3.0923964977264404
Epoch: 5, Steps: 490 | Train Loss: 0.8305091 Vali Loss: 0.6086928 Best vali loss: 0.6028578
	iters: 100, epoch: 6 | loss: 0.3951067
	speed: 0.0161s/iter; left time: 22.1231s
	iters: 200, epoch: 6 | loss: 0.6998267
	speed: 0.0073s/iter; left time: 9.3164s
	iters: 300, epoch: 6 | loss: 0.6081169
	speed: 0.0082s/iter; left time: 9.5476s
	iters: 400, epoch: 6 | loss: 0.6231296
	speed: 0.0080s/iter; left time: 8.5746s
Updating learning rate to 4.72511962e-05
Epoch: 6 cost time: 3.6141839027404785
Epoch: 6, Steps: 490 | Train Loss: 0.5815450 Vali Loss: 0.6098711 Best vali loss: 0.6028578
	iters: 100, epoch: 7 | loss: 1.0918077
	speed: 0.0222s/iter; left time: 19.5691s
	iters: 200, epoch: 7 | loss: 0.7666696
	speed: 0.0079s/iter; left time: 6.1846s
	iters: 300, epoch: 7 | loss: 0.8725835
	speed: 0.0085s/iter; left time: 5.7835s
	iters: 400, epoch: 7 | loss: 0.6215797
	speed: 0.0081s/iter; left time: 4.6981s
Updating learning rate to 2.36255981e-05
Epoch: 7 cost time: 4.063799142837524
Epoch: 7, Steps: 490 | Train Loss: 0.8381601 Vali Loss: 0.6076043 Best vali loss: 0.6028578
	iters: 100, epoch: 8 | loss: 0.6157762
	speed: 0.0231s/iter; left time: 9.0194s
	iters: 200, epoch: 8 | loss: 0.6356126
	speed: 0.0083s/iter; left time: 2.4235s
	iters: 300, epoch: 8 | loss: 0.4142317
	speed: 0.0084s/iter; left time: 1.5996s
	iters: 400, epoch: 8 | loss: 0.5651223
	speed: 0.0085s/iter; left time: 0.7712s
Updating learning rate to 1.181279905e-05
Epoch: 8 cost time: 4.136007070541382
Epoch: 8, Steps: 490 | Train Loss: 0.5576857 Vali Loss: 0.6062898 Best vali loss: 0.6028578

best validation loss 0.602857762274506

[INFO][abstract_intensifier.py:516] Added config 0347d9 as new incumbent because there are no incumbents yet.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012865813859, 'e_layers': 2, 'learning_rate': 0.0003414993649, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0163965
	speed: 0.0135s/iter; left time: 25.0915s
	iters: 200, epoch: 1 | loss: 0.9506347
	speed: 0.0067s/iter; left time: 11.8213s
Updating learning rate to 0.0003414993649
Validation loss decreased (inf --> 0.5828).  Saving model state dict ...
Epoch: 1 cost time: 2.0135512351989746
Epoch: 1, Steps: 245 | Train Loss: 0.9835156 Vali Loss: 0.5828214 Best vali loss: 0.5828214
	iters: 100, epoch: 2 | loss: 0.8091241
	speed: 0.0143s/iter; left time: 23.0823s
	iters: 200, epoch: 2 | loss: 0.6671111
	speed: 0.0067s/iter; left time: 10.1026s
Updating learning rate to 0.00017074968245
Validation loss decreased (0.5828 --> 0.5525).  Saving model state dict ...
Epoch: 2 cost time: 1.7472176551818848
Epoch: 2, Steps: 245 | Train Loss: 0.7381176 Vali Loss: 0.5525374 Best vali loss: 0.5525374
	iters: 100, epoch: 3 | loss: 0.6722549
	speed: 0.0104s/iter; left time: 14.2677s
	iters: 200, epoch: 3 | loss: 0.6232114
	speed: 0.0049s/iter; left time: 6.1881s
Updating learning rate to 8.5374841225e-05
Validation loss decreased (0.5525 --> 0.5442).  Saving model state dict ...
Epoch: 3 cost time: 1.2307188510894775
Epoch: 3, Steps: 245 | Train Loss: 0.6477331 Vali Loss: 0.5441949 Best vali loss: 0.5441949
	iters: 100, epoch: 4 | loss: 0.8908857
	speed: 0.0129s/iter; left time: 14.5263s
	iters: 200, epoch: 4 | loss: 1.1802825
	speed: 0.0055s/iter; left time: 5.6095s
Updating learning rate to 4.26874206125e-05
Epoch: 4 cost time: 1.434781551361084
Epoch: 4, Steps: 245 | Train Loss: 1.0355841 Vali Loss: 0.5449446 Best vali loss: 0.5441949
	iters: 100, epoch: 5 | loss: 0.8373078
	speed: 0.0127s/iter; left time: 11.2116s
	iters: 200, epoch: 5 | loss: 0.4293734
	speed: 0.0056s/iter; left time: 4.3658s
Updating learning rate to 2.134371030625e-05
Validation loss decreased (0.5442 --> 0.5410).  Saving model state dict ...
Epoch: 5 cost time: 1.4457476139068604
Epoch: 5, Steps: 245 | Train Loss: 0.6333406 Vali Loss: 0.5409771 Best vali loss: 0.5409771
	iters: 100, epoch: 6 | loss: 0.4857479
	speed: 0.0122s/iter; left time: 7.7728s
	iters: 200, epoch: 6 | loss: 0.6878946
	speed: 0.0054s/iter; left time: 2.9207s
Updating learning rate to 1.0671855153125e-05
Validation loss decreased (0.5410 --> 0.5393).  Saving model state dict ...
Epoch: 6 cost time: 1.380267858505249
Epoch: 6, Steps: 245 | Train Loss: 0.5868212 Vali Loss: 0.5392824 Best vali loss: 0.5392824
	iters: 100, epoch: 7 | loss: 0.4283256
	speed: 0.0124s/iter; left time: 4.8525s
	iters: 200, epoch: 7 | loss: 0.4513689
	speed: 0.0057s/iter; left time: 1.6589s
Updating learning rate to 5.3359275765625e-06
Validation loss decreased (0.5393 --> 0.5379).  Saving model state dict ...
Epoch: 7 cost time: 1.430004596710205
Epoch: 7, Steps: 245 | Train Loss: 0.4398472 Vali Loss: 0.5378910 Best vali loss: 0.5378910
	iters: 100, epoch: 8 | loss: 0.6264331
	speed: 0.0125s/iter; left time: 1.8265s
	iters: 200, epoch: 8 | loss: 0.6549286
	speed: 0.0056s/iter; left time: 0.2597s
Updating learning rate to 2.66796378828125e-06
Validation loss decreased (0.5379 --> 0.5377).  Saving model state dict ...
Epoch: 8 cost time: 1.4806938171386719
Epoch: 8, Steps: 245 | Train Loss: 0.6406808 Vali Loss: 0.5376553 Best vali loss: 0.5376553

best validation loss 0.537655273903194

[INFO][abstract_intensifier.py:595] Added config c221ed and rejected config 0347d9 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0033747601445, 'e_layers': 1, 'learning_rate': 0.0010195596024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6366393
	speed: 0.0121s/iter; left time: 10.6824s
Updating learning rate to 0.0009807549256163528
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 1.0732522010803223
Epoch: 1, Steps: 123 | Train Loss: 0.6366393 Vali Loss: 0.6090453 Best vali loss: 0.6090453
	iters: 100, epoch: 2 | loss: 0.8215050
	speed: 0.0106s/iter; left time: 8.0414s
Updating learning rate to 0.0008702485555404501
Validation loss decreased (0.6090 --> 0.5932).  Saving model state dict ...
Epoch: 2 cost time: 0.8313453197479248
Epoch: 2, Steps: 123 | Train Loss: 0.8215050 Vali Loss: 0.5932330 Best vali loss: 0.5932330
	iters: 100, epoch: 3 | loss: 0.6245622
	speed: 0.0107s/iter; left time: 6.8626s
Updating learning rate to 0.0007048640852736092
Epoch: 3 cost time: 0.7304067611694336
Epoch: 3, Steps: 123 | Train Loss: 0.6245622 Vali Loss: 0.6609661 Best vali loss: 0.5932330
	iters: 100, epoch: 4 | loss: 0.6342233
	speed: 0.0071s/iter; left time: 3.6875s
Updating learning rate to 0.0005097798012
Epoch: 4 cost time: 0.5303854942321777
Epoch: 4, Steps: 123 | Train Loss: 0.6342233 Vali Loss: 0.6652058 Best vali loss: 0.5932330
	iters: 100, epoch: 5 | loss: 0.7118180
	speed: 0.0098s/iter; left time: 3.8593s
Updating learning rate to 0.00031469551712639095
Epoch: 5 cost time: 0.7655317783355713
Epoch: 5, Steps: 123 | Train Loss: 0.7118180 Vali Loss: 0.6788576 Best vali loss: 0.5932330
	iters: 100, epoch: 6 | loss: 0.5629086
	speed: 0.0097s/iter; left time: 2.6314s
Updating learning rate to 0.00014931104685954994
Epoch: 6 cost time: 0.7856042385101318
Epoch: 6, Steps: 123 | Train Loss: 0.5629086 Vali Loss: 0.6863548 Best vali loss: 0.5932330
	iters: 100, epoch: 7 | loss: 0.4858136
	speed: 0.0104s/iter; left time: 1.5321s
Updating learning rate to 3.880467678364731e-05
Epoch: 7 cost time: 0.8028891086578369
Epoch: 7, Steps: 123 | Train Loss: 0.4858136 Vali Loss: 0.6963415 Best vali loss: 0.5932330
	iters: 100, epoch: 8 | loss: 0.6803039
	speed: 0.0082s/iter; left time: 0.1969s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5327165126800537
Epoch: 8, Steps: 123 | Train Loss: 0.6803039 Vali Loss: 0.6930052 Best vali loss: 0.5932330

best validation loss 0.5932329816434296

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8809983
	speed: 0.0111s/iter; left time: 9.8098s
Updating learning rate to 0.0008036931396
Validation loss decreased (inf --> 0.5937).  Saving model state dict ...
Epoch: 1 cost time: 0.9899570941925049
Epoch: 1, Steps: 123 | Train Loss: 0.8809983 Vali Loss: 0.5936806 Best vali loss: 0.5936806
	iters: 100, epoch: 2 | loss: 0.9040944
	speed: 0.0101s/iter; left time: 7.6974s
Updating learning rate to 0.0004018465698
Epoch: 2 cost time: 0.8075873851776123
Epoch: 2, Steps: 123 | Train Loss: 0.9040944 Vali Loss: 0.6124770 Best vali loss: 0.5936806
	iters: 100, epoch: 3 | loss: 0.9462628
	speed: 0.0081s/iter; left time: 5.1477s
Updating learning rate to 0.0002009232849
Epoch: 3 cost time: 0.5120129585266113
Epoch: 3, Steps: 123 | Train Loss: 0.9462628 Vali Loss: 0.6239460 Best vali loss: 0.5936806

best validation loss 0.5936805723939214

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6248099
	speed: 0.0105s/iter; left time: 19.4835s
	iters: 200, epoch: 1 | loss: 0.7926866
	speed: 0.0048s/iter; left time: 8.4601s
Updating learning rate to 0.0006153270642
Validation loss decreased (inf --> 0.6184).  Saving model state dict ...
Epoch: 1 cost time: 1.4774692058563232
Epoch: 1, Steps: 245 | Train Loss: 0.7087483 Vali Loss: 0.6184299 Best vali loss: 0.6184299
	iters: 100, epoch: 2 | loss: 0.9714750
	speed: 0.0097s/iter; left time: 15.6963s
	iters: 200, epoch: 2 | loss: 0.7618306
	speed: 0.0048s/iter; left time: 7.3363s
Updating learning rate to 0.0003076635321
Validation loss decreased (0.6184 --> 0.5972).  Saving model state dict ...
Epoch: 2 cost time: 1.2366702556610107
Epoch: 2, Steps: 245 | Train Loss: 0.8666528 Vali Loss: 0.5972018 Best vali loss: 0.5972018
	iters: 100, epoch: 3 | loss: 0.7445564
	speed: 0.0103s/iter; left time: 14.1306s
	iters: 200, epoch: 3 | loss: 0.6498231
	speed: 0.0050s/iter; left time: 6.3578s
Updating learning rate to 0.00015383176605
Epoch: 3 cost time: 1.296856164932251
Epoch: 3, Steps: 245 | Train Loss: 0.6971898 Vali Loss: 0.6135011 Best vali loss: 0.5972018

best validation loss 0.5972018050187609

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0030607900961, 'e_layers': 1, 'learning_rate': 0.0002423804971, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0322714
	speed: 0.0092s/iter; left time: 17.0666s
	iters: 200, epoch: 1 | loss: 0.7813309
	speed: 0.0034s/iter; left time: 5.9600s
Updating learning rate to 0.0002423804971
Validation loss decreased (inf --> 0.6409).  Saving model state dict ...
Epoch: 1 cost time: 1.1357090473175049
Epoch: 1, Steps: 245 | Train Loss: 0.9068011 Vali Loss: 0.6408954 Best vali loss: 0.6408954
	iters: 100, epoch: 2 | loss: 0.7796395
	speed: 0.0073s/iter; left time: 11.8508s
	iters: 200, epoch: 2 | loss: 0.7407690
	speed: 0.0034s/iter; left time: 5.1151s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.6409 --> 0.6197).  Saving model state dict ...
Epoch: 2 cost time: 0.8629722595214844
Epoch: 2, Steps: 245 | Train Loss: 0.7602042 Vali Loss: 0.6196993 Best vali loss: 0.6196993
	iters: 100, epoch: 3 | loss: 0.8512021
	speed: 0.0077s/iter; left time: 10.5634s
	iters: 200, epoch: 3 | loss: 1.3424101
	speed: 0.0035s/iter; left time: 4.4134s
Updating learning rate to 6.0595124275e-05
Validation loss decreased (0.6197 --> 0.6133).  Saving model state dict ...
Epoch: 3 cost time: 0.9084906578063965
Epoch: 3, Steps: 245 | Train Loss: 1.0968061 Vali Loss: 0.6132615 Best vali loss: 0.6132615

best validation loss 0.6132615416042234

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7776930
	speed: 0.0099s/iter; left time: 5.0995s
Updating learning rate to 0.00010046164245
Epoch: 4 cost time: 0.804121732711792
Epoch: 4, Steps: 123 | Train Loss: 0.7776930 Vali Loss: 0.6170878 Best vali loss: 0.5936806
	iters: 100, epoch: 5 | loss: 0.8123508
	speed: 0.0070s/iter; left time: 2.7610s
Updating learning rate to 5.0230821225e-05
Epoch: 5 cost time: 0.5416290760040283
Epoch: 5, Steps: 123 | Train Loss: 0.8123508 Vali Loss: 0.6358300 Best vali loss: 0.5936806
	iters: 100, epoch: 6 | loss: 0.8725266
	speed: 0.0070s/iter; left time: 1.8851s
Updating learning rate to 2.51154106125e-05
Epoch: 6 cost time: 0.5418508052825928
Epoch: 6, Steps: 123 | Train Loss: 0.8725266 Vali Loss: 0.6411257 Best vali loss: 0.5936806
	iters: 100, epoch: 7 | loss: 0.7018778
	speed: 0.0071s/iter; left time: 1.0480s
Updating learning rate to 1.255770530625e-05
Epoch: 7 cost time: 0.5491466522216797
Epoch: 7, Steps: 123 | Train Loss: 0.7018778 Vali Loss: 0.6370390 Best vali loss: 0.5936806
	iters: 100, epoch: 8 | loss: 0.9577098
	speed: 0.0072s/iter; left time: 0.1723s
Updating learning rate to 6.278852653125e-06
Epoch: 8 cost time: 0.5826044082641602
Epoch: 8, Steps: 123 | Train Loss: 0.9577098 Vali Loss: 0.6411136 Best vali loss: 0.5936806

best validation loss 0.5936805723939214

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015028868658, 'e_layers': 3, 'learning_rate': 0.000202867082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8961036
	speed: 0.0126s/iter; left time: 23.3999s
	iters: 200, epoch: 1 | loss: 1.0731381
	speed: 0.0067s/iter; left time: 11.8184s
Updating learning rate to 0.000202867082
Validation loss decreased (inf --> 0.5945).  Saving model state dict ...
Epoch: 1 cost time: 1.9864442348480225
Epoch: 1, Steps: 245 | Train Loss: 0.9846208 Vali Loss: 0.5944593 Best vali loss: 0.5944593
	iters: 100, epoch: 2 | loss: 0.7571412
	speed: 0.0135s/iter; left time: 21.8933s
	iters: 200, epoch: 2 | loss: 0.7938346
	speed: 0.0070s/iter; left time: 10.5441s
Updating learning rate to 0.000101433541
Validation loss decreased (0.5945 --> 0.5600).  Saving model state dict ...
Epoch: 2 cost time: 1.7526607513427734
Epoch: 2, Steps: 245 | Train Loss: 0.7754879 Vali Loss: 0.5599994 Best vali loss: 0.5599994
	iters: 100, epoch: 3 | loss: 1.0435754
	speed: 0.0145s/iter; left time: 19.9011s
	iters: 200, epoch: 3 | loss: 0.5463119
	speed: 0.0075s/iter; left time: 9.5786s
Updating learning rate to 5.07167705e-05
Validation loss decreased (0.5600 --> 0.5516).  Saving model state dict ...
Epoch: 3 cost time: 1.8913915157318115
Epoch: 3, Steps: 245 | Train Loss: 0.7949437 Vali Loss: 0.5516432 Best vali loss: 0.5516432
	iters: 100, epoch: 4 | loss: 0.9146120
	speed: 0.0140s/iter; left time: 15.7694s
	iters: 200, epoch: 4 | loss: 0.5444087
	speed: 0.0069s/iter; left time: 7.1021s
Updating learning rate to 2.535838525e-05
Epoch: 4 cost time: 1.7079694271087646
Epoch: 4, Steps: 245 | Train Loss: 0.7295103 Vali Loss: 0.5522544 Best vali loss: 0.5516432
	iters: 100, epoch: 5 | loss: 0.9177831
	speed: 0.0117s/iter; left time: 10.2969s
	iters: 200, epoch: 5 | loss: 0.8456392
	speed: 0.0056s/iter; left time: 4.4014s
Updating learning rate to 1.2679192625e-05
Epoch: 5 cost time: 1.4214279651641846
Epoch: 5, Steps: 245 | Train Loss: 0.8817112 Vali Loss: 0.5602619 Best vali loss: 0.5516432
	iters: 100, epoch: 6 | loss: 0.7295353
	speed: 0.0121s/iter; left time: 7.6917s
	iters: 200, epoch: 6 | loss: 0.4443195
	speed: 0.0079s/iter; left time: 4.2272s
Updating learning rate to 6.3395963125e-06
Validation loss decreased (0.5516 --> 0.5509).  Saving model state dict ...
Epoch: 6 cost time: 1.8700182437896729
Epoch: 6, Steps: 245 | Train Loss: 0.5869274 Vali Loss: 0.5509118 Best vali loss: 0.5509118
	iters: 100, epoch: 7 | loss: 0.7564778
	speed: 0.0155s/iter; left time: 6.0640s
	iters: 200, epoch: 7 | loss: 0.8999364
	speed: 0.0080s/iter; left time: 2.3146s
Updating learning rate to 3.16979815625e-06
Epoch: 7 cost time: 1.9056386947631836
Epoch: 7, Steps: 245 | Train Loss: 0.8282071 Vali Loss: 0.5538710 Best vali loss: 0.5509118
	iters: 100, epoch: 8 | loss: 0.6206694
	speed: 0.0146s/iter; left time: 2.1355s
	iters: 200, epoch: 8 | loss: 0.4577188
	speed: 0.0080s/iter; left time: 0.3690s
Updating learning rate to 1.584899078125e-06
Epoch: 8 cost time: 1.9163484573364258
Epoch: 8, Steps: 245 | Train Loss: 0.5391941 Vali Loss: 0.5544574 Best vali loss: 0.5509118

best validation loss 0.5509118412667433

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0026114276247, 'e_layers': 2, 'learning_rate': 0.0003412042455, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9546034
	speed: 0.0112s/iter; left time: 20.7752s
	iters: 200, epoch: 1 | loss: 1.1145173
	speed: 0.0053s/iter; left time: 9.4199s
Updating learning rate to 0.0003412042455
Validation loss decreased (inf --> 0.6032).  Saving model state dict ...
Epoch: 1 cost time: 1.6506788730621338
Epoch: 1, Steps: 245 | Train Loss: 1.0345604 Vali Loss: 0.6031510 Best vali loss: 0.6031510
	iters: 100, epoch: 2 | loss: 0.8555853
	speed: 0.0118s/iter; left time: 19.0470s
	iters: 200, epoch: 2 | loss: 0.7753830
	speed: 0.0055s/iter; left time: 8.4004s
Updating learning rate to 0.00017060212275
Epoch: 2 cost time: 1.3808681964874268
Epoch: 2, Steps: 245 | Train Loss: 0.8154842 Vali Loss: 0.6242028 Best vali loss: 0.6031510
	iters: 100, epoch: 3 | loss: 0.9125990
	speed: 0.0115s/iter; left time: 15.8080s
	iters: 200, epoch: 3 | loss: 0.6632277
	speed: 0.0055s/iter; left time: 7.0383s
Updating learning rate to 8.5301061375e-05
Epoch: 3 cost time: 1.3773305416107178
Epoch: 3, Steps: 245 | Train Loss: 0.7879134 Vali Loss: 0.6305853 Best vali loss: 0.6031510
	iters: 100, epoch: 4 | loss: 0.6552419
	speed: 0.0116s/iter; left time: 13.0524s
	iters: 200, epoch: 4 | loss: 0.5754877
	speed: 0.0056s/iter; left time: 5.7483s
Updating learning rate to 4.26505306875e-05
Epoch: 4 cost time: 1.4295122623443604
Epoch: 4, Steps: 245 | Train Loss: 0.6153648 Vali Loss: 0.6355464 Best vali loss: 0.6031510
	iters: 100, epoch: 5 | loss: 0.4575329
	speed: 0.0122s/iter; left time: 10.7886s
	iters: 200, epoch: 5 | loss: 0.9694216
	speed: 0.0054s/iter; left time: 4.2231s
Updating learning rate to 2.132526534375e-05
Epoch: 5 cost time: 1.4036519527435303
Epoch: 5, Steps: 245 | Train Loss: 0.7134772 Vali Loss: 0.6272386 Best vali loss: 0.6031510
	iters: 100, epoch: 6 | loss: 0.6236527
	speed: 0.0118s/iter; left time: 7.5024s
	iters: 200, epoch: 6 | loss: 0.6695422
	speed: 0.0055s/iter; left time: 2.9258s
Updating learning rate to 1.0662632671875e-05
Epoch: 6 cost time: 1.4020130634307861
Epoch: 6, Steps: 245 | Train Loss: 0.6465974 Vali Loss: 0.6301279 Best vali loss: 0.6031510
	iters: 100, epoch: 7 | loss: 0.6208729
	speed: 0.0116s/iter; left time: 4.5186s
	iters: 200, epoch: 7 | loss: 0.8661581
	speed: 0.0054s/iter; left time: 1.5826s
Updating learning rate to 5.3313163359375e-06
Epoch: 7 cost time: 1.351548194885254
Epoch: 7, Steps: 245 | Train Loss: 0.7435155 Vali Loss: 0.6321055 Best vali loss: 0.6031510
	iters: 100, epoch: 8 | loss: 0.6293874
	speed: 0.0110s/iter; left time: 1.6116s
	iters: 200, epoch: 8 | loss: 0.7571483
	speed: 0.0058s/iter; left time: 0.2679s
Updating learning rate to 2.66565816796875e-06
Epoch: 8 cost time: 1.4266960620880127
Epoch: 8, Steps: 245 | Train Loss: 0.6932679 Vali Loss: 0.6327102 Best vali loss: 0.6031510

best validation loss 0.6031509713683069

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7686716
	speed: 0.0135s/iter; left time: 11.9397s
Updating learning rate to 0.0002884157887385461
Validation loss decreased (inf --> 0.6046).  Saving model state dict ...
Epoch: 1 cost time: 1.2251865863800049
Epoch: 1, Steps: 123 | Train Loss: 0.7686716 Vali Loss: 0.6046229 Best vali loss: 0.6046229
	iters: 100, epoch: 2 | loss: 0.8970559
	speed: 0.0108s/iter; left time: 8.2426s
Updating learning rate to 0.00025591859596019184
Epoch: 2 cost time: 0.8550379276275635
Epoch: 2, Steps: 123 | Train Loss: 0.8970559 Vali Loss: 0.6333415 Best vali loss: 0.6046229
	iters: 100, epoch: 3 | loss: 0.9366204
	speed: 0.0113s/iter; left time: 7.2031s
Updating learning rate to 0.00020728310997765554
Validation loss decreased (0.6046 --> 0.5497).  Saving model state dict ...
Epoch: 3 cost time: 0.87276291847229
Epoch: 3, Steps: 123 | Train Loss: 0.9366204 Vali Loss: 0.5496985 Best vali loss: 0.5496985

best validation loss 0.5496985413089277

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 1, 'learning_rate': 0.0035418893013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0181175
	speed: 0.0120s/iter; left time: 10.6373s
Updating learning rate to 0.0035418893013
Validation loss decreased (inf --> 0.5939).  Saving model state dict ...
Epoch: 1 cost time: 1.0803334712982178
Epoch: 1, Steps: 123 | Train Loss: 1.0181175 Vali Loss: 0.5939284 Best vali loss: 0.5939284
	iters: 100, epoch: 2 | loss: 0.8088952
	speed: 0.0102s/iter; left time: 7.7739s
Updating learning rate to 0.00177094465065
Validation loss decreased (0.5939 --> 0.5703).  Saving model state dict ...
Epoch: 2 cost time: 0.7564327716827393
Epoch: 2, Steps: 123 | Train Loss: 0.8088952 Vali Loss: 0.5703366 Best vali loss: 0.5703366
	iters: 100, epoch: 3 | loss: 0.7560392
	speed: 0.0111s/iter; left time: 7.1137s
Updating learning rate to 0.000885472325325
Validation loss decreased (0.5703 --> 0.5694).  Saving model state dict ...
Epoch: 3 cost time: 0.8342115879058838
Epoch: 3, Steps: 123 | Train Loss: 0.7560392 Vali Loss: 0.5693668 Best vali loss: 0.5693668

best validation loss 0.5693668105545997

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017113089176, 'e_layers': 4, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2947806
	speed: 0.0124s/iter; left time: 95.9899s
	iters: 200, epoch: 1 | loss: 1.1770928
	speed: 0.0063s/iter; left time: 47.7931s
	iters: 300, epoch: 1 | loss: 0.3244324
	speed: 0.0056s/iter; left time: 42.1132s
	iters: 400, epoch: 1 | loss: 0.8843915
	speed: 0.0059s/iter; left time: 44.0918s
	iters: 500, epoch: 1 | loss: 0.5527529
	speed: 0.0064s/iter; left time: 46.9205s
	iters: 600, epoch: 1 | loss: 0.4767869
	speed: 0.0064s/iter; left time: 46.2523s
	iters: 700, epoch: 1 | loss: 1.3706264
	speed: 0.0064s/iter; left time: 45.4053s
	iters: 800, epoch: 1 | loss: 1.5961217
	speed: 0.0066s/iter; left time: 46.5519s
	iters: 900, epoch: 1 | loss: 1.6847657
	speed: 0.0063s/iter; left time: 43.3375s
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.6359).  Saving model state dict ...
Epoch: 1 cost time: 6.466530799865723
Epoch: 1, Steps: 979 | Train Loss: 1.0401946 Vali Loss: 0.6359200 Best vali loss: 0.6359200
	iters: 100, epoch: 2 | loss: 1.3709850
	speed: 0.0209s/iter; left time: 141.0560s
	iters: 200, epoch: 2 | loss: 0.4571199
	speed: 0.0066s/iter; left time: 44.1364s
	iters: 300, epoch: 2 | loss: 0.8672310
	speed: 0.0067s/iter; left time: 43.7048s
	iters: 400, epoch: 2 | loss: 2.2370923
	speed: 0.0063s/iter; left time: 40.8386s
	iters: 500, epoch: 2 | loss: 0.8996482
	speed: 0.0064s/iter; left time: 40.7507s
	iters: 600, epoch: 2 | loss: 0.8620222
	speed: 0.0060s/iter; left time: 37.7729s
	iters: 700, epoch: 2 | loss: 1.3955272
	speed: 0.0049s/iter; left time: 30.3983s
	iters: 800, epoch: 2 | loss: 0.3793335
	speed: 0.0061s/iter; left time: 36.7797s
	iters: 900, epoch: 2 | loss: 0.7105541
	speed: 0.0069s/iter; left time: 40.8322s
Updating learning rate to 0.002058451742387382
Epoch: 2 cost time: 6.2441582679748535
Epoch: 2, Steps: 979 | Train Loss: 1.0199460 Vali Loss: 0.6590605 Best vali loss: 0.6359200
	iters: 100, epoch: 3 | loss: 0.9161216
	speed: 0.0187s/iter; left time: 108.1554s
	iters: 200, epoch: 3 | loss: 1.0355518
	speed: 0.0071s/iter; left time: 40.4467s
	iters: 300, epoch: 3 | loss: 0.4356979
	speed: 0.0073s/iter; left time: 40.4607s
	iters: 400, epoch: 3 | loss: 0.7474685
	speed: 0.0068s/iter; left time: 37.2336s
	iters: 500, epoch: 3 | loss: 1.1950921
	speed: 0.0050s/iter; left time: 27.0851s
	iters: 600, epoch: 3 | loss: 1.4719807
	speed: 0.0064s/iter; left time: 33.5501s
	iters: 700, epoch: 3 | loss: 0.9620885
	speed: 0.0068s/iter; left time: 35.3006s
	iters: 800, epoch: 3 | loss: 0.4656336
	speed: 0.0067s/iter; left time: 33.9267s
	iters: 900, epoch: 3 | loss: 1.2270960
	speed: 0.0054s/iter; left time: 26.8824s
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 6.188705205917358
Epoch: 3, Steps: 979 | Train Loss: 0.9396367 Vali Loss: 0.6468201 Best vali loss: 0.6359200

best validation loss 0.6359199542019556

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7310941
	speed: 0.0135s/iter; left time: 6.9761s
Updating learning rate to 0.00014991364265
Epoch: 4 cost time: 1.2349705696105957
Epoch: 4, Steps: 123 | Train Loss: 0.7310941 Vali Loss: 0.5547161 Best vali loss: 0.5496985
	iters: 100, epoch: 5 | loss: 0.7725889
	speed: 0.0098s/iter; left time: 3.8572s
Updating learning rate to 9.254417532234449e-05
Validation loss decreased (0.5497 --> 0.5437).  Saving model state dict ...
Epoch: 5 cost time: 0.6692430973052979
Epoch: 5, Steps: 123 | Train Loss: 0.7725889 Vali Loss: 0.5437308 Best vali loss: 0.5437308
	iters: 100, epoch: 6 | loss: 0.8646739
	speed: 0.0090s/iter; left time: 2.4293s
Updating learning rate to 4.3908689339808184e-05
Validation loss decreased (0.5437 --> 0.5389).  Saving model state dict ...
Epoch: 6 cost time: 0.7450051307678223
Epoch: 6, Steps: 123 | Train Loss: 0.8646739 Vali Loss: 0.5388921 Best vali loss: 0.5388921
	iters: 100, epoch: 7 | loss: 0.5771760
	speed: 0.0093s/iter; left time: 1.3726s
Updating learning rate to 1.1411496561453903e-05
Validation loss decreased (0.5389 --> 0.5358).  Saving model state dict ...
Epoch: 7 cost time: 0.7434191703796387
Epoch: 7, Steps: 123 | Train Loss: 0.5771760 Vali Loss: 0.5357898 Best vali loss: 0.5357898
	iters: 100, epoch: 8 | loss: 0.8826732
	speed: 0.0094s/iter; left time: 0.2252s
Updating learning rate to 0.0
Validation loss decreased (0.5358 --> 0.5342).  Saving model state dict ...
Epoch: 8 cost time: 0.7536039352416992
Epoch: 8, Steps: 123 | Train Loss: 0.8826732 Vali Loss: 0.5341616 Best vali loss: 0.5341616

best validation loss 0.5341616446416944

[INFO][abstract_intensifier.py:595] Added config 134b22 and rejected config c221ed as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002592776834, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2142501
	speed: 0.0100s/iter; left time: 38.1522s
	iters: 200, epoch: 1 | loss: 0.3115786
	speed: 0.0042s/iter; left time: 15.6753s
	iters: 300, epoch: 1 | loss: 1.2031579
	speed: 0.0043s/iter; left time: 15.4736s
	iters: 400, epoch: 1 | loss: 0.6073763
	speed: 0.0042s/iter; left time: 14.8777s
Updating learning rate to 0.0002592776834
Validation loss decreased (inf --> 0.6125).  Saving model state dict ...
Epoch: 1 cost time: 2.3406190872192383
Epoch: 1, Steps: 490 | Train Loss: 0.8340907 Vali Loss: 0.6124945 Best vali loss: 0.6124945
	iters: 100, epoch: 2 | loss: 0.5984303
	speed: 0.0116s/iter; left time: 38.5896s
	iters: 200, epoch: 2 | loss: 0.5529126
	speed: 0.0048s/iter; left time: 15.6553s
	iters: 300, epoch: 2 | loss: 1.0785266
	speed: 0.0043s/iter; left time: 13.5678s
	iters: 400, epoch: 2 | loss: 0.8262941
	speed: 0.0042s/iter; left time: 12.7274s
Updating learning rate to 0.0001296388417
Validation loss decreased (0.6125 --> 0.6090).  Saving model state dict ...
Epoch: 2 cost time: 2.2141010761260986
Epoch: 2, Steps: 490 | Train Loss: 0.7640409 Vali Loss: 0.6089666 Best vali loss: 0.6089666
	iters: 100, epoch: 3 | loss: 0.8964478
	speed: 0.0119s/iter; left time: 33.7110s
	iters: 200, epoch: 3 | loss: 0.8808677
	speed: 0.0040s/iter; left time: 10.8564s
	iters: 300, epoch: 3 | loss: 0.5534784
	speed: 0.0040s/iter; left time: 10.6463s
	iters: 400, epoch: 3 | loss: 0.8631971
	speed: 0.0041s/iter; left time: 10.4154s
Updating learning rate to 6.481942085e-05
Epoch: 3 cost time: 2.0212624073028564
Epoch: 3, Steps: 490 | Train Loss: 0.7984978 Vali Loss: 0.6092048 Best vali loss: 0.6089666
	iters: 100, epoch: 4 | loss: 0.7746741
	speed: 0.0115s/iter; left time: 26.9959s
	iters: 200, epoch: 4 | loss: 1.2415355
	speed: 0.0040s/iter; left time: 8.9148s
	iters: 300, epoch: 4 | loss: 0.4056231
	speed: 0.0040s/iter; left time: 8.6795s
	iters: 400, epoch: 4 | loss: 0.7112164
	speed: 0.0042s/iter; left time: 8.5976s
Updating learning rate to 3.2409710425e-05
Validation loss decreased (0.6090 --> 0.5876).  Saving model state dict ...
Epoch: 4 cost time: 2.0418002605438232
Epoch: 4, Steps: 490 | Train Loss: 0.7832623 Vali Loss: 0.5876088 Best vali loss: 0.5876088
	iters: 100, epoch: 5 | loss: 1.2492325
	speed: 0.0120s/iter; left time: 22.3287s
	iters: 200, epoch: 5 | loss: 0.9709702
	speed: 0.0042s/iter; left time: 7.4676s
	iters: 300, epoch: 5 | loss: 0.6586826
	speed: 0.0043s/iter; left time: 7.2186s
	iters: 400, epoch: 5 | loss: 0.9254993
	speed: 0.0043s/iter; left time: 6.7443s
Updating learning rate to 1.62048552125e-05
Validation loss decreased (0.5876 --> 0.5816).  Saving model state dict ...
Epoch: 5 cost time: 2.1438076496124268
Epoch: 5, Steps: 490 | Train Loss: 0.9510961 Vali Loss: 0.5815753 Best vali loss: 0.5815753
	iters: 100, epoch: 6 | loss: 0.7076700
	speed: 0.0119s/iter; left time: 16.2555s
	iters: 200, epoch: 6 | loss: 0.6288943
	speed: 0.0043s/iter; left time: 5.4791s
	iters: 300, epoch: 6 | loss: 1.4694165
	speed: 0.0043s/iter; left time: 5.0907s
	iters: 400, epoch: 6 | loss: 0.8499615
	speed: 0.0044s/iter; left time: 4.7192s
Updating learning rate to 8.10242760625e-06
Validation loss decreased (0.5816 --> 0.5735).  Saving model state dict ...
Epoch: 6 cost time: 2.1713945865631104
Epoch: 6, Steps: 490 | Train Loss: 0.9139856 Vali Loss: 0.5734875 Best vali loss: 0.5734875
	iters: 100, epoch: 7 | loss: 0.5709924
	speed: 0.0123s/iter; left time: 10.8122s
	iters: 200, epoch: 7 | loss: 0.8719327
	speed: 0.0042s/iter; left time: 3.2431s
	iters: 300, epoch: 7 | loss: 0.5846816
	speed: 0.0041s/iter; left time: 2.7697s
	iters: 400, epoch: 7 | loss: 0.6577206
	speed: 0.0042s/iter; left time: 2.4624s
Updating learning rate to 4.051213803125e-06
Epoch: 7 cost time: 2.1124355792999268
Epoch: 7, Steps: 490 | Train Loss: 0.6713318 Vali Loss: 0.5737578 Best vali loss: 0.5734875
	iters: 100, epoch: 8 | loss: 0.5290061
	speed: 0.0121s/iter; left time: 4.7250s
	iters: 200, epoch: 8 | loss: 0.4582358
	speed: 0.0044s/iter; left time: 1.2859s
	iters: 300, epoch: 8 | loss: 0.8182042
	speed: 0.0044s/iter; left time: 0.8319s
	iters: 400, epoch: 8 | loss: 1.0134747
	speed: 0.0043s/iter; left time: 0.3938s
Updating learning rate to 2.0256069015625e-06
Epoch: 8 cost time: 2.1786201000213623
Epoch: 8, Steps: 490 | Train Loss: 0.7047302 Vali Loss: 0.5766560 Best vali loss: 0.5734875

best validation loss 0.5734875323746503

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010733605571, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9965124
	speed: 0.0108s/iter; left time: 9.5818s
Updating learning rate to 6.11157199e-05
Validation loss decreased (inf --> 0.6984).  Saving model state dict ...
Epoch: 1 cost time: 0.9353642463684082
Epoch: 1, Steps: 123 | Train Loss: 0.9965124 Vali Loss: 0.6984230 Best vali loss: 0.6984230
	iters: 100, epoch: 2 | loss: 1.1707535
	speed: 0.0084s/iter; left time: 6.4269s
Updating learning rate to 3.055785995e-05
Validation loss decreased (0.6984 --> 0.6833).  Saving model state dict ...
Epoch: 2 cost time: 0.6818289756774902
Epoch: 2, Steps: 123 | Train Loss: 1.1707535 Vali Loss: 0.6832567 Best vali loss: 0.6832567
	iters: 100, epoch: 3 | loss: 0.6766936
	speed: 0.0087s/iter; left time: 5.5623s
Updating learning rate to 1.5278929975e-05
Validation loss decreased (0.6833 --> 0.6761).  Saving model state dict ...
Epoch: 3 cost time: 0.7138504981994629
Epoch: 3, Steps: 123 | Train Loss: 0.6766936 Vali Loss: 0.6760713 Best vali loss: 0.6760713
	iters: 100, epoch: 4 | loss: 0.8914341
	speed: 0.0083s/iter; left time: 4.2645s
Updating learning rate to 7.6394649875e-06
Validation loss decreased (0.6761 --> 0.6726).  Saving model state dict ...
Epoch: 4 cost time: 0.648876428604126
Epoch: 4, Steps: 123 | Train Loss: 0.8914341 Vali Loss: 0.6725922 Best vali loss: 0.6725922
	iters: 100, epoch: 5 | loss: 0.9939275
	speed: 0.0084s/iter; left time: 3.2820s
Updating learning rate to 3.81973249375e-06
Validation loss decreased (0.6726 --> 0.6709).  Saving model state dict ...
Epoch: 5 cost time: 0.6568875312805176
Epoch: 5, Steps: 123 | Train Loss: 0.9939275 Vali Loss: 0.6709430 Best vali loss: 0.6709430
	iters: 100, epoch: 6 | loss: 0.7317936
	speed: 0.0080s/iter; left time: 2.1688s
Updating learning rate to 1.909866246875e-06
Validation loss decreased (0.6709 --> 0.6701).  Saving model state dict ...
Epoch: 6 cost time: 0.631791353225708
Epoch: 6, Steps: 123 | Train Loss: 0.7317936 Vali Loss: 0.6701038 Best vali loss: 0.6701038
	iters: 100, epoch: 7 | loss: 0.9887159
	speed: 0.0085s/iter; left time: 1.2488s
Updating learning rate to 9.549331234375e-07
Validation loss decreased (0.6701 --> 0.6697).  Saving model state dict ...
Epoch: 7 cost time: 0.6879124641418457
Epoch: 7, Steps: 123 | Train Loss: 0.9887159 Vali Loss: 0.6697030 Best vali loss: 0.6697030
	iters: 100, epoch: 8 | loss: 0.7609451
	speed: 0.0083s/iter; left time: 0.1989s
Updating learning rate to 4.7746656171875e-07
Validation loss decreased (0.6697 --> 0.6695).  Saving model state dict ...
Epoch: 8 cost time: 0.6655898094177246
Epoch: 8, Steps: 123 | Train Loss: 0.7609451 Vali Loss: 0.6694974 Best vali loss: 0.6694974

best validation loss 0.669497383931675

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002189490937942002
Validation loss decreased (inf --> 0.6223).  Saving model state dict ...
Epoch: 1 cost time: 0.6964004039764404
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6222875 Best vali loss: 0.6222875
Updating learning rate to 0.001942790473283107
Validation loss decreased (0.6223 --> 0.6073).  Saving model state dict ...
Epoch: 2 cost time: 0.4293825626373291
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6073416 Best vali loss: 0.6073416
Updating learning rate to 0.0015735771362223516
Epoch: 3 cost time: 0.4285390377044678
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6335184 Best vali loss: 0.6073416

best validation loss 0.6073416191800112

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017721446715, 'e_layers': 4, 'learning_rate': 0.0002378546774, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002378546774
Validation loss decreased (inf --> 0.6763).  Saving model state dict ...
Epoch: 1 cost time: 0.76310133934021
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6762806 Best vali loss: 0.6762806
Updating learning rate to 0.0001189273387
Validation loss decreased (0.6763 --> 0.6480).  Saving model state dict ...
Epoch: 2 cost time: 0.5666003227233887
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6479563 Best vali loss: 0.6479563
Updating learning rate to 5.946366935e-05
Validation loss decreased (0.6480 --> 0.6389).  Saving model state dict ...
Epoch: 3 cost time: 0.5667314529418945
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6388536 Best vali loss: 0.6388536

best validation loss 0.6388536081828214

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 0.6653187274932861
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6165463 Best vali loss: 0.6165463
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.6165 --> 0.6075).  Saving model state dict ...
Epoch: 2 cost time: 0.4285132884979248
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6074761 Best vali loss: 0.6074761
Updating learning rate to 0.00043994959105690174
Validation loss decreased (0.6075 --> 0.6029).  Saving model state dict ...
Epoch: 3 cost time: 0.4142568111419678
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6028725 Best vali loss: 0.6028725

best validation loss 0.6028724792708627

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00031818533495
Epoch: 4 cost time: 0.6326193809509277
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6129969 Best vali loss: 0.6028725
Updating learning rate to 0.00019642107884309824
Epoch: 5 cost time: 0.4621272087097168
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6164862 Best vali loss: 0.6028725
Updating learning rate to 9.319432693274203e-05
Epoch: 6 cost time: 0.463850736618042
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6094908 Best vali loss: 0.6028725
Updating learning rate to 2.4220416444446813e-05
Epoch: 7 cost time: 0.45366716384887695
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6092247 Best vali loss: 0.6028725
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4647352695465088
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6101254 Best vali loss: 0.6028725

best validation loss 0.6028724792708627

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0036399733072, 'e_layers': 3, 'learning_rate': 0.0007179148563, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1084582
	speed: 0.0107s/iter; left time: 82.8818s
	iters: 200, epoch: 1 | loss: 0.8622949
	speed: 0.0051s/iter; left time: 38.6683s
	iters: 300, epoch: 1 | loss: 1.1660788
	speed: 0.0051s/iter; left time: 38.2955s
	iters: 400, epoch: 1 | loss: 0.5435473
	speed: 0.0047s/iter; left time: 35.2257s
	iters: 500, epoch: 1 | loss: 0.9132083
	speed: 0.0047s/iter; left time: 34.4709s
	iters: 600, epoch: 1 | loss: 0.5211312
	speed: 0.0041s/iter; left time: 29.9541s
	iters: 700, epoch: 1 | loss: 0.6632494
	speed: 0.0046s/iter; left time: 33.1037s
	iters: 800, epoch: 1 | loss: 0.3020888
	speed: 0.0053s/iter; left time: 37.2454s
	iters: 900, epoch: 1 | loss: 1.1085732
	speed: 0.0053s/iter; left time: 37.0285s
Updating learning rate to 0.0006905908490606759
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 5.11362624168396
Epoch: 1, Steps: 979 | Train Loss: 0.7987367 Vali Loss: 0.6103000 Best vali loss: 0.6103000
	iters: 100, epoch: 2 | loss: 0.3808030
	speed: 0.0168s/iter; left time: 113.5116s
	iters: 200, epoch: 2 | loss: 0.4729764
	speed: 0.0052s/iter; left time: 34.3549s
	iters: 300, epoch: 2 | loss: 0.5299001
	speed: 0.0052s/iter; left time: 34.0592s
	iters: 400, epoch: 2 | loss: 0.8590503
	speed: 0.0053s/iter; left time: 33.8991s
	iters: 500, epoch: 2 | loss: 2.1809046
	speed: 0.0051s/iter; left time: 32.4867s
	iters: 600, epoch: 2 | loss: 0.8201253
	speed: 0.0051s/iter; left time: 32.0284s
	iters: 700, epoch: 2 | loss: 1.6708297
	speed: 0.0050s/iter; left time: 30.9473s
	iters: 800, epoch: 2 | loss: 1.1801846
	speed: 0.0049s/iter; left time: 29.4687s
	iters: 900, epoch: 2 | loss: 1.0200268
	speed: 0.0048s/iter; left time: 28.3702s
Updating learning rate to 0.0006127786597521479
Epoch: 2 cost time: 5.00814962387085
Epoch: 2, Steps: 979 | Train Loss: 1.0127556 Vali Loss: 0.6103732 Best vali loss: 0.6103000
	iters: 100, epoch: 3 | loss: 1.7798201
	speed: 0.0158s/iter; left time: 91.0923s
	iters: 200, epoch: 3 | loss: 1.0332028
	speed: 0.0050s/iter; left time: 28.2762s
	iters: 300, epoch: 3 | loss: 0.6971891
	speed: 0.0049s/iter; left time: 27.5791s
	iters: 400, epoch: 3 | loss: 0.3332769
	speed: 0.0049s/iter; left time: 26.7043s
	iters: 500, epoch: 3 | loss: 0.4126234
	speed: 0.0054s/iter; left time: 28.9116s
	iters: 600, epoch: 3 | loss: 0.7522967
	speed: 0.0053s/iter; left time: 28.0703s
	iters: 700, epoch: 3 | loss: 0.4381708
	speed: 0.0052s/iter; left time: 26.7359s
	iters: 800, epoch: 3 | loss: 0.7951354
	speed: 0.0052s/iter; left time: 26.4463s
	iters: 900, epoch: 3 | loss: 1.4492455
	speed: 0.0052s/iter; left time: 25.7561s
Updating learning rate to 0.0004963244888273871
Epoch: 3 cost time: 5.04679274559021
Epoch: 3, Steps: 979 | Train Loss: 0.8545512 Vali Loss: 0.6248112 Best vali loss: 0.6103000
	iters: 100, epoch: 4 | loss: 0.2802279
	speed: 0.0158s/iter; left time: 75.8089s
	iters: 200, epoch: 4 | loss: 1.1457797
	speed: 0.0048s/iter; left time: 22.6120s
	iters: 300, epoch: 4 | loss: 0.6028035
	speed: 0.0047s/iter; left time: 21.7109s
	iters: 400, epoch: 4 | loss: 0.3426853
	speed: 0.0048s/iter; left time: 21.6833s
	iters: 500, epoch: 4 | loss: 0.2689874
	speed: 0.0047s/iter; left time: 20.5720s
	iters: 600, epoch: 4 | loss: 1.1363177
	speed: 0.0048s/iter; left time: 20.5551s
	iters: 700, epoch: 4 | loss: 0.6846808
	speed: 0.0047s/iter; left time: 19.7525s
	iters: 800, epoch: 4 | loss: 0.2751426
	speed: 0.0044s/iter; left time: 18.1152s
	iters: 900, epoch: 4 | loss: 1.2427502
	speed: 0.0048s/iter; left time: 19.3471s
Updating learning rate to 0.00035895742815
Epoch: 4 cost time: 4.677079677581787
Epoch: 4, Steps: 979 | Train Loss: 0.6643750 Vali Loss: 0.6140666 Best vali loss: 0.6103000
	iters: 100, epoch: 5 | loss: 0.2632010
	speed: 0.0157s/iter; left time: 59.8887s
	iters: 200, epoch: 5 | loss: 0.2782793
	speed: 0.0050s/iter; left time: 18.5897s
	iters: 300, epoch: 5 | loss: 1.1295005
	speed: 0.0049s/iter; left time: 17.9008s
	iters: 400, epoch: 5 | loss: 0.4500711
	speed: 0.0049s/iter; left time: 17.1066s
	iters: 500, epoch: 5 | loss: 0.9818063
	speed: 0.0049s/iter; left time: 16.8576s
	iters: 600, epoch: 5 | loss: 1.0030384
	speed: 0.0050s/iter; left time: 16.6704s
	iters: 700, epoch: 5 | loss: 0.3820696
	speed: 0.0051s/iter; left time: 16.3041s
	iters: 800, epoch: 5 | loss: 0.7979268
	speed: 0.0051s/iter; left time: 15.8241s
	iters: 900, epoch: 5 | loss: 0.2220434
	speed: 0.0051s/iter; left time: 15.3755s
Updating learning rate to 0.00022159036747261294
Epoch: 5 cost time: 4.949148178100586
Epoch: 5, Steps: 979 | Train Loss: 0.6119929 Vali Loss: 0.6465823 Best vali loss: 0.6103000
	iters: 100, epoch: 6 | loss: 0.6878363
	speed: 0.0156s/iter; left time: 44.2103s
	iters: 200, epoch: 6 | loss: 0.4392599
	speed: 0.0049s/iter; left time: 13.4199s
	iters: 300, epoch: 6 | loss: 0.4735303
	speed: 0.0049s/iter; left time: 12.8465s
	iters: 400, epoch: 6 | loss: 0.8113493
	speed: 0.0050s/iter; left time: 12.6525s
	iters: 500, epoch: 6 | loss: 0.6834946
	speed: 0.0049s/iter; left time: 11.8919s
	iters: 600, epoch: 6 | loss: 1.6891396
	speed: 0.0047s/iter; left time: 10.9741s
	iters: 700, epoch: 6 | loss: 0.2937052
	speed: 0.0049s/iter; left time: 10.9315s
	iters: 800, epoch: 6 | loss: 0.6895011
	speed: 0.0041s/iter; left time: 8.7561s
	iters: 900, epoch: 6 | loss: 1.0535240
	speed: 0.0042s/iter; left time: 8.6614s
Updating learning rate to 0.00010513619654785212
Epoch: 6 cost time: 4.705637693405151
Epoch: 6, Steps: 979 | Train Loss: 0.7579267 Vali Loss: 0.6325734 Best vali loss: 0.6103000
	iters: 100, epoch: 7 | loss: 0.3419564
	speed: 0.0199s/iter; left time: 37.0195s
	iters: 200, epoch: 7 | loss: 1.0131437
	speed: 0.0054s/iter; left time: 9.4175s
	iters: 300, epoch: 7 | loss: 0.9130945
	speed: 0.0059s/iter; left time: 9.8164s
	iters: 400, epoch: 7 | loss: 0.6731836
	speed: 0.0058s/iter; left time: 9.0098s
	iters: 500, epoch: 7 | loss: 0.4049096
	speed: 0.0058s/iter; left time: 8.4107s
	iters: 600, epoch: 7 | loss: 0.5171583
	speed: 0.0057s/iter; left time: 7.6847s
	iters: 700, epoch: 7 | loss: 0.4648431
	speed: 0.0059s/iter; left time: 7.4079s
	iters: 800, epoch: 7 | loss: 0.4677816
	speed: 0.0056s/iter; left time: 6.5143s
	iters: 900, epoch: 7 | loss: 0.4476224
	speed: 0.0055s/iter; left time: 5.8640s
Updating learning rate to 2.7324007239324203e-05
Epoch: 7 cost time: 5.6176438331604
Epoch: 7, Steps: 979 | Train Loss: 0.5826326 Vali Loss: 0.6318662 Best vali loss: 0.6103000
	iters: 100, epoch: 8 | loss: 0.7547541
	speed: 0.0143s/iter; left time: 12.5735s
	iters: 200, epoch: 8 | loss: 0.5259562
	speed: 0.0059s/iter; left time: 4.6284s
	iters: 300, epoch: 8 | loss: 1.0006273
	speed: 0.0060s/iter; left time: 4.0655s
	iters: 400, epoch: 8 | loss: 1.1699715
	speed: 0.0059s/iter; left time: 3.4442s
	iters: 500, epoch: 8 | loss: 0.6481782
	speed: 0.0059s/iter; left time: 2.8427s
	iters: 600, epoch: 8 | loss: 0.9182881
	speed: 0.0058s/iter; left time: 2.2138s
	iters: 700, epoch: 8 | loss: 1.1511722
	speed: 0.0056s/iter; left time: 1.5581s
	iters: 800, epoch: 8 | loss: 0.4886137
	speed: 0.0061s/iter; left time: 1.0902s
	iters: 900, epoch: 8 | loss: 0.8319462
	speed: 0.0061s/iter; left time: 0.4856s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.703725576400757
Epoch: 8, Steps: 979 | Train Loss: 0.8321675 Vali Loss: 0.6356963 Best vali loss: 0.6103000

best validation loss 0.6103000158322514

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050164002415, 'e_layers': 1, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6436985
	speed: 0.0093s/iter; left time: 72.2170s
	iters: 200, epoch: 1 | loss: 1.9221265
	speed: 0.0034s/iter; left time: 25.8610s
	iters: 300, epoch: 1 | loss: 1.3425049
	speed: 0.0036s/iter; left time: 26.7966s
	iters: 400, epoch: 1 | loss: 0.2516271
	speed: 0.0033s/iter; left time: 24.6502s
	iters: 500, epoch: 1 | loss: 0.2561888
	speed: 0.0036s/iter; left time: 26.3965s
	iters: 600, epoch: 1 | loss: 0.5322934
	speed: 0.0037s/iter; left time: 27.0190s
	iters: 700, epoch: 1 | loss: 0.4750108
	speed: 0.0035s/iter; left time: 24.7570s
	iters: 800, epoch: 1 | loss: 0.5271846
	speed: 0.0034s/iter; left time: 24.1865s
	iters: 900, epoch: 1 | loss: 0.5795394
	speed: 0.0033s/iter; left time: 22.8317s
Updating learning rate to 0.0005311094169208142
Validation loss decreased (inf --> 0.6182).  Saving model state dict ...
Epoch: 1 cost time: 3.6915934085845947
Epoch: 1, Steps: 979 | Train Loss: 0.7255749 Vali Loss: 0.6182395 Best vali loss: 0.6182395
	iters: 100, epoch: 2 | loss: 0.6307780
	speed: 0.0134s/iter; left time: 90.3119s
	iters: 200, epoch: 2 | loss: 1.1937897
	speed: 0.0028s/iter; left time: 18.5929s
	iters: 300, epoch: 2 | loss: 1.1436729
	speed: 0.0024s/iter; left time: 15.7804s
	iters: 400, epoch: 2 | loss: 1.5956316
	speed: 0.0026s/iter; left time: 16.9552s
	iters: 500, epoch: 2 | loss: 0.7273771
	speed: 0.0025s/iter; left time: 15.6414s
	iters: 600, epoch: 2 | loss: 1.1725109
	speed: 0.0048s/iter; left time: 29.8148s
	iters: 700, epoch: 2 | loss: 0.4870457
	speed: 0.0050s/iter; left time: 30.6389s
	iters: 800, epoch: 2 | loss: 0.9118534
	speed: 0.0041s/iter; left time: 24.5647s
	iters: 900, epoch: 2 | loss: 1.2767653
	speed: 0.0044s/iter; left time: 25.9989s
Updating learning rate to 0.0004712667668926594
Validation loss decreased (0.6182 --> 0.6095).  Saving model state dict ...
Epoch: 2 cost time: 3.6663453578948975
Epoch: 2, Steps: 979 | Train Loss: 1.0154916 Vali Loss: 0.6094883 Best vali loss: 0.6094883
	iters: 100, epoch: 3 | loss: 0.9158788
	speed: 0.0189s/iter; left time: 109.3869s
	iters: 200, epoch: 3 | loss: 0.3385869
	speed: 0.0040s/iter; left time: 22.8594s
	iters: 300, epoch: 3 | loss: 0.6318110
	speed: 0.0028s/iter; left time: 15.4711s
	iters: 400, epoch: 3 | loss: 1.3767120
	speed: 0.0023s/iter; left time: 12.7140s
	iters: 500, epoch: 3 | loss: 1.1763732
	speed: 0.0022s/iter; left time: 11.8479s
	iters: 600, epoch: 3 | loss: 0.7081573
	speed: 0.0025s/iter; left time: 13.1343s
	iters: 700, epoch: 3 | loss: 0.2912636
	speed: 0.0032s/iter; left time: 16.3099s
	iters: 800, epoch: 3 | loss: 1.2997706
	speed: 0.0051s/iter; left time: 25.8179s
	iters: 900, epoch: 3 | loss: 0.6232018
	speed: 0.0048s/iter; left time: 23.7092s
Updating learning rate to 0.00038170591200734896
Epoch: 3 cost time: 3.577054262161255
Epoch: 3, Steps: 979 | Train Loss: 0.8179728 Vali Loss: 0.6304665 Best vali loss: 0.6094883
	iters: 100, epoch: 4 | loss: 0.3605511
	speed: 0.0182s/iter; left time: 87.1450s
	iters: 200, epoch: 4 | loss: 0.3815477
	speed: 0.0053s/iter; left time: 24.7582s
	iters: 300, epoch: 4 | loss: 1.0473745
	speed: 0.0051s/iter; left time: 23.2474s
	iters: 400, epoch: 4 | loss: 1.4896612
	speed: 0.0047s/iter; left time: 21.2491s
	iters: 500, epoch: 4 | loss: 0.4154412
	speed: 0.0050s/iter; left time: 21.9847s
	iters: 600, epoch: 4 | loss: 0.8108490
	speed: 0.0044s/iter; left time: 18.8976s
	iters: 700, epoch: 4 | loss: 0.9971303
	speed: 0.0045s/iter; left time: 18.8324s
	iters: 800, epoch: 4 | loss: 0.4711881
	speed: 0.0056s/iter; left time: 23.0061s
	iters: 900, epoch: 4 | loss: 0.6564723
	speed: 0.0050s/iter; left time: 19.8406s
Updating learning rate to 0.00027606168055
Epoch: 4 cost time: 4.588497638702393
Epoch: 4, Steps: 979 | Train Loss: 0.7366906 Vali Loss: 0.6729118 Best vali loss: 0.6094883
	iters: 100, epoch: 5 | loss: 1.0170971
	speed: 0.0096s/iter; left time: 36.5748s
	iters: 200, epoch: 5 | loss: 0.3395461
	speed: 0.0037s/iter; left time: 13.7873s
	iters: 300, epoch: 5 | loss: 0.4868139
	speed: 0.0032s/iter; left time: 11.6623s
	iters: 400, epoch: 5 | loss: 0.9427074
	speed: 0.0036s/iter; left time: 12.6475s
	iters: 500, epoch: 5 | loss: 0.7888041
	speed: 0.0037s/iter; left time: 12.4851s
	iters: 600, epoch: 5 | loss: 0.5029517
	speed: 0.0034s/iter; left time: 11.3307s
	iters: 700, epoch: 5 | loss: 0.8908352
	speed: 0.0035s/iter; left time: 11.2299s
	iters: 800, epoch: 5 | loss: 0.4640659
	speed: 0.0034s/iter; left time: 10.5884s
	iters: 900, epoch: 5 | loss: 0.6302120
	speed: 0.0032s/iter; left time: 9.5119s
Updating learning rate to 0.00017041744909265108
Epoch: 5 cost time: 3.354161500930786
Epoch: 5, Steps: 979 | Train Loss: 0.6736704 Vali Loss: 0.6693220 Best vali loss: 0.6094883
	iters: 100, epoch: 6 | loss: 0.2525549
	speed: 0.0143s/iter; left time: 40.5153s
	iters: 200, epoch: 6 | loss: 0.3800356
	speed: 0.0036s/iter; left time: 9.7920s
	iters: 300, epoch: 6 | loss: 0.9650003
	speed: 0.0035s/iter; left time: 9.3570s
	iters: 400, epoch: 6 | loss: 0.5228025
	speed: 0.0035s/iter; left time: 8.9048s
	iters: 500, epoch: 6 | loss: 1.4078010
	speed: 0.0033s/iter; left time: 8.0861s
	iters: 600, epoch: 6 | loss: 0.6222257
	speed: 0.0033s/iter; left time: 7.6272s
	iters: 700, epoch: 6 | loss: 1.5395285
	speed: 0.0033s/iter; left time: 7.3607s
	iters: 800, epoch: 6 | loss: 0.9433671
	speed: 0.0032s/iter; left time: 6.9421s
	iters: 900, epoch: 6 | loss: 0.4053880
	speed: 0.0037s/iter; left time: 7.4918s
Updating learning rate to 8.085659420734059e-05
Epoch: 6 cost time: 3.42021107673645
Epoch: 6, Steps: 979 | Train Loss: 0.7820782 Vali Loss: 0.6723934 Best vali loss: 0.6094883
	iters: 100, epoch: 7 | loss: 0.9007948
	speed: 0.0101s/iter; left time: 18.8303s
	iters: 200, epoch: 7 | loss: 0.3790748
	speed: 0.0024s/iter; left time: 4.2765s
	iters: 300, epoch: 7 | loss: 0.3661297
	speed: 0.0036s/iter; left time: 5.9787s
	iters: 400, epoch: 7 | loss: 0.5361819
	speed: 0.0038s/iter; left time: 5.8633s
	iters: 500, epoch: 7 | loss: 0.4226087
	speed: 0.0037s/iter; left time: 5.4350s
	iters: 600, epoch: 7 | loss: 0.2509350
	speed: 0.0034s/iter; left time: 4.6704s
	iters: 700, epoch: 7 | loss: 0.3514245
	speed: 0.0040s/iter; left time: 4.9879s
	iters: 800, epoch: 7 | loss: 1.2442417
	speed: 0.0038s/iter; left time: 4.3604s
	iters: 900, epoch: 7 | loss: 0.4846742
	speed: 0.0038s/iter; left time: 4.0051s
Updating learning rate to 2.101394417918582e-05
Epoch: 7 cost time: 3.3946290016174316
Epoch: 7, Steps: 979 | Train Loss: 0.5484517 Vali Loss: 0.6715852 Best vali loss: 0.6094883
	iters: 100, epoch: 8 | loss: 0.8750940
	speed: 0.0148s/iter; left time: 13.0327s
	iters: 200, epoch: 8 | loss: 0.6744947
	speed: 0.0033s/iter; left time: 2.5927s
	iters: 300, epoch: 8 | loss: 0.6104396
	speed: 0.0036s/iter; left time: 2.4417s
	iters: 400, epoch: 8 | loss: 1.3869405
	speed: 0.0038s/iter; left time: 2.2231s
	iters: 500, epoch: 8 | loss: 0.2914342
	speed: 0.0036s/iter; left time: 1.7328s
	iters: 600, epoch: 8 | loss: 0.6752281
	speed: 0.0034s/iter; left time: 1.2984s
	iters: 700, epoch: 8 | loss: 0.4959309
	speed: 0.0035s/iter; left time: 0.9896s
	iters: 800, epoch: 8 | loss: 0.7238008
	speed: 0.0037s/iter; left time: 0.6639s
	iters: 900, epoch: 8 | loss: 0.8959789
	speed: 0.0035s/iter; left time: 0.2775s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5403597354888916
Epoch: 8, Steps: 979 | Train Loss: 0.7365935 Vali Loss: 0.6668477 Best vali loss: 0.6094883

best validation loss 0.6094882956316823

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5661674
	speed: 0.0094s/iter; left time: 35.9366s
	iters: 200, epoch: 1 | loss: 0.9160898
	speed: 0.0038s/iter; left time: 14.0601s
	iters: 300, epoch: 1 | loss: 0.8161221
	speed: 0.0044s/iter; left time: 15.7783s
	iters: 400, epoch: 1 | loss: 0.8699642
	speed: 0.0045s/iter; left time: 15.9151s
Updating learning rate to 0.0001961966354
Validation loss decreased (inf --> 0.6012).  Saving model state dict ...
Epoch: 1 cost time: 2.289673328399658
Epoch: 1, Steps: 490 | Train Loss: 0.7920859 Vali Loss: 0.6012187 Best vali loss: 0.6012187
	iters: 100, epoch: 2 | loss: 1.3893448
	speed: 0.0093s/iter; left time: 30.8731s
	iters: 200, epoch: 2 | loss: 1.1185732
	speed: 0.0029s/iter; left time: 9.2854s
	iters: 300, epoch: 2 | loss: 1.0962567
	speed: 0.0040s/iter; left time: 12.5536s
	iters: 400, epoch: 2 | loss: 0.7169121
	speed: 0.0040s/iter; left time: 12.0211s
Updating learning rate to 9.80983177e-05
Epoch: 2 cost time: 1.7519965171813965
Epoch: 2, Steps: 490 | Train Loss: 1.0802717 Vali Loss: 0.6035631 Best vali loss: 0.6012187
	iters: 100, epoch: 3 | loss: 0.6872534
	speed: 0.0126s/iter; left time: 35.9002s
	iters: 200, epoch: 3 | loss: 1.3273182
	speed: 0.0042s/iter; left time: 11.4854s
	iters: 300, epoch: 3 | loss: 1.2011806
	speed: 0.0036s/iter; left time: 9.5159s
	iters: 400, epoch: 3 | loss: 0.8854946
	speed: 0.0025s/iter; left time: 6.3995s
Updating learning rate to 4.904915885e-05
Epoch: 3 cost time: 1.705672264099121
Epoch: 3, Steps: 490 | Train Loss: 1.0253117 Vali Loss: 0.6105217 Best vali loss: 0.6012187

best validation loss 0.601218735382878

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0074951894677, 'e_layers': 4, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5229288
	speed: 0.0123s/iter; left time: 47.1361s
	iters: 200, epoch: 1 | loss: 0.9278910
	speed: 0.0064s/iter; left time: 23.8531s
	iters: 300, epoch: 1 | loss: 0.5516809
	speed: 0.0065s/iter; left time: 23.3558s
	iters: 400, epoch: 1 | loss: 0.9946108
	speed: 0.0066s/iter; left time: 23.2790s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.6520).  Saving model state dict ...
Epoch: 1 cost time: 3.4951844215393066
Epoch: 1, Steps: 490 | Train Loss: 0.7492779 Vali Loss: 0.6519820 Best vali loss: 0.6519820
	iters: 100, epoch: 2 | loss: 1.2631234
	speed: 0.0189s/iter; left time: 62.8088s
	iters: 200, epoch: 2 | loss: 1.6626787
	speed: 0.0056s/iter; left time: 18.0838s
	iters: 300, epoch: 2 | loss: 1.0861641
	speed: 0.0080s/iter; left time: 25.0351s
	iters: 400, epoch: 2 | loss: 0.8746135
	speed: 0.0076s/iter; left time: 23.0233s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.6520 --> 0.6453).  Saving model state dict ...
Epoch: 2 cost time: 3.480212926864624
Epoch: 2, Steps: 490 | Train Loss: 1.2216449 Vali Loss: 0.6452801 Best vali loss: 0.6452801
	iters: 100, epoch: 3 | loss: 0.7499217
	speed: 0.0206s/iter; left time: 58.4218s
	iters: 200, epoch: 3 | loss: 0.6090870
	speed: 0.0071s/iter; left time: 19.5685s
	iters: 300, epoch: 3 | loss: 0.8418236
	speed: 0.0073s/iter; left time: 19.2145s
	iters: 400, epoch: 3 | loss: 0.5260583
	speed: 0.0070s/iter; left time: 17.8655s
Updating learning rate to 0.0008955266062
Validation loss decreased (0.6453 --> 0.6412).  Saving model state dict ...
Epoch: 3 cost time: 3.6317875385284424
Epoch: 3, Steps: 490 | Train Loss: 0.6817227 Vali Loss: 0.6412145 Best vali loss: 0.6412145

best validation loss 0.6412145159190477

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1635789
	speed: 0.0143s/iter; left time: 12.6183s
Updating learning rate to 0.0006870327933
Validation loss decreased (inf --> 0.5920).  Saving model state dict ...
Epoch: 1 cost time: 1.3779151439666748
Epoch: 1, Steps: 123 | Train Loss: 1.1635789 Vali Loss: 0.5920095 Best vali loss: 0.5920095
	iters: 100, epoch: 2 | loss: 0.6821885
	speed: 0.0143s/iter; left time: 10.9022s
Updating learning rate to 0.00034351639665
Validation loss decreased (0.5920 --> 0.5694).  Saving model state dict ...
Epoch: 2 cost time: 1.1377577781677246
Epoch: 2, Steps: 123 | Train Loss: 0.6821885 Vali Loss: 0.5694175 Best vali loss: 0.5694175
	iters: 100, epoch: 3 | loss: 0.6645490
	speed: 0.0138s/iter; left time: 8.8488s
Updating learning rate to 0.000171758198325
Validation loss decreased (0.5694 --> 0.5625).  Saving model state dict ...
Epoch: 3 cost time: 1.1047000885009766
Epoch: 3, Steps: 123 | Train Loss: 0.6645490 Vali Loss: 0.5625092 Best vali loss: 0.5625092

best validation loss 0.5625091572979544

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0466343
	speed: 0.0151s/iter; left time: 7.7734s
Updating learning rate to 8.58790991625e-05
Validation loss decreased (0.5625 --> 0.5537).  Saving model state dict ...
Epoch: 4 cost time: 1.4053773880004883
Epoch: 4, Steps: 123 | Train Loss: 1.0466343 Vali Loss: 0.5537435 Best vali loss: 0.5537435
	iters: 100, epoch: 5 | loss: 0.6060642
	speed: 0.0144s/iter; left time: 5.6572s
Updating learning rate to 4.293954958125e-05
Validation loss decreased (0.5537 --> 0.5472).  Saving model state dict ...
Epoch: 5 cost time: 1.1354868412017822
Epoch: 5, Steps: 123 | Train Loss: 0.6060642 Vali Loss: 0.5472048 Best vali loss: 0.5472048
	iters: 100, epoch: 6 | loss: 0.5957392
	speed: 0.0137s/iter; left time: 3.6887s
Updating learning rate to 2.1469774790625e-05
Validation loss decreased (0.5472 --> 0.5444).  Saving model state dict ...
Epoch: 6 cost time: 1.124436855316162
Epoch: 6, Steps: 123 | Train Loss: 0.5957392 Vali Loss: 0.5443735 Best vali loss: 0.5443735
	iters: 100, epoch: 7 | loss: 0.7039579
	speed: 0.0144s/iter; left time: 2.1156s
Updating learning rate to 1.07348873953125e-05
Epoch: 7 cost time: 1.09462571144104
Epoch: 7, Steps: 123 | Train Loss: 0.7039579 Vali Loss: 0.5467833 Best vali loss: 0.5443735
	iters: 100, epoch: 8 | loss: 0.7371955
	speed: 0.0114s/iter; left time: 0.2726s
Updating learning rate to 5.36744369765625e-06
Epoch: 8 cost time: 0.999788761138916
Epoch: 8, Steps: 123 | Train Loss: 0.7371955 Vali Loss: 0.5500362 Best vali loss: 0.5443735

best validation loss 0.5443735164329444

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008116820516, 'e_layers': 1, 'learning_rate': 0.0004109547451, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6602128
	speed: 0.0118s/iter; left time: 10.4271s
Updating learning rate to 0.0003953137114431415
Validation loss decreased (inf --> 0.6191).  Saving model state dict ...
Epoch: 1 cost time: 1.0083811283111572
Epoch: 1, Steps: 123 | Train Loss: 0.6602128 Vali Loss: 0.6191283 Best vali loss: 0.6191283
	iters: 100, epoch: 2 | loss: 0.6847516
	speed: 0.0097s/iter; left time: 7.3928s
Updating learning rate to 0.00035077181606049955
Validation loss decreased (0.6191 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 0.7553143501281738
Epoch: 2, Steps: 123 | Train Loss: 0.6847516 Vali Loss: 0.6064947 Best vali loss: 0.6064947
	iters: 100, epoch: 3 | loss: 0.7370405
	speed: 0.0096s/iter; left time: 6.1238s
Updating learning rate to 0.00028411015875079426
Validation loss decreased (0.6065 --> 0.6027).  Saving model state dict ...
Epoch: 3 cost time: 0.7214324474334717
Epoch: 3, Steps: 123 | Train Loss: 0.7370405 Vali Loss: 0.6026623 Best vali loss: 0.6026623
	iters: 100, epoch: 4 | loss: 0.8645968
	speed: 0.0096s/iter; left time: 4.9714s
Updating learning rate to 0.00020547737255
Validation loss decreased (0.6027 --> 0.5983).  Saving model state dict ...
Epoch: 4 cost time: 0.7420821189880371
Epoch: 4, Steps: 123 | Train Loss: 0.8645968 Vali Loss: 0.5982770 Best vali loss: 0.5982770
	iters: 100, epoch: 5 | loss: 0.8747213
	speed: 0.0096s/iter; left time: 3.7809s
Updating learning rate to 0.00012684458634920571
Epoch: 5 cost time: 0.7358474731445312
Epoch: 5, Steps: 123 | Train Loss: 0.8747213 Vali Loss: 0.6017088 Best vali loss: 0.5982770
	iters: 100, epoch: 6 | loss: 0.8481180
	speed: 0.0102s/iter; left time: 2.7441s
Updating learning rate to 6.0182929039500455e-05
Epoch: 6 cost time: 0.7664046287536621
Epoch: 6, Steps: 123 | Train Loss: 0.8481180 Vali Loss: 0.6070722 Best vali loss: 0.5982770
	iters: 100, epoch: 7 | loss: 0.7725636
	speed: 0.0094s/iter; left time: 1.3871s
Updating learning rate to 1.5641033656858497e-05
Epoch: 7 cost time: 0.7182023525238037
Epoch: 7, Steps: 123 | Train Loss: 0.7725636 Vali Loss: 0.6063798 Best vali loss: 0.5982770
	iters: 100, epoch: 8 | loss: 0.6924139
	speed: 0.0098s/iter; left time: 0.2345s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7463045120239258
Epoch: 8, Steps: 123 | Train Loss: 0.6924139 Vali Loss: 0.6069584 Best vali loss: 0.5982770

best validation loss 0.5982769561387609

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.008835229483, 'e_layers': 1, 'learning_rate': 0.0016070226056, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7612794
	speed: 0.0097s/iter; left time: 18.0603s
	iters: 200, epoch: 1 | loss: 0.7883686
	speed: 0.0044s/iter; left time: 7.7404s
Updating learning rate to 0.001545858949598399
Validation loss decreased (inf --> 0.6185).  Saving model state dict ...
Epoch: 1 cost time: 1.3381507396697998
Epoch: 1, Steps: 245 | Train Loss: 0.7748240 Vali Loss: 0.6185281 Best vali loss: 0.6185281
	iters: 100, epoch: 2 | loss: 0.8037022
	speed: 0.0098s/iter; left time: 15.8601s
	iters: 200, epoch: 2 | loss: 1.0350244
	speed: 0.0045s/iter; left time: 6.7578s
Updating learning rate to 0.0013716795937699173
Epoch: 2 cost time: 1.137416124343872
Epoch: 2, Steps: 245 | Train Loss: 0.9193633 Vali Loss: 0.6399950 Best vali loss: 0.6185281
	iters: 100, epoch: 3 | loss: 1.1117392
	speed: 0.0101s/iter; left time: 13.7806s
	iters: 200, epoch: 3 | loss: 0.7803931
	speed: 0.0043s/iter; left time: 5.4834s
Updating learning rate to 0.0011110017660996491
Epoch: 3 cost time: 1.149312973022461
Epoch: 3, Steps: 245 | Train Loss: 0.9460661 Vali Loss: 0.6452626 Best vali loss: 0.6185281
	iters: 100, epoch: 4 | loss: 0.7641377
	speed: 0.0100s/iter; left time: 11.3140s
	iters: 200, epoch: 4 | loss: 0.6601235
	speed: 0.0046s/iter; left time: 4.7003s
Updating learning rate to 0.0008035113028
Epoch: 4 cost time: 1.1686522960662842
Epoch: 4, Steps: 245 | Train Loss: 0.7121306 Vali Loss: 0.6268218 Best vali loss: 0.6185281
	iters: 100, epoch: 5 | loss: 1.0479126
	speed: 0.0100s/iter; left time: 8.8459s
	iters: 200, epoch: 5 | loss: 0.6668214
	speed: 0.0043s/iter; left time: 3.3871s
Updating learning rate to 0.0004960208395003511
Epoch: 5 cost time: 1.1370699405670166
Epoch: 5, Steps: 245 | Train Loss: 0.8573670 Vali Loss: 0.6512299 Best vali loss: 0.6185281
	iters: 100, epoch: 6 | loss: 0.6204154
	speed: 0.0101s/iter; left time: 6.4529s
	iters: 200, epoch: 6 | loss: 0.4801936
	speed: 0.0043s/iter; left time: 2.3160s
Updating learning rate to 0.00023534301183008273
Epoch: 6 cost time: 1.1679162979125977
Epoch: 6, Steps: 245 | Train Loss: 0.5503045 Vali Loss: 0.6875865 Best vali loss: 0.6185281
	iters: 100, epoch: 7 | loss: 0.5884833
	speed: 0.0107s/iter; left time: 4.1787s
	iters: 200, epoch: 7 | loss: 0.5322987
	speed: 0.0044s/iter; left time: 1.2858s
Updating learning rate to 6.116365600160105e-05
Epoch: 7 cost time: 1.144573450088501
Epoch: 7, Steps: 245 | Train Loss: 0.5603910 Vali Loss: 0.6956915 Best vali loss: 0.6185281
	iters: 100, epoch: 8 | loss: 0.3355642
	speed: 0.0100s/iter; left time: 1.4617s
	iters: 200, epoch: 8 | loss: 0.6905882
	speed: 0.0039s/iter; left time: 0.1781s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1295909881591797
Epoch: 8, Steps: 245 | Train Loss: 0.5130762 Vali Loss: 0.7072150 Best vali loss: 0.6185281

best validation loss 0.6185281433092671

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.003701149266, 'e_layers': 1, 'learning_rate': 0.0002377962535, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6683575
	speed: 0.0113s/iter; left time: 9.9905s
Updating learning rate to 0.0002377962535
Validation loss decreased (inf --> 0.6420).  Saving model state dict ...
Epoch: 1 cost time: 0.9887628555297852
Epoch: 1, Steps: 123 | Train Loss: 0.6683575 Vali Loss: 0.6420284 Best vali loss: 0.6420284
	iters: 100, epoch: 2 | loss: 0.6920264
	speed: 0.0097s/iter; left time: 7.3675s
Updating learning rate to 0.00011889812675
Validation loss decreased (0.6420 --> 0.6154).  Saving model state dict ...
Epoch: 2 cost time: 0.7522072792053223
Epoch: 2, Steps: 123 | Train Loss: 0.6920264 Vali Loss: 0.6153754 Best vali loss: 0.6153754
	iters: 100, epoch: 3 | loss: 0.7403968
	speed: 0.0100s/iter; left time: 6.3745s
Updating learning rate to 5.9449063375e-05
Validation loss decreased (0.6154 --> 0.6080).  Saving model state dict ...
Epoch: 3 cost time: 0.7859935760498047
Epoch: 3, Steps: 123 | Train Loss: 0.7403968 Vali Loss: 0.6079966 Best vali loss: 0.6079966

best validation loss 0.6079966309499762

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7990128
	speed: 0.0117s/iter; left time: 21.8016s
	iters: 200, epoch: 1 | loss: 0.9350414
	speed: 0.0059s/iter; left time: 10.3051s
Updating learning rate to 0.000380413518
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.7236435413360596
Epoch: 1, Steps: 245 | Train Loss: 0.8670271 Vali Loss: 0.6172175 Best vali loss: 0.6172175
	iters: 100, epoch: 2 | loss: 0.9442707
	speed: 0.0110s/iter; left time: 17.8514s
	iters: 200, epoch: 2 | loss: 0.8720335
	speed: 0.0040s/iter; left time: 6.0218s
Updating learning rate to 0.000190206759
Validation loss decreased (0.6172 --> 0.5840).  Saving model state dict ...
Epoch: 2 cost time: 1.1330461502075195
Epoch: 2, Steps: 245 | Train Loss: 0.9081521 Vali Loss: 0.5839532 Best vali loss: 0.5839532
	iters: 100, epoch: 3 | loss: 0.7328448
	speed: 0.0114s/iter; left time: 15.6532s
	iters: 200, epoch: 3 | loss: 0.6012469
	speed: 0.0060s/iter; left time: 7.6383s
Updating learning rate to 9.51033795e-05
Validation loss decreased (0.5840 --> 0.5563).  Saving model state dict ...
Epoch: 3 cost time: 1.5389869213104248
Epoch: 3, Steps: 245 | Train Loss: 0.6670459 Vali Loss: 0.5562787 Best vali loss: 0.5562787

best validation loss 0.5562786636171602

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038758267905, 'e_layers': 1, 'learning_rate': 0.0011658864209, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1474234
	speed: 0.0096s/iter; left time: 36.8562s
	iters: 200, epoch: 1 | loss: 0.5039167
	speed: 0.0036s/iter; left time: 13.5750s
	iters: 300, epoch: 1 | loss: 0.9614487
	speed: 0.0036s/iter; left time: 12.9719s
	iters: 400, epoch: 1 | loss: 0.7409003
	speed: 0.0033s/iter; left time: 11.7814s
Updating learning rate to 0.0011215125112011748
Validation loss decreased (inf --> 0.6154).  Saving model state dict ...
Epoch: 1 cost time: 2.086897134780884
Epoch: 1, Steps: 490 | Train Loss: 0.8384223 Vali Loss: 0.6154177 Best vali loss: 0.6154177
	iters: 100, epoch: 2 | loss: 0.6944100
	speed: 0.0114s/iter; left time: 38.1363s
	iters: 200, epoch: 2 | loss: 0.8885027
	speed: 0.0036s/iter; left time: 11.6109s
	iters: 300, epoch: 2 | loss: 0.7889613
	speed: 0.0035s/iter; left time: 11.0398s
	iters: 400, epoch: 2 | loss: 0.8814310
	speed: 0.0034s/iter; left time: 10.2493s
Updating learning rate to 0.0009951463076058517
Epoch: 2 cost time: 1.7646028995513916
Epoch: 2, Steps: 490 | Train Loss: 0.8133262 Vali Loss: 0.6155948 Best vali loss: 0.6154177
	iters: 100, epoch: 3 | loss: 0.8993956
	speed: 0.0113s/iter; left time: 31.9924s
	iters: 200, epoch: 3 | loss: 0.8586418
	speed: 0.0039s/iter; left time: 10.6792s
	iters: 300, epoch: 3 | loss: 1.0369214
	speed: 0.0035s/iter; left time: 9.1277s
	iters: 400, epoch: 3 | loss: 0.6862473
	speed: 0.0034s/iter; left time: 8.5952s
Updating learning rate to 0.0008060259190989309
Epoch: 3 cost time: 1.8082349300384521
Epoch: 3, Steps: 490 | Train Loss: 0.8703015 Vali Loss: 0.6644371 Best vali loss: 0.6154177

best validation loss 0.6154177486206965

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6749210
	speed: 0.0118s/iter; left time: 13.2745s
	iters: 200, epoch: 4 | loss: 0.6737163
	speed: 0.0058s/iter; left time: 5.9358s
Updating learning rate to 4.755168975e-05
Validation loss decreased (0.5563 --> 0.5444).  Saving model state dict ...
Epoch: 4 cost time: 1.749706506729126
Epoch: 4, Steps: 245 | Train Loss: 0.6743187 Vali Loss: 0.5444231 Best vali loss: 0.5444231
	iters: 100, epoch: 5 | loss: 0.9042117
	speed: 0.0126s/iter; left time: 11.0817s
	iters: 200, epoch: 5 | loss: 0.6633887
	speed: 0.0062s/iter; left time: 4.8759s
Updating learning rate to 2.3775844875e-05
Validation loss decreased (0.5444 --> 0.5416).  Saving model state dict ...
Epoch: 5 cost time: 1.5536401271820068
Epoch: 5, Steps: 245 | Train Loss: 0.7838002 Vali Loss: 0.5416188 Best vali loss: 0.5416188
	iters: 100, epoch: 6 | loss: 0.7169440
	speed: 0.0126s/iter; left time: 8.0135s
	iters: 200, epoch: 6 | loss: 0.5954053
	speed: 0.0057s/iter; left time: 3.0486s
Updating learning rate to 1.18879224375e-05
Validation loss decreased (0.5416 --> 0.5392).  Saving model state dict ...
Epoch: 6 cost time: 1.518726110458374
Epoch: 6, Steps: 245 | Train Loss: 0.6561747 Vali Loss: 0.5392276 Best vali loss: 0.5392276
	iters: 100, epoch: 7 | loss: 0.7493198
	speed: 0.0126s/iter; left time: 4.9403s
	iters: 200, epoch: 7 | loss: 0.4820168
	speed: 0.0060s/iter; left time: 1.7594s
Updating learning rate to 5.94396121875e-06
Validation loss decreased (0.5392 --> 0.5382).  Saving model state dict ...
Epoch: 7 cost time: 1.5342881679534912
Epoch: 7, Steps: 245 | Train Loss: 0.6156683 Vali Loss: 0.5382339 Best vali loss: 0.5382339
	iters: 100, epoch: 8 | loss: 0.7024436
	speed: 0.0126s/iter; left time: 1.8449s
	iters: 200, epoch: 8 | loss: 1.0375055
	speed: 0.0064s/iter; left time: 0.2951s
Updating learning rate to 2.971980609375e-06
Epoch: 8 cost time: 1.5672879219055176
Epoch: 8, Steps: 245 | Train Loss: 0.8699746 Vali Loss: 0.5399085 Best vali loss: 0.5382339

best validation loss 0.5382339091749999

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072680941331, 'e_layers': 3, 'learning_rate': 0.0001290367597, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5280249
	speed: 0.0127s/iter; left time: 48.6611s
	iters: 200, epoch: 1 | loss: 0.4887058
	speed: 0.0063s/iter; left time: 23.5857s
	iters: 300, epoch: 1 | loss: 0.5283834
	speed: 0.0063s/iter; left time: 22.8364s
	iters: 400, epoch: 1 | loss: 0.4710268
	speed: 0.0060s/iter; left time: 20.9808s
Updating learning rate to 0.0001290367597
Validation loss decreased (inf --> 0.6003).  Saving model state dict ...
Epoch: 1 cost time: 3.3812599182128906
Epoch: 1, Steps: 490 | Train Loss: 0.5040352 Vali Loss: 0.6002707 Best vali loss: 0.6002707
	iters: 100, epoch: 2 | loss: 1.1971153
	speed: 0.0172s/iter; left time: 57.3959s
	iters: 200, epoch: 2 | loss: 0.8454405
	speed: 0.0063s/iter; left time: 20.3684s
	iters: 300, epoch: 2 | loss: 0.4720864
	speed: 0.0065s/iter; left time: 20.3078s
	iters: 400, epoch: 2 | loss: 0.8039364
	speed: 0.0064s/iter; left time: 19.2900s
Updating learning rate to 6.451837985e-05
Validation loss decreased (0.6003 --> 0.5931).  Saving model state dict ...
Epoch: 2 cost time: 3.1983442306518555
Epoch: 2, Steps: 490 | Train Loss: 0.8296447 Vali Loss: 0.5931258 Best vali loss: 0.5931258
	iters: 100, epoch: 3 | loss: 0.5588891
	speed: 0.0177s/iter; left time: 50.3778s
	iters: 200, epoch: 3 | loss: 0.7724993
	speed: 0.0064s/iter; left time: 17.6263s
	iters: 300, epoch: 3 | loss: 0.9826672
	speed: 0.0063s/iter; left time: 16.6274s
	iters: 400, epoch: 3 | loss: 0.8260806
	speed: 0.0063s/iter; left time: 15.9953s
Updating learning rate to 3.2259189925e-05
Validation loss decreased (0.5931 --> 0.5602).  Saving model state dict ...
Epoch: 3 cost time: 3.201617479324341
Epoch: 3, Steps: 490 | Train Loss: 0.7850341 Vali Loss: 0.5601509 Best vali loss: 0.5601509
	iters: 100, epoch: 4 | loss: 0.5387688
	speed: 0.0157s/iter; left time: 37.0154s
	iters: 200, epoch: 4 | loss: 0.9562023
	speed: 0.0047s/iter; left time: 10.5129s
	iters: 300, epoch: 4 | loss: 0.8049479
	speed: 0.0059s/iter; left time: 12.7174s
	iters: 400, epoch: 4 | loss: 0.8684611
	speed: 0.0063s/iter; left time: 12.8659s
Updating learning rate to 1.61295949625e-05
Epoch: 4 cost time: 2.733314037322998
Epoch: 4, Steps: 490 | Train Loss: 0.7920950 Vali Loss: 0.5682635 Best vali loss: 0.5601509
	iters: 100, epoch: 5 | loss: 0.8460986
	speed: 0.0144s/iter; left time: 26.8792s
	iters: 200, epoch: 5 | loss: 0.5479888
	speed: 0.0054s/iter; left time: 9.4412s
	iters: 300, epoch: 5 | loss: 0.8754396
	speed: 0.0054s/iter; left time: 9.0066s
	iters: 400, epoch: 5 | loss: 0.7654607
	speed: 0.0054s/iter; left time: 8.4144s
Updating learning rate to 8.06479748125e-06
Validation loss decreased (0.5602 --> 0.5579).  Saving model state dict ...
Epoch: 5 cost time: 2.623398780822754
Epoch: 5, Steps: 490 | Train Loss: 0.7587469 Vali Loss: 0.5578702 Best vali loss: 0.5578702
	iters: 100, epoch: 6 | loss: 0.6219015
	speed: 0.0151s/iter; left time: 20.7102s
	iters: 200, epoch: 6 | loss: 0.6590924
	speed: 0.0051s/iter; left time: 6.5212s
	iters: 300, epoch: 6 | loss: 0.7449361
	speed: 0.0052s/iter; left time: 6.1104s
	iters: 400, epoch: 6 | loss: 1.0772507
	speed: 0.0053s/iter; left time: 5.6571s
Updating learning rate to 4.032398740625e-06
Validation loss decreased (0.5579 --> 0.5528).  Saving model state dict ...
Epoch: 6 cost time: 2.6274566650390625
Epoch: 6, Steps: 490 | Train Loss: 0.7757952 Vali Loss: 0.5527819 Best vali loss: 0.5527819
	iters: 100, epoch: 7 | loss: 0.8814420
	speed: 0.0144s/iter; left time: 12.6918s
	iters: 200, epoch: 7 | loss: 0.5915195
	speed: 0.0051s/iter; left time: 3.9768s
	iters: 300, epoch: 7 | loss: 0.5025396
	speed: 0.0052s/iter; left time: 3.5724s
	iters: 400, epoch: 7 | loss: 0.4747078
	speed: 0.0053s/iter; left time: 3.1002s
Updating learning rate to 2.0161993703125e-06
Epoch: 7 cost time: 2.616786241531372
Epoch: 7, Steps: 490 | Train Loss: 0.6125522 Vali Loss: 0.5577550 Best vali loss: 0.5527819
	iters: 100, epoch: 8 | loss: 1.0831649
	speed: 0.0150s/iter; left time: 5.8599s
	iters: 200, epoch: 8 | loss: 0.8182706
	speed: 0.0053s/iter; left time: 1.5495s
	iters: 300, epoch: 8 | loss: 0.9407285
	speed: 0.0054s/iter; left time: 1.0226s
	iters: 400, epoch: 8 | loss: 0.4973481
	speed: 0.0054s/iter; left time: 0.4869s
Updating learning rate to 1.00809968515625e-06
Validation loss decreased (0.5528 --> 0.5525).  Saving model state dict ...
Epoch: 8 cost time: 2.6848819255828857
Epoch: 8, Steps: 490 | Train Loss: 0.8348780 Vali Loss: 0.5524681 Best vali loss: 0.5524681

best validation loss 0.5524681455169989

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0008547466509, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.7445185
	speed: 0.0120s/iter; left time: 45.9889s
	iters: 200, epoch: 1 | loss: 0.6588618
	speed: 0.0062s/iter; left time: 23.1231s
	iters: 300, epoch: 1 | loss: 0.6646582
	speed: 0.0063s/iter; left time: 22.6884s
	iters: 400, epoch: 1 | loss: 0.7568775
	speed: 0.0062s/iter; left time: 21.9423s
Updating learning rate to 0.00082221479357454
Validation loss decreased (inf --> 0.6264).  Saving model state dict ...
Epoch: 1 cost time: 3.3483216762542725
Epoch: 1, Steps: 490 | Train Loss: 0.9562290 Vali Loss: 0.6264319 Best vali loss: 0.6264319
	iters: 100, epoch: 2 | loss: 1.7319956
	speed: 0.0165s/iter; left time: 54.9445s
	iters: 200, epoch: 2 | loss: 0.7324037
	speed: 0.0062s/iter; left time: 20.0314s
	iters: 300, epoch: 2 | loss: 0.5082525
	speed: 0.0058s/iter; left time: 18.0759s
	iters: 400, epoch: 2 | loss: 0.6932700
	speed: 0.0057s/iter; left time: 17.2418s
Updating learning rate to 0.0007295719019739402
Validation loss decreased (0.6264 --> 0.6181).  Saving model state dict ...
Epoch: 2 cost time: 2.9057016372680664
Epoch: 2, Steps: 490 | Train Loss: 0.9164804 Vali Loss: 0.6180694 Best vali loss: 0.6180694
	iters: 100, epoch: 3 | loss: 0.8382826
	speed: 0.0157s/iter; left time: 44.5872s
	iters: 200, epoch: 3 | loss: 0.4426602
	speed: 0.0059s/iter; left time: 16.1227s
	iters: 300, epoch: 3 | loss: 1.2444290
	speed: 0.0059s/iter; left time: 15.5102s
	iters: 400, epoch: 3 | loss: 0.6793852
	speed: 0.0061s/iter; left time: 15.6049s
Updating learning rate to 0.0005909220165344886
Validation loss decreased (0.6181 --> 0.6125).  Saving model state dict ...
Epoch: 3 cost time: 2.999386787414551
Epoch: 3, Steps: 490 | Train Loss: 0.8011893 Vali Loss: 0.6124893 Best vali loss: 0.6124893
	iters: 100, epoch: 4 | loss: 0.5643057
	speed: 0.0168s/iter; left time: 39.4142s
	iters: 200, epoch: 4 | loss: 0.5493472
	speed: 0.0062s/iter; left time: 14.0311s
	iters: 300, epoch: 4 | loss: 1.3915753
	speed: 0.0061s/iter; left time: 13.0729s
	iters: 400, epoch: 4 | loss: 0.6658513
	speed: 0.0061s/iter; left time: 12.4147s
Updating learning rate to 0.00042737332545
Epoch: 4 cost time: 3.0721046924591064
Epoch: 4, Steps: 490 | Train Loss: 0.7927699 Vali Loss: 0.6299599 Best vali loss: 0.6124893
	iters: 100, epoch: 5 | loss: 0.7670015
	speed: 0.0167s/iter; left time: 31.0916s
	iters: 200, epoch: 5 | loss: 0.7655079
	speed: 0.0060s/iter; left time: 10.5909s
	iters: 300, epoch: 5 | loss: 1.1460234
	speed: 0.0061s/iter; left time: 10.0746s
	iters: 400, epoch: 5 | loss: 0.7913681
	speed: 0.0062s/iter; left time: 9.6602s
Updating learning rate to 0.00026382463436551147
Epoch: 5 cost time: 3.069016218185425
Epoch: 5, Steps: 490 | Train Loss: 0.8674752 Vali Loss: 0.6220487 Best vali loss: 0.6124893
	iters: 100, epoch: 6 | loss: 0.9125847
	speed: 0.0171s/iter; left time: 23.4303s
	iters: 200, epoch: 6 | loss: 1.0244684
	speed: 0.0060s/iter; left time: 7.6777s
	iters: 300, epoch: 6 | loss: 0.8246691
	speed: 0.0063s/iter; left time: 7.3925s
	iters: 400, epoch: 6 | loss: 0.4868438
	speed: 0.0067s/iter; left time: 7.1532s
Updating learning rate to 0.0001251747489260597
Epoch: 6 cost time: 3.200345993041992
Epoch: 6, Steps: 490 | Train Loss: 0.8121415 Vali Loss: 0.6184082 Best vali loss: 0.6124893
	iters: 100, epoch: 7 | loss: 0.5310516
	speed: 0.0174s/iter; left time: 15.3357s
	iters: 200, epoch: 7 | loss: 0.7182628
	speed: 0.0063s/iter; left time: 4.9150s
	iters: 300, epoch: 7 | loss: 0.5402212
	speed: 0.0064s/iter; left time: 4.3251s
	iters: 400, epoch: 7 | loss: 1.5807188
	speed: 0.0063s/iter; left time: 3.6878s
Updating learning rate to 3.253185732546e-05
Epoch: 7 cost time: 3.1607918739318848
Epoch: 7, Steps: 490 | Train Loss: 0.8425636 Vali Loss: 0.6225845 Best vali loss: 0.6124893
	iters: 100, epoch: 8 | loss: 0.8200236
	speed: 0.0161s/iter; left time: 6.2907s
	iters: 200, epoch: 8 | loss: 0.8525377
	speed: 0.0057s/iter; left time: 1.6543s
	iters: 300, epoch: 8 | loss: 0.9017681
	speed: 0.0063s/iter; left time: 1.2125s
	iters: 400, epoch: 8 | loss: 0.6116986
	speed: 0.0062s/iter; left time: 0.5633s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0058162212371826
Epoch: 8, Steps: 490 | Train Loss: 0.7965070 Vali Loss: 0.6217091 Best vali loss: 0.6124893

best validation loss 0.6124892920076378

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0076310052387, 'e_layers': 2, 'learning_rate': 6.80015623e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.80015623e-05
Validation loss decreased (inf --> 0.7045).  Saving model state dict ...
Epoch: 1 cost time: 0.7071070671081543
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7044762 Best vali loss: 0.7044762
Updating learning rate to 3.400078115e-05
Validation loss decreased (0.7045 --> 0.6943).  Saving model state dict ...
Epoch: 2 cost time: 0.46248483657836914
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6943191 Best vali loss: 0.6943191
Updating learning rate to 1.7000390575e-05
Validation loss decreased (0.6943 --> 0.6895).  Saving model state dict ...
Epoch: 3 cost time: 0.46411585807800293
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6894892 Best vali loss: 0.6894892

best validation loss 0.6894891639927481

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3513339
	speed: 0.0108s/iter; left time: 83.5696s
	iters: 200, epoch: 1 | loss: 0.5975659
	speed: 0.0050s/iter; left time: 38.4796s
	iters: 300, epoch: 1 | loss: 0.3686112
	speed: 0.0051s/iter; left time: 38.7392s
	iters: 400, epoch: 1 | loss: 1.5730687
	speed: 0.0050s/iter; left time: 37.4791s
	iters: 500, epoch: 1 | loss: 0.7479964
	speed: 0.0052s/iter; left time: 37.9595s
	iters: 600, epoch: 1 | loss: 1.1960959
	speed: 0.0051s/iter; left time: 37.0501s
	iters: 700, epoch: 1 | loss: 1.2037075
	speed: 0.0051s/iter; left time: 36.6557s
	iters: 800, epoch: 1 | loss: 0.2612354
	speed: 0.0051s/iter; left time: 35.9213s
	iters: 900, epoch: 1 | loss: 0.4276394
	speed: 0.0051s/iter; left time: 35.4265s
Updating learning rate to 0.0010132106523
Validation loss decreased (inf --> 0.6364).  Saving model state dict ...
Epoch: 1 cost time: 5.317007541656494
Epoch: 1, Steps: 979 | Train Loss: 0.7474727 Vali Loss: 0.6364039 Best vali loss: 0.6364039
	iters: 100, epoch: 2 | loss: 0.5200983
	speed: 0.0164s/iter; left time: 110.8542s
	iters: 200, epoch: 2 | loss: 1.0756305
	speed: 0.0052s/iter; left time: 34.7587s
	iters: 300, epoch: 2 | loss: 0.9044672
	speed: 0.0052s/iter; left time: 33.7590s
	iters: 400, epoch: 2 | loss: 0.3734673
	speed: 0.0051s/iter; left time: 32.9171s
	iters: 500, epoch: 2 | loss: 0.5948046
	speed: 0.0052s/iter; left time: 33.1312s
	iters: 600, epoch: 2 | loss: 0.6055387
	speed: 0.0051s/iter; left time: 31.8779s
	iters: 700, epoch: 2 | loss: 0.9808382
	speed: 0.0049s/iter; left time: 30.2472s
	iters: 800, epoch: 2 | loss: 0.4429869
	speed: 0.0048s/iter; left time: 28.7877s
	iters: 900, epoch: 2 | loss: 0.6706837
	speed: 0.0048s/iter; left time: 28.8447s
Updating learning rate to 0.00050660532615
Validation loss decreased (0.6364 --> 0.6119).  Saving model state dict ...
Epoch: 2 cost time: 5.017353296279907
Epoch: 2, Steps: 979 | Train Loss: 0.6853906 Vali Loss: 0.6119436 Best vali loss: 0.6119436
	iters: 100, epoch: 3 | loss: 1.7178044
	speed: 0.0162s/iter; left time: 93.3414s
	iters: 200, epoch: 3 | loss: 0.9975501
	speed: 0.0054s/iter; left time: 30.4252s
	iters: 300, epoch: 3 | loss: 0.4907352
	speed: 0.0056s/iter; left time: 31.0372s
	iters: 400, epoch: 3 | loss: 0.7245852
	speed: 0.0054s/iter; left time: 29.6653s
	iters: 500, epoch: 3 | loss: 0.8435438
	speed: 0.0050s/iter; left time: 26.9748s
	iters: 600, epoch: 3 | loss: 1.6214447
	speed: 0.0050s/iter; left time: 26.4195s
	iters: 700, epoch: 3 | loss: 1.1800542
	speed: 0.0051s/iter; left time: 26.1755s
	iters: 800, epoch: 3 | loss: 0.4426887
	speed: 0.0052s/iter; left time: 26.1960s
	iters: 900, epoch: 3 | loss: 0.4561453
	speed: 0.0051s/iter; left time: 25.5680s
Updating learning rate to 0.000253302663075
Validation loss decreased (0.6119 --> 0.6049).  Saving model state dict ...
Epoch: 3 cost time: 5.137959241867065
Epoch: 3, Steps: 979 | Train Loss: 0.9416168 Vali Loss: 0.6049044 Best vali loss: 0.6049044

best validation loss 0.6049043609967998

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0028298480595, 'e_layers': 3, 'learning_rate': 0.0049106915834, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5609448
	speed: 0.0109s/iter; left time: 83.9533s
	iters: 200, epoch: 1 | loss: 0.4616673
	speed: 0.0051s/iter; left time: 39.2283s
	iters: 300, epoch: 1 | loss: 0.4590980
	speed: 0.0052s/iter; left time: 39.5381s
	iters: 400, epoch: 1 | loss: 0.6332256
	speed: 0.0051s/iter; left time: 38.1675s
	iters: 500, epoch: 1 | loss: 0.6102377
	speed: 0.0052s/iter; left time: 38.1425s
	iters: 600, epoch: 1 | loss: 0.7465973
	speed: 0.0053s/iter; left time: 38.2251s
	iters: 700, epoch: 1 | loss: 1.2587620
	speed: 0.0053s/iter; left time: 37.4698s
	iters: 800, epoch: 1 | loss: 1.6682401
	speed: 0.0053s/iter; left time: 37.0506s
	iters: 900, epoch: 1 | loss: 0.7632124
	speed: 0.0053s/iter; left time: 36.9846s
Updating learning rate to 0.004723789513889351
Validation loss decreased (inf --> 0.6422).  Saving model state dict ...
Epoch: 1 cost time: 5.420992612838745
Epoch: 1, Steps: 979 | Train Loss: 0.7957761 Vali Loss: 0.6421703 Best vali loss: 0.6421703
	iters: 100, epoch: 2 | loss: 0.6467825
	speed: 0.0154s/iter; left time: 103.8256s
	iters: 200, epoch: 2 | loss: 0.3473868
	speed: 0.0043s/iter; left time: 28.3172s
	iters: 300, epoch: 2 | loss: 0.8856343
	speed: 0.0047s/iter; left time: 30.8463s
	iters: 400, epoch: 2 | loss: 0.7476214
	speed: 0.0050s/iter; left time: 32.2703s
	iters: 500, epoch: 2 | loss: 0.6907877
	speed: 0.0050s/iter; left time: 32.0511s
	iters: 600, epoch: 2 | loss: 1.5904417
	speed: 0.0051s/iter; left time: 32.2058s
	iters: 700, epoch: 2 | loss: 0.9291414
	speed: 0.0051s/iter; left time: 31.5515s
	iters: 800, epoch: 2 | loss: 0.3392234
	speed: 0.0051s/iter; left time: 30.9449s
	iters: 900, epoch: 2 | loss: 0.8144705
	speed: 0.0051s/iter; left time: 30.3183s
Updating learning rate to 0.004191537451168922
Epoch: 2 cost time: 4.811276197433472
Epoch: 2, Steps: 979 | Train Loss: 0.7768322 Vali Loss: 0.6537884 Best vali loss: 0.6421703
	iters: 100, epoch: 3 | loss: 1.0497653
	speed: 0.0158s/iter; left time: 90.9860s
	iters: 200, epoch: 3 | loss: 0.4280875
	speed: 0.0049s/iter; left time: 27.7917s
	iters: 300, epoch: 3 | loss: 0.4667214
	speed: 0.0050s/iter; left time: 28.0844s
	iters: 400, epoch: 3 | loss: 1.3590467
	speed: 0.0051s/iter; left time: 27.6990s
	iters: 500, epoch: 3 | loss: 0.8441050
	speed: 0.0049s/iter; left time: 26.4629s
	iters: 600, epoch: 3 | loss: 1.3224100
	speed: 0.0049s/iter; left time: 25.7122s
	iters: 700, epoch: 3 | loss: 0.4628425
	speed: 0.0051s/iter; left time: 26.1836s
	iters: 800, epoch: 3 | loss: 0.3789353
	speed: 0.0051s/iter; left time: 25.9347s
	iters: 900, epoch: 3 | loss: 1.0111251
	speed: 0.0051s/iter; left time: 25.3595s
Updating learning rate to 0.003394965946910935
Epoch: 3 cost time: 4.906655788421631
Epoch: 3, Steps: 979 | Train Loss: 0.8136710 Vali Loss: 0.6446507 Best vali loss: 0.6421703

best validation loss 0.6421702669374041

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3395632
	speed: 0.0108s/iter; left time: 51.8221s
	iters: 200, epoch: 4 | loss: 0.5719544
	speed: 0.0050s/iter; left time: 23.6488s
	iters: 300, epoch: 4 | loss: 0.3883559
	speed: 0.0051s/iter; left time: 23.3524s
	iters: 400, epoch: 4 | loss: 1.4996867
	speed: 0.0051s/iter; left time: 22.9470s
	iters: 500, epoch: 4 | loss: 0.7350487
	speed: 0.0051s/iter; left time: 22.3808s
	iters: 600, epoch: 4 | loss: 1.1847444
	speed: 0.0050s/iter; left time: 21.6109s
	iters: 700, epoch: 4 | loss: 1.2151363
	speed: 0.0047s/iter; left time: 19.7157s
	iters: 800, epoch: 4 | loss: 0.2392808
	speed: 0.0047s/iter; left time: 19.3554s
	iters: 900, epoch: 4 | loss: 0.3800006
	speed: 0.0050s/iter; left time: 19.9927s
Updating learning rate to 0.0001266513315375
Epoch: 4 cost time: 5.1783225536346436
Epoch: 4, Steps: 979 | Train Loss: 0.7281968 Vali Loss: 0.6193322 Best vali loss: 0.6049044
	iters: 100, epoch: 5 | loss: 0.4377998
	speed: 0.0163s/iter; left time: 62.3045s
	iters: 200, epoch: 5 | loss: 1.0003288
	speed: 0.0051s/iter; left time: 18.9909s
	iters: 300, epoch: 5 | loss: 0.8475949
	speed: 0.0050s/iter; left time: 18.2102s
	iters: 400, epoch: 5 | loss: 0.3032108
	speed: 0.0050s/iter; left time: 17.5329s
	iters: 500, epoch: 5 | loss: 0.5603229
	speed: 0.0049s/iter; left time: 16.8141s
	iters: 600, epoch: 5 | loss: 0.6565678
	speed: 0.0048s/iter; left time: 16.0732s
	iters: 700, epoch: 5 | loss: 0.9694042
	speed: 0.0048s/iter; left time: 15.3228s
	iters: 800, epoch: 5 | loss: 0.3864135
	speed: 0.0046s/iter; left time: 14.4084s
	iters: 900, epoch: 5 | loss: 0.7129862
	speed: 0.0048s/iter; left time: 14.5523s
Updating learning rate to 6.332566576875e-05
Epoch: 5 cost time: 4.87746000289917
Epoch: 5, Steps: 979 | Train Loss: 0.6527365 Vali Loss: 0.6256437 Best vali loss: 0.6049044
	iters: 100, epoch: 6 | loss: 1.7212263
	speed: 0.0163s/iter; left time: 46.3616s
	iters: 200, epoch: 6 | loss: 0.9611534
	speed: 0.0053s/iter; left time: 14.4257s
	iters: 300, epoch: 6 | loss: 0.4698895
	speed: 0.0054s/iter; left time: 14.2130s
	iters: 400, epoch: 6 | loss: 0.7314868
	speed: 0.0047s/iter; left time: 11.9873s
	iters: 500, epoch: 6 | loss: 0.9003547
	speed: 0.0049s/iter; left time: 12.0323s
	iters: 600, epoch: 6 | loss: 1.2941968
	speed: 0.0050s/iter; left time: 11.7515s
	iters: 700, epoch: 6 | loss: 1.0897536
	speed: 0.0052s/iter; left time: 11.6043s
	iters: 800, epoch: 6 | loss: 0.4273365
	speed: 0.0053s/iter; left time: 11.3638s
	iters: 900, epoch: 6 | loss: 0.4321687
	speed: 0.0053s/iter; left time: 10.7191s
Updating learning rate to 3.1662832884375e-05
Epoch: 6 cost time: 5.147386789321899
Epoch: 6, Steps: 979 | Train Loss: 0.8919518 Vali Loss: 0.6302300 Best vali loss: 0.6049044
	iters: 100, epoch: 7 | loss: 0.6453705
	speed: 0.0170s/iter; left time: 31.6489s
	iters: 200, epoch: 7 | loss: 1.1368011
	speed: 0.0049s/iter; left time: 8.5540s
	iters: 300, epoch: 7 | loss: 0.8410631
	speed: 0.0049s/iter; left time: 8.0690s
	iters: 400, epoch: 7 | loss: 0.8475988
	speed: 0.0048s/iter; left time: 7.4893s
	iters: 500, epoch: 7 | loss: 0.7177126
	speed: 0.0049s/iter; left time: 7.1980s
	iters: 600, epoch: 7 | loss: 1.0993214
	speed: 0.0049s/iter; left time: 6.7009s
	iters: 700, epoch: 7 | loss: 0.5702174
	speed: 0.0050s/iter; left time: 6.2762s
	iters: 800, epoch: 7 | loss: 0.3536857
	speed: 0.0049s/iter; left time: 5.6944s
	iters: 900, epoch: 7 | loss: 0.9216607
	speed: 0.0051s/iter; left time: 5.3726s
Updating learning rate to 1.58314164421875e-05
Epoch: 7 cost time: 4.893638849258423
Epoch: 7, Steps: 979 | Train Loss: 0.7926035 Vali Loss: 0.6429372 Best vali loss: 0.6049044
	iters: 100, epoch: 8 | loss: 0.6853671
	speed: 0.0159s/iter; left time: 14.0240s
	iters: 200, epoch: 8 | loss: 0.8557315
	speed: 0.0050s/iter; left time: 3.9175s
	iters: 300, epoch: 8 | loss: 0.2947741
	speed: 0.0049s/iter; left time: 3.3165s
	iters: 400, epoch: 8 | loss: 0.3205218
	speed: 0.0049s/iter; left time: 2.8605s
	iters: 500, epoch: 8 | loss: 0.7733518
	speed: 0.0050s/iter; left time: 2.4054s
	iters: 600, epoch: 8 | loss: 0.7958992
	speed: 0.0050s/iter; left time: 1.9034s
	iters: 700, epoch: 8 | loss: 0.8521335
	speed: 0.0049s/iter; left time: 1.3787s
	iters: 800, epoch: 8 | loss: 0.8188117
	speed: 0.0048s/iter; left time: 0.8555s
	iters: 900, epoch: 8 | loss: 0.5132962
	speed: 0.0050s/iter; left time: 0.3992s
Updating learning rate to 7.91570822109375e-06
Epoch: 8 cost time: 4.891141414642334
Epoch: 8, Steps: 979 | Train Loss: 0.6566541 Vali Loss: 0.6426811 Best vali loss: 0.6049044

best validation loss 0.6049043609967998

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0049587887577, 'e_layers': 2, 'learning_rate': 0.0017288793159, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7869606
	speed: 0.0100s/iter; left time: 77.6181s
	iters: 200, epoch: 1 | loss: 1.8769912
	speed: 0.0047s/iter; left time: 35.7131s
	iters: 300, epoch: 1 | loss: 0.9141142
	speed: 0.0047s/iter; left time: 35.4906s
	iters: 400, epoch: 1 | loss: 0.5644323
	speed: 0.0045s/iter; left time: 33.5009s
	iters: 500, epoch: 1 | loss: 0.6273519
	speed: 0.0045s/iter; left time: 32.9570s
	iters: 600, epoch: 1 | loss: 0.3799151
	speed: 0.0044s/iter; left time: 32.0336s
	iters: 700, epoch: 1 | loss: 0.4200667
	speed: 0.0048s/iter; left time: 34.3023s
	iters: 800, epoch: 1 | loss: 0.5605507
	speed: 0.0048s/iter; left time: 34.0149s
	iters: 900, epoch: 1 | loss: 1.3238108
	speed: 0.0048s/iter; left time: 33.4448s
Updating learning rate to 0.0016630777650210626
Validation loss decreased (inf --> 0.6246).  Saving model state dict ...
Epoch: 1 cost time: 4.8385210037231445
Epoch: 1, Steps: 979 | Train Loss: 0.8282437 Vali Loss: 0.6245856 Best vali loss: 0.6245856
	iters: 100, epoch: 2 | loss: 1.2729139
	speed: 0.0169s/iter; left time: 114.3612s
	iters: 200, epoch: 2 | loss: 1.0630831
	speed: 0.0047s/iter; left time: 31.0095s
	iters: 300, epoch: 2 | loss: 0.7553024
	speed: 0.0047s/iter; left time: 30.5236s
	iters: 400, epoch: 2 | loss: 0.3331458
	speed: 0.0046s/iter; left time: 29.7647s
	iters: 500, epoch: 2 | loss: 0.6689157
	speed: 0.0047s/iter; left time: 29.9309s
	iters: 600, epoch: 2 | loss: 0.7857778
	speed: 0.0046s/iter; left time: 28.4624s
	iters: 700, epoch: 2 | loss: 0.4648336
	speed: 0.0045s/iter; left time: 27.7483s
	iters: 800, epoch: 2 | loss: 0.5471483
	speed: 0.0043s/iter; left time: 25.8979s
	iters: 900, epoch: 2 | loss: 1.0131503
	speed: 0.0047s/iter; left time: 27.9096s
Updating learning rate to 0.0014756908020130246
Validation loss decreased (0.6246 --> 0.6195).  Saving model state dict ...
Epoch: 2 cost time: 4.533697128295898
Epoch: 2, Steps: 979 | Train Loss: 0.7671412 Vali Loss: 0.6195000 Best vali loss: 0.6195000
	iters: 100, epoch: 3 | loss: 0.8491747
	speed: 0.0169s/iter; left time: 97.6858s
	iters: 200, epoch: 3 | loss: 0.2699144
	speed: 0.0042s/iter; left time: 24.0333s
	iters: 300, epoch: 3 | loss: 1.6813043
	speed: 0.0046s/iter; left time: 25.5144s
	iters: 400, epoch: 3 | loss: 0.6311942
	speed: 0.0046s/iter; left time: 25.2514s
	iters: 500, epoch: 3 | loss: 0.4505170
	speed: 0.0046s/iter; left time: 24.8029s
	iters: 600, epoch: 3 | loss: 0.3990245
	speed: 0.0046s/iter; left time: 24.3363s
	iters: 700, epoch: 3 | loss: 0.7697141
	speed: 0.0047s/iter; left time: 24.1416s
	iters: 800, epoch: 3 | loss: 0.6760804
	speed: 0.0044s/iter; left time: 22.4172s
	iters: 900, epoch: 3 | loss: 0.7838367
	speed: 0.0046s/iter; left time: 23.0401s
Updating learning rate to 0.0011952463933268102
Epoch: 3 cost time: 4.497347116470337
Epoch: 3, Steps: 979 | Train Loss: 0.7234178 Vali Loss: 0.6357626 Best vali loss: 0.6195000
	iters: 100, epoch: 4 | loss: 0.7841197
	speed: 0.0167s/iter; left time: 80.2183s
	iters: 200, epoch: 4 | loss: 0.7404663
	speed: 0.0046s/iter; left time: 21.4814s
	iters: 300, epoch: 4 | loss: 0.6810469
	speed: 0.0045s/iter; left time: 20.5825s
	iters: 400, epoch: 4 | loss: 0.7061116
	speed: 0.0045s/iter; left time: 20.2431s
	iters: 500, epoch: 4 | loss: 0.3782445
	speed: 0.0046s/iter; left time: 20.2939s
	iters: 600, epoch: 4 | loss: 0.7620823
	speed: 0.0046s/iter; left time: 19.7581s
	iters: 700, epoch: 4 | loss: 1.5523313
	speed: 0.0047s/iter; left time: 19.8941s
	iters: 800, epoch: 4 | loss: 1.0804548
	speed: 0.0046s/iter; left time: 18.7617s
	iters: 900, epoch: 4 | loss: 0.6422367
	speed: 0.0047s/iter; left time: 18.8193s
Updating learning rate to 0.00086443965795
Epoch: 4 cost time: 4.544116973876953
Epoch: 4, Steps: 979 | Train Loss: 0.8141216 Vali Loss: 0.6258534 Best vali loss: 0.6195000
	iters: 100, epoch: 5 | loss: 0.3748032
	speed: 0.0171s/iter; left time: 65.3457s
	iters: 200, epoch: 5 | loss: 0.5242545
	speed: 0.0046s/iter; left time: 17.0039s
	iters: 300, epoch: 5 | loss: 0.7546436
	speed: 0.0045s/iter; left time: 16.4053s
	iters: 400, epoch: 5 | loss: 1.5611253
	speed: 0.0046s/iter; left time: 16.0827s
	iters: 500, epoch: 5 | loss: 1.0441200
	speed: 0.0039s/iter; left time: 13.4792s
	iters: 600, epoch: 5 | loss: 1.1075000
	speed: 0.0032s/iter; left time: 10.5414s
	iters: 700, epoch: 5 | loss: 0.9983999
	speed: 0.0032s/iter; left time: 10.2330s
	iters: 800, epoch: 5 | loss: 0.3952047
	speed: 0.0044s/iter; left time: 13.7466s
	iters: 900, epoch: 5 | loss: 0.3190775
	speed: 0.0046s/iter; left time: 13.8012s
Updating learning rate to 0.0005336329225731899
Epoch: 5 cost time: 4.183349609375
Epoch: 5, Steps: 979 | Train Loss: 0.7865699 Vali Loss: 0.6392644 Best vali loss: 0.6195000
	iters: 100, epoch: 6 | loss: 1.2739220
	speed: 0.0177s/iter; left time: 50.2916s
	iters: 200, epoch: 6 | loss: 1.4694098
	speed: 0.0048s/iter; left time: 13.0800s
	iters: 300, epoch: 6 | loss: 0.4732685
	speed: 0.0047s/iter; left time: 12.4592s
	iters: 400, epoch: 6 | loss: 0.9061995
	speed: 0.0047s/iter; left time: 12.0319s
	iters: 500, epoch: 6 | loss: 1.0351980
	speed: 0.0048s/iter; left time: 11.6074s
	iters: 600, epoch: 6 | loss: 1.2279056
	speed: 0.0047s/iter; left time: 11.0086s
	iters: 700, epoch: 6 | loss: 1.3449590
	speed: 0.0047s/iter; left time: 10.6196s
	iters: 800, epoch: 6 | loss: 1.3099257
	speed: 0.0045s/iter; left time: 9.6823s
	iters: 900, epoch: 6 | loss: 0.3456790
	speed: 0.0047s/iter; left time: 9.6287s
Updating learning rate to 0.0002531885138869754
Epoch: 6 cost time: 4.646521806716919
Epoch: 6, Steps: 979 | Train Loss: 1.0429408 Vali Loss: 0.6353666 Best vali loss: 0.6195000
	iters: 100, epoch: 7 | loss: 0.8650150
	speed: 0.0182s/iter; left time: 33.8534s
	iters: 200, epoch: 7 | loss: 0.8900058
	speed: 0.0045s/iter; left time: 7.8733s
	iters: 300, epoch: 7 | loss: 0.4500996
	speed: 0.0041s/iter; left time: 6.8219s
	iters: 400, epoch: 7 | loss: 0.3173002
	speed: 0.0032s/iter; left time: 4.9930s
	iters: 500, epoch: 7 | loss: 0.3687378
	speed: 0.0034s/iter; left time: 4.9854s
	iters: 600, epoch: 7 | loss: 0.7447163
	speed: 0.0044s/iter; left time: 5.9407s
	iters: 700, epoch: 7 | loss: 0.2923827
	speed: 0.0051s/iter; left time: 6.3929s
	iters: 800, epoch: 7 | loss: 0.4148254
	speed: 0.0043s/iter; left time: 5.0051s
	iters: 900, epoch: 7 | loss: 0.7735151
	speed: 0.0052s/iter; left time: 5.5014s
Updating learning rate to 6.580155087893739e-05
Epoch: 7 cost time: 4.347092866897583
Epoch: 7, Steps: 979 | Train Loss: 0.5685109 Vali Loss: 0.6651242 Best vali loss: 0.6195000
	iters: 100, epoch: 8 | loss: 0.7987912
	speed: 0.0165s/iter; left time: 14.4897s
	iters: 200, epoch: 8 | loss: 0.6633541
	speed: 0.0031s/iter; left time: 2.4505s
	iters: 300, epoch: 8 | loss: 0.4880531
	speed: 0.0035s/iter; left time: 2.3646s
	iters: 400, epoch: 8 | loss: 0.3561590
	speed: 0.0047s/iter; left time: 2.7483s
	iters: 500, epoch: 8 | loss: 0.9652516
	speed: 0.0051s/iter; left time: 2.4578s
	iters: 600, epoch: 8 | loss: 0.9435773
	speed: 0.0052s/iter; left time: 1.9585s
	iters: 700, epoch: 8 | loss: 1.2472355
	speed: 0.0051s/iter; left time: 1.4341s
	iters: 800, epoch: 8 | loss: 0.9688442
	speed: 0.0050s/iter; left time: 0.8992s
	iters: 900, epoch: 8 | loss: 0.4445403
	speed: 0.0046s/iter; left time: 0.3649s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.476736545562744
Epoch: 8, Steps: 979 | Train Loss: 0.7639785 Vali Loss: 0.6739701 Best vali loss: 0.6195000

best validation loss 0.619499978148678

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 2, 'learning_rate': 0.0007022928253, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3017061
	speed: 0.0112s/iter; left time: 42.9433s
	iters: 200, epoch: 1 | loss: 0.7697439
	speed: 0.0048s/iter; left time: 17.9937s
	iters: 300, epoch: 1 | loss: 0.6765001
	speed: 0.0052s/iter; left time: 18.8724s
	iters: 400, epoch: 1 | loss: 0.8426378
	speed: 0.0053s/iter; left time: 18.7838s
Updating learning rate to 0.0007022928253
Validation loss decreased (inf --> 0.6135).  Saving model state dict ...
Epoch: 1 cost time: 2.8503003120422363
Epoch: 1, Steps: 490 | Train Loss: 0.8976470 Vali Loss: 0.6135153 Best vali loss: 0.6135153
	iters: 100, epoch: 2 | loss: 0.8439684
	speed: 0.0157s/iter; left time: 52.2281s
	iters: 200, epoch: 2 | loss: 0.7893271
	speed: 0.0047s/iter; left time: 15.0970s
	iters: 300, epoch: 2 | loss: 0.7039598
	speed: 0.0034s/iter; left time: 10.7459s
	iters: 400, epoch: 2 | loss: 0.8036525
	speed: 0.0035s/iter; left time: 10.7334s
Updating learning rate to 0.00035114641265
Epoch: 2 cost time: 2.1001880168914795
Epoch: 2, Steps: 490 | Train Loss: 0.7852269 Vali Loss: 0.6245317 Best vali loss: 0.6135153
	iters: 100, epoch: 3 | loss: 0.7425709
	speed: 0.0150s/iter; left time: 42.6789s
	iters: 200, epoch: 3 | loss: 1.0718932
	speed: 0.0051s/iter; left time: 13.9474s
	iters: 300, epoch: 3 | loss: 0.5568411
	speed: 0.0052s/iter; left time: 13.7021s
	iters: 400, epoch: 3 | loss: 0.9402433
	speed: 0.0048s/iter; left time: 12.2980s
Updating learning rate to 0.000175573206325
Epoch: 3 cost time: 2.549288034439087
Epoch: 3, Steps: 490 | Train Loss: 0.8278871 Vali Loss: 0.6351151 Best vali loss: 0.6135153
	iters: 100, epoch: 4 | loss: 0.9247267
	speed: 0.0156s/iter; left time: 36.6085s
	iters: 200, epoch: 4 | loss: 0.9569409
	speed: 0.0050s/iter; left time: 11.2497s
	iters: 300, epoch: 4 | loss: 0.6239139
	speed: 0.0053s/iter; left time: 11.4136s
	iters: 400, epoch: 4 | loss: 0.5573170
	speed: 0.0048s/iter; left time: 9.8944s
Updating learning rate to 8.77866031625e-05
Epoch: 4 cost time: 2.5208022594451904
Epoch: 4, Steps: 490 | Train Loss: 0.7657246 Vali Loss: 0.6402567 Best vali loss: 0.6135153
	iters: 100, epoch: 5 | loss: 0.6678890
	speed: 0.0149s/iter; left time: 27.6965s
	iters: 200, epoch: 5 | loss: 0.6284856
	speed: 0.0052s/iter; left time: 9.1297s
	iters: 300, epoch: 5 | loss: 0.4987523
	speed: 0.0050s/iter; left time: 8.3619s
	iters: 400, epoch: 5 | loss: 0.4401662
	speed: 0.0051s/iter; left time: 7.9792s
Updating learning rate to 4.389330158125e-05
Epoch: 5 cost time: 2.5510990619659424
Epoch: 5, Steps: 490 | Train Loss: 0.5588233 Vali Loss: 0.6327825 Best vali loss: 0.6135153
	iters: 100, epoch: 6 | loss: 0.7032206
	speed: 0.0147s/iter; left time: 20.0921s
	iters: 200, epoch: 6 | loss: 0.2553985
	speed: 0.0052s/iter; left time: 6.5654s
	iters: 300, epoch: 6 | loss: 0.5150765
	speed: 0.0050s/iter; left time: 5.8564s
	iters: 400, epoch: 6 | loss: 1.4665500
	speed: 0.0052s/iter; left time: 5.5379s
Updating learning rate to 2.1946650790625e-05
Epoch: 6 cost time: 2.4975647926330566
Epoch: 6, Steps: 490 | Train Loss: 0.7350614 Vali Loss: 0.6281052 Best vali loss: 0.6135153
	iters: 100, epoch: 7 | loss: 0.9409189
	speed: 0.0149s/iter; left time: 13.1095s
	iters: 200, epoch: 7 | loss: 0.4358496
	speed: 0.0052s/iter; left time: 4.0264s
	iters: 300, epoch: 7 | loss: 0.8605657
	speed: 0.0050s/iter; left time: 3.3936s
	iters: 400, epoch: 7 | loss: 0.9413472
	speed: 0.0054s/iter; left time: 3.1201s
Updating learning rate to 1.09733253953125e-05
Epoch: 7 cost time: 2.563156843185425
Epoch: 7, Steps: 490 | Train Loss: 0.7946703 Vali Loss: 0.6359929 Best vali loss: 0.6135153
	iters: 100, epoch: 8 | loss: 0.7493922
	speed: 0.0132s/iter; left time: 5.1587s
	iters: 200, epoch: 8 | loss: 0.9963024
	speed: 0.0034s/iter; left time: 0.9941s
	iters: 300, epoch: 8 | loss: 1.0477495
	speed: 0.0047s/iter; left time: 0.8952s
	iters: 400, epoch: 8 | loss: 0.6423886
	speed: 0.0052s/iter; left time: 0.4692s
Updating learning rate to 5.48666269765625e-06
Epoch: 8 cost time: 2.1926612854003906
Epoch: 8, Steps: 490 | Train Loss: 0.8589582 Vali Loss: 0.6298258 Best vali loss: 0.6135153

best validation loss 0.6135153269006499

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096207564637, 'e_layers': 2, 'learning_rate': 0.0003903011818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1225199
	speed: 0.0109s/iter; left time: 41.7067s
	iters: 200, epoch: 1 | loss: 0.8586401
	speed: 0.0053s/iter; left time: 19.6607s
	iters: 300, epoch: 1 | loss: 0.9221448
	speed: 0.0047s/iter; left time: 17.1329s
	iters: 400, epoch: 1 | loss: 0.4856284
	speed: 0.0049s/iter; left time: 17.2868s
Updating learning rate to 0.0003903011818
Validation loss decreased (inf --> 0.6144).  Saving model state dict ...
Epoch: 1 cost time: 2.7620086669921875
Epoch: 1, Steps: 490 | Train Loss: 0.8472333 Vali Loss: 0.6143520 Best vali loss: 0.6143520
	iters: 100, epoch: 2 | loss: 0.9060518
	speed: 0.0151s/iter; left time: 50.4076s
	iters: 200, epoch: 2 | loss: 0.6541671
	speed: 0.0050s/iter; left time: 16.2064s
	iters: 300, epoch: 2 | loss: 1.6566864
	speed: 0.0054s/iter; left time: 16.9445s
	iters: 400, epoch: 2 | loss: 1.0581297
	speed: 0.0053s/iter; left time: 16.1418s
Updating learning rate to 0.0001951505909
Epoch: 2 cost time: 2.566229820251465
Epoch: 2, Steps: 490 | Train Loss: 1.0687588 Vali Loss: 0.6224058 Best vali loss: 0.6143520
	iters: 100, epoch: 3 | loss: 0.5244895
	speed: 0.0149s/iter; left time: 42.3799s
	iters: 200, epoch: 3 | loss: 0.6344822
	speed: 0.0048s/iter; left time: 13.0208s
	iters: 300, epoch: 3 | loss: 0.5238267
	speed: 0.0048s/iter; left time: 12.6049s
	iters: 400, epoch: 3 | loss: 1.3195301
	speed: 0.0047s/iter; left time: 11.9670s
Updating learning rate to 9.757529545e-05
Validation loss decreased (0.6144 --> 0.6065).  Saving model state dict ...
Epoch: 3 cost time: 2.4216105937957764
Epoch: 3, Steps: 490 | Train Loss: 0.7505821 Vali Loss: 0.6064614 Best vali loss: 0.6064614

best validation loss 0.6064613731521966

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 6.03723773e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9740961
	speed: 0.0142s/iter; left time: 12.5505s
Updating learning rate to 5.8074590508259505e-05
Validation loss decreased (inf --> 0.6991).  Saving model state dict ...
Epoch: 1 cost time: 1.360879898071289
Epoch: 1, Steps: 123 | Train Loss: 0.9740961 Vali Loss: 0.6991325 Best vali loss: 0.6991325
	iters: 100, epoch: 2 | loss: 0.9244600
	speed: 0.0134s/iter; left time: 10.1872s
Updating learning rate to 5.153104734259139e-05
Validation loss decreased (0.6991 --> 0.6833).  Saving model state dict ...
Epoch: 2 cost time: 1.0818758010864258
Epoch: 2, Steps: 123 | Train Loss: 0.9244600 Vali Loss: 0.6833243 Best vali loss: 0.6833243
	iters: 100, epoch: 3 | loss: 0.8166215
	speed: 0.0131s/iter; left time: 8.4004s
Updating learning rate to 4.1737942932602113e-05
Validation loss decreased (0.6833 --> 0.6702).  Saving model state dict ...
Epoch: 3 cost time: 1.0481207370758057
Epoch: 3, Steps: 123 | Train Loss: 0.8166215 Vali Loss: 0.6702165 Best vali loss: 0.6702165

best validation loss 0.6702164572071886

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8437455
	speed: 0.0103s/iter; left time: 39.4123s
	iters: 200, epoch: 1 | loss: 0.8308352
	speed: 0.0044s/iter; left time: 16.2112s
	iters: 300, epoch: 1 | loss: 0.7118268
	speed: 0.0038s/iter; left time: 13.7044s
	iters: 400, epoch: 1 | loss: 1.4484546
	speed: 0.0038s/iter; left time: 13.5229s
Updating learning rate to 0.00019193372885267988
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 2.4603912830352783
Epoch: 1, Steps: 490 | Train Loss: 0.9587155 Vali Loss: 0.6164607 Best vali loss: 0.6164607
	iters: 100, epoch: 2 | loss: 0.6168627
	speed: 0.0155s/iter; left time: 51.4773s
	iters: 200, epoch: 2 | loss: 0.6932133
	speed: 0.0050s/iter; left time: 16.1262s
	iters: 300, epoch: 2 | loss: 0.8161432
	speed: 0.0052s/iter; left time: 16.2381s
	iters: 400, epoch: 2 | loss: 0.9102001
	speed: 0.0051s/iter; left time: 15.5935s
Updating learning rate to 0.00017030763336576413
Validation loss decreased (0.6165 --> 0.5847).  Saving model state dict ...
Epoch: 2 cost time: 2.4989097118377686
Epoch: 2, Steps: 490 | Train Loss: 0.7591048 Vali Loss: 0.5847152 Best vali loss: 0.5847152
	iters: 100, epoch: 3 | loss: 0.9212307
	speed: 0.0156s/iter; left time: 44.3906s
	iters: 200, epoch: 3 | loss: 0.6790133
	speed: 0.0046s/iter; left time: 12.5311s
	iters: 300, epoch: 3 | loss: 0.4619488
	speed: 0.0051s/iter; left time: 13.4563s
	iters: 400, epoch: 3 | loss: 0.6773651
	speed: 0.0052s/iter; left time: 13.2500s
Updating learning rate to 0.00013794189423609193
Validation loss decreased (0.5847 --> 0.5504).  Saving model state dict ...
Epoch: 3 cost time: 2.5432896614074707
Epoch: 3, Steps: 490 | Train Loss: 0.6848895 Vali Loss: 0.5503828 Best vali loss: 0.5503828

best validation loss 0.5503828109055413

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6633658
	speed: 0.0115s/iter; left time: 26.9653s
	iters: 200, epoch: 4 | loss: 0.5667263
	speed: 0.0054s/iter; left time: 12.2004s
	iters: 300, epoch: 4 | loss: 0.6088941
	speed: 0.0050s/iter; left time: 10.8007s
	iters: 400, epoch: 4 | loss: 1.0934488
	speed: 0.0052s/iter; left time: 10.7246s
Updating learning rate to 9.976390185e-05
Epoch: 4 cost time: 2.839413642883301
Epoch: 4, Steps: 490 | Train Loss: 0.7331087 Vali Loss: 0.5567359 Best vali loss: 0.5503828
	iters: 100, epoch: 5 | loss: 0.5012863
	speed: 0.0149s/iter; left time: 27.8095s
	iters: 200, epoch: 5 | loss: 0.5023825
	speed: 0.0051s/iter; left time: 8.8993s
	iters: 300, epoch: 5 | loss: 0.6977221
	speed: 0.0051s/iter; left time: 8.4756s
	iters: 400, epoch: 5 | loss: 0.8124139
	speed: 0.0051s/iter; left time: 8.0312s
Updating learning rate to 6.158590946390807e-05
Epoch: 5 cost time: 2.4472200870513916
Epoch: 5, Steps: 490 | Train Loss: 0.6284512 Vali Loss: 0.5750431 Best vali loss: 0.5503828
	iters: 100, epoch: 6 | loss: 0.7934365
	speed: 0.0111s/iter; left time: 15.1664s
	iters: 200, epoch: 6 | loss: 0.5888352
	speed: 0.0055s/iter; left time: 6.9673s
	iters: 300, epoch: 6 | loss: 0.4048544
	speed: 0.0053s/iter; left time: 6.2371s
	iters: 400, epoch: 6 | loss: 0.5320092
	speed: 0.0053s/iter; left time: 5.6378s
Updating learning rate to 2.922017033423585e-05
Epoch: 6 cost time: 2.479746103286743
Epoch: 6, Steps: 490 | Train Loss: 0.5797839 Vali Loss: 0.5764439 Best vali loss: 0.5503828
	iters: 100, epoch: 7 | loss: 0.4490513
	speed: 0.0146s/iter; left time: 12.8646s
	iters: 200, epoch: 7 | loss: 0.8833134
	speed: 0.0050s/iter; left time: 3.8851s
	iters: 300, epoch: 7 | loss: 0.5418618
	speed: 0.0050s/iter; left time: 3.3913s
	iters: 400, epoch: 7 | loss: 0.6021130
	speed: 0.0050s/iter; left time: 2.9203s
Updating learning rate to 7.594074847320105e-06
Epoch: 7 cost time: 2.5395429134368896
Epoch: 7, Steps: 490 | Train Loss: 0.6190849 Vali Loss: 0.5890247 Best vali loss: 0.5503828
	iters: 100, epoch: 8 | loss: 1.0533047
	speed: 0.0150s/iter; left time: 5.8772s
	iters: 200, epoch: 8 | loss: 0.6366273
	speed: 0.0056s/iter; left time: 1.6189s
	iters: 300, epoch: 8 | loss: 0.4416476
	speed: 0.0055s/iter; left time: 1.0591s
	iters: 400, epoch: 8 | loss: 0.2423613
	speed: 0.0051s/iter; left time: 0.4619s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.6622607707977295
Epoch: 8, Steps: 490 | Train Loss: 0.5934852 Vali Loss: 0.5874027 Best vali loss: 0.5503828

best validation loss 0.5503828109055413

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0031170389496, 'e_layers': 1, 'learning_rate': 0.0003294206574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5469099
	speed: 0.0092s/iter; left time: 35.0299s
	iters: 200, epoch: 1 | loss: 0.9099699
	speed: 0.0036s/iter; left time: 13.5532s
	iters: 300, epoch: 1 | loss: 0.8177473
	speed: 0.0038s/iter; left time: 13.6625s
	iters: 400, epoch: 1 | loss: 0.8645907
	speed: 0.0038s/iter; left time: 13.2809s
Updating learning rate to 0.0003168828301791364
Validation loss decreased (inf --> 0.5974).  Saving model state dict ...
Epoch: 1 cost time: 2.082671642303467
Epoch: 1, Steps: 490 | Train Loss: 0.7848044 Vali Loss: 0.5973761 Best vali loss: 0.5973761
	iters: 100, epoch: 2 | loss: 1.3770523
	speed: 0.0116s/iter; left time: 38.7890s
	iters: 200, epoch: 2 | loss: 1.1107444
	speed: 0.0032s/iter; left time: 10.2564s
	iters: 300, epoch: 2 | loss: 1.0108995
	speed: 0.0025s/iter; left time: 7.9699s
	iters: 400, epoch: 2 | loss: 0.7743582
	speed: 0.0026s/iter; left time: 7.7330s
Updating learning rate to 0.0002811781190552352
Epoch: 2 cost time: 1.492302417755127
Epoch: 2, Steps: 490 | Train Loss: 1.0682636 Vali Loss: 0.6078793 Best vali loss: 0.5973761
	iters: 100, epoch: 3 | loss: 0.6884496
	speed: 0.0110s/iter; left time: 31.2330s
	iters: 200, epoch: 3 | loss: 1.3190691
	speed: 0.0042s/iter; left time: 11.5179s
	iters: 300, epoch: 3 | loss: 1.2056091
	speed: 0.0044s/iter; left time: 11.6949s
	iters: 400, epoch: 3 | loss: 0.8363214
	speed: 0.0031s/iter; left time: 7.8688s
Updating learning rate to 0.0002277422426328982
Epoch: 3 cost time: 1.835092306137085
Epoch: 3, Steps: 490 | Train Loss: 1.0123623 Vali Loss: 0.6257026 Best vali loss: 0.5973761
	iters: 100, epoch: 4 | loss: 0.8796332
	speed: 0.0093s/iter; left time: 21.9593s
	iters: 200, epoch: 4 | loss: 0.6007509
	speed: 0.0037s/iter; left time: 8.4245s
	iters: 300, epoch: 4 | loss: 0.4581635
	speed: 0.0041s/iter; left time: 8.7443s
	iters: 400, epoch: 4 | loss: 0.8386794
	speed: 0.0037s/iter; left time: 7.4872s
Updating learning rate to 0.0001647103287
Epoch: 4 cost time: 1.9252746105194092
Epoch: 4, Steps: 490 | Train Loss: 0.6943068 Vali Loss: 0.6251293 Best vali loss: 0.5973761
	iters: 100, epoch: 5 | loss: 0.5029296
	speed: 0.0119s/iter; left time: 22.2310s
	iters: 200, epoch: 5 | loss: 0.6406032
	speed: 0.0037s/iter; left time: 6.5152s
	iters: 300, epoch: 5 | loss: 1.2158636
	speed: 0.0039s/iter; left time: 6.4003s
	iters: 400, epoch: 5 | loss: 0.8076317
	speed: 0.0036s/iter; left time: 5.5571s
Updating learning rate to 0.00010167841476710186
Epoch: 5 cost time: 1.850719690322876
Epoch: 5, Steps: 490 | Train Loss: 0.7917570 Vali Loss: 0.6268615 Best vali loss: 0.5973761
	iters: 100, epoch: 6 | loss: 0.7303272
	speed: 0.0093s/iter; left time: 12.7219s
	iters: 200, epoch: 6 | loss: 0.8295370
	speed: 0.0029s/iter; left time: 3.6899s
	iters: 300, epoch: 6 | loss: 0.5334867
	speed: 0.0039s/iter; left time: 4.5511s
	iters: 400, epoch: 6 | loss: 0.6071565
	speed: 0.0037s/iter; left time: 3.9911s
Updating learning rate to 4.824253834476479e-05
Epoch: 6 cost time: 1.7241251468658447
Epoch: 6, Steps: 490 | Train Loss: 0.6751268 Vali Loss: 0.6479876 Best vali loss: 0.5973761
	iters: 100, epoch: 7 | loss: 0.7562612
	speed: 0.0117s/iter; left time: 10.3195s
	iters: 200, epoch: 7 | loss: 0.6062111
	speed: 0.0038s/iter; left time: 2.9708s
	iters: 300, epoch: 7 | loss: 0.3668269
	speed: 0.0039s/iter; left time: 2.6227s
	iters: 400, epoch: 7 | loss: 0.6338944
	speed: 0.0042s/iter; left time: 2.4160s
Updating learning rate to 1.2537827220863625e-05
Epoch: 7 cost time: 1.9195029735565186
Epoch: 7, Steps: 490 | Train Loss: 0.5907984 Vali Loss: 0.6445921 Best vali loss: 0.5973761
	iters: 100, epoch: 8 | loss: 1.2211027
	speed: 0.0120s/iter; left time: 4.7101s
	iters: 200, epoch: 8 | loss: 0.6514100
	speed: 0.0037s/iter; left time: 1.0785s
	iters: 300, epoch: 8 | loss: 0.8313736
	speed: 0.0038s/iter; left time: 0.7226s
	iters: 400, epoch: 8 | loss: 0.4699670
	speed: 0.0035s/iter; left time: 0.3213s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8734688758850098
Epoch: 8, Steps: 490 | Train Loss: 0.7934634 Vali Loss: 0.6451093 Best vali loss: 0.5973761

best validation loss 0.5973760845318044

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018706532697, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9126438
	speed: 0.0096s/iter; left time: 17.8954s
	iters: 200, epoch: 1 | loss: 1.0371594
	speed: 0.0059s/iter; left time: 10.3925s
Updating learning rate to 0.0002779769506
Validation loss decreased (inf --> 0.6121).  Saving model state dict ...
Epoch: 1 cost time: 1.5474495887756348
Epoch: 1, Steps: 245 | Train Loss: 0.9749016 Vali Loss: 0.6121184 Best vali loss: 0.6121184
	iters: 100, epoch: 2 | loss: 0.7804607
	speed: 0.0122s/iter; left time: 19.6506s
	iters: 200, epoch: 2 | loss: 0.9159453
	speed: 0.0057s/iter; left time: 8.6676s
Updating learning rate to 0.0001389884753
Epoch: 2 cost time: 1.4778470993041992
Epoch: 2, Steps: 245 | Train Loss: 0.8482030 Vali Loss: 0.6122919 Best vali loss: 0.6121184
	iters: 100, epoch: 3 | loss: 0.9208215
	speed: 0.0126s/iter; left time: 17.2223s
	iters: 200, epoch: 3 | loss: 0.6436314
	speed: 0.0053s/iter; left time: 6.6916s
Updating learning rate to 6.949423765e-05
Validation loss decreased (0.6121 --> 0.5958).  Saving model state dict ...
Epoch: 3 cost time: 1.434342384338379
Epoch: 3, Steps: 245 | Train Loss: 0.7822265 Vali Loss: 0.5957551 Best vali loss: 0.5957551
	iters: 100, epoch: 4 | loss: 0.9071091
	speed: 0.0124s/iter; left time: 13.9676s
	iters: 200, epoch: 4 | loss: 0.8620338
	speed: 0.0058s/iter; left time: 5.9435s
Updating learning rate to 3.4747118825e-05
Epoch: 4 cost time: 1.4995667934417725
Epoch: 4, Steps: 245 | Train Loss: 0.8845715 Vali Loss: 0.6088952 Best vali loss: 0.5957551
	iters: 100, epoch: 5 | loss: 1.0014006
	speed: 0.0125s/iter; left time: 10.9786s
	iters: 200, epoch: 5 | loss: 0.7303324
	speed: 0.0056s/iter; left time: 4.3796s
Updating learning rate to 1.73735594125e-05
Epoch: 5 cost time: 1.486748218536377
Epoch: 5, Steps: 245 | Train Loss: 0.8658665 Vali Loss: 0.6090475 Best vali loss: 0.5957551
	iters: 100, epoch: 6 | loss: 0.5059046
	speed: 0.0124s/iter; left time: 7.8823s
	iters: 200, epoch: 6 | loss: 0.5740221
	speed: 0.0060s/iter; left time: 3.2402s
Updating learning rate to 8.68677970625e-06
Epoch: 6 cost time: 1.487830400466919
Epoch: 6, Steps: 245 | Train Loss: 0.5399634 Vali Loss: 0.6082638 Best vali loss: 0.5957551
	iters: 100, epoch: 7 | loss: 0.6569153
	speed: 0.0122s/iter; left time: 4.7645s
	iters: 200, epoch: 7 | loss: 0.7600783
	speed: 0.0058s/iter; left time: 1.6823s
Updating learning rate to 4.343389853125e-06
Epoch: 7 cost time: 1.4893033504486084
Epoch: 7, Steps: 245 | Train Loss: 0.7084968 Vali Loss: 0.6015469 Best vali loss: 0.5957551
	iters: 100, epoch: 8 | loss: 0.6284905
	speed: 0.0121s/iter; left time: 1.7718s
	iters: 200, epoch: 8 | loss: 0.5020282
	speed: 0.0058s/iter; left time: 0.2675s
Updating learning rate to 2.1716949265625e-06
Epoch: 8 cost time: 1.478942632675171
Epoch: 8, Steps: 245 | Train Loss: 0.5652593 Vali Loss: 0.6022361 Best vali loss: 0.5957551

best validation loss 0.5957550935754066

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.003868950085, 'e_layers': 4, 'learning_rate': 0.0048421309082, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5212435
	speed: 0.0127s/iter; left time: 48.4929s
	iters: 200, epoch: 1 | loss: 0.9298404
	speed: 0.0050s/iter; left time: 18.6752s
	iters: 300, epoch: 1 | loss: 0.5530213
	speed: 0.0063s/iter; left time: 22.6376s
	iters: 400, epoch: 1 | loss: 0.9930121
	speed: 0.0072s/iter; left time: 25.2189s
Updating learning rate to 0.0048421309082
Validation loss decreased (inf --> 0.6550).  Saving model state dict ...
Epoch: 1 cost time: 3.4794301986694336
Epoch: 1, Steps: 490 | Train Loss: 0.7492793 Vali Loss: 0.6550082 Best vali loss: 0.6550082
	iters: 100, epoch: 2 | loss: 1.2627184
	speed: 0.0192s/iter; left time: 63.9971s
	iters: 200, epoch: 2 | loss: 1.6656048
	speed: 0.0070s/iter; left time: 22.6353s
	iters: 300, epoch: 2 | loss: 1.0857968
	speed: 0.0074s/iter; left time: 23.1756s
	iters: 400, epoch: 2 | loss: 0.8739920
	speed: 0.0075s/iter; left time: 22.5972s
Updating learning rate to 0.0024210654541
Validation loss decreased (0.6550 --> 0.6455).  Saving model state dict ...
Epoch: 2 cost time: 3.569316864013672
Epoch: 2, Steps: 490 | Train Loss: 1.2220280 Vali Loss: 0.6455454 Best vali loss: 0.6455454
	iters: 100, epoch: 3 | loss: 0.7509384
	speed: 0.0206s/iter; left time: 58.5954s
	iters: 200, epoch: 3 | loss: 0.6092481
	speed: 0.0067s/iter; left time: 18.2370s
	iters: 300, epoch: 3 | loss: 0.8436287
	speed: 0.0073s/iter; left time: 19.2069s
	iters: 400, epoch: 3 | loss: 0.5259751
	speed: 0.0067s/iter; left time: 16.9267s
Updating learning rate to 0.00121053272705
Validation loss decreased (0.6455 --> 0.6415).  Saving model state dict ...
Epoch: 3 cost time: 3.5485363006591797
Epoch: 3, Steps: 490 | Train Loss: 0.6824476 Vali Loss: 0.6415198 Best vali loss: 0.6415198

best validation loss 0.6415198296653292

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 1, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.6790).  Saving model state dict ...
Epoch: 1 cost time: 0.7464368343353271
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6790325 Best vali loss: 0.6790325
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.6790 --> 0.6496).  Saving model state dict ...
Epoch: 2 cost time: 0.5066120624542236
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6496325 Best vali loss: 0.6496325
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.6496 --> 0.6393).  Saving model state dict ...
Epoch: 3 cost time: 0.5016705989837646
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6392830 Best vali loss: 0.6392830

best validation loss 0.6392830122350157

[INFO][smbo.py:320] Finished 50 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8196780
	speed: 0.0148s/iter; left time: 13.0683s
Updating learning rate to 0.000280255645
Validation loss decreased (inf --> 0.6453).  Saving model state dict ...
Epoch: 1 cost time: 1.370084524154663
Epoch: 1, Steps: 123 | Train Loss: 0.8196780 Vali Loss: 0.6452655 Best vali loss: 0.6452655
	iters: 100, epoch: 2 | loss: 0.6158441
	speed: 0.0125s/iter; left time: 9.5486s
Updating learning rate to 0.0001401278225
Validation loss decreased (0.6453 --> 0.6303).  Saving model state dict ...
Epoch: 2 cost time: 1.0400173664093018
Epoch: 2, Steps: 123 | Train Loss: 0.6158441 Vali Loss: 0.6302534 Best vali loss: 0.6302534
	iters: 100, epoch: 3 | loss: 0.9642088
	speed: 0.0129s/iter; left time: 8.2455s
Updating learning rate to 7.006391125e-05
Validation loss decreased (0.6303 --> 0.6206).  Saving model state dict ...
Epoch: 3 cost time: 1.045403242111206
Epoch: 3, Steps: 123 | Train Loss: 0.9642088 Vali Loss: 0.6205734 Best vali loss: 0.6205734

best validation loss 0.6205734186070984

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7719416
	speed: 0.0139s/iter; left time: 7.1542s
Updating learning rate to 3.5031955625e-05
Validation loss decreased (0.6206 --> 0.6133).  Saving model state dict ...
Epoch: 4 cost time: 1.2841827869415283
Epoch: 4, Steps: 123 | Train Loss: 0.7719416 Vali Loss: 0.6133191 Best vali loss: 0.6133191
	iters: 100, epoch: 5 | loss: 0.6048579
	speed: 0.0126s/iter; left time: 4.9625s
Updating learning rate to 1.75159778125e-05
Validation loss decreased (0.6133 --> 0.6130).  Saving model state dict ...
Epoch: 5 cost time: 1.022564172744751
Epoch: 5, Steps: 123 | Train Loss: 0.6048579 Vali Loss: 0.6130250 Best vali loss: 0.6130250
	iters: 100, epoch: 6 | loss: 0.9492203
	speed: 0.0125s/iter; left time: 3.3665s
Updating learning rate to 8.75798890625e-06
Validation loss decreased (0.6130 --> 0.6128).  Saving model state dict ...
Epoch: 6 cost time: 1.0123298168182373
Epoch: 6, Steps: 123 | Train Loss: 0.9492203 Vali Loss: 0.6127587 Best vali loss: 0.6127587
	iters: 100, epoch: 7 | loss: 0.7582101
	speed: 0.0133s/iter; left time: 1.9565s
Updating learning rate to 4.378994453125e-06
Validation loss decreased (0.6128 --> 0.6125).  Saving model state dict ...
Epoch: 7 cost time: 1.0575506687164307
Epoch: 7, Steps: 123 | Train Loss: 0.7582101 Vali Loss: 0.6124764 Best vali loss: 0.6124764
	iters: 100, epoch: 8 | loss: 0.6598144
	speed: 0.0105s/iter; left time: 0.2511s
Updating learning rate to 2.1894972265625e-06
Validation loss decreased (0.6125 --> 0.6122).  Saving model state dict ...
Epoch: 8 cost time: 0.9120080471038818
Epoch: 8, Steps: 123 | Train Loss: 0.6598144 Vali Loss: 0.6121887 Best vali loss: 0.6121887

best validation loss 0.6121887004193417

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001339657668, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8297476
	speed: 0.0126s/iter; left time: 23.4268s
	iters: 200, epoch: 1 | loss: 0.7578320
	speed: 0.0048s/iter; left time: 8.4209s
Updating learning rate to 0.0001339657668
Validation loss decreased (inf --> 0.5926).  Saving model state dict ...
Epoch: 1 cost time: 1.6662132740020752
Epoch: 1, Steps: 245 | Train Loss: 0.7937898 Vali Loss: 0.5926248 Best vali loss: 0.5926248
	iters: 100, epoch: 2 | loss: 0.8706770
	speed: 0.0119s/iter; left time: 19.1779s
	iters: 200, epoch: 2 | loss: 0.4427856
	speed: 0.0069s/iter; left time: 10.4208s
Updating learning rate to 6.69828834e-05
Validation loss decreased (0.5926 --> 0.5797).  Saving model state dict ...
Epoch: 2 cost time: 1.7974424362182617
Epoch: 2, Steps: 245 | Train Loss: 0.6567313 Vali Loss: 0.5797294 Best vali loss: 0.5797294
	iters: 100, epoch: 3 | loss: 0.9963231
	speed: 0.0139s/iter; left time: 19.1064s
	iters: 200, epoch: 3 | loss: 0.7942613
	speed: 0.0071s/iter; left time: 9.0027s
Updating learning rate to 3.34914417e-05
Epoch: 3 cost time: 1.7774124145507812
Epoch: 3, Steps: 245 | Train Loss: 0.8952922 Vali Loss: 0.6022060 Best vali loss: 0.5797294
	iters: 100, epoch: 4 | loss: 1.1962453
	speed: 0.0141s/iter; left time: 15.8788s
	iters: 200, epoch: 4 | loss: 0.8589458
	speed: 0.0067s/iter; left time: 6.8867s
Updating learning rate to 1.674572085e-05
Epoch: 4 cost time: 1.7855854034423828
Epoch: 4, Steps: 245 | Train Loss: 1.0275956 Vali Loss: 0.5966720 Best vali loss: 0.5797294
	iters: 100, epoch: 5 | loss: 0.7746086
	speed: 0.0144s/iter; left time: 12.6926s
	iters: 200, epoch: 5 | loss: 0.7275243
	speed: 0.0045s/iter; left time: 3.5478s
Updating learning rate to 8.372860425e-06
Epoch: 5 cost time: 1.4175317287445068
Epoch: 5, Steps: 245 | Train Loss: 0.7510664 Vali Loss: 0.5828373 Best vali loss: 0.5797294
	iters: 100, epoch: 6 | loss: 0.7407755
	speed: 0.0128s/iter; left time: 8.1332s
	iters: 200, epoch: 6 | loss: 0.8317480
	speed: 0.0072s/iter; left time: 3.8558s
Updating learning rate to 4.1864302125e-06
Epoch: 6 cost time: 1.802900791168213
Epoch: 6, Steps: 245 | Train Loss: 0.7862618 Vali Loss: 0.5799923 Best vali loss: 0.5797294
	iters: 100, epoch: 7 | loss: 1.0036212
	speed: 0.0138s/iter; left time: 5.3834s
	iters: 200, epoch: 7 | loss: 0.8864225
	speed: 0.0067s/iter; left time: 1.9435s
Updating learning rate to 2.09321510625e-06
Epoch: 7 cost time: 1.711937665939331
Epoch: 7, Steps: 245 | Train Loss: 0.9450219 Vali Loss: 0.5806356 Best vali loss: 0.5797294
	iters: 100, epoch: 8 | loss: 0.6645079
	speed: 0.0135s/iter; left time: 1.9756s
	iters: 200, epoch: 8 | loss: 0.7535369
	speed: 0.0067s/iter; left time: 0.3091s
Updating learning rate to 1.046607553125e-06
Epoch: 8 cost time: 1.685556173324585
Epoch: 8, Steps: 245 | Train Loss: 0.7090224 Vali Loss: 0.5811624 Best vali loss: 0.5797294

best validation loss 0.579729391959242

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9302072
	speed: 0.0103s/iter; left time: 19.1239s
	iters: 200, epoch: 1 | loss: 0.8174270
	speed: 0.0048s/iter; left time: 8.4221s
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.6635).  Saving model state dict ...
Epoch: 1 cost time: 1.4763214588165283
Epoch: 1, Steps: 245 | Train Loss: 0.8738171 Vali Loss: 0.6635078 Best vali loss: 0.6635078
	iters: 100, epoch: 2 | loss: 0.6303960
	speed: 0.0103s/iter; left time: 16.6452s
	iters: 200, epoch: 2 | loss: 0.6980568
	speed: 0.0047s/iter; left time: 7.1632s
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.6635 --> 0.6372).  Saving model state dict ...
Epoch: 2 cost time: 1.159430742263794
Epoch: 2, Steps: 245 | Train Loss: 0.6642264 Vali Loss: 0.6371735 Best vali loss: 0.6371735
	iters: 100, epoch: 3 | loss: 0.8072785
	speed: 0.0106s/iter; left time: 14.4677s
	iters: 200, epoch: 3 | loss: 0.7242540
	speed: 0.0041s/iter; left time: 5.2155s
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.6372 --> 0.6286).  Saving model state dict ...
Epoch: 3 cost time: 1.1649525165557861
Epoch: 3, Steps: 245 | Train Loss: 0.7657663 Vali Loss: 0.6286355 Best vali loss: 0.6286355
	iters: 100, epoch: 4 | loss: 0.8334217
	speed: 0.0077s/iter; left time: 8.6593s
	iters: 200, epoch: 4 | loss: 0.7610663
	speed: 0.0031s/iter; left time: 3.1936s
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.6286 --> 0.6249).  Saving model state dict ...
Epoch: 4 cost time: 0.8268070220947266
Epoch: 4, Steps: 245 | Train Loss: 0.7972440 Vali Loss: 0.6249389 Best vali loss: 0.6249389
	iters: 100, epoch: 5 | loss: 0.7762636
	speed: 0.0080s/iter; left time: 7.0604s
	iters: 200, epoch: 5 | loss: 1.1175544
	speed: 0.0035s/iter; left time: 2.7666s
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.6249 --> 0.6232).  Saving model state dict ...
Epoch: 5 cost time: 0.9340426921844482
Epoch: 5, Steps: 245 | Train Loss: 0.9469090 Vali Loss: 0.6231789 Best vali loss: 0.6231789
	iters: 100, epoch: 6 | loss: 0.5667970
	speed: 0.0082s/iter; left time: 5.2154s
	iters: 200, epoch: 6 | loss: 0.9434092
	speed: 0.0040s/iter; left time: 2.1379s
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.6232 --> 0.6224).  Saving model state dict ...
Epoch: 6 cost time: 1.0088918209075928
Epoch: 6, Steps: 245 | Train Loss: 0.7551031 Vali Loss: 0.6223545 Best vali loss: 0.6223545
	iters: 100, epoch: 7 | loss: 0.5875416
	speed: 0.0082s/iter; left time: 3.2049s
	iters: 200, epoch: 7 | loss: 0.9025227
	speed: 0.0039s/iter; left time: 1.1451s
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.6224 --> 0.6220).  Saving model state dict ...
Epoch: 7 cost time: 1.0029633045196533
Epoch: 7, Steps: 245 | Train Loss: 0.7450321 Vali Loss: 0.6219729 Best vali loss: 0.6219729
	iters: 100, epoch: 8 | loss: 0.8374913
	speed: 0.0076s/iter; left time: 1.1082s
	iters: 200, epoch: 8 | loss: 1.4370624
	speed: 0.0034s/iter; left time: 0.1551s
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.6220 --> 0.6218).  Saving model state dict ...
Epoch: 8 cost time: 0.8514702320098877
Epoch: 8, Steps: 245 | Train Loss: 1.1372768 Vali Loss: 0.6217915 Best vali loss: 0.6217915

best validation loss 0.6217914584443173

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 4, 'learning_rate': 0.0044405212972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4719185
	speed: 0.0126s/iter; left time: 48.0259s
	iters: 200, epoch: 1 | loss: 1.0632576
	speed: 0.0069s/iter; left time: 25.7582s
	iters: 300, epoch: 1 | loss: 1.1117439
	speed: 0.0067s/iter; left time: 24.3243s
	iters: 400, epoch: 1 | loss: 0.5448257
	speed: 0.0069s/iter; left time: 24.1688s
Updating learning rate to 0.0044405212972
Validation loss decreased (inf --> 0.6278).  Saving model state dict ...
Epoch: 1 cost time: 3.6709775924682617
Epoch: 1, Steps: 490 | Train Loss: 0.7979364 Vali Loss: 0.6277631 Best vali loss: 0.6277631
	iters: 100, epoch: 2 | loss: 1.0840703
	speed: 0.0183s/iter; left time: 60.7942s
	iters: 200, epoch: 2 | loss: 0.9342816
	speed: 0.0063s/iter; left time: 20.2407s
	iters: 300, epoch: 2 | loss: 1.3005854
	speed: 0.0072s/iter; left time: 22.6719s
	iters: 400, epoch: 2 | loss: 0.9999411
	speed: 0.0073s/iter; left time: 22.1720s
Updating learning rate to 0.0022202606486
Epoch: 2 cost time: 3.4157392978668213
Epoch: 2, Steps: 490 | Train Loss: 1.0797196 Vali Loss: 0.6632441 Best vali loss: 0.6277631
	iters: 100, epoch: 3 | loss: 1.0831825
	speed: 0.0194s/iter; left time: 55.0663s
	iters: 200, epoch: 3 | loss: 1.1171596
	speed: 0.0072s/iter; left time: 19.6148s
	iters: 300, epoch: 3 | loss: 0.6939582
	speed: 0.0072s/iter; left time: 18.9857s
	iters: 400, epoch: 3 | loss: 0.6769297
	speed: 0.0066s/iter; left time: 16.8049s
Updating learning rate to 0.0011101303243
Epoch: 3 cost time: 3.395719528198242
Epoch: 3, Steps: 490 | Train Loss: 0.8928075 Vali Loss: 0.6529308 Best vali loss: 0.6277631

best validation loss 0.6277631112184309

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6727017
	speed: 0.0096s/iter; left time: 8.5142s
Updating learning rate to 0.0011205641286
Validation loss decreased (inf --> 0.6167).  Saving model state dict ...
Epoch: 1 cost time: 0.7907195091247559
Epoch: 1, Steps: 123 | Train Loss: 0.6727017 Vali Loss: 0.6167024 Best vali loss: 0.6167024
	iters: 100, epoch: 2 | loss: 0.8896103
	speed: 0.0072s/iter; left time: 5.4523s
Updating learning rate to 0.0005602820643
Validation loss decreased (0.6167 --> 0.6010).  Saving model state dict ...
Epoch: 2 cost time: 0.5478823184967041
Epoch: 2, Steps: 123 | Train Loss: 0.8896103 Vali Loss: 0.6010150 Best vali loss: 0.6010150
	iters: 100, epoch: 3 | loss: 0.7186646
	speed: 0.0071s/iter; left time: 4.5671s
Updating learning rate to 0.00028014103215
Epoch: 3 cost time: 0.5552914142608643
Epoch: 3, Steps: 123 | Train Loss: 0.7186646 Vali Loss: 0.6131354 Best vali loss: 0.6010150

best validation loss 0.6010149901578515

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7700563
	speed: 0.0093s/iter; left time: 35.4083s
	iters: 200, epoch: 1 | loss: 0.6977828
	speed: 0.0035s/iter; left time: 13.1370s
	iters: 300, epoch: 1 | loss: 2.0160580
	speed: 0.0036s/iter; left time: 13.0535s
	iters: 400, epoch: 1 | loss: 1.2605433
	speed: 0.0034s/iter; left time: 11.8211s
Updating learning rate to 0.0012523603238
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 2.0388522148132324
Epoch: 1, Steps: 490 | Train Loss: 1.1861101 Vali Loss: 0.6165462 Best vali loss: 0.6165462
	iters: 100, epoch: 2 | loss: 0.3904528
	speed: 0.0106s/iter; left time: 35.4257s
	iters: 200, epoch: 2 | loss: 0.4396462
	speed: 0.0038s/iter; left time: 12.1784s
	iters: 300, epoch: 2 | loss: 0.7252049
	speed: 0.0036s/iter; left time: 11.3414s
	iters: 400, epoch: 2 | loss: 0.7680517
	speed: 0.0035s/iter; left time: 10.7052s
Updating learning rate to 0.0006261801619
Validation loss decreased (0.6165 --> 0.6080).  Saving model state dict ...
Epoch: 2 cost time: 1.7711689472198486
Epoch: 2, Steps: 490 | Train Loss: 0.5808389 Vali Loss: 0.6080412 Best vali loss: 0.6080412
	iters: 100, epoch: 3 | loss: 0.9479238
	speed: 0.0094s/iter; left time: 26.7836s
	iters: 200, epoch: 3 | loss: 0.8577951
	speed: 0.0033s/iter; left time: 8.9537s
	iters: 300, epoch: 3 | loss: 0.3161325
	speed: 0.0033s/iter; left time: 8.6026s
	iters: 400, epoch: 3 | loss: 0.3846283
	speed: 0.0033s/iter; left time: 8.3141s
Updating learning rate to 0.00031309008095
Epoch: 3 cost time: 1.6141023635864258
Epoch: 3, Steps: 490 | Train Loss: 0.6266199 Vali Loss: 0.6185992 Best vali loss: 0.6080412

best validation loss 0.6080412366968346

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6478126
	speed: 0.0100s/iter; left time: 5.1569s
Updating learning rate to 0.000140070516075
Epoch: 4 cost time: 0.8059267997741699
Epoch: 4, Steps: 123 | Train Loss: 0.6478126 Vali Loss: 0.6092081 Best vali loss: 0.6010150
	iters: 100, epoch: 5 | loss: 0.8572293
	speed: 0.0071s/iter; left time: 2.7858s
Updating learning rate to 7.00352580375e-05
Epoch: 5 cost time: 0.5450844764709473
Epoch: 5, Steps: 123 | Train Loss: 0.8572293 Vali Loss: 0.6122516 Best vali loss: 0.6010150
	iters: 100, epoch: 6 | loss: 0.7045121
	speed: 0.0068s/iter; left time: 1.8459s
Updating learning rate to 3.501762901875e-05
Epoch: 6 cost time: 0.5388309955596924
Epoch: 6, Steps: 123 | Train Loss: 0.7045121 Vali Loss: 0.6102284 Best vali loss: 0.6010150
	iters: 100, epoch: 7 | loss: 0.6454180
	speed: 0.0073s/iter; left time: 1.0740s
Updating learning rate to 1.7508814509375e-05
Epoch: 7 cost time: 0.5695831775665283
Epoch: 7, Steps: 123 | Train Loss: 0.6454180 Vali Loss: 0.6101027 Best vali loss: 0.6010150
	iters: 100, epoch: 8 | loss: 0.7262754
	speed: 0.0071s/iter; left time: 0.1697s
Updating learning rate to 8.7544072546875e-06
Epoch: 8 cost time: 0.5494351387023926
Epoch: 8, Steps: 123 | Train Loss: 0.7262754 Vali Loss: 0.6088441 Best vali loss: 0.6010150

best validation loss 0.6010149901578515

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0054864235978, 'e_layers': 2, 'learning_rate': 0.0004151106276, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4009410
	speed: 0.0099s/iter; left time: 76.8896s
	iters: 200, epoch: 1 | loss: 0.5259801
	speed: 0.0045s/iter; left time: 34.0788s
	iters: 300, epoch: 1 | loss: 0.9413303
	speed: 0.0045s/iter; left time: 33.7134s
	iters: 400, epoch: 1 | loss: 1.3539673
	speed: 0.0045s/iter; left time: 33.4312s
	iters: 500, epoch: 1 | loss: 1.3641868
	speed: 0.0041s/iter; left time: 29.7244s
	iters: 600, epoch: 1 | loss: 0.4325314
	speed: 0.0040s/iter; left time: 28.9066s
	iters: 700, epoch: 1 | loss: 0.8631662
	speed: 0.0042s/iter; left time: 29.6768s
	iters: 800, epoch: 1 | loss: 1.2109801
	speed: 0.0045s/iter; left time: 31.2987s
	iters: 900, epoch: 1 | loss: 0.8118829
	speed: 0.0046s/iter; left time: 31.6268s
Updating learning rate to 0.0004151106276
Validation loss decreased (inf --> 0.6481).  Saving model state dict ...
Epoch: 1 cost time: 4.566279649734497
Epoch: 1, Steps: 979 | Train Loss: 0.9894407 Vali Loss: 0.6480561 Best vali loss: 0.6480561
	iters: 100, epoch: 2 | loss: 0.5342993
	speed: 0.0152s/iter; left time: 102.3376s
	iters: 200, epoch: 2 | loss: 1.2938075
	speed: 0.0045s/iter; left time: 30.1860s
	iters: 300, epoch: 2 | loss: 1.0198264
	speed: 0.0046s/iter; left time: 30.1648s
	iters: 400, epoch: 2 | loss: 0.7846322
	speed: 0.0046s/iter; left time: 29.7867s
	iters: 500, epoch: 2 | loss: 0.5177442
	speed: 0.0046s/iter; left time: 29.0496s
	iters: 600, epoch: 2 | loss: 0.4877748
	speed: 0.0041s/iter; left time: 25.8192s
	iters: 700, epoch: 2 | loss: 0.5474561
	speed: 0.0040s/iter; left time: 24.6162s
	iters: 800, epoch: 2 | loss: 0.6380721
	speed: 0.0037s/iter; left time: 22.5617s
	iters: 900, epoch: 2 | loss: 0.7716473
	speed: 0.0036s/iter; left time: 21.7008s
Updating learning rate to 0.0002075553138
Validation loss decreased (0.6481 --> 0.6205).  Saving model state dict ...
Epoch: 2 cost time: 4.164028882980347
Epoch: 2, Steps: 979 | Train Loss: 0.7328067 Vali Loss: 0.6204591 Best vali loss: 0.6204591
	iters: 100, epoch: 3 | loss: 0.3738311
	speed: 0.0135s/iter; left time: 77.7711s
	iters: 200, epoch: 3 | loss: 1.2276367
	speed: 0.0041s/iter; left time: 23.4782s
	iters: 300, epoch: 3 | loss: 1.6671251
	speed: 0.0047s/iter; left time: 26.3021s
	iters: 400, epoch: 3 | loss: 0.6470243
	speed: 0.0045s/iter; left time: 24.5176s
	iters: 500, epoch: 3 | loss: 0.7336237
	speed: 0.0041s/iter; left time: 21.9528s
	iters: 600, epoch: 3 | loss: 1.4432522
	speed: 0.0045s/iter; left time: 23.9117s
	iters: 700, epoch: 3 | loss: 0.4203655
	speed: 0.0046s/iter; left time: 23.9283s
	iters: 800, epoch: 3 | loss: 0.6061695
	speed: 0.0044s/iter; left time: 22.2957s
	iters: 900, epoch: 3 | loss: 0.4650858
	speed: 0.0041s/iter; left time: 20.2627s
Updating learning rate to 0.0001037776569
Validation loss decreased (0.6205 --> 0.6022).  Saving model state dict ...
Epoch: 3 cost time: 4.270758152008057
Epoch: 3, Steps: 979 | Train Loss: 0.8426793 Vali Loss: 0.6022229 Best vali loss: 0.6022229
	iters: 100, epoch: 4 | loss: 1.2519296
	speed: 0.0147s/iter; left time: 70.6419s
	iters: 200, epoch: 4 | loss: 0.6150422
	speed: 0.0042s/iter; left time: 19.8251s
	iters: 300, epoch: 4 | loss: 0.4943559
	speed: 0.0042s/iter; left time: 19.4028s
	iters: 400, epoch: 4 | loss: 0.8571324
	speed: 0.0044s/iter; left time: 19.5879s
	iters: 500, epoch: 4 | loss: 0.8483106
	speed: 0.0045s/iter; left time: 19.8495s
	iters: 600, epoch: 4 | loss: 0.4570717
	speed: 0.0044s/iter; left time: 19.0366s
	iters: 700, epoch: 4 | loss: 1.0869044
	speed: 0.0045s/iter; left time: 18.9201s
	iters: 800, epoch: 4 | loss: 0.6998726
	speed: 0.0045s/iter; left time: 18.3618s
	iters: 900, epoch: 4 | loss: 0.7917461
	speed: 0.0045s/iter; left time: 17.9968s
Updating learning rate to 5.188882845e-05
Epoch: 4 cost time: 4.338522911071777
Epoch: 4, Steps: 979 | Train Loss: 0.7891517 Vali Loss: 0.6376779 Best vali loss: 0.6022229
	iters: 100, epoch: 5 | loss: 0.5711576
	speed: 0.0144s/iter; left time: 54.8422s
	iters: 200, epoch: 5 | loss: 0.5191041
	speed: 0.0044s/iter; left time: 16.2384s
	iters: 300, epoch: 5 | loss: 0.4221721
	speed: 0.0045s/iter; left time: 16.1005s
	iters: 400, epoch: 5 | loss: 0.4957927
	speed: 0.0046s/iter; left time: 16.0760s
	iters: 500, epoch: 5 | loss: 0.5784106
	speed: 0.0042s/iter; left time: 14.3429s
	iters: 600, epoch: 5 | loss: 1.0657340
	speed: 0.0042s/iter; left time: 13.9355s
	iters: 700, epoch: 5 | loss: 0.3022627
	speed: 0.0043s/iter; left time: 13.7149s
	iters: 800, epoch: 5 | loss: 0.6583661
	speed: 0.0040s/iter; left time: 12.5268s
	iters: 900, epoch: 5 | loss: 0.5198566
	speed: 0.0042s/iter; left time: 12.6228s
Updating learning rate to 2.5944414225e-05
Epoch: 5 cost time: 4.262071847915649
Epoch: 5, Steps: 979 | Train Loss: 0.5703174 Vali Loss: 0.6485363 Best vali loss: 0.6022229
	iters: 100, epoch: 6 | loss: 0.4212973
	speed: 0.0129s/iter; left time: 36.5764s
	iters: 200, epoch: 6 | loss: 0.2790726
	speed: 0.0038s/iter; left time: 10.4798s
	iters: 300, epoch: 6 | loss: 0.5820783
	speed: 0.0040s/iter; left time: 10.5584s
	iters: 400, epoch: 6 | loss: 1.3872631
	speed: 0.0041s/iter; left time: 10.3069s
	iters: 500, epoch: 6 | loss: 0.4891180
	speed: 0.0040s/iter; left time: 9.8437s
	iters: 600, epoch: 6 | loss: 0.8932300
	speed: 0.0041s/iter; left time: 9.6350s
	iters: 700, epoch: 6 | loss: 1.2755960
	speed: 0.0040s/iter; left time: 8.9512s
	iters: 800, epoch: 6 | loss: 0.5945895
	speed: 0.0041s/iter; left time: 8.8339s
	iters: 900, epoch: 6 | loss: 0.6442001
	speed: 0.0040s/iter; left time: 8.2175s
Updating learning rate to 1.29722071125e-05
Epoch: 6 cost time: 3.937858819961548
Epoch: 6, Steps: 979 | Train Loss: 0.7296050 Vali Loss: 0.6588396 Best vali loss: 0.6022229
	iters: 100, epoch: 7 | loss: 0.3877834
	speed: 0.0142s/iter; left time: 26.3676s
	iters: 200, epoch: 7 | loss: 0.7880499
	speed: 0.0041s/iter; left time: 7.2208s
	iters: 300, epoch: 7 | loss: 1.0082613
	speed: 0.0044s/iter; left time: 7.3114s
	iters: 400, epoch: 7 | loss: 0.6587670
	speed: 0.0044s/iter; left time: 6.8866s
	iters: 500, epoch: 7 | loss: 0.3613232
	speed: 0.0044s/iter; left time: 6.3736s
	iters: 600, epoch: 7 | loss: 0.4718281
	speed: 0.0044s/iter; left time: 6.0177s
	iters: 700, epoch: 7 | loss: 1.1034898
	speed: 0.0045s/iter; left time: 5.6048s
	iters: 800, epoch: 7 | loss: 0.7549211
	speed: 0.0045s/iter; left time: 5.1837s
	iters: 900, epoch: 7 | loss: 0.8425917
	speed: 0.0044s/iter; left time: 4.6654s
Updating learning rate to 6.48610355625e-06
Epoch: 7 cost time: 4.301111221313477
Epoch: 7, Steps: 979 | Train Loss: 0.7085573 Vali Loss: 0.6546597 Best vali loss: 0.6022229
	iters: 100, epoch: 8 | loss: 0.6647547
	speed: 0.0136s/iter; left time: 11.9778s
	iters: 200, epoch: 8 | loss: 0.4164192
	speed: 0.0037s/iter; left time: 2.9060s
	iters: 300, epoch: 8 | loss: 0.2263368
	speed: 0.0037s/iter; left time: 2.4838s
	iters: 400, epoch: 8 | loss: 0.2588203
	speed: 0.0040s/iter; left time: 2.3361s
	iters: 500, epoch: 8 | loss: 0.8079415
	speed: 0.0041s/iter; left time: 1.9505s
	iters: 600, epoch: 8 | loss: 0.8657331
	speed: 0.0041s/iter; left time: 1.5636s
	iters: 700, epoch: 8 | loss: 0.2267524
	speed: 0.0042s/iter; left time: 1.1624s
	iters: 800, epoch: 8 | loss: 0.4548513
	speed: 0.0040s/iter; left time: 0.7282s
	iters: 900, epoch: 8 | loss: 0.7978462
	speed: 0.0041s/iter; left time: 0.3308s
Updating learning rate to 3.243051778125e-06
Epoch: 8 cost time: 3.971647024154663
Epoch: 8, Steps: 979 | Train Loss: 0.5243840 Vali Loss: 0.6562393 Best vali loss: 0.6022229

best validation loss 0.6022228526329895

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0110950398132, 'e_layers': 2, 'learning_rate': 6.89350093e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8020836
	speed: 0.0090s/iter; left time: 69.9331s
	iters: 200, epoch: 1 | loss: 1.2618625
	speed: 0.0043s/iter; left time: 32.6781s
	iters: 300, epoch: 1 | loss: 1.7969416
	speed: 0.0041s/iter; left time: 31.0707s
	iters: 400, epoch: 1 | loss: 0.7139260
	speed: 0.0041s/iter; left time: 30.7653s
	iters: 500, epoch: 1 | loss: 0.9272870
	speed: 0.0040s/iter; left time: 29.2730s
	iters: 600, epoch: 1 | loss: 0.8149925
	speed: 0.0042s/iter; left time: 30.1095s
	iters: 700, epoch: 1 | loss: 0.6342350
	speed: 0.0041s/iter; left time: 29.3843s
	iters: 800, epoch: 1 | loss: 1.4142890
	speed: 0.0041s/iter; left time: 28.8617s
	iters: 900, epoch: 1 | loss: 0.9237294
	speed: 0.0041s/iter; left time: 28.2476s
Updating learning rate to 6.89350093e-05
Validation loss decreased (inf --> 0.6555).  Saving model state dict ...
Epoch: 1 cost time: 4.243741989135742
Epoch: 1, Steps: 979 | Train Loss: 1.0321496 Vali Loss: 0.6555166 Best vali loss: 0.6555166
	iters: 100, epoch: 2 | loss: 1.7013413
	speed: 0.0129s/iter; left time: 87.2510s
	iters: 200, epoch: 2 | loss: 0.7247878
	speed: 0.0040s/iter; left time: 26.3926s
	iters: 300, epoch: 2 | loss: 0.8501540
	speed: 0.0043s/iter; left time: 28.2982s
	iters: 400, epoch: 2 | loss: 1.1681274
	speed: 0.0043s/iter; left time: 27.5973s
	iters: 500, epoch: 2 | loss: 0.5089455
	speed: 0.0041s/iter; left time: 25.7615s
	iters: 600, epoch: 2 | loss: 0.8438725
	speed: 0.0040s/iter; left time: 24.7675s
	iters: 700, epoch: 2 | loss: 0.7126907
	speed: 0.0040s/iter; left time: 24.5201s
	iters: 800, epoch: 2 | loss: 0.3269002
	speed: 0.0040s/iter; left time: 24.1055s
	iters: 900, epoch: 2 | loss: 0.3780701
	speed: 0.0041s/iter; left time: 24.3498s
Updating learning rate to 3.446750465e-05
Validation loss decreased (0.6555 --> 0.6310).  Saving model state dict ...
Epoch: 2 cost time: 3.990949869155884
Epoch: 2, Steps: 979 | Train Loss: 0.8016544 Vali Loss: 0.6310155 Best vali loss: 0.6310155
	iters: 100, epoch: 3 | loss: 1.8601493
	speed: 0.0138s/iter; left time: 79.8463s
	iters: 200, epoch: 3 | loss: 0.7951894
	speed: 0.0041s/iter; left time: 23.0658s
	iters: 300, epoch: 3 | loss: 0.3657803
	speed: 0.0039s/iter; left time: 21.6561s
	iters: 400, epoch: 3 | loss: 1.3800873
	speed: 0.0035s/iter; left time: 18.9791s
	iters: 500, epoch: 3 | loss: 1.5857460
	speed: 0.0035s/iter; left time: 18.9268s
	iters: 600, epoch: 3 | loss: 0.5328349
	speed: 0.0050s/iter; left time: 26.4922s
	iters: 700, epoch: 3 | loss: 1.0826854
	speed: 0.0050s/iter; left time: 25.7636s
	iters: 800, epoch: 3 | loss: 0.4076346
	speed: 0.0043s/iter; left time: 21.5766s
	iters: 900, epoch: 3 | loss: 0.4790212
	speed: 0.0050s/iter; left time: 24.8756s
Updating learning rate to 1.7233752325e-05
Validation loss decreased (0.6310 --> 0.6209).  Saving model state dict ...
Epoch: 3 cost time: 4.264597654342651
Epoch: 3, Steps: 979 | Train Loss: 0.9432365 Vali Loss: 0.6208881 Best vali loss: 0.6208881
	iters: 100, epoch: 4 | loss: 0.8158340
	speed: 0.0173s/iter; left time: 83.0555s
	iters: 200, epoch: 4 | loss: 1.0802386
	speed: 0.0034s/iter; left time: 16.0001s
	iters: 300, epoch: 4 | loss: 1.3857452
	speed: 0.0033s/iter; left time: 15.2918s
	iters: 400, epoch: 4 | loss: 0.4759391
	speed: 0.0032s/iter; left time: 14.5841s
	iters: 500, epoch: 4 | loss: 0.8823439
	speed: 0.0046s/iter; left time: 20.2191s
	iters: 600, epoch: 4 | loss: 1.3685875
	speed: 0.0050s/iter; left time: 21.4282s
	iters: 700, epoch: 4 | loss: 0.6793145
	speed: 0.0052s/iter; left time: 21.6681s
	iters: 800, epoch: 4 | loss: 0.4829091
	speed: 0.0048s/iter; left time: 19.7252s
	iters: 900, epoch: 4 | loss: 0.6080295
	speed: 0.0052s/iter; left time: 20.6191s
Updating learning rate to 8.6168761625e-06
Validation loss decreased (0.6209 --> 0.6179).  Saving model state dict ...
Epoch: 4 cost time: 4.427701950073242
Epoch: 4, Steps: 979 | Train Loss: 0.8643268 Vali Loss: 0.6179046 Best vali loss: 0.6179046
	iters: 100, epoch: 5 | loss: 0.6748661
	speed: 0.0178s/iter; left time: 68.0706s
	iters: 200, epoch: 5 | loss: 0.2831047
	speed: 0.0051s/iter; left time: 18.7925s
	iters: 300, epoch: 5 | loss: 1.1764995
	speed: 0.0046s/iter; left time: 16.6541s
	iters: 400, epoch: 5 | loss: 1.1470335
	speed: 0.0049s/iter; left time: 17.3111s
	iters: 500, epoch: 5 | loss: 0.5087966
	speed: 0.0051s/iter; left time: 17.3902s
	iters: 600, epoch: 5 | loss: 0.3287249
	speed: 0.0047s/iter; left time: 15.6001s
	iters: 700, epoch: 5 | loss: 1.4702433
	speed: 0.0046s/iter; left time: 14.6948s
	iters: 800, epoch: 5 | loss: 0.8919598
	speed: 0.0049s/iter; left time: 15.4233s
	iters: 900, epoch: 5 | loss: 2.4643469
	speed: 0.0050s/iter; left time: 15.1387s
Updating learning rate to 4.30843808125e-06
Validation loss decreased (0.6179 --> 0.6167).  Saving model state dict ...
Epoch: 5 cost time: 4.858281850814819
Epoch: 5, Steps: 979 | Train Loss: 0.9939528 Vali Loss: 0.6166768 Best vali loss: 0.6166768
	iters: 100, epoch: 6 | loss: 0.6565214
	speed: 0.0174s/iter; left time: 49.2905s
	iters: 200, epoch: 6 | loss: 1.7724689
	speed: 0.0045s/iter; left time: 12.2471s
	iters: 300, epoch: 6 | loss: 1.5976059
	speed: 0.0032s/iter; left time: 8.5313s
	iters: 400, epoch: 6 | loss: 1.0764723
	speed: 0.0032s/iter; left time: 8.2107s
	iters: 500, epoch: 6 | loss: 0.3585307
	speed: 0.0039s/iter; left time: 9.5087s
	iters: 600, epoch: 6 | loss: 0.8163016
	speed: 0.0048s/iter; left time: 11.3294s
	iters: 700, epoch: 6 | loss: 0.7175550
	speed: 0.0043s/iter; left time: 9.7206s
	iters: 800, epoch: 6 | loss: 1.0408250
	speed: 0.0045s/iter; left time: 9.5175s
	iters: 900, epoch: 6 | loss: 0.8738590
	speed: 0.0041s/iter; left time: 8.2613s
Updating learning rate to 2.154219040625e-06
Validation loss decreased (0.6167 --> 0.6159).  Saving model state dict ...
Epoch: 6 cost time: 4.151528358459473
Epoch: 6, Steps: 979 | Train Loss: 0.9900156 Vali Loss: 0.6158844 Best vali loss: 0.6158844
	iters: 100, epoch: 7 | loss: 0.9978275
	speed: 0.0159s/iter; left time: 29.6243s
	iters: 200, epoch: 7 | loss: 1.7073016
	speed: 0.0047s/iter; left time: 8.2094s
	iters: 300, epoch: 7 | loss: 0.3809454
	speed: 0.0040s/iter; left time: 6.6838s
	iters: 400, epoch: 7 | loss: 1.3481585
	speed: 0.0045s/iter; left time: 7.0794s
	iters: 500, epoch: 7 | loss: 1.0730591
	speed: 0.0045s/iter; left time: 6.5497s
	iters: 600, epoch: 7 | loss: 1.1228719
	speed: 0.0045s/iter; left time: 6.0898s
	iters: 700, epoch: 7 | loss: 1.0338259
	speed: 0.0043s/iter; left time: 5.3741s
	iters: 800, epoch: 7 | loss: 0.9568713
	speed: 0.0046s/iter; left time: 5.3867s
	iters: 900, epoch: 7 | loss: 0.3908818
	speed: 0.0044s/iter; left time: 4.6546s
Updating learning rate to 1.0771095203125e-06
Validation loss decreased (0.6159 --> 0.6156).  Saving model state dict ...
Epoch: 7 cost time: 4.297969102859497
Epoch: 7, Steps: 979 | Train Loss: 1.0013048 Vali Loss: 0.6155581 Best vali loss: 0.6155581
	iters: 100, epoch: 8 | loss: 0.4589221
	speed: 0.0126s/iter; left time: 11.0860s
	iters: 200, epoch: 8 | loss: 0.7444280
	speed: 0.0045s/iter; left time: 3.5464s
	iters: 300, epoch: 8 | loss: 1.2757962
	speed: 0.0051s/iter; left time: 3.4630s
	iters: 400, epoch: 8 | loss: 0.6730143
	speed: 0.0049s/iter; left time: 2.8193s
	iters: 500, epoch: 8 | loss: 1.0364351
	speed: 0.0052s/iter; left time: 2.4824s
	iters: 600, epoch: 8 | loss: 0.9134109
	speed: 0.0052s/iter; left time: 1.9593s
	iters: 700, epoch: 8 | loss: 0.8844785
	speed: 0.0048s/iter; left time: 1.3506s
	iters: 800, epoch: 8 | loss: 0.5224215
	speed: 0.0044s/iter; left time: 0.7840s
	iters: 900, epoch: 8 | loss: 0.6516110
	speed: 0.0052s/iter; left time: 0.4149s
Updating learning rate to 5.3855476015625e-07
Validation loss decreased (0.6156 --> 0.6154).  Saving model state dict ...
Epoch: 8 cost time: 4.7842676639556885
Epoch: 8, Steps: 979 | Train Loss: 0.7956131 Vali Loss: 0.6153904 Best vali loss: 0.6153904

best validation loss 0.6153904032039731

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.010989339883, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0355920
	speed: 0.0142s/iter; left time: 12.5904s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.6738).  Saving model state dict ...
Epoch: 1 cost time: 1.2926535606384277
Epoch: 1, Steps: 123 | Train Loss: 1.0355920 Vali Loss: 0.6738270 Best vali loss: 0.6738270
	iters: 100, epoch: 2 | loss: 0.9656710
	speed: 0.0123s/iter; left time: 9.4041s
Updating learning rate to 0.0019699025932
Validation loss decreased (0.6738 --> 0.6308).  Saving model state dict ...
Epoch: 2 cost time: 1.0046815872192383
Epoch: 2, Steps: 123 | Train Loss: 0.9656710 Vali Loss: 0.6307679 Best vali loss: 0.6307679
	iters: 100, epoch: 3 | loss: 1.3545035
	speed: 0.0121s/iter; left time: 7.7584s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 0.9667701721191406
Epoch: 3, Steps: 123 | Train Loss: 1.3545035 Vali Loss: 0.6616362 Best vali loss: 0.6307679

best validation loss 0.6307678755815798

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6057808
	speed: 0.0119s/iter; left time: 45.4419s
	iters: 200, epoch: 1 | loss: 0.9099761
	speed: 0.0059s/iter; left time: 22.0808s
	iters: 300, epoch: 1 | loss: 1.1499507
	speed: 0.0061s/iter; left time: 21.9569s
	iters: 400, epoch: 1 | loss: 1.1276221
	speed: 0.0060s/iter; left time: 21.1785s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.6276).  Saving model state dict ...
Epoch: 1 cost time: 3.2691521644592285
Epoch: 1, Steps: 490 | Train Loss: 0.9483324 Vali Loss: 0.6276189 Best vali loss: 0.6276189
	iters: 100, epoch: 2 | loss: 1.1607152
	speed: 0.0171s/iter; left time: 57.0507s
	iters: 200, epoch: 2 | loss: 0.6182223
	speed: 0.0059s/iter; left time: 19.0586s
	iters: 300, epoch: 2 | loss: 0.9676126
	speed: 0.0061s/iter; left time: 18.9830s
	iters: 400, epoch: 2 | loss: 0.5355896
	speed: 0.0061s/iter; left time: 18.4137s
Updating learning rate to 0.000552421030539641
Validation loss decreased (0.6276 --> 0.6202).  Saving model state dict ...
Epoch: 2 cost time: 3.0017237663269043
Epoch: 2, Steps: 490 | Train Loss: 0.8205349 Vali Loss: 0.6202179 Best vali loss: 0.6202179
	iters: 100, epoch: 3 | loss: 0.8285242
	speed: 0.0147s/iter; left time: 41.6252s
	iters: 200, epoch: 3 | loss: 1.0112342
	speed: 0.0051s/iter; left time: 13.8787s
	iters: 300, epoch: 3 | loss: 1.2093744
	speed: 0.0053s/iter; left time: 13.9322s
	iters: 400, epoch: 3 | loss: 0.4508401
	speed: 0.0053s/iter; left time: 13.4704s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.6202 --> 0.6043).  Saving model state dict ...
Epoch: 3 cost time: 2.5323879718780518
Epoch: 3, Steps: 490 | Train Loss: 0.8749932 Vali Loss: 0.6042530 Best vali loss: 0.6042530

best validation loss 0.6042529792214146

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7254710
	speed: 0.0086s/iter; left time: 32.9802s
	iters: 200, epoch: 1 | loss: 0.8976730
	speed: 0.0032s/iter; left time: 11.9079s
	iters: 300, epoch: 1 | loss: 0.8006348
	speed: 0.0031s/iter; left time: 11.1157s
	iters: 400, epoch: 1 | loss: 0.6139469
	speed: 0.0030s/iter; left time: 10.6456s
Updating learning rate to 0.0005012943918
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 1.8105783462524414
Epoch: 1, Steps: 490 | Train Loss: 0.7594314 Vali Loss: 0.6064813 Best vali loss: 0.6064813
	iters: 100, epoch: 2 | loss: 0.8539351
	speed: 0.0092s/iter; left time: 30.6195s
	iters: 200, epoch: 2 | loss: 1.0063571
	speed: 0.0031s/iter; left time: 9.9424s
	iters: 300, epoch: 2 | loss: 0.9928847
	speed: 0.0029s/iter; left time: 9.1756s
	iters: 400, epoch: 2 | loss: 0.7614621
	speed: 0.0032s/iter; left time: 9.5918s
Updating learning rate to 0.0002506471959
Validation loss decreased (0.6065 --> 0.6007).  Saving model state dict ...
Epoch: 2 cost time: 1.528212070465088
Epoch: 2, Steps: 490 | Train Loss: 0.9036597 Vali Loss: 0.6006563 Best vali loss: 0.6006563
	iters: 100, epoch: 3 | loss: 0.6686716
	speed: 0.0093s/iter; left time: 26.4690s
	iters: 200, epoch: 3 | loss: 0.8416012
	speed: 0.0030s/iter; left time: 8.2195s
	iters: 300, epoch: 3 | loss: 0.7155042
	speed: 0.0030s/iter; left time: 7.9755s
	iters: 400, epoch: 3 | loss: 1.1118809
	speed: 0.0030s/iter; left time: 7.6782s
Updating learning rate to 0.00012532359795
Epoch: 3 cost time: 1.5198018550872803
Epoch: 3, Steps: 490 | Train Loss: 0.8344145 Vali Loss: 0.6023883 Best vali loss: 0.6006563

best validation loss 0.6006562898469049

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7253492
	speed: 0.0082s/iter; left time: 19.3623s
	iters: 200, epoch: 4 | loss: 0.8847537
	speed: 0.0028s/iter; left time: 6.3585s
	iters: 300, epoch: 4 | loss: 0.7970312
	speed: 0.0029s/iter; left time: 6.2258s
	iters: 400, epoch: 4 | loss: 0.5554072
	speed: 0.0029s/iter; left time: 5.9822s
Updating learning rate to 6.2661798975e-05
Epoch: 4 cost time: 1.6852567195892334
Epoch: 4, Steps: 490 | Train Loss: 0.7406353 Vali Loss: 0.6069523 Best vali loss: 0.6006563
	iters: 100, epoch: 5 | loss: 0.7889851
	speed: 0.0093s/iter; left time: 17.3751s
	iters: 200, epoch: 5 | loss: 0.9534811
	speed: 0.0031s/iter; left time: 5.5334s
	iters: 300, epoch: 5 | loss: 0.9548309
	speed: 0.0032s/iter; left time: 5.2531s
	iters: 400, epoch: 5 | loss: 0.7550399
	speed: 0.0031s/iter; left time: 4.9011s
Updating learning rate to 3.13308994875e-05
Epoch: 5 cost time: 1.5822017192840576
Epoch: 5, Steps: 490 | Train Loss: 0.8630843 Vali Loss: 0.6117519 Best vali loss: 0.6006563
	iters: 100, epoch: 6 | loss: 0.6555818
	speed: 0.0097s/iter; left time: 13.3012s
	iters: 200, epoch: 6 | loss: 0.8212523
	speed: 0.0031s/iter; left time: 3.9667s
	iters: 300, epoch: 6 | loss: 0.7132635
	speed: 0.0031s/iter; left time: 3.5897s
	iters: 400, epoch: 6 | loss: 1.0886979
	speed: 0.0031s/iter; left time: 3.3129s
Updating learning rate to 1.566544974375e-05
Epoch: 6 cost time: 1.578066110610962
Epoch: 6, Steps: 490 | Train Loss: 0.8196989 Vali Loss: 0.6142481 Best vali loss: 0.6006563
	iters: 100, epoch: 7 | loss: 0.5834975
	speed: 0.0097s/iter; left time: 8.5599s
	iters: 200, epoch: 7 | loss: 1.3066485
	speed: 0.0033s/iter; left time: 2.5941s
	iters: 300, epoch: 7 | loss: 0.4583655
	speed: 0.0033s/iter; left time: 2.2230s
	iters: 400, epoch: 7 | loss: 0.9620096
	speed: 0.0032s/iter; left time: 1.8455s
Updating learning rate to 7.832724871875e-06
Epoch: 7 cost time: 1.628835916519165
Epoch: 7, Steps: 490 | Train Loss: 0.8276303 Vali Loss: 0.6121686 Best vali loss: 0.6006563
	iters: 100, epoch: 8 | loss: 0.4909751
	speed: 0.0095s/iter; left time: 3.7263s
	iters: 200, epoch: 8 | loss: 0.5252637
	speed: 0.0030s/iter; left time: 0.8621s
	iters: 300, epoch: 8 | loss: 0.7056033
	speed: 0.0030s/iter; left time: 0.5712s
	iters: 400, epoch: 8 | loss: 1.1644553
	speed: 0.0030s/iter; left time: 0.2704s
Updating learning rate to 3.9163624359375e-06
Epoch: 8 cost time: 1.5130681991577148
Epoch: 8, Steps: 490 | Train Loss: 0.7215744 Vali Loss: 0.6141244 Best vali loss: 0.6006563

best validation loss 0.6006562898469049

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 3, 'learning_rate': 5.08199726e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1168000
	speed: 0.0104s/iter; left time: 80.3729s
	iters: 200, epoch: 1 | loss: 0.8973092
	speed: 0.0051s/iter; left time: 38.9336s
	iters: 300, epoch: 1 | loss: 1.5763237
	speed: 0.0051s/iter; left time: 38.6968s
	iters: 400, epoch: 1 | loss: 1.0300529
	speed: 0.0051s/iter; left time: 37.5858s
	iters: 500, epoch: 1 | loss: 1.3133734
	speed: 0.0052s/iter; left time: 37.9380s
	iters: 600, epoch: 1 | loss: 0.8939288
	speed: 0.0047s/iter; left time: 33.9380s
	iters: 700, epoch: 1 | loss: 0.5178519
	speed: 0.0046s/iter; left time: 33.0185s
	iters: 800, epoch: 1 | loss: 0.7725322
	speed: 0.0053s/iter; left time: 36.9682s
	iters: 900, epoch: 1 | loss: 0.8806129
	speed: 0.0053s/iter; left time: 36.9748s
Updating learning rate to 4.88857525639622e-05
Validation loss decreased (inf --> 0.6378).  Saving model state dict ...
Epoch: 1 cost time: 5.238770961761475
Epoch: 1, Steps: 979 | Train Loss: 0.9998650 Vali Loss: 0.6377914 Best vali loss: 0.6377914
	iters: 100, epoch: 2 | loss: 1.0810014
	speed: 0.0166s/iter; left time: 112.3883s
	iters: 200, epoch: 2 | loss: 0.5861549
	speed: 0.0051s/iter; left time: 34.0216s
	iters: 300, epoch: 2 | loss: 1.0212497
	speed: 0.0058s/iter; left time: 37.9364s
	iters: 400, epoch: 2 | loss: 0.4895342
	speed: 0.0049s/iter; left time: 31.8029s
	iters: 500, epoch: 2 | loss: 1.0147270
	speed: 0.0049s/iter; left time: 31.1983s
	iters: 600, epoch: 2 | loss: 0.6241871
	speed: 0.0050s/iter; left time: 30.9701s
	iters: 700, epoch: 2 | loss: 0.8292333
	speed: 0.0047s/iter; left time: 28.8898s
	iters: 800, epoch: 2 | loss: 0.6444457
	speed: 0.0048s/iter; left time: 29.0900s
	iters: 900, epoch: 2 | loss: 1.7471462
	speed: 0.0052s/iter; left time: 30.8645s
Updating learning rate to 4.337755992258727e-05
Validation loss decreased (0.6378 --> 0.6179).  Saving model state dict ...
Epoch: 2 cost time: 5.009052991867065
Epoch: 2, Steps: 979 | Train Loss: 0.8930755 Vali Loss: 0.6179334 Best vali loss: 0.6179334
	iters: 100, epoch: 3 | loss: 0.5507704
	speed: 0.0164s/iter; left time: 94.7717s
	iters: 200, epoch: 3 | loss: 0.4938050
	speed: 0.0052s/iter; left time: 29.6758s
	iters: 300, epoch: 3 | loss: 1.2405487
	speed: 0.0053s/iter; left time: 29.4468s
	iters: 400, epoch: 3 | loss: 0.5594751
	speed: 0.0052s/iter; left time: 28.4285s
	iters: 500, epoch: 3 | loss: 0.3144239
	speed: 0.0052s/iter; left time: 27.6897s
	iters: 600, epoch: 3 | loss: 0.5255615
	speed: 0.0051s/iter; left time: 26.8543s
	iters: 700, epoch: 3 | loss: 0.6796212
	speed: 0.0050s/iter; left time: 26.0583s
	iters: 800, epoch: 3 | loss: 1.0179157
	speed: 0.0046s/iter; left time: 23.4868s
	iters: 900, epoch: 3 | loss: 1.2635161
	speed: 0.0050s/iter; left time: 25.0796s
Updating learning rate to 3.5133967073633905e-05
Validation loss decreased (0.6179 --> 0.6094).  Saving model state dict ...
Epoch: 3 cost time: 5.038026571273804
Epoch: 3, Steps: 979 | Train Loss: 0.7384042 Vali Loss: 0.6094149 Best vali loss: 0.6094149
	iters: 100, epoch: 4 | loss: 1.0616390
	speed: 0.0165s/iter; left time: 79.2810s
	iters: 200, epoch: 4 | loss: 1.2230829
	speed: 0.0051s/iter; left time: 23.8554s
	iters: 300, epoch: 4 | loss: 1.5388242
	speed: 0.0051s/iter; left time: 23.5821s
	iters: 400, epoch: 4 | loss: 0.8344025
	speed: 0.0052s/iter; left time: 23.5100s
	iters: 500, epoch: 4 | loss: 0.7725001
	speed: 0.0052s/iter; left time: 22.7146s
	iters: 600, epoch: 4 | loss: 0.8406646
	speed: 0.0052s/iter; left time: 22.4813s
	iters: 700, epoch: 4 | loss: 0.6981606
	speed: 0.0051s/iter; left time: 21.5425s
	iters: 800, epoch: 4 | loss: 0.2872335
	speed: 0.0052s/iter; left time: 21.2642s
	iters: 900, epoch: 4 | loss: 0.7714852
	speed: 0.0049s/iter; left time: 19.5575s
Updating learning rate to 2.54099863e-05
Validation loss decreased (0.6094 --> 0.6067).  Saving model state dict ...
Epoch: 4 cost time: 5.077492952346802
Epoch: 4, Steps: 979 | Train Loss: 0.8919992 Vali Loss: 0.6066521 Best vali loss: 0.6066521
	iters: 100, epoch: 5 | loss: 0.5446742
	speed: 0.0162s/iter; left time: 61.9568s
	iters: 200, epoch: 5 | loss: 0.2943364
	speed: 0.0052s/iter; left time: 19.3328s
	iters: 300, epoch: 5 | loss: 0.4454609
	speed: 0.0052s/iter; left time: 18.9227s
	iters: 400, epoch: 5 | loss: 1.4329580
	speed: 0.0051s/iter; left time: 17.9128s
	iters: 500, epoch: 5 | loss: 1.3125226
	speed: 0.0051s/iter; left time: 17.5549s
	iters: 600, epoch: 5 | loss: 0.5150722
	speed: 0.0052s/iter; left time: 17.1136s
	iters: 700, epoch: 5 | loss: 1.1274542
	speed: 0.0051s/iter; left time: 16.4716s
	iters: 800, epoch: 5 | loss: 0.5659062
	speed: 0.0052s/iter; left time: 16.0800s
	iters: 900, epoch: 5 | loss: 0.3055050
	speed: 0.0047s/iter; left time: 14.2732s
Updating learning rate to 1.5686005526366093e-05
Validation loss decreased (0.6067 --> 0.6038).  Saving model state dict ...
Epoch: 5 cost time: 5.003140449523926
Epoch: 5, Steps: 979 | Train Loss: 0.7270989 Vali Loss: 0.6037735 Best vali loss: 0.6037735
	iters: 100, epoch: 6 | loss: 1.7646623
	speed: 0.0139s/iter; left time: 39.4049s
	iters: 200, epoch: 6 | loss: 1.7833204
	speed: 0.0050s/iter; left time: 13.8057s
	iters: 300, epoch: 6 | loss: 0.9613115
	speed: 0.0051s/iter; left time: 13.4686s
	iters: 400, epoch: 6 | loss: 0.9051055
	speed: 0.0050s/iter; left time: 12.7780s
	iters: 500, epoch: 6 | loss: 1.2495635
	speed: 0.0051s/iter; left time: 12.3515s
	iters: 600, epoch: 6 | loss: 0.4408564
	speed: 0.0050s/iter; left time: 11.7661s
	iters: 700, epoch: 6 | loss: 0.6272473
	speed: 0.0051s/iter; left time: 11.4016s
	iters: 800, epoch: 6 | loss: 2.4030426
	speed: 0.0050s/iter; left time: 10.7642s
	iters: 900, epoch: 6 | loss: 1.2392471
	speed: 0.0052s/iter; left time: 10.5029s
Updating learning rate to 7.442412677412731e-06
Validation loss decreased (0.6038 --> 0.6026).  Saving model state dict ...
Epoch: 6 cost time: 4.928611516952515
Epoch: 6, Steps: 979 | Train Loss: 1.2638174 Vali Loss: 0.6025841 Best vali loss: 0.6025841
	iters: 100, epoch: 7 | loss: 0.4428665
	speed: 0.0157s/iter; left time: 29.1768s
	iters: 200, epoch: 7 | loss: 0.9064484
	speed: 0.0049s/iter; left time: 8.5719s
	iters: 300, epoch: 7 | loss: 0.3250696
	speed: 0.0051s/iter; left time: 8.4541s
	iters: 400, epoch: 7 | loss: 0.6544389
	speed: 0.0051s/iter; left time: 7.9088s
	iters: 500, epoch: 7 | loss: 0.7618397
	speed: 0.0050s/iter; left time: 7.2972s
	iters: 600, epoch: 7 | loss: 0.4963545
	speed: 0.0051s/iter; left time: 6.9577s
	iters: 700, epoch: 7 | loss: 0.5938504
	speed: 0.0051s/iter; left time: 6.4146s
	iters: 800, epoch: 7 | loss: 0.9272106
	speed: 0.0051s/iter; left time: 5.8635s
	iters: 900, epoch: 7 | loss: 0.2954735
	speed: 0.0051s/iter; left time: 5.3948s
Updating learning rate to 1.934220036037799e-06
Epoch: 7 cost time: 4.964657783508301
Epoch: 7, Steps: 979 | Train Loss: 0.6003947 Vali Loss: 0.6036120 Best vali loss: 0.6025841
	iters: 100, epoch: 8 | loss: 0.9844228
	speed: 0.0158s/iter; left time: 13.8986s
	iters: 200, epoch: 8 | loss: 2.0846672
	speed: 0.0047s/iter; left time: 3.6735s
	iters: 300, epoch: 8 | loss: 0.9808618
	speed: 0.0050s/iter; left time: 3.3862s
	iters: 400, epoch: 8 | loss: 0.9912929
	speed: 0.0056s/iter; left time: 3.2628s
	iters: 500, epoch: 8 | loss: 0.5128325
	speed: 0.0055s/iter; left time: 2.6639s
	iters: 600, epoch: 8 | loss: 0.4431228
	speed: 0.0056s/iter; left time: 2.1247s
	iters: 700, epoch: 8 | loss: 0.5204806
	speed: 0.0056s/iter; left time: 1.5702s
	iters: 800, epoch: 8 | loss: 1.2359246
	speed: 0.0055s/iter; left time: 0.9920s
	iters: 900, epoch: 8 | loss: 0.6132101
	speed: 0.0058s/iter; left time: 0.4626s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.307049512863159
Epoch: 8, Steps: 979 | Train Loss: 0.9296462 Vali Loss: 0.6035664 Best vali loss: 0.6025841

best validation loss 0.602584120742925

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0089588480994, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4769712
	speed: 0.0104s/iter; left time: 80.2046s
	iters: 200, epoch: 1 | loss: 1.1197584
	speed: 0.0052s/iter; left time: 39.8917s
	iters: 300, epoch: 1 | loss: 0.9347783
	speed: 0.0053s/iter; left time: 39.9086s
	iters: 400, epoch: 1 | loss: 1.1067803
	speed: 0.0053s/iter; left time: 39.5577s
	iters: 500, epoch: 1 | loss: 1.0741632
	speed: 0.0053s/iter; left time: 39.0982s
	iters: 600, epoch: 1 | loss: 0.8409184
	speed: 0.0054s/iter; left time: 38.7899s
	iters: 700, epoch: 1 | loss: 0.5879975
	speed: 0.0054s/iter; left time: 38.4775s
	iters: 800, epoch: 1 | loss: 1.4089386
	speed: 0.0054s/iter; left time: 38.1702s
	iters: 900, epoch: 1 | loss: 0.8754505
	speed: 0.0051s/iter; left time: 35.3673s
Updating learning rate to 0.00044044934731141274
Validation loss decreased (inf --> 0.6186).  Saving model state dict ...
Epoch: 1 cost time: 5.430394411087036
Epoch: 1, Steps: 979 | Train Loss: 0.9361952 Vali Loss: 0.6185592 Best vali loss: 0.6185592
	iters: 100, epoch: 2 | loss: 0.9422079
	speed: 0.0165s/iter; left time: 111.5007s
	iters: 200, epoch: 2 | loss: 1.0093045
	speed: 0.0051s/iter; left time: 33.8153s
	iters: 300, epoch: 2 | loss: 1.1092366
	speed: 0.0052s/iter; left time: 33.8646s
	iters: 400, epoch: 2 | loss: 0.4759255
	speed: 0.0051s/iter; left time: 32.9467s
	iters: 500, epoch: 2 | loss: 0.4572391
	speed: 0.0051s/iter; left time: 32.6626s
	iters: 600, epoch: 2 | loss: 0.5004047
	speed: 0.0053s/iter; left time: 32.8622s
	iters: 700, epoch: 2 | loss: 0.6096842
	speed: 0.0053s/iter; left time: 32.4490s
	iters: 800, epoch: 2 | loss: 1.2001255
	speed: 0.0052s/iter; left time: 31.5510s
	iters: 900, epoch: 2 | loss: 0.8052732
	speed: 0.0052s/iter; left time: 31.1440s
Updating learning rate to 0.0003908218029551133
Validation loss decreased (0.6186 --> 0.6097).  Saving model state dict ...
Epoch: 2 cost time: 5.12351393699646
Epoch: 2, Steps: 979 | Train Loss: 0.7899335 Vali Loss: 0.6096929 Best vali loss: 0.6096929
	iters: 100, epoch: 3 | loss: 1.0597346
	speed: 0.0168s/iter; left time: 96.9952s
	iters: 200, epoch: 3 | loss: 0.8045580
	speed: 0.0052s/iter; left time: 29.6788s
	iters: 300, epoch: 3 | loss: 0.3554389
	speed: 0.0053s/iter; left time: 29.5225s
	iters: 400, epoch: 3 | loss: 0.7587678
	speed: 0.0056s/iter; left time: 30.6782s
	iters: 500, epoch: 3 | loss: 1.4262378
	speed: 0.0057s/iter; left time: 30.8954s
	iters: 600, epoch: 3 | loss: 1.5379611
	speed: 0.0060s/iter; left time: 31.5181s
	iters: 700, epoch: 3 | loss: 1.4875699
	speed: 0.0055s/iter; left time: 28.4443s
	iters: 800, epoch: 3 | loss: 0.9197813
	speed: 0.0057s/iter; left time: 28.9708s
	iters: 900, epoch: 3 | loss: 1.0751871
	speed: 0.0056s/iter; left time: 27.8279s
Updating learning rate to 0.00031654893408453833
Epoch: 3 cost time: 5.5049729347229
Epoch: 3, Steps: 979 | Train Loss: 1.0472485 Vali Loss: 0.6304905 Best vali loss: 0.6096929
	iters: 100, epoch: 4 | loss: 0.7324575
	speed: 0.0171s/iter; left time: 81.9358s
	iters: 200, epoch: 4 | loss: 0.3518997
	speed: 0.0054s/iter; left time: 25.1474s
	iters: 300, epoch: 4 | loss: 0.4913077
	speed: 0.0048s/iter; left time: 22.2817s
	iters: 400, epoch: 4 | loss: 0.6480150
	speed: 0.0049s/iter; left time: 21.8176s
	iters: 500, epoch: 4 | loss: 0.6500926
	speed: 0.0052s/iter; left time: 22.9439s
	iters: 600, epoch: 4 | loss: 0.7449816
	speed: 0.0052s/iter; left time: 22.2950s
	iters: 700, epoch: 4 | loss: 0.4712657
	speed: 0.0052s/iter; left time: 21.7572s
	iters: 800, epoch: 4 | loss: 0.5846323
	speed: 0.0052s/iter; left time: 21.2730s
	iters: 900, epoch: 4 | loss: 0.6923809
	speed: 0.0052s/iter; left time: 20.6069s
Updating learning rate to 0.0002289381117
Epoch: 4 cost time: 5.107273101806641
Epoch: 4, Steps: 979 | Train Loss: 0.5963370 Vali Loss: 0.6334372 Best vali loss: 0.6096929
	iters: 100, epoch: 5 | loss: 0.8949436
	speed: 0.0166s/iter; left time: 63.2480s
	iters: 200, epoch: 5 | loss: 1.0037265
	speed: 0.0052s/iter; left time: 19.3440s
	iters: 300, epoch: 5 | loss: 0.4519282
	speed: 0.0051s/iter; left time: 18.4637s
	iters: 400, epoch: 5 | loss: 0.2543933
	speed: 0.0049s/iter; left time: 17.2004s
	iters: 500, epoch: 5 | loss: 0.4497681
	speed: 0.0049s/iter; left time: 16.8426s
	iters: 600, epoch: 5 | loss: 0.1917172
	speed: 0.0051s/iter; left time: 16.9721s
	iters: 700, epoch: 5 | loss: 1.0407298
	speed: 0.0050s/iter; left time: 16.0350s
	iters: 800, epoch: 5 | loss: 0.4528702
	speed: 0.0051s/iter; left time: 15.9969s
	iters: 900, epoch: 5 | loss: 0.3759957
	speed: 0.0052s/iter; left time: 15.7173s
Updating learning rate to 0.0001413272893154617
Epoch: 5 cost time: 5.037501096725464
Epoch: 5, Steps: 979 | Train Loss: 0.5684525 Vali Loss: 0.6148146 Best vali loss: 0.6096929
	iters: 100, epoch: 6 | loss: 0.8395700
	speed: 0.0169s/iter; left time: 48.0498s
	iters: 200, epoch: 6 | loss: 0.3451354
	speed: 0.0057s/iter; left time: 15.5491s
	iters: 300, epoch: 6 | loss: 0.5680035
	speed: 0.0055s/iter; left time: 14.5731s
	iters: 400, epoch: 6 | loss: 1.0997002
	speed: 0.0054s/iter; left time: 13.6784s
	iters: 500, epoch: 6 | loss: 1.0988287
	speed: 0.0054s/iter; left time: 13.1331s
	iters: 600, epoch: 6 | loss: 0.3439802
	speed: 0.0044s/iter; left time: 10.3599s
	iters: 700, epoch: 6 | loss: 1.1756270
	speed: 0.0044s/iter; left time: 9.7750s
	iters: 800, epoch: 6 | loss: 0.3427309
	speed: 0.0063s/iter; left time: 13.5207s
	iters: 900, epoch: 6 | loss: 0.4464199
	speed: 0.0065s/iter; left time: 13.2185s
Updating learning rate to 6.705442044488674e-05
Epoch: 6 cost time: 5.443795680999756
Epoch: 6, Steps: 979 | Train Loss: 0.6955551 Vali Loss: 0.6238524 Best vali loss: 0.6096929
	iters: 100, epoch: 7 | loss: 0.2789561
	speed: 0.0166s/iter; left time: 30.9180s
	iters: 200, epoch: 7 | loss: 0.6960453
	speed: 0.0083s/iter; left time: 14.5293s
	iters: 300, epoch: 7 | loss: 0.2438607
	speed: 0.0095s/iter; left time: 15.8042s
	iters: 400, epoch: 7 | loss: 1.1339794
	speed: 0.0092s/iter; left time: 14.3815s
	iters: 500, epoch: 7 | loss: 0.8357021
	speed: 0.0095s/iter; left time: 13.9204s
	iters: 600, epoch: 7 | loss: 0.3388655
	speed: 0.0089s/iter; left time: 12.1592s
	iters: 700, epoch: 7 | loss: 0.7704539
	speed: 0.0094s/iter; left time: 11.7840s
	iters: 800, epoch: 7 | loss: 0.3832329
	speed: 0.0048s/iter; left time: 5.5615s
	iters: 900, epoch: 7 | loss: 0.9362241
	speed: 0.0045s/iter; left time: 4.7632s
Updating learning rate to 1.7426876088587254e-05
Epoch: 7 cost time: 7.357794284820557
Epoch: 7, Steps: 979 | Train Loss: 0.6241467 Vali Loss: 0.6200792 Best vali loss: 0.6096929
	iters: 100, epoch: 8 | loss: 0.8226783
	speed: 0.0196s/iter; left time: 17.2073s
	iters: 200, epoch: 8 | loss: 0.2763091
	speed: 0.0058s/iter; left time: 4.5466s
	iters: 300, epoch: 8 | loss: 1.1038709
	speed: 0.0060s/iter; left time: 4.0484s
	iters: 400, epoch: 8 | loss: 0.2424529
	speed: 0.0064s/iter; left time: 3.7195s
	iters: 500, epoch: 8 | loss: 0.2699842
	speed: 0.0059s/iter; left time: 2.8375s
	iters: 600, epoch: 8 | loss: 0.3325455
	speed: 0.0062s/iter; left time: 2.3622s
	iters: 700, epoch: 8 | loss: 0.7510455
	speed: 0.0062s/iter; left time: 1.7481s
	iters: 800, epoch: 8 | loss: 0.2482794
	speed: 0.0062s/iter; left time: 1.1236s
	iters: 900, epoch: 8 | loss: 0.5171925
	speed: 0.0044s/iter; left time: 0.3548s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.742204904556274
Epoch: 8, Steps: 979 | Train Loss: 0.5071509 Vali Loss: 0.6191037 Best vali loss: 0.6096929

best validation loss 0.6096929475727152

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022985164426, 'e_layers': 4, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.6653).  Saving model state dict ...
Epoch: 1 cost time: 1.182579755783081
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6653030 Best vali loss: 0.6653030
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.6653 --> 0.6392).  Saving model state dict ...
Epoch: 2 cost time: 0.7071225643157959
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6391788 Best vali loss: 0.6391788
Updating learning rate to 8.93085473266162e-05
Validation loss decreased (0.6392 --> 0.6286).  Saving model state dict ...
Epoch: 3 cost time: 0.8219351768493652
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6285765 Best vali loss: 0.6285765

best validation loss 0.6285764602034911

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5897909
	speed: 0.0220s/iter; left time: 19.5054s
Updating learning rate to 0.00022635856963078432
Validation loss decreased (inf --> 0.5983).  Saving model state dict ...
Epoch: 1 cost time: 2.357034683227539
Epoch: 1, Steps: 123 | Train Loss: 0.5897909 Vali Loss: 0.5983324 Best vali loss: 0.5983324
	iters: 100, epoch: 2 | loss: 0.8541566
	speed: 0.0252s/iter; left time: 19.1714s
Updating learning rate to 0.0002008536619192565
Validation loss decreased (0.5983 --> 0.5514).  Saving model state dict ...
Epoch: 2 cost time: 1.8078868389129639
Epoch: 2, Steps: 123 | Train Loss: 0.8541566 Vali Loss: 0.5514426 Best vali loss: 0.5514426
	iters: 100, epoch: 3 | loss: 0.8217607
	speed: 0.0177s/iter; left time: 11.2850s
Updating learning rate to 0.00016268287006193248
Epoch: 3 cost time: 1.6468884944915771
Epoch: 3, Steps: 123 | Train Loss: 0.8217607 Vali Loss: 0.5586777 Best vali loss: 0.5514426

best validation loss 0.5514425721669407

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010602146623, 'e_layers': 4, 'learning_rate': 0.000225512069, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8767589
	speed: 0.0137s/iter; left time: 25.5547s
	iters: 200, epoch: 1 | loss: 0.9527043
	speed: 0.0085s/iter; left time: 14.8908s
Updating learning rate to 0.000225512069
Validation loss decreased (inf --> 0.6082).  Saving model state dict ...
Epoch: 1 cost time: 2.3207900524139404
Epoch: 1, Steps: 245 | Train Loss: 0.9147316 Vali Loss: 0.6081694 Best vali loss: 0.6081694
	iters: 100, epoch: 2 | loss: 0.6973079
	speed: 0.0135s/iter; left time: 21.8321s
	iters: 200, epoch: 2 | loss: 0.7684135
	speed: 0.0066s/iter; left time: 10.0696s
Updating learning rate to 0.0001127560345
Validation loss decreased (0.6082 --> 0.6076).  Saving model state dict ...
Epoch: 2 cost time: 1.626286506652832
Epoch: 2, Steps: 245 | Train Loss: 0.7328607 Vali Loss: 0.6076418 Best vali loss: 0.6076418
	iters: 100, epoch: 3 | loss: 0.8515368
	speed: 0.0143s/iter; left time: 19.5999s
	iters: 200, epoch: 3 | loss: 0.8256285
	speed: 0.0070s/iter; left time: 8.8969s
Updating learning rate to 5.637801725e-05
Validation loss decreased (0.6076 --> 0.5830).  Saving model state dict ...
Epoch: 3 cost time: 1.7915167808532715
Epoch: 3, Steps: 245 | Train Loss: 0.8385826 Vali Loss: 0.5829885 Best vali loss: 0.5829885

best validation loss 0.5829884939754191

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5082465
	speed: 0.0197s/iter; left time: 10.1646s
Updating learning rate to 0.0001176573511
Epoch: 4 cost time: 1.9378821849822998
Epoch: 4, Steps: 123 | Train Loss: 0.5082465 Vali Loss: 0.5566780 Best vali loss: 0.5514426
	iters: 100, epoch: 5 | loss: 0.7456414
	speed: 0.0192s/iter; left time: 7.5268s
Updating learning rate to 7.263183213806753e-05
Epoch: 5 cost time: 1.60770583152771
Epoch: 5, Steps: 123 | Train Loss: 0.7456414 Vali Loss: 0.5862902 Best vali loss: 0.5514426
	iters: 100, epoch: 6 | loss: 0.7236981
	speed: 0.0194s/iter; left time: 5.2511s
Updating learning rate to 3.446104028074351e-05
Epoch: 6 cost time: 1.5556445121765137
Epoch: 6, Steps: 123 | Train Loss: 0.7236981 Vali Loss: 0.5844978 Best vali loss: 0.5514426
	iters: 100, epoch: 7 | loss: 0.7528521
	speed: 0.0160s/iter; left time: 2.3520s
Updating learning rate to 8.956132569215671e-06
Epoch: 7 cost time: 1.4521229267120361
Epoch: 7, Steps: 123 | Train Loss: 0.7528521 Vali Loss: 0.6015961 Best vali loss: 0.5514426
	iters: 100, epoch: 8 | loss: 1.0102061
	speed: 0.0177s/iter; left time: 0.4245s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4580504894256592
Epoch: 8, Steps: 123 | Train Loss: 1.0102061 Vali Loss: 0.5946920 Best vali loss: 0.5514426

best validation loss 0.5514425721669407

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028252887435, 'e_layers': 1, 'learning_rate': 0.0029075166254, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027968558630216732
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 0.8664920330047607
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6171360 Best vali loss: 0.6171360
Updating learning rate to 0.0024817206738164837
Epoch: 2 cost time: 0.46062564849853516
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6664085 Best vali loss: 0.6171360
Updating learning rate to 0.002010087533633318
Epoch: 3 cost time: 0.4794306755065918
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6217971 Best vali loss: 0.6171360
Updating learning rate to 0.0014537583127
Validation loss decreased (0.6171 --> 0.6005).  Saving model state dict ...
Epoch: 4 cost time: 0.5299570560455322
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6005097 Best vali loss: 0.6005097
Updating learning rate to 0.0008974290917666826
Epoch: 5 cost time: 0.5365195274353027
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6592780 Best vali loss: 0.6005097
Updating learning rate to 0.0004257959515835167
Epoch: 6 cost time: 0.5150845050811768
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6440625 Best vali loss: 0.6005097
Updating learning rate to 0.000110660762378327
Epoch: 7 cost time: 0.4436655044555664
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6298096 Best vali loss: 0.6005097
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5352671146392822
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6306270 Best vali loss: 0.6005097

best validation loss 0.6005097145506874

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.004626800892, 'e_layers': 2, 'learning_rate': 0.0022058584169, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9524001
	speed: 0.0121s/iter; left time: 10.7108s
Updating learning rate to 0.0022058584169
Validation loss decreased (inf --> 0.6247).  Saving model state dict ...
Epoch: 1 cost time: 1.1193695068359375
Epoch: 1, Steps: 123 | Train Loss: 0.9524001 Vali Loss: 0.6246860 Best vali loss: 0.6246860
	iters: 100, epoch: 2 | loss: 0.8732345
	speed: 0.0112s/iter; left time: 8.5704s
Updating learning rate to 0.00110292920845
Validation loss decreased (0.6247 --> 0.6137).  Saving model state dict ...
Epoch: 2 cost time: 0.8817024230957031
Epoch: 2, Steps: 123 | Train Loss: 0.8732345 Vali Loss: 0.6136754 Best vali loss: 0.6136754
	iters: 100, epoch: 3 | loss: 0.6779578
	speed: 0.0119s/iter; left time: 7.6028s
Updating learning rate to 0.000551464604225
Validation loss decreased (0.6137 --> 0.6056).  Saving model state dict ...
Epoch: 3 cost time: 0.9057333469390869
Epoch: 3, Steps: 123 | Train Loss: 0.6779578 Vali Loss: 0.6056440 Best vali loss: 0.6056440
	iters: 100, epoch: 4 | loss: 1.1634884
	speed: 0.0116s/iter; left time: 5.9785s
Updating learning rate to 0.0002757323021125
Epoch: 4 cost time: 0.9237565994262695
Epoch: 4, Steps: 123 | Train Loss: 1.1634884 Vali Loss: 0.6146947 Best vali loss: 0.6056440
	iters: 100, epoch: 5 | loss: 1.0257372
	speed: 0.0086s/iter; left time: 3.3933s
Updating learning rate to 0.00013786615105625
Epoch: 5 cost time: 0.6040043830871582
Epoch: 5, Steps: 123 | Train Loss: 1.0257372 Vali Loss: 0.6095001 Best vali loss: 0.6056440
	iters: 100, epoch: 6 | loss: 0.9217154
	speed: 0.0110s/iter; left time: 2.9603s
Updating learning rate to 6.8933075528125e-05
Epoch: 6 cost time: 0.956491231918335
Epoch: 6, Steps: 123 | Train Loss: 0.9217154 Vali Loss: 0.6258388 Best vali loss: 0.6056440
	iters: 100, epoch: 7 | loss: 0.8142138
	speed: 0.0115s/iter; left time: 1.6975s
Updating learning rate to 3.44665377640625e-05
Epoch: 7 cost time: 0.9200291633605957
Epoch: 7, Steps: 123 | Train Loss: 0.8142138 Vali Loss: 0.6278311 Best vali loss: 0.6056440
	iters: 100, epoch: 8 | loss: 0.5973458
	speed: 0.0118s/iter; left time: 0.2821s
Updating learning rate to 1.723326888203125e-05
Epoch: 8 cost time: 0.8983635902404785
Epoch: 8, Steps: 123 | Train Loss: 0.5973458 Vali Loss: 0.6264031 Best vali loss: 0.6056440

best validation loss 0.6056439650935853

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9394412
	speed: 0.0104s/iter; left time: 19.3546s
	iters: 200, epoch: 1 | loss: 0.6095254
	speed: 0.0047s/iter; left time: 8.2329s
Updating learning rate to 0.0017284464069435928
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.4305827617645264
Epoch: 1, Steps: 245 | Train Loss: 0.7744833 Vali Loss: 0.6171308 Best vali loss: 0.6171308
	iters: 100, epoch: 2 | loss: 0.9086120
	speed: 0.0109s/iter; left time: 17.6240s
	iters: 200, epoch: 2 | loss: 1.0357687
	speed: 0.0043s/iter; left time: 6.4485s
Updating learning rate to 0.001533694044948534
Validation loss decreased (0.6171 --> 0.5876).  Saving model state dict ...
Epoch: 2 cost time: 1.1115198135375977
Epoch: 2, Steps: 245 | Train Loss: 0.9721904 Vali Loss: 0.5875502 Best vali loss: 0.5875502
	iters: 100, epoch: 3 | loss: 1.6747396
	speed: 0.0069s/iter; left time: 9.5081s
	iters: 200, epoch: 3 | loss: 0.6135320
	speed: 0.0043s/iter; left time: 5.4741s
Updating learning rate to 0.0012422265376940138
Epoch: 3 cost time: 0.9975502490997314
Epoch: 3, Steps: 245 | Train Loss: 1.1441358 Vali Loss: 0.6204701 Best vali loss: 0.5875502

best validation loss 0.5875501530085488

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039181470431, 'e_layers': 3, 'learning_rate': 0.00012582665, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012103765828973066
Validation loss decreased (inf --> 0.6729).  Saving model state dict ...
Epoch: 1 cost time: 0.844764232635498
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6729034 Best vali loss: 0.6729034
Updating learning rate to 0.00010739976373449315
Validation loss decreased (0.6729 --> 0.6415).  Saving model state dict ...
Epoch: 2 cost time: 0.5826199054718018
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6415093 Best vali loss: 0.6415093
Updating learning rate to 8.698921215250042e-05
Validation loss decreased (0.6415 --> 0.6291).  Saving model state dict ...
Epoch: 3 cost time: 0.6014573574066162
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6290618 Best vali loss: 0.6290618

best validation loss 0.6290617655240403

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5304448
	speed: 0.0123s/iter; left time: 22.9398s
	iters: 200, epoch: 1 | loss: 0.6314977
	speed: 0.0063s/iter; left time: 11.1241s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.6294).  Saving model state dict ...
Epoch: 1 cost time: 1.8860130310058594
Epoch: 1, Steps: 245 | Train Loss: 0.5809713 Vali Loss: 0.6294373 Best vali loss: 0.6294373
	iters: 100, epoch: 2 | loss: 0.6687557
	speed: 0.0132s/iter; left time: 21.2859s
	iters: 200, epoch: 2 | loss: 1.0127143
	speed: 0.0064s/iter; left time: 9.6576s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 1.5989906787872314
Epoch: 2, Steps: 245 | Train Loss: 0.8407350 Vali Loss: 0.6550818 Best vali loss: 0.6294373
	iters: 100, epoch: 3 | loss: 1.0067443
	speed: 0.0131s/iter; left time: 17.9728s
	iters: 200, epoch: 3 | loss: 0.8223826
	speed: 0.0065s/iter; left time: 8.2541s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 1.6287755966186523
Epoch: 3, Steps: 245 | Train Loss: 0.9145634 Vali Loss: 0.6363619 Best vali loss: 0.6294373

best validation loss 0.6294372611330483

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8141781
	speed: 0.0103s/iter; left time: 11.5689s
	iters: 200, epoch: 4 | loss: 0.5156237
	speed: 0.0052s/iter; left time: 5.3020s
Updating learning rate to 0.000898417171
Epoch: 4 cost time: 1.4900851249694824
Epoch: 4, Steps: 245 | Train Loss: 0.6649009 Vali Loss: 0.6295721 Best vali loss: 0.5875502
	iters: 100, epoch: 5 | loss: 0.8298882
	speed: 0.0086s/iter; left time: 7.5868s
	iters: 200, epoch: 5 | loss: 0.9663600
	speed: 0.0031s/iter; left time: 2.4168s
Updating learning rate to 0.0005546078043059862
Epoch: 5 cost time: 0.8046634197235107
Epoch: 5, Steps: 245 | Train Loss: 0.8981241 Vali Loss: 0.6488134 Best vali loss: 0.5875502
	iters: 100, epoch: 6 | loss: 0.7515063
	speed: 0.0078s/iter; left time: 4.9730s
	iters: 200, epoch: 6 | loss: 0.5283498
	speed: 0.0038s/iter; left time: 2.0525s
Updating learning rate to 0.000263140297051466
Epoch: 6 cost time: 0.9703295230865479
Epoch: 6, Steps: 245 | Train Loss: 0.6399281 Vali Loss: 0.6754198 Best vali loss: 0.5875502
	iters: 100, epoch: 7 | loss: 0.3799561
	speed: 0.0082s/iter; left time: 3.2102s
	iters: 200, epoch: 7 | loss: 0.6893539
	speed: 0.0037s/iter; left time: 1.0824s
Updating learning rate to 6.838793505640724e-05
Epoch: 7 cost time: 0.9694209098815918
Epoch: 7, Steps: 245 | Train Loss: 0.5346550 Vali Loss: 0.6647093 Best vali loss: 0.5875502
	iters: 100, epoch: 8 | loss: 0.5683563
	speed: 0.0078s/iter; left time: 1.1411s
	iters: 200, epoch: 8 | loss: 0.4495089
	speed: 0.0035s/iter; left time: 0.1623s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8970916271209717
Epoch: 8, Steps: 245 | Train Loss: 0.5089326 Vali Loss: 0.6718574 Best vali loss: 0.5875502

best validation loss 0.5875501530085488

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010053990878, 'e_layers': 2, 'learning_rate': 0.0004254413654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7009785
	speed: 0.0100s/iter; left time: 18.5927s
	iters: 200, epoch: 1 | loss: 0.6608922
	speed: 0.0047s/iter; left time: 8.2479s
Updating learning rate to 0.0004254413654
Validation loss decreased (inf --> 0.6009).  Saving model state dict ...
Epoch: 1 cost time: 1.4230473041534424
Epoch: 1, Steps: 245 | Train Loss: 0.6809354 Vali Loss: 0.6008588 Best vali loss: 0.6008588
	iters: 100, epoch: 2 | loss: 0.3765644
	speed: 0.0096s/iter; left time: 15.4694s
	iters: 200, epoch: 2 | loss: 0.8807611
	speed: 0.0045s/iter; left time: 6.7730s
Updating learning rate to 0.0002127206827
Epoch: 2 cost time: 1.158289909362793
Epoch: 2, Steps: 245 | Train Loss: 0.6286628 Vali Loss: 0.6017963 Best vali loss: 0.6008588
	iters: 100, epoch: 3 | loss: 0.7972597
	speed: 0.0089s/iter; left time: 12.1605s
	iters: 200, epoch: 3 | loss: 0.6581842
	speed: 0.0048s/iter; left time: 6.1079s
Updating learning rate to 0.00010636034135
Epoch: 3 cost time: 1.1955900192260742
Epoch: 3, Steps: 245 | Train Loss: 0.7277220 Vali Loss: 0.6105465 Best vali loss: 0.6008588
	iters: 100, epoch: 4 | loss: 0.7245772
	speed: 0.0095s/iter; left time: 10.7461s
	iters: 200, epoch: 4 | loss: 0.7678013
	speed: 0.0045s/iter; left time: 4.6436s
Updating learning rate to 5.3180170675e-05
Epoch: 4 cost time: 1.1674387454986572
Epoch: 4, Steps: 245 | Train Loss: 0.7461893 Vali Loss: 0.6145850 Best vali loss: 0.6008588
	iters: 100, epoch: 5 | loss: 0.8657176
	speed: 0.0094s/iter; left time: 8.3074s
	iters: 200, epoch: 5 | loss: 0.9035603
	speed: 0.0041s/iter; left time: 3.2025s
Updating learning rate to 2.65900853375e-05
Epoch: 5 cost time: 1.1050128936767578
Epoch: 5, Steps: 245 | Train Loss: 0.8846390 Vali Loss: 0.6146066 Best vali loss: 0.6008588
	iters: 100, epoch: 6 | loss: 1.0705574
	speed: 0.0095s/iter; left time: 6.0266s
	iters: 200, epoch: 6 | loss: 0.8922628
	speed: 0.0047s/iter; left time: 2.5157s
Updating learning rate to 1.329504266875e-05
Epoch: 6 cost time: 1.2424654960632324
Epoch: 6, Steps: 245 | Train Loss: 0.9814101 Vali Loss: 0.6140986 Best vali loss: 0.6008588
	iters: 100, epoch: 7 | loss: 0.8542031
	speed: 0.0099s/iter; left time: 3.8662s
	iters: 200, epoch: 7 | loss: 0.6489883
	speed: 0.0048s/iter; left time: 1.3944s
Updating learning rate to 6.647521334375e-06
Epoch: 7 cost time: 1.2139434814453125
Epoch: 7, Steps: 245 | Train Loss: 0.7515957 Vali Loss: 0.6145621 Best vali loss: 0.6008588
	iters: 100, epoch: 8 | loss: 0.7631882
	speed: 0.0090s/iter; left time: 1.3188s
	iters: 200, epoch: 8 | loss: 1.0270927
	speed: 0.0046s/iter; left time: 0.2105s
Updating learning rate to 3.3237606671875e-06
Epoch: 8 cost time: 1.1531610488891602
Epoch: 8, Steps: 245 | Train Loss: 0.8951404 Vali Loss: 0.6139698 Best vali loss: 0.6008588

best validation loss 0.6008588288294833

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0113842174153, 'e_layers': 1, 'learning_rate': 0.0018134405744, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7584117
	speed: 0.0093s/iter; left time: 72.0379s
	iters: 200, epoch: 1 | loss: 1.0837867
	speed: 0.0036s/iter; left time: 27.7990s
	iters: 300, epoch: 1 | loss: 1.3170573
	speed: 0.0036s/iter; left time: 26.8868s
	iters: 400, epoch: 1 | loss: 0.6943889
	speed: 0.0031s/iter; left time: 23.3067s
	iters: 500, epoch: 1 | loss: 0.7730120
	speed: 0.0027s/iter; left time: 19.7267s
	iters: 600, epoch: 1 | loss: 0.8581119
	speed: 0.0027s/iter; left time: 19.3226s
	iters: 700, epoch: 1 | loss: 1.3544631
	speed: 0.0027s/iter; left time: 19.1601s
	iters: 800, epoch: 1 | loss: 1.4088398
	speed: 0.0034s/iter; left time: 24.1631s
	iters: 900, epoch: 1 | loss: 1.4364223
	speed: 0.0036s/iter; left time: 24.8534s
Updating learning rate to 0.0018134405744
Validation loss decreased (inf --> 0.6467).  Saving model state dict ...
Epoch: 1 cost time: 3.4954922199249268
Epoch: 1, Steps: 979 | Train Loss: 1.0760549 Vali Loss: 0.6466931 Best vali loss: 0.6466931
	iters: 100, epoch: 2 | loss: 0.6091095
	speed: 0.0141s/iter; left time: 95.0261s
	iters: 200, epoch: 2 | loss: 0.8875582
	speed: 0.0033s/iter; left time: 21.8441s
	iters: 300, epoch: 2 | loss: 0.6466188
	speed: 0.0033s/iter; left time: 21.5252s
	iters: 400, epoch: 2 | loss: 0.6506981
	speed: 0.0033s/iter; left time: 21.2426s
	iters: 500, epoch: 2 | loss: 2.1116312
	speed: 0.0029s/iter; left time: 18.6781s
	iters: 600, epoch: 2 | loss: 0.9000413
	speed: 0.0026s/iter; left time: 16.2297s
	iters: 700, epoch: 2 | loss: 0.2862469
	speed: 0.0027s/iter; left time: 16.7331s
	iters: 800, epoch: 2 | loss: 0.9390205
	speed: 0.0028s/iter; left time: 17.1806s
	iters: 900, epoch: 2 | loss: 1.1463523
	speed: 0.0033s/iter; left time: 19.5751s
Updating learning rate to 0.0009067202872
Validation loss decreased (0.6467 --> 0.5847).  Saving model state dict ...
Epoch: 2 cost time: 3.0938053131103516
Epoch: 2, Steps: 979 | Train Loss: 0.9085863 Vali Loss: 0.5846718 Best vali loss: 0.5846718
	iters: 100, epoch: 3 | loss: 0.5987027
	speed: 0.0135s/iter; left time: 78.2428s
	iters: 200, epoch: 3 | loss: 1.1086594
	speed: 0.0033s/iter; left time: 18.7552s
	iters: 300, epoch: 3 | loss: 0.5928872
	speed: 0.0033s/iter; left time: 18.3429s
	iters: 400, epoch: 3 | loss: 0.9710010
	speed: 0.0033s/iter; left time: 18.0401s
	iters: 500, epoch: 3 | loss: 0.5959847
	speed: 0.0033s/iter; left time: 17.7550s
	iters: 600, epoch: 3 | loss: 1.0453671
	speed: 0.0029s/iter; left time: 15.2245s
	iters: 700, epoch: 3 | loss: 1.7980829
	speed: 0.0027s/iter; left time: 14.0812s
	iters: 800, epoch: 3 | loss: 0.6843312
	speed: 0.0027s/iter; left time: 13.7490s
	iters: 900, epoch: 3 | loss: 1.1551108
	speed: 0.0030s/iter; left time: 14.8918s
Updating learning rate to 0.0004533601436
Validation loss decreased (0.5847 --> 0.5807).  Saving model state dict ...
Epoch: 3 cost time: 3.1048264503479004
Epoch: 3, Steps: 979 | Train Loss: 0.9500141 Vali Loss: 0.5807126 Best vali loss: 0.5807126
	iters: 100, epoch: 4 | loss: 0.4964791
	speed: 0.0144s/iter; left time: 69.0338s
	iters: 200, epoch: 4 | loss: 1.3356310
	speed: 0.0037s/iter; left time: 17.3427s
	iters: 300, epoch: 4 | loss: 0.2933791
	speed: 0.0036s/iter; left time: 16.3512s
	iters: 400, epoch: 4 | loss: 0.3676149
	speed: 0.0037s/iter; left time: 16.4486s
	iters: 500, epoch: 4 | loss: 0.7518328
	speed: 0.0037s/iter; left time: 16.1477s
	iters: 600, epoch: 4 | loss: 0.4110796
	speed: 0.0036s/iter; left time: 15.4403s
	iters: 700, epoch: 4 | loss: 0.4554754
	speed: 0.0029s/iter; left time: 12.2099s
	iters: 800, epoch: 4 | loss: 0.8020997
	speed: 0.0027s/iter; left time: 11.0800s
	iters: 900, epoch: 4 | loss: 0.9708830
	speed: 0.0028s/iter; left time: 10.9898s
Updating learning rate to 0.0002266800718
Epoch: 4 cost time: 3.2708094120025635
Epoch: 4, Steps: 979 | Train Loss: 0.6538305 Vali Loss: 0.5958964 Best vali loss: 0.5807126
	iters: 100, epoch: 5 | loss: 0.8589917
	speed: 0.0090s/iter; left time: 34.5331s
	iters: 200, epoch: 5 | loss: 0.8996664
	speed: 0.0038s/iter; left time: 14.1123s
	iters: 300, epoch: 5 | loss: 0.3661706
	speed: 0.0035s/iter; left time: 12.7006s
	iters: 400, epoch: 5 | loss: 1.1354368
	speed: 0.0036s/iter; left time: 12.5595s
	iters: 500, epoch: 5 | loss: 0.8607676
	speed: 0.0033s/iter; left time: 11.4157s
	iters: 600, epoch: 5 | loss: 0.8520684
	speed: 0.0035s/iter; left time: 11.6244s
	iters: 700, epoch: 5 | loss: 1.4339676
	speed: 0.0034s/iter; left time: 10.9681s
	iters: 800, epoch: 5 | loss: 0.9376504
	speed: 0.0026s/iter; left time: 8.1566s
	iters: 900, epoch: 5 | loss: 0.6254026
	speed: 0.0027s/iter; left time: 8.0916s
Updating learning rate to 0.0001133400359
Epoch: 5 cost time: 3.1824443340301514
Epoch: 5, Steps: 979 | Train Loss: 0.8855691 Vali Loss: 0.5858504 Best vali loss: 0.5807126
	iters: 100, epoch: 6 | loss: 0.7096080
	speed: 0.0146s/iter; left time: 41.4583s
	iters: 200, epoch: 6 | loss: 1.0383046
	speed: 0.0042s/iter; left time: 11.6325s
	iters: 300, epoch: 6 | loss: 0.3097647
	speed: 0.0034s/iter; left time: 8.8755s
	iters: 400, epoch: 6 | loss: 0.5518014
	speed: 0.0043s/iter; left time: 10.9664s
	iters: 500, epoch: 6 | loss: 0.4746187
	speed: 0.0040s/iter; left time: 9.8006s
	iters: 600, epoch: 6 | loss: 0.4544873
	speed: 0.0028s/iter; left time: 6.4832s
	iters: 700, epoch: 6 | loss: 0.9073927
	speed: 0.0025s/iter; left time: 5.5382s
	iters: 800, epoch: 6 | loss: 1.1085141
	speed: 0.0026s/iter; left time: 5.5087s
	iters: 900, epoch: 6 | loss: 0.6501168
	speed: 0.0033s/iter; left time: 6.6480s
Updating learning rate to 5.667001795e-05
Epoch: 6 cost time: 3.462911367416382
Epoch: 6, Steps: 979 | Train Loss: 0.6894009 Vali Loss: 0.5850844 Best vali loss: 0.5807126
	iters: 100, epoch: 7 | loss: 1.0461875
	speed: 0.0156s/iter; left time: 28.9448s
	iters: 200, epoch: 7 | loss: 0.2596434
	speed: 0.0043s/iter; left time: 7.5271s
	iters: 300, epoch: 7 | loss: 0.6063083
	speed: 0.0038s/iter; left time: 6.3307s
	iters: 400, epoch: 7 | loss: 0.5559909
	speed: 0.0030s/iter; left time: 4.6758s
	iters: 500, epoch: 7 | loss: 1.8279536
	speed: 0.0037s/iter; left time: 5.3341s
	iters: 600, epoch: 7 | loss: 0.4235749
	speed: 0.0041s/iter; left time: 5.5106s
	iters: 700, epoch: 7 | loss: 0.6714557
	speed: 0.0041s/iter; left time: 5.1951s
	iters: 800, epoch: 7 | loss: 1.0197628
	speed: 0.0035s/iter; left time: 4.0353s
	iters: 900, epoch: 7 | loss: 1.1940567
	speed: 0.0027s/iter; left time: 2.8389s
Updating learning rate to 2.8335008975e-05
Epoch: 7 cost time: 3.570319652557373
Epoch: 7, Steps: 979 | Train Loss: 0.8449926 Vali Loss: 0.5928452 Best vali loss: 0.5807126
	iters: 100, epoch: 8 | loss: 0.4318188
	speed: 0.0109s/iter; left time: 9.5833s
	iters: 200, epoch: 8 | loss: 0.6509242
	speed: 0.0039s/iter; left time: 3.0477s
	iters: 300, epoch: 8 | loss: 0.8570777
	speed: 0.0038s/iter; left time: 2.5599s
	iters: 400, epoch: 8 | loss: 0.3733908
	speed: 0.0043s/iter; left time: 2.4700s
	iters: 500, epoch: 8 | loss: 0.6193485
	speed: 0.0036s/iter; left time: 1.7457s
	iters: 600, epoch: 8 | loss: 1.0235531
	speed: 0.0039s/iter; left time: 1.4710s
	iters: 700, epoch: 8 | loss: 0.8260942
	speed: 0.0039s/iter; left time: 1.0919s
	iters: 800, epoch: 8 | loss: 0.4069418
	speed: 0.0041s/iter; left time: 0.7313s
	iters: 900, epoch: 8 | loss: 0.9978020
	speed: 0.0039s/iter; left time: 0.3084s
Updating learning rate to 1.41675044875e-05
Epoch: 8 cost time: 3.8740694522857666
Epoch: 8, Steps: 979 | Train Loss: 0.6874390 Vali Loss: 0.5884717 Best vali loss: 0.5807126

best validation loss 0.5807125919784235

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014152615275, 'e_layers': 1, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.6603).  Saving model state dict ...
Epoch: 1 cost time: 0.8156533241271973
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6602601 Best vali loss: 0.6602601
Updating learning rate to 0.0002257411363
Validation loss decreased (0.6603 --> 0.6267).  Saving model state dict ...
Epoch: 2 cost time: 0.5498018264770508
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6266590 Best vali loss: 0.6266590
Updating learning rate to 0.00011287056815
Validation loss decreased (0.6267 --> 0.6200).  Saving model state dict ...
Epoch: 3 cost time: 0.5730018615722656
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6199643 Best vali loss: 0.6199643

best validation loss 0.6199642525454022

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0366331
	speed: 0.0121s/iter; left time: 10.7504s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.6089).  Saving model state dict ...
Epoch: 1 cost time: 1.0582103729248047
Epoch: 1, Steps: 123 | Train Loss: 1.0366331 Vali Loss: 0.6089155 Best vali loss: 0.6089155
	iters: 100, epoch: 2 | loss: 0.6541998
	speed: 0.0106s/iter; left time: 8.0730s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.6089 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 0.802091121673584
Epoch: 2, Steps: 123 | Train Loss: 0.6541998 Vali Loss: 0.6069120 Best vali loss: 0.6069120
	iters: 100, epoch: 3 | loss: 0.7972841
	speed: 0.0110s/iter; left time: 7.0378s
Updating learning rate to 1.70765195e-05
Validation loss decreased (0.6069 --> 0.6030).  Saving model state dict ...
Epoch: 3 cost time: 0.8142361640930176
Epoch: 3, Steps: 123 | Train Loss: 0.7972841 Vali Loss: 0.6030117 Best vali loss: 0.6030117

best validation loss 0.6030116897664209

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014438416367, 'e_layers': 1, 'learning_rate': 0.000558760672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6920349
	speed: 0.0105s/iter; left time: 19.6237s
	iters: 200, epoch: 1 | loss: 1.3515167
	speed: 0.0045s/iter; left time: 7.9509s
Updating learning rate to 0.0005374941102165261
Validation loss decreased (inf --> 0.6149).  Saving model state dict ...
Epoch: 1 cost time: 1.4552106857299805
Epoch: 1, Steps: 245 | Train Loss: 1.0217758 Vali Loss: 0.6149432 Best vali loss: 0.6149432
	iters: 100, epoch: 2 | loss: 0.8714641
	speed: 0.0109s/iter; left time: 17.6038s
	iters: 200, epoch: 2 | loss: 0.3793433
	speed: 0.0047s/iter; left time: 7.1599s
Updating learning rate to 0.00047693206611577606
Epoch: 2 cost time: 1.2214438915252686
Epoch: 2, Steps: 245 | Train Loss: 0.6254037 Vali Loss: 0.6338814 Best vali loss: 0.6149432
	iters: 100, epoch: 3 | loss: 1.0114591
	speed: 0.0108s/iter; left time: 14.7471s
	iters: 200, epoch: 3 | loss: 0.8901668
	speed: 0.0045s/iter; left time: 5.7519s
Updating learning rate to 0.000386294561915792
Epoch: 3 cost time: 1.2198550701141357
Epoch: 3, Steps: 245 | Train Loss: 0.9508129 Vali Loss: 0.6242000 Best vali loss: 0.6149432

best validation loss 0.6149431942293678

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0140613
	speed: 0.0100s/iter; left time: 5.1826s
Updating learning rate to 8.53825975e-06
Validation loss decreased (0.6030 --> 0.6028).  Saving model state dict ...
Epoch: 4 cost time: 0.7698009014129639
Epoch: 4, Steps: 123 | Train Loss: 1.0140613 Vali Loss: 0.6028259 Best vali loss: 0.6028259
	iters: 100, epoch: 5 | loss: 0.6503785
	speed: 0.0086s/iter; left time: 3.3745s
Updating learning rate to 4.269129875e-06
Epoch: 5 cost time: 0.6977455615997314
Epoch: 5, Steps: 123 | Train Loss: 0.6503785 Vali Loss: 0.6050870 Best vali loss: 0.6028259
	iters: 100, epoch: 6 | loss: 0.7845382
	speed: 0.0094s/iter; left time: 2.5394s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 0.7358925342559814
Epoch: 6, Steps: 123 | Train Loss: 0.7845382 Vali Loss: 0.6049494 Best vali loss: 0.6028259
	iters: 100, epoch: 7 | loss: 1.0978216
	speed: 0.0099s/iter; left time: 1.4482s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 0.7597343921661377
Epoch: 7, Steps: 123 | Train Loss: 1.0978216 Vali Loss: 0.6051946 Best vali loss: 0.6028259
	iters: 100, epoch: 8 | loss: 0.6612026
	speed: 0.0103s/iter; left time: 0.2475s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 0.79386305809021
Epoch: 8, Steps: 123 | Train Loss: 0.6612026 Vali Loss: 0.6052301 Best vali loss: 0.6028259

best validation loss 0.6028258996890243

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0079026385404, 'e_layers': 2, 'learning_rate': 0.0022201950658, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9660220
	speed: 0.0112s/iter; left time: 20.8031s
	iters: 200, epoch: 1 | loss: 0.9020447
	speed: 0.0047s/iter; left time: 8.3057s
Updating learning rate to 0.0022201950658
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.5024008750915527
Epoch: 1, Steps: 245 | Train Loss: 0.9340334 Vali Loss: 0.6040087 Best vali loss: 0.6040087
	iters: 100, epoch: 2 | loss: 1.0952461
	speed: 0.0090s/iter; left time: 14.6114s
	iters: 200, epoch: 2 | loss: 0.5863059
	speed: 0.0056s/iter; left time: 8.5439s
Updating learning rate to 0.0011100975329
Epoch: 2 cost time: 1.3821520805358887
Epoch: 2, Steps: 245 | Train Loss: 0.8407760 Vali Loss: 0.6081345 Best vali loss: 0.6040087
	iters: 100, epoch: 3 | loss: 0.9699066
	speed: 0.0120s/iter; left time: 16.4899s
	iters: 200, epoch: 3 | loss: 1.0216160
	speed: 0.0051s/iter; left time: 6.5352s
Updating learning rate to 0.00055504876645
Epoch: 3 cost time: 1.3107495307922363
Epoch: 3, Steps: 245 | Train Loss: 0.9957613 Vali Loss: 0.6739932 Best vali loss: 0.6040087
	iters: 100, epoch: 4 | loss: 0.5371025
	speed: 0.0115s/iter; left time: 12.9786s
	iters: 200, epoch: 4 | loss: 0.7862545
	speed: 0.0055s/iter; left time: 5.6824s
Updating learning rate to 0.000277524383225
Epoch: 4 cost time: 1.362778663635254
Epoch: 4, Steps: 245 | Train Loss: 0.6616785 Vali Loss: 0.6375329 Best vali loss: 0.6040087
	iters: 100, epoch: 5 | loss: 0.5398117
	speed: 0.0116s/iter; left time: 10.2154s
	iters: 200, epoch: 5 | loss: 0.5553857
	speed: 0.0051s/iter; left time: 3.9645s
Updating learning rate to 0.0001387621916125
Epoch: 5 cost time: 1.3612291812896729
Epoch: 5, Steps: 245 | Train Loss: 0.5475987 Vali Loss: 0.6623029 Best vali loss: 0.6040087
	iters: 100, epoch: 6 | loss: 1.0712121
	speed: 0.0112s/iter; left time: 7.1133s
	iters: 200, epoch: 6 | loss: 0.5165262
	speed: 0.0056s/iter; left time: 2.9963s
Updating learning rate to 6.938109580625e-05
Epoch: 6 cost time: 1.3744323253631592
Epoch: 6, Steps: 245 | Train Loss: 0.7938691 Vali Loss: 0.6423522 Best vali loss: 0.6040087
	iters: 100, epoch: 7 | loss: 0.4137741
	speed: 0.0117s/iter; left time: 4.5849s
	iters: 200, epoch: 7 | loss: 0.8540576
	speed: 0.0052s/iter; left time: 1.5130s
Updating learning rate to 3.4690547903125e-05
Epoch: 7 cost time: 1.3231146335601807
Epoch: 7, Steps: 245 | Train Loss: 0.6339159 Vali Loss: 0.6453954 Best vali loss: 0.6040087
	iters: 100, epoch: 8 | loss: 0.9190345
	speed: 0.0087s/iter; left time: 1.2770s
	iters: 200, epoch: 8 | loss: 0.5188770
	speed: 0.0052s/iter; left time: 0.2392s
Updating learning rate to 1.73452739515625e-05
Epoch: 8 cost time: 1.2214734554290771
Epoch: 8, Steps: 245 | Train Loss: 0.7189558 Vali Loss: 0.6506783 Best vali loss: 0.6040087

best validation loss 0.6040086972939642

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027523638828, 'e_layers': 2, 'learning_rate': 0.0003512624633, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003378933318411835
Validation loss decreased (inf --> 0.6664).  Saving model state dict ...
Epoch: 1 cost time: 0.7459235191345215
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6663814 Best vali loss: 0.6663814
Updating learning rate to 0.0002998212665378604
Validation loss decreased (0.6664 --> 0.6384).  Saving model state dict ...
Epoch: 2 cost time: 0.522951602935791
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6384326 Best vali loss: 0.6384326
Updating learning rate to 0.0002428423942083302
Validation loss decreased (0.6384 --> 0.6262).  Saving model state dict ...
Epoch: 3 cost time: 0.6718151569366455
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6261585 Best vali loss: 0.6261585
Updating learning rate to 0.00017563123165
Validation loss decreased (0.6262 --> 0.6165).  Saving model state dict ...
Epoch: 4 cost time: 0.5025539398193359
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6164508 Best vali loss: 0.6164508
Updating learning rate to 0.00010842006909166983
Validation loss decreased (0.6165 --> 0.6146).  Saving model state dict ...
Epoch: 5 cost time: 0.5029275417327881
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6145596 Best vali loss: 0.6145596
Updating learning rate to 5.144119676213962e-05
Validation loss decreased (0.6146 --> 0.6124).  Saving model state dict ...
Epoch: 6 cost time: 0.5263168811798096
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6123517 Best vali loss: 0.6123517
Updating learning rate to 1.3369131458816492e-05
Validation loss decreased (0.6124 --> 0.6116).  Saving model state dict ...
Epoch: 7 cost time: 0.5167701244354248
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6116121 Best vali loss: 0.6116121
Updating learning rate to 0.0
Validation loss decreased (0.6116 --> 0.6114).  Saving model state dict ...
Epoch: 8 cost time: 0.5080275535583496
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6113793 Best vali loss: 0.6113793

best validation loss 0.6113793455798667

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1740562
	speed: 0.0109s/iter; left time: 41.5207s
	iters: 200, epoch: 1 | loss: 1.1978114
	speed: 0.0056s/iter; left time: 20.7097s
	iters: 300, epoch: 1 | loss: 0.6273263
	speed: 0.0056s/iter; left time: 20.2941s
	iters: 400, epoch: 1 | loss: 1.1035664
	speed: 0.0053s/iter; left time: 18.6728s
Updating learning rate to 9.34698808e-05
Validation loss decreased (inf --> 0.5997).  Saving model state dict ...
Epoch: 1 cost time: 2.961458683013916
Epoch: 1, Steps: 490 | Train Loss: 1.0256901 Vali Loss: 0.5996911 Best vali loss: 0.5996911
	iters: 100, epoch: 2 | loss: 0.8819800
	speed: 0.0140s/iter; left time: 46.5976s
	iters: 200, epoch: 2 | loss: 0.8823318
	speed: 0.0033s/iter; left time: 10.6805s
	iters: 300, epoch: 2 | loss: 0.9039207
	speed: 0.0041s/iter; left time: 12.9435s
	iters: 400, epoch: 2 | loss: 1.0277607
	speed: 0.0049s/iter; left time: 14.8554s
Updating learning rate to 4.67349404e-05
Validation loss decreased (0.5997 --> 0.5850).  Saving model state dict ...
Epoch: 2 cost time: 2.1130878925323486
Epoch: 2, Steps: 490 | Train Loss: 0.9239983 Vali Loss: 0.5850183 Best vali loss: 0.5850183
	iters: 100, epoch: 3 | loss: 0.5545235
	speed: 0.0148s/iter; left time: 42.0514s
	iters: 200, epoch: 3 | loss: 0.6562951
	speed: 0.0037s/iter; left time: 10.0672s
	iters: 300, epoch: 3 | loss: 0.3734279
	speed: 0.0033s/iter; left time: 8.7097s
	iters: 400, epoch: 3 | loss: 0.6900953
	speed: 0.0040s/iter; left time: 10.0826s
Updating learning rate to 2.33674702e-05
Epoch: 3 cost time: 2.119751214981079
Epoch: 3, Steps: 490 | Train Loss: 0.5685855 Vali Loss: 0.6208820 Best vali loss: 0.5850183

best validation loss 0.5850183171621355

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2042421
	speed: 0.0126s/iter; left time: 48.1133s
	iters: 200, epoch: 1 | loss: 0.3855742
	speed: 0.0068s/iter; left time: 25.3893s
	iters: 300, epoch: 1 | loss: 0.5746676
	speed: 0.0068s/iter; left time: 24.7309s
	iters: 400, epoch: 1 | loss: 1.0443676
	speed: 0.0067s/iter; left time: 23.4811s
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.5985).  Saving model state dict ...
Epoch: 1 cost time: 3.692182779312134
Epoch: 1, Steps: 490 | Train Loss: 0.8022129 Vali Loss: 0.5985390 Best vali loss: 0.5985390
	iters: 100, epoch: 2 | loss: 1.9946237
	speed: 0.0192s/iter; left time: 63.9161s
	iters: 200, epoch: 2 | loss: 0.8799880
	speed: 0.0069s/iter; left time: 22.2722s
	iters: 300, epoch: 2 | loss: 0.8482473
	speed: 0.0069s/iter; left time: 21.5356s
	iters: 400, epoch: 2 | loss: 0.5518042
	speed: 0.0073s/iter; left time: 22.2217s
Updating learning rate to 0.00034048964815
Epoch: 2 cost time: 3.462407112121582
Epoch: 2, Steps: 490 | Train Loss: 1.0686658 Vali Loss: 0.5995943 Best vali loss: 0.5985390
	iters: 100, epoch: 3 | loss: 0.9125831
	speed: 0.0185s/iter; left time: 52.6412s
	iters: 200, epoch: 3 | loss: 0.6522782
	speed: 0.0068s/iter; left time: 18.5705s
	iters: 300, epoch: 3 | loss: 0.7498344
	speed: 0.0070s/iter; left time: 18.4928s
	iters: 400, epoch: 3 | loss: 0.5275347
	speed: 0.0071s/iter; left time: 18.0999s
Updating learning rate to 0.000170244824075
Validation loss decreased (0.5985 --> 0.5673).  Saving model state dict ...
Epoch: 3 cost time: 3.4335227012634277
Epoch: 3, Steps: 490 | Train Loss: 0.7105576 Vali Loss: 0.5673004 Best vali loss: 0.5673004

best validation loss 0.5673003665334039

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0047262361197, 'e_layers': 2, 'learning_rate': 5.5626136e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.5626136e-05
Validation loss decreased (inf --> 0.6618).  Saving model state dict ...
Epoch: 1 cost time: 0.6856184005737305
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6617667 Best vali loss: 0.6617667
Updating learning rate to 2.7813068e-05
Validation loss decreased (0.6618 --> 0.6294).  Saving model state dict ...
Epoch: 2 cost time: 0.5600676536560059
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6294398 Best vali loss: 0.6294398
Updating learning rate to 1.3906534e-05
Validation loss decreased (0.6294 --> 0.6205).  Saving model state dict ...
Epoch: 3 cost time: 0.5576329231262207
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6205024 Best vali loss: 0.6205024

best validation loss 0.6205023785312658

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0241462
	speed: 0.0129s/iter; left time: 30.2355s
	iters: 200, epoch: 4 | loss: 0.3119469
	speed: 0.0071s/iter; left time: 16.0709s
	iters: 300, epoch: 4 | loss: 0.4976002
	speed: 0.0072s/iter; left time: 15.5034s
	iters: 400, epoch: 4 | loss: 0.8459934
	speed: 0.0071s/iter; left time: 14.4677s
Updating learning rate to 8.51224120375e-05
Validation loss decreased (0.5673 --> 0.5506).  Saving model state dict ...
Epoch: 4 cost time: 3.662058115005493
Epoch: 4, Steps: 490 | Train Loss: 0.6699217 Vali Loss: 0.5505865 Best vali loss: 0.5505865
	iters: 100, epoch: 5 | loss: 1.3421296
	speed: 0.0162s/iter; left time: 30.1052s
	iters: 200, epoch: 5 | loss: 0.8237901
	speed: 0.0072s/iter; left time: 12.6449s
	iters: 300, epoch: 5 | loss: 0.8102024
	speed: 0.0071s/iter; left time: 11.7801s
	iters: 400, epoch: 5 | loss: 0.5120167
	speed: 0.0068s/iter; left time: 10.5523s
Updating learning rate to 4.256120601875e-05
Epoch: 5 cost time: 3.4376139640808105
Epoch: 5, Steps: 490 | Train Loss: 0.8720347 Vali Loss: 0.5566992 Best vali loss: 0.5505865
	iters: 100, epoch: 6 | loss: 0.6868811
	speed: 0.0192s/iter; left time: 26.3158s
	iters: 200, epoch: 6 | loss: 0.6257582
	speed: 0.0069s/iter; left time: 8.8266s
	iters: 300, epoch: 6 | loss: 0.7078272
	speed: 0.0068s/iter; left time: 7.9620s
	iters: 400, epoch: 6 | loss: 0.4789426
	speed: 0.0070s/iter; left time: 7.4761s
Updating learning rate to 2.1280603009375e-05
Epoch: 6 cost time: 3.46307635307312
Epoch: 6, Steps: 490 | Train Loss: 0.6248523 Vali Loss: 0.5560498 Best vali loss: 0.5505865
	iters: 100, epoch: 7 | loss: 0.7994286
	speed: 0.0186s/iter; left time: 16.3957s
	iters: 200, epoch: 7 | loss: 0.2902839
	speed: 0.0069s/iter; left time: 5.4057s
	iters: 300, epoch: 7 | loss: 0.8012778
	speed: 0.0071s/iter; left time: 4.8585s
	iters: 400, epoch: 7 | loss: 0.8068563
	speed: 0.0069s/iter; left time: 4.0109s
Updating learning rate to 1.06403015046875e-05
Epoch: 7 cost time: 3.4582064151763916
Epoch: 7, Steps: 490 | Train Loss: 0.6744616 Vali Loss: 0.5560592 Best vali loss: 0.5505865
	iters: 100, epoch: 8 | loss: 0.7688867
	speed: 0.0191s/iter; left time: 7.4499s
	iters: 200, epoch: 8 | loss: 1.0791886
	speed: 0.0068s/iter; left time: 1.9805s
	iters: 300, epoch: 8 | loss: 0.7168204
	speed: 0.0068s/iter; left time: 1.2919s
	iters: 400, epoch: 8 | loss: 0.6244248
	speed: 0.0066s/iter; left time: 0.6021s
Updating learning rate to 5.32015075234375e-06
Epoch: 8 cost time: 3.353102922439575
Epoch: 8, Steps: 490 | Train Loss: 0.7973301 Vali Loss: 0.5559387 Best vali loss: 0.5505865

best validation loss 0.5505864805007963

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002399800657, 'e_layers': 3, 'learning_rate': 5.41855407e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.41855407e-05
Validation loss decreased (inf --> 0.7050).  Saving model state dict ...
Epoch: 1 cost time: 0.7419369220733643
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7049747 Best vali loss: 0.7049747
Updating learning rate to 2.709277035e-05
Validation loss decreased (0.7050 --> 0.6941).  Saving model state dict ...
Epoch: 2 cost time: 0.6033327579498291
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6940604 Best vali loss: 0.6940604
Updating learning rate to 1.3546385175e-05
Validation loss decreased (0.6941 --> 0.6889).  Saving model state dict ...
Epoch: 3 cost time: 0.595996618270874
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6888544 Best vali loss: 0.6888544
Updating learning rate to 6.7731925875e-06
Validation loss decreased (0.6889 --> 0.6864).  Saving model state dict ...
Epoch: 4 cost time: 0.598017692565918
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6864056 Best vali loss: 0.6864056
Updating learning rate to 3.38659629375e-06
Validation loss decreased (0.6864 --> 0.6852).  Saving model state dict ...
Epoch: 5 cost time: 0.5906569957733154
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6852221 Best vali loss: 0.6852221
Updating learning rate to 1.693298146875e-06
Validation loss decreased (0.6852 --> 0.6846).  Saving model state dict ...
Epoch: 6 cost time: 0.6048319339752197
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6846244 Best vali loss: 0.6846244
Updating learning rate to 8.466490734375e-07
Validation loss decreased (0.6846 --> 0.6843).  Saving model state dict ...
Epoch: 7 cost time: 0.6125106811523438
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6843317 Best vali loss: 0.6843317
Updating learning rate to 4.2332453671875e-07
Validation loss decreased (0.6843 --> 0.6842).  Saving model state dict ...
Epoch: 8 cost time: 0.6122934818267822
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6841823 Best vali loss: 0.6841823

best validation loss 0.6841822911721035

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016060344052, 'e_layers': 3, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6639593
	speed: 0.0145s/iter; left time: 26.9361s
	iters: 200, epoch: 1 | loss: 0.8535681
	speed: 0.0048s/iter; left time: 8.4354s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 1.8807101249694824
Epoch: 1, Steps: 245 | Train Loss: 0.7587637 Vali Loss: 0.6140098 Best vali loss: 0.6140098
	iters: 100, epoch: 2 | loss: 0.6790031
	speed: 0.0119s/iter; left time: 19.2510s
	iters: 200, epoch: 2 | loss: 0.7351314
	speed: 0.0065s/iter; left time: 9.8659s
Updating learning rate to 0.00037646055854993277
Epoch: 2 cost time: 1.690676212310791
Epoch: 2, Steps: 245 | Train Loss: 0.7070672 Vali Loss: 0.6828928 Best vali loss: 0.6140098
	iters: 100, epoch: 3 | loss: 0.8068680
	speed: 0.0136s/iter; left time: 18.6015s
	iters: 200, epoch: 3 | loss: 0.6656123
	speed: 0.0065s/iter; left time: 8.2917s
Updating learning rate to 0.00030491694074585157
Validation loss decreased (0.6140 --> 0.6047).  Saving model state dict ...
Epoch: 3 cost time: 1.6096727848052979
Epoch: 3, Steps: 245 | Train Loss: 0.7362402 Vali Loss: 0.6047032 Best vali loss: 0.6047032
	iters: 100, epoch: 4 | loss: 0.8655283
	speed: 0.0109s/iter; left time: 12.2968s
	iters: 200, epoch: 4 | loss: 0.8601351
	speed: 0.0063s/iter; left time: 6.4492s
Updating learning rate to 0.0002205254895
Validation loss decreased (0.6047 --> 0.5356).  Saving model state dict ...
Epoch: 4 cost time: 1.5991625785827637
Epoch: 4, Steps: 245 | Train Loss: 0.8628317 Vali Loss: 0.5356371 Best vali loss: 0.5356371
	iters: 100, epoch: 5 | loss: 0.5973833
	speed: 0.0145s/iter; left time: 12.7331s
	iters: 200, epoch: 5 | loss: 0.6516000
	speed: 0.0058s/iter; left time: 4.5427s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.572413444519043
Epoch: 5, Steps: 245 | Train Loss: 0.6244916 Vali Loss: 0.5374324 Best vali loss: 0.5356371
	iters: 100, epoch: 6 | loss: 0.9142206
	speed: 0.0120s/iter; left time: 7.6306s
	iters: 200, epoch: 6 | loss: 0.4888127
	speed: 0.0066s/iter; left time: 3.5108s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 1.6919548511505127
Epoch: 6, Steps: 245 | Train Loss: 0.7015166 Vali Loss: 0.5557638 Best vali loss: 0.5356371
	iters: 100, epoch: 7 | loss: 0.7461542
	speed: 0.0135s/iter; left time: 5.2857s
	iters: 200, epoch: 7 | loss: 0.7973536
	speed: 0.0067s/iter; left time: 1.9369s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 1.6994826793670654
Epoch: 7, Steps: 245 | Train Loss: 0.7717539 Vali Loss: 0.5669678 Best vali loss: 0.5356371
	iters: 100, epoch: 8 | loss: 0.5054745
	speed: 0.0135s/iter; left time: 1.9644s
	iters: 200, epoch: 8 | loss: 0.6621027
	speed: 0.0045s/iter; left time: 0.2079s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3578484058380127
Epoch: 8, Steps: 245 | Train Loss: 0.5837886 Vali Loss: 0.5692674 Best vali loss: 0.5356371

best validation loss 0.5356371417358925

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047364814747, 'e_layers': 3, 'learning_rate': 0.0010075758554, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2034616
	speed: 0.0131s/iter; left time: 24.3759s
	iters: 200, epoch: 1 | loss: 0.7864718
	speed: 0.0074s/iter; left time: 12.9618s
Updating learning rate to 0.000969227282828306
Validation loss decreased (inf --> 0.6540).  Saving model state dict ...
Epoch: 1 cost time: 2.1181440353393555
Epoch: 1, Steps: 245 | Train Loss: 0.9949667 Vali Loss: 0.6539882 Best vali loss: 0.6539882
	iters: 100, epoch: 2 | loss: 0.7707129
	speed: 0.0147s/iter; left time: 23.7743s
	iters: 200, epoch: 2 | loss: 1.2606068
	speed: 0.0075s/iter; left time: 11.3909s
Updating learning rate to 0.0008600197876565881
Validation loss decreased (0.6540 --> 0.6316).  Saving model state dict ...
Epoch: 2 cost time: 1.8826124668121338
Epoch: 2, Steps: 245 | Train Loss: 1.0156598 Vali Loss: 0.6315617 Best vali loss: 0.6315617
	iters: 100, epoch: 3 | loss: 0.9593814
	speed: 0.0147s/iter; left time: 20.1806s
	iters: 200, epoch: 3 | loss: 1.1422479
	speed: 0.0074s/iter; left time: 9.4596s
Updating learning rate to 0.0006965792210563318
Epoch: 3 cost time: 1.880469560623169
Epoch: 3, Steps: 245 | Train Loss: 1.0508147 Vali Loss: 0.6317101 Best vali loss: 0.6315617

best validation loss 0.6315616729468011

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 0.0001461940837, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0217180
	speed: 0.0110s/iter; left time: 9.7629s
Updating learning rate to 0.0001461940837
Validation loss decreased (inf --> 0.6438).  Saving model state dict ...
Epoch: 1 cost time: 0.97031569480896
Epoch: 1, Steps: 123 | Train Loss: 1.0217180 Vali Loss: 0.6438304 Best vali loss: 0.6438304
	iters: 100, epoch: 2 | loss: 0.8586525
	speed: 0.0101s/iter; left time: 7.6681s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.6438 --> 0.6232).  Saving model state dict ...
Epoch: 2 cost time: 0.853360652923584
Epoch: 2, Steps: 123 | Train Loss: 0.8586525 Vali Loss: 0.6231898 Best vali loss: 0.6231898
	iters: 100, epoch: 3 | loss: 0.8987871
	speed: 0.0097s/iter; left time: 6.2155s
Updating learning rate to 3.6548520925e-05
Validation loss decreased (0.6232 --> 0.6159).  Saving model state dict ...
Epoch: 3 cost time: 0.7879512310028076
Epoch: 3, Steps: 123 | Train Loss: 0.8987871 Vali Loss: 0.6159360 Best vali loss: 0.6159360

best validation loss 0.6159359957541872

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0297775
	speed: 0.0089s/iter; left time: 7.8775s
Updating learning rate to 0.0017032495860327328
Validation loss decreased (inf --> 0.6123).  Saving model state dict ...
Epoch: 1 cost time: 0.7133078575134277
Epoch: 1, Steps: 123 | Train Loss: 1.0297775 Vali Loss: 0.6122975 Best vali loss: 0.6122975
	iters: 100, epoch: 2 | loss: 0.8511786
	speed: 0.0065s/iter; left time: 4.9284s
Updating learning rate to 0.001511336270922462
Validation loss decreased (0.6123 --> 0.6027).  Saving model state dict ...
Epoch: 2 cost time: 0.5063319206237793
Epoch: 2, Steps: 123 | Train Loss: 0.8511786 Vali Loss: 0.6027492 Best vali loss: 0.6027492
	iters: 100, epoch: 3 | loss: 0.6749825
	speed: 0.0070s/iter; left time: 4.4790s
Updating learning rate to 0.0012241176975961933
Validation loss decreased (0.6027 --> 0.5894).  Saving model state dict ...
Epoch: 3 cost time: 0.5304701328277588
Epoch: 3, Steps: 123 | Train Loss: 0.6749825 Vali Loss: 0.5893820 Best vali loss: 0.5893820

best validation loss 0.5893819629732298

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9781250
	speed: 0.0093s/iter; left time: 4.8095s
Updating learning rate to 0.0008853202902
Epoch: 4 cost time: 0.730311393737793
Epoch: 4, Steps: 123 | Train Loss: 0.9781250 Vali Loss: 0.6236107 Best vali loss: 0.5893820
	iters: 100, epoch: 5 | loss: 0.7803482
	speed: 0.0068s/iter; left time: 2.6851s
Updating learning rate to 0.0005465228828038066
Epoch: 5 cost time: 0.5246901512145996
Epoch: 5, Steps: 123 | Train Loss: 0.7803482 Vali Loss: 0.6203498 Best vali loss: 0.5893820
	iters: 100, epoch: 6 | loss: 0.6572651
	speed: 0.0071s/iter; left time: 1.9139s
Updating learning rate to 0.0002593043094775379
Epoch: 6 cost time: 0.5100886821746826
Epoch: 6, Steps: 123 | Train Loss: 0.6572651 Vali Loss: 0.6053112 Best vali loss: 0.5893820
	iters: 100, epoch: 7 | loss: 0.9545114
	speed: 0.0068s/iter; left time: 0.9989s
Updating learning rate to 6.739099436726728e-05
Epoch: 7 cost time: 0.5183358192443848
Epoch: 7, Steps: 123 | Train Loss: 0.9545114 Vali Loss: 0.6230699 Best vali loss: 0.5893820
	iters: 100, epoch: 8 | loss: 0.4991679
	speed: 0.0067s/iter; left time: 0.1603s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5204243659973145
Epoch: 8, Steps: 123 | Train Loss: 0.4991679 Vali Loss: 0.6269926 Best vali loss: 0.5893820

best validation loss 0.5893819629732298

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023321783568, 'e_layers': 4, 'learning_rate': 9.29387868e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3006382
	speed: 0.0117s/iter; left time: 90.6553s
	iters: 200, epoch: 1 | loss: 1.0652275
	speed: 0.0063s/iter; left time: 47.9451s
	iters: 300, epoch: 1 | loss: 0.7258043
	speed: 0.0061s/iter; left time: 46.1749s
	iters: 400, epoch: 1 | loss: 1.5029094
	speed: 0.0071s/iter; left time: 52.9798s
	iters: 500, epoch: 1 | loss: 0.9351162
	speed: 0.0057s/iter; left time: 42.0842s
	iters: 600, epoch: 1 | loss: 1.4987140
	speed: 0.0058s/iter; left time: 42.1511s
	iters: 700, epoch: 1 | loss: 0.7734556
	speed: 0.0059s/iter; left time: 42.0402s
	iters: 800, epoch: 1 | loss: 1.2052027
	speed: 0.0060s/iter; left time: 42.4997s
	iters: 900, epoch: 1 | loss: 0.3400652
	speed: 0.0062s/iter; left time: 42.7206s
Updating learning rate to 8.940151485047507e-05
Validation loss decreased (inf --> 0.6261).  Saving model state dict ...
Epoch: 1 cost time: 6.317543268203735
Epoch: 1, Steps: 979 | Train Loss: 1.0385703 Vali Loss: 0.6261428 Best vali loss: 0.6261428
	iters: 100, epoch: 2 | loss: 0.7776306
	speed: 0.0187s/iter; left time: 126.5466s
	iters: 200, epoch: 2 | loss: 0.3036362
	speed: 0.0060s/iter; left time: 40.0092s
	iters: 300, epoch: 2 | loss: 0.9124209
	speed: 0.0060s/iter; left time: 39.2766s
	iters: 400, epoch: 2 | loss: 0.9256549
	speed: 0.0060s/iter; left time: 38.8426s
	iters: 500, epoch: 2 | loss: 0.7198018
	speed: 0.0058s/iter; left time: 37.0871s
	iters: 600, epoch: 2 | loss: 0.7219809
	speed: 0.0054s/iter; left time: 33.7370s
	iters: 700, epoch: 2 | loss: 0.3174458
	speed: 0.0057s/iter; left time: 35.2384s
	iters: 800, epoch: 2 | loss: 0.7559130
	speed: 0.0060s/iter; left time: 36.4920s
	iters: 900, epoch: 2 | loss: 1.5923561
	speed: 0.0060s/iter; left time: 35.4544s
Updating learning rate to 7.93282165907654e-05
Validation loss decreased (0.6261 --> 0.6157).  Saving model state dict ...
Epoch: 2 cost time: 5.815733194351196
Epoch: 2, Steps: 979 | Train Loss: 0.7807600 Vali Loss: 0.6157395 Best vali loss: 0.6157395
	iters: 100, epoch: 3 | loss: 0.4051180
	speed: 0.0183s/iter; left time: 105.7966s
	iters: 200, epoch: 3 | loss: 0.6041010
	speed: 0.0061s/iter; left time: 34.4792s
	iters: 300, epoch: 3 | loss: 0.6608056
	speed: 0.0061s/iter; left time: 34.2319s
	iters: 400, epoch: 3 | loss: 1.0473127
	speed: 0.0062s/iter; left time: 33.7373s
	iters: 500, epoch: 3 | loss: 0.3575315
	speed: 0.0061s/iter; left time: 32.9080s
	iters: 600, epoch: 3 | loss: 0.8291587
	speed: 0.0060s/iter; left time: 31.8269s
	iters: 700, epoch: 3 | loss: 0.8603330
	speed: 0.0062s/iter; left time: 31.9252s
	iters: 800, epoch: 3 | loss: 0.4934986
	speed: 0.0061s/iter; left time: 30.8916s
	iters: 900, epoch: 3 | loss: 0.4416466
	speed: 0.0062s/iter; left time: 31.0142s
Updating learning rate to 6.425246036623565e-05
Validation loss decreased (0.6157 --> 0.6086).  Saving model state dict ...
Epoch: 3 cost time: 6.061307668685913
Epoch: 3, Steps: 979 | Train Loss: 0.6332784 Vali Loss: 0.6085592 Best vali loss: 0.6085592
	iters: 100, epoch: 4 | loss: 1.8696094
	speed: 0.0187s/iter; left time: 89.5684s
	iters: 200, epoch: 4 | loss: 0.9935935
	speed: 0.0063s/iter; left time: 29.6176s
	iters: 300, epoch: 4 | loss: 0.6709436
	speed: 0.0062s/iter; left time: 28.6503s
	iters: 400, epoch: 4 | loss: 0.6199753
	speed: 0.0062s/iter; left time: 27.8616s
	iters: 500, epoch: 4 | loss: 0.6560701
	speed: 0.0062s/iter; left time: 27.2905s
	iters: 600, epoch: 4 | loss: 0.8981258
	speed: 0.0062s/iter; left time: 26.4666s
	iters: 700, epoch: 4 | loss: 0.7889972
	speed: 0.0060s/iter; left time: 25.1470s
	iters: 800, epoch: 4 | loss: 0.7806983
	speed: 0.0054s/iter; left time: 22.2936s
	iters: 900, epoch: 4 | loss: 0.9307540
	speed: 0.0059s/iter; left time: 23.6012s
Updating learning rate to 4.64693934e-05
Validation loss decreased (0.6086 --> 0.6044).  Saving model state dict ...
Epoch: 4 cost time: 6.013707399368286
Epoch: 4, Steps: 979 | Train Loss: 0.9120852 Vali Loss: 0.6043814 Best vali loss: 0.6043814
	iters: 100, epoch: 5 | loss: 0.4772818
	speed: 0.0186s/iter; left time: 70.9429s
	iters: 200, epoch: 5 | loss: 0.4625564
	speed: 0.0070s/iter; left time: 25.9883s
	iters: 300, epoch: 5 | loss: 0.5642360
	speed: 0.0073s/iter; left time: 26.5505s
	iters: 400, epoch: 5 | loss: 0.4798046
	speed: 0.0064s/iter; left time: 22.6747s
	iters: 500, epoch: 5 | loss: 0.6008216
	speed: 0.0064s/iter; left time: 21.9777s
	iters: 600, epoch: 5 | loss: 0.5886721
	speed: 0.0064s/iter; left time: 21.1481s
	iters: 700, epoch: 5 | loss: 0.8498126
	speed: 0.0064s/iter; left time: 20.4318s
	iters: 800, epoch: 5 | loss: 0.9087123
	speed: 0.0060s/iter; left time: 18.8465s
	iters: 900, epoch: 5 | loss: 0.4933065
	speed: 0.0056s/iter; left time: 17.0277s
Updating learning rate to 2.8686326433764354e-05
Validation loss decreased (0.6044 --> 0.6040).  Saving model state dict ...
Epoch: 5 cost time: 6.308250665664673
Epoch: 5, Steps: 979 | Train Loss: 0.6028004 Vali Loss: 0.6039568 Best vali loss: 0.6039568
	iters: 100, epoch: 6 | loss: 0.9117445
	speed: 0.0189s/iter; left time: 53.5775s
	iters: 200, epoch: 6 | loss: 0.4389592
	speed: 0.0060s/iter; left time: 16.4787s
	iters: 300, epoch: 6 | loss: 0.4449275
	speed: 0.0061s/iter; left time: 15.9645s
	iters: 400, epoch: 6 | loss: 1.1382850
	speed: 0.0061s/iter; left time: 15.4188s
	iters: 500, epoch: 6 | loss: 1.2197155
	speed: 0.0061s/iter; left time: 14.7677s
	iters: 600, epoch: 6 | loss: 0.7892318
	speed: 0.0060s/iter; left time: 14.0853s
	iters: 700, epoch: 6 | loss: 0.8065403
	speed: 0.0062s/iter; left time: 13.7994s
	iters: 800, epoch: 6 | loss: 0.5735573
	speed: 0.0062s/iter; left time: 13.2020s
	iters: 900, epoch: 6 | loss: 0.8487501
	speed: 0.0058s/iter; left time: 11.8642s
Updating learning rate to 1.3610570209234607e-05
Epoch: 6 cost time: 5.9328882694244385
Epoch: 6, Steps: 979 | Train Loss: 0.7968568 Vali Loss: 0.6050673 Best vali loss: 0.6039568
	iters: 100, epoch: 7 | loss: 0.6756282
	speed: 0.0206s/iter; left time: 38.2317s
	iters: 200, epoch: 7 | loss: 1.2358066
	speed: 0.0103s/iter; left time: 18.1215s
	iters: 300, epoch: 7 | loss: 1.0147169
	speed: 0.0096s/iter; left time: 15.9827s
	iters: 400, epoch: 7 | loss: 0.8892633
	speed: 0.0089s/iter; left time: 13.8971s
	iters: 500, epoch: 7 | loss: 1.4456462
	speed: 0.0103s/iter; left time: 15.0083s
	iters: 600, epoch: 7 | loss: 1.4559481
	speed: 0.0101s/iter; left time: 13.7768s
	iters: 700, epoch: 7 | loss: 0.3827913
	speed: 0.0090s/iter; left time: 11.2709s
	iters: 800, epoch: 7 | loss: 1.3169478
	speed: 0.0103s/iter; left time: 11.9510s
	iters: 900, epoch: 7 | loss: 0.8709746
	speed: 0.0103s/iter; left time: 10.9239s
Updating learning rate to 3.5372719495249264e-06
Epoch: 7 cost time: 9.460878133773804
Epoch: 7, Steps: 979 | Train Loss: 1.0319692 Vali Loss: 0.6090056 Best vali loss: 0.6039568
	iters: 100, epoch: 8 | loss: 0.2659643
	speed: 0.0309s/iter; left time: 27.1604s
	iters: 200, epoch: 8 | loss: 1.1909781
	speed: 0.0077s/iter; left time: 6.0388s
	iters: 300, epoch: 8 | loss: 0.9351075
	speed: 0.0104s/iter; left time: 7.0538s
	iters: 400, epoch: 8 | loss: 1.4028506
	speed: 0.0102s/iter; left time: 5.9435s
	iters: 500, epoch: 8 | loss: 0.3525066
	speed: 0.0088s/iter; left time: 4.2003s
	iters: 600, epoch: 8 | loss: 0.8207684
	speed: 0.0102s/iter; left time: 3.8646s
	iters: 700, epoch: 8 | loss: 0.9673797
	speed: 0.0103s/iter; left time: 2.8825s
	iters: 800, epoch: 8 | loss: 1.3288565
	speed: 0.0095s/iter; left time: 1.7052s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0028520410111, 'e_layers': 4, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6459640
	speed: 0.0224s/iter; left time: 41.6167s
	iters: 200, epoch: 1 | loss: 0.8913867
	speed: 0.0135s/iter; left time: 23.8324s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.6005).  Saving model state dict ...
Epoch: 1 cost time: 4.050163507461548
Epoch: 1, Steps: 245 | Train Loss: 0.7686754 Vali Loss: 0.6004714 Best vali loss: 0.6004714
	iters: 100, epoch: 2 | loss: 0.5716314
	speed: 0.0306s/iter; left time: 49.4609s
	iters: 200, epoch: 2 | loss: 0.5956779
	speed: 0.0116s/iter; left time: 17.6021s
Updating learning rate to 5.35870624e-05
Validation loss decreased (0.6005 --> 0.5481).  Saving model state dict ...
Epoch: 2 cost time: 3.166461706161499
Epoch: 2, Steps: 245 | Train Loss: 0.5836546 Vali Loss: 0.5480708 Best vali loss: 0.5480708
	iters: 100, epoch: 3 | loss: 0.6129770
	speed: 0.0177s/iter; left time: 24.2393s
	iters: 200, epoch: 3 | loss: 0.9380121
	speed: 0.0097s/iter; left time: 12.3254s
Updating learning rate to 2.67935312e-05
Epoch: 3 cost time: 2.430659770965576
Epoch: 3, Steps: 245 | Train Loss: 0.7754946 Vali Loss: 0.5489986 Best vali loss: 0.5480708
	iters: 100, epoch: 4 | loss: 0.6043586
	speed: 0.0189s/iter; left time: 21.2883s
	iters: 200, epoch: 4 | loss: 0.7186126
	speed: 0.0100s/iter; left time: 10.2553s
Updating learning rate to 1.33967656e-05
Validation loss decreased (0.5481 --> 0.5442).  Saving model state dict ...
Epoch: 4 cost time: 2.466773271560669
Epoch: 4, Steps: 245 | Train Loss: 0.6614856 Vali Loss: 0.5442210 Best vali loss: 0.5442210
	iters: 100, epoch: 5 | loss: 0.5261971
	speed: 0.0193s/iter; left time: 17.0051s
	iters: 200, epoch: 5 | loss: 0.9130175
	speed: 0.0097s/iter; left time: 7.5901s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 2.454312324523926
Epoch: 5, Steps: 245 | Train Loss: 0.7196073 Vali Loss: 0.5473159 Best vali loss: 0.5442210
	iters: 100, epoch: 6 | loss: 0.7811809
	speed: 0.0185s/iter; left time: 11.7642s
	iters: 200, epoch: 6 | loss: 0.8050258
	speed: 0.0096s/iter; left time: 5.1529s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 2.3992936611175537
Epoch: 6, Steps: 245 | Train Loss: 0.7931033 Vali Loss: 0.5476951 Best vali loss: 0.5442210
	iters: 100, epoch: 7 | loss: 0.7008203
	speed: 0.0189s/iter; left time: 7.3949s
	iters: 200, epoch: 7 | loss: 0.7685374
	speed: 0.0098s/iter; left time: 2.8456s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 2.477060556411743
Epoch: 7, Steps: 245 | Train Loss: 0.7346789 Vali Loss: 0.5458510 Best vali loss: 0.5442210
	iters: 100, epoch: 8 | loss: 0.9787893
	speed: 0.0177s/iter; left time: 2.5877s
	iters: 200, epoch: 8 | loss: 0.7546162
	speed: 0.0089s/iter; left time: 0.4105s
Updating learning rate to 8.3729785e-07
Epoch: 8 cost time: 2.2629544734954834
Epoch: 8, Steps: 245 | Train Loss: 0.8667028 Vali Loss: 0.5449279 Best vali loss: 0.5442210

best validation loss 0.5442209974696712

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1254132
	speed: 0.0112s/iter; left time: 42.9744s
	iters: 200, epoch: 1 | loss: 0.8589230
	speed: 0.0048s/iter; left time: 17.9971s
	iters: 300, epoch: 1 | loss: 0.4963235
	speed: 0.0047s/iter; left time: 17.0953s
	iters: 400, epoch: 1 | loss: 1.0904962
	speed: 0.0050s/iter; left time: 17.6694s
Updating learning rate to 0.0002999627711
Validation loss decreased (inf --> 0.6034).  Saving model state dict ...
Epoch: 1 cost time: 2.709876537322998
Epoch: 1, Steps: 490 | Train Loss: 0.8927890 Vali Loss: 0.6034123 Best vali loss: 0.6034123
	iters: 100, epoch: 2 | loss: 0.9746411
	speed: 0.0129s/iter; left time: 42.8695s
	iters: 200, epoch: 2 | loss: 0.8648593
	speed: 0.0038s/iter; left time: 12.2363s
	iters: 300, epoch: 2 | loss: 0.4419457
	speed: 0.0089s/iter; left time: 27.7463s
	iters: 400, epoch: 2 | loss: 0.9690525
	speed: 0.0064s/iter; left time: 19.4027s
Updating learning rate to 0.00014998138555
Epoch: 2 cost time: 3.066171646118164
Epoch: 2, Steps: 490 | Train Loss: 0.8126247 Vali Loss: 0.6180477 Best vali loss: 0.6034123
	iters: 100, epoch: 3 | loss: 0.6627067
	speed: 0.0213s/iter; left time: 60.6210s
	iters: 200, epoch: 3 | loss: 0.8386678
	speed: 0.0036s/iter; left time: 9.8714s
	iters: 300, epoch: 3 | loss: 0.7468479
	speed: 0.0035s/iter; left time: 9.2782s
	iters: 400, epoch: 3 | loss: 1.1241070
	speed: 0.0036s/iter; left time: 9.1400s
Updating learning rate to 7.4990692775e-05
Epoch: 3 cost time: 2.5956168174743652
Epoch: 3, Steps: 490 | Train Loss: 0.8430823 Vali Loss: 0.6121617 Best vali loss: 0.6034123

best validation loss 0.6034122728628453

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7880313
	speed: 0.0136s/iter; left time: 25.3427s
	iters: 200, epoch: 1 | loss: 0.7014838
	speed: 0.0079s/iter; left time: 13.8829s
Updating learning rate to 0.0006619683104416462
Validation loss decreased (inf --> 0.6060).  Saving model state dict ...
Epoch: 1 cost time: 2.3266637325286865
Epoch: 1, Steps: 245 | Train Loss: 0.7447576 Vali Loss: 0.6060374 Best vali loss: 0.6060374
	iters: 100, epoch: 2 | loss: 0.7485138
	speed: 0.0174s/iter; left time: 28.1805s
	iters: 200, epoch: 2 | loss: 0.6592117
	speed: 0.0073s/iter; left time: 11.0609s
Updating learning rate to 0.0005873811600929365
Validation loss decreased (0.6060 --> 0.6006).  Saving model state dict ...
Epoch: 2 cost time: 1.7358412742614746
Epoch: 2, Steps: 245 | Train Loss: 0.7038628 Vali Loss: 0.6005598 Best vali loss: 0.6005598
	iters: 100, epoch: 3 | loss: 0.7216545
	speed: 0.0084s/iter; left time: 11.4694s
	iters: 200, epoch: 3 | loss: 0.9015654
	speed: 0.0045s/iter; left time: 5.7603s
Updating learning rate to 0.0004757536010602603
Epoch: 3 cost time: 1.0948820114135742
Epoch: 3, Steps: 245 | Train Loss: 0.8116100 Vali Loss: 0.6087119 Best vali loss: 0.6005598

best validation loss 0.6005598216462831

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006724544284
Validation loss decreased (inf --> 0.6088).  Saving model state dict ...
Epoch: 1 cost time: 1.1682367324829102
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6088416 Best vali loss: 0.6088416
Updating learning rate to 0.0003362272142
Epoch: 2 cost time: 0.9417572021484375
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6291059 Best vali loss: 0.6088416
Updating learning rate to 0.0001681136071
Validation loss decreased (0.6088 --> 0.6066).  Saving model state dict ...
Epoch: 3 cost time: 0.9350297451019287
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6066254 Best vali loss: 0.6066254

best validation loss 0.6066254322476985

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7695438
	speed: 0.0102s/iter; left time: 11.4400s
	iters: 200, epoch: 4 | loss: 0.6880395
	speed: 0.0044s/iter; left time: 4.5567s
Updating learning rate to 0.0003440799173
Validation loss decreased (0.6006 --> 0.5908).  Saving model state dict ...
Epoch: 4 cost time: 1.376713514328003
Epoch: 4, Steps: 245 | Train Loss: 0.7287917 Vali Loss: 0.5907990 Best vali loss: 0.5907990
	iters: 100, epoch: 5 | loss: 0.7408212
	speed: 0.0094s/iter; left time: 8.3057s
	iters: 200, epoch: 5 | loss: 0.6742083
	speed: 0.0048s/iter; left time: 3.7315s
Updating learning rate to 0.0002124062335397398
Epoch: 5 cost time: 1.2018980979919434
Epoch: 5, Steps: 245 | Train Loss: 0.7075147 Vali Loss: 0.6074621 Best vali loss: 0.5907990
	iters: 100, epoch: 6 | loss: 0.7212605
	speed: 0.0098s/iter; left time: 6.2109s
	iters: 200, epoch: 6 | loss: 0.8876140
	speed: 0.0048s/iter; left time: 2.5781s
Updating learning rate to 0.00010077867450706355
Epoch: 6 cost time: 1.234884262084961
Epoch: 6, Steps: 245 | Train Loss: 0.8044372 Vali Loss: 0.6091219 Best vali loss: 0.5907990
	iters: 100, epoch: 7 | loss: 0.9931071
	speed: 0.0096s/iter; left time: 3.7406s
	iters: 200, epoch: 7 | loss: 0.7905390
	speed: 0.0046s/iter; left time: 1.3280s
Updating learning rate to 2.61915241583538e-05
Epoch: 7 cost time: 1.1589763164520264
Epoch: 7, Steps: 245 | Train Loss: 0.8918230 Vali Loss: 0.6030635 Best vali loss: 0.5907990
	iters: 100, epoch: 8 | loss: 1.1953683
	speed: 0.0095s/iter; left time: 1.3920s
	iters: 200, epoch: 8 | loss: 0.7179245
	speed: 0.0044s/iter; left time: 0.2014s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1550168991088867
Epoch: 8, Steps: 245 | Train Loss: 0.9566464 Vali Loss: 0.6055605 Best vali loss: 0.5907990

best validation loss 0.5907989570742567

[INFO][smbo.py:320] Finished 100 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014600474372, 'e_layers': 3, 'learning_rate': 0.0001170962273, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4238088
	speed: 0.0110s/iter; left time: 85.0516s
	iters: 200, epoch: 1 | loss: 0.8232827
	speed: 0.0051s/iter; left time: 38.7467s
	iters: 300, epoch: 1 | loss: 0.3376902
	speed: 0.0051s/iter; left time: 38.0487s
	iters: 400, epoch: 1 | loss: 0.7491041
	speed: 0.0052s/iter; left time: 38.5833s
	iters: 500, epoch: 1 | loss: 1.7856475
	speed: 0.0050s/iter; left time: 36.6974s
	iters: 600, epoch: 1 | loss: 0.7842693
	speed: 0.0053s/iter; left time: 38.1964s
	iters: 700, epoch: 1 | loss: 1.2623659
	speed: 0.0052s/iter; left time: 37.1395s
	iters: 800, epoch: 1 | loss: 0.8504687
	speed: 0.0053s/iter; left time: 36.9967s
	iters: 900, epoch: 1 | loss: 0.4717513
	speed: 0.0050s/iter; left time: 34.5548s
Updating learning rate to 0.0001170962273
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 5.340180158615112
Epoch: 1, Steps: 979 | Train Loss: 0.8320432 Vali Loss: 0.6075150 Best vali loss: 0.6075150
	iters: 100, epoch: 2 | loss: 0.9365044
	speed: 0.0168s/iter; left time: 113.1712s
	iters: 200, epoch: 2 | loss: 0.4475527
	speed: 0.0054s/iter; left time: 35.6513s
	iters: 300, epoch: 2 | loss: 0.7971213
	speed: 0.0054s/iter; left time: 35.4609s
	iters: 400, epoch: 2 | loss: 0.6128335
	speed: 0.0052s/iter; left time: 33.7005s
	iters: 500, epoch: 2 | loss: 0.6097918
	speed: 0.0050s/iter; left time: 31.6961s
	iters: 600, epoch: 2 | loss: 0.5711662
	speed: 0.0049s/iter; left time: 30.4728s
	iters: 700, epoch: 2 | loss: 0.4332870
	speed: 0.0051s/iter; left time: 31.1318s
	iters: 800, epoch: 2 | loss: 1.2043881
	speed: 0.0051s/iter; left time: 30.9905s
	iters: 900, epoch: 2 | loss: 1.6071973
	speed: 0.0049s/iter; left time: 29.2607s
Updating learning rate to 5.854811365e-05
Epoch: 2 cost time: 5.0564398765563965
Epoch: 2, Steps: 979 | Train Loss: 0.8022047 Vali Loss: 0.6150572 Best vali loss: 0.6075150
	iters: 100, epoch: 3 | loss: 0.7931593
	speed: 0.0166s/iter; left time: 95.8622s
	iters: 200, epoch: 3 | loss: 1.5015157
	speed: 0.0052s/iter; left time: 29.2523s
	iters: 300, epoch: 3 | loss: 1.0414753
	speed: 0.0052s/iter; left time: 28.8301s
	iters: 400, epoch: 3 | loss: 0.6470227
	speed: 0.0051s/iter; left time: 28.0859s
	iters: 500, epoch: 3 | loss: 1.1865005
	speed: 0.0051s/iter; left time: 27.3048s
	iters: 600, epoch: 3 | loss: 1.1241062
	speed: 0.0051s/iter; left time: 26.8165s
	iters: 700, epoch: 3 | loss: 0.3796734
	speed: 0.0051s/iter; left time: 26.2819s
	iters: 800, epoch: 3 | loss: 0.5785403
	speed: 0.0050s/iter; left time: 25.5089s
	iters: 900, epoch: 3 | loss: 0.5295178
	speed: 0.0050s/iter; left time: 24.8548s
Updating learning rate to 2.9274056825e-05
Epoch: 3 cost time: 5.043299198150635
Epoch: 3, Steps: 979 | Train Loss: 0.8646124 Vali Loss: 0.6080738 Best vali loss: 0.6075150
	iters: 100, epoch: 4 | loss: 1.5941797
	speed: 0.0163s/iter; left time: 77.9710s
	iters: 200, epoch: 4 | loss: 0.3323751
	speed: 0.0050s/iter; left time: 23.5079s
	iters: 300, epoch: 4 | loss: 0.6748493
	speed: 0.0049s/iter; left time: 22.7410s
	iters: 400, epoch: 4 | loss: 0.3025766
	speed: 0.0050s/iter; left time: 22.3033s
	iters: 500, epoch: 4 | loss: 0.2859049
	speed: 0.0050s/iter; left time: 22.1553s
	iters: 600, epoch: 4 | loss: 0.7350320
	speed: 0.0051s/iter; left time: 21.9208s
	iters: 700, epoch: 4 | loss: 1.2129014
	speed: 0.0051s/iter; left time: 21.2232s
	iters: 800, epoch: 4 | loss: 0.3576686
	speed: 0.0051s/iter; left time: 21.0284s
	iters: 900, epoch: 4 | loss: 1.1886332
	speed: 0.0051s/iter; left time: 20.3841s
Updating learning rate to 1.46370284125e-05
Validation loss decreased (0.6075 --> 0.6053).  Saving model state dict ...
Epoch: 4 cost time: 5.008793592453003
Epoch: 4, Steps: 979 | Train Loss: 0.7426801 Vali Loss: 0.6052999 Best vali loss: 0.6052999
	iters: 100, epoch: 5 | loss: 0.9921652
	speed: 0.0163s/iter; left time: 62.0977s
	iters: 200, epoch: 5 | loss: 0.9719943
	speed: 0.0051s/iter; left time: 18.8750s
	iters: 300, epoch: 5 | loss: 0.2887710
	speed: 0.0051s/iter; left time: 18.2725s
	iters: 400, epoch: 5 | loss: 1.1625731
	speed: 0.0051s/iter; left time: 17.8388s
	iters: 500, epoch: 5 | loss: 0.9166963
	speed: 0.0051s/iter; left time: 17.3163s
	iters: 600, epoch: 5 | loss: 0.5548270
	speed: 0.0052s/iter; left time: 17.0943s
	iters: 700, epoch: 5 | loss: 0.6129690
	speed: 0.0052s/iter; left time: 16.6316s
	iters: 800, epoch: 5 | loss: 1.1540831
	speed: 0.0051s/iter; left time: 15.9783s
	iters: 900, epoch: 5 | loss: 0.9842946
	speed: 0.0052s/iter; left time: 15.5890s
Updating learning rate to 7.31851420625e-06
Epoch: 5 cost time: 5.063427209854126
Epoch: 5, Steps: 979 | Train Loss: 0.8487082 Vali Loss: 0.6071404 Best vali loss: 0.6052999
	iters: 100, epoch: 6 | loss: 0.6354201
	speed: 0.0165s/iter; left time: 46.9118s
	iters: 200, epoch: 6 | loss: 0.4377360
	speed: 0.0050s/iter; left time: 13.7407s
	iters: 300, epoch: 6 | loss: 1.3100694
	speed: 0.0050s/iter; left time: 13.2493s
	iters: 400, epoch: 6 | loss: 0.4395354
	speed: 0.0051s/iter; left time: 12.9383s
	iters: 500, epoch: 6 | loss: 0.5140621
	speed: 0.0052s/iter; left time: 12.6486s
	iters: 600, epoch: 6 | loss: 1.4835105
	speed: 0.0052s/iter; left time: 12.1199s
	iters: 700, epoch: 6 | loss: 0.5480775
	speed: 0.0051s/iter; left time: 11.3989s
	iters: 800, epoch: 6 | loss: 0.3094089
	speed: 0.0050s/iter; left time: 10.7023s
	iters: 900, epoch: 6 | loss: 0.8216944
	speed: 0.0051s/iter; left time: 10.3260s
Updating learning rate to 3.659257103125e-06
Epoch: 6 cost time: 5.048222303390503
Epoch: 6, Steps: 979 | Train Loss: 0.7221683 Vali Loss: 0.6068525 Best vali loss: 0.6052999
	iters: 100, epoch: 7 | loss: 0.9199056
	speed: 0.0163s/iter; left time: 30.2640s
	iters: 200, epoch: 7 | loss: 0.4116849
	speed: 0.0045s/iter; left time: 7.9989s
	iters: 300, epoch: 7 | loss: 1.3317392
	speed: 0.0042s/iter; left time: 7.0020s
	iters: 400, epoch: 7 | loss: 0.8779549
	speed: 0.0049s/iter; left time: 7.7046s
	iters: 500, epoch: 7 | loss: 1.4648359
	speed: 0.0095s/iter; left time: 13.8344s
	iters: 600, epoch: 7 | loss: 1.3637254
	speed: 0.0095s/iter; left time: 12.9153s
	iters: 700, epoch: 7 | loss: 1.0750171
	speed: 0.0077s/iter; left time: 9.6394s
	iters: 800, epoch: 7 | loss: 0.7639894
	speed: 0.0083s/iter; left time: 9.5621s
	iters: 900, epoch: 7 | loss: 1.1829423
	speed: 0.0094s/iter; left time: 9.9651s
Updating learning rate to 1.8296285515625e-06
Epoch: 7 cost time: 7.0827319622039795
Epoch: 7, Steps: 979 | Train Loss: 1.0435327 Vali Loss: 0.6066854 Best vali loss: 0.6052999
	iters: 100, epoch: 8 | loss: 0.8348272
	speed: 0.0295s/iter; left time: 25.9858s
	iters: 200, epoch: 8 | loss: 0.2481364
	speed: 0.0085s/iter; left time: 6.6630s
	iters: 300, epoch: 8 | loss: 0.3843092
	speed: 0.0077s/iter; left time: 5.2150s
	iters: 400, epoch: 8 | loss: 0.2925066
	speed: 0.0094s/iter; left time: 5.4795s
	iters: 500, epoch: 8 | loss: 0.2799712
	speed: 0.0094s/iter; left time: 4.5333s
	iters: 600, epoch: 8 | loss: 1.3468990
	speed: 0.0066s/iter; left time: 2.5219s
	iters: 700, epoch: 8 | loss: 0.4678594
	speed: 0.0094s/iter; left time: 2.6251s
	iters: 800, epoch: 8 | loss: 0.9382390
	speed: 0.0095s/iter; left time: 1.7137s
	iters: 900, epoch: 8 | loss: 1.1122346
	speed: 0.0084s/iter; left time: 0.6737s
Updating learning rate to 9.1481427578125e-07
Epoch: 8 cost time: 8.575442552566528
Epoch: 8, Steps: 979 | Train Loss: 0.6561092 Vali Loss: 0.6067161 Best vali loss: 0.6052999

best validation loss 0.6052998577980243

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008001774243, 'e_layers': 4, 'learning_rate': 8.14780285e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0380404
	speed: 0.0213s/iter; left time: 39.5817s
	iters: 200, epoch: 1 | loss: 0.7656878
	speed: 0.0150s/iter; left time: 26.4171s
Updating learning rate to 8.14780285e-05
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 3.9714369773864746
Epoch: 1, Steps: 245 | Train Loss: 0.9018641 Vali Loss: 0.6023327 Best vali loss: 0.6023327
	iters: 100, epoch: 2 | loss: 0.7388382
	speed: 0.0267s/iter; left time: 43.1465s
	iters: 200, epoch: 2 | loss: 0.9678885
	speed: 0.0151s/iter; left time: 22.8852s
Updating learning rate to 4.073901425e-05
Validation loss decreased (0.6023 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 3.742319107055664
Epoch: 2, Steps: 245 | Train Loss: 0.8533633 Vali Loss: 0.5611202 Best vali loss: 0.5611202
	iters: 100, epoch: 3 | loss: 0.7624771
	speed: 0.0208s/iter; left time: 28.5333s
	iters: 200, epoch: 3 | loss: 0.7481120
	speed: 0.0097s/iter; left time: 12.2905s
Updating learning rate to 2.0369507125e-05
Validation loss decreased (0.5611 --> 0.5414).  Saving model state dict ...
Epoch: 3 cost time: 2.260012626647949
Epoch: 3, Steps: 245 | Train Loss: 0.7552946 Vali Loss: 0.5413730 Best vali loss: 0.5413730
	iters: 100, epoch: 4 | loss: 0.4458867
	speed: 0.0192s/iter; left time: 21.6690s
	iters: 200, epoch: 4 | loss: 0.6507152
	speed: 0.0098s/iter; left time: 10.0515s
Updating learning rate to 1.01847535625e-05
Epoch: 4 cost time: 2.469590425491333
Epoch: 4, Steps: 245 | Train Loss: 0.5483010 Vali Loss: 0.5429289 Best vali loss: 0.5413730
	iters: 100, epoch: 5 | loss: 0.8604481
	speed: 0.0183s/iter; left time: 16.1013s
	iters: 200, epoch: 5 | loss: 0.5540229
	speed: 0.0098s/iter; left time: 7.6646s
Updating learning rate to 5.09237678125e-06
Validation loss decreased (0.5414 --> 0.5374).  Saving model state dict ...
Epoch: 5 cost time: 2.4604718685150146
Epoch: 5, Steps: 245 | Train Loss: 0.7072355 Vali Loss: 0.5374155 Best vali loss: 0.5374155
	iters: 100, epoch: 6 | loss: 0.5483689
	speed: 0.0190s/iter; left time: 12.0574s
	iters: 200, epoch: 6 | loss: 0.6455269
	speed: 0.0095s/iter; left time: 5.0900s
Updating learning rate to 2.546188390625e-06
Epoch: 6 cost time: 2.411684036254883
Epoch: 6, Steps: 245 | Train Loss: 0.5969479 Vali Loss: 0.5378662 Best vali loss: 0.5374155
	iters: 100, epoch: 7 | loss: 0.8950592
	speed: 0.0176s/iter; left time: 6.8807s
	iters: 200, epoch: 7 | loss: 0.7231864
	speed: 0.0098s/iter; left time: 2.8520s
Updating learning rate to 1.2730941953125e-06
Validation loss decreased (0.5374 --> 0.5365).  Saving model state dict ...
Epoch: 7 cost time: 2.448594570159912
Epoch: 7, Steps: 245 | Train Loss: 0.8091228 Vali Loss: 0.5364782 Best vali loss: 0.5364782
	iters: 100, epoch: 8 | loss: 0.5493280
	speed: 0.0192s/iter; left time: 2.7997s
	iters: 200, epoch: 8 | loss: 0.5497683
	speed: 0.0098s/iter; left time: 0.4525s
Updating learning rate to 6.3654709765625e-07
Epoch: 8 cost time: 2.4679906368255615
Epoch: 8, Steps: 245 | Train Loss: 0.5495481 Vali Loss: 0.5366230 Best vali loss: 0.5364782

best validation loss 0.536478236338321

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0042555642414, 'e_layers': 4, 'learning_rate': 0.0033451766027, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9758059
	speed: 0.0117s/iter; left time: 90.3415s
	iters: 200, epoch: 1 | loss: 0.9431406
	speed: 0.0061s/iter; left time: 46.4629s
	iters: 300, epoch: 1 | loss: 0.6976689
	speed: 0.0058s/iter; left time: 43.7325s
	iters: 400, epoch: 1 | loss: 1.4450992
	speed: 0.0054s/iter; left time: 40.2418s
	iters: 500, epoch: 1 | loss: 0.8785642
	speed: 0.0059s/iter; left time: 43.5867s
	iters: 600, epoch: 1 | loss: 1.4419153
	speed: 0.0061s/iter; left time: 43.7613s
	iters: 700, epoch: 1 | loss: 0.7316644
	speed: 0.0061s/iter; left time: 43.5966s
	iters: 800, epoch: 1 | loss: 1.2680320
	speed: 0.0061s/iter; left time: 42.6851s
	iters: 900, epoch: 1 | loss: 0.3207407
	speed: 0.0061s/iter; left time: 42.0691s
Updating learning rate to 0.0032178583992850856
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 6.144839763641357
Epoch: 1, Steps: 979 | Train Loss: 0.9669590 Vali Loss: 0.6093562 Best vali loss: 0.6093562
	iters: 100, epoch: 2 | loss: 0.7542716
	speed: 0.0186s/iter; left time: 125.8360s
	iters: 200, epoch: 2 | loss: 0.2908051
	speed: 0.0061s/iter; left time: 40.5124s
	iters: 300, epoch: 2 | loss: 0.8474507
	speed: 0.0061s/iter; left time: 39.8309s
	iters: 400, epoch: 2 | loss: 0.9111412
	speed: 0.0056s/iter; left time: 35.8214s
	iters: 500, epoch: 2 | loss: 0.7146733
	speed: 0.0054s/iter; left time: 34.1931s
	iters: 600, epoch: 2 | loss: 0.7030737
	speed: 0.0049s/iter; left time: 30.7325s
	iters: 700, epoch: 2 | loss: 0.2975605
	speed: 0.0062s/iter; left time: 37.8551s
	iters: 800, epoch: 2 | loss: 0.6844412
	speed: 0.0072s/iter; left time: 43.4976s
	iters: 900, epoch: 2 | loss: 1.6116143
	speed: 0.0071s/iter; left time: 42.4878s
Updating learning rate to 0.0028552868313678737
Epoch: 2 cost time: 6.061320066452026
Epoch: 2, Steps: 979 | Train Loss: 0.7572257 Vali Loss: 0.6128048 Best vali loss: 0.6093562
	iters: 100, epoch: 3 | loss: 0.4145770
	speed: 0.0215s/iter; left time: 124.1602s
	iters: 200, epoch: 3 | loss: 0.5493796
	speed: 0.0045s/iter; left time: 25.4402s
	iters: 300, epoch: 3 | loss: 0.6430373
	speed: 0.0051s/iter; left time: 28.6924s
	iters: 400, epoch: 3 | loss: 1.0502162
	speed: 0.0063s/iter; left time: 34.7515s
	iters: 500, epoch: 3 | loss: 0.3514380
	speed: 0.0063s/iter; left time: 33.9138s
	iters: 600, epoch: 3 | loss: 0.8337346
	speed: 0.0063s/iter; left time: 33.1580s
	iters: 700, epoch: 3 | loss: 0.8792161
	speed: 0.0062s/iter; left time: 32.0090s
	iters: 800, epoch: 3 | loss: 0.4839236
	speed: 0.0061s/iter; left time: 30.8142s
	iters: 900, epoch: 3 | loss: 0.3893657
	speed: 0.0055s/iter; left time: 27.2295s
Updating learning rate to 0.0023126601334443136
Epoch: 3 cost time: 5.808235168457031
Epoch: 3, Steps: 979 | Train Loss: 0.6216542 Vali Loss: 0.6180915 Best vali loss: 0.6093562

best validation loss 0.6093561572920443

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023938699804, 'e_layers': 1, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7840931
	speed: 0.0094s/iter; left time: 17.4231s
	iters: 200, epoch: 1 | loss: 0.6132924
	speed: 0.0037s/iter; left time: 6.4470s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.6046).  Saving model state dict ...
Epoch: 1 cost time: 1.2073173522949219
Epoch: 1, Steps: 245 | Train Loss: 0.6986927 Vali Loss: 0.6045928 Best vali loss: 0.6045928
	iters: 100, epoch: 2 | loss: 0.5936723
	speed: 0.0076s/iter; left time: 12.2020s
	iters: 200, epoch: 2 | loss: 1.0533895
	speed: 0.0034s/iter; left time: 5.1955s
Updating learning rate to 0.0014281993853242025
Validation loss decreased (0.6046 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 0.8862247467041016
Epoch: 2, Steps: 245 | Train Loss: 0.8235309 Vali Loss: 0.6036258 Best vali loss: 0.6036258
	iters: 100, epoch: 3 | loss: 0.6098482
	speed: 0.0080s/iter; left time: 10.9477s
	iters: 200, epoch: 3 | loss: 1.1434793
	speed: 0.0034s/iter; left time: 4.3562s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 0.8945198059082031
Epoch: 3, Steps: 245 | Train Loss: 0.8766638 Vali Loss: 0.6039103 Best vali loss: 0.6036258

best validation loss 0.6036257508285395

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7993760
	speed: 0.0088s/iter; left time: 67.9167s
	iters: 200, epoch: 1 | loss: 1.7963995
	speed: 0.0029s/iter; left time: 22.2190s
	iters: 300, epoch: 1 | loss: 1.0501722
	speed: 0.0026s/iter; left time: 19.7890s
	iters: 400, epoch: 1 | loss: 0.8839092
	speed: 0.0027s/iter; left time: 20.1947s
	iters: 500, epoch: 1 | loss: 2.5003421
	speed: 0.0025s/iter; left time: 18.0953s
	iters: 600, epoch: 1 | loss: 0.3335260
	speed: 0.0025s/iter; left time: 17.8459s
	iters: 700, epoch: 1 | loss: 0.5194107
	speed: 0.0024s/iter; left time: 17.1080s
	iters: 800, epoch: 1 | loss: 0.6949794
	speed: 0.0025s/iter; left time: 17.7469s
	iters: 900, epoch: 1 | loss: 0.7088260
	speed: 0.0033s/iter; left time: 22.9120s
Updating learning rate to 0.0002485111429
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 3.0330042839050293
Epoch: 1, Steps: 979 | Train Loss: 1.0318823 Vali Loss: 0.6018607 Best vali loss: 0.6018607
	iters: 100, epoch: 2 | loss: 1.2866235
	speed: 0.0135s/iter; left time: 91.2171s
	iters: 200, epoch: 2 | loss: 0.3615738
	speed: 0.0033s/iter; left time: 21.7671s
	iters: 300, epoch: 2 | loss: 0.8818869
	speed: 0.0035s/iter; left time: 22.6286s
	iters: 400, epoch: 2 | loss: 1.0035955
	speed: 0.0032s/iter; left time: 20.7138s
	iters: 500, epoch: 2 | loss: 0.4679526
	speed: 0.0031s/iter; left time: 19.8027s
	iters: 600, epoch: 2 | loss: 0.5670235
	speed: 0.0032s/iter; left time: 19.7964s
	iters: 700, epoch: 2 | loss: 0.3918726
	speed: 0.0027s/iter; left time: 16.3390s
	iters: 800, epoch: 2 | loss: 1.0601960
	speed: 0.0027s/iter; left time: 16.2850s
	iters: 900, epoch: 2 | loss: 0.8424385
	speed: 0.0027s/iter; left time: 15.8979s
Updating learning rate to 0.00012425557145
Epoch: 2 cost time: 2.9989535808563232
Epoch: 2, Steps: 979 | Train Loss: 0.7625736 Vali Loss: 0.6179834 Best vali loss: 0.6018607
	iters: 100, epoch: 3 | loss: 0.9929616
	speed: 0.0125s/iter; left time: 72.1327s
	iters: 200, epoch: 3 | loss: 0.5913290
	speed: 0.0033s/iter; left time: 18.9642s
	iters: 300, epoch: 3 | loss: 1.1289873
	speed: 0.0034s/iter; left time: 19.0241s
	iters: 400, epoch: 3 | loss: 0.6627959
	speed: 0.0036s/iter; left time: 19.9361s
	iters: 500, epoch: 3 | loss: 0.2764741
	speed: 0.0033s/iter; left time: 17.7281s
	iters: 600, epoch: 3 | loss: 0.4058414
	speed: 0.0033s/iter; left time: 17.2977s
	iters: 700, epoch: 3 | loss: 0.1981618
	speed: 0.0033s/iter; left time: 16.8328s
	iters: 800, epoch: 3 | loss: 1.2230295
	speed: 0.0031s/iter; left time: 15.8584s
	iters: 900, epoch: 3 | loss: 0.3904726
	speed: 0.0029s/iter; left time: 14.4917s
Updating learning rate to 6.2127785725e-05
Epoch: 3 cost time: 3.2254810333251953
Epoch: 3, Steps: 979 | Train Loss: 0.6522281 Vali Loss: 0.6349610 Best vali loss: 0.6018607

best validation loss 0.6018607486306601

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7603615
	speed: 0.0098s/iter; left time: 47.1441s
	iters: 200, epoch: 4 | loss: 0.9540316
	speed: 0.0034s/iter; left time: 16.1563s
	iters: 300, epoch: 4 | loss: 0.8758383
	speed: 0.0035s/iter; left time: 16.0528s
	iters: 400, epoch: 4 | loss: 0.9183007
	speed: 0.0032s/iter; left time: 14.2318s
	iters: 500, epoch: 4 | loss: 1.3433588
	speed: 0.0031s/iter; left time: 13.5954s
	iters: 600, epoch: 4 | loss: 0.3059245
	speed: 0.0026s/iter; left time: 11.0930s
	iters: 700, epoch: 4 | loss: 0.4884639
	speed: 0.0027s/iter; left time: 11.5198s
	iters: 800, epoch: 4 | loss: 0.5991417
	speed: 0.0025s/iter; left time: 10.3831s
	iters: 900, epoch: 4 | loss: 0.6603178
	speed: 0.0034s/iter; left time: 13.7819s
Updating learning rate to 3.10638928625e-05
Epoch: 4 cost time: 3.379371166229248
Epoch: 4, Steps: 979 | Train Loss: 0.7673043 Vali Loss: 0.6389165 Best vali loss: 0.6018607
	iters: 100, epoch: 5 | loss: 0.9319026
	speed: 0.0141s/iter; left time: 53.7417s
	iters: 200, epoch: 5 | loss: 0.3149918
	speed: 0.0037s/iter; left time: 13.5700s
	iters: 300, epoch: 5 | loss: 0.8227271
	speed: 0.0036s/iter; left time: 13.1306s
	iters: 400, epoch: 5 | loss: 0.9905884
	speed: 0.0034s/iter; left time: 12.0000s
	iters: 500, epoch: 5 | loss: 0.4159639
	speed: 0.0033s/iter; left time: 11.2388s
	iters: 600, epoch: 5 | loss: 0.4011666
	speed: 0.0034s/iter; left time: 11.2608s
	iters: 700, epoch: 5 | loss: 0.3494625
	speed: 0.0028s/iter; left time: 9.0967s
	iters: 800, epoch: 5 | loss: 0.6995342
	speed: 0.0028s/iter; left time: 8.6765s
	iters: 900, epoch: 5 | loss: 0.6008883
	speed: 0.0031s/iter; left time: 9.3353s
Updating learning rate to 1.553194643125e-05
Epoch: 5 cost time: 3.2975895404815674
Epoch: 5, Steps: 979 | Train Loss: 0.6141361 Vali Loss: 0.6465986 Best vali loss: 0.6018607
	iters: 100, epoch: 6 | loss: 0.9496946
	speed: 0.0137s/iter; left time: 38.9977s
	iters: 200, epoch: 6 | loss: 0.5646994
	speed: 0.0035s/iter; left time: 9.6787s
	iters: 300, epoch: 6 | loss: 1.1043934
	speed: 0.0034s/iter; left time: 8.8768s
	iters: 400, epoch: 6 | loss: 0.5988724
	speed: 0.0032s/iter; left time: 8.1139s
	iters: 500, epoch: 6 | loss: 0.2540196
	speed: 0.0032s/iter; left time: 7.7887s
	iters: 600, epoch: 6 | loss: 0.3751329
	speed: 0.0032s/iter; left time: 7.4467s
	iters: 700, epoch: 6 | loss: 0.1948500
	speed: 0.0028s/iter; left time: 6.2045s
	iters: 800, epoch: 6 | loss: 1.1022915
	speed: 0.0027s/iter; left time: 5.6844s
	iters: 900, epoch: 6 | loss: 0.3266618
	speed: 0.0026s/iter; left time: 5.3700s
Updating learning rate to 7.765973215625e-06
Epoch: 6 cost time: 3.0550379753112793
Epoch: 6, Steps: 979 | Train Loss: 0.6078462 Vali Loss: 0.6543064 Best vali loss: 0.6018607
	iters: 100, epoch: 7 | loss: 0.4834647
	speed: 0.0093s/iter; left time: 17.3036s
	iters: 200, epoch: 7 | loss: 1.0560725
	speed: 0.0040s/iter; left time: 7.1020s
	iters: 300, epoch: 7 | loss: 0.2600938
	speed: 0.0064s/iter; left time: 10.5506s
	iters: 400, epoch: 7 | loss: 0.2830046
	speed: 0.0033s/iter; left time: 5.1974s
	iters: 500, epoch: 7 | loss: 0.5936509
	speed: 0.0064s/iter; left time: 9.3662s
	iters: 600, epoch: 7 | loss: 0.4028451
	speed: 0.0049s/iter; left time: 6.6187s
	iters: 700, epoch: 7 | loss: 0.5098736
	speed: 0.0056s/iter; left time: 7.0680s
	iters: 800, epoch: 7 | loss: 0.9708300
	speed: 0.0052s/iter; left time: 6.0101s
	iters: 900, epoch: 7 | loss: 1.1117076
	speed: 0.0047s/iter; left time: 4.9785s
Updating learning rate to 3.8829866078125e-06
Epoch: 7 cost time: 4.899953126907349
Epoch: 7, Steps: 979 | Train Loss: 0.6301714 Vali Loss: 0.6550924 Best vali loss: 0.6018607
	iters: 100, epoch: 8 | loss: 0.7633056
	speed: 0.0202s/iter; left time: 17.7531s
	iters: 200, epoch: 8 | loss: 0.3090342
	speed: 0.0061s/iter; left time: 4.7359s
	iters: 300, epoch: 8 | loss: 0.6272674
	speed: 0.0050s/iter; left time: 3.4033s
	iters: 400, epoch: 8 | loss: 0.3750373
	speed: 0.0049s/iter; left time: 2.8495s
	iters: 500, epoch: 8 | loss: 1.4155151
	speed: 0.0056s/iter; left time: 2.6742s
	iters: 600, epoch: 8 | loss: 1.4167874
	speed: 0.0047s/iter; left time: 1.7854s
	iters: 700, epoch: 8 | loss: 1.2633859
	speed: 0.0066s/iter; left time: 1.8473s
	iters: 800, epoch: 8 | loss: 1.3756770
	speed: 0.0035s/iter; left time: 0.6273s
	iters: 900, epoch: 8 | loss: 1.2388024
	speed: 0.0025s/iter; left time: 0.1980s
Updating learning rate to 1.94149330390625e-06
Epoch: 8 cost time: 4.5088701248168945
Epoch: 8, Steps: 979 | Train Loss: 0.9760903 Vali Loss: 0.6530525 Best vali loss: 0.6018607

best validation loss 0.6018607486306601

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010455579744, 'e_layers': 2, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8686433
	speed: 0.0137s/iter; left time: 12.1254s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.6696).  Saving model state dict ...
Epoch: 1 cost time: 1.2804219722747803
Epoch: 1, Steps: 123 | Train Loss: 0.8686433 Vali Loss: 0.6696063 Best vali loss: 0.6696063
	iters: 100, epoch: 2 | loss: 0.9477624
	speed: 0.0125s/iter; left time: 9.5140s
Updating learning rate to 0.0026738530511141692
Validation loss decreased (0.6696 --> 0.6536).  Saving model state dict ...
Epoch: 2 cost time: 0.9645962715148926
Epoch: 2, Steps: 123 | Train Loss: 0.9477624 Vali Loss: 0.6535709 Best vali loss: 0.6535709
	iters: 100, epoch: 3 | loss: 0.9926209
	speed: 0.0127s/iter; left time: 8.0991s
Updating learning rate to 0.002165706536403478
Validation loss decreased (0.6536 --> 0.6383).  Saving model state dict ...
Epoch: 3 cost time: 1.0008745193481445
Epoch: 3, Steps: 123 | Train Loss: 0.9926209 Vali Loss: 0.6383439 Best vali loss: 0.6383439
	iters: 100, epoch: 4 | loss: 0.8374660
	speed: 0.0128s/iter; left time: 6.5970s
Updating learning rate to 0.00156630685355
Validation loss decreased (0.6383 --> 0.6293).  Saving model state dict ...
Epoch: 4 cost time: 0.974881649017334
Epoch: 4, Steps: 123 | Train Loss: 0.8374660 Vali Loss: 0.6292773 Best vali loss: 0.6292773
	iters: 100, epoch: 5 | loss: 0.8535478
	speed: 0.0125s/iter; left time: 4.9122s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 0.9817228317260742
Epoch: 5, Steps: 123 | Train Loss: 0.8535478 Vali Loss: 0.6480951 Best vali loss: 0.6292773
	iters: 100, epoch: 6 | loss: 1.0680537
	speed: 0.0118s/iter; left time: 3.1833s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 0.8937640190124512
Epoch: 6, Steps: 123 | Train Loss: 1.0680537 Vali Loss: 0.6426367 Best vali loss: 0.6292773
	iters: 100, epoch: 7 | loss: 1.0066153
	speed: 0.0092s/iter; left time: 1.3544s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 0.7682952880859375
Epoch: 7, Steps: 123 | Train Loss: 1.0066153 Vali Loss: 0.6437660 Best vali loss: 0.6292773
	iters: 100, epoch: 8 | loss: 0.9091750
	speed: 0.0125s/iter; left time: 0.3000s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0624620914459229
Epoch: 8, Steps: 123 | Train Loss: 0.9091750 Vali Loss: 0.6315343 Best vali loss: 0.6292773

best validation loss 0.6292772659655248

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014539170207, 'e_layers': 1, 'learning_rate': 0.0026890067218, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0288702
	speed: 0.0113s/iter; left time: 9.9791s
Updating learning rate to 0.0025866624974281455
Validation loss decreased (inf --> 0.6339).  Saving model state dict ...
Epoch: 1 cost time: 0.9568667411804199
Epoch: 1, Steps: 123 | Train Loss: 1.0288702 Vali Loss: 0.6338710 Best vali loss: 0.6338710
	iters: 100, epoch: 2 | loss: 0.9993788
	speed: 0.0101s/iter; left time: 7.7144s
Updating learning rate to 0.002295210804720494
Epoch: 2 cost time: 0.7987735271453857
Epoch: 2, Steps: 123 | Train Loss: 0.9993788 Vali Loss: 0.6396821 Best vali loss: 0.6338710
	iters: 100, epoch: 3 | loss: 0.6465854
	speed: 0.0093s/iter; left time: 5.9519s
Updating learning rate to 0.001859022521875611
Epoch: 3 cost time: 0.7195980548858643
Epoch: 3, Steps: 123 | Train Loss: 0.6465854 Vali Loss: 0.6399315 Best vali loss: 0.6338710
	iters: 100, epoch: 4 | loss: 0.8240925
	speed: 0.0094s/iter; left time: 4.8498s
Updating learning rate to 0.0013445033609
Validation loss decreased (0.6339 --> 0.5942).  Saving model state dict ...
Epoch: 4 cost time: 0.7032120227813721
Epoch: 4, Steps: 123 | Train Loss: 0.8240925 Vali Loss: 0.5941670 Best vali loss: 0.5941670
	iters: 100, epoch: 5 | loss: 0.6575221
	speed: 0.0095s/iter; left time: 3.7485s
Updating learning rate to 0.000829984199924389
Epoch: 5 cost time: 0.7301239967346191
Epoch: 5, Steps: 123 | Train Loss: 0.6575221 Vali Loss: 0.6332774 Best vali loss: 0.5941670
	iters: 100, epoch: 6 | loss: 0.4387689
	speed: 0.0096s/iter; left time: 2.5844s
Updating learning rate to 0.00039379591707950604
Epoch: 6 cost time: 0.7692070007324219
Epoch: 6, Steps: 123 | Train Loss: 0.4387689 Vali Loss: 0.5994011 Best vali loss: 0.5941670
	iters: 100, epoch: 7 | loss: 0.5414772
	speed: 0.0099s/iter; left time: 1.4583s
Updating learning rate to 0.00010234422437185415
Epoch: 7 cost time: 0.7147483825683594
Epoch: 7, Steps: 123 | Train Loss: 0.5414772 Vali Loss: 0.6056062 Best vali loss: 0.5941670
	iters: 100, epoch: 8 | loss: 0.6659731
	speed: 0.0096s/iter; left time: 0.2304s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7576124668121338
Epoch: 8, Steps: 123 | Train Loss: 0.6659731 Vali Loss: 0.6110417 Best vali loss: 0.5941670

best validation loss 0.5941669866201338

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0051563633661, 'e_layers': 4, 'learning_rate': 0.0001081267842, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3315206
	speed: 0.0125s/iter; left time: 47.6678s
	iters: 200, epoch: 1 | loss: 0.7746350
	speed: 0.0061s/iter; left time: 22.7025s
	iters: 300, epoch: 1 | loss: 0.5214956
	speed: 0.0053s/iter; left time: 19.2441s
	iters: 400, epoch: 1 | loss: 0.5262787
	speed: 0.0060s/iter; left time: 21.2038s
Updating learning rate to 0.00010401145351932239
Validation loss decreased (inf --> 0.6484).  Saving model state dict ...
Epoch: 1 cost time: 3.260075569152832
Epoch: 1, Steps: 490 | Train Loss: 0.5384825 Vali Loss: 0.6484084 Best vali loss: 0.6484084
	iters: 100, epoch: 2 | loss: 0.7205979
	speed: 0.0162s/iter; left time: 53.9156s
	iters: 200, epoch: 2 | loss: 1.0390346
	speed: 0.0065s/iter; left time: 21.1516s
	iters: 300, epoch: 2 | loss: 1.1318545
	speed: 0.0064s/iter; left time: 20.0922s
	iters: 400, epoch: 2 | loss: 0.9636194
	speed: 0.0062s/iter; left time: 18.8193s
Updating learning rate to 9.229198326785722e-05
Validation loss decreased (0.6484 --> 0.6313).  Saving model state dict ...
Epoch: 2 cost time: 3.1399738788604736
Epoch: 2, Steps: 490 | Train Loss: 0.9637766 Vali Loss: 0.6313189 Best vali loss: 0.6313189
	iters: 100, epoch: 3 | loss: 0.7004134
	speed: 0.0158s/iter; left time: 44.8829s
	iters: 200, epoch: 3 | loss: 1.0233756
	speed: 0.0060s/iter; left time: 16.4257s
	iters: 300, epoch: 3 | loss: 0.7775263
	speed: 0.0057s/iter; left time: 15.0648s
	iters: 400, epoch: 3 | loss: 0.4457768
	speed: 0.0058s/iter; left time: 14.7189s
Updating learning rate to 7.475255655412767e-05
Validation loss decreased (0.6313 --> 0.6236).  Saving model state dict ...
Epoch: 3 cost time: 2.908979654312134
Epoch: 3, Steps: 490 | Train Loss: 0.7367730 Vali Loss: 0.6236137 Best vali loss: 0.6236137

best validation loss 0.6236137351204764

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0961958
	speed: 0.0091s/iter; left time: 70.2044s
	iters: 200, epoch: 1 | loss: 0.9028274
	speed: 0.0039s/iter; left time: 29.4512s
	iters: 300, epoch: 1 | loss: 1.1882370
	speed: 0.0038s/iter; left time: 28.6151s
	iters: 400, epoch: 1 | loss: 0.5570403
	speed: 0.0038s/iter; left time: 28.1371s
	iters: 500, epoch: 1 | loss: 1.2732174
	speed: 0.0039s/iter; left time: 28.4447s
	iters: 600, epoch: 1 | loss: 0.9396411
	speed: 0.0039s/iter; left time: 28.3973s
	iters: 700, epoch: 1 | loss: 0.9499931
	speed: 0.0042s/iter; left time: 30.2277s
	iters: 800, epoch: 1 | loss: 1.1420341
	speed: 0.0041s/iter; left time: 28.7764s
	iters: 900, epoch: 1 | loss: 1.2361540
	speed: 0.0041s/iter; left time: 28.3305s
Updating learning rate to 0.0005849557155
Validation loss decreased (inf --> 0.6015).  Saving model state dict ...
Epoch: 1 cost time: 4.138426065444946
Epoch: 1, Steps: 979 | Train Loss: 1.0317045 Vali Loss: 0.6014630 Best vali loss: 0.6014630
	iters: 100, epoch: 2 | loss: 0.4886860
	speed: 0.0133s/iter; left time: 89.8668s
	iters: 200, epoch: 2 | loss: 0.5081944
	speed: 0.0035s/iter; left time: 23.5860s
	iters: 300, epoch: 2 | loss: 0.6308609
	speed: 0.0032s/iter; left time: 21.2875s
	iters: 400, epoch: 2 | loss: 1.0384233
	speed: 0.0035s/iter; left time: 22.6027s
	iters: 500, epoch: 2 | loss: 1.3225856
	speed: 0.0041s/iter; left time: 25.8693s
	iters: 600, epoch: 2 | loss: 0.8571072
	speed: 0.0042s/iter; left time: 26.1302s
	iters: 700, epoch: 2 | loss: 0.4602526
	speed: 0.0039s/iter; left time: 24.1489s
	iters: 800, epoch: 2 | loss: 0.7504718
	speed: 0.0039s/iter; left time: 23.6181s
	iters: 900, epoch: 2 | loss: 0.8764069
	speed: 0.0039s/iter; left time: 23.4709s
Updating learning rate to 0.00029247785775
Epoch: 2 cost time: 3.7896862030029297
Epoch: 2, Steps: 979 | Train Loss: 0.7703321 Vali Loss: 0.6045505 Best vali loss: 0.6014630
	iters: 100, epoch: 3 | loss: 0.6128839
	speed: 0.0137s/iter; left time: 79.3503s
	iters: 200, epoch: 3 | loss: 1.1777992
	speed: 0.0043s/iter; left time: 24.2428s
	iters: 300, epoch: 3 | loss: 0.4327598
	speed: 0.0040s/iter; left time: 22.2665s
	iters: 400, epoch: 3 | loss: 0.9730780
	speed: 0.0043s/iter; left time: 23.4369s
	iters: 500, epoch: 3 | loss: 0.9724970
	speed: 0.0045s/iter; left time: 23.9449s
	iters: 600, epoch: 3 | loss: 0.4392151
	speed: 0.0040s/iter; left time: 21.3375s
	iters: 700, epoch: 3 | loss: 0.4926546
	speed: 0.0044s/iter; left time: 23.0276s
	iters: 800, epoch: 3 | loss: 0.5457087
	speed: 0.0045s/iter; left time: 22.6265s
	iters: 900, epoch: 3 | loss: 0.5636624
	speed: 0.0039s/iter; left time: 19.4868s
Updating learning rate to 0.000146238928875
Epoch: 3 cost time: 4.148598670959473
Epoch: 3, Steps: 979 | Train Loss: 0.6900287 Vali Loss: 0.6395180 Best vali loss: 0.6014630

best validation loss 0.6014629650700705

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4707351
	speed: 0.0118s/iter; left time: 91.1245s
	iters: 200, epoch: 1 | loss: 0.9214772
	speed: 0.0064s/iter; left time: 49.2223s
	iters: 300, epoch: 1 | loss: 1.0271642
	speed: 0.0064s/iter; left time: 48.5655s
	iters: 400, epoch: 1 | loss: 0.4611393
	speed: 0.0063s/iter; left time: 46.7058s
	iters: 500, epoch: 1 | loss: 0.5764194
	speed: 0.0063s/iter; left time: 46.3773s
	iters: 600, epoch: 1 | loss: 0.7745081
	speed: 0.0064s/iter; left time: 45.9510s
	iters: 700, epoch: 1 | loss: 0.9306949
	speed: 0.0063s/iter; left time: 45.2037s
	iters: 800, epoch: 1 | loss: 0.2119989
	speed: 0.0063s/iter; left time: 44.0372s
	iters: 900, epoch: 1 | loss: 0.9381531
	speed: 0.0057s/iter; left time: 39.8498s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.5984).  Saving model state dict ...
Epoch: 1 cost time: 6.3799824714660645
Epoch: 1, Steps: 979 | Train Loss: 0.7013656 Vali Loss: 0.5984487 Best vali loss: 0.5984487
	iters: 100, epoch: 2 | loss: 0.3792777
	speed: 0.0188s/iter; left time: 127.0795s
	iters: 200, epoch: 2 | loss: 1.5408961
	speed: 0.0065s/iter; left time: 43.1275s
	iters: 300, epoch: 2 | loss: 0.6407424
	speed: 0.0066s/iter; left time: 43.2818s
	iters: 400, epoch: 2 | loss: 0.2311381
	speed: 0.0065s/iter; left time: 42.1484s
	iters: 500, epoch: 2 | loss: 0.8705788
	speed: 0.0065s/iter; left time: 41.1627s
	iters: 600, epoch: 2 | loss: 0.6682368
	speed: 0.0065s/iter; left time: 40.5548s
	iters: 700, epoch: 2 | loss: 0.7348717
	speed: 0.0063s/iter; left time: 38.5900s
	iters: 800, epoch: 2 | loss: 1.4678880
	speed: 0.0064s/iter; left time: 38.9462s
	iters: 900, epoch: 2 | loss: 0.8373167
	speed: 0.0064s/iter; left time: 38.3000s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.5984 --> 0.5762).  Saving model state dict ...
Epoch: 2 cost time: 6.293955564498901
Epoch: 2, Steps: 979 | Train Loss: 0.8189940 Vali Loss: 0.5761599 Best vali loss: 0.5761599
	iters: 100, epoch: 3 | loss: 0.3804228
	speed: 0.0167s/iter; left time: 96.2888s
	iters: 200, epoch: 3 | loss: 0.4603672
	speed: 0.0053s/iter; left time: 30.2058s
	iters: 300, epoch: 3 | loss: 0.9856781
	speed: 0.0058s/iter; left time: 32.0665s
	iters: 400, epoch: 3 | loss: 1.7846409
	speed: 0.0058s/iter; left time: 31.5447s
	iters: 500, epoch: 3 | loss: 1.1407996
	speed: 0.0059s/iter; left time: 31.7804s
	iters: 600, epoch: 3 | loss: 0.3542331
	speed: 0.0057s/iter; left time: 29.8225s
	iters: 700, epoch: 3 | loss: 0.8755879
	speed: 0.0057s/iter; left time: 29.6512s
	iters: 800, epoch: 3 | loss: 0.2192959
	speed: 0.0057s/iter; left time: 29.1688s
	iters: 900, epoch: 3 | loss: 0.6650866
	speed: 0.0057s/iter; left time: 28.4495s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 5.503803014755249
Epoch: 3, Steps: 979 | Train Loss: 0.7629013 Vali Loss: 0.5765824 Best vali loss: 0.5761599

best validation loss 0.5761599035408694

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4548878
	speed: 0.0113s/iter; left time: 54.2301s
	iters: 200, epoch: 4 | loss: 0.6903430
	speed: 0.0059s/iter; left time: 27.6152s
	iters: 300, epoch: 4 | loss: 0.7204676
	speed: 0.0058s/iter; left time: 26.5126s
	iters: 400, epoch: 4 | loss: 0.4473029
	speed: 0.0057s/iter; left time: 25.4461s
	iters: 500, epoch: 4 | loss: 0.4793217
	speed: 0.0057s/iter; left time: 25.1534s
	iters: 600, epoch: 4 | loss: 0.7296180
	speed: 0.0053s/iter; left time: 22.7876s
	iters: 700, epoch: 4 | loss: 0.9246818
	speed: 0.0057s/iter; left time: 23.9235s
	iters: 800, epoch: 4 | loss: 0.2352158
	speed: 0.0060s/iter; left time: 24.3965s
	iters: 900, epoch: 4 | loss: 0.9299696
	speed: 0.0064s/iter; left time: 25.5187s
Updating learning rate to 0.0001477158077
Validation loss decreased (0.5762 --> 0.5607).  Saving model state dict ...
Epoch: 4 cost time: 5.968351125717163
Epoch: 4, Steps: 979 | Train Loss: 0.6235342 Vali Loss: 0.5606856 Best vali loss: 0.5606856
	iters: 100, epoch: 5 | loss: 0.3595628
	speed: 0.0188s/iter; left time: 71.5877s
	iters: 200, epoch: 5 | loss: 1.5151719
	speed: 0.0060s/iter; left time: 22.4183s
	iters: 300, epoch: 5 | loss: 0.5975339
	speed: 0.0057s/iter; left time: 20.5904s
	iters: 400, epoch: 5 | loss: 0.2430754
	speed: 0.0059s/iter; left time: 20.7709s
	iters: 500, epoch: 5 | loss: 0.8596045
	speed: 0.0060s/iter; left time: 20.4594s
	iters: 600, epoch: 5 | loss: 0.6256528
	speed: 0.0060s/iter; left time: 19.8152s
	iters: 700, epoch: 5 | loss: 0.5465571
	speed: 0.0059s/iter; left time: 19.1054s
	iters: 800, epoch: 5 | loss: 1.2806702
	speed: 0.0060s/iter; left time: 18.6833s
	iters: 900, epoch: 5 | loss: 0.8038408
	speed: 0.0060s/iter; left time: 18.0987s
Updating learning rate to 9.118741539478246e-05
Validation loss decreased (0.5607 --> 0.5567).  Saving model state dict ...
Epoch: 5 cost time: 5.867478370666504
Epoch: 5, Steps: 979 | Train Loss: 0.7590744 Vali Loss: 0.5567091 Best vali loss: 0.5567091
	iters: 100, epoch: 6 | loss: 0.3786893
	speed: 0.0184s/iter; left time: 52.3214s
	iters: 200, epoch: 6 | loss: 0.4147065
	speed: 0.0059s/iter; left time: 16.2224s
	iters: 300, epoch: 6 | loss: 0.8126183
	speed: 0.0060s/iter; left time: 15.8887s
	iters: 400, epoch: 6 | loss: 1.5000579
	speed: 0.0059s/iter; left time: 14.9933s
	iters: 500, epoch: 6 | loss: 1.1088307
	speed: 0.0058s/iter; left time: 14.0382s
	iters: 600, epoch: 6 | loss: 0.2424278
	speed: 0.0058s/iter; left time: 13.5560s
	iters: 700, epoch: 6 | loss: 0.8353704
	speed: 0.0059s/iter; left time: 13.2050s
	iters: 800, epoch: 6 | loss: 0.2063348
	speed: 0.0058s/iter; left time: 12.3092s
	iters: 900, epoch: 6 | loss: 0.5523394
	speed: 0.0053s/iter; left time: 10.8517s
Updating learning rate to 4.326495838688198e-05
Validation loss decreased (0.5567 --> 0.5549).  Saving model state dict ...
Epoch: 6 cost time: 5.674787759780884
Epoch: 6, Steps: 979 | Train Loss: 0.6723750 Vali Loss: 0.5548921 Best vali loss: 0.5548921
	iters: 100, epoch: 7 | loss: 0.5372220
	speed: 0.0187s/iter; left time: 34.7036s
	iters: 200, epoch: 7 | loss: 0.8098506
	speed: 0.0064s/iter; left time: 11.2311s
	iters: 300, epoch: 7 | loss: 0.1997503
	speed: 0.0062s/iter; left time: 10.2063s
	iters: 400, epoch: 7 | loss: 0.6655732
	speed: 0.0064s/iter; left time: 10.0124s
	iters: 500, epoch: 7 | loss: 0.7198297
	speed: 0.0063s/iter; left time: 9.2219s
	iters: 600, epoch: 7 | loss: 0.4881665
	speed: 0.0062s/iter; left time: 8.4429s
	iters: 700, epoch: 7 | loss: 1.2917229
	speed: 0.0065s/iter; left time: 8.2226s
	iters: 800, epoch: 7 | loss: 0.4348227
	speed: 0.0063s/iter; left time: 7.2531s
	iters: 900, epoch: 7 | loss: 0.3614931
	speed: 0.0063s/iter; left time: 6.6515s
Updating learning rate to 1.124419633759687e-05
Epoch: 7 cost time: 6.230381488800049
Epoch: 7, Steps: 979 | Train Loss: 0.6120479 Vali Loss: 0.5590323 Best vali loss: 0.5548921
	iters: 100, epoch: 8 | loss: 1.0318402
	speed: 0.0204s/iter; left time: 17.9528s
	iters: 200, epoch: 8 | loss: 0.9056216
	speed: 0.0052s/iter; left time: 4.0779s
	iters: 300, epoch: 8 | loss: 0.4616587
	speed: 0.0047s/iter; left time: 3.2048s
	iters: 400, epoch: 8 | loss: 0.2348142
	speed: 0.0066s/iter; left time: 3.8430s
	iters: 500, epoch: 8 | loss: 0.7337242
	speed: 0.0067s/iter; left time: 3.1952s
	iters: 600, epoch: 8 | loss: 0.7558138
	speed: 0.0072s/iter; left time: 2.7235s
	iters: 700, epoch: 8 | loss: 0.3637642
	speed: 0.0062s/iter; left time: 1.7481s
	iters: 800, epoch: 8 | loss: 0.2925401
	speed: 0.0066s/iter; left time: 1.1958s
	iters: 900, epoch: 8 | loss: 1.0505928
	speed: 0.0064s/iter; left time: 0.5127s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.220382452011108
Epoch: 8, Steps: 979 | Train Loss: 0.6478189 Vali Loss: 0.5591945 Best vali loss: 0.5548921

best validation loss 0.5548921171739553

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018403809852, 'e_layers': 2, 'learning_rate': 0.0001571149601, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8814884
	speed: 0.0129s/iter; left time: 11.4306s
Updating learning rate to 0.00015113512799385873
Validation loss decreased (inf --> 0.6541).  Saving model state dict ...
Epoch: 1 cost time: 1.2224290370941162
Epoch: 1, Steps: 123 | Train Loss: 0.8814884 Vali Loss: 0.6541116 Best vali loss: 0.6541116
	iters: 100, epoch: 2 | loss: 0.8264772
	speed: 0.0122s/iter; left time: 9.3292s
Updating learning rate to 0.0001341060069062819
Validation loss decreased (0.6541 --> 0.6233).  Saving model state dict ...
Epoch: 2 cost time: 0.9336521625518799
Epoch: 2, Steps: 123 | Train Loss: 0.8264772 Vali Loss: 0.6233295 Best vali loss: 0.6233295
	iters: 100, epoch: 3 | loss: 0.8398587
	speed: 0.0119s/iter; left time: 7.6029s
Updating learning rate to 0.00010862012615348607
Validation loss decreased (0.6233 --> 0.6134).  Saving model state dict ...
Epoch: 3 cost time: 0.953160285949707
Epoch: 3, Steps: 123 | Train Loss: 0.8398587 Vali Loss: 0.6133839 Best vali loss: 0.6133839
	iters: 100, epoch: 4 | loss: 1.1781151
	speed: 0.0110s/iter; left time: 5.6566s
Updating learning rate to 7.855748005e-05
Validation loss decreased (0.6134 --> 0.6094).  Saving model state dict ...
Epoch: 4 cost time: 0.7568967342376709
Epoch: 4, Steps: 123 | Train Loss: 1.1781151 Vali Loss: 0.6094445 Best vali loss: 0.6094445
	iters: 100, epoch: 5 | loss: 0.6293311
	speed: 0.0077s/iter; left time: 3.0330s
Updating learning rate to 4.849483394651394e-05
Validation loss decreased (0.6094 --> 0.6060).  Saving model state dict ...
Epoch: 5 cost time: 0.6629743576049805
Epoch: 5, Steps: 123 | Train Loss: 0.6293311 Vali Loss: 0.6060345 Best vali loss: 0.6060345
	iters: 100, epoch: 6 | loss: 0.5971664
	speed: 0.0105s/iter; left time: 2.8316s
Updating learning rate to 2.3008953193718083e-05
Validation loss decreased (0.6060 --> 0.6057).  Saving model state dict ...
Epoch: 6 cost time: 0.7918305397033691
Epoch: 6, Steps: 123 | Train Loss: 0.5971664 Vali Loss: 0.6057358 Best vali loss: 0.6057358
	iters: 100, epoch: 7 | loss: 0.8493176
	speed: 0.0112s/iter; left time: 1.6472s
Updating learning rate to 5.979832106141266e-06
Validation loss decreased (0.6057 --> 0.6049).  Saving model state dict ...
Epoch: 7 cost time: 0.88116455078125
Epoch: 7, Steps: 123 | Train Loss: 0.8493176 Vali Loss: 0.6048817 Best vali loss: 0.6048817
	iters: 100, epoch: 8 | loss: 0.8832586
	speed: 0.0108s/iter; left time: 0.2586s
Updating learning rate to 0.0
Validation loss decreased (0.6049 --> 0.6048).  Saving model state dict ...
Epoch: 8 cost time: 0.892009973526001
Epoch: 8, Steps: 123 | Train Loss: 0.8832586 Vali Loss: 0.6047628 Best vali loss: 0.6047628

best validation loss 0.6047627839265406

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0080579476276, 'e_layers': 1, 'learning_rate': 0.000985904912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5834743
	speed: 0.0102s/iter; left time: 19.0073s
	iters: 200, epoch: 1 | loss: 0.7879714
	speed: 0.0043s/iter; left time: 7.5785s
Updating learning rate to 0.000985904912
Validation loss decreased (inf --> 0.6193).  Saving model state dict ...
Epoch: 1 cost time: 1.3857533931732178
Epoch: 1, Steps: 245 | Train Loss: 0.6857229 Vali Loss: 0.6193133 Best vali loss: 0.6193133
	iters: 100, epoch: 2 | loss: 0.7902344
	speed: 0.0105s/iter; left time: 16.9355s
	iters: 200, epoch: 2 | loss: 1.1255476
	speed: 0.0045s/iter; left time: 6.8483s
Updating learning rate to 0.000492952456
Validation loss decreased (0.6193 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 1.160017490386963
Epoch: 2, Steps: 245 | Train Loss: 0.9578910 Vali Loss: 0.6048410 Best vali loss: 0.6048410
	iters: 100, epoch: 3 | loss: 1.0105031
	speed: 0.0102s/iter; left time: 13.9276s
	iters: 200, epoch: 3 | loss: 0.5771964
	speed: 0.0046s/iter; left time: 5.8165s
Updating learning rate to 0.000246476228
Epoch: 3 cost time: 1.1427185535430908
Epoch: 3, Steps: 245 | Train Loss: 0.7938497 Vali Loss: 0.6257346 Best vali loss: 0.6048410
	iters: 100, epoch: 4 | loss: 0.7580621
	speed: 0.0087s/iter; left time: 9.7959s
	iters: 200, epoch: 4 | loss: 0.8703737
	speed: 0.0027s/iter; left time: 2.8115s
Updating learning rate to 0.000123238114
Epoch: 4 cost time: 0.7783923149108887
Epoch: 4, Steps: 245 | Train Loss: 0.8142179 Vali Loss: 0.6205835 Best vali loss: 0.6048410
	iters: 100, epoch: 5 | loss: 0.8504981
	speed: 0.0082s/iter; left time: 7.2377s
	iters: 200, epoch: 5 | loss: 0.6596811
	speed: 0.0047s/iter; left time: 3.6927s
Updating learning rate to 6.1619057e-05
Epoch: 5 cost time: 1.1835315227508545
Epoch: 5, Steps: 245 | Train Loss: 0.7550896 Vali Loss: 0.6237678 Best vali loss: 0.6048410
	iters: 100, epoch: 6 | loss: 0.5511391
	speed: 0.0104s/iter; left time: 6.6421s
	iters: 200, epoch: 6 | loss: 0.6750317
	speed: 0.0046s/iter; left time: 2.4553s
Updating learning rate to 3.08095285e-05
Epoch: 6 cost time: 1.1605923175811768
Epoch: 6, Steps: 245 | Train Loss: 0.6130854 Vali Loss: 0.6293749 Best vali loss: 0.6048410
	iters: 100, epoch: 7 | loss: 0.4105996
	speed: 0.0097s/iter; left time: 3.7970s
	iters: 200, epoch: 7 | loss: 0.7639289
	speed: 0.0048s/iter; left time: 1.3864s
Updating learning rate to 1.540476425e-05
Epoch: 7 cost time: 1.1638760566711426
Epoch: 7, Steps: 245 | Train Loss: 0.5872643 Vali Loss: 0.6357530 Best vali loss: 0.6048410
	iters: 100, epoch: 8 | loss: 0.7066257
	speed: 0.0102s/iter; left time: 1.4889s
	iters: 200, epoch: 8 | loss: 0.3118826
	speed: 0.0046s/iter; left time: 0.2099s
Updating learning rate to 7.702382125e-06
Epoch: 8 cost time: 1.1798088550567627
Epoch: 8, Steps: 245 | Train Loss: 0.5092542 Vali Loss: 0.6337390 Best vali loss: 0.6048410

best validation loss 0.6048410219320927

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2593104
	speed: 0.0106s/iter; left time: 40.5890s
	iters: 200, epoch: 1 | loss: 0.5042582
	speed: 0.0049s/iter; left time: 18.1079s
	iters: 300, epoch: 1 | loss: 1.0177982
	speed: 0.0051s/iter; left time: 18.3752s
	iters: 400, epoch: 1 | loss: 0.9807774
	speed: 0.0045s/iter; left time: 15.7247s
Updating learning rate to 0.0013504261128
Validation loss decreased (inf --> 0.6617).  Saving model state dict ...
Epoch: 1 cost time: 2.624627113342285
Epoch: 1, Steps: 490 | Train Loss: 0.9405360 Vali Loss: 0.6616529 Best vali loss: 0.6616529
	iters: 100, epoch: 2 | loss: 1.7275096
	speed: 0.0112s/iter; left time: 37.2145s
	iters: 200, epoch: 2 | loss: 1.4360590
	speed: 0.0055s/iter; left time: 17.7287s
	iters: 300, epoch: 2 | loss: 0.7356061
	speed: 0.0047s/iter; left time: 14.6182s
	iters: 400, epoch: 2 | loss: 0.5101873
	speed: 0.0054s/iter; left time: 16.4625s
Updating learning rate to 0.0006752130564
Validation loss decreased (0.6617 --> 0.6199).  Saving model state dict ...
Epoch: 2 cost time: 2.4284565448760986
Epoch: 2, Steps: 490 | Train Loss: 1.1023405 Vali Loss: 0.6198504 Best vali loss: 0.6198504
	iters: 100, epoch: 3 | loss: 0.9368058
	speed: 0.0149s/iter; left time: 42.3334s
	iters: 200, epoch: 3 | loss: 1.5195544
	speed: 0.0034s/iter; left time: 9.2102s
	iters: 300, epoch: 3 | loss: 0.6794641
	speed: 0.0033s/iter; left time: 8.7643s
	iters: 400, epoch: 3 | loss: 1.4400300
	speed: 0.0041s/iter; left time: 10.2920s
Updating learning rate to 0.0003376065282
Validation loss decreased (0.6199 --> 0.6058).  Saving model state dict ...
Epoch: 3 cost time: 2.039520263671875
Epoch: 3, Steps: 490 | Train Loss: 1.1439636 Vali Loss: 0.6058215 Best vali loss: 0.6058215

best validation loss 0.6058215185593037

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2316749
	speed: 0.0109s/iter; left time: 41.5424s
	iters: 200, epoch: 1 | loss: 0.3707284
	speed: 0.0048s/iter; left time: 17.6750s
	iters: 300, epoch: 1 | loss: 0.9053363
	speed: 0.0046s/iter; left time: 16.8246s
	iters: 400, epoch: 1 | loss: 0.9310822
	speed: 0.0048s/iter; left time: 16.9933s
Updating learning rate to 6.03650536e-05
Validation loss decreased (inf --> 0.6287).  Saving model state dict ...
Epoch: 1 cost time: 2.6924099922180176
Epoch: 1, Steps: 490 | Train Loss: 0.8597055 Vali Loss: 0.6287483 Best vali loss: 0.6287483
	iters: 100, epoch: 2 | loss: 1.3408552
	speed: 0.0150s/iter; left time: 49.9428s
	iters: 200, epoch: 2 | loss: 0.9780769
	speed: 0.0047s/iter; left time: 15.0689s
	iters: 300, epoch: 2 | loss: 0.6196340
	speed: 0.0048s/iter; left time: 15.1684s
	iters: 400, epoch: 2 | loss: 0.8583915
	speed: 0.0049s/iter; left time: 14.9540s
Updating learning rate to 3.01825268e-05
Validation loss decreased (0.6287 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 2.426508665084839
Epoch: 2, Steps: 490 | Train Loss: 0.9492394 Vali Loss: 0.6068764 Best vali loss: 0.6068764
	iters: 100, epoch: 3 | loss: 0.7701999
	speed: 0.0153s/iter; left time: 43.4374s
	iters: 200, epoch: 3 | loss: 0.7786896
	speed: 0.0047s/iter; left time: 12.9155s
	iters: 300, epoch: 3 | loss: 0.8200951
	speed: 0.0048s/iter; left time: 12.6139s
	iters: 400, epoch: 3 | loss: 0.9770777
	speed: 0.0046s/iter; left time: 11.7888s
Updating learning rate to 1.50912634e-05
Validation loss decreased (0.6069 --> 0.6060).  Saving model state dict ...
Epoch: 3 cost time: 2.3791327476501465
Epoch: 3, Steps: 490 | Train Loss: 0.8365156 Vali Loss: 0.6060044 Best vali loss: 0.6060044

best validation loss 0.606004437201556

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043939909637, 'e_layers': 2, 'learning_rate': 0.0005385073997, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0056075
	speed: 0.0124s/iter; left time: 11.0057s
Updating learning rate to 0.0005180116821943523
Validation loss decreased (inf --> 0.6270).  Saving model state dict ...
Epoch: 1 cost time: 1.1359896659851074
Epoch: 1, Steps: 123 | Train Loss: 1.0056075 Vali Loss: 0.6270124 Best vali loss: 0.6270124
	iters: 100, epoch: 2 | loss: 0.7778403
	speed: 0.0113s/iter; left time: 8.6007s
Updating learning rate to 0.00045964481687350226
Validation loss decreased (0.6270 --> 0.6127).  Saving model state dict ...
Epoch: 2 cost time: 0.8715713024139404
Epoch: 2, Steps: 123 | Train Loss: 0.7778403 Vali Loss: 0.6126502 Best vali loss: 0.6126502
	iters: 100, epoch: 3 | loss: 0.9143332
	speed: 0.0103s/iter; left time: 6.5629s
Updating learning rate to 0.0003722926298855977
Validation loss decreased (0.6127 --> 0.6065).  Saving model state dict ...
Epoch: 3 cost time: 0.7801814079284668
Epoch: 3, Steps: 123 | Train Loss: 0.9143332 Vali Loss: 0.6064647 Best vali loss: 0.6064647

best validation loss 0.6064647425384998

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.2763748
	speed: 0.0097s/iter; left time: 22.7582s
	iters: 200, epoch: 4 | loss: 0.5079107
	speed: 0.0040s/iter; left time: 8.9480s
	iters: 300, epoch: 4 | loss: 0.9877424
	speed: 0.0042s/iter; left time: 9.0146s
	iters: 400, epoch: 4 | loss: 0.9038481
	speed: 0.0043s/iter; left time: 8.7595s
Updating learning rate to 0.0001688032641
Epoch: 4 cost time: 2.3114490509033203
Epoch: 4, Steps: 490 | Train Loss: 0.9189690 Vali Loss: 0.6078756 Best vali loss: 0.6058215
	iters: 100, epoch: 5 | loss: 1.6713269
	speed: 0.0122s/iter; left time: 22.6726s
	iters: 200, epoch: 5 | loss: 1.3897839
	speed: 0.0042s/iter; left time: 7.3238s
	iters: 300, epoch: 5 | loss: 0.6356441
	speed: 0.0042s/iter; left time: 6.9680s
	iters: 400, epoch: 5 | loss: 0.4907759
	speed: 0.0043s/iter; left time: 6.6928s
Updating learning rate to 8.440163205e-05
Epoch: 5 cost time: 2.125077962875366
Epoch: 5, Steps: 490 | Train Loss: 1.0468827 Vali Loss: 0.6172812 Best vali loss: 0.6058215
	iters: 100, epoch: 6 | loss: 0.8925209
	speed: 0.0121s/iter; left time: 16.6472s
	iters: 200, epoch: 6 | loss: 1.2886544
	speed: 0.0042s/iter; left time: 5.2985s
	iters: 300, epoch: 6 | loss: 0.6803208
	speed: 0.0043s/iter; left time: 5.0526s
	iters: 400, epoch: 6 | loss: 1.3956804
	speed: 0.0043s/iter; left time: 4.6513s
Updating learning rate to 4.2200816025e-05
Epoch: 6 cost time: 2.130702018737793
Epoch: 6, Steps: 490 | Train Loss: 1.0642941 Vali Loss: 0.6190583 Best vali loss: 0.6058215
	iters: 100, epoch: 7 | loss: 0.9738927
	speed: 0.0117s/iter; left time: 10.3517s
	iters: 200, epoch: 7 | loss: 0.9252003
	speed: 0.0043s/iter; left time: 3.3887s
	iters: 300, epoch: 7 | loss: 0.7233030
	speed: 0.0042s/iter; left time: 2.8918s
	iters: 400, epoch: 7 | loss: 0.6140118
	speed: 0.0043s/iter; left time: 2.5180s
Updating learning rate to 2.11004080125e-05
Epoch: 7 cost time: 2.1601908206939697
Epoch: 7, Steps: 490 | Train Loss: 0.8091020 Vali Loss: 0.6225428 Best vali loss: 0.6058215
	iters: 100, epoch: 8 | loss: 0.7196755
	speed: 0.0123s/iter; left time: 4.8057s
	iters: 200, epoch: 8 | loss: 0.6696162
	speed: 0.0040s/iter; left time: 1.1608s
	iters: 300, epoch: 8 | loss: 0.9056032
	speed: 0.0042s/iter; left time: 0.8032s
	iters: 400, epoch: 8 | loss: 1.0176736
	speed: 0.0042s/iter; left time: 0.3833s
Updating learning rate to 1.055020400625e-05
Epoch: 8 cost time: 2.051560640335083
Epoch: 8, Steps: 490 | Train Loss: 0.8281421 Vali Loss: 0.6266686 Best vali loss: 0.6058215

best validation loss 0.6058215185593037

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014453407321, 'e_layers': 1, 'learning_rate': 0.0019242997604, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6428643
	speed: 0.0085s/iter; left time: 65.3443s
	iters: 200, epoch: 1 | loss: 0.9858434
	speed: 0.0028s/iter; left time: 21.3935s
	iters: 300, epoch: 1 | loss: 0.6853002
	speed: 0.0028s/iter; left time: 21.2849s
	iters: 400, epoch: 1 | loss: 0.4967229
	speed: 0.0030s/iter; left time: 22.0835s
	iters: 500, epoch: 1 | loss: 0.6751224
	speed: 0.0031s/iter; left time: 22.8113s
	iters: 600, epoch: 1 | loss: 0.8107519
	speed: 0.0032s/iter; left time: 22.9025s
	iters: 700, epoch: 1 | loss: 0.9764891
	speed: 0.0032s/iter; left time: 22.5392s
	iters: 800, epoch: 1 | loss: 0.8228440
	speed: 0.0031s/iter; left time: 21.8104s
	iters: 900, epoch: 1 | loss: 0.8666231
	speed: 0.0031s/iter; left time: 21.4947s
Updating learning rate to 0.0018510604617249667
Validation loss decreased (inf --> 0.6351).  Saving model state dict ...
Epoch: 1 cost time: 3.2530531883239746
Epoch: 1, Steps: 979 | Train Loss: 0.7736179 Vali Loss: 0.6351439 Best vali loss: 0.6351439
	iters: 100, epoch: 2 | loss: 1.1872803
	speed: 0.0111s/iter; left time: 75.2531s
	iters: 200, epoch: 2 | loss: 0.5148379
	speed: 0.0030s/iter; left time: 19.9211s
	iters: 300, epoch: 2 | loss: 0.6759478
	speed: 0.0028s/iter; left time: 18.3008s
	iters: 400, epoch: 2 | loss: 1.2946001
	speed: 0.0028s/iter; left time: 18.1419s
	iters: 500, epoch: 2 | loss: 0.3174016
	speed: 0.0029s/iter; left time: 18.5829s
	iters: 600, epoch: 2 | loss: 0.9188021
	speed: 0.0030s/iter; left time: 18.8927s
	iters: 700, epoch: 2 | loss: 0.4648733
	speed: 0.0030s/iter; left time: 18.6317s
	iters: 800, epoch: 2 | loss: 1.1980981
	speed: 0.0031s/iter; left time: 18.8296s
	iters: 900, epoch: 2 | loss: 1.2234169
	speed: 0.0030s/iter; left time: 18.1523s
Updating learning rate to 0.0016424925850072444
Validation loss decreased (0.6351 --> 0.6237).  Saving model state dict ...
Epoch: 2 cost time: 2.975423812866211
Epoch: 2, Steps: 979 | Train Loss: 0.8661398 Vali Loss: 0.6237332 Best vali loss: 0.6237332
	iters: 100, epoch: 3 | loss: 1.0175266
	speed: 0.0116s/iter; left time: 67.2347s
	iters: 200, epoch: 3 | loss: 0.8609635
	speed: 0.0033s/iter; left time: 18.7620s
	iters: 300, epoch: 3 | loss: 1.1703978
	speed: 0.0030s/iter; left time: 16.6724s
	iters: 400, epoch: 3 | loss: 1.3491871
	speed: 0.0027s/iter; left time: 14.7973s
	iters: 500, epoch: 3 | loss: 0.5340598
	speed: 0.0028s/iter; left time: 15.1766s
	iters: 600, epoch: 3 | loss: 1.0405077
	speed: 0.0027s/iter; left time: 14.4155s
	iters: 700, epoch: 3 | loss: 1.2485420
	speed: 0.0028s/iter; left time: 14.6075s
	iters: 800, epoch: 3 | loss: 0.6067438
	speed: 0.0030s/iter; left time: 15.1856s
	iters: 900, epoch: 3 | loss: 1.1588031
	speed: 0.0029s/iter; left time: 14.6598s
Updating learning rate to 0.001330348698804596
Epoch: 3 cost time: 2.930182695388794
Epoch: 3, Steps: 979 | Train Loss: 0.9985257 Vali Loss: 0.6377781 Best vali loss: 0.6237332
	iters: 100, epoch: 4 | loss: 0.9177212
	speed: 0.0110s/iter; left time: 52.6250s
	iters: 200, epoch: 4 | loss: 0.5786377
	speed: 0.0029s/iter; left time: 13.6998s
	iters: 300, epoch: 4 | loss: 1.1005070
	speed: 0.0028s/iter; left time: 12.8439s
	iters: 400, epoch: 4 | loss: 0.3122427
	speed: 0.0029s/iter; left time: 12.8216s
	iters: 500, epoch: 4 | loss: 0.3015873
	speed: 0.0027s/iter; left time: 11.7510s
	iters: 600, epoch: 4 | loss: 0.5718580
	speed: 0.0028s/iter; left time: 11.8929s
	iters: 700, epoch: 4 | loss: 0.6950983
	speed: 0.0028s/iter; left time: 11.5925s
	iters: 800, epoch: 4 | loss: 0.4531235
	speed: 0.0029s/iter; left time: 11.9900s
	iters: 900, epoch: 4 | loss: 0.2297505
	speed: 0.0029s/iter; left time: 11.7299s
Updating learning rate to 0.0009621498802
Epoch: 4 cost time: 2.84079647064209
Epoch: 4, Steps: 979 | Train Loss: 0.5733918 Vali Loss: 0.6507766 Best vali loss: 0.6237332
	iters: 100, epoch: 5 | loss: 0.9715108
	speed: 0.0108s/iter; left time: 41.3023s
	iters: 200, epoch: 5 | loss: 0.5071674
	speed: 0.0029s/iter; left time: 10.9100s
	iters: 300, epoch: 5 | loss: 0.2445570
	speed: 0.0029s/iter; left time: 10.4986s
	iters: 400, epoch: 5 | loss: 1.2769419
	speed: 0.0029s/iter; left time: 10.3392s
	iters: 500, epoch: 5 | loss: 0.6226594
	speed: 0.0031s/iter; left time: 10.4297s
	iters: 600, epoch: 5 | loss: 0.3511614
	speed: 0.0026s/iter; left time: 8.6126s
	iters: 700, epoch: 5 | loss: 0.5423728
	speed: 0.0026s/iter; left time: 8.3122s
	iters: 800, epoch: 5 | loss: 0.3674095
	speed: 0.0024s/iter; left time: 7.4461s
	iters: 900, epoch: 5 | loss: 1.2094420
	speed: 0.0023s/iter; left time: 6.8465s
Updating learning rate to 0.0005939510615954041
Epoch: 5 cost time: 2.66680645942688
Epoch: 5, Steps: 979 | Train Loss: 0.6770247 Vali Loss: 0.6452353 Best vali loss: 0.6237332
	iters: 100, epoch: 6 | loss: 0.5193803
	speed: 0.0099s/iter; left time: 27.9667s
	iters: 200, epoch: 6 | loss: 1.2245414
	speed: 0.0035s/iter; left time: 9.5493s
	iters: 300, epoch: 6 | loss: 0.3709016
	speed: 0.0035s/iter; left time: 9.3267s
	iters: 400, epoch: 6 | loss: 0.8421053
	speed: 0.0035s/iter; left time: 8.8352s
	iters: 500, epoch: 6 | loss: 0.3020107
	speed: 0.0035s/iter; left time: 8.5913s
	iters: 600, epoch: 6 | loss: 0.7761723
	speed: 0.0035s/iter; left time: 8.1712s
	iters: 700, epoch: 6 | loss: 0.6879596
	speed: 0.0035s/iter; left time: 7.8886s
	iters: 800, epoch: 6 | loss: 0.7226998
	speed: 0.0035s/iter; left time: 7.4620s
	iters: 900, epoch: 6 | loss: 0.8202045
	speed: 0.0035s/iter; left time: 7.1506s
Updating learning rate to 0.0002818071753927558
Validation loss decreased (0.6237 --> 0.6005).  Saving model state dict ...
Epoch: 6 cost time: 3.4768402576446533
Epoch: 6, Steps: 979 | Train Loss: 0.6962195 Vali Loss: 0.6004855 Best vali loss: 0.6004855
	iters: 100, epoch: 7 | loss: 0.7002710
	speed: 0.0143s/iter; left time: 26.6174s
	iters: 200, epoch: 7 | loss: 1.3656328
	speed: 0.0035s/iter; left time: 6.1807s
	iters: 300, epoch: 7 | loss: 0.9385592
	speed: 0.0035s/iter; left time: 5.8601s
	iters: 400, epoch: 7 | loss: 1.1427071
	speed: 0.0035s/iter; left time: 5.4664s
	iters: 500, epoch: 7 | loss: 1.0289224
	speed: 0.0037s/iter; left time: 5.3426s
	iters: 600, epoch: 7 | loss: 0.3891008
	speed: 0.0036s/iter; left time: 4.8880s
	iters: 700, epoch: 7 | loss: 0.7302976
	speed: 0.0035s/iter; left time: 4.3848s
	iters: 800, epoch: 7 | loss: 0.3080257
	speed: 0.0035s/iter; left time: 4.0890s
	iters: 900, epoch: 7 | loss: 0.7042188
	speed: 0.0028s/iter; left time: 3.0131s
Updating learning rate to 7.323929867503346e-05
Epoch: 7 cost time: 3.383810043334961
Epoch: 7, Steps: 979 | Train Loss: 0.8119706 Vali Loss: 0.6012550 Best vali loss: 0.6004855
	iters: 100, epoch: 8 | loss: 0.7121531
	speed: 0.0129s/iter; left time: 11.3824s
	iters: 200, epoch: 8 | loss: 0.3635290
	speed: 0.0040s/iter; left time: 3.1230s
	iters: 300, epoch: 8 | loss: 0.4938026
	speed: 0.0037s/iter; left time: 2.5424s
	iters: 400, epoch: 8 | loss: 1.0377785
	speed: 0.0038s/iter; left time: 2.1901s
	iters: 500, epoch: 8 | loss: 1.2490187
	speed: 0.0037s/iter; left time: 1.7925s
	iters: 600, epoch: 8 | loss: 0.5185841
	speed: 0.0039s/iter; left time: 1.4956s
	iters: 700, epoch: 8 | loss: 1.3262328
	speed: 0.0040s/iter; left time: 1.1183s
	iters: 800, epoch: 8 | loss: 1.1330253
	speed: 0.0040s/iter; left time: 0.7213s
	iters: 900, epoch: 8 | loss: 1.1693730
	speed: 0.0040s/iter; left time: 0.3192s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8849871158599854
Epoch: 8, Steps: 979 | Train Loss: 0.8892774 Vali Loss: 0.6115597 Best vali loss: 0.6004855

best validation loss 0.6004854711475112

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0071113834238, 'e_layers': 4, 'learning_rate': 0.0001530715139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3444832
	speed: 0.0149s/iter; left time: 114.8673s
	iters: 200, epoch: 1 | loss: 0.5062711
	speed: 0.0071s/iter; left time: 53.9783s
	iters: 300, epoch: 1 | loss: 0.7729748
	speed: 0.0068s/iter; left time: 51.1685s
	iters: 400, epoch: 1 | loss: 0.9866288
	speed: 0.0092s/iter; left time: 68.4629s
	iters: 500, epoch: 1 | loss: 0.4038266
	speed: 0.0093s/iter; left time: 68.0349s
	iters: 600, epoch: 1 | loss: 0.5609060
	speed: 0.0093s/iter; left time: 67.1559s
	iters: 700, epoch: 1 | loss: 1.0351169
	speed: 0.0093s/iter; left time: 66.6274s
	iters: 800, epoch: 1 | loss: 0.7972245
	speed: 0.0094s/iter; left time: 65.9075s
	iters: 900, epoch: 1 | loss: 0.4634576
	speed: 0.0094s/iter; left time: 64.8266s
Updating learning rate to 0.0001472455763013635
Validation loss decreased (inf --> 0.6139).  Saving model state dict ...
Epoch: 1 cost time: 8.935588359832764
Epoch: 1, Steps: 979 | Train Loss: 0.6523210 Vali Loss: 0.6138815 Best vali loss: 0.6138815
	iters: 100, epoch: 2 | loss: 0.9670258
	speed: 0.0278s/iter; left time: 187.4981s
	iters: 200, epoch: 2 | loss: 1.1555128
	speed: 0.0088s/iter; left time: 58.8537s
	iters: 300, epoch: 2 | loss: 0.5375369
	speed: 0.0071s/iter; left time: 46.6986s
	iters: 400, epoch: 2 | loss: 0.6264237
	speed: 0.0076s/iter; left time: 49.2750s
	iters: 500, epoch: 2 | loss: 0.6175783
	speed: 0.0094s/iter; left time: 59.4736s
	iters: 600, epoch: 2 | loss: 0.3779808
	speed: 0.0093s/iter; left time: 58.2759s
	iters: 700, epoch: 2 | loss: 0.3872306
	speed: 0.0093s/iter; left time: 57.1729s
	iters: 800, epoch: 2 | loss: 0.5248107
	speed: 0.0093s/iter; left time: 56.2892s
	iters: 900, epoch: 2 | loss: 1.6599191
	speed: 0.0093s/iter; left time: 55.5564s
Updating learning rate to 0.00013065470969259043
Validation loss decreased (0.6139 --> 0.6086).  Saving model state dict ...
Epoch: 2 cost time: 8.730250597000122
Epoch: 2, Steps: 979 | Train Loss: 0.7615576 Vali Loss: 0.6085670 Best vali loss: 0.6085670
	iters: 100, epoch: 3 | loss: 0.4821854
	speed: 0.0281s/iter; left time: 162.4675s
	iters: 200, epoch: 3 | loss: 1.0497065
	speed: 0.0092s/iter; left time: 52.4256s
	iters: 300, epoch: 3 | loss: 1.1929309
	speed: 0.0081s/iter; left time: 45.2479s
	iters: 400, epoch: 3 | loss: 0.4176454
	speed: 0.0075s/iter; left time: 40.8373s
	iters: 500, epoch: 3 | loss: 0.7074066
	speed: 0.0081s/iter; left time: 43.4682s
	iters: 600, epoch: 3 | loss: 1.0725141
	speed: 0.0093s/iter; left time: 48.8001s
	iters: 700, epoch: 3 | loss: 0.8484003
	speed: 0.0093s/iter; left time: 48.0993s
	iters: 800, epoch: 3 | loss: 0.7821472
	speed: 0.0093s/iter; left time: 47.1976s
	iters: 900, epoch: 3 | loss: 0.5859364
	speed: 0.0093s/iter; left time: 46.0769s
Updating learning rate to 0.00010582472311828629
Validation loss decreased (0.6086 --> 0.5919).  Saving model state dict ...
Epoch: 3 cost time: 8.716357231140137
Epoch: 3, Steps: 979 | Train Loss: 0.7932081 Vali Loss: 0.5919348 Best vali loss: 0.5919348
	iters: 100, epoch: 4 | loss: 0.6508787
	speed: 0.0287s/iter; left time: 137.7296s
	iters: 200, epoch: 4 | loss: 0.9556156
	speed: 0.0093s/iter; left time: 43.5469s
	iters: 300, epoch: 4 | loss: 0.6500445
	speed: 0.0093s/iter; left time: 42.6576s
	iters: 400, epoch: 4 | loss: 0.8227727
	speed: 0.0075s/iter; left time: 33.7280s
	iters: 500, epoch: 4 | loss: 0.3361123
	speed: 0.0077s/iter; left time: 33.9710s
	iters: 600, epoch: 4 | loss: 0.3380698
	speed: 0.0092s/iter; left time: 39.6759s
	iters: 700, epoch: 4 | loss: 0.2946194
	speed: 0.0092s/iter; left time: 38.5269s
	iters: 800, epoch: 4 | loss: 0.9139125
	speed: 0.0093s/iter; left time: 38.0948s
	iters: 900, epoch: 4 | loss: 0.4300253
	speed: 0.0093s/iter; left time: 37.2696s
Updating learning rate to 7.653575695e-05
Validation loss decreased (0.5919 --> 0.5915).  Saving model state dict ...
Epoch: 4 cost time: 8.788743257522583
Epoch: 4, Steps: 979 | Train Loss: 0.5991168 Vali Loss: 0.5915247 Best vali loss: 0.5915247
	iters: 100, epoch: 5 | loss: 0.5121216
	speed: 0.0282s/iter; left time: 107.4982s
	iters: 200, epoch: 5 | loss: 1.4930860
	speed: 0.0093s/iter; left time: 34.5481s
	iters: 300, epoch: 5 | loss: 0.7250523
	speed: 0.0093s/iter; left time: 33.6394s
	iters: 400, epoch: 5 | loss: 0.2568771
	speed: 0.0084s/iter; left time: 29.5888s
	iters: 500, epoch: 5 | loss: 0.7228045
	speed: 0.0072s/iter; left time: 24.7138s
	iters: 600, epoch: 5 | loss: 0.4274099
	speed: 0.0083s/iter; left time: 27.5997s
	iters: 700, epoch: 5 | loss: 0.3575677
	speed: 0.0092s/iter; left time: 29.7154s
	iters: 800, epoch: 5 | loss: 1.2647172
	speed: 0.0052s/iter; left time: 16.2425s
	iters: 900, epoch: 5 | loss: 0.2956820
	speed: 0.0063s/iter; left time: 19.1196s
Updating learning rate to 4.724679078171373e-05
Validation loss decreased (0.5915 --> 0.5606).  Saving model state dict ...
Epoch: 5 cost time: 7.851337432861328
Epoch: 5, Steps: 979 | Train Loss: 0.6728131 Vali Loss: 0.5606486 Best vali loss: 0.5606486
	iters: 100, epoch: 6 | loss: 0.7665531
	speed: 0.0230s/iter; left time: 65.3324s
	iters: 200, epoch: 6 | loss: 0.4025215
	speed: 0.0065s/iter; left time: 17.8742s
	iters: 300, epoch: 6 | loss: 0.8719901
	speed: 0.0069s/iter; left time: 18.1295s
	iters: 400, epoch: 6 | loss: 0.6431674
	speed: 0.0070s/iter; left time: 17.7756s
	iters: 500, epoch: 6 | loss: 0.3499995
	speed: 0.0055s/iter; left time: 13.4429s
	iters: 600, epoch: 6 | loss: 0.7500123
	speed: 0.0058s/iter; left time: 13.5401s
	iters: 700, epoch: 6 | loss: 0.4592994
	speed: 0.0067s/iter; left time: 14.8865s
	iters: 800, epoch: 6 | loss: 0.8983808
	speed: 0.0069s/iter; left time: 14.7358s
	iters: 900, epoch: 6 | loss: 0.4001070
	speed: 0.0064s/iter; left time: 13.1052s
Updating learning rate to 2.2416804207409573e-05
Validation loss decreased (0.5606 --> 0.5584).  Saving model state dict ...
Epoch: 6 cost time: 6.339165925979614
Epoch: 6, Steps: 979 | Train Loss: 0.6157812 Vali Loss: 0.5584413 Best vali loss: 0.5584413
	iters: 100, epoch: 7 | loss: 0.8523867
	speed: 0.0206s/iter; left time: 38.2581s
	iters: 200, epoch: 7 | loss: 0.6971147
	speed: 0.0080s/iter; left time: 14.0234s
	iters: 300, epoch: 7 | loss: 0.6672301
	speed: 0.0072s/iter; left time: 12.0025s
	iters: 400, epoch: 7 | loss: 0.3910116
	speed: 0.0079s/iter; left time: 12.3609s
	iters: 500, epoch: 7 | loss: 0.6734374
	speed: 0.0058s/iter; left time: 8.3973s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0037634
	speed: 0.0102s/iter; left time: 18.9142s
	iters: 200, epoch: 1 | loss: 0.8231159
	speed: 0.0043s/iter; left time: 7.5810s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.6513).  Saving model state dict ...
Epoch: 1 cost time: 1.4009230136871338
Epoch: 1, Steps: 245 | Train Loss: 0.9134397 Vali Loss: 0.6512657 Best vali loss: 0.6512657
	iters: 100, epoch: 2 | loss: 1.1371553
	speed: 0.0104s/iter; left time: 16.7544s
	iters: 200, epoch: 2 | loss: 0.8199082
	speed: 0.0044s/iter; left time: 6.7272s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.6513 --> 0.6219).  Saving model state dict ...
Epoch: 2 cost time: 1.1687722206115723
Epoch: 2, Steps: 245 | Train Loss: 0.9785317 Vali Loss: 0.6219101 Best vali loss: 0.6219101
	iters: 100, epoch: 3 | loss: 1.0939517
	speed: 0.0104s/iter; left time: 14.2398s
	iters: 200, epoch: 3 | loss: 0.8753357
	speed: 0.0048s/iter; left time: 6.1542s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.6219 --> 0.6114).  Saving model state dict ...
Epoch: 3 cost time: 1.1799304485321045
Epoch: 3, Steps: 245 | Train Loss: 0.9846437 Vali Loss: 0.6114300 Best vali loss: 0.6114300

best validation loss 0.6114300293869467

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020735604228, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.6683).  Saving model state dict ...
Epoch: 1 cost time: 0.7926883697509766
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6683088 Best vali loss: 0.6683088
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.6683 --> 0.6368).  Saving model state dict ...
Epoch: 2 cost time: 0.40930891036987305
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6367987 Best vali loss: 0.6367987
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.6368 --> 0.6260).  Saving model state dict ...
Epoch: 3 cost time: 0.47405314445495605
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6260435 Best vali loss: 0.6260435

best validation loss 0.6260434816910789

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062923252341, 'e_layers': 4, 'learning_rate': 0.0001977554099, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9497964
	speed: 0.0136s/iter; left time: 12.0134s
Updating learning rate to 0.00019022879277499492
Validation loss decreased (inf --> 0.6614).  Saving model state dict ...
Epoch: 1 cost time: 1.289625644683838
Epoch: 1, Steps: 123 | Train Loss: 0.9497964 Vali Loss: 0.6614366 Best vali loss: 0.6614366
	iters: 100, epoch: 2 | loss: 0.9964226
	speed: 0.0129s/iter; left time: 9.7980s
Updating learning rate to 0.00016879480062830765
Validation loss decreased (0.6614 --> 0.6316).  Saving model state dict ...
Epoch: 2 cost time: 1.049748182296753
Epoch: 2, Steps: 123 | Train Loss: 0.9964226 Vali Loss: 0.6315588 Best vali loss: 0.6315588
	iters: 100, epoch: 3 | loss: 1.0094527
	speed: 0.0129s/iter; left time: 8.2730s
Updating learning rate to 0.00013671656446464863
Validation loss decreased (0.6316 --> 0.6242).  Saving model state dict ...
Epoch: 3 cost time: 1.065161943435669
Epoch: 3, Steps: 123 | Train Loss: 1.0094527 Vali Loss: 0.6242187 Best vali loss: 0.6242187

best validation loss 0.6242186557303309

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9408702
	speed: 0.0101s/iter; left time: 11.3183s
	iters: 200, epoch: 4 | loss: 0.7542283
	speed: 0.0043s/iter; left time: 4.3751s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.6114 --> 0.6074).  Saving model state dict ...
Epoch: 4 cost time: 1.3254525661468506
Epoch: 4, Steps: 245 | Train Loss: 0.8475493 Vali Loss: 0.6073936 Best vali loss: 0.6073936
	iters: 100, epoch: 5 | loss: 1.0869259
	speed: 0.0097s/iter; left time: 8.5369s
	iters: 200, epoch: 5 | loss: 0.8039687
	speed: 0.0043s/iter; left time: 3.3809s
Updating learning rate to 1.7856066821212585e-05
Validation loss decreased (0.6074 --> 0.6059).  Saving model state dict ...
Epoch: 5 cost time: 1.1114311218261719
Epoch: 5, Steps: 245 | Train Loss: 0.9454473 Vali Loss: 0.6058632 Best vali loss: 0.6058632
	iters: 100, epoch: 6 | loss: 1.0765002
	speed: 0.0092s/iter; left time: 5.8538s
	iters: 200, epoch: 6 | loss: 0.8540123
	speed: 0.0043s/iter; left time: 2.3258s
Updating learning rate to 8.472024178210777e-06
Validation loss decreased (0.6059 --> 0.6044).  Saving model state dict ...
Epoch: 6 cost time: 1.0515778064727783
Epoch: 6, Steps: 245 | Train Loss: 0.9652562 Vali Loss: 0.6044420 Best vali loss: 0.6044420
	iters: 100, epoch: 7 | loss: 0.8513700
	speed: 0.0082s/iter; left time: 3.1995s
	iters: 200, epoch: 7 | loss: 0.8731176
	speed: 0.0028s/iter; left time: 0.8189s
Updating learning rate to 2.2018073468332077e-06
Validation loss decreased (0.6044 --> 0.6038).  Saving model state dict ...
Epoch: 7 cost time: 0.7580263614654541
Epoch: 7, Steps: 245 | Train Loss: 0.8622438 Vali Loss: 0.6038237 Best vali loss: 0.6038237
	iters: 100, epoch: 8 | loss: 0.8540493
	speed: 0.0090s/iter; left time: 1.3136s
	iters: 200, epoch: 8 | loss: 1.0508457
	speed: 0.0045s/iter; left time: 0.2081s
Updating learning rate to 0.0
Validation loss decreased (0.6038 --> 0.6038).  Saving model state dict ...
Epoch: 8 cost time: 1.143955945968628
Epoch: 8, Steps: 245 | Train Loss: 0.9524475 Vali Loss: 0.6037619 Best vali loss: 0.6037619

best validation loss 0.6037619116680316

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047327455259, 'e_layers': 4, 'learning_rate': 0.0038245816163, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8357700
	speed: 0.0147s/iter; left time: 12.9755s
Updating learning rate to 0.0038245816163
Validation loss decreased (inf --> 0.6215).  Saving model state dict ...
Epoch: 1 cost time: 1.3501691818237305
Epoch: 1, Steps: 123 | Train Loss: 0.8357700 Vali Loss: 0.6215077 Best vali loss: 0.6215077
	iters: 100, epoch: 2 | loss: 1.0895234
	speed: 0.0116s/iter; left time: 8.8019s
Updating learning rate to 0.00191229080815
Validation loss decreased (0.6215 --> 0.6156).  Saving model state dict ...
Epoch: 2 cost time: 0.924403190612793
Epoch: 2, Steps: 123 | Train Loss: 1.0895234 Vali Loss: 0.6156296 Best vali loss: 0.6156296
	iters: 100, epoch: 3 | loss: 0.9160407
	speed: 0.0119s/iter; left time: 7.5752s
Updating learning rate to 0.000956145404075
Validation loss decreased (0.6156 --> 0.6079).  Saving model state dict ...
Epoch: 3 cost time: 0.9488544464111328
Epoch: 3, Steps: 123 | Train Loss: 0.9160407 Vali Loss: 0.6079129 Best vali loss: 0.6079129
	iters: 100, epoch: 4 | loss: 0.9680784
	speed: 0.0118s/iter; left time: 6.0976s
Updating learning rate to 0.0004780727020375
Epoch: 4 cost time: 0.9989349842071533
Epoch: 4, Steps: 123 | Train Loss: 0.9680784 Vali Loss: 0.6184219 Best vali loss: 0.6079129
	iters: 100, epoch: 5 | loss: 0.6717370
	speed: 0.0124s/iter; left time: 4.8762s
Updating learning rate to 0.00023903635101875
Epoch: 5 cost time: 0.953132152557373
Epoch: 5, Steps: 123 | Train Loss: 0.6717370 Vali Loss: 0.6292739 Best vali loss: 0.6079129
	iters: 100, epoch: 6 | loss: 0.6698985
	speed: 0.0116s/iter; left time: 3.1361s
Updating learning rate to 0.000119518175509375
Epoch: 6 cost time: 0.9442238807678223
Epoch: 6, Steps: 123 | Train Loss: 0.6698985 Vali Loss: 0.6387959 Best vali loss: 0.6079129
	iters: 100, epoch: 7 | loss: 0.7518154
	speed: 0.0122s/iter; left time: 1.7893s
Updating learning rate to 5.97590877546875e-05
Epoch: 7 cost time: 0.9960365295410156
Epoch: 7, Steps: 123 | Train Loss: 0.7518154 Vali Loss: 0.6523724 Best vali loss: 0.6079129
	iters: 100, epoch: 8 | loss: 0.8292481
	speed: 0.0129s/iter; left time: 0.3088s
Updating learning rate to 2.987954387734375e-05
Epoch: 8 cost time: 0.9646165370941162
Epoch: 8, Steps: 123 | Train Loss: 0.8292481 Vali Loss: 0.6517182 Best vali loss: 0.6079129

best validation loss 0.6079129449805967

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0036637688578, 'e_layers': 3, 'learning_rate': 0.0032858943573, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6069998
	speed: 0.0117s/iter; left time: 44.8404s
	iters: 200, epoch: 1 | loss: 1.0116338
	speed: 0.0060s/iter; left time: 22.3324s
	iters: 300, epoch: 1 | loss: 1.1784464
	speed: 0.0060s/iter; left time: 21.6187s
	iters: 400, epoch: 1 | loss: 1.2951301
	speed: 0.0060s/iter; left time: 21.0190s
Updating learning rate to 0.0032858943573
Validation loss decreased (inf --> 0.6426).  Saving model state dict ...
Epoch: 1 cost time: 3.250919818878174
Epoch: 1, Steps: 490 | Train Loss: 1.0230525 Vali Loss: 0.6425897 Best vali loss: 0.6425897
	iters: 100, epoch: 2 | loss: 1.1277640
	speed: 0.0172s/iter; left time: 57.4509s
	iters: 200, epoch: 2 | loss: 0.6350219
	speed: 0.0060s/iter; left time: 19.4913s
	iters: 300, epoch: 2 | loss: 0.9979299
	speed: 0.0061s/iter; left time: 19.0734s
	iters: 400, epoch: 2 | loss: 0.6127060
	speed: 0.0060s/iter; left time: 18.2364s
Updating learning rate to 0.00164294717865
Epoch: 2 cost time: 3.0419230461120605
Epoch: 2, Steps: 490 | Train Loss: 0.8433554 Vali Loss: 0.6522621 Best vali loss: 0.6425897
	iters: 100, epoch: 3 | loss: 0.8820277
	speed: 0.0168s/iter; left time: 47.8001s
	iters: 200, epoch: 3 | loss: 1.1096042
	speed: 0.0062s/iter; left time: 16.9284s
	iters: 300, epoch: 3 | loss: 1.3556319
	speed: 0.0063s/iter; left time: 16.6705s
	iters: 400, epoch: 3 | loss: 0.4648392
	speed: 0.0060s/iter; left time: 15.3509s
Updating learning rate to 0.000821473589325
Epoch: 3 cost time: 3.0383152961730957
Epoch: 3, Steps: 490 | Train Loss: 0.9530258 Vali Loss: 0.6482465 Best vali loss: 0.6425897
	iters: 100, epoch: 4 | loss: 0.5901775
	speed: 0.0168s/iter; left time: 39.4861s
	iters: 200, epoch: 4 | loss: 1.6448246
	speed: 0.0059s/iter; left time: 13.1935s
	iters: 300, epoch: 4 | loss: 1.6491395
	speed: 0.0062s/iter; left time: 13.3509s
	iters: 400, epoch: 4 | loss: 0.4599321
	speed: 0.0061s/iter; left time: 12.5411s
Updating learning rate to 0.0004107367946625
Epoch: 4 cost time: 3.019188642501831
Epoch: 4, Steps: 490 | Train Loss: 1.0860184 Vali Loss: 0.6468848 Best vali loss: 0.6425897
	iters: 100, epoch: 5 | loss: 0.4412514
	speed: 0.0167s/iter; left time: 31.0891s
	iters: 200, epoch: 5 | loss: 0.6694649
	speed: 0.0059s/iter; left time: 10.4597s
	iters: 300, epoch: 5 | loss: 0.7010341
	speed: 0.0060s/iter; left time: 10.0218s
	iters: 400, epoch: 5 | loss: 0.8547878
	speed: 0.0043s/iter; left time: 6.6671s
Updating learning rate to 0.00020536839733125
Epoch: 5 cost time: 2.6689016819000244
Epoch: 5, Steps: 490 | Train Loss: 0.6666345 Vali Loss: 0.6440815 Best vali loss: 0.6425897
	iters: 100, epoch: 6 | loss: 0.9237415
	speed: 0.0157s/iter; left time: 21.5318s
	iters: 200, epoch: 6 | loss: 1.1774917
	speed: 0.0063s/iter; left time: 8.0157s
	iters: 300, epoch: 6 | loss: 1.0715121
	speed: 0.0053s/iter; left time: 6.1682s
	iters: 400, epoch: 6 | loss: 1.2368680
	speed: 0.0046s/iter; left time: 4.9213s
Updating learning rate to 0.000102684198665625
Epoch: 6 cost time: 2.847092390060425
Epoch: 6, Steps: 490 | Train Loss: 1.1024033 Vali Loss: 0.6443904 Best vali loss: 0.6425897
	iters: 100, epoch: 7 | loss: 1.3719273
	speed: 0.0171s/iter; left time: 15.0601s
	iters: 200, epoch: 7 | loss: 0.7110969
	speed: 0.0059s/iter; left time: 4.6300s
	iters: 300, epoch: 7 | loss: 1.0504762
	speed: 0.0044s/iter; left time: 3.0055s
	iters: 400, epoch: 7 | loss: 0.3865677
	speed: 0.0048s/iter; left time: 2.7916s
Updating learning rate to 5.13420993328125e-05
Epoch: 7 cost time: 2.701296091079712
Epoch: 7, Steps: 490 | Train Loss: 0.8800170 Vali Loss: 0.6437959 Best vali loss: 0.6425897
	iters: 100, epoch: 8 | loss: 1.1155310
	speed: 0.0143s/iter; left time: 5.5836s
	iters: 200, epoch: 8 | loss: 0.4639476
	speed: 0.0052s/iter; left time: 1.5175s
	iters: 300, epoch: 8 | loss: 1.3971876
	speed: 0.0054s/iter; left time: 1.0239s
	iters: 400, epoch: 8 | loss: 0.6109583
	speed: 0.0054s/iter; left time: 0.4915s
Updating learning rate to 2.567104966640625e-05
Epoch: 8 cost time: 2.6517889499664307
Epoch: 8, Steps: 490 | Train Loss: 0.8969061 Vali Loss: 0.6437970 Best vali loss: 0.6425897

best validation loss 0.6425897207650693

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029231680578149597
Validation loss decreased (inf --> 0.6220).  Saving model state dict ...
Epoch: 1 cost time: 0.7449564933776855
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6219932 Best vali loss: 0.6219932
Updating learning rate to 0.0025938006666821026
Validation loss decreased (0.6220 --> 0.6044).  Saving model state dict ...
Epoch: 2 cost time: 0.5003738403320312
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6044004 Best vali loss: 0.6044004
Updating learning rate to 0.0021008675310785706
Epoch: 3 cost time: 0.5152068138122559
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6245452 Best vali loss: 0.6044004

best validation loss 0.6044003769017545

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0118662500741, 'e_layers': 3, 'learning_rate': 0.0003750615196, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036078659049551044
Validation loss decreased (inf --> 0.6547).  Saving model state dict ...
Epoch: 1 cost time: 0.7576162815093994
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6547121 Best vali loss: 0.6547121
Updating learning rate to 0.0003201350317356456
Validation loss decreased (0.6547 --> 0.6256).  Saving model state dict ...
Epoch: 2 cost time: 0.5042955875396729
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6255850 Best vali loss: 0.6255850
Updating learning rate to 0.0002592956746342972
Validation loss decreased (0.6256 --> 0.6174).  Saving model state dict ...
Epoch: 3 cost time: 0.4897947311401367
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6174312 Best vali loss: 0.6174312

best validation loss 0.6174311707660811

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047627831688, 'e_layers': 3, 'learning_rate': 0.0015982189843, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6373942
	speed: 0.0107s/iter; left time: 82.6206s
	iters: 200, epoch: 1 | loss: 0.3842060
	speed: 0.0056s/iter; left time: 42.4473s
	iters: 300, epoch: 1 | loss: 0.4786446
	speed: 0.0053s/iter; left time: 40.0482s
	iters: 400, epoch: 1 | loss: 0.7510055
	speed: 0.0054s/iter; left time: 40.0267s
	iters: 500, epoch: 1 | loss: 0.4048541
	speed: 0.0054s/iter; left time: 39.5038s
	iters: 600, epoch: 1 | loss: 0.4267079
	speed: 0.0051s/iter; left time: 36.8336s
	iters: 700, epoch: 1 | loss: 0.7118944
	speed: 0.0052s/iter; left time: 36.8923s
	iters: 800, epoch: 1 | loss: 1.3084552
	speed: 0.0053s/iter; left time: 37.3897s
	iters: 900, epoch: 1 | loss: 0.5833261
	speed: 0.0054s/iter; left time: 37.6961s
Updating learning rate to 0.0015373903961828739
Validation loss decreased (inf --> 0.6557).  Saving model state dict ...
Epoch: 1 cost time: 5.497652292251587
Epoch: 1, Steps: 979 | Train Loss: 0.6318320 Vali Loss: 0.6557450 Best vali loss: 0.6557450
	iters: 100, epoch: 2 | loss: 1.8316582
	speed: 0.0171s/iter; left time: 115.6335s
	iters: 200, epoch: 2 | loss: 1.4466747
	speed: 0.0050s/iter; left time: 33.4568s
	iters: 300, epoch: 2 | loss: 1.9204113
	speed: 0.0048s/iter; left time: 31.5432s
	iters: 400, epoch: 2 | loss: 0.2451663
	speed: 0.0047s/iter; left time: 30.1022s
	iters: 500, epoch: 2 | loss: 1.7461216
	speed: 0.0047s/iter; left time: 29.6921s
	iters: 600, epoch: 2 | loss: 1.1176616
	speed: 0.0062s/iter; left time: 38.8317s
	iters: 700, epoch: 2 | loss: 1.0891263
	speed: 0.0062s/iter; left time: 38.0077s
	iters: 800, epoch: 2 | loss: 0.5655375
	speed: 0.0061s/iter; left time: 37.0730s
	iters: 900, epoch: 2 | loss: 1.3277110
	speed: 0.0060s/iter; left time: 35.5193s
Updating learning rate to 0.0013641652329598032
Epoch: 2 cost time: 5.44125509262085
Epoch: 2, Steps: 979 | Train Loss: 1.2544521 Vali Loss: 0.6586115 Best vali loss: 0.6557450
	iters: 100, epoch: 3 | loss: 0.6652477
	speed: 0.0162s/iter; left time: 93.6117s
	iters: 200, epoch: 3 | loss: 1.6623675
	speed: 0.0046s/iter; left time: 26.3775s
	iters: 300, epoch: 3 | loss: 0.4497470
	speed: 0.0047s/iter; left time: 26.1644s
	iters: 400, epoch: 3 | loss: 0.7005981
	speed: 0.0047s/iter; left time: 25.5393s
	iters: 500, epoch: 3 | loss: 1.2945180
	speed: 0.0048s/iter; left time: 25.7452s
	iters: 600, epoch: 3 | loss: 0.2954701
	speed: 0.0048s/iter; left time: 25.1740s
	iters: 700, epoch: 3 | loss: 0.7760332
	speed: 0.0047s/iter; left time: 24.3179s
	iters: 800, epoch: 3 | loss: 2.5050719
	speed: 0.0047s/iter; left time: 24.0655s
	iters: 900, epoch: 3 | loss: 0.9824753
	speed: 0.0046s/iter; left time: 22.7337s
Updating learning rate to 0.0011049154554414859
Validation loss decreased (0.6557 --> 0.6470).  Saving model state dict ...
Epoch: 3 cost time: 4.586756706237793
Epoch: 3, Steps: 979 | Train Loss: 1.0368365 Vali Loss: 0.6470217 Best vali loss: 0.6470217

best validation loss 0.6470216986883134

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00151941325245
Epoch: 4 cost time: 0.7355144023895264
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6225106 Best vali loss: 0.6044004
Updating learning rate to 0.0009379589738214294
Epoch: 5 cost time: 0.49074816703796387
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6303778 Best vali loss: 0.6044004
Updating learning rate to 0.0004450258382178974
Epoch: 6 cost time: 0.49588966369628906
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6453573 Best vali loss: 0.6044004
Updating learning rate to 0.0001156584470850403
Epoch: 7 cost time: 0.5023484230041504
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6451424 Best vali loss: 0.6044004
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5070691108703613
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6460907 Best vali loss: 0.6044004

best validation loss 0.6044003769017545

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0013602383229, 'e_layers': 1, 'learning_rate': 0.0004227075832, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5331389
	speed: 0.0082s/iter; left time: 63.3344s
	iters: 200, epoch: 1 | loss: 0.2211926
	speed: 0.0028s/iter; left time: 21.4505s
	iters: 300, epoch: 1 | loss: 1.1474055
	speed: 0.0028s/iter; left time: 21.3801s
	iters: 400, epoch: 1 | loss: 0.9626920
	speed: 0.0029s/iter; left time: 21.2129s
	iters: 500, epoch: 1 | loss: 0.3885189
	speed: 0.0030s/iter; left time: 22.2004s
	iters: 600, epoch: 1 | loss: 0.8265908
	speed: 0.0030s/iter; left time: 21.7521s
	iters: 700, epoch: 1 | loss: 0.7065563
	speed: 0.0030s/iter; left time: 21.1354s
	iters: 800, epoch: 1 | loss: 1.3169612
	speed: 0.0030s/iter; left time: 21.2070s
	iters: 900, epoch: 1 | loss: 0.8081266
	speed: 0.0030s/iter; left time: 20.7677s
Updating learning rate to 0.0004227075832
Validation loss decreased (inf --> 0.5996).  Saving model state dict ...
Epoch: 1 cost time: 3.1448755264282227
Epoch: 1, Steps: 979 | Train Loss: 0.8790203 Vali Loss: 0.5996236 Best vali loss: 0.5996236
	iters: 100, epoch: 2 | loss: 0.2720300
	speed: 0.0110s/iter; left time: 74.1590s
	iters: 200, epoch: 2 | loss: 2.3371568
	speed: 0.0030s/iter; left time: 20.2114s
	iters: 300, epoch: 2 | loss: 0.9995251
	speed: 0.0029s/iter; left time: 19.2541s
	iters: 400, epoch: 2 | loss: 0.8440530
	speed: 0.0030s/iter; left time: 19.3256s
	iters: 500, epoch: 2 | loss: 0.5499016
	speed: 0.0031s/iter; left time: 19.5331s
	iters: 600, epoch: 2 | loss: 1.2634333
	speed: 0.0031s/iter; left time: 19.3742s
	iters: 700, epoch: 2 | loss: 0.8341156
	speed: 0.0030s/iter; left time: 18.4927s
	iters: 800, epoch: 2 | loss: 0.3389435
	speed: 0.0030s/iter; left time: 18.0636s
	iters: 900, epoch: 2 | loss: 0.9368269
	speed: 0.0030s/iter; left time: 17.7695s
Updating learning rate to 0.0002113537916
Epoch: 2 cost time: 2.988497495651245
Epoch: 2, Steps: 979 | Train Loss: 0.9306651 Vali Loss: 0.6185614 Best vali loss: 0.5996236
	iters: 100, epoch: 3 | loss: 0.6626145
	speed: 0.0113s/iter; left time: 65.3409s
	iters: 200, epoch: 3 | loss: 0.6011151
	speed: 0.0030s/iter; left time: 17.1480s
	iters: 300, epoch: 3 | loss: 0.4902907
	speed: 0.0029s/iter; left time: 16.3760s
	iters: 400, epoch: 3 | loss: 1.4172765
	speed: 0.0030s/iter; left time: 16.2226s
	iters: 500, epoch: 3 | loss: 1.3675388
	speed: 0.0031s/iter; left time: 16.4731s
	iters: 600, epoch: 3 | loss: 1.1288098
	speed: 0.0030s/iter; left time: 15.8855s
	iters: 700, epoch: 3 | loss: 0.8045313
	speed: 0.0030s/iter; left time: 15.3752s
	iters: 800, epoch: 3 | loss: 0.5418088
	speed: 0.0031s/iter; left time: 15.5465s
	iters: 900, epoch: 3 | loss: 1.0070282
	speed: 0.0029s/iter; left time: 14.3241s
Updating learning rate to 0.0001056768958
Epoch: 3 cost time: 2.9793338775634766
Epoch: 3, Steps: 979 | Train Loss: 0.8912238 Vali Loss: 0.6407418 Best vali loss: 0.5996236
	iters: 100, epoch: 4 | loss: 0.9948934
	speed: 0.0110s/iter; left time: 52.8096s
	iters: 200, epoch: 4 | loss: 0.9443582
	speed: 0.0027s/iter; left time: 12.7607s
	iters: 300, epoch: 4 | loss: 0.6199676
	speed: 0.0027s/iter; left time: 12.4875s
	iters: 400, epoch: 4 | loss: 0.2617428
	speed: 0.0027s/iter; left time: 12.0549s
	iters: 500, epoch: 4 | loss: 1.1193501
	speed: 0.0027s/iter; left time: 11.9311s
	iters: 600, epoch: 4 | loss: 0.2721828
	speed: 0.0030s/iter; left time: 12.9688s
	iters: 700, epoch: 4 | loss: 0.9727780
	speed: 0.0029s/iter; left time: 12.3113s
	iters: 800, epoch: 4 | loss: 0.6139354
	speed: 0.0030s/iter; left time: 12.1941s
	iters: 900, epoch: 4 | loss: 0.6764691
	speed: 0.0028s/iter; left time: 11.3574s
Updating learning rate to 5.28384479e-05
Epoch: 4 cost time: 2.8062744140625
Epoch: 4, Steps: 979 | Train Loss: 0.7195197 Vali Loss: 0.6690971 Best vali loss: 0.5996236
	iters: 100, epoch: 5 | loss: 0.6209447
	speed: 0.0111s/iter; left time: 42.2058s
	iters: 200, epoch: 5 | loss: 0.3530464
	speed: 0.0030s/iter; left time: 11.3019s
	iters: 300, epoch: 5 | loss: 0.3865631
	speed: 0.0030s/iter; left time: 10.9097s
	iters: 400, epoch: 5 | loss: 0.3267079
	speed: 0.0029s/iter; left time: 10.1573s
	iters: 500, epoch: 5 | loss: 0.4755707
	speed: 0.0028s/iter; left time: 9.4114s
	iters: 600, epoch: 5 | loss: 1.0446516
	speed: 0.0028s/iter; left time: 9.3907s
	iters: 700, epoch: 5 | loss: 0.8477780
	speed: 0.0030s/iter; left time: 9.5439s
	iters: 800, epoch: 5 | loss: 0.6223668
	speed: 0.0030s/iter; left time: 9.2118s
	iters: 900, epoch: 5 | loss: 0.5444632
	speed: 0.0030s/iter; left time: 8.9880s
Updating learning rate to 2.641922395e-05
Epoch: 5 cost time: 2.925232172012329
Epoch: 5, Steps: 979 | Train Loss: 0.5802325 Vali Loss: 0.6478510 Best vali loss: 0.5996236
	iters: 100, epoch: 6 | loss: 0.4686192
	speed: 0.0110s/iter; left time: 31.3516s
	iters: 200, epoch: 6 | loss: 0.8120765
	speed: 0.0030s/iter; left time: 8.3480s
	iters: 300, epoch: 6 | loss: 0.6914338
	speed: 0.0030s/iter; left time: 7.8098s
	iters: 400, epoch: 6 | loss: 0.8692842
	speed: 0.0029s/iter; left time: 7.4165s
	iters: 500, epoch: 6 | loss: 0.5087116
	speed: 0.0026s/iter; left time: 6.3595s
	iters: 600, epoch: 6 | loss: 0.6977777
	speed: 0.0027s/iter; left time: 6.3370s
	iters: 700, epoch: 6 | loss: 0.5929801
	speed: 0.0025s/iter; left time: 5.5870s
	iters: 800, epoch: 6 | loss: 0.8112724
	speed: 0.0024s/iter; left time: 5.1630s
	iters: 900, epoch: 6 | loss: 0.4724400
	speed: 0.0024s/iter; left time: 4.9235s
Updating learning rate to 1.3209611975e-05
Epoch: 6 cost time: 2.7088584899902344
Epoch: 6, Steps: 979 | Train Loss: 0.6582884 Vali Loss: 0.6504070 Best vali loss: 0.5996236
	iters: 100, epoch: 7 | loss: 1.2495917
	speed: 0.0136s/iter; left time: 25.2777s
	iters: 200, epoch: 7 | loss: 1.0932893
	speed: 0.0036s/iter; left time: 6.2889s
	iters: 300, epoch: 7 | loss: 0.9940850
	speed: 0.0034s/iter; left time: 5.5613s
	iters: 400, epoch: 7 | loss: 0.4732685
	speed: 0.0031s/iter; left time: 4.8841s
	iters: 500, epoch: 7 | loss: 1.1148750
	speed: 0.0034s/iter; left time: 5.0068s
	iters: 600, epoch: 7 | loss: 0.4225768
	speed: 0.0034s/iter; left time: 4.5952s
	iters: 700, epoch: 7 | loss: 1.1005131
	speed: 0.0036s/iter; left time: 4.4951s
	iters: 800, epoch: 7 | loss: 0.9262400
	speed: 0.0033s/iter; left time: 3.8551s
	iters: 900, epoch: 7 | loss: 0.4593694
	speed: 0.0033s/iter; left time: 3.5381s
Updating learning rate to 6.6048059875e-06
Epoch: 7 cost time: 3.356778144836426
Epoch: 7, Steps: 979 | Train Loss: 0.8704232 Vali Loss: 0.6561743 Best vali loss: 0.5996236
	iters: 100, epoch: 8 | loss: 0.2553410
	speed: 0.0135s/iter; left time: 11.8813s
	iters: 200, epoch: 8 | loss: 1.2535341
	speed: 0.0031s/iter; left time: 2.4140s
	iters: 300, epoch: 8 | loss: 0.6262520
	speed: 0.0035s/iter; left time: 2.3901s
	iters: 400, epoch: 8 | loss: 0.5717208
	speed: 0.0035s/iter; left time: 2.0422s
	iters: 500, epoch: 8 | loss: 0.9710172
	speed: 0.0033s/iter; left time: 1.5925s
	iters: 600, epoch: 8 | loss: 0.9785136
	speed: 0.0032s/iter; left time: 1.2158s
	iters: 700, epoch: 8 | loss: 0.4878305
	speed: 0.0032s/iter; left time: 0.8964s
	iters: 800, epoch: 8 | loss: 0.6224914
	speed: 0.0037s/iter; left time: 0.6604s
	iters: 900, epoch: 8 | loss: 0.5322659
	speed: 0.0032s/iter; left time: 0.2550s
Updating learning rate to 3.30240299375e-06
Epoch: 8 cost time: 3.290461301803589
Epoch: 8, Steps: 979 | Train Loss: 0.6998852 Vali Loss: 0.6571684 Best vali loss: 0.5996236

best validation loss 0.5996236012027198

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010436703114, 'e_layers': 3, 'learning_rate': 0.0001549877333, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9576374
	speed: 0.0119s/iter; left time: 22.2263s
	iters: 200, epoch: 1 | loss: 0.8051615
	speed: 0.0064s/iter; left time: 11.2403s
Updating learning rate to 0.0001549877333
Validation loss decreased (inf --> 0.6303).  Saving model state dict ...
Epoch: 1 cost time: 1.8562393188476562
Epoch: 1, Steps: 245 | Train Loss: 0.8813995 Vali Loss: 0.6303369 Best vali loss: 0.6303369
	iters: 100, epoch: 2 | loss: 1.0535364
	speed: 0.0132s/iter; left time: 21.3246s
	iters: 200, epoch: 2 | loss: 0.5950061
	speed: 0.0062s/iter; left time: 9.3275s
Updating learning rate to 7.749386665e-05
Validation loss decreased (0.6303 --> 0.6072).  Saving model state dict ...
Epoch: 2 cost time: 1.6074447631835938
Epoch: 2, Steps: 245 | Train Loss: 0.8242713 Vali Loss: 0.6071559 Best vali loss: 0.6071559
	iters: 100, epoch: 3 | loss: 0.8402239
	speed: 0.0129s/iter; left time: 17.6263s
	iters: 200, epoch: 3 | loss: 0.8077331
	speed: 0.0062s/iter; left time: 7.9096s
Updating learning rate to 3.8746933325e-05
Epoch: 3 cost time: 1.5867843627929688
Epoch: 3, Steps: 245 | Train Loss: 0.8239785 Vali Loss: 0.6103819 Best vali loss: 0.6071559
	iters: 100, epoch: 4 | loss: 0.8815715
	speed: 0.0117s/iter; left time: 13.1314s
	iters: 200, epoch: 4 | loss: 0.5975599
	speed: 0.0048s/iter; left time: 4.9647s
Updating learning rate to 1.93734666625e-05
Validation loss decreased (0.6072 --> 0.6068).  Saving model state dict ...
Epoch: 4 cost time: 1.35026216506958
Epoch: 4, Steps: 245 | Train Loss: 0.7395657 Vali Loss: 0.6067570 Best vali loss: 0.6067570
	iters: 100, epoch: 5 | loss: 1.2628063
	speed: 0.0130s/iter; left time: 11.4248s
	iters: 200, epoch: 5 | loss: 0.7336659
	speed: 0.0065s/iter; left time: 5.0792s
Updating learning rate to 9.68673333125e-06
Validation loss decreased (0.6068 --> 0.6064).  Saving model state dict ...
Epoch: 5 cost time: 1.599241018295288
Epoch: 5, Steps: 245 | Train Loss: 0.9982361 Vali Loss: 0.6064300 Best vali loss: 0.6064300
	iters: 100, epoch: 6 | loss: 0.7033538
	speed: 0.0127s/iter; left time: 8.0628s
	iters: 200, epoch: 6 | loss: 0.7256936
	speed: 0.0046s/iter; left time: 2.4571s
Updating learning rate to 4.843366665625e-06
Epoch: 6 cost time: 1.3325481414794922
Epoch: 6, Steps: 245 | Train Loss: 0.7145237 Vali Loss: 0.6065016 Best vali loss: 0.6064300
	iters: 100, epoch: 7 | loss: 0.8392672
	speed: 0.0128s/iter; left time: 4.9895s
	iters: 200, epoch: 7 | loss: 0.8167204
	speed: 0.0069s/iter; left time: 2.0181s
Updating learning rate to 2.4216833328125e-06
Epoch: 7 cost time: 1.7438511848449707
Epoch: 7, Steps: 245 | Train Loss: 0.8279938 Vali Loss: 0.6064515 Best vali loss: 0.6064300
	iters: 100, epoch: 8 | loss: 0.4770941
	speed: 0.0109s/iter; left time: 1.5938s
	iters: 200, epoch: 8 | loss: 0.7186532
	speed: 0.0063s/iter; left time: 0.2883s
Updating learning rate to 1.21084166640625e-06
Epoch: 8 cost time: 1.471585988998413
Epoch: 8, Steps: 245 | Train Loss: 0.5978737 Vali Loss: 0.6064338 Best vali loss: 0.6064300

best validation loss 0.6064300043529959

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.010984893356, 'e_layers': 2, 'learning_rate': 0.001815341793, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7980891
	speed: 0.0131s/iter; left time: 11.6290s
Updating learning rate to 0.001815341793
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 1.2047293186187744
Epoch: 1, Steps: 123 | Train Loss: 0.7980891 Vali Loss: 0.6111710 Best vali loss: 0.6111710
	iters: 100, epoch: 2 | loss: 0.6816033
	speed: 0.0111s/iter; left time: 8.4531s
Updating learning rate to 0.0009076708965
Epoch: 2 cost time: 0.8006820678710938
Epoch: 2, Steps: 123 | Train Loss: 0.6816033 Vali Loss: 0.6613818 Best vali loss: 0.6111710
	iters: 100, epoch: 3 | loss: 0.8049802
	speed: 0.0088s/iter; left time: 5.6191s
Updating learning rate to 0.00045383544825
Epoch: 3 cost time: 0.7785882949829102
Epoch: 3, Steps: 123 | Train Loss: 0.8049802 Vali Loss: 0.6524794 Best vali loss: 0.6111710

best validation loss 0.6111710422406423

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0018477877600639972
Validation loss decreased (inf --> 0.6280).  Saving model state dict ...
Epoch: 1 cost time: 1.0018587112426758
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6279723 Best vali loss: 0.6279723
Updating learning rate to 0.0016395886343680123
Validation loss decreased (0.6280 --> 0.6043).  Saving model state dict ...
Epoch: 2 cost time: 0.7484545707702637
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6042967 Best vali loss: 0.6042967
Updating learning rate to 0.0013279966230694852
Validation loss decreased (0.6043 --> 0.5703).  Saving model state dict ...
Epoch: 3 cost time: 0.7036585807800293
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5703194 Best vali loss: 0.5703194

best validation loss 0.570319421392853

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9254093
	speed: 0.0109s/iter; left time: 20.2236s
	iters: 200, epoch: 1 | loss: 1.1073973
	speed: 0.0045s/iter; left time: 7.8651s
Updating learning rate to 0.0006618030633303181
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.4608981609344482
Epoch: 1, Steps: 245 | Train Loss: 1.0164033 Vali Loss: 0.6171626 Best vali loss: 0.6171626
	iters: 100, epoch: 2 | loss: 0.9790778
	speed: 0.0078s/iter; left time: 12.6652s
	iters: 200, epoch: 2 | loss: 0.7935567
	speed: 0.0031s/iter; left time: 4.6559s
Updating learning rate to 0.0005872345321676674
Validation loss decreased (0.6172 --> 0.5979).  Saving model state dict ...
Epoch: 2 cost time: 0.8405449390411377
Epoch: 2, Steps: 245 | Train Loss: 0.8863173 Vali Loss: 0.5978794 Best vali loss: 0.5978794
	iters: 100, epoch: 3 | loss: 0.6041198
	speed: 0.0100s/iter; left time: 13.6500s
	iters: 200, epoch: 3 | loss: 0.7181655
	speed: 0.0043s/iter; left time: 5.5282s
Updating learning rate to 0.0004756348387161433
Epoch: 3 cost time: 1.1632311344146729
Epoch: 3, Steps: 245 | Train Loss: 0.6611426 Vali Loss: 0.6140603 Best vali loss: 0.5978794

best validation loss 0.5978794068663499

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0009604487853
Epoch: 4 cost time: 0.9430246353149414
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5867889 Best vali loss: 0.5703194
Updating learning rate to 0.0005929009475305148
Validation loss decreased (0.5703 --> 0.5656).  Saving model state dict ...
Epoch: 5 cost time: 0.6846144199371338
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5655871 Best vali loss: 0.5655871
Updating learning rate to 0.0002813089362319876
Validation loss decreased (0.5656 --> 0.5629).  Saving model state dict ...
Epoch: 6 cost time: 0.581298828125
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5628838 Best vali loss: 0.5628838
Updating learning rate to 7.31098105360028e-05
Validation loss decreased (0.5629 --> 0.5517).  Saving model state dict ...
Epoch: 7 cost time: 0.5521619319915771
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5516856 Best vali loss: 0.5516856
Updating learning rate to 0.0
Epoch: 8 cost time: 0.59423828125
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5519997 Best vali loss: 0.5516856

best validation loss 0.5516855701259417

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032599720922, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.6813).  Saving model state dict ...
Epoch: 1 cost time: 0.7757818698883057
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6812706 Best vali loss: 0.6812706
Updating learning rate to 0.0002152265254906771
Validation loss decreased (0.6813 --> 0.6541).  Saving model state dict ...
Epoch: 2 cost time: 0.5091743469238281
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6540830 Best vali loss: 0.6540830
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.6541 --> 0.6367).  Saving model state dict ...
Epoch: 3 cost time: 0.5154769420623779
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6366734 Best vali loss: 0.6366734
Updating learning rate to 0.00012607677965
Validation loss decreased (0.6367 --> 0.6262).  Saving model state dict ...
Epoch: 4 cost time: 0.5835027694702148
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6261700 Best vali loss: 0.6261700
Updating learning rate to 7.782928487200091e-05
Validation loss decreased (0.6262 --> 0.6213).  Saving model state dict ...
Epoch: 5 cost time: 0.5363547801971436
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6212587 Best vali loss: 0.6212587
Updating learning rate to 3.692703380932289e-05
Validation loss decreased (0.6213 --> 0.6186).  Saving model state dict ...
Epoch: 6 cost time: 0.5307095050811768
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6186482 Best vali loss: 0.6186482
Updating learning rate to 9.59702340642949e-06
Validation loss decreased (0.6186 --> 0.6172).  Saving model state dict ...
Epoch: 7 cost time: 0.5237648487091064
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6171625 Best vali loss: 0.6171625
Updating learning rate to 0.0
Validation loss decreased (0.6172 --> 0.6170).  Saving model state dict ...
Epoch: 8 cost time: 0.523474931716919
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6169781 Best vali loss: 0.6169781

best validation loss 0.6169780835074884

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 3, 'learning_rate': 0.0006514874423, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0061377
	speed: 0.0133s/iter; left time: 11.7727s
Updating learning rate to 0.0006514874423
Validation loss decreased (inf --> 0.6027).  Saving model state dict ...
Epoch: 1 cost time: 1.1726868152618408
Epoch: 1, Steps: 123 | Train Loss: 1.0061377 Vali Loss: 0.6026967 Best vali loss: 0.6026967
	iters: 100, epoch: 2 | loss: 0.7721919
	speed: 0.0092s/iter; left time: 7.0089s
Updating learning rate to 0.00032574372115
Epoch: 2 cost time: 0.8151636123657227
Epoch: 2, Steps: 123 | Train Loss: 0.7721919 Vali Loss: 0.6427876 Best vali loss: 0.6026967
	iters: 100, epoch: 3 | loss: 0.6380255
	speed: 0.0129s/iter; left time: 8.2360s
Updating learning rate to 0.000162871860575
Validation loss decreased (0.6027 --> 0.5566).  Saving model state dict ...
Epoch: 3 cost time: 0.996354341506958
Epoch: 3, Steps: 123 | Train Loss: 0.6380255 Vali Loss: 0.5566061 Best vali loss: 0.5566061
	iters: 100, epoch: 4 | loss: 0.8467974
	speed: 0.0126s/iter; left time: 6.4965s
Updating learning rate to 8.14359302875e-05
Validation loss decreased (0.5566 --> 0.5496).  Saving model state dict ...
Epoch: 4 cost time: 0.9749443531036377
Epoch: 4, Steps: 123 | Train Loss: 0.8467974 Vali Loss: 0.5495641 Best vali loss: 0.5495641
	iters: 100, epoch: 5 | loss: 0.7397822
	speed: 0.0087s/iter; left time: 3.4010s
Updating learning rate to 4.071796514375e-05
Validation loss decreased (0.5496 --> 0.5446).  Saving model state dict ...
Epoch: 5 cost time: 0.7218484878540039
Epoch: 5, Steps: 123 | Train Loss: 0.7397822 Vali Loss: 0.5446328 Best vali loss: 0.5446328
	iters: 100, epoch: 6 | loss: 0.5131750
	speed: 0.0100s/iter; left time: 2.6916s
Updating learning rate to 2.0358982571875e-05
Validation loss decreased (0.5446 --> 0.5422).  Saving model state dict ...
Epoch: 6 cost time: 0.8164968490600586
Epoch: 6, Steps: 123 | Train Loss: 0.5131750 Vali Loss: 0.5422452 Best vali loss: 0.5422452
	iters: 100, epoch: 7 | loss: 0.9092557
	speed: 0.0100s/iter; left time: 1.4660s
Updating learning rate to 1.01794912859375e-05
Validation loss decreased (0.5422 --> 0.5420).  Saving model state dict ...
Epoch: 7 cost time: 0.8186228275299072
Epoch: 7, Steps: 123 | Train Loss: 0.9092557 Vali Loss: 0.5419669 Best vali loss: 0.5419669
	iters: 100, epoch: 8 | loss: 0.8723897
	speed: 0.0103s/iter; left time: 0.2481s
Updating learning rate to 5.08974564296875e-06
Validation loss decreased (0.5420 --> 0.5414).  Saving model state dict ...
Epoch: 8 cost time: 0.8508272171020508
Epoch: 8, Steps: 123 | Train Loss: 0.8723897 Vali Loss: 0.5414124 Best vali loss: 0.5414124

best validation loss 0.5414123852073126

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0065094553439, 'e_layers': 1, 'learning_rate': 0.0006735335754, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8163943
	speed: 0.0095s/iter; left time: 8.4256s
Updating learning rate to 0.0006478987300856038
Validation loss decreased (inf --> 0.6198).  Saving model state dict ...
Epoch: 1 cost time: 0.7767069339752197
Epoch: 1, Steps: 123 | Train Loss: 0.8163943 Vali Loss: 0.6197633 Best vali loss: 0.6197633
	iters: 100, epoch: 2 | loss: 0.6871451
	speed: 0.0070s/iter; left time: 5.3622s
Updating learning rate to 0.0005748968669610804
Validation loss decreased (0.6198 --> 0.6053).  Saving model state dict ...
Epoch: 2 cost time: 0.5428445339202881
Epoch: 2, Steps: 123 | Train Loss: 0.6871451 Vali Loss: 0.6053376 Best vali loss: 0.6053376
	iters: 100, epoch: 3 | loss: 0.8797929
	speed: 0.0074s/iter; left time: 4.7439s
Updating learning rate to 0.00046564185792360155
Validation loss decreased (0.6053 --> 0.6002).  Saving model state dict ...
Epoch: 3 cost time: 0.5735740661621094
Epoch: 3, Steps: 123 | Train Loss: 0.8797929 Vali Loss: 0.6002454 Best vali loss: 0.6002454

best validation loss 0.6002453846657845

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029036262858, 'e_layers': 2, 'learning_rate': 0.0030636692136, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5704647
	speed: 0.0101s/iter; left time: 77.8532s
	iters: 200, epoch: 1 | loss: 0.5382348
	speed: 0.0043s/iter; left time: 33.1571s
	iters: 300, epoch: 1 | loss: 0.4674197
	speed: 0.0046s/iter; left time: 34.3441s
	iters: 400, epoch: 1 | loss: 0.3604046
	speed: 0.0044s/iter; left time: 32.8813s
	iters: 500, epoch: 1 | loss: 0.4510529
	speed: 0.0043s/iter; left time: 31.4723s
	iters: 600, epoch: 1 | loss: 0.3289902
	speed: 0.0045s/iter; left time: 32.2801s
	iters: 700, epoch: 1 | loss: 0.9856008
	speed: 0.0044s/iter; left time: 31.4034s
	iters: 800, epoch: 1 | loss: 0.8639445
	speed: 0.0045s/iter; left time: 31.6360s
	iters: 900, epoch: 1 | loss: 0.8617792
	speed: 0.0045s/iter; left time: 31.3815s
Updating learning rate to 0.0030636692136
Validation loss decreased (inf --> 0.6327).  Saving model state dict ...
Epoch: 1 cost time: 4.649581670761108
Epoch: 1, Steps: 979 | Train Loss: 0.6030991 Vali Loss: 0.6326870 Best vali loss: 0.6326870
	iters: 100, epoch: 2 | loss: 0.5188016
	speed: 0.0150s/iter; left time: 101.1074s
	iters: 200, epoch: 2 | loss: 0.6576025
	speed: 0.0045s/iter; left time: 29.7225s
	iters: 300, epoch: 2 | loss: 0.9634458
	speed: 0.0046s/iter; left time: 29.9689s
	iters: 400, epoch: 2 | loss: 0.8716251
	speed: 0.0047s/iter; left time: 30.0447s
	iters: 500, epoch: 2 | loss: 1.2497258
	speed: 0.0045s/iter; left time: 28.6060s
	iters: 600, epoch: 2 | loss: 0.5465289
	speed: 0.0043s/iter; left time: 26.7545s
	iters: 700, epoch: 2 | loss: 0.2740017
	speed: 0.0039s/iter; left time: 23.8398s
	iters: 800, epoch: 2 | loss: 1.5904983
	speed: 0.0036s/iter; left time: 22.0204s
	iters: 900, epoch: 2 | loss: 0.8291895
	speed: 0.0035s/iter; left time: 21.0048s
Updating learning rate to 0.0015318346068
Epoch: 2 cost time: 4.134287357330322
Epoch: 2, Steps: 979 | Train Loss: 0.8334910 Vali Loss: 0.6428513 Best vali loss: 0.6326870
	iters: 100, epoch: 3 | loss: 0.4407874
	speed: 0.0210s/iter; left time: 121.3599s
	iters: 200, epoch: 3 | loss: 1.1755047
	speed: 0.0073s/iter; left time: 41.6807s
	iters: 300, epoch: 3 | loss: 0.9043165
	speed: 0.0037s/iter; left time: 20.7197s
	iters: 400, epoch: 3 | loss: 0.4739835
	speed: 0.0032s/iter; left time: 17.6272s
	iters: 500, epoch: 3 | loss: 1.0825881
	speed: 0.0034s/iter; left time: 18.3670s
	iters: 600, epoch: 3 | loss: 1.5902764
	speed: 0.0073s/iter; left time: 38.2755s
	iters: 700, epoch: 3 | loss: 0.4477338
	speed: 0.0074s/iter; left time: 38.3284s
	iters: 800, epoch: 3 | loss: 1.4808344
	speed: 0.0066s/iter; left time: 33.3763s
	iters: 900, epoch: 3 | loss: 0.6927936
	speed: 0.0066s/iter; left time: 32.5872s
Updating learning rate to 0.0007659173034
Epoch: 3 cost time: 5.983842849731445
Epoch: 3, Steps: 979 | Train Loss: 0.9209798 Vali Loss: 0.6411844 Best vali loss: 0.6326870

best validation loss 0.6326870019860094

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001591137315
Validation loss decreased (inf --> 0.6005).  Saving model state dict ...
Epoch: 1 cost time: 1.219170331954956
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6005051 Best vali loss: 0.6005051
Updating learning rate to 7.955686575e-05
Validation loss decreased (0.6005 --> 0.5941).  Saving model state dict ...
Epoch: 2 cost time: 0.9339032173156738
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5941438 Best vali loss: 0.5941438
Updating learning rate to 3.9778432875e-05
Validation loss decreased (0.5941 --> 0.5756).  Saving model state dict ...
Epoch: 3 cost time: 0.8505830764770508
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5756471 Best vali loss: 0.5756471

best validation loss 0.5756470847604231

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.98892164375e-05
Validation loss decreased (0.5756 --> 0.5438).  Saving model state dict ...
Epoch: 4 cost time: 1.1928088665008545
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5438290 Best vali loss: 0.5438290
Updating learning rate to 9.94460821875e-06
Validation loss decreased (0.5438 --> 0.5423).  Saving model state dict ...
Epoch: 5 cost time: 0.8847475051879883
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5422513 Best vali loss: 0.5422513
Updating learning rate to 4.972304109375e-06
Validation loss decreased (0.5423 --> 0.5408).  Saving model state dict ...
Epoch: 6 cost time: 0.8112227916717529
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5407964 Best vali loss: 0.5407964
Updating learning rate to 2.4861520546875e-06
Validation loss decreased (0.5408 --> 0.5402).  Saving model state dict ...
Epoch: 7 cost time: 0.7821524143218994
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5402488 Best vali loss: 0.5402488
Updating learning rate to 1.24307602734375e-06
Epoch: 8 cost time: 0.748218297958374
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5403135 Best vali loss: 0.5402488

best validation loss 0.5402488162924658

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.01186370118, 'e_layers': 4, 'learning_rate': 0.0002221655976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002221655976
Validation loss decreased (inf --> 0.6030).  Saving model state dict ...
Epoch: 1 cost time: 1.21901273727417
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6029714 Best vali loss: 0.6029714
Updating learning rate to 0.0001110827988
Validation loss decreased (0.6030 --> 0.6016).  Saving model state dict ...
Epoch: 2 cost time: 0.9358835220336914
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6016124 Best vali loss: 0.6016124
Updating learning rate to 5.55413994e-05
Epoch: 3 cost time: 0.9602704048156738
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6036696 Best vali loss: 0.6016124
Updating learning rate to 2.77706997e-05
Validation loss decreased (0.6016 --> 0.5905).  Saving model state dict ...
Epoch: 4 cost time: 1.0130085945129395
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5905448 Best vali loss: 0.5905448
Updating learning rate to 1.388534985e-05
Validation loss decreased (0.5905 --> 0.5663).  Saving model state dict ...
Epoch: 5 cost time: 1.0481069087982178
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5662638 Best vali loss: 0.5662638
Updating learning rate to 6.942674925e-06
Epoch: 6 cost time: 1.0642731189727783
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5671657 Best vali loss: 0.5662638
Updating learning rate to 3.4713374625e-06
Validation loss decreased (0.5663 --> 0.5606).  Saving model state dict ...
Epoch: 7 cost time: 0.9678380489349365
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5605679 Best vali loss: 0.5605679
Updating learning rate to 1.73566873125e-06
Epoch: 8 cost time: 0.620957612991333
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5615809 Best vali loss: 0.5605679

best validation loss 0.5605679168187044

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014508988157, 'e_layers': 3, 'learning_rate': 0.0010889710455, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010889710455
Validation loss decreased (inf --> 0.6062).  Saving model state dict ...
Epoch: 1 cost time: 0.8715884685516357
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6061768 Best vali loss: 0.6061768
Updating learning rate to 0.00054448552275
Epoch: 2 cost time: 0.5123574733734131
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6126596 Best vali loss: 0.6061768
Updating learning rate to 0.000272242761375
Epoch: 3 cost time: 0.6126482486724854
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6138443 Best vali loss: 0.6061768
Updating learning rate to 0.0001361213806875
Epoch: 4 cost time: 0.6181895732879639
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6161120 Best vali loss: 0.6061768
Updating learning rate to 6.806069034375e-05
Epoch: 5 cost time: 0.6183383464813232
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6206774 Best vali loss: 0.6061768
Updating learning rate to 3.4030345171875e-05
Epoch: 6 cost time: 0.6009886264801025
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6199405 Best vali loss: 0.6061768
Updating learning rate to 1.70151725859375e-05
Epoch: 7 cost time: 0.6134965419769287
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6148121 Best vali loss: 0.6061768
Updating learning rate to 8.50758629296875e-06
Epoch: 8 cost time: 0.6106827259063721
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6130196 Best vali loss: 0.6061768

best validation loss 0.6061767907343436

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005760452490497884
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 0.6737947463989258
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6490142 Best vali loss: 0.6490142
Updating learning rate to 0.0005111394628953558
Validation loss decreased (0.6490 --> 0.6195).  Saving model state dict ...
Epoch: 2 cost time: 0.45094871520996094
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6195363 Best vali loss: 0.6195363
Updating learning rate to 0.00041400108930629814
Validation loss decreased (0.6195 --> 0.6107).  Saving model state dict ...
Epoch: 3 cost time: 0.4292640686035156
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6106937 Best vali loss: 0.6106937

best validation loss 0.6106936591524373

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 2, 'learning_rate': 0.0015995261445, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5346898
	speed: 0.0099s/iter; left time: 76.2510s
	iters: 200, epoch: 1 | loss: 0.3633380
	speed: 0.0044s/iter; left time: 33.9505s
	iters: 300, epoch: 1 | loss: 1.1729894
	speed: 0.0044s/iter; left time: 32.9947s
	iters: 400, epoch: 1 | loss: 1.5081192
	speed: 0.0043s/iter; left time: 31.9067s
	iters: 500, epoch: 1 | loss: 0.7183405
	speed: 0.0042s/iter; left time: 30.7207s
	iters: 600, epoch: 1 | loss: 0.6193319
	speed: 0.0040s/iter; left time: 29.1850s
	iters: 700, epoch: 1 | loss: 0.6700582
	speed: 0.0040s/iter; left time: 28.8043s
	iters: 800, epoch: 1 | loss: 1.1022677
	speed: 0.0043s/iter; left time: 30.2629s
	iters: 900, epoch: 1 | loss: 0.6428863
	speed: 0.0043s/iter; left time: 29.5326s
Updating learning rate to 0.0015386478055601205
Validation loss decreased (inf --> 0.6358).  Saving model state dict ...
Epoch: 1 cost time: 4.470191955566406
Epoch: 1, Steps: 979 | Train Loss: 0.8146690 Vali Loss: 0.6357881 Best vali loss: 0.6357881
	iters: 100, epoch: 2 | loss: 0.6522033
	speed: 0.0147s/iter; left time: 98.9735s
	iters: 200, epoch: 2 | loss: 0.6811314
	speed: 0.0043s/iter; left time: 28.6249s
	iters: 300, epoch: 2 | loss: 0.3642897
	speed: 0.0043s/iter; left time: 28.2113s
	iters: 400, epoch: 2 | loss: 0.6319972
	speed: 0.0043s/iter; left time: 27.5908s
	iters: 500, epoch: 2 | loss: 1.3262037
	speed: 0.0043s/iter; left time: 27.3397s
	iters: 600, epoch: 2 | loss: 0.5037419
	speed: 0.0041s/iter; left time: 25.6856s
	iters: 700, epoch: 2 | loss: 1.3301237
	speed: 0.0041s/iter; left time: 25.3136s
	iters: 800, epoch: 2 | loss: 0.3509944
	speed: 0.0035s/iter; left time: 21.3027s
	iters: 900, epoch: 2 | loss: 0.6873802
	speed: 0.0036s/iter; left time: 21.1653s
Updating learning rate to 0.0013652809639805618
Validation loss decreased (0.6358 --> 0.6281).  Saving model state dict ...
Epoch: 2 cost time: 4.071979522705078
Epoch: 2, Steps: 979 | Train Loss: 0.7253406 Vali Loss: 0.6281245 Best vali loss: 0.6281245
	iters: 100, epoch: 3 | loss: 1.0794163
	speed: 0.0170s/iter; left time: 98.1312s
	iters: 200, epoch: 3 | loss: 0.8651470
	speed: 0.0046s/iter; left time: 25.8596s
	iters: 300, epoch: 3 | loss: 0.8007134
	speed: 0.0055s/iter; left time: 30.8564s
	iters: 400, epoch: 3 | loss: 0.9314712
	speed: 0.0051s/iter; left time: 27.8346s
	iters: 500, epoch: 3 | loss: 0.3100969
	speed: 0.0049s/iter; left time: 26.4632s
	iters: 600, epoch: 3 | loss: 1.8759712
	speed: 0.0047s/iter; left time: 24.8918s
	iters: 700, epoch: 3 | loss: 0.3276834
	speed: 0.0051s/iter; left time: 26.6229s
	iters: 800, epoch: 3 | loss: 1.8352711
	speed: 0.0053s/iter; left time: 26.8992s
	iters: 900, epoch: 3 | loss: 1.4503117
	speed: 0.0050s/iter; left time: 24.9327s
Updating learning rate to 0.0011058191498174795
Epoch: 3 cost time: 4.9042747020721436
Epoch: 3, Steps: 979 | Train Loss: 1.0528980 Vali Loss: 0.6363079 Best vali loss: 0.6281245

best validation loss 0.6281244521723583

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001776105869, 'e_layers': 3, 'learning_rate': 0.0035322605912, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0581720
	speed: 0.0122s/iter; left time: 22.6581s
	iters: 200, epoch: 1 | loss: 1.1998557
	speed: 0.0066s/iter; left time: 11.5822s
Updating learning rate to 0.0033978219274529487
Validation loss decreased (inf --> 0.6346).  Saving model state dict ...
Epoch: 1 cost time: 1.8948643207550049
Epoch: 1, Steps: 245 | Train Loss: 1.1290138 Vali Loss: 0.6346346 Best vali loss: 0.6346346
	iters: 100, epoch: 2 | loss: 0.7753407
	speed: 0.0119s/iter; left time: 19.1836s
	iters: 200, epoch: 2 | loss: 0.6882630
	speed: 0.0059s/iter; left time: 8.9129s
Updating learning rate to 0.003014973004077762
Epoch: 2 cost time: 1.4548931121826172
Epoch: 2, Steps: 245 | Train Loss: 0.7318019 Vali Loss: 0.6560980 Best vali loss: 0.6346346
	iters: 100, epoch: 3 | loss: 1.0042504
	speed: 0.0145s/iter; left time: 19.9202s
	iters: 200, epoch: 3 | loss: 0.7289553
	speed: 0.0074s/iter; left time: 9.4359s
Updating learning rate to 0.0024419990991241787
Epoch: 3 cost time: 1.8866515159606934
Epoch: 3, Steps: 245 | Train Loss: 0.8666028 Vali Loss: 0.6530739 Best vali loss: 0.6346346

best validation loss 0.6346345621366735

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002994185651
Validation loss decreased (0.6107 --> 0.6052).  Saving model state dict ...
Epoch: 4 cost time: 0.768151044845581
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6051859 Best vali loss: 0.6051859
Updating learning rate to 0.00018483604089370196
Validation loss decreased (0.6052 --> 0.6048).  Saving model state dict ...
Epoch: 5 cost time: 0.5624394416809082
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6048019 Best vali loss: 0.6048019
Updating learning rate to 8.769766730464429e-05
Validation loss decreased (0.6048 --> 0.6045).  Saving model state dict ...
Epoch: 6 cost time: 0.46784520149230957
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6044792 Best vali loss: 0.6044792
Updating learning rate to 2.2791881150211728e-05
Validation loss decreased (0.6045 --> 0.6032).  Saving model state dict ...
Epoch: 7 cost time: 0.4482085704803467
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6032432 Best vali loss: 0.6032432
Updating learning rate to 0.0
Epoch: 8 cost time: 0.589428186416626
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6034570 Best vali loss: 0.6032432

best validation loss 0.6032431891868093

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0111045942676, 'e_layers': 2, 'learning_rate': 0.0002179765149, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002179765149
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 0.9269561767578125
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6047514 Best vali loss: 0.6047514
Updating learning rate to 0.00010898825745
Validation loss decreased (0.6048 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.6034369468688965
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5995222 Best vali loss: 0.5995222
Updating learning rate to 5.4494128725e-05
Validation loss decreased (0.5995 --> 0.5952).  Saving model state dict ...
Epoch: 3 cost time: 0.6079399585723877
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5952188 Best vali loss: 0.5952188
Updating learning rate to 2.72470643625e-05
Epoch: 4 cost time: 0.6097152233123779
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5971925 Best vali loss: 0.5952188
Updating learning rate to 1.362353218125e-05
Epoch: 5 cost time: 0.45334315299987793
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5967002 Best vali loss: 0.5952188
Updating learning rate to 6.811766090625e-06
Epoch: 6 cost time: 0.44777560234069824
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5969657 Best vali loss: 0.5952188
Updating learning rate to 3.4058830453125e-06
Validation loss decreased (0.5952 --> 0.5929).  Saving model state dict ...
Epoch: 7 cost time: 0.4623689651489258
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5929279 Best vali loss: 0.5929279
Updating learning rate to 1.70294152265625e-06
Epoch: 8 cost time: 0.4731252193450928
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5954905 Best vali loss: 0.5929279

best validation loss 0.5929279381729066

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017015780889, 'e_layers': 1, 'learning_rate': 0.0028702571024, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0028702571024
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 0.6388576030731201
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6142382 Best vali loss: 0.6142382
Updating learning rate to 0.0014351285512
Epoch: 2 cost time: 0.42636561393737793
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6605304 Best vali loss: 0.6142382
Updating learning rate to 0.0007175642756
Epoch: 3 cost time: 0.4122161865234375
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6469987 Best vali loss: 0.6142382
Updating learning rate to 0.0003587821378
Epoch: 4 cost time: 0.44879937171936035
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6170462 Best vali loss: 0.6142382
Updating learning rate to 0.0001793910689
Epoch: 5 cost time: 0.4364912509918213
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6266702 Best vali loss: 0.6142382
Updating learning rate to 8.969553445e-05
Epoch: 6 cost time: 0.4458763599395752
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6182788 Best vali loss: 0.6142382
Updating learning rate to 4.4847767225e-05
Epoch: 7 cost time: 0.4484291076660156
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6204185 Best vali loss: 0.6142382
Updating learning rate to 2.24238836125e-05
Epoch: 8 cost time: 0.44040870666503906
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6223171 Best vali loss: 0.6142382

best validation loss 0.6142382401109349

[INFO][smbo.py:320] Finished 150 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.001707636708, 'e_layers': 2, 'learning_rate': 0.0007419627822, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5338737
	speed: 0.0098s/iter; left time: 75.5825s
	iters: 200, epoch: 1 | loss: 0.8667485
	speed: 0.0041s/iter; left time: 31.0203s
	iters: 300, epoch: 1 | loss: 0.7143742
	speed: 0.0041s/iter; left time: 30.7755s
	iters: 400, epoch: 1 | loss: 1.0189171
	speed: 0.0041s/iter; left time: 30.1940s
	iters: 500, epoch: 1 | loss: 0.7206213
	speed: 0.0040s/iter; left time: 29.0033s
	iters: 600, epoch: 1 | loss: 1.0155475
	speed: 0.0037s/iter; left time: 26.9136s
	iters: 700, epoch: 1 | loss: 1.1085594
	speed: 0.0042s/iter; left time: 30.0050s
	iters: 800, epoch: 1 | loss: 0.7220566
	speed: 0.0046s/iter; left time: 32.3874s
	iters: 900, epoch: 1 | loss: 1.4720411
	speed: 0.0046s/iter; left time: 31.5711s
Updating learning rate to 0.0007137235052798548
Validation loss decreased (inf --> 0.6178).  Saving model state dict ...
Epoch: 1 cost time: 4.380649089813232
Epoch: 1, Steps: 979 | Train Loss: 0.9080822 Vali Loss: 0.6178114 Best vali loss: 0.6178114
	iters: 100, epoch: 2 | loss: 0.7114739
	speed: 0.0147s/iter; left time: 99.3058s
	iters: 200, epoch: 2 | loss: 0.7394748
	speed: 0.0041s/iter; left time: 27.4443s
	iters: 300, epoch: 2 | loss: 0.9123279
	speed: 0.0040s/iter; left time: 26.2688s
	iters: 400, epoch: 2 | loss: 1.0220423
	speed: 0.0043s/iter; left time: 27.5601s
	iters: 500, epoch: 2 | loss: 0.4863554
	speed: 0.0042s/iter; left time: 26.8236s
	iters: 600, epoch: 2 | loss: 0.7003620
	speed: 0.0041s/iter; left time: 25.4371s
	iters: 700, epoch: 2 | loss: 0.3521734
	speed: 0.0042s/iter; left time: 25.6530s
	iters: 800, epoch: 2 | loss: 0.5943288
	speed: 0.0033s/iter; left time: 20.0235s
	iters: 900, epoch: 2 | loss: 1.2279910
	speed: 0.0034s/iter; left time: 19.9994s
Updating learning rate to 0.0006333048484408287
Epoch: 2 cost time: 3.9262900352478027
Epoch: 2, Steps: 979 | Train Loss: 0.7496144 Vali Loss: 0.6193442 Best vali loss: 0.6178114
	iters: 100, epoch: 3 | loss: 0.7086952
	speed: 0.0225s/iter; left time: 129.9316s
	iters: 200, epoch: 3 | loss: 1.7272403
	speed: 0.0050s/iter; left time: 28.2783s
	iters: 300, epoch: 3 | loss: 0.5148710
	speed: 0.0075s/iter; left time: 41.7966s
	iters: 400, epoch: 3 | loss: 1.4723506
	speed: 0.0047s/iter; left time: 25.8867s
	iters: 500, epoch: 3 | loss: 0.4062868
	speed: 0.0032s/iter; left time: 17.0940s
	iters: 600, epoch: 3 | loss: 0.5268981
	speed: 0.0032s/iter; left time: 16.9917s
	iters: 700, epoch: 3 | loss: 0.8942195
	speed: 0.0043s/iter; left time: 22.4607s
	iters: 800, epoch: 3 | loss: 1.7551068
	speed: 0.0095s/iter; left time: 48.3524s
	iters: 900, epoch: 3 | loss: 0.9943930
	speed: 0.0061s/iter; left time: 30.5871s
Updating learning rate to 0.0005129498231897238
Epoch: 3 cost time: 5.930059194564819
Epoch: 3, Steps: 979 | Train Loss: 1.0000068 Vali Loss: 0.6294752 Best vali loss: 0.6178114

best validation loss 0.6178114128741662

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7134443
	speed: 0.0116s/iter; left time: 10.2623s
Updating learning rate to 7.21066019e-05
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 1.0076730251312256
Epoch: 1, Steps: 123 | Train Loss: 0.7134443 Vali Loss: 0.6067003 Best vali loss: 0.6067003
	iters: 100, epoch: 2 | loss: 0.9056057
	speed: 0.0135s/iter; left time: 10.2811s
Updating learning rate to 3.605330095e-05
Validation loss decreased (0.6067 --> 0.5947).  Saving model state dict ...
Epoch: 2 cost time: 1.2777552604675293
Epoch: 2, Steps: 123 | Train Loss: 0.9056057 Vali Loss: 0.5947141 Best vali loss: 0.5947141
	iters: 100, epoch: 3 | loss: 1.0188292
	speed: 0.0155s/iter; left time: 9.9083s
Updating learning rate to 1.8026650475e-05
Validation loss decreased (0.5947 --> 0.5904).  Saving model state dict ...
Epoch: 3 cost time: 1.2739713191986084
Epoch: 3, Steps: 123 | Train Loss: 1.0188292 Vali Loss: 0.5903607 Best vali loss: 0.5903607

best validation loss 0.590360685445158

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019248824173, 'e_layers': 4, 'learning_rate': 0.0047849704029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004602853310905798
Validation loss decreased (inf --> 0.6419).  Saving model state dict ...
Epoch: 1 cost time: 1.9573659896850586
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6418515 Best vali loss: 0.6418515
Updating learning rate to 0.004084227711283759
Epoch: 2 cost time: 1.7078123092651367
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6523321 Best vali loss: 0.6418515
Updating learning rate to 0.0033080496502235694
Epoch: 3 cost time: 1.0833261013031006
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6512734 Best vali loss: 0.6418515

best validation loss 0.6418515220112074

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6560725
	speed: 0.0144s/iter; left time: 7.4083s
Updating learning rate to 9.0133252375e-06
Validation loss decreased (0.5904 --> 0.5696).  Saving model state dict ...
Epoch: 4 cost time: 1.2960264682769775
Epoch: 4, Steps: 123 | Train Loss: 0.6560725 Vali Loss: 0.5695630 Best vali loss: 0.5695630
	iters: 100, epoch: 5 | loss: 0.8271378
	speed: 0.0132s/iter; left time: 5.1691s
Updating learning rate to 4.50666261875e-06
Validation loss decreased (0.5696 --> 0.5647).  Saving model state dict ...
Epoch: 5 cost time: 1.056748867034912
Epoch: 5, Steps: 123 | Train Loss: 0.8271378 Vali Loss: 0.5646946 Best vali loss: 0.5646946
	iters: 100, epoch: 6 | loss: 0.9709435
	speed: 0.0129s/iter; left time: 3.4771s
Updating learning rate to 2.253331309375e-06
Validation loss decreased (0.5647 --> 0.5618).  Saving model state dict ...
Epoch: 6 cost time: 1.021730661392212
Epoch: 6, Steps: 123 | Train Loss: 0.9709435 Vali Loss: 0.5618321 Best vali loss: 0.5618321
	iters: 100, epoch: 7 | loss: 0.5755252
	speed: 0.0133s/iter; left time: 1.9521s
Updating learning rate to 1.1266656546875e-06
Epoch: 7 cost time: 1.0723755359649658
Epoch: 7, Steps: 123 | Train Loss: 0.5755252 Vali Loss: 0.5620683 Best vali loss: 0.5618321
	iters: 100, epoch: 8 | loss: 0.8019488
	speed: 0.0132s/iter; left time: 0.3157s
Updating learning rate to 5.6333282734375e-07
Validation loss decreased (0.5618 --> 0.5603).  Saving model state dict ...
Epoch: 8 cost time: 1.082834005355835
Epoch: 8, Steps: 123 | Train Loss: 0.8019488 Vali Loss: 0.5603272 Best vali loss: 0.5603272

best validation loss 0.5603272477988014

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0061705426639, 'e_layers': 4, 'learning_rate': 0.001116068428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3880655
	speed: 0.0130s/iter; left time: 49.5172s
	iters: 200, epoch: 1 | loss: 0.6491840
	speed: 0.0071s/iter; left time: 26.4616s
	iters: 300, epoch: 1 | loss: 0.7220223
	speed: 0.0070s/iter; left time: 25.3722s
	iters: 400, epoch: 1 | loss: 1.1033143
	speed: 0.0071s/iter; left time: 24.9085s
Updating learning rate to 0.001116068428
Validation loss decreased (inf --> 0.6198).  Saving model state dict ...
Epoch: 1 cost time: 3.7593958377838135
Epoch: 1, Steps: 490 | Train Loss: 0.7156465 Vali Loss: 0.6197946 Best vali loss: 0.6197946
	iters: 100, epoch: 2 | loss: 1.1894859
	speed: 0.0194s/iter; left time: 64.5491s
	iters: 200, epoch: 2 | loss: 1.2882708
	speed: 0.0072s/iter; left time: 23.1813s
	iters: 300, epoch: 2 | loss: 0.7951719
	speed: 0.0071s/iter; left time: 22.2709s
	iters: 400, epoch: 2 | loss: 0.7047057
	speed: 0.0072s/iter; left time: 21.7517s
Updating learning rate to 0.000558034214
Validation loss decreased (0.6198 --> 0.6029).  Saving model state dict ...
Epoch: 2 cost time: 3.569533109664917
Epoch: 2, Steps: 490 | Train Loss: 0.9944086 Vali Loss: 0.6029459 Best vali loss: 0.6029459
	iters: 100, epoch: 3 | loss: 1.0647353
	speed: 0.0191s/iter; left time: 54.1830s
	iters: 200, epoch: 3 | loss: 1.0541003
	speed: 0.0071s/iter; left time: 19.3487s
	iters: 300, epoch: 3 | loss: 1.1633674
	speed: 0.0070s/iter; left time: 18.5165s
	iters: 400, epoch: 3 | loss: 0.7354255
	speed: 0.0070s/iter; left time: 17.7490s
Updating learning rate to 0.000279017107
Epoch: 3 cost time: 3.493879795074463
Epoch: 3, Steps: 490 | Train Loss: 1.0044071 Vali Loss: 0.6165920 Best vali loss: 0.6029459
	iters: 100, epoch: 4 | loss: 0.5486169
	speed: 0.0186s/iter; left time: 43.6415s
	iters: 200, epoch: 4 | loss: 0.5754220
	speed: 0.0074s/iter; left time: 16.6057s
	iters: 300, epoch: 4 | loss: 0.4692042
	speed: 0.0071s/iter; left time: 15.2453s
	iters: 400, epoch: 4 | loss: 0.6499951
	speed: 0.0069s/iter; left time: 14.1145s
Updating learning rate to 0.0001395085535
Epoch: 4 cost time: 3.5430500507354736
Epoch: 4, Steps: 490 | Train Loss: 0.5608096 Vali Loss: 0.6325516 Best vali loss: 0.6029459
	iters: 100, epoch: 5 | loss: 0.6929433
	speed: 0.0187s/iter; left time: 34.7654s
	iters: 200, epoch: 5 | loss: 1.5188463
	speed: 0.0071s/iter; left time: 12.5854s
	iters: 300, epoch: 5 | loss: 0.7279920
	speed: 0.0072s/iter; left time: 11.9431s
	iters: 400, epoch: 5 | loss: 1.0041760
	speed: 0.0070s/iter; left time: 10.9315s
Updating learning rate to 6.975427675e-05
Epoch: 5 cost time: 3.5403032302856445
Epoch: 5, Steps: 490 | Train Loss: 0.9859894 Vali Loss: 0.6370154 Best vali loss: 0.6029459
	iters: 100, epoch: 6 | loss: 0.8381578
	speed: 0.0189s/iter; left time: 25.8569s
	iters: 200, epoch: 6 | loss: 0.6469113
	speed: 0.0069s/iter; left time: 8.7425s
	iters: 300, epoch: 6 | loss: 0.4614048
	speed: 0.0071s/iter; left time: 8.2873s
	iters: 400, epoch: 6 | loss: 0.3701988
	speed: 0.0072s/iter; left time: 7.7351s
Updating learning rate to 3.4877138375e-05
Epoch: 6 cost time: 3.5337746143341064
Epoch: 6, Steps: 490 | Train Loss: 0.5791682 Vali Loss: 0.6371386 Best vali loss: 0.6029459
	iters: 100, epoch: 7 | loss: 0.8807338
	speed: 0.0188s/iter; left time: 16.5233s
	iters: 200, epoch: 7 | loss: 0.9159064
	speed: 0.0057s/iter; left time: 4.4418s
	iters: 300, epoch: 7 | loss: 0.7954435
	speed: 0.0049s/iter; left time: 3.3579s
	iters: 400, epoch: 7 | loss: 0.8767421
	speed: 0.0072s/iter; left time: 4.1600s
Updating learning rate to 1.74385691875e-05
Epoch: 7 cost time: 3.181204319000244
Epoch: 7, Steps: 490 | Train Loss: 0.8672065 Vali Loss: 0.6389605 Best vali loss: 0.6029459
	iters: 100, epoch: 8 | loss: 1.0947444
	speed: 0.0197s/iter; left time: 7.6958s
	iters: 200, epoch: 8 | loss: 0.5507262
	speed: 0.0071s/iter; left time: 2.0647s
	iters: 300, epoch: 8 | loss: 0.5514662
	speed: 0.0071s/iter; left time: 1.3551s
	iters: 400, epoch: 8 | loss: 0.9641449
	speed: 0.0063s/iter; left time: 0.5708s
Updating learning rate to 8.71928459375e-06
Epoch: 8 cost time: 3.5068576335906982
Epoch: 8, Steps: 490 | Train Loss: 0.7902704 Vali Loss: 0.6391952 Best vali loss: 0.6029459

best validation loss 0.6029459243844583

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 1, 'learning_rate': 0.0009739953589, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6736109
	speed: 0.0092s/iter; left time: 35.0820s
	iters: 200, epoch: 1 | loss: 0.6142273
	speed: 0.0040s/iter; left time: 14.9491s
	iters: 300, epoch: 1 | loss: 0.6718441
	speed: 0.0041s/iter; left time: 14.7998s
	iters: 400, epoch: 1 | loss: 0.7801357
	speed: 0.0043s/iter; left time: 14.9824s
Updating learning rate to 0.0009369248678743475
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 2.218906879425049
Epoch: 1, Steps: 490 | Train Loss: 0.6849545 Vali Loss: 0.6080926 Best vali loss: 0.6080926
	iters: 100, epoch: 2 | loss: 0.3637897
	speed: 0.0124s/iter; left time: 41.4546s
	iters: 200, epoch: 2 | loss: 0.5212378
	speed: 0.0039s/iter; left time: 12.6900s
	iters: 300, epoch: 2 | loss: 1.0055985
	speed: 0.0037s/iter; left time: 11.5307s
	iters: 400, epoch: 2 | loss: 1.2992508
	speed: 0.0042s/iter; left time: 12.7031s
Updating learning rate to 0.0008313570410112075
Validation loss decreased (0.6081 --> 0.6045).  Saving model state dict ...
Epoch: 2 cost time: 1.9438819885253906
Epoch: 2, Steps: 490 | Train Loss: 0.7974692 Vali Loss: 0.6045314 Best vali loss: 0.6045314
	iters: 100, epoch: 3 | loss: 1.2100384
	speed: 0.0123s/iter; left time: 34.9759s
	iters: 200, epoch: 3 | loss: 0.6886875
	speed: 0.0038s/iter; left time: 10.4927s
	iters: 300, epoch: 3 | loss: 0.8827255
	speed: 0.0039s/iter; left time: 10.3276s
	iters: 400, epoch: 3 | loss: 0.9527988
	speed: 0.0040s/iter; left time: 10.1076s
Updating learning rate to 0.0006733636229757597
Validation loss decreased (0.6045 --> 0.5992).  Saving model state dict ...
Epoch: 3 cost time: 1.956240177154541
Epoch: 3, Steps: 490 | Train Loss: 0.9335626 Vali Loss: 0.5991522 Best vali loss: 0.5991522
	iters: 100, epoch: 4 | loss: 0.9155626
	speed: 0.0122s/iter; left time: 28.6906s
	iters: 200, epoch: 4 | loss: 1.0748837
	speed: 0.0037s/iter; left time: 8.3126s
	iters: 300, epoch: 4 | loss: 1.0955126
	speed: 0.0040s/iter; left time: 8.6353s
	iters: 400, epoch: 4 | loss: 0.6972817
	speed: 0.0039s/iter; left time: 8.0747s
Updating learning rate to 0.00048699767945
Epoch: 4 cost time: 1.9239826202392578
Epoch: 4, Steps: 490 | Train Loss: 0.9458102 Vali Loss: 0.6183542 Best vali loss: 0.5991522
	iters: 100, epoch: 5 | loss: 0.5742648
	speed: 0.0122s/iter; left time: 22.6264s
	iters: 200, epoch: 5 | loss: 1.2295313
	speed: 0.0037s/iter; left time: 6.4280s
	iters: 300, epoch: 5 | loss: 0.6428149
	speed: 0.0041s/iter; left time: 6.8310s
	iters: 400, epoch: 5 | loss: 0.5830310
	speed: 0.0041s/iter; left time: 6.3962s
Updating learning rate to 0.00030063173592424026
Epoch: 5 cost time: 1.9722683429718018
Epoch: 5, Steps: 490 | Train Loss: 0.7574105 Vali Loss: 0.6633981 Best vali loss: 0.5991522
	iters: 100, epoch: 6 | loss: 0.9192279
	speed: 0.0097s/iter; left time: 13.2864s
	iters: 200, epoch: 6 | loss: 1.1213313
	speed: 0.0026s/iter; left time: 3.3484s
	iters: 300, epoch: 6 | loss: 0.6840057
	speed: 0.0035s/iter; left time: 4.0985s
	iters: 400, epoch: 6 | loss: 0.5108120
	speed: 0.0040s/iter; left time: 4.2425s
Updating learning rate to 0.00014263831788879246
Epoch: 6 cost time: 1.6433651447296143
Epoch: 6, Steps: 490 | Train Loss: 0.8088442 Vali Loss: 0.6673216 Best vali loss: 0.5991522
	iters: 100, epoch: 7 | loss: 0.5840156
	speed: 0.0127s/iter; left time: 11.2014s
	iters: 200, epoch: 7 | loss: 1.2034781
	speed: 0.0040s/iter; left time: 3.1100s
	iters: 300, epoch: 7 | loss: 1.2573729
	speed: 0.0043s/iter; left time: 2.9605s
	iters: 400, epoch: 7 | loss: 0.6710153
	speed: 0.0040s/iter; left time: 2.3012s
Updating learning rate to 3.707049102565253e-05
Epoch: 7 cost time: 1.9689240455627441
Epoch: 7, Steps: 490 | Train Loss: 0.9289705 Vali Loss: 0.6547293 Best vali loss: 0.5991522
	iters: 100, epoch: 8 | loss: 0.7416728
	speed: 0.0084s/iter; left time: 3.2708s
	iters: 200, epoch: 8 | loss: 0.2483915
	speed: 0.0033s/iter; left time: 0.9747s
	iters: 300, epoch: 8 | loss: 1.0939908
	speed: 0.0040s/iter; left time: 0.7612s
	iters: 400, epoch: 8 | loss: 0.9620011
	speed: 0.0041s/iter; left time: 0.3749s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8024957180023193
Epoch: 8, Steps: 490 | Train Loss: 0.7615141 Vali Loss: 0.6596772 Best vali loss: 0.5991522

best validation loss 0.5991521823301408

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 2, 'learning_rate': 0.0011324263099, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1271521
	speed: 0.0122s/iter; left time: 10.8154s
Updating learning rate to 0.0011324263099
Validation loss decreased (inf --> 0.5950).  Saving model state dict ...
Epoch: 1 cost time: 1.0728321075439453
Epoch: 1, Steps: 123 | Train Loss: 1.1271521 Vali Loss: 0.5950398 Best vali loss: 0.5950398
	iters: 100, epoch: 2 | loss: 0.9988377
	speed: 0.0112s/iter; left time: 8.5545s
Updating learning rate to 0.00056621315495
Validation loss decreased (0.5950 --> 0.5870).  Saving model state dict ...
Epoch: 2 cost time: 0.8797767162322998
Epoch: 2, Steps: 123 | Train Loss: 0.9988377 Vali Loss: 0.5870192 Best vali loss: 0.5870192
	iters: 100, epoch: 3 | loss: 0.7977760
	speed: 0.0112s/iter; left time: 7.1630s
Updating learning rate to 0.000283106577475
Epoch: 3 cost time: 0.8802940845489502
Epoch: 3, Steps: 123 | Train Loss: 0.7977760 Vali Loss: 0.6150389 Best vali loss: 0.5870192

best validation loss 0.5870192060863348

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0104119650236, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1019064
	speed: 0.0106s/iter; left time: 40.3772s
	iters: 200, epoch: 1 | loss: 0.8525615
	speed: 0.0045s/iter; left time: 16.7177s
	iters: 300, epoch: 1 | loss: 0.4649916
	speed: 0.0051s/iter; left time: 18.3739s
	iters: 400, epoch: 1 | loss: 1.0959749
	speed: 0.0038s/iter; left time: 13.2462s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.6011).  Saving model state dict ...
Epoch: 1 cost time: 2.420889139175415
Epoch: 1, Steps: 490 | Train Loss: 0.8788586 Vali Loss: 0.6010951 Best vali loss: 0.6010951
	iters: 100, epoch: 2 | loss: 0.9606179
	speed: 0.0117s/iter; left time: 38.8968s
	iters: 200, epoch: 2 | loss: 0.8728397
	speed: 0.0052s/iter; left time: 16.8086s
	iters: 300, epoch: 2 | loss: 0.4436815
	speed: 0.0051s/iter; left time: 15.9976s
	iters: 400, epoch: 2 | loss: 1.0124369
	speed: 0.0052s/iter; left time: 15.7452s
Updating learning rate to 0.0006629438250964442
Epoch: 2 cost time: 2.61783766746521
Epoch: 2, Steps: 490 | Train Loss: 0.8223940 Vali Loss: 0.6202835 Best vali loss: 0.6010951
	iters: 100, epoch: 3 | loss: 0.6814792
	speed: 0.0154s/iter; left time: 43.7945s
	iters: 200, epoch: 3 | loss: 0.8762370
	speed: 0.0051s/iter; left time: 14.0951s
	iters: 300, epoch: 3 | loss: 0.6880298
	speed: 0.0053s/iter; left time: 14.0880s
	iters: 400, epoch: 3 | loss: 1.1157839
	speed: 0.0054s/iter; left time: 13.6460s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 2.617506980895996
Epoch: 3, Steps: 490 | Train Loss: 0.8403825 Vali Loss: 0.6133986 Best vali loss: 0.6010951

best validation loss 0.601095100538094

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8206423
	speed: 0.0115s/iter; left time: 44.0754s
	iters: 200, epoch: 1 | loss: 1.3290091
	speed: 0.0058s/iter; left time: 21.4914s
	iters: 300, epoch: 1 | loss: 1.4595271
	speed: 0.0059s/iter; left time: 21.5329s
	iters: 400, epoch: 1 | loss: 0.6739191
	speed: 0.0060s/iter; left time: 21.1488s
Updating learning rate to 0.00024547190550098694
Validation loss decreased (inf --> 0.6111).  Saving model state dict ...
Epoch: 1 cost time: 3.2281458377838135
Epoch: 1, Steps: 490 | Train Loss: 1.0707744 Vali Loss: 0.6111087 Best vali loss: 0.6111087
	iters: 100, epoch: 2 | loss: 0.7706538
	speed: 0.0144s/iter; left time: 48.0385s
	iters: 200, epoch: 2 | loss: 0.8069733
	speed: 0.0057s/iter; left time: 18.5266s
	iters: 300, epoch: 2 | loss: 0.8728619
	speed: 0.0061s/iter; left time: 19.0002s
	iters: 400, epoch: 2 | loss: 0.6803001
	speed: 0.0059s/iter; left time: 17.7927s
Updating learning rate to 0.00021781340639583926
Validation loss decreased (0.6111 --> 0.5807).  Saving model state dict ...
Epoch: 2 cost time: 2.769028902053833
Epoch: 2, Steps: 490 | Train Loss: 0.7826973 Vali Loss: 0.5806578 Best vali loss: 0.5806578
	iters: 100, epoch: 3 | loss: 0.5911035
	speed: 0.0166s/iter; left time: 47.1289s
	iters: 200, epoch: 3 | loss: 0.6125342
	speed: 0.0058s/iter; left time: 15.7659s
	iters: 300, epoch: 3 | loss: 0.9497427
	speed: 0.0059s/iter; left time: 15.5421s
	iters: 400, epoch: 3 | loss: 0.8154100
	speed: 0.0060s/iter; left time: 15.2822s
Updating learning rate to 0.000176419537248397
Validation loss decreased (0.5807 --> 0.5754).  Saving model state dict ...
Epoch: 3 cost time: 2.9233386516571045
Epoch: 3, Steps: 490 | Train Loss: 0.7421976 Vali Loss: 0.5753621 Best vali loss: 0.5753621

best validation loss 0.5753620802142564

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7782959
	speed: 0.0120s/iter; left time: 28.1390s
	iters: 200, epoch: 4 | loss: 1.2144930
	speed: 0.0060s/iter; left time: 13.5710s
	iters: 300, epoch: 4 | loss: 1.3650556
	speed: 0.0059s/iter; left time: 12.6112s
	iters: 400, epoch: 4 | loss: 0.6901193
	speed: 0.0059s/iter; left time: 12.1618s
Updating learning rate to 0.0001275921394
Validation loss decreased (0.5754 --> 0.5598).  Saving model state dict ...
Epoch: 4 cost time: 3.2280638217926025
Epoch: 4, Steps: 490 | Train Loss: 1.0119910 Vali Loss: 0.5598214 Best vali loss: 0.5598214
	iters: 100, epoch: 5 | loss: 0.7476431
	speed: 0.0169s/iter; left time: 31.4984s
	iters: 200, epoch: 5 | loss: 0.7031423
	speed: 0.0061s/iter; left time: 10.6974s
	iters: 300, epoch: 5 | loss: 0.6033351
	speed: 0.0060s/iter; left time: 9.9065s
	iters: 400, epoch: 5 | loss: 0.5825711
	speed: 0.0059s/iter; left time: 9.1522s
Updating learning rate to 7.8764741551603e-05
Validation loss decreased (0.5598 --> 0.5562).  Saving model state dict ...
Epoch: 5 cost time: 2.996582269668579
Epoch: 5, Steps: 490 | Train Loss: 0.6591729 Vali Loss: 0.5561910 Best vali loss: 0.5561910
	iters: 100, epoch: 6 | loss: 0.5593723
	speed: 0.0166s/iter; left time: 22.7103s
	iters: 200, epoch: 6 | loss: 0.5449201
	speed: 0.0060s/iter; left time: 7.5643s
	iters: 300, epoch: 6 | loss: 0.9237542
	speed: 0.0060s/iter; left time: 7.0171s
	iters: 400, epoch: 6 | loss: 0.7662500
	speed: 0.0059s/iter; left time: 6.2926s
Updating learning rate to 3.7370872404160736e-05
Validation loss decreased (0.5562 --> 0.5452).  Saving model state dict ...
Epoch: 6 cost time: 2.9292309284210205
Epoch: 6, Steps: 490 | Train Loss: 0.6985742 Vali Loss: 0.5452032 Best vali loss: 0.5452032
	iters: 100, epoch: 7 | loss: 1.0015696
	speed: 0.0169s/iter; left time: 14.8749s
	iters: 200, epoch: 7 | loss: 0.7117624
	speed: 0.0042s/iter; left time: 3.3178s
	iters: 300, epoch: 7 | loss: 1.0818207
	speed: 0.0049s/iter; left time: 3.3053s
	iters: 400, epoch: 7 | loss: 0.4446172
	speed: 0.0056s/iter; left time: 3.2663s
Updating learning rate to 9.71237329901307e-06
Epoch: 7 cost time: 2.650007963180542
Epoch: 7, Steps: 490 | Train Loss: 0.8099425 Vali Loss: 0.5465897 Best vali loss: 0.5452032
	iters: 100, epoch: 8 | loss: 0.3859452
	speed: 0.0165s/iter; left time: 6.4693s
	iters: 200, epoch: 8 | loss: 1.0555060
	speed: 0.0063s/iter; left time: 1.8343s
	iters: 300, epoch: 8 | loss: 0.5769273
	speed: 0.0057s/iter; left time: 1.0835s
	iters: 400, epoch: 8 | loss: 0.7573251
	speed: 0.0059s/iter; left time: 0.5336s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.934760570526123
Epoch: 8, Steps: 490 | Train Loss: 0.6939259 Vali Loss: 0.5456141 Best vali loss: 0.5452032

best validation loss 0.5452031509736135

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003922949282, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6686826
	speed: 0.0114s/iter; left time: 21.1965s
	iters: 200, epoch: 1 | loss: 0.9702815
	speed: 0.0059s/iter; left time: 10.3975s
Updating learning rate to 0.0003922949282
Validation loss decreased (inf --> 0.6117).  Saving model state dict ...
Epoch: 1 cost time: 1.7066335678100586
Epoch: 1, Steps: 245 | Train Loss: 0.8194821 Vali Loss: 0.6116770 Best vali loss: 0.6116770
	iters: 100, epoch: 2 | loss: 0.8815933
	speed: 0.0122s/iter; left time: 19.7095s
	iters: 200, epoch: 2 | loss: 0.7922813
	speed: 0.0056s/iter; left time: 8.4276s
Updating learning rate to 0.0001961474641
Epoch: 2 cost time: 1.4497144222259521
Epoch: 2, Steps: 245 | Train Loss: 0.8369373 Vali Loss: 0.6336536 Best vali loss: 0.6116770
	iters: 100, epoch: 3 | loss: 0.8306745
	speed: 0.0114s/iter; left time: 15.6499s
	iters: 200, epoch: 3 | loss: 0.7862145
	speed: 0.0054s/iter; left time: 6.8310s
Updating learning rate to 9.807373205e-05
Epoch: 3 cost time: 1.3621902465820312
Epoch: 3, Steps: 245 | Train Loss: 0.8084445 Vali Loss: 0.6240454 Best vali loss: 0.6116770
	iters: 100, epoch: 4 | loss: 1.0525427
	speed: 0.0125s/iter; left time: 14.1085s
	iters: 200, epoch: 4 | loss: 0.6267747
	speed: 0.0058s/iter; left time: 5.9067s
Updating learning rate to 4.9036866025e-05
Validation loss decreased (0.6117 --> 0.6075).  Saving model state dict ...
Epoch: 4 cost time: 1.4416429996490479
Epoch: 4, Steps: 245 | Train Loss: 0.8396587 Vali Loss: 0.6075215 Best vali loss: 0.6075215
	iters: 100, epoch: 5 | loss: 0.6857036
	speed: 0.0120s/iter; left time: 10.5346s
	iters: 200, epoch: 5 | loss: 0.8167127
	speed: 0.0043s/iter; left time: 3.3194s
Updating learning rate to 2.45184330125e-05
Validation loss decreased (0.6075 --> 0.6023).  Saving model state dict ...
Epoch: 5 cost time: 1.189955472946167
Epoch: 5, Steps: 245 | Train Loss: 0.7512082 Vali Loss: 0.6023428 Best vali loss: 0.6023428
	iters: 100, epoch: 6 | loss: 0.6584880
	speed: 0.0110s/iter; left time: 7.0106s
	iters: 200, epoch: 6 | loss: 1.0451483
	speed: 0.0075s/iter; left time: 4.0261s
Updating learning rate to 1.225921650625e-05
Validation loss decreased (0.6023 --> 0.5951).  Saving model state dict ...
Epoch: 6 cost time: 1.7641136646270752
Epoch: 6, Steps: 245 | Train Loss: 0.8518181 Vali Loss: 0.5950914 Best vali loss: 0.5950914
	iters: 100, epoch: 7 | loss: 0.7382416
	speed: 0.0141s/iter; left time: 5.5297s
	iters: 200, epoch: 7 | loss: 0.7910897
	speed: 0.0078s/iter; left time: 2.2712s
Updating learning rate to 6.129608253125e-06
Epoch: 7 cost time: 1.9811339378356934
Epoch: 7, Steps: 245 | Train Loss: 0.7646656 Vali Loss: 0.5977907 Best vali loss: 0.5950914
	iters: 100, epoch: 8 | loss: 0.7367312
	speed: 0.0157s/iter; left time: 2.2919s
	iters: 200, epoch: 8 | loss: 0.6359352
	speed: 0.0080s/iter; left time: 0.3671s
Updating learning rate to 3.0648041265625e-06
Validation loss decreased (0.5951 --> 0.5950).  Saving model state dict ...
Epoch: 8 cost time: 1.9898121356964111
Epoch: 8, Steps: 245 | Train Loss: 0.6863332 Vali Loss: 0.5950163 Best vali loss: 0.5950163

best validation loss 0.5950162577882844

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024943532487, 'e_layers': 3, 'learning_rate': 0.0040105616226, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040105616226
Validation loss decreased (inf --> 0.6957).  Saving model state dict ...
Epoch: 1 cost time: 0.8715221881866455
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6956972 Best vali loss: 0.6956972
Updating learning rate to 0.0020052808113
Validation loss decreased (0.6957 --> 0.6682).  Saving model state dict ...
Epoch: 2 cost time: 0.6584296226501465
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6681644 Best vali loss: 0.6681644
Updating learning rate to 0.00100264040565
Validation loss decreased (0.6682 --> 0.6384).  Saving model state dict ...
Epoch: 3 cost time: 0.6594867706298828
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6384286 Best vali loss: 0.6384286
Updating learning rate to 0.000501320202825
Epoch: 4 cost time: 0.6608381271362305
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6489285 Best vali loss: 0.6384286
Updating learning rate to 0.0002506601014125
Epoch: 5 cost time: 0.6538786888122559
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6442709 Best vali loss: 0.6384286
Updating learning rate to 0.00012533005070625
Epoch: 6 cost time: 0.6689553260803223
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6435096 Best vali loss: 0.6384286
Updating learning rate to 6.2665025353125e-05
Epoch: 7 cost time: 0.6766641139984131
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6432731 Best vali loss: 0.6384286
Updating learning rate to 3.13325126765625e-05
Epoch: 8 cost time: 0.674114465713501
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6442136 Best vali loss: 0.6384286

best validation loss 0.6384286338783204

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025792385667, 'e_layers': 3, 'learning_rate': 0.0026285535245, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0873592
	speed: 0.0101s/iter; left time: 18.8403s
	iters: 200, epoch: 1 | loss: 0.8709227
	speed: 0.0060s/iter; left time: 10.5429s
Updating learning rate to 0.0026285535245
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 1.6230189800262451
Epoch: 1, Steps: 245 | Train Loss: 0.9791410 Vali Loss: 0.6142324 Best vali loss: 0.6142324
	iters: 100, epoch: 2 | loss: 0.8823961
	speed: 0.0125s/iter; left time: 20.2589s
	iters: 200, epoch: 2 | loss: 0.6004291
	speed: 0.0062s/iter; left time: 9.4215s
Updating learning rate to 0.00131427676225
Epoch: 2 cost time: 1.5696415901184082
Epoch: 2, Steps: 245 | Train Loss: 0.7414126 Vali Loss: 0.6156083 Best vali loss: 0.6142324
	iters: 100, epoch: 3 | loss: 0.9052472
	speed: 0.0127s/iter; left time: 17.4222s
	iters: 200, epoch: 3 | loss: 0.8247291
	speed: 0.0062s/iter; left time: 7.9346s
Updating learning rate to 0.000657138381125
Epoch: 3 cost time: 1.5999574661254883
Epoch: 3, Steps: 245 | Train Loss: 0.8649882 Vali Loss: 0.6441520 Best vali loss: 0.6142324

best validation loss 0.6142324282581306

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037879290128, 'e_layers': 3, 'learning_rate': 0.0044980854811, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0893747
	speed: 0.0122s/iter; left time: 46.7259s
	iters: 200, epoch: 1 | loss: 0.9830200
	speed: 0.0060s/iter; left time: 22.3726s
	iters: 300, epoch: 1 | loss: 1.8776864
	speed: 0.0065s/iter; left time: 23.4324s
	iters: 400, epoch: 1 | loss: 1.6139472
	speed: 0.0065s/iter; left time: 22.9588s
Updating learning rate to 0.0044980854811
Validation loss decreased (inf --> 0.6296).  Saving model state dict ...
Epoch: 1 cost time: 3.4536330699920654
Epoch: 1, Steps: 490 | Train Loss: 1.3910071 Vali Loss: 0.6296116 Best vali loss: 0.6296116
	iters: 100, epoch: 2 | loss: 1.3462584
	speed: 0.0183s/iter; left time: 61.0804s
	iters: 200, epoch: 2 | loss: 0.5645007
	speed: 0.0063s/iter; left time: 20.4438s
	iters: 300, epoch: 2 | loss: 0.3988667
	speed: 0.0051s/iter; left time: 15.8333s
	iters: 400, epoch: 2 | loss: 0.5023317
	speed: 0.0044s/iter; left time: 13.4238s
Updating learning rate to 0.00224904274055
Epoch: 2 cost time: 2.7930402755737305
Epoch: 2, Steps: 490 | Train Loss: 0.7029894 Vali Loss: 0.6489207 Best vali loss: 0.6296116
	iters: 100, epoch: 3 | loss: 1.2192285
	speed: 0.0166s/iter; left time: 47.2406s
	iters: 200, epoch: 3 | loss: 1.6504675
	speed: 0.0057s/iter; left time: 15.5819s
	iters: 300, epoch: 3 | loss: 0.7880698
	speed: 0.0055s/iter; left time: 14.5518s
	iters: 400, epoch: 3 | loss: 1.0252451
	speed: 0.0059s/iter; left time: 15.0317s
Updating learning rate to 0.001124521370275
Epoch: 3 cost time: 2.8458824157714844
Epoch: 3, Steps: 490 | Train Loss: 1.1707527 Vali Loss: 0.6464700 Best vali loss: 0.6296116

best validation loss 0.6296116115317638

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4722600
	speed: 0.0114s/iter; left time: 43.4570s
	iters: 200, epoch: 1 | loss: 1.1080253
	speed: 0.0049s/iter; left time: 18.0726s
	iters: 300, epoch: 1 | loss: 0.7752842
	speed: 0.0048s/iter; left time: 17.3247s
	iters: 400, epoch: 1 | loss: 0.8584426
	speed: 0.0049s/iter; left time: 17.1692s
Updating learning rate to 0.00016522745149179477
Validation loss decreased (inf --> 0.6080).  Saving model state dict ...
Epoch: 1 cost time: 2.739894151687622
Epoch: 1, Steps: 490 | Train Loss: 0.8035030 Vali Loss: 0.6080072 Best vali loss: 0.6080072
	iters: 100, epoch: 2 | loss: 0.7378332
	speed: 0.0145s/iter; left time: 48.2203s
	iters: 200, epoch: 2 | loss: 1.0180970
	speed: 0.0040s/iter; left time: 12.9455s
	iters: 300, epoch: 2 | loss: 0.7033864
	speed: 0.0033s/iter; left time: 10.4294s
	iters: 400, epoch: 2 | loss: 1.0121577
	speed: 0.0034s/iter; left time: 10.3779s
Updating learning rate to 0.00014661048060095176
Validation loss decreased (0.6080 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 2.0226476192474365
Epoch: 2, Steps: 490 | Train Loss: 0.8678686 Vali Loss: 0.6035977 Best vali loss: 0.6035977
	iters: 100, epoch: 3 | loss: 0.3874836
	speed: 0.0150s/iter; left time: 42.5217s
	iters: 200, epoch: 3 | loss: 0.6220633
	speed: 0.0053s/iter; left time: 14.4984s
	iters: 300, epoch: 3 | loss: 0.9997923
	speed: 0.0047s/iter; left time: 12.3066s
	iters: 400, epoch: 3 | loss: 1.0604683
	speed: 0.0052s/iter; left time: 13.1130s
Updating learning rate to 0.0001187482146823405
Validation loss decreased (0.6036 --> 0.5792).  Saving model state dict ...
Epoch: 3 cost time: 2.459962844848633
Epoch: 3, Steps: 490 | Train Loss: 0.7674519 Vali Loss: 0.5792136 Best vali loss: 0.5792136

best validation loss 0.5792135723014498

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3953515
	speed: 0.0106s/iter; left time: 24.9790s
	iters: 200, epoch: 4 | loss: 0.9748363
	speed: 0.0050s/iter; left time: 11.3254s
	iters: 300, epoch: 4 | loss: 0.6983349
	speed: 0.0048s/iter; left time: 10.2280s
	iters: 400, epoch: 4 | loss: 0.6158554
	speed: 0.0048s/iter; left time: 9.8619s
Updating learning rate to 8.588243115e-05
Epoch: 4 cost time: 2.745290756225586
Epoch: 4, Steps: 490 | Train Loss: 0.6710945 Vali Loss: 0.5916663 Best vali loss: 0.5792136
	iters: 100, epoch: 5 | loss: 0.6294439
	speed: 0.0152s/iter; left time: 28.2137s
	iters: 200, epoch: 5 | loss: 0.9288768
	speed: 0.0050s/iter; left time: 8.7273s
	iters: 300, epoch: 5 | loss: 0.6832405
	speed: 0.0048s/iter; left time: 7.9801s
	iters: 400, epoch: 5 | loss: 0.8915109
	speed: 0.0047s/iter; left time: 7.3196s
Updating learning rate to 5.30166476176595e-05
Epoch: 5 cost time: 2.425631046295166
Epoch: 5, Steps: 490 | Train Loss: 0.7832680 Vali Loss: 0.5793927 Best vali loss: 0.5792136
	iters: 100, epoch: 6 | loss: 0.2949459
	speed: 0.0150s/iter; left time: 20.5662s
	iters: 200, epoch: 6 | loss: 0.5764488
	speed: 0.0050s/iter; left time: 6.3407s
	iters: 300, epoch: 6 | loss: 1.0277253
	speed: 0.0048s/iter; left time: 5.5779s
	iters: 400, epoch: 6 | loss: 1.0019473
	speed: 0.0047s/iter; left time: 5.0739s
Updating learning rate to 2.515438169904822e-05
Validation loss decreased (0.5792 --> 0.5758).  Saving model state dict ...
Epoch: 6 cost time: 2.453171730041504
Epoch: 6, Steps: 490 | Train Loss: 0.7252668 Vali Loss: 0.5758107 Best vali loss: 0.5758107
	iters: 100, epoch: 7 | loss: 0.8386093
	speed: 0.0154s/iter; left time: 13.5377s
	iters: 200, epoch: 7 | loss: 0.6049752
	speed: 0.0049s/iter; left time: 3.8345s
	iters: 300, epoch: 7 | loss: 0.9076607
	speed: 0.0039s/iter; left time: 2.6418s
	iters: 400, epoch: 7 | loss: 0.5461298
	speed: 0.0036s/iter; left time: 2.0685s
Updating learning rate to 6.53741080820523e-06
Validation loss decreased (0.5758 --> 0.5709).  Saving model state dict ...
Epoch: 7 cost time: 2.1578214168548584
Epoch: 7, Steps: 490 | Train Loss: 0.7243437 Vali Loss: 0.5709492 Best vali loss: 0.5709492
	iters: 100, epoch: 8 | loss: 0.8064892
	speed: 0.0152s/iter; left time: 5.9320s
	iters: 200, epoch: 8 | loss: 0.8697260
	speed: 0.0049s/iter; left time: 1.4239s
	iters: 300, epoch: 8 | loss: 1.0616667
	speed: 0.0057s/iter; left time: 1.0802s
	iters: 400, epoch: 8 | loss: 0.7384604
	speed: 0.0048s/iter; left time: 0.4404s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.652832508087158
Epoch: 8, Steps: 490 | Train Loss: 0.8690856 Vali Loss: 0.5767977 Best vali loss: 0.5709492

best validation loss 0.5709491926506127

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011023654446, 'e_layers': 1, 'learning_rate': 0.0011214708245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6255270
	speed: 0.0115s/iter; left time: 10.1773s
Updating learning rate to 0.0010787873827820538
Validation loss decreased (inf --> 0.6257).  Saving model state dict ...
Epoch: 1 cost time: 0.9958159923553467
Epoch: 1, Steps: 123 | Train Loss: 0.6255270 Vali Loss: 0.6256756 Best vali loss: 0.6256756
	iters: 100, epoch: 2 | loss: 0.8165213
	speed: 0.0098s/iter; left time: 7.4735s
Updating learning rate to 0.0009572352247034093
Validation loss decreased (0.6257 --> 0.5927).  Saving model state dict ...
Epoch: 2 cost time: 0.7416877746582031
Epoch: 2, Steps: 123 | Train Loss: 0.8165213 Vali Loss: 0.5926582 Best vali loss: 0.5926582
	iters: 100, epoch: 3 | loss: 0.6167362
	speed: 0.0094s/iter; left time: 5.9906s
Updating learning rate to 0.0007753195644584837
Epoch: 3 cost time: 0.6123971939086914
Epoch: 3, Steps: 123 | Train Loss: 0.6167362 Vali Loss: 0.6429960 Best vali loss: 0.5926582
	iters: 100, epoch: 4 | loss: 0.6279167
	speed: 0.0068s/iter; left time: 3.5263s
Updating learning rate to 0.00056073541225
Epoch: 4 cost time: 0.5167639255523682
Epoch: 4, Steps: 123 | Train Loss: 0.6279167 Vali Loss: 0.6837962 Best vali loss: 0.5926582
	iters: 100, epoch: 5 | loss: 0.7165577
	speed: 0.0070s/iter; left time: 2.7325s
Updating learning rate to 0.0003461512600415164
Epoch: 5 cost time: 0.5524373054504395
Epoch: 5, Steps: 123 | Train Loss: 0.7165577 Vali Loss: 0.6972653 Best vali loss: 0.5926582
	iters: 100, epoch: 6 | loss: 0.5537786
	speed: 0.0070s/iter; left time: 1.8939s
Updating learning rate to 0.00016423559979659077
Epoch: 6 cost time: 0.524620532989502
Epoch: 6, Steps: 123 | Train Loss: 0.5537786 Vali Loss: 0.7107511 Best vali loss: 0.5926582
	iters: 100, epoch: 7 | loss: 0.4864729
	speed: 0.0069s/iter; left time: 1.0137s
Updating learning rate to 4.268344171794636e-05
Epoch: 7 cost time: 0.5159285068511963
Epoch: 7, Steps: 123 | Train Loss: 0.4864729 Vali Loss: 0.6982811 Best vali loss: 0.5926582
	iters: 100, epoch: 8 | loss: 0.6774684
	speed: 0.0067s/iter; left time: 0.1609s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.505204439163208
Epoch: 8, Steps: 123 | Train Loss: 0.6774684 Vali Loss: 0.7013592 Best vali loss: 0.5926582

best validation loss 0.592658223955789

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0064522030262, 'e_layers': 1, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3669400
	speed: 0.0084s/iter; left time: 65.1258s
	iters: 200, epoch: 1 | loss: 1.0899391
	speed: 0.0029s/iter; left time: 21.9224s
	iters: 300, epoch: 1 | loss: 2.2668598
	speed: 0.0029s/iter; left time: 21.8624s
	iters: 400, epoch: 1 | loss: 1.4456425
	speed: 0.0029s/iter; left time: 21.6892s
	iters: 500, epoch: 1 | loss: 0.4185710
	speed: 0.0029s/iter; left time: 21.1601s
	iters: 600, epoch: 1 | loss: 1.5171481
	speed: 0.0029s/iter; left time: 20.8223s
	iters: 700, epoch: 1 | loss: 1.0852828
	speed: 0.0029s/iter; left time: 20.6930s
	iters: 800, epoch: 1 | loss: 0.3866083
	speed: 0.0029s/iter; left time: 20.3026s
	iters: 900, epoch: 1 | loss: 0.7292988
	speed: 0.0029s/iter; left time: 20.0126s
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.6605).  Saving model state dict ...
Epoch: 1 cost time: 3.113607406616211
Epoch: 1, Steps: 979 | Train Loss: 1.0340323 Vali Loss: 0.6605234 Best vali loss: 0.6605234
	iters: 100, epoch: 2 | loss: 0.8431761
	speed: 0.0105s/iter; left time: 71.0533s
	iters: 200, epoch: 2 | loss: 0.5104728
	speed: 0.0029s/iter; left time: 19.0113s
	iters: 300, epoch: 2 | loss: 1.0040751
	speed: 0.0028s/iter; left time: 18.5649s
	iters: 400, epoch: 2 | loss: 1.0646977
	speed: 0.0027s/iter; left time: 17.6388s
	iters: 500, epoch: 2 | loss: 0.6740787
	speed: 0.0027s/iter; left time: 17.4667s
	iters: 600, epoch: 2 | loss: 0.8560758
	speed: 0.0027s/iter; left time: 17.0543s
	iters: 700, epoch: 2 | loss: 0.3480907
	speed: 0.0027s/iter; left time: 16.7359s
	iters: 800, epoch: 2 | loss: 0.3202366
	speed: 0.0027s/iter; left time: 16.3610s
	iters: 900, epoch: 2 | loss: 1.3685505
	speed: 0.0027s/iter; left time: 16.1508s
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.6605 --> 0.6324).  Saving model state dict ...
Epoch: 2 cost time: 2.742450714111328
Epoch: 2, Steps: 979 | Train Loss: 0.7766060 Vali Loss: 0.6324027 Best vali loss: 0.6324027
	iters: 100, epoch: 3 | loss: 1.2020258
	speed: 0.0104s/iter; left time: 59.8599s
	iters: 200, epoch: 3 | loss: 0.6650561
	speed: 0.0030s/iter; left time: 17.0462s
	iters: 300, epoch: 3 | loss: 0.9050957
	speed: 0.0030s/iter; left time: 16.9676s
	iters: 400, epoch: 3 | loss: 1.1488576
	speed: 0.0031s/iter; left time: 16.9563s
	iters: 500, epoch: 3 | loss: 1.4972460
	speed: 0.0030s/iter; left time: 15.8807s
	iters: 600, epoch: 3 | loss: 0.6070856
	speed: 0.0029s/iter; left time: 15.2678s
	iters: 700, epoch: 3 | loss: 1.4209853
	speed: 0.0029s/iter; left time: 15.0687s
	iters: 800, epoch: 3 | loss: 0.3254345
	speed: 0.0028s/iter; left time: 14.1863s
	iters: 900, epoch: 3 | loss: 0.6542218
	speed: 0.0028s/iter; left time: 14.1343s
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.6324 --> 0.6198).  Saving model state dict ...
Epoch: 3 cost time: 2.904106855392456
Epoch: 3, Steps: 979 | Train Loss: 0.9362232 Vali Loss: 0.6197961 Best vali loss: 0.6197961
	iters: 100, epoch: 4 | loss: 0.8216932
	speed: 0.0108s/iter; left time: 51.9671s
	iters: 200, epoch: 4 | loss: 0.2930053
	speed: 0.0029s/iter; left time: 13.4908s
	iters: 300, epoch: 4 | loss: 1.5456034
	speed: 0.0028s/iter; left time: 12.9836s
	iters: 400, epoch: 4 | loss: 1.4539295
	speed: 0.0029s/iter; left time: 12.8636s
	iters: 500, epoch: 4 | loss: 0.6714984
	speed: 0.0029s/iter; left time: 12.9422s
	iters: 600, epoch: 4 | loss: 0.5479513
	speed: 0.0030s/iter; left time: 12.8409s
	iters: 700, epoch: 4 | loss: 0.8247321
	speed: 0.0030s/iter; left time: 12.5940s
	iters: 800, epoch: 4 | loss: 0.3956457
	speed: 0.0029s/iter; left time: 12.0004s
	iters: 900, epoch: 4 | loss: 1.2621766
	speed: 0.0029s/iter; left time: 11.7223s
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.6198 --> 0.6126).  Saving model state dict ...
Epoch: 4 cost time: 2.9104256629943848
Epoch: 4, Steps: 979 | Train Loss: 0.8684706 Vali Loss: 0.6125663 Best vali loss: 0.6125663
	iters: 100, epoch: 5 | loss: 0.3690605
	speed: 0.0107s/iter; left time: 40.8957s
	iters: 200, epoch: 5 | loss: 0.6541413
	speed: 0.0027s/iter; left time: 10.0963s
	iters: 300, epoch: 5 | loss: 1.3857880
	speed: 0.0029s/iter; left time: 10.4122s
	iters: 400, epoch: 5 | loss: 1.4199719
	speed: 0.0029s/iter; left time: 10.1186s
	iters: 500, epoch: 5 | loss: 0.7677814
	speed: 0.0029s/iter; left time: 9.8437s
	iters: 600, epoch: 5 | loss: 0.8176607
	speed: 0.0029s/iter; left time: 9.5497s
	iters: 700, epoch: 5 | loss: 1.6506568
	speed: 0.0029s/iter; left time: 9.3018s
	iters: 800, epoch: 5 | loss: 0.4684058
	speed: 0.0029s/iter; left time: 8.9869s
	iters: 900, epoch: 5 | loss: 0.5618960
	speed: 0.0029s/iter; left time: 8.6859s
Updating learning rate to 2.2430860606471416e-05
Validation loss decreased (0.6126 --> 0.6097).  Saving model state dict ...
Epoch: 5 cost time: 2.8449721336364746
Epoch: 5, Steps: 979 | Train Loss: 0.8994847 Vali Loss: 0.6096801 Best vali loss: 0.6096801
	iters: 100, epoch: 6 | loss: 0.2841910
	speed: 0.0105s/iter; left time: 29.8162s
	iters: 200, epoch: 6 | loss: 0.1929577
	speed: 0.0028s/iter; left time: 7.6255s
	iters: 300, epoch: 6 | loss: 0.8004982
	speed: 0.0028s/iter; left time: 7.4288s
	iters: 400, epoch: 6 | loss: 1.3766426
	speed: 0.0029s/iter; left time: 7.4452s
	iters: 500, epoch: 6 | loss: 0.6398773
	speed: 0.0029s/iter; left time: 7.1319s
	iters: 600, epoch: 6 | loss: 0.8821185
	speed: 0.0029s/iter; left time: 6.8135s
	iters: 700, epoch: 6 | loss: 0.4423704
	speed: 0.0029s/iter; left time: 6.4738s
	iters: 800, epoch: 6 | loss: 1.2016762
	speed: 0.0029s/iter; left time: 6.1686s
	iters: 900, epoch: 6 | loss: 0.8393733
	speed: 0.0029s/iter; left time: 5.8846s
Updating learning rate to 1.0642589731482448e-05
Validation loss decreased (0.6097 --> 0.6081).  Saving model state dict ...
Epoch: 6 cost time: 2.8589999675750732
Epoch: 6, Steps: 979 | Train Loss: 0.7399672 Vali Loss: 0.6081238 Best vali loss: 0.6081238
	iters: 100, epoch: 7 | loss: 1.5542837
	speed: 0.0107s/iter; left time: 19.9648s
	iters: 200, epoch: 7 | loss: 0.6749647
	speed: 0.0027s/iter; left time: 4.7362s
	iters: 300, epoch: 7 | loss: 0.6875260
	speed: 0.0027s/iter; left time: 4.4347s
	iters: 400, epoch: 7 | loss: 1.1496406
	speed: 0.0028s/iter; left time: 4.3834s
	iters: 500, epoch: 7 | loss: 1.0286915
	speed: 0.0029s/iter; left time: 4.1832s
	iters: 600, epoch: 7 | loss: 1.4970345
	speed: 0.0029s/iter; left time: 3.9917s
	iters: 700, epoch: 7 | loss: 1.1968461
	speed: 0.0028s/iter; left time: 3.5743s
	iters: 800, epoch: 7 | loss: 0.6211924
	speed: 0.0032s/iter; left time: 3.6970s
	iters: 900, epoch: 7 | loss: 1.3848803
	speed: 0.0029s/iter; left time: 3.0291s
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.6081 --> 0.6075).  Saving model state dict ...
Epoch: 7 cost time: 2.833829641342163
Epoch: 7, Steps: 979 | Train Loss: 1.0883400 Vali Loss: 0.6074691 Best vali loss: 0.6074691
	iters: 100, epoch: 8 | loss: 0.6467670
	speed: 0.0111s/iter; left time: 9.7411s
	iters: 200, epoch: 8 | loss: 0.8372874
	speed: 0.0029s/iter; left time: 2.2689s
	iters: 300, epoch: 8 | loss: 0.3214650
	speed: 0.0029s/iter; left time: 1.9620s
	iters: 400, epoch: 8 | loss: 1.0277750
	speed: 0.0028s/iter; left time: 1.6056s
	iters: 500, epoch: 8 | loss: 0.9231015
	speed: 0.0023s/iter; left time: 1.1131s
	iters: 600, epoch: 8 | loss: 0.7831371
	speed: 0.0023s/iter; left time: 0.8671s
	iters: 700, epoch: 8 | loss: 0.4786863
	speed: 0.0024s/iter; left time: 0.6728s
	iters: 800, epoch: 8 | loss: 0.6543583
	speed: 0.0031s/iter; left time: 0.5622s
	iters: 900, epoch: 8 | loss: 0.6885794
	speed: 0.0034s/iter; left time: 0.2695s
Updating learning rate to 0.0
Validation loss decreased (0.6075 --> 0.6073).  Saving model state dict ...
Epoch: 8 cost time: 2.8478047847747803
Epoch: 8, Steps: 979 | Train Loss: 0.7067952 Vali Loss: 0.6072811 Best vali loss: 0.6072811

best validation loss 0.6072811475786442

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5488362
	speed: 0.0097s/iter; left time: 36.9228s
	iters: 200, epoch: 1 | loss: 0.9104597
	speed: 0.0039s/iter; left time: 14.4760s
	iters: 300, epoch: 1 | loss: 0.8165501
	speed: 0.0041s/iter; left time: 14.8208s
	iters: 400, epoch: 1 | loss: 0.8647280
	speed: 0.0038s/iter; left time: 13.4611s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.5970).  Saving model state dict ...
Epoch: 1 cost time: 2.2393078804016113
Epoch: 1, Steps: 490 | Train Loss: 0.7851435 Vali Loss: 0.5969613 Best vali loss: 0.5969613
	iters: 100, epoch: 2 | loss: 1.3702863
	speed: 0.0126s/iter; left time: 42.0662s
	iters: 200, epoch: 2 | loss: 1.1077676
	speed: 0.0042s/iter; left time: 13.6747s
	iters: 300, epoch: 2 | loss: 1.0164146
	speed: 0.0041s/iter; left time: 12.9893s
	iters: 400, epoch: 2 | loss: 0.7820434
	speed: 0.0038s/iter; left time: 11.6526s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 2.0178751945495605
Epoch: 2, Steps: 490 | Train Loss: 1.0691280 Vali Loss: 0.6064259 Best vali loss: 0.5969613
	iters: 100, epoch: 3 | loss: 0.6884322
	speed: 0.0094s/iter; left time: 26.6039s
	iters: 200, epoch: 3 | loss: 1.3241525
	speed: 0.0025s/iter; left time: 6.8407s
	iters: 300, epoch: 3 | loss: 1.1952713
	speed: 0.0039s/iter; left time: 10.3544s
	iters: 400, epoch: 3 | loss: 0.8344930
	speed: 0.0041s/iter; left time: 10.4452s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.744213581085205
Epoch: 3, Steps: 490 | Train Loss: 1.0105872 Vali Loss: 0.6253668 Best vali loss: 0.5969613

best validation loss 0.5969613245768108

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002026610841687957
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 0.708183765411377
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6023024 Best vali loss: 0.6023024
Updating learning rate to 0.001798262860126036
Epoch: 2 cost time: 0.568406343460083
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6360170 Best vali loss: 0.6023024
Updating learning rate to 0.0014565159550274328
Epoch: 3 cost time: 0.6169211864471436
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6131579 Best vali loss: 0.6023024

best validation loss 0.6023024492989751

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0103950152165, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9083424
	speed: 0.0094s/iter; left time: 8.3337s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 0.7543137073516846
Epoch: 1, Steps: 123 | Train Loss: 0.9083424 Vali Loss: 0.6080645 Best vali loss: 0.6080645
	iters: 100, epoch: 2 | loss: 0.6621289
	speed: 0.0100s/iter; left time: 7.6198s
Updating learning rate to 0.00093122262415
Epoch: 2 cost time: 0.8565917015075684
Epoch: 2, Steps: 123 | Train Loss: 0.6621289 Vali Loss: 0.6117494 Best vali loss: 0.6080645
	iters: 100, epoch: 3 | loss: 0.7142416
	speed: 0.0106s/iter; left time: 6.7711s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.772296667098999
Epoch: 3, Steps: 123 | Train Loss: 0.7142416 Vali Loss: 0.6160212 Best vali loss: 0.6080645

best validation loss 0.608064544002307

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4772637
	speed: 0.0085s/iter; left time: 19.8989s
	iters: 200, epoch: 4 | loss: 0.8662052
	speed: 0.0028s/iter; left time: 6.3113s
	iters: 300, epoch: 4 | loss: 0.8093483
	speed: 0.0039s/iter; left time: 8.4071s
	iters: 400, epoch: 4 | loss: 0.8267237
	speed: 0.0040s/iter; left time: 8.2046s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 2.025102138519287
Epoch: 4, Steps: 490 | Train Loss: 0.7448852 Vali Loss: 0.6265826 Best vali loss: 0.5969613
	iters: 100, epoch: 5 | loss: 1.2785203
	speed: 0.0126s/iter; left time: 23.4178s
	iters: 200, epoch: 5 | loss: 0.9856381
	speed: 0.0035s/iter; left time: 6.1992s
	iters: 300, epoch: 5 | loss: 0.8345004
	speed: 0.0035s/iter; left time: 5.7781s
	iters: 400, epoch: 5 | loss: 0.6816382
	speed: 0.0036s/iter; left time: 5.6018s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 1.8640611171722412
Epoch: 5, Steps: 490 | Train Loss: 0.9450743 Vali Loss: 0.6235135 Best vali loss: 0.5969613
	iters: 100, epoch: 6 | loss: 0.6391831
	speed: 0.0118s/iter; left time: 16.2045s
	iters: 200, epoch: 6 | loss: 1.2313709
	speed: 0.0038s/iter; left time: 4.8153s
	iters: 300, epoch: 6 | loss: 0.9394577
	speed: 0.0039s/iter; left time: 4.5977s
	iters: 400, epoch: 6 | loss: 0.6999022
	speed: 0.0039s/iter; left time: 4.2266s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 1.9206900596618652
Epoch: 6, Steps: 490 | Train Loss: 0.8774785 Vali Loss: 0.6341663 Best vali loss: 0.5969613
	iters: 100, epoch: 7 | loss: 0.8011695
	speed: 0.0114s/iter; left time: 10.0698s
	iters: 200, epoch: 7 | loss: 0.5961880
	speed: 0.0038s/iter; left time: 2.9314s
	iters: 300, epoch: 7 | loss: 0.4304900
	speed: 0.0036s/iter; left time: 2.4620s
	iters: 400, epoch: 7 | loss: 0.8432174
	speed: 0.0035s/iter; left time: 2.0100s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 1.7908761501312256
Epoch: 7, Steps: 490 | Train Loss: 0.6677662 Vali Loss: 0.6448458 Best vali loss: 0.5969613
	iters: 100, epoch: 8 | loss: 0.5045681
	speed: 0.0120s/iter; left time: 4.6802s
	iters: 200, epoch: 8 | loss: 0.6356697
	speed: 0.0036s/iter; left time: 1.0514s
	iters: 300, epoch: 8 | loss: 1.1658831
	speed: 0.0037s/iter; left time: 0.7122s
	iters: 400, epoch: 8 | loss: 0.7604069
	speed: 0.0037s/iter; left time: 0.3343s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9001197814941406
Epoch: 8, Steps: 490 | Train Loss: 0.7666319 Vali Loss: 0.6378294 Best vali loss: 0.5969613

best validation loss 0.5969613245768108

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015627682118, 'e_layers': 4, 'learning_rate': 7.53636528e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7298276
	speed: 0.0120s/iter; left time: 10.6559s
Updating learning rate to 7.53636528e-05
Validation loss decreased (inf --> 0.6893).  Saving model state dict ...
Epoch: 1 cost time: 1.0888640880584717
Epoch: 1, Steps: 123 | Train Loss: 0.7298276 Vali Loss: 0.6892920 Best vali loss: 0.6892920
	iters: 100, epoch: 2 | loss: 0.8042785
	speed: 0.0110s/iter; left time: 8.3746s
Updating learning rate to 3.76818264e-05
Validation loss decreased (0.6893 --> 0.6669).  Saving model state dict ...
Epoch: 2 cost time: 0.9172594547271729
Epoch: 2, Steps: 123 | Train Loss: 0.8042785 Vali Loss: 0.6668589 Best vali loss: 0.6668589
	iters: 100, epoch: 3 | loss: 0.7262220
	speed: 0.0105s/iter; left time: 6.6959s
Updating learning rate to 1.88409132e-05
Validation loss decreased (0.6669 --> 0.6577).  Saving model state dict ...
Epoch: 3 cost time: 0.8657932281494141
Epoch: 3, Steps: 123 | Train Loss: 0.7262220 Vali Loss: 0.6577387 Best vali loss: 0.6577387
	iters: 100, epoch: 4 | loss: 0.9470800
	speed: 0.0104s/iter; left time: 5.3678s
Updating learning rate to 9.4204566e-06
Validation loss decreased (0.6577 --> 0.6540).  Saving model state dict ...
Epoch: 4 cost time: 0.8635251522064209
Epoch: 4, Steps: 123 | Train Loss: 0.9470800 Vali Loss: 0.6539880 Best vali loss: 0.6539880
	iters: 100, epoch: 5 | loss: 0.8880276
	speed: 0.0106s/iter; left time: 4.1513s
Updating learning rate to 4.7102283e-06
Validation loss decreased (0.6540 --> 0.6522).  Saving model state dict ...
Epoch: 5 cost time: 0.8666398525238037
Epoch: 5, Steps: 123 | Train Loss: 0.8880276 Vali Loss: 0.6521990 Best vali loss: 0.6521990
	iters: 100, epoch: 6 | loss: 0.7166625
	speed: 0.0107s/iter; left time: 2.9021s
Updating learning rate to 2.35511415e-06
Validation loss decreased (0.6522 --> 0.6512).  Saving model state dict ...
Epoch: 6 cost time: 0.9088780879974365
Epoch: 6, Steps: 123 | Train Loss: 0.7166625 Vali Loss: 0.6512492 Best vali loss: 0.6512492
	iters: 100, epoch: 7 | loss: 1.0188190
	speed: 0.0111s/iter; left time: 1.6284s
Updating learning rate to 1.177557075e-06
Validation loss decreased (0.6512 --> 0.6508).  Saving model state dict ...
Epoch: 7 cost time: 0.9420680999755859
Epoch: 7, Steps: 123 | Train Loss: 1.0188190 Vali Loss: 0.6507832 Best vali loss: 0.6507832
	iters: 100, epoch: 8 | loss: 0.8727856
	speed: 0.0107s/iter; left time: 0.2558s
Updating learning rate to 5.887785375e-07
Validation loss decreased (0.6508 --> 0.6506).  Saving model state dict ...
Epoch: 8 cost time: 0.8574855327606201
Epoch: 8, Steps: 123 | Train Loss: 0.8727856 Vali Loss: 0.6505579 Best vali loss: 0.6505579

best validation loss 0.6505579168131262

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 4, 'learning_rate': 0.0040085882975, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1229898
	speed: 0.0114s/iter; left time: 88.1901s
	iters: 200, epoch: 1 | loss: 0.6842577
	speed: 0.0061s/iter; left time: 46.7025s
	iters: 300, epoch: 1 | loss: 0.6314104
	speed: 0.0060s/iter; left time: 45.4477s
	iters: 400, epoch: 1 | loss: 1.3943937
	speed: 0.0060s/iter; left time: 44.4659s
	iters: 500, epoch: 1 | loss: 0.3469688
	speed: 0.0061s/iter; left time: 44.6629s
	iters: 600, epoch: 1 | loss: 1.1916485
	speed: 0.0060s/iter; left time: 43.2466s
	iters: 700, epoch: 1 | loss: 0.7797660
	speed: 0.0057s/iter; left time: 40.7857s
	iters: 800, epoch: 1 | loss: 1.1259617
	speed: 0.0054s/iter; left time: 37.8976s
	iters: 900, epoch: 1 | loss: 1.6351322
	speed: 0.0059s/iter; left time: 40.6365s
Updating learning rate to 0.0038560204899122574
Validation loss decreased (inf --> 0.6143).  Saving model state dict ...
Epoch: 1 cost time: 6.097960948944092
Epoch: 1, Steps: 979 | Train Loss: 0.9902810 Vali Loss: 0.6142982 Best vali loss: 0.6142982
	iters: 100, epoch: 2 | loss: 0.7287021
	speed: 0.0186s/iter; left time: 125.9180s
	iters: 200, epoch: 2 | loss: 0.8648013
	speed: 0.0061s/iter; left time: 40.6560s
	iters: 300, epoch: 2 | loss: 1.1433771
	speed: 0.0061s/iter; left time: 40.0122s
	iters: 400, epoch: 2 | loss: 0.2986928
	speed: 0.0061s/iter; left time: 39.4412s
	iters: 500, epoch: 2 | loss: 0.8609083
	speed: 0.0061s/iter; left time: 38.5024s
	iters: 600, epoch: 2 | loss: 0.5790685
	speed: 0.0061s/iter; left time: 37.9025s
	iters: 700, epoch: 2 | loss: 1.1690422
	speed: 0.0060s/iter; left time: 36.8613s
	iters: 800, epoch: 2 | loss: 0.2726389
	speed: 0.0059s/iter; left time: 35.5135s
	iters: 900, epoch: 2 | loss: 0.6607988
	speed: 0.0054s/iter; left time: 32.1349s
Updating learning rate to 0.0034215441328236435
Validation loss decreased (0.6143 --> 0.6126).  Saving model state dict ...
Epoch: 2 cost time: 5.880974292755127
Epoch: 2, Steps: 979 | Train Loss: 0.7308922 Vali Loss: 0.6126452 Best vali loss: 0.6126452
	iters: 100, epoch: 3 | loss: 0.2902883
	speed: 0.0183s/iter; left time: 105.5394s
	iters: 200, epoch: 3 | loss: 1.0740634
	speed: 0.0060s/iter; left time: 34.1648s
	iters: 300, epoch: 3 | loss: 0.5474721
	speed: 0.0061s/iter; left time: 34.2430s
	iters: 400, epoch: 3 | loss: 0.3432440
	speed: 0.0062s/iter; left time: 33.7480s
	iters: 500, epoch: 3 | loss: 1.1718125
	speed: 0.0062s/iter; left time: 33.2351s
	iters: 600, epoch: 3 | loss: 1.0101314
	speed: 0.0062s/iter; left time: 32.6034s
	iters: 700, epoch: 3 | loss: 1.4803792
	speed: 0.0062s/iter; left time: 31.9552s
	iters: 800, epoch: 3 | loss: 0.4199820
	speed: 0.0061s/iter; left time: 31.0591s
	iters: 900, epoch: 3 | loss: 1.7118926
	speed: 0.0058s/iter; left time: 28.8338s
Updating learning rate to 0.002771304313062916
Validation loss decreased (0.6126 --> 0.6055).  Saving model state dict ...
Epoch: 3 cost time: 5.974273204803467
Epoch: 3, Steps: 979 | Train Loss: 0.8943628 Vali Loss: 0.6055256 Best vali loss: 0.6055256
	iters: 100, epoch: 4 | loss: 0.3757310
	speed: 0.0181s/iter; left time: 86.6397s
	iters: 200, epoch: 4 | loss: 0.8577887
	speed: 0.0062s/iter; left time: 29.1262s
	iters: 300, epoch: 4 | loss: 0.6990990
	speed: 0.0060s/iter; left time: 27.7587s
	iters: 400, epoch: 4 | loss: 1.1321032
	speed: 0.0061s/iter; left time: 27.4133s
	iters: 500, epoch: 4 | loss: 0.7069370
	speed: 0.0061s/iter; left time: 26.7739s
	iters: 600, epoch: 4 | loss: 0.9040940
	speed: 0.0061s/iter; left time: 26.3671s
	iters: 700, epoch: 4 | loss: 1.1558371
	speed: 0.0061s/iter; left time: 25.6065s
	iters: 800, epoch: 4 | loss: 0.7610879
	speed: 0.0060s/iter; left time: 24.7204s
	iters: 900, epoch: 4 | loss: 0.3367952
	speed: 0.0060s/iter; left time: 24.0196s
Updating learning rate to 0.00200429414875
Epoch: 4 cost time: 5.978712558746338
Epoch: 4, Steps: 979 | Train Loss: 0.7699415 Vali Loss: 0.6083807 Best vali loss: 0.6055256
	iters: 100, epoch: 5 | loss: 0.5953571
	speed: 0.0178s/iter; left time: 68.1174s
	iters: 200, epoch: 5 | loss: 0.6357927
	speed: 0.0062s/iter; left time: 23.1011s
	iters: 300, epoch: 5 | loss: 1.0196728
	speed: 0.0061s/iter; left time: 22.0465s
	iters: 400, epoch: 5 | loss: 0.5541417
	speed: 0.0061s/iter; left time: 21.3869s
	iters: 500, epoch: 5 | loss: 1.0797904
	speed: 0.0061s/iter; left time: 20.8469s
	iters: 600, epoch: 5 | loss: 0.6595044
	speed: 0.0062s/iter; left time: 20.4309s
	iters: 700, epoch: 5 | loss: 0.5038588
	speed: 0.0059s/iter; left time: 18.9690s
	iters: 800, epoch: 5 | loss: 0.3369835
	speed: 0.0059s/iter; left time: 18.3240s
	iters: 900, epoch: 5 | loss: 1.3660065
	speed: 0.0060s/iter; left time: 18.0846s
Updating learning rate to 0.0012372839844370842
Validation loss decreased (0.6055 --> 0.5990).  Saving model state dict ...
Epoch: 5 cost time: 5.990941524505615
Epoch: 5, Steps: 979 | Train Loss: 0.7501231 Vali Loss: 0.5989870 Best vali loss: 0.5989870
	iters: 100, epoch: 6 | loss: 0.7439830
	speed: 0.0186s/iter; left time: 52.7475s
	iters: 200, epoch: 6 | loss: 0.8540804
	speed: 0.0062s/iter; left time: 16.8420s
	iters: 300, epoch: 6 | loss: 1.5121986
	speed: 0.0061s/iter; left time: 15.9976s
	iters: 400, epoch: 6 | loss: 1.5619112
	speed: 0.0060s/iter; left time: 15.3082s
	iters: 500, epoch: 6 | loss: 0.6209517
	speed: 0.0060s/iter; left time: 14.7402s
	iters: 600, epoch: 6 | loss: 0.9752753
	speed: 0.0065s/iter; left time: 15.2201s
	iters: 700, epoch: 6 | loss: 0.8338780
	speed: 0.0062s/iter; left time: 13.9573s
	iters: 800, epoch: 6 | loss: 1.0139488
	speed: 0.0063s/iter; left time: 13.4283s
	iters: 900, epoch: 6 | loss: 0.2948795
	speed: 0.0063s/iter; left time: 12.8963s
Updating learning rate to 0.0005870441646763563
Epoch: 6 cost time: 6.1247193813323975
Epoch: 6, Steps: 979 | Train Loss: 0.9345674 Vali Loss: 0.6137513 Best vali loss: 0.5989870
	iters: 100, epoch: 7 | loss: 0.2573412
	speed: 0.0186s/iter; left time: 34.5758s
	iters: 200, epoch: 7 | loss: 0.5914881
	speed: 0.0061s/iter; left time: 10.7292s
	iters: 300, epoch: 7 | loss: 0.5750077
	speed: 0.0060s/iter; left time: 9.9205s
	iters: 400, epoch: 7 | loss: 0.3979648
	speed: 0.0061s/iter; left time: 9.4926s
	iters: 500, epoch: 7 | loss: 0.5911593
	speed: 0.0060s/iter; left time: 8.7989s
	iters: 600, epoch: 7 | loss: 0.2328245
	speed: 0.0060s/iter; left time: 8.1797s
	iters: 700, epoch: 7 | loss: 1.0323642
	speed: 0.0063s/iter; left time: 7.9722s
	iters: 800, epoch: 7 | loss: 0.8218923
	speed: 0.0063s/iter; left time: 7.3401s
	iters: 900, epoch: 7 | loss: 1.2523628
	speed: 0.0064s/iter; left time: 6.7867s
Updating learning rate to 0.0001525678075877426
Validation loss decreased (0.5990 --> 0.5989).  Saving model state dict ...
Epoch: 7 cost time: 6.038787603378296
Epoch: 7, Steps: 979 | Train Loss: 0.6391561 Vali Loss: 0.5989495 Best vali loss: 0.5989495
	iters: 100, epoch: 8 | loss: 0.3043996
	speed: 0.0192s/iter; left time: 16.8906s
	iters: 200, epoch: 8 | loss: 0.4575082
	speed: 0.0056s/iter; left time: 4.3829s
	iters: 300, epoch: 8 | loss: 0.5320931
	speed: 0.0049s/iter; left time: 3.3554s
	iters: 400, epoch: 8 | loss: 0.4082665
	speed: 0.0061s/iter; left time: 3.5360s
	iters: 500, epoch: 8 | loss: 0.4653433
	speed: 0.0071s/iter; left time: 3.4209s
	iters: 600, epoch: 8 | loss: 0.2866594
	speed: 0.0071s/iter; left time: 2.6843s
	iters: 700, epoch: 8 | loss: 1.5052288
	speed: 0.0063s/iter; left time: 1.7573s
	iters: 800, epoch: 8 | loss: 0.2258676
	speed: 0.0045s/iter; left time: 0.8178s
	iters: 900, epoch: 8 | loss: 0.3966605
	speed: 0.0085s/iter; left time: 0.6799s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.500602960586548
Epoch: 8, Steps: 979 | Train Loss: 0.5091141 Vali Loss: 0.6044970 Best vali loss: 0.5989495

best validation loss 0.5989495160015906

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0042863874146, 'e_layers': 4, 'learning_rate': 5.37539066e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37539066e-05
Validation loss decreased (inf --> 0.7023).  Saving model state dict ...
Epoch: 1 cost time: 1.1063663959503174
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7023241 Best vali loss: 0.7023241
Updating learning rate to 2.68769533e-05
Validation loss decreased (0.7023 --> 0.6906).  Saving model state dict ...
Epoch: 2 cost time: 0.5234081745147705
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6905501 Best vali loss: 0.6905501
Updating learning rate to 1.343847665e-05
Validation loss decreased (0.6906 --> 0.6844).  Saving model state dict ...
Epoch: 3 cost time: 0.600754976272583
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6843642 Best vali loss: 0.6843642

best validation loss 0.6843642090162377

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019514269464, 'e_layers': 3, 'learning_rate': 0.0028203081441, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9864634
	speed: 0.0151s/iter; left time: 13.3362s
Updating learning rate to 0.002712966556904441
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 1.4788556098937988
Epoch: 1, Steps: 123 | Train Loss: 0.9864634 Vali Loss: 0.6489548 Best vali loss: 0.6489548
	iters: 100, epoch: 2 | loss: 0.9342741
	speed: 0.0166s/iter; left time: 12.6578s
Updating learning rate to 0.002407283578914378
Epoch: 2 cost time: 1.3439092636108398
Epoch: 2, Steps: 123 | Train Loss: 0.9342741 Vali Loss: 0.6536773 Best vali loss: 0.6489548
	iters: 100, epoch: 3 | loss: 0.9002891
	speed: 0.0157s/iter; left time: 10.0099s
Updating learning rate to 0.0019497966725057021
Validation loss decreased (0.6490 --> 0.6308).  Saving model state dict ...
Epoch: 3 cost time: 1.3091344833374023
Epoch: 3, Steps: 123 | Train Loss: 0.9002891 Vali Loss: 0.6308338 Best vali loss: 0.6308338

best validation loss 0.6308337723916463

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9795899
	speed: 0.0121s/iter; left time: 22.5475s
	iters: 200, epoch: 1 | loss: 0.9814952
	speed: 0.0061s/iter; left time: 10.7261s
Updating learning rate to 0.00031785342192023166
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 1.84232497215271
Epoch: 1, Steps: 245 | Train Loss: 0.9805425 Vali Loss: 0.6099366 Best vali loss: 0.6099366
	iters: 100, epoch: 2 | loss: 0.8904633
	speed: 0.0146s/iter; left time: 23.6034s
	iters: 200, epoch: 2 | loss: 0.4917381
	speed: 0.0072s/iter; left time: 10.9459s
Updating learning rate to 0.0002820393495610895
Validation loss decreased (0.6099 --> 0.6009).  Saving model state dict ...
Epoch: 2 cost time: 1.8692190647125244
Epoch: 2, Steps: 245 | Train Loss: 0.6911007 Vali Loss: 0.6008632 Best vali loss: 0.6008632
	iters: 100, epoch: 3 | loss: 0.5471919
	speed: 0.0146s/iter; left time: 20.0717s
	iters: 200, epoch: 3 | loss: 0.9876345
	speed: 0.0071s/iter; left time: 9.0419s
Updating learning rate to 0.00022843980248387857
Epoch: 3 cost time: 1.8616857528686523
Epoch: 3, Steps: 245 | Train Loss: 0.7674132 Vali Loss: 0.6283531 Best vali loss: 0.6008632

best validation loss 0.6008632414763528

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9662765
	speed: 0.0138s/iter; left time: 15.4884s
	iters: 200, epoch: 4 | loss: 0.9064848
	speed: 0.0075s/iter; left time: 7.6862s
Updating learning rate to 0.00016521482585
Epoch: 4 cost time: 2.1452860832214355
Epoch: 4, Steps: 245 | Train Loss: 0.9363807 Vali Loss: 0.6009239 Best vali loss: 0.6008632
	iters: 100, epoch: 5 | loss: 0.7862912
	speed: 0.0145s/iter; left time: 12.8095s
	iters: 200, epoch: 5 | loss: 0.4628003
	speed: 0.0073s/iter; left time: 5.7286s
Updating learning rate to 0.00010198984921612144
Validation loss decreased (0.6009 --> 0.5788).  Saving model state dict ...
Epoch: 5 cost time: 1.8693556785583496
Epoch: 5, Steps: 245 | Train Loss: 0.6245457 Vali Loss: 0.5787884 Best vali loss: 0.5787884
	iters: 100, epoch: 6 | loss: 0.4980102
	speed: 0.0132s/iter; left time: 8.4037s
	iters: 200, epoch: 6 | loss: 0.9651957
	speed: 0.0056s/iter; left time: 2.9922s
Updating learning rate to 4.8390302138910505e-05
Epoch: 6 cost time: 1.5511775016784668
Epoch: 6, Steps: 245 | Train Loss: 0.7316030 Vali Loss: 0.5794349 Best vali loss: 0.5787884
	iters: 100, epoch: 7 | loss: 0.5172390
	speed: 0.0137s/iter; left time: 5.3459s
	iters: 200, epoch: 7 | loss: 0.9373893
	speed: 0.0071s/iter; left time: 2.0551s
Updating learning rate to 1.2576229779768348e-05
Validation loss decreased (0.5788 --> 0.5677).  Saving model state dict ...
Epoch: 7 cost time: 1.695650339126587
Epoch: 7, Steps: 245 | Train Loss: 0.7273141 Vali Loss: 0.5677318 Best vali loss: 0.5677318
	iters: 100, epoch: 8 | loss: 0.4771596
	speed: 0.0139s/iter; left time: 2.0356s
	iters: 200, epoch: 8 | loss: 0.7972421
	speed: 0.0068s/iter; left time: 0.3106s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7479135990142822
Epoch: 8, Steps: 245 | Train Loss: 0.6372008 Vali Loss: 0.5710406 Best vali loss: 0.5677318

best validation loss 0.567731796481553

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0061161357241, 'e_layers': 2, 'learning_rate': 0.0026491544935, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8322867
	speed: 0.0115s/iter; left time: 21.4895s
	iters: 200, epoch: 1 | loss: 0.8576851
	speed: 0.0053s/iter; left time: 9.3496s
Updating learning rate to 0.0026491544935
Validation loss decreased (inf --> 0.6422).  Saving model state dict ...
Epoch: 1 cost time: 1.6821019649505615
Epoch: 1, Steps: 245 | Train Loss: 0.8449859 Vali Loss: 0.6421780 Best vali loss: 0.6421780
	iters: 100, epoch: 2 | loss: 1.1132956
	speed: 0.0125s/iter; left time: 20.2572s
	iters: 200, epoch: 2 | loss: 0.5623901
	speed: 0.0056s/iter; left time: 8.4591s
Updating learning rate to 0.00132457724675
Validation loss decreased (0.6422 --> 0.6125).  Saving model state dict ...
Epoch: 2 cost time: 1.461151123046875
Epoch: 2, Steps: 245 | Train Loss: 0.8378429 Vali Loss: 0.6125425 Best vali loss: 0.6125425
	iters: 100, epoch: 3 | loss: 1.4260246
	speed: 0.0120s/iter; left time: 16.4275s
	iters: 200, epoch: 3 | loss: 0.8295649
	speed: 0.0053s/iter; left time: 6.7469s
Updating learning rate to 0.000662288623375
Epoch: 3 cost time: 1.4023993015289307
Epoch: 3, Steps: 245 | Train Loss: 1.1277947 Vali Loss: 0.6152249 Best vali loss: 0.6125425
	iters: 100, epoch: 4 | loss: 0.8607835
	speed: 0.0122s/iter; left time: 13.6927s
	iters: 200, epoch: 4 | loss: 0.6067667
	speed: 0.0054s/iter; left time: 5.5618s
Updating learning rate to 0.0003311443116875
Epoch: 4 cost time: 1.3985519409179688
Epoch: 4, Steps: 245 | Train Loss: 0.7337751 Vali Loss: 0.6212106 Best vali loss: 0.6125425
	iters: 100, epoch: 5 | loss: 0.6904489
	speed: 0.0120s/iter; left time: 10.5296s
	iters: 200, epoch: 5 | loss: 0.5999576
	speed: 0.0046s/iter; left time: 3.6258s
Updating learning rate to 0.00016557215584375
Epoch: 5 cost time: 1.255188226699829
Epoch: 5, Steps: 245 | Train Loss: 0.6452033 Vali Loss: 0.6584342 Best vali loss: 0.6125425
	iters: 100, epoch: 6 | loss: 0.9237863
	speed: 0.0089s/iter; left time: 5.6892s
	iters: 200, epoch: 6 | loss: 0.7776871
	speed: 0.0053s/iter; left time: 2.8445s
Updating learning rate to 8.2786077921875e-05
Epoch: 6 cost time: 1.3313114643096924
Epoch: 6, Steps: 245 | Train Loss: 0.8507367 Vali Loss: 0.6514942 Best vali loss: 0.6125425
	iters: 100, epoch: 7 | loss: 0.6325665
	speed: 0.0123s/iter; left time: 4.8168s
	iters: 200, epoch: 7 | loss: 0.7297678
	speed: 0.0056s/iter; left time: 1.6291s
Updating learning rate to 4.13930389609375e-05
Epoch: 7 cost time: 1.4341928958892822
Epoch: 7, Steps: 245 | Train Loss: 0.6811671 Vali Loss: 0.6575045 Best vali loss: 0.6125425
	iters: 100, epoch: 8 | loss: 0.7240881
	speed: 0.0121s/iter; left time: 1.7660s
	iters: 200, epoch: 8 | loss: 0.8473750
	speed: 0.0056s/iter; left time: 0.2589s
Updating learning rate to 2.069651948046875e-05
Epoch: 8 cost time: 1.4220473766326904
Epoch: 8, Steps: 245 | Train Loss: 0.7857316 Vali Loss: 0.6555248 Best vali loss: 0.6125425

best validation loss 0.6125425465787687

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062416843763, 'e_layers': 2, 'learning_rate': 9.67455128e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0531026
	speed: 0.0116s/iter; left time: 21.5284s
	iters: 200, epoch: 1 | loss: 0.9411644
	speed: 0.0054s/iter; left time: 9.5583s
Updating learning rate to 9.306335596911435e-05
Validation loss decreased (inf --> 0.6567).  Saving model state dict ...
Epoch: 1 cost time: 1.6612634658813477
Epoch: 1, Steps: 245 | Train Loss: 0.9971335 Vali Loss: 0.6566760 Best vali loss: 0.6566760
	iters: 100, epoch: 2 | loss: 1.2253671
	speed: 0.0119s/iter; left time: 19.2483s
	iters: 200, epoch: 2 | loss: 0.6172056
	speed: 0.0056s/iter; left time: 8.4616s
Updating learning rate to 8.257746047512496e-05
Validation loss decreased (0.6567 --> 0.6258).  Saving model state dict ...
Epoch: 2 cost time: 1.3939836025238037
Epoch: 2, Steps: 245 | Train Loss: 0.9212863 Vali Loss: 0.6258133 Best vali loss: 0.6258133
	iters: 100, epoch: 3 | loss: 0.9084243
	speed: 0.0120s/iter; left time: 16.4602s
	iters: 200, epoch: 3 | loss: 1.1467143
	speed: 0.0053s/iter; left time: 6.6735s
Updating learning rate to 6.688420885211237e-05
Validation loss decreased (0.6258 --> 0.6132).  Saving model state dict ...
Epoch: 3 cost time: 1.3970098495483398
Epoch: 3, Steps: 245 | Train Loss: 1.0275693 Vali Loss: 0.6131853 Best vali loss: 0.6131853
	iters: 100, epoch: 4 | loss: 0.6193898
	speed: 0.0120s/iter; left time: 13.5401s
	iters: 200, epoch: 4 | loss: 1.1053578
	speed: 0.0056s/iter; left time: 5.7572s
Updating learning rate to 4.83727564e-05
Validation loss decreased (0.6132 --> 0.6072).  Saving model state dict ...
Epoch: 4 cost time: 1.4199225902557373
Epoch: 4, Steps: 245 | Train Loss: 0.8623738 Vali Loss: 0.6071878 Best vali loss: 0.6071878
	iters: 100, epoch: 5 | loss: 0.7004663
	speed: 0.0122s/iter; left time: 10.7317s
	iters: 200, epoch: 5 | loss: 0.6647416
	speed: 0.0044s/iter; left time: 3.4071s
Updating learning rate to 2.986130394788764e-05
Validation loss decreased (0.6072 --> 0.6070).  Saving model state dict ...
Epoch: 5 cost time: 1.1738741397857666
Epoch: 5, Steps: 245 | Train Loss: 0.6826040 Vali Loss: 0.6069971 Best vali loss: 0.6069971
	iters: 100, epoch: 6 | loss: 1.3680311
	speed: 0.0083s/iter; left time: 5.2560s
	iters: 200, epoch: 6 | loss: 0.6187954
	speed: 0.0040s/iter; left time: 2.1558s
Updating learning rate to 1.4168052324875036e-05
Validation loss decreased (0.6070 --> 0.6062).  Saving model state dict ...
Epoch: 6 cost time: 1.0449016094207764
Epoch: 6, Steps: 245 | Train Loss: 0.9934133 Vali Loss: 0.6061677 Best vali loss: 0.6061677
	iters: 100, epoch: 7 | loss: 0.5323001
	speed: 0.0113s/iter; left time: 4.4243s
	iters: 200, epoch: 7 | loss: 0.9171790
	speed: 0.0053s/iter; left time: 1.5373s
Updating learning rate to 3.682156830885646e-06
Validation loss decreased (0.6062 --> 0.6053).  Saving model state dict ...
Epoch: 7 cost time: 1.4201982021331787
Epoch: 7, Steps: 245 | Train Loss: 0.7247396 Vali Loss: 0.6053373 Best vali loss: 0.6053373
	iters: 100, epoch: 8 | loss: 1.0966666
	speed: 0.0118s/iter; left time: 1.7235s
	iters: 200, epoch: 8 | loss: 0.6901372
	speed: 0.0055s/iter; left time: 0.2545s
Updating learning rate to 0.0
Validation loss decreased (0.6053 --> 0.6052).  Saving model state dict ...
Epoch: 8 cost time: 1.4140923023223877
Epoch: 8, Steps: 245 | Train Loss: 0.8934019 Vali Loss: 0.6052422 Best vali loss: 0.6052422

best validation loss 0.6052422236370191

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596438
	speed: 0.0110s/iter; left time: 20.5556s
	iters: 200, epoch: 1 | loss: 1.2127477
	speed: 0.0058s/iter; left time: 10.2748s
Updating learning rate to 0.000288581929876693
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 1.6598975658416748
Epoch: 1, Steps: 245 | Train Loss: 0.8861957 Vali Loss: 0.6090265 Best vali loss: 0.6090265
	iters: 100, epoch: 2 | loss: 1.1160457
	speed: 0.0121s/iter; left time: 19.5379s
	iters: 200, epoch: 2 | loss: 0.6734317
	speed: 0.0055s/iter; left time: 8.3726s
Updating learning rate to 0.00025606601717798207
Epoch: 2 cost time: 1.4599332809448242
Epoch: 2, Steps: 245 | Train Loss: 0.8947387 Vali Loss: 0.6334385 Best vali loss: 0.6090265
	iters: 100, epoch: 3 | loss: 0.7951878
	speed: 0.0123s/iter; left time: 16.9205s
	iters: 200, epoch: 3 | loss: 0.9345948
	speed: 0.0038s/iter; left time: 4.8043s
Updating learning rate to 0.00020740251485476345
Validation loss decreased (0.6090 --> 0.5755).  Saving model state dict ...
Epoch: 3 cost time: 1.168734073638916
Epoch: 3, Steps: 245 | Train Loss: 0.8648913 Vali Loss: 0.5754589 Best vali loss: 0.5754589

best validation loss 0.5754589374310327

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.003415295389, 'e_layers': 1, 'learning_rate': 0.0001528244414, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9055944
	speed: 0.0102s/iter; left time: 18.9693s
	iters: 200, epoch: 1 | loss: 0.5543681
	speed: 0.0042s/iter; left time: 7.4567s
Updating learning rate to 0.00014700790743846527
Validation loss decreased (inf --> 0.6400).  Saving model state dict ...
Epoch: 1 cost time: 1.3647067546844482
Epoch: 1, Steps: 245 | Train Loss: 0.7299812 Vali Loss: 0.6399884 Best vali loss: 0.6399884
	iters: 100, epoch: 2 | loss: 0.6520360
	speed: 0.0103s/iter; left time: 16.5845s
	iters: 200, epoch: 2 | loss: 0.8746980
	speed: 0.0048s/iter; left time: 7.3298s
Updating learning rate to 0.00013044382012249305
Validation loss decreased (0.6400 --> 0.6131).  Saving model state dict ...
Epoch: 2 cost time: 1.2173752784729004
Epoch: 2, Steps: 245 | Train Loss: 0.7633670 Vali Loss: 0.6130790 Best vali loss: 0.6130790
	iters: 100, epoch: 3 | loss: 1.1036111
	speed: 0.0100s/iter; left time: 13.7674s
	iters: 200, epoch: 3 | loss: 0.8841374
	speed: 0.0029s/iter; left time: 3.6277s
Updating learning rate to 0.00010565391159211477
Validation loss decreased (0.6131 --> 0.6036).  Saving model state dict ...
Epoch: 3 cost time: 0.8621008396148682
Epoch: 3, Steps: 245 | Train Loss: 0.9938743 Vali Loss: 0.6036165 Best vali loss: 0.6036165

best validation loss 0.6036164563930129

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0025198955415, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8935996
	speed: 0.0104s/iter; left time: 19.2826s
	iters: 200, epoch: 1 | loss: 0.7806091
	speed: 0.0045s/iter; left time: 7.9789s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 1.4144184589385986
Epoch: 1, Steps: 245 | Train Loss: 0.8371044 Vali Loss: 0.6139714 Best vali loss: 0.6139714
	iters: 100, epoch: 2 | loss: 0.5861340
	speed: 0.0106s/iter; left time: 17.0832s
	iters: 200, epoch: 2 | loss: 0.6719007
	speed: 0.0042s/iter; left time: 6.3015s
Updating learning rate to 0.0002612410192867383
Validation loss decreased (0.6140 --> 0.6031).  Saving model state dict ...
Epoch: 2 cost time: 1.1491734981536865
Epoch: 2, Steps: 245 | Train Loss: 0.6290174 Vali Loss: 0.6030983 Best vali loss: 0.6030983
	iters: 100, epoch: 3 | loss: 0.7755135
	speed: 0.0105s/iter; left time: 14.3379s
	iters: 200, epoch: 3 | loss: 0.6883925
	speed: 0.0045s/iter; left time: 5.7676s
Updating learning rate to 0.00021159404508420707
Validation loss decreased (0.6031 --> 0.6029).  Saving model state dict ...
Epoch: 3 cost time: 1.1943752765655518
Epoch: 3, Steps: 245 | Train Loss: 0.7319530 Vali Loss: 0.6028725 Best vali loss: 0.6028725

best validation loss 0.6028725052806637

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5354056
	speed: 0.0117s/iter; left time: 13.1788s
	iters: 200, epoch: 4 | loss: 1.0805461
	speed: 0.0055s/iter; left time: 5.6386s
Updating learning rate to 0.00015
Epoch: 4 cost time: 1.6448028087615967
Epoch: 4, Steps: 245 | Train Loss: 0.8079759 Vali Loss: 0.5803061 Best vali loss: 0.5754589
	iters: 100, epoch: 5 | loss: 1.0216095
	speed: 0.0103s/iter; left time: 9.0822s
	iters: 200, epoch: 5 | loss: 0.6231388
	speed: 0.0039s/iter; left time: 3.0806s
Updating learning rate to 9.259748514523653e-05
Validation loss decreased (0.5755 --> 0.5681).  Saving model state dict ...
Epoch: 5 cost time: 1.095442771911621
Epoch: 5, Steps: 245 | Train Loss: 0.8223742 Vali Loss: 0.5681021 Best vali loss: 0.5681021
	iters: 100, epoch: 6 | loss: 0.7599983
	speed: 0.0113s/iter; left time: 7.2176s
	iters: 200, epoch: 6 | loss: 0.8664338
	speed: 0.0061s/iter; left time: 3.2640s
Updating learning rate to 4.3933982822017876e-05
Validation loss decreased (0.5681 --> 0.5631).  Saving model state dict ...
Epoch: 6 cost time: 1.4423561096191406
Epoch: 6, Steps: 245 | Train Loss: 0.8132161 Vali Loss: 0.5630552 Best vali loss: 0.5630552
	iters: 100, epoch: 7 | loss: 0.8768613
	speed: 0.0123s/iter; left time: 4.8192s
	iters: 200, epoch: 7 | loss: 0.6735277
	speed: 0.0057s/iter; left time: 1.6692s
Updating learning rate to 1.1418070123306989e-05
Validation loss decreased (0.5631 --> 0.5610).  Saving model state dict ...
Epoch: 7 cost time: 1.4103615283966064
Epoch: 7, Steps: 245 | Train Loss: 0.7751945 Vali Loss: 0.5610017 Best vali loss: 0.5610017
	iters: 100, epoch: 8 | loss: 0.9411040
	speed: 0.0122s/iter; left time: 1.7860s
	iters: 200, epoch: 8 | loss: 0.7574620
	speed: 0.0057s/iter; left time: 0.2626s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4343523979187012
Epoch: 8, Steps: 245 | Train Loss: 0.8492830 Vali Loss: 0.5631208 Best vali loss: 0.5610017

best validation loss 0.5610017143758785

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0015226276442, 'e_layers': 1, 'learning_rate': 0.0003229925127, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7400548
	speed: 0.0105s/iter; left time: 9.3145s
Updating learning rate to 0.0003229925127
Validation loss decreased (inf --> 0.6125).  Saving model state dict ...
Epoch: 1 cost time: 0.849921464920044
Epoch: 1, Steps: 123 | Train Loss: 0.7400548 Vali Loss: 0.6125179 Best vali loss: 0.6125179
	iters: 100, epoch: 2 | loss: 1.0701650
	speed: 0.0070s/iter; left time: 5.3363s
Updating learning rate to 0.00016149625635
Validation loss decreased (0.6125 --> 0.6067).  Saving model state dict ...
Epoch: 2 cost time: 0.5819072723388672
Epoch: 2, Steps: 123 | Train Loss: 1.0701650 Vali Loss: 0.6067044 Best vali loss: 0.6067044
	iters: 100, epoch: 3 | loss: 0.8366982
	speed: 0.0108s/iter; left time: 6.9170s
Updating learning rate to 8.0748128175e-05
Validation loss decreased (0.6067 --> 0.6019).  Saving model state dict ...
Epoch: 3 cost time: 0.8121240139007568
Epoch: 3, Steps: 123 | Train Loss: 0.8366982 Vali Loss: 0.6018804 Best vali loss: 0.6018804
	iters: 100, epoch: 4 | loss: 0.9887382
	speed: 0.0105s/iter; left time: 5.4356s
Updating learning rate to 4.03740640875e-05
Epoch: 4 cost time: 0.838512659072876
Epoch: 4, Steps: 123 | Train Loss: 0.9887382 Vali Loss: 0.6036713 Best vali loss: 0.6018804
	iters: 100, epoch: 5 | loss: 0.6199982
	speed: 0.0097s/iter; left time: 3.8232s
Updating learning rate to 2.018703204375e-05
Epoch: 5 cost time: 0.767064094543457
Epoch: 5, Steps: 123 | Train Loss: 0.6199982 Vali Loss: 0.6055045 Best vali loss: 0.6018804
	iters: 100, epoch: 6 | loss: 0.8653041
	speed: 0.0103s/iter; left time: 2.7848s
Updating learning rate to 1.0093516021875e-05
Epoch: 6 cost time: 0.7847416400909424
Epoch: 6, Steps: 123 | Train Loss: 0.8653041 Vali Loss: 0.6055067 Best vali loss: 0.6018804
	iters: 100, epoch: 7 | loss: 0.7188256
	speed: 0.0107s/iter; left time: 1.5665s
Updating learning rate to 5.0467580109375e-06
Epoch: 7 cost time: 0.8099353313446045
Epoch: 7, Steps: 123 | Train Loss: 0.7188256 Vali Loss: 0.6053754 Best vali loss: 0.6018804
	iters: 100, epoch: 8 | loss: 0.8094690
	speed: 0.0104s/iter; left time: 0.2498s
Updating learning rate to 2.52337900546875e-06
Epoch: 8 cost time: 0.7958338260650635
Epoch: 8, Steps: 123 | Train Loss: 0.8094690 Vali Loss: 0.6053295 Best vali loss: 0.6018804

best validation loss 0.6018803760388669

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0067707384255, 'e_layers': 1, 'learning_rate': 0.0002592776834, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8421605
	speed: 0.0103s/iter; left time: 19.1618s
	iters: 200, epoch: 1 | loss: 0.9710922
	speed: 0.0047s/iter; left time: 8.3150s
Updating learning rate to 0.0002494095141651007
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 1.4242217540740967
Epoch: 1, Steps: 245 | Train Loss: 0.9066263 Vali Loss: 0.6156684 Best vali loss: 0.6156684
	iters: 100, epoch: 2 | loss: 1.0409533
	speed: 0.0105s/iter; left time: 16.9229s
	iters: 200, epoch: 2 | loss: 0.8580849
	speed: 0.0046s/iter; left time: 6.9049s
Updating learning rate to 0.00022130734577123935
Validation loss decreased (0.6157 --> 0.6039).  Saving model state dict ...
Epoch: 2 cost time: 1.1758227348327637
Epoch: 2, Steps: 245 | Train Loss: 0.9495191 Vali Loss: 0.6038898 Best vali loss: 0.6038898
	iters: 100, epoch: 3 | loss: 0.9280276
	speed: 0.0103s/iter; left time: 14.1047s
	iters: 200, epoch: 3 | loss: 0.8657936
	speed: 0.0031s/iter; left time: 3.9093s
Updating learning rate to 0.00017924947860959052
Validation loss decreased (0.6039 --> 0.6038).  Saving model state dict ...
Epoch: 3 cost time: 0.917548656463623
Epoch: 3, Steps: 245 | Train Loss: 0.8969106 Vali Loss: 0.6037646 Best vali loss: 0.6037646
	iters: 100, epoch: 4 | loss: 0.7440578
	speed: 0.0082s/iter; left time: 9.2435s
	iters: 200, epoch: 4 | loss: 0.8497257
	speed: 0.0048s/iter; left time: 4.9580s
Updating learning rate to 0.0001296388417
Validation loss decreased (0.6038 --> 0.6025).  Saving model state dict ...
Epoch: 4 cost time: 1.1620845794677734
Epoch: 4, Steps: 245 | Train Loss: 0.7968917 Vali Loss: 0.6024719 Best vali loss: 0.6024719
	iters: 100, epoch: 5 | loss: 0.9826502
	speed: 0.0099s/iter; left time: 8.6819s
	iters: 200, epoch: 5 | loss: 0.6963569
	speed: 0.0045s/iter; left time: 3.5438s
Updating learning rate to 8.002820479040947e-05
Validation loss decreased (0.6025 --> 0.6006).  Saving model state dict ...
Epoch: 5 cost time: 1.1490280628204346
Epoch: 5, Steps: 245 | Train Loss: 0.8395036 Vali Loss: 0.6006006 Best vali loss: 0.6006006
	iters: 100, epoch: 6 | loss: 0.5684234
	speed: 0.0104s/iter; left time: 6.6128s
	iters: 200, epoch: 6 | loss: 0.6784464
	speed: 0.0048s/iter; left time: 2.5753s
Updating learning rate to 3.797033762876063e-05
Epoch: 6 cost time: 1.205998182296753
Epoch: 6, Steps: 245 | Train Loss: 0.6234349 Vali Loss: 0.6022157 Best vali loss: 0.6006006
	iters: 100, epoch: 7 | loss: 0.9100910
	speed: 0.0100s/iter; left time: 3.8909s
	iters: 200, epoch: 7 | loss: 0.6401420
	speed: 0.0046s/iter; left time: 1.3340s
Updating learning rate to 9.868169234899294e-06
Epoch: 7 cost time: 1.1661632061004639
Epoch: 7, Steps: 245 | Train Loss: 0.7751165 Vali Loss: 0.6024041 Best vali loss: 0.6006006
	iters: 100, epoch: 8 | loss: 0.5139558
	speed: 0.0101s/iter; left time: 1.4779s
	iters: 200, epoch: 8 | loss: 0.6821763
	speed: 0.0048s/iter; left time: 0.2206s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2167880535125732
Epoch: 8, Steps: 245 | Train Loss: 0.5980661 Vali Loss: 0.6028067 Best vali loss: 0.6006006

best validation loss 0.6006005622070733

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8974108
	speed: 0.0115s/iter; left time: 43.9934s
	iters: 200, epoch: 1 | loss: 0.8140879
	speed: 0.0037s/iter; left time: 13.8552s
	iters: 300, epoch: 1 | loss: 0.7608951
	speed: 0.0036s/iter; left time: 13.0792s
	iters: 400, epoch: 1 | loss: 0.9134187
	speed: 0.0053s/iter; left time: 18.7597s
Updating learning rate to 0.0004342987517734106
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 2.645580530166626
Epoch: 1, Steps: 490 | Train Loss: 0.8464531 Vali Loss: 0.6140028 Best vali loss: 0.6140028
	iters: 100, epoch: 2 | loss: 1.0398082
	speed: 0.0157s/iter; left time: 52.2276s
	iters: 200, epoch: 2 | loss: 0.7170162
	speed: 0.0048s/iter; left time: 15.5951s
	iters: 300, epoch: 2 | loss: 0.6743641
	speed: 0.0035s/iter; left time: 10.8539s
	iters: 400, epoch: 2 | loss: 0.9967459
	speed: 0.0035s/iter; left time: 10.5638s
Updating learning rate to 0.0003853642245704867
Validation loss decreased (0.6140 --> 0.6056).  Saving model state dict ...
Epoch: 2 cost time: 2.2284960746765137
Epoch: 2, Steps: 490 | Train Loss: 0.8569836 Vali Loss: 0.6056009 Best vali loss: 0.6056009
	iters: 100, epoch: 3 | loss: 0.5476401
	speed: 0.0150s/iter; left time: 42.7242s
	iters: 200, epoch: 3 | loss: 0.7924822
	speed: 0.0058s/iter; left time: 15.8292s
	iters: 300, epoch: 3 | loss: 0.5297087
	speed: 0.0040s/iter; left time: 10.6111s
	iters: 400, epoch: 3 | loss: 0.5456807
	speed: 0.0038s/iter; left time: 9.6015s
Updating learning rate to 0.0003121285291652796
Epoch: 3 cost time: 2.334902048110962
Epoch: 3, Steps: 490 | Train Loss: 0.6038779 Vali Loss: 0.6375927 Best vali loss: 0.6056009

best validation loss 0.6056009381388912

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0034938739476, 'e_layers': 4, 'learning_rate': 0.0001269098969, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001220796765595138
Validation loss decreased (inf --> 0.6636).  Saving model state dict ...
Epoch: 1 cost time: 0.845285177230835
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6635941 Best vali loss: 0.6635941
Updating learning rate to 0.0001083243727988378
Validation loss decreased (0.6636 --> 0.6409).  Saving model state dict ...
Epoch: 2 cost time: 0.7176837921142578
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6409049 Best vali loss: 0.6409049
Updating learning rate to 8.773810592339583e-05
Validation loss decreased (0.6409 --> 0.6301).  Saving model state dict ...
Epoch: 3 cost time: 0.6317532062530518
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6300713 Best vali loss: 0.6300713

best validation loss 0.6300712854759608

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0017396805512, 'e_layers': 3, 'learning_rate': 0.0001397169929, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001397169929
Validation loss decreased (inf --> 0.6677).  Saving model state dict ...
Epoch: 1 cost time: 0.9250855445861816
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6676569 Best vali loss: 0.6676569
Updating learning rate to 6.985849645e-05
Validation loss decreased (0.6677 --> 0.6392).  Saving model state dict ...
Epoch: 2 cost time: 0.601508617401123
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6392321 Best vali loss: 0.6392321
Updating learning rate to 3.4929248225e-05
Validation loss decreased (0.6392 --> 0.6307).  Saving model state dict ...
Epoch: 3 cost time: 0.567136287689209
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6306933 Best vali loss: 0.6306933

best validation loss 0.6306933444277769

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8368546
	speed: 0.0112s/iter; left time: 26.3806s
	iters: 200, epoch: 4 | loss: 0.8291667
	speed: 0.0051s/iter; left time: 11.4113s
	iters: 300, epoch: 4 | loss: 0.7155821
	speed: 0.0048s/iter; left time: 10.3654s
	iters: 400, epoch: 4 | loss: 0.7384655
	speed: 0.0050s/iter; left time: 10.2708s
Updating learning rate to 0.0002257411363
Epoch: 4 cost time: 2.723189115524292
Epoch: 4, Steps: 490 | Train Loss: 0.7800172 Vali Loss: 0.6568820 Best vali loss: 0.6056009
	iters: 100, epoch: 5 | loss: 0.9816319
	speed: 0.0145s/iter; left time: 26.9987s
	iters: 200, epoch: 5 | loss: 0.6649258
	speed: 0.0050s/iter; left time: 8.7240s
	iters: 300, epoch: 5 | loss: 0.5350012
	speed: 0.0049s/iter; left time: 8.1566s
	iters: 400, epoch: 5 | loss: 0.8468727
	speed: 0.0050s/iter; left time: 7.7880s
Updating learning rate to 0.00013935374343472043
Epoch: 5 cost time: 2.445347309112549
Epoch: 5, Steps: 490 | Train Loss: 0.7571079 Vali Loss: 0.6400616 Best vali loss: 0.6056009
	iters: 100, epoch: 6 | loss: 0.4855633
	speed: 0.0143s/iter; left time: 19.5839s
	iters: 200, epoch: 6 | loss: 0.6148075
	speed: 0.0038s/iter; left time: 4.8410s
	iters: 300, epoch: 6 | loss: 0.4618922
	speed: 0.0035s/iter; left time: 4.1164s
	iters: 400, epoch: 6 | loss: 0.4188479
	speed: 0.0037s/iter; left time: 3.9178s
Updating learning rate to 6.611804802951332e-05
Epoch: 6 cost time: 1.9277417659759521
Epoch: 6, Steps: 490 | Train Loss: 0.4952777 Vali Loss: 0.6467780 Best vali loss: 0.6056009
	iters: 100, epoch: 7 | loss: 0.7824755
	speed: 0.0132s/iter; left time: 11.6019s
	iters: 200, epoch: 7 | loss: 0.5253639
	speed: 0.0053s/iter; left time: 4.1461s
	iters: 300, epoch: 7 | loss: 0.5115157
	speed: 0.0052s/iter; left time: 3.5226s
	iters: 400, epoch: 7 | loss: 0.7891085
	speed: 0.0052s/iter; left time: 3.0229s
Updating learning rate to 1.718352082658934e-05
Epoch: 7 cost time: 2.6597068309783936
Epoch: 7, Steps: 490 | Train Loss: 0.6521159 Vali Loss: 0.6614306 Best vali loss: 0.6056009
	iters: 100, epoch: 8 | loss: 0.3792089
	speed: 0.0152s/iter; left time: 5.9359s
	iters: 200, epoch: 8 | loss: 0.4829974
	speed: 0.0054s/iter; left time: 1.5810s
	iters: 300, epoch: 8 | loss: 0.6547836
	speed: 0.0054s/iter; left time: 1.0300s
	iters: 400, epoch: 8 | loss: 1.0864770
	speed: 0.0055s/iter; left time: 0.5022s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.711639165878296
Epoch: 8, Steps: 490 | Train Loss: 0.6508667 Vali Loss: 0.6586679 Best vali loss: 0.6056009

best validation loss 0.6056009381388912

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066334976282, 'e_layers': 4, 'learning_rate': 0.0046791286395, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5900814
	speed: 0.0126s/iter; left time: 47.9883s
	iters: 200, epoch: 1 | loss: 0.5902076
	speed: 0.0070s/iter; left time: 26.1274s
	iters: 300, epoch: 1 | loss: 1.6731267
	speed: 0.0071s/iter; left time: 25.5320s
	iters: 400, epoch: 1 | loss: 0.8382800
	speed: 0.0071s/iter; left time: 25.1275s
Updating learning rate to 0.0046791286395
Validation loss decreased (inf --> 0.6504).  Saving model state dict ...
Epoch: 1 cost time: 3.7340619564056396
Epoch: 1, Steps: 490 | Train Loss: 0.9229239 Vali Loss: 0.6504301 Best vali loss: 0.6504301
	iters: 100, epoch: 2 | loss: 0.4884705
	speed: 0.0190s/iter; left time: 63.1469s
	iters: 200, epoch: 2 | loss: 0.8858009
	speed: 0.0072s/iter; left time: 23.1498s
	iters: 300, epoch: 2 | loss: 0.7541142
	speed: 0.0071s/iter; left time: 22.1804s
	iters: 400, epoch: 2 | loss: 0.4856357
	speed: 0.0071s/iter; left time: 21.6525s
Updating learning rate to 0.00233956431975
Validation loss decreased (0.6504 --> 0.6438).  Saving model state dict ...
Epoch: 2 cost time: 3.5555930137634277
Epoch: 2, Steps: 490 | Train Loss: 0.6535053 Vali Loss: 0.6437979 Best vali loss: 0.6437979
	iters: 100, epoch: 3 | loss: 0.8241845
	speed: 0.0187s/iter; left time: 53.1445s
	iters: 200, epoch: 3 | loss: 0.9313184
	speed: 0.0070s/iter; left time: 19.3071s
	iters: 300, epoch: 3 | loss: 0.9021031
	speed: 0.0071s/iter; left time: 18.8598s
	iters: 400, epoch: 3 | loss: 0.9401860
	speed: 0.0070s/iter; left time: 17.8863s
Updating learning rate to 0.001169782159875
Validation loss decreased (0.6438 --> 0.6322).  Saving model state dict ...
Epoch: 3 cost time: 3.51377272605896
Epoch: 3, Steps: 490 | Train Loss: 0.8994480 Vali Loss: 0.6322423 Best vali loss: 0.6322423
	iters: 100, epoch: 4 | loss: 0.5301071
	speed: 0.0189s/iter; left time: 44.5004s
	iters: 200, epoch: 4 | loss: 0.9180409
	speed: 0.0070s/iter; left time: 15.8610s
	iters: 300, epoch: 4 | loss: 1.7061501
	speed: 0.0072s/iter; left time: 15.5831s
	iters: 400, epoch: 4 | loss: 0.7977623
	speed: 0.0071s/iter; left time: 14.6412s
Updating learning rate to 0.0005848910799375
Validation loss decreased (0.6322 --> 0.6183).  Saving model state dict ...
Epoch: 4 cost time: 3.5459256172180176
Epoch: 4, Steps: 490 | Train Loss: 0.9880151 Vali Loss: 0.6182673 Best vali loss: 0.6182673
	iters: 100, epoch: 5 | loss: 0.7684376
	speed: 0.0198s/iter; left time: 36.7962s
	iters: 200, epoch: 5 | loss: 1.0040462
	speed: 0.0071s/iter; left time: 12.4318s
	iters: 300, epoch: 5 | loss: 0.8935025
	speed: 0.0070s/iter; left time: 11.6793s
	iters: 400, epoch: 5 | loss: 0.5436890
	speed: 0.0070s/iter; left time: 10.9235s
Updating learning rate to 0.00029244553996875
Epoch: 5 cost time: 3.540247678756714
Epoch: 5, Steps: 490 | Train Loss: 0.8024188 Vali Loss: 0.6216893 Best vali loss: 0.6182673
	iters: 100, epoch: 6 | loss: 0.6555985
	speed: 0.0189s/iter; left time: 25.8467s
	iters: 200, epoch: 6 | loss: 0.5787442
	speed: 0.0069s/iter; left time: 8.7150s
	iters: 300, epoch: 6 | loss: 0.6719853
	speed: 0.0071s/iter; left time: 8.3619s
	iters: 400, epoch: 6 | loss: 1.0979605
	speed: 0.0069s/iter; left time: 7.3809s
Updating learning rate to 0.000146222769984375
Validation loss decreased (0.6183 --> 0.6133).  Saving model state dict ...
Epoch: 6 cost time: 3.458892822265625
Epoch: 6, Steps: 490 | Train Loss: 0.7510721 Vali Loss: 0.6133362 Best vali loss: 0.6133362
	iters: 100, epoch: 7 | loss: 1.2098854
	speed: 0.0174s/iter; left time: 15.3636s
	iters: 200, epoch: 7 | loss: 1.1245081
	speed: 0.0054s/iter; left time: 4.2481s
	iters: 300, epoch: 7 | loss: 0.9242617
	speed: 0.0056s/iter; left time: 3.8377s
	iters: 400, epoch: 7 | loss: 0.9732881
	speed: 0.0058s/iter; left time: 3.3436s
Updating learning rate to 7.31113849921875e-05
Epoch: 7 cost time: 2.784311532974243
Epoch: 7, Steps: 490 | Train Loss: 1.0579858 Vali Loss: 0.6216182 Best vali loss: 0.6133362
	iters: 100, epoch: 8 | loss: 1.0733348
	speed: 0.0164s/iter; left time: 6.4029s
	iters: 200, epoch: 8 | loss: 0.9525774
	speed: 0.0064s/iter; left time: 1.8672s
	iters: 300, epoch: 8 | loss: 1.0766212
	speed: 0.0064s/iter; left time: 1.2282s
	iters: 400, epoch: 8 | loss: 0.4391041
	speed: 0.0063s/iter; left time: 0.5720s
Updating learning rate to 3.655569249609375e-05
Epoch: 8 cost time: 3.1912670135498047
Epoch: 8, Steps: 490 | Train Loss: 0.8854094 Vali Loss: 0.6259648 Best vali loss: 0.6133362

best validation loss 0.613336191856988

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0408608
	speed: 0.0107s/iter; left time: 82.7383s
	iters: 200, epoch: 1 | loss: 1.2378451
	speed: 0.0051s/iter; left time: 39.0051s
	iters: 300, epoch: 1 | loss: 0.3313201
	speed: 0.0052s/iter; left time: 38.8833s
	iters: 400, epoch: 1 | loss: 1.8115822
	speed: 0.0050s/iter; left time: 37.3760s
	iters: 500, epoch: 1 | loss: 0.8323147
	speed: 0.0051s/iter; left time: 37.6765s
	iters: 600, epoch: 1 | loss: 1.0873618
	speed: 0.0051s/iter; left time: 37.0287s
	iters: 700, epoch: 1 | loss: 0.5267245
	speed: 0.0051s/iter; left time: 36.1171s
	iters: 800, epoch: 1 | loss: 0.7702051
	speed: 0.0050s/iter; left time: 35.2973s
	iters: 900, epoch: 1 | loss: 1.7705765
	speed: 0.0051s/iter; left time: 35.0582s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.6059).  Saving model state dict ...
Epoch: 1 cost time: 5.24189019203186
Epoch: 1, Steps: 979 | Train Loss: 1.0454212 Vali Loss: 0.6058917 Best vali loss: 0.6058917
	iters: 100, epoch: 2 | loss: 0.9616823
	speed: 0.0159s/iter; left time: 107.3813s
	iters: 200, epoch: 2 | loss: 0.8474528
	speed: 0.0051s/iter; left time: 33.8705s
	iters: 300, epoch: 2 | loss: 0.9959068
	speed: 0.0051s/iter; left time: 33.6834s
	iters: 400, epoch: 2 | loss: 0.7036467
	speed: 0.0051s/iter; left time: 33.0700s
	iters: 500, epoch: 2 | loss: 1.3460957
	speed: 0.0052s/iter; left time: 32.9814s
	iters: 600, epoch: 2 | loss: 1.5334241
	speed: 0.0052s/iter; left time: 32.4033s
	iters: 700, epoch: 2 | loss: 0.6706322
	speed: 0.0051s/iter; left time: 31.4870s
	iters: 800, epoch: 2 | loss: 0.3937295
	speed: 0.0052s/iter; left time: 31.2410s
	iters: 900, epoch: 2 | loss: 1.2611403
	speed: 0.0051s/iter; left time: 30.3336s
Updating learning rate to 0.000252166657013118
Epoch: 2 cost time: 5.070311784744263
Epoch: 2, Steps: 979 | Train Loss: 0.9681901 Vali Loss: 0.6120796 Best vali loss: 0.6058917
	iters: 100, epoch: 3 | loss: 0.7320548
	speed: 0.0161s/iter; left time: 93.1655s
	iters: 200, epoch: 3 | loss: 0.3789176
	speed: 0.0052s/iter; left time: 29.2537s
	iters: 300, epoch: 3 | loss: 1.3283794
	speed: 0.0051s/iter; left time: 28.6010s
	iters: 400, epoch: 3 | loss: 0.8080542
	speed: 0.0051s/iter; left time: 28.0561s
	iters: 500, epoch: 3 | loss: 0.5531102
	speed: 0.0051s/iter; left time: 27.3102s
	iters: 600, epoch: 3 | loss: 0.2862832
	speed: 0.0051s/iter; left time: 26.9405s
	iters: 700, epoch: 3 | loss: 1.4578739
	speed: 0.0052s/iter; left time: 26.7047s
	iters: 800, epoch: 3 | loss: 1.4187293
	speed: 0.0050s/iter; left time: 25.5502s
	iters: 900, epoch: 3 | loss: 0.6468715
	speed: 0.0050s/iter; left time: 24.8161s
Updating learning rate to 0.0002042442000052176
Validation loss decreased (0.6059 --> 0.6038).  Saving model state dict ...
Epoch: 3 cost time: 5.036716938018799
Epoch: 3, Steps: 979 | Train Loss: 0.8455860 Vali Loss: 0.6038192 Best vali loss: 0.6038192
	iters: 100, epoch: 4 | loss: 0.9902421
	speed: 0.0158s/iter; left time: 75.6535s
	iters: 200, epoch: 4 | loss: 0.2783344
	speed: 0.0053s/iter; left time: 24.7013s
	iters: 300, epoch: 4 | loss: 0.7823044
	speed: 0.0052s/iter; left time: 23.8213s
	iters: 400, epoch: 4 | loss: 0.8813523
	speed: 0.0052s/iter; left time: 23.4839s
	iters: 500, epoch: 4 | loss: 0.2807065
	speed: 0.0052s/iter; left time: 22.7404s
	iters: 600, epoch: 4 | loss: 0.4598987
	speed: 0.0053s/iter; left time: 22.9794s
	iters: 700, epoch: 4 | loss: 0.7331123
	speed: 0.0058s/iter; left time: 24.2789s
	iters: 800, epoch: 4 | loss: 0.8045416
	speed: 0.0052s/iter; left time: 21.2398s
	iters: 900, epoch: 4 | loss: 1.1914873
	speed: 0.0052s/iter; left time: 20.5807s
Updating learning rate to 0.0001477158077
Validation loss decreased (0.6038 --> 0.5712).  Saving model state dict ...
Epoch: 4 cost time: 5.174813985824585
Epoch: 4, Steps: 979 | Train Loss: 0.7113311 Vali Loss: 0.5712491 Best vali loss: 0.5712491
	iters: 100, epoch: 5 | loss: 0.9675207
	speed: 0.0160s/iter; left time: 61.1737s
	iters: 200, epoch: 5 | loss: 1.0885459
	speed: 0.0050s/iter; left time: 18.4355s
	iters: 300, epoch: 5 | loss: 0.5652969
	speed: 0.0055s/iter; left time: 19.8228s
	iters: 400, epoch: 5 | loss: 0.4860126
	speed: 0.0055s/iter; left time: 19.1874s
	iters: 500, epoch: 5 | loss: 0.7570847
	speed: 0.0055s/iter; left time: 18.6808s
	iters: 600, epoch: 5 | loss: 1.1042726
	speed: 0.0052s/iter; left time: 17.3603s
	iters: 700, epoch: 5 | loss: 0.7012806
	speed: 0.0053s/iter; left time: 17.1807s
	iters: 800, epoch: 5 | loss: 0.7967120
	speed: 0.0054s/iter; left time: 16.7336s
	iters: 900, epoch: 5 | loss: 0.8017371
	speed: 0.0054s/iter; left time: 16.3376s
Updating learning rate to 9.118741539478246e-05
Validation loss decreased (0.5712 --> 0.5703).  Saving model state dict ...
Epoch: 5 cost time: 5.24200439453125
Epoch: 5, Steps: 979 | Train Loss: 0.8076070 Vali Loss: 0.5702840 Best vali loss: 0.5702840
	iters: 100, epoch: 6 | loss: 0.4569766
	speed: 0.0167s/iter; left time: 47.4427s
	iters: 200, epoch: 6 | loss: 1.7230270
	speed: 0.0049s/iter; left time: 13.3889s
	iters: 300, epoch: 6 | loss: 0.3876432
	speed: 0.0052s/iter; left time: 13.6400s
	iters: 400, epoch: 6 | loss: 0.8593634
	speed: 0.0054s/iter; left time: 13.8067s
	iters: 500, epoch: 6 | loss: 0.2917070
	speed: 0.0055s/iter; left time: 13.3044s
	iters: 600, epoch: 6 | loss: 0.5345595
	speed: 0.0054s/iter; left time: 12.7206s
	iters: 700, epoch: 6 | loss: 1.5176383
	speed: 0.0058s/iter; left time: 12.9934s
	iters: 800, epoch: 6 | loss: 0.8750750
	speed: 0.0054s/iter; left time: 11.6282s
	iters: 900, epoch: 6 | loss: 0.8224671
	speed: 0.0055s/iter; left time: 11.1707s
Updating learning rate to 4.326495838688198e-05
Validation loss decreased (0.5703 --> 0.5655).  Saving model state dict ...
Epoch: 6 cost time: 5.292263984680176
Epoch: 6, Steps: 979 | Train Loss: 0.8298286 Vali Loss: 0.5655134 Best vali loss: 0.5655134
	iters: 100, epoch: 7 | loss: 0.5999375
	speed: 0.0168s/iter; left time: 31.2838s
	iters: 200, epoch: 7 | loss: 1.1698102
	speed: 0.0048s/iter; left time: 8.4446s
	iters: 300, epoch: 7 | loss: 0.7262542
	speed: 0.0048s/iter; left time: 7.9561s
	iters: 400, epoch: 7 | loss: 0.8686751
	speed: 0.0047s/iter; left time: 7.3735s
	iters: 500, epoch: 7 | loss: 0.4187454
	speed: 0.0051s/iter; left time: 7.4227s
	iters: 600, epoch: 7 | loss: 0.6810710
	speed: 0.0051s/iter; left time: 6.9816s
	iters: 700, epoch: 7 | loss: 0.8717526
	speed: 0.0051s/iter; left time: 6.3903s
	iters: 800, epoch: 7 | loss: 0.9577666
	speed: 0.0051s/iter; left time: 5.8963s
	iters: 900, epoch: 7 | loss: 0.7564154
	speed: 0.0051s/iter; left time: 5.3683s
Updating learning rate to 1.124419633759687e-05
Validation loss decreased (0.5655 --> 0.5631).  Saving model state dict ...
Epoch: 7 cost time: 4.938420057296753
Epoch: 7, Steps: 979 | Train Loss: 0.7833809 Vali Loss: 0.5631148 Best vali loss: 0.5631148
	iters: 100, epoch: 8 | loss: 1.1624464
	speed: 0.0162s/iter; left time: 14.2438s
	iters: 200, epoch: 8 | loss: 0.8304714
	speed: 0.0050s/iter; left time: 3.9186s
	iters: 300, epoch: 8 | loss: 0.6008003
	speed: 0.0049s/iter; left time: 3.3431s
	iters: 400, epoch: 8 | loss: 0.6332417
	speed: 0.0047s/iter; left time: 2.7428s
	iters: 500, epoch: 8 | loss: 0.6151569
	speed: 0.0042s/iter; left time: 2.0113s
	iters: 600, epoch: 8 | loss: 0.5188116
	speed: 0.0039s/iter; left time: 1.4859s
	iters: 700, epoch: 8 | loss: 0.8346143
	speed: 0.0049s/iter; left time: 1.3727s
	iters: 800, epoch: 8 | loss: 0.4968702
	speed: 0.0054s/iter; left time: 0.9709s
	iters: 900, epoch: 8 | loss: 0.6706203
	speed: 0.0054s/iter; left time: 0.4316s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.816035270690918
Epoch: 8, Steps: 979 | Train Loss: 0.7070037 Vali Loss: 0.5649002 Best vali loss: 0.5631148

best validation loss 0.5631148118986018

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022460234567, 'e_layers': 3, 'learning_rate': 0.0002238773545, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9800965
	speed: 0.0111s/iter; left time: 85.8831s
	iters: 200, epoch: 1 | loss: 0.7573043
	speed: 0.0054s/iter; left time: 41.0433s
	iters: 300, epoch: 1 | loss: 0.4320915
	speed: 0.0055s/iter; left time: 41.1425s
	iters: 400, epoch: 1 | loss: 0.5118211
	speed: 0.0050s/iter; left time: 37.3321s
	iters: 500, epoch: 1 | loss: 0.4667845
	speed: 0.0048s/iter; left time: 35.3292s
	iters: 600, epoch: 1 | loss: 0.6483815
	speed: 0.0052s/iter; left time: 37.7841s
	iters: 700, epoch: 1 | loss: 1.0094969
	speed: 0.0055s/iter; left time: 39.0035s
	iters: 800, epoch: 1 | loss: 0.8679566
	speed: 0.0054s/iter; left time: 38.3230s
	iters: 900, epoch: 1 | loss: 1.2859333
	speed: 0.0055s/iter; left time: 38.3004s
Updating learning rate to 0.0002238773545
Validation loss decreased (inf --> 0.6117).  Saving model state dict ...
Epoch: 1 cost time: 5.519800186157227
Epoch: 1, Steps: 979 | Train Loss: 0.7733185 Vali Loss: 0.6116612 Best vali loss: 0.6116612
	iters: 100, epoch: 2 | loss: 0.2942203
	speed: 0.0179s/iter; left time: 121.0117s
	iters: 200, epoch: 2 | loss: 0.8916476
	speed: 0.0054s/iter; left time: 35.8407s
	iters: 300, epoch: 2 | loss: 1.2379509
	speed: 0.0057s/iter; left time: 37.6090s
	iters: 400, epoch: 2 | loss: 0.7376523
	speed: 0.0056s/iter; left time: 36.0217s
	iters: 500, epoch: 2 | loss: 0.3319415
	speed: 0.0048s/iter; left time: 30.5734s
	iters: 600, epoch: 2 | loss: 0.3470212
	speed: 0.0048s/iter; left time: 30.1321s
	iters: 700, epoch: 2 | loss: 0.4913883
	speed: 0.0055s/iter; left time: 34.0796s
	iters: 800, epoch: 2 | loss: 0.9163111
	speed: 0.0055s/iter; left time: 33.4603s
	iters: 900, epoch: 2 | loss: 0.3486362
	speed: 0.0057s/iter; left time: 33.9053s
Updating learning rate to 0.00011193867725
Validation loss decreased (0.6117 --> 0.6084).  Saving model state dict ...
Epoch: 2 cost time: 5.355954885482788
Epoch: 2, Steps: 979 | Train Loss: 0.6218633 Vali Loss: 0.6084042 Best vali loss: 0.6084042
	iters: 100, epoch: 3 | loss: 1.3297234
	speed: 0.0177s/iter; left time: 102.3935s
	iters: 200, epoch: 3 | loss: 0.4907743
	speed: 0.0056s/iter; left time: 31.5375s
	iters: 300, epoch: 3 | loss: 0.4286395
	speed: 0.0054s/iter; left time: 30.2145s
	iters: 400, epoch: 3 | loss: 1.0005653
	speed: 0.0055s/iter; left time: 29.9944s
	iters: 500, epoch: 3 | loss: 0.8750463
	speed: 0.0054s/iter; left time: 29.1156s
	iters: 600, epoch: 3 | loss: 0.8841074
	speed: 0.0047s/iter; left time: 24.7557s
	iters: 700, epoch: 3 | loss: 0.7617618
	speed: 0.0047s/iter; left time: 24.5092s
	iters: 800, epoch: 3 | loss: 1.1689613
	speed: 0.0041s/iter; left time: 20.7533s
	iters: 900, epoch: 3 | loss: 0.6354573
	speed: 0.0040s/iter; left time: 19.8079s
Updating learning rate to 5.5969338625e-05
Validation loss decreased (0.6084 --> 0.5500).  Saving model state dict ...
Epoch: 3 cost time: 4.968312501907349
Epoch: 3, Steps: 979 | Train Loss: 0.8416707 Vali Loss: 0.5499589 Best vali loss: 0.5499589

best validation loss 0.5499588762759501

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0053842784557, 'e_layers': 2, 'learning_rate': 0.0021053293838, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0020252000553437097
Validation loss decreased (inf --> 0.6043).  Saving model state dict ...
Epoch: 1 cost time: 0.6644694805145264
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6043337 Best vali loss: 0.6043337
Updating learning rate to 0.0017970110338581377
Validation loss decreased (0.6043 --> 0.6018).  Saving model state dict ...
Epoch: 2 cost time: 0.5179843902587891
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6017873 Best vali loss: 0.6017873
Updating learning rate to 0.0014555020293258317
Epoch: 3 cost time: 0.5685081481933594
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6318289 Best vali loss: 0.6017873

best validation loss 0.6017873366085372

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 4, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8311014
	speed: 0.0168s/iter; left time: 64.1967s
	iters: 200, epoch: 1 | loss: 0.9930032
	speed: 0.0095s/iter; left time: 35.1754s
	iters: 300, epoch: 1 | loss: 1.4950949
	speed: 0.0092s/iter; left time: 33.3064s
	iters: 400, epoch: 1 | loss: 0.7227905
	speed: 0.0102s/iter; left time: 35.9474s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.6085).  Saving model state dict ...
Epoch: 1 cost time: 5.18385648727417
Epoch: 1, Steps: 490 | Train Loss: 1.0104975 Vali Loss: 0.6084697 Best vali loss: 0.6084697
	iters: 100, epoch: 2 | loss: 0.4383776
	speed: 0.0270s/iter; left time: 89.9427s
	iters: 200, epoch: 2 | loss: 0.9531075
	speed: 0.0098s/iter; left time: 31.6047s
	iters: 300, epoch: 2 | loss: 1.0811567
	speed: 0.0090s/iter; left time: 28.2632s
	iters: 400, epoch: 2 | loss: 1.1599085
	speed: 0.0102s/iter; left time: 30.9664s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.6085 --> 0.5853).  Saving model state dict ...
Epoch: 2 cost time: 4.88304591178894
Epoch: 2, Steps: 490 | Train Loss: 0.9081376 Vali Loss: 0.5853489 Best vali loss: 0.5853489
	iters: 100, epoch: 3 | loss: 0.7235637
	speed: 0.0269s/iter; left time: 76.4826s
	iters: 200, epoch: 3 | loss: 0.8542009
	speed: 0.0102s/iter; left time: 28.0549s
	iters: 300, epoch: 3 | loss: 0.6319644
	speed: 0.0083s/iter; left time: 21.9322s
	iters: 400, epoch: 3 | loss: 0.7146820
	speed: 0.0055s/iter; left time: 13.9660s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.5853 --> 0.5650).  Saving model state dict ...
Epoch: 3 cost time: 4.0413432121276855
Epoch: 3, Steps: 490 | Train Loss: 0.7311027 Vali Loss: 0.5649837 Best vali loss: 0.5649837

best validation loss 0.5649837472548037

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022460234567, 'e_layers': 3, 'learning_rate': 0.0002238773545, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9616207
	speed: 0.0117s/iter; left time: 56.0428s
	iters: 200, epoch: 4 | loss: 0.7099704
	speed: 0.0057s/iter; left time: 26.5836s
	iters: 300, epoch: 4 | loss: 0.4376909
	speed: 0.0056s/iter; left time: 25.9068s
	iters: 400, epoch: 4 | loss: 0.5257252
	speed: 0.0058s/iter; left time: 25.8992s
	iters: 500, epoch: 4 | loss: 0.4296242
	speed: 0.0056s/iter; left time: 24.7238s
	iters: 600, epoch: 4 | loss: 0.6100640
	speed: 0.0057s/iter; left time: 24.6537s
	iters: 700, epoch: 4 | loss: 0.9649240
	speed: 0.0054s/iter; left time: 22.4701s
	iters: 800, epoch: 4 | loss: 0.7785522
	speed: 0.0053s/iter; left time: 21.5385s
	iters: 900, epoch: 4 | loss: 1.2549933
	speed: 0.0056s/iter; left time: 22.4140s
Updating learning rate to 2.79846693125e-05
Validation loss decreased (0.5500 --> 0.5462).  Saving model state dict ...
Epoch: 4 cost time: 5.779412269592285
Epoch: 4, Steps: 979 | Train Loss: 0.7414628 Vali Loss: 0.5461748 Best vali loss: 0.5461748
	iters: 100, epoch: 5 | loss: 0.2793913
	speed: 0.0187s/iter; left time: 71.2262s
	iters: 200, epoch: 5 | loss: 0.8373207
	speed: 0.0058s/iter; left time: 21.6906s
	iters: 300, epoch: 5 | loss: 0.6502909
	speed: 0.0059s/iter; left time: 21.1906s
	iters: 400, epoch: 5 | loss: 0.6055998
	speed: 0.0065s/iter; left time: 22.8523s
	iters: 500, epoch: 5 | loss: 0.2677825
	speed: 0.0061s/iter; left time: 20.9090s
	iters: 600, epoch: 5 | loss: 0.2679904
	speed: 0.0059s/iter; left time: 19.6587s
	iters: 700, epoch: 5 | loss: 0.4466225
	speed: 0.0058s/iter; left time: 18.5998s
	iters: 800, epoch: 5 | loss: 0.9433333
	speed: 0.0056s/iter; left time: 17.4128s
	iters: 900, epoch: 5 | loss: 0.3348988
	speed: 0.0054s/iter; left time: 16.2190s
Updating learning rate to 1.399233465625e-05
Validation loss decreased (0.5462 --> 0.5449).  Saving model state dict ...
Epoch: 5 cost time: 5.7820658683776855
Epoch: 5, Steps: 979 | Train Loss: 0.5148034 Vali Loss: 0.5448867 Best vali loss: 0.5448867
	iters: 100, epoch: 6 | loss: 1.2626052
	speed: 0.0182s/iter; left time: 51.7018s
	iters: 200, epoch: 6 | loss: 0.4258103
	speed: 0.0058s/iter; left time: 15.8062s
	iters: 300, epoch: 6 | loss: 0.3775059
	speed: 0.0058s/iter; left time: 15.2065s
	iters: 400, epoch: 6 | loss: 0.9247012
	speed: 0.0058s/iter; left time: 14.5999s
	iters: 500, epoch: 6 | loss: 0.8115457
	speed: 0.0058s/iter; left time: 14.2621s
	iters: 600, epoch: 6 | loss: 0.7977120
	speed: 0.0058s/iter; left time: 13.6542s
	iters: 700, epoch: 6 | loss: 0.6803138
	speed: 0.0059s/iter; left time: 13.1484s
	iters: 800, epoch: 6 | loss: 1.1407604
	speed: 0.0055s/iter; left time: 11.7893s
	iters: 900, epoch: 6 | loss: 0.6265743
	speed: 0.0052s/iter; left time: 10.6414s
Updating learning rate to 6.996167328125e-06
Validation loss decreased (0.5449 --> 0.5403).  Saving model state dict ...
Epoch: 6 cost time: 5.627318620681763
Epoch: 6, Steps: 979 | Train Loss: 0.7830588 Vali Loss: 0.5402855 Best vali loss: 0.5402855
	iters: 100, epoch: 7 | loss: 1.0775341
	speed: 0.0184s/iter; left time: 34.2496s
	iters: 200, epoch: 7 | loss: 0.7010117
	speed: 0.0058s/iter; left time: 10.2636s
	iters: 300, epoch: 7 | loss: 0.9158766
	speed: 0.0058s/iter; left time: 9.5968s
	iters: 400, epoch: 7 | loss: 0.7502201
	speed: 0.0058s/iter; left time: 9.0678s
	iters: 500, epoch: 7 | loss: 0.8092118
	speed: 0.0057s/iter; left time: 8.3067s
	iters: 600, epoch: 7 | loss: 0.6748704
	speed: 0.0054s/iter; left time: 7.2751s
	iters: 700, epoch: 7 | loss: 0.5267227
	speed: 0.0054s/iter; left time: 6.7704s
	iters: 800, epoch: 7 | loss: 0.3119232
	speed: 0.0054s/iter; left time: 6.3098s
	iters: 900, epoch: 7 | loss: 0.3651137
	speed: 0.0053s/iter; left time: 5.6215s
Updating learning rate to 3.4980836640625e-06
Validation loss decreased (0.5403 --> 0.5401).  Saving model state dict ...
Epoch: 7 cost time: 5.493952989578247
Epoch: 7, Steps: 979 | Train Loss: 0.6813871 Vali Loss: 0.5401400 Best vali loss: 0.5401400
	iters: 100, epoch: 8 | loss: 0.8057674
	speed: 0.0179s/iter; left time: 15.7366s
	iters: 200, epoch: 8 | loss: 0.5894894
	speed: 0.0059s/iter; left time: 4.6106s
	iters: 300, epoch: 8 | loss: 0.9297549
	speed: 0.0060s/iter; left time: 4.0848s
	iters: 400, epoch: 8 | loss: 0.8660147
	speed: 0.0062s/iter; left time: 3.5690s
	iters: 500, epoch: 8 | loss: 0.4197543
	speed: 0.0061s/iter; left time: 2.9472s
	iters: 600, epoch: 8 | loss: 1.2588457
	speed: 0.0061s/iter; left time: 2.3213s
	iters: 700, epoch: 8 | loss: 1.1551805
	speed: 0.0062s/iter; left time: 1.7234s
	iters: 800, epoch: 8 | loss: 0.6990105
	speed: 0.0060s/iter; left time: 1.0830s
	iters: 900, epoch: 8 | loss: 0.8291607
	speed: 0.0063s/iter; left time: 0.5073s
Updating learning rate to 1.74904183203125e-06
Validation loss decreased (0.5401 --> 0.5399).  Saving model state dict ...
Epoch: 8 cost time: 5.924472808837891
Epoch: 8, Steps: 979 | Train Loss: 0.8392198 Vali Loss: 0.5399323 Best vali loss: 0.5399323

best validation loss 0.5399322708355835

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0039198070782, 'e_layers': 3, 'learning_rate': 9.36341394e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7961338
	speed: 0.0132s/iter; left time: 11.6999s
Updating learning rate to 9.007040216798432e-05
Validation loss decreased (inf --> 0.6826).  Saving model state dict ...
Epoch: 1 cost time: 1.1982951164245605
Epoch: 1, Steps: 123 | Train Loss: 0.7961338 Vali Loss: 0.6826146 Best vali loss: 0.6826146
	iters: 100, epoch: 2 | loss: 1.1359571
	speed: 0.0118s/iter; left time: 8.9644s
Updating learning rate to 7.992173716015324e-05
Validation loss decreased (0.6826 --> 0.6554).  Saving model state dict ...
Epoch: 2 cost time: 0.9273102283477783
Epoch: 2, Steps: 123 | Train Loss: 1.1359571 Vali Loss: 0.6553524 Best vali loss: 0.6553524
	iters: 100, epoch: 3 | loss: 0.6654429
	speed: 0.0116s/iter; left time: 7.4234s
Updating learning rate to 6.473318662607164e-05
Validation loss decreased (0.6554 --> 0.6427).  Saving model state dict ...
Epoch: 3 cost time: 0.929405927658081
Epoch: 3, Steps: 123 | Train Loss: 0.6654429 Vali Loss: 0.6427182 Best vali loss: 0.6427182
	iters: 100, epoch: 4 | loss: 0.7386652
	speed: 0.0117s/iter; left time: 6.0613s
Updating learning rate to 4.68170697e-05
Validation loss decreased (0.6427 --> 0.6341).  Saving model state dict ...
Epoch: 4 cost time: 0.9498839378356934
Epoch: 4, Steps: 123 | Train Loss: 0.7386652 Vali Loss: 0.6340587 Best vali loss: 0.6340587
	iters: 100, epoch: 5 | loss: 1.2263798
	speed: 0.0118s/iter; left time: 4.6434s
Updating learning rate to 2.8900952773928358e-05
Validation loss decreased (0.6341 --> 0.6293).  Saving model state dict ...
Epoch: 5 cost time: 0.9220890998840332
Epoch: 5, Steps: 123 | Train Loss: 1.2263798 Vali Loss: 0.6292877 Best vali loss: 0.6292877
	iters: 100, epoch: 6 | loss: 0.9762234
	speed: 0.0117s/iter; left time: 3.1721s
Updating learning rate to 1.3712402239846759e-05
Validation loss decreased (0.6293 --> 0.6264).  Saving model state dict ...
Epoch: 6 cost time: 0.9717593193054199
Epoch: 6, Steps: 123 | Train Loss: 0.9762234 Vali Loss: 0.6264489 Best vali loss: 0.6264489
	iters: 100, epoch: 7 | loss: 0.8733382
	speed: 0.0118s/iter; left time: 1.7414s
Updating learning rate to 3.5637372320156725e-06
Validation loss decreased (0.6264 --> 0.6259).  Saving model state dict ...
Epoch: 7 cost time: 0.938657283782959
Epoch: 7, Steps: 123 | Train Loss: 0.8733382 Vali Loss: 0.6258846 Best vali loss: 0.6258846
	iters: 100, epoch: 8 | loss: 0.8824112
	speed: 0.0116s/iter; left time: 0.2785s
Updating learning rate to 0.0
Validation loss decreased (0.6259 --> 0.6258).  Saving model state dict ...
Epoch: 8 cost time: 0.9005186557769775
Epoch: 8, Steps: 123 | Train Loss: 0.8824112 Vali Loss: 0.6258222 Best vali loss: 0.6258222

best validation loss 0.6258221909934754

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.007940080013, 'e_layers': 4, 'learning_rate': 0.0005392900295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5040696
	speed: 0.0132s/iter; left time: 24.5737s
	iters: 200, epoch: 1 | loss: 1.0248811
	speed: 0.0075s/iter; left time: 13.2022s
Updating learning rate to 0.000518764524921229
Validation loss decreased (inf --> 0.6221).  Saving model state dict ...
Epoch: 1 cost time: 2.1345489025115967
Epoch: 1, Steps: 245 | Train Loss: 0.7644754 Vali Loss: 0.6221151 Best vali loss: 0.6221151
	iters: 100, epoch: 2 | loss: 1.0887665
	speed: 0.0144s/iter; left time: 23.2039s
	iters: 200, epoch: 2 | loss: 0.7042484
	speed: 0.0076s/iter; left time: 11.4554s
Updating learning rate to 0.0004603128331928716
Validation loss decreased (0.6221 --> 0.6206).  Saving model state dict ...
Epoch: 2 cost time: 1.8995263576507568
Epoch: 2, Steps: 245 | Train Loss: 0.8965074 Vali Loss: 0.6206188 Best vali loss: 0.6206188
	iters: 100, epoch: 3 | loss: 0.6831721
	speed: 0.0147s/iter; left time: 20.1617s
	iters: 200, epoch: 3 | loss: 0.7133320
	speed: 0.0076s/iter; left time: 9.7219s
Updating learning rate to 0.0003728336945146653
Epoch: 3 cost time: 1.9004206657409668
Epoch: 3, Steps: 245 | Train Loss: 0.6982521 Vali Loss: 0.6232503 Best vali loss: 0.6206188
	iters: 100, epoch: 4 | loss: 0.9237421
	speed: 0.0151s/iter; left time: 17.0525s
	iters: 200, epoch: 4 | loss: 0.6961773
	speed: 0.0076s/iter; left time: 7.7472s
Updating learning rate to 0.00026964501475
Validation loss decreased (0.6206 --> 0.6151).  Saving model state dict ...
Epoch: 4 cost time: 1.8725981712341309
Epoch: 4, Steps: 245 | Train Loss: 0.8099597 Vali Loss: 0.6150575 Best vali loss: 0.6150575
	iters: 100, epoch: 5 | loss: 0.8110390
	speed: 0.0148s/iter; left time: 13.0679s
	iters: 200, epoch: 5 | loss: 0.8511132
	speed: 0.0075s/iter; left time: 5.8532s
Updating learning rate to 0.00016645633498533474
Epoch: 5 cost time: 1.8960809707641602
Epoch: 5, Steps: 245 | Train Loss: 0.8310761 Vali Loss: 0.6211950 Best vali loss: 0.6150575
	iters: 100, epoch: 6 | loss: 0.7125608
	speed: 0.0148s/iter; left time: 9.3935s
	iters: 200, epoch: 6 | loss: 1.0635175
	speed: 0.0076s/iter; left time: 4.0504s
Updating learning rate to 7.897719630712839e-05
Epoch: 6 cost time: 1.893035650253296
Epoch: 6, Steps: 245 | Train Loss: 0.8880391 Vali Loss: 0.6230876 Best vali loss: 0.6150575
	iters: 100, epoch: 7 | loss: 0.7398782
	speed: 0.0145s/iter; left time: 5.6888s
	iters: 200, epoch: 7 | loss: 0.6865613
	speed: 0.0072s/iter; left time: 2.0978s
Updating learning rate to 2.0525504578770982e-05
Epoch: 7 cost time: 1.8616130352020264
Epoch: 7, Steps: 245 | Train Loss: 0.7132198 Vali Loss: 0.6223994 Best vali loss: 0.6150575
	iters: 100, epoch: 8 | loss: 0.8188084
	speed: 0.0147s/iter; left time: 2.1457s
	iters: 200, epoch: 8 | loss: 0.7181499
	speed: 0.0076s/iter; left time: 0.3516s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9300892353057861
Epoch: 8, Steps: 245 | Train Loss: 0.7684792 Vali Loss: 0.6228969 Best vali loss: 0.6150575

best validation loss 0.6150574718620533

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008999589749, 'e_layers': 3, 'learning_rate': 9.85480766e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6745725
	speed: 0.0106s/iter; left time: 82.2343s
	iters: 200, epoch: 1 | loss: 0.8921513
	speed: 0.0058s/iter; left time: 44.4419s
	iters: 300, epoch: 1 | loss: 0.7637416
	speed: 0.0059s/iter; left time: 44.7932s
	iters: 400, epoch: 1 | loss: 1.7975299
	speed: 0.0060s/iter; left time: 44.6774s
	iters: 500, epoch: 1 | loss: 0.3836627
	speed: 0.0061s/iter; left time: 44.8998s
	iters: 600, epoch: 1 | loss: 0.6494169
	speed: 0.0061s/iter; left time: 44.0795s
	iters: 700, epoch: 1 | loss: 0.2852017
	speed: 0.0061s/iter; left time: 43.4464s
	iters: 800, epoch: 1 | loss: 0.4782030
	speed: 0.0061s/iter; left time: 43.2015s
	iters: 900, epoch: 1 | loss: 1.0140172
	speed: 0.0061s/iter; left time: 42.6334s
Updating learning rate to 9.479731376954724e-05
Validation loss decreased (inf --> 0.6014).  Saving model state dict ...
Epoch: 1 cost time: 6.099332571029663
Epoch: 1, Steps: 979 | Train Loss: 0.7709441 Vali Loss: 0.6013914 Best vali loss: 0.6013914
	iters: 100, epoch: 2 | loss: 1.1553850
	speed: 0.0185s/iter; left time: 125.2660s
	iters: 200, epoch: 2 | loss: 0.4364285
	speed: 0.0051s/iter; left time: 34.1661s
	iters: 300, epoch: 2 | loss: 1.6379710
	speed: 0.0060s/iter; left time: 39.2240s
	iters: 400, epoch: 2 | loss: 0.9200045
	speed: 0.0059s/iter; left time: 38.3663s
	iters: 500, epoch: 2 | loss: 0.3235683
	speed: 0.0060s/iter; left time: 38.0382s
	iters: 600, epoch: 2 | loss: 0.6781591
	speed: 0.0061s/iter; left time: 37.9740s
	iters: 700, epoch: 2 | loss: 0.6607569
	speed: 0.0061s/iter; left time: 37.7093s
	iters: 800, epoch: 2 | loss: 0.5846115
	speed: 0.0061s/iter; left time: 36.9212s
	iters: 900, epoch: 2 | loss: 0.3448365
	speed: 0.0061s/iter; left time: 36.3102s
Updating learning rate to 8.411604491837567e-05
Epoch: 2 cost time: 5.792141437530518
Epoch: 2, Steps: 979 | Train Loss: 0.7490802 Vali Loss: 0.6433511 Best vali loss: 0.6013914
	iters: 100, epoch: 3 | loss: 1.0036662
	speed: 0.0193s/iter; left time: 111.2168s
	iters: 200, epoch: 3 | loss: 1.5527414
	speed: 0.0053s/iter; left time: 30.2045s
	iters: 300, epoch: 3 | loss: 0.3496968
	speed: 0.0054s/iter; left time: 29.8906s
	iters: 400, epoch: 3 | loss: 1.1642382
	speed: 0.0061s/iter; left time: 33.3243s
	iters: 500, epoch: 3 | loss: 0.6321279
	speed: 0.0061s/iter; left time: 32.5908s
	iters: 600, epoch: 3 | loss: 0.2238306
	speed: 0.0061s/iter; left time: 32.1290s
	iters: 700, epoch: 3 | loss: 0.9359939
	speed: 0.0061s/iter; left time: 31.4489s
	iters: 800, epoch: 3 | loss: 0.3254848
	speed: 0.0061s/iter; left time: 30.7375s
	iters: 900, epoch: 3 | loss: 0.4235145
	speed: 0.0061s/iter; left time: 30.1678s
Updating learning rate to 6.81303964031329e-05
Validation loss decreased (0.6014 --> 0.5588).  Saving model state dict ...
Epoch: 3 cost time: 5.828246355056763
Epoch: 3, Steps: 979 | Train Loss: 0.7345882 Vali Loss: 0.5588245 Best vali loss: 0.5588245

best validation loss 0.5588244707743805

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012653404301, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2323669
	speed: 0.0121s/iter; left time: 22.4701s
	iters: 200, epoch: 1 | loss: 1.0682528
	speed: 0.0055s/iter; left time: 9.6155s
Updating learning rate to 0.0005385115939239891
Validation loss decreased (inf --> 0.6568).  Saving model state dict ...
Epoch: 1 cost time: 1.7332727909088135
Epoch: 1, Steps: 245 | Train Loss: 1.1503099 Vali Loss: 0.6568167 Best vali loss: 0.6568167
	iters: 100, epoch: 2 | loss: 0.6742457
	speed: 0.0138s/iter; left time: 22.2572s
	iters: 200, epoch: 2 | loss: 0.9375876
	speed: 0.0080s/iter; left time: 12.1148s
Updating learning rate to 0.0004778349050448276
Validation loss decreased (0.6568 --> 0.6005).  Saving model state dict ...
Epoch: 2 cost time: 2.0068981647491455
Epoch: 2, Steps: 245 | Train Loss: 0.8059167 Vali Loss: 0.6004514 Best vali loss: 0.6004514
	iters: 100, epoch: 3 | loss: 0.6492946
	speed: 0.0156s/iter; left time: 21.4474s
	iters: 200, epoch: 3 | loss: 0.6281328
	speed: 0.0079s/iter; left time: 10.0482s
Updating learning rate to 0.0003870258228088137
Validation loss decreased (0.6005 --> 0.5568).  Saving model state dict ...
Epoch: 3 cost time: 1.9571466445922852
Epoch: 3, Steps: 245 | Train Loss: 0.6387137 Vali Loss: 0.5568212 Best vali loss: 0.5568212

best validation loss 0.5568211956026377

[INFO][smbo.py:320] Finished 200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004792616286, 'e_layers': 2, 'learning_rate': 0.0015570047911, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0407976
	speed: 0.0133s/iter; left time: 11.7725s
Updating learning rate to 0.0014977448248096508
Validation loss decreased (inf --> 0.6169).  Saving model state dict ...
Epoch: 1 cost time: 1.2149512767791748
Epoch: 1, Steps: 123 | Train Loss: 1.0407976 Vali Loss: 0.6169147 Best vali loss: 0.6169147
	iters: 100, epoch: 2 | loss: 0.9655769
	speed: 0.0093s/iter; left time: 7.0977s
Updating learning rate to 0.0013289867186133768
Epoch: 2 cost time: 0.6467916965484619
Epoch: 2, Steps: 123 | Train Loss: 0.9655769 Vali Loss: 0.6298867 Best vali loss: 0.6169147
	iters: 100, epoch: 3 | loss: 1.0160837
	speed: 0.0111s/iter; left time: 7.0643s
Updating learning rate to 0.0010764223643835189
Validation loss decreased (0.6169 --> 0.6142).  Saving model state dict ...
Epoch: 3 cost time: 0.9948341846466064
Epoch: 3, Steps: 123 | Train Loss: 1.0160837 Vali Loss: 0.6142055 Best vali loss: 0.6142055

best validation loss 0.6142054898823813

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012653404301, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.2234651
	speed: 0.0142s/iter; left time: 16.0408s
	iters: 200, epoch: 4 | loss: 0.9034694
	speed: 0.0061s/iter; left time: 6.2891s
Updating learning rate to 0.0002799092068
Epoch: 4 cost time: 1.9953265190124512
Epoch: 4, Steps: 245 | Train Loss: 1.0634673 Vali Loss: 0.6110939 Best vali loss: 0.5568212
	iters: 100, epoch: 5 | loss: 0.6382271
	speed: 0.0128s/iter; left time: 11.2654s
	iters: 200, epoch: 5 | loss: 0.5814712
	speed: 0.0072s/iter; left time: 5.6102s
Updating learning rate to 0.00017279259079118627
Validation loss decreased (0.5568 --> 0.5447).  Saving model state dict ...
Epoch: 5 cost time: 1.8022267818450928
Epoch: 5, Steps: 245 | Train Loss: 0.6098492 Vali Loss: 0.5446744 Best vali loss: 0.5446744
	iters: 100, epoch: 6 | loss: 0.6165377
	speed: 0.0143s/iter; left time: 9.0962s
	iters: 200, epoch: 6 | loss: 0.5353960
	speed: 0.0075s/iter; left time: 4.0005s
Updating learning rate to 8.198350855517233e-05
Validation loss decreased (0.5447 --> 0.5435).  Saving model state dict ...
Epoch: 6 cost time: 1.860583782196045
Epoch: 6, Steps: 245 | Train Loss: 0.5759669 Vali Loss: 0.5435374 Best vali loss: 0.5435374
	iters: 100, epoch: 7 | loss: 0.9660746
	speed: 0.0135s/iter; left time: 5.2615s
	iters: 200, epoch: 7 | loss: 0.4279390
	speed: 0.0071s/iter; left time: 2.0789s
Updating learning rate to 2.1306819676010916e-05
Validation loss decreased (0.5435 --> 0.5432).  Saving model state dict ...
Epoch: 7 cost time: 1.7880418300628662
Epoch: 7, Steps: 245 | Train Loss: 0.6970068 Vali Loss: 0.5432464 Best vali loss: 0.5432464
	iters: 100, epoch: 8 | loss: 0.9746357
	speed: 0.0127s/iter; left time: 1.8570s
	iters: 200, epoch: 8 | loss: 0.6526954
	speed: 0.0072s/iter; left time: 0.3292s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7194182872772217
Epoch: 8, Steps: 245 | Train Loss: 0.8136656 Vali Loss: 0.5439053 Best vali loss: 0.5432464

best validation loss 0.543246365266506

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094422831379, 'e_layers': 4, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 0.8465917110443115
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6111795 Best vali loss: 0.6111795
Updating learning rate to 0.0009137180420535848
Validation loss decreased (0.6112 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.5963630676269531
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5994600 Best vali loss: 0.5994600
Updating learning rate to 0.0007400725089513316
Validation loss decreased (0.5995 --> 0.5910).  Saving model state dict ...
Epoch: 3 cost time: 0.5870773792266846
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5910370 Best vali loss: 0.5910370
Updating learning rate to 0.00053524363685
Validation loss decreased (0.5910 --> 0.5890).  Saving model state dict ...
Epoch: 4 cost time: 0.5474071502685547
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5889950 Best vali loss: 0.5889950
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 0.5889849662780762
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5935864 Best vali loss: 0.5889950
Updating learning rate to 0.00015676923164641517
Validation loss decreased (0.5890 --> 0.5785).  Saving model state dict ...
Epoch: 6 cost time: 0.6130456924438477
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5784736 Best vali loss: 0.5784736
Updating learning rate to 4.0742995857381066e-05
Validation loss decreased (0.5785 --> 0.5773).  Saving model state dict ...
Epoch: 7 cost time: 0.6008696556091309
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5773495 Best vali loss: 0.5773495
Updating learning rate to 0.0
Validation loss decreased (0.5773 --> 0.5742).  Saving model state dict ...
Epoch: 8 cost time: 0.610060453414917
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5742282 Best vali loss: 0.5742282

best validation loss 0.5742281729123594

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009319745802, 'e_layers': 4, 'learning_rate': 0.0004945924346, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8431100
	speed: 0.0129s/iter; left time: 11.4466s
Updating learning rate to 0.0004945924346
Validation loss decreased (inf --> 0.6091).  Saving model state dict ...
Epoch: 1 cost time: 1.2011082172393799
Epoch: 1, Steps: 123 | Train Loss: 0.8431100 Vali Loss: 0.6091258 Best vali loss: 0.6091258
	iters: 100, epoch: 2 | loss: 1.0701660
	speed: 0.0120s/iter; left time: 9.1712s
Updating learning rate to 0.0002472962173
Validation loss decreased (0.6091 --> 0.6050).  Saving model state dict ...
Epoch: 2 cost time: 1.0493474006652832
Epoch: 2, Steps: 123 | Train Loss: 1.0701660 Vali Loss: 0.6049908 Best vali loss: 0.6049908
	iters: 100, epoch: 3 | loss: 0.9258923
	speed: 0.0123s/iter; left time: 7.8331s
Updating learning rate to 0.00012364810865
Epoch: 3 cost time: 1.0120940208435059
Epoch: 3, Steps: 123 | Train Loss: 0.9258923 Vali Loss: 0.6083993 Best vali loss: 0.6049908
	iters: 100, epoch: 4 | loss: 0.9810165
	speed: 0.0117s/iter; left time: 6.0586s
Updating learning rate to 6.1824054325e-05
Epoch: 4 cost time: 0.9703006744384766
Epoch: 4, Steps: 123 | Train Loss: 0.9810165 Vali Loss: 0.6085357 Best vali loss: 0.6049908
	iters: 100, epoch: 5 | loss: 0.6755427
	speed: 0.0118s/iter; left time: 4.6238s
Updating learning rate to 3.09120271625e-05
Validation loss decreased (0.6050 --> 0.6030).  Saving model state dict ...
Epoch: 5 cost time: 0.9785852432250977
Epoch: 5, Steps: 123 | Train Loss: 0.6755427 Vali Loss: 0.6030362 Best vali loss: 0.6030362
	iters: 100, epoch: 6 | loss: 0.7088507
	speed: 0.0115s/iter; left time: 3.1173s
Updating learning rate to 1.545601358125e-05
Validation loss decreased (0.6030 --> 0.6026).  Saving model state dict ...
Epoch: 6 cost time: 0.9760231971740723
Epoch: 6, Steps: 123 | Train Loss: 0.7088507 Vali Loss: 0.6025906 Best vali loss: 0.6025906
	iters: 100, epoch: 7 | loss: 0.7976328
	speed: 0.0115s/iter; left time: 1.6866s
Updating learning rate to 7.728006790625e-06
Validation loss decreased (0.6026 --> 0.6011).  Saving model state dict ...
Epoch: 7 cost time: 0.9611043930053711
Epoch: 7, Steps: 123 | Train Loss: 0.7976328 Vali Loss: 0.6011498 Best vali loss: 0.6011498
	iters: 100, epoch: 8 | loss: 0.8729067
	speed: 0.0116s/iter; left time: 0.2780s
Updating learning rate to 3.8640033953125e-06
Epoch: 8 cost time: 0.9967212677001953
Epoch: 8, Steps: 123 | Train Loss: 0.8729067 Vali Loss: 0.6034692 Best vali loss: 0.6011498

best validation loss 0.6011497729743647

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0001198
	speed: 0.0118s/iter; left time: 10.4492s
Updating learning rate to 9.547589994094374e-05
Validation loss decreased (inf --> 0.6016).  Saving model state dict ...
Epoch: 1 cost time: 1.0632574558258057
Epoch: 1, Steps: 123 | Train Loss: 1.0001198 Vali Loss: 0.6016353 Best vali loss: 0.6016353
	iters: 100, epoch: 2 | loss: 0.8967121
	speed: 0.0103s/iter; left time: 7.8787s
Updating learning rate to 8.47181715251795e-05
Validation loss decreased (0.6016 --> 0.5947).  Saving model state dict ...
Epoch: 2 cost time: 0.8212888240814209
Epoch: 2, Steps: 123 | Train Loss: 0.8967121 Vali Loss: 0.5946688 Best vali loss: 0.5946688
	iters: 100, epoch: 3 | loss: 0.8706547
	speed: 0.0105s/iter; left time: 6.6843s
Updating learning rate to 6.861809318495647e-05
Validation loss decreased (0.5947 --> 0.5522).  Saving model state dict ...
Epoch: 3 cost time: 0.8296711444854736
Epoch: 3, Steps: 123 | Train Loss: 0.8706547 Vali Loss: 0.5522495 Best vali loss: 0.5522495

best validation loss 0.5522495061641819

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0004262443426, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8651880
	speed: 0.0100s/iter; left time: 8.8075s
Updating learning rate to 0.0004262443426
Validation loss decreased (inf --> 0.6421).  Saving model state dict ...
Epoch: 1 cost time: 0.8017325401306152
Epoch: 1, Steps: 123 | Train Loss: 0.8651880 Vali Loss: 0.6421435 Best vali loss: 0.6421435
	iters: 100, epoch: 2 | loss: 0.8861206
	speed: 0.0068s/iter; left time: 5.1711s
Updating learning rate to 0.0002131221713
Validation loss decreased (0.6421 --> 0.6169).  Saving model state dict ...
Epoch: 2 cost time: 0.5031161308288574
Epoch: 2, Steps: 123 | Train Loss: 0.8861206 Vali Loss: 0.6168637 Best vali loss: 0.6168637
	iters: 100, epoch: 3 | loss: 0.9190893
	speed: 0.0068s/iter; left time: 4.3587s
Updating learning rate to 0.00010656108565
Validation loss decreased (0.6169 --> 0.6101).  Saving model state dict ...
Epoch: 3 cost time: 0.502967119216919
Epoch: 3, Steps: 123 | Train Loss: 0.9190893 Vali Loss: 0.6100746 Best vali loss: 0.6100746

best validation loss 0.6100746129244249

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0111145234284, 'e_layers': 2, 'learning_rate': 0.0023180376832, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9526389
	speed: 0.0129s/iter; left time: 11.3990s
Updating learning rate to 0.0023180376832
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.1697673797607422
Epoch: 1, Steps: 123 | Train Loss: 0.9526389 Vali Loss: 0.6174079 Best vali loss: 0.6174079
	iters: 100, epoch: 2 | loss: 1.0684533
	speed: 0.0112s/iter; left time: 8.5610s
Updating learning rate to 0.0011590188416
Epoch: 2 cost time: 0.9367928504943848
Epoch: 2, Steps: 123 | Train Loss: 1.0684533 Vali Loss: 0.6470912 Best vali loss: 0.6174079
	iters: 100, epoch: 3 | loss: 0.6922835
	speed: 0.0118s/iter; left time: 7.5224s
Updating learning rate to 0.0005795094208
Epoch: 3 cost time: 0.9232072830200195
Epoch: 3, Steps: 123 | Train Loss: 0.6922835 Vali Loss: 0.6349095 Best vali loss: 0.6174079

best validation loss 0.617407853793127

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9033486
	speed: 0.0133s/iter; left time: 6.8394s
Updating learning rate to 4.96267559e-05
Epoch: 4 cost time: 1.1990444660186768
Epoch: 4, Steps: 123 | Train Loss: 0.9033486 Vali Loss: 0.5557001 Best vali loss: 0.5522495
	iters: 100, epoch: 5 | loss: 0.7920252
	speed: 0.0091s/iter; left time: 3.5705s
Updating learning rate to 3.063541861504353e-05
Epoch: 5 cost time: 0.6294102668762207
Epoch: 5, Steps: 123 | Train Loss: 0.7920252 Vali Loss: 0.5584338 Best vali loss: 0.5522495
	iters: 100, epoch: 6 | loss: 0.7869726
	speed: 0.0109s/iter; left time: 2.9527s
Updating learning rate to 1.4535340274820496e-05
Validation loss decreased (0.5522 --> 0.5516).  Saving model state dict ...
Epoch: 6 cost time: 0.9702539443969727
Epoch: 6, Steps: 123 | Train Loss: 0.7869726 Vali Loss: 0.5516198 Best vali loss: 0.5516198
	iters: 100, epoch: 7 | loss: 0.7988353
	speed: 0.0121s/iter; left time: 1.7833s
Updating learning rate to 3.777611859056259e-06
Validation loss decreased (0.5516 --> 0.5478).  Saving model state dict ...
Epoch: 7 cost time: 0.966759443283081
Epoch: 7, Steps: 123 | Train Loss: 0.7988353 Vali Loss: 0.5478061 Best vali loss: 0.5478061
	iters: 100, epoch: 8 | loss: 0.7119977
	speed: 0.0124s/iter; left time: 0.2972s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0003201961517334
Epoch: 8, Steps: 123 | Train Loss: 0.7119977 Vali Loss: 0.5518179 Best vali loss: 0.5478061

best validation loss 0.5478061165372733

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0071897631756, 'e_layers': 1, 'learning_rate': 0.0003622765966, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7430425
	speed: 0.0104s/iter; left time: 19.2892s
	iters: 200, epoch: 1 | loss: 0.7866885
	speed: 0.0041s/iter; left time: 7.1347s
Updating learning rate to 0.0003622765966
Validation loss decreased (inf --> 0.5996).  Saving model state dict ...
Epoch: 1 cost time: 1.3632969856262207
Epoch: 1, Steps: 245 | Train Loss: 0.7648655 Vali Loss: 0.5995633 Best vali loss: 0.5995633
	iters: 100, epoch: 2 | loss: 0.8064955
	speed: 0.0098s/iter; left time: 15.8360s
	iters: 200, epoch: 2 | loss: 1.0258304
	speed: 0.0039s/iter; left time: 5.9652s
Updating learning rate to 0.0001811382983
Epoch: 2 cost time: 1.0815088748931885
Epoch: 2, Steps: 245 | Train Loss: 0.9161630 Vali Loss: 0.6185668 Best vali loss: 0.5995633
	iters: 100, epoch: 3 | loss: 1.1071392
	speed: 0.0096s/iter; left time: 13.1783s
	iters: 200, epoch: 3 | loss: 0.6897895
	speed: 0.0038s/iter; left time: 4.8395s
Updating learning rate to 9.056914915e-05
Epoch: 3 cost time: 1.0626749992370605
Epoch: 3, Steps: 245 | Train Loss: 0.8984644 Vali Loss: 0.6364149 Best vali loss: 0.5995633
	iters: 100, epoch: 4 | loss: 0.7387946
	speed: 0.0097s/iter; left time: 10.8978s
	iters: 200, epoch: 4 | loss: 0.6786918
	speed: 0.0040s/iter; left time: 4.1175s
Updating learning rate to 4.5284574575e-05
Epoch: 4 cost time: 1.0773906707763672
Epoch: 4, Steps: 245 | Train Loss: 0.7087432 Vali Loss: 0.6281904 Best vali loss: 0.5995633
	iters: 100, epoch: 5 | loss: 1.0345429
	speed: 0.0096s/iter; left time: 8.4569s
	iters: 200, epoch: 5 | loss: 0.6708614
	speed: 0.0032s/iter; left time: 2.4701s
Updating learning rate to 2.26422872875e-05
Epoch: 5 cost time: 0.9125058650970459
Epoch: 5, Steps: 245 | Train Loss: 0.8527021 Vali Loss: 0.6331561 Best vali loss: 0.5995633
	iters: 100, epoch: 6 | loss: 0.6584644
	speed: 0.0076s/iter; left time: 4.8234s
	iters: 200, epoch: 6 | loss: 0.5011033
	speed: 0.0053s/iter; left time: 2.8607s
Updating learning rate to 1.132114364375e-05
Epoch: 6 cost time: 1.160949945449829
Epoch: 6, Steps: 245 | Train Loss: 0.5797838 Vali Loss: 0.6346238 Best vali loss: 0.5995633
	iters: 100, epoch: 7 | loss: 0.6516980
	speed: 0.0108s/iter; left time: 4.2376s
	iters: 200, epoch: 7 | loss: 0.5863405
	speed: 0.0044s/iter; left time: 1.2827s
Updating learning rate to 5.660571821875e-06
Epoch: 7 cost time: 1.2678704261779785
Epoch: 7, Steps: 245 | Train Loss: 0.6190192 Vali Loss: 0.6352914 Best vali loss: 0.5995633
	iters: 100, epoch: 8 | loss: 0.3543045
	speed: 0.0106s/iter; left time: 1.5532s
	iters: 200, epoch: 8 | loss: 0.7279486
	speed: 0.0031s/iter; left time: 0.1403s
Updating learning rate to 2.8302859109375e-06
Epoch: 8 cost time: 0.9439499378204346
Epoch: 8, Steps: 245 | Train Loss: 0.5411265 Vali Loss: 0.6345670 Best vali loss: 0.5995633

best validation loss 0.5995632871220036

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 1, 'learning_rate': 0.0015843837106, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7568007
	speed: 0.0104s/iter; left time: 19.3230s
	iters: 200, epoch: 1 | loss: 0.6879564
	speed: 0.0043s/iter; left time: 7.5893s
Updating learning rate to 0.001524081696233813
Validation loss decreased (inf --> 0.6240).  Saving model state dict ...
Epoch: 1 cost time: 1.3884246349334717
Epoch: 1, Steps: 245 | Train Loss: 0.7223786 Vali Loss: 0.6239914 Best vali loss: 0.6239914
	iters: 100, epoch: 2 | loss: 0.6238620
	speed: 0.0102s/iter; left time: 16.4154s
	iters: 200, epoch: 2 | loss: 0.7230327
	speed: 0.0031s/iter; left time: 4.7506s
Updating learning rate to 0.0013523560881833821
Validation loss decreased (0.6240 --> 0.6211).  Saving model state dict ...
Epoch: 2 cost time: 0.9265933036804199
Epoch: 2, Steps: 245 | Train Loss: 0.6734473 Vali Loss: 0.6211221 Best vali loss: 0.6211221
	iters: 100, epoch: 3 | loss: 0.8526560
	speed: 0.0069s/iter; left time: 9.3965s
	iters: 200, epoch: 3 | loss: 0.7703694
	speed: 0.0046s/iter; left time: 5.8530s
Updating learning rate to 0.0010953505535778727
Epoch: 3 cost time: 1.0514640808105469
Epoch: 3, Steps: 245 | Train Loss: 0.8115127 Vali Loss: 0.6251422 Best vali loss: 0.6211221
	iters: 100, epoch: 4 | loss: 0.5794675
	speed: 0.0106s/iter; left time: 11.9380s
	iters: 200, epoch: 4 | loss: 0.6202435
	speed: 0.0042s/iter; left time: 4.2811s
Updating learning rate to 0.0007921918553
Epoch: 4 cost time: 1.15968918800354
Epoch: 4, Steps: 245 | Train Loss: 0.5998555 Vali Loss: 0.6569541 Best vali loss: 0.6211221
	iters: 100, epoch: 5 | loss: 0.5126547
	speed: 0.0104s/iter; left time: 9.1415s
	iters: 200, epoch: 5 | loss: 0.8511108
	speed: 0.0039s/iter; left time: 3.0400s
Updating learning rate to 0.0004890331570221276
Epoch: 5 cost time: 1.0154049396514893
Epoch: 5, Steps: 245 | Train Loss: 0.6818827 Vali Loss: 0.6914263 Best vali loss: 0.6211221
	iters: 100, epoch: 6 | loss: 0.9372218
	speed: 0.0067s/iter; left time: 4.2559s
	iters: 200, epoch: 6 | loss: 0.8678126
	speed: 0.0051s/iter; left time: 2.7150s
Updating learning rate to 0.00023202762241661783
Epoch: 6 cost time: 1.0907795429229736
Epoch: 6, Steps: 245 | Train Loss: 0.9025172 Vali Loss: 0.6964677 Best vali loss: 0.6211221
	iters: 100, epoch: 7 | loss: 0.5101838
	speed: 0.0110s/iter; left time: 4.3187s
	iters: 200, epoch: 7 | loss: 0.4685562
	speed: 0.0050s/iter; left time: 1.4410s
Updating learning rate to 6.030201436618709e-05
Epoch: 7 cost time: 1.2657709121704102
Epoch: 7, Steps: 245 | Train Loss: 0.4893700 Vali Loss: 0.6987934 Best vali loss: 0.6211221
	iters: 100, epoch: 8 | loss: 0.6808847
	speed: 0.0109s/iter; left time: 1.5987s
	iters: 200, epoch: 8 | loss: 0.7501341
	speed: 0.0046s/iter; left time: 0.2109s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2573940753936768
Epoch: 8, Steps: 245 | Train Loss: 0.7155094 Vali Loss: 0.6924654 Best vali loss: 0.6211221

best validation loss 0.6211221347192767

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7227067
	speed: 0.0096s/iter; left time: 74.0520s
	iters: 200, epoch: 1 | loss: 1.2526046
	speed: 0.0053s/iter; left time: 40.3612s
	iters: 300, epoch: 1 | loss: 0.9489614
	speed: 0.0048s/iter; left time: 36.3995s
	iters: 400, epoch: 1 | loss: 1.5568497
	speed: 0.0050s/iter; left time: 37.2417s
	iters: 500, epoch: 1 | loss: 1.3838987
	speed: 0.0049s/iter; left time: 35.6418s
	iters: 600, epoch: 1 | loss: 0.6551098
	speed: 0.0048s/iter; left time: 34.8281s
	iters: 700, epoch: 1 | loss: 1.3523769
	speed: 0.0045s/iter; left time: 32.3649s
	iters: 800, epoch: 1 | loss: 0.9369697
	speed: 0.0049s/iter; left time: 34.6563s
	iters: 900, epoch: 1 | loss: 1.5885727
	speed: 0.0047s/iter; left time: 32.5458s
Updating learning rate to 0.0003784163294
Validation loss decreased (inf --> 0.5992).  Saving model state dict ...
Epoch: 1 cost time: 4.981202840805054
Epoch: 1, Steps: 979 | Train Loss: 1.1553389 Vali Loss: 0.5991629 Best vali loss: 0.5991629
	iters: 100, epoch: 2 | loss: 0.6730695
	speed: 0.0176s/iter; left time: 118.9275s
	iters: 200, epoch: 2 | loss: 0.3853798
	speed: 0.0050s/iter; left time: 33.4920s
	iters: 300, epoch: 2 | loss: 0.8552911
	speed: 0.0043s/iter; left time: 28.4180s
	iters: 400, epoch: 2 | loss: 1.5646951
	speed: 0.0047s/iter; left time: 30.0672s
	iters: 500, epoch: 2 | loss: 0.6079596
	speed: 0.0046s/iter; left time: 29.4065s
	iters: 600, epoch: 2 | loss: 0.6133068
	speed: 0.0044s/iter; left time: 27.4510s
	iters: 700, epoch: 2 | loss: 0.6942583
	speed: 0.0042s/iter; left time: 25.8882s
	iters: 800, epoch: 2 | loss: 0.7800035
	speed: 0.0047s/iter; left time: 28.4759s
	iters: 900, epoch: 2 | loss: 1.1935824
	speed: 0.0046s/iter; left time: 27.1607s
Updating learning rate to 0.0001892081647
Epoch: 2 cost time: 4.4773595333099365
Epoch: 2, Steps: 979 | Train Loss: 0.8186162 Vali Loss: 0.6008165 Best vali loss: 0.5991629
	iters: 100, epoch: 3 | loss: 1.0258651
	speed: 0.0165s/iter; left time: 95.1669s
	iters: 200, epoch: 3 | loss: 0.4990337
	speed: 0.0039s/iter; left time: 21.9827s
	iters: 300, epoch: 3 | loss: 0.6191122
	speed: 0.0032s/iter; left time: 17.8718s
	iters: 400, epoch: 3 | loss: 1.0691980
	speed: 0.0033s/iter; left time: 18.2342s
	iters: 500, epoch: 3 | loss: 0.9456285
	speed: 0.0044s/iter; left time: 23.8689s
	iters: 600, epoch: 3 | loss: 1.1148127
	speed: 0.0044s/iter; left time: 23.2355s
	iters: 700, epoch: 3 | loss: 0.5994833
	speed: 0.0046s/iter; left time: 23.6003s
	iters: 800, epoch: 3 | loss: 0.3554291
	speed: 0.0048s/iter; left time: 24.2704s
	iters: 900, epoch: 3 | loss: 0.9500878
	speed: 0.0044s/iter; left time: 21.8421s
Updating learning rate to 9.460408235e-05
Epoch: 3 cost time: 4.176226377487183
Epoch: 3, Steps: 979 | Train Loss: 0.7976278 Vali Loss: 0.6102741 Best vali loss: 0.5991629

best validation loss 0.5991628841496573

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020904164085, 'e_layers': 4, 'learning_rate': 0.0011131188943, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9103467
	speed: 0.0138s/iter; left time: 52.7715s
	iters: 200, epoch: 1 | loss: 1.0230060
	speed: 0.0073s/iter; left time: 27.0190s
	iters: 300, epoch: 1 | loss: 0.6458848
	speed: 0.0073s/iter; left time: 26.4918s
	iters: 400, epoch: 1 | loss: 1.1241540
	speed: 0.0069s/iter; left time: 24.4589s
Updating learning rate to 0.0011131188943
Validation loss decreased (inf --> 0.6236).  Saving model state dict ...
Epoch: 1 cost time: 3.8516557216644287
Epoch: 1, Steps: 490 | Train Loss: 0.9258479 Vali Loss: 0.6236031 Best vali loss: 0.6236031
	iters: 100, epoch: 2 | loss: 0.5710660
	speed: 0.0196s/iter; left time: 65.1946s
	iters: 200, epoch: 2 | loss: 0.6274102
	speed: 0.0071s/iter; left time: 23.0760s
	iters: 300, epoch: 2 | loss: 1.0194374
	speed: 0.0069s/iter; left time: 21.7258s
	iters: 400, epoch: 2 | loss: 1.0050191
	speed: 0.0048s/iter; left time: 14.4137s
Updating learning rate to 0.00055655944715
Validation loss decreased (0.6236 --> 0.6105).  Saving model state dict ...
Epoch: 2 cost time: 3.036982774734497
Epoch: 2, Steps: 490 | Train Loss: 0.8057332 Vali Loss: 0.6105280 Best vali loss: 0.6105280
	iters: 100, epoch: 3 | loss: 0.4315099
	speed: 0.0135s/iter; left time: 38.2767s
	iters: 200, epoch: 3 | loss: 0.7690334
	speed: 0.0060s/iter; left time: 16.3354s
	iters: 300, epoch: 3 | loss: 0.9174535
	speed: 0.0059s/iter; left time: 15.5655s
	iters: 400, epoch: 3 | loss: 0.9681965
	speed: 0.0061s/iter; left time: 15.5960s
Updating learning rate to 0.000278279723575
Epoch: 3 cost time: 2.9588515758514404
Epoch: 3, Steps: 490 | Train Loss: 0.7715483 Vali Loss: 0.6473286 Best vali loss: 0.6105280

best validation loss 0.6105279527649401

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019114256213, 'e_layers': 2, 'learning_rate': 0.0002250367297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00021647177916655239
Validation loss decreased (inf --> 0.6102).  Saving model state dict ...
Epoch: 1 cost time: 0.6307709217071533
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6101792 Best vali loss: 0.6101792
Updating learning rate to 0.00019208086364345706
Validation loss decreased (0.6102 --> 0.5973).  Saving model state dict ...
Epoch: 2 cost time: 0.41657495498657227
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5973054 Best vali loss: 0.5973054
Updating learning rate to 0.00015557727891490547
Epoch: 3 cost time: 0.4448883533477783
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6067840 Best vali loss: 0.5973054

best validation loss 0.5973053976707247

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019114256213, 'e_layers': 2, 'learning_rate': 0.0002250367297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00011251836485
Epoch: 4 cost time: 0.6317055225372314
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6174841 Best vali loss: 0.5973054
Updating learning rate to 6.945945078509453e-05
Epoch: 5 cost time: 0.43482494354248047
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6069629 Best vali loss: 0.5973054
Updating learning rate to 3.295586605654293e-05
Epoch: 6 cost time: 0.40970587730407715
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6091134 Best vali loss: 0.5973054
Updating learning rate to 8.564950533447601e-06
Epoch: 7 cost time: 0.4891960620880127
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5974081 Best vali loss: 0.5973054
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4521450996398926
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6010944 Best vali loss: 0.5973054

best validation loss 0.5973053976707247

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0022899640873, 'e_layers': 4, 'learning_rate': 0.0002423804971, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1552696
	speed: 0.0116s/iter; left time: 21.6172s
	iters: 200, epoch: 1 | loss: 0.7369047
	speed: 0.0060s/iter; left time: 10.6458s
Updating learning rate to 0.00023315543872530064
Validation loss decreased (inf --> 0.6160).  Saving model state dict ...
Epoch: 1 cost time: 1.7598819732666016
Epoch: 1, Steps: 245 | Train Loss: 0.9460872 Vali Loss: 0.6160457 Best vali loss: 0.6160457
	iters: 100, epoch: 2 | loss: 1.0540506
	speed: 0.0117s/iter; left time: 18.9467s
	iters: 200, epoch: 2 | loss: 1.0287716
	speed: 0.0061s/iter; left time: 9.2370s
Updating learning rate to 0.00020688469511338813
Validation loss decreased (0.6160 --> 0.6035).  Saving model state dict ...
Epoch: 2 cost time: 1.5470085144042969
Epoch: 2, Steps: 245 | Train Loss: 1.0414111 Vali Loss: 0.6035013 Best vali loss: 0.6035013
	iters: 100, epoch: 3 | loss: 1.0256701
	speed: 0.0121s/iter; left time: 16.5739s
	iters: 200, epoch: 3 | loss: 0.5144531
	speed: 0.0059s/iter; left time: 7.5602s
Updating learning rate to 0.00016756774883429235
Validation loss decreased (0.6035 --> 0.5984).  Saving model state dict ...
Epoch: 3 cost time: 1.5040974617004395
Epoch: 3, Steps: 245 | Train Loss: 0.7700616 Vali Loss: 0.5984090 Best vali loss: 0.5984090
	iters: 100, epoch: 4 | loss: 0.6736790
	speed: 0.0128s/iter; left time: 14.3879s
	iters: 200, epoch: 4 | loss: 0.6281898
	speed: 0.0072s/iter; left time: 7.4251s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.5984 --> 0.5884).  Saving model state dict ...
Epoch: 4 cost time: 1.8425350189208984
Epoch: 4, Steps: 245 | Train Loss: 0.6509344 Vali Loss: 0.5883695 Best vali loss: 0.5883695
	iters: 100, epoch: 5 | loss: 1.1338383
	speed: 0.0143s/iter; left time: 12.6289s
	iters: 200, epoch: 5 | loss: 0.7955154
	speed: 0.0074s/iter; left time: 5.7902s
Updating learning rate to 7.481274826570766e-05
Validation loss decreased (0.5884 --> 0.5577).  Saving model state dict ...
Epoch: 5 cost time: 1.8715848922729492
Epoch: 5, Steps: 245 | Train Loss: 0.9646768 Vali Loss: 0.5576601 Best vali loss: 0.5576601
	iters: 100, epoch: 6 | loss: 0.4912466
	speed: 0.0143s/iter; left time: 9.1141s
	iters: 200, epoch: 6 | loss: 0.8272966
	speed: 0.0073s/iter; left time: 3.9312s
Updating learning rate to 3.549580198661185e-05
Epoch: 6 cost time: 1.8419876098632812
Epoch: 6, Steps: 245 | Train Loss: 0.6592716 Vali Loss: 0.5712687 Best vali loss: 0.5576601
	iters: 100, epoch: 7 | loss: 1.0665212
	speed: 0.0143s/iter; left time: 5.5728s
	iters: 200, epoch: 7 | loss: 0.7778969
	speed: 0.0072s/iter; left time: 2.1038s
Updating learning rate to 9.225058374699354e-06
Epoch: 7 cost time: 1.9185774326324463
Epoch: 7, Steps: 245 | Train Loss: 0.9222090 Vali Loss: 0.5637970 Best vali loss: 0.5576601
	iters: 100, epoch: 8 | loss: 0.7707463
	speed: 0.0150s/iter; left time: 2.1909s
	iters: 200, epoch: 8 | loss: 0.4753906
	speed: 0.0074s/iter; left time: 0.3411s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8676743507385254
Epoch: 8, Steps: 245 | Train Loss: 0.6230685 Vali Loss: 0.5717790 Best vali loss: 0.5576601

best validation loss 0.5576600641191475

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0033888467905, 'e_layers': 1, 'learning_rate': 0.0037128733106, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9486200
	speed: 0.0102s/iter; left time: 19.0583s
	iters: 200, epoch: 1 | loss: 0.9682894
	speed: 0.0042s/iter; left time: 7.4161s
Updating learning rate to 0.0037128733106
Validation loss decreased (inf --> 0.6330).  Saving model state dict ...
Epoch: 1 cost time: 1.2570700645446777
Epoch: 1, Steps: 245 | Train Loss: 0.9584547 Vali Loss: 0.6330301 Best vali loss: 0.6330301
	iters: 100, epoch: 2 | loss: 0.7990011
	speed: 0.0067s/iter; left time: 10.8185s
	iters: 200, epoch: 2 | loss: 1.1083186
	speed: 0.0043s/iter; left time: 6.4947s
Updating learning rate to 0.0018564366553
Validation loss decreased (0.6330 --> 0.6234).  Saving model state dict ...
Epoch: 2 cost time: 0.9827251434326172
Epoch: 2, Steps: 245 | Train Loss: 0.9536598 Vali Loss: 0.6234148 Best vali loss: 0.6234148
	iters: 100, epoch: 3 | loss: 1.0859220
	speed: 0.0101s/iter; left time: 13.8660s
	iters: 200, epoch: 3 | loss: 0.4523130
	speed: 0.0045s/iter; left time: 5.6958s
Updating learning rate to 0.00092821832765
Epoch: 3 cost time: 1.1542153358459473
Epoch: 3, Steps: 245 | Train Loss: 0.7691175 Vali Loss: 0.6359538 Best vali loss: 0.6234148
	iters: 100, epoch: 4 | loss: 0.8510051
	speed: 0.0083s/iter; left time: 9.2940s
	iters: 200, epoch: 4 | loss: 1.1188946
	speed: 0.0031s/iter; left time: 3.2122s
Updating learning rate to 0.000464109163825
Epoch: 4 cost time: 0.8101792335510254
Epoch: 4, Steps: 245 | Train Loss: 0.9849499 Vali Loss: 0.6575054 Best vali loss: 0.6234148
	iters: 100, epoch: 5 | loss: 0.6761344
	speed: 0.0074s/iter; left time: 6.4899s
	iters: 200, epoch: 5 | loss: 0.8474647
	speed: 0.0035s/iter; left time: 2.7593s
Updating learning rate to 0.0002320545819125
Epoch: 5 cost time: 0.9087624549865723
Epoch: 5, Steps: 245 | Train Loss: 0.7617996 Vali Loss: 0.6549415 Best vali loss: 0.6234148
	iters: 100, epoch: 6 | loss: 0.4289440
	speed: 0.0075s/iter; left time: 4.7948s
	iters: 200, epoch: 6 | loss: 1.1374781
	speed: 0.0034s/iter; left time: 1.7974s
Updating learning rate to 0.00011602729095625
Epoch: 6 cost time: 0.8853070735931396
Epoch: 6, Steps: 245 | Train Loss: 0.7832111 Vali Loss: 0.6544254 Best vali loss: 0.6234148
	iters: 100, epoch: 7 | loss: 0.6913185
	speed: 0.0075s/iter; left time: 2.9323s
	iters: 200, epoch: 7 | loss: 1.1302047
	speed: 0.0035s/iter; left time: 1.0254s
Updating learning rate to 5.8013645478125e-05
Epoch: 7 cost time: 0.9065437316894531
Epoch: 7, Steps: 245 | Train Loss: 0.9107616 Vali Loss: 0.6580597 Best vali loss: 0.6234148
	iters: 100, epoch: 8 | loss: 0.8600098
	speed: 0.0075s/iter; left time: 1.0997s
	iters: 200, epoch: 8 | loss: 0.7195596
	speed: 0.0032s/iter; left time: 0.1492s
Updating learning rate to 2.90068227390625e-05
Epoch: 8 cost time: 0.8506748676300049
Epoch: 8, Steps: 245 | Train Loss: 0.7897847 Vali Loss: 0.6610862 Best vali loss: 0.6234148

best validation loss 0.6234147991366212

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0096712489936, 'e_layers': 4, 'learning_rate': 0.0007900549735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7820659
	speed: 0.0119s/iter; left time: 22.1390s
	iters: 200, epoch: 1 | loss: 0.6489915
	speed: 0.0063s/iter; left time: 11.0285s
Updating learning rate to 0.0007599852965376985
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 1.8304479122161865
Epoch: 1, Steps: 245 | Train Loss: 0.7155287 Vali Loss: 0.6063754 Best vali loss: 0.6063754
	iters: 100, epoch: 2 | loss: 0.6978067
	speed: 0.0119s/iter; left time: 19.1835s
	iters: 200, epoch: 2 | loss: 1.2049234
	speed: 0.0060s/iter; left time: 9.1575s
Updating learning rate to 0.000674354101386004
Epoch: 2 cost time: 1.5553317070007324
Epoch: 2, Steps: 245 | Train Loss: 0.9513651 Vali Loss: 0.6112596 Best vali loss: 0.6063754
	iters: 100, epoch: 3 | loss: 0.9102066
	speed: 0.0117s/iter; left time: 15.9867s
	iters: 200, epoch: 3 | loss: 0.7381939
	speed: 0.0063s/iter; left time: 7.9514s
Updating learning rate to 0.0005461979612580451
Epoch: 3 cost time: 1.5610430240631104
Epoch: 3, Steps: 245 | Train Loss: 0.8242003 Vali Loss: 0.6213567 Best vali loss: 0.6063754

best validation loss 0.6063754043331967

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0121773
	speed: 0.0101s/iter; left time: 78.4038s
	iters: 200, epoch: 1 | loss: 0.4066912
	speed: 0.0048s/iter; left time: 36.4280s
	iters: 300, epoch: 1 | loss: 0.9715086
	speed: 0.0047s/iter; left time: 35.6598s
	iters: 400, epoch: 1 | loss: 0.7919140
	speed: 0.0046s/iter; left time: 34.1849s
	iters: 500, epoch: 1 | loss: 0.4371356
	speed: 0.0047s/iter; left time: 34.4150s
	iters: 600, epoch: 1 | loss: 1.2259285
	speed: 0.0047s/iter; left time: 33.8501s
	iters: 700, epoch: 1 | loss: 0.8209591
	speed: 0.0048s/iter; left time: 34.1653s
	iters: 800, epoch: 1 | loss: 0.9911216
	speed: 0.0048s/iter; left time: 33.4346s
	iters: 900, epoch: 1 | loss: 0.9431592
	speed: 0.0048s/iter; left time: 33.0790s
Updating learning rate to 0.0001606491471
Validation loss decreased (inf --> 0.6149).  Saving model state dict ...
Epoch: 1 cost time: 4.911410808563232
Epoch: 1, Steps: 979 | Train Loss: 0.8445106 Vali Loss: 0.6149054 Best vali loss: 0.6149054
	iters: 100, epoch: 2 | loss: 1.1198839
	speed: 0.0155s/iter; left time: 104.7160s
	iters: 200, epoch: 2 | loss: 1.2812928
	speed: 0.0047s/iter; left time: 31.0461s
	iters: 300, epoch: 2 | loss: 0.5733182
	speed: 0.0048s/iter; left time: 31.2195s
	iters: 400, epoch: 2 | loss: 0.4534515
	speed: 0.0044s/iter; left time: 28.2880s
	iters: 500, epoch: 2 | loss: 1.3925740
	speed: 0.0045s/iter; left time: 28.6365s
	iters: 600, epoch: 2 | loss: 0.9132429
	speed: 0.0049s/iter; left time: 30.6126s
	iters: 700, epoch: 2 | loss: 0.6662502
	speed: 0.0045s/iter; left time: 27.7614s
	iters: 800, epoch: 2 | loss: 0.9487270
	speed: 0.0048s/iter; left time: 28.8298s
	iters: 900, epoch: 2 | loss: 1.3637649
	speed: 0.0048s/iter; left time: 28.7478s
Updating learning rate to 8.032457355e-05
Validation loss decreased (0.6149 --> 0.6019).  Saving model state dict ...
Epoch: 2 cost time: 4.65405011177063
Epoch: 2, Steps: 979 | Train Loss: 0.9680562 Vali Loss: 0.6018669 Best vali loss: 0.6018669
	iters: 100, epoch: 3 | loss: 0.3106252
	speed: 0.0158s/iter; left time: 91.2984s
	iters: 200, epoch: 3 | loss: 1.5609865
	speed: 0.0045s/iter; left time: 25.7543s
	iters: 300, epoch: 3 | loss: 0.6572632
	speed: 0.0045s/iter; left time: 24.9410s
	iters: 400, epoch: 3 | loss: 0.3971199
	speed: 0.0043s/iter; left time: 23.5937s
	iters: 500, epoch: 3 | loss: 0.3578473
	speed: 0.0042s/iter; left time: 22.4609s
	iters: 600, epoch: 3 | loss: 0.2608480
	speed: 0.0040s/iter; left time: 20.8667s
	iters: 700, epoch: 3 | loss: 0.7742628
	speed: 0.0047s/iter; left time: 24.5387s
	iters: 800, epoch: 3 | loss: 1.1487795
	speed: 0.0061s/iter; left time: 31.0071s
	iters: 900, epoch: 3 | loss: 0.6868919
	speed: 0.0060s/iter; left time: 29.9098s
Updating learning rate to 4.0162286775e-05
Epoch: 3 cost time: 4.788408041000366
Epoch: 3, Steps: 979 | Train Loss: 0.6838472 Vali Loss: 0.6054687 Best vali loss: 0.6018669

best validation loss 0.6018668856404545

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0061686788666, 'e_layers': 2, 'learning_rate': 0.0029971076006, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6872876
	speed: 0.0111s/iter; left time: 42.3629s
	iters: 200, epoch: 1 | loss: 1.0220402
	speed: 0.0056s/iter; left time: 20.8368s
	iters: 300, epoch: 1 | loss: 0.5665868
	speed: 0.0056s/iter; left time: 20.3934s
	iters: 400, epoch: 1 | loss: 0.6611027
	speed: 0.0055s/iter; left time: 19.2152s
Updating learning rate to 0.0028830369847641763
Validation loss decreased (inf --> 0.6446).  Saving model state dict ...
Epoch: 1 cost time: 2.956134796142578
Epoch: 1, Steps: 490 | Train Loss: 0.7342543 Vali Loss: 0.6446135 Best vali loss: 0.6446135
	iters: 100, epoch: 2 | loss: 0.8136299
	speed: 0.0154s/iter; left time: 51.4314s
	iters: 200, epoch: 2 | loss: 0.5802415
	speed: 0.0054s/iter; left time: 17.4221s
	iters: 300, epoch: 2 | loss: 0.9905450
	speed: 0.0050s/iter; left time: 15.7808s
	iters: 400, epoch: 2 | loss: 0.9529882
	speed: 0.0055s/iter; left time: 16.6245s
Updating learning rate to 0.002558191354465001
Epoch: 2 cost time: 2.6375391483306885
Epoch: 2, Steps: 490 | Train Loss: 0.8343511 Vali Loss: 0.6497299 Best vali loss: 0.6446135
	iters: 100, epoch: 3 | loss: 1.0732409
	speed: 0.0145s/iter; left time: 41.2620s
	iters: 200, epoch: 3 | loss: 0.8799748
	speed: 0.0050s/iter; left time: 13.6972s
	iters: 300, epoch: 3 | loss: 0.3701183
	speed: 0.0053s/iter; left time: 13.9673s
	iters: 400, epoch: 3 | loss: 0.3968428
	speed: 0.0054s/iter; left time: 13.7173s
Updating learning rate to 0.0020720255121825532
Validation loss decreased (0.6446 --> 0.6408).  Saving model state dict ...
Epoch: 3 cost time: 2.6283161640167236
Epoch: 3, Steps: 490 | Train Loss: 0.6800442 Vali Loss: 0.6407992 Best vali loss: 0.6407992

best validation loss 0.6407992350577977

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8556350
	speed: 0.0117s/iter; left time: 55.9848s
	iters: 200, epoch: 4 | loss: 0.3510587
	speed: 0.0060s/iter; left time: 27.9659s
	iters: 300, epoch: 4 | loss: 0.9264771
	speed: 0.0061s/iter; left time: 28.0415s
	iters: 400, epoch: 4 | loss: 0.7899921
	speed: 0.0058s/iter; left time: 26.0980s
	iters: 500, epoch: 4 | loss: 0.4251190
	speed: 0.0051s/iter; left time: 22.2829s
	iters: 600, epoch: 4 | loss: 1.2212688
	speed: 0.0039s/iter; left time: 16.6934s
	iters: 700, epoch: 4 | loss: 0.8195581
	speed: 0.0047s/iter; left time: 19.8420s
	iters: 800, epoch: 4 | loss: 0.9444648
	speed: 0.0054s/iter; left time: 22.2474s
	iters: 900, epoch: 4 | loss: 0.8661251
	speed: 0.0055s/iter; left time: 21.8112s
Updating learning rate to 2.00811433875e-05
Epoch: 4 cost time: 5.555961847305298
Epoch: 4, Steps: 979 | Train Loss: 0.7999665 Vali Loss: 0.6129239 Best vali loss: 0.6018669
	iters: 100, epoch: 5 | loss: 0.9893489
	speed: 0.0189s/iter; left time: 71.9553s
	iters: 200, epoch: 5 | loss: 1.0665463
	speed: 0.0058s/iter; left time: 21.3854s
	iters: 300, epoch: 5 | loss: 0.5585893
	speed: 0.0055s/iter; left time: 19.8331s
	iters: 400, epoch: 5 | loss: 0.4565098
	speed: 0.0057s/iter; left time: 19.9170s
	iters: 500, epoch: 5 | loss: 1.3304204
	speed: 0.0054s/iter; left time: 18.6148s
	iters: 600, epoch: 5 | loss: 0.8816490
	speed: 0.0058s/iter; left time: 19.2074s
	iters: 700, epoch: 5 | loss: 0.6975490
	speed: 0.0057s/iter; left time: 18.3175s
	iters: 800, epoch: 5 | loss: 0.9482251
	speed: 0.0056s/iter; left time: 17.4320s
	iters: 900, epoch: 5 | loss: 1.3700879
	speed: 0.0057s/iter; left time: 17.1137s
Updating learning rate to 1.004057169375e-05
Epoch: 5 cost time: 5.5493457317352295
Epoch: 5, Steps: 979 | Train Loss: 0.9221028 Vali Loss: 0.6090558 Best vali loss: 0.6018669
	iters: 100, epoch: 6 | loss: 0.2983559
	speed: 0.0189s/iter; left time: 53.6862s
	iters: 200, epoch: 6 | loss: 1.4623569
	speed: 0.0056s/iter; left time: 15.3186s
	iters: 300, epoch: 6 | loss: 0.6499713
	speed: 0.0057s/iter; left time: 14.9597s
	iters: 400, epoch: 6 | loss: 0.4303548
	speed: 0.0040s/iter; left time: 10.2346s
	iters: 500, epoch: 6 | loss: 0.3628564
	speed: 0.0040s/iter; left time: 9.6401s
	iters: 600, epoch: 6 | loss: 0.2572496
	speed: 0.0055s/iter; left time: 12.8659s
	iters: 700, epoch: 6 | loss: 0.7610159
	speed: 0.0063s/iter; left time: 14.1400s
	iters: 800, epoch: 6 | loss: 1.0436295
	speed: 0.0059s/iter; left time: 12.6308s
	iters: 900, epoch: 6 | loss: 0.6897362
	speed: 0.0059s/iter; left time: 12.0214s
Updating learning rate to 5.020285846875e-06
Epoch: 6 cost time: 5.357873201370239
Epoch: 6, Steps: 979 | Train Loss: 0.6617252 Vali Loss: 0.6057158 Best vali loss: 0.6018669
	iters: 100, epoch: 7 | loss: 0.7527722
	speed: 0.0188s/iter; left time: 35.0382s
	iters: 200, epoch: 7 | loss: 1.3574907
	speed: 0.0060s/iter; left time: 10.6005s
	iters: 300, epoch: 7 | loss: 0.4783935
	speed: 0.0060s/iter; left time: 9.9446s
	iters: 400, epoch: 7 | loss: 0.3101172
	speed: 0.0058s/iter; left time: 8.9699s
	iters: 500, epoch: 7 | loss: 1.2193866
	speed: 0.0048s/iter; left time: 7.0027s
	iters: 600, epoch: 7 | loss: 1.1401913
	speed: 0.0039s/iter; left time: 5.2752s
	iters: 700, epoch: 7 | loss: 0.6348295
	speed: 0.0044s/iter; left time: 5.5876s
	iters: 800, epoch: 7 | loss: 1.1718254
	speed: 0.0046s/iter; left time: 5.3764s
	iters: 900, epoch: 7 | loss: 0.8120387
	speed: 0.0048s/iter; left time: 5.0718s
Updating learning rate to 2.5101429234375e-06
Epoch: 7 cost time: 5.02738094329834
Epoch: 7, Steps: 979 | Train Loss: 0.8752272 Vali Loss: 0.6050772 Best vali loss: 0.6018669
	iters: 100, epoch: 8 | loss: 1.1355605
	speed: 0.0155s/iter; left time: 13.6636s
	iters: 200, epoch: 8 | loss: 0.8956579
	speed: 0.0050s/iter; left time: 3.8723s
	iters: 300, epoch: 8 | loss: 1.6353598
	speed: 0.0052s/iter; left time: 3.5158s
	iters: 400, epoch: 8 | loss: 0.9905148
	speed: 0.0050s/iter; left time: 2.9141s
	iters: 500, epoch: 8 | loss: 0.7779124
	speed: 0.0050s/iter; left time: 2.3978s
	iters: 600, epoch: 8 | loss: 0.6351299
	speed: 0.0050s/iter; left time: 1.9008s
	iters: 700, epoch: 8 | loss: 0.4990058
	speed: 0.0048s/iter; left time: 1.3511s
	iters: 800, epoch: 8 | loss: 0.9231027
	speed: 0.0048s/iter; left time: 0.8597s
	iters: 900, epoch: 8 | loss: 1.0452807
	speed: 0.0052s/iter; left time: 0.4188s
Updating learning rate to 1.25507146171875e-06
Epoch: 8 cost time: 4.938351631164551
Epoch: 8, Steps: 979 | Train Loss: 0.9486138 Vali Loss: 0.6073305 Best vali loss: 0.6018669

best validation loss 0.6018668856404545

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.00487546233, 'e_layers': 4, 'learning_rate': 0.0010291718456, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000990001324593353
Validation loss decreased (inf --> 0.6240).  Saving model state dict ...
Epoch: 1 cost time: 0.7770359516143799
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6239857 Best vali loss: 0.6239857
Updating learning rate to 0.0008784531183150171
Validation loss decreased (0.6240 --> 0.6110).  Saving model state dict ...
Epoch: 2 cost time: 0.5764076709747314
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6110227 Best vali loss: 0.6110227
Updating learning rate to 0.000711509429983861
Validation loss decreased (0.6110 --> 0.6079).  Saving model state dict ...
Epoch: 3 cost time: 0.5708723068237305
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6079244 Best vali loss: 0.6079244
Updating learning rate to 0.0005145859228
Validation loss decreased (0.6079 --> 0.6028).  Saving model state dict ...
Epoch: 4 cost time: 0.5641400814056396
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6028291 Best vali loss: 0.6028291
Updating learning rate to 0.0003176624156161389
Epoch: 5 cost time: 0.5553336143493652
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6029012 Best vali loss: 0.6028291
Updating learning rate to 0.00015071872728498277
Epoch: 6 cost time: 0.5325009822845459
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6041629 Best vali loss: 0.6028291
Updating learning rate to 3.917052100664691e-05
Validation loss decreased (0.6028 --> 0.5912).  Saving model state dict ...
Epoch: 7 cost time: 0.5637824535369873
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5912195 Best vali loss: 0.5912195
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5692234039306641
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5923821 Best vali loss: 0.5912195

best validation loss 0.5912194557346607

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010495657123, 'e_layers': 4, 'learning_rate': 0.0016632342935, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6167505
	speed: 0.0156s/iter; left time: 13.7970s
Updating learning rate to 0.0016632342935
Validation loss decreased (inf --> 0.6571).  Saving model state dict ...
Epoch: 1 cost time: 1.4543263912200928
Epoch: 1, Steps: 123 | Train Loss: 0.6167505 Vali Loss: 0.6570896 Best vali loss: 0.6570896
	iters: 100, epoch: 2 | loss: 1.0642898
	speed: 0.0140s/iter; left time: 10.6919s
Updating learning rate to 0.00083161714675
Validation loss decreased (0.6571 --> 0.6216).  Saving model state dict ...
Epoch: 2 cost time: 1.1362502574920654
Epoch: 2, Steps: 123 | Train Loss: 1.0642898 Vali Loss: 0.6215957 Best vali loss: 0.6215957
	iters: 100, epoch: 3 | loss: 0.7086490
	speed: 0.0131s/iter; left time: 8.3977s
Updating learning rate to 0.000415808573375
Epoch: 3 cost time: 1.0902814865112305
Epoch: 3, Steps: 123 | Train Loss: 0.7086490 Vali Loss: 0.6494726 Best vali loss: 0.6215957
	iters: 100, epoch: 4 | loss: 0.8487494
	speed: 0.0149s/iter; left time: 7.6882s
Updating learning rate to 0.0002079042866875
Epoch: 4 cost time: 1.227156162261963
Epoch: 4, Steps: 123 | Train Loss: 0.8487494 Vali Loss: 0.6452779 Best vali loss: 0.6215957
	iters: 100, epoch: 5 | loss: 0.8313368
	speed: 0.0148s/iter; left time: 5.8288s
Updating learning rate to 0.00010395214334375
Epoch: 5 cost time: 1.217175006866455
Epoch: 5, Steps: 123 | Train Loss: 0.8313368 Vali Loss: 0.6408722 Best vali loss: 0.6215957
	iters: 100, epoch: 6 | loss: 0.9662061
	speed: 0.0153s/iter; left time: 4.1333s
Updating learning rate to 5.1976071671875e-05
Epoch: 6 cost time: 1.2494449615478516
Epoch: 6, Steps: 123 | Train Loss: 0.9662061 Vali Loss: 0.6442463 Best vali loss: 0.6215957
	iters: 100, epoch: 7 | loss: 0.9209235
	speed: 0.0149s/iter; left time: 2.1910s
Updating learning rate to 2.59880358359375e-05
Epoch: 7 cost time: 1.216942548751831
Epoch: 7, Steps: 123 | Train Loss: 0.9209235 Vali Loss: 0.6430690 Best vali loss: 0.6215957
	iters: 100, epoch: 8 | loss: 1.0155568
	speed: 0.0151s/iter; left time: 0.3618s
Updating learning rate to 1.299401791796875e-05
Epoch: 8 cost time: 1.2261159420013428
Epoch: 8, Steps: 123 | Train Loss: 1.0155568 Vali Loss: 0.6427594 Best vali loss: 0.6215957

best validation loss 0.6215956569379923

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0099997540142, 'e_layers': 1, 'learning_rate': 0.0030308631648, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0003330
	speed: 0.0103s/iter; left time: 19.1593s
	iters: 200, epoch: 1 | loss: 0.5691759
	speed: 0.0045s/iter; left time: 7.9063s
Updating learning rate to 0.0029155078043005514
Validation loss decreased (inf --> 0.6228).  Saving model state dict ...
Epoch: 1 cost time: 1.4367222785949707
Epoch: 1, Steps: 245 | Train Loss: 0.7847544 Vali Loss: 0.6228350 Best vali loss: 0.6228350
	iters: 100, epoch: 2 | loss: 0.7385157
	speed: 0.0106s/iter; left time: 17.1494s
	iters: 200, epoch: 2 | loss: 0.5958249
	speed: 0.0048s/iter; left time: 7.2650s
Updating learning rate to 0.0025870035307393
Validation loss decreased (0.6228 --> 0.6009).  Saving model state dict ...
Epoch: 2 cost time: 1.1493589878082275
Epoch: 2, Steps: 245 | Train Loss: 0.6671703 Vali Loss: 0.6008815 Best vali loss: 0.6008815
	iters: 100, epoch: 3 | loss: 0.6907114
	speed: 0.0073s/iter; left time: 9.9762s
	iters: 200, epoch: 3 | loss: 0.5349676
	speed: 0.0029s/iter; left time: 3.6762s
Updating learning rate to 0.0020953621418672913
Epoch: 3 cost time: 0.771376371383667
Epoch: 3, Steps: 245 | Train Loss: 0.6128395 Vali Loss: 0.6136002 Best vali loss: 0.6008815

best validation loss 0.600881452501951

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026411680255, 'e_layers': 1, 'learning_rate': 0.0015330488365, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9498430
	speed: 0.0088s/iter; left time: 16.3947s
	iters: 200, epoch: 1 | loss: 0.9741226
	speed: 0.0032s/iter; left time: 5.6695s
Updating learning rate to 0.0014747006394412961
Validation loss decreased (inf --> 0.6000).  Saving model state dict ...
Epoch: 1 cost time: 1.075648546218872
Epoch: 1, Steps: 245 | Train Loss: 0.9619828 Vali Loss: 0.5999598 Best vali loss: 0.5999598
	iters: 100, epoch: 2 | loss: 0.7953368
	speed: 0.0073s/iter; left time: 11.8676s
	iters: 200, epoch: 2 | loss: 1.1089467
	speed: 0.0035s/iter; left time: 5.2838s
Updating learning rate to 0.0013085390323396484
Validation loss decreased (0.6000 --> 0.5961).  Saving model state dict ...
Epoch: 2 cost time: 0.8989710807800293
Epoch: 2, Steps: 245 | Train Loss: 0.9521418 Vali Loss: 0.5961110 Best vali loss: 0.5961110
	iters: 100, epoch: 3 | loss: 1.0881711
	speed: 0.0074s/iter; left time: 10.0821s
	iters: 200, epoch: 3 | loss: 0.4859017
	speed: 0.0033s/iter; left time: 4.1328s
Updating learning rate to 0.0010598606136175638
Epoch: 3 cost time: 0.8482003211975098
Epoch: 3, Steps: 245 | Train Loss: 0.7870364 Vali Loss: 0.6105630 Best vali loss: 0.5961110

best validation loss 0.5961110116099384

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0074460408096, 'e_layers': 2, 'learning_rate': 0.0027349231343, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6864414
	speed: 0.0102s/iter; left time: 19.0684s
	iters: 200, epoch: 1 | loss: 1.1301022
	speed: 0.0048s/iter; left time: 8.5061s
Updating learning rate to 0.0027349231343
Validation loss decreased (inf --> 0.6156).  Saving model state dict ...
Epoch: 1 cost time: 1.4538624286651611
Epoch: 1, Steps: 245 | Train Loss: 0.9082718 Vali Loss: 0.6156391 Best vali loss: 0.6156391
	iters: 100, epoch: 2 | loss: 0.8198608
	speed: 0.0095s/iter; left time: 15.2806s
	iters: 200, epoch: 2 | loss: 0.7026072
	speed: 0.0044s/iter; left time: 6.7067s
Updating learning rate to 0.00136746156715
Epoch: 2 cost time: 1.162674903869629
Epoch: 2, Steps: 245 | Train Loss: 0.7612340 Vali Loss: 0.6304036 Best vali loss: 0.6156391
	iters: 100, epoch: 3 | loss: 1.0601779
	speed: 0.0091s/iter; left time: 12.5109s
	iters: 200, epoch: 3 | loss: 0.7633049
	speed: 0.0044s/iter; left time: 5.6010s
Updating learning rate to 0.000683730783575
Epoch: 3 cost time: 1.1397414207458496
Epoch: 3, Steps: 245 | Train Loss: 0.9117414 Vali Loss: 0.6374226 Best vali loss: 0.6156391

best validation loss 0.6156390776020794

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026411680255, 'e_layers': 1, 'learning_rate': 0.0015330488365, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9219539
	speed: 0.0093s/iter; left time: 10.4209s
	iters: 200, epoch: 4 | loss: 0.9450372
	speed: 0.0031s/iter; left time: 3.1566s
Updating learning rate to 0.00076652441825
Epoch: 4 cost time: 1.0464458465576172
Epoch: 4, Steps: 245 | Train Loss: 0.9334955 Vali Loss: 0.6330761 Best vali loss: 0.5961110
	iters: 100, epoch: 5 | loss: 0.7758090
	speed: 0.0079s/iter; left time: 6.9484s
	iters: 200, epoch: 5 | loss: 1.0838715
	speed: 0.0036s/iter; left time: 2.7978s
Updating learning rate to 0.0004731882228824364
Epoch: 5 cost time: 0.9458029270172119
Epoch: 5, Steps: 245 | Train Loss: 0.9298402 Vali Loss: 0.6222454 Best vali loss: 0.5961110
	iters: 100, epoch: 6 | loss: 1.0872606
	speed: 0.0079s/iter; left time: 5.0292s
	iters: 200, epoch: 6 | loss: 0.4410913
	speed: 0.0032s/iter; left time: 1.7051s
Updating learning rate to 0.00022450980416035169
Epoch: 6 cost time: 0.8485820293426514
Epoch: 6, Steps: 245 | Train Loss: 0.7641760 Vali Loss: 0.6276772 Best vali loss: 0.5961110
	iters: 100, epoch: 7 | loss: 0.7972387
	speed: 0.0075s/iter; left time: 2.9453s
	iters: 200, epoch: 7 | loss: 1.1297603
	speed: 0.0033s/iter; left time: 0.9742s
Updating learning rate to 5.8348197058703974e-05
Epoch: 7 cost time: 0.8830404281616211
Epoch: 7, Steps: 245 | Train Loss: 0.9634995 Vali Loss: 0.6342258 Best vali loss: 0.5961110
	iters: 100, epoch: 8 | loss: 0.6938260
	speed: 0.0076s/iter; left time: 1.1068s
	iters: 200, epoch: 8 | loss: 0.8393243
	speed: 0.0033s/iter; left time: 0.1530s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8773481845855713
Epoch: 8, Steps: 245 | Train Loss: 0.7665752 Vali Loss: 0.6388055 Best vali loss: 0.5961110

best validation loss 0.5961110116099384

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011667363616, 'e_layers': 4, 'learning_rate': 0.0008608226971, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4592684
	speed: 0.0118s/iter; left time: 91.1487s
	iters: 200, epoch: 1 | loss: 0.3364757
	speed: 0.0063s/iter; left time: 48.4070s
	iters: 300, epoch: 1 | loss: 1.4881607
	speed: 0.0063s/iter; left time: 47.5716s
	iters: 400, epoch: 1 | loss: 1.0851707
	speed: 0.0063s/iter; left time: 47.0579s
	iters: 500, epoch: 1 | loss: 1.5122187
	speed: 0.0063s/iter; left time: 46.2657s
	iters: 600, epoch: 1 | loss: 1.0698885
	speed: 0.0063s/iter; left time: 45.6284s
	iters: 700, epoch: 1 | loss: 1.3254137
	speed: 0.0063s/iter; left time: 45.0553s
	iters: 800, epoch: 1 | loss: 1.0071656
	speed: 0.0063s/iter; left time: 44.4442s
	iters: 900, epoch: 1 | loss: 0.3215497
	speed: 0.0063s/iter; left time: 43.8227s
Updating learning rate to 0.0008280595840359265
Validation loss decreased (inf --> 0.6451).  Saving model state dict ...
Epoch: 1 cost time: 6.478822946548462
Epoch: 1, Steps: 979 | Train Loss: 0.9561457 Vali Loss: 0.6450579 Best vali loss: 0.6450579
	iters: 100, epoch: 2 | loss: 0.4374695
	speed: 0.0197s/iter; left time: 132.8032s
	iters: 200, epoch: 2 | loss: 0.5833222
	speed: 0.0062s/iter; left time: 41.1011s
	iters: 300, epoch: 2 | loss: 2.0930567
	speed: 0.0064s/iter; left time: 42.1000s
	iters: 400, epoch: 2 | loss: 2.2585986
	speed: 0.0064s/iter; left time: 41.5529s
	iters: 500, epoch: 2 | loss: 1.0314363
	speed: 0.0064s/iter; left time: 40.6072s
	iters: 600, epoch: 2 | loss: 0.7969932
	speed: 0.0065s/iter; left time: 40.4530s
	iters: 700, epoch: 2 | loss: 0.4696608
	speed: 0.0065s/iter; left time: 40.2677s
	iters: 800, epoch: 2 | loss: 1.9142960
	speed: 0.0069s/iter; left time: 41.4702s
	iters: 900, epoch: 2 | loss: 0.3466137
	speed: 0.0066s/iter; left time: 39.4166s
Updating learning rate to 0.0007347581318093517
Epoch: 2 cost time: 6.400116443634033
Epoch: 2, Steps: 979 | Train Loss: 1.1034941 Vali Loss: 0.6564436 Best vali loss: 0.6450579
	iters: 100, epoch: 3 | loss: 0.5880023
	speed: 0.0184s/iter; left time: 106.3707s
	iters: 200, epoch: 3 | loss: 1.7905004
	speed: 0.0051s/iter; left time: 28.7697s
	iters: 300, epoch: 3 | loss: 1.3329521
	speed: 0.0054s/iter; left time: 30.1607s
	iters: 400, epoch: 3 | loss: 0.6354449
	speed: 0.0064s/iter; left time: 35.0688s
	iters: 500, epoch: 3 | loss: 0.5796467
	speed: 0.0073s/iter; left time: 39.4623s
	iters: 600, epoch: 3 | loss: 1.6445848
	speed: 0.0074s/iter; left time: 38.8175s
	iters: 700, epoch: 3 | loss: 1.1277027
	speed: 0.0074s/iter; left time: 38.4506s
	iters: 800, epoch: 3 | loss: 0.8289260
	speed: 0.0074s/iter; left time: 37.3524s
	iters: 900, epoch: 3 | loss: 0.4633685
	speed: 0.0074s/iter; left time: 36.8982s
Updating learning rate to 0.000595122640742001
Validation loss decreased (0.6451 --> 0.6427).  Saving model state dict ...
Epoch: 3 cost time: 6.568411111831665
Epoch: 3, Steps: 979 | Train Loss: 0.9990143 Vali Loss: 0.6426625 Best vali loss: 0.6426625
	iters: 100, epoch: 4 | loss: 0.8734764
	speed: 0.0216s/iter; left time: 103.4251s
	iters: 200, epoch: 4 | loss: 0.3497480
	speed: 0.0050s/iter; left time: 23.2779s
	iters: 300, epoch: 4 | loss: 0.5473412
	speed: 0.0091s/iter; left time: 41.6398s
	iters: 400, epoch: 4 | loss: 0.5459962
	speed: 0.0092s/iter; left time: 41.1499s
	iters: 500, epoch: 4 | loss: 0.6408365
	speed: 0.0104s/iter; left time: 45.8388s
	iters: 600, epoch: 4 | loss: 0.4536069
	speed: 0.0091s/iter; left time: 39.0948s
	iters: 700, epoch: 4 | loss: 0.3844346
	speed: 0.0109s/iter; left time: 45.8878s
	iters: 800, epoch: 4 | loss: 0.2940400
	speed: 0.0086s/iter; left time: 35.3127s
	iters: 900, epoch: 4 | loss: 2.4613402
	speed: 0.0104s/iter; left time: 41.3603s
Updating learning rate to 0.00043041134855
Validation loss decreased (0.6427 --> 0.6305).  Saving model state dict ...
Epoch: 4 cost time: 8.663796663284302
Epoch: 4, Steps: 979 | Train Loss: 0.7278689 Vali Loss: 0.6305467 Best vali loss: 0.6305467
	iters: 100, epoch: 5 | loss: 0.8047896
	speed: 0.0310s/iter; left time: 118.4551s
	iters: 200, epoch: 5 | loss: 0.5649323
	speed: 0.0088s/iter; left time: 32.5328s
	iters: 300, epoch: 5 | loss: 0.5792490
	speed: 0.0101s/iter; left time: 36.6760s
	iters: 400, epoch: 5 | loss: 1.3398694
	speed: 0.0098s/iter; left time: 34.5757s
	iters: 500, epoch: 5 | loss: 2.3879149
	speed: 0.0086s/iter; left time: 29.3845s
	iters: 600, epoch: 5 | loss: 0.4881015
	speed: 0.0052s/iter; left time: 17.3525s
	iters: 700, epoch: 5 | loss: 0.6546595
	speed: 0.0062s/iter; left time: 20.0077s
	iters: 800, epoch: 5 | loss: 0.5791165
	speed: 0.0077s/iter; left time: 23.9928s
	iters: 900, epoch: 5 | loss: 0.4968374
	speed: 0.0073s/iter; left time: 22.1689s
Updating learning rate to 0.000265700056357999
Epoch: 5 cost time: 8.171029567718506
Epoch: 5, Steps: 979 | Train Loss: 0.8772745 Vali Loss: 0.6431101 Best vali loss: 0.6305467
	iters: 100, epoch: 6 | loss: 0.6354142
	speed: 0.0237s/iter; left time: 67.2728s
	iters: 200, epoch: 6 | loss: 0.2542542
	speed: 0.0045s/iter; left time: 12.2636s
	iters: 300, epoch: 6 | loss: 1.0409828
	speed: 0.0055s/iter; left time: 14.5617s
	iters: 400, epoch: 6 | loss: 0.6111661
	speed: 0.0070s/iter; left time: 17.8529s
	iters: 500, epoch: 6 | loss: 0.8880199
	speed: 0.0064s/iter; left time: 15.7031s
	iters: 600, epoch: 6 | loss: 1.7390901
	speed: 0.0072s/iter; left time: 16.8336s
	iters: 700, epoch: 6 | loss: 0.5597040
	speed: 0.0064s/iter; left time: 14.2468s
	iters: 800, epoch: 6 | loss: 0.3566296
	speed: 0.0066s/iter; left time: 14.0723s
	iters: 900, epoch: 6 | loss: 1.8671854
	speed: 0.0060s/iter; left time: 12.1293s
Updating learning rate to 0.00012606456529064833
Epoch: 6 cost time: 6.176351070404053
Epoch: 6, Steps: 979 | Train Loss: 0.8836051 Vali Loss: 0.6502472 Best vali loss: 0.6305467
	iters: 100, epoch: 7 | loss: 0.6147292
	speed: 0.0200s/iter; left time: 37.1314s
	iters: 200, epoch: 7 | loss: 1.2579520
	speed: 0.0065s/iter; left time: 11.4650s
	iters: 300, epoch: 7 | loss: 0.8729969
	speed: 0.0065s/iter; left time: 10.7512s
	iters: 400, epoch: 7 | loss: 0.4932017
	speed: 0.0064s/iter; left time: 9.9496s
	iters: 500, epoch: 7 | loss: 0.9483365
	speed: 0.0062s/iter; left time: 9.0537s
	iters: 600, epoch: 7 | loss: 0.3022352
	speed: 0.0063s/iter; left time: 8.5515s
	iters: 700, epoch: 7 | loss: 0.4981913
	speed: 0.0062s/iter; left time: 7.8437s
	iters: 800, epoch: 7 | loss: 0.4584101
	speed: 0.0060s/iter; left time: 6.9469s
	iters: 900, epoch: 7 | loss: 0.7679946
	speed: 0.0052s/iter; left time: 5.4982s
Updating learning rate to 3.276311306407351e-05
Epoch: 7 cost time: 6.13559627532959
Epoch: 7, Steps: 979 | Train Loss: 0.6904497 Vali Loss: 0.6425273 Best vali loss: 0.6305467
	iters: 100, epoch: 8 | loss: 0.3507916
	speed: 0.0212s/iter; left time: 18.6541s
	iters: 200, epoch: 8 | loss: 0.6897674
	speed: 0.0066s/iter; left time: 5.1414s
	iters: 300, epoch: 8 | loss: 0.7657911
	speed: 0.0062s/iter; left time: 4.1856s
	iters: 400, epoch: 8 | loss: 0.6071751
	speed: 0.0062s/iter; left time: 3.6003s
	iters: 500, epoch: 8 | loss: 1.3936810
	speed: 0.0064s/iter; left time: 3.0483s
	iters: 600, epoch: 8 | loss: 0.6389567
	speed: 0.0065s/iter; left time: 2.4676s
	iters: 700, epoch: 8 | loss: 0.3331751
	speed: 0.0066s/iter; left time: 1.8508s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009946628485, 'e_layers': 1, 'learning_rate': 0.0001665995443, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7560516
	speed: 0.0107s/iter; left time: 19.8899s
	iters: 200, epoch: 1 | loss: 1.1726452
	speed: 0.0048s/iter; left time: 8.4131s
Updating learning rate to 0.0001665995443
Validation loss decreased (inf --> 0.6634).  Saving model state dict ...
Epoch: 1 cost time: 1.4592938423156738
Epoch: 1, Steps: 245 | Train Loss: 0.9643484 Vali Loss: 0.6634398 Best vali loss: 0.6634398
	iters: 100, epoch: 2 | loss: 0.5838448
	speed: 0.0094s/iter; left time: 15.2621s
	iters: 200, epoch: 2 | loss: 0.8962506
	speed: 0.0030s/iter; left time: 4.5134s
Updating learning rate to 8.329977215e-05
Validation loss decreased (0.6634 --> 0.6331).  Saving model state dict ...
Epoch: 2 cost time: 0.8563845157623291
Epoch: 2, Steps: 245 | Train Loss: 0.7400477 Vali Loss: 0.6330963 Best vali loss: 0.6330963
	iters: 100, epoch: 3 | loss: 0.7536831
	speed: 0.0074s/iter; left time: 10.1928s
	iters: 200, epoch: 3 | loss: 0.5691634
	speed: 0.0037s/iter; left time: 4.6979s
Updating learning rate to 4.1649886075e-05
Validation loss decreased (0.6331 --> 0.6242).  Saving model state dict ...
Epoch: 3 cost time: 0.9279940128326416
Epoch: 3, Steps: 245 | Train Loss: 0.6614233 Vali Loss: 0.6242108 Best vali loss: 0.6242108
	iters: 100, epoch: 4 | loss: 0.9047700
	speed: 0.0081s/iter; left time: 9.1519s
	iters: 200, epoch: 4 | loss: 0.9475768
	speed: 0.0034s/iter; left time: 3.5148s
Updating learning rate to 2.08249430375e-05
Validation loss decreased (0.6242 --> 0.6203).  Saving model state dict ...
Epoch: 4 cost time: 0.9356000423431396
Epoch: 4, Steps: 245 | Train Loss: 0.9261734 Vali Loss: 0.6202817 Best vali loss: 0.6202817
	iters: 100, epoch: 5 | loss: 0.8995110
	speed: 0.0083s/iter; left time: 7.2803s
	iters: 200, epoch: 5 | loss: 0.4816931
	speed: 0.0036s/iter; left time: 2.7804s
Updating learning rate to 1.041247151875e-05
Validation loss decreased (0.6203 --> 0.6187).  Saving model state dict ...
Epoch: 5 cost time: 0.930027961730957
Epoch: 5, Steps: 245 | Train Loss: 0.6906021 Vali Loss: 0.6187476 Best vali loss: 0.6187476
	iters: 100, epoch: 6 | loss: 1.1103472
	speed: 0.0082s/iter; left time: 5.1856s
	iters: 200, epoch: 6 | loss: 0.6231282
	speed: 0.0034s/iter; left time: 1.8424s
Updating learning rate to 5.206235759375e-06
Validation loss decreased (0.6187 --> 0.6179).  Saving model state dict ...
Epoch: 6 cost time: 0.9243652820587158
Epoch: 6, Steps: 245 | Train Loss: 0.8667377 Vali Loss: 0.6178799 Best vali loss: 0.6178799
	iters: 100, epoch: 7 | loss: 0.7215671
	speed: 0.0081s/iter; left time: 3.1747s
	iters: 200, epoch: 7 | loss: 0.8192813
	speed: 0.0034s/iter; left time: 1.0032s
Updating learning rate to 2.6031178796875e-06
Validation loss decreased (0.6179 --> 0.6175).  Saving model state dict ...
Epoch: 7 cost time: 0.9187948703765869
Epoch: 7, Steps: 245 | Train Loss: 0.7704242 Vali Loss: 0.6175060 Best vali loss: 0.6175060
	iters: 100, epoch: 8 | loss: 1.3323441
	speed: 0.0079s/iter; left time: 1.1521s
	iters: 200, epoch: 8 | loss: 0.8191517
	speed: 0.0033s/iter; left time: 0.1529s
Updating learning rate to 1.30155893984375e-06
Validation loss decreased (0.6175 --> 0.6173).  Saving model state dict ...
Epoch: 8 cost time: 0.8727254867553711
Epoch: 8, Steps: 245 | Train Loss: 1.0757479 Vali Loss: 0.6173050 Best vali loss: 0.6173050

best validation loss 0.6173049811961638

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0014121922571, 'e_layers': 2, 'learning_rate': 0.0005012943918, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8294289
	speed: 0.0115s/iter; left time: 10.2089s
Updating learning rate to 0.0004822150100733569
Validation loss decreased (inf --> 0.6254).  Saving model state dict ...
Epoch: 1 cost time: 1.0226550102233887
Epoch: 1, Steps: 123 | Train Loss: 0.8294289 Vali Loss: 0.6253918 Best vali loss: 0.6253918
	iters: 100, epoch: 2 | loss: 0.6690421
	speed: 0.0094s/iter; left time: 7.1414s
Updating learning rate to 0.000427881527806283
Validation loss decreased (0.6254 --> 0.6105).  Saving model state dict ...
Epoch: 2 cost time: 0.7634453773498535
Epoch: 2, Steps: 123 | Train Loss: 0.6690421 Vali Loss: 0.6104951 Best vali loss: 0.6104951
	iters: 100, epoch: 3 | loss: 1.0517778
	speed: 0.0096s/iter; left time: 6.1582s
Updating learning rate to 0.00034656572513969705
Epoch: 3 cost time: 0.7857763767242432
Epoch: 3, Steps: 123 | Train Loss: 1.0517778 Vali Loss: 0.6164854 Best vali loss: 0.6104951

best validation loss 0.6104951411527045

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0061589744518, 'e_layers': 1, 'learning_rate': 0.003977029424, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8907130
	speed: 0.0102s/iter; left time: 9.0140s
Updating learning rate to 0.003977029424
Validation loss decreased (inf --> 0.5908).  Saving model state dict ...
Epoch: 1 cost time: 0.838578462600708
Epoch: 1, Steps: 123 | Train Loss: 0.8907130 Vali Loss: 0.5908237 Best vali loss: 0.5908237
	iters: 100, epoch: 2 | loss: 0.8589576
	speed: 0.0077s/iter; left time: 5.8838s
Updating learning rate to 0.001988514712
Epoch: 2 cost time: 0.5994338989257812
Epoch: 2, Steps: 123 | Train Loss: 0.8589576 Vali Loss: 0.6606843 Best vali loss: 0.5908237
	iters: 100, epoch: 3 | loss: 0.8214036
	speed: 0.0080s/iter; left time: 5.1091s
Updating learning rate to 0.000994257356
Epoch: 3 cost time: 0.585759162902832
Epoch: 3, Steps: 123 | Train Loss: 0.8214036 Vali Loss: 0.6116541 Best vali loss: 0.5908237

best validation loss 0.5908237388154965

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022668094658243945
Validation loss decreased (inf --> 0.6164).  Saving model state dict ...
Epoch: 1 cost time: 0.7696809768676758
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6163998 Best vali loss: 0.6163998
Updating learning rate to 0.0020113971511072134
Validation loss decreased (0.6164 --> 0.6012).  Saving model state dict ...
Epoch: 2 cost time: 0.5185625553131104
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6011962 Best vali loss: 0.6011962
Updating learning rate to 0.0016291456090457483
Epoch: 3 cost time: 0.5041306018829346
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6123616 Best vali loss: 0.6011962

best validation loss 0.6011962271961334

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0061589744518, 'e_layers': 1, 'learning_rate': 0.003977029424, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8678451
	speed: 0.0105s/iter; left time: 5.3934s
Updating learning rate to 0.000497128678
Epoch: 4 cost time: 0.8489525318145752
Epoch: 4, Steps: 123 | Train Loss: 0.8678451 Vali Loss: 0.6190721 Best vali loss: 0.5908237
	iters: 100, epoch: 5 | loss: 0.8016396
	speed: 0.0073s/iter; left time: 2.8561s
Updating learning rate to 0.000248564339
Epoch: 5 cost time: 0.5652065277099609
Epoch: 5, Steps: 123 | Train Loss: 0.8016396 Vali Loss: 0.6439961 Best vali loss: 0.5908237
	iters: 100, epoch: 6 | loss: 0.6959016
	speed: 0.0071s/iter; left time: 1.9265s
Updating learning rate to 0.0001242821695
Epoch: 6 cost time: 0.5405986309051514
Epoch: 6, Steps: 123 | Train Loss: 0.6959016 Vali Loss: 0.6613036 Best vali loss: 0.5908237
	iters: 100, epoch: 7 | loss: 0.7634126
	speed: 0.0072s/iter; left time: 1.0592s
Updating learning rate to 6.214108475e-05
Epoch: 7 cost time: 0.5568180084228516
Epoch: 7, Steps: 123 | Train Loss: 0.7634126 Vali Loss: 0.6624481 Best vali loss: 0.5908237
	iters: 100, epoch: 8 | loss: 0.7050017
	speed: 0.0070s/iter; left time: 0.1675s
Updating learning rate to 3.1070542375e-05
Epoch: 8 cost time: 0.5279130935668945
Epoch: 8, Steps: 123 | Train Loss: 0.7050017 Vali Loss: 0.6617439 Best vali loss: 0.5908237

best validation loss 0.5908237388154965

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0021061195851, 'e_layers': 4, 'learning_rate': 0.003460388698, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003460388698
Validation loss decreased (inf --> 0.6203).  Saving model state dict ...
Epoch: 1 cost time: 0.8371713161468506
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6202556 Best vali loss: 0.6202556
Updating learning rate to 0.001730194349
Epoch: 2 cost time: 0.584331750869751
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6294514 Best vali loss: 0.6202556
Updating learning rate to 0.0008650971745
Validation loss decreased (0.6203 --> 0.6028).  Saving model state dict ...
Epoch: 3 cost time: 0.5764286518096924
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6027512 Best vali loss: 0.6027512
Updating learning rate to 0.00043254858725
Epoch: 4 cost time: 0.5586261749267578
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6175474 Best vali loss: 0.6027512
Updating learning rate to 0.000216274293625
Epoch: 5 cost time: 0.5729978084564209
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6142619 Best vali loss: 0.6027512
Updating learning rate to 0.0001081371468125
Epoch: 6 cost time: 0.5472402572631836
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6191426 Best vali loss: 0.6027512
Updating learning rate to 5.406857340625e-05
Epoch: 7 cost time: 0.560821533203125
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6154262 Best vali loss: 0.6027512
Updating learning rate to 2.7034286703125e-05
Epoch: 8 cost time: 0.5647718906402588
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6190578 Best vali loss: 0.6027512

best validation loss 0.6027511597948458

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5009322
	speed: 0.0115s/iter; left time: 43.9419s
	iters: 200, epoch: 1 | loss: 0.8798670
	speed: 0.0057s/iter; left time: 21.3326s
	iters: 300, epoch: 1 | loss: 0.5714915
	speed: 0.0057s/iter; left time: 20.5669s
	iters: 400, epoch: 1 | loss: 1.2043145
	speed: 0.0058s/iter; left time: 20.4489s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.6330).  Saving model state dict ...
Epoch: 1 cost time: 3.1566710472106934
Epoch: 1, Steps: 490 | Train Loss: 0.7891513 Vali Loss: 0.6330394 Best vali loss: 0.6330394
	iters: 100, epoch: 2 | loss: 1.2392907
	speed: 0.0162s/iter; left time: 54.1069s
	iters: 200, epoch: 2 | loss: 0.8543264
	speed: 0.0057s/iter; left time: 18.5170s
	iters: 300, epoch: 2 | loss: 0.8910468
	speed: 0.0051s/iter; left time: 16.0711s
	iters: 400, epoch: 2 | loss: 1.0435836
	speed: 0.0049s/iter; left time: 14.7814s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 2.674321413040161
Epoch: 2, Steps: 490 | Train Loss: 1.0070619 Vali Loss: 0.6479317 Best vali loss: 0.6330394
	iters: 100, epoch: 3 | loss: 0.4683861
	speed: 0.0159s/iter; left time: 45.1858s
	iters: 200, epoch: 3 | loss: 1.2359023
	speed: 0.0061s/iter; left time: 16.5997s
	iters: 300, epoch: 3 | loss: 0.8853366
	speed: 0.0062s/iter; left time: 16.3467s
	iters: 400, epoch: 3 | loss: 0.9901602
	speed: 0.0064s/iter; left time: 16.1690s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 3.0909066200256348
Epoch: 3, Steps: 490 | Train Loss: 0.8949463 Vali Loss: 0.6459855 Best vali loss: 0.6330394
	iters: 100, epoch: 4 | loss: 0.9167213
	speed: 0.0162s/iter; left time: 38.0797s
	iters: 200, epoch: 4 | loss: 0.5791991
	speed: 0.0062s/iter; left time: 13.9873s
	iters: 300, epoch: 4 | loss: 0.4301826
	speed: 0.0061s/iter; left time: 13.2041s
	iters: 400, epoch: 4 | loss: 0.7002703
	speed: 0.0056s/iter; left time: 11.5584s
Updating learning rate to 0.00109417918315
Epoch: 4 cost time: 2.8958823680877686
Epoch: 4, Steps: 490 | Train Loss: 0.6565933 Vali Loss: 0.6444560 Best vali loss: 0.6330394
	iters: 100, epoch: 5 | loss: 0.7526001
	speed: 0.0145s/iter; left time: 26.9724s
	iters: 200, epoch: 5 | loss: 0.3637279
	speed: 0.0058s/iter; left time: 10.1886s
	iters: 300, epoch: 5 | loss: 1.0558398
	speed: 0.0061s/iter; left time: 10.1987s
	iters: 400, epoch: 5 | loss: 0.7797258
	speed: 0.0062s/iter; left time: 9.6324s
Updating learning rate to 0.0006754549377197279
Epoch: 5 cost time: 2.976033926010132
Epoch: 5, Steps: 490 | Train Loss: 0.7379734 Vali Loss: 0.6441686 Best vali loss: 0.6330394
	iters: 100, epoch: 6 | loss: 0.9303294
	speed: 0.0155s/iter; left time: 21.2728s
	iters: 200, epoch: 6 | loss: 0.8192232
	speed: 0.0056s/iter; left time: 7.1474s
	iters: 300, epoch: 6 | loss: 1.0247077
	speed: 0.0055s/iter; left time: 6.4876s
	iters: 400, epoch: 6 | loss: 0.6584862
	speed: 0.0056s/iter; left time: 6.0245s
Updating learning rate to 0.0003204776629114777
Epoch: 6 cost time: 2.78631854057312
Epoch: 6, Steps: 490 | Train Loss: 0.8581866 Vali Loss: 0.6438784 Best vali loss: 0.6330394
	iters: 100, epoch: 7 | loss: 1.9014901
	speed: 0.0144s/iter; left time: 12.6571s
	iters: 200, epoch: 7 | loss: 0.8418178
	speed: 0.0051s/iter; left time: 3.9730s
	iters: 300, epoch: 7 | loss: 0.6355394
	speed: 0.0057s/iter; left time: 3.9091s
	iters: 400, epoch: 7 | loss: 0.9048889
	speed: 0.0057s/iter; left time: 3.3184s
Updating learning rate to 8.32894309377964e-05
Epoch: 7 cost time: 2.746403455734253
Epoch: 7, Steps: 490 | Train Loss: 1.0709340 Vali Loss: 0.6334481 Best vali loss: 0.6330394
	iters: 100, epoch: 8 | loss: 0.7992470
	speed: 0.0158s/iter; left time: 6.1830s
	iters: 200, epoch: 8 | loss: 0.6054246
	speed: 0.0059s/iter; left time: 1.7144s
	iters: 300, epoch: 8 | loss: 0.8181515
	speed: 0.0060s/iter; left time: 1.1534s
	iters: 400, epoch: 8 | loss: 1.2778918
	speed: 0.0059s/iter; left time: 0.5409s
Updating learning rate to 0.0
Validation loss decreased (0.6330 --> 0.6302).  Saving model state dict ...
Epoch: 8 cost time: 2.9397060871124268
Epoch: 8, Steps: 490 | Train Loss: 0.8751787 Vali Loss: 0.6302117 Best vali loss: 0.6302117

best validation loss 0.6302116544419888

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0008377038747, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7696811
	speed: 0.0129s/iter; left time: 11.3782s
Updating learning rate to 0.0002742177349779177
Validation loss decreased (inf --> 0.6228).  Saving model state dict ...
Epoch: 1 cost time: 1.1572680473327637
Epoch: 1, Steps: 123 | Train Loss: 0.7696811 Vali Loss: 0.6227866 Best vali loss: 0.6227866
	iters: 100, epoch: 2 | loss: 0.7671317
	speed: 0.0115s/iter; left time: 8.7337s
Updating learning rate to 0.00024332030513956964
Validation loss decreased (0.6228 --> 0.6082).  Saving model state dict ...
Epoch: 2 cost time: 1.0397155284881592
Epoch: 2, Steps: 123 | Train Loss: 0.7671317 Vali Loss: 0.6081669 Best vali loss: 0.6081669
	iters: 100, epoch: 3 | loss: 0.6345880
	speed: 0.0139s/iter; left time: 8.8784s
Updating learning rate to 0.00019707903359194527
Validation loss decreased (0.6082 --> 0.6009).  Saving model state dict ...
Epoch: 3 cost time: 1.135939359664917
Epoch: 3, Steps: 123 | Train Loss: 0.6345880 Vali Loss: 0.6008666 Best vali loss: 0.6008666

best validation loss 0.600866612958886

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0028867448881, 'e_layers': 4, 'learning_rate': 0.0003383725477, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6895837
	speed: 0.0140s/iter; left time: 12.3661s
Updating learning rate to 0.0003383725477
Validation loss decreased (inf --> 0.6164).  Saving model state dict ...
Epoch: 1 cost time: 1.3291287422180176
Epoch: 1, Steps: 123 | Train Loss: 0.6895837 Vali Loss: 0.6163553 Best vali loss: 0.6163553
	iters: 100, epoch: 2 | loss: 1.0542252
	speed: 0.0139s/iter; left time: 10.5903s
Updating learning rate to 0.00016918627385
Validation loss decreased (0.6164 --> 0.6108).  Saving model state dict ...
Epoch: 2 cost time: 1.1211533546447754
Epoch: 2, Steps: 123 | Train Loss: 1.0542252 Vali Loss: 0.6107659 Best vali loss: 0.6107659
	iters: 100, epoch: 3 | loss: 0.9024897
	speed: 0.0136s/iter; left time: 8.7042s
Updating learning rate to 8.4593136925e-05
Validation loss decreased (0.6108 --> 0.6082).  Saving model state dict ...
Epoch: 3 cost time: 1.0956084728240967
Epoch: 3, Steps: 123 | Train Loss: 0.9024897 Vali Loss: 0.6082367 Best vali loss: 0.6082367

best validation loss 0.6082366800098604

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0109034907503, 'e_layers': 3, 'learning_rate': 0.0007693898904, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7637571
	speed: 0.0125s/iter; left time: 23.2812s
	iters: 200, epoch: 1 | loss: 1.0425590
	speed: 0.0064s/iter; left time: 11.2691s
Updating learning rate to 0.0007401067313308311
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 1.9372198581695557
Epoch: 1, Steps: 245 | Train Loss: 0.9031580 Vali Loss: 0.6094389 Best vali loss: 0.6094389
	iters: 100, epoch: 2 | loss: 1.0400870
	speed: 0.0126s/iter; left time: 20.4290s
	iters: 200, epoch: 2 | loss: 0.9280828
	speed: 0.0047s/iter; left time: 7.0528s
Updating learning rate to 0.0006567153496391073
Epoch: 2 cost time: 1.2626240253448486
Epoch: 2, Steps: 245 | Train Loss: 0.9840849 Vali Loss: 0.6122022 Best vali loss: 0.6094389
	iters: 100, epoch: 3 | loss: 0.6519131
	speed: 0.0098s/iter; left time: 13.4368s
	iters: 200, epoch: 3 | loss: 1.0321778
	speed: 0.0059s/iter; left time: 7.5616s
Updating learning rate to 0.0005319113272426361
Validation loss decreased (0.6094 --> 0.6086).  Saving model state dict ...
Epoch: 3 cost time: 1.4252290725708008
Epoch: 3, Steps: 245 | Train Loss: 0.8420455 Vali Loss: 0.6086294 Best vali loss: 0.6086294

best validation loss 0.6086293763995225

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0008377038747, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7019876
	speed: 0.0136s/iter; left time: 7.0130s
Updating learning rate to 0.00014253373475
Epoch: 4 cost time: 1.2852256298065186
Epoch: 4, Steps: 123 | Train Loss: 0.7019876 Vali Loss: 0.6103746 Best vali loss: 0.6008666
	iters: 100, epoch: 5 | loss: 0.7336397
	speed: 0.0107s/iter; left time: 4.2205s
Updating learning rate to 8.798843590805473e-05
Epoch: 5 cost time: 0.8854975700378418
Epoch: 5, Steps: 123 | Train Loss: 0.7336397 Vali Loss: 0.6036500 Best vali loss: 0.6008666
	iters: 100, epoch: 6 | loss: 0.6238762
	speed: 0.0139s/iter; left time: 3.7539s
Updating learning rate to 4.174716436043035e-05
Epoch: 6 cost time: 1.111741542816162
Epoch: 6, Steps: 123 | Train Loss: 0.6238762 Vali Loss: 0.6088556 Best vali loss: 0.6008666
	iters: 100, epoch: 7 | loss: 0.7205054
	speed: 0.0132s/iter; left time: 1.9363s
Updating learning rate to 1.0849734522082254e-05
Epoch: 7 cost time: 1.0472345352172852
Epoch: 7, Steps: 123 | Train Loss: 0.7205054 Vali Loss: 0.6076554 Best vali loss: 0.6008666
	iters: 100, epoch: 8 | loss: 0.8589425
	speed: 0.0104s/iter; left time: 0.2491s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.921196460723877
Epoch: 8, Steps: 123 | Train Loss: 0.8589425 Vali Loss: 0.6107311 Best vali loss: 0.6008666

best validation loss 0.600866612958886

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009909717048, 'e_layers': 2, 'learning_rate': 0.0008180744789, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6400080
	speed: 0.0094s/iter; left time: 72.6829s
	iters: 200, epoch: 1 | loss: 0.6055475
	speed: 0.0053s/iter; left time: 40.0883s
	iters: 300, epoch: 1 | loss: 0.9910614
	speed: 0.0044s/iter; left time: 33.3584s
	iters: 400, epoch: 1 | loss: 0.7700071
	speed: 0.0055s/iter; left time: 40.7425s
	iters: 500, epoch: 1 | loss: 1.0147618
	speed: 0.0051s/iter; left time: 37.4300s
	iters: 600, epoch: 1 | loss: 0.7577791
	speed: 0.0054s/iter; left time: 39.3810s
	iters: 700, epoch: 1 | loss: 1.0642651
	speed: 0.0049s/iter; left time: 35.0840s
	iters: 800, epoch: 1 | loss: 0.5713267
	speed: 0.0053s/iter; left time: 37.4846s
	iters: 900, epoch: 1 | loss: 1.0052608
	speed: 0.0050s/iter; left time: 34.3946s
Updating learning rate to 0.0007869383730127732
Validation loss decreased (inf --> 0.6344).  Saving model state dict ...
Epoch: 1 cost time: 5.214199781417847
Epoch: 1, Steps: 979 | Train Loss: 0.8244464 Vali Loss: 0.6343738 Best vali loss: 0.6343738
	iters: 100, epoch: 2 | loss: 1.3670323
	speed: 0.0138s/iter; left time: 93.3780s
	iters: 200, epoch: 2 | loss: 0.5359307
	speed: 0.0058s/iter; left time: 38.4313s
	iters: 300, epoch: 2 | loss: 0.6002864
	speed: 0.0058s/iter; left time: 37.7532s
	iters: 400, epoch: 2 | loss: 0.6287135
	speed: 0.0058s/iter; left time: 37.3973s
	iters: 500, epoch: 2 | loss: 1.5290388
	speed: 0.0059s/iter; left time: 37.4235s
	iters: 600, epoch: 2 | loss: 0.9314337
	speed: 0.0059s/iter; left time: 36.8421s
	iters: 700, epoch: 2 | loss: 1.1285213
	speed: 0.0066s/iter; left time: 40.4255s
	iters: 800, epoch: 2 | loss: 0.7300268
	speed: 0.0058s/iter; left time: 35.1442s
	iters: 900, epoch: 2 | loss: 0.6964472
	speed: 0.0056s/iter; left time: 33.5786s
Updating learning rate to 0.0006982702452229205
Validation loss decreased (0.6344 --> 0.6281).  Saving model state dict ...
Epoch: 2 cost time: 5.590434789657593
Epoch: 2, Steps: 979 | Train Loss: 0.9052701 Vali Loss: 0.6281470 Best vali loss: 0.6281470
	iters: 100, epoch: 3 | loss: 0.4168557
	speed: 0.0181s/iter; left time: 104.4667s
	iters: 200, epoch: 3 | loss: 0.4270042
	speed: 0.0036s/iter; left time: 20.5645s
	iters: 300, epoch: 3 | loss: 0.4582017
	speed: 0.0048s/iter; left time: 26.5176s
	iters: 400, epoch: 3 | loss: 0.4580621
	speed: 0.0050s/iter; left time: 27.5403s
	iters: 500, epoch: 3 | loss: 0.9961154
	speed: 0.0050s/iter; left time: 26.8166s
	iters: 600, epoch: 3 | loss: 1.2189482
	speed: 0.0047s/iter; left time: 25.0495s
	iters: 700, epoch: 3 | loss: 0.5413538
	speed: 0.0049s/iter; left time: 25.3057s
	iters: 800, epoch: 3 | loss: 1.3908805
	speed: 0.0050s/iter; left time: 25.3883s
	iters: 900, epoch: 3 | loss: 0.5441637
	speed: 0.0045s/iter; left time: 22.3915s
Updating learning rate to 0.0005655690142078671
Validation loss decreased (0.6281 --> 0.6040).  Saving model state dict ...
Epoch: 3 cost time: 4.507455825805664
Epoch: 3, Steps: 979 | Train Loss: 0.7168428 Vali Loss: 0.6039907 Best vali loss: 0.6039907
	iters: 100, epoch: 4 | loss: 0.3819971
	speed: 0.0169s/iter; left time: 80.9962s
	iters: 200, epoch: 4 | loss: 1.2662910
	speed: 0.0048s/iter; left time: 22.7568s
	iters: 300, epoch: 4 | loss: 1.6834618
	speed: 0.0049s/iter; left time: 22.6534s
	iters: 400, epoch: 4 | loss: 1.0097721
	speed: 0.0049s/iter; left time: 21.8896s
	iters: 500, epoch: 4 | loss: 1.2044719
	speed: 0.0048s/iter; left time: 21.0841s
	iters: 600, epoch: 4 | loss: 0.8044898
	speed: 0.0050s/iter; left time: 21.6291s
	iters: 700, epoch: 4 | loss: 0.4790706
	speed: 0.0048s/iter; left time: 20.2576s
	iters: 800, epoch: 4 | loss: 0.5438010
	speed: 0.0048s/iter; left time: 19.6128s
	iters: 900, epoch: 4 | loss: 1.2792808
	speed: 0.0051s/iter; left time: 20.4946s
Updating learning rate to 0.00040903723945
Epoch: 4 cost time: 4.895594596862793
Epoch: 4, Steps: 979 | Train Loss: 0.9614040 Vali Loss: 0.6201486 Best vali loss: 0.6039907
	iters: 100, epoch: 5 | loss: 0.6019640
	speed: 0.0168s/iter; left time: 63.9949s
	iters: 200, epoch: 5 | loss: 0.9391662
	speed: 0.0046s/iter; left time: 16.9554s
	iters: 300, epoch: 5 | loss: 1.0137075
	speed: 0.0048s/iter; left time: 17.3524s
	iters: 400, epoch: 5 | loss: 0.5924401
	speed: 0.0047s/iter; left time: 16.4951s
	iters: 500, epoch: 5 | loss: 0.6201000
	speed: 0.0050s/iter; left time: 16.9491s
	iters: 600, epoch: 5 | loss: 0.8750765
	speed: 0.0049s/iter; left time: 16.2263s
	iters: 700, epoch: 5 | loss: 0.5003411
	speed: 0.0052s/iter; left time: 16.6565s
	iters: 800, epoch: 5 | loss: 0.8784753
	speed: 0.0051s/iter; left time: 15.7790s
	iters: 900, epoch: 5 | loss: 1.0849466
	speed: 0.0044s/iter; left time: 13.3533s
Updating learning rate to 0.0002525054646921329
Epoch: 5 cost time: 4.705326795578003
Epoch: 5, Steps: 979 | Train Loss: 0.7895797 Vali Loss: 0.6384065 Best vali loss: 0.6039907
	iters: 100, epoch: 6 | loss: 0.4543366
	speed: 0.0165s/iter; left time: 46.6864s
	iters: 200, epoch: 6 | loss: 0.2511853
	speed: 0.0048s/iter; left time: 13.0965s
	iters: 300, epoch: 6 | loss: 1.0571146
	speed: 0.0049s/iter; left time: 13.0004s
	iters: 400, epoch: 6 | loss: 0.8205959
	speed: 0.0050s/iter; left time: 12.7674s
	iters: 500, epoch: 6 | loss: 0.3964208
	speed: 0.0047s/iter; left time: 11.3466s
	iters: 600, epoch: 6 | loss: 0.2784189
	speed: 0.0045s/iter; left time: 10.4213s
	iters: 700, epoch: 6 | loss: 1.3029187
	speed: 0.0052s/iter; left time: 11.5895s
	iters: 800, epoch: 6 | loss: 1.2205491
	speed: 0.0049s/iter; left time: 10.4150s
	iters: 900, epoch: 6 | loss: 0.5593897
	speed: 0.0050s/iter; left time: 10.1087s
Updating learning rate to 0.00011980423367707943
Validation loss decreased (0.6040 --> 0.6025).  Saving model state dict ...
Epoch: 6 cost time: 4.853159189224243
Epoch: 6, Steps: 979 | Train Loss: 0.7045477 Vali Loss: 0.6025298 Best vali loss: 0.6025298
	iters: 100, epoch: 7 | loss: 0.3991169
	speed: 0.0176s/iter; left time: 32.7576s
	iters: 200, epoch: 7 | loss: 1.3518832
	speed: 0.0043s/iter; left time: 7.5947s
	iters: 300, epoch: 7 | loss: 1.0986463
	speed: 0.0048s/iter; left time: 7.9126s
	iters: 400, epoch: 7 | loss: 0.7920451
	speed: 0.0049s/iter; left time: 7.7009s
	iters: 500, epoch: 7 | loss: 1.9646817
	speed: 0.0051s/iter; left time: 7.4773s
	iters: 600, epoch: 7 | loss: 0.3043813
	speed: 0.0052s/iter; left time: 7.0924s
	iters: 700, epoch: 7 | loss: 0.8858122
	speed: 0.0048s/iter; left time: 6.0635s
	iters: 800, epoch: 7 | loss: 1.6731833
	speed: 0.0047s/iter; left time: 5.4834s
	iters: 900, epoch: 7 | loss: 1.2050238
	speed: 0.0045s/iter; left time: 4.7533s
Updating learning rate to 3.113610588722674e-05
Epoch: 7 cost time: 4.758672475814819
Epoch: 7, Steps: 979 | Train Loss: 1.0749749 Vali Loss: 0.6174378 Best vali loss: 0.6025298
	iters: 100, epoch: 8 | loss: 0.7871179
	speed: 0.0173s/iter; left time: 15.2559s
	iters: 200, epoch: 8 | loss: 0.5583937
	speed: 0.0051s/iter; left time: 3.9629s
	iters: 300, epoch: 8 | loss: 0.5466674
	speed: 0.0048s/iter; left time: 3.2802s
	iters: 400, epoch: 8 | loss: 0.7423656
	speed: 0.0047s/iter; left time: 2.7217s
	iters: 500, epoch: 8 | loss: 1.1353136
	speed: 0.0051s/iter; left time: 2.4499s
	iters: 600, epoch: 8 | loss: 0.5864018
	speed: 0.0040s/iter; left time: 1.5157s
	iters: 700, epoch: 8 | loss: 1.8314601
	speed: 0.0037s/iter; left time: 1.0396s
	iters: 800, epoch: 8 | loss: 1.2631464
	speed: 0.0039s/iter; left time: 0.7053s
	iters: 900, epoch: 8 | loss: 0.9272029
	speed: 0.0055s/iter; left time: 0.4372s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.6994500160217285
Epoch: 8, Steps: 979 | Train Loss: 0.9308966 Vali Loss: 0.6118191 Best vali loss: 0.6025298

best validation loss 0.602529784999805

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0030171201133, 'e_layers': 4, 'learning_rate': 0.0002007150185, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3020450
	speed: 0.0129s/iter; left time: 99.7029s
	iters: 200, epoch: 1 | loss: 1.4420375
	speed: 0.0047s/iter; left time: 35.9638s
	iters: 300, epoch: 1 | loss: 0.6661633
	speed: 0.0058s/iter; left time: 43.4946s
	iters: 400, epoch: 1 | loss: 1.2181010
	speed: 0.0072s/iter; left time: 53.6298s
	iters: 500, epoch: 1 | loss: 1.1964777
	speed: 0.0071s/iter; left time: 51.8894s
	iters: 600, epoch: 1 | loss: 1.4965347
	speed: 0.0072s/iter; left time: 51.9135s
	iters: 700, epoch: 1 | loss: 0.6738027
	speed: 0.0072s/iter; left time: 51.4724s
	iters: 800, epoch: 1 | loss: 0.4184043
	speed: 0.0064s/iter; left time: 45.1145s
	iters: 900, epoch: 1 | loss: 1.7681215
	speed: 0.0050s/iter; left time: 34.5645s
Updating learning rate to 0.00019307575797988713
Validation loss decreased (inf --> 0.6224).  Saving model state dict ...
Epoch: 1 cost time: 6.527418375015259
Epoch: 1, Steps: 979 | Train Loss: 1.1312986 Vali Loss: 0.6223755 Best vali loss: 0.6223755
	iters: 100, epoch: 2 | loss: 0.4970049
	speed: 0.0204s/iter; left time: 138.0729s
	iters: 200, epoch: 2 | loss: 0.6576107
	speed: 0.0066s/iter; left time: 43.6025s
	iters: 300, epoch: 2 | loss: 0.7578825
	speed: 0.0064s/iter; left time: 42.1265s
	iters: 400, epoch: 2 | loss: 0.4020095
	speed: 0.0062s/iter; left time: 40.1477s
	iters: 500, epoch: 2 | loss: 1.3773295
	speed: 0.0064s/iter; left time: 40.5751s
	iters: 600, epoch: 2 | loss: 0.8060517
	speed: 0.0065s/iter; left time: 40.6271s
	iters: 700, epoch: 2 | loss: 0.3285432
	speed: 0.0062s/iter; left time: 38.2318s
	iters: 800, epoch: 2 | loss: 0.4678977
	speed: 0.0058s/iter; left time: 35.2848s
	iters: 900, epoch: 2 | loss: 0.6805590
	speed: 0.0052s/iter; left time: 31.1858s
Updating learning rate to 0.00017132098458366666
Validation loss decreased (0.6224 --> 0.6049).  Saving model state dict ...
Epoch: 2 cost time: 6.139190196990967
Epoch: 2, Steps: 979 | Train Loss: 0.6638765 Vali Loss: 0.6049432 Best vali loss: 0.6049432
	iters: 100, epoch: 3 | loss: 0.9512199
	speed: 0.0208s/iter; left time: 120.0045s
	iters: 200, epoch: 3 | loss: 1.2642176
	speed: 0.0063s/iter; left time: 35.6928s
	iters: 300, epoch: 3 | loss: 1.2409538
	speed: 0.0062s/iter; left time: 34.7837s
	iters: 400, epoch: 3 | loss: 0.6176002
	speed: 0.0063s/iter; left time: 34.2491s
	iters: 500, epoch: 3 | loss: 0.3999360
	speed: 0.0063s/iter; left time: 33.7909s
	iters: 600, epoch: 3 | loss: 0.8766086
	speed: 0.0065s/iter; left time: 34.0929s
	iters: 700, epoch: 3 | loss: 0.5198666
	speed: 0.0065s/iter; left time: 33.5283s
	iters: 800, epoch: 3 | loss: 0.7175505
	speed: 0.0063s/iter; left time: 32.1752s
	iters: 900, epoch: 3 | loss: 0.8813794
	speed: 0.0061s/iter; left time: 30.5052s
Updating learning rate to 0.00013876266535340126
Validation loss decreased (0.6049 --> 0.6012).  Saving model state dict ...
Epoch: 3 cost time: 6.239698648452759
Epoch: 3, Steps: 979 | Train Loss: 0.8299258 Vali Loss: 0.6012354 Best vali loss: 0.6012354
	iters: 100, epoch: 4 | loss: 0.7309558
	speed: 0.0207s/iter; left time: 99.1985s
	iters: 200, epoch: 4 | loss: 0.6325647
	speed: 0.0064s/iter; left time: 29.9981s
	iters: 300, epoch: 4 | loss: 0.4745564
	speed: 0.0049s/iter; left time: 22.4998s
	iters: 400, epoch: 4 | loss: 0.4973388
	speed: 0.0048s/iter; left time: 21.3931s
	iters: 500, epoch: 4 | loss: 0.4729252
	speed: 0.0047s/iter; left time: 20.5952s
	iters: 600, epoch: 4 | loss: 0.5790127
	speed: 0.0053s/iter; left time: 22.6768s
	iters: 700, epoch: 4 | loss: 0.9257312
	speed: 0.0066s/iter; left time: 27.7557s
	iters: 800, epoch: 4 | loss: 1.1403934
	speed: 0.0067s/iter; left time: 27.6207s
	iters: 900, epoch: 4 | loss: 0.8211203
	speed: 0.0068s/iter; left time: 27.0436s
Updating learning rate to 0.00010035750925
Validation loss decreased (0.6012 --> 0.5991).  Saving model state dict ...
Epoch: 4 cost time: 5.854487180709839
Epoch: 4, Steps: 979 | Train Loss: 0.6971776 Vali Loss: 0.5990823 Best vali loss: 0.5990823
	iters: 100, epoch: 5 | loss: 0.3959809
	speed: 0.0218s/iter; left time: 83.2149s
	iters: 200, epoch: 5 | loss: 0.5334040
	speed: 0.0064s/iter; left time: 23.7987s
	iters: 300, epoch: 5 | loss: 0.3427046
	speed: 0.0071s/iter; left time: 25.7887s
	iters: 400, epoch: 5 | loss: 1.2583963
	speed: 0.0073s/iter; left time: 25.6581s
	iters: 500, epoch: 5 | loss: 1.1493603
	speed: 0.0072s/iter; left time: 24.7334s
	iters: 600, epoch: 5 | loss: 0.8179461
	speed: 0.0070s/iter; left time: 23.3519s
	iters: 700, epoch: 5 | loss: 0.2523725
	speed: 0.0070s/iter; left time: 22.5648s
	iters: 800, epoch: 5 | loss: 0.6206097
	speed: 0.0068s/iter; left time: 21.2714s
	iters: 900, epoch: 5 | loss: 0.4838978
	speed: 0.0058s/iter; left time: 17.5300s
Updating learning rate to 6.195235314659876e-05
Epoch: 5 cost time: 6.656980752944946
Epoch: 5, Steps: 979 | Train Loss: 0.6505191 Vali Loss: 0.6019371 Best vali loss: 0.5990823
	iters: 100, epoch: 6 | loss: 1.0880213
	speed: 0.0216s/iter; left time: 61.2520s
	iters: 200, epoch: 6 | loss: 1.4422787
	speed: 0.0068s/iter; left time: 18.4860s
	iters: 300, epoch: 6 | loss: 0.8558538
	speed: 0.0068s/iter; left time: 17.9614s
	iters: 400, epoch: 6 | loss: 0.3989921
	speed: 0.0069s/iter; left time: 17.4241s
	iters: 500, epoch: 6 | loss: 0.5507328
	speed: 0.0061s/iter; left time: 14.8716s
	iters: 600, epoch: 6 | loss: 0.7661749
	speed: 0.0064s/iter; left time: 14.8682s
	iters: 700, epoch: 6 | loss: 1.6285924
	speed: 0.0068s/iter; left time: 15.2668s
	iters: 800, epoch: 6 | loss: 0.7949037
	speed: 0.0067s/iter; left time: 14.2976s
	iters: 900, epoch: 6 | loss: 0.4847216
	speed: 0.0069s/iter; left time: 14.0215s
Updating learning rate to 2.9394033916333338e-05
Epoch: 6 cost time: 6.622387409210205
Epoch: 6, Steps: 979 | Train Loss: 0.8900301 Vali Loss: 0.6037136 Best vali loss: 0.5990823
	iters: 100, epoch: 7 | loss: 0.3192811
	speed: 0.0214s/iter; left time: 39.7904s
	iters: 200, epoch: 7 | loss: 0.8314433
	speed: 0.0065s/iter; left time: 11.3484s
	iters: 300, epoch: 7 | loss: 0.5739384
	speed: 0.0068s/iter; left time: 11.2938s
	iters: 400, epoch: 7 | loss: 0.5627944
	speed: 0.0068s/iter; left time: 10.5585s
	iters: 500, epoch: 7 | loss: 0.7192209
	speed: 0.0068s/iter; left time: 9.8893s
	iters: 600, epoch: 7 | loss: 0.9152159
	speed: 0.0069s/iter; left time: 9.3148s
	iters: 700, epoch: 7 | loss: 0.7603102
	speed: 0.0069s/iter; left time: 8.6976s
	iters: 800, epoch: 7 | loss: 0.2817324
	speed: 0.0065s/iter; left time: 7.5028s
	iters: 900, epoch: 7 | loss: 0.5199729
	speed: 0.0056s/iter; left time: 5.9692s
Updating learning rate to 7.639260520112865e-06
Epoch: 7 cost time: 6.433427333831787
Epoch: 7, Steps: 979 | Train Loss: 0.6093233 Vali Loss: 0.6029601 Best vali loss: 0.5990823
	iters: 100, epoch: 8 | loss: 1.2245709
	speed: 0.0221s/iter; left time: 19.4778s
	iters: 200, epoch: 8 | loss: 0.6012009
	speed: 0.0069s/iter; left time: 5.4064s
	iters: 300, epoch: 8 | loss: 1.0509233
	speed: 0.0071s/iter; left time: 4.7949s
	iters: 400, epoch: 8 | loss: 1.3049192
	speed: 0.0065s/iter; left time: 3.7489s
	iters: 500, epoch: 8 | loss: 0.2714421
	speed: 0.0060s/iter; left time: 2.8862s
	iters: 600, epoch: 8 | loss: 1.1481223
	speed: 0.0069s/iter; left time: 2.6189s
	iters: 700, epoch: 8 | loss: 0.9276177
	speed: 0.0068s/iter; left time: 1.9122s
	iters: 800, epoch: 8 | loss: 0.6771265
	speed: 0.0068s/iter; left time: 1.2322s
	iters: 900, epoch: 8 | loss: 0.9641461
	speed: 0.0067s/iter; left time: 0.5371s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.65624737739563
Epoch: 8, Steps: 979 | Train Loss: 0.9077855 Vali Loss: 0.6049004 Best vali loss: 0.5990823

best validation loss 0.5990823209147826

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8019623
	speed: 0.0130s/iter; left time: 24.1555s
	iters: 200, epoch: 1 | loss: 0.6541380
	speed: 0.0073s/iter; left time: 12.8904s
Updating learning rate to 0.0002850674695
Validation loss decreased (inf --> 0.6108).  Saving model state dict ...
Epoch: 1 cost time: 2.076774835586548
Epoch: 1, Steps: 245 | Train Loss: 0.7280501 Vali Loss: 0.6108487 Best vali loss: 0.6108487
	iters: 100, epoch: 2 | loss: 0.7041177
	speed: 0.0139s/iter; left time: 22.4666s
	iters: 200, epoch: 2 | loss: 1.2705004
	speed: 0.0071s/iter; left time: 10.8084s
Updating learning rate to 0.00014253373475
Validation loss decreased (0.6108 --> 0.6054).  Saving model state dict ...
Epoch: 2 cost time: 1.786039113998413
Epoch: 2, Steps: 245 | Train Loss: 0.9873091 Vali Loss: 0.6053971 Best vali loss: 0.6053971
	iters: 100, epoch: 3 | loss: 0.8909091
	speed: 0.0117s/iter; left time: 16.0074s
	iters: 200, epoch: 3 | loss: 0.7863232
	speed: 0.0061s/iter; left time: 7.7188s
Updating learning rate to 7.1266867375e-05
Validation loss decreased (0.6054 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 1.5000507831573486
Epoch: 3, Steps: 245 | Train Loss: 0.8386162 Vali Loss: 0.6031098 Best vali loss: 0.6031098

best validation loss 0.6031098497901345

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008267342166, 'e_layers': 4, 'learning_rate': 5.54518777e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7334877
	speed: 0.0127s/iter; left time: 11.2103s
Updating learning rate to 5.3341366273174527e-05
Validation loss decreased (inf --> 0.6959).  Saving model state dict ...
Epoch: 1 cost time: 1.1453514099121094
Epoch: 1, Steps: 123 | Train Loss: 0.7334877 Vali Loss: 0.6958525 Best vali loss: 0.6958525
	iters: 100, epoch: 2 | loss: 0.8157593
	speed: 0.0104s/iter; left time: 7.9546s
Updating learning rate to 4.733113822559855e-05
Validation loss decreased (0.6959 --> 0.6802).  Saving model state dict ...
Epoch: 2 cost time: 0.8671445846557617
Epoch: 2, Steps: 123 | Train Loss: 0.8157593 Vali Loss: 0.6802234 Best vali loss: 0.6802234
	iters: 100, epoch: 3 | loss: 0.7322897
	speed: 0.0105s/iter; left time: 6.7120s
Updating learning rate to 3.833619629466259e-05
Validation loss decreased (0.6802 --> 0.6684).  Saving model state dict ...
Epoch: 3 cost time: 0.8786280155181885
Epoch: 3, Steps: 123 | Train Loss: 0.7322897 Vali Loss: 0.6683783 Best vali loss: 0.6683783

best validation loss 0.6683783261988904

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010382705628, 'e_layers': 3, 'learning_rate': 0.0008045612191, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6424699
	speed: 0.0112s/iter; left time: 20.9123s
	iters: 200, epoch: 1 | loss: 1.1307547
	speed: 0.0054s/iter; left time: 9.5001s
Updating learning rate to 0.0007739394310394095
Validation loss decreased (inf --> 0.6397).  Saving model state dict ...
Epoch: 1 cost time: 1.6185507774353027
Epoch: 1, Steps: 245 | Train Loss: 0.8866123 Vali Loss: 0.6396685 Best vali loss: 0.6396685
	iters: 100, epoch: 2 | loss: 1.1353147
	speed: 0.0113s/iter; left time: 18.2808s
	iters: 200, epoch: 2 | loss: 0.5825636
	speed: 0.0060s/iter; left time: 9.0389s
Updating learning rate to 0.0006867359565026628
Validation loss decreased (0.6397 --> 0.6258).  Saving model state dict ...
Epoch: 2 cost time: 1.4653823375701904
Epoch: 2, Steps: 245 | Train Loss: 0.8589391 Vali Loss: 0.6258097 Best vali loss: 0.6258097
	iters: 100, epoch: 3 | loss: 0.8610868
	speed: 0.0114s/iter; left time: 15.6674s
	iters: 200, epoch: 3 | loss: 0.9762009
	speed: 0.0058s/iter; left time: 7.3447s
Updating learning rate to 0.0005562267339865145
Validation loss decreased (0.6258 --> 0.6206).  Saving model state dict ...
Epoch: 3 cost time: 1.4634051322937012
Epoch: 3, Steps: 245 | Train Loss: 0.9186439 Vali Loss: 0.6206198 Best vali loss: 0.6206198

best validation loss 0.6206197764022876

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7727725
	speed: 0.0126s/iter; left time: 14.2076s
	iters: 200, epoch: 4 | loss: 0.6620820
	speed: 0.0066s/iter; left time: 6.7486s
Updating learning rate to 3.56334336875e-05
Validation loss decreased (0.6031 --> 0.6008).  Saving model state dict ...
Epoch: 4 cost time: 1.9114809036254883
Epoch: 4, Steps: 245 | Train Loss: 0.7174272 Vali Loss: 0.6008225 Best vali loss: 0.6008225
	iters: 100, epoch: 5 | loss: 0.6805810
	speed: 0.0121s/iter; left time: 10.6875s
	iters: 200, epoch: 5 | loss: 1.1876156
	speed: 0.0064s/iter; left time: 5.0134s
Updating learning rate to 1.781671684375e-05
Epoch: 5 cost time: 1.595679521560669
Epoch: 5, Steps: 245 | Train Loss: 0.9340983 Vali Loss: 0.6033912 Best vali loss: 0.6008225
	iters: 100, epoch: 6 | loss: 0.8846529
	speed: 0.0120s/iter; left time: 7.6370s
	iters: 200, epoch: 6 | loss: 0.7570381
	speed: 0.0063s/iter; left time: 3.3726s
Updating learning rate to 8.908358421875e-06
Epoch: 6 cost time: 1.5890929698944092
Epoch: 6, Steps: 245 | Train Loss: 0.8208455 Vali Loss: 0.6045402 Best vali loss: 0.6008225
	iters: 100, epoch: 7 | loss: 0.6771476
	speed: 0.0121s/iter; left time: 4.7202s
	iters: 200, epoch: 7 | loss: 1.0625193
	speed: 0.0062s/iter; left time: 1.8129s
Updating learning rate to 4.4541792109375e-06
Epoch: 7 cost time: 1.5773801803588867
Epoch: 7, Steps: 245 | Train Loss: 0.8698335 Vali Loss: 0.6016258 Best vali loss: 0.6008225
	iters: 100, epoch: 8 | loss: 0.7219322
	speed: 0.0122s/iter; left time: 1.7835s
	iters: 200, epoch: 8 | loss: 0.5544795
	speed: 0.0064s/iter; left time: 0.2944s
Updating learning rate to 2.22708960546875e-06
Epoch: 8 cost time: 1.6385557651519775
Epoch: 8, Steps: 245 | Train Loss: 0.6382059 Vali Loss: 0.6015844 Best vali loss: 0.6008225

best validation loss 0.600822522457084

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0102976635799, 'e_layers': 4, 'learning_rate': 9.28932504e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4144005
	speed: 0.0119s/iter; left time: 45.4483s
	iters: 200, epoch: 1 | loss: 1.6388465
	speed: 0.0063s/iter; left time: 23.4653s
	iters: 300, epoch: 1 | loss: 0.6976915
	speed: 0.0062s/iter; left time: 22.4772s
	iters: 400, epoch: 1 | loss: 0.4239677
	speed: 0.0062s/iter; left time: 21.9645s
Updating learning rate to 8.935771157650295e-05
Validation loss decreased (inf --> 0.6275).  Saving model state dict ...
Epoch: 1 cost time: 3.3426437377929688
Epoch: 1, Steps: 490 | Train Loss: 1.0437266 Vali Loss: 0.6275476 Best vali loss: 0.6275476
	iters: 100, epoch: 2 | loss: 0.5277933
	speed: 0.0164s/iter; left time: 54.4931s
	iters: 200, epoch: 2 | loss: 0.3011818
	speed: 0.0065s/iter; left time: 20.9930s
	iters: 300, epoch: 2 | loss: 0.9425450
	speed: 0.0063s/iter; left time: 19.6807s
	iters: 400, epoch: 2 | loss: 0.7618495
	speed: 0.0061s/iter; left time: 18.4695s
Updating learning rate to 7.928934884214998e-05
Validation loss decreased (0.6275 --> 0.6139).  Saving model state dict ...
Epoch: 2 cost time: 3.08420729637146
Epoch: 2, Steps: 490 | Train Loss: 0.6333424 Vali Loss: 0.6139179 Best vali loss: 0.6139179
	iters: 100, epoch: 3 | loss: 1.4177033
	speed: 0.0157s/iter; left time: 44.5338s
	iters: 200, epoch: 3 | loss: 0.4200510
	speed: 0.0063s/iter; left time: 17.2039s
	iters: 300, epoch: 3 | loss: 0.7097206
	speed: 0.0066s/iter; left time: 17.3133s
	iters: 400, epoch: 3 | loss: 0.6483535
	speed: 0.0062s/iter; left time: 15.6844s
Updating learning rate to 6.422097915331089e-05
Validation loss decreased (0.6139 --> 0.6089).  Saving model state dict ...
Epoch: 3 cost time: 3.142868757247925
Epoch: 3, Steps: 490 | Train Loss: 0.7989571 Vali Loss: 0.6088998 Best vali loss: 0.6088998
	iters: 100, epoch: 4 | loss: 1.1521709
	speed: 0.0167s/iter; left time: 39.3477s
	iters: 200, epoch: 4 | loss: 0.6875635
	speed: 0.0064s/iter; left time: 14.3988s
	iters: 300, epoch: 4 | loss: 0.5823684
	speed: 0.0066s/iter; left time: 14.1341s
	iters: 400, epoch: 4 | loss: 0.8755265
	speed: 0.0062s/iter; left time: 12.7694s
Updating learning rate to 4.64466252e-05
Validation loss decreased (0.6089 --> 0.6051).  Saving model state dict ...
Epoch: 4 cost time: 3.174447536468506
Epoch: 4, Steps: 490 | Train Loss: 0.8244073 Vali Loss: 0.6051406 Best vali loss: 0.6051406
	iters: 100, epoch: 5 | loss: 0.8907589
	speed: 0.0162s/iter; left time: 30.2246s
	iters: 200, epoch: 5 | loss: 0.8502005
	speed: 0.0062s/iter; left time: 10.9129s
	iters: 300, epoch: 5 | loss: 0.9957966
	speed: 0.0062s/iter; left time: 10.3084s
	iters: 400, epoch: 5 | loss: 0.7886836
	speed: 0.0062s/iter; left time: 9.7290s
Updating learning rate to 2.8672271246689127e-05
Epoch: 5 cost time: 3.0700502395629883
Epoch: 5, Steps: 490 | Train Loss: 0.8813599 Vali Loss: 0.6095328 Best vali loss: 0.6051406
	iters: 100, epoch: 6 | loss: 1.0097783
	speed: 0.0166s/iter; left time: 22.7422s
	iters: 200, epoch: 6 | loss: 0.9042564
	speed: 0.0067s/iter; left time: 8.5488s
	iters: 300, epoch: 6 | loss: 0.7723026
	speed: 0.0070s/iter; left time: 8.1865s
	iters: 400, epoch: 6 | loss: 1.1208152
	speed: 0.0068s/iter; left time: 7.2425s
Updating learning rate to 1.3603901557850019e-05
Validation loss decreased (0.6051 --> 0.6041).  Saving model state dict ...
Epoch: 6 cost time: 3.370905637741089
Epoch: 6, Steps: 490 | Train Loss: 0.9517881 Vali Loss: 0.6041217 Best vali loss: 0.6041217
	iters: 100, epoch: 7 | loss: 1.2035240
	speed: 0.0173s/iter; left time: 15.2832s
	iters: 200, epoch: 7 | loss: 0.8595161
	speed: 0.0068s/iter; left time: 5.2746s
	iters: 300, epoch: 7 | loss: 1.0342245
	speed: 0.0067s/iter; left time: 4.5820s
	iters: 400, epoch: 7 | loss: 0.5560235
	speed: 0.0067s/iter; left time: 3.9104s
Updating learning rate to 3.53553882349705e-06
Validation loss decreased (0.6041 --> 0.6017).  Saving model state dict ...
Epoch: 7 cost time: 3.3218259811401367
Epoch: 7, Steps: 490 | Train Loss: 0.9133220 Vali Loss: 0.6017337 Best vali loss: 0.6017337
	iters: 100, epoch: 8 | loss: 0.6610753
	speed: 0.0170s/iter; left time: 6.6406s
	iters: 200, epoch: 8 | loss: 0.4376619
	speed: 0.0063s/iter; left time: 1.8408s
	iters: 300, epoch: 8 | loss: 1.1957955
	speed: 0.0063s/iter; left time: 1.1983s
	iters: 400, epoch: 8 | loss: 0.7052337
	speed: 0.0062s/iter; left time: 0.5615s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1422119140625
Epoch: 8, Steps: 490 | Train Loss: 0.7499416 Vali Loss: 0.6048369 Best vali loss: 0.6017337

best validation loss 0.6017337350975523

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043224728456, 'e_layers': 3, 'learning_rate': 0.0008063623482, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5214986
	speed: 0.0105s/iter; left time: 81.1958s
	iters: 200, epoch: 1 | loss: 0.2551914
	speed: 0.0049s/iter; left time: 37.0317s
	iters: 300, epoch: 1 | loss: 0.6340424
	speed: 0.0049s/iter; left time: 36.9689s
	iters: 400, epoch: 1 | loss: 0.4047925
	speed: 0.0051s/iter; left time: 37.8416s
	iters: 500, epoch: 1 | loss: 0.4821593
	speed: 0.0048s/iter; left time: 35.4999s
	iters: 600, epoch: 1 | loss: 1.4875145
	speed: 0.0049s/iter; left time: 35.7236s
	iters: 700, epoch: 1 | loss: 0.2812949
	speed: 0.0050s/iter; left time: 35.4662s
	iters: 800, epoch: 1 | loss: 1.1013232
	speed: 0.0055s/iter; left time: 38.3872s
	iters: 900, epoch: 1 | loss: 1.2026640
	speed: 0.0058s/iter; left time: 40.1718s
Updating learning rate to 0.0008063623482
Validation loss decreased (inf --> 0.6152).  Saving model state dict ...
Epoch: 1 cost time: 5.300082683563232
Epoch: 1, Steps: 979 | Train Loss: 0.7078312 Vali Loss: 0.6151528 Best vali loss: 0.6151528
	iters: 100, epoch: 2 | loss: 0.6832612
	speed: 0.0163s/iter; left time: 109.9096s
	iters: 200, epoch: 2 | loss: 0.4566386
	speed: 0.0047s/iter; left time: 31.1976s
	iters: 300, epoch: 2 | loss: 0.5909889
	speed: 0.0044s/iter; left time: 28.6323s
	iters: 400, epoch: 2 | loss: 0.6589931
	speed: 0.0039s/iter; left time: 25.1495s
	iters: 500, epoch: 2 | loss: 0.7307956
	speed: 0.0042s/iter; left time: 26.7458s
	iters: 600, epoch: 2 | loss: 0.4784614
	speed: 0.0061s/iter; left time: 38.1006s
	iters: 700, epoch: 2 | loss: 1.4482424
	speed: 0.0060s/iter; left time: 37.2265s
	iters: 800, epoch: 2 | loss: 0.7651643
	speed: 0.0059s/iter; left time: 35.4383s
	iters: 900, epoch: 2 | loss: 0.6476273
	speed: 0.0056s/iter; left time: 33.6283s
Updating learning rate to 0.0004031811741
Epoch: 2 cost time: 5.066025733947754
Epoch: 2, Steps: 979 | Train Loss: 0.7177970 Vali Loss: 0.6186421 Best vali loss: 0.6151528
	iters: 100, epoch: 3 | loss: 0.8949465
	speed: 0.0185s/iter; left time: 107.1130s
	iters: 200, epoch: 3 | loss: 1.2358364
	speed: 0.0060s/iter; left time: 34.0386s
	iters: 300, epoch: 3 | loss: 0.8809061
	speed: 0.0059s/iter; left time: 32.9452s
	iters: 400, epoch: 3 | loss: 0.3383062
	speed: 0.0060s/iter; left time: 32.9470s
	iters: 500, epoch: 3 | loss: 0.8995627
	speed: 0.0040s/iter; left time: 21.5454s
	iters: 600, epoch: 3 | loss: 0.5836804
	speed: 0.0038s/iter; left time: 20.0328s
	iters: 700, epoch: 3 | loss: 0.8247617
	speed: 0.0054s/iter; left time: 27.9769s
	iters: 800, epoch: 3 | loss: 0.6761551
	speed: 0.0059s/iter; left time: 30.1297s
	iters: 900, epoch: 3 | loss: 0.8338418
	speed: 0.0061s/iter; left time: 30.1093s
Updating learning rate to 0.00020159058705
Validation loss decreased (0.6152 --> 0.6117).  Saving model state dict ...
Epoch: 3 cost time: 5.398526668548584
Epoch: 3, Steps: 979 | Train Loss: 0.7964441 Vali Loss: 0.6117361 Best vali loss: 0.6117361
	iters: 100, epoch: 4 | loss: 1.4495522
	speed: 0.0191s/iter; left time: 91.6020s
	iters: 200, epoch: 4 | loss: 0.9183628
	speed: 0.0040s/iter; left time: 18.5862s
	iters: 300, epoch: 4 | loss: 0.5694261
	speed: 0.0041s/iter; left time: 18.9871s
	iters: 400, epoch: 4 | loss: 0.5218096
	speed: 0.0062s/iter; left time: 27.7647s
	iters: 500, epoch: 4 | loss: 1.1809348
	speed: 0.0064s/iter; left time: 27.9566s
	iters: 600, epoch: 4 | loss: 0.3114652
	speed: 0.0059s/iter; left time: 25.3441s
	iters: 700, epoch: 4 | loss: 1.5253662
	speed: 0.0058s/iter; left time: 24.3233s
	iters: 800, epoch: 4 | loss: 0.4671185
	speed: 0.0063s/iter; left time: 25.6447s
	iters: 900, epoch: 4 | loss: 0.8549185
	speed: 0.0060s/iter; left time: 23.9836s
Updating learning rate to 0.000100795293525
Epoch: 4 cost time: 5.539702653884888
Epoch: 4, Steps: 979 | Train Loss: 0.8665504 Vali Loss: 0.6123766 Best vali loss: 0.6117361
	iters: 100, epoch: 5 | loss: 0.7368923
	speed: 0.0201s/iter; left time: 76.6844s
	iters: 200, epoch: 5 | loss: 0.4644878
	speed: 0.0048s/iter; left time: 17.9058s
	iters: 300, epoch: 5 | loss: 0.7791085
	speed: 0.0038s/iter; left time: 13.5985s
	iters: 400, epoch: 5 | loss: 0.5674208
	speed: 0.0040s/iter; left time: 14.2372s
	iters: 500, epoch: 5 | loss: 0.4852372
	speed: 0.0060s/iter; left time: 20.6314s
	iters: 600, epoch: 5 | loss: 1.0282085
	speed: 0.0059s/iter; left time: 19.5984s
	iters: 700, epoch: 5 | loss: 0.4221786
	speed: 0.0060s/iter; left time: 19.3273s
	iters: 800, epoch: 5 | loss: 0.3966974
	speed: 0.0057s/iter; left time: 17.8129s
	iters: 900, epoch: 5 | loss: 0.5342939
	speed: 0.0062s/iter; left time: 18.7451s
Updating learning rate to 5.03976467625e-05
Epoch: 5 cost time: 5.388929843902588
Epoch: 5, Steps: 979 | Train Loss: 0.6016139 Vali Loss: 0.6121696 Best vali loss: 0.6117361
	iters: 100, epoch: 6 | loss: 0.4789604
	speed: 0.0195s/iter; left time: 55.4129s
	iters: 200, epoch: 6 | loss: 1.8725480
	speed: 0.0060s/iter; left time: 16.2952s
	iters: 300, epoch: 6 | loss: 0.6045519
	speed: 0.0060s/iter; left time: 15.8628s
	iters: 400, epoch: 6 | loss: 0.3990910
	speed: 0.0059s/iter; left time: 14.9377s
	iters: 500, epoch: 6 | loss: 0.4831603
	speed: 0.0061s/iter; left time: 14.7898s
	iters: 600, epoch: 6 | loss: 0.8462847
	speed: 0.0058s/iter; left time: 13.6606s
	iters: 700, epoch: 6 | loss: 1.1462801
	speed: 0.0056s/iter; left time: 12.4751s
	iters: 800, epoch: 6 | loss: 0.8528013
	speed: 0.0061s/iter; left time: 12.9879s
	iters: 900, epoch: 6 | loss: 0.9635389
	speed: 0.0060s/iter; left time: 12.1781s
Updating learning rate to 2.519882338125e-05
Epoch: 6 cost time: 5.851645469665527
Epoch: 6, Steps: 979 | Train Loss: 0.8496907 Vali Loss: 0.6147403 Best vali loss: 0.6117361
	iters: 100, epoch: 7 | loss: 1.2235473
	speed: 0.0152s/iter; left time: 28.3335s
	iters: 200, epoch: 7 | loss: 1.4762840
	speed: 0.0059s/iter; left time: 10.4444s
	iters: 300, epoch: 7 | loss: 0.3481233
	speed: 0.0059s/iter; left time: 9.8398s
	iters: 400, epoch: 7 | loss: 0.4894183
	speed: 0.0059s/iter; left time: 9.1839s
	iters: 500, epoch: 7 | loss: 1.2289423
	speed: 0.0059s/iter; left time: 8.5652s
	iters: 600, epoch: 7 | loss: 0.3885403
	speed: 0.0059s/iter; left time: 8.0768s
	iters: 700, epoch: 7 | loss: 1.1511661
	speed: 0.0056s/iter; left time: 7.0658s
	iters: 800, epoch: 7 | loss: 0.4282420
	speed: 0.0057s/iter; left time: 6.6188s
	iters: 900, epoch: 7 | loss: 0.4642322
	speed: 0.0059s/iter; left time: 6.2148s
Updating learning rate to 1.2599411690625e-05
Epoch: 7 cost time: 5.6397600173950195
Epoch: 7, Steps: 979 | Train Loss: 0.7998329 Vali Loss: 0.6171167 Best vali loss: 0.6117361
	iters: 100, epoch: 8 | loss: 0.9592810
	speed: 0.0188s/iter; left time: 16.5375s
	iters: 200, epoch: 8 | loss: 0.6462068
	speed: 0.0059s/iter; left time: 4.5778s
	iters: 300, epoch: 8 | loss: 0.6044869
	speed: 0.0057s/iter; left time: 3.8832s
	iters: 400, epoch: 8 | loss: 0.7544743
	speed: 0.0058s/iter; left time: 3.3602s
	iters: 500, epoch: 8 | loss: 0.7840224
	speed: 0.0059s/iter; left time: 2.8509s
	iters: 600, epoch: 8 | loss: 1.0484562
	speed: 0.0060s/iter; left time: 2.2904s
	iters: 700, epoch: 8 | loss: 0.2868139
	speed: 0.0059s/iter; left time: 1.6402s
	iters: 800, epoch: 8 | loss: 0.7702367
	speed: 0.0058s/iter; left time: 1.0440s
	iters: 900, epoch: 8 | loss: 0.7850459
	speed: 0.0055s/iter; left time: 0.4369s
Updating learning rate to 6.2997058453125e-06
Epoch: 8 cost time: 5.735381603240967
Epoch: 8, Steps: 979 | Train Loss: 0.7376693 Vali Loss: 0.6176537 Best vali loss: 0.6117361

best validation loss 0.6117360726074729

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0066694129125, 'e_layers': 1, 'learning_rate': 0.0002333035787, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7444770
	speed: 0.0106s/iter; left time: 19.8015s
	iters: 200, epoch: 1 | loss: 1.1599921
	speed: 0.0040s/iter; left time: 7.0929s
Updating learning rate to 0.0002333035787
Validation loss decreased (inf --> 0.6497).  Saving model state dict ...
Epoch: 1 cost time: 1.3789114952087402
Epoch: 1, Steps: 245 | Train Loss: 0.9522346 Vali Loss: 0.6497282 Best vali loss: 0.6497282
	iters: 100, epoch: 2 | loss: 0.5761602
	speed: 0.0095s/iter; left time: 15.2969s
	iters: 200, epoch: 2 | loss: 0.8879815
	speed: 0.0041s/iter; left time: 6.2048s
Updating learning rate to 0.00011665178935
Validation loss decreased (0.6497 --> 0.6201).  Saving model state dict ...
Epoch: 2 cost time: 1.0869295597076416
Epoch: 2, Steps: 245 | Train Loss: 0.7320709 Vali Loss: 0.6201481 Best vali loss: 0.6201481
	iters: 100, epoch: 3 | loss: 0.7461416
	speed: 0.0094s/iter; left time: 12.9207s
	iters: 200, epoch: 3 | loss: 0.5615115
	speed: 0.0042s/iter; left time: 5.3801s
Updating learning rate to 5.8325894675e-05
Validation loss decreased (0.6201 --> 0.6135).  Saving model state dict ...
Epoch: 3 cost time: 1.0841140747070312
Epoch: 3, Steps: 245 | Train Loss: 0.6538265 Vali Loss: 0.6134532 Best vali loss: 0.6134532

best validation loss 0.613453184383327

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8159195
	speed: 0.0118s/iter; left time: 21.9299s
	iters: 200, epoch: 1 | loss: 0.4898904
	speed: 0.0060s/iter; left time: 10.6442s
Updating learning rate to 0.00017249420488318464
Validation loss decreased (inf --> 0.6185).  Saving model state dict ...
Epoch: 1 cost time: 1.8108773231506348
Epoch: 1, Steps: 245 | Train Loss: 0.6529049 Vali Loss: 0.6185257 Best vali loss: 0.6185257
	iters: 100, epoch: 2 | loss: 1.1594396
	speed: 0.0129s/iter; left time: 20.8075s
	iters: 200, epoch: 2 | loss: 1.0125533
	speed: 0.0063s/iter; left time: 9.5306s
Updating learning rate to 0.0001530584539703962
Validation loss decreased (0.6185 --> 0.5543).  Saving model state dict ...
Epoch: 2 cost time: 1.576629400253296
Epoch: 2, Steps: 245 | Train Loss: 1.0859964 Vali Loss: 0.5542810 Best vali loss: 0.5542810
	iters: 100, epoch: 3 | loss: 0.7503230
	speed: 0.0128s/iter; left time: 17.5411s
	iters: 200, epoch: 3 | loss: 1.0236464
	speed: 0.0063s/iter; left time: 8.0293s
Updating learning rate to 0.00012397079715258604
Validation loss decreased (0.5543 --> 0.5465).  Saving model state dict ...
Epoch: 3 cost time: 1.5732011795043945
Epoch: 3, Steps: 245 | Train Loss: 0.8869847 Vali Loss: 0.5464711 Best vali loss: 0.5464711

best validation loss 0.5464711213266337

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008069876564, 'e_layers': 3, 'learning_rate': 0.000202447705, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9297941
	speed: 0.0128s/iter; left time: 11.3670s
Updating learning rate to 0.00019474249802669145
Validation loss decreased (inf --> 0.5924).  Saving model state dict ...
Epoch: 1 cost time: 1.196666955947876
Epoch: 1, Steps: 123 | Train Loss: 0.9297941 Vali Loss: 0.5924158 Best vali loss: 0.5924158
	iters: 100, epoch: 2 | loss: 0.6235690
	speed: 0.0131s/iter; left time: 9.9465s
Updating learning rate to 0.00017279992502057686
Validation loss decreased (0.5924 --> 0.5825).  Saving model state dict ...
Epoch: 2 cost time: 1.0828630924224854
Epoch: 2, Steps: 123 | Train Loss: 0.6235690 Vali Loss: 0.5825177 Best vali loss: 0.5825177
	iters: 100, epoch: 3 | loss: 0.7611890
	speed: 0.0122s/iter; left time: 7.7980s
Updating learning rate to 0.00013996054381191757
Epoch: 3 cost time: 0.9851903915405273
Epoch: 3, Steps: 123 | Train Loss: 0.7611890 Vali Loss: 0.5863234 Best vali loss: 0.5825177

best validation loss 0.5825176835887579

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6489158
	speed: 0.0123s/iter; left time: 13.8155s
	iters: 200, epoch: 4 | loss: 0.4130141
	speed: 0.0070s/iter; left time: 7.2004s
Updating learning rate to 8.96595665e-05
Validation loss decreased (0.5465 --> 0.5360).  Saving model state dict ...
Epoch: 4 cost time: 1.8112149238586426
Epoch: 4, Steps: 245 | Train Loss: 0.5309650 Vali Loss: 0.5359697 Best vali loss: 0.5359697
	iters: 100, epoch: 5 | loss: 0.7884865
	speed: 0.0094s/iter; left time: 8.2424s
	iters: 200, epoch: 5 | loss: 0.9029313
	speed: 0.0051s/iter; left time: 3.9595s
Updating learning rate to 5.5348335847413986e-05
Epoch: 5 cost time: 1.2218499183654785
Epoch: 5, Steps: 245 | Train Loss: 0.8457089 Vali Loss: 0.5383493 Best vali loss: 0.5359697
	iters: 100, epoch: 6 | loss: 0.7011741
	speed: 0.0107s/iter; left time: 6.7852s
	iters: 200, epoch: 6 | loss: 0.9412398
	speed: 0.0052s/iter; left time: 2.7805s
Updating learning rate to 2.6260679029603798e-05
Epoch: 6 cost time: 1.3185369968414307
Epoch: 6, Steps: 245 | Train Loss: 0.8212070 Vali Loss: 0.5458187 Best vali loss: 0.5359697
	iters: 100, epoch: 7 | loss: 0.5945480
	speed: 0.0106s/iter; left time: 4.1256s
	iters: 200, epoch: 7 | loss: 0.5023922
	speed: 0.0052s/iter; left time: 1.5036s
Updating learning rate to 6.824928116815375e-06
Epoch: 7 cost time: 1.3090531826019287
Epoch: 7, Steps: 245 | Train Loss: 0.5484701 Vali Loss: 0.5533889 Best vali loss: 0.5359697
	iters: 100, epoch: 8 | loss: 0.6388323
	speed: 0.0108s/iter; left time: 1.5804s
	iters: 200, epoch: 8 | loss: 0.7355382
	speed: 0.0053s/iter; left time: 0.2438s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3467416763305664
Epoch: 8, Steps: 245 | Train Loss: 0.6871853 Vali Loss: 0.5517792 Best vali loss: 0.5359697

best validation loss 0.5359696553764052

[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.001716146484, 'e_layers': 4, 'learning_rate': 9.25739637e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7197521
	speed: 0.0133s/iter; left time: 11.7295s
Updating learning rate to 8.905057700293642e-05
Validation loss decreased (inf --> 0.6151).  Saving model state dict ...
Epoch: 1 cost time: 1.2068893909454346
Epoch: 1, Steps: 123 | Train Loss: 0.7197521 Vali Loss: 0.6151371 Best vali loss: 0.6151371
	iters: 100, epoch: 2 | loss: 1.2300289
	speed: 0.0114s/iter; left time: 8.6614s
Updating learning rate to 7.901682059679364e-05
Validation loss decreased (0.6151 --> 0.6033).  Saving model state dict ...
Epoch: 2 cost time: 0.9484174251556396
Epoch: 2, Steps: 123 | Train Loss: 1.2300289 Vali Loss: 0.6033272 Best vali loss: 0.6033272
	iters: 100, epoch: 3 | loss: 0.9510318
	speed: 0.0113s/iter; left time: 7.2025s
Updating learning rate to 6.400024293817862e-05
Validation loss decreased (0.6033 --> 0.5991).  Saving model state dict ...
Epoch: 3 cost time: 0.9191551208496094
Epoch: 3, Steps: 123 | Train Loss: 0.9510318 Vali Loss: 0.5991403 Best vali loss: 0.5991403
	iters: 100, epoch: 4 | loss: 0.7196828
	speed: 0.0112s/iter; left time: 5.7702s
Updating learning rate to 4.628698185e-05
Epoch: 4 cost time: 0.9276597499847412
Epoch: 4, Steps: 123 | Train Loss: 0.7196828 Vali Loss: 0.5994601 Best vali loss: 0.5991403
	iters: 100, epoch: 5 | loss: 0.8793818
	speed: 0.0109s/iter; left time: 4.2959s
Updating learning rate to 2.857372076182139e-05
Validation loss decreased (0.5991 --> 0.5839).  Saving model state dict ...
Epoch: 5 cost time: 0.9087522029876709
Epoch: 5, Steps: 123 | Train Loss: 0.8793818 Vali Loss: 0.5838800 Best vali loss: 0.5838800
	iters: 100, epoch: 6 | loss: 0.4738820
	speed: 0.0110s/iter; left time: 2.9734s
Updating learning rate to 1.3557143103206357e-05
Validation loss decreased (0.5839 --> 0.5708).  Saving model state dict ...
Epoch: 6 cost time: 0.9076082706451416
Epoch: 6, Steps: 123 | Train Loss: 0.4738820 Vali Loss: 0.5707996 Best vali loss: 0.5707996
	iters: 100, epoch: 7 | loss: 0.6818101
	speed: 0.0111s/iter; left time: 1.6291s
Updating learning rate to 3.523386697063586e-06
Validation loss decreased (0.5708 --> 0.5679).  Saving model state dict ...
Epoch: 7 cost time: 0.9275116920471191
Epoch: 7, Steps: 123 | Train Loss: 0.6818101 Vali Loss: 0.5679298 Best vali loss: 0.5679298
	iters: 100, epoch: 8 | loss: 0.8113442
	speed: 0.0110s/iter; left time: 0.2638s
Updating learning rate to 0.0
Validation loss decreased (0.5679 --> 0.5666).  Saving model state dict ...
Epoch: 8 cost time: 0.8964180946350098
Epoch: 8, Steps: 123 | Train Loss: 0.8113442 Vali Loss: 0.5666406 Best vali loss: 0.5666406

best validation loss 0.5666405666431638

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0044569176576, 'e_layers': 2, 'learning_rate': 0.0006733362287, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7077355
	speed: 0.0106s/iter; left time: 9.4027s
Updating learning rate to 0.0006477088944471344
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 0.9091806411743164
Epoch: 1, Steps: 123 | Train Loss: 0.7077355 Vali Loss: 0.6208203 Best vali loss: 0.6208203
	iters: 100, epoch: 2 | loss: 0.7070656
	speed: 0.0087s/iter; left time: 6.6313s
Updating learning rate to 0.0005747284210161729
Validation loss decreased (0.6208 --> 0.6111).  Saving model state dict ...
Epoch: 2 cost time: 0.697988748550415
Epoch: 2, Steps: 123 | Train Loss: 0.7070656 Vali Loss: 0.6110953 Best vali loss: 0.6110953
	iters: 100, epoch: 3 | loss: 0.8950153
	speed: 0.0083s/iter; left time: 5.3133s
Updating learning rate to 0.00046550542391734053
Validation loss decreased (0.6111 --> 0.6059).  Saving model state dict ...
Epoch: 3 cost time: 0.6537842750549316
Epoch: 3, Steps: 123 | Train Loss: 0.8950153 Vali Loss: 0.6058865 Best vali loss: 0.6058865
	iters: 100, epoch: 4 | loss: 0.7105899
	speed: 0.0083s/iter; left time: 4.2624s
Updating learning rate to 0.00033666811435
Validation loss decreased (0.6059 --> 0.6033).  Saving model state dict ...
Epoch: 4 cost time: 0.6507155895233154
Epoch: 4, Steps: 123 | Train Loss: 0.7105899 Vali Loss: 0.6032583 Best vali loss: 0.6032583
	iters: 100, epoch: 5 | loss: 0.7712411
	speed: 0.0081s/iter; left time: 3.1974s
Updating learning rate to 0.00020783080478265948
Validation loss decreased (0.6033 --> 0.6005).  Saving model state dict ...
Epoch: 5 cost time: 0.6316318511962891
Epoch: 5, Steps: 123 | Train Loss: 0.7712411 Vali Loss: 0.6004860 Best vali loss: 0.6004860
	iters: 100, epoch: 6 | loss: 0.7903427
	speed: 0.0081s/iter; left time: 2.1944s
Updating learning rate to 9.8607807683827e-05
Validation loss decreased (0.6005 --> 0.6005).  Saving model state dict ...
Epoch: 6 cost time: 0.6473040580749512
Epoch: 6, Steps: 123 | Train Loss: 0.7903427 Vali Loss: 0.6004507 Best vali loss: 0.6004507
	iters: 100, epoch: 7 | loss: 0.7999085
	speed: 0.0081s/iter; left time: 1.1947s
Updating learning rate to 2.5627334252865573e-05
Epoch: 7 cost time: 0.6536774635314941
Epoch: 7, Steps: 123 | Train Loss: 0.7999085 Vali Loss: 0.6016530 Best vali loss: 0.6004507
	iters: 100, epoch: 8 | loss: 0.7007528
	speed: 0.0085s/iter; left time: 0.2048s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6668579578399658
Epoch: 8, Steps: 123 | Train Loss: 0.7007528 Vali Loss: 0.6027708 Best vali loss: 0.6004507

best validation loss 0.6004506999946534

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00031764682727096065
Validation loss decreased (inf --> 0.6155).  Saving model state dict ...
Epoch: 1 cost time: 1.1533427238464355
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6155314 Best vali loss: 0.6155314
Updating learning rate to 0.00028185603292365586
Validation loss decreased (0.6155 --> 0.5739).  Saving model state dict ...
Epoch: 2 cost time: 0.9104058742523193
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5738935 Best vali loss: 0.5738935
Updating learning rate to 0.00022829132385310412
Validation loss decreased (0.5739 --> 0.5612).  Saving model state dict ...
Epoch: 3 cost time: 0.9042379856109619
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5612356 Best vali loss: 0.5612356

best validation loss 0.5612355838325056

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009854043892, 'e_layers': 4, 'learning_rate': 0.0004499065077, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8106311
	speed: 0.0111s/iter; left time: 86.0483s
	iters: 200, epoch: 1 | loss: 0.6762850
	speed: 0.0056s/iter; left time: 42.8361s
	iters: 300, epoch: 1 | loss: 0.4544141
	speed: 0.0055s/iter; left time: 41.7634s
	iters: 400, epoch: 1 | loss: 0.6491895
	speed: 0.0056s/iter; left time: 41.3859s
	iters: 500, epoch: 1 | loss: 0.8985049
	speed: 0.0057s/iter; left time: 41.5114s
	iters: 600, epoch: 1 | loss: 1.7339979
	speed: 0.0056s/iter; left time: 40.2389s
	iters: 700, epoch: 1 | loss: 0.5485469
	speed: 0.0055s/iter; left time: 39.2798s
	iters: 800, epoch: 1 | loss: 0.4197546
	speed: 0.0055s/iter; left time: 38.8733s
	iters: 900, epoch: 1 | loss: 0.3904761
	speed: 0.0059s/iter; left time: 41.0008s
Updating learning rate to 0.00043278296085383084
Validation loss decreased (inf --> 0.6153).  Saving model state dict ...
Epoch: 1 cost time: 5.766859769821167
Epoch: 1, Steps: 979 | Train Loss: 0.7313111 Vali Loss: 0.6153222 Best vali loss: 0.6153222
	iters: 100, epoch: 2 | loss: 1.9154140
	speed: 0.0176s/iter; left time: 118.8240s
	iters: 200, epoch: 2 | loss: 0.7545006
	speed: 0.0057s/iter; left time: 37.9078s
	iters: 300, epoch: 2 | loss: 1.3535417
	speed: 0.0058s/iter; left time: 38.0991s
	iters: 400, epoch: 2 | loss: 0.8570114
	speed: 0.0063s/iter; left time: 40.6079s
	iters: 500, epoch: 2 | loss: 1.4575087
	speed: 0.0063s/iter; left time: 40.2547s
	iters: 600, epoch: 2 | loss: 0.9267092
	speed: 0.0064s/iter; left time: 39.7584s
	iters: 700, epoch: 2 | loss: 0.7263949
	speed: 0.0063s/iter; left time: 38.5461s
	iters: 800, epoch: 2 | loss: 0.8800898
	speed: 0.0062s/iter; left time: 37.6994s
	iters: 900, epoch: 2 | loss: 0.8335493
	speed: 0.0062s/iter; left time: 37.1543s
Updating learning rate to 0.0003840192250973138
Validation loss decreased (0.6153 --> 0.5813).  Saving model state dict ...
Epoch: 2 cost time: 6.014907598495483
Epoch: 2, Steps: 979 | Train Loss: 1.0783022 Vali Loss: 0.5812955 Best vali loss: 0.5812955
	iters: 100, epoch: 3 | loss: 0.3390286
	speed: 0.0184s/iter; left time: 106.1706s
	iters: 200, epoch: 3 | loss: 0.6349908
	speed: 0.0057s/iter; left time: 32.2649s
	iters: 300, epoch: 3 | loss: 1.0074533
	speed: 0.0057s/iter; left time: 31.6184s
	iters: 400, epoch: 3 | loss: 0.9938804
	speed: 0.0057s/iter; left time: 31.3739s
	iters: 500, epoch: 3 | loss: 0.8658692
	speed: 0.0057s/iter; left time: 30.7548s
	iters: 600, epoch: 3 | loss: 0.5384396
	speed: 0.0056s/iter; left time: 29.7891s
	iters: 700, epoch: 3 | loss: 0.2886734
	speed: 0.0056s/iter; left time: 29.2007s
	iters: 800, epoch: 3 | loss: 0.6382989
	speed: 0.0056s/iter; left time: 28.5096s
	iters: 900, epoch: 3 | loss: 0.4017097
	speed: 0.0056s/iter; left time: 27.8862s
Updating learning rate to 0.00031103913715501335
Validation loss decreased (0.5813 --> 0.5615).  Saving model state dict ...
Epoch: 3 cost time: 5.605847358703613
Epoch: 3, Steps: 979 | Train Loss: 0.6342604 Vali Loss: 0.5615381 Best vali loss: 0.5615381

best validation loss 0.5615381296449985

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010212612733, 'e_layers': 1, 'learning_rate': 0.001033174495, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6207456
	speed: 0.0090s/iter; left time: 16.6655s
	iters: 200, epoch: 1 | loss: 1.1146498
	speed: 0.0035s/iter; left time: 6.1078s
Updating learning rate to 0.001033174495
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.136392593383789
Epoch: 1, Steps: 245 | Train Loss: 0.8676977 Vali Loss: 0.6076720 Best vali loss: 0.6076720
	iters: 100, epoch: 2 | loss: 0.5900078
	speed: 0.0075s/iter; left time: 12.1066s
	iters: 200, epoch: 2 | loss: 0.8287129
	speed: 0.0035s/iter; left time: 5.2780s
Updating learning rate to 0.0005165872475
Epoch: 2 cost time: 0.8988320827484131
Epoch: 2, Steps: 245 | Train Loss: 0.7093604 Vali Loss: 0.6182143 Best vali loss: 0.6076720
	iters: 100, epoch: 3 | loss: 0.7083064
	speed: 0.0074s/iter; left time: 10.0829s
	iters: 200, epoch: 3 | loss: 0.9377055
	speed: 0.0035s/iter; left time: 4.4127s
Updating learning rate to 0.00025829362375
Validation loss decreased (0.6077 --> 0.5974).  Saving model state dict ...
Epoch: 3 cost time: 0.8785226345062256
Epoch: 3, Steps: 245 | Train Loss: 0.8230059 Vali Loss: 0.5973589 Best vali loss: 0.5973589

best validation loss 0.5973588879987742

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00016510744145
Validation loss decreased (0.5612 --> 0.5455).  Saving model state dict ...
Epoch: 4 cost time: 1.0357160568237305
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5454815 Best vali loss: 0.5454815
Updating learning rate to 0.00010192355904689593
Validation loss decreased (0.5455 --> 0.5386).  Saving model state dict ...
Epoch: 5 cost time: 0.9198083877563477
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5385594 Best vali loss: 0.5385594
Updating learning rate to 4.835884997634416e-05
Epoch: 6 cost time: 0.9060769081115723
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5390350 Best vali loss: 0.5385594
Updating learning rate to 1.2568055629039355e-05
Validation loss decreased (0.5386 --> 0.5349).  Saving model state dict ...
Epoch: 7 cost time: 0.9247608184814453
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5348901 Best vali loss: 0.5348901
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8712363243103027
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5430487 Best vali loss: 0.5348901

best validation loss 0.5348901173297259

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.005640097632, 'e_layers': 4, 'learning_rate': 0.0001952136558, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3063159
	speed: 0.0101s/iter; left time: 78.3316s
	iters: 200, epoch: 1 | loss: 1.4414927
	speed: 0.0080s/iter; left time: 60.7371s
	iters: 300, epoch: 1 | loss: 0.6676369
	speed: 0.0088s/iter; left time: 66.2107s
	iters: 400, epoch: 1 | loss: 1.2184265
	speed: 0.0081s/iter; left time: 59.9933s
	iters: 500, epoch: 1 | loss: 1.1974914
	speed: 0.0090s/iter; left time: 66.3239s
	iters: 600, epoch: 1 | loss: 1.4982524
	speed: 0.0077s/iter; left time: 55.7918s
	iters: 700, epoch: 1 | loss: 0.6742075
	speed: 0.0092s/iter; left time: 65.3821s
	iters: 800, epoch: 1 | loss: 0.4193415
	speed: 0.0071s/iter; left time: 50.0837s
	iters: 900, epoch: 1 | loss: 1.7687149
	speed: 0.0050s/iter; left time: 34.8349s
Updating learning rate to 0.0001952136558
Validation loss decreased (inf --> 0.6231).  Saving model state dict ...
Epoch: 1 cost time: 7.526664733886719
Epoch: 1, Steps: 979 | Train Loss: 1.1324311 Vali Loss: 0.6230759 Best vali loss: 0.6230759
	iters: 100, epoch: 2 | loss: 0.4974091
	speed: 0.0218s/iter; left time: 147.0074s
	iters: 200, epoch: 2 | loss: 0.6614166
	speed: 0.0068s/iter; left time: 45.4057s
	iters: 300, epoch: 2 | loss: 0.7627246
	speed: 0.0070s/iter; left time: 45.8416s
	iters: 400, epoch: 2 | loss: 0.4042819
	speed: 0.0058s/iter; left time: 37.2439s
	iters: 500, epoch: 2 | loss: 1.3756191
	speed: 0.0052s/iter; left time: 33.2143s
	iters: 600, epoch: 2 | loss: 0.8070430
	speed: 0.0090s/iter; left time: 56.1456s
	iters: 700, epoch: 2 | loss: 0.3292976
	speed: 0.0080s/iter; left time: 48.9975s
	iters: 800, epoch: 2 | loss: 0.4680373
	speed: 0.0083s/iter; left time: 50.1772s
	iters: 900, epoch: 2 | loss: 0.6808047
	speed: 0.0087s/iter; left time: 52.0263s
Updating learning rate to 9.76068279e-05
Validation loss decreased (0.6231 --> 0.6056).  Saving model state dict ...
Epoch: 2 cost time: 7.288845539093018
Epoch: 2, Steps: 979 | Train Loss: 0.6651815 Vali Loss: 0.6055886 Best vali loss: 0.6055886
	iters: 100, epoch: 3 | loss: 0.9503609
	speed: 0.0266s/iter; left time: 153.4107s
	iters: 200, epoch: 3 | loss: 1.2675904
	speed: 0.0088s/iter; left time: 50.0067s
	iters: 300, epoch: 3 | loss: 1.2781355
	speed: 0.0078s/iter; left time: 43.6934s
	iters: 400, epoch: 3 | loss: 0.6148130
	speed: 0.0092s/iter; left time: 50.3611s
	iters: 500, epoch: 3 | loss: 0.4001292
	speed: 0.0071s/iter; left time: 38.0023s
	iters: 600, epoch: 3 | loss: 0.8708167
	speed: 0.0050s/iter; left time: 26.4602s
	iters: 700, epoch: 3 | loss: 0.5259442
	speed: 0.0066s/iter; left time: 34.3898s
	iters: 800, epoch: 3 | loss: 0.7134939
	speed: 0.0075s/iter; left time: 37.8320s
	iters: 900, epoch: 3 | loss: 0.8799813
	speed: 0.0075s/iter; left time: 37.1877s
Updating learning rate to 4.880341395e-05
Validation loss decreased (0.6056 --> 0.6028).  Saving model state dict ...
Epoch: 3 cost time: 7.387785911560059
Epoch: 3, Steps: 979 | Train Loss: 0.8334739 Vali Loss: 0.6027961 Best vali loss: 0.6027961
	iters: 100, epoch: 4 | loss: 0.7348724
	speed: 0.0233s/iter; left time: 111.9707s
	iters: 200, epoch: 4 | loss: 0.5766398
	speed: 0.0076s/iter; left time: 35.5698s
	iters: 300, epoch: 4 | loss: 0.4766368
	speed: 0.0071s/iter; left time: 32.7597s
	iters: 400, epoch: 4 | loss: 0.5746288
	speed: 0.0076s/iter; left time: 34.3555s
	iters: 500, epoch: 4 | loss: 0.5014393
	speed: 0.0075s/iter; left time: 33.1445s
	iters: 600, epoch: 4 | loss: 0.5739954
	speed: 0.0073s/iter; left time: 31.2364s
	iters: 700, epoch: 4 | loss: 0.9108742
	speed: 0.0077s/iter; left time: 32.1907s
	iters: 800, epoch: 4 | loss: 1.2061148
	speed: 0.0074s/iter; left time: 30.5067s
	iters: 900, epoch: 4 | loss: 0.8270126
	speed: 0.0075s/iter; left time: 29.8584s
Updating learning rate to 2.4401706975e-05
Validation loss decreased (0.6028 --> 0.6019).  Saving model state dict ...
Epoch: 4 cost time: 7.174298524856567
Epoch: 4, Steps: 979 | Train Loss: 0.7091349 Vali Loss: 0.6018885 Best vali loss: 0.6018885
	iters: 100, epoch: 5 | loss: 0.3954166
	speed: 0.0177s/iter; left time: 67.6812s
	iters: 200, epoch: 5 | loss: 0.5574436
	speed: 0.0061s/iter; left time: 22.5145s
	iters: 300, epoch: 5 | loss: 0.3423405
	speed: 0.0063s/iter; left time: 22.7672s
	iters: 400, epoch: 5 | loss: 1.2588799
	speed: 0.0064s/iter; left time: 22.3531s
	iters: 500, epoch: 5 | loss: 1.1549759
	speed: 0.0061s/iter; left time: 20.9048s
	iters: 600, epoch: 5 | loss: 0.8347275
	speed: 0.0062s/iter; left time: 20.6093s
	iters: 700, epoch: 5 | loss: 0.2540182
	speed: 0.0064s/iter; left time: 20.5893s
	iters: 800, epoch: 5 | loss: 0.6189463
	speed: 0.0062s/iter; left time: 19.3120s
	iters: 900, epoch: 5 | loss: 0.4851483
	speed: 0.0062s/iter; left time: 18.6130s
Updating learning rate to 1.22008534875e-05
Validation loss decreased (0.6019 --> 0.6008).  Saving model state dict ...
Epoch: 5 cost time: 6.162729978561401
Epoch: 5, Steps: 979 | Train Loss: 0.6557663 Vali Loss: 0.6007767 Best vali loss: 0.6007767
	iters: 100, epoch: 6 | loss: 1.1125647
	speed: 0.0206s/iter; left time: 58.5963s
	iters: 200, epoch: 6 | loss: 1.4476650
	speed: 0.0058s/iter; left time: 15.9736s
	iters: 300, epoch: 6 | loss: 0.8517129
	speed: 0.0049s/iter; left time: 12.8448s
	iters: 400, epoch: 6 | loss: 0.4036817
	speed: 0.0099s/iter; left time: 25.0767s
	iters: 500, epoch: 6 | loss: 0.5485826
	speed: 0.0105s/iter; left time: 25.6133s
	iters: 600, epoch: 6 | loss: 0.7668018
	speed: 0.0101s/iter; left time: 23.7135s
	iters: 700, epoch: 6 | loss: 1.6779143
	speed: 0.0090s/iter; left time: 20.1514s
	iters: 800, epoch: 6 | loss: 0.8018306
	speed: 0.0051s/iter; left time: 10.8473s
	iters: 900, epoch: 6 | loss: 0.5041137
	speed: 0.0057s/iter; left time: 11.6129s
Updating learning rate to 6.10042674375e-06
Epoch: 6 cost time: 7.233493804931641
Epoch: 6, Steps: 979 | Train Loss: 0.9016519 Vali Loss: 0.6017484 Best vali loss: 0.6007767
	iters: 100, epoch: 7 | loss: 0.3261286
	speed: 0.0189s/iter; left time: 35.0692s
	iters: 200, epoch: 7 | loss: 0.8660617
	speed: 0.0061s/iter; left time: 10.7642s
	iters: 300, epoch: 7 | loss: 0.5736810
	speed: 0.0062s/iter; left time: 10.2158s
	iters: 400, epoch: 7 | loss: 0.5782539
	speed: 0.0061s/iter; left time: 9.4844s
	iters: 500, epoch: 7 | loss: 0.7118936
	speed: 0.0062s/iter; left time: 8.9743s
	iters: 600, epoch: 7 | loss: 0.9203036
	speed: 0.0060s/iter; left time: 8.2102s
	iters: 700, epoch: 7 | loss: 0.8605635
	speed: 0.0061s/iter; left time: 7.6360s
	iters: 800, epoch: 7 | loss: 0.2805068
	speed: 0.0059s/iter; left time: 6.8196s
	iters: 900, epoch: 7 | loss: 0.5339805
	speed: 0.0058s/iter; left time: 6.1305s
Updating learning rate to 3.050213371875e-06
Epoch: 7 cost time: 6.005991220474243
Epoch: 7, Steps: 979 | Train Loss: 0.6279304 Vali Loss: 0.6009868 Best vali loss: 0.6007767
	iters: 100, epoch: 8 | loss: 1.3450575
	speed: 0.0194s/iter; left time: 17.0514s
	iters: 200, epoch: 8 | loss: 0.6865138
	speed: 0.0062s/iter; left time: 4.8642s
	iters: 300, epoch: 8 | loss: 1.0471299
	speed: 0.0062s/iter; left time: 4.2475s
	iters: 400, epoch: 8 | loss: 1.3129213
	speed: 0.0061s/iter; left time: 3.5481s
	iters: 500, epoch: 8 | loss: 0.2764070
	speed: 0.0062s/iter; left time: 2.9552s
	iters: 600, epoch: 8 | loss: 1.2413354
	speed: 0.0061s/iter; left time: 2.3028s
	iters: 700, epoch: 8 | loss: 0.9797620
	speed: 0.0061s/iter; left time: 1.7040s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0036399733072, 'e_layers': 2, 'learning_rate': 0.0011858266081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2768070
	speed: 0.0098s/iter; left time: 75.6720s
	iters: 200, epoch: 1 | loss: 1.4335119
	speed: 0.0041s/iter; left time: 31.3407s
	iters: 300, epoch: 1 | loss: 0.6250216
	speed: 0.0040s/iter; left time: 30.2638s
	iters: 400, epoch: 1 | loss: 0.8115082
	speed: 0.0041s/iter; left time: 30.2227s
	iters: 500, epoch: 1 | loss: 0.3420421
	speed: 0.0041s/iter; left time: 30.0552s
	iters: 600, epoch: 1 | loss: 0.9935338
	speed: 0.0045s/iter; left time: 32.4941s
	iters: 700, epoch: 1 | loss: 2.2386951
	speed: 0.0045s/iter; left time: 31.8144s
	iters: 800, epoch: 1 | loss: 0.7558694
	speed: 0.0044s/iter; left time: 30.7826s
	iters: 900, epoch: 1 | loss: 1.2609485
	speed: 0.0044s/iter; left time: 30.3838s
Updating learning rate to 0.0011858266081
Validation loss decreased (inf --> 0.6261).  Saving model state dict ...
Epoch: 1 cost time: 4.450126647949219
Epoch: 1, Steps: 979 | Train Loss: 1.0819931 Vali Loss: 0.6260602 Best vali loss: 0.6260602
	iters: 100, epoch: 2 | loss: 1.3297042
	speed: 0.0150s/iter; left time: 101.5834s
	iters: 200, epoch: 2 | loss: 1.3365608
	speed: 0.0043s/iter; left time: 28.8222s
	iters: 300, epoch: 2 | loss: 0.7865670
	speed: 0.0043s/iter; left time: 28.3200s
	iters: 400, epoch: 2 | loss: 0.5266367
	speed: 0.0042s/iter; left time: 27.1335s
	iters: 500, epoch: 2 | loss: 0.8027466
	speed: 0.0044s/iter; left time: 27.9067s
	iters: 600, epoch: 2 | loss: 1.2012519
	speed: 0.0044s/iter; left time: 27.4397s
	iters: 700, epoch: 2 | loss: 0.6144361
	speed: 0.0038s/iter; left time: 23.3597s
	iters: 800, epoch: 2 | loss: 0.7511961
	speed: 0.0040s/iter; left time: 24.2926s
	iters: 900, epoch: 2 | loss: 0.4826775
	speed: 0.0038s/iter; left time: 22.8373s
Updating learning rate to 0.00059291330405
Epoch: 2 cost time: 4.0913026332855225
Epoch: 2, Steps: 979 | Train Loss: 0.8701974 Vali Loss: 0.6293287 Best vali loss: 0.6260602
	iters: 100, epoch: 3 | loss: 1.2320122
	speed: 0.0130s/iter; left time: 74.9513s
	iters: 200, epoch: 3 | loss: 0.8598868
	speed: 0.0047s/iter; left time: 26.9290s
	iters: 300, epoch: 3 | loss: 0.7620377
	speed: 0.0043s/iter; left time: 23.7365s
	iters: 400, epoch: 3 | loss: 1.3213313
	speed: 0.0045s/iter; left time: 24.8153s
	iters: 500, epoch: 3 | loss: 0.5783398
	speed: 0.0046s/iter; left time: 24.9694s
	iters: 600, epoch: 3 | loss: 0.8129084
	speed: 0.0046s/iter; left time: 24.2308s
	iters: 700, epoch: 3 | loss: 1.3520558
	speed: 0.0043s/iter; left time: 22.4020s
	iters: 800, epoch: 3 | loss: 0.4548384
	speed: 0.0048s/iter; left time: 24.1594s
	iters: 900, epoch: 3 | loss: 1.0836152
	speed: 0.0046s/iter; left time: 23.1204s
Updating learning rate to 0.000296456652025
Epoch: 3 cost time: 4.503749370574951
Epoch: 3, Steps: 979 | Train Loss: 0.9396695 Vali Loss: 0.6514462 Best vali loss: 0.6260602
	iters: 100, epoch: 4 | loss: 0.6050346
	speed: 0.0127s/iter; left time: 61.0498s
	iters: 200, epoch: 4 | loss: 1.0699290
	speed: 0.0078s/iter; left time: 36.6060s
	iters: 300, epoch: 4 | loss: 0.7872285
	speed: 0.0065s/iter; left time: 29.8176s
	iters: 400, epoch: 4 | loss: 0.4680558
	speed: 0.0086s/iter; left time: 38.7709s
	iters: 500, epoch: 4 | loss: 1.9290634
	speed: 0.0067s/iter; left time: 29.4606s
	iters: 600, epoch: 4 | loss: 0.4654064
	speed: 0.0084s/iter; left time: 36.0444s
	iters: 700, epoch: 4 | loss: 0.6784239
	speed: 0.0065s/iter; left time: 27.1337s
	iters: 800, epoch: 4 | loss: 1.3129131
	speed: 0.0078s/iter; left time: 31.8798s
	iters: 900, epoch: 4 | loss: 0.8802741
	speed: 0.0077s/iter; left time: 30.6301s
Updating learning rate to 0.0001482283260125
Epoch: 4 cost time: 7.064454555511475
Epoch: 4, Steps: 979 | Train Loss: 0.9107032 Vali Loss: 0.6344208 Best vali loss: 0.6260602
	iters: 100, epoch: 5 | loss: 0.6721408
	speed: 0.0153s/iter; left time: 58.2353s
	iters: 200, epoch: 5 | loss: 0.2722797
	speed: 0.0039s/iter; left time: 14.6175s
	iters: 300, epoch: 5 | loss: 0.5183023
	speed: 0.0042s/iter; left time: 15.0686s
	iters: 400, epoch: 5 | loss: 0.7323687
	speed: 0.0042s/iter; left time: 14.8395s
	iters: 500, epoch: 5 | loss: 0.9776796
	speed: 0.0042s/iter; left time: 14.2955s
	iters: 600, epoch: 5 | loss: 1.4026506
	speed: 0.0043s/iter; left time: 14.1026s
	iters: 700, epoch: 5 | loss: 0.8687351
	speed: 0.0042s/iter; left time: 13.5749s
	iters: 800, epoch: 5 | loss: 0.7151715
	speed: 0.0041s/iter; left time: 12.8567s
	iters: 900, epoch: 5 | loss: 1.6906816
	speed: 0.0040s/iter; left time: 12.2082s
Updating learning rate to 7.411416300625e-05
Epoch: 5 cost time: 4.0170838832855225
Epoch: 5, Steps: 979 | Train Loss: 0.8722233 Vali Loss: 0.6425364 Best vali loss: 0.6260602
	iters: 100, epoch: 6 | loss: 0.6779140
	speed: 0.0147s/iter; left time: 41.7209s
	iters: 200, epoch: 6 | loss: 1.4017648
	speed: 0.0048s/iter; left time: 13.2633s
	iters: 300, epoch: 6 | loss: 1.0742841
	speed: 0.0041s/iter; left time: 10.8591s
	iters: 400, epoch: 6 | loss: 1.2518140
	speed: 0.0041s/iter; left time: 10.4174s
	iters: 500, epoch: 6 | loss: 0.7959173
	speed: 0.0042s/iter; left time: 10.2408s
	iters: 600, epoch: 6 | loss: 1.0252581
	speed: 0.0041s/iter; left time: 9.6584s
	iters: 700, epoch: 6 | loss: 0.8879083
	speed: 0.0042s/iter; left time: 9.3045s
	iters: 800, epoch: 6 | loss: 0.3978151
	speed: 0.0041s/iter; left time: 8.8686s
	iters: 900, epoch: 6 | loss: 1.1187247
	speed: 0.0039s/iter; left time: 7.9943s
Updating learning rate to 3.7057081503125e-05
Epoch: 6 cost time: 4.1762964725494385
Epoch: 6, Steps: 979 | Train Loss: 0.9590445 Vali Loss: 0.6434732 Best vali loss: 0.6260602
	iters: 100, epoch: 7 | loss: 1.0596961
	speed: 0.0141s/iter; left time: 26.2512s
	iters: 200, epoch: 7 | loss: 0.6579146
	speed: 0.0042s/iter; left time: 7.3423s
	iters: 300, epoch: 7 | loss: 0.9489025
	speed: 0.0040s/iter; left time: 6.6452s
	iters: 400, epoch: 7 | loss: 0.5136218
	speed: 0.0038s/iter; left time: 5.9387s
	iters: 500, epoch: 7 | loss: 0.7035418
	speed: 0.0041s/iter; left time: 5.9206s
	iters: 600, epoch: 7 | loss: 0.8886182
	speed: 0.0039s/iter; left time: 5.3556s
	iters: 700, epoch: 7 | loss: 1.1608373
	speed: 0.0039s/iter; left time: 4.9486s
	iters: 800, epoch: 7 | loss: 1.2359467
	speed: 0.0040s/iter; left time: 4.5891s
	iters: 900, epoch: 7 | loss: 1.0789953
	speed: 0.0039s/iter; left time: 4.1416s
Updating learning rate to 1.85285407515625e-05
Epoch: 7 cost time: 3.9613590240478516
Epoch: 7, Steps: 979 | Train Loss: 0.9164527 Vali Loss: 0.6437844 Best vali loss: 0.6260602
	iters: 100, epoch: 8 | loss: 0.5742071
	speed: 0.0141s/iter; left time: 12.4044s
	iters: 200, epoch: 8 | loss: 1.3034233
	speed: 0.0041s/iter; left time: 3.2342s
	iters: 300, epoch: 8 | loss: 0.3773141
	speed: 0.0042s/iter; left time: 2.8391s
	iters: 400, epoch: 8 | loss: 0.5373789
	speed: 0.0042s/iter; left time: 2.4123s
	iters: 500, epoch: 8 | loss: 1.3955808
	speed: 0.0040s/iter; left time: 1.9362s
	iters: 600, epoch: 8 | loss: 1.2305747
	speed: 0.0042s/iter; left time: 1.5872s
	iters: 700, epoch: 8 | loss: 0.7204934
	speed: 0.0041s/iter; left time: 1.1592s
	iters: 800, epoch: 8 | loss: 1.7297771
	speed: 0.0041s/iter; left time: 0.7435s
	iters: 900, epoch: 8 | loss: 0.4386744
	speed: 0.0040s/iter; left time: 0.3226s
Updating learning rate to 9.26427037578125e-06
Epoch: 8 cost time: 4.04972243309021
Epoch: 8, Steps: 979 | Train Loss: 0.9230471 Vali Loss: 0.6436847 Best vali loss: 0.6260602

best validation loss 0.6260601588279657

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0077699148402, 'e_layers': 2, 'learning_rate': 0.0001964127649, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6156569
	speed: 0.0101s/iter; left time: 18.7448s
	iters: 200, epoch: 1 | loss: 0.9340454
	speed: 0.0044s/iter; left time: 7.6861s
Updating learning rate to 0.0001964127649
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.372493028640747
Epoch: 1, Steps: 245 | Train Loss: 0.7748511 Vali Loss: 0.6075345 Best vali loss: 0.6075345
	iters: 100, epoch: 2 | loss: 0.5546650
	speed: 0.0096s/iter; left time: 15.5676s
	iters: 200, epoch: 2 | loss: 0.5857691
	speed: 0.0046s/iter; left time: 6.9535s
Updating learning rate to 9.820638245e-05
Validation loss decreased (0.6075 --> 0.5565).  Saving model state dict ...
Epoch: 2 cost time: 1.1990208625793457
Epoch: 2, Steps: 245 | Train Loss: 0.5702170 Vali Loss: 0.5565370 Best vali loss: 0.5565370
	iters: 100, epoch: 3 | loss: 0.7144941
	speed: 0.0098s/iter; left time: 13.4519s
	iters: 200, epoch: 3 | loss: 0.9455023
	speed: 0.0046s/iter; left time: 5.8214s
Updating learning rate to 4.9103191225e-05
Epoch: 3 cost time: 1.1821632385253906
Epoch: 3, Steps: 245 | Train Loss: 0.8299982 Vali Loss: 0.5658505 Best vali loss: 0.5565370

best validation loss 0.5565370147231551

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0046875553557, 'e_layers': 4, 'learning_rate': 0.0008574476385, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5334120
	speed: 0.0118s/iter; left time: 45.0506s
	iters: 200, epoch: 1 | loss: 0.8004273
	speed: 0.0061s/iter; left time: 22.5231s
	iters: 300, epoch: 1 | loss: 0.9523605
	speed: 0.0064s/iter; left time: 23.1083s
	iters: 400, epoch: 1 | loss: 0.9948315
	speed: 0.0069s/iter; left time: 24.4681s
Updating learning rate to 0.0008248129809551434
Validation loss decreased (inf --> 0.6436).  Saving model state dict ...
Epoch: 1 cost time: 3.5106801986694336
Epoch: 1, Steps: 490 | Train Loss: 0.8202578 Vali Loss: 0.6435684 Best vali loss: 0.6435684
	iters: 100, epoch: 2 | loss: 0.9985332
	speed: 0.0177s/iter; left time: 58.9830s
	iters: 200, epoch: 2 | loss: 1.3071158
	speed: 0.0062s/iter; left time: 19.9176s
	iters: 300, epoch: 2 | loss: 0.7511643
	speed: 0.0062s/iter; left time: 19.5282s
	iters: 400, epoch: 2 | loss: 1.2914215
	speed: 0.0062s/iter; left time: 18.8506s
Updating learning rate to 0.0007318773390978706
Epoch: 2 cost time: 3.0956337451934814
Epoch: 2, Steps: 490 | Train Loss: 1.0870587 Vali Loss: 0.6517466 Best vali loss: 0.6435684
	iters: 100, epoch: 3 | loss: 1.2692873
	speed: 0.0163s/iter; left time: 46.2126s
	iters: 200, epoch: 3 | loss: 0.5554585
	speed: 0.0059s/iter; left time: 16.0914s
	iters: 300, epoch: 3 | loss: 1.1392841
	speed: 0.0060s/iter; left time: 15.9663s
	iters: 400, epoch: 3 | loss: 0.8284133
	speed: 0.0064s/iter; left time: 16.2928s
Updating learning rate to 0.0005927893219372603
Validation loss decreased (0.6436 --> 0.6397).  Saving model state dict ...
Epoch: 3 cost time: 3.0692293643951416
Epoch: 3, Steps: 490 | Train Loss: 0.9481108 Vali Loss: 0.6397118 Best vali loss: 0.6397118

best validation loss 0.6397118374381227

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0092835703757, 'e_layers': 2, 'learning_rate': 0.0006403068671, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006403068671
Validation loss decreased (inf --> 0.6218).  Saving model state dict ...
Epoch: 1 cost time: 0.6654865741729736
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6217603 Best vali loss: 0.6217603
Updating learning rate to 0.00032015343355
Validation loss decreased (0.6218 --> 0.6082).  Saving model state dict ...
Epoch: 2 cost time: 0.4259059429168701
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6081672 Best vali loss: 0.6081672
Updating learning rate to 0.000160076716775
Validation loss decreased (0.6082 --> 0.6008).  Saving model state dict ...
Epoch: 3 cost time: 0.42647504806518555
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6008312 Best vali loss: 0.6008312

best validation loss 0.6008312170674326

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0077699148402, 'e_layers': 2, 'learning_rate': 0.0001964127649, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5384591
	speed: 0.0104s/iter; left time: 11.7249s
	iters: 200, epoch: 4 | loss: 0.7605460
	speed: 0.0043s/iter; left time: 4.4137s
Updating learning rate to 2.45515956125e-05
Validation loss decreased (0.5565 --> 0.5474).  Saving model state dict ...
Epoch: 4 cost time: 1.3532609939575195
Epoch: 4, Steps: 245 | Train Loss: 0.6495025 Vali Loss: 0.5473741 Best vali loss: 0.5473741
	iters: 100, epoch: 5 | loss: 0.5459638
	speed: 0.0089s/iter; left time: 7.8633s
	iters: 200, epoch: 5 | loss: 0.5094973
	speed: 0.0045s/iter; left time: 3.5331s
Updating learning rate to 1.227579780625e-05
Epoch: 5 cost time: 1.1230900287628174
Epoch: 5, Steps: 245 | Train Loss: 0.5277306 Vali Loss: 0.5494203 Best vali loss: 0.5473741
	iters: 100, epoch: 6 | loss: 0.6758364
	speed: 0.0095s/iter; left time: 6.0269s
	iters: 200, epoch: 6 | loss: 0.9015884
	speed: 0.0048s/iter; left time: 2.5515s
Updating learning rate to 6.137898903125e-06
Epoch: 6 cost time: 1.217726469039917
Epoch: 6, Steps: 245 | Train Loss: 0.7887124 Vali Loss: 0.5480874 Best vali loss: 0.5473741
	iters: 100, epoch: 7 | loss: 0.5931889
	speed: 0.0096s/iter; left time: 3.7709s
	iters: 200, epoch: 7 | loss: 0.6855932
	speed: 0.0048s/iter; left time: 1.3928s
Updating learning rate to 3.0689494515625e-06
Epoch: 7 cost time: 1.224161148071289
Epoch: 7, Steps: 245 | Train Loss: 0.6393911 Vali Loss: 0.5517575 Best vali loss: 0.5473741
	iters: 100, epoch: 8 | loss: 0.4590112
	speed: 0.0099s/iter; left time: 1.4445s
	iters: 200, epoch: 8 | loss: 0.7136145
	speed: 0.0045s/iter; left time: 0.2066s
Updating learning rate to 1.53447472578125e-06
Epoch: 8 cost time: 1.184666395187378
Epoch: 8, Steps: 245 | Train Loss: 0.5863129 Vali Loss: 0.5491483 Best vali loss: 0.5473741

best validation loss 0.5473741111739925

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0028852829179, 'e_layers': 3, 'learning_rate': 0.0002361458543, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8306332
	speed: 0.0112s/iter; left time: 20.9362s
	iters: 200, epoch: 1 | loss: 0.7547790
	speed: 0.0052s/iter; left time: 9.2269s
Updating learning rate to 0.0002361458543
Validation loss decreased (inf --> 0.6442).  Saving model state dict ...
Epoch: 1 cost time: 1.6402616500854492
Epoch: 1, Steps: 245 | Train Loss: 0.7927061 Vali Loss: 0.6441730 Best vali loss: 0.6441730
	iters: 100, epoch: 2 | loss: 0.6587604
	speed: 0.0113s/iter; left time: 18.2282s
	iters: 200, epoch: 2 | loss: 0.9107612
	speed: 0.0062s/iter; left time: 9.3270s
Updating learning rate to 0.00011807292715
Validation loss decreased (0.6442 --> 0.6166).  Saving model state dict ...
Epoch: 2 cost time: 1.5423145294189453
Epoch: 2, Steps: 245 | Train Loss: 0.7847608 Vali Loss: 0.6166357 Best vali loss: 0.6166357
	iters: 100, epoch: 3 | loss: 0.4175112
	speed: 0.0115s/iter; left time: 15.7057s
	iters: 200, epoch: 3 | loss: 0.5960888
	speed: 0.0059s/iter; left time: 7.4493s
Updating learning rate to 5.9036463575e-05
Validation loss decreased (0.6166 --> 0.6089).  Saving model state dict ...
Epoch: 3 cost time: 1.4757428169250488
Epoch: 3, Steps: 245 | Train Loss: 0.5068000 Vali Loss: 0.6089073 Best vali loss: 0.6089073
	iters: 100, epoch: 4 | loss: 1.1224281
	speed: 0.0110s/iter; left time: 12.3998s
	iters: 200, epoch: 4 | loss: 0.9950066
	speed: 0.0057s/iter; left time: 5.8298s
Updating learning rate to 2.95182317875e-05
Validation loss decreased (0.6089 --> 0.6083).  Saving model state dict ...
Epoch: 4 cost time: 1.4480984210968018
Epoch: 4, Steps: 245 | Train Loss: 1.0587173 Vali Loss: 0.6083481 Best vali loss: 0.6083481
	iters: 100, epoch: 5 | loss: 0.6598117
	speed: 0.0112s/iter; left time: 9.8635s
	iters: 200, epoch: 5 | loss: 0.8885984
	speed: 0.0053s/iter; left time: 4.1766s
Updating learning rate to 1.475911589375e-05
Validation loss decreased (0.6083 --> 0.6078).  Saving model state dict ...
Epoch: 5 cost time: 1.40323805809021
Epoch: 5, Steps: 245 | Train Loss: 0.7742050 Vali Loss: 0.6078306 Best vali loss: 0.6078306
	iters: 100, epoch: 6 | loss: 0.5936755
	speed: 0.0106s/iter; left time: 6.7630s
	iters: 200, epoch: 6 | loss: 0.8366519
	speed: 0.0057s/iter; left time: 3.0729s
Updating learning rate to 7.379557946875e-06
Validation loss decreased (0.6078 --> 0.6072).  Saving model state dict ...
Epoch: 6 cost time: 1.446784496307373
Epoch: 6, Steps: 245 | Train Loss: 0.7151637 Vali Loss: 0.6072312 Best vali loss: 0.6072312
	iters: 100, epoch: 7 | loss: 0.5909598
	speed: 0.0113s/iter; left time: 4.4226s
	iters: 200, epoch: 7 | loss: 0.8639473
	speed: 0.0054s/iter; left time: 1.5573s
Updating learning rate to 3.6897789734375e-06
Validation loss decreased (0.6072 --> 0.6071).  Saving model state dict ...
Epoch: 7 cost time: 1.3921735286712646
Epoch: 7, Steps: 245 | Train Loss: 0.7274536 Vali Loss: 0.6070865 Best vali loss: 0.6070865
	iters: 100, epoch: 8 | loss: 0.7004255
	speed: 0.0106s/iter; left time: 1.5507s
	iters: 200, epoch: 8 | loss: 0.7986131
	speed: 0.0050s/iter; left time: 0.2290s
Updating learning rate to 1.84488948671875e-06
Validation loss decreased (0.6071 --> 0.6069).  Saving model state dict ...
Epoch: 8 cost time: 1.3297743797302246
Epoch: 8, Steps: 245 | Train Loss: 0.7495193 Vali Loss: 0.6069086 Best vali loss: 0.6069086

best validation loss 0.6069086235687171

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023127490055, 'e_layers': 1, 'learning_rate': 0.0017907228824, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017907228824
Validation loss decreased (inf --> 0.6330).  Saving model state dict ...
Epoch: 1 cost time: 0.6870076656341553
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6330164 Best vali loss: 0.6330164
Updating learning rate to 0.0008953614412
Epoch: 2 cost time: 0.44033336639404297
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6596422 Best vali loss: 0.6330164
Updating learning rate to 0.0004476807206
Epoch: 3 cost time: 0.42645955085754395
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6496743 Best vali loss: 0.6330164
Updating learning rate to 0.0002238403603
Epoch: 4 cost time: 0.45206403732299805
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6511416 Best vali loss: 0.6330164
Updating learning rate to 0.00011192018015
Epoch: 5 cost time: 0.43329405784606934
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6679726 Best vali loss: 0.6330164
Updating learning rate to 5.5960090075e-05
Epoch: 6 cost time: 0.42928481101989746
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6645516 Best vali loss: 0.6330164
Updating learning rate to 2.79800450375e-05
Epoch: 7 cost time: 0.43362903594970703
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6701630 Best vali loss: 0.6330164
Updating learning rate to 1.399002251875e-05
Epoch: 8 cost time: 0.4635350704193115
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6693394 Best vali loss: 0.6330164

best validation loss 0.6330163820040331

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037670265647, 'e_layers': 4, 'learning_rate': 0.0001328666002, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7173398
	speed: 0.0129s/iter; left time: 49.2507s
	iters: 200, epoch: 1 | loss: 0.5821991
	speed: 0.0071s/iter; left time: 26.3619s
	iters: 300, epoch: 1 | loss: 0.9764982
	speed: 0.0070s/iter; left time: 25.2507s
	iters: 400, epoch: 1 | loss: 0.7258655
	speed: 0.0071s/iter; left time: 25.1082s
Updating learning rate to 0.00012780966633957002
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 3.770995616912842
Epoch: 1, Steps: 490 | Train Loss: 0.7504757 Vali Loss: 0.6085717 Best vali loss: 0.6085717
	iters: 100, epoch: 2 | loss: 1.3978785
	speed: 0.0176s/iter; left time: 58.4966s
	iters: 200, epoch: 2 | loss: 0.5309433
	speed: 0.0072s/iter; left time: 23.2368s
	iters: 300, epoch: 2 | loss: 0.4717619
	speed: 0.0072s/iter; left time: 22.4031s
	iters: 400, epoch: 2 | loss: 1.1503971
	speed: 0.0073s/iter; left time: 22.0864s
Updating learning rate to 0.00011340873709731094
Epoch: 2 cost time: 3.5640313625335693
Epoch: 2, Steps: 490 | Train Loss: 0.8877452 Vali Loss: 0.6109673 Best vali loss: 0.6085717
	iters: 100, epoch: 3 | loss: 1.1253610
	speed: 0.0211s/iter; left time: 59.9806s
	iters: 200, epoch: 3 | loss: 1.4104757
	speed: 0.0068s/iter; left time: 18.7178s
	iters: 300, epoch: 3 | loss: 0.6817119
	speed: 0.0070s/iter; left time: 18.3871s
	iters: 400, epoch: 3 | loss: 0.5523308
	speed: 0.0072s/iter; left time: 18.3835s
Updating learning rate to 9.185622340560807e-05
Validation loss decreased (0.6086 --> 0.5892).  Saving model state dict ...
Epoch: 3 cost time: 3.6053545475006104
Epoch: 3, Steps: 490 | Train Loss: 0.9424699 Vali Loss: 0.5891507 Best vali loss: 0.5891507

best validation loss 0.5891507204513426

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5807309
	speed: 0.0123s/iter; left time: 22.8597s
	iters: 200, epoch: 1 | loss: 0.7409284
	speed: 0.0061s/iter; left time: 10.7000s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.6367).  Saving model state dict ...
Epoch: 1 cost time: 1.8035778999328613
Epoch: 1, Steps: 245 | Train Loss: 0.6608296 Vali Loss: 0.6367342 Best vali loss: 0.6367342
	iters: 100, epoch: 2 | loss: 1.0173423
	speed: 0.0122s/iter; left time: 19.6740s
	iters: 200, epoch: 2 | loss: 0.8443964
	speed: 0.0066s/iter; left time: 9.9737s
Updating learning rate to 0.00164194791575
Epoch: 2 cost time: 1.6746065616607666
Epoch: 2, Steps: 245 | Train Loss: 0.9308694 Vali Loss: 0.6379378 Best vali loss: 0.6367342
	iters: 100, epoch: 3 | loss: 0.6295751
	speed: 0.0128s/iter; left time: 17.6152s
	iters: 200, epoch: 3 | loss: 1.1159779
	speed: 0.0064s/iter; left time: 8.1937s
Updating learning rate to 0.000820973957875
Epoch: 3 cost time: 1.6347630023956299
Epoch: 3, Steps: 245 | Train Loss: 0.8727765 Vali Loss: 0.6442756 Best vali loss: 0.6367342

best validation loss 0.6367341952983674

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 1, 'learning_rate': 5.33657676e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.33657676e-05
Validation loss decreased (inf --> 0.6422).  Saving model state dict ...
Epoch: 1 cost time: 0.681506872177124
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6422322 Best vali loss: 0.6422322
Updating learning rate to 2.66828838e-05
Validation loss decreased (0.6422 --> 0.6141).  Saving model state dict ...
Epoch: 2 cost time: 0.4230489730834961
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6141450 Best vali loss: 0.6141450
Updating learning rate to 1.33414419e-05
Validation loss decreased (0.6141 --> 0.6075).  Saving model state dict ...
Epoch: 3 cost time: 0.42728519439697266
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6074692 Best vali loss: 0.6074692

best validation loss 0.6074691888415554

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037670265647, 'e_layers': 4, 'learning_rate': 0.0001328666002, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6389740
	speed: 0.0135s/iter; left time: 31.6641s
	iters: 200, epoch: 4 | loss: 0.5660501
	speed: 0.0073s/iter; left time: 16.4908s
	iters: 300, epoch: 4 | loss: 0.7027238
	speed: 0.0074s/iter; left time: 16.0203s
	iters: 400, epoch: 4 | loss: 0.6563166
	speed: 0.0066s/iter; left time: 13.5816s
Updating learning rate to 6.64333001e-05
Validation loss decreased (0.5892 --> 0.5688).  Saving model state dict ...
Epoch: 4 cost time: 3.7124485969543457
Epoch: 4, Steps: 490 | Train Loss: 0.6410161 Vali Loss: 0.5687659 Best vali loss: 0.5687659
	iters: 100, epoch: 5 | loss: 1.3241804
	speed: 0.0191s/iter; left time: 35.5326s
	iters: 200, epoch: 5 | loss: 0.4860712
	speed: 0.0075s/iter; left time: 13.2104s
	iters: 300, epoch: 5 | loss: 0.4459585
	speed: 0.0075s/iter; left time: 12.4467s
	iters: 400, epoch: 5 | loss: 1.0568535
	speed: 0.0073s/iter; left time: 11.3440s
Updating learning rate to 4.101037679439195e-05
Validation loss decreased (0.5688 --> 0.5603).  Saving model state dict ...
Epoch: 5 cost time: 3.691617012023926
Epoch: 5, Steps: 490 | Train Loss: 0.8282659 Vali Loss: 0.5603224 Best vali loss: 0.5603224
	iters: 100, epoch: 6 | loss: 0.8933038
	speed: 0.0188s/iter; left time: 25.7519s
	iters: 200, epoch: 6 | loss: 1.3803836
	speed: 0.0074s/iter; left time: 9.3629s
	iters: 300, epoch: 6 | loss: 0.6392792
	speed: 0.0076s/iter; left time: 8.8931s
	iters: 400, epoch: 6 | loss: 0.5300327
	speed: 0.0075s/iter; left time: 8.0393s
Updating learning rate to 1.945786310268906e-05
Validation loss decreased (0.5603 --> 0.5543).  Saving model state dict ...
Epoch: 6 cost time: 3.6212007999420166
Epoch: 6, Steps: 490 | Train Loss: 0.8607498 Vali Loss: 0.5542723 Best vali loss: 0.5542723
	iters: 100, epoch: 7 | loss: 0.7363315
	speed: 0.0200s/iter; left time: 17.6428s
	iters: 200, epoch: 7 | loss: 0.5988605
	speed: 0.0065s/iter; left time: 5.1105s
	iters: 300, epoch: 7 | loss: 0.5186382
	speed: 0.0060s/iter; left time: 4.0522s
	iters: 400, epoch: 7 | loss: 0.5346376
	speed: 0.0050s/iter; left time: 2.9074s
Updating learning rate to 5.056933860429982e-06
Validation loss decreased (0.5543 --> 0.5486).  Saving model state dict ...
Epoch: 7 cost time: 3.0028226375579834
Epoch: 7, Steps: 490 | Train Loss: 0.5971169 Vali Loss: 0.5486389 Best vali loss: 0.5486389
	iters: 100, epoch: 8 | loss: 0.9687682
	speed: 0.0145s/iter; left time: 5.6753s
	iters: 200, epoch: 8 | loss: 0.3110020
	speed: 0.0077s/iter; left time: 2.2408s
	iters: 300, epoch: 8 | loss: 1.0389057
	speed: 0.0075s/iter; left time: 1.4231s
	iters: 400, epoch: 8 | loss: 0.7808920
	speed: 0.0076s/iter; left time: 0.6898s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.6441569328308105
Epoch: 8, Steps: 490 | Train Loss: 0.7748920 Vali Loss: 0.5515835 Best vali loss: 0.5486389

best validation loss 0.5486389462978737

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0014486999551, 'e_layers': 4, 'learning_rate': 0.000583131487, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6244619
	speed: 0.0139s/iter; left time: 52.9858s
	iters: 200, epoch: 1 | loss: 0.5370907
	speed: 0.0077s/iter; left time: 28.6144s
	iters: 300, epoch: 1 | loss: 0.4840374
	speed: 0.0078s/iter; left time: 28.2993s
	iters: 400, epoch: 1 | loss: 0.5653812
	speed: 0.0078s/iter; left time: 27.5809s
Updating learning rate to 0.0005609373663010857
Validation loss decreased (inf --> 0.6380).  Saving model state dict ...
Epoch: 1 cost time: 4.086735963821411
Epoch: 1, Steps: 490 | Train Loss: 0.5527428 Vali Loss: 0.6379521 Best vali loss: 0.6379521
	iters: 100, epoch: 2 | loss: 0.9374180
	speed: 0.0207s/iter; left time: 68.9510s
	iters: 200, epoch: 2 | loss: 0.2718697
	speed: 0.0077s/iter; left time: 24.9596s
	iters: 300, epoch: 2 | loss: 0.8223592
	speed: 0.0075s/iter; left time: 23.6059s
	iters: 400, epoch: 2 | loss: 0.8463946
	speed: 0.0078s/iter; left time: 23.7508s
Updating learning rate to 0.0004977338578905475
Validation loss decreased (0.6380 --> 0.6162).  Saving model state dict ...
Epoch: 2 cost time: 3.847257137298584
Epoch: 2, Steps: 490 | Train Loss: 0.7195104 Vali Loss: 0.6161716 Best vali loss: 0.6161716
	iters: 100, epoch: 3 | loss: 0.8410162
	speed: 0.0205s/iter; left time: 58.2132s
	iters: 200, epoch: 3 | loss: 0.8967686
	speed: 0.0078s/iter; left time: 21.4863s
	iters: 300, epoch: 3 | loss: 1.1793835
	speed: 0.0077s/iter; left time: 20.3373s
	iters: 400, epoch: 3 | loss: 1.1689676
	speed: 0.0077s/iter; left time: 19.5113s
Updating learning rate to 0.0004031431229826594
Epoch: 3 cost time: 3.808398723602295
Epoch: 3, Steps: 490 | Train Loss: 1.0215340 Vali Loss: 0.6449975 Best vali loss: 0.6161716
	iters: 100, epoch: 4 | loss: 0.8276100
	speed: 0.0195s/iter; left time: 45.8851s
	iters: 200, epoch: 4 | loss: 1.4263450
	speed: 0.0052s/iter; left time: 11.6497s
	iters: 300, epoch: 4 | loss: 0.5375783
	speed: 0.0064s/iter; left time: 13.7162s
	iters: 400, epoch: 4 | loss: 1.0553590
	speed: 0.0068s/iter; left time: 13.9526s
Updating learning rate to 0.0002915657435
Validation loss decreased (0.6162 --> 0.6136).  Saving model state dict ...
Epoch: 4 cost time: 3.1854820251464844
Epoch: 4, Steps: 490 | Train Loss: 0.9617231 Vali Loss: 0.6136092 Best vali loss: 0.6136092
	iters: 100, epoch: 5 | loss: 0.4765736
	speed: 0.0163s/iter; left time: 30.2933s
	iters: 200, epoch: 5 | loss: 0.6940719
	speed: 0.0079s/iter; left time: 13.9500s
	iters: 300, epoch: 5 | loss: 1.0172135
	speed: 0.0076s/iter; left time: 12.6473s
	iters: 400, epoch: 5 | loss: 1.1174793
	speed: 0.0077s/iter; left time: 11.9712s
Updating learning rate to 0.00017998836401734064
Epoch: 5 cost time: 3.663808822631836
Epoch: 5, Steps: 490 | Train Loss: 0.8263346 Vali Loss: 0.6204070 Best vali loss: 0.6136092
	iters: 100, epoch: 6 | loss: 0.8179021
	speed: 0.0212s/iter; left time: 29.1250s
	iters: 200, epoch: 6 | loss: 0.7278150
	speed: 0.0077s/iter; left time: 9.7527s
	iters: 300, epoch: 6 | loss: 0.7084495
	speed: 0.0075s/iter; left time: 8.7718s
	iters: 400, epoch: 6 | loss: 0.7078267
	speed: 0.0078s/iter; left time: 8.3625s
Updating learning rate to 8.539762910945248e-05
Epoch: 6 cost time: 3.8377525806427
Epoch: 6, Steps: 490 | Train Loss: 0.7404983 Vali Loss: 0.6446810 Best vali loss: 0.6136092
	iters: 100, epoch: 7 | loss: 0.4172269
	speed: 0.0203s/iter; left time: 17.8434s
	iters: 200, epoch: 7 | loss: 0.7859697
	speed: 0.0049s/iter; left time: 3.7957s
	iters: 300, epoch: 7 | loss: 1.3882207
	speed: 0.0060s/iter; left time: 4.0865s
	iters: 400, epoch: 7 | loss: 1.1144792
	speed: 0.0066s/iter; left time: 3.8077s
Updating learning rate to 2.219412069891426e-05
Epoch: 7 cost time: 3.0926835536956787
Epoch: 7, Steps: 490 | Train Loss: 0.9264741 Vali Loss: 0.6456207 Best vali loss: 0.6136092
	iters: 100, epoch: 8 | loss: 0.7296351
	speed: 0.0182s/iter; left time: 7.0972s
	iters: 200, epoch: 8 | loss: 0.7033672
	speed: 0.0071s/iter; left time: 2.0783s
	iters: 300, epoch: 8 | loss: 1.0582094
	speed: 0.0071s/iter; left time: 1.3640s
	iters: 400, epoch: 8 | loss: 0.9976469
	speed: 0.0068s/iter; left time: 0.6223s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4397637844085693
Epoch: 8, Steps: 490 | Train Loss: 0.8722147 Vali Loss: 0.6307684 Best vali loss: 0.6136092

best validation loss 0.6136091824470985

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.011623072433, 'e_layers': 3, 'learning_rate': 0.0006327740511, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5626829
	speed: 0.0122s/iter; left time: 94.5888s
	iters: 200, epoch: 1 | loss: 0.8727285
	speed: 0.0058s/iter; left time: 44.4971s
	iters: 300, epoch: 1 | loss: 0.9674034
	speed: 0.0062s/iter; left time: 46.8835s
	iters: 400, epoch: 1 | loss: 0.5397681
	speed: 0.0062s/iter; left time: 45.9676s
	iters: 500, epoch: 1 | loss: 1.2983774
	speed: 0.0055s/iter; left time: 40.0533s
	iters: 600, epoch: 1 | loss: 0.4085139
	speed: 0.0061s/iter; left time: 44.0369s
	iters: 700, epoch: 1 | loss: 0.3731331
	speed: 0.0062s/iter; left time: 44.3496s
	iters: 800, epoch: 1 | loss: 0.5684214
	speed: 0.0057s/iter; left time: 39.7680s
	iters: 900, epoch: 1 | loss: 0.5013110
	speed: 0.0061s/iter; left time: 42.2851s
Updating learning rate to 0.0006086905228077705
Validation loss decreased (inf --> 0.6713).  Saving model state dict ...
Epoch: 1 cost time: 6.1486921310424805
Epoch: 1, Steps: 979 | Train Loss: 0.6769266 Vali Loss: 0.6713468 Best vali loss: 0.6713468
	iters: 100, epoch: 2 | loss: 0.7037143
	speed: 0.0201s/iter; left time: 135.7701s
	iters: 200, epoch: 2 | loss: 1.4487412
	speed: 0.0061s/iter; left time: 40.5945s
	iters: 300, epoch: 2 | loss: 0.5163328
	speed: 0.0059s/iter; left time: 38.5332s
	iters: 400, epoch: 2 | loss: 1.4041138
	speed: 0.0046s/iter; left time: 29.5910s
	iters: 500, epoch: 2 | loss: 1.1814418
	speed: 0.0043s/iter; left time: 27.3678s
	iters: 600, epoch: 2 | loss: 1.2949978
	speed: 0.0072s/iter; left time: 45.0473s
	iters: 700, epoch: 2 | loss: 0.4387807
	speed: 0.0076s/iter; left time: 47.0357s
	iters: 800, epoch: 2 | loss: 0.3876404
	speed: 0.0073s/iter; left time: 44.2449s
	iters: 900, epoch: 2 | loss: 2.0355694
	speed: 0.0073s/iter; left time: 43.2154s
Updating learning rate to 0.0005401064367958465
Validation loss decreased (0.6713 --> 0.6437).  Saving model state dict ...
Epoch: 2 cost time: 6.2825963497161865
Epoch: 2, Steps: 979 | Train Loss: 1.0457036 Vali Loss: 0.6437217 Best vali loss: 0.6437217
	iters: 100, epoch: 3 | loss: 0.9552446
	speed: 0.0216s/iter; left time: 124.9461s
	iters: 200, epoch: 3 | loss: 0.5770870
	speed: 0.0039s/iter; left time: 22.0635s
	iters: 300, epoch: 3 | loss: 0.7459877
	speed: 0.0051s/iter; left time: 28.6697s
	iters: 400, epoch: 3 | loss: 1.0669188
	speed: 0.0062s/iter; left time: 34.0922s
	iters: 500, epoch: 3 | loss: 0.9384159
	speed: 0.0069s/iter; left time: 36.8231s
	iters: 600, epoch: 3 | loss: 0.7064168
	speed: 0.0063s/iter; left time: 33.3641s
	iters: 700, epoch: 3 | loss: 0.2763133
	speed: 0.0066s/iter; left time: 34.1998s
	iters: 800, epoch: 3 | loss: 1.2883080
	speed: 0.0065s/iter; left time: 33.0238s
	iters: 900, epoch: 3 | loss: 0.5615960
	speed: 0.0059s/iter; left time: 29.5040s
Updating learning rate to 0.00043746309844325536
Epoch: 3 cost time: 5.797086238861084
Epoch: 3, Steps: 979 | Train Loss: 0.7906987 Vali Loss: 0.6510293 Best vali loss: 0.6437217
	iters: 100, epoch: 4 | loss: 1.3691366
	speed: 0.0197s/iter; left time: 94.3185s
	iters: 200, epoch: 4 | loss: 1.5391757
	speed: 0.0067s/iter; left time: 31.2601s
	iters: 300, epoch: 4 | loss: 1.1446258
	speed: 0.0068s/iter; left time: 31.1042s
	iters: 400, epoch: 4 | loss: 0.8361697
	speed: 0.0066s/iter; left time: 29.8952s
	iters: 500, epoch: 4 | loss: 1.1063888
	speed: 0.0058s/iter; left time: 25.5209s
	iters: 600, epoch: 4 | loss: 0.5192623
	speed: 0.0061s/iter; left time: 26.0369s
	iters: 700, epoch: 4 | loss: 0.4659230
	speed: 0.0062s/iter; left time: 25.8063s
	iters: 800, epoch: 4 | loss: 0.5946468
	speed: 0.0060s/iter; left time: 24.6645s
	iters: 900, epoch: 4 | loss: 1.0725299
	speed: 0.0062s/iter; left time: 24.6666s
Updating learning rate to 0.00031638702555
Validation loss decreased (0.6437 --> 0.6390).  Saving model state dict ...
Epoch: 4 cost time: 6.202744483947754
Epoch: 4, Steps: 979 | Train Loss: 0.9608732 Vali Loss: 0.6390311 Best vali loss: 0.6390311
	iters: 100, epoch: 5 | loss: 0.3348506
	speed: 0.0202s/iter; left time: 77.0800s
	iters: 200, epoch: 5 | loss: 0.7141402
	speed: 0.0040s/iter; left time: 14.8889s
	iters: 300, epoch: 5 | loss: 0.5077087
	speed: 0.0041s/iter; left time: 14.9065s
	iters: 400, epoch: 5 | loss: 1.0872759
	speed: 0.0070s/iter; left time: 24.4873s
	iters: 500, epoch: 5 | loss: 1.9979938
	speed: 0.0068s/iter; left time: 23.2859s
	iters: 600, epoch: 5 | loss: 0.8568420
	speed: 0.0061s/iter; left time: 20.3717s
	iters: 700, epoch: 5 | loss: 1.0593559
	speed: 0.0064s/iter; left time: 20.4343s
	iters: 800, epoch: 5 | loss: 0.9253747
	speed: 0.0070s/iter; left time: 21.7292s
	iters: 900, epoch: 5 | loss: 0.9508741
	speed: 0.0066s/iter; left time: 19.9674s
Updating learning rate to 0.00019531095265674467
Validation loss decreased (0.6390 --> 0.6364).  Saving model state dict ...
Epoch: 5 cost time: 5.94594407081604
Epoch: 5, Steps: 979 | Train Loss: 0.9371573 Vali Loss: 0.6364469 Best vali loss: 0.6364469
	iters: 100, epoch: 6 | loss: 0.5960900
	speed: 0.0213s/iter; left time: 60.3958s
	iters: 200, epoch: 6 | loss: 0.9172960
	speed: 0.0048s/iter; left time: 13.2030s
	iters: 300, epoch: 6 | loss: 1.0140213
	speed: 0.0041s/iter; left time: 10.8599s
	iters: 400, epoch: 6 | loss: 1.0065259
	speed: 0.0063s/iter; left time: 16.0011s
	iters: 500, epoch: 6 | loss: 0.6240914
	speed: 0.0072s/iter; left time: 17.5789s
	iters: 600, epoch: 6 | loss: 1.1709452
	speed: 0.0067s/iter; left time: 15.7780s
	iters: 700, epoch: 6 | loss: 1.5413347
	speed: 0.0041s/iter; left time: 9.2510s
	iters: 800, epoch: 6 | loss: 1.1181153
	speed: 0.0043s/iter; left time: 9.1179s
	iters: 900, epoch: 6 | loss: 0.6056365
	speed: 0.0059s/iter; left time: 12.1232s
Updating learning rate to 9.266761430415355e-05
Epoch: 6 cost time: 5.586700439453125
Epoch: 6, Steps: 979 | Train Loss: 0.9548952 Vali Loss: 0.6451985 Best vali loss: 0.6364469
	iters: 100, epoch: 7 | loss: 0.9429902
	speed: 0.0205s/iter; left time: 38.0222s
	iters: 200, epoch: 7 | loss: 1.4195224
	speed: 0.0064s/iter; left time: 11.2594s
	iters: 300, epoch: 7 | loss: 0.4073378
	speed: 0.0063s/iter; left time: 10.4872s
	iters: 400, epoch: 7 | loss: 1.1038238
	speed: 0.0060s/iter; left time: 9.4207s
	iters: 500, epoch: 7 | loss: 0.6289547
	speed: 0.0063s/iter; left time: 9.1505s
	iters: 600, epoch: 7 | loss: 0.5403721
	speed: 0.0060s/iter; left time: 8.2042s
	iters: 700, epoch: 7 | loss: 0.4201921
	speed: 0.0061s/iter; left time: 7.6721s
	iters: 800, epoch: 7 | loss: 1.4938188
	speed: 0.0062s/iter; left time: 7.1499s
	iters: 900, epoch: 7 | loss: 0.8446602
	speed: 0.0064s/iter; left time: 6.8041s
Updating learning rate to 2.4083528292229468e-05
Epoch: 7 cost time: 6.189758777618408
Epoch: 7, Steps: 979 | Train Loss: 0.8668525 Vali Loss: 0.6476367 Best vali loss: 0.6364469
	iters: 100, epoch: 8 | loss: 0.6451266
	speed: 0.0204s/iter; left time: 17.9558s
	iters: 200, epoch: 8 | loss: 0.8641127
	speed: 0.0064s/iter; left time: 4.9905s
	iters: 300, epoch: 8 | loss: 0.7994033
	speed: 0.0068s/iter; left time: 4.6377s
	iters: 400, epoch: 8 | loss: 0.5994213
	speed: 0.0065s/iter; left time: 3.7793s
	iters: 500, epoch: 8 | loss: 0.9082004
	speed: 0.0064s/iter; left time: 3.0632s
	iters: 600, epoch: 8 | loss: 0.5034027
	speed: 0.0058s/iter; left time: 2.1974s
	iters: 700, epoch: 8 | loss: 0.2802458
	speed: 0.0061s/iter; left time: 1.7160s
	iters: 800, epoch: 8 | loss: 0.3683994
	speed: 0.0066s/iter; left time: 1.1832s
	iters: 900, epoch: 8 | loss: 1.1245195
	speed: 0.0062s/iter; left time: 0.4999s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.297740936279297
Epoch: 8, Steps: 979 | Train Loss: 0.6769813 Vali Loss: 0.6437284 Best vali loss: 0.6364469

best validation loss 0.6364468531109899

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005459653869797237
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 0.7847790718078613
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6086420 Best vali loss: 0.6086420
Updating learning rate to 0.0004844488434208944
Epoch: 2 cost time: 0.5425028800964355
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6545948 Best vali loss: 0.6086420
Updating learning rate to 0.00039238282983148796
Validation loss decreased (0.6086 --> 0.5814).  Saving model state dict ...
Epoch: 3 cost time: 0.5188412666320801
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5814122 Best vali loss: 0.5814122

best validation loss 0.5814122223346556

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008402255115, 'e_layers': 4, 'learning_rate': 0.0005990276297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7945020
	speed: 0.0133s/iter; left time: 50.9844s
	iters: 200, epoch: 1 | loss: 0.7552011
	speed: 0.0053s/iter; left time: 19.6483s
	iters: 300, epoch: 1 | loss: 1.0589104
	speed: 0.0049s/iter; left time: 17.9208s
	iters: 400, epoch: 1 | loss: 0.4882730
	speed: 0.0049s/iter; left time: 17.2019s
Updating learning rate to 0.00057622849809429
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 3.042698860168457
Epoch: 1, Steps: 490 | Train Loss: 0.7742216 Vali Loss: 0.6058367 Best vali loss: 0.6058367
	iters: 100, epoch: 2 | loss: 0.5913212
	speed: 0.0183s/iter; left time: 61.0170s
	iters: 200, epoch: 2 | loss: 1.1021713
	speed: 0.0075s/iter; left time: 24.2835s
	iters: 300, epoch: 2 | loss: 0.8865203
	speed: 0.0074s/iter; left time: 23.1051s
	iters: 400, epoch: 2 | loss: 0.9879968
	speed: 0.0074s/iter; left time: 22.4508s
Updating learning rate to 0.000511302064389487
Validation loss decreased (0.6058 --> 0.5784).  Saving model state dict ...
Epoch: 2 cost time: 3.643311023712158
Epoch: 2, Steps: 490 | Train Loss: 0.8920024 Vali Loss: 0.5783902 Best vali loss: 0.5783902
	iters: 100, epoch: 3 | loss: 0.8029541
	speed: 0.0190s/iter; left time: 53.9112s
	iters: 200, epoch: 3 | loss: 0.9471322
	speed: 0.0075s/iter; left time: 20.5111s
	iters: 300, epoch: 3 | loss: 0.6917207
	speed: 0.0076s/iter; left time: 20.1709s
	iters: 400, epoch: 3 | loss: 0.4794430
	speed: 0.0075s/iter; left time: 19.0117s
Updating learning rate to 0.00041413278955756
Validation loss decreased (0.5784 --> 0.5510).  Saving model state dict ...
Epoch: 3 cost time: 3.7031092643737793
Epoch: 3, Steps: 490 | Train Loss: 0.7303125 Vali Loss: 0.5509632 Best vali loss: 0.5509632

best validation loss 0.5509632470595621

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0055356354333, 'e_layers': 4, 'learning_rate': 0.0007477641146, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7929525
	speed: 0.0136s/iter; left time: 52.0522s
	iters: 200, epoch: 1 | loss: 0.8753088
	speed: 0.0074s/iter; left time: 27.5073s
	iters: 300, epoch: 1 | loss: 0.7069422
	speed: 0.0073s/iter; left time: 26.3353s
	iters: 400, epoch: 1 | loss: 0.7168996
	speed: 0.0074s/iter; left time: 26.0677s
Updating learning rate to 0.0007477641146
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 3.9128036499023438
Epoch: 1, Steps: 490 | Train Loss: 0.7730258 Vali Loss: 0.6063822 Best vali loss: 0.6063822
	iters: 100, epoch: 2 | loss: 0.6758835
	speed: 0.0195s/iter; left time: 65.0992s
	iters: 200, epoch: 2 | loss: 1.0537497
	speed: 0.0074s/iter; left time: 23.9963s
	iters: 300, epoch: 2 | loss: 0.3477654
	speed: 0.0073s/iter; left time: 22.7405s
	iters: 400, epoch: 2 | loss: 0.6237382
	speed: 0.0074s/iter; left time: 22.2887s
Updating learning rate to 0.0003738820573
Epoch: 2 cost time: 3.6667096614837646
Epoch: 2, Steps: 490 | Train Loss: 0.6752842 Vali Loss: 0.6102516 Best vali loss: 0.6063822
	iters: 100, epoch: 3 | loss: 0.4651440
	speed: 0.0198s/iter; left time: 56.1585s
	iters: 200, epoch: 3 | loss: 0.5074249
	speed: 0.0074s/iter; left time: 20.1718s
	iters: 300, epoch: 3 | loss: 0.7312627
	speed: 0.0074s/iter; left time: 19.5633s
	iters: 400, epoch: 3 | loss: 1.0558509
	speed: 0.0077s/iter; left time: 19.6595s
Updating learning rate to 0.00018694102865
Epoch: 3 cost time: 3.701413631439209
Epoch: 3, Steps: 490 | Train Loss: 0.6899206 Vali Loss: 0.6089204 Best vali loss: 0.6063822

best validation loss 0.6063821780521634

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008402255115, 'e_layers': 4, 'learning_rate': 0.0005990276297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7351317
	speed: 0.0142s/iter; left time: 33.3503s
	iters: 200, epoch: 4 | loss: 0.7324997
	speed: 0.0073s/iter; left time: 16.4143s
	iters: 300, epoch: 4 | loss: 0.9644514
	speed: 0.0074s/iter; left time: 15.8162s
	iters: 400, epoch: 4 | loss: 0.4853469
	speed: 0.0072s/iter; left time: 14.8245s
Updating learning rate to 0.00029951381485
Epoch: 4 cost time: 3.9174933433532715
Epoch: 4, Steps: 490 | Train Loss: 0.7293574 Vali Loss: 0.5601316 Best vali loss: 0.5509632
	iters: 100, epoch: 5 | loss: 0.5737535
	speed: 0.0197s/iter; left time: 36.6535s
	iters: 200, epoch: 5 | loss: 1.0680944
	speed: 0.0074s/iter; left time: 12.9537s
	iters: 300, epoch: 5 | loss: 0.8345469
	speed: 0.0076s/iter; left time: 12.5413s
	iters: 400, epoch: 5 | loss: 0.8900738
	speed: 0.0073s/iter; left time: 11.4717s
Updating learning rate to 0.00018489484014244
Validation loss decreased (0.5510 --> 0.5474).  Saving model state dict ...
Epoch: 5 cost time: 3.6925456523895264
Epoch: 5, Steps: 490 | Train Loss: 0.8416172 Vali Loss: 0.5473583 Best vali loss: 0.5473583
	iters: 100, epoch: 6 | loss: 0.6915267
	speed: 0.0198s/iter; left time: 27.1549s
	iters: 200, epoch: 6 | loss: 0.8810202
	speed: 0.0076s/iter; left time: 9.6120s
	iters: 300, epoch: 6 | loss: 0.6058906
	speed: 0.0070s/iter; left time: 8.2356s
	iters: 400, epoch: 6 | loss: 0.4435151
	speed: 0.0049s/iter; left time: 5.2994s
Updating learning rate to 8.772556531051295e-05
Validation loss decreased (0.5474 --> 0.5455).  Saving model state dict ...
Epoch: 6 cost time: 3.196676015853882
Epoch: 6, Steps: 490 | Train Loss: 0.6554881 Vali Loss: 0.5454890 Best vali loss: 0.5454890
	iters: 100, epoch: 7 | loss: 0.9540134
	speed: 0.0164s/iter; left time: 14.4880s
	iters: 200, epoch: 7 | loss: 0.7108697
	speed: 0.0067s/iter; left time: 5.2476s
	iters: 300, epoch: 7 | loss: 0.8182366
	speed: 0.0067s/iter; left time: 4.5461s
	iters: 400, epoch: 7 | loss: 0.6659235
	speed: 0.0069s/iter; left time: 4.0352s
Updating learning rate to 2.2799131605709908e-05
Epoch: 7 cost time: 3.3941633701324463
Epoch: 7, Steps: 490 | Train Loss: 0.7872608 Vali Loss: 0.5467330 Best vali loss: 0.5454890
	iters: 100, epoch: 8 | loss: 0.7034896
	speed: 0.0185s/iter; left time: 7.2490s
	iters: 200, epoch: 8 | loss: 0.9904055
	speed: 0.0065s/iter; left time: 1.8930s
	iters: 300, epoch: 8 | loss: 0.3382992
	speed: 0.0060s/iter; left time: 1.1371s
	iters: 400, epoch: 8 | loss: 0.9491150
	speed: 0.0064s/iter; left time: 0.5835s
Updating learning rate to 0.0
Validation loss decreased (0.5455 --> 0.5442).  Saving model state dict ...
Epoch: 8 cost time: 3.2117738723754883
Epoch: 8, Steps: 490 | Train Loss: 0.7453273 Vali Loss: 0.5441563 Best vali loss: 0.5441563

best validation loss 0.5441562810922209

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7197578
	speed: 0.0099s/iter; left time: 18.4146s
	iters: 200, epoch: 1 | loss: 0.9926225
	speed: 0.0037s/iter; left time: 6.5688s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 1.2085566520690918
Epoch: 1, Steps: 245 | Train Loss: 0.8561901 Vali Loss: 0.6077624 Best vali loss: 0.6077624
	iters: 100, epoch: 2 | loss: 0.9781685
	speed: 0.0085s/iter; left time: 13.6930s
	iters: 200, epoch: 2 | loss: 0.8433773
	speed: 0.0039s/iter; left time: 5.8424s
Updating learning rate to 0.00021594413975
Validation loss decreased (0.6078 --> 0.6070).  Saving model state dict ...
Epoch: 2 cost time: 0.9805023670196533
Epoch: 2, Steps: 245 | Train Loss: 0.9107729 Vali Loss: 0.6070031 Best vali loss: 0.6070031
	iters: 100, epoch: 3 | loss: 1.1971464
	speed: 0.0087s/iter; left time: 11.9655s
	iters: 200, epoch: 3 | loss: 0.6087537
	speed: 0.0036s/iter; left time: 4.6179s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.9433572292327881
Epoch: 3, Steps: 245 | Train Loss: 0.9029500 Vali Loss: 0.6315957 Best vali loss: 0.6070031
	iters: 100, epoch: 4 | loss: 0.9195051
	speed: 0.0079s/iter; left time: 8.8692s
	iters: 200, epoch: 4 | loss: 0.8947055
	speed: 0.0032s/iter; left time: 3.3105s
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.8421568870544434
Epoch: 4, Steps: 245 | Train Loss: 0.9071053 Vali Loss: 0.6224906 Best vali loss: 0.6070031
	iters: 100, epoch: 5 | loss: 0.9493450
	speed: 0.0079s/iter; left time: 6.9463s
	iters: 200, epoch: 5 | loss: 0.8465419
	speed: 0.0037s/iter; left time: 2.8932s
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.9556188583374023
Epoch: 5, Steps: 245 | Train Loss: 0.8979435 Vali Loss: 0.6423531 Best vali loss: 0.6070031
	iters: 100, epoch: 6 | loss: 0.5788472
	speed: 0.0087s/iter; left time: 5.5552s
	iters: 200, epoch: 6 | loss: 0.9047786
	speed: 0.0039s/iter; left time: 2.1121s
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 1.0236809253692627
Epoch: 6, Steps: 245 | Train Loss: 0.7418129 Vali Loss: 0.6381870 Best vali loss: 0.6070031
	iters: 100, epoch: 7 | loss: 0.5380388
	speed: 0.0085s/iter; left time: 3.3328s
	iters: 200, epoch: 7 | loss: 0.7663111
	speed: 0.0041s/iter; left time: 1.1822s
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 1.0161185264587402
Epoch: 7, Steps: 245 | Train Loss: 0.6521749 Vali Loss: 0.6439627 Best vali loss: 0.6070031
	iters: 100, epoch: 8 | loss: 0.8474100
	speed: 0.0089s/iter; left time: 1.2992s
	iters: 200, epoch: 8 | loss: 0.6932415
	speed: 0.0038s/iter; left time: 0.1748s
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.9786238670349121
Epoch: 8, Steps: 245 | Train Loss: 0.7703257 Vali Loss: 0.6416288 Best vali loss: 0.6070031

best validation loss 0.6070031016747856

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7025761
	speed: 0.0140s/iter; left time: 12.4020s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 1.2535889148712158
Epoch: 1, Steps: 123 | Train Loss: 0.7025761 Vali Loss: 0.6100594 Best vali loss: 0.6100594
	iters: 100, epoch: 2 | loss: 1.0044965
	speed: 0.0135s/iter; left time: 10.2845s
Updating learning rate to 6.252043389458952e-05
Validation loss decreased (0.6101 --> 0.6064).  Saving model state dict ...
Epoch: 2 cost time: 1.1543540954589844
Epoch: 2, Steps: 123 | Train Loss: 1.0044965 Vali Loss: 0.6063891 Best vali loss: 0.6063891
	iters: 100, epoch: 3 | loss: 0.7285230
	speed: 0.0141s/iter; left time: 9.0260s
Updating learning rate to 5.063887571827247e-05
Validation loss decreased (0.6064 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 1.170670747756958
Epoch: 3, Steps: 123 | Train Loss: 0.7285230 Vali Loss: 0.6030534 Best vali loss: 0.6030534
	iters: 100, epoch: 4 | loss: 0.8062402
	speed: 0.0142s/iter; left time: 7.3389s
Updating learning rate to 3.662362225e-05
Validation loss decreased (0.6031 --> 0.5952).  Saving model state dict ...
Epoch: 4 cost time: 1.174525499343872
Epoch: 4, Steps: 123 | Train Loss: 0.8062402 Vali Loss: 0.5951983 Best vali loss: 0.5951983
	iters: 100, epoch: 5 | loss: 0.9836579
	speed: 0.0141s/iter; left time: 5.5423s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.5952 --> 0.5714).  Saving model state dict ...
Epoch: 5 cost time: 1.1794548034667969
Epoch: 5, Steps: 123 | Train Loss: 0.9836579 Vali Loss: 0.5713671 Best vali loss: 0.5713671
	iters: 100, epoch: 6 | loss: 0.6842610
	speed: 0.0142s/iter; left time: 3.8306s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.5714 --> 0.5653).  Saving model state dict ...
Epoch: 6 cost time: 1.166513204574585
Epoch: 6, Steps: 123 | Train Loss: 0.6842610 Vali Loss: 0.5652615 Best vali loss: 0.5652615
	iters: 100, epoch: 7 | loss: 0.9271832
	speed: 0.0134s/iter; left time: 1.9650s
Updating learning rate to 2.7878072468000404e-06
Validation loss decreased (0.5653 --> 0.5542).  Saving model state dict ...
Epoch: 7 cost time: 1.0649194717407227
Epoch: 7, Steps: 123 | Train Loss: 0.9271832 Vali Loss: 0.5542402 Best vali loss: 0.5542402
	iters: 100, epoch: 8 | loss: 0.8825958
	speed: 0.0131s/iter; left time: 0.3140s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1098661422729492
Epoch: 8, Steps: 123 | Train Loss: 0.8825958 Vali Loss: 0.5558105 Best vali loss: 0.5542402

best validation loss 0.5542401946677703

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.002861454165, 'e_layers': 1, 'learning_rate': 5.78622565e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.78622565e-05
Validation loss decreased (inf --> 0.6995).  Saving model state dict ...
Epoch: 1 cost time: 0.6681981086730957
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6994699 Best vali loss: 0.6994699
Updating learning rate to 2.893112825e-05
Validation loss decreased (0.6995 --> 0.6863).  Saving model state dict ...
Epoch: 2 cost time: 0.4439046382904053
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6862600 Best vali loss: 0.6862600
Updating learning rate to 1.4465564125e-05
Validation loss decreased (0.6863 --> 0.6802).  Saving model state dict ...
Epoch: 3 cost time: 0.4233992099761963
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6801782 Best vali loss: 0.6801782

best validation loss 0.6801781775718594

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 4, 'learning_rate': 0.0001249829864, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8815941
	speed: 0.0151s/iter; left time: 28.1802s
	iters: 200, epoch: 1 | loss: 0.6679977
	speed: 0.0096s/iter; left time: 16.9076s
Updating learning rate to 0.0001249829864
Validation loss decreased (inf --> 0.5980).  Saving model state dict ...
Epoch: 1 cost time: 2.630033254623413
Epoch: 1, Steps: 245 | Train Loss: 0.7747959 Vali Loss: 0.5979521 Best vali loss: 0.5979521
	iters: 100, epoch: 2 | loss: 0.8296462
	speed: 0.0183s/iter; left time: 29.5356s
	iters: 200, epoch: 2 | loss: 0.6349977
	speed: 0.0095s/iter; left time: 14.3484s
Updating learning rate to 6.24914932e-05
Validation loss decreased (0.5980 --> 0.5577).  Saving model state dict ...
Epoch: 2 cost time: 2.3652637004852295
Epoch: 2, Steps: 245 | Train Loss: 0.7323219 Vali Loss: 0.5577185 Best vali loss: 0.5577185
	iters: 100, epoch: 3 | loss: 0.9948792
	speed: 0.0186s/iter; left time: 25.5137s
	iters: 200, epoch: 3 | loss: 0.7307107
	speed: 0.0095s/iter; left time: 12.0557s
Updating learning rate to 3.12457466e-05
Validation loss decreased (0.5577 --> 0.5555).  Saving model state dict ...
Epoch: 3 cost time: 2.373194456100464
Epoch: 3, Steps: 245 | Train Loss: 0.8627950 Vali Loss: 0.5555026 Best vali loss: 0.5555026

best validation loss 0.5555025792574232

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0029426146637, 'e_layers': 4, 'learning_rate': 0.0001092263501, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8031034
	speed: 0.0125s/iter; left time: 47.6570s
	iters: 200, epoch: 1 | loss: 1.0750844
	speed: 0.0067s/iter; left time: 24.9469s
	iters: 300, epoch: 1 | loss: 1.1920742
	speed: 0.0067s/iter; left time: 24.4301s
	iters: 400, epoch: 1 | loss: 0.7522662
	speed: 0.0068s/iter; left time: 24.0439s
Updating learning rate to 0.00010506916968415107
Validation loss decreased (inf --> 0.6423).  Saving model state dict ...
Epoch: 1 cost time: 3.6080331802368164
Epoch: 1, Steps: 490 | Train Loss: 0.9556321 Vali Loss: 0.6423428 Best vali loss: 0.6423428
	iters: 100, epoch: 2 | loss: 0.5764174
	speed: 0.0185s/iter; left time: 61.5233s
	iters: 200, epoch: 2 | loss: 1.2489308
	speed: 0.0068s/iter; left time: 21.9879s
	iters: 300, epoch: 2 | loss: 1.1202319
	speed: 0.0060s/iter; left time: 18.8901s
	iters: 400, epoch: 2 | loss: 0.6033891
	speed: 0.0064s/iter; left time: 19.3398s
Updating learning rate to 9.323052146998297e-05
Validation loss decreased (0.6423 --> 0.6219).  Saving model state dict ...
Epoch: 2 cost time: 3.289422035217285
Epoch: 2, Steps: 490 | Train Loss: 0.8872423 Vali Loss: 0.6219114 Best vali loss: 0.6219114
	iters: 100, epoch: 3 | loss: 0.5177807
	speed: 0.0184s/iter; left time: 52.4110s
	iters: 200, epoch: 3 | loss: 0.7153497
	speed: 0.0068s/iter; left time: 18.6278s
	iters: 300, epoch: 3 | loss: 0.6929233
	speed: 0.0068s/iter; left time: 18.0229s
	iters: 400, epoch: 3 | loss: 0.6357276
	speed: 0.0069s/iter; left time: 17.4093s
Updating learning rate to 7.55127323304895e-05
Validation loss decreased (0.6219 --> 0.6116).  Saving model state dict ...
Epoch: 3 cost time: 3.3786139488220215
Epoch: 3, Steps: 490 | Train Loss: 0.6404453 Vali Loss: 0.6115867 Best vali loss: 0.6115867

best validation loss 0.611586749994992

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 4, 'learning_rate': 0.0001249829864, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7778533
	speed: 0.0130s/iter; left time: 14.6517s
	iters: 200, epoch: 4 | loss: 0.5572702
	speed: 0.0091s/iter; left time: 9.3243s
Updating learning rate to 1.56228733e-05
Validation loss decreased (0.5555 --> 0.5427).  Saving model state dict ...
Epoch: 4 cost time: 2.3205349445343018
Epoch: 4, Steps: 245 | Train Loss: 0.6675618 Vali Loss: 0.5427290 Best vali loss: 0.5427290
	iters: 100, epoch: 5 | loss: 0.7086667
	speed: 0.0169s/iter; left time: 14.8502s
	iters: 200, epoch: 5 | loss: 0.5843493
	speed: 0.0070s/iter; left time: 5.4495s
Updating learning rate to 7.81143665e-06
Validation loss decreased (0.5427 --> 0.5391).  Saving model state dict ...
Epoch: 5 cost time: 1.9456191062927246
Epoch: 5, Steps: 245 | Train Loss: 0.6465080 Vali Loss: 0.5391239 Best vali loss: 0.5391239
	iters: 100, epoch: 6 | loss: 0.9299634
	speed: 0.0177s/iter; left time: 11.2606s
	iters: 200, epoch: 6 | loss: 0.6428215
	speed: 0.0094s/iter; left time: 5.0180s
Updating learning rate to 3.905718325e-06
Validation loss decreased (0.5391 --> 0.5372).  Saving model state dict ...
Epoch: 6 cost time: 2.3299782276153564
Epoch: 6, Steps: 245 | Train Loss: 0.7863925 Vali Loss: 0.5371578 Best vali loss: 0.5371578
	iters: 100, epoch: 7 | loss: 0.5567958
	speed: 0.0179s/iter; left time: 7.0144s
	iters: 200, epoch: 7 | loss: 0.8220320
	speed: 0.0088s/iter; left time: 2.5560s
Updating learning rate to 1.9528591625e-06
Epoch: 7 cost time: 2.2410783767700195
Epoch: 7, Steps: 245 | Train Loss: 0.6894139 Vali Loss: 0.5389130 Best vali loss: 0.5371578
	iters: 100, epoch: 8 | loss: 0.5108851
	speed: 0.0172s/iter; left time: 2.5164s
	iters: 200, epoch: 8 | loss: 1.0158803
	speed: 0.0092s/iter; left time: 0.4249s
Updating learning rate to 9.7642958125e-07
Epoch: 8 cost time: 2.3150336742401123
Epoch: 8, Steps: 245 | Train Loss: 0.7633827 Vali Loss: 0.5381712 Best vali loss: 0.5371578

best validation loss 0.5371577784950012

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0044504804088, 'e_layers': 1, 'learning_rate': 0.0002904810984, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00027942531989657855
Validation loss decreased (inf --> 0.6582).  Saving model state dict ...
Epoch: 1 cost time: 0.757244348526001
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6582143 Best vali loss: 0.6582143
Updating learning rate to 0.00024794112644257836
Validation loss decreased (0.6582 --> 0.6238).  Saving model state dict ...
Epoch: 2 cost time: 0.49711108207702637
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6238244 Best vali loss: 0.6238244
Updating learning rate to 0.0002008217010864467
Validation loss decreased (0.6238 --> 0.6099).  Saving model state dict ...
Epoch: 3 cost time: 0.4956953525543213
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6099146 Best vali loss: 0.6099146
Updating learning rate to 0.0001452405492
Validation loss decreased (0.6099 --> 0.6056).  Saving model state dict ...
Epoch: 4 cost time: 0.49943971633911133
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6055729 Best vali loss: 0.6055729
Updating learning rate to 8.965939731355332e-05
Validation loss decreased (0.6056 --> 0.6036).  Saving model state dict ...
Epoch: 5 cost time: 0.5011818408966064
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6035507 Best vali loss: 0.6035507
Updating learning rate to 4.253997195742162e-05
Validation loss decreased (0.6036 --> 0.6035).  Saving model state dict ...
Epoch: 6 cost time: 0.5366051197052002
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6034748 Best vali loss: 0.6034748
Updating learning rate to 1.1055778503421459e-05
Epoch: 7 cost time: 0.4175403118133545
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6037651 Best vali loss: 0.6034748
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4729938507080078
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6036247 Best vali loss: 0.6034748

best validation loss 0.6034747653678301

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0111055611489, 'e_layers': 3, 'learning_rate': 8.17960163e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5026813
	speed: 0.0121s/iter; left time: 46.3961s
	iters: 200, epoch: 1 | loss: 0.9017782
	speed: 0.0063s/iter; left time: 23.3821s
	iters: 300, epoch: 1 | loss: 0.8337842
	speed: 0.0065s/iter; left time: 23.3985s
	iters: 400, epoch: 1 | loss: 1.0163916
	speed: 0.0063s/iter; left time: 22.0754s
Updating learning rate to 7.86828408002648e-05
Validation loss decreased (inf --> 0.6453).  Saving model state dict ...
Epoch: 1 cost time: 3.4166135787963867
Epoch: 1, Steps: 490 | Train Loss: 0.8136588 Vali Loss: 0.6452557 Best vali loss: 0.6452557
	iters: 100, epoch: 2 | loss: 0.7182950
	speed: 0.0173s/iter; left time: 57.5573s
	iters: 200, epoch: 2 | loss: 0.8250666
	speed: 0.0065s/iter; left time: 20.9475s
	iters: 300, epoch: 2 | loss: 0.7127340
	speed: 0.0064s/iter; left time: 20.0956s
	iters: 400, epoch: 2 | loss: 1.0077465
	speed: 0.0063s/iter; left time: 19.1589s
Updating learning rate to 6.98172670498877e-05
Validation loss decreased (0.6453 --> 0.6239).  Saving model state dict ...
Epoch: 2 cost time: 3.161602020263672
Epoch: 2, Steps: 490 | Train Loss: 0.8159605 Vali Loss: 0.6238924 Best vali loss: 0.6238924
	iters: 100, epoch: 3 | loss: 1.0853026
	speed: 0.0169s/iter; left time: 48.0978s
	iters: 200, epoch: 3 | loss: 1.3467664
	speed: 0.0065s/iter; left time: 17.7454s
	iters: 300, epoch: 3 | loss: 1.5891019
	speed: 0.0065s/iter; left time: 17.2234s
	iters: 400, epoch: 3 | loss: 1.0649852
	speed: 0.0064s/iter; left time: 16.1935s
Updating learning rate to 5.654899828573742e-05
Validation loss decreased (0.6239 --> 0.6172).  Saving model state dict ...
Epoch: 3 cost time: 3.2250115871429443
Epoch: 3, Steps: 490 | Train Loss: 1.2715390 Vali Loss: 0.6172132 Best vali loss: 0.6172132
	iters: 100, epoch: 4 | loss: 0.6592888
	speed: 0.0150s/iter; left time: 35.2231s
	iters: 200, epoch: 4 | loss: 0.8582719
	speed: 0.0061s/iter; left time: 13.7539s
	iters: 300, epoch: 4 | loss: 0.8639497
	speed: 0.0065s/iter; left time: 13.9879s
	iters: 400, epoch: 4 | loss: 1.0109830
	speed: 0.0066s/iter; left time: 13.5266s
Updating learning rate to 4.089800815e-05
Validation loss decreased (0.6172 --> 0.6161).  Saving model state dict ...
Epoch: 4 cost time: 3.0521621704101562
Epoch: 4, Steps: 490 | Train Loss: 0.8481233 Vali Loss: 0.6160837 Best vali loss: 0.6160837
	iters: 100, epoch: 5 | loss: 0.5133917
	speed: 0.0173s/iter; left time: 32.1938s
	iters: 200, epoch: 5 | loss: 1.4765943
	speed: 0.0046s/iter; left time: 8.1859s
	iters: 300, epoch: 5 | loss: 0.6695243
	speed: 0.0055s/iter; left time: 9.1172s
	iters: 400, epoch: 5 | loss: 0.9554000
	speed: 0.0074s/iter; left time: 11.6008s
Updating learning rate to 2.5247018014262588e-05
Validation loss decreased (0.6161 --> 0.6101).  Saving model state dict ...
Epoch: 5 cost time: 2.9799821376800537
Epoch: 5, Steps: 490 | Train Loss: 0.9037276 Vali Loss: 0.6100577 Best vali loss: 0.6100577
	iters: 100, epoch: 6 | loss: 1.0006908
	speed: 0.0195s/iter; left time: 26.6702s
	iters: 200, epoch: 6 | loss: 0.6474454
	speed: 0.0077s/iter; left time: 9.7694s
	iters: 300, epoch: 6 | loss: 0.6493482
	speed: 0.0076s/iter; left time: 8.8511s
	iters: 400, epoch: 6 | loss: 0.7212916
	speed: 0.0074s/iter; left time: 7.9185s
Updating learning rate to 1.1978749250112316e-05
Epoch: 6 cost time: 3.674010992050171
Epoch: 6, Steps: 490 | Train Loss: 0.7546940 Vali Loss: 0.6134211 Best vali loss: 0.6100577
	iters: 100, epoch: 7 | loss: 0.9066513
	speed: 0.0207s/iter; left time: 18.2522s
	iters: 200, epoch: 7 | loss: 0.4075822
	speed: 0.0064s/iter; left time: 4.9860s
	iters: 300, epoch: 7 | loss: 1.2506452
	speed: 0.0081s/iter; left time: 5.5045s
	iters: 400, epoch: 7 | loss: 0.7574189
	speed: 0.0069s/iter; left time: 4.0300s
Updating learning rate to 3.1131754997352054e-06
Epoch: 7 cost time: 3.6921961307525635
Epoch: 7, Steps: 490 | Train Loss: 0.8305744 Vali Loss: 0.6126247 Best vali loss: 0.6100577
	iters: 100, epoch: 8 | loss: 0.4817104
	speed: 0.0167s/iter; left time: 6.5116s
	iters: 200, epoch: 8 | loss: 1.2915399
	speed: 0.0055s/iter; left time: 1.5982s
	iters: 300, epoch: 8 | loss: 0.9333308
	speed: 0.0085s/iter; left time: 1.6223s
	iters: 400, epoch: 8 | loss: 0.9269857
	speed: 0.0073s/iter; left time: 0.6608s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4182090759277344
Epoch: 8, Steps: 490 | Train Loss: 0.9083917 Vali Loss: 0.6122983 Best vali loss: 0.6100577

best validation loss 0.6100577112702736

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0072636125698, 'e_layers': 3, 'learning_rate': 0.0026797239204, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1061007
	speed: 0.0148s/iter; left time: 56.4144s
	iters: 200, epoch: 1 | loss: 0.9859815
	speed: 0.0072s/iter; left time: 26.7768s
	iters: 300, epoch: 1 | loss: 1.9013798
	speed: 0.0089s/iter; left time: 32.0922s
	iters: 400, epoch: 1 | loss: 1.6240457
	speed: 0.0071s/iter; left time: 24.9240s
Updating learning rate to 0.0026797239204
Validation loss decreased (inf --> 0.6326).  Saving model state dict ...
Epoch: 1 cost time: 4.3034327030181885
Epoch: 1, Steps: 490 | Train Loss: 1.4043769 Vali Loss: 0.6326014 Best vali loss: 0.6326014
	iters: 100, epoch: 2 | loss: 1.3422375
	speed: 0.0224s/iter; left time: 74.5287s
	iters: 200, epoch: 2 | loss: 0.5652521
	speed: 0.0071s/iter; left time: 23.0061s
	iters: 300, epoch: 2 | loss: 0.3983199
	speed: 0.0087s/iter; left time: 27.2613s
	iters: 400, epoch: 2 | loss: 0.5037374
	speed: 0.0052s/iter; left time: 15.8642s
Updating learning rate to 0.0013398619602
Epoch: 2 cost time: 3.453979253768921
Epoch: 2, Steps: 490 | Train Loss: 0.7023867 Vali Loss: 0.6497186 Best vali loss: 0.6326014
	iters: 100, epoch: 3 | loss: 1.2273331
	speed: 0.0121s/iter; left time: 34.3938s
	iters: 200, epoch: 3 | loss: 1.6505387
	speed: 0.0050s/iter; left time: 13.6775s
	iters: 300, epoch: 3 | loss: 0.7889458
	speed: 0.0060s/iter; left time: 15.9571s
	iters: 400, epoch: 3 | loss: 1.0290995
	speed: 0.0065s/iter; left time: 16.4064s
Updating learning rate to 0.0006699309801
Epoch: 3 cost time: 2.7403008937835693
Epoch: 3, Steps: 490 | Train Loss: 1.1739793 Vali Loss: 0.6482622 Best vali loss: 0.6326014

best validation loss 0.6326014034343174

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0011116320123, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0308926
	speed: 0.0137s/iter; left time: 12.0992s
Updating learning rate to 0.0011116320123
Validation loss decreased (inf --> 0.6130).  Saving model state dict ...
Epoch: 1 cost time: 1.2563974857330322
Epoch: 1, Steps: 123 | Train Loss: 1.0308926 Vali Loss: 0.6129888 Best vali loss: 0.6129888
	iters: 100, epoch: 2 | loss: 0.7669069
	speed: 0.0113s/iter; left time: 8.5965s
Updating learning rate to 0.00055581600615
Epoch: 2 cost time: 0.8339028358459473
Epoch: 2, Steps: 123 | Train Loss: 0.7669069 Vali Loss: 0.6130500 Best vali loss: 0.6129888
	iters: 100, epoch: 3 | loss: 0.9465466
	speed: 0.0117s/iter; left time: 7.5082s
Updating learning rate to 0.000277908003075
Validation loss decreased (0.6130 --> 0.6028).  Saving model state dict ...
Epoch: 3 cost time: 0.9852597713470459
Epoch: 3, Steps: 123 | Train Loss: 0.9465466 Vali Loss: 0.6027996 Best vali loss: 0.6027996

best validation loss 0.6027995904580911

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0085651972878, 'e_layers': 3, 'learning_rate': 0.0005146719463, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8815320
	speed: 0.0167s/iter; left time: 30.9888s
	iters: 200, epoch: 1 | loss: 0.7238629
	speed: 0.0107s/iter; left time: 18.8340s
Updating learning rate to 0.0004950834117221591
Validation loss decreased (inf --> 0.6364).  Saving model state dict ...
Epoch: 1 cost time: 2.906803846359253
Epoch: 1, Steps: 245 | Train Loss: 0.8026974 Vali Loss: 0.6364348 Best vali loss: 0.6364348
	iters: 100, epoch: 2 | loss: 0.8975468
	speed: 0.0186s/iter; left time: 30.0099s
	iters: 200, epoch: 2 | loss: 1.0598413
	speed: 0.0059s/iter; left time: 8.8722s
Updating learning rate to 0.0004392999848076043
Validation loss decreased (0.6364 --> 0.6140).  Saving model state dict ...
Epoch: 2 cost time: 1.8164613246917725
Epoch: 2, Steps: 245 | Train Loss: 0.9786940 Vali Loss: 0.6139687 Best vali loss: 0.6139687
	iters: 100, epoch: 3 | loss: 0.5571509
	speed: 0.0148s/iter; left time: 20.3217s
	iters: 200, epoch: 3 | loss: 0.8306884
	speed: 0.0079s/iter; left time: 9.9814s
Updating learning rate to 0.0003558141866260526
Validation loss decreased (0.6140 --> 0.6105).  Saving model state dict ...
Epoch: 3 cost time: 1.9711925983428955
Epoch: 3, Steps: 245 | Train Loss: 0.6939197 Vali Loss: 0.6105470 Best vali loss: 0.6105470

best validation loss 0.6105470101847686

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0011116320123, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0230920
	speed: 0.0115s/iter; left time: 5.9511s
Updating learning rate to 0.0001389540015375
Validation loss decreased (0.6028 --> 0.6003).  Saving model state dict ...
Epoch: 4 cost time: 0.9955654144287109
Epoch: 4, Steps: 123 | Train Loss: 1.0230920 Vali Loss: 0.6002677 Best vali loss: 0.6002677
	iters: 100, epoch: 5 | loss: 0.7601969
	speed: 0.0093s/iter; left time: 3.6528s
Updating learning rate to 6.947700076875e-05
Epoch: 5 cost time: 0.7195024490356445
Epoch: 5, Steps: 123 | Train Loss: 0.7601969 Vali Loss: 0.6034691 Best vali loss: 0.6002677
	iters: 100, epoch: 6 | loss: 0.9418671
	speed: 0.0093s/iter; left time: 2.5146s
Updating learning rate to 3.4738500384375e-05
Epoch: 6 cost time: 0.7340672016143799
Epoch: 6, Steps: 123 | Train Loss: 0.9418671 Vali Loss: 0.6028232 Best vali loss: 0.6002677
	iters: 100, epoch: 7 | loss: 0.7885733
	speed: 0.0092s/iter; left time: 1.3506s
Updating learning rate to 1.73692501921875e-05
Epoch: 7 cost time: 0.6893472671508789
Epoch: 7, Steps: 123 | Train Loss: 0.7885733 Vali Loss: 0.6016596 Best vali loss: 0.6002677
	iters: 100, epoch: 8 | loss: 1.0299370
	speed: 0.0092s/iter; left time: 0.2197s
Updating learning rate to 8.68462509609375e-06
Epoch: 8 cost time: 0.7317473888397217
Epoch: 8, Steps: 123 | Train Loss: 1.0299370 Vali Loss: 0.6019117 Best vali loss: 0.6002677

best validation loss 0.600267714783308

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8481805
	speed: 0.0134s/iter; left time: 11.8761s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.6699).  Saving model state dict ...
Epoch: 1 cost time: 1.2289056777954102
Epoch: 1, Steps: 123 | Train Loss: 0.8481805 Vali Loss: 0.6699286 Best vali loss: 0.6699286
	iters: 100, epoch: 2 | loss: 0.6296231
	speed: 0.0118s/iter; left time: 8.9618s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.6699 --> 0.6448).  Saving model state dict ...
Epoch: 2 cost time: 0.9024689197540283
Epoch: 2, Steps: 123 | Train Loss: 0.6296231 Vali Loss: 0.6447909 Best vali loss: 0.6447909
	iters: 100, epoch: 3 | loss: 0.9809685
	speed: 0.0118s/iter; left time: 7.5284s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.6448 --> 0.6316).  Saving model state dict ...
Epoch: 3 cost time: 1.0868618488311768
Epoch: 3, Steps: 123 | Train Loss: 0.9809685 Vali Loss: 0.6316080 Best vali loss: 0.6316080
	iters: 100, epoch: 4 | loss: 0.7621754
	speed: 0.0147s/iter; left time: 7.5801s
Updating learning rate to 7.5835271e-05
Validation loss decreased (0.6316 --> 0.6248).  Saving model state dict ...
Epoch: 4 cost time: 1.2112553119659424
Epoch: 4, Steps: 123 | Train Loss: 0.7621754 Vali Loss: 0.6247965 Best vali loss: 0.6247965
	iters: 100, epoch: 5 | loss: 0.6670482
	speed: 0.0142s/iter; left time: 5.5671s
Updating learning rate to 4.681436919938325e-05
Validation loss decreased (0.6248 --> 0.6202).  Saving model state dict ...
Epoch: 5 cost time: 1.1827032566070557
Epoch: 5, Steps: 123 | Train Loss: 0.6670482 Vali Loss: 0.6201791 Best vali loss: 0.6201791
	iters: 100, epoch: 6 | loss: 0.9155949
	speed: 0.0148s/iter; left time: 3.9946s
Updating learning rate to 2.221163662278047e-05
Validation loss decreased (0.6202 --> 0.6188).  Saving model state dict ...
Epoch: 6 cost time: 1.2122955322265625
Epoch: 6, Steps: 123 | Train Loss: 0.9155949 Vali Loss: 0.6188255 Best vali loss: 0.6188255
	iters: 100, epoch: 7 | loss: 0.9130991
	speed: 0.0153s/iter; left time: 2.2438s
Updating learning rate to 5.772616280653259e-06
Validation loss decreased (0.6188 --> 0.6172).  Saving model state dict ...
Epoch: 7 cost time: 1.239102840423584
Epoch: 7, Steps: 123 | Train Loss: 0.9130991 Vali Loss: 0.6172056 Best vali loss: 0.6172056
	iters: 100, epoch: 8 | loss: 0.8542234
	speed: 0.0150s/iter; left time: 0.3612s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2348713874816895
Epoch: 8, Steps: 123 | Train Loss: 0.8542234 Vali Loss: 0.6173105 Best vali loss: 0.6172056

best validation loss 0.6172056264868493

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0011065600884, 'e_layers': 4, 'learning_rate': 0.0011706271719, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1087106
	speed: 0.0155s/iter; left time: 28.8927s
	iters: 200, epoch: 1 | loss: 0.7525179
	speed: 0.0089s/iter; left time: 15.5988s
Updating learning rate to 0.0011260728281099908
Validation loss decreased (inf --> 0.6053).  Saving model state dict ...
Epoch: 1 cost time: 2.5790281295776367
Epoch: 1, Steps: 245 | Train Loss: 0.9306143 Vali Loss: 0.6052590 Best vali loss: 0.6052590
	iters: 100, epoch: 2 | loss: 1.0419011
	speed: 0.0177s/iter; left time: 28.6420s
	iters: 200, epoch: 2 | loss: 0.9968362
	speed: 0.0080s/iter; left time: 12.1782s
Updating learning rate to 0.00099919279169586
Validation loss decreased (0.6053 --> 0.5833).  Saving model state dict ...
Epoch: 2 cost time: 2.0285768508911133
Epoch: 2, Steps: 245 | Train Loss: 1.0193687 Vali Loss: 0.5832772 Best vali loss: 0.5832772
	iters: 100, epoch: 3 | loss: 0.9925173
	speed: 0.0121s/iter; left time: 16.6042s
	iters: 200, epoch: 3 | loss: 0.5043529
	speed: 0.0072s/iter; left time: 9.1294s
Updating learning rate to 0.000809303398031265
Validation loss decreased (0.5833 --> 0.5590).  Saving model state dict ...
Epoch: 3 cost time: 1.7869772911071777
Epoch: 3, Steps: 245 | Train Loss: 0.7484351 Vali Loss: 0.5589929 Best vali loss: 0.5589929
	iters: 100, epoch: 4 | loss: 0.7157786
	speed: 0.0147s/iter; left time: 16.5286s
	iters: 200, epoch: 4 | loss: 0.6100960
	speed: 0.0073s/iter; left time: 7.5066s
Updating learning rate to 0.00058531358595
Epoch: 4 cost time: 1.8724822998046875
Epoch: 4, Steps: 245 | Train Loss: 0.6629373 Vali Loss: 0.5671233 Best vali loss: 0.5589929
	iters: 100, epoch: 5 | loss: 1.0680845
	speed: 0.0151s/iter; left time: 13.3207s
	iters: 200, epoch: 5 | loss: 0.7447771
	speed: 0.0055s/iter; left time: 4.3194s
Updating learning rate to 0.000361323773868735
Validation loss decreased (0.5590 --> 0.5589).  Saving model state dict ...
Epoch: 5 cost time: 1.6576497554779053
Epoch: 5, Steps: 245 | Train Loss: 0.9064308 Vali Loss: 0.5588769 Best vali loss: 0.5588769
	iters: 100, epoch: 6 | loss: 0.4856827
	speed: 0.0131s/iter; left time: 8.3385s
	iters: 200, epoch: 6 | loss: 0.7643859
	speed: 0.0068s/iter; left time: 3.6516s
Updating learning rate to 0.00017143438020413989
Validation loss decreased (0.5589 --> 0.5502).  Saving model state dict ...
Epoch: 6 cost time: 1.7189738750457764
Epoch: 6, Steps: 245 | Train Loss: 0.6250343 Vali Loss: 0.5501962 Best vali loss: 0.5501962
	iters: 100, epoch: 7 | loss: 0.9809154
	speed: 0.0134s/iter; left time: 5.2246s
	iters: 200, epoch: 7 | loss: 0.7159182
	speed: 0.0072s/iter; left time: 2.0985s
Updating learning rate to 4.455434379000915e-05
Epoch: 7 cost time: 1.7465291023254395
Epoch: 7, Steps: 245 | Train Loss: 0.8484168 Vali Loss: 0.5531785 Best vali loss: 0.5501962
	iters: 100, epoch: 8 | loss: 0.6829112
	speed: 0.0136s/iter; left time: 1.9907s
	iters: 200, epoch: 8 | loss: 0.4327718
	speed: 0.0066s/iter; left time: 0.3039s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.663315773010254
Epoch: 8, Steps: 245 | Train Loss: 0.5578415 Vali Loss: 0.5519122 Best vali loss: 0.5501962

best validation loss 0.5501962129245583

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013301090585, 'e_layers': 1, 'learning_rate': 0.0017944511294, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0173224
	speed: 0.0111s/iter; left time: 9.8103s
Updating learning rate to 0.0017944511294
Validation loss decreased (inf --> 0.6014).  Saving model state dict ...
Epoch: 1 cost time: 0.9221422672271729
Epoch: 1, Steps: 123 | Train Loss: 1.0173224 Vali Loss: 0.6014477 Best vali loss: 0.6014477
	iters: 100, epoch: 2 | loss: 0.9443519
	speed: 0.0095s/iter; left time: 7.2374s
Updating learning rate to 0.0008972255647
Epoch: 2 cost time: 0.7416551113128662
Epoch: 2, Steps: 123 | Train Loss: 0.9443519 Vali Loss: 0.6173472 Best vali loss: 0.6014477
	iters: 100, epoch: 3 | loss: 0.6112146
	speed: 0.0096s/iter; left time: 6.1309s
Updating learning rate to 0.00044861278235
Epoch: 3 cost time: 0.7286324501037598
Epoch: 3, Steps: 123 | Train Loss: 0.6112146 Vali Loss: 0.6058656 Best vali loss: 0.6014477

best validation loss 0.6014477019782201

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0024236762505, 'e_layers': 2, 'learning_rate': 0.0003084774503, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8109984
	speed: 0.0120s/iter; left time: 22.3537s
	iters: 200, epoch: 1 | loss: 0.7197374
	speed: 0.0056s/iter; left time: 9.7796s
Updating learning rate to 0.0003084774503
Validation loss decreased (inf --> 0.6310).  Saving model state dict ...
Epoch: 1 cost time: 1.6837451457977295
Epoch: 1, Steps: 245 | Train Loss: 0.7653679 Vali Loss: 0.6309783 Best vali loss: 0.6309783
	iters: 100, epoch: 2 | loss: 0.7656599
	speed: 0.0117s/iter; left time: 18.9156s
	iters: 200, epoch: 2 | loss: 0.6651142
	speed: 0.0059s/iter; left time: 8.9227s
Updating learning rate to 0.00015423872515
Validation loss decreased (0.6310 --> 0.6127).  Saving model state dict ...
Epoch: 2 cost time: 1.4608819484710693
Epoch: 2, Steps: 245 | Train Loss: 0.7153870 Vali Loss: 0.6127220 Best vali loss: 0.6127220
	iters: 100, epoch: 3 | loss: 0.7328560
	speed: 0.0117s/iter; left time: 16.0349s
	iters: 200, epoch: 3 | loss: 0.8768615
	speed: 0.0056s/iter; left time: 7.1199s
Updating learning rate to 7.7119362575e-05
Validation loss decreased (0.6127 --> 0.6076).  Saving model state dict ...
Epoch: 3 cost time: 1.4437294006347656
Epoch: 3, Steps: 245 | Train Loss: 0.8048588 Vali Loss: 0.6075971 Best vali loss: 0.6075971

best validation loss 0.6075970561677578

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029638074311, 'e_layers': 2, 'learning_rate': 0.0001213169042, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4974910
	speed: 0.0110s/iter; left time: 41.8450s
	iters: 200, epoch: 1 | loss: 1.1608362
	speed: 0.0055s/iter; left time: 20.5255s
	iters: 300, epoch: 1 | loss: 0.9002630
	speed: 0.0055s/iter; left time: 19.8753s
	iters: 400, epoch: 1 | loss: 0.9158296
	speed: 0.0057s/iter; left time: 19.9412s
Updating learning rate to 0.0001213169042
Validation loss decreased (inf --> 0.5668).  Saving model state dict ...
Epoch: 1 cost time: 3.004582643508911
Epoch: 1, Steps: 490 | Train Loss: 1.1186049 Vali Loss: 0.5667695 Best vali loss: 0.5667695
	iters: 100, epoch: 2 | loss: 0.2712773
	speed: 0.0159s/iter; left time: 53.0248s
	iters: 200, epoch: 2 | loss: 1.0453565
	speed: 0.0050s/iter; left time: 16.2653s
	iters: 300, epoch: 2 | loss: 1.0445774
	speed: 0.0052s/iter; left time: 16.2532s
	iters: 400, epoch: 2 | loss: 0.3745669
	speed: 0.0052s/iter; left time: 15.7930s
Updating learning rate to 6.06584521e-05
Validation loss decreased (0.5668 --> 0.5521).  Saving model state dict ...
Epoch: 2 cost time: 2.604712963104248
Epoch: 2, Steps: 490 | Train Loss: 0.6839445 Vali Loss: 0.5521371 Best vali loss: 0.5521371
	iters: 100, epoch: 3 | loss: 1.0022229
	speed: 0.0165s/iter; left time: 46.8999s
	iters: 200, epoch: 3 | loss: 0.9103979
	speed: 0.0051s/iter; left time: 14.0750s
	iters: 300, epoch: 3 | loss: 0.3521323
	speed: 0.0056s/iter; left time: 14.6597s
	iters: 400, epoch: 3 | loss: 1.5017676
	speed: 0.0053s/iter; left time: 13.4035s
Updating learning rate to 3.032922605e-05
Validation loss decreased (0.5521 --> 0.5496).  Saving model state dict ...
Epoch: 3 cost time: 2.702528953552246
Epoch: 3, Steps: 490 | Train Loss: 0.9416302 Vali Loss: 0.5495992 Best vali loss: 0.5495992

best validation loss 0.5495992122646395

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029638074311, 'e_layers': 2, 'learning_rate': 0.0001213169042, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.3888721
	speed: 0.0117s/iter; left time: 27.4591s
	iters: 200, epoch: 4 | loss: 1.0936840
	speed: 0.0050s/iter; left time: 11.1998s
	iters: 300, epoch: 4 | loss: 0.7764693
	speed: 0.0036s/iter; left time: 7.7100s
	iters: 400, epoch: 4 | loss: 0.7357191
	speed: 0.0037s/iter; left time: 7.5634s
Updating learning rate to 1.5164613025e-05
Validation loss decreased (0.5496 --> 0.5355).  Saving model state dict ...
Epoch: 4 cost time: 2.5558419227600098
Epoch: 4, Steps: 490 | Train Loss: 0.9986861 Vali Loss: 0.5355150 Best vali loss: 0.5355150
	iters: 100, epoch: 5 | loss: 0.2616332
	speed: 0.0171s/iter; left time: 31.8852s
	iters: 200, epoch: 5 | loss: 1.0356419
	speed: 0.0061s/iter; left time: 10.6544s
	iters: 300, epoch: 5 | loss: 1.0162514
	speed: 0.0057s/iter; left time: 9.4628s
	iters: 400, epoch: 5 | loss: 0.3413088
	speed: 0.0057s/iter; left time: 8.8883s
Updating learning rate to 7.5823065125e-06
Validation loss decreased (0.5355 --> 0.5348).  Saving model state dict ...
Epoch: 5 cost time: 2.8782453536987305
Epoch: 5, Steps: 490 | Train Loss: 0.6637088 Vali Loss: 0.5348000 Best vali loss: 0.5348000
	iters: 100, epoch: 6 | loss: 0.9627463
	speed: 0.0158s/iter; left time: 21.6728s
	iters: 200, epoch: 6 | loss: 0.8800749
	speed: 0.0058s/iter; left time: 7.3563s
	iters: 300, epoch: 6 | loss: 0.3510978
	speed: 0.0058s/iter; left time: 6.8286s
	iters: 400, epoch: 6 | loss: 1.4634123
	speed: 0.0059s/iter; left time: 6.3339s
Updating learning rate to 3.79115325625e-06
Epoch: 6 cost time: 2.8866984844207764
Epoch: 6, Steps: 490 | Train Loss: 0.9143328 Vali Loss: 0.5348191 Best vali loss: 0.5348000
	iters: 100, epoch: 7 | loss: 0.4747230
	speed: 0.0170s/iter; left time: 14.9585s
	iters: 200, epoch: 7 | loss: 0.7477274
	speed: 0.0058s/iter; left time: 4.5517s
	iters: 300, epoch: 7 | loss: 0.8917808
	speed: 0.0059s/iter; left time: 4.0343s
	iters: 400, epoch: 7 | loss: 0.5746610
	speed: 0.0057s/iter; left time: 3.3169s
Updating learning rate to 1.895576628125e-06
Validation loss decreased (0.5348 --> 0.5344).  Saving model state dict ...
Epoch: 7 cost time: 2.924264907836914
Epoch: 7, Steps: 490 | Train Loss: 0.6722231 Vali Loss: 0.5343662 Best vali loss: 0.5343662
	iters: 100, epoch: 8 | loss: 0.4849084
	speed: 0.0170s/iter; left time: 6.6368s
	iters: 200, epoch: 8 | loss: 0.6770344
	speed: 0.0036s/iter; left time: 1.0343s
	iters: 300, epoch: 8 | loss: 0.6375024
	speed: 0.0036s/iter; left time: 0.6821s
	iters: 400, epoch: 8 | loss: 0.7723868
	speed: 0.0043s/iter; left time: 0.3919s
Updating learning rate to 9.477883140625e-07
Validation loss decreased (0.5344 --> 0.5325).  Saving model state dict ...
Epoch: 8 cost time: 2.2283987998962402
Epoch: 8, Steps: 490 | Train Loss: 0.6429580 Vali Loss: 0.5324563 Best vali loss: 0.5324563

best validation loss 0.5324562537841143

[INFO][abstract_intensifier.py:595] Added config a3fda7 and rejected config 134b22 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023210420786, 'e_layers': 2, 'learning_rate': 5.47631081e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7867995
	speed: 0.0090s/iter; left time: 69.4554s
	iters: 200, epoch: 1 | loss: 1.6550041
	speed: 0.0034s/iter; left time: 25.5769s
	iters: 300, epoch: 1 | loss: 0.9007150
	speed: 0.0054s/iter; left time: 40.7955s
	iters: 400, epoch: 1 | loss: 0.2851613
	speed: 0.0076s/iter; left time: 56.1361s
	iters: 500, epoch: 1 | loss: 1.3471073
	speed: 0.0073s/iter; left time: 53.6655s
	iters: 600, epoch: 1 | loss: 1.1353633
	speed: 0.0052s/iter; left time: 37.6756s
	iters: 700, epoch: 1 | loss: 0.4005836
	speed: 0.0071s/iter; left time: 50.8567s
	iters: 800, epoch: 1 | loss: 0.7387939
	speed: 0.0073s/iter; left time: 51.3239s
	iters: 900, epoch: 1 | loss: 0.6040806
	speed: 0.0065s/iter; left time: 44.9486s
Updating learning rate to 5.47631081e-05
Validation loss decreased (inf --> 0.6137).  Saving model state dict ...
Epoch: 1 cost time: 5.981289625167847
Epoch: 1, Steps: 979 | Train Loss: 0.8726232 Vali Loss: 0.6137376 Best vali loss: 0.6137376
	iters: 100, epoch: 2 | loss: 0.9150826
	speed: 0.0235s/iter; left time: 158.4589s
	iters: 200, epoch: 2 | loss: 1.1733159
	speed: 0.0043s/iter; left time: 28.2834s
	iters: 300, epoch: 2 | loss: 1.3205793
	speed: 0.0036s/iter; left time: 23.6419s
	iters: 400, epoch: 2 | loss: 0.5855362
	speed: 0.0037s/iter; left time: 23.8807s
	iters: 500, epoch: 2 | loss: 1.4308488
	speed: 0.0047s/iter; left time: 29.6708s
	iters: 600, epoch: 2 | loss: 1.0107375
	speed: 0.0046s/iter; left time: 29.0806s
	iters: 700, epoch: 2 | loss: 1.0092801
	speed: 0.0045s/iter; left time: 27.6593s
	iters: 800, epoch: 2 | loss: 0.6015409
	speed: 0.0047s/iter; left time: 28.6031s
	iters: 900, epoch: 2 | loss: 0.7043057
	speed: 0.0045s/iter; left time: 26.6340s
Updating learning rate to 2.738155405e-05
Validation loss decreased (0.6137 --> 0.6111).  Saving model state dict ...
Epoch: 2 cost time: 4.577390670776367
Epoch: 2, Steps: 979 | Train Loss: 0.9723586 Vali Loss: 0.6110841 Best vali loss: 0.6110841
	iters: 100, epoch: 3 | loss: 1.3616228
	speed: 0.0169s/iter; left time: 97.4241s
	iters: 200, epoch: 3 | loss: 0.3335649
	speed: 0.0047s/iter; left time: 26.5293s
	iters: 300, epoch: 3 | loss: 0.9943836
	speed: 0.0032s/iter; left time: 17.8653s
	iters: 400, epoch: 3 | loss: 0.6663240
	speed: 0.0031s/iter; left time: 17.0470s
	iters: 500, epoch: 3 | loss: 1.1642053
	speed: 0.0032s/iter; left time: 17.2354s
	iters: 600, epoch: 3 | loss: 0.3869186
	speed: 0.0031s/iter; left time: 16.1196s
	iters: 700, epoch: 3 | loss: 0.2522601
	speed: 0.0031s/iter; left time: 15.7988s
	iters: 800, epoch: 3 | loss: 1.0067108
	speed: 0.0034s/iter; left time: 17.3815s
	iters: 900, epoch: 3 | loss: 0.4433003
	speed: 0.0049s/iter; left time: 24.3355s
Updating learning rate to 1.3690777025e-05
Validation loss decreased (0.6111 --> 0.6036).  Saving model state dict ...
Epoch: 3 cost time: 3.757770538330078
Epoch: 3, Steps: 979 | Train Loss: 0.7343656 Vali Loss: 0.6035547 Best vali loss: 0.6035547
	iters: 100, epoch: 4 | loss: 0.5698795
	speed: 0.0161s/iter; left time: 77.2809s
	iters: 200, epoch: 4 | loss: 0.7144330
	speed: 0.0045s/iter; left time: 20.9459s
	iters: 300, epoch: 4 | loss: 1.6136798
	speed: 0.0047s/iter; left time: 21.3815s
	iters: 400, epoch: 4 | loss: 0.8133991
	speed: 0.0047s/iter; left time: 21.0841s
	iters: 500, epoch: 4 | loss: 0.7760255
	speed: 0.0045s/iter; left time: 19.8867s
	iters: 600, epoch: 4 | loss: 1.1121495
	speed: 0.0047s/iter; left time: 20.0701s
	iters: 700, epoch: 4 | loss: 0.9113725
	speed: 0.0046s/iter; left time: 19.4506s
	iters: 800, epoch: 4 | loss: 0.3495087
	speed: 0.0044s/iter; left time: 17.9101s
	iters: 900, epoch: 4 | loss: 0.3013422
	speed: 0.0050s/iter; left time: 19.9416s
Updating learning rate to 6.8453885125e-06
Epoch: 4 cost time: 4.575940847396851
Epoch: 4, Steps: 979 | Train Loss: 0.7957544 Vali Loss: 0.6079579 Best vali loss: 0.6035547
	iters: 100, epoch: 5 | loss: 1.1628736
	speed: 0.0164s/iter; left time: 62.7189s
	iters: 200, epoch: 5 | loss: 0.6157740
	speed: 0.0045s/iter; left time: 16.6487s
	iters: 300, epoch: 5 | loss: 1.4359301
	speed: 0.0046s/iter; left time: 16.8009s
	iters: 400, epoch: 5 | loss: 0.7636102
	speed: 0.0046s/iter; left time: 16.1822s
	iters: 500, epoch: 5 | loss: 0.7932327
	speed: 0.0047s/iter; left time: 16.1658s
	iters: 600, epoch: 5 | loss: 0.3697878
	speed: 0.0047s/iter; left time: 15.5485s
	iters: 700, epoch: 5 | loss: 0.8455799
	speed: 0.0046s/iter; left time: 14.7040s
	iters: 800, epoch: 5 | loss: 0.5318960
	speed: 0.0033s/iter; left time: 10.4023s
	iters: 900, epoch: 5 | loss: 0.8347751
	speed: 0.0033s/iter; left time: 9.9762s
Updating learning rate to 3.42269425625e-06
Epoch: 5 cost time: 4.217690944671631
Epoch: 5, Steps: 979 | Train Loss: 0.8170511 Vali Loss: 0.6041529 Best vali loss: 0.6035547
	iters: 100, epoch: 6 | loss: 0.4474453
	speed: 0.0155s/iter; left time: 44.0556s
	iters: 200, epoch: 6 | loss: 0.8433096
	speed: 0.0046s/iter; left time: 12.6201s
	iters: 300, epoch: 6 | loss: 0.5236298
	speed: 0.0045s/iter; left time: 11.8941s
	iters: 400, epoch: 6 | loss: 0.3000741
	speed: 0.0046s/iter; left time: 11.7736s
	iters: 500, epoch: 6 | loss: 0.8231469
	speed: 0.0048s/iter; left time: 11.6125s
	iters: 600, epoch: 6 | loss: 0.6724795
	speed: 0.0049s/iter; left time: 11.3647s
	iters: 700, epoch: 6 | loss: 0.4781586
	speed: 0.0046s/iter; left time: 10.3872s
	iters: 800, epoch: 6 | loss: 1.6790786
	speed: 0.0047s/iter; left time: 10.0419s
	iters: 900, epoch: 6 | loss: 1.0319090
	speed: 0.0049s/iter; left time: 10.0709s
Updating learning rate to 1.711347128125e-06
Epoch: 6 cost time: 4.723542213439941
Epoch: 6, Steps: 979 | Train Loss: 0.7554701 Vali Loss: 0.6055622 Best vali loss: 0.6035547
	iters: 100, epoch: 7 | loss: 0.4977635
	speed: 0.0169s/iter; left time: 31.4830s
	iters: 200, epoch: 7 | loss: 1.0765940
	speed: 0.0046s/iter; left time: 8.0291s
	iters: 300, epoch: 7 | loss: 1.4620898
	speed: 0.0048s/iter; left time: 7.9986s
	iters: 400, epoch: 7 | loss: 0.3830385
	speed: 0.0047s/iter; left time: 7.3872s
	iters: 500, epoch: 7 | loss: 0.7513415
	speed: 0.0046s/iter; left time: 6.7078s
	iters: 600, epoch: 7 | loss: 1.1401280
	speed: 0.0045s/iter; left time: 6.1635s
	iters: 700, epoch: 7 | loss: 0.2399619
	speed: 0.0049s/iter; left time: 6.2291s
	iters: 800, epoch: 7 | loss: 1.1331760
	speed: 0.0047s/iter; left time: 5.4891s
	iters: 900, epoch: 7 | loss: 0.7293622
	speed: 0.0052s/iter; left time: 5.5169s
Updating learning rate to 8.556735640625e-07
Epoch: 7 cost time: 4.705921649932861
Epoch: 7, Steps: 979 | Train Loss: 0.8237173 Vali Loss: 0.6069378 Best vali loss: 0.6035547
	iters: 100, epoch: 8 | loss: 0.4317385
	speed: 0.0161s/iter; left time: 14.1525s
	iters: 200, epoch: 8 | loss: 0.8158182
	speed: 0.0049s/iter; left time: 3.8549s
	iters: 300, epoch: 8 | loss: 1.1555914
	speed: 0.0045s/iter; left time: 3.0791s
	iters: 400, epoch: 8 | loss: 0.7406856
	speed: 0.0048s/iter; left time: 2.7673s
	iters: 500, epoch: 8 | loss: 1.1283486
	speed: 0.0044s/iter; left time: 2.0976s
	iters: 600, epoch: 8 | loss: 1.4569938
	speed: 0.0047s/iter; left time: 1.7870s
	iters: 700, epoch: 8 | loss: 0.4755813
	speed: 0.0050s/iter; left time: 1.3903s
	iters: 800, epoch: 8 | loss: 0.5491500
	speed: 0.0045s/iter; left time: 0.8029s
	iters: 900, epoch: 8 | loss: 0.3440976
	speed: 0.0053s/iter; left time: 0.4235s
Updating learning rate to 4.2783678203125e-07
Epoch: 8 cost time: 4.704848766326904
Epoch: 8, Steps: 979 | Train Loss: 0.7886672 Vali Loss: 0.6074747 Best vali loss: 0.6035547

best validation loss 0.6035547091805344

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 3, 'learning_rate': 6.09485552e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3025879
	speed: 0.0108s/iter; left time: 41.2979s
	iters: 200, epoch: 1 | loss: 1.1762289
	speed: 0.0059s/iter; left time: 21.9370s
	iters: 300, epoch: 1 | loss: 0.8731757
	speed: 0.0061s/iter; left time: 21.9154s
	iters: 400, epoch: 1 | loss: 0.7943646
	speed: 0.0060s/iter; left time: 20.9607s
Updating learning rate to 6.09485552e-05
Validation loss decreased (inf --> 0.6410).  Saving model state dict ...
Epoch: 1 cost time: 3.1462128162384033
Epoch: 1, Steps: 490 | Train Loss: 1.0365893 Vali Loss: 0.6409514 Best vali loss: 0.6409514
	iters: 100, epoch: 2 | loss: 1.3732293
	speed: 0.0138s/iter; left time: 45.9718s
	iters: 200, epoch: 2 | loss: 0.7097630
	speed: 0.0060s/iter; left time: 19.4498s
	iters: 300, epoch: 2 | loss: 0.8688041
	speed: 0.0056s/iter; left time: 17.4354s
	iters: 400, epoch: 2 | loss: 0.7385759
	speed: 0.0059s/iter; left time: 17.9776s
Updating learning rate to 3.04742776e-05
Validation loss decreased (0.6410 --> 0.6161).  Saving model state dict ...
Epoch: 2 cost time: 2.7840464115142822
Epoch: 2, Steps: 490 | Train Loss: 0.9225931 Vali Loss: 0.6161212 Best vali loss: 0.6161212
	iters: 100, epoch: 3 | loss: 0.9340639
	speed: 0.0174s/iter; left time: 49.3384s
	iters: 200, epoch: 3 | loss: 0.7039762
	speed: 0.0058s/iter; left time: 15.9969s
	iters: 300, epoch: 3 | loss: 0.9258292
	speed: 0.0056s/iter; left time: 14.8775s
	iters: 400, epoch: 3 | loss: 0.5797555
	speed: 0.0060s/iter; left time: 15.1541s
Updating learning rate to 1.52371388e-05
Validation loss decreased (0.6161 --> 0.6143).  Saving model state dict ...
Epoch: 3 cost time: 2.7543840408325195
Epoch: 3, Steps: 490 | Train Loss: 0.7859062 Vali Loss: 0.6143263 Best vali loss: 0.6143263
	iters: 100, epoch: 4 | loss: 1.3717153
	speed: 0.0141s/iter; left time: 33.0476s
	iters: 200, epoch: 4 | loss: 1.1213460
	speed: 0.0066s/iter; left time: 14.8738s
	iters: 300, epoch: 4 | loss: 0.9656956
	speed: 0.0065s/iter; left time: 14.0448s
	iters: 400, epoch: 4 | loss: 0.6203834
	speed: 0.0070s/iter; left time: 14.2691s
Updating learning rate to 7.6185694e-06
Epoch: 4 cost time: 3.3144986629486084
Epoch: 4, Steps: 490 | Train Loss: 1.0197851 Vali Loss: 0.6146661 Best vali loss: 0.6143263
	iters: 100, epoch: 5 | loss: 0.9503745
	speed: 0.0189s/iter; left time: 35.0964s
	iters: 200, epoch: 5 | loss: 0.3935186
	speed: 0.0068s/iter; left time: 11.9692s
	iters: 300, epoch: 5 | loss: 1.1048241
	speed: 0.0069s/iter; left time: 11.3900s
	iters: 400, epoch: 5 | loss: 0.8182557
	speed: 0.0057s/iter; left time: 8.9289s
Updating learning rate to 3.8092847e-06
Validation loss decreased (0.6143 --> 0.6097).  Saving model state dict ...
Epoch: 5 cost time: 3.210367202758789
Epoch: 5, Steps: 490 | Train Loss: 0.8167432 Vali Loss: 0.6097160 Best vali loss: 0.6097160
	iters: 100, epoch: 6 | loss: 1.4264053
	speed: 0.0186s/iter; left time: 25.5137s
	iters: 200, epoch: 6 | loss: 0.5701494
	speed: 0.0066s/iter; left time: 8.4427s
	iters: 300, epoch: 6 | loss: 0.6667553
	speed: 0.0064s/iter; left time: 7.4654s
	iters: 400, epoch: 6 | loss: 0.7474817
	speed: 0.0042s/iter; left time: 4.4592s
Updating learning rate to 1.90464235e-06
Validation loss decreased (0.6097 --> 0.6094).  Saving model state dict ...
Epoch: 6 cost time: 2.816537380218506
Epoch: 6, Steps: 490 | Train Loss: 0.8526979 Vali Loss: 0.6094128 Best vali loss: 0.6094128
	iters: 100, epoch: 7 | loss: 0.9760266
	speed: 0.0169s/iter; left time: 14.8571s
	iters: 200, epoch: 7 | loss: 1.5857985
	speed: 0.0066s/iter; left time: 5.1805s
	iters: 300, epoch: 7 | loss: 0.4715441
	speed: 0.0067s/iter; left time: 4.5585s
	iters: 400, epoch: 7 | loss: 0.7114711
	speed: 0.0061s/iter; left time: 3.5474s
Updating learning rate to 9.52321175e-07
Validation loss decreased (0.6094 --> 0.6092).  Saving model state dict ...
Epoch: 7 cost time: 3.2623987197875977
Epoch: 7, Steps: 490 | Train Loss: 0.9362101 Vali Loss: 0.6091952 Best vali loss: 0.6091952
	iters: 100, epoch: 8 | loss: 1.2343307
	speed: 0.0191s/iter; left time: 7.4671s
	iters: 200, epoch: 8 | loss: 0.6022700
	speed: 0.0067s/iter; left time: 1.9355s
	iters: 300, epoch: 8 | loss: 1.2801634
	speed: 0.0065s/iter; left time: 1.2440s
	iters: 400, epoch: 8 | loss: 0.6465930
	speed: 0.0065s/iter; left time: 0.5883s
Updating learning rate to 4.761605875e-07
Epoch: 8 cost time: 3.255901575088501
Epoch: 8, Steps: 490 | Train Loss: 0.9408393 Vali Loss: 0.6092262 Best vali loss: 0.6091952

best validation loss 0.6091952471063403

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0044711634464, 'e_layers': 3, 'learning_rate': 0.0004262443426, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7333001
	speed: 0.0133s/iter; left time: 102.5155s
	iters: 200, epoch: 1 | loss: 0.7520897
	speed: 0.0069s/iter; left time: 52.4965s
	iters: 300, epoch: 1 | loss: 0.6727450
	speed: 0.0070s/iter; left time: 52.4532s
	iters: 400, epoch: 1 | loss: 1.4308981
	speed: 0.0067s/iter; left time: 49.7809s
	iters: 500, epoch: 1 | loss: 0.9048981
	speed: 0.0067s/iter; left time: 48.7792s
	iters: 600, epoch: 1 | loss: 1.4707980
	speed: 0.0068s/iter; left time: 49.1411s
	iters: 700, epoch: 1 | loss: 2.0904403
	speed: 0.0069s/iter; left time: 49.3562s
	iters: 800, epoch: 1 | loss: 0.5974078
	speed: 0.0072s/iter; left time: 50.7796s
	iters: 900, epoch: 1 | loss: 0.9237483
	speed: 0.0067s/iter; left time: 46.2488s
Updating learning rate to 0.0004100213832884344
Validation loss decreased (inf --> 0.6476).  Saving model state dict ...
Epoch: 1 cost time: 6.975263833999634
Epoch: 1, Steps: 979 | Train Loss: 1.0640362 Vali Loss: 0.6475955 Best vali loss: 0.6475955
	iters: 100, epoch: 2 | loss: 0.3258177
	speed: 0.0151s/iter; left time: 101.9847s
	iters: 200, epoch: 2 | loss: 0.5892590
	speed: 0.0055s/iter; left time: 36.6684s
	iters: 300, epoch: 2 | loss: 0.6796992
	speed: 0.0053s/iter; left time: 34.8597s
	iters: 400, epoch: 2 | loss: 0.5799826
	speed: 0.0054s/iter; left time: 35.1024s
	iters: 500, epoch: 2 | loss: 0.4320147
	speed: 0.0055s/iter; left time: 34.7078s
	iters: 600, epoch: 2 | loss: 1.1961808
	speed: 0.0055s/iter; left time: 34.1048s
	iters: 700, epoch: 2 | loss: 0.8526348
	speed: 0.0053s/iter; left time: 32.5784s
	iters: 800, epoch: 2 | loss: 0.9021035
	speed: 0.0054s/iter; left time: 32.6126s
	iters: 900, epoch: 2 | loss: 0.8484221
	speed: 0.0055s/iter; left time: 32.4574s
Updating learning rate to 0.000363822303847431
Validation loss decreased (0.6476 --> 0.6147).  Saving model state dict ...
Epoch: 2 cost time: 5.242363691329956
Epoch: 2, Steps: 979 | Train Loss: 0.7117905 Vali Loss: 0.6147456 Best vali loss: 0.6147456
	iters: 100, epoch: 3 | loss: 0.5128565
	speed: 0.0159s/iter; left time: 91.9672s
	iters: 200, epoch: 3 | loss: 0.7680708
	speed: 0.0051s/iter; left time: 28.8334s
	iters: 300, epoch: 3 | loss: 0.6646306
	speed: 0.0052s/iter; left time: 28.9989s
	iters: 400, epoch: 3 | loss: 0.9991275
	speed: 0.0052s/iter; left time: 28.7153s
	iters: 500, epoch: 3 | loss: 0.8766965
	speed: 0.0051s/iter; left time: 27.5362s
	iters: 600, epoch: 3 | loss: 1.1938304
	speed: 0.0050s/iter; left time: 26.5757s
	iters: 700, epoch: 3 | loss: 1.3689519
	speed: 0.0051s/iter; left time: 26.2103s
	iters: 800, epoch: 3 | loss: 1.1942571
	speed: 0.0051s/iter; left time: 26.0490s
	iters: 900, epoch: 3 | loss: 0.3481573
	speed: 0.0051s/iter; left time: 25.2871s
Updating learning rate to 0.00029468049532618465
Validation loss decreased (0.6147 --> 0.6132).  Saving model state dict ...
Epoch: 3 cost time: 5.031952619552612
Epoch: 3, Steps: 979 | Train Loss: 0.8807310 Vali Loss: 0.6132444 Best vali loss: 0.6132444

best validation loss 0.613244404758584

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.00113692195, 'e_layers': 4, 'learning_rate': 0.0017228387955, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9318969
	speed: 0.0132s/iter; left time: 50.5785s
	iters: 200, epoch: 1 | loss: 0.6368225
	speed: 0.0077s/iter; left time: 28.6584s
	iters: 300, epoch: 1 | loss: 1.1842774
	speed: 0.0077s/iter; left time: 28.0202s
	iters: 400, epoch: 1 | loss: 0.6884643
	speed: 0.0077s/iter; left time: 27.2648s
Updating learning rate to 0.0016572671482394242
Validation loss decreased (inf --> 0.6250).  Saving model state dict ...
Epoch: 1 cost time: 4.078947067260742
Epoch: 1, Steps: 490 | Train Loss: 0.8603653 Vali Loss: 0.6249912 Best vali loss: 0.6249912
	iters: 100, epoch: 2 | loss: 0.8786464
	speed: 0.0209s/iter; left time: 69.7284s
	iters: 200, epoch: 2 | loss: 0.5971767
	speed: 0.0072s/iter; left time: 23.2479s
	iters: 300, epoch: 2 | loss: 1.0542301
	speed: 0.0072s/iter; left time: 22.6112s
	iters: 400, epoch: 2 | loss: 0.6768374
	speed: 0.0077s/iter; left time: 23.4047s
Updating learning rate to 0.0014705348953446568
Epoch: 2 cost time: 3.728101968765259
Epoch: 2, Steps: 490 | Train Loss: 0.8017227 Vali Loss: 0.6430043 Best vali loss: 0.6249912
	iters: 100, epoch: 3 | loss: 1.1510845
	speed: 0.0204s/iter; left time: 57.8687s
	iters: 200, epoch: 3 | loss: 0.7583649
	speed: 0.0077s/iter; left time: 21.0625s
	iters: 300, epoch: 3 | loss: 0.8287218
	speed: 0.0077s/iter; left time: 20.3031s
	iters: 400, epoch: 3 | loss: 1.2818245
	speed: 0.0076s/iter; left time: 19.4116s
Updating learning rate to 0.0011910703295868385
Epoch: 3 cost time: 3.8023767471313477
Epoch: 3, Steps: 490 | Train Loss: 1.0049989 Vali Loss: 0.6357292 Best vali loss: 0.6249912

best validation loss 0.6249912114454497

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9379280
	speed: 0.0109s/iter; left time: 20.2121s
	iters: 200, epoch: 1 | loss: 0.8380154
	speed: 0.0052s/iter; left time: 9.1560s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.6161).  Saving model state dict ...
Epoch: 1 cost time: 1.5411067008972168
Epoch: 1, Steps: 245 | Train Loss: 0.8879717 Vali Loss: 0.6161222 Best vali loss: 0.6161222
	iters: 100, epoch: 2 | loss: 1.0010203
	speed: 0.0099s/iter; left time: 15.9359s
	iters: 200, epoch: 2 | loss: 0.7101033
	speed: 0.0051s/iter; left time: 7.6843s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.6161 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 1.2882497310638428
Epoch: 2, Steps: 245 | Train Loss: 0.8555618 Vali Loss: 0.6038301 Best vali loss: 0.6038301
	iters: 100, epoch: 3 | loss: 1.1486980
	speed: 0.0109s/iter; left time: 14.9804s
	iters: 200, epoch: 3 | loss: 0.9286205
	speed: 0.0058s/iter; left time: 7.3743s
Updating learning rate to 7.441812635926816e-05
Validation loss decreased (0.6038 --> 0.6012).  Saving model state dict ...
Epoch: 3 cost time: 1.4575777053833008
Epoch: 3, Steps: 245 | Train Loss: 1.0386592 Vali Loss: 0.6012048 Best vali loss: 0.6012048

best validation loss 0.6012047670440286

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8800749
	speed: 0.0109s/iter; left time: 12.2776s
	iters: 200, epoch: 4 | loss: 0.7985421
	speed: 0.0051s/iter; left time: 5.2107s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 1.5241937637329102
Epoch: 4, Steps: 245 | Train Loss: 0.8393085 Vali Loss: 0.6077177 Best vali loss: 0.6012048
	iters: 100, epoch: 5 | loss: 0.9542383
	speed: 0.0098s/iter; left time: 8.6151s
	iters: 200, epoch: 5 | loss: 0.6628529
	speed: 0.0052s/iter; left time: 4.0657s
Updating learning rate to 3.3224917040731837e-05
Validation loss decreased (0.6012 --> 0.5872).  Saving model state dict ...
Epoch: 5 cost time: 1.2817332744598389
Epoch: 5, Steps: 245 | Train Loss: 0.8085456 Vali Loss: 0.5872314 Best vali loss: 0.5872314
	iters: 100, epoch: 6 | loss: 0.9865819
	speed: 0.0103s/iter; left time: 6.5387s
	iters: 200, epoch: 6 | loss: 0.8530326
	speed: 0.0053s/iter; left time: 2.8393s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 1.3260488510131836
Epoch: 6, Steps: 245 | Train Loss: 0.9198072 Vali Loss: 0.5948227 Best vali loss: 0.5872314
	iters: 100, epoch: 7 | loss: 0.6138105
	speed: 0.0098s/iter; left time: 3.8368s
	iters: 200, epoch: 7 | loss: 0.6004454
	speed: 0.0051s/iter; left time: 1.4837s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 1.2609741687774658
Epoch: 7, Steps: 245 | Train Loss: 0.6071280 Vali Loss: 0.5979626 Best vali loss: 0.5872314
	iters: 100, epoch: 8 | loss: 0.8669872
	speed: 0.0099s/iter; left time: 1.4511s
	iters: 200, epoch: 8 | loss: 0.7588061
	speed: 0.0049s/iter; left time: 0.2233s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2495386600494385
Epoch: 8, Steps: 245 | Train Loss: 0.8128966 Vali Loss: 0.5937296 Best vali loss: 0.5872314

best validation loss 0.5872313814657477

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0012309194537, 'e_layers': 1, 'learning_rate': 0.0001461940837, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5913756
	speed: 0.0085s/iter; left time: 32.4096s
	iters: 200, epoch: 1 | loss: 0.7998408
	speed: 0.0030s/iter; left time: 11.1420s
	iters: 300, epoch: 1 | loss: 1.7162180
	speed: 0.0029s/iter; left time: 10.4432s
	iters: 400, epoch: 1 | loss: 0.5652015
	speed: 0.0030s/iter; left time: 10.5322s
Updating learning rate to 0.00014062990270233595
Validation loss decreased (inf --> 0.6454).  Saving model state dict ...
Epoch: 1 cost time: 1.7466089725494385
Epoch: 1, Steps: 490 | Train Loss: 0.9181590 Vali Loss: 0.6453507 Best vali loss: 0.6453507
	iters: 100, epoch: 2 | loss: 0.6305552
	speed: 0.0092s/iter; left time: 30.5784s
	iters: 200, epoch: 2 | loss: 1.0092593
	speed: 0.0031s/iter; left time: 10.0308s
	iters: 300, epoch: 2 | loss: 1.0033588
	speed: 0.0030s/iter; left time: 9.2823s
	iters: 400, epoch: 2 | loss: 0.5316874
	speed: 0.0030s/iter; left time: 8.9825s
Updating learning rate to 0.00012478445582681183
Validation loss decreased (0.6454 --> 0.6253).  Saving model state dict ...
Epoch: 2 cost time: 1.5019128322601318
Epoch: 2, Steps: 490 | Train Loss: 0.7937152 Vali Loss: 0.6252785 Best vali loss: 0.6252785
	iters: 100, epoch: 3 | loss: 0.7504265
	speed: 0.0085s/iter; left time: 24.1601s
	iters: 200, epoch: 3 | loss: 0.9157490
	speed: 0.0024s/iter; left time: 6.5609s
	iters: 300, epoch: 3 | loss: 1.0061636
	speed: 0.0023s/iter; left time: 6.1783s
	iters: 400, epoch: 3 | loss: 0.6026808
	speed: 0.0027s/iter; left time: 6.7597s
Updating learning rate to 0.00010107006872089262
Validation loss decreased (0.6253 --> 0.6133).  Saving model state dict ...
Epoch: 3 cost time: 1.354027271270752
Epoch: 3, Steps: 490 | Train Loss: 0.8187550 Vali Loss: 0.6132960 Best vali loss: 0.6132960
	iters: 100, epoch: 4 | loss: 0.7518700
	speed: 0.0119s/iter; left time: 28.0580s
	iters: 200, epoch: 4 | loss: 0.7099310
	speed: 0.0038s/iter; left time: 8.5972s
	iters: 300, epoch: 4 | loss: 0.8049127
	speed: 0.0034s/iter; left time: 7.3421s
	iters: 400, epoch: 4 | loss: 1.1680770
	speed: 0.0036s/iter; left time: 7.2813s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.6133 --> 0.6081).  Saving model state dict ...
Epoch: 4 cost time: 1.8364307880401611
Epoch: 4, Steps: 490 | Train Loss: 0.8586977 Vali Loss: 0.6080596 Best vali loss: 0.6080596
	iters: 100, epoch: 5 | loss: 0.4728335
	speed: 0.0124s/iter; left time: 23.1229s
	iters: 200, epoch: 5 | loss: 0.9795800
	speed: 0.0036s/iter; left time: 6.4051s
	iters: 300, epoch: 5 | loss: 0.9285069
	speed: 0.0034s/iter; left time: 5.6900s
	iters: 400, epoch: 5 | loss: 0.6853282
	speed: 0.0036s/iter; left time: 5.6179s
Updating learning rate to 4.512401497910739e-05
Validation loss decreased (0.6081 --> 0.6043).  Saving model state dict ...
Epoch: 5 cost time: 1.8586828708648682
Epoch: 5, Steps: 490 | Train Loss: 0.7665621 Vali Loss: 0.6043091 Best vali loss: 0.6043091
	iters: 100, epoch: 6 | loss: 1.0396415
	speed: 0.0122s/iter; left time: 16.6855s
	iters: 200, epoch: 6 | loss: 0.6787497
	speed: 0.0038s/iter; left time: 4.7702s
	iters: 300, epoch: 6 | loss: 0.9309578
	speed: 0.0039s/iter; left time: 4.5603s
	iters: 400, epoch: 6 | loss: 0.6026145
	speed: 0.0036s/iter; left time: 3.8984s
Updating learning rate to 2.1409627873188145e-05
Validation loss decreased (0.6043 --> 0.6029).  Saving model state dict ...
Epoch: 6 cost time: 1.9330289363861084
Epoch: 6, Steps: 490 | Train Loss: 0.8129909 Vali Loss: 0.6028753 Best vali loss: 0.6028753
	iters: 100, epoch: 7 | loss: 1.1150125
	speed: 0.0123s/iter; left time: 10.7951s
	iters: 200, epoch: 7 | loss: 0.6883113
	speed: 0.0036s/iter; left time: 2.7778s
	iters: 300, epoch: 7 | loss: 0.4225174
	speed: 0.0035s/iter; left time: 2.3944s
	iters: 400, epoch: 7 | loss: 0.3872290
	speed: 0.0036s/iter; left time: 2.0886s
Updating learning rate to 5.564180997664037e-06
Epoch: 7 cost time: 1.8107728958129883
Epoch: 7, Steps: 490 | Train Loss: 0.6532676 Vali Loss: 0.6032075 Best vali loss: 0.6028753
	iters: 100, epoch: 8 | loss: 1.1413080
	speed: 0.0122s/iter; left time: 4.7649s
	iters: 200, epoch: 8 | loss: 0.6369802
	speed: 0.0035s/iter; left time: 1.0237s
	iters: 300, epoch: 8 | loss: 0.6587222
	speed: 0.0037s/iter; left time: 0.7089s
	iters: 400, epoch: 8 | loss: 1.1899045
	speed: 0.0033s/iter; left time: 0.3009s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8270671367645264
Epoch: 8, Steps: 490 | Train Loss: 0.9067287 Vali Loss: 0.6030696 Best vali loss: 0.6028753

best validation loss 0.602875320869207

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010359583968, 'e_layers': 4, 'learning_rate': 0.0005252026555, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7941231
	speed: 0.0126s/iter; left time: 48.1269s
	iters: 200, epoch: 1 | loss: 0.7509314
	speed: 0.0069s/iter; left time: 25.5624s
	iters: 300, epoch: 1 | loss: 1.0601797
	speed: 0.0063s/iter; left time: 22.8029s
	iters: 400, epoch: 1 | loss: 0.4898166
	speed: 0.0064s/iter; left time: 22.5174s
Updating learning rate to 0.0005252026555
Validation loss decreased (inf --> 0.6052).  Saving model state dict ...
Epoch: 1 cost time: 3.4688260555267334
Epoch: 1, Steps: 490 | Train Loss: 0.7737627 Vali Loss: 0.6051921 Best vali loss: 0.6051921
	iters: 100, epoch: 2 | loss: 0.5863627
	speed: 0.0177s/iter; left time: 58.8224s
	iters: 200, epoch: 2 | loss: 1.1025679
	speed: 0.0068s/iter; left time: 22.0195s
	iters: 300, epoch: 2 | loss: 0.8803540
	speed: 0.0065s/iter; left time: 20.1995s
	iters: 400, epoch: 2 | loss: 0.9980358
	speed: 0.0064s/iter; left time: 19.4777s
Updating learning rate to 0.00026260132775
Validation loss decreased (0.6052 --> 0.5789).  Saving model state dict ...
Epoch: 2 cost time: 3.2265002727508545
Epoch: 2, Steps: 490 | Train Loss: 0.8918301 Vali Loss: 0.5788948 Best vali loss: 0.5788948
	iters: 100, epoch: 3 | loss: 0.7987983
	speed: 0.0178s/iter; left time: 50.4968s
	iters: 200, epoch: 3 | loss: 0.9358536
	speed: 0.0066s/iter; left time: 18.1286s
	iters: 300, epoch: 3 | loss: 0.6694445
	speed: 0.0066s/iter; left time: 17.3199s
	iters: 400, epoch: 3 | loss: 0.5028293
	speed: 0.0066s/iter; left time: 16.6525s
Updating learning rate to 0.000131300663875
Validation loss decreased (0.5789 --> 0.5628).  Saving model state dict ...
Epoch: 3 cost time: 3.2607247829437256
Epoch: 3, Steps: 490 | Train Loss: 0.7267314 Vali Loss: 0.5628413 Best vali loss: 0.5628413
	iters: 100, epoch: 4 | loss: 0.9921054
	speed: 0.0183s/iter; left time: 43.0427s
	iters: 200, epoch: 4 | loss: 0.8077778
	speed: 0.0068s/iter; left time: 15.2462s
	iters: 300, epoch: 4 | loss: 0.8676651
	speed: 0.0065s/iter; left time: 13.9168s
	iters: 400, epoch: 4 | loss: 0.6811507
	speed: 0.0067s/iter; left time: 13.7510s
Updating learning rate to 6.56503319375e-05
Epoch: 4 cost time: 3.2614636421203613
Epoch: 4, Steps: 490 | Train Loss: 0.8371747 Vali Loss: 0.5723997 Best vali loss: 0.5628413
	iters: 100, epoch: 5 | loss: 0.7431397
	speed: 0.0173s/iter; left time: 32.2611s
	iters: 200, epoch: 5 | loss: 1.0233389
	speed: 0.0065s/iter; left time: 11.5280s
	iters: 300, epoch: 5 | loss: 0.3578467
	speed: 0.0052s/iter; left time: 8.6637s
	iters: 400, epoch: 5 | loss: 0.9826030
	speed: 0.0064s/iter; left time: 10.0047s
Updating learning rate to 3.282516596875e-05
Validation loss decreased (0.5628 --> 0.5605).  Saving model state dict ...
Epoch: 5 cost time: 3.125981330871582
Epoch: 5, Steps: 490 | Train Loss: 0.7767321 Vali Loss: 0.5604954 Best vali loss: 0.5604954
	iters: 100, epoch: 6 | loss: 0.6719850
	speed: 0.0182s/iter; left time: 24.9920s
	iters: 200, epoch: 6 | loss: 0.4274881
	speed: 0.0068s/iter; left time: 8.6143s
	iters: 300, epoch: 6 | loss: 0.7102712
	speed: 0.0068s/iter; left time: 7.9623s
	iters: 400, epoch: 6 | loss: 0.8955111
	speed: 0.0068s/iter; left time: 7.3151s
Updating learning rate to 1.6412582984375e-05
Epoch: 6 cost time: 3.363509178161621
Epoch: 6, Steps: 490 | Train Loss: 0.6763139 Vali Loss: 0.5623276 Best vali loss: 0.5604954
	iters: 100, epoch: 7 | loss: 0.8137817
	speed: 0.0166s/iter; left time: 14.6537s
	iters: 200, epoch: 7 | loss: 0.9335008
	speed: 0.0067s/iter; left time: 5.2527s
	iters: 300, epoch: 7 | loss: 0.6971455
	speed: 0.0067s/iter; left time: 4.5470s
	iters: 400, epoch: 7 | loss: 0.6611213
	speed: 0.0067s/iter; left time: 3.8913s
Updating learning rate to 8.2062914921875e-06
Validation loss decreased (0.5605 --> 0.5596).  Saving model state dict ...
Epoch: 7 cost time: 3.262281894683838
Epoch: 7, Steps: 490 | Train Loss: 0.7763873 Vali Loss: 0.5595954 Best vali loss: 0.5595954
	iters: 100, epoch: 8 | loss: 0.4084602
	speed: 0.0182s/iter; left time: 7.1078s
	iters: 200, epoch: 8 | loss: 0.8742664
	speed: 0.0069s/iter; left time: 1.9969s
	iters: 300, epoch: 8 | loss: 0.6443628
	speed: 0.0071s/iter; left time: 1.3551s
	iters: 400, epoch: 8 | loss: 0.4517427
	speed: 0.0060s/iter; left time: 0.5427s
Updating learning rate to 4.10314574609375e-06
Epoch: 8 cost time: 3.2851450443267822
Epoch: 8, Steps: 490 | Train Loss: 0.5947080 Vali Loss: 0.5615965 Best vali loss: 0.5595954

best validation loss 0.5595954458631337

[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014282327355, 'e_layers': 2, 'learning_rate': 0.0011080068437, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0736960
	speed: 0.0107s/iter; left time: 19.9514s
	iters: 200, epoch: 1 | loss: 0.7113102
	speed: 0.0052s/iter; left time: 9.1063s
Updating learning rate to 0.0011080068437
Validation loss decreased (inf --> 0.6536).  Saving model state dict ...
Epoch: 1 cost time: 1.556825876235962
Epoch: 1, Steps: 245 | Train Loss: 0.8925031 Vali Loss: 0.6536464 Best vali loss: 0.6536464
	iters: 100, epoch: 2 | loss: 0.7058151
	speed: 0.0119s/iter; left time: 19.2496s
	iters: 200, epoch: 2 | loss: 0.7811027
	speed: 0.0057s/iter; left time: 8.6119s
Updating learning rate to 0.00055400342185
Validation loss decreased (0.6536 --> 0.6291).  Saving model state dict ...
Epoch: 2 cost time: 1.4375455379486084
Epoch: 2, Steps: 245 | Train Loss: 0.7434589 Vali Loss: 0.6291074 Best vali loss: 0.6291074
	iters: 100, epoch: 3 | loss: 0.9856076
	speed: 0.0118s/iter; left time: 16.2116s
	iters: 200, epoch: 3 | loss: 0.8325722
	speed: 0.0056s/iter; left time: 7.0603s
Updating learning rate to 0.000277001710925
Validation loss decreased (0.6291 --> 0.6044).  Saving model state dict ...
Epoch: 3 cost time: 1.4292948246002197
Epoch: 3, Steps: 245 | Train Loss: 0.9090899 Vali Loss: 0.6043705 Best vali loss: 0.6043705

best validation loss 0.6043705341441937

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0082216964171, 'e_layers': 4, 'learning_rate': 0.0011920870975, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5115423
	speed: 0.0118s/iter; left time: 21.9332s
	iters: 200, epoch: 1 | loss: 0.8640298
	speed: 0.0114s/iter; left time: 20.0003s
Updating learning rate to 0.0011467159839255183
Validation loss decreased (inf --> 0.6574).  Saving model state dict ...
Epoch: 1 cost time: 2.5592446327209473
Epoch: 1, Steps: 245 | Train Loss: 0.6877860 Vali Loss: 0.6574004 Best vali loss: 0.6574004
	iters: 100, epoch: 2 | loss: 0.8601233
	speed: 0.0214s/iter; left time: 34.5327s
	iters: 200, epoch: 2 | loss: 0.5296829
	speed: 0.0114s/iter; left time: 17.2602s
Updating learning rate to 0.0010175099839536193
Validation loss decreased (0.6574 --> 0.6565).  Saving model state dict ...
Epoch: 2 cost time: 2.8501851558685303
Epoch: 2, Steps: 245 | Train Loss: 0.6949031 Vali Loss: 0.6564506 Best vali loss: 0.6564506
	iters: 100, epoch: 3 | loss: 0.8671433
	speed: 0.0190s/iter; left time: 26.0913s
	iters: 200, epoch: 3 | loss: 1.0877006
	speed: 0.0111s/iter; left time: 14.1038s
Updating learning rate to 0.0008241395398247187
Epoch: 3 cost time: 2.56893253326416
Epoch: 3, Steps: 245 | Train Loss: 0.9774220 Vali Loss: 0.6670242 Best vali loss: 0.6564506

best validation loss 0.6564506241868128

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006117524437, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7571841
	speed: 0.0138s/iter; left time: 52.7079s
	iters: 200, epoch: 1 | loss: 0.9484990
	speed: 0.0070s/iter; left time: 25.9396s
	iters: 300, epoch: 1 | loss: 1.0426786
	speed: 0.0057s/iter; left time: 20.7028s
	iters: 400, epoch: 1 | loss: 0.9510115
	speed: 0.0077s/iter; left time: 27.2047s
Updating learning rate to 0.0005884690026990967
Validation loss decreased (inf --> 0.6004).  Saving model state dict ...
Epoch: 1 cost time: 3.857534646987915
Epoch: 1, Steps: 490 | Train Loss: 0.9248433 Vali Loss: 0.6003693 Best vali loss: 0.6003693
	iters: 100, epoch: 2 | loss: 0.6752962
	speed: 0.0221s/iter; left time: 73.5766s
	iters: 200, epoch: 2 | loss: 0.7779478
	speed: 0.0077s/iter; left time: 24.8554s
	iters: 300, epoch: 2 | loss: 1.5453531
	speed: 0.0061s/iter; left time: 19.0839s
	iters: 400, epoch: 2 | loss: 1.2750442
	speed: 0.0045s/iter; left time: 13.6110s
Updating learning rate to 0.0005221633725238558
Epoch: 2 cost time: 2.9695615768432617
Epoch: 2, Steps: 490 | Train Loss: 1.0684103 Vali Loss: 0.6144145 Best vali loss: 0.6003693
	iters: 100, epoch: 3 | loss: 0.4566762
	speed: 0.0116s/iter; left time: 32.8592s
	iters: 200, epoch: 3 | loss: 0.4647041
	speed: 0.0052s/iter; left time: 14.2737s
	iters: 300, epoch: 3 | loss: 0.7990326
	speed: 0.0054s/iter; left time: 14.1337s
	iters: 400, epoch: 3 | loss: 0.8916815
	speed: 0.0051s/iter; left time: 12.9091s
Updating learning rate to 0.0004229299843064237
Epoch: 3 cost time: 2.6071817874908447
Epoch: 3, Steps: 490 | Train Loss: 0.6530236 Vali Loss: 0.6032891 Best vali loss: 0.6003693

best validation loss 0.600369296930058

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006117524437, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7283508
	speed: 0.0111s/iter; left time: 26.2004s
	iters: 200, epoch: 4 | loss: 0.8963836
	speed: 0.0053s/iter; left time: 12.0205s
	iters: 300, epoch: 4 | loss: 0.7317835
	speed: 0.0049s/iter; left time: 10.4914s
	iters: 400, epoch: 4 | loss: 0.9205373
	speed: 0.0033s/iter; left time: 6.6836s
Updating learning rate to 0.00030587622185
Validation loss decreased (0.6004 --> 0.5983).  Saving model state dict ...
Epoch: 4 cost time: 2.465003490447998
Epoch: 4, Steps: 490 | Train Loss: 0.8192638 Vali Loss: 0.5983448 Best vali loss: 0.5983448
	iters: 100, epoch: 5 | loss: 0.6616325
	speed: 0.0119s/iter; left time: 22.1545s
	iters: 200, epoch: 5 | loss: 0.7514397
	speed: 0.0053s/iter; left time: 9.4106s
	iters: 300, epoch: 5 | loss: 1.4083307
	speed: 0.0051s/iter; left time: 8.4411s
	iters: 400, epoch: 5 | loss: 1.2262480
	speed: 0.0051s/iter; left time: 7.9108s
Updating learning rate to 0.00018882245939357635
Epoch: 5 cost time: 2.6794497966766357
Epoch: 5, Steps: 490 | Train Loss: 1.0119127 Vali Loss: 0.6228829 Best vali loss: 0.5983448
	iters: 100, epoch: 6 | loss: 0.4343298
	speed: 0.0154s/iter; left time: 21.1430s
	iters: 200, epoch: 6 | loss: 0.4655397
	speed: 0.0052s/iter; left time: 6.5860s
	iters: 300, epoch: 6 | loss: 0.7978652
	speed: 0.0057s/iter; left time: 6.6379s
	iters: 400, epoch: 6 | loss: 0.8577800
	speed: 0.0053s/iter; left time: 5.6498s
Updating learning rate to 8.958907117614421e-05
Epoch: 6 cost time: 2.6575117111206055
Epoch: 6, Steps: 490 | Train Loss: 0.6388787 Vali Loss: 0.6257370 Best vali loss: 0.5983448
	iters: 100, epoch: 7 | loss: 0.4494299
	speed: 0.0154s/iter; left time: 13.5446s
	iters: 200, epoch: 7 | loss: 0.4415388
	speed: 0.0052s/iter; left time: 4.0511s
	iters: 300, epoch: 7 | loss: 0.4511935
	speed: 0.0052s/iter; left time: 3.5541s
	iters: 400, epoch: 7 | loss: 0.5635797
	speed: 0.0057s/iter; left time: 3.3399s
Updating learning rate to 2.328344100090337e-05
Epoch: 7 cost time: 2.7307844161987305
Epoch: 7, Steps: 490 | Train Loss: 0.4764355 Vali Loss: 0.6374458 Best vali loss: 0.5983448
	iters: 100, epoch: 8 | loss: 0.8866484
	speed: 0.0144s/iter; left time: 5.6488s
	iters: 200, epoch: 8 | loss: 0.9090627
	speed: 0.0037s/iter; left time: 1.0727s
	iters: 300, epoch: 8 | loss: 0.9360827
	speed: 0.0034s/iter; left time: 0.6589s
	iters: 400, epoch: 8 | loss: 1.1348382
	speed: 0.0036s/iter; left time: 0.3247s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8842148780822754
Epoch: 8, Steps: 490 | Train Loss: 0.9666580 Vali Loss: 0.6422708 Best vali loss: 0.5983448

best validation loss 0.5983448404506753

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.6042).  Saving model state dict ...
Epoch: 1 cost time: 0.9604406356811523
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6042384 Best vali loss: 0.6042384
Updating learning rate to 0.0005975820137081337
Epoch: 2 cost time: 0.6231648921966553
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6099734 Best vali loss: 0.6042384
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.600630521774292
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6121767 Best vali loss: 0.6042384
Updating learning rate to 0.000350055439
Validation loss decreased (0.6042 --> 0.5692).  Saving model state dict ...
Epoch: 4 cost time: 0.6226599216461182
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5691661 Best vali loss: 0.5691661
Updating learning rate to 0.0002160950220854117
Validation loss decreased (0.5692 --> 0.5659).  Saving model state dict ...
Epoch: 5 cost time: 0.7450988292694092
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5658606 Best vali loss: 0.5658606
Updating learning rate to 0.00010252886429186618
Epoch: 6 cost time: 0.651421070098877
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5665126 Best vali loss: 0.5658606
Updating learning rate to 2.6646383663646746e-05
Validation loss decreased (0.5659 --> 0.5613).  Saving model state dict ...
Epoch: 7 cost time: 0.6274745464324951
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5613317 Best vali loss: 0.5613317
Updating learning rate to 0.0
Validation loss decreased (0.5613 --> 0.5551).  Saving model state dict ...
Epoch: 8 cost time: 0.6711521148681641
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5551088 Best vali loss: 0.5551088

best validation loss 0.5551087700730394

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 2.3358383
	speed: 0.0128s/iter; left time: 99.2215s
	iters: 200, epoch: 1 | loss: 1.2123019
	speed: 0.0066s/iter; left time: 50.1496s
	iters: 300, epoch: 1 | loss: 1.1163514
	speed: 0.0070s/iter; left time: 52.8971s
	iters: 400, epoch: 1 | loss: 0.3345290
	speed: 0.0067s/iter; left time: 50.0928s
	iters: 500, epoch: 1 | loss: 0.7807001
	speed: 0.0067s/iter; left time: 48.8278s
	iters: 600, epoch: 1 | loss: 1.4049903
	speed: 0.0065s/iter; left time: 46.6977s
	iters: 700, epoch: 1 | loss: 1.0068423
	speed: 0.0067s/iter; left time: 47.8966s
	iters: 800, epoch: 1 | loss: 0.8660811
	speed: 0.0067s/iter; left time: 47.3395s
	iters: 900, epoch: 1 | loss: 1.3942084
	speed: 0.0065s/iter; left time: 44.9015s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.6066).  Saving model state dict ...
Epoch: 1 cost time: 6.802443742752075
Epoch: 1, Steps: 979 | Train Loss: 1.1613159 Vali Loss: 0.6065905 Best vali loss: 0.6065905
	iters: 100, epoch: 2 | loss: 0.2503504
	speed: 0.0216s/iter; left time: 145.6210s
	iters: 200, epoch: 2 | loss: 0.2390729
	speed: 0.0067s/iter; left time: 44.8943s
	iters: 300, epoch: 2 | loss: 1.4310956
	speed: 0.0067s/iter; left time: 44.2030s
	iters: 400, epoch: 2 | loss: 1.0047297
	speed: 0.0066s/iter; left time: 42.7500s
	iters: 500, epoch: 2 | loss: 1.4901714
	speed: 0.0048s/iter; left time: 30.7973s
	iters: 600, epoch: 2 | loss: 1.0131340
	speed: 0.0059s/iter; left time: 36.9614s
	iters: 700, epoch: 2 | loss: 0.5593860
	speed: 0.0069s/iter; left time: 42.6913s
	iters: 800, epoch: 2 | loss: 1.2332467
	speed: 0.0070s/iter; left time: 42.5981s
	iters: 900, epoch: 2 | loss: 1.1524289
	speed: 0.0069s/iter; left time: 41.0321s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.6066 --> 0.5988).  Saving model state dict ...
Epoch: 2 cost time: 6.3879783153533936
Epoch: 2, Steps: 979 | Train Loss: 0.9304017 Vali Loss: 0.5987726 Best vali loss: 0.5987726
	iters: 100, epoch: 3 | loss: 0.2479328
	speed: 0.0213s/iter; left time: 123.2026s
	iters: 200, epoch: 3 | loss: 1.2457858
	speed: 0.0069s/iter; left time: 39.0876s
	iters: 300, epoch: 3 | loss: 1.1723920
	speed: 0.0069s/iter; left time: 38.7456s
	iters: 400, epoch: 3 | loss: 0.4425430
	speed: 0.0069s/iter; left time: 37.8945s
	iters: 500, epoch: 3 | loss: 0.9554387
	speed: 0.0069s/iter; left time: 37.0008s
	iters: 600, epoch: 3 | loss: 1.2925987
	speed: 0.0071s/iter; left time: 37.4300s
	iters: 700, epoch: 3 | loss: 0.6577125
	speed: 0.0069s/iter; left time: 35.6101s
	iters: 800, epoch: 3 | loss: 0.7982015
	speed: 0.0069s/iter; left time: 34.9169s
	iters: 900, epoch: 3 | loss: 0.5916257
	speed: 0.0068s/iter; left time: 33.7221s
Updating learning rate to 0.0004164486617318853
Validation loss decreased (0.5988 --> 0.5796).  Saving model state dict ...
Epoch: 3 cost time: 6.810893774032593
Epoch: 3, Steps: 979 | Train Loss: 0.8226923 Vali Loss: 0.5796386 Best vali loss: 0.5796386
	iters: 100, epoch: 4 | loss: 0.5279820
	speed: 0.0209s/iter; left time: 100.1660s
	iters: 200, epoch: 4 | loss: 1.0094831
	speed: 0.0073s/iter; left time: 34.1519s
	iters: 300, epoch: 4 | loss: 1.3178006
	speed: 0.0071s/iter; left time: 32.5275s
	iters: 400, epoch: 4 | loss: 0.8823096
	speed: 0.0070s/iter; left time: 31.2523s
	iters: 500, epoch: 4 | loss: 0.7760609
	speed: 0.0069s/iter; left time: 30.4263s
	iters: 600, epoch: 4 | loss: 0.7140427
	speed: 0.0070s/iter; left time: 30.0827s
	iters: 700, epoch: 4 | loss: 0.7956145
	speed: 0.0067s/iter; left time: 28.0572s
	iters: 800, epoch: 4 | loss: 0.5826685
	speed: 0.0063s/iter; left time: 25.9887s
	iters: 900, epoch: 4 | loss: 0.8095920
	speed: 0.0069s/iter; left time: 27.5898s
Updating learning rate to 0.0003011887262
Validation loss decreased (0.5796 --> 0.5582).  Saving model state dict ...
Epoch: 4 cost time: 6.783457279205322
Epoch: 4, Steps: 979 | Train Loss: 0.8239504 Vali Loss: 0.5582363 Best vali loss: 0.5582363
	iters: 100, epoch: 5 | loss: 0.7695457
	speed: 0.0212s/iter; left time: 80.7936s
	iters: 200, epoch: 5 | loss: 0.8737295
	speed: 0.0069s/iter; left time: 25.5124s
	iters: 300, epoch: 5 | loss: 0.8759512
	speed: 0.0072s/iter; left time: 26.2108s
	iters: 400, epoch: 5 | loss: 0.4753189
	speed: 0.0067s/iter; left time: 23.5174s
	iters: 500, epoch: 5 | loss: 0.6804496
	speed: 0.0067s/iter; left time: 22.7455s
	iters: 600, epoch: 5 | loss: 1.1749716
	speed: 0.0069s/iter; left time: 23.0295s
	iters: 700, epoch: 5 | loss: 0.8961270
	speed: 0.0069s/iter; left time: 22.1638s
	iters: 800, epoch: 5 | loss: 0.3234011
	speed: 0.0070s/iter; left time: 21.9174s
	iters: 900, epoch: 5 | loss: 0.5521777
	speed: 0.0071s/iter; left time: 21.5037s
Updating learning rate to 0.00018592879066811477
Validation loss decreased (0.5582 --> 0.5510).  Saving model state dict ...
Epoch: 5 cost time: 6.82806658744812
Epoch: 5, Steps: 979 | Train Loss: 0.7357414 Vali Loss: 0.5509544 Best vali loss: 0.5509544
	iters: 100, epoch: 6 | loss: 1.3117524
	speed: 0.0208s/iter; left time: 59.1081s
	iters: 200, epoch: 6 | loss: 0.4657123
	speed: 0.0067s/iter; left time: 18.2237s
	iters: 300, epoch: 6 | loss: 0.6141017
	speed: 0.0065s/iter; left time: 17.1226s
	iters: 400, epoch: 6 | loss: 0.4045340
	speed: 0.0070s/iter; left time: 17.6956s
	iters: 500, epoch: 6 | loss: 0.5928675
	speed: 0.0069s/iter; left time: 16.7886s
	iters: 600, epoch: 6 | loss: 0.9637775
	speed: 0.0070s/iter; left time: 16.2533s
	iters: 700, epoch: 6 | loss: 0.4484745
	speed: 0.0071s/iter; left time: 15.7780s
	iters: 800, epoch: 6 | loss: 0.6013553
	speed: 0.0069s/iter; left time: 14.6919s
	iters: 900, epoch: 6 | loss: 1.1714356
	speed: 0.0066s/iter; left time: 13.3890s
Updating learning rate to 8.821613548704165e-05
Epoch: 6 cost time: 6.587610960006714
Epoch: 6, Steps: 979 | Train Loss: 0.7304456 Vali Loss: 0.5549872 Best vali loss: 0.5509544
	iters: 100, epoch: 7 | loss: 0.5465370
	speed: 0.0194s/iter; left time: 36.0140s
	iters: 200, epoch: 7 | loss: 0.4917513
	speed: 0.0077s/iter; left time: 13.6200s
	iters: 300, epoch: 7 | loss: 0.6437982
	speed: 0.0081s/iter; left time: 13.3943s
	iters: 400, epoch: 7 | loss: 0.7341688
	speed: 0.0081s/iter; left time: 12.5554s
	iters: 500, epoch: 7 | loss: 0.8117303
	speed: 0.0077s/iter; left time: 11.2740s
	iters: 600, epoch: 7 | loss: 0.7444062
	speed: 0.0083s/iter; left time: 11.2898s
	iters: 700, epoch: 7 | loss: 0.5977004
	speed: 0.0060s/iter; left time: 7.6052s
	iters: 800, epoch: 7 | loss: 0.9290802
	speed: 0.0046s/iter; left time: 5.3333s
	iters: 900, epoch: 7 | loss: 0.7131885
	speed: 0.0063s/iter; left time: 6.6251s
Updating learning rate to 2.292662664067406e-05
Epoch: 7 cost time: 7.189050674438477
Epoch: 7, Steps: 979 | Train Loss: 0.6902623 Vali Loss: 0.5568851 Best vali loss: 0.5509544
	iters: 100, epoch: 8 | loss: 0.3354562
	speed: 0.0259s/iter; left time: 22.7739s
	iters: 200, epoch: 8 | loss: 0.7899272
	speed: 0.0081s/iter; left time: 6.3141s
	iters: 300, epoch: 8 | loss: 0.6218222
	speed: 0.0084s/iter; left time: 5.7295s
	iters: 400, epoch: 8 | loss: 0.6342234
	speed: 0.0072s/iter; left time: 4.1857s
	iters: 500, epoch: 8 | loss: 0.4645703
	speed: 0.0085s/iter; left time: 4.0578s
	iters: 600, epoch: 8 | loss: 0.2812058
	speed: 0.0081s/iter; left time: 3.0766s
	iters: 700, epoch: 8 | loss: 0.7632256
	speed: 0.0073s/iter; left time: 2.0415s
	iters: 800, epoch: 8 | loss: 1.0127195
	speed: 0.0047s/iter; left time: 0.8415s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012754803453, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6655804
	speed: 0.0115s/iter; left time: 21.3120s
	iters: 200, epoch: 1 | loss: 1.1349615
	speed: 0.0053s/iter; left time: 9.3743s
Updating learning rate to 0.0005919075723073192
Validation loss decreased (inf --> 0.6095).  Saving model state dict ...
Epoch: 1 cost time: 1.5883417129516602
Epoch: 1, Steps: 245 | Train Loss: 0.9002709 Vali Loss: 0.6094572 Best vali loss: 0.6094572
	iters: 100, epoch: 2 | loss: 0.7661010
	speed: 0.0115s/iter; left time: 18.6423s
	iters: 200, epoch: 2 | loss: 0.6618894
	speed: 0.0055s/iter; left time: 8.3080s
Updating learning rate to 0.0005252145019717149
Epoch: 2 cost time: 1.3853096961975098
Epoch: 2, Steps: 245 | Train Loss: 0.7139952 Vali Loss: 0.6133744 Best vali loss: 0.6094572
	iters: 100, epoch: 3 | loss: 1.0345590
	speed: 0.0112s/iter; left time: 15.3449s
	iters: 200, epoch: 3 | loss: 0.7224251
	speed: 0.0053s/iter; left time: 6.6798s
Updating learning rate to 0.00042540126857759495
Epoch: 3 cost time: 1.342777967453003
Epoch: 3, Steps: 245 | Train Loss: 0.8784921 Vali Loss: 0.6301230 Best vali loss: 0.6094572

best validation loss 0.6094571760218213

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018094463314, 'e_layers': 1, 'learning_rate': 0.003460388698, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00332868549530779
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 0.8582210540771484
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6023465 Best vali loss: 0.6023465
Updating learning rate to 0.002953626505948544
Epoch: 2 cost time: 0.4537501335144043
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6149693 Best vali loss: 0.6023465
Updating learning rate to 0.002392311061134002
Epoch: 3 cost time: 0.45717573165893555
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6503705 Best vali loss: 0.6023465

best validation loss 0.6023465169904851

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0076454676045, 'e_layers': 4, 'learning_rate': 6.3831307e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1417238
	speed: 0.0129s/iter; left time: 24.0628s
	iters: 200, epoch: 1 | loss: 0.5184285
	speed: 0.0070s/iter; left time: 12.3849s
Updating learning rate to 6.3831307e-05
Validation loss decreased (inf --> 0.6824).  Saving model state dict ...
Epoch: 1 cost time: 2.003351926803589
Epoch: 1, Steps: 245 | Train Loss: 0.8300761 Vali Loss: 0.6823726 Best vali loss: 0.6823726
	iters: 100, epoch: 2 | loss: 0.9503985
	speed: 0.0140s/iter; left time: 22.6094s
	iters: 200, epoch: 2 | loss: 1.0462375
	speed: 0.0073s/iter; left time: 11.1282s
Updating learning rate to 3.19156535e-05
Validation loss decreased (0.6824 --> 0.6584).  Saving model state dict ...
Epoch: 2 cost time: 1.799335241317749
Epoch: 2, Steps: 245 | Train Loss: 0.9983180 Vali Loss: 0.6583945 Best vali loss: 0.6583945
	iters: 100, epoch: 3 | loss: 0.8206441
	speed: 0.0144s/iter; left time: 19.7999s
	iters: 200, epoch: 3 | loss: 0.8589776
	speed: 0.0075s/iter; left time: 9.5019s
Updating learning rate to 1.595782675e-05
Validation loss decreased (0.6584 --> 0.6504).  Saving model state dict ...
Epoch: 3 cost time: 1.8270142078399658
Epoch: 3, Steps: 245 | Train Loss: 0.8398109 Vali Loss: 0.6504307 Best vali loss: 0.6504307

best validation loss 0.6504306687298113

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018094463314, 'e_layers': 1, 'learning_rate': 0.003460388698, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.001730194349
Validation loss decreased (0.6023 --> 0.5978).  Saving model state dict ...
Epoch: 4 cost time: 0.7612106800079346
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5978305 Best vali loss: 0.5978305
Updating learning rate to 0.001068077636865998
Epoch: 5 cost time: 0.5220918655395508
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6216003 Best vali loss: 0.5978305
Updating learning rate to 0.000506762192051456
Epoch: 6 cost time: 0.5163993835449219
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6181377 Best vali loss: 0.5978305
Updating learning rate to 0.0001317032026922099
Validation loss decreased (0.5978 --> 0.5915).  Saving model state dict ...
Epoch: 7 cost time: 0.4976644515991211
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5914900 Best vali loss: 0.5914900
Updating learning rate to 0.0
Validation loss decreased (0.5915 --> 0.5854).  Saving model state dict ...
Epoch: 8 cost time: 0.5579383373260498
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5854025 Best vali loss: 0.5854025

best validation loss 0.5854024978657113

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0016784352926, 'e_layers': 3, 'learning_rate': 0.0010192948397, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7505990
	speed: 0.0132s/iter; left time: 11.6611s
Updating learning rate to 0.0010192948397
Validation loss decreased (inf --> 0.6132).  Saving model state dict ...
Epoch: 1 cost time: 1.1546926498413086
Epoch: 1, Steps: 123 | Train Loss: 0.7505990 Vali Loss: 0.6132032 Best vali loss: 0.6132032
	iters: 100, epoch: 2 | loss: 1.0535864
	speed: 0.0109s/iter; left time: 8.3266s
Updating learning rate to 0.00050964741985
Epoch: 2 cost time: 0.8384156227111816
Epoch: 2, Steps: 123 | Train Loss: 1.0535864 Vali Loss: 0.6189381 Best vali loss: 0.6132032
	iters: 100, epoch: 3 | loss: 0.6246699
	speed: 0.0117s/iter; left time: 7.5082s
Updating learning rate to 0.000254823709925
Validation loss decreased (0.6132 --> 0.6116).  Saving model state dict ...
Epoch: 3 cost time: 1.0632529258728027
Epoch: 3, Steps: 123 | Train Loss: 0.6246699 Vali Loss: 0.6116362 Best vali loss: 0.6116362
	iters: 100, epoch: 4 | loss: 0.7056426
	speed: 0.0143s/iter; left time: 7.3739s
Updating learning rate to 0.0001274118549625
Epoch: 4 cost time: 1.121079683303833
Epoch: 4, Steps: 123 | Train Loss: 0.7056426 Vali Loss: 0.6147504 Best vali loss: 0.6116362
	iters: 100, epoch: 5 | loss: 1.0515927
	speed: 0.0135s/iter; left time: 5.3169s
Updating learning rate to 6.370592748125e-05
Epoch: 5 cost time: 1.11922025680542
Epoch: 5, Steps: 123 | Train Loss: 1.0515927 Vali Loss: 0.6177449 Best vali loss: 0.6116362
	iters: 100, epoch: 6 | loss: 0.8891050
	speed: 0.0142s/iter; left time: 3.8372s
Updating learning rate to 3.1852963740625e-05
Epoch: 6 cost time: 1.1099274158477783
Epoch: 6, Steps: 123 | Train Loss: 0.8891050 Vali Loss: 0.6153696 Best vali loss: 0.6116362
	iters: 100, epoch: 7 | loss: 0.7555780
	speed: 0.0140s/iter; left time: 2.0515s
Updating learning rate to 1.59264818703125e-05
Epoch: 7 cost time: 1.161665916442871
Epoch: 7, Steps: 123 | Train Loss: 0.7555780 Vali Loss: 0.6137098 Best vali loss: 0.6116362
	iters: 100, epoch: 8 | loss: 0.6860602
	speed: 0.0104s/iter; left time: 0.2505s
Updating learning rate to 7.96324093515625e-06
Epoch: 8 cost time: 0.732121467590332
Epoch: 8, Steps: 123 | Train Loss: 0.6860602 Vali Loss: 0.6153706 Best vali loss: 0.6116362

best validation loss 0.6116362367168393

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012223560033, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8674989
	speed: 0.0120s/iter; left time: 45.9911s
	iters: 200, epoch: 1 | loss: 1.0914794
	speed: 0.0065s/iter; left time: 24.1434s
	iters: 300, epoch: 1 | loss: 0.4861344
	speed: 0.0065s/iter; left time: 23.5444s
	iters: 400, epoch: 1 | loss: 0.8616806
	speed: 0.0064s/iter; left time: 22.6767s
Updating learning rate to 0.0005598184136
Validation loss decreased (inf --> 0.6160).  Saving model state dict ...
Epoch: 1 cost time: 3.4699182510375977
Epoch: 1, Steps: 490 | Train Loss: 0.8266983 Vali Loss: 0.6159569 Best vali loss: 0.6159569
	iters: 100, epoch: 2 | loss: 0.4702320
	speed: 0.0173s/iter; left time: 57.6127s
	iters: 200, epoch: 2 | loss: 0.7216027
	speed: 0.0064s/iter; left time: 20.7137s
	iters: 300, epoch: 2 | loss: 1.1296585
	speed: 0.0063s/iter; left time: 19.7864s
	iters: 400, epoch: 2 | loss: 0.6962926
	speed: 0.0063s/iter; left time: 19.1547s
Updating learning rate to 0.0002799092068
Validation loss decreased (0.6160 --> 0.6130).  Saving model state dict ...
Epoch: 2 cost time: 3.1637120246887207
Epoch: 2, Steps: 490 | Train Loss: 0.7544465 Vali Loss: 0.6130368 Best vali loss: 0.6130368
	iters: 100, epoch: 3 | loss: 0.9279568
	speed: 0.0172s/iter; left time: 48.9493s
	iters: 200, epoch: 3 | loss: 0.9981184
	speed: 0.0064s/iter; left time: 17.6045s
	iters: 300, epoch: 3 | loss: 0.3950864
	speed: 0.0068s/iter; left time: 17.8714s
	iters: 400, epoch: 3 | loss: 0.9134045
	speed: 0.0065s/iter; left time: 16.6125s
Updating learning rate to 0.0001399546034
Validation loss decreased (0.6130 --> 0.6105).  Saving model state dict ...
Epoch: 3 cost time: 3.275228500366211
Epoch: 3, Steps: 490 | Train Loss: 0.8086415 Vali Loss: 0.6105420 Best vali loss: 0.6105420
	iters: 100, epoch: 4 | loss: 0.9684710
	speed: 0.0173s/iter; left time: 40.5844s
	iters: 200, epoch: 4 | loss: 0.6368637
	speed: 0.0067s/iter; left time: 15.1888s
	iters: 300, epoch: 4 | loss: 0.9197601
	speed: 0.0063s/iter; left time: 13.5622s
	iters: 400, epoch: 4 | loss: 0.6751670
	speed: 0.0059s/iter; left time: 12.0500s
Updating learning rate to 6.99773017e-05
Epoch: 4 cost time: 3.0820960998535156
Epoch: 4, Steps: 490 | Train Loss: 0.8000654 Vali Loss: 0.6203531 Best vali loss: 0.6105420
	iters: 100, epoch: 5 | loss: 0.7327390
	speed: 0.0167s/iter; left time: 31.0443s
	iters: 200, epoch: 5 | loss: 0.3230653
	speed: 0.0069s/iter; left time: 12.0659s
	iters: 300, epoch: 5 | loss: 0.2545446
	speed: 0.0069s/iter; left time: 11.4654s
	iters: 400, epoch: 5 | loss: 0.7874709
	speed: 0.0070s/iter; left time: 10.9761s
Updating learning rate to 3.498865085e-05
Epoch: 5 cost time: 3.43082857131958
Epoch: 5, Steps: 490 | Train Loss: 0.5244550 Vali Loss: 0.6329494 Best vali loss: 0.6105420
	iters: 100, epoch: 6 | loss: 0.4480819
	speed: 0.0179s/iter; left time: 24.5278s
	iters: 200, epoch: 6 | loss: 1.0826505
	speed: 0.0069s/iter; left time: 8.7693s
	iters: 300, epoch: 6 | loss: 0.7071173
	speed: 0.0070s/iter; left time: 8.2000s
	iters: 400, epoch: 6 | loss: 0.4139872
	speed: 0.0067s/iter; left time: 7.2127s
Updating learning rate to 1.7494325425e-05
Epoch: 6 cost time: 3.408384084701538
Epoch: 6, Steps: 490 | Train Loss: 0.6629593 Vali Loss: 0.6347671 Best vali loss: 0.6105420
	iters: 100, epoch: 7 | loss: 0.5339476
	speed: 0.0173s/iter; left time: 15.2368s
	iters: 200, epoch: 7 | loss: 0.5943639
	speed: 0.0068s/iter; left time: 5.3108s
	iters: 300, epoch: 7 | loss: 0.6873356
	speed: 0.0067s/iter; left time: 4.5911s
	iters: 400, epoch: 7 | loss: 0.6454031
	speed: 0.0067s/iter; left time: 3.9148s
Updating learning rate to 8.7471627125e-06
Epoch: 7 cost time: 3.372802495956421
Epoch: 7, Steps: 490 | Train Loss: 0.6152626 Vali Loss: 0.6221711 Best vali loss: 0.6105420
	iters: 100, epoch: 8 | loss: 0.5024585
	speed: 0.0175s/iter; left time: 6.8554s
	iters: 200, epoch: 8 | loss: 0.8991236
	speed: 0.0066s/iter; left time: 1.9326s
	iters: 300, epoch: 8 | loss: 1.0811282
	speed: 0.0065s/iter; left time: 1.2427s
	iters: 400, epoch: 8 | loss: 0.8895256
	speed: 0.0066s/iter; left time: 0.6016s
Updating learning rate to 4.37358135625e-06
Epoch: 8 cost time: 3.2469425201416016
Epoch: 8, Steps: 490 | Train Loss: 0.8430590 Vali Loss: 0.6210812 Best vali loss: 0.6105420

best validation loss 0.610541966379599

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0091231059117, 'e_layers': 3, 'learning_rate': 0.0015501326551, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7672825
	speed: 0.0113s/iter; left time: 43.0682s
	iters: 200, epoch: 1 | loss: 0.7775449
	speed: 0.0060s/iter; left time: 22.2429s
	iters: 300, epoch: 1 | loss: 1.0659835
	speed: 0.0057s/iter; left time: 20.6061s
	iters: 400, epoch: 1 | loss: 1.1727624
	speed: 0.0053s/iter; left time: 18.6942s
Updating learning rate to 0.0015501326551
Validation loss decreased (inf --> 0.6390).  Saving model state dict ...
Epoch: 1 cost time: 3.0360372066497803
Epoch: 1, Steps: 490 | Train Loss: 0.9458933 Vali Loss: 0.6390349 Best vali loss: 0.6390349
	iters: 100, epoch: 2 | loss: 1.0937014
	speed: 0.0151s/iter; left time: 50.2226s
	iters: 200, epoch: 2 | loss: 1.5472928
	speed: 0.0057s/iter; left time: 18.5616s
	iters: 300, epoch: 2 | loss: 0.5866839
	speed: 0.0053s/iter; left time: 16.6749s
	iters: 400, epoch: 2 | loss: 0.7317758
	speed: 0.0053s/iter; left time: 16.1899s
Updating learning rate to 0.00077506632755
Epoch: 2 cost time: 2.6990208625793457
Epoch: 2, Steps: 490 | Train Loss: 0.9898635 Vali Loss: 0.6526716 Best vali loss: 0.6390349
	iters: 100, epoch: 3 | loss: 1.1178976
	speed: 0.0142s/iter; left time: 40.2772s
	iters: 200, epoch: 3 | loss: 1.2690960
	speed: 0.0055s/iter; left time: 15.0757s
	iters: 300, epoch: 3 | loss: 0.9521074
	speed: 0.0053s/iter; left time: 14.0184s
	iters: 400, epoch: 3 | loss: 0.4442885
	speed: 0.0054s/iter; left time: 13.6568s
Updating learning rate to 0.000387533163775
Epoch: 3 cost time: 2.6922101974487305
Epoch: 3, Steps: 490 | Train Loss: 0.9458474 Vali Loss: 0.6471297 Best vali loss: 0.6390349

best validation loss 0.6390349245744411

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0045557689701, 'e_layers': 1, 'learning_rate': 0.0003266375974, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003142056940932609
Validation loss decreased (inf --> 0.6184).  Saving model state dict ...
Epoch: 1 cost time: 0.651071310043335
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6183966 Best vali loss: 0.6183966
Updating learning rate to 0.00027880262875601067
Validation loss decreased (0.6184 --> 0.5987).  Saving model state dict ...
Epoch: 2 cost time: 0.42640066146850586
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5987261 Best vali loss: 0.5987261
Updating learning rate to 0.00022581819715625914
Epoch: 3 cost time: 0.43790531158447266
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6000788 Best vali loss: 0.5987261

best validation loss 0.5987260865701785

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 2, 'learning_rate': 0.0015124708174, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6241993
	speed: 0.0097s/iter; left time: 74.9606s
	iters: 200, epoch: 1 | loss: 0.7535346
	speed: 0.0042s/iter; left time: 31.7775s
	iters: 300, epoch: 1 | loss: 0.6848635
	speed: 0.0041s/iter; left time: 30.8371s
	iters: 400, epoch: 1 | loss: 1.2787014
	speed: 0.0041s/iter; left time: 30.6173s
	iters: 500, epoch: 1 | loss: 0.3912363
	speed: 0.0041s/iter; left time: 29.9570s
	iters: 600, epoch: 1 | loss: 0.9050663
	speed: 0.0041s/iter; left time: 29.8464s
	iters: 700, epoch: 1 | loss: 0.7897297
	speed: 0.0041s/iter; left time: 29.2155s
	iters: 800, epoch: 1 | loss: 0.4579917
	speed: 0.0041s/iter; left time: 29.1844s
	iters: 900, epoch: 1 | loss: 0.5682213
	speed: 0.0042s/iter; left time: 28.8143s
Updating learning rate to 0.0015124708174
Validation loss decreased (inf --> 0.6361).  Saving model state dict ...
Epoch: 1 cost time: 4.326230525970459
Epoch: 1, Steps: 979 | Train Loss: 0.7170604 Vali Loss: 0.6360674 Best vali loss: 0.6360674
	iters: 100, epoch: 2 | loss: 1.3710822
	speed: 0.0139s/iter; left time: 93.9377s
	iters: 200, epoch: 2 | loss: 0.4197378
	speed: 0.0038s/iter; left time: 25.4733s
	iters: 300, epoch: 2 | loss: 2.1397660
	speed: 0.0039s/iter; left time: 25.5148s
	iters: 400, epoch: 2 | loss: 0.6356385
	speed: 0.0041s/iter; left time: 26.2058s
	iters: 500, epoch: 2 | loss: 0.9027766
	speed: 0.0040s/iter; left time: 25.2617s
	iters: 600, epoch: 2 | loss: 0.9746993
	speed: 0.0040s/iter; left time: 25.2419s
	iters: 700, epoch: 2 | loss: 0.8738788
	speed: 0.0046s/iter; left time: 28.0655s
	iters: 800, epoch: 2 | loss: 0.3175476
	speed: 0.0044s/iter; left time: 26.6978s
	iters: 900, epoch: 2 | loss: 0.5491439
	speed: 0.0044s/iter; left time: 26.2229s
Updating learning rate to 0.0007562354087
Validation loss decreased (0.6361 --> 0.6179).  Saving model state dict ...
Epoch: 2 cost time: 4.113960266113281
Epoch: 2, Steps: 979 | Train Loss: 0.9093634 Vali Loss: 0.6179409 Best vali loss: 0.6179409
	iters: 100, epoch: 3 | loss: 0.8457553
	speed: 0.0138s/iter; left time: 79.6183s
	iters: 200, epoch: 3 | loss: 0.8107237
	speed: 0.0036s/iter; left time: 20.5812s
	iters: 300, epoch: 3 | loss: 0.4377981
	speed: 0.0038s/iter; left time: 21.0332s
	iters: 400, epoch: 3 | loss: 1.1582854
	speed: 0.0037s/iter; left time: 20.4898s
	iters: 500, epoch: 3 | loss: 0.7737341
	speed: 0.0038s/iter; left time: 20.4913s
	iters: 600, epoch: 3 | loss: 0.4959848
	speed: 0.0039s/iter; left time: 20.6011s
	iters: 700, epoch: 3 | loss: 0.2659385
	speed: 0.0039s/iter; left time: 20.2111s
	iters: 800, epoch: 3 | loss: 0.3760695
	speed: 0.0040s/iter; left time: 20.3078s
	iters: 900, epoch: 3 | loss: 0.6124287
	speed: 0.0038s/iter; left time: 18.8685s
Updating learning rate to 0.00037811770435
Validation loss decreased (0.6179 --> 0.6003).  Saving model state dict ...
Epoch: 3 cost time: 3.790393590927124
Epoch: 3, Steps: 979 | Train Loss: 0.6418576 Vali Loss: 0.6003204 Best vali loss: 0.6003204

best validation loss 0.6003203924360897

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0045557689701, 'e_layers': 1, 'learning_rate': 0.0003266375974, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001633187987
Validation loss decreased (0.5987 --> 0.5985).  Saving model state dict ...
Epoch: 4 cost time: 0.7047147750854492
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5984502 Best vali loss: 0.5984502
Updating learning rate to 0.00010081940024374084
Epoch: 5 cost time: 0.47551655769348145
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6023042 Best vali loss: 0.5984502
Updating learning rate to 4.78349686439893e-05
Epoch: 6 cost time: 0.497636079788208
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6026969 Best vali loss: 0.5984502
Updating learning rate to 1.2431903306739055e-05
Epoch: 7 cost time: 0.5346221923828125
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6070934 Best vali loss: 0.5984502
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5554916858673096
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6066976 Best vali loss: 0.5984502

best validation loss 0.5984502371291991

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.6051).  Saving model state dict ...
Epoch: 1 cost time: 0.943629264831543
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6050603 Best vali loss: 0.6050603
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 0.5066883563995361
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6211952 Best vali loss: 0.6050603
Updating learning rate to 0.0008072813968307993
Validation loss decreased (0.6051 --> 0.6050).  Saving model state dict ...
Epoch: 3 cost time: 0.7301101684570312
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6049728 Best vali loss: 0.6049728
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 0.7120471000671387
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6122909 Best vali loss: 0.6049728
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 0.5510764122009277
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6083465 Best vali loss: 0.6049728
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.595156192779541
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6092801 Best vali loss: 0.6049728
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.6137821674346924
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6265578 Best vali loss: 0.6049728
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6044025421142578
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6233591 Best vali loss: 0.6049728

best validation loss 0.6049728142558728

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008573937177, 'e_layers': 4, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.6151).  Saving model state dict ...
Epoch: 1 cost time: 0.8110735416412354
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6150718 Best vali loss: 0.6150718
Updating learning rate to 0.00021594413975
Validation loss decreased (0.6151 --> 0.6126).  Saving model state dict ...
Epoch: 2 cost time: 0.6557362079620361
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6125527 Best vali loss: 0.6125527
Updating learning rate to 0.000107972069875
Validation loss decreased (0.6126 --> 0.6061).  Saving model state dict ...
Epoch: 3 cost time: 0.5976054668426514
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6061120 Best vali loss: 0.6061120
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.583106517791748
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6093576 Best vali loss: 0.6061120
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.6416454315185547
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6099652 Best vali loss: 0.6061120
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.48447728157043457
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6104143 Best vali loss: 0.6061120
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.5965924263000488
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6098441 Best vali loss: 0.6061120
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.5964126586914062
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6100333 Best vali loss: 0.6061120

best validation loss 0.6061120316806848

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0012223560033, 'e_layers': 4, 'learning_rate': 0.0005594578486, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8868054
	speed: 0.0136s/iter; left time: 12.0721s
Updating learning rate to 0.0005381647521121691
Validation loss decreased (inf --> 0.6248).  Saving model state dict ...
Epoch: 1 cost time: 1.2498986721038818
Epoch: 1, Steps: 123 | Train Loss: 0.8868054 Vali Loss: 0.6247643 Best vali loss: 0.6247643
	iters: 100, epoch: 2 | loss: 0.9608625
	speed: 0.0124s/iter; left time: 9.4494s
Updating learning rate to 0.0004775271435665484
Validation loss decreased (0.6248 --> 0.6075).  Saving model state dict ...
Epoch: 2 cost time: 0.9879083633422852
Epoch: 2, Steps: 123 | Train Loss: 0.9608625 Vali Loss: 0.6075190 Best vali loss: 0.6075190
	iters: 100, epoch: 3 | loss: 0.9645213
	speed: 0.0130s/iter; left time: 8.2842s
Updating learning rate to 0.0003867765491829184
Validation loss decreased (0.6075 --> 0.6068).  Saving model state dict ...
Epoch: 3 cost time: 1.012477159500122
Epoch: 3, Steps: 123 | Train Loss: 0.9645213 Vali Loss: 0.6067632 Best vali loss: 0.6067632

best validation loss 0.606763247757364

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0004476854138, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4408413
	speed: 0.0122s/iter; left time: 94.1817s
	iters: 200, epoch: 1 | loss: 1.0056593
	speed: 0.0059s/iter; left time: 45.1772s
	iters: 300, epoch: 1 | loss: 0.8310818
	speed: 0.0047s/iter; left time: 35.3978s
	iters: 400, epoch: 1 | loss: 0.5355993
	speed: 0.0055s/iter; left time: 40.9622s
	iters: 500, epoch: 1 | loss: 0.8022024
	speed: 0.0071s/iter; left time: 52.1382s
	iters: 600, epoch: 1 | loss: 0.5698076
	speed: 0.0066s/iter; left time: 48.0218s
	iters: 700, epoch: 1 | loss: 0.9165781
	speed: 0.0066s/iter; left time: 47.2639s
	iters: 800, epoch: 1 | loss: 0.5106938
	speed: 0.0067s/iter; left time: 46.7835s
	iters: 900, epoch: 1 | loss: 0.7860591
	speed: 0.0063s/iter; left time: 43.8465s
Updating learning rate to 0.00043064640230683294
Validation loss decreased (inf --> 0.6164).  Saving model state dict ...
Epoch: 1 cost time: 6.41382098197937
Epoch: 1, Steps: 979 | Train Loss: 0.7109470 Vali Loss: 0.6164401 Best vali loss: 0.6164401
	iters: 100, epoch: 2 | loss: 0.9296856
	speed: 0.0211s/iter; left time: 142.4276s
	iters: 200, epoch: 2 | loss: 0.2898339
	speed: 0.0067s/iter; left time: 44.4095s
	iters: 300, epoch: 2 | loss: 1.8973850
	speed: 0.0067s/iter; left time: 43.6036s
	iters: 400, epoch: 2 | loss: 1.1618030
	speed: 0.0068s/iter; left time: 44.1438s
	iters: 500, epoch: 2 | loss: 0.9971029
	speed: 0.0065s/iter; left time: 41.0641s
	iters: 600, epoch: 2 | loss: 0.4987482
	speed: 0.0065s/iter; left time: 40.9515s
	iters: 700, epoch: 2 | loss: 0.4069536
	speed: 0.0054s/iter; left time: 33.1504s
	iters: 800, epoch: 2 | loss: 0.8700719
	speed: 0.0058s/iter; left time: 35.0544s
	iters: 900, epoch: 2 | loss: 0.8505900
	speed: 0.0072s/iter; left time: 42.7825s
Updating learning rate to 0.00038212340286814276
Validation loss decreased (0.6164 --> 0.6060).  Saving model state dict ...
Epoch: 2 cost time: 6.456623554229736
Epoch: 2, Steps: 979 | Train Loss: 0.8780193 Vali Loss: 0.6060452 Best vali loss: 0.6060452
	iters: 100, epoch: 3 | loss: 1.7172290
	speed: 0.0227s/iter; left time: 130.9207s
	iters: 200, epoch: 3 | loss: 1.4033642
	speed: 0.0069s/iter; left time: 39.2243s
	iters: 300, epoch: 3 | loss: 0.7721121
	speed: 0.0069s/iter; left time: 38.7409s
	iters: 400, epoch: 3 | loss: 0.6324474
	speed: 0.0076s/iter; left time: 41.7380s
	iters: 500, epoch: 3 | loss: 0.9467414
	speed: 0.0074s/iter; left time: 39.6868s
	iters: 600, epoch: 3 | loss: 0.7862131
	speed: 0.0073s/iter; left time: 38.7115s
	iters: 700, epoch: 3 | loss: 0.6555820
	speed: 0.0072s/iter; left time: 37.1902s
	iters: 800, epoch: 3 | loss: 0.9307271
	speed: 0.0073s/iter; left time: 36.9996s
	iters: 900, epoch: 3 | loss: 0.4390374
	speed: 0.0068s/iter; left time: 33.7072s
Updating learning rate to 0.00030950360228638475
Validation loss decreased (0.6060 --> 0.5695).  Saving model state dict ...
Epoch: 3 cost time: 7.0810863971710205
Epoch: 3, Steps: 979 | Train Loss: 0.9203837 Vali Loss: 0.5694692 Best vali loss: 0.5694692

best validation loss 0.5694692320621769

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022649231903, 'e_layers': 4, 'learning_rate': 0.0003541777998, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8135983
	speed: 0.0155s/iter; left time: 13.6848s
Updating learning rate to 0.0003541777998
Validation loss decreased (inf --> 0.5931).  Saving model state dict ...
Epoch: 1 cost time: 1.500420093536377
Epoch: 1, Steps: 123 | Train Loss: 0.8135983 Vali Loss: 0.5930611 Best vali loss: 0.5930611
	iters: 100, epoch: 2 | loss: 0.9114022
	speed: 0.0156s/iter; left time: 11.8664s
Updating learning rate to 0.0001770888999
Validation loss decreased (0.5931 --> 0.5770).  Saving model state dict ...
Epoch: 2 cost time: 1.2553212642669678
Epoch: 2, Steps: 123 | Train Loss: 0.9114022 Vali Loss: 0.5770414 Best vali loss: 0.5770414
	iters: 100, epoch: 3 | loss: 0.6980768
	speed: 0.0151s/iter; left time: 9.6571s
Updating learning rate to 8.854444995e-05
Validation loss decreased (0.5770 --> 0.5598).  Saving model state dict ...
Epoch: 3 cost time: 1.2332046031951904
Epoch: 3, Steps: 123 | Train Loss: 0.6980768 Vali Loss: 0.5597854 Best vali loss: 0.5597854

best validation loss 0.5597853638793737

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022649231903, 'e_layers': 4, 'learning_rate': 0.0003541777998, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7613381
	speed: 0.0158s/iter; left time: 8.1735s
Updating learning rate to 4.4272224975e-05
Validation loss decreased (0.5598 --> 0.5539).  Saving model state dict ...
Epoch: 4 cost time: 1.4961867332458496
Epoch: 4, Steps: 123 | Train Loss: 0.7613381 Vali Loss: 0.5539195 Best vali loss: 0.5539195
	iters: 100, epoch: 5 | loss: 0.8305035
	speed: 0.0150s/iter; left time: 5.8909s
Updating learning rate to 2.21361124875e-05
Validation loss decreased (0.5539 --> 0.5515).  Saving model state dict ...
Epoch: 5 cost time: 1.2402799129486084
Epoch: 5, Steps: 123 | Train Loss: 0.8305035 Vali Loss: 0.5515462 Best vali loss: 0.5515462
	iters: 100, epoch: 6 | loss: 0.6666382
	speed: 0.0148s/iter; left time: 4.0052s
Updating learning rate to 1.106805624375e-05
Validation loss decreased (0.5515 --> 0.5494).  Saving model state dict ...
Epoch: 6 cost time: 1.2173612117767334
Epoch: 6, Steps: 123 | Train Loss: 0.6666382 Vali Loss: 0.5494436 Best vali loss: 0.5494436
	iters: 100, epoch: 7 | loss: 0.8340079
	speed: 0.0150s/iter; left time: 2.1996s
Updating learning rate to 5.534028121875e-06
Validation loss decreased (0.5494 --> 0.5471).  Saving model state dict ...
Epoch: 7 cost time: 1.2240374088287354
Epoch: 7, Steps: 123 | Train Loss: 0.8340079 Vali Loss: 0.5471298 Best vali loss: 0.5471298
	iters: 100, epoch: 8 | loss: 0.6168138
	speed: 0.0152s/iter; left time: 0.3647s
Updating learning rate to 2.7670140609375e-06
Epoch: 8 cost time: 1.2294752597808838
Epoch: 8, Steps: 123 | Train Loss: 0.6168138 Vali Loss: 0.5475222 Best vali loss: 0.5471298

best validation loss 0.5471298219373192

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0077420980639, 'e_layers': 3, 'learning_rate': 0.0044530631044, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3773243
	speed: 0.0124s/iter; left time: 95.6245s
	iters: 200, epoch: 1 | loss: 1.3439635
	speed: 0.0059s/iter; left time: 45.3982s
	iters: 300, epoch: 1 | loss: 0.4298639
	speed: 0.0057s/iter; left time: 42.6569s
	iters: 400, epoch: 1 | loss: 0.3690564
	speed: 0.0062s/iter; left time: 46.1401s
	iters: 500, epoch: 1 | loss: 0.9014519
	speed: 0.0064s/iter; left time: 47.0376s
	iters: 600, epoch: 1 | loss: 0.4629478
	speed: 0.0065s/iter; left time: 46.9248s
	iters: 700, epoch: 1 | loss: 1.0064818
	speed: 0.0062s/iter; left time: 44.0534s
	iters: 800, epoch: 1 | loss: 1.4714164
	speed: 0.0063s/iter; left time: 44.3639s
	iters: 900, epoch: 1 | loss: 0.7158139
	speed: 0.0058s/iter; left time: 40.3240s
Updating learning rate to 0.004283578481768166
Validation loss decreased (inf --> 0.6437).  Saving model state dict ...
Epoch: 1 cost time: 6.2882606983184814
Epoch: 1, Steps: 979 | Train Loss: 0.8975911 Vali Loss: 0.6437263 Best vali loss: 0.6437263
	iters: 100, epoch: 2 | loss: 0.4521515
	speed: 0.0195s/iter; left time: 131.6677s
	iters: 200, epoch: 2 | loss: 0.8982259
	speed: 0.0065s/iter; left time: 43.4476s
	iters: 300, epoch: 2 | loss: 0.7044359
	speed: 0.0063s/iter; left time: 41.1671s
	iters: 400, epoch: 2 | loss: 1.2754401
	speed: 0.0061s/iter; left time: 39.1132s
	iters: 500, epoch: 2 | loss: 0.2430351
	speed: 0.0055s/iter; left time: 35.0062s
	iters: 600, epoch: 2 | loss: 0.7827922
	speed: 0.0042s/iter; left time: 26.5065s
	iters: 700, epoch: 2 | loss: 0.6785679
	speed: 0.0045s/iter; left time: 27.7066s
	iters: 800, epoch: 2 | loss: 1.3984873
	speed: 0.0061s/iter; left time: 36.6851s
	iters: 900, epoch: 2 | loss: 1.3546387
	speed: 0.0059s/iter; left time: 35.3934s
Updating learning rate to 0.0038009271112864292
Epoch: 2 cost time: 5.664642810821533
Epoch: 2, Steps: 979 | Train Loss: 0.8653083 Vali Loss: 0.6467487 Best vali loss: 0.6437263
	iters: 100, epoch: 3 | loss: 0.8575107
	speed: 0.0196s/iter; left time: 113.0430s
	iters: 200, epoch: 3 | loss: 0.8292786
	speed: 0.0060s/iter; left time: 34.1736s
	iters: 300, epoch: 3 | loss: 0.9507374
	speed: 0.0060s/iter; left time: 33.2931s
	iters: 400, epoch: 3 | loss: 1.0400647
	speed: 0.0060s/iter; left time: 32.6529s
	iters: 500, epoch: 3 | loss: 0.7905027
	speed: 0.0059s/iter; left time: 31.9701s
	iters: 600, epoch: 3 | loss: 0.3102752
	speed: 0.0060s/iter; left time: 31.4020s
	iters: 700, epoch: 3 | loss: 1.2060219
	speed: 0.0058s/iter; left time: 29.8624s
	iters: 800, epoch: 3 | loss: 1.9132266
	speed: 0.0056s/iter; left time: 28.3475s
	iters: 900, epoch: 3 | loss: 0.4693647
	speed: 0.0059s/iter; left time: 29.2033s
Updating learning rate to 0.0030785882888650674
Epoch: 3 cost time: 5.79391074180603
Epoch: 3, Steps: 979 | Train Loss: 0.9296647 Vali Loss: 0.6446946 Best vali loss: 0.6437263
	iters: 100, epoch: 4 | loss: 0.3784339
	speed: 0.0200s/iter; left time: 96.0104s
	iters: 200, epoch: 4 | loss: 1.2113711
	speed: 0.0057s/iter; left time: 26.9036s
	iters: 300, epoch: 4 | loss: 0.4401371
	speed: 0.0051s/iter; left time: 23.4137s
	iters: 400, epoch: 4 | loss: 0.7766312
	speed: 0.0040s/iter; left time: 17.8051s
	iters: 500, epoch: 4 | loss: 1.0666859
	speed: 0.0048s/iter; left time: 21.2931s
	iters: 600, epoch: 4 | loss: 0.9395513
	speed: 0.0060s/iter; left time: 25.7507s
	iters: 700, epoch: 4 | loss: 0.5390256
	speed: 0.0058s/iter; left time: 24.2894s
	iters: 800, epoch: 4 | loss: 2.0250375
	speed: 0.0055s/iter; left time: 22.4639s
	iters: 900, epoch: 4 | loss: 0.9592424
	speed: 0.0040s/iter; left time: 16.1707s
Updating learning rate to 0.0022265315522
Validation loss decreased (0.6437 --> 0.6393).  Saving model state dict ...
Epoch: 4 cost time: 5.088708400726318
Epoch: 4, Steps: 979 | Train Loss: 0.9262351 Vali Loss: 0.6392805 Best vali loss: 0.6392805
	iters: 100, epoch: 5 | loss: 1.5718936
	speed: 0.0152s/iter; left time: 58.1612s
	iters: 200, epoch: 5 | loss: 0.5888255
	speed: 0.0048s/iter; left time: 17.8416s
	iters: 300, epoch: 5 | loss: 1.0701827
	speed: 0.0048s/iter; left time: 17.3473s
	iters: 400, epoch: 5 | loss: 0.6466997
	speed: 0.0046s/iter; left time: 16.2314s
	iters: 500, epoch: 5 | loss: 0.7377062
	speed: 0.0047s/iter; left time: 16.0744s
	iters: 600, epoch: 5 | loss: 1.3219402
	speed: 0.0047s/iter; left time: 15.5156s
	iters: 700, epoch: 5 | loss: 0.5724226
	speed: 0.0046s/iter; left time: 14.7437s
	iters: 800, epoch: 5 | loss: 0.6888248
	speed: 0.0048s/iter; left time: 14.8212s
	iters: 900, epoch: 5 | loss: 0.6420855
	speed: 0.0051s/iter; left time: 15.4351s
Updating learning rate to 0.001374474815534933
Epoch: 5 cost time: 4.691487789154053
Epoch: 5, Steps: 979 | Train Loss: 0.8711756 Vali Loss: 0.6425022 Best vali loss: 0.6392805
	iters: 100, epoch: 6 | loss: 1.1019460
	speed: 0.0155s/iter; left time: 43.9656s
	iters: 200, epoch: 6 | loss: 0.6364592
	speed: 0.0052s/iter; left time: 14.3675s
	iters: 300, epoch: 6 | loss: 0.9464026
	speed: 0.0052s/iter; left time: 13.7895s
	iters: 400, epoch: 6 | loss: 0.9825672
	speed: 0.0053s/iter; left time: 13.3496s
	iters: 500, epoch: 6 | loss: 0.3582957
	speed: 0.0050s/iter; left time: 12.1824s
	iters: 600, epoch: 6 | loss: 0.6072007
	speed: 0.0053s/iter; left time: 12.3060s
	iters: 700, epoch: 6 | loss: 1.3654041
	speed: 0.0046s/iter; left time: 10.2102s
	iters: 800, epoch: 6 | loss: 1.3651797
	speed: 0.0045s/iter; left time: 9.5277s
	iters: 900, epoch: 6 | loss: 0.5033236
	speed: 0.0051s/iter; left time: 10.4194s
Updating learning rate to 0.0006521359931135707
Epoch: 6 cost time: 4.998355388641357
Epoch: 6, Steps: 979 | Train Loss: 0.8740865 Vali Loss: 0.6436890 Best vali loss: 0.6392805
	iters: 100, epoch: 7 | loss: 0.9123847
	speed: 0.0161s/iter; left time: 29.9695s
	iters: 200, epoch: 7 | loss: 1.4805571
	speed: 0.0053s/iter; left time: 9.2493s
	iters: 300, epoch: 7 | loss: 0.8949662
	speed: 0.0053s/iter; left time: 8.7599s
	iters: 400, epoch: 7 | loss: 0.4667905
	speed: 0.0053s/iter; left time: 8.3274s
	iters: 500, epoch: 7 | loss: 0.6194562
	speed: 0.0052s/iter; left time: 7.6357s
	iters: 600, epoch: 7 | loss: 1.0635992
	speed: 0.0049s/iter; left time: 6.7122s
	iters: 700, epoch: 7 | loss: 0.9716886
	speed: 0.0047s/iter; left time: 5.8759s
	iters: 800, epoch: 7 | loss: 1.1764032
	speed: 0.0043s/iter; left time: 4.9298s
	iters: 900, epoch: 7 | loss: 0.7945857
	speed: 0.0041s/iter; left time: 4.3306s
Updating learning rate to 0.00016948462263183437
Epoch: 7 cost time: 4.881864309310913
Epoch: 7, Steps: 979 | Train Loss: 0.9311590 Vali Loss: 0.6438751 Best vali loss: 0.6392805
	iters: 100, epoch: 8 | loss: 1.0496618
	speed: 0.0190s/iter; left time: 16.7552s
	iters: 200, epoch: 8 | loss: 0.7158161
	speed: 0.0059s/iter; left time: 4.6195s
	iters: 300, epoch: 8 | loss: 1.3956634
	speed: 0.0061s/iter; left time: 4.1519s
	iters: 400, epoch: 8 | loss: 1.6510080
	speed: 0.0046s/iter; left time: 2.6710s
	iters: 500, epoch: 8 | loss: 2.5421717
	speed: 0.0043s/iter; left time: 2.0672s
	iters: 600, epoch: 8 | loss: 0.6079773
	speed: 0.0042s/iter; left time: 1.6024s
	iters: 700, epoch: 8 | loss: 0.7417865
	speed: 0.0043s/iter; left time: 1.1929s
	iters: 800, epoch: 8 | loss: 0.6965838
	speed: 0.0061s/iter; left time: 1.0904s
	iters: 900, epoch: 8 | loss: 1.1083119
	speed: 0.0065s/iter; left time: 0.5181s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.33727765083313
Epoch: 8, Steps: 979 | Train Loss: 1.1676645 Vali Loss: 0.6436995 Best vali loss: 0.6392805

best validation loss 0.6392804957384977

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0437458
	speed: 0.0142s/iter; left time: 12.6013s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.5863).  Saving model state dict ...
Epoch: 1 cost time: 1.336683988571167
Epoch: 1, Steps: 123 | Train Loss: 1.0437458 Vali Loss: 0.5862605 Best vali loss: 0.5862605
	iters: 100, epoch: 2 | loss: 0.7110209
	speed: 0.0132s/iter; left time: 10.0546s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.5863 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 1.0687906742095947
Epoch: 2, Steps: 123 | Train Loss: 0.7110209 Vali Loss: 0.5611274 Best vali loss: 0.5611274
	iters: 100, epoch: 3 | loss: 0.8771235
	speed: 0.0118s/iter; left time: 7.5419s
Updating learning rate to 0.000178512795825
Validation loss decreased (0.5611 --> 0.5591).  Saving model state dict ...
Epoch: 3 cost time: 0.8732903003692627
Epoch: 3, Steps: 123 | Train Loss: 0.8771235 Vali Loss: 0.5590721 Best vali loss: 0.5590721
	iters: 100, epoch: 4 | loss: 0.7080939
	speed: 0.0129s/iter; left time: 6.6677s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 1.0972468852996826
Epoch: 4, Steps: 123 | Train Loss: 0.7080939 Vali Loss: 0.5596363 Best vali loss: 0.5590721
	iters: 100, epoch: 5 | loss: 0.8091006
	speed: 0.0139s/iter; left time: 5.4459s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 1.1610374450683594
Epoch: 5, Steps: 123 | Train Loss: 0.8091006 Vali Loss: 0.5595547 Best vali loss: 0.5590721
	iters: 100, epoch: 6 | loss: 0.7275994
	speed: 0.0138s/iter; left time: 3.7314s
Updating learning rate to 2.2314099478125e-05
Epoch: 6 cost time: 1.1145365238189697
Epoch: 6, Steps: 123 | Train Loss: 0.7275994 Vali Loss: 0.5594869 Best vali loss: 0.5590721
	iters: 100, epoch: 7 | loss: 0.6018368
	speed: 0.0134s/iter; left time: 1.9723s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 1.0873448848724365
Epoch: 7, Steps: 123 | Train Loss: 0.6018368 Vali Loss: 0.5600702 Best vali loss: 0.5590721
	iters: 100, epoch: 8 | loss: 0.6674206
	speed: 0.0123s/iter; left time: 0.2945s
Updating learning rate to 5.57852486953125e-06
Validation loss decreased (0.5591 --> 0.5586).  Saving model state dict ...
Epoch: 8 cost time: 0.9643089771270752
Epoch: 8, Steps: 123 | Train Loss: 0.6674206 Vali Loss: 0.5586327 Best vali loss: 0.5586327

best validation loss 0.5586326635584463

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008582998373, 'e_layers': 1, 'learning_rate': 0.0002750366042, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8043212
	speed: 0.0114s/iter; left time: 10.0956s
Updating learning rate to 0.0002645686467558939
Validation loss decreased (inf --> 0.6026).  Saving model state dict ...
Epoch: 1 cost time: 0.993863582611084
Epoch: 1, Steps: 123 | Train Loss: 0.8043212 Vali Loss: 0.6025888 Best vali loss: 0.6025888
	iters: 100, epoch: 2 | loss: 0.7770809
	speed: 0.0097s/iter; left time: 7.3794s
Updating learning rate to 0.00023475842605217025
Epoch: 2 cost time: 0.7681214809417725
Epoch: 2, Steps: 123 | Train Loss: 0.7770809 Vali Loss: 0.6092910 Best vali loss: 0.6025888
	iters: 100, epoch: 3 | loss: 0.9595550
	speed: 0.0079s/iter; left time: 5.0606s
Updating learning rate to 0.00019014427796064737
Epoch: 3 cost time: 0.5021283626556396
Epoch: 3, Steps: 123 | Train Loss: 0.9595550 Vali Loss: 0.6031957 Best vali loss: 0.6025888

best validation loss 0.6025887797244

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.006740282698, 'e_layers': 4, 'learning_rate': 0.0001043113492, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1865969
	speed: 0.0119s/iter; left time: 45.2867s
	iters: 200, epoch: 1 | loss: 0.8835621
	speed: 0.0063s/iter; left time: 23.4827s
	iters: 300, epoch: 1 | loss: 1.0464410
	speed: 0.0063s/iter; left time: 22.8007s
	iters: 400, epoch: 1 | loss: 0.8907230
	speed: 0.0062s/iter; left time: 21.9452s
Updating learning rate to 0.0001043113492
Validation loss decreased (inf --> 0.6115).  Saving model state dict ...
Epoch: 1 cost time: 3.3614509105682373
Epoch: 1, Steps: 490 | Train Loss: 1.0018307 Vali Loss: 0.6114828 Best vali loss: 0.6114828
	iters: 100, epoch: 2 | loss: 0.9463524
	speed: 0.0168s/iter; left time: 55.9524s
	iters: 200, epoch: 2 | loss: 0.6122469
	speed: 0.0063s/iter; left time: 20.2766s
	iters: 300, epoch: 2 | loss: 0.6141210
	speed: 0.0063s/iter; left time: 19.7719s
	iters: 400, epoch: 2 | loss: 0.6564149
	speed: 0.0060s/iter; left time: 18.2379s
Updating learning rate to 5.21556746e-05
Validation loss decreased (0.6115 --> 0.6098).  Saving model state dict ...
Epoch: 2 cost time: 3.0983803272247314
Epoch: 2, Steps: 490 | Train Loss: 0.7072838 Vali Loss: 0.6098185 Best vali loss: 0.6098185
	iters: 100, epoch: 3 | loss: 0.9387729
	speed: 0.0168s/iter; left time: 47.6107s
	iters: 200, epoch: 3 | loss: 0.5970420
	speed: 0.0063s/iter; left time: 17.2342s
	iters: 300, epoch: 3 | loss: 0.7042350
	speed: 0.0063s/iter; left time: 16.5613s
	iters: 400, epoch: 3 | loss: 0.8058986
	speed: 0.0066s/iter; left time: 16.6502s
Updating learning rate to 2.60778373e-05
Validation loss decreased (0.6098 --> 0.6028).  Saving model state dict ...
Epoch: 3 cost time: 3.194188117980957
Epoch: 3, Steps: 490 | Train Loss: 0.7614871 Vali Loss: 0.6028441 Best vali loss: 0.6028441

best validation loss 0.6028440697553918

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020155805449, 'e_layers': 3, 'learning_rate': 0.0005770289561, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5342405
	speed: 0.0112s/iter; left time: 86.7677s
	iters: 200, epoch: 1 | loss: 1.2612274
	speed: 0.0054s/iter; left time: 41.1327s
	iters: 300, epoch: 1 | loss: 0.8620564
	speed: 0.0051s/iter; left time: 38.6872s
	iters: 400, epoch: 1 | loss: 0.5692182
	speed: 0.0051s/iter; left time: 37.7843s
	iters: 500, epoch: 1 | loss: 1.0618745
	speed: 0.0050s/iter; left time: 36.5360s
	iters: 600, epoch: 1 | loss: 1.0814965
	speed: 0.0050s/iter; left time: 36.1840s
	iters: 700, epoch: 1 | loss: 0.9352473
	speed: 0.0050s/iter; left time: 35.8718s
	iters: 800, epoch: 1 | loss: 1.7337672
	speed: 0.0050s/iter; left time: 35.1521s
	iters: 900, epoch: 1 | loss: 1.3518549
	speed: 0.0051s/iter; left time: 35.1887s
Updating learning rate to 0.0005770289561
Validation loss decreased (inf --> 0.6533).  Saving model state dict ...
Epoch: 1 cost time: 5.316625356674194
Epoch: 1, Steps: 979 | Train Loss: 1.0434425 Vali Loss: 0.6533127 Best vali loss: 0.6533127
	iters: 100, epoch: 2 | loss: 1.8112090
	speed: 0.0163s/iter; left time: 110.4263s
	iters: 200, epoch: 2 | loss: 1.9304223
	speed: 0.0051s/iter; left time: 33.9346s
	iters: 300, epoch: 2 | loss: 1.2689341
	speed: 0.0051s/iter; left time: 33.2056s
	iters: 400, epoch: 2 | loss: 0.6936963
	speed: 0.0054s/iter; left time: 34.9103s
	iters: 500, epoch: 2 | loss: 1.0619144
	speed: 0.0052s/iter; left time: 33.3128s
	iters: 600, epoch: 2 | loss: 0.3050585
	speed: 0.0050s/iter; left time: 31.1878s
	iters: 700, epoch: 2 | loss: 0.8488398
	speed: 0.0048s/iter; left time: 29.3690s
	iters: 800, epoch: 2 | loss: 0.6185400
	speed: 0.0046s/iter; left time: 27.8327s
	iters: 900, epoch: 2 | loss: 0.6637460
	speed: 0.0043s/iter; left time: 25.8550s
Updating learning rate to 0.00028851447805
Validation loss decreased (0.6533 --> 0.6252).  Saving model state dict ...
Epoch: 2 cost time: 4.835429668426514
Epoch: 2, Steps: 979 | Train Loss: 1.0224845 Vali Loss: 0.6251620 Best vali loss: 0.6251620
	iters: 100, epoch: 3 | loss: 0.6390969
	speed: 0.0191s/iter; left time: 110.2531s
	iters: 200, epoch: 3 | loss: 0.9862925
	speed: 0.0075s/iter; left time: 42.5029s
	iters: 300, epoch: 3 | loss: 0.4651759
	speed: 0.0077s/iter; left time: 43.1046s
	iters: 400, epoch: 3 | loss: 1.0294223
	speed: 0.0080s/iter; left time: 43.7560s
	iters: 500, epoch: 3 | loss: 0.2771620
	speed: 0.0066s/iter; left time: 35.2345s
	iters: 600, epoch: 3 | loss: 0.5935707
	speed: 0.0041s/iter; left time: 21.7930s
	iters: 700, epoch: 3 | loss: 0.9190926
	speed: 0.0040s/iter; left time: 20.9372s
	iters: 800, epoch: 3 | loss: 0.3735651
	speed: 0.0072s/iter; left time: 36.7665s
	iters: 900, epoch: 3 | loss: 0.3871655
	speed: 0.0074s/iter; left time: 36.9352s
Updating learning rate to 0.000144257239025
Validation loss decreased (0.6252 --> 0.6175).  Saving model state dict ...
Epoch: 3 cost time: 6.697293758392334
Epoch: 3, Steps: 979 | Train Loss: 0.6300604 Vali Loss: 0.6175199 Best vali loss: 0.6175199

best validation loss 0.6175199126491168

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008582998373, 'e_layers': 1, 'learning_rate': 0.0002750366042, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7472497
	speed: 0.0140s/iter; left time: 7.2204s
Updating learning rate to 0.0001375183021
Epoch: 4 cost time: 1.2819807529449463
Epoch: 4, Steps: 123 | Train Loss: 0.7472497 Vali Loss: 0.6083521 Best vali loss: 0.6025888
	iters: 100, epoch: 5 | loss: 0.7009345
	speed: 0.0119s/iter; left time: 4.6802s
Updating learning rate to 8.489232623935268e-05
Epoch: 5 cost time: 0.9266788959503174
Epoch: 5, Steps: 123 | Train Loss: 0.7009345 Vali Loss: 0.6183352 Best vali loss: 0.6025888
	iters: 100, epoch: 6 | loss: 0.9326051
	speed: 0.0091s/iter; left time: 2.4683s
Updating learning rate to 4.027817814782977e-05
Epoch: 6 cost time: 0.6004676818847656
Epoch: 6, Steps: 123 | Train Loss: 0.9326051 Vali Loss: 0.6168121 Best vali loss: 0.6025888
	iters: 100, epoch: 7 | loss: 0.8376149
	speed: 0.0067s/iter; left time: 0.9827s
Updating learning rate to 1.0467957444106099e-05
Epoch: 7 cost time: 0.5021793842315674
Epoch: 7, Steps: 123 | Train Loss: 0.8376149 Vali Loss: 0.6213212 Best vali loss: 0.6025888
	iters: 100, epoch: 8 | loss: 0.6506255
	speed: 0.0067s/iter; left time: 0.1617s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5198633670806885
Epoch: 8, Steps: 123 | Train Loss: 0.6506255 Vali Loss: 0.6203595 Best vali loss: 0.6025888

best validation loss 0.6025887797244

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0016263438524, 'e_layers': 1, 'learning_rate': 0.0001009597245, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8287398
	speed: 0.0095s/iter; left time: 8.4026s
Updating learning rate to 0.0001009597245
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 0.7753829956054688
Epoch: 1, Steps: 123 | Train Loss: 0.8287398 Vali Loss: 0.6041369 Best vali loss: 0.6041369
	iters: 100, epoch: 2 | loss: 0.7396817
	speed: 0.0069s/iter; left time: 5.2461s
Updating learning rate to 5.047986225e-05
Epoch: 2 cost time: 0.5147359371185303
Epoch: 2, Steps: 123 | Train Loss: 0.7396817 Vali Loss: 0.6061594 Best vali loss: 0.6041369
	iters: 100, epoch: 3 | loss: 0.6591057
	speed: 0.0069s/iter; left time: 4.4038s
Updating learning rate to 2.5239931125e-05
Epoch: 3 cost time: 0.5181171894073486
Epoch: 3, Steps: 123 | Train Loss: 0.6591057 Vali Loss: 0.6096955 Best vali loss: 0.6041369
	iters: 100, epoch: 4 | loss: 1.0257840
	speed: 0.0066s/iter; left time: 3.4312s
Updating learning rate to 1.26199655625e-05
Epoch: 4 cost time: 0.5073056221008301
Epoch: 4, Steps: 123 | Train Loss: 1.0257840 Vali Loss: 0.6063505 Best vali loss: 0.6041369
	iters: 100, epoch: 5 | loss: 0.8838193
	speed: 0.0069s/iter; left time: 2.7166s
Updating learning rate to 6.30998278125e-06
Epoch: 5 cost time: 0.5122132301330566
Epoch: 5, Steps: 123 | Train Loss: 0.8838193 Vali Loss: 0.6066074 Best vali loss: 0.6041369
	iters: 100, epoch: 6 | loss: 0.9465231
	speed: 0.0066s/iter; left time: 1.7759s
Updating learning rate to 3.154991390625e-06
Epoch: 6 cost time: 0.4992372989654541
Epoch: 6, Steps: 123 | Train Loss: 0.9465231 Vali Loss: 0.6051223 Best vali loss: 0.6041369
	iters: 100, epoch: 7 | loss: 0.7266753
	speed: 0.0067s/iter; left time: 0.9798s
Updating learning rate to 1.5774956953125e-06
Epoch: 7 cost time: 0.4991929531097412
Epoch: 7, Steps: 123 | Train Loss: 0.7266753 Vali Loss: 0.6051198 Best vali loss: 0.6041369
	iters: 100, epoch: 8 | loss: 0.6605020
	speed: 0.0069s/iter; left time: 0.1660s
Updating learning rate to 7.8874784765625e-07
Epoch: 8 cost time: 0.5263280868530273
Epoch: 8, Steps: 123 | Train Loss: 0.6605020 Vali Loss: 0.6052913 Best vali loss: 0.6041369

best validation loss 0.6041369128839553

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0061170225804, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3322072
	speed: 0.0093s/iter; left time: 72.0189s
	iters: 200, epoch: 1 | loss: 0.5003685
	speed: 0.0039s/iter; left time: 30.0617s
	iters: 300, epoch: 1 | loss: 0.7479547
	speed: 0.0040s/iter; left time: 29.8273s
	iters: 400, epoch: 1 | loss: 0.2630591
	speed: 0.0038s/iter; left time: 28.4101s
	iters: 500, epoch: 1 | loss: 1.4462456
	speed: 0.0038s/iter; left time: 28.2163s
	iters: 600, epoch: 1 | loss: 0.7441274
	speed: 0.0038s/iter; left time: 27.6489s
	iters: 700, epoch: 1 | loss: 1.7860727
	speed: 0.0039s/iter; left time: 27.5607s
	iters: 800, epoch: 1 | loss: 1.2711433
	speed: 0.0038s/iter; left time: 27.0591s
	iters: 900, epoch: 1 | loss: 0.2278863
	speed: 0.0037s/iter; left time: 25.6238s
Updating learning rate to 0.0005675671244
Validation loss decreased (inf --> 0.6155).  Saving model state dict ...
Epoch: 1 cost time: 4.0390784740448
Epoch: 1, Steps: 979 | Train Loss: 0.8132294 Vali Loss: 0.6155190 Best vali loss: 0.6155190
	iters: 100, epoch: 2 | loss: 0.5945585
	speed: 0.0134s/iter; left time: 90.4217s
	iters: 200, epoch: 2 | loss: 1.3361329
	speed: 0.0039s/iter; left time: 25.9790s
	iters: 300, epoch: 2 | loss: 0.6737596
	speed: 0.0040s/iter; left time: 26.5272s
	iters: 400, epoch: 2 | loss: 0.5366036
	speed: 0.0041s/iter; left time: 26.2657s
	iters: 500, epoch: 2 | loss: 0.4999168
	speed: 0.0041s/iter; left time: 25.9721s
	iters: 600, epoch: 2 | loss: 0.8325852
	speed: 0.0040s/iter; left time: 25.2821s
	iters: 700, epoch: 2 | loss: 1.4011998
	speed: 0.0040s/iter; left time: 24.7495s
	iters: 800, epoch: 2 | loss: 0.3081793
	speed: 0.0040s/iter; left time: 24.4054s
	iters: 900, epoch: 2 | loss: 0.7515606
	speed: 0.0040s/iter; left time: 24.0546s
Updating learning rate to 0.0002837835622
Epoch: 2 cost time: 3.990001916885376
Epoch: 2, Steps: 979 | Train Loss: 0.7704996 Vali Loss: 0.6229109 Best vali loss: 0.6155190
	iters: 100, epoch: 3 | loss: 1.0709201
	speed: 0.0136s/iter; left time: 78.2588s
	iters: 200, epoch: 3 | loss: 0.7966371
	speed: 0.0036s/iter; left time: 20.6290s
	iters: 300, epoch: 3 | loss: 0.9066757
	speed: 0.0037s/iter; left time: 20.4395s
	iters: 400, epoch: 3 | loss: 0.5440480
	speed: 0.0040s/iter; left time: 21.8684s
	iters: 500, epoch: 3 | loss: 0.3006649
	speed: 0.0039s/iter; left time: 21.0980s
	iters: 600, epoch: 3 | loss: 0.9289162
	speed: 0.0040s/iter; left time: 21.1435s
	iters: 700, epoch: 3 | loss: 0.4369655
	speed: 0.0040s/iter; left time: 20.8207s
	iters: 800, epoch: 3 | loss: 0.8260478
	speed: 0.0040s/iter; left time: 20.3455s
	iters: 900, epoch: 3 | loss: 1.1267239
	speed: 0.0041s/iter; left time: 20.2418s
Updating learning rate to 0.0001418917811
Validation loss decreased (0.6155 --> 0.5827).  Saving model state dict ...
Epoch: 3 cost time: 3.8603336811065674
Epoch: 3, Steps: 979 | Train Loss: 0.7708443 Vali Loss: 0.5826680 Best vali loss: 0.5826680
	iters: 100, epoch: 4 | loss: 0.7421167
	speed: 0.0139s/iter; left time: 66.6515s
	iters: 200, epoch: 4 | loss: 0.8303771
	speed: 0.0041s/iter; left time: 19.2448s
	iters: 300, epoch: 4 | loss: 0.7283579
	speed: 0.0041s/iter; left time: 18.8714s
	iters: 400, epoch: 4 | loss: 0.9091574
	speed: 0.0040s/iter; left time: 17.8135s
	iters: 500, epoch: 4 | loss: 0.8827920
	speed: 0.0038s/iter; left time: 16.5835s
	iters: 600, epoch: 4 | loss: 0.2884976
	speed: 0.0038s/iter; left time: 16.3079s
	iters: 700, epoch: 4 | loss: 1.6165558
	speed: 0.0039s/iter; left time: 16.4350s
	iters: 800, epoch: 4 | loss: 1.4095690
	speed: 0.0039s/iter; left time: 16.1669s
	iters: 900, epoch: 4 | loss: 0.2547930
	speed: 0.0039s/iter; left time: 15.7078s
Updating learning rate to 7.094589055e-05
Validation loss decreased (0.5827 --> 0.5580).  Saving model state dict ...
Epoch: 4 cost time: 3.908506155014038
Epoch: 4, Steps: 979 | Train Loss: 0.8513574 Vali Loss: 0.5580336 Best vali loss: 0.5580336
	iters: 100, epoch: 5 | loss: 1.0903323
	speed: 0.0135s/iter; left time: 51.6272s
	iters: 200, epoch: 5 | loss: 0.7396299
	speed: 0.0038s/iter; left time: 14.2695s
	iters: 300, epoch: 5 | loss: 0.4246891
	speed: 0.0039s/iter; left time: 14.0081s
	iters: 400, epoch: 5 | loss: 0.6158116
	speed: 0.0042s/iter; left time: 14.6540s
	iters: 500, epoch: 5 | loss: 0.6814632
	speed: 0.0040s/iter; left time: 13.6345s
	iters: 600, epoch: 5 | loss: 0.4850889
	speed: 0.0041s/iter; left time: 13.4359s
	iters: 700, epoch: 5 | loss: 0.5069449
	speed: 0.0041s/iter; left time: 13.2763s
	iters: 800, epoch: 5 | loss: 0.8137193
	speed: 0.0038s/iter; left time: 11.9637s
	iters: 900, epoch: 5 | loss: 0.7081648
	speed: 0.0037s/iter; left time: 11.2799s
Updating learning rate to 3.5472945275e-05
Epoch: 5 cost time: 3.898000717163086
Epoch: 5, Steps: 979 | Train Loss: 0.6739827 Vali Loss: 0.5614971 Best vali loss: 0.5580336
	iters: 100, epoch: 6 | loss: 0.4130558
	speed: 0.0135s/iter; left time: 38.3112s
	iters: 200, epoch: 6 | loss: 1.1151315
	speed: 0.0039s/iter; left time: 10.6040s
	iters: 300, epoch: 6 | loss: 0.5344407
	speed: 0.0038s/iter; left time: 10.1234s
	iters: 400, epoch: 6 | loss: 1.2933881
	speed: 0.0039s/iter; left time: 9.8253s
	iters: 500, epoch: 6 | loss: 0.2667810
	speed: 0.0039s/iter; left time: 9.4434s
	iters: 600, epoch: 6 | loss: 0.3091829
	speed: 0.0039s/iter; left time: 9.1740s
	iters: 700, epoch: 6 | loss: 0.7420418
	speed: 0.0040s/iter; left time: 8.8748s
	iters: 800, epoch: 6 | loss: 0.3072883
	speed: 0.0041s/iter; left time: 8.6789s
	iters: 900, epoch: 6 | loss: 0.8832169
	speed: 0.0040s/iter; left time: 8.2491s
Updating learning rate to 1.77364726375e-05
Epoch: 6 cost time: 3.9138879776000977
Epoch: 6, Steps: 979 | Train Loss: 0.6516141 Vali Loss: 0.5688698 Best vali loss: 0.5580336
	iters: 100, epoch: 7 | loss: 0.3941730
	speed: 0.0135s/iter; left time: 25.1265s
	iters: 200, epoch: 7 | loss: 0.5410740
	speed: 0.0038s/iter; left time: 6.7564s
	iters: 300, epoch: 7 | loss: 0.5612705
	speed: 0.0044s/iter; left time: 7.3759s
	iters: 400, epoch: 7 | loss: 0.2722584
	speed: 0.0046s/iter; left time: 7.1965s
	iters: 500, epoch: 7 | loss: 0.5602793
	speed: 0.0046s/iter; left time: 6.7839s
	iters: 600, epoch: 7 | loss: 0.5889871
	speed: 0.0046s/iter; left time: 6.3066s
	iters: 700, epoch: 7 | loss: 0.5304739
	speed: 0.0041s/iter; left time: 5.1722s
	iters: 800, epoch: 7 | loss: 1.0651143
	speed: 0.0039s/iter; left time: 4.5705s
	iters: 900, epoch: 7 | loss: 0.5334277
	speed: 0.0038s/iter; left time: 4.0705s
Updating learning rate to 8.86823631875e-06
Epoch: 7 cost time: 4.145406484603882
Epoch: 7, Steps: 979 | Train Loss: 0.5607842 Vali Loss: 0.5651880 Best vali loss: 0.5580336
	iters: 100, epoch: 8 | loss: 0.5127715
	speed: 0.0135s/iter; left time: 11.9193s
	iters: 200, epoch: 8 | loss: 0.8900327
	speed: 0.0040s/iter; left time: 3.1062s
	iters: 300, epoch: 8 | loss: 1.1708181
	speed: 0.0039s/iter; left time: 2.6241s
	iters: 400, epoch: 8 | loss: 0.5587821
	speed: 0.0037s/iter; left time: 2.1291s
	iters: 500, epoch: 8 | loss: 0.6219608
	speed: 0.0037s/iter; left time: 1.7977s
	iters: 600, epoch: 8 | loss: 1.2255437
	speed: 0.0038s/iter; left time: 1.4590s
	iters: 700, epoch: 8 | loss: 0.3947622
	speed: 0.0039s/iter; left time: 1.1017s
	iters: 800, epoch: 8 | loss: 0.6228811
	speed: 0.0041s/iter; left time: 0.7303s
	iters: 900, epoch: 8 | loss: 0.2851708
	speed: 0.0040s/iter; left time: 0.3193s
Updating learning rate to 4.434118159375e-06
Epoch: 8 cost time: 3.853109836578369
Epoch: 8, Steps: 979 | Train Loss: 0.6980803 Vali Loss: 0.5650047 Best vali loss: 0.5580336

best validation loss 0.5580335996427893

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.011915499154, 'e_layers': 4, 'learning_rate': 0.0022381340735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4767675
	speed: 0.0110s/iter; left time: 85.0343s
	iters: 200, epoch: 1 | loss: 0.8336952
	speed: 0.0057s/iter; left time: 43.8021s
	iters: 300, epoch: 1 | loss: 1.2566837
	speed: 0.0057s/iter; left time: 42.7699s
	iters: 400, epoch: 1 | loss: 1.2045019
	speed: 0.0062s/iter; left time: 46.3597s
	iters: 500, epoch: 1 | loss: 1.0083735
	speed: 0.0052s/iter; left time: 38.1393s
	iters: 600, epoch: 1 | loss: 0.9525319
	speed: 0.0058s/iter; left time: 42.1115s
	iters: 700, epoch: 1 | loss: 0.3836296
	speed: 0.0076s/iter; left time: 54.0993s
	iters: 800, epoch: 1 | loss: 1.4047942
	speed: 0.0071s/iter; left time: 50.2039s
	iters: 900, epoch: 1 | loss: 0.5845596
	speed: 0.0074s/iter; left time: 51.5115s
Updating learning rate to 0.002152950167511381
Validation loss decreased (inf --> 0.6506).  Saving model state dict ...
Epoch: 1 cost time: 6.4636688232421875
Epoch: 1, Steps: 979 | Train Loss: 0.9006152 Vali Loss: 0.6506117 Best vali loss: 0.6506117
	iters: 100, epoch: 2 | loss: 0.5180821
	speed: 0.0218s/iter; left time: 147.0193s
	iters: 200, epoch: 2 | loss: 0.8223746
	speed: 0.0069s/iter; left time: 46.0751s
	iters: 300, epoch: 2 | loss: 0.7177109
	speed: 0.0077s/iter; left time: 50.5681s
	iters: 400, epoch: 2 | loss: 0.7954550
	speed: 0.0072s/iter; left time: 46.2125s
	iters: 500, epoch: 2 | loss: 1.2602581
	speed: 0.0072s/iter; left time: 45.4621s
	iters: 600, epoch: 2 | loss: 0.2277930
	speed: 0.0074s/iter; left time: 46.3601s
	iters: 700, epoch: 2 | loss: 0.8565701
	speed: 0.0073s/iter; left time: 45.2036s
	iters: 800, epoch: 2 | loss: 0.8654122
	speed: 0.0078s/iter; left time: 47.3596s
	iters: 900, epoch: 2 | loss: 1.6981612
	speed: 0.0063s/iter; left time: 37.3759s
Updating learning rate to 0.0019103669270382603
Validation loss decreased (0.6506 --> 0.6489).  Saving model state dict ...
Epoch: 2 cost time: 7.018841981887817
Epoch: 2, Steps: 979 | Train Loss: 0.8624241 Vali Loss: 0.6489122 Best vali loss: 0.6489122
	iters: 100, epoch: 3 | loss: 0.7947907
	speed: 0.0164s/iter; left time: 94.5575s
	iters: 200, epoch: 3 | loss: 1.5452394
	speed: 0.0068s/iter; left time: 38.8478s
	iters: 300, epoch: 3 | loss: 2.0117335
	speed: 0.0066s/iter; left time: 36.9793s
	iters: 400, epoch: 3 | loss: 0.3240438
	speed: 0.0069s/iter; left time: 37.5184s
	iters: 500, epoch: 3 | loss: 1.1451448
	speed: 0.0059s/iter; left time: 31.5302s
	iters: 600, epoch: 3 | loss: 0.7531081
	speed: 0.0049s/iter; left time: 25.7919s
	iters: 700, epoch: 3 | loss: 0.3240615
	speed: 0.0066s/iter; left time: 34.4109s
	iters: 800, epoch: 3 | loss: 1.0550380
	speed: 0.0070s/iter; left time: 35.6628s
	iters: 900, epoch: 3 | loss: 1.6718216
	speed: 0.0070s/iter; left time: 34.9604s
Updating learning rate to 0.00154731545142012
Validation loss decreased (0.6489 --> 0.6470).  Saving model state dict ...
Epoch: 3 cost time: 6.324353933334351
Epoch: 3, Steps: 979 | Train Loss: 1.0694424 Vali Loss: 0.6470216 Best vali loss: 0.6470216

best validation loss 0.6470215514212613

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101561252832, 'e_layers': 1, 'learning_rate': 0.0020442502449, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5592591
	speed: 0.0095s/iter; left time: 73.4867s
	iters: 200, epoch: 1 | loss: 1.3100748
	speed: 0.0035s/iter; left time: 26.8254s
	iters: 300, epoch: 1 | loss: 0.8438223
	speed: 0.0037s/iter; left time: 27.8464s
	iters: 400, epoch: 1 | loss: 1.2473224
	speed: 0.0034s/iter; left time: 25.3927s
	iters: 500, epoch: 1 | loss: 0.9595205
	speed: 0.0033s/iter; left time: 24.3759s
	iters: 600, epoch: 1 | loss: 0.7795520
	speed: 0.0037s/iter; left time: 26.4665s
	iters: 700, epoch: 1 | loss: 0.2954808
	speed: 0.0033s/iter; left time: 23.7103s
	iters: 800, epoch: 1 | loss: 0.8743910
	speed: 0.0034s/iter; left time: 23.9983s
	iters: 900, epoch: 1 | loss: 1.0203736
	speed: 0.0035s/iter; left time: 23.9670s
Updating learning rate to 0.0019664456027471476
Validation loss decreased (inf --> 0.6560).  Saving model state dict ...
Epoch: 1 cost time: 3.675203561782837
Epoch: 1, Steps: 979 | Train Loss: 0.9877552 Vali Loss: 0.6559988 Best vali loss: 0.6559988
	iters: 100, epoch: 2 | loss: 0.7582354
	speed: 0.0141s/iter; left time: 94.9842s
	iters: 200, epoch: 2 | loss: 0.4163342
	speed: 0.0035s/iter; left time: 23.5817s
	iters: 300, epoch: 2 | loss: 0.7183890
	speed: 0.0035s/iter; left time: 22.8929s
	iters: 400, epoch: 2 | loss: 1.0403297
	speed: 0.0034s/iter; left time: 21.6951s
	iters: 500, epoch: 2 | loss: 1.0002104
	speed: 0.0036s/iter; left time: 23.1516s
	iters: 600, epoch: 2 | loss: 1.3810511
	speed: 0.0033s/iter; left time: 20.7331s
	iters: 700, epoch: 2 | loss: 1.1154246
	speed: 0.0034s/iter; left time: 20.8927s
	iters: 800, epoch: 2 | loss: 0.3904371
	speed: 0.0033s/iter; left time: 19.6755s
	iters: 900, epoch: 2 | loss: 1.0282172
	speed: 0.0033s/iter; left time: 19.7633s
Updating learning rate to 0.0017448767277555254
Validation loss decreased (0.6560 --> 0.6301).  Saving model state dict ...
Epoch: 2 cost time: 3.4152166843414307
Epoch: 2, Steps: 979 | Train Loss: 0.8720698 Vali Loss: 0.6300651 Best vali loss: 0.6300651
	iters: 100, epoch: 3 | loss: 0.4648416
	speed: 0.0129s/iter; left time: 74.4620s
	iters: 200, epoch: 3 | loss: 0.2818401
	speed: 0.0024s/iter; left time: 13.5301s
	iters: 300, epoch: 3 | loss: 1.6036578
	speed: 0.0024s/iter; left time: 13.6432s
	iters: 400, epoch: 3 | loss: 0.5646917
	speed: 0.0029s/iter; left time: 15.6748s
	iters: 500, epoch: 3 | loss: 0.5440316
	speed: 0.0028s/iter; left time: 15.2773s
	iters: 600, epoch: 3 | loss: 0.3299031
	speed: 0.0029s/iter; left time: 15.0568s
	iters: 700, epoch: 3 | loss: 0.4254138
	speed: 0.0029s/iter; left time: 15.0688s
	iters: 800, epoch: 3 | loss: 0.7205459
	speed: 0.0028s/iter; left time: 14.2572s
	iters: 900, epoch: 3 | loss: 0.7148312
	speed: 0.0028s/iter; left time: 13.8274s
Updating learning rate to 0.001413275472615754
Validation loss decreased (0.6301 --> 0.6217).  Saving model state dict ...
Epoch: 3 cost time: 2.705174684524536
Epoch: 3, Steps: 979 | Train Loss: 0.6277507 Vali Loss: 0.6217448 Best vali loss: 0.6217448

best validation loss 0.6217448051634457

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.000987821602, 'e_layers': 4, 'learning_rate': 0.0009965286311, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0798463
	speed: 0.0117s/iter; left time: 21.7101s
	iters: 200, epoch: 1 | loss: 0.8885712
	speed: 0.0063s/iter; left time: 11.0712s
Updating learning rate to 0.0009586005184673902
Validation loss decreased (inf --> 0.6092).  Saving model state dict ...
Epoch: 1 cost time: 1.8151164054870605
Epoch: 1, Steps: 245 | Train Loss: 0.9842087 Vali Loss: 0.6091572 Best vali loss: 0.6091572
	iters: 100, epoch: 2 | loss: 0.6311482
	speed: 0.0122s/iter; left time: 19.7039s
	iters: 200, epoch: 2 | loss: 1.0082211
	speed: 0.0064s/iter; left time: 9.6432s
Updating learning rate to 0.0008505903918986787
Validation loss decreased (0.6092 --> 0.5669).  Saving model state dict ...
Epoch: 2 cost time: 1.6117172241210938
Epoch: 2, Steps: 245 | Train Loss: 0.8196847 Vali Loss: 0.5668721 Best vali loss: 0.5668721
	iters: 100, epoch: 3 | loss: 0.4739370
	speed: 0.0125s/iter; left time: 17.0822s
	iters: 200, epoch: 3 | loss: 0.7972031
	speed: 0.0064s/iter; left time: 8.0931s
Updating learning rate to 0.0006889418140497162
Epoch: 3 cost time: 1.6196775436401367
Epoch: 3, Steps: 245 | Train Loss: 0.6355700 Vali Loss: 0.5687671 Best vali loss: 0.5668721

best validation loss 0.566872130853608

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.000987821602, 'e_layers': 4, 'learning_rate': 0.0009965286311, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9230689
	speed: 0.0127s/iter; left time: 14.3147s
	iters: 200, epoch: 4 | loss: 0.8450025
	speed: 0.0067s/iter; left time: 6.8308s
Updating learning rate to 0.00049826431555
Validation loss decreased (0.5669 --> 0.5557).  Saving model state dict ...
Epoch: 4 cost time: 1.9347574710845947
Epoch: 4, Steps: 245 | Train Loss: 0.8840357 Vali Loss: 0.5557090 Best vali loss: 0.5557090
	iters: 100, epoch: 5 | loss: 0.6001658
	speed: 0.0124s/iter; left time: 10.9196s
	iters: 200, epoch: 5 | loss: 0.7898184
	speed: 0.0064s/iter; left time: 4.9982s
Updating learning rate to 0.0003075868170502838
Validation loss decreased (0.5557 --> 0.5535).  Saving model state dict ...
Epoch: 5 cost time: 1.6178174018859863
Epoch: 5, Steps: 245 | Train Loss: 0.6949921 Vali Loss: 0.5535331 Best vali loss: 0.5535331
	iters: 100, epoch: 6 | loss: 0.4226348
	speed: 0.0123s/iter; left time: 7.8347s
	iters: 200, epoch: 6 | loss: 0.7601343
	speed: 0.0064s/iter; left time: 3.4545s
Updating learning rate to 0.0001459382392013213
Epoch: 6 cost time: 1.6326425075531006
Epoch: 6, Steps: 245 | Train Loss: 0.5913846 Vali Loss: 0.5539672 Best vali loss: 0.5535331
	iters: 100, epoch: 7 | loss: 0.6430967
	speed: 0.0125s/iter; left time: 4.8821s
	iters: 200, epoch: 7 | loss: 0.4869415
	speed: 0.0064s/iter; left time: 1.8515s
Updating learning rate to 3.792811263260974e-05
Epoch: 7 cost time: 1.6267049312591553
Epoch: 7, Steps: 245 | Train Loss: 0.5650191 Vali Loss: 0.5550194 Best vali loss: 0.5535331
	iters: 100, epoch: 8 | loss: 0.6346694
	speed: 0.0123s/iter; left time: 1.7955s
	iters: 200, epoch: 8 | loss: 0.6780642
	speed: 0.0058s/iter; left time: 0.2679s
Updating learning rate to 0.0
Validation loss decreased (0.5535 --> 0.5518).  Saving model state dict ...
Epoch: 8 cost time: 1.5244395732879639
Epoch: 8, Steps: 245 | Train Loss: 0.6563668 Vali Loss: 0.5517760 Best vali loss: 0.5517760

best validation loss 0.5517760322415017

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0030625795344, 'e_layers': 3, 'learning_rate': 0.0002327366914, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6487857
	speed: 0.0126s/iter; left time: 23.4519s
	iters: 200, epoch: 1 | loss: 0.7552498
	speed: 0.0067s/iter; left time: 11.7587s
Updating learning rate to 0.0002238786785244278
Validation loss decreased (inf --> 0.6096).  Saving model state dict ...
Epoch: 1 cost time: 1.9403064250946045
Epoch: 1, Steps: 245 | Train Loss: 0.7020178 Vali Loss: 0.6096300 Best vali loss: 0.6096300
	iters: 100, epoch: 2 | loss: 1.0465924
	speed: 0.0131s/iter; left time: 21.1392s
	iters: 200, epoch: 2 | loss: 0.9441028
	speed: 0.0066s/iter; left time: 10.0045s
Updating learning rate to 0.00019865319205993043
Validation loss decreased (0.6096 --> 0.6027).  Saving model state dict ...
Epoch: 2 cost time: 1.6740658283233643
Epoch: 2, Steps: 245 | Train Loss: 0.9953476 Vali Loss: 0.6026962 Best vali loss: 0.6026962
	iters: 100, epoch: 3 | loss: 0.5107876
	speed: 0.0130s/iter; left time: 17.7850s
	iters: 200, epoch: 3 | loss: 0.6472336
	speed: 0.0064s/iter; left time: 8.1630s
Updating learning rate to 0.00016090058365112334
Validation loss decreased (0.6027 --> 0.5887).  Saving model state dict ...
Epoch: 3 cost time: 1.6563456058502197
Epoch: 3, Steps: 245 | Train Loss: 0.5790106 Vali Loss: 0.5887337 Best vali loss: 0.5887337
	iters: 100, epoch: 4 | loss: 0.7972395
	speed: 0.0135s/iter; left time: 15.1535s
	iters: 200, epoch: 4 | loss: 0.4842211
	speed: 0.0069s/iter; left time: 7.0336s
Updating learning rate to 0.0001163683457
Validation loss decreased (0.5887 --> 0.5681).  Saving model state dict ...
Epoch: 4 cost time: 1.7255325317382812
Epoch: 4, Steps: 245 | Train Loss: 0.6407303 Vali Loss: 0.5681279 Best vali loss: 0.5681279
	iters: 100, epoch: 5 | loss: 0.7031412
	speed: 0.0135s/iter; left time: 11.8662s
	iters: 200, epoch: 5 | loss: 0.6075467
	speed: 0.0065s/iter; left time: 5.1070s
Updating learning rate to 7.183610774887667e-05
Validation loss decreased (0.5681 --> 0.5529).  Saving model state dict ...
Epoch: 5 cost time: 1.6874868869781494
Epoch: 5, Steps: 245 | Train Loss: 0.6553439 Vali Loss: 0.5528643 Best vali loss: 0.5528643
	iters: 100, epoch: 6 | loss: 0.5886756
	speed: 0.0136s/iter; left time: 8.6682s
	iters: 200, epoch: 6 | loss: 0.7914379
	speed: 0.0068s/iter; left time: 3.6648s
Updating learning rate to 3.408349934006959e-05
Epoch: 6 cost time: 1.7146832942962646
Epoch: 6, Steps: 245 | Train Loss: 0.6900567 Vali Loss: 0.5663484 Best vali loss: 0.5528643
	iters: 100, epoch: 7 | loss: 0.6868295
	speed: 0.0129s/iter; left time: 5.0267s
	iters: 200, epoch: 7 | loss: 0.5708727
	speed: 0.0069s/iter; left time: 1.9994s
Updating learning rate to 8.858012875572196e-06
Epoch: 7 cost time: 1.678006649017334
Epoch: 7, Steps: 245 | Train Loss: 0.6288511 Vali Loss: 0.5628731 Best vali loss: 0.5528643
	iters: 100, epoch: 8 | loss: 0.5038192
	speed: 0.0134s/iter; left time: 1.9614s
	iters: 200, epoch: 8 | loss: 0.7536357
	speed: 0.0069s/iter; left time: 0.3152s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7254343032836914
Epoch: 8, Steps: 245 | Train Loss: 0.6287275 Vali Loss: 0.5588655 Best vali loss: 0.5528643

best validation loss 0.5528642828819764

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0099506207971, 'e_layers': 4, 'learning_rate': 0.0041237779005, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1150185
	speed: 0.0131s/iter; left time: 11.6313s
Updating learning rate to 0.0041237779005
Validation loss decreased (inf --> 0.6850).  Saving model state dict ...
Epoch: 1 cost time: 1.1741161346435547
Epoch: 1, Steps: 123 | Train Loss: 1.1150185 Vali Loss: 0.6849804 Best vali loss: 0.6849804
	iters: 100, epoch: 2 | loss: 0.7002283
	speed: 0.0116s/iter; left time: 8.8244s
Updating learning rate to 0.00206188895025
Validation loss decreased (0.6850 --> 0.6491).  Saving model state dict ...
Epoch: 2 cost time: 1.0481665134429932
Epoch: 2, Steps: 123 | Train Loss: 0.7002283 Vali Loss: 0.6490710 Best vali loss: 0.6490710
	iters: 100, epoch: 3 | loss: 1.0564770
	speed: 0.0138s/iter; left time: 8.8217s
Updating learning rate to 0.001030944475125
Validation loss decreased (0.6491 --> 0.6427).  Saving model state dict ...
Epoch: 3 cost time: 1.099832534790039
Epoch: 3, Steps: 123 | Train Loss: 1.0564770 Vali Loss: 0.6426733 Best vali loss: 0.6426733
	iters: 100, epoch: 4 | loss: 0.8497345
	speed: 0.0134s/iter; left time: 6.9154s
Updating learning rate to 0.0005154722375625
Epoch: 4 cost time: 1.0551271438598633
Epoch: 4, Steps: 123 | Train Loss: 0.8497345 Vali Loss: 0.6457200 Best vali loss: 0.6426733
	iters: 100, epoch: 5 | loss: 0.7934653
	speed: 0.0131s/iter; left time: 5.1449s
Updating learning rate to 0.00025773611878125
Epoch: 5 cost time: 1.0751633644104004
Epoch: 5, Steps: 123 | Train Loss: 0.7934653 Vali Loss: 0.6437580 Best vali loss: 0.6426733
	iters: 100, epoch: 6 | loss: 1.0219073
	speed: 0.0134s/iter; left time: 3.6214s
Updating learning rate to 0.000128868059390625
Epoch: 6 cost time: 1.0736315250396729
Epoch: 6, Steps: 123 | Train Loss: 1.0219073 Vali Loss: 0.6453779 Best vali loss: 0.6426733
	iters: 100, epoch: 7 | loss: 1.0090461
	speed: 0.0126s/iter; left time: 1.8499s
Updating learning rate to 6.44340296953125e-05
Epoch: 7 cost time: 1.0020122528076172
Epoch: 7, Steps: 123 | Train Loss: 1.0090461 Vali Loss: 0.6442682 Best vali loss: 0.6426733
	iters: 100, epoch: 8 | loss: 0.6804107
	speed: 0.0108s/iter; left time: 0.2581s
Updating learning rate to 3.221701484765625e-05
Epoch: 8 cost time: 0.8656332492828369
Epoch: 8, Steps: 123 | Train Loss: 0.6804107 Vali Loss: 0.6442967 Best vali loss: 0.6426733

best validation loss 0.642673325367627

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0033532746374, 'e_layers': 3, 'learning_rate': 0.0001820777857, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8003684
	speed: 0.0115s/iter; left time: 10.1605s
Updating learning rate to 0.0001820777857
Validation loss decreased (inf --> 0.6049).  Saving model state dict ...
Epoch: 1 cost time: 0.9970459938049316
Epoch: 1, Steps: 123 | Train Loss: 0.8003684 Vali Loss: 0.6048925 Best vali loss: 0.6048925
	iters: 100, epoch: 2 | loss: 0.8798010
	speed: 0.0093s/iter; left time: 7.0652s
Updating learning rate to 9.103889285e-05
Validation loss decreased (0.6049 --> 0.5914).  Saving model state dict ...
Epoch: 2 cost time: 0.7562921047210693
Epoch: 2, Steps: 123 | Train Loss: 0.8798010 Vali Loss: 0.5913688 Best vali loss: 0.5913688
	iters: 100, epoch: 3 | loss: 0.8033206
	speed: 0.0097s/iter; left time: 6.1792s
Updating learning rate to 4.5519446425e-05
Validation loss decreased (0.5914 --> 0.5881).  Saving model state dict ...
Epoch: 3 cost time: 0.7820236682891846
Epoch: 3, Steps: 123 | Train Loss: 0.8033206 Vali Loss: 0.5881381 Best vali loss: 0.5881381

best validation loss 0.5881380858602263

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038698826022, 'e_layers': 4, 'learning_rate': 0.0004004528328, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004004528328
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 0.8097763061523438
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6035497 Best vali loss: 0.6035497
Updating learning rate to 0.0002002264164
Validation loss decreased (0.6035 --> 0.6015).  Saving model state dict ...
Epoch: 2 cost time: 0.5732405185699463
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6015382 Best vali loss: 0.6015382
Updating learning rate to 0.0001001132082
Validation loss decreased (0.6015 --> 0.5986).  Saving model state dict ...
Epoch: 3 cost time: 0.5689582824707031
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5986210 Best vali loss: 0.5986210

best validation loss 0.5986209604432328

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004191723262, 'e_layers': 3, 'learning_rate': 0.0043478566088, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0043478566088
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 0.7259840965270996
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6047915 Best vali loss: 0.6047915
Updating learning rate to 0.0021739283044
Epoch: 2 cost time: 0.4890024662017822
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6104550 Best vali loss: 0.6047915
Updating learning rate to 0.0010869641522
Epoch: 3 cost time: 0.4970710277557373
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6307442 Best vali loss: 0.6047915

best validation loss 0.604791475219453

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0033532746374, 'e_layers': 3, 'learning_rate': 0.0001820777857, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7378149
	speed: 0.0119s/iter; left time: 6.1569s
Updating learning rate to 2.27597232125e-05
Validation loss decreased (0.5881 --> 0.5747).  Saving model state dict ...
Epoch: 4 cost time: 1.031665563583374
Epoch: 4, Steps: 123 | Train Loss: 0.7378149 Vali Loss: 0.5747200 Best vali loss: 0.5747200
	iters: 100, epoch: 5 | loss: 0.8224564
	speed: 0.0095s/iter; left time: 3.7357s
Updating learning rate to 1.137986160625e-05
Validation loss decreased (0.5747 --> 0.5730).  Saving model state dict ...
Epoch: 5 cost time: 0.7687103748321533
Epoch: 5, Steps: 123 | Train Loss: 0.8224564 Vali Loss: 0.5730168 Best vali loss: 0.5730168
	iters: 100, epoch: 6 | loss: 0.7645551
	speed: 0.0096s/iter; left time: 2.5786s
Updating learning rate to 5.689930803125e-06
Validation loss decreased (0.5730 --> 0.5724).  Saving model state dict ...
Epoch: 6 cost time: 0.7492213249206543
Epoch: 6, Steps: 123 | Train Loss: 0.7645551 Vali Loss: 0.5724344 Best vali loss: 0.5724344
	iters: 100, epoch: 7 | loss: 0.7491445
	speed: 0.0093s/iter; left time: 1.3647s
Updating learning rate to 2.8449654015625e-06
Epoch: 7 cost time: 0.7454135417938232
Epoch: 7, Steps: 123 | Train Loss: 0.7491445 Vali Loss: 0.5751945 Best vali loss: 0.5724344
	iters: 100, epoch: 8 | loss: 0.8640870
	speed: 0.0098s/iter; left time: 0.2346s
Updating learning rate to 1.42248270078125e-06
Epoch: 8 cost time: 0.820512056350708
Epoch: 8, Steps: 123 | Train Loss: 0.8640870 Vali Loss: 0.5734895 Best vali loss: 0.5724344

best validation loss 0.5724343757891975

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 1, 'learning_rate': 6.59648622e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.345422412575373e-05
Validation loss decreased (inf --> 0.7000).  Saving model state dict ...
Epoch: 1 cost time: 0.6432230472564697
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6999600 Best vali loss: 0.6999600
Updating learning rate to 5.630453179082808e-05
Validation loss decreased (0.7000 --> 0.6863).  Saving model state dict ...
Epoch: 2 cost time: 0.44717979431152344
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6862845 Best vali loss: 0.6862845
Updating learning rate to 4.5604261041093085e-05
Validation loss decreased (0.6863 --> 0.6749).  Saving model state dict ...
Epoch: 3 cost time: 0.39711713790893555
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6748857 Best vali loss: 0.6748857
Updating learning rate to 3.29824311e-05
Validation loss decreased (0.6749 --> 0.6667).  Saving model state dict ...
Epoch: 4 cost time: 0.41458892822265625
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6666832 Best vali loss: 0.6666832
Updating learning rate to 2.0360601158906917e-05
Validation loss decreased (0.6667 --> 0.6608).  Saving model state dict ...
Epoch: 5 cost time: 0.4409928321838379
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6608096 Best vali loss: 0.6608096
Updating learning rate to 9.660330409171922e-06
Validation loss decreased (0.6608 --> 0.6574).  Saving model state dict ...
Epoch: 6 cost time: 0.4136936664581299
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6573912 Best vali loss: 0.6573912
Updating learning rate to 2.5106380742462752e-06
Validation loss decreased (0.6574 --> 0.6559).  Saving model state dict ...
Epoch: 7 cost time: 0.43387794494628906
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6558595 Best vali loss: 0.6558595
Updating learning rate to 0.0
Validation loss decreased (0.6559 --> 0.6554).  Saving model state dict ...
Epoch: 8 cost time: 0.44263195991516113
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6554471 Best vali loss: 0.6554471

best validation loss 0.6554471120852003

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0021078822862, 'e_layers': 1, 'learning_rate': 0.0019637021813, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019637021813
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 0.6343729496002197
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6102874 Best vali loss: 0.6102874
Updating learning rate to 0.00098185109065
Epoch: 2 cost time: 0.42342090606689453
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6120875 Best vali loss: 0.6102874
Updating learning rate to 0.000490925545325
Validation loss decreased (0.6103 --> 0.6047).  Saving model state dict ...
Epoch: 3 cost time: 0.4110531806945801
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6047054 Best vali loss: 0.6047054
Updating learning rate to 0.0002454627726625
Validation loss decreased (0.6047 --> 0.6032).  Saving model state dict ...
Epoch: 4 cost time: 0.40857958793640137
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6032222 Best vali loss: 0.6032222
Updating learning rate to 0.00012273138633125
Epoch: 5 cost time: 0.4130887985229492
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6038880 Best vali loss: 0.6032222
Updating learning rate to 6.1365693165625e-05
Epoch: 6 cost time: 0.43244504928588867
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6034119 Best vali loss: 0.6032222
Updating learning rate to 3.06828465828125e-05
Epoch: 7 cost time: 0.4309725761413574
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6037359 Best vali loss: 0.6032222
Updating learning rate to 1.534142329140625e-05
Epoch: 8 cost time: 0.41927242279052734
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6042037 Best vali loss: 0.6032222

best validation loss 0.6032221684958967

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0070498653705, 'e_layers': 4, 'learning_rate': 6.58625109e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.58625109e-05
Validation loss decreased (inf --> 0.6329).  Saving model state dict ...
Epoch: 1 cost time: 0.8426938056945801
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6328929 Best vali loss: 0.6328929
Updating learning rate to 3.293125545e-05
Validation loss decreased (0.6329 --> 0.6146).  Saving model state dict ...
Epoch: 2 cost time: 0.6084566116333008
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6146096 Best vali loss: 0.6146096
Updating learning rate to 1.6465627725e-05
Validation loss decreased (0.6146 --> 0.6098).  Saving model state dict ...
Epoch: 3 cost time: 0.6015441417694092
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6098318 Best vali loss: 0.6098318

best validation loss 0.6098317754925098

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3083493
	speed: 0.0107s/iter; left time: 41.0504s
	iters: 200, epoch: 1 | loss: 0.9386579
	speed: 0.0049s/iter; left time: 18.3572s
	iters: 300, epoch: 1 | loss: 1.2741475
	speed: 0.0050s/iter; left time: 17.9523s
	iters: 400, epoch: 1 | loss: 0.9382687
	speed: 0.0053s/iter; left time: 18.5259s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 2.8100173473358154
Epoch: 1, Steps: 490 | Train Loss: 1.1148558 Vali Loss: 0.6069639 Best vali loss: 0.6069639
	iters: 100, epoch: 2 | loss: 0.7811506
	speed: 0.0149s/iter; left time: 49.4991s
	iters: 200, epoch: 2 | loss: 0.5249420
	speed: 0.0056s/iter; left time: 18.2086s
	iters: 300, epoch: 2 | loss: 0.5953794
	speed: 0.0055s/iter; left time: 17.2592s
	iters: 400, epoch: 2 | loss: 0.8552725
	speed: 0.0056s/iter; left time: 17.0235s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 2.7818918228149414
Epoch: 2, Steps: 490 | Train Loss: 0.6891861 Vali Loss: 0.6137047 Best vali loss: 0.6069639
	iters: 100, epoch: 3 | loss: 0.7396813
	speed: 0.0133s/iter; left time: 37.8545s
	iters: 200, epoch: 3 | loss: 1.6044713
	speed: 0.0046s/iter; left time: 12.5241s
	iters: 300, epoch: 3 | loss: 0.7234709
	speed: 0.0053s/iter; left time: 13.8851s
	iters: 400, epoch: 3 | loss: 0.9004278
	speed: 0.0052s/iter; left time: 13.2773s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 2.4436750411987305
Epoch: 3, Steps: 490 | Train Loss: 0.9920128 Vali Loss: 0.6121731 Best vali loss: 0.6069639

best validation loss 0.6069639357412816

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.6124).  Saving model state dict ...
Epoch: 1 cost time: 0.7293369770050049
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6124285 Best vali loss: 0.6124285
Updating learning rate to 0.000252166657013118
Epoch: 2 cost time: 0.5121092796325684
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6155976 Best vali loss: 0.6124285
Updating learning rate to 0.0002042442000052176
Validation loss decreased (0.6124 --> 0.6093).  Saving model state dict ...
Epoch: 3 cost time: 0.49303483963012695
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6093320 Best vali loss: 0.6093320

best validation loss 0.609332032305176

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.2771760
	speed: 0.0110s/iter; left time: 25.9178s
	iters: 200, epoch: 4 | loss: 0.7412350
	speed: 0.0053s/iter; left time: 11.9451s
	iters: 300, epoch: 4 | loss: 0.8361376
	speed: 0.0057s/iter; left time: 12.2594s
	iters: 400, epoch: 4 | loss: 0.9141704
	speed: 0.0061s/iter; left time: 12.5276s
Updating learning rate to 7.69341037125e-05
Epoch: 4 cost time: 3.054955005645752
Epoch: 4, Steps: 490 | Train Loss: 0.9421798 Vali Loss: 0.6116358 Best vali loss: 0.6069639
	iters: 100, epoch: 5 | loss: 0.6759325
	speed: 0.0148s/iter; left time: 27.5594s
	iters: 200, epoch: 5 | loss: 0.5233740
	speed: 0.0052s/iter; left time: 9.2377s
	iters: 300, epoch: 5 | loss: 0.5760133
	speed: 0.0052s/iter; left time: 8.6337s
	iters: 400, epoch: 5 | loss: 0.8318262
	speed: 0.0052s/iter; left time: 8.1903s
Updating learning rate to 3.846705185625e-05
Epoch: 5 cost time: 2.6094484329223633
Epoch: 5, Steps: 490 | Train Loss: 0.6517865 Vali Loss: 0.6210181 Best vali loss: 0.6069639
	iters: 100, epoch: 6 | loss: 0.7309130
	speed: 0.0143s/iter; left time: 19.5603s
	iters: 200, epoch: 6 | loss: 1.4264710
	speed: 0.0053s/iter; left time: 6.7451s
	iters: 300, epoch: 6 | loss: 0.7075887
	speed: 0.0050s/iter; left time: 5.8119s
	iters: 400, epoch: 6 | loss: 0.9018065
	speed: 0.0049s/iter; left time: 5.2586s
Updating learning rate to 1.9233525928125e-05
Epoch: 6 cost time: 2.5853042602539062
Epoch: 6, Steps: 490 | Train Loss: 0.9416948 Vali Loss: 0.6162939 Best vali loss: 0.6069639
	iters: 100, epoch: 7 | loss: 0.9340022
	speed: 0.0147s/iter; left time: 12.9219s
	iters: 200, epoch: 7 | loss: 1.1519976
	speed: 0.0052s/iter; left time: 4.0848s
	iters: 300, epoch: 7 | loss: 0.7540017
	speed: 0.0056s/iter; left time: 3.8069s
	iters: 400, epoch: 7 | loss: 0.5132381
	speed: 0.0060s/iter; left time: 3.5091s
Updating learning rate to 9.6167629640625e-06
Epoch: 7 cost time: 2.8092777729034424
Epoch: 7, Steps: 490 | Train Loss: 0.8383099 Vali Loss: 0.6124611 Best vali loss: 0.6069639
	iters: 100, epoch: 8 | loss: 1.3625714
	speed: 0.0149s/iter; left time: 5.8366s
	iters: 200, epoch: 8 | loss: 0.4315185
	speed: 0.0052s/iter; left time: 1.4992s
	iters: 300, epoch: 8 | loss: 0.9178007
	speed: 0.0056s/iter; left time: 1.0609s
	iters: 400, epoch: 8 | loss: 1.3841425
	speed: 0.0053s/iter; left time: 0.4819s
Updating learning rate to 4.80838148203125e-06
Epoch: 8 cost time: 2.6182854175567627
Epoch: 8, Steps: 490 | Train Loss: 1.0240083 Vali Loss: 0.6142654 Best vali loss: 0.6069639

best validation loss 0.6069639357412816

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012126761903, 'e_layers': 1, 'learning_rate': 0.0006771784349, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9480849
	speed: 0.0091s/iter; left time: 16.8460s
	iters: 200, epoch: 1 | loss: 0.7405266
	speed: 0.0033s/iter; left time: 5.7831s
Updating learning rate to 0.0006514048653810684
Validation loss decreased (inf --> 0.5976).  Saving model state dict ...
Epoch: 1 cost time: 1.084427833557129
Epoch: 1, Steps: 245 | Train Loss: 0.8443057 Vali Loss: 0.5975599 Best vali loss: 0.5975599
	iters: 100, epoch: 2 | loss: 0.9849113
	speed: 0.0074s/iter; left time: 11.9473s
	iters: 200, epoch: 2 | loss: 0.8246601
	speed: 0.0033s/iter; left time: 5.0131s
Updating learning rate to 0.0005780079491455414
Epoch: 2 cost time: 0.859138011932373
Epoch: 2, Steps: 245 | Train Loss: 0.9047857 Vali Loss: 0.6072978 Best vali loss: 0.5975599
	iters: 100, epoch: 3 | loss: 1.0101740
	speed: 0.0078s/iter; left time: 10.7595s
	iters: 200, epoch: 3 | loss: 0.7817953
	speed: 0.0036s/iter; left time: 4.5682s
Updating learning rate to 0.0004681617013455758
Epoch: 3 cost time: 0.9365880489349365
Epoch: 3, Steps: 245 | Train Loss: 0.8959847 Vali Loss: 0.6254921 Best vali loss: 0.5975599
	iters: 100, epoch: 4 | loss: 0.7464394
	speed: 0.0076s/iter; left time: 8.5482s
	iters: 200, epoch: 4 | loss: 0.8292165
	speed: 0.0034s/iter; left time: 3.4670s
Updating learning rate to 0.00033858921745
Epoch: 4 cost time: 0.8833379745483398
Epoch: 4, Steps: 245 | Train Loss: 0.7878279 Vali Loss: 0.6241515 Best vali loss: 0.5975599
	iters: 100, epoch: 5 | loss: 0.8404058
	speed: 0.0076s/iter; left time: 6.7298s
	iters: 200, epoch: 5 | loss: 0.9506155
	speed: 0.0034s/iter; left time: 2.6648s
Updating learning rate to 0.00020901673355442425
Epoch: 5 cost time: 0.9056050777435303
Epoch: 5, Steps: 245 | Train Loss: 0.8955106 Vali Loss: 0.6361328 Best vali loss: 0.5975599
	iters: 100, epoch: 6 | loss: 0.7192569
	speed: 0.0078s/iter; left time: 4.9326s
	iters: 200, epoch: 6 | loss: 0.4634170
	speed: 0.0034s/iter; left time: 1.8215s
Updating learning rate to 9.917048575445851e-05
Epoch: 6 cost time: 0.8713147640228271
Epoch: 6, Steps: 245 | Train Loss: 0.5913370 Vali Loss: 0.6487640 Best vali loss: 0.5975599
	iters: 100, epoch: 7 | loss: 0.4714348
	speed: 0.0073s/iter; left time: 2.8639s
	iters: 200, epoch: 7 | loss: 0.7964283
	speed: 0.0033s/iter; left time: 0.9579s
Updating learning rate to 2.577356951893159e-05
Epoch: 7 cost time: 0.8537395000457764
Epoch: 7, Steps: 245 | Train Loss: 0.6339316 Vali Loss: 0.6619682 Best vali loss: 0.5975599
	iters: 100, epoch: 8 | loss: 0.7469719
	speed: 0.0072s/iter; left time: 1.0549s
	iters: 200, epoch: 8 | loss: 0.4568225
	speed: 0.0033s/iter; left time: 0.1530s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8632910251617432
Epoch: 8, Steps: 245 | Train Loss: 0.6018972 Vali Loss: 0.6620507 Best vali loss: 0.5975599

best validation loss 0.5975599481186785

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066567632481, 'e_layers': 3, 'learning_rate': 0.002104042691, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0861840
	speed: 0.0108s/iter; left time: 20.0084s
	iters: 200, epoch: 1 | loss: 0.8873878
	speed: 0.0053s/iter; left time: 9.4041s
Updating learning rate to 0.0020239623343724345
Validation loss decreased (inf --> 0.6132).  Saving model state dict ...
Epoch: 1 cost time: 1.5866966247558594
Epoch: 1, Steps: 245 | Train Loss: 0.9867859 Vali Loss: 0.6132047 Best vali loss: 0.6132047
	iters: 100, epoch: 2 | loss: 0.8847907
	speed: 0.0098s/iter; left time: 15.8453s
	iters: 200, epoch: 2 | loss: 0.5602208
	speed: 0.0046s/iter; left time: 6.9748s
Updating learning rate to 0.0017959127728560456
Validation loss decreased (0.6132 --> 0.6045).  Saving model state dict ...
Epoch: 2 cost time: 1.2197906970977783
Epoch: 2, Steps: 245 | Train Loss: 0.7225057 Vali Loss: 0.6045487 Best vali loss: 0.6045487
	iters: 100, epoch: 3 | loss: 0.8692464
	speed: 0.0128s/iter; left time: 17.5155s
	iters: 200, epoch: 3 | loss: 0.8471642
	speed: 0.0066s/iter; left time: 8.4145s
Updating learning rate to 0.00145461248491728
Epoch: 3 cost time: 1.6730608940124512
Epoch: 3, Steps: 245 | Train Loss: 0.8582053 Vali Loss: 0.6445626 Best vali loss: 0.6045487
	iters: 100, epoch: 4 | loss: 0.9165031
	speed: 0.0130s/iter; left time: 14.6126s
	iters: 200, epoch: 4 | loss: 0.5479286
	speed: 0.0068s/iter; left time: 6.9818s
Updating learning rate to 0.0010520213455
Epoch: 4 cost time: 1.6820423603057861
Epoch: 4, Steps: 245 | Train Loss: 0.7322159 Vali Loss: 0.6691975 Best vali loss: 0.6045487
	iters: 100, epoch: 5 | loss: 0.7126901
	speed: 0.0128s/iter; left time: 11.2441s
	iters: 200, epoch: 5 | loss: 0.8589440
	speed: 0.0067s/iter; left time: 5.2348s
Updating learning rate to 0.00064943020608272
Epoch: 5 cost time: 1.6930866241455078
Epoch: 5, Steps: 245 | Train Loss: 0.7858171 Vali Loss: 0.6163621 Best vali loss: 0.6045487
	iters: 100, epoch: 6 | loss: 0.8290842
	speed: 0.0117s/iter; left time: 7.4691s
	iters: 200, epoch: 6 | loss: 1.1479323
	speed: 0.0053s/iter; left time: 2.8506s
Updating learning rate to 0.00030812991814395423
Epoch: 6 cost time: 1.3721733093261719
Epoch: 6, Steps: 245 | Train Loss: 0.9885082 Vali Loss: 0.6419080 Best vali loss: 0.6045487
	iters: 100, epoch: 7 | loss: 0.4588635
	speed: 0.0133s/iter; left time: 5.2112s
	iters: 200, epoch: 7 | loss: 0.6304595
	speed: 0.0065s/iter; left time: 1.9017s
Updating learning rate to 8.008035662756513e-05
Epoch: 7 cost time: 1.6639821529388428
Epoch: 7, Steps: 245 | Train Loss: 0.5446615 Vali Loss: 0.6489604 Best vali loss: 0.6045487
	iters: 100, epoch: 8 | loss: 0.6666331
	speed: 0.0134s/iter; left time: 1.9546s
	iters: 200, epoch: 8 | loss: 0.6994219
	speed: 0.0065s/iter; left time: 0.2990s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6528327465057373
Epoch: 8, Steps: 245 | Train Loss: 0.6830275 Vali Loss: 0.6466347 Best vali loss: 0.6045487

best validation loss 0.6045487341865352

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0034282770657, 'e_layers': 2, 'learning_rate': 0.0002535480338, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0685930
	speed: 0.0126s/iter; left time: 11.1146s
Updating learning rate to 0.00024389793636814995
Validation loss decreased (inf --> 0.6567).  Saving model state dict ...
Epoch: 1 cost time: 1.139723539352417
Epoch: 1, Steps: 123 | Train Loss: 1.0685930 Vali Loss: 0.6566737 Best vali loss: 0.6566737
	iters: 100, epoch: 2 | loss: 0.8325974
	speed: 0.0110s/iter; left time: 8.4030s
Updating learning rate to 0.00021641678392824796
Validation loss decreased (0.6567 --> 0.6313).  Saving model state dict ...
Epoch: 2 cost time: 0.8812813758850098
Epoch: 2, Steps: 123 | Train Loss: 0.8325974 Vali Loss: 0.6312733 Best vali loss: 0.6312733
	iters: 100, epoch: 3 | loss: 0.9622644
	speed: 0.0107s/iter; left time: 6.8523s
Updating learning rate to 0.0001752883328220019
Validation loss decreased (0.6313 --> 0.6238).  Saving model state dict ...
Epoch: 3 cost time: 0.8248906135559082
Epoch: 3, Steps: 123 | Train Loss: 0.9622644 Vali Loss: 0.6238232 Best vali loss: 0.6238232

best validation loss 0.6238231807602385

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0046642077899, 'e_layers': 3, 'learning_rate': 0.0046118283421, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0046118283421
Validation loss decreased (inf --> 0.6180).  Saving model state dict ...
Epoch: 1 cost time: 0.8538095951080322
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6180191 Best vali loss: 0.6180191
Updating learning rate to 0.00230591417105
Epoch: 2 cost time: 0.4778635501861572
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6416233 Best vali loss: 0.6180191
Updating learning rate to 0.001152957085525
Epoch: 3 cost time: 0.47771358489990234
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6213564 Best vali loss: 0.6180191

best validation loss 0.6180191343440771

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001706392447, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2427280
	speed: 0.0124s/iter; left time: 23.1314s
	iters: 200, epoch: 1 | loss: 0.5884348
	speed: 0.0070s/iter; left time: 12.2606s
Updating learning rate to 0.00016414467516075753
Validation loss decreased (inf --> 0.6224).  Saving model state dict ...
Epoch: 1 cost time: 1.9913039207458496
Epoch: 1, Steps: 245 | Train Loss: 0.9155814 Vali Loss: 0.6224016 Best vali loss: 0.6224016
	iters: 100, epoch: 2 | loss: 0.6726809
	speed: 0.0137s/iter; left time: 22.1408s
	iters: 200, epoch: 2 | loss: 0.6853598
	speed: 0.0070s/iter; left time: 10.6651s
Updating learning rate to 0.0001456497058819603
Validation loss decreased (0.6224 --> 0.6129).  Saving model state dict ...
Epoch: 2 cost time: 1.744981050491333
Epoch: 2, Steps: 245 | Train Loss: 0.6790203 Vali Loss: 0.6128621 Best vali loss: 0.6128621
	iters: 100, epoch: 3 | loss: 0.7963882
	speed: 0.0136s/iter; left time: 18.6236s
	iters: 200, epoch: 3 | loss: 0.7505234
	speed: 0.0070s/iter; left time: 8.9084s
Updating learning rate to 0.00011797002827899123
Validation loss decreased (0.6129 --> 0.6088).  Saving model state dict ...
Epoch: 3 cost time: 1.7314131259918213
Epoch: 3, Steps: 245 | Train Loss: 0.7734558 Vali Loss: 0.6088342 Best vali loss: 0.6088342

best validation loss 0.6088341549831868

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001706392447, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1272697
	speed: 0.0133s/iter; left time: 14.9407s
	iters: 200, epoch: 4 | loss: 0.5623521
	speed: 0.0070s/iter; left time: 7.1358s
Updating learning rate to 8.531962235e-05
Epoch: 4 cost time: 2.0272181034088135
Epoch: 4, Steps: 245 | Train Loss: 0.8448109 Vali Loss: 0.6088698 Best vali loss: 0.6088342
	iters: 100, epoch: 5 | loss: 0.6598960
	speed: 0.0140s/iter; left time: 12.3427s
	iters: 200, epoch: 5 | loss: 0.6624776
	speed: 0.0069s/iter; left time: 5.3820s
Updating learning rate to 5.266921642100878e-05
Epoch: 5 cost time: 1.7704918384552002
Epoch: 5, Steps: 245 | Train Loss: 0.6611868 Vali Loss: 0.6167118 Best vali loss: 0.6088342
	iters: 100, epoch: 6 | loss: 0.7067906
	speed: 0.0139s/iter; left time: 8.8594s
	iters: 200, epoch: 6 | loss: 0.7442310
	speed: 0.0069s/iter; left time: 3.7193s
Updating learning rate to 2.4989538818039686e-05
Validation loss decreased (0.6088 --> 0.6076).  Saving model state dict ...
Epoch: 6 cost time: 1.766772747039795
Epoch: 6, Steps: 245 | Train Loss: 0.7255108 Vali Loss: 0.6076072 Best vali loss: 0.6076072
	iters: 100, epoch: 7 | loss: 0.6087858
	speed: 0.0140s/iter; left time: 5.4741s
	iters: 200, epoch: 7 | loss: 0.8058108
	speed: 0.0069s/iter; left time: 2.0133s
Updating learning rate to 6.4945695392424685e-06
Validation loss decreased (0.6076 --> 0.6074).  Saving model state dict ...
Epoch: 7 cost time: 1.7653250694274902
Epoch: 7, Steps: 245 | Train Loss: 0.7072983 Vali Loss: 0.6074391 Best vali loss: 0.6074391
	iters: 100, epoch: 8 | loss: 0.6716912
	speed: 0.0121s/iter; left time: 1.7670s
	iters: 200, epoch: 8 | loss: 1.1134728
	speed: 0.0061s/iter; left time: 0.2822s
Updating learning rate to 0.0
Validation loss decreased (0.6074 --> 0.6072).  Saving model state dict ...
Epoch: 8 cost time: 1.5504052639007568
Epoch: 8, Steps: 245 | Train Loss: 0.8925820 Vali Loss: 0.6071712 Best vali loss: 0.6071712

best validation loss 0.6071711654246047

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0026209986474, 'e_layers': 4, 'learning_rate': 8.46744742e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9158426
	speed: 0.0150s/iter; left time: 13.2479s
Updating learning rate to 8.46744742e-05
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 1.4358088970184326
Epoch: 1, Steps: 123 | Train Loss: 0.9158426 Vali Loss: 0.6093642 Best vali loss: 0.6093642
	iters: 100, epoch: 2 | loss: 0.8483521
	speed: 0.0142s/iter; left time: 10.7848s
Updating learning rate to 4.23372371e-05
Validation loss decreased (0.6094 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 1.1604416370391846
Epoch: 2, Steps: 123 | Train Loss: 0.8483521 Vali Loss: 0.6048476 Best vali loss: 0.6048476
	iters: 100, epoch: 3 | loss: 0.8719288
	speed: 0.0141s/iter; left time: 8.9916s
Updating learning rate to 2.116861855e-05
Validation loss decreased (0.6048 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 1.150148630142212
Epoch: 3, Steps: 123 | Train Loss: 0.8719288 Vali Loss: 0.6030954 Best vali loss: 0.6030954
	iters: 100, epoch: 4 | loss: 0.7049647
	speed: 0.0140s/iter; left time: 7.2287s
Updating learning rate to 1.0584309275e-05
Validation loss decreased (0.6031 --> 0.5980).  Saving model state dict ...
Epoch: 4 cost time: 1.1509687900543213
Epoch: 4, Steps: 123 | Train Loss: 0.7049647 Vali Loss: 0.5980342 Best vali loss: 0.5980342
	iters: 100, epoch: 5 | loss: 0.9177024
	speed: 0.0144s/iter; left time: 5.6606s
Updating learning rate to 5.2921546375e-06
Validation loss decreased (0.5980 --> 0.5958).  Saving model state dict ...
Epoch: 5 cost time: 1.165149211883545
Epoch: 5, Steps: 123 | Train Loss: 0.9177024 Vali Loss: 0.5958089 Best vali loss: 0.5958089
	iters: 100, epoch: 6 | loss: 0.8155666
	speed: 0.0143s/iter; left time: 3.8481s
Updating learning rate to 2.64607731875e-06
Epoch: 6 cost time: 1.1560235023498535
Epoch: 6, Steps: 123 | Train Loss: 0.8155666 Vali Loss: 0.5970852 Best vali loss: 0.5958089
	iters: 100, epoch: 7 | loss: 0.9737228
	speed: 0.0131s/iter; left time: 1.9320s
Updating learning rate to 1.323038659375e-06
Epoch: 7 cost time: 1.0319523811340332
Epoch: 7, Steps: 123 | Train Loss: 0.9737228 Vali Loss: 0.5959590 Best vali loss: 0.5958089
	iters: 100, epoch: 8 | loss: 0.7867498
	speed: 0.0110s/iter; left time: 0.2646s
Updating learning rate to 6.615193296875e-07
Validation loss decreased (0.5958 --> 0.5956).  Saving model state dict ...
Epoch: 8 cost time: 0.9819536209106445
Epoch: 8, Steps: 123 | Train Loss: 0.7867498 Vali Loss: 0.5956485 Best vali loss: 0.5956485

best validation loss 0.5956484973844363

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0083025866439, 'e_layers': 3, 'learning_rate': 0.0007704396347, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7620972
	speed: 0.0127s/iter; left time: 11.2691s
Updating learning rate to 0.0007704396347
Validation loss decreased (inf --> 0.6237).  Saving model state dict ...
Epoch: 1 cost time: 1.177898645401001
Epoch: 1, Steps: 123 | Train Loss: 0.7620972 Vali Loss: 0.6236571 Best vali loss: 0.6236571
	iters: 100, epoch: 2 | loss: 1.0811585
	speed: 0.0113s/iter; left time: 8.6081s
Updating learning rate to 0.00038521981735
Validation loss decreased (0.6237 --> 0.6058).  Saving model state dict ...
Epoch: 2 cost time: 0.8277034759521484
Epoch: 2, Steps: 123 | Train Loss: 1.0811585 Vali Loss: 0.6058387 Best vali loss: 0.6058387
	iters: 100, epoch: 3 | loss: 0.6521167
	speed: 0.0092s/iter; left time: 5.9085s
Updating learning rate to 0.000192609908675
Epoch: 3 cost time: 0.8189153671264648
Epoch: 3, Steps: 123 | Train Loss: 0.6521167 Vali Loss: 0.6090013 Best vali loss: 0.6058387
	iters: 100, epoch: 4 | loss: 0.9008738
	speed: 0.0125s/iter; left time: 6.4461s
Updating learning rate to 9.63049543375e-05
Epoch: 4 cost time: 0.991811990737915
Epoch: 4, Steps: 123 | Train Loss: 0.9008738 Vali Loss: 0.6084886 Best vali loss: 0.6058387
	iters: 100, epoch: 5 | loss: 0.6740602
	speed: 0.0111s/iter; left time: 4.3716s
Updating learning rate to 4.815247716875e-05
Validation loss decreased (0.6058 --> 0.6043).  Saving model state dict ...
Epoch: 5 cost time: 0.8299691677093506
Epoch: 5, Steps: 123 | Train Loss: 0.6740602 Vali Loss: 0.6043277 Best vali loss: 0.6043277
	iters: 100, epoch: 6 | loss: 1.0166101
	speed: 0.0093s/iter; left time: 2.5241s
Updating learning rate to 2.4076238584375e-05
Epoch: 6 cost time: 0.8334813117980957
Epoch: 6, Steps: 123 | Train Loss: 1.0166101 Vali Loss: 0.6074272 Best vali loss: 0.6043277
	iters: 100, epoch: 7 | loss: 0.7042637
	speed: 0.0124s/iter; left time: 1.8217s
Updating learning rate to 1.20381192921875e-05
Epoch: 7 cost time: 0.9989495277404785
Epoch: 7, Steps: 123 | Train Loss: 0.7042637 Vali Loss: 0.6072110 Best vali loss: 0.6043277
	iters: 100, epoch: 8 | loss: 0.9144551
	speed: 0.0102s/iter; left time: 0.2436s
Updating learning rate to 6.01905964609375e-06
Epoch: 8 cost time: 0.7242932319641113
Epoch: 8, Steps: 123 | Train Loss: 0.9144551 Vali Loss: 0.6071765 Best vali loss: 0.6043277

best validation loss 0.6043276856310772

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0043465477863, 'e_layers': 4, 'learning_rate': 0.0010618747206, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7705728
	speed: 0.0132s/iter; left time: 102.2375s
	iters: 200, epoch: 1 | loss: 1.1384332
	speed: 0.0073s/iter; left time: 55.5803s
	iters: 300, epoch: 1 | loss: 0.8873059
	speed: 0.0053s/iter; left time: 40.0072s
	iters: 400, epoch: 1 | loss: 0.4050902
	speed: 0.0057s/iter; left time: 42.4996s
	iters: 500, epoch: 1 | loss: 0.8703963
	speed: 0.0064s/iter; left time: 46.6103s
	iters: 600, epoch: 1 | loss: 0.8607639
	speed: 0.0066s/iter; left time: 47.4432s
	iters: 700, epoch: 1 | loss: 1.0368307
	speed: 0.0066s/iter; left time: 46.7934s
	iters: 800, epoch: 1 | loss: 1.1972356
	speed: 0.0064s/iter; left time: 44.9154s
	iters: 900, epoch: 1 | loss: 0.5323038
	speed: 0.0065s/iter; left time: 44.7619s
Updating learning rate to 0.0010618747206
Validation loss decreased (inf --> 0.6408).  Saving model state dict ...
Epoch: 1 cost time: 6.610885858535767
Epoch: 1, Steps: 979 | Train Loss: 0.8554369 Vali Loss: 0.6408456 Best vali loss: 0.6408456
	iters: 100, epoch: 2 | loss: 0.6084726
	speed: 0.0204s/iter; left time: 137.6419s
	iters: 200, epoch: 2 | loss: 1.4322214
	speed: 0.0059s/iter; left time: 38.9723s
	iters: 300, epoch: 2 | loss: 1.0457606
	speed: 0.0066s/iter; left time: 42.9560s
	iters: 400, epoch: 2 | loss: 0.8423270
	speed: 0.0065s/iter; left time: 41.8749s
	iters: 500, epoch: 2 | loss: 0.9084683
	speed: 0.0068s/iter; left time: 43.3044s
	iters: 600, epoch: 2 | loss: 0.5511568
	speed: 0.0066s/iter; left time: 41.1539s
	iters: 700, epoch: 2 | loss: 0.7561314
	speed: 0.0066s/iter; left time: 40.3865s
	iters: 800, epoch: 2 | loss: 1.4144801
	speed: 0.0065s/iter; left time: 39.5356s
	iters: 900, epoch: 2 | loss: 1.0168800
	speed: 0.0061s/iter; left time: 36.4948s
Updating learning rate to 0.0005309373603
Epoch: 2 cost time: 6.181115388870239
Epoch: 2, Steps: 979 | Train Loss: 0.9528776 Vali Loss: 0.6456764 Best vali loss: 0.6408456
	iters: 100, epoch: 3 | loss: 0.9034761
	speed: 0.0155s/iter; left time: 89.3898s
	iters: 200, epoch: 3 | loss: 0.8510929
	speed: 0.0084s/iter; left time: 47.6397s
	iters: 300, epoch: 3 | loss: 0.5443286
	speed: 0.0085s/iter; left time: 47.1774s
	iters: 400, epoch: 3 | loss: 0.5590570
	speed: 0.0087s/iter; left time: 47.4040s
	iters: 500, epoch: 3 | loss: 1.4849986
	speed: 0.0059s/iter; left time: 31.4930s
	iters: 600, epoch: 3 | loss: 0.6192704
	speed: 0.0051s/iter; left time: 26.7109s
	iters: 700, epoch: 3 | loss: 0.7465543
	speed: 0.0063s/iter; left time: 32.5916s
	iters: 800, epoch: 3 | loss: 1.4764925
	speed: 0.0064s/iter; left time: 32.2560s
	iters: 900, epoch: 3 | loss: 0.4953928
	speed: 0.0065s/iter; left time: 32.4686s
Updating learning rate to 0.00026546868015
Validation loss decreased (0.6408 --> 0.6393).  Saving model state dict ...
Epoch: 3 cost time: 6.6454198360443115
Epoch: 3, Steps: 979 | Train Loss: 0.8534070 Vali Loss: 0.6392941 Best vali loss: 0.6392941

best validation loss 0.6392940744268072

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0047550092177, 'e_layers': 4, 'learning_rate': 0.0009477249465, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009116543135108521
Validation loss decreased (inf --> 0.6273).  Saving model state dict ...
Epoch: 1 cost time: 0.8306050300598145
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6272567 Best vali loss: 0.6272567
Updating learning rate to 0.0008089338414349039
Validation loss decreased (0.6273 --> 0.6225).  Saving model state dict ...
Epoch: 2 cost time: 0.5855770111083984
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6225249 Best vali loss: 0.6225249
Updating learning rate to 0.0006552017909823206
Validation loss decreased (0.6225 --> 0.6037).  Saving model state dict ...
Epoch: 3 cost time: 0.5851893424987793
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6036816 Best vali loss: 0.6036816

best validation loss 0.6036815599455209

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010127908578, 'e_layers': 1, 'learning_rate': 0.0003534066616, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5558701
	speed: 0.0095s/iter; left time: 36.1757s
	iters: 200, epoch: 1 | loss: 0.9068314
	speed: 0.0037s/iter; left time: 13.9236s
	iters: 300, epoch: 1 | loss: 0.6281145
	speed: 0.0037s/iter; left time: 13.3449s
	iters: 400, epoch: 1 | loss: 1.1044729
	speed: 0.0036s/iter; left time: 12.7524s
Updating learning rate to 0.0003534066616
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 2.07450795173645
Epoch: 1, Steps: 490 | Train Loss: 0.7988222 Vali Loss: 0.6142398 Best vali loss: 0.6142398
	iters: 100, epoch: 2 | loss: 0.9379043
	speed: 0.0119s/iter; left time: 39.6444s
	iters: 200, epoch: 2 | loss: 0.8174792
	speed: 0.0032s/iter; left time: 10.4799s
	iters: 300, epoch: 2 | loss: 1.0037968
	speed: 0.0042s/iter; left time: 13.1847s
	iters: 400, epoch: 2 | loss: 0.7301795
	speed: 0.0026s/iter; left time: 7.8804s
Updating learning rate to 0.0001767033308
Validation loss decreased (0.6142 --> 0.6112).  Saving model state dict ...
Epoch: 2 cost time: 1.616868019104004
Epoch: 2, Steps: 490 | Train Loss: 0.8723400 Vali Loss: 0.6112379 Best vali loss: 0.6112379
	iters: 100, epoch: 3 | loss: 1.2505962
	speed: 0.0094s/iter; left time: 26.6185s
	iters: 200, epoch: 3 | loss: 0.8775986
	speed: 0.0044s/iter; left time: 12.0603s
	iters: 300, epoch: 3 | loss: 0.8585323
	speed: 0.0042s/iter; left time: 11.0604s
	iters: 400, epoch: 3 | loss: 0.8106479
	speed: 0.0043s/iter; left time: 10.8473s
Updating learning rate to 8.83516654e-05
Epoch: 3 cost time: 2.0317506790161133
Epoch: 3, Steps: 490 | Train Loss: 0.9493437 Vali Loss: 0.6177499 Best vali loss: 0.6112379

best validation loss 0.6112378879188664

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0047550092177, 'e_layers': 4, 'learning_rate': 0.0009477249465, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00047386247325
Epoch: 4 cost time: 0.8687255382537842
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6124282 Best vali loss: 0.6036816
Updating learning rate to 0.00029252315551767945
Epoch: 5 cost time: 0.603205680847168
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6191771 Best vali loss: 0.6036816
Updating learning rate to 0.00013879110506509603
Epoch: 6 cost time: 0.6026210784912109
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6211765 Best vali loss: 0.6036816
Updating learning rate to 3.607063298914788e-05
Epoch: 7 cost time: 0.6138460636138916
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6121168 Best vali loss: 0.6036816
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5930373668670654
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6154067 Best vali loss: 0.6036816

best validation loss 0.6036815599455209

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.002837852389, 'e_layers': 4, 'learning_rate': 0.000309609584, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4719613
	speed: 0.0129s/iter; left time: 49.1948s
	iters: 200, epoch: 1 | loss: 1.2595438
	speed: 0.0072s/iter; left time: 26.6888s
	iters: 300, epoch: 1 | loss: 0.3309745
	speed: 0.0070s/iter; left time: 25.2000s
	iters: 400, epoch: 1 | loss: 0.8182579
	speed: 0.0064s/iter; left time: 22.5599s
Updating learning rate to 0.000309609584
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 3.7441084384918213
Epoch: 1, Steps: 490 | Train Loss: 0.7201844 Vali Loss: 0.6065374 Best vali loss: 0.6065374
	iters: 100, epoch: 2 | loss: 1.1880900
	speed: 0.0196s/iter; left time: 65.4442s
	iters: 200, epoch: 2 | loss: 0.7797583
	speed: 0.0065s/iter; left time: 21.1380s
	iters: 300, epoch: 2 | loss: 1.1300263
	speed: 0.0073s/iter; left time: 22.8215s
	iters: 400, epoch: 2 | loss: 0.5667297
	speed: 0.0071s/iter; left time: 21.5011s
Updating learning rate to 0.000154804792
Validation loss decreased (0.6065 --> 0.5887).  Saving model state dict ...
Epoch: 2 cost time: 3.500819206237793
Epoch: 2, Steps: 490 | Train Loss: 0.9161511 Vali Loss: 0.5886668 Best vali loss: 0.5886668
	iters: 100, epoch: 3 | loss: 0.8433681
	speed: 0.0201s/iter; left time: 56.9698s
	iters: 200, epoch: 3 | loss: 0.3722914
	speed: 0.0066s/iter; left time: 18.0654s
	iters: 300, epoch: 3 | loss: 0.6178316
	speed: 0.0071s/iter; left time: 18.7406s
	iters: 400, epoch: 3 | loss: 1.0797387
	speed: 0.0056s/iter; left time: 14.2044s
Updating learning rate to 7.7402396e-05
Epoch: 3 cost time: 3.219602108001709
Epoch: 3, Steps: 490 | Train Loss: 0.7283075 Vali Loss: 0.6181308 Best vali loss: 0.5886668
	iters: 100, epoch: 4 | loss: 0.9559101
	speed: 0.0169s/iter; left time: 39.6559s
	iters: 200, epoch: 4 | loss: 0.6631557
	speed: 0.0068s/iter; left time: 15.2717s
	iters: 300, epoch: 4 | loss: 1.1363189
	speed: 0.0064s/iter; left time: 13.8450s
	iters: 400, epoch: 4 | loss: 1.0855308
	speed: 0.0063s/iter; left time: 13.0022s
Updating learning rate to 3.8701198e-05
Validation loss decreased (0.5887 --> 0.5848).  Saving model state dict ...
Epoch: 4 cost time: 3.275683879852295
Epoch: 4, Steps: 490 | Train Loss: 0.9602289 Vali Loss: 0.5848056 Best vali loss: 0.5848056
	iters: 100, epoch: 5 | loss: 0.7800194
	speed: 0.0181s/iter; left time: 33.6786s
	iters: 200, epoch: 5 | loss: 0.3902369
	speed: 0.0066s/iter; left time: 11.5521s
	iters: 300, epoch: 5 | loss: 0.2924701
	speed: 0.0068s/iter; left time: 11.2155s
	iters: 400, epoch: 5 | loss: 0.7412440
	speed: 0.0064s/iter; left time: 10.0522s
Updating learning rate to 1.9350599e-05
Validation loss decreased (0.5848 --> 0.5812).  Saving model state dict ...
Epoch: 5 cost time: 3.2669665813446045
Epoch: 5, Steps: 490 | Train Loss: 0.5509926 Vali Loss: 0.5812241 Best vali loss: 0.5812241
	iters: 100, epoch: 6 | loss: 0.4864540
	speed: 0.0181s/iter; left time: 24.7766s
	iters: 200, epoch: 6 | loss: 1.0348126
	speed: 0.0063s/iter; left time: 8.0672s
	iters: 300, epoch: 6 | loss: 0.8446184
	speed: 0.0065s/iter; left time: 7.6697s
	iters: 400, epoch: 6 | loss: 0.8933883
	speed: 0.0065s/iter; left time: 7.0010s
Updating learning rate to 9.6752995e-06
Validation loss decreased (0.5812 --> 0.5797).  Saving model state dict ...
Epoch: 6 cost time: 3.223123788833618
Epoch: 6, Steps: 490 | Train Loss: 0.8148183 Vali Loss: 0.5797012 Best vali loss: 0.5797012
	iters: 100, epoch: 7 | loss: 1.3000605
	speed: 0.0181s/iter; left time: 15.9508s
	iters: 200, epoch: 7 | loss: 0.8413525
	speed: 0.0063s/iter; left time: 4.9139s
	iters: 300, epoch: 7 | loss: 0.9970015
	speed: 0.0065s/iter; left time: 4.4138s
	iters: 400, epoch: 7 | loss: 0.6409086
	speed: 0.0064s/iter; left time: 3.7298s
Updating learning rate to 4.83764975e-06
Validation loss decreased (0.5797 --> 0.5787).  Saving model state dict ...
Epoch: 7 cost time: 3.233041763305664
Epoch: 7, Steps: 490 | Train Loss: 0.9448308 Vali Loss: 0.5786741 Best vali loss: 0.5786741
	iters: 100, epoch: 8 | loss: 0.6724695
	speed: 0.0181s/iter; left time: 7.0810s
	iters: 200, epoch: 8 | loss: 0.9566891
	speed: 0.0056s/iter; left time: 1.6280s
	iters: 300, epoch: 8 | loss: 0.8737350
	speed: 0.0066s/iter; left time: 1.2552s
	iters: 400, epoch: 8 | loss: 0.8748989
	speed: 0.0067s/iter; left time: 0.6086s
Updating learning rate to 2.418824875e-06
Validation loss decreased (0.5787 --> 0.5783).  Saving model state dict ...
Epoch: 8 cost time: 3.1615607738494873
Epoch: 8, Steps: 490 | Train Loss: 0.8444481 Vali Loss: 0.5783206 Best vali loss: 0.5783206

best validation loss 0.578320639931124

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0027808440321, 'e_layers': 3, 'learning_rate': 0.00233717616, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5724149
	speed: 0.0102s/iter; left time: 39.0752s
	iters: 200, epoch: 1 | loss: 0.3722886
	speed: 0.0065s/iter; left time: 24.2865s
	iters: 300, epoch: 1 | loss: 0.4551531
	speed: 0.0063s/iter; left time: 22.9027s
	iters: 400, epoch: 1 | loss: 1.2283975
	speed: 0.0065s/iter; left time: 22.7724s
Updating learning rate to 0.002248222689048662
Validation loss decreased (inf --> 0.6467).  Saving model state dict ...
Epoch: 1 cost time: 3.121363401412964
Epoch: 1, Steps: 490 | Train Loss: 0.9070635 Vali Loss: 0.6466751 Best vali loss: 0.6466751
	iters: 100, epoch: 2 | loss: 1.0477175
	speed: 0.0135s/iter; left time: 44.9770s
	iters: 200, epoch: 2 | loss: 0.8256825
	speed: 0.0066s/iter; left time: 21.3133s
	iters: 300, epoch: 2 | loss: 0.6980181
	speed: 0.0064s/iter; left time: 20.1575s
	iters: 400, epoch: 2 | loss: 0.9037263
	speed: 0.0061s/iter; left time: 18.4136s
Updating learning rate to 0.0019949046357817675
Epoch: 2 cost time: 3.080348014831543
Epoch: 2, Steps: 490 | Train Loss: 0.8687861 Vali Loss: 0.6484772 Best vali loss: 0.6466751
	iters: 100, epoch: 3 | loss: 1.1101768
	speed: 0.0175s/iter; left time: 49.6691s
	iters: 200, epoch: 3 | loss: 0.7358495
	speed: 0.0062s/iter; left time: 16.9287s
	iters: 300, epoch: 3 | loss: 0.7906456
	speed: 0.0064s/iter; left time: 16.9719s
	iters: 400, epoch: 3 | loss: 1.4960889
	speed: 0.0063s/iter; left time: 15.9483s
Updating learning rate to 0.0016157873774753303
Validation loss decreased (0.6467 --> 0.6456).  Saving model state dict ...
Epoch: 3 cost time: 3.056499481201172
Epoch: 3, Steps: 490 | Train Loss: 1.0331902 Vali Loss: 0.6456333 Best vali loss: 0.6456333
	iters: 100, epoch: 4 | loss: 0.8421860
	speed: 0.0134s/iter; left time: 31.5868s
	iters: 200, epoch: 4 | loss: 0.8326778
	speed: 0.0064s/iter; left time: 14.4924s
	iters: 300, epoch: 4 | loss: 0.9369044
	speed: 0.0063s/iter; left time: 13.6220s
	iters: 400, epoch: 4 | loss: 1.5172884
	speed: 0.0060s/iter; left time: 12.3029s
Updating learning rate to 0.00116858808
Validation loss decreased (0.6456 --> 0.6382).  Saving model state dict ...
Epoch: 4 cost time: 2.953115940093994
Epoch: 4, Steps: 490 | Train Loss: 1.0322642 Vali Loss: 0.6382085 Best vali loss: 0.6382085
	iters: 100, epoch: 5 | loss: 0.7729750
	speed: 0.0171s/iter; left time: 31.8018s
	iters: 200, epoch: 5 | loss: 0.6770549
	speed: 0.0060s/iter; left time: 10.5484s
	iters: 300, epoch: 5 | loss: 0.8274240
	speed: 0.0067s/iter; left time: 11.1219s
	iters: 400, epoch: 5 | loss: 0.5179913
	speed: 0.0065s/iter; left time: 10.1575s
Updating learning rate to 0.00072138878252467
Validation loss decreased (0.6382 --> 0.6293).  Saving model state dict ...
Epoch: 5 cost time: 3.1628224849700928
Epoch: 5, Steps: 490 | Train Loss: 0.6988613 Vali Loss: 0.6292507 Best vali loss: 0.6292507
	iters: 100, epoch: 6 | loss: 0.6095373
	speed: 0.0171s/iter; left time: 23.4913s
	iters: 200, epoch: 6 | loss: 0.8204504
	speed: 0.0065s/iter; left time: 8.2248s
	iters: 300, epoch: 6 | loss: 0.8612763
	speed: 0.0060s/iter; left time: 7.0728s
	iters: 400, epoch: 6 | loss: 0.9701897
	speed: 0.0064s/iter; left time: 6.8870s
Updating learning rate to 0.0003422715242182324
Epoch: 6 cost time: 3.1759347915649414
Epoch: 6, Steps: 490 | Train Loss: 0.8153634 Vali Loss: 0.6322689 Best vali loss: 0.6292507
	iters: 100, epoch: 7 | loss: 1.1893927
	speed: 0.0161s/iter; left time: 14.1450s
	iters: 200, epoch: 7 | loss: 0.7125795
	speed: 0.0046s/iter; left time: 3.6135s
	iters: 300, epoch: 7 | loss: 0.9895020
	speed: 0.0078s/iter; left time: 5.2964s
	iters: 400, epoch: 7 | loss: 0.7698366
	speed: 0.0069s/iter; left time: 4.0328s
Updating learning rate to 8.895347095133785e-05
Epoch: 7 cost time: 3.1901817321777344
Epoch: 7, Steps: 490 | Train Loss: 0.9153277 Vali Loss: 0.6341224 Best vali loss: 0.6292507
	iters: 100, epoch: 8 | loss: 0.6482292
	speed: 0.0212s/iter; left time: 8.2810s
	iters: 200, epoch: 8 | loss: 1.2557577
	speed: 0.0073s/iter; left time: 2.1160s
	iters: 300, epoch: 8 | loss: 0.6645775
	speed: 0.0083s/iter; left time: 1.5857s
	iters: 400, epoch: 8 | loss: 0.7120129
	speed: 0.0068s/iter; left time: 0.6188s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.802469253540039
Epoch: 8, Steps: 490 | Train Loss: 0.8201443 Vali Loss: 0.6367589 Best vali loss: 0.6292507

best validation loss 0.6292507244116285

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010686625021, 'e_layers': 4, 'learning_rate': 0.000475580227, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000475580227
Validation loss decreased (inf --> 0.6207).  Saving model state dict ...
Epoch: 1 cost time: 0.9104018211364746
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6206661 Best vali loss: 0.6206661
Updating learning rate to 0.0002377901135
Validation loss decreased (0.6207 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 0.6554689407348633
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6069252 Best vali loss: 0.6069252
Updating learning rate to 0.00011889505675
Validation loss decreased (0.6069 --> 0.6057).  Saving model state dict ...
Epoch: 3 cost time: 0.6305530071258545
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6057164 Best vali loss: 0.6057164

best validation loss 0.6057164208969547

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7267132
	speed: 0.0094s/iter; left time: 36.0859s
	iters: 200, epoch: 1 | loss: 1.3396878
	speed: 0.0055s/iter; left time: 20.4294s
	iters: 300, epoch: 1 | loss: 0.7094692
	speed: 0.0053s/iter; left time: 19.1907s
	iters: 400, epoch: 1 | loss: 0.6259186
	speed: 0.0053s/iter; left time: 18.5158s
Updating learning rate to 0.0008497821375614502
Validation loss decreased (inf --> 0.6124).  Saving model state dict ...
Epoch: 1 cost time: 2.7415506839752197
Epoch: 1, Steps: 490 | Train Loss: 0.8504472 Vali Loss: 0.6124183 Best vali loss: 0.6124183
	iters: 100, epoch: 2 | loss: 0.5533640
	speed: 0.0149s/iter; left time: 49.4677s
	iters: 200, epoch: 2 | loss: 0.7033187
	speed: 0.0053s/iter; left time: 16.9704s
	iters: 300, epoch: 2 | loss: 0.8354540
	speed: 0.0051s/iter; left time: 16.0783s
	iters: 400, epoch: 2 | loss: 0.3300948
	speed: 0.0045s/iter; left time: 13.5934s
Updating learning rate to 0.0007540331008505288
Validation loss decreased (0.6124 --> 0.6091).  Saving model state dict ...
Epoch: 2 cost time: 2.5486397743225098
Epoch: 2, Steps: 490 | Train Loss: 0.6055579 Vali Loss: 0.6090606 Best vali loss: 0.6090606
	iters: 100, epoch: 3 | loss: 0.8599861
	speed: 0.0158s/iter; left time: 44.7645s
	iters: 200, epoch: 3 | loss: 0.8973127
	speed: 0.0048s/iter; left time: 13.2622s
	iters: 300, epoch: 3 | loss: 0.9897144
	speed: 0.0052s/iter; left time: 13.7518s
	iters: 400, epoch: 3 | loss: 0.3011785
	speed: 0.0051s/iter; left time: 12.8715s
Updating learning rate to 0.0006107345407392943
Epoch: 3 cost time: 2.5940961837768555
Epoch: 3, Steps: 490 | Train Loss: 0.7620479 Vali Loss: 0.6215496 Best vali loss: 0.6090606

best validation loss 0.6090606275613194

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.000943052393, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.878964131515138e-05
Validation loss decreased (inf --> 0.6770).  Saving model state dict ...
Epoch: 1 cost time: 0.6864044666290283
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6770409 Best vali loss: 0.6770409
Updating learning rate to 5.216552993919382e-05
Validation loss decreased (0.6770 --> 0.6512).  Saving model state dict ...
Epoch: 2 cost time: 0.4406154155731201
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6511789 Best vali loss: 0.6511789
Updating learning rate to 4.2251846681397714e-05
Validation loss decreased (0.6512 --> 0.6342).  Saving model state dict ...
Epoch: 3 cost time: 0.44194984436035156
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6342063 Best vali loss: 0.6342063

best validation loss 0.6342062566469026

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010686625021, 'e_layers': 4, 'learning_rate': 0.000475580227, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.9447528375e-05
Validation loss decreased (0.6057 --> 0.6054).  Saving model state dict ...
Epoch: 4 cost time: 0.8016440868377686
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6054489 Best vali loss: 0.6054489
Updating learning rate to 2.97237641875e-05
Validation loss decreased (0.6054 --> 0.6032).  Saving model state dict ...
Epoch: 5 cost time: 0.5401930809020996
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6031785 Best vali loss: 0.6031785
Updating learning rate to 1.486188209375e-05
Epoch: 6 cost time: 0.550281286239624
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6050703 Best vali loss: 0.6031785
Updating learning rate to 7.430941046875e-06
Epoch: 7 cost time: 0.5519068241119385
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6045998 Best vali loss: 0.6031785
Updating learning rate to 3.7154705234375e-06
Epoch: 8 cost time: 0.5454821586608887
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6047607 Best vali loss: 0.6031785

best validation loss 0.6031785399921511

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0087891353463, 'e_layers': 2, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4769844
	speed: 0.0105s/iter; left time: 80.9896s
	iters: 200, epoch: 1 | loss: 0.8103709
	speed: 0.0046s/iter; left time: 35.4749s
	iters: 300, epoch: 1 | loss: 0.5745108
	speed: 0.0044s/iter; left time: 33.3826s
	iters: 400, epoch: 1 | loss: 0.9981707
	speed: 0.0044s/iter; left time: 33.0500s
	iters: 500, epoch: 1 | loss: 1.1275399
	speed: 0.0044s/iter; left time: 32.4652s
	iters: 600, epoch: 1 | loss: 1.3690579
	speed: 0.0043s/iter; left time: 31.3583s
	iters: 700, epoch: 1 | loss: 2.1930025
	speed: 0.0045s/iter; left time: 31.9908s
	iters: 800, epoch: 1 | loss: 0.3168584
	speed: 0.0046s/iter; left time: 32.0615s
	iters: 900, epoch: 1 | loss: 1.0014784
	speed: 0.0045s/iter; left time: 31.0978s
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.6163).  Saving model state dict ...
Epoch: 1 cost time: 4.706950426101685
Epoch: 1, Steps: 979 | Train Loss: 0.9853304 Vali Loss: 0.6163054 Best vali loss: 0.6163054
	iters: 100, epoch: 2 | loss: 0.3841563
	speed: 0.0149s/iter; left time: 100.4247s
	iters: 200, epoch: 2 | loss: 1.7588708
	speed: 0.0044s/iter; left time: 29.3185s
	iters: 300, epoch: 2 | loss: 0.9909957
	speed: 0.0042s/iter; left time: 27.8302s
	iters: 400, epoch: 2 | loss: 0.6646192
	speed: 0.0041s/iter; left time: 26.7565s
	iters: 500, epoch: 2 | loss: 0.9094061
	speed: 0.0040s/iter; left time: 25.3817s
	iters: 600, epoch: 2 | loss: 0.8699537
	speed: 0.0039s/iter; left time: 24.4955s
	iters: 700, epoch: 2 | loss: 1.4253641
	speed: 0.0039s/iter; left time: 23.9562s
	iters: 800, epoch: 2 | loss: 0.3926925
	speed: 0.0040s/iter; left time: 24.5139s
	iters: 900, epoch: 2 | loss: 0.3537753
	speed: 0.0039s/iter; left time: 23.0182s
Updating learning rate to 0.0009137180420535848
Epoch: 2 cost time: 4.046581506729126
Epoch: 2, Steps: 979 | Train Loss: 0.8610926 Vali Loss: 0.6370360 Best vali loss: 0.6163054
	iters: 100, epoch: 3 | loss: 1.4235383
	speed: 0.0143s/iter; left time: 82.5125s
	iters: 200, epoch: 3 | loss: 0.3398156
	speed: 0.0044s/iter; left time: 25.0809s
	iters: 300, epoch: 3 | loss: 1.2749921
	speed: 0.0045s/iter; left time: 25.0769s
	iters: 400, epoch: 3 | loss: 0.5317047
	speed: 0.0044s/iter; left time: 24.1302s
	iters: 500, epoch: 3 | loss: 1.4372555
	speed: 0.0042s/iter; left time: 22.6084s
	iters: 600, epoch: 3 | loss: 1.1808687
	speed: 0.0041s/iter; left time: 21.3708s
	iters: 700, epoch: 3 | loss: 0.5873815
	speed: 0.0041s/iter; left time: 21.4580s
	iters: 800, epoch: 3 | loss: 1.2353549
	speed: 0.0042s/iter; left time: 21.3726s
	iters: 900, epoch: 3 | loss: 0.3190708
	speed: 0.0040s/iter; left time: 19.8323s
Updating learning rate to 0.0007400725089513316
Epoch: 3 cost time: 4.180309534072876
Epoch: 3, Steps: 979 | Train Loss: 0.9255536 Vali Loss: 0.6218320 Best vali loss: 0.6163054
	iters: 100, epoch: 4 | loss: 0.6719954
	speed: 0.0127s/iter; left time: 60.9202s
	iters: 200, epoch: 4 | loss: 1.0845693
	speed: 0.0045s/iter; left time: 21.1773s
	iters: 300, epoch: 4 | loss: 1.1625956
	speed: 0.0049s/iter; left time: 22.5111s
	iters: 400, epoch: 4 | loss: 0.4789765
	speed: 0.0057s/iter; left time: 25.6755s
	iters: 500, epoch: 4 | loss: 0.3690064
	speed: 0.0054s/iter; left time: 23.7913s
	iters: 600, epoch: 4 | loss: 0.8138028
	speed: 0.0045s/iter; left time: 19.1836s
	iters: 700, epoch: 4 | loss: 1.6772139
	speed: 0.0034s/iter; left time: 14.0923s
	iters: 800, epoch: 4 | loss: 0.2784921
	speed: 0.0034s/iter; left time: 14.0926s
	iters: 900, epoch: 4 | loss: 0.4006068
	speed: 0.0046s/iter; left time: 18.2339s
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 4.43867039680481
Epoch: 4, Steps: 979 | Train Loss: 0.7708065 Vali Loss: 0.6255461 Best vali loss: 0.6163054
	iters: 100, epoch: 5 | loss: 0.8569509
	speed: 0.0179s/iter; left time: 68.2848s
	iters: 200, epoch: 5 | loss: 1.2053127
	speed: 0.0045s/iter; left time: 16.9014s
	iters: 300, epoch: 5 | loss: 0.4369781
	speed: 0.0048s/iter; left time: 17.3546s
	iters: 400, epoch: 5 | loss: 1.0610102
	speed: 0.0052s/iter; left time: 18.1818s
	iters: 500, epoch: 5 | loss: 0.3538050
	speed: 0.0051s/iter; left time: 17.3494s
	iters: 600, epoch: 5 | loss: 1.3178222
	speed: 0.0046s/iter; left time: 15.1820s
	iters: 700, epoch: 5 | loss: 0.5142815
	speed: 0.0052s/iter; left time: 16.7592s
	iters: 800, epoch: 5 | loss: 0.6860827
	speed: 0.0050s/iter; left time: 15.6678s
	iters: 900, epoch: 5 | loss: 1.3627261
	speed: 0.0050s/iter; left time: 15.0695s
Updating learning rate to 0.0003304147647486684
Validation loss decreased (0.6163 --> 0.5983).  Saving model state dict ...
Epoch: 5 cost time: 4.835647106170654
Epoch: 5, Steps: 979 | Train Loss: 0.8661077 Vali Loss: 0.5982588 Best vali loss: 0.5982588
	iters: 100, epoch: 6 | loss: 0.5378952
	speed: 0.0158s/iter; left time: 44.8300s
	iters: 200, epoch: 6 | loss: 0.5345054
	speed: 0.0036s/iter; left time: 9.9185s
	iters: 300, epoch: 6 | loss: 1.2467786
	speed: 0.0056s/iter; left time: 14.8707s
	iters: 400, epoch: 6 | loss: 0.6869879
	speed: 0.0054s/iter; left time: 13.7349s
	iters: 500, epoch: 6 | loss: 0.4313285
	speed: 0.0052s/iter; left time: 12.7235s
	iters: 600, epoch: 6 | loss: 1.1542541
	speed: 0.0056s/iter; left time: 13.0905s
	iters: 700, epoch: 6 | loss: 1.0507689
	speed: 0.0054s/iter; left time: 12.1773s
	iters: 800, epoch: 6 | loss: 0.5955098
	speed: 0.0052s/iter; left time: 11.0119s
	iters: 900, epoch: 6 | loss: 0.4900048
	speed: 0.0050s/iter; left time: 10.1445s
Updating learning rate to 0.00015676923164641517
Validation loss decreased (0.5983 --> 0.5871).  Saving model state dict ...
Epoch: 6 cost time: 4.736025333404541
Epoch: 6, Steps: 979 | Train Loss: 0.7475592 Vali Loss: 0.5871448 Best vali loss: 0.5871448
	iters: 100, epoch: 7 | loss: 0.4701840
	speed: 0.0123s/iter; left time: 22.8395s
	iters: 200, epoch: 7 | loss: 0.8935675
	speed: 0.0049s/iter; left time: 8.6763s
	iters: 300, epoch: 7 | loss: 0.4902899
	speed: 0.0047s/iter; left time: 7.7198s
	iters: 400, epoch: 7 | loss: 0.6659113
	speed: 0.0048s/iter; left time: 7.5355s
	iters: 500, epoch: 7 | loss: 0.3194495
	speed: 0.0048s/iter; left time: 6.9621s
	iters: 600, epoch: 7 | loss: 1.5173514
	speed: 0.0049s/iter; left time: 6.6483s
	iters: 700, epoch: 7 | loss: 0.3224651
	speed: 0.0048s/iter; left time: 6.0274s
	iters: 800, epoch: 7 | loss: 1.1563227
	speed: 0.0044s/iter; left time: 5.1128s
	iters: 900, epoch: 7 | loss: 0.4794239
	speed: 0.0050s/iter; left time: 5.3455s
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 4.766688585281372
Epoch: 7, Steps: 979 | Train Loss: 0.7016628 Vali Loss: 0.6107786 Best vali loss: 0.5871448
	iters: 100, epoch: 8 | loss: 0.5735540
	speed: 0.0169s/iter; left time: 14.8924s
	iters: 200, epoch: 8 | loss: 0.2384967
	speed: 0.0050s/iter; left time: 3.9004s
	iters: 300, epoch: 8 | loss: 0.4767997
	speed: 0.0047s/iter; left time: 3.1921s
	iters: 400, epoch: 8 | loss: 0.3032543
	speed: 0.0048s/iter; left time: 2.7913s
	iters: 500, epoch: 8 | loss: 1.3251667
	speed: 0.0047s/iter; left time: 2.2519s
	iters: 600, epoch: 8 | loss: 0.2219351
	speed: 0.0048s/iter; left time: 1.8093s
	iters: 700, epoch: 8 | loss: 0.7548248
	speed: 0.0047s/iter; left time: 1.3259s
	iters: 800, epoch: 8 | loss: 0.4210672
	speed: 0.0049s/iter; left time: 0.8792s
	iters: 900, epoch: 8 | loss: 0.4171987
	speed: 0.0051s/iter; left time: 0.4073s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.816552400588989
Epoch: 8, Steps: 979 | Train Loss: 0.5258108 Vali Loss: 0.5985599 Best vali loss: 0.5871448

best validation loss 0.5871448271090319

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0052842772816, 'e_layers': 4, 'learning_rate': 9.30573825e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8057529
	speed: 0.0130s/iter; left time: 49.5492s
	iters: 200, epoch: 1 | loss: 1.0810415
	speed: 0.0071s/iter; left time: 26.3926s
	iters: 300, epoch: 1 | loss: 1.1963412
	speed: 0.0070s/iter; left time: 25.4587s
	iters: 400, epoch: 1 | loss: 0.7569841
	speed: 0.0070s/iter; left time: 24.7278s
Updating learning rate to 8.9515596770412e-05
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 3.7925446033477783
Epoch: 1, Steps: 490 | Train Loss: 0.9600299 Vali Loss: 0.6489781 Best vali loss: 0.6489781
	iters: 100, epoch: 2 | loss: 0.5803586
	speed: 0.0200s/iter; left time: 66.7688s
	iters: 200, epoch: 2 | loss: 1.2568730
	speed: 0.0071s/iter; left time: 22.9823s
	iters: 300, epoch: 2 | loss: 1.1212535
	speed: 0.0073s/iter; left time: 22.7207s
	iters: 400, epoch: 2 | loss: 0.6100886
	speed: 0.0071s/iter; left time: 21.3913s
Updating learning rate to 7.942944435261018e-05
Validation loss decreased (0.6490 --> 0.6261).  Saving model state dict ...
Epoch: 2 cost time: 3.528911828994751
Epoch: 2, Steps: 490 | Train Loss: 0.8921434 Vali Loss: 0.6260544 Best vali loss: 0.6260544
	iters: 100, epoch: 3 | loss: 0.5217440
	speed: 0.0189s/iter; left time: 53.7818s
	iters: 200, epoch: 3 | loss: 0.7175175
	speed: 0.0070s/iter; left time: 19.1089s
	iters: 300, epoch: 3 | loss: 0.7001074
	speed: 0.0072s/iter; left time: 18.9126s
	iters: 400, epoch: 3 | loss: 0.6380100
	speed: 0.0069s/iter; left time: 17.4946s
Updating learning rate to 6.433445052100552e-05
Validation loss decreased (0.6261 --> 0.6152).  Saving model state dict ...
Epoch: 3 cost time: 3.452329397201538
Epoch: 3, Steps: 490 | Train Loss: 0.6443447 Vali Loss: 0.6152433 Best vali loss: 0.6152433
	iters: 100, epoch: 4 | loss: 1.1874268
	speed: 0.0188s/iter; left time: 44.0987s
	iters: 200, epoch: 4 | loss: 0.9558302
	speed: 0.0072s/iter; left time: 16.1562s
	iters: 300, epoch: 4 | loss: 0.9463552
	speed: 0.0072s/iter; left time: 15.5530s
	iters: 400, epoch: 4 | loss: 0.6845878
	speed: 0.0072s/iter; left time: 14.6773s
Updating learning rate to 4.652869125e-05
Validation loss decreased (0.6152 --> 0.6113).  Saving model state dict ...
Epoch: 4 cost time: 3.5488626956939697
Epoch: 4, Steps: 490 | Train Loss: 0.9435500 Vali Loss: 0.6113380 Best vali loss: 0.6113380
	iters: 100, epoch: 5 | loss: 0.6144099
	speed: 0.0188s/iter; left time: 34.9995s
	iters: 200, epoch: 5 | loss: 0.7081680
	speed: 0.0071s/iter; left time: 12.5469s
	iters: 300, epoch: 5 | loss: 0.5565755
	speed: 0.0069s/iter; left time: 11.4869s
	iters: 400, epoch: 5 | loss: 0.6712412
	speed: 0.0068s/iter; left time: 10.6823s
Updating learning rate to 2.8722931978994484e-05
Validation loss decreased (0.6113 --> 0.6080).  Saving model state dict ...
Epoch: 5 cost time: 3.490865468978882
Epoch: 5, Steps: 490 | Train Loss: 0.6375987 Vali Loss: 0.6080377 Best vali loss: 0.6080377
	iters: 100, epoch: 6 | loss: 0.6952736
	speed: 0.0186s/iter; left time: 25.5457s
	iters: 200, epoch: 6 | loss: 0.8842320
	speed: 0.0048s/iter; left time: 6.0751s
	iters: 300, epoch: 6 | loss: 0.7130904
	speed: 0.0056s/iter; left time: 6.5055s
	iters: 400, epoch: 6 | loss: 0.6348231
	speed: 0.0062s/iter; left time: 6.6874s
Updating learning rate to 1.3627938147389826e-05
Validation loss decreased (0.6080 --> 0.6066).  Saving model state dict ...
Epoch: 6 cost time: 2.9873080253601074
Epoch: 6, Steps: 490 | Train Loss: 0.7318548 Vali Loss: 0.6066471 Best vali loss: 0.6066471
	iters: 100, epoch: 7 | loss: 1.2728395
	speed: 0.0178s/iter; left time: 15.6634s
	iters: 200, epoch: 7 | loss: 1.1811665
	speed: 0.0063s/iter; left time: 4.8985s
	iters: 300, epoch: 7 | loss: 0.8386070
	speed: 0.0068s/iter; left time: 4.6086s
	iters: 400, epoch: 7 | loss: 1.1077265
	speed: 0.0064s/iter; left time: 3.6969s
Updating learning rate to 3.541785729588002e-06
Epoch: 7 cost time: 3.178901195526123
Epoch: 7, Steps: 490 | Train Loss: 1.1000849 Vali Loss: 0.6068579 Best vali loss: 0.6066471
	iters: 100, epoch: 8 | loss: 0.8530437
	speed: 0.0176s/iter; left time: 6.8886s
	iters: 200, epoch: 8 | loss: 1.0647013
	speed: 0.0072s/iter; left time: 2.0926s
	iters: 300, epoch: 8 | loss: 0.7810503
	speed: 0.0066s/iter; left time: 1.2667s
	iters: 400, epoch: 8 | loss: 0.9920349
	speed: 0.0063s/iter; left time: 0.5723s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.293503999710083
Epoch: 8, Steps: 490 | Train Loss: 0.9227076 Vali Loss: 0.6066821 Best vali loss: 0.6066471

best validation loss 0.6066471455219662

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0094025534782, 'e_layers': 3, 'learning_rate': 7.57956321e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5953235
	speed: 0.0125s/iter; left time: 47.8565s
	iters: 200, epoch: 1 | loss: 1.1667740
	speed: 0.0066s/iter; left time: 24.6622s
	iters: 300, epoch: 1 | loss: 0.8401985
	speed: 0.0066s/iter; left time: 23.8022s
	iters: 400, epoch: 1 | loss: 0.8049036
	speed: 0.0066s/iter; left time: 23.4103s
Updating learning rate to 7.291083262547274e-05
Validation loss decreased (inf --> 0.5985).  Saving model state dict ...
Epoch: 1 cost time: 3.5505013465881348
Epoch: 1, Steps: 490 | Train Loss: 0.8517999 Vali Loss: 0.5985475 Best vali loss: 0.5985475
	iters: 100, epoch: 2 | loss: 0.6821892
	speed: 0.0181s/iter; left time: 60.4525s
	iters: 200, epoch: 2 | loss: 0.5046650
	speed: 0.0067s/iter; left time: 21.6871s
	iters: 300, epoch: 2 | loss: 0.4326099
	speed: 0.0065s/iter; left time: 20.2547s
	iters: 400, epoch: 2 | loss: 0.6771262
	speed: 0.0065s/iter; left time: 19.8073s
Updating learning rate to 6.469561877111538e-05
Validation loss decreased (0.5985 --> 0.5811).  Saving model state dict ...
Epoch: 2 cost time: 3.237396717071533
Epoch: 2, Steps: 490 | Train Loss: 0.5741476 Vali Loss: 0.5810507 Best vali loss: 0.5810507
	iters: 100, epoch: 3 | loss: 0.5256095
	speed: 0.0179s/iter; left time: 50.9356s
	iters: 200, epoch: 3 | loss: 0.8065643
	speed: 0.0064s/iter; left time: 17.6310s
	iters: 300, epoch: 3 | loss: 0.9946572
	speed: 0.0065s/iter; left time: 17.2122s
	iters: 400, epoch: 3 | loss: 0.8676970
	speed: 0.0068s/iter; left time: 17.3701s
Updating learning rate to 5.2400682375154794e-05
Validation loss decreased (0.5811 --> 0.5686).  Saving model state dict ...
Epoch: 3 cost time: 3.2518832683563232
Epoch: 3, Steps: 490 | Train Loss: 0.7986320 Vali Loss: 0.5685721 Best vali loss: 0.5685721

best validation loss 0.5685721035634738

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0041376749186, 'e_layers': 2, 'learning_rate': 0.0013179784539, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1546807
	speed: 0.0109s/iter; left time: 41.8398s
	iters: 200, epoch: 1 | loss: 0.5456740
	speed: 0.0052s/iter; left time: 19.3620s
	iters: 300, epoch: 1 | loss: 0.8985540
	speed: 0.0051s/iter; left time: 18.5061s
	iters: 400, epoch: 1 | loss: 0.9066195
	speed: 0.0055s/iter; left time: 19.3309s
Updating learning rate to 0.0012678158858745402
Validation loss decreased (inf --> 0.6146).  Saving model state dict ...
Epoch: 1 cost time: 2.8645431995391846
Epoch: 1, Steps: 490 | Train Loss: 0.8763820 Vali Loss: 0.6146330 Best vali loss: 0.6146330
	iters: 100, epoch: 2 | loss: 0.9492536
	speed: 0.0158s/iter; left time: 52.7437s
	iters: 200, epoch: 2 | loss: 1.3390304
	speed: 0.0052s/iter; left time: 16.6542s
	iters: 300, epoch: 2 | loss: 0.6993948
	speed: 0.0053s/iter; left time: 16.5008s
	iters: 400, epoch: 2 | loss: 0.5419061
	speed: 0.0052s/iter; left time: 15.8175s
Updating learning rate to 0.0011249649780552258
Validation loss decreased (0.6146 --> 0.5919).  Saving model state dict ...
Epoch: 2 cost time: 2.635000705718994
Epoch: 2, Steps: 490 | Train Loss: 0.8823962 Vali Loss: 0.5918546 Best vali loss: 0.5918546
	iters: 100, epoch: 3 | loss: 0.7952044
	speed: 0.0141s/iter; left time: 40.0899s
	iters: 200, epoch: 3 | loss: 1.0650635
	speed: 0.0034s/iter; left time: 9.2839s
	iters: 300, epoch: 3 | loss: 1.5213354
	speed: 0.0033s/iter; left time: 8.7186s
	iters: 400, epoch: 3 | loss: 0.7760904
	speed: 0.0056s/iter; left time: 14.1657s
Updating learning rate to 0.0009111734862108432
Epoch: 3 cost time: 2.14788818359375
Epoch: 3, Steps: 490 | Train Loss: 1.0394234 Vali Loss: 0.6292360 Best vali loss: 0.5918546

best validation loss 0.5918546259154991

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0090051442195, 'e_layers': 1, 'learning_rate': 0.0005778764026, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000555882291641696
Validation loss decreased (inf --> 0.6051).  Saving model state dict ...
Epoch: 1 cost time: 0.6749112606048584
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6051417 Best vali loss: 0.6051417
Updating learning rate to 0.0004932483627830737
Validation loss decreased (0.6051 --> 0.5955).  Saving model state dict ...
Epoch: 2 cost time: 0.48110103607177734
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5955417 Best vali loss: 0.5955417
Updating learning rate to 0.00039951006391487925
Epoch: 3 cost time: 0.5321376323699951
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5979127 Best vali loss: 0.5955417

best validation loss 0.5955417243102699

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0094025534782, 'e_layers': 3, 'learning_rate': 7.57956321e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5664634
	speed: 0.0124s/iter; left time: 29.2094s
	iters: 200, epoch: 4 | loss: 1.0410155
	speed: 0.0062s/iter; left time: 13.8948s
	iters: 300, epoch: 4 | loss: 0.5766456
	speed: 0.0061s/iter; left time: 13.1586s
	iters: 400, epoch: 4 | loss: 0.7204904
	speed: 0.0061s/iter; left time: 12.4829s
Updating learning rate to 3.789781605e-05
Validation loss decreased (0.5686 --> 0.5452).  Saving model state dict ...
Epoch: 4 cost time: 3.3228561878204346
Epoch: 4, Steps: 490 | Train Loss: 0.7261537 Vali Loss: 0.5451734 Best vali loss: 0.5451734
	iters: 100, epoch: 5 | loss: 0.6621478
	speed: 0.0185s/iter; left time: 34.4048s
	iters: 200, epoch: 5 | loss: 0.5017991
	speed: 0.0062s/iter; left time: 10.8334s
	iters: 300, epoch: 5 | loss: 0.3707928
	speed: 0.0061s/iter; left time: 10.1671s
	iters: 400, epoch: 5 | loss: 0.6474831
	speed: 0.0062s/iter; left time: 9.6081s
Updating learning rate to 2.3394949724845215e-05
Validation loss decreased (0.5452 --> 0.5356).  Saving model state dict ...
Epoch: 5 cost time: 3.1104519367218018
Epoch: 5, Steps: 490 | Train Loss: 0.5455557 Vali Loss: 0.5356428 Best vali loss: 0.5356428
	iters: 100, epoch: 6 | loss: 0.4584878
	speed: 0.0173s/iter; left time: 23.7395s
	iters: 200, epoch: 6 | loss: 0.7741693
	speed: 0.0047s/iter; left time: 5.9545s
	iters: 300, epoch: 6 | loss: 0.9597059
	speed: 0.0061s/iter; left time: 7.1602s
	iters: 400, epoch: 6 | loss: 0.8369898
	speed: 0.0066s/iter; left time: 7.0617s
Updating learning rate to 1.1100013328884624e-05
Epoch: 6 cost time: 3.012310266494751
Epoch: 6, Steps: 490 | Train Loss: 0.7573382 Vali Loss: 0.5459879 Best vali loss: 0.5356428
	iters: 100, epoch: 7 | loss: 0.4311581
	speed: 0.0153s/iter; left time: 13.4613s
	iters: 200, epoch: 7 | loss: 0.4194876
	speed: 0.0058s/iter; left time: 4.5338s
	iters: 300, epoch: 7 | loss: 0.7547423
	speed: 0.0075s/iter; left time: 5.1029s
	iters: 400, epoch: 7 | loss: 0.6508655
	speed: 0.0071s/iter; left time: 4.1351s
Updating learning rate to 2.8847994745272605e-06
Epoch: 7 cost time: 3.1682190895080566
Epoch: 7, Steps: 490 | Train Loss: 0.5640634 Vali Loss: 0.5414349 Best vali loss: 0.5356428
	iters: 100, epoch: 8 | loss: 0.8231302
	speed: 0.0193s/iter; left time: 7.5484s
	iters: 200, epoch: 8 | loss: 0.5226873
	speed: 0.0054s/iter; left time: 1.5650s
	iters: 300, epoch: 8 | loss: 0.6515912
	speed: 0.0049s/iter; left time: 0.9415s
	iters: 400, epoch: 8 | loss: 0.5071126
	speed: 0.0048s/iter; left time: 0.4376s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.716737985610962
Epoch: 8, Steps: 490 | Train Loss: 0.6261303 Vali Loss: 0.5400035 Best vali loss: 0.5356428

best validation loss 0.5356427692928452

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0035713197255, 'e_layers': 2, 'learning_rate': 0.0033793788609, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0032507589115434083
Validation loss decreased (inf --> 0.6031).  Saving model state dict ...
Epoch: 1 cost time: 0.6973838806152344
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6030890 Best vali loss: 0.6030890
Updating learning rate to 0.00288448028482043
Epoch: 2 cost time: 0.457216739654541
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6066450 Best vali loss: 0.6030890
Updating learning rate to 0.0023363055813256195
Validation loss decreased (0.6031 --> 0.5995).  Saving model state dict ...
Epoch: 3 cost time: 0.43636012077331543
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5995394 Best vali loss: 0.5995394
Updating learning rate to 0.00168968943045
Epoch: 4 cost time: 0.45641493797302246
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6146056 Best vali loss: 0.5995394
Updating learning rate to 0.0010430732795743804
Epoch: 5 cost time: 0.4705541133880615
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6298561 Best vali loss: 0.5995394
Updating learning rate to 0.0004948985760795698
Epoch: 6 cost time: 0.4649074077606201
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6274246 Best vali loss: 0.5995394
Updating learning rate to 0.00012861994935659164
Epoch: 7 cost time: 0.43966150283813477
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6459405 Best vali loss: 0.5995394
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43590617179870605
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6512111 Best vali loss: 0.5995394

best validation loss 0.5995394187302349

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.001716146484, 'e_layers': 4, 'learning_rate': 9.46281852e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4534421
	speed: 0.0119s/iter; left time: 92.2126s
	iters: 200, epoch: 1 | loss: 0.2336114
	speed: 0.0062s/iter; left time: 47.3686s
	iters: 300, epoch: 1 | loss: 1.1092126
	speed: 0.0060s/iter; left time: 45.0893s
	iters: 400, epoch: 1 | loss: 0.6785249
	speed: 0.0057s/iter; left time: 42.0467s
	iters: 500, epoch: 1 | loss: 2.1700420
	speed: 0.0059s/iter; left time: 43.3407s
	iters: 600, epoch: 1 | loss: 0.4059029
	speed: 0.0061s/iter; left time: 44.0552s
	iters: 700, epoch: 1 | loss: 0.7352300
	speed: 0.0062s/iter; left time: 44.0769s
	iters: 800, epoch: 1 | loss: 0.5022359
	speed: 0.0062s/iter; left time: 43.2608s
	iters: 900, epoch: 1 | loss: 1.2350905
	speed: 0.0061s/iter; left time: 42.2241s
Updating learning rate to 9.46281852e-05
Validation loss decreased (inf --> 0.6016).  Saving model state dict ...
Epoch: 1 cost time: 6.23696494102478
Epoch: 1, Steps: 979 | Train Loss: 0.8359214 Vali Loss: 0.6015584 Best vali loss: 0.6015584
	iters: 100, epoch: 2 | loss: 0.8966622
	speed: 0.0200s/iter; left time: 135.3890s
	iters: 200, epoch: 2 | loss: 0.9590229
	speed: 0.0067s/iter; left time: 44.6881s
	iters: 300, epoch: 2 | loss: 1.1495737
	speed: 0.0066s/iter; left time: 43.1913s
	iters: 400, epoch: 2 | loss: 0.9132340
	speed: 0.0062s/iter; left time: 40.3305s
	iters: 500, epoch: 2 | loss: 0.3704996
	speed: 0.0067s/iter; left time: 42.8594s
	iters: 600, epoch: 2 | loss: 1.3153909
	speed: 0.0069s/iter; left time: 43.0193s
	iters: 700, epoch: 2 | loss: 0.2257168
	speed: 0.0069s/iter; left time: 42.6191s
	iters: 800, epoch: 2 | loss: 0.3849027
	speed: 0.0073s/iter; left time: 44.0222s
	iters: 900, epoch: 2 | loss: 0.7918040
	speed: 0.0070s/iter; left time: 41.6177s
Updating learning rate to 4.73140926e-05
Validation loss decreased (0.6016 --> 0.5559).  Saving model state dict ...
Epoch: 2 cost time: 6.68560791015625
Epoch: 2, Steps: 979 | Train Loss: 0.7785341 Vali Loss: 0.5559331 Best vali loss: 0.5559331
	iters: 100, epoch: 3 | loss: 0.2286986
	speed: 0.0205s/iter; left time: 118.4032s
	iters: 200, epoch: 3 | loss: 0.5855039
	speed: 0.0062s/iter; left time: 35.2985s
	iters: 300, epoch: 3 | loss: 0.9064452
	speed: 0.0064s/iter; left time: 35.9044s
	iters: 400, epoch: 3 | loss: 1.4207534
	speed: 0.0068s/iter; left time: 36.9637s
	iters: 500, epoch: 3 | loss: 0.5498813
	speed: 0.0068s/iter; left time: 36.6663s
	iters: 600, epoch: 3 | loss: 0.6225127
	speed: 0.0068s/iter; left time: 35.7287s
	iters: 700, epoch: 3 | loss: 0.6980817
	speed: 0.0067s/iter; left time: 34.6946s
	iters: 800, epoch: 3 | loss: 1.2703685
	speed: 0.0068s/iter; left time: 34.2957s
	iters: 900, epoch: 3 | loss: 0.4522132
	speed: 0.0068s/iter; left time: 33.6218s
Updating learning rate to 2.36570463e-05
Validation loss decreased (0.5559 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 6.566843748092651
Epoch: 3, Steps: 979 | Train Loss: 0.7482732 Vali Loss: 0.5538242 Best vali loss: 0.5538242
	iters: 100, epoch: 4 | loss: 0.5261651
	speed: 0.0194s/iter; left time: 92.9642s
	iters: 200, epoch: 4 | loss: 0.5683138
	speed: 0.0064s/iter; left time: 29.9092s
	iters: 300, epoch: 4 | loss: 0.3118711
	speed: 0.0069s/iter; left time: 31.6017s
	iters: 400, epoch: 4 | loss: 0.9455982
	speed: 0.0067s/iter; left time: 30.2238s
	iters: 500, epoch: 4 | loss: 0.8003390
	speed: 0.0067s/iter; left time: 29.4026s
	iters: 600, epoch: 4 | loss: 0.7059938
	speed: 0.0066s/iter; left time: 28.5649s
	iters: 700, epoch: 4 | loss: 0.3269700
	speed: 0.0067s/iter; left time: 28.0367s
	iters: 800, epoch: 4 | loss: 0.8949701
	speed: 0.0067s/iter; left time: 27.5621s
	iters: 900, epoch: 4 | loss: 0.7126656
	speed: 0.0070s/iter; left time: 28.0233s
Updating learning rate to 1.182852315e-05
Validation loss decreased (0.5538 --> 0.5517).  Saving model state dict ...
Epoch: 4 cost time: 6.4711785316467285
Epoch: 4, Steps: 979 | Train Loss: 0.6436541 Vali Loss: 0.5516949 Best vali loss: 0.5516949
	iters: 100, epoch: 5 | loss: 0.4218175
	speed: 0.0194s/iter; left time: 74.1896s
	iters: 200, epoch: 5 | loss: 1.5188535
	speed: 0.0065s/iter; left time: 24.2078s
	iters: 300, epoch: 5 | loss: 0.5373878
	speed: 0.0064s/iter; left time: 23.1806s
	iters: 400, epoch: 5 | loss: 0.5391051
	speed: 0.0064s/iter; left time: 22.6426s
	iters: 500, epoch: 5 | loss: 0.5060070
	speed: 0.0065s/iter; left time: 22.0920s
	iters: 600, epoch: 5 | loss: 0.4156881
	speed: 0.0065s/iter; left time: 21.5731s
	iters: 700, epoch: 5 | loss: 0.2898756
	speed: 0.0064s/iter; left time: 20.5536s
	iters: 800, epoch: 5 | loss: 1.2231928
	speed: 0.0064s/iter; left time: 20.0572s
	iters: 900, epoch: 5 | loss: 1.3546990
	speed: 0.0065s/iter; left time: 19.4974s
Updating learning rate to 5.914261575e-06
Validation loss decreased (0.5517 --> 0.5460).  Saving model state dict ...
Epoch: 5 cost time: 6.331598997116089
Epoch: 5, Steps: 979 | Train Loss: 0.7562918 Vali Loss: 0.5459777 Best vali loss: 0.5459777
	iters: 100, epoch: 6 | loss: 0.5771403
	speed: 0.0199s/iter; left time: 56.4264s
	iters: 200, epoch: 6 | loss: 0.4636911
	speed: 0.0067s/iter; left time: 18.4630s
	iters: 300, epoch: 6 | loss: 1.1793698
	speed: 0.0071s/iter; left time: 18.6975s
	iters: 400, epoch: 6 | loss: 1.0287154
	speed: 0.0068s/iter; left time: 17.2155s
	iters: 500, epoch: 6 | loss: 0.2415476
	speed: 0.0068s/iter; left time: 16.4681s
	iters: 600, epoch: 6 | loss: 0.8440294
	speed: 0.0068s/iter; left time: 15.9553s
	iters: 700, epoch: 6 | loss: 0.2314288
	speed: 0.0068s/iter; left time: 15.1995s
	iters: 800, epoch: 6 | loss: 0.5791194
	speed: 0.0060s/iter; left time: 12.8199s
	iters: 900, epoch: 6 | loss: 0.7574795
	speed: 0.0058s/iter; left time: 11.8584s
Updating learning rate to 2.9571307875e-06
Validation loss decreased (0.5460 --> 0.5399).  Saving model state dict ...
Epoch: 6 cost time: 6.417848348617554
Epoch: 6, Steps: 979 | Train Loss: 0.6558357 Vali Loss: 0.5398743 Best vali loss: 0.5398743
	iters: 100, epoch: 7 | loss: 0.8286647
	speed: 0.0190s/iter; left time: 35.4008s
	iters: 200, epoch: 7 | loss: 0.9645692
	speed: 0.0076s/iter; left time: 13.3240s
	iters: 300, epoch: 7 | loss: 0.2283964
	speed: 0.0076s/iter; left time: 12.6822s
	iters: 400, epoch: 7 | loss: 0.8611640
	speed: 0.0076s/iter; left time: 11.7769s
	iters: 500, epoch: 7 | loss: 1.1966592
	speed: 0.0074s/iter; left time: 10.7465s
	iters: 600, epoch: 7 | loss: 0.2637718
	speed: 0.0070s/iter; left time: 9.5211s
	iters: 700, epoch: 7 | loss: 1.0755426
	speed: 0.0071s/iter; left time: 8.8884s
	iters: 800, epoch: 7 | loss: 0.2768072
	speed: 0.0076s/iter; left time: 8.7877s
	iters: 900, epoch: 7 | loss: 0.4682372
	speed: 0.0079s/iter; left time: 8.3643s
Updating learning rate to 1.47856539375e-06
Epoch: 7 cost time: 7.376728057861328
Epoch: 7, Steps: 979 | Train Loss: 0.6848680 Vali Loss: 0.5408814 Best vali loss: 0.5398743
	iters: 100, epoch: 8 | loss: 0.6371068
	speed: 0.0225s/iter; left time: 19.7700s
	iters: 200, epoch: 8 | loss: 0.8138649
	speed: 0.0070s/iter; left time: 5.4238s
	iters: 300, epoch: 8 | loss: 0.7331005
	speed: 0.0076s/iter; left time: 5.1368s
	iters: 400, epoch: 8 | loss: 1.2209555
	speed: 0.0075s/iter; left time: 4.3784s
	iters: 500, epoch: 8 | loss: 0.2653957
	speed: 0.0076s/iter; left time: 3.6372s
	iters: 600, epoch: 8 | loss: 0.3230458
	speed: 0.0076s/iter; left time: 2.8849s
	iters: 700, epoch: 8 | loss: 1.2973608
	speed: 0.0075s/iter; left time: 2.0960s
	iters: 800, epoch: 8 | loss: 0.7774351
	speed: 0.0071s/iter; left time: 1.2800s
	iters: 900, epoch: 8 | loss: 0.6988130
	speed: 0.0075s/iter; left time: 0.5986s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019016322338, 'e_layers': 3, 'learning_rate': 0.0002203212483, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4895764
	speed: 0.0118s/iter; left time: 91.4808s
	iters: 200, epoch: 1 | loss: 0.6776240
	speed: 0.0060s/iter; left time: 46.1608s
	iters: 300, epoch: 1 | loss: 1.8052765
	speed: 0.0062s/iter; left time: 46.6693s
	iters: 400, epoch: 1 | loss: 1.4778743
	speed: 0.0062s/iter; left time: 45.7441s
	iters: 500, epoch: 1 | loss: 0.6083925
	speed: 0.0058s/iter; left time: 42.5804s
	iters: 600, epoch: 1 | loss: 0.8322713
	speed: 0.0057s/iter; left time: 41.3239s
	iters: 700, epoch: 1 | loss: 0.5687762
	speed: 0.0063s/iter; left time: 44.8260s
	iters: 800, epoch: 1 | loss: 0.5981064
	speed: 0.0064s/iter; left time: 44.8813s
	iters: 900, epoch: 1 | loss: 1.1648511
	speed: 0.0064s/iter; left time: 44.1798s
Updating learning rate to 0.00021193577009085356
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 6.303205728530884
Epoch: 1, Steps: 979 | Train Loss: 0.9136388 Vali Loss: 0.6033072 Best vali loss: 0.6033072
	iters: 100, epoch: 2 | loss: 1.4785916
	speed: 0.0194s/iter; left time: 131.1535s
	iters: 200, epoch: 2 | loss: 0.7063997
	speed: 0.0061s/iter; left time: 40.3589s
	iters: 300, epoch: 2 | loss: 0.8717572
	speed: 0.0060s/iter; left time: 39.6420s
	iters: 400, epoch: 2 | loss: 0.4361400
	speed: 0.0062s/iter; left time: 40.0402s
	iters: 500, epoch: 2 | loss: 0.5457468
	speed: 0.0059s/iter; left time: 37.5831s
	iters: 600, epoch: 2 | loss: 0.9521732
	speed: 0.0058s/iter; left time: 36.1797s
	iters: 700, epoch: 2 | loss: 1.1243969
	speed: 0.0061s/iter; left time: 37.3161s
	iters: 800, epoch: 2 | loss: 0.7073498
	speed: 0.0055s/iter; left time: 33.5294s
	iters: 900, epoch: 2 | loss: 1.0179406
	speed: 0.0060s/iter; left time: 35.9226s
Updating learning rate to 0.00018805594850620754
Validation loss decreased (0.6033 --> 0.5681).  Saving model state dict ...
Epoch: 2 cost time: 5.9063661098480225
Epoch: 2, Steps: 979 | Train Loss: 0.8711662 Vali Loss: 0.5681100 Best vali loss: 0.5681100
	iters: 100, epoch: 3 | loss: 0.7568829
	speed: 0.0199s/iter; left time: 115.0686s
	iters: 200, epoch: 3 | loss: 0.5667748
	speed: 0.0062s/iter; left time: 35.1696s
	iters: 300, epoch: 3 | loss: 0.3483406
	speed: 0.0060s/iter; left time: 33.2102s
	iters: 400, epoch: 3 | loss: 0.6912574
	speed: 0.0055s/iter; left time: 29.8686s
	iters: 500, epoch: 3 | loss: 0.2163015
	speed: 0.0039s/iter; left time: 21.0416s
	iters: 600, epoch: 3 | loss: 0.4136201
	speed: 0.0040s/iter; left time: 20.9889s
	iters: 700, epoch: 3 | loss: 0.3767487
	speed: 0.0069s/iter; left time: 35.9510s
	iters: 800, epoch: 3 | loss: 0.8306838
	speed: 0.0071s/iter; left time: 35.9115s
	iters: 900, epoch: 3 | loss: 0.7359129
	speed: 0.0071s/iter; left time: 35.2096s
Updating learning rate to 0.0001523172699112026
Epoch: 3 cost time: 5.915484666824341
Epoch: 3, Steps: 979 | Train Loss: 0.5485025 Vali Loss: 0.6496988 Best vali loss: 0.5681100

best validation loss 0.5681100300013716

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011236842427, 'e_layers': 3, 'learning_rate': 0.0014870102392, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5850407
	speed: 0.0143s/iter; left time: 54.4649s
	iters: 200, epoch: 1 | loss: 0.7955040
	speed: 0.0082s/iter; left time: 30.6046s
	iters: 300, epoch: 1 | loss: 0.8936109
	speed: 0.0082s/iter; left time: 29.7046s
	iters: 400, epoch: 1 | loss: 0.8108721
	speed: 0.0077s/iter; left time: 26.9558s
Updating learning rate to 0.0014304142819157963
Validation loss decreased (inf --> 0.6494).  Saving model state dict ...
Epoch: 1 cost time: 4.1626877784729
Epoch: 1, Steps: 490 | Train Loss: 0.7712569 Vali Loss: 0.6494226 Best vali loss: 0.6494226
	iters: 100, epoch: 2 | loss: 0.9077672
	speed: 0.0211s/iter; left time: 70.3543s
	iters: 200, epoch: 2 | loss: 0.3970776
	speed: 0.0082s/iter; left time: 26.5544s
	iters: 300, epoch: 2 | loss: 0.5028256
	speed: 0.0081s/iter; left time: 25.4962s
	iters: 400, epoch: 2 | loss: 1.0751218
	speed: 0.0082s/iter; left time: 24.9123s
Updating learning rate to 0.001269242631516075
Epoch: 2 cost time: 3.967505693435669
Epoch: 2, Steps: 490 | Train Loss: 0.7206980 Vali Loss: 0.6617177 Best vali loss: 0.6494226
	iters: 100, epoch: 3 | loss: 0.4200864
	speed: 0.0151s/iter; left time: 43.0149s
	iters: 200, epoch: 3 | loss: 1.2326964
	speed: 0.0060s/iter; left time: 16.3588s
	iters: 300, epoch: 3 | loss: 0.7043781
	speed: 0.0067s/iter; left time: 17.6537s
	iters: 400, epoch: 3 | loss: 0.8457920
	speed: 0.0065s/iter; left time: 16.4039s
Updating learning rate to 0.0010280322107495447
Validation loss decreased (0.6494 --> 0.6405).  Saving model state dict ...
Epoch: 3 cost time: 3.02470326423645
Epoch: 3, Steps: 490 | Train Loss: 0.8007382 Vali Loss: 0.6404750 Best vali loss: 0.6404750

best validation loss 0.6404750312384164

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.010197037822, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6493773
	speed: 0.0121s/iter; left time: 10.6725s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 1.069669246673584
Epoch: 1, Steps: 123 | Train Loss: 0.6493773 Vali Loss: 0.6069899 Best vali loss: 0.6069899
	iters: 100, epoch: 2 | loss: 0.6938469
	speed: 0.0101s/iter; left time: 7.6863s
Updating learning rate to 0.00093122262415
Validation loss decreased (0.6070 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 0.7608320713043213
Epoch: 2, Steps: 123 | Train Loss: 0.6938469 Vali Loss: 0.6037782 Best vali loss: 0.6037782
	iters: 100, epoch: 3 | loss: 0.7254834
	speed: 0.0101s/iter; left time: 6.4826s
Updating learning rate to 0.000465611312075
Validation loss decreased (0.6038 --> 0.6032).  Saving model state dict ...
Epoch: 3 cost time: 0.7558364868164062
Epoch: 3, Steps: 123 | Train Loss: 0.7254834 Vali Loss: 0.6032158 Best vali loss: 0.6032158

best validation loss 0.6032157622239811

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019016322338, 'e_layers': 3, 'learning_rate': 0.0002203212483, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3795089
	speed: 0.0120s/iter; left time: 57.3170s
	iters: 200, epoch: 4 | loss: 0.6193706
	speed: 0.0048s/iter; left time: 22.3156s
	iters: 300, epoch: 4 | loss: 1.1308200
	speed: 0.0044s/iter; left time: 20.3419s
	iters: 400, epoch: 4 | loss: 1.3572789
	speed: 0.0051s/iter; left time: 22.8296s
	iters: 500, epoch: 4 | loss: 0.5218925
	speed: 0.0058s/iter; left time: 25.4521s
	iters: 600, epoch: 4 | loss: 0.6350425
	speed: 0.0060s/iter; left time: 25.7937s
	iters: 700, epoch: 4 | loss: 0.4028701
	speed: 0.0049s/iter; left time: 20.3725s
	iters: 800, epoch: 4 | loss: 0.5817495
	speed: 0.0039s/iter; left time: 15.8936s
	iters: 900, epoch: 4 | loss: 1.0317352
	speed: 0.0047s/iter; left time: 18.9041s
Updating learning rate to 0.00011016062415
Epoch: 4 cost time: 5.382805824279785
Epoch: 4, Steps: 979 | Train Loss: 0.7400298 Vali Loss: 0.5744394 Best vali loss: 0.5681100
	iters: 100, epoch: 5 | loss: 1.2911496
	speed: 0.0233s/iter; left time: 88.9245s
	iters: 200, epoch: 5 | loss: 0.4130962
	speed: 0.0074s/iter; left time: 27.3360s
	iters: 300, epoch: 5 | loss: 0.6323519
	speed: 0.0063s/iter; left time: 22.9499s
	iters: 400, epoch: 5 | loss: 0.3859220
	speed: 0.0066s/iter; left time: 23.1501s
	iters: 500, epoch: 5 | loss: 0.4709863
	speed: 0.0072s/iter; left time: 24.5304s
	iters: 600, epoch: 5 | loss: 0.7917048
	speed: 0.0073s/iter; left time: 24.2341s
	iters: 700, epoch: 5 | loss: 0.9557166
	speed: 0.0072s/iter; left time: 23.1720s
	iters: 800, epoch: 5 | loss: 0.6568881
	speed: 0.0072s/iter; left time: 22.3496s
	iters: 900, epoch: 5 | loss: 0.8127450
	speed: 0.0065s/iter; left time: 19.4837s
Updating learning rate to 6.800397838879741e-05
Epoch: 5 cost time: 6.790289640426636
Epoch: 5, Steps: 979 | Train Loss: 0.7122845 Vali Loss: 0.5809745 Best vali loss: 0.5681100
	iters: 100, epoch: 6 | loss: 0.5826876
	speed: 0.0223s/iter; left time: 63.2335s
	iters: 200, epoch: 6 | loss: 0.4238566
	speed: 0.0070s/iter; left time: 19.2572s
	iters: 300, epoch: 6 | loss: 0.1866007
	speed: 0.0071s/iter; left time: 18.7498s
	iters: 400, epoch: 6 | loss: 0.5576603
	speed: 0.0064s/iter; left time: 16.2413s
	iters: 500, epoch: 6 | loss: 0.1617692
	speed: 0.0066s/iter; left time: 16.0891s
	iters: 600, epoch: 6 | loss: 0.3382969
	speed: 0.0075s/iter; left time: 17.4501s
	iters: 700, epoch: 6 | loss: 0.2748263
	speed: 0.0073s/iter; left time: 16.4011s
	iters: 800, epoch: 6 | loss: 0.7432200
	speed: 0.0073s/iter; left time: 15.5323s
	iters: 900, epoch: 6 | loss: 0.5766373
	speed: 0.0072s/iter; left time: 14.6686s
Updating learning rate to 3.2265299793792456e-05
Epoch: 6 cost time: 6.917235612869263
Epoch: 6, Steps: 979 | Train Loss: 0.4272839 Vali Loss: 0.6106367 Best vali loss: 0.5681100
	iters: 100, epoch: 7 | loss: 0.3594030
	speed: 0.0231s/iter; left time: 42.8769s
	iters: 200, epoch: 7 | loss: 0.2094763
	speed: 0.0071s/iter; left time: 12.5164s
	iters: 300, epoch: 7 | loss: 0.5287381
	speed: 0.0072s/iter; left time: 11.8906s
	iters: 400, epoch: 7 | loss: 0.6578067
	speed: 0.0068s/iter; left time: 10.5579s
	iters: 500, epoch: 7 | loss: 0.6557841
	speed: 0.0058s/iter; left time: 8.4016s
	iters: 600, epoch: 7 | loss: 0.6239376
	speed: 0.0041s/iter; left time: 5.5486s
	iters: 700, epoch: 7 | loss: 0.8907257
	speed: 0.0040s/iter; left time: 5.0105s
	iters: 800, epoch: 7 | loss: 1.1474786
	speed: 0.0054s/iter; left time: 6.2295s
	iters: 900, epoch: 7 | loss: 0.2752331
	speed: 0.0060s/iter; left time: 6.3695s
Updating learning rate to 8.385478209146436e-06
Epoch: 7 cost time: 5.860326766967773
Epoch: 7, Steps: 979 | Train Loss: 0.5942870 Vali Loss: 0.6125375 Best vali loss: 0.5681100
	iters: 100, epoch: 8 | loss: 0.9607310
	speed: 0.0192s/iter; left time: 16.8590s
	iters: 200, epoch: 8 | loss: 0.8807676
	speed: 0.0060s/iter; left time: 4.7165s
	iters: 300, epoch: 8 | loss: 0.5863475
	speed: 0.0059s/iter; left time: 4.0303s
	iters: 400, epoch: 8 | loss: 0.5054247
	speed: 0.0060s/iter; left time: 3.4711s
	iters: 500, epoch: 8 | loss: 0.5407611
	speed: 0.0060s/iter; left time: 2.8939s
	iters: 600, epoch: 8 | loss: 0.2578490
	speed: 0.0042s/iter; left time: 1.5920s
	iters: 700, epoch: 8 | loss: 0.4037966
	speed: 0.0040s/iter; left time: 1.1271s
	iters: 800, epoch: 8 | loss: 0.5287560
	speed: 0.0063s/iter; left time: 1.1314s
	iters: 900, epoch: 8 | loss: 0.4744246
	speed: 0.0071s/iter; left time: 0.5707s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.788349628448486
Epoch: 8, Steps: 979 | Train Loss: 0.5709842 Vali Loss: 0.6300979 Best vali loss: 0.5681100

best validation loss 0.5681100300013716

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0033733476764, 'e_layers': 2, 'learning_rate': 0.0015215628629, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0561079
	speed: 0.0107s/iter; left time: 40.9123s
	iters: 200, epoch: 1 | loss: 0.5673777
	speed: 0.0050s/iter; left time: 18.7329s
	iters: 300, epoch: 1 | loss: 0.7727430
	speed: 0.0051s/iter; left time: 18.5606s
	iters: 400, epoch: 1 | loss: 0.8562878
	speed: 0.0051s/iter; left time: 17.9333s
Updating learning rate to 0.0015215628629
Validation loss decreased (inf --> 0.5987).  Saving model state dict ...
Epoch: 1 cost time: 2.7867376804351807
Epoch: 1, Steps: 490 | Train Loss: 0.8131291 Vali Loss: 0.5986564 Best vali loss: 0.5986564
	iters: 100, epoch: 2 | loss: 0.3803955
	speed: 0.0132s/iter; left time: 44.0816s
	iters: 200, epoch: 2 | loss: 0.9451610
	speed: 0.0040s/iter; left time: 12.8119s
	iters: 300, epoch: 2 | loss: 0.8636126
	speed: 0.0043s/iter; left time: 13.5909s
	iters: 400, epoch: 2 | loss: 0.5494190
	speed: 0.0051s/iter; left time: 15.4399s
Updating learning rate to 0.00076078143145
Epoch: 2 cost time: 2.2340199947357178
Epoch: 2, Steps: 490 | Train Loss: 0.6846470 Vali Loss: 0.6127580 Best vali loss: 0.5986564
	iters: 100, epoch: 3 | loss: 0.7916201
	speed: 0.0144s/iter; left time: 40.7924s
	iters: 200, epoch: 3 | loss: 0.8318235
	speed: 0.0052s/iter; left time: 14.2724s
	iters: 300, epoch: 3 | loss: 0.6029063
	speed: 0.0052s/iter; left time: 13.7273s
	iters: 400, epoch: 3 | loss: 0.5259013
	speed: 0.0052s/iter; left time: 13.1874s
Updating learning rate to 0.000380390715725
Epoch: 3 cost time: 2.649627447128296
Epoch: 3, Steps: 490 | Train Loss: 0.6880628 Vali Loss: 0.6401996 Best vali loss: 0.5986564
	iters: 100, epoch: 4 | loss: 1.3435309
	speed: 0.0151s/iter; left time: 35.5525s
	iters: 200, epoch: 4 | loss: 0.4301580
	speed: 0.0050s/iter; left time: 11.3513s
	iters: 300, epoch: 4 | loss: 0.8784900
	speed: 0.0051s/iter; left time: 11.0194s
	iters: 400, epoch: 4 | loss: 0.8367294
	speed: 0.0047s/iter; left time: 9.6647s
Updating learning rate to 0.0001901953578625
Epoch: 4 cost time: 2.414072275161743
Epoch: 4, Steps: 490 | Train Loss: 0.8722271 Vali Loss: 0.6168974 Best vali loss: 0.5986564
	iters: 100, epoch: 5 | loss: 0.5623183
	speed: 0.0130s/iter; left time: 24.2739s
	iters: 200, epoch: 5 | loss: 0.9787332
	speed: 0.0051s/iter; left time: 9.0425s
	iters: 300, epoch: 5 | loss: 0.7799382
	speed: 0.0051s/iter; left time: 8.4491s
	iters: 400, epoch: 5 | loss: 0.8420478
	speed: 0.0051s/iter; left time: 7.9109s
Updating learning rate to 9.509767893125e-05
Epoch: 5 cost time: 2.551593065261841
Epoch: 5, Steps: 490 | Train Loss: 0.7907594 Vali Loss: 0.6211660 Best vali loss: 0.5986564
	iters: 100, epoch: 6 | loss: 0.7674341
	speed: 0.0149s/iter; left time: 20.3637s
	iters: 200, epoch: 6 | loss: 0.5244455
	speed: 0.0057s/iter; left time: 7.2872s
	iters: 300, epoch: 6 | loss: 0.5644304
	speed: 0.0054s/iter; left time: 6.2836s
	iters: 400, epoch: 6 | loss: 0.3151181
	speed: 0.0054s/iter; left time: 5.7407s
Updating learning rate to 4.7548839465625e-05
Epoch: 6 cost time: 2.690070390701294
Epoch: 6, Steps: 490 | Train Loss: 0.5428570 Vali Loss: 0.6185696 Best vali loss: 0.5986564
	iters: 100, epoch: 7 | loss: 0.4458135
	speed: 0.0146s/iter; left time: 12.9023s
	iters: 200, epoch: 7 | loss: 0.4121471
	speed: 0.0044s/iter; left time: 3.4095s
	iters: 300, epoch: 7 | loss: 0.7743492
	speed: 0.0040s/iter; left time: 2.7032s
	iters: 400, epoch: 7 | loss: 0.8815470
	speed: 0.0039s/iter; left time: 2.2448s
Updating learning rate to 2.37744197328125e-05
Epoch: 7 cost time: 2.296647310256958
Epoch: 7, Steps: 490 | Train Loss: 0.6284642 Vali Loss: 0.6183613 Best vali loss: 0.5986564
	iters: 100, epoch: 8 | loss: 0.7334271
	speed: 0.0146s/iter; left time: 5.7277s
	iters: 200, epoch: 8 | loss: 0.9532961
	speed: 0.0051s/iter; left time: 1.4956s
	iters: 300, epoch: 8 | loss: 1.0951011
	speed: 0.0052s/iter; left time: 1.0025s
	iters: 400, epoch: 8 | loss: 0.9278167
	speed: 0.0052s/iter; left time: 0.4764s
Updating learning rate to 1.188720986640625e-05
Epoch: 8 cost time: 2.544762134552002
Epoch: 8, Steps: 490 | Train Loss: 0.9274103 Vali Loss: 0.6218812 Best vali loss: 0.5986564

best validation loss 0.5986564221728571

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0055598166579, 'e_layers': 4, 'learning_rate': 0.0001468646066, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5995467
	speed: 0.0130s/iter; left time: 100.4356s
	iters: 200, epoch: 1 | loss: 1.4032617
	speed: 0.0071s/iter; left time: 54.4177s
	iters: 300, epoch: 1 | loss: 0.4940743
	speed: 0.0066s/iter; left time: 50.0614s
	iters: 400, epoch: 1 | loss: 1.7573357
	speed: 0.0059s/iter; left time: 44.0830s
	iters: 500, epoch: 1 | loss: 0.7936071
	speed: 0.0061s/iter; left time: 44.4727s
	iters: 600, epoch: 1 | loss: 0.3369583
	speed: 0.0067s/iter; left time: 48.7644s
	iters: 700, epoch: 1 | loss: 0.6155554
	speed: 0.0068s/iter; left time: 48.2541s
	iters: 800, epoch: 1 | loss: 0.5382517
	speed: 0.0068s/iter; left time: 47.5603s
	iters: 900, epoch: 1 | loss: 0.6751943
	speed: 0.0067s/iter; left time: 46.7251s
Updating learning rate to 0.00014127490534403102
Validation loss decreased (inf --> 0.6093).  Saving model state dict ...
Epoch: 1 cost time: 6.829470634460449
Epoch: 1, Steps: 979 | Train Loss: 0.8015317 Vali Loss: 0.6092823 Best vali loss: 0.6092823
	iters: 100, epoch: 2 | loss: 0.9393539
	speed: 0.0223s/iter; left time: 150.6331s
	iters: 200, epoch: 2 | loss: 0.3626236
	speed: 0.0070s/iter; left time: 46.8678s
	iters: 300, epoch: 2 | loss: 1.1270676
	speed: 0.0071s/iter; left time: 46.2092s
	iters: 400, epoch: 2 | loss: 0.3335017
	speed: 0.0069s/iter; left time: 44.7307s
	iters: 500, epoch: 2 | loss: 0.4670418
	speed: 0.0070s/iter; left time: 44.2668s
	iters: 600, epoch: 2 | loss: 1.4028522
	speed: 0.0067s/iter; left time: 42.1663s
	iters: 700, epoch: 2 | loss: 0.5937108
	speed: 0.0069s/iter; left time: 42.2993s
	iters: 800, epoch: 2 | loss: 0.9608242
	speed: 0.0070s/iter; left time: 42.4934s
	iters: 900, epoch: 2 | loss: 0.4505579
	speed: 0.0068s/iter; left time: 40.6254s
Updating learning rate to 0.00012535678292157728
Epoch: 2 cost time: 6.848355293273926
Epoch: 2, Steps: 979 | Train Loss: 0.7375037 Vali Loss: 0.6135324 Best vali loss: 0.6092823
	iters: 100, epoch: 3 | loss: 0.2312957
	speed: 0.0215s/iter; left time: 124.1858s
	iters: 200, epoch: 3 | loss: 1.4788231
	speed: 0.0066s/iter; left time: 37.5063s
	iters: 300, epoch: 3 | loss: 1.7693658
	speed: 0.0066s/iter; left time: 37.0679s
	iters: 400, epoch: 3 | loss: 0.3701291
	speed: 0.0065s/iter; left time: 35.3336s
	iters: 500, epoch: 3 | loss: 1.1021543
	speed: 0.0061s/iter; left time: 32.6138s
	iters: 600, epoch: 3 | loss: 0.6096021
	speed: 0.0063s/iter; left time: 33.3251s
	iters: 700, epoch: 3 | loss: 0.6420258
	speed: 0.0069s/iter; left time: 35.8279s
	iters: 800, epoch: 3 | loss: 0.5692138
	speed: 0.0068s/iter; left time: 34.6453s
	iters: 900, epoch: 3 | loss: 0.8382429
	speed: 0.0066s/iter; left time: 32.7578s
Updating learning rate to 0.00010153362917331831
Epoch: 3 cost time: 6.483623027801514
Epoch: 3, Steps: 979 | Train Loss: 0.8456503 Vali Loss: 0.6154747 Best vali loss: 0.6092823
	iters: 100, epoch: 4 | loss: 1.0841798
	speed: 0.0214s/iter; left time: 102.7679s
	iters: 200, epoch: 4 | loss: 1.3240751
	speed: 0.0066s/iter; left time: 31.1391s
	iters: 300, epoch: 4 | loss: 1.0356983
	speed: 0.0067s/iter; left time: 30.7013s
	iters: 400, epoch: 4 | loss: 0.4579862
	speed: 0.0068s/iter; left time: 30.6811s
	iters: 500, epoch: 4 | loss: 1.4033293
	speed: 0.0062s/iter; left time: 27.3525s
	iters: 600, epoch: 4 | loss: 0.4269996
	speed: 0.0059s/iter; left time: 25.3699s
	iters: 700, epoch: 4 | loss: 0.7166607
	speed: 0.0065s/iter; left time: 27.0867s
	iters: 800, epoch: 4 | loss: 0.6127330
	speed: 0.0067s/iter; left time: 27.2590s
	iters: 900, epoch: 4 | loss: 0.8410570
	speed: 0.0067s/iter; left time: 26.6827s
Updating learning rate to 7.34323033e-05
Validation loss decreased (0.6093 --> 0.6090).  Saving model state dict ...
Epoch: 4 cost time: 6.439052581787109
Epoch: 4, Steps: 979 | Train Loss: 0.8780799 Vali Loss: 0.6090118 Best vali loss: 0.6090118
	iters: 100, epoch: 5 | loss: 0.8018396
	speed: 0.0216s/iter; left time: 82.4441s
	iters: 200, epoch: 5 | loss: 0.8658527
	speed: 0.0066s/iter; left time: 24.7118s
	iters: 300, epoch: 5 | loss: 0.2298200
	speed: 0.0057s/iter; left time: 20.7717s
	iters: 400, epoch: 5 | loss: 0.9896215
	speed: 0.0049s/iter; left time: 17.3412s
	iters: 500, epoch: 5 | loss: 0.8656471
	speed: 0.0048s/iter; left time: 16.5050s
	iters: 600, epoch: 5 | loss: 0.9359164
	speed: 0.0048s/iter; left time: 15.7610s
	iters: 700, epoch: 5 | loss: 0.6965445
	speed: 0.0060s/iter; left time: 19.4002s
	iters: 800, epoch: 5 | loss: 0.9596927
	speed: 0.0066s/iter; left time: 20.6628s
	iters: 900, epoch: 5 | loss: 0.9252025
	speed: 0.0066s/iter; left time: 19.9188s
Updating learning rate to 4.5330977426681694e-05
Validation loss decreased (0.6090 --> 0.5696).  Saving model state dict ...
Epoch: 5 cost time: 5.858911991119385
Epoch: 5, Steps: 979 | Train Loss: 0.8077930 Vali Loss: 0.5696234 Best vali loss: 0.5696234
	iters: 100, epoch: 6 | loss: 0.7511706
	speed: 0.0203s/iter; left time: 57.6424s
	iters: 200, epoch: 6 | loss: 0.7418398
	speed: 0.0068s/iter; left time: 18.6676s
	iters: 300, epoch: 6 | loss: 1.7816604
	speed: 0.0068s/iter; left time: 17.9674s
	iters: 400, epoch: 6 | loss: 0.8562306
	speed: 0.0065s/iter; left time: 16.3876s
	iters: 500, epoch: 6 | loss: 0.7653412
	speed: 0.0061s/iter; left time: 14.8116s
	iters: 600, epoch: 6 | loss: 1.0275186
	speed: 0.0069s/iter; left time: 16.1688s
	iters: 700, epoch: 6 | loss: 0.6239921
	speed: 0.0068s/iter; left time: 15.2928s
	iters: 800, epoch: 6 | loss: 1.0218724
	speed: 0.0069s/iter; left time: 14.6708s
	iters: 900, epoch: 6 | loss: 0.4048121
	speed: 0.0069s/iter; left time: 14.0054s
Updating learning rate to 2.150782367842271e-05
Validation loss decreased (0.5696 --> 0.5652).  Saving model state dict ...
Epoch: 6 cost time: 6.642014026641846
Epoch: 6, Steps: 979 | Train Loss: 0.8860487 Vali Loss: 0.5651826 Best vali loss: 0.5651826
	iters: 100, epoch: 7 | loss: 0.7133585
	speed: 0.0209s/iter; left time: 38.8424s
	iters: 200, epoch: 7 | loss: 1.4374627
	speed: 0.0066s/iter; left time: 11.6930s
	iters: 300, epoch: 7 | loss: 0.5136578
	speed: 0.0057s/iter; left time: 9.5250s
	iters: 400, epoch: 7 | loss: 0.3951788
	speed: 0.0059s/iter; left time: 9.1719s
	iters: 500, epoch: 7 | loss: 0.5433149
	speed: 0.0063s/iter; left time: 9.2480s
	iters: 600, epoch: 7 | loss: 1.0547799
	speed: 0.0065s/iter; left time: 8.8204s
	iters: 700, epoch: 7 | loss: 0.5965528
	speed: 0.0064s/iter; left time: 8.1115s
	iters: 800, epoch: 7 | loss: 0.2695806
	speed: 0.0065s/iter; left time: 7.5252s
	iters: 900, epoch: 7 | loss: 0.3841987
	speed: 0.0064s/iter; left time: 6.8171s
Updating learning rate to 5.589701255968981e-06
Validation loss decreased (0.5652 --> 0.5601).  Saving model state dict ...
Epoch: 7 cost time: 6.263652086257935
Epoch: 7, Steps: 979 | Train Loss: 0.6564539 Vali Loss: 0.5601318 Best vali loss: 0.5601318
	iters: 100, epoch: 8 | loss: 0.9868986
	speed: 0.0205s/iter; left time: 18.0564s
	iters: 200, epoch: 8 | loss: 0.4985350
	speed: 0.0068s/iter; left time: 5.3014s
	iters: 300, epoch: 8 | loss: 0.7577682
	speed: 0.0064s/iter; left time: 4.3753s
	iters: 400, epoch: 8 | loss: 0.2593144
	speed: 0.0056s/iter; left time: 3.2278s
	iters: 500, epoch: 8 | loss: 1.4394716
	speed: 0.0056s/iter; left time: 2.7096s
	iters: 600, epoch: 8 | loss: 1.5896201
	speed: 0.0081s/iter; left time: 3.0683s
	iters: 700, epoch: 8 | loss: 1.3392290
	speed: 0.0081s/iter; left time: 2.2694s
	iters: 800, epoch: 8 | loss: 0.6601275
	speed: 0.0082s/iter; left time: 1.4811s
	iters: 900, epoch: 8 | loss: 0.2867911
	speed: 0.0077s/iter; left time: 0.6164s
Updating learning rate to 0.0
Epoch: 8 cost time: 7.006088972091675
Epoch: 8, Steps: 979 | Train Loss: 0.8686395 Vali Loss: 0.5655659 Best vali loss: 0.5601318

best validation loss 0.5601318337364585

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021747175015, 'e_layers': 3, 'learning_rate': 0.0045316959995, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8299892
	speed: 0.0143s/iter; left time: 54.5237s
	iters: 200, epoch: 1 | loss: 0.7235568
	speed: 0.0070s/iter; left time: 25.9202s
	iters: 300, epoch: 1 | loss: 0.6803778
	speed: 0.0067s/iter; left time: 24.4195s
	iters: 400, epoch: 1 | loss: 0.7933428
	speed: 0.0075s/iter; left time: 26.4767s
Updating learning rate to 0.004359218590500664
Validation loss decreased (inf --> 0.6223).  Saving model state dict ...
Epoch: 1 cost time: 3.9070022106170654
Epoch: 1, Steps: 490 | Train Loss: 0.7568166 Vali Loss: 0.6222579 Best vali loss: 0.6222579
	iters: 100, epoch: 2 | loss: 0.9136252
	speed: 0.0209s/iter; left time: 69.6408s
	iters: 200, epoch: 2 | loss: 0.7893773
	speed: 0.0072s/iter; left time: 23.1182s
	iters: 300, epoch: 2 | loss: 0.5084857
	speed: 0.0067s/iter; left time: 20.9652s
	iters: 400, epoch: 2 | loss: 1.2114178
	speed: 0.0043s/iter; left time: 13.1724s
Updating learning rate to 0.003868044485511199
Epoch: 2 cost time: 3.036817789077759
Epoch: 2, Steps: 490 | Train Loss: 0.8557265 Vali Loss: 0.6522723 Best vali loss: 0.6222579
	iters: 100, epoch: 3 | loss: 0.7579632
	speed: 0.0162s/iter; left time: 45.9017s
	iters: 200, epoch: 3 | loss: 0.8529841
	speed: 0.0057s/iter; left time: 15.5005s
	iters: 300, epoch: 3 | loss: 0.8135978
	speed: 0.0063s/iter; left time: 16.6581s
	iters: 400, epoch: 3 | loss: 1.0849949
	speed: 0.0049s/iter; left time: 12.3800s
Updating learning rate to 0.003132950489511903
Epoch: 3 cost time: 2.7416536808013916
Epoch: 3, Steps: 490 | Train Loss: 0.8773850 Vali Loss: 0.6440351 Best vali loss: 0.6222579

best validation loss 0.6222578918889737

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.001857404995, 'e_layers': 3, 'learning_rate': 0.0002113522207, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8932848
	speed: 0.0122s/iter; left time: 10.8286s
Updating learning rate to 0.0002113522207
Validation loss decreased (inf --> 0.6146).  Saving model state dict ...
Epoch: 1 cost time: 1.107105016708374
Epoch: 1, Steps: 123 | Train Loss: 0.8932848 Vali Loss: 0.6146483 Best vali loss: 0.6146483
	iters: 100, epoch: 2 | loss: 0.6859162
	speed: 0.0104s/iter; left time: 7.9137s
Updating learning rate to 0.00010567611035
Validation loss decreased (0.6146 --> 0.6064).  Saving model state dict ...
Epoch: 2 cost time: 0.8545820713043213
Epoch: 2, Steps: 123 | Train Loss: 0.6859162 Vali Loss: 0.6064306 Best vali loss: 0.6064306
	iters: 100, epoch: 3 | loss: 0.9677705
	speed: 0.0107s/iter; left time: 6.8276s
Updating learning rate to 5.2838055175e-05
Validation loss decreased (0.6064 --> 0.6000).  Saving model state dict ...
Epoch: 3 cost time: 0.845604419708252
Epoch: 3, Steps: 123 | Train Loss: 0.9677705 Vali Loss: 0.6000478 Best vali loss: 0.6000478

best validation loss 0.6000477614252725

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0027066824413, 'e_layers': 3, 'learning_rate': 0.0001110346081, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3829954
	speed: 0.0107s/iter; left time: 82.3600s
	iters: 200, epoch: 1 | loss: 1.4559436
	speed: 0.0050s/iter; left time: 38.2667s
	iters: 300, epoch: 1 | loss: 1.1338207
	speed: 0.0055s/iter; left time: 41.1109s
	iters: 400, epoch: 1 | loss: 0.5018870
	speed: 0.0054s/iter; left time: 40.4340s
	iters: 500, epoch: 1 | loss: 0.3829001
	speed: 0.0054s/iter; left time: 39.5621s
	iters: 600, epoch: 1 | loss: 1.8253084
	speed: 0.0054s/iter; left time: 38.9376s
	iters: 700, epoch: 1 | loss: 1.1123265
	speed: 0.0055s/iter; left time: 39.0712s
	iters: 800, epoch: 1 | loss: 0.4951557
	speed: 0.0056s/iter; left time: 39.2747s
	iters: 900, epoch: 1 | loss: 1.4946955
	speed: 0.0056s/iter; left time: 39.0284s
Updating learning rate to 0.00010680860496200096
Validation loss decreased (inf --> 0.6338).  Saving model state dict ...
Epoch: 1 cost time: 5.574343681335449
Epoch: 1, Steps: 979 | Train Loss: 0.9761148 Vali Loss: 0.6337823 Best vali loss: 0.6337823
	iters: 100, epoch: 2 | loss: 0.3261626
	speed: 0.0172s/iter; left time: 115.9261s
	iters: 200, epoch: 2 | loss: 0.3070755
	speed: 0.0047s/iter; left time: 31.2188s
	iters: 300, epoch: 2 | loss: 0.6470470
	speed: 0.0053s/iter; left time: 34.8010s
	iters: 400, epoch: 2 | loss: 1.8967693
	speed: 0.0054s/iter; left time: 34.9906s
	iters: 500, epoch: 2 | loss: 1.0844578
	speed: 0.0053s/iter; left time: 33.4004s
	iters: 600, epoch: 2 | loss: 0.4328159
	speed: 0.0053s/iter; left time: 32.9731s
	iters: 700, epoch: 2 | loss: 0.8181019
	speed: 0.0053s/iter; left time: 32.9197s
	iters: 800, epoch: 2 | loss: 0.3257048
	speed: 0.0053s/iter; left time: 32.3068s
	iters: 900, epoch: 2 | loss: 0.6142921
	speed: 0.0056s/iter; left time: 33.1421s
Updating learning rate to 9.477396621695037e-05
Validation loss decreased (0.6338 --> 0.6175).  Saving model state dict ...
Epoch: 2 cost time: 5.18808913230896
Epoch: 2, Steps: 979 | Train Loss: 0.7169363 Vali Loss: 0.6175011 Best vali loss: 0.6175011
	iters: 100, epoch: 3 | loss: 1.4676725
	speed: 0.0181s/iter; left time: 104.2817s
	iters: 200, epoch: 3 | loss: 1.2981471
	speed: 0.0047s/iter; left time: 26.9414s
	iters: 300, epoch: 3 | loss: 1.1587812
	speed: 0.0053s/iter; left time: 29.3049s
	iters: 400, epoch: 3 | loss: 0.6150934
	speed: 0.0055s/iter; left time: 30.0968s
	iters: 500, epoch: 3 | loss: 1.2743989
	speed: 0.0055s/iter; left time: 29.8063s
	iters: 600, epoch: 3 | loss: 0.3483393
	speed: 0.0054s/iter; left time: 28.5612s
	iters: 700, epoch: 3 | loss: 0.3165815
	speed: 0.0055s/iter; left time: 28.2707s
	iters: 800, epoch: 3 | loss: 1.2280568
	speed: 0.0056s/iter; left time: 28.2493s
	iters: 900, epoch: 3 | loss: 0.7381462
	speed: 0.0054s/iter; left time: 27.0946s
Updating learning rate to 7.67628565195103e-05
Validation loss decreased (0.6175 --> 0.6061).  Saving model state dict ...
Epoch: 3 cost time: 5.311282396316528
Epoch: 3, Steps: 979 | Train Loss: 0.9383574 Vali Loss: 0.6061495 Best vali loss: 0.6061495

best validation loss 0.6061494915036347

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.001857404995, 'e_layers': 3, 'learning_rate': 0.0002113522207, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8439700
	speed: 0.0123s/iter; left time: 6.3610s
Updating learning rate to 2.64190275875e-05
Epoch: 4 cost time: 1.0911002159118652
Epoch: 4, Steps: 123 | Train Loss: 0.8439700 Vali Loss: 0.6005702 Best vali loss: 0.6000478
	iters: 100, epoch: 5 | loss: 0.6780775
	speed: 0.0105s/iter; left time: 4.1149s
Updating learning rate to 1.320951379375e-05
Epoch: 5 cost time: 0.8451011180877686
Epoch: 5, Steps: 123 | Train Loss: 0.6780775 Vali Loss: 0.6005705 Best vali loss: 0.6000478
	iters: 100, epoch: 6 | loss: 0.9230400
	speed: 0.0103s/iter; left time: 2.7677s
Updating learning rate to 6.604756896875e-06
Epoch: 6 cost time: 0.8203949928283691
Epoch: 6, Steps: 123 | Train Loss: 0.9230400 Vali Loss: 0.6046947 Best vali loss: 0.6000478
	iters: 100, epoch: 7 | loss: 0.7855561
	speed: 0.0103s/iter; left time: 1.5121s
Updating learning rate to 3.3023784484375e-06
Epoch: 7 cost time: 0.8584859371185303
Epoch: 7, Steps: 123 | Train Loss: 0.7855561 Vali Loss: 0.6056470 Best vali loss: 0.6000478
	iters: 100, epoch: 8 | loss: 0.8942142
	speed: 0.0103s/iter; left time: 0.2472s
Updating learning rate to 1.65118922421875e-06
Epoch: 8 cost time: 0.8559119701385498
Epoch: 8, Steps: 123 | Train Loss: 0.8942142 Vali Loss: 0.6069573 Best vali loss: 0.6000478

best validation loss 0.6000477614252725

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0014282327355, 'e_layers': 4, 'learning_rate': 0.0011080068437, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0948228
	speed: 0.0128s/iter; left time: 11.3656s
Updating learning rate to 0.0010658358442384311
Validation loss decreased (inf --> 0.5941).  Saving model state dict ...
Epoch: 1 cost time: 1.201357126235962
Epoch: 1, Steps: 123 | Train Loss: 1.0948228 Vali Loss: 0.5941156 Best vali loss: 0.5941156
	iters: 100, epoch: 2 | loss: 0.6916870
	speed: 0.0117s/iter; left time: 8.9119s
Updating learning rate to 0.0009457429982406865
Epoch: 2 cost time: 0.9311425685882568
Epoch: 2, Steps: 123 | Train Loss: 0.6916870 Vali Loss: 0.6182237 Best vali loss: 0.5941156
	iters: 100, epoch: 3 | loss: 0.9523516
	speed: 0.0124s/iter; left time: 7.9182s
Updating learning rate to 0.0007660113528655628
Epoch: 3 cost time: 0.9892044067382812
Epoch: 3, Steps: 123 | Train Loss: 0.9523516 Vali Loss: 0.6235361 Best vali loss: 0.5941156
	iters: 100, epoch: 4 | loss: 0.7373030
	speed: 0.0124s/iter; left time: 6.3867s
Updating learning rate to 0.00055400342185
Validation loss decreased (0.5941 --> 0.5875).  Saving model state dict ...
Epoch: 4 cost time: 0.993084192276001
Epoch: 4, Steps: 123 | Train Loss: 0.7373030 Vali Loss: 0.5875000 Best vali loss: 0.5875000
	iters: 100, epoch: 5 | loss: 0.8025486
	speed: 0.0128s/iter; left time: 5.0445s
Updating learning rate to 0.00034199549083443727
Validation loss decreased (0.5875 --> 0.5650).  Saving model state dict ...
Epoch: 5 cost time: 0.9807682037353516
Epoch: 5, Steps: 123 | Train Loss: 0.8025486 Vali Loss: 0.5650282 Best vali loss: 0.5650282
	iters: 100, epoch: 6 | loss: 0.7292650
	speed: 0.0134s/iter; left time: 3.6047s
Updating learning rate to 0.0001622638454593135
Epoch: 6 cost time: 1.0607309341430664
Epoch: 6, Steps: 123 | Train Loss: 0.7292650 Vali Loss: 0.5785607 Best vali loss: 0.5650282
	iters: 100, epoch: 7 | loss: 0.5901393
	speed: 0.0132s/iter; left time: 1.9382s
Updating learning rate to 4.217099946156882e-05
Epoch: 7 cost time: 1.0443801879882812
Epoch: 7, Steps: 123 | Train Loss: 0.5901393 Vali Loss: 0.5753284 Best vali loss: 0.5650282
	iters: 100, epoch: 8 | loss: 0.6499130
	speed: 0.0132s/iter; left time: 0.3168s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.029834508895874
Epoch: 8, Steps: 123 | Train Loss: 0.6499130 Vali Loss: 0.5746120 Best vali loss: 0.5650282

best validation loss 0.5650281558870883

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0014929082757, 'e_layers': 2, 'learning_rate': 0.0003483819796, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9909011
	speed: 0.0117s/iter; left time: 21.7992s
	iters: 200, epoch: 1 | loss: 0.9046232
	speed: 0.0055s/iter; left time: 9.7457s
Updating learning rate to 0.0003483819796
Validation loss decreased (inf --> 0.6122).  Saving model state dict ...
Epoch: 1 cost time: 1.67283034324646
Epoch: 1, Steps: 245 | Train Loss: 0.9477621 Vali Loss: 0.6121503 Best vali loss: 0.6121503
	iters: 100, epoch: 2 | loss: 1.1320533
	speed: 0.0115s/iter; left time: 18.6138s
	iters: 200, epoch: 2 | loss: 0.5916288
	speed: 0.0056s/iter; left time: 8.4593s
Updating learning rate to 0.0001741909898
Validation loss decreased (0.6122 --> 0.6097).  Saving model state dict ...
Epoch: 2 cost time: 1.4203574657440186
Epoch: 2, Steps: 245 | Train Loss: 0.8618410 Vali Loss: 0.6097173 Best vali loss: 0.6097173
	iters: 100, epoch: 3 | loss: 0.8874843
	speed: 0.0119s/iter; left time: 16.3102s
	iters: 200, epoch: 3 | loss: 1.0728365
	speed: 0.0053s/iter; left time: 6.7410s
Updating learning rate to 8.70954949e-05
Validation loss decreased (0.6097 --> 0.6082).  Saving model state dict ...
Epoch: 3 cost time: 1.3743553161621094
Epoch: 3, Steps: 245 | Train Loss: 0.9801604 Vali Loss: 0.6081897 Best vali loss: 0.6081897
	iters: 100, epoch: 4 | loss: 0.5967556
	speed: 0.0120s/iter; left time: 13.5112s
	iters: 200, epoch: 4 | loss: 0.9073227
	speed: 0.0054s/iter; left time: 5.5686s
Updating learning rate to 4.354774745e-05
Validation loss decreased (0.6082 --> 0.6012).  Saving model state dict ...
Epoch: 4 cost time: 1.394455909729004
Epoch: 4, Steps: 245 | Train Loss: 0.7520392 Vali Loss: 0.6012500 Best vali loss: 0.6012500
	iters: 100, epoch: 5 | loss: 0.6881802
	speed: 0.0115s/iter; left time: 10.0972s
	iters: 200, epoch: 5 | loss: 0.6169781
	speed: 0.0055s/iter; left time: 4.3337s
Updating learning rate to 2.1773873725e-05
Epoch: 5 cost time: 1.3775179386138916
Epoch: 5, Steps: 245 | Train Loss: 0.6525792 Vali Loss: 0.6076532 Best vali loss: 0.6012500
	iters: 100, epoch: 6 | loss: 1.2993798
	speed: 0.0116s/iter; left time: 7.3722s
	iters: 200, epoch: 6 | loss: 0.5610922
	speed: 0.0053s/iter; left time: 2.8399s
Updating learning rate to 1.08869368625e-05
Epoch: 6 cost time: 1.3561203479766846
Epoch: 6, Steps: 245 | Train Loss: 0.9302360 Vali Loss: 0.6066208 Best vali loss: 0.6012500
	iters: 100, epoch: 7 | loss: 0.5026441
	speed: 0.0114s/iter; left time: 4.4404s
	iters: 200, epoch: 7 | loss: 0.8918023
	speed: 0.0056s/iter; left time: 1.6262s
Updating learning rate to 5.44346843125e-06
Epoch: 7 cost time: 1.3255324363708496
Epoch: 7, Steps: 245 | Train Loss: 0.6972232 Vali Loss: 0.6058769 Best vali loss: 0.6012500
	iters: 100, epoch: 8 | loss: 1.0679845
	speed: 0.0116s/iter; left time: 1.6931s
	iters: 200, epoch: 8 | loss: 0.6258791
	speed: 0.0052s/iter; left time: 0.2403s
Updating learning rate to 2.721734215625e-06
Epoch: 8 cost time: 1.3827340602874756
Epoch: 8, Steps: 245 | Train Loss: 0.8469318 Vali Loss: 0.6059099 Best vali loss: 0.6012500

best validation loss 0.6012499581493199

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0034203496068, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7018736
	speed: 0.0107s/iter; left time: 40.9701s
	iters: 200, epoch: 1 | loss: 0.8178669
	speed: 0.0056s/iter; left time: 20.7355s
	iters: 300, epoch: 1 | loss: 0.3982052
	speed: 0.0056s/iter; left time: 20.1274s
	iters: 400, epoch: 1 | loss: 0.9635431
	speed: 0.0056s/iter; left time: 19.6190s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 2.9629838466644287
Epoch: 1, Steps: 490 | Train Loss: 0.7203722 Vali Loss: 0.6141504 Best vali loss: 0.6141504
	iters: 100, epoch: 2 | loss: 0.9625357
	speed: 0.0158s/iter; left time: 52.5112s
	iters: 200, epoch: 2 | loss: 0.7250819
	speed: 0.0057s/iter; left time: 18.2807s
	iters: 300, epoch: 2 | loss: 0.8893214
	speed: 0.0056s/iter; left time: 17.6523s
	iters: 400, epoch: 2 | loss: 0.7351389
	speed: 0.0057s/iter; left time: 17.1453s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.6142 --> 0.5445).  Saving model state dict ...
Epoch: 2 cost time: 2.8179593086242676
Epoch: 2, Steps: 490 | Train Loss: 0.8280195 Vali Loss: 0.5445380 Best vali loss: 0.5445380
	iters: 100, epoch: 3 | loss: 1.2391838
	speed: 0.0160s/iter; left time: 45.5143s
	iters: 200, epoch: 3 | loss: 0.5586537
	speed: 0.0057s/iter; left time: 15.6837s
	iters: 300, epoch: 3 | loss: 0.8395132
	speed: 0.0057s/iter; left time: 15.1428s
	iters: 400, epoch: 3 | loss: 0.5703416
	speed: 0.0053s/iter; left time: 13.5416s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 2.7634482383728027
Epoch: 3, Steps: 490 | Train Loss: 0.8019231 Vali Loss: 0.5599902 Best vali loss: 0.5445380

best validation loss 0.5445380210876465

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0016962635724, 'e_layers': 4, 'learning_rate': 0.0031070450739, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1158230
	speed: 0.0145s/iter; left time: 12.8177s
Updating learning rate to 0.0029887902121331143
Validation loss decreased (inf --> 0.6388).  Saving model state dict ...
Epoch: 1 cost time: 1.3686351776123047
Epoch: 1, Steps: 123 | Train Loss: 1.1158230 Vali Loss: 0.6388230 Best vali loss: 0.6388230
	iters: 100, epoch: 2 | loss: 1.0602636
	speed: 0.0131s/iter; left time: 9.9757s
Updating learning rate to 0.002652028857553474
Epoch: 2 cost time: 1.1046760082244873
Epoch: 2, Steps: 123 | Train Loss: 1.0602636 Vali Loss: 0.6503280 Best vali loss: 0.6388230
	iters: 100, epoch: 3 | loss: 1.1897506
	speed: 0.0132s/iter; left time: 8.4300s
Updating learning rate to 0.002148029873646548
Epoch: 3 cost time: 1.1010189056396484
Epoch: 3, Steps: 123 | Train Loss: 1.1897506 Vali Loss: 0.6466794 Best vali loss: 0.6388230

best validation loss 0.6388229610521668

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0090271357217, 'e_layers': 3, 'learning_rate': 5.47188441e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2980314
	speed: 0.0115s/iter; left time: 21.4875s
	iters: 200, epoch: 1 | loss: 0.8599387
	speed: 0.0053s/iter; left time: 9.3514s
Updating learning rate to 5.263623210333299e-05
Validation loss decreased (inf --> 0.6398).  Saving model state dict ...
Epoch: 1 cost time: 1.638725996017456
Epoch: 1, Steps: 245 | Train Loss: 1.0789851 Vali Loss: 0.6397901 Best vali loss: 0.6397901
	iters: 100, epoch: 2 | loss: 0.7968680
	speed: 0.0111s/iter; left time: 17.9537s
	iters: 200, epoch: 2 | loss: 1.1030412
	speed: 0.0055s/iter; left time: 8.3812s
Updating learning rate to 4.670545491089975e-05
Validation loss decreased (0.6398 --> 0.6188).  Saving model state dict ...
Epoch: 2 cost time: 1.4625582695007324
Epoch: 2, Steps: 245 | Train Loss: 0.9499546 Vali Loss: 0.6188313 Best vali loss: 0.6188313
	iters: 100, epoch: 3 | loss: 0.4753930
	speed: 0.0114s/iter; left time: 15.5804s
	iters: 200, epoch: 3 | loss: 0.7933295
	speed: 0.0055s/iter; left time: 6.9670s
Updating learning rate to 3.7829419587619125e-05
Validation loss decreased (0.6188 --> 0.6080).  Saving model state dict ...
Epoch: 3 cost time: 1.4364771842956543
Epoch: 3, Steps: 245 | Train Loss: 0.6343613 Vali Loss: 0.6079978 Best vali loss: 0.6079978

best validation loss 0.6079977512194127

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0034203496068, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6212327
	speed: 0.0118s/iter; left time: 27.8316s
	iters: 200, epoch: 4 | loss: 0.5695861
	speed: 0.0057s/iter; left time: 12.7340s
	iters: 300, epoch: 4 | loss: 0.3878678
	speed: 0.0056s/iter; left time: 12.0782s
	iters: 400, epoch: 4 | loss: 0.6480927
	speed: 0.0055s/iter; left time: 11.2173s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 2.9729037284851074
Epoch: 4, Steps: 490 | Train Loss: 0.5566948 Vali Loss: 0.5576763 Best vali loss: 0.5445380
	iters: 100, epoch: 5 | loss: 0.8878835
	speed: 0.0143s/iter; left time: 26.5803s
	iters: 200, epoch: 5 | loss: 0.6394258
	speed: 0.0056s/iter; left time: 9.8734s
	iters: 300, epoch: 5 | loss: 0.7314890
	speed: 0.0056s/iter; left time: 9.3333s
	iters: 400, epoch: 5 | loss: 0.7230180
	speed: 0.0056s/iter; left time: 8.7506s
Updating learning rate to 3.3224917040731837e-05
Epoch: 5 cost time: 2.7604029178619385
Epoch: 5, Steps: 490 | Train Loss: 0.7454541 Vali Loss: 0.5486344 Best vali loss: 0.5445380
	iters: 100, epoch: 6 | loss: 1.0905712
	speed: 0.0154s/iter; left time: 21.0859s
	iters: 200, epoch: 6 | loss: 0.4531609
	speed: 0.0056s/iter; left time: 7.1550s
	iters: 300, epoch: 6 | loss: 0.7151189
	speed: 0.0056s/iter; left time: 6.5932s
	iters: 400, epoch: 6 | loss: 0.5274817
	speed: 0.0056s/iter; left time: 6.0390s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 2.8151345252990723
Epoch: 6, Steps: 490 | Train Loss: 0.6965832 Vali Loss: 0.5536306 Best vali loss: 0.5445380
	iters: 100, epoch: 7 | loss: 0.6640743
	speed: 0.0157s/iter; left time: 13.8107s
	iters: 200, epoch: 7 | loss: 0.9247524
	speed: 0.0058s/iter; left time: 4.5679s
	iters: 300, epoch: 7 | loss: 1.0974839
	speed: 0.0059s/iter; left time: 4.0322s
	iters: 400, epoch: 7 | loss: 0.3917064
	speed: 0.0054s/iter; left time: 3.1541s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 2.825592041015625
Epoch: 7, Steps: 490 | Train Loss: 0.7695042 Vali Loss: 0.5530438 Best vali loss: 0.5445380
	iters: 100, epoch: 8 | loss: 0.4271690
	speed: 0.0151s/iter; left time: 5.9022s
	iters: 200, epoch: 8 | loss: 0.9979491
	speed: 0.0056s/iter; left time: 1.6328s
	iters: 300, epoch: 8 | loss: 0.4608457
	speed: 0.0057s/iter; left time: 1.0841s
	iters: 400, epoch: 8 | loss: 0.4912580
	speed: 0.0057s/iter; left time: 0.5148s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.818988561630249
Epoch: 8, Steps: 490 | Train Loss: 0.5943054 Vali Loss: 0.5598945 Best vali loss: 0.5445380

best validation loss 0.5445380210876465

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0062587438156, 'e_layers': 1, 'learning_rate': 0.0016392436863, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8004008
	speed: 0.0098s/iter; left time: 8.6604s
Updating learning rate to 0.0016392436863
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 0.7893495559692383
Epoch: 1, Steps: 123 | Train Loss: 0.8004008 Vali Loss: 0.6032630 Best vali loss: 0.6032630
	iters: 100, epoch: 2 | loss: 0.7577829
	speed: 0.0070s/iter; left time: 5.3700s
Updating learning rate to 0.00081962184315
Epoch: 2 cost time: 0.5376977920532227
Epoch: 2, Steps: 123 | Train Loss: 0.7577829 Vali Loss: 0.6261227 Best vali loss: 0.6032630
	iters: 100, epoch: 3 | loss: 0.6972280
	speed: 0.0072s/iter; left time: 4.5885s
Updating learning rate to 0.000409810921575
Epoch: 3 cost time: 0.5396473407745361
Epoch: 3, Steps: 123 | Train Loss: 0.6972280 Vali Loss: 0.6233308 Best vali loss: 0.6032630
	iters: 100, epoch: 4 | loss: 0.7818965
	speed: 0.0072s/iter; left time: 3.7354s
Updating learning rate to 0.0002049054607875
Epoch: 4 cost time: 0.5431563854217529
Epoch: 4, Steps: 123 | Train Loss: 0.7818965 Vali Loss: 0.6246135 Best vali loss: 0.6032630
	iters: 100, epoch: 5 | loss: 0.8898543
	speed: 0.0070s/iter; left time: 2.7541s
Updating learning rate to 0.00010245273039375
Epoch: 5 cost time: 0.5308136940002441
Epoch: 5, Steps: 123 | Train Loss: 0.8898543 Vali Loss: 0.6258532 Best vali loss: 0.6032630
	iters: 100, epoch: 6 | loss: 0.7367377
	speed: 0.0074s/iter; left time: 1.9946s
Updating learning rate to 5.1226365196875e-05
Epoch: 6 cost time: 0.5579447746276855
Epoch: 6, Steps: 123 | Train Loss: 0.7367377 Vali Loss: 0.6321137 Best vali loss: 0.6032630
	iters: 100, epoch: 7 | loss: 0.8919648
	speed: 0.0070s/iter; left time: 1.0316s
Updating learning rate to 2.56131825984375e-05
Epoch: 7 cost time: 0.5369160175323486
Epoch: 7, Steps: 123 | Train Loss: 0.8919648 Vali Loss: 0.6297504 Best vali loss: 0.6032630
	iters: 100, epoch: 8 | loss: 0.9373116
	speed: 0.0067s/iter; left time: 0.1600s
Updating learning rate to 1.280659129921875e-05
Epoch: 8 cost time: 0.5112123489379883
Epoch: 8, Steps: 123 | Train Loss: 0.9373116 Vali Loss: 0.6326528 Best vali loss: 0.6032630

best validation loss 0.6032630184192119

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010633276881, 'e_layers': 4, 'learning_rate': 0.0001600989607, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9023654
	speed: 0.0138s/iter; left time: 12.2347s
Updating learning rate to 0.00015400555683352943
Validation loss decreased (inf --> 0.6036).  Saving model state dict ...
Epoch: 1 cost time: 1.2858376502990723
Epoch: 1, Steps: 123 | Train Loss: 0.9023654 Vali Loss: 0.6036149 Best vali loss: 0.6036149
	iters: 100, epoch: 2 | loss: 0.8411190
	speed: 0.0122s/iter; left time: 9.2654s
Updating learning rate to 0.0001366530107359443
Validation loss decreased (0.6036 --> 0.6019).  Saving model state dict ...
Epoch: 2 cost time: 1.012010097503662
Epoch: 2, Steps: 123 | Train Loss: 0.8411190 Vali Loss: 0.6018824 Best vali loss: 0.6018824
	iters: 100, epoch: 3 | loss: 0.8255113
	speed: 0.0114s/iter; left time: 7.3029s
Updating learning rate to 0.00011068309024937981
Validation loss decreased (0.6019 --> 0.5454).  Saving model state dict ...
Epoch: 3 cost time: 0.913663387298584
Epoch: 3, Steps: 123 | Train Loss: 0.8255113 Vali Loss: 0.5453532 Best vali loss: 0.5453532
	iters: 100, epoch: 4 | loss: 0.6224390
	speed: 0.0119s/iter; left time: 6.1583s
Updating learning rate to 8.004948035e-05
Validation loss decreased (0.5454 --> 0.5437).  Saving model state dict ...
Epoch: 4 cost time: 0.9948470592498779
Epoch: 4, Steps: 123 | Train Loss: 0.6224390 Vali Loss: 0.5436906 Best vali loss: 0.5436906
	iters: 100, epoch: 5 | loss: 0.8397765
	speed: 0.0122s/iter; left time: 4.7808s
Updating learning rate to 4.94158704506202e-05
Validation loss decreased (0.5437 --> 0.5398).  Saving model state dict ...
Epoch: 5 cost time: 1.0034058094024658
Epoch: 5, Steps: 123 | Train Loss: 0.8397765 Vali Loss: 0.5397638 Best vali loss: 0.5397638
	iters: 100, epoch: 6 | loss: 0.7543806
	speed: 0.0124s/iter; left time: 3.3506s
Updating learning rate to 2.344594996405572e-05
Epoch: 6 cost time: 1.0263698101043701
Epoch: 6, Steps: 123 | Train Loss: 0.7543806 Vali Loss: 0.5410810 Best vali loss: 0.5397638
	iters: 100, epoch: 7 | loss: 0.8918153
	speed: 0.0120s/iter; left time: 1.7670s
Updating learning rate to 6.093403866470566e-06
Epoch: 7 cost time: 1.0088136196136475
Epoch: 7, Steps: 123 | Train Loss: 0.8918153 Vali Loss: 0.5411685 Best vali loss: 0.5397638
	iters: 100, epoch: 8 | loss: 0.6974390
	speed: 0.0119s/iter; left time: 0.2865s
Updating learning rate to 0.0
Validation loss decreased (0.5398 --> 0.5396).  Saving model state dict ...
Epoch: 8 cost time: 1.0008196830749512
Epoch: 8, Steps: 123 | Train Loss: 0.6974390 Vali Loss: 0.5395559 Best vali loss: 0.5395559

best validation loss 0.5395559456159759

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010605591593, 'e_layers': 2, 'learning_rate': 0.0016136112128, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5492768
	speed: 0.0096s/iter; left time: 74.5304s
	iters: 200, epoch: 1 | loss: 0.3543116
	speed: 0.0040s/iter; left time: 30.5390s
	iters: 300, epoch: 1 | loss: 1.1775339
	speed: 0.0040s/iter; left time: 30.1996s
	iters: 400, epoch: 1 | loss: 1.4903400
	speed: 0.0042s/iter; left time: 31.3166s
	iters: 500, epoch: 1 | loss: 0.7188937
	speed: 0.0042s/iter; left time: 30.8812s
	iters: 600, epoch: 1 | loss: 0.6146148
	speed: 0.0042s/iter; left time: 30.3348s
	iters: 700, epoch: 1 | loss: 0.6686530
	speed: 0.0039s/iter; left time: 28.1097s
	iters: 800, epoch: 1 | loss: 1.0214016
	speed: 0.0041s/iter; left time: 28.8131s
	iters: 900, epoch: 1 | loss: 0.6370197
	speed: 0.0042s/iter; left time: 28.8722s
Updating learning rate to 0.0015521967928683173
Validation loss decreased (inf --> 0.6367).  Saving model state dict ...
Epoch: 1 cost time: 4.30375337600708
Epoch: 1, Steps: 979 | Train Loss: 0.8035606 Vali Loss: 0.6367370 Best vali loss: 0.6367370
	iters: 100, epoch: 2 | loss: 0.6515937
	speed: 0.0135s/iter; left time: 91.2343s
	iters: 200, epoch: 2 | loss: 0.6821244
	speed: 0.0034s/iter; left time: 22.6414s
	iters: 300, epoch: 2 | loss: 0.3658210
	speed: 0.0051s/iter; left time: 33.1852s
	iters: 400, epoch: 2 | loss: 0.6727077
	speed: 0.0053s/iter; left time: 34.0668s
	iters: 500, epoch: 2 | loss: 1.3019142
	speed: 0.0053s/iter; left time: 33.6762s
	iters: 600, epoch: 2 | loss: 0.4945051
	speed: 0.0054s/iter; left time: 33.5788s
	iters: 700, epoch: 2 | loss: 1.3037410
	speed: 0.0053s/iter; left time: 32.6079s
	iters: 800, epoch: 2 | loss: 0.3488305
	speed: 0.0049s/iter; left time: 29.6184s
	iters: 900, epoch: 2 | loss: 0.6869292
	speed: 0.0047s/iter; left time: 28.1739s
Updating learning rate to 0.0013773033217847647
Validation loss decreased (0.6367 --> 0.6358).  Saving model state dict ...
Epoch: 2 cost time: 4.751146554946899
Epoch: 2, Steps: 979 | Train Loss: 0.7231296 Vali Loss: 0.6358437 Best vali loss: 0.6358437
	iters: 100, epoch: 3 | loss: 1.0727006
	speed: 0.0185s/iter; left time: 106.5950s
	iters: 200, epoch: 3 | loss: 0.8654051
	speed: 0.0053s/iter; left time: 30.2559s
	iters: 300, epoch: 3 | loss: 0.8010367
	speed: 0.0053s/iter; left time: 29.6890s
	iters: 400, epoch: 3 | loss: 0.9305567
	speed: 0.0046s/iter; left time: 25.0323s
	iters: 500, epoch: 3 | loss: 0.3095289
	speed: 0.0047s/iter; left time: 25.1316s
	iters: 600, epoch: 3 | loss: 1.8759570
	speed: 0.0054s/iter; left time: 28.2861s
	iters: 700, epoch: 3 | loss: 0.3278017
	speed: 0.0054s/iter; left time: 28.0935s
	iters: 800, epoch: 3 | loss: 1.8460946
	speed: 0.0055s/iter; left time: 27.9515s
	iters: 900, epoch: 3 | loss: 1.4523267
	speed: 0.0055s/iter; left time: 27.5422s
Updating learning rate to 0.0011155567451085497
Epoch: 3 cost time: 5.169473648071289
Epoch: 3, Steps: 979 | Train Loss: 1.0534898 Vali Loss: 0.6420811 Best vali loss: 0.6358437

best validation loss 0.6358437019467961

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1083903
	speed: 0.0097s/iter; left time: 74.8348s
	iters: 200, epoch: 1 | loss: 0.3494155
	speed: 0.0035s/iter; left time: 26.9052s
	iters: 300, epoch: 1 | loss: 1.1818756
	speed: 0.0034s/iter; left time: 25.2807s
	iters: 400, epoch: 1 | loss: 0.2713910
	speed: 0.0043s/iter; left time: 32.2025s
	iters: 500, epoch: 1 | loss: 0.7680333
	speed: 0.0040s/iter; left time: 29.4802s
	iters: 600, epoch: 1 | loss: 1.0849720
	speed: 0.0035s/iter; left time: 25.5747s
	iters: 700, epoch: 1 | loss: 1.3649001
	speed: 0.0040s/iter; left time: 28.6048s
	iters: 800, epoch: 1 | loss: 0.9630885
	speed: 0.0040s/iter; left time: 28.2157s
	iters: 900, epoch: 1 | loss: 0.3378367
	speed: 0.0031s/iter; left time: 21.7200s
Updating learning rate to 0.00022273671327002105
Validation loss decreased (inf --> 0.6038).  Saving model state dict ...
Epoch: 1 cost time: 3.871307134628296
Epoch: 1, Steps: 979 | Train Loss: 0.8255448 Vali Loss: 0.6037978 Best vali loss: 0.6037978
	iters: 100, epoch: 2 | loss: 1.2604524
	speed: 0.0095s/iter; left time: 64.4732s
	iters: 200, epoch: 2 | loss: 1.3667989
	speed: 0.0029s/iter; left time: 19.1058s
	iters: 300, epoch: 2 | loss: 0.9119580
	speed: 0.0029s/iter; left time: 18.9530s
	iters: 400, epoch: 2 | loss: 0.6387954
	speed: 0.0027s/iter; left time: 17.5427s
	iters: 500, epoch: 2 | loss: 0.3493186
	speed: 0.0027s/iter; left time: 17.3781s
	iters: 600, epoch: 2 | loss: 1.2068563
	speed: 0.0028s/iter; left time: 17.2250s
	iters: 700, epoch: 2 | loss: 0.8806358
	speed: 0.0028s/iter; left time: 17.0155s
	iters: 800, epoch: 2 | loss: 0.6219897
	speed: 0.0027s/iter; left time: 16.4601s
	iters: 900, epoch: 2 | loss: 0.5185148
	speed: 0.0027s/iter; left time: 16.3426s
Updating learning rate to 0.00019763989751797302
Epoch: 2 cost time: 2.769399642944336
Epoch: 2, Steps: 979 | Train Loss: 0.8617022 Vali Loss: 0.6051797 Best vali loss: 0.6037978
	iters: 100, epoch: 3 | loss: 0.3428228
	speed: 0.0109s/iter; left time: 63.0398s
	iters: 200, epoch: 3 | loss: 0.9522014
	speed: 0.0028s/iter; left time: 15.8764s
	iters: 300, epoch: 3 | loss: 1.1398251
	speed: 0.0028s/iter; left time: 15.7751s
	iters: 400, epoch: 3 | loss: 0.4969712
	speed: 0.0028s/iter; left time: 15.2057s
	iters: 500, epoch: 3 | loss: 0.9871092
	speed: 0.0028s/iter; left time: 14.8606s
	iters: 600, epoch: 3 | loss: 1.0418323
	speed: 0.0028s/iter; left time: 14.5825s
	iters: 700, epoch: 3 | loss: 0.4813253
	speed: 0.0028s/iter; left time: 14.2610s
	iters: 800, epoch: 3 | loss: 0.5709189
	speed: 0.0027s/iter; left time: 13.7765s
	iters: 900, epoch: 3 | loss: 0.6417981
	speed: 0.0026s/iter; left time: 12.9630s
Updating learning rate to 0.00016007985843890398
Validation loss decreased (0.6038 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 2.737185001373291
Epoch: 3, Steps: 979 | Train Loss: 0.7394227 Vali Loss: 0.6031003 Best vali loss: 0.6031003

best validation loss 0.6031002769145851

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9445573
	speed: 0.0106s/iter; left time: 40.6681s
	iters: 200, epoch: 1 | loss: 1.0688475
	speed: 0.0051s/iter; left time: 18.8437s
	iters: 300, epoch: 1 | loss: 0.7976415
	speed: 0.0051s/iter; left time: 18.3651s
	iters: 400, epoch: 1 | loss: 1.1371851
	speed: 0.0050s/iter; left time: 17.7571s
Updating learning rate to 0.0005359963767340445
Validation loss decreased (inf --> 0.6120).  Saving model state dict ...
Epoch: 1 cost time: 2.763641357421875
Epoch: 1, Steps: 490 | Train Loss: 0.9870579 Vali Loss: 0.6120056 Best vali loss: 0.6120056
	iters: 100, epoch: 2 | loss: 0.8344916
	speed: 0.0138s/iter; left time: 46.0507s
	iters: 200, epoch: 2 | loss: 1.3885373
	speed: 0.0051s/iter; left time: 16.3276s
	iters: 300, epoch: 2 | loss: 0.9699014
	speed: 0.0052s/iter; left time: 16.2739s
	iters: 400, epoch: 2 | loss: 0.4591025
	speed: 0.0054s/iter; left time: 16.2902s
Updating learning rate to 0.00047560308946149616
Validation loss decreased (0.6120 --> 0.5830).  Saving model state dict ...
Epoch: 2 cost time: 2.6405370235443115
Epoch: 2, Steps: 490 | Train Loss: 0.9130082 Vali Loss: 0.5829679 Best vali loss: 0.5829679
	iters: 100, epoch: 3 | loss: 0.6223609
	speed: 0.0151s/iter; left time: 42.8633s
	iters: 200, epoch: 3 | loss: 0.7112370
	speed: 0.0053s/iter; left time: 14.5515s
	iters: 300, epoch: 3 | loss: 0.8949140
	speed: 0.0053s/iter; left time: 13.9205s
	iters: 400, epoch: 3 | loss: 0.9010475
	speed: 0.0052s/iter; left time: 13.1887s
Updating learning rate to 0.0003852181477030879
Validation loss decreased (0.5830 --> 0.5747).  Saving model state dict ...
Epoch: 3 cost time: 2.62459659576416
Epoch: 3, Steps: 490 | Train Loss: 0.7823898 Vali Loss: 0.5747153 Best vali loss: 0.5747153

best validation loss 0.5747152695717607

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8500140
	speed: 0.0111s/iter; left time: 25.9801s
	iters: 200, epoch: 4 | loss: 1.0017872
	speed: 0.0051s/iter; left time: 11.5041s
	iters: 300, epoch: 4 | loss: 0.5057563
	speed: 0.0045s/iter; left time: 9.7545s
	iters: 400, epoch: 4 | loss: 1.1174051
	speed: 0.0045s/iter; left time: 9.1643s
Updating learning rate to 0.0002786018395
Validation loss decreased (0.5747 --> 0.5624).  Saving model state dict ...
Epoch: 4 cost time: 2.803893804550171
Epoch: 4, Steps: 490 | Train Loss: 0.8687406 Vali Loss: 0.5623650 Best vali loss: 0.5623650
	iters: 100, epoch: 5 | loss: 0.8062484
	speed: 0.0182s/iter; left time: 33.8712s
	iters: 200, epoch: 5 | loss: 1.1774760
	speed: 0.0062s/iter; left time: 10.8483s
	iters: 300, epoch: 5 | loss: 0.7746432
	speed: 0.0065s/iter; left time: 10.8741s
	iters: 400, epoch: 5 | loss: 0.3508163
	speed: 0.0060s/iter; left time: 9.3418s
Updating learning rate to 0.0001719855312969122
Validation loss decreased (0.5624 --> 0.5555).  Saving model state dict ...
Epoch: 5 cost time: 3.1502740383148193
Epoch: 5, Steps: 490 | Train Loss: 0.7772960 Vali Loss: 0.5554557 Best vali loss: 0.5554557
	iters: 100, epoch: 6 | loss: 0.6004398
	speed: 0.0176s/iter; left time: 24.1157s
	iters: 200, epoch: 6 | loss: 0.6930255
	speed: 0.0047s/iter; left time: 5.9904s
	iters: 300, epoch: 6 | loss: 0.8306412
	speed: 0.0043s/iter; left time: 4.9910s
	iters: 400, epoch: 6 | loss: 0.8431830
	speed: 0.0041s/iter; left time: 4.4305s
Updating learning rate to 8.160058953850389e-05
Epoch: 6 cost time: 2.358938217163086
Epoch: 6, Steps: 490 | Train Loss: 0.7418224 Vali Loss: 0.5581510 Best vali loss: 0.5554557
	iters: 100, epoch: 7 | loss: 0.8248675
	speed: 0.0136s/iter; left time: 11.9456s
	iters: 200, epoch: 7 | loss: 0.5407766
	speed: 0.0071s/iter; left time: 5.5408s
	iters: 300, epoch: 7 | loss: 0.6774193
	speed: 0.0069s/iter; left time: 4.6687s
	iters: 400, epoch: 7 | loss: 0.5499913
	speed: 0.0066s/iter; left time: 3.8581s
Updating learning rate to 2.1207302265955462e-05
Epoch: 7 cost time: 3.331986665725708
Epoch: 7, Steps: 490 | Train Loss: 0.6482637 Vali Loss: 0.5557790 Best vali loss: 0.5554557
	iters: 100, epoch: 8 | loss: 0.6308540
	speed: 0.0182s/iter; left time: 7.1351s
	iters: 200, epoch: 8 | loss: 1.0282664
	speed: 0.0068s/iter; left time: 1.9771s
	iters: 300, epoch: 8 | loss: 0.4420232
	speed: 0.0069s/iter; left time: 1.3174s
	iters: 400, epoch: 8 | loss: 0.6110818
	speed: 0.0067s/iter; left time: 0.6075s
Updating learning rate to 0.0
Validation loss decreased (0.5555 --> 0.5539).  Saving model state dict ...
Epoch: 8 cost time: 3.4014737606048584
Epoch: 8, Steps: 490 | Train Loss: 0.6780563 Vali Loss: 0.5538756 Best vali loss: 0.5538756

best validation loss 0.5538756264229716

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021887918326, 'e_layers': 3, 'learning_rate': 0.0046350312805, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6007995
	speed: 0.0108s/iter; left time: 20.0183s
	iters: 200, epoch: 1 | loss: 0.5387203
	speed: 0.0059s/iter; left time: 10.3338s
Updating learning rate to 0.004458620906551766
Validation loss decreased (inf --> 0.6456).  Saving model state dict ...
Epoch: 1 cost time: 1.6547691822052002
Epoch: 1, Steps: 245 | Train Loss: 0.5697599 Vali Loss: 0.6456231 Best vali loss: 0.6456231
	iters: 100, epoch: 2 | loss: 0.8721285
	speed: 0.0128s/iter; left time: 20.6361s
	iters: 200, epoch: 2 | loss: 0.8915265
	speed: 0.0064s/iter; left time: 9.6862s
Updating learning rate to 0.003956246664976659
Validation loss decreased (0.6456 --> 0.6375).  Saving model state dict ...
Epoch: 2 cost time: 1.5971317291259766
Epoch: 2, Steps: 245 | Train Loss: 0.8818275 Vali Loss: 0.6375169 Best vali loss: 0.6375169
	iters: 100, epoch: 3 | loss: 0.8526794
	speed: 0.0132s/iter; left time: 18.1220s
	iters: 200, epoch: 3 | loss: 0.4973808
	speed: 0.0061s/iter; left time: 7.7980s
Updating learning rate to 0.003204390480020649
Epoch: 3 cost time: 1.5776336193084717
Epoch: 3, Steps: 245 | Train Loss: 0.6750301 Vali Loss: 0.6383558 Best vali loss: 0.6375169
	iters: 100, epoch: 4 | loss: 1.0761721
	speed: 0.0131s/iter; left time: 14.7182s
	iters: 200, epoch: 4 | loss: 1.0746913
	speed: 0.0061s/iter; left time: 6.2411s
Updating learning rate to 0.00231751564025
Validation loss decreased (0.6375 --> 0.6301).  Saving model state dict ...
Epoch: 4 cost time: 1.587944507598877
Epoch: 4, Steps: 245 | Train Loss: 1.0754317 Vali Loss: 0.6301427 Best vali loss: 0.6301427
	iters: 100, epoch: 5 | loss: 0.9218982
	speed: 0.0137s/iter; left time: 12.1042s
	iters: 200, epoch: 5 | loss: 1.1823159
	speed: 0.0063s/iter; left time: 4.9036s
Updating learning rate to 0.0014306408004793516
Epoch: 5 cost time: 1.6159393787384033
Epoch: 5, Steps: 245 | Train Loss: 1.0521071 Vali Loss: 0.6461968 Best vali loss: 0.6301427
	iters: 100, epoch: 6 | loss: 0.8885811
	speed: 0.0129s/iter; left time: 8.2158s
	iters: 200, epoch: 6 | loss: 0.6574931
	speed: 0.0062s/iter; left time: 3.3373s
Updating learning rate to 0.0006787846155233418
Epoch: 6 cost time: 1.5944364070892334
Epoch: 6, Steps: 245 | Train Loss: 0.7730371 Vali Loss: 0.6470028 Best vali loss: 0.6301427
	iters: 100, epoch: 7 | loss: 1.1779199
	speed: 0.0131s/iter; left time: 5.1147s
	iters: 200, epoch: 7 | loss: 0.7536639
	speed: 0.0064s/iter; left time: 1.8491s
Updating learning rate to 0.00017641037394823463
Epoch: 7 cost time: 1.627298355102539
Epoch: 7, Steps: 245 | Train Loss: 0.9657919 Vali Loss: 0.6443181 Best vali loss: 0.6301427
	iters: 100, epoch: 8 | loss: 0.6858463
	speed: 0.0127s/iter; left time: 1.8510s
	iters: 200, epoch: 8 | loss: 1.1009423
	speed: 0.0063s/iter; left time: 0.2903s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5870351791381836
Epoch: 8, Steps: 245 | Train Loss: 0.8933943 Vali Loss: 0.6441550 Best vali loss: 0.6301427

best validation loss 0.6301427091342992

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0011689257956, 'e_layers': 4, 'learning_rate': 0.000133952073, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00012885382579107886
Validation loss decreased (inf --> 0.6685).  Saving model state dict ...
Epoch: 1 cost time: 0.8263616561889648
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6685251 Best vali loss: 0.6685251
Updating learning rate to 0.00011433524608614771
Validation loss decreased (0.6685 --> 0.6426).  Saving model state dict ...
Epoch: 2 cost time: 0.6349682807922363
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6425898 Best vali loss: 0.6425898
Updating learning rate to 9.260665603402952e-05
Validation loss decreased (0.6426 --> 0.6296).  Saving model state dict ...
Epoch: 3 cost time: 0.6122989654541016
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6296176 Best vali loss: 0.6296176
Updating learning rate to 6.69760365e-05
Validation loss decreased (0.6296 --> 0.6244).  Saving model state dict ...
Epoch: 4 cost time: 0.5949292182922363
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6243622 Best vali loss: 0.6243622
Updating learning rate to 4.1345416965970464e-05
Validation loss decreased (0.6244 --> 0.6194).  Saving model state dict ...
Epoch: 5 cost time: 0.655961275100708
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6193590 Best vali loss: 0.6193590
Updating learning rate to 1.9616826913852282e-05
Validation loss decreased (0.6194 --> 0.6171).  Saving model state dict ...
Epoch: 6 cost time: 0.5860259532928467
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6171131 Best vali loss: 0.6171131
Updating learning rate to 5.098247208921122e-06
Validation loss decreased (0.6171 --> 0.6154).  Saving model state dict ...
Epoch: 7 cost time: 0.6262650489807129
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6153983 Best vali loss: 0.6153983
Updating learning rate to 0.0
Validation loss decreased (0.6154 --> 0.6152).  Saving model state dict ...
Epoch: 8 cost time: 0.5955841541290283
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6152488 Best vali loss: 0.6152488

best validation loss 0.6152487612333302

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0019332419074, 'e_layers': 1, 'learning_rate': 0.0002140554312, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.8488649
	speed: 0.0098s/iter; left time: 75.7333s
	iters: 200, epoch: 1 | loss: 0.6438942
	speed: 0.0036s/iter; left time: 27.6176s
	iters: 300, epoch: 1 | loss: 1.0539321
	speed: 0.0048s/iter; left time: 36.4027s
	iters: 400, epoch: 1 | loss: 0.8098349
	speed: 0.0051s/iter; left time: 37.6589s
	iters: 500, epoch: 1 | loss: 1.2704161
	speed: 0.0050s/iter; left time: 36.6143s
	iters: 600, epoch: 1 | loss: 0.5981712
	speed: 0.0049s/iter; left time: 35.1568s
	iters: 700, epoch: 1 | loss: 0.6317828
	speed: 0.0050s/iter; left time: 35.4196s
	iters: 800, epoch: 1 | loss: 0.5891877
	speed: 0.0045s/iter; left time: 31.3712s
	iters: 900, epoch: 1 | loss: 0.6959964
	speed: 0.0037s/iter; left time: 25.6812s
Updating learning rate to 0.0002140554312
Validation loss decreased (inf --> 0.6093).  Saving model state dict ...
Epoch: 1 cost time: 4.547613859176636
Epoch: 1, Steps: 979 | Train Loss: 0.9046756 Vali Loss: 0.6093199 Best vali loss: 0.6093199
	iters: 100, epoch: 2 | loss: 0.5665992
	speed: 0.0089s/iter; left time: 60.2512s
	iters: 200, epoch: 2 | loss: 0.6354406
	speed: 0.0030s/iter; left time: 19.6498s
	iters: 300, epoch: 2 | loss: 0.7239807
	speed: 0.0054s/iter; left time: 35.6014s
	iters: 400, epoch: 2 | loss: 1.3329753
	speed: 0.0048s/iter; left time: 31.2384s
	iters: 500, epoch: 2 | loss: 0.5043523
	speed: 0.0035s/iter; left time: 22.0768s
	iters: 600, epoch: 2 | loss: 1.0983517
	speed: 0.0052s/iter; left time: 32.5556s
	iters: 700, epoch: 2 | loss: 0.3169894
	speed: 0.0051s/iter; left time: 31.4123s
	iters: 800, epoch: 2 | loss: 0.8061420
	speed: 0.0034s/iter; left time: 20.7571s
	iters: 900, epoch: 2 | loss: 1.3501872
	speed: 0.0053s/iter; left time: 31.2785s
Updating learning rate to 0.0001070277156
Validation loss decreased (0.6093 --> 0.6024).  Saving model state dict ...
Epoch: 2 cost time: 4.299464225769043
Epoch: 2, Steps: 979 | Train Loss: 0.8150020 Vali Loss: 0.6023770 Best vali loss: 0.6023770
	iters: 100, epoch: 3 | loss: 0.3995994
	speed: 0.0130s/iter; left time: 74.8033s
	iters: 200, epoch: 3 | loss: 0.9971716
	speed: 0.0024s/iter; left time: 13.5690s
	iters: 300, epoch: 3 | loss: 0.8679834
	speed: 0.0027s/iter; left time: 14.8685s
	iters: 400, epoch: 3 | loss: 0.8475111
	speed: 0.0035s/iter; left time: 19.1074s
	iters: 500, epoch: 3 | loss: 0.9848044
	speed: 0.0034s/iter; left time: 18.4187s
	iters: 600, epoch: 3 | loss: 0.5217587
	speed: 0.0035s/iter; left time: 18.6233s
	iters: 700, epoch: 3 | loss: 0.6584591
	speed: 0.0034s/iter; left time: 17.4596s
	iters: 800, epoch: 3 | loss: 1.6264207
	speed: 0.0035s/iter; left time: 17.5340s
	iters: 900, epoch: 3 | loss: 1.8090017
	speed: 0.0035s/iter; left time: 17.5534s
Updating learning rate to 5.35138578e-05
Validation loss decreased (0.6024 --> 0.5992).  Saving model state dict ...
Epoch: 3 cost time: 3.1387698650360107
Epoch: 3, Steps: 979 | Train Loss: 0.9680789 Vali Loss: 0.5991710 Best vali loss: 0.5991710

best validation loss 0.5991709881403114

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0041151835701, 'e_layers': 1, 'learning_rate': 0.0005937223211, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4110759
	speed: 0.0091s/iter; left time: 70.5604s
	iters: 200, epoch: 1 | loss: 0.2929368
	speed: 0.0033s/iter; left time: 25.4005s
	iters: 300, epoch: 1 | loss: 0.4373371
	speed: 0.0035s/iter; left time: 26.1977s
	iters: 400, epoch: 1 | loss: 0.5880448
	speed: 0.0035s/iter; left time: 26.2997s
	iters: 500, epoch: 1 | loss: 0.8300085
	speed: 0.0032s/iter; left time: 23.3378s
	iters: 600, epoch: 1 | loss: 0.6522180
	speed: 0.0030s/iter; left time: 21.8399s
	iters: 700, epoch: 1 | loss: 0.6358430
	speed: 0.0025s/iter; left time: 18.1306s
	iters: 800, epoch: 1 | loss: 0.8647176
	speed: 0.0025s/iter; left time: 17.5147s
	iters: 900, epoch: 1 | loss: 1.7999651
	speed: 0.0027s/iter; left time: 19.0408s
Updating learning rate to 0.000571125110779692
Validation loss decreased (inf --> 0.6014).  Saving model state dict ...
Epoch: 1 cost time: 3.401858329772949
Epoch: 1, Steps: 979 | Train Loss: 0.7235719 Vali Loss: 0.6014186 Best vali loss: 0.6014186
	iters: 100, epoch: 2 | loss: 0.3228889
	speed: 0.0174s/iter; left time: 117.4798s
	iters: 200, epoch: 2 | loss: 0.7017536
	speed: 0.0048s/iter; left time: 31.7866s
	iters: 300, epoch: 2 | loss: 0.7061684
	speed: 0.0049s/iter; left time: 32.2784s
	iters: 400, epoch: 2 | loss: 1.1826928
	speed: 0.0043s/iter; left time: 27.6857s
	iters: 500, epoch: 2 | loss: 1.0193837
	speed: 0.0035s/iter; left time: 21.9670s
	iters: 600, epoch: 2 | loss: 0.5536742
	speed: 0.0041s/iter; left time: 25.4649s
	iters: 700, epoch: 2 | loss: 0.6834712
	speed: 0.0046s/iter; left time: 28.1025s
	iters: 800, epoch: 2 | loss: 1.3053807
	speed: 0.0047s/iter; left time: 28.5176s
	iters: 900, epoch: 2 | loss: 0.8340812
	speed: 0.0049s/iter; left time: 29.4326s
Updating learning rate to 0.0005067737002458133
Epoch: 2 cost time: 4.520519971847534
Epoch: 2, Steps: 979 | Train Loss: 0.8121661 Vali Loss: 0.6035588 Best vali loss: 0.6014186
	iters: 100, epoch: 3 | loss: 0.4152738
	speed: 0.0160s/iter; left time: 92.5568s
	iters: 200, epoch: 3 | loss: 1.5579309
	speed: 0.0036s/iter; left time: 20.4846s
	iters: 300, epoch: 3 | loss: 1.1887065
	speed: 0.0049s/iter; left time: 27.3481s
	iters: 400, epoch: 3 | loss: 0.8917686
	speed: 0.0052s/iter; left time: 28.3965s
	iters: 500, epoch: 3 | loss: 0.5331450
	speed: 0.0049s/iter; left time: 26.0938s
	iters: 600, epoch: 3 | loss: 0.4468190
	speed: 0.0048s/iter; left time: 25.1834s
	iters: 700, epoch: 3 | loss: 0.8965172
	speed: 0.0048s/iter; left time: 24.9907s
	iters: 800, epoch: 3 | loss: 0.7935120
	speed: 0.0043s/iter; left time: 21.7823s
	iters: 900, epoch: 3 | loss: 0.3661320
	speed: 0.0035s/iter; left time: 17.4517s
Updating learning rate to 0.00041046500840515797
Validation loss decreased (0.6014 --> 0.5949).  Saving model state dict ...
Epoch: 3 cost time: 4.25865626335144
Epoch: 3, Steps: 979 | Train Loss: 0.7877561 Vali Loss: 0.5948512 Best vali loss: 0.5948512

best validation loss 0.5948511712918508

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7149158
	speed: 0.0114s/iter; left time: 21.1541s
	iters: 200, epoch: 1 | loss: 1.0118437
	speed: 0.0050s/iter; left time: 8.7741s
Updating learning rate to 0.000185960463
Validation loss decreased (inf --> 0.6013).  Saving model state dict ...
Epoch: 1 cost time: 1.566145658493042
Epoch: 1, Steps: 245 | Train Loss: 0.8633797 Vali Loss: 0.6013132 Best vali loss: 0.6013132
	iters: 100, epoch: 2 | loss: 0.8344008
	speed: 0.0113s/iter; left time: 18.3001s
	iters: 200, epoch: 2 | loss: 0.8120346
	speed: 0.0047s/iter; left time: 7.0659s
Updating learning rate to 9.29802315e-05
Validation loss decreased (0.6013 --> 0.5970).  Saving model state dict ...
Epoch: 2 cost time: 1.2499744892120361
Epoch: 2, Steps: 245 | Train Loss: 0.8232177 Vali Loss: 0.5970204 Best vali loss: 0.5970204
	iters: 100, epoch: 3 | loss: 0.7326443
	speed: 0.0118s/iter; left time: 16.2242s
	iters: 200, epoch: 3 | loss: 0.6625831
	speed: 0.0050s/iter; left time: 6.4064s
Updating learning rate to 4.649011575e-05
Epoch: 3 cost time: 1.2809829711914062
Epoch: 3, Steps: 245 | Train Loss: 0.6976137 Vali Loss: 0.6088645 Best vali loss: 0.5970204

best validation loss 0.5970204342079074

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0041151835701, 'e_layers': 1, 'learning_rate': 0.0005937223211, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3029208
	speed: 0.0083s/iter; left time: 39.7335s
	iters: 200, epoch: 4 | loss: 0.2816692
	speed: 0.0026s/iter; left time: 11.9924s
	iters: 300, epoch: 4 | loss: 0.4533541
	speed: 0.0034s/iter; left time: 15.7360s
	iters: 400, epoch: 4 | loss: 0.5782951
	speed: 0.0033s/iter; left time: 14.6898s
	iters: 500, epoch: 4 | loss: 0.7951437
	speed: 0.0034s/iter; left time: 14.7336s
	iters: 600, epoch: 4 | loss: 0.6393210
	speed: 0.0039s/iter; left time: 16.7557s
	iters: 700, epoch: 4 | loss: 0.6632043
	speed: 0.0043s/iter; left time: 17.8825s
	iters: 800, epoch: 4 | loss: 0.8469784
	speed: 0.0036s/iter; left time: 14.7248s
	iters: 900, epoch: 4 | loss: 1.7221149
	speed: 0.0038s/iter; left time: 15.2500s
Updating learning rate to 0.00029686116055
Epoch: 4 cost time: 3.6377158164978027
Epoch: 4, Steps: 979 | Train Loss: 0.6981113 Vali Loss: 0.5986296 Best vali loss: 0.5948512
	iters: 100, epoch: 5 | loss: 0.3073332
	speed: 0.0143s/iter; left time: 54.7540s
	iters: 200, epoch: 5 | loss: 0.7015449
	speed: 0.0034s/iter; left time: 12.7399s
	iters: 300, epoch: 5 | loss: 0.6927391
	speed: 0.0032s/iter; left time: 11.5157s
	iters: 400, epoch: 5 | loss: 1.0497442
	speed: 0.0035s/iter; left time: 12.1718s
	iters: 500, epoch: 5 | loss: 0.9788008
	speed: 0.0035s/iter; left time: 12.0815s
	iters: 600, epoch: 5 | loss: 0.5409964
	speed: 0.0031s/iter; left time: 10.4038s
	iters: 700, epoch: 5 | loss: 0.6728461
	speed: 0.0036s/iter; left time: 11.6511s
	iters: 800, epoch: 5 | loss: 1.2878103
	speed: 0.0033s/iter; left time: 10.2752s
	iters: 900, epoch: 5 | loss: 0.8444245
	speed: 0.0034s/iter; left time: 10.2005s
Updating learning rate to 0.00018325731269484204
Epoch: 5 cost time: 3.3977389335632324
Epoch: 5, Steps: 979 | Train Loss: 0.7862488 Vali Loss: 0.6037489 Best vali loss: 0.5948512
	iters: 100, epoch: 6 | loss: 0.4170813
	speed: 0.0121s/iter; left time: 34.3164s
	iters: 200, epoch: 6 | loss: 1.4914718
	speed: 0.0025s/iter; left time: 6.7707s
	iters: 300, epoch: 6 | loss: 1.1543934
	speed: 0.0024s/iter; left time: 6.2747s
	iters: 400, epoch: 6 | loss: 0.4858835
	speed: 0.0043s/iter; left time: 10.8739s
	iters: 500, epoch: 6 | loss: 0.5616152
	speed: 0.0046s/iter; left time: 11.1480s
	iters: 600, epoch: 6 | loss: 0.4412988
	speed: 0.0037s/iter; left time: 8.5910s
	iters: 700, epoch: 6 | loss: 0.8752399
	speed: 0.0042s/iter; left time: 9.4648s
	iters: 800, epoch: 6 | loss: 0.7622599
	speed: 0.0048s/iter; left time: 10.2255s
	iters: 900, epoch: 6 | loss: 0.3571968
	speed: 0.0041s/iter; left time: 8.3961s
Updating learning rate to 8.69486208541866e-05
Epoch: 6 cost time: 3.6131536960601807
Epoch: 6, Steps: 979 | Train Loss: 0.7273823 Vali Loss: 0.6069352 Best vali loss: 0.5948512
	iters: 100, epoch: 7 | loss: 0.7077793
	speed: 0.0170s/iter; left time: 31.5662s
	iters: 200, epoch: 7 | loss: 1.1752452
	speed: 0.0046s/iter; left time: 8.0041s
	iters: 300, epoch: 7 | loss: 1.0416144
	speed: 0.0046s/iter; left time: 7.6955s
	iters: 400, epoch: 7 | loss: 0.9273753
	speed: 0.0033s/iter; left time: 5.0856s
	iters: 500, epoch: 7 | loss: 1.3304168
	speed: 0.0043s/iter; left time: 6.2416s
	iters: 600, epoch: 7 | loss: 1.0438230
	speed: 0.0046s/iter; left time: 6.2747s
	iters: 700, epoch: 7 | loss: 0.7409741
	speed: 0.0040s/iter; left time: 5.0436s
	iters: 800, epoch: 7 | loss: 0.3037286
	speed: 0.0043s/iter; left time: 4.9635s
	iters: 900, epoch: 7 | loss: 0.6988568
	speed: 0.0048s/iter; left time: 5.0624s
Updating learning rate to 2.259721032030796e-05
Epoch: 7 cost time: 4.19417405128479
Epoch: 7, Steps: 979 | Train Loss: 0.8855348 Vali Loss: 0.6222107 Best vali loss: 0.5948512
	iters: 100, epoch: 8 | loss: 0.3915246
	speed: 0.0174s/iter; left time: 15.3154s
	iters: 200, epoch: 8 | loss: 1.4394103
	speed: 0.0042s/iter; left time: 3.3065s
	iters: 300, epoch: 8 | loss: 0.9449100
	speed: 0.0050s/iter; left time: 3.3726s
	iters: 400, epoch: 8 | loss: 0.4718705
	speed: 0.0040s/iter; left time: 2.3023s
	iters: 500, epoch: 8 | loss: 0.8997030
	speed: 0.0026s/iter; left time: 1.2265s
	iters: 600, epoch: 8 | loss: 0.3979311
	speed: 0.0023s/iter; left time: 0.8570s
	iters: 700, epoch: 8 | loss: 1.0624954
	speed: 0.0022s/iter; left time: 0.6112s
	iters: 800, epoch: 8 | loss: 0.3798739
	speed: 0.0026s/iter; left time: 0.4638s
	iters: 900, epoch: 8 | loss: 0.4219814
	speed: 0.0032s/iter; left time: 0.2583s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.3514604568481445
Epoch: 8, Steps: 979 | Train Loss: 0.7121889 Vali Loss: 0.6186554 Best vali loss: 0.5948512

best validation loss 0.5948511712918508

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083070963017, 'e_layers': 1, 'learning_rate': 0.0006773932069, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8907154
	speed: 0.0093s/iter; left time: 17.2499s
	iters: 200, epoch: 1 | loss: 0.5864566
	speed: 0.0036s/iter; left time: 6.4220s
Updating learning rate to 0.0006516114631085467
Validation loss decreased (inf --> 0.6125).  Saving model state dict ...
Epoch: 1 cost time: 1.1973655223846436
Epoch: 1, Steps: 245 | Train Loss: 0.7385860 Vali Loss: 0.6125006 Best vali loss: 0.6125006
	iters: 100, epoch: 2 | loss: 1.0117294
	speed: 0.0081s/iter; left time: 13.0109s
	iters: 200, epoch: 2 | loss: 0.8123025
	speed: 0.0031s/iter; left time: 4.7344s
Updating learning rate to 0.000578191268514346
Validation loss decreased (0.6125 --> 0.6085).  Saving model state dict ...
Epoch: 2 cost time: 0.8683218955993652
Epoch: 2, Steps: 245 | Train Loss: 0.9120159 Vali Loss: 0.6085438 Best vali loss: 0.6085438
	iters: 100, epoch: 3 | loss: 0.9203353
	speed: 0.0075s/iter; left time: 10.2226s
	iters: 200, epoch: 3 | loss: 0.5984121
	speed: 0.0034s/iter; left time: 4.3162s
Updating learning rate to 0.0004683101821886438
Validation loss decreased (0.6085 --> 0.6066).  Saving model state dict ...
Epoch: 3 cost time: 0.8827197551727295
Epoch: 3, Steps: 245 | Train Loss: 0.7593737 Vali Loss: 0.6066327 Best vali loss: 0.6066327
	iters: 100, epoch: 4 | loss: 1.1589845
	speed: 0.0073s/iter; left time: 8.2682s
	iters: 200, epoch: 4 | loss: 0.6821769
	speed: 0.0032s/iter; left time: 3.3132s
Updating learning rate to 0.00033869660345
Epoch: 4 cost time: 0.8605520725250244
Epoch: 4, Steps: 245 | Train Loss: 0.9205807 Vali Loss: 0.6090204 Best vali loss: 0.6066327
	iters: 100, epoch: 5 | loss: 1.1533676
	speed: 0.0079s/iter; left time: 6.9296s
	iters: 200, epoch: 5 | loss: 1.0284170
	speed: 0.0038s/iter; left time: 2.9913s
Updating learning rate to 0.00020908302471135632
Validation loss decreased (0.6066 --> 0.6048).  Saving model state dict ...
Epoch: 5 cost time: 0.9864401817321777
Epoch: 5, Steps: 245 | Train Loss: 1.0908923 Vali Loss: 0.6047919 Best vali loss: 0.6047919
	iters: 100, epoch: 6 | loss: 0.8206382
	speed: 0.0078s/iter; left time: 4.9772s
	iters: 200, epoch: 6 | loss: 0.5479019
	speed: 0.0036s/iter; left time: 1.9536s
Updating learning rate to 9.920193838565403e-05
Epoch: 6 cost time: 0.9208240509033203
Epoch: 6, Steps: 245 | Train Loss: 0.6842701 Vali Loss: 0.6100557 Best vali loss: 0.6047919
	iters: 100, epoch: 7 | loss: 0.6524394
	speed: 0.0072s/iter; left time: 2.8307s
	iters: 200, epoch: 7 | loss: 0.4055225
	speed: 0.0034s/iter; left time: 0.9953s
Updating learning rate to 2.5781743791453334e-05
Epoch: 7 cost time: 0.8547883033752441
Epoch: 7, Steps: 245 | Train Loss: 0.5289809 Vali Loss: 0.6195839 Best vali loss: 0.6047919
	iters: 100, epoch: 8 | loss: 0.6923378
	speed: 0.0074s/iter; left time: 1.0858s
	iters: 200, epoch: 8 | loss: 0.9517770
	speed: 0.0034s/iter; left time: 0.1552s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9012143611907959
Epoch: 8, Steps: 245 | Train Loss: 0.8220574 Vali Loss: 0.6137302 Best vali loss: 0.6047919

best validation loss 0.6047919114007821

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0029408778774, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 9.673369630655839e-05
Validation loss decreased (inf --> 0.6464).  Saving model state dict ...
Epoch: 1 cost time: 0.6195802688598633
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6463830 Best vali loss: 0.6463830
Updating learning rate to 8.583424593046713e-05
Validation loss decreased (0.6464 --> 0.6202).  Saving model state dict ...
Epoch: 2 cost time: 0.4227733612060547
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6201548 Best vali loss: 0.6201548
Updating learning rate to 6.952206568772242e-05
Validation loss decreased (0.6202 --> 0.6105).  Saving model state dict ...
Epoch: 3 cost time: 0.43021297454833984
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6104842 Best vali loss: 0.6104842
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.6105 --> 0.6045).  Saving model state dict ...
Epoch: 4 cost time: 0.4265470504760742
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6044797 Best vali loss: 0.6044797
Updating learning rate to 3.10390086122776e-05
Epoch: 5 cost time: 0.3886075019836426
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6056093 Best vali loss: 0.6044797
Updating learning rate to 1.472682836953288e-05
Validation loss decreased (0.6045 --> 0.6037).  Saving model state dict ...
Epoch: 6 cost time: 0.4360804557800293
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6037299 Best vali loss: 0.6037299
Updating learning rate to 3.827377993441614e-06
Epoch: 7 cost time: 0.431718111038208
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6042926 Best vali loss: 0.6037299
Updating learning rate to 0.0
Epoch: 8 cost time: 0.42209815979003906
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6043045 Best vali loss: 0.6037299

best validation loss 0.6037299477187973

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0114311397825, 'e_layers': 2, 'learning_rate': 0.0007346262927, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007346262927
Validation loss decreased (inf --> 0.6056).  Saving model state dict ...
Epoch: 1 cost time: 0.8754475116729736
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6055711 Best vali loss: 0.6055711
Updating learning rate to 0.00036731314635
Epoch: 2 cost time: 0.6396827697753906
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6176384 Best vali loss: 0.6055711
Updating learning rate to 0.000183656573175
Epoch: 3 cost time: 0.6299371719360352
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6265617 Best vali loss: 0.6055711

best validation loss 0.6055711150886504

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0008016835459, 'e_layers': 1, 'learning_rate': 0.0006601321641, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6822233
	speed: 0.0085s/iter; left time: 32.6671s
	iters: 200, epoch: 1 | loss: 0.5262462
	speed: 0.0030s/iter; left time: 11.3025s
	iters: 300, epoch: 1 | loss: 0.6866074
	speed: 0.0030s/iter; left time: 10.9957s
	iters: 400, epoch: 1 | loss: 0.6905119
	speed: 0.0030s/iter; left time: 10.6937s
Updating learning rate to 0.0006601321641
Validation loss decreased (inf --> 0.6111).  Saving model state dict ...
Epoch: 1 cost time: 1.7680230140686035
Epoch: 1, Steps: 490 | Train Loss: 0.6463972 Vali Loss: 0.6110927 Best vali loss: 0.6110927
	iters: 100, epoch: 2 | loss: 0.8905640
	speed: 0.0096s/iter; left time: 32.0014s
	iters: 200, epoch: 2 | loss: 0.9852291
	speed: 0.0033s/iter; left time: 10.7840s
	iters: 300, epoch: 2 | loss: 0.6775274
	speed: 0.0033s/iter; left time: 10.4803s
	iters: 400, epoch: 2 | loss: 0.5149564
	speed: 0.0033s/iter; left time: 10.1293s
Updating learning rate to 0.00033006608205
Validation loss decreased (0.6111 --> 0.6060).  Saving model state dict ...
Epoch: 2 cost time: 1.6675522327423096
Epoch: 2, Steps: 490 | Train Loss: 0.7670692 Vali Loss: 0.6060015 Best vali loss: 0.6060015
	iters: 100, epoch: 3 | loss: 1.0853469
	speed: 0.0090s/iter; left time: 25.5501s
	iters: 200, epoch: 3 | loss: 0.4599846
	speed: 0.0025s/iter; left time: 6.9555s
	iters: 300, epoch: 3 | loss: 0.4771451
	speed: 0.0026s/iter; left time: 6.8266s
	iters: 400, epoch: 3 | loss: 0.6021197
	speed: 0.0036s/iter; left time: 9.1558s
Updating learning rate to 0.000165033041025
Epoch: 3 cost time: 1.5268840789794922
Epoch: 3, Steps: 490 | Train Loss: 0.6561491 Vali Loss: 0.6101043 Best vali loss: 0.6060015

best validation loss 0.6060014819999582

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0019750620614, 'e_layers': 1, 'learning_rate': 0.0043772257118, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0603694
	speed: 0.0097s/iter; left time: 37.0495s
	iters: 200, epoch: 1 | loss: 0.7039816
	speed: 0.0036s/iter; left time: 13.2200s
	iters: 300, epoch: 1 | loss: 0.7323902
	speed: 0.0036s/iter; left time: 12.9912s
	iters: 400, epoch: 1 | loss: 1.6532463
	speed: 0.0040s/iter; left time: 14.0361s
Updating learning rate to 0.0043772257118
Validation loss decreased (inf --> 0.5929).  Saving model state dict ...
Epoch: 1 cost time: 2.1463022232055664
Epoch: 1, Steps: 490 | Train Loss: 1.0374969 Vali Loss: 0.5928867 Best vali loss: 0.5928867
	iters: 100, epoch: 2 | loss: 1.2383008
	speed: 0.0123s/iter; left time: 41.1204s
	iters: 200, epoch: 2 | loss: 1.1146349
	speed: 0.0036s/iter; left time: 11.6000s
	iters: 300, epoch: 2 | loss: 0.9688928
	speed: 0.0038s/iter; left time: 11.9560s
	iters: 400, epoch: 2 | loss: 0.7485765
	speed: 0.0037s/iter; left time: 11.3595s
Updating learning rate to 0.0021886128559
Epoch: 2 cost time: 1.8420219421386719
Epoch: 2, Steps: 490 | Train Loss: 1.0176012 Vali Loss: 0.6109251 Best vali loss: 0.5928867
	iters: 100, epoch: 3 | loss: 0.4503243
	speed: 0.0116s/iter; left time: 33.0884s
	iters: 200, epoch: 3 | loss: 1.2122035
	speed: 0.0037s/iter; left time: 10.2525s
	iters: 300, epoch: 3 | loss: 1.0124050
	speed: 0.0035s/iter; left time: 9.1790s
	iters: 400, epoch: 3 | loss: 1.0549873
	speed: 0.0037s/iter; left time: 9.4996s
Updating learning rate to 0.00109430642795
Epoch: 3 cost time: 1.8815865516662598
Epoch: 3, Steps: 490 | Train Loss: 0.9324800 Vali Loss: 0.6159274 Best vali loss: 0.5928867

best validation loss 0.592886720912868

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0019750620614, 'e_layers': 1, 'learning_rate': 0.0043772257118, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9727491
	speed: 0.0103s/iter; left time: 24.1380s
	iters: 200, epoch: 4 | loss: 0.6080070
	speed: 0.0025s/iter; left time: 5.6904s
	iters: 300, epoch: 4 | loss: 0.6868340
	speed: 0.0024s/iter; left time: 5.0816s
	iters: 400, epoch: 4 | loss: 1.4016097
	speed: 0.0027s/iter; left time: 5.5976s
Updating learning rate to 0.000547153213975
Epoch: 4 cost time: 1.860011339187622
Epoch: 4, Steps: 490 | Train Loss: 0.9172999 Vali Loss: 0.6237131 Best vali loss: 0.5928867
	iters: 100, epoch: 5 | loss: 0.9601415
	speed: 0.0126s/iter; left time: 23.4240s
	iters: 200, epoch: 5 | loss: 1.1036154
	speed: 0.0035s/iter; left time: 6.1908s
	iters: 300, epoch: 5 | loss: 0.9819822
	speed: 0.0034s/iter; left time: 5.7133s
	iters: 400, epoch: 5 | loss: 0.7388313
	speed: 0.0035s/iter; left time: 5.5274s
Updating learning rate to 0.0002735766069875
Epoch: 5 cost time: 1.8157553672790527
Epoch: 5, Steps: 490 | Train Loss: 0.9461426 Vali Loss: 0.6261367 Best vali loss: 0.5928867
	iters: 100, epoch: 6 | loss: 0.4339699
	speed: 0.0126s/iter; left time: 17.2630s
	iters: 200, epoch: 6 | loss: 1.2229751
	speed: 0.0035s/iter; left time: 4.4012s
	iters: 300, epoch: 6 | loss: 1.0015556
	speed: 0.0036s/iter; left time: 4.1943s
	iters: 400, epoch: 6 | loss: 1.0023401
	speed: 0.0037s/iter; left time: 3.9989s
Updating learning rate to 0.00013678830349375
Epoch: 6 cost time: 1.8878886699676514
Epoch: 6, Steps: 490 | Train Loss: 0.9152102 Vali Loss: 0.6309746 Best vali loss: 0.5928867
	iters: 100, epoch: 7 | loss: 0.8422734
	speed: 0.0120s/iter; left time: 10.5833s
	iters: 200, epoch: 7 | loss: 0.7797191
	speed: 0.0039s/iter; left time: 3.0264s
	iters: 300, epoch: 7 | loss: 0.6705878
	speed: 0.0038s/iter; left time: 2.5903s
	iters: 400, epoch: 7 | loss: 0.8534668
	speed: 0.0039s/iter; left time: 2.2739s
Updating learning rate to 6.8394151746875e-05
Epoch: 7 cost time: 1.935197114944458
Epoch: 7, Steps: 490 | Train Loss: 0.7865117 Vali Loss: 0.6313307 Best vali loss: 0.5928867
	iters: 100, epoch: 8 | loss: 1.2739576
	speed: 0.0124s/iter; left time: 4.8436s
	iters: 200, epoch: 8 | loss: 0.6354536
	speed: 0.0037s/iter; left time: 1.0790s
	iters: 300, epoch: 8 | loss: 0.8513465
	speed: 0.0038s/iter; left time: 0.7320s
	iters: 400, epoch: 8 | loss: 1.1059734
	speed: 0.0037s/iter; left time: 0.3331s
Updating learning rate to 3.41970758734375e-05
Epoch: 8 cost time: 1.9206507205963135
Epoch: 8, Steps: 490 | Train Loss: 0.9666828 Vali Loss: 0.6331199 Best vali loss: 0.5928867

best validation loss 0.592886720912868

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0071994713635, 'e_layers': 3, 'learning_rate': 0.000446018847, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5617842
	speed: 0.0114s/iter; left time: 43.5124s
	iters: 200, epoch: 1 | loss: 0.8469031
	speed: 0.0058s/iter; left time: 21.6799s
	iters: 300, epoch: 1 | loss: 1.3654954
	speed: 0.0057s/iter; left time: 20.4885s
	iters: 400, epoch: 1 | loss: 0.9962555
	speed: 0.0058s/iter; left time: 20.4748s
Updating learning rate to 0.000446018847
Validation loss decreased (inf --> 0.6136).  Saving model state dict ...
Epoch: 1 cost time: 3.145418643951416
Epoch: 1, Steps: 490 | Train Loss: 0.9426095 Vali Loss: 0.6135512 Best vali loss: 0.6135512
	iters: 100, epoch: 2 | loss: 0.5492762
	speed: 0.0165s/iter; left time: 55.0613s
	iters: 200, epoch: 2 | loss: 1.0236658
	speed: 0.0056s/iter; left time: 18.2240s
	iters: 300, epoch: 2 | loss: 0.3653576
	speed: 0.0058s/iter; left time: 18.0846s
	iters: 400, epoch: 2 | loss: 0.8915981
	speed: 0.0058s/iter; left time: 17.4884s
Updating learning rate to 0.0002230094235
Epoch: 2 cost time: 2.854729652404785
Epoch: 2, Steps: 490 | Train Loss: 0.7074744 Vali Loss: 0.6185765 Best vali loss: 0.6135512
	iters: 100, epoch: 3 | loss: 0.8697088
	speed: 0.0144s/iter; left time: 40.8838s
	iters: 200, epoch: 3 | loss: 0.2797782
	speed: 0.0045s/iter; left time: 12.2173s
	iters: 300, epoch: 3 | loss: 0.5489420
	speed: 0.0042s/iter; left time: 11.0159s
	iters: 400, epoch: 3 | loss: 0.5245914
	speed: 0.0041s/iter; left time: 10.5164s
Updating learning rate to 0.00011150471175
Validation loss decreased (0.6136 --> 0.6049).  Saving model state dict ...
Epoch: 3 cost time: 2.3437750339508057
Epoch: 3, Steps: 490 | Train Loss: 0.5557551 Vali Loss: 0.6049418 Best vali loss: 0.6049418
	iters: 100, epoch: 4 | loss: 0.6935551
	speed: 0.0170s/iter; left time: 39.8821s
	iters: 200, epoch: 4 | loss: 0.6043372
	speed: 0.0063s/iter; left time: 14.1433s
	iters: 300, epoch: 4 | loss: 0.5411224
	speed: 0.0062s/iter; left time: 13.3921s
	iters: 400, epoch: 4 | loss: 0.4217495
	speed: 0.0061s/iter; left time: 12.5442s
Updating learning rate to 5.5752355875e-05
Epoch: 4 cost time: 3.0606448650360107
Epoch: 4, Steps: 490 | Train Loss: 0.5651910 Vali Loss: 0.6095596 Best vali loss: 0.6049418
	iters: 100, epoch: 5 | loss: 0.8980632
	speed: 0.0168s/iter; left time: 31.3505s
	iters: 200, epoch: 5 | loss: 0.5984851
	speed: 0.0060s/iter; left time: 10.4959s
	iters: 300, epoch: 5 | loss: 0.8987797
	speed: 0.0060s/iter; left time: 9.9076s
	iters: 400, epoch: 5 | loss: 0.9199595
	speed: 0.0061s/iter; left time: 9.5511s
Updating learning rate to 2.78761779375e-05
Epoch: 5 cost time: 3.0048391819000244
Epoch: 5, Steps: 490 | Train Loss: 0.8288219 Vali Loss: 0.6072385 Best vali loss: 0.6049418
	iters: 100, epoch: 6 | loss: 1.3720993
	speed: 0.0172s/iter; left time: 23.5453s
	iters: 200, epoch: 6 | loss: 0.4628475
	speed: 0.0063s/iter; left time: 8.0632s
	iters: 300, epoch: 6 | loss: 0.8841730
	speed: 0.0059s/iter; left time: 6.9534s
	iters: 400, epoch: 6 | loss: 0.9475420
	speed: 0.0063s/iter; left time: 6.7170s
Updating learning rate to 1.393808896875e-05
Epoch: 6 cost time: 3.08756160736084
Epoch: 6, Steps: 490 | Train Loss: 0.9166654 Vali Loss: 0.6085741 Best vali loss: 0.6049418
	iters: 100, epoch: 7 | loss: 1.2412512
	speed: 0.0174s/iter; left time: 15.3280s
	iters: 200, epoch: 7 | loss: 0.5845200
	speed: 0.0062s/iter; left time: 4.8094s
	iters: 300, epoch: 7 | loss: 0.5817989
	speed: 0.0060s/iter; left time: 4.0714s
	iters: 400, epoch: 7 | loss: 0.5468248
	speed: 0.0060s/iter; left time: 3.4978s
Updating learning rate to 6.969044484375e-06
Epoch: 7 cost time: 3.028859853744507
Epoch: 7, Steps: 490 | Train Loss: 0.7385987 Vali Loss: 0.6093006 Best vali loss: 0.6049418
	iters: 100, epoch: 8 | loss: 0.9877570
	speed: 0.0168s/iter; left time: 6.5571s
	iters: 200, epoch: 8 | loss: 0.7227775
	speed: 0.0041s/iter; left time: 1.1931s
	iters: 300, epoch: 8 | loss: 1.2509300
	speed: 0.0042s/iter; left time: 0.8082s
	iters: 400, epoch: 8 | loss: 0.8973483
	speed: 0.0067s/iter; left time: 0.6064s
Updating learning rate to 3.4845222421875e-06
Epoch: 8 cost time: 2.739184617996216
Epoch: 8, Steps: 490 | Train Loss: 0.9647032 Vali Loss: 0.6092189 Best vali loss: 0.6049418

best validation loss 0.6049417505546721

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029631840606, 'e_layers': 3, 'learning_rate': 7.97883763e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8411911
	speed: 0.0138s/iter; left time: 12.1739s
Updating learning rate to 7.675161204793932e-05
Validation loss decreased (inf --> 0.6138).  Saving model state dict ...
Epoch: 1 cost time: 1.276566505432129
Epoch: 1, Steps: 123 | Train Loss: 0.8411911 Vali Loss: 0.6137592 Best vali loss: 0.6137592
	iters: 100, epoch: 2 | loss: 0.6012311
	speed: 0.0127s/iter; left time: 9.6600s
Updating learning rate to 6.810363912079701e-05
Validation loss decreased (0.6138 --> 0.5997).  Saving model state dict ...
Epoch: 2 cost time: 1.0321495532989502
Epoch: 2, Steps: 123 | Train Loss: 0.6012311 Vali Loss: 0.5997008 Best vali loss: 0.5997008
	iters: 100, epoch: 3 | loss: 0.8751386
	speed: 0.0125s/iter; left time: 8.0006s
Updating learning rate to 5.51610330026607e-05
Epoch: 3 cost time: 0.9835963249206543
Epoch: 3, Steps: 123 | Train Loss: 0.8751386 Vali Loss: 0.6044876 Best vali loss: 0.5997008
	iters: 100, epoch: 4 | loss: 0.8483610
	speed: 0.0090s/iter; left time: 4.6289s
Updating learning rate to 3.989418815e-05
Validation loss decreased (0.5997 --> 0.5957).  Saving model state dict ...
Epoch: 4 cost time: 0.7281310558319092
Epoch: 4, Steps: 123 | Train Loss: 0.8483610 Vali Loss: 0.5956540 Best vali loss: 0.5956540
	iters: 100, epoch: 5 | loss: 0.6523044
	speed: 0.0096s/iter; left time: 3.7550s
Updating learning rate to 2.4627343297339313e-05
Validation loss decreased (0.5957 --> 0.5901).  Saving model state dict ...
Epoch: 5 cost time: 0.7544956207275391
Epoch: 5, Steps: 123 | Train Loss: 0.6523044 Vali Loss: 0.5901410 Best vali loss: 0.5901410
	iters: 100, epoch: 6 | loss: 0.7998018
	speed: 0.0096s/iter; left time: 2.5914s
Updating learning rate to 1.1684737179202996e-05
Validation loss decreased (0.5901 --> 0.5787).  Saving model state dict ...
Epoch: 6 cost time: 0.7880020141601562
Epoch: 6, Steps: 123 | Train Loss: 0.7998018 Vali Loss: 0.5787272 Best vali loss: 0.5787272
	iters: 100, epoch: 7 | loss: 0.6868597
	speed: 0.0100s/iter; left time: 1.4668s
Updating learning rate to 3.036764252060685e-06
Validation loss decreased (0.5787 --> 0.5750).  Saving model state dict ...
Epoch: 7 cost time: 0.8156542778015137
Epoch: 7, Steps: 123 | Train Loss: 0.6868597 Vali Loss: 0.5750302 Best vali loss: 0.5750302
	iters: 100, epoch: 8 | loss: 0.6096151
	speed: 0.0097s/iter; left time: 0.2333s
Updating learning rate to 0.0
Validation loss decreased (0.5750 --> 0.5736).  Saving model state dict ...
Epoch: 8 cost time: 0.7772555351257324
Epoch: 8, Steps: 123 | Train Loss: 0.6096151 Vali Loss: 0.5736069 Best vali loss: 0.5736069

best validation loss 0.5736068770985866

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047463729232, 'e_layers': 4, 'learning_rate': 9.71227879e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4017692
	speed: 0.0128s/iter; left time: 23.8763s
	iters: 200, epoch: 1 | loss: 0.7767213
	speed: 0.0072s/iter; left time: 12.7245s
Updating learning rate to 9.342627189062243e-05
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 2.063516855239868
Epoch: 1, Steps: 245 | Train Loss: 1.0892452 Vali Loss: 0.6035123 Best vali loss: 0.6035123
	iters: 100, epoch: 2 | loss: 1.0264288
	speed: 0.0137s/iter; left time: 22.1356s
	iters: 200, epoch: 2 | loss: 0.7160680
	speed: 0.0070s/iter; left time: 10.6768s
Updating learning rate to 8.289948491591637e-05
Validation loss decreased (0.6035 --> 0.5796).  Saving model state dict ...
Epoch: 2 cost time: 1.7652201652526855
Epoch: 2, Steps: 245 | Train Loss: 0.8712484 Vali Loss: 0.5796377 Best vali loss: 0.5796377
	iters: 100, epoch: 3 | loss: 0.5232074
	speed: 0.0137s/iter; left time: 18.8067s
	iters: 200, epoch: 3 | loss: 0.5385775
	speed: 0.0072s/iter; left time: 9.1319s
Updating learning rate to 6.714503486721931e-05
Validation loss decreased (0.5796 --> 0.5643).  Saving model state dict ...
Epoch: 3 cost time: 1.8031516075134277
Epoch: 3, Steps: 245 | Train Loss: 0.5308925 Vali Loss: 0.5643107 Best vali loss: 0.5643107

best validation loss 0.5643107121821522

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.000356589613, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8411588
	speed: 0.0099s/iter; left time: 8.7192s
Updating learning rate to 0.0003430177289784103
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 0.8086557388305664
Epoch: 1, Steps: 123 | Train Loss: 0.8411588 Vali Loss: 0.6057997 Best vali loss: 0.6057997
	iters: 100, epoch: 2 | loss: 0.8180350
	speed: 0.0072s/iter; left time: 5.4796s
Updating learning rate to 0.0003043682732264933
Epoch: 2 cost time: 0.5246150493621826
Epoch: 2, Steps: 123 | Train Loss: 0.8180350 Vali Loss: 0.6264407 Best vali loss: 0.6057997
	iters: 100, epoch: 3 | loss: 0.8649769
	speed: 0.0071s/iter; left time: 4.5479s
Updating learning rate to 0.0002465252750242895
Validation loss decreased (0.6058 --> 0.5980).  Saving model state dict ...
Epoch: 3 cost time: 0.5269534587860107
Epoch: 3, Steps: 123 | Train Loss: 0.8649769 Vali Loss: 0.5980017 Best vali loss: 0.5980017

best validation loss 0.5980017152940272

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0090271357217, 'e_layers': 2, 'learning_rate': 9.03274957e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2004988
	speed: 0.0095s/iter; left time: 73.7213s
	iters: 200, epoch: 1 | loss: 0.6506956
	speed: 0.0037s/iter; left time: 28.3960s
	iters: 300, epoch: 1 | loss: 1.8783866
	speed: 0.0037s/iter; left time: 28.1195s
	iters: 400, epoch: 1 | loss: 0.2938444
	speed: 0.0036s/iter; left time: 26.7668s
	iters: 500, epoch: 1 | loss: 1.2237824
	speed: 0.0036s/iter; left time: 26.3772s
	iters: 600, epoch: 1 | loss: 0.8594621
	speed: 0.0036s/iter; left time: 26.1616s
	iters: 700, epoch: 1 | loss: 1.4830793
	speed: 0.0038s/iter; left time: 27.3016s
	iters: 800, epoch: 1 | loss: 0.7054592
	speed: 0.0041s/iter; left time: 29.0654s
	iters: 900, epoch: 1 | loss: 0.5183805
	speed: 0.0041s/iter; left time: 28.1815s
Updating learning rate to 9.03274957e-05
Validation loss decreased (inf --> 0.6116).  Saving model state dict ...
Epoch: 1 cost time: 4.014493703842163
Epoch: 1, Steps: 979 | Train Loss: 0.9792877 Vali Loss: 0.6116291 Best vali loss: 0.6116291
	iters: 100, epoch: 2 | loss: 0.7221021
	speed: 0.0137s/iter; left time: 92.2452s
	iters: 200, epoch: 2 | loss: 1.6237631
	speed: 0.0041s/iter; left time: 27.4548s
	iters: 300, epoch: 2 | loss: 1.1667131
	speed: 0.0040s/iter; left time: 26.2710s
	iters: 400, epoch: 2 | loss: 0.3878305
	speed: 0.0041s/iter; left time: 26.7525s
	iters: 500, epoch: 2 | loss: 1.4728036
	speed: 0.0042s/iter; left time: 26.4980s
	iters: 600, epoch: 2 | loss: 0.7214625
	speed: 0.0042s/iter; left time: 26.1615s
	iters: 700, epoch: 2 | loss: 0.2839547
	speed: 0.0041s/iter; left time: 25.1907s
	iters: 800, epoch: 2 | loss: 0.6544815
	speed: 0.0040s/iter; left time: 24.3286s
	iters: 900, epoch: 2 | loss: 0.7789291
	speed: 0.0038s/iter; left time: 22.3633s
Updating learning rate to 4.516374785e-05
Validation loss decreased (0.6116 --> 0.5772).  Saving model state dict ...
Epoch: 2 cost time: 4.011988401412964
Epoch: 2, Steps: 979 | Train Loss: 0.8680045 Vali Loss: 0.5772107 Best vali loss: 0.5772107
	iters: 100, epoch: 3 | loss: 0.6443796
	speed: 0.0130s/iter; left time: 75.1976s
	iters: 200, epoch: 3 | loss: 1.0197499
	speed: 0.0039s/iter; left time: 21.9879s
	iters: 300, epoch: 3 | loss: 1.2608825
	speed: 0.0038s/iter; left time: 21.0802s
	iters: 400, epoch: 3 | loss: 0.3683754
	speed: 0.0038s/iter; left time: 20.7166s
	iters: 500, epoch: 3 | loss: 0.9173939
	speed: 0.0037s/iter; left time: 19.7364s
	iters: 600, epoch: 3 | loss: 0.6650990
	speed: 0.0038s/iter; left time: 20.0451s
	iters: 700, epoch: 3 | loss: 0.6671360
	speed: 0.0037s/iter; left time: 18.9955s
	iters: 800, epoch: 3 | loss: 1.0911034
	speed: 0.0036s/iter; left time: 18.0831s
	iters: 900, epoch: 3 | loss: 0.2675967
	speed: 0.0032s/iter; left time: 15.8745s
Updating learning rate to 2.2581873925e-05
Validation loss decreased (0.5772 --> 0.5705).  Saving model state dict ...
Epoch: 3 cost time: 3.6063284873962402
Epoch: 3, Steps: 979 | Train Loss: 0.7668574 Vali Loss: 0.5705233 Best vali loss: 0.5705233

best validation loss 0.5705232925847524

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047463729232, 'e_layers': 4, 'learning_rate': 9.71227879e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.3286910
	speed: 0.0167s/iter; left time: 18.7583s
	iters: 200, epoch: 4 | loss: 0.6880833
	speed: 0.0094s/iter; left time: 9.6656s
Updating learning rate to 4.856139395e-05
Validation loss decreased (0.5643 --> 0.5484).  Saving model state dict ...
Epoch: 4 cost time: 2.676985502243042
Epoch: 4, Steps: 245 | Train Loss: 1.0083871 Vali Loss: 0.5483614 Best vali loss: 0.5483614
	iters: 100, epoch: 5 | loss: 0.9092787
	speed: 0.0147s/iter; left time: 12.9757s
	iters: 200, epoch: 5 | loss: 0.6567177
	speed: 0.0068s/iter; left time: 5.2792s
Updating learning rate to 2.9977753032780698e-05
Epoch: 5 cost time: 1.6632165908813477
Epoch: 5, Steps: 245 | Train Loss: 0.7829982 Vali Loss: 0.5546761 Best vali loss: 0.5483614
	iters: 100, epoch: 6 | loss: 0.4683880
	speed: 0.0135s/iter; left time: 8.5943s
	iters: 200, epoch: 6 | loss: 0.5099027
	speed: 0.0071s/iter; left time: 3.8079s
Updating learning rate to 1.422330298408362e-05
Epoch: 6 cost time: 1.7926654815673828
Epoch: 6, Steps: 245 | Train Loss: 0.4891453 Vali Loss: 0.5545092 Best vali loss: 0.5483614
	iters: 100, epoch: 7 | loss: 0.9191312
	speed: 0.0132s/iter; left time: 5.1780s
	iters: 200, epoch: 7 | loss: 0.8039584
	speed: 0.0072s/iter; left time: 2.1064s
Updating learning rate to 3.6965160093775718e-06
Epoch: 7 cost time: 1.7886388301849365
Epoch: 7, Steps: 245 | Train Loss: 0.8615448 Vali Loss: 0.5524142 Best vali loss: 0.5483614
	iters: 100, epoch: 8 | loss: 0.6903725
	speed: 0.0127s/iter; left time: 1.8590s
	iters: 200, epoch: 8 | loss: 0.7804127
	speed: 0.0071s/iter; left time: 0.3252s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7328534126281738
Epoch: 8, Steps: 245 | Train Loss: 0.7353926 Vali Loss: 0.5555388 Best vali loss: 0.5483614

best validation loss 0.5483614452345291

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 1, 'learning_rate': 0.0005423807869, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2294273
	speed: 0.0082s/iter; left time: 15.3327s
	iters: 200, epoch: 1 | loss: 0.9471141
	speed: 0.0031s/iter; left time: 5.4599s
Updating learning rate to 0.0005217376473721379
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 1.0687389373779297
Epoch: 1, Steps: 245 | Train Loss: 1.0882707 Vali Loss: 0.6034512 Best vali loss: 0.6034512
	iters: 100, epoch: 2 | loss: 0.8422517
	speed: 0.0073s/iter; left time: 11.7924s
	iters: 200, epoch: 2 | loss: 1.1854398
	speed: 0.0032s/iter; left time: 4.8603s
Updating learning rate to 0.00046295095965114284
Epoch: 2 cost time: 0.8505706787109375
Epoch: 2, Steps: 245 | Train Loss: 1.0138457 Vali Loss: 0.6223872 Best vali loss: 0.6034512
	iters: 100, epoch: 3 | loss: 0.6726044
	speed: 0.0072s/iter; left time: 9.8393s
	iters: 200, epoch: 3 | loss: 0.6855074
	speed: 0.0032s/iter; left time: 4.0426s
Updating learning rate to 0.00037497046403988515
Epoch: 3 cost time: 0.8175258636474609
Epoch: 3, Steps: 245 | Train Loss: 0.6790559 Vali Loss: 0.6333287 Best vali loss: 0.6034512
	iters: 100, epoch: 4 | loss: 0.6348847
	speed: 0.0071s/iter; left time: 8.0299s
	iters: 200, epoch: 4 | loss: 1.0632503
	speed: 0.0032s/iter; left time: 3.2326s
Updating learning rate to 0.00027119039345
Epoch: 4 cost time: 0.828331470489502
Epoch: 4, Steps: 245 | Train Loss: 0.8490675 Vali Loss: 0.6580579 Best vali loss: 0.6034512
	iters: 100, epoch: 5 | loss: 0.7377299
	speed: 0.0071s/iter; left time: 6.2365s
	iters: 200, epoch: 5 | loss: 0.8909523
	speed: 0.0031s/iter; left time: 2.3920s
Updating learning rate to 0.00016741032286011486
Epoch: 5 cost time: 0.8058815002441406
Epoch: 5, Steps: 245 | Train Loss: 0.8143411 Vali Loss: 0.6365696 Best vali loss: 0.6034512
	iters: 100, epoch: 6 | loss: 0.7180670
	speed: 0.0071s/iter; left time: 4.5115s
	iters: 200, epoch: 6 | loss: 1.0131152
	speed: 0.0031s/iter; left time: 1.6684s
Updating learning rate to 7.942982724885713e-05
Epoch: 6 cost time: 0.8177666664123535
Epoch: 6, Steps: 245 | Train Loss: 0.8655911 Vali Loss: 0.6461581 Best vali loss: 0.6034512
	iters: 100, epoch: 7 | loss: 0.8489642
	speed: 0.0071s/iter; left time: 2.7873s
	iters: 200, epoch: 7 | loss: 0.7141476
	speed: 0.0033s/iter; left time: 0.9721s
Updating learning rate to 2.0643139527862082e-05
Epoch: 7 cost time: 0.8444418907165527
Epoch: 7, Steps: 245 | Train Loss: 0.7815559 Vali Loss: 0.6514131 Best vali loss: 0.6034512
	iters: 100, epoch: 8 | loss: 0.7871401
	speed: 0.0072s/iter; left time: 1.0484s
	iters: 200, epoch: 8 | loss: 0.5301831
	speed: 0.0031s/iter; left time: 0.1407s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8086960315704346
Epoch: 8, Steps: 245 | Train Loss: 0.6586616 Vali Loss: 0.6524664 Best vali loss: 0.6034512

best validation loss 0.6034512252842922

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009796137024, 'e_layers': 4, 'learning_rate': 0.0039423373884, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0039423373884
Validation loss decreased (inf --> 0.6440).  Saving model state dict ...
Epoch: 1 cost time: 1.1196701526641846
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6439580 Best vali loss: 0.6439580
Updating learning rate to 0.0019711686942
Epoch: 2 cost time: 0.8414206504821777
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6444377 Best vali loss: 0.6439580
Updating learning rate to 0.0009855843471
Epoch: 3 cost time: 0.761197566986084
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6441730 Best vali loss: 0.6439580
Updating learning rate to 0.00049279217355
Validation loss decreased (0.6440 --> 0.6393).  Saving model state dict ...
Epoch: 4 cost time: 0.8461682796478271
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6392731 Best vali loss: 0.6392731
Updating learning rate to 0.000246396086775
Epoch: 5 cost time: 0.8607122898101807
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6405233 Best vali loss: 0.6392731
Updating learning rate to 0.0001231980433875
Epoch: 6 cost time: 0.8802897930145264
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6423162 Best vali loss: 0.6392731
Updating learning rate to 6.159902169375e-05
Epoch: 7 cost time: 0.8837003707885742
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6405082 Best vali loss: 0.6392731
Updating learning rate to 3.0799510846875e-05
Epoch: 8 cost time: 0.8947148323059082
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6398828 Best vali loss: 0.6392731

best validation loss 0.6392731045143079

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.002325483877, 'e_layers': 3, 'learning_rate': 0.0029565654282, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0860434
	speed: 0.0124s/iter; left time: 47.1986s
	iters: 200, epoch: 1 | loss: 0.9844730
	speed: 0.0061s/iter; left time: 22.8637s
	iters: 300, epoch: 1 | loss: 1.9127977
	speed: 0.0067s/iter; left time: 24.3644s
	iters: 400, epoch: 1 | loss: 1.6162084
	speed: 0.0062s/iter; left time: 21.8540s
Updating learning rate to 0.0029565654282
Validation loss decreased (inf --> 0.6312).  Saving model state dict ...
Epoch: 1 cost time: 3.3901774883270264
Epoch: 1, Steps: 490 | Train Loss: 1.3998806 Vali Loss: 0.6311892 Best vali loss: 0.6311892
	iters: 100, epoch: 2 | loss: 1.3426504
	speed: 0.0178s/iter; left time: 59.2794s
	iters: 200, epoch: 2 | loss: 0.5644584
	speed: 0.0062s/iter; left time: 19.9862s
	iters: 300, epoch: 2 | loss: 0.3990527
	speed: 0.0061s/iter; left time: 19.1438s
	iters: 400, epoch: 2 | loss: 0.5009835
	speed: 0.0058s/iter; left time: 17.4733s
Updating learning rate to 0.0014782827141
Epoch: 2 cost time: 2.8857579231262207
Epoch: 2, Steps: 490 | Train Loss: 0.7017863 Vali Loss: 0.6496220 Best vali loss: 0.6311892
	iters: 100, epoch: 3 | loss: 1.2209870
	speed: 0.0139s/iter; left time: 39.5804s
	iters: 200, epoch: 3 | loss: 1.6506817
	speed: 0.0063s/iter; left time: 17.2343s
	iters: 300, epoch: 3 | loss: 0.7887529
	speed: 0.0063s/iter; left time: 16.6779s
	iters: 400, epoch: 3 | loss: 1.0277628
	speed: 0.0064s/iter; left time: 16.3388s
Updating learning rate to 0.00073914135705
Epoch: 3 cost time: 3.1561620235443115
Epoch: 3, Steps: 490 | Train Loss: 1.1720461 Vali Loss: 0.6481936 Best vali loss: 0.6311892

best validation loss 0.6311891578734334

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0084343460894, 'e_layers': 3, 'learning_rate': 0.0011030524514, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3106384
	speed: 0.0109s/iter; left time: 83.9853s
	iters: 200, epoch: 1 | loss: 0.9876333
	speed: 0.0043s/iter; left time: 32.8127s
	iters: 300, epoch: 1 | loss: 1.4950176
	speed: 0.0039s/iter; left time: 29.7187s
	iters: 400, epoch: 1 | loss: 1.2480036
	speed: 0.0040s/iter; left time: 29.7287s
	iters: 500, epoch: 1 | loss: 1.2804047
	speed: 0.0042s/iter; left time: 31.0166s
	iters: 600, epoch: 1 | loss: 0.5577434
	speed: 0.0071s/iter; left time: 51.6373s
	iters: 700, epoch: 1 | loss: 0.4371489
	speed: 0.0079s/iter; left time: 56.5468s
	iters: 800, epoch: 1 | loss: 0.9463590
	speed: 0.0072s/iter; left time: 50.5039s
	iters: 900, epoch: 1 | loss: 1.0244501
	speed: 0.0069s/iter; left time: 47.5301s
Updating learning rate to 0.0011030524514
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 5.657803297042847
Epoch: 1, Steps: 979 | Train Loss: 0.9208221 Vali Loss: 0.6174111 Best vali loss: 0.6174111
	iters: 100, epoch: 2 | loss: 0.8594901
	speed: 0.0153s/iter; left time: 103.0806s
	iters: 200, epoch: 2 | loss: 0.7748568
	speed: 0.0058s/iter; left time: 38.6262s
	iters: 300, epoch: 2 | loss: 0.5760474
	speed: 0.0057s/iter; left time: 37.0555s
	iters: 400, epoch: 2 | loss: 0.8013737
	speed: 0.0061s/iter; left time: 39.1886s
	iters: 500, epoch: 2 | loss: 1.3599763
	speed: 0.0059s/iter; left time: 37.3417s
	iters: 600, epoch: 2 | loss: 0.9922358
	speed: 0.0061s/iter; left time: 38.0691s
	iters: 700, epoch: 2 | loss: 0.5376178
	speed: 0.0057s/iter; left time: 35.2536s
	iters: 800, epoch: 2 | loss: 0.5782864
	speed: 0.0054s/iter; left time: 32.6029s
	iters: 900, epoch: 2 | loss: 1.0806420
	speed: 0.0059s/iter; left time: 35.1431s
Updating learning rate to 0.0005515262257
Validation loss decreased (0.6174 --> 0.6101).  Saving model state dict ...
Epoch: 2 cost time: 5.738178730010986
Epoch: 2, Steps: 979 | Train Loss: 0.8400585 Vali Loss: 0.6101308 Best vali loss: 0.6101308
	iters: 100, epoch: 3 | loss: 0.6503636
	speed: 0.0178s/iter; left time: 102.7260s
	iters: 200, epoch: 3 | loss: 0.5299902
	speed: 0.0040s/iter; left time: 22.9738s
	iters: 300, epoch: 3 | loss: 0.3538290
	speed: 0.0061s/iter; left time: 34.1456s
	iters: 400, epoch: 3 | loss: 0.5310232
	speed: 0.0057s/iter; left time: 31.4684s
	iters: 500, epoch: 3 | loss: 0.5937962
	speed: 0.0057s/iter; left time: 30.4474s
	iters: 600, epoch: 3 | loss: 0.5634037
	speed: 0.0054s/iter; left time: 28.5906s
	iters: 700, epoch: 3 | loss: 0.9935764
	speed: 0.0054s/iter; left time: 28.0033s
	iters: 800, epoch: 3 | loss: 1.4975988
	speed: 0.0059s/iter; left time: 29.8406s
	iters: 900, epoch: 3 | loss: 0.8368250
	speed: 0.0056s/iter; left time: 28.0982s
Updating learning rate to 0.00027576311285
Epoch: 3 cost time: 5.292582750320435
Epoch: 3, Steps: 979 | Train Loss: 0.7278229 Vali Loss: 0.6163251 Best vali loss: 0.6101308

best validation loss 0.6101308484035529

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050872293761, 'e_layers': 4, 'learning_rate': 0.0001304544179, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2281010
	speed: 0.0140s/iter; left time: 12.4072s
Updating learning rate to 0.000125489292261742
Validation loss decreased (inf --> 0.6162).  Saving model state dict ...
Epoch: 1 cost time: 1.2616512775421143
Epoch: 1, Steps: 123 | Train Loss: 1.2281010 Vali Loss: 0.6162328 Best vali loss: 0.6162328
	iters: 100, epoch: 2 | loss: 0.7483175
	speed: 0.0135s/iter; left time: 10.3074s
Updating learning rate to 0.00011134981071641684
Validation loss decreased (0.6162 --> 0.6067).  Saving model state dict ...
Epoch: 2 cost time: 1.245133876800537
Epoch: 2, Steps: 123 | Train Loss: 0.7483175 Vali Loss: 0.6067202 Best vali loss: 0.6067202
	iters: 100, epoch: 3 | loss: 0.9726285
	speed: 0.0182s/iter; left time: 11.6042s
Updating learning rate to 9.01885811545809e-05
Validation loss decreased (0.6067 --> 0.6018).  Saving model state dict ...
Epoch: 3 cost time: 1.4681484699249268
Epoch: 3, Steps: 123 | Train Loss: 0.9726285 Vali Loss: 0.6018460 Best vali loss: 0.6018460

best validation loss 0.6018460469354032

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050872293761, 'e_layers': 4, 'learning_rate': 0.0001304544179, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1648185
	speed: 0.0142s/iter; left time: 7.3426s
Updating learning rate to 6.522720895e-05
Validation loss decreased (0.6018 --> 0.5949).  Saving model state dict ...
Epoch: 4 cost time: 1.1618163585662842
Epoch: 4, Steps: 123 | Train Loss: 1.1648185 Vali Loss: 0.5948761 Best vali loss: 0.5948761
	iters: 100, epoch: 5 | loss: 0.7066102
	speed: 0.0114s/iter; left time: 4.4866s
Updating learning rate to 4.0265836745419096e-05
Validation loss decreased (0.5949 --> 0.5930).  Saving model state dict ...
Epoch: 5 cost time: 0.9783401489257812
Epoch: 5, Steps: 123 | Train Loss: 0.7066102 Vali Loss: 0.5929923 Best vali loss: 0.5929923
	iters: 100, epoch: 6 | loss: 0.8866385
	speed: 0.0124s/iter; left time: 3.3447s
Updating learning rate to 1.910460718358314e-05
Epoch: 6 cost time: 1.0129709243774414
Epoch: 6, Steps: 123 | Train Loss: 0.8866385 Vali Loss: 0.5985792 Best vali loss: 0.5929923
	iters: 100, epoch: 7 | loss: 0.6280163
	speed: 0.0120s/iter; left time: 1.7582s
Updating learning rate to 4.965125638257981e-06
Epoch: 7 cost time: 0.9674673080444336
Epoch: 7, Steps: 123 | Train Loss: 0.6280163 Vali Loss: 0.5944251 Best vali loss: 0.5929923
	iters: 100, epoch: 8 | loss: 0.9391516
	speed: 0.0130s/iter; left time: 0.3122s
Updating learning rate to 0.0
Validation loss decreased (0.5930 --> 0.5927).  Saving model state dict ...
Epoch: 8 cost time: 1.059340000152588
Epoch: 8, Steps: 123 | Train Loss: 0.9391516 Vali Loss: 0.5926827 Best vali loss: 0.5926827

best validation loss 0.5926827148175361

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0018333163825, 'e_layers': 2, 'learning_rate': 0.0006860415015, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9268743
	speed: 0.0126s/iter; left time: 23.5257s
	iters: 200, epoch: 1 | loss: 0.9712946
	speed: 0.0065s/iter; left time: 11.4930s
Updating learning rate to 0.0006860415015
Validation loss decreased (inf --> 0.6415).  Saving model state dict ...
Epoch: 1 cost time: 1.9091978073120117
Epoch: 1, Steps: 245 | Train Loss: 0.9490844 Vali Loss: 0.6414727 Best vali loss: 0.6414727
	iters: 100, epoch: 2 | loss: 0.4508176
	speed: 0.0134s/iter; left time: 21.6117s
	iters: 200, epoch: 2 | loss: 1.1425214
	speed: 0.0069s/iter; left time: 10.5215s
Updating learning rate to 0.00034302075075
Validation loss decreased (0.6415 --> 0.6331).  Saving model state dict ...
Epoch: 2 cost time: 1.7032442092895508
Epoch: 2, Steps: 245 | Train Loss: 0.7966695 Vali Loss: 0.6330665 Best vali loss: 0.6330665
	iters: 100, epoch: 3 | loss: 0.7689642
	speed: 0.0137s/iter; left time: 18.8421s
	iters: 200, epoch: 3 | loss: 0.5203838
	speed: 0.0064s/iter; left time: 8.1460s
Updating learning rate to 0.000171510375375
Validation loss decreased (0.6331 --> 0.6097).  Saving model state dict ...
Epoch: 3 cost time: 1.6902172565460205
Epoch: 3, Steps: 245 | Train Loss: 0.6446740 Vali Loss: 0.6097492 Best vali loss: 0.6097492
	iters: 100, epoch: 4 | loss: 0.7506053
	speed: 0.0141s/iter; left time: 15.8936s
	iters: 200, epoch: 4 | loss: 1.0588304
	speed: 0.0068s/iter; left time: 6.9803s
Updating learning rate to 8.57551876875e-05
Epoch: 4 cost time: 1.6902453899383545
Epoch: 4, Steps: 245 | Train Loss: 0.9047179 Vali Loss: 0.6100428 Best vali loss: 0.6097492
	iters: 100, epoch: 5 | loss: 0.9340905
	speed: 0.0134s/iter; left time: 11.7914s
	iters: 200, epoch: 5 | loss: 0.7400083
	speed: 0.0064s/iter; left time: 5.0254s
Updating learning rate to 4.287759384375e-05
Epoch: 5 cost time: 1.6439166069030762
Epoch: 5, Steps: 245 | Train Loss: 0.8370494 Vali Loss: 0.6449494 Best vali loss: 0.6097492
	iters: 100, epoch: 6 | loss: 1.0840895
	speed: 0.0138s/iter; left time: 8.7802s
	iters: 200, epoch: 6 | loss: 0.6788372
	speed: 0.0066s/iter; left time: 3.5624s
Updating learning rate to 2.1438796921875e-05
Epoch: 6 cost time: 1.706861972808838
Epoch: 6, Steps: 245 | Train Loss: 0.8814633 Vali Loss: 0.6639000 Best vali loss: 0.6097492
	iters: 100, epoch: 7 | loss: 0.5971710
	speed: 0.0134s/iter; left time: 5.2204s
	iters: 200, epoch: 7 | loss: 0.4751066
	speed: 0.0067s/iter; left time: 1.9492s
Updating learning rate to 1.07193984609375e-05
Epoch: 7 cost time: 1.6598811149597168
Epoch: 7, Steps: 245 | Train Loss: 0.5361388 Vali Loss: 0.6667567 Best vali loss: 0.6097492
	iters: 100, epoch: 8 | loss: 0.4536031
	speed: 0.0135s/iter; left time: 1.9708s
	iters: 200, epoch: 8 | loss: 0.5077258
	speed: 0.0067s/iter; left time: 0.3102s
Updating learning rate to 5.35969923046875e-06
Epoch: 8 cost time: 1.6676356792449951
Epoch: 8, Steps: 245 | Train Loss: 0.4806644 Vali Loss: 0.6581470 Best vali loss: 0.6097492

best validation loss 0.6097491604484159

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008179554336, 'e_layers': 1, 'learning_rate': 0.0022030201293, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.002119172668235319
Validation loss decreased (inf --> 0.6057).  Saving model state dict ...
Epoch: 1 cost time: 0.8446176052093506
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6056560 Best vali loss: 0.6056560
Updating learning rate to 0.0018803953009092472
Validation loss decreased (0.6057 --> 0.6049).  Saving model state dict ...
Epoch: 2 cost time: 0.522479772567749
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6048980 Best vali loss: 0.6048980
Updating learning rate to 0.001523039716974954
Epoch: 3 cost time: 0.49251651763916016
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6153347 Best vali loss: 0.6048980
Updating learning rate to 0.00110151006465
Epoch: 4 cost time: 0.49677610397338867
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6190767 Best vali loss: 0.6048980
Updating learning rate to 0.0006799804123250461
Epoch: 5 cost time: 0.4764835834503174
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6332057 Best vali loss: 0.6048980
Updating learning rate to 0.0003226248283907527
Epoch: 6 cost time: 0.509589433670044
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6382485 Best vali loss: 0.6048980
Updating learning rate to 8.384746106468076e-05
Epoch: 7 cost time: 0.5983400344848633
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6343299 Best vali loss: 0.6048980
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5252678394317627
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6389610 Best vali loss: 0.6048980

best validation loss 0.6048979513185104

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1303405
	speed: 0.0116s/iter; left time: 21.6589s
	iters: 200, epoch: 1 | loss: 0.7854033
	speed: 0.0079s/iter; left time: 13.9991s
Updating learning rate to 8.666273256609723e-05
Validation loss decreased (inf --> 0.6249).  Saving model state dict ...
Epoch: 1 cost time: 2.020341157913208
Epoch: 1, Steps: 245 | Train Loss: 0.9578719 Vali Loss: 0.6249427 Best vali loss: 0.6249427
	iters: 100, epoch: 2 | loss: 0.6049244
	speed: 0.0149s/iter; left time: 24.1507s
	iters: 200, epoch: 2 | loss: 0.7866678
	speed: 0.0075s/iter; left time: 11.4294s
Updating learning rate to 7.689802606643869e-05
Validation loss decreased (0.6249 --> 0.6092).  Saving model state dict ...
Epoch: 2 cost time: 1.9097349643707275
Epoch: 2, Steps: 245 | Train Loss: 0.6957961 Vali Loss: 0.6091963 Best vali loss: 0.6091963
	iters: 100, epoch: 3 | loss: 1.4417483
	speed: 0.0158s/iter; left time: 21.6244s
	iters: 200, epoch: 3 | loss: 0.6485838
	speed: 0.0077s/iter; left time: 9.7327s
Updating learning rate to 6.228411004831259e-05
Validation loss decreased (0.6092 --> 0.6011).  Saving model state dict ...
Epoch: 3 cost time: 1.9860918521881104
Epoch: 3, Steps: 245 | Train Loss: 1.0451660 Vali Loss: 0.6011249 Best vali loss: 0.6011249

best validation loss 0.6011248728512946

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061161357241, 'e_layers': 4, 'learning_rate': 0.0038059297724, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5953954
	speed: 0.0135s/iter; left time: 104.5248s
	iters: 200, epoch: 1 | loss: 0.4348555
	speed: 0.0074s/iter; left time: 56.2890s
	iters: 300, epoch: 1 | loss: 0.9837238
	speed: 0.0073s/iter; left time: 54.7199s
	iters: 400, epoch: 1 | loss: 0.5805345
	speed: 0.0058s/iter; left time: 42.9184s
	iters: 500, epoch: 1 | loss: 1.0770334
	speed: 0.0051s/iter; left time: 37.7312s
	iters: 600, epoch: 1 | loss: 0.4441791
	speed: 0.0083s/iter; left time: 59.9742s
	iters: 700, epoch: 1 | loss: 0.7950681
	speed: 0.0083s/iter; left time: 59.4309s
	iters: 800, epoch: 1 | loss: 0.3141740
	speed: 0.0082s/iter; left time: 57.3513s
	iters: 900, epoch: 1 | loss: 0.5108362
	speed: 0.0078s/iter; left time: 54.0188s
Updating learning rate to 0.0036610751956478497
Validation loss decreased (inf --> 0.6527).  Saving model state dict ...
Epoch: 1 cost time: 7.567723512649536
Epoch: 1, Steps: 979 | Train Loss: 0.6373111 Vali Loss: 0.6526547 Best vali loss: 0.6526547
	iters: 100, epoch: 2 | loss: 0.7846900
	speed: 0.0271s/iter; left time: 182.7885s
	iters: 200, epoch: 2 | loss: 1.0086248
	speed: 0.0087s/iter; left time: 57.6119s
	iters: 300, epoch: 2 | loss: 0.8623499
	speed: 0.0081s/iter; left time: 53.3036s
	iters: 400, epoch: 2 | loss: 0.3250172
	speed: 0.0053s/iter; left time: 34.3538s
	iters: 500, epoch: 2 | loss: 1.4551601
	speed: 0.0051s/iter; left time: 32.6482s
	iters: 600, epoch: 2 | loss: 0.9802828
	speed: 0.0095s/iter; left time: 59.3696s
	iters: 700, epoch: 2 | loss: 0.5428954
	speed: 0.0095s/iter; left time: 58.2278s
	iters: 800, epoch: 2 | loss: 0.9133534
	speed: 0.0067s/iter; left time: 40.5789s
	iters: 900, epoch: 2 | loss: 1.0580435
	speed: 0.0051s/iter; left time: 30.6564s
Updating learning rate to 0.0032485642615919063
Validation loss decreased (0.6527 --> 0.6294).  Saving model state dict ...
Epoch: 2 cost time: 7.210350275039673
Epoch: 2, Steps: 979 | Train Loss: 0.8811575 Vali Loss: 0.6294026 Best vali loss: 0.6294026
	iters: 100, epoch: 3 | loss: 0.4198442
	speed: 0.0214s/iter; left time: 123.5699s
	iters: 200, epoch: 3 | loss: 0.5940109
	speed: 0.0066s/iter; left time: 37.6973s
	iters: 300, epoch: 3 | loss: 1.4560031
	speed: 0.0065s/iter; left time: 36.4322s
	iters: 400, epoch: 3 | loss: 0.6652514
	speed: 0.0066s/iter; left time: 36.1273s
	iters: 500, epoch: 3 | loss: 0.6956378
	speed: 0.0060s/iter; left time: 32.1949s
	iters: 600, epoch: 3 | loss: 1.1314349
	speed: 0.0062s/iter; left time: 32.6267s
	iters: 700, epoch: 3 | loss: 0.4231937
	speed: 0.0067s/iter; left time: 34.4309s
	iters: 800, epoch: 3 | loss: 1.1434908
	speed: 0.0066s/iter; left time: 33.5590s
	iters: 900, epoch: 3 | loss: 0.4714591
	speed: 0.0067s/iter; left time: 33.4532s
Updating learning rate to 0.0026311980205212587
Epoch: 3 cost time: 6.4290876388549805
Epoch: 3, Steps: 979 | Train Loss: 0.7778140 Vali Loss: 0.6686930 Best vali loss: 0.6294026

best validation loss 0.6294025680302802

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0092252495316, 'e_layers': 4, 'learning_rate': 0.0006913977983, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8129606
	speed: 0.0128s/iter; left time: 11.3613s
Updating learning rate to 0.0006650830364863684
Validation loss decreased (inf --> 0.6079).  Saving model state dict ...
Epoch: 1 cost time: 1.1825101375579834
Epoch: 1, Steps: 123 | Train Loss: 0.8129606 Vali Loss: 0.6079032 Best vali loss: 0.6079032
	iters: 100, epoch: 2 | loss: 0.7905901
	speed: 0.0111s/iter; left time: 8.4759s
Updating learning rate to 0.0005901449349876894
Epoch: 2 cost time: 0.925302267074585
Epoch: 2, Steps: 123 | Train Loss: 0.7905901 Vali Loss: 0.6121147 Best vali loss: 0.6079032
	iters: 100, epoch: 3 | loss: 0.7012222
	speed: 0.0116s/iter; left time: 7.4279s
Updating learning rate to 0.000477992140441555
Validation loss decreased (0.6079 --> 0.5650).  Saving model state dict ...
Epoch: 3 cost time: 0.993523120880127
Epoch: 3, Steps: 123 | Train Loss: 0.7012222 Vali Loss: 0.5650005 Best vali loss: 0.5650005

best validation loss 0.5650004606619856

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0092252495316, 'e_layers': 4, 'learning_rate': 0.0006913977983, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7213573
	speed: 0.0126s/iter; left time: 6.5216s
Updating learning rate to 0.00034569889915
Epoch: 4 cost time: 1.1068480014801025
Epoch: 4, Steps: 123 | Train Loss: 0.7213573 Vali Loss: 0.5677301 Best vali loss: 0.5650005
	iters: 100, epoch: 5 | loss: 0.7583241
	speed: 0.0101s/iter; left time: 3.9592s
Updating learning rate to 0.00021340565785844497
Validation loss decreased (0.5650 --> 0.5481).  Saving model state dict ...
Epoch: 5 cost time: 0.9039802551269531
Epoch: 5, Steps: 123 | Train Loss: 0.7583241 Vali Loss: 0.5480726 Best vali loss: 0.5480726
	iters: 100, epoch: 6 | loss: 0.6296144
	speed: 0.0141s/iter; left time: 3.8121s
Updating learning rate to 0.00010125286331231061
Epoch: 6 cost time: 1.1499919891357422
Epoch: 6, Steps: 123 | Train Loss: 0.6296144 Vali Loss: 0.5546320 Best vali loss: 0.5480726
	iters: 100, epoch: 7 | loss: 0.8544271
	speed: 0.0141s/iter; left time: 2.0740s
Updating learning rate to 2.631476181363154e-05
Epoch: 7 cost time: 1.1501884460449219
Epoch: 7, Steps: 123 | Train Loss: 0.8544271 Vali Loss: 0.5552386 Best vali loss: 0.5480726
	iters: 100, epoch: 8 | loss: 0.5696834
	speed: 0.0141s/iter; left time: 0.3379s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1475365161895752
Epoch: 8, Steps: 123 | Train Loss: 0.5696834 Vali Loss: 0.5564402 Best vali loss: 0.5480726

best validation loss 0.5480726425402808

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0065507519564, 'e_layers': 1, 'learning_rate': 0.0001029375142, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9225301
	speed: 0.0135s/iter; left time: 11.9645s
Updating learning rate to 0.0001029375142
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 1.2533621788024902
Epoch: 1, Steps: 123 | Train Loss: 0.9225301 Vali Loss: 0.6028767 Best vali loss: 0.6028767
	iters: 100, epoch: 2 | loss: 0.8674734
	speed: 0.0115s/iter; left time: 8.7947s
Updating learning rate to 5.14687571e-05
Validation loss decreased (0.6029 --> 0.5991).  Saving model state dict ...
Epoch: 2 cost time: 0.8802585601806641
Epoch: 2, Steps: 123 | Train Loss: 0.8674734 Vali Loss: 0.5991068 Best vali loss: 0.5991068
	iters: 100, epoch: 3 | loss: 0.7594486
	speed: 0.0117s/iter; left time: 7.4863s
Updating learning rate to 2.573437855e-05
Epoch: 3 cost time: 0.884418249130249
Epoch: 3, Steps: 123 | Train Loss: 0.7594486 Vali Loss: 0.6071878 Best vali loss: 0.5991068
	iters: 100, epoch: 4 | loss: 0.7147710
	speed: 0.0119s/iter; left time: 6.1226s
Updating learning rate to 1.2867189275e-05
Epoch: 4 cost time: 0.8760945796966553
Epoch: 4, Steps: 123 | Train Loss: 0.7147710 Vali Loss: 0.6094488 Best vali loss: 0.5991068
	iters: 100, epoch: 5 | loss: 0.7959084
	speed: 0.0117s/iter; left time: 4.5841s
Updating learning rate to 6.4335946375e-06
Epoch: 5 cost time: 0.9444646835327148
Epoch: 5, Steps: 123 | Train Loss: 0.7959084 Vali Loss: 0.6043057 Best vali loss: 0.5991068
	iters: 100, epoch: 6 | loss: 0.7210046
	speed: 0.0120s/iter; left time: 3.2466s
Updating learning rate to 3.21679731875e-06
Epoch: 6 cost time: 0.9089298248291016
Epoch: 6, Steps: 123 | Train Loss: 0.7210046 Vali Loss: 0.6051534 Best vali loss: 0.5991068
	iters: 100, epoch: 7 | loss: 0.6094329
	speed: 0.0084s/iter; left time: 1.2384s
Updating learning rate to 1.608398659375e-06
Epoch: 7 cost time: 0.5559418201446533
Epoch: 7, Steps: 123 | Train Loss: 0.6094329 Vali Loss: 0.6053094 Best vali loss: 0.5991068
	iters: 100, epoch: 8 | loss: 0.7321396
	speed: 0.0072s/iter; left time: 0.1736s
Updating learning rate to 8.041993296875e-07
Epoch: 8 cost time: 0.5413913726806641
Epoch: 8, Steps: 123 | Train Loss: 0.7321396 Vali Loss: 0.6050030 Best vali loss: 0.5991068

best validation loss 0.5991068370691994

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010787314027, 'e_layers': 1, 'learning_rate': 6.93882705e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7651581
	speed: 0.0097s/iter; left time: 36.8763s
	iters: 200, epoch: 1 | loss: 0.9481856
	speed: 0.0039s/iter; left time: 14.5257s
	iters: 300, epoch: 1 | loss: 0.8975379
	speed: 0.0044s/iter; left time: 15.9583s
	iters: 400, epoch: 1 | loss: 0.6431395
	speed: 0.0035s/iter; left time: 12.1600s
Updating learning rate to 6.674733670565335e-05
Validation loss decreased (inf --> 0.6551).  Saving model state dict ...
Epoch: 1 cost time: 2.1984615325927734
Epoch: 1, Steps: 490 | Train Loss: 0.8135053 Vali Loss: 0.6551157 Best vali loss: 0.6551157
	iters: 100, epoch: 2 | loss: 0.9309604
	speed: 0.0128s/iter; left time: 42.5610s
	iters: 200, epoch: 2 | loss: 1.0512667
	speed: 0.0043s/iter; left time: 13.8414s
	iters: 300, epoch: 2 | loss: 1.0345644
	speed: 0.0046s/iter; left time: 14.5250s
	iters: 400, epoch: 2 | loss: 0.7956868
	speed: 0.0040s/iter; left time: 12.2415s
Updating learning rate to 5.922659355267823e-05
Validation loss decreased (0.6551 --> 0.6277).  Saving model state dict ...
Epoch: 2 cost time: 2.0325629711151123
Epoch: 2, Steps: 490 | Train Loss: 0.9531195 Vali Loss: 0.6276678 Best vali loss: 0.6276678
	iters: 100, epoch: 3 | loss: 0.7069858
	speed: 0.0131s/iter; left time: 37.2966s
	iters: 200, epoch: 3 | loss: 0.8524184
	speed: 0.0037s/iter; left time: 10.0757s
	iters: 300, epoch: 3 | loss: 0.7155434
	speed: 0.0044s/iter; left time: 11.5887s
	iters: 400, epoch: 3 | loss: 1.1685942
	speed: 0.0042s/iter; left time: 10.5503s
Updating learning rate to 4.7971006010408654e-05
Validation loss decreased (0.6277 --> 0.6131).  Saving model state dict ...
Epoch: 3 cost time: 2.0592594146728516
Epoch: 3, Steps: 490 | Train Loss: 0.8608855 Vali Loss: 0.6131369 Best vali loss: 0.6131369
	iters: 100, epoch: 4 | loss: 0.6125493
	speed: 0.0130s/iter; left time: 30.6081s
	iters: 200, epoch: 4 | loss: 1.3100929
	speed: 0.0038s/iter; left time: 8.5608s
	iters: 300, epoch: 4 | loss: 0.4335221
	speed: 0.0038s/iter; left time: 8.2628s
	iters: 400, epoch: 4 | loss: 0.9644917
	speed: 0.0040s/iter; left time: 8.3009s
Updating learning rate to 3.469413525e-05
Validation loss decreased (0.6131 --> 0.6084).  Saving model state dict ...
Epoch: 4 cost time: 2.0132968425750732
Epoch: 4, Steps: 490 | Train Loss: 0.8301640 Vali Loss: 0.6084067 Best vali loss: 0.6084067
	iters: 100, epoch: 5 | loss: 0.5130784
	speed: 0.0124s/iter; left time: 23.1432s
	iters: 200, epoch: 5 | loss: 0.5365846
	speed: 0.0044s/iter; left time: 7.7246s
	iters: 300, epoch: 5 | loss: 0.8139462
	speed: 0.0038s/iter; left time: 6.3711s
	iters: 400, epoch: 5 | loss: 1.2621465
	speed: 0.0036s/iter; left time: 5.6254s
Updating learning rate to 2.141726448959135e-05
Validation loss decreased (0.6084 --> 0.6062).  Saving model state dict ...
Epoch: 5 cost time: 1.840254545211792
Epoch: 5, Steps: 490 | Train Loss: 0.7814389 Vali Loss: 0.6061888 Best vali loss: 0.6061888
	iters: 100, epoch: 6 | loss: 1.1670234
	speed: 0.0079s/iter; left time: 10.8849s
	iters: 200, epoch: 6 | loss: 1.0173020
	speed: 0.0050s/iter; left time: 6.4139s
	iters: 300, epoch: 6 | loss: 0.7803825
	speed: 0.0058s/iter; left time: 6.8148s
	iters: 400, epoch: 6 | loss: 1.0481390
	speed: 0.0053s/iter; left time: 5.7294s
Updating learning rate to 1.0161676947321766e-05
Validation loss decreased (0.6062 --> 0.6059).  Saving model state dict ...
Epoch: 6 cost time: 2.456206798553467
Epoch: 6, Steps: 490 | Train Loss: 1.0032117 Vali Loss: 0.6059256 Best vali loss: 0.6059256
	iters: 100, epoch: 7 | loss: 0.8069024
	speed: 0.0181s/iter; left time: 15.9075s
	iters: 200, epoch: 7 | loss: 0.6419553
	speed: 0.0072s/iter; left time: 5.6215s
	iters: 300, epoch: 7 | loss: 0.9651808
	speed: 0.0052s/iter; left time: 3.5186s
	iters: 400, epoch: 7 | loss: 0.9931997
	speed: 0.0068s/iter; left time: 3.9275s
Updating learning rate to 2.6409337943466457e-06
Validation loss decreased (0.6059 --> 0.6056).  Saving model state dict ...
Epoch: 7 cost time: 2.8833556175231934
Epoch: 7, Steps: 490 | Train Loss: 0.8518095 Vali Loss: 0.6055904 Best vali loss: 0.6055904
	iters: 100, epoch: 8 | loss: 0.9718987
	speed: 0.0172s/iter; left time: 6.7426s
	iters: 200, epoch: 8 | loss: 1.3236805
	speed: 0.0060s/iter; left time: 1.7345s
	iters: 300, epoch: 8 | loss: 0.7573681
	speed: 0.0057s/iter; left time: 1.0914s
	iters: 400, epoch: 8 | loss: 0.8800533
	speed: 0.0054s/iter; left time: 0.4913s
Updating learning rate to 0.0
Validation loss decreased (0.6056 --> 0.6055).  Saving model state dict ...
Epoch: 8 cost time: 2.586362838745117
Epoch: 8, Steps: 490 | Train Loss: 0.9832502 Vali Loss: 0.6054611 Best vali loss: 0.6054611

best validation loss 0.6054611337344882

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0021613678694, 'e_layers': 3, 'learning_rate': 0.0003089520735, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003089520735
Validation loss decreased (inf --> 0.6691).  Saving model state dict ...
Epoch: 1 cost time: 0.7825510501861572
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6691235 Best vali loss: 0.6691235
Updating learning rate to 0.00015447603675
Validation loss decreased (0.6691 --> 0.6396).  Saving model state dict ...
Epoch: 2 cost time: 0.554924726486206
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6396307 Best vali loss: 0.6396307
Updating learning rate to 7.7238018375e-05
Validation loss decreased (0.6396 --> 0.6325).  Saving model state dict ...
Epoch: 3 cost time: 0.5520219802856445
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6324934 Best vali loss: 0.6324934

best validation loss 0.6324934277033596

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0117286521251, 'e_layers': 1, 'learning_rate': 0.0001923981906, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6332531
	speed: 0.0111s/iter; left time: 9.8558s
Updating learning rate to 0.00018507547049377273
Validation loss decreased (inf --> 0.6069).  Saving model state dict ...
Epoch: 1 cost time: 0.9630353450775146
Epoch: 1, Steps: 123 | Train Loss: 0.6332531 Vali Loss: 0.6068986 Best vali loss: 0.6068986
	iters: 100, epoch: 2 | loss: 0.9828714
	speed: 0.0097s/iter; left time: 7.3933s
Updating learning rate to 0.00016422212793064094
Validation loss decreased (0.6069 --> 0.6057).  Saving model state dict ...
Epoch: 2 cost time: 0.7318212985992432
Epoch: 2, Steps: 123 | Train Loss: 0.9828714 Vali Loss: 0.6057447 Best vali loss: 0.6057447
	iters: 100, epoch: 3 | loss: 1.2339356
	speed: 0.0095s/iter; left time: 6.0819s
Updating learning rate to 0.0001330128952798204
Validation loss decreased (0.6057 --> 0.6056).  Saving model state dict ...
Epoch: 3 cost time: 0.7141990661621094
Epoch: 3, Steps: 123 | Train Loss: 1.2339356 Vali Loss: 0.6055667 Best vali loss: 0.6055667

best validation loss 0.6055667267414995

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042120649381, 'e_layers': 1, 'learning_rate': 0.0036397684012, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003501237965075005
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 0.7852945327758789
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6077859 Best vali loss: 0.6077859
Updating learning rate to 0.003106736659818519
Validation loss decreased (0.6078 --> 0.6053).  Saving model state dict ...
Epoch: 2 cost time: 0.49135255813598633
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6052752 Best vali loss: 0.6052752
Updating learning rate to 0.002516323732992606
Epoch: 3 cost time: 0.513585090637207
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6306080 Best vali loss: 0.6052752

best validation loss 0.605275228640262

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042120649381, 'e_layers': 1, 'learning_rate': 0.0036397684012, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0018198842006
Epoch: 4 cost time: 0.6892106533050537
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6463467 Best vali loss: 0.6052752
Updating learning rate to 0.0011234446682073945
Epoch: 5 cost time: 0.445080041885376
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6339555 Best vali loss: 0.6052752
Updating learning rate to 0.0005330317413814809
Epoch: 6 cost time: 0.4617929458618164
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6821235 Best vali loss: 0.6052752
Updating learning rate to 0.00013853043612499524
Epoch: 7 cost time: 0.4335932731628418
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6487744 Best vali loss: 0.6052752
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4170410633087158
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6857497 Best vali loss: 0.6052752

best validation loss 0.605275228640262

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0035319109171, 'e_layers': 1, 'learning_rate': 0.000506690727, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6726192
	speed: 0.0097s/iter; left time: 8.5862s
Updating learning rate to 0.000487405959494282
Validation loss decreased (inf --> 0.6318).  Saving model state dict ...
Epoch: 1 cost time: 0.788158655166626
Epoch: 1, Steps: 123 | Train Loss: 0.6726192 Vali Loss: 0.6318465 Best vali loss: 0.6318465
	iters: 100, epoch: 2 | loss: 0.9311962
	speed: 0.0069s/iter; left time: 5.2809s
Updating learning rate to 0.0004324875880130208
Validation loss decreased (0.6318 --> 0.6167).  Saving model state dict ...
Epoch: 2 cost time: 0.5250318050384521
Epoch: 2, Steps: 123 | Train Loss: 0.9311962 Vali Loss: 0.6166951 Best vali loss: 0.6166951
	iters: 100, epoch: 3 | loss: 0.8595760
	speed: 0.0070s/iter; left time: 4.4540s
Updating learning rate to 0.00035029643677796134
Validation loss decreased (0.6167 --> 0.6043).  Saving model state dict ...
Epoch: 3 cost time: 0.534738302230835
Epoch: 3, Steps: 123 | Train Loss: 0.8595760 Vali Loss: 0.6042503 Best vali loss: 0.6042503
	iters: 100, epoch: 4 | loss: 0.7258680
	speed: 0.0067s/iter; left time: 3.4757s
Updating learning rate to 0.0002533453635
Validation loss decreased (0.6043 --> 0.6034).  Saving model state dict ...
Epoch: 4 cost time: 0.5134379863739014
Epoch: 4, Steps: 123 | Train Loss: 0.7258680 Vali Loss: 0.6033805 Best vali loss: 0.6033805
	iters: 100, epoch: 5 | loss: 0.9342417
	speed: 0.0068s/iter; left time: 2.6567s
Updating learning rate to 0.00015639429022203867
Validation loss decreased (0.6034 --> 0.5970).  Saving model state dict ...
Epoch: 5 cost time: 0.515235424041748
Epoch: 5, Steps: 123 | Train Loss: 0.9342417 Vali Loss: 0.5970254 Best vali loss: 0.5970254
	iters: 100, epoch: 6 | loss: 0.7301860
	speed: 0.0070s/iter; left time: 1.8768s
Updating learning rate to 7.420313898697917e-05
Epoch: 6 cost time: 0.5337014198303223
Epoch: 6, Steps: 123 | Train Loss: 0.7301860 Vali Loss: 0.5989160 Best vali loss: 0.5970254
	iters: 100, epoch: 7 | loss: 0.7493167
	speed: 0.0069s/iter; left time: 1.0177s
Updating learning rate to 1.9284767505717994e-05
Epoch: 7 cost time: 0.5364019870758057
Epoch: 7, Steps: 123 | Train Loss: 0.7493167 Vali Loss: 0.6002672 Best vali loss: 0.5970254
	iters: 100, epoch: 8 | loss: 0.9273248
	speed: 0.0071s/iter; left time: 0.1713s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5479967594146729
Epoch: 8, Steps: 123 | Train Loss: 0.9273248 Vali Loss: 0.5995718 Best vali loss: 0.5970254

best validation loss 0.5970253651200594

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0053854283141, 'e_layers': 2, 'learning_rate': 0.0047874674618, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7283697
	speed: 0.0104s/iter; left time: 19.2812s
	iters: 200, epoch: 1 | loss: 0.8434839
	speed: 0.0047s/iter; left time: 8.2311s
Updating learning rate to 0.0047874674618
Validation loss decreased (inf --> 0.6024).  Saving model state dict ...
Epoch: 1 cost time: 1.416691780090332
Epoch: 1, Steps: 245 | Train Loss: 0.7859268 Vali Loss: 0.6024310 Best vali loss: 0.6024310
	iters: 100, epoch: 2 | loss: 0.8805332
	speed: 0.0092s/iter; left time: 14.8922s
	iters: 200, epoch: 2 | loss: 0.9975086
	speed: 0.0046s/iter; left time: 7.0057s
Updating learning rate to 0.0023937337309
Epoch: 2 cost time: 1.1785633563995361
Epoch: 2, Steps: 245 | Train Loss: 0.9390209 Vali Loss: 0.6230552 Best vali loss: 0.6024310
	iters: 100, epoch: 3 | loss: 0.5211135
	speed: 0.0097s/iter; left time: 13.3518s
	iters: 200, epoch: 3 | loss: 0.9496487
	speed: 0.0049s/iter; left time: 6.2754s
Updating learning rate to 0.00119686686545
Epoch: 3 cost time: 1.2659454345703125
Epoch: 3, Steps: 245 | Train Loss: 0.7353811 Vali Loss: 0.6193795 Best vali loss: 0.6024310
	iters: 100, epoch: 4 | loss: 0.8138688
	speed: 0.0091s/iter; left time: 10.2935s
	iters: 200, epoch: 4 | loss: 0.6529983
	speed: 0.0043s/iter; left time: 4.4409s
Updating learning rate to 0.000598433432725
Epoch: 4 cost time: 1.097841501235962
Epoch: 4, Steps: 245 | Train Loss: 0.7334336 Vali Loss: 0.6348881 Best vali loss: 0.6024310
	iters: 100, epoch: 5 | loss: 0.7297274
	speed: 0.0081s/iter; left time: 7.1654s
	iters: 200, epoch: 5 | loss: 0.7916231
	speed: 0.0059s/iter; left time: 4.5759s
Updating learning rate to 0.0002992167163625
Epoch: 5 cost time: 1.3165757656097412
Epoch: 5, Steps: 245 | Train Loss: 0.7606753 Vali Loss: 0.6132269 Best vali loss: 0.6024310
	iters: 100, epoch: 6 | loss: 0.8457728
	speed: 0.0133s/iter; left time: 8.4713s
	iters: 200, epoch: 6 | loss: 0.4499849
	speed: 0.0060s/iter; left time: 3.2194s
Updating learning rate to 0.00014960835818125
Epoch: 6 cost time: 1.6019883155822754
Epoch: 6, Steps: 245 | Train Loss: 0.6478788 Vali Loss: 0.6295574 Best vali loss: 0.6024310
	iters: 100, epoch: 7 | loss: 0.9583018
	speed: 0.0120s/iter; left time: 4.6991s
	iters: 200, epoch: 7 | loss: 1.2953873
	speed: 0.0036s/iter; left time: 1.0509s
Updating learning rate to 7.4804179090625e-05
Epoch: 7 cost time: 1.1212923526763916
Epoch: 7, Steps: 245 | Train Loss: 1.1268446 Vali Loss: 0.6278096 Best vali loss: 0.6024310
	iters: 100, epoch: 8 | loss: 0.8235156
	speed: 0.0098s/iter; left time: 1.4261s
	iters: 200, epoch: 8 | loss: 1.0208182
	speed: 0.0065s/iter; left time: 0.2979s
Updating learning rate to 3.74020895453125e-05
Epoch: 8 cost time: 1.4956347942352295
Epoch: 8, Steps: 245 | Train Loss: 0.9221669 Vali Loss: 0.6296443 Best vali loss: 0.6024310

best validation loss 0.6024310478646686

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0039151845006, 'e_layers': 1, 'learning_rate': 0.0002904722279, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8347576
	speed: 0.0103s/iter; left time: 39.2672s
	iters: 200, epoch: 1 | loss: 0.7566326
	speed: 0.0039s/iter; left time: 14.6844s
	iters: 300, epoch: 1 | loss: 2.1973932
	speed: 0.0037s/iter; left time: 13.5135s
	iters: 400, epoch: 1 | loss: 1.2789350
	speed: 0.0041s/iter; left time: 14.5345s
Updating learning rate to 0.0002904722279
Validation loss decreased (inf --> 0.6277).  Saving model state dict ...
Epoch: 1 cost time: 2.297180414199829
Epoch: 1, Steps: 490 | Train Loss: 1.2669296 Vali Loss: 0.6276546 Best vali loss: 0.6276546
	iters: 100, epoch: 2 | loss: 0.4069817
	speed: 0.0125s/iter; left time: 41.5502s
	iters: 200, epoch: 2 | loss: 0.4536717
	speed: 0.0043s/iter; left time: 13.7904s
	iters: 300, epoch: 2 | loss: 0.7658085
	speed: 0.0038s/iter; left time: 11.7950s
	iters: 400, epoch: 2 | loss: 0.8478631
	speed: 0.0026s/iter; left time: 7.9785s
Updating learning rate to 0.00014523611395
Validation loss decreased (0.6277 --> 0.6084).  Saving model state dict ...
Epoch: 2 cost time: 1.7787353992462158
Epoch: 2, Steps: 490 | Train Loss: 0.6185812 Vali Loss: 0.6084111 Best vali loss: 0.6084111
	iters: 100, epoch: 3 | loss: 1.0161191
	speed: 0.0098s/iter; left time: 27.8309s
	iters: 200, epoch: 3 | loss: 0.9368097
	speed: 0.0057s/iter; left time: 15.5347s
	iters: 300, epoch: 3 | loss: 0.3425761
	speed: 0.0056s/iter; left time: 14.7309s
	iters: 400, epoch: 3 | loss: 0.4033351
	speed: 0.0042s/iter; left time: 10.5900s
Updating learning rate to 7.2618056975e-05
Validation loss decreased (0.6084 --> 0.6041).  Saving model state dict ...
Epoch: 3 cost time: 2.3504834175109863
Epoch: 3, Steps: 490 | Train Loss: 0.6747100 Vali Loss: 0.6040966 Best vali loss: 0.6040966

best validation loss 0.6040965717239327

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013304591752, 'e_layers': 2, 'learning_rate': 0.0007475733017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8459399
	speed: 0.0131s/iter; left time: 11.5560s
Updating learning rate to 0.0007475733017
Validation loss decreased (inf --> 0.6038).  Saving model state dict ...
Epoch: 1 cost time: 1.178546667098999
Epoch: 1, Steps: 123 | Train Loss: 0.8459399 Vali Loss: 0.6037882 Best vali loss: 0.6037882
	iters: 100, epoch: 2 | loss: 0.6093528
	speed: 0.0114s/iter; left time: 8.6916s
Updating learning rate to 0.00037378665085
Epoch: 2 cost time: 0.8769454956054688
Epoch: 2, Steps: 123 | Train Loss: 0.6093528 Vali Loss: 0.6208562 Best vali loss: 0.6037882
	iters: 100, epoch: 3 | loss: 1.0435467
	speed: 0.0112s/iter; left time: 7.1318s
Updating learning rate to 0.000186893325425
Epoch: 3 cost time: 0.8626599311828613
Epoch: 3, Steps: 123 | Train Loss: 1.0435467 Vali Loss: 0.6086149 Best vali loss: 0.6037882

best validation loss 0.6037881561089091

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0048175691372, 'e_layers': 4, 'learning_rate': 0.0003697053685, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7542807
	speed: 0.0143s/iter; left time: 12.6852s
Updating learning rate to 0.0003556342957583465
Validation loss decreased (inf --> 0.6133).  Saving model state dict ...
Epoch: 1 cost time: 1.3644142150878906
Epoch: 1, Steps: 123 | Train Loss: 0.7542807 Vali Loss: 0.6132914 Best vali loss: 0.6132914
	iters: 100, epoch: 2 | loss: 1.0909655
	speed: 0.0133s/iter; left time: 10.1629s
Updating learning rate to 0.0003155632708037107
Validation loss decreased (0.6133 --> 0.6063).  Saving model state dict ...
Epoch: 2 cost time: 1.0852186679840088
Epoch: 2, Steps: 123 | Train Loss: 1.0909655 Vali Loss: 0.6062891 Best vali loss: 0.6062891
	iters: 100, epoch: 3 | loss: 0.8884202
	speed: 0.0134s/iter; left time: 8.5378s
Updating learning rate to 0.0002555927439406902
Validation loss decreased (0.6063 --> 0.6048).  Saving model state dict ...
Epoch: 3 cost time: 1.1265850067138672
Epoch: 3, Steps: 123 | Train Loss: 0.8884202 Vali Loss: 0.6047547 Best vali loss: 0.6047547

best validation loss 0.6047547479185558

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013304591752, 'e_layers': 2, 'learning_rate': 0.0007475733017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7915677
	speed: 0.0141s/iter; left time: 7.2845s
Updating learning rate to 9.34466627125e-05
Epoch: 4 cost time: 1.2193446159362793
Epoch: 4, Steps: 123 | Train Loss: 0.7915677 Vali Loss: 0.6150055 Best vali loss: 0.6037882
	iters: 100, epoch: 5 | loss: 0.5619754
	speed: 0.0113s/iter; left time: 4.4233s
Updating learning rate to 4.672333135625e-05
Epoch: 5 cost time: 0.8728106021881104
Epoch: 5, Steps: 123 | Train Loss: 0.5619754 Vali Loss: 0.6223725 Best vali loss: 0.6037882
	iters: 100, epoch: 6 | loss: 0.9620386
	speed: 0.0094s/iter; left time: 2.5501s
Updating learning rate to 2.3361665678125e-05
Epoch: 6 cost time: 0.6287615299224854
Epoch: 6, Steps: 123 | Train Loss: 0.9620386 Vali Loss: 0.6194410 Best vali loss: 0.6037882
	iters: 100, epoch: 7 | loss: 0.5631953
	speed: 0.0089s/iter; left time: 1.3096s
Updating learning rate to 1.16808328390625e-05
Epoch: 7 cost time: 0.7795896530151367
Epoch: 7, Steps: 123 | Train Loss: 0.5631953 Vali Loss: 0.6183616 Best vali loss: 0.6037882
	iters: 100, epoch: 8 | loss: 0.7966578
	speed: 0.0114s/iter; left time: 0.2724s
Updating learning rate to 5.84041641953125e-06
Epoch: 8 cost time: 0.9226086139678955
Epoch: 8, Steps: 123 | Train Loss: 0.7966578 Vali Loss: 0.6170115 Best vali loss: 0.6037882

best validation loss 0.6037881561089091

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0031278255798, 'e_layers': 4, 'learning_rate': 0.0001800603475, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5193410
	speed: 0.0126s/iter; left time: 48.1744s
	iters: 200, epoch: 1 | loss: 0.9450405
	speed: 0.0070s/iter; left time: 26.0299s
	iters: 300, epoch: 1 | loss: 0.5310145
	speed: 0.0066s/iter; left time: 23.8858s
	iters: 400, epoch: 1 | loss: 0.9476147
	speed: 0.0051s/iter; left time: 18.0553s
Updating learning rate to 0.0001800603475
Validation loss decreased (inf --> 0.6030).  Saving model state dict ...
Epoch: 1 cost time: 3.2923388481140137
Epoch: 1, Steps: 490 | Train Loss: 0.7357527 Vali Loss: 0.6030453 Best vali loss: 0.6030453
	iters: 100, epoch: 2 | loss: 1.2835486
	speed: 0.0148s/iter; left time: 49.3699s
	iters: 200, epoch: 2 | loss: 1.6858213
	speed: 0.0073s/iter; left time: 23.5308s
	iters: 300, epoch: 2 | loss: 1.0559559
	speed: 0.0074s/iter; left time: 23.1593s
	iters: 400, epoch: 2 | loss: 0.9139931
	speed: 0.0074s/iter; left time: 22.4723s
Updating learning rate to 9.003017375e-05
Validation loss decreased (0.6030 --> 0.5999).  Saving model state dict ...
Epoch: 2 cost time: 3.4708425998687744
Epoch: 2, Steps: 490 | Train Loss: 1.2348297 Vali Loss: 0.5998679 Best vali loss: 0.5998679
	iters: 100, epoch: 3 | loss: 0.7599555
	speed: 0.0192s/iter; left time: 54.6642s
	iters: 200, epoch: 3 | loss: 0.5796369
	speed: 0.0069s/iter; left time: 18.8049s
	iters: 300, epoch: 3 | loss: 0.7719499
	speed: 0.0074s/iter; left time: 19.4526s
	iters: 400, epoch: 3 | loss: 0.5037569
	speed: 0.0074s/iter; left time: 18.9133s
Updating learning rate to 4.5015086875e-05
Validation loss decreased (0.5999 --> 0.5827).  Saving model state dict ...
Epoch: 3 cost time: 3.557953357696533
Epoch: 3, Steps: 490 | Train Loss: 0.6538248 Vali Loss: 0.5827037 Best vali loss: 0.5827037
	iters: 100, epoch: 4 | loss: 0.6634080
	speed: 0.0159s/iter; left time: 37.2924s
	iters: 200, epoch: 4 | loss: 0.7494265
	speed: 0.0065s/iter; left time: 14.5958s
	iters: 300, epoch: 4 | loss: 0.3851762
	speed: 0.0067s/iter; left time: 14.4419s
	iters: 400, epoch: 4 | loss: 1.1334594
	speed: 0.0067s/iter; left time: 13.7057s
Updating learning rate to 2.25075434375e-05
Validation loss decreased (0.5827 --> 0.5619).  Saving model state dict ...
Epoch: 4 cost time: 3.2173731327056885
Epoch: 4, Steps: 490 | Train Loss: 0.7328675 Vali Loss: 0.5619008 Best vali loss: 0.5619008
	iters: 100, epoch: 5 | loss: 1.0448012
	speed: 0.0175s/iter; left time: 32.4746s
	iters: 200, epoch: 5 | loss: 0.7530845
	speed: 0.0066s/iter; left time: 11.5397s
	iters: 300, epoch: 5 | loss: 0.6095252
	speed: 0.0066s/iter; left time: 11.0165s
	iters: 400, epoch: 5 | loss: 0.8475854
	speed: 0.0067s/iter; left time: 10.3960s
Updating learning rate to 1.125377171875e-05
Epoch: 5 cost time: 3.271273136138916
Epoch: 5, Steps: 490 | Train Loss: 0.8137491 Vali Loss: 0.5699207 Best vali loss: 0.5619008
	iters: 100, epoch: 6 | loss: 1.0053492
	speed: 0.0165s/iter; left time: 22.6285s
	iters: 200, epoch: 6 | loss: 0.7714540
	speed: 0.0066s/iter; left time: 8.3273s
	iters: 300, epoch: 6 | loss: 0.8287693
	speed: 0.0066s/iter; left time: 7.7596s
	iters: 400, epoch: 6 | loss: 0.8214300
	speed: 0.0074s/iter; left time: 7.9002s
Updating learning rate to 5.626885859375e-06
Epoch: 6 cost time: 3.3413631916046143
Epoch: 6, Steps: 490 | Train Loss: 0.8567506 Vali Loss: 0.5649476 Best vali loss: 0.5619008
	iters: 100, epoch: 7 | loss: 0.5565207
	speed: 0.0177s/iter; left time: 15.5552s
	iters: 200, epoch: 7 | loss: 1.3185474
	speed: 0.0067s/iter; left time: 5.2325s
	iters: 300, epoch: 7 | loss: 0.5999858
	speed: 0.0067s/iter; left time: 4.5694s
	iters: 400, epoch: 7 | loss: 0.7615885
	speed: 0.0067s/iter; left time: 3.8651s
Updating learning rate to 2.8134429296875e-06
Epoch: 7 cost time: 3.320556879043579
Epoch: 7, Steps: 490 | Train Loss: 0.8091606 Vali Loss: 0.5653242 Best vali loss: 0.5619008
	iters: 100, epoch: 8 | loss: 0.7518592
	speed: 0.0170s/iter; left time: 6.6369s
	iters: 200, epoch: 8 | loss: 0.8782358
	speed: 0.0065s/iter; left time: 1.8958s
	iters: 300, epoch: 8 | loss: 0.6195730
	speed: 0.0067s/iter; left time: 1.2801s
	iters: 400, epoch: 8 | loss: 0.5246971
	speed: 0.0067s/iter; left time: 0.6077s
Updating learning rate to 1.40672146484375e-06
Epoch: 8 cost time: 3.2633132934570312
Epoch: 8, Steps: 490 | Train Loss: 0.6935913 Vali Loss: 0.5648254 Best vali loss: 0.5619008

best validation loss 0.5619008195022365

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0018839111988, 'e_layers': 2, 'learning_rate': 0.003678803465, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5710145
	speed: 0.0101s/iter; left time: 78.1089s
	iters: 200, epoch: 1 | loss: 0.5457150
	speed: 0.0044s/iter; left time: 33.6817s
	iters: 300, epoch: 1 | loss: 0.4666300
	speed: 0.0044s/iter; left time: 33.1990s
	iters: 400, epoch: 1 | loss: 0.3603647
	speed: 0.0045s/iter; left time: 33.1589s
	iters: 500, epoch: 1 | loss: 0.4483626
	speed: 0.0043s/iter; left time: 31.7056s
	iters: 600, epoch: 1 | loss: 0.3292296
	speed: 0.0042s/iter; left time: 30.2888s
	iters: 700, epoch: 1 | loss: 0.9850835
	speed: 0.0040s/iter; left time: 28.6448s
	iters: 800, epoch: 1 | loss: 0.8623829
	speed: 0.0039s/iter; left time: 27.4363s
	iters: 900, epoch: 1 | loss: 0.8620272
	speed: 0.0033s/iter; left time: 22.9966s
Updating learning rate to 0.003678803465
Validation loss decreased (inf --> 0.6329).  Saving model state dict ...
Epoch: 1 cost time: 4.304715871810913
Epoch: 1, Steps: 979 | Train Loss: 0.6034233 Vali Loss: 0.6329250 Best vali loss: 0.6329250
	iters: 100, epoch: 2 | loss: 0.5061393
	speed: 0.0146s/iter; left time: 98.3751s
	iters: 200, epoch: 2 | loss: 0.6531533
	speed: 0.0042s/iter; left time: 27.7421s
	iters: 300, epoch: 2 | loss: 0.9570144
	speed: 0.0046s/iter; left time: 30.3302s
	iters: 400, epoch: 2 | loss: 0.8712835
	speed: 0.0050s/iter; left time: 32.5463s
	iters: 500, epoch: 2 | loss: 1.2499083
	speed: 0.0044s/iter; left time: 27.9287s
	iters: 600, epoch: 2 | loss: 0.5468234
	speed: 0.0050s/iter; left time: 30.9769s
	iters: 700, epoch: 2 | loss: 0.2742507
	speed: 0.0044s/iter; left time: 26.9153s
	iters: 800, epoch: 2 | loss: 1.5924406
	speed: 0.0041s/iter; left time: 24.9988s
	iters: 900, epoch: 2 | loss: 0.8327644
	speed: 0.0035s/iter; left time: 21.1128s
Updating learning rate to 0.0018394017325
Epoch: 2 cost time: 4.357526063919067
Epoch: 2, Steps: 979 | Train Loss: 0.8315309 Vali Loss: 0.6433264 Best vali loss: 0.6329250
	iters: 100, epoch: 3 | loss: 0.4406192
	speed: 0.0155s/iter; left time: 89.5600s
	iters: 200, epoch: 3 | loss: 1.1730531
	speed: 0.0046s/iter; left time: 26.3506s
	iters: 300, epoch: 3 | loss: 0.9029135
	speed: 0.0047s/iter; left time: 26.4324s
	iters: 400, epoch: 3 | loss: 0.4736592
	speed: 0.0045s/iter; left time: 24.7227s
	iters: 500, epoch: 3 | loss: 1.0810069
	speed: 0.0050s/iter; left time: 26.8426s
	iters: 600, epoch: 3 | loss: 1.5896717
	speed: 0.0050s/iter; left time: 26.4012s
	iters: 700, epoch: 3 | loss: 0.4475741
	speed: 0.0047s/iter; left time: 24.1452s
	iters: 800, epoch: 3 | loss: 1.4798857
	speed: 0.0052s/iter; left time: 26.6040s
	iters: 900, epoch: 3 | loss: 0.6926553
	speed: 0.0049s/iter; left time: 24.2200s
Updating learning rate to 0.00091970086625
Epoch: 3 cost time: 4.845672845840454
Epoch: 3, Steps: 979 | Train Loss: 0.9201154 Vali Loss: 0.6413054 Best vali loss: 0.6329250
	iters: 100, epoch: 4 | loss: 0.6932150
	speed: 0.0166s/iter; left time: 79.5911s
	iters: 200, epoch: 4 | loss: 1.0232079
	speed: 0.0033s/iter; left time: 15.4372s
	iters: 300, epoch: 4 | loss: 0.6884351
	speed: 0.0036s/iter; left time: 16.6603s
	iters: 400, epoch: 4 | loss: 0.9315108
	speed: 0.0064s/iter; left time: 28.5822s
	iters: 500, epoch: 4 | loss: 1.0888348
	speed: 0.0050s/iter; left time: 21.9956s
	iters: 600, epoch: 4 | loss: 0.7770399
	speed: 0.0059s/iter; left time: 25.3760s
	iters: 700, epoch: 4 | loss: 0.8972456
	speed: 0.0063s/iter; left time: 26.4875s
	iters: 800, epoch: 4 | loss: 0.2732273
	speed: 0.0050s/iter; left time: 20.5665s
	iters: 900, epoch: 4 | loss: 0.8593457
	speed: 0.0060s/iter; left time: 23.9973s
Updating learning rate to 0.000459850433125
Epoch: 4 cost time: 5.104916334152222
Epoch: 4, Steps: 979 | Train Loss: 0.8035625 Vali Loss: 0.6459346 Best vali loss: 0.6329250
	iters: 100, epoch: 5 | loss: 0.8822404
	speed: 0.0195s/iter; left time: 74.3352s
	iters: 200, epoch: 5 | loss: 0.4550651
	speed: 0.0061s/iter; left time: 22.7257s
	iters: 300, epoch: 5 | loss: 0.9668069
	speed: 0.0062s/iter; left time: 22.3738s
	iters: 400, epoch: 5 | loss: 0.4844435
	speed: 0.0045s/iter; left time: 15.8108s
	iters: 500, epoch: 5 | loss: 1.0373212
	speed: 0.0032s/iter; left time: 10.8998s
	iters: 600, epoch: 5 | loss: 0.9963699
	speed: 0.0033s/iter; left time: 10.8719s
	iters: 700, epoch: 5 | loss: 0.7761602
	speed: 0.0040s/iter; left time: 12.9317s
	iters: 800, epoch: 5 | loss: 0.8059757
	speed: 0.0046s/iter; left time: 14.2271s
	iters: 900, epoch: 5 | loss: 1.8450657
	speed: 0.0047s/iter; left time: 14.1444s
Updating learning rate to 0.0002299252165625
Epoch: 5 cost time: 4.55398416519165
Epoch: 5, Steps: 979 | Train Loss: 0.9166054 Vali Loss: 0.6476340 Best vali loss: 0.6329250
	iters: 100, epoch: 6 | loss: 1.1123072
	speed: 0.0170s/iter; left time: 48.2705s
	iters: 200, epoch: 6 | loss: 0.8035880
	speed: 0.0046s/iter; left time: 12.6544s
	iters: 300, epoch: 6 | loss: 0.2373711
	speed: 0.0046s/iter; left time: 12.2548s
	iters: 400, epoch: 6 | loss: 0.2826454
	speed: 0.0047s/iter; left time: 11.8995s
	iters: 500, epoch: 6 | loss: 1.0071574
	speed: 0.0044s/iter; left time: 10.7656s
	iters: 600, epoch: 6 | loss: 0.7277510
	speed: 0.0045s/iter; left time: 10.5465s
	iters: 700, epoch: 6 | loss: 1.8390524
	speed: 0.0045s/iter; left time: 10.0239s
	iters: 800, epoch: 6 | loss: 0.7607064
	speed: 0.0044s/iter; left time: 9.3637s
	iters: 900, epoch: 6 | loss: 0.5327472
	speed: 0.0047s/iter; left time: 9.5445s
Updating learning rate to 0.00011496260828125
Epoch: 6 cost time: 4.526533126831055
Epoch: 6, Steps: 979 | Train Loss: 0.8114807 Vali Loss: 0.6433243 Best vali loss: 0.6329250
	iters: 100, epoch: 7 | loss: 0.9041419
	speed: 0.0170s/iter; left time: 31.5169s
	iters: 200, epoch: 7 | loss: 0.8410566
	speed: 0.0046s/iter; left time: 8.0381s
	iters: 300, epoch: 7 | loss: 0.4707232
	speed: 0.0048s/iter; left time: 8.0194s
	iters: 400, epoch: 7 | loss: 1.0277514
	speed: 0.0042s/iter; left time: 6.4929s
	iters: 500, epoch: 7 | loss: 0.4128930
	speed: 0.0047s/iter; left time: 6.7853s
	iters: 600, epoch: 7 | loss: 1.3317990
	speed: 0.0046s/iter; left time: 6.2624s
	iters: 700, epoch: 7 | loss: 1.2693383
	speed: 0.0044s/iter; left time: 5.5717s
	iters: 800, epoch: 7 | loss: 0.6816630
	speed: 0.0047s/iter; left time: 5.4626s
	iters: 900, epoch: 7 | loss: 0.2967800
	speed: 0.0044s/iter; left time: 4.6292s
Updating learning rate to 5.7481304140625e-05
Epoch: 7 cost time: 4.523689270019531
Epoch: 7, Steps: 979 | Train Loss: 0.8040163 Vali Loss: 0.6428818 Best vali loss: 0.6329250
	iters: 100, epoch: 8 | loss: 0.9463629
	speed: 0.0167s/iter; left time: 14.6934s
	iters: 200, epoch: 8 | loss: 0.3491556
	speed: 0.0045s/iter; left time: 3.4725s
	iters: 300, epoch: 8 | loss: 0.8992655
	speed: 0.0045s/iter; left time: 3.0627s
	iters: 400, epoch: 8 | loss: 1.3543622
	speed: 0.0048s/iter; left time: 2.7727s
	iters: 500, epoch: 8 | loss: 0.4815548
	speed: 0.0050s/iter; left time: 2.4187s
	iters: 600, epoch: 8 | loss: 1.2499863
	speed: 0.0046s/iter; left time: 1.7591s
	iters: 700, epoch: 8 | loss: 0.3157195
	speed: 0.0052s/iter; left time: 1.4562s
	iters: 800, epoch: 8 | loss: 1.2712884
	speed: 0.0043s/iter; left time: 0.7736s
	iters: 900, epoch: 8 | loss: 1.5388197
	speed: 0.0044s/iter; left time: 0.3514s
Updating learning rate to 2.87406520703125e-05
Epoch: 8 cost time: 4.605004787445068
Epoch: 8, Steps: 979 | Train Loss: 0.9340572 Vali Loss: 0.6432000 Best vali loss: 0.6329250

best validation loss 0.6329249657107856

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0055905958708, 'e_layers': 1, 'learning_rate': 0.0036280597991, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0904851
	speed: 0.0091s/iter; left time: 34.8313s
	iters: 200, epoch: 1 | loss: 1.0329448
	speed: 0.0028s/iter; left time: 10.3505s
	iters: 300, epoch: 1 | loss: 0.7511971
	speed: 0.0045s/iter; left time: 16.3954s
	iters: 400, epoch: 1 | loss: 0.8687291
	speed: 0.0041s/iter; left time: 14.5238s
Updating learning rate to 0.0036280597991
Validation loss decreased (inf --> 0.6478).  Saving model state dict ...
Epoch: 1 cost time: 2.1209936141967773
Epoch: 1, Steps: 490 | Train Loss: 0.9358390 Vali Loss: 0.6478317 Best vali loss: 0.6478317
	iters: 100, epoch: 2 | loss: 0.4565078
	speed: 0.0128s/iter; left time: 42.6636s
	iters: 200, epoch: 2 | loss: 0.6514869
	speed: 0.0032s/iter; left time: 10.4028s
	iters: 300, epoch: 2 | loss: 0.8921507
	speed: 0.0027s/iter; left time: 8.4360s
	iters: 400, epoch: 2 | loss: 1.0492017
	speed: 0.0028s/iter; left time: 8.5361s
Updating learning rate to 0.00181402989955
Validation loss decreased (0.6478 --> 0.6034).  Saving model state dict ...
Epoch: 2 cost time: 1.5543601512908936
Epoch: 2, Steps: 490 | Train Loss: 0.7623368 Vali Loss: 0.6034010 Best vali loss: 0.6034010
	iters: 100, epoch: 3 | loss: 0.6851816
	speed: 0.0124s/iter; left time: 35.2862s
	iters: 200, epoch: 3 | loss: 1.4351228
	speed: 0.0046s/iter; left time: 12.5004s
	iters: 300, epoch: 3 | loss: 1.0975412
	speed: 0.0038s/iter; left time: 9.9973s
	iters: 400, epoch: 3 | loss: 1.2415750
	speed: 0.0045s/iter; left time: 11.4387s
Updating learning rate to 0.000907014949775
Epoch: 3 cost time: 2.121166706085205
Epoch: 3, Steps: 490 | Train Loss: 1.1148552 Vali Loss: 0.6331562 Best vali loss: 0.6034010

best validation loss 0.6034010263269337

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.001012004623, 'e_layers': 3, 'learning_rate': 0.000825808451, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9153478
	speed: 0.0120s/iter; left time: 45.6931s
	iters: 200, epoch: 1 | loss: 1.1319666
	speed: 0.0064s/iter; left time: 23.6381s
	iters: 300, epoch: 1 | loss: 1.0462319
	speed: 0.0049s/iter; left time: 17.6013s
	iters: 400, epoch: 1 | loss: 0.6713768
	speed: 0.0044s/iter; left time: 15.6659s
Updating learning rate to 0.000825808451
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 3.0135889053344727
Epoch: 1, Steps: 490 | Train Loss: 0.9412308 Vali Loss: 0.6067378 Best vali loss: 0.6067378
	iters: 100, epoch: 2 | loss: 0.7603678
	speed: 0.0176s/iter; left time: 58.5874s
	iters: 200, epoch: 2 | loss: 0.6590531
	speed: 0.0067s/iter; left time: 21.5426s
	iters: 300, epoch: 2 | loss: 1.2234528
	speed: 0.0066s/iter; left time: 20.6425s
	iters: 400, epoch: 2 | loss: 0.8432236
	speed: 0.0066s/iter; left time: 19.9768s
Updating learning rate to 0.0004129042255
Epoch: 2 cost time: 3.3222885131835938
Epoch: 2, Steps: 490 | Train Loss: 0.8715243 Vali Loss: 0.6121456 Best vali loss: 0.6067378
	iters: 100, epoch: 3 | loss: 0.8245380
	speed: 0.0146s/iter; left time: 41.3729s
	iters: 200, epoch: 3 | loss: 0.8730682
	speed: 0.0048s/iter; left time: 13.1820s
	iters: 300, epoch: 3 | loss: 0.3220272
	speed: 0.0047s/iter; left time: 12.4504s
	iters: 400, epoch: 3 | loss: 0.8918471
	speed: 0.0047s/iter; left time: 11.9809s
Updating learning rate to 0.00020645211275
Validation loss decreased (0.6067 --> 0.5749).  Saving model state dict ...
Epoch: 3 cost time: 2.362109899520874
Epoch: 3, Steps: 490 | Train Loss: 0.7278701 Vali Loss: 0.5749197 Best vali loss: 0.5749197

best validation loss 0.5749196527402526

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009225062942, 'e_layers': 1, 'learning_rate': 0.0034509285106, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0033195853648514996
Validation loss decreased (inf --> 0.6217).  Saving model state dict ...
Epoch: 1 cost time: 0.8275759220123291
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6217085 Best vali loss: 0.6217085
Updating learning rate to 0.002945551730917626
Validation loss decreased (0.6217 --> 0.6134).  Saving model state dict ...
Epoch: 2 cost time: 0.5793864727020264
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6133645 Best vali loss: 0.6133645
Updating learning rate to 0.0023857708389414777
Epoch: 3 cost time: 0.5799164772033691
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6579207 Best vali loss: 0.6133645

best validation loss 0.6133644618904188

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.001012004623, 'e_layers': 3, 'learning_rate': 0.000825808451, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8939688
	speed: 0.0123s/iter; left time: 28.8850s
	iters: 200, epoch: 4 | loss: 0.9515339
	speed: 0.0062s/iter; left time: 13.8639s
	iters: 300, epoch: 4 | loss: 1.0527674
	speed: 0.0050s/iter; left time: 10.8106s
	iters: 400, epoch: 4 | loss: 0.5865421
	speed: 0.0043s/iter; left time: 8.7258s
Updating learning rate to 0.000103226056375
Validation loss decreased (0.5749 --> 0.5641).  Saving model state dict ...
Epoch: 4 cost time: 2.945186138153076
Epoch: 4, Steps: 490 | Train Loss: 0.8712030 Vali Loss: 0.5640540 Best vali loss: 0.5640540
	iters: 100, epoch: 5 | loss: 0.7137681
	speed: 0.0158s/iter; left time: 29.3954s
	iters: 200, epoch: 5 | loss: 0.5443335
	speed: 0.0057s/iter; left time: 10.1076s
	iters: 300, epoch: 5 | loss: 1.1018574
	speed: 0.0056s/iter; left time: 9.3043s
	iters: 400, epoch: 5 | loss: 0.7386344
	speed: 0.0056s/iter; left time: 8.7934s
Updating learning rate to 5.16130281875e-05
Validation loss decreased (0.5641 --> 0.5625).  Saving model state dict ...
Epoch: 5 cost time: 2.7891077995300293
Epoch: 5, Steps: 490 | Train Loss: 0.7746484 Vali Loss: 0.5625298 Best vali loss: 0.5625298
	iters: 100, epoch: 6 | loss: 0.7752987
	speed: 0.0160s/iter; left time: 21.8780s
	iters: 200, epoch: 6 | loss: 0.8422317
	speed: 0.0055s/iter; left time: 7.0278s
	iters: 300, epoch: 6 | loss: 0.3150922
	speed: 0.0056s/iter; left time: 6.5953s
	iters: 400, epoch: 6 | loss: 0.8556506
	speed: 0.0057s/iter; left time: 6.0840s
Updating learning rate to 2.580651409375e-05
Validation loss decreased (0.5625 --> 0.5602).  Saving model state dict ...
Epoch: 6 cost time: 2.7887375354766846
Epoch: 6, Steps: 490 | Train Loss: 0.6970683 Vali Loss: 0.5601643 Best vali loss: 0.5601643
	iters: 100, epoch: 7 | loss: 0.3242220
	speed: 0.0167s/iter; left time: 14.6942s
	iters: 200, epoch: 7 | loss: 0.8664466
	speed: 0.0057s/iter; left time: 4.4777s
	iters: 300, epoch: 7 | loss: 0.4251246
	speed: 0.0062s/iter; left time: 4.2083s
	iters: 400, epoch: 7 | loss: 0.7890359
	speed: 0.0056s/iter; left time: 3.2258s
Updating learning rate to 1.2903257046875e-05
Epoch: 7 cost time: 2.930791139602661
Epoch: 7, Steps: 490 | Train Loss: 0.6012072 Vali Loss: 0.5663318 Best vali loss: 0.5601643
	iters: 100, epoch: 8 | loss: 0.6613178
	speed: 0.0168s/iter; left time: 6.5672s
	iters: 200, epoch: 8 | loss: 0.4518939
	speed: 0.0059s/iter; left time: 1.7220s
	iters: 300, epoch: 8 | loss: 1.0873961
	speed: 0.0057s/iter; left time: 1.0849s
	iters: 400, epoch: 8 | loss: 0.4952538
	speed: 0.0055s/iter; left time: 0.5004s
Updating learning rate to 6.4516285234375e-06
Epoch: 8 cost time: 2.873971462249756
Epoch: 8, Steps: 490 | Train Loss: 0.6739654 Vali Loss: 0.5651016 Best vali loss: 0.5601643

best validation loss 0.5601643147925325

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0098036929311, 'e_layers': 1, 'learning_rate': 0.000566823774, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7925137
	speed: 0.0109s/iter; left time: 20.2783s
	iters: 200, epoch: 1 | loss: 1.0208538
	speed: 0.0045s/iter; left time: 7.8632s
Updating learning rate to 0.000566823774
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 1.434875726699829
Epoch: 1, Steps: 245 | Train Loss: 0.9066837 Vali Loss: 0.6070376 Best vali loss: 0.6070376
	iters: 100, epoch: 2 | loss: 0.8779731
	speed: 0.0105s/iter; left time: 16.9995s
	iters: 200, epoch: 2 | loss: 1.1153003
	speed: 0.0044s/iter; left time: 6.7005s
Updating learning rate to 0.000283411887
Validation loss decreased (0.6070 --> 0.6047).  Saving model state dict ...
Epoch: 2 cost time: 1.1462817192077637
Epoch: 2, Steps: 245 | Train Loss: 0.9966367 Vali Loss: 0.6046942 Best vali loss: 0.6046942
	iters: 100, epoch: 3 | loss: 0.8380302
	speed: 0.0103s/iter; left time: 14.1689s
	iters: 200, epoch: 3 | loss: 0.7963968
	speed: 0.0045s/iter; left time: 5.7545s
Updating learning rate to 0.0001417059435
Validation loss decreased (0.6047 --> 0.6034).  Saving model state dict ...
Epoch: 3 cost time: 1.1754097938537598
Epoch: 3, Steps: 245 | Train Loss: 0.8172135 Vali Loss: 0.6033829 Best vali loss: 0.6033829
	iters: 100, epoch: 4 | loss: 0.5740465
	speed: 0.0106s/iter; left time: 11.9219s
	iters: 200, epoch: 4 | loss: 0.6466787
	speed: 0.0029s/iter; left time: 3.0083s
Updating learning rate to 7.085297175e-05
Epoch: 4 cost time: 0.9269795417785645
Epoch: 4, Steps: 245 | Train Loss: 0.6103626 Vali Loss: 0.6038438 Best vali loss: 0.6033829
	iters: 100, epoch: 5 | loss: 0.5015574
	speed: 0.0067s/iter; left time: 5.9207s
	iters: 200, epoch: 5 | loss: 0.9529400
	speed: 0.0044s/iter; left time: 3.4287s
Updating learning rate to 3.5426485875e-05
Epoch: 5 cost time: 1.0140573978424072
Epoch: 5, Steps: 245 | Train Loss: 0.7272487 Vali Loss: 0.6050283 Best vali loss: 0.6033829
	iters: 100, epoch: 6 | loss: 0.7849820
	speed: 0.0101s/iter; left time: 6.4528s
	iters: 200, epoch: 6 | loss: 0.8973737
	speed: 0.0047s/iter; left time: 2.4978s
Updating learning rate to 1.77132429375e-05
Epoch: 6 cost time: 1.1952381134033203
Epoch: 6, Steps: 245 | Train Loss: 0.8411779 Vali Loss: 0.6054103 Best vali loss: 0.6033829
	iters: 100, epoch: 7 | loss: 0.6096018
	speed: 0.0109s/iter; left time: 4.2612s
	iters: 200, epoch: 7 | loss: 0.8510423
	speed: 0.0035s/iter; left time: 1.0070s
Updating learning rate to 8.85662146875e-06
Epoch: 7 cost time: 1.0167758464813232
Epoch: 7, Steps: 245 | Train Loss: 0.7303221 Vali Loss: 0.6054786 Best vali loss: 0.6033829
	iters: 100, epoch: 8 | loss: 0.8467847
	speed: 0.0068s/iter; left time: 0.9916s
	iters: 200, epoch: 8 | loss: 0.4279847
	speed: 0.0040s/iter; left time: 0.1835s
Updating learning rate to 4.428310734375e-06
Epoch: 8 cost time: 0.9486327171325684
Epoch: 8, Steps: 245 | Train Loss: 0.6373847 Vali Loss: 0.6059716 Best vali loss: 0.6033829

best validation loss 0.6033829445090905

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0028852829179, 'e_layers': 3, 'learning_rate': 0.0002361458543, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7501652
	speed: 0.0125s/iter; left time: 23.2107s
	iters: 200, epoch: 1 | loss: 0.6903953
	speed: 0.0076s/iter; left time: 13.3412s
Updating learning rate to 0.0002361458543
Validation loss decreased (inf --> 0.6120).  Saving model state dict ...
Epoch: 1 cost time: 2.05597186088562
Epoch: 1, Steps: 245 | Train Loss: 0.7202802 Vali Loss: 0.6120103 Best vali loss: 0.6120103
	iters: 100, epoch: 2 | loss: 0.9626784
	speed: 0.0112s/iter; left time: 18.1624s
	iters: 200, epoch: 2 | loss: 0.9849756
	speed: 0.0058s/iter; left time: 8.7544s
Updating learning rate to 0.00011807292715
Validation loss decreased (0.6120 --> 0.5662).  Saving model state dict ...
Epoch: 2 cost time: 1.4327776432037354
Epoch: 2, Steps: 245 | Train Loss: 0.9738270 Vali Loss: 0.5662087 Best vali loss: 0.5662087
	iters: 100, epoch: 3 | loss: 0.7816627
	speed: 0.0136s/iter; left time: 18.6953s
	iters: 200, epoch: 3 | loss: 0.7017866
	speed: 0.0065s/iter; left time: 8.2393s
Updating learning rate to 5.9036463575e-05
Validation loss decreased (0.5662 --> 0.5620).  Saving model state dict ...
Epoch: 3 cost time: 1.6837496757507324
Epoch: 3, Steps: 245 | Train Loss: 0.7417246 Vali Loss: 0.5620289 Best vali loss: 0.5620289
	iters: 100, epoch: 4 | loss: 0.4215500
	speed: 0.0139s/iter; left time: 15.6795s
	iters: 200, epoch: 4 | loss: 0.9326066
	speed: 0.0063s/iter; left time: 6.4353s
Updating learning rate to 2.95182317875e-05
Validation loss decreased (0.5620 --> 0.5447).  Saving model state dict ...
Epoch: 4 cost time: 1.6676390171051025
Epoch: 4, Steps: 245 | Train Loss: 0.6770783 Vali Loss: 0.5447028 Best vali loss: 0.5447028
	iters: 100, epoch: 5 | loss: 0.7941372
	speed: 0.0128s/iter; left time: 11.2697s
	iters: 200, epoch: 5 | loss: 0.7921230
	speed: 0.0050s/iter; left time: 3.8751s
Updating learning rate to 1.475911589375e-05
Validation loss decreased (0.5447 --> 0.5435).  Saving model state dict ...
Epoch: 5 cost time: 1.4022953510284424
Epoch: 5, Steps: 245 | Train Loss: 0.7931301 Vali Loss: 0.5434788 Best vali loss: 0.5434788
	iters: 100, epoch: 6 | loss: 0.6234409
	speed: 0.0139s/iter; left time: 8.8435s
	iters: 200, epoch: 6 | loss: 0.7816392
	speed: 0.0072s/iter; left time: 3.8552s
Updating learning rate to 7.379557946875e-06
Validation loss decreased (0.5435 --> 0.5421).  Saving model state dict ...
Epoch: 6 cost time: 1.8047981262207031
Epoch: 6, Steps: 245 | Train Loss: 0.7025400 Vali Loss: 0.5421436 Best vali loss: 0.5421436
	iters: 100, epoch: 7 | loss: 0.8916936
	speed: 0.0142s/iter; left time: 5.5420s
	iters: 200, epoch: 7 | loss: 0.6318731
	speed: 0.0066s/iter; left time: 1.9300s
Updating learning rate to 3.6897789734375e-06
Epoch: 7 cost time: 1.7256088256835938
Epoch: 7, Steps: 245 | Train Loss: 0.7617834 Vali Loss: 0.5443935 Best vali loss: 0.5421436
	iters: 100, epoch: 8 | loss: 0.6632788
	speed: 0.0136s/iter; left time: 1.9820s
	iters: 200, epoch: 8 | loss: 0.6965247
	speed: 0.0072s/iter; left time: 0.3312s
Updating learning rate to 1.84488948671875e-06
Validation loss decreased (0.5421 --> 0.5412).  Saving model state dict ...
Epoch: 8 cost time: 1.7963666915893555
Epoch: 8, Steps: 245 | Train Loss: 0.6799017 Vali Loss: 0.5412400 Best vali loss: 0.5412400

best validation loss 0.5412400412592607

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0012835601999, 'e_layers': 3, 'learning_rate': 0.0002687323862, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00025850436876654926
Validation loss decreased (inf --> 0.6149).  Saving model state dict ...
Epoch: 1 cost time: 0.913611650466919
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6149163 Best vali loss: 0.6149163
Updating learning rate to 0.00022937743940323107
Validation loss decreased (0.6149 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 0.5716509819030762
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6048208 Best vali loss: 0.6048208
Updating learning rate to 0.00018578590906933844
Validation loss decreased (0.6048 --> 0.5998).  Saving model state dict ...
Epoch: 3 cost time: 0.5842173099517822
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5998435 Best vali loss: 0.5998435

best validation loss 0.5998435410455882

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 1, 'learning_rate': 0.0005898855996, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005898855996
Validation loss decreased (inf --> 0.6085).  Saving model state dict ...
Epoch: 1 cost time: 0.7517344951629639
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6084551 Best vali loss: 0.6084551
Updating learning rate to 0.0002949427998
Epoch: 2 cost time: 0.5796864032745361
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6119526 Best vali loss: 0.6084551
Updating learning rate to 0.0001474713999
Epoch: 3 cost time: 0.49999380111694336
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6102399 Best vali loss: 0.6084551

best validation loss 0.6084551189520578

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0016289526749, 'e_layers': 4, 'learning_rate': 0.0001397169929, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.8414669
	speed: 0.0127s/iter; left time: 48.6016s
	iters: 200, epoch: 1 | loss: 0.6800017
	speed: 0.0071s/iter; left time: 26.4253s
	iters: 300, epoch: 1 | loss: 0.6768470
	speed: 0.0073s/iter; left time: 26.2916s
	iters: 400, epoch: 1 | loss: 0.7622894
	speed: 0.0071s/iter; left time: 25.0431s
Updating learning rate to 0.0001397169929
Validation loss decreased (inf --> 0.6158).  Saving model state dict ...
Epoch: 1 cost time: 3.8132123947143555
Epoch: 1, Steps: 490 | Train Loss: 0.9901513 Vali Loss: 0.6158179 Best vali loss: 0.6158179
	iters: 100, epoch: 2 | loss: 1.7543120
	speed: 0.0190s/iter; left time: 63.1714s
	iters: 200, epoch: 2 | loss: 0.8144460
	speed: 0.0070s/iter; left time: 22.5513s
	iters: 300, epoch: 2 | loss: 0.4796841
	speed: 0.0071s/iter; left time: 22.3480s
	iters: 400, epoch: 2 | loss: 0.6575221
	speed: 0.0072s/iter; left time: 21.7074s
Updating learning rate to 6.985849645e-05
Validation loss decreased (0.6158 --> 0.6092).  Saving model state dict ...
Epoch: 2 cost time: 3.498652935028076
Epoch: 2, Steps: 490 | Train Loss: 0.9264911 Vali Loss: 0.6091547 Best vali loss: 0.6091547
	iters: 100, epoch: 3 | loss: 0.8496323
	speed: 0.0187s/iter; left time: 53.0448s
	iters: 200, epoch: 3 | loss: 0.4334964
	speed: 0.0072s/iter; left time: 19.6304s
	iters: 300, epoch: 3 | loss: 1.2469409
	speed: 0.0071s/iter; left time: 18.6460s
	iters: 400, epoch: 3 | loss: 0.7027755
	speed: 0.0074s/iter; left time: 18.6990s
Updating learning rate to 3.4929248225e-05
Validation loss decreased (0.6092 --> 0.6032).  Saving model state dict ...
Epoch: 3 cost time: 3.5561976432800293
Epoch: 3, Steps: 490 | Train Loss: 0.8082112 Vali Loss: 0.6032189 Best vali loss: 0.6032189

best validation loss 0.6032189407706096

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0012835601999, 'e_layers': 3, 'learning_rate': 0.0002687323862, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001343661931
Epoch: 4 cost time: 0.8300764560699463
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6036702 Best vali loss: 0.5998435
Updating learning rate to 8.294647713066156e-05
Validation loss decreased (0.5998 --> 0.5865).  Saving model state dict ...
Epoch: 5 cost time: 0.7017300128936768
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5864843 Best vali loss: 0.5864843
Updating learning rate to 3.935494679676891e-05
Validation loss decreased (0.5865 --> 0.5575).  Saving model state dict ...
Epoch: 6 cost time: 0.5890474319458008
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5574893 Best vali loss: 0.5574893
Updating learning rate to 1.0228017433450717e-05
Validation loss decreased (0.5575 --> 0.5567).  Saving model state dict ...
Epoch: 7 cost time: 0.5662727355957031
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5567464 Best vali loss: 0.5567464
Updating learning rate to 0.0
Validation loss decreased (0.5567 --> 0.5543).  Saving model state dict ...
Epoch: 8 cost time: 0.5594217777252197
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5543407 Best vali loss: 0.5543407

best validation loss 0.5543406758800473

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0057222340446, 'e_layers': 2, 'learning_rate': 0.0034968811975, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1590109
	speed: 0.0120s/iter; left time: 22.2593s
	iters: 200, epoch: 1 | loss: 0.9503768
	speed: 0.0044s/iter; left time: 7.7203s
Updating learning rate to 0.0033637890817469042
Validation loss decreased (inf --> 0.6180).  Saving model state dict ...
Epoch: 1 cost time: 1.513094425201416
Epoch: 1, Steps: 245 | Train Loss: 1.0546938 Vali Loss: 0.6179590 Best vali loss: 0.6179590
	iters: 100, epoch: 2 | loss: 0.8758368
	speed: 0.0086s/iter; left time: 13.9437s
	iters: 200, epoch: 2 | loss: 1.1479381
	speed: 0.0044s/iter; left time: 6.6577s
Updating learning rate to 0.002984774802627992
Epoch: 2 cost time: 1.1108293533325195
Epoch: 2, Steps: 245 | Train Loss: 1.0118875 Vali Loss: 0.6618379 Best vali loss: 0.6179590
	iters: 100, epoch: 3 | loss: 0.6689299
	speed: 0.0093s/iter; left time: 12.6861s
	iters: 200, epoch: 3 | loss: 1.2408248
	speed: 0.0044s/iter; left time: 5.6332s
Updating learning rate to 0.002417539848366123
Epoch: 3 cost time: 1.1363129615783691
Epoch: 3, Steps: 245 | Train Loss: 0.9548774 Vali Loss: 0.6590567 Best vali loss: 0.6179590
	iters: 100, epoch: 4 | loss: 0.6518566
	speed: 0.0094s/iter; left time: 10.5737s
	iters: 200, epoch: 4 | loss: 0.5351900
	speed: 0.0044s/iter; left time: 4.4730s
Updating learning rate to 0.00174844059875
Validation loss decreased (0.6180 --> 0.6013).  Saving model state dict ...
Epoch: 4 cost time: 1.1309599876403809
Epoch: 4, Steps: 245 | Train Loss: 0.5935233 Vali Loss: 0.6013368 Best vali loss: 0.6013368
	iters: 100, epoch: 5 | loss: 0.7144277
	speed: 0.0094s/iter; left time: 8.2729s
	iters: 200, epoch: 5 | loss: 0.8799707
	speed: 0.0042s/iter; left time: 3.2791s
Updating learning rate to 0.0010793413491338773
Epoch: 5 cost time: 1.106227159500122
Epoch: 5, Steps: 245 | Train Loss: 0.7971992 Vali Loss: 0.6155743 Best vali loss: 0.6013368
	iters: 100, epoch: 6 | loss: 0.6424832
	speed: 0.0093s/iter; left time: 5.8896s
	iters: 200, epoch: 6 | loss: 0.9113898
	speed: 0.0044s/iter; left time: 2.3405s
Updating learning rate to 0.0005121063948720077
Epoch: 6 cost time: 1.1318650245666504
Epoch: 6, Steps: 245 | Train Loss: 0.7769365 Vali Loss: 0.6137605 Best vali loss: 0.6013368
	iters: 100, epoch: 7 | loss: 0.9990309
	speed: 0.0093s/iter; left time: 3.6351s
	iters: 200, epoch: 7 | loss: 1.0396918
	speed: 0.0044s/iter; left time: 1.2712s
Updating learning rate to 0.00013309211575309574
Epoch: 7 cost time: 1.123734712600708
Epoch: 7, Steps: 245 | Train Loss: 1.0193613 Vali Loss: 0.6183049 Best vali loss: 0.6013368
	iters: 100, epoch: 8 | loss: 0.9613901
	speed: 0.0092s/iter; left time: 1.3447s
	iters: 200, epoch: 8 | loss: 0.7977414
	speed: 0.0044s/iter; left time: 0.2020s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.13620924949646
Epoch: 8, Steps: 245 | Train Loss: 0.8795658 Vali Loss: 0.6276632 Best vali loss: 0.6013368

best validation loss 0.6013368477097599

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0094054645347, 'e_layers': 3, 'learning_rate': 8.14571881e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6349611
	speed: 0.0116s/iter; left time: 21.6751s
	iters: 200, epoch: 1 | loss: 1.0928348
	speed: 0.0058s/iter; left time: 10.1620s
Updating learning rate to 8.14571881e-05
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 1.7345669269561768
Epoch: 1, Steps: 245 | Train Loss: 0.8638979 Vali Loss: 0.6041138 Best vali loss: 0.6041138
	iters: 100, epoch: 2 | loss: 1.0905739
	speed: 0.0119s/iter; left time: 19.1738s
	iters: 200, epoch: 2 | loss: 0.5678771
	speed: 0.0060s/iter; left time: 9.1664s
Updating learning rate to 4.072859405e-05
Epoch: 2 cost time: 1.5289931297302246
Epoch: 2, Steps: 245 | Train Loss: 0.8292255 Vali Loss: 0.6050401 Best vali loss: 0.6041138
	iters: 100, epoch: 3 | loss: 0.8383761
	speed: 0.0119s/iter; left time: 16.3244s
	iters: 200, epoch: 3 | loss: 0.9470130
	speed: 0.0058s/iter; left time: 7.3564s
Updating learning rate to 2.0364297025e-05
Validation loss decreased (0.6041 --> 0.5932).  Saving model state dict ...
Epoch: 3 cost time: 1.448491096496582
Epoch: 3, Steps: 245 | Train Loss: 0.8926945 Vali Loss: 0.5932053 Best vali loss: 0.5932053
	iters: 100, epoch: 4 | loss: 0.9997901
	speed: 0.0106s/iter; left time: 11.9773s
	iters: 200, epoch: 4 | loss: 0.5672903
	speed: 0.0057s/iter; left time: 5.8605s
Updating learning rate to 1.01821485125e-05
Validation loss decreased (0.5932 --> 0.5882).  Saving model state dict ...
Epoch: 4 cost time: 1.41001296043396
Epoch: 4, Steps: 245 | Train Loss: 0.7835402 Vali Loss: 0.5881987 Best vali loss: 0.5881987
	iters: 100, epoch: 5 | loss: 0.9116183
	speed: 0.0117s/iter; left time: 10.2738s
	iters: 200, epoch: 5 | loss: 0.8223166
	speed: 0.0059s/iter; left time: 4.5805s
Updating learning rate to 5.09107425625e-06
Validation loss decreased (0.5882 --> 0.5798).  Saving model state dict ...
Epoch: 5 cost time: 1.480635166168213
Epoch: 5, Steps: 245 | Train Loss: 0.8669674 Vali Loss: 0.5798387 Best vali loss: 0.5798387
	iters: 100, epoch: 6 | loss: 0.9495239
	speed: 0.0116s/iter; left time: 7.3831s
	iters: 200, epoch: 6 | loss: 0.5173305
	speed: 0.0058s/iter; left time: 3.1255s
Updating learning rate to 2.545537128125e-06
Epoch: 6 cost time: 1.48042631149292
Epoch: 6, Steps: 245 | Train Loss: 0.7334272 Vali Loss: 0.5848672 Best vali loss: 0.5798387
	iters: 100, epoch: 7 | loss: 0.4826133
	speed: 0.0119s/iter; left time: 4.6428s
	iters: 200, epoch: 7 | loss: 0.5919175
	speed: 0.0056s/iter; left time: 1.6400s
Updating learning rate to 1.2727685640625e-06
Epoch: 7 cost time: 1.4696321487426758
Epoch: 7, Steps: 245 | Train Loss: 0.5372654 Vali Loss: 0.5808985 Best vali loss: 0.5798387
	iters: 100, epoch: 8 | loss: 0.4642864
	speed: 0.0116s/iter; left time: 1.6933s
	iters: 200, epoch: 8 | loss: 0.8618113
	speed: 0.0059s/iter; left time: 0.2698s
Updating learning rate to 6.3638428203125e-07
Epoch: 8 cost time: 1.4871485233306885
Epoch: 8, Steps: 245 | Train Loss: 0.6630488 Vali Loss: 0.5803896 Best vali loss: 0.5798387

best validation loss 0.5798386769237368

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041361621611, 'e_layers': 2, 'learning_rate': 7.55918174e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8472273
	speed: 0.0110s/iter; left time: 9.6944s
Updating learning rate to 7.271477516059527e-05
Validation loss decreased (inf --> 0.5978).  Saving model state dict ...
Epoch: 1 cost time: 0.9316709041595459
Epoch: 1, Steps: 123 | Train Loss: 0.8472273 Vali Loss: 0.5977584 Best vali loss: 0.5977584
	iters: 100, epoch: 2 | loss: 1.1401634
	speed: 0.0098s/iter; left time: 7.4916s
Updating learning rate to 6.452165204287762e-05
Epoch: 2 cost time: 0.7981085777282715
Epoch: 2, Steps: 123 | Train Loss: 1.1401634 Vali Loss: 0.5983763 Best vali loss: 0.5977584
	iters: 100, epoch: 3 | loss: 0.6329320
	speed: 0.0096s/iter; left time: 6.1395s
Updating learning rate to 5.2259776770673556e-05
Validation loss decreased (0.5978 --> 0.5971).  Saving model state dict ...
Epoch: 3 cost time: 0.7908308506011963
Epoch: 3, Steps: 123 | Train Loss: 0.6329320 Vali Loss: 0.5971054 Best vali loss: 0.5971054

best validation loss 0.5971054436707044

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0048004007546, 'e_layers': 3, 'learning_rate': 0.0014807515313, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1958876
	speed: 0.0112s/iter; left time: 20.8374s
	iters: 200, epoch: 1 | loss: 0.8439615
	speed: 0.0053s/iter; left time: 9.2791s
Updating learning rate to 0.0014807515313
Validation loss decreased (inf --> 0.6247).  Saving model state dict ...
Epoch: 1 cost time: 1.5999417304992676
Epoch: 1, Steps: 245 | Train Loss: 1.0199245 Vali Loss: 0.6247005 Best vali loss: 0.6247005
	iters: 100, epoch: 2 | loss: 0.8226826
	speed: 0.0103s/iter; left time: 16.5654s
	iters: 200, epoch: 2 | loss: 1.1125612
	speed: 0.0057s/iter; left time: 8.6290s
Updating learning rate to 0.00074037576565
Epoch: 2 cost time: 1.384875774383545
Epoch: 2, Steps: 245 | Train Loss: 0.9676219 Vali Loss: 0.6268093 Best vali loss: 0.6247005
	iters: 100, epoch: 3 | loss: 0.4837081
	speed: 0.0110s/iter; left time: 15.0385s
	iters: 200, epoch: 3 | loss: 0.7839229
	speed: 0.0058s/iter; left time: 7.3231s
Updating learning rate to 0.000370187882825
Validation loss decreased (0.6247 --> 0.6113).  Saving model state dict ...
Epoch: 3 cost time: 1.4526207447052002
Epoch: 3, Steps: 245 | Train Loss: 0.6338155 Vali Loss: 0.6113167 Best vali loss: 0.6113167

best validation loss 0.6113166703718892

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013851757765, 'e_layers': 4, 'learning_rate': 7.13798299e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9800497
	speed: 0.0123s/iter; left time: 22.9616s
	iters: 200, epoch: 1 | loss: 0.9699422
	speed: 0.0064s/iter; left time: 11.2016s
Updating learning rate to 6.866309688937358e-05
Validation loss decreased (inf --> 0.6344).  Saving model state dict ...
Epoch: 1 cost time: 1.8745677471160889
Epoch: 1, Steps: 245 | Train Loss: 0.9749959 Vali Loss: 0.6343546 Best vali loss: 0.6343546
	iters: 100, epoch: 2 | loss: 0.7246288
	speed: 0.0130s/iter; left time: 20.9581s
	iters: 200, epoch: 2 | loss: 0.7902623
	speed: 0.0069s/iter; left time: 10.4250s
Updating learning rate to 6.0926495831116134e-05
Validation loss decreased (0.6344 --> 0.6153).  Saving model state dict ...
Epoch: 2 cost time: 1.712071418762207
Epoch: 2, Steps: 245 | Train Loss: 0.7574455 Vali Loss: 0.6153294 Best vali loss: 0.6153294
	iters: 100, epoch: 3 | loss: 0.8688116
	speed: 0.0132s/iter; left time: 18.1106s
	iters: 200, epoch: 3 | loss: 0.8990864
	speed: 0.0072s/iter; left time: 9.1213s
Updating learning rate to 4.934785410388413e-05
Validation loss decreased (0.6153 --> 0.6071).  Saving model state dict ...
Epoch: 3 cost time: 1.7916836738586426
Epoch: 3, Steps: 245 | Train Loss: 0.8839490 Vali Loss: 0.6070880 Best vali loss: 0.6070880

best validation loss 0.607088008698133

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041361621611, 'e_layers': 2, 'learning_rate': 7.55918174e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7040923
	speed: 0.0118s/iter; left time: 6.0685s
Updating learning rate to 3.77959087e-05
Validation loss decreased (0.5971 --> 0.5679).  Saving model state dict ...
Epoch: 4 cost time: 1.0124380588531494
Epoch: 4, Steps: 123 | Train Loss: 0.7040923 Vali Loss: 0.5679106 Best vali loss: 0.5679106
	iters: 100, epoch: 5 | loss: 0.9882782
	speed: 0.0111s/iter; left time: 4.3575s
Updating learning rate to 2.333204062932644e-05
Validation loss decreased (0.5679 --> 0.5631).  Saving model state dict ...
Epoch: 5 cost time: 0.8341808319091797
Epoch: 5, Steps: 123 | Train Loss: 0.9882782 Vali Loss: 0.5630655 Best vali loss: 0.5630655
	iters: 100, epoch: 6 | loss: 0.5764117
	speed: 0.0106s/iter; left time: 2.8577s
Updating learning rate to 1.1070165357122374e-05
Validation loss decreased (0.5631 --> 0.5557).  Saving model state dict ...
Epoch: 6 cost time: 0.8124098777770996
Epoch: 6, Steps: 123 | Train Loss: 0.5764117 Vali Loss: 0.5557176 Best vali loss: 0.5557176
	iters: 100, epoch: 7 | loss: 1.0317186
	speed: 0.0112s/iter; left time: 1.6498s
Updating learning rate to 2.8770422394047244e-06
Epoch: 7 cost time: 0.863884687423706
Epoch: 7, Steps: 123 | Train Loss: 1.0317186 Vali Loss: 0.5567760 Best vali loss: 0.5557176
	iters: 100, epoch: 8 | loss: 0.8349441
	speed: 0.0113s/iter; left time: 0.2714s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8529496192932129
Epoch: 8, Steps: 123 | Train Loss: 0.8349441 Vali Loss: 0.5608529 Best vali loss: 0.5557176

best validation loss 0.5557175556414109

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0031194239568, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.6316).  Saving model state dict ...
Epoch: 1 cost time: 0.9861679077148438
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6315900 Best vali loss: 0.6315900
Updating learning rate to 0.00034048964815
Validation loss decreased (0.6316 --> 0.6165).  Saving model state dict ...
Epoch: 2 cost time: 0.7746942043304443
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6165111 Best vali loss: 0.6165111
Updating learning rate to 0.000170244824075
Validation loss decreased (0.6165 --> 0.6165).  Saving model state dict ...
Epoch: 3 cost time: 0.5464975833892822
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6164683 Best vali loss: 0.6164683
Updating learning rate to 8.51224120375e-05
Epoch: 4 cost time: 0.58026123046875
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6174661 Best vali loss: 0.6164683
Updating learning rate to 4.256120601875e-05
Validation loss decreased (0.6165 --> 0.6117).  Saving model state dict ...
Epoch: 5 cost time: 0.5837602615356445
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6116858 Best vali loss: 0.6116858
Updating learning rate to 2.1280603009375e-05
Validation loss decreased (0.6117 --> 0.6111).  Saving model state dict ...
Epoch: 6 cost time: 0.5877265930175781
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6110581 Best vali loss: 0.6110581
Updating learning rate to 1.06403015046875e-05
Epoch: 7 cost time: 0.5840945243835449
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6119404 Best vali loss: 0.6110581
Updating learning rate to 5.32015075234375e-06
Epoch: 8 cost time: 0.575690507888794
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6119531 Best vali loss: 0.6110581

best validation loss 0.6110581374179429

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0023685291638, 'e_layers': 1, 'learning_rate': 0.0009803611309, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0726477
	speed: 0.0095s/iter; left time: 36.3995s
	iters: 200, epoch: 1 | loss: 0.6712570
	speed: 0.0037s/iter; left time: 13.7638s
	iters: 300, epoch: 1 | loss: 1.1508508
	speed: 0.0036s/iter; left time: 12.9358s
	iters: 400, epoch: 1 | loss: 0.6235827
	speed: 0.0039s/iter; left time: 13.6911s
Updating learning rate to 0.0009430483571040641
Validation loss decreased (inf --> 0.5972).  Saving model state dict ...
Epoch: 1 cost time: 2.100048303604126
Epoch: 1, Steps: 490 | Train Loss: 0.8795845 Vali Loss: 0.5971758 Best vali loss: 0.5971758
	iters: 100, epoch: 2 | loss: 1.0793586
	speed: 0.0124s/iter; left time: 41.3592s
	iters: 200, epoch: 2 | loss: 0.9549001
	speed: 0.0037s/iter; left time: 11.9483s
	iters: 300, epoch: 2 | loss: 0.4812413
	speed: 0.0035s/iter; left time: 11.0556s
	iters: 400, epoch: 2 | loss: 1.3541573
	speed: 0.0036s/iter; left time: 11.0055s
Updating learning rate to 0.0008367905672855512
Epoch: 2 cost time: 1.862757682800293
Epoch: 2, Steps: 490 | Train Loss: 0.9674143 Vali Loss: 0.6221229 Best vali loss: 0.5971758
	iters: 100, epoch: 3 | loss: 0.4825081
	speed: 0.0115s/iter; left time: 32.6086s
	iters: 200, epoch: 3 | loss: 1.2135540
	speed: 0.0035s/iter; left time: 9.5004s
	iters: 300, epoch: 3 | loss: 0.6259158
	speed: 0.0036s/iter; left time: 9.5535s
	iters: 400, epoch: 3 | loss: 0.9429840
	speed: 0.0034s/iter; left time: 8.6670s
Updating learning rate to 0.0006777645467150665
Epoch: 3 cost time: 1.7503032684326172
Epoch: 3, Steps: 490 | Train Loss: 0.8162405 Vali Loss: 0.6109905 Best vali loss: 0.5971758
	iters: 100, epoch: 4 | loss: 0.8472318
	speed: 0.0111s/iter; left time: 26.0173s
	iters: 200, epoch: 4 | loss: 0.5775800
	speed: 0.0029s/iter; left time: 6.6093s
	iters: 300, epoch: 4 | loss: 0.4255542
	speed: 0.0028s/iter; left time: 6.0152s
	iters: 400, epoch: 4 | loss: 0.9621504
	speed: 0.0040s/iter; left time: 8.1173s
Updating learning rate to 0.00049018056545
Epoch: 4 cost time: 1.5931065082550049
Epoch: 4, Steps: 490 | Train Loss: 0.7031291 Vali Loss: 0.6184106 Best vali loss: 0.5971758
	iters: 100, epoch: 5 | loss: 0.4900669
	speed: 0.0121s/iter; left time: 22.5349s
	iters: 200, epoch: 5 | loss: 0.6194184
	speed: 0.0042s/iter; left time: 7.3420s
	iters: 300, epoch: 5 | loss: 0.7935801
	speed: 0.0027s/iter; left time: 4.5069s
	iters: 400, epoch: 5 | loss: 0.9243940
	speed: 0.0025s/iter; left time: 3.8747s
Updating learning rate to 0.0003025965841849335
Epoch: 5 cost time: 1.589641809463501
Epoch: 5, Steps: 490 | Train Loss: 0.7068648 Vali Loss: 0.6259895 Best vali loss: 0.5971758
	iters: 100, epoch: 6 | loss: 0.5686574
	speed: 0.0103s/iter; left time: 14.0685s
	iters: 200, epoch: 6 | loss: 0.7195011
	speed: 0.0035s/iter; left time: 4.4621s
	iters: 300, epoch: 6 | loss: 0.6295429
	speed: 0.0040s/iter; left time: 4.6663s
	iters: 400, epoch: 6 | loss: 0.2420985
	speed: 0.0033s/iter; left time: 3.5016s
Updating learning rate to 0.00014357056361444874
Epoch: 6 cost time: 1.8376314640045166
Epoch: 6, Steps: 490 | Train Loss: 0.5399500 Vali Loss: 0.6294092 Best vali loss: 0.5971758
	iters: 100, epoch: 7 | loss: 0.6559288
	speed: 0.0119s/iter; left time: 10.5088s
	iters: 200, epoch: 7 | loss: 0.5230400
	speed: 0.0035s/iter; left time: 2.7411s
	iters: 300, epoch: 7 | loss: 0.4549692
	speed: 0.0043s/iter; left time: 2.9364s
	iters: 400, epoch: 7 | loss: 0.5970958
	speed: 0.0036s/iter; left time: 2.1037s
Updating learning rate to 3.7312773795935806e-05
Epoch: 7 cost time: 1.8623974323272705
Epoch: 7, Steps: 490 | Train Loss: 0.5577584 Vali Loss: 0.6277941 Best vali loss: 0.5971758
	iters: 100, epoch: 8 | loss: 0.6741666
	speed: 0.0119s/iter; left time: 4.6626s
	iters: 200, epoch: 8 | loss: 0.4690822
	speed: 0.0035s/iter; left time: 1.0080s
	iters: 300, epoch: 8 | loss: 0.4448198
	speed: 0.0037s/iter; left time: 0.7036s
	iters: 400, epoch: 8 | loss: 0.8320480
	speed: 0.0034s/iter; left time: 0.3138s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7619585990905762
Epoch: 8, Steps: 490 | Train Loss: 0.6050291 Vali Loss: 0.6226073 Best vali loss: 0.5971758

best validation loss 0.5971757983689725

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012374140538, 'e_layers': 2, 'learning_rate': 0.0005328478516, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7809259
	speed: 0.0117s/iter; left time: 10.3673s
Updating learning rate to 0.0005328478516
Validation loss decreased (inf --> 0.6266).  Saving model state dict ...
Epoch: 1 cost time: 1.031043529510498
Epoch: 1, Steps: 123 | Train Loss: 0.7809259 Vali Loss: 0.6266021 Best vali loss: 0.6266021
	iters: 100, epoch: 2 | loss: 0.7349592
	speed: 0.0102s/iter; left time: 7.7733s
Updating learning rate to 0.0002664239258
Validation loss decreased (0.6266 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 0.7886974811553955
Epoch: 2, Steps: 123 | Train Loss: 0.7349592 Vali Loss: 0.6065002 Best vali loss: 0.6065002
	iters: 100, epoch: 3 | loss: 0.9341732
	speed: 0.0103s/iter; left time: 6.6067s
Updating learning rate to 0.0001332119629
Validation loss decreased (0.6065 --> 0.6061).  Saving model state dict ...
Epoch: 3 cost time: 0.8321278095245361
Epoch: 3, Steps: 123 | Train Loss: 0.9341732 Vali Loss: 0.6061472 Best vali loss: 0.6061472

best validation loss 0.6061471513386735

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0062416843763, 'e_layers': 1, 'learning_rate': 6.62506528e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8380728
	speed: 0.0093s/iter; left time: 35.6258s
	iters: 200, epoch: 1 | loss: 0.5811340
	speed: 0.0033s/iter; left time: 12.2115s
	iters: 300, epoch: 1 | loss: 0.6976778
	speed: 0.0038s/iter; left time: 13.7987s
	iters: 400, epoch: 1 | loss: 0.8993956
	speed: 0.0036s/iter; left time: 12.7608s
Updating learning rate to 6.372913746871579e-05
Validation loss decreased (inf --> 0.6054).  Saving model state dict ...
Epoch: 1 cost time: 2.038802146911621
Epoch: 1, Steps: 490 | Train Loss: 0.7540700 Vali Loss: 0.6054222 Best vali loss: 0.6054222
	iters: 100, epoch: 2 | loss: 0.8235441
	speed: 0.0119s/iter; left time: 39.5176s
	iters: 200, epoch: 2 | loss: 0.8304928
	speed: 0.0037s/iter; left time: 11.8261s
	iters: 300, epoch: 2 | loss: 0.6285025
	speed: 0.0037s/iter; left time: 11.4623s
	iters: 400, epoch: 2 | loss: 0.8634671
	speed: 0.0038s/iter; left time: 11.4902s
Updating learning rate to 5.654846932645776e-05
Epoch: 2 cost time: 1.8822863101959229
Epoch: 2, Steps: 490 | Train Loss: 0.7865016 Vali Loss: 0.6112451 Best vali loss: 0.6054222
	iters: 100, epoch: 3 | loss: 1.2881236
	speed: 0.0118s/iter; left time: 33.4141s
	iters: 200, epoch: 3 | loss: 0.5678384
	speed: 0.0036s/iter; left time: 9.9097s
	iters: 300, epoch: 3 | loss: 0.8758943
	speed: 0.0036s/iter; left time: 9.6181s
	iters: 400, epoch: 3 | loss: 1.3829379
	speed: 0.0036s/iter; left time: 9.0967s
Updating learning rate to 4.580184000496592e-05
Epoch: 3 cost time: 1.8201172351837158
Epoch: 3, Steps: 490 | Train Loss: 1.0286985 Vali Loss: 0.6120461 Best vali loss: 0.6054222

best validation loss 0.6054221767895975

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023549867609129905
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 0.7196471691131592
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6208343 Best vali loss: 0.6208343
Updating learning rate to 0.00020896390866591454
Validation loss decreased (0.6208 --> 0.6042).  Saving model state dict ...
Epoch: 2 cost time: 0.4652888774871826
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6042040 Best vali loss: 0.6042040
Updating learning rate to 0.00016925182282609557
Validation loss decreased (0.6042 --> 0.6000).  Saving model state dict ...
Epoch: 3 cost time: 0.6871395111083984
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5999673 Best vali loss: 0.5999673

best validation loss 0.5999673262121279

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00012240822365
Epoch: 4 cost time: 0.8765265941619873
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6010500 Best vali loss: 0.5999673
Updating learning rate to 7.556462447390446e-05
Validation loss decreased (0.6000 --> 0.5811).  Saving model state dict ...
Epoch: 5 cost time: 0.6940038204193115
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5810700 Best vali loss: 0.5810700
Updating learning rate to 3.585253863408549e-05
Validation loss decreased (0.5811 --> 0.5782).  Saving model state dict ...
Epoch: 6 cost time: 0.6546890735626221
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5781842 Best vali loss: 0.5781842
Updating learning rate to 9.317771208700968e-06
Epoch: 7 cost time: 0.6671476364135742
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5878448 Best vali loss: 0.5781842
Updating learning rate to 0.0
Validation loss decreased (0.5782 --> 0.5755).  Saving model state dict ...
Epoch: 8 cost time: 0.6948401927947998
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5754678 Best vali loss: 0.5754678

best validation loss 0.5754678419815727

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0015412585082, 'e_layers': 1, 'learning_rate': 0.0019773820382, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019773820382
Validation loss decreased (inf --> 0.6098).  Saving model state dict ...
Epoch: 1 cost time: 0.839641809463501
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6098052 Best vali loss: 0.6098052
Updating learning rate to 0.0009886910191
Epoch: 2 cost time: 0.5333778858184814
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6216025 Best vali loss: 0.6098052
Updating learning rate to 0.00049434550955
Epoch: 3 cost time: 0.4331779479980469
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6258651 Best vali loss: 0.6098052
Updating learning rate to 0.000247172754775
Epoch: 4 cost time: 0.49880290031433105
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6465775 Best vali loss: 0.6098052
Updating learning rate to 0.0001235863773875
Epoch: 5 cost time: 0.5073950290679932
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6478422 Best vali loss: 0.6098052
Updating learning rate to 6.179318869375e-05
Epoch: 6 cost time: 0.5081126689910889
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6459305 Best vali loss: 0.6098052
Updating learning rate to 3.0896594346875e-05
Epoch: 7 cost time: 0.5185458660125732
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6478952 Best vali loss: 0.6098052
Updating learning rate to 1.54482971734375e-05
Epoch: 8 cost time: 0.5336484909057617
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6475452 Best vali loss: 0.6098052

best validation loss 0.609805230297793

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0026033575383, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8134438
	speed: 0.0123s/iter; left time: 47.0508s
	iters: 200, epoch: 1 | loss: 0.6730589
	speed: 0.0055s/iter; left time: 20.3576s
	iters: 300, epoch: 1 | loss: 0.3921539
	speed: 0.0055s/iter; left time: 19.8730s
	iters: 400, epoch: 1 | loss: 0.8034714
	speed: 0.0060s/iter; left time: 21.2685s
Updating learning rate to 0.0001291814818
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 3.160161018371582
Epoch: 1, Steps: 490 | Train Loss: 0.6705320 Vali Loss: 0.6019730 Best vali loss: 0.6019730
	iters: 100, epoch: 2 | loss: 0.6437793
	speed: 0.0167s/iter; left time: 55.4808s
	iters: 200, epoch: 2 | loss: 0.8930222
	speed: 0.0059s/iter; left time: 18.9609s
	iters: 300, epoch: 2 | loss: 0.8005954
	speed: 0.0056s/iter; left time: 17.6500s
	iters: 400, epoch: 2 | loss: 1.3267643
	speed: 0.0050s/iter; left time: 15.1476s
Updating learning rate to 6.45907409e-05
Epoch: 2 cost time: 2.8436803817749023
Epoch: 2, Steps: 490 | Train Loss: 0.9160403 Vali Loss: 0.6066070 Best vali loss: 0.6019730
	iters: 100, epoch: 3 | loss: 0.8604245
	speed: 0.0163s/iter; left time: 46.3885s
	iters: 200, epoch: 3 | loss: 0.6097847
	speed: 0.0055s/iter; left time: 15.0174s
	iters: 300, epoch: 3 | loss: 1.4518334
	speed: 0.0062s/iter; left time: 16.3090s
	iters: 400, epoch: 3 | loss: 0.9989396
	speed: 0.0059s/iter; left time: 14.9971s
Updating learning rate to 3.229537045e-05
Epoch: 3 cost time: 2.760298728942871
Epoch: 3, Steps: 490 | Train Loss: 0.9802455 Vali Loss: 0.6186790 Best vali loss: 0.6019730
	iters: 100, epoch: 4 | loss: 0.8617511
	speed: 0.0161s/iter; left time: 37.8123s
	iters: 200, epoch: 4 | loss: 0.9487139
	speed: 0.0057s/iter; left time: 12.8168s
	iters: 300, epoch: 4 | loss: 0.4926163
	speed: 0.0040s/iter; left time: 8.6763s
	iters: 400, epoch: 4 | loss: 0.3878654
	speed: 0.0035s/iter; left time: 7.1785s
Updating learning rate to 1.6147685225e-05
Epoch: 4 cost time: 2.309128761291504
Epoch: 4, Steps: 490 | Train Loss: 0.6727367 Vali Loss: 0.6213509 Best vali loss: 0.6019730
	iters: 100, epoch: 5 | loss: 0.3628435
	speed: 0.0143s/iter; left time: 26.6660s
	iters: 200, epoch: 5 | loss: 0.7505442
	speed: 0.0049s/iter; left time: 8.5477s
	iters: 300, epoch: 5 | loss: 0.9409516
	speed: 0.0059s/iter; left time: 9.7549s
	iters: 400, epoch: 5 | loss: 0.7177035
	speed: 0.0043s/iter; left time: 6.6863s
Updating learning rate to 8.0738426125e-06
Epoch: 5 cost time: 2.449864387512207
Epoch: 5, Steps: 490 | Train Loss: 0.6930107 Vali Loss: 0.6216164 Best vali loss: 0.6019730
	iters: 100, epoch: 6 | loss: 0.8108980
	speed: 0.0136s/iter; left time: 18.7020s
	iters: 200, epoch: 6 | loss: 0.4794566
	speed: 0.0050s/iter; left time: 6.3917s
	iters: 300, epoch: 6 | loss: 1.0049026
	speed: 0.0053s/iter; left time: 6.2456s
	iters: 400, epoch: 6 | loss: 0.9921127
	speed: 0.0039s/iter; left time: 4.1375s
Updating learning rate to 4.03692130625e-06
Epoch: 6 cost time: 2.294621229171753
Epoch: 6, Steps: 490 | Train Loss: 0.8218425 Vali Loss: 0.6164254 Best vali loss: 0.6019730
	iters: 100, epoch: 7 | loss: 0.5223579
	speed: 0.0120s/iter; left time: 10.5539s
	iters: 200, epoch: 7 | loss: 0.6978502
	speed: 0.0052s/iter; left time: 4.0750s
	iters: 300, epoch: 7 | loss: 0.5492709
	speed: 0.0053s/iter; left time: 3.5917s
	iters: 400, epoch: 7 | loss: 0.6481890
	speed: 0.0055s/iter; left time: 3.1717s
Updating learning rate to 2.018460653125e-06
Epoch: 7 cost time: 2.6721112728118896
Epoch: 7, Steps: 490 | Train Loss: 0.6044170 Vali Loss: 0.6165218 Best vali loss: 0.6019730
	iters: 100, epoch: 8 | loss: 0.6334842
	speed: 0.0144s/iter; left time: 5.6145s
	iters: 200, epoch: 8 | loss: 0.9433942
	speed: 0.0049s/iter; left time: 1.4236s
	iters: 300, epoch: 8 | loss: 0.8529533
	speed: 0.0054s/iter; left time: 1.0399s
	iters: 400, epoch: 8 | loss: 0.8710912
	speed: 0.0053s/iter; left time: 0.4816s
Updating learning rate to 1.0092303265625e-06
Epoch: 8 cost time: 2.5844905376434326
Epoch: 8, Steps: 490 | Train Loss: 0.8252308 Vali Loss: 0.6183313 Best vali loss: 0.6019730

best validation loss 0.6019729911688024

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0038735474901, 'e_layers': 1, 'learning_rate': 0.0014785219913, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9700105
	speed: 0.0098s/iter; left time: 18.2692s
	iters: 200, epoch: 1 | loss: 0.4945078
	speed: 0.0050s/iter; left time: 8.8241s
Updating learning rate to 0.0014785219913
Validation loss decreased (inf --> 0.6121).  Saving model state dict ...
Epoch: 1 cost time: 1.3745887279510498
Epoch: 1, Steps: 245 | Train Loss: 0.7322591 Vali Loss: 0.6120519 Best vali loss: 0.6120519
	iters: 100, epoch: 2 | loss: 1.0424342
	speed: 0.0093s/iter; left time: 14.9931s
	iters: 200, epoch: 2 | loss: 1.0512201
	speed: 0.0041s/iter; left time: 6.1484s
Updating learning rate to 0.00073926099565
Epoch: 2 cost time: 1.0435638427734375
Epoch: 2, Steps: 245 | Train Loss: 1.0468271 Vali Loss: 0.6223216 Best vali loss: 0.6120519
	iters: 100, epoch: 3 | loss: 0.8077487
	speed: 0.0089s/iter; left time: 12.1536s
	iters: 200, epoch: 3 | loss: 0.8528149
	speed: 0.0041s/iter; left time: 5.1566s
Updating learning rate to 0.000369630497825
Epoch: 3 cost time: 1.0249512195587158
Epoch: 3, Steps: 245 | Train Loss: 0.8302818 Vali Loss: 0.6177250 Best vali loss: 0.6120519

best validation loss 0.6120519365551625

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0033964440824, 'e_layers': 3, 'learning_rate': 0.0014790122285, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014227206773725282
Validation loss decreased (inf --> 0.6060).  Saving model state dict ...
Epoch: 1 cost time: 0.7318055629730225
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6059522 Best vali loss: 0.6059522
Updating learning rate to 0.0012624159023650887
Validation loss decreased (0.6060 --> 0.5951).  Saving model state dict ...
Epoch: 2 cost time: 0.5307676792144775
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5951406 Best vali loss: 0.5951406
Updating learning rate to 0.0010225028523061603
Validation loss decreased (0.5951 --> 0.5789).  Saving model state dict ...
Epoch: 3 cost time: 0.5848829746246338
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5788634 Best vali loss: 0.5788634

best validation loss 0.5788634326765792

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010922907516, 'e_layers': 3, 'learning_rate': 8.12568833e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9875000
	speed: 0.0113s/iter; left time: 43.2651s
	iters: 200, epoch: 1 | loss: 0.9186849
	speed: 0.0061s/iter; left time: 22.5697s
	iters: 300, epoch: 1 | loss: 1.0504009
	speed: 0.0069s/iter; left time: 24.8235s
	iters: 400, epoch: 1 | loss: 0.8418267
	speed: 0.0048s/iter; left time: 16.8288s
Updating learning rate to 8.12568833e-05
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 2.960819959640503
Epoch: 1, Steps: 490 | Train Loss: 0.9496031 Vali Loss: 0.6140126 Best vali loss: 0.6140126
	iters: 100, epoch: 2 | loss: 0.5825824
	speed: 0.0132s/iter; left time: 44.0170s
	iters: 200, epoch: 2 | loss: 1.1878897
	speed: 0.0058s/iter; left time: 18.6912s
	iters: 300, epoch: 2 | loss: 1.1984384
	speed: 0.0058s/iter; left time: 18.0123s
	iters: 400, epoch: 2 | loss: 0.7203468
	speed: 0.0056s/iter; left time: 17.0924s
Updating learning rate to 4.062844165e-05
Validation loss decreased (0.6140 --> 0.6022).  Saving model state dict ...
Epoch: 2 cost time: 2.8457157611846924
Epoch: 2, Steps: 490 | Train Loss: 0.9223143 Vali Loss: 0.6021952 Best vali loss: 0.6021952
	iters: 100, epoch: 3 | loss: 1.2551665
	speed: 0.0168s/iter; left time: 47.8047s
	iters: 200, epoch: 3 | loss: 1.2574720
	speed: 0.0058s/iter; left time: 15.8662s
	iters: 300, epoch: 3 | loss: 1.2473686
	speed: 0.0061s/iter; left time: 16.0427s
	iters: 400, epoch: 3 | loss: 0.8880711
	speed: 0.0057s/iter; left time: 14.3763s
Updating learning rate to 2.0314220825e-05
Validation loss decreased (0.6022 --> 0.5999).  Saving model state dict ...
Epoch: 3 cost time: 2.939664125442505
Epoch: 3, Steps: 490 | Train Loss: 1.1620196 Vali Loss: 0.5999294 Best vali loss: 0.5999294

best validation loss 0.5999294268428479

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0033964440824, 'e_layers': 3, 'learning_rate': 0.0014790122285, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00073950611425
Validation loss decreased (0.5789 --> 0.5741).  Saving model state dict ...
Epoch: 4 cost time: 0.8788473606109619
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5740892 Best vali loss: 0.5740892
Updating learning rate to 0.0004565093761938398
Validation loss decreased (0.5741 --> 0.5644).  Saving model state dict ...
Epoch: 5 cost time: 0.6050999164581299
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5644354 Best vali loss: 0.5644354
Updating learning rate to 0.00021659632613491128
Epoch: 6 cost time: 0.6154420375823975
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5717060 Best vali loss: 0.5644354
Updating learning rate to 5.62915511274718e-05
Validation loss decreased (0.5644 --> 0.5641).  Saving model state dict ...
Epoch: 7 cost time: 0.565666675567627
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5640552 Best vali loss: 0.5640552
Updating learning rate to 0.0
Validation loss decreased (0.5641 --> 0.5567).  Saving model state dict ...
Epoch: 8 cost time: 0.5809581279754639
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5566945 Best vali loss: 0.5566945

best validation loss 0.5566944872709625

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0097884354818, 'e_layers': 4, 'learning_rate': 0.0002505982255, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8666329
	speed: 0.0165s/iter; left time: 14.6264s
Updating learning rate to 0.00024106039846154902
Validation loss decreased (inf --> 0.6088).  Saving model state dict ...
Epoch: 1 cost time: 1.5976688861846924
Epoch: 1, Steps: 123 | Train Loss: 0.8666329 Vali Loss: 0.6088457 Best vali loss: 0.6088457
	iters: 100, epoch: 2 | loss: 0.9000047
	speed: 0.0145s/iter; left time: 11.0651s
Updating learning rate to 0.0002138989650521828
Validation loss decreased (0.6088 --> 0.5829).  Saving model state dict ...
Epoch: 2 cost time: 1.2480735778808594
Epoch: 2, Steps: 123 | Train Loss: 0.9000047 Vali Loss: 0.5828849 Best vali loss: 0.5828849
	iters: 100, epoch: 3 | loss: 0.6001533
	speed: 0.0180s/iter; left time: 11.5139s
Updating learning rate to 0.0001732490072894704
Validation loss decreased (0.5829 --> 0.5758).  Saving model state dict ...
Epoch: 3 cost time: 1.471099615097046
Epoch: 3, Steps: 123 | Train Loss: 0.6001533 Vali Loss: 0.5757651 Best vali loss: 0.5757651
	iters: 100, epoch: 4 | loss: 0.6987961
	speed: 0.0179s/iter; left time: 9.2199s
Updating learning rate to 0.00012529911275
Validation loss decreased (0.5758 --> 0.5621).  Saving model state dict ...
Epoch: 4 cost time: 1.4748001098632812
Epoch: 4, Steps: 123 | Train Loss: 0.6987961 Vali Loss: 0.5620988 Best vali loss: 0.5620988
	iters: 100, epoch: 5 | loss: 0.7264507
	speed: 0.0180s/iter; left time: 7.0560s
Updating learning rate to 7.734921821052962e-05
Validation loss decreased (0.5621 --> 0.5524).  Saving model state dict ...
Epoch: 5 cost time: 1.4573009014129639
Epoch: 5, Steps: 123 | Train Loss: 0.7264507 Vali Loss: 0.5524474 Best vali loss: 0.5524474
	iters: 100, epoch: 6 | loss: 0.7429287
	speed: 0.0182s/iter; left time: 4.9123s
Updating learning rate to 3.669926044781721e-05
Epoch: 6 cost time: 1.5001611709594727
Epoch: 6, Steps: 123 | Train Loss: 0.7429287 Vali Loss: 0.5607279 Best vali loss: 0.5524474
	iters: 100, epoch: 7 | loss: 0.6017390
	speed: 0.0174s/iter; left time: 2.5536s
Updating learning rate to 9.537827038450992e-06
Epoch: 7 cost time: 1.441356897354126
Epoch: 7, Steps: 123 | Train Loss: 0.6017390 Vali Loss: 0.5666368 Best vali loss: 0.5524474
	iters: 100, epoch: 8 | loss: 0.6683106
	speed: 0.0179s/iter; left time: 0.4290s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.48221755027771
Epoch: 8, Steps: 123 | Train Loss: 0.6683106 Vali Loss: 0.5709450 Best vali loss: 0.5524474

best validation loss 0.5524473901370894

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045607678964, 'e_layers': 1, 'learning_rate': 9.30573825e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6980850
	speed: 0.0108s/iter; left time: 20.0534s
	iters: 200, epoch: 1 | loss: 1.2882432
	speed: 0.0047s/iter; left time: 8.2925s
Updating learning rate to 8.9515596770412e-05
Validation loss decreased (inf --> 0.5976).  Saving model state dict ...
Epoch: 1 cost time: 1.4812955856323242
Epoch: 1, Steps: 245 | Train Loss: 0.9931641 Vali Loss: 0.5976180 Best vali loss: 0.5976180
	iters: 100, epoch: 2 | loss: 0.8449128
	speed: 0.0105s/iter; left time: 16.9262s
	iters: 200, epoch: 2 | loss: 0.3827655
	speed: 0.0050s/iter; left time: 7.5586s
Updating learning rate to 7.942944435261018e-05
Epoch: 2 cost time: 1.227555751800537
Epoch: 2, Steps: 245 | Train Loss: 0.6138391 Vali Loss: 0.6061767 Best vali loss: 0.5976180
	iters: 100, epoch: 3 | loss: 1.0353657
	speed: 0.0101s/iter; left time: 13.9078s
	iters: 200, epoch: 3 | loss: 0.9279091
	speed: 0.0050s/iter; left time: 6.3605s
Updating learning rate to 6.433445052100552e-05
Epoch: 3 cost time: 1.2028398513793945
Epoch: 3, Steps: 245 | Train Loss: 0.9816374 Vali Loss: 0.6004852 Best vali loss: 0.5976180
	iters: 100, epoch: 4 | loss: 1.0305892
	speed: 0.0106s/iter; left time: 11.9315s
	iters: 200, epoch: 4 | loss: 0.9198943
	speed: 0.0043s/iter; left time: 4.4093s
Updating learning rate to 4.652869125e-05
Epoch: 4 cost time: 1.162998914718628
Epoch: 4, Steps: 245 | Train Loss: 0.9752418 Vali Loss: 0.6136083 Best vali loss: 0.5976180
	iters: 100, epoch: 5 | loss: 0.8931549
	speed: 0.0110s/iter; left time: 9.7038s
	iters: 200, epoch: 5 | loss: 0.6791094
	speed: 0.0048s/iter; left time: 3.7113s
Updating learning rate to 2.8722931978994484e-05
Epoch: 5 cost time: 1.2486317157745361
Epoch: 5, Steps: 245 | Train Loss: 0.7861321 Vali Loss: 0.6107423 Best vali loss: 0.5976180
	iters: 100, epoch: 6 | loss: 0.5359640
	speed: 0.0091s/iter; left time: 5.7780s
	iters: 200, epoch: 6 | loss: 0.8593542
	speed: 0.0031s/iter; left time: 1.6522s
Updating learning rate to 1.3627938147389826e-05
Epoch: 6 cost time: 0.8093125820159912
Epoch: 6, Steps: 245 | Train Loss: 0.6976591 Vali Loss: 0.6083403 Best vali loss: 0.5976180
	iters: 100, epoch: 7 | loss: 0.9688464
	speed: 0.0072s/iter; left time: 2.8139s
	iters: 200, epoch: 7 | loss: 0.7168036
	speed: 0.0031s/iter; left time: 0.8959s
Updating learning rate to 3.541785729588002e-06
Epoch: 7 cost time: 0.819699764251709
Epoch: 7, Steps: 245 | Train Loss: 0.8428250 Vali Loss: 0.6081839 Best vali loss: 0.5976180
	iters: 100, epoch: 8 | loss: 0.7972280
	speed: 0.0068s/iter; left time: 0.9902s
	iters: 200, epoch: 8 | loss: 0.5720201
	speed: 0.0040s/iter; left time: 0.1862s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0030248165130615
Epoch: 8, Steps: 245 | Train Loss: 0.6846241 Vali Loss: 0.6130446 Best vali loss: 0.5976180

best validation loss 0.5976180035667472

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0038819458795, 'e_layers': 2, 'learning_rate': 0.0002544908897, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002544908897
Validation loss decreased (inf --> 0.6220).  Saving model state dict ...
Epoch: 1 cost time: 0.7026336193084717
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6220024 Best vali loss: 0.6220024
Updating learning rate to 0.00012724544485
Validation loss decreased (0.6220 --> 0.6086).  Saving model state dict ...
Epoch: 2 cost time: 0.5304856300354004
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6086228 Best vali loss: 0.6086228
Updating learning rate to 6.3622722425e-05
Epoch: 3 cost time: 0.5164523124694824
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6094071 Best vali loss: 0.6086228

best validation loss 0.608622800415724

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070932288252, 'e_layers': 4, 'learning_rate': 0.0005299103803, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8093110
	speed: 0.0119s/iter; left time: 91.9837s
	iters: 200, epoch: 1 | loss: 0.6742082
	speed: 0.0067s/iter; left time: 51.1310s
	iters: 300, epoch: 1 | loss: 0.4526658
	speed: 0.0068s/iter; left time: 51.2216s
	iters: 400, epoch: 1 | loss: 0.6470286
	speed: 0.0068s/iter; left time: 50.8849s
	iters: 500, epoch: 1 | loss: 0.9168641
	speed: 0.0063s/iter; left time: 46.1243s
	iters: 600, epoch: 1 | loss: 1.7360890
	speed: 0.0051s/iter; left time: 36.7340s
	iters: 700, epoch: 1 | loss: 0.5545735
	speed: 0.0065s/iter; left time: 46.4949s
	iters: 800, epoch: 1 | loss: 0.4069187
	speed: 0.0073s/iter; left time: 51.1329s
	iters: 900, epoch: 1 | loss: 0.4029653
	speed: 0.0071s/iter; left time: 48.9103s
Updating learning rate to 0.0005299103803
Validation loss decreased (inf --> 0.6177).  Saving model state dict ...
Epoch: 1 cost time: 6.741171836853027
Epoch: 1, Steps: 979 | Train Loss: 0.7334027 Vali Loss: 0.6176816 Best vali loss: 0.6176816
	iters: 100, epoch: 2 | loss: 1.9892484
	speed: 0.0216s/iter; left time: 146.1493s
	iters: 200, epoch: 2 | loss: 0.7574661
	speed: 0.0071s/iter; left time: 47.2669s
	iters: 300, epoch: 2 | loss: 1.3106614
	speed: 0.0072s/iter; left time: 46.8918s
	iters: 400, epoch: 2 | loss: 0.8553803
	speed: 0.0071s/iter; left time: 45.8373s
	iters: 500, epoch: 2 | loss: 1.4426022
	speed: 0.0062s/iter; left time: 39.3129s
	iters: 600, epoch: 2 | loss: 0.9257498
	speed: 0.0050s/iter; left time: 31.1588s
	iters: 700, epoch: 2 | loss: 0.7566344
	speed: 0.0076s/iter; left time: 46.7775s
	iters: 800, epoch: 2 | loss: 0.8904917
	speed: 0.0080s/iter; left time: 48.2112s
	iters: 900, epoch: 2 | loss: 0.7702227
	speed: 0.0076s/iter; left time: 45.0083s
Updating learning rate to 0.00026495519015
Validation loss decreased (0.6177 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 6.9879982471466064
Epoch: 2, Steps: 979 | Train Loss: 1.0776063 Vali Loss: 0.6069405 Best vali loss: 0.6069405
	iters: 100, epoch: 3 | loss: 0.4084586
	speed: 0.0259s/iter; left time: 149.8106s
	iters: 200, epoch: 3 | loss: 0.6437197
	speed: 0.0078s/iter; left time: 44.1404s
	iters: 300, epoch: 3 | loss: 1.1702121
	speed: 0.0051s/iter; left time: 28.6826s
	iters: 400, epoch: 3 | loss: 1.0143545
	speed: 0.0060s/iter; left time: 32.7076s
	iters: 500, epoch: 3 | loss: 0.8011234
	speed: 0.0071s/iter; left time: 37.9091s
	iters: 600, epoch: 3 | loss: 0.5175123
	speed: 0.0072s/iter; left time: 37.9328s
	iters: 700, epoch: 3 | loss: 0.2785903
	speed: 0.0073s/iter; left time: 37.6615s
	iters: 800, epoch: 3 | loss: 0.6431274
	speed: 0.0072s/iter; left time: 36.4345s
	iters: 900, epoch: 3 | loss: 0.4507132
	speed: 0.0074s/iter; left time: 36.5750s
Updating learning rate to 0.000132477595075
Validation loss decreased (0.6069 --> 0.5880).  Saving model state dict ...
Epoch: 3 cost time: 6.874935865402222
Epoch: 3, Steps: 979 | Train Loss: 0.6586457 Vali Loss: 0.5879871 Best vali loss: 0.5879871

best validation loss 0.5879870721004121

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0113244039716, 'e_layers': 2, 'learning_rate': 0.0001157249236, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4509868
	speed: 0.0096s/iter; left time: 36.7344s
	iters: 200, epoch: 1 | loss: 0.6748573
	speed: 0.0044s/iter; left time: 16.2097s
	iters: 300, epoch: 1 | loss: 0.3681538
	speed: 0.0056s/iter; left time: 20.1786s
	iters: 400, epoch: 1 | loss: 1.2993197
	speed: 0.0057s/iter; left time: 20.0406s
Updating learning rate to 0.0001157249236
Validation loss decreased (inf --> 0.5957).  Saving model state dict ...
Epoch: 1 cost time: 2.7765684127807617
Epoch: 1, Steps: 490 | Train Loss: 0.6983294 Vali Loss: 0.5957313 Best vali loss: 0.5957313
	iters: 100, epoch: 2 | loss: 0.5345541
	speed: 0.0163s/iter; left time: 54.2077s
	iters: 200, epoch: 2 | loss: 0.6255414
	speed: 0.0053s/iter; left time: 16.9839s
	iters: 300, epoch: 2 | loss: 0.4372814
	speed: 0.0051s/iter; left time: 15.9772s
	iters: 400, epoch: 2 | loss: 0.8808289
	speed: 0.0051s/iter; left time: 15.3150s
Updating learning rate to 5.78624618e-05
Epoch: 2 cost time: 2.597172498703003
Epoch: 2, Steps: 490 | Train Loss: 0.6195514 Vali Loss: 0.6556531 Best vali loss: 0.5957313
	iters: 100, epoch: 3 | loss: 0.5162938
	speed: 0.0152s/iter; left time: 43.3140s
	iters: 200, epoch: 3 | loss: 1.1945168
	speed: 0.0053s/iter; left time: 14.6555s
	iters: 300, epoch: 3 | loss: 1.0167872
	speed: 0.0056s/iter; left time: 14.7617s
	iters: 400, epoch: 3 | loss: 0.7319289
	speed: 0.0053s/iter; left time: 13.4288s
Updating learning rate to 2.89312309e-05
Validation loss decreased (0.5957 --> 0.5514).  Saving model state dict ...
Epoch: 3 cost time: 2.6773006916046143
Epoch: 3, Steps: 490 | Train Loss: 0.8648817 Vali Loss: 0.5514381 Best vali loss: 0.5514381

best validation loss 0.5514381033355911

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0113244039716, 'e_layers': 2, 'learning_rate': 0.0001157249236, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3789431
	speed: 0.0115s/iter; left time: 26.9518s
	iters: 200, epoch: 4 | loss: 0.6503345
	speed: 0.0048s/iter; left time: 10.8884s
	iters: 300, epoch: 4 | loss: 0.3398772
	speed: 0.0054s/iter; left time: 11.6142s
	iters: 400, epoch: 4 | loss: 1.2035074
	speed: 0.0052s/iter; left time: 10.5740s
Updating learning rate to 1.446561545e-05
Validation loss decreased (0.5514 --> 0.5481).  Saving model state dict ...
Epoch: 4 cost time: 2.840913772583008
Epoch: 4, Steps: 490 | Train Loss: 0.6431656 Vali Loss: 0.5481132 Best vali loss: 0.5481132
	iters: 100, epoch: 5 | loss: 0.4965630
	speed: 0.0158s/iter; left time: 29.3212s
	iters: 200, epoch: 5 | loss: 0.6122406
	speed: 0.0053s/iter; left time: 9.3342s
	iters: 300, epoch: 5 | loss: 0.4365211
	speed: 0.0058s/iter; left time: 9.5723s
	iters: 400, epoch: 5 | loss: 0.7440044
	speed: 0.0052s/iter; left time: 8.1118s
Updating learning rate to 7.232807725e-06
Validation loss decreased (0.5481 --> 0.5475).  Saving model state dict ...
Epoch: 5 cost time: 2.662529230117798
Epoch: 5, Steps: 490 | Train Loss: 0.5723323 Vali Loss: 0.5475374 Best vali loss: 0.5475374
	iters: 100, epoch: 6 | loss: 0.4943115
	speed: 0.0165s/iter; left time: 22.6051s
	iters: 200, epoch: 6 | loss: 0.7424872
	speed: 0.0053s/iter; left time: 6.7434s
	iters: 300, epoch: 6 | loss: 0.9324934
	speed: 0.0059s/iter; left time: 6.9100s
	iters: 400, epoch: 6 | loss: 0.7256699
	speed: 0.0051s/iter; left time: 5.4946s
Updating learning rate to 3.6164038625e-06
Validation loss decreased (0.5475 --> 0.5398).  Saving model state dict ...
Epoch: 6 cost time: 2.7051401138305664
Epoch: 6, Steps: 490 | Train Loss: 0.7237405 Vali Loss: 0.5398296 Best vali loss: 0.5398296
	iters: 100, epoch: 7 | loss: 0.4032394
	speed: 0.0157s/iter; left time: 13.8625s
	iters: 200, epoch: 7 | loss: 1.1296287
	speed: 0.0050s/iter; left time: 3.9219s
	iters: 300, epoch: 7 | loss: 0.6468917
	speed: 0.0055s/iter; left time: 3.7240s
	iters: 400, epoch: 7 | loss: 0.2846881
	speed: 0.0048s/iter; left time: 2.8039s
Updating learning rate to 1.80820193125e-06
Epoch: 7 cost time: 2.5117275714874268
Epoch: 7, Steps: 490 | Train Loss: 0.6161119 Vali Loss: 0.5420972 Best vali loss: 0.5398296
	iters: 100, epoch: 8 | loss: 0.8884048
	speed: 0.0112s/iter; left time: 4.3975s
	iters: 200, epoch: 8 | loss: 0.9777269
	speed: 0.0054s/iter; left time: 1.5799s
	iters: 300, epoch: 8 | loss: 0.6668523
	speed: 0.0050s/iter; left time: 0.9495s
	iters: 400, epoch: 8 | loss: 0.9499705
	speed: 0.0052s/iter; left time: 0.4760s
Updating learning rate to 9.04100965625e-07
Epoch: 8 cost time: 2.4555163383483887
Epoch: 8, Steps: 490 | Train Loss: 0.8707386 Vali Loss: 0.5416779 Best vali loss: 0.5398296

best validation loss 0.539829627748222

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0052619006335, 'e_layers': 4, 'learning_rate': 0.0005447529536, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005447529536
Validation loss decreased (inf --> 0.6132).  Saving model state dict ...
Epoch: 1 cost time: 0.820929765701294
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6131654 Best vali loss: 0.6131654
Updating learning rate to 0.0002723764768
Validation loss decreased (0.6132 --> 0.6025).  Saving model state dict ...
Epoch: 2 cost time: 0.6786985397338867
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6024959 Best vali loss: 0.6024959
Updating learning rate to 0.0001361882384
Validation loss decreased (0.6025 --> 0.6003).  Saving model state dict ...
Epoch: 3 cost time: 0.6774733066558838
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6003288 Best vali loss: 0.6003288
Updating learning rate to 6.80941192e-05
Epoch: 4 cost time: 0.7018218040466309
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6046389 Best vali loss: 0.6003288
Updating learning rate to 3.40470596e-05
Epoch: 5 cost time: 0.839113712310791
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6059640 Best vali loss: 0.6003288
Updating learning rate to 1.70235298e-05
Epoch: 6 cost time: 0.7039735317230225
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6071927 Best vali loss: 0.6003288
Updating learning rate to 8.5117649e-06
Epoch: 7 cost time: 0.7334387302398682
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6067121 Best vali loss: 0.6003288
Updating learning rate to 4.25588245e-06
Epoch: 8 cost time: 0.7645156383514404
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6064929 Best vali loss: 0.6003288

best validation loss 0.6003287831206721

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010477009495, 'e_layers': 1, 'learning_rate': 0.0002179153135, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3970094
	speed: 0.0085s/iter; left time: 66.0735s
	iters: 200, epoch: 1 | loss: 1.0666476
	speed: 0.0024s/iter; left time: 17.9412s
	iters: 300, epoch: 1 | loss: 1.1622905
	speed: 0.0045s/iter; left time: 33.7965s
	iters: 400, epoch: 1 | loss: 0.6026325
	speed: 0.0044s/iter; left time: 32.5532s
	iters: 500, epoch: 1 | loss: 1.0925566
	speed: 0.0040s/iter; left time: 29.6469s
	iters: 600, epoch: 1 | loss: 0.7041174
	speed: 0.0042s/iter; left time: 30.6697s
	iters: 700, epoch: 1 | loss: 0.3815836
	speed: 0.0042s/iter; left time: 29.6195s
	iters: 800, epoch: 1 | loss: 0.9483117
	speed: 0.0024s/iter; left time: 16.6111s
	iters: 900, epoch: 1 | loss: 0.8941141
	speed: 0.0022s/iter; left time: 15.5113s
Updating learning rate to 0.00020962140573171524
Validation loss decreased (inf --> 0.6016).  Saving model state dict ...
Epoch: 1 cost time: 3.5539371967315674
Epoch: 1, Steps: 979 | Train Loss: 0.9165848 Vali Loss: 0.6015514 Best vali loss: 0.6015514
	iters: 100, epoch: 2 | loss: 1.6573938
	speed: 0.0113s/iter; left time: 76.3029s
	iters: 200, epoch: 2 | loss: 0.4516093
	speed: 0.0035s/iter; left time: 23.3088s
	iters: 300, epoch: 2 | loss: 0.7540752
	speed: 0.0037s/iter; left time: 23.9440s
	iters: 400, epoch: 2 | loss: 0.4984056
	speed: 0.0037s/iter; left time: 23.7495s
	iters: 500, epoch: 2 | loss: 0.5579910
	speed: 0.0033s/iter; left time: 20.7291s
	iters: 600, epoch: 2 | loss: 0.3536357
	speed: 0.0028s/iter; left time: 17.7621s
	iters: 700, epoch: 2 | loss: 0.6457531
	speed: 0.0034s/iter; left time: 21.0521s
	iters: 800, epoch: 2 | loss: 0.4920457
	speed: 0.0034s/iter; left time: 20.3350s
	iters: 900, epoch: 2 | loss: 1.0162046
	speed: 0.0036s/iter; left time: 21.6527s
Updating learning rate to 0.0001860023547001212
Epoch: 2 cost time: 3.5044567584991455
Epoch: 2, Steps: 979 | Train Loss: 0.7141238 Vali Loss: 0.6024924 Best vali loss: 0.6015514
	iters: 100, epoch: 3 | loss: 1.6582210
	speed: 0.0145s/iter; left time: 83.9795s
	iters: 200, epoch: 3 | loss: 0.4802825
	speed: 0.0038s/iter; left time: 21.6113s
	iters: 300, epoch: 3 | loss: 1.2221583
	speed: 0.0037s/iter; left time: 20.3807s
	iters: 400, epoch: 3 | loss: 0.5378252
	speed: 0.0036s/iter; left time: 19.7754s
	iters: 500, epoch: 3 | loss: 1.1588941
	speed: 0.0034s/iter; left time: 18.5417s
	iters: 600, epoch: 3 | loss: 0.6674014
	speed: 0.0037s/iter; left time: 19.3237s
	iters: 700, epoch: 3 | loss: 0.3734814
	speed: 0.0030s/iter; left time: 15.7400s
	iters: 800, epoch: 3 | loss: 0.3495020
	speed: 0.0032s/iter; left time: 16.1591s
	iters: 900, epoch: 3 | loss: 0.7074920
	speed: 0.0033s/iter; left time: 16.5479s
Updating learning rate to 0.0001506539468175473
Epoch: 3 cost time: 3.4175853729248047
Epoch: 3, Steps: 979 | Train Loss: 0.7950287 Vali Loss: 0.6218123 Best vali loss: 0.6015514
	iters: 100, epoch: 4 | loss: 0.7667510
	speed: 0.0155s/iter; left time: 74.3646s
	iters: 200, epoch: 4 | loss: 0.6748214
	speed: 0.0037s/iter; left time: 17.1982s
	iters: 300, epoch: 4 | loss: 0.4034644
	speed: 0.0035s/iter; left time: 16.1331s
	iters: 400, epoch: 4 | loss: 1.3443573
	speed: 0.0036s/iter; left time: 16.0243s
	iters: 500, epoch: 4 | loss: 0.7446340
	speed: 0.0038s/iter; left time: 16.7425s
	iters: 600, epoch: 4 | loss: 0.9025154
	speed: 0.0036s/iter; left time: 15.4829s
	iters: 700, epoch: 4 | loss: 0.2780350
	speed: 0.0034s/iter; left time: 14.3603s
	iters: 800, epoch: 4 | loss: 0.4033881
	speed: 0.0035s/iter; left time: 14.4067s
	iters: 900, epoch: 4 | loss: 0.9154475
	speed: 0.0030s/iter; left time: 11.9036s
Updating learning rate to 0.00010895765675
Epoch: 4 cost time: 3.4397213459014893
Epoch: 4, Steps: 979 | Train Loss: 0.7148238 Vali Loss: 0.6194635 Best vali loss: 0.6015514
	iters: 100, epoch: 5 | loss: 0.7379982
	speed: 0.0097s/iter; left time: 36.8350s
	iters: 200, epoch: 5 | loss: 0.4504806
	speed: 0.0025s/iter; left time: 9.3956s
	iters: 300, epoch: 5 | loss: 0.8792539
	speed: 0.0026s/iter; left time: 9.2390s
	iters: 400, epoch: 5 | loss: 0.6075272
	speed: 0.0024s/iter; left time: 8.4862s
	iters: 500, epoch: 5 | loss: 0.6361046
	speed: 0.0026s/iter; left time: 9.0353s
	iters: 600, epoch: 5 | loss: 0.7292342
	speed: 0.0029s/iter; left time: 9.5317s
	iters: 700, epoch: 5 | loss: 1.0003773
	speed: 0.0026s/iter; left time: 8.4629s
	iters: 800, epoch: 5 | loss: 0.8643862
	speed: 0.0039s/iter; left time: 12.2818s
	iters: 900, epoch: 5 | loss: 0.7862533
	speed: 0.0032s/iter; left time: 9.7242s
Updating learning rate to 6.726136668245272e-05
Epoch: 5 cost time: 2.911123037338257
Epoch: 5, Steps: 979 | Train Loss: 0.7435128 Vali Loss: 0.6073456 Best vali loss: 0.6015514
	iters: 100, epoch: 6 | loss: 0.4417131
	speed: 0.0148s/iter; left time: 42.1030s
	iters: 200, epoch: 6 | loss: 0.3341034
	speed: 0.0036s/iter; left time: 9.8423s
	iters: 300, epoch: 6 | loss: 1.0769492
	speed: 0.0039s/iter; left time: 10.4086s
	iters: 400, epoch: 6 | loss: 0.5728698
	speed: 0.0039s/iter; left time: 9.8294s
	iters: 500, epoch: 6 | loss: 0.3079850
	speed: 0.0035s/iter; left time: 8.5014s
	iters: 600, epoch: 6 | loss: 0.8129054
	speed: 0.0035s/iter; left time: 8.1757s
	iters: 700, epoch: 6 | loss: 1.5238688
	speed: 0.0036s/iter; left time: 7.9959s
	iters: 800, epoch: 6 | loss: 0.4968183
	speed: 0.0035s/iter; left time: 7.4714s
	iters: 900, epoch: 6 | loss: 0.2189342
	speed: 0.0038s/iter; left time: 7.8309s
Updating learning rate to 3.19129587998788e-05
Epoch: 6 cost time: 3.6035163402557373
Epoch: 6, Steps: 979 | Train Loss: 0.6429052 Vali Loss: 0.6203492 Best vali loss: 0.6015514
	iters: 100, epoch: 7 | loss: 0.8710204
	speed: 0.0100s/iter; left time: 18.5659s
	iters: 200, epoch: 7 | loss: 0.5474037
	speed: 0.0029s/iter; left time: 5.0906s
	iters: 300, epoch: 7 | loss: 0.5353749
	speed: 0.0039s/iter; left time: 6.5399s
	iters: 400, epoch: 7 | loss: 0.7685057
	speed: 0.0038s/iter; left time: 5.9785s
	iters: 500, epoch: 7 | loss: 0.4479838
	speed: 0.0037s/iter; left time: 5.3994s
	iters: 600, epoch: 7 | loss: 1.3533219
	speed: 0.0036s/iter; left time: 4.9404s
	iters: 700, epoch: 7 | loss: 0.5014921
	speed: 0.0036s/iter; left time: 4.5075s
	iters: 800, epoch: 7 | loss: 0.6974207
	speed: 0.0036s/iter; left time: 4.1856s
	iters: 900, epoch: 7 | loss: 0.2754280
	speed: 0.0036s/iter; left time: 3.8222s
Updating learning rate to 8.293907768284754e-06
Epoch: 7 cost time: 3.4458720684051514
Epoch: 7, Steps: 979 | Train Loss: 0.6664390 Vali Loss: 0.6225864 Best vali loss: 0.6015514
	iters: 100, epoch: 8 | loss: 0.3511648
	speed: 0.0150s/iter; left time: 13.1643s
	iters: 200, epoch: 8 | loss: 0.6290909
	speed: 0.0039s/iter; left time: 3.0245s
	iters: 300, epoch: 8 | loss: 0.4594617
	speed: 0.0037s/iter; left time: 2.5251s
	iters: 400, epoch: 8 | loss: 1.2240137
	speed: 0.0037s/iter; left time: 2.1189s
	iters: 500, epoch: 8 | loss: 0.9737494
	speed: 0.0034s/iter; left time: 1.6466s
	iters: 600, epoch: 8 | loss: 0.6536885
	speed: 0.0033s/iter; left time: 1.2695s
	iters: 700, epoch: 8 | loss: 1.3058424
	speed: 0.0037s/iter; left time: 1.0438s
	iters: 800, epoch: 8 | loss: 0.4483489
	speed: 0.0037s/iter; left time: 0.6587s
	iters: 900, epoch: 8 | loss: 0.6735198
	speed: 0.0036s/iter; left time: 0.2875s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.6094305515289307
Epoch: 8, Steps: 979 | Train Loss: 0.7465422 Vali Loss: 0.6252331 Best vali loss: 0.6015514

best validation loss 0.6015513627024945

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.011102994395, 'e_layers': 4, 'learning_rate': 0.0002339721939, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7853639
	speed: 0.0129s/iter; left time: 49.3036s
	iters: 200, epoch: 1 | loss: 0.8018730
	speed: 0.0072s/iter; left time: 26.7857s
	iters: 300, epoch: 1 | loss: 0.4163677
	speed: 0.0072s/iter; left time: 25.9527s
	iters: 400, epoch: 1 | loss: 0.9443815
	speed: 0.0072s/iter; left time: 25.2756s
Updating learning rate to 0.0002339721939
Validation loss decreased (inf --> 0.5996).  Saving model state dict ...
Epoch: 1 cost time: 3.78751277923584
Epoch: 1, Steps: 490 | Train Loss: 0.7369965 Vali Loss: 0.5996091 Best vali loss: 0.5996091
	iters: 100, epoch: 2 | loss: 0.7842644
	speed: 0.0195s/iter; left time: 64.9602s
	iters: 200, epoch: 2 | loss: 1.4977494
	speed: 0.0069s/iter; left time: 22.3836s
	iters: 300, epoch: 2 | loss: 0.9279603
	speed: 0.0075s/iter; left time: 23.4608s
	iters: 400, epoch: 2 | loss: 0.8110113
	speed: 0.0071s/iter; left time: 21.6236s
Updating learning rate to 0.00011698609695
Validation loss decreased (0.5996 --> 0.5619).  Saving model state dict ...
Epoch: 2 cost time: 3.55031156539917
Epoch: 2, Steps: 490 | Train Loss: 1.0052464 Vali Loss: 0.5619000 Best vali loss: 0.5619000
	iters: 100, epoch: 3 | loss: 0.8464332
	speed: 0.0201s/iter; left time: 57.0520s
	iters: 200, epoch: 3 | loss: 0.5851101
	speed: 0.0068s/iter; left time: 18.7425s
	iters: 300, epoch: 3 | loss: 0.8815964
	speed: 0.0071s/iter; left time: 18.7445s
	iters: 400, epoch: 3 | loss: 0.4512090
	speed: 0.0071s/iter; left time: 18.0884s
Updating learning rate to 5.8493048475e-05
Validation loss decreased (0.5619 --> 0.5519).  Saving model state dict ...
Epoch: 3 cost time: 3.54609751701355
Epoch: 3, Steps: 490 | Train Loss: 0.6910872 Vali Loss: 0.5518586 Best vali loss: 0.5518586

best validation loss 0.5518585660153106

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0020735604228, 'e_layers': 3, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7125489
	speed: 0.0113s/iter; left time: 87.0420s
	iters: 200, epoch: 1 | loss: 0.4078116
	speed: 0.0055s/iter; left time: 42.2623s
	iters: 300, epoch: 1 | loss: 0.7083938
	speed: 0.0053s/iter; left time: 39.6868s
	iters: 400, epoch: 1 | loss: 1.0840890
	speed: 0.0055s/iter; left time: 40.6864s
	iters: 500, epoch: 1 | loss: 0.5590667
	speed: 0.0040s/iter; left time: 29.0203s
	iters: 600, epoch: 1 | loss: 1.4126521
	speed: 0.0046s/iter; left time: 33.3778s
	iters: 700, epoch: 1 | loss: 0.3295235
	speed: 0.0062s/iter; left time: 44.2471s
	iters: 800, epoch: 1 | loss: 0.7006335
	speed: 0.0056s/iter; left time: 39.3484s
	iters: 900, epoch: 1 | loss: 0.4721580
	speed: 0.0060s/iter; left time: 41.5152s
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.6373).  Saving model state dict ...
Epoch: 1 cost time: 5.570559501647949
Epoch: 1, Steps: 979 | Train Loss: 0.7096530 Vali Loss: 0.6373447 Best vali loss: 0.6373447
	iters: 100, epoch: 2 | loss: 0.3016358
	speed: 0.0199s/iter; left time: 134.5977s
	iters: 200, epoch: 2 | loss: 0.4041743
	speed: 0.0040s/iter; left time: 26.2850s
	iters: 300, epoch: 2 | loss: 0.4150955
	speed: 0.0041s/iter; left time: 27.0441s
	iters: 400, epoch: 2 | loss: 0.5505349
	speed: 0.0058s/iter; left time: 37.3935s
	iters: 500, epoch: 2 | loss: 0.6759570
	speed: 0.0062s/iter; left time: 39.2407s
	iters: 600, epoch: 2 | loss: 1.0639914
	speed: 0.0063s/iter; left time: 39.1257s
	iters: 700, epoch: 2 | loss: 0.5924086
	speed: 0.0048s/iter; left time: 29.5490s
	iters: 800, epoch: 2 | loss: 1.0104299
	speed: 0.0043s/iter; left time: 26.2191s
	iters: 900, epoch: 2 | loss: 0.6752546
	speed: 0.0051s/iter; left time: 30.1838s
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.6373 --> 0.6189).  Saving model state dict ...
Epoch: 2 cost time: 5.100627183914185
Epoch: 2, Steps: 979 | Train Loss: 0.6321647 Vali Loss: 0.6188933 Best vali loss: 0.6188933
	iters: 100, epoch: 3 | loss: 0.8393195
	speed: 0.0188s/iter; left time: 108.4762s
	iters: 200, epoch: 3 | loss: 1.1912004
	speed: 0.0055s/iter; left time: 31.0182s
	iters: 300, epoch: 3 | loss: 0.6793953
	speed: 0.0055s/iter; left time: 30.7605s
	iters: 400, epoch: 3 | loss: 0.7064751
	speed: 0.0058s/iter; left time: 31.5003s
	iters: 500, epoch: 3 | loss: 0.7741119
	speed: 0.0056s/iter; left time: 29.9139s
	iters: 600, epoch: 3 | loss: 0.7937117
	speed: 0.0056s/iter; left time: 29.4862s
	iters: 700, epoch: 3 | loss: 0.8683811
	speed: 0.0056s/iter; left time: 28.9684s
	iters: 800, epoch: 3 | loss: 1.2508420
	speed: 0.0056s/iter; left time: 28.3126s
	iters: 900, epoch: 3 | loss: 1.0641161
	speed: 0.0056s/iter; left time: 27.8900s
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.6189 --> 0.6137).  Saving model state dict ...
Epoch: 3 cost time: 5.521358489990234
Epoch: 3, Steps: 979 | Train Loss: 0.9075059 Vali Loss: 0.6137219 Best vali loss: 0.6137219

best validation loss 0.6137219337554289

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0053943522932, 'e_layers': 4, 'learning_rate': 0.0002804459926, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002697721525689759
Validation loss decreased (inf --> 0.6016).  Saving model state dict ...
Epoch: 1 cost time: 0.9290893077850342
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6015609 Best vali loss: 0.6015609
Updating learning rate to 0.00023937562786202615
Epoch: 2 cost time: 0.7856860160827637
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6100312 Best vali loss: 0.6015609
Updating learning rate to 0.0001938840138206013
Validation loss decreased (0.6016 --> 0.5808).  Saving model state dict ...
Epoch: 3 cost time: 0.5724563598632812
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5808066 Best vali loss: 0.5808066

best validation loss 0.5808065717609764

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.011102994395, 'e_layers': 4, 'learning_rate': 0.0002339721939, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6528961
	speed: 0.0130s/iter; left time: 30.6199s
	iters: 200, epoch: 4 | loss: 0.7639321
	speed: 0.0070s/iter; left time: 15.8588s
	iters: 300, epoch: 4 | loss: 0.3985868
	speed: 0.0069s/iter; left time: 14.8952s
	iters: 400, epoch: 4 | loss: 0.8802440
	speed: 0.0074s/iter; left time: 15.1733s
Updating learning rate to 2.92465242375e-05
Validation loss decreased (0.5519 --> 0.5428).  Saving model state dict ...
Epoch: 4 cost time: 3.77970290184021
Epoch: 4, Steps: 490 | Train Loss: 0.6739148 Vali Loss: 0.5427860 Best vali loss: 0.5427860
	iters: 100, epoch: 5 | loss: 0.6930218
	speed: 0.0192s/iter; left time: 35.7386s
	iters: 200, epoch: 5 | loss: 0.8734298
	speed: 0.0072s/iter; left time: 12.7600s
	iters: 300, epoch: 5 | loss: 0.8292224
	speed: 0.0071s/iter; left time: 11.8379s
	iters: 400, epoch: 5 | loss: 0.7358743
	speed: 0.0070s/iter; left time: 10.9886s
Updating learning rate to 1.462326211875e-05
Validation loss decreased (0.5428 --> 0.5353).  Saving model state dict ...
Epoch: 5 cost time: 3.5135974884033203
Epoch: 5, Steps: 490 | Train Loss: 0.7828871 Vali Loss: 0.5352564 Best vali loss: 0.5352564
	iters: 100, epoch: 6 | loss: 0.7408875
	speed: 0.0191s/iter; left time: 26.2429s
	iters: 200, epoch: 6 | loss: 0.5649428
	speed: 0.0070s/iter; left time: 8.9191s
	iters: 300, epoch: 6 | loss: 0.8327308
	speed: 0.0071s/iter; left time: 8.2845s
	iters: 400, epoch: 6 | loss: 0.4273029
	speed: 0.0072s/iter; left time: 7.6731s
Updating learning rate to 7.311631059375e-06
Epoch: 6 cost time: 3.492147922515869
Epoch: 6, Steps: 490 | Train Loss: 0.6414660 Vali Loss: 0.5438378 Best vali loss: 0.5352564
	iters: 100, epoch: 7 | loss: 1.0456849
	speed: 0.0191s/iter; left time: 16.8565s
	iters: 200, epoch: 7 | loss: 1.0297916
	speed: 0.0072s/iter; left time: 5.5992s
	iters: 300, epoch: 7 | loss: 0.8161627
	speed: 0.0072s/iter; left time: 4.8759s
	iters: 400, epoch: 7 | loss: 0.4131639
	speed: 0.0072s/iter; left time: 4.1734s
Updating learning rate to 3.6558155296875e-06
Epoch: 7 cost time: 3.55145263671875
Epoch: 7, Steps: 490 | Train Loss: 0.8262008 Vali Loss: 0.5401077 Best vali loss: 0.5352564
	iters: 100, epoch: 8 | loss: 1.1318855
	speed: 0.0191s/iter; left time: 7.4868s
	iters: 200, epoch: 8 | loss: 0.8776187
	speed: 0.0072s/iter; left time: 2.0829s
	iters: 300, epoch: 8 | loss: 0.4343127
	speed: 0.0068s/iter; left time: 1.3073s
	iters: 400, epoch: 8 | loss: 0.5927296
	speed: 0.0049s/iter; left time: 0.4492s
Updating learning rate to 1.82790776484375e-06
Epoch: 8 cost time: 3.157496452331543
Epoch: 8, Steps: 490 | Train Loss: 0.7591366 Vali Loss: 0.5409440 Best vali loss: 0.5352564

best validation loss 0.5352564090272444

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019713488614, 'e_layers': 4, 'learning_rate': 8.81054616e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.81054616e-05
Validation loss decreased (inf --> 0.6278).  Saving model state dict ...
Epoch: 1 cost time: 1.1922886371612549
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6278124 Best vali loss: 0.6278124
Updating learning rate to 4.40527308e-05
Validation loss decreased (0.6278 --> 0.6084).  Saving model state dict ...
Epoch: 2 cost time: 0.6751646995544434
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6083537 Best vali loss: 0.6083537
Updating learning rate to 2.20263654e-05
Validation loss decreased (0.6084 --> 0.6035).  Saving model state dict ...
Epoch: 3 cost time: 0.8752965927124023
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6034860 Best vali loss: 0.6034860
Updating learning rate to 1.10131827e-05
Validation loss decreased (0.6035 --> 0.6033).  Saving model state dict ...
Epoch: 4 cost time: 0.7431371212005615
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6032995 Best vali loss: 0.6032995
Updating learning rate to 5.50659135e-06
Validation loss decreased (0.6033 --> 0.6023).  Saving model state dict ...
Epoch: 5 cost time: 0.8915987014770508
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6023365 Best vali loss: 0.6023365
Updating learning rate to 2.753295675e-06
Epoch: 6 cost time: 0.8320479393005371
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6023672 Best vali loss: 0.6023365
Updating learning rate to 1.3766478375e-06
Validation loss decreased (0.6023 --> 0.6023).  Saving model state dict ...
Epoch: 7 cost time: 0.8462703227996826
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6023264 Best vali loss: 0.6023264
Updating learning rate to 6.8832391875e-07
Validation loss decreased (0.6023 --> 0.6023).  Saving model state dict ...
Epoch: 8 cost time: 0.8816037178039551
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6022881 Best vali loss: 0.6022881

best validation loss 0.6022881284625041

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045395061906, 'e_layers': 1, 'learning_rate': 7.97839266e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0602022
	speed: 0.0134s/iter; left time: 11.8478s
Updating learning rate to 7.97839266e-05
Validation loss decreased (inf --> 0.6018).  Saving model state dict ...
Epoch: 1 cost time: 1.1857390403747559
Epoch: 1, Steps: 123 | Train Loss: 1.0602022 Vali Loss: 0.6018290 Best vali loss: 0.6018290
	iters: 100, epoch: 2 | loss: 0.5510706
	speed: 0.0090s/iter; left time: 6.8659s
Updating learning rate to 3.98919633e-05
Epoch: 2 cost time: 0.5770254135131836
Epoch: 2, Steps: 123 | Train Loss: 0.5510706 Vali Loss: 0.6101411 Best vali loss: 0.6018290
	iters: 100, epoch: 3 | loss: 0.9027256
	speed: 0.0067s/iter; left time: 4.2992s
Updating learning rate to 1.994598165e-05
Epoch: 3 cost time: 0.5086572170257568
Epoch: 3, Steps: 123 | Train Loss: 0.9027256 Vali Loss: 0.6065871 Best vali loss: 0.6018290
	iters: 100, epoch: 4 | loss: 0.7745361
	speed: 0.0107s/iter; left time: 5.5017s
Updating learning rate to 9.972990825e-06
Epoch: 4 cost time: 0.8700628280639648
Epoch: 4, Steps: 123 | Train Loss: 0.7745361 Vali Loss: 0.6046039 Best vali loss: 0.6018290
	iters: 100, epoch: 5 | loss: 0.7719707
	speed: 0.0102s/iter; left time: 4.0005s
Updating learning rate to 4.9864954125e-06
Epoch: 5 cost time: 0.769294023513794
Epoch: 5, Steps: 123 | Train Loss: 0.7719707 Vali Loss: 0.6047980 Best vali loss: 0.6018290
	iters: 100, epoch: 6 | loss: 1.0574988
	speed: 0.0103s/iter; left time: 2.7925s
Updating learning rate to 2.49324770625e-06
Epoch: 6 cost time: 0.7529952526092529
Epoch: 6, Steps: 123 | Train Loss: 1.0574988 Vali Loss: 0.6043405 Best vali loss: 0.6018290
	iters: 100, epoch: 7 | loss: 0.9153323
	speed: 0.0100s/iter; left time: 1.4663s
Updating learning rate to 1.246623853125e-06
Epoch: 7 cost time: 0.8332695960998535
Epoch: 7, Steps: 123 | Train Loss: 0.9153323 Vali Loss: 0.6042226 Best vali loss: 0.6018290
	iters: 100, epoch: 8 | loss: 0.7436086
	speed: 0.0103s/iter; left time: 0.2481s
Updating learning rate to 6.233119265625e-07
Epoch: 8 cost time: 0.7982590198516846
Epoch: 8, Steps: 123 | Train Loss: 0.7436086 Vali Loss: 0.6041608 Best vali loss: 0.6018290

best validation loss 0.6018289746591637

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001366266417, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8827369
	speed: 0.0192s/iter; left time: 17.0054s
Updating learning rate to 0.00013142659978119153
Validation loss decreased (inf --> 0.6135).  Saving model state dict ...
Epoch: 1 cost time: 1.9711270332336426
Epoch: 1, Steps: 123 | Train Loss: 0.8827369 Vali Loss: 0.6135112 Best vali loss: 0.6135112
	iters: 100, epoch: 2 | loss: 0.7950742
	speed: 0.0206s/iter; left time: 15.7104s
Updating learning rate to 0.00011661813326840736
Validation loss decreased (0.6135 --> 0.5662).  Saving model state dict ...
Epoch: 2 cost time: 1.696148157119751
Epoch: 2, Steps: 123 | Train Loss: 0.7950742 Vali Loss: 0.5662060 Best vali loss: 0.5662060
	iters: 100, epoch: 3 | loss: 0.7709916
	speed: 0.0211s/iter; left time: 13.4961s
Updating learning rate to 9.445569694913567e-05
Epoch: 3 cost time: 1.7384512424468994
Epoch: 3, Steps: 123 | Train Loss: 0.7709916 Vali Loss: 0.6552279 Best vali loss: 0.5662060

best validation loss 0.5662060321232391

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023881242916, 'e_layers': 3, 'learning_rate': 0.0003852241358, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 145, in _serve
    send(conn, destination_pid)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 50, in send
    reduction.send_handle(conn, new_fd, pid)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 183, in send_handle
    with socket.fromfd(conn.fileno(), socket.AF_UNIX, socket.SOCK_STREAM) as s:
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/socket.py", line 545, in fromfd
    nfd = dup(fd)
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1293, in _get_data
    success, data = self._try_get_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 496, in rebuild_storage_fd
    fd = df.detach()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 189, in recv_handle
    return recvfds(s, 1)[0]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 159, in recvfds
    raise EOFError
EOFError


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception EOFError - 


{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0029512536949, 'e_layers': 3, 'learning_rate': 8.61514415e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001366266417, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0066302201562, 'e_layers': 1, 'learning_rate': 0.0005581450259, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0028704942058, 'e_layers': 1, 'learning_rate': 0.0001232468964, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 296, in reduce_tensor
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1002, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 945, in _find_spec
  File "<frozen importlib._bootstrap_external>", line 1439, in find_spec
  File "<frozen importlib._bootstrap_external>", line 1411, in _get_spec
  File "<frozen importlib._bootstrap_external>", line 1548, in find_spec
  File "<frozen importlib._bootstrap_external>", line 1591, in _fill_cache
OSError: [Errno 24] Too many open files: '/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nested'
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
    return self._process_data(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3454737_3165257455_3> in read-write mode: Too many open files (24)



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3454737_3165257455_3> in read-write mode: Too many open files (24)



{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0056007514956, 'e_layers': 2, 'learning_rate': 0.0033265458685, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
    return self._process_data(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3454775_2607073712_1> in read-write mode: Too many open files (24)



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3454775_2607073712_1> in read-write mode: Too many open files (24)



{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0035662121138, 'e_layers': 2, 'learning_rate': 0.001522687034, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
    child_r, parent_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1020, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 43, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 68, in Lock
    return Lock(ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 162, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 57, in __init__
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x77a41a9a9120>
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1477, in __del__
    self._shutdown_workers()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1408, in _shutdown_workers
    if not self._shutdown:
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_shutdown'
{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0060846577031, 'e_layers': 4, 'learning_rate': 0.0023894564118, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1011, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 43, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 68, in Lock
    return Lock(ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 162, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 57, in __init__
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0054087995747, 'e_layers': 2, 'learning_rate': 0.000320277044, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 221, in train
    _, train_loader = _get_data(args, flag='train')
  File "/home/antonio/Documents/tfm/SOFTS/NEW/tfm_utils/train_utils.py", line 40, in _get_data
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_factory.py", line 38, in data_provider
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_loader.py", line 44, in __init__
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_loader.py", line 48, in __read_data__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/common.py", line 873, in get_handle
OSError: [Errno 24] Too many open files: './dataset/ETT-small/ETTh2.csv'


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files: './dataset/ETT-small/ETTh2.csv'


{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 1, 'learning_rate': 0.0044405212972, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011380106664, 'e_layers': 2, 'learning_rate': 0.0014785421787, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022180841037, 'e_layers': 4, 'learning_rate': 0.0009753388759, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 1, 'learning_rate': 0.0044405212972, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 4, 'learning_rate': 5.49249532e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0090081835366, 'e_layers': 1, 'learning_rate': 0.0022095915955, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0022057538806, 'e_layers': 3, 'learning_rate': 0.0020632911339, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0012644689267, 'e_layers': 3, 'learning_rate': 5.87850584e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0026375387316, 'e_layers': 2, 'learning_rate': 0.0003869507914, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0022057538806, 'e_layers': 3, 'learning_rate': 0.0020632911339, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0027868200264, 'e_layers': 4, 'learning_rate': 0.0001369508687, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0091523064195, 'e_layers': 3, 'learning_rate': 7.3618282e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0050164002415, 'e_layers': 4, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
    w.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
    child_r, parent_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0059416893406, 'e_layers': 3, 'learning_rate': 8.06031958e-05, 'lradj': 'cosine', 'd_ff': 768}
Use CPU
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
    w.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 64, in _launch
    parent_r, child_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0020327141074, 'e_layers': 2, 'learning_rate': 0.0005663536047, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1020, in __init__
    index_queue = multiprocessing_context.Queue()  # type: ignore[var-annotated]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 42, in __init__
    self._reader, self._writer = connection.Pipe(duplex=False)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 527, in Pipe
    fd1, fd2 = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x77a41a9a9120>
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1477, in __del__
    self._shutdown_workers()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1408, in _shutdown_workers
    if not self._shutdown:
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_shutdown'
{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0050164002415, 'e_layers': 4, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1011, in __init__
    self._worker_result_queue = multiprocessing_context.Queue()  # type: ignore[var-annotated]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 42, in __init__
    self._reader, self._writer = connection.Pipe(duplex=False)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 527, in Pipe
    fd1, fd2 = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 379, in __call__
    subprocess.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
OSError: [Errno 24] Too many open files


Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/facade/abstract_facade.py", line 322, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 310, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 431, in _add_results
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 229, in tell
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 417, in save
OSError: [Errno 24] Too many open files: 'checkpoints/hptunning/smac/ETTh2_96_720/123/optimization.json'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 478, in <module>
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/facade/abstract_facade.py", line 324, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 417, in save
OSError: [Errno 24] Too many open files: 'checkpoints/hptunning/smac/ETTh2_96_720/123/optimization.json'


Time taken (1 parallel trials): 6404 seconds


